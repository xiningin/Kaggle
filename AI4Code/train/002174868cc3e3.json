{"cell_type":{"a733622c":"code","1988fec4":"code","e70b3716":"code","372efed5":"code","6bb105dc":"code","0508c7dd":"code","aa1a529d":"code","e0f95a1a":"code","77183cd7":"code","94d2e2aa":"code","19116e25":"code","bd0cca54":"code","8acbf3f4":"code","6ef36f44":"code","25648028":"code","ad2433e0":"code","21259728":"code","7c4d9651":"code","87c11e01":"code","6ba04744":"code","6459db77":"code","3f44f8a4":"code","63662693":"code","6b51b3da":"code","b883b407":"code","5ce134df":"markdown","51706df3":"markdown","2e86d5f8":"markdown","918034b1":"markdown","05cbdd6e":"markdown"},"source":{"a733622c":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport keras\nimport matplotlib.pyplot as plt\nfrom keras.layers import Dense,Dropout,LSTM\nfrom keras.models import Sequential\nimport warnings\nwarnings.filterwarnings('ignore')\nimport graphviz","1988fec4":"df = pd.read_csv(\"..\/input\/stock-price-prediction\/AxisBankStock.csv\")\ndf.head()","e70b3716":"df.shape","372efed5":"df.isnull().sum()","6bb105dc":"df.replace(np.NaN , df.mean(),inplace=True)","0508c7dd":"df.isnull().sum()","aa1a529d":"df.describe()","e0f95a1a":"plt.subplots(figsize = (25,10))\nplt.ylabel('High')\nplt.title('Orginal Plot')\nplt.plot('Open',data=df)","77183cd7":"data = df.filter(['Open'])\nprint(data.head())\nprint(\"\\n\")\ndataset = data.values\ntraining_data_len = int(np.ceil(len(dataset) * .8))\nprint(training_data_len)","94d2e2aa":"from sklearn.preprocessing import MinMaxScaler\nscaler = MinMaxScaler(feature_range=(0,1))\nscaled_data = scaler.fit_transform(dataset)\nscaled_data","19116e25":"train_x = []\ntrain_y = []\ntrain_data = scaled_data[0:int(training_data_len),:]\n\nfor i in range(60,len(train_data)):\n    train_x.append(train_data[i-60:i,0])\n    train_y.append(train_data[i,0])\n    if i<= 61:\n        print(train_x)\n        print(train_y)","bd0cca54":"train_x,train_y = np.array(train_x) , np.array(train_y)","8acbf3f4":"train_x.shape","6ef36f44":"train_x = np.reshape(train_x,(train_x.shape[0], train_x.shape[1], 1))\ntrain_x.shape","25648028":"model = Sequential()\nmodel.add(LSTM(units = 50 , return_sequences=True , input_shape = (train_x.shape[1],1)))\nmodel.add(LSTM(units = 50 , return_sequences = True))\nmodel.add(Dropout(0.2))\nmodel.add(LSTM(units= 50 , return_sequences = False))\nmodel.add(Dense(25))\nmodel.add(Dense(1))","ad2433e0":"keras.utils.plot_model(model = model , to_file = 'AxisBankLSTM.png')","21259728":"model.compile(optimizer='adam' , loss='mean_squared_error')","7c4d9651":"model.fit(train_x,train_y,batch_size=32 , epochs=3)","87c11e01":"test_data = scaled_data[training_data_len - 60:,:]\ntest_x = []\ntest_y = dataset[training_data_len: , :]\nfor i in range(60,len(test_data)):\n    test_x.append(test_data[i-60:i,0])","6ba04744":"test_x = np.array(test_x)","6459db77":"test_x = np.reshape(test_x,(test_x.shape[0] , test_x.shape[1] , 1))","3f44f8a4":"test_x.shape","63662693":"prediction = model.predict(test_x)\nprediction = scaler.inverse_transform(prediction)","6b51b3da":"# Get the root mean squared error (RMSE)\nrmse = np.sqrt(np.mean(((prediction - test_y) ** 2)))\nrmse","b883b407":"#Plot\/Create the data for the graph\ntrain = data[:training_data_len]\nactual = data[training_data_len:]\nactual['Predictions'] = prediction\n#Visualize the data\nplt.figure(figsize=(16,8))\nplt.title('Model')\nplt.xlabel('Date', fontsize=18)\nplt.ylabel('Open Price USD ($)', fontsize=18)\nplt.plot(train['Open'])\nplt.plot(actual[['Open', 'Predictions']])\nplt.legend(['Train', 'Actual', 'Predictions'], loc='lower right')\nplt.show()","5ce134df":"![Insight of LSTM Architecture (Image by towardsdatascience)](https:\/\/miro.medium.com\/max\/875\/1*x-xQ-7nUqSfE_1IMdKyv0A.jpeg)","51706df3":"Major Fields\/Columns:\n* Date \u2014 The date of the observation\n* Symbol \u2014 There are 2 Bank in this Data Set UTI Bank and Axis Bank\n* Open\u2014 The Price when the stock is open at particular day\n* Close \u2014 The Price when the stock is close at the end of day\n* High \u2014 Means the highest price in a given period of time\n* Low \u2014 Means the lowest price in a given period of time\n* Volume \u2014 the number of shares of a security traded during a given     period of time, The higher the volume during a price move, the more   significant the move","2e86d5f8":"#### Long short-term memory is an artificial recurrent neural network architecture used in the field of deep learning. Unlike standard feed forward neural networks, LSTM has feedback connections. It can not only process single data points, but also entire sequences of data.","918034b1":"A stock price is a given for every share issued by a publicly traded company. The price is a reflection of the company\u2019s value \u2014 what the public is willing to pay for a piece of the company. It can and will rise and fall, based on a variety of factors in the global landscape and within the company itself.","05cbdd6e":"# What is LSTM"}}