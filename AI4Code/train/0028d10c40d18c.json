{"cell_type":{"4ec335ba":"code","2bf98b43":"code","d3b47f0f":"code","ca8f4a30":"code","fcbdc2db":"code","7ea22206":"code","6d28f4a5":"code","a8da2df5":"code","aa96c0e3":"code","112d45b2":"code","d6f03059":"code","b19d1571":"code","abc80835":"code","407520b3":"code","868429b2":"code","425a58cd":"code","dd8cd12c":"code","3b480692":"code","77f7fdc9":"code","86be9f18":"code","f6b398be":"code","84632fc9":"code","d6a018ae":"code","e03adb24":"code","96f5a4e4":"code","5d07b3cd":"code","7558042d":"code","70274a99":"markdown","9f74dcb9":"markdown","d9fa9848":"markdown","796d7522":"markdown","a92be150":"markdown","bc62ac90":"markdown","7faecf04":"markdown","b85ac088":"markdown","3edcbc8e":"markdown","d3800abd":"markdown","fec314a3":"markdown","a8b2f27f":"markdown","160832bb":"markdown","38b5fa44":"markdown","0cd54d23":"markdown","f929ee6f":"markdown","9acfccaa":"markdown","0fa2a550":"markdown","dddabf9a":"markdown","e1e7a473":"markdown","a34599ec":"markdown","1a299c75":"markdown","178dac89":"markdown","a70efe72":"markdown","a0c786c0":"markdown"},"source":{"4ec335ba":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.tree import DecisionTreeClassifier\nimport pickle\nfrom sklearn.metrics import confusion_matrix\nfrom sklearn.preprocessing import OneHotEncoder\nfrom sklearn.preprocessing import LabelEncoder","2bf98b43":"data = pd.read_csv(\"..\/input\/drug-classification\/drug200.csv\")","d3b47f0f":"data.head()","ca8f4a30":"data[\"Drug\"].unique()","fcbdc2db":"data.shape","7ea22206":"numerical_features = [feature for feature in data.columns if data[feature].dtypes != 'O']\nprint(\"The length of Numerical_values is :\",len(numerical_features))\ndata[numerical_features].head()","6d28f4a5":"categorical_features = [feature for feature in data.columns if data[feature].dtypes == 'O']\nprint(\"The length of Numerical_values is :\",len(categorical_features))\ndata[categorical_features].head()","a8da2df5":"data.isnull().sum()","aa96c0e3":"A = data[data['Drug']=='drugA']\nB = data[data['Drug']=='drugB']\nC = data[data['Drug']=='drugC']\nX = data[data['Drug']=='drugX']\nY = data[data['Drug']=='DrugY']\n\n","112d45b2":"A_drug = len(A)\/len(data)*100\nB_drug = len(B)\/len(data)*100\nC_drug = len(C)\/len(data)*100\nX_drug = len(X)\/len(data)*100\nY_drug = len(Y)\/len(data)*100\n","d6f03059":"print(\"DrugA :\",A_drug,\"%\" )\nprint(\"DrugB :\",B_drug,\"%\" )\nprint(\"DrugC :\",C_drug,\"%\" )\nprint(\"DrugX :\",X_drug,\"%\" )\nprint(\"DrugY :\",Y_drug,\"%\" )","b19d1571":"sns.countplot(x='Drug',data=data)\nplt.show()","abc80835":"label_encoder = LabelEncoder()","407520b3":"for feature in categorical_features:\n    print(data[feature].unique())\n    data[feature]=label_encoder.fit_transform(data[feature])\n    print(data[feature].unique())","868429b2":"data.head()","425a58cd":"y = data[\"Drug\"]\nX = data.drop(\"Drug\",axis=1)\nlen(y),len(X)","dd8cd12c":"X_train, X_test, y_train,y_test =  train_test_split(X,y,test_size=0.3,random_state=0)","3b480692":"len(X_train),len(y_train),len(X_test),len(y_test)","77f7fdc9":"model = DecisionTreeClassifier(criterion=\"entropy\")","86be9f18":"model.fit(X_train,y_train)","f6b398be":"\nfilename = 'model.sav'\npickle.dump(model, open(filename, 'wb'))\n","84632fc9":"\nloaded_model = pickle.load(open(filename, 'rb'))\n","d6a018ae":"\n# Predict the values\ny_predict = loaded_model.predict(X_test)\n\n","e03adb24":"# Making Confusion Matrics\ncm = confusion_matrix(y_test,y_predict)","96f5a4e4":"cm","5d07b3cd":"Score = loaded_model.score(X_test,y_test)","7558042d":"Score","70274a99":" ### **Save Model** <a class=\"anchor\" id=\"5.1\"><\/a>","9f74dcb9":" #### **Label Encoding** <a class=\"anchor\" id=\"3.1.1\"><\/a>","d9fa9848":" ### **Read Dataset** <a class=\"anchor\" id=\"2.2\"><\/a>","796d7522":"The data set contains various information that effect the predictions like Age, Sex, BP, Cholesterol levels, Na to Potassium Ratio and finally the drug type.","a92be150":" ### **Categorical Features** <a class=\"anchor\" id=\"2.4\"><\/a>","bc62ac90":" ### **Load Model** <a class=\"anchor\" id=\"5.2\"><\/a>","7faecf04":" ## **1: Introduction About Dataset** <a class=\"anchor\" id=\"1\"><\/a>","b85ac088":" ## **3: Feature Engineering** <a class=\"anchor\" id=\"3\"><\/a>","3edcbc8e":"## **Score** <a class=\"anchor\" id=\"6.1\"><\/a>","d3800abd":" ### **Missing Values** <a class=\"anchor\" id=\"2.5\"><\/a>","fec314a3":"<a class=\"anchor\" id=\"0.1\"><\/a>\n## Tabel of Content\n1. [Introduction About Dataset](#1)\n2. [Data Analysis](#2)\n   - 2.1. [Import Libraries](#2.1)\n   - 2.2. [Read Dataset](#2.2)\n   - 2.3. [Numerical Feature](#2.3)\n   - 2.4. [Categorical Feature](#2.4)\n   - 2.5. [Missing Values](#2.5)\n   - 2.6. [Balanced or Unbalanced Dataset](#2.6)\n   \n3. [Feature Engineering](#3)\n   - 3.1. [Encoding](#3.1)\n        - 3.1.1. [Label Encoding](#3.1.1)\n4. [Model Building](#4)\n   - 4.1. [Seprate Dependent and Indepent Features](#4.1)\n   - 4.2. [Train-Test-Split](#4.2)\n   - 4.3. [Train Model](#4.3)\n\n5. [Save and Load Model](#5)\n   - 5.1. [Save Model](#5.1)\n   - 5.2. [Load Model](#5.2)\n6. [Accuracy Testing](#6)\n   - 6.1. [Score](#6.1)","a8b2f27f":" ### **Train-Test-Split** <a class=\"anchor\" id=\"4.2\"><\/a>","160832bb":"### **Balanced or Unbalanced Dataset** <a class=\"anchor\" id=\"2.6\"><\/a>","38b5fa44":" ### **Encoding** <a class=\"anchor\" id=\"3.1\"><\/a>","0cd54d23":" ## **6: Accuracy Testing** <a class=\"anchor\" id=\"6\"><\/a>","f929ee6f":"This data has been collected from a drug company which has labelled data set of the drugs and the parameters that effect it. Therefore, on the basis of the disease and the type of patient the drug is recommended.","9acfccaa":" ### **Train Model** <a class=\"anchor\" id=\"4.3\"><\/a>","0fa2a550":" ### **Import Libraries** <a class=\"anchor\" id=\"2.1\"><\/a>","dddabf9a":" ### **Seprate Dependent and Indepent Features** <a class=\"anchor\" id=\"4.1\"><\/a>","e1e7a473":" ### **Numerical Features** <a class=\"anchor\" id=\"2.3\"><\/a>","a34599ec":"## Drug Classification Model","1a299c75":" ## **4: Model Building** <a class=\"anchor\" id=\"4\"><\/a>","178dac89":" ## **5: Save \/Load Model** <a class=\"anchor\" id=\"5\"><\/a>","a70efe72":" ## **2: Data Analysis Phase** <a class=\"anchor\" id=\"2\"><\/a>","a0c786c0":"X: Independent Variable \/ Predictor Feature\n\ny; Dependent Variable \/ Target Feature"}}