{"cell_type":{"91ab0503":"code","4c0d6a2a":"code","febd4424":"code","3f0150f5":"code","3b666e90":"code","d6102e93":"code","b812cebc":"code","b99f055e":"code","fceaf6a4":"code","3aa7c5fc":"code","99f4bfd1":"code","e265c663":"code","e1396aff":"code","7cf614ed":"code","ea1c53e7":"code","b95e8850":"markdown","fc3a686d":"markdown","99022e92":"markdown","f3944df3":"markdown","bd758946":"markdown","2d1eba0f":"markdown","75b44148":"markdown","802927b0":"markdown","0329b907":"markdown","136a4a13":"markdown"},"source":{"91ab0503":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","4c0d6a2a":"import h2o\nfrom h2o.automl import H2OAutoML","febd4424":"h2o.init(max_mem_size='14G')","3f0150f5":"train = h2o.import_file('..\/input\/learn-together\/train.csv')\ntest = h2o.import_file('..\/input\/learn-together\/test.csv')","3b666e90":"display(train.head(2))\nprint(f'Train shape: {train.shape}')\n\ndisplay(test.head(2))\nprint(f'Test shape: {test.shape}')","d6102e93":"train = train.drop('Id')\ndisplay(train.head(1))\nprint(f\"Train shape: {train.shape}\")","b812cebc":"df_id = test['Id']\ndisplay(test.head(1))\nprint(f'Test shape: {test.shape}')","b99f055e":"test = test.drop('Id')\nx = train.columns\nx.remove('Cover_Type')\ny = 'Cover_Type'\n\ntrain[y] = train[y].asfactor()","fceaf6a4":"# df = train.split_frame(ratios=0.8, seed=8)\n# df_train = df[0]\n# df_valid = df[1]","3aa7c5fc":"aml = H2OAutoML(max_runtime_secs=30000)\naml.train(x=x, y=y, training_frame=train)","99f4bfd1":"lb = aml.leaderboard\nlb.head(rows=lb.nrows)","e265c663":"aml.leader","e1396aff":"preds = aml.predict(test)","7cf614ed":"preds.head(2)","ea1c53e7":"submission = pd.DataFrame({'Id': df_id.as_data_frame().squeeze(),\n                       'Cover_Type': preds['predict'].as_data_frame().squeeze()})\n\nsubmission.to_csv('submission.csv', index=False)","b95e8850":"### Display leaderboard:","fc3a686d":"### Initialize H2O cluster:","99022e92":"### Set predictors as x and target as y (and asfactor() because it's an int):","f3944df3":"### Drop id col:","bd758946":"### Create model and train:","2d1eba0f":"### Import files:","75b44148":"### Predict on test set:","802927b0":"### Create train\/valid set ?","0329b907":"### Import packages:","136a4a13":"### Submission:\n\n#### I tried to add my predictions as usual with the sample_submission.csv file and then the as_data_frame().values command but it didn't worked I had some errors when submitting the file, it was saying that I had 4 cols (?) while there were only two\n\nso i borrowed this part of code from https:\/\/www.kaggle.com\/cgurkan\/classify-forest-type-using-h2o-automl\nthanks to him"}}