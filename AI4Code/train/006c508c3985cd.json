{"cell_type":{"495815f8":"code","f1992690":"code","850647af":"code","655c8fd2":"code","724b7899":"code","1b0d7877":"code","0f029d4b":"code","ab7c0b93":"code","49098b63":"code","aa32bb61":"code","c37199bc":"code","cf67a0b9":"code","44c715bc":"code","dae3d29e":"markdown","99cb7902":"markdown","1da9e7de":"markdown","f420598e":"markdown","5c1a3363":"markdown"},"source":{"495815f8":"import numpy as np \nimport pandas as pd\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\nfrom sqlalchemy import create_engine\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nimport datetime as dt\nfrom dateutil.relativedelta import relativedelta","f1992690":"engine = create_engine('sqlite:\/\/\/..\/input\/database.sqlite')\ncon = engine.connect()","850647af":"rs1 = con.execute(\"SELECT * FROM Player_attributes\")\nplayer_att = pd.DataFrame(rs1.fetchall())\nplayer_att.columns = rs1.keys()\n\nrs2 = con.execute(\"SELECT * FROM Player\")\nplayer = pd.DataFrame(rs2.fetchall())\nplayer.columns = rs2.keys()\n\nplayer = player.merge(player_att, how=\"inner\", on='player_api_id', copy=False) \\\n               .set_index('player_api_id') \\\n               .drop(['player_fifa_api_id_x', \n                      'player_fifa_api_id_y', 'id_y'], axis=1)\nplayer.head()","655c8fd2":"player['birthday'] = pd.to_datetime(player['birthday'])\ntoday = dt.datetime.today()\n\ndef calculate_age(date):\n    res = relativedelta(today, date).years\n    return res\n\nplayer['age'] = player['birthday'].apply(calculate_age)    \nplayer[['player_name', 'age']].tail()    ","724b7899":"player2 = player.drop_duplicates(subset=['player_name'])","1b0d7877":"corr_df = player2.drop(['id_x', 'player_name', 'birthday', 'date'], axis=1).corr()","0f029d4b":"plt.figure(figsize=(30,15))\nsns.heatmap(corr_df, annot=True)\nplt.show()","ab7c0b93":"ovr = player2['overall_rating']\ncorr_ovr = player2.drop(['id_x', 'player_name', \n                         'birthday', 'date', 'preferred_foot', \n                         'attacking_work_rate', 'defensive_work_rate'], axis=1).corrwith(ovr)","49098b63":"plt.figure(figsize=(15,5))\ncorr_ovr.plot(kind='bar')\nplt.xlabel(\"Attributes\")\nplt.ylabel('Correlation')\nplt.title('Correlation of Overall Rating with other attributes')\nplt.show()","aa32bb61":"ovr_sort = player2.sort_values('overall_rating', ascending=False).head(15)\novr_sort[['player_name', 'overall_rating']]","c37199bc":"rs3 = con.execute(\"SELECT * FROM Team\")\nteam = pd.DataFrame(rs3.fetchall())\nteam.columns = rs3.keys()\nteam.set_index('team_api_id', inplace=True)\nteam.to_csv('team.csv', index=True)\n\nrs4 = con.execute(\"SELECT * FROM Team_Attributes\")\nteam_attr = pd.DataFrame(rs4.fetchall())\nteam_attr.columns = rs4.keys()\nteam_attr.set_index('team_api_id', inplace=True)\nteam_attr.to_csv('team.csv', index=True)","cf67a0b9":"team.head()","44c715bc":"team_attr.head()","dae3d29e":"## Adding age column using datetime module","99cb7902":"## Calculating correlation between player attributes","1da9e7de":"## Dropping duplicates values due to observations at different times","f420598e":"## Top 10 Players","5c1a3363":"## Strong Correlation between overall_rating and ['potential', 'reaction']"}}