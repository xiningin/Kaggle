{"cell_type":{"b006094c":"code","1205dc38":"code","44ffa9e8":"code","9281b68d":"code","922792a0":"code","7144cfef":"code","99510916":"code","1e3c4f62":"code","7f1f0d96":"code","40d2e38e":"code","90398330":"code","3e1c1c31":"code","3447c479":"code","fb91875b":"code","2145e4bc":"code","2189c55a":"code","90c7ab06":"code","43ef298d":"code","89c910d1":"code","b21977f3":"code","306a2bf4":"code","7d68fd3a":"code","648b0fca":"code","6dfc8b2a":"code","5cec4221":"code","d65fae70":"code","de1c1ad4":"code","05601d14":"code","d1a73975":"code","c727bba1":"code","d4b04c97":"code","31e7d20b":"code","9fd8baac":"code","78219221":"code","ce34c81e":"code","3420bd51":"code","396104aa":"code","cfb42eb5":"code","ff5dab1d":"code","4fa5190e":"code","1bce4878":"code","ca561443":"code","b0d7d7f8":"code","9051930e":"code","116b4c39":"code","cb2b47d5":"code","87d6b042":"code","84d7c451":"code","55e8cc9a":"code","c142d65a":"code","37ef3bad":"code","3670740a":"code","308c9b7a":"code","6aa6bcb1":"code","d6d20469":"code","88d8eaa7":"code","b0ec5207":"code","8b47f2be":"code","eaefb46e":"code","dd2efecb":"code","4b93bfb1":"code","dd57ead4":"code","d78702e6":"code","c3b63655":"code","2efb90d5":"code","847a3240":"code","0c5a321d":"code","c9ca900e":"code","1844d996":"markdown","cf411710":"markdown","8e2803d6":"markdown","abd6d882":"markdown","a828bb45":"markdown","0964d711":"markdown","ec5ee8cd":"markdown","0b514d41":"markdown","60830594":"markdown","cafe4769":"markdown","9772498d":"markdown","8ac9ea37":"markdown","eca3068d":"markdown","a90c3aa9":"markdown","38a8498c":"markdown","16184b22":"markdown","bdd02e9b":"markdown","6b79dbfb":"markdown","f06139ec":"markdown","398a73ae":"markdown","9fda25bb":"markdown"},"source":{"b006094c":"#import all libraries\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\nsns.set(style='whitegrid')\nimport matplotlib.pyplot as plt\nfrom matplotlib import style\n#sta matplotlib to inline and displays graphs below the corresponding cell.\n%matplotlib inline\nimport os\nfrom sklearn.datasets import *\nimport warnings\nwarnings.filterwarnings('ignore')","1205dc38":"df=pd.read_csv(\"..\/input\/Automobile.csv\")\ndf.head()","44ffa9e8":"df.shape","9281b68d":"#data cleaning\ndf.isnull().sum()","922792a0":"df.describe().T","7144cfef":"df.info()","99510916":"df.columns","1e3c4f62":"cols=['symboling', 'normalized_losses', 'make', 'fuel_type', 'aspiration',\n       'number_of_doors', 'body_style', 'drive_wheels', 'engine_location',\n       'wheel_base', 'length', 'width', 'height', 'curb_weight', 'engine_type',\n       'number_of_cylinders', 'engine_size', 'fuel_system', 'bore', 'stroke',\n       'compression_ratio', 'horsepower', 'peak_rpm', 'city_mpg',\n       'highway_mpg', 'price']\nfor i in cols:\n    def check(data):\n        t=data[i].loc[data[i]=='?']\n        return t\n    \n\n    g=check(df)\n    print(g)","7f1f0d96":"#thus the data shows there is no null values and also no special characters in the place of values","40d2e38e":"#what are the columns which are object\nobj=list(df.select_dtypes(include=['object']))\nobj","90398330":"#what are the columns which are float and int\nflint=list(df.select_dtypes(include=['int64','float64']))\nflint","3e1c1c31":"#checking for outliers\nplt.figure(figsize=(15,8))\nsns.boxplot(data=df)","3447c479":"df[['engine_size','peak_rpm','curb_weight','horsepower','price']].hist(figsize=(10,8),bins=6,color='Y')\nplt.tight_layout()\nplt.show()","fb91875b":"print('the minimum price of car: %0.2d, the maximum price of the car: %0.2d'%(df['price'].min(),df['price'].max()))","2145e4bc":"df['make'][df['price']>=30000].count()","2189c55a":"#there are 14 cars like that which are highly priced due to its features","90c7ab06":"d=df['make'][df['price']>=30000].value_counts().count()\nprint(d)\ndf['make'][df['price']>=30000].value_counts()","43ef298d":"df.head()","89c910d1":"df.aspiration.value_counts()","b21977f3":"fig,a=plt.subplots(1,2,figsize=(10,5))\ndf.groupby('aspiration')['price'].agg(['mean','median','max']).plot.bar(rot=0,ax=a[0])\ndf.aspiration.value_counts().plot.bar(rot=0,ax=a[1])","306a2bf4":"plt.figure(1)\nplt.subplot(221)\ndf['engine_type'].value_counts(normalize=True).plot(figsize=(10,8),kind='bar',color='red')\nplt.title(\"Number of Engine Type frequency diagram\")\nplt.ylabel('Number of Engine Type')\nplt.xlabel('engine-type');\n\nplt.subplot(222)\ndf['body_style'].value_counts(normalize=True).plot(figsize=(10,8),kind='bar',color='orange')\nplt.title(\"Number of Body Style frequency diagram\")\nplt.ylabel('Number of vehicles')\nplt.xlabel('body-style');\n\nplt.subplot(223)\ndf['number_of_doors'].value_counts(normalize=True).plot(figsize=(10,8),kind='bar',color='green')\nplt.title(\"Number of Door frequency diagram\")\nplt.ylabel('Number of Doors')\nplt.xlabel('num-of-doors');\n\nplt.subplot(224)\ndf['fuel_type'].value_counts(normalize= True).plot(figsize=(10,8),kind='bar',color='purple')\nplt.title(\"Number of Fuel Type frequency diagram\")\nplt.ylabel('Number of vehicles')\nplt.xlabel('fuel-type');\n\n\nplt.tight_layout()\nplt.subplots_adjust(wspace=0.3,hspace=0.5)\nplt.show()","7d68fd3a":"fig,a=plt.subplots(1,2,figsize=(10,2))\ndf.body_style.value_counts().plot.pie(explode=(0.03,0,0,0,0),autopct='%0.2f%%',figsize=(10,5),ax=a[0])\na[0].set_title('No. of cars sold')\n\n\ndf.groupby('body_style')['price'].agg(['mean','median','max']).sort_values(by='median',ascending=False).plot.bar(ax=a[1])\na[1].set_title('Price of each body_style')\nplt.tight_layout()\nplt.show()","648b0fca":"sns.catplot(data=df, y=\"normalized_losses\", x=\"symboling\"  ,kind=\"point\")","6dfc8b2a":"df.head()","5cec4221":"sns.lmplot('engine_size','highway_mpg',hue='make',data=df,fit_reg=False)\nplt.title('Engine_size Vs highway_mpg')\nplt.show()\n","d65fae70":"sns.lmplot('engine_size','city_mpg',hue='make',data=df,fit_reg=False)\nplt.title('Engine_size Vs city_mpg')","de1c1ad4":"df[['make','fuel_type','aspiration','number_of_doors','body_style','drive_wheels','engine_location']][df['engine_size']>=300]","05601d14":"# df.drive_wheels.value_counts().plot.bar()\nfig,ax=plt.subplots(2,1,figsize=(15,5))\nsns.countplot(x='drive_wheels',data=df,ax=ax[0])\ndf.groupby(['drive_wheels','make'])['price'].mean().plot.bar(ax=ax[1])\nplt.grid()\nplt.show()\n","d1a73975":"fig,ax=plt.subplots(2,1,figsize=(15,5))\nsns.countplot(x='drive_wheels',data=df,ax=ax[0])\ndf.groupby(['drive_wheels','body_style'])['price'].mean().plot.bar(ax=ax[1])\nax[1].set_ylabel('Price')\nplt.grid()\nplt.show()","c727bba1":"dff=pd.pivot_table(df,index=['body_style'],columns=['drive_wheels'],values=['engine_size'],\n                   aggfunc=['mean'],fill_value=0)\n\ndff.plot.bar(figsize=(15,5),rot=45)\nplt.show()\ndff","d4b04c97":"sns.kdeplot(df['price'],shade=True)","31e7d20b":"df.price.max()","9fd8baac":"df.groupby('drive_wheels')[['city_mpg','highway_mpg']].agg('sum').plot.bar()\ndf.groupby('drive_wheels')[['city_mpg','highway_mpg']].agg('sum')","78219221":"plt.figure(figsize=(15,10))\nsns.heatmap(df.corr(),annot=True)","ce34c81e":"sns.pairplot(df,aspect=1.5)","3420bd51":"sns.pairplot(data=df,x_vars=['city_mpg','highway_mpg','horsepower','engine_size','curb_weight'],y_vars=['price'],kind='reg',size=2.8)","396104aa":"sns.pairplot(data=df,x_vars=['city_mpg','highway_mpg'],y_vars=['horsepower'],hue='price',size=4)\nplt.savefig('pairplot.png')","cfb42eb5":"sns.pairplot(data=df,x_vars=['city_mpg','highway_mpg'],y_vars=['horsepower'],kind='reg',size=4)","ff5dab1d":"df=pd.read_csv(\"..\/input\/Automobile.csv\")\ndf.head()","4fa5190e":"df.shape","1bce4878":"cols=list(df.select_dtypes(include=['object']))\ncols\n","ca561443":"for i in cols:\n    print(i)\n#     print()\n    print(df[i].value_counts())\n    print()","b0d7d7f8":"#  We dont have any further use of [\"make\",\"body_style\"] to build our model, so drop ['make','body_style'] columns\n\ndf.drop(['make','body_style'],1,inplace=True)","9051930e":"df.columns","116b4c39":"df.describe(include='all').T","cb2b47d5":"#For those columns which are having 2 samples lets do label encoding and those columns which are having more than \n#2 samples lets do get_dummies for that\nlabcols=['engine_location','number_of_doors','fuel_type','aspiration']\nfrom sklearn.preprocessing import LabelEncoder\nle=LabelEncoder()\nfor i in labcols:\n#     print(i)\n    df[i]=le.fit_transform(df[i])\n# df.head()","87d6b042":"#get dummies\ndumcols=['drive_wheels','engine_type','fuel_system','number_of_cylinders']\ndf=pd.get_dummies(df,columns=dumcols,drop_first=True)","84d7c451":"df.head()","55e8cc9a":"y=df['price']\nX=df.drop('price',1)","c142d65a":"X.shape[1]","37ef3bad":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.30, random_state=42)","3670740a":"from sklearn.linear_model import LinearRegression\nlr=LinearRegression().fit(X_train,y_train)","308c9b7a":"y_pred=lr.predict(X_test)","6aa6bcb1":"from sklearn.metrics import r2_score,mean_squared_error\nprint('r2_score:',r2_score(y_test,y_pred))\n# print('rmse:',np.sqrt(mean_squared_error(y_test,y_pred)))","d6d20469":"y_train_pred=lr.predict(X_train)\nprint('train_score:',r2_score(y_train,y_train_pred))\nprint('test_score:',r2_score(y_test,y_pred))","88d8eaa7":"import statsmodels.api as sm\nXc=sm.add_constant(X_train)\nmodel=sm.OLS(y_train,Xc).fit()\nresult=model.summary()\nresult","b0ec5207":"r=df.columns\nr.shape","8b47f2be":"# Backward Elimination\ncols=list(X_train.columns)\nwhile(len(cols)>0):\n    p=[]\n    X=X_train[cols]\n    Xc=sm.add_constant(X)\n    model=sm.OLS(y_train,Xc).fit()\n    p=pd.Series(model.pvalues.values[1:],index=cols)\n    pmax=max(p)\n    feature_with_p_max=p.idxmax()\n    if(pmax>0.05):\n        cols.remove(feature_with_p_max)\n    else:\n        break\nselected_features_BE=cols\nprint(selected_features_BE) \nprint()\nprint('count_selected_colums: ',len(cols))\n    \n    \n    ","eaefb46e":"### if the columns are more then there will be chance of increment in VARIACNE ERROR,so thats why we sorted columns based on PValues","dd2efecb":"#from 40 colums it reduced to 17 columns,continue with the model building\nX_final=df[selected_features_BE]\ny=df['price']","4b93bfb1":"print(X_final.shape,y.shape)","dd57ead4":"from sklearn.linear_model import LinearRegression\nlr=LinearRegression().fit(X_final,y)","d78702e6":"lr.coef_","c3b63655":"pd.DataFrame(lr.coef_,index=X_final.columns,columns=['coefficents'])","2efb90d5":"print('beta0:',lr.intercept_)","847a3240":"from sklearn.model_selection import KFold,cross_val_score\nkfold=KFold(n_splits=3, shuffle=True, random_state=1)\ncv_score=cross_val_score(lr,X_final,y,cv=kfold)\nscore=np.mean(cv_score)\n# cv=cross_val_score(lr,X_final,y,scoring='neg_mean_squared_error',cv=kfold)\n# rm=(-1)*(cv)\nprint('the r2_score of the model:',score)\n# rmse=(np.sqrt(rm))\n# print(\"rmse:%0.02f,variance:%0.02f\" % (np.mean(rmse),np.var(rmse,ddof=1)))","0c5a321d":"print('rsquared value:',model.rsquared)","c9ca900e":"import pandas as pd\nAutomobile = pd.read_csv(\"..\/input\/Automobile.csv\")","1844d996":"From above heat map we can observe the positive and negative correaltions of each and every variable\n.Especially the PRICE of a car is based on the [horsepower,engine_size,curb_weight,width,length]\n.The milage is based of a car is based on the [horsepower,engine_size,curb_weight,width,length,]\n.The [bore,stroke,compression ratio] have no that much correlated to other variables","cf411710":"#There are some cars which are std aspiration are higher in price rather than Turbo but people are purcahsing more\nstd aspiration cars only due to the price, as we can see that the average price is less than 10000 dollars. So many\nof the people pretend to buy the std cars.","8e2803d6":"#there are 40 columns but as per Stats the columns whose PValue is >0.05 will makes the null Hypothesis to be True.\nThe Null Hypothesis for this is the mean for all columns are equal. Practically it can't be happen. So, Lets drop the cols whose PValue is greater than significant level","abd6d882":"Inference:\n    . Here +3 means risky vehicle and -2 means safe vehicle\n    . Increased in risk rating linearly increases in normalised losses in vehicle","a828bb45":"Inferences:\n    .Most of the car has a Curb Weight is in range 1900 to 3100\n    .The Engine Size is inrange 60 to 190\n    .Most vehicle has horsepower 50 to 125\n    .Most Vehicle are in price range 5000 to 18000\n    .peak rpm is mostly distributed between 4600 to 5700","0964d711":"As per before inferences, the people who purchased 46.77% sedan bodystyles cars which are having forward wheel drive(fwd)\nwhose cost range between 10000 to 11000 dollars followed by 33.83% of hatchback and 12.44% of wagon body styles are purchased\n","ec5ee8cd":"Inference:\n    . the city_mpg and highway_mpg are negatively correlated to horsepower and price also\n    . if the horse power increases the milage will decrease vice-versa.","0b514d41":"#we can observe that there is slight difference between train and test scores. As the train_score is high , the the model is overfit,it consists of Variance Error rather than Bias Error","60830594":"#from the pivot table and plot we can observe that the bodystyle of hardtop's engine size with 'rwd' is very much\ngreater also observed that [Convertible,Hardtop] body style's doesnot contain any '4wd'.","cafe4769":"Since it can be clearly shown from pair plot that the label(PRICE) is linearly proportional to some of the explanatory\nvariables. For such instances it good to go with LinearRegression model ","9772498d":"Inference:\n    . 46.7% of the cars were sold out are sedan model whose price are between 10000 to 15000 dollars following 33.8% of\n        cars were hatchback.\n    . The least no.of cars were sold out is the Convertible body type as its average price is somewhat higher as well\n       as its costlier","8ac9ea37":"Inference:\n    1.Most of the fwd vehicles sales are high followed by rwd and 4wd,the cars which are having forward weel drive\n    having a price less than the rear-Wheel drive.","eca3068d":"inference:\n    1. As the engine size increases the highway_mpg decreases, most of the volvo company cars has higher highway_mpg\n       because of its lesser engine size\n    2. The cars from jaguar are having less highway_mpg as its having heavy weight of engine","a90c3aa9":"From the above pairplot we can observe that which Variables are postively, negatively, and No correlations at all.","38a8498c":".About 70% of cars are manufactured with Over head Camshaft which can be assumed as the mordern cars are using OHC\n.About 40% of sales are going on Sedan cars following by Hatchback,Wagon\n.The cars  got sold were high in number which are having four doors rather than two doors.\n.About 80% of cars have Gas fuel system .","16184b22":"### BUILDING A MODEL","bdd02e9b":"### THE END","6b79dbfb":"Inference:\n    . the city_mpg,highway_mpg are negatively correlated to price\n    . the horse_power,engine_size,curb_weight are positively correlated to price\n    . It means that ciy","f06139ec":"inference:\n    1. As the engine size increases the highway_mpg decreases, most of the volvo company cars has higher city_mpg\n       because of its lesser engine size\n    2. The cars from jaguar are having less highway_mpg as its having heavy weight of engine","398a73ae":"#### Feature Engineering","9fda25bb":"The cars which are having forward wheel drive(fwd) having high milage followed by Rear wheel drive(rwd),4wd."}}