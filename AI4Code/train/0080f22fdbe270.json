{"cell_type":{"9103af2d":"code","8c66e5f1":"code","cd1daeff":"code","6906308c":"code","f0eb2ae2":"code","a95c509e":"code","9cc4e441":"code","bca368f1":"code","0c43930f":"code","b2c748ae":"code","93938084":"code","3aa865e9":"code","8890859d":"code","63413cd1":"code","da70c3cb":"code","0587ab42":"code","9e4287cf":"code","ab3574ff":"code","337c998e":"code","8e0e7bee":"code","1329b863":"code","0a5c5662":"code","b9507992":"code","74f355e9":"code","eedcffc3":"code","aab3a402":"code","ab120dd2":"code","ee4bb121":"code","379a3b5f":"code","b0b169ae":"code","fdc9a68c":"markdown","aa2b3dfa":"markdown","ae40672d":"markdown","b9bfc07f":"markdown","ee5e6078":"markdown"},"source":{"9103af2d":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","8c66e5f1":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom bokeh.plotting import figure, output_file, show\nfrom bokeh.layouts import row\nfrom bokeh.io import output_notebook\nimport statsmodels.api as sm\nimport statsmodels.formula.api as smf\nfrom patsy import dmatrices\nimport sklearn\nimport sklearn.metrics\nfrom sklearn import ensemble\nfrom sklearn import linear_model\nimport warnings\nwarnings.filterwarnings('ignore')\noutput_notebook()\n%matplotlib inline","cd1daeff":"df = pd.read_csv('\/kaggle\/input\/wine-quality-test\/winequality-red.csv')","6906308c":"df.head()","f0eb2ae2":"df.rename(columns={'fixed acidity': 'fixed_acidity','citric acid':'citric_acid','volatile acidity':'volatile_acidity','residual sugar':'residual_sugar','free sulfur dioxide':'free_sulfur_dioxide','total sulfur dioxide':'total_sulfur_dioxide'}, inplace=True)\ndf.head()","a95c509e":"sns.countplot(x='quality',data=df)","9cc4e441":"case = [\n    (df['quality'] >= 7),\n    (df['quality'] <= 4)\n]\nrating = ['good', 'bad']\ndf['rating'] = np.select(case, rating, default='average')","bca368f1":"df['rating'].value_counts()","0c43930f":"corr = df.corr()\nplt.figure(figsize=(12, 5))\nsns.heatmap(corr, annot=True, linewidths=0, vmin=-1, cmap=\"viridis\")","b2c748ae":"corr['quality'].sort_values(ascending=False)","93938084":"sns.boxplot(x='quality',y='alcohol',data=df)","3aa865e9":"sns.boxplot(x='rating',y='alcohol',data=df)","8890859d":"sns.boxplot(x='rating',y='sulphates',data=df)","63413cd1":"sns.boxplot(x='rating',y='citric_acid',data=df)","da70c3cb":"sns.boxplot(x='rating',y='fixed_acidity',data=df)","0587ab42":"sns.lmplot(x = \"alcohol\", y = \"residual_sugar\", col = \"rating\", data = df)","9e4287cf":"from sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.metrics import mean_squared_error","ab3574ff":"# separating input and output features\n\nx1=df[['fixed_acidity','citric_acid','sulphates','alcohol']]\ny1=df['quality']","337c998e":"# spliting data into test and train \n\nx_train,x_test,y_train,y_test=train_test_split(x1,y1,test_size=0.3,random_state=3)","8e0e7bee":"print(x_train.shape,x_test.shape,y_train.shape,y_test.shape)","1329b863":"# setting intercept as True\n\nlgr=LinearRegression(fit_intercept=True)","0a5c5662":"\n# model\n\nmodel_lin=lgr.fit(x_train,y_train)","b9507992":"# predicting model on test set\n\nwine_pred_lin=lgr.predict(x_test)","74f355e9":"# computing MSE & RMSE\n\nlin_mse=mean_squared_error(y_test,wine_pred_lin)\nlin_rmse=np.sqrt(lin_mse)\nprint(lin_rmse)","eedcffc3":"# R squared value => R sqrt value tell us how's good your model explian you variablty in y\n\nr2_lin_test=model_lin.score(x_test,y_test)\nr2_lin_train=model_lin.score(x_train,y_train)","aab3a402":"print(r2_lin_test,r2_lin_train)","ab120dd2":"df['rate_code'] = (df['quality'] > 4).astype(np.float32)","ee4bb121":"y, X = dmatrices('rate_code ~ alcohol', data = df)\nsns.distplot(X[y[:,0] > 0, 1])\nsns.distplot(X[y[:,0] == 0, 1])","379a3b5f":"model = sklearn.linear_model.LogisticRegression()\ny,X = dmatrices('rate_code ~ alcohol + sulphates + citric_acid + fixed_acidity', data = df)\nmodel.fit(X, y)\nyhat = model.predict(X)\nprint(sklearn.metrics.classification_report(y, yhat))","b0b169ae":"y, X = dmatrices('rate_code ~ alcohol', data = df)\nmodel = sklearn.ensemble.RandomForestClassifier()\nmodel.fit(X, y)\nyhat = model.predict(X)\nprint(sklearn.metrics.classification_report(y, yhat))","fdc9a68c":"We can observe that, the 'alcohol, sulphates, citric_acid & fixed_acidity' have maximum corelation with response variable 'quality'.\nThis means that, we will use only these 4 variables in our future analysis.","aa2b3dfa":"This analysis can help in manufacturing the good quality wine with continuous monitoring and contrilling the alcohol and residual sugar content of the red wine.","ae40672d":"**Linear Regression**","b9bfc07f":"**Classification using Sklearn's RandomForestClassifier:**","ee5e6078":"**Classification using Sklearn's LogisticRegression:****"}}