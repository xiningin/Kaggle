{"cell_type":{"416962f0":"code","3b321e13":"code","549a024d":"code","8128817c":"code","978347c3":"code","407fcc38":"code","024e4c73":"code","54af9350":"code","6940890e":"code","b69d9f73":"code","9999b16c":"code","59278eee":"code","792f6662":"code","5f2fa80c":"code","3838766e":"code","1a4965c8":"code","39660e3c":"code","6fed06e9":"code","bf501ea4":"code","33b7131f":"code","f4b6813e":"code","d5019de3":"code","092b4174":"code","8fdd85e8":"code","f1b46a61":"code","27a9f5c9":"code","1dfe6674":"code","e18ba064":"code","5d0fd2f7":"code","e970720a":"code","c6a3fc93":"code","612faa0e":"code","048e9c6a":"code","70a02ad7":"code","f3798fe0":"code","38780ade":"code","732a6a42":"code","e7b20969":"code","8162ba81":"code","96655a2e":"code","a83664a7":"code","58ba5546":"code","abf6d775":"code","c3edf43f":"code","de97783c":"code","ffd580cc":"code","882752b3":"code","01d8aa99":"code","21f66a37":"code","cf0f016b":"code","5988de8e":"code","988f618d":"code","7313ffb8":"code","b309d77f":"code","56bc2d20":"code","9a1c8846":"code","1abae1e5":"code","880d4e89":"code","1e686617":"code","19956c18":"code","3dfb1800":"code","2e29fefa":"code","7b544dd0":"code","9a35b98e":"code","e61f35f1":"code","18f6155e":"code","b678b285":"code","958fd759":"code","6730e56b":"code","be471ef2":"code","1579aca4":"code","55f4e60d":"code","5518af0a":"code","8f4f4970":"code","82c73aaa":"code","5063a5e5":"code","4148fa08":"code","8f6c306b":"code","e9ec9e8d":"code","3c5fc390":"code","6ac1c77e":"code","968e5da8":"code","389763b7":"code","7642e77c":"code","4207816f":"code","333437ae":"code","0182ca29":"code","433dea59":"code","b9d348a9":"code","aa1324c6":"code","ffd50f80":"code","30345d2b":"code","5451e03a":"code","bb2ac97a":"code","48abd15a":"code","29a6aa36":"code","de28dd6f":"code","3b062122":"code","58cc1652":"code","ce9637fa":"code","e204a8d8":"code","eb391ea4":"code","72590231":"code","fe377f65":"code","d60f8aec":"code","659481f2":"code","bd888007":"code","d42e2726":"code","9dd3e98e":"code","892396d9":"code","2704f1ef":"code","9989170b":"code","b3a2abfd":"code","1bf8c80a":"code","a4243ea8":"markdown","1de03a88":"markdown","3a594df8":"markdown","d560b3c4":"markdown","ea7764cb":"markdown","56dffb99":"markdown","c8a14fb3":"markdown","8c85b924":"markdown","50a6b464":"markdown","a7c4b479":"markdown","4c4003f4":"markdown"},"source":{"416962f0":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport tensorflow as tf\nfrom sklearn.model_selection import train_test_split,GridSearchCV","3b321e13":"df=pd.read_csv('..\/input\/cervical-cancer-risk-classification\/kag_risk_factors_cervical_cancer.csv')","549a024d":"df.head()","8128817c":"df.info()","978347c3":"df = df.replace('?', np.nan) ","407fcc38":"df=df.apply(pd.to_numeric)\ndf","024e4c73":"df.describe()","54af9350":"df.isna().sum()","6940890e":"abs(df.corr()['Biopsy']).sort_values()","b69d9f73":"(df['STDs:AIDS'].value_counts()+105)==len(df)","9999b16c":"df['STDs: Time since first diagnosis'].value_counts().sum()+787","59278eee":"df.drop(['STDs:AIDS','STDs:cervical condylomatosis'],axis=1,inplace=True)","792f6662":"df","5f2fa80c":"df['Number of sexual partners'].value_counts()","3838766e":"df['Hormonal Contraceptives'].value_counts()","1a4965c8":"df['Smokes (packs\/year)'].value_counts()","39660e3c":"df['Smokes (years)'].value_counts()","6fed06e9":"df.drop(['Number of sexual partners','First sexual intercourse'],axis=1,inplace=True)","bf501ea4":"df.isna().sum()","33b7131f":"df.Smokes.value_counts()","f4b6813e":"df.loc[df['Smokes'].isna()]","d5019de3":"df['Smokes'].fillna(0.0,inplace=True)\ndf['Smokes (packs\/year)'].fillna(0.0,inplace=True)\ndf['Smokes (years)'].fillna(0.0,inplace=True)","092b4174":"df['Num of pregnancies'].value_counts()","8fdd85e8":"df.loc[df['Num of pregnancies'].isna()]","f1b46a61":"df.loc[df['Num of pregnancies']==3.0].mean()","27a9f5c9":"df.loc[df['Num of pregnancies']==2.0].mean()","1dfe6674":"df.loc[df['Num of pregnancies']==1.0].mean()","e18ba064":"df.corr()['Num of pregnancies']","5d0fd2f7":"df.loc[df['Num of pregnancies'].isna()].sort_values('Age')","e970720a":"df.loc[[819,812,690,814,745,811,744,703,544,692,697,699,693,706,696,810,813,365,265,653,816,707],'Num of pregnancies']='1.0'\ndf.loc[[708,272,820,689,197,691,421,650,702,167,698,185,694,700,695,701,545,817,808,809,123,815],'Num of pregnancies']='2.0'\ndf.loc[[818,96,807,41,19,704,651,18,652,654,9,705],'Num of pregnancies']='3.0'","c6a3fc93":"df.isna().sum()","612faa0e":"df['IUD (years)'].value_counts()","048e9c6a":"df['IUD'].fillna(df['IUD'].mode()[0],inplace=True)\ndf['IUD (years)'].fillna(df['IUD (years)'].mode()[0],inplace=True)","70a02ad7":"df['Hormonal Contraceptives'].value_counts()","f3798fe0":"0.358667*len(df)","38780ade":"abs(df.corr()['Hormonal Contraceptives (years)']).sort_values()","732a6a42":"df.loc[df['Hormonal Contraceptives'].isna()].sort_values('Age')[:30]['Hormonal Contraceptives'].fillna(0.0,inplace=True)\ndf.loc[df['Hormonal Contraceptives (years)'].isna()].sort_values('Age')[:30]['Hormonal Contraceptives (years)'].fillna(0.0,inplace=True)","e7b20969":"df_hor_nan_30=df.loc[df['Hormonal Contraceptives'].isna()].sort_values('Age')[:29]\nfor i in df_hor_nan_30.index:\n    df['Hormonal Contraceptives'].iloc[i]=0.0","8162ba81":"df_hor_nan=df.loc[df['Hormonal Contraceptives'].isna()]\nfor i in df_hor_nan.index:\n    df['Hormonal Contraceptives'].iloc[i]=1.0","96655a2e":"df_hor_yrs_nan_30=df.loc[df['Hormonal Contraceptives (years)'].isna()].sort_values('Age')[:29]\nfor i in df_hor_yrs_nan_30.index:\n    df['Hormonal Contraceptives (years)'].iloc[i]=0.0","a83664a7":"df_hor_yrs_nan=(df.loc[df['Hormonal Contraceptives (years)'].isna()]).sort_values('Age')\ndf_hor_yrs_nan","58ba5546":"for i in df_hor_yrs_nan.index[:14]:\n    df['Hormonal Contraceptives (years)'].iloc[i]=0.25\nfor i in df_hor_yrs_nan.index[14:16]:\n    df['Hormonal Contraceptives (years)'].iloc[i]=0.5\nfor i in df_hor_yrs_nan.index[16:43]:\n    df['Hormonal Contraceptives (years)'].iloc[i]=1.0\nfor i in df_hor_yrs_nan.index[43:57]:\n    df['Hormonal Contraceptives (years)'].iloc[i]=2.0\nfor i in df_hor_yrs_nan.index[57:71]:\n    df['Hormonal Contraceptives (years)'].iloc[i]=3.0\nfor i in df_hor_yrs_nan.index[71:79]:\n    df['Hormonal Contraceptives (years)'].iloc[i]=5.0","abf6d775":"df.isna().sum()","c3edf43f":"pd.to_numeric(df['Num of pregnancies'],)","de97783c":"df=df.astype({'Num of pregnancies':'float'})","ffd580cc":"df.info()","882752b3":"abs(df.corr()['Biopsy']).sort_values()","01d8aa99":"df['STDs: Time since first diagnosis'].fillna(0.0,inplace=True)\ndf['STDs: Time since last diagnosis'].fillna(0.0,inplace=True)","21f66a37":"df.loc[df['STDs:HPV'].isna()]","cf0f016b":"df.isnull().sum()","5988de8e":"df['STDs'].value_counts()","988f618d":"df['STDs (number)'].value_counts()","7313ffb8":"df['STDs:HIV'].value_counts()","b309d77f":"df['STDs:HPV'].value_counts()","56bc2d20":"df[df.columns[11:21]].sum().sum()","9a1c8846":"df['STDs (number)'].sum().sum()","1abae1e5":"df['STDs'].sum()","880d4e89":"df.loc[df['STDs: Number of diagnosis']==0.0].isnull().sum()","1e686617":"for i in df.columns:\n    df[i].fillna(0.0,inplace=True)","19956c18":"df.isnull().sum()","3dfb1800":"df_corr=df.corr()['Biopsy']","2e29fefa":"abs(df_corr).sort_values()","7b544dd0":"df.drop(['Hormonal Contraceptives'],axis=1,inplace=True)","9a35b98e":"y=df['Biopsy']\nX=df.drop(['Biopsy'],axis=1)","e61f35f1":"X_train, X_val,y_train,y_val=train_test_split(X,y,test_size=0.2,random_state=0)","18f6155e":"class_weight = {0: .07, 1: 1.}","b678b285":"from sklearn.linear_model import LogisticRegression\n\nlog=LogisticRegression(solver='sag')","958fd759":"log.fit(X_train,y_train)","6730e56b":"log.score(X_val,y_val)","be471ef2":"log.score(X_train,y_train)","1579aca4":"from sklearn.metrics import plot_confusion_matrix\nplot_confusion_matrix(log,X_val,y_val)","55f4e60d":"from sklearn.svm import SVC","5518af0a":"param_grid = {'C': [ 1000,10000], \n              'gamma': [ 0.0001,0.00001],\n              'kernel': ['rbf','poly']} \ngrid=GridSearchCV(SVC(),param_grid)","8f4f4970":"grid.fit(X_train,y_train)","82c73aaa":"grid.best_params_","5063a5e5":"svc=SVC(**grid.best_params_)","4148fa08":"svc.fit(X_train,y_train)","8f6c306b":"svc.score(X_train,y_train)","e9ec9e8d":"svc.score(X_val,y_val)","3c5fc390":"plot_confusion_matrix(svc,X_val,y_val)","6ac1c77e":"from sklearn.ensemble import RandomForestClassifier\n\nrf=RandomForestClassifier()","968e5da8":"param_grid = { \n    'n_estimators': [50,100,200,500],\n    'max_features': ['auto', 'sqrt', 'log2'],\n    'max_depth' : [2,3,4,5,6,7,8],\n    'criterion' :['gini', 'entropy']\n}","389763b7":"grid_rf=GridSearchCV(rf,param_grid)\ngrid_rf.fit(X_train,y_train)","7642e77c":"grid_rf.best_params_","4207816f":"rf=RandomForestClassifier(**grid_rf.best_params_)","333437ae":"rf.fit(X_train,y_train)","0182ca29":"rf.score(X_train,y_train)","433dea59":"rf.score(X_val,y_val)","b9d348a9":"plot_confusion_matrix(rf,X_val,y_val)","aa1324c6":"from sklearn.ensemble import GradientBoostingClassifier\nGBC=GradientBoostingClassifier()","ffd50f80":"GBC.fit(X_train,y_train)","30345d2b":"GBC.score(X_train,y_train)","5451e03a":"GBC.score(X_val,y_val)","bb2ac97a":"plot_confusion_matrix(GBC,X_val,y_val)","48abd15a":"from sklearn.ensemble import VotingClassifier\nfrom sklearn.model_selection import cross_val_score\n\neclf = VotingClassifier(\n    estimators=[('svc', svc), ('rf', rf), ('GBC', GBC)],\n    voting='hard')\n\nfor clf_num, label in zip([svc, rf, GBC ], ['Support Vector Machine', 'Random Forest', 'GBC']):\n    scores = cross_val_score(clf_num, X_train, y_train, scoring='accuracy', cv=5)\n    print(\"Accuracy: %0.2f (+\/- %0.2f) [%s]\" % (scores.mean(), scores.std(), label))","29a6aa36":"eclf.fit(X_train, y_train)","de28dd6f":"eclf.score(X_train,y_train)","3b062122":"eclf.score(X_val,y_val)","58cc1652":"plot_confusion_matrix(eclf\n                      ,X_val,y_val)","ce9637fa":"import tensorflow as tf","e204a8d8":"model=tf.keras.Sequential([\n    tf.keras.layers.Dense(32,activation='relu'),\n    tf.keras.layers.Dense(64,activation='relu'),\n    tf.keras.layers.Dense(1,activation='sigmoid')\n])","eb391ea4":"model.compile(optimizer='adam',loss='binary_crossentropy',metrics=['accuracy'])","72590231":"history=model.fit(X_train,y_train,epochs=80,validation_data=(X_val,y_val))","fe377f65":"# PLOT LOSS AND ACCURACY\n%matplotlib inline\n\nimport matplotlib.image  as mpimg\nimport matplotlib.pyplot as plt\n\nacc=history.history['accuracy']\nval_acc=history.history['val_accuracy']\nloss=history.history['loss']\nval_loss=history.history['val_loss']\n\nepochs=range(len(acc)) # Get number of epochs\n\n#------------------------------------------------\n# Plot training and validation accuracy per epoch\n#------------------------------------------------\nplt.plot(epochs, acc, 'r', \"Training Accuracy\")\nplt.plot(epochs, val_acc, 'b', \"Validation Accuracy\")\nplt.title('Training and validation accuracy')\nplt.figure()\n\n#------------------------------------------------\n# Plot training and validation loss per epoch\n#------------------------------------------------\nplt.plot(epochs, loss, 'r', \"Training Loss\")\nplt.plot(epochs, val_loss, 'b', \"Validation Loss\")\n\n\nplt.title('Training and validation loss')","d60f8aec":"y_prediction=model.predict(X_val)\ncutoff=0.5\ny_pred=np.where(y_prediction>cutoff,1,0)","659481f2":"from sklearn.metrics import confusion_matrix\ncm_deep = confusion_matrix(y_val, y_pred)\ncm_deep","bd888007":"cm_matrix = pd.DataFrame(data=cm_deep, columns=['Actual Positive:1', 'Actual Negative:0'], \n                                 index=['Predict Positive:1', 'Predict Negative:0'])\n\nsns.heatmap(cm_matrix, annot=True)","d42e2726":"model=tf.keras.Sequential([\n    tf.keras.layers.Dense(32,activation='relu'),\n    tf.keras.layers.Dense(64,activation='relu'),\n    tf.keras.layers.Dense(1,activation='sigmoid')\n])","9dd3e98e":"model.compile(optimizer='adam',loss='binary_crossentropy',metrics=['accuracy'])","892396d9":"history=model.fit(X_train,y_train,epochs=80,class_weight=class_weight,validation_data=(X_val,y_val))","2704f1ef":"# PLOT LOSS AND ACCURACY\n%matplotlib inline\n\nimport matplotlib.image  as mpimg\nimport matplotlib.pyplot as plt\n\nacc=history.history['accuracy']\nval_acc=history.history['val_accuracy']\nloss=history.history['loss']\nval_loss=history.history['val_loss']\n\nepochs=range(len(acc)) # Get number of epochs\n\n#------------------------------------------------\n# Plot training and validation accuracy per epoch\n#------------------------------------------------\nplt.plot(epochs, acc, 'r', \"Training Accuracy\")\nplt.plot(epochs, val_acc, 'b', \"Validation Accuracy\")\nplt.title('Training and validation accuracy')\nplt.figure()\n\n#------------------------------------------------\n# Plot training and validation loss per epoch\n#------------------------------------------------\nplt.plot(epochs, loss, 'r', \"Training Loss\")\nplt.plot(epochs, val_loss, 'b', \"Validation Loss\")\n\n\nplt.title('Training and validation loss')","9989170b":"y_prediction=model.predict(X_val)\ncutoff=0.5\ny_pred=np.where(y_prediction>cutoff,1,0)","b3a2abfd":"from sklearn.metrics import confusion_matrix\ncm_deep = confusion_matrix(y_val, y_pred)\ncm_deep","1bf8c80a":"cm_matrix = pd.DataFrame(data=cm_deep, columns=['Actual Positive:1', 'Actual Negative:0'], \n                                 index=['Predict Positive:1', 'Predict Negative:0'])\n\nsns.heatmap(cm_matrix, annot=True)","a4243ea8":"# Deep learning","1de03a88":"# Import libraries","3a594df8":"# Random Forest","d560b3c4":"# Deep learning with class weighting for compensate imbalanced class got a best score. ","ea7764cb":"# GradientBoostingClassifier","56dffb99":"# Voting classifier","c8a14fb3":"# Deep learning with class weighting","8c85b924":"'''\nCervical Cancer Risk Factors for Biopsy: This Dataset is Obtained from UCI Repository and kindly acknowledged!\n\nThis file contains a List of Risk Factors for Cervical Cancer leading to a Biopsy Examination!\n\nAbout 11,000 new cases of invasive cervical cancer are diagnosed each year in the U.S. However, the number of new cervical cancer \ncases has been declining steadily over the past decades. Although it is the most preventable type of cancer, each year \ncervical cancer kills about 4,000 women in the U.S. and about 300,000 women worldwide. In the United States, cervical cancer mortality rates plunged by 74% from 1955 - 1992 thanks to increased screening and early detection with the Pap test. AGE Fifty percent of cervical cancer diagnoses occur in women ages 35 - 54, and about 20% occur in women over 65 years of age. The median age of diagnosis is 48 years. About 15% of women develop cervical cancer between the ages of 20 - 30. Cervical cancer is extremely rare in women younger than age 20. However, many young women become infected with multiple types of human papilloma virus, which then can increase their risk of getting cervical cancer in the future. Young women with early abnormal changes who do not have regular examinations are at high risk for localized cancer by the time they are age 40, and for invasive cancer by age 50. SOCIOECONOMIC AND ETHNIC FACTORS Although the rate of cervical cancer has declined among both Caucasian and African-American women over the past decades, it remains much more prevalent in African-Americans -- whose death rates are twice as high as Caucasian women. Hispanic American women have more than twice the risk of invasive cervical cancer as Caucasian women, also due to a lower rate of screening. These differences, however, are almost certainly due to social and economic differences. Numerous studies report that high poverty levels are linked with low screening rates. In addition, lack of health insurance, limited transportation, and language difficulties hinder a poor woman\u2019s access to screening services. HIGH SEXUAL ACTIVITY Human papilloma virus (HPV) is the main risk factor for cervical cancer. In adults, the most important risk factor for HPV is sexual activity with an infected person. Women most at risk for cervical cancer are those with a history of multiple sexual partners, sexual intercourse at age 17 years or younger, or both. A woman who has never been sexually active has a very low risk for developing cervical cancer. Sexual activity with multiple partners increases the likelihood of many other sexually transmitted infections (chlamydia, gonorrhea, syphilis).Studies have found an association between chlamydia and cervical cancer risk, including the possibility that chlamydia may prolong HPV infection. FAMILY HISTORY Women have a higher risk of cervical cancer if they have a first-degree relative (mother, sister) who has had cervical cancer. USE OF ORAL CONTRACEPTIVES Studies have reported a strong association between cervical cancer and long-term use of oral contraception (OC). Women who take birth control pills for more than 5 - 10 years appear to have a much higher risk HPV infection (up to four times higher) than those who do not use OCs. (Women taking OCs for fewer than 5 years do not have a significantly higher risk.) The reasons for this risk from OC use are not entirely clear. Women who use OCs may be less likely to use a diaphragm, condoms, or other methods that offer some protection against sexual transmitted diseases, including HPV. Some research also suggests that the hormones in OCs might help the virus enter the genetic material of cervical cells. HAVING MANY CHILDREN Studies indicate that having many children increases the risk for developing cervical cancer, particularly in women infected with HPV. SMOKING Smoking is associated with a higher risk for precancerous changes (dysplasia) in the cervix and for progression to invasive cervical cancer, especially for women infected with HPV. IMMUNOSUPPRESSION Women with weak immune systems, (such as those with HIV \/ AIDS), are more susceptible to acquiring HPV. Immunocompromised patients are also at higher risk for having cervical precancer develop rapidly into invasive cancer. DIETHYLSTILBESTROL (DES) From 1938 - 1971, diethylstilbestrol (DES), an estrogen-related drug, was widely prescribed to pregnant women to help prevent miscarriages. The daughters of these women face a higher risk for cervical cancer. DES is no longer prsecribed.\n'''","50a6b464":"# Data_preprocessing","a7c4b479":"# Linear model","4c4003f4":"# SVC"}}