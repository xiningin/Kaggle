{"cell_type":{"00aad34c":"code","cb0adef2":"code","72fe31b1":"code","320e9cde":"code","e0eb1a9e":"code","23553820":"code","dcf3e392":"code","fc8ba3ac":"code","7c407105":"code","2d5fbd87":"code","7c3e5b96":"code","df616c83":"code","a0b1e05c":"code","7d9e0b25":"code","df0868d2":"code","fa4eed71":"code","38497449":"code","e9823969":"code","1cabccdd":"code","713fd1d1":"code","8b196be1":"code","934382bc":"code","a00ed8e7":"code","dd3483ab":"code","976bb309":"code","1be49020":"code","fb53aa69":"code","25a0be73":"code","f219b0bb":"code","4994ffc0":"code","a9f9ec0b":"markdown"},"source":{"00aad34c":"# !pip install pycaret","cb0adef2":"import pandas as pd \nimport numpy as np\nimport category_encoders as ce\n# from pycaret.regression import *\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom sklearn.linear_model import Ridge\nfrom sklearn.preprocessing import normalize","72fe31b1":"df_train = pd.read_csv(\"..\/input\/pubg-finish-placement-prediction\/train_V2.csv\")\ndf_test = pd.read_csv(\"..\/input\/pubg-finish-placement-prediction\/test_V2.csv\")\ndf_test_copy = df_test.copy()","320e9cde":"df_train","e0eb1a9e":"df_test","23553820":"df_train.isnull().sum()","dcf3e392":"df_test.isnull().sum()","fc8ba3ac":"df_train[\"winPlacePerc\"] = df_train[\"winPlacePerc\"].fillna(np.mean(df_train[\"winPlacePerc\"]))","7c407105":"for i in df_train.columns:\n    print(i,df_train[i].value_counts())","2d5fbd87":"cols_to_be_removed=[\"Id\",\"groupId\",\"matchId\"]","7c3e5b96":"df_train[\"assists\"].unique()","df616c83":"df_train[\"damageDealt\"].describe()","a0b1e05c":"df_train.dtypes","7d9e0b25":"df_train.describe()","df0868d2":"df_train[\"DBNOs\"].unique()","fa4eed71":"df_train[\"matchType\"].describe()","38497449":"df_train = df_train.drop(columns=cols_to_be_removed,axis = 1)\ndf_test = df_test.drop(columns=cols_to_be_removed,axis = 1)","e9823969":"def one_hot_encoding(df,col):\n    one_hot_encoder=ce.OneHotEncoder(cols=col,return_df=True,use_cat_names=True)\n    df_final = one_hot_encoder.fit_transform(df)\n    return df_final","1cabccdd":"df_train = one_hot_encoding(df_train,\"matchType\")\n","713fd1d1":"df_test = one_hot_encoding(df_test,\"matchType\")","8b196be1":"df_train.dtypes","934382bc":"# experiment = setup(data= df_train,target = \"winPlacePerc\")","a00ed8e7":"# compare_models()","dd3483ab":"X_train = df_train.drop(\"winPlacePerc\",axis = 1)\nX_test = df_test.copy()\nY_train = df_train[\"winPlacePerc\"]","976bb309":"X_train = normalize(X_train)\nX_test = normalize(X_test)\n","1be49020":"ridge_regr = Ridge()\nridge_regr.fit(X_train, Y_train)","fb53aa69":"df_train.to_csv(\"df_train_cleaned.csv\",index = False)\ndf_test.to_csv(\"df_test_cleaned.csv\",index = False)","25a0be73":"Y_pred = ridge_regr.predict(X_test)","f219b0bb":"submission = pd.DataFrame()\nsubmission[\"id\"] = df_test_copy[\"Id\"]\nsubmission[\"winPlacePerc\"] = Y_pred","4994ffc0":"submission.to_csv(\"submission.csv\",index = False)","a9f9ec0b":"<a href=\".\/submission.csv\"> Download File <\/a>"}}