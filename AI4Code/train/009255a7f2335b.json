{"cell_type":{"9ef6ac70":"code","264f84e1":"code","3be4e86a":"code","22187a03":"code","65029ed2":"code","45315713":"code","7f49554d":"code","8852cef9":"code","4fcbb6fa":"code","44d6b3af":"code","44e40b46":"code","0332466e":"code","2f3a6ff4":"code","7027b6a7":"code","9eec6ca4":"code","ca41d4e6":"code","b3344a62":"code","3e4ab80e":"code","e0d5ebc0":"code","552176f4":"code","0b6f43cc":"code","88cf9a9c":"code","7b3661e4":"markdown","eff1e07c":"markdown","30d6bf11":"markdown","67cad7c6":"markdown","9e7957bd":"markdown","1cd2848e":"markdown","0f533e01":"markdown","e6a79f9f":"markdown","e2b0afcd":"markdown","c0401fdd":"markdown","9db065d2":"markdown"},"source":{"9ef6ac70":"!pip install pycaret","264f84e1":"!pip install shap","3be4e86a":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\nimport missingno as msno\n\nimport warnings\nwarnings.simplefilter(action='ignore', category=FutureWarning)\n\nfrom pycaret.classification import setup, create_model, get_config, tune_model, finalize_model, predict_model, plot_model, interpret_model\nimport shap","22187a03":"train = pd.read_csv('..\/input\/titanic\/train.csv')\ntest = pd.read_csv('..\/input\/titanic\/test.csv')\ntrain.head()","65029ed2":"train.describe().T","45315713":"test.describe().T","7f49554d":"msno.bar(train)","8852cef9":"msno.bar(test)","4fcbb6fa":"fig,ax = plt.subplots(1, 2,figsize = (15,6))\nsns.countplot(x=\"Pclass\",hue = 'Survived',data=train[train['Sex'] == 'male'],ax = ax[0])\nsns.countplot(x=\"Pclass\",hue = 'Survived', data=train[train['Sex'] == 'female'],ax = ax[1])\nax[0].set_title('Male')\nax[1].set_title('Female')\nfor i in np.arange(2):\n    for p in ax[i].patches:\n        height = p.get_height()\n        ax[i].text(p.get_x()+p.get_width()\/2., height + .3,height ,ha=\"center\") ","44d6b3af":"fig,ax = plt.subplots(figsize = (15,6))\nsns.histplot(x=\"Age\",kde = True, hue='Survived',data=train)","44e40b46":"test['Survived'] = 9\ndf = pd.concat([train, test], sort=False,axis=0)\n\n# Add family size and whether you are traveling alone\ndf['FamilySize'] = df['Parch'] + df['SibSp'] + 1\ndf['IsAlone'] = 0\ndf.loc[df['Parch'] + df['SibSp'] == 0 , 'IsAlone'] = 1\n\n# under 15 years old or not\ndf['IsChild'] = 0\ndf.loc[df['Age'] < 16 , 'IsChild'] = 1\n\n# Number of people with the same ticket number\ndf.loc[:, 'TicketSize'] = df.groupby(['Ticket'])['PassengerId'].transform('count')\n\ndf = df.drop(['PassengerId','Ticket','Name','Cabin'], axis=1)\ndf_train = df.query('Survived != 9')\ndf_test = df.query('Survived == 9').drop(['Survived'], axis=1)\n\ndf_train.head()","0332466e":"df_test.head()","2f3a6ff4":"clf = setup(data=df_train, target='Survived', \n            numeric_features=['Pclass','SibSp','Parch','FamilySize','TicketSize'], \n            silent= True, session_id=123)","7027b6a7":"X_train = get_config('X_train')\nX_train","9eec6ca4":"lightgbm = create_model('lightgbm')\ntuned = tune_model(lightgbm)\npredh = predict_model(tuned)\nfinal = finalize_model(tuned)\npred = predict_model(final, data=df_test)","ca41d4e6":"pred","b3344a62":"plot_model(final, plot=\"auc\") ","3e4ab80e":"plot_model(final, plot=\"confusion_matrix\") ","e0d5ebc0":"plot_model(final, plot=\"feature\") ","552176f4":"interpret_model(final)","0b6f43cc":"interpret_model(final, plot = 'reason', observation=12)","88cf9a9c":"submission = pd.read_csv(\"..\/input\/titanic\/gender_submission.csv\")\nsubmission.Survived = pred.Label\nsubmission.to_csv('lightgbm_submission.csv',index=False)\nsubmission","7b3661e4":"## Predict with PyCaret","eff1e07c":"## EDA","30d6bf11":"Missing values for Age, Cabin, and Embarked.","67cad7c6":"# TITANIC | PyCaret baseline","9e7957bd":"Missing values for Age, Fare, and Cabin.","1cd2848e":"## Feature Engineering","0f533e01":"Women in Class 1 and 2 have a high probability of survival.","e6a79f9f":"There seems to be no bias in the data between the train data and the test data. The average age of the test data is slightly lower than the train data, but it is not enough to be concerned about.","e2b0afcd":"## Submit","c0401fdd":"The child has a high probability of survival.  \nA closer look at the data shows that Ticket has multiple with the same ticket number, and the fare is the same amount per ticket number.","9db065d2":"## Model Analysis"}}