{"cell_type":{"9cfd1771":"code","bd9369b0":"code","576cdea9":"code","f654ecea":"code","e1949d82":"code","37becaac":"code","a6d87275":"markdown","1a28bbf2":"markdown","f3c7960b":"markdown","e8ed4e07":"markdown","aac5d63b":"markdown","057a61b3":"markdown"},"source":{"9cfd1771":"import tensorflow as tf\nfrom tensorflow.keras.layers import Dense, Flatten ,Dropout, Conv2D, MaxPooling2D, BatchNormalization\nfrom tensorflow.keras.models import Sequential\nimport numpy as np\nimport os \nimport random\nimport cv2\nfrom sklearn.model_selection import train_test_split","bd9369b0":"categories = {'cane': 'dog', \"cavallo\": \"horse\", \"elefante\": \"elephant\", \"farfalla\": \"butterfly\", \"gallina\": \"chicken\", \"gatto\": \"cat\", \"mucca\": \"cow\", \"pecora\": \"sheep\", \"scoiattolo\": \"squirrel\",\"ragno\":\"spider\"}\ndata=[]\nanimals=[\"dog\", \"horse\",\"elephant\", \"butterfly\",  \"chicken\",  \"cat\", \"cow\",  \"sheep\", \"squirrel\",\"spider\"]\nimg_size=100\ndef create_data():\n        for category,translate in categories.items():\n            path=\"..\/input\/animals10\/raw-img\/\"+category\n            target=animals.index(translate)\n            \n            for img in os.listdir(path):\n                try:\n                    img_array=cv2.imread(os.path.join(path,img),cv2.IMREAD_GRAYSCALE)\n                    new_img_array=cv2.resize(img_array,(img_size,img_size))\n                    data.append([new_img_array,target])\n                except Exception as e:\n                    pass\n                \n            \ncreate_data()            ","576cdea9":"random.shuffle(data)\nx=[]\ny=[]\nfor features,labels in data:\n    x.append(features)\n    y.append(labels)   \nx_train,x_test,y_train,y_test=train_test_split(x,y,test_size=0.2)","f654ecea":"\nx_train=np.array(x_train).reshape(-1,img_size,img_size,1)\nx_train=tf.keras.utils.normalize(x_train,axis=1)\ny_train=np.array(y_train)\n","e1949d82":"# model=Sequential()\n# model.add(Conv2D(32, kernel_size = 3, activation='relu', input_shape = x_train.shape[1:]))\n# model.add(BatchNormalization())\n# model.add(Conv2D(32, kernel_size = 3, activation='relu'))\n# model.add(BatchNormalization())\n# model.add(Conv2D(32, kernel_size = 5, strides=2, padding='same', activation='relu'))\n# model.add(BatchNormalization())\n# model.add(Dropout(0.4))\n# model.add(Conv2D(64, kernel_size = 5, strides=2, padding='same', activation='relu'))\n# model.add(BatchNormalization())\n# model.add(Dropout(0.4))\n# model.add(Conv2D(256, kernel_size = 4, activation='relu'))\n# model.add(BatchNormalization())\n# model.add(Flatten())\n# model.add(Dropout(0.4))\n# model.add(Dense(64, activation='softmax'))          \n# model.compile(optimizer=\"adam\", loss=\"sparse_categorical_crossentropy\", metrics=[\"accuracy\"])          ","37becaac":"\n# model.fit(x_train,y_train,epochs=50,batch_size=1000)\n# prediction=model.predict(np.array(x_test).reshape(-1,img_size,img_size,1))\n# model.score(y_test,prediction)","a6d87275":"To build the model run the following code it will give up to 90% accuracy.","1a28bbf2":"## Importing Libraries","f3c7960b":"In this notebook we build a model using tensorflow that can classify animals.","e8ed4e07":"## Building Model","aac5d63b":"## Creating training and testing dataset","057a61b3":"# Animal Classifier"}}