{"cell_type":{"eb14f198":"code","7fba9d13":"code","0dc7233e":"code","cd1b162b":"code","61c542fa":"code","bcd69cc7":"code","d328cf7a":"code","8f6a01a9":"code","2ddf6c15":"code","f8bfae84":"code","0968b4ba":"code","83cc7d94":"code","0680aee8":"code","58ec57cd":"code","0bc9d5c6":"code","35cc7777":"code","b3f73c1b":"code","e68757d4":"code","7cf9e091":"code","4188119a":"code","e4ff1d1a":"code","027dfd24":"code","dd019b22":"code","15dfcd56":"code","7acd641e":"code","d0b047f7":"code","3c5df7ef":"code","ba5f29ae":"code","fca73b9d":"code","1b6fdaf0":"code","ac861e4e":"code","a76125e8":"markdown","62696976":"markdown","0ff52773":"markdown","33a6021b":"markdown","1272e636":"markdown","2354489a":"markdown","6c0e9811":"markdown","514720bf":"markdown","d9c0ffef":"markdown","24ea9b15":"markdown","39b63edf":"markdown","7d2ad011":"markdown","efbe8d95":"markdown","cb5e0640":"markdown","5f5c2f21":"markdown","a75364df":"markdown","f63a5dbd":"markdown","4120f133":"markdown","5cfe7de0":"markdown","1c27bf4b":"markdown","22c81e82":"markdown","afe6783d":"markdown","c22de55b":"markdown","f18d7df1":"markdown","d24e288d":"markdown","c8ff5b11":"markdown","942d735c":"markdown","7043b4dd":"markdown"},"source":{"eb14f198":"import pandas as pd\nPATH = '..\/input\/prozorro-public-procurement-dataset\/Competitive_procurements.csv'\nimport warnings\nwarnings.filterwarnings('ignore')","7fba9d13":"procs = pd.read_csv(PATH)\nprocs.head()","0dc7233e":"procs['lot_announce_month'] = procs.apply(lambda row: row.lot_announce_date[:7], axis = 1) ","cd1b162b":"lots_per_month = procs.groupby(['lot_announce_month', 'lot_id']).size().groupby('lot_announce_month').count().reset_index()\nlots_per_month.columns = ['lot_announce_month', 'number_of_lots']","61c542fa":"import matplotlib.pyplot as plt\nimport numpy as np\n%matplotlib notebook\n\nplt.figure(figsize=(12,5))\nplt.plot(lots_per_month.lot_announce_month, lots_per_month.number_of_lots)\nplt.xticks(['2015-02','2015-12','2016-12',\n            '2017-12','2018-12', '2019-12'], \n           ['2015-02','15-12','16-12',\n            '17-12','18-12','2019-12'])\nplt.yticks([30000, 25000, 20000, 15000, 10000, 5000, 0],\n           ['30 000', '25 000', '20 000', '15 000', '10 000', '5 000', 0])\nplt.xlabel('month')\nplt.ylabel('number of lots')\nplt.title('Number of lots')\nplt.grid(True)\nplt.show()","bcd69cc7":"supps_per_lot = procs.groupby(['lot_announce_month', 'lot_id']).size().groupby('lot_announce_month').agg('mean').reset_index()\nsupps_per_lot.columns = ['lot_announce_month', 'supps_per_lot']","d328cf7a":"plt.figure(figsize=(12,5))\nplt.plot(supps_per_lot.lot_announce_month, supps_per_lot.supps_per_lot, color='#4f5c8a')\nplt.xticks(['2015-02', '2015-12', '2016-12', '2017-12', '2018-12', '2019-12'], \n           ['2015-02', '15-12', '16-12', '17-12', '18-12', '2019-12'])\nplt.xlabel('month')\nplt.ylabel('supps per lot')\nplt.title('Suppliers per lot')\nplt.grid(True)\nplt.show()","8f6a01a9":"sales = procs[procs.supplier_dummy == 1].groupby('lot_announce_month').agg({'lot_final_value':'sum'}).reset_index()\nsales.columns = ['lot_announce_month', 'sales']","2ddf6c15":"procs['savings'] = procs.apply(lambda row: row.lot_initial_value - row.lot_final_value, axis = 1)","f8bfae84":"savings = procs[procs.supplier_dummy == 1].groupby('lot_announce_month').agg({'savings':'sum'}).reset_index()","0968b4ba":"plt.figure(figsize=(12,5))\nplt.plot(sales.lot_announce_month, sales.sales, color='#395838')\nplt.plot(savings.lot_announce_month, savings.savings, color='#4f8a56')\nplt.xticks(['2015-02', '2015-12', '2017-02', '2017-12', '2018-11', '2019-12'], \n           ['2015-02', '15-12', '17-02', '17-12', '18-11', '2019-12'])\nplt.yticks([50*10**9, 40*10**9, 30*10**9, 20*10**9, 10*10**9, 0],\n           ['50B', '40B', '30B', '20B', '10B', '0'])\nplt.xlabel('month')\nplt.ylabel('UAH')\nplt.title('Sales and Savings')\nplt.legend(['sales', 'savings'])\nplt.grid(True)\nplt.show()","83cc7d94":"plt.figure(figsize=(12,5))\nplt.plot(savings.lot_announce_month, savings.savings, color='#4f8a56')\nplt.xticks(['2015-02', '2015-12', '2017-02', '2017-12', '2018-11', '2019-12'], \n           ['2015-02', '15-12', '17-02', '17-12', '18-11', '2019-12'])\nplt.yticks([5*10**9, 4*10**9, 3*10**9, 2*10**9, 10**9, 0],['5B', '4B', '3B', '2B', '1B', '0'])\nplt.xlabel('month')\nplt.ylabel('savings (UAH)')\nplt.title('Savings')\nplt.grid(True)\nplt.show()","0680aee8":"times_participated = procs.groupby(['participant_name']).filter(lambda row: row['supplier_dummy'].sum() > 0).groupby(['participant_name']).size().reset_index()\ntimes_participated.columns = ['participant_name', 'times_participated']","58ec57cd":"times_won = procs[procs.supplier_dummy == 1].groupby(['participant_name']).size().reset_index()\ntimes_won.columns = ['participant_name', 'times_won']","0bc9d5c6":"total_sales = procs[procs.supplier_dummy == 1].groupby(['participant_name']).agg({'lot_final_value':'sum'}).reset_index()\ntotal_sales.columns = ['participant_name', 'total_sales']","35cc7777":"pd.options.display.float_format = '{:,.0f}'.format\npd.options.display.max_colwidth = 80\ntop_suppliers = pd.DataFrame({'participant_name':times_participated.participant_name,\n                                 'times_participated':times_participated.times_participated,\n                                 'times_won':times_won.times_won,\n                                 'total_sales':total_sales.total_sales})\n\ntop_suppliers.sort_values('total_sales', ascending=False).head(20)","b3f73c1b":"procs['market'] = procs.apply(lambda row: row.lot_cpv_2_digs[11:], axis = 1)","e68757d4":"top_suppliers_by_market = procs[procs.supplier_dummy == 1].groupby(['market','participant_name']).agg({'lot_final_value':'sum'}).reset_index()\ntop_suppliers_by_market.columns = ['market','participant_name','total_sales']","7cf9e091":"market_total_sales = top_suppliers_by_market.groupby(['market']).agg({'total_sales':'sum'}).reset_index()","4188119a":"\ntop_suppliers_by_market = top_suppliers_by_market.groupby(['market']).apply(lambda row: row.nlargest(5,['total_sales'])).reset_index(drop=True)\ntop_suppliers_by_market['market_share'] = ''\n\nfor i in range(len(market_total_sales)):\n    for j in range(5):\n        top_suppliers_by_market.market_share[5*i+j] = top_suppliers_by_market.total_sales[5*i+j]\/market_total_sales.total_sales[i]\n\ndef insert_row_(row_number, df, row_value): \n    df1 = df[0:row_number] \n    df2 = df[row_number:] \n    df1.loc[row_number]=row_value \n    df_result = pd.concat([df1, df2]) \n    df_result.index = [*range(df_result.shape[0])] \n    return df_result \n\n        \nfor i in range(len(top_suppliers_by_market)+46):\n    if (i%6 == 0):\n        top_suppliers_by_market = insert_row_(i,  top_suppliers_by_market, ['','','',''])","e4ff1d1a":"pd.set_option('display.max_rows', 500)\npd.options.display.max_colwidth = 100\npd.options.display.float_format = '{:,.2f}'.format","027dfd24":"top_suppliers_by_market","dd019b22":"market_total_sales.sort_values('total_sales', ascending=False)","15dfcd56":"construction_market = procs[procs.market.isin(['Construction work',\n                                               'Construction structures and materials; auxiliary products to construction (except electric apparatus)',\n                                               'Electrical machinery, apparatus, equipment and consumables; lighting',\n                                               'Architectural, construction, engineering and inspection services'])]\n\nfuel_market = procs[procs.market.isin(['Petroleum products, fuel, electricity and other sources of energy',\n                                       'Services related to the oil and gas industry'])]\n\nagricultural_market = procs[procs.market.isin(['Agricultural, farming, fishing, forestry and related products',\n                                               'Agricultural, forestry, horticultural, aquacultural and apicultural services',\n                                               'Agricultural machinery'])]","7acd641e":"construction_market_sales = construction_market[construction_market.supplier_dummy == 1].groupby('lot_announce_month').agg({'lot_final_value':'sum'}).reset_index()\nconstruction_market_sales.columns = ['lot_announce_month', 'construction']\nfuel_market_sales = fuel_market[fuel_market.supplier_dummy == 1].groupby('lot_announce_month').agg({'lot_final_value':'sum'}).reset_index()\nfuel_market_sales.columns = ['lot_announce_month', 'fuel']\nagricultural_market_sales = agricultural_market[agricultural_market.supplier_dummy == 1].groupby('lot_announce_month').agg({'lot_final_value':'sum'}).reset_index()\nagricultural_market_sales.columns = ['lot_announce_month', 'agricultural']","d0b047f7":"plt.figure(figsize=(12,5))\nplt.plot(construction_market_sales.lot_announce_month, construction_market_sales.construction, color='#ac0000')\nplt.plot(fuel_market_sales.lot_announce_month, fuel_market_sales.fuel, color='#007dac')\nplt.plot(agricultural_market_sales.lot_announce_month, agricultural_market_sales.agricultural, color='#007810')\nplt.xticks(['2015-02', '2015-12', '2016-12', '2017-12', '2018-12', '2019-12'], \n           ['2015-02', '15-12', '16-12', '17-12', '18-12', '2019-12'])\nplt.yticks([35*10**9, 30*10**9, 25*10**9, 20*10**9, 15*10**9, 10*10**9, 5*10**9, 0],\n           ['35B', '30B', '25B', '20B', '15B', '10B', '5B', '0'])\nplt.xlabel('month')\nplt.ylabel('UAH')\nplt.title('Sales of market')\nplt.legend(['construction', 'fuel', 'agricultural'])\nplt.grid(True)\nplt.show()","3c5df7ef":"construction_market_savings = construction_market[construction_market.supplier_dummy == 1].groupby('lot_announce_month').agg({'savings':'sum'}).reset_index()\nconstruction_market_savings.columns = ['lot_announce_month', 'construction']\nfuel_market_savings = fuel_market[fuel_market.supplier_dummy == 1].groupby('lot_announce_month').agg({'savings':'sum'}).reset_index()\nfuel_market_savings.columns = ['lot_announce_month', 'fuel']\nagricultural_market_savings = agricultural_market[agricultural_market.supplier_dummy == 1].groupby('lot_announce_month').agg({'savings':'sum'}).reset_index()\nagricultural_market_savings.columns = ['lot_announce_month', 'agricultural']","ba5f29ae":"plt.figure(figsize=(12,5))\nplt.plot(construction_market_sales.lot_announce_month, construction_market_sales.construction, color='#ac0000')\nplt.plot(construction_market_savings.lot_announce_month, construction_market_savings.construction, color='#ab4d4d')\nplt.xticks(['2015-02', '2015-12', '2016-12', '2017-12', '2018-12', '2019-12'], \n           ['2015-02', '15-12', '16-12', '17-12', '18-12', '2019-12'])\nplt.yticks([35*10**9, 30*10**9, 25*10**9, 20*10**9, 15*10**9, 10*10**9, 5*10**9, 0],\n           ['35B', '30B', '25B', '20B', '15B', '10B', '5B', '0'])\nplt.xlabel('month')\nplt.ylabel('UAH')\nplt.title('Sales and savings - Construction')\nplt.legend(['sales', 'savings'])\nplt.grid(True)\nplt.show()","fca73b9d":"plt.figure(figsize=(12,5))\nplt.plot(fuel_market_sales.lot_announce_month, fuel_market_sales.fuel, color='#007dac')\nplt.plot(fuel_market_savings.lot_announce_month, fuel_market_savings.fuel, color='#4d86ab')\nplt.xticks(['2015-12', '2016-12', '2017-12', '2018-12', '2019-12'], \n           ['15-12', '16-12', '17-12', '18-12', '2019-12'])\nplt.yticks([ 20*10**9, 15*10**9, 10*10**9, 5*10**9, 0],\n           ['20B','15B', '10B', '5B', '0'])\nplt.xlabel('month')\nplt.ylabel('UAH')\nplt.title('Sales and savings - Fuel')\nplt.legend(['sales', 'savings'])\nplt.grid(True)\nplt.show()","1b6fdaf0":"plt.figure(figsize=(12,5))\nplt.plot(agricultural_market_sales.lot_announce_month, agricultural_market_sales.agricultural, color='#007810')\nplt.plot(agricultural_market_savings.lot_announce_month, agricultural_market_savings.agricultural, color='#3f7847')\nplt.xticks(['2015-12', '2016-12', '2017-12', '2018-12', '2019-12'], \n           ['15-12', '16-12', '17-12', '18-12', '2019-12'])\nplt.yticks([700*10**6, 550*10**6, 400*10**6, 250*10**6, 100*10**6, 0],\n           ['700M', '550M', '400M','250M', '100M', '0'])\nplt.xlabel('month')\nplt.ylabel('UAH')\nplt.title('Sales and savings - Agricultural')\nplt.legend(['sales', 'savings'])\nplt.grid(True)\nplt.show()","ac861e4e":"plt.figure(figsize=(12,5))\nplt.plot(construction_market_sales.lot_announce_month, \n         construction_market_savings.construction\/construction_market_sales.construction, color='#ac0000')\nplt.plot(fuel_market_sales.lot_announce_month, \n         fuel_market_savings.fuel\/fuel_market_sales.fuel, color='#007dac')\nplt.plot(agricultural_market_sales.lot_announce_month, \n         agricultural_market_savings.agricultural\/agricultural_market_sales.agricultural, color='#007810')\nplt.xticks(['2015-02', '2015-12', '2016-12', '2017-12', '2018-12', '2019-12'], \n           ['2015-02', '15-12', '16-12', '17-12', '18-12', '2019-12'])\nplt.yticks([0.5, 0.4, 0.3, 0.2, 0.1, 0],\n           ['50%', '40%', '30%', '20%', '10%', 0])\nplt.xlabel('month')\nplt.ylabel('percent')\nplt.title('% of savings')\nplt.legend(['construction', 'fuel', 'agricultural'])\nplt.grid(True)\nplt.show()","a76125e8":"On the plot below we can see part of savings in sales for each market:","62696976":"Although market selection for each one above may vary, but I think it will be representative enough.","0ff52773":"Lets see a list of largest companies:","33a6021b":"Here we see top 5 companies in each market with its market share, separated by a blank line:","1272e636":"# Companies\n\n**Which companies dominate the market? Can any procurement markets be classified as monopoly \/ oligopoly?**","2354489a":"We see that savings in fuel market are the highest overall, reached over 40% in the end of last year and 20%+ and 30%+ within last 3 years. We see a peak in agricultural market in 2017 with over 40% savings. Also savings were high in all markets in 2016.\n\nWe have analyzed only 3 markets, there is still a lot of room for further exploration.","6c0e9811":"Here we can see 20 largest companies ordered by total sales:","514720bf":"According to the ukrainian law, a monopoly is considered when the company occupies 35%. A situation in which the aggregate share of no more than three business entities in one market exceeds 50% and the aggregate share of no more than five business entities - 70% is also considered a monopoly.\n\n\n1. We see that market **Financial and insurance services** has a company with 52% of market share; \n2. **Agricultural machinery** has 3 companies with total market share of 51%;\n3. **Public utilities** has 3 companies with total market share of 54%;","d9c0ffef":"Lets build a plot to see the number of lots in each month. We will create new column in format yyyy-mm to use it as X axis in plots:","24ea9b15":"We see, that competition was highest at the start, when lot count was not very high yet. In 2019 suppliers per lot reached year maximum at 2.5\n\nI would say that suppliers per lot is pretty much consistent for last 3 years.","39b63edf":"At 2018-11 were maximum sales at more than 50B UAH. (UAH (hryvnya) is ukrainian currency, 27 UAH = 1 USD)\n\nBy the end of 2019 sales have dropped to less than 10B.","7d2ad011":"Lets also plot savings on separate plot:","efbe8d95":"# Analysis of procurements\n\nThe purpose of this work is to analyze Ukraine procurements data.\n\n**About the dataset**\n\nI will be using **Competitive_procurements** dataset. It includes all competitive procurements and all participants of competitive procurements in 2015-2019. Each row of the dataset is related to one procurement and one participant. Thus one procurement is related to multiple rows if there were more than one company competing to become a supplier.\n\nIn this work I will try to answer 3 queastions Oleksa Stepaniuk had asked in Research ideas ([link](https:\/\/www.kaggle.com\/oleksastepaniuk\/prozorro-public-procurement-dataset)).","cb5e0640":"We see that savings in fuel market are quite high, lets also compare savings in the end.","5f5c2f21":"From the plot we can see, that lot count reached peak at the end of the 2016 and then started to gradually decrease up to 2020. Also lot count is close to periodical in last 3 years - it has peaks at the beginning and end of each year.","a75364df":"Now lets see whether competition is growing. We will plot the avarage number of participants per lot in each month:","f63a5dbd":"Lets see a list of markets with thier sales:","4120f133":"# Competition and savings\n\nFirst queastion we will try to answer is:\n\n**Is there an evidence of increased competition? Does increased competition always lead to the increase of public savings?**","5cfe7de0":"For this, we will create new column:","1c27bf4b":"We will create new column for ease of use:","22c81e82":"We see, that savings have a trend to gradually grow within last 3 years with some peaks every winter.\n\nSo, we cant see any evidence of increased competition. Also, sales have dropped a lot in 2019 and reached 2016-level.","afe6783d":"First company is the main fuel company in Ukraine, it has almost 38B in sales for last 4 years. Third one is interesting: I dont really know what DEIC is, it had participated only once, but with 19B sale.","c22de55b":"Now lets analize 3 markets in more detail:","f18d7df1":"Lets see how total sales and savings are changing","d24e288d":"# Markets\n\n**How implementation of the new electronic system affected the public procurement market? Are the changes the same across different markets (e.g. markets of fuel procurement vs. procurement of professional services)?**","c8ff5b11":"Here we can see a lot with 5 participants. Last column **supplier_dummy** indicates if participant had won this lot.","942d735c":"Now lets make a list to see the largest companies in each market.","7043b4dd":"At first, lets see what we are working with:"}}