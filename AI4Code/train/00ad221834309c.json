{"cell_type":{"e3ecfc1d":"code","ee2f4a6b":"code","914da885":"code","9504a9cb":"code","7bf49781":"code","471e5142":"code","7ee62b5c":"code","48adf54a":"code","c449ec8b":"code","1f0bb811":"code","0be74332":"code","e017c859":"code","ad24f140":"code","551373d2":"code","4a7ea556":"code","d5b02d85":"code","b544ef48":"code","46fe6f39":"code","cece1640":"code","85382d66":"code","3c990173":"code","613505fd":"code","7536d5ee":"code","989c4b06":"markdown","f1faedbc":"markdown","fe974c63":"markdown","7f662b18":"markdown","fc0fe502":"markdown","11ef5dbb":"markdown","faef2867":"markdown","f13286e2":"markdown","56a0e029":"markdown","cfcf2df6":"markdown","e4c169b4":"markdown","932dcf33":"markdown","50e2a9ef":"markdown","a3ac437b":"markdown","2105aa53":"markdown","88dacf6f":"markdown","ca32a129":"markdown"},"source":{"e3ecfc1d":"import pandas as pd\nimport numpy as np\nimport networkx as nx\nfrom plotly.offline import download_plotlyjs, init_notebook_mode, iplot\nimport plotly.graph_objs as go","ee2f4a6b":"init_notebook_mode(connected=True)","914da885":"network_df = pd.read_csv(\"..\/input\/network_data.csv\") ","9504a9cb":"network_df.head()","7bf49781":"A = list(network_df[\"source_ip\"].unique())","471e5142":"B = list(network_df[\"destination_ip\"].unique())","7ee62b5c":"node_list = set(A+B)","48adf54a":"G = nx.Graph()","c449ec8b":"for i in node_list:\n    G.add_node(i)","1f0bb811":"#G.nodes()","0be74332":"for i,j in network_df.iterrows():\n    G.add_edges_from([(j[\"source_ip\"],j[\"destination_ip\"])])","e017c859":"pos = nx.spring_layout(G, k=0.5, iterations=50)","ad24f140":"#pos","551373d2":"for n, p in pos.items():\n    G.node[n]['pos'] = p","4a7ea556":"edge_trace = go.Scatter(\n    x=[],\n    y=[],\n    line=dict(width=0.5,color='#888'),\n    hoverinfo='none',\n    mode='lines')\n\nfor edge in G.edges():\n    x0, y0 = G.node[edge[0]]['pos']\n    x1, y1 = G.node[edge[1]]['pos']\n    edge_trace['x'] += tuple([x0, x1, None])\n    edge_trace['y'] += tuple([y0, y1, None])","d5b02d85":"node_trace = go.Scatter(\n    x=[],\n    y=[],\n    text=[],\n    mode='markers',\n    hoverinfo='text',\n    marker=dict(\n        showscale=True,\n        colorscale='RdBu',\n        reversescale=True,\n        color=[],\n        size=15,\n        colorbar=dict(\n            thickness=10,\n            title='Node Connections',\n            xanchor='left',\n            titleside='right'\n        ),\n        line=dict(width=0)))\n\nfor node in G.nodes():\n    x, y = G.node[node]['pos']\n    node_trace['x'] += tuple([x])\n    node_trace['y'] += tuple([y])","b544ef48":"for node, adjacencies in enumerate(G.adjacency()):\n    node_trace['marker']['color']+=tuple([len(adjacencies[1])])\n    node_info = adjacencies[0] +' # of connections: '+str(len(adjacencies[1]))\n    node_trace['text']+=tuple([node_info])","46fe6f39":"fig = go.Figure(data=[edge_trace, node_trace],\n             layout=go.Layout(\n                title='<br>AT&T network connections',\n                titlefont=dict(size=16),\n                showlegend=False,\n                hovermode='closest',\n                margin=dict(b=20,l=5,r=5,t=40),\n                annotations=[ dict(\n                    text=\"No. of connections\",\n                    showarrow=False,\n                    xref=\"paper\", yref=\"paper\") ],\n                xaxis=dict(showgrid=False, zeroline=False, showticklabels=False),\n                yaxis=dict(showgrid=False, zeroline=False, showticklabels=False)))\n\niplot(fig)\nplotly.plot(fig)","cece1640":"from plotly.plotly import plot","85382d66":"from plotly import plotly","3c990173":"import plotly","613505fd":"plotly.tools.set_credentials_file(username='anand0427', api_key='5Xd8TlYYqnpPY5pkdGll')","7536d5ee":"iplot(fig,\"anand0427\",filename=\"Network Graph.html\")","989c4b06":"# Network Graph with plotly and networkx","f1faedbc":"### Thats a nice plot! So we reached the end of this kernel! Let me know if you have any doubts or what you think :)","fe974c63":"#### source_ip and destination_ip are of our interest here. so we isolate them. We then get the unique ip addresses for getting the total number of nodes. We do this by taking unique values in both columns and joining them together.","7f662b18":"### Adding positions of the nodes to the graph","fc0fe502":"a# References \n[Plotly Network Graph Example](https:\/\/plot.ly\/python\/network-graphs\/)\n\n[Networkx Docs](https:\/\/networkx.github.io\/documentation\/networkx-1.9.1\/)","11ef5dbb":"##### Uncomment the below code to see the nodes list. ","faef2867":"<h2 id=\"prep\">Preparing the data<\/h2>","f13286e2":"<h2 id=\"graph\">Creating the graph<\/h2>","56a0e029":"<h2 id=\"final\">Plotting the figure<\/h2>","cfcf2df6":"#### Coloring based on the number of connections of each node. ","e4c169b4":"<h2 id=\"plotly\">Adding nodes and edges to the plotly api<\/h2>","932dcf33":"<h2 id=\"adj\">Coloring nodes<\/h2>","50e2a9ef":"## We go through 6 steps to create a network graph.\n1. [Preparing the data](#prep)\n2. [Creating the graph](#graph)\n3. [Get node positions](#pos)\n4. [Add nodes and edges to plotly API](#plotly)\n5. [Color the nodes](#adj)\n6. [Plot the figure](#final)","a3ac437b":"## I recently had to create some network graphs for one of my projects and I realised how nice and interesting they are. So i decided to create a kernel with the AT&T dataset. Check out the dataset [here](https:\/\/www.kaggle.com\/latentheat\/att-network-data)","2105aa53":"### Graph api to create an empty graph. And the below cells we will create nodes and edges and add them to our graph","88dacf6f":"<h2 id=\"pos\">Getting positions for each node.<\/h2>","ca32a129":"##### Uncomment below code to see the positions of all the nodes"}}