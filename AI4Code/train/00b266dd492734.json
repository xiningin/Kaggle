{"cell_type":{"79e76f1d":"code","a4f6fd49":"code","5b8bbf03":"code","0cde6e4d":"code","2ae0fd9a":"code","fb23759d":"code","a03b4519":"code","394312fc":"code","1bb7a458":"code","d65c50bc":"code","c2fa0e6f":"code","32831ec3":"code","db672c66":"markdown","4391c3f5":"markdown","1d98dd31":"markdown","9d6a0fce":"markdown","24c2197f":"markdown","84d3281a":"markdown","2b0fe90b":"markdown","42695a88":"markdown","239be256":"markdown"},"source":{"79e76f1d":"%reload_ext autoreload\n%autoreload 2\n%matplotlib inline","a4f6fd49":"from fastai import *\nfrom fastai.vision import *\nfrom fastai.imports import *\n\nimport os","5b8bbf03":"data_path = Path('..\/input\/chest_xray\/chest_xray')\ndata_path","0cde6e4d":"np.random.seed(42)\ndata = ImageDataBunch.from_folder(path=data_path,\n                                  train='train',\n                                  valid='val',\n                                  test='test',\n                                  size=224,\n                                  bs=64,\n                                  valid_pct=0.2,\n                                  ds_tfms=get_transforms())\ndata.normalize(imagenet_stats)\ndata.show_batch(rows=5)","2ae0fd9a":"learner = cnn_learner(data=data,\n                      base_arch=models.resnet50,\n                      metrics=error_rate,\n                      model_dir=\"\/tmp\/model\/\")","fb23759d":"learner.fit_one_cycle(4)","a03b4519":"learner.unfreeze()","394312fc":"learner.save('stage-1')","1bb7a458":"learner.lr_find()\nlearner.recorder.plot()","d65c50bc":"learner.fit_one_cycle(10, max_lr=slice(3e-6, 3e-5))\nlearner.recorder.plot_losses()","c2fa0e6f":"interp = ClassificationInterpretation.from_learner(learner)\nlosses,idxs = interp.top_losses()\nlen(data.valid_ds)==len(losses)==len(idxs)","32831ec3":"interp.plot_top_losses(9, figsize=(15,11))","db672c66":"### Quick look at the data","4391c3f5":"Essential notebook initialization code for automatic library reload","1d98dd31":"## A fastai implementation of a X-Ray pneumonia detector","9d6a0fce":" Training the network using Leslie Smith's 1cycle policy","24c2197f":"We are going to use rasnet50, feel free to use other models, you can find fastai supported models here docs.fast.ai\/vision.models.html","84d3281a":"We are going to use Paul Mooney's Kaggle dataset (https:\/\/www.kaggle.com\/paultimothymooney\/chest-xray-pneumonia)","2b0fe90b":"Importing all necessary packages","42695a88":"Unfreez the network so we'll train on the entire model","239be256":"### Training phase"}}