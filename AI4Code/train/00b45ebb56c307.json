{"cell_type":{"a336925e":"code","e0b893b2":"code","de4db519":"code","6e0e0360":"code","d287e292":"code","4a9737d2":"code","45e7593e":"code","435c524a":"code","ecc58269":"code","26572576":"code","b3016ca2":"code","9cdae3cf":"code","24b40ca8":"code","8d1b7873":"code","fa678c22":"code","abf01450":"code","cd738a04":"code","557832a0":"code","3ba1e861":"code","4670b7c7":"code","8ab60e70":"code","c5d6331b":"code","4407a38b":"code","807c7ea9":"markdown","0fdf011b":"markdown","ce11cf0f":"markdown","f2528c1c":"markdown","333a9b5c":"markdown","479b41d1":"markdown","5fec4f8c":"markdown","0527a882":"markdown","263e5a0a":"markdown","d136e8f0":"markdown","cd9da98e":"markdown"},"source":{"a336925e":"#loading\nimport pandas as pd\nimport numpy as np\nimport missingno as msno\n# Data Visualization\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n!pip install chart_studio\nimport chart_studio.plotly as py\nimport plotly.graph_objs as go\nfrom plotly.offline import iplot, init_notebook_mode\nimport cufflinks\ncufflinks.go_offline()\ncufflinks.set_config_file(world_readable=True, theme='pearl')\n#preprocessing \nfrom sklearn.preprocessing import StandardScaler, LabelEncoder\nfrom collections import Counter\n# Classification \nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import confusion_matrix, classification_report, accuracy_score\nfrom sklearn.svm import SVC\nfrom sklearn.ensemble import RandomForestClassifier\nfrom xgboost import XGBClassifier","e0b893b2":"data = pd.read_csv(\"..\/input\/air-quality-data-in-india\/city_day.csv\")\ndata['Date'] = pd.to_datetime(data['Date'])\ndata.rename(columns = {'AQI_Bucket':'Air_quality'}, inplace = True)\ndata.head()","de4db519":"data.info()","6e0e0360":"msno.heatmap(data)","d287e292":"df1 = data.copy()\ndf1['PM2.5']=df1['PM2.5'].fillna((df1['PM2.5'].median()))\ndf1['PM10']=df1['PM10'].fillna((df1['PM10'].median()))\ndf1['NO']=df1['NO'].fillna((df1['NO'].median()))\ndf1['NO2']=df1['NO2'].fillna((df1['NO2'].median()))\ndf1['NOx']=df1['NOx'].fillna((df1['NOx'].median()))\ndf1['NH3']=df1['NH3'].fillna((df1['NH3'].median()))\ndf1['CO']=df1['CO'].fillna((df1['CO'].median()))\ndf1['SO2']=df1['SO2'].fillna((df1['SO2'].median()))\ndf1['O3']=df1['O3'].fillna((df1['O3'].median()))\ndf1['Benzene']=df1['Benzene'].fillna((df1['Benzene'].median()))\ndf1['Toluene']=df1['Toluene'].fillna((df1['Toluene'].median()))\ndf1['Xylene']=df1['Xylene'].fillna((df1['Xylene'].median()))\ndf1['AQI']=df1['AQI'].fillna((df1['AQI'].median()))\ndf1['Air_quality']=df1['Air_quality'].fillna('Moderate')","4a9737d2":"df = df1.copy()\ndf = df[df['Date'] <= ('01-01-2020')] \ndf['Vehicular Pollution content'] = df['PM2.5']+df['PM10']+df['NO']+df['NO2']+df['NOx']+df['NH3']+df['CO']\ndf['Industrial Pollution content'] = df['SO2']+df['O3']+df['Benzene']+df['Toluene']+df['Xylene']\ndf = df.drop(['PM2.5', 'PM10', 'NO', 'NO2', 'NOx', 'NH3', 'CO', 'SO2',\n       'O3','Benzene','Toluene','Xylene'],axis=1)\ndf.info()","45e7593e":"def ploting(var):\n    df[var].iplot(title=var,xTitle='Cities',yTitle=var, linecolor='black', )\n    plt.show()\nploting('Vehicular Pollution content')\nploting('Industrial Pollution content')","435c524a":"def max_bar_plot(var):\n    x1 = df[['City',var]].groupby([\"City\"]).median().sort_values(by = var,\n    ascending = True).tail(10).iplot(kind='bar', xTitle='Cities',yTitle=var, \n                                     linecolor='black', title='{2} {1} {0}'.format(\")\",var,' Most polluted cities('))\n\np1 = max_bar_plot('Industrial Pollution content')\np2 = max_bar_plot('Vehicular Pollution content')","ecc58269":"def min_bar_plot(var):\n    x1 = df[['City',var]].groupby([\"City\"]).mean().sort_values(by = var,\n    ascending = True).head(10).iplot(kind='bar', yTitle='Cities',xTitle=var, linecolor='black',title='{2} {1} {0}'.format(\")\",var,' Minimum polluted cities('))\np1 = min_bar_plot('Industrial Pollution content')\np2 = min_bar_plot('Vehicular Pollution content')","26572576":"def al(var):\n    cities = [var]\n    filtered_city_day = df1[df1['Date'] <= '2020-04-01']\n    AQI = filtered_city_day[filtered_city_day.City.isin(cities)][['City','Air_quality']]\n    AQI[var] = AQI['Air_quality']\n    k = AQI[var].value_counts()\n    m = pd.DataFrame((round((k\/sum(k))*100)))\n    return m\nc11 = al('Ahmedabad')\nc22 = al('Delhi')\nc33 = al('Kolkata')\nc44 = al('Mumbai')\nc55 = al('Bengaluru')\ndf_row = pd.concat([c11,c22,c33,c44,c55],axis=1)\ndf_row.iplot(kind='bar', align='center',xTitle='Satisfaction level', yTitle='percentage of satisfaction' ,linecolor='black', title='Satisfaction level of people(Pre COVID19)')","b3016ca2":"df = df1.copy()\ndf = df[df['Date'] > ('01-01-2020')] \ndf['Vehicular Pollution content'] = df['PM2.5']+df['PM10']+df['NO']+df['NO2']+df['NOx']+df['NH3']+df['CO']\ndf['Industrial Pollution content'] = df['SO2']+df['O3']+df['Benzene']+df['Toluene']+df['Xylene']\ndf = df.drop(['PM2.5', 'PM10', 'NO', 'NO2', 'NOx', 'NH3', 'CO', 'SO2',\n       'O3','Benzene','Toluene','Xylene'],axis=1)\ndf.info()","9cdae3cf":"def ploting(var):\n    df[var].iplot(title=var,xTitle='Cities',yTitle=var, linecolor='black', )\n    plt.show()\nploting('Vehicular Pollution content')\nploting('Industrial Pollution content')","24b40ca8":"def max_bar_plot(var):\n    x1 = df[['City',var]].groupby([\"City\"]).median().sort_values(by = var,\n    ascending = True).tail(10).iplot(kind='bar', xTitle='Cities',yTitle=var, \n                                     linecolor='black', title='{2} {1} {0}'.format(\")\",var,' Most polluted cities('))\n\np1 = max_bar_plot('Industrial Pollution content')\np2 = max_bar_plot('Vehicular Pollution content')","8d1b7873":"def min_bar_plot(var):\n    x1 = df[['City',var]].groupby([\"City\"]).mean().sort_values(by = var,\n    ascending = True).head(10).iplot(kind='bar', yTitle='Cities',xTitle=var, linecolor='black',title='{2} {1} {0}'.format(\")\",var,' Minimum polluted cities('))\np1 = min_bar_plot('Industrial Pollution content')\np2 = min_bar_plot('Vehicular Pollution content')","fa678c22":"def al(var):\n    cities = [var]\n    filtered_city_day = df1[df1['Date'] > '2020-04-01']\n    AQI = filtered_city_day[filtered_city_day.City.isin(cities)][['City','Air_quality']]\n    AQI[var] = AQI['Air_quality']\n    k = AQI[var].value_counts()\n    m = pd.DataFrame((round((k\/sum(k))*100)))\n    return m\nc11 = al('Ahmedabad')\nc22 = al('Delhi')\nc33 = al('Kolkata')\nc44 = al('Mumbai')\nc55 = al('Bengaluru')\ndf_row = pd.concat([c11,c22,c33,c44,c55],axis=1)\ndf_row.iplot(kind='bar', align='center',xTitle='Satisfaction level', yTitle='percentage of satisfaction' ,linecolor='black', title='Satisfaction level of people(Post COVID19)')","abf01450":"categorical_attributes = list(df1.select_dtypes(include=['object']).columns)\nprint(\"categorical_attributes\",categorical_attributes)\nle=LabelEncoder()\ndf1['City']=le.fit_transform(df1['City'].astype(str))\ndf1['Air_quality']=le.fit_transform(df1['Air_quality'].astype(str))\ndf1.info()","cd738a04":"cor = df1.corr()\ncor.style.background_gradient(cmap='coolwarm')","557832a0":"y = df1[\"Air_quality\"]\nx = df1[['City', 'PM2.5', 'PM10', 'NO', 'NO2', 'NOx', 'NH3', 'CO', 'SO2',\n       'O3', 'Benzene', 'Toluene', 'Xylene', 'AQI']]\nX_train, X_test, y_train, y_test = train_test_split(x, y, test_size = 0.3, random_state = 0)","3ba1e861":"print('Classes and number of values in trainset',Counter(y_train))","4670b7c7":"from imblearn.over_sampling import SMOTE\noversample = SMOTE()\nX_train,y_train = oversample.fit_resample(X_train,y_train)\nprint('Classes and number of values in trainset after SMOTE:',Counter(y_train))","8ab60e70":"cls=SVC()\ncls.fit(X_train,y_train)\nsvmpred=cls.predict(X_test)\nsvmpred\ncm=confusion_matrix(y_test,svmpred)\nprint(\"confussion matrix\")\nprint(cm)\nprint(\"\\n\")\naccuracy=accuracy_score(y_test,svmpred)\nprint(\"accuracy\",accuracy*100)","c5d6331b":"rf = RandomForestClassifier(n_estimators=20, random_state=23)\nrf.fit(X_train, y_train)\nrf_predict=rf.predict(X_test)\nrf_predict1=rf.predict(X_train)\nrf_conf_matrix = confusion_matrix(y_test, rf_predict)\nrf_acc_score = accuracy_score(y_test, rf_predict)\nprint(\"confussion matrix\")\nprint(rf_conf_matrix)\nprint(\"\\n\")\nprint(\"accuracy\",rf_acc_score*100)","4407a38b":"gbc=XGBClassifier(learning_rate =0.01,n_estimators=100,max_depth=1,\n                  min_child_weight=6,subsample=0.8,seed=13)\ngbc.fit(X_train,y_train)\npred = gbc.predict(X_test)\nxgb_conf_matrix = confusion_matrix(y_test, pred)\naccuracy = accuracy_score(y_test, pred)*100\nprint(\"confussion matrix\")\nprint(xgb_conf_matrix)\nprint(\"\\n\")\nprint(\"accuracy\",accuracy)","807c7ea9":"### 3. XGBoost","0fdf011b":"## Pre Corona [2016 to 2020]\n\n**Here I divide the data set into two part namely Vehicular Pollution content (PM2.5, PM10, NO2, NH3, CO,) and Industrial Pollution content (CO, SO2, O3, Benzene, Toluene, Xylene) and find how these contents correlated with AQI (air quality index)**","ce11cf0f":"### 1. Support Vector Machine","f2528c1c":"## **Exploratory Data Analysis**\n\n**Missing value  analysis and Treatment**","333a9b5c":"## Importing Packages and Dataset","479b41d1":"> **Data Imbalance:**\n\n>  Here we observe that target label is not splitted eqaully. This will cause data imbalance problem. In order to overcome this problem we use the technique called SMOTE(Synthetic Minority Oversampling Technique). This approach solve this problem by oversample the examples in the minority class.","5fec4f8c":"## Classification","0527a882":"## Preprocessing","263e5a0a":"## Conclusion\n\n>1. Vehicular pollution contents are more related to air quality index.\n>2. Delhi is the most polluted city in terms of vehicular pollution contents.\n>3. Ahmadabad is the most polluted city in terms of industrial pollution content.\n>4. After COVID19 pandemic there is gradual dicrease in vehicular pollution contents, industrial pollution content.\n>5. Extra Gradient Boost classifier 100% accurately classify the target variable.","d136e8f0":"### 2. Random Forest","cd9da98e":"## Post Corona [2020 >]"}}