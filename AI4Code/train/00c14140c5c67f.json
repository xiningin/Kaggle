{"cell_type":{"77ab2797":"code","4c2d8aea":"code","ba9c4d8f":"code","119db015":"code","88bda41c":"code","81c26040":"code","17f17c9f":"code","28938e13":"code","8fe6be70":"code","8d8ccda2":"code","f833e583":"code","b526c274":"code","631aa92a":"code","25807d63":"code","cf83733a":"code","58fdb0fa":"code","e9b95cc6":"markdown","f89dcce3":"markdown","b349475d":"markdown","753a1e23":"markdown","3bdffd5f":"markdown","47b9033a":"markdown"},"source":{"77ab2797":"%matplotlib inline\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nfrom fastai.tabular import *\nfrom sklearn.model_selection import ShuffleSplit\nfrom sklearn.metrics import roc_auc_score\nimport matplotlib.pyplot as plt\n\nimport os\nprint(os.listdir(\"..\/input\"))","4c2d8aea":"path = Path('..\/input\/')\ntrain = pd.read_csv(path\/'train.csv')\ntest = pd.read_csv(path\/'test.csv')","ba9c4d8f":"train.head()","119db015":"dep_var = 'target'\ncat_names = ['wheezy-copper-turtle-magic']\ncont_names = train.columns.tolist()\ncont_names = [e for e in cont_names if e not in ('id', 'target', 'wheezy-copper-turtle-magic')]\nprocs = [FillMissing, Categorify, Normalize]","88bda41c":"np.random.seed(1984)\nidx = np.random.randint(0, len(train), size=np.int(.1*len(train)))","81c26040":"bs=1024\ndata = TabularDataBunch.from_df('.', train, dep_var=dep_var, valid_idx=idx, \n                                procs=procs, cat_names=cat_names, \n                                cont_names=cont_names, test_df=test, bs=bs)\n\ndata.show_batch(3)","17f17c9f":"learn = tabular_learner(data, layers=[500, 200, 100, 60], metrics=accuracy, ps=0.2).to_fp16()","28938e13":"lr_find(learn) #, start_lr=1e-7, end_lr=10, num_it=100\nlearn.recorder.plot()","8fe6be70":"learn.fit_one_cycle(10, 3e-2)","8d8ccda2":"learn.recorder.plot_losses()","f833e583":"learn.recorder.plot_metrics()","b526c274":"val_preds = learn.get_preds(DatasetType.Valid)\ny_true = train.iloc[idx].target.values\ny_preds = val_preds[0][:,1].numpy()\nroc_auc_score(y_true, y_preds)\n","631aa92a":"test_preds = learn.get_preds(DatasetType.Test)","25807d63":"sub_df = pd.read_csv(path\/'sample_submission.csv')\nsub_df.target = test_preds[0][:,1].numpy()","cf83733a":"sub_df.to_csv('submission.csv', index=False)","58fdb0fa":"sub_df.head()","e9b95cc6":"### Load data","f89dcce3":"### Create databunch","b349475d":"### Define variable types and pre-processing","753a1e23":"### end","3bdffd5f":"### Make Train\/Validation split","47b9033a":"### Validation & Prediction\nborrowed from [atikur's starter kernel](https:\/\/www.kaggle.com\/atikur\/instant-gratification-fastai-starter)"}}