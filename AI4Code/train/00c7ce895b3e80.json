{"cell_type":{"67a4743e":"code","7257bca0":"code","8677f426":"code","4ef233cc":"code","7a86fc01":"code","c3bf75cb":"code","bfd6661c":"code","0a618950":"code","8c24903c":"code","35132f33":"code","167afe90":"code","078e560e":"code","8280276f":"code","b07409cb":"code","0db10448":"code","4a13a148":"code","a9e4f3de":"code","658b8e8a":"code","06e8f074":"code","632e6783":"code","2178107a":"code","ee6ec966":"code","5c192a16":"code","e5b22923":"code","d9d39fe4":"code","146a3923":"code","4e52e599":"code","0ba22db7":"code","a5fbb386":"code","3071a8e3":"code","76661f5c":"markdown","8a105227":"markdown","68b420a7":"markdown","bc5b89bf":"markdown","ac102c1e":"markdown"},"source":{"67a4743e":"from sklearn.ensemble import RandomForestClassifier, VotingClassifier\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.svm import SVC\nfrom sklearn.datasets import load_iris, fetch_openml\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.ensemble import BaggingClassifier\nfrom sklearn.tree import DecisionTreeClassifier\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt","7257bca0":"X, y = load_iris(return_X_y=True)","8677f426":"y = (y != 2)\ny","4ef233cc":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33, random_state=42)","7a86fc01":"log_clf = LogisticRegression()\nrnd_clf = RandomForestClassifier()\nsvm_clf = SVC()","c3bf75cb":"y_train.dtype","bfd6661c":"voting_clf = VotingClassifier(estimators=[('lr', log_clf), ('rf', rnd_clf), ('svc', svm_clf)],voting='hard')\nvoting_clf.fit(X_train, y_train)","0a618950":"for clf in (log_clf, rnd_clf, svm_clf, voting_clf):\n    clf.fit(X_train, y_train)\n    y_pred = clf.predict(X_test)\n    print(clf.__class__.__name__, accuracy_score(y_test, y_pred))","8c24903c":"bag_clf = BaggingClassifier(DecisionTreeClassifier(), n_estimators=500,max_samples=100, bootstrap=True, n_jobs=-1)\nbag_clf.fit(X_train, y_train)\ny_pred = bag_clf.predict(X_test)","35132f33":"accuracy_score(y_pred, y_test)","167afe90":"bag_clf = BaggingClassifier(DecisionTreeClassifier(), n_estimators=500,bootstrap=True, n_jobs=-1, oob_score=True)\nbag_clf.fit(X_train, y_train)\ny_pred = bag_clf.predict(X_test)","078e560e":"accuracy_score(y_pred, y_test)","8280276f":"bag_clf.oob_score_","b07409cb":"np.unique(y_train, return_counts=True) # Data is unbalanced.","0db10448":"bag_clf.oob_decision_function_[1]","4a13a148":"rnd_clf = RandomForestClassifier(n_estimators=500, max_leaf_nodes=16, n_jobs=-1)\nrnd_clf.fit(X_train, y_train)\ny_pred_rf = rnd_clf.predict(X_test)","a9e4f3de":"accuracy_score(y_test, y_pred_rf)","658b8e8a":"bag_clf = BaggingClassifier(DecisionTreeClassifier(splitter=\"random\", max_leaf_nodes=16),\n                            n_estimators=500, max_samples=1.0, bootstrap=True, n_jobs=-1)","06e8f074":"bag_clf.fit(X_train, y_train)","632e6783":"bag_clf.score(X_test, y_test)","2178107a":"iris = load_iris()","ee6ec966":"rnd_clf = RandomForestClassifier(n_estimators=500, n_jobs=-1)\nrnd_clf.fit(X, y)\nfor name, score in zip(iris[\"feature_names\"], rnd_clf.feature_importances_):\n    print(name, score)","5c192a16":"\n\nmnist = fetch_openml('mnist_784', version=1)\nmnist.keys()\n\n","e5b22923":"X, y = mnist.data, mnist.target","d9d39fe4":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33, random_state=42)","146a3923":"rnd_clf = RandomForestClassifier(n_estimators=500, n_jobs=-1)","4e52e599":"rnd_clf.fit(X_train, y_train)","0ba22db7":"importance = []\nfor name, score in zip(mnist[\"feature_names\"], rnd_clf.feature_importances_):\n    importance.append(score)\nimportance = np.array(importance).reshape(28,28)","a5fbb386":"plt.figure(figsize=(16,12))\nsns.heatmap(importance)","3071a8e3":"rnd_clf.score(X_test, y_test)","76661f5c":"SO 97% accuracy.","8a105227":"So the first instance of X_train has 1 probability of being False and 0 of being True.","68b420a7":"# Feature importance in MNIST Digit recognizer","bc5b89bf":"Many times, while we do iris classification, we avoid sepal length and width. So the reason we do that is clear from above cell.","ac102c1e":"So you may see that only important part is off the border, as we expected."}}