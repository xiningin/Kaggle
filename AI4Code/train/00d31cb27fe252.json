{"cell_type":{"ca7d7599":"code","b6d22f68":"code","70a1f03b":"code","97ac4ca3":"code","c74af84d":"code","8f25e921":"code","6716c65d":"code","c25fc9a4":"code","302aa57c":"code","9057ded7":"code","8f27f24e":"code","fe597f51":"code","f69dfd75":"markdown","27554cd7":"markdown"},"source":{"ca7d7599":"import numpy as np\nimport pandas as pd\nimport os\nimport cv2\n\ndf = pd.read_csv(\"\/kaggle\/input\/wheat-detect\/wheat_detect.csv\")\ndf = df.drop(df.columns[0], axis=1)\ndf.head()","b6d22f68":"submission = []\nfor i in range(len(df)):\n    img = df.iloc[i][\"img\"]\n    prediction = df.iloc[i][\"prediction\"]\n    bbox = df.iloc[i][\"bbox\"]\n    \n    submission.append([img, prediction, bbox])","70a1f03b":"import matplotlib.pyplot as plt\nfrom matplotlib import rcParams\n\nimg_path = \"..\/input\/detected-wheat-plots\"\n\nrcParams[\"figure.figsize\"] = 15, 15\nfor i in os.listdir(img_path):\n    img = cv2.imread(img_path + \"\/\" + i)\n    img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB)\n    plt.axis('off')\n    plt.imshow(img, interpolation='nearest')\n    plt.show()","97ac4ca3":"from ast import literal_eval","c74af84d":"boxes = []\n\nfor vals in submission:\n    cur_id, score, box = vals[0], vals[1], vals[2]\n    \n    box = literal_eval(box)\n    \n    boxes.append([cur_id, f\"{round(score, 4)} {box[0]} {box[1]} {box[2]-box[0]} {box[3]-box[1]}\"])","8f25e921":"df_new = pd.DataFrame(boxes)\ndf_new.columns = [\"pic_id\", \"bbox\"]\n\ndf_new","6716c65d":"prev_pid = df_new.iloc[0][\"pic_id\"]\nbbox_string = \"\"\nbbox_array = []\n\nfor row_id in range(len(df_new)):\n    pid = df_new.iloc[row_id][\"pic_id\"]\n    bbox = df_new.iloc[row_id][\"bbox\"]\n    \n    bbox_string += \"  \" + bbox    \n    \n    if prev_pid != pid:\n        bbox_array.append([prev_pid[:-4], bbox_string])\n        prev_pid = pid\n\n        bbox_string = \"\"\nbbox_array.append([prev_pid[:-4], bbox_string])","c25fc9a4":"df = pd.DataFrame(bbox_array, columns=[\"image_id\", \"PredictionString\"])\ndf","302aa57c":"sub_df = pd.read_csv(\"\/kaggle\/input\/global-wheat-detection\/sample_submission.csv\")\nsub_df","9057ded7":"for i in range(10):\n    sub = sub_df.iloc[i][\"image_id\"]\n    for j in range(10):\n        pre = df.iloc[j][\"image_id\"]\n        if pre == sub:\n            sub_df.iloc[i][\"PredictionString\"] = df.iloc[j][\"PredictionString\"]\n            break","8f27f24e":"sub_df","fe597f51":"sub_df.to_csv(\"submission.csv\", index=False)","f69dfd75":"#### Quick look at how the submission file should look like","27554cd7":"## FIRST PART (model training and predicting) is [HERE](https:\/\/www.kaggle.com\/imakaruamikurah\/detect-wheat-train-kerasretinanet-intermediate)"}}