{"cell_type":{"8063a95c":"code","40c0955a":"code","cc47c64d":"code","d97f0120":"code","291aa250":"code","14d074ca":"code","a8e953e8":"code","2cbe7ecc":"code","266b4a05":"code","fa23e084":"code","4425bb61":"code","aa802ad0":"code","64b87627":"code","87bf0ef2":"code","3810485a":"code","408f0d5f":"code","868fb9c8":"code","947fe30d":"code","2952edcf":"code","6b913565":"markdown","b6104fd5":"markdown","88fab07b":"markdown"},"source":{"8063a95c":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set()\n\nfrom sklearn.feature_extraction.text import TfidfVectorizer\nfrom sklearn.multiclass import OneVsRestClassifier\nfrom sklearn.preprocessing import LabelEncoder\nimport json\nfrom sklearn.svm import SVC\nfrom wordcloud import STOPWORDS, WordCloud, ImageColorGenerator\nimport unidecode\nimport xgboost\n\nimport nltk\n\nlemmatizer = nltk.WordNetLemmatizer()\n\nimport string\n\nstopwords = nltk.corpus.stopwords.words('english')\nps = nltk.PorterStemmer()\n\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","40c0955a":"data_train = pd.read_json(\"..\/input\/train.json\")\ndata_test = pd.read_json(\"..\/input\/test.json\")","cc47c64d":"data_train.head()","d97f0120":"print ('Number of rows in training data are',data_train.shape[0]) ","291aa250":"print('Number of unique cuisines in the training data are',len(data_train.cuisine.unique()))","14d074ca":"data_test.head()","a8e953e8":"print ('Number of rows in training data are',data_test.shape[0])","2cbe7ecc":"data_train.cuisine.value_counts().plot(kind='bar')","266b4a05":"y_train = data_train['cuisine'].apply(lambda x: x.lower())","fa23e084":"def clean_text(text):\n    text = \" \".join([word.lower() for word in text])\n    text = \"\".join([ps.stem(word) for word in text])\n    return text","4425bb61":"X_train = data_train['ingredients'].apply(lambda x: clean_text(x))\nX_test = data_test['ingredients'].apply(lambda x: clean_text(x))","aa802ad0":"#X_train = data_train['ingredients'].apply(lambda x: ' '.join(lemmatizer.lemmatize(unidecode.unidecode(i)) for i in x).strip().lower())\n#X_test = data_test['ingredients'].apply(lambda x: ' '.join(lemmatizer.lemmatize(unidecode.unidecode(i)) for i in x).strip().lower())","64b87627":"X_train.head()","87bf0ef2":"X_test.head()","3810485a":"# Encode Lables of Cusine\nlabler = LabelEncoder()\ny_target = labler.fit_transform(y_train)","408f0d5f":"# Vectorize Train and Test Data Columns\nvectorizer = TfidfVectorizer(binary=True)\nX_train_vec = vectorizer.fit_transform(X_train.values)\nX_test_vec = vectorizer.transform(X_test.values)","868fb9c8":"#XGBoost implementation\nmodel = xgboost.XGBClassifier(max_depth = 12, eta = 0.05, subsample = 0.7)\nclf = OneVsRestClassifier(model, n_jobs = -1)\nclf.fit(X_train_vec, y_target)","947fe30d":"clf_pred = clf.predict(X_test_vec)","2952edcf":"y_test = labler.inverse_transform(clf_pred)\ntest_id = data_test[\"id\"]\nsubmit_xg = pd.DataFrame({'id': test_id, 'cuisine': y_test}, columns=['id', 'cuisine'])\nsubmit_xg.to_csv('xgboost.csv', index=False)","6b913565":"**Training Data**\n\nTraining data contains Cuisine and Ingredients column. \n\n* Objective is to use this training data to train the model. Model learns from the ingredients to predict the cuisine. \n* This is a classification model building excercise. \n* There are 20 different cuisines to predict. \n* There are about 40,000 rows in the training data and 10,000 in test data. ","b6104fd5":"**Number of Recipes**\n\nLooking at the plot below we can notice that most number of recipes are Italian, followed by Mexian and Southern. Least number of recipies are Brazilian. ","88fab07b":"**Test Data**\n\nTest data has about 10,000 rows with only ingredients columns. "}}