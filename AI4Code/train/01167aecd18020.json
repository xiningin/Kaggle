{"cell_type":{"e4a7fe09":"code","572f17ed":"code","1c692eb3":"code","a3b06f2d":"code","b5df195e":"code","7ad91de1":"code","3835e41d":"code","16778ef3":"code","c6a65aa3":"code","cc4bd12a":"code","68655e81":"code","00f861e1":"code","e36302e5":"code","1c1b83dd":"code","6a3e69f4":"code","c3859fd0":"code","94489d5b":"code","8f0b8002":"code","d735608f":"code","588fa215":"code","bc384a09":"code","a203f4fe":"code","f33f19d9":"markdown","79151ed2":"markdown","b039f93c":"markdown","a4f63c33":"markdown","737b29d1":"markdown","39b81e7c":"markdown","a1963133":"markdown","957a9c45":"markdown","4e0e85a3":"markdown"},"source":{"e4a7fe09":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\nimport os\nprint(os.listdir(\"..\/input\/data\/data\/\"))\n\nfrom fastai.vision import *\nfrom fastai.metrics import error_rate\n# Any results you write to the current directory are saved as output.\n\n#start batch size at 64 can reduce based on GPU\nbs = 64","572f17ed":"%reload_ext autoreload\n%autoreload 2\n%matplotlib inline","1c692eb3":"img_dir='..\/input\/data\/data\/'\npath=Path(img_dir)\npath","a3b06f2d":"data = ImageDataBunch.from_folder(path, train=\".\", \n                                  valid_pct=0.2,\n                                  ds_tfms=get_transforms(flip_vert=True, max_warp=0),\n                                  size=224,bs=64, \n                                  num_workers=0).normalize(imagenet_stats)","b5df195e":"data.show_batch(rows=3, figsize=(7,6))","7ad91de1":"learn = cnn_learner(data, models.resnet34, metrics=error_rate, model_dir=\"\/tmp\/model\/\")","3835e41d":"learn.lr_find()\nlearn.recorder.plot()","16778ef3":"learn.fit_one_cycle(6,1e-2)","c6a65aa3":"learn.save('stage-1')","cc4bd12a":"interp = ClassificationInterpretation.from_learner(learn)\n\nlosses,idxs = interp.top_losses()\n\nlen(data.valid_ds)==len(losses)==len(idxs)","68655e81":"interp.plot_top_losses(9, figsize=(15,11))","00f861e1":"interp.plot_confusion_matrix(figsize=(12,12), dpi=60)","e36302e5":"learn.unfreeze()","1c1b83dd":"learn.lr_find()\nlearn.recorder.plot()","6a3e69f4":"learn.unfreeze()\nlearn.fit_one_cycle(2, max_lr=slice(1e-6,1e-4))","c3859fd0":"data = ImageDataBunch.from_folder(path, train=\".\", \n                                  valid_pct=0.2,\n                                  ds_tfms=get_transforms(flip_vert=True, max_warp=0),\n                                  size=224,bs=32, \n                                  num_workers=0).normalize(imagenet_stats)","94489d5b":"learn = cnn_learner(data, models.resnet50, metrics=error_rate, model_dir=\"\/tmp\/model\/\")","8f0b8002":"learn.lr_find()\nlearn.recorder.plot()","d735608f":"learn.fit_one_cycle(8)","588fa215":"learn.save('stage-1-50')","bc384a09":"learn.unfreeze()\nlearn.fit_one_cycle(3, max_lr=slice(1e-4,1e-2))","a203f4fe":"interp.plot_top_losses(9, figsize=(15,11))\ninterp.plot_confusion_matrix(figsize=(12,12), dpi=60)","f33f19d9":"## Model ResNet50","79151ed2":"### Optimize ResNet34","b039f93c":"### Check Model","a4f63c33":"**Overview**\n\nSkin cancer is one of the most common cancers in the world. The first sign of non-melanoma skin cancer is usually the appearance of a lump or discoloured patch on the skin that continues to persist after a few weeks, and slowly progresses over months or sometimes years.\n\nA major challenge is differentiating normal moles from melanoma.  A general ABCDE checklist in determining if a mole is melanoma or normal is the following:\n* Asymmetrical \u2013 melanomas have 2 very different halves and are an irregular shape\n* Border \u2013 melanomas have a notched or ragged border\n* Colours \u2013 melanomas will be a mix of 2 or more colours\n* Diameter \u2013 most melanomas are larger than 6mm (1\/4 inch) in diameter\n* Enlargement or elevation \u2013 a mole that changes size over time is more likely to be a melanoma\n\n**Dataset**\n\nThe dataset is taken from the ISIC (International Skin Image Collaboration) Archive. It consists of 1800 pictures of benign moles and 1797 pictures of malignant classified moles. The pictures have all been resized to low resolution (224x224x3) RGB. The task of this kernel is to create a model, which can classify a mole visually into benign and malignant.  Each image of a mole is individual and does not relate to other images.\n\nAs the dataset is pretty balanced, the model will be tested on the accuracy score, thus (TP + TN)\/(ALL).\n\nBecause the images are from only a time point, the model will not be able to take advantage of changes in time period.  Additionally, images do not seem to accurately estimate the size of each mole. Future models could improve accuracy by using data that takes into account these two parameters.\n\n**Model**\n\nThe model will be the ResNet34 and ResNet50.  I am using this to learn.  I know especially with the second model I may have overfit the data.  I am trying my best and learning as I go.\n*ResNet34* Accuracy: 87.4052\n*ResNet50* Accuracy: 90.2883\n\n**Work referenced**\n\n* [NHS](http:\/\/www.nhs.uk\/conditions\/melanoma-skin-cancer\/symptoms\/)- Understanding and overview.\n* [FastAI](https:\/\/www.fast.ai\/)- Using this to learn part one of MOOC V3 course\n* [PastProjects](https:\/\/www.kaggle.com\/fanconic\/cnn-for-skin-cancer-detection)- Understanding of Dataset and methods used","737b29d1":"## Dataset","39b81e7c":"### Check Model","a1963133":"# Skin Cancer Detection- Mole Classifier(FastAI)","957a9c45":"## Model ResNet34","4e0e85a3":"## Essential Libraries"}}