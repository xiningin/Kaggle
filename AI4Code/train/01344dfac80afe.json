{"cell_type":{"f83260ef":"code","49e210bd":"code","162677e1":"code","6a7155d0":"code","8dd26029":"code","87b6f146":"code","c45e17d4":"code","f10ceec5":"code","652ded82":"code","044a6080":"code","948de621":"code","17c60757":"code","ba33074b":"code","c3ea8b6e":"code","14e56821":"code","9d19596a":"code","bba4f680":"code","677235e0":"code","35d4462d":"code","ed7b22b4":"code","54cb8de7":"code","6216e110":"code","dfe15db8":"code","9ea6a821":"code","7a2acca6":"markdown","4671ee83":"markdown","0036a423":"markdown","fb52f628":"markdown","98451f42":"markdown","53143949":"markdown","74cccd1f":"markdown","458c3f0a":"markdown","ad9d9c07":"markdown","10718d75":"markdown","bf8ab9f7":"markdown","986c4fb3":"markdown","7f09dd64":"markdown","3e4ad1f9":"markdown","0321c849":"markdown","6b7f8d68":"markdown","e86369ed":"markdown","aa7a5fa1":"markdown","79f69ed0":"markdown","66aff94f":"markdown","9bcf1ddc":"markdown","6d01feb6":"markdown","04ac70a2":"markdown","9b7e103c":"markdown","7a133cce":"markdown","7ca7c687":"markdown"},"source":{"f83260ef":"! pip install bubbly\n!pip install scikit-learn  -U\n","49e210bd":"import pandas as pd\nimport numpy as np\n\nimport plotly.express as px\nimport plotly.offline as py\n\nfrom bubbly.bubbly import bubbleplot\nimport matplotlib.pyplot as plt\nimport seaborn as sns","162677e1":"data=pd.read_csv('\/kaggle\/input\/heart-disease-uci\/heart.csv')\n\ndata","6a7155d0":"data['target'].unique()","8dd26029":"data.isna().sum()","87b6f146":"data","c45e17d4":"data.duplicated().sum()","f10ceec5":"import pandas_profiling as pp\npp.ProfileReport(data)","652ded82":"import warnings\nwarnings.filterwarnings('ignore')\n\nfigure = bubbleplot(dataset = data, x_column = 'trestbps', y_column = 'chol', \n    bubble_column = 'sex', time_column = 'age', size_column = 'oldpeak', color_column = 'sex', \n    x_title = \"Resting Blood Pressure\", y_title = \"Cholestrol\", title = 'BP vs Chol. vs Age vs Sex vs Heart Rate',\n    x_logscale = False, scale_bubble = 3, height = 650)\n\npy.iplot(figure, config={'scrollzoom': True},)","044a6080":"px.pie(data, names='target',color_discrete_sequence=px.colors.sequential.Aggrnyl)","948de621":"px.histogram(data,\n             x='age',\n             color_discrete_sequence=px.colors.sequential.Aggrnyl,\n             hover_data=data.columns, \n             marginal=\"box\",\n             color='target')","17c60757":"df=data.copy()\ndf['sex']=df['sex'].map({\n    1:'Male',\n    0:'Female'\n})","ba33074b":"\npx.pie(df, names='sex',\n       color_discrete_sequence=px.colors.sequential.Aggrnyl,\n       hole=.6,\n       \n       )","c3ea8b6e":"px.box(data,x='target',y='trestbps',color_discrete_sequence=px.colors.sequential.Aggrnyl)","14e56821":"# px.histogram(data, x=\"target\", color=\"restecg\") \npx.histogram(data, x=\"target\", color=\"restecg\",barmode=\"group\",color_discrete_sequence=px.colors.sequential.Aggrnyl) ","9d19596a":" px.violin(data, y=\"chol\",\n           color=\"target\",\n           color_discrete_sequence=px.colors.sequential.Aggrnyl,\n           hover_data=data.columns, \n           points=\"all\",\n           box=True,\n          )","bba4f680":"px.box(data,x='target',y='age',color_discrete_sequence=px.colors.sequential.Aggrnyl, points=\"all\")","677235e0":"px.box(data,x='target',y='slope',color_discrete_sequence=px.colors.sequential.Aggrnyl, points=\"all\")","35d4462d":"px.box(data,x='target',y='ca',color_discrete_sequence=px.colors.sequential.Aggrnyl, points=\"all\")","ed7b22b4":"data.reset_index(drop=True, inplace=True)\ndata.head()","54cb8de7":"from sklearn.model_selection import train_test_split\nfrom sklearn.metrics import classification_report,accuracy_score\n\nY = data['target']\nX = data.drop('target',axis=1)\n# x, x_test, y, y_test = train_test_split(X,Y,test_size=0.2,train_size=0.8)\nx_train, x_validation, y_train, y_validation = train_test_split(X,Y,test_size=0.1,train_size=0.9,random_state=254,shuffle=True)","6216e110":"from sklearn.neural_network import MLPClassifier\nclf = MLPClassifier(solver='lbfgs', alpha=1e-08,hidden_layer_sizes=(60,),activation='logistic', random_state=(2),)\nclf = clf.fit(x_train,y_train)\npredictCLF = clf.predict(x_validation)","dfe15db8":"print(classification_report(predictCLF,y_validation))","9ea6a821":"acc_CLF=accuracy_score(predictCLF,y_validation)\nprint(acc_CLF)","7a2acca6":"# Heart Disease Prediction\n## By Ahmed Haytham\n![tumblr_n56vef14dn1toh3hho1_500.gif](attachment:tumblr_n56vef14dn1toh3hho1_500.gif)","4671ee83":"People who are less prone to develop the condition had somewhat higher blood pressure than patients with cardiac problems.","0036a423":"## Relation between Age and Target","fb52f628":"The following graph demonstrates that a greater number of patients with restscg value 0 are less likely to get heart disease, but a greater number of persons with restscg value 1 are more likely to develop heart disease.","98451f42":"The above Pie chart depicts the gender distribution of heart disease patients. Looking at the graph, we may deduce that males are two times more likely than females to suffer from heart disease.","53143949":"\n### Data Columns \n##### 1. Age : displays the age of the individual.\n##### 2. Sex : displays the gender of the individual using the following format :\n&emsp;1 = male\n<br>&emsp;0 = female.\n##### 3. Chest-pain type : displays the type of chest-pain experienced by the individual using the following format\n&emsp;1 = typical angina \n<br>&emsp;2 = atypical angina \n<br>&emsp;3 = non - anginal pain \n<br>&emsp;4 = asymptotic\n#####  4. Resting Blood Pressure : displays the resting blood pressure value of an individual in mmHg (unit)\n#####  5. Serum Cholestrol : displays the serum cholestrol in mg\/dl (unit)\n#####  6. Fasting Blood Sugar : compares the fasting blood sugar value of an individual with 120mg\/dl. \n&emsp;If fasting blood sugar > 120mg\/dl then : 1 (true) else : 0 (false)\n#####  7. Resting ECG : \n&emsp;0 = normal\n<br>&emsp;1 = having ST-T wave abnormality\n<br>&emsp;2 = left ventricular hyperthrophy\n<br>&emsp;`The resting electrocardiogram is a test that measures the electrical activity of the heart`\n#####  8. Max heart rate achieved : displays the max heart rate achieved by an individual.\n##### 9. Exercise induced angina :\n&emsp;1 = yes\n<br>&emsp;0 = no\n##### 10. ST depression induced by exercise relative to rest : displays the value which is integer or float.\n##### 11. Peak exercise ST segment :\n&emsp;1 = upsloping\n<br>&emsp;2 = flat\n<br>&emsp;3 = downsloping\n##### 12. Number of major vessels (0-3) colored by flourosopy : displays the value as integer or float.\n##### 13. Thal : displays the thalassemia : \n&emsp;3 = normal\n<br>&emsp;6 = fixed defect\n<br>&emsp;7 = reversable defect\n<br>&emsp;`Thalassemia is an inherited (i.e., passed from parents to children through genes) blood disorder caused when the body doesn't make enough of a protein ...`\n##### 14 . Diagnosis of heart disease : Displays whether the individual is suffering from heart disease or not :\n&emsp;0 = absence\n<br>&emsp;1 = present.","74cccd1f":"#### we have imbalance Data\nmore than half of samples are fine ","458c3f0a":"## MLPClassifier","ad9d9c07":"## Age Distribution","10718d75":"## Relation between Peak Exercise and Target","bf8ab9f7":"We cannot find any clue or pattern in the above Swarm plot between the target and the age of the patients, so age is not a very good attribute to determine a patient's heart disease. Patients with heart diseases range in age from 40-70, but it is not important that everyone in that age group suffers from heart disease.","986c4fb3":"# Any Feedback\n\nhow to solve imbalanced data problem ","7f09dd64":"# Univariate Exploration\n","3e4ad1f9":"# Bivariate Exploration","0321c849":"# Models","6b7f8d68":"## Relation of tresbps with target","e86369ed":"## Relation between no. of major vessels and target","aa7a5fa1":"The above bivariate plot of cholestrol levels vs. target reveals that people who are more likely to develop heart disease have greater cholestrol levels than those who have goal 0 (not likely to develop heart disease).","79f69ed0":"## Gender Distribution ","66aff94f":"## Relation of Cholestrol with Target","9bcf1ddc":"## Relation of ECG measurement with Target","6d01feb6":"## Data ==> [Link](https:\/\/archive.ics.uci.edu\/ml\/datasets\/Heart+Disease)\n####   We Have(303 Rows X 14 Columns)\n##### Creators:\n1. Hungarian Institute of Cardiology. Budapest: Andras Janosi, M.D.\n2. University Hospital, Zurich, Switzerland: William Steinbrunn, M.D.\n3. University Hospital, Basel, Switzerland: Matthias Pfisterer, M.D.\n4. V.A. Medical Center, Long Beach and Cleveland Clinic Foundation: Robert Detrano, M.D., Ph.D.\n\n\n","04ac70a2":"The above Bivariate plot between Target and Number of Major Vessels, shows that the patients who are more likely to suffer from Heart diseases are having high values of Major Vessels wheras the patiets who are very less likely to suffer from any kind of heart diseases have very low values of Major Vessels.","9b7e103c":" ## Target Distribution ","7a133cce":"The above Distribution figure depicts the distribution of Age across all of the heart patient entries in the dataset. According to the graph, the age group 55-65 years has the largest number of patients suffering from heart disease. Patients between the ages of 20 and 30 are far less likely to develop heart disease.","7ca7c687":"# Fast Report"}}