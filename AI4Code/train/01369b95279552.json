{"cell_type":{"19211fb9":"code","585d2c92":"code","7b4dac5d":"markdown"},"source":{"19211fb9":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\n\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output\n\n\n","585d2c92":"from csv import reader\n\n\n#CODBDI\nCALL=78\nPUT=82\n\n\ndef s(a,i,f): return a[i-1:f].strip()\ndef f(a,i,f): return float(a[i-1:f])\/100\ndef i(a,i,f): return int(a[i-1:f])\n\ntabela=[]\nfor arquivo in os.listdir('..\/input')[:1]:    \n    with open('..\/input\/'+arquivo,'r') as arquivo_txt:\n        for linha in reader(arquivo_txt):\n            linha=linha[0]\n\n            TIPREG=i(linha,1,2)\n            if TIPREG==0 or TIPREG==99: continue;\n            \n            DATA=i(linha,3,10)\n            CODBDI=i(linha,11,12)\n            CODNEG=s(linha,13,24)\n            TPMERC=s(linha,25,27)\n            NOMRES=s(linha,28,39)\n            ESPECI=s(linha,40,49).strip()\n            PREABE=f(linha,57,69)\n            PREMAX=f(linha,70,82)\n            PREMIN=f(linha,83,95)\n            PREMED=f(linha,96,108)\n            PREULT=f(linha,109,121)\n            TOTNEG=i(linha,148,152)\n            QUATOT=i(linha,153,170)\n            VOLTOT=f(linha,171,188)\n            PREEXE=f(linha,189,201)\n            INDOPC=i(linha,202,202)\n            DATVEN=i(linha,203,210)\n            FATCOT=i(linha,211,217)\n\n            #Se for uma op\u00e7\u00e3o de compra lista a data, o c\u00f3digo de negocia\u00e7\u00e3o, o pre\u00e7o de exercicio e data de vencimento\n            if CODBDI==CALL:\n                tabela+=[[DATA, CODNEG,PREULT,PREEXE, DATVEN]]\n\ndf=pd.DataFrame(tabela, columns=['DATA', 'CODNEG','PREULT','PREEXE', 'DATVEN'])\nprint(df)\n","7b4dac5d":"> ## Layout do arquivo  aqui  http:\/\/bvmf.bmfbovespa.com.br\/pt-br\/download\/SeriesHistoricas_Layout.pdf"}}