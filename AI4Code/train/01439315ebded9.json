{"cell_type":{"bddb238e":"code","93755208":"code","af785eb0":"code","cc07a5e4":"code","00c31f26":"code","23ccf58c":"code","96f5ade1":"code","02126225":"code","f0cd226e":"code","d1d9a5d9":"code","48fda6f8":"code","0e172406":"code","5698f4f9":"code","c9682f8b":"code","0b71fa79":"code","7083903f":"code","c4989d82":"code","24e149a4":"code","4f6f8d2d":"code","127d82ce":"code","6467479c":"code","836d2d74":"code","d134c433":"code","e0f63d46":"code","962122b4":"code","77400c8b":"code","5c0180f8":"code","d5855b9c":"code","e089d34f":"code","c1904397":"code","295ce92f":"code","e8fbf349":"code","49ff2b01":"code","64c8dde9":"code","5bd3cdcd":"code","4a696d87":"code","1cfc4521":"code","d71522b7":"code","9e7d8a8e":"code","d5dd1560":"code","19d1aa93":"code","171d7986":"code","3785d434":"code","9d2a0cf4":"code","c55ae438":"code","2b46759e":"code","418e3a2e":"code","d0cc9314":"code","bc9b05f6":"code","ee5d480e":"code","d48efbf5":"code","22d52b15":"code","c359cd23":"code","a94724c7":"code","a7611b47":"code","f7d6b9c1":"code","6c36f666":"code","e9512b9c":"code","045bf05c":"code","d319e38c":"code","828abddf":"code","b0c06c0f":"code","f3f45f91":"code","d781c936":"code","a3cfa5bb":"code","4cc36ca0":"code","37f335e3":"code","5251c7be":"code","815190ce":"code","8ef3f740":"code","1387c13f":"code","e9117bfb":"code","c46073d5":"code","82139dd7":"code","3719ce66":"code","e001cdac":"code","87a8e39d":"code","4d73eafe":"code","11800263":"code","d2ef1a57":"code","7ad1f087":"code","dea1440c":"code","40fd4c7c":"code","8b9fc281":"code","9ca60b36":"code","a46be619":"code","dd5b9718":"code","740d9abc":"code","9fbc2742":"code","ab0131f2":"code","bfcf8fe9":"code","f6640248":"code","b4e3ff50":"code","68ae6de5":"code","5115dcb9":"code","d4fbf830":"code","96acee50":"code","fd2e79ad":"code","f00c57a7":"code","d0101b45":"code","65210cce":"code","74dbed05":"code","c2bb72cc":"code","3b9f97a8":"code","9f41c3bc":"code","ca5abd03":"code","c2410642":"code","cd34b35b":"code","64a3a7bd":"code","f6301503":"code","d9cb8613":"code","ec3e5cac":"code","a27b2953":"code","c238c2a6":"code","af4e6586":"code","4acdb4af":"code","cd209a61":"code","c1355a89":"code","ae6ccb03":"code","431fd6e3":"code","6b3e61fa":"code","ffdb1166":"code","a6719c98":"code","d7c79b0f":"code","ade2c534":"code","8dda5df3":"code","3d0015bd":"code","da20dec9":"code","dd2da336":"code","c4151387":"code","1b0ca1b8":"code","8e4adf48":"code","4a0c7ac8":"code","7f533f03":"code","aeb119ae":"code","88e25f1e":"code","fb67ac13":"code","51a89df9":"code","00524b21":"code","c04325dd":"code","c29035dd":"code","848b80f8":"code","55ea4528":"code","e63dec37":"code","911e694e":"code","e98670c5":"code","fd0a89ca":"code","614d514f":"code","ed661e93":"markdown","03c519fd":"markdown","5a81a3fc":"markdown","0eb173a1":"markdown","af67c1a9":"markdown","20464a38":"markdown","1a67110c":"markdown","c3297935":"markdown","948c678b":"markdown","3108934b":"markdown","0a16aad6":"markdown","5c2d85fc":"markdown","783cf541":"markdown","86ad7b97":"markdown","67378d1c":"markdown","d4e9ec27":"markdown","50736c65":"markdown","2efd9551":"markdown","27c787e8":"markdown","7b3affa1":"markdown","7200f004":"markdown","78853dc5":"markdown","aee4a658":"markdown","270afaa7":"markdown","dd91a167":"markdown","897f825a":"markdown","c1f9de1d":"markdown","afeb65b9":"markdown","8f10a231":"markdown","54e16edc":"markdown","733099c9":"markdown","2923b8ec":"markdown","9536f228":"markdown","327080a2":"markdown","a29e5e1c":"markdown","426657f3":"markdown","da2646b1":"markdown","bed4b8ae":"markdown","f1639c2b":"markdown","088f9ed3":"markdown","000bde0d":"markdown","f2b04a20":"markdown","9664ba9d":"markdown","2d2785e3":"markdown","823a2e88":"markdown","41ec7e9c":"markdown","ffaf856a":"markdown","6d970922":"markdown","a0a83152":"markdown","c1d588ba":"markdown","f4e0960d":"markdown","e434ebea":"markdown","1601cf0e":"markdown","d6bbcfca":"markdown","5db72c22":"markdown"},"source":{"bddb238e":"# Filter all warnings.\nimport warnings\nwarnings.filterwarnings('ignore')","93755208":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport pandas.util.testing as tm\nfrom scipy import stats\nimport sklearn.naive_bayes as sknb\n%matplotlib inline","af785eb0":"def multiplePlots( series ):\n    \n    fig, axs = plt.subplots(2,2)\n    plt.tight_layout(pad=0.4, w_pad=4, h_pad=1.0)\n    #plt.annotate(name, xy =(0,0))\n    # Histogram\n    sns.distplot(series, ax=axs[0,0])\n    \n    \n    # Lag plot\n    lag = series.copy()\n    lag = np.array(lag[:-1])\n    current = series[1:]\n    ax = sns.regplot(current,lag,fit_reg=False, ax=axs[0,1])\n    ax.set_ylabel(\"y_i-1\")\n    ax.set_xlabel(\"y_i\")\n    \n    # QQ plot\n    qntls, xr = stats.probplot(series, fit=False)\n    sns.regplot(xr,qntls, ax=axs[1,0])\n    \n    # Run sequence\n    ax = sns.regplot(np.arange(len(series)),series, ax=axs[1,1])\n    ax.set_ylabel(\"val\")\n    ax.set_xlabel(\"i\")","cc07a5e4":"data = pd.read_csv(\"..\/input\/cardiovascular-disease-dataset\/cardio_train.csv\",sep=\";\")\ndata.head()","00c31f26":"df = pd.read_csv(\"..\/input\/cardiovascular-disease-dataset\/cardio_train.csv\",sep=\";\")\ndf.head()","23ccf58c":"print(f\"The shape of the dataset is: {df.shape}\")","96f5ade1":"df.info()","02126225":"df.duplicated().sum()","f0cd226e":"df.drop_duplicates(inplace=True)","d1d9a5d9":"df.describe()","48fda6f8":"# remove weight outliers\nweight_min_outlier_mask = df['weight'] > df['weight'].quantile(0.005)\nweight_max_outlier_mask = df['weight'] < df['weight'].quantile(0.999)\ndf = df[(weight_min_outlier_mask) & (weight_max_outlier_mask)]","0e172406":"height_min_outlier_mask = df['height'] > df['height'].quantile(0.005)\nheight_max_outlier_mask = df['height'] < df['height'].quantile(0.999)\ndf = df[(height_min_outlier_mask) & (height_max_outlier_mask)]","5698f4f9":"print(f\"In {df[df['ap_hi'] < df['ap_lo']].shape[0]} obeservation ap_hi is lower than ap_low, which is incorrect.\")\nprint('_'*80)\nprint()\nprint(\"Let's remove them:\")\n\ndf = df[df['ap_hi'] > df['ap_lo']].reset_index(drop=True)\ndf.head()","c9682f8b":"def bload_pressure_stage(data):\n    if (data['ap_hi'] <= 120) and (data['ap_lo'] <= 80):\n        return 'Normal'\n    if (data['ap_hi'] >= 120 and data['ap_hi'] < 129) and (data['ap_lo'] < 80):\n        return 'Elevated'\n    if (data['ap_hi'] >= 129 and data['ap_hi'] < 139) | (data['ap_lo'] >= 80 and data['ap_lo'] < 89):\n        return 'High_Bload_Pressur_1'\n    if (data['ap_hi'] >= 140) | (data['ap_lo'] >= 89):\n        return 'High_Bload_Pressur_2'\n    if (data['ap_hi'] >= 180) | (data['ap_lo'] >= 120):\n        return 'Crisis'\n\ndf['bload_pressure_stage'] = df.apply(bload_pressure_stage, axis=1)","0b71fa79":"df.head(2)","7083903f":"df['age'] = round(df['age']\/365).apply(lambda x: int(x))\ndf.head(2)","c4989d82":"print('Min Age: ', df['age'].min())\nprint('Max Age: ', df['age'].max())\nprint('Mean Age: ', df['age'].mean())\n\ndf['age_range'] = df['age'].apply(lambda x: 'young' if (x >=30 and x <= 40) else ('middle_age' if (x>40 and x<=45) else 'Elderly'))\ndf.head(2)","24e149a4":"def BMI(data):\n    return data['weight'] \/ (data['height']\/100)**2\n \ndf['bmi'] = df.apply(BMI, axis=1)","4f6f8d2d":"df.head(2)","127d82ce":"df['weight_status'] = df['bmi'].apply(lambda x :'Underweight' if x <= 18.5 else ('Normal' if (x > 18.5 and x <= 24.9) else ( 'Overweight' if (x > 24.9 and x <= 29.9) else 'obese')) )","6467479c":"df.head()","836d2d74":"df.describe()","d134c433":"# df['gender'] = df['gender'].astype('category')\n# df['cholesterol'] = df['cholesterol'].astype('category')\n# df['gluc'] = df['gluc'].astype('category')\n# df['smoke'] = df['smoke'].astype('category')\n# df['alco'] = df['alco'].astype('category')\n# df['active'] = df['active'].astype('category')\n# df['cardio'] = df['cardio'].astype('category')","e0f63d46":"df.head(3)","962122b4":"df.info()","77400c8b":"pd.crosstab(df.gender, df.cardio, normalize=False).plot(kind=\"bar\", figsize=(10, 6))\nplt.title('Cardiovascular Disease Frequency for genders')\nplt.xlabel('Gender (1: female, 2: male)')\nplt.xticks(rotation=0)\nplt.ylabel('Frequency')\nplt.savefig('1.png')\nplt.show()","5c0180f8":"g = pd.crosstab(df.gender, df.cardio, margins=True)\ng","d5855b9c":"sns.heatmap(pd.crosstab(df.gender, df.cardio, normalize=True), annot=True,cmap=sns.cubehelix_palette())","e089d34f":"from scipy.stats import chi2_contingency\nchi2, p, dof, ex = chi2_contingency(g)\nprint(\"chi2 = \", chi2)\nprint(\"p-val = \", p)\nprint(\"degree of freedom = \",dof)\n","c1904397":"s = pd.crosstab(df.smoke, df.cardio)\ns.plot(kind=\"bar\", figsize=(10, 6))\nplt.title('Cardiovascular Disease Frequency for smoke status')\nplt.xlabel('Smoke')\nplt.xticks(rotation=0)\nplt.ylabel('Frequency')\nplt.savefig('2.png')\nplt.show()","295ce92f":"sns.heatmap(s, annot=True,cmap=sns.cubehelix_palette())","e8fbf349":"chi2, p, dof, ex = chi2_contingency(pd.crosstab(df.smoke, df.cardio, margins=True))\nprint(\"chi2 = \", chi2)\nprint(\"p-val = \", p)\nprint(\"degree of freedom = \",dof)\n\n","49ff2b01":"p = pd.crosstab(df.active, df.cardio)\np. plot(kind=\"bar\", figsize=(10, 6))\nplt.title('Cardiovascular Disease Frequency for physically active status')\nplt.xlabel('Physically Active')\nplt.xticks(rotation=0)\nplt.ylabel('Frequency')\nplt.savefig('3.png')\nplt.show()","64c8dde9":"chi2, p, dof, ex = chi2_contingency( pd.crosstab(df.active, df.cardio, margins=True))\nprint(\"chi2 = \", chi2)\nprint(\"p-val = \", p)\nprint(\"degree of freedom = \",dof)","5bd3cdcd":"a= pd.crosstab(df.alco, df.cardio)\na.plot(kind=\"bar\", figsize=(10, 6))\nplt.title('Cardiovascular Disease Frequency for alcohol status')\nplt.xlabel('Alcohol Status')\nplt.xticks(rotation=0)\nplt.ylabel('Frequency')\nplt.savefig('4.png')\nplt.show()","4a696d87":" chi2, p, dof, ex = chi2_contingency( pd.crosstab(df.alco, df.cardio, margins = True))\nprint(\"chi2 = \", chi2)\nprint(\"p-val = \", p)\nprint(\"degree of freedom = \",dof)","1cfc4521":"ch = pd.crosstab(df.cholesterol, df.cardio)\nch.plot(kind=\"bar\", figsize=(10, 6))\nplt.title('Cardiovascular Disease Frequency for cholestrol status')\nplt.xlabel('cholestrol ')\nplt.xticks(rotation=0)\nplt.ylabel('Frequency')\nplt.savefig('5.png')\nplt.show()","d71522b7":" chi2, p, dof, ex = chi2_contingency( pd.crosstab(df.cholesterol, df.cardio, margins=True))\nprint(\"chi2 = \", chi2)\nprint(\"p-val = \", p)\nprint(\"degree of freedom = \",dof)","9e7d8a8e":"gl = pd.crosstab(df.gluc, df.cardio)\ngl.plot(kind=\"bar\", figsize=(10, 6))\nplt.title('Cardiovascular Disease Frequency for glucose status')\nplt.xlabel('Glucose Status')\nplt.xticks(rotation=0)\nplt.ylabel('Frequency')\nplt.savefig('6.png')\nplt.show()","d5dd1560":" chi2, p, dof, ex = chi2_contingency( pd.crosstab(df.gluc, df.cardio, margins=True))\nprint(\"chi2 = \", chi2)\nprint(\"p-val = \", p)\nprint(\"degree of freedom = \",dof)","19d1aa93":"bp = pd.crosstab(df.bload_pressure_stage, df.cardio)\nbp.plot(kind=\"bar\", figsize=(10, 6))\nplt.title('Cardiovascular Disease Frequency for bload perssure status')\nplt.xlabel('Bload pressure Status')\nplt.xticks(rotation=0)\nplt.ylabel('Frequency')\nplt.savefig('7.png')\nplt.show()","171d7986":" chi2, p, dof, ex = chi2_contingency( pd.crosstab(df.bload_pressure_stage, df.cardio, margins=True))\nprint(\"chi2 = \", chi2)\nprint(\"p-val = \", p)\nprint(\"degree of freedom = \",dof)","3785d434":"age = pd.crosstab(df.age_range, df.cardio)\nage.plot(kind=\"bar\", figsize=(10, 6))\nplt.title('Cardiovascular Disease Frequency for age status')\nplt.xlabel('Age Status')\nplt.xticks(rotation=0)\nplt.ylabel('Frequency')\nplt.savefig('8.png')\nplt.show()","9d2a0cf4":" chi2, p, dof, ex = chi2_contingency( pd.crosstab(df.age_range, df.cardio, margins=True))\nprint(\"chi2 = \", chi2)\nprint(\"p-val = \", p)\nprint(\"degree of freedom = \",dof)","c55ae438":"bmi = pd.crosstab(df.weight_status, df.cardio)\nbmi.plot(kind=\"bar\", figsize=(10, 6))\nplt.title('Cardiovascular Disease Frequency for weight status')\nplt.xlabel('Weight Status')\nplt.xticks(rotation=0)\nplt.ylabel('Frequency')\nplt.savefig('9.png')\nplt.show()","2b46759e":"pd.crosstab(df.weight_status, df.cardio, margins=True)","418e3a2e":"chi2, p, dof, ex = chi2_contingency( pd.crosstab(df.weight_status, df.cardio, margins=True))\nprint(\"chi2 = \", chi2)\nprint(\"p-val = \", p)\nprint(\"degree of freedom = \",dof)","d0cc9314":"df.head(2)","bc9b05f6":"fig, (ax1,ax2) = plt.subplots(nrows=1, ncols=2, sharey=True)\nsns.distplot(df[df['cardio'] == 1]['weight'], hist = True, kde=True, ax=ax1).set(title = 'CVD')\nsns.distplot(df[df['cardio'] == 0]['weight'], hist = True, kde=True, ax=ax2).set(title = 'healthy')","ee5d480e":"multiplePlots(df[df['cardio'] == 0]['weight'])","d48efbf5":"df[df['cardio'] == 1]['weight'].describe()","22d52b15":"df[df['cardio'] == 0]['weight'].describe()","c359cd23":"import scipy.stats as stats","a94724c7":"stats.ttest_ind(df[df['cardio'] == 0]['weight'],df[df['cardio'] == 1]['weight'],equal_var=False)","a7611b47":"fig, (ax1,ax2) = plt.subplots(nrows=1, ncols=2, sharey=True)\nsns.distplot(df[df['cardio'] == 1]['ap_lo'], hist = True, kde=False, ax=ax1).set(title = 'CVD')\nsns.distplot(df[df['cardio'] == 0]['ap_lo'], hist = True, kde=False, ax=ax2).set(title = 'healthy')","f7d6b9c1":"multiplePlots(df[df['cardio'] == 0]['ap_lo'])","6c36f666":"print('2.5th percentail: ', np.percentile(df['ap_lo'],2.5))\nprint('97.5th percentile: ', np.percentile(df['ap_lo'],97.5))\nprint('95% confidence interval: ', np.percentile(df['ap_lo'],97.5) - np.percentile(df['ap_lo'],2.5))\nprint('variance: ', np.var(df['ap_lo']))\nprint('std ', np.std(df['ap_lo']))","e9512b9c":"40\/9.7","045bf05c":"stats.ttest_ind(df[df['cardio'] == 0]['ap_lo'],df[df['cardio'] == 1]['ap_lo'],equal_var=False)","d319e38c":"fig, (ax1,ax2) = plt.subplots(nrows=1, ncols=2, sharey=True)\nsns.distplot(df[df['cardio'] == 1]['ap_hi'], hist = True, kde=False, ax=ax1).set(title = 'CVD')\nsns.distplot(df[df['cardio'] == 0]['ap_hi'], hist = True, kde=False, ax=ax2).set(title = 'healthy')","828abddf":"fig, (ax1,ax2) = plt.subplots(nrows=1, ncols=2, sharey=True)\nsns.distplot(np.log(df[df['cardio'] == 1]['ap_hi']), hist = True, kde=True, ax=ax1).set(title = 'CVD')\nsns.distplot(np.log(df[df['cardio'] == 0]['ap_hi']), hist = True, kde=True, ax=ax2).set(title = 'healthy')","b0c06c0f":"multiplePlots( np.log(df[df['cardio'] == 0]['ap_hi']))","f3f45f91":"stats.ttest_ind(df[df['cardio'] == 0]['ap_hi'],df[df['cardio'] == 1]['ap_hi'],equal_var=False)","d781c936":"sns.distplot(df[df['cardio'] == 1]['ap_lo'], hist = True, kde=True).set(title = 'CVD')","a3cfa5bb":"fig, (ax1,ax2) = plt.subplots(nrows=1, ncols=2, sharey=True)\nsns.distplot(df[df['cardio'] == 1]['height'], hist = True, kde=False, ax=ax1).set(title = 'CVD')\nsns.distplot(df[df['cardio'] == 0]['height'], hist = True, kde=False, ax=ax2).set(title = 'healthy')","4cc36ca0":"multiplePlots( np.log(df[df['cardio'] == 0]['height']))","37f335e3":"stats.ttest_ind(df[df['cardio'] == 0]['height'],df[df['cardio'] == 1]['height'],equal_var=False)","5251c7be":"fig, (ax1,ax2, ax3) = plt.subplots(nrows=1, ncols=3, sharey=True)\nsns.distplot(df[df['cardio'] == 1]['bmi'], hist = True, kde=False, ax=ax1).set(title = 'CVD')\nsns.distplot(df[df['cardio'] == 0]['bmi'], hist = True, kde=False, ax=ax2).set(title = 'healthy')\nsns.distplot(df['bmi'], hist = True, kde=False, ax=ax3).set(title = 'whole data')","815190ce":"multiplePlots(df[df['cardio'] == 0]['bmi'])","8ef3f740":"df[df['cardio'] == 1]['bmi'].describe()","1387c13f":"df[df['cardio'] == 0]['bmi'].describe()","e9117bfb":"stats.ttest_ind(df[df['cardio'] == 0]['bmi'],df[df['cardio'] == 1]['bmi'],equal_var=False)","c46073d5":"print('2.5th percentail: ', np.percentile(df['bmi'],2.5))\nprint('97.5th percentile: ', np.percentile(df['bmi'],97.5))\nprint('95% confidence interval: ', np.percentile(df['bmi'],97.5) - np.percentile(df['bmi'],2.5))\nprint('variance: ', np.var(df['bmi']))\nprint('std ', np.std(df['bmi']))","82139dd7":"19.59 \/ 5.06","3719ce66":"df.corr()\nf, ax = plt.subplots(figsize=(12, 10))\nsns.heatmap(df.corr(), annot=True, linewidths=0.5, square=True, vmax=0.3, center=0, cmap=sns.cubehelix_palette())\nplt.savefig('heat.png')","e001cdac":"df.columns","87a8e39d":"vars = ['age', 'gender', 'height', 'weight', 'ap_hi', 'ap_lo', 'cholesterol',\n       'gluc', 'smoke', 'alco', 'active','bmi', 'cardio']","4d73eafe":"import statsmodels.api as sm\nimport statsmodels.formula.api as smf","11800263":"model1 = smf.ols('bmi ~ C(cardio)', data=df).fit()\nmodel1.summary()","d2ef1a57":"aov_table = sm.stats.anova_lm(model1, typ=2)\nprint(aov_table)","7ad1f087":"model1 = smf.ols('age ~ C(cardio)', data=df).fit()\nmodel1.summary()","dea1440c":"aov_table = sm.stats.anova_lm(model1, typ=2)\nprint(aov_table)","40fd4c7c":"model1 = smf.ols('cholesterol ~ C(cardio)', data=df).fit()\nmodel1.summary()","8b9fc281":"aov_table = sm.stats.anova_lm(model1, typ=2)\nprint(aov_table)","9ca60b36":"model3 = smf.ols('ap_lo ~ weight', data=df).fit()\nmodel3.summary()","a46be619":"68.6471 + 0.1705 * 50","dd5b9718":"import pandas as pd\nimport numpy as np\nimport sklearn as sk \nfrom sklearn.model_selection import train_test_split\nimport sklearn.ensemble as skens","740d9abc":"data.duplicated().sum()","9fbc2742":"data.drop_duplicates(inplace=True)","ab0131f2":"# remove weight outliers\nweight_min_outlier_mask = data['weight'] > data['weight'].quantile(0.005)\nweight_max_outlier_mask = data['weight'] < data['weight'].quantile(0.999)\ndata = data[(weight_min_outlier_mask) & (weight_max_outlier_mask)]","bfcf8fe9":"height_min_outlier_mask = data['height'] > data['height'].quantile(0.005)\nheight_max_outlier_mask = data['height'] < data['height'].quantile(0.999)\ndata = data[(height_min_outlier_mask) & (height_max_outlier_mask)]","f6640248":"print(f\"In {data[data['ap_hi'] < data['ap_lo']].shape[0]} obeservation ap_hi is lower than ap_low, which is incorrect.\")\nprint('_'*80)\nprint()\nprint(\"Let's remove them:\")\n\ndata = data[data['ap_hi'] > data['ap_lo']].reset_index(drop=True)\ndata.head()","b4e3ff50":"data['age'] = round(data['age']\/365).apply(lambda x: int(x))\ndata.head(2)","68ae6de5":"def BMI(data):\n    return data['weight'] \/ (data['height']\/100)**2\n \ndata['bmi'] = data.apply(BMI, axis=1)","5115dcb9":"cvd=data.copy()","d4fbf830":"cvd['gender']= cvd['gender'].apply(lambda x: 0 if x==2 else 1)","96acee50":"cvd['cardio'].value_counts()","fd2e79ad":"cvd.shape","f00c57a7":"sns.countplot(x='cardio',data=cvd)","d0101b45":"\ncvd = pd.get_dummies(cvd,drop_first=True)\ncvd.head(2)","65210cce":"cvd.columns","74dbed05":"cvd = cvd[['age', 'gender', 'height', 'weight', 'ap_hi', 'ap_lo', 'cholesterol',\n       'gluc', 'smoke', 'alco', 'active', 'bmi', 'cardio']]","c2bb72cc":"X = cvd.loc[:, cvd.columns != 'cardio']\ny = cvd.loc[:, cvd.columns == 'cardio']","3b9f97a8":"# split data into test and train set\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.3, random_state = 0)\ncolumns = X_train.columns","9f41c3bc":"X_train.shape","ca5abd03":"X_test.shape","c2410642":"y_train.shape","cd34b35b":"y_test.shape","64a3a7bd":"import sklearn.tree as sktree","f6301503":"# build 10 random trees\nrf_model = skens.RandomForestClassifier(n_estimators = 10, oob_score=True, criterion = 'entropy')\nrf_model.fit(X_train, y_train)","d9cb8613":"#predict\npredicted_labels = rf_model.predict(X_test)\ny_test['predicted_rf'] = predicted_labels","ec3e5cac":"# accuracy\naccuracy = {}\nfrom sklearn.metrics import accuracy_score\nac = accuracy_score(y_test['cardio'], y_test['predicted_rf'])\naccuracy['Random Forest 10 estimator'] = ac\nprint(\"Accuracy with Random Forrest: {0:.2%}\".format(ac))","a27b2953":"from sklearn.metrics import classification_report\n\nprint(classification_report(y_test['cardio'], y_test['predicted_rf']))\n\n","c238c2a6":"from sklearn.metrics import confusion_matrix\ncm = confusion_matrix(y_test['cardio'], y_test['predicted_rf'])\ncm","af4e6586":"feat_importance = rf_model.feature_importances_\nfeat_importance","4acdb4af":"import matplotlib\nmatplotlib.rc('xtick', labelsize = 12)\n\npd.DataFrame({'Feature Importance':feat_importance},\n             index=X_train.columns).sort_values(by='Feature Importance',ascending=True).plot(kind='barh', figsize = (8,8))\n\nplt.savefig('features.png')","cd209a61":"param_grid = {\n                 'n_estimators': [5, 10, 15, 20, 25],\n                 'max_depth': [2, 5, 7, 9],\n             }","c1355a89":"from sklearn.model_selection import GridSearchCV","ae6ccb03":"grid_clf = GridSearchCV(rf_model, param_grid, cv=10)\ngrid_clf.fit(X_train, y_train)","431fd6e3":"grid_clf.best_estimator_","6b3e61fa":"grid_clf.best_params_","ffdb1166":"y_pred = grid_clf.predict(X_test)\n","a6719c98":"y_pred","d7c79b0f":"from sklearn.metrics import classification_report\n\nprint(classification_report(y_test['cardio'], y_pred))","ade2c534":"rf_model = skens.RandomForestClassifier(n_estimators=25, max_depth=9, oob_score=True, criterion='entropy')\nrf_model.fit(X_train, y_train)","8dda5df3":"#predict\npredicted_labels = rf_model.predict(X_test)\ny_test['predicted_rf_25_estimator'] = predicted_labels","3d0015bd":"from sklearn.metrics import accuracy_score\nac = accuracy_score(y_test['cardio'], y_test['predicted_rf_25_estimator'])\naccuracy['Random Forest 25 estimator'] = ac\nprint(\"Accuracy with Random Forrest: {0:.2%}\".format(ac))","da20dec9":"from sklearn.metrics import classification_report\n\nprint(classification_report(y_test['cardio'], y_test['predicted_rf_25_estimator']))\n\n","dd2da336":"from sklearn.metrics import confusion_matrix\ncm = confusion_matrix(y_test['cardio'], y_test['predicted_rf_25_estimator'])\ncm","c4151387":"param_grid = {\n                 'n_estimators': [2, 4, 8, 12, 16],\n                 'max_depth': [2, 4, 6, 8],\n             }","1b0ca1b8":"grid_clf = GridSearchCV(rf_model, param_grid, cv=5)\ngrid_clf.fit(X_train, y_train)","8e4adf48":"grid_clf.best_params_","4a0c7ac8":"rf_model = skens.RandomForestClassifier(n_estimators=16, max_depth=8, oob_score=True, criterion='entropy')\nrf_model.fit(X_train, y_train)","7f533f03":"#predict\npredicted_labels = rf_model.predict(X_test)\ny_test['predicted_rf_16_estimator'] = predicted_labels","aeb119ae":"from sklearn.metrics import accuracy_score\nac = accuracy_score(y_test['cardio'], y_test['predicted_rf_16_estimator'])\naccuracy['Random Forest 16 estimator'] = ac\nprint(\"Accuracy with Random Forrest: {0:.2%}\".format(ac))","88e25f1e":"from sklearn.metrics import classification_report\n\nprint(classification_report(y_test['cardio'], y_test['predicted_rf_16_estimator']))\n","fb67ac13":"from sklearn.metrics import confusion_matrix\ncm = confusion_matrix(y_test['cardio'], y_test['predicted_rf_16_estimator'])\ncm","51a89df9":"gnb_model = sknb.GaussianNB()\ngnb_model.fit(X_train, y_train)","00524b21":"y_pred = gnb_model.predict(X_test)\ny_test['predict'] = y_pred","c04325dd":"from sklearn.metrics import accuracy_score\nac = accuracy_score(y_test['cardio'], y_test['predict'])\naccuracy['Naive Baysian without prior'] = ac\nprint(\"Accuracy: {0:.2%}\".format(ac))","c29035dd":"from sklearn.metrics import classification_report\n\nprint(classification_report(y_test['cardio'], y_test['predict']))","848b80f8":"from sklearn.metrics import confusion_matrix\ncm = confusion_matrix(y_test['cardio'], y_test['predict'])\ncm","55ea4528":"gnb_model = sknb.GaussianNB([0.3,0.7])\ngnb_model.fit(X_train, y_train)","e63dec37":"y_pred = gnb_model.predict(X_test)\ny_test['predict'] = y_pred","911e694e":"from sklearn.metrics import accuracy_score\nac = accuracy_score(y_test['cardio'], y_test['predict'])\naccuracy['Naive Baysian prior 30-70'] = ac\nprint(\"Accuracy: {0:.2%}\".format(ac))","e98670c5":"plt.figure(figsize=(10,5))\nsns.barplot(x=list(accuracy.keys()), y=list(accuracy.values()))\nplt.ylabel(\"Accuracy %\")\nplt.xlabel(\"Algorithms\")\nplt.xticks(rotation=45)\nplt.savefig('mls.png')","fd0a89ca":"from sklearn.metrics import classification_report\n\nprint(classification_report(y_test['cardio'], y_test['predict']))\n\n","614d514f":"from sklearn.metrics import confusion_matrix\ncm = confusion_matrix(y_test['cardio'], y_test['predict'])\ncm","ed661e93":"high pressure has a long tail, and based on visual test we can conclude that the distribution of it is Pareto\/power distribution. By applying log scale for x and y axis, we can see the distribution for a reasonable range. In fact, the log scale shows the range that the majority of data ocurrse. Based on t-test, their distribution is significantly different.","03c519fd":"\ud83d\udc69\ud83c\udffb\u200d\ud83d\udcbb \n\nBased on the bar chart Of people who are physically active less people have CVD, however, of people who are not active more people are suffering from CVD. Moreover, chi-squared test prove this interpretation, bacause p-value is way less than 0.05 and we are in a good shape to reject the null hypothesis, which was there was no effect of activity status on having CVD. It shows physical activity can decrease chances of Cardiovascular disease.","5a81a3fc":"\ud83d\udc69\ud83c\udffb\u200d\ud83d\udcbb \n\n- The above chart obviously shows impact of weight status on having CVD. Chi-squared test also proves the results.","0eb173a1":"\ud83d\udc69\ud83c\udffb\u200d\ud83d\udcbb \n\nFrom the bar chart we can see chance of having CVD is slightly larger, when the gender is male. \nheatmap:\nchi2: p-value is larger than 0.05. Therefor, we do not have enough evidence to reject the null hypothesis, which was there was no effect of gender type on having CVD. \n","af67c1a9":"# Findings","20464a38":"bmi has a normal distribution among both groups. Distributions are skewed to the right, with mean around 27, and median around 26. Their distribution is significantly different.","1a67110c":"## Tune and changeing hyperparameters","c3297935":"My plan for data preparation: \n - drop duplicated rows if any.\n - drop any unusual observation.\n - convert age from days to years.\n - create a column for ranges of age.\n - create a column for body mass index (bmi).\n - create a column for state of bload pressure.\n - convert variable types.\n","948c678b":"# Important Features","3108934b":"# calculating Body Mass Index","0a16aad6":"Table of Contents","5c2d85fc":"# Findings\n\nI used Random Forest and Na\u00efve Bayesian to predict if a person is likely to have cardiovascular disease. The dataset had approximately 70000 observations, and about half of them had CVD. I found that the most important feature in predicting cardio is body mass index. I changed hyperparameters and used cross-validation to tune the models.\nIn selecting the model, since we are dealing with disease, it is important to minimize the errors in prediction, but most importantly minimize false-negative predictions. The reason is that, if we predict a person not having CVD, while the person has, we are jeopardizing the person\u2019s health. Since the dataset is balanced, I can consider f-1 score as well; however, due to the impotence of minimizing false negative prediction, I prefer recall score. Among all models, tuned random forest with recall score 67% is the preferred model.\n\n","783cf541":"## 1.1 Train a decision tree classifier\n\nWe will train a decision tree classifier to classify the target class (CVD). Here are the specifications:\n- __Objective__: predict who has cardiovascular diseas.\n- __Possible classes__: \"cardio: 0\", \"cardio: 1\"\n- __Features__:","86ad7b97":"95% of data of is about 4 standard deviations (plus and minus two standard deviation from the mean). We can conclude that we can consider the distribution as normal because empirical rule apply to our data.","67378d1c":"In above regression models, my dependent variable is low blood pressure, and would like to see how does it change with weight.\np_value is less than 0.05, so the relationship is statistically significant.\nWe can expet the linear model:\n\ny(ap_lo) = 68.6471 + 0.1705*X(weight)","d4e9ec27":"\ud83d\udcda from: [cdc.gov](https:\/\/www.cdc.gov\/healthyweight\/assessing\/bmi\/adult_bmi\/index.html)\n\n## How is BMI interpreted for adults?\nFor adults 20 years old and older, BMI is interpreted using standard weight status categories. These categories are the same for men and women of all body types and ages.\n\nThe standard weight status categories associated with BMI ranges for adults are shown in the following table.\n\nBMI | Weight Status\n---|---\nBelow18.5\t| Underweight\n18.5 \u2013 24.9 |\tNormal or Healthy Weight\n25.0 \u2013 29.9\t| Overweight\n30.0 and Above | Obese","50736c65":"## Changing Prior","2efd9551":"\ud83d\udc69\ud83c\udffb\u200d\ud83d\udcbb \n\n- The above chart obviously shows impact of age range on having CVD. Chi-squared also proves the results.","27c787e8":"#### create bload pressure stage variable","7b3affa1":"# Can Data Predict Cardiovascular Disease?\n\n\nCardiovascular disease (CVD) is the number one cause of death globally. This has raised many concerns and research to find ways to prevent CVD among people. While it is said that up to 90% of CVD may be preventable, it is difficult to predict and prevent this disease because it involves many risk factors such as sex, family history, smoking and many more. Data analysis and machine learning methods seem to be a reliable way to explore the patients\u2019 data, identify risk factors, and predict if a person is likely to have CVD or not. I chose this subject due to its importance, and the integral role of data analysis methods to solve it. I am going to explore the following questions:\n\n1.\tHow each of the variables (risk factors) affect having CVD? For instance, can we say cholesterol level contributes to CVD? What about smoking?\n2.\tHow we can compare the distribution of different risk factors among people with and without CVD? What kind of distributions they are?\n3.\tWhat is the correlation between variables? Can we expect any relationship? Can we expect a value for the person\u2019s blood pressure when we know his\/her age?\n4.\tBased on a person\u2019s health profile, can we predict if a person is likely to have CVD?\n\n","7200f004":"# Q2. What is the corrolation between variables? Can we expect linear relationship?","78853dc5":"# Q1: What are the risk factors of cardio vascular disease? ","aee4a658":"\ud83d\udc69\ud83c\udffb\u200d\ud83d\udcbb \n\nThe above chart obviously shows higer glucose can lead to CVD. Moreover, chi-squared test proves this interpretation.","270afaa7":"# Classification","dd91a167":"# Load Data","897f825a":"\ud83d\udc69\ud83c\udffb\u200d\ud83d\udcbb \n\nThe above chart obviously shows higer cholestrol can lead to CVD. Moreover, based on the chi-squared result, p-value is less than 0.05 and we are in a good shape to reject the null hypothesis, which was there was no effect of cholesteorl level on having CVD.","c1f9de1d":"\ud83d\udcda from [webmd.com](https:\/\/www.webmd.com\/hypertension-high-blood-pressure\/guide\/diastolic-and-systolic-blood-pressure-know-your-numbers)\n\nBlood flows through our body because of a difference in pressure.\n\nOur blood pressure is highest at the start of its journey from our heart \u2013 when it enters the aorta \u2013 and it is lowest at the end of its journey along progressively smaller branches of arteries. \n\nThe systolic pressure (ap_hi) is the higher figure caused by the heart\u2019s contraction, while the diastolic number (ap_lo) is the lower pressure in the arteries.\n\n\u2757\ufe0f Therefore, ap_hi should be higher thatn ap_low, and they cannot be negative.","afeb65b9":"# Q2. How we can compare distribution of different risk factors among people with and without CVD? What kind of distribution they are?","8f10a231":"some columns such as gender can be store as categories so I will change their types to category:","54e16edc":"wieght has a normal distribution among both groups. Distributions are skewed to the right. Average weight, and median among people with CVD is 5 kg more. They seem to have same distribution but p-value from t-test is statistically significant, so mean value for groups with and without cvd is different.","733099c9":"prob(F-statistic) is 0. \nSo, do we have evidence that mean of mean of bmi is differnet acrros two groups (cardio 0, 1)? Yes, we have evidence that they are different.","2923b8ec":"Height alone does not seem a realted variable, but calculating bmi will help to get a better insight:\/","9536f228":"\u2757\ufe0f min, and max of weight and height deosn't make sense.\n\n- minimum weight is 10 kg, which is an error.\n- minimum height is 55 cm, which is an error.","327080a2":"# Findings","a29e5e1c":"#### drop duplicates","426657f3":"# Findings","da2646b1":"## Decision Tree","bed4b8ae":"\ud83d\udc69\ud83c\udffb\u200d\ud83d\udcbb \n\n- The above chart obviously shows impact of high bload pressure on having CVD. Chi-squared test proves the interpretaion.","f1639c2b":"It is interesting. Their distribution is significantly different.","088f9ed3":"# OLS and ANOVA","000bde0d":"After creating heatmap and pair plot, I found that variables are not significantly correlated visually. However, I choose the pairs with most correlation in comparison to others and performed OLS or ANOVA to see the results. The analysis shows that we can expect some correlation between age, weight and high\/low blood pressure. For instance, we can have the following mode:\n\nY (high blood pressure) = 103.96 + 0.47*X(age)\n\nwe have also evidence that the mean of bmi, age, and cholesterol is different among people who have CVD and those who have not. \n","f2b04a20":"**Objective**: predict if a person is likely to have cardiovascular diseas.\n\n\n**Possible classes**: \"cardio: 0\", \"cardio: 1\"\n\n\n**Features**:age, ap_hi, ap_lo, bmi, bload_pressure_stage_High_Bload_Pressur_1, bload_pressure_stage_High_Bload_Pressur_2, bload_pressure_stage_Normal, age_range_middle_age, age_range_young, weight_status_Overweight, weight_status_Underweight, weight_status_obese, gender_2, cholesterol_2, cholesterol_3, gluc_2, gluc_3, smoke_1, alco_1, active_1, cardio_1","9664ba9d":"#### drop errors and outliers","2d2785e3":"\ud83d\udc69\ud83c\udffb\u200d\ud83d\udcbb \n\nFrom the bar chart It seems smoking doesnot have much impact on CVD. However, after performing chi2 test, p-value is less than 0.05, and we are in a good shape to reject the null hypothesis, which was there was no effect of smoke on having CVD.\n\n**It might be because we don't know how often they smoke. If people in the study were asked to choose a range that how oftern they smoke we could see a better results.**","823a2e88":"## Random Forest","41ec7e9c":"I found that weight has a normal distribution among both groups. Distributions are skewed to the right. Average weight, and median among people with CVD is 5 kg more. Low blood pressure also has a normal distribution. high pressure has a long tail and based on visual test we can conclude that its distribution is Pareto\/power distribution. By applying log scale for x and y axis, we can see the distribution for a reasonable range. In fact, the log scale shows the range that the majority of data occurs. Body mass index (bmi) has a normal distribution skewed to the right, and roughly the same for both groups.\n\nIt was interesting that, all distributions for both groups were roughly similar visually. However, by performing t-test, p-value was statistically significant, and we can conclude that the mean value of weight, height, bmi, low and high blood pressure between people who have CVD and who do not have it is significantly different.\n","ffaf856a":"low pressure has a normal distribution among both groups. Distributions are skewed to the right and left. P-value from t-test is less than 0.05, so mean value are significanty different.\n","6d970922":"# Data Preparation","a0a83152":"# Naive Baysian","c1d588ba":"\ud83d\udc69\ud83c\udffb\u200d\ud83d\udcbb \n\nBased on the bar chart, the same as smoke status, since we do not know a person with aclcohol status 1, how often drinks, we can't see any helpful information here. However, p-value of chi-squared test is not less than 0.05, and we do not have enough evidence to reject the null hypothesis, which was there was no effect of alcohol status on having CVD.","f4e0960d":"\ud83d\udc69\ud83c\udffb\u200d\ud83d\udcbb \n - There is no Null value in dataset.\n - There are 70000 observation.\n - there are 12 columns.","e434ebea":"I found that weight status (normal, overweight, underweight, obese), age range (young, middle age, elderly), blood pressure status (normal, elevated, high1, and high2), glucose level, cholesterol level, and physical activity status have effect on having CVD. Their frequency bar charts show this finding. I also performed chi-squared test for these variables and the p-value was less than 0.05. This means that we are in a good shape to reject the null hypothesis, which was there was no effect of each of these variables on having CVD. \n\nFor gender status, and alcohol intake, there was not much difference in their visualization. So, from the visualization I could not see any effect of these variables on having CVD. However, the p-value of chi-squared test was not statistically significant. So, we are not in a good shape to reject the null hypothesis which was there was no effect of each of these variables on having CVD. Since we do not know a person with alcohol status 1, how often drinks, we can't see any helpful information here.\n\nFor smoke status, there was not much difference in their visualization. So, from the visualization I could not see any effect of smoking on having CVD. The p-value from chi-square test was statistically significant, so we are in a good shape to reject the null hypothesis, which was there was no effect of smoking on having CVD. It might be because we don't know how often they smoke. If people in the study were asked to choose a range that how often they smoke, we could see a better result. Moreover, it is possible that some variables such as smoking does not have direct affect on CVD, but they cause one of other variable to have effect on it (correlation).\n","1601cf0e":"## K-fold cross validation","d6bbcfca":"\ud83d\udc69\ud83c\udffb\u200d\ud83d\udcbb\n\nFrom heatmap above, I can see:\n - age, low bload pressure (lo_pi), cholestrol, and bmi are slightly corrolated with cardio (target class). The reason their corrolation value are low is that each of these risk factors contributes to the CVD and their effect dependes on other variabls as well, not alone.\n \n \npairs with most corrolation:\n    \npoint1|point2|corrolation\n---|---|---\ncardio| lo_pi | 0.33\ncardio| cholestrol |0.22\ncardio| bmi | 0.19\ncardio|age|0.24\ncholestrol | gluc | 0.45\nWeight | lo_pi | 0.24\n\n\n","5db72c22":"#### convert age from days to years and create age range variable:"}}