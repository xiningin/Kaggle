{"cell_type":{"859fc7dc":"code","0fe2466c":"code","eaa4f222":"code","818fd9c4":"code","2749890b":"code","93104d04":"code","51ebad09":"code","6136dbfa":"code","e79cc7dc":"code","ac3af1dc":"code","043a2084":"code","7a57db75":"code","189a3bff":"code","8b2b08af":"code","d925cb3f":"code","a3a3b50f":"markdown","6a173046":"markdown","46a2212b":"markdown","4afc6649":"markdown","4dea95ed":"markdown","b46cfc38":"markdown","205483aa":"markdown","31783f49":"markdown","9369e9bc":"markdown","17146ee2":"markdown"},"source":{"859fc7dc":"!pip install openpyxl","0fe2466c":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nfrom matplotlib import style\nimport plotly.express as px\nimport plotly.graph_objects as go\nfrom plotly.offline import init_notebook_mode, iplot, plot\nimport plotly as py\ninit_notebook_mode(connected=True)\nimport plotly.graph_objs as go\nfrom wordcloud import WordCloud, ImageColorGenerator\nfrom PIL import Image","eaa4f222":"Regional_data = pd.ExcelFile(\"..\/input\/global-corruption-index-2021\/CPI2021_RegionalTables.xlsx\" )","818fd9c4":"#reading CPI Time series to find Rank changed since 2020\nCPI_time_series = pd.read_excel(\"..\/input\/global-corruption-index-2021\/CPI2021_GlobalResultsTrends.xlsx\", sheet_name=\"CPI Timeseries 2012 - 2021\")\nCPI_time_series = pd.DataFrame(CPI_time_series.loc[2:].values.tolist(), columns =CPI_time_series.loc[1])\nCPI_time_series.head()","2749890b":"#Rank Changed by Country\nCPI_time_series[\"RankChange2021\"] = CPI_time_series['Rank 2020'] - CPI_time_series['Rank 2021']\nCPI_time_series['RankChange2021'] = CPI_time_series['RankChange2021'].fillna(0)\nCPI_time_series[['Country \/ Territory','RankChange2021']][:10]\n","93104d04":"regional_df = pd.DataFrame()\nfor sheet in Regional_data.sheet_names: \n    data = pd.read_excel(\"..\/input\/global-corruption-index-2021\/CPI2021_RegionalTables.xlsx\", sheet_name =sheet )\n    df = pd.DataFrame(data.loc[2:].values.tolist(), columns =data.loc[1])\n    regional_df = pd.concat([regional_df, df])","51ebad09":"regional_df.head()","6136dbfa":"#unique values\nregional_df = regional_df.drop_duplicates(subset=['Country \/ Territory'])","e79cc7dc":"#Appending Rank Changed to the regional_df by locating country\nregional_df['Rank Changed'] = 0\n\nfor country, rank_changed in np.array(CPI_time_series[['Country \/ Territory','RankChange2021']]): \n    regional_df.loc[regional_df[regional_df['Country \/ Territory'] == country].index,'Rank Changed'] = int(rank_changed)\n    \nregional_df.head()","ac3af1dc":"!wget https:\/\/images.fineartamerica.com\/images\/artworkimages\/mediumlarge\/1\/5-watercolor-map-of-the-world-map-michael-tompsett.jpg -d map.jpg","043a2084":"text = \" \".join(regional_df['Country \/ Territory'].values)\nmask = np.array(Image.open(\".\/5-watercolor-map-of-the-world-map-michael-tompsett.jpg\"))\n\nwordcloud_country = WordCloud( background_color=\"white\", mode=\"RGBA\", max_words=1000, mask=mask).generate(text)\n\n# create coloring from image\nimage_colors = ImageColorGenerator(mask)\nplt.figure(figsize=[18,12])\nplt.imshow(wordcloud_country.recolor(color_func=image_colors), interpolation=\"bilinear\")\nplt.axis(\"off\")\nplt.show()","7a57db75":"import plotly.graph_objs as go\n\nfig = px.bar(regional_df[: len(regional_df)\/\/2], x='Country \/ Territory', y='CPI score 2021',\n             title=\"Top 50 % Countries CPI in 2021\",\n             hover_data=['Rank', 'Rank Changed'], color='CPI score 2021',\n              height=500, width=1100)\nfig.show()","189a3bff":"fig = px.bar(regional_df[len(regional_df)\/\/2: ], x='Country \/ Territory', y='CPI score 2021',\n             title= \"Rest 50 % CPI in 2021 \",\n             hover_data=['Rank','Rank Changed'], color='CPI score 2021'\n             , height=500, width = 1100)\nfig.show()","8b2b08af":"fig = px.choropleth(regional_df, locations=\"Country \/ Territory\", locationmode='country names', color=\"CPI score 2021\",\n                   hover_data=['Rank', 'Rank Changed'] )","d925cb3f":"fig.update_layout(title_text=\"Heatmap of CPI for Countries in 2021\", title_font_size=24,\n                  height=800, width=1000, yaxis_title=\"GDP($)\", xaxis_title=\"Country\",\n                  title_y=0.85, title_x=0.45)\n\nfig.show()","a3a3b50f":"## Importing Libraries","6a173046":"### References: \n\n- https:\/\/www.transparency.org\/en\/\n- https:\/\/en.wikipedia.org\/wiki\/Corruption_Perceptions_Index \n- fineartamerica.com","46a2212b":"My country India is at Rank of 84 and Rank gained by 1 since 2020 Rank.\n\nCheck your Country. ","4afc6649":"## Let's see some plots","4dea95ed":"### Rest 50% countries with Corruption","b46cfc38":"## What is Corruption Perception Index? \nThe Corruption Perceptions Index (CPI) is an index which ranks countries \"by their perceived levels of public sector corruption, as determined by expert assessments and opinion surveys.\"The CPI generally defines corruption as an \"abuse of entrusted power for private gain\". The index is published annually by the non-governmental organisation Transparency International since 1995.\n\n![image.png](attachment:b24c6f21-cb13-43dd-9657-c6df605fb471.png)","205483aa":"## Reading files: ","31783f49":"## World Heat Map CPI Score 2021","9369e9bc":"## Top 50% countries with Corruption","17146ee2":"## Converting excel data to pandas Data frame"}}