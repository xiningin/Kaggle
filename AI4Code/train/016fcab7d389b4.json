{"cell_type":{"13e9ac98":"code","281fa3b1":"code","6aba28fe":"code","41e2ca2b":"code","ba8b6b29":"code","79ce38f4":"code","b679170c":"code","109960a3":"code","3b055b8b":"code","9f8811c5":"code","119979bd":"code","7c35c385":"code","2f950bd3":"code","71638372":"code","7bdef22f":"code","f05b5c8e":"code","c68a2957":"code","cf20116f":"code","84bb5303":"code","adefacdd":"code","25260535":"code","ef33eca7":"code","84be3d94":"code","a8f61d1a":"code","4e697a12":"code","ed2479b3":"code","3a61c443":"code","d9593fa3":"code","11881372":"code","faad7627":"code","1cdafb4c":"code","cbee0304":"code","b750a029":"code","4e8b08aa":"code","d7dfa908":"code","7695b3e5":"markdown","39355216":"markdown","e8203aa5":"markdown","fb3f9ed7":"markdown","64e203a2":"markdown","eab8fd4c":"markdown","cc88e7c9":"markdown","d235925c":"markdown","0b4bc30c":"markdown","b190c9a6":"markdown","0095552c":"markdown","15e8df56":"markdown","ea1d7655":"markdown","1ac62542":"markdown","98fae149":"markdown","ae14b6ba":"markdown","819fd6f0":"markdown","155fc507":"markdown","9344754b":"markdown","1a44f4c2":"markdown","75a37a3f":"markdown","a3545382":"markdown","2ed19193":"markdown"},"source":{"13e9ac98":"pip install lucifer-ml","281fa3b1":"import matplotlib.pyplot as plt\nimport matplotlib.pyplot as plt\nplt.style.use('fivethirtyeight')\nplt.style.use('dark_background')\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\nfrom matplotlib.colors import ListedColormap\nfrom collections import Counter\nfrom scipy import stats\nfrom tqdm import tqdm_notebook\n\n## Importing LuciferML\nfrom luciferml.supervised.classification import Classification\nfrom luciferml.preprocessing import Preprocess as prep\n\nimport warnings\nwarnings.simplefilter(action='ignore', category=Warning)","6aba28fe":"dataset = pd.read_csv('..\/input\/health-insurance-cross-sell-prediction\/train.csv')","41e2ca2b":"dataset.head()","ba8b6b29":"dataset.shape","79ce38f4":"dataset.describe().T.style.bar(\n    subset=['mean'],\n    color='#606ff2').background_gradient(\n    subset=['std'], cmap='PuBu').background_gradient(subset=['50%'], cmap='PuBu')","b679170c":"dataset.info()","109960a3":"dataset.isnull().values.any().any()","3b055b8b":"plt.figure(figsize=(12, 6))\nsns.countplot(x=\"Response\", data=dataset, palette='husl');","9f8811c5":"categorical_cols =['Gender','Vehicle_Damage']","119979bd":"quant_cols = [ 'Age', 'Region_Code',\n        \n       'Policy_Sales_Channel', 'Vintage']\n","7c35c385":"def boxPlotter(dataset, columnName):\n    \"\"\"\n    Plots boxplots for column given as parameter.\n    \"\"\"\n    sns.catplot(x=\"Response\", y=columnName, data=dataset, kind=\"box\");\nfor column in tqdm_notebook(quant_cols, desc = \"Your Charts are being ready\"):\n    boxPlotter(dataset, column)","2f950bd3":"def pieChartPlotter(dataset, columnName):\n    \"\"\"\n    Creates pie chart of the column given as parameter in the dataset\n    \"\"\"\n    values = dataset[columnName].value_counts()\n    labels = dataset[columnName].unique()\n    pie, ax = plt.subplots(figsize=[10, 6])\n\n    patches, texts, autotexts = ax.pie(values, labels=labels, autopct='%1.2f%%', shadow=True, pctdistance=.5\n                                       )\n\n    plt.legend(patches, labels, loc=\"best\")\n    plt.title(columnName, color='white', fontsize=14)\n    plt.setp(texts, color='white', fontsize=20)\n    plt.setp(autotexts, size=10, color='black')\n    autotexts[1].set_color('black')\n    plt.axis('equal')\n    plt.tight_layout()\n    plt.show()","71638372":"for column in categorical_cols:\n    pieChartPlotter(dataset, column) ","7bdef22f":"corr_data = dataset.drop(['id'],axis = 1)","f05b5c8e":"fig = px.scatter(ins_claim_data, x = 'Vehical_Damage', y = 'Annual_Premium', color = 'Age',\n                marginal_x = 'rug', marginal_y = 'histogram')\nfig.show()","c68a2957":"plt.figure(figsize=(20, 17))\nmatrix = np.triu(corr_data.corr())\nsns.heatmap(corr_data.corr(), annot=True,linewidth=.8, mask=matrix, cmap=\"rocket\");","cf20116f":"def distributionPlot(dataset):\n    \"\"\" \n    Creates distribution plot.\n    \"\"\"\n    fig = plt.figure(figsize=(20, 20))\n    for i in tqdm_notebook(range(0, len(dataset.columns)), desc = 'Your plots are being ready'):\n        fig.add_subplot(np.ceil(len(dataset.columns)\/3), 3, i+1)\n        sns.distplot(\n            dataset.iloc[:, i], color=\"lightcoral\", rug=True)\n        fig.tight_layout(pad=3.0)","84bb5303":"plot_data = dataset.drop(['id', 'Response','Gender', 'Vehicle_Damage', 'Vehicle_Age', 'Driving_License', 'Region_Code','Policy_Sales_Channel','Previously_Insured' ], axis =1)","adefacdd":"distributionPlot(plot_data)","25260535":"pp_plot_data = dataset.drop(['id','Gender', 'Vehicle_Damage', 'Vehicle_Age', 'Driving_License', 'Region_Code','Policy_Sales_Channel','Previously_Insured' ], axis =1)","ef33eca7":"sns.pairplot(pp_plot_data, hue=\"Response\", palette=\"husl\");","84be3d94":"dataset = prep.skewcorrect(dataset,except_columns=['id', 'Response'])","a8f61d1a":"dataset = dataset.drop('Vehicle_Age', axis =1)\nfeatures = dataset.iloc[:, 1:-1]\nlabels = dataset.iloc[:, -1]","4e697a12":"features , labels","ed2479b3":"features.shape, labels.shape","3a61c443":"accuracy_scores = {}","d9593fa3":"params = {'C': 0.0001, 'penalty': 'l1', 'solver': 'liblinear'}\nclassifier =  Classification(predictor = 'lr',params=params, lda = 'y')\nclassifier.fit(features, labels)\nresult = classifier.result()\naccuracy_scores[result['Classifier']] = result['Accuracy']","11881372":"params = {'algorithm': 'kd_tree', 'n_jobs': 1, 'n_neighbors': 5, 'weights': 'uniform'}\nclassifier =  Classification(predictor = 'knn',params=params, lda = 'y')\nclassifier.fit(features, labels)\nresult = classifier.result()\naccuracy_scores[result['Classifier']] = result['Accuracy']","faad7627":"params = {'criterion': 'entropy', 'max_depth': 30, 'max_features': 'sqrt', 'splitter': 'best', 'random_state': 42}\nclassifier =  Classification(predictor = 'dt',params=params, lda = 'y')\nclassifier.fit(features, labels)\nresult = classifier.result()\naccuracy_scores[result['Classifier']] = result['Accuracy']","1cdafb4c":"params = {'criterion': 'gini', 'max_features': 'auto', 'n_estimators': 150,'random_state':0}\nclassifier =  Classification(predictor = 'rfc',params=params, lda = 'y')\nclassifier.fit(features, labels)\nresult = classifier.result()\naccuracy_scores[result['Classifier']] = result['Accuracy']","cbee0304":"params = {'learning_rate':0.02, 'n_estimators':600, 'objective':'binary:logistic', 'eval_metric':'logloss', 'nthread':-1}\nclassifier =  Classification(predictor = 'xgb',params=params, lda = 'y')\nclassifier.fit(features, labels)\nresult = classifier.result()\naccuracy_scores[result['Classifier']] = result['Accuracy']","b750a029":"classifier =  Classification(predictor = 'ann', lda = 'y',batch_size = 25, input_units = 15)\nclassifier.fit(features, labels)\nresult = classifier.result()\naccuracy_scores[result['Classifier']] = result['Accuracy']","4e8b08aa":"maxKey = max(accuracy_scores, key=lambda x: accuracy_scores[x])\nprint('The model with highest K-Fold Validation Accuracy score is  {0} with an accuracy of  {1:.2f}'.format(\n    maxKey, accuracy_scores[maxKey]))","d7dfa908":"plt.figure(figsize=(12, 6))\nmodel_accuracies = list(accuracy_scores.values())\nmodel_names = list(accuracy_scores.keys())\nsns.barplot(x=model_accuracies, y=model_names, palette='mako');","7695b3e5":"\n<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:pink;\n           color:Black;\n           font-family:times\n           \">\n<h1 style=\"text-align:center;font-weight: bold\"> Exploratory Data Analysis <\/h1>\n<\/div>\n","39355216":"\n\n<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:pink;\n           color:Black;\n           font-family:times\n           \">\n<h2 style=\"text-align:center;\">Training Decision Trees<\/h2>\n<\/div>\n\n","e8203aa5":"\n\n<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:pink;\n           color:Black;\n           font-family:times\n           \">\n<h2 style=\"text-align:center;\">Training Random Forest<\/h2>\n<\/div>\n\n\n","fb3f9ed7":"\n\n<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:pink;\n           color:Black;\n           font-family:times\n           \">\n<h1 style=\"text-align:center;font-weight: bold\">Summary<\/h1>\n<h2 style=\"text-align:center;\">Artificial Neural Network performed best.<\/h2>\n<\/div>\n","64e203a2":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:pink;\n           color:Black;\n           font-family:times\n           \">\n<p style=\"text-align:center;\"> It's important to have health insurance as a safety net. If you unexpectedly get sick or injured, health insurance is there to help cover costs that you likely can't afford to pay on your own. Health care can be very expensive. It can be an enormous financial burden. <\/p>\n<\/div>\n\n","eab8fd4c":"\n\n<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:pink;\n           color:Black;\n           font-family:times\n           \">\n<h1 style=\"text-align:center;font-weight: bold\">Finding which model performed better<\/h1>\n<\/div>\n","cc88e7c9":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:pink;\n           color:Black;\n           font-family:times\n           \">\n<h4 style=\"text-align:left;\">From above charts we can confirm<\/h4>\n<p style=\"text-align:left;\">1) There seems to be significant  correlation between all the features.\n    <br>\n2) Some columns are skewed. So, lets correct it<\/p>\n<\/div>\n","d235925c":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:pink;\n           color:Black;\n           font-family:times\n           \">\n<h2 style=\"text-align:center;\">Some Box Plots<\/h2>\n<\/div>\n","0b4bc30c":"\n\n<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:green;\n           color:Black;\n           font-family:cursive\n           \">\n<h2 style=\"text-align:center;\">Training ANN<\/h2>\n<\/div>\n\n","b190c9a6":"\n\n<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:pink;\n           color:Black;\n           font-family:times\n           \">\n<h2 style=\"text-align:center;\">Training K-Nearest Neighnours<\/h2>\n<\/div>\n\n\n\n\n","0095552c":"\n\n<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:pink;\n           color:Black;\n           font-family:times\n           \">\n<h1 style=\"text-align:center;font-weight: bold\">Model training<\/h1>\n<\/div>\n\n\n","15e8df56":"\n<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:pink;\n           color:Black;\n           font-family:times\n           \">\n<h1 style=\"text-align:center;font-weight: bold\"> Importing Dataset <\/h1>\n<\/div>\n","ea1d7655":"![facts](https:\/\/i.pinimg.com\/originals\/c2\/fc\/44\/c2fc441ff047a90a5e8052b794888de5.jpg)\n\n\n#### [Image Source](https:\/\/i.pinimg.com\/originals\/c2\/fc\/44\/c2fc441ff047a90a5e8052b794888de5.jpg)","1ac62542":"\n\n<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:pink;\n           color:Black;\n           font-family:times\n           \">\n<h2 style=\"text-align:center;\">Correlation Plot<\/h2>\n<\/div>","98fae149":"![](https:\/\/previews.123rf.com\/images\/bearsky23\/bearsky231808\/bearsky23180800221\/107269561-insurance-web-header-banner-that-covers-homeowners-medical-life-vehicle-insurance.jpg)\n#### [Image Source](https:\/\/previews.123rf.com\/images\/bearsky23\/bearsky231808\/bearsky23180800221\/107269561-insurance-web-header-banner-that-covers-homeowners-medical-life-vehicle-insurance.jpg)","ae14b6ba":"\n\n<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:pink;\n           color:Black;\n           font-family:times\n           \">\n<h2 style=\"text-align:center;\">Pie Chart<\/h2>\n<\/div>\n\n","819fd6f0":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:pink;\n           color:Black;\n           font-family:times\n           \">\n<h2 style=\"text-align:center;\">Skewness Correction<\/h2>\n<\/div>","155fc507":"\n\n<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:pink;\n           color:Black;\n           font-family:times\n           \">\n<h2 style=\"text-align:center;\">Training Logistic Regression<\/h2>\n<\/div>\n\n\n\n","9344754b":"\n\n<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:pink;\n           color:Black;\n           font-family:times\n           \">\n<h2 style=\"text-align:center;\">Training XGBoost Classifier<\/h2>\n<\/div>\n\n","1a44f4c2":"\n\n<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:pink;\n           color:Black;\n           font-family:times\n           \">\n<h1 style=\"text-align:center;font-weight:bold\">Lets Begin with EDA<\/h1>\n<\/div>\n\n","75a37a3f":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:pink;\n           color:Black;\n           font-family:times\n           \">\n<h1 style=\"text-align:center;font-weight: bold\"> Importing Libraries <\/h1>\n<\/div>\n","a3545382":"\n\n<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:pink;\n           color:Black;\n           font-family:times\n           \">\n<h2 style=\"text-align:center;\">Encoding of labels <\/h2>\n<\/div>\n\n","2ed19193":"\n\n<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:pink;\n           color:Black;\n           font-family:times\n           \">\n<h2 style=\"text-align:center;\">Splitting Columns into Categorical and Quantitative Data<\/h2>\n<\/div>\n"}}