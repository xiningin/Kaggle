{"cell_type":{"d271f7d8":"code","1ea49e01":"code","1e32f974":"code","1668b84e":"code","5e2df411":"code","1471a401":"code","ba0ddf8a":"code","4aa46a1b":"code","b853ca48":"code","5204b54f":"code","0e5c42ed":"code","3bc5b473":"code","dc683fb5":"code","5992a026":"code","23f1f0aa":"code","91be844d":"markdown","a37ee970":"markdown","5824e605":"markdown","ad8f3758":"markdown","16d60b75":"markdown"},"source":{"d271f7d8":"# import package with helper functions \nimport bq_helper\n\n# create a helper object for this dataset\nhacker_news = bq_helper.BigQueryHelper(active_project=\"bigquery-public-data\",\n                                   dataset_name=\"hacker_news\")\n\n# print the first couple rows of the \"comments\" table\nhacker_news.head(\"full\")","1ea49e01":"query = \"\"\" SELECT type, COUNT(id)\n            FROM `bigquery-public-data.hacker_news.full`\n            GROUP BY type\n        \"\"\"","1e32f974":"group_type = hacker_news.query_to_pandas_safe(query)","1668b84e":"group_type","5e2df411":"hacker_news.head('comments')","1471a401":"query2 = \"\"\" SELECT deleted, COUNT(id)\n             FROM `bigquery-public-data.hacker_news.comments`\n             GROUP BY deleted\n         \"\"\"","ba0ddf8a":"deleted = hacker_news.query_to_pandas_safe(query2)","4aa46a1b":"deleted","b853ca48":"deleted_count = deleted.iloc[0,1]\ndeleted_count","5204b54f":"query3 = \"\"\" SELECT deleted, MIN(id)\n             FROM `bigquery-public-data.hacker_news.comments`\n             GROUP BY deleted\n         \"\"\"","0e5c42ed":"min_id = hacker_news.query_to_pandas_safe(query3)","3bc5b473":"min_id","dc683fb5":"query4 = \"\"\" SELECT deleted, COUNT(parent)\n             FROM `bigquery-public-data.hacker_news.comments`\n             GROUP BY deleted\n             HAVING COUNT(parent)>1000000\n         \"\"\"  ","5992a026":"deleted_1m = hacker_news.query_to_pandas_safe(query4)","23f1f0aa":"deleted_1m # we do not have deleted comments that have parent > 1000000","91be844d":"#### 4) How many comments have been deleted with parent > 1.000.000 ? (If a comment was deleted the \"deleted\" column in the comments table will have the value \"True\".)","a37ee970":"#### 2) How many comments have been deleted? (If a comment was deleted the \"deleted\" column in the comments table will have the value \"True\".)","5824e605":"#### 3) Modify one of the queries you wrote above to use a different aggregate function.\nYou can read about aggregate functions other than COUNT() **[in these docs](https:\/\/cloud.google.com\/bigquery\/docs\/reference\/standard-sql\/functions-and-operators#aggregate-functions)**","ad8f3758":"# Question\nUsing the Hacker News dataset in BigQuery, answer the following questions:\n\n#### 1) How many stories (use the \"id\" column) are there of each type (in the \"type\" column) in the full table?","16d60b75":"---\n\n# Keep Going\n[Click here](https:\/\/www.kaggle.com\/dansbecker\/order-by) to move on and learn about the ORDER BY clause.\n\n# Feedback\nBring any questions or feedback to the [Learn Discussion Forum](kaggle.com\/learn-forum).\n\n----\n\n*This exercise is part of the [SQL Series](https:\/\/www.kaggle.com\/learn\/sql) on Kaggle Learn.*"}}