{"cell_type":{"562a2c01":"code","d82245a9":"code","dbdab271":"code","2197c54c":"code","0a0348d6":"code","718546ff":"code","637af258":"code","f627ed85":"code","cf486e6c":"code","6efcac45":"code","4691bc5b":"code","d07832fa":"code","9bd9de67":"code","caa6f3b7":"code","85f46742":"code","16473b4a":"code","f8f48b5b":"code","b0e10a35":"code","af04f81f":"code","7e6d9fd0":"code","d142e575":"code","80d8884d":"code","fbe2dbbc":"code","c0b2293a":"code","89866070":"code","cb58b84d":"code","64497e9d":"code","e9225bca":"code","922a18d5":"code","e70e4022":"code","5bdd183e":"code","cb3d9f39":"code","e9efe281":"code","29253bc8":"code","dca4aa21":"code","01f6a4f0":"code","9e7d62e9":"code","ec4f5c4b":"code","4bebad6f":"code","74ff1712":"code","c6abf3d9":"code","0bc9bb32":"code","67592da7":"code","fa8c8050":"code","f8149e0d":"code","2c4a9eb6":"code","fc905ca8":"code","6cab3a31":"code","db8befe5":"code","aaae0e58":"code","6b93743e":"code","5df8c8c3":"code","42bcf82b":"code","8e929b5a":"code","6bc30d39":"code","dd2e307d":"markdown"},"source":{"562a2c01":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","d82245a9":"dataset = pd.read_csv(\"..\/input\/train.csv\") ","dbdab271":"dataset.head()","2197c54c":"dataset[['class1','class2']] = pd.get_dummies(dataset['Pclass'],drop_first=True)","0a0348d6":"dataset.head()","718546ff":"import seaborn as sns\ndataset.notnull()\nsns.heatmap(dataset.notnull())","637af258":"\ndef impute_age(cols):\n    Age = cols[0]\n    Pclass = cols[1]\n    if pd.isnull(Age):\n        if Pclass == 1:\n            return 37\n        elif Pclass == 2:\n            return 29\n        else:\n            return 24\n    else:\n        return Age","f627ed85":"dataset['Age'] = dataset[['Age','Pclass']].apply(impute_age,axis = 1)","cf486e6c":"sns.heatmap(dataset.isnull())","6efcac45":"dataset.drop('Cabin',inplace = True,axis = 1)","4691bc5b":"dataset['Sex'] = pd.get_dummies(dataset['Sex'],drop_first=True) ","d07832fa":"dataset.head()","9bd9de67":"embark = pd.get_dummies(dataset['Embarked'],drop_first = True)","caa6f3b7":"\ndataset.head()","85f46742":"dataset.dropna(inplace = True)","16473b4a":"sns.heatmap(dataset.isnull())","f8f48b5b":"dataset = pd.concat([dataset,embark],axis = 1)","b0e10a35":"dataset.head()","af04f81f":"dataset.drop(['PassengerId','Name','Ticket','Embarked'],axis = 1,inplace = True)","7e6d9fd0":"dataset.head()","d142e575":"x = dataset.drop('Survived',axis = 1)\nx = x.drop('Pclass',axis = 1)\ny = dataset['Survived']","80d8884d":"from sklearn.ensemble import RandomForestClassifier","fbe2dbbc":"rfc = RandomForestClassifier(n_estimators = 300,criterion = 'entropy')","c0b2293a":"x.dropna(inplace = True)","89866070":"y.dropna(inplace = True)","cb58b84d":"rfc.fit(x,y)","64497e9d":"test = pd.read_csv(\"..\/input\/test.csv\")","e9225bca":"test.head()","922a18d5":"embark = pd.get_dummies(test['Embarked'],drop_first=True)","e70e4022":"sex = pd.get_dummies(test['Sex'],drop_first=True)","5bdd183e":"test.drop(['PassengerId','Name','Sex','Ticket','Cabin','Embarked'],inplace = True,axis = 1)","cb3d9f39":"new_test = pd.concat([test,sex,embark],axis = 1)","e9efe281":"new_test.head()","29253bc8":"new_test['Age'] = new_test[['Age','Pclass']].apply(impute_age,axis = 1)","dca4aa21":"sns.heatmap(new_test.isnull())","01f6a4f0":"new_test['Sex'] = new_test['male']","9e7d62e9":"new_test.drop('male',axis = 1,inplace = True)","ec4f5c4b":"new_test.head()","4bebad6f":"x.head()","74ff1712":"new_test[['class1','class2']] = pd.get_dummies(new_test['Pclass'],drop_first = True)","c6abf3d9":"new_test.head()","0bc9bb32":"new_test = new_test.drop('Pclass',axis = 1)","67592da7":"sns.heatmap(new_test.notna())","fa8c8050":"x.head()","f8149e0d":"test_set = new_test[['Sex','Age','SibSp','Parch','Fare','class1','class2','Q','S']]","2c4a9eb6":"sns.heatmap(test_set.isna())","fc905ca8":"np.where(test_set.isna())","6cab3a31":"new_test = test_set.fillna(test_set['Fare'].mean())","db8befe5":"y_pred = rfc.predict(new_test)","aaae0e58":"y_pred","6b93743e":"test_1 = pd.read_csv(\"..\/input\/test.csv\")\ntest_1.head()","5df8c8c3":"submission = pd.DataFrame({\"PassengerID\":test_1['PassengerId'],\"Survived\":y_pred})\nsubmission.PassengerID = submission.PassengerID.apply(int)\nsubmission.Survived = submission.Survived.apply(int)","42bcf82b":"submission.head()","8e929b5a":"submission.groupby('Survived').count()","6bc30d39":"#CSV file for submission\nsubmission.to_csv(\"titanic_submission_rfc.csv\", index=False)","dd2e307d":"## Overview of people survived using Random Forest Classifier"}}