{"cell_type":{"866728fb":"code","56747c0a":"code","5116486f":"code","4c14e148":"markdown"},"source":{"866728fb":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","56747c0a":"import numpy as np # linear algebra\nimport matplotlib.pylab as plt # Plotting\nimport sklearn # Machine learning models.\nfrom sklearn.naive_bayes import GaussianNB # Gaussian Naive Bayes.\nimport sklearn.metrics # Area Under the ROC calculations.\n\n# Load data. This is the filename if running on kaggle.com. Otherwise change this.\nfilename = '\/kaggle\/input\/higgs-boson-detection\/train.csv'\ndata = np.loadtxt(filename, skiprows=1, delimiter=',')\n\n# Split off validation set for testing.\nXtrain = data[:40000, 1:]\nYtrain = data[:40000, 0:1]\nXvalid = data[40000:, 1:]\nYvalid = data[40000:, 0:1]\n\n# Fit model to train.\nmodel = GaussianNB()\nmodel.fit(Xtrain, Ytrain)\n\n# Make hard predictions.\nhard_predictions = model.predict(Xvalid)\n\n# Make probabilistic predictions.\npredictions = model.predict_proba(Xvalid)\n\n# Compute AUROC.\nval = sklearn.metrics.roc_auc_score(Yvalid, predictions[:,1])\nprint(f'Validation AUROC: {val}' )\n\n# Plot ROC curve.\nfpr, tpr, thresholds = sklearn.metrics.roc_curve(Yvalid, predictions[:,1])\nplt.plot(fpr, tpr)\nplt.plot([0, 1], [0, 1], color='navy', linestyle='--')\nplt.xlim([0.0, 1.0])\nplt.ylim([0.0, 1.05])\nplt.xlabel('False Positive Rate')\nplt.ylabel('True Positive Rate')","5116486f":"# Make probabilistic predictions.\nfilename = '\/kaggle\/input\/higgs-boson-detection\/test.csv' # This is the path if running on kaggle.com. Otherwise change this.\nXtest1 = np.loadtxt(filename, skiprows=1, delimiter=',', usecols=range(1,29))\npredictions = model.predict_proba(Xtest1)\npredictions = predictions[:,1:2] # Predictions has two columns. Get probability that label=1.\nN = predictions.shape[0]\nassert N == 50000, \"Predictions should have length 50000.\"\nsubmission = np.hstack((np.arange(N).reshape(-1,1), predictions)) # Add Id column.\nnp.savetxt(fname='submission.csv', X=submission, header='Id,Predicted', delimiter=',', comments='')\n\n# If running on Kaggle.com, submission.csv can be downloaded from this Kaggle Notebook under Sessions->Data->output->\/kaggle\/working.","4c14e148":"# Make Predictions and Prepare Submission File"}}