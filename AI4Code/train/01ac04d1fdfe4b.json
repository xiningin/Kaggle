{"cell_type":{"3c4b766d":"code","2c777aea":"code","be9719d5":"code","e89276d4":"code","65822a71":"code","6184fda5":"code","e5bc6507":"code","b1e67144":"code","2e922c20":"code","4fb815d7":"code","e049b689":"code","6d2bdb4d":"code","af4bcecf":"code","fef3c398":"code","59ca62e2":"code","307a69eb":"code","59a011c1":"code","2cd60256":"code","aa53e251":"code","d450b4cf":"code","4ed76403":"code","7c526496":"markdown","c7167972":"markdown"},"source":{"3c4b766d":"!pip install lycon","2c777aea":"import sys\nimport os\nimport pandas as pd\nimport numpy as np\nfrom collections import defaultdict\nimport lycon\nimport cv2\nfrom PIL import Image\nimport pandas_profiling as pdp\n\nimport matplotlib.pyplot as plt\n%matplotlib inline\nfrom pylab import rcParams\nrcParams['figure.figsize'] = 20,10\nimport warnings\nwarnings.filterwarnings('ignore')","be9719d5":"# data\u8aad\u307f\u8fbc\u307f\ndf_train = pd.read_csv(\"\/kaggle\/input\/comp-dog\/train.csv\")\ndf_test = pd.read_csv(\"\/kaggle\/input\/comp-dog\/submission.csv\")\nsubmission = pd.read_csv(\"\/kaggle\/input\/comp-dog\/submission.csv\")","e89276d4":"print(f\"df_train.shape:{df_train.shape}\")\ndf_train.head()","65822a71":"print(f\"df_test.shape:{df_test.shape}\")\ndf_test.head()","6184fda5":"pdp.ProfileReport(df_train)","e5bc6507":"count_dic = defaultdict(int)\nfor i in df_train[\"class\"]:\n    count_dic[i] += 1","b1e67144":"count_list = [[v,k] for k,v in count_dic.items()]","2e922c20":"print(f\"Least frequent category: {min(count_list)}\")\nprint(f\"Most frequent category: {max(count_list)}\")","4fb815d7":"count_list.sort(reverse=True)\nn_samples = 10\nleft = [i[1] for i in count_list[:n_samples]]\nheight = [i[0] for i in count_list[:n_samples]]\nfig, ax = plt.subplots(figsize=(20,10))\nax.bar(left,height)\nax.set_title(f\"top {n_samples} categories\")\nplt.xticks(rotation=45)\nplt.show()","e049b689":"count_list.sort(reverse=False)\nn_samples = 10\nleft = [i[1] for i in count_list[:n_samples]]\nheight = [i[0] for i in count_list[:n_samples]]\nfig, ax = plt.subplots(figsize=(20,10))\nax.bar(left,height)\nax.set_title(f\"bottom {n_samples} categories\")\nplt.xticks(rotation=45)\nplt.show()","6d2bdb4d":"for i in range(5):\n    f, axarr = plt.subplots(1,4)\n    for j in range(4):\n        idx = i*4+j\n        img = lycon.load(os.path.join(\"..\/input\/comp-dog\/train\/train\",df_train[\"img_name\"][idx]+\".jpg\"))\n        axarr[j].imshow(img)\n        axarr[j].set_title(df_train[\"class\"][idx])","af4bcecf":"#\u753b\u50cf\u30b5\u30a4\u30ba\u306e\u3070\u3089\u3064\u304d\nh = []\nw = []\nfor path in df_train[\"img_name\"]:\n    img = lycon.load(os.path.join(\"..\/input\/comp-dog\/train\/train\",path+\".jpg\"))\n    h.append(img.shape[0])\n    w.append(img.shape[1])\n    ","fef3c398":"df_res = pd.DataFrame({\"h\":h,\"w\":w})","59ca62e2":"df_res.describe()","307a69eb":"print(np.argmax(np.array(h)))\nimg = lycon.load(os.path.join(\"..\/input\/comp-dog\/train\/train\",df_train[\"img_name\"][np.argmax(np.array(h))]+\".jpg\"))\nplt.imshow(img)","59a011c1":"print(np.argmax(np.array(w)))\nimg = lycon.load(os.path.join(\"..\/input\/comp-dog\/train\/train\",df_train[\"img_name\"][np.argmax(np.array(w))]+\".jpg\"))\nplt.imshow(img)","2cd60256":"#test_df\u306b\u3064\u3044\u3066\u3082\u540c\u69d8\u306b\u30c1\u30a7\u30c3\u30af\n#\u753b\u50cf\u30b5\u30a4\u30ba\u306e\u3070\u3089\u3064\u304d\nh = []\nw = []\nfor path in df_test[\"img_name\"]:\n    img = lycon.load(os.path.join(\"..\/input\/comp-dog\/test\/test\",path+\".jpg\"))\n    h.append(img.shape[0])\n    w.append(img.shape[1])\ndf_res = pd.DataFrame({\"h\":h,\"w\":w})","aa53e251":"df_res.describe()","d450b4cf":"print(np.argmax(np.array(h)))\nimg = lycon.load(os.path.join(\"..\/input\/comp-dog\/test\/test\",df_test[\"img_name\"][np.argmax(np.array(h))]+\".jpg\"))\nplt.imshow(img)","4ed76403":"print(np.argmax(np.array(w)))\nimg = lycon.load(os.path.join(\"..\/input\/comp-dog\/test\/test\",df_test[\"img_name\"][np.argmax(np.array(w))]+\".jpg\"))\nplt.imshow(img)","7c526496":"\u6700\u3082\u591a\u3044\u30ab\u30c6\u30b4\u30ea\u3068\u6700\u3082\u5c11\u306a\u3044\u30ab\u30c6\u30b4\u30ea\u3067\u30822\u500d\u7a0b\u5ea6\u3002\u305d\u3053\u307e\u3067\u4e0d\u5747\u8861\u3067\u306f\u306a\u3055\u305d\u3046\u3002","c7167972":"# \u753b\u50cf\u30b5\u30a4\u30ba\u306b\u3064\u3044\u3066  \n\u7e26\u6a2a\u306e\u5e73\u5747\u306f(386x442)\u3067\u3001\u5927\u4f53\u306e\u753b\u50cf\u304c(500x500)\u4ee5\u5185\u306b\u53ce\u307e\u308b\u304c\u30011000pixel\u3092\u8d85\u3048\u308b\u5834\u5408\u3082\u3042\u308b"}}