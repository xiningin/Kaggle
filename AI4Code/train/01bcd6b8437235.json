{"cell_type":{"57f26d17":"code","aea923bf":"code","a2138c3e":"code","6856b3ac":"code","b1ad2fca":"code","68a6d36c":"code","7354fbab":"code","aa70c3e7":"code","9e296949":"code","e0cee3f3":"markdown","3959ccc5":"markdown"},"source":{"57f26d17":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","aea923bf":"import numpy\nimport pandas\nfrom keras.models import Sequential\nfrom keras.layers import Dense\nfrom sklearn.preprocessing import MinMaxScaler\n","a2138c3e":"# load train dataset\ndataframe = pandas.read_csv(\"..\/input\/train.csv\")\ndataset = dataframe.values\n# split into input (X) and output (Y) variables\nX = dataset[:,0:6]\ny = dataset[:,6:8]\n\n#print(\"X: first 4 rows\")\n#print(X[:4])\n#print(\"Y: first 4 rows\")\n#print(y[:4])","6856b3ac":"# load test dataset\ntestdataframe = pandas.read_csv(\"..\/input\/test.csv\")\ntestdataset = testdataframe.values\n# split into input (X) and output (Y) variables\nXtest = testdataset[:,1:7]\n\nprint(\"Xtest: first 4 rows\")\nprint(Xtest[:4])\n","b1ad2fca":"def createModel(input,output):\n    # define and fit the final model\n    model = Sequential()\n    model.add(Dense(input.shape[1], input_dim=6, activation='relu'))\n    model.add(Dense(512, activation='relu'))\n    model.add(Dense(512, activation='relu'))\n    model.add(Dense(128, activation='relu'))\n    model.add(Dense(64, activation='relu'))\n    model.add(Dense(32, activation='relu'))\n    model.add(Dense(output.shape[1], activation='linear'))\n    model.compile(loss='mae', optimizer='RMSprop', metrics=['mae'])\n\n    model.summary()\n    return model\n\n","68a6d36c":"def fitPredict(model, X, y, Xtest):\n    #Normalize data\n    scalarX, scalarY = MinMaxScaler(), MinMaxScaler()\n    scalarX.fit(X)\n    scalarY.fit(y)\n    X = scalarX.transform(X)\n    y = scalarY.transform(y)\n\n    '''\n    print(\"X: first 4 rows\")\n    print(X[:4])\n    print(\"Y: first 4 rows\")\n    print(y[:4])\n    '''\n    \n    # new instances where we do not know the answer\n    print(\"Xtest: first 4 rows\")\n    print(Xtest[:4])\n    Xtest = scalarX.transform(Xtest)\n    \n\n    \n    \n    \n    \n    model.fit(X, y, epochs=1, verbose=0, validation_split=0.20, batch_size=20)\n    \n    \n    \n    # make a prediction\n    ytest = model.predict(Xtest)\n    ytest= scalarY.inverse_transform(ytest)\n    xtest = scalarX.inverse_transform(Xtest)\n    # show the inputs and predicted outputs\n    for i in range(4):\n        print(\"X=%s, Predicted=%s\" % (xtest[i], ytest[i]))\n        \n    return ytest","7354fbab":"\nmodel = createModel(X,y)\nprediction = fitPredict(model,X,y,Xtest)\n\n","aa70c3e7":"a= prediction[:,0]\nb = prediction[:,1]\n","9e296949":"my_submission = pd.DataFrame({ 'ID': testdataframe.ID,'A': a, 'B': b})\n# you could use any filename. We choose submission here\nmy_submission.to_csv('submission.csv', index=False)\nmy_submission.head()","e0cee3f3":"The below code is modified version of the  below link:\nhttps:\/\/machinelearningmastery.com\/regression-tutorial-keras-deep-learning-library-python\/\n[](https:\/\/machinelearningmastery.com\/regression-tutorial-keras-deep-learning-library-python\/\/)","3959ccc5":"Everything runs smoothly, but the problem is you can't see your file anywhere in this page, nor in your Profile, Kernels tab, nowhere! This is because you haven't commited your notebook yet. To do that, click the **Commit **button - as I write it, this is a light-blue button in the top-right corner of my notebook page, in the main pane. (There is also a right pane with Sessions, Versions etc. You can ignore it for now). It may take a minute for the Kaggle server to publish your notebook.\n\nWhen this operation is done, you can go back by clicking '<<' button in the top-left corner. Then you should see your notebook with **a menu  bar on the left**  that has a few tabs: Notebook, Code, Data, **Output**, Comments, Log ... Edit Notebook. Click the **Output** tab. You should see your output csv file there, ready to download! **R\u0130ght Upper corne**r you will see \"**Submit to competiton**\" button. Click it!"}}