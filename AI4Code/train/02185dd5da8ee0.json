{"cell_type":{"0edd7847":"code","1ad4609a":"code","85782acf":"code","22a14e6d":"code","1ddf7d84":"code","df8dfe2e":"code","4fbf1992":"code","91e9ae60":"code","e8a12607":"code","5244dd84":"code","834f634f":"code","63aa7ab2":"code","f101c5d4":"code","1c14545d":"code","cbb06e05":"code","90180e5a":"code","76f9e65d":"code","cd49f3ad":"code","c55082a0":"code","b2509c86":"code","0a479df7":"code","44512d91":"code","c6e4475e":"markdown","a6de2201":"markdown","d5dceab2":"markdown","54e5f0b9":"markdown","84f97486":"markdown","631441fa":"markdown","8e126cba":"markdown","bf452808":"markdown"},"source":{"0edd7847":"import warnings\nwarnings.filterwarnings('ignore')\n\nimport random\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport tensorflow as tf\nimport matplotlib.pyplot as plt\n\nfrom tqdm import tqdm\nfrom sklearn.model_selection import StratifiedKFold, KFold\nimport lightgbm as lgb\n\npd.set_option('display.max_colwidth',None)","1ad4609a":"train = pd.read_csv('..\/input\/petfinder-pawpularity-score\/train.csv')\ntest = pd.read_csv('..\/input\/petfinder-pawpularity-score\/test.csv')\nsample_submission = pd.read_csv('..\/input\/petfinder-pawpularity-score\/sample_submission.csv')","85782acf":"train.head(2)","22a14e6d":"test.head(2)","1ddf7d84":"sample_submission.head(2)","df8dfe2e":"print(train.shape, test.shape, sample_submission.shape)","4fbf1992":"models = []\ncolumns = [col for col in train.columns if col not in ['Id', 'Pawpularity']]\nX = train[columns]\ny = train['Pawpularity']","91e9ae60":"len(X)","e8a12607":"X_test = test[columns]\nX_test","5244dd84":"print(X.shape, y.shape, X_test.shape)","834f634f":"X = np.array(X)\nX_test = np.array(X_test)\ny = y.to_numpy()","63aa7ab2":"print(X.shape, y.shape, X_test.shape)","f101c5d4":"params = {'n_estimators': 2415,\n 'learning_rate': 0.011742909924093024,\n 'num_leaves': 737,\n 'max_depth': 11,\n 'feature_fraction': 0.9871498325775747,\n 'lambda_l1': 21.717215991758113,\n 'lambda_l2': 7.849282580359565e-05,\n 'boosting_type': 'gbdt',\n 'objective': 'regression',\n 'metric': {'rmse'}}","1c14545d":"folds = KFold(n_splits=5, shuffle=True, random_state=2021)\n\nfor fold_n, (train_index, valid_index) in tqdm(enumerate(folds.split(X, y))):\n    print(f'------------------ Fold {fold_n} ------------------')\n    X_train, X_valid =  X[train_index], X[valid_index]\n    y_train, y_valid = y[train_index], y[valid_index]\n\n    lgb_train = lgb.Dataset(X_train, y_train)\n    lgb_val = lgb.Dataset(X_valid, y_valid)\n    model = lgb.train(\n        params,\n        lgb_train,\n        num_boost_round=5000,\n        valid_sets=(lgb_train, lgb_val),\n        early_stopping_rounds=100,\n        verbose_eval=100\n    )\n    models.append(model)","cbb06e05":"prediction = []","90180e5a":"for model in models:\n    prediction.append(model.predict(test[columns]))","76f9e65d":"prediction","cd49f3ad":"mean = np.mean(prediction, axis=0)\nmed = np.median(prediction, axis=0)\nstd = np.std(prediction, axis=0)\n\n\n\n# mean of values inside the standard mean\nclipped_pres = np.clip(np.vstack(prediction), mean-std, mean+std)\nclipped_mean = np.mean(clipped_pres, axis=0)","c55082a0":"med","b2509c86":"mean","0a479df7":"submission = pd.DataFrame({'Id': sample_submission['Id'], 'Pawpularity': mean})\nsubmission","44512d91":"submission.to_csv(\"submission.csv\", index=False)","c6e4475e":"[**My EDA Kernel**](https:\/\/www.kaggle.com\/esratmaria\/petfinder-pawpularity-prediction-eda)","a6de2201":"# Exploratory Data Analysis","d5dceab2":"# Model Creation","54e5f0b9":"# Submission","84f97486":"# Prediction","631441fa":"# <div style=\"text-align:center; border: 2px solid #FFA500; border-radius: 25px\"><span style=\"color:purple\">Pawpularity Prediction<\/span><\/div>\nIn this competition, our goal is to predict the engaggement with a pet's profile based on the appearance of that profile. For example, what kind of pictures are likely to be attracted by someone. (including the pet's name, using props in the picture, using multiple pictures, using accessories etc.)\n\nWe are provide with metadata (data about data)\n- Image data\n- Tabular data\n\n\n*We want to predict the **Pawpularity score**. We can expect pets with attractive photos to generate more interest and be adopted faster.*\n ","8e126cba":"# Imports","bf452808":"loading the `csv` files:"}}