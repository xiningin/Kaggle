{"cell_type":{"1e9ab42c":"code","1ec9fb93":"code","e825ecf3":"code","95537f5c":"code","07ac8f21":"code","bdc8a73d":"code","ba367bff":"code","7123dae2":"code","68f19de0":"code","1f13d555":"code","b1d1aa78":"code","f11189dc":"code","fd4327a1":"code","aca1a45f":"code","d4d1c5d7":"code","f942df13":"code","d5b577bd":"code","b2b6ec89":"code","1b7d45d3":"code","848af1f9":"code","e18ff35b":"code","dbd0c012":"code","3c560889":"code","f8eece00":"code","c33d67d6":"code","6d22bcc0":"code","436f4119":"code","1430a2db":"code","2c8284a9":"code","0c689537":"code","9d405766":"code","127ddf84":"code","06e8bc83":"code","ffb6fdbd":"code","96147211":"code","18aa6069":"code","647a04c0":"code","c247eccc":"code","9457b2f0":"code","939dee0e":"code","feee9b95":"code","31874e5a":"code","62f58337":"code","44b8fb3d":"code","43f711a8":"code","08700d62":"code","ae5809f5":"code","e69bb878":"code","d25feaaa":"code","29476bc3":"code","5bf657c8":"code","de6c6fc8":"code","9b91f54e":"code","5dc3a68d":"code","b5270b6c":"code","e47d5f03":"code","c8ed586a":"code","e4a73b55":"code","502b8055":"code","a4bb99cf":"code","4beabc46":"code","bead423c":"code","f0599e60":"code","2d0ed5a6":"code","4d618da9":"code","b09c26d3":"code","779c32e5":"code","c29bdc99":"code","d90bcad7":"code","6637521b":"code","47702236":"code","b46ab4a1":"code","903e1dbd":"code","0401bd96":"code","1de24308":"code","5b3c410c":"code","a408276d":"code","42f278d8":"code","0d11ea9a":"code","fe6ee4eb":"code","3521e162":"code","d3a386ac":"code","2e74724a":"code","357732c0":"code","fc49e848":"code","ca612672":"code","1ad133c6":"code","930bc82f":"code","09e7c041":"code","53535d59":"code","a9f3361a":"code","e61668ba":"code","dcf7f0d6":"markdown","97b023c8":"markdown","da2db6d4":"markdown","d768f0dd":"markdown","c843bd08":"markdown","4cdd8f5e":"markdown","9fdf9ae8":"markdown","875a2803":"markdown","58cccaa5":"markdown","324e1570":"markdown","a09cc0ac":"markdown","482940ff":"markdown","0e220109":"markdown","834c4a31":"markdown","33047bb8":"markdown","b6cbc47d":"markdown","05df9fe6":"markdown","1de5e015":"markdown","6bdb3ff0":"markdown","272c2187":"markdown","0b659f9c":"markdown","b115ca7d":"markdown","e9b35024":"markdown","e35c27ba":"markdown","cd1d23b1":"markdown","c5a6719c":"markdown","85116f4e":"markdown","1ef50ad3":"markdown","aaee4095":"markdown","8ba3201e":"markdown","d26cf759":"markdown","2435810e":"markdown","93eb85a2":"markdown","fa7fad90":"markdown","f1d3f677":"markdown","6452114a":"markdown","2d42a4f0":"markdown","0db3ebf4":"markdown","def11264":"markdown","1b005574":"markdown","dda623d1":"markdown","fa5a46f0":"markdown","8ddedb68":"markdown","1baf4515":"markdown","0364816d":"markdown","327b556d":"markdown","ca26d7df":"markdown","f81840a3":"markdown","b2a2ed77":"markdown"},"source":{"1e9ab42c":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n# %matplotlib inline\nimport warnings\nwarnings.filterwarnings('ignore')\n\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import StandardScaler\n\nfrom sklearn.linear_model import LogisticRegression\n\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.svm import SVC\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.neighbors import KNeighborsClassifier\n\nfrom sklearn.preprocessing import StandardScaler, LabelEncoder, OneHotEncoder\nfrom sklearn.metrics import confusion_matrix, accuracy_score\nfrom sklearn.metrics import classification_report","1ec9fb93":"# use these links to do so:\ndf = pd.read_csv(\"\/kaggle\/input\/telco-customer-churn\/WA_Fn-UseC_-Telco-Customer-Churn.csv\")\ndf.head()","e825ecf3":"df.info()","95537f5c":"df.head(2).T","07ac8f21":"df['Churn'].value_counts()","bdc8a73d":"df.shape","ba367bff":"df.isnull().sum()","7123dae2":"plt.figure(figsize=(12,8))\nsns.histplot(x='MonthlyCharges',data=df,hue='Churn')","68f19de0":"sns.countplot(data=df,x='Churn',hue='Dependents')","1f13d555":"# sns.histplot(x='tenure',data=df)\nplt.figure(figsize=(12,8))\nsns.histplot(x='tenure',data=df,hue='Churn')","b1d1aa78":"sns.countplot(data=df,x='Churn',hue='PhoneService')","f11189dc":"df.head(2)","fd4327a1":"sns.countplot(x='InternetService',data=df,hue='Churn')","aca1a45f":"sns.countplot(x='MultipleLines',data=df,hue='Churn')","d4d1c5d7":"sns.countplot(x='Contract',data=df,hue='Churn')","f942df13":"sns.countplot(x=df['PaperlessBilling'],hue=df['Churn'])\nplt.show()","d5b577bd":"# plt.figure(figsize=(12,8))\n# sns.scatterplot(df['TotalCharges'])","b2b6ec89":"df[df['TotalCharges']==' ']","1b7d45d3":"# Filling blank Values\n# df.describe()['Mont']","848af1f9":"df.head(1).T","e18ff35b":"Gender_Category_map = {\n    'Male' : 1,\n    'Female': 0,\n}\n\nPartner_Category_map = {\n    'Yes' : 1,\n    'No': 0,\n}\nDependents_Category_map = {\n    'Yes' : 1,\n    'No': 0,\n}\nPhoneService_Category_map = {\n    'Yes' : 1,\n    'No': 0,\n}\n\nOnlineSecurity_Category_map = {\n    'Yes' : 1,\n    'No': 0,\n}\nOnlineBackup_Category_map = {\n    'Yes' : 1,\n    'No': 0,\n}\nDeviceProtection_Category_map = {\n    'Yes' : 1,\n    'No': 0,\n}\nTechSupport_Category_map = {\n    'Yes' : 1,\n    'No': 0,\n}\nStreamingTV_Category_map = {\n    'Yes' : 1,\n    'NO': 0,\n}\nStreamingMovies_Category_map = {\n    'Yes' : 1,\n    'No': 0,\n}\nPaperlessBilling_Category_map = {\n    'Yes' : 1,\n    'No': 0,\n}\nChurn_Category_map = {\n    'Yes' : 1,\n    'No': 0,\n}\n\n\n\ndf.loc[:, 'gender'] = df['gender'].map(Gender_Category_map)\ndf.loc[:, 'Partner'] = df['Partner'].map(Partner_Category_map)\ndf.loc[:, 'Dependents'] = df['Dependents'].map(Dependents_Category_map)\ndf.loc[:, 'PhoneService'] = df['PhoneService'].map(PhoneService_Category_map)\ndf.loc[:, 'OnlineSecurity'] = df['OnlineSecurity'].map(OnlineSecurity_Category_map)\ndf.loc[:, 'OnlineBackup'] = df['OnlineBackup'].map(OnlineBackup_Category_map)\ndf.loc[:, 'DeviceProtection'] = df['DeviceProtection'].map(DeviceProtection_Category_map)\ndf.loc[:, 'TechSupport'] = df['TechSupport'].map(TechSupport_Category_map)\ndf.loc[:, 'StreamingTV'] = df['StreamingTV'].map(StreamingTV_Category_map)\ndf.loc[:, 'StreamingMovies'] = df['StreamingMovies'].map(StreamingMovies_Category_map)\ndf.loc[:, 'PaperlessBilling'] = df['PaperlessBilling'].map(PaperlessBilling_Category_map)\ndf.loc[:, 'Churn'] = df['Churn'].map(Churn_Category_map)","dbd0c012":"df.head()","3c560889":"Contract=df['Contract']\nContract=pd.get_dummies(Contract,drop_first=True)\nMultipleLines=df['MultipleLines']\nMultipleLines=pd.get_dummies(MultipleLines,drop_first=True)\n\nInternetService=df['InternetService']\nInternetService=pd.get_dummies(InternetService,drop_first=True)\nPaymentMethod=df['PaymentMethod']\nPaymentMethod=pd.get_dummies(PaymentMethod,drop_first=True)","f8eece00":"df=df.drop(['Contract','MultipleLines','InternetService','PaymentMethod','StreamingTV'],axis=1)","c33d67d6":"df.head()","6d22bcc0":"df['TotalCharges']=pd.to_numeric(df['TotalCharges'], errors='coerce')","436f4119":"df.info()","1430a2db":"df['TotalCharges'].isnull().sum()","2c8284a9":"df['TotalCharges']= df['TotalCharges'].fillna(df['TotalCharges'].mean())","0c689537":"df.isnull().sum()","9d405766":"df.corr()['OnlineSecurity'].sort_values(ascending=False)","127ddf84":"plt.figure(figsize=(12,10))\nsns.histplot(x='tenure',data=df,hue='OnlineSecurity',bins=80)\n","06e8bc83":"plt.figure(figsize=(12,10))\nsns.histplot(x='TotalCharges',data=df,hue='OnlineSecurity')","ffb6fdbd":"df[(df['tenure']<20)&(df['TotalCharges']<4000)]['OnlineSecurity'].value_counts()","96147211":"df['OnlineSecurity']= df[(df['tenure']<20)&(df['TotalCharges']<4000)]['OnlineSecurity'].fillna(0)","18aa6069":"df.drop(['OnlineSecurity'],axis=1,inplace=True)","647a04c0":"df.corr()['OnlineBackup'].sort_values(ascending=False)","c247eccc":"plt.figure(figsize=(10,8))\nsns.histplot(x='TotalCharges',data=df, hue = 'OnlineBackup',bins=50)","9457b2f0":"df[df['TotalCharges']<4000]['OnlineBackup'].value_counts()","939dee0e":"df['OnlineBackup']= df['OnlineBackup'].fillna(0)","feee9b95":"df.corr()['DeviceProtection'].sort_values(ascending=False)","31874e5a":"plt.figure(figsize=(12,8))\nsns.histplot(x='TotalCharges',hue='DeviceProtection',data=df,bins=40)","62f58337":"df[df['TotalCharges']<4000]['DeviceProtection'].value_counts()","44b8fb3d":"df['DeviceProtection']= df['DeviceProtection'].fillna(0)","43f711a8":"df.corr()['TechSupport'].sort_values(ascending=False)","08700d62":"plt.figure(figsize=(12,8))\nsns.histplot(x='tenure',data=df,hue='TechSupport',bins=40)","ae5809f5":"df[df['tenure']>60]['TechSupport'].value_counts()","e69bb878":"plt.figure(figsize=(12,8))\nsns.histplot(x='TotalCharges',data=df,hue='TechSupport',bins=40)","d25feaaa":"df[df['TotalCharges']<4000]['TechSupport'].isnull().sum()","29476bc3":"df[df['TotalCharges']<4000]['TechSupport'].value_counts()","5bf657c8":"df['TechSupport']=df['TechSupport'].fillna(0)","de6c6fc8":"df.isnull().sum()","9b91f54e":"df=df.drop(['StreamingMovies'],axis=1)","5dc3a68d":"df.head(1).T","b5270b6c":"df['OnlineBackup']=df['OnlineBackup'].astype(int)\ndf['DeviceProtection']=df['DeviceProtection'].astype(float)\ndf['TechSupport']=df['TechSupport'].astype(float)\n","e47d5f03":"df.corr()['Churn'].sort_values(ascending=False)","c8ed586a":"plt.figure(figsize=(10,8))\nplt.title('Correlation with Churn')\ndf.corr()['Churn'].sort_values(ascending=False)[1:].plot(kind='bar')\nplt.show()","e4a73b55":"plt.figure(figsize=(14,8))\nplt.title('Heatmap')\nsns.heatmap(df.corr())\nplt.show()","502b8055":"df=df.drop(['gender','DeviceProtection','OnlineBackup','Partner'],axis=1)","a4bb99cf":"df.corr()['Churn']","4beabc46":"### Conclusion: What all did you understand from the above charts","bead423c":"df.columns","f0599e60":"from sklearn.model_selection import train_test_split","2d0ed5a6":"X=df.drop(['Churn','customerID'],axis=1)","4d618da9":"y=df['Churn']","b09c26d3":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42)","779c32e5":"X_train.shape,y_train.shape, X_test.shape, y_test.shape","c29bdc99":"lr=LogisticRegression()\nlr.fit(X_train,y_train)","d90bcad7":"predictions=lr.predict(X_test)","6637521b":"predictions[:5]","47702236":"y_test[:5]","b46ab4a1":"print(classification_report(y_test,predictions))","903e1dbd":"print(confusion_matrix(y_test,predictions))","0401bd96":"print(\"Model Acc:\",lr.score(X_test,y_test))","1de24308":"model = RandomForestClassifier()","5b3c410c":"model.fit(X_train,y_train)","a408276d":"pred_rfc=model.predict(X_test)","42f278d8":"print(classification_report(y_test,pred_rfc))","0d11ea9a":"print('model Accu:',model.score(X_test,y_test))","fe6ee4eb":"df['Churn'].value_counts()","3521e162":"df_class_1=df[df['Churn']==1]\ndf_class_0=df[df['Churn']==0]","d3a386ac":"df_class_1_over = df_class_1.sample(5174, replace=True)","2e74724a":"df_class_1_over.shape","357732c0":"df_test_over = pd.concat([df_class_0, df_class_1_over], axis=0)\n\nprint('Random over-sampling:')\nprint(df_test_over.Churn.value_counts())","fc49e848":"y = df_test_over['Churn']\nX=df_test_over.drop(['Churn','customerID'],axis=1)\nfrom sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=15, stratify=y)","ca612672":"model = RandomForestClassifier()\nmodel.fit(X_train, y_train)\npredictions=model.predict(X_test)","1ad133c6":"print(classification_report(y_test,predictions))","930bc82f":"print(confusion_matrix(y_test,predictions))","09e7c041":"sns.heatmap(confusion_matrix(y_test,predictions),annot=True)","53535d59":"X_test.head(1)","a9f3361a":"def model_predict(features):\n    prediction=model.predict(features)[0]\n    if prediction == 1:\n        return 'Yes'\n    else:\n        return 'No'\n\nmodel_predict([[0,0,10,1,0,1,80.7,788.8]])","e61668ba":"df.corr()['Churn']","dcf7f0d6":"From the results conclusion can be draw:\n\n1.The type of MonthlyCharges and PaperlessBilling has a strict relationship with churned clients, More number of monthly charges could lead a client to leave the service.\n\n2.For the predictions made by the model and based on the precision and recall scores, as F1 Score try to show a balance between these two metrics, the precision was near 90%, what means that the model predict correctly 90% of classified clients as churned, on other hand, the recall was good, where around 80% of the actually churned clients was predict correctly.\n","97b023c8":"Model Evaluation on Test data","da2db6d4":"Spliting data into training and testing set","d768f0dd":"#### 4.DeviceProtection","c843bd08":"#### 3.PhoneService        ","4cdd8f5e":"#### Now deal with Categorical Variables","9fdf9ae8":"#### Total Charges have some Blank Values","875a2803":"##### How much affect MonthlyCharges on Churn","58cccaa5":"### Filling missing Values","324e1570":"### Model Evaluation","a09cc0ac":"##### 6.Contract","482940ff":"#### 2.Tenure","0e220109":"### Data Manipulation","834c4a31":"##### Handle Imbalanced Data","33047bb8":"mostly OnlineBackup values are between 4000-8000 is 1   ","b6cbc47d":"Important:Churn prediction is analytical studies on the possibility of a customer abandoning a product or service. The goal is to understand and take steps to change it before the costumer gives up the product or service.\n\n- The Sheet is structured in **4 steps**:\n    1. Understanding data and manipulation\n    2. Data visualization\n    3. Implementing Machine Learning models(Note: It should be more than 1 algorithm)\n    4. Model Evaluation and concluding with the best of the model.\n    \n    \n    \n\n- Try to break the codes in the **simplest form** and use number of code block with **proper comments** to them\n- We are providing **h** different dataset to choose from(Note: You need to select any one of the dataset from this sample sheet only)\n- The **interview calls** will be made solely based on how good you apply the **concepts**.\n- Good Luck! Happy Coding!","05df9fe6":"### Data Visualization","1de5e015":"#### 2.OnlineSecurity","6bdb3ff0":"#### Correlations with Churn","272c2187":"#### Method Used:- Over Sampling","0b659f9c":"### Final Conclusions","b115ca7d":"### Understanding the data","e9b35024":"#### Any Missing Values","e35c27ba":"### Importing the data","cd1d23b1":"#### 4.OnlineBackup        ","c5a6719c":"#### Predictions","85116f4e":"### Feature Engineering","1ef50ad3":"##### 1.Logistic Regression","aaee4095":"We are removing 'OnlineSequrity' column because it has more null values","8ba3201e":"Columns \"gender,DeviceProtection,OnlineBackup and Partner\" doesn't make any sense so drop it ","d26cf759":"### Implement Machine Learning Models","2435810e":"#### 4.InternetService","93eb85a2":"'StreamingMovies' is not much important so drop it..     ","fa7fad90":"##### 7.PaperlessBilling","f1d3f677":"#### Train Test Split","6452114a":"##### Note:-Our Data is imbalanced so accuracy is Decreases","2d42a4f0":"#### Heatmap","0db3ebf4":"Similarly all null values are between 0-4000 of TotalCharges","def11264":"Conclusion:-Monthly charges and Papaerless are positively Correlated with Target(Churn) and tenure and TotalCharges are more negatively affect on Target Variable , and all Nan Values are between 0-4000 of TotalCharges","1b005574":"#### Model Building","dda623d1":"#### 5.TechSupport","fa5a46f0":"#### Thank You----@Tushar Patil","8ddedb68":"spliting data into training and testing set","1baf4515":"##### 2.RandomForestClassifier","0364816d":"#### 5.MultipleLines","327b556d":"All Nan Values are between Total Charges 0 to 4000 ","ca26d7df":"#### 1.How much affect 'denpendets' on target","f81840a3":"Model Evaluations on Testing Set","b2a2ed77":"#### 1.Total Charges"}}