{"cell_type":{"0ee09b03":"code","ac9c4ef2":"code","a6216d22":"code","da7e52ed":"code","e8c33e35":"code","a3a24af8":"code","7bfe04e8":"code","49c1023e":"code","d7cc081b":"code","992af9c6":"code","cf150a69":"code","a4034538":"code","4540934e":"code","97076df0":"code","1e52261d":"code","84c8b195":"code","191bceed":"code","0a5be105":"code","f332dc76":"code","71d697b2":"code","d507b1f1":"code","b15805d6":"code","856b2eaa":"code","25b6272c":"code","b02fc0c2":"code","a74a9f67":"code","9df349d0":"code","c1d415a0":"code","11bb94e6":"code","f4aa8fca":"code","bb3c15fe":"code","954840bf":"code","0759070c":"code","b2d195d1":"code","8f615ab1":"code","662fbe69":"code","368ac317":"code","de2d53eb":"code","01d07201":"code","570ac455":"code","735d1c07":"code","bb25ec5b":"code","ff258f14":"code","02ef6d33":"code","fb605107":"code","d3a09c04":"code","5f2282ff":"code","f33eef8e":"code","2d023ba2":"code","ca0a58aa":"code","4a26a422":"code","0f56a695":"code","c8d291dc":"code","4b2fef86":"code","128db1bb":"code","57b24951":"code","8fb44750":"code","dea1f534":"code","ce22df3d":"code","413237ae":"code","e1aa7cdb":"code","b3838829":"code","e9d51229":"code","0cf83c7f":"code","db150cd6":"code","5a41dcdc":"code","e6d8f45b":"code","820ed60a":"code","1df98323":"code","d336eef1":"code","2d1624e0":"code","93f99770":"code","2f3ea365":"markdown","2be1c88b":"markdown","e889dd7e":"markdown","79e5e536":"markdown","e5f3d20f":"markdown","eee7f2e5":"markdown","dcd7e835":"markdown","e61c1d9b":"markdown","e529617c":"markdown","88319625":"markdown","ba3ca8ac":"markdown","e10d78c4":"markdown","ed165653":"markdown","bfe0636c":"markdown","e551ffed":"markdown","ff4fbcac":"markdown","123fad26":"markdown","6557bc15":"markdown","d9480a10":"markdown","fb8b6c06":"markdown","895406d9":"markdown","72b2835a":"markdown","e8f1d529":"markdown","24f50554":"markdown","87ed989f":"markdown","cdd1cc73":"markdown","81318ff3":"markdown","2dff3ba3":"markdown","16d28fde":"markdown","973faf67":"markdown","ab375c35":"markdown","65519367":"markdown","4acc7ae1":"markdown","327a1754":"markdown","5c77b3fc":"markdown","a4290535":"markdown","c41ed7b6":"markdown","81c90fd0":"markdown","e7e0983b":"markdown","072425d0":"markdown","4df6fc82":"markdown","13b53121":"markdown"},"source":{"0ee09b03":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport warnings\nwarnings.filterwarnings('ignore')","ac9c4ef2":"train = pd.read_csv(\"..\/input\/song-popularity-prediction\/train.csv\")\ntest = pd.read_csv(\"..\/input\/song-popularity-prediction\/test.csv\")\nsubmission = pd.read_csv(\"..\/input\/song-popularity-prediction\/sample_submission.csv\")","a6216d22":"train.head()","da7e52ed":"train.shape","e8c33e35":"train.info()","a3a24af8":"train.describe()","7bfe04e8":"test.head()","49c1023e":"test.shape","d7cc081b":"test.info()","992af9c6":"test.describe()","cf150a69":"train.columns","a4034538":"train.drop(['id'],axis = 1, inplace = True)","4540934e":"test.drop(['id'], axis=1, inplace=True)","97076df0":"train.columns","1e52261d":"test.columns","84c8b195":"sns.distplot(train[\"song_duration_ms\"])\nplt.axvline(x=train[\"song_duration_ms\"].mean(), color = \"red\")\nplt.axvline(x=train[\"song_duration_ms\"].median(), color = \"black\")\nprint(\"Mean is : \" + str(train[\"song_duration_ms\"].mean()))\nprint(\"Median is : \" + str(train[\"song_duration_ms\"].median()))","191bceed":"sns.distplot(train[\"acousticness\"])\nplt.axvline(x=train[\"acousticness\"].mean(), color = \"red\")\nplt.axvline(x=train[\"acousticness\"].median(), color = \"black\")\nprint(\"Mean is : \" + str(train[\"acousticness\"].mean()))\nprint(\"Median is : \" + str(train[\"acousticness\"].median()))","0a5be105":"train.columns","f332dc76":"sns.distplot(train[\"danceability\"])\nplt.axvline(x=train[\"danceability\"].mean(), color = \"red\")\nplt.axvline(x=train[\"danceability\"].median(), color = \"black\")\nprint(\"Mean is : \" + str(train[\"danceability\"].mean()))\nprint(\"Median is : \" + str(train[\"danceability\"].median()))","71d697b2":"train.columns","d507b1f1":"sns.distplot(train[\"energy\"])\nplt.axvline(x=train[\"energy\"].mean(), color = \"red\")\nplt.axvline(x=train[\"energy\"].median(), color = \"black\")\nprint(\"Mean is : \" + str(train[\"energy\"].mean()))\nprint(\"Median is : \" + str(train[\"energy\"].median()))","b15805d6":"train.columns","856b2eaa":"sns.distplot(train[\"instrumentalness\"])\nplt.axvline(x=train[\"instrumentalness\"].mean(), color = \"red\")\nplt.axvline(x=train[\"instrumentalness\"].median(), color = \"black\")\nprint(\"Mean is : \" + str(train[\"instrumentalness\"].mean()))\nprint(\"Median is : \" + str(train[\"instrumentalness\"].median()))","25b6272c":"train.columns","b02fc0c2":"sns.distplot(train[\"liveness\"])\nplt.axvline(x=train[\"liveness\"].mean(), color = \"red\")\nplt.axvline(x=train[\"liveness\"].median(), color = \"black\")\nprint(\"Mean is : \" + str(train[\"liveness\"].mean()))\nprint(\"Median is : \" + str(train[\"liveness\"].median()))","a74a9f67":"train.columns","9df349d0":"sns.distplot(train[\"loudness\"])\nplt.axvline(x=train[\"loudness\"].mean(), color = \"red\")\nplt.axvline(x=train[\"loudness\"].median(), color = \"black\")\nprint(\"Mean is : \" + str(train[\"loudness\"].mean()))\nprint(\"Median is : \" + str(train[\"loudness\"].median()))","c1d415a0":"train.columns","11bb94e6":"sns.distplot(train[\"speechiness\"])\nplt.axvline(x=train[\"speechiness\"].mean(), color = \"red\")\nplt.axvline(x=train[\"speechiness\"].median(), color = \"black\")\nprint(\"Mean is : \" + str(train[\"speechiness\"].mean()))\nprint(\"Median is : \" + str(train[\"speechiness\"].median()))","f4aa8fca":"train.columns","bb3c15fe":"sns.distplot(train[\"tempo\"])\nplt.axvline(x=train[\"tempo\"].mean(), color = \"red\")\nplt.axvline(x=train[\"tempo\"].median(), color = \"black\")\nprint(\"Mean is : \" + str(train[\"tempo\"].mean()))\nprint(\"Median is : \" + str(train[\"tempo\"].median()))","954840bf":"sns.distplot(train[\"audio_valence\"])\nplt.axvline(x=train[\"audio_valence\"].mean(), color = \"red\")\nplt.axvline(x=train[\"audio_valence\"].median(), color = \"black\")\nprint(\"Mean is : \" + str(train[\"audio_valence\"].mean()))\nprint(\"Median is : \" + str(train[\"audio_valence\"].median()))","0759070c":"train.columns","b2d195d1":"train.head()","8f615ab1":"sns.countplot(train[\"key\"])","662fbe69":"sns.countplot(train[\"time_signature\"])","368ac317":"sns.countplot(train[\"audio_mode\"])","de2d53eb":"sns.countplot(train[\"song_popularity\"])\nprint(train[\"song_popularity\"].value_counts())","01d07201":"(train[\"song_popularity\"].value_counts()\/ train.shape[0])*100","570ac455":"corr = train.corr()\ncorr","735d1c07":"plt.figure(figsize = (15,7))\nsns.heatmap(corr, annot=True)","bb25ec5b":"plt.scatter(train[\"energy\"], train[\"loudness\"])","ff258f14":"plt.scatter(train[\"energy\"], train[\"acousticness\"])","02ef6d33":"plt.scatter(train[\"loudness\"], train[\"acousticness\"])","fb605107":"corr[\"song_popularity\"].sort_values(ascending=False)","d3a09c04":"train.isnull().sum()","5f2282ff":"(train.isnull().sum()\/train.shape[0])*100","f33eef8e":"test.isnull().sum()","2d023ba2":"(test.isnull().sum()\/test.shape[0])*100","ca0a58aa":"train.head()","4a26a422":"train.info()","0f56a695":"numerical_cols = [\"song_duration_ms\", \"acousticness\", \"energy\", \"danceability\", \n                  \"instrumentalness\", \"liveness\", \"loudness\",\n                  \"speechiness\",  \"tempo\", \"audio_valence\"]\n\ncat_cols = [\"audio_mode\", \"key\",\"time_signature\"]","c8d291dc":"train.columns","4b2fef86":"train_target = train[\"song_popularity\"]\ntrain_data = train.drop([\"song_popularity\"], axis=1)","128db1bb":"train_target","57b24951":"train_data.head()","8fb44750":"from sklearn.preprocessing import StandardScaler\nfrom sklearn.impute import SimpleImputer\nfrom sklearn.impute import KNNImputer\n\nx_val = train_data[:10000]\nx_train = train_data[10000:]\ny_val = train_target[:10000]\ny_train = train_target[10000:]","dea1f534":"x_val.head()","ce22df3d":"x_val.shape","413237ae":"x_train.shape","e1aa7cdb":"test.head()","b3838829":"sc = StandardScaler()\nx_train[numerical_cols] = sc.fit_transform(x_train[numerical_cols])\nx_val[numerical_cols] = sc.transform(x_val[numerical_cols])\ntest[numerical_cols] = sc.transform(test[numerical_cols])","e9d51229":"x_train","0cf83c7f":"x_train.describe()","db150cd6":"columns = [\"song_duration_ms\", \"danceability\", \"energy\"]\nsimple_imputer = SimpleImputer(strategy = \"mean\")\nx_train[columns] = simple_imputer.fit_transform(x_train[columns])\nx_val[columns] = simple_imputer.transform(x_val[columns])\ntest[columns] = simple_imputer.transform(test[columns])","5a41dcdc":"x_train.isnull().sum()","e6d8f45b":"x_val.isnull().sum()","820ed60a":"new = [\"acousticness\", \"instrumentalness\", \"liveness\", \"loudness\"]\nknn_imputer = KNNImputer()\nx_train[new] = knn_imputer.fit_transform(x_train[new])\nx_val[new] = knn_imputer.transform(x_val[new])\ntest[new] = knn_imputer.transform(test[new])","1df98323":"x_train.isnull().sum()","d336eef1":"x_val.isnull().sum()","2d1624e0":"key = [\"key\"]\nsimple_imputer = SimpleImputer(strategy = \"mean\")\nx_train[key] = simple_imputer.fit_transform(x_train[key])\nx_val[key] = simple_imputer.transform(x_val[key])\ntest[key] = simple_imputer.transform(test[key])","93f99770":"x_train.isnull().sum()","2f3ea365":"Observation:\n\nWe can see that there are many columns which have null values and the columns are as follows:\n\n* song_duration_ms\n* acousticness\n* danceability\n* energy\n* instrumentalness\n* key\n* liveness\n* loudness","2be1c88b":"Observation:\n\nThere are NaN values present in the test data as well.","e889dd7e":"<a id=\"3\"><\/a>\n# **Exploratory Data Analysis**","79e5e536":"# **Modelling**","e5f3d20f":"**In the next notebook, I will share the missing value treatment and model stratigies.**\n\n**If you find my work helpful, please upvote!**\n\nThank You!","eee7f2e5":"There are 15 columns shown above.\n\n1. id : Just a random id number\n2. song_duration_ms : Time duration for the song\n3. acousticness : This value describes how acoustic a song is. A score of 1.0 means the song is most likely to be an acoustic one . eg : string instrumentations\n4. danceability: \u201cDanceability describes how suitable a track is for dancing based on a combination of musical elements including tempo, rhythm stability, beat strength, and overall regularity. A value of 0.0 is least danceable and 1.0 is most danceable\u201d.\n5. energy : \u201c(energy) represents a perceptual measure of intensity and activity. Typically, energetic tracks feel fast, loud, and noisy\u201d.\n6. instrumentalness: This value represents the amount of vocals in the song. The closer it is to 1.0, the more instrumental the song is.\n7. key: The estimated overall key of the track. Integers map to pitches using standard Pitch Class notation . E.g. 0 = C, 1 = C\u266f\/D\u266d, 2 = D, and so on.\n8. liveness: This value describes the probability that the song was recorded with a live audience. According to the official documentation \u201ca value above 0.8 provides strong likelihood that the track is live\u201d.\n9. loudness: The overall loudness of a track in decibels (dB). Loudness values are averaged across the entire track and are useful for comparing relative loudness of tracks.\n10. audio_mode: Indicates the modality (major or minor) of a track, the type of scale from which its melodic content is derived. Major is represented by 1 and minor is 0.\n11. speechiness: \u201cSpeechiness detects the presence of spoken words in a track\u201d. If the speechiness of a song is above 0.66, it is probably made of spoken words, a score between 0.33 and 0.66 is a song that may contain both music and words, and a score below 0.33 means the song does not have any speech.\n12. tempo: The overall estimated tempo of a track in beats per minute (BPM). In musical terminology, tempo is the speed or pace of a given piece, and derives directly from the average beat duration.\n13. time_signature: An estimated overall time signature of a track. The time signature (meter) is a notational convention to specify how many beats are in each bar (or measure).\n14. audio_valence: Describes the musical positiveness conveyed by a track. Tracks with high valence sound more positive (e.g. happy, cheerful, euphoric), while tracks with low valence sound more negative (e.g. sad, depressed, angry).\n15. song_popularity : 1 if the song is popular else 0","dcd7e835":"Observation:\n\nThere are 0 (minor) audio mode in majority.","e61c1d9b":"Observation:\n\nThere are more number of 0s i.e not popular songs are in majority.","e529617c":"Observations:\n\n* We can see a positive correlation between energy and loudness.\n* There are negative correlations between loudness and acousticness, energy and acousticness.","88319625":"We can see that there are 40k rows and 14 columns (omitting the target variable).","ba3ca8ac":"Observations:\n\nThe mean and median are almost same to each other, hence we can say that audio_valene follows the normal distribution.\n\nThe values are ranging from 0 to 1.","e10d78c4":"Id is a not relevant column, so we can drop it from both train and test set.","ed165653":"<a id=\"1\"><\/a>\n# **Importing Libraries**","bfe0636c":"Observation:\n\nAlmost 10% values are missing in all the columns mentioned above.","e551ffed":"Observation:\n\nThe most positively related variables with song_popularity are :\n* acousticness\n* speechiness\n\nThe most negatively related variables with song_popularity are :\n* energy\n* audio_valence","ff4fbcac":"Observation:\n\nOh, Yeah! We can see that there is a positive correlation (64%) between the two. ","123fad26":"Observations:\n\nWe know that if the median is greater than the mean, the distribution is negatively skewed. Hence loudness is left skewed.\n\nThe values are ranging from -35 to 0.","6557bc15":"Observations:\n\nThere are maximum 0 keys present, followed by 6,10 and 2.","d9480a10":"Observation:\n\nThis shows the basic statistics like count, mean , standard deviation, median etc.","fb8b6c06":"Observations:\n\nWe know that if the mean is greater than the median, the distribution is positively skewed.\n\nThe values are ranging from 0 to 1.","895406d9":"Observations: \n\nWe know that if median is greater than mean then the distribution is negatively skewed and here the tail is more towards the left, so we can say that danceability is left skewed.\n\nThe values are ranging from 0 to 1.0","72b2835a":"Observations: \n\nWe know that if median is greater than mean then the distribution is negatively skewed and here the tail is more towards the left, so we can say that energy is left skewed.\n\nThe values are ranging from 0 to 1.0","e8f1d529":"Observations: \n\nWe know that if mean is greater than median then the distribution is positively skewed and here the tail is more towards the right, so we can say that acousticness is right skewed.\n\nThe values are ranging from 0 to 1.2","24f50554":"Let's see which variables are more closely related to our target variable.","87ed989f":"<a id=\"4\"><\/a>\n# **Missing Values**","cdd1cc73":"# Table of Contents\n<a id=\"toc\"><\/a>\n- [1. Importing Libraries](#1)\n- [2. Importing Dataset](#2)\n- [3. Exploratory Data Analysis](#3)\n- [4. Missing Values](#4)","81318ff3":"**Correlation**","2dff3ba3":"Observation:\n\nThere are maximum 3 time_signature, followed by 4.","16d28fde":"Observation:\n\nThere is around 64% 0s and 36% 1s present in the song popularity column, which is not much imbalanced, hence we do not need to care about it.","973faf67":"We can see that there are 40k rows and 15 columns.","ab375c35":"<a id=\"2\"><\/a>\n# **Importing Dataset**","65519367":"Observation:\n\nOh, Yeah! We can see that there is a negative correlation (53%) between the two. ","4acc7ae1":"Observation:\n\nThis shows the basic statistics like count, mean , standard deviation, median etc.","327a1754":"Observation:\n\nOh, Yeah! We can see that there is a negative correlation (57%) between the two. ","5c77b3fc":"Observations:\n\nWe know that if the mean is greater than the median, the distribution is positively skewed. Hence liveness is right skewed.\n\nThe values are ranging from 0 to 1.","a4290535":"Hi All! In this notebook I have shared some EDA practices, finding missing values and patterns in the data.","c41ed7b6":"Observation:\n\nThe mean and median are nearly same, so we can say that tempo follows the normal distribution.\n\nThe values are ranging from 50 to 225.","81c90fd0":"Observations: \n\nWe know that if the mean is greater than the median then the distribution is positively skewed. Hence we can say that speechiness is right skewed.\n\nThe values are ranging from 0 to 0.6.","e7e0983b":"Observations: \n\n* The top 5 rows are displayed above. We can see some NaN values also.\n\n* There are 10 numerical variables (song_duration_ms, acousticness, danceability, energy, instrumentalness, liveness, loudness, speechiness, tempo, audio_valence), 3 categorical varaibles (key, audio_mode, time_signature) and 1 target variable (song_popularity). \n\n* Audio_mode and song_popularity are binary variables.\n\n","072425d0":"Observation:\n\nWe can see that there are many columns which have null values and the columns are as follows:\n\n* song_duration_ms\n* acousticness\n* danceability\n* energy\n* instrumentalness\n* key\n* liveness\n* loudness","4df6fc82":"Observation:\n\nAlmost 10% values are missing in all the columns mentioned above.","13b53121":"Observations:\n\nAs we can see that mean and median are nearly same and the shape of the distriubtion is also bell shaped, so we can say that it song_duration_ms follows normal distribution.\n\nThe values are ranging from 0 to 50k."}}