{"cell_type":{"10d1e48a":"code","3f272738":"code","88a72ee7":"code","c5e93410":"code","a3b374da":"code","b512dca9":"code","f1d0086b":"code","6a727558":"code","a5ee3df4":"code","96569950":"code","b9e66192":"code","f83219c7":"code","42a75659":"code","ba2d9c9e":"code","b39ca752":"code","3fdd5b41":"code","4cafa560":"code","c8b9b74f":"code","566949aa":"code","c7416ae3":"code","5f19c3e9":"code","8832c185":"code","fe937b8a":"code","e83f5d97":"code","23f32438":"code","c1e71144":"code","5d9df8a7":"code","127118aa":"code","33fdb507":"code","46162ed4":"code","50eb2068":"code","4cf6a72f":"code","7e7e1281":"code","fcde67f0":"code","3c105260":"code","eb28ba3d":"code","bc494f85":"code","608c2082":"code","0360c4d3":"code","94e8b7f4":"markdown","a183f891":"markdown","4b0d887f":"markdown","4809734b":"markdown","bffa366e":"markdown","97de814d":"markdown","3dab27fa":"markdown"},"source":{"10d1e48a":"import pandas as pd\ndf = pd.read_csv('..\/input\/coronahack-chest-xraydataset\/Chest_xray_Corona_Metadata.csv',\n                index_col=0)","3f272738":"df.head()","88a72ee7":"df.shape","c5e93410":"df['Label'].unique()","a3b374da":"df[df['Label'] == 'Pnemonia']","b512dca9":"df[df['Label'] == 'Normal']","f1d0086b":"df[df['X_ray_image_name'] == 'IM-0675-0001.jpeg']","6a727558":"df.shape","a5ee3df4":"import os    #Python Library to access files within a directory\nos.listdir('..\/input\/coronahack-chest-xraydataset\/Coronahack-Chest-XRay-Dataset\/Coronahack-Chest-XRay-Dataset\/train')","96569950":"len(os.listdir('..\/input\/coronahack-chest-xraydataset\/Coronahack-Chest-XRay-Dataset\/Coronahack-Chest-XRay-Dataset\/train'))","b9e66192":"from keras.preprocessing.image import load_img,array_to_img","f83219c7":"load_img('..\/input\/coronahack-chest-xraydataset\/Coronahack-Chest-XRay-Dataset\/Coronahack-Chest-XRay-Dataset\/train\/person1590_bacteria_4175.jpeg')","42a75659":"loc = '..\/input\/coronahack-chest-xraydataset\/Coronahack-Chest-XRay-Dataset\/Coronahack-Chest-XRay-Dataset\/train'\nprint(loc)","ba2d9c9e":"os.listdir(loc)","b39ca752":"k1 = 'person1180_virus_2010.jpeg'\nk2 = 'person588_bacteria_2422.jpeg'\n\nk3 = 'NORMAL2-IM-1169-0001.jpeg'\nk4 = 'IM-0421-0001.jpeg'\n\nprint(k1.split('_'))\nprint(k2.split('_'))\nprint(k3.split('_'))\nprint(k4.split('_'))","3fdd5b41":"print(len(k1.split('_')) > 1)\nprint(len(k2.split('_')) > 1)\nprint(len(k3.split('_')) > 1)\nprint(len(k4.split('_')) > 1)","4cafa560":"labels = []\nfor names in os.listdir(loc):\n    if len(names.split('_')) > 1:\n        labels.append(1)\n    else:\n        labels.append(0)","c8b9b74f":"import numpy as np\nY = np.array(labels)","566949aa":"#openCV - for image preprocessing and creating feature matrix\nimport cv2\nim = cv2.imread('..\/input\/coronahack-chest-xraydataset\/Coronahack-Chest-XRay-Dataset\/Coronahack-Chest-XRay-Dataset\/train\/person1590_bacteria_4175.jpeg',0)\nimr = cv2.resize(im,(70,70))","c7416ae3":"imr","5f19c3e9":"imr.shape","8832c185":"import matplotlib.pyplot as plt\nplt.imshow(imr)\nplt.show()","fe937b8a":"array_to_img(imr.reshape(70,70,1))","e83f5d97":"loc = '..\/input\/coronahack-chest-xraydataset\/Coronahack-Chest-XRay-Dataset\/Coronahack-Chest-XRay-Dataset\/train\/'\nfeatures = []\nfrom tqdm import tqdm\n\nfor image in tqdm(os.listdir(loc)):\n    f = cv2.imread(os.path.join(loc,image),0)\n    fr = cv2.resize(f,(70,70))\n    features.append(fr)","23f32438":"X = np.array(features)\nX.shape","c1e71144":"ft = X.reshape(5309,4900)\nlb = Y.reshape(5309,1)","5d9df8a7":"import pandas as pd\nft = pd.DataFrame(ft)\nlb = pd.DataFrame(lb)\nlb.columns = ['Label']","127118aa":"coronahack = pd.concat((lb,ft),axis=1)\ncoronahack.to_csv('coranahack.csv')","33fdb507":"from sklearn.model_selection import train_test_split\nxtrain,xtest,ytrain,ytest = train_test_split(X,Y)","46162ed4":"xtrain = xtrain.reshape(3981,4900)\nxtest = xtest.reshape(1328,4900)","50eb2068":"print(xtest.shape)","4cf6a72f":"from keras import models\nfrom keras import layers\nfrom keras import regularizers\nfrom keras.utils import np_utils","7e7e1281":"#normalize your features\nxtrain = xtrain\/xtrain.max()\nxtest = xtest\/xtest.max()","fcde67f0":"xtrain.shape[1]","3c105260":"#One hot encoding of labels\nytrain = np_utils.to_categorical(ytrain)\nytest = np_utils.to_categorical(ytest)","eb28ba3d":"wd = 1e-4\nmodel = models.Sequential()\n\nmodel.add(layers.Dense(512 , activation='relu' , kernel_regularizer = regularizers.l2(wd) , input_dim=xtrain.shape[1]))\nmodel.add(layers.Dropout(0.3))\n\nmodel.add(layers.Dense(256 , activation='relu' , kernel_regularizer = regularizers.l2(wd)))\nmodel.add(layers.Dropout(0.2))\n\nmodel.add(layers.Dense(128 , activation='relu' , kernel_regularizer = regularizers.l2(wd)))\nmodel.add(layers.Dropout(0.2))\n\nmodel.add(layers.Dense(2 , activation='sigmoid'))","bc494f85":"model.summary()","608c2082":"from keras import optimizers,metrics\n\nmodel.compile(optimizer='sgd',\n             loss = 'categorical_crossentropy',\n             metrics = ['Accuracy'])","0360c4d3":"model.fit(xtrain,ytrain,\n          epochs=15,\n          validation_data=(xtest,ytest))","94e8b7f4":"**Create your neural network model**","a183f891":"**Train Your model**","4b0d887f":"****Creating Label matrix using name of images given****","4809734b":"**Create training and validation sets**","bffa366e":"**Compile Your model**","97de814d":"**Create the feature matrix using the image given**","3dab27fa":"**Create Data Frame of extracted Images**"}}