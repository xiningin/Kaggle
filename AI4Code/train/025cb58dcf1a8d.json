{"cell_type":{"08a29bae":"code","923a829f":"code","21914d04":"code","60a48dc4":"code","70beb0d5":"code","56193920":"code","d5f25f76":"code","75ba99e7":"code","6d183abc":"code","3a149216":"code","592bbce9":"code","a1811dc4":"code","97d809c8":"code","b1ee9a44":"code","4e0ff888":"code","6d51cb63":"code","f93cdd08":"code","17ce0dcb":"code","cd7a41bf":"code","b983f227":"code","7d6452ba":"code","d799ce9a":"code","999dda61":"code","d29a365a":"markdown","c4a7bc8c":"markdown","ed596699":"markdown","42023365":"markdown","9a761b71":"markdown","0a7e62da":"markdown","db782bff":"markdown","b659b00d":"markdown","aff7d07e":"markdown","d9595bc4":"markdown","2482da0b":"markdown","19276c7b":"markdown","bafe7f56":"markdown","34561626":"markdown","031ae6cb":"markdown","9fdc0e21":"markdown","0749d22d":"markdown","4f71ef7c":"markdown","0ee793a4":"markdown","b9240b6f":"markdown","8634c983":"markdown","16874927":"markdown","a935138e":"markdown","04c04983":"markdown","1f5264b0":"markdown","19bc8ed0":"markdown","fd4b00a7":"markdown","1422ae93":"markdown","7b4dd9a9":"markdown","58b37337":"markdown","2e83f9be":"markdown","78ec5d08":"markdown","27803594":"markdown","762b3a29":"markdown","c602bac9":"markdown","56c4b90b":"markdown","b744d0b6":"markdown","48c7a27f":"markdown","4201a736":"markdown","d4dd6a31":"markdown","6f58e3fd":"markdown","e5e24a66":"markdown","812b1c89":"markdown"},"source":{"08a29bae":"import pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport numpy as np\nimport scipy\nimport math\nfrom sklearn import preprocessing\nfrom matplotlib.mlab import PCA as mlabPCA\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.preprocessing import scale\nfrom sklearn.decomposition import PCA\nimport warnings\nfrom scipy.stats.mstats import winsorize\nwarnings.filterwarnings('ignore')\n","923a829f":"df = pd.read_csv('..\/input\/heart.csv')\ndf.head()","21914d04":"df.info()","60a48dc4":"df.isna().sum()","70beb0d5":"plt.figure(figsize = (14,20))\nplt.subplots_adjust(hspace = 0.5)\nplt.subplot(621)\nplt.boxplot(df.age)\nplt.title('Age')\nplt.subplot(622)\nplt.boxplot(winsorize(df.age))\nplt.title('Winsorized Age')\nplt.subplot(623)\nplt.boxplot(df.trestbps)\nplt.title('Resting blood pressure(trestbps)')\nplt.subplot(624)\nplt.boxplot(winsorize(df.trestbps, 0.03))\nplt.title('Winsorized Resting blood pressure')\nplt.subplot(625)\nplt.boxplot(df.chol)\nplt.title('Cholosterol(chol)')\nplt.subplot(626)\nplt.boxplot(winsorize(df.chol,0.017))\nplt.title('Winsorized Cholosterol')\nplt.subplot(627)\nplt.boxplot(df.thalach)\nplt.title('Max heart rate achieved(thalach)')\nplt.subplot(628)\nplt.boxplot(winsorize(df.thalach, 0.004, axis = -1))\nplt.title('Winsorized max heart rate achieved')\nplt.subplot(629)\nplt.boxplot(df.oldpeak)\nplt.title('Old peak')\nplt.subplot(6,2,10)\nplt.boxplot(winsorize(df.oldpeak, 0.018))\nplt.title('Winsorized old peak')\nplt.show()","56193920":"df.trestbps = winsorize(df.trestbps, 0.03)\ndf.chol = winsorize(df.chol,0.017)\ndf.thalach = winsorize(df.thalach, 0.004, axis = -1)\ndf.oldpeak = winsorize(df.oldpeak, 0.018)","d5f25f76":"df.describe()","75ba99e7":"plt.figure(figsize = (6,5))\nx = ['no', 'yes']\ny = df['target'].value_counts(sort = False).values\nplt.bar(x,y)\nplt.title('Distribution of People by Heart Disease \\n', size = 15)\nplt.ylabel('Number of People', size = 15)\nplt.show()","6d183abc":"fig, axes = plt.subplots(nrows = 4, ncols = 2, figsize = (15,20))\nfig.suptitle('\\n \\n \\nCategorical Variable Distributions \\n \\n', fontsize = 16)\nplt.subplots_adjust(wspace=0.3, hspace=0.6)\nx = ['Female', 'Male']\ny = df[df['target']==1].sex.value_counts(sort = False).values \naxes[0][0].bar(x,y)\naxes[0][0].set_title('Sex \\n\\n')\naxes[0][0].set_ylabel('Numer of People')\n\nx = ['Typical Angina', 'Atypical Angina', 'Non-anginal Pain', 'Asymptomatic']\ny = df[df['target']==1].cp.value_counts(sort=False).values\naxes[0][1].bar(x,y)\naxes[0][1].set_title('Chest Pain Type \\n \\n')\naxes[0][1].set_ylabel('Numer of People')\n\nx = ['Healthy', 'Unhealthy']\ny = df[df['target']==1].fbs.value_counts(sort = False).values\naxes[1][0].bar(x,y)\naxes[1][0].set_title('Fasting blood sugar \\n\\n')\naxes[1][0].set_ylabel('Numer of People')\n\nx = ['Regular', 'Abnormality', 'Severe']\ny = df[df['target']==1].restecg.value_counts(sort = False).values\naxes[1][1].bar(x,y)\naxes[1][1].set_title('Resting Electrocardiographic Results \\n \\n')\naxes[1][1].set_ylabel('Numer of People')\n\nx = ['No', 'Yes']\ny = df[df['target']==1].exang.value_counts(sort = False).values\naxes[2][0].bar(x,y)\naxes[2][0].set_title('Exercise induced angina \\n\\n')\naxes[2][0].set_ylabel('Numer of People')\n\nx = ['Downward','Flat','Upward']\ny = df[df['target']==1].slope.value_counts(sort = False).values\naxes[2][1].bar(x,y)\naxes[2][1].set_title('ST excercise peak \\n \\n')\naxes[2][1].set_ylabel('Numer of People')\n\nx = ['None','Normal','Fixed Defect','Reversable Defect']\ny = df[df['target']==1].thal.value_counts(sort = False).values\naxes[3][0].bar(x,y)\naxes[3][0].set_title('Thalium Stress Test \\n \\n')\naxes[3][0].set_ylabel('Numer of People')\nplt.show()","3a149216":"sns.set(style=\"darkgrid\")\nbaslik_font = {'family': 'arial', 'color': 'darkred', 'weight': 'bold', 'size' : 13}\neksen_font = {'family':'arial', 'color':'darkred', 'weight' : 'bold', 'size':13}\nplt.figure(figsize = (14,6))\nsns.countplot(y = 'cp', hue = 'sex', data = df, palette = 'Greens_d')\nplt.title('Chest Pain Distribution \\n', fontdict = baslik_font)\nplt.ylabel('Chest Pain Type\\n 0:Typical Ang., 1:Atypical Ang.\\n 2:Non anginal, 3:Asypmtomatic \\n', fontdict = eksen_font)\nplt.xlabel(('\\n Number of People \\n0:Female, 1:Male'), fontdict = eksen_font)\nplt.show()","592bbce9":"corelmat = df[df['target'] == 1].corr()\ncorelmat","a1811dc4":"plt.figure(figsize = (8,6))\nsns.heatmap(corelmat)\nplt.show()","97d809c8":"print('Mean age of people', df.age.mean())\nprint('Mean age of risky people',df[df['target']==1].age.mean())\nprint('Mean age of not risky people', df[df['target']==0].age.mean())","b1ee9a44":"print('Patients over 54 diagnosis ratio: {} %'.format(round(df[df['age']>54]['target'].mean()*100,2)))\nprint('Patients under 54 diagnosis ratio: {} %'.format(round(df[df['age']<=54]['target'].mean()*100,2)))","4e0ff888":"t_age = scipy.stats.ttest_ind(df[df['target']==0].age, df[df['target']==1].age)\nt_age","6d51cb63":"a = df[df['sex'] == 0]['target']\nb = df[df['sex'] == 1]['target']\nt_sex = scipy.stats.ttest_ind(a,b)\nc = df[df['fbs'] == 0]['target']\nd = df[df['fbs'] == 1]['target']\nt_fbs = scipy.stats.ttest_ind(c,d)\ne = df[df['exang'] == 0]['target']\nf = df[df['exang'] == 1]['target']\nt_exang = scipy.stats.ttest_ind(e,f)\n\narr_1 = ['Sex', 'Fasting blood sugar', 'Exercise induced angina']\narr_2 = [t_sex, t_fbs, t_exang]\nfor i in range(0,3):\n    \n    print('For {}: {}'.format(arr_1[i], arr_2[i]))","f93cdd08":"pain_types = ['Typical Angina', 'Atypical Angina', 'Non-anginal Pain', 'Asymptomatic']\nfor i in range (0,4):\n    cp_mean = df[df['cp']==i]['target'].mean()\n    cp_mean = round(cp_mean, 3)\n    print('Heart disease risk for {} is {} %'.format(pain_types[i], cp_mean*100))","17ce0dcb":"arr_ca = df[df['target']==1].ca.value_counts(sort = False)\nx = ['0','1','2','3','4']\nplt.figure(figsize = (8,5))\nplt.bar(x, arr_ca)\nplt.title('Major Vessels Distribution \\n')\nplt.xlabel('\\nNumber of Major Vessels')\nplt.ylabel('Number of People')\nplt.show()","cd7a41bf":"arr_slope = df[df['target']==1].slope.value_counts(sort = False)\nx = ['Upslopping', 'Flat', 'Downslopping']\nplt.figure(figsize = (8,5))\nplt.bar(x,arr_slope)\nplt.title('Slopes of the Peak Exercise \\n')\nplt.ylabel('Number of People')\nplt.xlabel('\\nSlope Types')\nplt.show()","b983f227":"plt.figure(figsize=(16,19))\n\nplt.subplots_adjust(hspace=0.5, wspace=0.3)\nplt.suptitle('Distribution of Variables by Age\\n Linear Regression Plots', size = 17, color = 'darkred')\n\nplt.subplot(421)\nplt.title('Diagnosed People \\n\\n\\n', size = 16,color ='darkred')\nsns.regplot(df[df['target']==1]['age'], df[df['target']==1]['thalach'])\nplt.xlabel('Age')\nplt.ylabel('Maximum Heart Rate Achieved')\n\nplt.subplot(422)\nplt.title('Not Diagnosed People \\n\\n\\n', size = 16,color ='darkred')\nsns.regplot(df[df['target']==0]['age'], df[df['target']==0]['thalach'])\nplt.xlabel('Age')\nplt.ylabel('Maximum Heart Rate Achieved')\n\nplt.subplot(423)\nsns.regplot(df[df['target']==1]['age'], df[df['target']==1]['chol'])\nplt.xlabel('Age')\nplt.ylabel('Cholesterol Serum')\n\nplt.subplot(424)\nsns.regplot(df[df['target']==0]['age'], df[df['target']==0]['chol'])\nplt.xlabel('Age')\nplt.ylabel('Cholesterol Serum')\n\nplt.subplot(425)\nsns.regplot(df[df['target']==1]['age'], df[df['target']==1]['trestbps'])\nplt.xlabel('Age')\nplt.ylabel('Resting Blood Pressure')\n\nplt.subplot(426)\nsns.regplot(df[df['target']==0]['age'], df[df['target']==0]['trestbps'])\nplt.xlabel('Age')\nplt.ylabel('Resting Blood Pressure')\n\nplt.subplot(427)\nsns.regplot(df[df['target']==1]['age'], df[df['target']==1]['oldpeak'])\nplt.xlabel('Age')\nplt.ylabel('ST Depression')\n\nplt.subplot(428)\nsns.regplot(df[df['target']==0]['age'], df[df['target']==0]['oldpeak'])\nplt.xlabel('Age')\nplt.ylabel('ST Depression')\nplt.show()","7d6452ba":"t_a = scipy.stats.ttest_ind(df[df['target']==1]['thalach'],df[df['target']==0]['thalach'])\nt_b = scipy.stats.ttest_ind(df[df['target']==1]['chol'],df[df['target']==0]['chol'])\nt_c = scipy.stats.ttest_ind(df[df['target']==1]['trestbps'],df[df['target']==0]['trestbps'])\nt_d = scipy.stats.ttest_ind(df[df['target']==1]['oldpeak'],df[df['target']==0]['oldpeak'])\n\na_1 = ['Max heart rate achieved', 'Cholosterol', 'Resting blood pleasure', 'ST depression']\na_2 = [t_a,t_b,t_c,t_d]\nfor i in range(0,4):\n    print('For {}: {}'.format(a_1[i], a_2[i]))","d799ce9a":"df_2 = df[['age', 'trestbps', 'chol', 'thalach', 'oldpeak', 'trestbps','slope']]\nplt.figure(figsize = (10,6))\nscaled = preprocessing.scale(df_2.T)\npca = PCA()\npca.fit(scaled)\npca_data = pca.transform(scaled)\nper_var = np.round(pca.explained_variance_ratio_*100, decimals = 1) \nlabels = ['PC' + str(x) for x in range(1, len(per_var)+1)]\nplt.bar(x=range(1,len(per_var)+1), height=per_var, tick_label=labels)\nplt.ylabel('Percentage of Explained Variance')\nplt.xlabel('Principal Component')\nplt.title('Scree Plot')\nplt.show()","999dda61":"for i in range(0,3):\n    print(per_var[i])","d29a365a":"### A fast look to aging effect:","c4a7bc8c":"### Data types and numbers of variables:","ed596699":"## 3. General View of the Data\n\nVariables: \n\n1.  age: The person's age in years\n2.  sex: The person's sex (1 = male, 0 = female)\n3.  cp: The chest pain experienced (Value 1: typical angina, Value 2: atypical angina, Value 3: non-anginal pain, Value 4: asymptomatic)\n4.  trestbps: The person's resting blood pressure (mm Hg on admission to the hospital)\n5.  chol: The person's cholesterol measurement in mg\/dl\n6.  fbs: The person's fasting blood sugar (> 120 mg\/dl, 1 = true; 0 = false)\n7.  restecg: Resting electrocardiographic measurement (0 = normal, 1 = having ST-T wave abnormality, 2 = showing probable or  definite left ventricular hypertrophy by Estes' criteria)\n8.  thalach: The person's maximum heart rate achieved\n9.  exang: Exercise induced angina (1 = yes; 0 = no)\n10. oldpeak: ST depression induced by exercise relative to rest ('ST' relates to positions on the ECG plot. See more here)\n11. slope: the slope of the peak exercise ST segment (Value 1: upsloping, Value 2: flat, Value 3: downsloping)\n12. ca: The number of major vessels (0-3)\n13. thal: A blood disorder called thalassemia (3 = normal; 6 = fixed defect; 7 = reversable defect)\n14. target: Heart disease (0 = no, 1 = yes)\n\nAbove we see which variables are numerical and continuous and which variables are categorical. In the raw dataset, data has 76 attributes but all published experiments refer to using only 14 of them. The version which we get also has 14 attributes. \n\n   *for more information visit the page https:\/\/archive.ics.uci.edu\/ml\/datasets\/Heart+Disease*","42023365":"### Risk ratios for chest pain types:","9a761b71":"As we see, most common type is typical angina but it has low risk ratio compared to others.","0a7e62da":"## 4. Data Cleaning","db782bff":"### Let's take a look at how many people have been diagnosed with heart disease or not.","b659b00d":"Age variable also has an impact on our target variable as we see from the 'low p-value'.","aff7d07e":"Our 'target variable' is diagnosis variable. It is called 'target' in data frame. It has two value, 0 and 1. '0' means the person is not risky about heart disease. '1' means the person is diagnosed as heart diseased. In that part, we are going to try to find what may has impact on cardio vascular diseases. ","d9595bc4":"Winsorization has been done. Now, there is no overlier left.","2482da0b":"### Let's check if the non-assignment values exist, as we see below we have no nan values.","19276c7b":"### Major vessel distribution of diagnosed people:","bafe7f56":"Below, we will see multiple plots. Left hand side shows the plots of diagnosed, risky peoples. Right hand side shows the not risky people's plots. T-test results are between each variables seperated by target as 0 or 1. It means not risky or risky.","34561626":"As wee se above, most of diagnosed people have no major vessels.","031ae6cb":"### Principal Component Analysis","9fdc0e21":"## 2. Goal of the Analysis\n\nThe main goal which we try to achieve in this explarotary data analysis is to get more clarified sight for which kind of attributes may be more significant signal of an incoming heart disease. We are not going to go into the deepest point but we wil get better understanding on the data without doubt. ","0749d22d":"### Continuous variables:\n* age\n* cholosterol serum(chol)\n* maximum heart rate achieved(thalach)\n* oldpeak\n* slope\n* number of major vessels(ca)\n* trestbps","4f71ef7c":"Good result. The first principal component shares 96.1% of variance. That means, there may no need to use all the five variables. ","0ee793a4":"\n\nHere, we obtained T-test results of 4 continuous variables. Maximum heart rate achieved(thalach), cholesterol serum(chol), resting blood pressure(trestbps), ST deppression induced by exercise relative to rest(oldpeak). Then we plotted regression plots by age. ","b9240b6f":"### Plotting the continuous variables by increasing age values:","8634c983":"### Categorical variables:\n\n* sex\n* fasting blood sugar(fbs)\n* resting electrocardiographic results(restecg)\n* exercised induced angina(exang)\n* thal\n* target\n* chest pain distribution(cp)","16874927":"### Let's see the distributions of categorical variables for diagnosed people:","a935138e":"\n### Importing the useful libraries","04c04983":"### Get rid of the outliers:","1f5264b0":"### Let's take a look at the data:","19bc8ed0":"## Contents\n### 1. Introduction\n### 2. The Goal of Analysis\n### 3. General View of the Data\n### 4. Data Cleaning\n### 5. Exploring the Data\n### 6. Feature Engineering\n### 7. Results\n### 8. Conclusions and Furter Research","fd4b00a7":"## 7. Results\n\nNow, we are done with the our analysis. We understood the data, classified variables, plotted graphs, made some tests and tried to achieve what has impact on our target variables. We have got some results;\n\n1. Our target variable is balanced by number of people who are diagnosed or not.\n\n2. Variables which has signifanct impact on heart disease diagnosis:\n\n    * Age\n    * Sex; males are more likely to be diagnosed\n    * Exercised induced angina(exang)\n    * Max heart rate achieved(thalach)\n    * Resting blood pressure(trestbps)\n    * ST depression(oldpeak)\n3. Variables which has no statistical significance:\n\n    * Cholosterol serum(chol)\n    * Fasting blood pressure(fbs)\n4. Variables which point to significance:\n\n    * Chest pain distribution; all types have different size of heart disease risk. Typical angina is not dangerous as much as others. \n    * Slope types; downslopping and flat types are most seen. Upslopping is rare. \n    * Major vessels; we know that diameters of vessels are important for cardiovascular diseases. Here, most of diagnosed people have no major vessels and this is absolutely a major signal.\n    \n5. Principal components:\n\n    * Using the pca module in python, we have found out the first principal component represents the most of variance, 96.3 %. \n    ","1422ae93":"## 1. Introduction\n\n   Cardiovascular disease(CVD) is the most seen death cause in all over the world today. Many researches have been done in this area and many of them continues. Like many others, now the researches are more around the data analysis, machine learning models. The questions are, what causes the heart disease and how can we prevent it before it doesn't exist? In our dataset, we have a small size observation to fit the outputs to a predictive model but we have made a simpe explarotary data analysis to obtain a bit more comprehensive look. We have seeked an answer to which variables have more efective on heart disease diagnosis.   ","7b4dd9a9":"## 5. Exploring the Data","58b37337":"Easily visible above, 'sex' and 'exercise induced angina' has statistical significance if we assume the significance level is 0.005.","2e83f9be":"## 6. Feature Engineering","78ec5d08":"Above we checked if the numbers are overly different. The numbers are close and that is fine.","27803594":"### Some statistically meaningful values about data:","762b3a29":"## 8. Conclusions and Further Research\n\nMy hypothesis is some of the variables may be a sign of an incoming or already existing heart disease. For a powerful and precise predictive model, we need bigger size of datas, more variables, more observation etc. In this analysis, we have a small size data, does not include sufficient attribute number to speak precise. But simple datas also can say something important about our targets as we have got here. What do we have? Statistically significance values have shown with t-tests. We have seen which attributes may have an impact on heart diseases as explained in the part of results. \n\n### Suggestions for future works:\n\nWhat could be done better? In my opinion, we need more attributes and too much more observations to analyze data with high accuracy. For example, the data that includes social daily life, lifestyle, physical attributes, eating, drinking, alcohol and smoking habbits, exercise frequency, exercise types etc. could be really effective for predictions. When the number of observations increase, relations between no-target variables could be investigated more. ","c602bac9":"We have done the principal component analysis to see how much variance shared by less variables. It is important for implementing the data to a machine learning model that we are not going to deal in this analysis. ","56c4b90b":"All of the attributes are statistically significant but the 'cholosterol'.","b744d0b6":"### The slopes of the peak exercise ST segment:","48c7a27f":"### Chest pain distribution:","4201a736":"### Correlations of variables for diagnosed people:","d4dd6a31":"### Target variable is 'target', it asks \"is a patient diagnosed or not?\"","6f58e3fd":"# Probable Signals of Heart Disease\n\n## Explatory Data Analysis\n\n","e5e24a66":"Colors clearly show us that the correlation coefficients are weak.","812b1c89":"Most of diagnosed people's slope types are 'downslopping' and 'flat' type."}}