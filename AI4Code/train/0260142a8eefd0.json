{"cell_type":{"e019f8bd":"code","5f9d4ca3":"code","15592db7":"code","716f1a4f":"code","bb4692b3":"code","decac7f3":"code","1e7ff021":"markdown","f6fa21ed":"markdown","2e81ff79":"markdown","1524fbcb":"markdown","1aabd75a":"markdown","cf8a1201":"markdown","d1cd4c67":"markdown"},"source":{"e019f8bd":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nfrom matplotlib import pyplot as plt\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\ndata = pd.read_csv('\/kaggle\/input\/MonthlySales.csv')\nsales = list(data['sales'])\ndata.head()","5f9d4ca3":"def cal_mse(real_list, pred_list):\n    differ = len(pred_list) - len(real_list)\n    MSEs = 0\n    range_list = range(differ, len(real_list))\n    for i in range_list:\n        x_real = real_list[i]\n        x_pred = pred_list[i]\n        MSEs = (x_pred - x_real) ** 2 + MSEs\n    MSE = (MSEs ** (1 \/ 2)) \/ int(len(range_list))\n    return MSE\n\n\ndef exponential_smoothing(alpha, s):\n    '''\n    smoothing\n    '''\n    s_temp = [0 for i in range(len(s))]\n    s_temp[0] = (s[0] + s[1] + s[2]) \/ 3\n    for i in range(1, len(s)):\n        s_temp[i] = alpha * s[i] + (1 - alpha) * s_temp[i - 1]\n    return s_temp\n\n\ndef compute_single(alpha, s):\n    '''\n    single exponetial smoothing\n    '''\n    return exponential_smoothing(alpha, s)\n\n\ndef single_pred_list(alpha, s):\n    '''pred formula \uff1ax_{t+1}=S_t'''\n    single_pred = [None]\n    S_1 = compute_single(alpha, s)\n    for i in S_1:\n        single_pred.append(i)\n    return single_pred\n\n\ndef single_best_alpha(s):\n    '''get best alpha for single exponential smoothing'''\n    mse_list = []\n    alpha_list = np.arange(0, 1, 0.01)\n    for alpha in alpha_list:\n        single_pred = single_pred_list(alpha, s)\n        mse = cal_mse(s, single_pred)\n        mse_list.append(mse)\n    best_alpha = alpha_list[mse_list.index(min(mse_list))]\n    min_mse = min(mse_list)\n    return best_alpha, min_mse\n\n\ndef compute_double(alpha, s):\n    '''\n    double exponential smoothing\n    '''\n    s_single = compute_single(alpha, s)\n    s_double = compute_single(alpha, s_single)\n\n    a_double = [0 for i in range(len(s))]\n    b_double = [0 for i in range(len(s))]\n\n    for i in range(len(s)):\n        a_double[i] = 2 * s_single[i] - s_double[i]\n        b_double[i] = (alpha \/ (1 - alpha)) * (s_single[i] - s_double[i])\n\n    return a_double, b_double\n\n\ndef double_pred_list(alpha, s, t):\n    '''pred formula \uff1ax_{t+T}=a_t+B_t*T'''\n    a_double, b_double = compute_double(alpha, s)\n    double_pred = [None] * t\n    for i in range(len(a_double)):\n        a_t = a_double[i]\n        b_t = b_double[i]\n        pred_value = a_t + b_t * t\n        double_pred.append(pred_value)\n    return double_pred\n\n\ndef double_best_alpha(s, t):\n    mse_list = []\n    alpha_list = np.arange(0, 1, 0.001)\n    for alpha in alpha_list:\n        single_pred = double_pred_list(alpha, s, t)\n        mse = cal_mse(s, single_pred)\n        mse_list.append(mse)\n    best_alpha = alpha_list[mse_list.index(min(mse_list))]\n    min_mse = min(mse_list)\n    return best_alpha, min_mse\n\n\ndef compute_triple(alpha, s):\n    '''\n    triple exponential smoothing\n    '''\n    s_single = compute_single(alpha, s)\n    s_double = compute_single(alpha, s_single)\n    s_triple = exponential_smoothing(alpha, s_double)\n\n    a_triple = [0 for i in range(len(s))]\n    b_triple = [0 for i in range(len(s))]\n    c_triple = [0 for i in range(len(s))]\n\n    for i in range(len(s)):\n        a_triple[i] = 3 * s_single[i] - 3 * s_double[i] + s_triple[i]\n        b_triple[i] = (alpha \/ (2 * ((1 - alpha) ** 2))) * (\n                (6 - 5 * alpha) * s_single[i] - 2 * ((5 - 4 * alpha) * s_double[i]) + (4 - 3 * alpha) * s_triple[i])\n        c_triple[i] = ((alpha ** 2) \/ (2 * ((1 - alpha) ** 2))) * (s_single[i] - 2 * s_double[i] + s_triple[i])\n\n    return a_triple, b_triple, c_triple\n\n\ndef triple_pred_list(alpha, s, t):\n    '''pred formula \uff1ax_{t+T}=a_t+B_t*T'''\n    a_triple, b_triple, c_triple = compute_triple(alpha, s)\n    triple_pred = [None] * t\n    for i in range(len(a_triple)):\n        a_t = a_triple[i]\n        b_t = b_triple[i]\n        c_t = c_triple[i]\n        pred_value = a_t + b_t * t + c_t * (t ** 2)\n        triple_pred.append(pred_value)\n    return triple_pred\n\n\ndef triple_best_alpha(s, t):\n    mse_list = []\n    alpha_list = np.arange(0, 1, 0.01)\n    for alpha in alpha_list:\n        single_pred = triple_pred_list(alpha, s, t)\n        mse = cal_mse(s, single_pred)\n        mse_list.append(mse)\n    best_alpha = alpha_list[mse_list.index(min(mse_list))]\n    min_mse = min(mse_list)\n    return best_alpha, min_mse\n\n\ndef plot_lines(data, pred_list, title):\n    add_value = [None] * (len(pred_list) - len(data))\n    xlist = list(range(0, len(pred_list)))\n    real = data + add_value\n    plt.plot(xlist, real, color='blue', label=\"actual value\")\n    plt.plot(xlist, pred_list, color='red', label=\"predicted value\")\n#     for m, n in zip(xlist, real):\n#         if n != None:\n#             plt.text(m, n + 10, '%.0f' % n, ha='center', color='blue', fontsize=9)\n#     for m1, n1 in zip(xlist, pred_list):\n#         if n1 != None:\n#             plt.text(m1, n1 - 10, '%.0f' % n1, ha='center', color='red', fontsize=9)\n    plt.legend()\n    plt.title(title)\n    plt.xlabel('date')\n    plt.ylabel('sales')\n    plt.show()","15592db7":"# single \nsingle_alpha, single_mse = single_best_alpha(sales)\nsingle_pred = single_pred_list(single_alpha, sales)\nprint('single best alpha: ', single_alpha)\nprint('pred value:' ,str(single_pred[-1]))\nsingle_title = str('single pred with MSE: ' + str(single_mse))\nplot_lines(sales, single_pred, single_title)","716f1a4f":"double_alpha, double_mse = double_best_alpha(sales, t=1)\ndouble_pred = double_pred_list(double_alpha, sales, t=1)\nprint('double best alpha: ', double_alpha)\nprint('pred value:' ,str(double_pred[-1]))\ndouble_title = str('double pred with MSE: ' + str(double_mse))\nplot_lines(sales, double_pred, double_title)","bb4692b3":"triple_alpha, triple_mse = triple_best_alpha(sales, t=1)\ntriple_pred = triple_pred_list(triple_alpha, sales, t=1)\nprint('triple best alpha: ', triple_alpha)\nprint('pred value:' ,str(triple_pred[-1]))\ntriple_title = str('triple pred with MSE: ' + str(triple_mse))\nplot_lines(sales, triple_pred, triple_title)","decac7f3":"triple_alpha_list = [0.1,0.3,0.5,0.7,0.9]\nfor triple_alpha in triple_alpha_list:\n    triple_pred = triple_pred_list(triple_alpha, sales, t=1)\n    triple_mse = cal_mse(sales, triple_pred)\n    print('triple best alpha: ', triple_alpha)\n    print('pred value:' ,str(triple_pred[-1]))\n    triple_title = str('triple pred with MSE: ' + str(triple_mse))\n    plot_lines(sales, triple_pred, triple_title)","1e7ff021":"double exponential smoothing model","f6fa21ed":"triple exponential smoothing model","2e81ff79":"i want to know more about alpha and mse","1524fbcb":"triple exponential smoothing model has min_mse==3355\n\nso we pred next value is 73823.65246262701","1aabd75a":"now we start building exponential smoothing model\n* step1: create mse to estimate accuracy\n* step2: single exponetial smoothing model\n* step2: double exponetial smoothing model\n* step3: triple exponetial smoothing model\n* step4\uff1aget best alpha\n* step5: choose best result","cf8a1201":"single exponential smoothing model","d1cd4c67":"in this project with small scale dataset,exponential smoothing model maybe better than most models.\n\nso i try to use exponential smoothing to pred.\n\nthe main operations are as follows:\n* finding the best alpha\n* choose the best exponential"}}