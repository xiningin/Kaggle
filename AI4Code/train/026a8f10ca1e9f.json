{"cell_type":{"bee03b8a":"code","3079044c":"code","723443ed":"code","ba40f8d6":"code","ac9afc76":"code","2950d48b":"markdown","05e04904":"markdown","a6d69ce4":"markdown","f8e52637":"markdown","bfdc4c75":"markdown","2cad4ce2":"markdown","a7e0d5b5":"markdown","cf6e16f3":"markdown","38f2ba0f":"markdown","034252b8":"markdown","1c40f126":"markdown"},"source":{"bee03b8a":"import numpy as np\nfrom sklearn.datasets import make_regression\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\nx, y = make_regression(n_samples=10**4, n_features=1, noise=20.0, random_state=1234)\nx = x.flatten()\n\n# \u30bb\u30f3\u30bf\u30ea\u30f3\u30b0\nx = x - x.mean()\ny = y - y.mean()\n\nfig = plt.figure(figsize=(4.0, 8.0))\nax1 = fig.add_subplot(3, 1, 1)\nax2 = fig.add_subplot(3, 1, 2)\nax3 = fig.add_subplot(3, 1, 3)\n\nx_range = np.arange(-5, 5, 0.1)\nax1.hist(x, x_range)\ny_range = np.arange(-300, 300, 1)\nax2.hist(y, y_range)\nax3.scatter(x, y, s=1)","3079044c":"def sigma(x, y, f):\n  result = 0\n  for i, v in enumerate(x):\n    result += f(x, y, i)\n  return result\n\ndef c1f(x, y, i):\n  return x[i]*y[i]\n\ndef c2f(x, _, i):\n  return x[i]**2\n\nc1 = sigma(x, y, c1f)\nc2 = sigma(x, None, c2f)\na = c1\/c2\nprint(a)","723443ed":"y_hat = x_range*a\nfig = plt.figure(figsize=(8.0, 8.0))\nax1 = fig.add_subplot(1, 1, 1)\nax1.scatter(x,y)\nax1.plot(x_range, y_hat, color='orange')","ba40f8d6":"def error(x, y, a):\n  result = 0\n  for i, v in enumerate(x):\n    result += (y[i] - a*x[i])**2\n  return result\n  \na_range = np.arange(40,94)\nerrors = [error(x,y,a_d) for a_d in a_range]\nfig = plt.figure(figsize=(4, 4))\nax1 = fig.add_subplot(1, 1, 1)\nax1.plot(a_range, errors)","ac9afc76":"print(f'65 => {error(x,y,65)}')\nprint(f'66 => {error(x,y,66)}')\nprint(f'66.61055050124563 => {error(x,y,66.61055050124563)}')\nprint(f'67 => {error(x,y,67)}')\nprint(f'68 => {error(x,y,68)}')\nprint(f'69 => {error(x,y,69)}')\nprint(f'70 => {error(x,y,70)}')","2950d48b":"## \u8aa4\u5dee\u95a2\u6570\n\u4f7f\u7528\u3059\u308b\u8aa4\u5dee\u95a2\u6570\u306f\u4e8c\u4e57\u8aa4\u5dee\u3002\n$$\n\\begin{eqnarray}\nL&=\\sum_{i=1}^{n}(y_i - \\hat{y_i})^2 \\\\\n&=\\sum_{i=1}^{n}(y_i - ax_i)^2\n\\end{eqnarray}\n$$\n\n\u3053\u306e\u5f0f\u3092\u6a2a\u8ef8\u3092a\u3001\u7e26\u8ef8\u3092L\u306e\u30b0\u30e9\u30d5\u3068\u3057\u305f\u5834\u5408\u3001\u63a5\u6226\u306e\u50be\u304d\u304c0\u3068\u306a\u308b\u5834\u6240\u304cL\uff08\u3064\u307e\u308a\u8aa4\u5dee\uff09\u306e\u6700\u5c0f\u5024\u3068\u306a\u308b\u3002  \n\u3068\u3044\u3046\u3053\u3068\u306f\u4e0a\u306e\u5f0f\u3092\u5fae\u5206\u3057\u305f\u7d50\u679c\u304c0\u306ea\u3092\u6c42\u3081\u308c\u3070\u3001\u8aa4\u5dee\u304c\u6700\u5c0f\u306e\u30e2\u30c7\u30eb\u304c\u4f5c\u308c\u308b\u3002\n  \n$$\n\\frac{\\partial L}{\\partial a} = 0\n$$","05e04904":"## \u30c7\u30fc\u30bf\u751f\u6210\n\u4e0a\u306e\u5f0f\u306e\u5b9f\u30c7\u30fc\u30bf\u3068\u306a\u308bx,y\u306e\u30c7\u30fc\u30bf\u3092\u4f5c\u6210\u3059\u308b\u3002  \n   \n\u8aac\u660e\u5909\u6570: x  \n\u76ee\u7684\u5909\u6570: y  \n\u4ef6\u6570: 10000","a6d69ce4":"# \u89e3\u8aac\n***","f8e52637":"# \u5b9f\u88c5\n***\n\u30c7\u30fc\u30bf\u3092\u751f\u6210\u3057\u3066\u3001\u305d\u306e\u30c7\u30fc\u30bf\u306b\u5bfe\u3059\u308b\u30e2\u30c7\u30eb\u3092\u4f5c\u6210\u3059\u308b\u3002","bfdc4c75":"## \u30e2\u30c7\u30eb\u306e\u5f0f\n$$\n\\hat{y} = ax\n$$\n  \n  \n\u30c7\u30fc\u30bf\u3092\u30bb\u30f3\u30bf\u30ea\u30f3\u30b0\u3059\u308b\u306e\u3067\u5207\u7247\u306f\u7701\u7565\u3059\u308b\u3002\n\n\u5358\u56de\u5e30\u5206\u6790\u306a\u306e\u3067\u30d1\u30e9\u30e1\u30fc\u30bf\u3068\u3057\u3066\u3001a\u306e\u50be\u304d\u3060\u3051\u3092\u6c42\u3081\u308c\u3070\u3044\u3044\u3002","2cad4ce2":"# \u307e\u3068\u3081\n***\n\u8aa4\u5dee\u95a2\u6570\u306e\u5c0e\u95a2\u6570\u3092\u5909\u5f62\u3057\u3066\u30d1\u30e9\u30e1\u30fc\u30bfa\u3092\u6c42\u3081\u3066\u30e2\u30c7\u30eb\u3092\u4f5c\u6210\u3057  \n\u4e88\u6e2c\u7d50\u679c\u306e\u8aa4\u5dee\u304c\u6700\u5c0f\u306b\u306a\u3063\u3066\u3044\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3067\u304d\u305f\u3002","a7e0d5b5":"## \u30e2\u30c7\u30eb\u4f5c\u6210\u306e\u7d50\u679c\na\u306b\u8a08\u7b97\u7d50\u679c\u3092\u4ee3\u5165\u3057\u3066\u3001\u3053\u306e\u30c7\u30fc\u30bf\u306b\u5bfe\u3057\u3066\u306e\u30e2\u30c7\u30eb\u306f\u4ee5\u4e0b\u306b\u306a\u308b\u3002\n$$\n\\hat{y}=66.61055050124563x\n$$\n  \n\u3053\u306e\u30e2\u30c7\u30eb\u3067\u4e88\u6e2c\u3057\u305f\u7d50\u679c\u3092\u53ef\u8996\u5316\u3057\u3066\u307f\u308b\u3002","cf6e16f3":"## \u8aa4\u5dee\u304c\u6700\u5c0f\u3067\u3042\u308b\u3053\u3068\u3092\u78ba\u8a8d\u3059\u308b\n\u8aa4\u5dee\u95a2\u6570\n$$\nL=\\sum_{i=1}^{n}(y_i - ax_i)^2\n$$","38f2ba0f":"## \u30e2\u30c7\u30eb\u4f5c\u6210\n\u30e2\u30c7\u30eb\u306e\u5f0f\u3002\n$$\n\\hat{y}=ax\n$$\n  \n\u3053\u306e\u5f0f\u3067\u30d1\u30e9\u30e1\u30fc\u30bfa\u3092\u6c42\u3081\u308b\u3002\n$$\na=\\frac{\\sum_{i=1}^{n}y_ix_i}{\\sum_{i=1}^{n}x_i^2}\n$$\n","034252b8":"\u5358\u56de\u5e30\u5206\u6790\u3092sklearn\u3092\u4f7f\u308f\u305a\u306bnumpy\u3060\u3051\u3067\u5b9f\u88c5\u3057\u3066\u307f\u308b\u3002","1c40f126":"## \u8aa4\u5dee\u304c\u6700\u5c0f\u306ea\u3092\u6c42\u3081\u308b\n1. \u8a55\u4fa1\u95a2\u6570\u3092\u5c55\u958b\u3059\u308b\u3002\n$$\n\\begin{align}\nf(a) &= \\sum_{i=1}^{n}(y_i - ax_i)^2 \\\\\n&= \\sum_{i=1}^{n}y_i^2 - 2\\sum_{i=1}^{n}y_iax_i + \\sum_{i=1}^{n}a^2x_i^2 \\\\\n\\end{align}\n$$\n2. \u8a55\u4fa1\u95a2\u6570\u306e\u5c0e\u95a2\u6570\u3092\u6c42\u3081\u308b\u3002\n$$\n\\begin{align}\nf'(a) &= \\{\\sum_{i=1}^{n}y_i^2\\}' +\\{- 2\\sum_{i=1}^{n}y_iax_i\\}' + \\{\\sum_{i=1}^{n}a^2x_i^2\\}' \\\\\n&= -2\\sum_{i=1}^{n}y_ix_i + 2\\sum_{i=1}^{n}x_i^2a\n\\end{align}\n$$\n3. \u5fae\u5206\u3057\u305f\u7d50\u679c\u304c0\u306b\u306a\u308ba\u3092\u6c42\u3081\u308b\u3002\n$$\n\\begin{align}\n0 &= -2\\sum_{i=1}^{n}y_ix_i + 2\\sum_{i=1}^{n}x_i^2a \\\\\n-2\\sum_{i=1}^{n}x_i^2a &= -2\\sum_{i=1}^{n}y_ix_i \\\\\n\\sum_{i=1}^{n}x_i^2a &= \\sum_{i=1}^{n}y_ix_i \\\\\na &= \\frac{\\sum_{i=1}^{n}y_ix_i}{\\sum_{i=1}^{n}x_i^2}\n\\end{align}\n$$\n  \n\u3053\u306e\u5f0f\u3067\u30d1\u30e9\u30e1\u30fc\u30bf\u3068\u3057\u3066\u306ea\u304c\u6c42\u3081\u3089\u308c\u305d\u3046\u3002"}}