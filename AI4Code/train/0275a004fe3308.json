{"cell_type":{"1bd00d43":"code","30f32267":"code","9857780b":"code","28b4d343":"code","4be11b78":"code","5b1e35d6":"code","e258a58e":"code","89c2b117":"code","0feef277":"code","6ffacd01":"code","ac56a338":"code","c48f49fd":"code","7f9d4bf2":"code","59209062":"code","248cd35b":"code","6a6d7145":"code","64ddc9ae":"code","09432470":"code","dd0b9bcb":"code","bb7eb6c6":"code","7e822889":"code","6fa6f7dc":"code","169d6b93":"code","32c27a4c":"code","b5be9840":"code","58e85c28":"code","38c45174":"code","d032c81b":"code","f6b6de5f":"code","8a63c5f6":"code","01fe6dc7":"code","a3b11c9b":"code","2b5b93eb":"code","a516e514":"code","0b0946d5":"code","b43cebf3":"code","bf596438":"code","537f2c02":"code","d112b0b3":"code","bd432479":"code","5143baaf":"code","386bb36f":"code","4d90363f":"code","6d891394":"code","1c9cde68":"code","3c5f9be6":"code","da64d604":"code","20521bfa":"code","66be3174":"code","b1bf8a13":"code","41891cec":"code","f2646e9e":"code","4a950686":"code","8b5d65ba":"code","d6419af7":"code","9cfd0633":"code","6a83b421":"code","2374c2db":"code","9932fc9f":"code","530e94b9":"markdown","dc935784":"markdown","99503ff0":"markdown","5b01523c":"markdown","d60cfb03":"markdown","adb377aa":"markdown","beaedfc3":"markdown","09ffe5e4":"markdown","d360b51a":"markdown","73c8b284":"markdown","166163b0":"markdown","e33c726e":"markdown","ebcc7d0d":"markdown","2bc3d530":"markdown","35daea14":"markdown","ca4d35b7":"markdown","e3211bbc":"markdown","cf8c0720":"markdown","84e0cd1e":"markdown","d2fbd616":"markdown","4196bf17":"markdown","b96ad65d":"markdown","466f5bf6":"markdown","3a36d963":"markdown","7e4b7c1c":"markdown","6d04337e":"markdown","75935f58":"markdown","2443bc7c":"markdown","36d79434":"markdown","5e7d89d7":"markdown","89b8c074":"markdown","04347094":"markdown","8893fe9a":"markdown","64d3eefe":"markdown","87e781e1":"markdown","dfd816bc":"markdown","319b010e":"markdown","a3cba61b":"markdown","5ee84a57":"markdown","fc2b1046":"markdown","db723ce4":"markdown","f5bd104a":"markdown","9c17122d":"markdown","f5025a29":"markdown","5386565d":"markdown","9f58fc38":"markdown","64b34abb":"markdown","46ce48d3":"markdown","472993e9":"markdown","70ea728d":"markdown","37206969":"markdown","8487b5fb":"markdown","7b6f8e23":"markdown","a9ef577c":"markdown","4d46d4d3":"markdown","3963b55d":"markdown","ee493249":"markdown","e63767de":"markdown","b0cabcb0":"markdown","f063047b":"markdown","d7bf8127":"markdown","28129912":"markdown","09e5b9e3":"markdown","e6e59305":"markdown","910399a4":"markdown","3aca4f69":"markdown","0c1fd491":"markdown","33e41925":"markdown","1c34d6df":"markdown","a346e0cb":"markdown","ce42fa02":"markdown","37ec3fad":"markdown","24bd69a2":"markdown","12e709b3":"markdown","95b34d05":"markdown","0621af89":"markdown","861169d0":"markdown","bda8b42b":"markdown","ecd6e4d1":"markdown","d7e8829c":"markdown","91dccd73":"markdown","e305c0e3":"markdown","7372f34e":"markdown","211168ba":"markdown","d2d9f1e7":"markdown","9c461314":"markdown"},"source":{"1bd00d43":"import warnings\nfrom statsmodels.tools.sm_exceptions import ConvergenceWarning, ValueWarning\nwarnings.simplefilter(\"ignore\", ConvergenceWarning)\nwarnings.simplefilter(\"ignore\", ValueWarning)\n\n# Carrega bibliotecas necess\u00e1rios\n\nfrom matplotlib import pyplot as plt   # M\u00f3dulo para visualiza\u00e7\u00e3o gr\u00e1fica\n%matplotlib inline\n\nimport pandas as pd     # M\u00f3dulo para manipula\u00e7\u00e3o de tabelas de dados\nimport numpy as np      # M\u00f3dulo para processamento de dados num\u00e9ricos\nimport datetime as dt   # M\u00f3dulo para processamento de vari\u00e1veis de tempo\n\nfrom re import sub                           # M\u00f3dulo para processamento de textos\nfrom statistics import mean, stdev, median   # M\u00f3dulo para c\u00e1lculos estat\u00edsticos\nfrom scipy import stats as st                # M\u00f3dulo para c\u00e1lculos estat\u00edsticos\n\n# M\u00f3dulos para processamento de s\u00e9ries temporais\nfrom statsmodels.tsa.seasonal import seasonal_decompose\nfrom statsmodels.tsa.stattools import acf as ACF\nfrom statsmodels.tsa.stattools import pacf as PACF\nfrom statsmodels.graphics.tsaplots import plot_acf, plot_pacf\n##from statsmodels.tsa.arima_model import ARIMA\nfrom statsmodels.tsa.arima.model import ARIMA\nfrom statsmodels.tsa.statespace.sarimax import SARIMAX","30f32267":"DataFolder = \"\/kaggle\/input\/temperatura-e-co2-na-superficie-terrestre\/\"\nFontSize   = 12","9857780b":"FileName = \"GlobalTemperatures.csv\"\nTipos    = [\"str\"] + [\"float\"]*8\n\n# L\u00ea o arquivo de dados\nTEMP = pd.read_table(DataFolder+FileName, header=0, skiprows=None, skipfooter=0, nrows=None,\n                     index_col=None, sep=\",\", decimal=\".\", na_values=[\"-\"], low_memory=False)\n\n# Define o tipo de cada vari\u00e1vel\nTEMP = TEMP.astype( dtype=dict(zip(TEMP.columns.tolist(),Tipos)) )\n\n# Renomeia as vari\u00e1veis usando nomes mais simples\np = TEMP.columns.tolist()\nq = [\"DateTime\", \"TL_avg\",\"TL_avg_u\", \"TL_max\",\"TL_max_u\", \"TL_min\",\"TL_min_u\", \"TLO_avg\",\"TLO_agv_u\"]\nTEMP.rename(columns=dict(zip(p,q)), inplace=True)\n\nTEMP.head()","28b4d343":"# Percentual de \"missing values\" nos dados de temperatura\nprint( 100 * TEMP.isnull().sum() \/ TEMP.shape[0] )","4be11b78":"# Converte o formato da vari\u00e1vel 'DateTime' de string para datetime\nTEMP[\"DateTime\"] = TEMP[\"DateTime\"].map(lambda x: dt.datetime.strptime(x,\"%Y-%m-%d\"))\n\n# Extrai apenas a data (descarta o hor\u00e1rio, pois ele \u00e9 sempre 00:00:00 e n\u00e3o tem utilidade)\nTEMP[\"DateTime\"] = TEMP[\"DateTime\"].map(lambda x: x.date())","5b1e35d6":"FileName = \"CO2_Concentration.csv\"\nTipos    = [\"int\"]*4 + [\"str\"] + [\"float\"]*3\n\n# L\u00ea o arquivo de dados\nCO2 = pd.read_table(DataFolder+FileName, header=0, skiprows=None, skipfooter=0, nrows=None,\n                    index_col=None, sep=\",\", decimal=\".\", na_values=[\"-\"], low_memory=False)\n\n# Define o tipo de cada vari\u00e1vel\nCO2 = CO2.astype( dtype=dict(zip(CO2.columns.tolist(),Tipos)) )\n\nCO2.drop([\"datenum\"], axis=1, inplace=True)\n\n# Renomeia as vari\u00e1veis usando nomes mais simples\np = CO2.columns.tolist()\nq = [\"Year\",\"Month\",\"Day\",\"DateTime\", \"CO2_Global\",\"CO2_North\",\"CO2_South\"]\nCO2.rename(columns=dict(zip(p,q)), inplace=True)\n\nCO2.head(10)","e258a58e":"# Percentual de \"missing values\" nos dados de temperatura\nprint( 100 * CO2.isnull().sum() \/ CO2.shape[0] )","89c2b117":"print(\"Valores \u00fanicos de 'Day':\")\nprint( CO2[\"Day\"].unique().tolist() )\nprint()\nprint(\"Valores \u00fanicos de 'Month':\")\nprint( CO2[\"Month\"].unique().tolist() )\nprint()\nprint(\"Valores iniciais e finais de 'Year':\")\nfoo = CO2[\"Year\"].unique().tolist()\nprint(foo[0:10])\nprint(foo[-10:])\nprint()","0feef277":"# Exclui o ano 0, pois ele n\u00e3o tem sentido\nCO2 = CO2.loc[CO2[\"Year\"]>0]\nCO2.reset_index(drop=True, inplace=True)\n\n# Cria um dataframe tempor\u00e1rio para conter VALORES INTERPOLADOS de CO2 no PRIMEIRO DIA DO M\u00caS,\n# seguindo o mesmo padr\u00e3o dos dados de temperatura, para que todos os dados (CO2 e temperatura)\n# fiquem SINCRONIZADOS NO TEMPO.\nfoo = pd.DataFrame(columns=CO2.columns.tolist())   # Dataframe vazio com as mesmas colunas de 'CO2'\nfoo[\"DateTime\"] = CO2[\"DateTime\"].copy()\nfoo[\"DateTime\"] = foo[\"DateTime\"].map(lambda x: sub(\"^15\",\"01\",x))   # Substitui o dia '15' pelo dia '01'\nfoo.head()","6ffacd01":"# Concatena o dataframe com datas no dia '01' ao dataframe original com datas no dia '15'.\n# Os \"missing values\" (NaN) ser\u00e3o corrigidos adiante.\nCO2 = CO2.append(foo, ignore_index=True)\n\nCO2.tail()","ac56a338":"# Altera o padr\u00e3o de data\/hora da vari\u00e1vel 'DateTime' colocando o m\u00eas em formato num\u00e9rico\nCO2[\"DateTime\"] = CO2[\"DateTime\"].map(lambda x: dt.datetime.strptime(x,\"%d-%b-%Y %H:%M:%S\"))\n\n# Extrai apenas a data e descarta o hor\u00e1rio, seguindo o mesmo formato dos dados de temperatura\nCO2[\"DateTime\"] = CO2[\"DateTime\"].map(lambda x: x.date())\n\nCO2.tail()","c48f49fd":"# Ordena os dados por data para permitir a interpola\u00e7\u00e3o dos \"missing values\" (NaN) no primeiro dia do m\u00eas\nCO2.sort_values(by=[\"DateTime\"], axis=0, ascending=[True], inplace=True, na_position=\"first\")\nCO2.reset_index(drop=True, inplace=True)\nCO2.head(10)","7f9d4bf2":"# Corrige os \"missing values\" (NaN) nas vari\u00e1veis 'Year', 'Month' e 'Day'\n# recalculando-as a partir de 'DateTime'\nCO2[\"Year\" ] = CO2[\"DateTime\"].map(lambda x: x.year )\nCO2[\"Month\"] = CO2[\"DateTime\"].map(lambda x: x.month)\nCO2[\"Day\"  ] = CO2[\"DateTime\"].map(lambda x: x.day  )\n\nCO2.head(10)","59209062":"# Corrige os \"missing values\" nas tr\u00eas vari\u00e1veis de concentra\u00e7\u00e3o de CO2 usando INTERPOLA\u00c7\u00c3O\n# (a linha inicial de dados continuar\u00e1 com valore NaN por n\u00e3o ter valores antecedentes)\nfor p in [\"CO2_Global\", \"CO2_North\", \"CO2_South\"]:\n    CO2[p] = CO2[p].interpolate(method=\"linear\")\n\nCO2.head(10)","248cd35b":"# Substitui os \"missing values\" da linha inicial por interpola\u00e7\u00e3o retr\u00f3grada\nfor p in [\"CO2_Global\", \"CO2_North\", \"CO2_South\"]:\n    CO2.loc[0,p] = CO2.loc[2,p] - (CO2.loc[2,p] - CO2.loc[1,p]) * (2-0)\/(2-1)\n\nCO2.head(5)","6a6d7145":"# Cria um novo dataframe 'CARBON' contendo apenas os dados de CO2 referentes ao PRIMEIRO DIA DO M\u00caS,\n# seguindo o padr\u00e3o dos dados de temperatura.\nCARBON = CO2.loc[CO2[\"Day\"]==1].copy()\nCARBON.reset_index(drop=True, inplace=True)\nCARBON.drop([\"Day\"], axis=1, inplace=True)   # Descarta vari\u00e1veis desnecess\u00e1rias\n\nCARBON.head()","64ddc9ae":"# Verifica a faixa de tempo dos dados\nprint(\"Temperatura :   In\u00edcio em {}   T\u00e9rmino em {}   {:6d} Observa\u00e7\u00f5es\".format(  TEMP[\"DateTime\"].min(),   TEMP[\"DateTime\"].max(),   TEMP.shape[0]))\nprint(\"CO2         :   In\u00edcio em {}   T\u00e9rmino em {}   {:6d} Observa\u00e7\u00f5es\".format(CARBON[\"DateTime\"].min(), CARBON[\"DateTime\"].max(), CARBON.shape[0]))\nprint()","09432470":"# Visualiza os dados de incerteza de temperatura\n\nFig,(Ax1,Ax2,Ax3) = plt.subplots(1,3, figsize=(18,5))\nFig.suptitle(\"Incertezas na Temperatura\", fontsize=FontSize)\n\nAx1.plot(TEMP[\"DateTime\"],TEMP[\"TL_min_u\"],\"-\", color=\"blue\"  , lw=1.00)\nAx2.plot(TEMP[\"DateTime\"],TEMP[\"TL_avg_u\"],\"-\", color=\"purple\", lw=1.00)\nAx3.plot(TEMP[\"DateTime\"],TEMP[\"TL_max_u\"],\"-\", color=\"red\"   , lw=1.00)\n\nAx1.set_xlim(TEMP[\"DateTime\"].min(),TEMP[\"DateTime\"].max()); #Ax1.set_ylim(0,8)\nAx2.set_xlim(TEMP[\"DateTime\"].min(),TEMP[\"DateTime\"].max()); #Ax2.set_ylim(0,8)\nAx3.set_xlim(TEMP[\"DateTime\"].min(),TEMP[\"DateTime\"].max()); #Ax3.set_ylim(0,8)\n\nAx1.title.set_text(\"Incerteza Temp. M\u00ednima\")\nAx2.title.set_text(\"Incerteza Temp. M\u00e9dia\" )\nAx3.title.set_text(\"Incerteza Temp. M\u00e1xima\")\n\nAx1.set_xlabel(\"tempo\", fontsize=FontSize); Ax1.set_ylabel(\"Incerteza (oC)\", fontsize=FontSize)\nAx2.set_xlabel(\"tempo\", fontsize=FontSize); Ax2.set_ylabel(\"Incerteza (oC)\", fontsize=FontSize)\nAx3.set_xlabel(\"tempo\", fontsize=FontSize); Ax3.set_ylabel(\"Incerteza (oC)\", fontsize=FontSize)\n\nplt.show()","dd0b9bcb":"# Define o per\u00edodo de interesse\nTi = \"01\/01\/1900\"\nTf = \"01\/12\/2014\"\n\nTi = dt.datetime.strptime(Ti,\"%d\/%m\/%Y\").date()\nTf = dt.datetime.strptime(Tf,\"%d\/%m\/%Y\").date()\n\n# Seleciona os dados de temperatura no per\u00edodo de interesse\nTEMP = TEMP.loc[(Ti <= TEMP[\"DateTime\"]) & (TEMP[\"DateTime\"] <= Tf)]\nTEMP.reset_index(drop=True, inplace=True)\n\n# Seleciona os dados de CO2 no per\u00edodo de interesse\nCARBON = CARBON.loc[(Ti <= CARBON[\"DateTime\"]) & (CARBON[\"DateTime\"] <= Tf)]\nCARBON.reset_index(drop=True, inplace=True)","bb7eb6c6":"# Verifica a faixa de tempo dos dados\nprint(\"Temperatura :   In\u00edcio em {}   T\u00e9rmino em {}   {:6d} Observa\u00e7\u00f5es\".format(  TEMP[\"DateTime\"].min(),   TEMP[\"DateTime\"].max(),   TEMP.shape[0]))\nprint(\"CO2         :   In\u00edcio em {}   T\u00e9rmino em {}   {:6d} Observa\u00e7\u00f5es\".format(CARBON[\"DateTime\"].min(), CARBON[\"DateTime\"].max(), CARBON.shape[0]))\nprint()","7e822889":"TEMP.head()","6fa6f7dc":"CARBON.head()","169d6b93":"# Combina os dados de CO2 e Temperatura no dataset CARBON.\n# A coluna comum 'DateTime' \u00e9 usada como chave de jun\u00e7\u00e3o dos dados.\nCARBON = pd.merge(CARBON, TEMP, on=\"DateTime\", how=\"left\")\nCARBON.sort_values(by=[\"DateTime\"], axis=0, ascending=[True], inplace=True, na_position=\"first\")\nCARBON.reset_index(drop=True, inplace=True)\n\nCARBON.head(10)","32c27a4c":"Fig,(Ax1,Ax2,Ax3) = plt.subplots(1,3, figsize=(18,5))\nFig.suptitle(\"Concentra\u00e7\u00e3o de CO2 Atmosf\u00e9rico\", fontsize=FontSize)\n\nAx1.plot(CARBON[\"DateTime\"],CARBON[\"CO2_North\" ],\"-\", color=\"blue\"  , lw=1.00)\nAx2.plot(CARBON[\"DateTime\"],CARBON[\"CO2_Global\"],\"-\", color=\"purple\", lw=1.00)\nAx3.plot(CARBON[\"DateTime\"],CARBON[\"CO2_South\" ],\"-\", color=\"red\"   , lw=1.00)\n\nAx1.set_xlim(CARBON[\"DateTime\"].min(),CARBON[\"DateTime\"].max()); Ax1.set_ylim(280,410)\nAx2.set_xlim(CARBON[\"DateTime\"].min(),CARBON[\"DateTime\"].max()); Ax2.set_ylim(280,410)\nAx3.set_xlim(CARBON[\"DateTime\"].min(),CARBON[\"DateTime\"].max()); Ax3.set_ylim(280,410)\n\nAx1.title.set_text(\"Hemisf\u00e9rio Norte\")\nAx2.title.set_text(\"Global\")\nAx3.title.set_text(\"Hemisf\u00e9rio Sul\")\n\nAx1.set_xlabel(\"tempo\", fontsize=FontSize); Ax1.set_ylabel(\"CO2 (moles)\", fontsize=FontSize)\nAx2.set_xlabel(\"tempo\", fontsize=FontSize); Ax2.set_ylabel(\"CO2 (moles)\", fontsize=FontSize)\nAx3.set_xlabel(\"tempo\", fontsize=FontSize); Ax3.set_ylabel(\"CO2 (moles)\", fontsize=FontSize)\n\nplt.show()","b5be9840":"Fig,(Ax1,Ax2,Ax3) = plt.subplots(1,3, figsize=(18,5))\nFig.suptitle(\"Concentra\u00e7\u00e3o de CO2 Atmosf\u00e9rico\", fontsize=FontSize)\n\nAx1.plot(CARBON[\"DateTime\"],CARBON[\"CO2_North\" ],\"-\", color=\"blue\"  , lw=1.00)\nAx2.plot(CARBON[\"DateTime\"],CARBON[\"CO2_Global\"],\"-\", color=\"purple\", lw=1.00)\nAx3.plot(CARBON[\"DateTime\"],CARBON[\"CO2_South\" ],\"-\", color=\"red\"   , lw=1.00)\n\np = dt.datetime.strptime(\"01\/01\/1984\",\"%d\/%m\/%Y\").date()\nq = dt.datetime.strptime(\"01\/01\/2014\",\"%d\/%m\/%Y\").date()\n\nAx1.set_xlim(p,q); Ax1.set_ylim(330,410)\nAx2.set_xlim(p,q); Ax2.set_ylim(330,410)\nAx3.set_xlim(p,q); Ax3.set_ylim(330,410)\n\nAx1.title.set_text(\"Hemisf\u00e9rio Norte\")\nAx2.title.set_text(\"Global\")\nAx3.title.set_text(\"Hemisf\u00e9rio Sul\")\n\nAx1.set_xlabel(\"tempo\", fontsize=FontSize); Ax1.set_ylabel(\"CO2 (moles)\", fontsize=FontSize)\nAx2.set_xlabel(\"tempo\", fontsize=FontSize); Ax2.set_ylabel(\"CO2 (moles)\", fontsize=FontSize)\nAx3.set_xlabel(\"tempo\", fontsize=FontSize); Ax3.set_ylabel(\"CO2 (moles)\", fontsize=FontSize)\n\nplt.show()","58e85c28":"Target = \"CO2_Global\"\n\nDF  = CARBON[[\"DateTime\",Target]].copy()\nfoo = DF[\"DateTime\"].map(lambda x: dt.datetime.strptime(str(x),\"%Y-%m-%d\"))\nDF.index = list(foo)\n\nDecomposition = seasonal_decompose(x=DF[Target], model=\"additive\")  # model: \"additive\" ou \"multiplicative\"\n\nO = Decomposition.observed\nT = Decomposition.trend       # has NaN's at the start and end\nS = Decomposition.seasonal\nE = Decomposition.resid       # has NaN's at the start and end","38c45174":"Fig,((Ax1,Ax2),(Ax3,Ax4)) = plt.subplots(2,2, figsize=(18,6))\nFig.suptitle(\"Decomposi\u00e7\u00e3o da S\u00e9rie Temporal de CO2 Global\", fontsize=FontSize)\n\nAx1.plot(O.index,O,\"-\", color=\"teal\", lw=1.00)\nAx2.plot(T.index,T,\"-\", color=\"teal\", lw=1.00)\nAx3.plot(S.index,S,\"-\", color=\"teal\", lw=1.00)\nAx4.plot(E.index,E,\"-\", color=\"teal\", lw=1.00)\n\nAx1.set_xlim(O.index.min(),O.index.max()); Ax1.set_ylim(280,410)\nAx2.set_xlim(T.index.min(),T.index.max()); Ax2.set_ylim(280,410)\nAx3.set_xlim(S.index.min(),S.index.max()); Ax3.set_ylim(-4,4)\nAx4.set_xlim(E.index.min(),E.index.max()); Ax4.set_ylim(-4,4)\n\nAx1.set_xticks([])\nAx2.set_xticks([])\n\nAx1.title.set_text(\"Observado\")\nAx2.title.set_text(\"Tend\u00eancia\")\nAx3.title.set_text(\"Sazonalidade\")\nAx4.title.set_text(\"Erro \/ Res\u00edduo \/ Ru\u00eddo\")\n\nAx3.set_xlabel(\"tempo\", fontsize=FontSize)\nAx4.set_xlabel(\"tempo\", fontsize=FontSize)\n\nAx1.set_ylabel(\"CO2 (moles)\", fontsize=FontSize)\nAx2.set_ylabel(\"CO2 (moles)\", fontsize=FontSize)\nAx3.set_ylabel(\"CO2 (moles)\", fontsize=FontSize)\nAx4.set_ylabel(\"CO2 (moles)\", fontsize=FontSize)\n\nplt.show()","d032c81b":"Inicio   = [1900, 1925, 1950, 1975, 2000]\nFim      = [1925, 1950, 1975, 2000, 2015]\nPeriodos = [str(p)+\"-\"+str(q) for (p,q) in zip(Inicio,Fim)]\n\nEstatisticas = pd.DataFrame(data={\"Inicio\":Inicio, \"Fim\":Fim})\nEstatisticas[\"Media\"  ] = 0.0\nEstatisticas[\"DesvPad\"] = 0.0\n\nfor p,q in zip(Inicio,Fim):\n    DF = CARBON.loc[(p<=CARBON[\"Year\"]) & (CARBON[\"Year\"]<q), \"CO2_Global\"]\n    Estatisticas.loc[Estatisticas[\"Inicio\"]==p,\"Media\"  ] = DF.mean()\n    Estatisticas.loc[Estatisticas[\"Inicio\"]==p,\"DesvPad\"] = DF.std()\n\nFig,(Ax1,Ax2) = plt.subplots(1,2, figsize=(15,3))\nFig.suptitle(\"An\u00e1lise de Estacionariedade para a Concentrac\u00e3o de CO2\", fontsize=FontSize)\n\nAx1.plot(Periodos, Estatisticas[\"Media\"  ],\"o-\", color=\"teal\", lw=1.00)\nAx2.plot(Periodos, Estatisticas[\"DesvPad\"],\"o-\", color=\"teal\", lw=1.00)\n\nAx1.set_xticks(Periodos)\nAx2.set_xticks(Periodos)\n\nAx1.title.set_text(\"M\u00e9dia\")\nAx2.title.set_text(\"Desvio-Padr\u00e3o\")\n\nAx1.set_xlabel(\"Per\u00edodo\", fontsize=FontSize)\nAx2.set_xlabel(\"Per\u00edodo\", fontsize=FontSize)\n\nAx1.set_ylabel(\"CO2 (moles)\", fontsize=FontSize)\nAx2.set_ylabel(\"CO2 (moles)\", fontsize=FontSize)\n\nplt.show()","f6b6de5f":"Fig,(Ax1,Ax2) = plt.subplots(1,2, figsize=(18,5))\nFig.suptitle(\"Temperatura na Superf\u00edcie do Planeta\", fontsize=FontSize)\n\nAx1.plot(CARBON[\"DateTime\"],CARBON[\"TL_max\" ],\"-\", color=\"red\"   , lw=1.00)\nAx1.plot(CARBON[\"DateTime\"],CARBON[\"TL_avg\" ],\"-\", color=\"purple\", lw=1.00)\nAx1.plot(CARBON[\"DateTime\"],CARBON[\"TL_min\" ],\"-\", color=\"blue\"  , lw=1.00)\nAx2.plot(CARBON[\"DateTime\"],CARBON[\"TLO_avg\"],\"-\", color=\"teal\"  , lw=1.00)\n\nAx1.set_xlim(CARBON[\"DateTime\"].min(),CARBON[\"DateTime\"].max()); Ax1.set_ylim(-15,25)\nAx2.set_xlim(CARBON[\"DateTime\"].min(),CARBON[\"DateTime\"].max()); Ax2.set_ylim(-15,25)\n\nAx1.title.set_text(\"Temperatura em Terra\")\nAx2.title.set_text(\"Temperatura em Terra\/Oceanos\")\n\nAx1.set_xlabel(\"tempo\", fontsize=FontSize); Ax1.set_ylabel(\"Temperatura (oC)\", fontsize=FontSize)\nAx2.set_xlabel(\"tempo\", fontsize=FontSize); Ax2.set_ylabel(\"Temperatura (oC)\", fontsize=FontSize)\n\nAx1.legend(loc=\"lower right\", fontsize=12)\nAx2.legend(loc=\"lower right\", fontsize=12)\n\nplt.show()","8a63c5f6":"Fig,(Ax1,Ax2) = plt.subplots(1,2, figsize=(18,5))\nFig.suptitle(\"Temperatura na Superf\u00edcie do Planeta\", fontsize=FontSize)\n\nAx1.plot(CARBON[\"DateTime\"],CARBON[\"TL_max\" ],\"-\", color=\"red\"   , lw=1.00)\nAx1.plot(CARBON[\"DateTime\"],CARBON[\"TL_avg\" ],\"-\", color=\"purple\", lw=1.00)\nAx1.plot(CARBON[\"DateTime\"],CARBON[\"TL_min\" ],\"-\", color=\"blue\"  , lw=1.00)\nAx2.plot(CARBON[\"DateTime\"],CARBON[\"TLO_avg\"],\"-\", color=\"teal\"  , lw=1.00)\n\np = \"01\/01\/1984\";  p = dt.datetime.strptime(p,\"%d\/%m\/%Y\").date()\nq = \"01\/01\/2014\";  q = dt.datetime.strptime(q,\"%d\/%m\/%Y\").date()\n\nAx1.set_xlim(p,q); Ax1.set_ylim(-15,25)\nAx2.set_xlim(p,q); Ax2.set_ylim(-15,25)\n\nAx1.title.set_text(\"Temperatura em Terra\")\nAx2.title.set_text(\"Temperatura em Terra\/Oceanos\")\n\nAx1.set_xlabel(\"tempo\", fontsize=FontSize); Ax1.set_ylabel(\"Temperatura (oC)\", fontsize=FontSize)\nAx2.set_xlabel(\"tempo\", fontsize=FontSize); Ax2.set_ylabel(\"Temperatura (oC)\", fontsize=FontSize)\n\nAx1.legend(loc=\"lower right\", fontsize=12)\nAx2.legend(loc=\"lower right\", fontsize=12)\n\nplt.show()","01fe6dc7":"Target = \"TLO_avg\"\n\nDF  = CARBON[[\"DateTime\",Target]].copy()\nfoo = DF[\"DateTime\"].map(lambda x: dt.datetime.strptime(str(x),\"%Y-%m-%d\"))\nDF.index = list(foo)\n\nDecomposition = seasonal_decompose(x=DF[Target], model=\"additive\")  # model: \"additive\" ou \"multiplicative\"\n\nO = Decomposition.observed\nT = Decomposition.trend       # has NaN's at the start and end\nS = Decomposition.seasonal\nE = Decomposition.resid       # has NaN's at the start and end","a3b11c9b":"# Determina a linha de melhor ajuste (least squares) da componente de tend\u00eancia\n\nTendencia = pd.DataFrame(data={\"Trend\":T})\nTendencia[\"k\"] = list(range(0,len(T)))\n\nLSline = st.linregress(x = Tendencia.loc[Tendencia[\"Trend\"].notnull(),    \"k\"],\n                       y = Tendencia.loc[Tendencia[\"Trend\"].notnull(),\"Trend\"])\n\nTendencia[\"LSline\"] = LSline.slope*Tendencia[\"k\"] + LSline.intercept","2b5b93eb":"Fig,((Ax1,Ax2),(Ax3,Ax4)) = plt.subplots(2,2, figsize=(18,5))\nFig.suptitle(\"Decomposi\u00e7\u00e3o da S\u00e9rie Temporal de Temperatura Global\", fontsize=FontSize)\n\np = dt.datetime.strptime(\"01\/01\/1905\",\"%d\/%m\/%Y\").date()\n\nAx1.plot(O.index,O,\"-\", color=\"teal\"  , lw=1.00)\nAx2.plot(T.index,T,\"-\", color=\"teal\"  , lw=1.00)\nAx2.plot(Tendencia.index,Tendencia[\"LSline\"],\"-\", color=\"red\", lw=1.00)\nAx2.text(p,16.5,\"Aumento m\u00e9dio de {:.2f} oC\/d\u00e9cada\".format(12*10*LSline.slope), va=\"center\", ha=\"left\", color=\"red\", size=12)\nAx3.plot(S.index,S,\"-\", color=\"teal\"  , lw=1.00)\nAx4.plot(E.index,E,\"-\", color=\"teal\"  , lw=1.00)\n\nAx1.set_xlim(O.index.min(),O.index.max()); Ax1.set_ylim(12,18)\nAx2.set_xlim(T.index.min(),T.index.max()); Ax2.set_ylim(12,18)\nAx3.set_xlim(S.index.min(),S.index.max()); Ax3.set_ylim(-3,3)\nAx4.set_xlim(E.index.min(),E.index.max()); Ax4.set_ylim(-3,3)\n\nAx1.set_xticks([])\nAx2.set_xticks([])\n\nAx1.title.set_text(\"Observado\")\nAx2.title.set_text(\"Tend\u00eancia\")\nAx3.title.set_text(\"Sazonalidade\")\nAx4.title.set_text(\"Erro \/ Res\u00edduo \/ Ru\u00eddo\")\n\nAx3.set_xlabel(\"tempo\", fontsize=FontSize)\nAx4.set_xlabel(\"tempo\", fontsize=FontSize)\n\nAx1.set_ylabel(\"oC\", fontsize=FontSize)\nAx2.set_ylabel(\"oC\", fontsize=FontSize)\nAx3.set_ylabel(\"oC\", fontsize=FontSize)\nAx4.set_ylabel(\"oC\", fontsize=FontSize)\n\nplt.show()","a516e514":"Inicio   = [1900, 1925, 1950, 1975, 2000]\nFim      = [1925, 1950, 1975, 2000, 2015]\nPeriodos = [str(p)+\"-\"+str(q) for (p,q) in zip(Inicio,Fim)]\n\nEstatisticas = pd.DataFrame(data={\"Inicio\":Inicio, \"Fim\":Fim})\nEstatisticas[\"Media\"  ] = 0.0\nEstatisticas[\"DesvPad\"] = 0.0\n\nfor p,q in zip(Inicio,Fim):\n    DF = CARBON.loc[(p<=CARBON[\"Year\"]) & (CARBON[\"Year\"]<q), \"TLO_avg\"]\n    Estatisticas.loc[Estatisticas[\"Inicio\"]==p,\"Media\"  ] = DF.mean()\n    Estatisticas.loc[Estatisticas[\"Inicio\"]==p,\"DesvPad\"] = DF.std()\n\nFig,(Ax1,Ax2) = plt.subplots(1,2, figsize=(15,3))\nFig.suptitle(\"An\u00e1lise de Estacionariedade para a Temperatura Global\", fontsize=FontSize)\n\nAx1.plot(Periodos, Estatisticas[\"Media\"  ],\"o-\", color=\"teal\", lw=1.00)\nAx2.plot(Periodos, Estatisticas[\"DesvPad\"],\"o-\", color=\"teal\", lw=1.00)\n\nAx1.set_xticks(Periodos)\nAx2.set_xticks(Periodos)\n\nAx1.title.set_text(\"M\u00e9dia\")\nAx2.title.set_text(\"Desvio-Padr\u00e3o\")\n\nAx1.set_xlabel(\"Per\u00edodo\", fontsize=FontSize); Ax1.set_ylabel(\"oC\", fontsize=FontSize)\nAx2.set_xlabel(\"Per\u00edodo\", fontsize=FontSize); Ax2.set_ylabel(\"oC\", fontsize=FontSize)\n\nplt.show()","0b0946d5":"# Consolida os valores de temperatura ('TLO_avg') por ano ('Year') como m\u00e9dia ('mean') dos valores de cada m\u00eas ('Month')\nSazonalidadeAnual = pd.pivot_table(CARBON, values=\"TLO_avg\", index=\"Month\", columns=\"Year\", aggfunc=\"mean\")\nSazonalidadeAnual","b43cebf3":"# Calcula as m\u00e9dias mensais apra todos os anos\nSazonalidadeAnualMedia = SazonalidadeAnual.mean(axis=1)","bf596438":"Fig,(Ax1,Ax2) = plt.subplots(1,2, figsize=(15.5,4))\nFig.suptitle(\"Temperaturas Mensais (1900 a 2014)\", fontsize=FontSize)\n\nAx1.plot(SazonalidadeAnual)\nAx2.plot(SazonalidadeAnualMedia)\n\nAx1.set_xticks(list(range(0,14))); Ax1.set_xlim(1,12); Ax1.set_ylim(12,18)\nAx2.set_xticks(list(range(0,14))); Ax2.set_xlim(1,12); Ax2.set_ylim(12,18)\n\nAx1.title.set_text(\"Todos os Anos\")\nAx2.title.set_text(\"M\u00e9dia Geral\" )\n\nAx1.set_xlabel(\"M\u00eas\", fontsize=FontSize); Ax1.set_ylabel(\"Temperatura (oC)\", fontsize=FontSize)\nAx2.set_xlabel(\"M\u00eas\", fontsize=FontSize); Ax2.set_ylabel(\"Temperatura (oC)\", fontsize=FontSize)\n\nplt.show()","537f2c02":"Temp_Media_Plurianual = pd.pivot_table(CARBON, values=\"TLO_avg\", index=\"Year\", aggfunc=\"mean\")\n\nN = 10   # Per\u00edodo plurianual (anos)\n\nTemp_Media_Plurianual[\"Media_Movel_Plurianual\"] = Temp_Media_Plurianual[\"TLO_avg\"].rolling(N).mean()\n\nTemp_Media_Plurianual = Temp_Media_Plurianual.iloc[N:]   # Descarta os primeiros N valores, pois s\u00e3o NaN","d112b0b3":"plt.figure(figsize=(7,4))\nplt.plot(Temp_Media_Plurianual.index,Temp_Media_Plurianual[               \"TLO_avg\"],\"-\", color=\"silver\", lw=1.25, label=\"Temp. M\u00e9dia\")\nplt.plot(Temp_Media_Plurianual.index,Temp_Media_Plurianual[\"Media_Movel_Plurianual\"],\"-\", color=\"red\"   , lw=1.50, label=\"Temp. M\u00e9dia M\u00f3vel\")\nplt.title(\"Evolu\u00e7\u00e3o da Temperatura M\u00e9dia M\u00f3vel\")\nplt.xlabel(\"Ano\", fontsize=FontSize)\nplt.ylabel(\"Temperatura (oC)\", fontsize=FontSize)\nplt.legend(loc=\"best\")\nplt.show()","bd432479":"CO2_Medio_Plurianual = pd.pivot_table(CARBON, values=\"CO2_Global\", index=\"Year\", aggfunc=\"mean\")\n\nCO2_Medio_Plurianual[\"Media_Movel_Plurianual\"] = CO2_Medio_Plurianual[\"CO2_Global\"].rolling(N).mean()\n\nCO2_Medio_Plurianual = CO2_Medio_Plurianual.iloc[N:]   # Descarta os primeiros N valores, pois s\u00e3o NaN","5143baaf":"plt.figure(figsize=(7,4))\nplt.plot(CO2_Medio_Plurianual.index,CO2_Medio_Plurianual[            \"CO2_Global\"],\"-\", color=\"silver\", lw=1.25, label=\"CO2 M\u00e9dio\")\nplt.plot(CO2_Medio_Plurianual.index,CO2_Medio_Plurianual[\"Media_Movel_Plurianual\"],\"-\", color=\"red\"   , lw=1.50, label=\"CO2 M\u00e9dio M\u00f3vel\")\nplt.title(\"Evolu\u00e7\u00e3o do CO2 M\u00e9dio M\u00f3vel\")\nplt.xlabel(\"Ano\", fontsize=FontSize)\nplt.ylabel(\"CO2 (moles)\", fontsize=FontSize)\nplt.legend(loc=\"best\")\nplt.show()","386bb36f":"p = CARBON[\"CO2_Global\"]\nq = CARBON[\"TLO_avg\"]\n\nplt.figure(figsize=(5,5))\nplt.plot(p,q,\".\", color=\"royalblue\")\nplt.xlabel(\"CO2 Mensal\", fontsize=FontSize)\nplt.ylabel(\"Temperatura Global Mensal\", fontsize=FontSize)\nplt.title(\"CO2 x Temperatura Global\\n(Mensal)\")\nplt.show()","4d90363f":"p =  CO2_Medio_Plurianual[\"Media_Movel_Plurianual\"]\nq = Temp_Media_Plurianual[\"Media_Movel_Plurianual\"]\nr = np.corrcoef(p,q)[0,1]\n\nplt.figure(figsize=(5,5))\nplt.plot(p,q,\".\", color=\"blue\")\nplt.xlabel(\"CO2 M\u00e9dio Plurianual\", fontsize=FontSize)\nplt.ylabel(\"Temperatura Global M\u00e9dia Plurianual\", fontsize=FontSize)\nplt.title(\"CO2 x Temperatura Global\\n(M\u00e9dia M\u00f3vel Plurianual)\")\nplt.text(325,15.7,\"Correla\u00e7\u00e3o: {:.2f}\".format(r), va=\"center\", ha=\"center\", size=14, color=\"blue\")\nplt.show()","6d891394":"ti = dt.datetime.strptime(\"01\/01\/1975\",\"%d\/%m\/%Y\").date()\n\nDADOS = CARBON[CARBON[\"DateTime\"]>=ti].copy()\nDADOS.reset_index(drop=True, inplace=True)\n\n# Verifica a faixa de tempo dos dados\nprint(\"In\u00edcio em {}   T\u00e9rmino em {}   {:6d} Observa\u00e7\u00f5es\".format(DADOS[\"DateTime\"].min(), DADOS[\"DateTime\"].max(), DADOS.shape[0]))\nprint()\n\nti = DADOS[\"DateTime\"].min()\ntf = DADOS[\"DateTime\"].max()\n\nFontSize = 14\nplt.figure(figsize=(15,4))\nplt.plot(DADOS[\"DateTime\"],DADOS[\"TLO_avg\"],\"-\", color=\"purple\", lw=1.00)\nplt.xlim(ti,tf)\nplt.ylim(10,20)\nplt.title(\"Temperatura Global em Terra\/Oceanos\")\nplt.xlabel(\"tempo\", fontsize=FontSize)\nplt.ylabel(\"Temperatura (oC)\", fontsize=FontSize)\nplt.show()","1c9cde68":"N      = CARBON.shape[0]\nTarget = \"TLO_avg\"\n\nLagsToPlot = 48\n\nFig = plt.figure(figsize=(28,8))\nAx1 = plt.subplot2grid((2,3), (0,0), colspan=2)\nAx2 = plt.subplot2grid((2,3), (1,0))\nAx3 = plt.subplot2grid((2,3), (1,1))\n\nAx1.plot(CARBON[Target])\nAx1.set_xlim(-20,N+20)\nAx1.set_ylabel(\"oC\")\nAx1.set_title(\"Temperatura M\u00e9dia Global\")\nplot_acf( CARBON[Target], lags=LagsToPlot, zero=False, ax=Ax2)\nplot_pacf(CARBON[Target], lags=LagsToPlot, zero=False, ax=Ax3)\nplt.show()","3c5f9be6":"N  = CARBON.shape[0]\nNp = 12\n\nCARBON[\"TLO_avg_diff\"] = CARBON[\"TLO_avg\"].diff(periods=Np)   # time serie diferrenced by 'Np' periods\n\n# Exclude NaN values\nFlag = [False]*Np+[True]*(N-Np)\nfoo  = CARBON.loc[Flag,\"TLO_avg_diff\"]\n\nACF_Diff = ACF(x=foo, nlags=N, fft=True)   # Auto-Correlation of the differenced series\n\nLagsToPlot = 48\n\nFig = plt.figure(figsize=(28,8))\nAx1 = plt.subplot2grid((2,3), (0,0), colspan=2)\nAx2 = plt.subplot2grid((2,3), (1,0))\nAx3 = plt.subplot2grid((2,3), (1,1))\n\nAx1.plot(foo)\nAx1.set_xlim(-20,N+20)\nAx1.set_ylabel(\"oC\")\nAx1.set_title(\"Temperatura M\u00e9dia Global (DIFERENCIADA)\")\nplot_acf( foo, lags=LagsToPlot, zero=False, ax=Ax2)\nplot_pacf(foo, lags=LagsToPlot, zero=False, ax=Ax3)\nplt.show()","da64d604":"Target = \"TLO_avg\"\n\nOrder = (3,1,0)   # Ordem ARIMA (p,d,q)\n\nDF = DADOS[[\"DateTime\",Target]].copy()\n\nDF[\"Prediction\"] = 0.0   # Coluna para as predi\u00e7\u00f5es\nDF[\"E\" ]         = 0.0   # Coluna para os erros de predi\u00e7\u00e3o\n\nN       = DF.shape[0]\nn       = 36                   # N\u00famero de meses para predi\u00e7\u00e3o\nIndTest = list(range(N-n,N))   # \u00cdndices dos dados de teste para predi\u00e7\u00e3o\n\nfor k in IndTest:\n    IndTrain = list(range(0,k))          # Primeiros k-1 \u00edndices (0 ~ k-1)\n    XTrain   = DF.loc[IndTrain,Target]   # Primeiras k-1 observa\u00e7\u00f5es para calibrar o modelo\n    #\n    TS = ARIMA(endog=XTrain, order=Order, exog=None, dates=None, freq=None, missing=\"none\")\n    M  = TS.fit()\n    #\n    Forecast = M.forecast()\n    Forecast.reset_index(drop=True, inplace=True)\n    DF.loc[k,\"Prediction\"] = Forecast[0]   # Predi\u00e7\u00e3o para a observa\u00e7\u00e3o corrente k\n\nfor k in IndTest:\n    DF.loc[k,\"E\" ] = DF.loc[k,\"Prediction\"] - DF.loc[k,Target]","20521bfa":"plt.figure(figsize=(15,4))\nplt.plot(DF.index,DF[Target], \"o-\", color=\"royalblue\", alpha=1.00, lw=0.75, markersize=3, label=\"Real\")\nplt.plot(IndTest,DF.loc[(N-n):N,\"Prediction\"], \"o-\", color=\"black\", alpha=1.00, markersize=3, label=\"Predito\")\nplt.xlim(N-n-1-5,N)\nplt.ylim(13,18.5)\nplt.xlabel(\"item da s\u00e9rie\", fontsize=FontSize)\nplt.ylabel(\"Temperatura (oC)\", fontsize=FontSize)\nplt.title(\"Predi\u00e7\u00f5es por modelo ARIMA{} para {:s}\".format(Order,Target), fontsize=FontSize)\nplt.legend(loc=\"upper right\")\nplt.show()","66be3174":"MSE = mean( [x**2 for x in DF.loc[IndTest,\"E\"]] )\nR2  = st.pearsonr(DF.loc[IndTest,\"Prediction\"],DF.loc[IndTest,Target])[0]\n\nprint(\"Erro Quadr\u00e1tico M\u00e9dio de Predi\u00e7\u00e3o: {:.3f}\".format(MSE))\nprint(\"Correla\u00e7\u00e3o entre Observado x Predito: {:.3f}\".format(R2))\nprint()","b1bf8a13":"Target = \"TLO_avg\"\n\nOrder  = (3,1,0)      # Ordem ARIMA (p,d,q)\nSOrder = (1,1,0,12)   # Ordem SARIMA (P,D,Q,m)\n\nDF = DADOS[[\"DateTime\",Target]].copy()\n\nDF[\"Prediction\"] = 0.0   # Coluna para as predi\u00e7\u00f5es\nDF[\"E\" ]         = 0.0   # Coluna para os erros de predi\u00e7\u00e3o\n\nN       = DF.shape[0]\nn       = 36                   # N\u00famero de meses para predi\u00e7\u00e3o\nIndTest = list(range(N-n,N))   # \u00cdndices dos dados de teste para predi\u00e7\u00e3o\n\nfor k in IndTest:\n    IndTrain = list(range(0,k))          # Primeiros k-1 \u00edndices (0 ~ k-1)\n    XTrain   = DF.loc[IndTrain,Target]   # Primeiras k-1 observa\u00e7\u00f5es para calibrar o modelo\n    XTrain.index = DF.loc[IndTrain,\"DateTime\"]\n    #\n    TS = SARIMAX(endog=XTrain, exog=None, order=Order, seasonal_order=SOrder, freq=\"MS\", missing=\"none\")\n    M  = TS.fit(disp=0)\n    #\n    Forecast = M.forecast()\n    Forecast.reset_index(drop=True, inplace=True)\n    DF.loc[k,\"Prediction\"] = Forecast[0]   # Predi\u00e7\u00e3o para a observa\u00e7\u00e3o corrente k\n\nfor k in IndTest:\n    DF.loc[k,\"E\" ] = DF.loc[k,\"Prediction\"] - DF.loc[k,Target]","41891cec":"plt.figure(figsize=(15,4))\nplt.plot(DF.index,DF[Target], \"o-\", color=\"royalblue\", alpha=1.00, lw=0.75, markersize=3, label=\"Real\")\nplt.plot(IndTest,DF.loc[(N-n):N,\"Prediction\"], \"o-\", color=\"black\", alpha=1.00, markersize=3, label=\"Predito\")\nplt.xlim(N-n-1-5,N)\nplt.ylim(13,18.5)\nplt.xlabel(\"item da s\u00e9rie\", fontsize=FontSize)\nplt.ylabel(\"Temperatura (oC)\", fontsize=FontSize)\nplt.title(\"Predi\u00e7\u00f5es por modelo SARIMA{}{} para {:s}\".format(Order,SOrder,Target), fontsize=FontSize)\nplt.legend(loc=\"upper right\")\nplt.show()","f2646e9e":"MSE = mean( [x**2 for x in DF.loc[IndTest,\"E\"]] )\nR2  = st.pearsonr(DF.loc[IndTest,\"Prediction\"],DF.loc[IndTest,Target])[0]\n\nprint(\"Erro Quadr\u00e1tico M\u00e9dio de Predi\u00e7\u00e3o: {:.4f}\".format(MSE))\nprint(\"Correla\u00e7\u00e3o entre Observado x Predito: {:.4f}\".format(R2))\nprint()","4a950686":"N      = CARBON.shape[0]\nTarget = \"CO2_Global\"\n\nLagsToPlot = 48\n\nFig = plt.figure(figsize=(28,8))\nAx1 = plt.subplot2grid((2,3), (0,0), colspan=2)\nAx2 = plt.subplot2grid((2,3), (1,0))\nAx3 = plt.subplot2grid((2,3), (1,1))\n\nAx1.plot(CARBON[Target])\nAx1.set_xlim(-20,N+20)\nAx1.set_ylabel(\"oC\")\nAx1.set_title(\"Temperatura M\u00e9dia Global\")\nplot_acf( CARBON[Target], lags=LagsToPlot, zero=False, ax=Ax2)\nplot_pacf(CARBON[Target], lags=LagsToPlot, zero=False, ax=Ax3)\nplt.show()","8b5d65ba":"Target = \"CO2_Global\"\n\nOrder  = (1,1,0)      # Ordem ARIMA (p,d,q)\nSOrder = (1,1,0,12)   # Ordem SARIMA (P,D,Q,m)\n\nDF = DADOS[[\"DateTime\",Target]].copy()\n\nDF[\"Prediction\"] = 0.0   # Coluna para as predi\u00e7\u00f5es\nDF[\"E\" ]         = 0.0   # Coluna para os erros de predi\u00e7\u00e3o\n\nN       = DF.shape[0]\nn       = 36                   # N\u00famero de meses para predi\u00e7\u00e3o\nIndTest = list(range(N-n,N))   # \u00cdndices dos dados de teste para predi\u00e7\u00e3o\n\nfor k in IndTest:\n    IndTrain = list(range(0,k))          # Primeiros k-1 \u00edndices (0 ~ k-1)\n    XTrain   = DF.loc[IndTrain,Target]   # Primeiras k-1 observa\u00e7\u00f5es para calibrar o modelo\n    XTrain.index = DF.loc[IndTrain,\"DateTime\"]\n    #\n    TS = SARIMAX(endog=XTrain, exog=None, order=Order, seasonal_order=SOrder, freq=\"MS\", missing=\"none\")\n    M  = TS.fit(disp=0)\n    #\n    Forecast = M.forecast()\n    Forecast.reset_index(drop=True, inplace=True)\n    DF.loc[k,\"Prediction\"] = Forecast[0]   # Predi\u00e7\u00e3o para a observa\u00e7\u00e3o corrente k\n\nfor k in IndTest:\n    DF.loc[k,\"E\" ] = DF.loc[k,\"Prediction\"] - DF.loc[k,Target]","d6419af7":"plt.figure(figsize=(15,4))\nplt.plot(DF.index,DF[Target], \"o-\", color=\"royalblue\", alpha=1.00, lw=0.75, markersize=3, label=\"Real\")\nplt.plot(IndTest,DF.loc[(N-n):N,\"Prediction\"], \"o-\", color=\"black\", alpha=1.00, markersize=3, label=\"Predito\")\nplt.xlim(N-n-1-5,N)\nplt.ylim(388,400)\nplt.xlabel(\"item da s\u00e9rie\", fontsize=FontSize)\nplt.ylabel(\"Temperatura (oC)\", fontsize=FontSize)\nplt.title(\"Predi\u00e7\u00f5es por modelo SARIMA{}{} para {:s}\".format(Order,SOrder,Target), fontsize=FontSize)\nplt.legend(loc=\"lower right\")\nplt.show()","9cfd0633":"MSE = mean( [x**2 for x in DF.loc[IndTest,\"E\"]] )\nR2  = st.pearsonr(DF.loc[IndTest,\"Prediction\"],DF.loc[IndTest,Target])[0]\n\nprint(\"Erro Quadr\u00e1tico M\u00e9dio de Predi\u00e7\u00e3o: {:.4f}\".format(MSE))\nprint(\"Correla\u00e7\u00e3o entre Observado x Predito: {:.4f}\".format(R2))\nprint()","6a83b421":"Target  = \"TLO_avg\"\nSupport = \"CO2_Global\"\n\nOrder  = (3,1,0)      # Ordem ARIMA (p,d,q)\nSOrder = (1,1,0,12)   # Ordem SARIMA (P,D,Q,m)\n\nDF = DADOS[[\"DateTime\",Support,Target]].copy()\n\nDF[\"Prediction\"] = 0.0   # Coluna para as predi\u00e7\u00f5es\nDF[\"E\" ]         = 0.0   # Coluna para os erros de predi\u00e7\u00e3o\n\nN       = DF.shape[0]\nn       = 36                   # N\u00famero de meses para predi\u00e7\u00e3o\nIndTest = list(range(N-n,N))   # \u00cdndices dos dados de teste para predi\u00e7\u00e3o\n\nfor k in IndTest:\n    IndTrain = list(range(0,k))          # Primeiros k-1 \u00edndices (0 ~ k-1)\n    XTrain   = DF.loc[IndTrain,Target]   # Primeiras k-1 observa\u00e7\u00f5es para calibrar o modelo\n    XTrain.index = DF.loc[IndTrain,\"DateTime\"]\n    ZTrain   = DF.loc[IndTrain,\"CO2_Global\"]   # Primeiras k-1 observa\u00e7\u00f5es para calibrar o modelo\n    z = DF.loc[k,\"CO2_Global\"]   # Pr\u00f3ximo valor de suporte para uso em predi\u00e7\u00e3o\n    ZTrain.index = DF.loc[IndTrain,\"DateTime\"]\n    #\n    TS = SARIMAX(endog=XTrain, exog=ZTrain, order=Order, seasonal_order=SOrder, freq=\"MS\", missing=\"none\")\n    M  = TS.fit(disp=0)\n    #\n    Forecast = M.forecast(exog=[[z]])   # Predi\u00e7\u00e3o considera o valor de suporte\n    Forecast.reset_index(drop=True, inplace=True)\n    DF.loc[k,\"Prediction\"] = Forecast[0]   # Predi\u00e7\u00e3o para a observa\u00e7\u00e3o corrente k\n\nfor k in IndTest:\n    DF.loc[k,\"E\" ] = DF.loc[k,\"Prediction\"] - DF.loc[k,Target]","2374c2db":"plt.figure(figsize=(15,4))\nplt.plot(DF.index,DF[Target], \"o-\", color=\"royalblue\", alpha=1.00, lw=0.75, markersize=3, label=\"Real\")\nplt.plot(IndTest,DF.loc[(N-n):N,\"Prediction\"], \"o-\", color=\"black\", alpha=1.00, markersize=3, label=\"Predito\")\nplt.xlim(N-n-1-5,N)\nplt.ylim(13.5,18)\nplt.xlabel(\"item da s\u00e9rie\", fontsize=FontSize)\nplt.ylabel(\"Temperatura (oC)\", fontsize=FontSize)\nplt.title(\"Predi\u00e7\u00f5es por modelo SARIMAX{}{} para {:s}\".format(Order,SOrder,Target), fontsize=FontSize)\nplt.legend(loc=\"upper right\")\nplt.show()","9932fc9f":"MSE = mean( [x**2 for x in DF.loc[IndTest,\"E\"]] )\nR2  = st.pearsonr(DF.loc[IndTest,\"Prediction\"],DF.loc[IndTest,Target])[0]\n\nprint(\"Erro Quadr\u00e1tico M\u00e9dio de Predi\u00e7\u00e3o: {:.4f}\".format(MSE))\nprint(\"Correla\u00e7\u00e3o entre Observado x Predito: {:.4f}\".format(R2))\nprint()","530e94b9":"<font color='blue'>\n\n### Combina os datasets de temperatura e CO<sub>2<\/sub> em um dataset \u00fanico\n<font color>","dc935784":"Nos \u00faltimos anos, os termos \"**aquecimento global**\", \"**efeito estufa**\" e \"**mudan\u00e7as clim\u00e1ticas**\" t\u00eam sido cada vez mais frequentes. In\u00fameros estudos realizados ao redor do mundo indicam que nosso planeta vem sofrendo uma gradual tend\u00eancia de aquecimento ao longo dos anos, atibu\u00edda pricipalmente ao aumento dos n\u00edveis de di\u00f3xido de carbono (CO<sub>2<\/sub>) na atmosfera, causado pela cont\u00ednua queima de combust\u00edveis f\u00f3sseis por ve\u00edculos e ind\u00fastrias, al\u00e9m da queima de carv\u00e3o mineral para gera\u00e7\u00e3o de energia el\u00e9trica. Especialistas afirmam que pequenos aumentos na temperatura m\u00e9dia da Terra favorecem efeitos adversos como:\n* Aumento da temperatura m\u00e9dia do planeta.\n* Aumento do n\u00edvel do mar, devido ao derretimento das geleiras polares.\n* Aumento na intensidade e frequ\u00eancia de cat\u00e1strofes clim\u00e1ticas como furac\u00f5es, tempestades e enchentes.\n* Danos aos ecossistemas do planeta e extin\u00e7\u00e3o de esp\u00e9cies.","99503ff0":"O gr\u00e1fico de dispers\u00e3o acima n\u00e3o mostra de forma clara uma poss\u00edvel rela\u00e7\u00e3o entre a concentra\u00e7\u00e3o de CO<sub>2<\/sub> e a temperatura a n\u00edvel **mensal**. Entretanto, percebe-se que os dados mensais no gr\u00e1fico distribuem-se em tr\u00eas grupos de pontos, um superior, um intermedi\u00e1rio e outro inferior, todos com uma certa correla\u00e7\u00e3o positiva. Tal padr\u00e3o de dispers\u00e3o costuma ocorrer com vari\u00e1veis que possuem alguma lat\u00eancia (atraso de tempo) entre si. Por exemplo, mudan\u00e7as no valor de uma vari\u00e1vel $x$ podem estar associadas a mudan\u00e7as no valor de uma vari\u00e1vel $y$ ap\u00f3s um certo atraso de tempo (dias, meses, ou anos).\n\nUma maneira de investigar a poss\u00edvel correla\u00e7\u00e3o entre vari\u00e1veis com lat\u00eancia entre si \u00e9 construindo o gr\u00e1fico de dispers\u00e3o entre suas m\u00e9dias m\u00f3veis. Isto \u00e9 feito a seguir.","5b01523c":"Uma forma alternativa de visualizar a sazonalidade anual de uma vari\u00e1vel \u00e9 superpondo seus valores mensais em um \u00fanico gr\u00e1fico cobrindo o per\u00edodo sazonal (12 meses). Isto \u00e9 feito a seguir.","d60cfb03":"Pelos resultados acima, o modelo **SARIMA** obteve desempenho excelente na predi\u00e7\u00e3o dos valores de concentra\u00e7\u00e3o de CO<sub>2<\/sub> atmosf\u00e9rico, com erro quadr\u00e1tico m\u00e9dio bastante pequeno e correla\u00e7\u00e3o quase unit\u00e1ria.","adb377aa":"Os dados de concentra\u00e7\u00e3o de CO<sub>2<\/sub> s\u00e3o completos e n\u00e3o possuem *missing values*.","beaedfc3":"At\u00e9 aqui, temos um dataset de temperatura e outro de CO<sub>2<\/sub> com dados organizados e ordenados, mas cobrindo per\u00edodos de tempos diferentes, conforme as datas de in\u00edcio e t\u00e9rmino mostradas acima. \u00c9 necess\u00e1rio **definir um per\u00edodo de tempo comum** contendo dados dos dois datasets. Uma boa maneira de escolher esse per\u00edodo de tempo \u00e9 considerando as vari\u00e1veis de incerteza de temperatura.","09ffe5e4":"Diferentemente da s\u00e9rie de temperatura m\u00e9dia global, que apresenta uma auto-correla\u00e7\u00e3o oscilat\u00f3ria devido \u00e0 preval\u00eancia da componente sazonal em rela\u00e7\u00e3o \u00e0 componente de tend\u00eancia dessa s\u00e9rie, a autocorrela\u00e7\u00e3o da s\u00e9rie de concentra\u00e7\u00e3o de CO<sub>2<\/sub> atmosf\u00e9rico tem um perfil suave e n\u00e3o oscilat\u00f3rio devido \u00e0 preval\u00eancia da componente de tend\u00eancia em rela\u00e7\u00e3o \u00e0 componente sazonal, conforme observado na An\u00e1lise Explorat\u00f3ria. Al\u00e9m disso, o perfil decrescente da auto-correla\u00e7\u00e3o indica que a s\u00e9rie de concentra\u00e7\u00e3o de CO<sub>2<\/sub> atmosf\u00e9rico **n\u00e3o \u00e9 estacion\u00e1ria**, o que j\u00e1 foi verificado antes.\n\nO valor inicial positivo da autocorrela\u00e7\u00e3o indica que a s\u00e9rie de concentra\u00e7\u00e3o de CO<sub>2<\/sub> atmosf\u00e9rico pode ser modelada com um termo do tipo auto-regressivo (AR).","d360b51a":"Os modelos ARIMA e SARIMA desenvolvidos anteriormente para as s\u00e9ries de temperatura e concentra\u00e7\u00e3o de CO<sub>2<\/sub> consideram apenas os valores passados da s\u00e9rie temporal. Tamb\u00e9m \u00e9 poss\u00edvel modelar uma s\u00e9rie temporal com base n\u00e3o apenas em seus valores passados, mas incluindo uma ou mais **vari\u00e1veis correlatas**, que servem como **s\u00e9ries de suporte** \u00e0 modelagem da s\u00e9rie principal. Os modelos **ARIMAX** (ARIMA with exogenous input) e **SARIMAX** (Seasonal ARIMA with exogenous input) implementam esse tipo de modelagem.\n\nA seguir \u00e9 desenvolvido um modelo **SARIMAX** para a s\u00e9rie de temperatura m\u00e9dia global usando a concentra\u00e7\u00e3o de CO<sub>2<\/sub> como s\u00e9rie de suporte. O uso da concentra\u00e7\u00e3o de CO<sub>2<\/sub> como s\u00e9rie de suporte se justifica devido \u00e0 correla\u00e7\u00e3o observada com a s\u00e9rie de temperature m\u00e9dia global. As predi\u00e7\u00f5es ser\u00e3o calculadas um passo \u00e0 frente.","73c8b284":"Claramente, as oscila\u00e7\u00f5es indicam a exist\u00eancia de uma **sazonalidade** aual na concentra\u00e7\u00e3o de CO<sub>2<\/sub> atmosf\u00e9rico.","166163b0":"Pelos gr\u00e1ficos acima, tanto a m\u00e9dia quanto o desvio-padr\u00e3o da concentra\u00e7\u00e3o global m\u00e9dia de CO<sub>2<\/sub> atmosf\u00e9rico n\u00e3o s\u00e3o constantes ao longo do per\u00edodo considerado (1900 a 2014) e apresentam varia\u00e7\u00f5es significativas ntre per\u00edodos de tempo menores. Portanto, a s\u00e9rie temporal de concentra\u00e7\u00e3o global m\u00e9dia de CO<sub>2<\/sub> atmosf\u00e9rico **n\u00e3o \u00e9 estacion\u00e1ria no per\u00edodo considerado**.","e33c726e":"<hr><font color='blue'>\n\n### Prepara\u00e7\u00e3o computacional\n<font color>","ebcc7d0d":"Neste Jupyter Notebook foi desenvolvido um processo de An\u00e1lise de Dados e Modelagem Preditiva destinado a caracterizar o relacionamento entre a **temperatura na superf\u00edcie da Terra** e a **concentra\u00e7\u00e3o de CO<sub>2<\/sub> atmosf\u00e9rico**, com base nas caracter\u00edsticas temporais dessas vari\u00e1veis.","2bc3d530":"#### Vis\u00e3o condensada da Sazonalidade","35daea14":"O modelo ARIMA foi criado para a vari\u00e1vel \"Temperatura M\u00e9dia Global em Terra\/Oceanos\" (TLO_avg). Modelos similares podem ser criados facilmente para as demais vari\u00e1veis de temperatura (TL_min, TL_avg e TL_max) executando-se os c\u00f3digos de modelagem acima para a vari\u00e1vel de interesse. Isto ser\u00e1 deixado como exerc\u00edcio para o usu\u00e1rio, e n\u00e3o ser\u00e1 feito aqui apenas para n\u00e3o tornar este Notebook demasiadamente extenso.","ca4d35b7":"Pelos gr\u00e1ficos acima, tanto a m\u00e9dia quanto o desvio-padr\u00e3o da temperatura global n\u00e3o s\u00e3o constantes ao longo do per\u00edodo considerado (1900 a 2014) e apresentam varia\u00e7\u00f5es significativas. Portanto, a s\u00e9rie temporal de temperatura global **n\u00e3o \u00e9 estacion\u00e1ria no per\u00edodo considerado**.","e3211bbc":"A componente de tend\u00eancia (gr\u00e1fico superior direito) segue a evolu\u00e7\u00e3o geral da s\u00e9rie (grafico superior esquerdo). A componente sazonal tem aspecto bem regular. A concentra\u00e7\u00e3o de CO<sub>2<\/sub> atmosf\u00e9rico **n\u00e3o \u00e9 estacion\u00e1ria no per\u00edodo de tempo considerado** devido apresentar tend\u00eancia, bem como por n\u00e3o ter res\u00edduo com vari\u00e2ncia constante.\n\nA seguir \u00e9 feita uma an\u00e1lise mais formal da estacionariedade desse s\u00e9rie.","cf8c0720":"Os resultados acima tamb\u00e9m mostram claramente a sazonalidade anual existente na temperatura. **Os dados indicam que a Terra \u00e9 mais quente entre os meses de Junho e Agosto, e mais fria entre os meses de Dezembro e Fevereiro**.\n\nCuriosamente, os resultados acima **n\u00e3o** condizem com as expectativas de calor\/frio associadas \u00e0s posi\u00e7\u00f5es de maior aproxima\u00e7\u00e3o (**peri\u00e9lio** \/ mais calor) e maior afastamento (**af\u00e9lio** \/ mais frio) da Terra em rela\u00e7\u00e3o ao Sol, que ocorrem respectivamente nos meses Janeiro e Julho. Entretanto, essa constata\u00e7\u00e3o n\u00e3o tem relev\u00e2ncia para o estudo em quest\u00e3o, que trata da rela\u00e7\u00e3o entre a temperatura global e a concentra\u00e7\u00e3o de CO<sub>2<\/sub> atmosf\u00e9rico.","84e0cd1e":"Curiosamente, os valores de concentra\u00e7\u00e3o de CO<sub>2<\/sub> para o hemisf\u00e9rio Sul (gr\u00e1fico direito) apresentam varia\u00e7\u00f5es mais suaves que as observadas para o hemisf\u00e9rio Norte e para a m\u00e9dia global da Terra. Entretanto, os dados por si s\u00f3 n\u00e3o permitem identificar a causa da suporta falta de oscila\u00e7\u00f5es sazonais na concentra\u00e7\u00e3o de CO<sub>2<\/sub> no hemisf\u00e9rio Sul.","d2fbd616":"<hr><font color='blue'>\n\n### Refer\u00eancias\n<font color>","4196bf17":"Observam-se claramente oscila\u00e7\u00f5es de **sazonalidade** anual na temperatura. Tais oscila\u00e7\u00f5es s\u00e3o mais intensas que as observadas para a concentra\u00e7\u00e3o de CO<sub>2<\/sub>.\n\nAo contr\u00e1rio da s\u00e9rie temporal de concentra\u00e7\u00e3o de CO<sub>2<\/sub>, as s\u00e9ries temporais de temperatura n\u00e3o mostram uma tend\u00eancia forte de aumento, mas sim uma tend\u00eancia sutil, dif\u00edcil de ser percebida graficamente em per\u00edodos de tempo menores (de poucos anos), pois a tend\u00eancia \u00e9 ofuscada pelas fortes oscila\u00e7\u00f5es sazonais de temperatura.\n\nMais adiante a s\u00e9rie de temperatura ser\u00e1 consolidada em um per\u00edodo plurianual, para evidenciar mehor sua tend\u00eancia de aumento hist\u00f3rico.","b96ad65d":"O gr\u00e1fico de m\u00e9dia m\u00f3vel plurianual acima mostra de forma clara a exist\u00eancia de uma tend\u00eancia de aumento da temperatura ao longo dos anos. Houve uma forte tend\u00eancia de aumento de 1910 at\u00e9 1945 (fim da 2<sup>a<\/sup> Guerra Mundial). De 1945 a 1975 a temperatura permaneceu oscilando em torno de um patamar relativamente est\u00e1vel, possivelmente devido \u00e0 estagna\u00e7\u00e3o mundial ap\u00f3s a 2<sup>a<\/sup> Guerra. Por volta de 1975, a temperatura iniciou uma nova tend\u00eancia de aumento, possivelmente devido \u00e0 acelera\u00e7\u00e3o da industrializa\u00e7\u00e3o.\n\nO aumento total de temperatura nesse per\u00edodo de 114 anos (1910 a 2014) foi de aproximadamente 1,1 <sup>o<\/sup>C (14,8 a 15,9 <sup>o<\/sup>C). Esse aumento pode parecer pequeno, mas os especialistas clim\u00e1ticos defendem que um aumento de apenas 0,5 <sup>o<\/sup>C na temperatura global pode ter efeitos catastr\u00f3ficos sobre o clima e os ecossistemas da Terra.\n\nNeste ponto, \u00e9 oportuno tamb\u00e9m determinar a m\u00e9dia m\u00f3vel plurianual da concentra\u00e7\u00e3o de CO<sub>2<\/sub> atmosf\u00e9rico. Isto \u00e9 feito a seguir.","466f5bf6":"lembrando que, para a s\u00e9rie de temperatura global m\u00e9dia, o modelo SARIMA teve melhor desempenho que o modelo ARIMA, ser\u00e1 desenvolvido um modelo SARIMA tamb\u00e9m para a concentra\u00e7\u00e3o de CO<sub>2<\/sub> global m\u00e9dia. Isto \u00e9 feito a seguir.","3a36d963":"A an\u00e1lise das vari\u00e1veis no per\u00edodo de 1900 a 2014 permitiu concluir que:\n* As vari\u00e1veis apresentam **sazonalidade anual** bem definida.\n* As vari\u00e1veis possuem **tend\u00eancia de aumento**. A temperatura m\u00e9dia global possui uma tend\u00eancia de aumento fraca, mas consistente e relativamente constante; ao passo que a concentra\u00e7\u00e3o de CO<sub>2<\/sub> atmosf\u00e9rico apresenta uma tend\u00eancia de aumento significativa no per\u00edodo considerado, menos intensa de 1900 a 1970 e mais acentuada de 1970 em diante.\n* As vari\u00e1veis **n\u00e3o s\u00e3o estacion\u00e1rias** no per\u00edodo de tempo considerado, devido principalmente \u00e0s suas tend\u00eancias.\n* As vari\u00e1veis apresentam **correla\u00e7\u00e3o** entre si. Essa correla\u00e7\u00e3o \u00e9 mais facilmente observada nos valores consolidados a n\u00edvel plurianual (m\u00e9dia m\u00f3vel).\n\nA correla\u00e7\u00e3o observada entre a concentra\u00e7\u00e3o de CO<sub>2<\/sub> atmosf\u00e9rico e a temperatura na superf\u00edcie da Terra n\u00e3o significa que a primeira vari\u00e1vel seja causa da segunda, pois **correla\u00e7\u00e3o n\u00e3o implica causabilidade**. A percep\u00e7\u00e3o de que a concentra\u00e7\u00e3o de CO<sub>2<\/sub> influi como causa na temperatura do planeta vem de estudos espec\u00edficos de causabilidade, fundamentados em conhecimentos de Ci\u00eancias Clim\u00e1ticas (***domain knowledge***). Com base nos dados aqui analisados, podemos apenas afirmar que **existe uma rela\u00e7\u00e3o positiva e forte entre as vari\u00e1veis**. \u00c9 preciso tamb\u00e9m considerar a possibilidade de outras vari\u00e1veis atuando como causadoras de temperatura global, especialmente a **atividade solar**. O Sol, como fonte de calor, tem influ\u00eancia direta sobre a temperatura da Terra, al\u00e9m dos fatores internos ao planeta. A atividade solar poderia ser uma vari\u00e1vel relevante para uso como s\u00e9rie de suporte na modelagem de temperatura m\u00e9dia global.","7e4b7c1c":"Assim como feito para a s\u00e9rie de concentra\u00e7\u00e3o de CO<sub>2<\/sub> atmosf\u00e9rico, a s\u00e9rie de temperatura na superf\u00edcie da Terra ser\u00e1 decomposta em suas componentes de tend\u00eancia, sazonalidade e erro.","6d04337e":"Uma maneira alternativa de verificar poss\u00edveis tend\u00eancias nos valores de temperatura \u00e9 consolidando-os em intervalos de tempo maiores que o intervalo dos dados, ou seja, calculando uma m\u00e9dia m\u00f3vel. Os dados de temperatura est\u00e3o em per\u00edodos mensais, podendo ser consolidados em per\u00edodos anuais (m\u00e9dia anual) ou plurianuais (m\u00e9dia dos \u00faltimos 5 anos, por exemplo). Isto \u00e9 feito a seguir.","75935f58":"Os gr\u00e1ficos acima mostram que a temperatura na superf\u00edcie da Terra apresenta **significativas oscila\u00e7\u00f5es sazonais** e uma **leve por\u00e9m cont\u00ednua tend\u00eancia de aumento** no per\u00edodo considerado (1900 a 2014).\n\nA seguir s\u00e3o visualizados os \u00faltimos 30 anos de dados de temperatura, para evidenciar de forma mais clara as oscila\u00e7\u00f5es sazonais.","2443bc7c":"Existem v\u00e1rios modelos espec\u00edficos para modelagem de s\u00e9ries temporais, como:\n\n**ES** (*Exponential Smoothing*), **AR** (*Auto-Regressive*), **MA** (*Moving Average*), **ARMA** (*Auto-Regressive Moving Average*), **ARIMA** (*Auto-Regressive Integrated Moving Average*), **ARMAX** (*Auto-Regressive Integrated Moving Average with eXogenpus input*), **SARIMA** (*Seasonal Auto-Regressive Integrated Moving Average*), **SARIMAX** (*Seasonal Auto-Regressive Integrated Moving Average with eXogenous inpiut*) e outros.\n\nA sele\u00e7\u00e3o de um m\u00e9todo apropriado para modelagem de uma s\u00e9rie temporal depende das propriedades da s\u00e9rie. Uma dessas propriedades \u00e9 a **Fun\u00e7\u00e3o Auto-Correla\u00e7\u00e3o (ACF)**. A seguir, \u00e9 analisada a auto-correla\u00e7\u00e3o da s\u00e9rie de temperatura m\u00e9dia global.","36d79434":"Pode-se ver acima que os dados de temperatura s\u00e3o **mensais**, com data no **1<sup>o<\/sup> dia** de cada m\u00eas. Al\u00e9m disso, a maioria das vari\u00e1veis de temperatura possui ***missing values*** (NaN).","5e7d89d7":"<hr><font color='blue'>\n\n### Entendimento dos Dados\n<font color>","89b8c074":"Pode-se ver acima que os dados de CO<sub>2<\/sub> s\u00e3o **mensais**, com data no **15<sup>o<\/sup> dia** de cada m\u00eas. \u00c9 conveniente transformar esses dados para o **1<sup>o<\/sup> dia** do m\u00eas, de modo a sincroniz\u00e1-los com os dados de temperatura. Isso pode ser feito atrav\u00e9s de **interpola\u00e7\u00e3o**. Al\u00e9m disso, os dados come\u00e7am no **ano zero** que n\u00e3o tem sentido e deve ser exclu\u00eddo.\n\n**OBS**: A sincroniza\u00e7\u00e3o dos dados de temperatura (1<sup>o<\/sup> dia do m\u00eas) e de CO<sub>2<\/sub> (15<sup>o<\/sup> dia do m\u00eas) poder ser feita transformando os dados de temperatura para o 15<sup>o<\/sup> dia do m\u00eas OU transformando os dados de CO<sub>2<\/sub> para o 1<sup>o<\/sup> dia do m\u00eas. Quaisquer das op\u00e7\u00f5es levar\u00e1 a resultados praticamente iguais na an\u00e1lise das s\u00e9ries temporais, pois \u00e9 o per\u00edodo mensal dos dados que define a amostragem temporal das s\u00e9ries e n\u00e3o o dia do m\u00eas. Usaremos a segunda op\u00e7\u00e3o, por mera conveni\u00eancia.","04347094":"Uma forma inicial de avaliar a poss\u00edvel exist\u00eancia de correla\u00e7\u00e3o entre vari\u00e1veis \u00e9 atrav\u00e9s de um **gr\u00e1fico de dispers\u00e3o**. Abaixo \u00e9 mostrado esse gr\u00e1fico para os valores **mensais** de concentra\u00e7\u00e3o de CO<sub>2<\/sub> e temperatura","8893fe9a":"<hr><font color='blue'>\n\n### Carregamento dos dados de temperatura\n<font color='blue'>","64d3eefe":"Neste ponto da etapa de **pr\u00e9-processamento** dos dados, temos um dataset de temperatura e outro de CO<sub>2<\/sub> com dados sincronizados no tempo. \u00c9 conveniente combinar (***merge***) os dois datasets em um dataset \u00fanico, para facilitar a manipula\u00e7\u00e3o de todos os dados nas etapas de **an\u00e1lise** e **modelagem**. Isto \u00e9 feito a seguir.","87e781e1":"As quatro vari\u00e1veis de temperatura na superf\u00edcie da Terra (maxima, m\u00e9dia e m\u00ednima em \u00e1reas de terra, e m\u00e9dia em \u00e1reas de terra\/oceanos) possuem perfis similares, conforme foi observado em seus gr\u00e1ficos temporais. Podemos assumir com seguran\u00e7a que todas as s\u00e9ries de temperatura ter\u00e3o modelos preditivos similares. A fim de n\u00e3o tornar este Jupyter Notebbok muito extenso, a modelagem preditiva ser\u00e1 feita apenas para a vari\u00e1vel de **temperatura global m\u00e9dia em \u00e1reas de terra\/oceanos**. Modelos para as outras tr\u00eas s\u00e9ries de temperatura poder\u00e3o ser facilmente obtidos executando-se este Notebook para as vari\u00e1veis em quest\u00e3o. Isto \u00e9 deixado como exerc\u00edcio para o usu\u00e1rio.","dfd816bc":"#### Modelo ARIMA","319b010e":"Os *missing values* ser\u00e3o tratados mais adiante.","a3cba61b":"De forma geral, uma s\u00e9rie temporal pode ser decomposta em quatro componentes:\n* **Tend\u00eancia (T)**: \u00e9 a componente que define a evolu\u00e7\u00e3o geral da s\u00e9rie ao longo do tempo.\n* **Sazonalidade (S)**: \u00e9 a componente que representa as oscila\u00e7\u00f5es da s\u00e9rie relacionadas ao ciclo anual da Terra.\n* **Erro (E)**: tamb\u00e9m denominada de **res\u00edduo** ou **ru\u00eddo**, \u00e9 a componente residual n\u00e3o explicada pela tend\u00eancia ou sazonalidade da s\u00e9rie, estando relacionada a aspectos aleat\u00f3rios da s\u00e9rie.\n\nUma s\u00e9rie temporal pode ser formada a partir de suas tr\u00eas componentes (E, T e S) de forma **aditiva** ou **multiplicativa**. Na forma aditiva, as tr\u00eas componentes s\u00e3o somadas, ao passo que na forma multiplicativa, as componentes s\u00e3o multiplicadas entre si. A forma aditiva representa melhor as s\u00e9ries com vari\u00e2ncia constante ao longo do tempo, ou seja, quando as flutua\u00e7\u00f5es sazonais permanecem constantes. Por outro lado, a forma multiplicativa representa melhor as s\u00e9ries com vari\u00e2ncia aumentando ou diminuindo ao longo do tempo.\n\nA seguir \u00e9 feita a decomposi\u00e7\u00e3o da s\u00e9rie temporal de concentra\u00e7\u00e3o m\u00e9dia global de CO<sub>2<\/sub> atmosf\u00e9rico.","5ee84a57":"#### An\u00e1lise de correla\u00e7\u00e3o entre concentra\u00e7\u00e3o de CO<sub>2<\/sub> e temperatura","fc2b1046":"As amplitudes decrescentes de auto-correla\u00e7\u00e3o siginificam que cada valor da s\u00e9rie tem maior correla\u00e7\u00e3o com os valores imediatamente precedentes e menor correla\u00e7\u00e3o com os valores mais antigos. Isto tamb\u00e9m indica que a s\u00e9rie **n\u00e3o \u00e9 estacion\u00e1ria** no per\u00edodo de tempo considerado. O aspecto oscilat\u00f3rio da auto-correla\u00e7\u00e3o \u00e9 decorrente das ocila\u00e7\u00f5es sazonais nos valores da s\u00e9rie.","db723ce4":"<hr><font color='blue'>\n\n### Carregamento dos dados de CO<sub>2<\/sub> atmosf\u00e9rico\n<font color>","f5bd104a":"#### Evolu\u00e7\u00e3o temporal da concentra\u00e7\u00e3o de CO<sub>2<\/sub>, por hemisf\u00e9rio e global","9c17122d":"O modelo ARIMA desenvolvido acima forneceu um excelente desempenho de predi\u00e7\u00e3o. Entretanto tal modelo n\u00e3o considera a sazonalidade da s\u00e9rie. A seguir \u00e9 desenvolvido um modelo do tipo **SARIMA**, que considera a sazonalidade da s\u00e9rie. As predi\u00e7\u00f5es ser\u00e3o feitas *um passo \u00e0 frente*.","f5025a29":"#### An\u00e1lise de estacionariedade da concentra\u00e7\u00e3o de CO<sub>2<\/sub> atmosf\u00e9rico","5386565d":"#### Predi\u00e7\u00e3o da S\u00e9rie Temporal de Temperatura M\u00e9dia Global","9f58fc38":"<hr><font color='blue'>\n\n### Conclus\u00e3o\n<font color>","64b34abb":"Antes de desenvolver um modelo para a s\u00e9rie de concentra\u00e7\u00e3o de CO<sub>2<\/sub> atmosf\u00e9rico, \u00e9 preciso avaliar sua auto-correla\u00e7\u00e3o (ACF):","46ce48d3":"A auto-correla\u00e7\u00e3o da s\u00e9rie diferenciada tem um valor elevado apenas no lag inicial, apresentando valores significamente menores para os demais lags, indicando sua estacionariedade. Isto comprova que a s\u00e9rie origainal tem sazonalidade de 12 meses pois a sua diferencia\u00e7\u00e3o por 12 meses se mostra estacion\u00e1ria.\n\nAdicionalmente, o valor **positivo** de auto-correla\u00e7\u00e3o da s\u00e9rie diferenciada estacion\u00e1ria no lag inicial, significa que uma componente **AR** (*Auto-Regressive*) \u00e9 mais apropriado. Se a autocorrela\u00e7\u00e3o no lag inicial fosse negativa, uma componente **MA** (*Moving Average*) seria mais adequada.","472993e9":"[1] Kaggle. **Climate Change: Earth Surface Temperature Data**. (acessado em 07\/11\/2020). https:\/\/www.kaggle.com\/berkeleyearth\/climate-change-earth-surface-temperature-data\/data#GlobalTemperatures.csv\n\n[2] Institute for Atmospheric and Climate Science (IAC), ETH Zurich. **Mole Fraction of Carbon Dioxide in Air**. (acessado em 07\/11\/2020). ftp:\/\/data.iac.ethz.ch\/CMIP6\/input4MIPs\/UoM\/GHGConc\/CMIP\/mon\/atmos\/UoM-CMIP-1-1-0\/GHGConc\/gr3-GMNHSH\/v20160701\/mole_fraction_of_carbon_dioxide_in_air_input4MIPs_GHGConcentrations_CMIP_UoM-CMIP-1-1-0_gr3-GMNHSH_000001-201412.csv\n\n[3] Shumway, R.H. & Stoffer, D.S. (2011). **Time-Series Analysis and Its Applications**. 3<sup>rd<\/sup> edition. Springer. New York, USA.\n\n[4] statsmodels.tsa. **Time Series Analysis Library**. (acessado em 07\/11\/2020). https:\/\/www.statsmodels.org\/stable\/tsa.html#\n\n[5] Wikipedia. **Autoregressive Integrated Moving Average**. (acessado em 07\/11\/2020). https:\/\/en.wikipedia.org\/wiki\/Autoregressive_integrated_moving_average\n","70ea728d":"#### Consolida\u00e7\u00e3o plurianual dos valores de temperatura","37206969":"<hr><font color='blue'>\n\n### Introdu\u00e7\u00e3o\n<font color>","8487b5fb":"A An\u00e1lise Explorat\u00f3ria dos dados de temperatura global e concentra\u00e7\u00e3o de CO<sub>2<\/sub> atmosf\u00e9rico forneceram *insights* importantes sobre essas vari\u00e1veis no per\u00edodo considerado (1900 a 2014):\n* Ambas as vari\u00e1veis apresentam **sazonalidade anual** bem definida.\n* Ambas as vari\u00e1veis possuem **tend\u00eancia de aumento**. A temperatura m\u00e9dia global possui uma tend\u00eancia de aumento fraca, mas consistente e relativamente constante; ao passo que a concentra\u00e7\u00e3o de CO<sub>2<\/sub> atmosf\u00e9rico apresenta uma tend\u00eancia de aumento significativa no per\u00edodo considerado, menos intensa de 1900 a 1970 e mais acentuada de 1970 em diante.\n* Ambas as vari\u00e1veis **n\u00e3o s\u00e3o estacion\u00e1rias** no per\u00edodo de tempo considerado, devido principalmente \u00e0s suas tend\u00eancias.\n* As vari\u00e1veis apresentam **correla\u00e7\u00e3o** entre si. Essa correla\u00e7\u00e3o \u00e9 mais facilmente observada nos valores consolidados a n\u00edvel plurianual (m\u00e9dia m\u00f3vel).\n\nNesta etapa ser\u00e1 feita a **modelagem preditiva** das s\u00e9ries de temperatura e concentra\u00e7\u00e3o de CO<sub>2<\/sub>, ou seja, a cria\u00e7\u00e3o de modelos matem\u00e1ticos destinados a fazer previs\u00f5es (estimativas) de valores futuros dessas vari\u00e1veis.\n\nUma vez que os modelos preditivos destinam-se a prever valores futuros, \u00e9 conveniente usar **valores recentes** das vari\u00e1veis, desconsiderando valores muitos antigos, que geralmente n\u00e3o representam o comportamento mais atual das vari\u00e1veis. Os resultados observados na An\u00e1lise Explorat\u00f3ria dos dados indicam que o comportamento mais recente das vari\u00e1veis pode ser representado pelos dados a partir de **1975**. Dessa forma, usaremos os dados a partir desse ano para modelagem preditiva.","7b6f8e23":"<hr>\n\n#### Predi\u00e7\u00e3o da S\u00e9ries Temporal de CO<sub>2<\/sub> Global M\u00e9dio","a9ef577c":"A evolu\u00e7\u00e3o hist\u00f3rica da concentra\u00e7\u00e3o m\u00e9dia m\u00f3vel de CO<sub>2<\/sub> atmosf\u00e9rico (curva vermelha) apresenta padr\u00e3o similar ao observado no gr\u00e1fico de valores mensais de CO<sub>2<\/sub> (curva cinza), dado que o aspecto mais importante dessa vari\u00e1vel \u00e9 sua tend\u00eancia de aumento.","4d46d4d3":"<font color='blue'>\n\n### Pre-processamento dos dados de temperatura\n<font color>","3963b55d":"Os arquivos de dados foram baixados de suas respectivas fontes na Internet e salvos no diret\u00f3rio definido pela vari\u00e1vel <code>DataFolder<\/code> acima.\n* Arquivo de dados de temperatura: **\"GlobalTemperatures.csv\"**\n* Arquivo de dados de CO<sub>2<\/sub>: **\"CO2_Concentration.csv\"**","ee493249":"Uma s\u00e9rie temporal \u00e9 dita **estacion\u00e1ria** quando seus valores n\u00e3o dependem do tempo, ou seja, quando sua m\u00e9dia e vari\u00e2ncia s\u00e3o constantes ao longo do tempo. Isso implica que a condi\u00e7\u00e3o de estacionariedade \u00e9 relativa ao per\u00edodo de tempo considerado: uma s\u00e9rie que n\u00e3o seja estacion\u00e1ria em um per\u00edodo de 100 anos pode ser considerada estacion\u00e1ria em um per\u00edodo menor, de 10 anos por exemplo, dependendo do seu perfil de tend\u00eancia e sazonalidade ao longo do tempo.\n\nExistem tr\u00eas formas de avaliar se uma s\u00e9rie \u00e9 ou n\u00e3o estacion\u00e1ria:\n* Visualiza\u00e7\u00e3o Gr\u00e1fica: Verificar graficamente se a s\u00e9rie apresenta tend\u00eancia e\/ou sazonalidade (decomposi\u00e7\u00e3o ETS da s\u00e9rie). \u00c9 uma forma r\u00e1pida, mas que n\u00e3o quantifica a estacionariedade de forma objetiva.\n* Estat\u00edstica Descritiva: Verificar se as estat\u00edsticas (m\u00e9dia e vari\u00e2ncia) da s\u00e9rie se mant\u00eam relativamente constantes ou variam significativamente entre per\u00edodos de tempo menores. Fornece uma quantifica\u00e7\u00e3o para a hip\u00f3tese de estacionariedade.\n* Testes Esatat\u00edsticos: Usar testes estatisticos espec\u00edficos para aceitar ou rejeitar a hipotese de estacionariedade da s\u00e9rie segundo um n\u00edvel de confian\u00e7a especificado. Fornece uma quantifica\u00e7\u00e3o mais formal para a hip\u00f3tese de estacionariedade.\n\nA seguir \u00e9 feita uma verifica\u00e7\u00e3o de estacionariedade da s\u00e9rie de concentra\u00e7\u00e3o de CO<sub>2<\/sub> atmosf\u00e9rico atrav\u00e9s de Estat\u00edstica Descritiva, considerando intervalos de tempo menores dentro do per\u00edodo de tempo da s\u00e9rie.","e63767de":"A s\u00e9rie de temperatura **n\u00e3o \u00e9 estacion\u00e1ria no per\u00edodo de tempo considerado**, principalmente por apresentar forte sazonalidade, al\u00e9m de tend\u00eancia.\n\nA seguir \u00e9 feita uma an\u00e1lise mais formal da estacionariedade da s\u00e9rie de temperatura atrav\u00e9s de Estat\u00edstica Descritiva.","b0cabcb0":"Sabendo que a sazonalidade dos valores de temperatura tem per\u00edodo (ciclo) de 12 meses, se diferenciarmos a s\u00e9rie por 12 meses, resulta uma s\u00e9rie **estacion\u00e1ria**. A seguir \u00e9 calculada a auto-correla\u00e7\u00e3o para a s\u00e9rie de temperatura diferenciada por 12 meses.","f063047b":"#### Evolu\u00e7\u00e3o temporal da temperatura na superf\u00edcie do planeta, em terra e nos oceanos","d7bf8127":"Pelos resultados acima, o modelo **SARIMAX** obteve desempenho de predi\u00e7\u00e3o similar ao do modelo **SARIMA** ordin\u00e1rio.\n\nDos tr\u00eas modelos (ARIMA, SARIMA e SARIMAX) desenvolvidos para predi\u00e7\u00e3o da temperatura m\u00e9dia global, **o modelo SARIMA \u00e9 o melhor candidato para uso\/implementa\u00e7\u00e3o, pois obteve desempenho um pouco melhor que o modelo ARIMA, e n\u00e3o foi superado pelo modelo SARIMAX**, bem mais complexo e dependente de uma vari\u00e1vel de suporte.","28129912":"Quanto aos modelos preditivos desenvolvidos para as vari\u00e1veis, os modelos ARIMA, SARIMA (Seasonal ARIMA) e SARIMAX (Seasonal ARIMA with exogenous input) se mostraram adequados para modelar o comportamento das vari\u00e1veis. Todos os modelos apresentaram \u00f3timos desempenhos, com reduzido valores de Erro Quadr\u00e1tico M\u00e9dio de predi\u00e7\u00e3o e elevada correla\u00e7\u00e3o entre os valores preditos e observados. Entretanto, **o modelo SARIMA se mostra como melhor candidato para uso\/implementa\u00e7\u00e3o**, pois obteve desempenho um pouco melhor que o modelo ARIMA, e n\u00e3o foi superado pelo modelo SARIMAX, mais complexo e dependente da concentra\u00e7\u00e3o de CO<sub>2<\/sub> como vari\u00e1vel de suporte.","09e5b9e3":"Por fim, as an\u00e1lises e modelagens desenvolvidas podem ser estendidas para os arquivos de dados adicionais de temperatura (temperatura por cidades, estados e pa\u00edses), que n\u00e3o foram considerados no presente estudo porque o objetivo foi analisar e modelar a temperatura e concentra\u00e7\u00e3o de CO<sub>2<\/sub> a n\u00edvel global.","e6e59305":"Como indicado acima, os dois datasets cobrem agora o mesmo per\u00edodo de tempo e possuem o mesmo n\u00famero de observa\u00e7\u00f5es, estando perfeitamente sincronizados.","910399a4":"Antes de iniciar qualquer an\u00e1lise de dados, \u00e9 importante entender o significado dos mesmos.\n\nAs vari\u00e1veis existentes no arquivo de dados de **concentra\u00e7\u00e3o de CO<sub>2<\/sub> atmosf\u00e9rico** t\u00eam o seguinte significado:\n* **datenum**: n\u00famero inteiro de segundos correspondente ao valor de data-hora na vari\u00e1vel 'datetime'.\n* **year**: ano correspondente ao valor de data-hora na vari\u00e1vel 'datetime'.\n* **month**: m\u00eas correspondente ao valor de data-hora na vari\u00e1vel 'datetime'.\n* **day**: dia correspondente ao valor de data-hora na vari\u00e1vel 'datetime'.\n* **datetime**: data-hora, sempre \u00e0s 00:00h do 15<sup>o<\/sup> dia do m\u00eas, associada aos valores de concentra\u00e7\u00e3o de CO<sub>2<\/sub>.\n* **data_mean_global**: concentra\u00e7\u00e3o de CO<sub>2<\/sub> m\u00e9dia global (corresponde \u00e0 m\u00e9dia dos valores de 'data_mean_nh' e 'data_mean_sh').\n* **data_mean_nh**: concentra\u00e7\u00e3o de CO<sub>2<\/sub> m\u00e9dia no hemisf\u00e9rio Norte.\n* **data_mean_sh**: concentra\u00e7\u00e3o de CO<sub>2<\/sub> m\u00e9dia no hemisf\u00e9rio Sul.\n\nAs vari\u00e1veis principais a serem usada s\u00e3o <code>datetime<\/code> e <code>data_mean_global<\/code>, pois o contexto da an\u00e1lise a ser desenvolvida \u00e9 global.","3aca4f69":"#### An\u00e1lise ETS (*Error-Trend-Seasonality*) da concentra\u00e7\u00e3o de CO<sub>2<\/sub> atmosf\u00e9rico","0c1fd491":"O modelo **ARIMA** permite controlar as componentes de auto-regress\u00e3o (AR), diferencia\u00e7\u00e3o (I) e m\u00e9dia-m\u00f3vel (MA) de forma flex\u00edvel pela sele\u00e7\u00e3o de tr\u00eas coeficientes: \"p\", \"d\" e \"q\", respectivamente. A seguir \u00e9 desenvolvido um modelo ARIMA para a s\u00e9rie de temperatura global m\u00e9dia.\n\nNeste trabalho, **as predi\u00e7\u00f5es ser\u00e3o calculadas um passo \u00e0 frente (*one step ahead*)** para um n\u00famero de meses \"n\" especificado. Por exemplo, n=10 significa prever os \u00faltimos 10 valores da s\u00e9rie. Para uma s\u00e9rie $Y(k)$ com $N$ observa\u00e7\u00f5es ($k = {1, 2, ..., N}$), o modelo \u00e9 ajustado com os $N-n$ primeiros valores da s\u00e9rie, ${Y(1), Y(2), ... Y(N-n)}$ e ent\u00e3o \u00e9 feita a predi\u00e7\u00e3o do pr\u00f3ximo valor $\\hat{Y}(N-n+1)$, e calculado o erro de predi\u00e7\u00e3o $e(N-n+1) = Y(N-n+1)-\\hat{Y}(N-n+1)$. Em seguida, o modelo \u00e9 reajustado com a \u00faltima observa\u00e7\u00e3o dispon\u00edvel $Y(N-n+1)$, faz-se a predi\u00e7\u00e3o do pr\u00f3ximo valor $\\hat{Y}(N-n+2)$ e calcula-se o erro de predi\u00e7\u00e3o correspondente $e(N-n+2) = Y(N-n+2)-\\hat{Y}(N-n+2)$. Esse processo de predi\u00e7\u00e3o um passo \u00e0 frente \u00e9 repedito at\u00e9 a observa\u00e7\u00e3o $N$. Ao final do processo, \u00e9 feito um gr\u00e1fico mostrando os valores preditos $\\hat{Y}(j)$ e observados ${Y}(j)$, e o desempenho do modelo \u00e9 quantificado atrav\u00e9s do **erro quadr\u00e1tico m\u00e9dio de predi\u00e7\u00e3o** e da **correla\u00e7\u00e3o entre os valores preditos e correspondentes valores observados (reais)**.\n\nObviamente, tamb\u00e9m podemos fazer predi\u00e7\u00f5es em um horizonte de tempo maior (6 ou 12 passos \u00e0 frente, por exemplo), n\u00e3o esquecendo que quanto maior o horizonte de tempo da predi\u00e7\u00e3o, maior ser\u00e1 a sua incerteza. Uma vez que as s\u00e9ries em an\u00e1lise est\u00e3o em base mensal, \u00e9 plaus\u00edvel que se queira obter uma predi\u00e7\u00e3o confi\u00e1vel para o pr\u00f3ximo m\u00eas (um passo \u00e0 frente).","33e41925":"#### Modelo SARIMA (*Seasonal ARIMA*)","1c34d6df":"<hr>\n\n### <font color='blue'>An\u00e1lise do Relacionamento entre Temperatura na Superf\u00edcie Terrestre e Concentra\u00e7\u00e3o de CO<sub>2<\/sub> Atmosf\u00e9rico<\/font>\n\n#### Sidney A.A. Viana\n\n#### Revision 01.1","a346e0cb":"Pelos resultados acima, o modelo **SARIMA** obteve menor erro quadr\u00e1tico m\u00e9dio e maior correla\u00e7\u00e3o de predi\u00e7\u00e3o que o modelo **ARIMA**, sendo portanto melhor que este. Comparando o gr\u00e1fico acima com o gr\u00e1fico anterior, observa-se que as predi\u00e7\u00f5es com maiores erros no modelo ARIMA foram melhoradas pelo modelo SARIMA.","ce42fa02":"O gr\u00e1fico acima comprova que **existe correla\u00e7\u00e3o entre a concentra\u00e7\u00e3o de CO<sub>2<\/sub> atmosf\u00e9rico a temperatura global a n\u00edvel plurianual**. Note a grande diferen\u00e7a entre o gr\u00e1fico acima e o gr\u00e1fico precedente quanto \u00e0 capacidade de evidenciar um poss\u00edvel relacionamento entre as vari\u00e1veis, a n\u00edvel mensal (gr\u00e1fico precedente) e a n\u00edvel plurianual (gr\u00e1fico acima).\n\nO coeficiente de correla\u00e7\u00e3o positivo significa que, em m\u00e9dia, quando uma das vari\u00e1veis aumenta, a outra tamb\u00e9m aumenta, e vice-versa. Sabendo que o coeficiente de correla\u00e7\u00e3o s\u00f3 pode ter valores entre -1 e 1, o valor de **0,94** \u00e9 elevado, indicando uma **rela\u00e7\u00e3o muito forte entre a concentra\u00e7\u00e3o de CO<sub>2<\/sub> na atmosfera e a temperatura da Terra**. Entretanto, **apenas com base na correla\u00e7\u00e3o, n\u00e3o se pode afirmar que as varia\u00e7\u00f5es na concentra\u00e7\u00e3o de CO<sub>2<\/sub> atmosf\u00e9rico s\u00e3o a causa das varia\u00e7\u00f5es na temperatura do planeta**, pois **correla\u00e7\u00e3o n\u00e3o implica causabilidade**. A percep\u00e7\u00e3o de que a concentra\u00e7\u00e3o de CO<sub>2<\/sub> influi como causa na temperatura do planeta vem de estudos espec\u00edficos de causabilidade, fundamentados em conhecimentos de Ci\u00eancias Clim\u00e1ticas (***domain knowledge***). Com base nos dados aqui analisados, podemos apenas afirmar que **existe uma rela\u00e7\u00e3o positiva e forte entre as vari\u00e1veis**.\n\nPor outro lado, *assumindo que outros estudos tenham provado que a concentra\u00e7\u00e3o de CO<sub>2<\/sub> \u00e9 de fato uma das causas da temperatura global*, o elevado valor do coeficiente de correla\u00e7\u00e3o indica que o aumento da concentra\u00e7\u00e3o de CO<sub>2<\/sub> \u00e9 uma forte causa do aquecimento global.\n\nAdemais, \u00e9 preciso tamb\u00e9m considerar a possibilidade de outras vari\u00e1veis atuando como causadoras de temperatura global, especialmente a **atividade solar**. O Sol, como fonte de calor, tem influ\u00eancia direta sobre a temperatura da Terra, al\u00e9m dos fatores internos ao planeta. Por\u00e9m, esta an\u00e1lise n\u00e3o considera dados de atividade solar.","37ec3fad":"As vari\u00e1veis constantes no arquivo de dados de **temperatura global** t\u00eam o seguinte significado:\n* **dt**: data, sempre no 1<sup>o<\/sup> dia do m\u00eas.\n* **LandAverageTemperature**: temperatura global m\u00e9dia em \u00e1reas de terra.\n* **LandAverageTemperatureUncertainty**: incerteza na temperatura global m\u00e9dia em \u00e1reas de terra.\n* **LandMaxTemperature**: temperatura global m\u00e1xima em \u00e1reas de terra.\n* **LandMaxTemperatureUncertainty**: incerteza na temperatura global m\u00e1xima em \u00e1reas de terra.\n* **LandMinTemperature**: temperatura global m\u00ednima em \u00e1reas de terra.\n* **LandMinTemperatureUncertainty**: incerteza na temperatura global m\u00ednima em \u00e1reas de terra.\n* **LandAndOceanAverageTemperature**: temperatura global m\u00e9dia em \u00e1reas de terra\/oceanos.\n* **LandAndOceanAverageTemperatureUncertainty**: incerteza na temperatura global m\u00e9dia em \u00e1reas de terra\/oceanos.\n\nAs vari\u00e1veis principais a serem usadas s\u00e3o <code>dt<\/code> e <code>LandAndOceanAverageTemperature<\/code>, pois o interesse \u00e9 na temperatura da terra como um todo (\u00e1reas terrestres e de oceanos). As demais vari\u00e1veis podem ser usadas para verifica\u00e7\u00f5es complementares.\n\nCertas vari\u00e1veis possuem nomes extensos. Apenas por conveni\u00eancia, os nomes ser\u00e3o substitu\u00eddos por outros mais simples, para facilitar a visualiza\u00e7\u00e3o dos dados de forma tabelada.","24bd69a2":"Observa-se que **a sazonalidade \u00e9 responspavel pela maior parte das varia\u00e7\u00f5es de temperatura na superf\u00edcie da Terra**. A pequena tend\u00eancia de aumento de temperatura indica um **processo lento, mas consistente, de aquecimento global**, dif\u00edcil de ser percebido em per\u00edodos de tempo menores. Os pequenos valores de ru\u00eddo indicam que a s\u00e9rie de temperatura fica muito bem caracterizada pelas componentes de tend\u00eancia e sazonalidade.","12e709b3":"<font color='blue'>\n\n### Pre-processamento dos dados de CO<sub>2<\/sub>\n<font color>","95b34d05":"O aspecto mais importante em todos os gr\u00e1ficos acima \u00e9 a **tend\u00eancia de aumento na concentra\u00e7\u00e3o de CO2 atmosf\u00e9rico**, que passou de aproximadamente 342 moles em 1984 para 395 moles em 2014 (13,42% de aumento) - e tem um valor ainda maior atualmente.","0621af89":"<hr><font color='blue'>\n\n### Modelagem Preditiva\n<font color>","861169d0":"<hr><font color='blue'>\n\n### An\u00e1lise Explorat\u00f3ria\n<font color>","bda8b42b":"Este Jupyter Notebbok apresenta uma **an\u00e1lise da temperatura m\u00e9dia global na superf\u00edcie da Terra e da concentra\u00e7\u00e3o m\u00e9dia global de CO<sub>2<\/sub> atmosf\u00e9rico, com o objetivo de identificar a exist\u00eancia de relacionamento entre essas vari\u00e1veis, e implementar modelos preditivos para essas vari\u00e1veis**. A an\u00e1lise \u00e9 baseada em dados de temperatura e concentra\u00e7\u00e3o de CO<sub>2<\/sub> obtidos das seguintes fontes:\n* Temperatura na superf\u00edcie da Terra:\n  https:\/\/www.kaggle.com\/berkeleyearth\/climate-change-earth-surface-temperature-data\/data#GlobalTemperatures.csv\n* Concentra\u00e7\u00e3o de CO<sub>2<\/sub> atmosf\u00e9rico:\n  ftp:\/\/data.iac.ethz.ch\/CMIP6\/input4MIPs\/UoM\/GHGConc\/CMIP\/mon\/atmos\/UoM-CMIP-1-1-0\/GHGConc\/gr3-GMNHSH\/v20160701\/mole_fraction_of_carbon_dioxide_in_air_input4MIPs_GHGConcentrations_CMIP_UoM-CMIP-1-1-0_gr3-GMNHSH_000001-201412.csv\n\nOs arquivos de dados foram baixados das fontes acima e salvos, permitindo realizar as an\u00e1lises sem necessidade de conex\u00e3o com a Internet.","ecd6e4d1":"Os gr\u00e1ficos acima mostram que a concentra\u00e7\u00e3o de CO<sub>2<\/sub> atmosf\u00e9rico apresenta uma cont\u00ednua tend\u00eancia de aumento desde o ano de 1900, com dois ritmos de aumento principais: um ritmo mais fraco de 1900 a 1970, e um ritmo bem mais intenso a partir de 1970. Tamb\u00e9m \u00e9 poss\u00edvel notar oscila\u00e7\u00f5es nos valores (que est\u00e3o em base de tempo mensal), devido \u00e0 sazonalidade anual.\n\nA seguir s\u00e3o visualizados os \u00faltimos 30 anos de dados, para evidenciar de forma mais clara as oscila\u00e7\u00f5es sazonais.","d7e8829c":"Considerando a amplitude de varia\u00e7\u00e3o dos valores de temperatura, o pequeno valor do erro quadr\u00e1tico m\u00e9dio de predi\u00e7\u00e3o juntamente com a elevado correla\u00e7\u00e3o entre os valores preditos e observados, idnicam que o modelo ARIMA desenvolvido tem desempenho excelente.","91dccd73":"O desempenho do modelo pode ser avaliado pelo Erro Quadr\u00e1tico M\u00e9dio de predi\u00e7\u00e3o e pela correla\u00e7\u00e3o entre os valores preditos e observados:","e305c0e3":"##### O dataset completo acima cont\u00e9m todos os dados de interesse, de temperatura e CO<sub>2<\/sub>, organizados e ordenados. Podemos agora inciar a etapa de **an\u00e1lise de dados**.","7372f34e":"Primeiramente \u00e9 necess\u00e1rio selecionar os dados a serem usados na modelagem (ano de 1975 em diante):","211168ba":"Os gr\u00e1ficos acima mostram que a incerteza na temperatura \u00e9 extremamente elevada para os dados mais antigos, o que faz sentido, pois os sistemas de medi\u00e7\u00e3o antigos n\u00e3o eram t\u00e3o confi\u00e1veis como os sistemas atuais. As incertezas alcan\u00e7aram n\u00edveis baixos por volta de 1900. Portanto, podemos considerar **Jan\/1900** como marco inicial para o prop\u00f3sito deste estudo. O marco final pode ser **Dez\/2014**, que \u00e9 o t\u00e9rmino dos dados de CO<sub>2<\/sub>, conforme verificado mais acima.\n\nA seguir \u00e9 feita a sele\u00e7\u00e3o dos dados no per\u00edodo considerado.","d2d9f1e7":"#### An\u00e1lise ETS (*Error-Trend-Seasonality*) da temperatura na superf\u00edcie da Terra","9c461314":"<hr>\n\n#### Predi\u00e7\u00e3o da Temperatura Global usando a Concentra\u00e7\u00e3o de CO<sub>2<\/sub> como s\u00e9rie de suporte"}}