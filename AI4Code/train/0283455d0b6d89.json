{"cell_type":{"08a52b6d":"code","814d4947":"code","e3e6a3d1":"code","3af5d4e8":"code","edbaaf98":"code","a1542b6e":"code","5f342950":"code","2e3aeccd":"code","c74abdcd":"code","b57c7487":"code","5a72cd1d":"code","99de137f":"code","ab522197":"code","eb79cfdf":"code","36368630":"code","e6f9a62d":"code","56c4e92b":"code","3eaa3235":"code","2aa4b961":"code","944a9dcc":"code","3b7338ae":"code","8d9a36a4":"code","1f7d1ef7":"code","2ae50c5c":"code","966f8bb0":"code","85dd14bc":"code","89ff2ea1":"code","dec16bcf":"code","9a9489a9":"code","45365fa7":"code","bc524d68":"code","e82f60e1":"code","3aafc22b":"code","41de1183":"code","129653bd":"code","4febaca4":"code","ac34a9a3":"code","5ec6e303":"code","ad11b4cd":"code","da15010f":"code","6149562f":"code","3f0a7528":"code","9cd451d5":"code","a4c94c37":"code","aa20e887":"code","d7749a8d":"code","aa40f50b":"code","902ff282":"code","3490da3c":"code","3e342c24":"code","a8bc053d":"code","602e1945":"code","a4bcb3ec":"code","35024204":"markdown","3af02802":"markdown","9b998b80":"markdown","6da2477d":"markdown"},"source":{"08a52b6d":"import pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sb\ndf = pd.read_csv('\/kaggle\/input\/tabular-playground-series-dec-2021\/train.csv')\n","814d4947":"import os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","e3e6a3d1":"df.info()","3af5d4e8":"for i in df.columns:\n    df[i] = df[i].astype('int16')","edbaaf98":"df.info()","a1542b6e":"df.nunique()","5f342950":"df.drop(['Id','Soil_Type15','Soil_Type7'],axis = 1,inplace = True)","2e3aeccd":"df.shape","c74abdcd":"df.isnull().sum()","b57c7487":"li = [x for x in df.columns]","5a72cd1d":"df.info()","99de137f":"df.tail()","ab522197":"#df['ecldn_dist'] = (df['Horizontal_Distance_To_Hydrology']**2 + df['Vertical_Distance_To_Hydrology']**2)**0.5","eb79cfdf":"#df.head()","36368630":"for cols in df.columns:\n    print(cols,':',df[cols].value_counts().nunique())","e6f9a62d":"df['Cover_Type'].value_counts()","56c4e92b":"import numpy as np\ndf.drop(df.loc[df['Cover_Type'] == 5].index, inplace = True)","3eaa3235":"df.drop(df.loc[df['Cover_Type'] == 4].index, inplace = True)","2aa4b961":"df.loc[df['Cover_Type'] == 4].index","944a9dcc":"df.loc[df['Cover_Type'] == 4].index","3b7338ae":"len(df)","8d9a36a4":"x = df.drop('Cover_Type', axis = 1)\ny = df[['Cover_Type']]","1f7d1ef7":"num_cols = [\n    \"Elevation\",\n    \"Aspect\",\n    \"Slope\",\n    \"Horizontal_Distance_To_Hydrology\",\n    \"Vertical_Distance_To_Hydrology\",\n     \"Horizontal_Distance_To_Roadways\",\n    \"Hillshade_9am\",\n    \"Hillshade_Noon\",\n    \"Hillshade_3pm\",\n    \"Horizontal_Distance_To_Fire_Points\",\n]","2ae50c5c":"from sklearn.preprocessing import StandardScaler\nscaler =  StandardScaler()\ndf[num_cols] = scaler.fit_transform(df[num_cols])\n","966f8bb0":"df","85dd14bc":"df.shape","89ff2ea1":"from sklearn.model_selection import train_test_split\nx_train,x_test,y_train,y_test = train_test_split(x,y,train_size = 0.70,random_state = 456)\n#x_train = df.drop('Cover_Type',axis = 1)\n#y_train = df['Cover_Type']","dec16bcf":"x_test.shape","9a9489a9":"from xgboost import XGBClassifier as xgb\nxg = xgb(tree_method = 'gpu_hist')\nxg","45365fa7":"params = {'gamma':[0.1,0.2,0.3,0.4,0.5,0.6,0.7],\n         'learning_rate':[0.01,0.05,0.08,0.1,0.2,0.3,0.4,0.5],\n         'n_estimators':[80,100,120,140,160,180,200],\n         'max_depth':[2,3]}","bc524d68":"xgb_params = {\n    'objective': 'multi:softmax',\n    'eval_metric': 'merror', \n    \n    \n    'max_depth': 7\n    }\nxg = xgb(n_estimators = 180, learning_rate= 0.5, gamma= 0.1,**xgb_params).fit(x_train,y_train)","e82f60e1":"predXGB = xg.predict(x_test)","3aafc22b":"xg.score(x_train,y_train)","41de1183":"xg.score(x_test,y_test)","129653bd":"df_test = pd.read_csv('\/kaggle\/input\/tabular-playground-series-dec-2021\/test.csv')","4febaca4":"df_test.info()","ac34a9a3":"for t in df_test.columns:\n    df_test[t] = df_test[t].astype('int16')","5ec6e303":"df_test.info()","ad11b4cd":"df_test.drop(['Id'],axis = 1,inplace = True)","da15010f":"df_test.drop(['Soil_Type7','Soil_Type15'],axis = 1, inplace = True)","6149562f":"#df_test['ecldn_dist'] = ((df_test['Horizontal_Distance_To_Hydrology'])**2 + (df_test['Vertical_Distance_To_Hydrology'])**2)**0.5","3f0a7528":"df_test.head()","9cd451d5":"y_test = df_test","a4c94c37":"df.shape","aa20e887":"df.info()","d7749a8d":"df_test.isnull().sum()","aa40f50b":"#df_test.drop('ecldn_dist',axis = 1, inplace = True)","902ff282":"predXGB = xg.predict(y_test)\npredXGB","3490da3c":"submission = pd.DataFrame({'Id' : [x for x in range(4000000,5000000)]})","3e342c24":"submission['Cover_Type'] = predXGB","a8bc053d":"submission","602e1945":"submission['Cover_Type'].value_counts()","a4bcb3ec":"submission.to_csv('submission.csv',index = False)","35024204":"# Validation","3af02802":"# XGBClassifier","9b998b80":"# Test Data","6da2477d":"# RandomSearchCV"}}