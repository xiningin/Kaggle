{"cell_type":{"295e4e92":"code","9f695e23":"code","17081ef2":"code","1f140db7":"code","b8cfdac3":"code","1a986270":"code","ae11e5db":"code","8701fa8d":"code","c446b6f0":"code","f0f3deb8":"code","2e104fd0":"code","2dee5cb2":"code","a624644f":"code","538d28b0":"code","f8c69aad":"code","72ed6ed4":"code","edc86909":"code","248a303f":"code","2e454854":"code","c343a251":"code","b24785ad":"code","033d2f66":"code","3773d9a8":"code","4dd1925b":"code","78264b08":"code","b3482eca":"code","faf943d2":"code","53ef34f0":"code","5766b1b9":"code","44789946":"code","c8ec48e4":"code","843d293d":"code","b0d95984":"code","40382e9b":"code","4d163c28":"code","342804fb":"code","4995b166":"code","39e922fd":"code","fedb7df7":"code","6d0178cf":"code","e0aca134":"code","620745a8":"code","c082f914":"markdown","c6966ef4":"markdown","0b93f7f3":"markdown","a3bce6e4":"markdown","741d0317":"markdown","e49158ef":"markdown","f4b136f6":"markdown","6ee41ad5":"markdown","82fcc52c":"markdown","376b0ac8":"markdown","4d8b9034":"markdown","1ff1d02f":"markdown","f106f508":"markdown","3f054c56":"markdown","ee9ea71a":"markdown","067f129b":"markdown","dc72f915":"markdown","dbba16ff":"markdown","cd9fc2d8":"markdown","89fe7590":"markdown","76288eba":"markdown","c4caef6d":"markdown","4d92530f":"markdown","7fd36717":"markdown","5df9b609":"markdown","0bfc0bce":"markdown","b41c3a10":"markdown","c8818577":"markdown","f27997fd":"markdown","34b7d117":"markdown","f61c526d":"markdown","9d4a4649":"markdown","ae9ea4bd":"markdown","46202566":"markdown","004f8179":"markdown"},"source":{"295e4e92":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session\n","9f695e23":"import matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline\nfrom pandas_profiling import ProfileReport","17081ef2":"fish = pd.read_csv('..\/input\/fish-market\/Fish.csv')","1f140db7":"fish.head()","b8cfdac3":"fish.shape","1a986270":"ProfileReport(fish)","ae11e5db":"fish.info()","8701fa8d":"# knowing some descriptive statistic about data\nfish.describe()","c446b6f0":"fish['Species'].unique()","f0f3deb8":"sns.countplot(fish['Species'])\nplt.title('The number of each type of fish')\nplt.show()","2e104fd0":"def box(var):\n    # this function take the variable and return a boxplot for each type of fish\n    sns.boxplot(x=\"Species\", y=var, data=fish,palette='rainbow')\n    ","2dee5cb2":"fig, ax = plt.subplots(2, 3,figsize=(20,15))\nplt.subplot(2,3,1)\nbox('Weight')\nplt.subplot(2,3,2)\nbox('Length1')\nplt.subplot(2,3,3)\nbox('Length2')\nplt.subplot(2,3,4)\nbox('Length3')\nplt.subplot(2,3,5)\nbox('Height')\nplt.subplot(2,3,6)\nbox('Width')","a624644f":"sns.pairplot(data=fish)","538d28b0":"sns.pairplot(data=fish,hue='Species')\nplt.title('pairwise relationships in a dataset')","f8c69aad":"sns.heatmap(fish.corr(),cmap='coolwarm',annot=True,linecolor='white',linewidths=4)","72ed6ed4":"fish.drop(['Length1','Length2','Length3'],axis=1,inplace=True)","edc86909":"fish.head()","248a303f":"fish.head()","2e454854":"filt_df = fish.iloc[:,1:]","c343a251":"#computing percentiles\nlow = .05\nhigh = .95\nquant_df = filt_df.quantile([low, high])\nprint(quant_df)","b24785ad":"filt_df = filt_df.apply(lambda x: x[(x>quant_df.loc[low,x.name]) & \n                                    (x < quant_df.loc[high,x.name])], axis=0)","033d2f66":"filt_df = pd.concat([fish.iloc[:,0], filt_df], axis=1)","3773d9a8":"filt_df.info()","4dd1925b":"filt_df.describe()","78264b08":"fish =filt_df.dropna()","b3482eca":"X = fish.drop('Weight',axis=1)\ny=fish['Weight']","faf943d2":"f_type =pd.get_dummies(X['Species'],drop_first=True)","53ef34f0":"f_type.head()","5766b1b9":"X.drop('Species',axis=1,inplace=True)","44789946":"X = pd.concat([X,f_type],axis=1)","c8ec48e4":"X.head()","843d293d":"#spliting the dataset into training set and test set\nfrom sklearn.model_selection import train_test_split\nX_train ,X_test , y_train , y_test =train_test_split(X,y, test_size = 0.2 , random_state=4)","b0d95984":"from sklearn.linear_model import LinearRegression\n#Create an instance of a LinearRegression() model named lm.\nlm=LinearRegression()\n# fit the model\nlm.fit(X_train,y_train)","40382e9b":"print('Coefficients: \\n', lm.coef_)","4d163c28":"print('intercept: \\n',lm.intercept_)","342804fb":"s=pd.DataFrame(X_train)\ns.head()","4995b166":"# Predicting the Test set results\npredictions = lm.predict( X_test)\n","39e922fd":"plt.scatter(y_test,predictions)\nplt.xlabel('Y Test')\nplt.ylabel('Predicted Y')","fedb7df7":"# calculate these metrics by hand!\nfrom sklearn import metrics\n\nprint('MAE:', metrics.mean_absolute_error(y_test, predictions))\nprint('MSE:', metrics.mean_squared_error(y_test, predictions))\nprint('RMSE:', np.sqrt(metrics.mean_squared_error(y_test, predictions)))","6d0178cf":"sns.distplot((y_test-predictions),bins=20);","e0aca134":"coeff_df = pd.DataFrame(lm.coef_,X.columns,columns=['Coefficient'])\ncoeff_df","620745a8":"print('intercept: \\n',lm.intercept_)","c082f914":"# Training and Testing Data\n\nNow that we've explored the data a bit, let's go ahead and split the data into training and testing sets.","c6966ef4":"# EDA","0b93f7f3":"# Prepare data before modeling it","a3bce6e4":"Length1 is highly correlated with Weight (\u03c1 = 0.91571)\n","741d0317":"Next filtering values based on computed percentiles. To do that I use an apply by columns and that's it !","e49158ef":"h(X)= -627.64 + 41.41 Height + 110 Width + 63.98 Parkki + 139.397 Perch + 314.32 Pike + 101.27 Roach + 341.61 Smelt + 89.688 Whitefish","f4b136f6":"# Predicting Test Data\nNow that we have fit our model, let's evaluate its performance by predicting off the test values!","6ee41ad5":"Length2 is highly correlated with Length1 (\u03c1 = 0.99952)\n","82fcc52c":" I hope you enjoy this study and I would appreciate if you add your comments below.\n\n Seif Mohamed","376b0ac8":"One of the reasons why prech is the best-selling fish type is that I have weights and lengths of different sizes that make it easy to pick your fluff out","4d8b9034":"## Training the Model\n\nNow its time to train our model on our training data!","1ff1d02f":"Reporting data to know more details about it","f106f508":"# Residuals\n\nwe should have gotten a very good model with a good fit. Let's quickly explore the residuals to make sure everything was okay with our data. ","3f054c56":"Let me show you what the training data looks like","ee9ea71a":"This dataset is a record of 7 common different fish species in fish market sales. With this dataset, a predictive model can be performed using machine friendly data and estimate the weight of fish can be predicted.","067f129b":"let's divide the data for the part that we want to estimate, and the other part is the variable we will use.","dc72f915":"# Evaluating the Model\n\nLet's evaluate our model performance by calculating the residual sum of squares and the explained variance score (R^2).","dbba16ff":"#### Print out the coefficients and intercept of the model","cd9fc2d8":"let's show the distribution of Species ","89fe7590":"## Now let's know the correlation between the variables","76288eba":"Let's load the file and see what the data looks like.","c4caef6d":"Since linear regression requires numerical variables and the genre variable is a categorical variable, we'll use a technique called one-hot encoding to convert the categorical variables to numerical. This technique transforms each category value into a new column and assigns a 1 or 0 to the column.","4d92530f":"let's import the necessary libraries.","7fd36717":"So let's explore each type of fish alone","5df9b609":"The type of fish that is called perch is the most numerous","0bfc0bce":"### drop Outliers","b41c3a10":"The type of fish called white fish is the least numerous","c8818577":"# The dataset","f27997fd":"### We can see that there is a large correlation between variables, especially the longest, so we will drop them\nLength1 is highly correlated with Weight (\u03c1 = 0.91571)\n\nLength2 is highly correlated with Length1 (\u03c1 = 0.99952)\n\nLength3 is highly correlated with Length2 (\u03c1 = 0.9941)","34b7d117":"### drop the missing value","f61c526d":"After exploring the data, we found that there are seven types of best-selling fish are ['Bream', 'Roach', 'Whitefish', 'Parkki', 'Perch', 'Pike', 'Smelt'] and there are strong relationships between\n\n","9d4a4649":"Length3 is highly correlated with Length2 (\u03c1 = 0.9941)","ae9ea4bd":"# The equation is:","46202566":"# Now let's know more information about each type of fish","004f8179":"Bringing the athort columns back."}}