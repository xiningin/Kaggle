{"cell_type":{"cf7d316a":"code","84893ef2":"code","e0ece722":"code","ab6b500d":"code","5f533b15":"code","81026a77":"code","c4ab07da":"code","2d54540b":"code","36914d66":"code","fe9003c1":"code","3ac6040a":"code","fc950272":"code","4765f838":"code","f20849d2":"code","ce4a4821":"code","ba26c47b":"code","f9392218":"code","0bc50d1e":"markdown","f9de0156":"markdown"},"source":{"cf7d316a":"import os\nimport numpy as np\nimport torch\n\nfrom fastai.transforms import tfms_from_model\nfrom fastai.conv_learner import ConvLearner\nfrom fastai.model import resnet34\nfrom fastai.dataset import ImageClassifierData\nfrom fastai.plots import ImageModelResults","84893ef2":"PATH = \"..\/input\/\"\nTMP_PATH = \"\/tmp\/tmp\"\nMODEL_PATH = \"\/tmp\/model\/\"","e0ece722":"torch.cuda.is_available()","ab6b500d":"fnames = np.array([f'train\/{f}' for f in sorted(os.listdir(f'{PATH}train'))])\nlabels = np.array([(0 if 'cat' in fname else 1) for fname in fnames])","5f533b15":"labels","81026a77":"fnames","c4ab07da":"arch=resnet34\nsz=224","2d54540b":"learning_rate = 0.01\ntraining_length = 2 # epochs","36914d66":"data = ImageClassifierData.from_names_and_array(\n    path=PATH, \n    fnames=fnames, \n    y=labels, \n    classes=['dogs', 'cats'], \n    test_name='test', \n    tfms=tfms_from_model(arch, sz)\n)","fe9003c1":"learner = ConvLearner.pretrained(arch, data, precompute=True, tmp_name=TMP_PATH, models_name=MODEL_PATH)\nlearner.fit(learning_rate, training_length)","3ac6040a":"# predictions for the validation set\nlog_preds = learner.predict()\n\n# a class that will help us plot our results\nresults = ImageModelResults(data.val_ds, log_preds)","fc950272":"cats = 0\ndogs = 1","4765f838":"results.plot_most_correct(cats)","f20849d2":"results.plot_most_correct(dogs)","ce4a4821":"results.plot_most_incorrect(cats)","ba26c47b":"results.plot_most_incorrect(dogs)","f9392218":"results.plot_most_uncertain(cats)","0bc50d1e":"# Building an image classifier\nMaterial from fast.ai lesson 1 (https:\/\/github.com\/fastai\/fastai\/blob\/master\/courses\/dl1\/lesson1.ipynb), adapted to run on Kaggle kernels","f9de0156":"# Checking our model's predictions"}}