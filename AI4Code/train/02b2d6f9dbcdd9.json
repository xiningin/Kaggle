{"cell_type":{"414ea33f":"code","7b847da7":"code","66f8c79e":"code","8df21929":"code","9baaaa04":"code","512b623c":"code","2cadea10":"code","dd642cca":"code","edfa5def":"code","4ba69f09":"code","56745f2e":"code","c434b683":"code","6211e000":"code","6f37f631":"code","9b77c222":"code","75bac7d4":"code","d12bee55":"code","a3821e3e":"code","1c372160":"code","8a9261c5":"code","c2a3e8bf":"code","ec198571":"code","d4a1093e":"code","8f1055fd":"code","d7ec0a11":"code","8df4e42e":"code","0c0d842b":"code","4004d8eb":"code","50d558c0":"code","1e7a1bbc":"code","a339b07f":"code","22f48272":"code","ef0ac906":"code","3ffc3e93":"code","ce639de8":"code","82f38442":"code","44bf481b":"code","d3d2e2b3":"code","84b3ee4a":"code","1e853d23":"code","1849bd42":"markdown","975c02d9":"markdown"},"source":{"414ea33f":"#we will start with importing the essential libraries for data preprocessing.","7b847da7":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\npd.set_option('display.max_columns',50)\nsns.set_style('darkgrid')","66f8c79e":"%matplotlib inline","8df21929":"## Import the dataset","9baaaa04":"data=pd.read_csv('..\/input\/breast-cancer-wisconsin-data\/data.csv')","512b623c":"## Let's have a look at the dataset","2cadea10":"print(data.shape)\ndata.head()","dd642cca":"# Have a look at target: diagnosis\ndata['diagnosis'].value_counts().plot(kind='bar')","edfa5def":"## dataset has 33 columns and 569 of total rows. Data has one categorical column 'diagnosis' which infact our target column. Id is the index value column and last column is 'unnamed:32' which appers to have lots of NA values. So next it is important to check the data for missing values.","4ba69f09":"data.isnull().sum()","56745f2e":"## As we can see only one columns 'Unnamed:32' has missing value. So we will drop this column.","c434b683":"data.drop(columns=['id', 'Unnamed: 32'],axis=1, inplace=True)","6211e000":"## Let us have a look at trends in dataset.","6f37f631":"data.describe()","9b77c222":"# We can notice that mean and median has difference in every column. In some column this gap is more than the others. This gap indicates that data is skewed in some sense. \n#So let's plot the distribution of column to have better look at data.","75bac7d4":"for features in data._get_numeric_data().columns:\n    sns.distplot(data[features])\n    plt.title('Skew : '+str(np.round(data[features].skew(),4)))\n    plt.show()","d12bee55":"## Looking at the plots, it is clearly evident that most columns are not normally distributed and appear to be skewed. Some skewness have value more than +5.0. So it is important to deal with the skewnwess of data and bring data if not to normal distrubution, then at least close to it.","a3821e3e":"# Two of many ways to deal with skewness are :Logarithmic transformation and Square root transformation. ","1c372160":"for features in data._get_numeric_data().columns:\n    print(features, ' : ','skew in Log transformation :', np.round(np.log(data[features]).skew(),4),',', end='')\n    print('\\t','skew in Square root trasnformatioon', ' : ', np.round(np.sqrt(data[features]).skew(),4))","8a9261c5":"## Looking at above output, it is evident that logarithmic transformation has dealt with skewness in a better way than the square root transformation. But logarithmic transforamtion has some output as 'NAN'. This is becuase those columns have zeroes as value in it and log of zero is undefined. On the other hand square root transformation handles these columns well.\n## So We will use Square root transormation in columns that have '0' as values and log for rest.","c2a3e8bf":"for features in data._get_numeric_data().columns:\n    plt.figure(figsize=(6,6))\n    if 0 in data[features].unique():\n        data[features]=np.round(np.sqrt(data[features]),4)\n        sns.distplot(data[features])\n        plt.title('Skew : '+str(np.round(data[features].skew(),4)))\n        plt.show()\n    else:\n        data[features]=np.round(np.log(data[features]),4)\n        sns.distplot(data[features])\n        plt.title('Skew : '+str(np.round(data[features].skew(),4)))\n        plt.show()","ec198571":"## All the features have skewness in the range of +-0.5 which is much less than what we had earlier.","d4a1093e":"# Now we will look at correlation between independent variables in data.","8f1055fd":"plt.figure(figsize=(20,10))\nsns.heatmap(data.corr(), annot=True)\nplt.show()","d7ec0a11":"## WOW, this tells a completely diffent story about data. Many features are strongly correlated and data show high level of multi-collinearity.\n## One way to decrease multi-collinarity is by dropping features that show strong correlation(>0.85). So we prepare a list of columns with strong correlation value and drop them.","8df4e42e":"col_2_Drop=['perimeter_mean','area_mean','concavity_mean','concave points_mean','radius_se','area_se','compactness_se','concavity_se','radius_worst','area_worst','perimeter_worst','compactness_worst','concave points_worst','texture_worst']","0c0d842b":"plt.figure(figsize=(20,12))\nsns.heatmap(data.drop(columns=col_2_Drop).corr(),annot=True)\nplt.show()","4004d8eb":"# Much better now. Though there are fewer features than earlier but data seems promising.","50d558c0":"#let's set our target variable now and prepare the for next process.","1e7a1bbc":"target=data['diagnosis']\ndataset=data.drop(columns=col_2_Drop+['diagnosis'])","a339b07f":"dataset.head()","22f48272":"## now that we have dealt with correlation and normality. Let's split the data set into a train and a test set.","ef0ac906":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(dataset,target, test_size=.25, random_state=42)","3ffc3e93":"## Now we have a train and test. Lets scale them and bring whole data on same level.\nfrom sklearn.preprocessing import StandardScaler\nsc=StandardScaler()\nX_train=sc.fit_transform(X_train)\nX_test=sc.transform(X_test)","ce639de8":"#Our target is a categorical data with labels M and B. We have to encode these labels as 0 and 1.\nfrom sklearn.preprocessing import LabelEncoder\nle=LabelEncoder()\ny_train=le.fit_transform(y_train)\ny_test=le.transform(y_test)","82f38442":"from sklearn.linear_model import LogisticRegression\nfrom sklearn.svm import SVC\nfrom sklearn.naive_bayes import GaussianNB\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.metrics import confusion_matrix, accuracy_score","44bf481b":"model_name=[]\nmean_validadtion_score=[]\ntraining_score=[]\ntest_accuracy_score=[]\ndef algorithm(models,X_train,y_train,X_test, Y_test):\n    for model in models:\n        model=model()\n        model.fit(X_train,y_train)\n        score=cross_val_score(model,X_train,y_train,cv=5)\n        print('Mean cross-validation Score for',model,' is :',score.mean())\n        y_pred=model.predict(X_test)\n        print('Training score of ',model,' is :',model.score(X_train,y_train))\n        print('Accuracy score of ',model,' is :', accuracy_score(y_test,y_pred))\n        print('\\n','Confusion matrix \\n',confusion_matrix(y_test,y_pred))\n        print('\\n')\n        print('-'*100)\n        print('\\n')\n        model_name.append(model)\n        mean_validadtion_score.append(np.round(score.mean(),4))\n        training_score.append(np.round(model.score(X_train,y_train),4))\n        test_accuracy_score.append(np.round(accuracy_score(y_test,y_pred),4))","d3d2e2b3":"models=[LogisticRegression,SVC,GaussianNB,KNeighborsClassifier,DecisionTreeClassifier,RandomForestClassifier]\nalgorithm(models,X_train,y_train,X_test,y_test)","84b3ee4a":"df=pd.DataFrame()\ndf['Models']=[str(x) for x in model_name]\ndf['Mean cross-val-score']=mean_validadtion_score\ndf['Training Score']=training_score\ndf['Accuracy Score']=test_accuracy_score","1e853d23":"df","1849bd42":"# Breast Cancer Data Analysis and Prediction","975c02d9":"### We can see the performance of different models in above dataframe.\n### Linear models have consistent score in all three scoring.\n### One can choose SVC or LogisticRegression and tune it with hyperparameter for further procees."}}