{"cell_type":{"6f31f67d":"code","0be367f8":"code","5b42a49f":"code","1b728aeb":"code","f432682f":"code","fb43d58c":"code","1261b037":"code","31f64c98":"code","5bb87b37":"code","25a86470":"markdown","307eceb4":"markdown","72a71c6b":"markdown","6331c1b8":"markdown","8f974734":"markdown","916cf525":"markdown","432855a3":"markdown","5afb4150":"markdown","47f36a1c":"markdown","0ce362ba":"markdown","b8279077":"markdown","d1e03645":"markdown","13393ba5":"markdown","20b3393f":"markdown","637730fd":"markdown","ad4dcfc9":"markdown"},"source":{"6f31f67d":"import matplotlib.pyplot as plt\nimport pandas as pd\nimport pylab as pl\nimport numpy as np\n%matplotlib inline","0be367f8":"df = pd.read_csv(\"..\/input\/FuelConsumptionCo2.csv\")\n# take a look at the dataset\ndf.head()","5b42a49f":"cdf = df[['ENGINESIZE','CYLINDERS','FUELCONSUMPTION_CITY','FUELCONSUMPTION_HWY','FUELCONSUMPTION_COMB','CO2EMISSIONS']]\ncdf.head(9)","1b728aeb":"cdf.dtypes","f432682f":"# At the same time you can check with below syntex as well where you can see the sum of missing values available into data\ncdf.isnull().sum()","fb43d58c":"cdf.hist(bins=50,figsize=(15,12))\nplt.show()","1261b037":"from sklearn import linear_model\nmsk = np.random.rand(len(df)) < 0.8\ntrain = cdf[msk]\ntest = cdf[~msk]\nregr = linear_model.LinearRegression()\nx = np.asanyarray(train[['ENGINESIZE','CYLINDERS','FUELCONSUMPTION_COMB']])\ny = np.asanyarray(train[['CO2EMISSIONS']])\nregr.fit (x, y)\n# The coefficients\nprint ('Coefficients: ', regr.coef_)","31f64c98":"y_hat= regr.predict(test[['ENGINESIZE','CYLINDERS','FUELCONSUMPTION_COMB']])\nx = np.asanyarray(test[['ENGINESIZE','CYLINDERS','FUELCONSUMPTION_COMB']])\ny = np.asanyarray(test[['CO2EMISSIONS']])\nprint(\"Residual sum of squares: %.2f\"\n      % np.mean((y_hat - y) ** 2))\n\n# Explained variance score: 1 is perfect prediction\nprint('Variance score: %.2f' % regr.score(x, y))","5bb87b37":"import seaborn as sns\n\nax2 = sns.distplot(y, hist=False, color=\"r\", label=\"Actual Value\")\nsns.distplot(y_hat, hist=False, color=\"b\", label=\"Fitted Values\" , ax=ax2)\n\nplt.title('Actual vs Fitted Values for Emission')\nplt.xlabel('Co2 Emission')\nplt.ylabel('Proportion of Engine')\n\nplt.show()\nplt.close()\n","25a86470":"In the above code we are testing our data with the same parameter used for train. Residual sum of squares (RSS), also known as the sum of squared residuals (SSR) or the sum of squared estimate of errors (SSE).","307eceb4":"Let's test our model on the data","72a71c6b":"Lets read and view the data","6331c1b8":"In reality there are multiple factor that can affect the CO2 emission.This process of predicting one varible with one or more independent variable is called as Multile regression","8f974734":"# Prediction","916cf525":"RSS is the sum of the squared differences between the actual Y and the predicted Y.The lesser the RSS the better is the fit.The more the value the poor is the model. A perfect value for RSS is 0. One of the major usage of RSS is to predict the value of R2.","432855a3":"In our case the variance Score is 0.85 which can be considered as a good value.","5afb4150":"Lets get the graph of each of the coloumns in cdf","47f36a1c":"lets check the data type ","0ce362ba":"Coefficient and Intercept are two parameters which can help to estimate a fit line.","b8279077":"Variance score:\nIf Y_hat is the estimated target output, y the corresponding target output, and Var is Variance, the square of the standard deviation, then the explained variance is estimated as follow:\n\n\ud835\ude85\ud835\ude8a\ud835\ude9b\ud835\ude92\ud835\ude8a\ud835\ude97\ud835\ude8c\ud835\ude8e(\ud835\udc66,Y_hat )=1\u2212(\ud835\udc49\ud835\udc4e\ud835\udc5f{\ud835\udc66\u2212Y_hat }\/\ud835\udc49\ud835\udc4e\ud835\udc5f{\ud835\udc66})","d1e03645":"Lets see how fit is our model through graph","13393ba5":"Time for train and test  the data. This is the most popular approach in machine learning algorithm where we first train our model with a limited data and then use the train data to test the data to attain the prediction.It is more realistic for real world problems.","20b3393f":"random.rand(len(df)) is an array of size len(df) with randomly and uniformly distributed float values in range [0, 1]. The < 0.8 applies the comparison element-wise and stores the result in place. Thus values < 0.8 become True and value >= 0.8 become False ","637730fd":"Lets select some features that we want to use for regression.","ad4dcfc9":"In the above dataset we have many coloumns that are not relevant or might not be of much use for our prediction so we will have a new data set which will have only listed coloumns that will be used for prediction"}}