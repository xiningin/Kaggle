{"cell_type":{"64643ab9":"code","a74ea153":"code","d4c665ef":"code","69596d34":"code","97eb821b":"code","b43a0e97":"code","425739d4":"code","444996b3":"code","296fa8ac":"markdown","2f7fec82":"markdown","4f6e5813":"markdown","95aa643c":"markdown","308e4187":"markdown","c9cd7619":"markdown"},"source":{"64643ab9":"! pip3 install pixellib","a74ea153":"!wget --quiet https:\/\/github.com\/matterport\/Mask_RCNN\/releases\/download\/v2.0\/mask_rcnn_coco.h5","d4c665ef":"import cv2\nimport math\n\nfrom matplotlib import pyplot as plt\nimport numpy as np\n\nimport pixellib\nfrom pixellib.instance import instance_segmentation","69596d34":"segment_image = instance_segmentation()\nsegment_image.load_model(\"..\/input\/mask-rcnn-coco-weights\/mask_rcnn_coco.h5\") ","97eb821b":"image_file = '..\/input\/d\/marialeghari\/images\/car.jpeg'\ntarget_classes = segment_image.select_target_classes(car=True, truck=True)","b43a0e97":"\nsegmask, output = segment_image.segmentImage(image_file,segment_target_classes= target_classes)\nsegment = 0\nsegment_number = -1\nmax_seg_area = 0\ncount = 0\nfor seg in segmask['rois']:\n    area = math.sqrt(((seg[2]-seg[0])**2)+((seg[3]-seg[1])**2))\n    if max_seg_area < area:\n        max_seg_area = area\n        segment = seg\n        segment_number = count\n    count +=1\nseg_mask = segmask['masks']\n\nmask = np.zeros((seg_mask.shape[0], seg_mask.shape[1], 3))\nseg_mask = seg_mask*1\nse_count = 0\nfor seg in seg_mask:\n    s_count = 0\n    for se in seg:\n        if se[segment_number]:\n            mask[se_count][s_count] = [255, 255, 255]\n        s_count += 1\n    se_count += 1\n    \nnp.unique(map)\norig_imginal = cv2.imread(image_file)\norig_imginal = cv2.cvtColor(orig_imginal, cv2.COLOR_BGR2RGB)\norig_imginal = np.array(orig_imginal)\nblurred_original_image = cv2.GaussianBlur(orig_imginal, (45,45), 0)\nlayered_image = np.where(mask != (0,0,0), orig_imginal, blurred_original_image)","425739d4":"im_rgb = cv2.cvtColor(layered_image, cv2.COLOR_RGB2BGR) # Saving the new bokeh image.\nplt.imshow(layered_image)\ncv2.imwrite(\".\/new1.png\", im_rgb)","444996b3":"from pixellib.tune_bg import alter_bg\n\nchange_bg = alter_bg(model_type = \"pb\")\nchange_bg.load_pascalvoc_model(\"..\/input\/dataset\/xception_pascalvoc.pb\")\ni = change_bg.blur_bg(image_file, moderate = True, detect = \"car\", output_image_name=\"blur_img.jpg\")\nim_rgb = cv2.cvtColor(i, cv2.COLOR_RGB2BGR)\nimage = Image.fromarray(im_rgb)\nimage","296fa8ac":"## At first install pixellib library","2f7fec82":"## Import Needed Libraries","4f6e5813":"## Select and Give File Path and Select Target Classes","95aa643c":"## Download mask rcnn coco weights","308e4187":"## Load Mask Rcnn Coco Model","c9cd7619":"# **Built in PixelLib Blur Background code using Semantic Segmentation**"}}