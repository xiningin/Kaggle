{"cell_type":{"c7194d2c":"code","60dcf3f1":"code","3e059b3c":"code","9f2ed69d":"code","fe74bd65":"code","87a9fc29":"code","75e6b774":"code","19a4b3af":"code","4d847e49":"code","888885cc":"code","4d3fad62":"code","cffc02d4":"code","220ec4ea":"code","6dd04327":"code","63e69d8d":"code","33b9cff5":"code","250cfa0d":"code","52e5507e":"code","ce0f4495":"code","d7636fce":"code","b3bae7f6":"code","65b64132":"code","4434fb23":"code","950f75a7":"code","61b93bf0":"code","9af6fe2c":"code","f7b428b8":"code","938917e2":"code","fde2c937":"code","661a4fdb":"code","88fc768e":"code","7b504d63":"markdown","808e8937":"markdown","db94c9c9":"markdown","497e3dda":"markdown","8b301740":"markdown","74b2779a":"markdown","a84cc5a7":"markdown","514a9ea4":"markdown","84e322bc":"markdown","e2d95548":"markdown","e3fe4d70":"markdown","eaa335a7":"markdown","fbc0c556":"markdown","eef764ce":"markdown","34824365":"markdown","683e3201":"markdown","22ce1dce":"markdown","6a99d1a8":"markdown","553f0fcb":"markdown","13e17ae1":"markdown","ddb31342":"markdown"},"source":{"c7194d2c":"import pandas as pd\nimport seaborn as sns\nimport sklearn as sk\nimport matplotlib.pyplot as plt\nimport numpy as np \nfrom sklearn import tree\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.model_selection import GridSearchCV","60dcf3f1":"sns.set(rc={'figure.figsize' : (9, 6)})","3e059b3c":"train_df = pd.read_csv('\/kaggle\/input\/titanic\/train.csv')\ntest_df = pd.read_csv('\/kaggle\/input\/titanic\/test.csv')","9f2ed69d":"train_df.head()","fe74bd65":"train_df.info()","87a9fc29":"train_df.describe().T","75e6b774":"train_df.isnull().sum() \/ len(train_df)","19a4b3af":"test_df.isnull().sum() \/ len(train_df)","4d847e49":"fig, ax = plt.subplots(1, 2)\ntrain_df[\"Sex\"].value_counts().plot(kind='bar',\n                                    title= 'Number of people by gender in training set',\n                                    xlabel= 'Sex',\n                                    ylabel= 'Number',\n                                    ax=ax[0])\nax[1].set_title('Number of survivors per gender')\nsns.countplot(data=train_df, \n              x='Sex',\n              hue='Survived',\n              ax=ax[1])\nplt.show()","888885cc":"sns.displot(train_df,\n           x = 'Age',\n           col = 'Sex',\n           hue = 'Survived')","4d3fad62":"fig, ax = plt.subplots(1, 2)\ntrain_df[\"Pclass\"].value_counts().plot(kind='bar',\n                                    title= 'Number of people by pclass in training set',\n                                    xlabel= 'Pclass',\n                                    ylabel= 'Number',\n                                    ax=ax[0])\nax[1].set_title('Number of survivors per pclass')\nsns.countplot(data=train_df, \n              x='Pclass',\n              hue='Survived',\n              ax=ax[1])\nplt.show()","cffc02d4":"fig, ax = plt.subplots(1, 3)\ntrain_df['Embarked'].value_counts().plot(kind = 'bar',\n                                         title= 'Number of people by Embarked in train',\n                                         xlabel= 'Embarked',\n                                         ylabel= 'Number',\n                                         ax=ax[0])\nax[1].set_title('Male survivors')\nsns.countplot(data=train_df[train_df['Sex']=='male'],\n              x='Embarked',\n              hue='Survived',\n              ax=ax[1])\nax[2].set_title('Female survivors')\nsns.countplot(data=train_df[train_df['Sex']=='female'],\n              x='Embarked',\n              hue='Survived',\n              ax=ax[2])","220ec4ea":"sns.heatmap(train_df.corr(), annot=True, cmap='viridis_r', fmt='.2f');","6dd04327":"train_df = train_df.drop(['PassengerId', 'Name', 'Ticket', 'Cabin'], axis = 1)\ntrain_df.head()","63e69d8d":"train_df.dropna(subset=[\"Embarked\"], inplace=True)\ntrain_df.info()","33b9cff5":"train_df = pd.get_dummies(train_df)\ntest_df = pd.get_dummies(test_df)","250cfa0d":"train_df.head()","52e5507e":"train_df = train_df.fillna({'Age' : train_df.Age.mean()})\ntest_df = test_df.fillna({'Age' : test_df.Age.mean()})\ntest_df = test_df.fillna({'Fare' : test_df.Age.mean()})","ce0f4495":"train_selected_features=['Pclass', 'Age', 'SibSp', 'Parch', 'Fare', 'Sex_female', 'Sex_male', 'Embarked_C', 'Embarked_Q', 'Embarked_S']\nX_train, X_val, y_train, y_val = train_test_split(train_df[train_selected_features],\n                                                  train_df[\"Survived\"],\n                                                  test_size = 0.3,\n                                                  stratify = train_df[\"Survived\"],\n                                                  random_state=42)","d7636fce":"X_train.head()","b3bae7f6":"test_selected_features=['Pclass', 'Age', 'SibSp', 'Parch', 'Fare', 'Sex_female', 'Sex_male', 'Embarked_C', 'Embarked_Q', 'Embarked_S']\nX_test = test_df[test_selected_features]","65b64132":"X_test.head()","4434fb23":"rf_clf = RandomForestClassifier()","950f75a7":"parametrs = {'n_estimators' : list(range(1, 24)), 'max_depth' : list(range(1, 10))}","61b93bf0":"grid_search_cv_clf = GridSearchCV(rf_clf, parametrs)","9af6fe2c":"grid_search_cv = grid_search_cv_clf.fit(X_train, y_train)","f7b428b8":"best_clf = grid_search_cv_clf.best_estimator_\nbest_clf","938917e2":"best_clf.score(X_val, y_val)","fde2c937":"test_df['Survived'] = best_clf.predict(X_test)\nsubmission = test_df[[\"PassengerId\", \"Survived\"]]","661a4fdb":"submission.head()","88fc768e":"submission.to_csv(\"submission.csv\", index=False)","7b504d63":"I'll do same for test data","808e8937":"1. 19.86% of the entries in the \"Age\" column are missing. I'll replace them with mean value. \n2. 77.10% of the entries in the \"Cabin\" column are missing. It may be droped as it doesn't provide reliable information.","db94c9c9":"1. There's more males than females in the dataset.\n2. Females survived more than males despite having a lower total count.\n3. Around 75% of females survived vs. only around 19% of males.","497e3dda":"# Preprocessing","8b301740":"Create RandomForestClassifier:","74b2779a":"Drop all NaN Embarked enteries:","a84cc5a7":"Prepare test set:","514a9ea4":"It seems that people younger than 10 years have higher chance of survival.","84e322bc":"Replace NaN values in Age and Fare with mean:","e2d95548":"1. Most passengers are 3rd class and most of them didn't survive.\n2. More then half of 1st class passengers survived. ","e3fe4d70":"# Importing libs","eaa335a7":"Split training data to test and validation sets:","fbc0c556":"# Loading train\/test sets","eef764ce":"# Model Testing","34824365":"# EDA","683e3201":"Drop all insignificant columns:","22ce1dce":"# Customizing vizualization","6a99d1a8":"Use grid_search_cv to find best parametrs:","553f0fcb":"Save submission df to csv:","13e17ae1":"Make predictions using best parametrs:","ddb31342":"Convert categorical variables into dummy\/indicator variables"}}