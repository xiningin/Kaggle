{"cell_type":{"2c084a42":"code","2e688164":"code","664c79e2":"code","a02449f4":"code","1a4d0790":"code","f2e221f6":"code","5d2a256f":"code","d26be938":"code","a6e8e197":"code","0aac6e72":"code","86651d03":"code","4cd69fb6":"code","3aa8102a":"code","0eed6aca":"code","742f567f":"code","f6edd8f9":"code","a75cd0eb":"code","ba47cb9c":"code","0c6e96fc":"markdown","53888a4a":"markdown","2c5a9f35":"markdown","e5cf82e5":"markdown","7fa80ec7":"markdown","2e85bf05":"markdown","489618c7":"markdown","2fb8e5e8":"markdown","b36614ee":"markdown","dc6e25f7":"markdown","39229f17":"markdown"},"source":{"2c084a42":"import numpy as np\nimport pandas as pd","2e688164":"df = pd.read_csv('..\/input\/used-car-dataset-ford-and-mercedes\/audi.csv')\ndf.head()","664c79e2":"df.info()","a02449f4":"df.isnull().sum()","1a4d0790":"X = df.loc[:, ('model', 'year', 'transmission', 'mileage', 'fuelType', 'tax', 'mpg', 'engineSize')].values\nX","f2e221f6":"y = df.loc[:, 'price'].values\ny","5d2a256f":"df.loc[:, ('model', 'transmission', 'fuelType')].head()","d26be938":"df['model'].unique()","a6e8e197":"df['transmission'].unique()","0aac6e72":"df['fuelType'].unique()","86651d03":"from sklearn.preprocessing import LabelEncoder\nle = LabelEncoder()\nX[:, 0] = le.fit_transform(X[:, 0])\nX","4cd69fb6":"le = LabelEncoder()\nX[:, 2] = le.fit_transform(X[:, 2])\nX","3aa8102a":"from sklearn.compose import ColumnTransformer\nfrom sklearn.preprocessing import OneHotEncoder\nct = ColumnTransformer(transformers=[('encoder', OneHotEncoder(), [4])], remainder='passthrough')\nX = np.array(ct.fit_transform(X))\nX","0eed6aca":"# df_X = pd.DataFrame(X)\n# df_X.head()","742f567f":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=1)","f6edd8f9":"from sklearn.ensemble import RandomForestRegressor\nregressor = RandomForestRegressor(n_estimators=11, random_state=0)\nregressor.fit(X_train, y_train)","a75cd0eb":"y_pred = regressor.predict(X_test)\nnp.set_printoptions(precision=2)\nprint(np.concatenate((y_pred.reshape(len(y_pred), 1), y_test.reshape(len(y_test), 1)), 1))","ba47cb9c":"from sklearn.metrics import r2_score, mean_squared_error\nprint(np.sqrt(mean_squared_error(y_test, y_pred)))\nprint(r2_score(y_test, y_pred))","0c6e96fc":"### Encode Column fuelType","53888a4a":"## Split into Training Set and Test Set","2c5a9f35":"## Encoding Categorical Data","e5cf82e5":"## Importing Library","7fa80ec7":"## Training Model","2e85bf05":"## Predict","489618c7":"## Split into Features and Target Variable","2fb8e5e8":"### Encode Column transmission","b36614ee":"### Encode Column model","dc6e25f7":"## Evaluate Model","39229f17":"## Importing Dataset"}}