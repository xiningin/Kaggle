{"cell_type":{"c3ba9f4c":"code","a1c32635":"code","12de50e5":"code","2b370d37":"code","88ab6efc":"code","562d180c":"code","bff1cadc":"code","7de58c41":"code","034eed35":"code","3ad951da":"code","46cdc74f":"code","ebc3a9f2":"code","5f7148d1":"code","a89f65c2":"code","59df7ff2":"code","c3bfdf6e":"code","842357a9":"code","fbfde9bc":"code","80e89f99":"code","1a125068":"code","62dfa7ba":"code","f4b13728":"code","1190bc52":"code","295d705f":"code","8372a894":"code","378f8941":"code","39b7f0f5":"code","869eb7a9":"code","10c0eff6":"code","26564887":"code","3b0a7bb0":"code","9184ad46":"code","d78a7952":"code","c730ad8f":"code","38cbd3dc":"code","d3c1e23c":"code","0eaccc61":"code","6a5e072e":"code","2a7e1487":"code","4ae6b435":"code","faf3d2e9":"markdown","77ea218a":"markdown","bf30040f":"markdown","a87d26b1":"markdown","a699a112":"markdown","d7033c88":"markdown","a983772b":"markdown","6d3db248":"markdown","c8366087":"markdown","fcc9bd33":"markdown","d598fd1c":"markdown","c22a6879":"markdown","39b5abd1":"markdown","758f60c3":"markdown","724f558f":"markdown","0c2d7262":"markdown","11a64bae":"markdown","4a605191":"markdown","bbd537c2":"markdown","8ab756d2":"markdown","481edf06":"markdown","b82926fc":"markdown","8f0b4118":"markdown","622ec001":"markdown","a0ce0daa":"markdown","17daf479":"markdown","2bee68e5":"markdown","6e61970f":"markdown"},"source":{"c3ba9f4c":"import pandas as pd\npd.plotting.register_matplotlib_converters()\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\nprint(\"Setup Complete\")","a1c32635":"df = pd.read_csv('..\/input\/tokyo-olympics-2020-tweets\/tokyo_2020_tweets.csv')\ndf","12de50e5":"df.info()","2b370d37":"df.describe()","88ab6efc":"df_hashtags = df[df['hashtags'].notnull()]\nprint(df.shape)\nprint(df_hashtags.shape)","562d180c":"hashtags = {}\ndef extract_hashtags(hashtags_arr):\n    for i in hashtags_arr:\n        cleaned = i.replace('[', '').replace(']', '').replace(\"'\", '').strip()\n        cleaned = cleaned.lower()\n        split_cleaned = cleaned.split(',')\n        for j in split_cleaned:\n            if j[0].isspace() == True:\n                j = j[1:]\n            if j not in hashtags.keys():\n                hashtags[j] = 1\n            else:\n                hashtags[j] += 1","bff1cadc":"extract_hashtags(df['hashtags'].astype(str))","7de58c41":"hashtags","034eed35":"hashtags.pop('nan')","3ad951da":"import numpy as np\n\nfinal_df_hashtags = pd.DataFrame({\n    'hashtags': hashtags.keys(),\n    'count': hashtags.values()\n})\nfinal_df_hashtags.head()","46cdc74f":"final_df_hashtags.nunique()","ebc3a9f2":"sorted_df_hashtags = final_df_hashtags.sort_values(by='count', ascending=False)\nsns.barplot(\n    x=sorted_df_hashtags['hashtags'].head(3),\n    y=sorted_df_hashtags['count'].head(3)\n)\nplt.title('3 Most Popular hashtags used')\nplt.ylabel('Number of times used')\nplt.xlabel('Hashtags')\nplt.show()","5f7148d1":"plt.figure(figsize=(25, 6))\nsns.barplot(\n    x=sorted_df_hashtags['hashtags'].iloc[3:20],\n    y=sorted_df_hashtags['count'].iloc[3:20]\n)\nplt.xticks(rotation=45)\nplt.show()","a89f65c2":"df.head()","59df7ff2":"sorted_df_hashtags.head(10)","c3bfdf6e":"hashtag_rank = [1, 2, 3, 4, 5]\n\ndef generate_rank(counts):\n    for c in counts:\n        if c >= 4000 and c < 5000:\n            hashtag_rank.append(5)\n        elif c >= 3000 and c < 4000:\n            hashtag_rank.append(6)\n        elif c >= 2000 and c < 3000:\n            hashtag_rank.append(7)\n        elif c >= 1000 and c < 2000:\n            hashtag_rank.append(8)\n        elif c > 1 and c < 1000:\n            hashtag_rank.append(9)\n        else:\n            hashtag_rank.append(10)","842357a9":"generate_rank(sorted_df_hashtags['count'][5:])\nhashtag_rank[:20]","fbfde9bc":"print(sorted_df_hashtags.shape[0])\nprint(len(hashtag_rank))","80e89f99":"sorted_df_hashtags['rank'] = hashtag_rank\nsorted_df_hashtags.head()","1a125068":"def assign_rank(hashtags):\n    ranks = []\n    for i in hashtags:\n        if i is None or i == 'nan':\n            ranks.append(11)\n        else:\n            cleaned = i.replace('[', '').replace(']', '').replace(\"'\", '').strip()\n            cleaned = cleaned.lower()\n            split_cleaned = cleaned.split(',')\n            temp_ranks = []\n            for j in split_cleaned:\n                if j[0].isspace() == True:\n                    j = j[1:]\n                temp_ranks.append(sorted_df_hashtags.loc[sorted_df_hashtags['hashtags'] == j, 'rank'].values[0])\n            ranks.append(min(temp_ranks))\n    return ranks","62dfa7ba":"ranked_df = df[['retweets', 'favorites']]\nranked_df = assign_rank(df['hashtags'].astype(str))","f4b13728":"retweet_favorites_with_rank = df[['retweets', 'favorites']]\nretweet_favorites_with_rank['rank'] = ranked_df\nretweet_favorites_with_rank.head()","1190bc52":"plt.figure(figsize=(15, 6))\nsns.scatterplot(\n    x=retweet_favorites_with_rank['rank'],\n    y=retweet_favorites_with_rank['retweets']\n)\nplt.title('Rank of Hashtag Popularity vs Number of Retweets')\nplt.xlabel('Rank of Hashtag Popularity')\nplt.ylabel('Number of Retweets')\nplt.xticks(np.arange(1, 12))\nplt.show()","295d705f":"avg_retweets = []\ndef get_avg_retweets(rank):\n    for i in range(1, rank + 1):\n        avg_retweets.append(retweet_favorites_with_rank[retweet_favorites_with_rank['rank'] == i].retweets.mean())\n\nget_avg_retweets(11)\n\nplt.figure(figsize=(15, 6))\nplt.plot(np.arange(1, 12), avg_retweets, marker='o')\nplt.xticks(np.arange(1, 12))\nplt.title('Average Retweets Achieved per Rank')\nplt.xlabel('Rank')\nplt.ylabel('Average number of retweets')\nplt.show()","8372a894":"def get_sum_retweets(rank):\n    for i in range(1, rank + 1):\n        sum_retweets = retweet_favorites_with_rank[retweet_favorites_with_rank['rank'] == i].retweets.sum()\n        total_posts = len(retweet_favorites_with_rank[retweet_favorites_with_rank['rank'] == i])\n        print(f\"Rank {i}: {sum_retweets} retweets \/ {total_posts} posts\")\nget_sum_retweets(11)","378f8941":"condition = (retweet_favorites_with_rank['rank'] == 9) & (df['retweets'] >= 2000)\ndf[condition]","39b7f0f5":"plt.figure(figsize=(15, 6))\nsns.scatterplot(\n    x=retweet_favorites_with_rank['rank'],\n    y=retweet_favorites_with_rank['favorites']\n)\nplt.title('Rank of Hashtag Popularity vs Number of Favourites')\nplt.xlabel('Rank of Hashtag Popularity')\nplt.ylabel('Number of Favourites')\nplt.xticks(np.arange(1, 12))\nplt.show()","869eb7a9":"avg_faves = []\ndef get_avg_faves(rank):\n    for i in range(1, rank + 1):\n        avg_faves.append(retweet_favorites_with_rank[retweet_favorites_with_rank['rank'] == i].favorites.mean())\n\nget_avg_faves(11)\n\nplt.figure(figsize=(15, 6))\nplt.plot(np.arange(1, 12), avg_faves, marker='o')\nplt.xticks(np.arange(1, 12))\nplt.title('Average Favorites Achieved per Rank')\nplt.xlabel('Rank')\nplt.ylabel('Average number of Favorites')\nplt.show()","10c0eff6":"def get_sum_faves(rank):\n    for i in range(1, rank + 1):\n        sum_faves = retweet_favorites_with_rank[retweet_favorites_with_rank['rank'] == i].favorites.sum()\n        total_posts = len(retweet_favorites_with_rank[retweet_favorites_with_rank['rank'] == i])\n        print(f\"Rank {i}: {sum_faves} favorites \/ {total_posts} posts\")\nget_sum_faves(11)","26564887":"condition = (retweet_favorites_with_rank['rank'] == 1) & (df['favorites'] >= 10000)\ndf[condition]","3b0a7bb0":"df['user_location'].value_counts()[:20]","9184ad46":"df[df['user_location'] == 'Red And White Kauntri..']","d78a7952":"locations = df['user_location'].value_counts()[1:21]\nlocations = locations.index.tolist()\nlocations","c730ad8f":"df_locations = df[df['user_location'].isin(locations)]\ndf_locations.head()","38cbd3dc":"def change_loc(original, new_loc):\n    df_locations.loc[df_locations['user_location'] == original, 'user_location'] = new_loc","d3c1e23c":"change_loc('New Delhi, India', 'India')\nchange_loc('London, England', 'England')\nchange_loc('Mumbai, India', 'India')\nchange_loc('Melbourne, Australia', 'Australia')\nchange_loc('Melbourne, Victoria', 'Australia')\nchange_loc('Bengaluru, India', 'India')\nchange_loc('Sydney, New South Wales', 'Australia')\nchange_loc('Toronto', 'USA')\nchange_loc('Lausanne', 'Switzerland')\nchange_loc('Toronto, Ontario', 'USA')\nchange_loc('New Delhi', 'India')\nchange_loc('Sydney, Australia', 'Australia')\ndf_locations['user_location'].value_counts()","0eaccc61":"df_locations['source'].value_counts().head(50)","6a5e072e":"sources = ['Twitter Web App', 'Twitter for Android', 'Twitter for iPhone']\ndf_locations_source = df_locations[df_locations['source'].isin(sources)]\ndf_locations_source.head()","2a7e1487":"twitter_web = {}\ntwitter_android = {}\ntwitter_iphone = {}\n\ndef translate_groupby(df):\n    i = 0\n    while i < len(df):\n        if df.index[i][0] == 'Switzerland':\n            twitter_web[df.index[i][0]] = df.values[i + 0]\n            twitter_android[df.index[i][0]] = df.values[i + 1]\n            twitter_iphone[df.index[i][0]] = 0\n            i += 2\n        else:\n            twitter_web[df.index[i][0]] = df.values[i + 0]\n            twitter_android[df.index[i][0]] = df.values[i + 1]\n            twitter_iphone[df.index[i][0]] = df.values[i + 2]\n            i += 3","4ae6b435":"import plotly.graph_objects as px\nimport numpy as np\nimport plotly.express as px\n\ntemp = df_locations_source.groupby(['user_location', 'source']).source.count()\ntranslate_groupby(temp)\n\ntemp_df = pd.DataFrame()\ntemp_df['user_location'] = twitter_web.keys()\ntemp_df['twitter_web'] = twitter_web.values()\ntemp_df['twitter_android'] = twitter_android.values()\ntemp_df['twitter_iphone'] = twitter_iphone.values()\n\nfig = px.bar(temp_df, x='user_location', \n             y=['twitter_web', 'twitter_android', 'twitter_iphone'], \n             title='Access Twitter Platforms per Country',\n             height=600)\nfig.show()","faf3d2e9":"These are the top 20 hashtags used in the tweets about Tokyo Olympics 2020.\n\nWe can see the \"general\" hashtags like **\"tokyo2020\", \"olympics\", \"tokyoolympics\", and \"olympicgames\"** used the most, and then there are hashtags used for cheering certain countries, like **India** and **USA**. There are also hashtags mentioning certain sports like **swimming, tabletennis, hockey, badminton, basketball, weightlifting, and boxing**.\n\nJudging from the hashtags alone we can say that most people made tweets about the swimming olympics. We also can say that a lot more people from India are tweeting about their country's teams than any other country's citizens. But since we haven't analysed the tweets themselves, we can't make any firm conclusions now.","77ea218a":"It looks like that **using the most popular hashtags doesn't guarantee more retweets on average**. Instead, using the **7th most popular hashtags** will get you **much more retweets on average**. But looking at the scatter plot above, there are 3 tweets that used rank-9 hashtags but earned much more retweets than other hashtags.\n\nHere are 3 tweets that used rank-9 hashtags but earned a lot of retweets:","bf30040f":"**So in conclusion:** using more popular hashtags doesn't necessarily guarantee more retweets\/favorites. Posts which got the most retweets\/favorites were posted by accounts which have a lot of followers and were user-verified accounts.","a87d26b1":"From this dataset, I wanted to find out a few things:\n1. What are the most popular hashtags about the olympics?\n2. Does using the popular hashtags get you more likes or retweets?\n3. What kind of platform does each country use the most to access twitter?","a699a112":"From this chart, we can see that people in **western countries** mostly use **Iphone** to access Twitter, compared to second-world countries or asian countries. For example, people in **India, South Africa** and the **Philippines** mostly use **Android** to access Twitter. Of course, we cannot make a firm conclusion as the data I used to show you is composed of only **9%** of the real data.","d7033c88":"It looks like that **using the most popular hashtags doesn't guarantee more favorites on average**. Instead, using the **6th most popular hashtags** will get you **much more favorites on average**.\n\nBut by looking at the scatter plot above, some posts with rank-1 hashtags actually topped the chart. So let's see what those posts look like, who posted them, and what they're about.","a983772b":"In this section, I explored whether or not using the more popular hashtags got you more likes and\/or retweets.","6d3db248":"Now, I'll change the user_location in the dataframe **df_locations** to a country which they belong to.\n\nLet's make a function to make the process easier.","c8366087":"In order to judge whether each hashtag was popular or not, I assigned values to them to rank them from the most popular hashtag to the least popular hashtag. I used the numbers 1 to 10. I assigned each post the rank of the most popular hashtag they used.\n\nFor posts which did not use hashtags, I assigned the value 11.","fcc9bd33":"We can see these tweets were made by the same account, an official account called **Badminton Talk**.","d598fd1c":"Here is our subset of the original dataframe for all the unique hashtags available in the 'hashtags' column.","c22a6879":"After that was done, I made a function that would do the job of extracting a one or more hashtags from each entry of the 'hashtags' column.","39b5abd1":"As seen from above, the column 'hashtags' has an 'O' datatype, which means it's a string, so I had to find away to extract each individual hashtag. After looking at the data a little bit closer, I could see that its format is basically a list of strings, with single quotes around each hashtag, and they are enclosed within brackets for each post.\n\nBefore I start extracting the strings, I had to remove all the null values in that column. I only took the hashtags that were available and not null.","758f60c3":"Now that I've assigned rankings to each of these hashtags, it's time to join them together with the master dataframe.","724f558f":"First, I looked at the dataframe's info and description.","0c2d7262":"I then extracted the hashtags.","11a64bae":"Let's look at the sorted version in a bar plot.\n\nHere are the **top 3** most popular hashtags used by tweets about the olympics.","4a605191":"First, get the subset of data that has a user_location of one of the above.","bbd537c2":"I'm going to take a subset of these 20 \"user_location\"s to represent the others.","8ab756d2":"## Most popular hashtags","481edf06":"# Platform Most used per Country","b82926fc":"# Processing","8f0b4118":"There is hashtag 'nan' which maybe shouldn't be there, so I erased it.","622ec001":"# Load Dataset","a0ce0daa":"Here are the top 4 - 20 most popular hashtags.","17daf479":"# Questions to ask","2bee68e5":"It looks like the first user_location is not an authentic location, let's not include it in our analysis.","6e61970f":"## Use Popular Hashtags = More Likes and Retweets?"}}