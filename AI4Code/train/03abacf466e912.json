{"cell_type":{"9a387d38":"code","385d7ee1":"code","83078b3c":"code","4dfb6a46":"code","7e3fa18d":"code","de537663":"markdown","952bd87b":"markdown","92c4014f":"markdown","3256116c":"markdown","95dcf3dd":"markdown","983560da":"markdown"},"source":{"9a387d38":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n%matplotlib inline","385d7ee1":"df_train = pd.read_csv('..\/input\/X_train.csv', encoding='cp949')\ndf_test = pd.read_csv('..\/input\/X_test.csv', encoding='cp949')\ny_train = pd.read_csv('..\/input\/y_train.csv').gender\nIDtest = df_test.custid.unique()\n\ndf_train.head()","83078b3c":"level = 'brd_nm'\n\ndf_all = pd.concat([df_train, df_test])\nX_train = pd.pivot_table(df_all, index='custid', columns=level, values='tot_amt',\n                         aggfunc=lambda x: np.where(len(x) >=1, 1, 0), fill_value=0). \\\n                         reset_index(). \\\n                         query('custid not in @IDtest'). \\\n                         drop(columns=['custid']).values\nX_test = pd.pivot_table(df_all, index='custid', columns=level, values='tot_amt',\n                         aggfunc=lambda x: np.where(len(x) >=1, 1, 0), fill_value=0). \\\n                         reset_index(). \\\n                         query('custid in @IDtest'). \\\n                         drop(columns=['custid']).values\n\nmax_features = X_train.shape[1]","4dfb6a46":"from sklearn.linear_model import LogisticRegression\n\nmodel = LogisticRegression(penalty='l2', C=0.01)\nmodel.fit(X_train, y_train)","7e3fa18d":"pred = model.predict_proba(X_test)[:,1]\nfname = 'submissions.csv'\nsubmissions = pd.concat([pd.Series(IDtest, name=\"custid\"), pd.Series(pred, name=\"gender\")] ,axis=1)\nsubmissions.to_csv(fname, index=False)\nprint(\"'{}' is ready to submit.\" .format(fname))","de537663":"### Build Models","952bd87b":"## This model has the following characteristics:\n* No feature engineering\n* Applying One-hot-Encoding to raw transactions","92c4014f":"### Transform Data with One-hot Encoding","3256116c":"### Read Data","95dcf3dd":"### Make Submissions","983560da":"## End"}}