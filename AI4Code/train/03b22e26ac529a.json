{"cell_type":{"2a6a497a":"code","b812bf20":"code","8568e494":"code","66e669d0":"code","da75e649":"code","5fd02121":"code","5afced8d":"code","9d52b131":"code","e5343ee1":"code","a7c199eb":"code","403dc845":"code","cfb94d8a":"code","30dc109a":"code","d7e57212":"code","51e3a8b5":"code","8daeacba":"code","fa35d2c1":"code","1864c668":"code","21072adb":"code","233a1602":"markdown","05e84560":"markdown"},"source":{"2a6a497a":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport tensorflow as tf\n%matplotlib inline","b812bf20":"X_train=pd.read_csv('..\/input\/airline-passenger-satisfaction\/train.csv')","8568e494":"X_train.head()","66e669d0":"X_test=pd.read_csv('..\/input\/airline-passenger-satisfaction\/test.csv')","da75e649":"X_test.head(10)","5fd02121":"X_train.columns","5afced8d":"corr=X_train.corr()\ncorr_d=corr['Departure Delay in Minutes'].sort_values(ascending=False)","9d52b131":"plt.figure(figsize=(11,10))\nsns.heatmap(corr,linewidths=0.6,annot=True,fmt='.1f',cmap='coolwarm',square=True,robust=True)","e5343ee1":"#checking relation between departure and arrival delay.\nplt.figure(figsize=(9,7))\nsns.scatterplot('Departure Delay in Minutes','Arrival Delay in Minutes',data=X_train,color='g',edgecolor='none')","a7c199eb":"X_train.dropna(axis=0,subset=['satisfaction'],inplace=True)\nX_test.dropna(axis=0,subset=['satisfaction'],inplace=True)","403dc845":"plt.figure(figsize=(11,7))\nplt.subplot(1,2,1)\nsns.countplot('Inflight service',data=X_train,hue='Customer Type')\nplt.legend(loc='upper left')\nplt.subplot(1,2,2)\nsns.countplot('Cleanliness',data=X_train,hue='Customer Type')\nplt.legend(loc='upper left')\nplt.tight_layout()","cfb94d8a":"#here we check variation in ratings,prominently people of Business class have given good \n#feedback compared to eco and Eco plus classes.\n\nplt.figure(figsize=(11,7))\nplt.subplot(1,2,1)\nsns.countplot('On-board service',data=X_train,hue='Class')\nplt.legend(loc='upper left')\nplt.ylabel('Count',fontsize=12)\nplt.subplot(1,2,2)\nsns.countplot('Leg room service',data=X_train,hue='Class')\nplt.legend(loc='upper left')\nplt.ylabel('Count',fontsize=12)\nplt.tight_layout()","30dc109a":"#from here we can infer that mostly Business class people have been priortized followed by Eco class with\n#almost same importance.\n\nplt.figure(figsize=(11,7))\nplt.subplot(1,2,1)\nsns.countplot('Inflight entertainment',data=X_train,hue='Class')\nplt.subplot(1,2,2)\nsns.countplot('Checkin service',data=X_train,hue='Class')\nplt.legend(loc='upper left')\nplt.tight_layout()","d7e57212":"y_train=X_train.satisfaction\nX_train=X_train.drop('satisfaction',axis=1)\ny_test=X_test.satisfaction\nX_test=X_test.drop('satisfaction',axis=1)","51e3a8b5":"#preprocess the data \nfrom category_encoders import CountEncoder\nce=CountEncoder()\nce_train=pd.DataFrame(ce.fit_transform(X_train,y_train))\nce_test=pd.DataFrame(ce.transform(X_test,y_test))","8daeacba":"ce_train=ce_train.fillna(0)\nce_test=ce_test.fillna(0)","fa35d2c1":"from catboost import CatBoostClassifier\ncat=CatBoostClassifier(learning_rate=0.09)\ncat.fit(ce_train,y_train)\npreds=cat.predict(ce_test)","1864c668":"from sklearn.metrics import classification_report,confusion_matrix\nprint(classification_report(y_test,preds))","21072adb":"matrix=confusion_matrix(y_test,preds)\nplt.figure(figsize=(8,6))\nsns.heatmap(matrix,annot=True,fmt='0.2f')","233a1602":"### Confusion Matrix ","05e84560":"### Train the model"}}