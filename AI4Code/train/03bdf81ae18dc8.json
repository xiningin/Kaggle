{"cell_type":{"315166e1":"code","b2975690":"code","2806fe3b":"code","796c4ff0":"code","b977c00a":"code","da824032":"code","73724e04":"code","7ce00d9e":"code","38f325c5":"markdown","e6ff6e89":"markdown","29a86960":"markdown","fe1e45e7":"markdown"},"source":{"315166e1":"pip install openpyxl","b2975690":"# Data Analysis\nimport numpy as np\nimport pandas as pd\n\n# Data Visualization\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport plotly.express as px\nimport plotly.graph_objects as go\n\n# Setting up\nimport warnings\nwarnings.filterwarnings('ignore')\n%matplotlib inline","2806fe3b":"# HERE FOR YOU\npath = '..\/input\/manga-comparison\/MANGA.xlsx'\n\n\n# Data\ndata = pd.read_excel(path, header=1, nrows=10)","796c4ff0":"# Updating the data\ndata['Category'] = data['Unnamed: 0']\ndata.drop('Unnamed: 0', axis=1, inplace=True)\nfor idx in range(1, 10, 2):\n    data.loc[idx, 'Companies'] = data.loc[idx-1, 'Companies']\n    data.loc[idx, 'Category'] = data.loc[idx-1, 'Category']","b977c00a":"def compare_ratio(data, ratio, bg_color, colors=['#1B4157', '#71A6C1']):\n    \n    fig = go.Figure()\n    yaxis = \"Ratio\"\n    if ratio[-1] == \"%\":\n        yaxis = \"Percentage\"\n        data[ratio] = data[ratio]*100\n    # Plotting for each year\n    for year, color in zip([2019, 2020], colors):\n        \n        data_per_year = data.query(f'Year == {year}')\n        # Plot it\n        fig.add_trace(go.Bar(\n            x=data_per_year['Companies'],\n            y=data_per_year[ratio],\n            orientation='v',\n            name=year,\n            marker_color=color\n        ))\n    \n    fig.update_layout(barmode='group')\n    fig.update_layout(title=f'<b>FAANG Comparison on {ratio}<b>',\n                  xaxis_title=f'<b>Company<b>',\n                  yaxis_title=f'<b>{yaxis}<b>',\n                  titlefont={'size': 28, 'family':'Serif'},\n                  template='simple_white',\n                  showlegend=True,\n                  paper_bgcolor=bg_color,\n                  plot_bgcolor=bg_color,\n                  width=950, height=500,\n                 )\n    \n    fig.show()\n    \n    \ndef distribution_per_ratio(Ratio, color):\n    fig = go.Figure()\n    fig.add_trace(go.Violin(x=data[Ratio], line_color=color, y0=0))\n\n    fig.update_traces(orientation='h', side='positive', meanline_visible=False)\n    fig.update_traces(showlegend=False, selector=dict(type='violin'))\n    fig.update_layout(xaxis_showgrid=False, xaxis_zeroline=False)\n\n    fig.update_layout(title=f'<b>{Ratio} Distribution<b>',\n                      xaxis_title=Ratio,\n                      titlefont={'size': 24},\n                      width=800,\n                      height=400,\n                      template=\"plotly_dark\",\n                      showlegend=True,\n                      paper_bgcolor=\"lightgray\",\n                      plot_bgcolor='lightgray', \n                      font=dict(\n                          color ='black',\n                          )\n                      )\n    fig.show()","da824032":"data.columns","73724e04":"# Plot your figure with your specifications\n\n######## Your Specification #########\n# Choose Color from -->    red, brown, blue, or purple \ncolor_group = 'blue' # Default (You could change this, but don't remove the quotation marks)\n\n\n# Choose the ratio of interest by copying its name from the excel sheet you have\nratio = 'Return on equity %' # Default (You could change this, but don't remove the quotation marks)\n\n# Choose the background style --> 1 or 2\nbg_style = 2 # Default (You could change this)\n######## Your Specification #########\n\n\n\n\n\n\n# Let them as they are\ncolor_dict = {'blue': ['#1B4157', '#71A6C1'],\n              'red': ['#C55564', '#F5CCB8'],\n              'brown': ['#482414', '#8E7158'],\n              'purple': ['#594A72', '#F994C1']}\n\nbg_dict = {1:'#edeeee', 2:'lightgray'}\n\ncompare_ratio(data, ratio, bg_dict[bg_style], color_dict[color_group])","7ce00d9e":"############## Your Place ##################\nRatio = 'Return on equity %' \ncolor = 'red'\n\n############## Your Place ##################\n    \ndistribution_per_ratio(Ratio, color)","38f325c5":"> # Distribution Function","e6ff6e89":"> # Start here","29a86960":"#### When you have your image put the mouse on it and click on the camera item to download it","fe1e45e7":"Copy and paste your ratio name"}}