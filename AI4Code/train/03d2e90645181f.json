{"cell_type":{"e7daf02b":"code","6a7a6555":"code","f4e0aa11":"code","25c83985":"code","02ca3255":"code","366e5e4a":"code","c6f666a3":"code","93f78874":"code","82d4223f":"code","718ee8fe":"code","0d0e3e9e":"code","aa6efcd9":"code","56993129":"code","4fa26eab":"code","999cb3b1":"code","01e534ae":"code","237ec694":"code","d3646b7e":"code","de5ebf11":"code","b8bdaed6":"code","25758476":"code","8f608901":"code","57b002e3":"code","ac399db2":"code","13fcbb5f":"code","c2770a75":"code","3cfb95b8":"code","f5bd6a43":"code","57940834":"code","1fb89fee":"code","a79d6545":"code","cb44e3f9":"code","a5be67a9":"code","d675d7f8":"code","e296312a":"markdown","8b85659e":"markdown","4480027c":"markdown","1b559624":"markdown","53c6aeb3":"markdown","c2386c7e":"markdown","78fbaf25":"markdown","c4e6fa73":"markdown","83c82d74":"markdown"},"source":{"e7daf02b":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sb\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import SGDRegressor\nfrom sklearn.metrics import mean_squared_error\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.neighbors import KNeighborsRegressor\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","6a7a6555":"laptops = pd.read_csv('\/kaggle\/input\/laptop-price\/laptop_price.csv',encoding='latin-1')\nlaptops = laptops.set_index('laptop_ID')\nlaptops.head()","f4e0aa11":"laptops.info()","25c83985":"laptops.describe()","02ca3255":"laptops['Company'].value_counts()\nfig_dims = (20, 6)\nfig, ax = plt.subplots(figsize=fig_dims)\nsb.countplot(x=\"Company\", data=laptops, ax=ax)","366e5e4a":"import seaborn as sns","c6f666a3":"p = laptops.groupby('Company')['Price_euros'].mean().sort_values(ascending=False)\nsns.barplot(p, p.index)","93f78874":"laptops[\"Ram\"] = laptops[\"Ram\"].str.replace('GB', '')\nlaptops[\"Weight\"] = laptops[\"Weight\"].str.replace('kg', '')\n# Memory -- HDD SDD Hybrid Flash\nlaptops['Memory'] = laptops['Memory'].astype(str).replace('\\.0', '', regex=True)\nlaptops[\"Memory\"] = laptops[\"Memory\"].str.replace('GB', '')\nlaptops[\"Memory\"] = laptops[\"Memory\"].str.replace('TB', '000')\nnew2 = laptops[\"Memory\"].str.split(\"+\", n = 1, expand = True)\nlaptops[\"first\"]= new2[0]\nlaptops[\"first\"]=laptops[\"first\"].str.strip()\nlaptops[\"second\"]= new2[1]\nlaptops[\"Layer1HDD\"] = laptops[\"first\"].apply(lambda x: 1 if \"HDD\" in x else 0)\nlaptops[\"Layer1SSD\"] = laptops[\"first\"].apply(lambda x: 1 if \"SSD\" in x else 0)\nlaptops[\"Layer1Hybrid\"] = laptops[\"first\"].apply(lambda x: 1 if \"Hybrid\" in x else 0)\nlaptops[\"Layer1Flash_Storage\"] = laptops[\"first\"].apply(lambda x: 1 if \"Flash Storage\" in x else 0)\nlaptops['first'] = laptops['first'].str.replace(r'\\D', '')\nlaptops[\"second\"].fillna(\"0\", inplace = True)\nlaptops[\"Layer2HDD\"] = laptops[\"second\"].apply(lambda x: 1 if \"HDD\" in x else 0)\nlaptops[\"Layer2SSD\"] = laptops[\"second\"].apply(lambda x: 1 if \"SSD\" in x else 0)\nlaptops[\"Layer2Hybrid\"] = laptops[\"second\"].apply(lambda x: 1 if \"Hybrid\" in x else 0)\nlaptops[\"Layer2Flash_Storage\"] = laptops[\"second\"].apply(lambda x: 1 if \"Flash Storage\" in x else 0)\nlaptops['second'] = laptops['second'].str.replace(r'\\D', '')\nlaptops[\"first\"] = laptops[\"first\"].astype(int)\nlaptops[\"second\"] = laptops[\"second\"].astype(int)\nlaptops[\"Total_Memory\"]=(laptops[\"first\"]*(laptops[\"Layer1HDD\"]+laptops[\"Layer1SSD\"]+laptops[\"Layer1Hybrid\"]+laptops[\"Layer1Flash_Storage\"])+laptops[\"second\"]*(laptops[\"Layer2HDD\"]+laptops[\"Layer2SSD\"]+laptops[\"Layer2Hybrid\"]+laptops[\"Layer2Flash_Storage\"]))\nlaptops[\"Memory\"]=laptops[\"Total_Memory\"]\nlaptops[\"HDD\"]=(laptops[\"first\"]*laptops[\"Layer1HDD\"]+laptops[\"second\"]*laptops[\"Layer2HDD\"])\nlaptops[\"SSD\"]=(laptops[\"first\"]*laptops[\"Layer1SSD\"]+laptops[\"second\"]*laptops[\"Layer2SSD\"])\nlaptops[\"Hybrid\"]=(laptops[\"first\"]*laptops[\"Layer1Hybrid\"]+laptops[\"second\"]*laptops[\"Layer2Hybrid\"])\nlaptops[\"Flash_Storage\"]=(laptops[\"first\"]*laptops[\"Layer1Flash_Storage\"]+laptops[\"second\"]*laptops[\"Layer2Flash_Storage\"])\n\n# Screen Resolution\nnew = laptops[\"ScreenResolution\"].str.split(\"x\", n = 1, expand = True) \nlaptops[\"X_res\"]= new[0]\nlaptops[\"Y_res\"]= new[1]\nlaptops[\"Y_res\"]= pd.to_numeric(laptops[\"Y_res\"])\nlaptops[\"Y_res\"]= laptops[\"Y_res\"].astype(float)\nlaptops[\"X_res\"]=(laptops['X_res'].str.replace(',','').str.findall(r'(\\d+\\.?\\d+)').apply(lambda x: pd.Series(x).astype(int)).mean(1))\nlaptops[\"X_res\"]=pd.to_numeric(laptops[\"X_res\"])\nlaptops[\"PPI\"]=(((laptops[\"X_res\"]**2+laptops[\"Y_res\"]**2)**(1\/2))\/laptops[\"Inches\"]).astype(float)\nlaptops[\"ScreenResolution\"]=(laptops[\"X_res\"]*laptops[\"Y_res\"]).astype(float)\nlaptops[\"Ram\"] = laptops[\"Ram\"].astype(int)\nlaptops[\"Weight\"] = laptops[\"Weight\"].astype(float)\nlaptops=laptops.drop(['first','second','Layer1HDD','Layer1SSD','Layer1Hybrid','Layer1Flash_Storage','Layer2HDD','Layer2SSD','Layer2Hybrid','Layer2Flash_Storage','Total_Memory'],axis=1)","82d4223f":"laptops.shape","718ee8fe":"laptops['Gpu_company'] = laptops.Gpu.apply(lambda x: x.split(' ')[0])","0d0e3e9e":"laptops.groupby('Gpu_company').Price_euros.max().sort_values(ascending=False)","aa6efcd9":"laptops.groupby('Gpu_company').Price_euros.count().sort_values(ascending=False)","56993129":"laptops['Gpu_company'] = laptops.Gpu.apply(lambda x: x.split(' ')[0])","4fa26eab":"laptops['Cpu'].value_counts()","999cb3b1":"laptops['core_i'] = laptops.Cpu.apply(lambda x: x.split(' ')[2][-1] if 'Core i' in x else 0).astype('int')","01e534ae":"laptops['core_generation'] = laptops.Cpu.apply(lambda x: x.split(' ')[3][0] if 'Core i' in x else 0).astype('int')","237ec694":"laptops['core_generation'].value_counts()","d3646b7e":"laptops.groupby('Gpu_company').Price_euros.mean()","de5ebf11":"laptops['clock_speed'] = laptops.Cpu.apply(lambda x: x.split(' ')[-1]).str.replace('GHz','').astype('float')\n","b8bdaed6":"def correlation_heatmap(train):\n    correlations = train.corr()\n    \n    fig, ax = plt.subplots(figsize=(16,16))\n    sb.heatmap(correlations, vmax=1.0, center=0, fmt='.2f', square=True, linewidths=.5, annot=True, cbar_kws={\"shrink\":.70})\n    plt.show()\ncorrelation_heatmap(laptops)","25758476":"fig_dims = (20, 10)\nfig, ax = plt.subplots(figsize=fig_dims)\nsb.scatterplot(data=laptops, x=\"Price_euros\", y=\"Ram\", ax=ax, s=75)","8f608901":"fig_dims = (20, 10)\nfig, ax = plt.subplots(figsize=fig_dims)\nsb.scatterplot(data=laptops, x=\"Price_euros\", y=\"SSD\", ax=ax, s=75)","57b002e3":"X = laptops.drop(['Price_euros'],axis=1)\nY = laptops['Price_euros'].values\nX = X.select_dtypes(exclude=['object'])","ac399db2":"X","13fcbb5f":"X_train, X_test, y_train, y_test = train_test_split(X, Y, test_size=0.1, random_state=42)","c2770a75":"SGDreg = SGDRegressor()\nSGDreg.fit(X_train, y_train)","3cfb95b8":"pred = SGDreg.predict(X_train)\nsgd_mse = mean_squared_error(y_train, pred)\nsgd_rmse = np.sqrt(sgd_mse)\nsgd_rmse","f5bd6a43":"pred = SGDreg.predict(X_train)\nsgd_mse = mean_squared_error(y_train, pred)\nsgd_rmse = np.sqrt(sgd_mse)\nsgd_rmse","57940834":"param_grid = {\n    'alpha': 10.0 ** -np.arange(1, 7),\n    'loss': ['squared_loss', 'huber', 'epsilon_insensitive'],\n    'penalty': ['l2', 'l1', 'elasticnet'],\n    'learning_rate': ['constant', 'optimal', 'invscaling'],\n    'max_iter': [1000, 5000, 10000]\n}\n\ngrid_search = GridSearchCV(SGDreg, param_grid)\ngrid_search.fit(X_train, y_train)\nprint(\"Best score: \" + str(grid_search.best_score_))","1fb89fee":"Kreg = KNeighborsRegressor()\nKreg.fit(X_train, y_train)","a79d6545":"pred = Kreg.predict(X_train)\nk_mse = mean_squared_error(y_train, pred)\nk_rmse = np.sqrt(k_mse)\nk_rmse","cb44e3f9":"param_grid = {'n_neighbors': np.arange(1, 12, 2),\n              'weights': ['uniform', 'distance']}\ngrid_search = GridSearchCV(Kreg, param_grid)\ngrid_search.fit(X_train, y_train)\nprint(\"Best score: \" + str(grid_search.best_score_))","a5be67a9":"final_model = grid_search.best_estimator_\nfinal_pred = final_model.predict(X_test)\nfinal_pred = final_pred.tolist()\nfor pred in range(0, len(final_pred)):\n    print(\"Predicition: \" + str(round(final_pred[pred], 2)) + \" Actual: \" + str(y_test[pred]))","d675d7f8":"fig_dims = (20, 10)\nfig, ax = plt.subplots(figsize=fig_dims)\nax.scatter(y_test, final_pred)\nax.plot([y_test.min(), y_test.max()], [y_test.min(), y_test.max()], 'k--', lw=4)\nax.set_xlabel('Measured')\nax.set_ylabel('Predicted')\nplt.show()","e296312a":"## Variable Identification\nFirst I will explore each variable first, I want to find out the data type of each and how many null entries I have in the dataset.","8b85659e":"# Laptop Prices Prediction\nThis analysis and model will be used to find correlation between specs and laptop price aswell as being used to predict laptop prices in the future.","4480027c":"## Train Models\nNow I will train a few models and compare them","1b559624":"Wow! Not one missing entry! Don't you love it when this happens.","53c6aeb3":"## Univariate Analysis\nNow I will visualize some features to try and find some outliers and see if we can find some interesting stats.","c2386c7e":"## Split Current Data\nNow I will split the target feature and from the dataset and sort out the current object features.","78fbaf25":"## Data Cleaning & Prep\nNext, I will clean up all of the confusing categorical data","c4e6fa73":"Now let's plot our predicted prices compared to the actual prices.","83c82d74":"## Bi-variate Analysis\nNow I will compare features against each other to try and find some correlation between them."}}