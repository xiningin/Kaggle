{"cell_type":{"b5784bdf":"code","a5c32473":"code","30930463":"code","dbde1a0f":"code","f28e929f":"code","d0360ecb":"code","2ece1d73":"code","f7528fd4":"code","9fb64828":"code","47868d62":"code","a46e3f5a":"code","dde2765f":"markdown","02c00434":"markdown","2c98b5b5":"markdown","1c6ae678":"markdown","c0d622f7":"markdown","b3b990fc":"markdown","cbb96bcc":"markdown"},"source":{"b5784bdf":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport folium\nfrom folium.plugins import HeatMap, HeatMapWithTime\nfrom netCDF4 import Dataset\nimport cartopy.crs as ccrs","a5c32473":"data = Dataset(\"\/kaggle\/input\/earthdata-merra2-co\/MERRA2_400.tavgM_2d_chm_Nx.202004.nc4\", more=\"r\")","30930463":"print(data)","dbde1a0f":"lons = data.variables['lon'][:]\nlats = data.variables['lat'][:]\ntime = data.variables['time'][:]\nCOCL = data.variables['COCL'][:,:,:]; COCL = COCL[0,:,:]\nCOEM = data.variables['COEM'][:,:,:]; COEM = COEM[0,:,:]\nCOLS = data.variables['COLS'][:,:,:]; COLS = COLS[0,:,:]\nTO3 =  data.variables['TO3'][:,:,:];  TO3 =  TO3[0,:,:]","f28e929f":"print(f\"longitudes: {len(lons)}\")\nprint(f\"latitudes: {len(lats)}\")\nprint(f\"time: {len(time)}\")\nprint(f\"COCL: {len(COCL)}\")\nprint(f\"COEM: {len(COEM)}\")\nprint(f\"COLS: {len(COLS)}\")\nprint(f\"TO3:  {len(TO3)}\")","d0360ecb":"print(f\"Latitudes: {len(lats)}, vals[:]: {len(COCL[0])}, Longitudes: {len(lons)}, vals[:,:]: {len(COCL[0])}\")","2ece1d73":"def plot_merra_data(data, title='', date='April 2020'):\n    fig = plt.figure(figsize=(16,8))\n    ax = plt.axes(projection=ccrs.Robinson())\n    ax.set_global()\n    ax.coastlines(resolution=\"110m\",linewidth=1)\n    ax.gridlines(linestyle='--',color='black')\n    plt.contourf(lons, lats, data, transform=ccrs.PlateCarree(),cmap=plt.cm.jet)\n    plt.title(f'MERRA-2 {title} levels, {date}', size=14)\n    cb = plt.colorbar(ax=ax, orientation=\"vertical\", pad=0.02, aspect=16, shrink=0.8)\n    cb.set_label('K',size=12,rotation=0,labelpad=15)\n    cb.ax.tick_params(labelsize=10)","f7528fd4":"plot_merra_data(COCL, 'COCL')","9fb64828":"plot_merra_data(COEM, 'COEM')","47868d62":"plot_merra_data(COLS, 'COLS')","a46e3f5a":"plot_merra_data(TO3, 'TO3')","dde2765f":"### Data Extraction\n\nLet's inspect the dataset.","02c00434":"We then filter atmospheric latitude\/longitude\/time\/ and variables and load them as numpy arrays.","2c98b5b5":"We then apply the function for few of the data features.","1c6ae678":"## Introduction\n\nWe explain here how to read and plot EARTHDATA-MERRA2 Data Files.\n\n### Data Format\n\nThe data format used is nc4. To read such files, we need to use netCDF4 Python package.\n\n### External Resources\n\n[ON NASA site](https:\/\/disc.gsfc.nasa.gov\/information\/howto) you can find a set of instructions how to read, explore and visualize data content from EARTHDATA-MERRA2 files.\n\nIn particular, we used this resource: [How to read and plot NetCDF MERRA-2 data in Python](https:\/\/disc.gsfc.nasa.gov\/information\/howto?title=How%20to%20read%20and%20plot%20NetCDF%20MERRA-2%20data%20in%20Python)\n\n","c0d622f7":"## Data Analysis\n\n### Load Packages","b3b990fc":"### Load Data\n\n\nWe will load here only one file.","cbb96bcc":"## Plot data\n\nWe write first a function for plotting the data."}}