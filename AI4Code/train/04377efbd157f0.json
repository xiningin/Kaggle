{"cell_type":{"e4b0c918":"code","0e4c99d4":"code","3c930199":"code","ad3af5b4":"code","85dbacc9":"code","dd4c21e5":"code","93e2c7f2":"code","4bcfa842":"code","f4fd361a":"code","d603ac5f":"code","13d4638e":"code","123de882":"code","d358f4c5":"code","b1f7bce5":"code","4f0e08bb":"code","74102167":"code","aaa95189":"code","18d591b8":"code","8c799c36":"code","524759ba":"markdown","50ffbf50":"markdown","989c92ec":"markdown","371838cf":"markdown"},"source":{"e4b0c918":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","0e4c99d4":"import pandas as pd \nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt","3c930199":"df = pd.read_csv('..\/input\/stroke-prediction-dataset\/healthcare-dataset-stroke-data.csv')\ndf.head()","ad3af5b4":"df.describe().astype(int)","85dbacc9":"df.isna().sum()","dd4c21e5":"df.info()\n","93e2c7f2":"print('ever_married: ',df.ever_married.value_counts(), '\\n')\nprint('gender: ',df.gender.value_counts(), '\\n')\nprint('work_type: ',df.work_type.value_counts(), '\\n')\nprint('Residence_type: ',df.Residence_type.value_counts(), '\\n')\nprint('smoking_status: ',df.smoking_status.value_counts(), '\\n')\n","4bcfa842":"## Convert to numerical value\n\ndef to_cat(df):\n    for label,content in df.items():\n        if not pd.api.types.is_numeric_dtype(content):\n            df[label] = content.astype('category')\n            \ndef turn_to_numeric(df):\n      for label,content in df.items():\n        if not pd.api.types.is_numeric_dtype(content):\n            df[label] = pd.Categorical(content).codes +1\n    \nto_cat(df)\nturn_to_numeric(df)","f4fd361a":"df.head()","d603ac5f":"df.info()","13d4638e":"## Fill Nan\ndf.bmi = df.bmi.fillna(df.bmi.median())\n","123de882":"plt.figure(figsize=(16,12))\nsns.heatmap(data=df.corr(), annot=True, cbar=None, cmap='YlGnBu')\nplt.xticks(rotation=0)\nplt.show()\n","d358f4c5":"plt.figure(figsize=(12,8))\npd.crosstab(df.gender,df.stroke).plot.bar(color=['lightblue', 'red'])\nplt.xticks(rotation=0)\nplt.xlabel('1: Male, 2: Female, 3: Other')\nplt.show()","b1f7bce5":"df.heart_disease.value_counts().plot.bar()","4f0e08bb":"pd.crosstab(df.heart_disease, df.stroke).plot.bar()\nheart_no_stroke, heart_stroke = df.stroke[df.heart_disease==1].value_counts()\nno_heart_no_stroke, no_heart_stroke = df.stroke[df.heart_disease==0].value_counts()\nprint(f'No heart disease: {(no_heart_stroke \/ (no_heart_stroke + no_heart_no_stroke))}')\nprint(f'Heart disease: {(heart_stroke \/ (heart_stroke + heart_no_stroke))}')","74102167":"plt.figure(figsize=(12,8))\nsns.histplot(df.age, kde=True, bins=20)","aaa95189":"plt.scatter(df.age[df.stroke == 0], df.bmi[df.stroke==0], c='lightblue' )\nplt.scatter(df.age[df.stroke == 1], df.bmi[df.stroke==1], c='red')\nplt.legend(['No stroke', 'Stroke'])\nplt.xlabel('Age')\nplt.ylabel('BMI')","18d591b8":"from sklearn.ensemble import RandomForestClassifier\nfrom sklearn.model_selection import train_test_split","8c799c36":"X = df.drop('stroke', axis=1)\ny = df.stroke\n\nX_train, X_test, y_train, y_test = train_test_split(X,y, test_size=0.2)\nclf = RandomForestClassifier(n_estimators=100,random_state=42)\nclf.fit(X_train, y_train)\nclf.score(X_test, y_test)","524759ba":"* age < 40, bmi + when age +. a > 50 bmi -, age +.\n* Most of cases is > 50. BMI < 40.\n\n","50ffbf50":"# Exploiratory Data Analysis","989c92ec":"* Stroke dependent mostly on age, hypertension, heart_disease, awg_glucose_level, and ever_married. ","371838cf":"# Stroke Prediction\n\n## 1. Problem definition"}}