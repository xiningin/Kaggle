{"cell_type":{"6b42e136":"code","9c4e1461":"code","02128cea":"code","227f7e21":"code","cda706ad":"code","a226d98e":"code","c6e754b5":"code","4fe4c4eb":"code","c1e424a8":"code","7f650226":"code","c3619a08":"code","40f88da6":"code","374e6538":"code","9ef26517":"code","e74afc53":"code","66e7768e":"code","e3884f2e":"code","6e08975d":"code","6e56df04":"code","e9ed2580":"code","c1e6d454":"code","939cd1a9":"code","ca27499b":"code","c2c45736":"code","890dd96b":"code","52f7e48c":"code","bb4e2c8d":"code","b7ae3e7e":"code","17ac4b22":"code","0e0d0faa":"code","09bc622e":"code","d7d23fb7":"code","4a8e4d08":"code","1d675367":"code","6b78bcf4":"code","87992f3f":"code","68a69fb2":"code","0a86e017":"code","21da76bd":"code","caa70de7":"code","837432a2":"code","3b768597":"markdown","5b3c4dec":"markdown","7ebe5c91":"markdown","5deae6e7":"markdown","2c9cb22d":"markdown","f5af000b":"markdown","af0fe4ae":"markdown","a322ec2a":"markdown","56459122":"markdown","94b20e4b":"markdown","44d80969":"markdown","83efa075":"markdown","5d63931d":"markdown","35bcd652":"markdown","68b7a008":"markdown","ba457024":"markdown","cb829e3b":"markdown","564a5fb4":"markdown","32ee5703":"markdown","47a3fa32":"markdown","a14ef15d":"markdown","a9d83da2":"markdown","6fcfee5f":"markdown","cf9d1b0f":"markdown","4344c373":"markdown","9eb3bedc":"markdown","4771e778":"markdown","6763a037":"markdown","1244f3a1":"markdown"},"source":{"6b42e136":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport warnings\nwarnings.filterwarnings('ignore')","9c4e1461":"data=pd.read_csv('..\/input\/Dataset_spine.csv')","02128cea":"data.info()","227f7e21":"data.head(2).T","cda706ad":"data=data.drop('Unnamed: 13',axis=1)","a226d98e":"data=data.rename({'Class_att':'Dependent variable',\n                   'Col1':'pelvic_incidence  (numeric)',  \n                   'Col2':'pelvic_tilt  (numeric)',  \n                   'Col3':'lumbar_lordosis_angle  (numeric)',  \n                   'Col4':'sacral_slope  (numeric)',  \n                   'Col5':'pelvic_radius  (numeric)',  \n                   'Col6':'degree_spondylolisthesis  (numeric)',  \n                   'Col7':'pelvic_slope(numeric)',  \n                   'Col8':'Direct_tilt(numeric)',  \n                   'Col9':'thoracic_slope(numeric)',  \n                   'Col10':'cervical_tilt(numeric)', \n                   'Col11':'sacrum_angle(numeric)', \n                   'Col12':'scoliosis_slope(numeric)'},axis=1)","c6e754b5":"plt.title('Lower Backpain symptoms target class distribution')\nplt.pie(data['Dependent variable'].value_counts(),\n        labels=data['Dependent variable'].value_counts().index,\n        autopct='%.2f',\n       explode=[0,0.05],startangle=90)\nplt.show()","4fe4c4eb":"data.hist(figsize=(15,10),grid=False)\nplt.show()","c1e424a8":"data.describe().T","7f650226":"data.plot(kind='box',subplots=True,layout=(4,4),figsize=(15,8))\nplt.show()","c3619a08":"data=pd.get_dummies(data,drop_first=True)","40f88da6":"plt.figure(figsize=(10,8))\nsns.heatmap(data.corr()[data.corr().abs()>0.3],annot=True)","374e6538":"data.info()","9ef26517":"sns.lmplot( x=\"pelvic_incidence\", y=\"pelvic_radius\", hue=\"Dependent variable_Normal\", data=data)","e74afc53":"sns.lmplot( x=\"pelvic_incidence\", y=\"degree_spondylolisthesis\", hue=\"Dependent variable_Normal\", data=data)","66e7768e":"sns.lmplot( x=\"pelvic_incidence\", y=\"lumbar_lordosis_angle\", hue=\"Dependent variable_Normal\", data=data)","e3884f2e":"data.corr()['Dependent variable_Normal'].sort_values(ascending=False)[1:].plot.barh(title='Correlation b\/w dependent & Independent Variable')","6e08975d":"from sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.decomposition import PCA\nfrom scipy.stats import zscore","6e56df04":"PCA_x=data.drop('Dependent variable_Normal',axis=1) # dropping target column","e9ed2580":"# Standardisation\nsc = StandardScaler()\nX_std =  sc.fit_transform(PCA_x)          \ncov_matrix = np.cov(X_std.T)","c1e6d454":"eig_vals, eig_vecs = np.linalg.eig(cov_matrix)\nprint('Eigen Vectors \\n%s', eig_vecs)\nprint('\\n Eigen Values \\n%s', eig_vals)","939cd1a9":"tot = sum(eig_vals)\nvar_exp = [( i \/tot ) * 100 for i in sorted(eig_vals, reverse=True)]\ncum_var_exp = np.cumsum(var_exp)\nprint(\"Cumulative Variance Explained\", cum_var_exp)","ca27499b":"pd.DataFrame(cum_var_exp).T.plot.bar(title='Cumulative variance at each variable')","c2c45736":"PCA_x_std = sc.fit_transform(PCA_x)\nbpc_reduced = PCA(n_components=7).fit_transform(PCA_x_std)","890dd96b":"BP_reduced=pd.DataFrame(bpc_reduced)\nBP_reduced.head()","52f7e48c":"sns.heatmap(BP_reduced.corr()[BP_reduced.corr().abs()>0.3],annot=True)","bb4e2c8d":"from sklearn.neighbors import KNeighborsClassifier","b7ae3e7e":"X =  BP_reduced\ny =  data[[\"Dependent variable_Normal\"]]\nX_train, X_test, Y_train, Y_test = train_test_split(X, y, test_size=0.30, random_state=1)","17ac4b22":"modelKNN=KNeighborsClassifier(n_neighbors=4)\nmodelKNN=modelKNN.fit(X_train,Y_train)","0e0d0faa":"print('train score',modelKNN.score(X_train,Y_train))\nprint('test score',modelKNN.score(X_test,Y_test))","09bc622e":"from sklearn.tree import DecisionTreeClassifier","d7d23fb7":"data.corr()[data.corr().abs()>0.2]['Dependent variable_Normal'].sort_values(ascending=False)[1:7]","4a8e4d08":"x_features=data.corr()[data.corr().abs()>0.2]['Dependent variable_Normal'].sort_values(ascending=False)[1:7].index","1d675367":"X =  data[x_features]\ny =  data[[\"Dependent variable_Normal\"]]\nX_train, X_test, Y_train, Y_test = train_test_split(X, y, test_size=0.30, random_state=1)","6b78bcf4":"dt_model = DecisionTreeClassifier()\ndt_model=dt_model.fit(X_train,Y_train)\ndt_model.score(X_train,Y_train)","87992f3f":"# Reguralisaction\ndt_model = DecisionTreeClassifier(max_depth=2)\ndt_model=dt_model.fit(X_train,Y_train)\nprint('Train accuracy',dt_model.score(X_train,Y_train))","68a69fb2":"print('Test accuracy',dt_model.score(X_test,Y_test))","0a86e017":"from sklearn.linear_model import LogisticRegression","21da76bd":"lr_model=LogisticRegression()\nlr_model=lr_model.fit(X_train,Y_train)","caa70de7":"print('Train Accuracy',lr_model.score(X_train,Y_train))\nprint('Test Accuracy',lr_model.score(X_test,Y_test))","837432a2":"lr_model=LogisticRegression(penalty='l1')\nlr_model=lr_model.fit(X_train,Y_train)\nprint('Train Accuracy',lr_model.score(X_train,Y_train))\nprint('Test Accuracy',lr_model.score(X_test,Y_test))","3b768597":"- No of tilts for different organs in descending order**(Direct_tilt>pelvic_tilt>cervical_tilt)**","5b3c4dec":"- Above data frame shows the reduced columns by using PCA(Principal Component Analysis).","7ebe5c91":"### Reduce variable using PCA","5deae6e7":"### SUMMARY","2c9cb22d":"- selecting the features having correlation value greater than 0.2","f5af000b":"![](https:\/\/hips.hearstapps.com\/hmg-prod.s3.amazonaws.com\/images\/gettyimages-923681846-1533217603.jpg?crop=1xw:0.9988221436984688xh;center,top&resize=480:*)","af0fe4ae":"- No correlation exist between the PCA reduced columns.","a322ec2a":"- I am using the same features that are used in decision tree.","56459122":"### OUTLIERS","94b20e4b":"- This model is underfitting where the test accuracy is high","44d80969":"### 2)\tDecision Tree ","83efa075":"- From this the 80% of variance is explained by first 7 variables.","5d63931d":"Lower Back Pain Symptoms Dataset : identify a person with back that is abnormal or normal using collected physical spine details.\n\n310 Observations, 13 Attributes (12 Numeric Predictors, 1 Binary Class Attribute - No Demographics).\n\nLower back pain can be caused by a variety of problems with any parts of the complex, \ninterconnected network of spinal muscles, nerves, bones, discs or tendons in the lumbar spine. Typical sources of low back pain include:\n-\tThe large nerve roots in the low back that go to the legs may be irritated\n-\tThe smaller nerves that supply the low back may be irritated\n-\tThe large paired lower back muscles (erector spinae) may be strained\n-\tThe bones, ligaments or joints may be damaged\n-\tAn intervertebral disc may be degenerating.\n\nAn irritation or problem with any of these structures can cause lower back pain and\/or pain that radiates or is referred to other parts of the body. Many lower back problems also cause back muscle spasms, which don't sound like much but can cause severe pain and disability.\nWhile lower back pain is extremely common, the symptoms and severity of lower back pain vary greatly. A simple lower back muscle strain might be excruciating enough to necessitate an emergency room visit, while a degenerating disc might cause only mild, intermittent discomfort.\n\n","35bcd652":"- After tuning some parameters,train accuracy has been improved.\n- When compared with others Logistic regression performs well.","68b7a008":"- From the above histogram, we can conclude that most of the independent attributes didn't follow the normal distribution.","ba457024":"- This model is overfit and not performing well.","cb829e3b":"- From this we can assume that most of the **normal** people have **pelvic radius of between 110 and 140**","564a5fb4":"- Most of the **normal** have zero degree of spondylolisthesis (**low severity**)","32ee5703":"- Most of the **normal** people have the **LLA(Lumbar Lordosis Angle) between 20 and 60**","47a3fa32":"- In this model I am using the pre-processed data done by PCA","a14ef15d":"- This model is almost good the test and train is almost equal.","a9d83da2":"### 3)\tLogistic regression","6fcfee5f":"- Attribute1  = pelvic_incidence  (numeric) \n- Attribute2 = pelvic_tilt (numeric) \n- Attribute3 = lumbar_lordosis_angle (numeric) \n- Attribute4 = sacral_slope (numeric) \n- Attribute5 = pelvic_radius (numeric) \n- Attribute6 = degree_spondylolisthesis (numeric) \n- Attribute7= pelvic_slope(numeric)\n- Attribute8= Direct_tilt(numeric)\t\n- Attribute9= thoracic_slope(numeric)\n- Attribute10= cervical_tilt(numeric)\n- Attribute11=sacrum_angle(numeric)\n- Attribute12= scoliosis_slope(numeric)\n- Attribute class {Abnormal, Normal} ","cf9d1b0f":"- The above chart explains that we have class imbalance of 68:32","4344c373":"### MODEL CONSTRUCTION\n### 1.KNN","9eb3bedc":"### CORRELATION","4771e778":"### DATA DISTRIBUTION","6763a037":"- Most of the outliers are found in the pelvic related attributes(pelvic_incidence,pelvic_radius,pelvic_tilt).\n- Some outliers are present in degree of spondylolisthesis.","1244f3a1":"### EDA(EXPLORATORY DATA ANALYSIS)"}}