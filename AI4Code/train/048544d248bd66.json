{"cell_type":{"a256c6e8":"code","fbf98b34":"code","b7de10a7":"code","bf14903d":"code","2b67d500":"code","d1bbdde2":"code","f3b82b75":"code","624cdf22":"code","e38290ab":"code","d15ca9e7":"code","41b49593":"code","062ab4fc":"code","ba3c502a":"code","99814b15":"code","e99b4dc2":"code","0a87af47":"code","8b1dc2c0":"code","5d256fe2":"code","efe826c1":"code","9a41509b":"code","65e0e1fc":"code","6113289d":"code","3563e001":"code","b0425e5b":"code","f4f39555":"code","112676b0":"code","01e2d468":"code","8e76bd61":"code","a3335994":"code","2e4e3c7f":"code","6341b64a":"code","a1fca796":"code","fc4872c8":"code","b10a60a9":"code","cb512943":"code","7d4d1bc9":"code","23490899":"code","9c347c51":"markdown","2c29089c":"markdown","6f849bcc":"markdown","27199c84":"markdown","f7105bf4":"markdown","7214b13f":"markdown","e17c1212":"markdown","04412daa":"markdown","06446e13":"markdown","0a6f7ed3":"markdown","e28db08a":"markdown","5e3f8fdc":"markdown","f83725fb":"markdown"},"source":{"a256c6e8":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\npd.plotting.register_matplotlib_converters()\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\nfrom datetime import timedelta","fbf98b34":"filepath = '..\/input\/d\/yamqwe\/omicron-covid19-variant-daily-cases\/covid-variants.csv'\nregion_filepath = '..\/input\/country-mapping-iso-continent-region\/continents2.csv' #to map coutries to sub-regions\npop_filepath = '..\/input\/world-population\/2021_population.csv'                    #to map countries\/sub-regions to population count\n\ndf = pd.read_csv(filepath)\nregion = pd.read_csv(region_filepath)\npop = pd.read_csv(pop_filepath)","b7de10a7":"df.head()","bf14903d":"df.info()","2b67d500":"df.date = pd.to_datetime(df.date)\ndf.info()","d1bbdde2":"df.describe()","f3b82b75":"df.describe(include='object')","624cdf22":"first_omi_date = df[(df['variant'] == 'Omicron') & (df['num_sequences'] > 0)].date.min()\nprint(f'The first Omicron variant was discovered on {first_omi_date:%d-%b-%Y}')","e38290ab":"omi_by_date = df[(df['variant'] == 'Omicron')].groupby('date').agg({'num_sequences':'sum'})\nomi_by_date","d15ca9e7":"plt.figure(figsize=(12,6))\nsns.lineplot(data = omi_by_date['num_sequences'])\nplt.xlim(first_omi_date,df.date.max())\nplt.title(f'Total number of Omicron cases by date, from {first_omi_date:%d-%b-%Y} to {df.date.max():%d-%b-%Y}')\nplt.xlabel('Date')\nplt.ylabel('Total number of Omicron cases')","41b49593":"highest_omi_cases = omi_by_date[omi_by_date['num_sequences'] == omi_by_date['num_sequences'].max()]\nprint(f\"The highest number of Omicron cases occured on {highest_omi_cases.index.date[0]:%d-%b-%Y} with {highest_omi_cases.num_sequences[0]} cases recorded.\")","062ab4fc":"omi_by_loca = df[(df['variant'] == 'Omicron')].groupby('location').agg({'num_sequences':'sum'}).sort_values('num_sequences', ascending = False)\nomi_by_loca_notnull = omi_by_loca[omi_by_loca.num_sequences > 0]\nomi_by_loca_notnull.describe()","ba3c502a":"plt.figure(figsize=(6,18))\nsns.barplot(x=omi_by_loca_notnull.num_sequences, y=omi_by_loca_notnull.index, )\nplt.title('Total number of Omicron cases, by country')","99814b15":"omi_uk = df[(df['location'] == 'United Kingdom') & (df['variant'] == 'Omicron')]","e99b4dc2":"plt.figure(figsize=(12,6))\nsns.lineplot(data = omi_uk, x = 'date', y='num_sequences', label = 'UK')\nsns.lineplot(data = omi_by_date['num_sequences'], label = 'All locations')\nplt.xlim(first_omi_date,df.date.max())\nplt.title(f'Total number of Omicron cases processed by date, from {first_omi_date:%d-%b-%Y} to {df.date.max():%d-%b-%Y}')\nplt.xlabel('Date')\nplt.ylabel('Total number of Omicron cases')","0a87af47":"region.head()\nregion2 = region.iloc[:,[0,6]]\nregion2","8b1dc2c0":"region2 = region2.rename(columns={'name':'location'})\nregion2","5d256fe2":"df2 = pd.merge(df,region2)\ndf2.head()","efe826c1":"omi_by_reg = df2[df2.variant == 'Omicron'].groupby('sub-region').agg({'num_sequences': 'sum'}).sort_values('num_sequences', ascending = False).reset_index()\nomi_by_reg.style.set_caption('Omicron cases by sub-region')","9a41509b":"plt.figure(figsize=(6,6))\nsns.barplot(x=omi_by_reg.num_sequences, y=omi_by_reg['sub-region'])\nplt.title('Total number of Omicron cases, by sub region')","65e0e1fc":"omi_by_date_reg = pd.pivot_table(df2[(df2.variant == 'Omicron') & (df2.date > first_omi_date)], \n                                 index='date',\n                                 columns='sub-region',\n                                 values='num_sequences',\n                                 aggfunc='sum',\n                                 fill_value = 0)\nomi_by_date_reg","6113289d":"plt.figure(figsize = (8,8))\nax = sns.heatmap(data = omi_by_date_reg.transpose(), annot=True, fmt = 'd',cmap = 'Blues')\nax.set_xticklabels(omi_by_date_reg.index.strftime('%d-%b-%Y'))\nplt.title('Number of Omicron cases by date and sub-region')","3563e001":"cov_by_var_reg= pd.pivot_table(df2, \n               index = 'sub-region',\n               columns = 'variant',\n               values = 'num_sequences',\n               aggfunc = 'sum')","b0425e5b":"plt.figure(figsize = (24,8))\nsns.heatmap(data = cov_by_var_reg, annot = True, fmt = 'd',cmap = 'Reds')\nplt.title('Number of COVID19 cases by variant and sub-region')","f4f39555":"covid_by_reg = df2.groupby('sub-region').agg({'num_sequences':'sum'}).sort_values('num_sequences', ascending = False).reset_index()\ncovid_by_reg","112676b0":"plt.figure(figsize=(24,6))\nsns.barplot(x=covid_by_reg['sub-region'], y=covid_by_reg.num_sequences)","01e2d468":"pop2 = pop.iloc[:,[1,2]]\npop2","8e76bd61":"pop2 = pop2.rename(columns={'country':'location', '2021_last_updated':'2021_pop'})\npop2.sort_values('location')","a3335994":"pop2.info()","2e4e3c7f":"pop2['2021_pop'] = pop2['2021_pop'].str.strip()\npop2['2021_pop'] = pop2['2021_pop'].str.replace(',',\"\")\npop2['2021_pop'] = pop2['2021_pop'].astype('int')","6341b64a":"pop2.info()","a1fca796":"pop_reg = pd.merge(pop2, region2)\npop_reg","fc4872c8":"pop_by_reg = pop_reg.groupby('sub-region').agg({'2021_pop':'sum'}).reset_index()\npop_by_reg","b10a60a9":"pop_by_reg.info()","cb512943":"reg_pop_cov = pd.merge(pop_by_reg, covid_by_reg)\nreg_pop_cov","7d4d1bc9":"reg_pop_cov.info()","23490899":"reg_pop_cov['covid_per_capita'] = reg_pop_cov['num_sequences'] \/ reg_pop_cov['2021_pop'] * 1000\nreg_pop_cov.sort_values('covid_per_capita', ascending = False)","9c347c51":"We want to look into COVID19 cases by sub-regions.","2c29089c":"We need to fix the Dtype of 'date'.","6f849bcc":"Regardless of dates, looks like most Omicron cases are centred in Northern America and Northern Europe.","27199c84":"Interpretation of this dataset:\n\nnum_sequences = total confirmed covid cases for that particular variant on that day in that location\n\nperc_sequences = num_sequences \/ num_sequences_total\n\nnum_sequences_total = total covid tests performed on that day in that location\n","f7105bf4":"Even with cases per capita, Northern America and Europe still ranks at the top of the list with Northern Europe recording 22 cases in 1000 people, while Northern America recorded 7 cases in 1000 people. However, it is also likely that these 2 regions are the top contributors to the COVID dataset.","7214b13f":"Now that we have the population size in the sub-regions, we can make a fair comparison.","e17c1212":"Let's stop focusing on Omicron and look at COVID19 sequences in general across the different sub-regions.\n\nLet's inspect if there is any relationship between region and variant.","04412daa":"There are 78 countries that has recorded at least 1 Omicron case.","06446e13":"Northern America and Europe recorded the highest number of COVID cases generally, but they also have a larger population than most other regions. We need to take into account of their population size too for a fair comparison.","0a6f7ed3":"Renaming the 'name' column to 'location' for ease of merging.","e28db08a":"United Kingdom has the highest recorded sequences of the Omicron variant.","5e3f8fdc":"We need to fix the Dtype of '2021_pop'.","f83725fb":"This dataset contains data on 24 variants in 121 countries."}}