{"cell_type":{"f827cdc7":"code","ae483248":"code","5c9d7316":"code","f73be7b8":"markdown","fa676d8e":"markdown","3d39e83a":"markdown"},"source":{"f827cdc7":"import numpy as np\nimport pandas as pd\n\ndef fill_ndarray(temp_col):\n    nan_num =np.count_nonzero(temp_col != temp_col)\n    if( nan_num != 0 ):\n        temp_not_nan_col = temp_col[temp_col == temp_col]\n        temp_col[np.isnan(temp_col)] = int(temp_not_nan_col.mean())\n    return temp_col\n\ndef load_train_feature(data_path):\n    dataframe = pd.read_csv(data_path)\n\n    # \u63d0\u53d6\u7279\u5f81\u5e8f\u5217\n    # \u8239\u8231\u7b49\u7ea7\n    dataframe = dataframe.join(pd.get_dummies(dataframe.Pclass))\n    del dataframe['Pclass']\n\n    # \u6027\u522b\n    dataframe = dataframe.join(pd.get_dummies(dataframe.Sex))\n    del dataframe['Sex']\n\n    # \u5e74\u9f84\n    # \u5e74\u9f84\u4e2d\u6709\u7f3a\u5931\u6570\u503c\uff0c\u8003\u8651\u4f7f\u7528\u5747\u503c\u8fdb\u884c\u586b\u8865\n    age = np.array(list(dataframe['Age']))\n    age = fill_ndarray(age)\n    dataframe['Age'] = age\n\n    # \u5e26\u5144\u5f1f\u59d0\u59b9\n    sibsp = np.array(list(dataframe['SibSp']))\n\n    # \u5e26\u5c0f\u5b69\n    parch = np.array(list(dataframe['Parch']))\n\n    # # \u7968\u7684\u7f16\u53f7\n    # ticket = np.array(list(dataframe['Ticket']))\n\n    # \u8d39\u7528\n    fare = np.array(list(dataframe['Fare']))\n    fare = fill_ndarray(fare)\n\n    # \u8231\u53f7\uff0c\u6839\u636e\u5934\u5b57\u6bcd\u8fdb\u884c\u5212\u5206\uff0c\u5212\u5206\u4e3aone-hot\u7f16\u7801\n    cabin = np.array(list(dataframe['Cabin']))\n    for i in range(len(cabin)):\n        if cabin[i] == 'nan':\n            cabin[i] = 'A'\n        cabin[i] = cabin[i][0]\n    # print(cabin)\n    dataframe['Cabin'] = cabin\n    dataframe = dataframe.join(pd.get_dummies(dataframe.Cabin))\n    del dataframe['Cabin']\n\n    # \u4e0a\u8239\u5730\u70b9\n    # \u7f3a\u5931\u6570\u503c\uff0c\u8003\u8651\u4f7f\u7528\u4f17\u6570\u8fdb\u884c\u586b\u8865\n    embarked = np.array(list(dataframe['Embarked']))\n    embarked = fill_ndarray(embarked)\n    embarked[embarked == 'Q'] = 10\n    embarked[embarked == 'S'] = 20\n    embarked[embarked == 'C'] = 30\n    embarked[embarked == 'nan'] = 20\n    embarked = embarked.astype('int')\n    dataframe['Embarked'] = embarked\n    dataframe = dataframe.join(pd.get_dummies(dataframe.Embarked))\n    del dataframe['Embarked']\n\n    # \u53bb\u9664ID\uff0c\u5e78\u5b58\uff0c\u59d3\u540d\uff0c\u8f66\u7968\u7b49\u7279\u5f81\n    label = np.array(list(dataframe['Survived']))\n    del dataframe['Survived']\n    del dataframe['PassengerId']\n    del dataframe['Name']\n    del dataframe['Ticket']\n    del dataframe['T']\n\n    feature = dataframe.values\n\n    return feature, label\n\n\ndef load_test_feature(data_path):\n    dataframe = pd.read_csv(data_path)\n\n    # \u63d0\u53d6\u7279\u5f81\u5e8f\u5217\n    # \u8239\u8231\u7b49\u7ea7\n    dataframe = dataframe.join(pd.get_dummies(dataframe.Pclass))\n    del dataframe['Pclass']\n\n    # \u6027\u522b\n    dataframe = dataframe.join(pd.get_dummies(dataframe.Sex))\n    del dataframe['Sex']\n\n    # \u5e74\u9f84\n    # \u5e74\u9f84\u4e2d\u6709\u7f3a\u5931\u6570\u503c\uff0c\u8003\u8651\u4f7f\u7528\u5747\u503c\u8fdb\u884c\u586b\u8865\n    age = np.array(list(dataframe['Age']))\n    age = fill_ndarray(age)\n    dataframe['Age'] = age\n\n    # \u5e26\u5144\u5f1f\u59d0\u59b9\n    sibsp = np.array(list(dataframe['SibSp']))\n\n    # \u5e26\u5c0f\u5b69\n    parch = np.array(list(dataframe['Parch']))\n\n    # # \u7968\u7684\u7f16\u53f7\n    # ticket = np.array(list(dataframe['Ticket']))\n\n    # \u8d39\u7528\n    # \u8d39\u7528\u4e2d\u6709\u7f3a\u5931\u6570\u503c\uff0c\u8003\u8651\u4f7f\u7528\u5747\u503c\u8fdb\u884c\u586b\u8865\n    fare = np.array(list(dataframe['Fare']))\n    fare = fill_ndarray(fare)\n    dataframe['Fare'] = fare\n\n    # \u8231\u53f7\uff0c\u6839\u636e\u5934\u5b57\u6bcd\u8fdb\u884c\u5212\u5206\uff0c\u5212\u5206\u4e3aone-hot\u7f16\u7801\n    cabin = np.array(list(dataframe['Cabin']))\n    for i in range(len(cabin)):\n        if cabin[i] == 'nan':\n            cabin[i] = 'A'\n        cabin[i] = cabin[i][0]\n    # print(cabin)\n    dataframe['Cabin'] = cabin\n    dataframe = dataframe.join(pd.get_dummies(dataframe.Cabin))\n    del dataframe['Cabin']\n\n    # \u4e0a\u8239\u5730\u70b9\n    # \u7f3a\u5931\u6570\u503c\uff0c\u8003\u8651\u4f7f\u7528\u4f17\u6570\u8fdb\u884c\u586b\u8865\n    embarked = np.array(list(dataframe['Embarked']))\n    embarked = fill_ndarray(embarked)\n    embarked[embarked == 'Q'] = 10\n    embarked[embarked == 'S'] = 20\n    embarked[embarked == 'C'] = 30\n    embarked[embarked == 'nan'] = 20\n    embarked = embarked.astype('int')\n    dataframe['Embarked'] = embarked*10\n    dataframe = dataframe.join(pd.get_dummies(dataframe.Embarked))\n    del dataframe['Embarked']\n\n    # \u53bb\u9664ID\uff0c\u5e78\u5b58\uff0c\u59d3\u540d\uff0c\u8f66\u7968\u7b49\u7279\u5f81\n    passengerid = np.array(dataframe['PassengerId'])\n    del dataframe['PassengerId']\n    del dataframe['Name']\n    del dataframe['Ticket']\n    \n    feature = dataframe.values\n\n    return feature, passengerid\n\ntrain_feature, train_label = load_train_feature('\/kaggle\/input\/titanic\/train.csv')\ntest_feature, passengerid = load_test_feature('\/kaggle\/input\/titanic\/test.csv')","ae483248":"from sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import classification_report\n\nmodel = RandomForestClassifier(n_estimators=90, min_samples_split=4, max_depth=8)\nmodel.fit(train_feature, train_label)\nmodel_output = model.predict(test_feature)\n# print(model_output)\n# print(model_output.shape)","5c9d7316":"model_output = (model_output > 0.5).astype('int32')\n# print(model_output)\noutput = pd.DataFrame({'PassengerId': passengerid, 'Survived': model_output})\n# print(output)\noutput.to_csv('submission.csv', index=False)","f73be7b8":"# \u8bad\u7ec3\u8fc7\u7a0b","fa676d8e":"# \u8bfb\u53d6\u6570\u636e\u5e76\u8fdb\u884c\u9884\u5904\u7406","3d39e83a":"# \u4e0a\u4f20\u7ed3\u679c"}}