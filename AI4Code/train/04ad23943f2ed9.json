{"cell_type":{"80c6ba3b":"code","e453ea75":"code","d14d9362":"code","af265ceb":"code","66feac31":"code","2b090a19":"code","63f8479b":"code","bdfa6c06":"code","46bad188":"code","43954ec1":"code","356a7937":"code","b3b5dd03":"code","669a39d7":"code","109aa707":"code","cbc50566":"code","3f08eaea":"code","3375c2ce":"code","e2b91a13":"code","5111b380":"code","50837b74":"code","1da6fd20":"code","545953cf":"code","ee9e2b1d":"code","210c6c88":"code","c6dff03e":"code","f8021f25":"code","5e4fc64c":"code","3b9414d7":"code","6e8a7d9f":"code","78340a6a":"code","76d94e6f":"code","478ae20e":"code","742bef14":"code","19b79fd2":"code","b22f5fc3":"code","07e77803":"code","5d400132":"code","85f0c495":"code","55dc27de":"code","4e0c2576":"code","d00c1d7a":"markdown","b2a4d938":"markdown","bfd33f57":"markdown","ccdeefbd":"markdown"},"source":{"80c6ba3b":"import numpy as np\nimport tensorflow as tf\nimport keras","e453ea75":"from keras.preprocessing.image import img_to_array, load_img\nfrom IPython.core.display import display","d14d9362":"FILE_1 = '..\/input\/keras-pretrained-model\/Bhotu.jpg'","af265ceb":"img = load_img(FILE_1, target_size=(299,299))","66feac31":"img","2b090a19":"img_array = img_to_array(img)\nimg_array.shape","63f8479b":"expanded = np.expand_dims(img_array, axis=0)","bdfa6c06":"expanded.shape","46bad188":"tf.Graph()","43954ec1":"from keras.applications.inception_resnet_v2 import InceptionResNetV2","356a7937":"%%time\ninception_model = InceptionResNetV2(weights='imagenet')","b3b5dd03":"inception_model.predict(expanded)","669a39d7":"from keras.applications.inception_resnet_v2 import decode_predictions","109aa707":"# prediction = inception_model.predict(expanded)","cbc50566":"# decode_predictions(prediction)","3f08eaea":"from keras.applications.inception_resnet_v2 import preprocess_input","3375c2ce":"preprocessed = preprocess_input(expanded)","e2b91a13":"preprocessed.shape","5111b380":"prediction = inception_model.predict(preprocessed)","50837b74":"decode_predictions(prediction)","1da6fd20":"# define a function","545953cf":"def format_img_inceptionresnet(filename):\n    img = load_img(filename, target_size=(299,299))\n    img_array = img_to_array(img)\n    expanded = np.expand_dims(img_array, axis=0)\n    return preprocess_input(expanded)","ee9e2b1d":"#to show image first","210c6c88":"data = format_img_inceptionresnet('..\/input\/keras-pretrained-model1\/bhotu_3mnth.jpg')\nprediction = inception_model.predict(data)\ndisplay(load_img('..\/input\/keras-pretrained-model1\/bhotu_3mnth.jpg'))\ndecode_predictions(prediction)","c6dff03e":"data = format_img_inceptionresnet('..\/input\/keras-pretrained-model1\/Dromedary-camels.jpg')\nprediction = inception_model.predict(data)\ndisplay(load_img('..\/input\/keras-pretrained-model1\/Dromedary-camels.jpg'))\ndecode_predictions(prediction)","f8021f25":"from keras.applications.vgg16 import VGG16, decode_predictions as decode_vgg, preprocess_input as preprocess_input_vgg","5e4fc64c":"def format_img_vgg16(filename):\n    img = load_img(filename, target_size=(224,224,3))\n    img_array = img_to_array(img)\n    expanded = np.expand_dims(img_array, axis=0)\n    return preprocess_input_vgg(expanded)","3b9414d7":"%%time\nvgg16_model = VGG16(weights='imagenet')","6e8a7d9f":"data = format_img_vgg16('..\/input\/keras-pretrained-model1\/africa_cropped.jpg')\nprediction = vgg16_model.predict(data)\ndisplay(load_img('..\/input\/keras-pretrained-model1\/africa_cropped.jpg'))\ndecode_predictions(prediction)","78340a6a":"data = format_img_vgg16('..\/input\/keras-pretrained-model1\/322868_1100-1100x628.jpg')\nprediction = vgg16_model.predict(data)\ndisplay(load_img('..\/input\/keras-pretrained-model1\/322868_1100-1100x628.jpg'))\ndecode_predictions(prediction)","76d94e6f":"data = format_img_vgg16('..\/input\/keras-pretrained-model1\/08 Doorway.jpg')\nprediction = vgg16_model.predict(data)\ndisplay(load_img('..\/input\/keras-pretrained-model1\/08 Doorway.jpg'))\ndecode_predictions(prediction)","478ae20e":"from keras.applications.vgg19 import VGG19, decode_predictions as decode_vgg19, preprocess_input as preprocess_input_vgg19","742bef14":"def format_img_vgg19(filename):\n    img = load_img(filename, target_size=(224,224,3))\n    img_array = img_to_array(img)\n    expanded = np.expand_dims(img_array, axis=0)\n    return preprocess_input_vgg19(expanded)","19b79fd2":"%%time\nvgg19_model = VGG19(weights='imagenet')","b22f5fc3":"data = format_img_vgg19('..\/input\/keras-pretrained-model1\/bhotu_3mnth.jpg')\nprediction = vgg19_model.predict(data)\ndisplay(load_img('..\/input\/keras-pretrained-model1\/bhotu_3mnth.jpg'))\ndecode_predictions(prediction)","07e77803":"from keras.applications.nasnet import NASNetLarge, decode_predictions as decode_nasnet, preprocess_input as preprocess_input_nasnet","5d400132":"def format_img_nasnet(filename):\n    img = load_img(filename, target_size=(331,331,3))\n    img_array = img_to_array(img)\n    expanded = np.expand_dims(img_array, axis=0)\n    return preprocess_input_nasnet(expanded)","85f0c495":"%%time\nnasnet_model = NASNetLarge(weights='imagenet')","55dc27de":"data = format_img_nasnet('..\/input\/keras-pretrained-model1\/Tower-Bridge.jpg')\nprediction = nasnet_model.predict(data)\ndisplay(load_img('..\/input\/keras-pretrained-model1\/Tower-Bridge.jpg'))\ndecode_predictions(prediction)","4e0c2576":"data = format_img_nasnet('..\/input\/keras-pretrained-model1\/11 Shoe.jpg')\nprediction = nasnet_model.predict(data)\ndisplay(load_img('..\/input\/keras-pretrained-model1\/11 Shoe.jpg'))\ndecode_predictions(prediction)","d00c1d7a":"# inception_resnet_v2 Model","b2a4d938":"# NasNetLarge model","bfd33f57":"# with VGG16 model","ccdeefbd":"# Create VGG19 model"}}