{"cell_type":{"e29d1938":"code","2f2051af":"code","9b835cb8":"code","53edd8e1":"code","703d4464":"code","6f36ad8a":"code","a2cb664a":"code","3f0149d8":"code","3fd4a826":"code","c167ac98":"code","50610c24":"code","c7ac80d0":"code","89e6eada":"code","1e45a60b":"code","17b3cb44":"code","8711737e":"markdown","2a3ac082":"markdown","25afd98f":"markdown","386d6fdd":"markdown"},"source":{"e29d1938":"#to work with linux env\nimport os \nimport shutil","2f2051af":"#copy whole dataset to kaggle\/output\n!cp -r \/kaggle\/input\/a-large-scale-fish-dataset\/Fish_Dataset\/Fish_Dataset .\/","9b835cb8":"#Remove the all GT folders to do classification task only:\ndata_path =  '\/kaggle\/working\/Fish_Dataset'\n\nfor s in os.scandir(data_path):\n    if s.is_dir():\n        for sb in os.scandir(s.path):\n            if 'GT' in sb.path:\n                shutil.rmtree(sb.path)","53edd8e1":"from fastai.vision.all import *","703d4464":"\ntarget_dir = [folder  for folder in os.scandir(data_path) if folder.is_dir()]\n","6f36ad8a":"#Create a list of path of total 9000 images - 1000 for each class\nimage_paths=[]\n\n# 2 loops to get final main  folder containing iamges\nfor p in target_dir:\n    for sb in os.scandir(p.path):\n        image_paths += get_image_files(sb)\n        \nprint(len(image_paths))","a2cb664a":"#Split train and test set\ntrain_ds , test_ds = RandomSplitter()(image_paths)\nprint(len(train_ds))\nprint(len(test_ds))","3f0149d8":"dblocks = DataBlock(blocks=(ImageBlock,CategoryBlock),\n                    get_y = parent_label,\n                    splitter=RandomSplitter(),\n                    item_tfms=Resize(460),\n                    batch_tfms=[*aug_transforms(mult=2,size=224,min_scale=0.5) ,Normalize ])","3fd4a826":"train_dl = dblocks.dataloaders(image_paths[train_ds])","c167ac98":"train_dl.show_batch()","50610c24":"#Using pre-trained model\nlearner= cnn_learner(train_dl,alexnet, metrics= accuracy,pretrained=True)","c7ac80d0":"#find the a good learning rate to start training\nlearner.lr_find()","89e6eada":"learner.fit_one_cycle(5,1e-2)","1e45a60b":"#Evaluate the model\ntest_dl = train_dl.test_dl(image_paths[test_ds],with_labels=True)\nresult = ClassificationInterpretation.from_learner(learner,dl=test_dl)\naccuracy(result.preds,result.targs)","17b3cb44":"#show the confusion matrix\nresult.plot_confusion_matrix(figsize=(10,10),dpi=60)","8711737e":"# 2.Model","2a3ac082":"### Using Fastai lib to create DataLoader","25afd98f":"# 1.Data Preparation:\n- This dataset contains 9 different seafood types collected from a supermarket in Izmir, Turkey for a university-industry collaboration project at Izmir University of Economics, and this work was published in ASYU 2020. \n\n- Dataset includes:\n    - gilt head bream\n    - red sea bream\n    - sea bass\n    - red mullet\n    - horse mackerel\n    - black sea sprat\n    - striped red mullet\n    - trout\n    - shrimp image","386d6fdd":"### The accuracy of the prediction of the is about: 98% \n"}}