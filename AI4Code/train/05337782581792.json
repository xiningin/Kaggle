{"cell_type":{"b4574fab":"code","8af42577":"code","72ed6df5":"code","60ff386f":"code","5242da15":"code","bad7f887":"code","f73f956a":"code","7b1d1d3a":"code","29c62880":"markdown","94468759":"markdown","9269c8fc":"markdown"},"source":{"b4574fab":"# https:\/\/www.kaggle.com\/maunish\/clrp-roberta-svm\n# https:\/\/www.kaggle.com\/anaverageengineer\/comlrp-baseline-for-complete-beginners","8af42577":"import spacy\nimport numpy as np\nimport pandas as pd\n\nfrom pathlib import Path\nfrom tqdm.notebook import tqdm\nfrom sklearn.metrics import mean_squared_error\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LinearRegression, Ridge","72ed6df5":"RANDOM_STATE = 41\nnlp = spacy.load('en_core_web_lg')","60ff386f":"COMPETITION_DATA_PATH = Path('..\/input\/commonlitreadabilityprize')\nTRAIN_DATA_PATH = COMPETITION_DATA_PATH \/ 'train.csv'\nTEST_DATA_PATH = COMPETITION_DATA_PATH \/ 'test.csv'","5242da15":"train_data = pd.read_csv(TRAIN_DATA_PATH)\ntest_data = pd.read_csv(TEST_DATA_PATH)\nprint(f'Length of training data: {len(train_data)}')\nprint(f'Length of test data: {len(test_data)}')","bad7f887":"with nlp.disable_pipes():\n    X_train = np.vstack([nlp(text).vector for text in tqdm(train_data['excerpt'])])\n    y_train = train_data['target']\n    print(f'Shape of Train vectors: {X_train.shape}')\n\n    X_test = np.vstack([nlp(text).vector for text in tqdm(test_data['excerpt'])])\n    print(f'Shape of Test vectors: {X_test.shape}')","f73f956a":"regressor = Ridge(fit_intercept=True, normalize=False)\nscores = cross_val_score(regressor, X_train, y_train, cv=5, scoring='neg_root_mean_squared_error')\nprint(f'Average Root mean squared error: {np.abs(np.mean(scores))}')","7b1d1d3a":"regressor = regressor.fit(X_train, y_train)\ntest_data['target'] = regressor.predict(X_test)\ntest_data[['id','target']].to_csv('submission.csv', index=False)","29c62880":"# Feature Extraction from spacy\nAll Credits to [Sumit Kumar](https:\/\/www.kaggle.com\/anaverageengineer) @anaverageengineer https:\/\/www.kaggle.com\/anaverageengineer\/comlrp-baseline-for-complete-beginners","94468759":"# Ridge Regressor\nFrom my own notebook: https:\/\/www.kaggle.com\/vigneshbaskaran\/commonlit-a1-pure-scikit-learn","9269c8fc":"# Refit model and submit"}}