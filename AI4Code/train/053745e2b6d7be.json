{"cell_type":{"03021bf4":"code","cf9fd24c":"code","d25f1f59":"code","b4d9e189":"code","3a9d5207":"code","10fc7735":"code","3c12c381":"code","f2277e55":"code","270a9083":"code","51cb8537":"code","81388050":"code","d6e76788":"code","24e19223":"code","af5b115d":"code","4514d170":"code","296b86ab":"code","6ffbf92f":"code","b75eddd9":"code","b5111cab":"code","1a6c0ca4":"markdown","21ae279b":"markdown","08e6821e":"markdown","8721caa9":"markdown","f24bf048":"markdown","9789035e":"markdown","298add7f":"markdown","4486d612":"markdown","3847d027":"markdown"},"source":{"03021bf4":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt","cf9fd24c":"df = pd.read_csv('..\/input\/co2-emission-by-vehicles\/CO2 Emissions_Canada.csv')\ndf.head()","d25f1f59":"df.info()","b4d9e189":"df.describe()","3a9d5207":"df.columns","10fc7735":"df.columns = ['make', 'model','class','engine','cylinders','transmission', 'fueltype', 'consumpcity', 'consumphwy', 'consumpcomb', 'consumpcombmpg', 'emissions']\ndf.head()","3c12c381":"sns.pairplot(df)","f2277e55":"df_sel = df[['make', 'model','class', 'transmission','fueltype', 'engine', 'cylinders','consumpcomb','emissions']]\ndf_sel.describe()","270a9083":"sns.pairplot(df_sel)","51cb8537":"sns.set_palette('colorblind')\nsns.scatterplot(y = 'emissions', x = 'consumpcomb', data = df_sel, hue = 'fueltype')","81388050":"sns.scatterplot(y = 'emissions', x = 'engine', data = df_sel, hue = 'cylinders')","d6e76788":"from sklearn.preprocessing import MinMaxScaler\nscaler = MinMaxScaler()\ndf_scala = df_sel[['engine','consumpcomb', 'cylinders', 'emissions']]\ndf_scala = pd.DataFrame(scaler.fit_transform(df_scala), columns = df_scala.columns)","24e19223":"from sklearn.model_selection import train_test_split\n\nX = df_scala[['engine','consumpcomb', 'cylinders']]\ny = df_scala['emissions']\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.33, random_state = 1)","af5b115d":"from sklearn.linear_model import LinearRegression\nfrom sklearn.metrics import r2_score, mean_squared_error\nlr = LinearRegression().fit(X_train, y_train)\n\ny_pred = lr.predict(X_test)\n\nlr_score = r2_score(y_test, y_pred)\nlr_rmse = mean_squared_error(y_test, y_pred, squared = False)\nprint(\"Coefficients: \", lr.coef_)\nprint(\"Intercept: \", lr.intercept_)\nprint(\"R2 Score : \", lr_score)\nprint(\"RMSE : \", lr_rmse)","4514d170":"from sklearn.tree import DecisionTreeRegressor\ndtr = DecisionTreeRegressor().fit(X_train, y_train)\n\ny_pred = dtr.predict(X_test)\n\ndtr_score = r2_score(y_test, y_pred)\ndtr_rmse = mean_squared_error(y_test, y_pred, squared = False)\nprint(\"R2 Score : \", dtr_score)\nprint(\"RMSE : \", dtr_rmse)","296b86ab":"from sklearn.ensemble import RandomForestRegressor\n\nrfr = RandomForestRegressor().fit(X_train, y_train)\n\ny_pred = rfr.predict(X_test)\n\nrfr_score = r2_score(y_test, y_pred)\nrfr_rmse = mean_squared_error(y_test, y_pred, squared = False)\nprint(\"R2 Score : \", rfr_score)\nprint(\"RMSE : \", rfr_rmse)","6ffbf92f":"log = pd.DataFrame({\n    'Name' : ['Linear Regression', 'Decision Tree', 'RandomForestRegressor'],\n    'R2 Score' : [lr_score, dtr_score, rfr_score],\n    'RMSE' : [lr_rmse, dtr_rmse, rfr_rmse]\n})\nlog","b75eddd9":"plt.title('R2 score')\nplt.bar(log['Name'], log['R2 Score'], color = ['r','g','b','y'])\nplt.xlabel('Model')\nplt.ylabel('r^2 score')\nplt.ylim(0, 1)","b5111cab":"plt.title('rmse')\nplt.bar(log['Name'], log['RMSE'], color = ['r','g','b','y'])\nplt.xlabel('Model')\nplt.ylabel('RMSE')","1a6c0ca4":"**Load and renaming columns of dataset**","21ae279b":"**From the scatterplot in cell [10], the graph shows a linear relationship. However, diesel and ethanol type fuels are seen separately. so we try to use decision tree and random forest**","08e6821e":"**Linear Regression**","8721caa9":"**The graph below illustrates the relationship between fuel consumption and emissions. the higher the fuel consumption the higher the emissions. however, type E (Ethanol) fuel has lower emissions than other types of fuel, while type D (Diesel) fuel has higher emissions.**","f24bf048":"**Random Forest Regressor has the best performance with**\n**R2 Score : 0.978925**\n**RMSE     : 0.019842**","9789035e":"**The graph below shows the larger the engine capacity the higher the emissions, and the engines that have more cylinders emit more emissions**","298add7f":"**Importing Library**","4486d612":"**Data Selection and Analysis**","3847d027":"**Preprocessing**"}}