{"cell_type":{"969e3d01":"code","841fe919":"code","e3e51afa":"code","ddff5e05":"code","54924819":"code","0ad22a1f":"code","dc3f01b5":"markdown","ab60aa21":"markdown","ffc8d9b9":"markdown"},"source":{"969e3d01":"from sklearn.datasets import fetch_20newsgroups\n\ncategories = ['alt.atheism', 'soc.religion.christian',\n              'comp.graphics', 'sci.med']\ntwenty_train = fetch_20newsgroups(\n    subset='train',\n    categories=categories,\n    shuffle=True,\n    random_state=42,\n    remove=('headers', 'footers'),\n)\ntwenty_test = fetch_20newsgroups(\n    subset='test',\n    categories=categories,\n    shuffle=True,\n    random_state=42,\n    remove=('headers', 'footers'),\n)","841fe919":"print(twenty_train.DESCR)","e3e51afa":"from sklearn.feature_extraction.text import TfidfVectorizer\nfrom sklearn.svm import SVC\nfrom sklearn.decomposition import TruncatedSVD\nfrom sklearn.pipeline import Pipeline, make_pipeline\n\nvec = TfidfVectorizer(min_df=3, stop_words='english',\n                      ngram_range=(1, 2) , max_features = 2000)\n#svd = TruncatedSVD(n_components=100, n_iter=7, random_state=42)\nlsa = make_pipeline(vec)\n\nclf = SVC(C=150, gamma=2e-2, probability=True)\npipe = make_pipeline(lsa, clf)\npipe.fit(twenty_train.data, twenty_train.target)\npipe.score(twenty_test.data, twenty_test.target)","ddff5e05":"def print_prediction(doc):\n    y_pred = pipe.predict_proba([doc])[0]\n    for target, prob in zip(twenty_train.target_names, y_pred):\n        print(\"{:.3f} {}\".format(prob, target))\n\ndoc = twenty_test.data[20]\nprint_prediction(doc)","54924819":"print(doc)","0ad22a1f":"import eli5\nfrom eli5.lime import TextExplainer\n\nte = TextExplainer(random_state=42)\nte.fit(doc, pipe.predict_proba)\nte.show_prediction(target_names=twenty_train.target_names)","dc3f01b5":"## Model Explanation using ELI5","ab60aa21":"## Lets get a model prediction","ffc8d9b9":"## News Data from Sklearn\n\n## We will build a Machine Learning Model to classify a new group article which has 20 categories , but for illustration we are selecting only 4 categories as mentioned below\n\n## 'alt.atheism', 'comp.graphics', 'sci.med', 'soc.religion.christian'"}}