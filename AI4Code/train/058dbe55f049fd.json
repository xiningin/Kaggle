{"cell_type":{"d6bcf23e":"code","d91a0ee8":"code","90a721d8":"code","b82be8ae":"code","af5d1f71":"code","23549122":"code","553b6673":"code","fb40ae72":"code","560aabc7":"code","c36fd794":"code","04ef7726":"code","0daef80d":"code","af52068f":"code","bc23ed8b":"code","cc5ae86f":"code","2e189540":"code","8ffdf893":"code","134e8248":"code","4c5b2155":"code","53433442":"markdown","b7be1110":"markdown"},"source":{"d6bcf23e":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    print(dirname)\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","d91a0ee8":"!pip install fastbook\n\nfrom fastai import *\nfrom fastai.vision.all import *","90a721d8":"root_dir = '..\/input\/fruits\/fruits-360'","b82be8ae":"path = Path(root_dir + '\/Test')\nclasses = []\nfor dirname,_,_ in os.walk(path):\n    name = dirname.split('\/')[-1].strip() \n    if (name != 'Test'):\n        classes.append(name)\n\nprint(classes[:5])\nprint(\"Number of classes : \", len(classes))","af5d1f71":"fns =  get_image_files(path)","23549122":"fns[:5]","553b6673":"#failed = verify_images(fns)","fb40ae72":"#failed.map(Path.unlink)","560aabc7":"fruits = DataBlock (\n    blocks = (ImageBlock, CategoryBlock),\n    get_items = get_image_files,\n    splitter = RandomSplitter(valid_pct=0.2, seed=42),\n    get_y = parent_label,\n    item_tfms = Resize(128)\n)","c36fd794":"dls = fruits.dataloaders(path)","04ef7726":"dls.valid.show_batch(max_n=4, nrows=1)","0daef80d":"fruits = fruits.new(item_tfms=RandomResizedCrop(224, min_scale=0.5),\n                   batch_tfms=aug_transforms())\n\ndls = fruits.dataloaders(path)","af52068f":"dls.show_batch(max_n=16, nrows=4, unique=True)","bc23ed8b":"learn = cnn_learner(dls, resnet50, metrics=error_rate)\nlearn.fine_tune(4)","cc5ae86f":"interp = ClassificationInterpretation.from_learner(learn)\ninterp.plot_confusion_matrix()","2e189540":"interp.plot_top_losses(4)","8ffdf893":"interp.vocab","134e8248":"# checking on a random fruit form test\nlearn.predict('..\/input\/fruits\/fruits-360\/Test\/Apple Granny Smith\/321_100.jpg')","4c5b2155":"learn.export()","53433442":"### Fruits 360\n\nCreating a simple fruit classifier using outof the box fastai","b7be1110":"correct prediction !"}}