{"cell_type":{"23063788":"code","c21e5fc2":"code","7a19980a":"code","300954ff":"code","b9ded42c":"code","da50c58a":"code","c7713e0e":"code","3b5e16c0":"code","40933dcc":"code","3c1444c3":"code","b8664aac":"markdown","6a133ba1":"markdown","f5e138fb":"markdown","fe01ac07":"markdown","d9cae2fa":"markdown","b80efc1d":"markdown","0b40e464":"markdown","f99f6cc2":"markdown","0b853021":"markdown","e904adcc":"markdown","a5d24dee":"markdown","1fd06046":"markdown","841025fb":"markdown","0dc5845d":"markdown","e40f2f5e":"markdown","82eb510a":"markdown","fca61ac8":"markdown","d055d81a":"markdown","0a7a3a6c":"markdown"},"source":{"23063788":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","c21e5fc2":"ads_df = pd.read_csv(\"..\/input\/Ads_Optimisation.csv\")\nads_df.head()","7a19980a":"ads_df.info()","300954ff":"import matplotlib.pyplot as plt\nimport seaborn as sns\nads = ads_df.columns\nad_reward = [ads_df.values[:,i].sum() for i in range(len(ads))]\nplt.xticks(rotation = 45)\nsns.barplot(ads, ad_reward, palette='rainbow')\nplt.ylabel('Performance')\nplt.xlabel('Ad_Type')\nplt.title('Ads_Performance')","b9ded42c":"import random\nd = len(ads)\nrounds = ads_df.values.shape[0]\nad_selected = []\ntotal_reward = 0\n\nfor n in range(rounds):\n    ad = random.randint(1,10)\n    reward = ads_df.values[n,ad-1]\n    total_reward += reward\n    ad_selected.append(ad-1)\n\nprint('Total Reward on Random Selection of Ads: {}'.format(total_reward)) ","da50c58a":"sns.countplot(ad_selected, palette='RdBu_r')\nplt.xlabel('Ad_Type')\n","c7713e0e":"num_ad_i_selcted =[0]*d   # where each column represents each ad\ntotal_reward_i = [0]*d    # columns will represent the clicks each ad got\nad_selected = []\ntotal_reward = 0\nfor n in range(rounds):\n    max_ucb = 0\n    ad= 0\n    for i in range(0,d):\n        '''this if-else condition makes sure that for the first 10 rounds we have each ad selected once\n        so that we have some values to start with'''\n        if num_ad_i_selcted[i]>0:\n            average_reward = total_reward_i[i]\/num_ad_i_selcted[i] # Calculating average reward\n            delta_i = np.sqrt((3\/2)*np.log(n+1)\/num_ad_i_selcted[i])\n            ucb = average_reward + delta_i # Defining the upper bound\n        else:\n            ucb = 1e400\n        if ucb>max_ucb:\n            max_ucb = ucb\n            ad = i\n    ad_selected.append(ad)\n    num_ad_i_selcted[ad] += 1\n    reward = ads_df.values[n,ad]\n    total_reward_i[ad] += reward\n    total_reward += reward\n\nprint('Total Clicks on Ads: {}'.format(total_reward))","3b5e16c0":"plt.xticks(rotation = 45)\nsns.barplot(ads, num_ad_i_selcted)","40933dcc":"d = 10\nrounds = 10000\nnum_reward_0 =[0]*d # where each column represents each ad\nnum_reward_1 = [0]*d\nad_selected = []\ntotal_reward = 0\nfor n in range(rounds):\n    max_random = 0\n    ad= 0\n    for i in range(0,d):\n        random_dist = random.betavariate(num_reward_1[i]+1,num_reward_0[i]+1 )\n        if random_dist>max_random:\n            max_random = random_dist\n            ad = i\n    ad_selected.append(ad)\n    reward = ads_df.values[n,ad]\n    if reward == 1:\n        num_reward_1[ad] += 1\n    else:\n        num_reward_0[ad] += 0\n    total_reward += reward\n\nprint(total_reward)","3c1444c3":"plt.xticks(rotation = 45)\nsns.countplot(ad_selected)","b8664aac":"**Let us now visualize manually which ads performs the best, i.e., gets most clicks**","6a133ba1":"*This notebook uses Upper Confidence Bound to optimize ad selection process for the company*","f5e138fb":"**Always** *Check for missing values*","fe01ac07":"*The inference we get from the above plot is that the Ad_5 is the best performing ad*","d9cae2fa":"*So the UCB algorithm seems to perform much better than then the one with randomly selected ads*\n\n**Let's visualize some data from the above algorithm**","b80efc1d":"*Since the Thompson Sampling is based on random distribution(betavariate), the values will change every time we run the code*","0b40e464":"**Let us use Thompson Sampling to see if we can further optimize our results**","f99f6cc2":"*No missing data fortunately*","0b853021":"*In the above graph, 0 means Ad_1, and so on*","e904adcc":"*As we can see, the ads are Uniformly selected, therefore, no learning.*","a5d24dee":"**Reinforcement Learning**","1fd06046":"**Lets visualize the outcome of the algorithm**","841025fb":"**Let us first check what result a random selection process will yeild so that we can compare our results**","0dc5845d":"*In almost all cases Thompson Sampling outperforms UCB algorithm*","e40f2f5e":"*The graph shows that it took less time for the Thompson Sampling algorithm to realize that the Ad_5 is the best performing  ad*","82eb510a":"\n**These are some examples of how Reinforcement Learning learns from its enviornment and try to produce optimized results** ","fca61ac8":"**Lets visualize the random selection**","d055d81a":"*The graph shows that according to the algorithm, Ad_5 should be selected for best result*\n\n*Since we already knew that the Ad_5 is the best performing one, the above graph is the proof that the algorithm is trying to optimmize the result by learning on its own*\n","0a7a3a6c":"*Let us try to guess why Ad_5 might perform better. Since there is no additional data given, we can make our own guesses.*        \n*1. Ad_5 appeals best to the age group the company makes product for 2. More colors, more creativity 3. Advertizement in better platform(assuming different platform for different ads) and other reasons that you can think of.*\n\n**Let us now see how using Upper Confidence Bound can optimize our result**"}}