{"cell_type":{"bdc525e1":"code","0135f0cb":"code","ebb37e7a":"code","b712213a":"code","b3fe3159":"code","628f57f9":"code","d21d1218":"code","3236974a":"code","8f5fc603":"code","a7ee1cad":"code","a0cd3212":"code","6efb9185":"code","91a357df":"code","e3417eba":"code","e1868437":"code","a76bd860":"code","08742dde":"code","fd0c61db":"code","a24f5288":"code","1baa31cb":"code","a0bdfe22":"code","14602954":"code","aedb020b":"code","0a47fcaa":"code","5fa9f8af":"code","eb6ea921":"code","bd896778":"code","dc0d8107":"markdown","09abbc0d":"markdown","731ed28d":"markdown","1b923e7e":"markdown","c3b74f43":"markdown","3fb8d464":"markdown","9ceb9bba":"markdown","e2514065":"markdown","0698e61d":"markdown","68a3d587":"markdown","5be553f5":"markdown","483c92ba":"markdown","369febe2":"markdown","fb92c051":"markdown","868a5522":"markdown","a40d8edf":"markdown","04f9e0f9":"markdown","6ceb348e":"markdown","8ec32f6c":"markdown","33887110":"markdown","d0644cd7":"markdown","344db7c8":"markdown"},"source":{"bdc525e1":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import accuracy_score,confusion_matrix,precision_score,f1_score,classification_report\nimport warnings\nwarnings.filterwarnings(\"ignore\", category=FutureWarning)\n\npd.set_option(\"max_rows\",1000000)\npd.set_option(\"max_columns\",100)\n","0135f0cb":"df = pd.read_csv('..\/input\/framingham-heart-study-dataset\/framingham.csv')\ndf = df.drop('education',axis =1)","ebb37e7a":"df.head()","b712213a":"print('Number of rows: ',df.shape[0])\nprint('Number of columns:',df.shape[1])","b3fe3159":"print(df.dtypes)","628f57f9":"duplicate_df = df[df.duplicated()]\nduplicate_df","d21d1218":"miss_val = df.isnull().sum()\/df.shape[0]*100 \nmiss_val[miss_val > 0]","3236974a":"df = df.dropna()","8f5fc603":"df.isnull().sum()\/df.shape[0]*100 \n","a7ee1cad":"df.shape","a0cd3212":"plt.figure(figsize= (8,6))\nsns.countplot(df.TenYearCHD,palette='OrRd')\nplt.title('Distribution of Target Variable',fontsize=18)\nplt.xlabel('Heart Disease (No\/Yes)',fontsize=11)\nplt.ylabel('Patient Count',fontsize=11)\n\nplt.show()","6efb9185":"# checking distributions using histograms\nfig = plt.figure(figsize = (15,20))\nax = fig.gca()\ndf.hist(ax = ax,color = 'Orange')\nplt.show()","91a357df":"plt.figure(figsize=(15,12))\nsns.heatmap(df.corr(),annot=True,cmap='Reds',linewidths=1,linecolor='k',square=True,mask=False, vmin=0, vmax=1,cbar=True)\nplt.show()","e3417eba":"num_cols = ['BMI','heartRate','sysBP','totChol','diaBP']","e1868437":"plt.title('Visualizing Outliers')\nfor i in num_cols:\n    sns.boxplot(df[i],color='Red')\n    plt.show()","a76bd860":"# cigsperday vs target\nfig, ax = plt.subplots(nrows=1,ncols=1,figsize=(12,8),facecolor='white')\ndist = df['cigsPerDay'].value_counts()\ncigs = [int(x) for x in sorted(dist.index)] \nchdCount = dict(map(lambda x: [x,0],cigs))\n\nfor t,c in zip(df['TenYearCHD'],df['cigsPerDay']):\n    chdCount[c] += t\nrates = [(chdCount[c] \/ float(dist.loc[c]))*100 for c in cigs]\n\nx = np.arange(len(cigs))\n\n\nax.bar(x,rates,color = 'Orange')\nax.set_xticks(x)\nax.set_xticklabels(cigs)\nax.set_xlabel('Cig Per Day')\nax.set_ylabel('Percentage of People with CHD')\n\nplt.show()\n","08742dde":"positive_cases = df[df['TenYearCHD'] == 1]\nplt.figure(figsize=(15,6))\nsns.countplot(x='age',data = positive_cases, hue = 'TenYearCHD', palette='Reds')\nplt.show()","fd0c61db":"y = df['TenYearCHD']\nX = df.drop('TenYearCHD',axis = 1)","a24f5288":" X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.30, random_state=0)","1baa31cb":"df_copy = df.copy()","a0bdfe22":"sc = StandardScaler()\nsc.fit(X_train)\nX_train = sc.transform(X_train)\nX_test = sc.transform(X_test)","14602954":"model = RandomForestClassifier(random_state=0)","aedb020b":"model.fit(X_train,y_train)","0a47fcaa":"y_pred = model.predict(X_test)","5fa9f8af":"print('Acurracy of train ',(model.score(X_train, y_train)*100))\nprint('Acurracy of test ',(accuracy_score(y_test, y_pred)*100))","eb6ea921":"cm1 = confusion_matrix(y_test, y_pred)\n\nf, ax = plt.subplots(figsize =(5,5))\nsns.heatmap(cm1,annot = True,cmap='Reds',linewidths=1,linecolor='k',square=True,mask=False,fmt = \".0f\",cbar=True,ax=ax)\nplt.xlabel(\"y_pred\")\nplt.ylabel(\"y_true\")\nplt.show()","bd896778":"print(classification_report(y_test,y_pred))","dc0d8107":"### Model Evaluation","09abbc0d":"### Reading the data:","731ed28d":"### Importing the libraries:","1b923e7e":"We have dropped all Na values since glucose has over 9% of missing values which we cant treat.\n\nWe yet have a good amount of data to work with.","c3b74f43":"We can see that its an imbalanced data set.","3fb8d464":"We can see how bad is smoking cigerettes for the heart. Here we have plotted the percentage of people with CHD and how many cigs per day.","9ceb9bba":"Since all the attributes are in the numerical format, we do not have to perform any encoding on it.","e2514065":"### About the dataset:\nThe dataset is publically available on the Kaggle website, and it is from an ongoing ongoing cardiovascular study on residents of the town of Framingham, Massachusetts. The classification goal is to predict whether the patient has 10-year risk of future coronary heart disease (CHD).The dataset provides the patients\u2019 information. It includes over 4,000 records and 15 attributes.","0698e61d":"### Conclusion:\nThe model is clearly struggling to predict 1 i.e. prone to CHD.\n\nThis is due to the inbalance in the dataset.\n\nWe can imporve the model by doing the following:\n    \n    1. Balancing the target variable by performing undersampling or smote.\n    2. Figuring out the best hyperparameters by performing a gridsearch.\n    ","68a3d587":"### Model Creation","5be553f5":"We can see that the people with the highest risk of developing CHD are between the ages of 51 and 63.\n\nThe number of sick people generally increases with age.","483c92ba":"Random Forest handles feature selection as well so we apply any specific techniques.\n\nThis heatmap is for us to see how the variables are correalted.","369febe2":"### Scaling the data","fb92c051":"### Attributes:\n\n    1. sex: male(0) or female(1);(Nominal)\n\n    2. age: age of the patient;(Continuous - Although the recorded ages have been truncated to whole numbers, the concept of age is continuous)\n\n    3. currentSmoker: whether or not the patient is a current smoker (Nominal)\n\n    4. cigsPerDay: the number of cigarettes that the person smoked on average in one day.(can be considered continuous as one can have any number of cigarretts, even half a cigarette.)\n\n    5. BPMeds: whether or not the patient was on blood pressure medication (Nominal)\n\n    6. prevalentStroke: whether or not the patient had previously had a stroke (Nominal)\n\n    7. prevalentHyp: whether or not the patient was hypertensive (Nominal)\n\n    8. diabetes: whether or not the patient had diabetes (Nominal)\n\n    9. totChol: total cholesterol level (Continuous)\n\n    10. sysBP: systolic blood pressure (Continuous)\n\n    11. diaBP: diastolic blood pressure (Continuous)\n\n    12. BMI: Body Mass Index (Continuous)\n\n    13. heartRate: heart rate (Continuous - In medical research, variables such as heart rate though in fact discrete, yet are considered continuous because of large number of possible values.)\n\n    14. glucose: glucose level (Continuous)\n\n    15. 10 year risk of coronary heart disease CHD (binary: \u201c1\u201d, means \u201cYes\u201d, \u201c0\u201d means \u201cNo\u201d) - Target Variable\n","868a5522":"The percentage of missing data in each attribute is given above.\n\n     Glucose has close to 9% of missing data.","a40d8edf":"There is no duplicate rows present in the data set.","04f9e0f9":"### Exploratory Data Analysis:","6ceb348e":"### Train Test Split","8ec32f6c":"We can see that the model is overfitting.\n\nThere are many missclassified data where the actual is that the person will have a CHD but the model has predicted that they wouldn't.","33887110":"Having a look at how the data is distributed.\n\nInference:\n    \n    1. male to female ratio is quite equal.\n    2. Very few people had diabetes.\n    3. There is skewness present in almost all variables.\n    4. People who had a stroke previously are almost negligible.\n    5. Most people do not take BP medications.","d0644cd7":"### Goal of the project:\n\nThe World Health Organization has estimated 12 million deaths occur worldwide, every year due to Heart diseases. Half the deaths in the United States and other developed countries are due to cardio vascular diseases. The early prognosis of cardiovascular diseases can aid in making decisions on lifestyle changes in high risk patients and in turn reduce the complications. This research intends to pinpoint the most relevant\/risk factors of heart disease as well as predict the overall risk.","344db7c8":"We have a few outliers in the above attributes.\n\nIt would not be wise to drop them since not everyone can have the similar data.\n\nMore over, what if those data points play an important role in predicting the target variable.\n"}}