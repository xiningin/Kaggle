{"cell_type":{"70f3ceb1":"code","c617d7cb":"code","d5483fd5":"code","1ba6589c":"code","7a996fc9":"code","2801a3be":"code","56f828fe":"code","5f13d3e3":"code","cc97d5d7":"code","2d737d1e":"code","667a804f":"code","31ccc402":"code","5c44cdce":"code","21e3f81f":"code","ce284677":"code","d5ad456e":"code","1f7fe075":"code","d45c71ad":"code","414884e4":"code","343daea2":"code","d75431c9":"code","ec7cec89":"markdown","94693925":"markdown","cf3dae8e":"markdown","87e432a5":"markdown","31727137":"markdown"},"source":{"70f3ceb1":"# Import Data Plotting Modules\n\nimport matplotlib.pyplot as plt\n%matplotlib inline\n","c617d7cb":"# Import Data Processing Modules\n\nimport pandas as pd\nimport numpy as np\n","d5483fd5":"# Import Dataset and Show Head\n\ndf = pd.read_csv(\"..\/input\/african_crises.csv\")\ndf.head()\n","1ba6589c":"# Get column names\n\ndf.columns\n","7a996fc9":"## Define X and Y Variables\n\n# Define Features: Ignore the 'case', 'cc3', 'country', 'year' variables\n\nX = df[['systemic_crisis', 'exch_usd', 'domestic_debt_in_default',\n       'sovereign_external_debt_default', 'gdp_weighted_default',\n       'inflation_annual_cpi', 'independence', 'currency_crises',\n       'inflation_crises']]\n\n\n# Define the Y variable \n\nY = df['banking_crisis']\n","2801a3be":"from sklearn.model_selection import train_test_split\n\ntrain_features, val_features, train_targets, val_targets = train_test_split(X, Y, \n                                                                            test_size=0.30, \n                                                                            random_state=7)\n","56f828fe":"# Load ML Accuracy Calibration Packages\n\nfrom sklearn import metrics\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.metrics import confusion_matrix\n","5f13d3e3":"# Import the Random Forest Classifier from Sklearn\n\nfrom sklearn.ensemble import RandomForestClassifier\n\n","cc97d5d7":"# The class_weight Parameter is Set to \"balanced\" to Account for the Class Imbalance\n\nensemble = RandomForestClassifier(bootstrap=True, class_weight='balanced', criterion='gini',\n                                  max_depth=100, max_features='auto', max_leaf_nodes=10,\n                                  min_impurity_decrease=0.0, min_impurity_split=None,\n                                  min_samples_leaf=1, min_samples_split=2,\n                                  min_weight_fraction_leaf=0.0, n_estimators=1000, n_jobs=None,\n                                  oob_score=False, random_state=0, verbose=0, warm_start=False)\n","2d737d1e":"# Fit the Model to the Training Set and Test Set\n\nensemble.fit(train_features, train_targets)\n\npredicted = ensemble.predict(val_features)\n","667a804f":"# Print Accuracy Score\n\nprint('Accuracy achieved is: ' + str(np.mean(predicted == val_targets)))\nprint(metrics.classification_report(val_targets, predicted, target_names=(\"crisis\", \"no_crisis\"))),\nmetrics.confusion_matrix(val_targets, predicted)\n","31ccc402":"# Step 1: Import the Modules for Model Interpretability\n\nimport lime\nimport lime.lime_tabular\n","5c44cdce":"# Step 2: Define Feature Names\n\nfeature_names = ['systemic_crisis', 'exch_usd', 'domestic_debt_in_default',\n                 'sovereign_external_debt_default', 'gdp_weighted_default',\n                 'inflation_annual_cpi', 'independence', 'currency_crises', \n                 'inflation_crises']\n","21e3f81f":"# Step 3: Define Class Names\n\nclass_names = Y.unique()\n","ce284677":"# Step 4: Change the Features in the Training Set to a Numpy Array\n\ntrain_features.values\n","d5ad456e":"# Step 5: Create Your Explainer\n\nexplainer = lime.lime_tabular.LimeTabularExplainer(train_features.values, \n                                                   feature_names=feature_names,\n                                                   class_names=class_names,\n                                                   discretize_continuous=True)\n","1f7fe075":"# Step 6: Pick a Set of Features and Target Name to Explain\n\nval_features.iloc[136], val_targets.iloc[136]\n","d45c71ad":"# Step 7: Build The Explainer Instance\n\nexp = explainer.explain_instance(val_features.iloc[136], ensemble.predict_proba, num_features=9, top_labels=1)\n","414884e4":"exp","343daea2":"# Step 9: Show Explanation of In [17] in Notebook\n\nexp.show_in_notebook(show_table=True, show_all=False)\n","d75431c9":"# The sample \"val_features.iloc[136]\" was assigned a 40% probability of belonging to the \"crisis\" class and a 60% probability \n# of belonging to the \"no_crisis\" class. This means that the model predicts, with a 60% probability, that \n# the sample \"val_features.iloc[136]\" belongs to the \"no_crisis\" class.\n\n# The rank of the features, in terms of influence on the prediction, is (see table):\n# 1) \"systemic_crisis\", 2) \"inflation_annual_cpi\", 3) \"inflation_crises\", 4) \"exch_usd\",\n# 5) \"sovereign_external_debt_default\", 6) \"domestic_debt_in_default\", 7) \"gdp_weighted_default\", 8) \"currency_crises\"\n# and 9) \"independence\". \n\n# In the table, the color: Orange means that the variable is associated with the \"no_crisis\" probability; \n# Blue means that the variable is associated with the \"crisis\" probability; \n# White means that the variable is of no consequence.\n","ec7cec89":"# Split Data into Training and Test Sets","94693925":"# Interpreting the Explanation","cf3dae8e":"# Construct Simple Baseline Model Using Sci-Kit Learn Random Forest Package","87e432a5":"# Understand the Inner Workings of the Model Using LIME Framework","31727137":"# Import Data Plotting Modules and Dataset\n"}}