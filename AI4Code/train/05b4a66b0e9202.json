{"cell_type":{"9b9dfba5":"code","ba000d0d":"code","08e94a77":"code","e4c6165c":"code","65de1efc":"code","fed35fe1":"code","f268d732":"code","4c782baf":"code","6868d668":"code","58e410e3":"code","03053381":"code","31ad2a2c":"code","08ce1601":"code","a0f26c7d":"code","3d6a95b8":"code","257f74cf":"code","0af9d8c2":"code","ec140010":"code","7680c9f7":"code","798deeb4":"code","d00d1cc2":"code","a7ec9a42":"code","14f597db":"code","fb39d4c1":"code","631e0b77":"code","0eca3226":"code","ffb34f98":"code","2dadcfcf":"code","5eef77d2":"code","46a85cf2":"code","6be9067e":"code","2af60678":"code","7281eaca":"code","b8a941c9":"code","14888c0a":"code","9d77303d":"code","392606f6":"code","0fc124be":"code","51a04727":"code","9edf1ba6":"code","a4e12b1e":"code","38891959":"code","63d4cb76":"markdown","eb351b52":"markdown","afff90f9":"markdown","6b22ed47":"markdown","28b7a9ca":"markdown","4edb43d6":"markdown","aa25b44b":"markdown","d29f9c7d":"markdown","62992206":"markdown","f77e1b4d":"markdown","ff715192":"markdown","ffe7a1f0":"markdown","6f761826":"markdown","0a2cccc8":"markdown","fd547e06":"markdown","886bdbfa":"markdown","69d6d7c2":"markdown","ee75356b":"markdown","6edd550c":"markdown","d84fd0b8":"markdown","121a8d25":"markdown","31cbea1a":"markdown","21fd9989":"markdown"},"source":{"9b9dfba5":"import pandas as pd\nimport missingno as msno\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport warnings\nimport plotly.express as px\nfrom sklearn.preprocessing import LabelEncoder\nfrom scipy.stats import zscore\nfrom xgboost import XGBClassifier\nfrom sklearn.metrics import classification_report\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import accuracy_score,roc_auc_score,confusion_matrix\nfrom sklearn.model_selection import train_test_split\nfrom imblearn.over_sampling import SMOTE\nwarnings.filterwarnings('ignore')\ndata=pd.read_csv('..\/input\/weather-dataset-rattle-package\/weatherAUS.csv',parse_dates=['Date'])\ndata.head()","ba000d0d":"data.info()","08e94a77":"msno.bar(data,color='#ff80ff')","e4c6165c":"data.drop(['Evaporation','Sunshine','Cloud9am','Cloud3pm','Location'],axis=1,inplace=True)","65de1efc":"# Filling null values\n\ndef fill_na(info):\n    cols=info.columns\n    for col in cols:\n        if info[col].dtype=='object':\n            info[col].fillna(method='ffill',inplace=True)\n        else:\n            info[col].fillna(info[col].median(),inplace=True)\n    return info\n","fed35fe1":"cleaned_data=fill_na(data)","f268d732":"msno.bar(cleaned_data,color='#0099ff')","4c782baf":"train_data,test_data=train_test_split(cleaned_data,test_size=0.1,random_state=40)","6868d668":"categorical=[]\nnumerical_cols=[]\nfor col in cleaned_data.columns:\n    if cleaned_data[col].dtype=='object':\n        categorical.append(col)\n    else:\n        numerical_cols.append(col)\ncategorical","58e410e3":"plt.figure(figsize=(20,15))\nfor i in range(3):\n    fig=px.pie(train_data,names=train_data[categorical[i]].value_counts().index.values,\n               values=train_data[categorical[i]].value_counts(),\n               hole=0.3,title='{0}'.format(categorical[i]))\n    fig.show()\n    ","03053381":"direction_encoder=LabelEncoder()\ntrain_data.WindGustDir=direction_encoder.fit_transform(train_data.WindGustDir)\ntest_data.WindGustDir=direction_encoder.transform(test_data.WindGustDir)\nfor col in categorical[1:3]:\n    train_data[col]=direction_encoder.fit_transform(train_data[col])\n    test_data[col]=direction_encoder.transform(test_data[col])","31ad2a2c":"px.bar(data_frame=train_data,x=train_data.RainToday.value_counts().index.values,y=train_data.RainToday.value_counts(),\n       color=['NO','YES'],title='Will today rain?')","08ce1601":"px.bar(data_frame=train_data,x=train_data.RainTomorrow.value_counts().index.values,y=train_data.RainTomorrow.value_counts(),\n       color=['NO','YES'],title='Will tomorrow rain?')","a0f26c7d":"# Numerical columns\n\nnumerical_cols","3d6a95b8":"plt.figure(figsize=(32,32))\nfor i in range(12):\n    plt.subplot(4,3,(i%12)+1)\n    sns.distplot(train_data[numerical_cols[i+1]])\nplt.show()","257f74cf":"train_data.describe()","0af9d8c2":"# Removing rows with zscore of Rainfall greater than 3 or less than -3.\n\ncleaned_train_data=train_data[abs(zscore(train_data.Rainfall))<3]","ec140010":"prediction_encoder=LabelEncoder()\ncleaned_train_data.RainToday=prediction_encoder.fit_transform(cleaned_train_data.RainToday)\ncleaned_train_data.RainTomorrow=prediction_encoder.transform(cleaned_train_data.RainTomorrow)\ntest_data.RainToday=prediction_encoder.transform(test_data.RainToday)\ntest_data.RainTomorrow=prediction_encoder.transform(test_data.RainTomorrow)","7680c9f7":"cleaned_train_data.drop(['Date'],axis=1,inplace=True)","798deeb4":"# from sklearn.preprocessing import StandardScaler\n\nplt.figure(figsize=(20,20))\nsns.heatmap(cleaned_train_data.corr(),annot=True,vmin=-1)\nplt.show()","d00d1cc2":"cleaned_train_data.drop(['MinTemp','MaxTemp','Temp9am','Pressure3pm'],inplace=True,axis=1)","a7ec9a42":"test_data.drop(['MinTemp','MaxTemp','Temp9am','Pressure3pm','Date'],inplace=True,axis=1)","14f597db":"oversample=SMOTE()\ntrain_inputs,train_output=oversample.fit_resample(cleaned_train_data.drop(['RainToday'],axis=1),cleaned_train_data.RainToday)","fb39d4c1":"\nfig=px.pie(train_output,names=prediction_encoder.inverse_transform([0,1]),values=train_output.value_counts(),\n   hole=0.3,title='Today Rain?')\nfig.show()","631e0b77":"train_x,train_y1,train_y2=train_inputs.iloc[:,:11],train_output,train_inputs.iloc[:,11]\ntest_x,test_y1,test_y2=test_data.iloc[:,:11],test_data.iloc[:,11],test_data.iloc[:,12]","0eca3226":"modelLR=LogisticRegression()\nmodelLR.fit(train_x,train_y1)","ffb34f98":"\nprint('Classification Report on training data\\n',classification_report(train_y1,modelLR.predict(train_x)))\nprint('Classification Report on validation data\\n',classification_report(test_y1,modelLR.predict(test_x)))","2dadcfcf":"print('Train Accuracy of Logistic Regression model is {0} %'.format((accuracy_score(train_y1,modelLR.predict(train_x))*100).round(2)))\nprint('Validation Accuracy of Logistic Regression is {0} %'.format((accuracy_score(test_y1,modelLR.predict(test_x))*100).round(2)))","5eef77d2":"plt.figure(figsize=(10,8))\nplt.title('CONFUSION MATRICS OF TEST DATA-SET IN LOGISTIC REGRESSION')\nsns.heatmap(confusion_matrix(test_y1,modelLR.predict(test_x)),annot=True)\nplt.show()","46a85cf2":"model_xgb=XGBClassifier()\nmodel_xgb.fit(train_x,train_y1)","6be9067e":"print('Classification Report on training data\\n',classification_report(train_y1,model_xgb.predict(train_x)))\nprint('Classification Report on validation data\\n',classification_report(test_y1,model_xgb.predict(test_x)))","2af60678":"print('Train Accuracy of xgboost model is {0} %'.format((accuracy_score(train_y1,model_xgb.predict(train_x))*100).round(2)))\nprint('Validation Accuracy of xgboost model is {0} %'.format((accuracy_score(test_y1,model_xgb.predict(test_x))*100).round(2)))","7281eaca":"plt.figure(figsize=(10,8))\nplt.title('CONFUSION MATRICS OF TEST DATA-SET IN XGBOOST')\nsns.heatmap(confusion_matrix(test_y1,model_xgb.predict(test_x)),annot=True)\nplt.show()","b8a941c9":"model_random_forest=RandomForestClassifier(max_depth=10)\nmodel_random_forest.fit(train_x,train_y1)","14888c0a":"\nprint('Classification Report on training data\\n',classification_report(train_y1,model_random_forest.predict(train_x)))\nprint('Classification Report on validation data\\n',classification_report(test_y1,model_random_forest.predict(test_x)))","9d77303d":"print('Train Accuracy of Random forest model is {0} %'.format((accuracy_score(train_y1,model_random_forest.predict(train_x))*100).round(2)))\nprint('Validation Accuracy of Random forest is {0} %'.format((accuracy_score(test_y1,model_random_forest.predict(test_x))*100).round(2)))","392606f6":"plt.figure(figsize=(10,8))\nplt.title('CONFUSION MATRICS OF TEST DATA-SET IN RANDOM FOREST')\nsns.heatmap(confusion_matrix(test_y1,model_random_forest.predict(test_x)),annot=True)\nplt.show()","0fc124be":"train_x2=pd.concat([train_x,train_y1],axis=1)","51a04727":"# Using previously predicted value to predict will rain tomorrow.\n\ntest_y1_pred=pd.Series(model_xgb.predict(test_x),name='RainToday')\ntest_x2=pd.concat([test_x.reset_index(drop=True),test_y1_pred.reset_index(drop=True)],axis=1)","9edf1ba6":"xgbmodel_model2=XGBClassifier()\nxgbmodel_model2.fit(train_x2,train_y2)","a4e12b1e":"\nprint('Classification Report on training data\\n',classification_report(train_y2,xgbmodel_model2.predict(train_x2)))\nprint('Classification Report on validation data\\n',classification_report(test_y2,xgbmodel_model2.predict(test_x2)))","38891959":"print('Train Accuracy for predicting will rain tomorrow is {0} %'.format((accuracy_score(train_y2,xgbmodel_model2.predict(train_x2))*100).round(2)))\nprint('Validation Accuracy for predicting will rain tomorrow is {0} %'.format((accuracy_score(test_y2,xgbmodel_model2.predict(test_x2))*100).round(2)))","63d4cb76":"\n<h3 style=\"background-color:#00ffff;font-family:newtimeroman;font-size:400%;text-align:center;border-radius: 15px 30px;padding: 3px\">Preparing data to predict will rain tomorrow?<\/h3>","eb351b52":"<h5 style=\"background-color:#ff4dff;font-family:newtimeroman;font-size:400%;text-align:center;border-radius: 15px 30px;padding: 3px\">Logistic Regression<\/h5>","afff90f9":"## In the provided graph it is quite evident that the Rainfall feature are not uniformly distributed.<br> There are outliers in it which is required to resolved.","6b22ed47":"\n<h5 style=\"background-color:#ff4dff;font-family:newtimeroman;font-size:400%;text-align:center;border-radius: 15px 30px;padding: 3px\">XGBoost<\/h5>","28b7a9ca":"#### Filling numerical empty column with median value of that row and for categorical filling empty values with its corresponding previous value.","4edb43d6":"### As dataset it very large i.e, about 145k so 10% of dataset would be enough for testing our models.","aa25b44b":"\n<h3 style=\"background-color:#00ffff;font-family:newtimeroman;font-size:400%;text-align:center;border-radius: 15px 30px;padding: 3px\">Model Selection<\/h3>","d29f9c7d":"<h3 style=\"background-color:#00ffff;font-family:newtimeroman;font-size:400%;text-align:center;border-radius: 15px 30px;padding: 3px\">Plotting Missing values<\/h3>","62992206":"### Both models XGBoost and RandomForest have about same accuracy, so considering XGBoost to predict will today there will be rain?","f77e1b4d":"\n<h5 style=\"background-color:#ff4dff;font-family:newtimeroman;font-size:400%;text-align:center;border-radius: 15px 30px;padding: 3px\">Random Forest<\/h5>","ff715192":"<center><img src=\"https:\/\/acegif.com\/wp-content\/uploads\/rainy-10.gif\",height='500',width='600'><\/center>","ffe7a1f0":"\n<h3 style=\"background-color:#00ffff;font-family:newtimeroman;font-size:400%;text-align:center;border-radius: 15px 30px;padding: 3px\">Categorical Features<\/h3>","6f761826":"\n<h3 style=\"background-color:#12abcd;font-family:newtimeroman;font-size:400%;text-align:center;border-radius: 15px 30px;padding: 3px\">Conclusion<\/h3>","0a2cccc8":"## We have seen that both our model worked quite well to predict if today there would be rainfall with accuracy of about 99.3% and other model which predicts tomorrow's rainfall with accuracy of about 84.67 % .","fd547e06":"<h1 style=\"background-color:#8fabcd;font-family:newtimeroman;font-size:550%;text-align:center;border-radius: 15px 50px;padding: 5px\">Rainfall Predicion<\/h1>\n","886bdbfa":"## From above heatmap it is evident that some of the features are highly correlated to others so removing features with correlation greater than 0.7.","69d6d7c2":"\n<h3 style=\"background-color:#00ffff;font-family:newtimeroman;font-size:400%;text-align:center;border-radius: 15px 30px;padding: 3px\">SMOTE:- To solve data-imbalance<\/h3>","ee75356b":"<h3 style=\"background-color:#00ffff;font-family:newtimeroman;font-size:400%;text-align:center;border-radius: 15px 30px;padding: 3px\">Importing modules and Loading datasets<\/h3>","6edd550c":"### From above it is quite evident that 4 features (i.e,'Evaporation','Sunshine','Cloud9am','Cloud3pm') have more than 40% of missing data, so droping them. And also to make generalize model we need to drop location.","d84fd0b8":"<font style='color:red' size=5><center>Hope you liked this notebook. If yes, then please upvote it!! If having any suggestion or query feel free to ask in comment section<\/center><\/font>","121a8d25":"This dataset contains about 10 years of daily weather observations from many locations across Australia.\n\nRainTomorrow is the target variable to predict. It means -- did it rain the next day, Yes or No? This column is Yes if the rain for that day was 1mm or more.","31cbea1a":"\n<h3 style=\"background-color:#00ffff;font-family:newtimeroman;font-size:400%;text-align:center;border-radius: 15px 30px;padding: 3px\">Numerical Features<\/h3>","21fd9989":"## Here it is quite evident that the dataset is imbalanced so we would be using SMOTE in later section of this notebook to resolve this problem."}}