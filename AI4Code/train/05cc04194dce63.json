{"cell_type":{"36abb9d1":"code","fa639355":"code","823fc377":"code","056ecd08":"code","c2fda650":"code","a27fe600":"code","1260d589":"code","f7f72fca":"code","be0b8423":"code","59f696fd":"code","1a2a419e":"code","290b4f60":"code","57523540":"code","3bd31878":"code","d595a14d":"code","65018ee1":"code","32880c18":"code","50a4e764":"code","4a30eb8b":"code","fc7dce33":"code","58db277e":"code","5fb90159":"code","b0c59297":"code","3d5dd949":"code","f1eb1014":"code","159dbcb6":"code","f2d95081":"code","dded07e4":"code","065fa3a4":"code","4c81f51c":"code","7b99c904":"code","d5228e93":"code","341d2202":"code","7bda1e1f":"code","c80b82ab":"code","9110083d":"code","22e3eb8d":"code","5bd0097e":"code","97fb8850":"code","843bc305":"code","fc8983c2":"code","37151b31":"code","046d9489":"code","fa50adf3":"code","ea83a0cc":"code","cc88fc39":"code","e3b54f67":"code","acedccbb":"code","6ac0ed07":"code","e20718fe":"code","f5b89fb1":"code","227ef167":"code","8e2f60da":"code","aaf0cff6":"code","a84d9c0d":"code","4cdc2b1b":"code","5a3bd632":"code","464b70b0":"code","c603b42f":"code","c08ce198":"code","8882368c":"code","6084a840":"code","e48b8d41":"code","3e7c7fa4":"markdown","29377e81":"markdown","032cde07":"markdown","2f30a8ec":"markdown","8f66d0e3":"markdown","3a46700f":"markdown","4121cb5c":"markdown","de32c077":"markdown","b167a701":"markdown","b48e93af":"markdown","5d44e2a0":"markdown","64488b37":"markdown","7f0a6bd4":"markdown","95e05b95":"markdown","16f2b71b":"markdown","ec9d7a4e":"markdown","ce8be020":"markdown","6e7b712e":"markdown","d610afbb":"markdown"},"source":{"36abb9d1":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","fa639355":"train_df = pd.read_csv(\"..\/input\/nlp-getting-started\/train.csv\")\ntest_df = pd.read_csv(\"..\/input\/nlp-getting-started\/test.csv\")\n","823fc377":"train_df.head()","056ecd08":"def get_description(df):\n    print(df.info())\n    print(\"*\"* 40)\n    print(df.describe())\n    print(\"*\"* 40)\n    print(df.head(10))","c2fda650":"get_description(train_df)","a27fe600":"get_description(test_df)","1260d589":"import seaborn as sns\nimport matplotlib.pyplot as plt\n","f7f72fca":"x=train_df.target.value_counts()\nsns.barplot(x.index,x)\n","be0b8423":"def no_of_characters_graphs(df):\n    fig,(ax1,ax2)=plt.subplots(1,2,figsize=(10,5))\n    tweet_len=df[df['target']==1]['text'].str.len()\n    ax1.hist(tweet_len,color='red')\n    ax1.set_title('Disaster tweets')\n    tweet_len=df[df['target']==0]['text'].str.len()\n    ax2.hist(tweet_len,color='green')\n    ax2.set_title('Not disaster tweets')\n    fig.suptitle('Characters in tweets')\n    plt.show()","59f696fd":"no_of_characters_graphs(train_df)","1a2a419e":"def no_words_graphs(df):\n    fig,(ax1,ax2)=plt.subplots(1,2,figsize=(10,5))\n    tweet_len=df[df['target']==1]['text'].str.split().map(lambda x: len(x))\n    ax1.hist(tweet_len,color='red')\n    ax1.set_title('disaster tweets')\n    tweet_len=df[df['target']==0]['text'].str.split().map(lambda x: len(x))\n    ax2.hist(tweet_len,color='green')\n    ax2.set_title('Not disaster tweets')\n    fig.suptitle('Words in a tweet')\n    plt.show()","290b4f60":"no_words_graphs(train_df)","57523540":"from nltk.corpus import stopwords\n\nstop=set(stopwords.words('english'))\n","3bd31878":"from collections import defaultdict\nfrom collections import  Counter","d595a14d":"def create_corpus(target):\n    corpus=[]\n    \n    for x in train_df[train_df['target']==target]['text'].str.split():\n        for i in x:\n            corpus.append(i)\n    return corpus","65018ee1":"# Common stopwords in tweets","32880c18":"corpus=create_corpus(0)\n\ndic=defaultdict(int)\nfor word in corpus:\n    if word in stop:\n        dic[word]+=1\n        \ntop=sorted(dic.items(), key=lambda x:x[1],reverse=True)[:10] \nx,y=zip(*top)\nplt.bar(x,y)","50a4e764":"corpus=create_corpus(1)\n\ndic=defaultdict(int)\nfor word in corpus:\n    if word in stop:\n        dic[word]+=1\n\ntop=sorted(dic.items(), key=lambda x:x[1],reverse=True)[:10] \n    \n\n\nx,y=zip(*top)\nplt.bar(x,y)","4a30eb8b":"import re","fc7dce33":"message =\"my number is 510-123-4567\"\nmyregex = re.compile(r'\\d\\d\\d-\\d\\d\\d-\\d\\d\\d\\d')\nmatch = myregex.search(message)\nprint(match.group())","58db277e":"import re\ntxt = \"my number is 990-445-4836 and 844-096-1968\"\nmyregex = re.compile(r'\\d\\d\\d-\\d\\d\\d-\\d\\d\\d\\d')\nprint(myregex.findall(txt))\n\n            ","5fb90159":"# Basic EDA","b0c59297":"train_df.isnull().sum()","3d5dd949":"#Missing values in test set\ntest_df.isnull().sum()","f1eb1014":"train_df['target'].value_counts()","159dbcb6":"sns.barplot(train_df['target'].value_counts().index,train_df['target'].value_counts(),palette='rocket')","f2d95081":"# A disaster tweet\ndisaster_tweets = train_df[train_df['target']==1]['text']\ndisaster_tweets.values[1]","dded07e4":"non_disaster_tweets = train_df[train_df['target']==0]['text']\nnon_disaster_tweets","065fa3a4":"train_df['keyword'].value_counts()[:10]","4c81f51c":"test_df['keyword'].value_counts()[:10]","7b99c904":"# Applying a first round of text cleaning techniques","d5228e93":"# Applying a first round of text cleaning techniques\nimport string\ndef clean_text(text):\n    '''Make text lowercase, remove text in square brackets,remove links,remove punctuation\n    and remove words containing numbers.'''\n    text = text.lower()\n    text = re.sub('\\[.*?\\]', '', text)\n    text = re.sub('https?:\/\/\\S+|www\\.\\S+', '', text)\n    text = re.sub('<.*?>+', '', text)\n    text = re.sub('[%s]' % re.escape(string.punctuation), '', text)\n    text = re.sub('\\n', '', text)\n    text = re.sub('\\w*\\d\\w*', '', text)\n    return text\n\n# Applying the cleaning function to both test and training datasets\ntrain_df['text'] = train_df['text'].apply(lambda x: clean_text(x))\ntest_df['text'] = test_df['text'].apply(lambda x: clean_text(x))\n\n# Let's take a look at the updated text\ntrain_df['text'].head()","341d2202":"from wordcloud import WordCloud\nfig, (ax1, ax2) = plt.subplots(1, 2, figsize=[26, 8])\nwordcloud1 = WordCloud( background_color='white',\n                        width=600,\n                        height=400).generate(\" \".join(disaster_tweets))\nax1.imshow(wordcloud1)\nax1.axis('off')\nax1.set_title('Disaster Tweets',fontsize=40);\n\nwordcloud2 = WordCloud( background_color='white',\n                        width=600,\n                        height=400).generate(\" \".join(non_disaster_tweets))\nax2.imshow(wordcloud2)\nax2.axis('off')\nax2.set_title('Non Disaster Tweets',fontsize=40);","7bda1e1f":"import nltk\ntext = \"Are you coming , aren't you\"\ntokenizer1 = nltk.tokenize.WhitespaceTokenizer()\ntokenizer2 = nltk.tokenize.TreebankWordTokenizer()\ntokenizer3 = nltk.tokenize.WordPunctTokenizer()\ntokenizer4 = nltk.tokenize.RegexpTokenizer(r'\\w+')\n\nprint(\"Example Text: \",text)\nprint(\"------------------------------------------------------------------------------------------------\")\nprint(\"Tokenization by whitespace:- \",tokenizer1.tokenize(text))\nprint(\"Tokenization by words using Treebank Word Tokenizer:- \",tokenizer2.tokenize(text))\nprint(\"Tokenization by punctuation:- \",tokenizer3.tokenize(text))\nprint(\"Tokenization by regular expression:- \",tokenizer4.tokenize(text))","c80b82ab":"# Tokenizing the training and the test set\ntokenizer = nltk.tokenize.RegexpTokenizer(r'\\w+')\ntrain_df['text'] = train_df['text'].apply(lambda x: tokenizer.tokenize(x))\ntest_df['text'] = test_df['text'].apply(lambda x: tokenizer.tokenize(x))\ntrain_df['text'].head()","9110083d":"def remove_stopwords(text):\n    \"\"\"\n    Removing stopwords belonging to english language\n    \n    \"\"\"\n    words = [w for w in text if w not in stopwords.words('english')]\n    return words\n\n\ntrain_df['text'] = train_df['text'].apply(lambda x : remove_stopwords(x))\ntest_df['text'] = test_df['text'].apply(lambda x : remove_stopwords(x))\ntrain_df.head(10)","22e3eb8d":"# Stemming and Lemmatization examples\ntext = \"feet cats wolves talked\"\n\ntokenizer = nltk.tokenize.TreebankWordTokenizer()\ntokens = tokenizer.tokenize(text)\n\n# Stemmer\nstemmer = nltk.stem.PorterStemmer()\nprint(\"Stemming the sentence: \", \" \".join(stemmer.stem(token) for token in tokens))\n\n# Lemmatizer\nlemmatizer=nltk.stem.WordNetLemmatizer()\nprint(\"Lemmatizing the sentence: \", \" \".join(lemmatizer.lemmatize(token) for token in tokens))","5bd0097e":"# After preprocessing, the text format\ndef combine_text(list_of_text):\n    '''Takes a list of text and combines them into one large chunk of text.'''\n    combined_text = ' '.join(list_of_text)\n    return combined_text\n\ntrain_df['text'] = train_df['text'].apply(lambda x : combine_text(x))\ntest_df['text'] = test_df['text'].apply(lambda x : combine_text(x))\ntrain_df['text']\ntrain_df.head()","97fb8850":"def text_preprocessing(text):\n    \"\"\"\n    Cleaning and parsing the text.\n\n    \"\"\"\n    tokenizer = nltk.tokenize.RegexpTokenizer(r'\\w+')\n    \n    nopunc = clean_text(text)\n    tokenized_text = tokenizer.tokenize(nopunc)\n    remove_stopwords = [w for w in tokenized_text if w not in stopwords.words('english')]\n    combined_text = ' '.join(remove_stopwords)\n    return combined_text","843bc305":"from sklearn.feature_extraction.text import CountVectorizer,TfidfVectorizer\n\ncount_vectorizer = CountVectorizer()\ntrain_vectors = count_vectorizer.fit_transform(train_df['text'])\ntest_vectors = count_vectorizer.transform(test_df[\"text\"])\n\n## Keeping only non-zero elements to preserve space \nprint(train_vectors.shape)","fc8983c2":"sentences = ['The weather is sunny', 'The weather is partly sunny and partly cloudy.']","37151b31":"from sklearn.feature_extraction.text import CountVectorizer\n\nvectorizer = CountVectorizer()\nvectorizer.fit(sentences)\nvectorizer.vocabulary_","046d9489":"vectorizer.transform(sentences).toarray()\n","fa50adf3":"# StopWord removal using countvectorizer","ea83a0cc":"from nltk.corpus import stopwords\nstopwords = stopwords.words('english')\n\ncount_vectorizer = CountVectorizer(stop_words = stopwords)\ncount_vectorizer.fit(train_df['text'])\n\ntrain_vectors = count_vectorizer.fit_transform(train_df['text'])\ntest_vectors = count_vectorizer.transform(test_df[\"text\"])\n\n## Keeping only non-zero elements to preserve space \ntrain_vectors.shape","cc88fc39":"train_df.head()","e3b54f67":"count_vectorizer = CountVectorizer()\ntrain_vectors = count_vectorizer.fit_transform(train_df['text'])\ntest_vectors = count_vectorizer.transform(test_df[\"text\"])\n\n## Keeping only non-zero elements to preserve space \nprint(train_vectors[0].todense())\n","acedccbb":"train_df","6ac0ed07":"from sklearn import model_selection\nfrom sklearn.linear_model import LogisticRegression\nclf = LogisticRegression(C=1.0)\nscores = model_selection.cross_val_score(clf, train_vectors, train_df[\"target\"], cv=5, scoring=\"f1\")\nscores","e20718fe":"clf.fit(train_vectors, train_df[\"target\"])","f5b89fb1":"# Submission\nsample_submission = pd.read_csv(\"..\/input\/nlp-getting-started\/sample_submission.csv\")\nsample_submission[\"target\"] = clf.predict(test_vectors)\nsample_submission.to_csv(\"submission.csv\", index=False)","227ef167":"# Well I got a score of .078527","8e2f60da":"\nfrom sklearn.feature_extraction.text import CountVectorizer,TfidfVectorizer","aaf0cff6":"# word level\ntfidf = TfidfVectorizer(analyzer='word',token_pattern=r'\\w{1,}',max_features=5000)\ntrain_tfidf = tfidf.fit_transform(train_df['text'])\ntest_tfidf = tfidf.transform(test_df[\"text\"])","a84d9c0d":"tfidf_vectorizer = TfidfVectorizer( min_df=3,  max_features=None,analyzer='word',token_pattern=r'\\w{1,}',\n            ngram_range=(1, 3), use_idf=1,smooth_idf=1,sublinear_tf=1,\n            stop_words = stopwords)\n\ntrain_tfidf = tfidf.fit_transform(train_df['text'])\ntest_tfidf = tfidf.transform(test_df[\"text\"])","4cdc2b1b":"from sklearn.linear_model import LogisticRegression\nclf = LogisticRegression(C=1.0)\nscores = model_selection.cross_val_score(clf, train_tfidf, train_df[\"target\"], cv=5, scoring=\"f1\")\nscores","5a3bd632":"clf.fit(train_tfidf, train_df[\"target\"])\n","464b70b0":"# Submission\nsample_submission_1 = pd.read_csv(\"..\/input\/nlp-getting-started\/sample_submission.csv\")\nsample_submission_1[\"target\"] = clf.predict(test_tfidf)\nsample_submission_1.to_csv(\"submission_1.csv\", index=False)","c603b42f":"# Naives Bayes Clssifiers\n","c08ce198":"from xgboost import XGBClassifier\nfrom sklearn.naive_bayes import MultinomialNB\nfrom sklearn.metrics import f1_score\nfrom sklearn import preprocessing, decomposition, model_selection, metrics, pipeline\nfrom sklearn.model_selection import GridSearchCV,StratifiedKFold,RandomizedSearchCV","8882368c":"# Fitting a simple Naive Bayes on Counts\nclf_NB = MultinomialNB()\nscores = model_selection.cross_val_score(clf_NB, train_tfidf, train_df[\"target\"], cv=5, scoring=\"f1\")\nscores","6084a840":"clf_NB.fit(train_tfidf, train_df[\"target\"])\n","e48b8d41":"sample_submission_2 = pd.read_csv(\"..\/input\/nlp-getting-started\/sample_submission.csv\")\nsample_submission_2[\"target\"] = clf_NB.predict(test_tfidf)\nsample_submission_2.to_csv(\"submission_2.csv\", index=False)","3e7c7fa4":"By default, a scikit learn Count vectorizer can perform the following opertions over a text corpus:\n\n* Encoding via utf-8\n* converts text to lowercase\n* Tokenizes text using word level tokenization<br>\n\nCountVectorizer has a number of parameters. Let's look at some of them :","29377e81":"#5. Transforming tokens to a vector\u00b6 <br>\nAfter the initial preprocessing phase, we need to transform text into a meaningful vector (or array) of numbers. This can be done by a number of tecniques:\n<br>\n<br>\n\n","032cde07":"# Exploring the Target Column\nDistribution of the Target Column.<br>\nWe have to predict whether a given tweet is about a real disaster or not. - If so, predict a 1. If not, predict a 0.","2f30a8ec":"Now we know that the twitter has increased the character length of a tweet from 140 characters to 280.Let's make some graphical distribution for characters and size of graph in a tweet.","8f66d0e3":"It is important to note here that stemming and lemmatization sometimes donot necessarily improve results as at times we donot want to trim words but rather preserve their original form. Hence their usage actually differs from problem to problem. For this problem, I will not use these techniques.","3a46700f":"So we can conclude that no of fake disasters are more than the genuine ones","4121cb5c":"Refrences : <b>\n    \nhttps:\/\/www.kaggle.com\/parulpandey\/getting-started-with-nlp-a-general-intro\nhttps:\/\/www.kaggle.com\/parulpandey\/getting-started-with-nlp-feature-vectors","de32c077":"Well, this is a decent score. Let's try with another model that is said to work well with text data : Naive Bayes.","b167a701":"# Transforming tokens to a vectors","b48e93af":"Getting it all together- A Text Preprocessing Function<br>\nThis concludes the pre-processing part. It will be prudent to convert all the steps undertaken into a function for better reusability.","5d44e2a0":"# Text Data Preprocessing","64488b37":"# Short intro to countVectorizer","7f0a6bd4":"3. Stopwords Removal <br>\nNow, let's get rid of the stopwords i.e words which occur very frequently but have no possible value like a, an, the, are etc.","95e05b95":"1. Data Cleaning\n**Before we start with any NLP project we need to pre-process the data to get it all in a consistent format.We need to clean, tokenize and convert our data into a matrix. Some of the basic text pre-processing techniques includes:**<br>\n\nMake text all lower case or uppercase so that the algorithm does not treat the same words in different cases as different<br>\n<br>\n\n**Removing Noise** i.e everything that isn\u2019t in a standard number or letter i.e Punctuation, Numerical values, common non-sensical text <br>\n<br>\n\n**Tokenization: **Tokenization is just the term used to describe the process of converting the normal text strings into a list of tokens i.e words that we actually want. Sentence tokenizer can be used to find the list of sentences and Word tokenizer can be used to find the list of words in strings.\n<br>\n<br>\n\n**Stopword Removal:** Sometimes, some extremely common words which would appear to be of little value in helping select documents matching a user need are excluded from the vocabulary entirely. These words are called stop words","16f2b71b":"**TFIDF** <br>\nA problem with the Bag of Words approach is that highly frequent words start to dominate in the document (e.g. larger score), but may not contain as much \u201cinformational content\u201d. Also, it will give more weight to longer documents than shorter documents.\n\nOne approach is to rescale the frequency of words by how often they appear in all documents so that the scores for frequent words like \u201cthe\u201d that are also frequent across all documents are penalized. This approach to scoring is called Term Frequency-Inverse Document Frequency, or TF-IDF for short, where:\n\n**Term Frequency: is a scoring of the frequency of the word in the current document.**\n\nTF = (Number of times term t appears in a document)\/(Number of terms in the document)\n\n**Inverse Document Frequency: is a scoring of how rare the word is across documents.**\n\nIDF = 1+log(N\/n), where, N is the number of documents and n is the number of documents a term t has appeared in.\n\n","ec9d7a4e":"2. Tokenization <br>\nTokenization is a process that splits an input sequence into so-called tokens where the tokens\ncan be a word, sentence, paragraph etc. <br>\nBase upon the type of tokens we want, tokenization can be of various types, for instance","ce8be020":"# Using Advance Algorithms","6e7b712e":"Bag of Words - Countvectorizer Features\nCountvectorizer converts a collection of text documents to a matrix of token counts. <br>\nIt is important to note here that CountVectorizer comes with a lot of options to\nautomatically do preprocessing, tokenization, and stop word removal.<br>\nHowever, i did all the process manually above to just get a better understanding.\nLet's use a vanilla implementation of the countvectorizer without specifying any parameters.","d610afbb":"**Creating a Baseline Model using TFIDF**"}}