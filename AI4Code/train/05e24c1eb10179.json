{"cell_type":{"d9a6b893":"code","4062977a":"code","214de4d3":"code","6fef841b":"code","45058c57":"code","f10084a7":"code","4307d0d3":"code","69494359":"code","9a9a0b03":"code","7d97a4c9":"code","ae3cc4a7":"code","14a653fa":"code","8417da50":"markdown","bc6e8c00":"markdown","211e51c2":"markdown","28f6e320":"markdown","762cf1fa":"markdown","e15e2659":"markdown","7b99eaa5":"markdown","0006378c":"markdown","e01663cd":"markdown","6ff92045":"markdown","564ddd41":"markdown"},"source":{"d9a6b893":"!pip install imbalanced-learn\n!pip install delayed\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom sklearn.preprocessing import MinMaxScaler\nfrom imblearn.over_sampling import SMOTE\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.metrics import confusion_matrix, ConfusionMatrixDisplay","4062977a":"data = pd.read_csv(\"..\/input\/creditcardfraud\/creditcard.csv\")\ndata","214de4d3":"minmax = pd.DataFrame()\nminmax[\"Max\"] = data.max()\nminmax[\"Min\"] = data.min()\nminmax","6fef841b":"scaler = MinMaxScaler()\nfor col in data.columns[:len(data.columns)-1]:\n    data[col] = scaler.fit_transform(data[col].to_numpy().reshape(-1,1))","45058c57":"data","f10084a7":"targets,count = np.unique(data.Class,return_counts=True)\nplt.title(\"Class Balancing\")\nplt.xlabel(\"Class\")\nplt.ylabel(\"Count\")\nplt.bar([str(i) for i in targets],count)\nplt.show()","4307d0d3":"features = data[data.columns[:len(data.columns)-1]].to_numpy()\ntargets = data.Class.to_numpy()\nfeatures, targets = SMOTE().fit_resample(features,targets)\ntargets = targets.reshape(-1,1)","69494359":"target_un,count = np.unique(targets,return_counts=True)\nplt.title(\"Class Balancing\")\nplt.xlabel(\"Class\")\nplt.ylabel(\"Count\")\nplt.bar([str(i) for i in target_un],count)\nplt.show()","9a9a0b03":"X_train,X_test,Y_train,Y_test = train_test_split(features,\n                                                 targets,\n                                                 test_size=0.3,\n                                                 shuffle=True)\nprint(\"Train Feature size : \",len(X_train))\nprint(\"Train Label size   :\",len(Y_train))\nprint(\"Test Feature size  :\",len(X_test))\nprint(\"Test Label size    :\",len(Y_test))","7d97a4c9":"from sklearn.ensemble import RandomForestClassifier\nmodel = RandomForestClassifier(n_estimators=100)\nmodel.fit(X_train,Y_train)","ae3cc4a7":"print(\"Train score     : {:.2f} %\".format(accuracy_score(model.predict(X_train),Y_train)*100))\nprint(\"Test score      : {:.2f} %\".format(accuracy_score(model.predict(X_test),Y_test)*100))\nprint(\"Precision score : {:.2f} %\".format(accuracy_score(model.predict(X_test),Y_test)*100))\nprint(\"Recall score    : {:.2f} %\".format(accuracy_score(model.predict(X_test),Y_test)*100))","14a653fa":"cm = confusion_matrix(model.predict(X_test),\n                      Y_test,\n                      labels=[0,1])\n\ncmatrix = ConfusionMatrixDisplay(confusion_matrix=cm,\n                                display_labels=[\"Not Fraud\",\"Fraud\"])\ncmatrix.plot()\nplt.title(\"Confusion Matrix\")\nplt.show()","8417da50":"<h2>Class Balancing<\/h2>\n<p>Since this is a classification problem, balancing of class is essential to prevent biasing of model.<\/p>","bc6e8c00":"<h1>Data Engineering<\/h1>","211e51c2":"<p>As observed, there is a lot of variance between the minimum and maximum values of each feature. It would be better if it is scaled before modelling.<\/p>","28f6e320":"<h1 style=\"margin:auto;text-align:center;background-color:rgb(232, 230, 223);border-radius : 5px;padding-top : 25px;padding-bottom : 25px; width : 80%;font-size : 25px;\">Thank you for reading! Upvote and share my notebook if you liked it<\/h1>","762cf1fa":"<h1>Credit Card Fraud Detection - Modelling<\/h1>\n<p>Fraud detection in Credit Card Transactions using Machine Learning.<\/p>\n<img src=\"https:\/\/www.practicalecommerce.com\/wp-content\/uploads\/2019\/02\/Credit-card-fraud.jpg\" style=\"margin : auto;width : 100%;\">","e15e2659":"<p>There is a large imbalance in class - Oversampling would be correct here since there is not enough quantity of minority class to undersample. Use SMOTE to oversample the dataset.<\/p>","7b99eaa5":"<h2>Metrics<\/h2>","0006378c":"<h2>Confusion Matrix<\/h2>","e01663cd":"<p>The model performs good with negligibly less misclassifications.<\/p>","6ff92045":"<h1>Data Loading<\/h1>","564ddd41":"<h1>Modelling<\/h1>\n<p>Use a Random Forest Classifier to model the data. <\/p>"}}