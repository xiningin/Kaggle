{"cell_type":{"ba754044":"code","d61b7169":"code","3d345203":"code","517751c2":"code","25053f28":"code","66638809":"code","8940c2ca":"code","5cb7d2a4":"code","5e980320":"code","3a72a725":"code","5494bc10":"code","bb4bfe41":"code","73639945":"code","c4b7e1b5":"code","ecda7fe2":"code","0a5bc9a8":"code","609d0e5c":"code","ae8af601":"code","b08dadc7":"code","fdeca7ce":"code","1e1338eb":"code","3df37ce9":"markdown","64ecd76a":"markdown","81c28f43":"markdown","e3c9a52a":"markdown","f996072e":"markdown","2fc456a5":"markdown","3053f4a5":"markdown","bc2beb19":"markdown","e246a299":"markdown","bfe2337f":"markdown","19dec568":"markdown","4fb00c3e":"markdown"},"source":{"ba754044":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport os\n\ndf = pd.read_csv(\"..\/input\/winequalityN.csv\")\ndf.head()","d61b7169":"white_df = df[(df['type'] == 'white')]\nwhite_df.describe()","3d345203":"def remove_garbage(df):\n    df.dropna(inplace=True)\n    df = df.loc[:, [i for i in df.columns]]\n    indices_to_keep = ~df.isin([np.nan, np.inf, -np.inf]).any(1)\n    return df[indices_to_keep].astype(np.float64)\n\nwhite_df = white_df.drop(['type'], axis=1)\nwhite_df = remove_garbage(pd.DataFrame(data = white_df, columns = list(white_df.columns.values)))\nwhite_df_x = white_df.iloc[:,[i for i in range(len(white_df.columns) - 1)]]\nwhite_df_x.describe()","517751c2":"import matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set()\nsns.pairplot(white_df.iloc[:,[i for i in range(len(white_df_x.columns))]], size = 2.5)\nplt.show();","25053f28":"from scipy import stats\ndef is_normal(x, treshhold = 0.05):\n    k2,p = stats.normaltest(x)\n    print(p)\n    print(p > treshhold)\n    print('\\n')\n    return p > treshhold\n\nfor name in list(white_df_x):\n    is_normal(np.array(white_df_x[name]))","66638809":"white_df_x['alcohol'].map(type).unique()\nwhite_df_x.alcohol = white_df_x.alcohol.apply(float)","8940c2ca":"from sklearn import preprocessing\nstandrd_scaler = preprocessing.StandardScaler()\nnp_scaled = standrd_scaler.fit_transform(white_df_x)\nscaled_white_df = pd.DataFrame(np_scaled, columns = [name for name in list(white_df_x)])\nscaled_white_df.head()","5cb7d2a4":"import matplotlib.pyplot as plt\nfig = plt.figure(figsize = (20,10))\nscaled_white_df.boxplot(column=[name for name in list(scaled_white_df)], grid=False)","5e980320":"def fit_and_plot(name, dist, data):\n    upper_bound = len(data)\n    params = dist.fit(data) #return (mean, std) tuple\n    arg = params[:-2] #The skewness reduces as the value of alpha increases. (for gamma distribution)\n    #gamma is class of continue distributions\n    loc = params[0]\n    scale = params[1]\n    x = np.linspace(min(data), max(data))\n    _, ax = plt.subplots(figsize=(30, 10))\n    plt.scatter(data, np.linspace(1, 10, upper_bound))\n    ax2 = ax.twinx() # instantiate a second axes that shares the same x-axis\n    plt.plot(x, dist.pdf(x, loc=0, scale=1), '-', color = \"r\")\n    plt.show()\n    print(name)\n    print('mean = ' + str(loc), 'std = ' + str(scale))\n    print('\\n')\n    return dist, loc, scale","3a72a725":"for name in list(scaled_white_df):\n    fit_and_plot(name, stats.norm, scaled_white_df[name])","5494bc10":"min_max_scaler = preprocessing.MinMaxScaler()\nnp_min_max_scaled = min_max_scaler.fit_transform(white_df_x)\nmin_max_scaled_white_df = pd.DataFrame(np_min_max_scaled, columns = [name for name in list(white_df_x)])\nfig = plt.figure(figsize = (20,10))\nmin_max_scaled_white_df.boxplot(column=[name for name in list(min_max_scaled_white_df)], grid=False)","bb4bfe41":"def outliers_detection(data):\n    data = np.array(data)\n    percentile_25 = np.percentile(data, 25)\n    percentile_50 = np.percentile(data, 50)\n    percentile_75 = np.percentile(data, 75)\n    lower_bound = percentile_25 - 1.5 * (percentile_75 - percentile_25)\n    upper_bound = percentile_75 + 1.5 * (percentile_75 - percentile_25)\n    outliers = []\n    for point in list(data):\n        if point < lower_bound or point > upper_bound:\n            outliers.append(point)\n        else:\n            outliers.append('not a outlier')\n    \n    return outliers","73639945":"d_outliers_focused = {}\nfor name in list(white_df_x):\n    d_outliers_focused.setdefault(name, outliers_detection(white_df_x[name]))\nwhite_df_outliers_focused = pd.DataFrame(data=d_outliers_focused)\nwhite_df_outliers_focused.head()","c4b7e1b5":"series_list = []\nfor index, row in white_df_outliers_focused.iterrows():\n    for name in list(white_df_outliers_focused):\n        if type(row[name]) == np.float64:\n            series_list.append(row)\n            break\n            \nwhite_df_outliers = pd.DataFrame(series_list, columns=list(white_df_outliers_focused))\nwhite_df_outliers.describe()","ecda7fe2":"white_df_outliers.head(50)","0a5bc9a8":"outliers_quality = pd.concat((white_df_outliers, white_df['quality']), axis=1).dropna()\nquality = list(outliers_quality['quality'])\nmax(set(quality), key=quality.count)","609d0e5c":"outliers_indices = white_df_outliers.index.tolist()\nprint(outliers_indices)","ae8af601":"white_df_x.drop(white_df_x.index[outliers_indices], inplace=True)\nwhite_df_x.describe()","b08dadc7":"for name in list(white_df_x):\n    is_normal(np.array(white_df_x[name]))","fdeca7ce":"np_scaled = standrd_scaler.fit_transform(white_df_x)\nscaled_white_df = pd.DataFrame(np_scaled, columns = [name for name in list(white_df_x)])\nscaled_white_df.head()","1e1338eb":"fit_and_plot('chlorides', stats.norm, scaled_white_df['chlorides'])","3df37ce9":"The outliars dataframe. If there is a cell with the outliar value, in the white_df_outliers_focused dataframe, the whole row (the specific kind of wine) is outliar ","64ecd76a":"Normality checking:","81c28f43":"The outliers indices:","e3c9a52a":"Data cleaning: all NaN, inf, -inf were converted to float","f996072e":"In this research i provided an analysis of the Wine Quality dataset, to detect the outlier white wine sorts  in the data and show the possible causes why they are outliers. ","2fc456a5":"So, it can be seen, for first 50 points, that wines with high residual sugar level can be defined as the outliers, or wines with high chlorides level can be defined as the outliers. The quality median of the outliars is:","3053f4a5":"The outliers detection using upper and lower quantities :","bc2beb19":"Now p-values are much greater, so the features distributions are more close to normal. \nChecking by standartizing and visualising :","e246a299":"Removing outliers from the dataset:","bfe2337f":"Checking normality of the cleaned data:","19dec568":"The boxplots for scaled data (the MinMaxScaler was used) to correctly see the outliers:","4fb00c3e":"All of the features are so far from normal distribution, so the data was standardized to visualize the distributions in the dataset and to see the outliers"}}