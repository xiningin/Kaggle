{"cell_type":{"ae2f5f4f":"code","7b8b978b":"code","6338be1a":"code","48ee7228":"code","8efdd59b":"code","850afd91":"code","15f86d48":"code","808479c0":"code","050bcd4a":"code","7a877d95":"code","cb1c740d":"code","0321660e":"code","31b54290":"code","8f96abb8":"code","41511575":"code","099b8681":"code","7d9d04dd":"code","57c5dadd":"code","7926380e":"code","859a8f50":"code","abb155d1":"code","38ecdc70":"code","c0b18b85":"code","fed636e8":"code","7ed20685":"code","ad671217":"markdown","0bba3d72":"markdown","575c2efe":"markdown","46c20c30":"markdown","df61f28b":"markdown","a1199362":"markdown","1c9eaebc":"markdown","86e68805":"markdown","8d2b3f4a":"markdown","888b0ae3":"markdown","0cf7c9bf":"markdown","cb018343":"markdown","2f2d76d1":"markdown","fc51aad8":"markdown","3d509882":"markdown","f6f1c1b7":"markdown","18b00fb6":"markdown","7c591c59":"markdown","22e28fd5":"markdown","f740733e":"markdown"},"source":{"ae2f5f4f":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom scipy.stats import norm\nfrom sklearn.preprocessing import StandardScaler\nfrom scipy import stats\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","7b8b978b":"df = pd.read_csv(\"..\/input\/insurance.csv\")","6338be1a":"df.head()","48ee7228":"df['region'].value_counts()","8efdd59b":"df.info()","850afd91":"df.describe()","15f86d48":"sns.pairplot(df)","808479c0":"sns.distplot(df[\"charges\"],fit=norm)\nfig = plt.figure()\nres = stats.probplot(df[\"charges\"], plot=plt)","050bcd4a":"df[\"charges\"]=np.log(df['charges'])\n\nsns.distplot(df[\"charges\"],fit=norm)\nfig = plt.figure()\nres = stats.probplot(df[\"charges\"], plot=plt)","7a877d95":"sns.heatmap(df.corr(),annot=True)","cb1c740d":"df.columns","0321660e":"sex_dummy = pd.get_dummies(df['sex'])\nsmoker_dummy = pd.get_dummies(df['smoker'])\nregion_dummy = pd.get_dummies(df['region'])\n\ndf = pd.concat([df,sex_dummy,smoker_dummy,region_dummy], axis=1)\n\ndf.rename(columns={'no': 'non-smoker', 'yes': 'nicotian'}, inplace=True)\n","31b54290":"df.head(10)","8f96abb8":"We have successfully transformed our categorical variables, so we can remove these original categories from our Dataframe.","41511575":"df = df.drop(['sex','smoker','region'], axis=1)","099b8681":"df.head(10)","7d9d04dd":"from sklearn.model_selection import train_test_split","57c5dadd":"X = df[['age', 'female','male','non-smoker','nicotian','northeast','northwest','southeast','southwest','bmi', 'children']]\ny = df['charges']","7926380e":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.4)","859a8f50":"from sklearn.linear_model import LinearRegression\nlm = LinearRegression()\nlm.fit(X_train,y_train)","abb155d1":"print(lm.intercept_)\ncoeff_df = pd.DataFrame(lm.coef_,X.columns,columns=['Coefficient'])\nprint(coeff_df)","38ecdc70":"predictions = lm.predict(X_test)\nprint(\"Predicted medical costs values:\", predictions)\n","c0b18b85":"plt.scatter(y_test, predictions)","fed636e8":"sns.distplot((y_test-predictions), bins=50)","7ed20685":"from sklearn import metrics\nprint(metrics.mean_absolute_error(y_test, predictions))\nprint(metrics.mean_squared_error(y_test, predictions))\n","ad671217":"Procedure for importing and fitting the model.","0bba3d72":"Load your dataset","575c2efe":"The variable of interest is \"charges\". We want to predict what would be medical costs for specific individual, based on other given information. Let's see distribution of data for \"charges\".\n\nFrom the figure bellow we can conclude that the variable \"charges\" do not possess normal distribution of data, but it has mixture distribution. That could be a problem for further assumptions.","46c20c30":"We can see last 8 columns at dataframe below (which represent converted categories)","df61f28b":"Next figure is a heatmap. It represents mutual correlation of numerical categories from our dataset. Interesting fact -  Children category (Number of children covered by health insurance) has the lowest correlation with \"charges\". Personally, I thought it would be vice versa.","a1199362":"Graphical comparison of expected values (y_test) and predicted values (predictions)","1c9eaebc":"We want to improve normality of our data distribution so we will use simple log transformation.","86e68805":"Interesting fact number 2: Quit smoking! We can observe that smoker_label category has the highest influence on increasing medical costs. It has stronger influence than all other analyzed parameters TOGETHER.","8d2b3f4a":"**Medical Costs analysis using Simple Linear Regression**","888b0ae3":"Final part is to use fitted model for predicting new values (based on prepared X_test array)","0cf7c9bf":"Finally, let's print MAE and MSE erorrs for entire test data.","cb018343":"Eleven dataframe categories will be used as inputs X for the model. And we want to fit our model according to \"charges\" category - output Y of the model","2f2d76d1":"Firstly,  let's see basic information about our data","fc51aad8":"We have three non numerical categories: sex, smoker and region. We want to use them too. So the next step is to convert these variables to binary values by using \"One hot encoding\" method.","3d509882":"We will use train_test_split function to divide our data to training and testing data.","f6f1c1b7":"As we can see from the figures above, the log transformation has improved distribution of data and normality, which will help us to achieve better performances of our predictions.","18b00fb6":"ext part is to graphically represent our numerical data. We will plot pairplot graph form seaborn library. ","7c591c59":"Also, let's see error distribution graph of our predictions. Very close to normally distributed data.","22e28fd5":"We will create a new dataframe to present estimated coeffcieints of our model. First one is the intercept, and other coefficients are in correlation with specific categories. ","f740733e":"We have prepared our data for further processing. Finally, we can import, initialize and use the Linear Regression model."}}