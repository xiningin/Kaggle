{"cell_type":{"280a70a2":"code","5f82b4ea":"code","ddca8445":"code","7e4e70aa":"code","16a789d0":"code","4d926d75":"code","d9329350":"code","1048315e":"code","0051f43c":"code","ad80f8fe":"code","7046d8db":"code","52017290":"code","d46d818e":"code","8197a6a2":"code","eb688ccf":"code","3c5095c4":"code","99c40049":"code","a98fb80c":"code","7a45799d":"code","2e6b0a0f":"code","bcf5a238":"code","759c0150":"code","20f1d032":"code","35dc94ba":"markdown","660741ee":"markdown","ec2f3102":"markdown","49567b58":"markdown","d695be5a":"markdown"},"source":{"280a70a2":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport plotly.express as px\nfrom sklearn.cluster import KMeans\nfrom sklearn.metrics import silhouette_score\nimport plotly\nplotly.offline.init_notebook_mode (connected = True)","5f82b4ea":"data=pd.read_csv('..\/input\/high-value-customers-identification\/Ecommerce.csv', encoding='ISO-8859-1')","ddca8445":"data.head()","7e4e70aa":"data.drop('Unnamed: 8',axis=1,inplace=True)","16a789d0":"# The item that is sold the most among these customers\nitem_group=data.drop(['UnitPrice','CustomerID'],axis=1).groupby('Description').sum()","4d926d75":"item_group","d9329350":"plt.figure(figsize=(18,8))\nitem_group.sort_values(by='Quantity',ascending=False,inplace=True)\nsns.barplot(data=item_group.iloc[:11],x=item_group.index[:11],y='Quantity')\nplt.xticks(rotation=90)\nplt.show()","1048315e":"data['total_price']=data['Quantity']*data['UnitPrice']","0051f43c":"item_group2=data.drop(['UnitPrice','CustomerID','Quantity'],axis=1).groupby('Description').sum()","ad80f8fe":"item_group2","7046d8db":"plt.figure(figsize=(18,8))\nitem_group2.sort_values(by='total_price',ascending=False,inplace=True)\nsns.barplot(data=item_group2.iloc[:11],x=item_group.index[:11],y='total_price')\nplt.xticks(rotation=90)\nplt.show()","52017290":"data['Description']=pd.factorize(data['Description'])[0]\ndata['InvoiceNo']=pd.factorize(data['InvoiceNo'])[0]","d46d818e":"data=data.dropna()","8197a6a2":"data.head()","eb688ccf":"type(list(data.InvoiceNo)[0])","3c5095c4":"scaled_features=data[['Quantity','UnitPrice','CustomerID']].values","99c40049":"kmeans_kwargs = {\n   ...:     \"init\": \"random\",\n   ...:     \"n_init\": 10,\n   ...:     \"max_iter\": 300,\n   ...:     \"random_state\": 42,\n   ...: }\n   ...:\n   ...: # A list holds the SSE values for each k\n   ...: sse = []\n   ...: for k in range(1, 11):\n   ...:     kmeans = KMeans(n_clusters=k, **kmeans_kwargs)\n   ...:     kmeans.fit(scaled_features)\n   ...:     sse.append(kmeans.inertia_)","a98fb80c":"plt.style.use(\"fivethirtyeight\")\nplt.plot(range(1, 11), sse)\nplt.xticks(range(1, 11))\nplt.xlabel(\"Number of Clusters\")\nplt.ylabel(\"SSE\")\nplt.show()","7a45799d":"kmeans = KMeans(n_clusters=5, **kmeans_kwargs)\nkmeans.fit(scaled_features)","2e6b0a0f":"data['Cluster']=kmeans.predict(scaled_features)","bcf5a238":"data.head()","759c0150":"af=px.scatter_3d(data_frame=data,x='CustomerID',y='Description',z='total_price',color='Cluster')","20f1d032":"af","35dc94ba":"Items sold on the basis of the quantity","660741ee":"## From this we can see that the graph decreases linearly after 5 so 5 might be the best k for this condition","ec2f3102":"## From this we can see that 5 clusters are good enough for this data and the data is well distributed ","49567b58":"Let's see the items sold with high price","d695be5a":"## This shows that the customers can be segmented into 5 categories or clusters ...."}}