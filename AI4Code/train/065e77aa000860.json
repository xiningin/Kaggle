{"cell_type":{"82d648c8":"code","acb0256e":"code","b6521c90":"code","d7762a2a":"code","c62e2ddb":"code","9e1cd0e6":"code","7ec7d932":"code","366fbbd4":"code","df3773bc":"code","17c1ef5a":"code","aa93d2dc":"code","8f4c5c51":"code","46008039":"markdown","e0fa8af7":"markdown","fc888913":"markdown"},"source":{"82d648c8":"import torch\nfrom IPython.display import Image, clear_output  # to display images\n\nclear_output()\nprint('Setup complete. Using torch %s %s' % (torch.__version__, torch.cuda.get_device_properties(0) if torch.cuda.is_available() else 'CPU'))","acb0256e":"%cd ..","b6521c90":"!git clone https:\/\/github.com\/ultralytics\/yolov5.git  # clone repo","d7762a2a":"%cd yolov5","c62e2ddb":"%pip install -qr requirements.txt # install dependencies","9e1cd0e6":"!WANDB_MODE=\"dryrun\" python train.py --img 640 --batch 16 --epochs 88 --data ..\/input\/siim-640x640-yaml\/siim_data_640x640.yaml --hyp ..\/input\/siim-640x640-yaml\/siim640_hyp.scratch.yaml --cfg models\/yolov5x.yaml --weights ..\/input\/yolov5-weights\/best.pt --name siim","7ec7d932":"%cd ..\n%cd working","366fbbd4":"%%time\n!tar -zcf yolov5.tar.gz -C \"\/kaggle\/yolov5\" .\n#!tar -zcf labels.tar.gz -C \"\/kaggle\/tmp\/labels\/\" .","df3773bc":"%cd ..\n%cd yolov5","17c1ef5a":"import matplotlib.pyplot as plt\nplt.figure(figsize = (15, 15))\nplt.imshow(plt.imread('runs\/train\/siim5\/train_batch0.jpg'))\n\nplt.figure(figsize = (15, 15))\nplt.imshow(plt.imread('runs\/train\/siim5\/train_batch1.jpg'))\n\nplt.figure(figsize = (15, 15))\nplt.imshow(plt.imread('runs\/train\/siim5\/train_batch2.jpg'))","aa93d2dc":"fig, ax = plt.subplots(3, 2, figsize = (2*5,3*5), constrained_layout = True)\nfor row in range(3):\n    ax[row][0].imshow(plt.imread(f'runs\/train\/siim5\/test_batch{row}_labels.jpg'))\n    ax[row][0].set_xticks([])\n    ax[row][0].set_yticks([])\n    ax[row][0].set_title(f'runs\/train\/siim5\/test_batch{row}_labels.jpg', fontsize = 12)\n    \n    ax[row][1].imshow(plt.imread(f'runs\/train\/siim5\/test_batch{row}_pred.jpg'))\n    ax[row][1].set_xticks([])\n    ax[row][1].set_yticks([])\n    ax[row][1].set_title(f'runs\/train\/siim5\/test_batch{row}_pred.jpg', fontsize = 12)","8f4c5c51":"plt.figure(figsize=(30,15))\nplt.axis('off')\nplt.imshow(plt.imread('runs\/train\/siim5\/results.png'));","46008039":"# **Saving the weights**","e0fa8af7":"We can see that the mAP score hover around ~0.48 after the 32nd epoch, so training again with a lower learning rate might help to get higher mAP score!","fc888913":"Download the tar file in the working directory."}}