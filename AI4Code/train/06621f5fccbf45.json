{"cell_type":{"4e818646":"code","98dfb235":"code","63994512":"code","ac9de6b9":"code","0d0daf1d":"code","e8ab2296":"code","b37166ca":"code","723b2bfc":"code","cd3c6152":"code","e4f62188":"code","979cbd83":"code","a63ba79a":"code","05c782f6":"code","0f1862d1":"code","ef2f5e4d":"code","da912001":"code","dbd87f5c":"code","327d58e2":"code","45c0a705":"markdown","24dad06a":"markdown","ea484343":"markdown","008fba6d":"markdown","fa9ba1ec":"markdown","b37ec18f":"markdown","908a11c9":"markdown","5b1b53f2":"markdown","b635163d":"markdown","6b79b4c5":"markdown","0d3152eb":"markdown","46f2bc88":"markdown","0d8301b8":"markdown","f8eb4ead":"markdown","0401a03f":"markdown","c5d2e825":"markdown","51436f5f":"markdown","2b6c4833":"markdown","ca84790b":"markdown","e0e08245":"markdown","bfc03f2f":"markdown","79f4e46e":"markdown","40238dc5":"markdown","532748f6":"markdown","216bb185":"markdown","2cdf6b8f":"markdown","56036c38":"markdown","3a039eaa":"markdown","d5777ab3":"markdown","9f9da8b4":"markdown","42e7badb":"markdown","287b0912":"markdown"},"source":{"4e818646":"# Importing required libraries\nimport pandas as pd\nimport numpy as np\n%matplotlib inline\nimport matplotlib.pyplot as plt\nfrom mpl_toolkits import mplot3d","98dfb235":"data = pd.read_csv(\"..\/input\/advertising.csv\/Advertising.csv\")","63994512":"data.drop(\"Unnamed: 0\", axis =1,inplace=True)","ac9de6b9":"data.head()","0d0daf1d":"plt.scatter(data.TV, data.sales, color='blue', label='TV', alpha=0.5)\nplt.scatter(data.radio, data.sales, color='red', label='radio', alpha=0.5)\nplt.scatter(data.newspaper, data.sales, color='green', label='newspaper', alpha=0.5)\n\nplt.legend(loc=\"lower right\")\nplt.title(\"Sales vs. Advertising\")\nplt.xlabel(\"Advertising [1000 $]\")\nplt.ylabel(\"Sales [Thousands of units]\")\nplt.grid()\nplt.show()","e8ab2296":"from sklearn.linear_model import LinearRegression\nsk_model = LinearRegression()\nsk_model.fit(data.drop('sales', axis=1), data.sales)","b37166ca":"print(\"Intercept: \", sk_model.intercept_)\nprint(\"Coefficients: \", sk_model.coef_)","723b2bfc":"# Importing statsmodels\nimport statsmodels.formula.api as sm\n\n# Fitting the OLS on data\nmodel = sm.ols('sales ~ TV + radio + newspaper', data).fit()\nprint(model.params)","cd3c6152":"# Simple Linear regression for sales vs newspaper\nmodel_npaper = sm.ols('sales ~ newspaper', data).fit()\nprint(model_npaper.params)","e4f62188":"data.corr()","979cbd83":"# Plotting correlation heatmap\nplt.ylim(-.5,3.5)\nplt.imshow(data.corr(), cmap=plt.cm.GnBu, interpolation='nearest',data=True)\nplt.colorbar()\ntick_marks = [i for i in range(len(data.columns))]\nplt.xticks(tick_marks, data.columns, rotation=45)\nplt.yticks(tick_marks, data.columns, rotation=45)\n\n# Putting annotations\nfor i in range(len(data.columns)):\n    for j in range(len(data.columns)):\n        text = '%.2f'%(data.corr().iloc[i,j])\n        plt.text(i-0.2,j-0.1,text)","a63ba79a":"print(model.summary2())","05c782f6":"# Defining the function to evaluate amodel\ndef evaluateModel (model):\n    print(\"RSS = \", ((data.sales - model.predict())**2).sum())\n    print(\"R2 = \", model.rsquared)","0f1862d1":"ad = pd.read_csv(\"..\/input\/advertising.csv\/Advertising.csv\")","ef2f5e4d":"# For TV\nmodel_TV = sm.ols('sales ~ TV', ad).fit()\nprint(\"model_TV\")\nevaluateModel(model_TV)\nprint(\"------------\")\n\n# For radio\nmodel_radio = sm.ols('sales ~ radio', ad).fit()\nprint(\"model_radio\")\nevaluateModel(model_radio)\nprint(\"------------\")\n\n# For newspaper\nmodel_newspaper = sm.ols('sales ~ newspaper', ad).fit()\nprint(\"model_newspaper\")\nevaluateModel(model_newspaper)\nprint(\"------------\")","da912001":"# For TV & radio\nmodel_TV_radio = sm.ols('sales ~ TV + radio', ad).fit()\nprint(\"model_TV_radio\")\nevaluateModel(model_TV_radio)\nprint(\"------------\")\n\n# For TV & newspaper\nmodel_TV_newspaper = sm.ols('sales ~ TV + newspaper', ad).fit()\nprint(\"model_TV_newspaper\")\nevaluateModel(model_TV_newspaper)\nprint(\"------------\")","dbd87f5c":"# For TV, radio & newspaper\nmodel_all = sm.ols('sales ~ TV + radio + newspaper', ad).fit()\nprint(\"model_all\")\nevaluateModel(model_all)\nprint(\"------------\")","327d58e2":"\"\"\"\nCreated on Mon May 11 19:27:49 2020\n\n@author: Sangeet Aggarwal (@datasciencewithsan)\n\"\"\"\n\n# Importing few libraries again for readibility\n\nimport pandas as pd\nimport numpy as np\nfrom mpl_toolkits import mplot3d\n%matplotlib inline\nimport matplotlib.pyplot as plt\nfrom mpl_toolkits.mplot3d import Axes3D\n\n\nfig = plt.figure(figsize=(12,10))\nax = fig.add_subplot(211, projection='3d')\n\nfig.suptitle('Regression: Sales ~ TV & radio Advertising')\n\n\n# Defining z function (or sales in terms of TV and radio)\ndef z_function(x,y):\n    return (2.938889 + (0.045765*y) + (0.188530*x))\n\nX, Y = np.meshgrid(range(0,50,2),range(0,300,10))\nZ = z_function(X, Y)\n\n\n## Creating Wireframe\nax.plot_wireframe(X, Y, Z, color='black')\nax.set_xlabel('x')\nax.set_ylabel('y')\nax.set_zlabel('z')\n\n## Creating Surface plot\nax.plot_surface(X, Y, Z, rstride=1, cstride=1, cmap='winter', edgecolor='black', alpha=0.8)\n\n## Adding Scatter Plot\nax.scatter(ad.radio, ad.TV, ad.sales, c='red', s=25)\n\n## Adding labels\nax.set_xlabel('Radio')\nax.set_ylabel('TV')\nax.set_zlabel('Sales')\nax.text(0,150,1, '@DataScienceWithSan')\n\n## Rotating for better view\nax.view_init(10,30)","45c0a705":"Plotting the variables TV, radio, and sales in the 3D graph, we can visualize how our model has fit a regression plane to the data.","24dad06a":"<center> NULL HYPOTHESIS <\/center>\n\\begin{align}\nH_0 : \\beta_1 = \\beta_2 = ... = \\beta_p = 0\n\\end{align}\n\\begin{align}\nH_0 : \\beta_TV = \\beta_radio = \\beta_newspaper = 0\n\\end{align}","ea484343":"These results can be interpreted as follows:\n\n* If we fix the budget for TV & newspaper, then increasing the radio budget by 1000 USD  will lead to an increase in sales by around **189 units**(0.189*1000).\n\n* Similarly, by fixing the radio & newspaper, we infer an approximate rise of **46 units** of products per 1000 USD increase in the TV budget.\n\n* However, for the newspaper budget, since the coefficient is quite negligible (close to zero), it\u2019s evident that the newspaper is not affecting the sales. In fact, it\u2019s on the negative side of zero(-0.001) which, if the magnitude was big enough, could have meant that this agent is rather causing the sales to fall. But we cannot make that kind of inference with such negligible value.","008fba6d":"### Advertising Data\nWe are going to use Advertising data which is available on the site of USC Marshall School of Business. \nThe advertising data set consists of the sales of a product in 200 different markets, along with advertising budgets for three different media: TV, radio, and newspaper.","fa9ba1ec":"#### Plotting the heatmap to visualize the Correlation","b37ec18f":"Hence, we can say that at least one of the three advertising agents is useful in predicting sales.\n\nBut to find out, which predictor or predictors are useful and which one are not, we do **Feature Selection**","908a11c9":"#### Mathematically, general Linear Regression model can be expressed as:\n\\begin{align}\nY= \u03b2_0+ \u03b2_1 X_1+ \u03b2_2 X_2+\u22ef+ \u03b2_p X_p\n\\end{align}\n\nHere, Y is the output variable, and X terms are the corresponding input variables.The first \u03b2 term (\u03b2o) is the intercept constant and is the value of Y in absence of all predictors (i.e when all X terms are 0). ","5b1b53f2":"Two of the ways of doing Feature Selection are **Forward Selecton** & **Backward Selection**","b635163d":"---","6b79b4c5":"The values have not improved with any significance. Hence, it\u2019s imperative to not add newspaper and finalize the model with TV and radio as selected features.\nSo our final model can be expressed as below:\n\\begin{align}\nsales = 2.92 + 0.046*TV + 0.188*radio\n\\end{align}","0d3152eb":"<center> ALTERNATIVE HYPOTHESIS <\/center>\n\\begin{align}\nH_a : At \\: least \\: one \\: \\beta_i \\: is \\: non-zero\n\\end{align}","46f2bc88":"Loading and plotting the Data","0d8301b8":"We observe that for model_TV, the RSS is least and R\u00b2 value is the most among all the models. Hence we select model_TV as our base model to move forward.\n\nNow, we will add the radio and newspaper one by one and check the new values.","f8eb4ead":"Because this method finds the least sum of squares, it is also known as the **Ordinary Least Squares** (OLS) method.","0401a03f":"One of the fundamental questions that should be answered while running Multiple Linear Regression is, whether or not, at least one of the predictors is useful in predicting the output.\n\nWe saw that the three predictors TV, radio and newspaper had a different degree of linear relationship with the sales. But what if the relationship is just by chance and there is no actual impact on sales due to any of the predictors?\n\nThe model can only give us numbers to establish a close enough linear relationship between the response variable and the predictors. However, it cannot prove the credibility of these relationships.\n\nTo have some confidence, we take help from statistics and do something known as a Hypothesis Test. We start by forming a Null Hypothesis and a corresponding Alternative Hypothesis.","c5d2e825":"#### Statsmodels\nAnother way is to use the Statsmodels package to implement OLS. Statsmodels is a Python package that allows performing various statistical tests on the data. We will use it here because it will be helpful for us later as well.","51436f5f":"Single Predictor Models","2b6c4833":"## Multiple Linear Regression\nWe will see how multiple input variables together influence the output variable, while also learning how the calculations differ from that of Simple LR model. We will also build a regression model using Python.\nAt last, we will go deeper into Linear Regression and will learn things like Multicollinearity, Hypothesis Testing, Feature Selection, and much more.","ca84790b":"The hypothesis test is performed by using F-Statistic. The formula for this statistic contains Residual Sum of Squares (RSS) and the Total Sum of Squares (TSS), which we can calculate using the Statsmodels. ","e0e08245":"The correlation between newspaper and radio is 0.35. This indicates a fair relationship between newspaper and radio budgets. \n\nHence, it can be inferred that \u2192 when the radio budget is increased for a product, there\u2019s a tendency to spend more on newspapers as well.\n\nThis is called Multicollinearity and is referred to as a situation in which two or more input variables are linearly related.\nHence, even though the Multiple Regression model shows no impact on sales by the newspaper, the Simple Regression model still does due to this multicollinearity and the absence of other input variables.","bfc03f2f":"As we can see that our values have improved tremendously in TV & radio model. RSS has increased and R\u00b2 has decreased further, as compared to model_TV. It\u2019s a good sign. \n\nOn the other hand, it's not the same for TV and newspaper. The values have improved slightly by adding newspaper too, but not as significantly as with the radio. Hence, at this step, we will proceed with the TV & radio model and will observe the difference when we add newspaper to this model.","79f4e46e":"#### SciKit Learn: \nJust import the Linear Regression module from the Sklearn package and fit the model on the data. This method is pretty straightforward and you can see how to use it below.","40238dc5":"Finding the values of these constants(\u03b2) is what regression model does by minimizing the error function and fitting the best line or hyperplane (depending on the number of input variables).\nThis is done by minimizing the Residual Sum of Squares (RSS), which is obtained by squaring the differences between actual and predicted outcomes.\n\n\\begin{align}\nRSS=\u2211_i^n(y_i-y \u0302_i )^2 \n\\end{align}","532748f6":"If the value of F-statistic is equal to or very close to 1, then the results are in favor of the Null Hypothesis and we fail to reject it.\n\nBut as we can see that the F-statistic is many folds larger than 1, thus providing strong evidence against the Null Hypothesis (that all coefficients are zero). Hence, we **reject the Null Hypothesis** and are confident that at least one predictor is useful in predicting the output.\n\n*Note that F-statistic is not suitable when the number of predictors(p) is large, or if p is greater than the number of data samples (n).*","216bb185":"### Hypothesis Testing","2cdf6b8f":"$Sales & Radio \u2192 probable causation\nNewspaper & Radio \u2192 multicollinearity\nSales & Newspaper \u2192 transitive correlation$","56036c38":"Let's proceed with forward selection. We start with a model without any predictor and just the intercept term. We then perform simple linear regression for each predictor to find the best performer(lowest RSS). We then add another variable to it and check for the best 2-variable combination again by calculating the lowest RSS(Residual Sum of Squares). After that the best 3-variable combination is checked, and so on. The approach is stopped when some stopping rule is satisfied.","3a039eaa":"Let's plot and observe the correlations among the variables ","d5777ab3":"There are two primary ways to implement the OLS algorithm: **Scikit Learn** and **Statsmodels**","9f9da8b4":"If sales is regressed solely on newspaper (as shown below), the slope coefficient will come out to be 0.055, which is significanly large as compared to what we saw above. ","42e7badb":"#### This is explained by **Multicollinearity**","287b0912":"----"}}