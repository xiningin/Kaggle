{"cell_type":{"a16440b5":"code","163f0d20":"code","d0f0544c":"code","898ba6f4":"code","0bc62818":"code","2d043827":"code","376101d7":"code","f0df7304":"code","bc5da31e":"code","e769223d":"code","e5812eb6":"code","3bcdc152":"code","f0ac5cc6":"markdown","1f48f4b5":"markdown"},"source":{"a16440b5":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","163f0d20":"import h2o\nfrom h2o.automl import H2OAutoML\n\nh2o.init(max_mem_size='4G')","d0f0544c":"%%time\ntrain = h2o.import_file(\"..\/input\/train.csv\")\ntest = h2o.import_file(\"..\/input\/test.csv\")","898ba6f4":"train.describe()","0bc62818":"x = train.columns\ny = \"Survived\"","2d043827":"# For binary classification, response should be a factor\ntrain[y] = train[y].asfactor()\nx.remove(y)","376101d7":"%%time\n# Run AutoML for 10 base models (limited to 1 hour max runtime by default)\naml = H2OAutoML(max_models=10, seed=42, max_runtime_secs=7200)\naml.train(x=x, y=y, training_frame=train)","f0df7304":"lb = aml.leaderboard\nlb.head(rows=lb.nrows)  # Print all rows instead of default (10 rows)","bc5da31e":"aml.leader # Best model","e769223d":"# If you need to generate predictions on a test set, you can make\n# predictions directly on the `\"H2OAutoML\"` object, or on the leader\n# model object directly\n\npreds = aml.predict(test)","e5812eb6":"predictions = preds[0].as_data_frame().values.flatten()","3bcdc152":"sample_submission = pd.read_csv('..\/input\/gender_submission.csv')\nsample_submission['Survived'] = predictions\nsample_submission.to_csv('h2O_titanic_1.csv', index=False)","f0ac5cc6":"### References::  \n* Bojan Tunguz's https:\/\/www.kaggle.com\/tunguz\/elo-with-h2o-automl \n* The H2O AutoML tutorial (https:\/\/github.com\/h2oai\/h2o-tutorials\/blob\/master\/h2o-world-2017\/automl\/Python\/automl_binary_classification_product_backorders.ipynb)","1f48f4b5":"### So the best model gets an AUC of 0.876 (and this is without any parameter tuning)"}}