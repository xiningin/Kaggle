{"cell_type":{"efe38947":"code","cc478f0a":"code","e1f43e7e":"code","9031f324":"code","ea4bf05f":"code","63b26b5f":"code","e35fd621":"code","4bbe437a":"code","ec90cb60":"code","6fd4c6e9":"code","9f2dce70":"code","ab5964d8":"code","862fcc69":"code","3aabdde8":"code","0ecdce45":"code","af7c02a4":"code","54e2f87e":"code","ce54f02e":"code","dbd45098":"code","268c11dc":"code","a91df87a":"code","54d4275f":"code","3713133b":"code","b99f2769":"code","e5673745":"code","f8408c15":"code","647dd587":"code","6d5797d7":"code","fa0ce41b":"code","cd71dee7":"code","6539af64":"code","0bd1a0b3":"code","e066a046":"code","e193b5e5":"code","5498328e":"code","a7939929":"code","a709c3c0":"code","be42fcb6":"markdown","31b90cb4":"markdown","fa632969":"markdown","e06c7906":"markdown","ddfbdf31":"markdown","ebe393d5":"markdown","60ec5f4b":"markdown","b4f3265f":"markdown","161536aa":"markdown","da5e8680":"markdown","aabcb4ea":"markdown","6574c78c":"markdown","4d527d7e":"markdown","c7447dbc":"markdown","ca204e44":"markdown","2d737cd0":"markdown","0b4ed0f4":"markdown","6e853093":"markdown","6b76fcff":"markdown","a6aae86d":"markdown","721f0981":"markdown","453ccf1b":"markdown","dce2cb03":"markdown"},"source":{"efe38947":"import pandas as pd","cc478f0a":"data = pd.read_csv(\"..\/input\/insurance\/insurance.csv\")","e1f43e7e":"data.head()","9031f324":"data.shape","ea4bf05f":"data.info()","63b26b5f":"data.isnull()","e35fd621":"data.isnull().sum()","4bbe437a":"data.dtypes","ec90cb60":"data[\"sex\"] = data[\"sex\"].astype(\"category\")\ndata[\"smoker\"] = data[\"smoker\"].astype(\"category\")\ndata[\"region\"] = data[\"region\"].astype(\"category\")","6fd4c6e9":"data.dtypes","9f2dce70":"data.describe().T","ab5964d8":"smoke_data = data.groupby(\"smoker\").mean().round(2)","862fcc69":"smoke_data","3aabdde8":"import seaborn as sns","0ecdce45":"sns.set_style(\"whitegrid\")","af7c02a4":"sns.pairplot(data[[\"age\", \"bmi\", \"charges\", \"smoker\"]],\n            hue = \"smoker\",\n            height = 3,\n            palette=\"Set1\")","54e2f87e":"sns.heatmap(data.corr(), annot = True)","ce54f02e":"data.columns","dbd45098":"data = pd.get_dummies(data)","268c11dc":"data.columns","a91df87a":"y = data[\"charges\"]","54d4275f":"X = data.drop(\"charges\", axis = 1)","3713133b":"from sklearn.model_selection import train_test_split","b99f2769":"X_train, X_test, y_train, y_test = train_test_split(X, y, train_size= 0.80, random_state=1)","e5673745":"from sklearn.linear_model import LinearRegression","f8408c15":"lr = LinearRegression()","647dd587":"lr.fit(X_train, y_train)","6d5797d7":"lr.score(X_test, y_test).round(3)","fa0ce41b":"lr.score(X_train, y_train).round(3)","cd71dee7":"y_pred = lr.predict(X_test)","6539af64":"from sklearn.metrics import mean_squared_error","0bd1a0b3":"import math","e066a046":"math.sqrt(mean_squared_error(y_test, y_pred))","e193b5e5":"data_new = X_train[:1]","5498328e":"data_new","a7939929":"lr.predict(data_new)","a709c3c0":"y_train[:1]","be42fcb6":"# <span style=\"color:OrangeRed\">Insurance Price Prediction with Linear Regression<\/span>","31b90cb4":"## Let's convert them to category type to use the model building later.","fa632969":"## Now let's take a look at another metric, mean squared error, to evaluate the model.","e06c7906":"# <span style=\"color:OrangeRed\">Preprocessing The Data<\/span>","ddfbdf31":"## Let's take a look at summary statistics.","ebe393d5":"# <span style=\"color:OrangeRed\">Evaluating The Model<\/span>","60ec5f4b":"![](https:\/\/cdn.pixabay.com\/photo\/2013\/07\/18\/10\/59\/pulse-trace-163708_960_720.jpg)","b4f3265f":"# <span style=\"color:OrangeRed\">Understanding The Data<\/span>","161536aa":"# <span style=\"color:OrangeRed\">Splitting The Dataset<\/span>","da5e8680":"## Please don't forget to subscribe to [my youtube channel](https:\/\/www.youtube.com\/channel\/UCFU9Go20p01kC64w-tmFORw) where I create content about ai, data science, machine learning, and deep learning.","aabcb4ea":"## As you can see, our model predicted close to the true value. Machine learning is an ocean. I love machine learning.","6574c78c":"# <span style=\"color:OrangeRed\">One-Hot Encoding<\/span>","4d527d7e":"# <span style=\"color:OrangeRed\">Creating Input and Output Variables<\/span>","c7447dbc":"## I'm going to predict the first row as an example.","ca204e44":"## Some categorical variables have subcategories such as sex and smoker. We need to convert these categorical variables into a form that the scikit-learn library can understand.","2d737cd0":"### In this notebook, I'm going to show how to make insurance price prediction with Linear Regression. After doing the project, we'll enter the patient's information such as age, sex, region into the model and then predict the patient's charge.","0b4ed0f4":"# <span style=\"color:OrangeRed\">Loading The\u00a0Data<\/span>","6e853093":"# <span style=\"color:OrangeRed\">Dealing with Missing Data<\/span>","6b76fcff":"# <span style=\"color:OrangeRed\">Building The Model<\/span>","a6aae86d":"# <span style=\"color:OrangeRed\">Preprocessing The Data<\/span>","721f0981":"# <span style=\"color:OrangeRed\">Next Step<\/span>","453ccf1b":"# <span style=\"color:OrangeRed\">Predicting a New Data<\/span>","dce2cb03":"## So let's see the real value."}}