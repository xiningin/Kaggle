{"cell_type":{"dda28b93":"code","6f202bc8":"code","34a2bea5":"code","6a5deeb3":"code","d9a92f64":"code","d389bda0":"code","419e6c7c":"code","3402b884":"code","13aacdaf":"code","ba72b6ac":"code","b45ff9c3":"code","e04d8622":"code","90661dd2":"code","e2803370":"code","8cab4837":"code","6ca8abf3":"code","7ece6481":"code","5bb0f86f":"code","788f0c23":"code","946eef24":"code","a2683dd8":"code","7560e69c":"code","3240a338":"code","2b5e2659":"code","9214e229":"code","c765afdd":"code","8e1bc133":"code","7965d153":"code","92ee59ae":"code","d8943a5e":"code","8d279f2c":"code","f6f7a460":"code","bea89b0d":"code","48b0a94e":"code","c0bfea88":"code","5798442c":"code","ff4b6bd3":"code","a30206b2":"code","7c68eada":"code","fde93b45":"code","ed5983df":"code","0b1f196c":"code","112316cc":"code","5d124965":"code","8775bc59":"code","a069996e":"code","723e1309":"code","2cd8e192":"code","ef4964af":"code","b59814e1":"code","c7c1ca41":"code","35025770":"code","c8315a69":"code","19f98d19":"code","c8637bb3":"code","aaac3442":"code","5985c5ac":"code","bb6a1db1":"code","885e4df0":"code","a54687b3":"code","00efecb4":"code","5f3a90d2":"code","85ebdb84":"code","46ed0f10":"code","ed37a5af":"code","0e41d50d":"code","a11efe66":"code","085c43b4":"code","b649a6ae":"code","050d1790":"code","0fe7fcc4":"code","dbc3964c":"code","a8b0551d":"code","64198f30":"code","3979e44d":"code","afa36a9f":"code","a4cd5ffe":"code","b5cab2d0":"code","540b7cb8":"code","8403c6c4":"code","b49a5586":"markdown","3bcf87e6":"markdown","04713a9b":"markdown","1e453b47":"markdown","b6a6b7ca":"markdown","e4fff338":"markdown","04b799da":"markdown","8af00801":"markdown","a177b193":"markdown","ad2587ea":"markdown","9804d1b2":"markdown","a4005f84":"markdown","d348cb3c":"markdown","d6a1dbce":"markdown","fc572339":"markdown","fcb5adf8":"markdown","627576eb":"markdown","02e07201":"markdown","17d79089":"markdown","f0771db8":"markdown","09837198":"markdown","91e7f6c9":"markdown","e122d447":"markdown","520de2b0":"markdown","a62806cc":"markdown","5fce2b31":"markdown"},"source":{"dda28b93":"import pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\n\nimport plotly.express as px\nimport plotly.graph_objects as go\n\nfrom plotly.subplots import make_subplots\n\n#Showing full path of datasets\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n        \n# Disable warnings \nimport warnings\nwarnings.filterwarnings('ignore')","6f202bc8":"breast=pd.read_csv(\"\/kaggle\/input\/breast-cancer-wisconsin-data\/data.csv\")","34a2bea5":"breast.head()","6a5deeb3":"breast.info()","d9a92f64":"breast.drop(columns=[\"id\",\"Unnamed: 32\"],axis=1,inplace=True)","d389bda0":"breast.columns","419e6c7c":"breast.describe()","3402b884":"breast.isna().sum()","13aacdaf":"breast.skew(axis=0)","ba72b6ac":"breast['diagnosis'].value_counts()","b45ff9c3":"sns.countplot(x=\"diagnosis\",data=breast)","e04d8622":"diagnosis = breast['diagnosis']\nbreast_mean = breast.iloc[:,0:11]\nbreast_se = pd.concat([breast.iloc[:,11:21],diagnosis],axis=1)\nbreast_worst = pd.concat([breast.iloc[:,21:31],diagnosis],axis=1)\n\ndisplay(breast_mean)\ndisplay(breast_se)\ndisplay(breast_worst)\n","90661dd2":"import plotly.graph_objects as go\nfig = make_subplots(rows=5,cols=2,subplot_titles=(\"Area_mean\",'Texture_mean',\n                                                 \"radius_mean\",\"compactness_mean\",\n                                                 \"perimeter_mean\",\"concavity_mean\",\n                                                 \"concave points_mean\",\"symmetry_mean\",\n                                                 \"fractal_dimension_mean\",\"smoothness_mean\"))\nfig.add_trace(go.Box(x=breast_mean['diagnosis'],y=breast_mean['area_mean'],name='area_mean'),row=1,col=1)\nfig.add_trace(go.Box(x=breast_mean['diagnosis'],y=breast_mean['texture_mean'],name='texture_mean'),row=1,col=2)\nfig.add_trace(go.Box(x=breast_mean['diagnosis'],y=breast_mean['radius_mean'],name='radius_mean'),row=2,col=1)\nfig.add_trace(go.Box(x=breast_mean['diagnosis'],y=breast_mean['compactness_mean'],name='compactness_mean'),row=2,col=2)\nfig.add_trace(go.Box(x=breast_mean['diagnosis'],y=breast_mean['perimeter_mean'],name='perimeter_mean'),row=3,col=1)\nfig.add_trace(go.Box(x=breast_mean['diagnosis'],y=breast_mean['concavity_mean'],name='concavity_mean'),row=3,col=2)\nfig.add_trace(go.Box(x=breast_mean['diagnosis'],y=breast_mean['concave points_mean'],name='concave points_mean'),row=4,col=1)\nfig.add_trace(go.Box(x=breast_mean['diagnosis'],y=breast_mean['symmetry_mean'],name='symmetry_mean'),row=4,col=2)\nfig.add_trace(go.Box(x=breast_mean['diagnosis'],y=breast_mean['fractal_dimension_mean'],name='fractal_dimension_mean'),row=5,col=1)\nfig.add_trace(go.Box(x=breast_mean['diagnosis'],y=breast_mean['smoothness_mean'],name='smoothness_mean'),row=5,col=2)\n\n# Update title and height\nfig.update_layout(title_text=\"Breast mean Visualizations\", height=1500,width=1000)","e2803370":"for col in breast_mean.columns:\n    if col != 'diagnosis':\n        print(col+' vs diagnosis')\n        fig = px.box(breast_mean,x='diagnosis',y=col,color='diagnosis',width=500,height=500)\n        fig.show()","8cab4837":"for col in breast_se.columns:\n    if col != 'diagnosis':\n        print(col+' vs diagnosis')\n        fig = px.box(breast_se,x='diagnosis',y=col,color='diagnosis',width=500,height=500)\n        fig.show()\n        ","6ca8abf3":"for col in breast_worst.columns:\n    if col != 'diagnosis':\n        print(col+' vs diagnosis')\n        fig = px.box(breast_worst,x='diagnosis',y=col,color='diagnosis',width=500,height=500)\n        fig.show()","7ece6481":"breast.isna().sum()","5bb0f86f":"plt.figure(figsize=(15,10))\nsns.heatmap(breast_mean.corr(),annot=True,vmin=0,vmax=1,cmap=\"YlGnBu\")\n","788f0c23":"plt.figure(figsize=(15,10))\nsns.heatmap(breast_se.corr(),annot=True,vmin=0,vmax=1,cmap=\"YlGnBu\")\n","946eef24":"plt.figure(figsize=(15,10))\n\nsns.heatmap(breast_worst.corr(),annot=True,vmin=0,vmax=1,cmap=\"YlGnBu\")","a2683dd8":"sns.jointplot(x='radius_mean',y='perimeter_mean',data=breast_mean,kind='reg')","7560e69c":"sns.jointplot(x='area_mean',y='radius_mean',data=breast_mean,kind='reg')","3240a338":"sns.jointplot(x='area_mean',y='perimeter_mean',data=breast_mean,kind='reg')","2b5e2659":"sns.jointplot(x='concavity_mean',y='concave points_mean',data=breast_mean,kind='reg')","9214e229":"sns.jointplot(x='fractal_dimension_mean',y='area_mean',data=breast_mean,kind='reg')","c765afdd":"y=breast.diagnosis\nx=breast.drop(columns=\"diagnosis\",axis=1)\nx.head()","8e1bc133":"##Standardize data\nbreast_dia=y\nbreast_x=x\nbreast_2=(breast_x-breast_x.mean())\/breast_x.std()\nbreast_x=pd.concat([y,breast_2.iloc[:,0:10]],axis=1)\nbreast_x=pd.melt(breast_x,id_vars='diagnosis',\n                      var_name='features',\n                      value_name='value')\nplt.figure(figsize=(12,10))\nsns.violinplot(x='features',y='value',hue='diagnosis',split=True,data=breast_x)\nplt.xticks(rotation=90)\n\n","7965d153":"##next 10 features\nbreast_x=pd.concat([y,breast_2.iloc[:,10:20]],axis=1)\nbreast_x=pd.melt(breast_x,id_vars='diagnosis',var_name='features',value_name='value')\n\nplt.figure(figsize=(12,10))\nsns.violinplot(x='features',y='value',hue='diagnosis',data=breast_x,split=True)\nplt.xticks(rotation=90)","92ee59ae":"##next 10 features\nbreast_x=pd.concat([y,breast_2.iloc[:,20:31]],axis=1)\nbreast_x=pd.melt(breast_x,id_vars='diagnosis',var_name='features',value_name='value')\nplt.figure(figsize=(12,10))\nsns.violinplot(x='features',y='value',hue='diagnosis',data=breast_x,split=True)\nplt.xticks(rotation=90)\n","d8943a5e":"##pairplot for 5 features at a time","8d279f2c":"temp=pd.concat([y,x.iloc[:,0:5]],axis=1)\ntemp.shape\nsns.pairplot(data=temp,hue=\"diagnosis\")\nplt.figure(figsize=(12,10))","f6f7a460":"temp=pd.concat([y,x.iloc[:,5:10]],axis=1)\ntemp.shape\nsns.pairplot(data=temp,hue=\"diagnosis\")\nplt.figure(figsize=(12,10))","bea89b0d":"x","48b0a94e":"y","c0bfea88":"breast_swarm_dia=y\nbreast_x=x\nbreast_s_2=(breast_x-breast_x.mean())\/(breast_x.std())\nbreast_x=pd.concat([y,breast_s_2.iloc[:,0:10]],axis=1)\nbreast_x=pd.melt(breast_x,id_vars=\"diagnosis\",\n    var_name=\"features\",\n    value_name=\"value\")\nbreast_x","5798442c":"plt.figure(figsize=(12,10))\nsns.swarmplot(x=\"features\",y=\"value\",hue=\"diagnosis\",data=breast_x)\nplt.xticks(rotation=90)\n","ff4b6bd3":"breast=pd.concat([y,breast_s_2.iloc[:,10:21]],axis=1)\nbreast=pd.melt(breast,id_vars=\"diagnosis\",\n    var_name=\"features\",\n    value_name=\"value\")\nplt.figure(figsize=(12,10))\nsns.swarmplot(x=\"features\",y=\"value\",hue=\"diagnosis\",data=breast_x)\nplt.xticks(rotation=90)","a30206b2":"breast=pd.concat([y,breast_s_2.iloc[:,21:30]],axis=1)\nbreast=pd.melt(breast,id_vars=\"diagnosis\",\n    var_name=\"features\",\n    value_name=\"value\")\nplt.figure(figsize=(12,10))\nsns.swarmplot(x=\"features\",y=\"value\",hue=\"diagnosis\",data=breast_x)\nplt.xticks(rotation=90)","7c68eada":"##pairplot\nplt.figure(figsize=(18,18))\nsns.heatmap(x.corr(),annot=True,linewidths=.5,fmt='.1f')","fde93b45":"##Feature selection\n\nFeatures=['smoothness_mean', 'compactness_mean', 'concavity_mean','symmetry_mean', 'fractal_dimension_mean', 'texture_se','smoothness_se',\n       'compactness_se', 'concavity_se', 'concave points_se', 'symmetry_se',\n       'fractal_dimension_se','texture_worst',\n       'perimeter_worst','smoothness_worst',\n       'compactness_worst','symmetry_worst', 'fractal_dimension_worst']\n\nselected_features=x.drop(columns=Features,axis=1)\nselected_features=selected_features.drop(columns=\"texture_mean\",axis=1)\nselected_features","ed5983df":"y","0b1f196c":"from sklearn.model_selection import train_test_split\nX_train,X_test,y_train,y_test=train_test_split(selected_features,y,test_size=0.3,random_state=10)","112316cc":"X_train.shape","5d124965":"X_test.shape\n","8775bc59":"selected_features.describe()","a069996e":"##As we see in describe values are not proper we need to standardize","723e1309":"from sklearn.preprocessing import StandardScaler\nscaler=StandardScaler()\nX_train2=scaler.fit_transform(X_train)\nX_test2=scaler.transform(X_test)\n","2cd8e192":"X_train2.shape\n","ef4964af":"#but\n\nX_train2","b59814e1":"##As features are not independent ,its not proper to use naive bayes\n##So we'kll just see to our practice","c7c1ca41":"from sklearn.naive_bayes import GaussianNB\ngnb=GaussianNB()\ngnb.fit(X_train2,y_train)\ny_pred2=gnb.predict(X_test2)","35025770":"from sklearn.metrics import accuracy_score,confusion_matrix\n","c8315a69":"print(\"Accuracy using accuracy_score is {}\".format(accuracy_score(y_test,y_pred2)))","19f98d19":"cm=confusion_matrix(y_test,y_pred2)\n","c8637bb3":"print(\"COnfusion matrix score is \\n{}\".format(cm))","aaac3442":"sns.heatmap(cm,annot=True,\n    fmt='d')","5985c5ac":"#This wont work as y is text classification\n#from sklearn.metrics import f1_score\n#print(\"Accuracy f1score is {}\".format(f1_score(y_test,y_pred)))","bb6a1db1":"x","885e4df0":"y","a54687b3":"from sklearn.model_selection import train_test_split\nX_train1,X_test1,y_train1,y_test1=train_test_split(x,y,test_size=0.3,random_state=10)\n","00efecb4":"from sklearn.preprocessing import StandardScaler\nscaler1=StandardScaler()\nX_train1=scaler1.fit_transform(X_train1)\nX_test1=scaler1.transform(X_test1)\n","5f3a90d2":"from sklearn.naive_bayes import GaussianNB\ngnb1=GaussianNB()\ngnb1.fit(X_train1,y_train1)\ny_pred1=gnb1.predict(X_test1)","85ebdb84":"from sklearn.metrics import accuracy_score,confusion_matrix\nprint(\"Accuracy using accuracy_score is {}\".format(accuracy_score(y_test,y_pred1)))\n","46ed0f10":"from sklearn.feature_selection import SelectKBest,chi2\nselectbest10=SelectKBest(chi2,k=10)\nX_best_10=selectbest10.fit(X_train,y_train)\n","ed37a5af":"X_best_10","0e41d50d":"X_train","a11efe66":"print(\"Scores :\",X_best_10.scores_)\nprint(\"Features:\",X_train.columns)","085c43b4":"from sklearn.feature_selection import SelectKBest,chi2\nselectbest5=SelectKBest(chi2,5)\nX_best_5=selectbest5.fit(x,y)\nprint(\"Scores:\",X_best_5.scores_)\nprint(\"Features:\",x.columns)","b649a6ae":"#x5=[\"area_mean\",\"area_se\",\"texture_mean\",\"concavity_worst\",\"compactness_mean\"]\nfeaturesfor5=['radius_mean','perimeter_mean',\n       'smoothness_mean', 'concavity_mean',\n       'concave points_mean', 'symmetry_mean', 'fractal_dimension_mean',\n       'radius_se', 'texture_se', 'perimeter_se', 'smoothness_se',\n       'compactness_se', 'concavity_se', 'concave points_se', 'symmetry_se',\n       'fractal_dimension_se', 'radius_worst', 'texture_worst',\n       'perimeter_worst', 'area_worst', 'smoothness_worst',\n       'compactness_worst', 'concave points_worst',\n       'symmetry_worst', 'fractal_dimension_worst']\n","050d1790":"selected_for5=x.drop(columns=featuresfor5,axis=1)\nselected_for5","0fe7fcc4":"x.columns","dbc3964c":"y","a8b0551d":"from sklearn.model_selection import train_test_split\nX_train5,X_test5,y_train5,y_test5=train_test_split(selected_for5,y,test_size=0.3,random_state=10)\n\n\n \n","64198f30":"from sklearn.preprocessing import StandardScaler\nscaler5=StandardScaler()\nX_train5=scaler5.fit_transform(X_train5)\nX_test5=scaler5.transform(X_test5)","3979e44d":"from sklearn.naive_bayes import GaussianNB\ngnb5=GaussianNB()\ngnb5.fit(X_train5,y_train5)\ny_pred5=gnb5.predict(X_test5)","afa36a9f":"from sklearn.metrics import accuracy_score\nprint(\"Accuracy using 5 selected features is {}\".format(accuracy_score(y_test5,y_pred5)))","a4cd5ffe":"X_train","b5cab2d0":"y_train","540b7cb8":"from sklearn.ensemble import RandomForestClassifier\nrfclf1=RandomForestClassifier()\nrfclf1.fit(X_train,y_train)\ny_predrfc=rfclf1.predict(X_test)\n","8403c6c4":"from sklearn.metrics import accuracy_score\nprint(\"Accuracy using rfclassifier is {}\".format(accuracy_score(y_test,y_predrfc)))","b49a5586":"**Let's have a look at the diagnosis feature**","3bcf87e6":"#### We can have a better look at these features with the help of jointplot","04713a9b":"##As we see there are no changes in the score\n##therfore the features that contribute to the target value should be used\n##We'll have to use better features","1e453b47":"**We'll separate the 30 features into 10 each i.e mean radius, se radius and worst radius and analyze each one separately**","b6a6b7ca":"perimeter_worst --- radius_worst\n\narea_worst --- radius_worst\n\narea_worst --- perimeter_worst\n\n","e4fff338":"Features are computed from a digitized image of a fine needle aspirate (FNA) of a breast mass. They describe characteristics of the cell nuclei present in the image.\nn the 3-dimensional space is that described in: [K. P. Bennett and O. L. Mangasarian: \"Robust Linear Programming Discrimination of Two Linearly Inseparable Sets\", Optimization Methods and Software 1, 1992, 23-34].\n\nThis database is also available through the UW CS ftp server:\nftp ftp.cs.wisc.edu\ncd math-prog\/cpo-dataset\/machine-learn\/WDBC\/\n\nAlso can be found on UCI Machine Learning Repository: https:\/\/archive.ics.uci.edu\/ml\/datasets\/Breast+Cancer+Wisconsin+%28Diagnostic%29\n\n\n**Attribute Information:**\n\n1) ID number\n\n2) Diagnosis (M = malignant, B = benign)\n\n\n**Ten real-valued features are computed for each cell nucleus:**\n\na) radius (mean of distances from center to points on the perimeter)\n\nb) texture (standard deviation of gray-scale values)\n\nc) perimeter\n\nd) area\n\ne) smoothness (local variation in radius lengths)\n\nf) compactness (perimeter^2 \/ area - 1.0)\n\ng) concavity (severity of concave portions of the contour)\n\nh) concave points (number of concave portions of the contour)\n\ni) symmetry\n\nj) fractal dimension (\"coastline approximation\" - 1)\n\nThe mean, standard error and \"worst\" or largest (mean of the three\nlargest values) of these features were computed for each image,\nresulting in 30 features. For instance, field 3 is Mean Radius, field\n13 is Radius SE, field 23 is Worst Radius.\n\nAll feature values are recoded with four significant digits.\n\nMissing attribute values: none\n\n**Class distribution: 357 benign, 212 malignant**","04b799da":"perimeter_mean --- radius_mean\n\narea_mean --- radius_mean\n\narea_mean --- perimeter_mean\n\nconcavity_mean --- concave points_mean\n","8af00801":"**Dataset info**","a177b193":"##Here we see 10 features we already have we cant find any difference\n##Now we'll choose only 5 features","ad2587ea":"Checking missing values","9804d1b2":"As we can see there are no missing values","a4005f84":"## Random Forest Classifier","d348cb3c":"## Breast Cancer Prediction","d6a1dbce":"                    ##We'll use selected_features for our model and see score","fc572339":"### Correlation\n\nHeatmap tells us about the correlation of two variables.The higher the value , more the features are correlated.","fcb5adf8":"### Import Libraries","627576eb":"perimeter_se --- radius_se\n\narea_se --- radius_se\n\narea_se --- perimeter_se","02e07201":"# Naive Bayes","17d79089":"**Breast squared error**","f0771db8":"No null values","09837198":"**Breast worst**","91e7f6c9":"##USING RANDOM FOREST WE GET GOOD SCORE","e122d447":"### Univariate Analysis","520de2b0":"As most of the features are skewed , we can have a further look at the visualization for more information","a62806cc":"**Breast mean**","5fce2b31":"# We'll choose best features ......"}}