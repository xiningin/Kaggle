{"cell_type":{"f3f8d7f2":"code","9ebe363e":"code","4d1438a7":"code","ec715746":"code","6f876015":"code","00d0c4b0":"code","3d9ee8df":"code","9a1bcc49":"code","a6ef6e80":"code","433cb543":"code","14488c45":"code","04f43436":"code","40ffe0f0":"markdown","751281fc":"markdown","e6c810fc":"markdown","20b45fc0":"markdown","f1114584":"markdown","eb4be9f7":"markdown","63c71fef":"markdown","6caf51c9":"markdown","958a4fb8":"markdown","dbe254c1":"markdown","44199e70":"markdown","d4ccb77e":"markdown","7980b68e":"markdown","470c0f02":"markdown","74cee6c9":"markdown","1dd9000a":"markdown","8479e63a":"markdown"},"source":{"f3f8d7f2":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.metrics import r2_score\nimport statsmodels.api as sm","9ebe363e":"data = pd.read_csv(\n    \"https:\/\/raw.githubusercontent.com\/saidRaiss\/dataset\/master\/advertising_ads\"\n  )","4d1438a7":"data.info()","ec715746":"data.head() # Display first five values (default)\n# Or use the sample(n) method to display n random values.","6f876015":"data.drop(['Unnamed: 0'], axis=1, inplace=True)\n# axis=1 it indicates that it is a column (axis=0 for index).\n# inplace=True it indicates that the modification made to the data variable.","00d0c4b0":"data.sample(5)","3d9ee8df":"correlation = data.corr()\n# correlation plot\nsns.heatmap(correlation, annot= True);","9a1bcc49":"# We use matplotlib, a popular Python plotting library, to create points.\nplt.figure(figsize=(12, 6))\nplt.scatter(\n    data['TV'],\n    data['sales'],\n    c='red'\n)\nplt.xlabel(\"Money spent on TV ads ($)\")\nplt.ylabel(\"Sales (k$)\")\nplt.show()","a6ef6e80":"# Input\nX = data['TV'].values.reshape(-1, 1)\n# Output\nY = data['sales'].values.reshape(-1, 1)\n# Create a linear regression model\nreg = LinearRegression()\n# \"fit\" a data to train\nreg.fit(X, Y)\nprint(\n    \"The linear model is: Y={:.5} + {:.5}X\"\n    .format(reg.intercept_[0], reg.coef_[0][0])\n    )","433cb543":"predictions = reg.predict(X)\nplt.figure(figsize=(12, 6))\nplt.scatter(\n    data['TV'],\n    data['sales'],\n    c='red'\n)\nplt.plot(\n    data['TV'],\n    predictions,\n    c='blue',\n    linewidth = 2\n)\nplt.xlabel(\"Money spent on TV ads ($)\")\nplt.ylabel(\"Sales (k$)\")\nplt.show()","14488c45":"Xm = data.drop(['sales'], axis=1)\nY = data['sales'].values.reshape(-1, 1)\nreg = LinearRegression()\nreg.fit(Xm, Y)\nprint(\n    \"The linear model is: Y={:.5} + {:.5}*TV + {:.5}*radio + {:.5}*newspaper\"\n    .format(\n        reg.intercept_[0], reg.coef_[0][0], reg.coef_[0][1], reg.coef_[0][2]\n        )\n    )","04f43436":"X = np.column_stack((data['TV'], data['radio'], data['newspaper']))\nY = data['sales']\nX2 = sm.add_constant(X)\nest = sm.OLS(Y, X2)\nest2 = est.fit()\nprint(est2.summary())","40ffe0f0":"Note that the coefficient for the newspaper is negative, but also quite small. Is this enough for our model? Let's see by calculating the F-statistic, the R\u00b2 value and p-value for each coefficient.\n\n","751281fc":"### Correlation between variables\nThe statistical relationship between two variables is called their correlation. A correlation can be positive (<= 1), which means that the two variables move in the same direction, or negative (> = - 1), which means that when the value of one variable increases, the values \u200b\u200bof the others variables decrease (regression). If the correlation between two variables close to 0 then they are not correlated.","e6c810fc":"So in this case Sales(k$) = 7.03 + 0.04 * TV. Now let's see how the row matches the data.","20b45fc0":"### Evaluate the accuracy of the model\nTo see if the model is good, we need to look at the F-static value, the R\u00b2 value, and the p-value of each coefficient.","f1114584":"### Loading dataset\nI have placed the data in a github directory in csv format. Then access will be via the https protocol.","eb4be9f7":"As we can see, the R\u00b2 is quite close to 1, with a value of 0.897! Next, the value of F-static is 570.3 is far greater than 1, although our data set is quite small (only 200 data points), it shows that there is a strong relationship between ad spend and sales. Finally, since we only have three predictors, we can consider their p-values to determine whether they are relevant to the model or not. Of course, we notice that the third coefficient (that of the newspaper) has a large p-value. Therefore, newspaper ad spending is **not statistically significant**. **Removing this predictor would slightly reduce the R\u00b2 value, but we could make better predictions.**","63c71fef":"## Introduction\nWe will be work on both single and multiple linear regression using the Scikit-Learn library and we will show how to assess the quality of the parameters and the overall model in both situations.\n### Dataset description\nThe dataset contains information about the money spent on television, radio and newspaper advertising, as well as the sales generated.\n### Goal\nThe goal is to use linear regression to understand the impact of ad spend on sales.","6caf51c9":"## Simple linear regression\nFor a simple linear regression, consider only the effect of TV ads on sales. Let's see what the data looks like before we jump straight to modeling.","958a4fb8":"As you can see the **sales** output has a higher correlation with the **TV** variable than the **radio** variable and a non-correlation with the **newspaper** variable. Ultimately newspaper advertising does not matter much than TV or radio advertising, which should be shown in the following steps.","dbe254c1":"To discover the dataset for the first time, the **info()** method is useful for getting an overview: number of data, number of columns, column names and column data types.","44199e70":"Now let's show some dataset values","d4ccb77e":"From the graph above, it seems that a simple linear regression can explain the relationship between the amount spent on TV and sales.","7980b68e":"As you can see, the **Unnamed: 0** column is redundant. Therefore, we are removing it.","470c0f02":"## Multiple linear regression\nLike a simple linear regression, we will define the matrix of input variables (TV, radio, newspaper)  and the target variable (sales) and use the scikit-learn library to perform linear regression .","74cee6c9":"As you can see, there is a clear relationship between the amount spent on **TV** and **sales**. Let's see how we can generate a **linear approximation** of this data.","1dd9000a":"### Visualization","8479e63a":"### Libraries we use!\n"}}