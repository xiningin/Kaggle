{"cell_type":{"87df8cc4":"code","2ba4918c":"code","78ce4bed":"code","cdac809f":"code","ebe5679c":"code","4bf1efab":"code","6ebe69fb":"code","11b1bdfc":"code","7b85eaa3":"code","a5834aac":"code","d7b456c7":"code","8ab31877":"code","4a373088":"code","657a9b5d":"code","efaeb73f":"code","d3282548":"code","ec32b191":"code","9b2030c5":"code","5e06ecc6":"code","43e442ad":"code","4edfb058":"code","8dd845b5":"code","3498a3c3":"code","00eed689":"code","14535ae6":"code","35861b2f":"markdown","24e27a1e":"markdown","c43eb4ba":"markdown"},"source":{"87df8cc4":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","2ba4918c":"%reload_ext autoreload\n%autoreload 2\n%matplotlib inline","78ce4bed":"from fastai import *\nfrom fastai.vision import *","cdac809f":"import numpy as np\nimport pandas as pd","ebe5679c":"path = Path('..\/input\/devanagari')\npath.ls()","4bf1efab":"fnames = get_image_files(path\/'test\/23')\nfnames[:5]","6ebe69fb":"open_image(path\/'test\/23\/31991.png').shape","11b1bdfc":"tfms = get_transforms(do_flip=False)\ndata = ImageDataBunch.from_folder(path, ds_tfms=tfms, train='train', valid='test', size=32, bs=32).normalize(imagenet_stats)","7b85eaa3":"print(data.classes)\nprint(len(data.classes))\nprint(data.c)","a5834aac":"learn = cnn_learner(data, models.resnet50, metrics=accuracy, model_dir=\"\/tmp\/model\/\")\nlearn.fit_one_cycle(4)","d7b456c7":"data.show_batch(3, figsize=(5,5))","8ab31877":"learn.save('stage-1')","4a373088":"interp = ClassificationInterpretation.from_learner(learn)\n\nlosses,idxs = interp.top_losses()\n\nlen(data.valid_ds)==len(losses)==len(idxs)","657a9b5d":"interp.plot_top_losses(9, figsize=(10,10))","efaeb73f":"interp.plot_confusion_matrix(figsize=(12,12), dpi=60)","d3282548":"interp.most_confused(min_val=2)","ec32b191":"learn.unfreeze()","9b2030c5":"learn.fit_one_cycle(3)","5e06ecc6":"learn.load('stage-1');\nlearn.lr_find()","43e442ad":"learn.recorder.plot()","4edfb058":"learn.unfreeze()\nlearn.fit_one_cycle(8, max_lr=slice(1e-6, 1e-4))","8dd845b5":"interp = ClassificationInterpretation.from_learner(learn)\n\nlosses,idxs = interp.top_losses()\n\nlen(data.valid_ds)==len(losses)==len(idxs)","3498a3c3":"interp.plot_top_losses(9, figsize=(12,12))","00eed689":"interp.most_confused(min_val=2)","14535ae6":"preds,y, loss = learn.get_preds(with_loss=True)\n# get accuracy\nacc = accuracy(preds, y)\nprint('The accuracy is {0} %.'.format(acc*100))","35861b2f":"## Loading Libraries","24e27a1e":"## Defining the path for data","c43eb4ba":"# Devanagari Handwritten Digits Classifier - Fast.ai (Lesson 1)"}}