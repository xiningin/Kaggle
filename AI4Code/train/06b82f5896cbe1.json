{"cell_type":{"7d36f709":"code","12f105c0":"code","381807a5":"code","24c6fda5":"code","8431cea2":"code","0c910040":"code","5bf5e2a6":"code","99f92aea":"code","75c55de1":"code","d951483c":"code","1822985c":"code","38fa5285":"code","64ad3958":"code","76d468da":"code","eeaa3e20":"code","07e605a9":"code","9987ef28":"code","e797394e":"code","a3fc07b7":"code","8f79c3f4":"code","a5a9e5e5":"code","76c016e0":"code","fd138113":"code","f09493c1":"code","9dcdf5bc":"code","4ed3a855":"code","1958e6c3":"code","f31b0733":"markdown","dbfa9039":"markdown","f4763f74":"markdown","56045d5e":"markdown","ab25bbf7":"markdown","7f8e4e3c":"markdown","6ccd9a74":"markdown","fcb81f06":"markdown","105e4ad5":"markdown","fe894d45":"markdown","807342b8":"markdown","4a1cdc3f":"markdown","64d50ba8":"markdown","75dcfb4e":"markdown"},"source":{"7d36f709":"import os\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport datetime\nfrom datetime import datetime\nimport sklearn\nfrom sklearn.model_selection import train_test_split\nimport math\n\npd.set_option(\"display.max_columns\", None)","12f105c0":"os.listdir(\"..\/input\/uncover\/UNCOVER\/covid_tracking_project\/\")","381807a5":"\"\"\"\ndef load_data():\n  # Run this cell to download our data into a file called 'cifar_data'\n  import gdown\n  gdown.download('https:\/\/drive.google.com\/uc?id=1-BjeqccJdLiBA6PnNinmXSQ6w5BluLem','cifar_data','True'); # dogs v road;\n\n  # now load the data from our cloud computer\n  import pickle\n  data_dict = pickle.load(open( \"cifar_data\", \"rb\" ));\n  \n  data   = data_dict['data']\n  labels = data_dict['labels']\n  \n  return data, labels\n\"\"\"","24c6fda5":"DATA_DIR = \"..\/input\/uncover\/UNCOVER\/covid_tracking_project\/\"","8431cea2":"us_covid_data = pd.read_csv(DATA_DIR + \"covid-statistics-by-us-states-daily-updates.csv\")","0c910040":"# how many rows do we have?\nus_covid_data.shape","5bf5e2a6":"# ANSWER: one state's cases, for one day\nus_covid_data.iloc[0, :]","99f92aea":"# get basic summary statistics\nus_covid_data.describe()","75c55de1":"# get number of NaNs\nus_covid_data.isna().sum()","d951483c":"filtered_us_covid_data = us_covid_data[[\"date\", \"state\", \"positive\", \"negative\", \"death\", \"total\", \"totaltestresults\", \n                                        \"deathincrease\", \"hospitalizedincrease\", \"negativeincrease\", \"positiveincrease\", \n                                        \"totaltestresultsincrease\"]]","1822985c":"# check out the number of positive test cases, across all states, by day since April 28th\nus_covid_data[\"positive\"].hist()\nplt.show()","38fa5285":"# check out negative cases\nus_covid_data[\"negative\"].hist()\nplt.show()\n","64ad3958":"# check out, by state\nstate = input(\"Insert the abbreviation for the state:\")\nprint(\"\\n\")\n\nif state not in filtered_us_covid_data[\"state\"].unique():\n    raise ValueError(\"Abbreviation isn't a state. Please try again\")\n\nprint(f\"You've chosen to see the data for the state of {state}\")\n\n# check out positive graphs\nus_covid_data[us_covid_data[\"state\"] == state][\"positive\"].hist()\nplt.title(f\"Graph of positive COVID cases, from January 22nd to April 28th, for the state of {state}\")\nplt.xlabel(\"Number of cases, on a given day\")\nplt.ylabel(\"Number of days with that many cases\")\nplt.show()","76d468da":"# convert date column to dates (from string)\nus_covid_data[\"converted_date\"] = pd.to_datetime(us_covid_data[\"date\"], format=\"%Y-%m-%d\")","eeaa3e20":"# set date as the index\nus_covid_data.set_index(\"converted_date\", inplace = True)","07e605a9":"us_covid_data","9987ef28":"us_covid_data[us_covid_data[\"state\"] == state][\"positive\"]","e797394e":"us_covid_data[\"week_of_year\"] = pd.Int64Index(us_covid_data.index.isocalendar().week)","a3fc07b7":"# check out, by state\nstate = input(\"Insert the abbreviation for the state:\")\nprint(\"\\n\")\n\nif state not in filtered_us_covid_data[\"state\"].unique():\n    raise ValueError(\"Abbreviation isn't a state. Please try again\")\n\nprint(f\"You've chosen to see the data for the state of {state}\")\n\n# check out positive graphs\nus_covid_data[us_covid_data[\"state\"] == state][[\"positive\", \"week_of_year\"]].plot(x = \"week_of_year\", y = \"positive\")\nplt.title(f\"Number of positive cases, by week, for the state of {state}\")\nplt.ylabel(\"Number of positive cases\")\nplt.xlabel(\"Week of the year\")\nplt.show()","8f79c3f4":"# create X, y training sets\nX = us_covid_data[[\"state\",\"positive\", \"negative\",\"total\", \"totaltestresults\", \"deathincrease\", \"week_of_year\"]]\ny = us_covid_data[\"positiveincrease\"]\n\n# let's set the index to be the state\nX.set_index(\"state\", inplace=True)\n\n# let's impute any NaNs with 0\nX.fillna(0, inplace=True)\ny.fillna(0, inplace=True)\n","a5a9e5e5":"# train-test split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.2)","76c016e0":"# first model: linear regression\nfrom sklearn import linear_model\n\n# set up our model\nlinear = linear_model.LinearRegression(fit_intercept = True)\n\n# train the model \nlinear.fit(X_train, y_train)\n","fd138113":"# make predictions\ny_pred = linear.predict(X_test)","f09493c1":"# evaluate performance with MSE\nfrom sklearn.metrics import mean_squared_error\n\n# calculate MSE\nmse_linear = mean_squared_error(y_true = y_test, \n                                y_pred = y_pred)\n\n# get RMSE\nrmse_linear = math.sqrt(mse_linear \/ X_test.shape[0])\n\nprint(f\"Our RMSE (root mean squared error) for the linear regression is: {rmse_linear}\")","9dcdf5bc":"from sklearn.neural_network import MLPClassifier","4ed3a855":"# Create and train our multi layer perceptron model\nnnet = MLPClassifier(hidden_layer_sizes=(3, 3, 3), max_iter= 100)  ## How many hidden layers? How many neurons does this have?\nnnet.fit(X_train, y_train)\n\n# Predict what the classes are based on the testing data\nnnet_preds = nnet.predict(X_test)\n\n# calculate MSE\nmse_nnet = mean_squared_error(y_true = y_test, \n                              y_pred = nnet_preds)\n\n# get RMSE\nrmse_nnet = math.sqrt(mse_nnet \/ X_test.shape[0])\n\nprint(f\"Our RMSE (root mean squared error) for the neural network is: {rmse_nnet}\")","1958e6c3":"for ilayer in [(1,1), (3,3), (5,5), (8,6), (10,10,10), (10,10,5)]:\n    \n    # get shape of hidden layers\n    print(f\"Shape of hidden layers: {ilayer}\")\n\n    # fit neural net\n    nnet = MLPClassifier(hidden_layer_sizes=ilayer, max_iter= 1000)  ## How many hidden layers? How many neurons does this have?\n    nnet.fit(X_train, y_train)\n\n    # Predict what the classes are based on the testing data\n    nnet_preds = nnet.predict(X_test)\n\n    # calculate MSE\n    mse_nnet = mean_squared_error(y_true = y_test, \n                                  y_pred = nnet_preds)\n\n    # get RMSE\n    rmse_nnet = math.sqrt(mse_nnet \/ X_test.shape[0])\n\n    # print results\n    print(f\"Our parameters are: {size} layers, {numNeurons} neurons, and {numIt} iterations\\nOur RMSE (root mean squared error) for the neural network on the test set is: {rmse_nnet}\")\n    print(\"=====================\")","f31b0733":"#### What does each row represent?","dbfa9039":"**How well did your neural network perform?** \n\nMultilayer perceptrons are more complex models and it can be difficult to find the right \"settings\" for them. It takes some trial and error!","f4763f74":"Import data","56045d5e":"### Pt 3: Neural Networks\n\nNow, let's try to create a neural network","ab25bbf7":"Let's get the week of the date","7f8e4e3c":"Let's first start with a train-test split (80:20 split)","6ccd9a74":"**Let's explore linear regression through a demo!**\n\n[Playground!](http:\/\/setosa.io\/ev\/ordinary-least-squares-regression\/)","fcb81f06":"Let's see if we can predict the increase in positive test cases, by week, and see if we can predict this using other metrics. ","105e4ad5":"Get only the columns that don't have a lot of NaNs","fe894d45":"We can model the date by the number of days since the first COVID case was reported in America, to avoid time series calculations and turn the date aspect into a simpler regression question. \n\nLet's set the first day to be January 22nd (since this is the first day in the dataset)","807342b8":"To build a simple neural network, we use `MLPClassifier` from scikit-learn. We will play with the **number of neurons** and the **number of hidden layers** to adjust the complexity of our model! Just like we did in Playground. \n\nLet's see how well we can do. :) \n\n**Example 1:**\n\nIf we want to create a neural network with 1 hidden layer and 3 neurons, we would say:\n\n`nnet = MLPClassifier(hidden_layer_sizes=(3)) `\n\n**Example 2:**\n\nIf we want to create a neural network with 2 hidden layers and 3 neurons in each layer:\n\n`nnet = MLPClassifier(hidden_layer_sizes=(3, 3)) `","4a1cdc3f":"Linear regression is a statistical approach to find and determine a relationship among an independent variable `x` and a dependent variable `y`. For us, our `x` is `Age` while our `y` is `Selling_Price`. In the below equation, linear regression helps us find the `m` and `b` that best relates our variables. \n\n$y= mx + b$\n\nAnother way to say this is: we create a line that 'summarizes' the story that the data tells us. ","64d50ba8":"Now, let's do some EDA:","75dcfb4e":"### Pt 2: Model Fitting with Linear Regression"}}