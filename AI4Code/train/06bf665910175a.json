{"cell_type":{"62ec829b":"code","6660b3f3":"code","6412ad80":"code","bafe8186":"code","5ad70298":"code","ebf2540a":"code","d4880cea":"code","48b6ee82":"code","bfa9cbe2":"code","e9bada48":"code","d4f69128":"code","358b3596":"code","46cfa8a8":"code","95d199d4":"code","5e7a02d3":"code","a3e97edb":"code","9a364f4c":"code","edabe7ea":"code","9c9fed65":"code","65b91160":"code","cc268676":"code","21cf0bee":"markdown"},"source":{"62ec829b":"import pandas as pd\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.metrics import mean_squared_error\nfrom sklearn import datasets\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt","6660b3f3":"df = pd.read_csv(\"..\/input\/cardiogoodfitness\/CardioGoodFitness.csv\")","6412ad80":"df.head(10)","bafe8186":"sns.pairplot(df,hue='Gender')","5ad70298":"df.corr()","ebf2540a":"sns.heatmap(df.corr(),annot=True,lw=1)","d4880cea":"X = df[['Age', 'Gender', 'Education', 'MaritalStatus', 'Usage','Fitness','Income','Product']]","48b6ee82":"X = pd.get_dummies(data=X, drop_first=True)\nX.head()","bfa9cbe2":"Y=df['Miles']","e9bada48":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, Y, test_size=0.4, random_state=101)\nprint(X_train.shape)\nprint(X_test.shape)\nprint(y_train.shape)\nprint(y_test.shape)","d4f69128":"model = LinearRegression().fit(X_train, y_train)","358b3596":"# print the intercept\nprint(model.intercept_)","46cfa8a8":"model.coef_","95d199d4":"coeff=pd.DataFrame(model.coef_.T, index=X.columns, columns=[\"weight\"])\ncoeff","5e7a02d3":"#predictions=y_hat\npredictions = model.predict(X_test)\npredictions","a3e97edb":"sns.regplot(y_test,predictions)","9a364f4c":"mse = mean_squared_error(predictions, y_test)\nmse","edabe7ea":"y_hat_naive = [y_test.mean()]*len(y_test)\nmse_naive = mean_squared_error(y_hat_naive, y_test)\nmse_naive","9c9fed65":"r_sqe=1-(mse\/mse_naive)\nr_sqe","65b91160":"coeff","cc268676":"model.intercept_","21cf0bee":"For Gender_1, 1=Female\nFor Marital Status_1, 1=Partnered"}}