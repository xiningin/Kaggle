{"cell_type":{"ba3f37b3":"code","42237fe0":"code","7feca0e0":"code","fc644c30":"code","694eee0b":"code","62af70d9":"code","33bacdd8":"code","f939f012":"code","1cb6d018":"code","1e8e933e":"code","e73ceb98":"code","761f060a":"code","603e2fce":"code","b43b6714":"markdown","2818098e":"markdown","8518242f":"markdown","444ea66c":"markdown","8fae5cd1":"markdown","c0372373":"markdown","2626af79":"markdown","cfdba3e0":"markdown","e7adc81b":"markdown"},"source":{"ba3f37b3":"import numpy as np\nimport pandas as pd\nfrom sklearn.preprocessing import StandardScaler\n","42237fe0":"\ndata = pd.read_csv(\"..\/input\/spa2021\/final_dummies.csv\")\n\ndata = data.drop('Unnamed: 0', axis =1)","7feca0e0":"data.shape","fc644c30":"ls = data[data.season>2018]\nls = ls[data.circuit_id_spa != 1]\n\nsp = data[data.circuit_id_spa ==1]\n\ntrain = pd.concat([ls, sp], join = 'inner')","694eee0b":"X_train = train.drop(['driver', 'podium', 'round', 'season'], axis = 1)\ny_train = train.podium\n\nscaler = StandardScaler()\nX_train = pd.DataFrame(scaler.fit_transform(X_train), columns = X_train.columns)","62af70d9":"!pip install autokeras","33bacdd8":"import tensorflow as tf\nimport autokeras as ak\n\nclf = ak.StructuredDataClassifier(overwrite=True, max_trials=3)\nclf.fit(X_train, y_train, epochs=350)","f939f012":"\nX_test = pd.read_csv('..\/input\/spa2021\/test_template.csv')\ndrivers = X_test.driver\nX_test = X_test.drop(['driver', 'podium', 'round', 'season'], axis = 1)\nX_test = pd.DataFrame(scaler.transform(X_test), columns = X_test.columns)\n\nz = clf.predict(X_test)\n\nres = pd.DataFrame({'Driver': drivers})\nres['pos'] = z.astype(int)\n","1cb6d018":"res","1e8e933e":"model = clf.export_model()","e73ceb98":"model.save('model_spa_2021')","761f060a":"X_test = pd.read_csv('..\/input\/spa2021\/test_template - Copy.csv')\ndrivers = X_test.driver\nX_test = X_test.drop(['driver', 'podium', 'round', 'season'], axis = 1)\nX_test = pd.DataFrame(scaler.transform(X_test), columns = X_test.columns)\n\nz = clf.predict(X_test)\n\nres = pd.DataFrame({'Driver': drivers})\nres['pos'] = z.astype(int)\n","603e2fce":"res","b43b6714":"## Making Predictions","2818098e":"### Looks like Max is set to win with Bottas and Hamiltion bringing up the podium.\n\n### Stroll, Gasly, Norris are expected to perform well.\n\n##### While Gasly and Norris are expected here, stroll probably comes from the fact that racing point\/ force india\/ aston martin have traditionally performed very well in Spa and Stroll is pretty good in rain (Monza 2017, Germany 2019, Turkey 2020).\n\n### Ferraris are expected to struggle as per the model.\n\n### A shocking outlier is Perez\n\n### Giovinazzi got a 25 as he DSQ'ed from previous Belgian GP's and lack of data hurts him.\n\n### Same can be said for tsunoda, who's unusually high position can be attributed to gasly's strong performances in a similar car\n\n# However these results are based on P2 results and Final predictions will depend on Qualifying performance and grid start order and weather conditions.","8518242f":"## A note about predictions\n\nWet weather races are very chaotic and difficult to predict, hence these predictions can be very wrong. Also tracks like spa, baku etc. with long lap times and high safety car chances give a very difficult time to models.","444ea66c":"## Consider the results of past 3 seasons and all the belgian GP from 1983 onwards.","8fae5cd1":"# Read the data","c0372373":"### Fitting a classification model using auto-keras","2626af79":"# Predictions after Qualification","cfdba3e0":"# Predicting the result of 2021 Belgian GP\n\n### Since I have only P2 times, I will use those to make predictions","e7adc81b":"## Preparing the data"}}