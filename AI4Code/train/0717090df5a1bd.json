{"cell_type":{"d126ce9c":"code","b1f4999b":"code","e030fbdc":"code","d4dc9735":"code","b79bd8a0":"code","d5b0514b":"code","d9af13f0":"code","e1a132a2":"code","79b699eb":"code","34e4165a":"code","439f7e9e":"code","d6b7e516":"code","16304d2c":"code","b9f8f633":"markdown","968fab43":"markdown","9f89f65a":"markdown","182ff281":"markdown","400004e8":"markdown"},"source":{"d126ce9c":"# import package with helper functions \nimport bq_helper\n\n# create a helper object for this dataset\ngithub = bq_helper.BigQueryHelper(active_project=\"bigquery-public-data\",\n                                              dataset_name=\"github_repos\")","b1f4999b":"github.head('sample_commits',1)","e030fbdc":"github.head('sample_files',1)","d4dc9735":"query = ''' SELECT  sf.id AS ID,\n                    COUNT(sc.commit) AS commit                   \n            FROM `bigquery-public-data.github_repos.sample_files` as sf\n            INNER JOIN `bigquery-public-data.github_repos.sample_commits` as sc\n                        ON sf.repo_name = sc.repo_name\n            GROUP BY ID\n        '''","b79bd8a0":"commit_repos = github.query_to_pandas_safe(query, max_gb_scanned=20)","d5b0514b":"commit_repos.head(10)","d9af13f0":"github.head('sample_files',1)","e1a132a2":"queryy = ''' SELECT repo_name, id\n             FROM `bigquery-public-data.github_repos.sample_files`\n             WHERE path LIKE '%.py'\n         '''","79b699eb":"id_py = github.query_to_pandas(queryy)","34e4165a":"id_py.head()","439f7e9e":"query2 = ''' WITH path_py AS\n             (\n                 SELECT repo_name, id\n                 FROM `bigquery-public-data.github_repos.sample_files`\n                 WHERE path LIKE '%.py'\n             )\n             \n             SELECT \n                     py.id as ID, \n                     COUNT(sc.commit) as COMMIT \n             FROM path_py as py\n             INNER JOIN `bigquery-public-data.github_repos.sample_commits` as sc\n                         ON py.repo_name = sc.repo_name\n             GROUP BY ID\n             ORDER BY COMMIT\n         '''","d6b7e516":"path_py_commit_id = github.query_to_pandas(query2)","16304d2c":"path_py_commit_id","b9f8f633":"# Feedback\nBring any questions or feedback to the [Learn Discussion Forum](kaggle.com\/learn-forum).\n\n# Congratulations\nBy now, you know all the key components to use BigQuery and SQL effectively.\n\nWant to go play with your new powers?  Kaggle has BigQuery datasets available [here](https:\/\/www.kaggle.com\/datasets?filetype=bigQuery).","968fab43":"**2. SELECT ID (WHERE PATH IS PYTHON CODE) AND COMMIT**","9f89f65a":"**1. SELECT ID AND COMMIT**","182ff281":"# Question\n\n#### 1)  How many commits (recorded in the \"sample_commits\" table) have been made in repos written in the Python programming language? (I'm looking for the number of commits per repo for all the repos written in Python.\n* You'll want to JOIN the sample_files and sample_commits questions to answer this.\n* **Hint:** You can figure out which files are written in Python by filtering results from the \"sample_files\" table using `WHERE path LIKE '%.py'`. This will return results where the \"path\" column ends in the text \".py\", which is one way to identify which files have Python code.","400004e8":"Write the code to answer the question below"}}