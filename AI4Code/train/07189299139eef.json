{"cell_type":{"3b5684f9":"code","7519dc7f":"code","74fb5a07":"code","604d6b91":"code","eb6e0848":"code","ced0c60e":"code","fa3709f7":"code","aca8ef8e":"code","279f4df9":"code","d76a0f64":"code","e80ffb8b":"code","6312f514":"code","8e31a9e4":"code","ca8fde36":"code","9173ef45":"markdown","91efa621":"markdown","69f2b980":"markdown","05721b06":"markdown","c0717603":"markdown","5648437c":"markdown","eabf4d85":"markdown","19f1eff5":"markdown","0c914ece":"markdown","08f5207d":"markdown"},"source":{"3b5684f9":"#Using linear regression to analyze customer behaviour \nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline","7519dc7f":"ecom_customers = pd.read_csv('..\/input\/Ecommerce Customers')\necom_customers.head()                             ","74fb5a07":"#Dataset info\necom_customers.info()","604d6b91":"ecom_customers.describe()","eb6e0848":"#Scatter plot of Yearly Amount Spent vs Time on Website. \n#Since we have a circular shape, there is not a significant correlation between these two variables.\nsns.jointplot(ecom_customers['Time on Website'],ecom_customers['Yearly Amount Spent'])","ced0c60e":"#Scatter plot of Yearly Amount Spent vs Time on App. \n#We can see there is a correlation between the amount of time spent on the app and the amount of money spent.\nsns.jointplot(ecom_customers['Time on App'],ecom_customers['Yearly Amount Spent'])","fa3709f7":"sns.jointplot(ecom_customers['Time on App'],ecom_customers['Length of Membership'],kind='hex')","aca8ef8e":"#A grid plot of all the variables. This shows that lenghth of membership is the most effective factor on yearly amount spent.\nsns.pairplot(ecom_customers)","279f4df9":"sns.heatmap(ecom_customers.corr(),cmap = 'Blues', annot=True)","d76a0f64":"sns.lmplot(x='Length of Membership',y='Yearly Amount Spent',data = ecom_customers)","e80ffb8b":"#Using Linear Regression to predict the amount of money spent based on the other variable.\n\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn import metrics\n\nx=ecom_customers[['Avg. Session Length','Time on App','Time on Website','Length of Membership']]\ny=ecom_customers['Yearly Amount Spent']\n\n#Splitting the data into test data and training data\nx_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.4)\n\n#Creating a Linear Regression model\nlm = LinearRegression()\nlm.fit(x_train,y_train)\ncoeff_df = pd.DataFrame(lm.coef_,x.columns,columns=['Coefficient'])\ncoeff_df","6312f514":"#Predicting the output using the model\npredictions = lm.predict(x_test)\nplt.scatter(y_test,predictions)","8e31a9e4":"#Evaluating the results usind different metrics\nprint('MAE:', metrics.mean_absolute_error(y_test, predictions))\nprint('MSE:', metrics.mean_squared_error(y_test, predictions))\nprint('RMSE:', np.sqrt(metrics.mean_squared_error(y_test, predictions)))","ca8fde36":"#plotting the distribution of the prediction erros. ]\n#Since the error has a normal distribution, the model is considered suitable for the data.\nsns.distplot((y_test-predictions),bins=50);","9173ef45":"Let's explore the data\n\nUse seaborn to create a jointplot to compare the Time on Website and Yearly Amount Spent columns.","91efa621":"**Exploratory Data Analysis**","69f2b980":"**I Guess by now you got your answer that Yearly Amount spent and Length of Membership are highly correlated**","05721b06":"**Check the head of customers, and check out its info() and describe() methods.**","c0717603":"Assume You just got some contract work with an Ecommerce company based in New York City that sells clothing online but they also have in-store style and clothing advice sessions. Customers come in to the store, have sessions\/meetings with a personal stylist, then they can go home and order either on a mobile app or website for the clothes they want.\n\nThe company is trying to decide whether to focus their efforts on their mobile app experience or their website. They've hired you on contract to help them figure it out! Let's get started!\n\nJust follow the steps below to analyze the customer data (it's fake, don't worry I didn't give you real credit card numbers or emails).","5648437c":"**Based off this plot what looks to be the most correlated feature with Yearly Amount Spent?**","eabf4d85":"**Let's explore these types of relationships across the entire data set. Use pairplot to recreate the plot below.(Don't worry about the the colors)**","19f1eff5":"**Do the same but with the Time on App column instead.**","0c914ece":"**Use jointplot to create a 2D hex bin plot comparing Time on App and Length of Membership.**","08f5207d":"**Imports**"}}