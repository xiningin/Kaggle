{"cell_type":{"f6b82b50":"code","1a5e3e8f":"code","6410c18d":"code","45deac60":"code","3f3f59b5":"code","9b2e92ba":"code","c1225f9f":"code","869b7e5a":"code","c657dba5":"markdown","21e6437c":"markdown","0672a1d4":"markdown","1882dc98":"markdown","69b81021":"markdown"},"source":{"f6b82b50":"import numpy as np","1a5e3e8f":"Gamma = 1.0\nmu = 5.0\nx = np.linspace(mu-Gamma*5, mu+Gamma*5 ,500)\n\ndef f(x):\n    return (1\/np.pi)*Gamma\/((x-mu)*(x-mu) + Gamma*Gamma)","6410c18d":"import plotly.io as pio\nimport plotly.graph_objects as go\npio.templates.default = pio.templates[\"simple_white\"]\npio.templates.default['layout']['xaxis']['showgrid'] = True\npio.templates.default['layout']['yaxis']['showgrid'] = True","45deac60":"fig = go.Figure()\n\nfig.add_trace( go.Scatter(x=x, y=f(x), mode='lines',\n                          line_width=2, line_color=\"blue\"))\n\nfig.add_trace( go.Scatter(x=[mu,mu], y=[0,f(mu)],\n                          mode='lines',\n                          line_width=2, line_color=\"black\",\n                          line_dash=\"dash\") )\nfig.add_trace( go.Scatter(x=[mu+Gamma,mu+Gamma], y=[0,f(mu+Gamma)],\n                          mode='lines',\n                          line_width=2, line_color=\"black\",\n                          line_dash=\"dash\") )\n\nfig.add_annotation(x=mu,       y=0, text=r\"$\\mu$\",\n                   xanchor='right', yanchor='bottom')\nfig.add_annotation(x=mu+Gamma, y=0, text=r\"$\\mu + \\Gamma$\",\n                   xanchor='right', yanchor='bottom')\n\nfig.update_xaxes(title_text=r\"$x$\")\nfig.update_yaxes(title_text=r\"$f(x)$\", range=(0,0.35))\nfig.update_layout(showlegend=False)\n\nfig.show()","3f3f59b5":"N = 1000000 # number of events to generate\n\nrnd = np.random.uniform(size=N)","9b2e92ba":"x_rnd = mu + Gamma*np.tan( 0.5*np.pi*rnd + np.arctan(mu\/Gamma)*(rnd - 1) )","c1225f9f":"fig = go.Figure()\n\nfig.add_trace(go.Histogram(x=x_rnd, histnorm='probability density',\n                           xbins={\n                               'start': mu-Gamma*100,\n                               'end':   mu+Gamma*100,\n                               'size':  0.1\n                                 },\n                           opacity=0.5\n                          )\n             )\n\nfig.add_trace( go.Scatter(x=x, y=f(x), mode='lines',\n                          line_width=2, line_color=\"blue\"))\nfig.update_layout(showlegend=False)\n\nfig.update_xaxes(title_text=r\"$x$\", range=(mu-Gamma*5, mu+Gamma*5))\nfig.update_yaxes(title_text=r\"$f(x)$\", range=(0,0.35))\n\nfig.show()","869b7e5a":"# Small error in normalization?","c657dba5":"Lorentz distribution is written as\n$$\nf(x) = \\frac{1}{\\pi} \\frac{\\Gamma}{(x-\\mu)^2 + \\Gamma^2}.\n$$","21e6437c":"In order to generate the random number according to this distribution first we need a random number from (0,1) interval.","0672a1d4":"# Generate random Cauchy-Lorentz distribution\n[A. Petrenko](http:\/\/www.inp.nsk.su\/~petrenko\/), W. P\u0142aczek (CERN, 2021)","1882dc98":"Plot the histogram of x","69b81021":"Let's plot it:"}}