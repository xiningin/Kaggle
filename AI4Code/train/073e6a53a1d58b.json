{"cell_type":{"9b481e1f":"code","b947d58c":"code","889c791d":"code","a3aaee68":"code","f98a0b1a":"code","ade33192":"code","0073847d":"code","7d82a8d8":"code","966a8d9a":"code","407b65db":"code","06cb1faf":"code","ebf77d47":"code","f7bb4bb5":"code","d496123e":"code","a971c81d":"code","8b421b82":"code","800c1c56":"markdown","597625d0":"markdown","34f54687":"markdown","e888b83b":"markdown","76505da4":"markdown","b39bd2ca":"markdown","8b54f4dc":"markdown","3ee9ff52":"markdown","17052c4f":"markdown","74bd9431":"markdown","00fcd4d4":"markdown","554bd4a5":"markdown","b0004d38":"markdown","1922a4ea":"markdown","72b301cf":"markdown","5b5ec8a2":"markdown"},"source":{"9b481e1f":"import matplotlib.pyplot as plt\nimport pandas as pd\nimport pylab as pl\nimport numpy as np\n%matplotlib inline","b947d58c":"!wget -O FuelConsumption.csv https:\/\/s3-api.us-geo.objectstorage.softlayer.net\/cf-courses-data\/CognitiveClass\/ML0101ENv3\/labs\/FuelConsumptionCo2.csv","889c791d":"df = pd.read_csv(\"FuelConsumption.csv\")\ndf.head()","a3aaee68":"df.describe()\n","f98a0b1a":"vi = df\nvi.hist()\nplt.show()","ade33192":"cdf = df[['ENGINESIZE','CYLINDERS', 'FUELCONSUMPTION_COMB', 'CO2EMISSIONS']]\ncdf.head(10)","0073847d":"viz = cdf[['CYLINDERS','ENGINESIZE','CO2EMISSIONS','FUELCONSUMPTION_COMB']]\nviz.hist()\nplt.show()","7d82a8d8":"plt.scatter(cdf.FUELCONSUMPTION_COMB,cdf.CO2EMISSIONS, color ='blue')\nplt.xlabel(\"FUELCONSUMPTION_COMB\")\nplt.ylabel(\"CO2EMISSIONS\")\nplt.show()\n","966a8d9a":"plt.scatter(cdf.ENGINESIZE,cdf.CO2EMISSIONS, color ='blue')\nplt.xlabel(\"ENGINESIZE\")\nplt.ylabel(\"CO2EMISSIONS\")\nplt.show()","407b65db":"plt.scatter(cdf.CYLINDERS,cdf.CO2EMISSIONS, color ='blue')\nplt.xlabel(\"CYLINDERS\")\nplt.ylabel(\"CO2EMISSIONS\")\nplt.show()","06cb1faf":"msk = np.random.rand(len(df)) < 0.8\ntrain = cdf[msk]\ntest = cdf[~msk]\n# Plotting the distribution of train and test data\nplt.scatter(train.ENGINESIZE, train.CO2EMISSIONS,  color='blue')\nplt.xlabel(\"Engine size\")\nplt.ylabel(\"Emission\")\nplt.show()","ebf77d47":"from sklearn import linear_model\nregr = linear_model.LinearRegression()\ntrain_x = np.asanyarray(train[['ENGINESIZE']])\ntrain_y = np.asanyarray(train[['CO2EMISSIONS']])\nregr.fit (train_x, train_y)\n# Printing the Parameters\nprint(\"Coefficient: \", regr.coef_)\nprint(\"Intercept: \", regr.intercept_)","f7bb4bb5":"plt.scatter(train.ENGINESIZE, train.CO2EMISSIONS,  color='blue')\nplt.plot(train_x, regr.coef_[0][0]*train_x + regr.intercept_[0], '-r')\nplt.xlabel(\"Engine size\")\nplt.ylabel(\"Emission\")","d496123e":"from sklearn.metrics import r2_score\n\ntest_x = np.asanyarray(test[['ENGINESIZE']])\ntest_y = np.asanyarray(test[['CO2EMISSIONS']])\ntest_y_ = regr.predict(test_x)\n\nprint(\"Mean absolute error: %.2f\" % np.mean(np.absolute(test_y_ - test_y)))\nprint(\"Residual sum of squares (MSE): %.2f\" % np.mean((test_y_ - test_y) ** 2))\nprint(\"R2-score: %.2f\" % r2_score(test_y_ , test_y) )","a971c81d":"print(regr.predict([[6.5]]))","8b421b82":"print(regr.predict(np.array([4.0]).reshape(1, 1)))","800c1c56":"# The Regression Model\n## Train data distribution","597625d0":"# Building the Simple Linear Regression Model","34f54687":"## Data Exploration","e888b83b":"# <center>Gentle Introduction to Simple Linear Regression<\/center>\n\n\n### About this Notebook\nThis notebook presents the use scikit-learn to implement a simple linear regression. The dataset used is related to fuel consumption and Carbon dioxide emission of cars. which is split our data into training and test sets, create a model using training set, Evaluate your model using test set, and finally use model to predict unknown values","76505da4":"### Downloading Data\n\nTo download the data, we will use !wget to download it from IBM Object Storage","b39bd2ca":"## Some Scatter Plots","8b54f4dc":"## Fuel Consumption Versus Emmision","3ee9ff52":"Importing Needed packages","17052c4f":"### Selecting Specific Features","74bd9431":"## Reading the Data","00fcd4d4":"## Cylinders Versus Emmision","554bd4a5":"## Predicting CO2 Emmision of Random Engine Sizes","b0004d38":"### Some Visualizations","1922a4ea":"# Evaluation","72b301cf":"## Plotting the Output","5b5ec8a2":"## Engine Size Versus Emmision"}}