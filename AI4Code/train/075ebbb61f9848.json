{"cell_type":{"b2b1d665":"code","8a0a7bb3":"code","bae2502e":"code","1322572c":"code","af616247":"code","0225ef40":"code","6df8c6c2":"code","3f6917db":"code","57a7ba6b":"code","51c868b9":"code","69466b80":"code","75c0923c":"code","2f50343f":"code","3b69c394":"code","73795a46":"code","1b803750":"code","0bd67540":"code","0a5db4d6":"code","88fc9109":"code","f5730246":"code","a60123bb":"code","ab5871bd":"code","b6129740":"code","2c544a87":"code","709614df":"code","e4fe18d3":"code","a28a112b":"code","a10f1249":"code","03e42f9c":"code","a1039a24":"code","90a5231b":"code","d9c2a8ea":"code","e04905b8":"code","7b343702":"code","f44c59f6":"code","44bcb88b":"code","c77d4867":"code","bc3ad189":"code","7d422f4c":"code","35551203":"code","34bec402":"code","2551e758":"code","2d8d1ad0":"code","01779497":"code","2e48086b":"code","bdb7c325":"code","ccc6944d":"markdown","859d7eb1":"markdown","01018b5e":"markdown","60d6ed25":"markdown","421e8505":"markdown","9a31e9ed":"markdown","a79b3a36":"markdown","d58b9a08":"markdown","f5cf329b":"markdown","73790943":"markdown","147b7171":"markdown","60e875b9":"markdown","754e0437":"markdown","6a2a124a":"markdown","77f6fcc7":"markdown","2f854f82":"markdown","6f084c29":"markdown","f83202dd":"markdown","b0a2a520":"markdown","48fdd9ee":"markdown","3c9ffe68":"markdown","8fa7327f":"markdown","a0597973":"markdown","82916ed8":"markdown","41e61fca":"markdown","42dacbc0":"markdown","93084277":"markdown"},"source":{"b2b1d665":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\n%matplotlib inline\nimport pandas as pd\nimport numpy as np\nimport json as json\nimport seaborn as sbn\nimport matplotlib.pyplot as plt\nimport scipy as sp\nimport re\nimport datetime as dt\n\n# import plotly\nimport plotly as py\nimport plotly.graph_objs as go\n\n# these two lines are what allow your code to show up in a notebook!\nfrom plotly.offline import download_plotlyjs, init_notebook_mode, plot, iplot\ninit_notebook_mode(connected=True)\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\ndata_dir = \"..\/input\/repository\/ecodan-housing_affordability_data-60a936a\"\nprint(os.listdir(data_dir))\n\n# Any results you write to the current directory are saved as output.","8a0a7bb3":"# read in the case-schiller index data\ndf_schiller = pd.read_excel(\n    os.path.join(data_dir, \"cs_idx.xls\"),\n    sheet_name=\"Data\", \n    skiprows=range(0,6)\n)","bae2502e":"# courtesy of https:\/\/stackoverflow.com\/questions\/20911015\/decimal-years-to-datetime-in-python\/20911144#20911144\nfrom datetime import datetime, timedelta\n\ndef decimal_year_to_dt(dyear):\n    year = int(dyear)\n    rem = dyear - year\n    base = datetime(year, 1, 1)\n    result = base + timedelta(seconds=(base.replace(year=base.year + 1) - base).total_seconds() * rem)\n    return result","1322572c":"# drop all but the first two columns (Date and Index)\ndf_hp_idx = df_schiller.iloc[:,0:2]\n\n# resample the dates to be whole years\ndf_hp_idx['dt'] = df_hp_idx['Date'].apply(lambda x: decimal_year_to_dt(x))\ndf_hp_idx_yr = df_hp_idx.resample('AS', on='dt', kind='timestamp').mean()\ndf_hp_idx_yr['Date'] = df_hp_idx_yr['Date'].astype(int)\n","af616247":"# peek at the data\ndf_hp_idx_yr.head()","0225ef40":"# plot the index\ndf_hp_idx_yr.plot.line( \n    figsize=(12,6), \n    title='Case-Schiller House Price Idx 1890-2017 (2017 dollars)',\n    style='.-',\n    x='Date',\n    y='Index',\n    ylim=(0, 225),\n).legend(\n    loc='center left', bbox_to_anchor=(1, 0.5)\n)","6df8c6c2":"# plot the index since 1967\ndf_hp_idx_yr[df_hp_idx_yr['Date'] >= 1967].plot.line( \n    figsize=(12,6), \n    title='Case-Schiller House Price Idx 1967-2017 (2017 dollars)',\n    style='.-',\n    x='Date',\n    y='Index',\n    ylim=(0, 225),\n).legend(\n    loc='center left', bbox_to_anchor=(1, 0.5)\n)","3f6917db":"z = np.polyfit(\n    df_hp_idx_yr[df_hp_idx_yr['Date'] >= 1967]['Date'], \n    df_hp_idx_yr[df_hp_idx_yr['Date'] >= 1967]['Index'], \n    2\n)\np = np.poly1d(z)\n","57a7ba6b":"# plot the index with the best fit\ndf_hp_idx_yr['fit'] = df_hp_idx_yr['Date'].apply(lambda x: p(x)) # only valid after 1967\ndf_hp_idx_yr[df_hp_idx_yr['Date'] >= 1967].plot.line( \n    figsize=(12,6), \n    title='Schiller House Price Idx 1967-2017 (2017 dollars)',\n    style={'Index':'.-','fit':'-'},\n    x='Date',\n    y=['Index', 'fit'],\n    ylim=(0,225)\n).legend(\n    loc='center left', bbox_to_anchor=(1, 0.5)\n)","51c868b9":"# read US census household income data broken out by tiers (20%, 40%, 60%, 80%, 95%) \ndf_inc_tiers_2017 = pd.read_excel(\n    os.path.join(data_dir, \"census_income_tiers_h01ar.xls\"),\n    sheet_name=\"h01ar\", \n    names=['year', 'household_count', 't20', 't40', 't60', 't80', 't95'],\n    skiprows=range(0,3)\n)","69466b80":"# strip footnotes off of the years\ndf_inc_tiers_2017['year'] = df_inc_tiers_2017['year'].apply(lambda x: int(str(x)[0:4]))\n# convert households back to millions\ndf_inc_tiers_2017['household_count'] = df_inc_tiers_2017['household_count'].apply(lambda x: x*1000)\n# move the \"year\" to the index\ndf_inc_tiers_2017.set_index(df_inc_tiers_2017['year'].astype(int), inplace=True)\n# reverse the rows (oldest at top)\ndf_inc_tiers_2017 = df_inc_tiers_2017.iloc[::-1]","75c0923c":"# peek at the resulting data\ndf_inc_tiers_2017.head()","2f50343f":"# graph the tiers over time\ndf_inc_tiers_2017.iloc[:,2::].plot.line( \n    figsize=(12,6), \n    title='Earnings by income tiers 1967-2017 (2017 dollars)',\n    style='.-',\n).legend(\n    loc='center left', bbox_to_anchor=(1, 0.5)\n)","3b69c394":"df_inc_tiers_2017.iloc[:,2::].div(\n    df_inc_tiers_2017['t20'], \n    axis=0, \n).plot.line( \n    figsize=(12,6), \n    title='Ratio of income tiers to 20th percentile since 1967',\n    style='.-',\n).legend(\n    loc='center left', bbox_to_anchor=(1, 0.5)\n)\n\n","73795a46":"# read in the census poverty line history\ndf_poverty_line = pd.read_excel(\n    os.path.join(data_dir, \"hstpov1.xls\"),\n    sheet_name=\"pov01\", \n    skiprows=range(0,3)\n)\n\n# get only the columns we need and drop the last row which is a legend\ndf_poverty_line = df_poverty_line.iloc[0:-1,np.r_[0,4,7,15]]\ndf_poverty_line.columns = ['year', '2', '3', 'CPI']\n\n# get the average of column 4 (2 person households) and 7 (3 person households)\ndf_poverty_line['2.5'] = df_poverty_line.apply(lambda x: (x['2']+x['3'])\/2.0, axis=1)\n\ndf_poverty_line.drop(['2','3'], axis=1, inplace=True)","1b803750":"# strip footnotes off of the years\ndf_poverty_line['year'] = df_poverty_line['year'].apply(lambda x: int(str(x)[0:4]))\n\n# drop the extra 2013\ndf_poverty_line.drop(df_poverty_line.index[df_poverty_line['year'] == 2013].tolist()[0], axis=0, inplace=True)\n\n# drop the years prior to 1967\ndf_poverty_line.drop(df_poverty_line.index[df_poverty_line['year'] < 1967].tolist(), axis=0, inplace=True)\n\n# move the \"year\" to the index\ndf_poverty_line.set_index(df_poverty_line['year'].astype(int), inplace=True)\n\n# adjust to 2017 dollars with CPI\ncpi_2017 = df_poverty_line['CPI'].iloc[-1]\ndf_poverty_line['2.5 adj'] = df_poverty_line.apply(lambda x: x['2.5'] * cpi_2017 \/ x['CPI'], axis=1)","0bd67540":"# peek at the data\ndf_poverty_line.head()","0a5db4d6":"df_inc_tiers_2017_mod = df_inc_tiers_2017.iloc[:,2::].sub(df_poverty_line['2.5'], axis=0) ","88fc9109":"df_inc_tiers_2017_mod.plot.line( \n    figsize=(12,6), \n    title='\"House buying power\" by income quintile 1967-2017 (2017 dollars)',\n    style='.-',\n    ylim=(0,225000)\n).legend(\n    loc='center left', bbox_to_anchor=(1, 0.5)\n)","f5730246":"df_inc_tiers_2017_mod.div(\n    df_inc_tiers_2017_mod['t20'], \n    axis=0, \n).plot.line( \n    figsize=(12,6), \n    title='Ratio of \"house buying power\" tiers (1967-2017)',\n    style='.-',\n).legend(\n    loc='center left', bbox_to_anchor=(1, 0.5)\n)","a60123bb":"# graph income tiers against Case-Schiller actuals and trend\nax = df_inc_tiers_2017_mod.plot.line( \n    figsize=(15,8), \n    title='\"House buying power\" vs Schiller Price Index by income quintile 1967-2017 (2017 dollars)',\n    style='.-',\n    ylim=(0,225000),\n)\nax.legend(\n    loc='center left', \n    bbox_to_anchor=(1.1, 0.5)\n)\nax.set_ylabel(\"Income (USD)\")\n\n# add the schiller index to secondary y axis\nser_schiller = pd.Series(index=df_inc_tiers_2017_mod.index.tolist(), data=[p(x) for x in df_inc_tiers_2017_mod.index.tolist()])\nax2 = ax.twinx()\nax2.set_ylim((0,225))\nline2, = ax2.plot(\n    df_inc_tiers_2017_mod.index.tolist(), \n    ser_schiller, \n    'k-',\n    label='Schiller Index Trend'\n)\nline3, = ax2.plot(\n    df_inc_tiers_2017_mod.index.tolist(), \n    df_hp_idx_yr[df_hp_idx_yr['Date'] > 1967]['Index'], \n    color=\"0.75\",\n    linestyle=\"dashed\",\n    label='Actual Schiller Index'\n)\nax2.legend(\n    loc='center left', \n    bbox_to_anchor=(1.1, 0.7)\n)\n","ab5871bd":"# run a pearson correlation between the shiller index and incomes at each tier\ndf_inc_tiers_2017_mod.corrwith(ser_schiller)","b6129740":"# assume 20% down, max 35% of take home pay, 4% mortgage interest\n\n# this method has hardcoded thresholds for 2017 tax brackets.  Shame on me.\ndef calc_takehome(income):\n    # take off standard deduction - 2400 for married household\n    mod_income = income - 2400\n    if mod_income < 0:\n        return income\n    \n    taxable_by_tier = np.zeros(4)\n#     tier_0 = mod_income if mod_income < 19051 else 19051\n    taxable_by_tier[0] = (mod_income - 19051) if mod_income < 77400 else (77400-19051)\n    taxable_by_tier[1] = (mod_income - 77400) if mod_income < 165000 else (165000-77400)\n    taxable_by_tier[2] = (mod_income - 165000) if mod_income < 315000 else (315000-165000)\n    taxable_by_tier[3] = (mod_income - 315000) if mod_income < 400000 else (400000-315000)\n    \n    taxable_by_tier = [x if x > 0 else 0 for x in taxable_by_tier]\n    tax = (taxable_by_tier[0] * .12) + (taxable_by_tier[1] * .22) + (taxable_by_tier[2] * .24) + (taxable_by_tier[3] * .32)\n    \n    # 7.65% for SS and medicare up to 128,000\n    ssmed = .0765 * (income if income < 128000 else 128000)\n    return (income - tax - ssmed)\n\n\n# test\nprint(\"  2300: {0}\".format(calc_takehome(2300)))\nprint(\" 18000: {0}\".format(calc_takehome(18000)))\nprint(\" 50000: {0}\".format(calc_takehome(50000)))\nprint(\"250000: {0}\".format(calc_takehome(250000)))\n","2c544a87":"# create a new dataframe to hold the results of the affordability calculations\ndf_mortage_2017 = pd.DataFrame(\n    index=df_inc_tiers_2017.columns[2::], \n    data=df_inc_tiers_2017.iloc[-1,2::].T,\n)\ndf_mortage_2017.rename({2017:'base'}, inplace=True, axis=1)","709614df":"df_mortage_2017","e4fe18d3":"# compute the after tax net income\ndf_mortage_2017['takehome'] = df_mortage_2017['base'].apply(lambda x: calc_takehome(x))\n\n# apply the 25% and 35% mortgage afforgability rules\ndf_mortage_2017['max_monthly_35'] = df_mortage_2017['takehome'].apply(lambda x: x * .35 \/ 12)\ndf_mortage_2017['max_monthly_25'] = df_mortage_2017['takehome'].apply(lambda x: x * .25 \/ 12)","a28a112b":"df_mortage_2017","a10f1249":"# how much house is that?\n# c*(1-(1+r)-N)\/r = P\ndef calc_max_price(pymt, interest, periods):\n    return (pymt * (1-(1+(interest\/12\/100))**(0-periods))) \/ (interest\/12\/100)\n\n# test\nprint(\"1264.14, 6.5, 360: {0}\".format(calc_max_price(1264.14, 6.5, 360))) # should be 200K\n\n","03e42f9c":"# assuming 20% down\ndf_mortage_2017['max_house_35'] = df_mortage_2017['max_monthly_35'].apply(lambda x: calc_max_price(x, 5, 360)*1.2)\ndf_mortage_2017['max_house_25'] = df_mortage_2017['max_monthly_25'].apply(lambda x: calc_max_price(x, 5, 360)*1.2)\n\n","a1039a24":"df_mortage_2017['max_house_35'].plot.barh(\n    figsize=(12,6), \n    title='Max house price by tiers based on 35% mortage to income ratio (2017)',\n    style='.-',\n).legend(\n    loc='center left', bbox_to_anchor=(1, 0.5)\n)","90a5231b":"df_mortage_2017['max_house_25'].plot.barh(\n    figsize=(12,6), \n    title='Max house price by tiers based on 25% mortage to income ratio (2017)',\n    style='.-',\n).legend(\n    loc='center left', bbox_to_anchor=(1, 0.5)\n)","d9c2a8ea":"df_mortage_2017['price_inc_ratio_35'] = df_mortage_2017['max_house_35'] \/ df_mortage_2017['base']\ndf_mortage_2017['price_inc_ratio_25'] = df_mortage_2017['max_house_25'] \/ df_mortage_2017['base']","e04905b8":"df_mortage_2017","7b343702":"# read data from zillow on price-to-income ratio (PIR) compared to the median income in major US markets\ndf_z_aff = pd.read_csv(os.path.join(data_dir,'Zillow_Affordability_Wide_Public.csv'))\ndf_z_aff.drop(['RegionID','City','State','SizeRank','HistoricAverage_1985thru1999'], axis=1, inplace=True)\ndf_z_aff = df_z_aff[df_z_aff['Index'] == 'Price To Income']\ndf_z_aff.drop('Index', axis=1, inplace=True)\ndf_z_aff.set_index('RegionName', inplace=True)","f44c59f6":"df_z_aff = df_z_aff.unstack().reset_index()\ndf_z_aff.rename({'level_0':'date',0:'pir'}, axis=1, inplace=True)","44bcb88b":"# function manually convert the dates\npatt = re.compile('(\\d?\\d)\/(\\d?\\d)\/(\\d\\d)')\ndef to_date(dstr):\n    m = patt.match(dstr)\n    yr = int(m.group(3))\n    yr = 2000 + yr if yr < 50 else 1900 + yr\n    return dt.date(yr, int(m.group(1)), int(m.group(2)))\n\nto_date('9\/01\/14')","c77d4867":"# convert the dates\ndf_z_aff['date'] = df_z_aff['date'].apply(lambda x: to_date(x))\ndf_z_aff['date'] = pd.to_datetime(df_z_aff['date'])","bc3ad189":"# funtion to re-format the market name in the zillow data\npatt = re.compile('([^-]+)(.*), (.+)')\ndef split_region(region_name):\n    m = patt.search(region_name)\n    return pd.Series((m.group(1), m.group(3)))","7d422f4c":"# extract the city and state\ndf_z_aff[['City', 'State']] = df_z_aff['RegionName'].apply(lambda x: split_region(x))\ndf_z_aff.head()","35551203":"# read in a city-to-lat\/lon lookup table\ndf_geo = pd.read_csv(os.path.join(data_dir,'us_city_lookup.csv'))","34bec402":"# join the lat\/lon data with the PIR dataset\ndf_z_aff_geo = df_z_aff.merge(df_geo[['city', 'state_id', 'population', 'lat', 'lng']], how='inner', left_on=['City','State'], right_on=['city','state_id'])\ndf_z_aff_geo['population'] = df_z_aff_geo['population'].apply(lambda x: x**.45)\ndf_z_aff_geo.head()","2551e758":"print('max pop: {0} | min pop: {1}'.format(df_z_aff_geo['population'].max(), df_z_aff_geo['population'].min()))","2d8d1ad0":"# population isn't critical to this analysis, but the NaNs are problematic so just fill with mean\ndf_z_aff_geo['population'] = df_z_aff_geo['population'].fillna(df_z_aff_geo['population'].mean())","01779497":"# show the data with plotly; red color = 5.0 PIR \ndef show_map_for_year(df, year):\n    data = []\n    df_yr = df[(df['date'].dt.year == year)&(df['date'].dt.month == 9)]\n    data = [\n        dict(\n            type = 'scattergeo',\n            locationmode = 'USA-states',\n            lon = df_yr['lng'],\n            lat = df_yr['lat'],\n            text = [\"{1}<br>price-to-income: {0:0.1f}\".format(x[1][1],x[1][0]) for x in df_yr[['RegionName','pir']].iterrows()],\n            mode = \"markers\",\n            marker = dict(\n                cmin=1,\n                cmax=5,\n                colorscale=[[0, \"rgb(0,255,50)\"],[1,\"Red\"]],\n                size = df_yr['population'],\n                color = df_yr['pir'],\n                line = dict(width=0.5, color='rgb(40,40,40)'),\n                sizemode = 'area',\n                sizeref=2.*df_z_aff_geo['population'].max()\/(20.**2),\n                showscale=True,\n            ),\n            name='blah'\n        )\n    ]\n\n    layout = dict(\n            title = '{0} Price to Income ratio (red = 5.0 PIR)'.format(year),\n            showlegend = False,\n            geo = dict(\n                scope='usa',\n                projection=dict( type='albers usa' ),\n                showland = True,\n                landcolor = 'rgb(217, 217, 217)',\n                subunitwidth=1,\n                countrywidth=1,\n                subunitcolor=\"rgb(255, 255, 255)\",\n                countrycolor=\"rgb(255, 255, 255)\"\n            ),\n        )\n\n    fdata = dict(data=data, layout=layout)\n    return fdata\n","2e48086b":"fdata = show_map_for_year(df_z_aff_geo, 1980)\npy.offline.iplot(fdata)\n","bdb7c325":"fdata = show_map_for_year(df_z_aff_geo, 2017)\npy.offline.iplot(fdata)","ccc6944d":"How about Pearson correlation? ","859d7eb1":"# Affordability 1: Housing Prices vs Income by Income Tiers","01018b5e":"More evidence that the house price index tracks very closely to the upper income tiers.  ","60d6ed25":"To the naked eye it appears that slope of the housing index trend tracks most closely to the 95th percentile income.  It also looks like house price tends to lead income; perhaps incomes have to increase to enable companies to attract employees to rising-cost areas?  It also looks like the 2004-2008 bubble is an anomaly. ","421e8505":"The charts below show heatmaps of price-to-income rations in cities across the US.  The first shows the situation in 1980, the second in 2017.  ","9a31e9ed":"The graphs below shows the maximum house price for each income tier based on after-tax income.   The first graph uses the mortgage industry's aggresive 35% threshold.  The second uses a more conservative 25% recommended threshold.   \n\nNote that, for this analysis, I didn't consider \"House Buying Power\" as I did above, so the amounts are likely overstated for the lower income tiers.","a79b3a36":"Going back to home price index and the slope post 1967, how does it compare with house buying power by tier?","d58b9a08":"The conclusion so far: the upper quintile of households are roughly tracking home prices but only the 95th percentile seems to be really keeping up.  Middle income and lower income households are rapidly falling behind.\n\nWhere to go from here?  One could argue that the highest earning households are essentially acting as \"market makers\" - as they bid up the price of housing in prime areas (best schools, highest quality of life, etc.), they're dragging up the overall market.  I'm not sure though - the strong correlation between upper income tiers and the national housing index doesn't show causality; it could be that rising real-estate prices are forcing employers to pay more for top talent.  Or maybe both are tracking another factor.\n\nIt could also be that housing has been seriously historically underpriced as a percentage of income and what we're seeing is a natural adjustment.  Let's look at that.\n","f5cf329b":"1. Housing is expensive by historical standards.\n2. Housing prices seem to track only with the highest income tiers; for most households, home purchasing is becoming increasingly inaccessible.\n3. Even higher income tiers are having to dig deeper to afford housing in many markets.\n\nSo, some hypotheses to explore:\n- Housing prices are being driven by high income earners.\n- Higher tier incomes are rapidly increasing to keep up with housing costs.\n- Income and housing aren't directly connected.\n\nCases 2 and 3 above beg the question: what is driving national housing prices?  Some hypotheses:\n- Supply and demand forces; i.e. low supply.\n- U.S. wealth external to income.\n- International investment.\n- Migration from ultra-high-cost areas. (Unlikely as the nation is a zero-sum.)\n.\n","73790943":"In 1967, people in the top income tiers had ~6x more income than those in the 20th percentile.  By 2017 the ratio increased to close to 10X.  \n\nWhen considering home buying power, however, I think this paints an unfair picture. Everyone has to spend money on other neccessities - food and water come to mind - before they have money available to spend on realizing the dream of home ownership.  To be fair I don't know exactly what that number is, so I'll use the federal poverty line as the measure; basically, anyone at the poverty line is probably not thinking about buying a house.  Accoring to the US Census Bureau, average household size in the US was 2.58 in 2010, so I'll use the historical poverty line tables for (imputed) 2.5 people, subtract that from the income threshold tables and redo the analysis above.","147b7171":"# Affordability 2: What Can People Afford to Pay?","60e875b9":"# Housing Prices per Case-Schiller","754e0437":"The coastal markets and rocky mountain states appear to have become less affordable; there are few markets below the 3.8 PIR that reflects the 25% mortgage-to-earnings guideline.  The midwest seems to be more affordable.  And California is off the charts with several markets north of 7.  \n\nHow to interpret this?  \n\nAffordability has decreased over time, but in most markets houses are still at or under the 5.5 PIR (based on median income) target that seems to be the threshold of affordability.  Now, to be fair, that means that half of the people can't afford a house, and a fair number of the remaining people will be pushing the limit.  \n\nSo, more questions than answers.  It could be that the standard bank measures of \"affordability\" are crap - after all, who really wants to spend 1\/3 of their net income on housing?  If that's the case, then the maps above start to paint a pretty dire picture.\n\nI have to wonder if median income doesn't paint a fair picture.  The reality of the t20 income tier will be radically different than that of the t80.  So what does it meant to look only at the median? \n\nHmm.\n\nOne thing that jumped out at me - I expect I could overlay a political heatmap over the housing PIR heat map and there would be a strong correlation; the high PIR markets are heavliy congregated in left leaning states, and low PIR markets often in right leaning states.  But that's a question for another day.\n","6a2a124a":"Let's fit a polynomial to this section of the graph to get a feel for the general trend (and maybe smooth out the 2008 bubble).","77f6fcc7":"Compared to 1890 (index 100), housing in 2019 is roughly 1.6x higher on the index.  More interesting, though, is the unprecedented spike pre-saging the 2008 financial crisis and the new spike forming over the last few years.\n\nZooming in on the period on 1967 to 2017 (to match our income data below): ","2f854f82":"First let's look at the Schiller national housing price index. ","6f084c29":"# Affordability 3: Actual Housing Price-to-Income Ratios Across the US","f83202dd":"Based on this, it seems that a household at roughly the mean for the US should be able to afford a house in the $300K-$400K range depending on the mortgage-to-income ratio.  \n\nIf we divide the max house by base income (before taxes), we find that the 35% threshold equates to a price-to-income-ratio of roughly 5.5 and the 25% threshold to a price-to-income-ratio of roughly 3.8.  In other words, most people should be fine in areas below a 3.8 price to income ration, maybe affordable between 3.8 and 5.5, and most people will struggle to buy a house in cities above 5.5.\n\nHow does this compare to actual situation in the US?","b0a2a520":"Looks great for the people in 80th and 95th percentile, but not so good for the reast.  To see the impact of the growing spread between the tiers, let's look at the ratio of the lowest (20th percentile) income tier to the others over time.","48fdd9ee":"Housing is getting more expensive, but if it tracks with wage growth or wealth accumulation, maybe that's no big deal.  In this section we'll look at earnings and compare to housing price growth or, more specifically, \"house buying power\" by analyzing US Census data on income quintile thresholds since 1967.","3c9ffe68":"The chart below shows U.S. household earnings by five income tiers - 20th, 40th, 60th, 80th and 95th percentiles - since 1967:","8fa7327f":"Here we see that, after adjusting to get a better value representing money available for housing, the upper percentiles have 15-40X more to spend than the 20th percentile.  That's a lot more house that the 20%.","a0597973":"Ok, so it seems that, from a historical perspective, housing is expensive.  There's been some cyclic growth since 1970, but the growth seems to have become exponential over the past 15-20 years. ","82916ed8":"I've been curious for quite some time as to why US housing prices don't seem to track with the generally stagnant wages over the last few decades - after all, people earning wages are the ones buying houses, so one would expect at least some correlation.  Obviously there are other factors at play.  \n\nAs luck would have it, I recently moved to Colorado and have been shocked at the cost of housing, especially given the poor quality of the inventory available.  When I ask locals why the price of houses have nearly doubled in the last four years, I get theories ranging from the oil boom in eastern Colorado to the migration of Californians to Rockies.  While those may have some effect, they don't explain the similar phenomena in the many other states and cities experiencing similar pricing growth.  There must be something more.\n\nSo I decided to take a closer look at the numbers to get a better feel for the what's and the why's.  Ultimately I'd like to answer some of the following questions:\n-  What are key factors driving housing prices nationally?\n-  Who can actually afford a house?  Who can't?\n-  Are home prices in a bubble?  Or were they artificially low and have recently corrected?\n-  Is there likely to be a backlash and correction?\n\nHere's how I'll procede:\n- Look at house prices from a historical perspective to guage whether current prices are \"expensive\" or not.\n- Compare housing prices trends with income trends and look for correlations (or, better yet, some evidence of causality).\n- Get a feel for the impact of housing prices on housholds by income tier.\n\n","41e61fca":"Hmm.  This paints a very different picture than raw income.  In terms of \"leftover\" money available to purchase housing once basic living expenses are accounted for, the 20, 40 and 60 percentiles are actually seeing their buying\/renting power decrease over time.  ","42dacbc0":"While the prices are clearly tracking with the highest income tiers, maybe it doesn't matter if it's still affordable to everyone.  As a baseline, I'll take actual income data, federal tax rates and common banking rules to assess how much house a person *should* be able to afford. ","93084277":"# Conclusions (so far)"}}