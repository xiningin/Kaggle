{"cell_type":{"cfc7ca70":"code","2aa8ac7a":"code","e8fbfa67":"code","6ada9751":"code","1aa2602d":"markdown","4670c8a7":"markdown","84e5742a":"markdown","c5420b1f":"markdown","2d206808":"markdown"},"source":{"cfc7ca70":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nplt.style.use(\"default\")\nfrom sklearn.model_selection import TimeSeriesSplit","2aa8ac7a":"%%time\n\npath = \"..\/input\/cleaning-riiid-dataset-add-part-of-toeic-test\/reduced_riiid_train.pkl.gzip\"\ntrain = pd.read_pickle(path)\ntrain = train.astype({'row_id': 'int64',\n                      'timestamp': 'int64',\n                      'user_id': 'int32',\n                      'content_id': 'int16',\n                      'content_type_id': 'int8',\n                      'task_container_id': 'int16',\n                      'user_answer': 'int8',\n                      'answered_correctly': 'int8',\n                      'prior_question_elapsed_time': 'float32',\n                      'prior_question_had_explanation': 'boolean'})\ntrain.info()","e8fbfa67":"train = train.sort_values(by=['part', 'timestamp'])\n\ncol = ['part', 'timestamp', 'row_id', 'user_id', 'content_id', 'content_type_id',\n       'task_container_id', 'user_answer', 'answered_correctly',\n       'prior_question_elapsed_time', 'prior_question_had_explanation',\n       'question_id']\ntrain[col].set_index('row_id')","6ada9751":"# Initialisation du TSCV\nn_iter = 5\ntscv = TimeSeriesSplit(n_splits=n_iter)\n\n# Echantillonnage\ntrain_lst = []\nval_lst = []\n\nfor train_index, val_index in tscv.split(train):\n    train_lst.append(train_index[-1])\n    val_lst.append(val_index[-1] - val_index[0])\n    \n    # X_train, X_test = X.iloc[train_index], X.iloc[val_index]\n    # y_train, y_test = y.iloc[train_index], y.iloc[val_index]\n\ntrain_tpl = tuple(train_lst)\nval_tpl = tuple(val_lst)\n\n# Tracage de l'\u00e9chantillon\nind = np.arange(n_iter) + 1\nwidth = 0.35\n\nbtrain = plt.barh(ind, train_tpl, width)\nbval = plt.barh(ind, val_tpl, width, left=train_tpl)\n\nplt.yticks(ind)\nplt.gca().invert_yaxis()\nplt.legend((btrain, bval), (\"train\", \"val\"))\nplt.title('Sample Cross Validation')\nplt.ylabel('Interaction CV')\nplt.xlabel('Index')\nplt.savefig('.\/img_cross_validation.png', transparent=True)\nplt.show()","1aa2602d":"I want to split like this below \u2b07\ufe0f\u2b07\ufe0f","4670c8a7":"Hi everybody \ud83d\udd90\ud83d\udd90\nThe preliminary work for this notebook is located here [Cleaning Riiid! dataset & add part of TOEIC test](https:\/\/www.kaggle.com\/adrian1903\/cleaning-riiid-dataset-add-part-of-toeic-test)","84e5742a":"I am considering a cross validation \u2705 on this project, with \u23f2 TimeSeriesSplit(). \n\nWe have a time series which is timestamp. We can consider a second variable, which can be considered as a time series, parts of TOEIC test. We can isolate every block. \nAt least for the written (5, 6, 7) and oral parts (1, 2, 3, 4).\n\nBelow my approach :","c5420b1f":"In my opinion \ud83d\udcad it is necessary to treat the parts individually in CV, because :\n- there are several levels of difficulty,\n- the sizes of the parts are heterogeneous,\n- these are exercises to listen to and read.\n\nAnd you \u2753 What do you think \u2753","2d206808":"If you made it to the point thank you for reading and \ud83c\udd99 vote if it helped you. I will read your comments with pleasure.\n\nThanks"}}