{"cell_type":{"200da08d":"code","da2404d0":"code","eaa270fa":"code","a1015c55":"code","c769cdf5":"code","4dc0abac":"code","cf5a48c6":"code","afe062ad":"code","0558b829":"code","ae4a2c37":"code","d3c376c9":"code","e0d2c6ef":"code","30508aff":"code","6cc06164":"code","0f896155":"code","38f2e5ed":"code","edc02a50":"code","dd5f5ae8":"code","3aaf21d8":"code","046bc333":"code","0834490a":"code","887cd16a":"code","c2c25c53":"code","65217e37":"code","7e093505":"code","959a2726":"code","5ee04c20":"code","dbcac656":"code","7eaf7f8c":"code","be0cb2a0":"code","e8154ccd":"code","3d711a11":"code","722d1c09":"code","c4d59bfb":"code","7a5bc690":"code","2d6a7039":"code","eca3dbcf":"code","39d267ca":"code","e00ac5e7":"code","1cadf353":"code","a9f7d5d3":"code","1283ec2e":"code","84ee853c":"code","12fcff61":"code","49d2f7fa":"code","8ec5d0fb":"code","bbdff04f":"code","e956d5c8":"code","22d0d446":"markdown","040b1eac":"markdown","7f95f61a":"markdown","b5645cc0":"markdown","38daf350":"markdown","46538e7e":"markdown","8fd1f376":"markdown","62b40baa":"markdown","9cd936dc":"markdown","e67fa6fc":"markdown","6e973b33":"markdown","2651becd":"markdown","c085fd13":"markdown","41132006":"markdown","e267dccb":"markdown","865cb564":"markdown","d12165c6":"markdown","485cd6f2":"markdown","fd0e9d36":"markdown","02ea9167":"markdown","b4258931":"markdown","2359061e":"markdown","8e143770":"markdown","52677847":"markdown","2a5baa66":"markdown"},"source":{"200da08d":"import os\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt \nimport seaborn as sns\nimport plotly.express as px","da2404d0":"for dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","eaa270fa":"df = pd.read_csv('\/kaggle\/input\/hotel-booking-demand\/hotel_bookings.csv')\ndf.head()","a1015c55":"df.shape","c769cdf5":"df.describe().T","4dc0abac":"df.info()","cf5a48c6":"df.isnull().sum()","afe062ad":"df['country'].fillna('PRT',inplace=True)\ndf.fillna(0,inplace=True)\ndf.isnull().values.any()","0558b829":"df.hotel.unique()","ae4a2c37":"resort = df[(df['hotel']=='Resort Hotel') & (df['is_canceled']==0)]\ncity   = df[(df['hotel']=='City Hotel')   &  (df['is_canceled']==0)]","d3c376c9":"resort.head()","e0d2c6ef":"resort.shape","30508aff":"city.head()","6cc06164":"city.shape","0f896155":"import plotly.graph_objs as go\nfrom plotly.offline import iplot\n\nlabel = resort['country'].value_counts().index\nvalue = resort['country'].value_counts()\n\niplot([go.Pie(labels=label,values=value,hoverinfo='label+percent',textinfo='value')])","38f2e5ed":"data_country = df[df['is_canceled']==0]['country'].value_counts().reset_index()\ndata_country.columns = ['Country','No.of Guests']\ndata_country","edc02a50":"px.choropleth(data_country,locations=data_country['Country'],color=data_country['No.of Guests'],hover_name=data_country['Country'],title='Home Country of Guests')","dd5f5ae8":"plt.figure(figsize=(15,10))\nsns.boxplot(data=df[df['is_canceled'] == 0],x='reserved_room_type',y='adr',hue='hotel')\nplt.title('Price Of Room Types Per Night')\nplt.xlabel('Type Of Room')\nplt.ylabel('Price Per Night')\nplt.show()","3aaf21d8":"def data(df):\n    data = df[df['is_canceled']==0].groupby('arrival_date_month')['adr'].mean().reset_index()\n    return data","046bc333":"data2 = data(resort)","0834490a":"data2 = data2.merge(data(city),on='arrival_date_month')\ndata2.head()","887cd16a":"data2.columns = ['month','price_for_resort','price_for_city']\ndata2","c2c25c53":"! pip install sorted-months-weekdays\n! pip install sort-dataframeby-monthorweek","65217e37":"from sorted_months_weekdays import *\nfrom sort_dataframeby_monthorweek import *\n\n\nfinal = Sort_Dataframeby_Month(df=data2,monthcolumnname='month')","7e093505":"px.line(final,x='month',y=['price_for_resort','price_for_city'],title='Room price per night over the year')","959a2726":"plt.figure(figsize=(15,10))\nsns.boxplot(data=df[df['is_canceled'] == 0],x='market_segment',y='stays_in_weekend_nights',hue='hotel')\nplt.ylabel('Num Of Nights')\nplt.show()","5ee04c20":"plt.figure(figsize=(10,8))\nsns.barplot(x=df[df['is_canceled']==0].groupby('market_segment')['stays_in_weekend_nights'].count().index,\n            y=df[df['is_canceled']==0].groupby('market_segment')['stays_in_weekend_nights'].count())","dbcac656":"df['meal'].unique()","7eaf7f8c":"px.pie(data_frame=df[df['is_canceled']==0],names=df['meal'].value_counts().index,values=df['meal'].value_counts())","be0cb2a0":"sns.countplot(x=df.total_of_special_requests)  ","e8154ccd":" 100 * len(df[df['total_of_special_requests'] == 0]) \/ len(df)","3d711a11":"df.groupby(['total_of_special_requests','is_canceled']).agg({'total_of_special_requests':'count'}).unstack()","722d1c09":"plt.figure(figsize=(10,8))\nsns.countplot(data=df,x='total_of_special_requests',hue='is_canceled')","c4d59bfb":"df.arrival_date_year.unique()","7a5bc690":"df.arrival_date_month.value_counts()","2d6a7039":"df.groupby(['arrival_date_year','arrival_date_month']).agg({'is_canceled':'count'}).unstack()","eca3dbcf":"plt.figure(figsize=(20,15))\nsns.countplot(data=df,x='arrival_date_month',hue='arrival_date_year')\nplt.title('Num Of Guests In Each Month')\nplt.xlabel('Months')\nplt.ylabel('Num of Guests')","39d267ca":"100 * df.corr()['is_canceled'].sort_values()","e00ac5e7":"plt.figure(figsize=(20,15))\nsns.heatmap(df.corr(),annot=True)","1cadf353":"df.columns","a9f7d5d3":"df = df.drop_duplicates()\nlen(df)","1283ec2e":"label = ['company','agent','total_of_special_requests','required_car_parking_spaces','booking_changes',\n         'is_repeated_guest','reservation_status_date','stays_in_weekend_nights','stays_in_week_nights',\n         'reserved_room_type','assigned_room_type','adults','children','babies']\ndf.drop(labels=label,axis=1,inplace=True)\ndf.head()","84ee853c":"X = df.drop(['is_canceled'],axis=1)\ny = df['is_canceled']","12fcff61":"X = pd.get_dummies(X,drop_first=True)","49d2f7fa":"from sklearn.model_selection import train_test_split\nX_train , X_test , y_train , y_test = train_test_split(X,y,test_size=0.25,random_state=42)","8ec5d0fb":"# LogisticRegression\nfrom sklearn.linear_model import LogisticRegression\nlog = LogisticRegression(solver='liblinear')\nlog.fit(X_train,y_train)\n#Print the model accuracy of training data\nprint('Logistic Regression Training Accuracy : ',log.score(X_train, y_train))","bbdff04f":"from sklearn.metrics import confusion_matrix , accuracy_score\ncm = confusion_matrix(y_test,log.predict(X_test))\nprint(cm)\nprint('Accuracy ',accuracy_score(y_test,log.predict(X_test)))\n","e956d5c8":"from sklearn.metrics import classification_report\nprint(classification_report(y_test,log.predict(X_test)))\n    ","22d0d446":"## Selection model","040b1eac":"#### In 2015 the most number of guests come at **September**\n\n#### In 2016 the most number of guests come at **October**\n\n#### In 2017 the most number of guests come at **May**","7f95f61a":"#### Resort-Hotel prices are much higher during the summer,whereas the prices of City-Hotel doesn't get much higher in summer ","b5645cc0":"## Which months guests are high?","38daf350":"\n## How does the price of room per night vary over the year?","46538e7e":"## Where do the guests come from & Perform spatial analysis","8fd1f376":"## Analysing preference of guests","62b40baa":"# Dataset Detailes","9cd936dc":"## Analysing relationship between special requests and cancellation","e67fa6fc":"In the column `agent` has many missing values. It means that the reservation was mostly made by a person \n\nIn the column `company` has many missing values. It means it is mostly like private","6e973b33":"## Handel the missing values","2651becd":"# Load and Overview on the dataset","c085fd13":"# Modeling","41132006":"#### Most people don't seem to prefer to stay at the hotel more than one week","e267dccb":"#### The online travel agents are the best market for reservation by people","865cb564":"# Business Problem\n### An Online travel booking company is suffering from loss in revenue because of the uncertain booking cancelation of its customers. The company wants to know which customer will cancel the booking. \n\n### As a data-scientist we have to help the company to predict whether the customer will cancel the booking or not.We have all the booking details like **arrival_date_year**, **stays_in_week_nights**, **arrival_date_day_of_month** etc of the customers from various countries.\n\n### We have to do some data analysis to answer some questions and we have to work on Machine Learning models to help predict whether the customer will cancel the booking or not.We will focus on Exploratory Data Analysis for answering business questions first and then move on to the prediction approach.","d12165c6":"## In the end , we find that **LogisiticRegression** is more accurate ","485cd6f2":"#### The guests are prefered to booked meal **BB** Bed & Breakfast","fd0e9d36":"#### Distribution of price of each room type","02ea9167":" `0   hotel`                           (H1 = Resort Hotel or H2 = City Hotel)    \n \n `1   is_canceled`                     Value indicating if the booking was canceled (1) or not (0)          \n \n `2   lead_time`                   Number of days that elapsed between the entering date of the booking into the PMS and the arrival date\n \n `3   arrival_date_year`             Year of arrival date\n \n `4   arrival_date_month`              Month of arrival date\n \n `5   arrival_date_week_number`        Week number of year for arrival date\n \n `6   arrival_date_day_of_month`        Day of arrival date\n \n `7   stays_in_weekend_nights`          Number of weekend nights (Saturday or Sunday) the guest stayed or booked to stay at the hotel\n \n `8   stays_in_week_nights`             Number of week nights (Monday to Friday) the guest stayed or booked to stay at the hotel\n \n `9   adults`                            Number of adults\n \n `10  children`                        Number of children\n \n `11  babies`           Number of babies               \n \n `12  meal`                            Type of meal booked. Categories are presented in standard hospitality meal packages: Undefined\/SC \u2013 no meal \n \n `13  country`                          Country of origin. Categories are represented in the ISO 3155\u20133:2013 format\n \n `14  market_segment`    Market segment designation. In categories, the term \u201cTA\u201d means \u201cTravel Agents\u201d and \u201cTO\u201d means \u201cTour Operators\u201d              \n \n `15  distribution_channel`       Booking distribution channel. The term \u201cTA\u201d means \u201cTravel Agents\u201d and \u201cTO\u201d means \u201cTour Operators\u201d      \n \n `16  is_repeated_guest`               Value indicating if the booking name was from a repeated guest (1) or not (0)\n \n `17  previous_cancellations`          Number of previous bookings that were cancelled by the customer prior to the current booking\n \n `18  previous_bookings_not_canceled` Number of previous bookings not cancelled by the customer prior to the current booking\n \n `19  reserved_room_type`               Code of room type reserved. Code is presented instead of designation for anonymity reasons.\n \n `20  assigned_room_type`Code for the type of room assigned to the booking.Code is presented instead of designation for anonymity reasons.\n \n `21  booking_changes` Number of changes made to the booking from the moment the booking was entered on the PMS until the moment of check-in or out\n \n `22  deposit_type`  Indication on if the customer made a deposit to guarantee the booking. This variable can assume three categories: No \n \n `23  agent`       ID of the travel agency that made the booking                   \n \n `24  company` ID of the company that made the booking or responsible for paying the booking. \n \n `25  days_in_waiting_list` Number of days the booking was in the waiting list before it was confirmed to the customer           \n \n `26  customer_type`    Type of booking, assuming one of four categories:Transient - Transient-Party - Contract - Group               \n \n `27  adr`                    Average Daily Rate as defined by dividing the sum of all lodging transactions by the total number of staying nights\n \n `28  required_car_parking_spaces`       Number of car parking spaces required by the customer\n \n `29  total_of_special_requests`Number of special requests made by the customer (e.g. twin bed or high floor)      \n \n `30  reservation_status`       Reservation last status, assuming one of three categories: Canceled \u2013 booking was canceled by the customer; Check-Out\n \n `31  reservation_status_date ` Date at which the last status was set. This variable can be used in conjunction with the ReservationStatus to ","b4258931":"## How much do guests pay for a room per night?","2359061e":"# EDA","8e143770":"#### It seems this is almost 60 percent of the bookers don't have any special requests","52677847":"# Import the Libraries","2a5baa66":"## Distribution of nights spent at hotels by market segment and hotel type"}}