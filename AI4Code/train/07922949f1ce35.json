{"cell_type":{"449e11dc":"code","bc1463dd":"code","ecb3ad93":"code","40eaca1d":"code","a148da5b":"code","0fef50ff":"code","f8172741":"code","6e6e5b2b":"code","f1d76e1c":"code","9159ae6a":"code","c2763fa8":"code","399a7519":"code","d8b8f29a":"code","064ba656":"code","8bcb29f4":"code","bf26a35f":"code","749ab6c9":"code","a7375bdc":"code","f4c42c71":"code","14f44601":"code","0389ddf1":"code","a0f52f51":"code","7412adaf":"code","935ef737":"code","5d0ddc0f":"code","09b2c04a":"code","88b53728":"code","3b928b97":"code","7fea5d34":"code","958156ae":"code","0c0e8dca":"code","d960c5b5":"code","b62337ea":"code","d016ca68":"code","cec09185":"code","0dfa18f1":"code","0a6017de":"code","542e5cf9":"code","d73d1f5f":"code","04b84bea":"code","14519c17":"code","2cf5bd02":"code","e9b8184a":"code","9dfd1969":"markdown","d7ae7ce5":"markdown","adc1577f":"markdown","0f2cb0e4":"markdown","10e23756":"markdown","16ac570d":"markdown","3eaf5d4c":"markdown","02b35e03":"markdown","18f8fe94":"markdown","c0a30c6d":"markdown","728ef962":"markdown","eedb8a2b":"markdown","1830e0d9":"markdown","c9f8d823":"markdown","0927a535":"markdown","e49d74be":"markdown","0e304468":"markdown","ae449c8a":"markdown","8e42d840":"markdown","7aa2ab6c":"markdown","9225db18":"markdown","ea8f08cb":"markdown","b16e0c7c":"markdown","cc02af90":"markdown"},"source":{"449e11dc":"#Importing Libraries\nimport numpy as np\nimport pandas as pd\nimport seaborn as sb\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import classification_report\nfrom sklearn.metrics import confusion_matrix\nfrom sklearn.metrics import r2_score","bc1463dd":"import os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","ecb3ad93":"#reading the dataset\nzomato_real=pd.read_csv(\"..\/input\/zomato-bangalore-restaurants\/zomato.csv\")\nzomato_real.head() # prints the first 5 rows of a DataFrame","40eaca1d":"zomato_real.info() # Looking at the information about the dataset, datatypes of the coresponding columns and missing values","a148da5b":"#Deleting Unnnecessary Columns\nzomato=zomato_real.drop(['url','dish_liked','phone'],axis=1) #Dropping the column \"dish_liked\", \"phone\", \"url\" and saving the new dataset as \"zomato\"","0fef50ff":"zomato_real.head() # looking at the dataset after transformation ","f8172741":"#Removing the Duplicates\nzomato.duplicated().sum()\nzomato.drop_duplicates(inplace=True)\nzomato_real.head() # looking at the dataset after transformation","6e6e5b2b":"#Remove the NaN values from the dataset\nzomato.isnull().sum()\nzomato.dropna(how='any',inplace=True)\nzomato.info() #.info() function is used to get a concise summary of the dataframe","f1d76e1c":"#Reading Column Names\nzomato.columns","9159ae6a":"#Changing the column names\nzomato = zomato.rename(columns={'approx_cost(for two people)':'cost','listed_in(type)':'type',\n                                  'listed_in(city)':'city'})\nzomato.columns","c2763fa8":"#Some Transformations\nzomato['cost'] = zomato['cost'].astype(str) #Changing the cost to string\nzomato['cost'] = zomato['cost'].apply(lambda x: x.replace(',','.')) #Using lambda function to replace ',' from cost\nzomato['cost'] = zomato['cost'].astype(float) # Changing the cost to Float\nzomato.info() # looking at the dataset information after transformation","399a7519":"#Reading uninque values from the Rate column\nzomato['rate'].unique()","d8b8f29a":"#Removing '\/5' from Rates\nzomato = zomato.loc[zomato.rate !='NEW']\nzomato = zomato.loc[zomato.rate !='-'].reset_index(drop=True)\nremove_slash = lambda x: x.replace('\/5', '') if type(x) == np.str else x\nzomato.rate = zomato.rate.apply(remove_slash).str.strip().astype('float')\nzomato['rate'].head() # looking at the dataset after transformation","064ba656":"# Adjust the column names\nzomato.name = zomato.name.apply(lambda x:x.title())\nzomato.online_order.replace(('Yes','No'),(True, False),inplace=True)\nzomato.book_table.replace(('Yes','No'),(True, False),inplace=True)\nzomato_real.head() # looking at the dataset after transformation\n","8bcb29f4":"zomato.cost.unique() # cheking the unique costs","bf26a35f":"#Encode the input Variables\ndef Encode(zomato):\n    for column in zomato.columns[~zomato.columns.isin(['rate', 'cost', 'votes'])]:\n        zomato[column] = zomato[column].factorize()[0]\n    return zomato\n\nzomato_en = Encode(zomato.copy())\nzomato_en.head() # looking at the dataset after transformation","749ab6c9":"#Get Correlation between different variables\ncorr = zomato_en.corr(method='kendall')\nplt.figure(figsize=(15,8))\nsns.heatmap(corr, annot=True)\nzomato_en.columns","a7375bdc":"#Defining the independent variables and dependent variables\nx = zomato_en.iloc[:,[2,3,5,6,7,8,9,11]]\ny = zomato_en['rate']\n#Getting Test and Training Set\nx_train,x_test,y_train,y_test=train_test_split(x,y,test_size=.1,random_state=353)\nx_train.head()","f4c42c71":"y_train.head()","14f44601":"zomato_en['menu_item'].unique() # seeing the unique values in 'menu_item'","0389ddf1":"zomato_en['location'].unique() # seeing the unique values in 'location'","a0f52f51":"zomato_en['cuisines'].unique() # seeing the unique values in 'cusines'","7412adaf":"zomato_en['rest_type'].unique() # seeing the unique values in 'rest_type'","935ef737":"x.head()","5d0ddc0f":"y.head()","09b2c04a":"#Restaurants delivering Online or not\nsns.countplot(zomato['online_order'])\nfig = plt.gcf()\nfig.set_size_inches(10,10)\nplt.title('Restaurants delivering online or Not')","88b53728":"sns.countplot(zomato['book_table'])\nfig = plt.gcf()\nfig.set_size_inches(10,10)\nplt.title('Restaurants allowing table booking or not')","3b928b97":"plt.rcParams['figure.figsize'] = (13, 9)\nY = pd.crosstab(zomato['rate'], zomato['book_table'])\nY.div(Y.sum(1).astype(float), axis = 0).plot(kind = 'bar', stacked = True,color=['red','yellow'])\nplt.title('table booking vs Normal rate', fontweight = 30, fontsize = 20)\nplt.legend(loc=\"upper right\")\nplt.show()","7fea5d34":"sns.countplot(zomato['city'])\nsns.countplot(zomato['city']).set_xticklabels(sns.countplot(zomato['city']).get_xticklabels(), rotation=90, ha=\"right\")\nfig = plt.gcf()\nfig.set_size_inches(13,13)\nplt.title('Location wise count for restaurants')","958156ae":"loc_plt=pd.crosstab(zomato['rate'],zomato['city'])\nloc_plt.plot(kind='bar',stacked=True);\nplt.title('Locationwise Rating',fontsize=15,fontweight='bold')\nplt.ylabel('Location',fontsize=10,fontweight='bold')\nplt.xlabel('Rating',fontsize=10,fontweight='bold')\nplt.xticks(fontsize=10,fontweight='bold')\nplt.yticks(fontsize=10,fontweight='bold');\nplt.legend();","0c0e8dca":"sns.countplot(zomato['rest_type'])\nsns.countplot(zomato['rest_type']).set_xticklabels(sns.countplot(zomato['rest_type']).get_xticklabels(), rotation=90, ha=\"right\")\nfig = plt.gcf()\nfig.set_size_inches(15,15)\nplt.title('Restuarant Type')","d960c5b5":"loc_plt=pd.crosstab(zomato['rate'],zomato['rest_type'])\nloc_plt.plot(kind='bar',stacked=True);\nplt.title('Rest type - Rating',fontsize=15,fontweight='bold')\nplt.ylabel('Rest type',fontsize=10,fontweight='bold')\nplt.xlabel('Rating',fontsize=10,fontweight='bold')\nplt.xticks(fontsize=10,fontweight='bold')\nplt.yticks(fontsize=10,fontweight='bold');\nplt.legend().remove();","b62337ea":"sns.countplot(zomato['type'])\nsns.countplot(zomato['type']).set_xticklabels(sns.countplot(zomato['type']).get_xticklabels(), rotation=90, ha=\"right\")\nfig = plt.gcf()\nfig.set_size_inches(15,15)\nplt.title('Type of Service')","d016ca68":"type_plt=pd.crosstab(zomato['rate'],zomato['type'])\ntype_plt.plot(kind='bar',stacked=True);\nplt.title('Type - Rating',fontsize=15,fontweight='bold')\nplt.ylabel('Type',fontsize=10,fontweight='bold')\nplt.xlabel('Rating',fontsize=10,fontweight='bold')\nplt.xticks(fontsize=10,fontweight='bold')\nplt.yticks(fontsize=10,fontweight='bold');","cec09185":"sns.countplot(zomato['cost'])\nsns.countplot(zomato['cost']).set_xticklabels(sns.countplot(zomato['cost']).get_xticklabels(), rotation=90, ha=\"right\")\nfig = plt.gcf()\nfig.set_size_inches(15,15)\nplt.title('Cost of Restuarant')","0dfa18f1":"fig = plt.figure(figsize=(20,7))\nloc = sns.countplot(x=\"location\",data=zomato_real, palette = \"Set1\")\nloc.set_xticklabels(loc.get_xticklabels(), rotation=90, ha=\"right\")\nplt.ylabel(\"Frequency\",size=15)\nplt.xlabel(\"Location\",size=18)\nloc\nplt.title('NO. of restaurants in a Location',size = 20,pad=20)","0a6017de":"fig = plt.figure(figsize=(17,5))\nrest = sns.countplot(x=\"rest_type\",data=zomato_real, palette = \"Set1\")\nrest.set_xticklabels(rest.get_xticklabels(), rotation=90, ha=\"right\")\nplt.ylabel(\"Frequency\",size=15)\nplt.xlabel(\"Restaurant type\",size=15)\nrest \nplt.title('Restaurant types',fontsize = 20 ,pad=20)","542e5cf9":"plt.figure(figsize=(15,7))\nchains=zomato_real['name'].value_counts()[:20]\nsns.barplot(x=chains,y=chains.index,palette='Set1')\nplt.title(\"Most famous restaurant chains in Bangaluru\",size=20,pad=20)\nplt.xlabel(\"Number of outlets\",size=15)","d73d1f5f":"#Prepare a Linear Regression Model\nreg=LinearRegression()\nreg.fit(x_train,y_train)\ny_pred=reg.predict(x_test)\nfrom sklearn.metrics import r2_score\nr2_score(y_test,y_pred)","04b84bea":"#Prepairng a Decision Tree Regression\nfrom sklearn.tree import DecisionTreeRegressor\nx_train,x_test,y_train,y_test=train_test_split(x,y,test_size=.1,random_state=105)\nDTree=DecisionTreeRegressor(min_samples_leaf=.0001)\nDTree.fit(x_train,y_train)\ny_predict=DTree.predict(x_test)\nfrom sklearn.metrics import r2_score\nr2_score(y_test,y_predict)","14519c17":"#Preparing Random Forest REgression\nfrom sklearn.ensemble import RandomForestRegressor\nRForest=RandomForestRegressor(n_estimators=500,random_state=329,min_samples_leaf=.0001)\nRForest.fit(x_train,y_train)\ny_predict=RForest.predict(x_test)\nfrom sklearn.metrics import r2_score\nr2_score(y_test,y_predict)","2cf5bd02":"#Preparing Extra Tree Regression\nfrom sklearn.ensemble import  ExtraTreesRegressor\nETree=ExtraTreesRegressor(n_estimators = 100)\nETree.fit(x_train,y_train)\ny_predict=ETree.predict(x_test)\n\n\nfrom sklearn.metrics import r2_score\nr2_score(y_test,y_predict)","e9b8184a":"import pickle\n# Saving model to disk\npickle.dump(ETree, open('model.pkl','wb'))","9dfd1969":"### Splitting the Dataset","d7ae7ce5":"It can be observed that we have got the best accuracy for Extra tree regressor","adc1577f":"### Decision Tree Regression ","0f2cb0e4":"#### The basic idea is analyzing the <font color=blue>Buisness Problem of Zomato <\/font> to get a fair idea about the factors affecting the establishment of different types of restaurant at different places in Bengaluru, aggregate rating of each restaurant and many more. I have provided the link to download the dataset at the end of this notebook.","10e23756":"#### Restaurant Type","16ac570d":"#### Cost of Restuarant","3eaf5d4c":"#### Location and Rating","02b35e03":"#### Location","18f8fe94":"#### Gaussian Rest type and Rating","c0a30c6d":"#### Types of Services","728ef962":"#### Type and Rating","eedb8a2b":"#### Restaurants allowing table booking or not","1830e0d9":"### Linear Regression","c9f8d823":"#### The highest correlation is between name and address which is 0.62 which is not of very much concern ","0927a535":"# Breakdown of this notebook:\n1. **Loading the dataset:** Load the data and import the libraries. <br>\n2. **Data Cleaning:** <br>\n - Deleting redundant columns.\n - Renaming the columns.\n - Dropping duplicates.\n - Cleaning individual columns.\n - Remove the NaN values from the dataset\n - #Some Transformations\n3. **Regression Analysis**\n - Linear Regression\n - Decision Tree Regression\n - Random Forest Regression\n4. **Data Visualization:** Using plots to find relations between the features.\n - Restaurants delivering Online or not\n - Restaurants allowing table booking or not\n - Table booking Rate vs Rate\n - Best Location\n - Relation between Location and Rating\n - Restaurant Type\n - Gaussian Rest type and Rating\n - Types of Services\n - Relation between Type and Rating\n - Cost of Restuarant\n - No. of restaurants in a Location\n - Restaurant type\n - Most famous restaurant chains in Bengaluru ","e49d74be":"#### Restaurants delivering Online or not","0e304468":"#### Most famous Restaurant chains in Bengaluru","ae449c8a":"### Random Forest Regression","8e42d840":"#### Restaurant type","7aa2ab6c":"#### No. of Restaurants in a Location","9225db18":"# Data Visualization","ea8f08cb":"# Regression Analysis","b16e0c7c":"### Extra Tree Regressor","cc02af90":"#### Table booking Rate vs Normal Rate"}}