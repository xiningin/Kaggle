{"cell_type":{"a3bb47c0":"code","b01c5504":"code","d0b371c9":"code","c8e1b605":"code","0300b4eb":"code","c87ac87b":"code","4eb69520":"code","20ee14d8":"code","92fed51f":"code","6e1cf288":"code","fc3319c3":"code","3dd90d66":"code","656b7247":"code","8d4377b4":"code","3828f65b":"code","f9c13a99":"code","8decb3fe":"code","2b2f6326":"code","12e13146":"code","9a163813":"code","6f909baf":"code","131c6c5b":"code","c9d23d24":"code","6e93c854":"code","c16ea1bc":"code","35a68d5a":"code","2d4b1190":"code","e554e61d":"code","98718561":"code","274e4f06":"code","d92588d6":"code","f7f71b30":"code","337da9a1":"code","82af15f6":"code","a49c7b03":"code","ceeb608e":"code","242f9a4d":"code","ffb76fa4":"code","cab93e64":"code","39aa8a95":"code","4848345a":"code","3c3f255b":"code","64dc6853":"code","e2d57c37":"code","9e604f60":"code","20942ff5":"code","79c7487c":"code","506182d8":"code","5d1d5d7d":"code","dca3aaaa":"code","f32c4798":"code","8956d102":"code","91f76fa6":"code","3904ba23":"code","f3f020b7":"code","f181b767":"markdown","8f882103":"markdown","38c84679":"markdown","f59c0fe8":"markdown","18236bed":"markdown","282955cf":"markdown","f0d33d7a":"markdown","98e6731b":"markdown","6fb86f78":"markdown","d005279f":"markdown","2e934734":"markdown","ddffaca3":"markdown","b08ff012":"markdown","9ecf1735":"markdown","53cbb556":"markdown","a6a04f7e":"markdown","3e437b6b":"markdown","56b2f7fe":"markdown","c778d7a4":"markdown","40fc3c83":"markdown","975e84b0":"markdown","8fe31331":"markdown","1100bcb6":"markdown","1ee413d1":"markdown","14a94b8f":"markdown","e4251cc0":"markdown","72bfe76d":"markdown","edae0606":"markdown","b5fedd44":"markdown","0f7438c4":"markdown","f1e5e9fc":"markdown"},"source":{"a3bb47c0":"import numpy as np \nimport pandas as pd\nimport seaborn as sb\nimport plotly.express as px\nimport matplotlib.pyplot as plt\nfrom matplotlib import rcParams\nfrom plotly.subplots import make_subplots\nimport plotly.graph_objects as go\nimport datetime as dt\nimport folium\nfrom folium.plugins import MarkerCluster\nfrom plotly.offline import iplot\nimport cufflinks\ncufflinks.go_offline()\ncufflinks.set_config_file(world_readable=True, theme='pearl')\nplt.style.use('ggplot')\n\n\n\n\n\nimport warnings\nwarnings.filterwarnings('ignore')\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","b01c5504":"data = pd.read_csv('..\/input\/montcoalert\/911.csv')","d0b371c9":"data.shape","c8e1b605":"data.head()","0300b4eb":"data.tail()","c87ac87b":"data.describe()","4eb69520":"data.info()","20ee14d8":"data.sample(frac=0.00002, random_state=1)","92fed51f":"data.isnull().sum()","6e1cf288":"data.dropna(subset=['twp'], inplace=True)","fc3319c3":"data.isnull().sum()","3dd90d66":"data['timeStamp'].head(3)","656b7247":"data['timeStamp'] = pd.to_datetime(data['timeStamp'])","8d4377b4":"data['timeStamp'].head(3)","3828f65b":"data['year'] = data['timeStamp'].dt.year\ndata['day'] = data['timeStamp'].dt.day\ndata['month'] = data['timeStamp'].dt.month\ndata['dayofweek'] = data['timeStamp'].dt.dayofweek\ndata['dayofyear'] = data['timeStamp'].dt.dayofyear\ndata['hour'] = data['timeStamp'].dt.hour","f9c13a99":"data.head(3)","8decb3fe":"data['reason_cat'] = data['title'].apply(lambda x:x.split(':')[0])\ndata['reason_cat'].unique()","2b2f6326":"data['title'] = data['title'].apply(lambda x:x.split(':')[1])\n\ndata['title'] = data['title'].apply(lambda x:x.split('-')[0]).apply(lambda x:x.strip())\n\n# Now our data looks more badass\ndata['title'].unique()","12e13146":"data['title'].nunique()","9a163813":"data.columns","6f909baf":"reason = pd.DataFrame({'reason':['EMS', 'Traffic', 'Fire'], 'count':[3265850, 227045, 98797]})\nreason.style.background_gradient(cmap='Blues', subset=['count'])","131c6c5b":"# Bar Chart\nfig1 = px.bar(reason, reason['reason'], reason['count'], color_discrete_sequence=[px.colors.qualitative.Pastel], text=reason['count'])\n\nfig1.update_layout(title={\n                  'text': \"Category of Reasons for 911 Calls\",\n                  'y':0.98,\n                  'x':0.5,\n                  'xanchor': 'center',\n                  'yanchor': 'top'},\n                  xaxis_title='Reason Category',\n                  yaxis_title='Count',\n                  showlegend=False,\n                  template='ggplot2')\n\n# -----------------------------------------------------------\n\n# Pie Chart\nfig2 = px.pie(reason, reason['reason'], reason['count'], \n              color_discrete_sequence=px.colors.qualitative.Pastel, hole=0.5)\n\nfig2.update_layout(title={\n                  'text': \"Category of Reasons for 911 Calls (Pie Chart)\",\n                  'y':0.98,\n                  'x':0.5,\n                  'xanchor': 'center',\n                  'yanchor': 'top'},\n                   height=600,\n                  template='plotly_white')\n\nfig2.update_traces(textposition='inside', textinfo='percent+label', pull=[0.2, 0, 0])\n\nfig2.data[0].marker.line.width = 2\nfig2.data[0].marker.line.color = \"black\"\n\n# -----------------------------------------------------------\n\nfig1.show()\nfig2.show()","c9d23d24":"data['title'].value_counts()\\\n             .head(10)\\\n             .to_frame(name='count')\\\n             .reset_index()\\\n             .style.background_gradient(cmap='Reds', subset=['count'])","6e93c854":"data['title'].value_counts().head(10).iplot(kind='bar', \n                 color='red',\n                 gridcolor='white',\n                 linecolor='black',\n                 theme='pearl',\n                 title='Township',\n                 yTitle='Number of 911 Calss',\n                 bargap=0.4,\n                 xTitle='Day of Week'\n                 )\n\n\n# Seaborn Chart\n# plt.subplots(figsize=(20, 7))\n\n# ax = sb.countplot(data['title'], data=data)\n# ax.set(xlabel='Reasons', ylabel='Count')\n# plt.title('Different Reasons For 911 Calls')\n\n# plt.xticks(rotation=90)\n\n# plt.show()","c16ea1bc":"plt.subplots(figsize=(20, 7))\n\nax = sb.countplot(data['title'], hue=data['reason_cat'], data=data)\nax.set(xlabel='Reasons', ylabel='Count')\nplt.title('Different Reasons For 911 Calls')\n\nplt.xticks(rotation=90)\n\nplt.show()","35a68d5a":"top_10_reasons = data['title'].value_counts().to_frame(name='count').head(10).sort_values(by='count')\nfig = px.bar(top_10_reasons, color_discrete_sequence=[px.colors.qualitative.Pastel], orientation='h', text=top_10_reasons['count'].sort_values(ascending=True))\n\nfig.update_layout(title={\n                  'text': \"Top 10 Reasons for 911 Calls\",\n                  'y':0.98,\n                  'x':0.5,\n                  'xanchor': 'center',\n                  'yanchor': 'top'},\n                  xaxis_title='Reasons',\n                  yaxis_title='Count',\n                  showlegend=False,\n                  template='plotly_white')\n\nfig.show()","2d4b1190":"data['zip'].value_counts()\\\n           .head(20)\\\n           .to_frame(name='count')\\\n           .reset_index()\\\n           .style.background_gradient(cmap='Greens', subset=['count'])","e554e61d":"top_10_zip = data['zip'].value_counts().to_frame(name='count').head(10).sort_values(by='count')","98718561":"plt.subplots(figsize=(18, 8))\nax = sb.barplot(top_10_zip.index, top_10_zip['count'])\nplt.xticks(rotation=90)\nax.set(xlabel='Zip Codes', ylabel='Number of 911 Calls')\nplt.title('Top 10 Zip Codes For 911 Calls')\n\nplt.show()","274e4f06":"data['twp'].value_counts()\\\n           .head(20)\\\n           .to_frame(name='count')\\\n           .reset_index()\\\n           .style.background_gradient(cmap='Blues', subset=['count'])","d92588d6":"top_10_twp = data['twp'].value_counts().to_frame(name='count').head(10).sort_values(by='count') \n\ntop_10_twp.iplot(kind='bar', \n                 color='red',\n                 gridcolor='white',\n                 linecolor='black',\n                 theme='pearl',\n                 title='Township',\n                 yTitle='Number of 911 Calss',\n                 bargap=0.3,\n                 xTitle='Day of Week'\n                 )\n\n# Seaborn Way\n# sb.set_style('whitegrid')\n# plt.subplots(figsize=(14, 7))\n# ax = sb.barplot(top_10_twp.index, top_10_twp['count'])\n# plt.xticks(rotation=90)\n# ax.set(xlabel='Township', ylabel='Number of 911 Calls')\n# plt.title('Top 10 Township For 911 Calls')\n# plt.show()","f7f71b30":"print(f\"Minimum year in data: {data['year'].min()}\")\nprint(f\"Most recent year in data: {data['year'].max()}\")\nprint(f\"Total number of years: {data['year'].max()-data['year'].min()}\")","337da9a1":"data.drop(data[data['lng']>-73].index, inplace=True)\ndata.drop(data[data['lng']<-76].index, inplace=True)","82af15f6":"data_15 = data[data['year']==2015]\ndata_16 = data[data['year']==2016]\ndata_17 = data[data['year']==2017]\ndata_18 = data[data['year']==2018]\ndata_19 = data[data['year']==2019]\ndata_20 = data[data['year']==2020]","a49c7b03":"top_twp_15 = data_15['twp'].value_counts().to_frame(name='count').head(10).sort_values(by='count')\ntop_twp_16 = data_16['twp'].value_counts().to_frame(name='count').head(10).sort_values(by='count')\ntop_twp_17 = data_17['twp'].value_counts().to_frame(name='count').head(10).sort_values(by='count')\ntop_twp_18 = data_18['twp'].value_counts().to_frame(name='count').head(10).sort_values(by='count')\ntop_twp_19 = data_19['twp'].value_counts().to_frame(name='count').head(10).sort_values(by='count')\ntop_twp_20 = data_20['twp'].value_counts().to_frame(name='count').head(10).sort_values(by='count')","ceeb608e":"fig = make_subplots(rows=3, cols=2, \n                   subplot_titles=(\"Year 2015\",\"Year 2016\", \"Year 2017\", \"Year 2018\", \"Year 2019\", \"Year 2020\"))\n\nfig.add_trace(go.Bar(x = top_twp_15.index, y=top_twp_15['count'], name='2015'), row=1, col=1) \n\nfig.add_trace(go.Bar(x = top_twp_16.index, y=top_twp_16['count'], name='2016'), row=1, col=2)\n\nfig.add_trace(go.Bar(x = top_twp_17.index, y=top_twp_17['count'], name='2017'), row=2, col=1)\n\nfig.add_trace(go.Bar(x = top_twp_18.index, y=top_twp_18['count'], name='2018'), row=2, col=2)\n\nfig.add_trace(go.Bar(x = top_twp_19.index, y=top_twp_19['count'], name='2019'), row=3, col=1)\n\nfig.add_trace(go.Bar(x = top_twp_20.index, y=top_twp_20['count'], name='2020'), row=3, col=2)\n\nfig.update_layout(title_text='Top Townships for 911 Calls', height=1500, template='plotly_white')\n\nfig.show()","242f9a4d":"top_twp_20 = data_20['twp'].value_counts().to_frame(name='count').head(10).sort_values(by='count', ascending=False)\ntop_twp_20.style.background_gradient(cmap='Blues', subset=['count'])","ffb76fa4":"sb.lmplot(x='month', y='twp', data=data.groupby('month').count().reset_index(), height=6, aspect=2)","cab93e64":"top_title_15 = data_15['title'].value_counts().to_frame(name='count').head(10).sort_values(by='count')\ntop_title_16 = data_16['title'].value_counts().to_frame(name='count').head(10).sort_values(by='count')\ntop_title_17 = data_17['title'].value_counts().to_frame(name='count').head(10).sort_values(by='count')\ntop_title_18 = data_18['title'].value_counts().to_frame(name='count').head(10).sort_values(by='count')\ntop_title_19 = data_19['title'].value_counts().to_frame(name='count').head(10).sort_values(by='count')\ntop_title_20 = data_20['title'].value_counts().to_frame(name='count').head(10).sort_values(by='count')","39aa8a95":"fig = make_subplots(rows=3, cols=2, \n                   subplot_titles=(\"Year 2015\",\"Year 2016\", \"Year 2017\", \"Year 2018\", \"Year 2019\", \"Year 2020\"))\n\nfig.add_trace(go.Bar(x = top_title_15.index, y=top_title_15['count'], name='2015'), row=1, col=1) \n\nfig.add_trace(go.Bar(x = top_title_16.index, y=top_title_16['count'], name='2016'), row=1, col=2)\n\nfig.add_trace(go.Bar(x = top_title_17.index, y=top_title_17['count'], name='2017'), row=2, col=1)\n\nfig.add_trace(go.Bar(x = top_title_18.index, y=top_title_18['count'], name='2018'), row=2, col=2)\n\nfig.add_trace(go.Bar(x = top_title_19.index, y=top_title_19['count'], name='2019'), row=3, col=1)\n\nfig.add_trace(go.Bar(x = top_title_20.index, y=top_title_20['count'], name='2020'), row=3, col=2)\n\nfig.update_layout(title_text='Top Reasons for 911 Calls', height=1500, template='plotly_white')\n\nfig.show()","4848345a":"map_plot_20 = data[['lat', 'lng', 'twp']].groupby('twp').mean().reset_index()\nmap_plot_20.head(15).style.background_gradient(cmap='Reds', subset=['lat'])\\\n                    .background_gradient(cmap='Greens', subset=['lng'])","3c3f255b":"map_data = folium.Map(location=(40.2547, -75.3405), zoom_start = 11, width='70%', max_zoom=11, min_zoom=11)\n\nfor lat, lng, twp in zip(map_plot_20.lat, map_plot_20.lng, map_plot_20.twp):\n    folium.Marker(\n    radius=1,\n    location=[lat, lng],\n    color='crimson',\n    popup=twp,\n    icon=folium.Icon(color='red'),\n    ).add_to(map_data)\n\n\n\n#  display interactive map\ndisplay(map_data)","64dc6853":"map_data = folium.Map(location=(40.2547, -75.3405), zoom_start = 11, width='70%', max_zoom=11, min_zoom=11)\n\nfor lat, lng in zip(data_20.lat.unique(), data_20.lng.unique()):\n    folium.CircleMarker(\n    radius=0.7,\n    location=[lat, lng],\n    color='crimson',\n    fill=True,\n    fillcolor='crimson'\n    ).add_to(map_data)\n\n\n\n#  display interactive map\ndisplay(map_data)","e2d57c37":"dmap={0:'Mon',1:'Tue',2:'Wed',3:'Thu',4:'Fri',5:'Sat',6:'Sun'}\n\nmmap={1:'Jan',2:'Feb',3:'Mar',4:'Apr',5:'May',6:'Jun',7:'Jul',8:'Aug',9:'Sep',10:'Oct',11:'Nov',12:'Dec'}\n\ndata['month']=data['month'].map(mmap)\n\ndata['dayofweek']=data['dayofweek'].map(dmap)","9e604f60":"data['dayofweek'].value_counts()","20942ff5":"data['dayofweek'].value_counts().iplot(kind='bar', \n                                       color='red',\n                                       gridcolor='white',\n                                       linecolor='black',\n                                       theme='pearl',\n                                       title='Calls During Week',\n                                       yTitle='Count',\n                                       bargap=0.4,\n                                       opacity=0.7,\n                                       xTitle='Day of Week'\n                                      )","79c7487c":"plt.style.use('ggplot')\nplt.subplots(figsize=(18, 8))\nsb.countplot(data['dayofweek'], hue=data['reason_cat'])","506182d8":"dayHour=data.groupby(by=['dayofweek','hour']).count()['reason_cat'].unstack()\n\nplt.figure(figsize=(18,5))\nsb.heatmap(dayHour,cmap='viridis',linewidths=0.1, linecolor='#0f0f0f')","5d1d5d7d":"data['month'].value_counts()","dca3aaaa":"data['month'].value_counts().iplot(kind='bar', \n                                       color='green',\n                                       gridcolor='white',\n                                       linecolor='black',\n                                       theme='pearl',\n                                       bargap=0.3,\n                                       opacity=0.7,\n                                       title='Calls During Month',\n                                       yTitle='Count',\n                                       xTitle='Month'\n                                      )","f32c4798":"plt.style.use('ggplot')\nplt.subplots(figsize=(18, 8))\nsb.countplot(data['month'], hue=data['reason_cat'])","8956d102":"dayHour=data.groupby(by=['month','dayofweek']).count()['reason_cat'].unstack()\n\nplt.figure(figsize=(18,5))\nsb.heatmap(dayHour,cmap='viridis',linewidths=0.1, linecolor='#0f0f0f')","91f76fa6":"data['year'].value_counts()","3904ba23":"data['year'].value_counts().iplot(kind='bar', \n                                       gridcolor='white',\n                                       linecolor='black',\n                                       theme='pearl',\n                                       bargap=0.3,\n                                       opacity=0.7,\n                                       title='Yearly Calls',\n                                       yTitle='Count',\n                                       xTitle='Year'\n                                      )","f3f020b7":"dayHour=data.groupby(by=['year','month']).count()['reason_cat'].unstack()\n\nplt.figure(figsize=(18,5))\nsb.heatmap(dayHour,cmap='viridis',linewidths=0.1, linecolor='#0f0f0f')","f181b767":"## Top 10 Reasons from 2015-2020 for 911 calls","8f882103":"### All the reasons for 911 calls","38c84679":"## Different reason category for 911 calls","f59c0fe8":"## Datetime","18236bed":"## Adding new datetime columns","282955cf":"# Handling Missing Data","f0d33d7a":"## 911 calls based on different Township","98e6731b":"* EMS (Emergency Medical Services) calls are the most frequent.\n* Traffic calls are less frequent and Fire calls being the least frequent.","6fb86f78":"Alright, Lets move forward !!","d005279f":"Adding one column to our data : 'reason_cat' for the category of reason. This will enable us to better understand and visualize the dataset.","2e934734":"# Folium Map (Location)","ddffaca3":"## 911 Calls During Month","b08ff012":"### Category for different reasons","9ecf1735":"## 911 Calls During Week","53cbb556":"Here, grey boxes represent the lack of data.","a6a04f7e":"* Approximately 28% of all calls are for vehicle accident.\n* Followed by disabled vehicle calls which constitutes nearly 7% of all calls.","3e437b6b":"# Data Visualizations\n\nLets get out hands dirty","56b2f7fe":"Lets leave zip for now we will only use it for the top 10 zip codes for most number of 911 calls.","c778d7a4":"Our column 'timeStamp' is in Categorical format and hence we must convert it to 'Datetime' format.","40fc3c83":"All the data in this dataset is from **\"Montgomery County, Pennsylvania\".**\n\n\nIn this kernel, we will Analyze and Visualize the 911 calls data based on different variables. I try to make all of my kernels very easy to understand for someone who is just starting their journey on Kaggle and here to learn something because this is what I am doing and I am just a novice starting on my kaggle journey. I hope you like my kernel and give it an Upvote.\n\n\nI wish everyone good luck for their learning journey on kaggle.","975e84b0":"## How many different reasons?","8fe31331":"## 911 Calls Yearly","1100bcb6":"# Its About Time !","1ee413d1":"# Loading Data","14a94b8f":"# Quick Look at Data","e4251cc0":"## Top 10 townships from 2015-2020 for 911 calls","72bfe76d":"## 911 calls based on different Zip codes","edae0606":"# Analysis on Time: 2015\u20222019","b5fedd44":"# Feature Engineering","0f7438c4":"## Different reasons for 911 calls\n\nTop 10 reasons for 911 calls in \"Montgomery County, Pennsylvania\".","f1e5e9fc":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           background-color:#5642C5;\n           font-size:110%;\n           font-family:Verdana;\n           letter-spacing:0.9px\">\n    <p style=\"padding: 10px;\n              color:white;\n              font-size:110%\">\n        If you like this notebook, please give it an <span style=\"color:#F28835;\"><b><i>upvote<\/i><\/b><\/span> as it keeps me motivated to create more quality kernels.<br>Keep on Learning !!\n    <\/p>\n<\/div>"}}