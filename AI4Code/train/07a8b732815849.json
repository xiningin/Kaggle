{"cell_type":{"d5d8f9ed":"code","d69b679c":"code","5c475f06":"code","d21ecb2b":"code","2529e485":"code","0f176cb1":"code","e6b3b1c5":"code","1e558775":"code","b5309ab5":"code","8f928fc0":"code","1d98bdff":"code","204ce682":"code","a9baf23f":"code","a3cfbb5e":"code","c8521f21":"code","1dac76d0":"code","c9518b3b":"code","c5636d87":"code","837c3c36":"code","244d9ea3":"code","796ebe92":"code","1678c947":"code","ef4ff424":"code","188781e2":"code","1bf61249":"code","37ec2bf7":"code","b29f9424":"code","cf72aa65":"code","8bdb659f":"code","b7418030":"code","e20d7e0e":"markdown","9c428834":"markdown","badcf94b":"markdown","d6e82be2":"markdown","c94e6b38":"markdown","cc40e5b1":"markdown","1ceff0ae":"markdown","6e93d55a":"markdown","398452cc":"markdown"},"source":{"d5d8f9ed":"import seaborn as sns\nimport pandas as pd\n# Visualizations Libraries\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport plotly\nimport plotly.offline as pyo\nimport plotly.express as px\nimport plotly.graph_objs as go\nimport plotly.figure_factory as ff\nimport warnings\nwarnings.filterwarnings(\"ignore\")","d69b679c":"data = pd.read_csv('..\/input\/heart-failure-prediction\/heart.csv')","5c475f06":"data.head(5).style.background_gradient(cmap='rocket_r')","d21ecb2b":"data.shape","2529e485":"data.size","0f176cb1":"data.dtypes","e6b3b1c5":"data.info()","1e558775":"data.describe().style.background_gradient(cmap='rocket_r')","b5309ab5":"numeric_col=[col for col in data if data[col].dtype !=\"object\" ]\ncategorical_col=[col for col in data if data[col].dtype==\"object\" ]\nnumeric_col.remove(\"HeartDisease\")\nprint(\"Numerical col:\",numeric_col)\nprint(\"Categrical col:\",categorical_col)","8f928fc0":"fig = px.pie(data['Sex'].value_counts().reset_index() , values = 'Sex', names='index' ,title = '<b>Which gender is more<b>' )\nfig.update_traces(textposition='inside', textinfo='percent+label')\nfig.update_layout(title ={'font':dict(size =  40),\n                         'x':0.5}, \n                 showlegend = False)\nfig.show()","1d98bdff":"fig = px.histogram(data ,'Age','HeartDisease', histfunc='count',color= 'HeartDisease', title = \"<b>Age vs HeartDisease<\/b>\")\nfig.update_layout(title ={'font': dict(size = 40),\n                         'x': 0.5})\nfig.show()","204ce682":"fig = px.histogram(data,x='ChestPainType',color='HeartDisease',title = '<b>ChestPainType vs HeartDisease<b> ')\nfig.update_layout(title ={'font': dict(size = 40),\n                         'x': 0.5})\nfig.show()","a9baf23f":"fig=px.histogram(data,x='Age',color='Sex', title=\"<b>Average Age Gender wise<\/b>\")\nfig.add_vline(x=data['Age'].mean(),line_dash=\"dash\")\nfig.update_layout(title ={'font': dict(size = 40),\n                         'x': 0.5})\nfig.show()","a3cfbb5e":"fig=px.histogram(data,x='Sex',color='HeartDisease')\nfig.show()","c8521f21":"fig = go.Figure(data=[go.Pie(labels=data['ChestPainType'].value_counts().index,\n                             values=data['ChestPainType'].value_counts().values,\n                             hole=.5,pull=[0.06, 0.02, 0.06, 0.02])])\n\nfig.update_layout(title ={'font': dict(size = 40),\n                         'x': 0.5},title_text=\"<b>Chest pain type<b>\" )\nfig.show()","1dac76d0":"from sklearn.preprocessing import StandardScaler, PolynomialFeatures, OneHotEncoder, StandardScaler, PowerTransformer, MinMaxScaler, LabelEncoder, RobustScaler\nfrom sklearn.model_selection import RepeatedStratifiedKFold, KFold, cross_val_predict, train_test_split, GridSearchCV, cross_val_score, cross_validate","c9518b3b":"df_dum = pd.get_dummies(data, drop_first=True)","c5636d87":"X = df_dum.drop(\"HeartDisease\", axis=1)\ny = df_dum[\"HeartDisease\"]","837c3c36":"scaler = StandardScaler()\nX = scaler.fit_transform(X)\n","244d9ea3":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42)","796ebe92":"!pip install autokeras","1678c947":"import tensorflow as tf\nimport autokeras as ak","ef4ff424":"from sklearn.metrics import plot_confusion_matrix, f1_score","188781e2":"clf = ak.StructuredDataClassifier(overwrite= False , max_trials = 50)\nclf.fit(X_train , y_train , epochs= 900)","1bf61249":"pred = clf.predict(X_test)\nprint(\"F1 score AutoKeras  is: \",f1_score(y_test, pred))","37ec2bf7":"import h2o\nfrom h2o.automl import H2OAutoML\nh2o.init()","b29f9424":"df_h2o = h2o.H2OFrame(data)","cf72aa65":"train, test, valid = df_h2o.split_frame ( ratios = [ .7 , .15 ])","8bdb659f":"y  = 'HeartDisease'\nx_train = train.columns\nx_train.remove(y)\naml = H2OAutoML(max_runtime_secs=700, seed = 1)\naml.train(x = x_train, y = y, training_frame = train)","b7418030":"lb = aml.leaderboard\nlb.head()","e20d7e0e":"**Install**","9c428834":"**<center><h1 style=\"border-radius: 30px; background: #cc0029; padding: 30px; width: 500px; height: 50px;\">H2OAutoML<\/h1><\/center>**","badcf94b":"Best val_accuracy So Far: 0.8673469424247742","d6e82be2":"**<center><h1 style=\"border-radius: 25px; background: #cc0029; padding: 30px; width: 500px; height: 20px;\">Introduction<\/h1><\/center>**","c94e6b38":"****<center><h1 style=\"border-radius: 25px; background: #cc0029; padding: 30px; width: 500px; height: 50px;\">Data Preprocessing<\/h1><\/center>****","cc40e5b1":"\n**The term \u201cheart disease\u201d refers to several types of heart conditions.\nHeart disease describes a range of conditions that affect your heart. Heart diseases include:**\n\n   \n    Blood vessel disease, such as coronary artery disease\n    Heart rhythm problems (arrhythmias)\n    Heart defects you're born with (congenital heart defects)\n    Heart valve disease\n    Disease of the heart muscle\n    Heart infection\n\n**Many forms of heart disease can be prevented or treated with healthy lifestyle choices. We are going to analyze a data on Heart Disease Prediction Dataset to figure out causes and important features that affect heart disease chances considerably. Improving these indexes can actually help us in reducing prevalance in heart disease.**\n","1ceff0ae":"****<center><h1 style=\"border-radius: 25px; background: #cc0029; padding: 30px; width: 500px; height: 50px;\">AutoKeras<\/h1><\/center>****","6e93d55a":"**<center><h1 style=\"border-radius: 25px; background: #cc0029; padding: 30px; width: 400px; height: 40px;\">EDA<\/h1><\/center>**","398452cc":"# **Importing libraries**"}}