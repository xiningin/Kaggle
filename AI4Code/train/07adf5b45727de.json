{"cell_type":{"91e950ff":"code","ec996af5":"code","8aef9d2c":"code","bdcd4727":"code","f58d65f0":"code","505541eb":"markdown"},"source":{"91e950ff":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport torch\nfrom tqdm import tqdm\nimport sys\n\nsys.path.append('..\/input\/tensorflow-great-barrier-reef')","ec996af5":"!mkdir -p \/root\/.config\/Ultralytics\n!cp \/kaggle\/input\/yolov5-font\/Arial.ttf \/root\/.config\/Ultralytics\/","8aef9d2c":"import greatbarrierreef\nenv = greatbarrierreef.make_env()# initialize the environment\niter_test = env.iter_test()      # an iterator which loops over the test set and sample submission","bdcd4727":"model = torch.hub.load('..\/input\/yolov5-lib-ds', \n                       'custom', \n                       path='..\/input\/reef-baseline-fold12\/l6_3600_uflip_vm5_f12_up\/f1\/best.pt',\n                       source='local',\n                       force_reload=True)  # local repo\nmodel.conf = 0.20","f58d65f0":"for idx, (img, pred_df) in enumerate(tqdm(iter_test)):\n    anno = ''\n    r = model(img, size=10000, augment=True)\n    if r.pandas().xyxy[0].shape[0] == 0:\n        anno = ''\n    else:\n        for idx, row in r.pandas().xyxy[0].iterrows():\n            if row.confidence > 0.28:\n                anno += '{} {} {} {} {} '.format(row.confidence, int(row.xmin), int(row.ymin), int(row.xmax-row.xmin), int(row.ymax-row.ymin))\n#                 pred.append([row.confidence, row.xmin, row.ymin, row.xmax-row.xmin, row.ymax-row.ymin])\n    pred_df['annotations'] = anno.strip(' ')\n    env.predict(pred_df)","505541eb":"**This notebook is copy of this one https:\/\/www.kaggle.com\/steamedsheep\/yolov5-is-all-you-need \nI just changed the following parameters:size10000_conf0.015_augTrue_row.confidence0.28"}}