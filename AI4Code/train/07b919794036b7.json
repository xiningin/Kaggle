{"cell_type":{"c912164f":"code","ea98adc4":"code","b47c2db9":"code","8324f7d8":"code","42db3599":"code","4670d0a5":"code","95c0af38":"code","3f7854fa":"code","1770c704":"code","c267bde5":"code","8b44d413":"code","35a0aaee":"code","6b75816d":"code","2b55b003":"code","d0f8ab52":"code","afacbab1":"code","396d4079":"code","1ec5b469":"code","9c16b6ca":"code","b1a2b3b5":"code","64929744":"code","99424d12":"code","7c3ecc2f":"code","ecbb638a":"markdown","38b2b2e7":"markdown","d50de995":"markdown","9dc7799e":"markdown","148379b5":"markdown","9041c9ac":"markdown","4ebecb77":"markdown","adfdfd7d":"markdown","0c87dc69":"markdown","d7806d63":"markdown","71f51b00":"markdown","ab5effe0":"markdown","71c1c330":"markdown","2b178551":"markdown","398737a6":"markdown"},"source":{"c912164f":"#Importing libraries\n#Loading and Manipulating Data\nimport pandas as pd \nimport numpy as np \n\n#Visualizations\n%matplotlib inline\nimport matplotlib.pyplot as plt\nimport seaborn as sns \n","ea98adc4":"#Loading Data\ndext=pd.read_csv(\"..\/input\/external_data.csv\",)\ndev=pd.read_csv(\"..\/input\/evolution content consumption.csv\",index_col=[\"date\"],parse_dates=[\"date\"])\ndus=pd.read_csv(\"..\/input\/users.csv\",index_col=0)\ndpeb=pd.read_csv(\"..\/input\/pebmed_content.csv\",parse_dates=[\"access_timestamp\"])","b47c2db9":"#Basic info\ndpeb.info()\n#First 15 lines of the dataset\ndpeb.head(5)\n","8324f7d8":"#how many countries are considered in this dataset?\ndpeb.country.nunique()\n","42db3599":"#Countplot of the 5 countries with the most number of content\nplt.figure(figsize=(12,4))\nplt.title(\"Top 5 countries\")\nsns.countplot(x=\"country\",data=dpeb,#selecting top 5 countries#\n              order=dpeb.country.value_counts().iloc[:5].index)\n","4670d0a5":"#Considering brazilian entries\nd_BR=dpeb.loc[dpeb.country==\"BR\"]\n\n#Top 5 cities with most entries\nplt.figure(figsize=(12,4))\nplt.title(\"Top 5 cities\")\nsns.countplot(x=\"city\", data=d_BR,order=d_BR.city.value_counts().iloc[:5].index)\n\n","95c0af38":"#Countplot of content\nplt.figure(figsize=(12,4))\nplt.title(\"Contents\")\nsns.countplot(x=\"content\", data=d_BR)\nplt.xticks(\n    rotation=45, \n    horizontalalignment='right',\n    fontweight='light',\n    fontsize='x-large'  \n)\n","3f7854fa":"d_BR.category.unique()\nplt.figure(figsize=(12,4))\nplt.title(\"Categories\")\nsns.countplot(x=\"category\", data=d_BR)\nplt.xticks(\n    rotation=45, \n    horizontalalignment='right',\n    fontweight='light',\n    fontsize='x-large'  \n)\n","1770c704":"d_BR.category.unique()\nplt.figure(figsize=(12,4))\nplt.title(\"SubCategories\")\nsns.countplot(x=\"subcategory\", data=d_BR)\nplt.xticks(\n    rotation=45, \n    horizontalalignment='right',\n    fontweight='light',\n    fontsize='x-large'  \n)","c267bde5":"#Basic info\ndev.info()\n#First 5 lines\ndev.head()","8b44d413":"#We just want brazilian entries\nev_BR=dev.loc[dev.country==\"BR\"]\n#Countplot of aboutcovid\nplt.figure(figsize=(12,4))\nplt.title(\"Covid related content\")\nsns.countplot(x=\"about covid?\", data=ev_BR)","35a0aaee":"#Selecting number of access column\ns=ev_BR[\"total access\"]\n#Suming all access by date to create a time series\nsev_BR=s.groupby(\"date\").sum()\nsev_BR","6b75816d":"#Ploting the time series\nplt.figure(figsize=(12,4))\nplt.title(\"Acessos\")\nsns.lineplot(data=sev_BR)","2b55b003":"#This Time Series relates date and Number of user_ids that logged that day\ns_BR=d_BR.groupby(d_BR[\"access_timestamp\"].dt.date).count()[\"user_id\"]\ns_BR","d0f8ab52":"#Plot of the Time Series\nplt.figure(figsize=(12,4))\nplt.title(\"Consultas COVID\")\nsns.lineplot(data=s_BR)","afacbab1":"dext","396d4079":"#Library to handle datetime objects\nimport datetime\n # The format\nformat_str = '%d\/%m\/%Y' \n#Formating column \"id_solution\" to datetime format\ndext.id_solution=dext.id_solution.map(lambda p: datetime.datetime.strptime(p[-10:], format_str))\n#Time Series that relates date to Total Number of cases in that day\nsext_BR=dext.groupby(dext[\"id_solution\"]).sum()[\"casosNovos\"]\n\n\n\n","1ec5b469":"#Even with a error message the series is well defined\nsext_BR\n","9c16b6ca":"#Ploting Series of new COVID cases\nplt.figure(figsize=(12,4))\nplt.title(\"Casos de Covid\")\nsns.lineplot(data=sext_BR)","b1a2b3b5":"#Creating a Dataframe to analyse the two series together.\ndt =pd.concat([s_BR, sext_BR], axis=1, keys=['Consultas', 'Casos'])\ndt\n#Observe that this DataFrame contains nullvalues.","64929744":"#Ploting both Series\nimport matplotlib.pyplot as plt\nax = dt.plot(figsize=(12, 4), fontsize=14)\nplt.show()","99424d12":"plt.figure(figsize=(12,4))\nplt.title(\"CasosxConsultas\")\nsns.scatterplot(x=\"Casos\",y=\"Consultas\",data=dt)","7c3ecc2f":"#Spearman correlation matrix\ncorr_p = dt[['Casos', 'Consultas']].corr(method='spearman')\nprint(corr_p)","ecbb638a":"No esp\u00edrito original da competi\u00e7\u00e3o poderiamos nos perguntar como as informa\u00e7\u00f5es desses datasets e s\u00e9ries temporais podem nos ajudar na tarefa de prever ,ou pelo menos descobrir algo interessante,sobre o n\u00famero total de casos de COVID-19.Para come\u00e7armos nossa investiga\u00e7\u00e3o nesta dire\u00e7\u00e3o vamos dar uma olhada no dataset dext.","38b2b2e7":"# Resumo e Planos futuros\n\nAlgumas coisas que fizemos:\n\n- Produzimos visualiza\u00e7\u00f5es que nos permitiram ter uma vis\u00e3o ampla sobre as principais consultas no whitebook\/nursebook.\n\n- Fizemos uma pequena limpeza e tratamento nos dados possibilitando  visualiza\u00e7\u00f5es mais claras das consultas aos conte\u00fados da PEBMED e dos casos de COVID-19 no Brasil.\n\n- Demos suporte \u00e0 hip\u00f3tese de que as consultas podem auxiliar na previs\u00e3o do n\u00famero total de casos.Para isso,mostramos que as duas vari\u00e1veis est\u00e3o fortemente correlacionadas no sentido de Spearman.\n\nAlgumas coisas que n\u00e3o fizemos e s\u00e3o dire\u00e7\u00f5es futuras interessantes:\n\n- Explorar o dataset contido em \"users_cv\".\n\n- Limpeza adicional nos dados e maior generaliza\u00e7\u00e3o do c\u00f3digo para poder fazer an\u00e1lises por regi\u00e3o.\n\n- Utilizar outras fontes de dados.Principalmente para atualizar o n\u00famero de casos novos de COVID-19.\n\n- Modelagem!Algumas ideias que me deixam particularmente animado s\u00e3o:1)Utilizar ARIMA Forecasting utilizando as consultas como vari\u00e1vel ex\u00f3gena 2)Fazer uma releitura do problema de Forecasting das S\u00e9ries Tempor\u00e1is e adapta-lo ao contexto de aprendizado supervisionado e aplicar Gradient Boosters(LightGBM,XGBoost,etc).\n\n","d50de995":"\u00c9 muito interessante ver que esta s\u00e9rie temporal possui  uma periodicidade bastante vis\u00edvel.Esse fen\u00f4meno n\u00e3o \u00e9 inesperado, pois intuitivamente sabemos que o pico de acessos em uma semana ser\u00e1 entre ter\u00e7a e quinta. \u00c9 razo\u00e1vel esperar que teremos  menos acessos durante o fim de semana.Aproveitaremos este momento para observar a evolu\u00e7\u00e3o de acessos do primeiro dataset que exploramos.","9dc7799e":"Vamos checar se vale a pena analisar todos os 58 pa\u00edses.","148379b5":"Percebemos que h\u00e1 alguma rela\u00e7\u00e3o entre s_BR e sext_BR.Uma forma de refor\u00e7ar nossa intui\u00e7\u00e3o \u00e9 calculando a correla\u00e7\u00e3o entre as duas s\u00e9ries.","9041c9ac":"# Visualiza\u00e7\u00e3o e an\u00e1lise de s\u00e9ries temporais relacionadas.","4ebecb77":"Como podemos ver maior parte das consultas foram brasileiras.Por isso tomaremos a decis\u00e3o de restringir nosso dataset apenas ao Brasil.Essa decis\u00e3o representa uma perda de aproximadamente 2% das entradas do dataset original .Um pr\u00f3ximo passo natural \u00e9 analisar como as consultas est\u00e3o distribu\u00eddas ao longo das cidades.","adfdfd7d":"Observamos que todos os conte\u00fados registrados neste dataset est\u00e3o relacionados ao COVID-19.Conte\u00fados mais gerais como: \"Conoronaviroses\",\"Coronavirus(COVID-19)\" tiveram mais acessos o que \u00e9 esperado.A busca por t\u00f3picos relacionados \u00e0 prescri\u00e7\u00e3o m\u00e9dica foi bastante expressiva.\u00c9 interessante notar que mesmo com a ado\u00e7\u00e3o da categoria \"COVID-19\" maiora das consultas sobre a doen\u00e7a foram realizadas atrav\u00e9s da categoria \"Medicina Interna\" utilizando a subcategoria \"Infectologia\".Ver gr\u00e1fico abaixo","0c87dc69":"O dataset cont\u00e9m o n\u00famero de casos novos por data e regi\u00e3o do Brasil.Assim, como tratamos as outras s\u00e9ries considerando o Brasil como um todo faremos o mesmo quando construirmos a s\u00e9rie relacionada a \"dext\" por quest\u00f5es de simplicidade.De fato ,seria interessante futuramente fazer uma an\u00e1lise mais fina por regi\u00e3o do pa\u00eds.","d7806d63":"Como nosso scatterplot demonstra, n\u00e3o \u00e9 razo\u00e1vel supormos que exista uma rela\u00e7\u00e3o linear entre o n\u00famero de casos novos e a quantidade de consultas.Isso nos impossibilita de usar m\u00e9todos de correla\u00e7\u00e3o que sup\u00f5e linearidade entre as vari\u00e1veis,como a famosa correla\u00e7\u00e3o de Pearson.De qualquer forma,ainda podemos usar outros m\u00e9todos.Escolhemos usar o m\u00e9todo de Spearman que nos fornece informa\u00e7\u00e3o sobre o qu\u00e3o forte \u00e9 a rela\u00e7\u00e3o de monotonicidade entre as duas vari\u00e1veis.Uma rela\u00e7\u00e3o de monotonicidade pode ser observada em dois casos:\n\n- Quando a vari\u00e1vel 1 cresce a vari\u00e1vel 2 tamb\u00e9m cresce.\n\n- Quando a vari\u00e1vel 1 cresce a vari\u00e1vel 2 decresce.","71f51b00":"A correla\u00e7\u00e3o de Spearman das duas vari\u00e1veis \u00e9 alta!Isso \u00e9 bom pois n\u00e3o s\u00f3 d\u00e1 suporte a nossa intui\u00e7\u00e3o inicial de que as duas s\u00e9ries devem estar relacionadas de alguma forma ,mas tamb\u00e9m nos encoraja a prosseguir com a tentativa de prever os Casos utilizando as Consultas.","ab5effe0":"# An\u00e1lise das consultas \u00e0 conte\u00fados da PEBMED","71c1c330":"Agora que j\u00e1 temos uma boa no\u00e7\u00e3o das informa\u00e7\u00f5es b\u00e1sicas que esse dataset pode nos proporcionar vamos analisar a evolu\u00e7\u00e3o do conte\u00fado.","2b178551":"# Projeto Kaggle PEBMED\nO objetivo deste projeto \u00e9 fazer explora\u00e7\u00f5es com o dataset disponibilizado pela PEBMED em uma competi\u00e7\u00e3o informal no Kaggle.O foco inicial ser\u00e1 na limpeza e apresenta\u00e7\u00e3o dos dados por meio  de visualiza\u00e7\u00f5es e an\u00e1lise de vari\u00e1veis estat\u00edsticas dos arquivos disponibilizados na competi\u00e7\u00e3o.Segue uma breve descri\u00e7\u00e3o de cada um dos arquivos.\n\n- evolution content consumption.csv : Cont\u00e9m informa\u00e7\u00f5es sobre o consumo de conte\u00fado dos produtos whitebook\/nursebook.\n- external_data.csv: Registro de novos casos de COVID 19\n- users_csv: Cont\u00e9m informa\u00e7\u00f5es mais espec\u00edficas sobre os usu\u00e1rios.\n- pebmed_content: Cont\u00e9m informa\u00e7\u00f5es sobre o conte\u00fado acessado nos aplicativos whitebook\/nursebook.\n\nA PEBMED \u00e9 uma empresa carioca dedicada ao suporte na tomada de decis\u00e3o de profissionais da \u00e1rea da sa\u00fade.Seus principais produtos s\u00e3o o whitebook,o nursebook e o portal PEBMED.\n\nEsta introdu\u00e7\u00e3o \u00e9 apenas para refer\u00eancia,introdu\u00e7\u00e3o boa \u00e9 aquela escrita com o trabalho finalizado:)","398737a6":"Seria interessante saber exatamente como foi montada a feature \"about covid?\".Como acessos desse dataset se relacionam com o anterior? O dataset \u00e9 desbalanceado pois possui muito mais conte\u00fado n\u00e3o relacionado ao COVID-19.Gostariamos de entender como o n\u00famero de acessos evoluiu ao longo do tempo."}}