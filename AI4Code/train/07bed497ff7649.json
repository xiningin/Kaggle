{"cell_type":{"65b996eb":"code","7e3de340":"code","3eeaa550":"code","06c199ae":"code","729d1f82":"code","89980b07":"code","df2c223e":"code","da8efd19":"code","3aba6066":"code","a3e41833":"code","7da8c1de":"code","88c59ec7":"code","01cf8874":"code","3042f454":"code","1f0e2182":"code","5f68a78a":"code","4afa7737":"code","4e84c3e5":"code","e3c612f9":"code","3f031503":"code","182ab724":"code","9ff7ab30":"code","56ee2d9b":"markdown"},"source":{"65b996eb":"import sys\n!cp ..\/input\/rapids\/rapids.0.13.0 \/opt\/conda\/envs\/rapids.tar.gz\n!cd \/opt\/conda\/envs\/ && tar -xzvf rapids.tar.gz > \/dev\/null\nsys.path = [\"\/opt\/conda\/envs\/rapids\/lib\/python3.6\/site-packages\"] + sys.path\nsys.path = [\"\/opt\/conda\/envs\/rapids\/lib\/python3.6\"] + sys.path\nsys.path = [\"\/opt\/conda\/envs\/rapids\/lib\"] + sys.path\n!cp \/opt\/conda\/envs\/rapids\/lib\/libxgboost.so \/opt\/conda\/lib\/","7e3de340":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport cupy as cp# linear algebra\nimport cudf # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport cuml\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","3eeaa550":"train_df = cudf.read_csv('..\/input\/house-prices-advanced-regression-techniques\/train.csv')\ntest_df = cudf.read_csv('..\/input\/house-prices-advanced-regression-techniques\/test.csv')\n\ndf = [train_df, test_df]","06c199ae":"for dataset in df:\n    dataset.drop(['Id', 'Alley', 'PoolQC', 'Fence', 'MiscFeature'], axis=1, inplace=True)","729d1f82":"train_df['BsmtQual'].value_counts().index[0]","89980b07":"for dataset in df:\n    dataset['LotFrontage'] = dataset['LotFrontage'].fillna(dataset['LotFrontage'].mean())#float\n    dataset['BsmtQual'] = dataset['BsmtQual'].fillna(dataset['BsmtQual'].value_counts().index[0])\n    dataset['BsmtCond'] = dataset['BsmtCond'].fillna(dataset['BsmtCond'].value_counts().index[0])\n    dataset['BsmtExposure'] = dataset['BsmtExposure'].fillna(dataset['BsmtExposure'].value_counts().index[0])\n    dataset['BsmtFinType1'] = dataset['BsmtFinType1'].fillna(dataset['BsmtFinType1'].value_counts().index[0])\n    dataset['MasVnrType'] = dataset['MasVnrType'].fillna(dataset['MasVnrType'].value_counts().index[0])\n    dataset['MasVnrArea'] = dataset['MasVnrArea'].fillna(dataset['MasVnrArea'].mean())#float\n    dataset['BsmtFinType2'] = dataset['BsmtFinType2'].fillna(dataset['BsmtFinType2'].value_counts().index[0])\n    dataset['Electrical'] = dataset['Electrical'].fillna(dataset['Electrical'].value_counts().index[0])\n    dataset['FireplaceQu'] = dataset['FireplaceQu'].fillna(dataset['FireplaceQu'].value_counts().index[0])\n    dataset['GarageType'] = dataset['GarageType'].fillna(dataset['GarageType'].value_counts().index[0])\n    dataset['GarageYrBlt'] = dataset['GarageYrBlt'].fillna(dataset['GarageYrBlt'].mean())#float\n    dataset['GarageFinish'] = dataset['GarageFinish'].fillna(dataset['GarageFinish'].value_counts().index[0])\n    dataset['GarageQual'] = dataset['GarageQual'].fillna(dataset['GarageQual'].value_counts().index[0])\n    dataset['GarageCond'] = dataset['GarageCond'].fillna(dataset['GarageCond'].value_counts().index[0])\n    #In test case\n    dataset['GarageCars'] = dataset['GarageCars'].fillna(dataset['GarageCars'].mean().astype(int))\n    dataset['GarageArea'] = dataset['GarageArea'].fillna(dataset['GarageArea'].mean().astype(int))\n    dataset['SaleType'] = dataset['SaleType'].fillna(dataset['SaleType'].value_counts().index[0])\n    dataset['Functional'] = dataset['Functional'].fillna(dataset['Functional'].value_counts().index[0])\n    dataset['KitchenQual'] = dataset['KitchenQual'].fillna(dataset['KitchenQual'].value_counts().index[0])\n    dataset['BsmtHalfBath'] = dataset['BsmtHalfBath'].fillna(dataset['BsmtHalfBath'].mean().astype(int))\n    dataset['BsmtFullBath'] = dataset['BsmtFullBath'].fillna(dataset['BsmtFullBath'].mean().astype(int))\n    dataset['TotalBsmtSF'] = dataset['TotalBsmtSF'].fillna(dataset['TotalBsmtSF'].mean().astype(int))\n    dataset['BsmtUnfSF'] = dataset['BsmtUnfSF'].fillna(dataset['BsmtUnfSF'].mean().astype(int))\n    dataset['BsmtFinSF2'] = dataset['BsmtFinSF2'].fillna(dataset['BsmtFinSF2'].mean().astype(int))\n    dataset['BsmtFinSF1'] = dataset['BsmtFinSF1'].fillna(dataset['BsmtFinSF1'].mean().astype(int))\n    dataset['Exterior2nd'] = dataset['Exterior2nd'].fillna(dataset['Exterior2nd'].value_counts().index[0])\n    dataset['Exterior1st'] = dataset['Exterior1st'].fillna(dataset['Exterior1st'].value_counts().index[0])\n    dataset['Utilities'] = dataset['Utilities'].fillna(dataset['Utilities'].value_counts().index[0])\n    dataset['MSZoning'] = dataset['MSZoning'].fillna(dataset['MSZoning'].value_counts().index[0])\n","df2c223e":"dataframe = cudf.concat([train_df, test_df])","da8efd19":"dataframe.shape","3aba6066":"dataframe.columns","a3e41833":"dataframe['BsmtQual'].dtype == 'O'","7da8c1de":"dataframe2 = cudf.get_dummies(dataframe)","88c59ec7":"dataframe2.shape","01cf8874":"dataframe2.head()","3042f454":"for column in dataframe2.columns:\n    if dataframe2[column].dtype == 'O':\n        dataframe2.drop([column], axis=1, inplace=True)\n        \ndataframe2.shape","1f0e2182":"train_df = dataframe2.iloc[: 1460, :]\ntest_df = dataframe2.iloc[1460: , :]","5f68a78a":"X = train_df.drop('SalePrice', axis=1)\ny = train_df['SalePrice']\ntest_df = test_df.drop('SalePrice', axis=1)","4afa7737":"from cuml.ensemble import RandomForestRegressor","4e84c3e5":"forest_regressor = RandomForestRegressor(n_estimators = 150)\nforest_regressor.fit(X.values.astype('float32'), y.astype('float32'))\n","e3c612f9":"y_pred = forest_regressor.predict(test_df)","3f031503":"y_pred","182ab724":"sample_sub = cudf.read_csv('..\/input\/house-prices-advanced-regression-techniques\/sample_submission.csv')\nsample_sub.head()","9ff7ab30":"sample_sub['SalePrice'] = y_pred\nsample_sub.to_csv('rf_submission.csv', index=False)","56ee2d9b":"[Rapids](https:\/\/rapids.ai) is an open-source GPU accelerated Data Science and Machine Learning library, developed and mainatained by [Nvidia](https:\/\/www.nvidia.com). It is designed to be compatible with many existing CPU tools, such as Pandas, scikit-learn, numpy, etc. It enables **massive** acceleration of many data-science and machine learning tasks, oftentimes by a factor fo 100X, or even more. \n\nRapids is still undergoing developemnt, and as of right now it's not availabel in the Kaggle Docker environment. If you are interested in installing and running Rapids locally on your own machine, then you shoudl [refer to the followong instructions](https:\/\/rapids.ai\/start.html)."}}