{"cell_type":{"17c1e45c":"code","c44fff5c":"code","24d09b4d":"code","e6aaf580":"code","5145b812":"code","02e67577":"code","e7f901b8":"code","5e2239a1":"code","bb83ee81":"code","bc550db1":"code","fa7151a8":"code","9cb3c04f":"markdown","603ba202":"markdown"},"source":{"17c1e45c":"from fastai.vision.all import *","c44fff5c":"dir_path = Path(\"\/kaggle\/input\/intel-image-classification\/\")\nfnames = get_image_files(dir_path\/\"seg_train\")","24d09b4d":"db = DataBlock(\n    blocks=(ImageBlock, CategoryBlock),\n    get_y=parent_label,\n    splitter=RandomSplitter(),\n    item_tfms=Resize(460),\n    batch_tfms=[*aug_transforms(size=300, mult=1.5), \n                Normalize.from_stats(*imagenet_stats)]\n)\n\ndls = db.dataloaders(fnames)","e6aaf580":"dls.show_batch()","5145b812":"learn = cnn_learner(dls, resnet50, metrics=accuracy)","02e67577":"learn.lr_find()","e7f901b8":"learn.fine_tune(5, 1e-4)","5e2239a1":"learn.lr_find()","bb83ee81":"test_fnames = get_image_files(dir_path\/\"seg_test\")\ntest_dl = dls.test_dl(test_fnames, with_labels=True)","bc550db1":"preds, targs = learn.tta(dl=test_dl)","fa7151a8":"accuracy(preds, targs)","9cb3c04f":"# Evaluate on the test set","603ba202":"# Training with a pretrained Resnet50"}}