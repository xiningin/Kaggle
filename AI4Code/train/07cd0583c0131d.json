{"cell_type":{"761fd215":"code","96aec72c":"code","71c6c7af":"code","91b143df":"code","d4cf7be4":"code","cee38bff":"code","664d8077":"code","165168c0":"code","c3b6e87a":"code","87d3d80d":"code","0441d34e":"markdown","20af95d5":"markdown","12efa339":"markdown","ef254bb6":"markdown"},"source":{"761fd215":"!git clone https:\/\/github.com\/taesungp\/contrastive-unpaired-translation.git","96aec72c":"!pip install dominate visdom","71c6c7af":"!scp -r ..\/input\/gan-getting-started\/photo_jpg .\/trainA\n!scp -r ..\/input\/gan-getting-started\/monet_jpg .\/trainB","91b143df":"!python contrastive-unpaired-translation\/train.py --dataroot .\/ --name monet_gen --CUT_mode CUT --display_id 0 --n_epochs 7 --n_epochs_decay 2 --batch_size 4 --load_size 256 --lr 5e-05","d4cf7be4":"!python contrastive-unpaired-translation\/test.py --dataroot .\/ --name monet_gen --CUT_mode CUT --phase train --num_test 7038","cee38bff":"!ls .\/results\/monet_gen\/train_latest\/images\/fake_B","664d8077":"!ls .\/results\/monet_gen\/train_latest\/images\/","165168c0":"import matplotlib.pyplot as plt\nimport matplotlib.image as mpimg\nfrom os import listdir\n\npwd = '.\/results\/monet_gen\/train_latest\/images\/fake_B\/'\nfilenames = listdir(pwd)\nfor f in filenames[:10]:\n    img = mpimg.imread(pwd + f)\n    plt.imshow(img)\n    plt.show()","c3b6e87a":"import shutil\n\nshutil.make_archive('\/kaggle\/working\/images', 'zip', pwd)","87d3d80d":"for d in ['.\/trainA', '.\/trainB', '.\/results']:\n    shutil.rmtree(d)","0441d34e":"# Losses\n\nAdversarial loss:\n\n$$\\mathcal{L}_{\\operatorname{GAN}}(G,D,X,Y) = \\mathbb{E}_{\\mathbf{y}\\sim Y}[\\log D(y)] + \\mathbb{E}_{\\mathbf{x}\\sim X}[\\log(1-D(G(x)))] $$\n\nThe cross-entropy loss is calculated, representing the probability of the positive example being selected over negatives\n\n$$\\ell(v,v^+,v^-) = -\\log \\bigg[ \\frac{\\exp (v \\cdot v^+ \/ \\tau)}{\\exp(v \\cdot v^+ \/ \\tau) + \\sum_{n=1}^{N} \\exp(v \\cdot v_n^- \/ \\tau)} \\bigg]$$\n\nPatchNCE loss\n$$ \\mathcal{L}_{\\operatorname{PatchNCE}}(G, H, X) = \\mathbb{E}_{\\mathbf{x}\\sim X} \\sum_{l=1}^L \\sum_{s=1}^{S_l} \\ell (\\hat{z}_l^s, z_l^s, z_l^{S \\setminus s}) $$","20af95d5":"# Show & submit","12efa339":"# Train model","ef254bb6":"# Install all prerequisites"}}