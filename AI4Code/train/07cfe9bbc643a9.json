{"cell_type":{"25c71f8e":"code","f823ea5d":"code","a03c6811":"code","7eb6782e":"code","c095726d":"code","df8a43d3":"markdown","f0f5c161":"markdown","0572ca36":"markdown","c9f5db6b":"markdown","a03bda22":"markdown","5c5ec7ca":"markdown","7f11878d":"markdown"},"source":{"25c71f8e":"import riiideducation\n\nimport numpy as np\nimport os\nimport pandas as pd\nfrom sklearn.ensemble import RandomForestClassifier\n\nfrom sklearn import metrics","f823ea5d":"for dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","a03c6811":"train = pd.read_csv('\/kaggle\/input\/riiid-test-answer-prediction\/train.csv', nrows=10**5, \n                    dtype={'row_id': 'int64', 'timestamp': 'int64', 'user_id': 'int32', 'content_id': 'int16', 'content_type_id': 'int8',\n                              'task_container_id': 'int16', 'user_answer': 'int8', 'answered_correctly': 'int8', 'prior_question_elapsed_time': 'float32', \n                             'prior_question_had_explanation': 'boolean',\n                             })\ntrain = train.drop(train[train['answered_correctly']==-1].index)","7eb6782e":"RFC = RandomForestClassifier(max_depth=10, random_state=0)\nRFC.fit(train[['timestamp', 'content_id', 'content_type_id', 'task_container_id', 'prior_question_elapsed_time', 'prior_question_had_explanation']].fillna(0), train['answered_correctly'])","c095726d":"#Create the env\nenv = riiideducation.make_env()\n\n#Create the iterator\niter_test = env.iter_test()\n\n#Iter and predict\nfor (test_df, sample_prediction_df) in iter_test:\n    test_df['answered_correctly'] = RFC.predict(test_df[['timestamp', 'content_id', 'content_type_id', 'task_container_id', 'prior_question_elapsed_time', 'prior_question_had_explanation']].fillna(0))\n    env.predict(test_df.loc[test_df['content_type_id'] == 0, ['row_id', 'answered_correctly']])","df8a43d3":"# List Files","f0f5c161":"# Package import","0572ca36":"# Loading the data","c9f5db6b":"# Prediction","a03bda22":"We are just going to use the train.csv file  and a few columns ","5c5ec7ca":"I made this notebook to have a simple example on how to train a model and submit prediction.","7f11878d":"# Create Model and train it"}}