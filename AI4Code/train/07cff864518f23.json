{"cell_type":{"3d17ed77":"code","48a4f722":"code","7134f4f1":"code","d2d98c0d":"markdown"},"source":{"3d17ed77":"!pip install the1owl\n\nimport re\nimport numpy as np\nimport pandas as pd\nfrom ml import simple\n\ntrain = pd.read_csv('..\/input\/tabular-playground-series-apr-2021\/train.csv')\ntest = pd.read_csv('..\/input\/tabular-playground-series-apr-2021\/test.csv')","48a4f722":"df = pd.concat((train,test))\ndf.Age = df.Age.fillna(999)\ndf.Sex = df.Sex.map({'male':0, 'female':1})\ndf.Embarked = df.Embarked.map({'S':1, 'C':2, 'Q':3})\ndf['Cabin2'] = df.Cabin.fillna('').map(lambda x: str(x)[1:] if len(str(x))>1 else 0).astype(int)\ndf.Cabin = df.Cabin.fillna('').map(lambda x: str(x)[0] if len(str(x))>0 else 9)\ndf.Cabin = df.Cabin.map({'':9, 'A':1, 'B':2, 'C':3, 'D':4, 'E':5, 'F':6, 'G':7, 'T':8})\n#df['Ticket1'] = df.Ticket.map(lambda x: re.sub(r'[0-9.\/ ]', '', str(x)))\n#s = {v:i for i,v in enumerate(sorted(df['Ticket1'].unique()))}\n#df['Ticket1'] = df.Ticket1.map(s)\n#df['Ticket2'] = df.Ticket.map(lambda x: re.sub(r'[A-Za-z.\/ ]', '', str(x))).replace('',0).astype(int)\n\ntrain = df[:len(train)].copy()\ntest = df[len(train):].copy()\ndel df","7134f4f1":"data = simple.Data(train, test, 'PassengerId', 'Survived', {'drop':['Name', 'Ticket'], 'fillna':0})\nXGB_PARAMS = {'eta': 0.02, 'max_depth': 7, 'objective': 'reg:squarederror', 'eval_metric': ['auc'], 'seed': 21}\nmodel = simple.Model(data, 'XGB', XGB_PARAMS, RANDOM_STATE=21) #MODELS available ['ETR', 'XGB', 'LGB', 'CB']\nsub = model.PRED\nsub.Survived = (sub.Survived > 0.5).astype(int)\nsub.to_csv('submission.csv', index=False)","d2d98c0d":"\uff28\ud835\udc00\ud835\udc77\ud835\udc77\ud835\udcce \ud83c\uddf0\ud835\uddee\ud835\ude28\ud835\ude28\ud83c\uddf1\ud835\udd8e\uff2e\u0262 \ud83d\udcaf\n======================="}}