{"cell_type":{"3b6320f8":"code","54d5637f":"code","31527e7a":"code","70c8d752":"code","5f8f6330":"code","367ca5c1":"code","5d25c986":"code","8867d98a":"code","d63884fa":"code","9d792f1d":"markdown"},"source":{"3b6320f8":"import numpy as np\nimport pandas as pd\n\nimport os\nfrom skimage.io import imread\nfrom glob import glob\n\nimport itertools\nimport shutil\nimport matplotlib.pyplot as plt\nfrom sklearn.preprocessing import LabelBinarizer\n%matplotlib inline","54d5637f":"base_tile_dir = '..\/input\/train\/'\ndf = pd.DataFrame({'path': glob(os.path.join(base_tile_dir,'*.tif'))})\ndf['id'] = df.path.map(lambda x: x.split('\/')[3].split(\".\")[0])\nlabels = pd.read_csv(\"..\/input\/train_labels.csv\")\ndf = df.merge(labels, on = \"id\")\ndf.head(5)","31527e7a":"df0 = df[df.label == 0].sample(10000, random_state = 42)\ndf1 = df[df.label == 1].sample(10000, random_state = 42)\ndf = pd.concat([df0, df1], ignore_index=True).reset_index()\ndf = df[[\"path\", \"id\", \"label\"]]\ndf.sample(10)","70c8d752":"df['image'] = df['path'].map(imread)\ndf.sample(3)","5f8f6330":"input_images = np.stack(list(df.image), axis = 0)\ninput_images.shape","367ca5c1":"encoder = LabelBinarizer()\ny = encoder.fit_transform(df.label)\nnsamples, nx, ny, nz = input_images.shape\nx = input_images.reshape((nsamples,nx*ny*nz))\nx.shape","5d25c986":"import umap","8867d98a":"embedding = umap.UMAP(n_components=2, min_dist=0.3, metric='correlation',random_state=42, verbose=True).fit_transform(x)","d63884fa":"fig, ax = plt.subplots(figsize=(12, 10))\nplt.scatter(\n    embedding[:, 0], embedding[:, 1], cmap=\"Spectral\", s=0.1\n)\nplt.title(\"Cancer detection data embedded into two dimensions by UMAP\", fontsize=18)\n\nplt.show()","9d792f1d":"Here, I have tried to create a 2D representation of the data to understand the patterns and how they are distributed. I have used parts of code from the kernel by Henrique Mello linked here- https:\/\/www.kaggle.com\/hrmello\/base-cnn-classification-from-scratch"}}