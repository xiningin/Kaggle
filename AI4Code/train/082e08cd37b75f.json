{"cell_type":{"b53f066d":"code","dcb99bda":"code","3b946d45":"code","67d4651f":"code","0bd04806":"code","fcb4201a":"code","3da2f0ac":"code","529a24cf":"code","a5a2bd75":"code","a8735a28":"code","005d2f71":"code","dede690d":"code","332fca2c":"code","3a980967":"code","8ac2fa83":"code","b4f018d5":"code","7c674241":"code","4bf051bb":"code","f561b23a":"code","47d1b781":"code","f2177ee6":"code","81812765":"markdown","9af08cf4":"markdown","acc08b9e":"markdown","dccb777b":"markdown","1e38dcd4":"markdown","4dd3ea17":"markdown","95ed7ac8":"markdown","7cdac7f8":"markdown","5384580d":"markdown"},"source":{"b53f066d":"import numpy as np\nimport pandas as pd\nimport tensorflow as tf\nfrom tensorflow import keras\nfrom tensorflow.keras import layers\n\nimport matplotlib.pyplot as plt\nfrom sklearn.model_selection import train_test_split\n\nfrom mlxtend.preprocessing import minmax_scaling","dcb99bda":"train_data = pd.read_csv(\"\/kaggle\/input\/titanic\/train.csv\")\ntrain_data.head()","3b946d45":"test_data = pd.read_csv(\"\/kaggle\/input\/titanic\/test.csv\")\ntest_data.head()","67d4651f":"# columns that I am gonna use\ncolumns = [\"Pclass\", \"Sex\", \"Age\", \"Cabin\", \"Fare\", \"Embarked\"]\nX = train_data[columns].copy()\ny = train_data.pop(\"Survived\")\ny","0bd04806":"X['Cabin'] = X['Cabin'].fillna(\"unknown\")\nvals = list(X['Cabin'].unique())\nX['Cabin'] = X['Cabin'].apply(lambda a: vals.index(a))\nX.head()","fcb4201a":"X['Sex'] = X['Sex'].apply(lambda a: 1 if a == \"male\" else 0)\nX.head()","3da2f0ac":"print(X['Age'].isna().any())\nX['Age'] = X['Age'].fillna(method=\"bfill\")\nprint(X['Age'].isna().any())","529a24cf":"X['Embarked'] = X['Embarked'].fillna(\"Unknown\")\nvals = list(X['Embarked'].unique())\nX['Embarked'] = X['Embarked'].apply(lambda a: vals.index(a))\nX.head()","a5a2bd75":"Temp = minmax_scaling(X, columns=columns)","a8735a28":"# checking if there is any null value\nTemp.isnull().any()","005d2f71":"X_train, y_train, X_val, y_val = train_test_split(Temp, y, train_size=0.8, test_size=0.2, random_state=1)","dede690d":"X_train.head() # one last view","332fca2c":"model = keras.Sequential([\n    layers.Dense(512, input_shape=[6], activation=\"relu\"),\n    layers.Dense(128, activation=\"relu\"),\n    layers.Dropout(0.4),\n    layers.Dense(64, activation=\"relu\"),\n    layers.Dense(1, activation=\"sigmoid\")\n])\nmodel.compile(loss=\"binary_crossentropy\", optimizer=\"adam\", metrics=['accuracy'])\nmodel.summary()","3a980967":"history = model.fit(\n    x=X_train, y=X_val, batch_size=40, epochs=300, validation_data=(y_train, y_val)\n)","8ac2fa83":"# ['loss', 'accuracy', 'val_loss', 'val_accuracy']\nhistory = pd.DataFrame(history.history)\nplt.plot(history['loss'])\nplt.plot(history['val_loss'])\nplt.show()","b4f018d5":"plt.plot(history['accuracy'])\nplt.plot(history['val_accuracy'])\nplt.show()","7c674241":"# preprocessing test data.\n# columns = [\"Pclass\", \"Sex\", \"Age\", \"Cabin\", \"Fare\", \"Embarked\"]\nX = test_data[columns].copy()\n\n# preprocessing Cabin column\nX['Cabin'] = X['Cabin'].fillna(\"unknown\")\nvals = list(X['Cabin'].unique())\nX['Cabin'] = X['Cabin'].apply(lambda a: vals.index(a))\n\n# preprocessing Sex column\nX['Sex'] = X['Sex'].apply(lambda a: 1 if a == \"male\" else 0)\n\n# Removing na values from age column\nmean_age = X['Age'].mean()\nX['Age'] = X['Age'].fillna(method=\"bfill\").fillna(mean_age)\n# Removing na values from fare column\nmean_fare = X['Fare'].mean()\nX['Fare'] = X['Fare'].fillna(method=\"bfill\").fillna(mean_fare)\n\n# Preprocessing embarked column\nX['Embarked'] = X['Embarked'].fillna(\"Unknown\")\nvals = list(X['Embarked'].unique())\nX['Embarked'] = X['Embarked'].apply(lambda a: vals.index(a))\n\nX.head()","4bf051bb":"# scaling\nX = minmax_scaling(X, columns=columns)\nX.head()","f561b23a":"X.isnull().any()","47d1b781":"temp = model.predict(X)\ntemp = np.around(temp)\ntemp = temp.astype(int)\ndf = pd.DataFrame(test_data['PassengerId'], columns=['PassengerId'])\ndf['Survived'] = temp\ndf","f2177ee6":"df.to_csv(\"my_submission.csv\", index=False)","81812765":"# Plotting for a better understanding...","9af08cf4":"# Scaling the data","acc08b9e":"# Importing libraries..\n\nI will be using a deep neural network to create predictions...","dccb777b":"# Preprocessing `Cabin` column","1e38dcd4":"# Preprocessing `Sex` column","4dd3ea17":"# Reading the data","95ed7ac8":"# Processing `Age`","7cdac7f8":"# Preprocessing `Embarked` column","5384580d":"# Splitting the train data"}}