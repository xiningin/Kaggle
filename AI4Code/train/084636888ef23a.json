{"cell_type":{"2c09df3d":"code","89332f3b":"code","c568bb5f":"code","d935ff4d":"code","c41df9ef":"code","dfb9f0c3":"code","53afa87d":"code","288938e9":"code","aa473263":"code","99c36e01":"code","e622dd83":"markdown"},"source":{"2c09df3d":"!ls \/kaggle\/input\/riiid-saintp-solution\/","89332f3b":"import sys\nsys.path.append('\/kaggle\/input\/riiid-saintp-solution\/')","c568bb5f":"import torch\nimport pandas as pd\n\nfrom saintmodel import SaintModel, SaintLightningModule, SaintHistory\nfrom saintsubmit import load_saint_config, SaintPredictor, make_submission","d935ff4d":"args = load_saint_config()\nmodel = SaintModel(\n    seq_len=args.seq_len, n_dim=args.n_dim, std=args.std, dropout=args.dropout, nhead=args.nhead, n_layers=args.n_layers\n)\nmodule = SaintLightningModule(args, model)","c41df9ef":"%%time\nmodule.load_state_dict(torch.load('\/kaggle\/input\/riiid-saintp-solution\/saint.ckpt')['state_dict'])","dfb9f0c3":"%%time\nlast_history = pd.read_pickle('\/kaggle\/input\/riiid-saintp-solution\/last_history.pickle')\nlast_timestamp = pd.read_pickle('\/kaggle\/input\/riiid-saintp-solution\/last_timestamp.pickle')\nlast_user_count = pd.read_pickle('\/kaggle\/input\/riiid-saintp-solution\/last_user_count.pickle')\ndict_lag = pd.read_pickle('\/kaggle\/input\/riiid-saintp-solution\/dict_lag.pickle')\ndict_elapsed = pd.read_pickle('\/kaggle\/input\/riiid-saintp-solution\/dict_elapsed.pickle')\ndict_user_count = pd.read_pickle('\/kaggle\/input\/riiid-saintp-solution\/dict_user_count.pickle')","53afa87d":"device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')\nmodule.to(device)","288938e9":"saint_history = SaintHistory(\n    args, last_history, last_timestamp, last_user_count,\n    dict_lag, dict_user_count, dict_elapsed\n)\npredictor = SaintPredictor(module.model, saint_history)","aa473263":"import riiideducation\nenv = riiideducation.make_env()","99c36e01":"make_submission(env, predictor)","e622dd83":"# Riiid! SAINT+ Solution\n\nThis notebook is our solution of the \"Riiid! Answer Correctness Prediction\".\n\nAll codes are available on [GitHub](https:\/\/github.com\/marisakamozz\/riiid)."}}