{"cell_type":{"9f5da872":"code","6fa432f9":"code","368e57bd":"code","9ff8a53c":"code","6c9b6964":"markdown","5f6bfdd0":"markdown","9f86892c":"markdown"},"source":{"9f5da872":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","6fa432f9":"f = open('\/kaggle\/input\/betfair-sports\/betfair_140901.csv', 'r')\nT = f.read().split('\\n')\nf.close()\nheaders = T[0].split(',')\nbug_lines = []\nfor t in T:\n    c = t.count(',')\n    if c > 16:\n        bug_lines.append(t)\n        print('--------------')\n        print(t)\n        print('--------------')\n        for i in range(len(headers)):\n            print(headers[i]+' : '+t.split(',')[i])\n        print(t.split(',')[16:])","368e57bd":"for bl in bug_lines:\n    T.remove(bl)\n\nf = open('fixed_betfair_dataset.csv', 'w')\nf.write('')\nf.close()\nf = open('fixed_betfair_dataset.csv', 'a')\nfor t in T:\n    f.write(t + '\\n')\nf.close()\n\ndf = pd.read_csv('fixed_betfair_dataset.csv')","9ff8a53c":"df.head()","6c9b6964":"So there are to crashing lines. In the first one, it seems that two events are mixed, a Japanese soccer match and a Youth Czech soccer match. \nThe second one looks misformated. There are two void fields, but still 5 values to put in. Maybe with some knowledge, it is fixable.\nBut, for the sake of simplicity, we will only remove these two bugged lines.","5f6bfdd0":"## Introduction\n\nWhen I found such an interesting dataset, I was surprised to see that there was no kernel at all about it. But there is a good reason for that: you can not load it directly in a dataframe. To be more specific, if you try to run:\n\n*df = pd.read_csv('\/kaggle\/input\/betfair-sports\/betfair_140901.csv')*\n\nThis will return a ParseError:\n\n*ParserError: Error tokenizing data. C error: Expected 16 fields in line 292284, saw 22*\n\nTelling explicitly that there are too many columns in at least one line. Let's try to look into it.","9f86892c":"Now, enjoy ! :-)"}}