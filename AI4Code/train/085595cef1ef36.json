{"cell_type":{"2581ef85":"code","d2bf4a1e":"code","d4971195":"code","25f91524":"code","a556f7b5":"code","f2c032f2":"code","17359d66":"code","51089b5a":"code","0cbae345":"code","28c0ea87":"code","879f02de":"code","b37967cb":"code","daf3c632":"code","4e1206dd":"code","694ebd85":"code","dfa15bec":"code","c29ae6c9":"code","0215260a":"code","28851eb1":"code","d7c0516f":"code","dd520cb3":"code","e6b15f8c":"code","056527f0":"code","c2e7d333":"code","a730bf3f":"code","9ab6e1a2":"code","378cf5fc":"code","cc0da9a3":"code","22f8bb99":"code","60506349":"code","938deaeb":"code","2ba0205b":"code","62551826":"code","dfd5b8bd":"code","cb04c0bb":"code","ab591e33":"code","9945ba73":"code","b912608f":"code","ee5e8b71":"code","2144e58c":"code","33a6e0c0":"code","f1e94d98":"code","db8bd710":"code","df6da6bb":"code","aa4b148e":"code","d29ab7a8":"code","8146efe9":"code","32b25dc2":"code","860578c3":"code","016925cf":"code","077c4000":"code","1279532d":"code","1263c316":"code","173e0cd8":"code","265433de":"code","03d0cb85":"code","ec4d9e2a":"code","c8e86c51":"code","aab1e895":"code","dd102a2d":"code","ca98d36d":"code","037a3445":"code","53ebb51d":"code","4277294b":"code","ddd05db3":"code","54a51d66":"code","63f5ddd8":"code","dbfc47e0":"code","e1a8151e":"code","0eae4fb8":"code","9aa4a57c":"code","284e72d0":"code","39669d0c":"code","f3071bc9":"code","476a28a3":"code","1e932b01":"code","e3291449":"code","18f5adba":"code","00af48de":"code","b9496504":"code","45698b77":"code","c4cf8613":"markdown","4ba819f6":"markdown","c7441500":"markdown","1cba6186":"markdown","70d8d612":"markdown","d57b9fcd":"markdown","8c4c59e0":"markdown","9c0c2f81":"markdown","5b5a07e4":"markdown","a8e8b0ed":"markdown","89e18532":"markdown","054320f5":"markdown","f7ea0f28":"markdown","5516ac13":"markdown","68ca531a":"markdown","6b0a4acc":"markdown","204108c4":"markdown","557958c0":"markdown","fe5924f1":"markdown","905e4b93":"markdown","7942c0b3":"markdown","8b2b2601":"markdown","8a888e62":"markdown","68d2eff3":"markdown","4aad3144":"markdown","3233b5cf":"markdown","e4bb0f4e":"markdown","fc01e7ec":"markdown","9640a592":"markdown","829ed131":"markdown","672a0ff7":"markdown","71b06880":"markdown","35b8e493":"markdown","1fdee273":"markdown"},"source":{"2581ef85":"import warnings\nwarnings.filterwarnings('ignore')","d2bf4a1e":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n%matplotlib inline\npd.pandas.set_option('display.max_columns', None)\nimport seaborn as sns\nfrom sklearn.metrics import r2_score\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.feature_selection import RFE\nfrom sklearn.linear_model import LinearRegression\nimport statsmodels.api as sm \nfrom statsmodels.stats.outliers_influence import variance_inflation_factor","d4971195":"df=pd.read_csv(\"..\/input\/car-price-prediction\/CarPrice_Assignment.csv\")\ndf.head()","25f91524":"df=df.drop([\"car_ID\"],axis=1)","a556f7b5":"#Data Shape\ndf.shape","f2c032f2":"df.columns","17359d66":"df['CarName'].unique()","51089b5a":"df.isnull().sum()","0cbae345":"#info of dataset\ndf.info()","28c0ea87":"CarCompany = df['CarName'].apply(lambda x : x.split(' ')[0])\ndf.insert(3,\"CarCompany\",CarCompany)","879f02de":"df=df.drop([\"CarName\"],axis=1)\ndf.head()","b37967cb":"print(df[\"drivewheel\"].unique())\nprint(df[\"fuelsystem\"].unique())\nprint(df[\"enginetype\"].unique())\nprint(df[\"carbody\"].unique())","daf3c632":"CarCompany.unique()","4e1206dd":"def replace_name(a,b):\n    df.CarCompany.replace(a,b,inplace=True)\n\nreplace_name(\"maxda\",\"mazda\")\nreplace_name(\"nissan\",\"Nissan\")\nreplace_name(\"porcshce\",\"porsche\")\nreplace_name(\"vokswagen\",\"volkswagen\")\nreplace_name(\"vw\",\"volkswagen\")\nreplace_name(\"toyouta\",\"toyota\")\n\n\n\nprint(df[\"CarCompany\"].unique())","694ebd85":"df[\"cylindernumber\"].value_counts()","dfa15bec":"def convert_feature(x):\n    return x.map({\"two\":2,\"three\":3,\"four\":4,\"five\":5,\"six\":6,\"eight\":8,\"twelve\":12})\n                  \ndf[\"cylindernumber\"]=df[[\"cylindernumber\"]].apply(convert_feature)","c29ae6c9":"df[\"doornumber\"].value_counts()","0215260a":"def number(x):\n    return x.map({\"two\":2,\"four\":4})\ndf[\"doornumber\"]=df[[\"doornumber\"]].apply(number)","28851eb1":"# Data Description\ndf.describe()","d7c0516f":"df_numeric = df.select_dtypes(include =['int64','float64'])\ndf_numeric.head()","dd520cb3":"df_numeric.shape","e6b15f8c":"df_categorical=df.select_dtypes(include=[\"object\"])\ndf_categorical.head()","056527f0":"plt.figure(figsize=(30,35))\nsns.pairplot(df_numeric)\nplt.show()\n","c2e7d333":"plt.figure(figsize=(30, 6))\n\nplt.subplot(1,3,1)\nplt1 = df.CarCompany.value_counts().plot(kind='bar')\nplt.title('Manufacturer')\nplt1.set(xlabel = 'Manufacturer', ylabel='Frequency of company')\n\nplt.subplot(1,3,2)\nplt1 = df.fueltype.value_counts().plot(kind='bar')\nplt.title('Fuel type')\nplt1.set(xlabel = 'Fuel Type', ylabel='Frequency of fuel type')\n\nplt.subplot(1,3,3)\nplt1 = df.carbody.value_counts().plot(kind='bar')\nplt.title('Car Type ')\nplt1.set(xlabel = 'Car Type', ylabel='Frequency of Car type')\n\nplt.show()","a730bf3f":"plt.figure(figsize=(25, 6))\n\ndf1 = pd.DataFrame(df.groupby(['CarCompany'])['price'].mean().sort_values(ascending = False))\ndf1.plot.bar()\nplt.title('Car Company vs Price')","9ab6e1a2":"plt.figure(figsize=(25,6))\n\nplt.subplot(1,2,1)\nplt.title('Engine Type Histogram')\nsns.countplot(df.enginetype, palette=(\"Blues_d\"))\nplt.show()","378cf5fc":"df1 = pd.DataFrame(df.groupby(['enginetype'])['price'].mean().sort_values(ascending = False))\ndf1.plot.bar(figsize=(8,6))\nplt.title('Engine Type vs price')\nplt.show()","cc0da9a3":"plt.figure(figsize=(30,10))\n\nplt.subplot(1,4,1)\nplt.title('Aspiration')\nsns.countplot(x=\"aspiration\", data=df)\n\nplt.subplot(1,4,2)\nplt.title('Number of Cylinders')\nsns.countplot(x=\"cylindernumber\", data=df)\n\nplt.subplot(1,4,3)\nplt.title('Fuel System')\nsns.countplot(x=\"fuelsystem\", data=df)\n\nplt.subplot(1,4,4)\nplt.title('Drive Wheel')\nsns.countplot(x=\"drivewheel\", data=df)\n\nplt.show()","22f8bb99":"plt.figure(figsize=(30,10))\n\nplt.subplot(1,3,1)\nplt.title('Symboling')\nsns.countplot(x=\"symboling\", data=df)\n\nplt.show()","60506349":"plt.figure(figsize=(20,5))\n\n\nplt.subplot(1,3,1)\nplt.title('Fuel Type')\nsns.boxplot(x=\"fueltype\", y=\"price\", data=df)\n\nplt.subplot(1,3,2)\nplt.title('Aspiration')\nsns.boxplot(x=\"aspiration\", y=\"price\", data=df)\n\nplt.subplot(1,3,3)\nplt.title('doornumber')\nsns.boxplot(x=\"doornumber\", y=\"price\", data=df)\n\nplt.show()","938deaeb":"plt.figure(figsize=(20,5))\n\n\nplt.subplot(1,3,1)\nplt.title('Carbody')\nsns.boxplot(x=\"carbody\", y=\"price\", data=df)\n\nplt.subplot(1,3,2)\nplt.title('Drivewheel')\nsns.boxplot(x=\"drivewheel\", y=\"price\", data=df)\n\nplt.subplot(1,3,3)\nplt.title('Engine Location')\nsns.boxplot(x=\"enginelocation\", y=\"price\", data=df)\n\nplt.show()","2ba0205b":"plt.figure(figsize = (20,12))\nsns.boxplot(x = 'CarCompany', y = 'price', data = df)","62551826":"plt.figure(figsize=(20,8))\n\n\nplt.subplot(1,3,1)\nplt.title('Type of Engine')\nsns.boxplot(x=\"enginetype\", y=\"price\", data=df)\n\nplt.subplot(1,3,2)\nplt.title('Cylinder number')\nsns.boxplot(x=\"cylindernumber\", y=\"price\", data=df)\n\nplt.subplot(1,3,3)\nplt.title('Fuel System')\nsns.boxplot(x=\"fuelsystem\", y=\"price\", data=df)\n\nplt.show()","dfd5b8bd":"plt.figure(figsize=(20,12))\n\nplt.subplot(1,3,1)\nplt.title('Symboling')\nsns.boxplot(x=\"symboling\", y=\"price\", data=df)","cb04c0bb":"###For Numerical Features\n\ndef scatter(x,fig):\n    plt.subplot(7,2,fig)\n    plt.scatter(df[x],df[\"price\"])\n    plt.title(x+' vs Price')\n    plt.xlabel(x)\n    plt.ylabel(\"Price\")\n    \nplt.figure(figsize=(15,30))\n\nscatter('symboling',1)\nscatter( 'wheelbase',2)\nscatter('carlength',3)\nscatter('carwidth',4)\nscatter('carheight',5)\nscatter('curbweight',6)\nscatter('enginesize',7)\nscatter('boreratio',8)\nscatter('stroke',9)\nscatter('compressionratio',10)\nscatter('horsepower',11)\nscatter('peakrpm',12)\nscatter('citympg',13)\nscatter('highwaympg',14)\n\nplt.tight_layout()\n\n\n","ab591e33":"plt.figure(figsize = (20,20))\nsns.heatmap(df.corr(), annot = True ,cmap = 'YlGnBu')\nplt.show()","9945ba73":"#creating dummies\ncars_dummies = pd.get_dummies(df_categorical, drop_first = True)\ncars_dummies.shape","b912608f":"df_car = pd.concat([df, cars_dummies], axis =1)","ee5e8b71":"df_car=df_car.drop([\"CarCompany\",\"fueltype\",\"aspiration\",\"carbody\",\"drivewheel\",\"enginelocation\",\"enginetype\",\"fuelsystem\"],axis=1)\n","2144e58c":"df_car.info()","33a6e0c0":"from sklearn.model_selection import train_test_split","f1e94d98":"df_train, df_test = train_test_split(df_car, train_size = 0.7, test_size = 0.3, random_state = 100)","db8bd710":"df_train.shape","df6da6bb":"df_test.shape","aa4b148e":"scaler = StandardScaler()\n","d29ab7a8":"col_list=[\"symboling\",\"doornumber\",\"wheelbase\",\"carlength\",\"carwidth\",\"carheight\",\"curbweight\",\"cylindernumber\",\"enginesize\",\n          \"boreratio\",\"stroke\",\"compressionratio\",\"horsepower\",\"peakrpm\",\"citympg\",\"highwaympg\",\"price\"]","8146efe9":"df_train[col_list] = scaler.fit_transform(df_train[col_list])","32b25dc2":"df_train.describe()","860578c3":"y_train = df_train.pop('price')\nX_train = df_train","016925cf":"lr = LinearRegression()\nlr.fit(X_train,y_train)\n\n# Subsetting training data for 15 selected columns\nrfe = RFE(lr,15)\nrfe.fit(X_train, y_train)","077c4000":"list(zip(X_train.columns,rfe.support_,rfe.ranking_))","1279532d":"cols = X_train.columns[rfe.support_]\ncols","1263c316":"\nX1 = X_train[cols]\nX1_sm = sm.add_constant(X1)\n\nlr_1 = sm.OLS(y_train,X1_sm).fit()","173e0cd8":"print(lr_1.summary())","265433de":"#VIF\nvif = pd.DataFrame()\nvif['Features'] = X1.columns\nvif['VIF'] = [variance_inflation_factor(X1.values, i) for i in range(X1.shape[1])]\nvif['VIF'] = round(vif['VIF'], 2)\nvif = vif.sort_values(by = 'VIF', ascending = False)\nvif","03d0cb85":"lr2 = LinearRegression()\n\nrfe2 = RFE(lr2,10)\nrfe2.fit(X_train,y_train)","ec4d9e2a":"lr2 = LinearRegression()\n\nrfe2 = RFE(lr2,10)\nrfe2.fit(X_train,y_train)","c8e86c51":"supported_cols = X_train.columns[rfe2.support_]\nsupported_cols","aab1e895":"\nX2 = X_train[supported_cols]\nX2_sm = sm.add_constant(X2)\n\nmodel_2 = sm.OLS(y_train,X2_sm).fit()","dd102a2d":"print(model_2.summary())","ca98d36d":"\n#VIF\nvif = pd.DataFrame()\nvif['Features'] = X2.columns\nvif['VIF'] = [variance_inflation_factor(X2.values, i) for i in range(X2.shape[1])]\nvif['VIF'] = round(vif['VIF'], 2)\nvif = vif.sort_values(by = 'VIF', ascending = False)\nvif","037a3445":"X3 = X2.drop(['CarCompany_peugeot'], axis =1)\nX3_sm = sm.add_constant(X3)\n\nModel_3 = sm.OLS(y_train,X3_sm).fit()","53ebb51d":"print(Model_3.summary())","4277294b":"#VIF\nvif = pd.DataFrame()\nvif['Features'] = X3.columns\nvif['VIF'] = [variance_inflation_factor(X3.values, i) for i in range(X3.shape[1])]\nvif['VIF'] = round(vif['VIF'], 2)\nvif = vif.sort_values(by = 'VIF', ascending = False)\nvif","ddd05db3":"X4 = X3.drop(['enginelocation_rear'], axis =1)\nX4_sm = sm.add_constant(X4)\n\nModel_4 = sm.OLS(y_train,X4_sm).fit()","54a51d66":"print(Model_4.summary())","63f5ddd8":"#VIF\nvif = pd.DataFrame()\nvif['Features'] = X4.columns\nvif['VIF'] = [variance_inflation_factor(X4.values, i) for i in range(X4.shape[1])]\nvif['VIF'] = round(vif['VIF'], 2)\nvif = vif.sort_values(by = 'VIF', ascending = False)\nvif","dbfc47e0":"y_train_pred = Model_4.predict(X4_sm)\ny_train_pred.head()","e1a8151e":"Residual = y_train- y_train_pred","0eae4fb8":"sns.distplot(Residual, bins =15)","9aa4a57c":"df_test[col_list] = scaler.transform(df_test[col_list])","284e72d0":"y_test = df_test.pop('price')\nX_test = df_test","39669d0c":"final_cols = X4.columns","f3071bc9":"X_test_model4= X_test[final_cols]\nX_test_model4","476a28a3":"X_test_sm = sm.add_constant(X_test_model4)","1e932b01":"X_test_sm","e3291449":"y_test_pred = Model_4.predict(X_test_sm)","18f5adba":"y_test_pred.head()","00af48de":"\nc = [i for i in range(1,63,1)]\nplt.plot(c, y_test,color = 'Blue')\nplt.plot(c, y_test_pred,color = 'red')\nplt.xlabel(\"VOC\")\nplt.ylabel(\"VOC\")\n","b9496504":"\nplt.scatter(y_test, y_test_pred)\nplt.xlabel('y_test')\nplt.ylabel('y_test_pred')","45698b77":"r_squ = r2_score(y_test,y_test_pred)\nr_squ","c4cf8613":"### 1.Hardtop cars cost is higher as compare to others\n### 2.rwd drive wheel price is high as compare to fwd,4whd.\n### 3.Rear engine are like having constant high range.","4ba819f6":"All the p- values are significant. Let us check VIF.","c7441500":"### It is clear that vehicles Multi-port Fuel Injection [MPFI] fuelsystem have the highest median price. There are \n### also some outliers on the higher price side having MPFI systems.","1cba6186":"### MODEL=3 by dropping \"CarCompany_peugeot\"","70d8d612":"### In first graph ohc engine is most preferred due to its rigidity\n### in second graph dohcv engine is having  high cost ","d57b9fcd":"### Model building using RFE with 15 variables","8c4c59e0":"# Box Plots","9c0c2f81":"#  Model building","5b5a07e4":"### 1. Price of diesel cars is more\n### 2. Turbo aspiration costs more than std as before we have seen in histogram\n### 3. Two & Four doors costs are equal","a8e8b0ed":"### MODEL=2","89e18532":"#### Price is highly (positively) correlated with wheelbase, carlength, carwidth, curbweight, enginesize, horsepower.\n\n#### Price is negatively correlated to symboling, citympg and highwaympg.\n\n#### This suggest that cars having high mileage may fall in the 'economy' cars category, and are priced lower.\n\n#### There are many independent variables which are highly correlated: wheelbase, carlength, curbweight, enginesize etc.. all are positively correlated.","054320f5":"### Residuals","f7ea0f28":"### 0 & 1 are mostly sold cars","5516ac13":"### Prediction Analysis","68ca531a":"Error is normally distributed","6b0a4acc":"### Seperating the numeric & categorical data","204108c4":"#### From above corelation and scatter plots Car height,CompressionRatio,Peak RPM,city MPG,Highway MPG,symboling are not corelated to price. So, excluding these features we can proceed but city mpg and highway mpg are multicolinear so we can create a new vaiable by taking mean of both.","557958c0":"### 1. Toyota is most popular car as sees\n### 2. Gas fuel cars are more preffered.\n### 3. Sedan is most favored car.\n### 4. Jaguar,buick,porsche,bmw high cost cars.\n","fe5924f1":"## Now in cylinder number & door number are present in cateogrical replacing it with numeric value as meaning is same","905e4b93":"As VIF values of some variables are high by our std practice VIF value should be less than 2.6. So, instead of removing it we will build the model by 10 variables.","7942c0b3":"## As we have seen all unique values & in car manufacturer there some spelling mistakes which we have to correct it.","8b2b2601":"### Final Variables to predict car price: \"enginesize\"\t\"CarCompany_bmw\"\t\"CarCompany_buick\"\t\"CarCompany_porsche\"\t\"carbody_hardtop\"\t\"carbody_hatchback\"\t\"enginetype_l\"\t\"enginetype_rotor\"","8a888e62":"All the VIF values and p-values seem to be in a good range. Also the Adjusted R-squared is 87%. \nThis model is explaining most of the variance without being too complex.","68d2eff3":"All the p- values are significant. Let us check VIF.","4aad3144":"## Basically, Dataset is having 205 rows & 26 columns some categorical variables and we need to convert it into dummies & car id is not required as we have the index so drop car id","3233b5cf":"Rescaling the data","e4bb0f4e":"# Creating Dummies","fc01e7ec":"## In Car name we have manufacture model names which is of no use further so removing model name.","9640a592":"All the p- values are significant. Let us check VIF.","829ed131":"### 1.Gas Aspiration is favoured as compare to turbo as maybe it costs high.\n### 2.Four Cylinder cars are more as compare to others\n### 3. mpfi and 2bbl are most common type of fuel systems. mpfi and idi having the highest price range. But there are few data for other categories to derive any meaningful inference.\n### 4. fwd drivewheel is preffered .\n","672a0ff7":"### Model=1","71b06880":"### From the price boxplot it is clear that The brands with the most expensive vehicles in the dataset belong to Bmw,Buick,Jaguar and porsche.Whereas the lower priced cars belong to chevrolet","35b8e493":"### MODEL=4 by dropping \"enginelocation_rear\"","1fdee273":"# Visualising the data for categorical values"}}