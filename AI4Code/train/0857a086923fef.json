{"cell_type":{"6597dcbe":"code","378f64b5":"code","3d9e178f":"code","5fe47113":"code","34bc9d1e":"code","ed90a656":"code","3807832c":"code","9aa39438":"code","8d646a2d":"code","04b03139":"code","55e508f3":"code","9e7e94ac":"code","0d18a529":"markdown","0ccde183":"markdown","7142400c":"markdown","7f4f1435":"markdown","6b9c3f5d":"markdown","90c87c02":"markdown","3ac2f152":"markdown","92c7e9ba":"markdown","04a8a205":"markdown","8c42f4be":"markdown","674ccda3":"markdown"},"source":{"6597dcbe":"import numpy as np\nimport pandas as pd\nimport re\nimport csv\n\nimport fasttext","378f64b5":"train=pd.read_csv('\/kaggle\/input\/nlp-getting-started\/train.csv')\ntest=pd.read_csv('\/kaggle\/input\/nlp-getting-started\/test.csv')\nsubmit=pd.read_csv('\/kaggle\/input\/nlp-getting-started\/sample_submission.csv')","3d9e178f":"train.head()","5fe47113":"# train.isna().sum()\n\ntrain['keyword']=train['keyword'].fillna('none')\ntrain['location']=train['location'].fillna('none')\ntest['keyword']=test['keyword'].fillna('none')\ntest['location']=test['location'].fillna('none')","34bc9d1e":"from sklearn.model_selection import train_test_split\n\nTrain=train.drop('target',axis=1)\nTarget=train['target']\n\nX_tr,X_val,y_tr,y_val=train_test_split(Train,Target,test_size=0.15,random_state=71,stratify=train['target'])","ed90a656":"tr_arr=[]\nval_arr=[]\ntest_arr=[]\n\nfor i,row in X_tr.iterrows():\n    target=y_tr.loc[i]\n    label=f'__label__{target}'\n    text=row['keyword']+' '+row['location']+' '+row['text']\n    label+=' '+text\n    tr_arr.append(label)\n    \nfor i,row in X_val.iterrows():\n    text=row['keyword']+' '+row['location']+' '+row['text']\n    val_arr.append(text)\n    \nfor i,row in test.iterrows():\n    text=row['keyword']+' '+row['location']+' '+row['text']\n    test_arr.append(text)","3807832c":"train_df=pd.DataFrame(tr_arr)\ntrain_df.to_csv('train.txt',index=False,sep=' ',header=False,quoting=csv.QUOTE_NONE,quotechar=\"\",escapechar=\" \")","9aa39438":"model=fasttext.train_supervised('train.txt',label_prefix='__label__',epoch=10)\nprint(model.labels,'are the labels or targets the model is predicting')","8d646a2d":"from sklearn.metrics import accuracy_score\n\nval_arr=[re.sub(r'\\n','',text) for text in val_arr]\n\npred=[int(label[0][-1]) for label in model.predict(val_arr)[0]]\nprint(f'val_acc : {accuracy_score(pred,y_val.values)}')","04b03139":"test_arr=[re.sub(r'\\n','',text) for text in test_arr]\n\npred=[int(label[0][-1]) for label in model.predict(test_arr)[0]]","55e508f3":"submit['target']=pred\nsubmit.head()","9e7e94ac":"submit.to_csv('submission.csv',index=False)","0d18a529":"### Inference","0ccde183":"# What is FastText?\n\nFastText is an open-source, free, lightweight library that allows users to learn text representations and text classifiers. It works on standard, generic hardware. Models can later be reduced in size to even fit on mobile devices.","7142400c":"### Export pandas to .txt file","7f4f1435":"## Here we go\n\n**This notebook puts submission first.**","6b9c3f5d":"### View Data ","90c87c02":"### Make submission","3ac2f152":"### Load Data","92c7e9ba":"![](https:\/\/fasttext.cc\/img\/ogimage.png)","04a8a205":"### Preprocessing text","8c42f4be":"### Ready to use data","674ccda3":"### Load Libarary"}}