{"cell_type":{"1611f723":"code","0889f340":"code","b0068345":"code","5dba1b92":"code","ff6fdfe3":"code","9d512365":"code","70704a12":"code","aab700bd":"code","0014df3f":"code","bfe30a22":"code","be28c7da":"code","dcc764cd":"code","8408b682":"code","66ec6000":"code","064bc625":"code","6f7ccd86":"code","cc085269":"code","b6849129":"code","22e0a0cd":"code","5cb739ee":"code","7c263adb":"code","40b31035":"code","f8d452fd":"code","351de039":"code","e3c309c8":"code","b717acd2":"code","8669dcf3":"code","91dc5736":"code","82582c3b":"code","2c6ffc3a":"code","cd675b71":"code","c3ac50c7":"code","dd1b4436":"code","29cd1acb":"code","3f3ba16c":"code","7f779f33":"code","04c3d5c6":"code","49b114b2":"code","794dbef8":"code","73ac4745":"code","34261a99":"code","eec58b2e":"code","985f87ae":"code","7a265d8d":"code","e80dd846":"code","a7448c55":"code","6325bbce":"code","eba1d1fb":"code","0183ea14":"code","14852777":"code","1e8edf54":"code","53e3a5bc":"code","3b310b53":"code","9566d40c":"code","6323e5a0":"code","f76f04c1":"code","fcefa92b":"code","9b0549a4":"markdown","8a79d698":"markdown","122e0874":"markdown","566396c8":"markdown","9cea029d":"markdown","a113da4c":"markdown","80e357c3":"markdown"},"source":{"1611f723":"import os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","0889f340":"import numpy as np \nimport pandas as pd \nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.model_selection import cross_val_score, train_test_split, GridSearchCV\nfrom sklearn.linear_model import LinearRegression, Lasso, Ridge\nfrom sklearn.svm import SVR\nfrom sklearn.neighbors import KNeighborsRegressor\nfrom sklearn.preprocessing import StandardScaler,MinMaxScaler\nfrom sklearn.metrics import mean_squared_error\n%matplotlib inline","b0068345":"df1 = pd.read_csv('..\/input\/food-prices-in-turkey\/train.csv')\ndf2 = pd.read_csv('..\/input\/food-prices-in-turkey\/test.csv')","5dba1b92":"df1.shape, df2.shape","ff6fdfe3":"df1.isna().sum()","9d512365":"df2.isna().sum()","70704a12":"df = pd.concat([df1, df2], axis=0)","aab700bd":"df.shape","0014df3f":"df","bfe30a22":"df.columns","be28c7da":"df.drop(['ProductId', 'UmId'], axis=1, inplace=True)","dcc764cd":"df.head()","8408b682":"df['ProductName'].value_counts()","66ec6000":"cols_to_replace = df['ProductName'].value_counts()[df['ProductName'].value_counts() < 50].keys()","064bc625":"df['ProductName'].replace(cols_to_replace,['Others' for i in range(6)],inplace=True)","6f7ccd86":"df['ProductName'].value_counts()['Others']","cc085269":"plt.figure(figsize=(15,15))\ndf['ProductName'].value_counts().plot(kind='barh')\nplt.gca().invert_yaxis()\nplt.show()","b6849129":"df.dtypes","22e0a0cd":"df.Place.value_counts().plot(kind='barh')\nplt.gca().invert_yaxis()\nplt.show()\n","5cb739ee":"df.UmName.value_counts()","7c263adb":"df['Place'].value_counts().plot(kind='barh')\nplt.gca().invert_yaxis()\nplt.show()","40b31035":"df_dummies = pd.get_dummies(df[['Place', 'ProductName', 'UmName']],drop_first=True)","f8d452fd":"df_dummies.columns","351de039":"df['Year'] = df['Year']\/10000\ndf['Month'] = df['Month']\/10000\n","e3c309c8":"df.head()","b717acd2":"df_main = pd.concat([df_dummies, df[['Month', 'Year', 'Price']]], axis=1)","8669dcf3":"df_main.shape","91dc5736":"df_main.head()","82582c3b":"x, y = df_main.drop(['Price'],axis=1), df_main['Price']\n\nx_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.25)","2c6ffc3a":"x_train.shape, x_test.shape","cd675b71":"y_train.shape, y_test.shape","c3ac50c7":"model = LinearRegression()\nmodel.fit(x_train, y_train)","dd1b4436":"y_pred_test = model.predict(x_test)\ny_pred_train = model.predict(x_train)","29cd1acb":"model.score(x_test, y_test)","3f3ba16c":"model.score(x_train, y_train)","7f779f33":"mean_squared_error(y_test, y_pred_test)","04c3d5c6":"mean_squared_error(y_train, y_pred_train)","49b114b2":"model_kr = KNeighborsRegressor(n_neighbors=3,metric='euclidean',weights='distance')\nmodel_kr.fit(x_train, y_train)","794dbef8":"model_kr.score(x_test, y_test)","73ac4745":"model_kr.score(x_train, y_train)","34261a99":"clf = GridSearchCV(KNeighborsRegressor(),\n                   param_grid={\n                       'metric':['euclidean','minkowski','manhattan'],\n                       'weights':['uniform','distance'],\n                       'n_neighbors':[3,5,7,11]\n                   },\n                   cv=7\n                  )","eec58b2e":"clf.fit(x_train, y_train)","985f87ae":"cv_result = pd.DataFrame(clf.cv_results_)\ncv_result","7a265d8d":"cv_result[['param_weights','params','mean_test_score']]","e80dd846":"clf.best_estimator_","a7448c55":"model_kr2 = KNeighborsRegressor(metric='manhattan', n_neighbors=3, weights='distance')\nmodel_kr2.fit(x_train, y_train)","6325bbce":"model_kr2.score(x_test, y_test)","eba1d1fb":"model_kr2.score(x_train, y_train)","0183ea14":"y_pred_test_kr = model_kr2.predict(x_test)\ny_pred_train_kr = model_kr2.predict(x_train)","14852777":"mean_squared_error(y_test, y_pred_test_kr)","1e8edf54":"mean_squared_error(y_train, y_pred_train_kr)","53e3a5bc":"pred_kn_test = pd.DataFrame({'Y test KN':y_test,'Y predicted KN':y_pred_test_kr})\npred_kn_train = pd.DataFrame({'Y Train KN':y_train,'Y predicted KN':y_pred_train_kr})","3b310b53":"pred_kn_test.corr()","9566d40c":"pred_kn_train.corr()","6323e5a0":"pred_kn_test.sample(10)","f76f04c1":"x_train.to_csv('MyTrain.csv',index=False)\nx_test.to_csv('MyTest.csv',index=False)","fcefa92b":"import os\nos.listdir()","9b0549a4":"# **Applying KNRegressor**","8a79d698":"# **Model Build and Predictions**","122e0874":"# **Best Estimator and Model Prediction**","566396c8":"# **One Hot Encoding**","9cea029d":"# **EDA**","a113da4c":"# **Splitting and Training**","80e357c3":"# **Correlation Test and Predicted**"}}