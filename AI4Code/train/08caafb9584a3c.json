{"cell_type":{"4f29b156":"code","4479b1f0":"code","1f63ccb1":"code","8959d337":"code","9834ab32":"code","a9aeec60":"code","2bd0d6b7":"code","544b7091":"code","d3302a6d":"code","31936a14":"code","72b9d701":"code","9fc9dc59":"code","c9b6b2bc":"code","5330adcb":"code","8705c89f":"code","2d2af542":"markdown","a6cf3581":"markdown","91eb8609":"markdown","b1d9303a":"markdown"},"source":{"4f29b156":"%config Completer.use_jedi = False","4479b1f0":"from fastai.vision.all import *","1f63ccb1":"train_df = pd.read_csv('..\/input\/digit-recognizer\/train.csv')\ntrain_df.head(3)","8959d337":"train_df = train_df.astype(np.uint8)","9834ab32":"def get_img(line): return line.drop('label').values.reshape(28, 28)","a9aeec60":"plt.imshow(get_img(train_df.loc[100]), cmap = 'gray');","2bd0d6b7":"dblock = DataBlock(\n    blocks = [ImageBlock(cls = PILImageBW), CategoryBlock],\n    splitter = RandomSplitter(valid_pct = 0.2, seed = 42),\n    get_x = get_img,\n    get_y = ColReader('label')\n)\ndls = dblock.dataloaders(train_df, num_workers = 4, bs = 256)\ndls.show_batch()","544b7091":"learn = cnn_learner(dls, resnet34, metrics = accuracy)\nlearn.fine_tune(10)","d3302a6d":"interp = ClassificationInterpretation.from_learner(learn)\ninterp.plot_confusion_matrix()","31936a14":"test_df = pd.read_csv('..\/input\/digit-recognizer\/test.csv')\ntest_df.head(3)","72b9d701":"test_df['label'] = 99\ntest_df = test_df.astype(np.uint8)","9fc9dc59":"dl_test = dls.test_dl(test_df)","c9b6b2bc":"preds, _ = learn.get_preds(dl = dl_test)","5330adcb":"predicted_labels = preds.argmax(dim = 1)\npredicted_labels","8705c89f":"submission = pd.DataFrame({\n    'ImageId': range(1, len(predicted_labels) + 1),\n    'Label': predicted_labels\n})\nsubmission.to_csv('submission.csv', index = False)\nsubmission.head()","2d2af542":"## Learner","a6cf3581":"## Inference","91eb8609":"## Dataloader","b1d9303a":"## Verification"}}