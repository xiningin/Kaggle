{"cell_type":{"9bc4082f":"code","f8eb85b9":"code","dc62ffcc":"code","8292fa6a":"code","9622feb4":"code","2b574e6e":"code","6f87ec32":"code","d461d681":"code","01a678d7":"code","45fc516a":"code","2b39465d":"code","140ed531":"code","c34d1306":"code","7f62ae01":"code","ee44b40b":"code","9acbb79a":"code","dc3a5e37":"code","39778019":"code","6c19f88d":"code","15e4d3ac":"code","0dda0a17":"code","d203f9b0":"code","0a82afc3":"code","e2644c42":"code","cff5b6a8":"code","9af21cb7":"markdown","4e4b41a4":"markdown","9ea5d651":"markdown","4578e9ea":"markdown"},"source":{"9bc4082f":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load","f8eb85b9":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport flask as flsk\n\nfrom pylab import rcParams\nimport warnings\nwarnings.filterwarnings(\"ignore\")\n%matplotlib inline","dc62ffcc":"df=pd.read_csv('..\/input\/credit-card-customer-churn-prediction\/Churn_Modelling.csv')\ndf.tail()","8292fa6a":"df.info()","9622feb4":"df.describe()","2b574e6e":"df.skew()","6f87ec32":"plt.hist(df['Age'])\nplt.xlabel(\"Age\")\nplt.title(\"Age Distribution\")\nplt.show()","d461d681":"plt.scatter(df['Age'], df['Balance'],edgecolors='Red')\nplt.title(\"Age Vs Balance\")\nplt.show()","01a678d7":"# Data to plot\nsizes = df['Geography'].value_counts(sort = True)\nlabels=df['Geography']\ncolors = [\"grey\",\"purple\",\"red\"] \nrcParams['figure.figsize'] = 5,5\n\n# Plot\nplt.pie(sizes,colors=colors,autopct='%1.1f%%',shadow=True,startangle=270)\nplt.title('Geographical Area - Churn in Dataset')\nplt.legend(labels)\nplt.show()","45fc516a":"# Data to plot\nsizes = df['Exited'].value_counts(sort = True)\nlabels=df['Exited']\ncolors = [\"purple\",\"red\"] \nrcParams['figure.figsize'] = 5,5\n\n# Plot\nplt.pie(sizes,colors=colors,autopct='%1.1f%%',shadow=True,startangle=270)\nplt.title('Exit Customers - Churn in Dataset')\nplt.legend(labels)\nplt.show()","2b39465d":"plt.boxplot(df['Age'])\nplt.xlabel(\"Tenure\")\nplt.show()","140ed531":"corr_data = pd.DataFrame(df)\nplt.figure(figsize=(10,7))\nsns.heatmap(corr_data.corr(),annot=True,linewidths=2)","c34d1306":"dataset = df.drop(['RowNumber', 'CustomerId', 'Surname'], axis=1)\ndataset =  dataset.drop(['Geography', 'Gender'], axis=1)","7f62ae01":"Geography = pd.get_dummies(df.Geography).iloc[:,1:]\nGender = pd.get_dummies(df.Gender).iloc[:,1:]","ee44b40b":"dataset = pd.concat([dataset,Geography,Gender], axis=1)","9acbb79a":"X = dataset.drop(['Exited'], axis=1)\ny = dataset['Exited']","dc3a5e37":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.2, random_state = 0)","39778019":"from sklearn.ensemble import RandomForestClassifier\nclassifier = RandomForestClassifier(n_estimators=100,max_depth=10, random_state=100)","6c19f88d":"print(X_test)","15e4d3ac":"classifier.fit(X_train, y_train)","0dda0a17":"predictions = classifier.predict(X_test)","d203f9b0":"predictions","0a82afc3":"from sklearn.metrics import classification_report,confusion_matrix,accuracy_score\nprint(\"Accuracy\",accuracy_score(y_test, predictions))","e2644c42":"result = confusion_matrix(y_test, predictions)\nprint(\"Confusion Matrix:\")\nprint(result)","cff5b6a8":"print(\"Classification Report\\n\",classification_report(y_test,predictions)) \nfeat_importances = pd.Series(classifier.feature_importances_, index=X.columns)\nfeat_importances.nlargest(10).plot(kind='barh')\nplt.show()","9af21cb7":"from sklearn.externals import joblib\njoblib.dump(classifier, \"churn_pred.pkl\")\nobj = joblib.load(\"churn_pred.pkl\")\nX_test","4e4b41a4":"# Model Prediction using Random Forest","9ea5d651":"list = [597, 39, 8, 162532, 3, 1, 0, 36051, 1, 0, 0]\nprint(obj.predict([list]))","4578e9ea":"# Model Evaluation & Deployment"}}