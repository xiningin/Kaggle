{"cell_type":{"ddd287b6":"code","e24a5932":"code","80ff2e4b":"code","dd84ab51":"code","0619aaf6":"code","476edf8b":"code","29175343":"code","59a90e32":"code","bb564177":"code","dc42a76a":"code","94f60115":"code","5a339112":"code","9ae73323":"code","268414c8":"code","3dbb217a":"code","f45b4520":"code","535d2b5e":"code","3e544cde":"code","5be151b9":"code","3137285e":"code","bccd42e8":"code","9e6ba9bd":"code","7842183a":"code","ecd0c61a":"code","ded95b18":"code","e24566b0":"code","264e9c62":"code","934c7d16":"code","3333231e":"markdown","3a1fe75f":"markdown","898481d0":"markdown","0a414aa2":"markdown","6c1143a7":"markdown","2911cd75":"markdown","82aaf324":"markdown","d58a69b7":"markdown","c79827a8":"markdown","cb9dd427":"markdown","2bdb644d":"markdown","d51f46a8":"markdown","d0d68b38":"markdown","1c2b4b59":"markdown","07f00f99":"markdown","4aa488d4":"markdown","33f66503":"markdown"},"source":{"ddd287b6":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport sqlite3\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\nimport matplotlib.pyplot as plt\n%matplotlib inline\n# Any results you write to the current directory are saved as output.\n\nfrom textblob import TextBlob\n\nimport warnings\nwarnings.filterwarnings('ignore')\n\nimport time","e24a5932":"con = sqlite3.connect('..\/input\/database.sqlite')\n\nartists = pd.read_sql('SELECT * FROM artists', con)\ncontent = pd.read_sql('SELECT * FROM content', con)\ngenres = pd.read_sql('SELECT * FROM genres', con)\nlabels = pd.read_sql('SELECT * FROM labels', con)\nyears = pd.read_sql('SELECT * FROM years', con)\nreviews = pd.read_sql('SELECT * FROM reviews', con)\n\ncon.close()","80ff2e4b":"df1 = pd.merge(genres,reviews,on='reviewid')\ndf2 = pd.merge(labels,df1,on='reviewid')\ndf3 = pd.merge(content,df2,on='reviewid')\ndf_final = pd.merge(years,df3,on='reviewid')\ndf_final.head()","dd84ab51":"df_final.drop(['url','author_type','pub_date','pub_weekday','pub_day','pub_month'],axis=1,inplace=True)\ndf_final.dropna(inplace=True)\ndf_final['year'] = df_final['year'].astype(int)\ndf_final['pub_year'] = df_final['pub_year'].astype(int)\ndf_final.head()","0619aaf6":"df_final.drop_duplicates('reviewid',inplace=True)\ndf_final['text_len'] = df_final['content'].apply(lambda x: len(x))\ndf_final['text_words'] = df_final['content'].apply(lambda x: len(x.split()))\ndf_final['uniq_words'] = df_final['content'].apply(lambda x: len(set(x.split())))\ndf_final['lex_den'] = 100*df_final['uniq_words']\/df_final['text_words']\ndf_final.reset_index(inplace=True,drop=True)\ndf_final.head()","476edf8b":"def polarity_calc(text):\n    \n    blob = TextBlob(text)\n    pol_list = []\n    for sent in blob.sentences:\n        pol_list.append(sent.sentiment.polarity)\n        \n    return np.sum(pol_list)","29175343":"def subjectivity_calc(text):\n    \n    blob = TextBlob(text)\n    sub_list = []\n    for sent in blob.sentences:\n        sub_list.append(sent.sentiment.subjectivity)\n        \n    return np.sum(sub_list)","59a90e32":"start = time.time()\ndf_final['polarity'] = df_final['content'].apply(polarity_calc)\nend = time.time()\nprint(\"Time elapsed:: \",end-start,\"(s)\")","bb564177":"start = time.time()\ndf_final['subjectivity'] = df_final['content'].apply(subjectivity_calc)\nend = time.time()\nprint(\"Time elapsed:: \",end-start,\"(s)\")","dc42a76a":"df_final.head()","94f60115":"plt.figure(figsize=(10,8))\nplt.scatter(df_final['polarity'],df_final['subjectivity'], alpha=.25, color='b');\nplt.xlabel('Polarity')\nplt.ylabel(\"Subjectivity\");","5a339112":"df_final['polarity'].corr(df_final['subjectivity'])","9ae73323":"df_final.groupby('genre')['polarity'].mean().plot(kind='barh', figsize=(10,8));\nplt.xlabel('Polarity')\nplt.ylabel('Genre');","268414c8":"df_final.groupby('genre')['subjectivity'].mean().plot(kind='barh', figsize=(10,8));\nplt.xlabel('Subjectivity')\nplt.ylabel('Genre');","3dbb217a":"fig, (ax1,ax2) = plt.subplots(2,1,figsize=(8,6))\ndf_final.groupby(['year'])['polarity'].mean().plot(figsize=(10,8),ax=ax1);\ndf_final.groupby(['year'])['subjectivity'].mean().plot(figsize=(10,8),ax=ax2);\nax1.set_xlabel('Year');\nax2.set_xlabel('Year');\nax1.set_ylabel('Polarity')\nax2.set_ylabel('Subjectivity');","f45b4520":"# Do overall score trends change by genre over the years?\ndf_final[df_final['genre']=='rock'].groupby(['year'])['polarity'].mean()\\\n.plot(figsize=(15,10),color='b',alpha=0.75, label='Rock')\ndf_final[df_final['genre']=='electronic'].groupby(['year'])['polarity'].mean()\\\n.plot(figsize=(15,10),color='r',alpha=0.75, label='Electronic')\ndf_final[df_final['genre']=='folk\/country'].groupby(['year'])['polarity'].mean()\\\n.plot(figsize=(15,10),color='g',alpha=0.75, label='Folk\/Country')\ndf_final[df_final['genre']=='pop\/r&b'].groupby(['year'])['polarity'].mean()\\\n.plot(figsize=(15,10),color='y',alpha=0.75, label='Pop\/RnB')\ndf_final[df_final['genre']=='jazz'].groupby(['year'])['polarity'].mean()\\\n.plot(figsize=(15,10),color='c',alpha=0.75, label='Jazz')\ndf_final[df_final['genre']=='rap'].groupby(['year'])['polarity'].mean()\\\n.plot(figsize=(15,10),color='m',alpha=0.75, label='Rap')\ndf_final[df_final['genre']=='experimental'].groupby(['year'])['polarity'].mean()\\\n.plot(figsize=(15,10),color='k',alpha=0.75, label='Experimental')\ndf_final[df_final['genre']=='metal'].groupby(['year'])['polarity'].mean()\\\n.plot(figsize=(15,10),color='gold',alpha=0.75, label='Metal')\ndf_final[df_final['genre']=='global'].groupby(['year'])['polarity'].mean()\\\n.plot(figsize=(15,10),color='plum',alpha=0.75, label='Global')\nplt.xlabel('Year',fontsize=16)\nplt.ylabel('Mean Polarity (of Sentiment)',fontsize=16);\nplt.legend(fontsize=16);","535d2b5e":"# Do overall score trends change by genre over the years?\ndf_final[df_final['genre']=='rock'].groupby(['year'])['subjectivity'].mean()\\\n.plot(figsize=(15,10),color='b',alpha=0.75, label='Rock')\ndf_final[df_final['genre']=='electronic'].groupby(['year'])['subjectivity'].mean()\\\n.plot(figsize=(15,10),color='r',alpha=0.75, label='Electronic')\ndf_final[df_final['genre']=='folk\/country'].groupby(['year'])['subjectivity'].mean()\\\n.plot(figsize=(15,10),color='g',alpha=0.75, label='Folk\/Country')\ndf_final[df_final['genre']=='pop\/r&b'].groupby(['year'])['subjectivity'].mean()\\\n.plot(figsize=(15,10),color='y',alpha=0.75, label='Pop\/RnB')\ndf_final[df_final['genre']=='jazz'].groupby(['year'])['subjectivity'].mean()\\\n.plot(figsize=(15,10),color='c',alpha=0.75, label='Jazz')\ndf_final[df_final['genre']=='rap'].groupby(['year'])['subjectivity'].mean()\\\n.plot(figsize=(15,10),color='m',alpha=0.75, label='Rap')\ndf_final[df_final['genre']=='experimental'].groupby(['year'])['subjectivity'].mean()\\\n.plot(figsize=(15,10),color='k',alpha=0.75, label='Experimental')\ndf_final[df_final['genre']=='metal'].groupby(['year'])['subjectivity'].mean()\\\n.plot(figsize=(15,10),color='gold',alpha=0.75, label='Metal')\ndf_final[df_final['genre']=='global'].groupby(['year'])['subjectivity'].mean()\\\n.plot(figsize=(15,10),color='plum',alpha=0.75, label='Global')\nplt.xlabel('Year',fontsize=16)\nplt.ylabel('Mean Subjectivity',fontsize=16);\nplt.legend(fontsize=16);","3e544cde":"df_final[df_final['genre']=='rock']['polarity']\\\n.plot(kind='kde',figsize=(10,8),color='b',alpha=0.5, label='Rock')\ndf_final[df_final['genre']=='electronic']['polarity']\\\n.plot(kind='kde',figsize=(10,8),color='r',alpha=0.5, label='Electronic')\ndf_final[df_final['genre']=='folk\/country']['polarity']\\\n.plot(kind='kde',figsize=(10,8),color='g',alpha=0.5, label='Folk\/Country')\ndf_final[df_final['genre']=='pop\/r&b']['polarity']\\\n.plot(kind='kde',figsize=(10,8),color='y',alpha=0.5, label='Pop\/R&B')\ndf_final[df_final['genre']=='jazz']['polarity']\\\n.plot(kind='kde',figsize=(10,8),color='c',alpha=0.5, label='Jazz')\ndf_final[df_final['genre']=='rap']['polarity']\\\n.plot(kind='kde',figsize=(10,8),color='m',alpha=0.5, label='Rap')\ndf_final[df_final['genre']=='rap']['polarity']\\\n.plot(kind='kde',figsize=(10,8),color='m',alpha=0.5, label='Rap')\ndf_final[df_final['genre']=='experimental']['polarity']\\\n.plot(kind='kde',figsize=(10,8),color='k',alpha=0.5, label='Experimental')\ndf_final[df_final['genre']=='metal']['polarity']\\\n.plot(kind='kde',figsize=(10,8),color='gold',alpha=0.5, label='Metal')\ndf_final[df_final['genre']=='global']['polarity']\\\n.plot(kind='kde',figsize=(10,8),color='plum',alpha=0.5, label='Global')\nplt.xlabel('Polarity',fontsize=16)\nplt.ylabel('Density',fontsize=16);\nplt.legend(fontsize=16);","5be151b9":"df_final[df_final['genre']=='rock']['subjectivity']\\\n.plot(kind='kde',figsize=(10,8),color='b',alpha=0.5, label='Rock')\ndf_final[df_final['genre']=='electronic']['subjectivity']\\\n.plot(kind='kde',figsize=(10,8),color='r',alpha=0.5, label='Electronic')\ndf_final[df_final['genre']=='folk\/country']['subjectivity']\\\n.plot(kind='kde',figsize=(10,8),color='g',alpha=0.5, label='Folk\/Country')\ndf_final[df_final['genre']=='pop\/r&b']['subjectivity']\\\n.plot(kind='kde',figsize=(10,8),color='y',alpha=0.5, label='Pop\/R&B')\ndf_final[df_final['genre']=='jazz']['subjectivity']\\\n.plot(kind='kde',figsize=(10,8),color='c',alpha=0.5, label='Jazz')\ndf_final[df_final['genre']=='rap']['subjectivity']\\\n.plot(kind='kde',figsize=(10,8),color='m',alpha=0.5, label='Rap')\ndf_final[df_final['genre']=='rap']['subjectivity']\\\n.plot(kind='kde',figsize=(10,8),color='m',alpha=0.5, label='Rap')\ndf_final[df_final['genre']=='experimental']['subjectivity']\\\n.plot(kind='kde',figsize=(10,8),color='k',alpha=0.5, label='Experimental')\ndf_final[df_final['genre']=='metal']['subjectivity']\\\n.plot(kind='kde',figsize=(10,8),color='gold',alpha=0.5, label='Metal')\ndf_final[df_final['genre']=='global']['subjectivity']\\\n.plot(kind='kde',figsize=(10,8),color='plum',alpha=0.5, label='Global')\nplt.xlabel('Subjectivity',fontsize=16)\nplt.ylabel('Density',fontsize=16);\nplt.legend(fontsize=16);","3137285e":"fig, (ax1,ax2) = plt.subplots(2,1,figsize=(8,6))\ndf_final.groupby(['author'])['polarity'].mean().sort_values(ascending=False)[:10].plot(kind='barh',figsize=(10,8),ax=ax1);\ndf_final.groupby(['author'])['subjectivity'].mean().sort_values(ascending=False)[:10].plot(kind='barh',figsize=(10,8),ax=ax2);\nax1.set_xlabel('Polarity');\nax2.set_xlabel('Subjectivity');\nax1.set_ylabel('')\nax2.set_ylabel('');","bccd42e8":"df_final[df_final.author=='simon goddard']","9e6ba9bd":"def positive_polarity_calc(text):\n    \n    blob = TextBlob(text)\n    pos_pol_list = []\n    for sent in blob.sentences:\n        if sent.sentiment.polarity>0:\n            pos_pol_list.append(sent.sentiment.polarity)\n        \n    return np.sum(pos_pol_list)\n\ndef negative_polarity_calc(text):\n    \n    blob = TextBlob(text)\n    neg_pol_list = []\n    for sent in blob.sentences:\n        if sent.sentiment.polarity<0:\n            neg_pol_list.append(sent.sentiment.polarity)\n        \n    return np.sum(neg_pol_list)","7842183a":"start = time.time()\ndf_final['positive_polarity'] = df_final['content'].apply(positive_polarity_calc)\ndf_final['negative_polarity'] = df_final['content'].apply(negative_polarity_calc)\nend = time.time()\nprint(\"Time elapsed: \",end-start,\"(s)\")","ecd0c61a":"df_final['pol_ratio'] = np.abs(df_final['positive_polarity']\/df_final['negative_polarity'])\ndf_final.head()","ded95b18":"df_final.corr()","e24566b0":"# 1. Net Polarity\nprint(\"Net polarity, correlation with score\")\nfor genre in df_final['genre'].unique():\n    print(genre, df_final[df_final['genre']==genre]['score'].corr(df_final[df_final['genre']==genre]['polarity']))","264e9c62":"# 2. Net positive polarity\nprint(\"Net positive polarity, correlation with score\")\nfor genre in df_final['genre'].unique():\n    print(genre, df_final[df_final['genre']==genre]['score'].corr(df_final[df_final['genre']==genre]['positive_polarity']))","934c7d16":"# 2. Net negative polarity\nprint(\"Net negative polarity, correlation with score\")\nfor genre in df_final['genre'].unique():\n    print(genre, df_final[df_final['genre']==genre]['score'].corr(df_final[df_final['genre']==genre]['negative_polarity']))","3333231e":"### There does seem to be a somewhat linear correlation between the Polarity and the Subjectivity of Pitchfork reviews. But let's check using the Pearson correlation coefficient (which is the default correlation method used by Pandas corr() method). ","3a1fe75f":"### This turns out to be a statistical anomaly, since Simon Goddard just has one review, and for ABBA!! ","898481d0":"### We want to use TextBlob to find the net sentiment (positive and negative) for each review. The polarity column counts the net positive and negative polarity (TextBlob identifies polarities between -1 and +1 for each sentence, and we sum these for each review). The subjectivity column adds the subjectivity value for each sentence (as provided by TextBlob) for every sentence in a review. ","0a414aa2":"### Not much to comment upon, other than the fact that Jazz and Metal both seem to have the same average level of Subjectivity! One could argue that more Subjectivity leads to greater Sentiment polarity, so the fact that these 2 genres have the most Polarized reviews makes sense! ","6c1143a7":"## Analyzing the Sentiment and Subjectivity (via Textblob) of the Pitchfork Reviews dataset","2911cd75":"### Can we correlate the polarity to the review score? What about the ratio of positive to negative polarities for a particular review?","82aaf324":"### Not much distinction according to genre. How much variation in these 2 parameters exists by author?","d58a69b7":"### Reviews by The Picthfork Staff are quite subjective, and Simon Goddard tends to have a lot of overall positive Sentiment. ","c79827a8":"### One final thing:: can we relate polarity to score, by genre?","cb9dd427":"### Let's look at Sentimentality and Subjectivity for albums by date of release, overall and by genre. My intuition says the Sentimentality will be higher for older albums. ","2bdb644d":"### While the positive polarity relates somewhat to the score (as we would expect), the ratio of polarities is negligibly correlated.  Taking the ratio of total positive sentences to negative sentences for a particular review might be a better metric. Let's see if there are any distinctions by genre. ","d51f46a8":"### My intuition was both right and wrong as it turns out! Both Polarity (Sentimentality) and Subjectivity decrease over time when all reviews are considered. Trends for Subjectivity and Sentimentality (Polarity)by genre are rather consistent over time, but there are some peaks and dips to look into. The early 90s seems to be a good period for Rap, for instance. And again, the same point I made in https:\/\/www.kaggle.com\/delayedkarma\/let-s-talk-about-the-text, these are music reviews, with not much scope for literary flourish, or variations in subjectivity and sentiment, really. \n### Let's check the distributions by genre as well","d0d68b38":"### Interestingly enough, Jazz clearly seems to do the the best positive sentiment wise, while Metal does considerable poorly. This is in line with my inference from https:\/\/www.kaggle.com\/delayedkarma\/introductory-eda-and-genre-explorations. What about subjectivity?","1c2b4b59":"### So the two parameters have a somewhat positive correlation. Nothing too concrete. ","07f00f99":"## That's it for now. Some insight, and a lot of exploration into how TextBlob's characterization of Sentiment and Subjectivity compares to music reviews across genres, time and authors. Till next time! ","4aa488d4":"### So now we have the total sentiment polarity and subjectivity (according to TextBlob) for each album review. Let's start looking at identifying some trends using this. How well do these 2 parameters correlate?","33f66503":"### Well it certainly looks like negative polarity has a string correlation with the score for Metal, while the opposite is true for Jazz. Overall, the net polarity relates pretty consistently to the score across all genres, with Metal having the worst correlation, and Global music the highest (though this could just be the consequence of a very low number of reviews for the Global genre). "}}