{"cell_type":{"99bf5540":"code","7114b5d4":"code","713f67eb":"code","5b7b9343":"code","f194fb9f":"code","3842fdbd":"code","80360824":"code","576fe30c":"code","269535c9":"code","8193ad64":"code","e78ee884":"code","88392965":"code","c9e2a015":"code","775bdabc":"code","30541f62":"code","56b0e121":"code","9143537f":"code","1a246600":"code","79d9982a":"code","0a068f32":"code","a3dc5644":"code","30e7bba4":"code","735db2aa":"code","5744493a":"code","c34a4bd3":"code","6bae27d5":"code","72923488":"code","6b4cac35":"code","74f19116":"code","e943d19b":"code","a05c2ec9":"code","aa21b64a":"code","1839abb9":"code","a09e3520":"code","c84ab354":"code","3bb2006d":"code","76b76ec9":"code","72054610":"code","478c064d":"code","80e1c800":"code","cff42512":"code","ee914ead":"code","97398e0f":"markdown","6e19ba85":"markdown","c0bdd137":"markdown","f160bccf":"markdown","79463654":"markdown","ed85960b":"markdown","4aca9dfa":"markdown","b2e61a67":"markdown","14c09547":"markdown","e9cb6392":"markdown","8851cb39":"markdown","e19646c2":"markdown","1b3db1f1":"markdown","5b3c7479":"markdown","85fcae1f":"markdown","1ef0b5a9":"markdown","53ae7cf1":"markdown","eeaa3a10":"markdown","a677a2a7":"markdown","a751f0d1":"markdown","947f5681":"markdown","d3519d20":"markdown","a2d4f5cd":"markdown","1411c6e9":"markdown","3971e1a5":"markdown","bef6e99b":"markdown","05054b29":"markdown","326f1aa9":"markdown","179a4313":"markdown","2d2a4cb3":"markdown"},"source":{"99bf5540":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport statsmodels.api as sm\nimport statsmodels.formula.api as smf\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.metrics import mean_squared_error, r2_score\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","7114b5d4":"data = pd.read_csv('..\/input\/fish-market\/Fish.csv')\ndf = data.copy()\ndf.sample(10)","713f67eb":"df.rename(columns= {'Length1':'LengthVer', 'Length2':'LengthDia', 'Length3':'LengthCro'}, inplace=True)\ndf.head()","5b7b9343":"df.info()","f194fb9f":"print(str('Is there any NaN value in the dataset: '), df.isnull().values.any())","3842fdbd":"sp = df['Species'].value_counts()\nsp = pd.DataFrame(sp)\nsp.T","80360824":"sns.barplot(x=sp.index, y=sp['Species']);\nplt.xlabel('Species')\nplt.ylabel('Counts of Species')\nplt.show()","576fe30c":"df.corr()","269535c9":"sns.heatmap(df.corr(), annot=True, cmap='YlGnBu');","8193ad64":"g = sns.pairplot(df, kind='scatter', hue='Species');","e78ee884":"df.describe().T","88392965":"sns.boxplot(x=df['Weight']);","c9e2a015":"dfw = df['Weight']\ndfw_Q1 = dfw.quantile(0.25)\ndfw_Q3 = dfw.quantile(0.75)\ndfw_IQR = dfw_Q3 - dfw_Q1\ndfw_lowerend = dfw_Q1 - (1.5 * dfw_IQR)\ndfw_upperend = dfw_Q3 + (1.5 * dfw_IQR)","775bdabc":"dfw_outliers = dfw[(dfw < dfw_lowerend) | (dfw > dfw_upperend)]\ndfw_outliers","30541f62":"sns.boxplot(x=df['LengthVer']);","56b0e121":"dflv = df['LengthVer']\ndflv_Q1 = dflv.quantile(0.25)\ndflv_Q3 = dflv.quantile(0.75)\ndflv_IQR = dflv_Q3 - dflv_Q1\ndflv_lowerend = dflv_Q1 - (1.5 * dflv_IQR)\ndflv_upperend = dflv_Q3 + (1.5 * dflv_IQR)\n\ndflv_outliers = dflv[(dflv < dflv_lowerend) | (dflv > dflv_upperend)]\ndflv_outliers","9143537f":"sns.boxplot(x=df['LengthDia']);","1a246600":"dfdia = df['LengthDia']\ndfdia_Q1 = dfdia.quantile(0.25)\ndfdia_Q3 = dfdia.quantile(0.75)\ndfdia_IQR = dfdia_Q3 - dfdia_Q1\ndfdia_lowerend = dfdia_Q1 - (1.5 * dfdia_IQR)\ndfdia_upperend = dfdia_Q3 + (1.5 * dfdia_IQR)\n\ndfdia_outliers = dfdia[(dfdia < dfdia_lowerend) | (dfdia > dfdia_upperend)]\ndfdia_outliers","79d9982a":"sns.boxplot(x=df['LengthCro']);","0a068f32":"dfcro = df['LengthCro']\ndfcro_Q1 = dfcro.quantile(0.25)\ndfcro_Q3 = dfcro.quantile(0.75)\ndfcro_IQR = dfcro_Q3 - dfcro_Q1\ndfcro_lowerend = dfcro_Q1 - (1.5 * dfcro_IQR)\ndfcro_upperend = dfcro_Q3 + (1.5 * dfcro_IQR)\n\ndfcro_outliers = dfcro[(dfcro < dfcro_lowerend) | (dfcro > dfcro_upperend)]\ndfcro_outliers","a3dc5644":"df[142:145]","30e7bba4":"df1 = df.drop([142,143,144])\ndf1.describe().T","735db2aa":"# Dependant (Target) Variable:\ny = df1['Weight']\n# Independant Variables:\nX = df1.iloc[:,2:7]","5744493a":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=1)","c34a4bd3":"print('How many samples do we have in our test and train datasets?')\nprint('X_train: ', np.shape(X_train))\nprint('y_train: ', np.shape(y_train))\nprint('X_test: ', np.shape(X_test))\nprint('y_test: ', np.shape(y_test))","6bae27d5":"reg = LinearRegression()\nreg.fit(X_train,y_train)","72923488":"# My model's parameters:\nprint('Model intercept: ', reg.intercept_)\nprint('Model coefficients: ', reg.coef_)","6b4cac35":"print('y = ' + str('%.2f' % reg.intercept_) + ' + ' + str('%.2f' % reg.coef_[0]) + '*X1 ' + str('%.2f' % reg.coef_[1]) + '*X2 ' +\n      str('%.2f' % reg.coef_[2]) + '*X3 + ' + str('%.2f' % reg.coef_[3]) + '*X4 + ' + str('%.2f' % reg.coef_[4]) + '*X5')","74f19116":"y_head = reg.predict(X_train)","e943d19b":"r2_score(y_train, y_head)","a05c2ec9":"from sklearn.model_selection import cross_val_score\ncross_val_score_train = cross_val_score(reg, X_train, y_train, cv=10, scoring='r2')\nprint(cross_val_score_train)","aa21b64a":"cross_val_score_train.mean()","1839abb9":"y_pred = reg.predict(X_test)","a09e3520":"print(r2_score(y_test, y_pred))","c84ab354":"plt.scatter(X_test['LengthCro'], y_test, color='red', alpha=0.4)\nplt.scatter(X_test['LengthCro'], y_pred, color='blue', alpha=0.4)\nplt.xlabel('Cross Length in cm')\nplt.ylabel('Weight of the fish')\nplt.title('Linear Regression Model for Weight Estimation');","3bb2006d":"plt.scatter(X_test['LengthVer'], y_test, color='purple', alpha=0.5)\nplt.scatter(X_test['LengthVer'], y_pred, color='orange', alpha=0.5)\nplt.xlabel('Vertical Length in cm')\nplt.ylabel('Weight of the fish')\nplt.title('Linear Regression Model for Weight Estimation');","76b76ec9":"plt.scatter(X_test['LengthDia'], y_test, color='purple', alpha=0.4)\nplt.scatter(X_test['LengthDia'], y_pred, color='green', alpha=0.4)\nplt.xlabel('Diagonal Length in cm')\nplt.ylabel('Weight of the fish')\nplt.title('Linear Regression Model for Weight Estimation');","72054610":"plt.scatter(X_test['Height'], y_test, color='orange', alpha=0.5)\nplt.scatter(X_test['Height'], y_pred, color='blue', alpha=0.5)\nplt.xlabel('Height in cm')\nplt.ylabel('Weight of the fish')\nplt.title('Linear Regression Model for Weight Estimation');","478c064d":"plt.scatter(X_test['Width'], y_test, color='gray', alpha=0.5)\nplt.scatter(X_test['Width'], y_pred, color='red', alpha=0.5)\nplt.xlabel('Width in cm')\nplt.ylabel('Weight of the fish')\nplt.title('Linear Regression Model for Weight Estimation');","80e1c800":"y_pred1 = pd.DataFrame(y_pred, columns=['Estimated Weight'])\ny_pred1.head()","cff42512":"y_test1 = pd.DataFrame(y_test)\ny_test1 = y_test1.reset_index(drop=True)\ny_test1.head()","ee914ead":"ynew = pd.concat([y_test1, y_pred1], axis=1)\nynew","97398e0f":"**Correlation of the Variables:**","6e19ba85":"**Dividing Dataset into Train and Test Datasets**","c0bdd137":"**Analysing and Dealing with Outliers**","f160bccf":"In our dataset, index number 142, 143 and 144 are the outliers.\n\nIn this study I am going to erase these 3 data entries from my dataset.","79463654":"**Basic Statistics of the Dataset:**","ed85960b":"The aim of this study is to estimate weight of the fish indivuduals from their measurements through using linear regression model.\n\nThis study can be improved to use in fish farms. Individual fish swimming in front of the camera can be measured from the video image and the weight of the fish can be estimated through the linear regression model.","4aca9dfa":"**Sklearn Library Linear Regression Model:**\n\nI will train my model by using training dataset.","b2e61a67":"**4. VISUALISATION OF THE PREDICTIONS:**","14c09547":"**2. PREPARING THE MACHINE LEARNING MODEL:**","e9cb6392":"But if we change random_state our train and test samples will be different and our model's score will be different. \nIn order to eliminate this change I will use cross validation:","8851cb39":"**MULTIPLE LINEAR REGRESSION MODEL FOR WEIGHT ESTIMATION FROM MEASUREMENTS OF THE FISH**","e19646c2":"**Analysing the Success of the Trained Model from Test Dataset and Predictions:**","1b3db1f1":"**My Model's Linear Regression Formula:**","5b3c7479":"**Analysing the Success of the Model from Train Dataset and Predictions:**","85fcae1f":"**Outliers of the Dataset:**","1ef0b5a9":"**Separating Dependant and Independant Variables**","53ae7cf1":"From the results above, one can see there is a tendency towards errorous estimations when the weight is small. ","eeaa3a10":"I hope you enjoy this study and I would appreciate if you add your comments below.\n\nMelih Akda\u011f","a677a2a7":"**Meanings of the Columns:**\n* Species: Species name of fish\n* Weight: Weight of fish in gram\n* Length1: Vertical length in cm\n* Length2: Diagonal length in cm\n* Length3: Cross length in cm\n* Height: Height in cm\n* Width: Diagonal width in cm\n\nOur dependent variable is 'Weight'. Independent variables are 'species', different lengths, 'height' and 'width'.\n\nI will use independent variables (measurements of the fish) to estimate dependent variable (weight of the fish). ","a751f0d1":"**Using Trained Model and Test Dataset to Estimate Weights:**","947f5681":"**Multiple Linear Regression Formula:**\n\ny = b0 + b1*X1 + b2*X2 + b3*X3 + ... + bn*Xn\n\ny : Dependent variable\n\nb0 : Constant\n\nb1 - bn : Coefficients\n\nX1 - Xn : Independent variables","d3519d20":"**Changing the Column Names:**","a2d4f5cd":"**Investigating Missing Values:**","1411c6e9":"**Reanalysing Basic Statistics After Eliminating Outliers**","3971e1a5":"**3. PREDICTIONS BY USING THE MODEL**","bef6e99b":"**5. COMPARING REAL AND PREDICTED WEIGHTS**","05054b29":"**Different Species and Their Counts:**","326f1aa9":"**1. UNDERSTANDING THE DATASET**","179a4313":"There are 10 different versions of r2 scores using my model (reg). If I get the average of this I can achieve cross validated r2 score of my training model:","2d2a4cb3":"**Predicting Weights from Train Dataset:**"}}