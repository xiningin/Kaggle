{"cell_type":{"1af81270":"code","0ef6bbaf":"code","245f7e63":"code","a381aa67":"code","519b863d":"code","876d198c":"code","3e737148":"markdown","d0ffb0ab":"markdown","16fd7249":"markdown","6cd6b1fe":"markdown","f378bd92":"markdown"},"source":{"1af81270":"import numpy as np\nimport matplotlib.pyplot as plt\nimport pandas as pd","0ef6bbaf":"dataset = pd.read_csv('..\/input\/cricket-chirp-vs-temperature\/Cricket_chirps.csv')\nx = dataset.iloc[:,:-1].values\ny_o = dataset.iloc[:,-1].values\n\nplt.scatter(x, y_o)\nprint(f\"Total number of data points: {len(y_o)}\")","245f7e63":"def RANSAC(itr, limit, tau, x, y_o, m):\n    \"\"\"\n    Inputs- itr : no of iteration\n            limit : the value of k^2 in chebyshev inequality\n            tau : minimum fraction of points that must satisfy chebyshev inequality\n            x : x coordinate data\n            y_o : y coordinate data\n            m : number of unknows\n            \n    Outputs- best_slope : best slope calculated from RANSAC\n             best_intercept : best intercept calculated from RANSAC\n    \"\"\"\n    mode = tau * len(y_o)\n    max_counter = 0 # counter to store highest number of points considered as inliers\n    \n    for i in range(itr):\n        print(f\"\\nItr No:{i+1}\")\n        s = np.shape(x)\n        index = np.random.randint(0, s[0], m+1) #randomly select m+1 points from given dataset\n        \n        Y_vector = [] #create a Y_vector = X_matrix * unknown_vector\n        X_matrix = np.zeros((m+1, m+1))\n        for j in range(m+1):\n            X_matrix[j,:] = np.concatenate((x[index[j]], np.ones((1))))\n            Y_vector = np.concatenate((Y_vector, y_o[index[j]:index[j]+1]), axis = 0)\n        Y_vector = np.reshape(Y_vector,(len(Y_vector),1))\n        \n        i = np.eye(m+1, m+1)\n        X_inverse = np.linalg.lstsq(X_matrix, i, rcond=None)[0]\n        unknown = np.matmul(X_inverse, Y_vector)    # get the value of unknown_vector = X_inverse * Y_vector\n        \n        y_new = np.zeros((len(y_o))) + unknown[-1]\n        for j in range(m):\n            y_new[:] += unknown[0]*x[:,j]  #get new line that is y_new value\n\n        Error = (y_o - y_new)**2  #get error square\n        mu = Error.mean() #get mean of error square\n        std = Error.std() #get standard dev of error square\n        #print(mu, std)\n\n        counter = 0 #to store number of points satisfy chebyshev inequality\n\n        #loop to count number of points satisfy chebyshev inequality\n        for j in range(0,len(y_o)):\n            if np.abs((Error[j]-mu)\/std) < (limit\/mu):\n                counter += 1\n                \n        if counter > max_counter: # to store best solution\n            max_counter = counter\n            best_value = unknown\n    \n        #show plot of new line \n        plt.plot(x, y_new, c = 'red')\n        plt.scatter(x, y_o)\n        plt.show()\n        \n        print(f\"Points satisfied: {counter}\")\n\n        #loop termination criterior\n        if counter >= mode:\n            break\n            \n    if max_counter == 0: #if no solution then store coefficient value = 0\n        best_value = np.zeros((len(y_o), 1))\n    return best_value, max_counter\n","a381aa67":"#init parameters of RANSAC \nitr = 100 #no of iteration\nlimit = 1 #the value of k^2 in chebyshev inequality\ntau = 0.6 #minimum fraction of points that must satisfy chebyshev inequality\nnumber_of_unknowns = np.shape(x)[1]\ncalculated_value, inliers = RANSAC(itr, limit, tau, x, y_o, number_of_unknowns)","519b863d":"print(\"The equation of line is: \\n\")\nprint(\"y = \", end = \"\")\nfor j in range(number_of_unknowns):\n    print(f\"{calculated_value[j]}*x[{j}] + \", end = \"\")\nprint(f\"{calculated_value[number_of_unknowns]}\")\n\nprint(f\"\\n\\n Fraction of points satisfied inliers = {inliers\/len(y_o)}\")","876d198c":"#show plot of new line \ny_best = x*calculated_value[0] + calculated_value[1]\nplt.plot(x, y_best, c = 'red')\nplt.scatter(x, y_o)\nplt.show()","3e737148":"# RANSAC Algorithm\nThis program shows functioning of RANSAC algo.\nHere we are generating n number of points around the line y = ax + b.","d0ffb0ab":"# Show the result","16fd7249":"Input the dataset","6cd6b1fe":"This function has RANSAC main code","f378bd92":"Init the parameters for RANSAC and call the function"}}