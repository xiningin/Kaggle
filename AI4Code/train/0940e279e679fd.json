{"cell_type":{"13ff8346":"code","c3b88ced":"code","6c672d76":"code","d2deffd5":"code","e702ea03":"code","12939ebd":"code","4f214ddc":"code","13f8db8c":"code","2878b101":"code","723763d5":"code","00553b9f":"markdown","2e64da7a":"markdown"},"source":{"13ff8346":"import pandas as pd\n\nmain_file_path = '..\/input\/train.csv'\ndata = pd.read_csv(main_file_path)\nprint(data.describe())\n\n","c3b88ced":"iowa_price_data = data.SalePrice\n\nprint(iowa_price_data.describe())\nprint(iowa_price_data.head())","6c672d76":"iowa_price_lot_columns = ['SalePrice','LotArea']\niowa_price_lot = data[iowa_price_lot_columns]\nprint(iowa_price_lot.describe())","d2deffd5":"y = iowa_price_data\n#determining predictors\niowa_predictors = ['LotArea','YearBuilt','1stFlrSF','2ndFlrSF','FullBath','BedroomAbvGr','TotRmsAbvGrd']\nX = data[iowa_predictors]\n#importing decision tree\nfrom sklearn.tree import DecisionTreeRegressor\niowa_model = DecisionTreeRegressor()\n#determining fit for model\niowa_model.fit(X,y)\n\n#printing var for the first 5 houses\nprint(X.head())\nprint('For these 5 houses, their predicted prices are..')\n#printing predictions\nprint(iowa_model.predict(X.head()))","e702ea03":"#finding MAE\niowa_predicted_prices = iowa_model.predict(X)\n#import MAE\nfrom sklearn.metrics import mean_absolute_error\nmean_absolute_error(y,iowa_predicted_prices)\n\n#but this is wrong as we are validating the prediciton with data we used for prediction","12939ebd":"#we now break up data to reserve one for validation\nfrom sklearn.model_selection import train_test_split\n#we split into 2 var, train and val. Could include more if needed\ntrain_X, val_X, train_y, val_y = train_test_split(X, y,random_state = 0)\niowa_model = DecisionTreeRegressor()\niowa_model.fit(train_X,train_y)\n#based on iowa_model that was trained using training data, i predict using validation data\nval_predictions = iowa_model.predict(val_X)\nprint(mean_absolute_error(val_y, val_predictions))","4f214ddc":"#now we compare number of leaves in a decision tree to determing the best possible number of leaves\n#so here we def a function get_mae to make it easier\ndef get_mae(max_leaf_nodes, predictors_train, predictors_val, targ_train, targ_val):\n    model = DecisionTreeRegressor(max_leaf_nodes=max_leaf_nodes, random_state=0)\n    model.fit(predictors_train, targ_train)\n    preds_val = model.predict(predictors_val)\n    mae = mean_absolute_error(targ_val, preds_val)\n    return(mae)\n\n#using a for function, we run get_mae multiple times to get values of MAE to compare\nfor i in [5,50,500,5000]:\n    my_mae = get_mae(i,train_X,val_X,train_y,val_y) \n    #\\t just represents indent in normal documents\n    print(\"Max leaf nodes: %d  \\t\\t Mean Absolute Error:  %d\" %(i, my_mae))\n    #from data it seems 50 nodes is the best","13f8db8c":"from sklearn.ensemble import RandomForestRegressor\nfrom sklearn.metrics import mean_absolute_error\n\nforest_model = RandomForestRegressor()\nforest_model.fit(train_X, train_y)\niowa_preds = forest_model.predict(val_X)\nprint(mean_absolute_error(val_y, iowa_preds))","2878b101":"import numpy as np\nimport pandas as pd\nfrom sklearn.ensemble import RandomForestRegressor\n# Read the test data\ntest = pd.read_csv('..\/input\/test.csv')\n\ntest_X = test[iowa_predictors]\npredicted_prices = iowa_model.predict(test_X)\nprint(predicted_prices)","723763d5":"my_submission = pd.DataFrame({'Id': test.Id, 'SalePrice': predicted_prices})\n# you could use any filename. We choose submission here\nmy_submission.to_csv('submission.csv', index=False)","00553b9f":"What we're doing next is to insteas utilise random forest to generate better predictions based on exisiting data we used in the first ML model","2e64da7a":"Now we test this model utilising the provided test data"}}