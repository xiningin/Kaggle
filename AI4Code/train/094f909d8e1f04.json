{"cell_type":{"0a85adeb":"code","b25fa15f":"code","9d757ef0":"code","8a77a7ea":"code","d6e1aaee":"code","b4a05250":"code","eb607cd7":"code","9a19c7ad":"code","aefb682b":"code","501b7ab5":"code","fbb46aad":"code","7dbdf1df":"code","6ca85318":"code","4ea5db9c":"code","d153fd6e":"code","5d59907b":"code","fe212012":"code","385c6ce8":"code","9bc9c635":"code","979fbf6e":"code","3af9bad6":"code","1aeb2603":"code","4c4338a1":"code","b6cd47e7":"markdown","f1d08772":"markdown","5c6f7625":"markdown","9f75d09e":"markdown","cabdd513":"markdown","9e3bf312":"markdown","a269c99e":"markdown","1909b75f":"markdown","315de8c7":"markdown","5f499f47":"markdown","8eda26ee":"markdown","454e316e":"markdown","a265e8a5":"markdown","480ab497":"markdown","c1acd953":"markdown","78bdc422":"markdown","87006a46":"markdown","d9813207":"markdown","c1b0756e":"markdown","0c279b2d":"markdown","088f61fb":"markdown"},"source":{"0a85adeb":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nfrom scipy import stats\nfrom seaborn import heatmap\nfrom collections import Counter\nfrom sklearn.preprocessing import StandardScaler as ss, MinMaxScaler as mms\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","b25fa15f":"df = pd.read_csv('..\/input\/2020-us-general-election-turnout-rates\/2020 November General Election - Turnout Rates.csv')","9d757ef0":"df.head()","8a77a7ea":"for col in df:\n    df[col] = df[col].fillna(0)","d6e1aaee":"state_abv = df['State Abv']\ndf = df.drop(['State', 'Source', 'Official\/Unofficial', 'Overseas Eligible', 'State Abv'], axis=1)","b4a05250":"cols = ['Total Ballots Counted (Estimate)', 'Vote for Highest Office (President)', \n        'Voting-Eligible Population (VEP)', 'Voting-Age Population (VAP)', 'Prison', 'Probation', \n        'Parole', 'Total Ineligible Felon']","eb607cd7":"for col in cols:\n    df[col] = [int(''.join(str(i).split(','))) for i in df[col]]","9a19c7ad":"for col in ['VEP Turnout Rate', '% Non-citizen']:\n    df[col] = [float(i[:-1]) for i in df[col]]\n\ndf = df.drop(0)","aefb682b":"def bar_charts(column, x, y, title):\n    colors = np.array([['#EEE888', '#776699', '#DD111D', '#FFFF22', '#f8f8ff', '#F0EE82', '#BB69E4', \n                       '#BBBECC', '#CDD98C', 'b']*5]).reshape(1, -1)[0]\n\n    fig, ax = plt.subplots(1, 1, figsize=(17, 9))\n    values = pd.Series(dict(zip(state_abv[1:], \n                                df[column]))).sort_values(ascending=False)\n    values = values[values!=0]\n    \n    rects = ax.bar(values.keys(), values, color=colors, edgecolor='black', linewidth=1.5)\n    ax.set_title(title)\n    ax.set_xlabel(x)\n    ax.set_ylabel(y)\n\n    for rect in rects:\n        percent = rect.get_height()\/df[column].sum()\n        text = percent*100\n        if percent > 0:\n            dec = str(percent)[4]\n        else:\n            dec = '0'\n        height = rect.get_height()\n        ax.text(rect.get_x() + rect.get_width()\/2., 1*height,'%d' % text+'.'+dec, ha='center', va='bottom',\n                fontsize=10)\n\n    plt.show()","501b7ab5":"def pie_charts(column):\n    num = 20\n    values = pd.Series(dict(zip(state_abv[1:], df[column]))).sort_values(ascending=False)\n    fig, ax = plt.subplots(1, 1, figsize=(9, 9))\n    ax.pie(values[:num], labels=values.keys()[:num], autopct=lambda p:f'{p:.2f}%', labeldistance=0.75, \n           explode=[0.1]*num, shadow=True, textprops={'fontsize':10})\n    plt.title(column)\n    plt.show()","fbb46aad":"pie_charts('Total Ballots Counted (Estimate)')","7dbdf1df":"bar_charts('Vote for Highest Office (President)', 'State', 'Number of votes for highest office', \n           'Number of votes for highest office per state (%)')","6ca85318":"pie_charts('VEP Turnout Rate')","4ea5db9c":"bar_charts('Voting-Eligible Population (VEP)', 'State', 'Population', 'Voting-Eligible Population per state (%)')","d153fd6e":"pie_charts('Voting-Age Population (VAP)')","5d59907b":"bar_charts('% Non-citizen', 'State', 'Non-citizen (%)', 'Non-citizens per state (%)')","fe212012":"pie_charts('Prison')","385c6ce8":"bar_charts('Probation', 'State', 'Number of probations', 'Number of probations per state (%)')","9bc9c635":"pie_charts('Parole')","979fbf6e":"bar_charts('Total Ineligible Felon', 'State', 'Ineligible Felons', 'Number of Ineligible Felons per state (%)')","3af9bad6":"for col in df.columns.drop('VEP Turnout Rate'):\n    fig, axes = plt.subplots(1, 5, figsize=(15, 3))\n    \n    f1 = df[col]\n    f2 = (df[col]+1).transform(np.log)\n    f3 = pd.DataFrame(stats.boxcox(df[col]+1)[0])\n    f4 = pd.DataFrame(ss().fit_transform(np.array(df[col]).reshape(-1, 1)))\n    f5 = pd.DataFrame(mms().fit_transform(np.array(df[col]).reshape(-1, 1)))\n    \n    for plot in [[axes[0], f1, 'lightgreen', 'Normal'], [axes[1], f2, 'pink', 'Log'], \n                 [axes[2], f3, 'yellow', 'Box Cox'], [axes[3], f4, 'orange', 'Standard Scaler'], \n                 [axes[4], f5, 'skyblue', 'Min Max Scaler']]:\n        ax = plot[0]\n        feature = plot[1]\n        colour = plot[2]\n        transform = plot[3]\n        \n        feature.hist(ax=ax, color=colour)\n        ax.set_title(transform)\n        ax.set_xlabel(col)\n        \n        deciles = feature.quantile([.1, .2, .3, .4, .5, .6, .7, .8, .9])\n        for pos in np.array(deciles).reshape(1, -1)[0]:\n            handle = ax.axvline(pos, color='darkblue', linewidth=1)\n        ax.legend([handle], ['decile'])\n\nplt.show()","1aeb2603":"j = 0\nfig, axes1 = plt.subplots(1, 3, figsize=(15, 3))\nfig, axes2 = plt.subplots(1, 4, figsize=(15, 3))\naxes = pd.concat([pd.Series(axes1), pd.Series(axes2)]).reset_index(drop=True)\n\nfor i in [['orange', 'Total Ballots Counted (Estimate)'], ['pink', 'Voting-Eligible Population (VEP)'],\n        ['skyblue', 'Voting-Age Population (VAP)'], ['lightblue', 'Prison'], ['lightgreen', 'Probation'],\n        ['yellow', 'Parole'], ['orange', 'Total Ineligible Felon']]:\n    name = i[1]\n    colour = i[0]\n    col = df[name]\n    diff = (col.max() - col.min()) \/ 100\n    bins = np.digitize(col, np.arange(col.min(), col.max(), diff))\n    df[name+'_bin'] = bins\n    pd.DataFrame(bins).hist(ax=axes[j], color=colour)\n    axes[j].set_title(name)\n        \n    deciles = pd.DataFrame(bins).quantile([.1, .2, .3, .4, .5, .6, .7, .8, .9])\n    for pos in np.array(deciles).reshape(1, -1)[0]:\n        handle = axes[j].axvline(pos, color='darkblue', linewidth=1)\n    axes[j].legend([handle], ['decile'])\n    j += 1\n    \nplt.show()","4c4338a1":"orig = list(df.columns.drop('VEP Turnout Rate'))\ncols = [[pd.DataFrame(stats.boxcox(df[orig[0]]+1)[0]), 'Total Ballots Counted (Estimate)', 'boxcox'], \n        [pd.DataFrame(ss().fit_transform(np.array(df[orig[1]]).reshape(-1, 1))), 'Vote for Highest Office (President)', 'standard'],\n        [(df[orig[2]]+1).transform(np.log), 'Voting-Eligible Population (VEP)', 'log'], \n        [pd.DataFrame(stats.boxcox(df[orig[3]]+1)[0]), 'Voting-Age Population (VAP)', 'boxcox'], \n        [(df[orig[4]]+1).transform(np.log), '% Non-citizen', 'log'], \n        [pd.DataFrame(stats.boxcox(df[orig[5]]+1)[0]), 'Prison', 'boxcox'], \n        [pd.DataFrame(stats.boxcox(df[orig[6]]+1)[0]), 'Probation', 'boxcox'], \n        [(df[orig[7]]+1).transform(np.log), 'Parole', 'log'], \n        [pd.DataFrame(stats.boxcox(df[orig[8]]+1)[0]), 'Total Ineligible Felon', 'boxcox']]\n\nfor col in cols:\n    transform = col[0]\n    name = col[1]\n    transform_name = col[2]\n    df[name+'_'+transform_name] = transform\n    \ndf = df.fillna(0)","b6cd47e7":"Then, we initialize a variable 'state_abv' to the 'State Abv' column of our dataframe. Then, we drop the 'State', 'Source', 'Official\/Unofficial', 'Overseas Eligible', 'State Abv' columns from df.","f1d08772":"Lastly, the transforms for the features are added to our dataset.","5c6f7625":"## Probations\nThe bar chart below shows how many people on probation voted per state. Georgia had the most, with over a fifth, then Texas with a little under one fith, and afterwards is Florida with roughly a tenth.","9f75d09e":"## Prison\nThe next pie chart visualises how many people voted in prison per state. Texas (16.5%) has the most, then California (11.2%) and Florida (9.8%).","cabdd513":"## Preparing the dataset\nFirstly, the null values are replaced with zeros.","9e3bf312":"## Voting-Eligible Population\nNow we will look at how much of the population is eligible to vote for the election. It is shown that California leads in these numbers, as they have a value of 11%. Following that is Texas with 8% and Florida with 6%. Afterwards, the values take a gradual decrease.","a269c99e":"## Parole\nThe final pie chart shows how many people on parole voted per state. The state with the most on parole is Texas, as they have over a fifth, and then is California, with a little less than Texas. The two main states make up for almost half of the entire United States!","1909b75f":"## VEP Turnout Rate\nThe subsequent pie plot tells us that the VEP (Voting-Eligible Population) who turned out is roughly the same within the states, from 4-5%.","315de8c7":"We only wish to examine the values of the states in America, therefore the 'United States' row is removed.","5f499f47":"The final piece of visualisation that we will perform is binning seven of our features.","8eda26ee":"## Visualising data transformations\nNow we will look at the distributions of our different features and compare them to how they would look like while transformed using log, box cox, standard and min max scaler.","454e316e":"## % Non-citizens\nThe subsequent bar graph shows that the city which has the most non-citizens that vote is California, which has 5%, followed by Texas with 4.5% and Nevada, which has 4.1%","a265e8a5":"## Ineligible Felons\nThe final bar graph shows how many felons cannot vote in the US. The state with the highest count of this number is Texas (16.8%), followed by Georgia (11.2%) and thirdly Florida (7.6%).","480ab497":"## Total Ballots Counted (Estimate)\nThe following pie chart shows that California has the most counted ballots, with a little under one seventh of the entire number of ballots. Then follows Texas, with almost a tenth, and Florida, with a small amount less than Texas.","c1acd953":"## Voting-Age Population\nThe actual voting-age population of the states has California in the lead with 15%, then Texas at 11% and Florida with 9%","78bdc422":"## Vote for Highest Office (President)\nThe bar chart below visualises the number of votes for highest office, however, due to the significant amount of missing values in this feature, this is not a fair judgement of the real votes for highest office. Though in this instance, Texas leads with a value of over a fifth. Then follows Michigan with over a tenth and Virginia which has 8%.","87006a46":"This 'pie_charts' function plots out a pie chart which shows the twenty most frequent states states in the column and their percentages.","d9813207":"Now, we convert the variables in our data to numerical format by removing the commas and converting it from string to integer.","c1b0756e":"Here, the 'bar_charts' function is defined, which plots out the non-zero states and displays above them the percentage that each one contributes to the feature.","0c279b2d":"### Thank you for reading my notebook.\n### If you enjoyed this notebook and found it helpful, please give it an upvote and provide feedback as it would help me make more of these.","088f61fb":"## 2020 US General Election Turnout Visualisation\nHello everyone! Today we will be taking a look at the 2020 US General Election Turnout dataset and visualise its features. We will also graph the distribution of the features as they are transformed using different techniques."}}