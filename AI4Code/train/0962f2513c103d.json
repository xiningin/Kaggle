{"cell_type":{"4c672607":"code","e0ff6534":"code","7adcbe33":"code","bbf3b225":"code","33b3dba6":"code","3bd3fa89":"code","c1298442":"code","88886c59":"code","2bada803":"code","0a2ef70e":"code","ba4e0a56":"code","d9561e02":"code","2ce092a5":"code","e2ca1097":"code","ff4ad62d":"code","0845b327":"code","07077bec":"code","c5c1bb8a":"code","9c6cfe8c":"code","d3203a28":"code","bf440d16":"code","07348f1c":"code","bce2f6e4":"code","b5fb45d4":"code","32795d28":"code","b0802a87":"code","062f1f4b":"code","da8af1ee":"code","5fb093a9":"code","86aca6f1":"code","9fb93dc1":"code","b1f3bc05":"code","24a39eec":"code","ae1676aa":"code","ee202106":"code","40adc654":"code","39d78efd":"code","c1b72b11":"code","df33c1a6":"code","91e871db":"code","1516bc52":"code","e73d3dec":"code","5cc251db":"code","3391b445":"code","6b903d51":"code","f58c0ac3":"code","74af41d2":"markdown","db2190de":"markdown","56ab79d8":"markdown","8f49d0c3":"markdown","83ad5862":"markdown","a476e350":"markdown","12a3d9d0":"markdown","f5bf05ce":"markdown","75cd6e04":"markdown"},"source":{"4c672607":"\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n","e0ff6534":"df = pd.read_csv(\"..\/input\/heart-data\/heart.csv\")\n","7adcbe33":"df.head()","bbf3b225":"df[\"target\"].value_counts()","33b3dba6":"sns.countplot(df[\"target\"])\n;","3bd3fa89":"sns.distplot(df[\"age\"])\n;","c1298442":"df.groupby(\"target\")[\"age\"].mean()","88886c59":"fg = sns.FacetGrid(col = \"target\", data = df)\nfg.map(plt.hist, \"age\")","2bada803":"df.groupby(\"target\")[\"sex\"].value_counts()","0a2ef70e":"sns.countplot(df[\"target\"], hue= df[\"sex\"])","ba4e0a56":"plt.figure(figsize= (15,8))\nsns.heatmap(df.corr(),linewidths = 1)","d9561e02":"plt.figure(figsize= (15,8))\nsns.heatmap(df.corr(), annot= True, linewidths = 1)\n;","2ce092a5":"sns.kdeplot(df[\"thalach\"] , shade = True)","e2ca1097":"sns.stripplot( x = df[\"target\"], y=df[\"thalach\"])","ff4ad62d":"sns.boxplot(df[\"target\"], y = df[\"thalach\"])\n;","0845b327":"df.groupby(\"target\")[\"cp\"].value_counts()","07077bec":"sns.countplot(df[\"target\"], hue = df[\"cp\"])\n;","c5c1bb8a":"df.shape","9c6cfe8c":"df.nunique()","d3203a28":"cp_new = pd.get_dummies(df[\"cp\"], prefix = \"cp\")\nthal_new = pd.get_dummies(df[\"thal\"], prefix = \"thal\")\nslope_new = pd.get_dummies(df[\"slope\"], prefix = \"slope\")","bf440d16":"frame = [df,cp_new, thal_new, slope_new]\ndf = pd.concat(frame, axis = 1)\ndf.head()","07348f1c":"df = df.drop([\"cp\", \"thal\", \"slope\"], axis = 1)\ndf.head()","bce2f6e4":"df.columns","b5fb45d4":"x= df.drop([\"target\"], axis = 1)\ny = df[\"target\"]","32795d28":"# Normalize\n\nx= (x - np.min(x))\/(np.max(x) - np.min(x)).values","b0802a87":"from sklearn.model_selection import train_test_split\nx = df.drop([\"target\"], axis = 1)\ny = df[\"target\"]\nx_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.2)","062f1f4b":"from sklearn.linear_model import LogisticRegression\nlr = LogisticRegression()\nlr.fit(x_train, y_train)\ny_pred = lr.predict(x_test)","da8af1ee":"from sklearn.metrics import confusion_matrix\nprint(confusion_matrix(y_test, y_pred))","5fb093a9":"from sklearn.metrics import accuracy_score\nprint(accuracy_score(y_test,y_pred))","86aca6f1":"from sklearn.metrics import plot_roc_curve\nplot_roc_curve(lr, x_test, y_test)\n;","9fb93dc1":"from sklearn.neighbors import KNeighborsClassifier","b1f3bc05":"knn = KNeighborsClassifier()\nknn.fit(x_train, y_train)\ny_pred = knn.predict(x_test)","24a39eec":"print(confusion_matrix(y_test,y_pred))","ae1676aa":"print(accuracy_score(y_test,y_pred))","ee202106":"plot_roc_curve(knn, x_test, y_test)\n;","40adc654":"from sklearn.ensemble import RandomForestClassifier","39d78efd":"rf= RandomForestClassifier()","c1b72b11":"rf.fit(x_train, y_train)\ny_pred = rf.predict(x_test)","df33c1a6":"print(confusion_matrix(y_test, y_pred))","91e871db":"print(accuracy_score(y_test,y_pred))","1516bc52":"plot_roc_curve(rf, x_test, y_test)","e73d3dec":"from sklearn.naive_bayes import GaussianNB","5cc251db":"nb = GaussianNB()\nnb.fit(x_train, y_train)\ny_pred = nb.predict(x_test)","3391b445":"print(confusion_matrix(y_test, y_pred))","6b903d51":"print(accuracy_score(y_test, y_pred))","f58c0ac3":"plot_roc_curve(nb, x_test, y_test)","74af41d2":"**K Nearest Neighbor**","db2190de":"Since 'cp', 'thal' and 'slope' are categorical variables we'll turn them into dummy variables","56ab79d8":"**for reading everthing about confusion matrix :**\n*https:\/\/www.dataschool.io\/simple-guide-to-confusion-matrix-terminology\/#:~:text=A%20confusion%20matrix%20is%20a,the%20true%20values%20are%20known*.","8f49d0c3":"**Random Forest**","83ad5862":"**Creating Models**","a476e350":"# **FEATURE ENGINEERING**","12a3d9d0":"Logistic Regression Model has \n\nHighest Accuracy : 88% Highest\n\nAUC Score : 0.94 and \n\nLeast False Negative Rate\n\nTherefore we will use Logistic Regression Model while classifying","f5bf05ce":"**SUMMARY**","75cd6e04":"**ABOUT THE FEATURES** : \n\n**age**: The person's age in years\n\n**sex**: The person's sex (1 = male, 0 = female)\n\n**cp**: The chest pain experienced (Value 1: typical angina, Value 2: atypical angina, Value 3: non-anginal pain, Value 4: asymptomatic)\n\n**trestbps**: The person's resting blood pressure (mm Hg on admission to the hospital) chol: The person's cholesterol measurement in mg\/dl\n\n**fbs**: The person's fasting blood sugar (> 120 mg\/dl, 1 = true; 0 = false)\n\n**restecg**: Resting electrocardiographic measurement (0 = normal, 1 = having ST-T wave abnormality, 2 = showing probable or definite left ventricular hypertrophy by Estes' criteria)\n\n**thalach**: The person's maximum heart rate achieved\n\n**exang**: Exercise induced angina (1 = yes; 0 = no)\n\n**oldpeak**: ST depression induced by exercise relative to rest ('ST' relates to positions on the ECG plot. See more here)\n\n**slope**: the slope of the peak exercise ST segment (****Value 1: upsloping, Value 2: flat, Value 3: downsloping)\n\n**ca**: The number of major vessels (0-3)\n\n**thal**: A blood disorder called thalassemia (3 = normal; 6 = fixed defect; 7 = reversable defect) \n\n**target**: Heart disease (0 = no, 1 = yes)"}}