{"cell_type":{"364665f4":"code","fd468df3":"code","4418a96c":"code","d2b1e16b":"code","44dc5fb8":"code","a4b6f04d":"code","09012256":"code","c8458705":"code","6760675f":"code","adfa2886":"code","3bffbab2":"code","f3d2d2c0":"code","7e0b53f0":"code","72ad3421":"code","ed9774f8":"code","53fe60ef":"code","1c86b278":"code","c4dd1741":"code","6abf959a":"code","38fb4b9a":"code","c972dca3":"code","be808eea":"code","2268f155":"code","c3e73e2a":"code","968698a7":"code","43b979a3":"code","998cc9c0":"code","cba55527":"code","34a1016f":"code","0b546359":"code","b5b051eb":"code","952129f1":"code","8f2ceb1a":"code","8880d0f8":"code","d2d832f3":"code","fcc5a1a3":"code","e93a312d":"code","2734b02c":"code","f76232fe":"code","499a98d4":"code","3d4b7774":"code","9cbc4b48":"code","bc1bff67":"code","d56921d9":"code","69cc10d8":"code","a36e68cc":"code","e67e5263":"code","b5a30b01":"code","18d6d056":"code","cbcea4f2":"code","ef677202":"code","a942594d":"code","a5c2f5ba":"code","016f9a9f":"code","c9083ece":"code","ff93e0ae":"code","9d47cdb4":"code","73ad7df3":"code","3f09ae22":"code","7e17e47f":"code","4bfa6648":"code","e1737980":"code","62646b96":"code","8d4bcb4f":"code","08c5ad01":"code","c78c02df":"code","1f266ab8":"markdown","43f7c728":"markdown","180a1bc1":"markdown","56439bb4":"markdown","3bba3239":"markdown","828f1012":"markdown","21b68c49":"markdown","2ddbce7a":"markdown","2a6650b9":"markdown","dacdd531":"markdown","9830dbdb":"markdown","22382558":"markdown","0d2f82a2":"markdown","9fa9e082":"markdown","406dcdb9":"markdown","f375950e":"markdown","3d3cdd0a":"markdown","822adc55":"markdown","a8820fce":"markdown"},"source":{"364665f4":"import numpy as np \nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline\nimport warnings\nwarnings.filterwarnings('ignore')\nfrom sklearn.ensemble import (RandomForestClassifier, AdaBoostClassifier, \n                              GradientBoostingClassifier)\nfrom sklearn.svm import SVC\n\nimport os\nprint(os.listdir(\"..\/input\"))","fd468df3":"train = pd.read_csv('..\/input\/train.csv')\ntest = pd.read_csv('..\/input\/test.csv')\n","4418a96c":"sub = pd.read_csv('..\/input\/gender_submission.csv')","d2b1e16b":"train.isnull().sum()","44dc5fb8":"train['Survived'].value_counts().plot.pie(explode=[0,0.1],autopct='%1.1f%%',shadow=True)\nplt.title('Survived')\nplt.ylabel('')","a4b6f04d":"train.head()","09012256":"train.columns\n","c8458705":"train.groupby(['Sex','Survived'])['Survived'].count()","6760675f":"sns.countplot('Sex',hue='Survived',data=train)\nplt.title('Sex:Survived vs Dead')\nplt.show()","adfa2886":"train.groupby(['Pclass','Survived'])['Survived'].count()","3bffbab2":"sns.countplot('Pclass',hue='Survived',data=train)\nplt.title('Sex:Survived vs Dead')\nplt.show()","f3d2d2c0":"sns.catplot(x=\"Sex\", y=\"Survived\", col=\"Pclass\",data=train, saturation=.5,\n            kind=\"bar\", ci=None, aspect=.6)","7e0b53f0":"pd.crosstab([train.Sex,train.Survived],train.Pclass,margins=True).style.background_gradient(cmap='summer_r')","72ad3421":"train['Age'].max(),train['Age'].min(),train['Age'].mean()","ed9774f8":"f,ax=plt.subplots(1,2,figsize=(18,8))\nsns.violinplot(\"Pclass\",\"Age\", hue=\"Survived\", data=train,split=True,ax=ax[0])\nax[0].set_title('Pclass and Age vs Survived')\nax[0].set_yticks(range(0,110,10))\nsns.violinplot(\"Sex\",\"Age\", hue=\"Survived\", data=train,split=True,ax=ax[1])\nax[1].set_title('Sex and Age vs Survived')\nax[1].set_yticks(range(0,110,10))\nplt.show()","53fe60ef":"fig = sns.FacetGrid(train, row='Embarked', size=2.2, aspect=1.6)\nfig.map(sns.pointplot, 'Pclass', 'Survived', 'Sex', palette='deep')\nfig.add_legend()","1c86b278":"sns.factorplot('Embarked','Survived',data=train)\nplt.show()","c4dd1741":"train[[\"SibSp\", \"Survived\"]].groupby(['SibSp'],\n        as_index=False).mean().sort_values(by='Survived', ascending=False)","6abf959a":"train[[\"Parch\", \"Survived\"]].groupby(['Parch'], \n            as_index=False).mean().sort_values(by='Survived', ascending=False)","38fb4b9a":"pd.crosstab(train.SibSp,train.Pclass).style.background_gradient(cmap='summer_r')","c972dca3":"pd.crosstab(train.Parch,train.Pclass).style.background_gradient(cmap='summer_r')","be808eea":"train.isnull().sum()","2268f155":"sns.countplot('Embarked',data=train)\nplt.title('Passengers embarked at each station')\nplt.show()","c3e73e2a":"train['Embarked'].fillna('S',inplace=True)","968698a7":"train['Embarked'].isnull().any()","43b979a3":"train.head(5)","998cc9c0":"train['Salutation']=0\nfor i in train:\n    train['Salutation']=train['Name'].str.split(\", \", expand=True)[1].str.split(\".\", expand=True)[0]","cba55527":"train","34a1016f":"train['Salutation'].unique()","0b546359":"pd.crosstab(train.Sex,train.Salutation)","b5b051eb":"train['Salutation'].replace(['Mlle','Mme','Ms','Dr','Major','Lady','the Countess','Jonkheer','Col','Rev','Capt','Sir','Don'],\n                        ['Miss','Miss','Miss','Mr','Mr','Mrs','Mrs','Other','Other','Other','Mr','Mr','Mr'],inplace=True)","952129f1":"train.groupby('Salutation')['Age'].mean()","8f2ceb1a":"train.loc[(train.Age.isnull())&(train.Salutation=='Mr'),'Age']=33\ntrain.loc[(train.Age.isnull())&(train.Salutation=='Mrs'),'Age']=36\ntrain.loc[(train.Age.isnull())&(train.Salutation=='Master'),'Age']=5\ntrain.loc[(train.Age.isnull())&(train.Salutation=='Miss'),'Age']=22\ntrain.loc[(train.Age.isnull())&(train.Salutation=='Other'),'Age']=46","8880d0f8":"train['Age'].isnull().sum()","d2d832f3":"sns.factorplot('Pclass','Survived',col='Salutation',data=train)\nplt.show()","fcc5a1a3":"plt.hist(x = [train[train['Survived']==1]['Age'], train[train['Survived']==0]['Age']], \n         stacked=True, color = ['g','r'],label = ['Survived','Dead'])\nplt.title('Fare Histogram by Survival')\nplt.xlabel('Fare ($)')\nplt.ylabel('# of Passengers')\nplt.legend()","e93a312d":"train['Age_Range']=0\ntrain.loc[train['Age']<=10,'Age_Range']=0\ntrain.loc[(train['Age']>10)&(train['Age']<=20),'Age_Range']=1\ntrain.loc[(train['Age']>20)&(train['Age']<=40),'Age_Range']=2\ntrain.loc[(train['Age']>40)&(train['Age']<=50),'Age_Range']=3\ntrain.loc[(train['Age']>50)&(train['Age']<=65),'Age_Range']=4\ntrain.loc[train['Age']>65,'Age_Range']=5","2734b02c":"sns.factorplot('Age_Range','Survived',data=train,col='Pclass')\nplt.show()","f76232fe":"train.drop(['PassengerId','Ticket','Cabin'],axis=1,inplace=True)","499a98d4":"train['Fare'].nunique()","3d4b7774":"f,ax=plt.subplots(1,3,figsize=(20,8))\nsns.distplot(train[train['Pclass']==1].Fare,ax=ax[0])\nax[0].set_title('Fares in Pclass 1')\nsns.distplot(train[train['Pclass']==2].Fare,ax=ax[1])\nax[1].set_title('Fares in Pclass 2')\nsns.distplot(train[train['Pclass']==3].Fare,ax=ax[2])\nax[2].set_title('Fares in Pclass 3')\nplt.show()\n","9cbc4b48":"plt.hist(x = [train[train['Survived']==1]['Fare'], train[train['Survived']==0]['Fare']], \n         stacked=True, color = ['g','r'],label = ['Survived','Dead'])\nplt.title('Fare Histogram by Survival')\nplt.xlabel('Fare ($)')\nplt.ylabel('# of Passengers')\nplt.legend()","bc1bff67":"train['Fare_Range']=0\ntrain.loc[train['Fare']<=7.91,'Fare_Range']=0\ntrain.loc[(train['Fare']>7.91)&(train['Fare']<=14.454),'Fare_Range']=1\ntrain.loc[(train['Fare']>14.454)&(train['Fare']<=31),'Fare_Range']=2\ntrain.loc[(train['Fare']>31)&(train['Fare']<=513),'Fare_Range']=3","d56921d9":"sns.heatmap(train.corr(),annot=True,cmap='summer_r',linewidths=0.2) \nplt.show()","69cc10d8":"train['FamilySize']=train['SibSp']+train['Parch']+1\ntrain['IsAlone'] = 1 \ntrain['IsAlone'].loc[train['FamilySize'] > 1] = 0","a36e68cc":"train.columns","e67e5263":"train.drop(['Name','Age','Fare'],axis=1,inplace=True)","b5a30b01":"train.columns","18d6d056":"train.head()","cbcea4f2":"train['Sex'].replace(['male','female'],[0,1],inplace=True)\ntrain['Embarked'].replace(['S','C','Q'],[0,1,2],inplace=True)\ntrain['Salutation'].replace(['Mr','Mrs','Miss','Master','Other'],[0,1,2,3,4],inplace=True)","ef677202":"type(train)","a942594d":"train.head()","a5c2f5ba":"sns.heatmap(train.corr(),annot=True,cmap='RdYlGn',linewidths=0.2,annot_kws={'size':20})\nfig=plt.gcf()\nfig.set_size_inches(15,15)\nplt.xticks(fontsize=14)\nplt.yticks(fontsize=14)\nplt.show()","016f9a9f":"from sklearn.linear_model import LogisticRegression \nfrom sklearn import svm \nfrom sklearn.ensemble import RandomForestClassifier \nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.tree import DecisionTreeClassifier \nfrom sklearn.ensemble import AdaBoostClassifier\nfrom sklearn.ensemble import GradientBoostingClassifier\nimport xgboost as xg\n\nfrom sklearn.model_selection import train_test_split \nfrom sklearn import metrics\nfrom sklearn.metrics import confusion_matrix\nfrom sklearn.model_selection import cross_val_score","c9083ece":"train_f,test_f=train_test_split(train,test_size=0.3,random_state=0,stratify=train['Survived'])\ntrain_X=train_f.drop(['Survived'],axis=1)\ntrain_Y=train_f['Survived']\ntest_X=test_f.drop(['Survived'],axis=1)\ntest_Y=test_f['Survived']\nX=train.drop(['Survived'],axis=1)\nY=train['Survived']","ff93e0ae":"lrc = LogisticRegression()\nlrc.fit(train_X,train_Y)\nprediction_lrc=lrc.predict(test_X)\nprint('The accuracy of the Logistic Regression is',metrics.accuracy_score(prediction_lrc,test_Y))","9d47cdb4":"svc=svm.SVC(kernel='rbf',C=1,gamma=0.1)\nsvc.fit(train_X,train_Y)\nprediction_svc=svc.predict(test_X)\nprint('Accuracy for rbf SVM is ',metrics.accuracy_score(prediction_svc,test_Y))","73ad7df3":"dtc=DecisionTreeClassifier()\ndtc.fit(train_X,train_Y)\nprediction_dtc=dtc.predict(test_X)\nprint('The accuracy of the Decision Tree is',metrics.accuracy_score(prediction_dtc,test_Y))","3f09ae22":"knn=KNeighborsClassifier() \nknn.fit(train_X,train_Y)\nprediction_knn=knn.predict(test_X)\nprint('The accuracy of the KNN is',metrics.accuracy_score(prediction_knn,test_Y))","7e17e47f":"rfc=RandomForestClassifier(n_estimators=80)\nrfc.fit(train_X,train_Y)\nprediction_rfc=model.predict(test_X)\nprint('The accuracy of the Random Forests is',metrics.accuracy_score(prediction_rfc,test_Y))","4bfa6648":"ada=AdaBoostClassifier(n_estimators=200,random_state=0,learning_rate=0.1)\nresult=cross_val_score(ada,X,Y,cv=10,scoring='accuracy')\nprint('The cross validated score for AdaBoost is:',result.mean())","e1737980":"ada.fit(train_X,train_Y)","62646b96":"sub = pd.DataFrame()\nsub['PassengerId'] = test['PassengerId']\nsub['Survived'] = ada.predict_proba(test)\nsub.to_csv(\"sub.csv\",index=False)","8d4bcb4f":"grad=GradientBoostingClassifier(n_estimators=500,random_state=0,learning_rate=0.1)\nresult=cross_val_score(grad,X,Y,cv=10,scoring='accuracy')\nprint('The cross validated score for Gradient Boosting is:',result.mean())","08c5ad01":"xgboost=xg.XGBClassifier(n_estimators=900,learning_rate=0.1)\nresult=cross_val_score(xgboost,X,Y,cv=10,scoring='accuracy')\nprint('The cross validated score for XGBoost is:',result.mean())","c78c02df":"f,ax=plt.subplots(2,2,figsize=(15,12))\nmodel=RandomForestClassifier(n_estimators=500,random_state=0)\nmodel.fit(X,Y)\npd.Series(model.feature_importances_,X.columns).sort_values(ascending=True).plot.barh(width=0.8,ax=ax[0,0])\nax[0,0].set_title('Feature Importance in Random Forests')\nmodel=AdaBoostClassifier(n_estimators=200,learning_rate=0.05,random_state=0)\nmodel.fit(X,Y)\npd.Series(model.feature_importances_,X.columns).sort_values(ascending=True).plot.barh(width=0.8,ax=ax[0,1])\nax[0,1].set_title('Feature Importance in AdaBoost')\nmodel=GradientBoostingClassifier(n_estimators=500,learning_rate=0.1,random_state=0)\nmodel.fit(X,Y)\npd.Series(model.feature_importances_,X.columns).sort_values(ascending=True).plot.barh(width=0.8,ax=ax[1,0])\nax[1,0].set_title('Feature Importance in Gradient Boosting')\nmodel=xg.XGBClassifier(n_estimators=900,learning_rate=0.1)\nmodel.fit(X,Y)\npd.Series(model.feature_importances_,X.columns).sort_values(ascending=True).plot.barh(width=0.8,ax=ax[1,1])\nax[1,1].set_title('Feature Importance in XgBoost')\nplt.show()","1f266ab8":"Mis spelled salutations such as mlle can be replaced by miss and mme can be replaced by mrs and the other ones accordingly and this will make it easy to categorize","43f7c728":"Only 38.4% people survived.Now let us se how each feature given in the dataset such as age,class,gender and such affect the survival rate","180a1bc1":"Positive Correlation means two features are directly affected and in Negative Correlation,Two features move in opposite ways.If two features are positively correlated,it means that they affect the target value in the same way .So keeping only one feature can also work and we can safely remove the other feature to reduce training time.","56439bb4":"As  age  is an important feature ,we need to fill those null values.We need to replace those values with some value.But we cannot fill it with any random number as the age spread is more.so let us see family names and the number of siblings,parents abroad, we will try to fill those values.Let us first fill other missing values","3bba3239":"Like we can fill missing values based on corresponding group avrage ages","828f1012":"From the above plots,It is evident that as age increases,survival rate decreases irrespective of the Pclass","21b68c49":"Observations from the above plots:\n\nFemale from class 1,2,3  who began their journey at Station C had less survival rate and male had very high survival rates.Whereas the trend is opposite when they embarked from stations Q and S.\n\nThe survival chances are almost 1 for women for Pclass1 and Pclass2 irrespective of the Pclass.\nFemale  survival rate irrespective of station decreases when class increases\n\nStation S looks to be very unlucky for Pclass3 Passenegers as the survival rate for both men and women is very low.\n\nStation Q looks looks to be unlukiest for Men, and almost all were from Pclass 3.\n\nOverall survival rate for Station C is highest around 0.55\n\n\n","2ddbce7a":"Even though male count wa shigh,Survival count of women s twice to that of survival count of men.So ,we can tell that gender plays some role in survival detection","2a6650b9":"From the above cross tab,we can see that the survival rate of women in 3rd class is very high that out of 94 only 3 women could not survive and even the survival rate of women compared to men in 2 nd and 3rd classes is also high.Let me now work with age","dacdd531":"From the above correlation map we can see that there is high correlation between family size,sibsp,parch and isalone.Its because those features are derived from one another","9830dbdb":"People in same class also paid different fare,It might be because of preferred cabin and there is no sufficient cabin data,let us keep fare as it is and without any modifications.Distribution of fare  in class1 is large and goes on decreasing as the class increases.This continuous distribution can be converted in ranges and then they can be used as discrete values so that any algorithm can classify them easily","22382558":"Let me first try to fix the null values.Age,Cabin and Embarked have null values ","0d2f82a2":"From the above plots it is evident that  children had highest survival rate and then female and then male.So a feature based on age groups can be developed","9fa9e082":"From the above plot,we can tell that people of certain class had more survival rate and it can also be seen that people of higher class had more survival chances than that of lower class.It might be that passengers of higher class were given higher priority while rescue.\nLet us now check the survival rate of sex and Pclass together","406dcdb9":"Passenger class is given,and that makes cabin not a useful feature.So we can safely eliminate this feature.PasengerId,Ticket number can also be eliminated as they are present to represent the uniqueness of an individual and we are targetting to ","f375950e":"From the above plots ,we can tell that  the survival rate of children (below age 10 ) is high irrespective of the class.\nSurvival rate of people aged 20-50 is high in pclass1 and that female sex aged 20-50 have high survival rate compared to men.Let me now explore remaining features.\n","3d3cdd0a":"\nAs maximum people embarked at station S,Let us fill the missing Embarked values with S","822adc55":"The above tables shows that if a passenger is alone onboard with no siblings, he have 34.5% survival rate. \nAs number of siblings,spouse ,parents and children  abroad is high,the survival rate decreases.This makes sense. That is, if I have a family on board, I will try to save them instead of saving myself first. Surprisingly the survival for families with 5-8 members is 0%.Let us analyse the reason for it.\nThe reason is Pclass.As people with sibsp,parch greater than 3 are in class 3","a8820fce":"In our training dataset we have survived as the target class and various types of features.Let me explore them first.\n\nCategorical Features:Sex,Embarked,Pclass(Can be grouped)\n\nCategorical features also contain subset features called ordinal features where there can be hierarchial\/relative ordering between group\n\nContinuos Features:Age(Can vary between any two numbers and cannot be categorised)"}}