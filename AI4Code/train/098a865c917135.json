{"cell_type":{"4e64822c":"code","2a3fa94e":"code","f3c40004":"code","ba2e3ebd":"code","d20f5006":"code","349f0d72":"code","c84819c6":"code","e09ebdd6":"code","bbaaa5a6":"code","a84a5aec":"code","0eabdba2":"code","1ae7cf82":"code","9456204e":"code","ae41ac8f":"code","6b1bf4d5":"code","e60908eb":"markdown","0df130c8":"markdown","a87a3080":"markdown","e2091fe1":"markdown","1c02e970":"markdown","28f920c0":"markdown","e3de17e6":"markdown","60bea402":"markdown","6f0958a8":"markdown","17e4989c":"markdown","ee91e975":"markdown","1fc1332d":"markdown","dba6df89":"markdown","ec28a818":"markdown","2a6c245f":"markdown"},"source":{"4e64822c":"# Importing:\nfrom fastai.text.all import *\nimport os\nimport shutil","2a3fa94e":"os.makedirs(\".\/new\", mode = 0o777, exist_ok = False)","f3c40004":"# Defining the list of files:\nlist  = os.listdir(\"..\/input\/2020-republican-convention-speeches\")\n\n# Copying:\nfor file in list:\n    original = r'..\/input\/2020-republican-convention-speeches\/' + file \n    target = r'.\/new\/' + file\n    shutil.copyfile(original, target)\n","ba2e3ebd":"# The path where our files are now stored:\npath = \".\/new\/\"","d20f5006":"# Getting those files:\nfiles = get_text_files(path)","349f0d72":"# Taking a look at those files:\ntext = files[7].open().read(); text[:212]","c84819c6":"get_elections = partial(get_files)","e09ebdd6":"# Defining the DataLoader finally:\nrepublicans_loader = DataBlock(\n    blocks = TextBlock.from_folder(path, is_lm = True),\nget_items  = get_elections, splitter = RandomSplitter(0.1)\n).dataloaders(path, path=path, bs = 64, seq_len = 70)","bbaaa5a6":"# Taking a look at the batches:\nrepublicans_loader.show_batch(max_n = 2)","a84a5aec":"# Defining the model:\nlearn = language_model_learner(republicans_loader, AWD_LSTM,\n                              drop_mult = 0.3,\n                              metrics  = [accuracy, Perplexity()]).to_fp16()","0eabdba2":"# Training the model for 5 Epochs with the learning rate of 0.001\nlearn.fine_tune(5, 1e-4)","1ae7cf82":"# Training the model for another 5 Epochs:\nlearn.fine_tune(5, 1e-2)","9456204e":"learn.predict('I feel that we will win this election',\n              50, temperature = 0.75)","ae41ac8f":"# Trying again:\nlearn.predict('Make america great again',\n              60, temperature = 0.8)","6b1bf4d5":"# Again:\nlearn.predict('I love china',\n              12, temperature = 0.5)","e60908eb":"The <font color = 'green'>Recurrent Neural Network architecture<\/font> that we are using here is <font color = 'green'>AWD LSTM<\/font>. \nThe data was trained for about 10 epochs and it reached an accuracy of about 32% which means that the models are right at predicting what the republican speaker will say next almost 1\/3rd of the time. This is decent enough as per today's standards and given such small amount of data.","0df130c8":"# <font color = 'grey'>Table of Content<\/font>\n\n## 1. Introduction  \n## 2. DataLoader\n## 3. Training\n## 4. Predicting","a87a3080":"![The Opener for the Convention](https:\/\/specials-images.forbesimg.com\/imageserve\/5f4539a25836da0a0da11c25\/960x0.jpg?fit=scale)","e2091fe1":"# Introduction\nImporting the library and checking out the data.","1c02e970":"Copying files to the new folder:","28f920c0":"In this notebook, we will be using the speeches that were delivered during the <font color = 'red'>Republican Convention<\/font> <font color = 'blue'>2020<\/font>. I will assume that you are slightly familiar or a practitioner of Natural Language Processing.","e3de17e6":"Phew.","60bea402":"# DataLoader\nDefining the DataLoader and looking at the preprocessed data here:","6f0958a8":"There are grammatical errors but still its crazy when thought about the idea of a deep learning model producing something that sounds like Mitch Mcconnell","17e4989c":"I was a bit perplexed on what does this partial thing above do? So searched and found this on FastAI's forums:\n\n![](https:\/\/raw.githubusercontent.com\/vyommartin\/Images-I-need-Links-To\/master\/2020-09-30-101647_1366x768_scrot.png)","ee91e975":"Well, this is the end of this notebook. If you liked it, an upvote would be really appreciated as it would help me progress in my dream of becoming a data scientist! :)","1fc1332d":"# Predicting\nThis my favourite part where we try to sound like a republican senator:","dba6df89":" We will be using the <font color = 'green'>FastAI Library<\/font> for today. The speeches are in text files that I had to copy from the main input memory of the Kaggle Kernel to the output. This is because the folders in Input directory do not allow you to write the files. Thus, I copied and move them elsewhere in the Output to be able to use them in a DataLoader.\n","ec28a818":"# Training\nYep, defining the model and training it.","2a6c245f":"Making a new folder in the writable output directory:"}}