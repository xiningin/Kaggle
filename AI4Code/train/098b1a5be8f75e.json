{"cell_type":{"489ff9f1":"code","e7e748b4":"code","ee1eeeb3":"code","7a9d1be1":"code","e6fe210f":"code","86b70756":"code","a8e563d8":"code","cc2733a5":"code","6a333ecf":"code","2168f342":"code","f2364545":"code","173e6cd9":"code","77accf48":"code","1838bd5a":"code","5b636c23":"code","96a63f9c":"code","7096dd54":"code","f846a371":"code","dcb069da":"code","6dc87c89":"code","9d7f1c9d":"code","95d5f5e2":"code","0636cd5f":"code","9dd1a9ab":"code","80e98fd1":"code","6ed2ca0f":"code","386da57d":"code","54f5d416":"code","797d2d69":"code","a24ee64c":"code","016c83d4":"code","d1fcba5e":"code","639b16f0":"code","87605a4f":"code","9df0c2c5":"code","951874c6":"markdown","3ba8b439":"markdown","e33f287f":"markdown","1ddb4f2d":"markdown","fde9191c":"markdown","aca1faa4":"markdown","9f0d0e99":"markdown","8d820dfc":"markdown","2e61b545":"markdown","4c442742":"markdown","ce2f39c7":"markdown","ff76ee34":"markdown","df7bfb7f":"markdown","a9436e96":"markdown","2a02676b":"markdown"},"source":{"489ff9f1":"#import some necessary librairies\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n%matplotlib inline\nimport matplotlib.pyplot as plt \nimport seaborn as sns\ncolor = sns.color_palette()\nsns.set_style('darkgrid')\nimport warnings\ndef ignore_warn(*args, **kwargs):\n    pass\nwarnings.warn = ignore_warn #ignore annoying warning (from sklearn and seaborn)\n\nimport plotly.express as px\nfrom scipy import stats\nfrom scipy.stats import norm, skew #for some statistics\n\n\npd.set_option('display.float_format', lambda x: '{:.3f}'.format(x)) #Limiting floats output to 3 decimal points\n\n\nfrom subprocess import check_output\n","e7e748b4":"#Dataset: https:\/\/www.kaggle.com\/muhammetvarl\/laptop-price\ndf = pd.read_csv('..\/input\/laptop-price\/laptop_price.csv',encoding='latin-1')\ndf.head()","ee1eeeb3":"df.info()","7a9d1be1":"df['Inches'] = df['Inches'].apply(str)\ndf['Weight'] = df['Weight'].apply(lambda x: str(x).split('k')[0])","e6fe210f":"df['Weight'] = df['Weight'].apply(float)","86b70756":"temp = df.groupby(['Company']).mean().reset_index().sort_values(by='Price_euros',ascending=False)\nplt.figure(figsize = (20,20))\nsplot = sns.barplot(data = temp,x = 'Company', y = 'Price_euros',palette = 'RdBu')\nfor p in splot.patches:\n    splot.annotate(format(p.get_height(), '.1f'), \n                   (p.get_x() + p.get_width() \/ 2., p.get_height()), \n                   ha = 'center', va = 'center', \n                   xytext = (0, 9), \n                   textcoords = 'offset points')\nplt.xlabel(\"Company\", size=14)\nplt.ylabel(\"Price\", size=14)\nplt.title('Average Laptop Price Per Company')","a8e563d8":"temp = df.groupby(['Company','Ram']).mean().reset_index().sort_values(by='Price_euros',ascending=False)\npx.scatter(data_frame = temp, x = 'Company', y = 'Price_euros',color = 'Ram',title = 'Average Laptop Price for Each Company\/RAM amount')","cc2733a5":"px.scatter(data_frame = df,x = 'Inches',y = 'Price_euros')","6a333ecf":"px.scatter(data_frame = df,x = 'Ram',y = 'Price_euros')","2168f342":"#Removing Outliers after checking them using scatter plot\ndf = df[~((df['Price_euros'] > 3500) &(df['Ram']== '8GB'))]\ndf = df[~((df['Price_euros'] > 3500) &(df['Ram']== '16GB'))]","f2364545":"df = df[~((df['Price_euros'] == 4899) &(df['Inches']== 15.6))]\ndf = df[~((df['Price_euros'] >= 5000) &(df['Inches']== 17.3))]","173e6cd9":"temp = df.groupby(['Company','Memory']).mean().reset_index().sort_values(by='Price_euros',ascending=False)\npx.scatter(data_frame = temp, x = 'Memory', y = 'Price_euros',color = 'Company',title = 'Average Laptop Price for Each Company\/Memory')","77accf48":"temp = df.groupby(['Company','Inches']).mean().reset_index().sort_values(by='Price_euros',ascending=False)\npx.scatter(data_frame = temp, x = 'Inches', y = 'Price_euros',color = 'Company', title = 'Average Laptop Price for Each Company\/Size in Inches')","1838bd5a":"sns.distplot(df['Price_euros'] , fit=norm)\n# Get the fitted parameters used by the function\n(mu, sigma) = norm.fit(df['Price_euros'])\nprint( '\\n mu = {:.2f} and sigma = {:.2f}\\n'.format(mu, sigma))\n\n#Now plot the distribution\nplt.legend(['Normal dist. ($\\mu=$ {:.2f} and $\\sigma=$ {:.2f} )'.format(mu, sigma)],\n            loc='best')\nplt.ylabel('Frequency')\nplt.title('Price_euros distribution')\n\n#Get also the QQ-plot\nfig = plt.figure()\nres = stats.probplot(df['Price_euros'], plot=plt)\nplt.show()","5b636c23":"#We use the numpy fuction log1p which  applies log(1+x) to all elements of the column\ndf[\"Price_euros\"] = np.log1p(df[\"Price_euros\"])\n\n#Check the new distribution \nsns.distplot(df['Price_euros'] , fit=norm);\n\n# Get the fitted parameters used by the function\n(mu, sigma) = norm.fit(df['Price_euros'])\nprint( '\\n mu = {:.2f} and sigma = {:.2f}\\n'.format(mu, sigma))\n\n#Now plot the distribution\nplt.legend(['Normal dist. ($\\mu=$ {:.2f} and $\\sigma=$ {:.2f} )'.format(mu, sigma)],\n            loc='best')\nplt.ylabel('Frequency')\nplt.title('Price_euros distribution')\n\n#Get also the QQ-plot\nfig = plt.figure()\nres = stats.probplot(df['Price_euros'], plot=plt)\nplt.show()","96a63f9c":"#Correlation map to see how features are correlated with Price_euros\ncorrmat = df.corr()\nplt.subplots(figsize=(12,9))\nsns.heatmap(corrmat, vmax=0.9, square=True,cmap = 'RdBu',annot = True)","7096dd54":"#Dont need ID column for the model\ndf.drop(columns = 'laptop_ID',inplace = True)","f846a371":"df.columns","dcb069da":"from sklearn.preprocessing import LabelEncoder\ncols = ['Company', 'Product', 'TypeName', 'Inches', 'ScreenResolution', 'Cpu',\n       'Ram', 'Memory', 'Gpu', 'OpSys']\nfor c in cols:\n    lbl = LabelEncoder() \n    lbl.fit(list(df[c].values)) \n    df[c] = lbl.transform(list(df[c].values))\n","6dc87c89":"df.head()","9d7f1c9d":"from sklearn.linear_model import ElasticNet, Lasso,  BayesianRidge, LassoLarsIC\nfrom sklearn.ensemble import RandomForestRegressor,  GradientBoostingRegressor\nfrom sklearn.kernel_ridge import KernelRidge\nfrom sklearn.pipeline import make_pipeline\nfrom sklearn.preprocessing import RobustScaler\nfrom sklearn.base import BaseEstimator, TransformerMixin, RegressorMixin, clone\nfrom sklearn.model_selection import KFold, cross_val_score, train_test_split\nfrom sklearn.metrics import mean_squared_error\nimport xgboost as xgb\nimport lightgbm as lgb","95d5f5e2":"X = df.iloc[:,:-1]\ny = df['Price_euros']","0636cd5f":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.15, random_state=42)","9dd1a9ab":"#Validation function\nn_folds = 5\n\ndef rmsle_cv(model):\n    kf = KFold(n_folds, shuffle=True, random_state=42).get_n_splits(X_train.values)\n    rmse= np.sqrt(-cross_val_score(model, X_train.values, y_train, scoring=\"neg_mean_squared_error\", cv = kf))\n    return(rmse)","80e98fd1":"lasso = make_pipeline(RobustScaler(), Lasso(alpha =0.0005, random_state=1))\nscore = rmsle_cv(lasso)\nprint(\"\\nLasso score: {:.4f} ({:.4f})\\n\".format(score.mean(), score.std()))","6ed2ca0f":"ENet = make_pipeline(RobustScaler(), ElasticNet(alpha=0.0005, l1_ratio=.9, random_state=3))\nscore = rmsle_cv(ENet)\nprint(\"ElasticNet score: {:.4f} ({:.4f})\\n\".format(score.mean(), score.std()))","386da57d":"KRR = KernelRidge(alpha=0.6, kernel='polynomial', degree=2, coef0=2.5)\nscore = rmsle_cv(KRR)\nprint(\"Kernel Ridge score: {:.4f} ({:.4f})\\n\".format(score.mean(), score.std()))","54f5d416":"GBoost = GradientBoostingRegressor(n_estimators=3000, learning_rate=0.05,\n                                   max_depth=4, max_features='sqrt',\n                                   min_samples_leaf=15, min_samples_split=10, \n                                   loss='huber', random_state =5)\nscore = rmsle_cv(GBoost)\nprint(\"Gradient Boosting score: {:.4f} ({:.4f})\\n\".format(score.mean(), score.std()))","797d2d69":"model_xgb = xgb.XGBRegressor(colsample_bytree=0.4603, gamma=0.0468, \n                             learning_rate=0.05, max_depth=3, \n                             min_child_weight=1.7817, n_estimators=2200,\n                             reg_alpha=0.4640, reg_lambda=0.8571,\n                             subsample=0.5213, silent=1,\n                             random_state =7, nthread = -1)\nscore = rmsle_cv(model_xgb)\nprint(\"Xgboost score: {:.4f} ({:.4f})\\n\".format(score.mean(), score.std()))","a24ee64c":"model_lgb = lgb.LGBMRegressor(objective='regression',num_leaves=5,\n                              learning_rate=0.05, n_estimators=720,\n                              max_bin = 55, bagging_fraction = 0.8,\n                              bagging_freq = 5, feature_fraction = 0.2319,\n                              feature_fraction_seed=9, bagging_seed=9,\n                              min_data_in_leaf =6, min_sum_hessian_in_leaf = 11)\nscore = rmsle_cv(model_lgb)\nprint(\"LGBM score: {:.4f} ({:.4f})\\n\" .format(score.mean(), score.std()))","016c83d4":"score = rmsle_cv(ENet)\nprint(\"ElasticNet score: {:.4f} ({:.4f})\\n\".format(score.mean(), score.std()))","d1fcba5e":"score = rmsle_cv(KRR)\nprint(\"Kernel Ridge score: {:.4f} ({:.4f})\\n\".format(score.mean(), score.std()))","639b16f0":"GBoost.fit(X_train,y_train)\ngboost_pred = GBoost.predict(X_test)\n","87605a4f":"result = pd.DataFrame({'Y_TEST':y_test.values,'Y_PRED' : pd.Series(gboost_pred).values})","9df0c2c5":"px.line(data_frame = result)","951874c6":"**Gradient Boosting Regression**","3ba8b439":"**There is no Correlation between the price and other variables and there is no intercorrelation**","e33f287f":"# Almost perfect fit on the test data!","1ddb4f2d":"# Data Visualization and Feature Engineering","fde9191c":"# Fitting the best model and getting the predictions array","aca1faa4":"**XGBoost Regression**","9f0d0e99":"**LGBM**","8d820dfc":"**Lasso Regression**","2e61b545":"**Kernel Ridge Regression**","4c442742":"**Elastic Net Regression**","ce2f39c7":"# Model Building","ff76ee34":"> We can easily compare laptops prices with respect to ram with this amazing graph above","df7bfb7f":"**Checking some outliers**","a9436e96":"# Checking skweness and transforming the target column","2a02676b":"**Log Transformation**"}}