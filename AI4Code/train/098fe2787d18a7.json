{"cell_type":{"cd2c7b82":"code","f22d5fd6":"code","9c5cd8a3":"code","536fa4a6":"code","b634c072":"code","bdfe2dab":"code","019ce1ba":"code","f81979e0":"code","a2cdebcf":"code","5ec1a746":"code","34965c32":"code","8621f2b0":"code","16896fe9":"code","109e02f6":"code","9277408f":"code","4beaa135":"code","97a92c17":"code","e7786414":"code","dbcf04ce":"code","f16772e6":"code","0361f1a4":"code","62af22b3":"code","0aa6fbbb":"code","74ed7eca":"code","0ad8448e":"code","7ebb3dfd":"code","e246684c":"code","1f5afdc6":"code","b7db2f98":"code","04613a81":"code","a424c6d4":"code","ab0228cd":"code","571e6a8b":"code","8af1632b":"code","e7031843":"code","58991124":"code","e0138063":"code","23a5b762":"code","8550f031":"markdown","985aa3c5":"markdown","80a9a5c6":"markdown","be553ea0":"markdown","9b3fcdb1":"markdown","99a9e08d":"markdown","4b697ba9":"markdown","8e188711":"markdown","d15e7579":"markdown","e59812ff":"markdown","8e13cd74":"markdown","aa303e60":"markdown","27e92c6e":"markdown","60873419":"markdown","2ff064fc":"markdown","e55b4239":"markdown","2176e8bd":"markdown","12f79cec":"markdown"},"source":{"cd2c7b82":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","f22d5fd6":"import pandas as pd \nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.model_selection import train_test_split,cross_val_score,GridSearchCV,KFold\nfrom sklearn.preprocessing import MinMaxScaler, StandardScaler\nfrom sklearn.decomposition import PCA\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import RandomForestClassifier,AdaBoostClassifier\nfrom sklearn.naive_bayes import GaussianNB\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.ensemble import GradientBoostingClassifier\nfrom sklearn.linear_model import SGDClassifier\nfrom sklearn.ensemble import VotingClassifier\nfrom sklearn.svm import SVC\nfrom sklearn.neural_network import MLPClassifier\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.metrics import roc_curve\nfrom sklearn.metrics import roc_auc_score\nfrom sklearn.metrics  import accuracy_score,classification_report,roc_auc_score,plot_roc_curve,plot_precision_recall_curve\n\nimport warnings\nwarnings.filterwarnings('ignore')","9c5cd8a3":"data=pd.read_csv('\/kaggle\/input\/heart-attack-analysis-prediction-dataset\/heart.csv')","536fa4a6":"data","b634c072":"data.columns","bdfe2dab":"data.isnull().sum()#no missing value","019ce1ba":"cat_var=['sex', 'cp','fbs', 'restecg', 'exng','slp', 'caa', 'thall' ]\ncontinuous_var=['age','chol','trtbps','thalachh','oldpeak',]","f81979e0":"for i in continuous_var:\n    ax = sns.boxplot(data[i])\n    plt.show()","a2cdebcf":"sns.countplot(data=data,x='output')","5ec1a746":"\nfor i in cat_var:\n    sns.countplot(data=data,x=data[i],hue='output')\n    plt.show()","34965c32":"for i in continuous_var:\n    plt.figure(figsize=(10,8))\n    sns.histplot(data=data,x=data[i],hue='output',kde=True)\n    plt.show()\n    ","8621f2b0":"#1-person having age 30-50 and 70+ has more chance of getting heart attack\n#2-person having cholestrol 200+ has high chance of getting heart attack\n","16896fe9":"plt.figure(figsize=(15,15))\nsns.heatmap(data.corr(),annot=True)","109e02f6":"corr_output=data.corr()['output'].sort_values(ascending=False)\ncorr_output","9277408f":"plt.figure(figsize=(8,8))\ncorr_output.plot(kind='bar',color='green')","4beaa135":"sc=StandardScaler()\nscaled_cont=sc.fit_transform(data[continuous_var])\nscaled_cont=pd.DataFrame(scaled_cont,columns=continuous_var)\nscaled_data=pd.concat([scaled_cont,data[cat_var]],axis=1)","97a92c17":"X=scaled_data\nY=data['output']","e7786414":"x_train,x_test,y_train,y_test=train_test_split(X,Y,test_size=.30,random_state=0)","dbcf04ce":"logreg=Pipeline([('logistic',LogisticRegression())])\ndecision=Pipeline([('dt',DecisionTreeClassifier())])\nrandomforest=Pipeline([('rf',RandomForestClassifier())])\nnaivebayes=Pipeline([('nb',GaussianNB())])\nknn=Pipeline([('knn',KNeighborsClassifier())])\ngbc=Pipeline([('gbc',GradientBoostingClassifier())])\nadaboost=Pipeline([('adaboost',AdaBoostClassifier())])\nsgdclassifier=Pipeline([('SGDclassifier',SGDClassifier())])\nsvc=Pipeline([('svc',SVC())])\nmlpclass=Pipeline([('mlpc',MLPClassifier())])","f16772e6":"mypipeline1=[logreg,decision,randomforest,naivebayes,knn,gbc,adaboost,sgdclassifier,svc,mlpclass]\n            ","0361f1a4":"accuracy=0.0\nclassifier=0\npipeline=\"\"\npipelinedict1={0:'logistic',1:'dt',2:'rf',3:'nb',4:'knn',5:'gbc',6:'adaboost',7:'SGDclassifier',\n              8:'svc',9:'mlpc'}","62af22b3":"for i in mypipeline1:\n    i.fit(x_train,y_train)\nmodel_score=[]\nmodel_name=[]\nfor i,j in enumerate(mypipeline1):\n    print(\"{} test accuracy: {}\".format(pipelinedict1[i],j.score(x_test,y_test)))\n    model_name.append(pipelinedict1[i])\n    model_score.append(j.score(x_test,y_test))","0aa6fbbb":"plt.figure(figsize=(8,8))\nplt.barh(model_name,model_score,color='red')\n","74ed7eca":"knn=KNeighborsClassifier()","0ad8448e":"test_score=[]\ntrain_score=[]\nfor i in range(1,50):\n    knn=KNeighborsClassifier(n_neighbors=i)\n    knn.fit(x_train,y_train)\n    train_score.append(knn.score(x_train,y_train))\n    test_score.append(knn.score(x_test,y_test))","7ebb3dfd":"plt.figure(figsize=(10,10))\nplt.plot(range(1,50),train_score,color='green')\nplt.plot(range(1,50),test_score,color='red')\nplt.show()","e246684c":"knn1=KNeighborsClassifier(n_neighbors=6)\nknn1.fit(x_train,y_train)\nknn1.score(x_test,y_test)","1f5afdc6":"knn2=KNeighborsClassifier(n_neighbors=6)\nrand_state=[]\naccuracy=[]\nfor i in range(1,150,1):\n    x_train,x_test,y_train,y_test=train_test_split(X,Y,test_size=.30,random_state=i)\n    knn2.fit(x_train,y_train)\n    accuracy.append(knn2.score(x_test,y_test))\n    rand_state.append(i)\n    ","b7db2f98":"plt.figure(figsize=(10,10))\nplt.plot(rand_state,accuracy)","04613a81":"for i in range(len(rand_state)):\n    print(accuracy[i],rand_state[i])","a424c6d4":"x_train,x_test,y_train,y_test=train_test_split(X,Y,test_size=.30,random_state=107)\nknn2.fit(x_train,y_train)   ","ab0228cd":"knn2.score(x_test,y_test)","571e6a8b":"y_test_pred=knn2.predict(x_test)\n","8af1632b":"accuracy_score(y_test,y_test_pred)","e7031843":"\nplot_roc_curve(knn2,x_test,y_test)","58991124":"roc_auc_score(y_test,y_test_pred)","e0138063":"plot_precision_recall_curve(knn2,x_test,y_test)","23a5b762":"print(classification_report(y_test,y_test_pred))","8550f031":"### here we can see  how all varaible related to the output(+ correlation,-correlation)","985aa3c5":"### ROC AUC SCORE =.90","80a9a5c6":"### here we have got accuracy of our model to be 90.10%","be553ea0":"# 1-male has more percent  of heart cases than female                                                                            #2-person having chest pain atypical angina value has higher chance of getting heart attack                                     #3-fps value less than 120 has higher chance of heart attack\n# 4-rest_ecg having ST-T wave normality has higher chance of getting heart attack\n#5-exercise induced angina has less percent of heart attack chances\n#6-a person having zero major vessels has a higher probility of getting heart attack\n","9b3fcdb1":"### AVERAGE PRECISION SCORE IS-- AP=.93","99a9e08d":"### as we can see that the data has some outliers but we will not remove it ,because we might loss some important data and it is a medical data","4b697ba9":"#### no of more chance ofheart attacked case is higher than less chance of heart attack","8e188711":"### at n_neibhour=6,we are getting highest accuracy","d15e7579":"### here random_state in between 100-120 we,are getting highest accuracy","e59812ff":"### as we can see that KNN has the highest accuracy among all classifier algorithms ,that is 83.51%","8e13cd74":"## UNIVARIATE ANALYSIS","aa303e60":"### at i=107(random_state) we are getting accuracy of 90.10%","27e92c6e":"### here we have got AUC SCORE=.93 which indicate that  model is too good.","60873419":"### VISUALISATION","2ff064fc":"# EXPLORATORY DATA ANALYSIS","e55b4239":"## TUNING THE PARAMETER TO GET BETTER ACCURACY","2176e8bd":"# About this dataset\nAge : Age of the patient\n\nSex : Sex of the patient\n\nexang: exercise induced angina (1 = yes; 0 = no)\n\nca: number of major vessels (0-3)\n\ncp : Chest Pain type chest pain type\n\nValue 1: typical angina\nValue 2: atypical angina\nValue 3: non-anginal pain\nValue 4: asymptomatic\ntrtbps : resting blood pressure (in mm Hg)\n\nchol : cholestoral in mg\/dl fetched via BMI sensor\n\nfbs : (fasting blood sugar > 120 mg\/dl) (1 = true; 0 = false)\n\nrest_ecg : resting electrocardiographic results\n\nValue 0: normal\nValue 1: having ST-T wave abnormality (T wave inversions and\/or ST elevation or depression of > 0.05 mV)\nValue 2: showing probable or definite left ventricular hypertrophy by Estes' criteria\nthalach : maximum heart rate achieved\n\ntarget : 0= less chance of heart attack 1= more chance of heart attack","12f79cec":"### here we have'nt got any improvement"}}