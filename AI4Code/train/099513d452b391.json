{"cell_type":{"45a3d2f2":"code","5152235b":"code","c72be9d7":"code","f014a029":"code","e5c0c1a3":"code","e8b382dd":"code","63584973":"code","7eaaad9f":"code","262da61d":"code","cfa707e3":"code","5cf688f8":"code","57bf04e0":"code","5ffa767f":"markdown","5094ad84":"markdown","712de7ff":"markdown","96a30521":"markdown","3fc96728":"markdown","3e11e820":"markdown","477569df":"markdown","09fc204a":"markdown"},"source":{"45a3d2f2":"import numpy as np \nimport matplotlib.pyplot as plt\nimport pandas as pd \nimport seaborn as sns\ndf1 = pd.read_csv(\"..\/input\/2019-autonomous-vehicle-disengagement-reports\/2018-19_AutonomousVehicleDisengagementReports(firsttimefilers).csv\")\ndf2 = pd.read_csv(\"..\/input\/2019-autonomous-vehicle-disengagement-reports\/2019AutonomousVehicleDisengagementReports.csv\")\n\n#Combining Both DataFrames\nres = [df1, df2] \ndf = pd.concat(res)\n\n#Renaming Columns for Legibility \ndf.columns = ['Manufacturer', 'Permit Number', 'Date', 'VIN number','Vehicle Is Capable Of Operating Without A Driver','Driver Present','Disengagement Initiated By','Disengagement Location', 'Description Of Facts Causing Disengagement', 'N\/A','N\/A'] \ndf.head(20)\n\n#Cleaning up dataframe to get rid of string issues such as \"Test Driver\" vs \"test driver\", etc. \ndf[\"Disengagement Location\"] = df[\"Disengagement Location\"].replace(\"street (high speed)\", \"street\")\ndf[\"Disengagement Location\"] = df[\"Disengagement Location\"].replace(\"Downtown street\", \"street\") \ndf[\"Disengagement Location\"] = df[\"Disengagement Location\"].replace(\"Rural\", \"rural road\") \ndf[\"Disengagement Location\"] = df[\"Disengagement Location\"].replace(\"Parking Lot\", \"parking facility\") \ndf[\"Disengagement Location\"] = df[\"Disengagement Location\"].str.lower()\ndf[\"Disengagement Location\"] = df[\"Disengagement Location\"].replace(\"downtown street\", \"street\") \n\ndf[\"Driver Present\"] = df[\"Driver Present\"].str.lower()\ndf[\"Driver Present\"] = df[\"Driver Present\"].replace(\"nan\", \"no\")\n\ndf[\"Vehicle Is Capable Of Operating Without A Driver\"] = df[\"Vehicle Is Capable Of Operating Without A Driver\"].str.lower()\n\ndf[\"Disengagement Initiated By\"] = df[\"Disengagement Initiated By\"].replace(\"Safety Driver\", \"test driver\")\ndf[\"Disengagement Initiated By\"] = df[\"Disengagement Initiated By\"].replace(\"Vehicle Operator\", \"test driver\") \ndf[\"Disengagement Initiated By\"] = df[\"Disengagement Initiated By\"].str.lower()\n\ndf[\"Date\"] = df[\"Date\"].replace(\"1\/30.2019\", \"1\/30\/2019\")\ndf[\"Date\"] = pd.to_datetime(df[\"Date\"]) \ndf = df.set_index(\"Date\")\n\ndf[\"Description Of Facts Causing Disengagement\"] = df[\"Description Of Facts Causing Disengagement\"].astype(str)\ndf.head(20)\n\n\n","5152235b":"#Number of each stats: \n\nprint(\"Number of reports: \" + str(df.shape[0]))\nprint(\"Number of unique manufacturers: \" + str(df[\"Manufacturer\"].nunique()))\nprint(\"Number of unique vehicles: \" + str(df[\"VIN number\"].nunique()))\nprint(\"Number of unique permits: \" + str(df[\"Permit Number\"].nunique()))\n","c72be9d7":"dates = df.groupby('Date')[\"VIN number\"].nunique()\nprint(dates)\nplt.title(\"Disengagement Frequency Over Time\")\ndates['2018-01-01':'2019-12-31'].resample('Q').count().plot(marker='D')\nplt.xlabel(\"Month\", fontsize=18)\nplt.ylabel(\"Disengagements\", fontsize=18)\nplt.xticks(fontsize=12)\nplt.yticks(fontsize=12)\n\n#Put markers in","f014a029":"#Disengagement Initiated By \ncatinitiate = df['Disengagement Initiated By'].unique().tolist()\ncatinitiate.pop()\nplt.figure(figsize=(25,6))\nplt.title('Disengagement Initiated By', fontsize = 18)\nvcountinitiate = df['Disengagement Initiated By'].value_counts().tolist()\ncolors = ['#66b3ff','#ff9999','#99ff99','#ffcc99']\nplt.pie(vcountinitiate, labels= catinitiate, autopct = '%0.2f%%', colors= colors)\nplt.axis('equal')\ncentre_circle = plt.Circle((0,0),0.70,fc='white')\nfig = plt.gcf()\nfig.gca().add_artist(centre_circle)\nplt.show()\n\n\n","e5c0c1a3":"#Disengagement Location (bar graph instead of pie as more legible)\ncatlocation = df['Disengagement Location'].unique().tolist()\ncatlocation.pop(-1)\ncolors1 = ['#ffcc99', '#99ff99','#66b3ff', '#ff9999',]\ncatloc = range(len(catlocation))\nplt.figure(figsize=(15,6))\nplt.title('Disengagement Location', fontsize = 18)\nplt.xlabel(\"Location\")\nplt.ylabel(\"Frequency\")\nvcountlocation = df['Disengagement Location'].value_counts().tolist()\nplt.bar(catloc, vcountlocation,width = 0.5, color = colors)\nax = plt.subplot()\nax.set_xticks(catloc)\nax.set_xticklabels(catlocation, rotation = 30)\nfor i, v in enumerate(vcountlocation):\n    ax.text(i-.15, v, str(v), color='black')\nplt.show()\n\n\n#ISSUE: Not able to data filter the downtown street to combine with street for some reason, need help with that. \n                     ","e8b382dd":"#Number of Disengagements categorized by Manufacturer\ncatmanu = df['Manufacturer'].unique().tolist()\nplt.figure(figsize=(25,12))\nplt.title('Disengagement by Manufacturer', fontsize=18) \ncatmanunum = range(len(catmanu))\nvcountmanu = df['Manufacturer'].value_counts().tolist()\nplt.bar(catmanunum, vcountmanu, width = 0.5, color = ['#1E90FF'])\nplt.xlabel('Manufacturer', fontsize=15)\nplt.ylabel('Number of Disengagements',fontsize=15) \nax = plt.subplot()\nax.set_xticks(catmanunum)\nax.set_xticklabels(catmanu, rotation = 90)\nfor i, v in enumerate(vcountmanu):\n    ax.text(i-.25, v, str(v), color='black')\nplt.xticks(fontsize=16)\nplt.yticks(fontsize=16)\nplt.show()\n","63584973":"#Was Driver Present During the Disengagements\ncatdriver= df['Driver Present'].unique().tolist()\ncatdriver.pop()\ncatdriver.pop()\ncatdriver.append(\"unknown\")\nvcountdriver = df['Driver Present'].value_counts().tolist()\nplt.figure(figsize = (12,7))\nplt.title('Driver Present During Disengagements')\nplt.pie(vcountdriver, labels= catdriver, autopct = '%0.2f%%', colors= colors)\n\nplt.show()\n\n","7eaaad9f":"#Is Vehicle Capable of Operating Without A Driver \ncatcap = df['Vehicle Is Capable Of Operating Without A Driver'].unique().tolist()\ncatcap.pop()\ncatcap.pop()\ncatcap.append('unknown')\ncolors2 = ['#00BFFF','#ff9999','#99ff99','#ffcc99']\nvcountcap=df['Vehicle Is Capable Of Operating Without A Driver'].value_counts().tolist()\nplt.figure(figsize=(12,7))\nplt.title('Vehicle Capabilities Of Operating Without A Driver', fontsize=18)\nplt.pie(vcountcap, labels= catcap, autopct = '%0.2f%%', colors= colors)\ncentre_circle = plt.Circle((0,0),0.70,fc='white')\nfig = plt.gcf()\nfig.gca().add_artist(centre_circle)\nplt.show()","262da61d":"descriptions = df[\"Description Of Facts Causing Disengagement\"].str.lower().str.replace('[^\\w\\s]','').replace('[^\\n]',' ')\ntotalreports = float(len(df.index))\nplt.figure(figsize = (25, 12))\nc = dict()\nfor description in descriptions:\n    description = description.split(\" \")\n    for word in np.unique(description):\n        if word in c:\n            c[word] += 1\n        else:\n            c[word] = 1\ncatdescrip1 = [\"software\",\"hardware\",\"sensor\",\"camera\",\"lidar\",\"radar\",\"map\",\"gps\"]\ncatdescrip2= [\"planning\",\"perception\",\"tracking\",\"trajectory\",\"localization\",\"control\"]\ncatdescrip3=[\"car\",\"vehicle\",\"truck\",\"pedestrians\",\"bicyclist\"]\ncatdescrip4=[\"light\",\"construction\",\"traffic\",\"intersection\",\"weather\",\"debris\"]\n\nleng1 = range(len(catdescrip1))\nleng2 = range(len(catdescrip2))\nleng3 = range(len(catdescrip3))\nleng4 = range(len(catdescrip4))\n\nsoftware = c[\"software\"]\nhardware = c['hardware']\nsensor = c['sensor']\ncamera = c['camera']\nlidar = c['lidar'] \nradar = c['radar'] \nmaap = c['map'] \ngps = c['gps']\n\nplanning = c[\"planning\"]+c[\"planned\"]\nperception = c[\"perception\"]\ntracking = c[\"tracking\"]\ntrajectory = c[\"trajectory\"]\nlocalization = c[\"localization\"]\ncontrol =c[\"control\"]+c[\"controller\"]\n\ncar = c[\"car\"]\nvehicle = c[\"vehicle\"]\ntruck = c[\"truck\"]\npedestrians = c[\"pedestrians\"]\nbicyclist = c[\"bicyclist\"]\n\nlight = c[\"green\"]+c[\"light\"]\nconstruction = c[\"construction\"]\ntraffic = c[\"traffic\"]\nintersection = c[\"intersection\"]\nweather = c[\"weather\"] + c[\"rain\"]\ndebris = c[\"debris\"]\n\nlistvalue1 = [software, hardware, sensor, camera, lidar, radar, maap, gps]\nlistvalue2 = [planning, perception, tracking, trajectory, localization, control]\nlistvalue3 = [car, vehicle, truck, pedestrians, bicyclist]\nlistvalue4 = [light, construction, traffic, intersection, weather, debris]\n\n\n\n\nplt.title(\"Descriptions of Disengagements One\", fontsize = 25)\nplt.bar(leng1, listvalue1, color = ['#99ff99'])\nax = plt.subplot()\nax.set_xticks(leng1)\nax.set_xticklabels(catdescrip1, rotation = 90, fontsize = 25)\nfor i, v in enumerate(listvalue1):\n    ax.text(i-.25, v, str(v), color='black', fontsize = 18)\n\nplt.xticks(fontsize=25)\nplt.yticks(fontsize=25)\nplt.show()\n\n\n\n","cfa707e3":"plt.figure(figsize = (25, 12))\nplt.title(\"Descriptions of Disengagements Two\", fontsize = 18)\nplt.bar(leng2, listvalue2, color = ['#1E90FF'])\nax = plt.subplot()\nax.set_xticks(leng2)\nax.set_xticklabels(catdescrip2, rotation = 90, fontsize = 15)\nfor i, v in enumerate(listvalue2):\n    ax.text(i-.25, v, str(v), color='black', fontsize = 15)\n\nplt.xticks(fontsize=14)\nplt.yticks(fontsize=14)\nplt.show()\n\n\n","5cf688f8":"plt.figure(figsize = (25, 12))\nplt.title(\"Descriptions of Disengagements Three\", fontsize = 18)\nplt.bar(leng3, listvalue3, color = ['#1E90FF'])\nax = plt.subplot()\nax.set_xticks(leng3)\nax.set_xticklabels(catdescrip3, rotation = 90, fontsize = 15)\nfor i, v in enumerate(listvalue3):\n    ax.text(i-.25, v, str(v), color='black',fontsize = 15)\n\nplt.xticks(fontsize=14)\nplt.yticks(fontsize=14)\nplt.show()\n\n\n","57bf04e0":"plt.figure(figsize = (25, 12))\nplt.title(\"Descriptions of Disengagements Four\", fontsize = 18)\nplt.bar(leng4, listvalue4, color = ['#1E90FF'])\nax = plt.subplot()\nax.set_xticks(leng4)\nax.set_xticklabels(catdescrip4, rotation = 90, fontsize = 15)\nfor i, v in enumerate(listvalue4):\n    ax.text(i-.25, v, str(v), color='black', fontsize = 15)\n\nplt.xticks(fontsize=14)\nplt.yticks(fontsize=14)\nplt.show()\n\n\n","5ffa767f":"Count Statistics","5094ad84":"Disengagement Descriptions","712de7ff":"Disengagement Location ","96a30521":"Disengagements by Manufacturer ","3fc96728":"Disengagement Frequency Over Time ","3e11e820":"Vehicle Capable Of Operating Without A Driver","477569df":"Driver Present During Disengagements","09fc204a":"Disengagement Initiated By "}}