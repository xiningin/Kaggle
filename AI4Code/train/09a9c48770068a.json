{"cell_type":{"addb0ae8":"code","f3e2c194":"code","7af9be23":"code","2ca0b1cc":"code","3590095e":"code","c368469d":"code","74fbb689":"code","8b73001c":"code","55cec713":"code","fe42f713":"code","c3710ff6":"code","4e8167c0":"code","ecd3f20f":"code","cc8d8fca":"code","be30761e":"code","482a71c6":"code","aba2d28e":"code","44458b94":"code","537935c8":"code","bb76679c":"code","aa7a8059":"code","55bb4d27":"code","8fa94ed2":"code","0f66248d":"code","4809072e":"code","18add35a":"code","60b147f7":"code","5fb47aca":"markdown","60581bac":"markdown","17a85954":"markdown","e0e0975c":"markdown","44d7596e":"markdown","6c3359f4":"markdown"},"source":{"addb0ae8":"import numpy as np\nimport pandas as pd\nimport re\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline\nimport surprise","f3e2c194":"df = pd.read_csv('..\/input\/Amazon - Movies and TV Ratings.csv')","7af9be23":"df.head()","2ca0b1cc":"df.shape","3590095e":"df_org = df.copy()","c368469d":"df.describe().T","74fbb689":"#Movie with highest views\ndf.describe().T['count'].sort_values(ascending=False)[:1].to_frame() #---Movie127","8b73001c":"#Movie with highest Ratings\ndf.drop('user_id',axis=1).sum().sort_values(ascending=False)[:1].to_frame()  #---Movie127","55cec713":"df.drop('user_id',axis=1).mean().sort_values(ascending=False)[:5].to_frame()","fe42f713":"df.describe().T['count'].sort_values(ascending=True)[:5].to_frame()","c3710ff6":"from surprise import Reader\nfrom surprise import accuracy\nfrom surprise import Dataset\nfrom surprise.model_selection import train_test_split\nfrom surprise import SVD\nfrom surprise.model_selection import cross_validate","4e8167c0":"df_melt = df.melt(id_vars = df.columns[0],value_vars=df.columns[1:],var_name=\"Movies\",value_name=\"Rating\")","ecd3f20f":"df_melt","cc8d8fca":"rd = Reader()\ndata = Dataset.load_from_df(df_melt.fillna(0),reader=rd)\ndata","be30761e":"trainset, testset = train_test_split(data,test_size=0.25)","482a71c6":"#Using SVD (Singular Value Descomposition)\nsvd = SVD()\nsvd.fit(trainset)","aba2d28e":"pred = svd.test(testset)","44458b94":"accuracy.rmse(pred)","537935c8":"accuracy.mae(pred)","bb76679c":"cross_validate(svd, data, measures = ['RMSE', 'MAE'], cv = 3, verbose = True)","aa7a8059":"def repeat(ml_type,dframe):\n    rd = Reader()\n    data = Dataset.load_from_df(dframe,reader=rd)\n    print(cross_validate(ml_type, data, measures = ['RMSE', 'MAE'], cv = 3, verbose = True))\n    print(\"--\"*15)\n    usr_id = 'A3R5OBKS7OM2IR'\n    mv = 'Movie1'\n    r_u = 5.0\n    print(ml_type.predict(usr_id,mv,r_ui = r_u,verbose=True))\n    print(\"--\"*15)\n","55bb4d27":"repeat(SVD(),df_melt.fillna(df_melt['Rating'].mean()))\n#repeat(SVD(),df_melt.fillna(df_melt['Rating'].median()))","8fa94ed2":"#trying grid search and find optimum hyperparameter value for n_factors\nfrom surprise.model_selection import GridSearchCV","0f66248d":"param_grid = {'n_epochs':[20,30],\n             'lr_all':[0.005,0.001],\n             'n_factors':[50,100]}","4809072e":"gs = GridSearchCV(SVD,param_grid,measures=['rmse','mae'],cv=3)\ndata1 = Dataset.load_from_df(df_melt.fillna(df_melt['Rating'].mean()),reader=rd)\ngs.fit(data1)","18add35a":"gs.best_score","60b147f7":"print(gs.best_score[\"rmse\"])\nprint(gs.best_params[\"rmse\"])","5fb47aca":"### Task 2 - What is the average rating for each movie? Define the top 5 movies with the maximum ratings","60581bac":"### Analysis Task\n##### - Exploratory Data Analysis:\n\n###### Which movies have maximum views\/ratings?\n###### What is the average rating for each movie? Define the top 5 movies with the maximum ratings.\n###### Define the top 5 movies with the least audience.\n\n##### - Recommendation Model: Some of the movies hadn\u2019t been watched and therefore, are not rated by the users. Netflix would like to take this as an opportunity and build a machine learning recommendation algorithm which provides the ratings for each of the users.\n\n###### Divide the data into training and test data\n###### Build a recommendation model on training data\n###### Make predictions on the test data","17a85954":"### Task 4 - Recommendation Model","e0e0975c":"### Task 1  - Which movies have maximum views\/ratings?","44d7596e":"## Building user-based recommendation model for Amazon","6c3359f4":"### Task 3 - Define the top 5 movies with the least audience"}}