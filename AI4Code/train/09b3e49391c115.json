{"cell_type":{"42a2378b":"code","4a2f2321":"code","e1afe219":"code","e27e116b":"code","ff1ac5fd":"code","ddf65e37":"code","4b0dc132":"code","e8429315":"code","5f14869d":"code","6b79339a":"code","bbc98d9d":"code","cb0b3602":"code","37b4e247":"code","1c5ca1e6":"code","a448c7c8":"code","677b99f4":"code","42600d56":"code","7ae83937":"code","a3585b53":"code","59adaf9a":"markdown","24f0d1cc":"markdown","cd0c0ad9":"markdown","7c192363":"markdown","5c425150":"markdown","d9596351":"markdown","899882c9":"markdown","dd64fc6d":"markdown","b3748529":"markdown","c4c8b391":"markdown","6ae90674":"markdown","a48b0551":"markdown"},"source":{"42a2378b":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport warnings\n\n#Suppressing all warnings\nwarnings.filterwarnings(\"ignore\")\n\n%matplotlib inline","4a2f2321":"df=pd.read_csv('..\/input\/heart-failure-clinical-data\/heart_failure_clinical_records_dataset.csv')\ndf.head()","e1afe219":"#checking null values\ndf.isnull().sum()","e27e116b":"df.info()","ff1ac5fd":"#converting age from float to int\ndf['age']=df['age'].astype(int)","ddf65e37":"corr = df.corr()\nsns.heatmap(corr, xticklabels=corr.columns, yticklabels=corr.columns)","4b0dc132":"corr[abs(corr['DEATH_EVENT']) > 0.1]['DEATH_EVENT']","e8429315":"df.columns","5f14869d":"x=df[['age', 'ejection_fraction', 'serum_creatinine', 'serum_sodium', 'time']]\ny=df['DEATH_EVENT']","6b79339a":"x.head()","bbc98d9d":"y.head()","cb0b3602":"from sklearn.model_selection import train_test_split\nx_train,x_test,y_train,y_test=train_test_split(x,y,random_state=1,test_size=0.2)","37b4e247":"#Metrics\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.metrics import classification_report\nfrom sklearn.metrics import f1_score\nfrom sklearn.metrics import confusion_matrix","1c5ca1e6":"from sklearn.linear_model import LogisticRegression\nfrom sklearn.metrics import accuracy_score\nlr=LogisticRegression(max_iter=10000)\nlr.fit(x_train,y_train)\nlr_pred=lr.predict(x_test)\ns1=accuracy_score(y_test,lr_pred)\nprint(\"Logistic Regression Success Rate :\", \"{:.2f}%\".format(100*s1))\nprint(classification_report(y_test,lr.predict(x_test)))\nprint(confusion_matrix(y_test,lr.predict(x_test)))","a448c7c8":"from sklearn.ensemble import GradientBoostingClassifier\ngbc=GradientBoostingClassifier()\ngbc.fit(x_train,y_train)\np2=gbc.predict(x_test)\ns2=accuracy_score(y_test,p2)\nprint(\"Gradient Booster Classifier Success Rate :\", \"{:.2f}%\".format(100*s2))\nprint(classification_report(y_test,gbc.predict(x_test)))\nprint(confusion_matrix(y_test,gbc.predict(x_test)))","677b99f4":"from sklearn.ensemble import RandomForestClassifier\nrfc=RandomForestClassifier()\nrfc.fit(x_train,y_train)\np3=rfc.predict(x_test)\ns3=accuracy_score(y_test,p3)\nprint(\"Random Forest Classifier Success Rate :\", \"{:.2f}%\".format(100*s3))\nprint(classification_report(y_test,rfc.predict(x_test)))\nprint(confusion_matrix(y_test,rfc.predict(x_test)))","42600d56":"from sklearn.svm import SVC\nsvm=SVC()\nsvm.fit(x_train,y_train)\np4=svm.predict(x_test)\ns4=accuracy_score(y_test,p4)\nprint(\"Support Vector Machine Success Rate :\", \"{:.2f}%\".format(100*s4))\nprint(classification_report(y_test,svm.predict(x_test)))\nprint(confusion_matrix(y_test,svm.predict(x_test)))","7ae83937":"from sklearn.neighbors import KNeighborsClassifier\nscorelist=[]\nfor i in range(1,21):\n    knn=KNeighborsClassifier(n_neighbors=i)\n    knn.fit(x_train,y_train)\n    p5=knn.predict(x_test)\n    s5=accuracy_score(y_test,p5)\n    scorelist.append(round(100*s5, 2))\nprint(\"K Nearest Neighbors Top 5 Success Rates:\")\nprint(sorted(scorelist,reverse=True)[:5])\nprint(classification_report(y_test,knn.predict(x_test)))\nprint(confusion_matrix(y_test,knn.predict(x_test)))","a3585b53":"## Pickle\nimport pickle\n\n# save model\npickle.dump(svm, open('heart.pickle', 'wb'))\n\n# load model\nheart_failure_model = pickle.load(open('heart.pickle', 'rb'))\n","59adaf9a":"### Importing Libraries","24f0d1cc":"### RandomForest Classifier","cd0c0ad9":"### Support Vector Machine Classifier","7c192363":"### Splitting the Data set","5c425150":"> Here we can observe that there is no null values present in this data .I think it's good sign towards good accuracy.","d9596351":"### Logistic Regression","899882c9":"### KNeighbors Classifier","dd64fc6d":"### Gradient Boosting Classifier","b3748529":"### Saving Model","c4c8b391":"The features 'age', 'ejection_fraction', 'serum_creatinine', 'serum_sodium', and 'time' have a considerable correlation with 'DEATH_EVENT'","6ae90674":"### Exploration of Data","a48b0551":"# Heart Failure Prediction"}}