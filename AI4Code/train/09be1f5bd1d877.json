{"cell_type":{"299b452f":"code","1b665a60":"code","3b703de4":"code","d95c48c7":"code","04dd5810":"code","de38806d":"code","70573eb8":"code","25c8b18d":"code","1635163f":"code","ed8e35d9":"code","b5ef4d02":"code","5b70cb64":"code","3eaa0cf8":"code","52c5f02f":"code","d6502c6c":"code","1e2cfdf1":"code","14f96eea":"code","4ea39a34":"code","af6cb798":"code","d01dc3b5":"code","28c23e27":"code","b13909f6":"code","5b774e01":"code","3934ed33":"code","9e138ec0":"code","c3a79500":"code","1f054532":"code","75569341":"code","364cbf36":"code","b098da3e":"code","f3fa697c":"markdown","1deda5fb":"markdown","02074f9a":"markdown","6342dfa3":"markdown"},"source":{"299b452f":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","1b665a60":"data = pd.read_csv(\"..\/input\/digit-recognizer\/train.csv\")","3b703de4":"X = data.drop('label', axis=1)","d95c48c7":"X = X.values.reshape(42000, 28, 28, 1)","04dd5810":"y = data['label']","de38806d":"X = X \/ 255","70573eb8":"from sklearn.model_selection import train_test_split","25c8b18d":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.25, random_state=42)","1635163f":"from tensorflow.keras.utils import to_categorical","ed8e35d9":"y_cat_train = to_categorical(y_train)","b5ef4d02":"y_cat_test = to_categorical(y_test)","5b70cb64":"from tensorflow.keras.models import Sequential \nfrom tensorflow.keras.layers import Dense, Conv2D, MaxPool2D, Flatten, Dropout, BatchNormalization","3eaa0cf8":"model = Sequential()\n\nmodel.add(Conv2D(32, kernel_size=(4, 4), input_shape=(28, 28, 1), activation='relu'))\nmodel.add(MaxPool2D(pool_size=(2, 2)))\nmodel.add(BatchNormalization())\n\nmodel.add(Conv2D(32, kernel_size=(4, 4), input_shape=(28, 28, 1), activation='relu'))\nmodel.add(MaxPool2D(pool_size=(2, 2)))\nmodel.add(BatchNormalization())\n\nmodel.add(Flatten())\n\nmodel.add(Dense(256, activation='relu'))\nmodel.add(Dropout(0.25))\n\nmodel.add(Dense(128, activation='relu'))\nmodel.add(Dropout(0.25))\n\nmodel.add(Dense(64, activation='relu'))\nmodel.add(Dropout(0.25))\n\nmodel.add(Dense(10, activation='softmax'))\n\nmodel.compile(loss='categorical_crossentropy', optimizer='adam', metrics=['accuracy'])","52c5f02f":"model.summary()","d6502c6c":"from tensorflow.keras.callbacks import EarlyStopping","1e2cfdf1":"early_stop = EarlyStopping(monitor='val_loss', patience=2)","14f96eea":"model.fit(x=X_train, y=y_cat_train, epochs=20, \n          validation_data=(X_test, y_cat_test))","4ea39a34":"metrics = pd.DataFrame(model.history.history)","af6cb798":"metrics.columns","d01dc3b5":"metrics[['accuracy', 'val_accuracy']].plot()","28c23e27":"metrics[['loss', 'val_loss']].plot()","b13909f6":"test = pd.read_csv(\"..\/input\/digit-recognizer\/test.csv\")","5b774e01":"test_set = test.values.reshape(28000, 28, 28, 1)","3934ed33":"test_set = test_set \/ 255","9e138ec0":"sub_pred = model.predict_classes(test_set)","c3a79500":"pred = pd.DataFrame(sub_pred)","1f054532":"pred.index = range(1, 28001)","75569341":"pred = pred.reset_index()","364cbf36":"pred.columns = ['ImageId', 'Label']","b098da3e":"pred.to_csv(\"pred.csv\", index=False)","f3fa697c":"### Build model","1deda5fb":"## Making predictions","02074f9a":"### Encode y values","6342dfa3":"# Data processing"}}