{"cell_type":{"62f8506c":"code","0e09b8b6":"code","ac4d289d":"code","73fe82d4":"code","b0cd9153":"code","f19fedfe":"code","2e691a66":"code","92ca93b1":"code","533adb39":"code","845bb9d8":"code","8e269cc6":"code","2a647287":"code","7b5bfb25":"markdown","f7f04815":"markdown","5ba69f0a":"markdown","442c79fd":"markdown","f03d9e19":"markdown","fa07ea4a":"markdown","f576d5d4":"markdown","f8b4cb3e":"markdown","423f1afe":"markdown","d4a950de":"markdown","b77e6e40":"markdown","e9dd2ff9":"markdown","b77e6abd":"markdown","12114281":"markdown"},"source":{"62f8506c":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\nfrom astropy.table import Table\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport seaborn as sns\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","0e09b8b6":"sns.set_style('darkgrid')","ac4d289d":"file_path=\"..\/input\/gaia-edr3\/Gaia_eDR3_Praesepe.fits\"\ndata=Table.read(file_path,format=\"fits\")","73fe82d4":"f=plt.figure(facecolor='white',figsize=(3,3),dpi=300)\nax1=plt.subplot(111,aspect=1)\nax1.plot(data['RA_ICRS'],data['DE_ICRS'],'.',c='k',ms=.1,mew=.1)\nax1.tick_params(axis='both',which='both',labelsize=4,right=True,top=True,direction='in')\n\nax1.set_xlabel('R.A. [deg]',size='x-small',style='normal',family='sans-serif')\nax1.set_ylabel('Decl. [deg]',size='x-small',style='normal',family='sans-serif')\n\nplt.show()","b0cd9153":"Dpass=np.where((data['Plx']\/data['e_Plx']>10) &\n               (data['FG']\/data['e_FG']>10)&\n               (data['FBP']\/data['e_FBP']>10)&\n               (data['FRP']\/data['e_FRP']>10)&\n               (data['Nper']>5)&\n               (data['epsi']<1))\ncleandata=data[Dpass]","f19fedfe":"distance=1000\/cleandata['Plx']\nsns.displot(data=distance,kde=True)","2e691a66":"plt.hist(distance,range=(150,210),bins=30)\n#sns.displot(data=distance[150:210],kde=True)\nplt.xlabel('Distance [pc]',size=\"small\")\nplt.ylabel('Number',size=\"small\")\nplt.show()","92ca93b1":"plt.plot(cleandata['pmRA'],cleandata['pmDE'],'.',c='k',ms=.2,mew=.2)\nplt.xlabel(r'$\\mu_\\alpha \\cos \\delta$ [mas\/yr]', fontsize=15, style='normal',family='sans-serif' )\nplt.ylabel(r'$\\mu_\\delta$ [mas\/yr]', fontsize=15, style='normal' , family='sans-serif' )\nplt.xlim(-100,100)\nplt.ylim(-100,100)\n\nplt.show()","533adb39":"#selection 1: circle cut , within \u0394\u03bc = 9 mas yr\u22121 of the cluster\u2019s average PM\nDpass2=np.where((np.power(cleandata['pmRA']+35,2)+np.power(cleandata['pmDE']+13,2))<81)\ncleandata2=cleandata[Dpass2]\n\nplt.figure(figsize=(14,9))\nplt.plot(cleandata['pmRA'],cleandata['pmDE'],'.',c='k',ms=.8,mew=.8)\nplt.plot(cleandata2['pmRA'],cleandata2['pmDE'],'m.',ms=.8,mew=.8)\nangle_iter = np.arange(0,2*np.pi,0.01)\na = -35+9*np.cos(angle_iter)\nb = -13+9*np.sin(angle_iter)\nplt.plot(a,b,color='g',linestyle='-.')\nplt.plot(a,-b,color='g',linestyle='-.')\nplt.xlabel(r'$\\mu_\\alpha \\cos \\delta$ [mas\/yr]_Figure2', fontsize=15, style='normal',family='sans-serif' )\nplt.ylabel(r'$\\mu_\\delta$ [mas\/yr]', fontsize=15, style='normal' , family='sans-serif' )\nplt.xlim(-50,-20)\nplt.ylim(-24,0)","845bb9d8":"#selection 2 :distance reqirement:. Assuming the distance of Praesepe members at 179 pc. Allowing a radius of 10 pc to select members.\ndistance=1000\/cleandata2['Plx']\nDpass3=np.where((distance>=169) & (distance<=189))\ndistance_sel=distance[Dpass3]\ncleandata3=cleandata2[Dpass3]\n\nsns.displot(distance_sel,kde=True)\nplt.title(\"Slected distance distribution\")\nplt.xlabel('Distance [pc]',fontsize=15)\nplt.ylabel('Number',fontsize=15)\n\nplt.show()","8e269cc6":"yd=cleandata3['Gmag']\nxd=cleandata3['BPmag']-cleandata3['RPmag']\nplt.xlabel(\" BP_mag \u2013 RP_mag\",fontsize=15)\nplt.ylabel(\"Gmag\",fontsize=15)\nplt.gca().invert_yaxis()\nplt.scatter(xd,yd,color='c')","2a647287":"plt.gca().invert_yaxis()\nsns.regplot(x=xd,y=yd)","7b5bfb25":"After the quality cut in the chapter 1 step 5, we know that the PM distribution has two peaks, one for the cluster (\u03bc\u03b1 cos \u03b4 \u2248 \u221235.0 mas yr\u22121, \u03bc\u03b4 \u2248 \u221213.0 mas yr\u22121) and the other for field stars (\u03bc\u03b1 cos \u03b4 \u2248 \u22123.0 mas yr\u22121, \u03bc\u03b4 \u2248 \u22122.5 mas yr\u22121). The latter is the reflex Galactic motion of the Sun toward this particular line of sight. Therefore, we chose the former one to find the members of praesepe star cluster.It is reasonabel to use a circular cut to select members within \u0394\u03bc = 9 mas yr\u22121 of the cluster\u2019s average PM, that we adopted to select PM membership. The points selected are colored to red.","f7f04815":"Step 5:  \nPlot the proper motion R.A. and Decl. According to Wang(et al., 2014), we get that around the peak of the cluster, the distribution is dominated by members, and away from the peak the contamination by field stars becomes prominent. In fact, Praesepe is among a few cases where the cluster\u2019s motion is clearly separated from that of the field, so the PM distribution exhibits a distinct secondary peak due to the cluster.","5ba69f0a":"Plot the members on the color magnitude diagram BP_mag \u2013 RP_mag vs Gmag\n","442c79fd":"# Chapter 2: cluster member selection","f03d9e19":"Step 3: \nQuality Cut. we need to get the data in which the information of distance should be positive, so we need a quality cut.","fa07ea4a":"#  Chaper 1: Know your data","f576d5d4":"The next step is to displays the distance histogram of the proper motion selected stars, we select the stars within 10 pc far away from praesepe, that is we only remain the stars whose distance is between 169pc and 189 pc.","f8b4cb3e":"# Chapter 3 \u2013 Cluster member properties:","423f1afe":"find the linear regression line of the points","d4a950de":"It is evident to see a main sequence from the figure blow. In astronomy, the main sequence is a continuous and distinctive band of stars that appears on plots of stellar color versus brightness. These color-magnitude plots are known as Hertzsprung\u2013Russell diagrams after their co-developers, Ejnar Hertzsprung and Henry Norris Russell. Stars on this band are known as main-sequence stars or dwarf stars. These are the most numerous true stars in the universe, and include the Earth's Sun.","b77e6e40":"Step2:  \nPlot the data out. I use the 2D position data of the stars, which are in the RA_ICRS and DE_ICRS columns in the table. The Daia_eDR3_Praesepe.fits should contain a 5-degree radius center, since the members of praesepe star should have same pace location.\n","e9dd2ff9":"Step 4: \nWe plot a histogram of distance to ensure the distribution of the cluster is centered around 180 pc. \n* Firstly, we use seabron to see the total data distribution.\n* second ,we use matplotlibs to see the distribution around 180 pv","b77e6abd":"This notebook is created to show how we find the members of praesepe star cluster based on Gaia Early Data Release3.\n\n---","12114281":"Step 1:  \nread the Gaia Early Data Release3 into python"}}