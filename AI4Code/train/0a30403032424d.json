{"cell_type":{"e810bef3":"code","be785b38":"code","73d50e19":"code","50ec9fa0":"code","e8ec189f":"code","a1a75199":"code","b23a7b56":"code","f63c8cd5":"code","3c057a69":"code","769adda4":"code","879ce8ae":"code","e7c2eed6":"code","9d56dbbe":"code","a7991767":"code","8c323830":"code","334f5ecb":"code","8fc43ad7":"code","dc7eca1c":"code","51cf9d8a":"code","4698a530":"code","4908ff85":"code","52d790d6":"markdown","e14c9cc3":"markdown","bd622bc2":"markdown"},"source":{"e810bef3":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n% matplotlib inline","be785b38":"data=pd.read_csv(\"..\/input\/creditcard.csv\")\ndata.head(10)","73d50e19":"print(data.shape)\nprint(data.Time.max())\nprint(data.Time.min())\nprint(data.Amount.max())\nprint(data.Amount.min())","50ec9fa0":"from sklearn.preprocessing import MinMaxScaler\nscaler = MinMaxScaler()\ndata.iloc[:,[0,29]]=scaler.fit_transform(data.iloc[:,[0,29]])","e8ec189f":"data.head()","a1a75199":"print(data.Amount.max())\nprint(data.Amount.min())","b23a7b56":"class_count=pd.value_counts(data.Class,sort=True)","f63c8cd5":"class_count.plot(kind='bar')\nplt.xlabel(\"Class\")\nplt.ylabel(\"Freq\")\nplt.title(\"Class vs Freq\")","3c057a69":"X=data.ix[:,data.columns!=\"Class\"]\nY=data.ix[:,data.columns==\"Class\"]\nprint(X.shape)\nprint(Y.shape)","769adda4":"number_fraud=len(data[data.Class==1])\nnumber_fraud_index=np.array(data[data.Class==1].index)\nnumber_normal=np.array(data[data.Class==0].index)\n\nnumber_normal_index=np.random.choice(number_normal,number_fraud,replace=False)\nassert(number_normal_index.shape==number_fraud_index.shape)","879ce8ae":"print(len(number_normal_index))","e7c2eed6":"undersample_index=np.concatenate([number_fraud_index,number_normal_index])\nprint(undersample_index.shape)","9d56dbbe":"undersample_data=data.iloc[undersample_index,:]\nX_sampling=undersample_data.iloc[:,:30]\nY_sampling=undersample_data.iloc[:,30:]\nprint(X.shape)\nprint(Y.shape)","a7991767":"print(len(undersample_data[undersample_data.Class==0]))","8c323830":"from sklearn.model_selection import train_test_split\nx_sampling_train,x_sampling_test,y_sampling_train,y_sampling_test=train_test_split(X_sampling,Y_sampling,test_size=0.3)","334f5ecb":"print(x_sampling_train.shape)\nprint(x_sampling_test.shape)","8fc43ad7":"from sklearn.svm import SVC\nclassifier=SVC(kernel=\"rbf\",probability=True)\nclassifier.fit(x_sampling_train,y_sampling_train)\ny_sampling_pred=classifier.predict(x_sampling_test)","dc7eca1c":"from sklearn.metrics import confusion_matrix\nconfusion_matrix(y_sampling_test,y_sampling_pred)","51cf9d8a":"from sklearn.metrics import recall_score\nrecall_score(y_sampling_test,y_sampling_pred)","4698a530":"Y_pred=classifier.predict(X)\nprint(confusion_matrix(Y,Y_pred))\nprint(recall_score(Y,Y_pred))","4908ff85":"threshold=[0.1,0.2,0.4,0.5]\nfor i in threshold:\n    Y_pred_temp=classifier.predict_proba(X)\n    Y_pred_temp=Y_pred_temp[:,1]>i\n    print(\"-------------------------------------------------------------\")\n    print(\"Threshold : \"+ str(i)+\"\\n\")\n    print(confusion_matrix(Y,Y_pred_temp))\n    print(\"\\n\")\n    print(recall_score(Y,Y_pred_temp))","52d790d6":"# Resampling the data","e14c9cc3":"# Testing on Whole Dataset","bd622bc2":"# Setting the threshold Probablity "}}