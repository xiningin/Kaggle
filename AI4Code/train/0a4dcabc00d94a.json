{"cell_type":{"47312ff1":"code","afbe5f5d":"code","d12906e2":"code","d5b9ef79":"code","1195c7b7":"markdown"},"source":{"47312ff1":"import eli5\nfrom eli5.sklearn import PermutationImportance\nimport pandas as pd\nfrom lightgbm import LGBMClassifier\nfrom sklearn.model_selection import KFold\n#\u00a0Need this to display each ELI5 HTML report within the for loop.\nfrom IPython.display import display\n%matplotlib inline","afbe5f5d":"train_df = pd.read_csv('..\/input\/train.csv')\ntest_df = pd.read_csv('..\/input\/test.csv')","d12906e2":"SEED = 314\nCV = KFold(n_splits=5)\nFEATURES = train_df.drop([\"target\", \"ID_code\"], axis=1).columns.tolist()\nTARGET_COL = \"target\"","d5b9ef79":"for fold, (train_idx, valid_idx) in enumerate(CV.split(train_df, train_df[TARGET_COL])):\n    clf = LGBMClassifier(random_state=SEED, n_threads=-1, \n                         eval_metric=\"auc\", n_estimators=10000)\n    clf.fit(train_df.loc[train_idx, FEATURES], \n            train_df.loc[train_idx, TARGET_COL], \n            eval_metric=\"auc\",\n            verbose=0,\n            early_stopping_rounds=1000,\n            eval_set=[(train_df.loc[valid_idx, FEATURES], \n                       train_df.loc[valid_idx, TARGET_COL])])\n    permutation_importance = PermutationImportance(clf, random_state=SEED)\n    permutation_importance.fit(train_df.loc[valid_idx, FEATURES], \n                               train_df.loc[valid_idx, TARGET_COL])\n    print(f\"Permutation importance for fold {fold}\")\n    display(eli5.show_weights(permutation_importance, feature_names = FEATURES))","1195c7b7":"A short notebook where I explore the concept of permutation importance using \nthe [**ELI5 library**](https:\/\/eli5.readthedocs.io\/en\/latest\/blackbox\/permutation_importance.html). \n\nInspired from this great tutorial: https:\/\/www.kaggle.com\/dansbecker\/permutation-importance. \n\nEnjoy!"}}