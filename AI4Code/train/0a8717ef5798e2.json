{"cell_type":{"90cd83df":"code","82e46be1":"code","45b3db44":"code","69ceffee":"code","64aa4d44":"code","e3e73dc1":"code","cea04134":"code","8130dc57":"code","cc744add":"code","802a97ff":"code","af3ac96a":"code","ac939cd2":"code","a926f8fb":"code","69af4449":"code","7aa5e648":"code","060b1aa7":"code","b4f72a43":"code","7e2fba06":"code","f3be4063":"code","bfa81da4":"code","a6acec37":"code","31f65c30":"code","739fb5a3":"code","52a2b4dc":"code","62062c58":"code","7d85e191":"code","cc932894":"code","bbe1a50b":"code","7ec89660":"code","b8b4d247":"code","2936536f":"code","aaedef5b":"code","7d99466b":"code","ba0e7d42":"code","5767945f":"code","cafc7e08":"code","928b53ea":"code","ff2f8f74":"code","86bc4352":"code","8660a724":"code","aaf69394":"code","7788f388":"code","3f0948e3":"code","cf29221a":"code","dacbd897":"code","347af18b":"code","5bf233e2":"code","205f0711":"code","b8f57c12":"code","51b3463d":"markdown","3759bfa6":"markdown","23fc13a7":"markdown","2b2b3e23":"markdown","7bf07268":"markdown","7854b01a":"markdown","6e106f0d":"markdown","113fc1f9":"markdown","2028c365":"markdown","2519c8c2":"markdown","247475e1":"markdown","e6b888b0":"markdown","7d48876d":"markdown","e6b2fd50":"markdown","f7b5e23a":"markdown","c4d360e4":"markdown","dea17088":"markdown","a5663614":"markdown","d06eaddd":"markdown","133e9c69":"markdown","56d014ef":"markdown"},"source":{"90cd83df":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","82e46be1":"dftrain=pd.read_csv('..\/input\/titanic\/train.csv')\ndftest=pd.read_csv('..\/input\/titanic\/test.csv')","45b3db44":"dftrain.head()","69ceffee":"dftrain.describe()","64aa4d44":"dftrain.columns","e3e73dc1":"dftrain.info()","cea04134":"dftrain.isnull().sum()","8130dc57":"dftest.isnull().sum()","cc744add":"#Let's make a visual of the null values\nplt.figure(figsize=(10,10))\nsns.heatmap(dftrain.isnull(), cmap=None, yticklabels=False, cbar = False)","802a97ff":"sns.countplot(x='Survived', hue='Sex', data=dftrain)\n#0= did not survive\n#1 = survived","af3ac96a":"\nprint(\"Female Survivors %:\", \n      dftrain[\"Survived\"][dftrain[\"Sex\"] == 'female'].value_counts(normalize = True)[1]*100)\n\nprint(\"Male Survivors %:\", \n      dftrain[\"Survived\"][dftrain[\"Sex\"] == 'male'].value_counts(normalize = True)[1]*100)\n\nsns.barplot(data=dftrain, x='Sex', y='Survived')\nplt.ylabel('Survival Rate')\nplt.show()","ac939cd2":"sns.countplot(x='Survived', hue='Pclass', data=dftrain)\n#0= did not survive, more people in the 3rd class perished\n#1 = survived","a926f8fb":"print(\"Pclass 1 Survivors %:\", dftrain[\"Survived\"][dftrain[\"Pclass\"] == 1].value_counts(normalize = True)[1]*100)\n\nprint(\"Pclass 2 Survivors %:\", dftrain[\"Survived\"][dftrain[\"Pclass\"] == 2].value_counts(normalize = True)[1]*100)\n\nprint(\"Pclass 3 Survivors %:\", dftrain[\"Survived\"][dftrain[\"Pclass\"] == 3].value_counts(normalize = True)[1]*100)\n\n\nsns.barplot(data=dftrain, x='Pclass', y='Survived', palette=\"pastel\", edgecolor=\".6\")\nplt.show()","69af4449":"sns.countplot(data=dftrain, x='SibSp')","7aa5e648":"# Some of the values survived percentage percentage values\nprint(\"Passangers with SibSp who survived %:\", dftrain[\"Survived\"][dftrain[\"SibSp\"] == 0].value_counts(normalize = True)[1]*100)\n\nprint(\"Passangers with SibSp who survived %:\", dftrain[\"Survived\"][dftrain[\"SibSp\"] == 1].value_counts(normalize = True)[1]*100)\n\nprint(\"Passangers with SibSp who survived %:\", dftrain[\"Survived\"][dftrain[\"SibSp\"] == 2].value_counts(normalize = True)[1]*100)\n\nprint(\"Passangers with SibSp who survived %:\", dftrain[\"Survived\"][dftrain[\"SibSp\"] == 3].value_counts(normalize = True)[1]*100)\n\nsns.barplot(x=\"SibSp\", y=\"Survived\", data=dftrain)","060b1aa7":"sns.displot(dftrain['Fare'].dropna(), kde=False, bins=40)","b4f72a43":"import cufflinks as cf\ncf.go_offline()\ndftrain['Fare'].iplot(kind='hist', bins=30)","7e2fba06":"sns.displot(dftrain['Age'].dropna(), kde=False, bins=30)","f3be4063":"sns.boxplot(data=dftrain, x='Pclass', y='Age')","bfa81da4":"dftrain['Age'].mean()","a6acec37":"print(dftrain.groupby(['Sex', 'Pclass'])['Age'].agg(['mean', 'median']).round(1))","31f65c30":"print(dftrain.groupby(['Pclass'])['Age'].agg(['mean', 'median']).round(1))","739fb5a3":"print(dftest.groupby(['Pclass'])['Age'].agg(['mean', 'median']).round(1))","52a2b4dc":"#create a function to apply the median ages regardless of sex\ndef impute_age(cols):\n    Age=cols[0]\n    Pclass=cols[1]\n    \n    if pd.isnull(Age):\n        \n        if Pclass ==1:\n            return 37\n        elif Pclass ==2:\n              return 29\n        else:\n              return 24\n              \n    else:\n        return Age\n    \n    \ndef impute_age_test(cols):\n    Age=cols[0]\n    Pclass=cols[1]\n    \n    if pd.isnull(Age):\n        \n        if Pclass ==1:\n            return 42\n        elif Pclass ==2:\n              return 27\n        else:\n              return 24\n              \n    else:\n        return Age","62062c58":"dftrain['Age']=dftrain[['Age','Pclass']].apply(impute_age, axis=1)\ndftest['Age']=dftest[['Age','Pclass']].apply(impute_age_test, axis=1)","7d85e191":"plt.figure(figsize=(10,10))\nsns.heatmap(dftrain.isnull(), cmap=None, yticklabels=False, cbar = False)","cc932894":"plt.figure(figsize=(10,10))\nsns.heatmap(dftest.isnull(), cmap=None, yticklabels=False, cbar = False)","bbe1a50b":"dftrain.drop(['Name','Age','Ticket','Fare','Cabin'],inplace=True,axis=1)\ndftest.drop(['Name','Age','Ticket','Fare','Cabin'],inplace=True,axis=1)","7ec89660":"sex_train=pd.get_dummies(dftrain['Sex'],drop_first=True)\nsex_test=pd.get_dummies(dftest['Sex'],drop_first=True)\n#drops first column.  \n#make a dummy variable of this dataframe\n#This is what we want to input in our machine learning algorithim","b8b4d247":"#make a dummy variable since the column has categorical data - C, Q, S\nembark_train=pd.get_dummies(dftrain['Embarked'], drop_first=True) #drop C column so all columns are not predictors of each other\nembark_test=pd.get_dummies(dftest['Embarked'], drop_first=True)\n","2936536f":"print(embark_train.head())\nprint(embark_test.head())","aaedef5b":"#concatenate columns and add them to the df.\ndftrain=pd.concat([dftrain,sex_train,embark_train],axis=1)\n","7d99466b":"dftest=pd.concat([dftest,sex_test,embark_test],axis=1)","ba0e7d42":"dftest.head()","5767945f":"sex_mapping = {\"male\": 0, \"female\": 1}\ndftrain['Sex'] = dftrain['Sex'].map(sex_mapping)\ndftest['Sex'] = dftest['Sex'].map(sex_mapping)","cafc7e08":"dftest.head()","928b53ea":"dftrain.info()","ff2f8f74":"dftrain['Embarked']=dftrain['Embarked'].fillna('S')\n","86bc4352":"embarked_mapping = {\"S\": 1, \"C\": 2, \"Q\": 3}\ndftrain['Embarked'] = dftrain['Embarked'].map(embarked_mapping)\ndftest['Embarked'] = dftest['Embarked'].map(embarked_mapping)","8660a724":"dftrain.info()","aaf69394":"dftest.info()","7788f388":"from sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.metrics import confusion_matrix\nfrom sklearn.metrics import classification_report #tell precison, recall values, accuracy, F1 score. So it doesn't have to be read off of a confusion matrix.","3f0948e3":"X = dftrain.drop(['PassengerId', 'Survived'], axis=1)\ny = dftrain['Survived']\nX_train, X_test, y_train, y_test=train_test_split(X, y, test_size=0.30, random_state=101)","cf29221a":"lrmodel=LogisticRegression()\nlrmodel.fit(X_train, y_train)\npredictions = lrmodel.predict(X_test)\n\n","dacbd897":"acc_logreg = round(accuracy_score(predictions, y_test)*100, 2)\nacc_logreg","347af18b":"print(classification_report(y_test, predictions))","5bf233e2":"confusion_matrix(y_test,predictions)","205f0711":"logreg = dftest['PassengerId']\npredictions = lrmodel.predict(dftest.drop('PassengerId', axis=1))\n\n\n\n\n#set the output as a dataframe and convert to csv file named submission.csv\noutput = pd.DataFrame({ 'PassengerId' : logreg, 'Survived': predictions })\noutput.to_csv('submission.csv', index=False)\nprint(\"your submission was succesfull\")","b8f57c12":"output.head()","51b3463d":"We now need to convert categorical features into what is known as a dummy variable.\n\nOtherwise our machine learning algorithm won't be able to directly take in those features as inputs because they will be strings. So we have to create a new column where Sex for male or female is either a 0 or a 1.\n\nWe will have to do something similar to the Embarked column.","3759bfa6":"**FARE FEATURE**","23fc13a7":"# CREATING A DUMMY VARIABLE","2b2b3e23":"Older ages of the 1st class passangers vs 2nd and 3rd. Also higher degree of age range in the 1st class cabin. Will use these median age values to impute (fill in) the median age into the age column based off of the passenger class. This will fill in the missing age values.\n\nLet's take a closer look at the age column.","7bf07268":"More males perished (0) than females","7854b01a":"Passangers in 1st class had a higher rate of survival, 62.9%","6e106f0d":"convert_dict_train = {'Survived': int, \n                'Pclass': int,\n                'Age': float,\n                'SibSp': int,\n                'Parch': int,\n                'Fare': float,\n                'PassengerId': int,\n                'male'\n               } \n\nconvert_dict_test = {'Pclass': int, \n                'Fare': float,\n                'Age': float,\n                'SibSp': int,\n                'Parch': int,\n                'PassengerId': int,\n               } ","113fc1f9":"Females had a higher change of survival, 74.2%","2028c365":"Quite a few children <=10, Most population is between late teens and 40","2519c8c2":"**PCLASS FEATURE**","247475e1":"# DATA VISUALIZATION","e6b888b0":"# LOGISTIC REGRESSION\n* A classification algorithim where the response variable is categorical.\nExample:\n* Use a credit score and bank balance to predict whether a customer with default\n    Response varialble = Default or No Default\n* Use average rebounds per game and average ponts per game to predicts if a basketball player will get drafted to the NBA\n    Response variable = Drafted or Not Drafted\n* Based on square footage and number of bedrooms to predict if a house price will be over 200K\n    Response varialbe = Yes or No\n    \np(X) = e\u03b20 + \u03b21X1 + \u03b22X2 + \u2026 + \u03b2pXp \/ (1 + e\u03b20 + \u03b21X1 + \u03b22X2 + \u2026 + \u03b2pXp)\n\nUse of the probability threshold to classify the observation as either 1 or 0.\n\nFor example, we might say that observations with a probability greater than or equal to 0.5 will be classified as \u201c1\u201d and all other observations will be classified as \u201c0.\u201d\n\n![image.png](attachment:image.png)\n","7d48876d":"**SEX FEATURE**","e6b2fd50":"# THE MODEL","f7b5e23a":"Most fares are between 0-50. Makes sense as most passangers are in the 3rd class","c4d360e4":"# CLEANING OUR DATA","dea17088":"Passangers with 1 spouse or sibling were more likely to survive that those with 0 spouses or siblings (single traveling passangers) Passangers with more than 1 family member were also less likely to survive","a5663614":"**SIBSP FEATURE**","d06eaddd":"**AGE FEATURE**","133e9c69":"High rate of null values in the Cabin column as well as Age column.\nUse imputation to take the mean age values and fill them in with the missing age. We will check the average age by passanger class","56d014ef":"Most passangers did not have a sibling or spouse. 2nd column = passangers either had a sibling OR a spouse. "}}