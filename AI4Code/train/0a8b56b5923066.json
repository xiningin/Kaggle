{"cell_type":{"87e1a3e4":"code","ddf46849":"code","2061c069":"code","ff1b6b6e":"code","56cb787b":"code","4dd3fda7":"code","0f9bad62":"code","5e6653fa":"code","6d3c4a15":"code","aef15555":"code","b9f91b29":"code","529bd9c3":"code","660b02d1":"code","7bb11662":"code","d83be933":"code","b8ac85e9":"code","2f8a0fb9":"markdown","e121fb2d":"markdown","8b082978":"markdown","982cb76f":"markdown","57699931":"markdown","717e2769":"markdown","9b4c5121":"markdown"},"source":{"87e1a3e4":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport warnings  \nwarnings.filterwarnings('ignore')\n","ddf46849":"data = pd.read_csv(\"..\/input\/heart-attack-analysis-prediction-dataset\/heart.csv\")","2061c069":"data.columns","ff1b6b6e":"data.head()\n","56cb787b":"fig, ax = plt.subplots(figsize=(10,8))\nsns.heatmap(data.corr(),annot=True,cmap=\"Oranges\",ax=ax)","4dd3fda7":"sns.countplot(data[\"output\"])","0f9bad62":"sns.countplot(data[\"sex\"])","5e6653fa":"fig, ax = plt.subplots(figsize=(10,8))\ndata.boxplot(ax=ax)","6d3c4a15":"from sklearn.preprocessing import StandardScaler\nfrom sklearn.ensemble import AdaBoostClassifier\nfrom sklearn.ensemble import  BaggingClassifier\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.model_selection import cross_val_score","aef15555":"var_col = [\"age\",\"trtbps\",\"chol\",\"thalachh\",\"oldpeak\"]\ndata1 = pd.get_dummies(data,columns=['sex',\"cp\",\"fbs\",\"restecg\",\"exng\",\"slp\",\"thall\"],drop_first=True )\n\nscale = StandardScaler()\ndata1[var_col] = scale.fit_transform(data1[var_col])\nX = data1.drop(\"output\",axis = 1)\ny = data1[[\"output\"]]\nX.head()","b9f91b29":"X_train,X_test,y_train,y_test = train_test_split(X,y,test_size = 0.2,random_state=1001)","529bd9c3":"params_ada = {'base_estimator__max_depth':[i for i in range(2,11,2)],\n              'base_estimator__min_samples_leaf':[5,10],\n              'n_estimators':[10,50,250,1000],\n              'learning_rate':[0.01,0.1]}\nada= AdaBoostClassifier(base_estimator=DecisionTreeClassifier())\nadaGSCV = GridSearchCV(ada, param_grid=params_ada,verbose=3,scoring='f1',n_jobs=-1)\nbagc = BaggingClassifier(base_estimator=DecisionTreeClassifier())\n\nparams_bagc = {'base_estimator__max_depth':[i for i in range(2,11,2)],\n              'base_estimator__min_samples_leaf':[5,10],\n              'n_estimators':[10,50,250,1000]}\nbagcGSCV=  GridSearchCV(bagc, param_grid=params_bagc,verbose=3,scoring='f1',n_jobs=-1)            \nmodel_list1 = [(\"ada\",adaGSCV),(\"bagging\",bagcGSCV)]","660b02d1":"for modelname, model in model_list1:\n  model.fit(X_train,y_train)\n  model.predict(X_test)\n  best_para = model.best_params_\n  score_m = model.score(X_test,y_test)\n  print(modelname, \":\", score_m)\n  print(modelname, \":\", best_para)","7bb11662":"from xgboost import XGBClassifier\nfrom sklearn.model_selection import *\nxgb_model = XGBClassifier()\nparameters_xgb = {'objective':['binary:logistic',\"binary:hinge\",],\n                  'learning_rate': [0.01,0.1], #so called `eta` value\n                  'max_depth': [i for i in range(2,11,2)],\n                  'n_estimators': [510,50,250,1000]}\nclf = GridSearchCV(xgb_model, parameters_xgb, n_jobs=5,\n                   scoring='roc_auc',\n                   verbose=3, refit=True)\nclf.fit(X_train,y_train)\nprint(clf.score(X_test,y_test))\nprint(clf.best_params_)","d83be933":"from sklearn.metrics import confusion_matrix\nprediction_XGB = clf.predict(X_test)\nconfusion_matrix_XGB = confusion_matrix(y_test,prediction_XGB) \nsns.heatmap(confusion_matrix_XGB,annot=True)","b8ac85e9":"from sklearn.metrics import classification_report\nprint(classification_report(y_test, clf.predict(X_test)))","2f8a0fb9":"I decided to use XGBClassifier after this ","e121fb2d":"**Basic EDA**","8b082978":"**Model**","982cb76f":"From this We know that number of men is more than number of female","57699931":"Using XGBClassifier really helped.","717e2769":"The data is well balanced","9b4c5121":"There are some outliers but i have decided to keep them cause logically i think they are the reason behind the heart attck."}}