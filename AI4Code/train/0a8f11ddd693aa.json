{"cell_type":{"9d31ad54":"code","f5c9a188":"code","69fd4ceb":"code","a19d18a4":"code","3af7bf6f":"code","9389c74d":"code","820a9531":"code","8dec8e08":"code","09d64953":"code","788b8f8a":"code","d8b2bc67":"code","32b0e9b4":"code","c7b41c41":"code","a4ca007e":"code","0644abe9":"code","04aaa165":"code","331e825a":"code","69425c5a":"code","a376cc3a":"code","37bbc3ff":"markdown","df729aa8":"markdown","0fbb7296":"markdown","92eef6cc":"markdown","d1f3cb64":"markdown","c1ab483c":"markdown","f4ca183d":"markdown","2ec08a33":"markdown","cfa57e84":"markdown","4f573895":"markdown","84d8f986":"markdown","cd0c21b6":"markdown"},"source":{"9d31ad54":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport statsmodels.api as sm\nimport graphviz\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.tree import DecisionTreeRegressor, export_graphviz\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.externals.six import StringIO  \nfrom IPython.display import Image  ","f5c9a188":"df = pd.read_csv('..\/input\/covid19-demographic-predictors\/covid19.csv')","69fd4ceb":"X = df[df.columns[2:]]\ny = df['Total Infected']\ndf[df.columns[1:]].corr()['Total Infected'][:]","a19d18a4":"plt.scatter(df['GDP 2018'], df['Population 2020'])\nplt.xlabel('GDP')\nplt.ylabel('Population')\nplt.title('GDP vs Population')\nplt.show()","3af7bf6f":"df[(df['GDP 2018'] > 1e13) | (df['Population 2020'] > 400000)]","9389c74d":"X_s = StandardScaler().fit_transform(X)","820a9531":"est = sm.OLS(y, X_s)\nest2 = est.fit()\nprint(est2.summary(xname=[*X.columns]))\n# small pval, reject the null hypothesis that a feature has no effect","8dec8e08":"rfr = RandomForestRegressor(max_depth=3)\nrfr.fit(X_s, y)\nprint('score', rfr.score(X_s, y), '\\n')\n[print(c + '\\t', f) for c,f in zip(df[df.columns[2:]], rfr.feature_importances_)]","09d64953":"tree = DecisionTreeRegressor(max_depth=3)\ntree.fit(X_s, y)\nprint('score', tree.score(X_s, y), '\\n')\nprint('Feature Importances')\n[print(c + '\\t', f) for c,f in zip(df[df.columns[2:]], tree.feature_importances_)]","788b8f8a":"data = export_graphviz(tree, out_file=None,  \n                filled=True, rounded=True,\n                special_characters=True, feature_names=df.columns[2:])\ngraph = graphviz.Source(data)\ngraph","d8b2bc67":"df_small = df[(df['Country'] != 'United States') & (df['Country'] != 'India') & (df['Country'] != 'China')]\nX = df_small[df.columns[2:]]\ny = df_small['Total Infected']","32b0e9b4":"df_small.sort_values(by='Population 2020', ascending=False).head(5)","c7b41c41":"X = df_small[df_small.columns[2:]]\ny = df_small['Total Infected']\ndf_small[df_small.columns[1:]].corr()['Total Infected'][:]","a4ca007e":"plt.scatter(df_small['GDP 2018'], df_small['Population 2020'])\nplt.xlabel('GDP')\nplt.ylabel('Population')\nplt.title('GDP vs Population')\nplt.show()","0644abe9":"X_s = StandardScaler().fit_transform(X)","04aaa165":"est = sm.OLS(y, X_s)\nest2 = est.fit()\nprint(est2.summary(xname=[*X.columns]))\n# small pval, reject the null hypothesis that a feature has no effect","331e825a":"rfr = RandomForestRegressor(max_depth=3)\nrfr.fit(X_s, y)\nprint('score', rfr.score(X_s, y), '\\n')\n[print(c + '\\t', f) for c,f in zip(df_small[df_small.columns[2:]], rfr.feature_importances_)]","69425c5a":"tree = DecisionTreeRegressor(max_depth=3)\ntree.fit(X_s, y)\nprint('score', tree.score(X_s, y), '\\n')\nprint('Feature Importances')\n[print(c + '\\t', f) for c,f in zip(df_small[df_small.columns[2:]], tree.feature_importances_)]","a376cc3a":"data = export_graphviz(tree, out_file=None,  \n                filled=True, rounded=True,\n                special_characters=True, feature_names=df.columns[2:])\ngraph = graphviz.Source(data)\ngraph","37bbc3ff":"### Random Forest and single Decision Tree","df729aa8":"In this analysis, population was the single biggest predictor of COVID-19 infections. This makes sense given the huge outliers shown in the scatter plot above.  Next, remove those outliers and rerun the experiment","0fbb7296":"Final analysis shows that GDP, mean age and smoking are the best predictors of COVID-19 infections. While mean age and smoking make sense, it is not known why there are more infections in countries with higher GDP.","92eef6cc":"GDP and Population are NOT correlated","d1f3cb64":"China, India and US are outliers in the above dataset","c1ab483c":"### Scale the data and perform a linear regression","f4ca183d":"## Remove outliers (China, United States, India) and rerun analysis","2ec08a33":"The scatter plot shows the following 3 outliers","cfa57e84":"Show countries with highest populations now that outliers have been removed\n","4f573895":"### Random Forest and single Decision Tree","84d8f986":"### Regression Analysis","cd0c21b6":"The adjusted R-squared value is quite low; this shows that the model doesn't explain the variation in the dependent variable"}}