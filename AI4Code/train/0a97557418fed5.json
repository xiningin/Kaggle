{"cell_type":{"c18ca3d1":"code","573104a3":"code","176782b3":"code","46a3055d":"code","63231756":"code","a3b702a6":"code","4d05a05b":"code","0d6a4d4a":"code","9e3da151":"code","c1a24fe5":"code","12bd27dd":"code","c2995921":"code","0accc118":"code","cf31bb57":"code","4f5758cf":"code","2eed3423":"code","364b2748":"code","2cdd1fb5":"code","1ec02f2b":"code","b0c8ffa5":"code","a238263f":"code","f61abfe9":"code","1b01fa24":"code","1d4f0d1c":"code","72ffb249":"code","55d5043d":"code","87123ad6":"code","088c8efa":"code","09d10dd6":"code","af1c872c":"code","a04c0753":"code","fa7266eb":"code","fac3967f":"code","70320bde":"code","07084569":"code","e6f03fad":"code","4e766341":"code","f8f7935e":"code","d70c0671":"code","b40819ea":"markdown","e288d387":"markdown","ff8eaa07":"markdown","439b3eb3":"markdown","946de417":"markdown","fa0886ef":"markdown","76e85062":"markdown","88eacf06":"markdown","2f13e467":"markdown","55cf8cb1":"markdown","687a7a39":"markdown","da8b4a76":"markdown","0ee8391f":"markdown","1c187a1a":"markdown","3807c4bd":"markdown","eaa6c01f":"markdown","d6fc1db0":"markdown","3a70b46c":"markdown","d0cf1ea7":"markdown","7ef15be1":"markdown","aed2f6fa":"markdown","f986c62c":"markdown","2812efb1":"markdown","a632ccc8":"markdown","6129af96":"markdown","c1dd6c8a":"markdown","022fe36d":"markdown","720a3a52":"markdown","311f0f5e":"markdown","d9fcfb5a":"markdown"},"source":{"c18ca3d1":"import os\nimport pandas as pd\nfrom tqdm import tqdm\npd.set_option('display.max_rows',100)\ntqdm.pandas()\nimport plotly.express as px","573104a3":"base_dir = '\/kaggle\/input\/2021-olympics-in-tokyo\/'\n\nos.listdir(base_dir)","176782b3":"!pip install openpyxl","46a3055d":"medals = pd.read_excel(base_dir + 'Medals.xlsx')\nentry_gender = pd.read_excel(base_dir + 'EntriesGender.xlsx')\nathletes = pd.read_excel(base_dir + 'Athletes.xlsx')\nteams = pd.read_excel(base_dir + 'Teams.xlsx')\ncoaches = pd.read_excel(base_dir + 'Coaches.xlsx')","63231756":"# Let's take sample of dataframe.\nmedals.sample(5)\n","a3b702a6":"# Participation of 93 Countries in Olympics, almost 40% of countries present in the world \nmedals.shape","4d05a05b":"!pip install pycountry-convert","0d6a4d4a":"#function to convert to alpah2 country codes and continents\nfrom pycountry_convert import country_alpha2_to_continent_code, country_name_to_country_alpha2\n\ndef function_to_covert_country_alpha(Country_name):\n    try:\n        country_code = country_name_to_country_alpha2(Country_name)\n    except:\n        country_code = 'Not_Found'\n\n    try:\n        continent = country_alpha2_to_continent_code(country_code)\n    except:\n        continent = 'Not_Found'\n    return (country_code, continent)","9e3da151":"medals[['Country_Code', 'Continent']] = medals.progress_apply(lambda x : function_to_covert_country_alpha(x['Team\/NOC']), axis = 1, result_type = 'expand'  )","c1a24fe5":"medals[medals['Country_Code']=='Not_Found']","12bd27dd":"medals['Team\/NOC'] = medals['Team\/NOC'].replace({'ROC': 'Russia', 'Republic of Korea': 'South Korea',  'Chinese Taipei': 'Taiwan',\n                            'Kosovo':'Republic of Kosovo', 'Hong Kong, China':'Hong Kong'})","c2995921":"medals[['Country_Code', 'Continent']] = medals.progress_apply(lambda x : function_to_covert_country_alpha(x['Team\/NOC']), axis = 1, result_type = 'expand'  )\n\nmedals[medals['Country_Code']=='Not_Found']\n","0accc118":"medals['Country_Code'] = medals['Country_Code'].replace({'Not_Found':'XK'})\nmedals['Continent'] =medals['Continent'].replace({'Not_Found':'EU'})","cf31bb57":"!pip install geopy","4f5758cf":"from geopy.geocoders import Nominatim\nimport geopy\nimport numpy as np\nimport time\ngeolocator = Nominatim(user_agent=\"your_email@gmail.com\")    # Please put your Email here\n\ndef geolocate(country):\n    try:\n        \n        loc = geolocator.geocode(country)\n        # return latitude and longitude\n        return (loc.latitude, loc.longitude)\n    except:\n        # Return missing value\n        try :\n          time.sleep(2)\n          loc = geolocator.geocode(country)\n          return (loc.latitude, loc.longitude)\n        except:\n\n          return np.nan\n\nmedals[['Latitude','Longitude']] = medals.progress_apply(lambda x : geolocate(x['Team\/NOC']), axis = 1, result_type='expand')\n","2eed3423":"from branca.element import Figure\nimport folium","364b2748":"# Creating Basemap\nfig3=Figure(width=800,height=550)\nm3=folium.Map(tiles='cartodbpositron',zoom_start=11)\nfig3.add_child(m3)\n\n#Adding markers to the map\nfor i in range(len(medals))[:20]:\n  val = medals.iloc[i]\n  if i <10 :\n    folium.Marker(location=[val['Latitude'], val['Longitude']],\n                popup=f'Total medals {val[\"Total\"]}',tooltip=f'{val[\"Team\/NOC\"]}', \n                icon=folium.Icon(color='black',icon_color='#FFFF00')).add_to(m3)\n  else:\n     folium.Marker(location=[val['Latitude'], val['Longitude']],\n                popup=f'Total medals {val[\"Total\"]}',tooltip=f'{val[\"Team\/NOC\"]}'\n                ).add_to(m3)\nm3","2cdd1fb5":"!pip install countryinfo","1ec02f2b":"medals[medals['Team\/NOC']=='India']","b0c8ffa5":"from countryinfo import CountryInfo\n\ndef get_population(country):\n  try:\n    country = CountryInfo(country)\n    return country.info()['population']\n  except:\n    return 'Not Found'\n\nmedals['Population']  = medals.apply(lambda x: get_population(x[\"Team\/NOC\"]), axis = 1)","a238263f":"x = medals[medals['Population']!= 'Not Found']\nx['Medal\/Populatin_ratio']  = x['Total']\/x['Population']","f61abfe9":"x.sort_values(by = ['Medal\/Populatin_ratio'], ascending=False).head(10).reset_index(drop=True)","1b01fa24":"top_25_country = medals.sort_values(by = ['Total'], ascending=False).head(25)\nfig = px.bar(top_25_country, x='Team\/NOC', y = 'Total', text='Gold', \n             title=\"Value on bar represent number of Gold and value of bar is Total medals\")\nfig.update_traces(texttemplate='%{text:.2s} gold', textposition='outside')\nfig.show()","1d4f0d1c":"top_20_country = medals.sort_values(by = ['Total'], ascending=False).head(20)\nfig = px.bar(top_20_country, x='Team\/NOC', y = 'Total', text='Silver', \n             title=\"Value on bar represent number of Silver and value of bar is Total medals\")\nfig.update_traces(texttemplate='%{text:.2s} Silver', textposition='outside')\nfig.show()","72ffb249":"top_20_country = medals.sort_values(by = ['Total'], ascending=False).head(20)\nfig = px.bar(top_20_country, x='Team\/NOC', y = 'Total', text='Bronze', \n             title=\"Value on bar represent number of Bronze and value of bar is Total medals\")\nfig.update_traces(texttemplate='%{text:.2s} Bronze', textposition='outside')\nfig.show()","55d5043d":"import plotly.graph_objects as go\nData=list(top_20_country['Team\/NOC'])\n\nfig = go.Figure(data=[\n    go.Bar(name='Gold', x=Data, y=list(top_20_country['Gold'])),\n    go.Bar(name='Silver', x=Data, y=list(top_20_country['Silver'])),\n    go.Bar(name='Bronze', x=Data, y=list(top_20_country['Bronze']))\n])\n# Change the bar mode\nfig.update_layout(barmode='stack', title = \"Winning of Gold, Silver, Bronze medal in one Graph w.r.t. Countries \")\nfig.show()","87123ad6":"# Most popular top 15 Games Overall\ntop_overall = entry_gender.sort_values(by = ['Total'],ascending=False).head(20)\nfig = px.bar(top_overall,x = 'Discipline', y='Total', text = 'Total' )\nfig.update_traces( textposition='outside')\nfig.update_layout(title =  \"Overall Most popular top 15 Games\")\nfig.show()","088c8efa":"import plotly.graph_objects as go\nfig = go.Figure()\ntop_overall = entry_gender.sort_values(by = ['Total'],ascending=False).head(20)\nfig.add_trace(go.Bar(x = top_overall['Discipline'].to_numpy(), y = top_overall['Total'].to_numpy(), name = 'Male',\n                     text=top_overall['Male'].to_numpy(),\n                     marker_color='indianred'))\n\nfig.add_trace(go.Bar(x = top_overall['Discipline'].to_numpy(), y = top_overall['Total'].to_numpy(), name = 'Female',\n                     text=top_overall['Female'].to_numpy(),\n                      marker_color='lightsalmon'))\n\nfig.update_layout(barmode='group', xaxis_tickangle=-45, title = \"Male Female and Games\")\nfig.update_traces( textposition='outside')\nfig.show()","09d10dd6":"athlets_in_each_country = athletes.groupby(by = ['NOC']).count().reset_index().sort_values(by=['Discipline'], ascending=False).head(20)","af1c872c":"fig = px.bar(athlets_in_each_country, x = 'NOC', y='Discipline', color ='Discipline',\n             text = 'Discipline')\nfig.update_traces( textposition='outside')\nfig.update_layout(title = 'Participants in Each country')\nfig.show()","a04c0753":"athletes['Counts'] = np.zeros(len(athletes))","fa7266eb":"grouped = athletes.groupby(by = ['NOC','Discipline']).count()","fac3967f":"grouped.groupby(level=0, group_keys=False).apply(lambda x : x.sort_values('Counts', ascending=False).head(1)).reset_index()","70320bde":"Discipline_with_most_athlets = athletes.groupby(['Discipline']).count().sort_values('Counts', ascending=False).reset_index().head(20)\nfig = px.bar(Discipline_with_most_athlets, x = 'Discipline', y='Counts', color ='Counts',\n             text = 'Discipline')\nfig.update_traces( textposition='outside')\nfig.update_layout(title = 'Sports with most participant')\nfig.show()","07084569":"popular_team_game = teams.groupby(['Discipline']).count().reset_index().sort_values('Name', ascending=False)","e6f03fad":"fig = px.bar(popular_team_game, x = 'Discipline', y='Name', color ='Event')\nfig.update_traces( textposition='outside')\nfig.update_layout(title = 'Popular team game in Olympic')\nfig.show()","4e766341":"teams.groupby(['Discipline', 'Event']).count()","f8f7935e":"coaches[coaches['NOC'].isin(medals.head(10)['Team\/NOC'].to_numpy())]","d70c0671":"# If you like the notebook Please like the Notebook, This will make me Happy :)\n# If you find any Improvement in this Notebook, Please comment....\n# Thanks you :)","b40819ea":"Let's find one with Unknown country, and continent, So that we will change them manually and have clean data in hand.  \nOkay, Cool... as we see from table below we have 4 countries with unknown Country code.","e288d387":"#### Which discipline is more popular in the olympics?","ff8eaa07":"But, From the list below we can't get good idea about how government, is helping athlets, Base on this ratio we calculated  \nI am little upset that India is on the last position","439b3eb3":"#### 1) Let's see, Qualifying athlets for each country.","946de417":"Cool It seems,  Equal chances given to both Men and Women","fa0886ef":"## 1) Importing Liabrary  \n<a class = \"anchor\" id=\"section_1\"><\/a>","76e85062":"### c) Athletes  \n<a class = \"anchor\" id=\"section_3_3\"><\/a>\nQuestions:  \n1) Let's see, Qualifying athlets for each country.  \n2) Most Popular Discipline in each country.  \n3) Which Discipline has most athlets.  \n\n","88eacf06":"#### 1) How many teams Participated?  \nWe will try to plot on world map, to understand which continent participate and corresponding contries.  \n","2f13e467":"Ohh man, There was timeout for some countries , So i add try except two times with sleep for a second","55cf8cb1":"Let's replace those values with known country code and continent code  \n<pre>\nROC               - I found russia is playing with this new name.  \nRepublic of korea - It is south korea.  \nChinese Taipei    - This is Taiwan.  \nKosovo            - This is Republic of Kosovo, (Declared Independence from Serbia in 2008).  \nHong Kong, China  - Hong Kong \n<\/pre>\n\nWe will replace this name from the column Team\/NOC  ","687a7a39":"<pre>\nOhhhhh, We don't have this country in our liabrary \nOptions we have - a) Delete this country(Not good option at all)  \n                - b) Merge this country into another one  (Not good)\n                - c) Okay, we will take a minute and change continent and country code manually.\n<\/pre>","da8b4a76":"#### Participation of Men Woman in team game..","0ee8391f":"<a class = \"anchor\" id = \"section_3_1\"><\/a>  \n### a) Medals  \n\nQuestions:  \n1) How many teams participated ?  \n2) Plot the participated countries on world map...  \n-  I will add necesery information in pop up. like(medals)  \n\n3) Medal's earned with reference to Population.  \n4) Bar plot Country Vs medals  \n5) Hard Luck for countries who got most silver.\n\n","1c187a1a":"We found some countries with unknown population so we will skip that countries","3807c4bd":"<a class = \"anchor\" id = 'section_3_2'><\/a>\n### b) entry_gender  \nQuestions:  \n1) Most popular game among man, woman, overall.  ","eaa6c01f":"## 3) Explore Data  \n<a class = \"anchor\" id=\"section_3\"><\/a>","d6fc1db0":"#### 5) Hard Luck for countries who got most silver ans Bronze.  \n\nOhh ohh, We got the same trend what we see in the previous figure","3a70b46c":"### d) Teams  \n<a class = \"anchor\" id=\"section_3_4\"><\/a>\nQuestions:  \n1. Which discipline is more popular in the olympics?  \n2. Participation of Men Woman in team game..","d0cf1ea7":"#### 2) Plot the countries participated on world map","7ef15be1":"Here will get DatFrame in which we can see in each country which Discipline is more popular","aed2f6fa":"#### 2) Most Popular Discipline in each country.","f986c62c":"## 2) Read Data  \n<a class = \"anchor\" id = 'section_2'><\/a>","2812efb1":"#### 3) Medal's earned with reference to Population.  \nFrom this we can comment that which government is putting lot of errorts to train athlets. If ratio of medals to population is high enough  \nIt's really worth to see country list  ","a632ccc8":"We will add co-ordinates of country to our dataframe","6129af96":"#### 4) Bar plot Country Vs medals  \n\nFrom this plot, There is tough competition between USA and China, USA","c1dd6c8a":"Okay, Finally, we are ready to plot the locations along with some information.  We will plot top 10 countries with reference to Total medals earned with black color and then 10 countries with blue color","022fe36d":"Okay, Great we replaced name of country ,So let's execute our function that will convert country name to country code again  ","720a3a52":"## Table of Content  \n* 1. [Importing Liabraries](#section_1)  \n* 2. [Read Data](#section_2)  \n* 3. [Explore all Data We have](#section_3)  \n  * 3.1 [Medals](#section_3_1)  \n      * 1) How many teams participated ?  \n      * 2) Plot the participated countries on world map...  \n      * 3) Medal's earned with reference to Population.  \n      * 4) Bar plot Country Vs medals  \n      * 5) Hard Luck for countries who got most silver.\n  * 3.2 [EntriesGender](#section_3_2)  \n      * 1) Most popular game among man, woman, overall.  \n  * 3.3 [Athlets](#section_3_3)  \n      * 1) Let's see, Qualifying athlets for each country.  \n      * 2) Most Popular Discipline in each country.  \n      * 3) Which Discipline has most athlets.  \n  * 3.4 [Teams](#section_3_4)  \n      * 1) Which discipline is more popular in the olympics?  \n      * 2) Participation of Men Woman in team game..\n  * 3.5 [Coaches](#section_3_5)  \n      * Let's appreciate the coaches of of top 5 teams","311f0f5e":"### e) Coaches  \n<a class = \"anchor\" id=\"section_3_5\"><\/a>\nLet's appreciate the coaches of of top 5 teams","d9fcfb5a":"#### 3) Which Discipline has most athlets"}}