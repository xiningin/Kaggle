{"cell_type":{"f792ef11":"code","df679b49":"code","e8e15f99":"code","1d5cd2ba":"code","2831592c":"code","f283348b":"code","0ec6bff8":"code","07c60155":"code","2c491c77":"code","63a92c6e":"code","d65500e1":"code","8acdd17e":"code","604cf32f":"code","4e624739":"code","30dac5bd":"code","7f9ab2a6":"code","2834ff6a":"code","78347498":"code","be403eda":"code","8be6d8fd":"code","97f0a4bb":"code","0972fb9c":"code","72c90d8e":"code","c0a65db1":"code","197a10db":"code","be4ce4bb":"code","2a434ff4":"code","2c6a435a":"code","6ed053b9":"code","52dd0b59":"code","ce8c0725":"code","0c43d32b":"code","16bf4c57":"code","a0bb439d":"code","3da87328":"code","4871d965":"code","8628826c":"code","8704513d":"code","4eb97b9b":"code","798383f1":"code","921fbfde":"code","26879594":"code","6b8d56ca":"code","fa6b9bd0":"code","7262bdfa":"code","64faa0d8":"code","6e785f11":"code","35556ab1":"code","848eb198":"code","1f379a65":"code","8b88dcbe":"code","36085bba":"code","bc8b6b8a":"code","a623da69":"code","c82b965a":"code","3fb70536":"code","6a8d758d":"code","61d3fef7":"markdown","9074cfad":"markdown"},"source":{"f792ef11":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline","df679b49":"insta_train=pd.read_csv(r\"..\/input\/instagram-fake-spammer-genuine-accounts\/train.csv\")\ninsta_test=pd.read_csv(r\"..\/input\/instagram-fake-spammer-genuine-accounts\/test.csv\")\n","e8e15f99":"insta_train.head()","1d5cd2ba":"insta_train.describe()","2831592c":"insta_train.info()","f283348b":"print(insta_train.shape)\nprint(insta_test.shape)","0ec6bff8":"print(insta_train.isna().values.any().sum())\nprint(insta_test.isna().values.any().sum())","07c60155":"corr=insta_train.corr()\nsns.heatmap(corr)\n","2c491c77":"sns.pairplot(insta_train)","63a92c6e":"train_Y=insta_train.fake\ntrain_Y=pd.DataFrame(train_Y)\ntrain_Y.tail(12)","d65500e1":"train_X= insta_train.drop(columns='fake')\ntrain_X.head()","8acdd17e":"test_Y=insta_test.fake\ntest_Y=pd.DataFrame(test_Y)\ntest_Y.tail(12)","604cf32f":"test_X= insta_test.drop(columns='fake')\ntest_X.head()","4e624739":"from sklearn.linear_model import LogisticRegression\nfrom sklearn.metrics import accuracy_score,confusion_matrix,classification_report","30dac5bd":"logreg=LogisticRegression()\nmodel_1=logreg.fit(train_X,train_Y)\nlogreg_predict= model_1.predict(test_X)","7f9ab2a6":"accuracy_score(logreg_predict,test_Y)","2834ff6a":"print(classification_report(logreg_predict,test_Y))","78347498":"def plot_confusion_matrix(test_Y, predict_y):\n C = confusion_matrix(test_Y, predict_y)\n A =(((C.T)\/(C.sum(axis=1))).T)\n B =(C\/C.sum(axis=0))\n plt.figure(figsize=(20,4))\n labels = [1,2]\n cmap=sns.light_palette(\"blue\")\n plt.subplot(1, 3, 1)\n sns.heatmap(C, annot=True, cmap=cmap, fmt=\".3f\", xticklabels=labels, yticklabels=labels)\n plt.xlabel('Predicted Class')\n plt.ylabel('Original Class')\n plt.title(\"Confusion matrix\")\n plt.subplot(1, 3, 2)\n sns.heatmap(B, annot=True, cmap=cmap, fmt=\".3f\", xticklabels=labels, yticklabels=labels)\n plt.xlabel('Predicted Class')\n plt.ylabel('Original Class')\n plt.title(\"Precision matrix\")\n plt.subplot(1, 3, 3)\n sns.heatmap(A, annot=True, cmap=cmap, fmt=\".3f\", xticklabels=labels, yticklabels=labels)\n plt.xlabel('Predicted Class')\n plt.ylabel('Original Class')\n plt.title(\"Recall matrix\")\n plt.show()","be403eda":"plot_confusion_matrix(test_Y, logreg_predict)","8be6d8fd":"from sklearn.neighbors import KNeighborsClassifier\nknn=KNeighborsClassifier(n_neighbors=3)\nmodel_2= knn.fit(train_X,train_Y)\nknn_predict=model_2.predict(test_X)","97f0a4bb":"accuracy_score(knn_predict,test_Y)\n","0972fb9c":"print(classification_report(test_Y,knn_predict))","72c90d8e":"plot_confusion_matrix(test_Y, knn_predict)","c0a65db1":"from sklearn.tree import DecisionTreeClassifier\ndtree=DecisionTreeClassifier()\nmodel_3=dtree.fit(train_X,train_Y)\ndtree_predict=model_3.predict(test_X)","197a10db":"accuracy_score(dtree_predict,test_Y)\n","be4ce4bb":"print(classification_report(dtree_predict,test_Y))","2a434ff4":"plot_confusion_matrix(test_Y, dtree_predict)","2c6a435a":"from sklearn.ensemble import RandomForestClassifier\nrfc=RandomForestClassifier()\nmodel_4=rfc.fit(train_X,train_Y)\nrfc_predict=model_4.predict(test_X)","6ed053b9":"accuracy_score(rfc_predict,test_Y)","52dd0b59":"print(classification_report(rfc_predict,test_Y))","ce8c0725":"plot_confusion_matrix(test_Y, rfc_predict)","0c43d32b":"from sklearn.svm import SVC\nsvc=SVC()\nmodel_5=svc.fit(train_X,train_Y)\nsvm_predict=model_5.predict(test_X)","16bf4c57":"accuracy_score(svm_predict,test_Y)","a0bb439d":"print(classification_report(svm_predict,test_Y))","3da87328":"plot_confusion_matrix(test_Y,svm_predict)","4871d965":"from sklearn.ensemble import AdaBoostClassifier\nadc=AdaBoostClassifier(n_estimators=5,learning_rate=1)\nmodel_6=adc.fit(train_X,train_Y)\nadc_predict=model_6.predict(test_X)","8628826c":"accuracy_score(adc_predict,test_Y)","8704513d":"print(classification_report(adc_predict,test_Y))","4eb97b9b":"plot_confusion_matrix(test_Y,adc_predict)","798383f1":"from xgboost import XGBClassifier\nxgb=XGBClassifier()\nmodel_7=xgb.fit(train_X,train_Y)\nxgb_predict=model_7.predict(test_X)","921fbfde":"accuracy_score(xgb_predict,test_Y)","26879594":"print(classification_report(xgb_predict,test_Y))","6b8d56ca":"plot_confusion_matrix(test_Y, xgb_predict)","fa6b9bd0":"from sklearn.model_selection import GridSearchCV, cross_val_score, StratifiedKFold, learning_curve","7262bdfa":"### META MODELING  WITH ADABOOST, RF, EXTRATREES and GRADIENTBOOSTING\nkfold = StratifiedKFold(n_splits=10)\n# Adaboost\nDTC = DecisionTreeClassifier()\n\nadaDTC = AdaBoostClassifier(DTC, random_state=7)\n\nada_param_grid = {\"base_estimator__criterion\" : [\"gini\", \"entropy\"],\n              \"base_estimator__splitter\" :   [\"best\", \"random\"],\n              \"algorithm\" : [\"SAMME\",\"SAMME.R\"],\n              \"n_estimators\" :[1,2],\n              \"learning_rate\":  [0.0001, 0.001, 0.01, 0.1, 0.2, 0.3,1.5]}\n\ngsadaDTC = GridSearchCV(adaDTC,param_grid = ada_param_grid,scoring=\"accuracy\", verbose = 1,cv=kfold)\n\ngsadaDTC.fit(train_X,train_Y)\n\n","64faa0d8":"gsadaDTC_model=gsadaDTC.predict(test_X)\naccuracy_score(gsadaDTC_model,test_Y)","6e785f11":"from sklearn.ensemble import RandomForestClassifier, AdaBoostClassifier, GradientBoostingClassifier, ExtraTreesClassifier, VotingClassifier","35556ab1":"ExtC = ExtraTreesClassifier()\n\n\n## Search grid for optimal parameters\nex_param_grid = {\"max_depth\": [None],\n              \"max_features\": [1, 3, 10],\n              \"min_samples_split\": [2, 3, 10],\n              \"min_samples_leaf\": [1, 3, 10],\n              \"bootstrap\": [False],\n              \"n_estimators\" :[100,300],\n              \"criterion\": [\"gini\"]}\n\n\ngsExtC = GridSearchCV(ExtC,param_grid = ex_param_grid,scoring=\"accuracy\", n_jobs= 4, verbose = 1)\n\ngsExtC.fit(train_X,train_Y)\n\nExtC_best = gsExtC.best_estimator_\n\n# Best score\ngsExtC.best_score_","848eb198":"gsExtC_model=gsExtC.predict(test_X)\naccuracy_score(gsExtC_model,test_Y)","1f379a65":"RFC = RandomForestClassifier()\n\n\n## Search grid for optimal parameters\nrf_param_grid = {\"max_depth\": [None],\n              \"max_features\": [1, 3, 10],\n              \"min_samples_split\": [2, 3, 10],\n              \"min_samples_leaf\": [1, 3, 10],\n              \"bootstrap\": [False],\n              \"n_estimators\" :[100,300],\n              \"criterion\": [\"gini\"]}\n\n\ngsRFC = GridSearchCV(RFC,param_grid = rf_param_grid, cv=kfold, scoring=\"accuracy\", n_jobs= 4, verbose = 1)\n\ngsRFC.fit(train_X,train_Y)\n","8b88dcbe":"gsRFC_model=gsRFC.predict(test_X)\naccuracy_score(gsRFC_model,test_Y)","36085bba":"GBC = GradientBoostingClassifier()\ngb_param_grid = {'loss' : [\"deviance\"],\n              'n_estimators' : [100,200,300],\n              'learning_rate': [0.1, 0.05, 0.01],\n              'max_depth': [4, 8],\n              'min_samples_leaf': [100,150],\n              'max_features': [0.3, 0.1] \n              }\n\ngsGBC = GridSearchCV(GBC,param_grid = gb_param_grid, cv=kfold, scoring=\"accuracy\", n_jobs= 4, verbose = 1)\n\ngsGBC.fit(train_X,train_Y)\n","bc8b6b8a":"gsGBC_model=gsGBC.predict(test_X)\naccuracy_score(gsGBC_model,test_Y)","a623da69":"SVMC = SVC(probability=True)\nsvc_param_grid = {'kernel': ['rbf'], \n                  'gamma': [ 0.001, 0.01, 0.1, 1],\n                  'C': [1, 10, 50, 100,200,300, 1000]}\n\ngsSVMC = GridSearchCV(SVMC,param_grid = svc_param_grid, cv=kfold, scoring=\"accuracy\", n_jobs= 4, verbose = 1)\n\ngsSVMC.fit(train_X,train_Y)\n","c82b965a":"gsSVMC_model=gsSVMC.predict(test_X)\naccuracy_score(gsSVMC_model,test_Y)","3fb70536":"def plot_learning_curve(estimator, title, X, y, ylim=None, cv=None,\n                        n_jobs=-1, train_sizes=np.linspace(.1, 1.0, 5)):\n    \"\"\"Generate a simple plot of the test and training learning curve\"\"\"\n    plt.figure()\n    plt.title(title)\n    if ylim is not None:\n        plt.ylim(*ylim)\n    plt.xlabel(\"Training examples\")\n    plt.ylabel(\"Score\")\n    train_sizes, train_scores, test_scores = learning_curve(\n        estimator, X, y, cv=cv, n_jobs=n_jobs, train_sizes=train_sizes)\n    train_scores_mean = np.mean(train_scores, axis=1)\n    train_scores_std = np.std(train_scores, axis=1)\n    test_scores_mean = np.mean(test_scores, axis=1)\n    test_scores_std = np.std(test_scores, axis=1)\n    plt.grid()\n\n    plt.fill_between(train_sizes, train_scores_mean - train_scores_std,\n                     train_scores_mean + train_scores_std, alpha=0.1,\n                     color=\"r\")\n    plt.fill_between(train_sizes, test_scores_mean - test_scores_std,\n                     test_scores_mean + test_scores_std, alpha=0.1, color=\"g\")\n    plt.plot(train_sizes, train_scores_mean, 'o-', color=\"r\",\n             label=\"Training score\")\n    plt.plot(train_sizes, test_scores_mean, 'o-', color=\"g\",\n             label=\"Cross-validation score\")\n\n    plt.legend(loc=\"best\")\n    return plt\n\ng = plot_learning_curve(gsRFC.best_estimator_,\"RF mearning curves\",train_X,train_Y,cv=kfold)\ng = plot_learning_curve(gsExtC.best_estimator_,\"ExtraTrees learning curves\",train_X,train_Y,cv=kfold)\ng = plot_learning_curve(gsSVMC.best_estimator_,\"SVC learning curves\",train_X,train_Y,cv=kfold)\ng = plot_learning_curve(gsadaDTC.best_estimator_,\"AdaBoost learning curves\",train_X,train_Y,cv=kfold)\ng = plot_learning_curve(gsGBC.best_estimator_,\"GradientBoosting learning curves\",train_X,train_Y,cv=kfold)\n","6a8d758d":"print('Logistic Regression Accuracy:',accuracy_score(logreg_predict,test_Y))\nprint('K-Nearest Neighbour Accuracy:',accuracy_score(knn_predict,test_Y))\nprint('Decision Tree Classifier Accuracy:',accuracy_score(dtree_predict,test_Y))\nprint('Random Forest Classifier Accuracy:',accuracy_score(rfc_predict,test_Y))\nprint('support Vector Machine Accuracy:',accuracy_score(svm_predict,test_Y))\nprint('Adaboost Classifier Accuracy:',accuracy_score(adc_predict,test_Y))\nprint('XGBoost Accuracy:',accuracy_score(xgb_predict,test_Y))\nprint('SVC:',accuracy_score(gsSVMC_model,test_Y))\nprint('Gradient Boosting Classifier:',accuracy_score(gsGBC_model,test_Y))\nprint('RF classifier:',accuracy_score(gsRFC_model,test_Y))\nprint('Extensible Trees Classifier:',accuracy_score(gsExtC_model,test_Y))\nprint('Adaboost Classifier:',accuracy_score(gsadaDTC_model,test_Y))\n","61d3fef7":"**Now Check it out YOUR INSTA PROFILE fake or genuine**","9074cfad":"We got highest accuracy in Gradient Boosting Algorithm and Random Forest Classifier"}}