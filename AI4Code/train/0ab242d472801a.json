{"cell_type":{"31d479a4":"code","ba8dba7a":"code","9b8674e5":"code","51cdf0eb":"code","e525c6a1":"code","01156547":"code","2ca7359a":"code","86555525":"code","b92ce7eb":"code","77dc2546":"code","317c1e64":"code","118b9ac4":"code","84c37806":"markdown","1d72521f":"markdown"},"source":{"31d479a4":"import os\nimport pandas as pd\nimport numpy as np\nfrom keras import Sequential\nfrom keras.layers import Dense\nfrom keras.utils import to_categorical\nfrom sklearn.preprocessing import StandardScaler\nfrom keras.callbacks import Callback\nimport matplotlib.pyplot as plt","ba8dba7a":"data = pd.read_csv('..\/input\/water-potability\/water_potability.csv')","9b8674e5":"data.head(5)","51cdf0eb":"#Chack null value\ndata.isnull().sum()","e525c6a1":"#Fill null value\ndata['ph'] = data['ph'].fillna(data['ph'].mean())\ndata['Sulfate'] = data['Sulfate'].fillna(data['Sulfate'].mean())\ndata['Trihalomethanes'] = data['Trihalomethanes'].fillna(data['Trihalomethanes'].mean())","01156547":"data.describe()","2ca7359a":"y = data['Potability']\nx = data.drop(['Potability'],axis='columns').values","86555525":"x = StandardScaler().fit_transform(x)","b92ce7eb":"model = Sequential([\n        Dense(25,input_shape=(9,),activation='relu'),\n        Dense(2,activation='sigmoid')    \n])\n\nmodel.compile(optimizer='adam',loss='binary_crossentropy',metrics=['accuracy'])","77dc2546":"class CustomCallback(Callback):\n    def on_epoch_end(self, epoch, logs={}):\n        if logs.get('accuracy')>=0.74:\n          print('accuracy 74%')\n          self.model.stop_training = True\n\nh = model.fit(x,to_categorical(y),epochs=1300,callbacks=[CustomCallback()])","317c1e64":"plt.plot(h.history['accuracy'],label='accuracy')\nplt.plot(h.history['loss'],label='loss')\nplt.legend()","118b9ac4":"print(f\"min accuracy is : {min(h.history['accuracy'])}\")\nprint(f\"max accuracy is : {max(h.history['accuracy'])}\")","84c37806":"Read Data","1d72521f":"import importance library"}}