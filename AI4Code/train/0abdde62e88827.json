{"cell_type":{"b7a69b42":"code","c4d7e3b0":"code","9c91d9ca":"code","517b814e":"markdown","9766eb33":"markdown"},"source":{"b7a69b42":"import numpy as np, pandas as pd\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.metrics import roc_auc_score\nfrom tqdm import tqdm_notebook\n\ntrain = pd.read_csv('..\/input\/train.csv')\ntest = pd.read_csv('..\/input\/test.csv')\n\ntrain.head()","c4d7e3b0":"cols = [c for c in train.columns if c not in ['id', 'target', 'wheezy-copper-turtle-magic']]","9c91d9ca":"for i in tqdm_notebook(range(512)):\n    train2 = train[train['wheezy-copper-turtle-magic']==i]\n    train2.reset_index(drop=True,inplace=True)\n    \n    clf = LogisticRegression(solver='liblinear',penalty='l1',C=0.05)\n    clf.fit(train2[cols], train2['target'])\n    \n    for j in range(i, 512):\n        val = train[train['wheezy-copper-turtle-magic']==j]\n        preds = clf.predict_proba(val[cols])[:,1]\n        auc = roc_auc_score(val['target'], preds)\n        if auc > 0.65 or j==i:\n            print(f'magic-{i}-{j}  auc={auc:.4}' )\n    print('-'*40)","517b814e":"# <h2>Are magics interconnected? <h2\/>\n<br><br>\nThanks Chris for his kernel https:\/\/www.kaggle.com\/cdeotte\/logistic-regression-0-800. \n\nI wondered do 'wheezy-copper-turtle-magic' categories interconnected? <br>\nAnd I decided to check, what would be if train on one category and evaluate AUC on another.","9766eb33":"### As you can see, some predictions give us ~0.7 AUC.\n### Does it mean something or it's just noise?"}}