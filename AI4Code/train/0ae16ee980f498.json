{"cell_type":{"32dbd8b8":"code","6a459478":"code","e9301709":"code","275f247f":"code","a32fa024":"code","e3763320":"code","e33d3def":"code","45069f45":"code","bf073261":"code","1305a009":"code","9ade0ae1":"code","d0a396f3":"code","bb1b356b":"code","df036f7b":"code","bfa4528d":"code","9722e38e":"code","932de911":"code","79fae4ad":"code","f6b3deec":"code","571f4009":"code","3f376fee":"code","ec5cc6ed":"code","9c6ef926":"code","ea5a8cdc":"code","03eae53c":"code","b972c4a6":"code","ce28cee7":"code","2b120142":"code","86c1b11b":"code","6e61dbd1":"code","dbad05b0":"code","2a41303d":"code","e4263675":"code","859df52f":"code","98e1371d":"code","701f69e9":"code","e9a7a8b9":"code","a744c6bb":"code","69ba86b3":"code","e4e612ff":"code","30f84770":"code","0522768b":"code","f9ea65e2":"code","8a05397a":"code","014c3859":"code","ef2c579c":"code","3ff11902":"code","768c0ea6":"code","8977c5e1":"code","f82d83b2":"code","ccf17bbe":"code","e8037a5f":"code","fdcf3151":"code","cdd799cf":"code","a3443e62":"code","5a4da280":"code","29267c58":"code","035be9e2":"code","e7ccd405":"code","cd190249":"code","e590460e":"code","6ca5aea0":"code","26252aa8":"code","44766dd2":"code","8b6e0ade":"code","d158f334":"code","e8c15b62":"code","44baa455":"code","f25ecddf":"code","4fb78da9":"code","3ac4cf6d":"code","ca468f4c":"code","c29709ff":"code","32798335":"code","6827f8ff":"code","b1524bf7":"code","3cd1babc":"code","3b091ed9":"code","1fb804bd":"code","d8ed25c1":"code","c57d1e86":"code","af1851e4":"code","9348ce10":"code","f5c0b612":"code","2bcc5d16":"code","2ad62ca2":"code","ab1a18ef":"code","06bf835d":"code","01cc9693":"code","75dd2221":"code","f232eb02":"code","63ed3162":"code","195432ba":"code","d186c9e2":"code","40d4f610":"code","2cc4e887":"code","58be53e1":"code","04625281":"code","218489b0":"code","eee2adc2":"code","7c342062":"code","2e0ddaee":"code","3b1bb71c":"code","3bc7255a":"code","ec5b0f8c":"code","04765b55":"code","4f60a543":"code","1612e16f":"code","b33c8af9":"code","dfcec62c":"code","b0340d47":"code","b9678ac2":"code","95285da9":"code","dbb66efd":"code","9ee2b7d1":"code","05dc5ef0":"code","ebe7c71f":"code","288bb62b":"code","167592f0":"code","efe97ae7":"code","7116a11e":"code","14918caf":"code","bddfdb2e":"code","3f9c3528":"code","34ab0081":"code","1754cbb1":"code","60fe2d81":"code","fbaa48be":"code","1b57df42":"code","60419d6c":"code","75a2104b":"code","efcb8b05":"code","377d6987":"code","42ce05d5":"code","a1d1505a":"code","3f5ba114":"code","878a262c":"code","add01f5c":"code","75e65c52":"code","bd48afb6":"code","bd6b478b":"code","70d739d7":"code","dde392d4":"code","11c98913":"code","2a4555fd":"code","bce925c4":"code","6506bc1a":"code","2b96a3f9":"code","0feb6638":"code","c237e717":"code","a42c4bb4":"code","40a207e2":"code","43d51e65":"code","3370fc0d":"code","42229eff":"code","6c3eab4b":"code","12afa798":"code","40e5c90f":"code","56490179":"code","d0eaa3bd":"code","7f0bd63d":"code","7c9640e8":"code","fd55a7aa":"code","43825fa8":"code","3caeaade":"code","5431f29a":"code","cf10e94b":"code","52443160":"code","22dd840b":"code","c5226e3e":"code","52c590ba":"code","f21a31e7":"code","cda0b2e8":"code","8d950e1d":"code","b81bbe94":"code","1a9a4efa":"code","cefde49b":"code","bfc5f298":"code","034f8858":"code","7b45be3c":"code","60b4be87":"code","7b7a1127":"code","0a044e54":"code","8a147d5a":"code","ff40f860":"code","9db7c2bb":"code","e488f246":"code","422c4c0d":"code","8eb7b208":"code","9141cb29":"code","19ff9568":"code","f694fb15":"code","0e6fa4f0":"code","79e4de53":"code","1c5af7c1":"code","61cdf3c8":"code","0b3f7728":"code","5ee564da":"code","4817c910":"code","861992cf":"code","91595ca5":"code","72c6a720":"code","f3355f80":"code","4886ed78":"code","a855e938":"code","a9e8f25c":"code","a89d5297":"code","8b2ef6a5":"code","aeb7f1d3":"code","312b5812":"code","d0f702cd":"code","5e0456c4":"code","5acd6f0c":"code","6da062e2":"code","05d9cec8":"code","b4c3cc84":"markdown","360e16a4":"markdown","646cca10":"markdown","1a895540":"markdown","1ace9e1b":"markdown","5dca0495":"markdown","644a399f":"markdown","69afbcd8":"markdown","0528f722":"markdown","8087b1f6":"markdown","9630f9b6":"markdown","58916032":"markdown","aba3c93a":"markdown","7afae2ec":"markdown","f57de7ad":"markdown","208a8a68":"markdown","e0a8f4e1":"markdown","d9d1686a":"markdown","0ebe7e16":"markdown","7b2695e2":"markdown","079a09e8":"markdown","b9a0fd66":"markdown","b8ad98e0":"markdown","db52f8c6":"markdown","206e9bda":"markdown","2ce165bf":"markdown","62400fe8":"markdown","6cb460c2":"markdown","e941d2e5":"markdown","f6e4ffeb":"markdown","01201174":"markdown","2a7c2a35":"markdown","6f80daf2":"markdown","7fcb1e4e":"markdown","8a53b1ea":"markdown","209b3d04":"markdown","368e4413":"markdown","a025e1b9":"markdown","fce90d7b":"markdown","7dabb721":"markdown","00801c00":"markdown","64557d59":"markdown","546633d5":"markdown","053fd422":"markdown","db2c4e38":"markdown","61188d34":"markdown","8f1ba748":"markdown","cd539664":"markdown","a6f84728":"markdown","9ab215e2":"markdown","88218146":"markdown","ea6761ff":"markdown","74de71c2":"markdown","0d2f5bca":"markdown","a38c9c5d":"markdown","26c68ceb":"markdown","71b02e91":"markdown","7a8c54c3":"markdown","ba063bc6":"markdown","236fb7c3":"markdown","d5739f66":"markdown","985cd3b9":"markdown","f8b2b6d5":"markdown","a755d5d7":"markdown","936cb9a2":"markdown","603bca05":"markdown","36bc4007":"markdown","db4b6ea8":"markdown","e9e53182":"markdown","3c313154":"markdown","1df4d24d":"markdown","5d3eac08":"markdown","b26f6f2d":"markdown","81216358":"markdown"},"source":{"32dbd8b8":"import pandas as pd\n\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport warnings\nwarnings.filterwarnings(\"ignore\")\nimport numpy as np","6a459478":"df= pd.read_csv('..\/input\/narcissistic-personality-inventory-test\/NPI\/data.csv')","e9301709":"df","275f247f":"df.drop(\"elapse\",axis=1,inplace=True)","a32fa024":"df.info()","e3763320":"df.describe()","e33d3def":"sns.pairplot(df[[\"score\",\"age\",\"gender\"]])","45069f45":"sns.displot(df[\"score\"],kde=True)\nprint(\"Score Mean: \",df[\"score\"].mean())","bf073261":"\nsns.displot(df[\"age\"],kde=True,bins=70);\nprint(\"Age Mean: \",df[\"age\"].mean())","1305a009":"sns.countplot(df[\"gender\"]);","9ade0ae1":"q_cols=['Q1', 'Q2', 'Q3', 'Q4', 'Q5', 'Q6', 'Q7', 'Q8', 'Q9', 'Q10',\n       'Q11', 'Q12', 'Q13', 'Q14', 'Q15', 'Q16', 'Q17', 'Q18', 'Q19', 'Q20',\n       'Q21', 'Q22', 'Q23', 'Q24', 'Q25', 'Q26', 'Q27', 'Q28', 'Q29', 'Q30',\n       'Q31', 'Q32', 'Q33', 'Q34', 'Q35', 'Q36', 'Q37', 'Q38', 'Q39', 'Q40']\none=0\ntwo=0\nfor x in q_cols:\n    one+=df[x].value_counts()[1]\n    two+=df[x].value_counts()[2]\n    \n    \n    \n    ","d0a396f3":"print(\"There are \",one,\"questions answered like one\")\nprint(\"------------------------\")\nprint(\"There are \",two,\"questions answered like two\")","bb1b356b":"sns.scatterplot(data=df,x=\"age\",y=\"score\")","df036f7b":"sns.boxplot(data=df,x=\"gender\",y=\"score\");","bfa4528d":"sns.boxplot(data=df,x=\"gender\",y=\"age\");","9722e38e":"for x,y in enumerate(df[\"age\"]):\n    if y>90:\n        print(x,y)","932de911":"index=[]\nfor x,y in enumerate(df[\"age\"]):\n    if y<14:\n        print(x,y)\n        index.append(x)","79fae4ad":"df.drop([1271,8062,8268,8355,9153,9227],axis=0,inplace=True)","f6b3deec":"df.drop(index,axis=0,inplace=True)","571f4009":"\nsns.displot(df[\"age\"],kde=True);\nprint(\"Age Mean: \",df[\"age\"].mean())","3f376fee":"sns.scatterplot(data=df,x=\"age\",y=\"score\")","ec5cc6ed":"plt.figure(figsize=(14,6))\nsns.scatterplot(data=df,x=\"age\",y=\"score\",hue=\"gender\",palette=\"Dark2\");","9c6ef926":"sns.boxplot(data=df,x=\"gender\",y=\"age\");","ea5a8cdc":"df.corr()[\"score\"].abs().sort_values(ascending = False)\n\n    ","03eae53c":"from sklearn.preprocessing import StandardScaler","b972c4a6":"scaler=StandardScaler()","ce28cee7":"X=df.drop(\"score\",axis=1)\ny=df[\"score\"]","2b120142":"X=scaler.fit_transform(X)","86c1b11b":"from sklearn.model_selection import train_test_split","6e61dbd1":"X_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.25,random_state=101)","dbad05b0":"from sklearn.linear_model import LinearRegression","2a41303d":"lm=LinearRegression()\nlm.fit(X_train,y_train)","e4263675":"preds=lm.predict(X_train)\npreds2=lm.predict(X_test)","859df52f":"from sklearn.metrics import r2_score","98e1371d":"lm_score=r2_score(y_test,preds2)\nprint(f\" The R2 is (train) : {r2_score(y_train,preds)} \")\nprint(f\" The R2 is (test) : {r2_score(y_test,preds2)} \")","701f69e9":"from sklearn.linear_model import Ridge\nfrom sklearn.model_selection import GridSearchCV","e9a7a8b9":"params={\"alpha\":[0.0001,0.01,0.05,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1.0,2.0,3.0,4.0,5.0,10,50,100]}\nridge=Ridge()\nfolds=5","a744c6bb":"model_cv=GridSearchCV(estimator=ridge,param_grid=params,cv=folds,scoring=\"r2\",return_train_score=True,verbose=2)","69ba86b3":"model_cv.fit(X_train,y_train)","e4e612ff":"cv_results=pd.DataFrame(model_cv.cv_results_)\ncv_results.head()","30f84770":"sns.lineplot(data=cv_results,x=\"param_alpha\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_alpha\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Alpha\")\nplt.ylabel(\"R2\")","0522768b":"model_cv.best_params_","f9ea65e2":"alpha=100\nridge=Ridge(alpha=100)\nridge.fit(X_train,y_train)","8a05397a":"ridge.coef_\ny_pred=ridge.predict(X_test)\ny_pred2=ridge.predict(X_train)\nridge_score=r2_score(y_test,y_pred)\nprint(\"Train: \",r2_score(y_train,y_pred2))\nprint(\"Test: \",r2_score(y_test,y_pred))","014c3859":"from sklearn.linear_model import Lasso","ef2c579c":"lasso=Lasso()\nmodel_cv=GridSearchCV(estimator=lasso,param_grid=params,cv=folds,scoring=\"r2\",return_train_score=True,verbose=1)","3ff11902":"model_cv.fit(X_train,y_train)","768c0ea6":"cv_results=pd.DataFrame(model_cv.cv_results_)\ncv_results.head()","8977c5e1":"sns.lineplot(data=cv_results,x=\"param_alpha\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_alpha\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Alpha\")\nplt.ylabel(\"R2\")","f82d83b2":"sns.lineplot(data=cv_results,x=\"param_alpha\",y=\"mean_train_score\",label=\"Train\")\nplt.xlabel(\"Alpha\")\nplt.ylabel(\"R2\");","ccf17bbe":"sns.lineplot(data=cv_results,x=\"param_alpha\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Alpha\")\nplt.ylabel(\"R2\");","e8037a5f":"model_cv.best_params_","fdcf3151":"\nlasso=Lasso(alpha=0.0001)\nlasso.fit(X_train,y_train)","cdd799cf":"y_pred=lasso.predict(X_test)\ny_pred2=lasso.predict(X_train)\nlasso_score=r2_score(y_test,y_pred)\nprint(\"Train: \",r2_score(y_train,y_pred2))\nprint(\"Test: \",r2_score(y_test,y_pred))","a3443e62":"from sklearn.linear_model import ElasticNet","5a4da280":"elasticnet=ElasticNet()\nparams={\"alpha\":[0.0001,0.01,0.05,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1.0,2.0,3.0,4.0,5.0,10,50,100],\n        \"l1_ratio\": [0.1, 0.5, 0.7, 0.9, 0.95, 0.99, 1]}\n","29267c58":"model_cv=GridSearchCV(estimator=elasticnet,param_grid=params,cv=folds,scoring=\"r2\",return_train_score=True,verbose=1)\nmodel_cv.fit(X_train,y_train)","035be9e2":"cv_results=pd.DataFrame(model_cv.cv_results_)\ncv_results.head()","e7ccd405":"sns.lineplot(data=cv_results,x=\"param_alpha\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_alpha\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Alpha\")\nplt.ylabel(\"R2\")","cd190249":"sns.lineplot(data=cv_results,x=\"param_l1_ratio\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_l1_ratio\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"L1 Ratio\")\nplt.ylabel(\"R2\")","e590460e":"model_cv.best_params_","6ca5aea0":"elasticnet=ElasticNet(alpha=0.01,l1_ratio=0.1)\nelasticnet.fit(X_train,y_train)","26252aa8":"y_pred=elasticnet.predict(X_test)\ny_pred2=elasticnet.predict(X_train)\nelasticnet_score=r2_score(y_test,y_pred)\nprint(\"Train: \",r2_score(y_train,y_pred2))\nprint(\"Test: \",r2_score(y_test,y_pred))","44766dd2":"from sklearn.neighbors import KNeighborsRegressor","8b6e0ade":"params={\"n_neighbors\":[1,2,3,4,5,6,7,8,9,10]}\nKNR=KNeighborsRegressor()","d158f334":"model_cv=GridSearchCV(estimator=KNR,param_grid=params,scoring=\"r2\",return_train_score=True,verbose=2)\nmodel_cv.fit(X_train,y_train)","e8c15b62":"cv_results=pd.DataFrame(model_cv.cv_results_)\ncv_results.head()","44baa455":"sns.lineplot(data=cv_results,x=\"param_n_neighbors\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_n_neighbors\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Neighbors\")\nplt.ylabel(\"R2\")","f25ecddf":"model_cv.best_params_","4fb78da9":"KNR=KNeighborsRegressor(n_neighbors= 5)","3ac4cf6d":"KNR.fit(X_train,y_train)","ca468f4c":"y_pred=KNR.predict(X_test)\ny_pred2=KNR.predict(X_train)\nKNR_score=r2_score(y_test,y_pred)\nprint(\"Train: \",r2_score(y_train,y_pred2))\nprint(\"Test: \",r2_score(y_test,y_pred))","c29709ff":"from sklearn.svm import SVR","32798335":"params={\n    \"C\":[0.01,0.1],\n    \"kernel\":[\"linear\"],\n    \"degree\":[1,2,3],\n    \"gamma\":[\"scale\",\"auto\"],\n    \"epsilon\":[0.1,1,10,100]}","6827f8ff":"svr=SVR()\nmodel_cv=GridSearchCV(estimator=svr,param_grid=params,scoring=\"r2\",return_train_score=True,verbose=2,cv=None)\nmodel_cv.fit(X_train,y_train)","b1524bf7":"cv_results=pd.DataFrame(model_cv.cv_results_)\ncv_results.head()","3cd1babc":"sns.lineplot(data=cv_results,x=\"param_C\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_C\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"C\")\nplt.ylabel(\"R2\")","3b091ed9":"sns.lineplot(data=cv_results,x=\"param_degree\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_degree\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"degree\")\nplt.ylabel(\"R2\")","1fb804bd":"sns.lineplot(data=cv_results,x=\"param_epsilon\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_epsilon\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"epsilon\")\nplt.ylabel(\"R2\")","d8ed25c1":"sns.lineplot(data=cv_results,x=\"param_gamma\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_gamma\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Gamma\")\nplt.ylabel(\"R2\")","c57d1e86":"model_cv.best_params_","af1851e4":"svr=SVR(C= 0.1, degree= 1, epsilon= 0.1, gamma= 'scale', kernel= 'linear')\nsvr.fit(X_train,y_train)","9348ce10":"y_pred=svr.predict(X_test)\ny_pred2=svr.predict(X_train)\nSVR_score=r2_score(y_test,y_pred)\nprint(\"Train: \",r2_score(y_train,y_pred2))\nprint(\"Test: \",r2_score(y_test,y_pred))","f5c0b612":"from sklearn.tree import DecisionTreeRegressor","2bcc5d16":"params={\"max_depth\":[2,4,6,8,10],\n    \"max_leaf_nodes\":[3,6,9,12],\n        \"min_samples_leaf\":range(5,200,40),\n       \"min_samples_split\":range(5,200,40)}","2ad62ca2":"dt=DecisionTreeRegressor(random_state=101)","ab1a18ef":"model_cv=GridSearchCV(estimator=dt,param_grid=params,scoring=\"r2\",return_train_score=True,verbose=2,cv=None)\nmodel_cv.fit(X_train,y_train)","06bf835d":"cv_results=pd.DataFrame(model_cv.cv_results_)\ncv_results.head()","01cc9693":"sns.lineplot(data=cv_results,x=\"param_max_depth\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_max_depth\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Max Depth\")\nplt.ylabel(\"R2\")","75dd2221":"sns.lineplot(data=cv_results,x=\"param_max_leaf_nodes\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_max_leaf_nodes\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Max Leaf Nodes\")\nplt.ylabel(\"R2\")","f232eb02":"sns.lineplot(data=cv_results,x=\"param_min_samples_leaf\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_min_samples_leaf\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Min Samples Leaf\")\nplt.ylabel(\"R2\")","63ed3162":"sns.lineplot(data=cv_results,x=\"param_min_samples_split\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_min_samples_split\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Min Samples Split\")\nplt.ylabel(\"R2\")","195432ba":"model_cv.best_params_","d186c9e2":"dtr=DecisionTreeRegressor(max_depth=6,max_leaf_nodes=12,min_samples_leaf=12,min_samples_split=5,random_state=101)\ndtr.fit(X_train,y_train)","40d4f610":"y_pred=dtr.predict(X_test)\ny_pred2=dtr.predict(X_train)\ndtr_score=r2_score(y_test,y_pred)\nprint(\"Train: \",r2_score(y_train,y_pred2))\nprint(\"Test: \",r2_score(y_test,y_pred))","2cc4e887":"from sklearn import tree\ncols=['Q1', 'Q2', 'Q3', 'Q4', 'Q5', 'Q6', 'Q7', 'Q8', 'Q9', 'Q10','Q11', 'Q12', 'Q13', 'Q14', 'Q15', 'Q16', 'Q17', 'Q18', 'Q19', 'Q20' 'Q21', 'Q22', 'Q23', 'Q24', 'Q25', 'Q26', 'Q27', 'Q28', 'Q29', 'Q30','Q31', 'Q32', 'Q33', 'Q34', 'Q35', 'Q36', 'Q37', 'Q38', 'Q39', 'Q40','gender', 'age']\nplt.figure(figsize=(25,10))\nplt.tight_layout()\na=tree.plot_tree(dtr,feature_names=cols,class_names=df[\"score\"],filled=True,rounded=True,fontsize=14)","58be53e1":"from sklearn.ensemble import BaggingRegressor","04625281":"br=BaggingRegressor(DecisionTreeRegressor(),random_state=101)\nparams={\"max_samples\":[1,5,10,20,50,100,250,500],\n       \"max_features\":[1,5,10,15,20],\n       \"base_estimator__max_depth\":[1,5,10,15,20]}","218489b0":"model_cv=GridSearchCV(estimator=br,param_grid=params,scoring=\"r2\",return_train_score=True,verbose=2,cv=None)\nmodel_cv.fit(X_train,y_train)","eee2adc2":"cv_results=pd.DataFrame(model_cv.cv_results_)\ncv_results.head()","7c342062":"sns.lineplot(data=cv_results,x=\"param_max_features\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_max_features\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Max Features\")\nplt.ylabel(\"R2\")","2e0ddaee":"sns.lineplot(data=cv_results,x=\"param_max_samples\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_max_samples\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Max Features\")\nplt.ylabel(\"R2\")","3b1bb71c":"sns.lineplot(data=cv_results,x=\"param_base_estimator__max_depth\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_base_estimator__max_depth\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Max Depth Decision Tree\")\nplt.ylabel(\"R2\")","3bc7255a":"model_cv.best_params_","ec5b0f8c":"bgr=BaggingRegressor(DecisionTreeRegressor(max_depth=20),random_state=101,max_features=20,max_samples=500)\nbgr.fit(X_train,y_train)","04765b55":"y_pred=bgr.predict(X_test)\ny_pred2=bgr.predict(X_train)\nbgr_score=r2_score(y_test,y_pred)\nprint(\"Train: \",r2_score(y_train,y_pred2))\nprint(\"Test: \",r2_score(y_test,y_pred))","4f60a543":"from sklearn.ensemble import RandomForestRegressor","1612e16f":"rfr=RandomForestRegressor(random_state=101)","b33c8af9":"params={\n    \"n_estimators\":[30,64,100,128,200],\n    \"max_features\":[2,3,4],\n    \"max_depth\":[4,8,10,15]}\n     ","dfcec62c":"model_cv=GridSearchCV(estimator=rfr,param_grid=params,scoring=\"r2\",return_train_score=True,verbose=2,cv=None)\nmodel_cv.fit(X_train,y_train)","b0340d47":"cv_results=pd.DataFrame(model_cv.cv_results_)\ncv_results.head()","b9678ac2":"sns.lineplot(data=cv_results,x=\"param_max_depth\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_max_depth\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Max Depth\")\nplt.ylabel(\"R2\")","95285da9":"sns.lineplot(data=cv_results,x=\"param_max_features\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_max_features\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Max Features\")\nplt.ylabel(\"R2\")","dbb66efd":"sns.lineplot(data=cv_results,x=\"param_n_estimators\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_n_estimators\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Number of Estimators\")\nplt.ylabel(\"R2\")","9ee2b7d1":"model_cv.best_params_","05dc5ef0":"rfr=RandomForestRegressor(max_depth=15,max_features=2,n_estimators=200,random_state=101)\nrfr.fit(X_train,y_train)","ebe7c71f":"y_pred=rfr.predict(X_test)\ny_pred2=rfr.predict(X_train)\nrfr_score=r2_score(y_test,y_pred)\nprint(\"Train: \",r2_score(y_train,y_pred2))\nprint(\"Test: \",r2_score(y_test,y_pred))","288bb62b":"from sklearn.ensemble import ExtraTreesRegressor","167592f0":"etr=ExtraTreesRegressor(random_state=101)\nparams={\n    \"n_estimators\":[30,64,100,128,200],\n    \"max_features\":[2,3,4],\n    \"max_depth\":[4,8,10,15]}\n     ","efe97ae7":"model_cv=GridSearchCV(estimator=etr,param_grid=params,scoring=\"r2\",return_train_score=True,verbose=2,cv=None)\nmodel_cv.fit(X_train,y_train)","7116a11e":"cv_results=pd.DataFrame(model_cv.cv_results_)\ncv_results.head()","14918caf":"sns.lineplot(data=cv_results,x=\"param_max_depth\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_max_depth\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Max Depth\")\nplt.ylabel(\"R2\")","bddfdb2e":"sns.lineplot(data=cv_results,x=\"param_max_features\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_max_features\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Max Features\")\nplt.ylabel(\"R2\")","3f9c3528":"sns.lineplot(data=cv_results,x=\"param_n_estimators\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_n_estimators\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Number of Estimators\")\nplt.ylabel(\"R2\")","34ab0081":"model_cv.best_params_","1754cbb1":"etr=ExtraTreesRegressor(random_state=101,max_depth=15,max_features=4,n_estimators=200)\netr.fit(X_train,y_train)","60fe2d81":"y_pred=etr.predict(X_test)\ny_pred2=etr.predict(X_train)\netr_score=r2_score(y_test,y_pred)\nprint(\"Train: \",r2_score(y_train,y_pred2))\nprint(\"Test: \",r2_score(y_test,y_pred))","fbaa48be":"from sklearn.ensemble import AdaBoostRegressor","1b57df42":"tree=DecisionTreeRegressor(random_state=101)\nadr=AdaBoostRegressor(base_estimator=tree,random_state=101)\nparams={\"base_estimator__max_depth\":[4,8,10],\n    \"n_estimators\":[5,10,15,20],\n    \"learning_rate\":[0.1,0.05,0.02]}","60419d6c":"model_cv=GridSearchCV(estimator=adr,param_grid=params,scoring=\"r2\",return_train_score=True,verbose=2,cv=None)\nmodel_cv.fit(X_train,y_train)","75a2104b":"cv_results=pd.DataFrame(model_cv.cv_results_)\ncv_results.head()","efcb8b05":"sns.lineplot(data=cv_results,x=\"param_base_estimator__max_depth\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_base_estimator__max_depth\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Max Depth Decision Tree\")\nplt.ylabel(\"R2\")","377d6987":"sns.lineplot(data=cv_results,x=\"param_learning_rate\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_learning_rate\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Learning Rate\")\nplt.ylabel(\"R2\")","42ce05d5":"sns.lineplot(data=cv_results,x=\"param_n_estimators\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_n_estimators\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Number of Estimators\")\nplt.ylabel(\"R2\")","a1d1505a":"model_cv.best_params_","3f5ba114":"tree=DecisionTreeRegressor(random_state=101,max_depth=10)\nadr=AdaBoostRegressor(base_estimator=tree,random_state=101,learning_rate=0.1,n_estimators=20)\nadr.fit(X_train,y_train)","878a262c":"y_pred=adr.predict(X_test)\ny_pred2=adr.predict(X_train)\nadr_score=r2_score(y_test,y_pred)\nprint(\"Train: \",r2_score(y_train,y_pred2))\nprint(\"Test: \",r2_score(y_test,y_pred))","add01f5c":"from sklearn.ensemble import GradientBoostingRegressor","75e65c52":"gbr=GradientBoostingRegressor(random_state=101)\nparams={\n    \"n_estimators\":[5,10,15,20],\n    \"learning_rate\":[0.2,0.1,0.05],\n    \"max_depth\":[3,4,8],\n    \"subsample\":[0.3,0.6,0.9]\n}","bd48afb6":"model_cv=GridSearchCV(estimator=gbr,param_grid=params,scoring=\"r2\",return_train_score=True,verbose=2,cv=None)\nmodel_cv.fit(X_train,y_train)","bd6b478b":"cv_results=pd.DataFrame(model_cv.cv_results_)\ncv_results.head()","70d739d7":"sns.lineplot(data=cv_results,x=\"param_learning_rate\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_learning_rate\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Learning Rate\")\nplt.ylabel(\"R2\")","dde392d4":"sns.lineplot(data=cv_results,x=\"param_n_estimators\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_n_estimators\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Number of Estimators\")\nplt.ylabel(\"R2\")","11c98913":"sns.lineplot(data=cv_results,x=\"param_max_depth\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_max_depth\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Max Depth\")\nplt.ylabel(\"R2\")","2a4555fd":"sns.lineplot(data=cv_results,x=\"param_subsample\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_subsample\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Subsample\")\nplt.ylabel(\"R2\")","bce925c4":"model_cv.best_params_","6506bc1a":"gbr=GradientBoostingRegressor(random_state=101,learning_rate= 0.2,max_depth= 8,n_estimators= 20,subsample= 0.6)\ngbr.fit(X_train,y_train)","2b96a3f9":"y_pred=gbr.predict(X_test)\ny_pred2=gbr.predict(X_train)\ngbr_score=r2_score(y_test,y_pred)\nprint(\"Train: \",r2_score(y_train,y_pred2))\nprint(\"Test: \",r2_score(y_test,y_pred))","0feb6638":"from xgboost import XGBRegressor","c237e717":"xgbr=XGBRegressor(random_state=101)\n\nparams={\n    \"n_estimators\":[5,10,15,20],\n    \"learning_rate\":[0.2,0.1,0.05],\n    \"max_depth\":[3,4,8],\n    \"subsample\":[0.3,0.6,0.9]\n}","a42c4bb4":"model_cv=GridSearchCV(estimator=xgbr,param_grid=params,scoring=\"r2\",return_train_score=True,verbose=2,cv=None)\nmodel_cv.fit(X_train,y_train)\n","40a207e2":"cv_results=pd.DataFrame(model_cv.cv_results_)\ncv_results.head()","43d51e65":"sns.lineplot(data=cv_results,x=\"param_learning_rate\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_learning_rate\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Learning Rate\")\nplt.ylabel(\"R2\")","3370fc0d":"sns.lineplot(data=cv_results,x=\"param_n_estimators\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_n_estimators\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Number of Estimators\")\nplt.ylabel(\"R2\")","42229eff":"sns.lineplot(data=cv_results,x=\"param_max_depth\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_max_depth\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Max Depth\")\nplt.ylabel(\"R2\")","6c3eab4b":"sns.lineplot(data=cv_results,x=\"param_subsample\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_subsample\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Subsample\")\nplt.ylabel(\"R2\")","12afa798":"model_cv.best_params_","40e5c90f":"xgbr=XGBRegressor(random_state=101,learning_rate= 0.2,max_depth=8,n_estimators=20,subsample= 0.6)\nxgbr.fit(X_train,y_train)","56490179":"y_pred=xgbr.predict(X_test)\ny_pred2=xgbr.predict(X_train)\nxgbr_score=r2_score(y_test,y_pred)\nprint(\"Train: \",r2_score(y_train,y_pred2))\nprint(\"Test: \",r2_score(y_test,y_pred))","d0eaa3bd":"from lightgbm import LGBMRegressor","7f0bd63d":"lgbmr=LGBMRegressor(random_state=101)\n\nparams={\n    \"n_estimators\":[5,10,15,20],\n    \"learning_rate\":[0.2,0.1,0.05],\n    \"max_depth\":[3,4,8],\n    \"subsample\":[0.3,0.6,0.9]\n}","7c9640e8":"model_cv=GridSearchCV(estimator=lgbmr,param_grid=params,scoring=\"r2\",return_train_score=True,verbose=2,cv=None)\nmodel_cv.fit(X_train,y_train)","fd55a7aa":"cv_results=pd.DataFrame(model_cv.cv_results_)\ncv_results.head()","43825fa8":"sns.lineplot(data=cv_results,x=\"param_learning_rate\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_learning_rate\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Learning Rate\")\nplt.ylabel(\"R2\")","3caeaade":"sns.lineplot(data=cv_results,x=\"param_n_estimators\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_n_estimators\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Number of Estimators\")\nplt.ylabel(\"R2\")","5431f29a":"sns.lineplot(data=cv_results,x=\"param_max_depth\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_max_depth\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Max Depth\")\nplt.ylabel(\"R2\")","cf10e94b":"sns.lineplot(data=cv_results,x=\"param_subsample\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_subsample\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Subsample\")\nplt.ylabel(\"R2\")","52443160":"model_cv.best_params_","22dd840b":"lgbmr=LGBMRegressor(random_state=101,learning_rate= 0.2,max_depth= 8,n_estimators= 20,subsample= 0.3)\nlgbmr.fit(X_train,y_train)","c5226e3e":"y_pred=lgbmr.predict(X_test)\ny_pred2=lgbmr.predict(X_train)\nlgbmr_score=r2_score(y_test,y_pred)\nprint(\"Train: \",r2_score(y_train,y_pred2))\nprint(\"Test: \",r2_score(y_test,y_pred))","52c590ba":"from catboost import CatBoostRegressor","f21a31e7":"cbr=CatBoostRegressor(random_state=101,learning_rate= 0.2,max_depth= 8,n_estimators= 20,subsample= 0.3)\ncbr.fit(X_train,y_train)\n\n\ny_pred=cbr.predict(X_test)\ny_pred2=cbr.predict(X_train)\ncbr_score=r2_score(y_test,y_pred)\n","cda0b2e8":"print(\"Train: \",r2_score(y_train,y_pred2))\nprint(\"Test: \",r2_score(y_test,y_pred))","8d950e1d":"from sklearn.linear_model import SGDRegressor","b81bbe94":"sgdr=SGDRegressor()\nparams={\"alpha\":[0.0001,0.01,0.05,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1.0,2.0,3.0,4.0,5.0,10],\n        \"l1_ratio\": [0.1, 0.5, 0.7, 0.9,1],\n       \"penalty\":[\"l2\",\"l1\",\"elasticnet\"]}","1a9a4efa":"model_cv=GridSearchCV(estimator=sgdr,param_grid=params,scoring=\"r2\",return_train_score=True,verbose=2,cv=None)\nmodel_cv.fit(X_train,y_train)","cefde49b":"cv_results=pd.DataFrame(model_cv.cv_results_)\ncv_results.head()","bfc5f298":"sns.lineplot(data=cv_results,x=\"param_alpha\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_alpha\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Alpha\")\nplt.ylabel(\"R2\")","034f8858":"sns.lineplot(data=cv_results,x=\"param_l1_ratio\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_l1_ratio\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"L1 Ratio\")\nplt.ylabel(\"R2\")","7b45be3c":"sns.lineplot(data=cv_results,x=\"param_penalty\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_penalty\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Penalty\")\nplt.ylabel(\"R2\")","60b4be87":"model_cv.best_params_","7b7a1127":"sgdr=SGDRegressor(alpha=0.0001, l1_ratio= 0.9, penalty= 'l2')\nsgdr.fit(X_train,y_train)","0a044e54":"y_pred=sgdr.predict(X_test)\ny_pred2=sgdr.predict(X_train)\nsgdr_score=r2_score(y_test,y_pred)\nprint(\"Train: \",r2_score(y_train,y_pred2))\nprint(\"Test: \",r2_score(y_test,y_pred))","8a147d5a":"from sklearn.linear_model import Lars","ff40f860":"lars=Lars()\nlars.fit(X_train,y_train)\n","9db7c2bb":"y_pred=lars.predict(X_test)\ny_pred2=lars.predict(X_train)\nlars_score=r2_score(y_test,y_pred)\nprint(\"Train: \",r2_score(y_train,y_pred2))\nprint(\"Test: \",r2_score(y_test,y_pred))","e488f246":"from sklearn.linear_model import ARDRegression","422c4c0d":"ardr=ARDRegression()\nardr.fit(X_train,y_train)","8eb7b208":"y_pred=ardr.predict(X_test)\ny_pred2=ardr.predict(X_train)\nardr_score=r2_score(y_test,y_pred)\nprint(\"Train: \",r2_score(y_train,y_pred2))\nprint(\"Test: \",r2_score(y_test,y_pred))","9141cb29":"from sklearn.linear_model import BayesianRidge","19ff9568":"br=BayesianRidge()\nbr.fit(X_train,y_train)","f694fb15":"y_pred=br.predict(X_test)\ny_pred2=br.predict(X_train)\nbr_score=r2_score(y_test,y_pred)\nprint(\"Train: \",r2_score(y_train,y_pred2))\nprint(\"Test: \",r2_score(y_test,y_pred))","0e6fa4f0":"from sklearn.linear_model import HuberRegressor","79e4de53":"hr=HuberRegressor()\nparams={\"alpha\":[0.0001,0.01,0.05,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1.0,2.0,3.0,4.0,5.0,10],\n        \"epsilon\":[1,1.1,1.2,1.3,1.4,1.5]}","1c5af7c1":"model_cv=GridSearchCV(estimator=hr,param_grid=params,scoring=\"r2\",return_train_score=True,verbose=2,cv=None)\nmodel_cv.fit(X_train,y_train)","61cdf3c8":"cv_results=pd.DataFrame(model_cv.cv_results_)\ncv_results.head()","0b3f7728":"sns.lineplot(data=cv_results,x=\"param_alpha\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_alpha\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Alpha\")\nplt.ylabel(\"R2\")","5ee564da":"sns.lineplot(data=cv_results,x=\"param_epsilon\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_epsilon\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"Epsilon\")\nplt.ylabel(\"R2\")","4817c910":"model_cv.best_params_","861992cf":"hr=HuberRegressor(alpha= 0.7,epsilon= 1.2)\nhr.fit(X_train,y_train)","91595ca5":"y_pred=hr.predict(X_test)\ny_pred2=hr.predict(X_train)\nhr_score=r2_score(y_test,y_pred)\nprint(\"Train: \",r2_score(y_train,y_pred2))\nprint(\"Test: \",r2_score(y_test,y_pred))","72c6a720":"from sklearn.linear_model import TheilSenRegressor","f3355f80":"tsr=TheilSenRegressor()\ntsr.fit(X_train,y_train)","4886ed78":"y_pred=tsr.predict(X_test)\ny_pred2=tsr.predict(X_train)\ntsr_score=r2_score(y_test,y_pred)\nprint(\"Train: \",r2_score(y_train,y_pred2))\nprint(\"Test: \",r2_score(y_test,y_pred))","a855e938":"from sklearn.linear_model import PassiveAggressiveRegressor","a9e8f25c":"par=PassiveAggressiveRegressor()\nparams={\"C\":[0.001,0.01,0.1,1,10]}","a89d5297":"model_cv=GridSearchCV(estimator=par,param_grid=params,scoring=\"r2\",return_train_score=True,verbose=2,cv=None)\nmodel_cv.fit(X_train,y_train)","8b2ef6a5":"cv_results=pd.DataFrame(model_cv.cv_results_)\ncv_results.head()","aeb7f1d3":"sns.lineplot(data=cv_results,x=\"param_C\",y=\"mean_train_score\",label=\"Train\")\nsns.lineplot(data=cv_results,x=\"param_C\",y=\"mean_test_score\",label=\"Test\")\nplt.xlabel(\"C\")\nplt.ylabel(\"R2\")","312b5812":"model_cv.best_params_","d0f702cd":"par=PassiveAggressiveRegressor(C=0.001)\npar.fit(X_train,y_train)","5e0456c4":"y_pred=par.predict(X_test)\ny_pred2=par.predict(X_train)\npar_score=r2_score(y_test,y_pred)\nprint(\"Train: \",r2_score(y_train,y_pred2))\nprint(\"Test: \",r2_score(y_test,y_pred))","5acd6f0c":"models = pd.DataFrame({\n    'Model' : ['Linear Regression',\"Ridge Regression\",\"Lasso Regression\",\"Elastic Net Regressor\", 'K Neighbors Regressor','Support Vector Regressor',\n             'Decision Tree Regressor', 'Bagging Regressor', 'Random Forest Regressor', 'Extra Trees Regressor', 'Ada Boost Regressor', 'Gradient Boost Regressor'\n               ,'XGBoost Regressor',\"LGBM Regressor\",\"Cat Boost Regressor\",\"SGD Regressor\",\"Lars\",\"ARDRegressor\",\"Bayesian Ridge Regressor\",\"Huber Regressor\",\"Theil-Sen Regressor\",\"Passive Aggressive Regressor\"],\n    'Score' : [lm_score,ridge_score,lasso_score,elasticnet_score,KNR_score,SVR_score,dtr_score,bgr_score,rfr_score,etr_score,adr_score,gbr_score,xgbr_score,lgbmr_score,cbr_score,sgdr_score,lars_score,ardr_score,br_score,hr_score,tsr_score,par_score]\n})","6da062e2":"models.sort_values(by = 'Score', ascending = False)","05d9cec8":"import plotly.express as px\npx.bar(data_frame = models, x = 'Score', y = 'Model', color = 'Score', template = 'plotly_dark', title = 'Models Comparison')","b4c3cc84":"### Support Vector Regressor","360e16a4":"#### Now we see the age distribution much better","646cca10":"#### Here we see that people identified as \"other\" gender have a bigger score. We see to that male have more score than female. We suppose that higher the score is the more narcissist a pearson is","1a895540":"### ARDR Regression","1ace9e1b":"* If you dont know regularization in ML this article explains it very well https:\/\/towardsdatascience.com\/regularization-in-machine-learning-76441ddcf99a","5dca0495":"## Passive Aggressive Regressor","644a399f":"## Regularization Models","69afbcd8":"### Ada Boost Regressor","0528f722":"# Models","8087b1f6":"### XGBoost Regressor","9630f9b6":"![image.png](attachment:e8acb35e-2f76-419f-a1d0-45fa72314ac1.png)!","58916032":"### Lasso","aba3c93a":"#### Huber uses a regularization parameter alpha and an epsilon value for treating outliers.\n\n#### Here we have a better explanation https:\/\/www.oreilly.com\/library\/view\/machine-learning-algorithms\/9781789347999\/7159b3a9-c481-4227-9641-0b0b59cac4ff.xhtml","7afae2ec":"## Tree Based Models","f57de7ad":"### We clearly see that our best model is Elastic Net followed very very closely by Ridge. But most of our models had practically the same performance","208a8a68":"### Random Forest Regressor","e0a8f4e1":"* We got a pretty good score on our first and most simplier model","d9d1686a":"#### The alpha is the main tuning parameter that regularizes the SSW (sum of squares of weights)","0ebe7e16":"* We see that in this case the score doest no change along the alphas","7b2695e2":"#### Lasso uses the same regularizator (alpha) but the main difference with Ridge is that Lasso uses l1 penalizer while Ridge uses l2 penalizer. Here if you are interested https:\/\/towardsdatascience.com\/l1-and-l2-regularization-methods-ce25e7fc831c\n\n#### One of the main difference between this two is that l1 (Lasso) is shrinks the coeficientes of those features that does not consider important while l2 (Ridge) is able to handle multicollinearity in the data. Although in predicting purposes multi does not affect us","079a09e8":"# Thanks for reading and any feedback would be more than appreciated.","b9a0fd66":"#### The age seems to be distributed pretty equally on genders","b8ad98e0":"# Simple EDA","db52f8c6":"## Non Tunning Models","206e9bda":"### K Neighbors Regressor","2ce165bf":"#### There we have the correlations, where the questions are obviously the most correlated to the score. We didnt do a corr matrix since it will be huge (we have 44 features).","62400fe8":"##### Importing Libraries","6cb460c2":"#### Unlike perceptron, it has its own regularizaion parameter","e941d2e5":"#### As elapse time a column that only measures the time where the indivduals asked the questions, it will not be useful for our prediction task","f6e4ffeb":"#### For better understanding, we just see three models based on the same principal which is the Decision Tree. This graphic shows clearly the main differences between them. Here bagging is not shown since it is similar to Random Forest(RF is a bagging algorithm) with a few differences","01201174":"### Linear Regression","2a7c2a35":"### Naive Bayes Regression Models","6f80daf2":"### We can say that elastic net is a mixture of Ridge and Lasso, since it use both l1 penalizer and l2 penalizer","7fcb1e4e":"#### We se we have more men (1) than female (2)","8a53b1ea":"### Distplot Age","209b3d04":"### Elastic Net","368e4413":"## Data Preprocessing","a025e1b9":"### Theil Sen Regressor","fce90d7b":"### Huber Regressor","7dabb721":"![![image.png](attachment:6e650e09-f166-42ca-a88f-daa2536d6076.png)!","00801c00":"#### Sklearn says--->\"The TheilSenRegressor estimator uses a generalization of the median in multiple dimensions. It is thus robust to multivariate outliers. Note however that the robustness of the estimator decreases quickly with the dimensionality of the problem. It loses its robustness properties and becomes no better than an ordinary least squares in high dimension\"\n\n\n#### It also works well with problems like skewness or heterosedasticity. Outliers too","64557d59":"### Counplot Gender","546633d5":"![![image.png](attachment:54fa1207-a44c-4db3-88b4-d6f58ff9c6bf.png)!","053fd422":"#### Here we have those non-sense ages over 100","db2c4e38":"# Narcissist Prediction","61188d34":"### Decision Tree Regressor","8f1ba748":"# Model Comparison","cd539664":"## Lars","a6f84728":"### Bagging Regressor","9ab215e2":"#### As wee see it works with not only the regularizers of Ridge,Lasso and Elastic. It also can use different penalties","88218146":"#### We call them like that because the next to models are robust to outliers and are able to handle them very well","ea6761ff":"#### We can see we have some aages over  100 and under 14. Which is non-sense data. We will get rid off it later","74de71c2":"### Extra Trees Regressor","0d2f5bca":"* We see in this case that the bigger alpha is the worst the model is since it is regularizing too much. Here the train and thest are one on top another. So our model is generalizing as well as it trains on data","a38c9c5d":"## SGD Regressor","26c68ceb":"#### Here we see ages under 14. The text attached as we say to the data said that ages under 14 are not in the dataset, but they are. So we will take all of this out. Also people with age 0-6 is non-sense","71b02e91":"## Boosting Models","7a8c54c3":"#### No missing values","ba063bc6":"#### Here we see that most questions were answered as two. If we look in the text attached to the data we will see that questions answered with two tend to be more narcissist","236fb7c3":"### Distplot Score","d5739f66":"##### Since naive bayes most common algorithm are used for classification we have some alternatives ARDR or Bayesian Ridge models for regression tasks. They also do not need to be tunned. They both work with l2 penalization (Ridge)\n##### Here is more insight---> https:\/\/www.youtube.com\/watch?v=BkeHgd7GZDc","985cd3b9":"#### In this scatter plot we can se even an age over 500","f8b2b6d5":"#### Lars is a regression algorithm based on Lasso regularized parameters, but it give us the advantage that we do not need to tune any parameters. Making it more faster . Here is a more clear and deep explanation https:\/\/machinelearningmastery.com\/lars-regression-with-python\/","a755d5d7":"#### This is an online ML algorithm which is not very common to see around but thanks to the benefits of correcting himself tends to work well. \n\n#### This video explains on detail the maths behind the algorithm https:\/\/www.youtube.com\/watch?v=TJU8NfDdqNQ&t=154s\n\n\n#### Its called passive and aggressive for what we just said, if the models doest have mitakes it does not correct so it is \"passive\". While when it founds a mistake it correct the Weights, thats why \"aggresive\". It is similar to the perceptron algorithm used for classification","936cb9a2":"#### This model is a modification of the gradient descent called Stochastic Gradient Descent which works much faster than the common gradient descent and gives good results.\n\n#### If you are interested https:\/\/www.google.es\/search?q=stocatisc+gradient&source=lmns&bih=695&biw=1366&hl=es&sa=X&ved=2ahUKEwiSyoyI48rzAhXFspUCHfrLANUQ_AUoAHoECAEQAA","603bca05":"### Pairplot between score,age and gender","36bc4007":"### Bayesian Ridge","db4b6ea8":"### Ridge","e9e53182":"![](http:\/\/)![image.png](attachment:4ae5b3ba-96f3-475e-b784-c1a1afae4fef.png)!","3c313154":"### LGBM Regressor","1df4d24d":"### Cat Boost Regressor","5d3eac08":"* And here we got the best score so far","b26f6f2d":"## Robust Models","81216358":"### Gradient Boost Regressor"}}