{"cell_type":{"6981e0e4":"code","2ccf220f":"code","dc95f7de":"code","d1c667ac":"code","e88d00f0":"code","0e04d821":"code","1e35fa0e":"code","b017cebd":"code","6f9920ca":"code","9c601bba":"code","50b7caaf":"code","592d3aa3":"markdown","50978254":"markdown","d2f1c9a4":"markdown","1f7224cc":"markdown"},"source":{"6981e0e4":"# forked from https:\/\/www.kaggle.com\/ulrich07\/ridge-regression-starter\nimport pandas as pd\nimport numpy as np\nimport os\nfrom sklearn.feature_extraction.text import TfidfVectorizer\nfrom sklearn.model_selection import KFold\nfrom sklearn.linear_model import Ridge\nfrom sklearn.metrics import mean_squared_error\nfrom nltk.corpus import stopwords\n","2ccf220f":"ROOT_DIR = \"..\/input\/commonlitreadabilityprize\"","dc95f7de":"tr = pd.read_csv(f\"{ROOT_DIR}\/train.csv\")\nte = pd.read_csv(f\"{ROOT_DIR}\/test.csv\")","d1c667ac":"#vec = TfidfVectorizer(max_features=1000,stop_words = {'english'}) # V3 0.738\nvec = TfidfVectorizer(max_df=0.8,min_df=0.2,max_features=100000,stop_words = {'english'}) # V4\n\n\nX = vec.fit_transform(tr[\"excerpt\"]).toarray()\nXe = vec.transform(te[\"excerpt\"]).toarray()","e88d00f0":"y = tr[\"target\"].values","0e04d821":"skf = KFold(n_splits=5)\nfolds = list(skf.split(X))","1e35fa0e":"oof = np.zeros(y.shape)\npred = np.zeros((Xe.shape[0],))\nfor idx in range(5):\n    print(\"FOLD: \", idx + 1)\n    tr_idx, val_idx = folds[idx]\n    reg = Ridge()\n    reg.fit(X[tr_idx], y[tr_idx])\n    oof[val_idx] =reg.predict(X[val_idx])\n    pred += reg.predict(Xe) \/ 5\n#===============","b017cebd":"mse = mean_squared_error(y, oof, squared=False)\nprint(\"OOF MSE:\",mse)","6f9920ca":"sub = te[[\"id\"]].copy()\nsub[\"target\"] = pred","9c601bba":"sub.head()","50b7caaf":"sub.to_csv(\"submission.csv\", index=False)","592d3aa3":"## LOADING","50978254":"## PROCESSING","d2f1c9a4":"## TRAINING AND PREDICTION","1f7224cc":"## SUBMISSION"}}