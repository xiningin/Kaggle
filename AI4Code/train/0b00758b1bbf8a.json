{"cell_type":{"8fb5a681":"code","05fbcc63":"code","0657718e":"code","9e6a04bf":"code","dfe78ad5":"code","4c8e7c03":"code","b4e59549":"code","7fa7ca0f":"code","9751581d":"code","6911c9b8":"code","4235fda2":"code","c530a271":"code","70882bcf":"code","0a96a9dc":"code","35c15652":"code","9b815238":"code","91e4a00f":"code","7e2b7232":"code","c4b7195c":"code","62975b34":"code","747ea14a":"code","17b46581":"code","8f76dc0c":"code","a64ea69c":"code","bdcb6f98":"code","0a9d72f1":"code","11f5a334":"code","0ac3e7db":"code","ec61156a":"code","58ef18da":"code","02dbffd0":"code","cf17c070":"code","646a701b":"code","28d5e0d0":"code","d3d526b2":"code","2d52cb36":"code","0aa88667":"markdown"},"source":{"8fb5a681":"import numpy as np \nimport pandas as pd\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n        \nimport tensorflow as tf\nfrom tensorflow import keras\n%matplotlib inline\nimport matplotlib.pyplot as plt\nimport seaborn as sns","05fbcc63":"#train data\ntrain = pd.read_csv('..\/input\/digit-recognizer\/train.csv')\ntrain.head()","0657718e":"#test data\ntest = pd.read_csv('..\/input\/digit-recognizer\/test.csv')\ntest.head()","9e6a04bf":"#train shape\ntrain.shape","dfe78ad5":"#test shape\ntest.shape","4c8e7c03":"x = train.drop(['label'],axis=1)\nX = np.array(x).reshape(len(train),28*28) \/ 255\nX.shape","b4e59549":"y = train['label']\ny.shape","7fa7ca0f":"x_test = np.array(test).reshape(len(test),28*28) \/ 255\nx_test.shape","9751581d":"from sklearn.model_selection import train_test_split\nX_train, X_val, y_train, y_val = train_test_split(X,y,test_size=0.15,random_state=42)","6911c9b8":"X_train.shape, y_train.shape","4235fda2":"X_val.shape, y_val.shape","c530a271":"plt.imshow(X[2].reshape(28,28))","70882bcf":"y[2]","0a96a9dc":"#Simple neural network with no hidden layers\nann =keras.Sequential([\n     keras.layers.Dense(10, input_shape=(784,),activation='sigmoid')\n])\nann.compile(\n             optimizer='adam',\n             loss='sparse_categorical_crossentropy',\n             metrics=['accuracy'])\nann.fit(X_train,y_train,epochs=20)","35c15652":"ann.evaluate(X_val,y_val)","9b815238":"y_predict = ann.predict(X_val)\ny_predict","91e4a00f":"y_predicted_labels = [np.argmax(i) for i in y_predict]\ny_predicted_labels[0]","7e2b7232":"cn = tf.math.confusion_matrix(y_val,y_predicted_labels)\nplt.figure(figsize=(8,6))\nsns.heatmap(cn,annot=True,fmt='d')\nplt.xlabel('Predicted')\nplt.ylabel('Truth')","c4b7195c":"#Using hidden layer\nann_hidden =keras.Sequential([\n    keras.layers.Dense(100, input_shape=(784,), activation='relu'),\n    keras.layers.Dense(10,activation='sigmoid')\n])\nann_hidden.compile(\n             optimizer='adam',\n             loss='sparse_categorical_crossentropy',\n             metrics=['accuracy'])\nann_hidden.fit(X_train,y_train,epochs=20)","62975b34":"ann_hidden.evaluate(X_val,y_val)","747ea14a":"y_predict = ann_hidden.predict(X_val)\ny_predict","17b46581":"y_predicted_labels = [np.argmax(i) for i in y_predict]\ny_predicted_labels[2]","8f76dc0c":"cn = tf.math.confusion_matrix(y_val,y_predicted_labels)\nplt.figure(figsize=(8,6))\nsns.heatmap(cn, annot=True, fmt='d')\nplt.xlabel('Predicted')\nplt.ylabel('Truth')","a64ea69c":"#Flatten Layer\nann_flat = keras.Sequential([\n           keras.layers.Flatten(input_shape=(28,28)),\n           keras.layers.Dense(100, activation='relu'),\n           keras.layers.Dense(10, activation='sigmoid')\n])\nann_flat.compile(\n             optimizer='adam',\n             loss='sparse_categorical_crossentropy',\n             metrics=['accuracy'])\nann_flat.fit(X_train,y_train,epochs=20)","bdcb6f98":"ann_flat.evaluate(X_val,y_val)","0a9d72f1":"y_predict = ann_hidden.predict(x_test)\ny_predict","11f5a334":"y_predicted_labels = [np.argmax(i) for i in y_predict]\ny_predicted_labels[2]","0ac3e7db":"#Using CNN\ncnn = keras.Sequential([\n    keras.layers.Conv2D(30, (3,3), activation='relu', input_shape=(28, 28, 1)),\n    keras.layers.MaxPooling2D((2,2)),\n \n    keras.layers.Flatten(),\n    keras.layers.Dense(100, activation='relu'),\n    keras.layers.Dense(10, activation='sigmoid')\n])","ec61156a":"cnn.compile(\n             optimizer='adam',\n             loss='sparse_categorical_crossentropy',\n             metrics=['accuracy'])\n","58ef18da":"X_train = X_train.reshape(-1,28,28,1)\nX_train.shape","02dbffd0":"x_test = x_test.reshape(-1,28,28,1)\nx_test.shape","cf17c070":"cnn.fit(X_train, y_train, epochs=20)","646a701b":"y_predict_final = cnn.predict(x_test)","28d5e0d0":"y_predicted_labels_final =[np.argmax(i) for i in y_predict_final]","d3d526b2":"image_id = range(1, y_predict_final.shape[0] + 1)\nsubmission_file = pd.DataFrame({'ImageId':image_id, 'Label':y_predicted_labels_final})\nsubmission_file.to_csv('digit_recognizer_submission_final_cnn_ann.csv',index=False)","2d52cb36":"submission_file.head()","0aa88667":"ID:181-35-2475"}}