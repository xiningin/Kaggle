{"cell_type":{"ce849ed6":"code","b42af924":"code","6487a584":"code","bdec7636":"code","9ae5f9d2":"code","62e0d026":"code","fd118dcf":"code","12034adf":"code","95f3f1b1":"code","69672f1c":"code","46a579c5":"code","9a3addfc":"code","5494d4a3":"markdown","c9e936aa":"markdown","8fd8fb66":"markdown","8019d54c":"markdown","5838efc1":"markdown","c34a40e9":"markdown","615538fc":"markdown","93535613":"markdown","699c98a2":"markdown","daf379b3":"markdown","a58f1cfd":"markdown"},"source":{"ce849ed6":"from sklearn.model_selection import GridSearchCV,StratifiedKFold\nfrom sklearn.ensemble import RandomForestClassifier, GradientBoostingClassifier, AdaBoostClassifier\nfrom sklearn.linear_model import LogisticRegression, SGDClassifier\nfrom sklearn.preprocessing import LabelEncoder, OneHotEncoder\nfrom sklearn.linear_model import PassiveAggressiveClassifier\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.compose import ColumnTransformer\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.naive_bayes import GaussianNB\nfrom imblearn.over_sampling import SMOTE\nfrom lightgbm import LGBMClassifier\nfrom collections import Counter\nimport matplotlib.pyplot as plt\nimport pandas_profiling as pp\nfrom sklearn.svm import SVC\nimport plotly.express as px\nimport seaborn as sns\nimport pandas as pd\nimport numpy as np\nimport warnings\n\nwarnings.simplefilter(action='ignore', category=Warning)","b42af924":"df = pd.read_csv(\"\/kaggle\/input\/heart-attack-analysis-prediction-dataset\/heart.csv\")","6487a584":"# Seeing top 5 rows of data\ndf.head()","bdec7636":"# Getting Data Info\ndf.info()","9ae5f9d2":"# Checking Null Values\ndf.isnull().sum()","62e0d026":"# Checking the size of data\ndf.shape","fd118dcf":"# Describing Data\ndf.describe().T.style.bar(\n    subset=['mean'],\n    color='Reds').background_gradient(\n    subset=['std'], cmap='ocean').background_gradient(subset=['50%'], cmap='plasma')","12034adf":"# Data Visualization\ndef visualization(hues,data,features,labels):\n    print(\"\\n---------------DATA VISUALIZATION----------------\\n\")\n    print(\"\\nFor Target Value\\n\")\n    labels.value_counts().plot.pie();\n    plt.show()\n    sns.countplot(x=hues, data=data, palette='viridis');\n    plt.show()\n    #%%\n    print(\"   \\n\\n\\n--------------------------------------------------------------------------- **BOX PLOTS** ----------------------------------------------------------------------------  \\n\\n\\n\")\n    def boxplot(columns,data):\n        fig = px.box(data, x = data[column], color = hues)\n        fig.show()\n    for column in features:\n        boxplot(column,data)\n        \n    print(\"   \\n\\n\\n--------------------------------------------------------------------------- **BAR PLOTS** ----------------------------------------------------------------------------  \\n\\n\\n\")\n\n    def hist_count(column, data):\n        if column in data:\n            f, axes = plt.subplots(1,1,figsize=(15,5))\n            sns.countplot(x=column, data=data)\n            plt.xticks(rotation = 90)\n            plt.suptitle(column, fontsize=20)\n            plt.show()\n        plt.show()\n    for column in df.columns:\n        hist_count(column,df)\n        \n    print(\"   \\n\\n\\n--------------------------------------------------------------------------- **DISTRIBUTION PLOTS** ----------------------------------------------------------------------------  \\n\\n\\n\")\n\n    def boxdistriplot(columnName):\n        if not columnName == hues:\n            sns.distplot(data[columnName][labels == 1],color=\"darkturquoise\", rug=True)\n            sns.distplot(data[columnName][labels == 0], color=\"lightcoral\", rug=True);\n            plt.show()\n            \n    for column in data.columns:\n        boxdistriplot(column)\n    print(\"   \\n\\n\\n--------------------------------------------------------------------------- **CORRELATION & PAIRPLOTS** ----------------------------------------------------------------------------  \\n\\n\\n\")     \n    def correlation_pairplots(data):\n        plt.figure(figsize=(15,15))\n        sns.heatmap(data.corr(),annot = True, cmap = 'Blues')\n        plt.show()\n        print(\"\\n\\n\\n\\n\")\n        sns.pairplot(data,hue = hues, palette='Greens')\n        plt.show()\n    \n    correlation_pairplots(data)\n    \ncol = ['age', 'sex', 'cp', 'trtbps', 'chol', 'fbs', 'restecg', 'thalachh',\n       'exng', 'oldpeak', 'slp', 'caa', 'thall']\nvisualization('output',df,df[col],df['output'])\n","95f3f1b1":"pp.ProfileReport(df, title = \"HEART ATTACK\")","69672f1c":"# Getting Features\ncol = ['age', 'sex', 'cp', 'trtbps', 'chol', 'fbs', 'restecg', 'thalachh',\n       'exng', 'oldpeak', 'slp', 'caa', 'thall']\nx = df[col]\n# Getting Predicting Value\ny = df['output']","46a579c5":"def preprocessing(data,features,labels,test_size = 0.2,random_state =42, tune = 'n',cv_folds = 5):\n    \n    print('Checking if labels or features are categorical! [*]\\n')\n    cat_features=[i for i in features.columns if features.dtypes[i]=='object']\n    if len(cat_features) >= 1 :\n        index = []\n        for i in range(0,len(cat_features)):\n            index.append(features.columns.get_loc(cat_features[i]))\n        print('Features are Categorical\\n')\n        ct = ColumnTransformer(transformers=[('encoder', OneHotEncoder(), index)], remainder='passthrough')\n        print('Encoding Features [*]\\n')\n        features = np.array(ct.fit_transform(features))\n        print('Encoding Features Done [',u'\\u2713',']\\n')\n    if labels.dtype == 'O':\n        le = LabelEncoder()\n        print('Labels are Categorical [*] \\n')\n        print('Encoding Labels \\n')\n        labels = le.fit_transform(labels)\n        print('Encoding Labels Done [',u'\\u2713',']\\n')\n    else:\n        print('Features and labels are not categorical [',u'\\u2713',']\\n')\n        \n    ## SMOTE ---------------------------------------------------------------------\n    print('Applying SMOTE [*]\\n')\n    \n    sm=SMOTE(k_neighbors=4)\n    features,labels=sm.fit_resample(features,labels)\n    print('SMOTE Done [',u'\\u2713',']\\n')\n    \n    ## Splitting ---------------------------------------------------------------------\n    print('Splitting Data into Train and Validation Sets [*]\\n')\n    \n    x_train, x_test, y_train, y_test = train_test_split(features, labels, test_size= test_size, random_state= random_state)\n    print('Splitting Done [',u'\\u2713',']\\n')\n    \n    ## Scaling ---------------------------------------------------------------------\n    print('Scaling Training and Test Sets [*]\\n')\n    \n    sc = StandardScaler()\n    X_train = sc.fit_transform(x_train)\n    X_val = sc.transform(x_test)\n    print('Scaling Done [',u'\\u2713',']\\n')\n    \n    print('Training All Basic Classifiers on Training Set [*] \\n')\n    \n    parameters_svm= [\n    {'kernel': ['rbf'], 'gamma': [0.1, 0.5, 0.9, 1],\n        'C': np.logspace(-4, 4, 5)},\n    ]\n    parameters_lin = [{\n    'penalty': ['l1', 'l2', ],\n    'solver': ['newton-cg', 'liblinear', ],\n    'C': np.logspace(-4, 4, 5),\n    }]\n    parameters_knn = [{\n    'n_neighbors': list(range(0, 11)),\n    'weights': ['uniform', 'distance'],\n    'algorithm': ['auto', 'kd_tree', 'brute'],\n    }]\n    parameters_dt = [{\n    'criterion': ['gini', 'entropy'],\n    'splitter': ['best', 'random'],\n    'max_depth': [4,  6,  8,  10,  12,  20,  40, 70],\n\n    }]\n    parameters_rfc = [{\n    'criterion': ['gini', 'entropy'],\n    'n_estimators': [100, 300, 500, 750, 1000],\n    'max_features': [2, 3],\n    }]\n    parameters_xgb = [{\n    'max_depth': [4,  6,  8,  10],\n    'learning_rate': [0.3, 0.1],\n    }]\n    parameters_lgbm =  {\n    'learning_rate': [0.005, 0.01],\n    'n_estimators': [8,16,24],\n    'boosting_type' : ['gbdt', 'dart'],\n    'objective' : ['binary'],\n    }\n    paramters_pac = {\n        'C': np.logspace(-4, 4, 20)},\n    \n    \n    param_nb={}\n    parameters_ada={\n            'learning_rate': [0.005, 0.01],\n            'n_estimators': [8,16,24],\n    }\n    paramters_sgdc = [{\n    'penalty': ['l2', 'l1', 'elasticnet'],\n    'loss': ['hinge', 'log'],\n    'alpha':np.logspace(-4, 4, 20),\n    }]\n    models =[(\"LR\", LogisticRegression(), parameters_lin),(\"SVC\", SVC(),parameters_svm),('KNN',KNeighborsClassifier(),parameters_knn),\n    (\"DTC\", DecisionTreeClassifier(),parameters_dt),(\"GNB\", GaussianNB(), param_nb),(\"SGDC\", SGDClassifier(), paramters_sgdc),('RF',RandomForestClassifier(),parameters_rfc),\n    ('ADA',AdaBoostClassifier(),parameters_ada),('XGB',GradientBoostingClassifier(),parameters_xgb),('LGBN', LGBMClassifier(),parameters_lgbm),\n    ('PAC',PassiveAggressiveClassifier(),paramters_pac)]\n\n    results = []\n    names = []\n    finalResults = []\n    accres = []\n\n    for name,model, param in models:\n        \n        model.fit(x_train, y_train)\n        model_results = model.predict(x_test)\n        accuracy = accuracy_score(y_test, model_results)\n        print('Validation Accuracy is :',accuracy)\n        print('Applying K-Fold Cross validation on Model {}[*]'.format(name))\n        accuracies = cross_val_score(estimator=model, X=x_train, y=y_train, cv=cv_folds, scoring='accuracy')\n        print(\"Accuracy: {:.2f} %\".format(accuracies.mean()*100))\n        acc = accuracies.mean()*100\n        print(\"Standard Deviation: {:.2f} %\".format(accuracies.std()*100)) \n        results.append(acc)\n        names.append(name)\n        accres.append((name,acc))\n        if tune == 'y' and not name == 'GNB':\n            print('Applying Grid Search Cross validation for model {} []\\n'.format(name))\n            cv_params = param\n            grid_search = GridSearchCV(\n            estimator=model,\n            param_grid=cv_params,\n            scoring='accuracy',\n            cv=cv_folds,\n            n_jobs=-1,\n            verbose=4,\n                )\n            grid_search.fit(X_train, y_train)\n            best_accuracy = grid_search.best_score_\n            best_parameters = grid_search.best_params_\n            print(\"Best Accuracy for model {}: {:.2f} %\".format(name,best_accuracy*100))\n            print(\"Best Parameters: for model {}\".format(name), best_parameters)\n            print('Applying Grid Search Cross validation Done[',u'\\u2713',']\\n')\n            \n        print('Training Compeleted Showing Predictions [',u'\\u2713','] \\n')\n    accres.sort(key=lambda k:k[1],reverse=True)\n    print(\"\\n The Accuracy of the Models Are:\\n \")\n    tab = pd.DataFrame(accres)\n    print(tab)\n    sns.barplot(x=tab[1], y=tab[0], palette='mako');\n    print(\"\\n\\nModel With Highest Accuracy is: \\n\",accres[0],'\\n\\n')","9a3addfc":"preprocessing(df,x,y)","5494d4a3":"<div style=\"\n           border-radius:20px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:1px;\n           font-family:cursive\n           \">\n<h1 style=\"text-align:center;\">HEART ATTACK PREDICTION<\/h1>\n<center><img src = \"https:\/\/media4.giphy.com\/media\/xULW8GKlriYjiarBK0\/200w.webp?cid=ecf05e47to7pfm77quy6fmvm97d09oh9nwvjdkptqgc075yg&rid=200w.webp&ct=s\"><\/center>\n   \n<h2> HEART <\/h2>\n<p>\nThe heart is a muscular organ in most animals, which pumps blood through the blood vessels of the circulatory system. The pumped blood carries oxygen and nutrients to the body, while carrying metabolic waste such as carbon dioxide to the lungs. In humans, the heart is approximately the size of a closed fist and is located between the lungs, in the middle compartment of the chest.\n        \nIn humans, other mammals, and birds, the heart is divided into four chambers: upper left and right atria and lower left and right ventricles. Commonly the right atrium and ventricle are referred together as the right heart and their left counterparts as the left heart. Fish, in contrast, have two chambers, an atrium and a ventricle, while reptiles have three chambers. In a healthy heart blood flows one way through the heart due to heart valves, which prevent backflow. The heart is enclosed in a protective sac, the pericardium, which also contains a small amount of fluid. The wall of the heart is made up of three layers: epicardium, myocardium, and endocardium.\n        \nThe heart pumps blood with a rhythm determined by a group of pacemaking cells in the sinoatrial node. These generate a current that causes contraction of the heart, traveling through the atrioventricular node and along the conduction system of the heart. The heart receives blood low in oxygen from the systemic circulation, which enters the right atrium from the superior and inferior venae cavae and passes to the right ventricle. From here it is pumped into the pulmonary circulation, through the lungs where it receives oxygen and gives off carbon dioxide. Oxygenated blood then returns to the left atrium, passes through the left ventricle and is pumped out through the aorta to the systemic circulation\u2212where the oxygen is used and metabolized to carbon dioxide. The heart beats at a resting rate close to 72 beats per minute. Exercise temporarily increases the rate, but lowers resting heart rate in the long term, and is good for heart health.\n<\/p>\n<h2> HEART ATTACK<\/h2>\n<img src = \"https:\/\/media0.giphy.com\/media\/vjGyYSsF765wc\/giphy.webp?cid=ecf05e47ibjlsevhhkpkkq96k7s3w6vw5athjdzob78vpwrt&rid=giphy.webp&ct=g\">\n<p>\n\nA heart attack is a medical emergency. A heart attack usually occurs when a blood clot blocks blood flow to the heart. Without blood, tissue loses oxygen and dies.\n    \nA heart attack occurs when the flow of blood to the heart is blocked. The blockage is most often a buildup of fat, cholesterol and other substances, which form a plaque in the arteries that feed the heart.\n    \nSometimes, a plaque can rupture and form a clot that blocks blood flow. The interrupted blood flow can damage or destroy part of the heart muscle.\n\nA heart attack, also called a myocardial infarction, can be fatal, but treatment has improved dramatically over the years. It's crucial to call 911 or emergency medical help if you think you might be having a heart attack.\n<\/p>\n<h2> Risk Factor<\/h2>\n\n<p>\n    Certain factors contribute to the unwanted buildup of fatty deposits (atherosclerosis) that narrows arteries throughout your body. You can improve or eliminate many of these risk factors to reduce your chances of having a first or another heart attack.\n\n<b>Heart attack risk factors include:<\/b>\n\nAge:- Men age 45 or older and women age 55 or older are more likely to have a heart attack than are younger men and women.\nTobacco. This includes smoking and long-term exposure to secondhand smoke.\n    \nHigh blood pressure:- Over time, high blood pressure can damage arteries that lead to your heart. High blood pressure that occurs with other conditions, such as obesity, high cholesterol or diabetes, increases your risk even more.High blood cholesterol or triglyceride levels. A high level of low-density lipoprotein (LDL) cholesterol (\"bad\" cholesterol) is most likely to narrow arteries. A high level of triglycerides, a type of blood fat related to your diet, also increases your risk of a heart attack. However, a high level of high-density lipoprotein (HDL) cholesterol (\"good\" cholesterol) may lower your risk.\n    \nObesity:- Obesity is linked with high blood cholesterol levels, high triglyceride levels, high blood pressure and diabetes. Losing just 10% of your body weight can lower this risk.\n    \nDiabetes:- Not producing enough of a hormone secreted by your pancreas (insulin) or not responding to insulin properly causes your body's blood sugar levels to rise, increasing your risk of a heart attack.\n    \nMetabolic syndrome:- This syndrome occurs when you have obesity, high blood pressure and high blood sugar. Having metabolic syndrome makes you twice as likely to develop heart disease than if you don't have it.\n    \nFamily history of heart attacks:- If your siblings, parents or grandparents have had early heart attacks (by age 55 for males and by age 65 for females), you might be at increased risk.\n    \nLack of physical activity:- Being inactive contributes to high blood cholesterol levels and obesity. People who exercise regularly have better heart health, including lower blood pressure.\n    \nStress:-You might respond to stress in ways that can increase your risk of a heart attack.\n    \nIllicit drug use:- Using stimulant drugs, such as cocaine or amphetamines, can trigger a spasm of your coronary arteries that can cause a heart attack.\n    \nA history of preeclampsia:- This condition causes high blood pressure during pregnancy and increases the lifetime risk of heart disease.\n    \nAn autoimmune condition:- Having a condition such as rheumatoid arthritis or lupus can increase your risk of a heart attack.\n<\/p>\n    \n<h2> Symptoms Of Heart Attack <\/h2>\n<center><img src = \"https:\/\/www.cdc.gov\/heartdisease\/images\/HA-signs-symptoms-social2.png\"><\/center>\n<br>\n<left><h2>Common Treatments:<\/h2><\/left>\n<p>\nAngioplasty: Special tubing with an attached deflated balloon is threaded up to the coronary arteries.\n    \nAngioplasty, Laser: Similar to angioplasty except that the catheter has a laser tip that opens the blocked artery.\n    \nArtificial heart valve surgery: Replaces an abnormal or diseased heart valve with a healthy one.\n    \nAtherectomy: Similar to angioplasty except that the catheter has a rotating shaver on its tip to cut away plaque from the artery.\n    \nBypass surgery: Treats blocked heart arteries by creating new passages for blood to flow to your heart muscle.\n    \nCardiomyoplasty: An experimental procedure in which skeletal muscles are taken from a patient\u2019s back or abdomen.\n    \nHeart transplant: Removes a diseased heart and replaces it with a donated healthy human heart.\n    \nMinimally invasive heart surgery: An alternative to standard bypass surgery.\n    \nRadiofrequency ablation: A catheter with an electrode at its tip is guided through the veins to the heart muscle to destroy carefully selected heart muscle cells in a very small area.\n    \nStent procedure: A stent is a wire mesh tube used to prop open an artery during angioplasty.\n    \nTransmyocardial revascularization (TMR): A laser is used to drill a series of holes from the outside of the heart into the heart\u2019s pumping chamber.\n<\/p>\n<center><img src = \"https:\/\/i0.wp.com\/myotakuworld.com\/wp-content\/uploads\/2020\/06\/cute-anime-girls-cover-1.jpg?fit=800%2C450&ssl=1\"><\/center>\n<\/div>","c9e936aa":"**Pandas Profiling Report**","8fd8fb66":"> As we can see there are no empty values in the data....","8019d54c":"<div style=\"color:white;\n           display:fill;\n           border-radius:30px;\n           font-size:100%;\n           font-family:cursive;\n           letter-spacing:2px;\n           background-color:pink;\n           color:Purple;\n           font-family:cursive\n           \">\n<h1 style=\"text-align:center;\">Summary<\/h1>\n<h4 style=\"text-align:center;\"> As we can see that **Linear Regression** was the Best Here with the accuracy of **84.84%** <\/h4>   \n<center><img src = \"https:\/\/media0.giphy.com\/media\/xT5LMq4GterR0z4oV2\/200.webp?cid=ecf05e47sa46hf86h06wcspg7p5toexcj5v93jvkvsglz1dj&rid=200.webp&ct=g\">\n\n<\/div>\n","5838efc1":"<div style=\"color:white;\n           display:fill;\n           border-radius:30px;\n           font-size:100%;\n           font-family:cursive;\n           letter-spacing:2px;\n           background-color:pink;\n           color:Purple;\n           font-family:cursive\n           \">\n<h1 style=\"text-align:center;\">Data Preprocessing & Data Modelling<\/h1>\n\n<\/div>\n","c34a40e9":">Rows = 303\n\n>Columns = 14","615538fc":"<div style=\"color:white;\n           display:fill;\n           border-radius:30px;\n           font-size:100%;\n           font-family:cursive;\n           letter-spacing:2px;\n           background-color:pink;\n           color:Purple;\n           font-family:cursive\n           \">\n<h1 style=\"text-align:center;\">Data Visualizations<\/h1>\n\n<\/div>\n","93535613":"<div style=\"color:white;\n           display:fill;\n           border-radius:30px;\n           font-size:100%;\n           font-family:cursive;\n           letter-spacing:2px;\n           background-color:pink;\n           color:Purple;\n           font-family:cursive\n           \">\n<h1 style=\"text-align:center;\">Loading The Data<\/h1>\n\n<\/div>\n","699c98a2":"<div style=\"color:white;\n           display:fill;\n           border-radius:30px;\n           font-size:100%;\n           font-family:cursive;\n           letter-spacing:2px;\n           background-color:pink;\n           color:Purple;\n           font-family:cursive\n           \">\n<h1 style=\"text-align:center;\">Importing Liberaries<\/h1>\n<\/div>","daf379b3":"# Data Desctiprion\n<h4>\n* Age : Age of the patient\n\n* Sex : Sex of the patient\n\n* exang: exercise induced angina (1 = yes; 0 = no)\n\n* ca: number of major vessels (0-3)\n\n* cp : Chest Pain type chest pain type\n\n  * Value 1: typical angina\n  * Value 2: atypical angina\n  * Value 3: non-anginal pain\n  * Value 4: asymptomatic\n\n* trtbps : resting blood pressure (in mm Hg)\n\n* chol : cholestoral in mg\/dl fetched via BMI sensor\n\n* fbs : (fasting blood sugar > 120 mg\/dl) (1 = true; 0 = false)\n\n* rest_ecg : resting electrocardiographic results\n\n   * Value 0: normal\n   * Value 1: having ST-T wave abnormality (T wave inversions and\/or ST elevation or depression of > 0.05 mV)\n   * Value 2: showing probable or definite left ventricular hypertrophy by Estes' criteria\n\n\n* thalach : maximum heart rate achieved\n\n* target : 0= less chance of heart attack 1= more chance of heart attack\n<\/h4>","a58f1cfd":"<div style=\"color:white;\n           display:fill;\n           border-radius:30px;\n           font-size:100%;\n           font-family:cursive;\n           letter-spacing:2px;\n           background-color:pink;\n           color:Purple;\n           font-family:cursive\n           \">\n<h1 style=\"text-align:center;\">Exploratory Data Analysis<\/h1>\n\n<\/div>\n"}}