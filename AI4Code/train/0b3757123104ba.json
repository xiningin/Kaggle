{"cell_type":{"13b57096":"code","512a39ef":"code","eb088e8a":"code","72aee94f":"code","f0cabc15":"code","9aaabd4e":"code","78e8ca3e":"code","4e8cbfe1":"code","aecfeff1":"code","c49f736b":"code","baee6a83":"code","5c118061":"code","00f99bf9":"code","ece33818":"code","67f92e67":"code","23bb7017":"code","0b9460e2":"code","3921e85c":"code","e6b62524":"code","fcde3c3d":"code","3573d137":"code","7bd96e01":"code","68ee9fd3":"code","1a5ebded":"code","e300bc3b":"code","30376ba0":"code","a16425ae":"code","2cec1cb0":"code","b18bc0fc":"code","faa6317c":"code","e308cb33":"code","751eb4e8":"code","2304d1f5":"code","95317837":"code","dcf09b97":"code","fbcf3806":"code","6b003efe":"code","f7631b9e":"code","cb58d0fd":"code","f86437ad":"code","09d2fd74":"code","10602c82":"code","7b1a2258":"code","24e60783":"code","1176ec6b":"code","a22c2a03":"markdown"},"source":{"13b57096":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","512a39ef":"import pandas as pd\ntrain = pd.read_excel('..\/input\/food-cost\/Data_Train.xlsx')\ntest = pd.read_excel('..\/input\/food-cost\/Data_Test.xlsx')\nsubmission = pd.read_excel('..\/input\/food-cost-submission\/Sample_submission.xlsx')\n","eb088e8a":"train[\"source\"] = \"train\"\ntest[\"source\"] = \"test\"","72aee94f":"df = pd.concat([train,test])","f0cabc15":"df.info()","9aaabd4e":"#Investigating the entire dataset first\ndf.duplicated().sum()","78e8ca3e":"df= df.drop_duplicates()","4e8cbfe1":"df.isna().sum()","aecfeff1":"# Data exploration for CITY\n# CITY has 147 null values\n#combining City and locality\ndf['Location']=df['CITY']+' '+df['LOCALITY']\ndf.drop(columns=['CITY','LOCALITY'])","c49f736b":"df.dropna(subset=['Location'],inplace=True)","baee6a83":"\nfrom fuzzywuzzy import process\n \nnames_array=[]\ndef match_names(wrong_names,correct_names):\n    for row in wrong_names:\n        x=process.extractOne(row, correct_names)\n        if x[1]<60:\n            names_array.append('Others')\n        else:\n            names_array.append(x[0])\n    return names_array\n  \n#Wrong country names dataset\n\ncorrect_names=['Bangalore','Thane',\n'Hyderabad','Andheri',\n'Delhi', 'Kerala',\n'Chennai', 'Bandra',\n'Mumbai', 'Telangana',\n'Kochi', \n'Noida', \n'Gurgaon', 'Ernakulam',\n'Faridabad', 'Ghaziabad',\n'Secunderabad' ]\nname_match=match_names(df.Location,correct_names)    \n\nprint(len(names_array))\ndf['Location']=names_array","5c118061":"cuisines_list=[]\nfor row in df['CUISINES']:\n    cuisines_list.append(list(row.split(',')))\n\ndf['CUISINES']=cuisines_list","00f99bf9":"df['CUISINES'].isna().sum()","ece33818":"df_cuisines=df['CUISINES'].apply(lambda x: pd.Series(1, x))","67f92e67":"title_list=[]\nfor row in df['TITLE']:\n    title_list.append(list(row.split(',')))\ndf['TITLE']=title_list","23bb7017":"df_title=df['TITLE'].apply(lambda x: pd.Series(1, x))","0b9460e2":"df_title.head()","3921e85c":"# cleaning time - pending","e6b62524":"df[df['RATING'].isna()]","fcde3c3d":"df[\"RATING\"] = df.groupby(\"CITY\").RATING.transform(lambda x : x.fillna(x.mode()[0]))","3573d137":"df['RATING']=df['RATING'].str.extract('(\\d+)').astype(float)","7bd96e01":"df['VOTES'].isna().sum()","68ee9fd3":"df.VOTES.fillna('0',inplace=True)\ndf['VOTES']=df['VOTES'].str.extract('(\\d+)').astype(float)","1a5ebded":"df.drop(columns='CITY',inplace=True)\ndf.drop(columns='LOCALITY',inplace=True)\ndf.drop(columns='CUISINES',inplace=True)","e300bc3b":"#df.drop(columns='CUISINES',inplace=True)\n#df.drop(columns='CUISINES++',inplace=True)\n#df.drop(columns='Location++',inplace=True)\n#df.drop(columns='TITLE++',inplace=True)","30376ba0":"df_City=pd.get_dummies(df['Location'])\ndf.drop(columns='Location',inplace=True)\ndf_City.head()","a16425ae":"df = pd.concat([df,df_City,df_cuisines,df_title], axis=1)","2cec1cb0":"df.drop(columns='TITLE',inplace=True)","b18bc0fc":"df_column_category = df.select_dtypes(exclude=np.number).columns\ndf_column_category","faa6317c":"#df.drop(columns='City found',inplace=True)\ndf.drop(columns='TIME',inplace=True)","e308cb33":"df.fillna(0,inplace=True)","751eb4e8":"\ntrain_final = df[df.source==\"train\"]\ntest_final = df[df.source==\"test\"]","2304d1f5":"train_final.shape","95317837":"train_final.drop(columns=[\"source\"],inplace=True)","dcf09b97":"test_final.drop(columns=[\"source\",'COST'],inplace=True)","fbcf3806":"train_X = train_final.drop(columns=[\"COST\",'RESTAURANT_ID'])","6b003efe":"train_Y = train_final[\"COST\"]","f7631b9e":"test_X = test_final.drop(columns=[\"RESTAURANT_ID\"])","cb58d0fd":"train_X.fillna(0,inplace=True)\ntrain_X.isna().sum()","f86437ad":"from sklearn.linear_model import LinearRegression\nmodel = LinearRegression()\nmodel.fit(train_X, train_Y)\ndtrain_predictions = model.predict(train_X)","09d2fd74":"from sklearn.model_selection import cross_val_score\na = cross_val_score(model, train_X, train_Y, cv=5, scoring='neg_mean_squared_error')","10602c82":"#Print model report:\nfrom sklearn.metrics import mean_absolute_error,mean_squared_error,mean_squared_log_error, r2_score\nprint(\"\\nModel Report\")\nprint(\"RMSE : %.4g\" % np.sqrt(mean_squared_error(train_Y.values, dtrain_predictions)))\n    \n#Predict on testing data:\ntest_X.fillna(0,inplace=True)\ntest_final[\"res_linear\"] =  model.predict(test_X)","7b1a2258":"print('r2 train',r2_score(train_Y,dtrain_predictions))\n#print('r2 test',r2_score(test_y,test_predict))","24e60783":"Linear_submission = test_final[[\"RESTAURANT_ID\",\"res_linear\"]]","1176ec6b":"Linear_submission.head(20)","a22c2a03":"Having null values in CITY,LOCALITY,RATING,VOTES\n"}}