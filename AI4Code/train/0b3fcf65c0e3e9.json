{"cell_type":{"97dcb0ff":"code","735393b3":"code","84f0ef2a":"code","249b58ae":"code","25a08cb6":"code","a508a1ea":"code","8ed254f7":"code","268e5be4":"code","d2f64a63":"code","a90b148b":"code","e24ee7b2":"code","5436abab":"code","e3ab4230":"code","e20bfddc":"code","f5fc9fd4":"code","643fdd5b":"code","7cc73ca1":"code","bbd08bed":"code","44121dfb":"code","c25ccc57":"code","161eaf66":"code","c3851f63":"code","0e50f302":"code","ff70067e":"code","ce501cf3":"code","370d7d88":"code","f837fb09":"code","e8ae5ed4":"code","5ec81574":"code","75e1a756":"code","29a858e0":"code","dc4d2c9a":"code","8634b2cd":"code","88b0adbf":"code","c6b6d1b2":"code","96c7df86":"code","18d514f3":"code","3bb4b465":"code","cc59e05d":"code","3f214df8":"markdown","4ba3961e":"markdown","7cd5ad6f":"markdown","404df460":"markdown","ec9f02c0":"markdown","dc4d9b5e":"markdown","52dc42f4":"markdown","44dd4040":"markdown","90f3fd8e":"markdown","58b4ed6e":"markdown","502281d7":"markdown","1b598af1":"markdown","6d40ab19":"markdown","f161c4f2":"markdown","8afe09d1":"markdown","7f535058":"markdown","9ba8ca53":"markdown","4c1a42be":"markdown","09719186":"markdown","43e4efc1":"markdown","48ae7802":"markdown","e3e1cdc6":"markdown","d9cac02b":"markdown","7c313b91":"markdown","cec4eafb":"markdown","bcccfe82":"markdown","8ca251b0":"markdown"},"source":{"97dcb0ff":"import pandas as pd\nimport numpy as np \nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline\n\nimport warnings\nwarnings.filterwarnings('ignore')\n\nfrom statsmodels.tsa.stattools import adfuller\nfrom statsmodels.tsa.seasonal import seasonal_decompose\nfrom statsmodels.tsa.stattools import acf, pacf\nfrom statsmodels.tsa.arima_model import ARIMA","735393b3":"weather=pd.read_csv('..\/input\/delhi-weather-dataset\/testset.csv')","84f0ef2a":"weather.head(5)","249b58ae":"weather.tail(5)","25a08cb6":"weather_df = weather[['datetime_utc', ' _conds', ' _hum', ' _tempm']]","a508a1ea":"weather_df.head()","8ed254f7":"weather_df = weather_df.rename(columns={' _conds': 'condition', ' _hum': 'humidity', ' _tempm': 'temperature'})","268e5be4":"weather_df.head()","d2f64a63":"weather_df.shape","a90b148b":"weather_df.info()","e24ee7b2":"weather_df.duplicated().sum()","5436abab":"from datetime import datetime\nweather_df['datetime_utc']=pd.to_datetime(weather_df['datetime_utc'],infer_datetime_format=True)","e3ab4230":"weather_df.info()\n","e20bfddc":"weather_df = weather_df.set_index('datetime_utc',inplace=False)","f5fc9fd4":"weather_df.head()","643fdd5b":"sns.heatmap(weather_df.isnull(), cbar=False)","7cc73ca1":"import missingno as msno\nmsno.matrix(weather_df)","bbd08bed":"msno.heatmap(weather_df)","44121dfb":"weather_df.ffill(inplace=True)","c25ccc57":"weather_df.isnull().sum()","161eaf66":"weather_df['condition'].value_counts().sort_index()","c3851f63":"plt.figure(figsize=(10,5))\nplt.title('Delhi Weather Condition', fontsize=14)\nplt.xlabel(\"Weather\", fontsize=12)\nplt.ylabel(\"Count\", fontsize=12)\nplt.xticks(rotation=90, fontsize=12)\nplt.yticks(fontsize=12)\nsns.countplot(x = \"condition\", data = weather_df, palette='magma', order=weather_df[\"condition\"].value_counts().index)","0e50f302":"weather_time_df = weather_df[['temperature']]\nweather_time_df.head()","ff70067e":"weather_time_df=weather_time_df.resample('D').mean()","ce501cf3":"weather_time_df.isna().sum()","370d7d88":"weather_time_df.fillna(weather_df['temperature'].mean(),inplace=True)","f837fb09":"weather_time_df.isna().sum()","e8ae5ed4":"weather_time_df.head()","5ec81574":"weather_time_df.tail()","75e1a756":"plt.figure(figsize=(10,5))\nplt.xlabel('Date')\nplt.ylabel('Temperature')\nplt.plot(weather_time_df)","29a858e0":"def test_stationarity(timeseries):\n    \n    #Determine rolling statistics\n    movingAverage = timeseries.rolling(window=12).mean()\n    movingSTD = timeseries.rolling(window=12).std()\n    \n    #Plot rolling statistics\n    plt.figure(figsize=(10,5))\n    plt.plot(timeseries, color='blue', label='Original')\n    plt.plot(movingAverage, color='red', label='Rolling Mean')\n    plt.plot(movingSTD, color='black', label='Rolling Std')\n    plt.legend(loc='best')\n    plt.title('Rolling Mean & Standard Deviation')\n    plt.show(block=False)\n    \n    #Perform Dickey\u2013Fuller test:\n    print('Results of Dickey Fuller Test:')\n    weather_test = adfuller(timeseries['temperature'], autolag='AIC')\n    dfoutput = pd.Series(weather_test[0:4], index=['Test Statistic','p-value','#Lags Used','Number of Observations Used'])\n    for key,value in weather_test[4].items():\n        dfoutput['Critical Value (%s)'%key] = value\n    print(dfoutput)","dc4d2c9a":"test_stationarity(weather_time_df)","8634b2cd":"test_stationarity(weather_time_df)","88b0adbf":"lag_acf = acf(weather_time_df.diff().dropna().values, nlags=20)\nlag_pacf = pacf(weather_time_df.diff().dropna().values, nlags=20, method='ols')","c6b6d1b2":"plt.subplot(121)\nplt.plot(lag_acf)\nplt.axhline(y=0, linestyle='--', color='gray')\nplt.axhline(y=-1.96\/np.sqrt(len(weather_time_df.diff().values)), linestyle='--', color='gray')\nplt.axhline(y=1.96\/np.sqrt(len(weather_time_df.diff().values)), linestyle='--', color='gray')\nplt.title('Autocorrelation Function')            \n\n#Plot PACF\nplt.subplot(122)\nplt.plot(lag_pacf)\nplt.axhline(y=0, linestyle='--', color='gray')\nplt.axhline(y=-1.96\/np.sqrt(len(weather_time_df.diff().values)), linestyle='--', color='gray')\nplt.axhline(y=1.96\/np.sqrt(len(weather_time_df.diff().values)), linestyle='--', color='gray')\nplt.title('Partial Autocorrelation Function')\n            \nplt.tight_layout()","96c7df86":"model = ARIMA(weather_time_df, order=(1,0,1))\nresults_ARIMA = model.fit(disp=-1)\nplt.plot(weather_time_df.diff())\nplt.plot(results_ARIMA.fittedvalues, color='red')\nplt.title('RSS: %.4f'%sum((results_ARIMA.fittedvalues - weather_time_df.diff()['temperature'])**2))\nprint('Plotting ARIMA model')","18d514f3":"predictions_ARIMA_diff = pd.Series(results_ARIMA.fittedvalues, copy=True)\npredictions_ARIMA_diff.head()","3bb4b465":"predictions_ARIMA_diff_cumsum = predictions_ARIMA_diff.cumsum()\npredictions_ARIMA_diff_cumsum.head()\n","cc59e05d":"plt.figure(figsize=(10,5))\nplt.plot(weather_time_df)\nplt.plot(predictions_ARIMA_diff)","3f214df8":"**Let's plot the data**","4ba3961e":"Let's convert datatype of datetime column","7cd5ad6f":"Let's rename few columns for our better understanding","404df460":"Here we are going to consider only few of the columns which seems important for us to perform some basic EDA and time series prediction's point of view.","ec9f02c0":"From the above graph the mean values are correlating with the actual values and the standard deviation does not seem to vary. Also, Test statistic is less than Critical Values, so we already have STATIONARY Time Series. So our 'd' value will become 0 in ARIMA Model.","dc4d9b5e":"From the above graph the mean values are correlating with the actual values and the standard deviation does not seem to vary.","52dc42f4":"We have to predict the temperature of Delhi, so, let's drop condition & humidity column.","44dd4040":"Let's analyze the missing values now","90f3fd8e":"Plotting ACF & PACF","58b4ed6e":"So, here we have cleaned the data.","502281d7":"From the ACF graph, we can see that curve touches y=0.0 line at x=1. Thus, from theory, Q = 1 From the PACF graph, we see that curve touches y=0.0 line at x=1. Thus, from theory, P = 1","1b598af1":"AR+I+MA = ARIMA Model\nMaking order = (2,1,2)","6d40ab19":"# **Time Series Analysis**","f161c4f2":"**From Data Analysis:\n**\n\nExtracted data contains 100990 records and 4 columns.\n\nThere are null records present in condition, humidity and temperature columns. We'll need to remove them.\n\nWe need to convert datatype of datetime_utc column.\n\nWe will need to index datetime_utc column.\n\nAlso, there are no duplicate values are present","8afe09d1":"**Data Analysis**","7f535058":"**Exploratory Data Analysis**","9ba8ca53":"Predictions","4c1a42be":"Loading the basic libraries","09719186":"From the above graph the mean values are correlating with the actual values and the standard deviation does not seem to vary.","43e4efc1":"Look at the above plot, it is really so bad that mostly Delhi has Hazy and Smoky weather conditions, it shows the level of pollution city has.","48ae7802":"Let's check first 5 and last 5 records of data set","e3e1cdc6":"# Delhi Weather Forecasting\n\n\nAs the capital city of India, Delhi is subject to a high level of pollution year-round. The levels of fine and coarse particulate matter, known respectively as PM2.5 and PM10 are often prevalent in the air, as well as other forms of pollutants and toxic chemicals finding their way into the atmosphere, each with their own detrimental effects on human health. There are an estimated 30.2 million people registered living in Delhi as of 2020, all squeezed into a relatively small area of 1,484km\u00b2, giving it an extremely high population density.\n\nHere in the notebook today, we are going to forecast Delhi Weather with given sample data.","d9cac02b":"So above plots shows that we do have some seasonality but there is no trend. Let's check rolling statistics. Also, perform the ADCF test(Dickey-Fuller Test)","7c313b91":"From above plot, we can see that our predicted forecasts are very close to the real time series values. It also indicates a fairly accurate model.","cec4eafb":"Not many values are missing, but it will still be great to fill the missing ones instead of removing entire row.\n\n","bcccfe82":"Loading Delhi Weather data set","8ca251b0":"Now, let's set datetime_utc column as index"}}