{"cell_type":{"e873fc02":"code","cc3eb44f":"code","e45f59a7":"code","0d53e6e8":"code","86db3202":"code","49638ed5":"code","4ee68b69":"code","067b819d":"code","8a91d95e":"code","953a40b3":"code","7ce8f826":"code","781fb6d2":"code","451ecc15":"code","3e209612":"code","03625b65":"code","c9e76ec9":"code","7c3a1ad1":"code","68b0ed14":"code","63670aa1":"code","91d5fe86":"code","50a5cd2b":"code","2d220a05":"code","c43a40d5":"code","dde6f1c3":"code","e21faf7e":"code","17894f14":"code","96dcf9b9":"code","edf76bc9":"code","9e7a4c85":"code","991cb529":"code","f83c7673":"code","d1044376":"code","8e81df50":"code","728d552e":"code","f0e3a93a":"code","333a52f7":"code","bf5e40d4":"code","f67789b6":"code","c1008cce":"code","ee5dd9e2":"code","f58f8c01":"code","a4359094":"code","7cff759e":"code","d4d97be7":"code","c0a439ac":"code","b967e151":"code","e98492b1":"code","533b729b":"code","c4251833":"code","0c74b58a":"code","81e4826a":"code","e4afa1ac":"code","d99365d7":"code","ee988289":"code","d10b959f":"code","427d9445":"code","38fef26f":"code","2125fa62":"code","d13f2465":"code","acab2241":"code","b82418e1":"code","cacf6f0b":"code","56e07100":"code","fc33264b":"code","1274119c":"markdown","f5cb75ea":"markdown","a4056a86":"markdown","62342a99":"markdown","b829528c":"markdown","3367ccad":"markdown","3e9faafb":"markdown","0aabd90d":"markdown","abc2c28a":"markdown","12a25c38":"markdown","0cf67c3f":"markdown","c1061e0b":"markdown","4910640f":"markdown","3d8d0df0":"markdown","3616eafb":"markdown","44c84363":"markdown","b4871177":"markdown","4c9e36b4":"markdown","92187a4b":"markdown","58f57657":"markdown","5aa9ccda":"markdown","62d3e0a8":"markdown","5fa24f93":"markdown","cb768599":"markdown","ce280105":"markdown","79dcdf9f":"markdown","32ef5615":"markdown","ff9469a7":"markdown","e9eb17c4":"markdown","40ed8ce2":"markdown","41c860c1":"markdown","782e88bb":"markdown","f0785de9":"markdown","5679a633":"markdown","2756af53":"markdown","1f5b84eb":"markdown","94ff438a":"markdown","063a3ab7":"markdown","93770e8c":"markdown","8ef7893f":"markdown","73c8ee2c":"markdown","15973d03":"markdown","e57c1390":"markdown"},"source":{"e873fc02":"# Importing necessary libraries\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set()","cc3eb44f":"train_data = pd.read_csv('..\/input\/used-cars-price-prediction\/train-data.csv')\ntest_data = pd.read_csv('..\/input\/used-cars-price-prediction\/test-data.csv')","e45f59a7":"train_data.info()","0d53e6e8":"train_data.head()","86db3202":"train_data.tail()","49638ed5":"train_data = train_data.iloc[:,1:]\ntrain_data.head()","4ee68b69":"train_data.describe()","067b819d":"train_data.shape","8a91d95e":"train_data['Kilometers_Driven'].value_counts()","953a40b3":"# Looking ate the unique values of Categorical Features\nprint(train_data['Location'].unique())\nprint(train_data['Fuel_Type'].unique())\nprint(train_data['Transmission'].unique())\nprint(train_data['Owner_Type'].unique())\n\n#Rest Feature are worked for Feature Engineering","7ce8f826":"train_data.isnull().sum()","781fb6d2":"print(\"Shape of train data Before dropping any Row: \",train_data.shape)\ntrain_data = train_data[train_data['Mileage'].notna()]\nprint(\"Shape of train data After dropping Rows with NULL values in Mileage: \",train_data.shape)\ntrain_data = train_data[train_data['Engine'].notna()]\nprint(\"Shape of train data After dropping Rows with NULL values in Engine : \",train_data.shape)\ntrain_data = train_data[train_data['Power'].notna()]\nprint(\"Shape of train data After dropping Rows with NULL values in Power  : \",train_data.shape)\ntrain_data = train_data[train_data['Seats'].notna()]\nprint(\"Shape of train data After dropping Rows with NULL values in Seats  : \",train_data.shape)","451ecc15":"train_data = train_data.reset_index(drop=True)","3e209612":"for i in range(train_data.shape[0]):\n    train_data.at[i, 'Company'] = train_data['Name'][i].split()[0]\n    train_data.at[i, 'Mileage(km\/kg)'] = train_data['Mileage'][i].split()[0]\n    train_data.at[i, 'Engine(CC)'] = train_data['Engine'][i].split()[0]\n    train_data.at[i, 'Power(bhp)'] = train_data['Power'][i].split()[0]","03625b65":"train_data['Mileage(km\/kg)'] = train_data['Mileage(km\/kg)'].astype(float)\ntrain_data['Engine(CC)'] = train_data['Engine(CC)'].astype(float)","c9e76ec9":"train_data['Power'][76]","7c3a1ad1":"x = 'n'\ncount = 0\nposition = []\nfor i in range(train_data.shape[0]):\n    if train_data['Power(bhp)'][i]=='null':\n        x = 'Y'\n        count = count + 1\n        position.append(i)\nprint(x)\nprint(count)\nprint(position)","68b0ed14":"train_data = train_data.drop(train_data.index[position])\ntrain_data = train_data.reset_index(drop=True)","63670aa1":"train_data.shape","91d5fe86":"train_data['Power(bhp)'] = train_data['Power(bhp)'].astype(float)","50a5cd2b":"train_data.head()","2d220a05":"for i in range(train_data.shape[0]):\n    if pd.isnull(train_data.loc[i,'New_Price']) == False:\n        train_data.at[i,'New_car_Price'] = train_data['New_Price'][i].split()[0]","c43a40d5":"train_data['New_car_Price'] = train_data['New_car_Price'].astype(float)","dde6f1c3":"train_data.drop([\"Name\"],axis=1,inplace=True)\ntrain_data.drop([\"Mileage\"],axis=1,inplace=True)\ntrain_data.drop([\"Engine\"],axis=1,inplace=True)\ntrain_data.drop([\"Power\"],axis=1,inplace=True)\ntrain_data.drop([\"New_Price\"],axis=1,inplace=True)","e21faf7e":"train_data.info()","17894f14":"train_data['Price'].describe()","96dcf9b9":"f, ax = plt.subplots(figsize=(15,8))\nsns.distplot(train_data['Price'])\nplt.xlim([0,160])","edf76bc9":"train_data['Fuel_Type'].describe()","9e7a4c85":"var = 'Fuel_Type'\ndata = pd.concat([train_data['Price'], train_data[var]], axis=1)\nf, ax = plt.subplots(figsize=(12, 8))\nfig = sns.boxplot(x=var, y=\"Price\", data=data)\nfig.axis(ymin=0, ymax=165);","991cb529":"var = 'Fuel_Type'\nfig, ax = plt.subplots()\nfig.set_size_inches(11.7, 8.27)\nsns.swarmplot(x = var, y ='Price', data = train_data)","f83c7673":"var = 'Year'\ndata = pd.concat([train_data['Price'], train_data[var]], axis=1)\nf, ax = plt.subplots(figsize=(20, 10))\nfig = sns.boxplot(x=var, y=\"Price\", data=data)\nfig.axis(ymin=0, ymax=165);\nplt.xticks(rotation=90);","d1044376":"var = 'Owner_Type'\nfig, ax = plt.subplots()\nfig.set_size_inches(11.7, 8.27)\nsns.stripplot(x = var, y ='Price', data = train_data) ","8e81df50":"var = \"Company\"\nplt.figure(figsize=(20, 10))\nsns.catplot(x=var, kind=\"count\", palette=\"ch:.25\", height=8, aspect=2, data=train_data);\nplt.xticks(rotation=90);","728d552e":"var = 'Location'\ntrain_data[var].value_counts()","f0e3a93a":"# Plot Location vs Price\nsns.catplot(y='Price',x=var,data= train_data.sort_values('Price',ascending=False),kind=\"boxen\",height=6, aspect=3)\nplt.show","333a52f7":"Location = train_data[[var]]\nLocation = pd.get_dummies(Location,drop_first=True)\nLocation.head()","bf5e40d4":"var = 'Fuel_Type'\ntrain_data[var].value_counts()","f67789b6":"# Plot Fuel_Type vs Price\n# Yes we did this earlier... but used here for the work required here\nsns.catplot(y='Price',x=var,data= train_data.sort_values('Price',ascending=False),kind=\"boxen\",height=6, aspect=3)\nplt.show","c1008cce":"Fuel_t = train_data[[var]]\nFuel_t = pd.get_dummies(Fuel_t,drop_first=True)\nFuel_t.head()","ee5dd9e2":"var = 'Transmission'\ntrain_data[var].value_counts()","f58f8c01":"# Plot Transmission vs Price\n# Yes we did this earlier... but used here for the work required here\nsns.catplot(y='Price',x=var,data= train_data.sort_values('Price',ascending=False),kind=\"boxen\",height=6, aspect=3)\nplt.show","a4359094":"Transmission = train_data[[var]]\nTransmission = pd.get_dummies(Transmission,drop_first=True)\nTransmission.head()","7cff759e":"var = 'Owner_Type'\ntrain_data[var].value_counts()","d4d97be7":"train_data.replace({\"First\":1,\"Second\":2,\"Third\": 3,\"Fourth & Above\":4},inplace=True)\ntrain_data.head()","c0a439ac":"var = 'Company'\ntrain_data[var].value_counts()","b967e151":"# Plot Company vs Price\n# Yes we did this earlier... but used here for the work required here\nsns.catplot(y='Price',x=var,data= train_data.sort_values('Price',ascending=False),kind=\"boxen\",height=6, aspect=3)\nplt.show","e98492b1":"train_data.drop([\"Company\"],axis=1,inplace=True)","533b729b":"final_train= pd.concat([train_data,Location,Fuel_t,Transmission],axis=1)\nfinal_train.head()","c4251833":"final_train.drop([\"Location\",\"Fuel_Type\",\"Transmission\",\"New_car_Price\"],axis=1,inplace=True)\nfinal_train.head()","0c74b58a":"final_train.shape","81e4826a":"test_data.head()","e4afa1ac":"test_data = test_data.iloc[:,1:]\n\nprint(\"Shape of test data Before dropping any Row: \",train_data.shape)\ntest_data = test_data[test_data['Mileage'].notna()]\nprint(\"Shape of test data After dropping Rows with NULL values in Mileage: \",test_data.shape)\ntest_data = test_data[test_data['Engine'].notna()]\nprint(\"Shape of test data After dropping Rows with NULL values in Engine : \",test_data.shape)\ntest_data = test_data[test_data['Power'].notna()]\nprint(\"Shape of test data After dropping Rows with NULL values in Power  : \",test_data.shape)\ntest_data = test_data[test_data['Seats'].notna()]\nprint(\"Shape of test data After dropping Rows with NULL values in Seats  : \",test_data.shape)\nprint('Droping null done')\n\ntest_data = test_data.reset_index(drop=True)\nprint('Index reset done')\n\nfor i in range(test_data.shape[0]):\n    test_data.at[i, 'Mileage(km\/kg)'] = test_data['Mileage'][i].split()[0]\n    test_data.at[i, 'Engine(CC)'] = test_data['Engine'][i].split()[0]\n    test_data.at[i, 'Power(bhp)'] = test_data['Power'][i].split()[0]\nprint('Split Done') \n\ntest_data['Mileage(km\/kg)'] = test_data['Mileage(km\/kg)'].astype(float)\ntest_data['Engine(CC)'] = test_data['Engine(CC)'].astype(float)\nprint('casting 1 Done') \n\nposition = []\nfor i in range(test_data.shape[0]):\n    if test_data['Power(bhp)'][i]=='null':\n        position.append(i)\n        \ntest_data = test_data.drop(test_data.index[position])\ntest_data = test_data.reset_index(drop=True) \n\ntest_data['Power(bhp)'] = test_data['Power(bhp)'].astype(float)\nprint('casting 2 Done') \n\nfor i in range(test_data.shape[0]):\n    if pd.isnull(test_data.loc[i,'New_Price']) == False:\n        test_data.at[i,'New_car_Price'] = test_data['New_Price'][i].split()[0]\n\ntest_data['New_car_Price'] = test_data['New_car_Price'].astype(float)\n\ntest_data.drop([\"Name\"],axis=1,inplace=True)\ntest_data.drop([\"Mileage\"],axis=1,inplace=True)\ntest_data.drop([\"Engine\"],axis=1,inplace=True)\ntest_data.drop([\"Power\"],axis=1,inplace=True)\ntest_data.drop([\"New_Price\"],axis=1,inplace=True)\n\nvar = 'Location'\nLocation = test_data[[var]]\nLocation = pd.get_dummies(Location,drop_first=True)\nLocation.head()\n\nvar = 'Fuel_Type'\nFuel_t = test_data[[var]]\nFuel_t = pd.get_dummies(Fuel_t,drop_first=True)\nFuel_t.head()\n\nvar = 'Transmission'\nTransmission = test_data[[var]]\nTransmission = pd.get_dummies(Transmission,drop_first=True)\nTransmission.head()\n\ntest_data.replace({\"First\":1,\"Second\":2,\"Third\": 3,\"Fourth & Above\":4},inplace=True)\ntest_data.head()\n\nfinal_test= pd.concat([test_data,Location,Fuel_t,Transmission],axis=1)\nfinal_test.head()\n\nfinal_test.drop([\"Location\",\"Fuel_Type\",\"Transmission\",\"New_car_Price\"],axis=1,inplace=True)\nfinal_test.head()\n\nprint(\"Final Test Size: \",final_test.shape)\n","d99365d7":"final_test.head()","ee988289":"final_train.columns","d10b959f":"X = final_train.loc[:,['Year', 'Kilometers_Driven', 'Owner_Type', 'Seats',\n       'Mileage(km\/kg)', 'Engine(CC)', 'Power(bhp)', \n       'Location_Bangalore', 'Location_Chennai', 'Location_Coimbatore',\n       'Location_Delhi', 'Location_Hyderabad', 'Location_Jaipur',\n       'Location_Kochi', 'Location_Kolkata', 'Location_Mumbai',\n       'Location_Pune', 'Fuel_Type_Diesel', 'Fuel_Type_LPG',\n       'Fuel_Type_Petrol', 'Transmission_Manual']]\nX.shape","427d9445":"y = final_train.loc[:,['Price']]\ny.head()","38fef26f":"plt.figure(figsize=(18,18))\nsns.heatmap(train_data.corr(),annot=True,cmap='RdYlGn')\n\nplt.show()","2125fa62":"plt.figure(figsize=(18,18))\nsns.heatmap(final_train.corr(),annot=True,cmap='RdYlGn')\n\nplt.show()","d13f2465":"from sklearn.ensemble import ExtraTreesRegressor\nselection= ExtraTreesRegressor()\nselection.fit(X,y)","acab2241":"#plot graph of feature importances for better visualization\n\nplt.figure(figsize = (12,8))\nfeat_importances = pd.Series(selection.feature_importances_, index=X.columns)\nfeat_importances.nlargest(20).plot(kind='barh')\nplt.show()","b82418e1":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.2, random_state = 25)","cacf6f0b":"from sklearn.linear_model import LinearRegression\nlinear_reg = LinearRegression()\nlinear_reg.fit(X_train, y_train)\ny_pred= linear_reg.predict(X_test)\nprint(\"Accuracy on Traing set: \",linear_reg.score(X_train,y_train))\nprint(\"Accuracy on Testing set: \",linear_reg.score(X_test,y_test))","56e07100":"from sklearn.ensemble import RandomForestRegressor\nrf_reg = RandomForestRegressor()\nrf_reg.fit(X_train, y_train)\ny_pred= rf_reg.predict(X_test)\nprint(\"Accuracy on Traing set: \",rf_reg.score(X_train,y_train))\nprint(\"Accuracy on Testing set: \",rf_reg.score(X_test,y_test))","fc33264b":"from sklearn import metrics\nfrom sklearn.metrics import mean_squared_error, mean_absolute_error\n\nprint(\"\\t\\tError Table\")\nprint('Mean Absolute Error      : ', metrics.mean_absolute_error(y_test, y_pred))\nprint('Mean Squared  Error      : ', metrics.mean_squared_error(y_test, y_pred))\nprint('Root Mean Squared  Error : ', np.sqrt(metrics.mean_squared_error(y_test, y_pred)))\nprint('R Squared Error          : ', metrics.r2_score(y_test, y_pred))","1274119c":"At this point when I tried to change **Power(bhp)** to float an error occured (Can't convert str to float : null).\nSo, I started investigating. And found some cell where having values: 'null bhp'","f5cb75ea":"Then I found the indexes of these values and removed them.","a4056a86":"Now,\n\nLet's delete all useless featiures.","62342a99":"### First let me try Linear Regression","b829528c":"### Working with Company","3367ccad":"# Build it (Model)\n\nFirst we are spliting the data to train and test for the model","3e9faafb":"### Now I am using Random Forest Regressor (obviously for better accuracy)","0aabd90d":"### Working with Transmission","abc2c28a":"### Fuel Type","12a25c38":"As for now we have left with only 5 categorical features:\n1. Location\n2. Fuel_Type\n3. Transmission\n4. Owner_Type\n5. Company","0cf67c3f":"Again we will be using One-hot-encoding","c1061e0b":"First let's have a look over our target column","4910640f":"As, we thought diseal car would cost followed Petrol.","3d8d0df0":"# Working with Categorical Data","3616eafb":"### Owner Type","44c84363":"We are Done with Training data, so now work on Test Data","b4871177":"We will be using One-hot-encoding here","4c9e36b4":"# Feautre Engineering \ud83d\udee0\nThere are many different data which could be extarcted from present. And, that's where Feature Engineering comes.","92187a4b":"From above values, we could judge that Mubmai has most number of cars to be sold followed by others.","58f57657":"# Final Features Selection\n\nAs our train and test data are ready so now we have to only look for features on which we have to work.","5aa9ccda":"# Data Visualization\n### Let's Plot some\nData visualization is the best way to find out how a data looks like","62d3e0a8":"A lot of variation so let's drop them","5fa24f93":"\ud83d\udca5\ud83d\udca5\ud83d\udca5\ud83d\udca5 **Oh Yeah!!!!**\n\nThat's a **Great Accuracy**","cb768599":"# Used Car Price Prediction\n\n<font color=\"Green\"> 3rd, 4th and 5th (End date: 12th of July,2020)  Day of my KaggleStreak <\/font>\n\nSo called Second hand's car have a huge market base.\nMany consider to buy a Used Car intsead of buying of new one, as it's is feasible and a better investment.\n\nThe main reason for this huge market is that when you buy a New Car and sale it just another day without any default on it, the price of car reduces by 30%.\n\nThere are also many frauds in the market who not only sale wrong but also they could mislead to wrong price.\n\nSo, here I used this following dataset to Predict the price of any used car.\n\nDo give <font color=\"Red\"> UPVOTE <\/font>\n\n**I WILL BE ADDING LINK OF DEPLOYED MODEL SOON IN COMMENT SECTION**\n**If not done till Know**","ce280105":"Cleary **Maruti** is most comman brand followed by **Hyundai**","79dcdf9f":"We will have to prepare this test data with performing all the steps agaon for test data","32ef5615":" So, Finally this NoteBook End here \ud83e\udd35\ud83c\udffb\n \n One could go even further by Hyperparameter tuning. But, for now I left it  over you all\n \n Before going a humble request if you liked the notebook the \n <font color=\"Red\">Please Upvote ( It motivates me ) <\/font>\n \n And Stay Tuned... \n **I WILL BE ADDING LINK OF DEPLOYED MODEL SOON IN COMMENT SECTION**\n **If not done till Know**\n \n Till then Happy Coding\n ","ff9469a7":"### Company","e9eb17c4":"### Price","40ed8ce2":"### Working with Owner_Type","41c860c1":"So, in total I have 5975 Rows now to work forward. I droped 44 rows.","782e88bb":"Let's Drop sum Rows which contains NULL values.\n\nI ignored New_Price as there are many cell which contains NULL value in this column.","f0785de9":"### Working for Location","5679a633":"Well after using *.notna()* we have many absent indexes (Eg: If row no 47 was droped then after 46 we have 48 index), so I reset the index and droping the present index.","2756af53":"No, order so One-hot-encoding","1f5b84eb":"As Owner_Type column has ordered data so we will be using **Label Encoding** \n**Finally**","94ff438a":"#### Not a good accuracy so, let's try something more better.","063a3ab7":"For hadeling categorical data. We modtly use these 2 path:\n1. OneHotEncoder\n2. LabelEncoder\n\nWhere OneHotEncoder is used where data are not in any order and LabelEncoder when data is in order.\n\nSo, for each Features we will use plots to find out what to be used there.","93770e8c":"# Prepare Test Data","8ef7893f":"Now the new shape of training data is:","73c8ee2c":"### Working for Fuel_Type","15973d03":"### Year","e57c1390":"Clearly, it's a strong tendency.\n\nPrice of Newest is high compared to old models."}}