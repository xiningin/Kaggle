{"cell_type":{"4deca24f":"code","cba36b54":"code","3250d2f7":"code","d3012dc0":"code","e524fd39":"code","8fc4c807":"code","97579e2b":"code","3b074dfa":"code","26f501d8":"code","61b1470f":"code","092bf069":"code","f974bab4":"code","3d6ae095":"code","d96daf96":"code","0cef27b8":"code","bcce4ce5":"code","258d4c38":"code","4558adf1":"code","68fe0bc9":"code","05538cdc":"code","eb0d1f09":"code","9904745d":"code","e292d1c9":"code","a1f358be":"code","c5ece44c":"code","93f9f2f0":"code","2e48c703":"code","af51d659":"code","11518e4b":"code","8cc125e6":"code","50987e58":"code","f65b7724":"code","7a8d49e2":"code","75f95fe0":"code","9b3ed2ab":"code","110fa904":"code","bda46a98":"code","03df0a10":"code","b737e1e0":"code","73d2ba75":"code","5bfe109e":"code","ba5d3d80":"code","7bb5f2d2":"code","e59b4872":"code","fa8b05fc":"code","cd81bd81":"code","e114ff99":"code","0351e1c9":"code","c12c78ea":"code","7dfab481":"code","3488a1fb":"code","dcc34978":"code","9842e54b":"code","60559deb":"code","ea7b6e8a":"code","aab1912a":"code","e0bdab24":"code","9366d35e":"markdown","62cf8105":"markdown","b954e962":"markdown","77b9e827":"markdown","12ef813e":"markdown","79a421a3":"markdown","4c4a7704":"markdown","e05e6ddf":"markdown","69830f46":"markdown","219676ed":"markdown","36f14613":"markdown","bd864207":"markdown","97a555f2":"markdown","c771922d":"markdown","f8b501ba":"markdown","97c79654":"markdown","6b17eace":"markdown","be360d95":"markdown","5e369dc2":"markdown","393d322f":"markdown","62b03c68":"markdown","8d77c008":"markdown","d8c0c1c4":"markdown","a2c827b1":"markdown","e8580a25":"markdown","3dd674f2":"markdown"},"source":{"4deca24f":"import pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport numpy as np","cba36b54":"df = pd.read_csv('..\/input\/sao-paulo-real-estate-sale-rent-april-2019\/sao-paulo-properties-april-2019.csv')","3250d2f7":"df.head()","d3012dc0":"df.isnull().sum()","e524fd39":"df.info()","8fc4c807":"df.columns","97579e2b":"df['Rooms'].unique()","3b074dfa":"df['Toilets'].unique()","26f501d8":"df['Suites'].unique()","61b1470f":"df['Parking'].unique()","092bf069":"df['Elevator'].unique()","f974bab4":"df['Furnished'].unique()","3d6ae095":"df['Swimming Pool'].unique()","d96daf96":"df['New'].unique()","0cef27b8":"df['Property Type'].unique()","bcce4ce5":"df['District'].unique()","258d4c38":"df[['District', 'City']] = df['District'].str.split('\/', expand=True)","4558adf1":"df.head()","68fe0bc9":"df['City'].unique()","05538cdc":"df = df.drop(['City', 'Property Type'], axis=1)","eb0d1f09":"sns.scatterplot(data=df, x='Longitude', y='Latitude')","9904745d":"df[df['Longitude'] > -10]","e292d1c9":"df[df['Latitude'] < -30]","a1f358be":"df[(df['Longitude'] == 0) | (df['Latitude'] == 0)]","c5ece44c":"df = df.drop(['Latitude', 'Longitude'], axis=1)","93f9f2f0":"df.head()","2e48c703":"df[df['Negotiation Type']=='rent'].describe()[['Price', 'Condo', 'Size']]","af51d659":"df[df['Negotiation Type']=='sale'].describe()[['Price', 'Condo', 'Size']]","11518e4b":"dfr = df[df['Negotiation Type'] == 'rent']\ndfs = df[df['Negotiation Type'] == 'sale']","8cc125e6":"plt.figure(figsize=(12,8), dpi=150)\nsns.histplot(data=dfr, x='Price', bins=50, kde=True)","50987e58":"plt.figure(figsize=(12,8), dpi=150)\nsns.histplot(data=dfs, x='Price', bins=50, kde=True)","f65b7724":"dfr['Price m2'] = dfr['Price'] \/ dfr['Size']\ndfs['Price m2'] = dfs['Price'] \/ dfs['Size']","7a8d49e2":"dfr.sort_values('Price m2', ascending=False)[0:10]","75f95fe0":"dfs.sort_values('Price m2', ascending=False)[0:10]","9b3ed2ab":"dfr['Price m2'].describe()","110fa904":"dfs['Price m2'].describe()","bda46a98":"dfr['Price m2'].plot.box()","03df0a10":"dfs['Price m2'].plot.box()","b737e1e0":"plt.figure(figsize=(18,8),dpi=200)\nplt.title(\"Price m2 - Rent\")\nplt.ylabel(\"Price m2\")\ndfr.groupby('District')['Price m2'].mean().sort_values(ascending=False).plot.bar();","73d2ba75":"plt.figure(figsize=(18,8),dpi=200)\nplt.title(\"Price m2 - Sale\")\nplt.ylabel(\"Price m2\")\ndfs.groupby('District')['Price m2'].mean().sort_values(ascending=False).plot.bar();","5bfe109e":"lista_district = dfr['District'].unique()","ba5d3d80":"lista_district","7bb5f2d2":"for district in lista_district:\n    med = dfr[dfr['District'] == district]['Price m2'].mean()\n    q1 = dfr[dfr['District'] == district]['Price m2'].quantile(.25)\n    q3 = dfr[dfr['District'] == district]['Price m2'].quantile(.75)\n    outlier1 = ((q3 - q1) * 3) + med\n    outlier2 = med - ((q3 - q1) * 3)\n    dfr = dfr.drop(dfr[(dfr['District'] == district) & (dfr['Price m2'] > outlier1)].index)\n    dfr = dfr.drop(dfr[(dfr['District'] == district) & (dfr['Price m2'] < outlier2)].index)","e59b4872":"dfr['Price m2'].plot.box()","fa8b05fc":"for district in lista_district:\n    med = dfs[dfs['District'] == district]['Price m2'].mean()\n    q1 = dfs[dfs['District'] == district]['Price m2'].quantile(.25)\n    q3 = dfs[dfs['District'] == district]['Price m2'].quantile(.75)\n    outlier1 = ((q3 - q1) * 3) + med\n    outlier2 = med - ((q3 - q1) * 3)\n    dfs = dfs.drop(dfs[(dfs['District'] == district) & (dfs['Price m2'] > outlier1)].index)\n    dfs = dfs.drop(dfs[(dfs['District'] == district) & (dfs['Price m2'] < outlier2)].index)","cd81bd81":"dfs['Price m2'].plot.box()","e114ff99":"rrd = (dfr.groupby('District')['Price m2'].mean() \/ dfs.groupby('District')['Price m2'].mean())*100","0351e1c9":"rrd.sort_values(ascending=False)[:50]","c12c78ea":"rrd.sort_values(ascending=False)[50:].dropna()","7dfab481":"plt.figure(figsize=(18,8),dpi=200)\nplt.title(\"Return Rate by Districts\")\nplt.ylabel(\"Return Rate\")\nrrd.sort_values(ascending=False).dropna().plot.bar();","3488a1fb":"rrr = (dfr.groupby('Rooms')['Price m2'].mean() \/ dfs.groupby('Rooms')['Price m2'].mean())*100","dcc34978":"rrr.sort_values(ascending=False).dropna()","9842e54b":"plt.figure(figsize=(8,4),dpi=100)\nrrr.sort_values(ascending=False).dropna().plot.bar()\nplt.title(\"Return Rate by Bedrooms\")\nplt.ylabel(\"Return Rate\")\nplt.xticks(rotation = 0);","60559deb":"rrdr = (dfr.groupby(['District','Rooms'])['Price m2'].mean() \/ dfs.groupby(['District','Rooms'])['Price m2'].mean())*100","ea7b6e8a":"rrdr.sort_values(ascending=False).nlargest(50)","aab1912a":"rrdr.sort_values(ascending=False).nsmallest(50)","e0bdab24":"plt.figure(figsize=(8,4),dpi=100)\nrrdr.sort_values(ascending=False).dropna()[:50].plot.bar()\nplt.title(\"Return Rate by District and Bedrooms - Top 50\")\nplt.ylabel(\"Return Rate\")\nplt.xticks(rotation = 90);","9366d35e":"# Defining the return rate based on rooms","62cf8105":"### Verifying dummie values in descrete, categorical and boolean variables","b954e962":"# Data Wrangling","77b9e827":"### Spliting districts and cities","12ef813e":"here we see values with inverted position (Latitude x Longitude)","79a421a3":"# Defining the return rate base on districts and rooms","4c4a7704":"One bedroom has the best return rate","e05e6ddf":"There is just one single city and one single type of property, so this varibles can be removed","69830f46":"There is a total of 881 missing values of coordinates and several other with wrong values. But as the data is located by districts we consider that is enough to clustering these data. So we can drop the coordenates in order to avoid mistakes in the future predictive model, but assuming that districts is enough to categorize them. ","219676ed":"### Verifying types of variables","36f14613":"Some periferic districts have a good return rate because the price m2 for sale is so small.","bd864207":"# Defining the return rate based on districts","97a555f2":"We can see there are several outliers but, removing them based on entire sample will introduce a mistake because tradicionaly there are some districts with high values, so in order to remove the outlier is necessary to consider two things: the value per squared meter and the values grouped by districts. ","c771922d":"### Describing the Price m2 variable","f8b501ba":"data without coordinates was set with zero.","97c79654":"### Verifying missing values","6b17eace":"### Creating a new varible - Price per squared meter for rent and sale","be360d95":"# Downloading csv file","5e369dc2":"Instead of considering 1.5 times the interquartile difference, we considered 3 times in order to remove just the extreme values.","393d322f":"### Creating two new data frames based on negotiation type","62b03c68":"### The task is to define what is the best investment in the city related to sale x rent. So we want to define what kind of property and what district of the city has the best return rate. The return rate is defined as rent value \/ sale value normalized by size. So for each Brazilian Real invested in sale how much will be the return in rent.\n","8d77c008":"### Evaluating numercial variables by Negotiation Type","d8c0c1c4":"In general small apartments has better return rates than the big ones. Apartments far from the center of the city has the best return rate, because the price for rent by squared meter is not so different from the best places in the city, but the price for sale is very small. One bedroom in Vila Madelena District has the best return rate in the city.","a2c827b1":"The city of Sao Paulo is located close to the -23\u00b0 Latitude \/ -46\u00b0 Longitude, so there are several inconsistent values.","e8580a25":"### Verifying the coordinates","3dd674f2":"# Importing Libraries"}}