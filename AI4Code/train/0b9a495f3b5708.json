{"cell_type":{"4df574d3":"code","a7f6e2f7":"code","114a47db":"code","c50c61fa":"code","01dfa49a":"code","cffaebef":"code","57cea9fb":"code","126a6c5d":"code","efb7f048":"code","29c206ed":"code","03741ac4":"code","57388e4e":"code","92a4b9f0":"code","7189a9db":"code","daf09f26":"code","9fe341f4":"code","0020dd02":"code","2799b28d":"code","1172a9f9":"code","ad8a7dc7":"code","5a7a7365":"code","738fed28":"code","b1e87474":"code","49d2e19e":"code","cbf6e682":"code","2ed99bcc":"code","bd2d7189":"code","a4e3e971":"code","2b105fa2":"markdown","820abbe1":"markdown","6caf1136":"markdown","03b67902":"markdown","8b573cb1":"markdown","1c58cacc":"markdown","a41e99e8":"markdown","23b30fc0":"markdown","8931998b":"markdown","4b769dfe":"markdown","608ea6ef":"markdown","98237b04":"markdown","849ce48b":"markdown","7720f770":"markdown","ede7dd84":"markdown"},"source":{"4df574d3":"import pandas as pd\nfrom matplotlib import pyplot as plt\nimport pydicom\nimport os\nimport random\nimport numpy as np","a7f6e2f7":"train = pd.read_csv('\/kaggle\/input\/osic-pulmonary-fibrosis-progression\/train.csv')","114a47db":"train.head()","c50c61fa":"len(train['Patient'].unique())","01dfa49a":"plt.hist(train.groupby(['Patient']).count()['Weeks'].to_list())\nplt.show()","cffaebef":"import matplotlib.pyplot as plt\n#fig = plt.Figure(figsize=(28,42),constrained_layout=True)\nfig, axs = plt.subplots(2, 2,figsize=(15,10))\naxs[0, 0].hist(train['Age'])\naxs[0, 0].set_title('Age Distribution')\naxs[0, 1].hist(train['SmokingStatus'])\naxs[0, 1].set_title('Smokers Distribution')\naxs[1, 0].hist(train['Sex'])\naxs[1, 0].set_title('Gender Distribution')\naxs[1, 1].hist(train['Weeks'],bins=50)\naxs[1, 1].set_title('Weeks Distribution')\nplt.show()","57cea9fb":"width = (max(train['Weeks'])-min(train['Weeks']))\/4\nrow = 2\ncol = 2\n_min = min(train['Weeks'])\ndata = dict()\nfor i in range(0,row):\n    for j in range(0,col):\n        c_graph = i*col+j\n        llimit = _min+c_graph*width\n        ulimit = llimit+width\n        key = 'Weeks '+str(llimit)+' - '+str(ulimit)\n        data[key] = train[(train['Weeks']<=ulimit) & (train['Weeks']>llimit)]['Percent']\nfig, ax = plt.subplots(figsize=(15,10))\nax.boxplot(data.values())\nax.set_title('Distibution of percent with Week #')\nax.set_xticklabels(data.keys())\nplt.show()","126a6c5d":"width = (max(train['Age'])-min(train['Age']))\/4\nrow = 2\ncol = 2\n_min = min(train['Age'])\ndata = dict()\nfor i in range(0,row):\n    for j in range(0,col):\n        c_graph = i*col+j\n        llimit = _min+c_graph*width\n        ulimit = llimit+width\n        key = 'Age '+str(llimit)+' - '+str(ulimit)\n        data[key] = train[(train['Age']<=ulimit) & (train['Age']>llimit)]['FVC']\nfig, ax = plt.subplots(figsize=(15,10))\nax.boxplot(data.values())\nax.set_title('Distibution of FVC with Patient\\'s age')\nax.set_xticklabels(data.keys())\nplt.show()","efb7f048":"width = (max(train['Age'])-min(train['Age']))\/4\nrow = 2\ncol = 2\n_min = min(train['Age'])\ndata = dict()\nfor i in range(0,row):\n    for j in range(0,col):\n        c_graph = i*col+j\n        llimit = _min+c_graph*width\n        ulimit = llimit+width\n        key = 'Age '+str(llimit)+' - '+str(ulimit)\n        data[key] = train[(train['Age']<=ulimit) & (train['Age']>llimit)]['Percent']\nfig, ax = plt.subplots(figsize=(15,10))\nax.boxplot(data.values())\nax.set_title('Distibution of percent with Patient\\'s Age')\nax.set_xticklabels(data.keys())\nplt.show()","29c206ed":"train['SmokingStatus'].unique()","03741ac4":"data = dict()\nsmokingstatus = train['SmokingStatus'].unique()\nfor i in range(len(smokingstatus)):\n    key = smokingstatus[i]\n    data[key] = train[train['SmokingStatus']==key]['Percent']\nfig, ax = plt.subplots(figsize=(15,10))\nax.boxplot(data.values())\nax.set_title('Distibution of percent with Patient\\'s Smoking Status')\nax.set_xticklabels(data.keys())\nplt.show()","57388e4e":"data = dict()\ngenders = train['Sex'].unique()\nfor i in range(len(genders)):\n    key = genders[i]\n    data[key] = train[train['Sex']==key]['Percent']\nfig, ax = plt.subplots(figsize=(15,10))\nax.boxplot(data.values())\nax.set_title('Distibution of percent with Patient\\'s Gender')\nax.set_xticklabels(data.keys())\nplt.show()","92a4b9f0":"keys = ['BitsAllocated','BitsStored',\n 'BodyPartExamined',\n 'Columns',\n 'ConvolutionKernel',\n 'DeidentificationMethod',\n 'DistanceSourceToDetector',\n 'DistanceSourceToPatient',\n 'FocalSpots',\n 'FrameOfReferenceUID',\n 'GantryDetectorTilt',\n 'GeneratorPower',\n 'HighBit',\n 'ImageOrientationPatient',\n 'ImagePositionPatient',\n 'ImageType',\n 'InstanceNumber',\n 'KVP',\n 'Manufacturer',\n 'ManufacturerModelName',\n 'Modality',\n 'PatientID',\n 'PatientName',\n 'PatientPosition',\n 'PatientSex',\n 'PhotometricInterpretation',\n 'PixelData',\n 'PixelRepresentation',\n 'PixelSpacing',\n 'PositionReferenceIndicator',\n 'RescaleIntercept',\n 'RescaleSlope',\n 'RotationDirection',\n 'Rows',\n 'SOPInstanceUID',\n 'SamplesPerPixel',\n 'SeriesInstanceUID',\n 'SliceLocation',\n 'SliceThickness',\n 'StudyID',\n 'StudyInstanceUID',\n 'TableHeight',\n 'WindowCenter',\n 'WindowCenterWidthExplanation',\n 'WindowWidth',\n 'XRayTubeCurrent']","7189a9db":"all_image_meta = dict()\nfrom datetime import datetime as dt\nfrom tqdm import tqdm\nfor key in keys:\n    all_image_meta[key] = list()\nBreak = False\nfor _file in tqdm(os.listdir('\/kaggle\/input\/osic-pulmonary-fibrosis-progression\/train\/')):\n    for _img in os.listdir('\/kaggle\/input\/osic-pulmonary-fibrosis-progression\/train\/'+_file):\n        dataset = pydicom.dcmread('\/kaggle\/input\/osic-pulmonary-fibrosis-progression\/train\/'+_file+'\/'+_img)\n        all_image_meta['file_path'] = '\/kaggle\/input\/osic-pulmonary-fibrosis-progression\/train\/'+ _file + '\/' + _img\n        for key in keys:\n            try:\n                all_image_meta[key].append(str(dataset[key]).split(' ')[-1])\n            except KeyError as k:\n                all_image_meta[key].append(None)\n            except Exception as e:\n                Break = True\n                break\n        if Break:\n            break\n    if Break:\n        break","daf09f26":"dataset\n","9fe341f4":"all_image_meta = pd.DataFrame(all_image_meta)\nall_image_meta.shape","0020dd02":"for key in keys:\n    print(key,all_image_meta[key].nunique(),all_image_meta[key][0])","2799b28d":"def clean_patient_id(_str):\n    return _str.replace('\\'','')","1172a9f9":"all_image_meta['PatientID'] = all_image_meta['PatientID'].apply(clean_patient_id)","ad8a7dc7":"all_image_meta.groupby('PatientID').count()['Columns'].mean()","5a7a7365":"def view_patient(patient_id):\n    # Draw random 15 images for the patient\n    files = os.listdir('\/kaggle\/input\/osic-pulmonary-fibrosis-progression\/train\/'+patient_id)\n    files = random.sample(files, 15)\n    \n    # Draw the images\n    row = 3\n    col = 5\n    fig, axs = plt.subplots(row, col,figsize=(15,10))\n    for i in range(0,row):\n        for j in range(0,col):\n            c_image = files[i*col+j]\n            data = pydicom.dcmread('\/kaggle\/input\/osic-pulmonary-fibrosis-progression\/train\/'+patient_id+'\/'+c_image)\n            axs[i, j].imshow(data.pixel_array, cmap=plt.cm.bone)\n            axs[i,j].set_title(c_image)\n    plt.show()\n    \n    # plot the FVC and percentage progression for the patient\n    data = train[train['Patient'] == patient_id]\n    plt.plot(data['Weeks'], data['FVC'],color = 'red')\n    plt.show()","738fed28":"patient_id = np.random.choice(train[(train['Percent']>80) & (train['Age'] < 55)]['Patient'].to_list())\nview_patient(patient_id)","b1e87474":"patient_id = np.random.choice(train[(train['Percent']>80) & (train['Age'] > 55)]['Patient'].to_list())\nview_patient(patient_id)","49d2e19e":"patient_id = np.random.choice(train[(train['Percent']<60) & (train['Age'] < 55)]['Patient'].to_list())\nview_patient(patient_id)","cbf6e682":"patient_id = np.random.choice(train[(train['Percent']<60) & (train['Age'] > 55)]['Patient'].to_list())\nview_patient(patient_id)","2ed99bcc":"patient_id = np.random.choice(train[(train['SmokingStatus'] == 'Currently smokes')]['Patient'].to_list())\nview_patient(patient_id)","bd2d7189":"patient_id = np.random.choice(train[(train['SmokingStatus'] == 'Never smoked')]['Patient'].to_list())\nview_patient(patient_id)","a4e3e971":"patient_id = np.random.choice(train[(train['SmokingStatus'] == 'Ex-smoker')]['Patient'].to_list())\nview_patient(patient_id)","2b105fa2":"### Visualize a patient with low percent and age >55","820abbe1":"## Look at a sample for each column type and number of uniques values in column","6caf1136":"### Number of unique patients","03b67902":"## Visualize a patient with high FVC and age 49-55","8b573cb1":"## FVC Distribution across different age group","1c58cacc":"### Average number of file per patient","a41e99e8":"## Check the CT Scan Progression of a sample patient from each category","23b30fc0":"### Graph for a smoker","8931998b":"## Percent distribution across different age groups","4b769dfe":"## Distribution of patients visit","608ea6ef":"## Visualize a patient with high FVC and age 55-65","98237b04":"## Age Distribution in train dataset[](http:\/\/)","849ce48b":"### Graph for a non-smoker","7720f770":"### progression graph for ex smokers","ede7dd84":"### Visualize a patient with low percent and age 45 - 55"}}