{"cell_type":{"8a84c5b2":"code","60f67a90":"code","be034731":"code","cb559b4c":"code","94217580":"code","1801f211":"code","06055a47":"code","a73b2b8a":"code","69df315b":"code","60e0d377":"code","d2fbeff5":"code","12da184c":"code","6b129789":"code","bc219a91":"code","709a32e9":"code","f4ed0c2a":"code","1c342b58":"code","b11fc3c0":"code","9528f766":"code","c884c0d0":"code","4430e281":"code","43bbcaf1":"code","de8e7b28":"code","f56da775":"code","fb0e36bd":"code","3eab4d56":"code","51f3deb2":"code","f37b6a6a":"code","ef8820aa":"code","fa01c55b":"code","0986d6dc":"code","b4d3fabe":"code","798eca1b":"code","43dedfb2":"markdown","aa936498":"markdown","b151bbbf":"markdown","cc303c98":"markdown","ba9d3b6a":"markdown","ed656587":"markdown","b1711a93":"markdown","9bf338ef":"markdown","9e495d23":"markdown","11c41b97":"markdown","2db5a001":"markdown","06275ae5":"markdown","6b9d6bb1":"markdown","4a79aecb":"markdown","96897be3":"markdown","f6c5a34d":"markdown","d78266f2":"markdown","9815e7bd":"markdown","94eeb334":"markdown","74811c90":"markdown","0f86a704":"markdown","2442d26e":"markdown","55381fb7":"markdown","e7f95adb":"markdown","c6ea3460":"markdown","e5345827":"markdown","f02cdc47":"markdown","1afcc7cd":"markdown"},"source":{"8a84c5b2":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","60f67a90":"import seaborn as sns\n\ndf = pd.read_csv('\/kaggle\/input\/irish-weather-hourly-data\/hourly_irish_weather.csv').iloc[:,1:]\n\n","be034731":"cols = df.columns.tolist()\ncols[0] = 'date_stamp'\ndf.columns = cols\n\ndf.isna().sum()","cb559b4c":"df[['date','timestamp']] = df['date_stamp'].str.split(' ',expand=True)\n\ndf[['year','month','day']] = df['date'].str.split('-',expand=True)\n\ndf['hour'] = df['timestamp'].str[0:2]","94217580":"df.head(5)","1801f211":"corr_matrx =df.corr()\ncorr_matrx","06055a47":"corr_matrx[(corr_matrx > 0.5) | (corr_matrx < - 0.5)]","a73b2b8a":"galway_df = df[(df['county'] == 'Galway') ]\ngalway_df.count()","69df315b":"import matplotlib.pyplot as plt\nimport matplotlib.ticker as ticker\n%matplotlib inline\n","60e0d377":"tmp_gpby =galway_df.groupby(['year','month']).agg({'temp':np.mean})\n\ntmp_gpby[tmp_gpby == np.nan].sum()","d2fbeff5":"rolling_index_diff_df = pd.DataFrame(pd.Series(galway_df[galway_df['temp'].isna()].index),columns=['index'])","12da184c":"\ncheck_list = galway_df['temp'].isna().index.tolist()\n\ndef impute():\n    \n    op = []\n    \n    for i in galway_df[galway_df['temp'].isna()].index:\n        [year,month] = galway_df.loc[i,['year','month']].tolist()\n        op.append(tmp_gpby.loc[(year,month)][0])\n    return op\n\nop = impute()\n\ngalway_df.loc[galway_df['temp'].isna(),'temp'] = op\n","6b129789":"galway_df.index = pd.DatetimeIndex(galway_df['date_stamp'])\n#galway_df.drop(columns=['date_stamp','rolling_temp','rolling_sd'],inplace=True)","bc219a91":"mean = galway_df['temp'].rolling(window = 24*30).mean()\nsd =  galway_df['temp'].rolling(window = 24*30).std()\n\ndummy = galway_df.copy()\ndummy['rolling_temp'] = mean\ndummy['rolling_sd'] =  sd\n\ngalway_df = dummy.copy()","709a32e9":"galway_df\n","f4ed0c2a":"galway_daywise_df = galway_df.groupby(['date']).agg({'temp':np.mean})\ngalway_daywise_df.index = pd.DatetimeIndex(galway_daywise_df.index)\ngalway_df.drop(columns=['w','ww','sun','vis','clht','clamt'],inplace=True) #no captures for this variables [**GALWAY***]","1c342b58":"import matplotlib.dates as mdates\n\n\n\nax = galway_daywise_df.plot(figsize=(20,10))\n\nax.xaxis.set_major_locator(mdates.YearLocator(1))\n# set formatter\nax.xaxis.set_major_formatter(mdates.DateFormatter('%Y'))\n\nax","b11fc3c0":"from statsmodels.tsa.stattools import adfuller\nadfuller(galway_daywise_df['temp'])\n\n#p-value is less than 0.05 (95% CI), so rejecting the null hypothesis, therefore at 95% confidence, we have enough evidence to\n#support the claim that the data is stationary","9528f766":"#Checking for the relationship between the current temperature observations and the lagged observations - should indicate either strong \n#positive or strong negative correlation - for the data to be stationary\nfrom pandas.plotting import lag_plot\nlag_plot(galway_daywise_df['temp'])","c884c0d0":"from statsmodels.graphics.tsaplots import plot_acf,plot_pacf\n\np = plot_acf(galway_daywise_df['temp'],lags=30)\n\np.set_size_inches(15, 8)","4430e281":"p = plot_pacf(galway_daywise_df['temp'],lags=30)\n\np.set_size_inches(15, 8)","43bbcaf1":"from statsmodels.tsa.seasonal import seasonal_decompose\n\nseasonal_decompose(galway_daywise_df['temp'],freq=30*12).plot();\n","de8e7b28":"galway_multivariate_df = galway_df.copy()\ngalway_multivariate_df.drop(columns=['station','county','longitude','latitude'],inplace=True)\ngalway_multivariate_df = galway_multivariate_df.iloc[:,0:14]\ngalway_multivariate_df.isna().sum()","f56da775":"multivariate_gpy = galway_multivariate_df.groupby(['year','month']).agg({'rain':'mean', 'temp':'mean', 'wetb':'mean', 'dewpt':'mean', 'vappr':'mean', 'rhum':'mean', 'msl':'mean', 'wdsp':'mean', 'wddir':'mean'})","fb0e36bd":"galway_multivariate_df = galway_multivariate_df.interpolate(method='time')","3eab4d56":"galway_multivariate_df.isna().sum()","51f3deb2":"galway_multivariate_daywise_df = galway_multivariate_df.groupby(['date']).agg({'rain':'mean', 'temp':'mean', 'wetb':'mean', 'dewpt':'mean', 'vappr':'mean', 'rhum':'mean', 'msl':'mean', 'wdsp':'mean', 'wddir':'mean'})\ngalway_multivariate_daywise_df.index = pd.DatetimeIndex(galway_multivariate_daywise_df.index)","f37b6a6a":"train = galway_multivariate_daywise_df.iloc[:4525,:]\ntest = galway_multivariate_daywise_df.iloc[4525:,:]\n\ntrain.index  = pd.DatetimeIndex(train.index).to_period('D')","ef8820aa":"from statsmodels.tsa.statespace.sarimax import SARIMAX\n\nmodel = SARIMAX(train['temp'],exog=train[['wdsp', 'vappr', 'wetb', 'dewpt', 'rhum', 'msl', 'rain', 'wddir']],order=(3, 0, 2), seasonal_order=(0,0,0,12))\n\nmodel_fit = model.fit()\n\n","fa01c55b":"yhat = model_fit.predict(4525, 4525+364,exog=test[['wdsp', 'vappr', 'wetb', 'dewpt', 'rhum', 'msl', 'rain', 'wddir']])\nprint(yhat)\n","0986d6dc":"prediction_df = yhat.to_frame()\nprediction_df['actual'] = test['temp'].values\n\nprediction_df.rename(columns={0:'pred'},inplace=True)\nprediction_df.index =  test.index\n\n\nprediction_df.plot(figsize=(20,12))","b4d3fabe":"model_fit.summary()\n","798eca1b":"from sklearn.metrics import mean_squared_error,mean_absolute_error\n\nprint(mean_squared_error(prediction_df['actual'],prediction_df['pred']))\nprint(mean_absolute_error(prediction_df['actual'],prediction_df['pred']))","43dedfb2":"High correlation between 1) Temp - Wet bulb temp - dew point temp - vapour pressure\n                         2) Cloud Ceiling Height - clamtCloud Amount","aa936498":"### SARIMAX - MULTIVARIATE","b151bbbf":"1 Grouping the county galway weather data using date column and collecting the mean aggregate for the Temperature     column\n\n2 Dropping the variables which has no data captured","cc303c98":"Filtering indexes of rows with null value for temperature","ba9d3b6a":"1) Plotting the day wise weather data for galway \n2) Configuring the plotting parameters","ed656587":"Training the data with SARIMAX model","b1711a93":"Seperating the date and time stamp into date, time, year, month, day and hour columns","9bf338ef":"Comparing the test set temperatures and forecasted temperatures by plotting them","9e495d23":"Getting the SARIMAX model summary ","11c41b97":"Exogenous variables are the variables which probably has relationship with dependent variable and influential in predicting the dependent variable ","2db5a001":"Modelling the galway county time series data using SARIMAX (Seasonal Auto Regression Integrating Moving Average with Exogeneous Variable) model ","06275ae5":"Filtering only the strongly correlated variables","6b9d6bb1":"Grouping the data by year and month and finding the mean for all the columns","4a79aecb":"User defined function to fill the missing values in Temperature variable\n\nThe missing values for a particular day and time are filled by that particular month's average temperature ","96897be3":"Decomposing the galway daywise weather time series data into Trend,Seasonality and Residuals \n\nThe frequency is set to year","f6c5a34d":"Forecasting the next 1 year data using the model built above and comparing the results with the test set 'temperature' values","d78266f2":"Correlation matrix between the variables in the dataframe","9815e7bd":"'Interpolating the multivariate time series data using time interpolation","94eeb334":"Subsetting only Galway weather data","74811c90":"Performing Augmented Dickey Fuller Test - A Statistical Test for checking the stationarity of the time series data\n\nNull Hypothesis : The data is not stationary\nAlternate Hpothesis: The data is stationary","0f86a704":"Ensuring no missing values after time interpolation","2442d26e":"Plotting Lag plot for correlation between current temperature and lagged observations and Auto Correlation Function (ACF) and Partial Autocorrelation Function (PACF) Plots for getting optimal 'p' and 'q' parameters of AR (Auto Regression) and MA (Moving Average) models","55381fb7":"Grouping the data by year and month and then aggregating the mean data for Temperature variable","e7f95adb":"Splitting the data into train set and test set\n\nTrain set is used for modelling and the test set is used for validating the model\n\nTrain set - Except last year data\nTest set - Last year data","c6ea3460":"Removing the default index column","e5345827":"Setting 'date_stamp' column as DateTime Index","f02cdc47":"Changing the column name 'date' to 'date_stamp' as it contains both date and time values","1afcc7cd":"Checking the variance in the forecasted values and the actual test values by getting the MSE (Mean Squared Error) and MAE (Mean Absolute Error)"}}