{"cell_type":{"84839867":"code","0f62299f":"code","432cd244":"code","aaffeaf6":"code","5876b75a":"code","45544c03":"code","470f1d31":"code","bfd17f78":"code","2924ece3":"code","a632d3eb":"code","f2e59a7f":"code","97ebbce9":"code","fc734d23":"code","c33eebb6":"markdown","d01bd876":"markdown","1d72e41b":"markdown","8919c6dd":"markdown","4e94f199":"markdown","374ccec1":"markdown"},"source":{"84839867":"import numpy as np\nimport tensorflow as tf \nimport matplotlib.pyplot as plt\nfrom tensorflow import keras\nimport tensorflow_hub as hub\n\n","0f62299f":"image_generator=tf.keras.preprocessing.image.ImageDataGenerator(rescale=1\/255,validation_split=0.2)\n\nimg_data_train=image_generator.flow_from_directory('..\/input\/waste-classification-data\/DATASET\/TRAIN',\n                                             target_size=(224,224),subset='training'\n                                             )\n\nimg_data_val=image_generator.flow_from_directory('..\/input\/waste-classification-data\/DATASET\/TRAIN',\n                                             target_size=(224,224),#Batch size can be changed ,by default its 32\n                                             subset='validation') ","432cd244":"img_data_train.class_indices","aaffeaf6":"for sample_batch,sample_label in img_data_train:\n    print(sample_batch.shape)\n    print(sample_label.shape)\n    break","5876b75a":"class_names=['Organic','Recyclable']","45544c03":"def display(img_batch,label_batch):\n    plt.figure(figsize=(10,9))\n    plt.subplots_adjust(wspace=0.7,hspace=0.7)\n    for i in range(30):\n        plt.subplot(6,5,i+1)\n        plt.imshow(img_batch[i])\n        plt.title(class_names[np.argmax(label_batch[i])])\n","470f1d31":"display(sample_batch,sample_label)","bfd17f78":"feature_extract_url=\"https:\/\/tfhub.dev\/tensorflow\/resnet_50\/feature_vector\/1\"\n\n    \nfeature_extraction_layer=hub.KerasLayer(str(feature_extract_url),input_shape=(224,224,3))\n\nfeature_extraction_layer.trainable=False","2924ece3":"\nmodel=tf.keras.Sequential([\nfeature_extraction_layer,\nkeras.layers.Dropout(0.5),\n\ntf.keras.layers.Dense(50,activation='relu'),\nkeras.layers.Dropout(0.3),\n    \ntf.keras.layers.Dense(img_data_train.num_classes,activation='sigmoid')\n])\n\nmodel.compile(optimizer='adam',loss='categorical_crossentropy',metrics=['accuracy'])\n\n","a632d3eb":"\nsteps=np.ceil(img_data_train.samples\/img_data_train.batch_size)\n\nhistory=model.fit(img_data_train,epochs=5,validation_data=img_data_val,steps_per_epoch=steps)","f2e59a7f":"test_data=image_generator.flow_from_directory(str('..\/input\/waste-classification-data\/DATASET\/TEST'),\n                                             target_size=(224,224),#Batch size can be changed ,by default its 32\n                                             )\n\nmodel.evaluate(test_data)","97ebbce9":"from keras.preprocessing import image\nfrom PIL import Image","fc734d23":"# FOR TESTING YOUR OWN IMAGE\n\nimg_path='..\/input\/usertest\/test.jpg'\nimg=image.load_img(img_path,target_size=(224,224))\nx=image.img_to_array(img)\nx=np.expand_dims(x,axis=0)\nx=x\/255\nprint('Input img shape:',x.shape)\n\nmy_img=Image.open(img_path)\nmy_img=my_img.resize((224,224))\nplt.imshow(my_img)\npred=model.predict(x)\nplt.title(f'Material is {class_names[np.argmax(pred)]}')","c33eebb6":"# Displaying a Sample of the Training Data","d01bd876":"# Data is sufficiently large , therefore model doesn't overfit for small number of epochs and generalizes well.\n\nSteps defines number of steps per epoch.","1d72e41b":"# Test your own Image :D\n\nJust change the path after uploading test image.","8919c6dd":"# Building a Model to Classify Waste as Organic or Recyclable!!\n\nImporting necessary libraries.","4e94f199":"****Using ResNet50 feature vector and Compiling using Adam Optimizer****","374ccec1":"# Test Accuracy:"}}