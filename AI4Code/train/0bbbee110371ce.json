{"cell_type":{"1c09d6ae":"code","80c4990f":"code","621c1e01":"code","fc438676":"code","dfcb0c50":"code","94e248c0":"code","976c2a27":"code","f71c2292":"code","cee29d15":"code","ad59eb3b":"code","8860a93c":"code","bf4e1b2c":"code","8de9cd1a":"code","d92e333e":"code","379e0d46":"code","e3c6ee6a":"code","97b33e49":"code","334c9d8b":"code","6382381c":"code","2def23df":"code","51612c61":"code","433a0dd4":"code","e4a9ea59":"code","6650da58":"markdown","d1eae665":"markdown","d1d95885":"markdown","62045015":"markdown","f392395c":"markdown","49e821e7":"markdown","91a619b4":"markdown","73503179":"markdown"},"source":{"1c09d6ae":"%config Completer.use_jedi = False\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nfrom tensorflow.keras.preprocessing.text import Tokenizer\nfrom tensorflow.keras.preprocessing.sequence import pad_sequences\nfrom tensorflow.keras.models import Sequential\nfrom tensorflow.keras.layers import Dense, Flatten, Conv1D, MaxPooling1D, GlobalMaxPooling1D, Dropout, Embedding\nfrom sklearn.model_selection import train_test_split","80c4990f":"data = pd.read_csv('..\/input\/us-consumer-finance-complaints\/consumer_complaints.csv')\ndata.head()","621c1e01":"data = data[['product', 'consumer_complaint_narrative']]\ndata.head()","fc438676":"data.isnull().sum()","dfcb0c50":"data.dropna(inplace=True)","94e248c0":"text = data['consumer_complaint_narrative'].tolist()","976c2a27":"product_category = list(data['product'].unique())\nlabels = []\nfor i in data['product']:\n    labels.append(product_category.index(i))\n    \nprint(labels[:10])","f71c2292":"print(product_category)","cee29d15":"token = Tokenizer()\ntoken.fit_on_texts(text)\nvocabs = token.index_word\nvocabs_len = len(token.word_index) + 1\nvocabs_len","ad59eb3b":"vocabs","8860a93c":"encoded_text = token.texts_to_sequences(text)\nprint(encoded_text[:3])","bf4e1b2c":"text_length = [len(i) for i in encoded_text[:10]]\nplt.bar([i for i in range(10)], text_length)\nplt.title('Text Length Variation')\nplt.ylabel('Length')\nplt.grid(True)\nplt.show()","8de9cd1a":"max_length = max(len(x) for x in encoded_text)\nmax_length","d92e333e":"X = pad_sequences(encoded_text, maxlen=max_length, padding='post')\nprint(X)","379e0d46":"X_train, X_test, y_train, y_test = train_test_split(X, np.array(labels), test_size=0.2, random_state=42)","e3c6ee6a":"vec_size = 300\n\nmodel = Sequential()\nmodel.add(Embedding(vocabs_len, vec_size, input_length=max_length))\n\nmodel.add(Conv1D(kernel_size=64, filters=8, activation='relu'))\nmodel.add(MaxPooling1D(2))\nmodel.add(Dropout(0.5))\n\nmodel.add(Dense(32, activation='relu'))\nmodel.add(Dropout(0.5))\n\nmodel.add(Dense(16, activation='relu'))\n\nmodel.add(GlobalMaxPooling1D())\n\nmodel.add(Dense(len(product_category), activation='softmax'))\n\nmodel.summary()","97b33e49":"model.compile(optimizer='adam', loss='sparse_categorical_crossentropy', metrics=['accuracy'])","334c9d8b":"history = model.fit(X_train, y_train, epochs = 5, validation_data=(X_test, y_test))","6382381c":"plt.plot(history.history['accuracy'], label='Train')\nplt.plot(history.history['val_accuracy'], label='Validation')\nplt.title('Model Accuracy')\nplt.ylabel('Accuracy')\nplt.xlabel('Epoch')\nplt.legend()\nplt.show()\n\nplt.plot(history.history['loss'], label='Train')\nplt.plot(history.history['val_loss'], label='Validation')\nplt.title('Model Loss')\nplt.ylabel('Loss')\nplt.xlabel('Epoch')\nplt.legend()\nplt.show()","2def23df":"model.save('classifier.model')","51612c61":"from tensorflow.keras.models import load_model\nmodel = load_model('.\/classifier.model')","433a0dd4":"test = ['I became past due on my Discover Credit Card last year. In an effort to remedy the situation I agreed to allow Discover to automatically debit my checking account in the amount of {$140.00} for 6 months. In exchange for allowing this to take place, Discover agreed to credit the monthly interest and late fees for the 6 month period, place a one time credit on my account of {$700.00} at the end of the 6 month period, and to \" re-age '' my account with the credit bureau so that the previously reported delinquent payment would be removed. This arrangement started on XXXX XXXX, 2015. After making the 6 on-time payments, Discover has informed me that they do n\\'t have notes showing me the {$700.00} payment promise. However, they do have notes on my account that reflect the promise to re-age my account, but they refuse to do so with the XXXX major credit bureaus.']\nencoded_test = token.texts_to_sequences(test)\ntest = pad_sequences(encoded_test, maxlen=max_length, padding='post')\ntest_predict = model.predict(test)\nprint(product_category[int(np.argmax(test_predict[0]))])","e4a9ea59":"test = ['Key Bank Collection Settlement called and asked to set up a payment plan because my loan had defaulted ( I did not default, I filed for bankruptcy and was told that immediately defaults this loan ). I agreed to making a regular monthly payment. I have repeatedly asked for a statement with the current balance and payment history and have not received one for months, although I continue sending payment for fear of defaulting. I believe my right is to receive written notice of the balances.']\nencoded_test = token.texts_to_sequences(test)\ntest = pad_sequences(encoded_test, maxlen=max_length, padding='post')\ntest_predict = model.predict(test)\nprint(product_category[int(np.argmax(test_predict[0]))])","6650da58":"### Accuracy - Loss Visualization","d1eae665":"### Encoding Labels","d1d95885":"## Consumer Compliant Classifier\n* As the consumer market increases, the compliants generated do increase and to resolve the problems quickly, identifying the compliant type is  necessary.\n* Thus a **Consumer Compliant Classifier** comes into picture.","62045015":"### Imports","f392395c":"### Removing Unwanted Data","49e821e7":"### Tokenizing text","91a619b4":"### Model Building","73503179":"### Testing on few examples"}}