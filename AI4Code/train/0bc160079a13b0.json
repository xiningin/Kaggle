{"cell_type":{"714f52d3":"code","ac362b37":"code","b9c599b4":"code","c0bd6056":"code","981d0a24":"code","dd34dfcc":"code","ce7ab425":"code","b46cd9f3":"code","6359be46":"code","495e8a73":"code","7f3ff788":"code","0147f169":"code","d8cbfd56":"code","c93d25eb":"code","fcc6e355":"code","241c2a48":"code","d66d55ba":"code","36ed9b6c":"code","cacf381b":"code","9dd82c1e":"code","e871b9b7":"code","bf8422a8":"code","3fe52f15":"code","74b77cd8":"code","3266ff62":"code","2d5783a8":"code","b7928de9":"code","c9dc2d3c":"code","066ab3a5":"code","f754503c":"code","38c21d44":"code","d9584ae8":"code","5207f124":"code","212716ea":"code","f40356fa":"code","fd8211e9":"code","e5eeb9ca":"code","0c42b268":"code","b4d686de":"code","83997ce8":"code","d3b4e139":"code","e0acb494":"code","37067467":"code","850ddbc6":"code","f328ddd4":"code","8b07dd68":"code","ec344686":"code","d489a316":"code","276c08a3":"code","5e0bd159":"code","5e0aa0e1":"code","d2b1ed08":"code","7fb5628d":"code","a9f39d0d":"code","b12d4ae8":"code","9153c698":"code","9b27cb15":"code","72a64359":"code","789d203e":"code","2c255213":"code","b631b6a4":"code","877e1bdb":"code","4ce13c65":"code","2038918c":"code","1369e38b":"code","71bc922f":"code","61c0b7e3":"code","d641d875":"code","3c62df4d":"code","b2e1ab9e":"code","bab54266":"code","52d49d18":"code","26da2c4b":"code","8a1a5450":"code","33b5fab0":"code","b3f4e3bf":"code","52732029":"code","1a8a963f":"markdown","fdbd700f":"markdown","71706e1e":"markdown","1fd5d9a9":"markdown","f2698978":"markdown","4d1bd702":"markdown","68084777":"markdown","b045d8e1":"markdown","082ea4b9":"markdown","02371ba8":"markdown","65da5a26":"markdown","d1b57d10":"markdown","9523fc4c":"markdown","2504fa64":"markdown","330a2a24":"markdown","901e609d":"markdown","be116982":"markdown","b50c50c8":"markdown","f76e67de":"markdown"},"source":{"714f52d3":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","ac362b37":"import matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline","b9c599b4":"delhi_housing = pd.read_csv('\/kaggle\/input\/delhi-house-price-prediction\/MagicBricks.csv')","c0bd6056":"delhi_housing.head()","981d0a24":"delhi_housing.info()","dd34dfcc":"delhi_housing.describe()","ce7ab425":"delhi_housing.columns","b46cd9f3":"sns.pairplot(delhi_housing)","6359be46":"sns.distplot(delhi_housing['Price'])","495e8a73":"sns.heatmap(delhi_housing.corr(),annot=True)","7f3ff788":"sns.heatmap(delhi_housing.isnull(),yticklabels=False,cbar=False,cmap='viridis')","0147f169":"delhi_housing.drop('Per_Sqft',axis=1,inplace=True)","d8cbfd56":"sns.heatmap(delhi_housing.isnull(),yticklabels=False,cbar=False,cmap='viridis')","c93d25eb":"delhi_housing['Parking'].mean()","fcc6e355":"delhi_housing['Parking'].unique()","241c2a48":"def average(parking):\n    if pd.isnull(parking):\n        return 2\n    else:\n        return parking","d66d55ba":"delhi_housing['Parking'] = delhi_housing['Parking'].apply(average)","36ed9b6c":"delhi_housing['Parking'].unique()","cacf381b":"sns.heatmap(delhi_housing.isnull(),yticklabels=False,cbar=False,cmap='viridis')","9dd82c1e":"delhi_housing.dropna(inplace=True)","e871b9b7":"sns.heatmap(delhi_housing.isnull(),yticklabels=False,cbar=False,cmap='viridis')","bf8422a8":"delhi_housing.info()","3fe52f15":"delhi_housing['Furnishing'].unique()","74b77cd8":"furnished = pd.get_dummies(delhi_housing['Furnishing'],drop_first=True)","3266ff62":"delhi_housing['Status'].unique()","2d5783a8":"status = pd.get_dummies(delhi_housing['Status'],drop_first=True)","b7928de9":"status","c9dc2d3c":"delhi_housing['Transaction'].unique()","066ab3a5":"transaction = pd.get_dummies(delhi_housing['Transaction'],drop_first=True)","f754503c":"delhi_housing['Type'].unique()","38c21d44":"types = pd.get_dummies(delhi_housing['Type'],drop_first=True)","d9584ae8":"locality=pd.get_dummies(delhi_housing['Locality'],drop_first=True)","5207f124":"locality","212716ea":"delhi_housing.drop(['Furnishing','Status','Transaction','Type','Locality'],axis=1,inplace=True)","f40356fa":"delhi_housing = pd.concat([delhi_housing,furnished,status,transaction,types,locality ],axis=1)","fd8211e9":"delhi_housing.head()","e5eeb9ca":"delhi_housing.columns","0c42b268":"X = delhi_housing.loc[:, delhi_housing.columns != 'Price']\ny = delhi_housing['Price']","b4d686de":"X","83997ce8":"y","d3b4e139":"from sklearn.model_selection import train_test_split","e0acb494":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3)","37067467":"from sklearn.linear_model import LinearRegression","850ddbc6":"lm = LinearRegression()","f328ddd4":"lm.fit(X_train,y_train)","8b07dd68":"print(lm.intercept_)","ec344686":"coeff_df = pd.DataFrame(lm.coef_,X.columns,columns=['Coefficient'])\ncoeff_df","d489a316":"predictions = lm.predict(X_test)","276c08a3":"plt.scatter(y_test,predictions)","5e0bd159":"sns.distplot((y_test-predictions),bins=50);","5e0aa0e1":"from sklearn import metrics","d2b1ed08":"print('MAE:', metrics.mean_absolute_error(y_test, predictions))\nprint('MSE:', metrics.mean_squared_error(y_test, predictions))\nprint('RMSE:', np.sqrt(metrics.mean_squared_error(y_test, predictions)))","7fb5628d":"from sklearn.preprocessing import MinMaxScaler","a9f39d0d":"scaler = MinMaxScaler()","b12d4ae8":"X_train","9153c698":"X_train= scaler.fit_transform(X_train)","9b27cb15":"X_train","72a64359":"X_test = scaler.transform(X_test)","789d203e":"X_train.shape","2c255213":"X_test.shape","b631b6a4":"from tensorflow.keras.models import Sequential\nfrom tensorflow.keras.layers import Dense, Activation\nfrom tensorflow.keras.optimizers import Adam\nfrom tensorflow.keras.layers import Dropout","877e1bdb":"from tensorflow.keras.callbacks import EarlyStopping","4ce13c65":"early_stop = EarlyStopping(monitor='val_loss', mode='min', verbose=1, patience=25)","2038918c":"model = Sequential()\n\nmodel.add(Dense(371,activation='relu'))\nmodel.add(Dropout(0.5))\n\nmodel.add(Dense(185,activation='relu'))\nmodel.add(Dropout(0.5))\nmodel.add(Dense(93,activation='relu'))\nmodel.add(Dropout(0.5))\nmodel.add(Dense(46,activation='relu'))\nmodel.add(Dropout(0.5))\nmodel.add(Dense(1))\n\nmodel.compile(optimizer='adam',loss='mse')","1369e38b":"model.fit(x=X_train,y=y_train.values,\n          validation_data=(X_test,y_test.values),\n          epochs=10000,callbacks=[early_stop])","71bc922f":"losses = pd.DataFrame(model.history.history)","61c0b7e3":"losses.plot()","d641d875":"from sklearn.metrics import mean_squared_error,mean_absolute_error,explained_variance_score","3c62df4d":"predictions = model.predict(X_test)","b2e1ab9e":"mean_absolute_error(y_test,predictions)","bab54266":"np.sqrt(mean_squared_error(y_test,predictions))","52d49d18":"explained_variance_score(y_test,predictions)","26da2c4b":"# Our predictions\nplt.scatter(y_test,predictions)\n\n# Perfect predictions\nplt.plot(y_test,y_test,'r')","8a1a5450":"single_house = delhi_housing.drop('Price',axis=1).iloc[0]","33b5fab0":"single_house = scaler.transform(single_house.values.reshape(-1, 371))","b3f4e3bf":"delhi_housing['Price'][0]","52732029":"model.predict(single_house)","1a8a963f":"we can see that Parking cloumn has an average value of 1.9 therefore we will be filling the missing parking values with 2(as parking can only be a whole no)","fdbd700f":"The no of missing value is very low we can now simply delete them","71706e1e":"splitting the data into training and test set","1fd5d9a9":"training the model in ANN","f2698978":"seperating target columns from features","4d1bd702":"applying LinerRegression","68084777":"Dont know why but the model performed very bad","b045d8e1":"scaling the data to put into ANN","082ea4b9":"Lets see how much of our Data is missing","02371ba8":"got an explained variance of 73%","65da5a26":"Adding Dummy variables for Categorical Columns","d1b57d10":"From paiplot we see that area,BHK,Bathroom has good correlation with price","9523fc4c":"atlest it performed better than LinearRegression","2504fa64":"Getting the Dataset","330a2a24":"Importing Visualization Libraries","901e609d":"We can see there is lot of missing data in Per_Sqft and a little bit in Parking and seems like one in Bathroom.Lets handle it","be116982":"Predicting the price of a single house","b50c50c8":"Per_Sqft is Price\/Area as we have both these field therefore it is information duplication we can delete this column","f76e67de":"Heatmap shows result of pairplot in a better way"}}