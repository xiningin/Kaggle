{"cell_type":{"7dcdd63e":"code","87972a97":"code","aa80b69c":"code","4c562475":"code","9eebba17":"code","6e6a6e45":"code","8c12a0c3":"code","714e7749":"code","aeaa8a72":"code","1fce27bd":"code","41c87a69":"code","bc7811fa":"code","48e5e172":"code","28dbac8a":"code","bdb606e8":"code","08d894b8":"code","e941423f":"code","079ccfc4":"code","52276c1a":"code","ba16a305":"code","dabf3613":"code","6acd5084":"code","9e564afb":"code","cf3179e0":"code","933651f8":"code","e6429655":"code","8a97d65a":"code","41bc504b":"code","4a0d0f6e":"code","cfe99a47":"code","98935813":"code","71f47123":"markdown","8a3278df":"markdown","855cf8ef":"markdown","400e4176":"markdown","c89d72ac":"markdown"},"source":{"7dcdd63e":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","87972a97":"data = pd.read_csv('..\/input\/red-wine-quality-cortez-et-al-2009\/winequality-red.csv')\ndata.head()","aa80b69c":"data.shape","4c562475":"data.info()","9eebba17":"data.columns","6e6a6e45":"data.isnull().sum()","8c12a0c3":"data.describe()","714e7749":"import seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline\nsns.set_style('darkgrid')\nimport warnings\nwarnings.filterwarnings(\"ignore\")","aeaa8a72":"sns.countplot(x=data['quality'], data=data)","1fce27bd":"sns.histplot(x=data['citric acid'], data=data)","41c87a69":"sns.histplot(data['fixed acidity'])","bc7811fa":"sns.histplot(x=data['volatile acidity'])","48e5e172":"sns.histplot(x=data['citric acid'], data=data)","28dbac8a":"sns.histplot(x=data['residual sugar'], kde=False, bins=20)","bdb606e8":"sns.histplot(x=data['alcohol'], kde=False, bins=20)","08d894b8":"sns.histplot(data['pH'])","e941423f":"plt.figure(figsize=(10, 6))\nsns.heatmap(data.corr(), annot=True, cmap=\"Blues\", fmt=\".2f\")","079ccfc4":"sns.pairplot(data)","52276c1a":"fig, ax = plt.subplots(ncols=6, nrows=2, figsize=(15, 8))\nindex = 0\nax = ax.flatten()\n\nfor col, value in data.items():\n    sns.boxplot(y=col, data=data, color='r', ax=ax[index])\n    index += 1\n    \nplt.tight_layout(pad=0.5, w_pad = 0.7, h_pad =5.0)","ba16a305":"## As we can see there are lot of outliers, so will remove them by using the IQRange\ndef remove_outliers(data):\n    data1 = data.copy()\n    data = data._get_numeric_data()\n    q1 = data.quantile(0.25)\n    q3 = data.quantile(0.75)\n    \n    iqr = q3 - q1\n    \n    lower_bound = q1 - (1.5 * iqr)\n    upper_bound = q3 + (1.5 * iqr)\n    \n    for col in data.columns:\n        for i in range(0, len(data[col])):\n            if data[col][i] < lower_bound[col]:\n                data[col][i] = lower_bound[col]\n            \n            if data[col][i] > upper_bound[col]:\n                data[col][i] = upper_bound[col]\n                \n    for col in data.columns:\n        data1[col] = data[col]\n        \n    return (data1)\n\ndata = remove_outliers(data)","dabf3613":"fig, ax = plt.subplots(ncols=6, nrows=2, figsize=(15, 8))\nindex = 0\nax = ax.flatten()\n\nfor col, value in data.items():\n    sns.boxplot(y=col, data=data, color='r', ax=ax[index])\n    index += 1\n    \nplt.tight_layout(pad=0.5, w_pad = 0.7, h_pad =5.0)","6acd5084":"X = data.drop('quality', axis=1)\ny = data.quality","9e564afb":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42)","cf3179e0":"from sklearn.linear_model import LinearRegression","933651f8":"lr = LinearRegression()\nlr.fit(X_train, y_train)","e6429655":"y_pred = lr.predict(X_test)","8a97d65a":"lr.coef_","41bc504b":"lr.intercept_","4a0d0f6e":"from sklearn import metrics","cfe99a47":"print('MAE:', metrics.mean_absolute_error(y_test, y_pred))\nprint('MSE:', metrics.mean_squared_error(y_test, y_pred))\nprint('RMSE:', np.sqrt(metrics.mean_squared_error(y_pred, y_test)))","98935813":"print('R squared:', lr.score(X_test, y_test))","71f47123":"### Spliting the dataset into X and Y","8a3278df":"### DATA VISUALIZATION","855cf8ef":"### Implementing Linear Regression","400e4176":"Insights from the above figure:\n- Alcohol is positively co-realated with the quality of the red wine.\n- Alcohol has a week positive co-relation with the pH value.\n- Citric acid and density have a strong positive co-relation with the fixed acidity.","c89d72ac":"### Lets check the outliers in our dataset"}}