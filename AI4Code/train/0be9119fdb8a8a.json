{"cell_type":{"ee3f918e":"code","0ebec0aa":"code","951fb51d":"code","3f36bcc9":"code","0fb6de6e":"code","fe0608e1":"code","409f25e1":"code","2e5fa4e7":"code","f45ad9ce":"code","0897bdc4":"code","67f60172":"code","48c85f4f":"code","7b09dd30":"code","9249f270":"code","01b2925a":"code","e00dbbfc":"code","96f527d5":"code","8f7bdbc1":"code","74294eb0":"code","04861821":"code","fd9e4b3a":"code","0f43148f":"code","d54b6bef":"code","adcf9111":"code","bc425439":"code","8e957814":"code","10f8edb9":"code","81b83f5d":"markdown","ea9f5ce2":"markdown","547202c4":"markdown","b7feae6b":"markdown","f613fdfd":"markdown","36bab30b":"markdown","cff446f7":"markdown","ac9a6a35":"markdown","6203f697":"markdown","ee7e0931":"markdown","ed65f88d":"markdown"},"source":{"ee3f918e":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport statsmodels.graphics.tsaplots as sgt\nimport statsmodels.tsa.stattools as sts\nfrom statsmodels.tsa.arima_model import ARIMA\nfrom scipy.stats.distributions import chi2 \nfrom math import sqrt\nimport seaborn as sns\nsns.set()","0ebec0aa":"raw_csv_data = pd.read_csv(\"..\/input\/financial-markets\/Index2018.csv\") \ndf_comp=raw_csv_data.copy()\ndf_comp.date = pd.to_datetime(df_comp.date, dayfirst = True)\ndf_comp.set_index(\"date\", inplace=True)\ndf_comp=df_comp.asfreq('b')\ndf_comp=df_comp.fillna(method='ffill')","951fb51d":"df_comp['market_value']=df_comp.ftse","3f36bcc9":"import warnings\nwarnings.filterwarnings(\"ignore\")","0fb6de6e":"#del df_comp['spx']\n#del df_comp['dax']\n#del df_comp['ftse']\n#del df_comp['nikkei']\nsize = int(len(df_comp)*0.8)\ndf, df_test = df_comp.iloc[:size], df_comp.iloc[size:]","fe0608e1":"def LLR_test(mod_1, mod_2, DF = 1):\n    L1 = mod_1.fit().llf\n    L2 = mod_2.fit().llf\n    LR = (2*(L2-L1))    \n    p = chi2.sf(LR, DF).round(3)\n    return p","409f25e1":"df['returns'] = df.market_value.pct_change(1)*100","2e5fa4e7":"model_ar_1_i_1_ma_1 = ARIMA(df.market_value, order=(1,1,1))\nresults_ar_1_i_1_ma_1 = model_ar_1_i_1_ma_1.fit()\nresults_ar_1_i_1_ma_1.summary()","f45ad9ce":"df['res_ar_1_i_1_ma_1'] = results_ar_1_i_1_ma_1.resid\nsgt.plot_acf(df.res_ar_1_i_1_ma_1, zero = False, lags = 40)\nplt.title(\"ACF Of Residuals for ARIMA(1,1,1)\",size=20)\nplt.show()","0897bdc4":"df['res_ar_1_i_1_ma_1'] = results_ar_1_i_1_ma_1.resid.iloc[:]\nsgt.plot_acf(df.res_ar_1_i_1_ma_1[1:], zero = False, lags = 40)\nplt.title(\"ACF Of Residuals for ARIMA(1,1,1)\",size=20)\nplt.show()","67f60172":"model_ar_1_i_1_ma_2 = ARIMA(df.market_value, order=(1,1,2))\nresults_ar_1_i_1_ma_2 = model_ar_1_i_1_ma_2.fit()\nmodel_ar_1_i_1_ma_3 = ARIMA(df.market_value, order=(1,1,3))\nresults_ar_1_i_1_ma_3 = model_ar_1_i_1_ma_3.fit()\nmodel_ar_2_i_1_ma_1 = ARIMA(df.market_value, order=(2,1,1))\nresults_ar_2_i_1_ma_1 = model_ar_2_i_1_ma_1.fit()\nmodel_ar_3_i_1_ma_1 = ARIMA(df.market_value, order=(3,1,1))\nresults_ar_3_i_1_ma_1 = model_ar_3_i_1_ma_1.fit()\nmodel_ar_3_i_1_ma_2 = ARIMA(df.market_value, order=(3,1,2))\nresults_ar_3_i_1_ma_2 = model_ar_3_i_1_ma_2.fit(start_ar_lags=5)","48c85f4f":"print(\"ARIMA(1,1,1):  \\t LL = \", results_ar_1_i_1_ma_1.llf, \"\\t AIC = \", results_ar_1_i_1_ma_1.aic)\nprint(\"ARIMA(1,1,2):  \\t LL = \", results_ar_1_i_1_ma_2.llf, \"\\t AIC = \", results_ar_1_i_1_ma_2.aic)\nprint(\"ARIMA(1,1,3):  \\t LL = \", results_ar_1_i_1_ma_3.llf, \"\\t AIC = \", results_ar_1_i_1_ma_3.aic)\nprint(\"ARIMA(2,1,1):  \\t LL = \", results_ar_2_i_1_ma_1.llf, \"\\t AIC = \", results_ar_2_i_1_ma_1.aic)\nprint(\"ARIMA(3,1,1):  \\t LL = \", results_ar_3_i_1_ma_1.llf, \"\\t AIC = \", results_ar_3_i_1_ma_1.aic)\nprint(\"ARIMA(3,1,2):  \\t LL = \", results_ar_3_i_1_ma_2.llf, \"\\t AIC = \", results_ar_3_i_1_ma_2.aic)","7b09dd30":"print(\"\\nLLR test p-value = \" + str(LLR_test(model_ar_1_i_1_ma_2, model_ar_1_i_1_ma_3)))","9249f270":"print(\"\\nLLR test p-value = \" + str(LLR_test(model_ar_1_i_1_ma_1, model_ar_1_i_1_ma_3, DF = 2)))","01b2925a":"df['res_ar_1_i_1_ma_3'] = results_ar_1_i_1_ma_3.resid\nsgt.plot_acf(df.res_ar_1_i_1_ma_3[1:], zero = False, lags = 40)\nplt.title(\"ACF Of Residuals for ARIMA(1,1,3)\", size=20)\nplt.show()","e00dbbfc":"model_ar_5_i_1_ma_1 = ARIMA(df.market_value, order=(5,1,1))\nresults_ar_5_i_1_ma_1 = model_ar_5_i_1_ma_1.fit(start_ar_lags=11)\nmodel_ar_6_i_1_ma_3 = ARIMA(df.market_value, order=(6,1,3))\nresults_ar_6_i_1_ma_3 = model_ar_6_i_1_ma_3.fit(start_ar_lags=11)","96f527d5":"results_ar_5_i_1_ma_1.summary()","8f7bdbc1":"print(\"ARIMA(1,1,3):  \\t LL = \", results_ar_1_i_1_ma_3.llf, \"\\t AIC = \", results_ar_1_i_1_ma_3.aic)\nprint(\"ARIMA(5,1,1):  \\t LL = \", results_ar_5_i_1_ma_1.llf, \"\\t AIC = \", results_ar_5_i_1_ma_1.aic)\nprint(\"ARIMA(6,1,3):  \\t LL = \", results_ar_6_i_1_ma_3.llf, \"\\t AIC = \", results_ar_6_i_1_ma_3.aic)","74294eb0":"print(\"\\nLLR test p-value = \" + str(LLR_test(model_ar_1_i_1_ma_3, model_ar_6_i_1_ma_3, DF = 5)))","04861821":"print(\"\\nLLR test p-value = \" + str(LLR_test(model_ar_5_i_1_ma_1, model_ar_6_i_1_ma_3, DF = 3)))","fd9e4b3a":"df['res_ar_5_i_1_ma_1'] = results_ar_5_i_1_ma_1.resid\nsgt.plot_acf(df.res_ar_5_i_1_ma_1[1:], zero = False, lags = 40)\nplt.title(\"ACF Of Residuals for ARIMA(5,1,1)\", size=20)\nplt.show()\n\nplt.plot(df.res_ar_5_i_1_ma_1)\nplt.title(\"Plots Residuals for ARIMA(5,1,1)\", size=20)\nplt.show()","0f43148f":"df['delta_prices']=df.market_value.diff(1)","d54b6bef":"model_delta_ar_1_i_1_ma_1 = ARIMA(df.delta_prices[1:], order=(1,0,1))\nresults_delta_ar_1_i_1_ma_1 = model_delta_ar_1_i_1_ma_1.fit()\nresults_delta_ar_1_i_1_ma_1.summary()","adcf9111":"sts.adfuller(df.delta_prices[1:])","bc425439":"model_ar_1_i_2_ma_1 = ARIMA(df.market_value, order=(1,2,1))\nresults_ar_1_i_2_ma_1 = model_ar_1_i_2_ma_1.fit(start_ar_lags=10)\nresults_ar_1_i_2_ma_1.summary()","8e957814":"df['res_ar_1_i_2_ma_1'] = results_ar_1_i_2_ma_1.resid.iloc[:]\nsgt.plot_acf(df.res_ar_1_i_2_ma_1[2:], zero = False, lags = 40)\nplt.title(\"ACF Of Residuals for ARIMA(1,2,1)\",size=20)\nplt.show()","10f8edb9":"model_ar_1_i_1_ma_1_Xspx = ARIMA(df.market_value, exog = df.spx, order=(1,1,1))\nresults_ar_1_i_1_ma_1_Xspx = model_ar_1_i_1_ma_1_Xspx.fit()\nresults_ar_1_i_1_ma_1_Xspx.summary()","81b83f5d":"2008 y\u0131l\u0131nda hatalardaki art\u0131\u015f\u0131n sebebi kriz d\u00f6nemlerinde ekonomilerin modellenebilir ve \u00f6ng\u00f6r\u00fclebilir olmaktan \u00e7\u0131kmas\u0131d\u0131r.","ea9f5ce2":"## The LLR Test","547202c4":"## Models with Higher Levels of Integration","b7feae6b":"## ARIMAX ","f613fdfd":"## Residuals of the ARIMA(1,1,1)","36bab30b":"## Importing the relevant packages","cff446f7":"## Importing the Data and Pre-processing ","ac9a6a35":"Grafi\u011fin d\u00fcz \u00e7izgi \u015feklinde olmas\u0131n\u0131n sebebi 0. hata teriminden \u00f6nce herhangi bir hesaplama olmad\u0131d\u011f\u0131 i\u00e7in bir hata da yoktur. Dolay\u0131s\u0131yla 1. index'ten sonras\u0131n\u0131 almam\u0131z gerekiyor.","6203f697":"## Higher-Lag ARIMA Models","ee7e0931":"## Creating Returns","ed65f88d":"## ARIMA(1,1,1)"}}