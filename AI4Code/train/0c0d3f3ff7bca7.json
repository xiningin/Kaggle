{"cell_type":{"ff757b2e":"code","a9e1fc57":"code","89ebba6c":"code","26971457":"code","52f4e471":"code","cc2df754":"code","e8cc40f2":"code","9774461f":"code","90c2a48f":"code","54306372":"code","e46a17d5":"code","080b0c45":"code","3088c059":"markdown","17546e4a":"markdown","5faffac5":"markdown","3940093f":"markdown","8a2246b7":"markdown","2dfed427":"markdown"},"source":{"ff757b2e":"import os\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport matplotlib.image as mpimg\nimport tensorflow as tf\nimport pickle\nfrom tensorflow import keras\nimport zipfile\nfrom keras.models import load_model\nfrom sklearn.model_selection import train_test_split\nfrom tensorflow.keras.models import Sequential\nfrom tensorflow.keras.layers import *\nfrom tensorflow.keras.preprocessing.image import ImageDataGenerator","a9e1fc57":"#Load the test data into a DataFrame named 'test' and Print the shape of the resulting DataFrame. \ntest = pd.read_csv('..\/input\/cifar10-mu\/sample_submission.csv')\nprint('Test Set Size:', test.shape)\n","89ebba6c":"# Display the head of the test DataFrame. \ntest.head()","26971457":"test_path = \"..\/input\/cifar10-mu\/test_images\/\"\nprint('Test Images:', len(os.listdir(test_path)))","52f4e471":"BATCH_SIZE = 64\n\ntest_datagen = ImageDataGenerator(rescale=1\/255)\n\ntest_loader = test_datagen.flow_from_dataframe(\n    dataframe = test,\n    directory = test_path,\n    x_col = 'filename',\n    batch_size = BATCH_SIZE,\n    shuffle = False,\n    class_mode = None,\n    target_size = (32,32)\n)","cc2df754":"cnn = keras.models.load_model('..\/input\/cifar-10withcorrection\/CIFAR10_model.h5')\ncnn.summary()","e8cc40f2":"test_probs = cnn.predict(test_loader)\nprint(test_probs.shape)","9774461f":"print(test_probs[:10,].round(2))","90c2a48f":"test_pred = np.argmax(test_probs, axis = 1)\nprint(test_pred[:10])","54306372":"submission = pd.read_csv('..\/input\/cifar10-mu\/sample_submission.csv')\nsubmission.head()","e46a17d5":"submission.label = test_pred[:]\nsubmission.head()","080b0c45":"submission.to_csv('submission.csv', header=True, index=False)","3088c059":"# Load Dataframe","17546e4a":"# Prepare Submission","5faffac5":"# Load Model","3940093f":"# Data Generate","8a2246b7":"# Extract Images","2dfed427":"# Test Predictions"}}