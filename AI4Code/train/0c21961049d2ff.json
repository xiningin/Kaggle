{"cell_type":{"d99e53fd":"code","dac03215":"code","5e03e6fc":"code","b62f377d":"code","13aab340":"code","b9e6b74b":"code","64107305":"code","ab7838da":"code","226996c8":"code","6b347ca8":"code","2b37779b":"code","0499acbc":"code","73fe878a":"code","73194a1d":"code","347f55b0":"code","2b7c0825":"code","be72620b":"code","77a22c2b":"code","6c3a3a2d":"code","1716ac16":"code","0062aff3":"code","da6f6f0b":"code","8c2e3505":"code","31ade8f6":"code","d5fec55a":"code","081bc642":"code","6e82e935":"code","f2fd436a":"code","bb502722":"code","c17a06ca":"code","27111ead":"code","6e31fdfa":"code","9ca4fbe2":"code","0f0981ec":"code","0e3b7c08":"code","91bd9bd1":"code","1f435130":"code","ba590c3c":"code","bd39a80a":"code","48131324":"code","8dc4e237":"code","4f027e92":"code","f1418e18":"code","a69b939c":"markdown","8b23797e":"markdown"},"source":{"d99e53fd":"import pandas as pd\nfrom sklearn.metrics import mean_absolute_error\n\ndf = pd.read_csv('..\/input\/tabular-playground-series-apr-2021\/train.csv')","dac03215":"full_rows = df.dropna().copy()\nfull_rows[\"Age01_mean\"] = df.Age.mean()","5e03e6fc":"mae_age01_mean = mean_absolute_error(full_rows.Age, full_rows[\"Age01_mean\"])\nprecision = 3\nround(mae_age01_mean, precision)","b62f377d":"male_mean_age = df[df.Sex == 'male'].Age.mean()\nmale_mean_age\n\nfemale_mean_age = df[df.Sex == 'female'].Age.mean()\nfemale_mean_age\n\nfull_rows[\"Age02_sex\"] = full_rows.Sex.apply(lambda x: female_mean_age if (x == 'female') else male_mean_age)","13aab340":"mae_age02_sex = mean_absolute_error(full_rows.Age, full_rows[\"Age02_sex\"])\nround(mae_age02_sex, precision)","b9e6b74b":"first_class_mean_age = df[df.Pclass == 1].Age.mean()\nsecond_class_mean_age = df[df.Pclass == 2].Age.mean()\nthird_class_mean_age = df[df.Pclass == 3].Age.mean()","64107305":"def age_pclass(x):\n    return { 1 : first_class_mean_age, 2: second_class_mean_age, 3: third_class_mean_age}[x]\n\nfull_rows[\"Age03_pclass\"] = full_rows.Pclass.apply(lambda x: age_pclass(x))","ab7838da":"mae_age03_pclass =  mean_absolute_error(full_rows.Age, full_rows[\"Age03_pclass\"])\nround(mae_age03_pclass, precision)","226996c8":"df.SibSp.unique()","6b347ca8":"sibSp0_mean_age = df[df.SibSp == 0].Age.mean()\nsibSp1_mean_age = df[df.SibSp == 1].Age.mean()\nsibSp2_mean_age = df[df.SibSp == 2].Age.mean()\nsibSp3_mean_age = df[df.SibSp == 3].Age.mean()\nsibSp4_mean_age = df[df.SibSp == 4].Age.mean()\nsibSp5_mean_age = df[df.SibSp == 5].Age.mean()\nsibSp8_mean_age = df[df.SibSp == 8].Age.mean()","2b37779b":"def age_sibsp(x):\n    return { 0 : sibSp0_mean_age, 1: sibSp1_mean_age, 2: sibSp2_mean_age, \n           3: sibSp3_mean_age, 4: sibSp4_mean_age, 5: sibSp5_mean_age, 8: sibSp8_mean_age}[x]\n\nfull_rows[\"Age04_sibsp\"] = full_rows.SibSp.apply(lambda x: age_sibsp(x))","0499acbc":"mae_age04_sibsp = mean_absolute_error(full_rows.Age, full_rows[\"Age04_sibsp\"])\nround(mae_age04_sibsp, precision)","73fe878a":"df.Parch.unique()","73194a1d":"parch0_mean_age = df[df.Parch == 0].Age.mean()\nparch1_mean_age = df[df.Parch == 1].Age.mean()\nparch2_mean_age = df[df.Parch == 2].Age.mean()\nparch3_mean_age = df[df.Parch == 3].Age.mean()\nparch4_mean_age = df[df.Parch == 4].Age.mean()\nparch5_mean_age = df[df.Parch == 5].Age.mean()\nparch6_mean_age = df[df.Parch == 6].Age.mean()\nparch9_mean_age = df[df.Parch == 9].Age.mean()","347f55b0":"def age_parch(x):\n    return { 0 : parch0_mean_age, 1: parch1_mean_age, 2: parch2_mean_age, \n           3: parch3_mean_age, 4: parch4_mean_age, 5: parch5_mean_age, 6: parch6_mean_age, 9: parch9_mean_age}[x]\n\nfull_rows[\"Age05_parch\"] = full_rows.Parch.apply(lambda x: age_parch(x))","2b7c0825":"mae_age05_parch = mean_absolute_error(full_rows.Age, full_rows[\"Age05_parch\"])\nround(mae_age05_parch, precision)","be72620b":"df.Embarked.unique()","77a22c2b":"embarked_C_mean_age = df[df.Embarked == 'C'].Age.mean()\nembarked_Q_mean_age = df[df.Embarked == 'Q'].Age.mean()\nembarked_S_mean_age = df[df.Embarked == 'S'].Age.mean()","6c3a3a2d":"def age_embarked(x):\n    return { 'C' : embarked_C_mean_age, 'Q': embarked_Q_mean_age, 'S': embarked_S_mean_age}[x]\n\nfull_rows[\"Age06_embarked\"] = full_rows.Embarked.apply(lambda x: age_embarked(x))","1716ac16":"mae_age06_embarked = mean_absolute_error(full_rows.Age, full_rows[\"Age06_embarked\"])\nround(mae_age06_embarked, precision)","0062aff3":"full_rows[\"Age07_SexPClassEmbarkedMean\"] = (full_rows[\"Age02_sex\"] + full_rows[\"Age03_pclass\"] + full_rows[\"Age06_embarked\"]) \/3","da6f6f0b":"mae_age07_sex_pclass_embarked_mean = mean_absolute_error(full_rows.Age, full_rows[\"Age07_SexPClassEmbarkedMean\"])\nround(mae_age07_sex_pclass_embarked_mean, 3)","8c2e3505":"full_rows[\"Age08_PClassEmbarkedMean\"] = ( full_rows[\"Age03_pclass\"] + full_rows[\"Age06_embarked\"]) \/2","31ade8f6":"mae_age08_pclass_embarked_mean = mean_absolute_error(full_rows.Age, full_rows[\"Age08_PClassEmbarkedMean\"])\nround(mae_age08_pclass_embarked_mean, precision)","d5fec55a":"class1_c_mean_age = df[(df.Pclass == 1) & (df.Embarked == 'C')].Age.mean()\nclass1_q_mean_age = df[(df.Pclass == 1) & (df.Embarked == 'Q')].Age.mean()\nclass1_s_mean_age = df[(df.Pclass == 1) & (df.Embarked == 'S')].Age.mean()\n\nclass2_c_mean_age = df[(df.Pclass == 2) & (df.Embarked == 'C')].Age.mean()\nclass2_q_mean_age = df[(df.Pclass == 2) & (df.Embarked == 'Q')].Age.mean()\nclass2_s_mean_age = df[(df.Pclass == 2) & (df.Embarked == 'S')].Age.mean()\n\nclass3_c_mean_age = df[(df.Pclass == 3) & (df.Embarked == 'C')].Age.mean()\nclass3_q_mean_age = df[(df.Pclass == 3) & (df.Embarked == 'Q')].Age.mean()\nclass3_s_mean_age = df[(df.Pclass == 3) & (df.Embarked == 'S')].Age.mean()","081bc642":"full_rows[\"ClassEmbarkedString\"] = full_rows[\"Pclass\"].astype('str') + full_rows[\"Embarked\"] ","6e82e935":"def class_embarked_tree(x):\n    return { '1C' : class1_c_mean_age, '1Q': class1_q_mean_age, '1S': class1_s_mean_age,\n           '2C' : class2_c_mean_age, '2Q': class2_q_mean_age, '2S': class2_s_mean_age,\n           '3C' : class3_c_mean_age, '3Q': class3_q_mean_age, '3S': class3_s_mean_age}[x]\n\nfull_rows[\"Age09_ClassEmbarkedTree\"] = full_rows.ClassEmbarkedString.apply(lambda x: class_embarked_tree(x))","f2fd436a":"mae_age09_class_embarked_tree = mean_absolute_error(full_rows.Age, full_rows[\"Age09_ClassEmbarkedTree\"])\nround(mae_age09_class_embarked_tree, precision)","bb502722":"full_rows[\"ClassEmbarkedSexString\"] = full_rows[\"Sex\"].astype('str') + full_rows[\"Pclass\"].astype('str') + full_rows[\"Embarked\"]","c17a06ca":"df[\"ClassEmbarkedSexString\"] = df[\"Sex\"].astype('str') + df[\"Pclass\"].astype('str') + df[\"Embarked\"]\ndf[\"ClassEmbarkedSexString\"].unique()","27111ead":"female1c_mean_age = df[df.ClassEmbarkedSexString == 'female1C'].Age.mean()\nfemale1q_mean_age = df[df.ClassEmbarkedSexString == 'female1Q'].Age.mean()\nfemale1s_mean_age = df[df.ClassEmbarkedSexString == 'female1S'].Age.mean()\nfemale2c_mean_age = df[df.ClassEmbarkedSexString == 'female2C'].Age.mean()\nfemale2q_mean_age = df[df.ClassEmbarkedSexString == 'female2Q'].Age.mean()\nfemale2s_mean_age = df[df.ClassEmbarkedSexString == 'female2S'].Age.mean()\nfemale3c_mean_age = df[df.ClassEmbarkedSexString == 'female3C'].Age.mean()\nfemale3q_mean_age = df[df.ClassEmbarkedSexString == 'female3Q'].Age.mean()\nfemale3s_mean_age = df[df.ClassEmbarkedSexString == 'female3S'].Age.mean()\n\nmale1c_mean_age = df[df.ClassEmbarkedSexString == 'male1C'].Age.mean()\nmale1q_mean_age = df[df.ClassEmbarkedSexString == 'male1Q'].Age.mean()\nmale1s_mean_age = df[df.ClassEmbarkedSexString == 'male1S'].Age.mean()\nmale2c_mean_age = df[df.ClassEmbarkedSexString == 'male2C'].Age.mean()\nmale2q_mean_age = df[df.ClassEmbarkedSexString == 'male2Q'].Age.mean()\nmale2s_mean_age = df[df.ClassEmbarkedSexString == 'male2S'].Age.mean()\nmale3c_mean_age = df[df.ClassEmbarkedSexString == 'male3C'].Age.mean()\nmale3q_mean_age = df[df.ClassEmbarkedSexString == 'male3Q'].Age.mean()\nmale3s_mean_age = df[df.ClassEmbarkedSexString == 'male3S'].Age.mean()","6e31fdfa":"def calculate_ClassEmbarkedSexTree(x):\n    return{\n        'female1C': female1c_mean_age, 'female1Q': female1q_mean_age, 'female1S': female1s_mean_age,\n        'female2C': female2c_mean_age, 'female2Q': female2q_mean_age, 'female2S': female2s_mean_age,\n        'female3C': female3c_mean_age, 'female3Q': female3q_mean_age, 'female3S': female3s_mean_age,\n        \n        'male1C': male1c_mean_age, 'male1Q': male1q_mean_age, 'male1S': male1s_mean_age,\n        'male2C': male2c_mean_age, 'male2Q': male2q_mean_age, 'male2S': male1s_mean_age,\n        'male3C': male3c_mean_age, 'male3Q': male3q_mean_age, 'male3S': male1s_mean_age\n    }[x]","9ca4fbe2":"full_rows[\"Age10_ClassEmbarkedSexTree\"] = full_rows.ClassEmbarkedSexString.apply(lambda x: calculate_ClassEmbarkedSexTree(x))","0f0981ec":"mae_age10_class_embarked_sex_tree = mean_absolute_error(full_rows.Age, full_rows[\"Age10_ClassEmbarkedSexTree\"])\nround(mae_age10_class_embarked_sex_tree, precision)","0e3b7c08":"df[\"Relatives\"] = df.SibSp + df.Parch\nfull_rows[\"Relatives\"] = full_rows.SibSp + full_rows.Parch","91bd9bd1":"df[\"HaveRelatives\"] = df.Relatives.apply(lambda x: \"Yes\" if x > 0 else \"No\")\nfull_rows[\"HaveRelatives\"] = full_rows.Relatives.apply(lambda x: \"Yes\" if x > 0 else \"No\")","1f435130":"df.head(11)","ba590c3c":"full_rows[\"ClassEmbarkedSexHaveRelativesString\"] = full_rows[\"Sex\"].astype('str') + full_rows[\"Pclass\"].astype('str') + full_rows[\"Embarked\"] + \"_\" +full_rows[\"HaveRelatives\"]\ndf[\"ClassEmbarkedSexHaveRelativesString\"] = df[\"Sex\"].astype('str') + df[\"Pclass\"].astype('str') + df[\"Embarked\"] + \"_\" + df[\"HaveRelatives\"]","bd39a80a":"full_rows[\"ClassEmbarkedSexHaveRelativesString\"].unique()","48131324":"female1c_yes_mean_age = df[df.ClassEmbarkedSexHaveRelativesString == 'female1C_Yes'].Age.mean()\nfemale1q_yes_mean_age = df[df.ClassEmbarkedSexHaveRelativesString == 'female1Q_Yes'].Age.mean()\nfemale1s_yes_mean_age = df[df.ClassEmbarkedSexHaveRelativesString == 'female1S_Yes'].Age.mean()\nfemale2c_yes_mean_age = df[df.ClassEmbarkedSexHaveRelativesString == 'female2C_Yes'].Age.mean()\nfemale2q_yes_mean_age = df[df.ClassEmbarkedSexHaveRelativesString == 'female2Q_Yes'].Age.mean()\nfemale2s_yes_mean_age = df[df.ClassEmbarkedSexHaveRelativesString == 'female2S_Yes'].Age.mean()\nfemale3c_yes_mean_age = df[df.ClassEmbarkedSexHaveRelativesString == 'female3C_Yes'].Age.mean()\nfemale3q_yes_mean_age = df[df.ClassEmbarkedSexHaveRelativesString == 'female3Q_Yes'].Age.mean()\nfemale3s_yes_mean_age = df[df.ClassEmbarkedSexHaveRelativesString == 'female3S_Yes'].Age.mean()\n\nmale1c_yes_mean_age = df[df.ClassEmbarkedSexHaveRelativesString == 'male1C_Yes'].Age.mean()\nmale1q_yes_mean_age = df[df.ClassEmbarkedSexHaveRelativesString == 'male1Q_Yes'].Age.mean()\nmale1s_yes_mean_age = df[df.ClassEmbarkedSexHaveRelativesString == 'male1S_Yes'].Age.mean()\nmale2c_yes_mean_age = df[df.ClassEmbarkedSexHaveRelativesString == 'male2C_Yes'].Age.mean()\nmale2q_yes_mean_age = df[df.ClassEmbarkedSexHaveRelativesString == 'male2Q_Yes'].Age.mean()\nmale2s_yes_mean_age = df[df.ClassEmbarkedSexHaveRelativesString == 'male2S_Yes'].Age.mean()\nmale3c_yes_mean_age = df[df.ClassEmbarkedSexHaveRelativesString == 'male3C_Yes'].Age.mean()\nmale3q_yes_mean_age = df[df.ClassEmbarkedSexHaveRelativesString == 'male3Q_Yes'].Age.mean()\nmale3s_yes_mean_age = df[df.ClassEmbarkedSexHaveRelativesString == 'male3S_Yes'].Age.mean()\n\nfemale1c_no_mean_age = df[df.ClassEmbarkedSexHaveRelativesString == 'female1C_No'].Age.mean()\nfemale1q_no_mean_age = df[df.ClassEmbarkedSexHaveRelativesString == 'female1Q_No'].Age.mean()\nfemale1s_no_mean_age = df[df.ClassEmbarkedSexHaveRelativesString == 'female1S_No'].Age.mean()\nfemale2c_no_mean_age = df[df.ClassEmbarkedSexHaveRelativesString == 'female2C_No'].Age.mean()\nfemale2q_no_mean_age = df[df.ClassEmbarkedSexHaveRelativesString == 'female2Q_No'].Age.mean()\nfemale2s_no_mean_age = df[df.ClassEmbarkedSexHaveRelativesString == 'female2S_No'].Age.mean()\nfemale3c_no_mean_age = df[df.ClassEmbarkedSexHaveRelativesString == 'female3C_No'].Age.mean()\nfemale3q_no_mean_age = df[df.ClassEmbarkedSexHaveRelativesString == 'female3Q_No'].Age.mean()\nfemale3s_no_mean_age = df[df.ClassEmbarkedSexHaveRelativesString == 'female3S_No'].Age.mean()\n\nmale1c_no_mean_age = df[df.ClassEmbarkedSexHaveRelativesString == 'male1C_No'].Age.mean()\nmale1q_no_mean_age = df[df.ClassEmbarkedSexHaveRelativesString == 'male1Q_No'].Age.mean()\nmale1s_no_mean_age = df[df.ClassEmbarkedSexHaveRelativesString == 'male1S_No'].Age.mean()\nmale2c_no_mean_age = df[df.ClassEmbarkedSexHaveRelativesString == 'male2C_No'].Age.mean()\nmale2q_no_mean_age = df[df.ClassEmbarkedSexHaveRelativesString == 'male2Q_No'].Age.mean()\nmale2s_no_mean_age = df[df.ClassEmbarkedSexHaveRelativesString == 'male2S_No'].Age.mean()\nmale3c_no_mean_age = df[df.ClassEmbarkedSexHaveRelativesString == 'male3C_No'].Age.mean()\nmale3q_no_mean_age = df[df.ClassEmbarkedSexHaveRelativesString == 'male3Q_No'].Age.mean()\nmale3s_no_mean_age = df[df.ClassEmbarkedSexHaveRelativesString == 'male3S_No'].Age.mean()","8dc4e237":"def calculate_ClassEmbarkedSexHaveRelativesTree(x):\n    return{\n        'female1C_Yes': female1c_yes_mean_age, 'female1Q_Yes': female1q_yes_mean_age, 'female1S_Yes': female1s_yes_mean_age,\n        'female2C_Yes': female2c_yes_mean_age, 'female2Q_Yes': female2q_yes_mean_age, 'female2S_Yes': female2s_yes_mean_age,\n        'female3C_Yes': female3c_yes_mean_age, 'female3Q_Yes': female3q_yes_mean_age, 'female3S_Yes': female3s_yes_mean_age,\n        \n        'male1C_Yes': male1c_yes_mean_age, 'male1Q_Yes': male1q_yes_mean_age, 'male1S_Yes': male1s_yes_mean_age,\n        'male2C_Yes': male2c_yes_mean_age, 'male2Q_Yes': male2q_yes_mean_age, 'male2S_Yes': male1s_yes_mean_age,\n        'male3C_Yes': male3c_yes_mean_age, 'male3Q_Yes': male3q_yes_mean_age, 'male3S_Yes': male1s_yes_mean_age,\n        \n        'female1C_No': female1c_no_mean_age, 'female1Q_No': female1q_no_mean_age, 'female1S_No': female1s_no_mean_age,\n        'female2C_No': female2c_no_mean_age, 'female2Q_No': female2q_no_mean_age, 'female2S_No': female2s_no_mean_age,\n        'female3C_No': female3c_no_mean_age, 'female3Q_No': female3q_no_mean_age, 'female3S_No': female3s_no_mean_age,\n        \n        'male1C_No': male1c_no_mean_age, 'male1Q_No': male1q_no_mean_age, 'male1S_No': male1s_no_mean_age,\n        'male2C_No': male2c_no_mean_age, 'male2Q_No': male2q_no_mean_age, 'male2S_No': male1s_no_mean_age,\n        'male3C_No': male3c_no_mean_age, 'male3Q_No': male3q_no_mean_age, 'male3S_No': male1s_no_mean_age\n    }[x]","4f027e92":"full_rows[\"Age11_ClassEmbarkedSexHaveRelativesTree\"] = full_rows.ClassEmbarkedSexHaveRelativesString.apply(lambda x: calculate_ClassEmbarkedSexHaveRelativesTree(x))","f1418e18":"mae_age11_class_embarked_sex_haverelatives_tree = mean_absolute_error(full_rows.Age, full_rows[\"Age11_ClassEmbarkedSexHaveRelativesTree\"])\nround(mae_age11_class_embarked_sex_haverelatives_tree, precision)","a69b939c":"So far \"Age10_ClassEmbarkedSexTree\" give the best result.","8b23797e":"<h1 style=\"text-align:center; background-color: #252525; color: #F3F3F3; border-radius: 0 0 0.3em 0.3em; padding: 0.3em;\"><b>Tabular Playground Series - Apr 2021: Age Imputation<\/b><\/h1>\n"}}