{"cell_type":{"23405970":"code","59d5d1b1":"code","d55a900f":"code","f6cff570":"code","40cc3562":"code","693f0673":"code","9fa2676e":"code","79214d6f":"code","c6c3b2f5":"code","d84f8011":"markdown","749bdca5":"markdown","d521720f":"markdown"},"source":{"23405970":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# read csv\ndf = pd.read_csv(\"..\/input\/application_train.csv\")","59d5d1b1":"# FLAG_DOCUMENT_cluster\ncols = [\"FLAG_DOCUMENT_{}\".format(i) for i in range(2, 22)]\ndf_cluster = df[cols].groupby(cols).size().reset_index()\ndf_cluster.columns = cols + [\"size\"]\ndf_cluster = df_cluster.sort_values(\"size\", ascending=False).head(10)","d55a900f":"# show pattern of FLAG_DOCUMENTS\ndf_cluster[\"size\"]","f6cff570":"# show pattern of FLAG_DOCUMENTS(percentage)\ndf_cluster[\"size\"] \/ len(df)","40cc3562":"# clustering record\ndf_doc_flg = df[[\"SK_ID_CURR\"] + cols]\ndf[\"doc_cluster\"] = [0] * len(df)\nfor i in range(len(df_cluster)):\n    df[\"doc_cluster\"] += np.all(df[cols].values == df_cluster[cols].iloc[i].values, axis=1).astype(int) * (i + 1)","693f0673":"# calculate average target of all cluster\ndf_output = None\ncol = \"doc_cluster\"\nfor target in [0, 1]:\n    w_df = df.query(\"TARGET == {}\".format(target)).groupby([col]).size().reset_index()\n    size_name = \"target_{}_count\".format(target)\n    w_df.columns = [\"cluster\", size_name]\n    if df_output is None:\n        df_output = w_df\n    else:\n        df_output = pd.merge(df_output, w_df, how=\"outer\", on=[\"cluster\"])\ndf_output[\"target_1_ratio\"] = df_output[\"target_1_count\"] \/ df_output[[\"target_0_count\", \"target_1_count\"]].sum(axis=1)","9fa2676e":"df_output","79214d6f":"print(df[\"TARGET\"].mean())","c6c3b2f5":"# see cluster 1\ndf_cluster.iloc[0]","d84f8011":"This is my first post and This competition is my first participation.<br>\nso, please advice or feedback about this kernel :)","749bdca5":"# pattern clustering\nI find some pattern between similar feature.<br>\nI show the \"FLAG_DOCUMENT_X\" example below<br>","d521720f":"It can be said that:\n\n* cluster0 (FLAG_DOCUMENT_3 = 1, other=0) have a little tendency of \"target=1\"\n\nother cluster, "}}