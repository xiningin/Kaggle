{"cell_type":{"5d97e51d":"code","a30e8aad":"code","b55022ad":"code","a191622e":"code","c650a6db":"code","63292620":"code","0f2889d0":"code","cfa2b07a":"code","43377aec":"code","d1d11455":"code","cd464f1b":"code","1c016a63":"code","0699c981":"code","0fb349b1":"code","311e83fa":"code","abf608cb":"code","4af82340":"code","654660bb":"code","984dcffe":"code","b4935fa7":"code","97d9cb80":"code","481e8713":"code","1d4b016f":"code","c68168fc":"code","92c68ca0":"code","52917d51":"code","2694d6e7":"code","154376b2":"code","8c4f8728":"code","f35cb88e":"code","f5029067":"code","005a4010":"code","af95706e":"code","d1d1d655":"code","ab0ee91d":"code","6cdd3396":"code","67e85c3b":"code","cbe3c624":"code","6de9d6f4":"code","0e06c6a1":"code","a6737a53":"code","b5c1cd5d":"code","ebbb0e74":"code","e6cf6748":"code","821adec7":"code","aaffad81":"code","3a0b358c":"code","a64f45ff":"code","395cf22f":"code","d5c25fae":"code","a702815e":"code","00033292":"code","a7429157":"code","028de744":"code","bef2ca44":"code","962688c9":"code","b3150945":"code","f9f96c56":"code","258ae5ea":"code","095fbf56":"code","7993d044":"code","800ba747":"code","0e13ea3a":"code","afc25e18":"code","978b10af":"code","b0840cb1":"code","e9954493":"code","29cceac4":"code","3738e3a2":"code","71dcb681":"code","24347c16":"code","a5e6e009":"markdown","39ca13d0":"markdown","26311198":"markdown","f3d17219":"markdown","1bda4201":"markdown","0fcbd954":"markdown","99d2fa04":"markdown","7b788144":"markdown","14067ae0":"markdown","9a408bd9":"markdown","44188539":"markdown","dce04a72":"markdown","9a0ec20f":"markdown","ed06fd48":"markdown","1ca53fa5":"markdown","8cccf2ac":"markdown","2bc876be":"markdown","57026dac":"markdown","2b0a25f5":"markdown","233918f6":"markdown","efde8cd9":"markdown","e103da10":"markdown","81d845cb":"markdown","6253bb0e":"markdown","3f690b32":"markdown","f7eb29de":"markdown","c21ab187":"markdown"},"source":{"5d97e51d":"###### This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\nfrom plotly.offline import download_plotlyjs, init_notebook_mode, plot, iplot\nimport plotly.plotly as py\nimport plotly.graph_objs as go\nfrom plotly.tools import FigureFactory as FF\nimport cufflinks as cf\nimport scipy\n\n\nimport statsmodels\nimport statsmodels.api as sm\nfrom statsmodels.formula.api import ols\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\nimport glob\n\n# Any results you write to the current directory are saved as output.","a30e8aad":"import plotly\nplotly.__version__","b55022ad":"print(os.listdir(\"..\/input\/estimate-of-median-household-income-group-series\"))","a191622e":"hhi_files = glob.glob(\"..\/input\/estimate-of-median-household-income-group-series\/*.csv\")\nhhi_data = {os.path.basename(fname)[40:-4]:pd.read_csv(fname) for fname in hhi_files}\nhhi_data.keys()","c650a6db":"hhi_data['fairfax-county-va'].tail()","63292620":"counties = list(hhi_data.keys())\nhhi_2016 = pd.DataFrame(dict(\n    county=counties,\n    state=[c[-2:] for c in counties],\n    value=[float(hhi_data[c].value.iloc[-1]) for c in counties]\n)).sort_values(\"state\")\nhhi_2016","0f2889d0":"hhi_2016.state.unique()","cfa2b07a":"region_look_up = {\n    'ca': 'California',\n    'co': 'Western',\n    'fl': \"Southern\",\n    'ga': \"Southern\",\n    'il': \"Midwestern\",\n    'md': \"Northeastern\",\n    'mo': \"Midwestern\", \n    'nj': 'Northeastern',\n    'ny': \"Northeastern\",\n    'pa': \"Northeastern\",\n    'tx': \"Southern\",\n    'va': \"Southern\",\n    'wa': \"Western\",\n    'wi': \"Midwestern\"}\nhhi_2016 = hhi_2016.assign(Region=[region_look_up[s] for s in hhi_2016.state])\nhhi_2016\n","43377aec":"regional_median_income = hhi_2016.groupby(\"Region\").mean()\nregional_median_income\n","d1d11455":"raw_region = pd.read_csv(\"..\/input\/college-salaries\/salaries-by-region.csv\")\nraw_college_type = pd.read_csv(\"..\/input\/college-salaries\/salaries-by-college-type.csv\")\nraw_degrees = pd.read_csv(\"..\/input\/college-salaries\/degrees-that-pay-back.csv\")\n\nprint(\"Region:\", raw_region.shape, raw_region.columns)\nprint(\"college_type:\", raw_college_type.shape, raw_college_type.columns)\nprint(\"degrees:\", raw_degrees.shape, raw_degrees.columns)\nraw_degrees.head(3)","cd464f1b":"init_notebook_mode(connected=True)\ncf.go_offline() #cufflinks links dataframes to plotly","1c016a63":"iplot([{\"x\": [1, 2, 3], \"y\": [3, 1, 6]}])","0699c981":"iplot([go.Scatter(x=[1, 2, 3], y=[3, 1, 6])])","0fb349b1":"x = np.random.randn(2000)\ny = np.random.randn(2000)\niplot([go.Histogram2dContour(x=x, y=y, contours=dict(coloring='heatmap')),\n       go.Scatter(x=x, y=y, mode='markers', marker=dict(color='white', size=3, opacity=0.3))], show_link=False)","311e83fa":"dir(go)","abf608cb":"raw_degrees.head()","4af82340":"cols = [c for c in raw_degrees.columns if \"Salary\" in c and not \"change\" in c]\ncols","654660bb":"degrees = raw_degrees\ndegrees[cols] = degrees[cols].replace({'\\$': '',\",\": ''}, regex=True).astype(float) # stripped the characters and \n#converted to numerical value \"float\"\ndegrees.head()","984dcffe":"raw_region.head()","b4935fa7":"cols = [c for c in raw_region.columns if \"Salary\" in c ]\ncols","97d9cb80":"region = raw_region\nregion[cols] = region[cols].replace({'\\$': '',\",\": ''}, regex=True).astype(float) # stripped the characters and \n#converted to numerical value \"float\"\nregion.head()","481e8713":"raw_college_type.head()","1d4b016f":"cols = [c for c in raw_college_type.columns if \"Salary\" in c ]\ncols","c68168fc":"college_type = raw_college_type\ncollege_type[cols] = college_type[cols].replace({'\\$': '',\",\": ''}, regex=True).astype(float) # stripped the characters and \n#converted to numerical value \"float\"\ncollege_type.head()","92c68ca0":"data = college_type['Starting Median Salary']\niplot([go.Histogram(x=data)])","52917d51":"college_type[\"School Type\"].value_counts()","2694d6e7":"college_type[college_type[\"School Type\"]==\"Ivy League\"]","154376b2":"college_type[college_type[\"Starting Median Salary\"]> 65e+3]","8c4f8728":"college_type.groupby(\"School Type\").median().iplot(kind=\"bar\")","f35cb88e":"region.groupby(\"Region\").median().iplot(kind=\"bar\")","f5029067":"columns = [\"Undergraduate Major\", \"Starting Median Salary\", \"Mid-Career Median Salary\"]\ndegrees[columns].sort_values(\"Mid-Career Median Salary\").set_index(\"Undergraduate Major\").iplot(\n    kind='barh', subplots=False, bargap=.1, bargroupgap=.5,\n    dimensions=(800, 1200), margin=dict(l=250, r=20)\n)","005a4010":"college_type.columns","af95706e":"college_type_data = pd.DataFrame(dict(\n        school_name=college_type['School Name'],\n        school_type=college_type['School Type'],\n        starting_salary=college_type['Starting Median Salary']))\n\nprint(college_type_data.shape)\ncollege_type_data.replace([np.inf, -np.inf], np.nan).dropna().shape\ncollege_type_data.head()\n","d1d1d655":"college_type_lm = ols('starting_salary ~ school_name+school_type', data=college_type_data).fit() #linear model\ntable = sm.stats.anova_lm(college_type_lm, typ=2) # Type 2 ANOVA DataFrame\n\nprint(table)","ab0ee91d":"region.columns","6cdd3396":"#[regional_median_income.loc(r) for r in region.Region]\nregional_median_income.loc['California'] ","67e85c3b":"college_region_data = pd.DataFrame(dict(\n        school_name=region['School Name'],\n        school_region=region['Region'],\n        starting_salary=region['Starting Median Salary'],\n        median_hh_income=[float(regional_median_income.loc[r]) for r in region.Region]))\n\nprint(college_region_data.shape)\nprint(college_region_data.replace([np.inf, -np.inf], np.nan).dropna().shape)\ncollege_region_data.head()","cbe3c624":"college_region_lm = ols('starting_salary ~ median_hh_income', data=college_region_data).fit() #linear model\ntable = sm.stats.anova_lm(college_region_lm, typ=2) # Type 2 ANOVA DataFrame\n\nprint(table)","6de9d6f4":"college_region_lm = ols('starting_salary ~ median_hh_income', data=college_region_data).fit() #linear model\ncollege_region_school = ols('starting_salary ~ median_hh_income+school_name', data=college_region_data).fit()\ncollege_region_school.compare_f_test(college_region_lm)\n# (F-Statistic, p-value, increase in degrees of freedom)","0e06c6a1":"college_region_plusfit = college_region_data.assign(resid=college_region_lm.resid)\ncollege_region_plusfit.head()","a6737a53":"college_region_plusfit_lm = ols('starting_salary ~ resid+school_region', data=college_region_plusfit).fit() #linear model\ntable = sm.stats.anova_lm(college_region_plusfit_lm, typ=2) # Type 2 ANOVA DataFrame\n\nprint(table)\n#college_region_plusfit_lm.summary()","b5c1cd5d":"college_region_plusfit_lm.summary()","ebbb0e74":"college_region_anova_lm = ols('starting_salary ~ school_region', data=college_region_plusfit).fit() #linear model\n#Is salary different across the regions?\ntable = sm.stats.anova_lm(college_region_anova_lm, typ=2) # Type 2 ANOVA DataFrame\n\nprint(table)\ncollege_region_anova_lm.summary()","e6cf6748":"hh_income_anova_lm = ols('median_hh_income ~ school_region', data=college_region_plusfit).fit() #linear model\n#Is standard of living different across the regions?\ntable = sm.stats.anova_lm(hh_income_anova_lm, typ=2) # Type 2 ANOVA DataFrame\n\nprint(table)\nhh_income_anova_lm.summary()","821adec7":"college_region_plusfit.head()","aaffad81":"college_region_plusfit[['school_region','starting_salary','median_hh_income']].groupby(\"school_region\").median().iplot(kind=\"bar\")","3a0b358c":"college_salary_data = pd.DataFrame(dict(\n        school_name=region['School Name'],\n        school_region=region['Region'],\n        starting_salary=region['Starting Median Salary'],\n        mid_career_salary=region['Mid-Career Median Salary'],\n        median_hh_income=[float(regional_median_income.loc[r]) for r in region.Region]))\ncollege_salary_data.groupby(\"school_region\").median().iplot(kind=\"bar\")","a64f45ff":"binned_college_data = college_salary_data.groupby(\"school_region\").median() #bin data by school region\nscipy.stats.ks_2samp(binned_college_data.starting_salary,binned_college_data.median_hh_income) #KS test\n","395cf22f":"print(normalized_college_salary_data.starting_salary-normalized_college_salary_data.median_hh_income)","d5c25fae":"normalized_college_salary_data = pd.DataFrame(dict(\n    starting_salary=binned_college_data.starting_salary\/binned_college_data.starting_salary.median(),\n    median_hh_income= binned_college_data.median_hh_income\/binned_college_data.median_hh_income.median(),\n    mid_career_salary=binned_college_data.mid_career_salary\/binned_college_data.mid_career_salary.median(),\n)\n\n)\nprint(\"Starting Salary Compared Against Median HH Income\")\n\nprint(scipy.stats.ks_2samp(\n   normalized_college_salary_data.starting_salary,\n   normalized_college_salary_data.median_hh_income\n)) #KS test\n\n\n\nprint(\"Starting Salary Compared Against Mid-Career Salary\")\n\nprint(scipy.stats.ks_2samp(\n   normalized_college_salary_data.starting_salary,\n   normalized_college_salary_data.mid_career_salary\n)) #KS test\n\nprint(\"Mid-Career Salary Compared Against Median HH Income\")\nprint(scipy.stats.ks_2samp(\n   normalized_college_salary_data.mid_career_salary,\n   normalized_college_salary_data.median_hh_income\n)) #KS test\n\n#normalized_college_salary_data.groupby(\"school_region\").median().iplot(kind=\"bar\")\nnormalized_college_salary_data.iplot(kind=\"bar\")","a702815e":"binned_college_data.head()","00033292":"normalized_college_salary_data = pd.DataFrame(dict(\n        school_name=region['School Name'],\n        school_region=region['Region'],\n        starting_salary=region['Starting Median Salary'],\n        mid_career_salary=region['Mid-Career Median Salary'],\n        median_hh_income=[float(regional_median_income.loc[r]) for r in region.Region]))\n\nnormalized_college_salary_data = normalized_college_salary_data.assign(\n    starting_salary=normalized_college_salary_data.starting_salary\/normalized_college_salary_data.starting_salary.median(),\n    mid_career_salary=normalized_college_salary_data.mid_career_salary\/normalized_college_salary_data.mid_career_salary.median(),\n    median_hh_income=normalized_college_salary_data.median_hh_income\/normalized_college_salary_data.median_hh_income.median()\n)\n\nprint(\"Starting Salary Compared Against Median HH Income\")\n\nprint(scipy.stats.ks_2samp(\n   normalized_college_salary_data.starting_salary,\n   normalized_college_salary_data.median_hh_income\n)) #KS test\n\n\n\nprint(\"Starting Salary Compared Against Mid-Career Salary\")\n\nprint(scipy.stats.ks_2samp(\n   normalized_college_salary_data.starting_salary,\n   normalized_college_salary_data.mid_career_salary\n)) #KS test\n\nprint(\"Mid-Career Salary Compared Against Median HH Income\")\nprint(scipy.stats.ks_2samp(\n   normalized_college_salary_data.mid_career_salary,\n   normalized_college_salary_data.median_hh_income\n)) #KS test\nnormalized_college_salary_data.groupby(\"school_region\").median().iplot(kind=\"bar\")","a7429157":"[g for region,g in college_salary_data.groupby(\"school_region\").mid_career_salary]","028de744":"data = [\n    go.Histogram(\n        x=g,\n        name=region,\n        opacity=0.75,\n        histnorm='percent',\n    )\n    for region,g in college_salary_data.groupby(\"school_region\").mid_career_salary\n    \n]\n\nlayout = go.Layout(barmode='overlay')\nfig = go.Figure(data=data, layout=layout)\n\niplot(fig)# filename='overlaid histogram')\n#iplot([go.Histogram(x=data)])","bef2ca44":"data = [\n    go.Histogram(\n        x=g,\n        name=region,\n        opacity=0.75,\n        histnorm='percent',\n    )\n    for region,g in college_salary_data.groupby(\"school_region\").starting_salary\n    \n]\n\nlayout = go.Layout(barmode='overlay')\nfig = go.Figure(data=data, layout=layout)\n\niplot(fig)# filename='overlaid histogram')\n#iplot([go.Histogram(x=data)])","962688c9":"\ndata = [\n    go.Histogram(\n        x=g,\n        name=school_type,\n        opacity=0.75,\n        histnorm='percent',\n    )\n    for school_type,g in college_type.groupby(\"School Type\")['Starting Median Salary']\n    \n]\n\nlayout = go.Layout(barmode='overlay')\nfig = go.Figure(data=data, layout=layout)\n\niplot(fig)\n","b3150945":"data = [\n    go.Histogram(\n        x=g,\n        name=school_type,\n        opacity=0.75,\n        histnorm='percent',\n    )\n    for school_type,g in college_type.groupby(\"School Type\")['Mid-Career Median Salary']\n    \n]\n\nlayout = go.Layout(barmode='overlay')\nfig = go.Figure(data=data, layout=layout)\n\niplot(fig)","f9f96c56":"import sklearn.metrics as metrics\nfrom sklearn.ensemble import RandomForestClassifier","258ae5ea":"model = RandomForestClassifier(n_estimators=100, criterion='gini', max_depth=25, random_state=0)","095fbf56":"degrees.head()","7993d044":"region.head()","800ba747":"college_type.head()","0e13ea3a":"college_salary_data.head()","afc25e18":"merged_data_set = college_salary_data.merge(college_type[['School Name','School Type']],left_on='school_name',right_on='School Name')\nmerged_data_set.head()","978b10af":"x = merged_data_set[['school_region','School Type','median_hh_income']]","b0840cb1":"#y = 0+(merged_data_set.starting_salary > merged_data_set.median_hh_income.median())\n# Starting Salary $50000\n#y = 0+(merged_data_set.starting_salary > 50000)\n\n\n# Starting Salary $60000\n# y = 0+(merged_data_set.starting_salary > 60000)\n\n\n#Starting Salary $70000\n# y = 0+(merged_data_set.starting_salary > 70000)\n\n#Starting Salary $75000\n#y = 0+(merged_data_set.starting_salary > 75000)\n\n#Starting Salary $80000\n# y = 0+(merged_data_set.starting_salary > 80000)","e9954493":"# Mid-Career Salary $80000\n#y = 0+(merged_data_set.mid_career_salary > 80000)\n\n\n# Mid-Career Salary $90000\n# y = 0+(merged_data_set.mid_career_salary > 90000)\n\n\n# Mid-Career Salary $100000\n# y = 0+(merged_data_set.mid_career_salary > 100000)\n\n# Mid-Career Salary $110000\n# y = 0+(merged_data_set.mid_career_salary > 110000)\n\n#Mid-Career Salary $120000\n# y = 0+(merged_data_set.mid_career_salary > 120000)\n\n#Mid-Career Salary $130000\ny = 0+(merged_data_set.mid_career_salary > 130000)","29cceac4":"x_dummies = pd.get_dummies(x)\nx_dummies.head()","3738e3a2":"model.fit(x_dummies,y)","71dcb681":"import numpy as np\nimport matplotlib.pyplot as plt","24347c16":"importances = model.feature_importances_\n\nstd = np.std([tree.feature_importances_ for tree in model.estimators_],\n             axis=0)\nindices = np.argsort(importances)#[::-1]\nprint(\"Feature ranking:\")\n\nfor f in range(x_dummies.shape[1]):\n    # print(\"%d. feature %d (%f)\" % (f + 1, indices[f], importances[indices[f]]))\n    print(\"%d. %s (%f)\" % (f + 1, x_dummies.columns[indices[f]], importances[indices[f]]))\nplt.figure(figsize=(10,20))\nplt.title(\"Feature importances\")\nplt.barh(range(x_dummies.shape[1]), importances[indices],\n       color=\"r\", yerr=std[indices], align=\"center\")\nx_labels = [x_dummies.columns[indices[f]] for f in range(x_dummies.shape[1])]\nplt.yticks(range(x_dummies.shape[1]), x_labels)\nplt.ylim([-1, x_dummies.shape[1]])\nplt.show()","a5e6e009":"# Visualization of normalized data sets","39ca13d0":"# TODO Initial observation:\nnot a big difference across starting salaries\nsomething different across the Midwestern region\nneed a statistic to back up visuals\nKolmogorov\u2013Smirnov? compare values across binned values, variance not possible due to averages\nhttps:\/\/docs.scipy.org\/doc\/scipy-0.14.0\/reference\/generated\/scipy.stats.ks_2samp.html\n\n\n**If the K-S statistic is small or the p-value is high, then we cannot reject the hypothesis that the distributions of the two samples are the same**\n\nCan reject starting hypothesis that starting salaries are the same\nThus starting salaries are significantly different from the median household income across regions","26311198":"# Data Cleansing\nStrip the \"$\", \",\", \".\"\n","f3d17219":"# Interpretation:\nIs salary different across the regions?\n\nPR > F is very small, less than .05 so it is very likely that there is a statistically significant difference among starting salaries across regions.","1bda4201":"# Mean values for each region calculated\n","0fcbd954":"# Added additional dataset to compare regional cost of living if you stay living in region versus the college\nIgnore json objects use csv","99d2fa04":"## Building Random Forest Model\n\n","7b788144":"## Tried different Mid-career salaries to determine most important features","14067ae0":"# Normalize the data\nThe KS test had a small P Value but it should be because household income is typically two or more people.\nMake another data set that has overall median, maxes or mins and divide by the value.\nMedian chosen because we are using median values across the data sets\n# Observation\nCannot reject hypothesis since \n**If the K-S statistic is small or the p-value is high, then we cannot reject the hypothesis that the distributions of the two samples are the same**","9a408bd9":"# Visualization:\nVisualize the region and hh income data set","44188539":"# Use regression to see the relationship between the variables\nFirst college and college_type data bases\nhttps:\/\/plot.ly\/python\/anova\/\n\"In this ANOVA test, we are dealing with an F-Statistic and not a p-value. Their connection is integral as they are two ways of expressing the same thing. When we set a significance level at the start of our statistical tests (usually 0.05), we are saying that if our variable in question takes on the 5% ends of our distribution, then we can start to make the case that there is evidence against the null, which states that the data belongs to this particular distribution.\n\nThe F value is the point such that the area of the curve past that point to the tail is just the p-value. Therefore:\n\nPr(>F)=p\nFor more information on the choice of 0.05 for a significance level, check out this page.\"","dce04a72":"# Overlaid Histogram: Salary by School Type\nStarting Median Salary","9a0ec20f":"# Observations:\nMidwestern has more variation, statistically significant difference. Is it due to more blue collar workers in the Midwest or because Midwest people are leaving and going to the coasts to earn higher salaries?\nAs you age do you earn more money? KS a good choice? Do we need to renormalize? Because visually the normalized starting salary and mid career salaries not that different?\nSince we normalized them we're not seeing a huge difference beween starting salary and mid-career salaries, comparing the differentials? ","ed06fd48":"# Math majors have great income growth potential vs nurses and Physician Assistant","1ca53fa5":"# Overlaid Histogram: Salary by School Type\nMid-Career Median Salary","8cccf2ac":"# Overlaid Histogram: Starting Salaries by Region","2bc876be":"## Tried different Starting Salaries to determine most important features\n","57026dac":"# Overlaid Histogram: Mid Career Salaries by Region","2b0a25f5":"## ToDo\ntry different salary range and also mid-career salary models and charts","233918f6":"# Need to compare college_region_school against college_region","efde8cd9":"# Column Values\nValue = estimate median household salary (doesn't matter because all counties are household anyway), ","e103da10":"# Compare salary group by region vs salary overall\nStandard of living different across the regions?\n\nIs salary different across the regions?","81d845cb":"# Successfully mapped census household income data to regions of college data\naverage household income by region","6253bb0e":"# PR(>F) is very small\nF Test shows that both school type and actual school are likely to be significant in the starting salary","3f690b32":"# Interpretation:\nonly one data point per region from hh income data set F test, 0 variance because we only had one data point per region (averaged to one number per region in order to merge it with the school data set). ANOVA test isn't best fit for this binned data set.","f7eb29de":"# Map the states to regions\nso we can get the baseline median household income to compare starting salary","c21ab187":"# Plot residuals need more visualization"}}