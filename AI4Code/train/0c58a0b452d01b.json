{"cell_type":{"c54dc4b8":"code","925d16c4":"code","1dcef055":"code","77ce5f0b":"code","e96cc396":"code","9740eaf3":"code","b727b54c":"code","6915fbe6":"code","ea44c9ad":"code","528d3f55":"code","2e7fd60e":"code","a18f53d6":"code","f188c722":"markdown","5ff3c771":"markdown","ba4892a6":"markdown","5151db43":"markdown","85b65286":"markdown","1bb1f890":"markdown","1b32085a":"markdown","fd21cbac":"markdown","f0b38df7":"markdown"},"source":{"c54dc4b8":"from IPython.display import clear_output\n!pip3 install pycaret --user\nclear_output()\n\nimport numpy as np\nimport pandas as pd \n\nimport random\nimport os \n\nfrom pycaret.regression import *","925d16c4":"TRAIN_PATH = \"..\/input\/tabular-playground-series-jan-2022\/train.csv\"\nTEST_PATH = \"..\/input\/tabular-playground-series-jan-2022\/test.csv\"\nSAMPLE_SUBMISSION_PATH = \"..\/input\/tabular-playground-series-jan-2022\/sample_submission.csv\"\nSUBMISSION_PATH = \"submission.csv\"\n\nID = \"row_id\"\nTARGET = \"num_sold\"\n\nFOLD = 2\nBLEND_MODELS = [\"rf\",\"catboost\",\"lightgbm\"]\nBLEND_METHOD = 'soft'\nBLEND_FOLD = 2\nCRITERIA = \"mape\"\n\nTUNE_FOLD = 2\n\nSEED = 2022\n\ndef seed_everything(seed: int = SEED):\n    random.seed(seed)\n    np.random.seed(seed)\n    os.environ[\"PYTHONHASHSEED\"] = str(seed)\n    \nseed_everything()\n\nPYCARET_TARGET_NAME = \"Label\"","1dcef055":"train = pd.read_csv(TRAIN_PATH)\ntest = pd.read_csv(TEST_PATH)","77ce5f0b":"setup(\n    data=train,\n    target=TARGET,\n    silent=True,\n    ignore_features=[ID]\n)","e96cc396":"train_models = []\nfor model in BLEND_MODELS:\n    trainedModel = create_model(model,fold = FOLD)\n    train_models.append(trainedModel)\n    \n\nblendModel = blend_models(estimator_list = train_models,optimize=CRITERIA,fold = BLEND_FOLD)","9740eaf3":"predict_model(blendModel)","b727b54c":"tuneModel = tune_model(blendModel,fold=TUNE_FOLD)","6915fbe6":"predict_model(tuneModel)","ea44c9ad":"final_model = finalize_model(tuneModel)","528d3f55":"predict_model(final_model)","2e7fd60e":"pred_test = predict_model(final_model, data=test)\npred_test[:5]","a18f53d6":"sub = pd.read_csv(SAMPLE_SUBMISSION_PATH)\nsub[TARGET] = pred_test[PYCARET_TARGET_NAME]\nsub.to_csv(SUBMISSION_PATH,index=False)\nsub.head()","f188c722":"# tune model","5ff3c771":"# global variables","ba4892a6":"# best model","5151db43":"# installs and imports","85b65286":"# make submission csv ","1bb1f890":"# Blend Models","1b32085a":"# init pyCaret","fd21cbac":"# predict test data target ","f0b38df7":"# load "}}