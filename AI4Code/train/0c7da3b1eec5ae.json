{"cell_type":{"cd9be88b":"code","259b6ca4":"code","af6e528c":"code","be2865c4":"code","19f00e81":"code","64b49f24":"code","dc865f25":"code","575f907c":"code","9abccc7f":"code","458489fe":"code","78ab0d80":"code","fda2f70b":"code","b7437437":"code","54e1bb5d":"code","03d1c00e":"code","07cfc300":"code","f3ed46ad":"code","49797c8e":"code","3989c17a":"code","3714d0b3":"code","4ac046db":"code","b14cb061":"code","6a910a08":"code","f0063e62":"markdown","d072479f":"markdown","e9b447f7":"markdown","e13143bd":"markdown","12e62d27":"markdown","1b75e44c":"markdown","8d221ca8":"markdown","d9cff801":"markdown"},"source":{"cd9be88b":"# We import required lib's\nfrom fastai.vision import *\nimport os","259b6ca4":"# nothing in our folder yet\nprint(os.listdir(\"..\/working\"))","af6e528c":"# move images to working folder\n!mkdir ..\/working\/dog\n!mkdir ..\/working\/wolf\n!cp ..\/input\/dog-v1\/* ..\/working\/dog\n!cp ..\/input\/wolf-v1\/* ..\/working\/wolf","be2865c4":"# let's check\nprint(os.listdir(\"..\/working\"))","19f00e81":"verify_images('..\/working\/wolf', delete=True, max_size=500)\nverify_images('..\/working\/dog', delete=True, max_size=500)","64b49f24":"classes = ['wolf','dog']\nnp.random.seed(42)\ndata = ImageDataBunch.from_folder('..\/working', train=\".\", valid_pct=0.2,\n        ds_tfms=get_transforms(), size=224, num_workers=4).normalize(imagenet_stats)","dc865f25":"data.classes","575f907c":"data.show_batch(rows=3, figsize=(15,11))","9abccc7f":"data.classes, data.c, len(data.train_ds), len(data.valid_ds)","458489fe":"learn = create_cnn(data, models.resnet34, metrics=error_rate)","78ab0d80":"learn.fit_one_cycle(4)","fda2f70b":"learn.save('stage-1')","b7437437":"learn.unfreeze()","54e1bb5d":"learn.lr_find()","03d1c00e":"learn.recorder.plot()","07cfc300":"learn.fit_one_cycle(2, max_lr=slice(3e-5,3e-4))","f3ed46ad":"learn.save('stage-2')","49797c8e":"learn.load('stage-2');","3989c17a":"interp = ClassificationInterpretation.from_learner(learn)","3714d0b3":"interp.plot_confusion_matrix()","4ac046db":"interp = ClassificationInterpretation.from_learner(learn)\nlosses,idxs = interp.top_losses()\nlen(data.valid_ds)==len(losses)==len(idxs)","b14cb061":"interp.plot_top_losses(9, figsize=(15,11))","6a910a08":"data.show_batch(rows=3, figsize=(15,11))","f0063e62":"## Train model","d072479f":"## Interpretation","e9b447f7":"# Look at the images...\n# Is there something wrong ?","e13143bd":"Good! Let's take a look at some of our pictures then.","12e62d27":"Then we can remove any images that can't be opened:","1b75e44c":"# More info are published in \u00a76.4 of this publication: https:\/\/www.kdd.org\/kdd2016\/papers\/files\/rfp0573-ribeiroA.pdf\n","8d221ca8":"# Easy Classification Model using FastAI\n\n## Let's try to identify wolf or husky images in an easy way. ","d9cff801":"## View data"}}