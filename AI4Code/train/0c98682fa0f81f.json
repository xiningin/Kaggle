{"cell_type":{"6909baab":"code","96ab9fe8":"code","51638837":"code","c2831ab4":"code","d7a9917b":"code","a7f5e34e":"code","ba50779f":"code","1db3acf0":"code","fb4a8991":"code","b32a04f1":"code","32cee2e9":"markdown","c8a05f25":"markdown","b50fc9ef":"markdown","55055974":"markdown","0f5d7704":"markdown","b9b8a65d":"markdown"},"source":{"6909baab":"!pip install backtrader backtrader_plotting","96ab9fe8":"import os\nimport datetime\nimport backtrader as bt","51638837":"%matplotlib inline","c2831ab4":"from shutil import copyfile\n\ncopyfile(src = \"..\/input\/strategies\/OptGoldenCross.py\", dst = \"..\/working\/OptGoldenCross.py\")","d7a9917b":"from OptGoldenCross import OptGoldenCross","a7f5e34e":"# \u6aa2\u8996\u8f38\u51fa\u3001\u958b\u555f\u591a\u6838\u904b\u7b97\ncerebro = bt.Cerebro(optreturn=False, maxcpus=None)\ncerebro.broker.setcash(1e5)\ncerebro.addsizer(bt.sizers.FixedSize, stake=10)\ncerebro.broker.setcommission(commission=0.000945)","ba50779f":"csv_file = os.path.abspath('..\/input\/quantitative-trading\/SPY.csv')\nfeed = bt.feeds.YahooFinanceCSVData(\n    dataname=csv_file,\n    fromdate=datetime.datetime(2000, 1, 1),\n    todate=datetime.datetime(2019, 12, 31),\n    reverse=False\n)\ncerebro.adddata(feed)","1db3acf0":"strats = cerebro.optstrategy(\n    OptGoldenCross,\n    slow=range(50, 201, 5),\n    fast=range(5, 51, 5)\n)","fb4a8991":"opt_runs = cerebro.run()","b32a04f1":"final_results_list = []\nfor run in opt_runs:\n    for strategy in run:\n        profit = strategy.profit\n        final_results_list.append({\n            'Slow': strategy.p.slow,\n            'Fast': strategy.p.fast,\n            'Profit': profit\n        })\n\nfinal_results_list = sorted(final_results_list, key=lambda x: x['Profit'], reverse=True)\n\nfor index, result in enumerate(final_results_list[:5]):\n    print(f\"# No. {index + 1} > \u6295\u8cc7\u53c3\u6578 Slow {result.get('Slow')} Fast {result.get('Fast')} \u7372\u5229 {round(result.get('Profit'), 2)} \ud83d\udcb2\")","32cee2e9":"### \u5f15\u5165\u7b56\u7565","c8a05f25":"## \u627e\u51fa\u6700\u4f73\u53c3\u6578\u7d44\u5408","b50fc9ef":"\u80fd\u4e0d\u80fd\u8b93\u6846\u67b6\u5e6b\u6211\u5011\u627e\u51fa\u6700\u5408\u9069\u7684\u7b56\u7565\u53c3\u6578\u7d44\u5408\u5462\uff1f\u8b93\u6211\u5011\u4f86\u91cd\u8cfc\u7b56\u7565\uff0c\u8b93 Python \u5e6b\u6211\u5011\u627e\u51fa\u6700\u5408\u9069\u7684\u53c3\u6578\u7d44\u5408","55055974":"### \u5efa\u7acb\u6846\u67b6\u904b\u884c\u74b0\u5883","0f5d7704":"### \u8a2d\u5b9a\u521d\u59cb\u74b0\u5883","b9b8a65d":"### \u8a2d\u5b9a\u7b56\u7565\u512a\u5316\u5668"}}