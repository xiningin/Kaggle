{"cell_type":{"8deab918":"code","8ce4a01d":"code","3be21956":"code","bc247312":"code","32171c88":"code","3d71edfd":"code","79d660ca":"code","d353aa82":"code","de267f4c":"code","2dee18cf":"code","67ef7911":"code","9fa12a56":"markdown","35203fb0":"markdown","0bf8c395":"markdown","c51b551b":"markdown","f65cefd8":"markdown"},"source":{"8deab918":"import numpy as np\nimport pandas as pd","8ce4a01d":"data = pd.read_csv('..\/input\/logistics-shopee-code-league\/delivery_orders_march.csv')","3be21956":"# look at data\ndata.head()","bc247312":"data.info()","32171c88":"# get the state of the address by getting the last str in the address\ndata['buyeraddress'] = data['buyeraddress'].apply(lambda x: x.split()[-1]).str.lower()\ndata['selleraddress'] = data['selleraddress'].apply(lambda x: x.split()[-1]).str.lower()\ndata.head()","3d71edfd":"# calculate the business days to deliver before late \ntemp = []\nfor i,j in data[['buyeraddress','selleraddress']].itertuples(index=False):\n  if (i == 'manila' and j == 'manila'):\n    temp.append(3)\n  elif (\n      (i == 'manila' and j == 'luzon')\n      or (i == 'luzon' and j == 'manila')\n      or (i == 'luzon' and j == 'luzon')\n      ):\n    temp.append(5)\n  else:\n    temp.append(7)\n\ndata['days'] = temp\ndata.head()","79d660ca":"# change unix time to date\n# need to convert to gmt+8\ndata[['pick','1st_deliver_attempt','2nd_deliver_attempt']] += 8*60*60\ndata['pick'] = pd.to_datetime(data['pick'],unit='s').dt.date\ndata['1st_deliver_attempt'] = pd.to_datetime(data['1st_deliver_attempt'],unit='s').dt.date\ndata['2nd_deliver_attempt'] = data['2nd_deliver_attempt'].replace(np.nan,0) # change nan to 0 or else can't be process\ndata['2nd_deliver_attempt'] = pd.to_datetime(data['2nd_deliver_attempt'],unit='s').dt.date\ndata.head()","d353aa82":"# count how many days of business day taken for the 1pick and 2pick\nholiday = ['2020-03-08','2020-03-25','2020-03-30','2020-03-31']\ndata['1st_pick'] = np.busday_count(data['pick'], data['1st_deliver_attempt'], weekmask='1111110', holidays=holiday)\ndata['2nd_pick'] = np.busday_count(data['1st_deliver_attempt'], data['2nd_deliver_attempt']\t, weekmask='1111110', holidays=holiday)\ndata.head()","de267f4c":"# check if is late\ndata['is_late'] = (data['1st_pick'] > data['days']) | (data['2nd_pick'] > 3)\ndata.head()","2dee18cf":"# prepare submission df and change is_late column to int using .apply(int)\nsubmission = pd.DataFrame({'orderid':data['orderid'], 'is_late':data['is_late'].apply(int)})\nsubmission","67ef7911":"submission.to_csv('submission.csv', header=True, index=False)","9fa12a56":"# Tips to get 1.0\nThere are some tips to get 1.0 from this disscussion. Another big thanks!(https:\/\/www.kaggle.com\/c\/open-shopee-code-league-logistic\/discussion\/165972):\n> 1. You can easily count the weekday difference with the help of numpy.busday_count function! Check the \"weekmask\" and \"holidays\" in numpy document.\n> 2. We use pd.to_datetime to process the epoch time from \"deliveryordersmarch.csv\". However, don't forget we need to convert the time to GMT+8.\n> 3. I learned from the discussion forum [1] that if the weekday of \"pick\" is Sunday, we need to shift it to next day.\n> 4. You can use datetime.timedelta() to add a day or a hour to a datetime object.\n> \n> [1]. https:\/\/www.kaggle.com\/c\/open-shopee-code-league-logistic\/discussion\/165829","35203fb0":"# Prepare Submit","0bf8c395":"A Big Thanks to the notebook contributer to let me get the ideas to solve this question as a beginner!\n1. [3 hooman 1 cat - Logistics](http:\/\/www.kaggle.com\/xuanquang1999\/3-hooman-1-cat-logistics)\n2. [week5](http:\/\/www.kaggle.com\/huikang\/week5)","c51b551b":"# Data manipulate","f65cefd8":"# Set environment"}}