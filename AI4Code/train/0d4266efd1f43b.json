{"cell_type":{"d36167a5":"code","0d3fdb87":"code","94216f9a":"code","be75c06b":"code","b77c5e5d":"code","a2fbab21":"code","d7de6b8c":"code","f99ebed5":"code","6466d7b8":"code","0058997f":"code","87481ba9":"code","b3960697":"code","3e7e5cc6":"code","f3edf92e":"code","a9a90076":"code","39e7c158":"code","be704bd4":"code","e21a513e":"code","a224db37":"code","439c50e6":"code","159c7f34":"code","29b0dc8f":"code","e4d9e332":"markdown","fa42a327":"markdown","716970d5":"markdown","14fdfea6":"markdown","09bd02cb":"markdown","92f0f023":"markdown","ad99e635":"markdown","1251ef10":"markdown","cf76e832":"markdown","555f2e96":"markdown","4e850aac":"markdown","85cef539":"markdown","5151a3b3":"markdown","95d4b9bf":"markdown","61a42880":"markdown","88f0edf5":"markdown","e6750346":"markdown","dd78d10a":"markdown","64a28d86":"markdown","3160bd7e":"markdown","5bb31b9d":"markdown","455b552c":"markdown","70e200db":"markdown","b4f398d8":"markdown","283ea92d":"markdown","a2bd33b2":"markdown","f138174b":"markdown"},"source":{"d36167a5":"import numpy as np\nimport pandas as pd\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nfrom pandas.api.types import is_numeric_dtype\n\nimport warnings\n\nwarnings.filterwarnings('ignore')\n\nsns.set()\n\n%matplotlib inline","0d3fdb87":"abalone = pd.read_csv('..\/input\/abalone.csv', sep=',')\nabalone.head()","94216f9a":"abalone.describe()","be75c06b":"rows = 2\ncols = 2\ni = 0\n\nplt.figure(figsize=(cols * 5, rows * 5))\n\ni += 1\nplt.subplot(rows, cols, i)\nplt.xticks(range(0, 31, 4))\nplt.xlim(0, 30)\n_ = sns.distplot(abalone['Rings'], kde=False, bins=range(0, 31, 2))\n\ni += 1\nplt.subplot(rows, cols, i)\n_ = sns.distplot(abalone['Rings'])\n\ni += 1\nplt.subplot(rows, cols, i)\nplt.xticks(range(0, 31, 4))\nplt.xlim(0, 30)\n_ = sns.boxplot(abalone['Rings'])","b77c5e5d":"plt.figure(figsize=(15, 15))\n\ncolors = sns.color_palette()\n\nlines = 3\nrows = 3\ni = 0\n\ni += 1\nplt.subplot(lines, rows, i)\n_ = sns.distplot(abalone['Length'], color=colors[i % 3])\n    \ni += 1\nplt.subplot(lines, rows, i)\n_ = sns.distplot(abalone['Diameter'], color=colors[i % 3])\n\ni += 1\nplt.subplot(lines, rows, i)\n_ = sns.distplot(abalone['Height'], color=colors[i % 3])\n\ni += 1\nplt.subplot(lines, rows, i)\n_ = sns.distplot(abalone['Length'], kde=False, bins=np.arange(0.0, 0.9, 0.05), color=colors[i % 3])\n    \ni += 1\nplt.subplot(lines, rows, i)\n_ = sns.distplot(abalone['Diameter'], kde=False, bins=np.arange(0.0, 0.7, 0.05), color=colors[i % 3])\n\ni += 1\nplt.subplot(lines, rows, i)\n_ = sns.distplot(abalone['Height'], kde=False, bins=10, color=colors[i % 3])\n\ni += 1\nplt.subplot(lines, rows, i)\n_ = sns.boxplot(abalone['Length'], color=sns.color_palette()[i % 3])\n\ni += 1\nplt.subplot(lines, rows, i)\n_ = sns.boxplot(abalone['Diameter'], color=colors[i % 3])\n\ni += 1\nplt.subplot(lines, rows, i)\n_ = sns.boxplot(abalone['Height'], color=colors[i % 3])","a2fbab21":"# removing outliers \nabalone = abalone[abalone['Height'] < 0.4]\n\nplt.figure(figsize=(15, 15))\n\ncolors = sns.color_palette()\n\nlines = 3\nrows = 3\ni = 0\n\ni += 1\nplt.subplot(lines, rows, i)\n_ = sns.distplot(abalone['Length'], color=colors[i % 3])\n    \ni += 1\nplt.subplot(lines, rows, i)\n_ = sns.distplot(abalone['Diameter'], color=colors[i % 3])\n\ni += 1\nplt.subplot(lines, rows, i)\n_ = sns.distplot(abalone['Height'], color=colors[i % 3])\n\ni += 1\nplt.subplot(lines, rows, i)\n_ = sns.distplot(abalone['Length'], kde=False, bins=np.arange(0.0, 0.9, 0.05), color=colors[i % 3])\n    \ni += 1\nplt.subplot(lines, rows, i)\n_ = sns.distplot(abalone['Diameter'], kde=False, bins=np.arange(0.0, 0.7, 0.05), color=colors[i % 3])\n\ni += 1\nplt.subplot(lines, rows, i)\n_ = sns.distplot(abalone['Height'], kde=False, bins=10, color=colors[i % 3])\n\ni += 1\nplt.subplot(lines, rows, i)\n_ = sns.boxplot(abalone['Length'], color=sns.color_palette()[i % 3])\n\ni += 1\nplt.subplot(lines, rows, i)\n_ = sns.boxplot(abalone['Diameter'], color=colors[i % 3])\n\ni += 1\nplt.subplot(lines, rows, i)\n_ = sns.boxplot(abalone['Height'], color=colors[i % 3])","d7de6b8c":"plt.figure(figsize=(20, 15))\n\ncolors = sns.color_palette()\n\nrows = 3\ncols = 4\ni = 0\n\ni += 1\nplt.subplot(rows, cols, i)\n_ = sns.distplot(abalone['Whole weight'], color=colors[i % cols])\n    \ni += 1\nplt.subplot(rows, cols, i)\n_ = sns.distplot(abalone['Shucked weight'], color=colors[i % cols])\n\ni += 1\nplt.subplot(rows, cols, i)\n_ = sns.distplot(abalone['Viscera weight'], color=colors[i % cols])\n\ni += 1\nplt.subplot(rows, cols, i)\n_ = sns.distplot(abalone['Shell weight'], color=colors[i % cols])\n\ni += 1\nplt.subplot(rows, cols, i)\n_ = sns.distplot(abalone['Whole weight'], kde=False, bins=14, color=colors[i % cols])\n    \ni += 1\nplt.subplot(rows, cols, i)\n_ = sns.distplot(abalone['Shucked weight'], kde=False, bins=14, color=colors[i % cols])\n\ni += 1\nplt.subplot(rows, cols, i)\n_ = sns.distplot(abalone['Viscera weight'], kde=False, bins=16, color=colors[i % cols])\n\ni += 1\nplt.subplot(rows, cols, i)\n_ = sns.distplot(abalone['Shell weight'], kde=False, bins=20, color=colors[i % cols])\n\ni += 1\nplt.subplot(rows, cols, i)\n_ = sns.boxplot(abalone['Whole weight'], color=colors[i % cols])\n\ni += 1\nplt.subplot(rows, cols, i)\n_ = sns.boxplot(abalone['Shucked weight'], color=colors[i % cols])\n\ni += 1\nplt.subplot(rows, cols, i)\n_ = sns.boxplot(abalone['Viscera weight'], color=colors[i % cols])\n\ni += 1\nplt.subplot(rows, cols, i)\n_ = sns.boxplot(abalone['Shell weight'], color=colors[i % cols])","f99ebed5":"plt.figure(figsize=(5,5))\n_ = sns.countplot(abalone.Sex)","6466d7b8":"plt.figure(figsize=(10, 10))\ncorr = abalone.corr()\n_ = sns.heatmap(corr, annot=True)","0058997f":"plt.figure(figsize=(20, 5))\n\n_ = sns.jointplot(data=abalone, x='Rings', y='Height', kind='reg')\n_ = sns.jointplot(data=abalone, x='Rings', y='Shell weight', kind='reg')","87481ba9":"i_abalone = abalone[abalone['Rings'] < 10]\n\nplt.figure(figsize=(10, 10))\ncorr = i_abalone.corr()\n_ = sns.heatmap(corr, annot=True)","b3960697":"plt.figure(figsize=(20, 5))\n\n_ = sns.jointplot(data=i_abalone, x='Rings', y='Length',  kind='reg')\n_ = sns.jointplot(data=i_abalone, x='Rings', y='Diameter', kind='reg')\n_ = sns.jointplot(data=i_abalone, x='Rings', y='Height', kind='reg')","3e7e5cc6":"plt.figure(figsize=(10, 15))\n\ncolors = sns.color_palette()\n\nrows = 3\ncols = 1\ni = 0\n\ni += 1\nplt.subplot(rows, cols, i)\n_ = sns.violinplot(data=i_abalone, x='Rings', y='Length')\n\ni += 1\nplt.subplot(rows, cols, i)\n_ = sns.violinplot(data=i_abalone, x='Rings', y='Diameter')\n\ni += 1\nplt.subplot(rows, cols, i)\n_ = sns.violinplot(data=i_abalone, x='Rings', y='Height')","f3edf92e":"plt.figure(figsize=(20, 5))\n\n_ = sns.jointplot(data=i_abalone, x='Rings', y='Height',  kind='reg')\n_ = sns.jointplot(data=i_abalone, x='Rings', y='Shell weight', kind='reg')","a9a90076":"a_abalone = abalone[abalone['Rings'] >= 10]\n\nplt.figure(figsize=(10, 10))\ncorr = a_abalone.corr()\n_ = sns.heatmap(corr, annot=True)\n\nplt.figure(figsize=(20, 10))\n\n_ = sns.jointplot(data=a_abalone, y='Height', x='Rings', kind='reg')\n_ = sns.jointplot(data=a_abalone, y='Shell weight', x='Rings', kind='reg')","39e7c158":"plt.figure(figsize=(7, 7))\n_ = sns.boxplot(data=abalone, x='Sex', y='Rings')","be704bd4":"g = sns.FacetGrid(abalone, col='Sex', margin_titles=True, size=5)\n_ = g.map(sns.distplot, 'Rings', kde=False, bins=range(0, 31, 2))","e21a513e":"plt.figure(figsize=(7, 7))\n_ = sns.boxplot(data=abalone, x='Sex', y='Height')","a224db37":"g = sns.FacetGrid(abalone, col='Sex', margin_titles=True, size=5)\n_ = g.map(sns.distplot, 'Height', kde=False, bins=10)","439c50e6":"plt.figure(figsize=(7, 7))\n_ = sns.boxplot(data=abalone, x='Sex', y='Shell weight')","159c7f34":"g = sns.FacetGrid(abalone, col='Sex', margin_titles=True, size=5)\n_ = g.map(sns.distplot, 'Height', kde=False, bins=10)","29b0dc8f":"plt.figure(figsize=(20, 5))\n\n_ = sns.lmplot(data=abalone, x='Rings', y='Height', hue='Sex', fit_reg=True)\n_ = sns.lmplot(data=abalone, x='Rings', y='Shell weight', hue='Sex', fit_reg=True)","e4d9e332":"The violin plots bellow show that the median of *Size* attributes increases as instances are grouped by *Rings*: ","fa42a327":"## 1. What is an Abalone ?\n\nFrom the [Abalone entry on Wikipedia](https:\/\/en.wikipedia.org\/wiki\/Abalone):\n\n\n> Abalones are marine snails. Their taxonomy puts them in the family Haliotidae which contains only one genus, Haliotis, which once contained six subgenera. These subgenera have become alternate representations of Haliotis. The number of species recognized worldwide ranges between 30 and 130 with over 230 species-level taxa described. The most comprehensive treatment of the family considers 56 species valid, with 18 additional subspecies.\n\n<figure>\n     <img src=\"https:\/\/upload.wikimedia.org\/wikipedia\/commons\/thumb\/3\/33\/LivingAbalone.JPG\/1280px-LivingAbalone.JPG\" width=300 height=300\/>\n    <figcaption>Image 1: A living adult Abalone <\/figcaption>\n<\/figure>\n\nAbalones can be found along coasts of almost every continent. Usually, abalones are consumed as food all around the world, by different cultures. However, the bright and variety of colors of the interior side of their shells makes then an valuable object of adornment and decoration.\n\n<figure>\n     <img src=\"https:\/\/c1.staticflickr.com\/3\/2538\/4552977683_f725d7ea1e.jpg\" width=300 height=300\/>\n    <figcaption>Image 2: The inner side of an abalone shell <\/figcaption>\n<\/figure>\n\n","716970d5":"These results suggest that abalones grows in size and weight until a certain age, near 10 years. After this age their size and age remains stable in function of age, depending more on environmental factors.","14fdfea6":"and *Shell weight*:","09bd02cb":"### 3.1. The Target Attribute\n\nThe analysis shows that the *Ring* attribute values ranges from 1 to 29 rings on an abalone specimen. However, the most frequent values of *Rings* are highly concentrated around the median of the distribution, so that, the 2nd and 3rd quartiles are defined in a range of less than 1 std deviation. We observe that its possible to approximate the distribution of this attribute to a normal curve.","92f0f023":"We observe a similar result where comparing *Height* and *Shell weight* to *Rings*:","ad99e635":"Analyzing the correlation matrix, we notice that *Height* and *Shell weight* are the attributes that most correlates to *Rings*. Therefore, we concentrated the multivariate analysis on the correlation of these two attributes with *Rings*:","1251ef10":"### 3.2. Size Attributes\n\nIn this section, we analyze the attributes that represents the dimensions of an abalone. These attributes are *Lenght*, *Diameter* and *Height*. For each of these attributes we plotted two histograms and their respective boxplot. The first histogram is a density histogram and a kernel density estimate, and the second is the absolute frquencies of the attribute, with some adjustments to ticks and bins. Once more, we observe an approximate normal distribution. However we notice the high peak formed by the *Height* histogram. Analyzing the *Height* boxplot we conclude that the high peak is formed due the presence of two observations that lie far beyond the central positions of the distribution.","cf76e832":"### 4.2. Influence of Sex on attributes","555f2e96":"Finally, we analyze how the categories influence the correlations *Ring* x *Height* and *Ring* x *Shell weight*. We already concluded that these attributes has stronger correlation for lower values of *Rings*. Because *Infant* abalones have lower values of *Rings*, the consequence is that *Height* and *Shell weight* have stronger correlation to rings. Observing the regression curve for the *Infant* category, we notice that its inclination is closer to 45\u00b0.  ","4e850aac":"On the other hand, when we consider only samples with more than 10 *Rings* we observe that correlation decays drastically to near 0 (zero):","85cef539":"In the following plots we observe the positive correlation between the *Size* attributes and *Rings*:","5151a3b3":"## 2. The Abalone Dataset\n\nThe Abalone Dataset was originally published at the [UCI Machine Learning Repository](https:\/\/archive.ics.uci.edu\/ml\/index.php), and can be found at https:\/\/archive.ics.uci.edu\/ml\/datasets\/Abalone. The original stated problem is estimate the age an abalone, which can be determined from the number of rings in their shell. However, counting the number of rings in an abalone shell is an expensive method. Thus, one possible solution is predict the number of rings of an abalone from characteristics like height, diameter, lenght and weight measurements.\n\nThe Abalone Dataset is composed of the following attributes:\n\n<table>\n    <thead>\n        <tr>\n            <th>Name<\/th>\n            <th>Data Type<\/th>\n            <th>Meas.<\/th>\n            <th>Description<\/th>\n        <\/tr>\n        <tbody>\n            <tr><td>Sex<\/td>\t\t    <td>nominal<\/td>\t<td><\/td>\t\t        <td>M, F, and I (infant)<\/td><\/tr>\n\t<tr><td>Length<\/td>\t\t    <td>continuous<\/td>\t<td>mm<\/td>\t    <td>Longest shell measurement<\/td><\/tr>\n\t<tr><td>Diameter<\/td>\t    <td>continuous<\/td>\t<td>mm<\/td>\t    <td>perpendicular to length<\/td><\/tr>\n\t<tr><td>Height<\/td>\t\t    <td>continuous<\/td>\t<td>mm<\/td>\t    <td>with meat in shell<\/td><\/tr>\n\t<tr><td>Whole weight<\/td>\t<td>continuous<\/td>\t<td>grams<\/td>\t<td>whole abalone<\/td><\/tr>\n\t<tr><td>Shucked weight<\/td>\t<td>continuous<\/td>\t<td>grams<\/td>\t<td>weight of meat<\/td><\/tr>\n\t<tr><td>Viscera weight<\/td>\t<td>continuous<\/td>\t<td>grams<\/td>\t<td>gut weight (after bleeding)<\/td><\/tr>\n\t<tr><td>Shell weight<\/td>\t<td>continuous<\/td>\t<td>grams<\/td>\t<td>after being dried<\/td><\/tr>\n\t<tr><td>Rings<\/td>\t\t    <td>integer<\/td>\t<td><\/td>       <td>+1.5 gives the age in years<\/td><\/tr>\n        <\/tbody>\n    <\/thead>\n<\/table>\n\nIn this study, each one of these attributes were analyzed, as well as the relationships between them.","95d4b9bf":"## 4. Multivariate Analysis\n\nIn this section we analyzed how the dataset attributes are related and how the independent variables influences the target variable. Our first step in the multivariate analysis was to visualize the correlation matrix in a heatmap:","61a42880":"Finally, we analyze how the *Sex* category influences the distribution of variables *Rings*, *Height* and *Shell weight*. Our objective is learn if the different categories of abalones have different distribution parameters or even form. To accomplish this objective, we visualize the distribution of each one of these parameters in relation to *Sex*. Finally, we analyze how the different *Sex* categories of abalones influence the correlation of *Rings*, *Height* and *Shell weight*.","88f0edf5":"Based on the previous analysis, we decided to investigate the variation of the correlation regarding the number of rings in more detail. We tested for many values, and found that the region delimited by *Rings < 10* has greater correlation between the independent attributes and the target variable.","e6750346":"Our first step is to analyze how *Sex* categories influence the number of *Rings*. We observe that the median of *Rings* for the *I* category is lower than the median for *M* and *F* categories.","dd78d10a":"The same pattern is observer for *Height*:","64a28d86":"However, the form of the distribution remains similar: samples are concentrated around the mean of the distribution. The difference is that for *Infant* abalones the mean of *Rings* is lower.","3160bd7e":"## 5. Conclusion\n\n* By observing the correlation between the target attribute *Rings* and the indepent variables, we conclude that it is possible to build a model to predict the target value in function of the independent attributes.\n* The weight of the Abalones varies proportional to their sizes\n* There's no significant differences in size, weight and numbers of rigns between male\/female abalones\n* The Infant Abalones groups presents lower mean values of size, weight and number of rings \n* The weight and height of abalones varies accordingly to age until the adult age, after adult life size and weight stops varying, and after 16.5 years (15 rings) these measurements aren't correlated.","5bb31b9d":"### 3.4. Sex\n\nThe *Sex* attribute is a categorical variable for which the possibles values are: M for Male, F for Female and I of Infant (an abalone which is not adult). We analyzed the count of each category with a bar plot, and concluded that relative to this attribute, the dataset is balanced.","455b552c":"### 4.1. How correlation varies with the number of rings ?","70e200db":"### 3.3. Weight Attributes\n\nThe weight attributes were analyzed following a similar approach to the Size attributes analysis. A similar distributions were observed, however, for the weight attributes the bell curve is a little larger. ","b4f398d8":"Thus, we filter these outliers in order to obtain a more realistic visualization of the distribution of the *Height* attribute: ","283ea92d":"## 3. Univariate Analysis\n\nIn this section the distribution of each attribute is analyzed individually. We start analyzing the distribution of the target attribute *Rings*. The rest of the attributes are divided in groups for convenience of the analysis: a group called *Size*, containing attributes that represents the dimensions of an abalone, a group *Weight*, containing the different weight attributes and a third group composed only of the *Sex* attribute. The continous or quantitative attributes were analyzed using histograms and boxplots, while categorical attributes were analyzed using barplots. ","a2bd33b2":"We notice an interesting pattern: for lower values of *Rings* we have concentrated values of *Height* and *Shell weight*. As the value of *Rings* increases, the scatterplot becames larger, and for the highest values of *Rings* it become disperse. ","f138174b":"# Abalone: exploratory data analysis\n\nIn this notebook we perform an exploratory data analysis over the Abalone Dataset, originally published at the [UCI Machine Learning Repository](https:\/\/archive.ics.uci.edu\/ml\/index.php), and which can be found at https:\/\/archive.ics.uci.edu\/ml\/datasets\/Abalone. In this analysis we seek to understand the distribution of the dataset attributes, as well as the relationship between them.\n\nThe analysis is divided in five sections: on section 1 we briefly present what an abalone is. On section 2 we presetn the Abalone Dataset and their attributes. On section 3 we performe the analysis of each attribute individually. On section 4 we seek for correlations between the attributes and how the segmentation affects the results. Finally on section 5 we present our conclusions."}}