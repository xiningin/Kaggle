{"cell_type":{"f99ed9d9":"code","757f5da9":"code","f8701d88":"code","0b9ae357":"code","eb41654e":"code","7b353f8f":"code","c49820e0":"markdown","c1b085d7":"markdown","938f0e9b":"markdown"},"source":{"f99ed9d9":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nimport time\nimport cv2\nimport glob\nimport matplotlib.pyplot as plt\n\n\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","757f5da9":"train_image_names = glob.glob('..\/input\/gtsrb_challenge\/GTSRB_Challenge\/train\/*\/*.ppm')\nprint(\"Total number of training images: \", len(train_image_names))\n\n# make train_image_names as serie object\ntrain_image_names = pd.Series(train_image_names)","f8701d88":"# train_df: a dataframe with 2 field: Filename, ClassId\ntrain_df = pd.DataFrame()\n\n# generate Filename field\ntrain_df['Filename'] = train_image_names.map(lambda img_name: img_name.split(\"\/\")[-1])\n\n# generate ClassId field\ntrain_df['ClassId'] = train_image_names.map(lambda img_name: int(img_name.split(\"\/\")[-2]))\n\ntrain_df.head()","0b9ae357":"plot_df = train_df.sample(9).reset_index()\nplt.figure(figsize=(10, 10))\n\nfor i in range(9):\n    img_name = plot_df.loc[i, 'Filename']\n    label_str = \"%05d\"%(plot_df.loc[i, 'ClassId'])\n    plt.subplot(3,3,i+1)\n    plt.imshow(plt.imread(os.path.join('..\/input\/gtsrb_challenge\/GTSRB_Challenge\/train\/',label_str, img_name)))\n    plt.title(label_str)\n    plt.xticks([])\n    plt.yticks([])","eb41654e":"class_id_distribution = train_df['ClassId'].value_counts()\nclass_id_distribution.head(10)","7b353f8f":"plt.figure(figsize=(13,5))\nplt.xticks(np.arange(43))\nplt.bar(class_id_distribution.index, class_id_distribution.values)","c49820e0":"# 1. Load training images:\n- Note that all images in train\/ or test\/ are of .ppm extension","c1b085d7":"## Visualize some image","938f0e9b":"# 2. See the classes distribution:\n- You will see that the distribution of image among classes is highly imbalanced"}}