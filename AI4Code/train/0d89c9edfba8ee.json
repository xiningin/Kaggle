{"cell_type":{"51538674":"code","1360b992":"code","a2e4f0c3":"code","1d6f7ac9":"code","7106606d":"code","b2ddccdd":"code","08cdbc55":"code","032c2251":"code","d2422544":"code","c2639810":"code","55fcd4ce":"code","47bf7856":"code","91cd40a4":"code","ce182668":"code","ba2bcae2":"code","2f54a3b9":"code","d91e9b4d":"code","338317c1":"code","af055679":"code","123eb62b":"code","67d26481":"markdown","ce1e3a61":"markdown","560548fb":"markdown","5ad088f2":"markdown"},"source":{"51538674":"!pip install fastai -U","1360b992":"from fastai.text.all import *","a2e4f0c3":"path = '..\/input\/nlp-getting-started'\ntrain_path = path + '\/train.csv'\ntest_path = path + '\/test.csv'","1d6f7ac9":"train = pd.read_csv(train_path)","7106606d":"train.head()","b2ddccdd":"train.info()","08cdbc55":"train.keyword.value_counts()","032c2251":"train.location.describe()","d2422544":"train.location.value_counts()","c2639810":"dls = TextDataLoaders.from_df(\n    train, \n    path, \n    valid_pct=0.2, \n    text_col = ['text', 'keyword', 'location'],\n    label_col = 'target'\n)","55fcd4ce":"dls.show_batch()","47bf7856":"learn = text_classifier_learner(dls, \n                                AWD_LSTM, \n                                drop_mult=0.5, \n                                metrics=accuracy, \n                                cbs=ShowGraphCallback())","91cd40a4":"learn.fine_tune(4, 1e-2)","ce182668":"test = pd.read_csv(test_path)","ba2bcae2":"test.head()","2f54a3b9":"learn.predict(test.iloc[0])","d91e9b4d":"results = pd.DataFrame(columns=['id', 'target'])","338317c1":"for i, row in test.iterrows():\n    print(i)\n    pass_id = row['id']\n    pred = learn.predict(row);\n    \n    \n    results.loc[i] = [pass_id, pred[0]]\n        \nresults","af055679":"results","123eb62b":"results.to_csv('submission.csv', index=False)","67d26481":"# Data","ce1e3a61":"# Prediction","560548fb":"# Train","5ad088f2":"# Setup"}}