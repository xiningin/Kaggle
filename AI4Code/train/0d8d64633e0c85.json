{"cell_type":{"42a18a19":"code","a623a0fe":"code","e2b60604":"code","fd8cfca2":"code","6f0c1e44":"code","265772cc":"code","b455acaa":"code","333b48db":"code","04b12ec6":"code","ac52bb59":"code","aa362799":"code","e261ab45":"code","7efda095":"code","2a7b1505":"code","53a5af15":"code","97d092c5":"code","f9ef3c67":"code","246bc1b4":"code","3d361f85":"code","5219569b":"code","a90b4460":"code","fefedbc6":"code","0e620c08":"code","19301535":"code","ab50b5fb":"code","1c342eff":"code","bfba4a87":"code","4d69c85f":"code","5a49926f":"code","9f0b4326":"code","81cf5da7":"code","9f1bfb13":"code","499ffddb":"code","5802d423":"code","c05bd7dd":"code","0874c612":"code","769c214c":"code","03112ca7":"code","f3da11bc":"code","9f7c527a":"code","098ef8d8":"code","c7175391":"code","3f5b1de8":"code","be20452a":"code","cb4b63e7":"code","4729a35f":"code","7a3f8038":"code","738a2234":"code","950cb0fb":"code","fb4ef6cd":"code","cbe348f3":"code","3f2b0adb":"code","39cf2dd8":"code","ada657db":"code","6a8e9c51":"code","b790d762":"code","bfbdb211":"code","34935fc4":"code","f98c1930":"code","ba33b15d":"code","31692c04":"code","913b066e":"code","f7dc9fc6":"code","5594e64a":"code","f801ef5a":"code","7eb938ab":"code","b636571c":"code","7e325ee0":"code","b0bf3abd":"code","f256f155":"code","3d13d00c":"code","cd85cff7":"code","100eedfe":"code","63e587cb":"code","5acbd3de":"code","33a79c65":"code","ad575062":"markdown","c7fb5b80":"markdown","9db627ff":"markdown","b77e996d":"markdown","5ebbca20":"markdown","7cf303e9":"markdown","035252af":"markdown","f72c8b8b":"markdown","60d2c1b0":"markdown","c027e26a":"markdown","78fbe091":"markdown","44ac2d98":"markdown","be85ab27":"markdown","0edc68c0":"markdown","6cfa948b":"markdown","fd0fc028":"markdown","13b5cf57":"markdown","d5ec633e":"markdown","32407e8c":"markdown","5fd9b18b":"markdown","1e49b825":"markdown","897712ae":"markdown","7c9766d3":"markdown","dadc0cc5":"markdown","ba8c4302":"markdown","1298ff30":"markdown","b01ae870":"markdown","7a939b59":"markdown","9bc022d1":"markdown","07fa3395":"markdown","2a9e1e01":"markdown","34ca45b7":"markdown","57989b3e":"markdown","ed11e107":"markdown","3e046100":"markdown","a1f63b17":"markdown","0d2f19d3":"markdown","7f695d14":"markdown","d2857f78":"markdown","39afc363":"markdown","1513357b":"markdown","cebc1f95":"markdown","8a88e3d1":"markdown","5492acae":"markdown","38e06ea5":"markdown","09132f5d":"markdown","b703b96b":"markdown","029bab84":"markdown","c943e2bd":"markdown","ec06c005":"markdown","27c61785":"markdown","bd21c0ab":"markdown","03f305d3":"markdown","74286334":"markdown","3c763f3c":"markdown"},"source":{"42a18a19":"import pandas as pd\nimport numpy as np\nimport seaborn as sn\nimport matplotlib.pyplot as plt\nfrom sklearn.preprocessing import LabelEncoder, MinMaxScaler\nfrom scipy import stats\nfrom sklearn.model_selection import train_test_split, GridSearchCV , RandomizedSearchCV, cross_val_score\nfrom sklearn.linear_model import LinearRegression, Ridge, Lasso\nfrom sklearn.svm import SVR\nfrom sklearn.tree import DecisionTreeRegressor\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.metrics import r2_score, mean_squared_error\n\nimport warnings\nwarnings.filterwarnings('ignore')\n\n%matplotlib inline","a623a0fe":"data = pd.read_csv(\"\/kaggle\/input\/insurance-premium-prediction\/insurance.csv\")","e2b60604":"data.head()","fd8cfca2":"data.shape","6f0c1e44":"data.info()","265772cc":"data.duplicated().sum()","b455acaa":"data.isnull().sum()","333b48db":"print(\"Age: \", data.age.unique())\nprint(\"Sex: \", data.sex.unique())\nprint(\"Children: \", data.children.unique())\nprint(\"Smoker: \", data.smoker.unique())\nprint(\"region: \", data.region.unique())","04b12ec6":"enc = LabelEncoder()","ac52bb59":"data.sex = enc.fit_transform(data.sex) # Female 0 and Male 1\ndata.smoker = enc.fit_transform(data.smoker) # No 0 and Yes 1\ndata.region = enc.fit_transform(data.region) # Northeast 0, Northwest 1, Southeast 2, Southwest 3","aa362799":"data.head(10)","e261ab45":"data.describe()","7efda095":"# Function to identify the outliers\ndef findoutliers(column):\n    outliers=[]\n    Q1=column.quantile(.25)\n    Q3=column.quantile(.75)\n    IQR=Q3-Q1\n    lower_limit=Q1-(1.5*IQR)\n    upper_limit=Q3+(1.5*IQR)\n    for out1 in column:\n        if out1>upper_limit or out1 <lower_limit:\n            outliers.append(out1)\n            \n    return np.array(outliers)  ","2a7b1505":"print(len(findoutliers(data.age))) # Number of rows having outlier in age","53a5af15":"print(len(findoutliers(data.bmi))) # Number of rows having outlier in bmi","97d092c5":"print(len(findoutliers(data.children))) # Number of rows having outlier in children","f9ef3c67":"sn.boxplot(data.bmi) # Visualising bmi- outliers","246bc1b4":"plt.hist(data.age) # Continuous data","3d361f85":"plt.hist(data.bmi) # Continuous data","5219569b":"plt.hist(data.children) # Discrete data","a90b4460":"data.sex.value_counts() # Nominal data","fefedbc6":"sn.factorplot('sex',data=data,kind='count')","0e620c08":"data.smoker.value_counts() # Nominal data","19301535":"sn.factorplot('smoker',data=data,kind='count')","ab50b5fb":"data.region.value_counts() # Norminal data","1c342eff":"sn.factorplot('region',data=data,kind='count')","bfba4a87":"print(\"Skewness of age: \", stats.skew(data.age))\nprint(\"Kurtosis of age: \", stats.kurtosis(data.age))","4d69c85f":"print(\"Skewness of sex: \", stats.skew(data.sex))\nprint(\"Kurtosis of sex: \", stats.kurtosis(data.sex))","5a49926f":"print(\"Skewness of bmi: \", stats.skew(data.bmi))\nprint(\"Kurtosis of bmi: \", stats.kurtosis(data.bmi))","9f0b4326":"print(\"Skewness of children: \", stats.skew(data.children))\nprint(\"Kurtosis of children: \", stats.kurtosis(data.children))","81cf5da7":"print(\"Skewness of smoker: \", stats.skew(data.smoker))\nprint(\"Kurtosis of smoker: \", stats.kurtosis(data.smoker))","9f1bfb13":"print(\"Skewness of region: \", stats.skew(data.region))\nprint(\"Kurtosis of region: \", stats.kurtosis(data.region))","499ffddb":"data.corrwith(data.expenses)","5802d423":"data.corr()","c05bd7dd":"corr = data.corr()\nsn.heatmap(corr, cmap = 'Blues', annot= True)","0874c612":"scaler = MinMaxScaler()\ndata[['age','bmi','sex','children','smoker']]=scaler.fit_transform(data[['age','bmi','sex','children','smoker']])","769c214c":"data.head(10)","03112ca7":"X = data.iloc[:,:-2]\ny = data.expenses","f3da11bc":"X","9f7c527a":"y","098ef8d8":"x_train, x_test, y_train, y_test = train_test_split( X, y, train_size = 0.6, random_state = 20)","c7175391":"model_lr = LinearRegression()","3f5b1de8":"model_lr.fit(x_train,y_train)","be20452a":"y_predict_lr = model_lr.predict(x_test)","cb4b63e7":"r2_lr = r2_score(y_test,y_predict_lr)\nr2_lr","4729a35f":"mse_lr = mean_squared_error(y_test,y_predict_lr)\nmse_lr","7a3f8038":"model_rr = Ridge()","738a2234":"model_rr.fit(x_train,y_train)","950cb0fb":"y_predict_rr = model_rr.predict(x_test)","fb4ef6cd":"r2_rr = r2_score(y_test,y_predict_rr)\nr2_rr","cbe348f3":"mse_rr = mean_squared_error(y_test,y_predict_rr)\nmse_rr","3f2b0adb":"model_ll = Lasso()","39cf2dd8":"model_ll.fit(x_train,y_train)","ada657db":"y_predict_ll = model_ll.predict(x_test)","6a8e9c51":"r2_ll = r2_score(y_test,y_predict_ll)\nr2_ll","b790d762":"mse_ll = mean_squared_error(y_test,y_predict_ll)\nmse_ll","bfbdb211":"model_sv = SVR(kernel='rbf')","34935fc4":"model_sv.fit(x_train,y_train)","f98c1930":"y_predict_sv = model_sv.predict(x_test)","ba33b15d":"r2_sv = r2_score(y_test,y_predict_sv)\nr2_sv","31692c04":"mse_sv = mean_squared_error(y_test,y_predict_sv)\nmse_sv","913b066e":"model_dt = DecisionTreeRegressor(random_state=0)","f7dc9fc6":"model_dt.fit(x_train,y_train)","5594e64a":"y_predict_dt = model_dt.predict(x_test)","f801ef5a":"r2_dt = r2_score(y_test,y_predict_dt)\nr2_dt","7eb938ab":"Adj_r2 = 1 - (1-r2_dt) * (len(y)-1)\/(len(y)-X.shape[1]-1)\nAdj_r2","b636571c":"mse_dt = mean_squared_error(y_test,y_predict_dt)\nmse_dt","7e325ee0":"model_rf = RandomForestRegressor()","b0bf3abd":"model_rf.fit(x_train,y_train)","f256f155":"y_predict_rf = model_rf.predict(x_test)","3d13d00c":"r2_rf = r2_score(y_test,y_predict_rf)\nr2_rf","cd85cff7":"Adj_r2 = 1 - (1-r2_rf) * (len(y)-1)\/(len(y)-X.shape[1]-1)\nAdj_r2","100eedfe":"mse_rf = mean_squared_error(y_test,y_predict_rf)\nmse_rf","63e587cb":"MSE = [mse_lr,mse_rr,mse_ll,mse_sv,mse_dt,mse_rf]\nR2_Score = [r2_lr,r2_rr,r2_ll,r2_sv,r2_dt,r2_rf]\nModels = ['Linear Regression', ' Ridge Regression' , ' Lasso Regression', 'Support Vector Machine',\n          'Decision Tree', 'Random Forest']","5acbd3de":"sn.barplot(MSE, Models, color=\"m\")\nplt.xlabel('MSE')\nplt.title('Mean Squared Error')\nplt.show()","33a79c65":"sn.barplot(R2_Score, Models, color=\"c\")\nplt.xlabel('R2 Score')\nplt.title('R2 Score')\nplt.show()","ad575062":"# SVM","c7fb5b80":"# Model Evaluation","9db627ff":"# Lasso Regression","b77e996d":"# Checking the correlation with dependent variable","5ebbca20":"Age is not normaly distributed as the kurtosis of age is greater than -1.","7cf303e9":"# Training the model","035252af":"# Testing the model","f72c8b8b":"# Training the model","60d2c1b0":"# Training the model","c027e26a":"# Converting categorical data to numerical","78fbe091":"- Age has weak positive correlation\n- Sex has weak positive correlation \n- BMI has weak positive correlation\n- Children has weak positive correlation\n- Smoker has strong positive correlation\n- Region has very weak positive correlation (almost no correlation)","44ac2d98":"# Checking for missing values","be85ab27":"# Visualising numerical data","0edc68c0":"# Training the model","6cfa948b":"###### REGION","fd0fc028":"# Testing the model","13b5cf57":"# Importing all the necessary libraries","d5ec633e":"# Analysing and visualising categorical data","32407e8c":"# Decision Tree","5fd9b18b":"# Testing the model","1e49b825":"# Ridge Regression","897712ae":"# Finding the outliers in numerical data","7c9766d3":"# Mean Squared Error Comparison Chart","dadc0cc5":"# Feature scaling (using min-max scaler)","ba8c4302":"# R2 Score Comparison Chart","1298ff30":"# Testing the model","b01ae870":"# Checking for duplicates","7a939b59":"# INSURANCE COST PREDICTION\n### A supervised learning model that can predict the cost of premium for health insurance.","9bc022d1":"# Training the model","07fa3395":"# Loading the dataset into the dataframe","2a9e1e01":"# Random Forest","34ca45b7":"###### CHILDREN","57989b3e":"BMI is normaly distributed.","ed11e107":"Sex is not normaly distributed as the kurtosis of sex is greater than -1.","3e046100":"# Checking the types of data","a1f63b17":"###### SMOKER","0d2f19d3":"# Finding the unique values of each column","7f695d14":"## Region Column has been removed as it has low Correlation","d2857f78":"#### From the charts it can be seen that the Mean Squared Error is lowest for Random forest and the R2 Score is highest for Random foest. Therefore, we can conclude that Random forest is the best algorithm for this data. ","39afc363":"Children is normaly distributed.","1513357b":"# Defining independent and dependent","cebc1f95":"# Testing the model","8a88e3d1":"# Training the model","5492acae":"# Statistical information describe","38e06ea5":"# Testing the model","09132f5d":"# Heatmap","b703b96b":"#### Outliers are not removed as models like decision tree are not sensitive to outliers.","029bab84":"# Checking the normality of data\n###### AGE","c943e2bd":"###### SEX","ec06c005":"# Total no.of rows and columns","27c61785":"# Linear Regression","bd21c0ab":"Region is not normaly distributed as the kurtosis of region is greater than -1.","03f305d3":"Smoker is nomaly distributed.","74286334":"###### BMI","3c763f3c":"# Spliting the data into training and testing data"}}