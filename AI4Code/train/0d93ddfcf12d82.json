{"cell_type":{"2bd39ff4":"code","b671aa0e":"code","c8957253":"code","e5a163b6":"code","a5887c20":"code","404e2541":"code","e948a903":"code","7a027317":"code","c465d803":"code","f7b52d27":"code","81b3791e":"code","d01205c6":"code","c48551cc":"code","d4a8df0f":"code","4b235cf3":"code","12140ce0":"code","069dd4e5":"code","9a393b08":"code","20441b07":"code","5371a552":"code","a1dcf9e4":"code","62dd8770":"markdown","25e1e1f6":"markdown","8921d848":"markdown","4672527f":"markdown","41a31dc6":"markdown"},"source":{"2bd39ff4":"import pandas as pd\nimport seaborn as sns\nimport numpy as np\nimport os\nimport matplotlib.pyplot as plt","b671aa0e":"carTrade_path = \"..\/input\/cartrade-used-cars-data\/CarTrade.csv\"\ndataframe = pd.read_csv(carTrade_path)","c8957253":"dataframe.head()","e5a163b6":"len(dataframe.Car_Model.unique())","a5887c20":"car_Model = dataframe.Car_Model.unique()\ncar_company = [car.split(\" \")[0] for car in car_Model]\ncar_unique = set(car_company)\nprint(car_unique)","404e2541":"Car_Company = dataframe['Car_Model'].apply(lambda x : x.split(' ')[0][2:])\nCar_Model_Only = dataframe['Car_Model'].apply(lambda x : x.split(' ',1)[1][:-2])\ndataframe.insert(3,\"Car_Company\",Car_Company)\n# dataframe.insert(4,\"Car_Company_Only\",Car_Model_Only)\ndataframe.drop([\"Car_Model\"],axis=1,inplace=True)\ndataframe.head()","e948a903":"dataframe.Car_Company = dataframe.Car_Company.str.lower()\n\n#Correcting Land Rover Company name\ndataframe.Car_Company = dataframe.Car_Company.replace(\"land\",\"land-rover\")\n#Correcting Car location\ndataframe[\"Car_Location\"] = dataframe[\"Car_Location\"].apply(lambda x : (x.rsplit(' ',1))[-1])\n#Making car price numeric\ndataframe.Car_Price = dataframe[\"Car_Price\"].apply(lambda x : x.replace(',',''))\ndataframe[\"Car_Price\"] = pd.to_numeric(dataframe[\"Car_Price\"])\n#Making Car kms numeric\ndataframe[\"Car_Kms\"] = dataframe[\"Car_Kms\"].apply(lambda x : (x.replace(\" KMs\",\"\")).replace(\",\",\"\"))\ndataframe[\"Car_Kms\"] = pd.to_numeric(dataframe[\"Car_Kms\"])\nprint(dataframe.head())","7a027317":"dataframe.head()","c465d803":"sns.distplot(dataframe[\"Car_Price\"])","f7b52d27":"sns.pairplot(dataframe)","81b3791e":"plt.figure(figsize=(25,6))\n\nplt.subplot(1,3,1)\nplt1 = dataframe.Car_Company.value_counts().plot(kind = \"bar\")\nplt1.set_title(\"Car Companies Histogram\")\nplt1.set(xlabel = 'Car company', ylabel='Frequency of company')\n\nplt.subplot(1,3,2)\nplt1 = dataframe.Car_Fuel.value_counts().plot(kind = \"bar\")\nplt1.set_title(\"Fuel Histogram\")\nplt1.set(xlabel = 'Fuel', ylabel='Frequency of Fuel')\n\nplt.subplot(1,3,3)\nplt1 = dataframe.Car_Location.value_counts().plot(kind = \"bar\")\nplt1.set_title(\"Location Histogram\")\nplt1.set(xlabel = 'Location', ylabel='Frequency of cars')\nplt.show()","d01205c6":"def create_dummies(column_name, dataframe):\n    temp = pd.get_dummies(dataframe[column_name],drop_first=True)\n    dataframe = pd.concat([dataframe,temp],axis=1)\n    dataframe.drop([column_name],inplace=True,axis=1)\n    return dataframe\n    \ndataframe = create_dummies(\"Car_Company\",dataframe)\ndataframe = create_dummies(\"Car_Fuel\",dataframe)\ndataframe = create_dummies(\"Car_Location\",dataframe)\ndataframe.head()","c48551cc":"from sklearn.model_selection import train_test_split\n\nnp.random.seed(0)\ndf_train, df_test = train_test_split(dataframe, train_size = 0.7, test_size = 0.3, random_state = 100)","d4a8df0f":"from sklearn.preprocessing import MinMaxScaler\n\nscaler = MinMaxScaler()\nnum_vars = [\"Car_Kms\",\"Car_Price\"]\ndf_train[num_vars] = scaler.fit_transform(df_train[num_vars])","4b235cf3":"df_train.shape","12140ce0":"plt.figure(figsize = (30, 25))\nsns.heatmap(df_train.corr(), annot = True, cmap=\"YlGnBu\")\nplt.show()","069dd4e5":"y_train = df_train.pop('Car_Price')\nX_train = df_train","9a393b08":"from sklearn.linear_model import LinearRegression\nlm = LinearRegression()\nlm.fit(X_train,y_train)","20441b07":"df_test[num_vars] = scaler.fit_transform(df_test[num_vars])\ny_test = df_test.pop(\"Car_Price\")\nX_test = df_test","5371a552":"y_pred = lm.predict(X_test)","a1dcf9e4":"from sklearn.metrics import r2_score,mean_squared_error,mean_absolute_error\nprint(\"R2 Score:\",r2_score(y_test, y_pred))\nprint(\"MAE : \",mean_absolute_error(y_test,y_pred))\nprint(\"MSE : \",mean_squared_error(y_test,y_pred))\nprint(\"RMSE :\",np.sqrt(mean_squared_error(y_test, y_pred)))","62dd8770":"## Maruti is most sold car. Petrol is more pouplar fule type and most cars are available in Mumbai.","25e1e1f6":"## Analysing Categorical Data","8921d848":"### There are no highly co-relating factors. Expecting not so good result.","4672527f":"## Train_Test_Split","41a31dc6":"# Creating Dummy Data"}}