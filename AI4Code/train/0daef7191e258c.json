{"cell_type":{"8ffb6d9e":"code","980b1ba5":"code","5fac7dff":"code","09bb169e":"code","380f76de":"code","6dabe271":"code","7eb65778":"code","a1570f79":"code","113ba43b":"code","6ed43c0d":"code","0b6faba6":"code","35236bbe":"code","55ac57ae":"code","a4a79cb6":"code","1522a788":"code","15c805cb":"code","0af125a7":"code","f40d79b5":"code","133cfd9f":"code","4f7e2f66":"code","f7dabec6":"code","9789ee30":"code","d41bbf82":"code","5290b8b0":"code","1f55ba1f":"code","cee3ae1b":"code","27bc3543":"code","ffa67df3":"code","26fb4351":"code","99cfe50a":"code","670b486c":"code","b5136a9f":"code","b5964b79":"code","17fb9549":"code","ac5fbebf":"code","59ee18a2":"markdown","a2d0f44a":"markdown","9de355e6":"markdown","08392835":"markdown","91b705c2":"markdown","1da70564":"markdown","4ecf9633":"markdown","eadbfb4d":"markdown","7d3a8ffa":"markdown","878a81d9":"markdown","90d7891d":"markdown","4c34338a":"markdown","b8178b02":"markdown","05e38e26":"markdown","64c7f738":"markdown","eb5031b1":"markdown","3ffc933c":"markdown","3add2b0d":"markdown","69b14aa7":"markdown","a4f0b453":"markdown","afc36b36":"markdown","60b41fdd":"markdown","26614551":"markdown","15b2ada9":"markdown","25977784":"markdown","071f774c":"markdown","43ec7bd3":"markdown","dd227df4":"markdown","b6aa0a8d":"markdown","83dc7e1a":"markdown","16216616":"markdown","f0e812b0":"markdown","edf727ce":"markdown","d98b2373":"markdown","74787dfe":"markdown"},"source":{"8ffb6d9e":"import pandas as pd\nimport plotly.express as px\nimport numpy as np\nimport datetime\nfrom plotly.subplots import make_subplots\nimport plotly.graph_objects as go\nimport plotly.figure_factory as ff","980b1ba5":"src = pd.read_csv(\"..\/input\/nba2k20-player-dataset\/nba2k20-full.csv\",parse_dates=True)","5fac7dff":"src.head()","09bb169e":"print(f\"No of rows: {src.shape[0]}\")\nprint(f\"No of columns: {src.shape[1]}\")","380f76de":"print(f\"Columns in the dataset\\n{pd.Series(src.columns).T}\")","6dabe271":"src.dtypes","7eb65778":"src.nunique()","a1570f79":"for i in src.columns[1:]:\n    print(i)\n    print(src[i].unique())","113ba43b":"print(f\"% of missing values\\n{np.round(src.isnull().mean()*100,2)}\")","6ed43c0d":"def to_date(x):\n    return datetime.datetime.strptime(x,\"%m\/%d\/%y\")\n\nsrc[\"b_day\"] = src[\"b_day\"].map(to_date)\nprint(f\"datatype: {src.b_day.dtype}\\nFew Unique Values\\n{src.b_day.unique()[:5]}\")","0b6faba6":"src = src.reset_index(drop=True)\nsrc.insert(7,\"height_ft\",0) # insert a new column \"height_ft\" and assign a value 0\nsrc.insert(8,\"height_cm\",0)# insert a new column \"height_cm\" and assign a value 0\nfor i,j in enumerate(src[\"height\"]):\n    split = j.split(\" \/ \") # splitting the text by \" \/ \"\n    src.loc[i,\"height_ft\"] = split[0].strip() #first element of the split is height in ft\n    src.loc[i,\"height_cm\"] = float(split[1].strip())*100 #second element of the split is height in m. Multiplying it with 100 to convert to cnm","35236bbe":"src.head()","55ac57ae":"src = src.reset_index(drop=True)\nsrc.insert(10,\"weight_lbs\",0)\nsrc.insert(11,\"weight_kg\",0)\nfor i,j in enumerate(src[\"weight\"]):\n    split = j.split(\" \/ \")\n    src.loc[i,\"weight_lbs\"] = float(split[0].replace(\"lbs.\",\"\").strip())\n    src.loc[i,\"weight_kg\"] = float(split[1].replace(\"kg.\",\"\").strip())","a4a79cb6":"src.head()","1522a788":"\"All the Salaries are in $\" if all(src[\"salary\"].str.startswith(\"$\")) else \"Not All the Salaries are in $\"","15c805cb":"src[\"salary\"] = src[\"salary\"].str.replace(\"$\",\"\",regex=False).astype(\"float64\")\nsrc.head()","0af125a7":"src.drop(columns=[\"height\",\"height_ft\",\"weight\",\"weight_lbs\"],inplace=True)","f40d79b5":"src.dtypes","133cfd9f":"src.head()","4f7e2f66":"src[\"team\"].fillna(\"Not Known\",inplace=True)\nsrc[\"college\"].fillna(\"Not Known\",inplace=True)","f7dabec6":"src.insert(8,\"bmi\",0)\nsrc.insert(9,\"bmi_class\",0)\nsrc[\"bmi\"] = np.round(src[\"weight_kg\"] \/ ((src[\"height_cm\"]\/100)**2),1)\nsrc.loc[src[\"bmi\"]<18.5,\"bmi_class\"] = \"underweight\"\nsrc.loc[(src[\"bmi\"]>=18.5) & (src[\"bmi\"]<=24.9),\"bmi_class\"] = \"normal\"\nsrc.loc[(src[\"bmi\"]>=25) & (src[\"bmi\"]<=29.9),\"bmi_class\"] = \"overweight\"\nsrc.loc[src[\"bmi\"]>=30,\"bmi_class\"] = \"obese\"","9789ee30":"def age_calc(dob):\n    today = datetime.datetime.today()\n    return np.floor(((today-dob).days)\/365)\nsrc.insert(6,\"age\",0)\nsrc[\"age\"] = src[\"b_day\"].map(age_calc)","d41bbf82":"src.head()","5290b8b0":"fig = make_subplots(rows=2, cols=3, subplot_titles=(\"Age\", \"Rating\", \"Salary\",\"BMI\",\"Height\",\"Weight\"))\n\nfig.add_trace(\n    go.Histogram(x=src[\"age\"]),\n    row=1, col=1\n)\n\nfig.add_trace(\n    go.Histogram(x=src[\"rating\"]),\n    row=1, col=2\n)\n\nfig.add_trace(\n    go.Histogram(x=src[\"salary\"]),\n    row=1, col=3\n)\n\nfig.add_trace(\n    go.Histogram(x=src[\"bmi\"]),\n    row=2, col=1\n)\n\nfig.add_trace(\n    go.Histogram(x=src[\"height_cm\"]),\n    row=2, col=2\n)\n\nfig.add_trace(\n    go.Histogram(x=src[\"weight_kg\"]),\n    row=2, col=3\n)\n\nfig.update_layout(title_text=\"Distribution of Numerical Variables\",showlegend=False)","1f55ba1f":"pd.set_option('display.float_format', lambda x: '%.1f' % x)\nsrc[[\"age\", \"rating\", \"salary\",\"bmi\",\"height_cm\",\"weight_kg\"]].describe()","cee3ae1b":"src.skew()","27bc3543":"teams = pd.DataFrame(src[\"team\"].value_counts()).reset_index()\nteams.columns=[\"team\",\"count\"]\n\npos = pd.DataFrame(src[\"position\"].value_counts()).reset_index()\npos.columns=[\"position\",\"count\"]\n\ncntry = pd.DataFrame(src[\"country\"].value_counts()).reset_index()\ncntry.loc[cntry[\"country\"]<(0.005*cntry[\"country\"].sum()),\"index\"] = \"Others\"\ncntry = cntry.groupby(\"index\").sum().reset_index()\ncntry.columns=[\"country\",\"count\"]\ncntry.sort_values(by=\"count\",ascending=False,inplace=True)\n\ncoll = pd.DataFrame(src[\"college\"].value_counts()).reset_index()\ncoll.loc[coll[\"college\"]<(0.01*coll[\"college\"].sum()),\"index\"] = \"Others\"\ncoll = coll.groupby(\"index\").sum().reset_index()\ncoll.columns=[\"college\",\"count\"]\ncoll.sort_values(by=\"count\",ascending=False,inplace=True)\n\nbmi_dist = pd.DataFrame(src[\"bmi_class\"].value_counts()).reset_index()\nbmi_dist.columns=[\"bmi_class\",\"count\"]\n\nfig = make_subplots(rows=4, cols=2,specs=[[{},{}],\n                                          [{\"colspan\": 2},None],\n                                         [{\"colspan\": 2},None],\n                                         [{\"colspan\": 2},None]],\n                    subplot_titles=(\"Position\", \"BMI_Class\",\"Country\", \"Team\",\"College\"))\n\nfig.add_trace(\n    go.Bar(y=pos[\"count\"],x=pos[\"position\"]),\n    row=1, col=1\n)\n\nfig.add_trace(\n    go.Bar(y=bmi_dist[\"count\"],x=bmi_dist[\"bmi_class\"]),\n    row=1, col=2\n)\n\nfig.add_trace(\n    go.Bar(y=cntry[\"count\"],x=cntry[\"country\"]),\n    row=2, col=1\n)\n\nfig.add_trace(\n    go.Bar(y=teams[\"count\"],x=teams[\"team\"]),\n    row=3, col=1\n)\n\nfig.add_trace(\n    go.Bar(y=coll[\"count\"],x=coll[\"college\"]),\n    row=4, col=1\n)\n\nfig.update_layout(title_text=\"Distribution of Categorical Variables\",showlegend=False,height=1400)","ffa67df3":"px.scatter_matrix(src[[\"age\",\"bmi\",\"height_cm\",\"weight_kg\",\"rating\",\"salary\"]],height=1500)","26fb4351":"cols = [\"age\",\"bmi\",\"height_cm\",\"weight_kg\",\"rating\",\"salary\"]\nfig = ff.create_annotated_heatmap(np.round(src[cols].corr().values,2),x=cols,y=cols)\nfig.show()","99cfe50a":"fig = make_subplots(rows=6, cols=1)\n\nfig.add_trace(\n    go.Box(x=src[\"team\"],y=src[\"age\"]),\n    row=1, col=1\n)\n\nfig.add_trace(\n    go.Box(x=src[\"team\"],y=src[\"bmi\"]),\n    row=2, col=1\n)\nfig.add_trace(\n    go.Box(x=src[\"team\"],y=src[\"height_cm\"]),\n    row=3, col=1\n)\n\n\nfig.add_trace(\n    go.Box(x=src[\"team\"],y=src[\"weight_kg\"]),\n    row=4, col=1\n)\n\nfig.add_trace(\n    go.Box(x=src[\"team\"],y=src[\"salary\"]),\n    row=5, col=1\n)\n\nfig.add_trace(\n    go.Box(x=src[\"team\"],y=src[\"rating\"]),\n    row=6, col=1\n)\n\n\nfig.update_yaxes(title_text=\"Age\", row=1, col=1)\nfig.update_yaxes(title_text=\"BMI\", row=2, col=1)\nfig.update_yaxes(title_text=\"Height\", row=3, col=1)\nfig.update_yaxes(title_text=\"Weight\", row=4, col=1)\nfig.update_yaxes(title_text=\"Salary\", row=5, col=1)\nfig.update_yaxes(title_text=\"Rating\", row=6, col=1)\n\nfig.update_layout(title_text=\"Relationship B\/w Team and Important Numerical Variables\",showlegend=False,height=2000)","670b486c":"fig = make_subplots(rows=6, cols=1)\n\nfig.add_trace(\n    go.Box(x=src[\"position\"],y=src[\"age\"]),\n    row=1, col=1\n)\n\nfig.add_trace(\n    go.Box(x=src[\"position\"],y=src[\"bmi\"]),\n    row=2, col=1\n)\nfig.add_trace(\n    go.Box(x=src[\"position\"],y=src[\"height_cm\"]),\n    row=3, col=1\n)\n\n\nfig.add_trace(\n    go.Box(x=src[\"position\"],y=src[\"weight_kg\"]),\n    row=4, col=1\n)\n\nfig.add_trace(\n    go.Box(x=src[\"position\"],y=src[\"salary\"]),\n    row=5, col=1\n)\n\nfig.add_trace(\n    go.Box(x=src[\"position\"],y=src[\"rating\"]),\n    row=6, col=1\n)\n\n\nfig.update_yaxes(title_text=\"Age\", row=1, col=1)\nfig.update_yaxes(title_text=\"BMI\", row=2, col=1)\nfig.update_yaxes(title_text=\"Height\", row=3, col=1)\nfig.update_yaxes(title_text=\"Weight\", row=4, col=1)\nfig.update_yaxes(title_text=\"Salary\", row=5, col=1)\nfig.update_yaxes(title_text=\"Rating\", row=6, col=1)\n\nfig.update_layout(title_text=\"Relationship B\/w Position and Important Numerical Variables\",showlegend=False,height=1700)","b5136a9f":"fig = make_subplots(rows=3, cols=2)\n\nfig.add_trace(\n    go.Box(x=src[\"bmi_class\"],y=src[\"age\"]),\n    row=1, col=1\n)\n\nfig.add_trace(\n    go.Box(x=src[\"bmi_class\"],y=src[\"bmi\"]),\n    row=1, col=2\n)\nfig.add_trace(\n    go.Box(x=src[\"bmi_class\"],y=src[\"height_cm\"]),\n    row=2, col=1\n)\n\n\nfig.add_trace(\n    go.Box(x=src[\"bmi_class\"],y=src[\"weight_kg\"]),\n    row=2, col=2\n)\n\nfig.add_trace(\n    go.Box(x=src[\"bmi_class\"],y=src[\"salary\"]),\n    row=3, col=1\n)\n\nfig.add_trace(\n    go.Box(x=src[\"bmi_class\"],y=src[\"rating\"]),\n    row=3, col=2\n)\n\n\nfig.update_yaxes(title_text=\"Age\", row=1, col=1)\nfig.update_yaxes(title_text=\"BMI\", row=1, col=2)\nfig.update_yaxes(title_text=\"Height\", row=2, col=1)\nfig.update_yaxes(title_text=\"Weight\", row=2, col=2)\nfig.update_yaxes(title_text=\"Salary\", row=3, col=1)\nfig.update_yaxes(title_text=\"Rating\", row=3, col=2)\n\nfig.update_layout(title_text=\"Relationship B\/w BMI Class and Important Numerical Variables\",showlegend=False,height=1700)","b5964b79":"src1 = src[[\"height_cm\",\"weight_kg\",\"bmi\",\"bmi_class\"]].copy()\nsrc1[\"bmi\"] = (src1[\"bmi\"]-src1[\"bmi\"].min()) \/ (src1[\"bmi\"].max()-src1[\"bmi\"].min())\npx.scatter(src1,x=\"height_cm\",y=\"weight_kg\",size=\"bmi\",color=\"bmi\",trendline=\"lowess\",title=\"Weight, Height, BMI\")","17fb9549":"pos_bmi = pd.crosstab(index=src[\"position\"],columns=src[\"bmi_class\"],normalize=\"index\")\npx.bar(pos_bmi,title=\"Position vs BMI Class\",labels={'value':\"% of players\"})","ac5fbebf":"cntry = pd.DataFrame(src[\"country\"].value_counts()).reset_index()\nless_cnt = cntry.loc[cntry[\"country\"]<(0.005*cntry[\"country\"].sum()),\"index\"]\n\ncnt_bmi = src[[\"country\",\"bmi_class\"]].copy()\ncnt_bmi.loc[cnt_bmi[\"country\"].isin(less_cnt),\"country\"] = \"Others\"\ncnt_bmi = pd.crosstab(index=cnt_bmi[\"country\"],columns=cnt_bmi[\"bmi_class\"],normalize=\"index\").copy()\npx.bar(cnt_bmi,title=\"Position vs BMI Class\",labels={'value':\"% of players\"})","59ee18a2":"<h3>A final look at the data before we proceed","a2d0f44a":"<h1>Data Interrogation - A Practical Approach<\/h1>\n\n<p>Interrogating your data is an important part of a data science project. It is estimated that 60-70% of time on a data science project is spent on cleaning and understanding the data. This notebook explains how to clean and get the most out of your data with Plotly visualization<\/p>\n\nEconomist  Ronald Coase said\n><h2>If you torture the data long enough, it will confess to anything\n","9de355e6":"<p>Let's look at the first few rows","08392835":"<p>After cleaning, the 'b_day' column looks good<\/p>\n<h3>Clean the 'height' column<\/h3>\n    \n<p>This column contains the height in both feet and meters which are separated by \"\/\". We'll split the column into two new columns \"height_ft\" and \"height_cm\".","91b705c2":"<h1>Let's quantify the above relationships using a Correlation Matrix","1da70564":"<h1>Observations from the above plots<\/h1>\n<ol>\n<li>Most of the players are in G & F position. G-F, F-G, and C-F have the lowest number of players<\/li>\n<li>Most of the players fall in the 'normal' BMI category with a few in 'overweight' and only 1 player is 'obese'<\/li>\n<li>Most of the players are from the US followed by Canada and Australia<\/li>\n<li>Most of the players are from Milwaukee Bucks and Golden State Warriors have the least number of players in this dataset. There are many missing values here<\/li>\n<li>Most of the players are from Kentucky and Duke colleges. There are also a good number of missing values here<\/li>\n<\/ol>\n<h1>A look at the relationships among numerical variables","4ecf9633":"<p>There are few columns like 'b_day', 'height', 'weight', 'salary' which have a wrong data type. We need to correct them.<\/p>\n\n<h3>How many unique values\/categories each column has?<\/h3>","eadbfb4d":"<h3>Clean the 'salary' column<\/h3>\n    \n<p>Let's check if all the entries in this column start with $","7d3a8ffa":"<h1>Observations from the above plots<\/h1>\n<ol>\n<li>Most of the players have the age between 22 and 32, lowest being 19 and the highest being 40.<\/li>\n<li>Most of the players have a rating between 72 and 79, lowest being 67 and highest being 97<\/li>\n<li>Most of the players have a salary between \\$50K and \\$6 million, lowest being \\$50K and highest being \\$40 million<\/li>\n<li>Most of the players have a BMI between 22 and 27, lowest being 20.3 and highest being 32.9<\/li>\n<li>Most of the players have a height (in cm) between 191 and 210, lowest being 175 and highest being 225<\/li>\n<li>Most of the players have a weight (in kg) between 86 and 110, lowest being 77 and highest being 131.5<\/li>\n<\/ol>\n<h1>Let's look at the distributions of few categorical variables","878a81d9":"In the above scatter plot, size and colour of the bubble is 'bmi'.\n\nLooking at the increase in the bubble size vertically (i.e. y-axis) shows weight is more influencing the BMI as we saw in the correlation matrix\n<h1>Looking at the relationships among few important categorical variables","90d7891d":"<h3>What is the percentage of missing values in each column, if any?","4c34338a":"<h3>Clean the 'weight' column<\/h3>\n    \n<p>This column contains the weight in both lbs and kg which are separated by \"\/\". We'll split the column into two new columns \"weight_lbs\" and \"weight_kg\".","b8178b02":"<p>As all the entries in the 'salary' column start with \\$ we'll remove the \\$ to make it a float data type","05e38e26":"<h3>Removing redundant columns like 'height', 'height_ft', 'weight', and 'weight_lbs'","64c7f738":"<h3>Let's check the structure of the data to ensure the cleaning is done","eb5031b1":"<h1>Observations from the above plots<\/h1>\n<ol>\n<li>Age is not influencing the BMI category<\/li>\n<li>It's obvious, BMI is highly influencing the BMI category<\/li>\n<li>Height and weight separately are not much influencing the BMI category<\/li>\n\n    \n","3ffc933c":"<h2>As we are done with the cleaning and feature engineering, let's start interrogating the data<\/h2>\n<h1>Let's look how the numerical variables are distributed","3add2b0d":"<h3>We can also calculate the age from the 'b_day' of the players","69b14aa7":"<h1>Data Cleaning<\/h1>\n<p>There are a few columns like 'b_day', 'height', 'weight', 'salary' which have a wrong data type. They must be cleaned.<\/p>\n\n<h3>Convert the 'b_day' column to datetime","a4f0b453":"<h1>Observations from the above plots<\/h1>\n<ol>\n<li>Age and salary have a moderate positive correlation.<\/li>\n<li>Rating and salary have a strong positive correlation.<\/li>\n<li>Weight and BMI have a moderate positive correlation.<\/li>\n<li>Weight and height have a strong positive correlation.<\/li>\n<li>Age and salary have a moderate positive correlation.<\/li>\n <\/ol>\n<h1>Looking at the relationships among few important categorical variables and numerical variables","afc36b36":"<h1>Visualizing the relationship between 'height, weight and BMI class using a scatter plot","60b41fdd":"<h3>What are the dimensions of the data?<\/h3>","26614551":"<h1>Imputing Missing Values<\/h1>\nThere are missing values in 'team' and 'college' columns.\n\nKnowing about the data collection method would help us to know why these values are missing and we can devise an optimal imputing strategy.\n\nImputing the missing Team and College with mode wouldn't be a right strategy as we find no patterns in the missing data, they are Missing at Random. This would also increase the influence of a single category (mode) which is already the most common category. It would be better if we mark them \"Not Known\".","15b2ada9":"<h1>Observations from the above plots<\/h1>\n<ol>\n<li>No strong relationship or variance is found in position by age. However, older players are in position C<\/li>\n<li>Strong relationship or variance is found in position by height. Tall players are in position C<\/li>\n<li>Moderate relationship or variance is found in position by weight. Heavy players are in position C<\/li>\n<li>No strong relationship or variance is found in position by salary. Few players in positions F and G earn more, while few in F-C earn the least<\/li>\n<\/ol>","25977784":"<h3>Is the data correctly imported? Checking the first few rows helps<\/h3>","071f774c":"<h2>Lets start the process of interrogating the data<\/h2>\n<h3>Importing the data","43ec7bd3":"<h1>Feature Engineering<\/h1>\n\n<h3>Let's see if we can create additional variables from the existing variables<\/h3>\n\nFirst we can create a <i><b>BMI = (weight in kg)\/(height in m)<sup>2<\/sup><\/b><\/i> variable from the height and weight of the players and also the BMI class.","dd227df4":"The above plot shows position 'F-G' has high percentage of players with a normal 'bmi_class', while position 'C' has high percentage of 'overweight' players.","b6aa0a8d":"<h1>Let's see the skewness of the above variables<\/h1>","83dc7e1a":"<h3>What are the columns of the data?<\/h3>","16216616":"The above plot shows players from France, Latvia, and Germany have a normal 'bmi_class'. Turkey has the highest percentage of overweight players.","f0e812b0":"<h3>What are the unique values in each column?<\/h3>\n\n<p>Excluding the Player Name column as it obviously has unique values","edf727ce":"<h3>Do all the columns have the right data types?","d98b2373":"<h3>In the above plots there are no strong relationships between team and other variables.","74787dfe":"<p>Let's look at the first few rows"}}