{"cell_type":{"e8ba09bb":"code","5c2cef74":"code","71f91f1f":"code","c4b0bd2d":"code","340d9ff9":"code","c9c2202b":"code","398ccf9f":"code","e5cd9ee2":"code","b68ba9c6":"code","5f97bc04":"code","f5cf6a3d":"code","0f9aa87d":"code","8e15250b":"code","6a418be3":"code","7b4f1db9":"code","de710fd2":"code","cf5cd8a5":"code","26cecb84":"code","fed722c6":"code","6ab18c89":"code","c3595992":"code","0659133d":"code","6c6e5f6c":"code","85a62260":"code","4c24e1a0":"code","0b5070ad":"code","739360fe":"code","720927fb":"code","6c485a62":"code","55c85810":"code","f6987382":"code","430e2daf":"code","bdac49d1":"code","5410307d":"code","bd93c52d":"code","01183082":"code","9ebd77ac":"markdown","25e7a83c":"markdown","9297cbbf":"markdown","3c3ecf7a":"markdown","b8a1c922":"markdown","82603bf5":"markdown","9fd76a06":"markdown","1f1d269a":"markdown","82771663":"markdown","6d7a832f":"markdown","d11d78c8":"markdown","522551a2":"markdown","3dca78aa":"markdown","4f6b1ae2":"markdown","22fd1fd1":"markdown","d8833cdd":"markdown","00d36e93":"markdown","0cd9b26d":"markdown","29749e7f":"markdown","3743fd49":"markdown","dc48f995":"markdown","03adc4af":"markdown","c3614997":"markdown","3f166859":"markdown","1d795764":"markdown","2811b93c":"markdown","de332be8":"markdown","7ba0c8a7":"markdown","eb1cdeaf":"markdown","f0fd61b7":"markdown","13b2fdc7":"markdown","8ffa91d4":"markdown","00e6e6f4":"markdown","8dbfbd78":"markdown","470b53dc":"markdown","32185bb1":"markdown","721ea934":"markdown","6b9f2d7d":"markdown","eec58f6f":"markdown"},"source":{"e8ba09bb":"! pip install -q dabl","5c2cef74":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom tqdm.notebook import tqdm\n\nimport plotly.express as px\nimport plotly.graph_objs as go\nimport plotly.figure_factory as ff\n\nimport dabl\n\nfrom sklearn.neural_network import MLPClassifier\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.svm import SVC\nfrom sklearn.gaussian_process import GaussianProcessClassifier\nfrom sklearn.gaussian_process.kernels import RBF\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import RandomForestClassifier, AdaBoostClassifier\nfrom sklearn.naive_bayes import GaussianNB\nfrom sklearn.discriminant_analysis import QuadraticDiscriminantAnalysis\nfrom sklearn.metrics import roc_auc_score\n\nplt.style.use(\"fivethirtyeight\")\norange_black = [\n    '#fdc029', '#df861d', '#FF6347', '#aa3d01', '#a30e15', '#800000', '#171820'\n]","71f91f1f":"# Let's read the data now\ndata = pd.read_csv(\"..\/input\/factors-affecting-campus-placement\/Placement_Data_Full_Class.csv\")\ndata.head()","c4b0bd2d":"data.describe()","340d9ff9":"data.isna().sum()","c9c2202b":"data['status'].value_counts()","398ccf9f":"# Fill 0 in place of NuLL values\ndata['salary'] = data['salary'].fillna(0)\ndata.head()","e5cd9ee2":"# Before we do viz, first drop \"sl_no\" column.\ndata = data.drop(['sl_no'], axis=1)","b68ba9c6":"targets = data['gender'].value_counts().tolist()\nvalues = list(dict(data['gender'].value_counts()).keys())\n\nfig = px.pie(\n    values=targets, \n    names=values,\n    title='Gender Value Pie-chart',\n)\nfig.show()","5f97bc04":"targets = data['status'].value_counts().tolist()\nvalues = list(dict(data['status'].value_counts()).keys())\n\nfig = px.pie(\n    values=targets, \n    names=values,\n    title='Status Value Distribution',\n    color_discrete_sequence=[\"cyan\", \"blue\"]\n    \n)\nfig.show()","f5cf6a3d":"targets = data['specialisation'].value_counts().tolist()\nvalues = list(dict(data['specialisation'].value_counts()).keys())\n\nfig = px.pie(\n    values=targets, \n    names=values,\n    title='Spec. Value Distribution',\n    color_discrete_sequence=orange_black\n    \n)\nfig.show()","0f9aa87d":"fig = px.histogram(\n    data, x=\"mba_p\",\n    marginal=\"violin\",\n    hover_data=data.columns,\n    color_discrete_sequence=[\"maroon\"],\n    title=f\"MBA Percent Distribution [\\u03BC : ~{data['mba_p'].mean():.2f}% | \\u03C3 : ~{data['mba_p'].std():.2f} %]\",\n)\n\nfig.show()","8e15250b":"fig = px.histogram(\n    data[data['salary']!=0], x=\"salary\",\n    marginal=\"violin\",\n    hover_data=data.columns,\n    color_discrete_sequence=[\"magenta\"],\n    title=f\"MBA Percent Distribution [\\u03BC : ~{data['mba_p'].mean():.2f}% | \\u03C3 : ~{data['mba_p'].std():.2f} %]\",\n)\n\nfig.show()","6a418be3":"targets = data['workex'].value_counts().tolist()\nvalues = list(dict(data['workex'].value_counts()).keys())\n\nfig = px.pie(\n    values=targets, \n    names=values,\n    title='Work Exp. Distribution',\n    color_discrete_sequence=[\"gray\", \"black\"]\n    \n)\nfig.show()","7b4f1db9":"fig = px.histogram(\n    data, x=\"etest_p\",\n    marginal=\"box\",\n    hover_data=data.columns,\n    color_discrete_sequence=[\"red\"],\n    title=f\"Performance in Employability Test [\\u03BC : ~{data['etest_p'].mean():.2f}% | \\u03C3 : ~{data['etest_p'].std():.2f} %]\",\n)\n\nfig.show()","de710fd2":"targets = data['degree_t'].value_counts().tolist()\nvalues = list(dict(data['degree_t'].value_counts()).keys())\n\nfig = px.pie(\n    values=targets, \n    names=values,\n    title=\"Candidate's Degree Type Chart\",\n)\nfig.show()","cf5cd8a5":"fig = px.histogram(\n    data, x=\"degree_p\",\n    marginal=\"box\",\n    hover_data=data.columns,\n    color_discrete_sequence=[\"green\"],\n    title=f\"Attained Degree Percentage [\\u03BC : ~{data['degree_p'].mean():.2f}% | \\u03C3 : ~{data['degree_p'].std():.2f} %]\",\n)\n\nfig.show()","26cecb84":"sci_avg_pcent = data[data['degree_t'] == 'Sci&Tech']['degree_p'].mean()\ncom_avg_pcent = data[data['degree_t'] == 'Comm&Mgmt']['degree_p'].mean()\nprint(f\"Average Percentage for Science & Technology Students is: {sci_avg_pcent:.2f}% while the average percentage of Commerce & Management Students is: {com_avg_pcent:.2f}%\")","fed722c6":"targets = data['hsc_s'].value_counts().tolist()\nvalues = list(dict(data['hsc_s'].value_counts()).keys())\n\nfig = px.pie(\n    values=targets, \n    names=values,\n    title=\"Higher Secondry Spec. Type Chart\",\n    color_discrete_sequence=[\"red\", \"blue\", \"green\"]\n)\nfig.show()","6ab18c89":"targets = data['hsc_b'].value_counts().tolist()\nvalues = list(dict(data['hsc_b'].value_counts()).keys())\n\nfig = px.pie(\n    values=targets,\n    names=values,\n    title=\"Higher Secondry Board Type Chart\",\n    color_discrete_sequence=[\"orange\", \"gold\"]\n)\nfig.show()","c3595992":"fig = px.histogram(\n    data, x=\"ssc_p\",\n    marginal=\"box\",\n    hover_data=data.columns,\n    color_discrete_sequence=[\"blue\"],\n    title=f\"Higher Secondry Percentage [\\u03BC : ~{data['ssc_p'].mean():.2f}% | \\u03C3 : ~{data['ssc_p'].std():.2f} %]\",\n)\n\nfig.show()","0659133d":"# A few utility functions to encode categorical data\n\ndef get_category_names(df, column_name):\n    '''\n    Column passed must be categorical\n    '''\n    unique_names_dict = dict(df[column_name].value_counts())\n    unique_names = list(unique_names_dict.keys())\n    \n    _length = len(unique_names)\n    return (_length, unique_names)\n\ndef replace_small_categorical_data(df, column_name, categorical_names):\n    \"\"\"\n    Categorical Encodes a data\n    \"\"\"\n    copy_frame = df.copy(deep=True)\n    \n    copy_frame[column_name].replace(categorical_names, [x for x in range(len(categorical_names))], inplace=True)\n    \n    return copy_frame","6c6e5f6c":"to_encode = [\"gender\", \"ssc_b\", \"hsc_b\", \"hsc_s\", \"degree_t\", \"workex\", \"specialisation\", \"status\"]\nencoded_data = data.copy(deep=True)\n\nfor col in to_encode:\n    _, current_category_names = get_category_names(encoded_data, col)\n    encoded_data = replace_small_categorical_data(encoded_data, col, current_category_names)","85a62260":"encoded_data.head()","4c24e1a0":"data.head()","0b5070ad":"sns.pairplot(data)","739360fe":"plt.figure(figsize=(15, 12))\nsns.heatmap(encoded_data.corr(), annot=True)","720927fb":"plt.rcParams['figure.figsize'] = (18, 6)\ndabl.plot(encoded_data, target_col = 'status')","6c485a62":"plt.rcParams['figure.figsize'] = (18, 6)\ndabl.plot(encoded_data, target_col = 'salary')","55c85810":"# First, let's split the data\nsplit_pcent = 0.10\nsplit = int(split_pcent * len(encoded_data))\nencoded_data = encoded_data.sample(frac=1).reset_index(drop=True)\n\nencoded_data = encoded_data.drop(['salary'], axis=1)\n\ntest = encoded_data[:split]\ntrain = encoded_data[split:]\n\ntrainY = train['status'].values\ntrainX = train.drop(['status'], axis=1)\n\ntestY = test['status'].values\ntestX = test.drop(['status'], axis=1)","f6987382":"# Mean Normalise the data\ntrainX = (trainX - trainX.mean()) \/ trainX.std()\ntestX = (testX - testX.mean()) \/ testX.std()","430e2daf":"# We are only using 11 Classifiers, you can use more if you wish.\nnames = [\"Logistic Regression\", \"Nearest Neighbors\", \"Linear SVM\", \"RBF SVM\", \"Gaussian Process\",\n         \"Decision Tree\", \"Random Forest\", \"Neural Net\", \"AdaBoost\",\n         \"Naive Bayes\", \"QDA\"]\n\nclassifiers = [\n    LogisticRegression(),\n    KNeighborsClassifier(3),\n    SVC(kernel=\"linear\", C=0.025),\n    SVC(gamma=2, C=1),\n    GaussianProcessClassifier(1.0 * RBF(1.0)),\n    DecisionTreeClassifier(max_depth=5),\n    RandomForestClassifier(max_depth=5, n_estimators=10, max_features=1),\n    MLPClassifier(alpha=1, max_iter=1000),\n    AdaBoostClassifier(),\n    GaussianNB(),\n    QuadraticDiscriminantAnalysis()]","bdac49d1":"# Let's do the classification and store the name of the classifier and it's test score into a dictionary\n\nclf_results = {}\n\nfor name, clf in tqdm(zip(names, classifiers)):\n    # Fit on the traning data\n    clf.fit(trainX, trainY)\n    \n    # Get the test time prediction\n    preds = clf.predict(testX)\n    \n    # Calculate Test ROC_AUC\n    score = roc_auc_score(testY, preds)\n    \n    # Store the results in a dictionary\n    clf_results[name] = score","5410307d":"# Sort the Model Accuracies based on the test score\nsort_clf = dict(sorted(clf_results.items(), key=lambda x: x[1], reverse=True))\n\n# Get the names and the corresponding scores\nclf_names = list(sort_clf.keys())[::-1]\nclf_scores = list(sort_clf.values())[::-1]","bd93c52d":"# Plot the per-model performance\nfig = px.bar(\n    x=clf_scores,\n    y=clf_names,\n    color=clf_names,\n    labels={'x':'Test ROC-AUC Score', 'y':'Models'},\n    title=f\"Model Performance [ Best Model: {clf_names[-1]} | Score: {clf_scores[-1]} ]\"\n)\n\nfig.show()","01183082":"clf_names","9ebd77ac":"Let's start the real Classification.\nI am going to compare all the different classification techniques and then plot their corresponding testing accuracies.","25e7a83c":"## Specialization Distribution\nLet's take a look at `Specialization` Column.","9297cbbf":"Let's Do some basic Descriptive Statitics on the data","3c3ecf7a":"## Candidate Degree Pie Chart\nNow we look at what proportion of candidates hold each degree.","b8a1c922":"## Higher Secondry Specialization Pie-chart\nNow we move on to Pie-chart of Higher Secondry Specialization type.","82603bf5":"Before we start modelling, we have to normalise and split our encoded dataset.","9fd76a06":"## Thank you!\n\nPlease correct me if I\u2019ve made any mistakes in EDA, modelling or maybe explaining some concept since I am a beginner and prone to making mistakes. \n\nPlease consider giving this notebook an upvote as it helps me work harder and publish more quality notebooks.","1f1d269a":"## Pairplot\nLet's draw some pair plot to see how different features affect each other.","82771663":"## Degree Percentage Distribution\nFollowing the degree type chart, let's look at the percentage achieved by students for their respective degrees.","6d7a832f":"## Work Experience Distribution\nNow analyize how work experience varies through dataset.","d11d78c8":"## Encode Categorical Data\nBefore I forget, let's encode categorical data so that the upcoming charts can be more understandable.","522551a2":"As you can see, more than `65%` of the Candidates have no work experience at all.","3dca78aa":"So there is about the same amount of candidates that have Marketing-Finance and Marketing-Human Resources Specializations.","4f6b1ae2":"## Higher Secondry Percentage\nFinally, let's look at Student Percentage in Higher Secondry Exams.","22fd1fd1":"# Introduction and Imports","d8833cdd":"Let's see what each column means:\n- sl_no: Serial Number\n- Gender\n- ssc_p: Secondary Education percentage - 10th Grade\n- ssc_b: Board of Education - Central\/ Others\n- hsc_p: Higher Secondary Education percentage- 12th Grade\n- hsc_b: Board of Education- Central\/ Others\n- hsc_s: Specialization in Higher Secondary Education\n- degree_p: Degree Percentage\n- degree_t: Under Graduation(Degree type)- Field of degree education\n- workex: Work Experience \n- etest_p: Employability test percentage (Conducted by college)\n- specialization: Post Graduation(MBA)- Specialization\n- mba_p: MBA percentage\n- status: Status of placement- Placed\/Not placed\n- salary: Salary offered by corporate to candidates","00d36e93":"There is a solid Data Imbalance in the dataset. We will have to deal with this later.","0cd9b26d":"## Candidate Status (Target Variable) Chart","29749e7f":"# EDA and Data Preprocessing","3743fd49":"Due to the presence of data imbalance, I am using roc-auc score instead of normal accuracy.","dc48f995":"Here we can see that about *67%* of candidates have a Degree in **Commerce and Management**, while *27%* of Candidates hold a degree in **Science and Technology**. Remaining *5%* hold a degree in other disciplines. ","03adc4af":"An average student has scored *72%* in Employability test, where the maximum scored was *98%* and the minimum scored was *50%*","c3614997":"## Salary Distribution\nThis one will be only for students that actually got placed, since the ones not getting placed will have a salary of `0` which would affect our plot.","3f166859":"## DABL Plot\nSince we have viz. most of the columns, let's end this EDA session by a DABL plot.","1d795764":"### Let's Start the Visualization now!","2811b93c":"From the above Distribution, we can note that only 1 student has more than *90%* in their degree. The average percentage score lies at *~67%* while the minimum score lies at *~50%*.","de332be8":"Mean Candidate Percentage in MBA lies around: `62%` with a standard deviation of `6%`","7ba0c8a7":"## Higher Secondry Board Type","eb1cdeaf":"Let's now first check for the NULL values and do something about them.\nAs we can see, the `salary` column is the only one having null values (67).","f0fd61b7":"## Candidate Gender Chart","13b2fdc7":"Let's also compare which degree type has more average percentage.","8ffa91d4":"The Null values are only for those candidates who haven't been placed, which is obvious. Now I will impute these to 0 just for sake of visualization. \n\nHowever, we aren't going to use the `salary` column since **it is not a cause of the `status` column, but rather an effect of `status` column**.","00e6e6f4":"As we can see, we can cross the **90%** accuracy mark.","8dbfbd78":"And then by setting `salary` as target column","470b53dc":"# Modelling","32185bb1":"## Performance in Employability Test\nNow we look at `etest_p` which is **Employability Test Percentage** scored by candidates.","721ea934":"## Correlation Heatmap\nLet's now see how all the features are correlated to each other.","6b9f2d7d":"First by setting `status` as target column","eec58f6f":"## MBA Percent Count Plot\nLet's draw up a Count Plot to see the trends of MBA Percent Distributions."}}