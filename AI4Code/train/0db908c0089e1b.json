{"cell_type":{"a008ecfa":"code","4c5f725b":"code","9242b93c":"code","8a90be7b":"code","6ff026ba":"code","be1be177":"code","c1cf547d":"code","bf023ebe":"code","acb3c8d2":"code","0ae1b453":"code","a44b1110":"code","5596449e":"code","eefda017":"code","7d4dd0fe":"code","c858f887":"code","3c6a937d":"code","107da111":"code","ba98e4b2":"code","7a4bda9d":"code","d6be10cf":"code","93add1b7":"code","014a72fd":"code","0bfbbf6b":"code","04cca829":"code","02e3fdcf":"code","3aff6721":"code","f4851ba5":"code","68850d27":"code","8e085761":"code","8a940ffa":"code","67a8d912":"code","03f6c3f5":"code","a2765017":"code","7a22a429":"code","01b3ddbd":"code","ff3a3028":"code","981bb51c":"code","c70a036d":"markdown","c841ab0e":"markdown","9e2e24a2":"markdown","6ffcb6d6":"markdown","a371f296":"markdown","48ff9f54":"markdown","36f3b468":"markdown","0d0ad859":"markdown","40e8a89c":"markdown","f50cfdb6":"markdown","f857428e":"markdown","ff38b919":"markdown","47ee0b81":"markdown","83a67f0a":"markdown","d1ef3341":"markdown","2d83c271":"markdown","ad2d96d7":"markdown","6c2fbf34":"markdown","04af1aec":"markdown","3adaff9b":"markdown"},"source":{"a008ecfa":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns \nimport matplotlib.pyplot as plt \nfrom sklearn.preprocessing import StandardScaler, normalize\nfrom sklearn.cluster import KMeans \nfrom sklearn.decomposition import PCA","4c5f725b":"df=pd.read_csv('..\/input\/ccdata\/CC GENERAL.csv')","9242b93c":"df.head()","8a90be7b":"df.info()","6ff026ba":"df.describe()","be1be177":"#Who's the customer that made the maximum purchaces\n\ndf.iloc[df['PURCHASES'].idxmax()]","c1cf547d":"sns.heatmap(df.isnull(),yticklabels=False,cbar=False,cmap='Blues')","bf023ebe":"df.isnull().sum()","acb3c8d2":"df['MINIMUM_PAYMENTS'].fillna(df['MINIMUM_PAYMENTS'].mean(),inplace=True)\n","0ae1b453":"df.isnull().sum()","a44b1110":"df['CREDIT_LIMIT'].fillna(df['CREDIT_LIMIT'].mean(),inplace=True)\n","5596449e":"sns.heatmap(df.isnull(),yticklabels=False,cbar=False,cmap='Blues')","eefda017":"#Check Duplicate values in the dataset\n\ndf.duplicated().sum()","7d4dd0fe":"df.drop('CUST_ID',axis=1,inplace=True)","c858f887":"df.head()","3c6a937d":"plt.figure(figsize=(10,50))\n\nfor i in range(len(df.columns)):\n    plt.subplot(17,1,i+1)\n    sns.distplot(df[df.columns[i]],kde_kws={\"color\":\"b\", \"lw\":3 ,'label':'KDE'},hist_kws={\"color\":'g'})\n    plt.title(df.columns[i])\n    \nplt.tight_layout()","107da111":"# Correaltion matrix between features\n\ncorrelations=df.corr()\nf,ax=plt.subplots(figsize=(20,10))\n\nsns.heatmap(correlations,annot=True)","ba98e4b2":"scaler=StandardScaler()\ndf_scaled=scaler.fit_transform(df)","7a4bda9d":"df_scaled.shape","d6be10cf":"df_scaled","93add1b7":"scores=[]\n\nrange_values=range(1,20)\nfor i in range_values:\n    kmean=KMeans(n_clusters=i)\n    kmean.fit(df_scaled)\n    scores.append(kmean.inertia_)\n    \nplt.plot(scores,'bx-')","014a72fd":"kmean= KMeans(7)\nkmean.fit(df_scaled)\n\n#  Output labels\nlabel=kmean.labels_","0bfbbf6b":"kmean.cluster_centers_.shape","04cca829":"cluster_centers=pd.DataFrame(data=kmean.cluster_centers_, columns= [df.columns])\ncluster_centers","02e3fdcf":"cluster_centers=scaler.inverse_transform(cluster_centers)\ncluster_centers=pd.DataFrame(data=cluster_centers,columns=[df.columns])\ncluster_centers\n\n","3aff6721":"label.shape","f4851ba5":"label.max()","68850d27":"label.min()","8e085761":"y=kmean.fit_predict(df_scaled)\ny","8a940ffa":"df_cluster=pd.concat([df,pd.DataFrame({'cluster':label})],axis=1)","67a8d912":"df_cluster","03f6c3f5":"# Plot histogram \n\nfor i in df.columns:\n    plt.figure(figsize=(35,5))\n    for j in range(7):\n        plt.subplot(1,7,j+1)\n        cluster=df_cluster[df_cluster['cluster']==j]\n        cluster[i].hist(bins=20)\n        \n    plt.show()","a2765017":"# dimensinality reduction \n\npca=PCA(n_components=2)\n\npcafit=pca.fit_transform(df_scaled)\npcafit\n","7a22a429":"pca_df = pd.DataFrame(data=pcafit,columns=['pca1','pca2'])\npca_df","01b3ddbd":"pca_df=pd.concat([pca_df,pd.DataFrame({'cluster':label})],axis=1)","ff3a3028":"pca_df","981bb51c":"plt.figure(figsize=(10,10))\nax=sns.scatterplot(x='pca1',y='pca2',hue='cluster',data=pca_df,palette=['red','green','blue','yellow','pink','gray','purple'])","c70a036d":"Vizualiztion ","c841ab0e":"## Visualization ","9e2e24a2":"K-means clustering is one of the simplest and popular unsupervised machine learning algorithms.\n\nTypically, unsupervised algorithms make inferences from datasets using only input vectors without referring to known, or labelled, outcomes.\n\n\n![image.png](attachment:ec7fef6d-c552-4404-81cf-c5d7648bd00d.png)","6ffcb6d6":"Replace the missing values of MINIMUM_PAYMENTS with the mean value ","a371f296":"## Apply the k-means","48ff9f54":"we can choose the number of clustrs 7 or 8","36f3b468":"We added the cluster label ","0d0ad859":"## Principal Component Analysis - PCA","40e8a89c":"In cluster analysis, the elbow method is a heuristic used in determining the number of clusters in a data set. \n\nThe method consists of plotting the explained variation as a function of the number of clusters, and picking the elbow of the curve as the number of clusters to use.\n\n![image.png](attachment:99209812-dc9d-483f-876d-371c5d4b4ddc.png)","f50cfdb6":"so, we have no duplicates ","f857428e":"Scale our data","ff38b919":"from this plot we can observe that 7 or 8 clusters seeming to perform the curve","47ee0b81":"## K-means algorithm","83a67f0a":"### How the K-means algorithm works\n\nTo process the learning data, the K-means algorithm in data mining starts with a first group of randomly selected centroids, which are used as the beginning points for every cluster, and then performs iterative (repetitive) calculations to optimize the positions of the centroids\nIt halts creating and optimizing clusters when either:\nThe centroids have stabilized \u2014 there is no change in their values because the clustering has been successful.\nThe defined number of iterations has been achieved.","d1ef3341":"No null values ","2d83c271":"the objective of K-means is simple: **group similar data points together and discover underlying patterns**. To achieve this objective, K-means looks for a fixed number (k) of clusters in a dataset.\u201d\n\n> A cluster refers to a collection of data points aggregated together because of certain similarities.","ad2d96d7":"## Elbow method ","6c2fbf34":"Step 1 : Understand problem statement ","04af1aec":"Now our values are in the same range. \nLet's apply k means algorithm","3adaff9b":"We are going to make a dataframe with the cluster centers"}}