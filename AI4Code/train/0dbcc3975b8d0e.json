{"cell_type":{"6e3316d3":"code","e92a6ec7":"code","b77e0d4f":"code","1880b70d":"code","1a84d099":"code","0e95bce2":"code","9be96661":"code","4db1a653":"code","785cd43d":"code","7deab0ae":"code","43508fb2":"code","dfe020a2":"code","f2f23e56":"code","fdbf466a":"code","967a4ec3":"code","c97e96fc":"code","f51db820":"code","d91c201f":"code","bcc51912":"code","9d1ec122":"code","7381c6ee":"code","8997bda0":"code","11ef4832":"code","fb2a894d":"code","71f8d998":"code","801f61a1":"code","6cbfc52a":"code","9698a441":"markdown","4d86fcfd":"markdown","a23a1202":"markdown","8b26462b":"markdown","2f27b85c":"markdown","79111818":"markdown","594c53d9":"markdown","15792a52":"markdown","571623e1":"markdown","ab8127f9":"markdown","9e67208d":"markdown","304b3439":"markdown","628e3396":"markdown","8afdfd4e":"markdown","967208b5":"markdown","c97ebb1e":"markdown","9339c23f":"markdown","08031821":"markdown","31591593":"markdown"},"source":{"6e3316d3":"#importing dataset \nimport seaborn as sns\nimport numpy as np\nimport datetime\nimport dateutil.relativedelta as relativedelta \nimport pandas as pd \nimport matplotlib.pyplot as plt\n%matplotlib inline\ndf = pd.read_csv('..\/input\/noshowappointments\/KaggleV2-May-2016.csv')\n","e92a6ec7":"#checking for the right values in age \n","b77e0d4f":"#checking duplicates\ndf.duplicated().sum()","1880b70d":"#The data dont have duplicates ","1a84d099":"df.isnull().sum()","0e95bce2":"#The data dont have missing values  ","9be96661":"df['Handcap'].max()\n#Handcap have 2,3,4 while it should have only 0's & 1's as stated on KAGGLE","4db1a653":"#removing values more than 1 \ndf = df[df['Handcap']<2]","785cd43d":"#Changing the Yes or No in No-show column to zero's and one's \ndf.rename(columns={'No-show':'No_show'},inplace=True)\ndf['No_show']=df['No_show'].apply(lambda x: 0 if x=='No' else 1)\n","7deab0ae":"#function that returns datafram of showing\/no_showing probabilties of certain column \ndef prob(column_name):\n    \n    return df.groupby(column_name)['No_show'].value_counts(normalize=True).unstack(column_name)\n\n#function that returns dataframe of probability not showing of certain column \n\ndef prob_not(column_name):\n    \n    return df.groupby(column_name)['No_show'].value_counts(normalize=True)[1][1]\n\ndef prob_not_not(column_name):\n    \n    return df.groupby(column_name)['No_show'].value_counts(normalize=True)[0][1]\n","43508fb2":"#Probabilty Not showing Vs Shwoing \nx = df['No_show'].value_counts()\nx_total = df['No_show'].value_counts().sum()\ny = x\/x_total\nplt.bar([1,2],x\/x_total,tick_label=['showing','not showing'])\n","dfe020a2":"print('{}% shows while {}% do not show'.format((y[0]*100).round(),(y[1]*100).round() ))","f2f23e56":"Female_probortion = prob('Gender')['F'][1]\nMale_probortion = prob('Gender')['M'][1]\nplt.bar([1,2],[Female_probortion,Male_probortion],tick_label=['Female','Male']);\nplt.xlabel('Gender')\ni = 'Gender'\nprob(i)","fdbf466a":"#histograms of all factors\ndf.hist(figsize=(15,15));\n    ","967a4ec3":"alcoholic_prob = prob_not('Alcoholism')\n# alcoholics stats \nprob('Alcoholism')","c97e96fc":"Hipertension_prob=prob_not('Hipertension')\n# Hipertension stats \nprob('Hipertension')","f51db820":"\n# Diabetes patients stats\nDiabetes_prob =prob_not('Diabetes')\nprob('Diabetes')\n","d91c201f":"# Handcap patients stats\nHandcap_prob =prob_not('Handcap')\nprob('Handcap')\n","bcc51912":"# SMS_recieved patients stats\nSMS_received_prob =prob_not('SMS_received')\nprob('SMS_received')\n","9d1ec122":"\n# scholarships patients stats\nScholarship_prob =prob_not('Scholarship')\nprob('Scholarship')\n","7381c6ee":"#each factor probability\nx_axis_factors = [Scholarship_prob,SMS_received_prob,Diabetes_prob,Hipertension_prob,Handcap_prob,alcoholic_prob]\n#tick labels \nlabels_factors = ['Scholarship','SMS received','Diabetes patients','Hipertension patients','Handcaped patients','alcholic patients'] \n\nplt.figure(figsize=(20, 8))  # width:20, height:3\nplt.bar(range(len(x_axis_factors)), x_axis_factors, align='center', width=0.5,tick_label=labels_factors);\nplt.ylabel('Probabilty of not showing',fontsize=15);\nx_axis_factors","8997bda0":"#Plotting the factors Vs possibilty when the factor is 1 vs 0 \nx_axis_factors_main = [Scholarship_prob,SMS_received_prob,Diabetes_prob,Hipertension_prob,Handcap_prob,alcoholic_prob]\nx_axis_factors_new = [prob_not_not(\"Scholarship\"),prob_not_not('SMS_received'),prob_not_not('Diabetes'),prob_not_not('Hipertension'),prob_not_not('Handcap'),prob_not_not('Alcoholism')]\nlabels_factors = ['Scholarship','SMS received','Diabetes patients','Hipertension patients','Handcaped patients','alcholic patients'] \n\nNew_factors=list(zip(x_axis_factors_main,x_axis_factors))\n\nx = np.arange(len(x_axis_factors_main))  # the label locations\nwidth = 0.1  # the width of the bars\n\nfig, ax = plt.subplots()\nrects1 = ax.bar(x - 0.1, x_axis_factors_main, width , color = 'green',label='Have')\nrects2 = ax.bar(x + 0.1, x_axis_factors_new, width, color = 'r', label='Dont have')\n\n\n\nax.set_ylabel('Probabilty of not shwoing',fontsize=14)\n\nax.set_xticks(x)\nax.set_xticklabels(labels_factors)\nax.legend()\n\nax.set_facecolor('lightgray')\n\nfig.tight_layout()\nfig.autofmt_xdate()\n\nfig.set_size_inches(14, 10)\nplt.xticks(fontsize=14)\n\n\nplt.show()","11ef4832":"#removing the missing values in age which are signed as -1 \nAge_df = df.query('Age >=0 & No_show==1').copy()\nbins= [0,2,4,13,20,50,70,90,110]\n#Not showing \nAge_values_not_showing = pd.cut(Age_df['Age'],bins=bins).value_counts()\nAge_values_total = df.query('Age >=0').copy()\nAge_values_total = pd.cut(Age_values_total['Age'],bins=bins).value_counts()\nAge_values_prob = Age_values_not_showing \/ Age_values_total;\n","fb2a894d":"#plotting age vs probabilty of not showing\nAge_values_prob.sort_index().plot(kind='bar')\nplt.xlabel('Age')\nplt.ylabel('Probabilty of not showing')","71f8d998":"Not_s_neigh = df.query('No_show == 1')['Neighbourhood'].value_counts()\n\n#Number of total handcaped patients\ntotal_neighbour = df['Neighbourhood'].value_counts()\ntotal_neighbour\n\nNeigh_prob = Not_s_neigh \/ total_neighbour\nNeigh_prob\nNeigh_prob_edited = Neigh_prob[(Neigh_prob>=0.24) | (Neigh_prob<0.14)  ] \n\n","801f61a1":"#plotting the possibilty of not showing Vs neighbourhood\nx_axis_factors = Neigh_prob_edited\nlabels_factors = Neigh_prob_edited.index\n\n\nplt.figure(figsize=(20, 8))  # width:20, height:8\nplt.bar(range(len(Neigh_prob_edited)), Neigh_prob_edited, align='center', width=0.3,tick_label=labels_factors);\nplt.ylabel('Probabilty of not showing',fontsize=15);\nNeigh_prob_edited.index\n","6cbfc52a":"#calculating the day difference\ndf_no_show = df.query('No_show ==1').copy()\ndf_no_show['ScheduledDay'] = pd.to_datetime(df_no_show['ScheduledDay'])\ndf_no_show['AppointmentDay'] = pd.to_datetime(df_no_show['AppointmentDay'])\ndf_no_show['diff_days'] = df_no_show['AppointmentDay'].dt.date - df_no_show['ScheduledDay'].dt.date\ndf_no_show['diff_days']=df_no_show['diff_days'].dt.days\nx=df_no_show['diff_days'].value_counts(normalize=True)\n\n\n# Add title and format it\nplt.title('Days differnce Vs Not showing possibilty'.title(),\n               fontsize = 14, weight = \"bold\")\n# Add x label and format it\nplt.xlabel('Number of days between Scheduled Vs Appointment day'.title(),\n               fontsize = 10, weight = \"bold\")\n# Add y label and format it\nplt.ylabel('Possibilty not showing'.title(),\n               fontsize = 10, weight = \"bold\")\n\n\nplt.bar(np.arange(len(x)),x);\nplt.figure(figsize = (20, 25))\n#df_no_show['diff_days'].value_counts(normalize=True)","9698a441":"### Data Cleaning ","4d86fcfd":"<a id='intro'><\/a>\n## Introduction\n\n> No show appointments Data shows what would make the paients do not show at their appointments and what factors affect that the most. <br>\nData Definition:\n\n>PatientId: Identification of a patient that is unique for each person.<br>\nAppointmentID: Identification of each appointment.<br>\nGender: Male or Female.<br>\nAppointmentDay: The day of the actual appointment, when they have to visit the doctor.<br>\nScheduledDay: The day someone called or registered the appointment, this is before appointment of course.<br>\nAge: How old is the patient.<br>\nNeighbourhood: Where the appointment takes place.<br>\nScholarship: 1 or 0.(this is aprogram in Brazil to support poor people with their cost of living)<br>\nHipertension: 1 or 0.<br>\nDiabetes: 1 or 0.<br>\nAlcoholism: 1 or 0.<br>\nHandcap: 1 or 0.<br>\nSMS_received: 1 or more messages sent to the patient.<br>\nNo-show: \"Yes\" or \"No\". (Will be changed to 0's and 1's).<br>\n\n#### Important Questions  \n> Do some diseases affects going to your appointment ?\n>\n> Do the time between making the appointment and showing at the appointment have an effect ?\n>\n> Does the location of the hospital have an effect on showing at the appointment ?\n>\n> is enrolling in Brasilian welfare program makes a difference ? \n","a23a1202":">Teenagers(13->20) have the highest possiblity of not showing by 25%","8b26462b":">Gender dosen't matter ","2f27b85c":"\n\n# Project: No show appointments\n\n## Table of Contents\n<ul>\n<li><a href=\"#intro\">Introduction<\/a><\/li>\n<li><a href=\"#wrangling\">Data Wrangling<\/a><\/li>\n<li><a href=\"#eda\">Exploratory Data Analysis<\/a><\/li>\n<li><a href=\"#conclusions\">Conclusions<\/a><\/li>\n<\/ul>","79111818":">Patients between 4 to 20 years old are more likely not to show at the appointment while the patients between 50 to 90 years old most probably will show at the appointment ","594c53d9":"> All the factors really matter if you have them or not except the alcholism ","15792a52":"> Neighbourhood has a great effect on wether the patient will show at the appointment or no ","571623e1":"<a id='eda'><\/a>\n## Exploratory Data Analysis\n\n\n\n### Research Question 1, What factors really matter ?","ab8127f9":">The time before the appointment","9e67208d":">It is clear that as we get far from the schedueled day, the patient probabilty that he will show up increases","304b3439":"> Do Gender matters?","628e3396":">What factors really matters ? ","8afdfd4e":"<a id='wrangling'><\/a>\n## Data Wrangling\n","967208b5":"> The patients who are enrolled in  Brasilian welfareprogram Bolsa Fam\u00edlia and the Patients who are notified with SMS have higher possibilty of not appearing at the appointment while people who are suffering from permemnant illnes seems to keep their appointment with probabilty nearly equal healthy people which wasn't excpected","c97ebb1e":">SMS and Scholarship seems critical <br>\n>And data on young patients more than old patients","9339c23f":"### Limitations :\n>**Low quality of data**:<br>\nThe data musn't have any mistakes as it is hospital data, but unfortunately :<br>\nAge was missed up there were patients with -1 age <br>\nHandcap column contained other values than 0's and 1's<br>\n","08031821":"<a id='conclusions'><\/a>\n## Conclusions\n\n> **Gender** : Males and females have the same probabilty of not showing <br>\n\n>**A lot of data is taken from the days after the schedueled day** <br>\n\n>**Number of young patients is more than old which is odd** <br>\n\n>**illness like diabetes don't change wether the patient will show up or no**<br>\n\n>**if someone missed the schedueld day  most probably they wont show up**<br>\n\n>**'ILHAS OCE\u00c2NICAS DE TRINDADE' neighbourhood patients will probably not show at the appointment (100% probabilty of not showing) but only 2 patients from there so it dosen't count **<br>\n\n>**'ILHA DO BOI' neighbourhood patients will probably show up (%8 won't show up)**<br>\n\n>**The patients who are enrolled in brazilian welfare program probabilty of not shwoing increase (23.7%)**<br>\n\n>**Patients who are sent a confirmatory message probabilty that they won't show increase -which is odd- (27.5% of patients who are sent sms won't show for the appointment)**<br>\n\n>**As days pass probabilty patient will show up increase (The curve is sharply right skewed) which was excpected beacause patient most definetly will show up one day even after 100 days**\n\n","31591593":"##### The data consists of \n>1- The diseases the patient may have <br>\n>2- The Location of the hospital and wether the patient have Brasilian welfare program<br>\n>3- The time of <br> \n>   -the appointment<br> \n>   -making the appointment <br>\n>4- wether he showed for the appointment or not "}}