{"cell_type":{"14013d3c":"code","66a652cf":"code","1f186b1f":"code","3523bfde":"code","33f13fa6":"code","2aebba3f":"code","69ea7ec0":"code","de2d30c1":"code","0be84118":"code","bd0fd5d5":"code","df9ce9cf":"code","cb0827c3":"code","48f80bd0":"code","33fadb1d":"code","b801f4d8":"code","5ff4a6e6":"code","359bae0a":"code","405a2052":"code","af57531d":"code","52f79008":"code","e6809b7f":"code","470e46df":"code","738869f6":"code","b96db5a2":"code","19b7a3f2":"code","11cc70dc":"code","b00ff9be":"code","6f2b485c":"markdown","24334518":"markdown","e19c1a94":"markdown","9353bde7":"markdown","44889bd5":"markdown","84a0e41f":"markdown","5166e5f0":"markdown","b979ee46":"markdown","30953491":"markdown","dfc46538":"markdown","d7106f13":"markdown","daeb9925":"markdown","cef70815":"markdown","0bfd5748":"markdown","2a7a57d1":"markdown","881a4417":"markdown","221ed8ed":"markdown","7e8914d9":"markdown","d9827840":"markdown","eae66340":"markdown","27e5bfab":"markdown"},"source":{"14013d3c":"import numpy as np \nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","66a652cf":"df = pd.read_csv(\"..\/input\/churn-modelling\/Churn_Modelling.csv\")\ndf","1f186b1f":"df=df.iloc[:,3:]\ndf.head()\n","3523bfde":"df.shape","33f13fa6":"df.describe()","2aebba3f":"df.info()","69ea7ec0":"df.isnull().sum()\n","de2d30c1":"sns.heatmap(df.isnull(),cmap=\"viridis\")\n","0be84118":"fig , ax =plt.subplots(2,2)\nax = ax.flatten()\nfig.set_size_inches(14, 10)\nsns.distplot(df.EstimatedSalary,color='#2D008E',ax=ax[0])\nsns.distplot(df.CreditScore,color='#F9971A',ax=ax[1])\nsns.distplot(df.Balance,color='#242852',ax=ax[2])\nsns.distplot(df.Age,color='#242852',ax=ax[3])\n\n","bd0fd5d5":"upper_limit_CreditScore= df[\"CreditScore\"].mean() + 1.5*df[\"CreditScore\"].std()\nlower_limit_CreditScore = df[\"CreditScore\"].mean() - 1.5*df[\"CreditScore\"].std()\nupper_limit_CreditScore , lower_limit_CreditScore","df9ce9cf":"upper_limit_EstimatedSalary= df[\"EstimatedSalary\"].mean() + 1*df[\"EstimatedSalary\"].std()\nlower_limit_EstimatedSalary= df[\"EstimatedSalary\"].mean() - 1.5*df[\"EstimatedSalary\"].std()\nupper_limit_EstimatedSalary , lower_limit_EstimatedSalary","cb0827c3":"df1=df[(df[\"CreditScore\"]<upper_limit_CreditScore)&(df[\"CreditScore\"]>lower_limit_CreditScore)]\ndf2=df1[(df1[\"EstimatedSalary\"]<upper_limit_EstimatedSalary)&(df1[\"EstimatedSalary\"]>lower_limit_EstimatedSalary)]\ndf1.shape,df2.shape","48f80bd0":"fig_1 , ax_1 =plt.subplots(1,2)\nax_1 = ax_1.flatten()\nfig_1.set_size_inches(14, 6)\nsns.distplot(df2.EstimatedSalary,color='#2D008E',ax=ax_1[0])\nsns.distplot(df2.CreditScore,color='#F9971A',ax=ax_1[1])","33fadb1d":"fig_3 , ax_3 =plt.subplots(2,2)\nax_3 = ax_3.flatten()\nfig_3.set_size_inches(16, 8)\nsns.violinplot(y=df2.CreditScore,x=df2.Tenure,palette=\"mako\",ax=ax_3[0])\nsns.barplot(y=\"CreditScore\",x=\"Tenure\",data=df2,palette=\"mako\",ci=\"sd\",ax=ax_3[1])\nsns.violinplot(y=df2.CreditScore,x=df2.NumOfProducts,palette=\"rocket\",ax=ax_3[2]) \nsns.barplot(y=\"CreditScore\",x=\"NumOfProducts\",data=df2,palette=\"rocket\",ci=\"sd\",ax=ax_3[3])\n","b801f4d8":"df2_churn_1=df2[df2[\"Exited\"]==1]\ndf2_churn_0=df2[df2[\"Exited\"]==0]\ndf2_churn_1.shape,df2_churn_0.shape","5ff4a6e6":"df3 = df2.convert_dtypes()\ndf3[\"Gender\"] = np.where(df3[\"Gender\"]=='Female',0,1)","359bae0a":"x=df3.drop([\"Exited\",\"Geography\"],axis=1)\ny=df3[\"Exited\"]\ny=y.astype('int')\nfrom sklearn.model_selection import train_test_split \nx_train,x_test,y_train,y_test=train_test_split(x,y,test_size=0.2)\nx_train.shape,x_test.shape,y_train.shape","405a2052":"from sklearn.preprocessing import StandardScaler\nsc = StandardScaler()\nx_train=sc.fit_transform(x_train)\nx_test=sc.fit_transform(x_test)\n","af57531d":"from sklearn.linear_model import  LogisticRegression\nlr = LogisticRegression()\nmodel_logic = lr.fit(x_train,y_train)","52f79008":"from sklearn.ensemble import RandomForestClassifier\nrfc = RandomForestClassifier()\nmodel_rfc = rfc.fit(x_train,y_train)\n","e6809b7f":"from sklearn.tree import DecisionTreeClassifier\ndtc = DecisionTreeClassifier(criterion='entropy',max_depth=300)\nmodel_dtc = dtc.fit(x_train,y_train)","470e46df":"from sklearn.svm import SVC\nsvc = SVC()\nmodel_svc = svc.fit(x_train,y_train)\n","738869f6":"from sklearn.model_selection import cross_val_score\n\nscores_logic = cross_val_score(model_logic, x, y, cv=4)\nscores_rfc = cross_val_score(model_rfc, x, y, cv=4)\nscores_dtc = cross_val_score(model_dtc, x, y, cv=4)\nscores_svc = cross_val_score(model_svc, x, y, cv=4)\ndata={'model':['logistic','random_forest','decision_tree','SVM'],\n     'accuracy':[scores_logic,scores_rfc,scores_dtc,scores_svc]}\naccuracy_df = pd.DataFrame(data, columns = ['model', 'accuracy'])\naccuracy_df","b96db5a2":"accuracy_df.accuracy","19b7a3f2":"y_predict = model_rfc.predict(x_test)\nfrom sklearn.metrics import confusion_matrix\ncm = confusion_matrix(y_test,y_predict)\ncm\n","11cc70dc":"plt.figure(figsize=(10,7))\nsns.heatmap(cm,annot=True)\nplt.xlabel('Predict')\nplt.ylabel('Truth')\n","b00ff9be":"credit_score = 608\ngender = 1 # which is male\nage = 55\ntenure = 6\nbalance = 83000\nnum_of_buy_product=12\nhas_a_creditcard = 1\nis_active_member=0\nsalary=42000\n\n\narr=np.array([credit_score,gender,age,tenure,balance,num_of_buy_product,has_a_creditcard,is_active_member,salary])\narr_res=arr.reshape(1,-1)\na=model_rfc.predict(arr_res)\na","6f2b485c":" #the accuracy results of show that random forest gain highest percentage which is 85%. ","24334518":"# Now i'm using histogram to check the flow of data and also check the standard deviation of the data","e19c1a94":"# Standarized the train and test data to increase the accuracy","9353bde7":"# Now usin upper and lower limits of stds. i am removing outliers and create new data frame.****","44889bd5":"seperate churn 0 values and 1 to know the ratio","84a0e41f":"# creating a x dataset and y labels to train a model","5166e5f0":"# Remove outlier by using standard deviation\n \n ****upper limit and Lower limit of standard deviation in CreditScore \n","b979ee46":"# Check the accuracy of all models by using Cross Validation Classifier","30953491":"**Upper limit and Lower limit standard deviation of EstimatedSalary****","dfc46538":"# Labeling the gender column by 0 and 1","d7106f13":"**#This heat map shows that the model predict  1159 times 0 and the actual value is also 0******","daeb9925":"# Using heat map to plot confusion matrix. so that we can better understand the results","cef70815":"# Using Heat map to check the null values in dataset\nThis heat map shows that there is no null value. The dataframe is already clean ","0bfd5748":"# Now again using histogram\nto check the flow of new data frame df2","2a7a57d1":"# Using Confusion matrics to check the performance of random forest model","881a4417":"#  Removing unimport columns","221ed8ed":"# Apply support vector Machine","7e8914d9":"# Apply Random Forest Classifier","d9827840":"# Apply Logistic Regression model","eae66340":"# Apply Decision Tree Classifier","27e5bfab":"# Now i'm chect manually the result of my model \n"}}