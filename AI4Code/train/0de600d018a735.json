{"cell_type":{"6bf88b67":"code","aae7c53d":"code","cf9b0148":"code","84e87bd9":"code","05fbc7cc":"code","ad6eee90":"code","c2dfe586":"code","d16ea591":"code","2b5668b7":"code","7255676c":"code","7c0ce093":"code","b5c0c4eb":"code","4531f0fd":"code","e3d3dd54":"code","aef80678":"code","41e56dbc":"code","c96beb58":"code","cdd6799a":"code","7e6e4bf0":"code","7cea1764":"code","8044af43":"code","694ba515":"code","a5d36c93":"code","288725b9":"code","afcb3ecb":"code","42355daa":"code","02278e0e":"code","0bc5e8a1":"code","add9217f":"code","d1c0ed1e":"code","709efc21":"code","4849fcf4":"code","a69ebb25":"code","d075828f":"markdown","a80a5b22":"markdown"},"source":{"6bf88b67":"import pandas as pd\nimport numpy as np\n\ndf = pd.read_csv(\"..\/input\/80-cereals\/cereal.csv\").copy()","aae7c53d":"df.head()","cf9b0148":"df.name.unique()","84e87bd9":"df.isnull().sum()","05fbc7cc":"df.describe().T","ad6eee90":"dummies = df['name'].str.get_dummies()","c2dfe586":"dummies","d16ea591":"df = pd.concat([df,dummies],axis=1)","2b5668b7":"df.head()","7255676c":"df=df.drop(['name'],axis=1)","7c0ce093":"dummies_mfr = df['mfr'].str.get_dummies()","b5c0c4eb":"df=pd.concat([df,dummies_mfr],axis=1)","4531f0fd":"df = df.drop(['mfr'],axis=1)","e3d3dd54":"df.head()","aef80678":"dummies_c = df['type'].str.get_dummies()","41e56dbc":"df = pd.concat([df,dummies_c],axis=1)","c96beb58":"df = df.drop(['type'],axis=1)","cdd6799a":"df.head()","7e6e4bf0":"from sklearn.model_selection import train_test_split","7cea1764":"y = df.rating\nx = df.drop('rating',axis=1)","8044af43":"X_train,X_test,y_train,y_test=train_test_split(x,y,test_size=0.33,random_state=42)","694ba515":"from sklearn.ensemble import GradientBoostingRegressor\nfrom sklearn.metrics import mean_squared_error","a5d36c93":"gbm_model = GradientBoostingRegressor()\ngbm_model.fit(X_train, y_train)\n","288725b9":"y_pred = gbm_model.predict(X_test)\nnp.sqrt(mean_squared_error(y_test, y_pred))","afcb3ecb":"gbm_model.score(X_test,y_test)","42355daa":"gbm_params = {\n    'learning_rate': [0.001, 0.01, 0.1, 0.2],\n    'max_depth': [3, 5, 8,50,100],\n    'n_estimators': [200, 500, 1000, 2000],\n    'subsample': [1,0.5,0.75],\n}","02278e0e":"from sklearn.model_selection import train_test_split, GridSearchCV,cross_val_score","0bc5e8a1":"gbm = GradientBoostingRegressor()\ngbm_cv_model = GridSearchCV(gbm, gbm_params, cv = 10, n_jobs = -1, verbose = 2)\ngbm_cv_model.fit(X_train, y_train)","add9217f":"gbm_cv_model.best_params_","d1c0ed1e":"gbm_tuned = GradientBoostingRegressor(learning_rate = 0.1,  \n                                      max_depth = 50, \n                                      n_estimators = 1000, \n                                      subsample = 0.5)\n\ngbm_tuned = gbm_tuned.fit(X_train,y_train)","709efc21":"y_pred = gbm_tuned.predict(X_test)\nnp.sqrt(mean_squared_error(y_test, y_pred))","4849fcf4":"from sklearn.metrics import accuracy_score","a69ebb25":"gbm_tuned.score(X_test, y_test)#test accuracy score","d075828f":"PREDICTION","a80a5b22":"MODEL TUNING"}}