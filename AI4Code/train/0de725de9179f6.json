{"cell_type":{"01cc8517":"code","9e85b969":"code","c1cd3958":"code","e2004afd":"code","c5b87037":"code","09bc1c96":"code","af7cd87a":"code","ee05a9b9":"code","47c2e503":"code","27dc0119":"code","f77cf608":"code","bdee1fd1":"code","cd2f40a4":"code","52580dbc":"code","220b47a4":"code","a6d9d23b":"code","5b77848d":"code","a94af35a":"code","0ec25452":"code","fe289af7":"code","aafe5f69":"code","06332cf0":"code","ede5777d":"code","8a220825":"code","454f4e19":"code","dc89b574":"code","dcf65c33":"code","7158811f":"code","2e006b91":"code","febb0aa6":"code","7704e22a":"code","ea8f6e94":"code","50d970c0":"code","bc968b6c":"code","c84791b4":"code","bb0f362a":"code","274c2cba":"markdown","b350bd1e":"markdown","61270c69":"markdown","50ed0955":"markdown","23111118":"markdown","93628f1d":"markdown","19bb8b42":"markdown","d589db5d":"markdown","745c106e":"markdown","feef39a4":"markdown","d2111234":"markdown","67505138":"markdown","7cd9e444":"markdown","c90dfef7":"markdown","32fe9e8e":"markdown","573b7ef5":"markdown","57887caa":"markdown","950d3f5f":"markdown","4616e7c4":"markdown","ba8b2f4e":"markdown","b242bd61":"markdown","5ffea1b2":"markdown","a2ae738e":"markdown","45c07b73":"markdown","1a5bbc8d":"markdown","c49716da":"markdown","f4f3e8a1":"markdown","8293c228":"markdown"},"source":{"01cc8517":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport plotly.io as pio\nimport plotly.express as px\nimport missingno as msno\nimport pandas_profiling\nplt.style.use(\"fivethirtyeight\")\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","9e85b969":"df = pd.read_csv(\"\/kaggle\/input\/health-insurance-cross-sell-prediction\/train.csv\")\ndf.head()","c1cd3958":"df.info()","e2004afd":"n = msno.bar(df,color=\"gold\")","c5b87037":"sns.countplot(\"Gender\",data=df)\nplt.show()","09bc1c96":"plt.style.use(\"fivethirtyeight\")\nsns.countplot(x = \"Gender\",data = df,hue = \"Response\")\nplt.show()","af7cd87a":"facet = sns.FacetGrid(df,hue=\"Response\",aspect = 4)\nfacet.map(sns.kdeplot,\"Age\",shade = True)\nfacet.set(xlim = (0,df[\"Age\"].max()))\nfacet.add_legend()\nplt.show()","ee05a9b9":"sns.countplot(\"Driving_License\",data = df,hue = \"Response\")\nplt.show()","47c2e503":"df[\"Response\"].value_counts()","27dc0119":"sns.countplot(x = \"Previously_Insured\",data = df,hue = \"Response\")\nplt.show()","f77cf608":"df.groupby(\"Response\")[\"Previously_Insured\"].value_counts()","bdee1fd1":"plt.figure(figsize=(12,6))\nplt.subplot(1,2,1)\nsns.countplot(\"Vehicle_Age\", data = df,hue = \"Response\")\nplt.xlabel(\"Fig: i\",color=\"coral\")\nplt.subplot(1,2,2)\nplt.rcParams['figure.figsize']=(6,8)\ncolor = ['yellowgreen','gold',\"lightskyblue\"]\ndf['Vehicle_Age'].value_counts().plot.pie(y=\"Vehicle_Age\",colors=color,explode=(0.02,0,0.3),startangle=50,shadow=True,autopct=\"%0.1f%%\")\nplt.axis('on')\nplt.xlabel(\"Fig: ii\",color=\"coral\")\nplt.show()","cd2f40a4":"plt.figure(figsize=(8,6))\nsns.countplot(\"Vehicle_Damage\", data = df,hue = \"Response\")\nplt.show()","52580dbc":"facet = sns.FacetGrid(df,hue=\"Response\",aspect = 4)\nfacet.map(sns.kdeplot,\"Annual_Premium\",shade = True)\nfacet.set(xlim = (0,df[\"Annual_Premium\"].max()))\nfacet.add_legend()\nplt.show()","220b47a4":"facet = sns.FacetGrid(df,hue=\"Response\",aspect = 4)\nfacet.map(sns.kdeplot,\"Vintage\",shade = True)\nfacet.set(xlim = (0,df[\"Vintage\"].max()))\nfacet.add_legend()\nplt.show()","a6d9d23b":"sns.catplot(x=\"Vehicle_Age\", hue=\"Vehicle_Damage\", col=\"Response\",\n                data=df, kind=\"count\",\n                height=6, aspect=.7)\nplt.show()","5b77848d":"sns.catplot(x=\"Vehicle_Damage\", hue=\"Previously_Insured\", col=\"Response\",\n                data=df, kind=\"count\",\n                height=6, aspect=.7)\nplt.show()","a94af35a":"df.drop([\"id\",\"Region_Code\",\"Policy_Sales_Channel\"],axis = 1,inplace=True)\ndf.head()","0ec25452":"from sklearn.preprocessing import LabelEncoder\nle = LabelEncoder()\ndf[\"Vehicle_Damage\"] = le.fit_transform(df[\"Vehicle_Damage\"])","fe289af7":"df = pd.get_dummies(df,drop_first=True)\ndf.head()","aafe5f69":"x = df.drop(\"Response\",axis=1)\ny = df[\"Response\"]","06332cf0":"from sklearn.ensemble import ExtraTreesClassifier\nmodel = ExtraTreesClassifier()\nmodel.fit(x,y)","ede5777d":"plt.figure(figsize=(8,6))\nimportant_features = pd.Series(model.feature_importances_,index = x.columns)\nimportant_features.nlargest(7).plot(kind = \"bar\")\nplt.show()","8a220825":"from sklearn.model_selection import train_test_split\n\nx_train,x_test,y_train,y_test = train_test_split(x,y,test_size=0.2,random_state=0)","454f4e19":"from sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import RandomForestClassifier\nfrom lightgbm import LGBMClassifier\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.neighbors import KNeighborsClassifier\n","dc89b574":"dt_clf = DecisionTreeClassifier(criterion='entropy',max_depth = 100,random_state=0)\ndt_clf.fit(x_train,y_train)","dcf65c33":"from sklearn.metrics import accuracy_score,classification_report\ndt_pred = dt_clf.predict(x_test)\ndt_accuracy = accuracy_score(y_test,dt_pred)\ndt_accuracy","7158811f":"rf_clf = RandomForestClassifier(n_estimators = 200,random_state=0)\nrf_clf.fit(x_train,y_train)","2e006b91":"rf_pred = rf_clf.predict(x_test)\nrf_accuracy = accuracy_score(y_test,rf_pred)\nrf_accuracy","febb0aa6":"lr_clf = LogisticRegression(random_state=0)\nlr_clf.fit(x_train,y_train)","7704e22a":"lr_pred = lr_clf.predict(x_test)\nlr_accuracy = accuracy_score(y_test,lr_pred)\nlr_accuracy","ea8f6e94":"lgbm_clf = LGBMClassifier(n_estimators=1000,learning_rate=0.007,random_state=0)#1000\nlgbm_clf.fit(x_train,y_train)","50d970c0":"lgbm_pred = lgbm_clf.predict(x_test)\nlgbm_accuracy = accuracy_score(y_test,lgbm_pred)\nlgbm_accuracy","bc968b6c":"knn_clf = KNeighborsClassifier(n_neighbors=20)\nknn_clf.fit(x_train,y_train)","c84791b4":"knn_pred = knn_clf.predict(x_test)\nknn_accuracy = accuracy_score(y_test,knn_pred)\nknn_accuracy","bb0f362a":"acc_df = pd.DataFrame({\"Decision Tree\":dt_accuracy,\"Random Forest\":rf_accuracy,\n                       \"LightGBM\":lgbm_accuracy,\"Logistic Regression\" : lr_accuracy,\"KNN\":knn_accuracy},index = [\"Accuracy\"])\nacc_df.style.background_gradient(cmap = \"Reds\")","274c2cba":">Observation:\n- According to Annual Premium the number of Response and not Response is the same\n- Insurense with Annual premium less than 800,000 is most likely to respond","b350bd1e":">Decision Tree","61270c69":">Observation:\n- Number of People not having Driving License is very Small\n- The number of Response is very small compared to Not Resonse","50ed0955":"><h3>EDA<\/h3>","23111118":">Observation:\n- Dataset contains more number of Male than Female.So from that perspective the Response according to Gender(Male & Female) are Equal","93628f1d":"><h3>Feature Engineering<\/h3>","19bb8b42":"> <h3>All Models Accuracy<\/h3>","d589db5d":">Observation:\n- People who were not previously insured are most likely to response after having Vehicle Damage\n- People who were previously insured and had no vehicle damage currently , are most likely to not Response","745c106e":"---\n\n<h1 style=\"text-align: center;font-size: 40px;\">Prediction of Health Insurance Owners, who will be interested in Vehicle Insurance<\/h1>\n\n---\n\n<center><img src=\"https:\/\/www.cityinsurance.com.bd\/wp-content\/uploads\/2020\/02\/How-to-Motor-Insurance-1-820x450.png \"width=\"500\" height=\"600\"><\/center>\n\n---","feef39a4":">KNN","d2111234":">Observation:\n- Here we can see that, people ages between 39 to 50 are most likely to Response\n- People ages between 20 to 30 are most likely to Not Response","67505138":">Relation Between Gender and Response","7cd9e444":">Observation:\n- People having their Vehicle damaged in the past are most likely to Response (\"Experience speaks the Most\" :They know the Consequences)\n- People not having their Vehicle damaged in the past are most likely to not Response","c90dfef7":">Final Observation:\n- Here i've used 5 ML algorithms(Decision Tree, Random Forest,LightGBM,Logistic Regression,KNN), among them LightGBM gives the highest accuracy, which is 87.7%","32fe9e8e":">Observation (Fig: i):\n- People having Cars with age between 1-2 years are most likely to Response\n- People having Cars with age greater than 2 years are less likely to response","573b7ef5":">Finding the most important Features","57887caa":">LightGBM","950d3f5f":">Response According to Age","4616e7c4":">Relation of Driving license with Response","ba8b2f4e":"><h3>Model Building<\/h3>","b242bd61":">Logistic Regression","5ffea1b2":">Observation (Fig: ii):\n- 52.6% of the dataset contains cars with ages between 1-2 years\n- 43.2% of the dataset contains cars with ages less than 1 years\n- 4.2% of the dataset contains cars with ages greater than 2 years","a2ae738e":">Observation:\n- People Having vehicle Damage, vehicle with any age are most likely to Respond, so we can say that Vehicle Damage is the primary factor to Respond","45c07b73":">Random Forest","1a5bbc8d":"> Checking is there any Null values or Not","c49716da":">Observation:\n- Dataset contains more number of Male than Female    ","f4f3e8a1":"---\n\n<h1 style=\"text-align: center;font-size: 20px;color: blue\">Thanks for Reading!!<\/h1>\n\n---","8293c228":">Observation:\n- The people who were previously insured,i think they loose their interest of insured again,so there is a small number of people to Response\n- The people who were not previously Insured ,there is certain number of people who are going to response"}}