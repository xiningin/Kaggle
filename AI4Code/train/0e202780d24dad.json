{"cell_type":{"7aa416b1":"code","85c5f096":"code","eeb25589":"code","5c37d4ed":"code","97a53681":"code","5671f5fa":"code","7d48ee3e":"code","43a773fd":"code","ad4c3532":"code","fe177213":"code","da4966d4":"code","d8880e6b":"code","4859b9a9":"code","0aabdac3":"code","a2e0aa4f":"code","12bf94cc":"code","233e9a72":"code","7cc6692c":"code","864ddcab":"code","2f67fdc9":"code","61971815":"code","ec8342be":"code","67b1da4b":"code","f5817486":"code","589660de":"code","15fe5720":"code","f4884f01":"code","6ec5441b":"code","9be7c992":"code","30d1a372":"code","af29f764":"code","4ccb83ca":"markdown","1ceda04e":"markdown","5326cf57":"markdown","60b41f68":"markdown"},"source":{"7aa416b1":"import pandas as pd\nimport numpy as np","85c5f096":"df = pd.read_csv('..\/input\/jobathon-november-2021-analytics-vidhya\/train_MpHjUjU.csv')\ntest = pd.read_csv('..\/input\/jobathon-november-2021-analytics-vidhya\/test_hXY9mYw.csv')","eeb25589":"df.head(10)","5c37d4ed":"df.describe()","97a53681":"df.info()","5671f5fa":"df.isna().sum()","7d48ee3e":"df_null = df[df['LastWorkingDate'].isnull() == True] \ndf_not_null = df[df['LastWorkingDate'].isnull() == False]","43a773fd":"df_not_null.LastWorkingDate = 1","ad4c3532":"not_null_emps = list(df_not_null.Emp_ID.unique())","fe177213":"df_null['LastWorkingDate']=df_null['Emp_ID'].apply(lambda x: 1 if x in not_null_emps else 0)","da4966d4":"df1 = df_null.append(df_not_null).copy()","d8880e6b":"df = df1.copy()","4859b9a9":"df.replace({'Male':0,'Female':1},inplace=True)","0aabdac3":"df.City = df.City.astype('category').cat.codes\ndf.Education_Level = df.Education_Level.astype('category').cat.codes","a2e0aa4f":"df.columns","12bf94cc":"df1 = df[['Emp_ID', 'Age', 'Gender', 'City', 'Education_Level',\n       'Salary', 'Joining Designation',\n       'Designation', 'Total Business Value', 'Quarterly Rating','LastWorkingDate']]","233e9a72":"#median\ndf1 = df1.groupby(by='Emp_ID')['Education_Level','Salary', 'Joining Designation','Designation', 'Total Business Value', 'Quarterly Rating','LastWorkingDate'].median()","7cc6692c":"df1.LastWorkingDate.unique()","864ddcab":"df1","2f67fdc9":"from sklearn.preprocessing import StandardScaler\nsc = StandardScaler()\ndf2 = sc.fit_transform(df1.values)","61971815":"df1.LastWorkingDate.value_counts()","ec8342be":"from sklearn.cluster import KMeans","67b1da4b":"km = KMeans(n_clusters=2,max_iter=300)\nkm.fit(df2)\ndf1['cluster'] = km.predict(df2)","f5817486":"df1.cluster.value_counts()","589660de":"df1.reset_index(level=0, inplace=True)","15fe5720":"test_X = pd.merge(test,df1,on='Emp_ID',how='inner')","f4884f01":"test_X","6ec5441b":"test_X.cluster.value_counts()","9be7c992":"submit = pd.DataFrame(test_X.cluster.values,columns=['Target'])\nsubmit['Emp_ID'] = test_X['Emp_ID']\nsubmit = submit[['Emp_ID','Target']]","30d1a372":"submit","af29f764":"submit.to_csv('submit_jobathon.csv', index=False)","4ccb83ca":"# **Data Preprocessing**","1ceda04e":"# **Feature Scaling**","5326cf57":"# **Model Build**","60b41f68":"# **Submit**"}}