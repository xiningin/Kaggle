{"cell_type":{"fdd78ec3":"code","333c007e":"code","df9e1a04":"code","a6b56c59":"code","0ecf808f":"code","59dac4a6":"code","b768d803":"code","b4f55025":"code","4533b3b5":"code","0e6f4012":"code","75701e89":"code","9cb77136":"code","8b7704b2":"code","0f2d910d":"code","20232e05":"code","3babdb41":"code","0b5f0455":"code","56b5e7e3":"code","c44d4929":"code","26e398b9":"code","375a86d3":"code","6d09a35f":"markdown","b6c1327a":"markdown","f0b7a3e8":"markdown","8b94d978":"markdown","10a1c23e":"markdown","473e381d":"markdown","d01e488c":"markdown"},"source":{"fdd78ec3":"import numpy as np\nimport pandas as pd\nimport matplotlib as mpl\nimport matplotlib.pyplot as plt\nfrom sklearn.cluster import KMeans\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.metrics import silhouette_score\nfrom sklearn.metrics import silhouette_samples\nfrom matplotlib.ticker import FixedLocator, FixedFormatter\nimport seaborn as sns\nimport os\n","333c007e":"os.listdir('\/kaggle\/input\/unsupervised-learning-on-country-data')","df9e1a04":"country_df = pd.read_csv('\/kaggle\/input\/unsupervised-learning-on-country-data\/Country-data.csv')","a6b56c59":"country_df.head()","0ecf808f":"country_df.info()","59dac4a6":"country_df.describe()","b768d803":"country_df.isna().sum()","b4f55025":"only_features_df = country_df.drop('country', axis=1)\nonly_features_df.head()","4533b3b5":"only_features_df_corr = only_features_df.corr()\nmask = np.triu(np.ones_like(only_features_df_corr, dtype=bool))\nsns.heatmap(only_features_df_corr, mask=mask, cbar=False, cmap=\"BuGn\", linewidths=0.3)","0e6f4012":"sc = StandardScaler()\nscaled_features = sc.fit_transform(only_features_df)\nscaled_features[:5]","75701e89":"kmeans_per_k = [KMeans(n_clusters=k, random_state=42).fit(scaled_features)\n                for k in range(1, 10)]\ninertias = [model.inertia_ for model in kmeans_per_k]","9cb77136":"plt.figure(figsize=(8, 3.5))\nplt.plot(range(1, 10), inertias, \"bo-\")\nplt.xlabel(\"Number of clusters\", fontsize=14)\nplt.ylabel(\"Inertia\", fontsize=14)   \nplt.show()","8b7704b2":"silhouette_scores = [silhouette_score(scaled_features, model.labels_)\n                     for model in kmeans_per_k[1:]]","0f2d910d":"plt.figure(figsize=(8, 3))\nplt.plot(range(2, 10), silhouette_scores, \"bo-\")\nplt.xlabel(\"Number of Clusters\", fontsize=14)\nplt.ylabel(\"Silhouette score\", fontsize=14)\nplt.show()","20232e05":"plt.figure(figsize=(11, 9))\n\nfor k in (3, 4, 5, 6):\n    plt.subplot(2, 2, k - 2)\n    \n    y_pred = kmeans_per_k[k - 1].labels_\n    silhouette_coefficients = silhouette_samples(scaled_features, y_pred)\n\n    padding = len(scaled_features) \/\/ 30\n    pos = padding\n    ticks = []\n    for i in range(k):\n        coeffs = silhouette_coefficients[y_pred == i]\n        coeffs.sort()\n\n        color = mpl.cm.Spectral(i \/ k)\n        plt.fill_betweenx(np.arange(pos, pos + len(coeffs)), 0, coeffs,\n                          facecolor=color, edgecolor=color, alpha=0.7)\n        ticks.append(pos + len(coeffs) \/\/ 2)\n        pos += len(coeffs) + padding\n\n    plt.gca().yaxis.set_major_locator(FixedLocator(ticks))\n    plt.gca().yaxis.set_major_formatter(FixedFormatter(range(k)))\n    if k in (3, 5):\n        plt.ylabel(\"Cluster\")\n    \n    if k in (5, 6):\n        plt.gca().set_xticks([-0.1, 0, 0.2, 0.4, 0.6, 0.8, 1])\n        plt.xlabel(\"Silhouette Coefficient\")\n    else:\n        plt.tick_params(labelbottom=False)\n\n    plt.axvline(x=silhouette_scores[k - 2], color=\"red\", linestyle=\"--\")\n    plt.title(\"$k={}$\".format(k), fontsize=16)\n\nplt.show()","3babdb41":"clusters = KMeans(n_clusters=3, random_state=42).fit(scaled_features)\npd.Series(clusters.labels_).value_counts()","0b5f0455":"kmeans_df = only_features_df.copy()\nkmeans_df.head()","56b5e7e3":"kmeans_df['label'] = clusters.labels_\nkmeans_df.head()","c44d4929":"fig, ax = plt.subplots(2,2, figsize=(10,10))\nsns.boxplot(x='label', y='child_mort', data=kmeans_df, ax=ax[0,0])\nax[0,0].set_title('child mortality')\nsns.boxplot(x='label', y='inflation', data=kmeans_df, ax=ax[0,1])\nax[0,1].set_title('Inflation')\nsns.boxplot(x='label', y='life_expec', data=kmeans_df, ax=ax[1,0])\nax[1,0].set_title('Life Expectancy')\nsns.boxplot(x='label', y='gdpp', data=kmeans_df, ax=ax[1,1])\nax[1,1].set_title('GDP per capita')\nfig.tight_layout()","26e398b9":"kmeans_df['country'] = country_df['country']","375a86d3":"print( 'Label 0 Countries\\n',kmeans_df.loc[kmeans_df['label'] == 0, 'country'][:5])\nprint( 'Label 2 Countries\\n',kmeans_df.loc[kmeans_df['label'] == 2, 'country'][:5])\nprint( 'Label 1 Countries\\n',kmeans_df.loc[kmeans_df['label'] == 1, 'country'][:5])","6d09a35f":"# Silhouette diagram","b6c1327a":"### Even though K = 4 has the highest silhouette score, we can see from the diagram that one of the cluster is smaller than the rest. Meanwhile K = 3 , has similar sizes for all their clusters.","f0b7a3e8":"# Keeping only the numeric features","8b94d978":"# Elbow method","10a1c23e":"# Silhouette scores","473e381d":"## Based on the figures we can say make the following ranking:\n1. Cluster-0\n2. Cluster-2\n3. Cluster-1","d01e488c":"# Scaling"}}