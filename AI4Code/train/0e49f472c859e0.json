{"cell_type":{"6b4ad796":"code","9acb4567":"code","e7ac09f1":"code","4987500c":"code","8dc2ae53":"code","0c8c6dce":"code","0c5079ae":"code","ba569686":"code","0f1ee2aa":"code","7fe8df28":"code","5c643406":"code","1190adab":"code","04ba9b1f":"code","732b8e60":"code","3c368867":"code","32db5794":"code","eb32feab":"code","466ede63":"code","99d58f64":"code","9fee934d":"code","9fe27aa8":"code","e5aeaacb":"code","54cf3402":"code","a07f275d":"code","4599b1d2":"code","fc7596aa":"code","64d737f1":"code","426a5466":"code","77769329":"markdown"},"source":{"6b4ad796":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline","9acb4567":"df = pd.read_csv(\"..\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv\")\ndf.head()","e7ac09f1":"df.drop('CustomerID',axis=1,inplace=True)","4987500c":"df.head()","8dc2ae53":"gender = pd.get_dummies(df['Gender'],drop_first=True)\ndf = pd.concat([df,gender],axis=1)","0c8c6dce":"df.drop('Gender',axis=1,inplace=True)","0c5079ae":"df.shape","ba569686":"sns.pairplot(data=df)","0f1ee2aa":"sns.heatmap(df.corr(),annot=True)","7fe8df28":"from sklearn.preprocessing import StandardScaler\nscaler = StandardScaler()","5c643406":"scaled_data = pd.DataFrame(scaler.fit_transform(df),columns=df.columns)","1190adab":"scaled_data","04ba9b1f":"sns.pairplot(data=scaled_data)","732b8e60":"from sklearn.cluster import KMeans","3c368867":"noise = []\ncluster_range = range(1,30)\nfor i in cluster_range:\n    model = KMeans(n_clusters=i)\n    model.fit(scaled_data)\n    noise.append(model.inertia_)","32db5794":"plt.plot(cluster_range,noise,marker='o')\nplt.xlabel('number of cluster')\nplt.ylabel('noise')\nplt.show()","eb32feab":"model = KMeans(n_clusters=10)\nmodel.fit(scaled_data)\nY = model.predict(scaled_data)","466ede63":"Y","99d58f64":"model.cluster_centers_","9fee934d":"from sklearn.decomposition import PCA\npca = PCA(n_components=2,random_state=42)\nXpca = pd.DataFrame(pca.fit_transform(scaled_data),columns=['pca1','pca2'])\nXpca","9fe27aa8":"pca.explained_variance_ratio_.cumsum()[1]","e5aeaacb":"Xpca_Centers = pca.transform(model.cluster_centers_)","54cf3402":"Xpca_Centers","a07f275d":"Xpca_Centers[:,0]","4599b1d2":"Xpca['Cluster'] = Y","fc7596aa":"Xpca","64d737f1":"plt.figure(figsize=(15,10))\nplt.scatter(Xpca[Xpca['Cluster'] == 0].loc[:,'pca1'],Xpca[Xpca['Cluster'] == 0].loc[:,'pca2'],color='red',label='cluster1')\nplt.scatter(Xpca[Xpca['Cluster'] == 1].loc[:,'pca1'],Xpca[Xpca['Cluster'] == 1].loc[:,'pca2'],color='green',label='cluster2')\nplt.scatter(Xpca[Xpca['Cluster'] == 2].loc[:,'pca1'],Xpca[Xpca['Cluster'] == 2].loc[:,'pca2'],color='yellow',label='cluster3')\nplt.scatter(Xpca[Xpca['Cluster'] == 3].loc[:,'pca1'],Xpca[Xpca['Cluster'] == 3].loc[:,'pca2'],color='grey',label='cluster4')\nplt.scatter(Xpca[Xpca['Cluster'] == 4].loc[:,'pca1'],Xpca[Xpca['Cluster'] == 4].loc[:,'pca2'],color='blue',label='cluster5')\nplt.scatter(Xpca[Xpca['Cluster'] == 5].loc[:,'pca1'],Xpca[Xpca['Cluster'] == 5].loc[:,'pca2'],color='purple',label='cluster6')\nplt.scatter(Xpca[Xpca['Cluster'] == 6].loc[:,'pca1'],Xpca[Xpca['Cluster'] == 6].loc[:,'pca2'],color='orange',label='cluster7')\nplt.scatter(Xpca[Xpca['Cluster'] == 7].loc[:,'pca1'],Xpca[Xpca['Cluster'] == 7].loc[:,'pca2'],color='pink',label='cluster8')\nplt.scatter(Xpca[Xpca['Cluster'] == 8].loc[:,'pca1'],Xpca[Xpca['Cluster'] == 8].loc[:,'pca2'],color='black',label='cluster9')\nplt.scatter(Xpca[Xpca['Cluster'] == 9].loc[:,'pca1'],Xpca[Xpca['Cluster'] == 9].loc[:,'pca2'],color='brown',label='cluster10')\nplt.scatter(Xpca_Centers[:,0],Xpca_Centers[:,1],s=400,c='blue',label='centroids')\nplt.legend()\nplt.show()","426a5466":"from collections import Counter\nCounter(Y)","77769329":"# using K means Clusting"}}