{"cell_type":{"02a0dfde":"code","473d2e15":"code","ee4516b4":"code","0a8fc865":"code","ed20a649":"code","e99bf790":"code","5830abea":"code","c2e58033":"code","a12985c8":"code","cee6cf26":"code","d5aa5a51":"code","df237db6":"code","2035fdd0":"code","bb02804f":"code","c4b37ade":"code","dcc17b47":"code","8b2fb957":"code","154df5db":"code","ee1700be":"code","adf8b600":"code","c1e2a54d":"code","b1789c07":"code","66c75815":"code","301690ab":"code","31e5eb13":"code","9be86271":"code","2b2d20d6":"code","7b7d3876":"code","bb4924f3":"code","668fb205":"code","63a9d80f":"code","a29a931c":"code","b2af6fe8":"markdown"},"source":{"02a0dfde":"#!pip install tpot","473d2e15":"from __future__ import print_function\nfrom tpot import  TPOTClassifier\nfrom sklearn.model_selection import train_test_split\nimport sys,tempfile, urllib, os\nimport pandas as pd\nimport numpy as np","ee4516b4":"import pandas as pd\nc=pd.read_csv('..\/input\/customer-churn\/aa.csv')","0a8fc865":"churn_df = c","ed20a649":"churn_df.head()","e99bf790":"print (\"Rows     : \" ,churn_df.shape[0])\nprint (\"Columns  : \" ,churn_df.shape[1])","5830abea":"from sklearn.compose import make_column_transformer\nfrom sklearn.preprocessing import OrdinalEncoder\n\ncategorical_columns = ['gender', 'Partner', 'Dependents','PhoneService','MultipleLines','InternetService','OnlineSecurity','OnlineBackup','DeviceProtection','TechSupport','StreamingTV','StreamingMovies','Contract','PaperlessBilling','PaymentMethod','Churn']\ncolumn_trans = make_column_transformer((OrdinalEncoder(), categorical_columns))\n\nchurn_transformed=column_trans.fit_transform(churn_df)","c2e58033":"churn_transformed","a12985c8":"churn_transformed.size","cee6cf26":"churn_df_trans = churn_df.copy()\nchurn_df_trans = pd.DataFrame(churn_transformed, columns=categorical_columns)","d5aa5a51":"churn_df.update(churn_df_trans)","df237db6":"churn_df","2035fdd0":"churn_df.describe()","bb02804f":"churn_df.isna().sum()","c4b37ade":"churn_df.replace(r'^\\s*$', np.nan, regex=True).isna().sum()","dcc17b47":"churn_df = churn_df.replace(r'^\\s*$', np.nan, regex=True)","8b2fb957":"churn_df.isna().sum()","154df5db":"churn_df.dtypes","ee1700be":"churn_df.iloc[:, 19] = pd.to_numeric(churn_df.iloc[:, 19], errors='coerce') ","adf8b600":"from sklearn.impute import SimpleImputer\nimp_median = SimpleImputer(missing_values=np.nan, strategy='median')","c1e2a54d":"churn_df.iloc[:, 19] = imp_median.fit_transform(churn_df.iloc[:, 19].values.reshape(-1, 1) )","b1789c07":"churn_df.isna().sum()","66c75815":"churn_df_X = churn_df.drop(\"Churn\", axis=1)\nchurn_df_X = churn_df_X.drop(\"customerID\", axis=1)\nchurn_df_y = churn_df['Churn']\n","301690ab":"X_train, X_test, y_train, y_test = train_test_split(churn_df_X, churn_df_y, train_size=0.75, test_size=0.25)","31e5eb13":"X_train","9be86271":"tpot =  TPOTClassifier(generations=4, population_size=10, verbosity=1)\ntpot.fit(X_train, y_train)\nprint(tpot.score(X_test, y_test))","2b2d20d6":"import multiprocessing\n\nif __name__ == '__main__':\n    multiprocessing.set_start_method('forkserver', force=True)\n    tpot =  TPOTClassifier(generations=2, population_size=20, verbosity=2,n_jobs = 20, random_state=50)\n    tpot.fit(X_train, y_train)\n","7b7d3876":"print(tpot.score(X_test, y_test))","bb4924f3":"tpot.export('tpot_churn_pipeline.py')","668fb205":"!cat tpot_churn_pipeline.py","63a9d80f":"tpot.evaluated_individuals_","a29a931c":"tpot.fitted_pipeline_","b2af6fe8":"![alt text](https:\/\/raw.githubusercontent.com\/EpistasisLab\/tpot\/master\/images\/tpot-ml-pipeline.png)"}}