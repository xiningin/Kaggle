{"cell_type":{"8c25de0f":"code","5bc56065":"code","365001b9":"code","99aeeabe":"code","73539586":"code","556301e5":"code","1add293c":"code","717f96bd":"code","7ce0afca":"code","ca93b069":"code","a82c0197":"code","8f1e7de4":"code","ede529bf":"code","ccd65a38":"code","b07f98f6":"code","8502f8f7":"code","3abac21c":"code","206f6ef1":"code","698eb231":"code","87562f3d":"code","fdacd40d":"code","ad42c7be":"code","4237bc46":"code","18b6a3db":"code","c0dbb1d9":"code","0285fc78":"code","71950403":"code","f49885ff":"code","a6d46ec3":"markdown","fcbd52ee":"markdown","f2871508":"markdown","84ccbf78":"markdown","51503248":"markdown","b55e9a29":"markdown","bb75374e":"markdown","977075b6":"markdown","3db11f1d":"markdown","ed31ddae":"markdown","6fd45816":"markdown","8e9820e8":"markdown","3ea0d44d":"markdown","c52e3afd":"markdown"},"source":{"8c25de0f":"%%time\nimport pandas as pd\nfrom sklearn.ensemble import RandomForestRegressor\n","5bc56065":"%%time\nimport os\nprint(os.listdir(\"..\/input\"))\ndf_train = pd.read_csv('..\/input\/train.csv')\ndf_test = pd.read_csv('..\/input\/test.csv')\ncombine = [df_train, df_test]","365001b9":"print(df_train.head(3))\nprint(df_test.head(3))","99aeeabe":"# Define column date as datatype date and define new date features\nfor dataset in combine:\n    dataset['date'] = pd.to_datetime(dataset['date'])\n    dataset['year'] = dataset.date.dt.year\n    dataset['month'] = dataset.date.dt.month\n    dataset['day'] = dataset.date.dt.day\n    dataset['dayofyear'] = dataset.date.dt.dayofyear\n    dataset['dayofweek'] = dataset.date.dt.dayofweek\n    dataset['weekofyear'] = dataset.date.dt.weekofyear","73539586":"dataset.drop('date', axis=1, inplace=True)","556301e5":"df_train.head()","1add293c":"df_train['daily_avg']=df_train.groupby(['item','store','dayofweek'])['sales'].transform('mean')\ndf_train['monthly_avg']=df_train.groupby(['item','store','month'])['sales'].transform('mean')","717f96bd":"daily_avg=df_train.groupby(['item','store','dayofweek'])['sales'].mean().reset_index()\nmonthly_avg=df_train.groupby(['item','store','month'])['sales'].mean().reset_index()\n","7ce0afca":"monthly_avg","ca93b069":"def merge(x,y,col,col_name):\n    x =pd.merge(x, y, how='left', on=None, left_on=col, right_on=col,\n            left_index=False, right_index=False, sort=True,\n             copy=True, indicator=False,validate=None)\n    \n    x=x.rename(columns={'sales':col_name})\n    return x\n\ndf_test=merge(df_test, daily_avg,['item','store','dayofweek'],'daily_avg')\ndf_test=merge(df_test, monthly_avg,['item','store','month'],'monthly_avg')\n","a82c0197":"print(df_test.columns)\nprint(df_train.columns)","8f1e7de4":"\ndf_test=df_test.drop(['id'],axis=1)\ndf_train=df_train.drop(['date'],axis=1)","ede529bf":"df_test.columns","ccd65a38":"df_train.shape","b07f98f6":"df_test.shape","8502f8f7":"df_train.head(2)","3abac21c":"df_test.head(2)","206f6ef1":"df_train.isnull().sum()","698eb231":"df_test.isnull().sum()","87562f3d":"df_train.dtypes","fdacd40d":"df_test.dtypes","ad42c7be":"regr = RandomForestRegressor(n_estimators=100,max_depth=2, random_state=0)","4237bc46":"y=pd.DataFrame()\ny=df_train['sales']\n","18b6a3db":"df_train=df_train.drop(['sales'],axis=1)","c0dbb1d9":"x=df_train\n","0285fc78":"regr=regr.fit(x,y)","71950403":"%%time\noutput=regr.predict(df_test)\nresult=pd.DataFrame(output)\nresult","f49885ff":"%%time\ntest=pd.read_csv('..\/input\/test.csv',usecols=['id'])\nfin=pd.DataFrame(test)\nfin['sales']=result\nfin.to_csv('Sales_RF.csv',index=False)\n ","a6d46ec3":"### Checking datatypes","fcbd52ee":"#### Dropping date column","f2871508":"### Submission","84ccbf78":"#### Define column date as datatype date and define new date features","51503248":"### Checking for missing  values","b55e9a29":"### Loading libraries","bb75374e":"#### Displaying columns in train and testing ","977075b6":"#### Reading test and train data","3db11f1d":"#### Displaying head of training and testing","ed31ddae":"#### Dropping columns","6fd45816":"### Add new features daily aveage sales and monthly average sales","8e9820e8":"#### INPUT size","3ea0d44d":"### Modelling  with GradientBoostingRegressor","c52e3afd":"### Merging new features"}}