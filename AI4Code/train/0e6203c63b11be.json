{"cell_type":{"8c635305":"code","9ebf8dce":"code","d275eb5d":"code","fc6ad746":"code","e3150c6f":"code","cb7d7e24":"code","0bd0cd67":"code","2a7df99e":"code","8d802b28":"code","fb68c65b":"code","586e77cf":"code","655a203e":"code","13df1da0":"code","86587264":"code","584d401d":"code","52eef810":"code","b3caf20c":"code","8f416c98":"code","c7a02d96":"code","378e2b84":"code","387270c4":"code","0e1b3680":"code","ae83eb94":"code","72ae9316":"code","81adc72c":"code","92ecc524":"markdown","2b9d81d9":"markdown","f561605d":"markdown","0993ef41":"markdown","1dd92d97":"markdown","f76ea0c4":"markdown"},"source":{"8c635305":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport matplotlib.dates as mdates\nimport matplotlib.cbook as cbook\nimport calendar\n\nyears = mdates.YearLocator()   # every year\nmonths = mdates.MonthLocator()  # every month\nyears_fmt = mdates.DateFormatter('%Y')\nmonths_fmt = mdates.DateFormatter('%B')","9ebf8dce":"us_states = pd.read_csv('..\/input\/usstatescovid\/us-states.csv', parse_dates=True) #dataset of cases in the united states\nus_regions = pd.read_csv('..\/input\/usa-states-to-region\/states.csv') #metadata of states \n#us_states.head()\n\n#convert date column to datetime series\nus_states['date'] = pd.to_datetime(us_states['date'])","d275eb5d":"us_states['new_cases'] = us_states.groupby('state')['cases'].diff().fillna(us_states['cases']) #create new column for new cases per day by state \nus_states['new_deaths'] = us_states.groupby('state')['deaths'].diff().fillna(us_states['deaths']) #create new column for new cases per day by state \nnew_cases_table = us_states.pivot_table(values='new_cases', index='date', columns='state') #create pivot table of new cases by state","fc6ad746":"#merge region informaiton into data frame with confirmed cases count\ncases_with_region = pd.merge(us_states, us_regions, left_on='state', right_on='State')\n#cases_with_region.head()","e3150c6f":"#rolling 7 day average of new cases\ncases_with_region['7D-RollMean-NC'] = cases_with_region.groupby('state')['new_cases'].transform(lambda x: x.rolling(7, 7).mean()).fillna(0)\ncases_with_region['7D-RollMean-ND'] = cases_with_region.groupby('state')['new_deaths'].transform(lambda x: x.rolling(7, 7).mean()).fillna(0)\navg_new_cases_table = cases_with_region.pivot_table(values='7D-RollMean-NC', index='date', columns='state') #create pivot table of new cases by state\n#cases_with_region","cb7d7e24":"total_cases = cases_with_region.groupby('date').sum()['cases']\ntotal_new_cases = total_cases.diff().fillna(1)\ntotal_7D_new_cases_avg = total_new_cases.transform(lambda x: x.rolling(7,7).mean()).fillna(0)\nsns.relplot(kind='line', data=total_7D_new_cases_avg)\n#print(total_7D_new_cases_avg)","0bd0cd67":"#total sum of cases by state\ncum_state_cases = us_states.groupby('state')['cases'].max()","2a7df99e":"#bar chart of cumaltive cases per states\ncum_state_cases.plot(kind='bar', fontsize=5, rot=90)\nplt.ylabel('Cases');\nplt.title ('Total Confirmed Cases by State');\n#plt.show()\n# plt.clf()","8d802b28":"new_cases_sort = avg_new_cases_table.loc[avg_new_cases_table.index[-1]].sort_values()\nnew_cases_sort = list(new_cases_sort.index)\nprint(new_cases_sort)","fb68c65b":"#new_cases_table.plot.area(legend=None)\nfig, ax = plt.subplots()\n\nax.stackplot(avg_new_cases_table.index, avg_new_cases_table[new_cases_sort].T)\nax.xaxis.set_major_locator(months)\nax.xaxis.set_major_formatter(months_fmt)\nplt.show()\nplt.clf()","586e77cf":"#bar chart of total cases by region \ncases_by_region = cases_with_region.groupby(['Region', 'date']).sum()[['cases']]\ntotal_cases_by_region = cases_by_region.groupby(['Region']).max()\ntotal_cases_by_region.plot(kind='bar')\nplt.show()\nplt.clf()","655a203e":"cases_by_region_pivot = cases_by_region.pivot_table(values='cases', index='date', columns='Region').fillna(0) #pivot table of cases for each region","13df1da0":"cases_by_region_pivot.plot()\nplt.show()\nplt.clf()","86587264":"cases_states_region = cases_with_region.pivot_table(values='cases', index='date', columns=['Region','state']).fillna(0) #pivot table of cases with region and state\ncases_states_region_march = cases_states_region.loc['2020-03-01'::] #all entries after March 1\n#cases_states_region_march.head()","584d401d":"fig, ax = plt.subplots(2,2 , figsize=(15,15))\nfig.subplots_adjust(wspace = 0.5, hspace=0.25)\n\nax[0,0].plot(cases_states_region_march['Midwest'])\nax[0,0].set_title('Midwest')\nax[0,0].xaxis.set_major_locator(months)\nax[0,0].xaxis.set_major_formatter(months_fmt)\n\nax[0,1].plot(cases_states_region_march['West'])\nax[0,1].set_title('West')\nax[0,1].xaxis.set_major_locator(months)\nax[0,1].xaxis.set_major_formatter(months_fmt)\n\nax[1,0].plot(cases_states_region_march['Northeast'])\nax[1,0].set_title('Northeast')\nax[1,0].xaxis.set_major_locator(months)\nax[1,0].xaxis.set_major_formatter(months_fmt)\n\nax[1,1].plot(cases_states_region_march['South'])\nax[1,1].set_title('South')\nax[1,1].xaxis.set_major_locator(months)\nax[1,1].xaxis.set_major_formatter(months_fmt)\n\n\n\nplt.show()\nplt.clf()","52eef810":"#percent change over 7 days in cases\n#cases_with_region['7 Day Percent Change'] = cases_with_region.groupby('state')['cases'].pct_change(7).fillna(0)*100\n#cases_with_region","b3caf20c":"#group cumaltive cases by month\ntotal_each_month = cases_with_region.groupby(cases_with_region['date'].dt.month).sum()[['new_cases']]\ntotal_each_month.reset_index(inplace=True)","8f416c98":"total_each_month['date'] = total_each_month['date'].apply(lambda x: calendar.month_name[x])","c7a02d96":"#bar chart of new cases every month\n\nsns.catplot(kind='bar', data=total_each_month, x='date', y='new_cases')\nplt.show()\nplt.clf","378e2b84":"#create cumalitive numbers by date\ntotals = cases_with_region.groupby('date').sum()\ntotals.reset_index(inplace=True)","387270c4":"#create visualization of new cases and new deaths over time\nfig, axes = plt.subplots(1, 2, figsize=(15,10))\nfig.subplots_adjust(wspace = 0.25, hspace=0.15)\nsns.lineplot(data=totals, x='date', y='new_cases', alpha=0.25, ax=axes[0])\nsns.lineplot(data=totals, x='date', y='new_deaths', alpha=0.25, ax=axes[1])\nsns.lineplot(data=totals, x='date', y='7D-RollMean-NC', ax=axes[0])\nsns.lineplot(data=totals, x='date', y='7D-RollMean-ND', ax=axes[1])\n\n\nplt.show()\nplt.clf()","0e1b3680":"days = us_states.groupby('date').sum()\ndays.head()","ae83eb94":"days.loc['2020-02-22']","72ae9316":"ny_avg_new_cases = avg_new_cases_table.loc['2020-07-01':]['New York'].fillna(0)\nny_new_cases = new_cases_table.loc['2020-07-01':]['New York'].fillna(0)\nny_new_cases.plot(alpha=0.2)\nny_avg_new_cases.plot()\nplt.show()\nplt.clf()","81adc72c":"nj_avg_new_cases = avg_new_cases_table.loc['2020-07-01':]['New Jersey'].fillna(0)\nnj_new_cases = new_cases_table.loc['2020-07-01':]['New Jersey'].fillna(0)\nnj_new_cases.plot(alpha=0.2)\nnj_avg_new_cases.plot()\nplt.show()\nplt.clf()","92ecc524":"# **Looking at various trends of COVID-19 cases in the US**","2b9d81d9":"# Tracking the numbers and trends in different regions of the country","f561605d":"# **Trend of the 7 day rolling average of total new cases**","0993ef41":"# *Looking at total new cases per month*","1dd92d97":"# View of the trends new cases and new deaths","f76ea0c4":"# View of total number of cases by each state"}}