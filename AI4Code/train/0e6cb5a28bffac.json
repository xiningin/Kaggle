{"cell_type":{"38537f01":"code","fdb21fb7":"code","1ec52b0d":"code","bf184b50":"code","76f5852e":"code","9eb2dde9":"code","42f49b33":"code","9dc84978":"code","81ef43c0":"code","844480ed":"code","5f1af06c":"code","106a9c0a":"code","e7823f19":"code","b08fd0f9":"code","3d0af750":"code","3027b867":"code","0a3eb856":"code","032db527":"code","27061c4d":"code","8b659524":"code","60ffdc1a":"code","6d8f807c":"code","0aa61ce8":"code","93f13d37":"markdown","48260fa4":"markdown","faef36d1":"markdown","431dd05b":"markdown","e32078ac":"markdown","93825f27":"markdown","8ec09dad":"markdown","e07b34b6":"markdown","b26d2b30":"markdown","68523cf9":"markdown","1c31d4db":"markdown","fe9cc73e":"markdown"},"source":{"38537f01":"import pandas as pd\nimport numpy as np\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.preprocessing import RobustScaler\nfrom sklearn.preprocessing import OneHotEncoder\n\nfrom sklearn.impute import SimpleImputer\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.compose import ColumnTransformer\n\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.ensemble import RandomForestClassifier","fdb21fb7":"pd.options.display.max_columns=100\npd.options.display.max_rows=100","1ec52b0d":"from IPython.core.interactiveshell import InteractiveShell\nInteractiveShell.ast_node_interactivity = \"all\"","bf184b50":"df = pd.read_csv(\"..\/input\/caravan-insurance-challenge\/caravan-insurance-challenge.csv\")","76f5852e":"df.head()","9eb2dde9":"df.shape","42f49b33":"df.info()","9dc84978":"df.isnull().values.any()","81ef43c0":"df.nunique()","844480ed":"x_train = df.loc[df['ORIGIN'] == 'train',:]\nx_test = df.loc[df['ORIGIN'] == 'test',:]","5f1af06c":"a = x_train.pop('ORIGIN')\nb = x_test.pop('ORIGIN')\n","106a9c0a":"y_train = x_train.pop('CARAVAN')\ny_test = x_test.pop('CARAVAN')","e7823f19":"x_train.shape\nx_test.shape\ny_train.shape\ny_test.shape","b08fd0f9":"num_columns = x_train.columns[x_train.nunique() > 5]\ncat_columns = x_train.columns[x_train.nunique() <= 5]","3d0af750":"len(num_columns)\nlen(cat_columns)","3027b867":"num_columns","0a3eb856":"plt.figure(figsize=(15,15))\nsns.distributions._has_statsmodels=False\nfor i in range(len(num_columns)):\n    plt.subplot(11,5,i+1)\n    sns.distplot(df[num_columns[i]])\n    \nplt.tight_layout()","032db527":"ct = ColumnTransformer(\n                        [\n                            ('num_col', RobustScaler(),num_columns), \n                            ('cat_col', OneHotEncoder(handle_unknown='ignore'), cat_columns),\n                         ]\n,remainder = 'passthrough')","27061c4d":"ct.fit_transform(x_train) ","8b659524":"pipe = Pipeline([('ct',ct),\n                 ('rf',RandomForestClassifier())\n                 ])\n","60ffdc1a":"pipe.fit(x_train,y_train)","6d8f807c":"y_pred = pipe.predict(x_test)","0aa61ce8":"np.sum(y_pred == y_test)\/len(y_test)*100","93f13d37":"Draw dist plots for all the numerical columns","48260fa4":"Null values are not present","faef36d1":"Split the dataset using ORIGIN column.\nRemove the ORIGIN variable in both train and test datasets (it is used only to spilit the data)","431dd05b":" - Import Libraries & Read Dataset\n - Check the train dataset if any missing values (NA) ( Use Imputer if any missing values)\n - Split the dataset into train and test datasets\n - Remove the ORIGIN variable in both train and test datasets (it is used only to spilit the data)\n - Use Dist plot to see any outliers \n - Use Column Transformer to encode the dataset\n - Create RandomForest model \n - Train the model with our train dataset\n - Make predictions by applying the model on our test dataset\n","e32078ac":"Create RandomForest model and train dataset in the model created and then apply the future test dataset and make prediction","93825f27":"Apply Random Forest Classifier on the fit & transformed (RobustScaler & OneHotEncoder) x_train data","8ec09dad":"Pop out the CARAVAN column into y array (Target)","e07b34b6":"## Caravan Insurance Excercise using Random Forests\n#### By Ezhilarasan Kannaiyan","b26d2b30":"Apply the model on test data and make predictions","68523cf9":"We could predict the test data with almost 93% with RandomForest model","1c31d4db":"Create arrays of numerical and Categorical columns","fe9cc73e":"Column Transformer to apply Scaling\nRobust Scaler for Numerical Columns when they Outliers\nStandard Scaler for Numerical Columns when there is no Outliers\nOneHotEncoder for Categorical Columns"}}