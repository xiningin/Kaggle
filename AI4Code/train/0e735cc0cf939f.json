{"cell_type":{"d53a24b6":"code","81868a2a":"code","b123bfb5":"code","ba26ff7c":"code","48c9e8d6":"code","30e10b7b":"code","2b3e454b":"code","3923a02e":"code","64cb6f3a":"code","880a3e88":"code","820f4fcd":"code","888314f7":"code","97778c9a":"code","8990bc6f":"code","fd63d1d2":"code","cdcd78bc":"code","ad8c59d6":"code","327991e4":"code","9d0c483b":"code","fd27f42a":"code","7937d0f6":"code","85e99227":"code","ac00dd3b":"code","5d132fff":"code","1164b855":"code","675291b5":"code","3756af17":"code","95ec7252":"code","4b2d0951":"code","25c96fe9":"code","cfffa4e1":"markdown","9ea4c665":"markdown","d38eae09":"markdown","420888e8":"markdown","74a88cb7":"markdown","f3eae600":"markdown","74ba9b2a":"markdown","cfcdcee3":"markdown","d4f8764d":"markdown","f13ffe7c":"markdown","9b6cb43e":"markdown","e20b47a4":"markdown","bf4e5f63":"markdown","1c83a658":"markdown","8f279de7":"markdown","4f3eff77":"markdown","ad564a9d":"markdown","9686280f":"markdown","441d3c4e":"markdown","376bf46b":"markdown","6e4d9ad4":"markdown","35479b90":"markdown","2ee2e7a5":"markdown","0f585f2b":"markdown"},"source":{"d53a24b6":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nfrom collections import Counter\nimport seaborn as sns\nimport plotly.express as px\nimport plotly.figure_factory as ff\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.model_selection import train_test_split\nfrom imblearn.over_sampling import SMOTE\nimport warnings\nwarnings.filterwarnings(\"ignore\")","81868a2a":"data=pd.read_csv('..\/input\/stroke-prediction-dataset\/healthcare-dataset-stroke-data.csv')\ndata","b123bfb5":"stroke=Counter(data['stroke'])\nclasses=[]\ncount=[]   #list to store no of laels of each class\nfor i in stroke.keys():\n    classes.append(i)\n    count.append(stroke[i])\ncolors = [\"#E13F29\", \"#D69A80\"]\n\nplt.pie(\n    count,\n    labels = classes,\n    shadow = True,\n    colors = colors,\n    startangle=80,\n    autopct='%1.1f%%'\n)\nplt.axis('equal')\nplt.tight_layout()\nplt.title(\"Percentage of strokes present in the dataset\", fontsize=15)\nplt.show()","ba26ff7c":"plt.figure(figsize=(10,5))\nplt.xlim(-10,125)\nplt.xlabel('Age')\nplt.ylabel('Density')\nsns.kdeplot(data['age'],shade=True)\nplt.title('Distribution of age', fontsize=15)\nplt.show()","48c9e8d6":"stroke = data[data['stroke']==1]['age'].fillna(0.0).astype(float)\nstroke_no = data[data['stroke']==0]['age'].fillna(0.0).astype(float)\nfig = ff.create_distplot([stroke, stroke_no], ['Stroke','No Stroke'], bin_size=0.65, curve_type='normal'\n                        ,colors =  ['#221F1F','#E50914'])\nfig.update_layout(\n    title=\"Stroke distibution over age\",\n    xaxis_title=\"Age\",\n)\nfig.show()","30e10b7b":"data['gender'].value_counts().plot(kind='bar')\nprint(data['gender'].value_counts())\nplt.title('Distribution of gender', fontsize=15)","2b3e454b":"sns.violinplot(x = 'gender', y = 'stroke', data = data)\nplt.title('Stroke distibution over gender', fontsize=15)\nprint(\"Percentage of male and female suffers from stroke\")\nprint(data.groupby('gender').stroke.apply(lambda x: (x == 1).mean()))","3923a02e":"data['hypertension'].value_counts().plot(kind='bar')\nprint(data['hypertension'].value_counts())\nplt.title('Distribution of hypertension', fontsize=15)","64cb6f3a":"sns.catplot(x=\"hypertension\", hue=\"stroke\",palette=\"pastel\", kind=\"count\",data=data)\nplt.title('Stroke distibution over hypertension', fontsize=15)\nprint(\"Percentage of hypertenshion people and non-hypertension suffers from stroke\")\nprint(data.groupby('hypertension').stroke.apply(lambda x: (x == 1).mean()))","880a3e88":"fig = plt.figure(figsize=(7,7))\nsns.distplot(data['avg_glucose_level'], color=\"red\",  kde= True)\nplt.title('Distribution of Avg. Glucose Level', fontsize=15)\nplt.legend()","820f4fcd":"stroke = data[data['stroke']==1]['avg_glucose_level'].fillna(0.0).astype(float)\nstroke_no = data[data['stroke']==0]['avg_glucose_level'].fillna(0.0).astype(float)\nfig = ff.create_distplot([stroke, stroke_no], ['Stroke','No Stroke'], bin_size=0.65, curve_type='normal'\n                        ,colors =  ['#221F1F','green'])\nfig.update_layout(\n    title=\"Stroke distibution over avg glucose level\",\n    xaxis_title=\"Avg glucose level\",\n)\nfig.show()","888314f7":"plt.figure(figsize=(10,5))\nplt.xlim(-10,125)\nplt.xlabel('bmi')\nplt.ylabel('Density')\nsns.kdeplot(data['bmi'],shade=True)\nplt.title('Distribution of bmi', fontsize=15)\nplt.show()","97778c9a":"plt.figure(figsize=(12,10))\n\nsns.distplot(data[data['stroke'] == 0][\"bmi\"], color='green') \nsns.distplot(data[data['stroke'] == 1][\"bmi\"], color='red') \n\nplt.title('Stroke distibution over BMI ', fontsize=15)\nplt.xlim([-10,100])\nplt.show()","8990bc6f":"sns.catplot(x=\"heart_disease\", y=\"age\", order=[0, 1], data=data)\nplt.title(\"Distribution of heart disease w.r.t age\")\nsns.catplot(x=\"stroke\", y=\"age\", order=[0, 1], data=data)\nplt.title(\"Distribution of stroke w.r.t age\")","fd63d1d2":"sns.catplot(x=\"heart_disease\", y=\"age\", hue=\"stroke\",palette=\"pastel\", kind=\"bar\", data=data)\nprint(data.groupby('heart_disease').stroke.apply(lambda x: (x == 1).mean()))","cdcd78bc":"sns.catplot(x=\"heart_disease\", y=\"bmi\",hue='stroke' ,kind=\"box\", data=data)\nsns.catplot(x=\"heart_disease\", y=\"age\",hue='stroke' ,kind=\"box\", data=data)\nsns.catplot(x=\"heart_disease\", y=\"avg_glucose_level\",hue='stroke' ,kind=\"box\", data=data)","ad8c59d6":"plt.figure(figsize=(10,12))\nplt.subplot(3,1,1)\nsns.violinplot(x = 'hypertension', y=\"bmi\",hue='stroke', data = data)\nplt.subplot(3,1,2)\nsns.violinplot(x = 'hypertension', y = 'age',hue='stroke', data = data)\nplt.subplot(3,1,3)\nsns.violinplot(x = 'hypertension', y = 'avg_glucose_level',hue='stroke', data = data)\nplt.show()","327991e4":"sns.catplot(x=\"smoking_status\", y=\"bmi\",hue='stroke' ,aspect=1.7,kind=\"swarm\" ,data=data)\nsns.catplot(x=\"smoking_status\", y=\"age\",hue='stroke' ,aspect=1.7,kind=\"swarm\" ,data=data)\nsns.catplot(x=\"smoking_status\", y=\"avg_glucose_level\",hue='stroke' ,aspect=1.7,kind=\"swarm\" ,data=data)","9d0c483b":"sns.catplot(x=\"ever_married\", y=\"bmi\", hue='stroke',jitter=False, data=data)\nsns.catplot(x=\"ever_married\", y=\"age\", hue='stroke',jitter=False, data=data)\nsns.catplot(x=\"ever_married\", y=\"avg_glucose_level\", hue='stroke',jitter=False, data=data)","fd27f42a":"sns.catplot(x=\"Residence_type\", y=\"bmi\", hue='stroke',data=data)\nsns.catplot(x=\"Residence_type\", y=\"age\", hue='stroke', data=data)\nsns.catplot(x=\"Residence_type\", y=\"avg_glucose_level\", hue='stroke', data=data)","7937d0f6":"sns.catplot(x=\"work_type\", y=\"bmi\", hue='stroke', kind=\"boxen\",data=data)\nsns.catplot(x=\"work_type\", y=\"age\", hue='stroke', kind=\"boxen\",data=data)\nsns.catplot(x=\"work_type\", y=\"avg_glucose_level\", hue='stroke', kind=\"boxen\",data=data)","85e99227":"plt.figure(figsize=(10,12))\nplt.subplot(3,1,1)\nsns.scatterplot(data=data, x=\"age\", y=\"bmi\", hue='stroke')\nplt.subplot(3,1,2)\nsns.scatterplot(data=data, x=\"age\", y=\"avg_glucose_level\", hue='stroke')\nplt.subplot(3,1,3)\nsns.scatterplot(data=data, x=\"bmi\", y=\"avg_glucose_level\", hue='stroke')","ac00dd3b":"plt.figure(figsize=(15,8))\nsns.heatmap(data.corr(),cmap=\"Blues\");","5d132fff":"data.corr()","1164b855":"data.head(5)","675291b5":"encode = LabelEncoder()\ndata = data.apply(encode.fit_transform)\ndata.head()","3756af17":"data.info()","95ec7252":"data['bmi'].fillna((data['bmi'].mean()), inplace=True)\ndata.info()","4b2d0951":"data = data.drop('id', axis=1)\ny=data['stroke']\ndata = data.drop('stroke', axis=1)\ndata.head()","25c96fe9":"X_train, X_test, y_train, y_test = train_test_split(data, y, test_size=0.2, random_state=42)\nsm = SMOTE(random_state=42)\nX_res, y_res = sm.fit_resample(X_train, y_train)\nplt.figure(figsize=(12,6))\nplt.subplot(1,2,1)\ny_train.value_counts().plot(kind='bar')\nplt.title(\"Original distribution of training data\")\nplt.subplot(1,2,2)\ny_res.value_counts().plot(kind='bar')\nplt.title(\"Distribution of training data after balancing the classes\")","cfffa4e1":"# **2. Distribution of each categorical attribute w.r.t. continuous attribute having hue =stroke**","9ea4c665":"17% of person having heart  disease will also have stroke whereas 4% of the person that doesnot have heart disease will have stroke.","d38eae09":"Peope have high bmi suffer more from stroke","420888e8":"Person having age above 50 are highly probable to have heart disease as well as stroke.","74a88cb7":"# **1.Distribution of each attribute and its distribution w.r.t. stroke**","f3eae600":"# **Data Preprocesssing**","74ba9b2a":"Only 4.9% of people are affected by stroke so the data available to us is imbalanced and we need to balance it before giving to our machine learning algorithms.","cfcdcee3":"# **Dataset Description :**\n\n1) id: unique identifier\n\n2) gender: \"Male\", \"Female\" or \"Other\"\n\n3) age: age of the patient\n\n4) hypertension: 0 if the patient doesn't have hypertension, 1 if the patient has hypertension\n\n5) heart_disease: 0 if the patient doesn't have any heart diseases, 1 if the patient has a heart disease\n\n6) ever_married: \"No\" or \"Yes\"\n\n7) work_type: \"children\", \"Govt_jov\", \"Never_worked\", \"Private\" or \"Self-employed\"\n\n8) Residence_type: \"Rural\" or \"Urban\"\n\n9) avg_glucose_level: average glucose level in blood\n\n10) bmi: body mass index\n\n11) smoking_status: \"formerly smoked\", \"never smoked\", \"smokes\" or \"Unknown\"*\n\n12) stroke: 1 if the patient had a stroke or 0 if not","d4f8764d":"**Insights :\n1. Stroke has highest correlation with age.\n2. People having heart disease are more likely to have stroke.\n3. People having hypertension are probable to also suffer from stroke.\n4. Higher the amount of glucose, lesser chances to have stroke.\n5. Person having age above 50 are highly probable to suffer from stroke.**","f13ffe7c":"5.1% of male suffers from stroke whereas 4.7% of female suffer from stroke which means male are highly probable to suffer from stroke as compare to females.","9b6cb43e":"Person having glocose level less than 150 suffer more from stroke","e20b47a4":"People having age more than 50 are very very highly probable to suffer from stroke as compare to people having age less than 50.","bf4e5f63":"Let us drop the id as well as store stroke in another list","1c83a658":"From the above matrix and table, we can see that age is more correlated to stroke, after that heart disease and avg glucose label.","8f279de7":"As the data contains categorial feature so I will convert it into numerical value by doing encoding.","4f3eff77":"# 3. Distribution of each continuous attribute w.r.t. continuous attribue having hue =stroke","ad564a9d":"# **Data Analysis And Visualization**","9686280f":"As the classes are imbalanced so I will first split the data into train and test then I will balance the classes by first doing oversampling and then by downsampling.","441d3c4e":"As bmi feature contains NAN value so I will replace it with the mean of bmi featrue.","376bf46b":"# **Reading Data**","6e4d9ad4":"13.2% of people having hpertension also suffers from stroke where 3.9% of people having no hyperteension suffer from stroke. Person having hypertension is more likely to suffer from stroke.","35479b90":"Now our data is ready to give to any machine learning algorithm.","2ee2e7a5":"# **4. Correlation among the attributes**","0f585f2b":"# **Importing Libraries**"}}