{"cell_type":{"a7a6c484":"code","e4634c76":"code","5def859c":"code","4cf6daa7":"code","4e909285":"code","55ffb4b1":"code","20602159":"code","8b7ad11c":"code","4042873e":"code","32a96311":"code","a459ccd5":"code","4590c405":"code","6e5c3d32":"code","7ee160cc":"code","ae7546d2":"code","c7da699f":"code","8b38c4a4":"code","94194f35":"code","3f2ed4b9":"code","21b554e3":"code","05d65165":"code","b797ed6d":"code","00b6d705":"markdown","ba5acc90":"markdown","f4fb3057":"markdown","fc34cc3d":"markdown","622c40ba":"markdown","3928d937":"markdown","f0679343":"markdown"},"source":{"a7a6c484":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline","e4634c76":"df = pd.read_csv('..\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv')","5def859c":"df.head()","4cf6daa7":"df.info()","4e909285":"sns.heatmap(df.corr())","55ffb4b1":"sns.histplot(df, x = 'Annual Income (k$)')","20602159":"sns.histplot(df, x = 'Spending Score (1-100)')","8b7ad11c":"X= pd.get_dummies(df)","4042873e":"from sklearn.preprocessing import StandardScaler\nscaler= StandardScaler()\nscaled_X= scaler.fit_transform(X)\nscaled_X","32a96311":"from sklearn.cluster import KMeans\nmodel = KMeans(n_clusters = 2)\ncluster_labels = model.fit_predict(scaled_X)","a459ccd5":"cluster_labels","4590c405":"len(scaled_X)","6e5c3d32":"len(cluster_labels)","7ee160cc":"X['Cluster'] = cluster_labels","ae7546d2":"sns.heatmap(X.corr())","c7da699f":"X.corr()['Cluster'].sort_values()","8b38c4a4":"plt.figure(figsize=(15,6))\nX.corr()['Cluster'].sort_values().plot(kind='bar')","94194f35":"ssd= []\n\nfor k in range (2, 10):\n    model=KMeans(n_clusters=k)\n    \n    model.fit(scaled_X)\n    \n    ssd.append(model.inertia_)\nssd","3f2ed4b9":"plt.plot(range(2,10), ssd, 'o--')\nplt.xlabel('K Value')\nplt.ylabel('Sum of Squared Distances')","21b554e3":"pd.Series(ssd).diff()","05d65165":"pd.Series(ssd).diff().plot(kind='bar')","b797ed6d":"X","00b6d705":"# Data Preparing","ba5acc90":"# Choosing K Value","f4fb3057":"# Creating and Fitting a KMeans Model","fc34cc3d":"# K-Means Clustering\n### sometimes our data set hasn't any label, if we have label, each record of our data set has a column that shows a value of that record for example price of\n\n### a product, or degree of a student, or size of or score, these denote a value of that record. but sometimes we haven't any column that shows us a value of \n\n### that record, in Data Sicense we call that **Unsupervised Learning**\n\n\n### in this case i want to show you a alghoritm of Unsupervised that we call that **K-Means Clustring**","622c40ba":"#### in this time we must choose the best number of\n#### clusters. for evaluating the number of cluster\n#### we must use SSD(Sum of Squared Distance) to find out\n#### best number","3928d937":"# Scaling the Features\n#### Scaling in the K-Means Clustring is \n#### very important because we want to separate \n#### cluster besed on the distance","f0679343":"# EDA\n#### this time we must Explore about our data to \n#### find out the relation between features"}}