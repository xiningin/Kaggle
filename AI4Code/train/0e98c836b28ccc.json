{"cell_type":{"b1326d18":"code","2f91110a":"code","2b5c4c25":"code","4e46c2b1":"code","55858ae5":"code","9fb3dc88":"code","e04c9528":"code","34195dcf":"code","ec496554":"code","4d5936aa":"code","33d1afb9":"code","b18d34ab":"code","7fb9d853":"code","205bfa6e":"code","3efe16ae":"code","7ceef6fb":"code","174a7a32":"code","8aacd6b4":"code","ceb11322":"code","397f421a":"code","4798d3a6":"code","6892fdb2":"code","9215cbc7":"code","751d2656":"code","f72f3cea":"code","bd4a2319":"code","0d276f6b":"code","add8600e":"code","75918bdd":"code","38616fad":"code","10223280":"code","150afe74":"code","9c9a0997":"code","9f0bbf4a":"code","85803018":"code","13bca513":"code","ef87c084":"code","556d7de4":"code","a8fb686b":"code","1ae6bb12":"code","99ddd652":"code","a3e5ab8b":"code","a7e956b5":"code","cee8485a":"code","d3430525":"code","fe00d8c6":"code","6ecc1d46":"code","98c55a66":"code","5aac0c13":"code","f91441d5":"code","bf73c8a1":"markdown","4e2eaff4":"markdown","b5486496":"markdown","479c864c":"markdown","ef849178":"markdown","9b692e7b":"markdown","2d1a2267":"markdown","0a6fc124":"markdown","7c9df5d4":"markdown","9e359ac7":"markdown","894452f5":"markdown","e2b11b86":"markdown","a4424540":"markdown","a68964bc":"markdown","7eee0228":"markdown","8cb0d1c1":"markdown","2600b88c":"markdown","d54091d1":"markdown","24025114":"markdown","e7311a8e":"markdown","5e7d69aa":"markdown","9965887e":"markdown","4d93305c":"markdown","0dc9e6d4":"markdown","d5f04cf5":"markdown","68641911":"markdown","6ea9149a":"markdown","2f4a31b8":"markdown","f87bda16":"markdown","69dcca57":"markdown","5979dc23":"markdown","d256e2be":"markdown","ffd7e68e":"markdown","ae645f85":"markdown","fc9eecdf":"markdown","6c7c04ec":"markdown","02f55ed1":"markdown"},"source":{"b1326d18":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport os\nimport gc\n\n#sns color plalette.\nflatui = [\"#9b59b6\", \"#3498db\", \"#95a5a6\", \"#e74c3c\", \"#34495e\", \"#2ecc71\"]\ncolour = sns.color_palette(flatui)\n\n#Path for the directory\nPATH = '..\/input\/amexpert\/'","2f91110a":"#Reading the dataset.\ntrain = pd.read_csv(f'{PATH}train.csv')\ntest = pd.read_csv(f'{PATH}test_QyjYwdj.csv')\ncampaign_data = pd.read_csv(f'{PATH}campaign_data.csv')\ncoupon_item = pd.read_csv(f'{PATH}coupon_item_mapping.csv')\ncustomer_trans = pd.read_csv(f'{PATH}customer_transaction_data.csv')\nitem_data = pd.read_csv(f'{PATH}item_data.csv')\ncustomer_demo = pd.read_csv(f'{PATH}customer_demographics.csv')","2b5c4c25":"#train first 5 observations\ntrain.head()","4e46c2b1":"#shape of the dataset.\nprint(f'Train shape: {train.shape}')","55858ae5":"#function to get the number of unique items in a feature.\ndef get_unique(df, col=None):\n    assert col == None or type(col) == list, 'Either None or List.'\n    if col:\n        for i in col:\n            print(f'Unique items in {i} are {df[i].unique().shape[0]}')\n    else:\n        for col in df.columns:\n            print(f'Unique items in {col} are {df[col].unique().shape[0]}')","9fb3dc88":"#getting unique items in the data.\nget_unique(train, col=['id', 'campaign_id', 'coupon_id', 'customer_id'])","e04c9528":"#Distribution of the redemption_status.\nplt.figure(figsize=(7,5))\nsns.countplot(train.redemption_status, color=colour[0])","34195dcf":"#value count\ntrain.redemption_status.value_counts()","ec496554":"#imbalance ratio:\nprint('*'*70)\nprint(train.redemption_status.value_counts(normalize=True))\nprint('*'*70, '\\n')\nprint(f'Imbalance ratio: {train.redemption_status.value_counts()[1] \/ train.redemption_status.value_counts()[0]}')","4d5936aa":"#Campaign data.\ncampaign_data.head()","33d1afb9":"get_unique(campaign_data)","b18d34ab":"#Campaign type\nplt.figure(figsize=(7,5))\nsns.countplot(campaign_data.campaign_type, color=colour[1])","7fb9d853":"#Start date.\ncampaign_data.start_date.describe()","205bfa6e":"#End date.\ncampaign_data.end_date.describe()","3efe16ae":"#shape of the data.\ncampaign_data.shape","7ceef6fb":"#coupon item mapping\ncoupon_item.head()","174a7a32":"#unique data\nget_unique(coupon_item)","8aacd6b4":"#items data\nitem_data.head()","ceb11322":"#shape:\nitem_data.shape","397f421a":"#getting unique items from this data.\nget_unique(item_data)","4798d3a6":"#plotting brand_type\nplt.figure(figsize=(7,5))\nsns.countplot(item_data.brand_type, color=colour[2])","6892fdb2":"#brand category.\nplt.figure(figsize=(17,5))\nsns.countplot(item_data.category, color=colour[3])\nplt.xticks(rotation=90);","9215cbc7":"#lets merge the items data with coupon_item mapping.\ncoupon_item = coupon_item.merge(item_data, on='item_id', how='left')\ncoupon_item.head()","751d2656":"#shape\ncoupon_item.shape","f72f3cea":"#null values.\ncoupon_item.isnull().sum()","bd4a2319":"#category on which most coupons are given.\ngroup1 = coupon_item.groupby('category')['coupon_id'].agg('count').to_frame('count_coupons').reset_index().sort_values('count_coupons', ascending=False)\nplt.figure(figsize=(17,5))\nsns.barplot(group1.category, group1.count_coupons, color=colour[4])\nplt.xticks(rotation=90);","0d276f6b":"#brand on which most coupons are given.\n%time group2 = coupon_item.groupby('brand')['coupon_id'].agg('count').to_frame('count_coupons').reset_index().sort_values('count_coupons', ascending=False)\nplt.figure(figsize=(17,5))\nsns.barplot('brand', 'count_coupons',\n            data=group2.head(10), #considering only top 10\n            color=colour[5])\nplt.xticks(rotation=90);","add8600e":"#items on which most coupons are given.\n%time group3 = coupon_item.groupby('item_id')['coupon_id'].agg('count').to_frame('count_coupons').reset_index().sort_values('count_coupons', ascending=False)\nplt.figure(figsize=(17,5))\nsns.barplot('item_id', 'count_coupons', \n            data=group3.head(10), #considering only top 10\n            color=colour[0])\nplt.xticks(rotation=90);","75918bdd":"#brand_type on which most coupons are given.\n%time group4 = coupon_item.groupby('brand_type')['coupon_id'].agg('count').to_frame('count_coupons').reset_index().sort_values('count_coupons', ascending=False)\nplt.figure(figsize=(7,5))\nsns.barplot('brand_type', 'count_coupons', \n            data=group4,\n            color=colour[1])\n# plt.xticks(rotation=90);","38616fad":"#customer demographics.\ncustomer_demo.head()","10223280":"#shape\ncustomer_demo.shape","150afe74":"#unique_items.\nget_unique(customer_demo)","9c9a0997":"#frequency of age range\nplt.figure(figsize=(8,5))\nsns.countplot(customer_demo.age_range, color=colour[2])","9f0bbf4a":"#marital status.\ncustomer_demo.marital_status.value_counts(dropna=False)","85803018":"#rented\nplt.figure(figsize=(7, 5))\nsns.countplot(customer_demo.rented, color=colour[3])","13bca513":"#family size.\n#rented\nplt.figure(figsize=(7, 5))\nsns.countplot(customer_demo.family_size, color=colour[4])","ef87c084":"#number of childrens\n#rented\nplt.figure(figsize=(7, 5))\nsns.countplot(customer_demo.no_of_children, color=colour[4])","556d7de4":"#number of childrens\n#rented\nplt.figure(figsize=(7, 5))\nsns.countplot(customer_demo.income_bracket, color=colour[4])","a8fb686b":"#null values present in this data.\ncustomer_demo.isnull().sum()","1ae6bb12":"#Customer Transaction data.\ncustomer_trans.head()","99ddd652":"#number of unique items\nget_unique(customer_trans)","a3e5ab8b":"#distribution of quantity\nsns.distplot(customer_trans.quantity, bins=50);","a7e956b5":"#description\ncustomer_trans.quantity.describe()","cee8485a":"#subsetting.\nhigh_order = customer_trans.loc[customer_trans.quantity >= 50]\nhigh_order.sort_values('quantity', ascending=False, inplace=True)\nhigh_order.head()","d3430525":"#selling price.\ncustomer_trans.selling_price.describe()","fe00d8c6":"#selling price distribution.\nsns.distplot(np.log1p(customer_trans.selling_price), bins=20)","6ecc1d46":"#other discount.\ncustomer_trans.other_discount.describe()","98c55a66":"#coupon discount.\ncustomer_trans.coupon_discount.describe()","5aac0c13":"#distribution\nsns.distplot(abs(customer_trans.coupon_discount))","f91441d5":"#shape of the dataset.\ncustomer_trans.shape","bf73c8a1":"This data is in negative which seems alright as the discounted price will be reduced from the selling price.","4e2eaff4":"The unique campaign held are 28 which seems right as there are 18 campaigns in the train data and 10 campaigns in the test data. This means that we have data for all the campaigns held in the dataset.","b5486496":"Looks like a ordinal categorical variable. An ordinal variable is a variable which has an order of importance or ranking to it. Customer with 2 members in the family including themselves are the ones who order from the store the most.","479c864c":"Will talk about features not mentioned previously.\n1. campaign_type: Type  of the campaign X or Y. The exact meaning not known and is not needed.\n2. start_date : Start date of the campaign.\n3. end_date: End date of the campaign.\n\nFrom the first five observation we can see that the campaign last for 1 or 2 months.","ef849178":"Most of the customers falls in the age range of 46-55. Given the types of items sold by the ABC company such as Groceries, Pharmaceuticals, it only make sense that ther customers will mostly be middle aged group as can bee seen from the graph above.","9b692e7b":"This is the history of the customers transactions on the store.\n1. date: Date of transaction.\n2. quantity: amount of an item bought.\n3. selling_price :price at which an item was sold.\n4. other_discount: Discount from sources.\n5. coupon_discount: Discount availed from retailer coupons.","2d1a2267":"Most of the customers belong to Income bracket 5 followed by 4.","0a6fc124":"Self explainatory. The number of childrens a customer is having. Categorica feature. The data also contains NAN values and it is possible that the customers having NAN in the chidrens columns actually do no have any childrens.","7c9df5d4":"Item 56523 is present in most of the coupons. The rest of the 9 items distribution is almost the same.","9e359ac7":"I do not know if this data is accurate or not as many customers will not provide correct information but the above plot shows that most of the customers live in a rented apartment.\n\nAgain this may not be a good or relevant feature to use here but it is just my assumption and I need to check it.\n","894452f5":"> Consists of 78369 observations.","e2b11b86":"# Exploring the dataset.\n\nThe goal here will be to explore each dataset carefully and then deduce some insights from it and understand the data better which will help us in our later part of feature engineering and feature selection.","a4424540":"We have a very few couponn redemption. Heavily imbalanced dataset.","a68964bc":"Here are the unique items in a particular columns. As we can see the campaign_id consists of only 18 campaigns as said in the data description.\n> Based on previous transaction & performance data from the last 18 campaigns, predict the probability for the next 10 campaigns in the test set for each coupon and customer combination, whether the customer will redeem the coupon or not?","7eee0228":"This set contains more information on the items which were present in the coupon item mapping dataset.\n1. brand : brand to which an item belong.\n2. brand_type: type\/status of brand.\n3. category : category to which the brand belongs.","8cb0d1c1":"Mappings of items with the coupons.","2600b88c":"The quantity value is ranging from 1 to upto 80000. This seems very odd. Who will buy 80000 items in one order.","d54091d1":"The quantity of an item with id 49009 is 896338 which does not look correct. There must be something wrong in this data.","24025114":"Most of the coupons are given on Established brands. It make sense that the established brand will have most redemption ratio than the local brands. But this is only an assumption. We will check on this assumption later.","e7311a8e":"Lets us now check which of the items for which the coupon is given belongs to what category.","5e7d69aa":"We have information for all the items present in the coupon item mapping data.","9965887e":"We have a highly imbalanced dataset. The ratio of imbalancess is not clear from the graph. Lets see some hard numbers.","4d93305c":"As we can see there are 760 customers for whihc the demographics are present.","0dc9e6d4":"Most of the item belongs to the Grocery and Pharmaceuticals category.","d5f04cf5":"Lets check for any nul values. Presence of null values will indicate that the information for the particular item present in the coupon item mapping dataset is not present in the items dataset.","68641911":"# AmExpert EDA and Insights.\n\n**Problem Statement: **\nThe goal here in this problem is to successfully predict which customers will redeem which coupons assigned to them in a given campaign across various channels.\n\nThe data is divided into multiple csv files each holding unique information about the part of the problem we are trying to solve.\n\nThe dataset consist of 8 files namely:\n1. campaign_data.csv : Information about the campaign held by the company. (campaign_id)\n2. coupon_item_mapping.csv : Mapping the coupon data with the item data. (coupon_id, item_id)\n3. customer_demographics.csv : Demographics of the customers. (customer_id)\n4. customer_transaction_data.csv : Transactions of the customers during the campaign period. (customer_id)\n5. item_data.csv : information about the items sold in the campaign. (item_id)\n6. train.csv and test.csv : Training and Testing data consisting of some features and our target variable(redemption_status).\n7. sample_submission.csv : sample submission file for final prediction. - 0.5 AUC without creating any model.","6ea9149a":"The coupons are given the most for the grocery items followed by pharmaceuticals and natural products.<br>\nWe yet do not know how many of these coupons are redeemed by the customers which we will explore later.","2f4a31b8":"The start date and end date here are of type string. The top index shows us the most number of occurence of a value in the feature and the feq gives us the frequency of occurence of that value.","f87bda16":"We can see that there are 74066 total items sold by the store and not all the items are present in the coupon item mapping dataset.\nThis is made clear from the data description page that the coupons can be availed for some items only.","69dcca57":"Information for about 329 customer regarding their marital status is not present. Most married people are using the services of the ABC company.","5979dc23":"This dataset contain information about the customers of the ABC company. All the information are not present in the dataset as it is mentioned in the data description and as we can see from the first five observations (NANs present).\n1. age_range : age bracket under which the customer falls.\n2. marital_status: Married\/ single.\n3. rented: Accomodation rented or not. How did they collect this data and why?. It does not seem to me that this column will be of any use here as it is irrelevant information. But we cannot conclude on it yet. We need to check it first.\n4. family_size: size of the family.\n5. no_of_childrens: childrens if any.\n6. income_bracket: Label encoded as descriped in the description with higher number indicating higher income.\n\nMany of the columns here seems to me as irrelevant and will be a noise to the model. But this needs to be verified first by creating a model and plotting the feature importances. Or we can use any other method such as the correlation of these features with the response variable.","d256e2be":"Most of the coupons are given on brand 56. Comparitvely the highest. There is a vast difference in the coupon applied on brand 56 and the rest of the brands.<br>\nAgain we do not know how many of these coupons are redeemed by the customer. We wil look into that later. I promise!","ffd7e68e":"We can create new features from this dataset such as number of monhs the campaign lasted, number of days the campaign lasted, Day of week when the campaign started\/ended, month of campaign start\/end so on and so forth.","ae645f85":"Let us first explore the train dataset.","fc9eecdf":"The imbalance ratio is 0.009. The percent of each value in the column is shown above with 0 have 99% distribution and 1 with only 0.009%.","6c7c04ec":"This dataset consist of 5 columns. The id column is a unique id for each entry or observation in the dataset.\n1. campaign_id : Ids of Campaign held by the company. 18 campaigns data. \n2. coupon_id : coupons offered during campaigns. \n3. customer_id : Ids representing the custmoers.\n4. redemption_status : Target variable, whether the coupon was redeemed by the user\/customer.","02f55ed1":"there are 1116 coupons and 36289 items in this dataset."}}