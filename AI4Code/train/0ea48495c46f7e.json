{"cell_type":{"9f91e30b":"code","007209e6":"code","7fb78ad6":"code","0b270650":"code","8dc239a1":"code","6a6eceaa":"code","cf01e834":"code","3c843a62":"code","74dc6e5c":"code","9c71b79e":"code","dba30399":"code","e7139c32":"code","2273722d":"code","b0fb0dda":"code","cc19da2c":"code","9bf70d12":"code","01301725":"markdown","826d70f2":"markdown","da8c1339":"markdown","d8695134":"markdown","bcc5bf00":"markdown","52d289b6":"markdown","092a5be1":"markdown","f9e0f9ce":"markdown","1079aef5":"markdown","269634c9":"markdown","b46d8b88":"markdown","d798bce9":"markdown","f48ae2a9":"markdown","287bab0b":"markdown","14e4d36f":"markdown","85afc2f0":"markdown","68eda54f":"markdown","b1aece88":"markdown","2734f3f0":"markdown","60e94417":"markdown","6c549eee":"markdown","5ba3eefb":"markdown","fb7c6360":"markdown","a0ca87c0":"markdown","cc7b0f9c":"markdown","bc517765":"markdown","73253bf1":"markdown"},"source":{"9f91e30b":"# The basic imports\nimport numpy as np\nimport pandas as pd\nimport os\nprint(os.listdir(\"..\/input\"))\nfrom tqdm import tqdm","007209e6":"from textblob import TextBlob","7fb78ad6":"example = \"This is a wonderful product. I got amazing results by using it\"\nblob = TextBlob(example) # create the TextBlob object for this example","0b270650":"blob.sentiment","8dc239a1":"example = \"This is a terrible product. I would not recommend using it\"\nblob = TextBlob(example)\nblob.sentiment","6a6eceaa":"# Polarity\nblob.sentiment.polarity","cf01e834":"# Subjectivity\nblob.sentiment.subjectivity","3c843a62":"example = \"Jupiter is the largest planet in the Solar System\"\nblob = TextBlob(example)\nblob.sentiment","74dc6e5c":"train = pd.read_csv('..\/input\/drugsComTrain_raw.csv')\n\n# Inspect first 5 rows\ntrain.head(5)","9c71b79e":"train.shape","dba30399":"reviews = train[\"review\"]\nprint(reviews[:10]) # First 10","e7139c32":"sentiments = []\nfor review in tqdm(reviews):\n    blob = TextBlob(review)\n    sentiments += [blob.sentiment.polarity]","2273722d":"train[\"sentiment\"] = sentiments","b0fb0dda":"train.sample(10)","cc19da2c":"np.corrcoef(train[\"rating\"], train[\"sentiment\"])","9bf70d12":"import matplotlib.pyplot as plt\nimport seaborn as sns\nsns.boxplot(x=np.array(train[\"rating\"]),y=np.array(train[\"sentiment\"]))\nplt.xlabel(\"Rating\")\nplt.ylabel(\"Sentiment\")\nplt.title(\"Sentiment vs Ratings\")\nplt.show()","01301725":"**For our application, polarity is more useful than subjectivity**. We will ignore subjectivity for the time being as we are looking at reviews and they're all fundamentally subjective","826d70f2":"Using the `sentiment` method spits out 2 numbers - Polarity and Subjectivity. Polarity ranges from -1 to +1. This is a positive review so the polarity is close to 1. Subjectivity ranges from 0 to 1 with 0 for objective\/factual sentences and +1 for highly opinionated ones. \n\nLet's look at a negative example","da8c1339":"We'll use tqdm to track our progress. It can take a while to calculate the sentiment for 160K samples","d8695134":"Let's randomly sample 10 rows from the data and see what we got","bcc5bf00":"The first step is to create a TextBlob object. This object is created by passing a simple string. This object is the representation that textblob uses for the given \"blob\" of text under the hood. It parses the text to let us extract the sentiment or other useful metrics from the sentence.\n\nConsider a simple dummy review which could be a highly positive one. Note that there are 2 sentences here in the review. ","52d289b6":"# Introduction","092a5be1":"The sentiment is -1 now, indicating that is a negative review. Note that the subjectivity is still high as it is still an opinion and not a fact","f9e0f9ce":"Notice that the sentiment values, even for reviews with high ratings tend to be low. This happens because the reviews are **long**. Sentiment analysis works best for short sentences with an obvious sentiment. It is less effective when we have several neutral sentences along with ones with high polarity. The neutral sentences dillute the overall polarity of the text.","1079aef5":"## Extract sentiments for all these reviews!","269634c9":"Once the TextBlob object is created, extracting the sentiment is a single command.","b46d8b88":"This was a very simple intro to sentiment analysis. We note that the sentiments calculated are only weakly correlated with the ratings, suggesting that there is a lot of room for improvement. A few basic steps that can be taken to improve our sentiment calculation are:\n\n1. Pre-processing: Clean up the text. Do stemming\/lemmatization. Remove stop words\n2. Remove neutral sentences - Do sentiment analysis of individual sentences in a review and remove neutral ones. Then re-run the sentiment analysis on the polar sentences. This will give a more accurate sentiment score\n\nWe would still run into a few road blocks. Some of the harder to solve problems where naive sentiment analysis struggles are:\n\n1. Double negations \n2. Irony or Sarcasm\n3. Idioms, pop culture references. \n\nAnalyzing these would require more advanceed NLP techniques and is an active research field.","d798bce9":"The sentence above is a neutral, factual sentence with no sentiment. Hence it has 0 polarity and 0 subjectivity.","f48ae2a9":"Let's see if the newly calculated sentiments have any correlation with the ratings. Our hypothesis would be that reviews with postive reviews would have higher polarity values and vice-versa. ","287bab0b":"**I hope that you find this kernel useful and informative! Play around with textblob to get an idea of its capabilities and limitations. All the best!**","14e4d36f":"We will do this analysis using the open source library called [TextBlob](https:\/\/textblob.readthedocs.io\/en\/dev\/quickstart.html), which is a really easy to use Natural Language Processing library written on top of a powerful but relatively harder to use framework called [NLTK](https:\/\/www.nltk.org\/). TextBlob let's us do our sentiment analysis really fast without having to write a lot of code.\n\nLet's start by importing TextBlob. It comes pre-loaded in Kaggle kernels. ","85afc2f0":"## Add this list of sentiments to the original dataframe","68eda54f":"# Let's try it on our data","b1aece88":"## Improving the sentiment analysis","2734f3f0":"# The TextBlob library","60e94417":"# Correlation with ratings","6c549eee":"The data has over 160K rows. Let's extract the review column for the sentiment analysis.","5ba3eefb":"Finally let's look at a neutral sentence with no sentiment","fb7c6360":"Sentiment Analysis is the identification of the sentiment associated with a sentence, phrase or an entire document. Since we are dealing with reviews of drugs here, we would certainly be interested in understanding the sentiment associated with these reviews and try to see which drugs have positive reviews and which ones have negative reviews. \n\nIdentifying the sentiment of a review can help us make an attempt at predicting the rating that the user would give to the given product","a0ca87c0":"## Visualizing the correlation","cc7b0f9c":"We observe that there is indeed a positive but not very strong correlation between the sentiment of the reviews and the ratings given (0.35). Although the correlation is weak, it is still a useful feature for us to make predictions from as it isn't close to 0. ","bc517765":"We notice a gentle upward slope for median sentiment for each of the rating buckets","73253bf1":"One can extract the individual components as follows:"}}