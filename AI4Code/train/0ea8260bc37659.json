{"cell_type":{"99510de2":"code","ae1f749c":"code","98f21c5a":"code","1ad52e57":"code","0d2eeb27":"code","61573d0e":"code","a2c2d81a":"code","758196c8":"code","b0d7e37a":"code","0b153fa6":"code","2d159286":"code","ea94dccc":"code","b73aa4fd":"code","e1d7204a":"code","496011f5":"code","00e579a6":"code","d70c015e":"code","24a285a5":"code","8064600c":"code","b6a06e3f":"code","3bc419f0":"code","29c16b01":"code","bef8521c":"code","279f77ca":"code","94f98af5":"code","bd79fe54":"code","41c1f0c6":"code","59d1affb":"code","d16bbc16":"markdown","b69c994d":"markdown","6e2851db":"markdown","a791354e":"markdown","aa636b44":"markdown","78dbe25b":"markdown","53718cfb":"markdown","bbb6abe5":"markdown","f7dd0b1f":"markdown","d7c21545":"markdown","0250fed9":"markdown","ff99fe86":"markdown","c506fa65":"markdown","d50233de":"markdown","eab16548":"markdown","991f0243":"markdown","fa13828f":"markdown","4f8f5cfe":"markdown","c1c09cc1":"markdown","71c7404d":"markdown","81d47f1f":"markdown","56393dd8":"markdown","491e8d93":"markdown"},"source":{"99510de2":"import pandas as pd\nimport numpy as np\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.preprocessing import StandardScaler\n\n#Models\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.neural_network import MLPClassifier\nfrom sklearn.ensemble import RandomForestClassifier, GradientBoostingClassifier\n\nfrom sklearn.metrics import accuracy_score, confusion_matrix, f1_score\n\nimport warnings \nwarnings.filterwarnings('ignore')\n","ae1f749c":"data = pd.read_csv('..\/input\/mri-and-alzheimers\/oasis_longitudinal.csv')\ndata.head(10)","98f21c5a":"data = data.loc[data['Visit']==1]          #Only look at first visit\ndata = data.reset_index(drop=True)         #reset index after filtering first visit data","1ad52e57":"data.info()","0d2eeb27":"data = data[['Group', 'M\/F', 'Age', 'EDUC', 'SES',\n            'MMSE', 'CDR', 'eTIV', 'nWBV', 'ASF']]\ndata.rename(columns={'M\/F':'Gender'}, inplace=True)\ndata.head()","61573d0e":"#Check for missing values\ndata.isna().sum()","a2c2d81a":"data['SES'].value_counts()","758196c8":"data['SES'] = data['SES'].fillna(2.0)","b0d7e37a":"data.isna().sum().sum()","0b153fa6":"#Binary encode object columns\ndata['Group'] = data['Group'].apply(lambda x: 1 if x == 'Demented' else 0)\ndata['Gender'] = data['Gender'].apply(lambda x: 1 if x == 'M' else 0)","2d159286":"data.head(10)","ea94dccc":"data = data.astype('float64')\nprint(data.dtypes)","b73aa4fd":"data.describe()","e1d7204a":"corr = data.corr()\nplt.figure(figsize=(12,6))\nsns.heatmap(corr, annot=True, vmin=-1)\nplt.show()","496011f5":"demented_group = data[data['Group']==1]['Gender'].value_counts()\ndemented_group = pd.DataFrame(demented_group)\ndemented_group.index=['Male', 'Female']\ndemented_group.plot(kind='bar', figsize=(8,6))\nplt.title('Gender vs Dementia', size=16)\nplt.xlabel('Gender', size=14)\nplt.ylabel('Patients with Dementia', size=14)\nplt.xticks(rotation=0)\nplt.show()","00e579a6":"plt.figure(figsize=(8,6))\nsns.scatterplot(x='Age', y='nWBV', data=data, hue='Group')\nplt.title('Age vs Normalized Whole Brain Volume', size=16)\nplt.xlabel('Age', size=14)\nplt.ylabel('Normalized Whole Brain Volume', size=14)\nplt.show()","d70c015e":"plt.figure(figsize=(8,6))\nsns.scatterplot(x='Age', y='CDR', data=data, hue='Group')\nplt.title('Clinical Dementia Rating vs Dementia', size=16)\nplt.xlabel('Age', size=14)\nplt.ylabel('Clinical Dementia Rating',size=14)\nplt.show()","24a285a5":"#print('Nondemented Group: \\n',data.query('Group == 0')['MMSE'].value_counts().sort_values())\n#print('Demented Group: \\n',data.query('Group == 1')['MMSE'].value_counts().sort_values())","8064600c":"plt.figure(figsize=(10,6))\nsns.kdeplot(x='MMSE', shade=True, hue='Group', data=data)\nplt.title('Distrubtion of MMSE scores in Demented and Nondemented Patients', size=16)\nplt.xlim(data['MMSE'].min(), data['MMSE'].max())\nplt.xlabel('MMSE Score', size=14)\nplt.ylabel('Density of Scores', size=14)\nplt.show()","b6a06e3f":"plt.figure(figsize=(10,6))\nsns.kdeplot(x='EDUC', shade=True, hue='Group', data=data)\nplt.title('Years of Education vs Dementia', size=16)\nplt.xlabel('Education (years)', size=14)\nplt.ylabel('Density', size=14)\nplt.show()","3bc419f0":"def preprocessing_inputs(df):\n    df = df.copy()\n    \n    #split df into X and y\n    y = df['Group']\n    X = df.drop(['Group', 'ASF'], axis=1)\n    \n    #Train-test split\n    X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=1)\n    \n    #Scale X\n    scaler = StandardScaler()\n    scaler.fit(X_train)\n    \n    X_train = pd.DataFrame(scaler.transform(X_train), index=X_train.index, columns=X_train.columns)\n    X_test = pd.DataFrame(scaler.transform(X_test), index=X_test.index, columns=X_test.columns)\n    \n    return X_train, X_test, y_train, y_test","29c16b01":"X_train, X_test, y_train, y_test = preprocessing_inputs(data)\n\nprint('Train set:', X_train.shape, y_train.shape)\nprint('Test set:', X_test.shape, y_test.shape)","bef8521c":"X_train.head()","279f77ca":"models = {'         Logistic Regression': LogisticRegression(),\n          '                         KNN': KNeighborsClassifier(),\n          '    Decision Tree Classifier': DecisionTreeClassifier(),\n          '              Neural Network': MLPClassifier(),\n          '    Random Forest Classifier': RandomForestClassifier(),\n          'Gradient Boosting Classifier': GradientBoostingClassifier()}\n\nfor name, model in models.items():\n    model.fit(X_train, y_train)\n    print(name + ' trained.')","94f98af5":"for name, model in models.items():\n    yhat = model.predict(X_test)\n    acc = accuracy_score(y_test, yhat)\n    print(name + ' Accuracy: {:.2%}'.format(acc))","bd79fe54":"for name, model in models.items():\n    yhat = model.predict(X_test)\n    f1 = f1_score(y_test, yhat, pos_label=1)\n    print(name + ' F1-Score: {:.5}'.format(f1))","41c1f0c6":"logreg = LogisticRegression()\nlogreg.fit(X_train, y_train)\n\ndef plot_confusion_matrix(y_test, yhat):\n    cm = confusion_matrix(y_test, yhat)\n    ax= plt.subplot()\n    sns.heatmap(cm, annot=True, ax=ax, fmt='g', cmap=plt.cm.Blues, cbar=False);\n    ax.set_xlabel('Predicted labels')\n    ax.set_ylabel('True labels')\n    ax.set_title('Confusion Matrix', size=16); \n    ax.xaxis.set_ticklabels(['Nondemented', 'Demented']); ax.yaxis.set_ticklabels(['Nondemented', 'Demented'])","59d1affb":"logreg = LogisticRegression()\nlogreg.fit(X_train, y_train)\nyhat = logreg.predict(X_test)\nplt.figure(figsize=(8,6))\nplot_confusion_matrix(y_test, yhat)","d16bbc16":"### Relationship Between Education Years and Dementia","b69c994d":"| Feature     | Description                         |\n| ----------- | ----------------------------------- |\n| ID          | Identification                      |\n| Group       | Demented or Nondemented             |\n| Visit       | The visit number                    |\n| M\/F         | Gender                              |\n| Hand        | Dominant Hand                       |\n| Age         | Age in years                        |\n| Educ        | Years of Education                  |\n| SES         | Socioeconomic Status                |\n| MMSE        | Mini Mental State Examination       |\n| CDR         | Clinical Dementia Rating            |\n| eTIV        | Estimated Total Intracranial Volume |\n| nWBV        | Normalize Whole Brain Volume        |\n| ASF         | Atlas Scaling Factor                |\n| Delay       | Delay                               |","6e2851db":"# Getting Started\nIn this classification I will be using the longtiduinal study. This set consists of a longitudinal collection of 150 subjects aged 60 to 96. Each subject was scanned on two or more visits, separated by at least one year for a total of 373 imaging sessions. For each subject, 3 or 4 individual T1-weighted MRI scans obtained in single scan sessions are included. The subjects are all right-handed and include both men and women. 72 of the subjects were characterized as nondemented throughout the study. 64 of the included subjects were characterized as demented at the time of their initial visits and remained so for subsequent scans, including 51 individuals with mild to moderate Alzheimer\u2019s disease. Another 14 subjects were characterized as nondemented at the time of their initial visit and were subsequently characterized as demented at a later visit.","a791354e":"### Relationship Between Age and Normalized Whole Brain Volume","aa636b44":"### Relaionship between gender and dementia","78dbe25b":"## Data Preproccessing","53718cfb":"# Model Results","bbb6abe5":"## EDA Conclusions\n* In this dataset, it appears that there is a higher rate of dementia in males than females.\n* Normalized Whole Brain Volume (nWBV) has a negative correlation with age in general, however, this correlation seems more pronunced in dementia patients.\n* Clinical Dementia Rating (CDR) showed clear distinctions between demented and nondemented patients. Regardless of age, CDR seems to be a robust measure of dementia as, almost all patients with dementia showed a CDR score >= 0.5. Similarly, MMSE scores also show a distinction between the two groups. The MMSE scores for demented patients were much more spread out, ranging from 17-26, while nondemented individuals showed little varitation in MMSE score ranging from 26-30. Although we see a differnece in scores between demented and nondemented individuals the CDR seems to be much more robust than MMSE.\n* Demented patients had less years of education in general as compared to nondemented patients. These findings align with many studies which have also demonstarted that less education is greater risk factor for AD (Sharp & Gatz, 2011).\n* The relationship between Atlast Scoring Factor (ASF) and estimated total intracranial volume (eTIV) was almost 1-1. This is because ASF is the volume-scaling factor necessary to fit each individual. The ASF should be proportionate to TIV since atlas normalization equalizes head size(Buckner et al., 2004). Considering this, I do not feel ASF will be neccessary for our model.","f7dd0b1f":"# References\n\n1. Buckner RL, Head D, Parker J, Fotenos AF, Marcus D, Morris JC, Snyder AZ. A unified approach for morphometric and functional data analysis in young, old, and demented adults using automated atlas-based head size normalization: reliability and validation against manual measurement of total intracranial volume. Neuroimage. 2004 Oct;23(2):724-38. doi: 10.1016\/j.neuroimage.2004.06.018. PMID: 15488422.\n\n2. Sharp, E. S., & Gatz, M. (2011). Relationship between education and dementia: an updated systematic review. Alzheimer disease and associated disorders, 25(4), 289\u2013304. https:\/\/doi.org\/10.1097\/WAD.0b013e318211c83c","d7c21545":"# Data Cleaning","0250fed9":"### Relationship Between CDR and Dementia","ff99fe86":"# Packages & Libraries\n","c506fa65":"# Alzheimer's Exploratory Data Analysis","d50233de":"# Load Data","eab16548":"# Model Training","991f0243":"### Description of Features","fa13828f":"### F1-Score","4f8f5cfe":"# Alzheimer's Disease Classification\n## Overview:\n* Load and clean data.\n* Exploratory Data Analysis.\n* Preprocess data.\n* train several models and determine the best.\n* Visualize results with confusion  matrix","c1c09cc1":"Socioeconomic Status is a categorical feature, therefore, we will fill in missing values with the mode.","71c7404d":"# Confusion Matrix","81d47f1f":"Group: 0 = Nondemented, 1 = Demented","56393dd8":"### Relationship between MMSE and Dementia","491e8d93":"### Accuracy Score"}}