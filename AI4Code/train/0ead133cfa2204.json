{"cell_type":{"ba7bdda8":"code","225af478":"code","8f707d15":"code","85a3665f":"code","c84a4c72":"code","6bd9232f":"code","8685a827":"code","df5b81c4":"code","a9db3e98":"code","0c4d286e":"code","50e4f0c6":"code","870a8aa3":"code","11397a1f":"code","1c4b40df":"code","2b7a44f3":"code","f9e46eb6":"code","f6911d30":"code","70267548":"code","de001d1c":"code","7202fd7c":"code","036e1081":"code","4a21b0fc":"code","5aab92b6":"code","a9f6047e":"code","8e3c4d05":"code","e4e40103":"code","67c738ff":"code","0391de81":"code","4ad79511":"code","41132316":"code","e87eef75":"code","bd22763d":"markdown","5211802b":"markdown","4757c6a7":"markdown","b9762503":"markdown","6fd3cb8b":"markdown","f59bc015":"markdown","64e25b98":"markdown","56d024f0":"markdown","ff48d790":"markdown","8f4bd706":"markdown","c16b33ab":"markdown","72c5e49a":"markdown","1dac2c71":"markdown","91630a12":"markdown","481db846":"markdown","6f5994c7":"markdown","fa8ba055":"markdown"},"source":{"ba7bdda8":"pip install auto-sklearn","225af478":"pip install xlrd","8f707d15":"pip install autoviz","85a3665f":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom sklearn import preprocessing\nfrom sklearn.model_selection import train_test_split\nfrom autosklearn.classification import AutoSklearnClassifier","c84a4c72":"df= pd.read_csv('..\/input\/fetal-health-classification\/fetal_health.csv')\ndf.head()","6bd9232f":"df.info()","8685a827":"df.describe().T","df5b81c4":"df.isna()","a9db3e98":"df.isna().sum(axis=0)","0c4d286e":"from autoviz.AutoViz_Class import AutoViz_Class\nAV = AutoViz_Class()\ntarget='fetal_health'\ndfv = AV.AutoViz(filename=\"\",sep=',', depVar=target, dfte=df, header=0, verbose=1, \n                 lowess=False, chart_format='svg', max_rows_analyzed=150000, max_cols_analyzed=30)","50e4f0c6":"import pandas_profiling as pp\npp.ProfileReport(df)","870a8aa3":"sns.countplot(df['fetal_health'],label=\"Count\")","11397a1f":"plt.figure(figsize=(20,10))\nsns.heatmap(df.corr(), annot=True, fmt='.0%')","1c4b40df":"X=df.drop([\"fetal_health\"],axis=1)\ny=df[\"fetal_health\"]","2b7a44f3":"X[:5]","f9e46eb6":"y[:5]","f6911d30":"col_names = list(X.columns)\ns_scaler = preprocessing.StandardScaler()\nX_df= s_scaler.fit_transform(X)\nX_df = pd.DataFrame(X_df, columns=col_names)   \nX_df.describe().T","70267548":"X_df.head()","de001d1c":"x_train, x_test, y_train, y_test = train_test_split(X_df, y, test_size=0.25, random_state=23)","7202fd7c":"print(f'Training Shape x:',x_train.shape)\nprint(f'Testing Shape x:',x_test.shape)\nprint('*****___________*****___________*****')\nprint(f'Training Shape y:',X_df.shape)\nprint(f'Testing Shape y:',y.shape)","036e1081":"%time\n# time_left_for_this_task : Time limit in seconds to find the optimal configuration\n# per_run_time_limi : Time limit in seconds for the each model\n# ensemble_size: Number of models added to the Ensemble model\n# initial_configurations_via_metalearning: \"k\" configurations to start the Bayesian Optimization\nmodel = AutoSklearnClassifier(time_left_for_this_task=300, \n                              per_run_time_limit=9, \n                              ensemble_size=1, \n                              initial_configurations_via_metalearning=0)\n# Init training\nmodel.fit(x_train, y_train)","4a21b0fc":"model.score(x_train, y_train)","5aab92b6":"model.score(x_test, y_test)","a9f6047e":"print(model.sprint_statistics())","8e3c4d05":"from sklearn.metrics import confusion_matrix, accuracy_score\ny_pred = model.predict(x_test)\ncm = confusion_matrix(y_test, y_pred)\nprint(f'CM:',cm)\nprint(f'Accuracy:',accuracy_score(y_test, y_pred)* 100 ,'%')","e4e40103":"conf_matrix = confusion_matrix(y_pred, y_test)\n\nprint(f'Confussion Matrix: \\n{conf_matrix}\\n')\n\nsns.heatmap(conf_matrix, annot=True)","67c738ff":"tn = conf_matrix[0,0]\nfp = conf_matrix[0,1]\ntp = conf_matrix[1,1]\nfn = conf_matrix[1,0]\n\ntotal = tn + fp + tp + fn\nreal_positive = tp + fn\nreal_negative = tn + fp","0391de81":"accuracy  = (tp + tn) \/ total # Accuracy Rate\nprecision = tp \/ (tp + fp) # Positive Predictive Value\nrecall    = tp \/ (tp + fn) # True Positive Rate\nf1score  = 2 * precision * recall \/ (precision + recall)\nspecificity = tn \/ (tn + fp) # True Negative Rate\nerror_rate = (fp + fn) \/ total # Missclassification Rate\nprevalence = real_positive \/ total\nmiss_rate = fn \/ real_positive # False Negative Rate\nfall_out = fp \/ real_negative # False Positive Rate\n\nprint(f'Accuracy    : {accuracy}')\nprint(f'Precision   : {precision}')\nprint(f'Recall      : {recall}')\nprint(f'F1 score    : {f1score}')\nprint(f'Specificity : {specificity}')\nprint(f'Error Rate  : {error_rate}')\nprint(f'Prevalence  : {prevalence}')\nprint(f'Miss Rate   : {miss_rate}')\nprint(f'Fall Out    : {fall_out}')","4ad79511":"from sklearn.metrics import classification_report\nprint(classification_report(y_pred, y_test))","41132316":"import joblib","e87eef75":"joblib.dump(model, 'model2.pkl')","bd22763d":"## All Measurement","5211802b":"## Set up a standard scaler for the features","4757c6a7":"## Describe Dataset","b9762503":"## **Fetal Health Classification**\n\n\n\n\n<img src=\"https:\/\/encrypted-tbn0.gstatic.com\/images?q=tbn:ANd9GcSCrD9J44VL76nK3t4Az0dHxyJ5R_tidokCamYpZG_t81xzLLPY92i35kVR7MeUgB1Zcys&usqp=CAU\" width=\"500px\">\n\n\n\n\n\n## Data Set Information:\n\nReduction of child mortality is reflected in several of the United Nations' Sustainable Development Goals and is a key indicator of human progress.\nThe UN expects that by 2030, countries end preventable deaths of newborns and children under 5 years of age, with all countries aiming to reduce under\u20115 mortality to at least as low as 25 per 1,000 live births.\n\nParallel to notion of child mortality is of course maternal mortality, which accounts for 295 000 deaths during and following pregnancy and childbirth (as of 2017). The vast majority of these deaths (94%) occurred in low-resource settings, and most could have been prevented.\n\nIn light of what was mentioned above, Cardiotocograms (CTGs) are a simple and cost accessible option to assess fetal health, allowing healthcare professionals to take action in order to prevent child and maternal mortality. The equipment itself works by sending ultrasound pulses and reading its response, thus shedding light on fetal heart rate (FHR), fetal movements, uterine contractions and more.\n\n\n\n## Dataset in this link\n\n\n[Here](https:\/\/www.kaggle.com\/andrewmvd\/fetal-health-classification)","6fd3cb8b":"\n<h1 style='background-color:Green; font-family:newtimeroman; font-size:250%; text-align:center; border-radius: 15px 50px;' > Auto-Sklearn <\/h1>\n\n\nThe Auto-Sklearn architecture is composed of 3 phases: meta-learning, bayesian optimization, ensemble selection. The key idea of the meta-learning phase is to reduce the space search by learning from models that performed well on similar datasets. Right after, the bayesian optimization phase takes the space search created in the meta-learning step and creates bayesian models for finding the optimal pipeline configuration. Finally, an ensemble selection model is created by reusing the most accurate models found in the bayesian optimization step. In Figure 2 it\u2019s described the Auto-Sklearn architectur\n\n\n\n<img src=\"https:\/\/miro.medium.com\/max\/1000\/1*w8qIzewO97qdqmiZi69Maw.jpeg\" width=\"1200px\">","f59bc015":"## Check Miss Data","64e25b98":"## Split into train and test sets","56d024f0":"## Performance Measures","ff48d790":"## Import Lab","8f4bd706":"## Load the well-known Breast Cancer dataset","c16b33ab":"## ProfileReport Data","72c5e49a":"## Auto-Sklearn Initialization","1dac2c71":"## Accuracy Score","91630a12":"## Save the model","481db846":"## Visualization ","6f5994c7":"## Assigning values to features as X and target as y\n","fa8ba055":"## Classification Report"}}