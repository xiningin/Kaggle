{"cell_type":{"ef6374c5":"code","91e033e2":"code","57da418e":"code","2c62b8df":"code","660bd5d1":"code","ab8814f5":"code","a7ef6e6b":"code","f1daa15c":"code","a6316fc1":"code","49edb2e0":"code","9bacb168":"code","0678a894":"code","cffac756":"code","7fe390c7":"code","234ad2ef":"code","5334f9ea":"code","02d3d25b":"code","2c9d7a12":"code","16bdcde6":"code","984b3f58":"code","c9cba3bf":"code","3a90bef6":"code","746edade":"code","9925ee9f":"code","5559ce7a":"code","384db7f8":"code","7c59d9e1":"code","1626260b":"code","9a2996c6":"code","1204ccae":"code","87a9dfd7":"code","d2705e84":"code","87250b61":"code","a1807f89":"code","eac47aeb":"code","1f3f14fb":"code","42cbc279":"code","97d704f4":"code","2fd76a89":"code","60151eb7":"code","d1ed54c8":"code","ff03b98f":"markdown","ad739d4e":"markdown","fd95f214":"markdown","6d38b92c":"markdown","00ef6eab":"markdown","da802c88":"markdown","73328406":"markdown","c30fd7de":"markdown","a9df1f1c":"markdown","caa69887":"markdown","9a8ff33f":"markdown","c13cd6f3":"markdown","ea1f349b":"markdown","6cb1c53e":"markdown","9ec26147":"markdown","b4a5bb40":"markdown","ee995d71":"markdown","d3b99aec":"markdown","0d68ef70":"markdown","f86f5241":"markdown","6579c011":"markdown","c12807d1":"markdown","019b111d":"markdown","527fade9":"markdown","4650cdc9":"markdown"},"source":{"ef6374c5":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline","91e033e2":"train = pd.read_csv(\"..\/input\/train.csv\")\ntrain.head(5) ","57da418e":"train.isnull().sum()","2c62b8df":"sns.heatmap(train.isnull(),yticklabels=False,cbar=False,cmap='viridis');\n","660bd5d1":"train.drop('Cabin',axis=1,inplace=True)\ntrain['Age'].fillna((train['Age'].median()), inplace=True)\n","ab8814f5":"sns.heatmap(train.isnull(),yticklabels=False,cbar=False,cmap='viridis');\n","a7ef6e6b":"sns.set_style('whitegrid')\nsns.countplot(x='Survived',data=train,palette='RdBu_r');","f1daa15c":"sns.set_style('darkgrid')\nsns.countplot(x='Survived',hue='Sex',data=train,palette='ocean');","a6316fc1":"sns.set_style('whitegrid')\nsns.countplot(x='Survived',hue='Pclass',data=train,palette='winter');","49edb2e0":"sns.distplot(train['Age'].dropna(),kde=False,color='darkred',bins=20);","9bacb168":"sns.countplot(x='SibSp',data=train,palette='ocean');","0678a894":"sns.countplot(x='Parch',data=train,palette='ocean');","cffac756":"plt.figure(figsize=(12, 7))\nsns.boxplot(x='Pclass',y='Age',data=train,palette='winter');","7fe390c7":"train.info()","234ad2ef":"# create the dummy variables and drop one column as there is no need of 2 columns in order to differentiate the values.\nsex = pd.get_dummies(train['Sex'],drop_first=True)\n# similarly for this colimn as well. If there are n dummy columns, consider n-1\nembark = pd.get_dummies(train['Embarked'],drop_first=True)","5334f9ea":"train.drop(['Sex','Embarked','Name','Ticket'],axis=1,inplace=True)\ntrain = pd.concat([train,sex,embark],axis=1)","02d3d25b":"train.head()\n","2c9d7a12":"from sklearn.model_selection import train_test_split\nX = train.drop(\"Survived\",axis=1)\ny = train['Survived']\n#X_train, X_test, y_train, y_test = train_test_split(train.drop('Survived',axis=1),train['Survived'], test_size=0.20,random_state=5)\nX_train, X_test, y_train, y_test = train_test_split(X,y,test_size=0.20,random_state=5)","16bdcde6":"from sklearn.linear_model import LogisticRegression\n# create an instance\nlogmodel = LogisticRegression()\n# pass the values and build the model\nlogmodel.fit(X_train,y_train)","984b3f58":"# preditcing the test models\npredictions = logmodel.predict(X_test)","c9cba3bf":"from sklearn.metrics import classification_report,confusion_matrix,accuracy_score\nprint(confusion_matrix(y_test,predictions))","3a90bef6":"print(classification_report(y_test,predictions))\n","746edade":"print(accuracy_score(y_test,predictions)*100)","9925ee9f":"from sklearn.tree import DecisionTreeClassifier\ndt_model=DecisionTreeClassifier()\ndt_model.fit(X_train,y_train)\ndt_pred = dt_model.predict(X_test)\nprint(confusion_matrix(y_test,dt_pred))\n","5559ce7a":"print(classification_report(y_test,dt_pred))\n","384db7f8":"print(accuracy_score(y_test,dt_pred)*100)","7c59d9e1":"from sklearn.ensemble import RandomForestClassifier\nrf= RandomForestClassifier(n_estimators=100)\nrf.fit(X_train,y_train)","1626260b":"rf_pre=rf.predict(X_test)\nprint(confusion_matrix(y_test,rf_pre))\n","9a2996c6":"print(classification_report(y_test,rf_pre))\n","1204ccae":"print(accuracy_score(y_test,rf_pre)*100)","87a9dfd7":"test = pd.read_csv(\"..\/input\/test.csv\")\ntest.head(5) ","d2705e84":"sns.heatmap(test.isnull());","87250b61":"test.info()","a1807f89":"test.drop('Cabin',axis=1,inplace=True)\ntest['Age'].fillna((test['Age'].median()), inplace=True)\ntest['Fare'].fillna((test['Fare'].median()), inplace=True)\nsex_test = pd.get_dummies(test['Sex'],drop_first=True)\nembark_test= pd.get_dummies(test['Embarked'],drop_first=True)\ntest.drop(['Sex','Embarked','Name','Ticket'],axis=1,inplace=True)\ntest = pd.concat([test,sex_test,embark_test],axis=1)\ntest.head()","eac47aeb":"prediction = logmodel.predict(test)\nprediction","1f3f14fb":"test_pred = pd.DataFrame(prediction, columns= ['Survived'])","42cbc279":"Survived_dataset = pd.concat([test, test_pred], axis=1, join='inner')","97d704f4":"Survived_dataset.head()","2fd76a89":"dataset = Survived_dataset[['PassengerId','Survived']]\ndataset.head(10)","60151eb7":"data_to_submit = pd.DataFrame(Survived_dataset[['PassengerId','Survived']])","d1ed54c8":"data_to_submit.to_csv('csv_to_submit.csv', index = False)\n","ff03b98f":"This graph clearly indicaes that the 3rd class passengers are not surivided much.","ad739d4e":"Now apply any one of the regression technique and check for the results.","fd95f214":"Finally, the model is complete. Now let's take a random data and check the survival rate of the passegers.","6d38b92c":"Parch stands for number of Parent-children combination travelled along with the passenger. Even we see that the count is less. now let's look at the data and check for the textual colums and convert them to numerical in order to design a model.","00ef6eab":"Let's evaluate using confusion  matrix and F1 score","da802c88":"### Train Test Split\n","73328406":"The accuracy score is comparitively less to the logistic regression and it is still the best model as of now, let us try another model.","c30fd7de":"Now the data is clean without NaN values, lets do some visualization and try to find the insights.","a9df1f1c":"There are missing values just like the train data which we performed before, perform the same steps and clean the data.","caa69887":"From the above graph, it stats that the most of the males are not survided.","9a8ff33f":" ## Evaluation :  Logistic Regression","c13cd6f3":"Observe that there is no \" survived \" column in the dataset, which has to be predicted now.","ea1f349b":"## Logistic Regression","6cb1c53e":"## Random Forest Classification\n","9ec26147":"Let us train the data and predict the scores using logistic regression","b4a5bb40":"The prediction values are stored in numpy array, in order to add this column to the test dataset, convert to dataframe.","ee995d71":"SibSp stands for number of siblings and spouse travelled along with the passenger. Most of the passengers are travelled in single without siblings and spouse along with them.","d3b99aec":"Now drop unnecessary columns.\nThe dataset has PassengerId,Name and Ticket which are really not required. Hence drop the columns. Convert the sex and Embarked columns to numerical respectively.","0d68ef70":"The first step is to make data cleansing. Check for the null values and clean the data.","f86f5241":"From the above dataset, we have successfully predicted the passengers who are survived Vs not survived.","6579c011":"Now the data is ready! let's build the model.","c12807d1":"We can observe that most of the passengers are in the age group of 20 to 35.","019b111d":"## Evaluation : Decision Tree Classifiction\n","527fade9":"Random forest and logistic regressions are almost equal in predictions, you can use either of them for the model.","4650cdc9":"We see that, there are two colums which has null values. Cabin is a column where in we don't require for data visualization, so it's betterto drop the column.\""}}