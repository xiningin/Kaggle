{"cell_type":{"be84d254":"code","c056dff7":"code","4e3a3d70":"code","3c0f1604":"code","86fd3ff3":"code","29c0dc39":"code","7d5f7c13":"code","223b4b45":"code","f456e93c":"code","c65381f1":"code","473dde70":"code","2f2e7b7a":"code","a30aae33":"code","58fbac9d":"code","c2dc095c":"code","f4c02769":"code","652101d3":"code","4ba0e4aa":"code","ee710caa":"markdown","75c82404":"markdown","8826a869":"markdown","63cd2a49":"markdown","70a235ab":"markdown","434fce73":"markdown","ce78c519":"markdown","cccf5060":"markdown","248b3a4b":"markdown","68821b24":"markdown"},"source":{"be84d254":"import pandas as pd\ndata=pd.read_csv('..\/input\/diamonds\/diamonds.csv')","c056dff7":"data.head()","4e3a3d70":"data.drop('Unnamed: 0',axis=1,inplace=True)","3c0f1604":"data.isna().sum()","86fd3ff3":"data.describe()","29c0dc39":"#checking for columns with 0 \ndata.loc[(data['x']==0)|(data['y']==0)|(data['z']==0)]\n","7d5f7c13":"#deleting values having zero \ndata=data[(data[['x','y','z']]!=0).all(axis=1)]","223b4b45":"from sklearn.preprocessing import LabelEncoder\nfrom sklearn.preprocessing import OneHotEncoder\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import mean_squared_error,r2_score,mean_absolute_error\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.tree import DecisionTreeRegressor\nfrom sklearn import metrics\nfrom sklearn.preprocessing import MinMaxScaler\nfrom sklearn.model_selection import train_test_split\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nX=data.drop('price',axis=1)\ny=data['price']\n   \n","f456e93c":"plt.figure(figsize=(15,8))\nsns.countplot(x='cut',data=X,order=X['cut'].value_counts().index)\n","c65381f1":"plt.figure(figsize=(15,8))\nsns.countplot(x='color',data=X,order=X['color'].value_counts().index)","473dde70":"plt.figure(figsize=(15,8))\nsns.countplot(x='clarity',data=X,order=X['clarity'].value_counts().index)","2f2e7b7a":"object_col=[col for col in X.columns if X[col].dtype==\"object\"]\noh_encoder=pd.get_dummies(X[object_col])\n\nnum_X_train=X.drop(object_col,axis=1)\nscale=MinMaxScaler()\nscale_X_train=pd.DataFrame(scale.fit_transform(num_X_train),index=num_X_train.index,columns=['carat','depth','table','x','y','z'])\n","a30aae33":"diamond_data=pd.concat([scale_X_train,oh_encoder],axis=1)","58fbac9d":"#checking correlation \nplt.figure(figsize=(20,20))  # on this line I just set the size of figure to 12 by 10.\np=sns.heatmap(diamond_data.corr(), annot=True,cmap='RdYlGn')","c2dc095c":"X_train,X_test,y_train,y_test=train_test_split(diamond_data,y,test_size=0.2,random_state=42)\n\n#linear Regression \nlnr_model=LinearRegression()\nlnr_model.fit(X_train,y_train)\ny_pred=lnr_model.predict(X_test)\n\n\nprint(\"Accuracy :- \"+ str(lnr_model.score(X_test,y_test)*100) +' %')\nprint(\"R Squared :- \"+ str(metrics.r2_score(y_test,y_pred)))\nprint(\"Mean Absolute Error :- {}\".format(mean_absolute_error(y_test,y_pred)))\n","f4c02769":"#Decision tree\nregressor = DecisionTreeRegressor(random_state = 0)  \n\nregressor.fit(X_train, y_train)\n\ny_pred_dt=regressor.predict(X_test)\n\n\nprint(\"Accuracy :- \" + str(regressor.score(X_test,y_test)*100) +' %')\nprint(\"R Squared :- \" + str(metrics.r2_score(y_test,y_pred_dt)))\nprint(\"Mean absolute error :- {}\".format(mean_absolute_error(y_test,y_pred_dt)))","652101d3":"#random forest with default parameters \nrf=RandomForestRegressor(random_state=42)\nrf.fit(X_train,y_train)\nrfy_pred=rf.predict(X_test)\nmetrics.r2_score(y_test,rfy_pred)\n\nprint(\"Accuracy :- \"+ str(rf.score(X_test,y_test)*100) +' %')\nprint(\"R Squared :- \"+ str(metrics.r2_score(y_test,rfy_pred)))\nprint(\"Mean Absolute Error :- {}\".format(mean_absolute_error(y_test,rfy_pred)))","4ba0e4aa":"#random forest with estimators\n\nrf = RandomForestRegressor(n_estimators=100,random_state = 42)\n\nrf.fit(X_train,y_train)\n\ny_pred_rf=rf.predict(X_test)\n\nprint(\"Accuracy :- \"+ str(rf.score(X_test,y_test)*100) +' %')\nprint(\"R Squared :- \"+ str(metrics.r2_score(y_test,y_pred_rf)))\nprint(\"Mean Absolute Error :- {}\".format(mean_absolute_error(y_test,y_pred_rf)))","ee710caa":"***Loading the dataset from specified location ***","75c82404":"Now that we have gained knowledge about what each variable represents , lets do few basic checks in the data . \n\n* First lets check if there are any unwanted columns to be removed \n* Next lets check for null values present in the data . ","8826a869":"**Description of the variables**\n\n***Independent Variable **\n    1. carat - Weight of the diamond \n    2. cut - Quality of the diamond . It is categorical column which contains 5 different categories of the diamond . \n    3. color - Categorical column representing the color of the diamond . It is categorised into 7 types . \n    4. clarity - Refers to the visual appearance of internal characteristics of a diamond called inclusions and blemishes.It has 8    different categories .\n    5. Depth - Height of the diamond. the depth of diamond is represent in precentage. \n    6. Table - Represents the flat surface on the top of the diamond. \n    7. x - length in mm \n    8. y - width in mm \n    9. z - depth in mm \n\n*** Dependent Variable **\n    1. Price - Represents the price of the diamond.     ","63cd2a49":"After loading the data , We will first look at the data to get an understanding . ","70a235ab":"Stay Tuned !! Will improve the results by tuning the parameters of Random forest ,Decision Tree and XG Boost .\n\n**Thank You :) **","434fce73":"From the data we can seen that Unnamed:0 column is not required as it is an index column . Therefore we will remove the column from the data.\n","ce78c519":"Wow !! . Now we got to know the stats of the variables . You check and everything seems fine and proceed further.                                 \nStop !!                                                                                                                                  \nIf you clearly notice the min values for columns x,y and z are 0 which is impratical.","cccf5060":"Now lets get the summary statistics of the data (count, min,max,mean,std etc ). \n\nThe summary is shown only for numerical variables. ","248b3a4b":"We can see that there are 20 rows containing zero in either x,y or z . Since this is impratical we will exclude from the data. ","68821b24":"Super!! We do not have any null values . If are null values present then we should have either deleted the rows or replace them mean\/median ."}}