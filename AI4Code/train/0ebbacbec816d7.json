{"cell_type":{"b9799eca":"code","e0281965":"code","f18e0fee":"code","39e7de64":"code","85762a39":"code","b2091794":"code","1f97ca74":"code","2030e012":"code","ce4f4ec3":"code","e12462a2":"code","c2db06ce":"code","cde1e720":"code","51ee274d":"code","d80d887c":"code","52d96774":"code","04ba5d7e":"code","ad497974":"code","c8c89450":"code","8fbc7f3e":"code","8df29760":"code","040eb709":"code","a3d3a47e":"code","9eba3fee":"code","2fa2893c":"code","07632a61":"code","9620daa3":"code","42746af4":"code","deae9417":"code","4a4c24f3":"code","20c3d017":"code","57b24270":"code","c441c3e2":"code","9b914808":"code","9e65ff2e":"markdown","7fecbd56":"markdown","9619ebec":"markdown","a3cddbac":"markdown","24ec5644":"markdown"},"source":{"b9799eca":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nfrom fastai import *\nfrom fastai.tabular import *\n\nimport os\n# Any results you write to the current directory are saved as output.","e0281965":"root=Path(\"..\/input\")\ntrain_path=root\/'train.csv'\ntest_path=root\/'test.csv'","f18e0fee":"test_df=pd.read_csv(test_path).fillna(0)\ntest_df.head()","39e7de64":"train_df=pd.read_csv(train_path)\ntrain_df.head()","85762a39":"train_df1=train_df.loc[0:1200]\ntrain_df2=train_df.loc[1200:]","b2091794":"procs=[FillMissing,Categorify]","1f97ca74":"valid_idx=list(range(500,700))","2030e012":"dep_var='SalePrice'\n\n# TODO Feature selection\ncat_names=list(train_df.select_dtypes('object').columns.values)\ncont_names=list(train_df.select_dtypes(['int64','float64']))\ncont_names.remove('Id')\ncont_names.remove('SalePrice')","ce4f4ec3":"test_db = TabularList.from_df(test_df,path=test_path,cont_names=cont_names,cat_names=cat_names)","e12462a2":"data=(TabularList.from_df(train_df,path=train_path,cont_names=cont_names,cat_names=cat_names,procs=procs)\n#       .split_by_idx(valid_idx)\n      .split_by_rand_pct(0.1)\n      .label_from_df(cols=dep_var,label_cls=FloatList,log=False)\n      .add_test(test_db)\n      .databunch())","c2db06ce":"data.show_batch(10)","cde1e720":"learn=tabular_learner(data,layers=[4000,2000], metrics=[mean_absolute_error],path='.')","51ee274d":"learn.fit_one_cycle(5,.01)","d80d887c":"learn.save('s1')","52d96774":"learn.load('s1');","04ba5d7e":"learn.unfreeze()","ad497974":"learn.lr_find(1e-10,1e+10)","c8c89450":"learn.recorder.plot()","8fbc7f3e":"learn.fit_one_cycle(20,10)","8df29760":"vdf=train_df2","040eb709":"vdb=(TabularList.from_df(vdf,path=train_path,cont_names=cont_names,cat_names=cat_names,procs=procs)\n     .split_by_rand_pct(.01)\n     .label_from_df(cols=dep_var,label_cls=FloatList,log=False)\n     .databunch())","a3d3a47e":"learn.validate(vdb.valid_dl)","9eba3fee":"learn.validate(data.valid_dl)","2fa2893c":"i=2","07632a61":"data.valid_ds[i]","9620daa3":"train_df1.iloc[500+i][\"GarageArea\"]","42746af4":"learn.predict(train_df1.iloc[500+i])[0].obj[0]","deae9417":"j=10\ntrain_df2.iloc[j]['SalePrice']","4a4c24f3":"learn.predict(train_df2.iloc[j])","20c3d017":"sub_df = pd.DataFrame(columns=['Id','SalePrice']).astype({'Id':int,'SalePrice':float})","57b24270":"for index, rw in test_df.iterrows():\n    price=learn.predict(rw)[0].obj[0]\n    sub_df.loc[index]=[int(rw.Id),price]","c441c3e2":"sub_df=sub_df.astype({'Id':int,'SalePrice':float})\nsub_df.head()","9b914808":"sub_df.to_csv('submission.csv',index=False)","9e65ff2e":"# Make predictions","7fecbd56":"# Load Data","9619ebec":"# Evaluation","a3cddbac":"# Train model","24ec5644":"# Prepare Submissions"}}