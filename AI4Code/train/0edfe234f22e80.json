{"cell_type":{"0fc97139":"code","feca32f0":"code","74ae7bc2":"code","fbcff262":"code","9d15ed09":"code","c9ae778a":"code","01820333":"code","30d3096b":"code","d91c46f1":"code","5aa10b16":"code","77554f5e":"code","a15fa6f8":"code","d938dc7a":"code","2f21a4de":"code","a4e55f62":"code","fd870238":"code","ee477385":"code","26e11b77":"code","d9a15275":"markdown"},"source":{"0fc97139":"import pandas as pd\nimport plotly.graph_objects as go\nimport numpy as np\nimport datetime\nfrom plotly.subplots import make_subplots\nimport plotly.express as px\n\nfrom plotly.offline import init_notebook_mode, iplot\ninit_notebook_mode(connected=True)","feca32f0":"dolar_df = pd.read_csv(\"..\/input\/usdcop-historical-data\/USD_COP Historical Data.csv\")\neco_df = pd.read_csv(\"..\/input\/ecopetrol-datos-historicos\/ECO Historical Data.csv\")\nwti_df = pd.read_csv(\"..\/input\/oil-wti-historical-price\/Crude Oil WTI Futures Historical Data.csv\")","74ae7bc2":"# wti_df\ndolar_df.dtypes","fbcff262":"wti_df.dtypes[\"Date\"] == ('object')","9d15ed09":"wti_df","c9ae778a":"def transform_type_1_df(df):\n    df[\"Change %\"] = df[\"Change %\"].str.replace(\"%\" , \"\")\n    df['Change %'] = pd.to_numeric(df['Change %']) \n    \n    for col in [\"Price\", 'Open', 'High', 'Low']:\n        if df.dtypes[col] == ('object'):\n            df[col] = df[col].str.replace(\",\", \"\")\n            df[col]  = pd.to_numeric(df[col]) \n\n    df[\"Date\"] = pd.to_datetime(df[\"Date\"], format=\"%b %d, %Y\")\n    df[\"Day\"] = df[\"Date\"].dt.strftime('%A')\n\n    return df","01820333":"dolar_df = transform_type_1_df(dolar_df)\neco_df = transform_type_1_df(eco_df)\nwti_df = transform_type_1_df(wti_df)\ndolar_df","30d3096b":"eco_df.groupby([\"Day\"])[\"Change %\"].sum()","d91c46f1":"fig = go.Figure(data=go.Scatter(x=dolar_df.Date, y=dolar_df.Price))\n\nfig.update_layout(title='Precio del Dolar',\n                  xaxis_title='Fecha',\n                   yaxis_title='Precio (En $COP)')\n\nfig.show()","5aa10b16":"fig = go.Figure(data=go.Scatter(x=eco_df.Date, y=eco_df.Price))\n\n\nfig.update_layout(title='Precio de Ecopetrol',\n                  xaxis_title='Fecha',\n                   yaxis_title='Precio (En $COP)')\n\nfig.show()","77554f5e":"fig = go.Figure(data=go.Scatter(x=wti_df.Date, y=wti_df.Price))\n\n\nfig.update_layout(title='Precio del petroleo',\n                  xaxis_title='Fecha',\n                   yaxis_title='Precio (En USD$)')\n\nfig.show()","a15fa6f8":"fig = go.Figure()\n\nfig.add_trace(go.Scatter(x=eco_df.Date, y=eco_df.Price, name= \"Accion de Ecopetrol\"))\nfig.add_trace(go.Scatter(x=dolar_df.Date, y=dolar_df.Price, name=\"USD\"))\n# fig.add_trace(go.Scatter(x=wti_df.observation_date, y=wti_df.DCOILWTICO))\n\nfig.update_layout(xaxis_title='Fecha',\n                   yaxis_title='Precio (En $COP)')\n\nfig.show()","d938dc7a":"df = pd.merge(eco_df, dolar_df, how='inner', on='Date')\n","2f21a4de":"df.groupby('Day_x')[['Price_x','Price_y']].corr()","a4e55f62":"df_cop_oil = pd.merge(wti_df, dolar_df, how='inner', left_on=  ['Date'], right_on= ['Date'])\ndf_cop_oil = pd.DataFrame(data={'date' : df_cop_oil['Date'], 'oil_cop_price' : (df_cop_oil['Price_x'] * df_cop_oil['Price_y'])\/1000})\ndf_cop_oil","fd870238":"fig = go.Figure()\n\nfig = make_subplots(specs=[[{\"secondary_y\": True}]])\n\nfig.add_trace(go.Scatter(x=eco_df.Date, y=eco_df.Price, name= \"Accion de Ecopetrol\"),\n    secondary_y=False)\nfig.add_trace(go.Scatter(x=df_cop_oil.date, y=df_cop_oil.oil_cop_price, name=\"Precio de petroleo miles de COP$\"),\n    secondary_y=True)\n\nfig.update_layout(xaxis_title='Fecha',\n                   yaxis_title='Precio (En $COP)')\n\nfig.show()","ee477385":"df_eco_oil = pd.merge(eco_df, df_cop_oil, how='inner', left_on='Date', right_on='date')\n\ndf_eco_oil[\"pandemia\"] = df_eco_oil[\"Date\"].dt.year == 2020\ndf_eco_oil[\"pandemia\"] = df_eco_oil[\"pandemia\"].replace(True, 1)\ndf_eco_oil[\"pandemia\"] = df_eco_oil[\"pandemia\"].replace(False, 0)","26e11b77":"\nfig = px.scatter(df_eco_oil, x = \"Price\", y= \"oil_cop_price\", color=\"pandemia\")\nfig.update_traces(marker_size=5)\n\n\nfig.show()\n","d9a15275":"# An\u00e1lisis a la acci\u00f3n de Ecopetrol, el Precio del D\u00f3lar y El Barril de Petr\u00f3leo.\n## **Hecho Por Juli\u00e1n \u00dasuga Ortiz**"}}