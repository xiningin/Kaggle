{"cell_type":{"c7fca82f":"code","fbf77bec":"code","43bfd6d5":"code","4c5f20ab":"code","a757c883":"code","562bd096":"code","eae055fa":"code","4dc3b899":"code","1b1e8a45":"code","580b763c":"code","4ba35b66":"code","9a6636f8":"code","68d183c6":"code","0513154e":"code","3c903285":"code","e56a9c95":"code","f5825230":"code","e12a4f29":"code","12ab91bb":"code","a57dff15":"code","0a5a2471":"code","ed3643f4":"markdown","294d7ac1":"markdown","6c2a578d":"markdown","d1d082c3":"markdown"},"source":{"c7fca82f":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","fbf77bec":"# Importing libraries and magic functions\n\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.model_selection import train_test_split\n\nfrom IPython.core.interactiveshell import InteractiveShell\nInteractiveShell.ast_node_interactivity = \"all\"\n%config InlineBackend.figure_format ='retina'\n%matplotlib inline","43bfd6d5":"# read data\ndf = pd.read_csv('\/kaggle\/input\/insurance\/insurance.csv')\n\n# first glimpse at Data\ndf.head()\n\n\n#types\ndf.dtypes","4c5f20ab":"# Statistics Summary - Numerical variables\ndf.describe()","a757c883":"# check for nan\ndf.isnull().sum()\n\n# check for duplicates\nduplicate_df = df[df.duplicated()]\nduplicate_df","562bd096":"# Data Cleaning\n\n# remove duplicates\ndf.drop(df.index[[581]], inplace=True)\n\n# check if removed\nduplicate_df2 = df[df.duplicated()]\nduplicate_df2","eae055fa":"# Checking for outlieres - Boxplot\n\nsns.boxplot(df.bmi)","4dc3b899":"# Create dummies\n\ndf = pd.get_dummies(df, prefix=['sex', 'smoker', 'region'])\ndf.head()","1b1e8a45":"# Correlation\ndf_corr = df.corr()\n\n# visualize correlation using heatmap\nfig, ax = plt.subplots(figsize=(10,10))\nsns.heatmap(df_corr,annot= True, ax=ax)","580b763c":"# dropping sex_female and smoker_no\n\ndf = df.drop(['sex_female','smoker_no'], axis=1)\ndf.columns","4ba35b66":"# Checking distribution and correlation - Pairplot\n\nsns.pairplot(df)","9a6636f8":"# Distribution of smoker\n\nsns.countplot(df.smoker_yes)\nsns.despine(top=True, right=True, left=True, bottom=False) \nplt.title('Distribution smoker vs. non smoker')\nplt.xlabel('Smoker no=0\/yes=1')\n\n# Value count\ndf.smoker_yes.value_counts()","68d183c6":"# Distribution of charges\n\nsns.distplot(df.charges)\nsns.despine(top=True, right=True, left=False, bottom=False) ","0513154e":"# distribution of charges depending on wether smoker or not\n\nf= plt.figure(figsize=(12,5))\n\nmean_smoker=df[(df.smoker_yes == 1)][\"charges\"].mean()\n\nax=f.add_subplot(121)\nsns.distplot(df[(df.smoker_yes == 1)][\"charges\"],color='r',ax=ax)\nax.axvline(mean_smoker, color='b', linestyle='--')\nax.set_title('Distribution of charges for smokers')\n\nmean_non_smoker = df[(df.smoker_yes == 0)][\"charges\"].mean()\n\nax=f.add_subplot(122)\nsns.distplot(df[(df.smoker_yes == 0)]['charges'],color='g',ax=ax)\nax.axvline(mean_non_smoker, color='b', linestyle='--')\nax.set_title('Distribution of charges for non-smokers')\n\nsns.despine(top=True, right=True, left=False, bottom=False) \n\nplt.show()","3c903285":"# Distribution for charges depending on gender\n\ng= plt.figure(figsize=(12,5))\n\nax=g.add_subplot(121)\nsns.distplot(df[(df.sex_male == 1)][\"charges\"],color='dodgerblue',ax=ax)\nax.set_title('Distribution of charges for men')\n\nax=g.add_subplot(122)\nsns.distplot(df[(df.sex_male == 0)]['charges'],color='orchid',ax=ax)\nax.set_title('Distribution of charges for women')\n\nsns.despine(top=True, right=True, left=False, bottom=False) ","e56a9c95":"# Charges - BMI - Smoker\nsns.scatterplot(data=df, x='bmi', y='charges', hue='smoker_yes')\n\nsns.despine(top=True, right=True, left=True, bottom=False) \nplt.title(\"Charges - BMI - Smoker\")","f5825230":"# Splitting Data 75% Train - 25% Test\nfrom sklearn.model_selection import train_test_split\n\n# clarify what is y and what is x label\ny = df['charges']\nx = df.drop(['charges'], axis = 1)\n\nx_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.25, random_state = 67)","e12a4f29":"# Linear Regression\nlr = LinearRegression()\n\n# fitting\nlr_model= lr.fit(x_train, y_train)\n\n# get intercept & coefficients\nlr.coef_\nlr.intercept_\n\n# make predictions\ny_train_pred = lr_model.predict(x_train)\ny_test_pred = lr_model.predict(x_test)\n\n# score results\nprint(\"The model's accuracy score before polynomial feature adjustment is:\",round(lr_model.score(x_test,y_test),2))\n","12ab91bb":"# Polynomial Features\n\nfrom sklearn.preprocessing import PolynomialFeatures\n\nX = df.drop(['charges'], axis = 1)\nY = df.charges\n\nquad = PolynomialFeatures (degree = 3)\nx_quad = quad.fit_transform(X)\n\nX_train,X_test,Y_train,Y_test = train_test_split(x_quad,Y, random_state = 0)\n\nplr = LinearRegression().fit(X_train,Y_train)\n\nY_train_pred = plr.predict(X_train)\nY_test_pred = plr.predict(X_test)\n\nprint(plr.score(X_test,Y_test))","a57dff15":"# Model Evaluation\n\n#MAE\nfrom sklearn.metrics import mean_absolute_error\n\nmean_absolute_error(Y_train, Y_train_pred)\n\n#MSE\nfrom sklearn.metrics import mean_squared_error\n\nmean_squared_error(Y_train, Y_train_pred)\n\n#R squared\nfrom sklearn.metrics import r2_score\n\nprint('R2 score train data:',r2_score(Y_train, Y_train_pred))\n\nprint('R2 score test data:', r2_score(Y_test, Y_test_pred))","0a5a2471":"plt.figure(figsize=(10,6))\n\nplt.scatter(Y_train_pred,Y_train_pred - y_train,\n          c = 'black', marker = 'o', s = 35, alpha = 0.5,\n          label = 'Train data')\nplt.scatter(Y_test_pred,Y_test_pred - y_test,\n          c = 'c', marker = 'o', s = 35, alpha = 0.7,\n          label = 'Test data')\nplt.xlabel('Predicted values')\nplt.ylabel('Tailings')\nplt.legend(loc = 'upper left')\nplt.hlines(y = 0, xmin = 0, xmax = 60000, lw = 2, color = 'red')\nplt.show()","ed3643f4":"### Setting up the model","294d7ac1":"### Variable Descriptions \n\n#### Independent variables\/features:\n\n* age: age of primary beneficiary\n\n* sex: insurance contractor gender, female, male\n\n* bmi: Body mass index, providing an understanding of body, weights that are relatively high or low relative to height, objective index of body weight (kg \/ m ^ 2) using the ratio of height to weight, ideally 18.5 to 24.9\n\n* children: Number of children covered by health insurance \/ Number of dependents\n\n* smoker: Smoking\n\n* region: the beneficiary's residential area in the US, northeast, southeast, southwest, northwest.\n\n#### Dependent Variable\/target:\n\n* charges: Individual medical costs billed by health insurance","6c2a578d":"#### Average spending on medical treatment\nOn average, 13270.4 $ are being spent on medical costs.\n\n#### Average BMI across patients\nThe mean BMI is approx. 30 which is very high --> overweight\n\n#### Average age\navg age = 39","d1d082c3":"**Exploratory Data Analysis**"}}