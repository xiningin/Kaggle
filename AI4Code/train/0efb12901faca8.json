{"cell_type":{"62803a47":"code","bbd64cdf":"code","9cfb42e0":"code","2c6b1995":"code","14fb85a5":"code","063d7a77":"markdown","836256d7":"markdown","8dbe8c75":"markdown","80ce10ce":"markdown"},"source":{"62803a47":"import pandas as pd\n\ntop_n = 3\n\ntuning_labels = pd.read_csv('..\/input\/tuning_labels.csv', names=['id', 'labels'], index_col=['id'])\n\n# calculate top_n most popular labels\npredicted = ' '.join(\n    tuning_labels['labels']\n    .str\n    .split()\n    .apply(pd.Series)\n    .stack()\n    .value_counts()\n    .head(top_n)\n    .index\n    .tolist()\n)\n\nprint(f'{top_n} most popular labels are: {predicted}')","bbd64cdf":"submission = pd.read_csv('..\/input\/stage_1_sample_submission.csv', index_col='image_id')\n\n# tuning table is part of submission.csv\nsubmission.index.isin(tuning_labels.index).sum()","9cfb42e0":"# use most popular labels as a prediction unless the correct labels are provided\nsubmission['labels'] = predicted\nsubmission.update(tuning_labels)","2c6b1995":"submission.to_csv('naive.csv')","14fb85a5":"(\n    pd.read_csv('https:\/\/storage.googleapis.com\/inclusive-images-stage-2\/stage_2_sample_submission.csv', index_col='image_id')\n    .assign(labels=predicted)\n    .to_csv('stage_2_submission.csv')\n)","063d7a77":"# Stage 1","836256d7":"**updated for Stage 2**\n\ntl;dr \n- tuning table might have similar distribution of labels to submission.csv\n- tuning table is part of submission.csv","8dbe8c75":"# Predictions","80ce10ce":"# Stage 2\none-liner update for Stage 2"}}