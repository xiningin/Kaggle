{"cell_type":{"9ad194f4":"code","40a0a9fd":"code","99a46882":"code","86008717":"code","aa945fa5":"code","bc0612f5":"code","da7e1da3":"markdown","e25208a3":"markdown","b2c7889b":"markdown","2b46f5bd":"markdown","ad874d65":"markdown","3f76a2d7":"markdown","286e84bd":"markdown"},"source":{"9ad194f4":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.ensemble import RandomForestClassifier","40a0a9fd":"import random\nrandom.seed(1)\ntrain=pd.read_csv('..\/input\/titanic\/train.csv')\ntest=pd.read_csv('..\/input\/titanic\/test.csv')","99a46882":"import statistics\n\ndef extractFeatures(data):\n    features = [\"Pclass\",\"Age\",\"Sex\",\"Parch\",\"SibSp\",\"Fare\",\"Embarked\"]\n    fea = data[features]\n    fea['Age'] = fea['Age'].apply(lambda x: np.where(np.isnan(x),-1,x))  \n    fea['Fare'] = fea['Fare'].apply(lambda x: np.where(np.isnan(x),statistics.median(fea['Fare']),x)) \n    fea['Embarked'] = fea['Embarked'].apply(lambda x: np.where(type(x)==float,'S',x))\n    fea['Sex'] = fea['Sex'].map( {\"male\":0, \"female\":1})\n    fea['Embarked'] = fea['Embarked'].map({\"S\":1, \"C\":2, \"Q\":3})\n    \n    return fea","86008717":"rf = RandomForestClassifier()\nrf.fit(extractFeatures(train), train['Survived'])\n\nsubmit=pd.DataFrame()\nsubmit['PassengerId']=test['PassengerId']\nsubmit['Survived'] = rf.predict(extractFeatures(test))\nsubmit.to_csv('submission.csv',index=False)\nsubmit","aa945fa5":"# This part is not matched to R script\ndef visualize_importance(models, feat_train_df):\n\n    feature_importance_df = pd.DataFrame()\n    for i, model in enumerate(models):\n        _df = pd.DataFrame()\n        _df['feature_importance'] = model.feature_importances_\n        _df['column'] = feat_train_df.columns\n        _df['fold'] = i + 1\n        feature_importance_df = pd.concat([feature_importance_df, _df], \n                                          axis=0, ignore_index=True)\n\n    order = feature_importance_df.groupby('column')\\\n        .sum()[['feature_importance']]\\\n        .sort_values('feature_importance', ascending=False).index[:7]\n\n    fig, ax = plt.subplots(figsize=(8, max(6, len(order) * .25)))\n    sns.boxenplot(data=feature_importance_df, \n                  x='feature_importance', \n                  y='column', \n                  order=order, \n                  ax=ax, \n                  palette='viridis', \n                  orient='h')\n    ax.tick_params(axis='x', rotation=0)\n    ax.grid()\n    fig.tight_layout()\n    \n    return fig, ax","bc0612f5":"fig,ax=visualize_importance(rf, extractFeatures(train))\nfig.savefig(\"importance.png\")\nplt.show()","da7e1da3":"For R beginners, reading the Python scripts corresponding to the R scripts is a good approach to understand R. This python notebook referring to the published notebook written by R. <br\/>\nhttps:\/\/www.kaggle.com\/benhamner\/random-forest-benchmark-r","e25208a3":"```\nrf <- randomForest(extractFeatures(train), as.factor(train$Survived), ntree=100, importance=TRUE)\n\nsubmission <- data.frame(PassengerId = test$PassengerId)\nsubmission$Survived <- predict(rf, extractFeatures(test))\nwrite.csv(submission, file = \"1_random_forest_r_submission.csv\", row.names=FALSE)\n```","b2c7889b":"```\n[R]\nset.seed(1)\ntrain <- read.csv(\"..\/input\/train.csv\", stringsAsFactors=FALSE)\ntest  <- read.csv(\"..\/input\/test.csv\",  stringsAsFactors=FALSE)\n```","2b46f5bd":"```\n[R]\nextractFeatures <- function(data) {\n  features <- c(\"Pclass\",\n                \"Age\",\n                \"Sex\",\n                \"Parch\",\n                \"SibSp\",\n                \"Fare\",\n                \"Embarked\")\n  fea <- data[,features]\n  fea$Age[is.na(fea$Age)] <- -1\n  fea$Fare[is.na(fea$Fare)] <- median(fea$Fare, na.rm=TRUE)\n  fea$Embarked[fea$Embarked==\"\"] = \"S\"\n  fea$Sex      <- as.factor(fea$Sex)\n  fea$Embarked <- as.factor(fea$Embarked)\n  return(fea)\n}\n```","ad874d65":"```\n[R]\nimp <- importance(rf, type=1)\nfeatureImportance <- data.frame(Feature=row.names(imp), Importance=imp[,1])\n\np <- ggplot(featureImportance, aes(x=reorder(Feature, Importance), y=Importance)) +\n     geom_bar(stat=\"identity\", fill=\"#53cfff\") +\n     coord_flip() + \n     theme_light(base_size=20) +\n     xlab(\"\") +\n     ylab(\"Importance\") + \n     ggtitle(\"Random Forest Feature Importance\\n\") +\n     theme(plot.title=element_text(size=18))\n     \nggsave(\"2_feature_importance.png\", p)    \n```","3f76a2d7":"```\n[R]\nlibrary(ggplot2)\nlibrary(randomForest)\n```","286e84bd":"# Random Forest Benchmark (R->Python)"}}