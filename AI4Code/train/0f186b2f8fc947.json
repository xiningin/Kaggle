{"cell_type":{"6e240e1a":"code","7c9991f7":"code","6ab9f2af":"code","46775ad6":"code","049a62f8":"code","93c9dfe9":"code","fe7fe8c4":"code","528b6c31":"code","99054e4d":"code","a38c53ea":"code","19caf865":"code","957d7c96":"code","586116bf":"code","268fedb8":"code","15981566":"code","43a1f2f8":"code","686c4f92":"code","4850b877":"code","d1c2432e":"code","bff6c8da":"code","8b99ca82":"code","5427dffc":"code","ba90c431":"code","e4609ecc":"code","54e90329":"code","4447c14a":"code","1985d1bd":"code","834fb074":"code","d7a51bd9":"code","1fe86780":"code","6912d5f7":"code","aa054a6d":"code","655ab026":"markdown","3975971c":"markdown","9322de08":"markdown","1258ea2a":"markdown"},"source":{"6e240e1a":"import pandas as pd\nimport numpy as np","7c9991f7":"base_dataset = pd.read_csv(\"..\/input\/Automobile_data.csv\")","6ab9f2af":"base_dataset","46775ad6":"base_dataset.isna().sum()","049a62f8":"from sklearn import preprocessing\n\ndef variables_creation(base_dataset,unique):\n    \n    cat=base_dataset.describe(include='object').columns\n    \n    cont=base_dataset.describe().columns\n    \n    x=[]\n    \n    for i in base_dataset[cat].columns:\n        if len(base_dataset[i].value_counts().index)<unique:\n            x.append(i)\n    \n    dummies_table=pd.get_dummies(base_dataset[x])\n    encode_table=base_dataset[x]\n    \n    le = preprocessing.LabelEncoder()\n    lable_encode=[]\n    \n    for i in encode_table.columns:\n        le.fit(encode_table[i])\n        le.classes_\n        lable_encode.append(le.transform(encode_table[i]))\n        \n    lable_encode=np.array(lable_encode)\n    lable=lable_encode.reshape(base_dataset.shape[0],len(x))\n    lable=pd.DataFrame(lable)\n    return (lable,dummies_table,cat,cont)","93c9dfe9":"(lable,dummies_table,cat,cont)=variables_creation(base_dataset,8)","fe7fe8c4":"cont","528b6c31":"base_dataset = base_dataset[base_dataset.describe().columns]","99054e4d":"base_dataset.shape","a38c53ea":"base_dataset.drop('highway-mpg',axis=1).columns","19caf865":"base_dataset.shape","957d7c96":"def outliers(df):\n    import numpy as np\n    import statistics as sts\n\n    for i in df.describe().columns:\n        x=np.array(df[i])\n        p=[]\n        Q1 = df[i].quantile(0.25)\n        Q3 = df[i].quantile(0.75)\n        IQR = Q3 - Q1\n        LTV= Q1 - (1.5 * IQR)\n        UTV= Q3 + (1.5 * IQR)\n        for j in x:\n            if j <= LTV or j>=UTV:\n                p.append(sts.median(x))\n            else:\n                p.append(j)\n        df[i]=p\n    return df","586116bf":"outliers_treated=outliers(base_dataset[base_dataset.drop('highway-mpg',axis=1).columns])","268fedb8":"outliers_treated.shape","15981566":"import matplotlib.pyplot as plt\nfor i in outliers_treated:\n    plt.hist(outliers_treated[i])\n    plt.show()","43a1f2f8":"outliers_treated=outliers_treated[outliers_treated.describe().columns]\noutliers_treated['const']=1","686c4f92":"outliers_treated","4850b877":"outliers_treated['target']=base_dataset['highway-mpg']\ny=outliers_treated['target']\nx=outliers_treated.drop('target',axis=1)","d1c2432e":"x","bff6c8da":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(x, y, test_size=0.20, random_state=42)","8b99ca82":"print(X_train.shape, X_test.shape, y_train.shape, y_test.shape)","5427dffc":"from sklearn.linear_model import LinearRegression\nlm=LinearRegression()\nlm.fit(X_train,y_train)\npredicted_values=lm.predict(X_test)","ba90c431":"sum(abs(predicted_values-y_test.values))","e4609ecc":"Final = pd.DataFrame(predicted_values)\ny_test=y_test.reset_index()\ny_test = y_test.drop('index',axis = 1)\nFinal['y_test'] = y_test\nprint(Final)","54e90329":"from sklearn.metrics import mean_absolute_error\nMAE=mean_absolute_error(y_test.values,predicted_values)","4447c14a":"from sklearn.metrics import mean_squared_error\nMSE=mean_squared_error(y_test.values,predicted_values)","1985d1bd":"from sklearn.metrics import mean_squared_error\nRMSE=np.sqrt(mean_squared_error(y_test.values,predicted_values))","834fb074":"MAPE=sum(abs((y_test.values-predicted_values)\/(y_test.values)))\/X_test.shape[0]","d7a51bd9":"error_table=pd.DataFrame(predicted_values,y_test.values)","1fe86780":"error_table.reset_index(inplace=True)","6912d5f7":"error_table.columns=['pred','actual']","aa054a6d":"error_table.plot(figsize=(20,8))","655ab026":"### Model Building","3975971c":"### Graph( Actual vs Predicted)","9322de08":"* ### Copy the Data of the Automobile showroom Details.","1258ea2a":"* ### High Way mileage prediction of the Automobile vehicles in th Automobile Industry."}}