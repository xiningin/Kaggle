{"cell_type":{"6bfdc007":"code","95b410ec":"code","9e4b36f6":"code","44ad17f6":"code","6d6a2f29":"code","4e8214f8":"code","80cfd57c":"code","aa67696b":"code","51b42ac2":"code","7d36b150":"code","56dd97f5":"code","8e902bea":"code","e61bf799":"markdown","d81303d4":"markdown","526926e6":"markdown","74008865":"markdown","1475ce4c":"markdown","6d0746b7":"markdown","2198c5a5":"markdown","dcace04d":"markdown","d982c6fa":"markdown"},"source":{"6bfdc007":"import os\nimport matplotlib.pyplot as plt\nimport tifffile\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)","95b410ec":"BASE_PATH = \"..\/input\/hubmap-kidney-segmentation\/\"\nTRAIN_PATH = os.path.join(BASE_PATH, \"train\")\nprint(os.listdir(BASE_PATH))","9e4b36f6":"df_train = pd.read_csv(\n    os.path.join(BASE_PATH, \"train.csv\")\n)\ndf_train","44ad17f6":"df_sub = pd.read_csv(\n    os.path.join(BASE_PATH, \"sample_submission.csv\"))\ndf_sub","6d6a2f29":"print(f\"Number of train images: {df_train.shape[0]}\")\nprint(f\"Number of test images: {df_sub.shape[0]}\")","4e8214f8":"df_info = pd.read_csv(\n    os.path.join(BASE_PATH, \"HuBMAP-20-dataset_information.csv\")\n)\ndf_info","80cfd57c":"im = tifffile.imread(\n    os.path.join(BASE_PATH, \"train\/0486052bb.tiff\")\n)\n#plt.figure(figsize=(16, 16))\n#plt.imshow(im)\n#plt.axis(\"off\");","aa67696b":"# https:\/\/www.kaggle.com\/paulorzp\/rle-functions-run-lenght-encode-decode\ndef rle2mask(mask_rle, shape):\n    '''\n    mask_rle: run-length as string formated (start length)\n    shape: (width,height) of array to return \n    Returns numpy array, 1 - mask, 0 - background\n\n    '''\n    s = mask_rle.split()\n    starts, lengths = [np.asarray(x, dtype=int) for x in (s[0:][::2], s[1:][::2])]\n    starts -= 1\n    ends = starts + lengths\n    img = np.zeros(shape[0]*shape[1], dtype=np.uint8)\n    for lo, hi in zip(starts, ends):\n        img[lo:hi] = 1\n    return img.reshape(shape).T","51b42ac2":"mask = rle2mask(\n    df_train[df_train[\"id\"] == \"0486052bb\"][\"encoding\"].values[0], \n    (im.shape[1], im.shape[0])\n)","7d36b150":"#plt.figure(figsize=(16, 16))\n#plt.imshow(mask)\n#plt.axis(\"off\");","56dd97f5":"im.shape, mask.shape","8e902bea":"plt.figure(figsize=(10,10))\nplt.imshow(im)\nplt.imshow(mask, cmap='coolwarm', alpha=0.5)\nplt.axis(\"off\");","e61bf799":"List all directories and files in the \"train\" directory","d81303d4":"The file \"HuBMAP-20-dataset_information.csv\" shows the extra information about each image, includin patient information. There are 13 rows of data (8 train and 5 test) in this file.","526926e6":"We can read a .tiff file and show it in this way:","74008865":"To see the mask in front of the image, we first have to decode the mask with this function","1475ce4c":"The file \"train.csv\" contains all images and has the ID for each one of them the the masks for each one encoded. This next code shows a sample of the file.","6d0746b7":"The file \"sample_submission.csv\" shows the format for the submission of the contest","2198c5a5":"As seen on the previous cells, there are 8 images as training files and 5 images to test predictions.","dcace04d":"Showing the image with the mask","d982c6fa":"Showing only the mask"}}