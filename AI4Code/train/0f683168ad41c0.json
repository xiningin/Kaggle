{"cell_type":{"7186e675":"code","01e0fa09":"code","24666d7c":"code","a02c831b":"code","b53a2d17":"code","877ff1c7":"code","8ec49c22":"code","532a85de":"code","48d24e4d":"code","38822979":"code","607e9bfd":"code","8cfa5f98":"code","730a2742":"code","ab4230a7":"code","503a5a58":"code","2fb31c83":"code","2825cc2d":"code","24e3e4c4":"code","525ec0f7":"code","ef6f5c2c":"code","79b8bbc8":"code","ea6fdc90":"code","694ca0c2":"code","aa5ef5b9":"code","958703ea":"code","6b1f8bfb":"code","45ab850e":"code","074cac79":"code","f9f82887":"code","b43b0363":"code","f0243770":"code","9615147a":"code","d1ef1e3e":"code","80a043a9":"code","f171a2e6":"code","dcf64779":"code","0f7c8823":"code","22e3c09c":"code","c67d953a":"code","f6f9ff15":"code","7471fe4b":"code","02fd5f28":"code","8f18dbe3":"code","fad5e6ad":"code","f0975c4c":"code","5d5023cc":"code","988de933":"code","8982729f":"code","fca6bcd5":"code","e7c10cc9":"code","b4c3e355":"code","e9d316aa":"code","d2e09969":"code","c958fc62":"code","b961908c":"code","a4bdf868":"code","1576bff8":"code","f810a947":"markdown","0f1a288c":"markdown","c9457ce0":"markdown","47583238":"markdown","f7d6ac92":"markdown","5885bf71":"markdown"},"source":{"7186e675":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport missingno as msno\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import StandardScaler\nimport warnings  \nwarnings.filterwarnings('ignore')","01e0fa09":"data=pd.read_csv('..\/input\/stroke-prediction-dataset\/healthcare-dataset-stroke-data.csv')\ndata.head()","24666d7c":"# Dropping ID Column\ndata=data.drop(['id'],axis=1)\ndata.head()","a02c831b":"data.info()","b53a2d17":"data.isnull().sum()","877ff1c7":"data.describe()","8ec49c22":"fig, axes = plt.subplots(nrows=2, ncols=2, figsize=(12, 10))\ndata.plot(kind=\"hist\", y=\"age\", bins=70, color=\"b\", ax=axes[0][0])\ndata.plot(kind=\"hist\", y=\"bmi\", bins=100, color=\"r\", ax=axes[0][1])\ndata.plot(kind=\"hist\", y=\"heart_disease\", bins=6, color=\"g\", ax=axes[1][0])\ndata.plot(kind=\"hist\", y=\"avg_glucose_level\", bins=100, color=\"orange\", ax=axes[1][1])\nplt.show()","532a85de":"# Stroke Piechart\n\nlabels =data['stroke'].value_counts(sort = True).index\nsizes = data['stroke'].value_counts(sort = True)\n\ncolors = [\"green\",\"red\"]\nexplode = (0.05,0) \n \nplt.figure(figsize=(7,7))\nplt.pie(sizes, explode=explode, labels=labels, colors=colors, autopct='%1.1f%%', shadow=True, startangle=90,)\nplt.show()\n","48d24e4d":"# Displaying Missing Values\nmsno.bar(data)","38822979":"# Filling Missing value with Mean\ndata['bmi'].fillna(data['bmi'].mean(),inplace=True)\ndata.isnull().sum()","607e9bfd":"sns.countplot(data['gender'])","8cfa5f98":"sns.boxplot(data['age'])","730a2742":"sns.countplot(data['work_type'])","ab4230a7":"sns.countplot(data['Residence_type'])","503a5a58":"sns.countplot(data['smoking_status'])","2fb31c83":"sns.countplot(data['ever_married'])","2825cc2d":"sns.countplot(data['stroke'])","24e3e4c4":"data['work_type'].nunique()","525ec0f7":"data['work_type']= data['work_type'].map({'Private':0, 'Self-employed': 1, 'Govt_job':2, 'children':3, 'Never_worked':4})","ef6f5c2c":"data['work_type'].head()","79b8bbc8":"data['gender'] = data['gender'].map({'Male':0, 'Female':1})\ndata['Residence_type'] = data['Residence_type'].map({'Urban':0, 'Rural':1})\ndata['smoking_status'] = data['smoking_status'].map({'formerly smoked':0, 'never smoked':1, 'smokes':2, 'Unknown':3})\ndata['ever_married'] = data['ever_married'].map({'Yes':0, 'No':1})\n","ea6fdc90":"data.head()","694ca0c2":"plt.figure(figsize=(16,10))\nsns.heatmap(data.corr(method='pearson'), annot=True)","aa5ef5b9":"plt.figure(figsize=(16,10))\nsns.scatterplot(x=data['age'], y=data['avg_glucose_level'])","958703ea":"plt.figure(figsize=(20,15))\nsns.catplot(x='heart_disease',y='age', hue=\"work_type\", kind=\"bar\", data=data)","6b1f8bfb":"sns.catplot(x='hypertension',y='age', hue=\"work_type\", kind=\"bar\", data=data)","45ab850e":"sns.catplot(x=\"smoking_status\", y=\"stroke\", hue=\"work_type\", kind=\"bar\", data=data)\n","074cac79":"sns.catplot(x=\"hypertension\", y=\"stroke\", hue=\"work_type\", kind=\"bar\", data=data)","f9f82887":"sns.catplot(x=\"Residence_type\", y=\"stroke\", hue=\"work_type\", kind=\"bar\", data=data)","b43b0363":"sns.catplot(x='stroke', y=\"avg_glucose_level\", kind=\"box\", data=data)","f0243770":"features = ['age',\n 'hypertension',\n 'heart_disease',\n 'ever_married',\n 'Residence_type',\n 'avg_glucose_level',\n 'bmi',\n 'gender',\n 'work_type',\n 'smoking_status']\n\nlabel = ['stroke']\n\nX = data[features]\ny = data[label]","9615147a":"X.isnull().sum()","d1ef1e3e":"X.isnull().sum()","80a043a9":"X.gender=(X.gender.fillna(1))","f171a2e6":"# Treating Imbalance Data using SMOTE\n\nfrom imblearn.over_sampling import SMOTE\nsmote=SMOTE()\nx_smote,y_smote=smote.fit_resample(X,y)","dcf64779":"from sklearn.model_selection import train_test_split\nX_train,X_test, y_train,y_test=train_test_split(x_smote,y_smote,test_size=0.33,random_state=42)\nX_valid, X_test, y_valid, y_test = train_test_split(X_test, y_test, test_size=0.5, random_state=42)","0f7c8823":"X_train.head()","22e3c09c":"y_train.head()","c67d953a":"# Rescaling Data\nsc= StandardScaler()\nX_train = sc.fit_transform(X_train)\nX_test = sc.transform(X_test)","f6f9ff15":"X_train","7471fe4b":"X_test","02fd5f28":"from sklearn.linear_model import LogisticRegression\nLR=LogisticRegression()","8f18dbe3":"LR.fit(X_train,y_train)\n","fad5e6ad":"y_pred=LR.predict(X_test)","f0975c4c":" y_pred","5d5023cc":"from sklearn.metrics import f1_score,roc_auc_score,accuracy_score,confusion_matrix,precision_recall_curve,auc,roc_curve,recall_score, classification_report\n","988de933":"class_report=classification_report(y_test,y_pred)\nprint(class_report)","8982729f":"auc = roc_auc_score(y_test, y_pred)\nauc","fca6bcd5":"cm = confusion_matrix(y_test, y_pred)\ncm","e7c10cc9":"predicted_probab_log = LR.predict_proba(X_test)\npredicted_probab_log = predicted_probab_log[:, 1]\nfpr, tpr, _ = roc_curve(y_test, predicted_probab_log)","b4c3e355":"from matplotlib import pyplot\npyplot.plot(fpr, tpr, marker='.', label='Logistic Regression')\npyplot.xlabel('False Positive Rate')\npyplot.ylabel('True Positive Rate')\npyplot.legend()\npyplot.show()","e9d316aa":"from sklearn.ensemble import RandomForestClassifier\nRF = RandomForestClassifier()\nRF.fit(X_train, y_train)","d2e09969":"RF_pred=RF.predict(X_test)\nroc_auc_score(y_test, RF_pred)","c958fc62":"cm = confusion_matrix(y_test, RF_pred)\ncm\n","b961908c":"predicted_probab = RF.predict_proba(X_test)\npredicted_probab = predicted_probab[:, 1]","a4bdf868":"fpr, tpr, _ = roc_curve(y_test, predicted_probab)","1576bff8":"from matplotlib import pyplot\npyplot.plot(fpr, tpr, marker='.', color='red', label='Random Forest')\npyplot.xlabel('False Positive Rate')\npyplot.ylabel('True Positive Rate')\npyplot.legend()\npyplot.show()","f810a947":"**Sucessfully removed all the Null Values**","0f1a288c":"**There are large Number of People who Work in Private Sector**","c9457ce0":"<h1 style=\"background-color:powderblue;font-family:newtimeroman;font-size:350%;text-align:center;border-radius: 15px 50px;\"><b>Stroke Prediction <\/b><\/h1>","47583238":"## Applying ML Algorithm","f7d6ac92":"**The Data is Highly Imbalanced**","5885bf71":"#### MAPPING OF CATEGORICAL VARIABLES"}}