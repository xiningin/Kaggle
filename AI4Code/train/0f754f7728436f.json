{"cell_type":{"7aa42d97":"code","150532c6":"code","f6ba88c6":"code","63f0d098":"code","cdd12d1e":"code","b269a5b5":"code","656d9837":"code","85f3bbd6":"code","3315e916":"code","fdba1bdc":"code","fae2c98e":"code","acbe575e":"code","b86780dc":"code","1b57080e":"code","c496d9c3":"code","34cf1165":"code","fca646e1":"code","fc095680":"code","02f99f05":"code","b84f4121":"code","772378a3":"code","43696f33":"code","41097b5b":"code","bb665c3a":"code","b8ab995e":"code","58a0fb52":"code","00328fc6":"code","e56c323b":"code","97eb992a":"code","e3196ce6":"code","08dd65d8":"markdown","3212f404":"markdown","048e10fe":"markdown","1e567208":"markdown","1b44f109":"markdown","d94fe5d2":"markdown","068b11e0":"markdown","c8c3a550":"markdown","73193be4":"markdown","cb6647dd":"markdown","9e5a3e44":"markdown","87b188c5":"markdown"},"source":{"7aa42d97":"import warnings\nwarnings.filterwarnings('ignore')\n\nimport numpy as np\nimport seaborn as sns\nimport os\nimport pandas as pd\nimport matplotlib.pyplot as plt\n\nfrom sklearn import preprocessing, metrics, model_selection, linear_model, ensemble, tree, svm","150532c6":"## loadin the dataset\n##\/kaggle\/input\/insurance\/insurance.csv\n##df = pd.read_csv('insurance.csv')\ndf = pd.read_csv('\/kaggle\/input\/insurance\/insurance.csv')\ndf.head()","f6ba88c6":"## checking null values in the dataset\ndf.isna().sum()","63f0d098":"df.info()","cdd12d1e":"## distinguishing the categorical and continuous variables\n\ncat_var = []\ncon_var = []\nfor col in df.columns:\n    if df[col].dtype == 'object':\n        cat_var.append(col)\n    else:\n        con_var.append(col)\n\nprint(\"Categorical Varibales are:- \\n\",cat_var)\nprint(\"\\nContinuous Varibales are:- \\n\",con_var)\n\n        ","b269a5b5":"for col in cat_var:\n    print(\"Column Name:-\",col)\n    print(\"unique value(%)\", str(round( df[col].nunique() * 100 \/ df[col].count() , 2 )))\n    print(\"Unique Values are:-\",list(df[col].unique()))\n    print(\"-\"*60)","656d9837":"## Basic EDA Starts here","85f3bbd6":"sns.countplot(df.smoker, hue = df.sex)\nplt.show()","3315e916":"df.groupby(['sex'])['smoker'].value_counts(normalize=True)","fdba1bdc":"plt.figure(figsize=(8,6))\nsns.barplot(y = df.charges, x = df.region, hue = df.smoker, estimator=np.mean)\nplt.show()","fae2c98e":"## Impact of the number of children over smoking habits\n\nsns.countplot(x = df.children, hue = df.smoker)\nplt.show()","acbe575e":"df.groupby(['children'])['smoker'].value_counts(normalize = True)","b86780dc":"## Impact of smoking over charges\n\nsns.distplot(df[df['smoker'] == 'yes'].charges, color = 'c')\nplt.plot()","1b57080e":"\nsns.distplot(df[df['smoker'] == 'no'].charges, color = 'c')\nplt.plot()","c496d9c3":"sns.scatterplot(x = df.age, y = df.charges, hue = df.smoker)\nplt.show()","34cf1165":"plt.figure(figsize=(6,6))\nsns.violinplot(y = df.charges, x = df.region, hue = df.smoker, split=True)\nplt.show()","fca646e1":"## Distribution of the Age \n\nplt.figure(figsize=(8,4))\nsns.distplot(df.age, color='r')\nplt.show()","fc095680":"## bmi distribution\n\nplt.figure(figsize=(8,4))\nsns.distplot(df.bmi)\nplt.show()","02f99f05":"plt.figure(figsize=(8,8))\nsns.jointplot(x = df.bmi, y = df.charges, hue = df.children)\nplt.show()","b84f4121":"plt.figure(figsize=(8,8))\nsns.jointplot(x = df.bmi, y = df.charges, hue = df.smoker)\nplt.show()","772378a3":"plt.figure(figsize=(8,6))\nsns.scatterplot(x = df.bmi, y=df.charges, hue = df.smoker)\nplt.show()","43696f33":"## conversion of the categorical data into continuous data\n\n## method 1\n## using LabelEncoding\nfor col in cat_var:\n    encoder = preprocessing.LabelEncoder()\n    encoder.fit(df[col])\n    df[col] = encoder.transform(df[col])\n    ","41097b5b":"df.describe()","bb665c3a":"## plotting corelation matrix\n\nplt.figure(figsize=(8,6))\n\nsns.heatmap(df.corr(), annot = True)\nplt.show()","b8ab995e":"## Model Seletion\n\nx = df.drop(['charges'],axis=1)\ny = df.charges\n\nx_train, x_test, y_train, y_test = model_selection.train_test_split(x,y, random_state = 7)","58a0fb52":"scaler = preprocessing.MinMaxScaler()\n\nscaler.fit(x_train)\nx_train = scaler.transform(x_train)\nx_test = scaler.transform(x_test)","00328fc6":"reg = linear_model.LinearRegression()\nreg.fit(x_train, y_train)\n\ny_pred = reg.predict(x_test)\n\nprint(\"Score of the regressor is\",reg.score(x_test, y_test))\nprint(\"Mean Square Error is\", metrics.mean_squared_error(y_test, y_pred))\nprint(\"Mean Absolute Error is\", metrics.mean_absolute_error(y_test, y_pred))\n","e56c323b":"reg = ensemble.RandomForestRegressor()\nreg.fit(x_train, y_train)\n\ny_pred = reg.predict(x_test)\n\nprint(\"Score of the regressor is\",reg.score(x_test, y_test))\nprint(\"Mean Square Error is\", metrics.mean_squared_error(y_test, y_pred))\nprint(\"Mean Absolute Error is\", metrics.mean_absolute_error(y_test, y_pred))\n","97eb992a":"reg = tree.DecisionTreeRegressor()\nreg.fit(x_train, y_train)\n\ny_pred = reg.predict(x_test)\n\nprint(\"Score of the regressor is\",reg.score(x_test, y_test))\nprint(\"Mean Square Error is\", metrics.mean_squared_error(y_test, y_pred))\nprint(\"Mean Absolute Error is\", metrics.mean_absolute_error(y_test, y_pred))\n","e3196ce6":"reg = svm.SVR()\nreg.fit(x_train, y_train)\n\ny_pred = reg.predict(x_test)\n\nprint(\"Score of the regressor is\",reg.score(x_test, y_test))\nprint(\"Mean Square Error is\", metrics.mean_squared_error(y_test, y_pred))\nprint(\"Mean Absolute Error is\", metrics.mean_absolute_error(y_test, y_pred))\n","08dd65d8":"### Smoking vs Sex","3212f404":"#### As per the above graph, we can see that people who smokes have more medical costage than non-smoker and they are basically from SouthEast region","048e10fe":"### Most of the people are under the age of the 20 and the maximum age is 64","1e567208":"### As we can see from above graph that majority of the people have bmi in between 25 to 35 and people who smokes have more medical costage","1b44f109":"### As we can see that most of the smoking people adhre charges more as compared to Non Smoking people","d94fe5d2":"### bmi Distribution ","068b11e0":"Thankyou for reading!!","c8c3a550":"### As we can see that medical costage is increasing as the age is increasing and costage is always higher for smoking people as compared to non-smoking people","73193be4":"### smoking habits does not depend over the number of children","cb6647dd":"### As we can see from above graph that majority of the people have bmi in between 25 to 35 and people who smokes have more medical costage","9e5a3e44":"### As we can see that charges are majorly dependent over the smoking habits of the People","87b188c5":"### No Null values in the dataset"}}