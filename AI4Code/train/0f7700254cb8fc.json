{"cell_type":{"bcf30574":"code","ac6b2637":"code","b0ba4838":"code","d7720ec6":"code","a0751195":"code","984d0a6a":"code","e5d095ce":"code","976a163f":"code","0f1a3ba2":"code","3a2eb06f":"code","344621e7":"code","03da20bd":"code","670c9716":"code","d634e73d":"code","26549e3f":"code","ea521be0":"code","6d1b4900":"code","3c8dd286":"code","2214ca22":"code","d37c4200":"code","89b9adbc":"code","01ed0b42":"code","1b35c148":"code","5b0fe418":"markdown","d6a05cfc":"markdown","f8be1c05":"markdown","9fb16862":"markdown","9e37a0c9":"markdown","10146400":"markdown","33f69955":"markdown","780846e4":"markdown","5b1e44b9":"markdown","476b3823":"markdown"},"source":{"bcf30574":"import numpy as np \nimport pandas as pd \nimport matplotlib.pyplot as plt \nimport seaborn as sns","ac6b2637":"df = pd.read_csv('..\/input\/mall-customers\/Mall_Customers.csv')","b0ba4838":"df.head(5)","d7720ec6":"df = df.rename(columns={'Genre':'Gender'})","a0751195":"df.head(5)","984d0a6a":"df.shape","e5d095ce":"# Finding whether there are missing values\ndf.isnull().sum()","976a163f":"df.describe()","0f1a3ba2":"feature = df.drop(columns='CustomerID')","3a2eb06f":"sns.pairplot(feature,kind=\"scatter\")","344621e7":"# Ratio of male and female\ngender_count = df['Gender'].value_counts()\nplt.pie(gender_count.values, labels=gender_count.index, labeldistance=1.2, \n        wedgeprops = { 'linewidth' : 3, 'edgecolor' : 'white' })","03da20bd":"plt.figure(figsize = (20 , 10))\nn=1\nfor x in ['Age' , 'Annual Income (k$)' , 'Spending Score (1-100)']:\n    plt.subplot(1,3,n)\n    plt.subplots_adjust(hspace =0.5 , wspace = 0.2)\n    sns.distplot(df[x], bins = 15)\n    plt.title('{} Distribution'.format(x))\n    n+=1","670c9716":"from sklearn.cluster import KMeans","d634e73d":"# Turn non-numeric feature into number\n# Male=0, Female=1\nfeature.loc[feature['Gender']=='Male','Gender']=0\nfeature.loc[feature['Gender']=='Female','Gender']=1","26549e3f":"inertias = []\nfor i in range(1, 11):\n    km = KMeans(n_clusters=i).fit(feature)\n    inertias.append(km.inertia_)","ea521be0":"plt.plot(range(1, 11), inertias, 'bx-')\nplt.xlabel('Values of K')\nplt.ylabel('Inertia')\nplt.title('The Elbow Method using Inertia')\nplt.show()","6d1b4900":"inertias","3c8dd286":"# 3 clusterings\n# No of customers in each group respectively\nkm = KMeans(n_clusters=3).fit(feature)\ny_km = km.fit_predict(feature)\nn_cluster, km_count = np.unique(y_km, return_counts=True)\nplt.bar(n_cluster, km_count)\nplt.ylabel('No of customer')\nplt.xlabel('Clustering')\nplt.title('Customer segmentation by 3 groups')","2214ca22":"plt.scatter(df['Annual Income (k$)'], \n            df['Spending Score (1-100)'], \n            c=y_km, s=100)\n\n\nplt.xlabel('Annual Income')\nplt.ylabel('Spending Score')\nplt.title('Customer segmentation by 3 groups')\n\nplt.show()","d37c4200":"# 4 clusterings\n# No of customers in each group respectively\nkm = KMeans(n_clusters=4).fit(feature)\ny_km = km.fit_predict(feature)\nn_cluster, km_count = np.unique(y_km, return_counts=True)\nplt.bar(n_cluster, km_count)\nplt.ylabel('No of customer')\nplt.xlabel('Clustering')\nplt.title('Customer segmentation by 4 groups')\n","89b9adbc":"plt.scatter(df['Annual Income (k$)'], \n            df['Spending Score (1-100)'], \n            c=y_km, s=100)\n\n\nplt.xlabel('Annual Income')\nplt.ylabel('Spending Score')\nplt.title('Customer segmentation by 4 groups')\n\nplt.show()","01ed0b42":"# 5 clusterings\n# No of customers in each group respectively\nkm = KMeans(n_clusters=5).fit(feature)\ny_km = km.fit_predict(feature)\nn_cluster, km_count = np.unique(y_km, return_counts=True)\nplt.bar(n_cluster, km_count)\nplt.ylabel('No of customer')\nplt.xlabel('Clustering')\nplt.title('Customer segmentation by 5 groups')","1b35c148":"plt.scatter(df['Annual Income (k$)'], \n            df['Spending Score (1-100)'], \n            c=y_km, s=100)\n\n\nplt.xlabel('Annual Income')\nplt.ylabel('Spending Score')\nplt.title('Customer segmentation by 5 groups')\n\nplt.show()","5b0fe418":"# EDA","d6a05cfc":"# Mall customer segmentation by K-Means","f8be1c05":"Distortion mainly appear when k is between 3 and 5, so we should try k=3\/4\/5.","9fb16862":"# Modelling ","9e37a0c9":"Annual income and spending score have higher sd than age, meaning that they are dispersed and may help clustering.","10146400":"if we look at the pairplot of annual income and spending score, it is obvious that the customers can be divided into 5. \n\nCombining age and spending, it can be divided into 2 groups: top-left and bottom-right, purchasing power of youngers is relatively higher.","33f69955":"# Elbow Method\n- Objective: Find optimal value of k in KMeans\n\n- Principal: \n\n    plots the value of cost function produced by different values of k. When k increases, the data-point can be further \"voted\" to the nearest cluster and the distances between the respective centroids will decrease. However, the improvements in sum of squared  error (SSE) will decline and start to level-off with the increase of k. Such distortion resembles \"elbow\".\n\n\n- Terms:\n\n    1. Distortion\naverage of the euclidean squared distance from the centroid of the respective clusters\n\n    2. Inertia\nSum of squared distances of samples to their closest cluster center\n","780846e4":"# Clustering by k-means","5b1e44b9":"K-means clustering is a type of unsupervised learning, it is usually used when we don't know their groups\/categories. The algorithm assign each data point to one of K groups based on the features similarity. \n\nIt is useful to find groups which have not been explicitly labeled in the data. This can be used to confirm business assumptions about what types of groups exist or to identify unknown groups in complex data sets.","476b3823":"If we take a deep dive into the features, it is observed that spending score has 3 peaks(0-20,40-60,80-100), as for annual income, it tends to right-skewed."}}