{"cell_type":{"b1c1039b":"code","b7c793f7":"code","231d4910":"code","6a8dc675":"code","2df8ac49":"code","378ad93c":"code","4368d473":"code","9717aadc":"code","1d71ac6b":"code","586e4515":"code","0531cb24":"code","6dec0eff":"code","2e00e3bc":"code","8ae90c36":"code","619f88ac":"code","30612b93":"markdown","833dfa17":"markdown","8625645b":"markdown","3e1859f2":"markdown","e6202d5a":"markdown","017d6ba5":"markdown","ff2d62e6":"markdown","0c8c1b49":"markdown"},"source":{"b1c1039b":"!pip install -U lightautoml","b7c793f7":"import numpy as np\nimport pandas as pd\nimport lib_accii_53","231d4910":"from lightautoml.automl.presets.tabular_presets import TabularAutoML\nfrom lightautoml.tasks import Task\nfrom lightautoml.validation.np_iterators import TimeSeriesIterator","6a8dc675":"from sklearn.model_selection import train_test_split\nfrom sklearn.metrics import f1_score","2df8ac49":"WINDOW = 10\nTIMEOUT = 300","378ad93c":"dclose = lib_accii_53.get_dClose()","4368d473":"df = pd.DataFrame()\ndf['target'] = (dclose.iloc[:,0].shift(-1) > 0)*1.0\nfor w in range(WINDOW):\n    df[f'inp{w}'] = dclose.iloc[:,0].shift(w)\ndf","9717aadc":"train_df,test_df = train_test_split(df,test_size=0.3,shuffle=False)","1d71ac6b":"automl = TabularAutoML(\n    task = Task(\n        name = 'binary'\n    ),\n    timeout=TIMEOUT\n)","586e4515":"cv_iter = TimeSeriesIterator(train_df.index.values.astype(np.datetime64), n_splits=15, sorted_kfold=False)","0531cb24":"oof_pred = automl.fit_predict(\n    train_df,\n    roles = {'target' : 'target'},\n    cv_iter=cv_iter\n)","6dec0eff":"f1_score(train_df['target'].values,(oof_pred.data[:,0]>0.5)*1)","2e00e3bc":"test_pred = automl.predict(test_df)","8ae90c36":"f1_score(test_df['target'].values,(test_pred.data[:,0]>0.5)*1)","619f88ac":"automl.get_feature_scores().set_index('Feature').plot.bar()","30612b93":"# \u0411\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0438 \u043f\u043e\u0434\u0433\u0440\u0443\u0436\u0430\u0435\u043c","833dfa17":"# \u0423\u0447\u0438\u043c \u043c\u043e\u0434\u0435\u043b\u044c","8625645b":"# \u0421\u043e\u0437\u0434\u0430\u0435\u043c \u043c\u043e\u0434\u0435\u043b\u044c","3e1859f2":"# \u041a\u043e\u0442\u0438\u0440\u043e\u0432\u043a\u0438 \u043f\u043e\u0434\u0433\u0440\u0443\u0436\u0430\u0435\u043c","e6202d5a":"# \u0412\u0430\u0436\u043d\u043e\u0441\u0442\u044c \u043f\u0440\u0438\u0437\u043d\u0430\u043a\u043e\u0432","017d6ba5":"# \u0413\u043e\u0442\u043e\u0432\u0438\u043c \u0432\u0445\u043e\u0434 \u0438 \u0432\u044b\u0445\u043e\u0434","ff2d62e6":"# \u0413\u043b\u0430\u0431\u0430\u043b\u044c\u043d\u044b\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438","0c8c1b49":"# \u041a\u0430\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u0440\u043e\u0433\u043d\u043e\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f"}}