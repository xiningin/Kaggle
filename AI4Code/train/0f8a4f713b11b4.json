{"cell_type":{"c65d74cc":"code","9ddaa0ca":"code","8e2c7871":"code","53b54abd":"code","b39c4646":"code","8d175abb":"code","8bec4b8d":"code","9d95b93a":"code","efa661d3":"code","6bd2dcc8":"code","2f37ed3f":"code","b33fdaa2":"code","21c88ff6":"code","ee7b6e2c":"code","eaa6e2d9":"markdown","97349a8f":"markdown","fdce2eba":"markdown","cbaed1cc":"markdown","9576f2fe":"markdown","7bad0a0c":"markdown","d0cc3365":"markdown"},"source":{"c65d74cc":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","9ddaa0ca":"import pandas as pd\nimport math\nimport scipy.stats as st\n\npd.set_option('display.max_columns', None)\n# pd.set_option('display.max_rows', 10)\npd.set_option('display.expand_frame_repr', False)\npd.set_option('display.float_format', lambda x: '%.5f' % x)","8e2c7871":"def score_up_down_diff(up, down):\n    return up - down\n\n\ndef score_average_rating(up, down):\n    if up + down == 0:\n        return 0\n    return up \/ (up + down)","53b54abd":"def wilson_lower_bound(up, down, confidence=0.95):\n    \"\"\"\n    Wilson Lower Bound Score hesapla\n\n    - Bernoulli parametresi p i\u00e7in hesaplanacak g\u00fcven aral\u0131\u011f\u0131n\u0131n alt s\u0131n\u0131r\u0131 WLB skoru olarak kabul edilir.\n    - Hesaplanacak skor \u00fcr\u00fcn s\u0131ralamas\u0131 i\u00e7in kullan\u0131l\u0131r.\n    - Not:\n    E\u011fer skorlar 1-5 aras\u0131daysa 1-3 negatif, 4-5 pozitif olarak i\u015faretlenir ve bernoulli'ye uygun hale getirilebilir.\n    Bu beraberinde baz\u0131 problemleri de getirir. Bu sebeple bayesian average rating yapmak gerekir.\n\n    Parameters\n    ----------\n    up: int\n        up count\n    down: int\n        down count\n    confidence: float\n        confidence\n\n    Returns\n    -------\n    wilson score: float\n\n    \"\"\"\n    n = up + down\n    if n == 0:\n        return 0\n    z = st.norm.ppf(1 - (1 - confidence) \/ 2)\n    phat = 1.0 * up \/ n\n    return (phat + z * z \/ (2 * n) - z * math.sqrt((phat * (1 - phat) + z * z \/ (4 * n)) \/ n)) \/ (1 + z * z \/ n)","b39c4646":"###################################################\n# 1. Veri Setini Okutunuz ve \u00dcr\u00fcn\u00fcn Ortalama Puan\u0131n\u0131 Hesaplay\u0131n\u0131z.\n###################################################\n\ndf = pd.read_csv(\"\/kaggle\/input\/datasets1\/amazon_review.csv\")\n\n# Tek bir \u00fcr\u00fcn yer almakta. Bu \u00fcr\u00fcne yap\u0131lan yorumlamalar var bunlar\u0131 s\u0131ralayaca\u011f\u0131z.\ndf.asin.value_counts()","8d175abb":"# ortalama rating\ndf[\"overall\"].mean()\n","8bec4b8d":"# day_diff: yorum sonras\u0131 ne kadar g\u00fcn ge\u00e7mi\u015f\n# df['reviewTime'] = pd.to_datetime(df['reviewTime'], dayfirst=True)\n\n# day_first arg\u00fcman\u0131 ne i\u015flem yapmakta ?\n# datetime \u00e7eviri yapt\u0131\u011f\u0131nda \"year-month-day\" \u015feklinde \u00e7evirmektedir.\n# \"day_first=True\" arg\u00fcman\u0131n\u0131 kullanarak year-day-month \u015feklinde kullan\u0131m sa\u011flanabilmektedir.\n# G\u00fcn\u00fc \u00f6nceleklendirme i\u015flemi yapmaktad\u0131r.\ndf2 = pd.DataFrame(['4\/11\/2000', '4\/12\/2000', '4\/13\/2000'], columns=[\"date\"])\npd.to_datetime(df2['date'])\n","9d95b93a":"pd.to_datetime(df2['date'], dayfirst=True)","efa661d3":"current_date = pd.to_datetime(str(df['reviewTime'].max()))\ndf[\"day_diff\"] = (current_date - df['reviewTime']).dt.days","6bd2dcc8":"# day_diff de\u011fi\u015fkeninin \u00e7eyrek de\u011ferlerini elde etme:\na = df[\"day_diff\"].quantile(0.25)\nb = df[\"day_diff\"].quantile(0.50)\nc = df[\"day_diff\"].quantile(0.75)\n\ndf[\"day_diff\"].describe().T","2f37ed3f":"# a,b,c de\u011ferlerine g\u00f6re a\u011f\u0131rl\u0131kl\u0131 puan\u0131 hesaplama:\ndf.loc[df[\"day_diff\"] <= a, \"overall\"].mean() * 28 \/ 100 + \\\ndf.loc[(df[\"day_diff\"] > a) & (df[\"day_diff\"] <= b), \"overall\"].mean() * 26 \/ 100 + \\\ndf.loc[(df[\"day_diff\"] > b) & (df[\"day_diff\"] <= c), \"overall\"].mean() * 24 \/ 100 + \\\ndf.loc[(df[\"day_diff\"] > c), \"overall\"].mean() * 22 \/ 100","b33fdaa2":"###################################################\n# G\u00f6rev 2: \u00dcr\u00fcn i\u00e7in \u00dcr\u00fcn Detay Sayfas\u0131nda G\u00f6r\u00fcnt\u00fclenecek 20 Review'i Belirleyiniz.\n###################################################\n\n\n###################################################\n# Ad\u0131m 1. helpful_no De\u011fi\u015fkenini \u00dcretiniz\n###################################################\n\n# Not:\n# total_vote bir yoruma verilen toplam up-down say\u0131s\u0131d\u0131r.\n# up, helpful demektir.\n# veri setinde helpful_no de\u011fi\u015fkeni yoktur, var olan de\u011fi\u015fkenler \u00fczerinden \u00fcretilmesi gerekmektedir.\n\n\ndf[\"helpful_no\"] = df[\"total_vote\"] - df[\"helpful_yes\"]\n\ndf = df[[\"reviewerName\", \"overall\", \"summary\", \"helpful_yes\", \"helpful_no\", \"total_vote\", \"reviewTime\"]]\ndf.head()","21c88ff6":"###################################################\n# Ad\u0131m 2. score_pos_neg_diff, score_average_rating ve wilson_lower_bound Skorlar\u0131n\u0131 Hesaplay\u0131p Veriye Ekleyiniz\n###################################################\n\n# score_pos_neg_diff\ndf[\"score_pos_neg_diff\"] = df.apply(lambda x: score_up_down_diff(x[\"helpful_yes\"], x[\"helpful_no\"]), axis=1)\n\n# score_average_rating\ndf[\"score_average_rating\"] = df.apply(lambda x: score_average_rating(x[\"helpful_yes\"], x[\"helpful_no\"]), axis=1)\n\n# wilson_lower_bound\ndf[\"wilson_lower_bound\"] = df.apply(lambda x: wilson_lower_bound(x[\"helpful_yes\"], x[\"helpful_no\"]), axis=1)\ndf.head()","ee7b6e2c":"##################################################\n# Ad\u0131m 3. 20 Yorumu Belirleyiniz ve Sonu\u00e7lar\u0131 Yorumlay\u0131n\u0131z.\n###################################################\n\ndf.sort_values(\"wilson_lower_bound\", ascending=False).head(20)","eaa6e2d9":"###################################################\n# G\u00d6REV 1: Average Rating'i G\u00fcncel Yorumlara G\u00f6re Hesaplay\u0131n\u0131z ve Var Olan Average Rating ile K\u0131yaslay\u0131n\u0131z.\n###################################################\n\n* Payla\u015f\u0131lan veri setinde kullan\u0131c\u0131lar bir \u00fcr\u00fcne puanlar vermi\u015f ve yorumlar yapm\u0131\u015ft\u0131r.\n\n*  Bu g\u00f6revde amac\u0131m\u0131z verilen puanlar\u0131 tarihe g\u00f6re a\u011f\u0131rl\u0131kland\u0131rarak de\u011ferlendirmek.\n \n*  \u0130lk ortalama puan ile elde edilecek tarihe g\u00f6re a\u011f\u0131rl\u0131kl\u0131 puan\u0131n kar\u015f\u0131la\u015ft\u0131r\u0131lmas\u0131 gerekmektedir.\n","97349a8f":"###################################################\n# Ad\u0131m 2. score_pos_neg_diff, score_average_rating ve wilson_lower_bound Skorlar\u0131n\u0131 Hesaplay\u0131p Veriye Ekleyiniz\n###################################################","fdce2eba":"###################################################\n# G\u00f6rev 2: \u00dcr\u00fcn i\u00e7in \u00dcr\u00fcn Detay Sayfas\u0131nda G\u00f6r\u00fcnt\u00fclenecek 20 Review'i Belirleyiniz.\n###################################################\n\n\n###################################################\n# Ad\u0131m 1. helpful_no De\u011fi\u015fkenini \u00dcretiniz\n###################################################\n\n- Not:\n- total_vote bir yoruma verilen toplam up-down say\u0131s\u0131d\u0131r.\n- up, helpful demektir.\n- veri setinde helpful_no de\u011fi\u015fkeni yoktur, var olan de\u011fi\u015fkenler \u00fczerinden \u00fcretilmesi gerekmektedir.","cbaed1cc":"###################################################\n# 2. Tarihe G\u00f6re A\u011f\u0131rl\u0131kl\u0131 Puan Ortalamas\u0131n\u0131 Hesaplay\u0131n\u0131z. (M\u00fc\u015fterilerin ilgi trendinide puana yans\u0131tma imkan\u0131 sa\u011flar)\n###################################################\n\n- Tarihlere g\u00f6re a\u011f\u0131rl\u0131kl\u0131 puan hesab\u0131 yapabilmek i\u00e7in:\n-   - reviewTime de\u011fi\u015fkenini tarih de\u011fi\u015fkeni olarak tan\u0131tman\u0131z\n-   - reviewTime'\u0131n max de\u011ferini current_date olarak kabul etmeniz\n-   - her bir puan-yorum tarihi ile current_date'in fark\u0131n\u0131 g\u00fcn cinsinden ifade ederek yeni de\u011fi\u015fken olu\u015fturman\u0131z\n-   - ve g\u00fcn cinsinden ifade edilen de\u011fi\u015fkeni quantile fonksiyonu ile 4'e b\u00f6l\u00fcp (3 \u00e7eyrek verilirse 4 par\u00e7a \u00e7\u0131kar)\n-   - \u00e7eyrekliklerden gelen de\u011ferlere g\u00f6re a\u011f\u0131rl\u0131kland\u0131rma yapman\u0131z gerekir.\n-   - \u00f6rne\u011fin q1 = 12 ise a\u011f\u0131rl\u0131kland\u0131r\u0131rken 12 g\u00fcnden az s\u00fcre \u00f6nce yap\u0131lan yorumlar\u0131n ortalamas\u0131n\u0131 al\u0131p bunlara\n-   - y\u00fcksek a\u011f\u0131rl\u0131k vermek gibi.\n","9576f2fe":"###################################################\n# PROJE: Rating Product & Sorting Reviews in Amazon\n###################################################\n\n\n* Product rating: Bir \u00fcr\u00fcn nas\u0131l puanlan\u0131yor.  ortalama, zamana g\u00f6re ve kullan\u0131c\u0131lara g\u00f6re a\u011f\u0131rl\u0131kland\u0131rma,\n\n* Sorting produtc:\n* Ratinglere s\u0131ralama,\n\n* Social proof (Comment Say\u0131s\u0131 * Purchase Count),\n\n* Rating * Social Proof,\n\n* Bayesian Rating\n \n* Sorting Comment Product:\n1.  - Pozitif Oylar - Negatif Oylar,\n1.  - Avarage Rating: Pozitif Oy say\u0131s\u0131 \/ Toplam Oy Say\u0131s\u0131,\n1.  - Wilson Lower Bound Score\n\n http:\/\/jmcauley.ucsd.edu\/data\/amazon\/links.html","7bad0a0c":"##################################################\n# Ad\u0131m 3. 20 Yorumu Belirleyiniz ve Sonu\u00e7lar\u0131 Yorumlay\u0131n\u0131z.\n###################################################","d0cc3365":"\n# Veri Seti Hikayesi:\n# Elektronik kategorisindeki en fazla yorum alan \u00fcr\u00fcn\u00fcn kullan\u0131c\u0131 puanlar\u0131 ve yorumlar\u0131 vard\u0131r.\n\n# De\u011fi\u015fkenler:\n- reviewerID - Kullan\u0131c\u0131 ID'si \u00d6rn: A2SUAM1J3GNN3B\n- asin - \u00dcr\u00fcn ID'si: 0000013714\n-reviewerName - Kullan\u0131c\u0131 ad\u0131\n- helpful - Faydal\u0131 yorum derecesi 2\/3, [3,6] 3 faydal\u0131 oy say\u0131s\u0131 6 ise toplam oy say\u0131s\u0131n\u0131 ifade etmektedir.\n- reviewText - Yorum, Kullan\u0131c\u0131n\u0131n yazd\u0131\u011f\u0131 inceleme metni\n- overall - \u00fcr\u00fcn ratingi\n- summary - inceleme \u00f6zeti\n- unixReviewTime - \u0130nceleme zaman\u0131 (Unix time)\n- reviewTime - \u0130nceleme zaman\u0131 (raw)\n- day_diff: yorum sonras\u0131 ne kadar g\u00fcn ge\u00e7mi\u015f\n\n# Ama\u00e7 Nedir?\n# \u00dcr\u00fcn ratinglerini daha do\u011fru hesaplamaya \u00e7al\u0131\u015fmak ve \u00fcr\u00fcn yorumlar\u0131n\u0131 daha do\u011fru s\u0131ralamak.\n\n"}}