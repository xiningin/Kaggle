{"cell_type":{"5a128103":"code","66f8a27e":"code","e3a4fa8d":"code","785881f0":"code","5230d3ee":"code","b9ac6914":"code","9352408f":"code","e1271d4a":"code","81368164":"code","33b29c8e":"code","5c4a44aa":"code","cfa09325":"code","c914b959":"markdown","1bd0a079":"markdown","56ddf25c":"markdown","77843dca":"markdown","e485ae30":"markdown","bd280268":"markdown","bc0b49ff":"markdown","4a2eadf2":"markdown","4c680010":"markdown","74460add":"markdown"},"source":{"5a128103":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n%matplotlib inline","66f8a27e":"df = pd.read_csv(\"..\/input\/automobileEDA.csv\")\ndf.head()","e3a4fa8d":"df.dtypes","785881f0":"df.describe()","5230d3ee":"df.dtypes\nfor x in df:\n    if df[x].dtypes == \"int64\":\n        df[x] = df[x].astype(float)\n        print (df[x].dtypes)\n\n ","b9ac6914":"df = df.select_dtypes(exclude=['object'])\ndf=df.fillna(df.mean())\nX = df.drop('price',axis=1)\ny = df['price']","9352408f":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=0)","e1271d4a":"from sklearn.tree import DecisionTreeRegressor\nregressor = DecisionTreeRegressor()\nregressor.fit(X_train, y_train)","81368164":"y_pred = regressor.predict(X_test)","33b29c8e":"df=pd.DataFrame({'Actual':y_test, 'Predicted':y_pred})\ndf","5c4a44aa":"from sklearn import metrics\nprint('Mean Absolute Error:', metrics.mean_absolute_error(y_test, y_pred))\nprint('Mean Squared Error:', metrics.mean_squared_error(y_test, y_pred))\nprint('Root Mean Squared Error:', np.sqrt(metrics.mean_squared_error(y_test, y_pred)))","cfa09325":"import seaborn as sns\nplt.figure(figsize=(5, 7))\n\n\nax = sns.distplot(y, hist=False, color=\"r\", label=\"Actual Value\")\nsns.distplot(y_pred, hist=False, color=\"b\", label=\"Fitted Values\" , ax=ax)\n\n\nplt.title('Actual vs Fitted Values for Price')\nplt.xlabel('Price (in dollars)')\nplt.ylabel('Proportion of Cars')\n\nplt.show()\nplt.close()","c914b959":"dtypes gives the data type of coloumn","1bd0a079":"In the above dataframe all the coloumns are not numeric. So we will consider only those coloumn whose values are in numeric and will  make all numeric to float.","56ddf25c":"The mean absolute error for our algorithm is 2397.688524590164, which is less than 20 percent of the mean of all the values in the 'Price' column. This means that our algorithm did a  prediction, but it needs lot of improvement.","77843dca":"Preparing the Data\nAs with the classification task, in this section we will divide our data into attributes and labels and consequently into training and test sets. We will create 2 data set,one for price while the other (df-price).\nSince pur dataframe has many data in object format, for this analysis we are removing all the coloumn with object type and for all NaN value we are removig that row","e485ae30":"df.head() will give us the details fo top 5 rows of every cooloumn. We can use df.tail() to get the last 5 rows and similiary df.head(10) to get top 10 rows.\n\nThe data is about cars and we need to predict the price of car using the above data\n\nWe will be using Decision Tree to get the price of the car. ","bd280268":"To train the tree, we will  use the DecisionTreeRegressor class and call the fit method:","bc0b49ff":"Here the X variable contains all the columns from the dataset, except 'Price' column, which is the label. The y variable contains values from the 'Price' column, which means that the X variable contains the attribute set and y variable contains the corresponding labels.","4a2eadf2":"Let's check the difference between Actual and predicted values","4c680010":"Lets predict the price","74460add":"The above is the graph between the actual and predicted values"}}