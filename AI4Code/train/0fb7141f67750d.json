{"cell_type":{"13f4d777":"code","c854d899":"code","e0153581":"code","9e356403":"code","39caddd7":"code","44c879d4":"code","8a73531a":"code","66d139e2":"code","998045c5":"code","39ab61b2":"markdown","7434688f":"markdown"},"source":{"13f4d777":"import pandas as pd\nimport os\nimport numpy as np","c854d899":"train=pd.read_csv(\"..\/input\/global-wheat-detection\/train.csv\")","e0153581":"def convert_to_yolo(bbox, c=1024.0):\n  bbox=np.fromstring(bbox[1:-1],sep=',')\n  x=(bbox[0]+bbox[2]\/2.0)\/c\n  y=(bbox[1]+bbox[3]\/2.0)\/c\n  w= bbox[2]\/c\n  h=bbox[3]\/c\n  yolo_box=[x,y,w,h]\n  return(yolo_box)\n","9e356403":"train['yolo_box'] = train.bbox.apply(convert_to_yolo)","39caddd7":"unique=train.image_id.unique()","44c879d4":"if not os.path.exists(\"..\/yolo\"):\n    os.makedirs(\"..\/yolo\")","8a73531a":"for i in unique:\n  file= \"%s.txt\" %i\n  a='..\/yolo'\n  b=file\n  path=os.path.join(a,b)\n  os.mknod(path)\n  file_data= train.query('image_id == \"%s\"' %i)\n  boxes = file_data.yolo_box.values\n  with open(path, 'a') as file:\n    for j in boxes:\n      s = \"0 %s %s %s %s \\n\"\n      new_line = (s % tuple(j))\n      file.write(new_line)\n","66d139e2":"f=open('..\/yolo\/b53afdf5c.txt')","998045c5":"print(f.read())","39ab61b2":"# This is a simplified version of pablOberhauser's notebook 'Creating Label Files for use in YOLOv4'","7434688f":"Test with a sample .txt file if it is created properly."}}