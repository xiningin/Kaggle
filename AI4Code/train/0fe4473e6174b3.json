{"cell_type":{"8553b13e":"code","cc292a10":"code","20cdb14f":"code","ac6ee39b":"code","931fe3f9":"code","01abfc9f":"code","fc6b53f1":"code","6acc1e99":"code","55e6a874":"code","4085de85":"code","1d2eceee":"code","3f2d8dcd":"code","70f614c7":"code","fc6d0f44":"code","240d1fce":"code","3a82bb39":"code","7e63738c":"code","e3cf5384":"code","993c0ff2":"code","d73f5287":"code","9b48b05a":"code","561e4e65":"code","ed034d03":"code","616e2f18":"code","9768e35f":"code","251259cf":"code","41e17529":"code","cfb5d46a":"code","6055f4a1":"code","129f436f":"code","1330bba1":"code","7d77c130":"markdown","cf4986cf":"markdown","357c37a7":"markdown","4e44d3d7":"markdown"},"source":{"8553b13e":"!pip install imbalanced-learn","cc292a10":"import pandas as pd\ndf = pd.read_csv('..\/input\/creditcardfraud\/creditcard.csv')\ndf.head()","20cdb14f":"df.shape","ac6ee39b":"df.isnull().sum()","931fe3f9":"df['Class'].value_counts()","01abfc9f":"# independent and dependent feature\nX = df.drop(\"Class\", axis=1)\ny = df.Class","fc6b53f1":"# random forest\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.metrics import accuracy_score, confusion_matrix, classification_report\nfrom sklearn.model_selection import KFold\nimport numpy as np\nfrom sklearn.model_selection import GridSearchCV","6acc1e99":"log_class = LogisticRegression()\ngrid = {'C':10.0**np.arange(-2,3),'penalty':['l1','l2']}\ncv = KFold(n_splits=5, shuffle=False, random_state=None)","55e6a874":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X,y,train_size=0.7)","4085de85":"clf = GridSearchCV(log_class, grid, cv=cv, n_jobs=-1, scoring='f1_macro')","1d2eceee":"clf.fit(X_train, y_train)","3f2d8dcd":"y_pred = clf.predict(X_test)\nprint(confusion_matrix(y_test, y_pred))\nprint(accuracy_score(y_test, y_pred))\nprint(classification_report(y_test,y_pred))","70f614c7":"class_weight = dict({0:1,1:100})","fc6d0f44":"from sklearn.ensemble import RandomForestClassifier\nclassifier = RandomForestClassifier()\nclassifier.fit(X_train, y_train)","240d1fce":"y_pred = classifier.predict(X_test)\nprint(confusion_matrix(y_test, y_pred))\nprint(accuracy_score(y_test, y_pred))\nprint(classification_report(y_test,y_pred))","3a82bb39":"from sklearn.ensemble import RandomForestClassifier\nclassifier = RandomForestClassifier(class_weight=class_weight)\nclassifier.fit(X_train, y_train)","7e63738c":"y_pred = classifier.predict(X_test)\nprint(confusion_matrix(y_test, y_pred))\nprint(accuracy_score(y_test, y_pred))\nprint(classification_report(y_test,y_pred))","e3cf5384":"import sklearn\nfrom imblearn.under_sampling import NearMiss\nfrom collections import Counter\nns = NearMiss(0.8)\nX_train_ns, y_train_ns = ns.fit_resample(X_train, y_train)\nprint(\"The number of classes before fit {}\".format(Counter(y_train)))\nprint(\"The number of classes after fit {}\".format(Counter(y_train_ns)))","993c0ff2":"from sklearn.ensemble import RandomForestClassifier\nclassifier = RandomForestClassifier()\nclassifier.fit(X_train_ns, y_train_ns)","d73f5287":"y_pred = classifier.predict(X_test)\nprint(confusion_matrix(y_test, y_pred))\nprint(accuracy_score(y_test, y_pred))\nprint(classification_report(y_test,y_pred))","9b48b05a":"from imblearn.over_sampling import RandomOverSampler","561e4e65":"os = RandomOverSampler(0.75)\nX_train_ns, y_train_ns = os.fit_resample(X_train, y_train)\nprint(\"The number of classes before fit {}\".format(Counter(y_train)))\nprint(\"The number of classes after fit {}\".format(Counter(y_train_ns)))","ed034d03":"from sklearn.ensemble import RandomForestClassifier\nclassifier = RandomForestClassifier()\nclassifier.fit(X_train_ns, y_train_ns)","616e2f18":"y_pred = classifier.predict(X_test)\nprint(confusion_matrix(y_test, y_pred))\nprint(accuracy_score(y_test, y_pred))\nprint(classification_report(y_test,y_pred))","9768e35f":"from imblearn.combine import SMOTETomek","251259cf":"os = SMOTETomek(0.75)\nX_train_ns, y_train_ns = os.fit_resample(X_train, y_train)\nprint(\"The number of classes before fit {}\".format(Counter(y_train)))\nprint(\"The number of classes after fit {}\".format(Counter(y_train_ns)))","41e17529":"from sklearn.ensemble import RandomForestClassifier\nclassifier = RandomForestClassifier()\nclassifier.fit(X_train_ns, y_train_ns)","cfb5d46a":"y_pred = classifier.predict(X_test)\nprint(confusion_matrix(y_test, y_pred))\nprint(accuracy_score(y_test, y_pred))\nprint(classification_report(y_test,y_pred))","6055f4a1":"from imblearn.ensemble import EasyEnsembleClassifier","129f436f":"easy = EasyEnsembleClassifier()\neasy.fit(X_train,y_train)","1330bba1":"y_pred = easy.predict(X_test)\nprint(confusion_matrix(y_test, y_pred))\nprint(accuracy_score(y_test, y_pred))\nprint(classification_report(y_test,y_pred))","7d77c130":"# Over Sampling ","cf4986cf":"# Under Sampling ","357c37a7":"# SMOTETomek ","4e44d3d7":"# Ensemble Technique "}}