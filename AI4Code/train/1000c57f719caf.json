{"cell_type":{"991f5f5a":"code","22f88ac6":"code","f6402bee":"code","019aaeb8":"code","6d132af5":"code","5ad08b97":"code","5ff32bdc":"code","6430f2db":"code","2e45f885":"code","346f7333":"code","3df18a32":"code","7ede2c29":"code","a3e070fe":"code","f1789ce7":"markdown","f4e2e463":"markdown","e8920db9":"markdown","99bf98f6":"markdown","04053c51":"markdown","0007f9de":"markdown","fe65ed75":"markdown","9205e83e":"markdown","1d921a65":"markdown","ab9f8fe0":"markdown","780144dd":"markdown","44278b6b":"markdown","9447e114":"markdown","a71879a0":"markdown"},"source":{"991f5f5a":"import os\n\n\nimport random\nimport seaborn as sns\nimport cv2\n\n# General packages\nimport pandas as pd\nimport numpy as np\nimport matplotlib\nimport matplotlib.pyplot as plt\nimport PIL\nimport IPython.display as ipd\nimport glob\nimport h5py\nimport plotly.graph_objs as go\nimport plotly.express as px\nfrom PIL import Image\nfrom tempfile import mktemp\n\nfrom bokeh.layouts import column, row\nfrom bokeh.models import ColumnDataSource, LinearAxis, Range1d\nfrom bokeh.models.tools import HoverTool\nfrom bokeh.palettes import BuGn4\nfrom bokeh.plotting import figure, output_notebook, show\nfrom bokeh.transform import cumsum\nfrom math import pi\n\noutput_notebook()\n\n\nfrom IPython.display import Image, display\nimport warnings\nwarnings.filterwarnings(\"ignore\")","22f88ac6":"os.listdir('..\/input\/landmark-recognition-2021\/')\n","f6402bee":"BASE_PATH = '..\/input\/landmark-recognition-2021'\n\nTRAIN_DIR = f'{BASE_PATH}\/train'\nTEST_DIR = f'{BASE_PATH}\/test'\n\nprint('Reading data...')\ntrain = pd.read_csv(f'{BASE_PATH}\/train.csv')\nsubmission = pd.read_csv(f'{BASE_PATH}\/sample_submission.csv')\nprint('Reading data completed')","019aaeb8":"display(train.head())\nprint(\"Shape of train_data :\", train.shape)","6d132af5":"display(submission.head())\nprint(\"Shape of submission :\", submission.shape)","5ad08b97":"# displaying only top 30 landmark\nlandmark = train.landmark_id.value_counts()\nlandmark_df = pd.DataFrame({'landmark_id':landmark.index, 'frequency':landmark.values}).head(30)\n\nlandmark_df['landmark_id'] =   landmark_df.landmark_id.apply(lambda x: f'landmark_id_{x}')\n\nfig = px.bar(landmark_df, x=\"frequency\", y=\"landmark_id\",color='landmark_id', orientation='h',\n             hover_data=[\"landmark_id\", \"frequency\"],\n             height=1000,\n             title='Number of images per landmark_id (Top 30 landmark_ids)')\nfig.show()","5ff32bdc":"import PIL\nfrom PIL import Image, ImageDraw\n\n\ndef display_images(images, title=None): \n    f, ax = plt.subplots(5,5, figsize=(18,22))\n    if title:\n        f.suptitle(title, fontsize = 30)\n\n    for i, image_id in enumerate(images):\n        image_path = os.path.join(TRAIN_DIR, f'{image_id[0]}\/{image_id[1]}\/{image_id[2]}\/{image_id}.jpg')\n        image = Image.open(image_path)\n        \n        ax[i\/\/5, i%5].imshow(image) \n        image.close()       \n        ax[i\/\/5, i%5].axis('off')\n\n        landmark_id = train[train.id==image_id.split('.')[0]].landmark_id.values[0]\n        ax[i\/\/5, i%5].set_title(f\"ID: {image_id.split('.')[0]}\\nLandmark_id: {landmark_id}\", fontsize=\"12\")\n\n    plt.show() ","6430f2db":"samples = train.sample(25).id.values\ndisplay_images(samples)","2e45f885":"samples = train[train.landmark_id == 89894].sample(25).id.values\n\ndisplay_images(samples)","346f7333":"samples = train[train.landmark_id == 82267].sample(25).id.values\n\ndisplay_images(samples)","3df18a32":"samples = train[train.landmark_id == 162833].sample(25).id.values\n\ndisplay_images(samples)","7ede2c29":"samples = train[train.landmark_id == 10419].sample(25).id.values\n\ndisplay_images(samples)","a3e070fe":"sample_submission = pd.read_csv('..\/input\/landmark-recognition-2021\/sample_submission.csv')\nsample_submission.to_csv('submission.csv',index=False)","f1789ce7":"## More code is coming Soon. Please upvote if you like the work and you will get notifications with additions. \n\n<center><img src=\"https:\/\/thumbs.gfycat.com\/AshamedWeightyDachshund-max-1mb.gif\"><\/center>","f4e2e463":"### Visualizing landmark with images (landmark_id: 89894)","e8920db9":"<div class=\"alert alert-block alert-danger\">  \n<h2><center><strong>Exploratory data analysis \ud83d\udd0e \ud83d\udcca<\/strong><\/center><\/h2>\n        \n<\/div>\n\n### Target Distribution (Number of images per landmark_id)\n","99bf98f6":"<div class=\"alert alert-block alert-danger\">  \n<h1><center><strong>Data Visualization \ud83d\udcdd<\/strong><\/center><\/h1>\n\n\n   \n        \n<\/div>","04053c51":"**Inference**\n\n* There are 81313 unique landmark_ids\n* There is only one landmark which has more than 2300 images (landmark_id: 138982)\n* Number of images per landmark_id ranges from 2 to 6272.\n* Out of 81313, there are 79298 (97.5%) landmark_ids with less than 100 images.","0007f9de":"### Visualizing landmark with images (landmark_id: 162833)","fe65ed75":"# Visualizing landmark images (landmark_id: 10419)","9205e83e":"<div class=\"alert alert-block alert-danger\">  \n<h2><center><strong>Loading the data \ud83d\udcc1 \ud83d\udcc2<\/strong><\/center><\/h2>\n        \n<\/div>","1d921a65":"### Visualizing landmark with  images (landmark_id: 82267)","ab9f8fe0":"<div class=\"alert alert-block alert-info\">  \n    <center><h3><strong>\ud83d\udc68\u200d\ud83d\udcbb Getting Started with Google Landmark Retrieval 2021<\/strong><\/h3><\/center>\n    <i><\/i>\n<\/div>","780144dd":"### The dataset comprises of following important files:\n\n* **train.csv**: This file contains, ids and targets\n    * `id`: image id\n    * `landmark_id`: target landmark id\n    \n\n* The training set is available in the `train\/` folder, with corresponding landmark labels in `train.csv`. \n* The test set images are listed in the `test\/` folder. Each image has a unique id. \n\n> Note: Since there are a large number of images, each image is placed within three subfolders according to the first three characters of the image id (i.e. image abcdef.jpg is placed in a\/b\/c\/abcdef.jpg).\n","44278b6b":"# <center><img src=\"https:\/\/akm-img-a-in.tosshub.com\/businesstoday\/images\/story\/201712\/data-analytics_660_120717022837.jpg\"><\/center>","9447e114":"### Guideline to submit the results","a71879a0":"<div class=\"alert alert-block alert-danger\">  \n<h2><center><strong>Importing Python Libraries \ud83d\udcd5 \ud83d\udcd7 \ud83d\udcd8 \ud83d\udcd9<\/strong><\/center><\/h2>\n        \n<\/div>"}}