{"cell_type":{"714de414":"code","6a377161":"code","063c661a":"code","d1be11ce":"code","83ae40a7":"code","78d91bcb":"code","6420e9bb":"code","c78f4916":"code","6023859e":"code","b07c8387":"code","1da6a3e8":"code","6cdd2e96":"code","ab1cfa8a":"code","e9babfee":"code","52d05739":"code","96528c95":"code","4210308b":"code","3763643b":"code","68c94f2f":"code","7d5ebd19":"code","e46b211c":"code","9937bd46":"code","05fa9b69":"code","5ebe2711":"code","eb455274":"code","d7c926a4":"code","34695e7b":"code","4e783245":"code","e3f5f77b":"code","710d79a6":"code","2de1200d":"code","2bbcbbd6":"code","bfea556e":"code","36236ab0":"code","4fff4b31":"code","1baeb913":"code","0f199657":"code","c3d25d2d":"code","87278f6f":"code","83a84a54":"code","f374ad7f":"code","2fcb3edb":"code","6cd938e9":"code","2a0fe730":"code","7290ed19":"code","d9016e3d":"code","5f3a6fe7":"code","bca732a2":"code","b035f9d3":"code","a188c64e":"code","822e6a7a":"code","8e8c76c5":"code","8f634c94":"code","0404eaae":"code","ba76ec3b":"code","4bee7309":"code","dbc057fb":"code","2fcb23d5":"code","224caab7":"code","cf314007":"code","aa518fdd":"code","72a78df1":"code","cb547102":"code","6b6364c9":"code","d270a4c1":"code","c7fa7241":"code","724edbe2":"code","c489c855":"code","8cf35d3d":"code","ce44b1da":"code","6c79b612":"code","2ace959b":"code","d9d27ae9":"code","b9f46b04":"code","eef31d32":"code","f7ae52a2":"code","ae47e577":"code","21b87f65":"code","1772bbd2":"code","56bcf22e":"code","87afae9a":"markdown","659e24dc":"markdown","ebc79bb5":"markdown","b47c4cc9":"markdown","568b8389":"markdown","179cd3c8":"markdown","48506128":"markdown","8fc7e1ba":"markdown","a70c1140":"markdown","36a4ffd8":"markdown","99eb99bb":"markdown","06d0c3f7":"markdown","58836819":"markdown","74cfc88d":"markdown","23c640c8":"markdown","f63b1008":"markdown","d67dbc82":"markdown","dd0c44b7":"markdown","5d9a30b3":"markdown","4549ebd8":"markdown","5f995671":"markdown","9a502b74":"markdown","403b441e":"markdown","d9e37bd2":"markdown","04cc49b2":"markdown","c14c366d":"markdown","045dac56":"markdown","328b51ab":"markdown","92f0d5f8":"markdown","3888b51a":"markdown","5d285b24":"markdown","00fa9263":"markdown","02a7f92c":"markdown","c8d1e328":"markdown","62084de4":"markdown","43a6e571":"markdown","b724b3d3":"markdown","cdb0347b":"markdown","fc6e8340":"markdown"},"source":{"714de414":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport warnings\nwarnings.filterwarnings(\"ignore\")","6a377161":"train = pd.read_csv(\"..\/input\/airline-passenger-satisfaction\/train.csv\")\ntest = pd.read_csv(\"..\/input\/airline-passenger-satisfaction\/test.csv\")","063c661a":"train.head()","d1be11ce":"test.head()","83ae40a7":"train.info()","78d91bcb":"test.info()","6420e9bb":"train.drop(['Unnamed: 0', 'id'], axis = 1, inplace = True)\ntest.drop(['Unnamed: 0', 'id'], axis = 1, inplace = True)","c78f4916":"train.info()\nprint(\"********************************************************************************\")\nprint(\"********************************************************************************\")\ntest.info()","6023859e":"train.isnull().sum()","b07c8387":"test.isnull().sum()","1da6a3e8":"train.head()","6cdd2e96":"train2 = train.copy()","ab1cfa8a":"numerical = train.select_dtypes(exclude=['object']).copy()\nnumerical","e9babfee":"categorical = train.select_dtypes(include=['object']).copy()\ncategorical","52d05739":"numerical.describe()","96528c95":"categorical.describe()","4210308b":"# convert numerical data into categorical\ntrain[\"Gender\"] = train[\"Gender\"].map({\"Male\":1,\"Female\":0})\ntest['Gender'] = test[\"Gender\"].map({\"Male\":1, \"Female\":0})\ntrain[\"Customer Type\"] = train[\"Customer Type\"].map({\"Loyal Customer\":1,\"disloyal Customer\":0})\ntest[\"Customer Type\"] = test[\"Customer Type\"].map({\"Loyal Customer\":1,\"disloyal Customer\":0})\ntrain[\"Type of Travel\"] = train[\"Type of Travel\"].map({\"Personal Travel\":1,\"Business travel\":0})\ntest[\"Type of Travel\"] = test[\"Type of Travel\"].map({\"Personal Travel\":1,\"Business travel\":0})\ntrain[\"Class\"] = train[\"Class\"].map({\"Eco Plus\":1,\"Eco\":0,\"Business\":-1})\ntest[\"Class\"] = test[\"Class\"].map({\"Eco Plus\":1,\"Eco\":0,\"Business\":-1})\ntrain[\"satisfaction\"] = train[\"satisfaction\"].map({\"satisfied\":1,\"neutral or dissatisfied\":0,})\ntest[\"satisfaction\"] = test[\"satisfaction\"].map({\"satisfied\":1,\"neutral or dissatisfied\":0,})\n\n","3763643b":"corr=train.corr()","68c94f2f":"# Generate a mask for the upper triangle\nmask = np.triu(np.ones_like(train.corr(), dtype=bool))\n\nf, ax = plt.subplots(figsize=(18,16))\nsns.heatmap(corr, mask=mask, annot=True,cmap= \"vlag\",)","7d5ebd19":"train.drop(['Arrival Delay in Minutes'], axis = 1,inplace=True)\ntest.drop(['Arrival Delay in Minutes'], axis = 1,inplace=True)","e46b211c":"corr[\"satisfaction\"].sort_values(ascending=False)","9937bd46":"sns.displot(data=train, x=\"Age\", kind=\"kde\")","05fa9b69":"sns.histplot(data=train, x= \"Age\")","5ebe2711":" round(train2['satisfaction'].value_counts()\/train.shape[0]*100,2).plot.pie(autopct='%1.1f%%',shadow=True, startangle=180,explode = [0.06, 0])","eb455274":" round(train2['Customer Type'].value_counts()\/train.shape[0]*100,2).plot.pie(autopct='%1.1f%%',shadow=True, startangle=90,explode = [0.2, 0])","d7c926a4":"ax = sns.violinplot(x=\"Online boarding\", y=\"satisfaction\",\n                    data=train2, palette=\"muted\")","34695e7b":"sns.boxplot(x=\"Online boarding\", y=\"Age\" , data=train2)","4e783245":"sns.boxplot(x=\"Ease of Online booking\", y=\"Age\" , data=train2)","e3f5f77b":"fig = plt.figure(figsize=(12,18))\nfor i in range(len(numerical.columns)):\n    fig.add_subplot(9, 4, i+1)\n    sns.scatterplot(numerical.iloc[:, i],train['satisfaction'])\nplt.tight_layout()\nplt.show()","710d79a6":"categorics=['Gender', 'Customer Type','Type of Travel', 'Class','Inflight wifi service',\n       'Departure\/Arrival time convenient', 'Ease of Online booking',\n       'Gate location', 'Food and drink', 'Online boarding', 'Seat comfort',\n       'Inflight entertainment', 'On-board service', 'Leg room service',\n       'Baggage handling', 'Checkin service', 'Inflight service',\n       'Cleanliness']\nfor i in categorics:\n    plt.figure(figsize=(16,6))\n    plt.subplot(1,2,1)\n    ax=sns.countplot(x=train2[i],palette=\"Pastel1\")\n    for p in ax.patches:\n        ax.annotate('{:.1f}'.format(p.get_height()), (p.get_x()+0.3, p.get_height()-5000))\n    plt.subplot(1,2,2)\n    ax=sns.countplot(x=train2[i],hue=train2.satisfaction,palette=[\"#f08080\",\"#87cefa\"]) \n    for p in ax.patches:\n        ax.annotate('{:.1f}'.format(p.get_height()), (p.get_x()+0.15, p.get_height()\/2),rotation=90)\n    plt.show()","2de1200d":"sns.countplot(x=train2[\"Type of Travel\"],hue=train2[\"Class\"],palette=\"Pastel1\") ","2bbcbbd6":"l=[\"Seat comfort\",\"Cleanliness\",\"On-board service\",\"Inflight entertainment\",\"Inflight wifi service\"]\nfor i in l:\n    plt.figure(figsize=(16,6))\n    plt.subplot(1,2,2)\n    sns.countplot(x=train2[i],hue=train2[\"Class\"],palette=\"Pastel1\")\n    plt.show()\n","bfea556e":"sns.histplot(x='Flight Distance',hue=\"satisfaction\",data=train2,element=\"poly\")","36236ab0":"categorics=['Gender', 'Customer Type','Type of Travel', 'Class','Inflight wifi service',\n       'Departure\/Arrival time convenient', 'Ease of Online booking',\n       'Gate location', 'Food and drink', 'Online boarding', 'Seat comfort',\n       'Inflight entertainment', 'On-board service', 'Leg room service',\n       'Baggage handling', 'Checkin service', 'Inflight service',\n       'Cleanliness']\nfor i in ['Gender','Customer Type','Type of Travel','Class']:\n    categorics.remove(i)\ntotal = float(len(train))\nax = train[categorics].mean().sort_values(ascending=False).plot(kind=\"barh\",ylabel=\"Features\",colormap=\"Pastel1\",xticks=[0,0.5,1,1.5,2,2.5,3,3.5,4,4.5,5],figsize=(14,6))\nplt.title('Average satisfaction ratings of services', fontsize=16)\nfor p in ax.patches:\n    count = '{:.1f}'.format(p.get_width())\n    x, y = p.get_x() + p.get_width()+0.15, p.get_y()\n    ax.annotate(count, (x, y), ha='right')","4fff4b31":"train.isnull().sum()","1baeb913":"test.isnull().sum()","0f199657":"plt.figure(figsize=(10,8))\ntrain.boxplot(rot=90)","c3d25d2d":"def find_outliers(x):\n    q1 = np.percentile(x, 25)\n    q3 = np.percentile(x, 75)\n    iqr = q3-q1 \n    floor = q1 - 1.5*iqr\n    ceiling = q3 + 1.5*iqr\n\n    return ceiling,floor","87278f6f":"ul,ll=find_outliers(train[\"Flight Distance\"])\nprint(\"Outliers lower bound= \",ll)\nprint(\"Outliers upper bound= \",ul)\nd=train.shape[0]-train[(train[\"Flight Distance\"]>=ll) & (train[\"Flight Distance\"]<=ul) ].shape[0]\nprint(\"length of outlier data= \",d)","83a84a54":"ul,ll=find_outliers(train[\"Departure Delay in Minutes\"])\nprint(\"Outliers lower bound= \",ll)\nprint(\"Outliers upper bound= \",ul)\nd=train.shape[0]-train[(train[\"Departure Delay in Minutes\"]>=ll) & (train[\"Departure Delay in Minutes\"]<=ul)].shape[0]\nprint(\"length of outlier data= \",d)","f374ad7f":"#median imputation\ndef before_after_median_imputation(x):\n    sns.boxplot(train[x])\n    plt.title(\"Box Plot before median imputation\")\n    plt.show()\n    Upper_tail,Lower_tail = find_outliers(train[x])\n    med = np.median(train[x])\n    for i in train[x]:\n        if i > Upper_tail or i < Lower_tail:\n                train[x] = train[x].replace(i, med)\n    sns.boxplot(train[x])\n    plt.title(\"Box Plot after median imputation\")\n    plt.show()            ","2fcb3edb":"col=[\"Flight Distance\",'Departure Delay in Minutes']\nfor column in col:\n    before_after_median_imputation(column)","6cd938e9":"plt.figure(figsize=(10,8))\ntest.boxplot(rot=90)","2a0fe730":"ul,ll=find_outliers(test[\"Flight Distance\"])\nprint(\"Outliers lower bound= \",ll)\nprint(\"Outliers upper bound= \",ul)\nd=test.shape[0]-test[(test[\"Flight Distance\"]>=ll) & (test[\"Flight Distance\"]<=ul) ].shape[0]\nprint(\"length of outlier data= \",d)","7290ed19":"ul,ll=find_outliers(test[\"Departure Delay in Minutes\"])\nprint(\"Outliers lower bound= \",ll)\nprint(\"Outliers upper bound= \",ul)\nd=test.shape[0]-test[(test[\"Departure Delay in Minutes\"]>=ll) & (test[\"Departure Delay in Minutes\"]<=ul)].shape[0]\nprint(\"length of outlier data= \",d)","d9016e3d":"#median imputation\ndef before_after_median_imputation_test(x):\n    sns.boxplot(test[x])\n    plt.title(\"Box Plot before median imputation\")\n    plt.show()\n    Upper_tail,Lower_tail = find_outliers(test[x])\n    med = np.median(test[x])\n    for i in test[x]:\n        if i > Upper_tail or i < Lower_tail:\n                test[x] = test[x].replace(i, med)\n    sns.boxplot(test[x])\n    plt.title(\"Box Plot after median imputation\")\n    plt.show()","5f3a6fe7":"col=[\"Flight Distance\",'Departure Delay in Minutes']\nfor column in col:\n    before_after_median_imputation_test(column)","bca732a2":"X_train=train.drop(\"satisfaction\" , axis=1)\nY_train=train['satisfaction'].values\nX_test=test.drop(\"satisfaction\" , axis=1)\nY_test =test['satisfaction'].values","b035f9d3":"from sklearn.preprocessing import StandardScaler\nss = StandardScaler()\nX_train = ss.fit_transform(X_train)\nX_test = ss.fit_transform(X_test)","a188c64e":"from sklearn.linear_model import LogisticRegression,SGDClassifier\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.svm import SVC \nfrom sklearn.metrics import accuracy_score,confusion_matrix,classification_report,plot_confusion_matrix,ConfusionMatrixDisplay\nfrom sklearn.decomposition import PCA \nfrom sklearn.neighbors import KNeighborsClassifier","822e6a7a":"lr = LogisticRegression()\n\nlr.fit(X_train,Y_train)\n\ny_pred_lr = lr.predict(X_test)","8e8c76c5":"print('Model accuracy score: {0:0.4f}'. format(accuracy_score(Y_test, y_pred_lr)))","8f634c94":"# Check for overfitting and underfitting\nprint(f\"Training Data Score: {lr.score(X_train, Y_train)}\")\nprint(f\"Testing Data Score: {lr.score(X_test, Y_test)}\")","0404eaae":"print(classification_report(Y_test, y_pred_lr))\n\nplot_confusion_matrix(lr, X_test, Y_test,cmap=plt.cm.Blues, normalize = 'all')","ba76ec3b":"DT = DecisionTreeClassifier( max_depth=13, random_state=42)\n\n# fit the model\nDT.fit(X_train, Y_train)\ny_pred_DT = DT.predict(X_test)","4bee7309":"print('Model accuracy score: {0:0.4f}'. format(accuracy_score(Y_test, y_pred_DT)))","dbc057fb":"# Check for overfitting and underfitting\nprint('Training set score: {:.4f}'.format(DT.score(X_train, Y_train)))\nprint('Test set score: {:.4f}'.format(DT.score(X_test, Y_test)))","2fcb23d5":"print(classification_report(Y_test, y_pred_DT))\nplot_confusion_matrix(DT, X_test, Y_test,cmap=plt.cm.Blues, normalize = 'all')","224caab7":"svc = SVC(random_state=0,C=0.1,kernel='rbf')\nsvc.fit(X_train, Y_train)\ny_pred_svc = svc.predict(X_test)","cf314007":"print('Model accuracy score: {0:0.4f}'. format(accuracy_score(Y_test, y_pred_svc)))","aa518fdd":"# Check for overfitting and underfitting\nprint(f\"Training Data Score: {svc.score(X_train, Y_train)}\")\nprint(f\"Testing Data Score: {svc.score(X_test, Y_test)}\")","72a78df1":"print(classification_report(Y_test, y_pred_svc))\ncm2 = confusion_matrix(Y_test, y_pred_svc,normalize=\"all\")\ndisp = ConfusionMatrixDisplay(cm2).plot(cmap=plt.cm.Blues)","cb547102":"pca = PCA(n_components=15)\npca_train = pca.fit_transform(X_train)\npca_test= pca.transform(X_test)","6b6364c9":"pca_train.size","d270a4c1":"pca_train_df=pd.DataFrame(pca_train)\npca_test_df=pd.DataFrame(pca_test)\n","c7fa7241":"pca_train_df.shape","724edbe2":"pca_test_df.shape","c489c855":"# KNN\nknn = KNeighborsClassifier(n_neighbors=70)\nknn.fit(pca_train_df, Y_train)\ny_pred_knn = knn.predict(pca_test_df)","8cf35d3d":"print('Model accuracy score: {0:0.4f}'. format(accuracy_score(Y_test, y_pred_knn)))","ce44b1da":"# Check for overfitting and underfitting\nprint(f\"Training Data Score: {knn.score(pca_train_df, Y_train)}\")\nprint(f\"Testing Data Score: {knn.score(pca_test_df, Y_test)}\")","6c79b612":"print(classification_report(Y_test, y_pred_lr))\nplot_confusion_matrix(lr, X_test, Y_test,cmap=plt.cm.Blues, normalize = 'all')","2ace959b":"from sklearn.ensemble import RandomForestClassifier","d9d27ae9":"rf = RandomForestClassifier(max_depth=25, random_state=0,n_estimators= 1200)\nrf.fit(X_train, Y_train)\ny_pred_rf = rf.predict(X_test)\nprint('Model accuracy score: {0:0.4f}'. format(accuracy_score(Y_test, y_pred_rf)))\n","b9f46b04":"# Check for overfitting and underfitting\nprint(f\"Training Data Score: {rf.score(X_train, Y_train)}\")\nprint(f\"Testing Data Score: {rf.score(X_test, Y_test)}\")\n","eef31d32":"print(classification_report(Y_test, y_pred_rf))\ncm3 = confusion_matrix(Y_test, y_pred_rf,normalize=\"all\")\ndisp = ConfusionMatrixDisplay(cm2).plot(cmap=plt.cm.Blues)","f7ae52a2":"from xgboost import XGBClassifier","ae47e577":"xgb = XGBClassifier()\nxgb.fit(X_train, Y_train)\n\ny_pred_xgb = xgb.predict(X_test)","21b87f65":"print('Model accuracy score: {0:0.4f}'. format(accuracy_score(Y_test, y_pred_xgb)))","1772bbd2":"# Check for overfitting and underfitting\nprint(f\"Training Data Score: {xgb.score(X_train, Y_train)}\")\nprint(f\"Testing Data Score: {xgb.score(X_test, Y_test)}\")\n","56bcf22e":"print(classification_report(Y_test, y_pred_rf))\ncm3 = confusion_matrix(Y_test, y_pred_xgb,normalize=\"all\")\ndisp = ConfusionMatrixDisplay(cm3).plot(cmap=plt.cm.Blues)","87afae9a":"# __Airline Passenger Satisfaction__","659e24dc":"__Missing value__ : As shown above , Num of Null values are small so we can drop them \n    ","ebc79bb5":"**Train Test Split**","b47c4cc9":"1. train dataset null values:\n    - there are 310 null values in `Arrival Delay in Minutes` columns <BR> <BR>\n\n2. test dataset null values:\n    - there are 83 null values in `Arrival Delay in Minutes` collumns","568b8389":"\n**Decision tree**","179cd3c8":"- relation between online boarding and satisfaction\n( as the online boarding satisfaction increase, the overall satsifaction increases and vice versa)\n- so try to imporve online boarding more.","48506128":"__SVM__","8fc7e1ba":"- Missing values\n- Outliers","a70c1140":"__RandomForest__","36a4ffd8":"- __the most satisfaction correlation is with \"Online boarding\" (0.5)__","99eb99bb":"###### Num of Null values are small so we can drop them","06d0c3f7":"- Data is Balanced\n- ratio between satisfied and dissatisfied people \n( our target to increase the ratio of satisfied people ) ","58836819":"**Scalling**","74cfc88d":"1. make a study why some customers become disloyal (survey or a feedback)\n3. the business travel is more than personal travel( making trips with good offers to increase the personal travel) \n    - most personal travelers travel in eco class which hasn't good service.(shown below)\n4. imporve the service in Eco class and make offers in eco plus .\n5. imporve the wifi service because it affects the overall satisfaction. \n \n7. imporve the online booking as it have an effect on overall satisfaction.\n\n9.  working on the food and drinks quality .\n10. online boarding ( affects the satisfaction very much ).\n12. provide more ways of Inflight entertainment.","23c640c8":"## Modeling","f63b1008":"# PREPROCESSING","d67dbc82":"- ratio between loyal and disloyal customers\n","dd0c44b7":"- we need to work in the features which has less average satisfaction ratings.","5d9a30b3":"For test","4549ebd8":"**LogisticRegression**","5f995671":"# **READING DATA**","9a502b74":"- most of people who are satisfied with different service traveling in Business class","403b441e":"- #### difference between mean and mode indicates outliers But equality in mode and median indicates normal distribution\n\n- ##### mean and mode is almost equal in all the columns except:\n    -  Flight Distance \n    - Departure Delay in Minutes\n    - Arrival Delay in Minutes\n\n**so we can guess ouliers in those columns.**","d9e37bd2":"the disturbtion of people age: \n- the most age range from 25 to 35 and from 40 to 60 \n(this means to focus more on the needs of this age) \n- For children between(1,10) \n- For old pepole older than 65 >> provide helpers for them. ","04cc49b2":"- ##### As we detect above outliers are in :\n    - Flight Distance \n    - Departure Delay in Minutes\n    - Arrival Delay in Minutes(was dropped)\n","c14c366d":"__XGBoost__","045dac56":"__Dealing with Outliers__","328b51ab":"* AS seen , `Unnamed: 0`  column has no meaning so we drop it \n*  also`id` column doesn't affect on target so we drop it also","92f0d5f8":"_______________________________","3888b51a":" as the distance increases, the satisfaction increases!!!","5d285b24":"__For train__","00fa9263":"- __As correlation between Departure Delay in Minutes & Arrival Delay in Minutes is so high then we can drop one of them__","02a7f92c":"- **High correlation between:**\n    - `Departure Delay in Minutes` & `Arrival Delay in Minutes`  >> 0.97\n    - `Ease of Online booking` & `Inflight wifi service`  >> 0.72\n    - `Cleanliness` & `Inflight entertainment`  >> 0.69\n    - `Cleanliness` & `Seat comfort`  >> 0.68\n    - `Cleanliness` & `Food and drink`  >> 0.66\n    - `Inflight service` & `Baggage handling`  >> 0.63","c8d1e328":"-  train dataset has 103904 entries and 25 coloumns\n-  test dataset has 25976 entries and 25 coloumns","62084de4":"### __Models:__\n    - LogisticRegression\n    - Decision tree\n    - SVM\n    - KNN with pca\n    - RandomForest\n    - XGBoost","43a6e571":"- missing values was in Arrival Delay in Minutes column .. and we drop this column .\n- then now, we have no null values","b724b3d3":"__This dataset contains an airline passenger satisfaction survey. the target is to predict passenger satisfaction__","cdb0347b":"# __EDA__","fc6e8340":"__KNN with pca__"}}