{"cell_type":{"59f3e674":"code","dd790f3c":"code","e1e29170":"code","c4da3bc3":"code","9bbb0368":"code","b1e74418":"code","62ec9329":"code","3a6dc2c5":"code","2566be3e":"code","12d039c4":"code","22a2d874":"code","3761bb1b":"code","8aef996b":"markdown","367844c8":"markdown","aa9e70f6":"markdown","eb845a2f":"markdown"},"source":{"59f3e674":"import pandas as pd \nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import mean_absolute_error\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt","dd790f3c":"sales_data = pd.read_csv('..\/input\/supermarket-sales\/supermarket_sales - Sheet1.csv')\nplt.figure(figsize = (15,6))\nsales_data = sales_data.drop(['Invoice ID'], axis = 1)\nsales_data.head()","e1e29170":"sales_product = pd.get_dummies(sales_data['Product line']) \nplt.figure(figsize = (50,10))\nsns.jointplot(x = sales_data['Unit price'] , y = sales_data['Rating'] , kind = 'kde') ","c4da3bc3":"sns.swarmplot(x = sales_data['Branch'], y = sales_data['Rating']).set_title('Branch wise Ratings')","9bbb0368":"sns.set(style='ticks')\nplt.figure(figsize = (15,6))\nTotal_males_females = sns.relplot(x = 'Unit price', y='Quantity' ,kind = 'line', hue = 'Gender' , style = 'Gender',col = 'Product line', row = 'Branch' , sizes = (20,100), data = sales_data )","b1e74418":"pd.DataFrame(sales_data.Payment.value_counts())","62ec9329":"sales_data.rename(columns={'Product line':'Product_line'} , inplace=True)","3a6dc2c5":"plt.figure(figsize = (10,7));sales_data.Payment.value_counts().plot(kind = \"pie\" );plt.title(\"Payment Method\")\nplt.figure(figsize = (10,7));sales_data.Product_line.value_counts().plot(kind = \"bar\" );plt.title(\"Product line\")","2566be3e":"sns.lmplot(x = 'Rating' , y = 'Total' , data = sales_data , hue = 'Gender' , height = 7 , aspect = 1.5)","12d039c4":"x = list(sales_data.columns)\nx","22a2d874":"y = sales_data['Rating']\nfeatures = ['Product_line', 'Unit price','Quantity','Tax 5%','Customer type','City']\nX = sales_data[features]\ntrain_X,val_X,train_y,val_y = train_test_split(X,y,random_state = 1)\ntrain_X= pd.get_dummies(train_X)\ntrain_y= pd.get_dummies(train_y)\nval_X= pd.get_dummies(val_X)\nval_y= pd.get_dummies(val_y)\ntrain_X.head()","3761bb1b":"leaf_model = RandomForestRegressor(random_state = 1)\nleaf_model.fit(train_X,train_y)\npredict_value = leaf_model.predict(val_X)\npredict_value\nmean_error = mean_absolute_error(val_y,predict_value)\nprint('The Mean Absolute Error is : {}'.format(mean_error))","8aef996b":"Hence the most sold goods are Fashon Accessories.","367844c8":"# Training and testing the data set using RandomForestRegressor Model\u00b6","aa9e70f6":"A randomforest model is created and then the training data is fit to that model. Later the trained model is used to predict in order to validate the model. The mean absolute error is calculated to estimate the error difference between the predicted values and the actual values.","eb845a2f":"# Payment method opted with respect to the product category"}}