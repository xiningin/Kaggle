{"cell_type":{"f03caf2b":"code","d88b28d4":"code","3a25100e":"code","3d54af99":"code","6dfc4087":"code","ea7b5db9":"code","5acf76fb":"code","3d3fc829":"code","49cf1a30":"code","b8f5ae6c":"code","234437bb":"code","aceb7e54":"code","f86469bc":"code","13adac49":"markdown","c80e47d6":"markdown","92aef0fe":"markdown","6e776fb7":"markdown","f00d08e8":"markdown"},"source":{"f03caf2b":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        # print(os.path.join(dirname, filename))\n        pass\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","d88b28d4":"import warnings\nimport numpy as np \nimport random\nimport pandas as pd \nimport missingno as msno\nfrom collections import Counter\nimport glob\nfrom tqdm.notebook import tqdm\nfrom pathlib import Path\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline\n\nfrom plotly import graph_objs as go\nimport plotly.express as px\nimport plotly.figure_factory as ff\nfrom plotly.subplots import make_subplots\n\nimport os\nimport pydicom\nfrom pydicom.pixel_data_handlers.util import apply_voi_lut\nimport cv2\n\n# from skimage import exposure","3a25100e":"def seed_everything(seed=0):\n    random.seed(seed)\n    np.random.seed(seed)\n    os.environ['PYTHONHASHSEED'] = str(seed)\n    os.environ['TF_DETERMINISTIC_OPS'] = '1'\n\nseed = 2021\nseed_everything(seed)\n\nwarnings.filterwarnings('ignore')\npd.set_option('display.max_colwidth', 150)","3d54af99":"# Defining all our palette colours.\nprimary_blue = \"#496595\"\nprimary_blue2 = \"#85a1c1\"\nprimary_blue3 = \"#3f4d63\"\nprimary_grey = \"#c6ccd8\"\nprimary_black = \"#202022\"\nprimary_bgcolor = \"#f4f0ea\"\n\nprimary_green = px.colors.qualitative.Plotly[2]\n\nplotly_discrete_sequence = px.colors.qualitative.G10\n\nplt.rcParams['figure.dpi'] = 120\nplt.rcParams['axes.spines.top'] = False\nplt.rcParams['axes.spines.right'] = False\nplt.rcParams['font.family'] = 'serif'\nplt.rcParams['axes.facecolor'] = primary_bgcolor\n\ncolors = [primary_blue, primary_blue2, primary_blue3, primary_grey, primary_black, primary_bgcolor, primary_green]\nsns.palplot(sns.color_palette(colors))","6dfc4087":"sns.palplot(sns.color_palette(plotly_discrete_sequence))","ea7b5db9":"virus_url = 'https:\/\/upload.wikimedia.org\/wikipedia\/commons\/2\/21\/Virus_gray_black.svg'","5acf76fb":"# Read in metadata\ntrain_study_df = pd.read_csv(\"..\/input\/siim-covid19-detection\/train_study_level.csv\")\ntrain_image_df = pd.read_csv(\"..\/input\/siim-covid19-detection\/train_image_level.csv\")\n\nprint(f\"Train Study Shape: {train_study_df.shape} \\n\" +\n      f\"Train Image Shape: {train_image_df.shape} \\n\" + \"\\n\" +\n      f\"Note: There are {train_image_df['boxes'].isna().sum()} missing values in train_image.\")","3d3fc829":"train_study_df.head()","49cf1a30":"train_image_df.head()","b8f5ae6c":"train_image_df['class'] = train_image_df['label'].apply(lambda x: x.split(' ')[0])","234437bb":"plot_df = train_image_df['class'].value_counts().reset_index()\n\nfig = go.Figure(go.Bar(\n    x = plot_df['class'],\n    y = plot_df['index'],\n    orientation='h',\n    marker_color=[primary_blue, primary_grey],\n    marker_line_color=primary_black,\n    marker_line_width=1.5, \n    opacity=0.8,\n))\n# Change the bar mode\nfig.update_layout(\n    title='<span style=\"font-size:32px; font-family:Serif\"><b>Class sidtribution<\/b><\/span>',\n    yaxis_title=f'<b>Class<\/b>',\n    xaxis_title=f'<b>Count<\/b>',\n    legend_title=\"Group\",\n    font=dict(\n        family=\"Times New Roman\",\n        size=14,\n    )\n)\nfig.add_layout_image(\n    dict(\n        source=virus_url,\n        xref=\"x\", yref=\"paper\",\n        x=4000, y=0.1,\n        sizex=400, sizey=0.25, \n        xanchor=\"center\", yanchor=\"bottom\",\n        sizing='stretch',\n    ),\n)\nfig.show()","aceb7e54":"labels = train_study_df.drop(columns='id').columns\n\nfig = make_subplots(\n    rows=2, cols=2,\n    subplot_titles=labels\n)\n\nfor i, label in enumerate(labels):\n    plot_df = train_study_df[label].value_counts().reset_index()\n    \n    fig.add_trace(go.Bar(\n        x = plot_df[label],\n        y = plot_df['index'],\n        orientation='h',\n        marker_color=[primary_grey, primary_blue],\n        marker_line_color=primary_black,\n        marker_line_width=1.5, \n        opacity=0.8,\n        name=label\n    ), row=i\/\/2 + 1, col=i%2 + 1,)\n    \n    fig.add_layout_image(\n        dict(\n            source=virus_url,\n            xref=\"x\", yref=\"y domain\",\n            x=plot_df[plot_df['index'] == 1][label].values[0] * 0.7, y=0.6,\n            sizex=320, sizey=0.24, \n            xanchor=\"center\", yanchor=\"bottom\",\n            sizing='stretch',\n        ), row=i\/\/2 + 1, col=i%2 + 1,\n    )\n    \n# Change the bar mode\nfig.update_layout(\n    title='<span style=\"font-size:32px; font-family:Serif\"><b>Label sidtribution<\/b> in study data<\/span>',\n    showlegend=False,\n)\nfig.show()","f86469bc":"dataset_path = Path('..\/input\/siim-covid19-detection')\nlist(dataset_path.iterdir())","13adac49":"# <p style=\"background-color:skyblue; font-family:newtimeroman; font-size:250%; text-align:center; border-radius: 15px 50px;\">\ud83e\udda0SIIM Covid-19\ud83e\udd9f EDA and Visualization \ud83d\udcca<\/p>\n\nThis is an **object detection** and **classification problem**, meaning that for each instance we'll have to predict a bounding box and a class. It seems to be a multi-label problem cuz there are 4 columns per image, but as they are auto-axclusive, the challenge is a multi-class problem.\n\n <div class=\"alert alert-success\" role=\"alert\">\n    <p>\ud83d\udca1 <b>Competition Goal<\/b>: Categorize chest radiographs as negative for pneumonia, typical, indeterminate, or atypical for COVID-19. If some abnormalities are found, provide the bounding boxes. <\/p>\n<\/div>\n\nWe can see that we have:\n* `train_study_level.csv` - the train study-level metadata, with one row for each study, including correct labels.\n* `train_image_level.csv` - the train image-level metadata, with one row for each image, including both correct labels and any bounding boxes in a dictionary format. Some images in both test and train have multiple bounding boxes.\n* `sample_submission.csv` - a sample submission file containing all image- and study-level IDs.\n* train folder - comprises chest scans in DICOM format, stored in paths following the schema: `study\/series\/image`\n* test folder - The hidden test dataset is of roughly the same scale as the training dataset.","c80e47d6":"<a id='2'><\/a>\n# <p style=\"background-color:skyblue; font-family:newtimeroman; font-size:150%; text-align:center; border-radius: 15px 50px;\">2. Lets visaulize the images<\/p>","92aef0fe":"To be continue...","6e776fb7":"<a id='1'><\/a>\n# <p style=\"background-color:skyblue; font-family:newtimeroman; font-size:150%; text-align:center; border-radius: 15px 50px;\">1. First overview and EDA \ud83d\udcca<\/p>\n\nThe bounding box labels are provided in the `label` column. The format is as follows:\n\n`[class ID] [confidence score] [bounding box]`\n\n`class ID` - either opacity or none\n`confidence score` - confidence from your neural network model. If none, the confidence is 1.\n`bounding box` - typical x0 y0 x1 y1 format. If class ID is none, the bounding box is 1 0 0 1 1.\nThe bounding boxes are also provided in easily readable dictionary format in column boxes, and the study that each image is a part of is provided `inStudyInstanceUID`.\n\nLets take a look about class distribution.","f00d08e8":"Let's now analyze the `train_study_df` labels."}}