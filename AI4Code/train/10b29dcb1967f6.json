{"cell_type":{"3fa71198":"code","8e007683":"code","b730ba42":"code","80523e22":"code","71eec912":"code","e2f8ddd3":"code","e353dad2":"code","d69ff315":"code","4e88cb17":"code","bc91718a":"code","ffd299e6":"code","dc47e540":"code","049583f8":"code","19a6e8bf":"code","dd21ca42":"code","9fad0730":"code","38053228":"code","928a3b70":"code","da7c2cb4":"code","ca55d81d":"code","37223078":"markdown","df09c570":"markdown","b34f6c6c":"markdown","73bfad82":"markdown","853ece0f":"markdown","d9fe5fb2":"markdown","d32108b1":"markdown","c3f48a8a":"markdown","f8772be9":"markdown","741932d0":"markdown","d8437c95":"markdown","3d9b4502":"markdown"},"source":{"3fa71198":"import numpy as np\nimport pandas as pd \nimport matplotlib.pyplot as plt\nimport os \nimport seaborn as sns\nimport geopandas as gpd\nimport folium\nfrom folium import plugins\nimport datetime\nimport math","8e007683":"os.listdir(\"..\/input\/chicago-food-inspections\")","b730ba42":"data=pd.read_csv(\"..\/input\/chicago-food-inspections\/food-inspections.csv\")\ndata.head()","80523e22":"len(data)","71eec912":"plt.figure(figsize=(10,10))\nsns.barplot(x=data.isnull().sum().sort_values(ascending=False),y=data.isnull().sum().sort_values(ascending=False).index)\nplt.title(\"counts of missing value\",size=20)\n","e2f8ddd3":"data=data.dropna(subset=['Violations','Facility Type','Latitude','Longitude','AKA Name'])\ndata.isnull().sum()","e353dad2":"data['year']=data['Inspection Date'].apply(lambda x:x.split('-')[0])\ndata['month']=data['Inspection Date'].apply(lambda x:x.split('-')[1])\ndata['day']=data['Inspection Date'].apply(lambda x:x.split('-')[2].split('T')[0])\ndata.head()","d69ff315":"fig,ax=plt.subplots(2,2,figsize=(20,20))\nx=data.year.value_counts().index\ny=data.year.value_counts()\nsns.barplot(x=x,y=y,ax=ax[0,0])\nax[0,0].set_title(\"The counts of inspection by year\",size=20)\nax[0,0].set_ylabel('counts',size=18)\nax[0,0].set_xlabel('')\n\nx=data.month.value_counts().index\ny=data.month.value_counts()\nsns.barplot(x=x,y=y,ax=ax[0,1])\nax[0,1].set_title(\"The counts of inspection by month\",size=20)\nax[0,1].set_ylabel('counts',size=18)\nax[0,1].set_xlabel('')\n\nx=data.day.value_counts().index\ny=data.day.value_counts()\nsns.barplot(x=x,y=y,ax=ax[1,0])\nax[1,0].set_title(\"The counts of inspection by day\",size=20)\nax[1,0].set_ylabel('counts',size=18)\nax[1,0].set_xlabel('')\n\ndata.groupby(['year','month'])['Inspection ID'].agg('count').unstack('year').plot(ax=ax[1,1])\nax[1,1].set_title(\"The counts of inspection for every month by year\",size=20)\nax[1,1].set_ylabel('counts',size=18)\nax[1,1].set_xlabel('month')","4e88cb17":"fig,ax=plt.subplots(2,2,figsize=(15,16))\ndata.Risk.value_counts().plot(kind='bar',color=['red','yellow','green'],ax=ax[0,0])\nax[0,0].tick_params(axis='x',labelrotation=360)\nax[0,0].set_title(\"The counts of Risk\",size=20)\nax[0,0].set_ylabel('counts',size=18)\n\n\ndata.groupby(['year','Risk'])['Inspection ID'].agg('count').unstack('Risk').plot(ax=ax[0,1],color=['red','yellow','green'])\nax[0,1].legend(loc=0, ncol=1, fontsize=14,bbox_to_anchor=(1.15,0.75))\nax[0,1].set_title(\"The counts of Risk by year\",size=20)\nax[0,1].set_ylabel('counts',size=18)\n\ndata.groupby(['month','Risk'])['Inspection ID'].agg('count').unstack('Risk').plot(ax=ax[1,0],color=['red','yellow','green'])\nax[1,0].legend(loc=0, ncol=1, fontsize=14,bbox_to_anchor=(-0.25,0.75))\nax[1,0].set_title(\"The counts of Risk by month\",size=20)\nax[1,0].set_ylabel('counts',size=18)\n\nsns.scatterplot(x='Longitude',y='Latitude',hue='Risk' ,data=data, ax=ax[1,1])\nax[1,1].set_title(\"The distribution of inspections by risk\",size=20)\nax[1,1].set_xlabel('Longitude')\nax[1,1].set_ylabel('LATITUDE')\n","bc91718a":"data_risk1=data[data.Risk=='Risk 1 (High)']\ndata_risk1.head()","ffd299e6":"fig,ax=plt.subplots(1,2,figsize=(15,8))\nsns.barplot(x=data_risk1['Facility Type'].value_counts()[:10],y=data_risk1['Facility Type'].value_counts()[:10].index,ax=ax[0])\nax[0].set_title(\"Top 10 Facility Type by the counts of risk 1 \",size=20)\nax[0].set_xlabel('counts',size=18)\n\n\ncount=data_risk1.groupby(['Facility Type'])['Inspection ID'].agg('count').sort_values(ascending=False)\ngroups=list(data_risk1.groupby(['Facility Type'])['Inspection ID'].agg('count').sort_values(ascending=False).index[:10])\ncounts=list(count[:10])\ncounts.append(count.agg(sum)-count[:10].agg('sum'))\ngroups.append('Other')\ntype_dict=pd.DataFrame({\"group\":groups,\"counts\":counts})\nclr1=('brown','darksalmon','orange','hotpink','cadetblue','purple','red','gold','forestgreen','blue','plum')\ntype_dict.plot(kind='pie', y='counts', labels=groups,colors=clr1,autopct='%1.1f%%', pctdistance=0.9, radius=1.2,ax=ax[1])\nax[1].set_ylabel('')\nax[1].legend(loc=0, ncol=1, fontsize=14,bbox_to_anchor=(1.15,1.2))","dc47e540":"data_risk1_2000=data_risk1[:2000]\nLong=data_risk1_2000.Longitude.mean()\nLat=data_risk1_2000.Latitude.mean()\nrisk1_map=folium.Map([Lat,Long],zoom_start=12)\n\nrisk1_distribution_map=plugins.MarkerCluster().add_to(risk1_map)\nfor lat,lon,label in zip(data_risk1_2000.Latitude,data_risk1_2000.Longitude,data_risk1_2000['AKA Name']):\n    folium.Marker(location=[lat,lon],icon=None,popup=label).add_to(risk1_distribution_map)\nrisk1_map.add_child(risk1_distribution_map)\n\nrisk1_map","049583f8":"data_risk2=data[data.Risk=='Risk 2 (Medium)']\ndata_risk2.head()","19a6e8bf":"fig,ax=plt.subplots(1,2,figsize=(15,8))\nsns.barplot(x=data_risk2['Facility Type'].value_counts()[:10],y=data_risk2['Facility Type'].value_counts()[:10].index,ax=ax[0])\nax[0].set_title(\"Top 10 Facility Type by the counts of risk 2 \",size=20)\nax[0].set_xlabel('counts',size=18)\n\n\ncount=data_risk2.groupby(['Facility Type'])['Inspection ID'].agg('count').sort_values(ascending=False)\ngroups=list(data_risk2.groupby(['Facility Type'])['Inspection ID'].agg('count').sort_values(ascending=False).index[:10])\ncounts=list(count[:10])\ncounts.append(count.agg(sum)-count[:10].agg('sum'))\ngroups.append('Other')\ntype_dict=pd.DataFrame({\"group\":groups,\"counts\":counts})\nclr1=('brown','darksalmon','orange','hotpink','cadetblue','purple','red','gold','forestgreen','blue','plum')\ntype_dict.plot(kind='pie', y='counts', labels=groups,colors=clr1,autopct='%1.1f%%', pctdistance=0.9, radius=1.2,ax=ax[1])\nax[1].set_ylabel('')\nax[1].legend(loc=0, ncol=1, fontsize=14,bbox_to_anchor=(1.15,1.2))","dd21ca42":"data_risk2_2000=data_risk2[:2000]\nLong=data_risk2_2000.Longitude.mean()\nLat=data_risk2_2000.Latitude.mean()\nrisk2_map=folium.Map([Lat,Long],zoom_start=12)\n\nrisk2_distribution_map=plugins.MarkerCluster().add_to(risk2_map)\nfor lat,lon,label in zip(data_risk2_2000.Latitude,data_risk2_2000.Longitude,data_risk2_2000['AKA Name']):\n    folium.Marker(location=[lat,lon],icon=None,popup=label).add_to(risk2_distribution_map)\nrisk2_map.add_child(risk2_distribution_map)\n\nrisk2_map","9fad0730":"data_risk3=data[data.Risk=='Risk 3 (Low)']\ndata_risk3.head()","38053228":"fig,ax=plt.subplots(1,2,figsize=(15,8))\nsns.barplot(x=data_risk3['Facility Type'].value_counts()[:10],y=data_risk3['Facility Type'].value_counts()[:10].index,ax=ax[0])\nax[0].set_title(\"Top 10 Facility Type by the counts of risk 3 \",size=20)\nax[0].set_xlabel('counts',size=18)\n\n\ncount=data_risk3.groupby(['Facility Type'])['Inspection ID'].agg('count').sort_values(ascending=False)\ngroups=list(data_risk3.groupby(['Facility Type'])['Inspection ID'].agg('count').sort_values(ascending=False).index[:10])\ncounts=list(count[:10])\ncounts.append(count.agg(sum)-count[:10].agg('sum'))\ngroups.append('Other')\ntype_dict=pd.DataFrame({\"group\":groups,\"counts\":counts})\nclr1=('brown','darksalmon','orange','hotpink','cadetblue','purple','red','gold','forestgreen','blue','plum')\ntype_dict.plot(kind='pie', y='counts', labels=groups,colors=clr1,autopct='%1.1f%%', pctdistance=0.9, radius=1.2,ax=ax[1])\nax[1].set_ylabel('')\nax[1].legend(loc=0, ncol=1, fontsize=14,bbox_to_anchor=(1.15,1.2))","928a3b70":"data_risk3_2000=data_risk3[:2000]\ndata_risk3_2000['AKA Name']=data_risk3_2000['AKA Name'].apply(lambda x:x.strip('`').strip())\nLong=data_risk3_2000.Longitude.mean()\nLat=data_risk3_2000.Latitude.mean()\nrisk3_map=folium.Map([Lat,Long],zoom_start=12)\n\nrisk3_distribution_map=plugins.MarkerCluster().add_to(risk3_map)\nfor lat,lon,label in zip(data_risk3_2000.Latitude,data_risk3_2000.Longitude,data_risk3_2000['AKA Name']):\n    folium.Marker(location=[lat,lon],icon=None,popup=label).add_to(risk3_distribution_map)\nrisk3_map.add_child(risk3_distribution_map)\n\nrisk3_map","da7c2cb4":"fig,ax=plt.subplots(2,2,figsize=(20,16))\ny=data['Facility Type'].value_counts()[:10].index\nx=data['Facility Type'].value_counts()[:10]\nsns.barplot(x=x,y=y,ax=ax[0,0])\nax[0,0].set_title(\"Top 10 Facility Type by the counts of inspection \",size=20)\nax[0,0].set_xlabel('counts',size=18)\nax[0,0].set_ylabel('')\n\nsns.scatterplot(x='Longitude',y='Latitude',hue='Risk',hue_order=['Risk 1 (High)','Risk 2 (Medium)','Risk 3 (Low)'] ,data=data[data['Facility Type']=='Restaurant'], ax=ax[0,1])\nax[0,1].set_title(\"The distribution of inspections for restaurant\",size=20)\nax[0,1].set_xlabel('Longitude')\nax[0,1].set_ylabel('LATITUDE')\n\nsns.scatterplot(x='Longitude',y='Latitude',hue='Risk' ,hue_order=['Risk 1 (High)','Risk 2 (Medium)','Risk 3 (Low)'],data=data[data['Facility Type']=='Grocery Store'], ax=ax[1,0])\nax[1,0].set_title(\"The distribution of inspections for Grocery Store\",size=20)\nax[1,0].set_xlabel('Longitude')\nax[1,0].set_ylabel('LATITUDE')\n\nsns.scatterplot(x='Longitude',y='Latitude',hue='Risk',hue_order=['Risk 1 (High)','Risk 2 (Medium)','Risk 3 (Low)'] ,data=data[data['Facility Type']=='School'], ax=ax[1,1])\nax[1,1].set_title(\"The distribution of inspections for School\",size=20)\nax[1,1].set_xlabel('Longitude')\nax[1,1].set_ylabel('LATITUDE')","ca55d81d":"fig,ax=plt.subplots(2,2,figsize=(20,16))\nx=data.Results.value_counts().index\ny=data.Results.value_counts()\nsns.barplot(x=x,y=y,ax=ax[0,0])\nax[0,0].set_title(\"The counts of Results of inspection \",size=20)\nax[0,0].set_ylabel('counts',size=18)\nax[0,0].set_xlabel('')\n\ndata.groupby(['Results','year'])['Inspection ID'].agg('count').unstack('Results').plot(kind='bar',ax=ax[0,1])\nax[0,1].tick_params(axis='x',labelrotation=360)\nax[0,1].legend(loc=0, ncol=1, fontsize=14,bbox_to_anchor=(1.15,0.75))\nax[0,1].set_title(\"The counts of results of inspection by year \",size=20)\nax[0,1].set_ylabel('counts',size=18)\n\nsns.scatterplot(x='Longitude',y='Latitude',hue='Risk' ,hue_order=['Risk 1 (High)','Risk 2 (Medium)','Risk 3 (Low)'],data=data[data.Results=='Pass'], ax=ax[1,0])\nax[1,0].set_title(\"The distribution of result is pass\",size=20)\nax[1,0].set_xlabel('Longitude')\nax[1,0].set_ylabel('LATITUDE')\n\nsns.scatterplot(x='Longitude',y='Latitude',hue='Risk',hue_order=['Risk 1 (High)','Risk 2 (Medium)','Risk 3 (Low)'] ,data=data[data.Results=='Fail'], ax=ax[1,1])\nax[1,1].set_title(\"The distribution of result is fail\",size=20)\nax[1,1].set_xlabel('Longitude')\nax[1,1].set_ylabel('LATITUDE')","37223078":"![image.png](attachment:image.png)","df09c570":"<h3 id=\"223\">2.2.3 Visualization for Risk 3(Low)","b34f6c6c":"# 2.Visualization","73bfad82":"<h3 id=\"24\">2.4 Visualization for Results of inspection","853ece0f":"# 1.DataOverview","d9fe5fb2":"<h3 id=\"22\">2.2 Visualization for Risk","d32108b1":"<h3 id=\"21\">2.1 Visualization for Date","c3f48a8a":"<h3 id=\"23\">2.3 Visualization for Facility Type\t","f8772be9":"<h3 id=\"221\">2.2.1 Visualization for Risk 1(High)","741932d0":"This data size is 192,392,and the variables include 'Inspection ID','DBA Name','AKA Name',and so on.\n\nI drop out the missing value from 'Violations','Facility Type','Latitude',and 'Longitude'.\n\nBecause I will use these variables to make some visualiztion.\n\n# Please upvote it if you like this kernel.\n# Thank you\n\nThe photo is from:https:\/\/ac-illust.com\/tw\/clip-art\/626399\/%E4%B8%80%E9%9A%BB%E9%9E%A0%E8%BA%AC%E7%9A%84%E5%85%94%E5%AD%90","d8437c95":"* [1.DataOverview](#1.DataOverview)\n* [2.Visualization](#2.Visualization)\n    * [2.1 Visualization for Date](#21)\n    * [2.2 Visualization for Risk](#22)\n        * [2.2.1 Visualization for Risk 1(High)](#221)\n        * [2.2.2 Visualization for Risk 2(Medium)](#222)\n        * [2.2.3 Visualization for Risk 3(Low)](#223)\n    * [2.3 Visualization for Facility Type](#23)\n    * [2.4 Visualization for Results of inspection](#24)\n","3d9b4502":"<h3 id=\"222\">2.2.2 Visualization for Risk 2(Medium)"}}