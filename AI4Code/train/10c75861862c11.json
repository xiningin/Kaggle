{"cell_type":{"a0c9f684":"code","04275833":"code","d5b781b0":"code","27e0d4cb":"code","f0548eed":"code","d0c821b5":"code","635d5564":"code","dc18ea5e":"code","4faa697f":"code","98f4e515":"code","a4c46df7":"code","39831fff":"code","df7e936d":"code","c4f5c10a":"code","315cc5e1":"code","5eaa75be":"code","43e0b6f2":"code","81de4361":"code","20d380cb":"markdown","9ac30977":"markdown","246fce11":"markdown","caaf861a":"markdown","90ffa8a1":"markdown","1b42240d":"markdown","18fa30d9":"markdown","4e4f5460":"markdown","bb9d87d2":"markdown","f013139a":"markdown","251d12cb":"markdown","a8bc9b2d":"markdown","59d0b78a":"markdown","c824e9ad":"markdown","e385a777":"markdown"},"source":{"a0c9f684":"import numpy as np\nimport pandas as pd\nfrom matplotlib import pyplot as plt\nimport seaborn as sns\n\nfrom sklearn.preprocessing import LabelEncoder, MinMaxScaler\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import classification_report, confusion_matrix, accuracy_score\n\nfrom sklearn.svm import SVC","04275833":"raw_data = pd.read_csv('..\/input\/indian-liver-patient-records\/indian_liver_patient.csv')\nraw_data.head()","d5b781b0":"raw_data.isnull().sum()","27e0d4cb":"raw_data['Dataset'].value_counts()","f0548eed":"sns.lmplot(data=raw_data, x='Age', y='Albumin');\nsns.lmplot(data=raw_data, x='Age', y='Total_Protiens');\nsns.lmplot(data=raw_data, x='Age', y='Albumin_and_Globulin_Ratio');","d0c821b5":"sns.countplot(data=raw_data, x='Gender');","635d5564":"g = sns.FacetGrid(raw_data, col=\"Dataset\", row=\"Gender\", margin_titles=True)\ng.map(plt.hist, \"Age\")\nplt.subplots_adjust(top=0.9)\ng.fig.suptitle('Disease by Gender and Age');","dc18ea5e":"corr = raw_data.drop('Dataset',axis=1).corr()\nplt.figure(figsize=(30, 30))\nsns.heatmap(corr, cbar = True,  square = True, annot=True, fmt= '.2f',annot_kws={'size': 15},\n           cmap= 'coolwarm');","4faa697f":"total_direct_bil = raw_data[[\"Total_Bilirubin\", \"Direct_Bilirubin\"]]\nsns.violinplot(data=total_direct_bil);","98f4e515":"aspartate_alamine = raw_data[[\"Aspartate_Aminotransferase\", \"Alamine_Aminotransferase\"]]\nsns.violinplot(data=aspartate_alamine);","a4c46df7":"Total_Protiens_alb = raw_data[[\"Albumin\", \"Total_Protiens\"]]\nsns.violinplot(data=Total_Protiens_alb);","39831fff":"reduced_data = raw_data[[\"Age\",\"Gender\",\"Total_Bilirubin\",\"Aspartate_Aminotransferase\",\"Albumin\", \"Total_Protiens\", \"Albumin_and_Globulin_Ratio\",\"Dataset\"]]\nreduced_data.head()","df7e936d":"reduced_data[reduced_data['Albumin_and_Globulin_Ratio'].isnull()]","c4f5c10a":"grouped = reduced_data.groupby([\"Gender\",\"Dataset\"])\nreduced_data['Albumin_and_Globulin_Ratio'] = grouped['Albumin_and_Globulin_Ratio'].transform(lambda x: x.fillna(x.mean()))","315cc5e1":"le = LabelEncoder()\nreduced_data.Gender = le.fit_transform(reduced_data.Gender)\nreduced_data.head()","5eaa75be":"x_train, x_test, y_train, y_test = train_test_split(reduced_data, reduced_data.Dataset, test_size=0.2)","43e0b6f2":"scaler = MinMaxScaler()\nscaler.fit(x_train)\nx_train = scaler.transform(x_train)\nx_test = scaler.transform(x_test)","81de4361":"clf = SVC(gamma='auto')\nclf.fit(x_train, y_train)\ny_pred = clf.predict(x_test)\n\nprint(classification_report(y_test, y_pred))\nprint(\"Accuracy:\", accuracy_score(y_test, y_pred))\nprint(confusion_matrix(y_test, y_pred))","20d380cb":"We see that Albumin, Total_Protiens and Albumin_and_Globulin_Ratio are linearly dependent on Age.","9ac30977":"There are 416 liver patients and 167 non-liver patients. Since it is more important for us to identify the liver patients, we need an algorithm with a high recall score.","246fce11":"Both have a substantially high variation.  \n  \nThe features I will keep in the dataset are:  \nAge, Gender, Total_Bilirubin, Aspartate_Aminotransferase, Albumin, Total_Protiens, Albumin_and_Globulin_Ratio, Dataset","caaf861a":"# Feature Selection","90ffa8a1":"Among both genders, most liver patients are aged between 30-60 years.","1b42240d":"using Support Vector Classifier we get a 100% accuracy.","18fa30d9":"Total_Bilirubin has a higher variation.","4e4f5460":"Aspartate_Aminotransferase has a higher variation.","bb9d87d2":"We replace the Null values with group means to maintain the effects of Gender.","f013139a":"Two features that stand out are Age and Gender. Let's establish the importance of these.","251d12cb":"There seems to be a high correlation between  \nTotal_Bilirubin and Direct_Bilirubin  \nAspartate_Aminotransferase and Alamine_Aminotransferase  \nAlbumin and Total_Protiens  \n  \nWe can remove some of these. We will remove the ones with low variation.","a8bc9b2d":"# Machine Learning","59d0b78a":"# Normalization and Nulls","c824e9ad":"The data has more Male records than female. We will have to observe them separately.","e385a777":"We have 4 Null values to deal with."}}