{"cell_type":{"3e111fb7":"code","f2c76413":"code","8e287189":"code","7350ca21":"code","bb97888d":"code","b93db45d":"code","202d8cfb":"code","f22f69a4":"code","81e5b07b":"code","b0b96d46":"code","e367e8b4":"code","55ec9120":"code","c4cab67c":"code","76137951":"code","b8b04e56":"code","159f9938":"code","6620786c":"code","bf505bd4":"code","b5500932":"code","c5e1d1b5":"code","1421984f":"code","ce69bfa9":"code","2e659d7d":"code","667bd1f8":"markdown","f94f8992":"markdown","15ae1d5b":"markdown","d92b64f3":"markdown","dfc6c46a":"markdown"},"source":{"3e111fb7":"import numpy as np\nimport pandas as pd\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","f2c76413":"player0=pd.read_csv('..\/input\/fifa-20-complete-player-dataset\/players_20.csv')\nplayer0[0:2].T","8e287189":"# L. Messi\nprint(player0.iloc[0,1])\nprint()\nplayer0[player0['short_name']=='L. Messi']","7350ca21":"print(len(player0))\nprint(player0.columns.tolist())","bb97888d":"player=player0[0:100]\nprint(len(player))","b93db45d":"!pip3 install sqlalchemy","202d8cfb":"from sqlalchemy import create_engine\nfrom sqlalchemy.orm import scoped_session, sessionmaker\nfrom sqlalchemy.ext.declarative import declarative_base\nfrom sqlalchemy import Column,Integer,Float,String\nfrom sqlalchemy import desc, asc","f22f69a4":"#!rm data.db","81e5b07b":"database_file=os.path.join(os.path.abspath(os.getcwd()),'data.db')\ndatabase_file","b0b96d46":"engine=create_engine('sqlite:\/\/\/'+database_file,convert_unicode=True,echo=True)","e367e8b4":"db_session=scoped_session(\n    sessionmaker(\n        autocommit=False,\n        autoflush=False,\n        bind=engine\n))","55ec9120":"Base=declarative_base()\nBase.query=db_session.query_property()","c4cab67c":"class FIFA(Base):\n    __tablename__='player'\n    id=Column(Integer,primary_key=True)\n    short_name=Column(String(255),unique=False)\n    age=Column(Integer,unique=False)\n    nationality=Column(String(255),unique=False)\n    club=Column(String(255),unique=False)\n    \n    def __int__(self,id=None,long_name=None,age=None,nationality=None,club=None):\n        self.id=id\n        self.short_name=long_name\n        self.age=age\n        self.nationality=nationality\n        self.club=club","76137951":"Base.metadata.create_all(bind=engine)","b8b04e56":"def read_data():\n\n    for index,_df in player.iterrows():\n        row=FIFA(short_name=_df['short_name'],age=_df['age'],nationality=_df['nationality'],club=_df['club'])\n        db_session.add(row)\n        \n    db_session.commit()","159f9938":"read_data()","6620786c":"db=db_session.query(FIFA).filter(FIFA.short_name=='L. Messi').all()\nprint()\nfor row in db:\n    print(row.id,row.short_name,row.age)","bf505bd4":"db=db_session.query(FIFA).order_by(desc(FIFA.age)).all()\nprint()\nfor i,row in enumerate(db):\n    if i<10:\n        print(row.id,row.short_name,row.age)","b5500932":"import sqlite3","c5e1d1b5":"conn = sqlite3.connect(r'.\/data.db')\nconn","1421984f":"query = 'SELECT SHORT_NAME,AGE,NATIONALITY,CLUB FROM PLAYER'\ndb0 = pd.read_sql_query(query,conn)\ndb0","ce69bfa9":"db0[db0['short_name']=='L. Messi']","2e659d7d":"#!rm data.db","667bd1f8":"![https:\/\/dynaimage.cdn.cnn.com\/cnn\/c_fill,g_auto,w_1200,h_675,ar_16:9\/https%3A%2F%2Fcdn.cnn.com%2Fcnnnext%2Fdam%2Fassets%2F210910103403-lionel-messi-argentina-bolivia.jpg](https:\/\/dynaimage.cdn.cnn.com\/cnn\/c_fill,g_auto,w_1200,h_675,ar_16:9\/https%3A%2F%2Fcdn.cnn.com%2Fcnnnext%2Fdam%2Fassets%2F210910103403-lionel-messi-argentina-bolivia.jpg)","f94f8992":"# CRUD operation sample\nCRUD: create, read, update and delete","15ae1d5b":"# Import SQLAlchemy to Create Database\nhttps:\/\/github.com\/sqlalchemy\/sqlalchemy","d92b64f3":"# Prepare DataFrame from CSV","dfc6c46a":"# Import Sqlite3 to Convert Database to DataFrame"}}