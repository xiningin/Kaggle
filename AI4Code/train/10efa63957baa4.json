{"cell_type":{"bf04b6a6":"code","f3905cf6":"code","67497345":"code","edc60ea7":"code","66c5795c":"code","586882ca":"code","e703e3bc":"code","67813719":"code","0d224d6a":"code","189722f1":"code","2361cbb9":"code","50a04dd3":"code","532431ff":"code","fa2c851c":"code","f6231860":"code","8297850d":"code","9383719a":"code","3fecdb0a":"code","c53b54ab":"code","0c9057f2":"code","ecedbb9b":"code","97ebb278":"code","02d7ff55":"code","31222dd1":"code","d69146ae":"code","c926f210":"code","c0cdf053":"code","31a522bf":"code","deeeb788":"code","2e395d82":"code","e120dfa1":"code","860af5ac":"code","9b0e3690":"code","520f304e":"code","b0136336":"code","1345e46c":"code","676e1020":"code","37afb22a":"code","98efac9e":"code","6da8f7d8":"code","4ec1bedd":"code","c2fb3c4a":"code","a4a5590f":"code","14fb6984":"code","9e0d948a":"code","9d60e319":"code","6d008de3":"code","8b31d2a2":"code","f4e43b7b":"code","655b8e6d":"code","e1caf8e3":"code","b2b67b7d":"code","51c2e79f":"code","bc952963":"code","06e71443":"code","6fe7a733":"code","8cb2fa1d":"code","5fc75703":"code","82c6ae3c":"code","9abea4bf":"code","733f0ee9":"code","1f7479de":"code","2b011595":"code","ffb5864e":"code","2d8edf66":"code","afa888b3":"code","3406be42":"code","bfda943d":"code","9625dab4":"code","a7c53191":"code","a961f3ff":"code","5446e135":"code","4a54fbdf":"code","bc8b9e8e":"code","82c27e79":"code","9923e137":"code","31803a6d":"code","583006b3":"code","8ee62fcf":"code","8948609a":"code","f7fe50a7":"code","73591f42":"code","3b3071a1":"code","4faa8630":"code","e04044c7":"code","8fb542c6":"code","f3d6d074":"code","30fa6ffe":"code","0936f950":"code","cde96eee":"code","994179ea":"code","4cad9287":"code","9d4ec0b3":"code","16566dbc":"code","84840f50":"code","3d17f4b7":"code","554c824f":"code","e5d8ca92":"code","ce01f394":"markdown","e62f0764":"markdown","819455f7":"markdown","bcfc0824":"markdown","7ba77c5e":"markdown","d1e73970":"markdown","bf5e839f":"markdown","819a23d3":"markdown","ff3ab3e0":"markdown","4b5928db":"markdown","ed2eadaa":"markdown","c2c2e6b9":"markdown","388e3bb7":"markdown","e016a50d":"markdown","9bffc8aa":"markdown","d8863321":"markdown","d27182f0":"markdown","44a4ca2b":"markdown","fb942508":"markdown","936c8df8":"markdown","f6d109cc":"markdown","7cddc48f":"markdown","632851a9":"markdown","44e46e43":"markdown","fbb6080b":"markdown","cd0b8db4":"markdown","495d16ca":"markdown","e1866f1c":"markdown","b7e454c2":"markdown","5e3a7210":"markdown","54802a8f":"markdown","5019f82e":"markdown","ca0f19ff":"markdown","2472b960":"markdown","b6497168":"markdown","2478e712":"markdown","3042a2e4":"markdown","76448be6":"markdown"},"source":{"bf04b6a6":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\nimport warnings\nwarnings.filterwarnings(\"ignore\")","f3905cf6":"df_red = pd.read_csv(\"..\/input\/wine-quality-red\/winequality-red.csv\", sep=';') ##Gettint the data","67497345":"df_red.head()","edc60ea7":"df_red.describe()","66c5795c":"df_red.isnull().sum() ##Checking null values","586882ca":"df_white = pd.read_csv(\"..\/input\/wine-quality-red\/winequality-white.csv\",sep=';' )","e703e3bc":"df_white.head()","67813719":"df_red.quality.unique()","0d224d6a":"sns.countplot(x='quality', data=df_red)","189722f1":"df_red.loc[df_red['quality'] <= 6, 'quality'] = 0\ndf_red.loc[df_red['quality'] > 6, 'quality'] = 1 ##Converting the quality data","2361cbb9":"sns.barplot('quality','fixed acidity',data=df_red)","50a04dd3":"df_red[['fixed acidity','quality']].groupby('quality', as_index=False).mean()","532431ff":"sns.barplot('quality','volatile acidity',data=df_red)","fa2c851c":"df_red[['volatile acidity','quality']].groupby('quality', as_index=False).mean()","f6231860":"sns.barplot('quality','citric acid',data=df_red)","8297850d":"df_red[['citric acid','quality']].groupby('quality', as_index=False).mean()","9383719a":"sns.barplot('quality','residual sugar',data=df_red)","3fecdb0a":"df_red[['residual sugar','quality']].groupby('quality', as_index=False).mean()","c53b54ab":"sns.barplot('quality','chlorides',data=df_red)","0c9057f2":"df_red[['chlorides','quality']].groupby('quality', as_index=False).mean()","ecedbb9b":"sns.barplot('quality','free sulfur dioxide',data=df_red)","97ebb278":"df_red[['free sulfur dioxide','quality']].groupby('quality', as_index=False).mean()","02d7ff55":"sns.barplot('quality','total sulfur dioxide',data=df_red)","31222dd1":"df_red[['total sulfur dioxide','quality']].groupby('quality', as_index=False).mean()","d69146ae":"sns.barplot('quality','density',data=df_red)","c926f210":"df_red[['density','quality']].groupby('quality', as_index=False).mean()","c0cdf053":"sns.barplot('quality','pH',data=df_red)","31a522bf":"df_red[['pH','quality']].groupby('quality', as_index=False).mean()","deeeb788":"sns.barplot('quality','sulphates',data=df_red)","2e395d82":"df_red[['sulphates','quality']].groupby('quality', as_index=False).mean()","e120dfa1":"sns.barplot('quality','alcohol',data=df_red)","860af5ac":"df_red[['alcohol','quality']].groupby('quality', as_index=False).mean()","9b0e3690":"plt.figure(figsize=(20,15))\nsns.heatmap(df_red.corr(), annot=True)","520f304e":"df_red.columns ##Reading the columns","b0136336":"features = ['volatile acidity', 'citric acid', 'chlorides', 'total sulfur dioxide', 'sulphates', 'alcohol']\ntargets = ['quality'] ##Choosing features and targets based on the analysis on graphs and tables","1345e46c":"from sklearn.model_selection import train_test_split","676e1020":"X_train_r, X_test_r, y_train_r, y_test_r = train_test_split(df_red[features],df_red[targets],test_size=0.20, random_state=42)\n##Dividing the dataset for train and test","37afb22a":"from sklearn.model_selection import GridSearchCV\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.ensemble import RandomForestClassifier #Import relevant libraries to process the machine learn model","98efac9e":"LR = LogisticRegression()\nrfc = RandomForestClassifier()","6da8f7d8":"params_log = [{'C':[0.1, 0.5, 1, 10, 100],'max_iter':[250,500,750,1000]}]\nparams_rfc = [{'n_estimators':[150,200,250,300], 'criterion':['gini', 'entropy'], 'max_depth':[4,5,6,7,8,9]}] ##Parameters for the GridSearchCV","4ec1bedd":"grid_log = GridSearchCV(LR, params_log, n_jobs = 8, cv=10)\ngrid_rfc = GridSearchCV(rfc, params_rfc, n_jobs = 8, cv=10)","c2fb3c4a":"grid_log.fit(df_red[features],df_red[targets].values.ravel())\ngrid_rfc.fit(df_red[features],df_red[targets].values.ravel())","a4a5590f":"print(grid_log.best_params_)\nprint(grid_rfc.best_params_) ##Checking best scores to use in a model","14fb6984":"model_log = LogisticRegression(C=10, max_iter=250)\nmodel_rfc = RandomForestClassifier(n_estimators=150, max_depth=6, criterion='entropy') ##Using best parameters discovered above.","9e0d948a":"model_log.fit(X_train_r, y_train_r)\nmodel_rfc.fit(X_train_r, y_train_r)","9d60e319":"y_pred_log = model_log.predict(X_test_r)\ny_pred_rfc = model_rfc.predict(X_test_r)","6d008de3":"from sklearn.metrics import accuracy_score","8b31d2a2":"print(\"Accuracy for the Support Vector Classifier Model is: \",round(accuracy_score(y_test_r,y_pred_log)*100,2),\"%\")","f4e43b7b":"print(\"Accuracy for the Random Forest Classifier Model is: \",round(accuracy_score(y_test_r,y_pred_rfc)*100,2),\"%\")","655b8e6d":"from sklearn.metrics import classification_report","e1caf8e3":"print(\"For SVC: \\n\", classification_report(y_test_r, y_pred_log))","b2b67b7d":"print(\"For RFC: \\n\", classification_report(y_test_r, y_pred_rfc))","51c2e79f":"df_white.head()","bc952963":"df_white.describe()","06e71443":"df_white.isnull().sum()","6fe7a733":"df_white.loc[df_white['quality'] <= 6, 'quality'] = 0\ndf_white.loc[df_white['quality'] > 6, 'quality'] = 1","8cb2fa1d":"sns.barplot('quality','fixed acidity',data=df_white)","5fc75703":"df_white[['fixed acidity','quality']].groupby('quality', as_index=False).mean()","82c6ae3c":"sns.barplot('quality','volatile acidity',data=df_white)","9abea4bf":"df_white[['volatile acidity','quality']].groupby('quality', as_index=False).mean()","733f0ee9":"sns.barplot('quality','citric acid',data=df_white)","1f7479de":"df_white[['citric acid','quality']].groupby('quality', as_index=False).mean()","2b011595":"sns.barplot('quality','residual sugar',data=df_white)","ffb5864e":"df_white[['residual sugar','quality']].groupby('quality', as_index=False).mean()","2d8edf66":"sns.barplot('quality','chlorides',data=df_white)","afa888b3":"df_white[['chlorides','quality']].groupby('quality', as_index=False).mean()","3406be42":"sns.barplot('quality','free sulfur dioxide',data=df_white)","bfda943d":"df_white[['free sulfur dioxide','quality']].groupby('quality', as_index=False).mean()","9625dab4":"sns.barplot('quality','total sulfur dioxide',data=df_white)","a7c53191":"df_white[['total sulfur dioxide','quality']].groupby('quality', as_index=False).mean()","a961f3ff":"sns.barplot('quality','density',data=df_white)","5446e135":"df_white[['density','quality']].groupby('quality', as_index=False).mean()","4a54fbdf":"sns.barplot('quality','pH',data=df_white)","bc8b9e8e":"df_white[['pH','quality']].groupby('quality', as_index=False).mean()","82c27e79":"sns.barplot('quality','sulphates',data=df_white)","9923e137":"df_white[['sulphates','quality']].groupby('quality', as_index=False).mean()","31803a6d":"sns.barplot('quality','alcohol',data=df_white)","583006b3":"df_white[['alcohol','quality']].groupby('quality', as_index=False).mean()","8ee62fcf":"df_white.columns","8948609a":"plt.figure(figsize=(20,15))\nsns.heatmap(df_white.corr(), annot=True)","f7fe50a7":"df_white.columns","73591f42":"features_white = ['residual sugar', 'chlorides', 'total sulfur dioxide', 'alcohol']\ntargets = ['quality']","3b3071a1":"X_train_w, X_test_w, y_train_w, y_test_w = train_test_split(df_white[features_white],df_white[targets],test_size=0.20, random_state=42)","4faa8630":"LR1 = LogisticRegression()\nrfc1 = RandomForestClassifier()","e04044c7":"params_log1 = [{'C':[0.1, 0.5, 1, 10, 100],'max_iter':[250,500,750,1000]}]\nparams_rfc1 = [{'n_estimators':[150,200,250,300], 'criterion':['gini', 'entropy'], 'max_depth':[5,6,7,8,9]}] ##Parameters for the GridSearchCV","8fb542c6":"grid_log1 = GridSearchCV(LR1, params_log1, n_jobs = 8, cv=10)\ngrid_rfc1 = GridSearchCV(rfc1, params_rfc1, n_jobs = 8, cv=10)","f3d6d074":"grid_log1.fit(df_white[features],df_white[targets].values.ravel())\ngrid_rfc1.fit(df_white[features],df_white[targets].values.ravel())","30fa6ffe":"print(grid_log1.best_params_)\nprint(grid_rfc1.best_params_) ##Checking best scores to use in a model","0936f950":"model_log1 = LogisticRegression(C=0.1, max_iter=250)\nmodel_rfc1 = RandomForestClassifier(n_estimators=200, max_depth=8, criterion='gini') ##Using best parameters discovered above.","cde96eee":"model_log1.fit(X_train_w, y_train_w)\nmodel_rfc1.fit(X_train_w, y_train_w)","994179ea":"y_pred_log1 = model_log1.predict(X_test_w)\ny_pred_rfc1 = model_rfc1.predict(X_test_w)","4cad9287":"print(\"Accuracy for the Support Vector Classifier Model is: \",round(accuracy_score(y_test_w,y_pred_log1)*100,2),\"%\")","9d4ec0b3":"print(\"Accuracy for the Random Forest Classifier Model is: \",round(accuracy_score(y_test_w,y_pred_rfc1)*100,2),\"%\")","16566dbc":"from sklearn.metrics import classification_report","84840f50":"print(\"For SVC: \\n\", classification_report(y_test_w, y_pred_log1))","3d17f4b7":"print(\"For RFC: \\n\", classification_report(y_test_w, y_pred_rfc1))","554c824f":"accuracy = pd.DataFrame({'Red Wine':['88%','62%'],'White Wine':['83%','71%']}, index=['Bad Wine','Good Wine'])","e5d8ca92":"accuracy","ce01f394":"Density also doesn't see to add in the model too. Relative difference for good and bad wines are less than 1%","e62f0764":"##  Red Wine - Analysis","819455f7":"Not very conclusive, values also go down and up again, doesn't seem to add for quality.","bcfc0824":"It seems that as less chloride the wine has, the better its quality. Around 15% difference","7ba77c5e":"## Graphs and Tables","d1e73970":"This residual sugar data is very similar in both levels, it's clear the low relative difference, thus, we need to drop it.","bf5e839f":"Clearly, the less it has, the better the wine","819a23d3":"Now that we imported the data, we'll first analyse the data from the red dataset","ff3ab3e0":"As we can see in the graph, the table also proves that for lower values, the better the wine","4b5928db":"The more it has, the better, as expected","ed2eadaa":"Sulphates values are very close of each other. Doesn't see to add much too.","c2c2e6b9":"## Results - White Wine","388e3bb7":"Graph shows that the more it has, the better the wine. >30% relative difference","e016a50d":"Data are so close that it seems to have no big impact on quality. The difference are only in the 3rd number after the point","9bffc8aa":"pH values are also very close and no big difference is notted, expect for the best wine having a mean pH > 3.3","d8863321":"In this case, it's more clear that the less it has, the better the wine, but data varies from quality to qualiy. Need to check correlation","d27182f0":"It's clear that the less it has, the greater the grade, in average. Around 35% relative difference","44a4ca2b":"## Results - Red Wine","fb942508":"It seems the increase of alchool tends to increase the quality of the wine. Around 11% relative difference","936c8df8":"Same conclusion of free sulfur dioxide. It may be useful to use one of the sulfur features, instead of both.","f6d109cc":"It seems that the fixed acidity is not contributing to the quality of the wine. Only 7% difference between good and bad wines","7cddc48f":"Values are confusing too, going up and down, doesn't see to qualify our wine","632851a9":"Not very conclusive, because the data from the best quality has an outlier","44e46e43":"Data decrease, increase and decrease again. Doesn't seem to add much to the model.","fbb6080b":"Our model for both types of wine still need improvement on classifying both good and bad wines. But overall, we achieved an acceptable precision on both datasets, specially on the red wine data.","cd0b8db4":"## Correlation","495d16ca":"The difference isn't perceptible in relative difference. Need to drop it.","e1866f1c":"Most of our data are from the average graded wines. From previous analysis I think it's better to group the wines right now into 0 and 1. Where:\n\n- 0 is for wines with grade 0-6\n- 1 is fro wines with grade 7-10","b7e454c2":"By checking the correlation heatmatp and the tables we can extract the following insights:\n\n- The important thing to check isn't the absolute values of the means, but rather, the relative difference;\n- Fixed and Volatile Acidity have both low correlation, and we can see a low relative diffence in the values of the table; \n- Citric acid values is confuse, and correlation is almost 0. Drop it.\n- Free Sulfur Dioxide is also very close for good and bad wines, remove it;\n- Total sufur dioxide has a similar problem, but, there's a difference that I think it's worth to keep the feature;\n- Ph and sulphates correlation values are extremely low and we saw no relative difference for bad and good wines on their values;\n- *Density has a much more strong correlation for white wines, despite the relative diferenteces in the mean not being that big. I still believe this can't affect that much in wine quality (Please advise me if I'm wrong in this). Drop it*","5e3a7210":"By checking the correlation heatmatp and the tables we can extract the following insights:\n\n- The important thing to check isn't the absolute values of the means, but rather, the relative difference;\n- Fixed Acidity has a low correlation, and we can see a low relative diffence in the values of the table;\n- Free Sulfur Dioxide is indeed useful to drop, very low correlation.\n- Total Sufur Dioxide values are more clear than Free Sulfur Dioxide, so, we'll use this one;\n- Residual sugar and Ph correlation values are extremely low and we checked that on the tables.\n- Chlorides correlation is low, but we can see in the tables that better wines have 15% less Chlorides than bad wines, we'll use it\n- *Density seems to have a usable correlation, but the mean values are around 0.2% different from each other, and I believe this can't affect that much in wine quality (Please advise me if I'm wrong in this).*\n","54802a8f":"In previous runs of this dataset, the values of quality were not pre-processed, thus, the precision was terrible!\n\n- By changing the values of only the quality column, we were able to get a 86% weighted accuracy for a Random Forest Classifier.","5019f82e":"Our goal is to predict the quality of the Wine, which have values from 3 to 8. Let's check some visualisations for all variables and their effect on the quality.","ca0f19ff":"As we can see in the plot, the table also proves that for higher values, the better the wine. Around 13% relative difference","2472b960":"By checking the correlation between the features, and removing unnecessary features, the model performed badly. We'll try SVM and check if it can improve it.","b6497168":"Data was not very conclusive when having all wines range (0-10). But now is clear that better wines has less free sulfur dioxide.","2478e712":"##  White Wine - Analysis","3042a2e4":"Our model for Red Wine still needs improvement to classify Good Wines, having around 69% accuracy for good wines and 88% for bad wines (which are the most par of our dataset) in our Random Forest Classifier\n\nOur SVC model had 98% precision for good wines, this may be explained by the data used, the features were very good in dividing good and bad wines. However, the precisions drops to 84% for bad wines, this may be explained for the wider range on their features and also more data on it. The values still good. \n\nHowever, to maintain the use of the same model, we'll try to improve and use Random Forest Classifier for both datasets.\n\n\nFor future versions (2 and beyond), the model will try to improve:\n\n- Classification of good wines (1's) on the Red Wine Dataset\n- Classification of bad wines (0's) on the White Wine Dataset \n- Better Visualization of the results","76448be6":"## Insights"}}