{"cell_type":{"205cd688":"code","395c321d":"code","1f8723d3":"code","d9cc089a":"code","69cb5c3f":"code","450e6487":"code","73a706af":"code","a43fbf5a":"code","8897cb13":"code","a40fdeca":"code","3bb44d83":"code","60bde228":"code","66ee1e9b":"code","f529cf45":"code","4843f89b":"code","6457a2a8":"code","f499f048":"code","e4860a75":"markdown","49d03e3a":"markdown","08c804cc":"markdown","3f60f0ff":"markdown","c4dbd39f":"markdown","0e7f36fd":"markdown","c85fdfd3":"markdown","2294be7a":"markdown","c7080406":"markdown","1155383e":"markdown","0080af6a":"markdown","7b30c308":"markdown","988a5940":"markdown","6e2dd3ee":"markdown","756308e4":"markdown","cd576645":"markdown","c343caf4":"markdown","c725e6bb":"markdown"},"source":{"205cd688":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\n\ncardio = pd.read_csv('..\/input\/d\/maleknaim\/cardio\/health.csv')\ncardio2 = pd.read_csv('..\/input\/body-performance-data\/bodyPerformance.csv')\nsmoking = pd.read_csv('..\/input\/cardio\/cardio.csv')","395c321d":"cardio['grade_dias'] = cardio['ap_lo'].apply(lambda x: 0 if x < 80 and x >= 60 \n                                        else (1 if x == 80 \n                                        else (2 if x == 81\n                                        else (3 if x == 82 \n                                        else (4 if x == 83\n                                        else (5 if x == 84 \n                                        else (6 if x == 85\n                                        else (7 if x == 86\n                                        else (8 if x == 87\n                                        else (9 if x == 88\n                                        else (10 if x == 89\n                                        else (11 if x == 90 or x == 91\n                                        else (12 if x == 92 or x == 93\n                                        else (13 if x == 94 or x == 95\n                                        else (14 if x == 96 or x == 97\n                                        else (15 if x == 98 or x == 99\n                                        else (16 if x == 100 or x == 101\n                                        else (17 if x == 102 or x == 103\n                                        else (18 if x == 104 or x == 105\n                                        else (19 if x == 106 or x == 107\n                                        else (20 if x == 108 or x == 109\n                                        else (21 if x == 110 or x == 111\n                                        else (22 if x == 112 or x == 113\n                                        else (23 if x == 114 or x == 115\n                                        else (24 if x == 116 or x == 117\n                                        else (25 if x > 117 else 0)))))))))))))))))))))))))) ","1f8723d3":"cardio['grade_sys'] = cardio['ap_hi'].apply(lambda x: 0 if x < 120 and x >=100 \n                                        else (1 if x >= 120  and x < 122\n                                        else (2 if x >= 122  and x < 124\n                                        else (3 if x >= 124  and x < 126 \n                                        else (4 if x >= 126  and x < 128\n                                        else (5 if x >= 128  and x < 130 \n                                        else (6 if x >= 130  and x < 132\n                                        else (7 if x >= 132  and x < 134\n                                        else (8 if x >= 134  and x < 136\n                                        else (9 if x >= 136  and x < 138\n                                        else (10 if x >= 138  and x < 140\n                                        else (11 if x >= 140  and x < 144\n                                        else (12 if x >= 120  and x < 148\n                                        else (13 if x >= 148 and x < 152\n                                        else (14 if x >= 152  and x < 156\n                                        else (15 if x >= 156  and x < 160\n                                        else (16 if x >= 160  and x < 164\n                                        else (17 if x >= 164  and x < 168\n                                        else (18 if x >= 168  and x < 172\n                                        else (19 if x >= 172  and x < 176\n                                        else (20 if x >= 176  and x < 180\n                                        else (21 if x >= 180  and x < 184\n                                        else (22 if x >= 184  and x < 188\n                                        else (23 if x >= 192  and x < 196\n                                        else (24 if x >= 196  and x < 200\n                                        else (25 if x <= 200 else 0)))))))))))))))))))))))))) ","d9cc089a":"cardio[\"BMI\"]= cardio[\"weight\"] \/ (cardio[\"height\"]\/100)**2\ncardio.BMI = cardio.BMI.astype(int)\n\ncardio = cardio.loc[cardio[\"ap_hi\"] >= 100 ]\ncardio = cardio.loc[cardio[\"ap_hi\"] <= 200 ]\ncardio = cardio.loc[cardio[\"ap_lo\"] >= 60  ]\ncardio = cardio.loc[cardio[\"ap_lo\"] <= 120 ]\ncardio = cardio.loc[cardio[\"height\"] < 200 ]\ncardio = cardio.loc[cardio[\"height\"] >= 150 ]\n\n\n\ncardio['grade'] = np.where(cardio['grade_sys'] >= cardio['grade_dias'], cardio['grade_sys'], cardio['grade_dias'])\n\n\n\ncardio = cardio.rename(columns={\"ap_lo\":\"diastolic\", \"ap_hi\":\"systolic\"})\ncardio = cardio.loc[:,['height','weight','systolic','diastolic','BMI', 'grade_dias', 'grade_sys','grade']]\n\nprint(cardio)\n\ncardio.to_csv('modifiedCardio.csv')","69cb5c3f":"ax1 = cardio.plot.scatter(x='BMI',y='grade',c='DarkBlue')","450e6487":"from scipy import stats\n\n# r-value\ncardio['grade'].corr(cardio['BMI'])\n\n#p-value\nstats.pearsonr(cardio['grade'],cardio['BMI'])\n\n","73a706af":"cardio2['grade_dias'] = cardio2['diastolic'].apply(lambda x: 0 if x < 80 and x >= 60 \n                                        else (1 if x == 80 \n                                        else (2 if x == 81\n                                        else (3 if x == 82 \n                                        else (4 if x == 83\n                                        else (5 if x == 84 \n                                        else (6 if x == 85\n                                        else (7 if x == 86\n                                        else (8 if x == 87\n                                        else (9 if x == 88\n                                        else (10 if x == 89\n                                        else (11 if x == 90 or x == 91\n                                        else (12 if x == 92 or x == 93\n                                        else (13 if x == 94 or x == 95\n                                        else (14 if x == 96 or x == 97\n                                        else (15 if x == 98 or x == 99\n                                        else (16 if x == 100 or x == 101\n                                        else (17 if x == 102 or x == 103\n                                        else (18 if x == 104 or x == 105\n                                        else (19 if x == 106 or x == 107\n                                        else (20 if x == 108 or x == 109\n                                        else (21 if x == 110 or x == 111\n                                        else (22 if x == 112 or x == 113\n                                        else (23 if x == 114 or x == 115\n                                        else (24 if x == 116 or x == 117\n                                        else (25 if x <= 200 else 0)))))))))))))))))))))))))) ","a43fbf5a":"cardio2['grade_sys'] = cardio2['systolic'].apply(lambda x: 0 if x < 120 and x >=100 \n                                        else (1 if x >= 120  and x < 122\n                                        else (2 if x >= 122  and x < 124\n                                        else (3 if x >= 124  and x < 126 \n                                        else (4 if x >= 126  and x < 128\n                                        else (5 if x >= 128  and x < 130 \n                                        else (6 if x >= 130  and x < 132\n                                        else (7 if x >= 132  and x < 134\n                                        else (8 if x >= 134  and x < 136\n                                        else (9 if x >= 136  and x < 138\n                                        else (10 if x >= 138  and x < 140\n                                        else (11 if x >= 140  and x < 144\n                                        else (12 if x >= 120  and x < 148\n                                        else (13 if x >= 148 and x < 152\n                                        else (14 if x >= 152  and x < 156\n                                        else (15 if x >= 156  and x < 160\n                                        else (16 if x >= 160  and x < 164\n                                        else (17 if x >= 164  and x < 168\n                                        else (18 if x >= 168  and x < 172\n                                        else (19 if x >= 172  and x < 176\n                                        else (20 if x >= 176  and x < 180\n                                        else (21 if x >= 180  and x < 184\n                                        else (22 if x >= 184  and x < 188\n                                        else (23 if x >= 192  and x < 196\n                                        else (24 if x >= 196  and x < 200\n                                        else (25 if x <= 200 else 0)))))))))))))))))))))))))) ","8897cb13":"cardio2 = cardio2.rename(columns={\"body fat_%\":\"bodyfat\"})\ncardio2['bodyfat'] = cardio2['bodyfat'].astype(int)\n\n\ncardio2 = cardio2.loc[cardio2[\"systolic\"] >= 100 ]\ncardio2 = cardio2.loc[cardio2[\"systolic\"] <= 200 ]\ncardio2 = cardio2.loc[cardio2[\"diastolic\"] >= 60  ]\ncardio2 = cardio2.loc[cardio2[\"diastolic\"] <= 120 ]\n\n\ncardio2['grade'] = np.where(cardio2['grade_sys'] >= cardio2['grade_dias'], cardio2['grade_sys'], cardio2['grade_dias'])\n\n\ncardio2 = cardio2.loc[:,['diastolic', 'systolic','bodyfat','grade_dias', 'grade_sys','grade']]\n\n\nprint(cardio2)\ncardio2.to_csv('modifiedCardio2.csv')","a40fdeca":"ax2 = cardio2.plot.scatter(x='bodyfat',y='grade',c='DarkBlue')","3bb44d83":"from scipy import stats\n\n# r-value\ncardio2['grade'].corr(cardio2['bodyfat'])\n\n#p-value\nstats.pearsonr(cardio2['grade'],cardio2['bodyfat'])\n\n","60bde228":"smoking['grade_dias'] = smoking['diaBP'].apply(lambda x: 0 if x < 80 and x >= 60 \n                                        else (1 if x == 80 \n                                        else (2 if x == 81\n                                        else (3 if x == 82 \n                                        else (4 if x == 83\n                                        else (5 if x == 84 \n                                        else (6 if x == 85\n                                        else (7 if x == 86\n                                        else (8 if x == 87\n                                        else (9 if x == 88\n                                        else (10 if x == 89\n                                        else (11 if x == 90 or x == 91\n                                        else (12 if x == 92 or x == 93\n                                        else (13 if x == 94 or x == 95\n                                        else (14 if x == 96 or x == 97\n                                        else (15 if x == 98 or x == 99\n                                        else (16 if x == 100 or x == 101\n                                        else (17 if x == 102 or x == 103\n                                        else (18 if x == 104 or x == 105\n                                        else (19 if x == 106 or x == 107\n                                        else (20 if x == 108 or x == 109\n                                        else (21 if x == 110 or x == 111\n                                        else (22 if x == 112 or x == 113\n                                        else (23 if x == 114 or x == 115\n                                        else (24 if x == 116 or x == 117\n                                        else (25 if x <= 200 else 0)))))))))))))))))))))))))) ","66ee1e9b":"smoking['grade_sys'] = smoking['sysBP'].apply(lambda x: 0 if x < 120 and x >=100 \n                                        else (1 if x >= 120  and x < 122\n                                        else (2 if x >= 122  and x < 124\n                                        else (3 if x >= 124  and x < 126 \n                                        else (4 if x >= 126  and x < 128\n                                        else (5 if x >= 128  and x < 130 \n                                        else (6 if x >= 130  and x < 132\n                                        else (7 if x >= 132  and x < 134\n                                        else (8 if x >= 134  and x < 136\n                                        else (9 if x >= 136  and x < 138\n                                        else (10 if x >= 138  and x < 140\n                                        else (11 if x >= 140  and x < 144\n                                        else (12 if x >= 120  and x < 148\n                                        else (13 if x >= 148 and x < 152\n                                        else (14 if x >= 152  and x < 156\n                                        else (15 if x >= 156  and x < 160\n                                        else (16 if x >= 160  and x < 164\n                                        else (17 if x >= 164  and x < 168\n                                        else (18 if x >= 168  and x < 172\n                                        else (19 if x >= 172  and x < 176\n                                        else (20 if x >= 176  and x < 180\n                                        else (21 if x >= 180  and x < 184\n                                        else (22 if x >= 184  and x < 188\n                                        else (23 if x >= 192  and x < 196\n                                        else (24 if x >= 196  and x < 200\n                                        else (25 if x <= 200 else 0))))))))))))))))))))))))))","f529cf45":"smoking = smoking.replace([np.inf, -np.inf], np.nan)\nsmoking = smoking.loc[smoking[\"sysBP\"] >= 100 ]\nsmoking = smoking.loc[smoking[\"sysBP\"] <= 200 ]\nsmoking = smoking.loc[smoking[\"diaBP\"] >= 60  ]\nsmoking = smoking.loc[smoking[\"diaBP\"] <= 120 ]\nsmoking = smoking.loc[smoking[\"cigsPerDay\"] != 0 ]\nsmoking = smoking.dropna()\n\n\nsmoking['grade'] = np.where(smoking['grade_sys'] >= smoking['grade_dias'], smoking['grade_sys'], smoking['grade_dias'])\n\n\nsmoking = smoking.rename(columns={\"diaBP\":\"diastolic\", \"sysBP\":\"systolic\"})\nsmoking = smoking.loc[:,['diastolic','systolic','cigsPerDay','grade_sys','grade_dias','grade']]\n\n\nprint(smoking)\nsmoking.to_csv('modifiedSmoking.csv')","4843f89b":"ax3 = smoking.plot.scatter(x='cigsPerDay',y='grade',c='DarkBlue')","6457a2a8":"from scipy import stats\n\n# r-value\nsmoking['grade'].corr(smoking['cigsPerDay'])\n\n#p-value\nstats.pearsonr(smoking['grade'],smoking['cigsPerDay'])\n\n","f499f048":"result = cardio.append(cardio2, sort=False)\nresult2 = result.append(smoking, sort=False)\n\ncor = result2.loc[:,['BMI','bodyfat','cigsPerDay','grade']]\ncormat = cor.corr()\nsns.heatmap(cormat)","e4860a75":"#  **Conclusion**\n\n\n> **Hypothesis 1:**\n\nWith an r-value of **0.27373385366863334** and a p-value of **0.0**, the first hypothesis is to be answered as follows: there is a slight positive correlation between BMI and blood pressure levels. Due to the low p-value, the determined r-value is to be considered a very reliable value.\n\n\n\n> **Hypothesis 2:**\n\nWith an r-value of **-0.0013466740782439128**  and a p-value of **0.8783536765424932**, the first hypothesis is to be answered as follows: there is a no positive correlation between body fat percentage and blood pressure levels. However, this determined value is virtually unusable due to the extremely high p-value.\n\n\n> **Hypothesis 3:**\n\nWith an r-value of **0.04929154978051733** and a p-value of **0.041010496136695815**, the first hypothesis is to be answered as follows: there is a virtually no positive correlation between the amount of cigarettes consumed a day and blood pressure levels. Due to the low p-value, the determined r-value is to be considered a reliable value.\n\nThe **heatmap** visualizes the correlation between the BMI, body fat, the number of cigarettes per day consumed and the blood pressure level:","49d03e3a":"The following part defines the blood pressure categories for the **systolic blood pressure** values for the table \"smoking\".","08c804cc":"To provide a clearer structure of the data the column \"body fat%\" is being renamed and set to an integer. The data is cleaned and modified as described. ","3f60f0ff":"In the following you can see the **scatter plot**  for the number of cigarettes per day consumed and the grades of blood pressure","c4dbd39f":"# Hypthesis 3\n\nThe following part defines the blood pressure categories for the **diastolic blood pressure** values for the table \"smoking\".","0e7f36fd":"The following part defines the blood pressure categories for the **systolic blood pressure** values for the table \"cardio2\".","c85fdfd3":"In the following you can see **the scatter plot** for the body fat percentage and the grades of blood pressure","2294be7a":"The data is cleaned and modified as described. Finally the colums \"sysBP\" and \"diaBP\" are renamed to \"systolic\" and \"dystolic\" to match the other tables.","c7080406":"# Introduction\n\n\nWelcome to my Integrationsseminar assignment on Cardiovascular health.\n\nAs an avid health and sports enthusiast, I am keenly interested in health data, especially that of cardiovascular health in humans. One of the most common health problems and number one death cause worldwide are cardiovascular diseases. These can be caused by many different but obvious factors like diabetes, etc. The focus here is on high blood pressure in people of different ages. \nHigh blood pressure is often referred to as the \"silent killer\" because it damages the blood vessels unnoticed and can lead to serious diseases such as heart attack or stroke. To avoid high blood pressure, people are said to need to maintain a healthy weight. What is interesting now is how an \"unhealthy weight\" should be determined. The two approaches to determining an unhealthy weight would be to calculate BMI and determine body fat percentage. Since BMI is not meaningful enough for all people to infer healthy weight (due to different bone density, for some sports, etc.) I would like to determine which correlation to higher risk of hypertension is stronger by comparing the correlation between BMI and blood pressure values (systolic and diastolic) and the correlation between KFA (body fat percentage) and blood pressure values. These hypertension values are given in the categories specified by the American Heart Association (Optimal, Normal, Elevated, High Blood Pressure; Hypertension Stage 1, High Blood Pressure; Hypertension Stage 2, Hypertensive Crisis). \nIn addition, the correlation between the number of cigarettes consumed per day and blood pressure levels will be investigated. It is well known that smoking is harmful to the cardiovascular system, but it is interesting to see whether the number of cigarettes smoked by daily smokers also has an influence.\n\n\nThese are my **hypotheses**:\n\n* There is a positive correlation between the BMI of a person and the blood pressure values\n* There is a positive correlation between the body fat of a person and the blood pressure values \n* There is a positive correlation between the number of cigarettes a day an active smoker smokes and the blood pressure values\n\n\nI have adjusted the columns of the 3 tables, so that only those are displayed that serve to answer the hypotheses. I have also cleaned up the data, as there were many that fall outside the usable range. Now only blood pressure values are considered that are in the optimal range or higher, i.e. no values for low blood pressure values. There are also some data that are very unrealistic or may have been entered incorrectly (e.g., negative blood pressure values above 200, people with short stature or very tall people). Therefore, the upper limit of the considered blood pressure values is set to 200 over 120 and the height limits to 150 cm and 200 cm, because for people apart from these values, many values (e.g., BMI) are not conclusive.\n\n* The degrees of blood pressure values are given in categories, each divided into 5 ranges:\n\n    * Optimal blood pressure (0)\n    * Normal blood pressure (1, ..., 5) \n    * High-normal blood pressure (6, ...,10)\n    * Grade 1 Hypertension (11, ...,15)\n    * Grade 2 Hypertension (16, ...,20) \n    * Grade 3 Hypertension (21, ...,25)\n\n","1155383e":"Here the **r and p value** are calculated.","0080af6a":"Here the **r and p** value are calculated","7b30c308":"In the following you can see the **scatter plot** for the BMI and the grades of blood pressure ","988a5940":"For simplification reasons I have renamed the tables for the purpose of answering the hypotheses. \n\n* \"cardio\" is for determining the correlation between the BMI of a person and the blood pressure values\n* \"cardio2\" is for determining the correlation between the body fat of a person and the blood pressure values \n* \"smoking\" is for determining the correlation between the number of cigarettes a day an active smoker smokes and the blood pressure values ","6e2dd3ee":"Here the **r and p** value are calculated","756308e4":"The following part defines the blood pressure categories for the **systolic blood pressure** values for the table \"cardio\".","cd576645":"\n\n# Hypothesis 1\n\nThe following part defines the blood pressure categories for the **diastolic blood pressure** values for the table \"cardio\".","c343caf4":"In the following part first the column \"BMI\" is defined and set to type:int. Then the data is cleaned and modified as described. Finally the colums \"ap_hi\" and \"ap_lo\" are renamed to \"systolic\" and \"dystolic\" to match the other tables.","c725e6bb":"# Hypothesis 2\n\nThe following part defines the blood pressure categories for the **diastolic blood pressure** values for the table \"cardio2\"."}}