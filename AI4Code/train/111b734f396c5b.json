{"cell_type":{"a7879cdd":"code","d7057fc5":"code","78361be6":"code","fc6db35a":"code","cc56c39d":"code","d63085bf":"code","c979787a":"code","ce5a814f":"code","43e8ad1c":"code","1424b6e6":"code","f0685b9e":"code","5d4f98f3":"code","bca828b1":"code","acaa4f15":"code","2cb7ea4f":"code","741756ae":"markdown","80cc0bf2":"markdown","70429448":"markdown","be42ca5e":"markdown","1a8dde90":"markdown","8cadf85a":"markdown","b17281fa":"markdown","9171d895":"markdown","16564c79":"markdown","6450abf0":"markdown","a7f1011e":"markdown"},"source":{"a7879cdd":"import pandas as pd\nimport numpy as np \nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline\nfrom mlxtend.frequent_patterns import apriori, association_rules\nfrom mlxtend.preprocessing import TransactionEncoder","d7057fc5":"grocery = pd.read_csv('..\/input\/grocerystoredataset\/GroceryStoreDataSet.csv', names = ['Products'], sep = ',')","78361be6":"grocery.head()","fc6db35a":"grocery.tail(5)","cc56c39d":"grocery.info()","d63085bf":"grocery.describe()","c979787a":"grocery.shape","ce5a814f":"grocery_df = list(grocery[\"Products\"].apply(lambda x:x.split(\",\") ))\ngrocery_df","43e8ad1c":"te = TransactionEncoder()\nte_data = te.fit(grocery_df).transform(grocery_df)\ngdf = pd.DataFrame(te_data, columns = te.columns_)\ngdf = gdf.replace(False,0)\ngdf","1424b6e6":"gdf = gdf.replace(True,1)\ngdf","f0685b9e":"gdf.sum().to_frame('Frequency').sort_values('Frequency',ascending=False).plot(kind='bar',\n                                                                                  figsize=(12,8),\n                                                                                  title=\"Frequent Items\")\nplt.show()","5d4f98f3":"gdf1 = apriori(gdf, min_support = 0.2, use_colnames = True, verbose = 1)\ngdf1","bca828b1":"gdf1.sort_values(by = \"support\" , ascending = False)","acaa4f15":"gdf_rules = association_rules(gdf1, metric = 'confidence', min_threshold = 0.6)\ngdf_rules","2cb7ea4f":"gdf_rules.sort_values(by = \"lift\", ascending = False)","741756ae":"Lift indicates:\n\nWhether if two type of products can be sold together - lift value higher than 1\nWhether 1 product be substitute of other - lift value lower than 1\nWhether if there is no relation between the type or products - lift value equals to 1","80cc0bf2":"In the next step, we'll chose the 60% minimum confidence value. In other words, when product A is purchased, product B also got purchased 60% or more time.","70429448":"Sorted from highest to lowest WRT Support values","be42ca5e":"Let's load the dataset","1a8dde90":"From above table:\n\nThe probability of Milk sales is 25%\nMilk and Bread are sold together in 20% of all purchases (support)\n80% of customers who buy Milk will also buy Bread (confidence)\nSales of Bread increased by 1.23 times in shopping with Milk (lift)\nMilk & Bread correlation with each other is seen as 1.75","8cadf85a":"Using TransactionEncoder, we convert the list to a One-Hot Encoded Boolean list. Products that customers bought or did not buy during shopping will now be represented by values 1 and 0.","b17281fa":"Here, we have split the products and create a list.","9171d895":"Here we come to know that, there are no null records. Total 20 records are present in one single columns.","16564c79":"In the next step, we are applying Apriori algrithm. For this data set, we'll set a min_support value with a threshold value of 20% and printed them on the screen as well.","6450abf0":"Applying Apriori Algorithm","a7f1011e":"Finding first 5 and last 5 records"}}