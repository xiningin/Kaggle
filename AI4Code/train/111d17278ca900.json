{"cell_type":{"ec6a335f":"code","19eb3d52":"code","68222562":"code","ba9a98fd":"code","f5c89656":"code","4d25ca21":"code","e86c0ba3":"code","e491ea22":"code","dc733f3e":"code","caaccbc7":"code","4d454078":"code","664a39b4":"code","60a3b68d":"code","4fc4824b":"code","da1e9b37":"code","9c613fa8":"code","b71e37c7":"code","6c28901d":"code","282a05b6":"code","b0c683c2":"code","34ddea5b":"code","accc74d7":"code","87fe4806":"code","51d968ba":"code","42412354":"code","b5ed91da":"code","7d28605e":"code","84d87720":"code","c98d22de":"code","9cdd32e1":"code","ff2f8da4":"code","d25026aa":"code","61df85e6":"code","a94ec49e":"code","ad7f2809":"code","944fffe0":"code","bca04b45":"code","edd94541":"code","69c4b1bc":"code","cf409b8f":"code","322d381e":"code","2aa3ba69":"markdown","088cbbdf":"markdown","4b7b6098":"markdown","a1092e53":"markdown","363ee30e":"markdown","74adc4bb":"markdown","e5444b6a":"markdown","a5e5b427":"markdown","337bb55c":"markdown","ceb0b0bd":"markdown","1a79fcf5":"markdown","ad08825e":"markdown","e446695b":"markdown","1635e29f":"markdown","e418b5b1":"markdown","b5f255c4":"markdown","eb3232ef":"markdown","91415f6c":"markdown","5e4015d7":"markdown","34a1e565":"markdown","34f83c4d":"markdown","13c2aaf8":"markdown","d3144bb0":"markdown"},"source":{"ec6a335f":"#import libraries\n\nimport numpy as np \nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport plotly.express as px\nimport plotly.graph_objects as go\nimport plotly.figure_factory as ff\nfrom plotly.subplots import make_subplots\nimport os\n","19eb3d52":"#import data\n\ndf = pd.read_csv('\/kaggle\/input\/heart-failure-clinical-data\/heart_failure_clinical_records_dataset.csv')","68222562":"df.sample(5)\n","ba9a98fd":"df.info()","f5c89656":"df.describe().T","4d25ca21":"#Shortening long names in database\ndf.rename(columns={ 'high_blood_pressure' : 'hbp' , 'creatinine_phosphokinase' : 'cpk' ,'DEATH_EVENT':'death_event', }  , inplace=True)\n","e86c0ba3":"#check the data if there are any null values\ndf.isnull().values.any()","e491ea22":"# if data has null values , check the sum of null values\n\ndf.isnull().sum()","dc733f3e":"df.mean()","caaccbc7":"plt.figure(figsize=(20,10))\nsns.heatmap(df.corr(), annot = True)\nplt.title('Correlation Matrix ')\n\n","4d454078":"men        =df[df['sex']==1]\nwomen      =df[df['sex']==0]\nvalues_sex =[len(men),len(women)]\nlabels_sex     = ['Male','Female']\n\nmen_survive   = df[(df['death_event']==0) & (df['sex']==1)] \nmen_die       = df[(df['death_event']==1) & (df['sex']==1)]\nwomen_survive = df[(df['death_event']==0) & (df['sex']==0)]\nwomen_die     = df[(df['death_event']==1) & (df['sex']==0)]\n\nvalue_total   = [len(men_survive),len(men_die),len(women_survive),len(women_die)]\nlabels     = ['Male - Survived','Male - Died', 'Female -  Survived', 'Female - Died']","664a39b4":"fig = make_subplots(rows=1, cols=2, specs=[[{'type':'domain'}, {'type':'domain'}]])\nfig.add_trace(go.Pie(labels=labels_sex, values=values_sex, title='Female-Male Ratio',pull=[0.02, 0.02]),\n              1, 1)\nfig.add_trace(go.Pie(labels=labels ,title='Female-Male Mortality Ratio', values=value_total, pull=[0.02, 0.02, 0.02, 0.02]),\n              1, 2)\n","60a3b68d":"fig = px.histogram(df, x='age', color='sex', marginal=\"box\", hover_data=df.columns,title='Analysis in Age on Gender')\nfig.show()","4fc4824b":"not_dead= df[(df['death_event']==0) & (df['age']>=50)] \ndead    = df[(df['death_event']==1) & (df['age']>=50)]\n\n\nvalue_total   = [len(not_dead),len(dead)]\nlabels     = ['Not died people','Died People']\n\nfigure = go.Figure(data=[go.Pie(labels=labels ,title='Died and not died people between 60 and 95 years old', values=value_total, pull=[0.02, 0.02])])\n\nfigure.show()","da1e9b37":"figure = px.histogram(df, x='age', color='smoking', marginal=\"rug\", hover_data=df.columns,title='Analysis in Age on smoking')\nfigure.show()","9c613fa8":"fig = px.strip(df, x=\"smoking\", y=\"time\", color=\"death_event\")\nfig.show()","b71e37c7":"figure = px.histogram(df, x='age', y='death_event',color='smoking', marginal=\"violin\", hover_data=df.columns,title='Analysis Death event in smoking according to age')\nfig.update_layout(template = 'seaborn')\nfigure.show()","6c28901d":"fig = px.pie(df, values='anaemia',names='death_event', title='Analysis anaemia on Death Event')\nfig.show()","282a05b6":"smoking_yes_anemia     = df[(df[\"smoking\"]==1) & (df['anaemia']==1)]\nsmoking_yes_anemia_no  = df[(df[\"smoking\"]==1) & (df['anaemia']==0)]\nsmoking_no_aneamia_yes = df[(df[\"smoking\"]==0) & (df['anaemia']==1)]\nsmoking_no_anemia_     = df[(df[\"smoking\"]==0) & (df['anaemia']==0)]\n\nlabels = ['Smoking Yes, Anaemia Yes --> Dead','Smoking Yes, Anaemia No --> Dead', 'Smoking No, Anaemia Yes --> Dead', 'Smoking No, Anemia No--> Dead']\nvalues = [len(smoking_yes_anemia     [df[\"death_event\"]==1]),\n          len(smoking_yes_anemia_no  [df[\"death_event\"]==1]),\n          len(smoking_no_aneamia_yes [df[\"death_event\"]==1]),\n          len(smoking_no_anemia_     [df[\"death_event\"]==1])]\n\nfig = go.Figure(data=[go.Pie(labels=labels, values=values, hole=.4)])\n\nfig.update_layout(title_text=\"The reflection of the relationship between anaemia and smoking on deaths.\",template='seaborn')\nfig.show()","b0c683c2":"figure = px.pie(df, values='diabetes',names ='death_event',title='Analysis in diabetes')\nfigure.show()","34ddea5b":"fig = px.density_heatmap(df, x=\"diabetes\", y=\"age\", facet_row=\"death_event\",facet_col=\"sex\")\nfig.update_layout(title_text=\"Analysis of Age and Diabetes on Death Event\",template='seaborn')\n\nfig.show()\n","accc74d7":"fig = go.Figure()\nfig.add_trace(go.Histogram(x = df['cpk'],\n        xbins=dict( # bins used for histogram\n        start=10,\n        end=600,\n        size=15\n    ),\n\n))\nfig.update_layout(template = 'seaborn',title=' CPK distribution')","87fe4806":"fig = px.scatter(df, x=\"cpk\", y=\"age\", color=\"death_event\", trendline=\"lowess\")\nfig.update_layout(title= 'Analysis of Creatine Phosphokinase on death event and age',template = 'seaborn')\n\nfig.show()","51d968ba":"fig = px.histogram(df,\"serum_creatinine\",color='death_event',title='Serum creatinine distribution',nbins=100)\nfig.update_layout(template = 'seaborn')\nfig.show()","42412354":"fig = px.scatter(df, x='serum_creatinine', y='age', color='death_event',trendline=\"ols\",marginal_y='box')\nfig.update_layout(template = 'seaborn',title='Analysis of serum creatinine on age and death_event')\nfig.show()","b5ed91da":"fig = px.scatter_3d(df, x='serum_creatinine', y='serum_sodium', z='time', color='death_event')\nfig.update_layout(template = 'seaborn',title='Analysis of death event ,according to serum_sodium , serum_creatinine and time. ')\nfig.show()","7d28605e":"fig = go.Figure()\nfig.add_trace(go.Histogram(x = df['serum_sodium']))\nfig.update_layout(template = 'seaborn',title='Serum Sodium Distribution')","84d87720":"alive      = df[df['death_event']==0]['serum_sodium']\ndead         = df[df['death_event']==1]['serum_sodium']\nhist_data = [alive,dead]\ngroup_labels = ['Alive', 'Dead']\nfig = ff.create_distplot(hist_data, group_labels, bin_size=1)\nfig.update_layout(title_text=\"Analysis in Serum Sodium on Survival Status\",template = 'seaborn')\nfig.show()","c98d22de":"fig = go.Figure()\nfig.add_trace(go.Histogram(x = df['ejection_fraction'] ))\nfig.update_layout(template = 'seaborn',title='Ejection_fraction Distribution')","9cdd32e1":"fig = px.density_contour(df, x='ejection_fraction', y='serum_sodium',color=\"death_event\")\nfig.update_layout(template = 'seaborn',title=' Density of ejection fraction and serum sodium')\nfig.show()","ff2f8da4":"fig = px.pie(df, values='hbp',names='death_event',title='Analysis in High blood pressure on Death Event')\nfig.show()","d25026aa":"fig = px.scatter(df, x=\"platelets\", y=\"age\", facet_col=\"hbp\", color=\"death_event\", trendline=\"lowess\")\nfig.show()","61df85e6":"fig = go.Figure()\nfig.add_trace(go.Histogram(x = df['platelets'] ))\nfig.update_layout(template = 'seaborn',title='Platelets Distribution')","a94ec49e":"fig = px.histogram(df,'platelets',color='death_event',title='Death Event of Platelets',nbins=100)\nfig.update_layout(template = 'seaborn')\nfig.show()","ad7f2809":"from sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.preprocessing import StandardScaler, MinMaxScaler\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import RandomForestClassifier, GradientBoostingClassifier, BaggingClassifier\nfrom sklearn.naive_bayes import GaussianNB\nfrom sklearn.svm import SVC\nfrom sklearn.metrics import accuracy_score, precision_score, recall_score, f1_score","944fffe0":"model_list = [KNeighborsClassifier(n_jobs = -1), \n              RandomForestClassifier(n_jobs = -1), \n              DecisionTreeClassifier(), \n              GaussianNB(), \n              SVC(), \n              GradientBoostingClassifier(),\n              BaggingClassifier(), \n              LogisticRegression()\n             ]","bca04b45":"normalizer = MinMaxScaler()\ndf = pd.DataFrame(normalizer.fit_transform(df), index = range(len(df)), columns = df.columns)","edd94541":"X = df[df.columns[:-1]]\ny = df[df.columns[-1]]\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.2)","69c4b1bc":"def evaluate_model(model, y_pred, y_true):\n\n    \n    acc_result = accuracy_score(y_pred, y_true)\n    prec_result = precision_score(y_pred, y_true)\n    recall_result = recall_score(y_pred, y_true)\n    f1_result = f1_score(y_pred, y_true)\n    \n    return {'Accuracy' : acc_result, \n            'Precision' : prec_result, \n            'Recall' : recall_result, \n            'F1_Score' : f1_result\n           }\n    \n    ","cf409b8f":"results = dict()\nfor model in model_list:\n    \n    model.fit(X_train, y_train)\n    y_pred = model.predict(X_test)\n    results[str(model)] = evaluate_model(model, y_pred, y_test)\n    ","322d381e":"results","2aa3ba69":"* Approximately 32% of the patients with diabetes seem to have died, if we look at the data in detail :","088cbbdf":"* The age range in which diabetes affects death rates most in male and female patients is 60-69.\n* The most common age range for diabetes seems to be 50 to 69.","4b7b6098":"* We can say that the anaemia condition affects the death eventrate more than smoking.\n\n","a1092e53":" #      ![image.png](attachment:image.png)","363ee30e":"* The majority of the patients are between the ages of 58-62 and the group with the highest number of smoking patients.","74adc4bb":"According to the correlation table:\n* There is a strong positive correlation between age, serum creatine and death event rates. In addition, we can observe that death rates increase with the increase in serum creatine and age.\n\n* According to our dataset, Sex and smoking rates show a positive correlation between themselves. This rate shows that the number of smokers is higher in men than in women.\n","e5444b6a":"* About 35% of those who died have anaemia .\n* It has almost the same rate as smokers, in this context, perhaps a link can be established between smokers and those with anemic conditions.\n","a5e5b427":"* Mortality rates for patients aged 60 to 95.","337bb55c":"* The group in which smoking has the greatest impact on mortality rates includes the 68-72 age range.\n* Approximately 55% of smoking patients in this group seem to have lost their lives.","ceb0b0bd":"# What is the content of this study?\n\n#### This study includes visualizations of who has this diseses , how and what factors are associated with cardiovascular diseases.\n","1a79fcf5":"* Within the most common serum sodium value range 134 to 136, the most deaths occurred.","ad08825e":"* According to this table, the majority of the data set is between the ages of 58-62.","e446695b":"* According to this table, it would not be wrong to say that the increase in serum creatinine ratio affects the elderly population. So death events increase with serum creatinine","1635e29f":"* Serum_creatininie level, which is most reflected in death rates, appears to be between 0.95 and 1.04.\n\n* In addition, the serum_creatinine level of other surviving patients is mostly at this level.","e418b5b1":"* Mortality rates according to creatine phosphokinase showed a wide spread.\n* but the range with the most deaths is between 0 and 1000 cpk.","b5f255c4":"* According to this table, we can say that there is a weak positive relationship between platelets and hbp.","eb3232ef":"# ABOUT THIS DATABASE\n\n#### Cardiovascular diseases (CVDs) are the number 1 cause of death globally, taking an estimated 17.9 million lives each year, which accounts for 31% of all deaths worlwide.Heart failure is a common event caused by CVDs and this dataset contains 12 features that can be used to predict mortality by heart failure.\n\n#### Most cardiovascular diseases can be prevented by addressing behavioural risk factors such as tobacco use, unhealthy diet and obesity, physical inactivity and harmful use of alcohol using population-wide strategies.\n\n#### People with cardiovascular disease or who are at high cardiovascular risk (due to the presence of one or more risk factors such as hypertension, diabetes, hyperlipidaemia or already established disease) need early detection and management wherein a machine learning model can be of great help.\n","91415f6c":"* The correlation between smoking and non-smoking death event over time.","5e4015d7":"* There are more male in the dataset. Consequently, male death rates are higher than female death rates.","34a1e565":"* The values where the most deaths occur are the values where serum sodium is in the 24-35 range of 132-137 ejection fraction.","34f83c4d":"* The highest number of deaths is in the 0-50 time range, with a serum creatine ratio of 1 to 2, and a serum sodium range of 110 to 140.","13c2aaf8":"# Data Understanding\n\n**Age**  : Indicates the age of patient \n\n**Anemia** : 0 =NO , 1=YES ; Anemia is when the body does not have enough red blood cells.\n\n**Creatine_phosphokinase(CPK is modified version in my data)** :  Level of the CPK enzyme in the blood (mcg\/L).\n\n**Diabetes** : 0=NO ,1=YES ; Fasting blood glucose level in healthy individuals is in the range of 70-100 mg \/ dL. If the level of sugar in the blood exceeds this range, it usually indicates diabetes.\n\n**Ejection_fraction** : The percentage of blood pumping into the heart. normal is 55% and above.\n\n**High_blood_pressure(HBP is modified version in my data)** : 0=NO, 1=YES ; Whether the patient has high blood pressure or not.\n\n**Platelets** : Platelet is the name given to the cells involved in the formation of blood clots. The normal value of thrombocyte in the blood is 150 thousand between 450 thousand  in one mm3 of blood.\n\n**Serum_creatinine** : Level of Creatine produced from the kidneys in the blood.\n\n**Serum_sodium** : Level of serum creatinine in the blood. The normal range for sodium in the blood is 135-145 mEq \/ L. A situation with more than 145 millimoles of sodium in a liter of blood means that the body loses more water than it enters the body.\n\n**Sex** :  0=FEMALE , 1=MALE ; Gender of patient.\n\n**Smoking** : 0=NOT SMOKING, 1=SMOKING.\n\n**Time** : Follow up days.\n\n**Death_event** : Whether patient died during follow up period.\n\n","d3144bb0":"* The most visible range of serum sodium values 134 and 136 values"}}