{"cell_type":{"70a41e72":"code","2d6b1bf9":"code","330b6087":"code","644be4bd":"code","31df746c":"code","be1f2570":"code","66e40bb2":"code","533444df":"code","b37190eb":"code","182a9efc":"code","1bc9df88":"code","45ddcbe9":"code","c24e2aeb":"code","73b953a2":"code","1513da92":"code","3078cfb6":"code","b1277b44":"code","93a85799":"code","c18346d0":"code","e7ddf563":"code","fd343b93":"code","ab7842e9":"code","2bafb15c":"markdown","c9de37ea":"markdown"},"source":{"70a41e72":"# Gerekli import i\u015flemleri ger\u00e7ekle\u015ftirildi.\nimport pandas as pd\nimport numpy as np\nfrom mlxtend.frequent_patterns import apriori, association_rules","2d6b1bf9":"#T\u00fcm sut\u00fcnlar\u0131 ve sat\u0131rlar\u0131 g\u00f6zlemlemek i\u00e7in kulland\u0131\u011f\u0131m\u0131z kod.\npd.set_option('display.max_columns', None); pd.set_option('display.max_rows', None);","330b6087":"# Veri seti okunuldu. Veri setinde sut\u00fcnlarda de\u011fi\u015fkenler olmad\u0131\u011f\u0131 i\u00e7in names arg\u00fcman\u0131 ile de\u011fi\u015fkenlere isimler atand\u0131.\ndf = pd.read_csv('..\/input\/real-supermarket-data\/satislar.csv',names = ['BranchId', 'PosId', 'InvoiceDate', 'InvoiceNo','StockCode','Line','Quantity','CategoryCode','CategoryName'],\n                 low_memory=False,sep = \";\", header = None)","644be4bd":"# Veri setine ait ilk 5 g\u00f6zleme eri\u015fildi.\ndf.head()","31df746c":"# Veri setinin boyutuna eri\u015fildi.\ndf.shape","be1f2570":"# Veri setinde eksik g\u00f6zlem var m\u0131 sorusuna yan\u0131t al\u0131nd\u0131.\ndf.isnull().sum()","66e40bb2":"# CategoryCode ile birliktelik analizi yapmayaca\u011f\u0131z i\u00e7in silebiliriz.\ndf.dropna(subset= [\"CategoryCode\"],inplace= True)\ndf.shape","533444df":"# Veri setinde eksik g\u00f6zlem olup olmad\u0131\u011f\u0131 kontrol edildi.\ndf.isnull().sum()","b37190eb":"# Veri setinde her de\u011fi\u015fken i\u00e7in e\u015fsiz g\u00f6zlem say\u0131s\u0131 ka\u00e7 tane buna eri\u015fildi.\ndf.nunique()","182a9efc":"#hangi \u00fcr\u00fcnden ka\u00e7ar tane var?\ndf[\"CategoryName\"].value_counts().head()","1bc9df88":"# Veri setinin betimsel istatistiklerine eri\u015fim sa\u011fland\u0131.\ndf.describe().T","45ddcbe9":"# Veri setindeki CategoryName de\u011fi\u015fkeninde yer alan \u00fcr\u00fcnleri strip komutu ile ay\u0131rd\u0131k.\ndf['CategoryName'] = df['CategoryName'].str.strip(',')\ndf.head()","c24e2aeb":"#en \u00e7ok sipari\u015f edilen \u00fcr\u00fcn hangisi?\ndf.groupby(\"CategoryName\").agg({\"Quantity\":\"sum\"}).sort_values(\"Quantity\", ascending = False).head()","73b953a2":"# Veri setinde yer alan CategoryName de\u011fi\u015fkenine ait normalize ederek frekans de\u011ferleri getirilmi\u015ftir.\npd.DataFrame(df[\"CategoryName\"].value_counts(normalize=True)).head(100)","1513da92":"#Veri setinde yer alan Quantity de\u011fi\u015fkenini integera \u00e7evirmekteyiz. \ndf['Quantity'] = [x.replace(',', '.') for x in df['Quantity']]\ndf[\"Quantity\"] = df[\"Quantity\"].astype(\"float\")\ndf[\"Quantity\"] = df[\"Quantity\"].astype(\"int\")","3078cfb6":"#Veri setinin yap\u0131sal bilgilerine eri\u015fim sa\u011fland\u0131 ayn\u0131 zamanda Quantity de\u011fi\u015fkeninin integer oldu\u011funu g\u00f6zlemlemekteyiz.\ndf.info()","b1277b44":"branch_order = (df.groupby(['InvoiceNo', 'CategoryName'])['Quantity'] .sum().unstack().reset_index().fillna(0) \n          .set_index('InvoiceNo'))","93a85799":"branch_order.head()","c18346d0":"# Veri setini 1 ve 0 hale d\u00f6n\u00fc\u015ft\u00fcrme. One Hot Encoding i\u015flemi yap\u0131lm\u0131\u015ft\u0131r.\nbranch_encoded = branch_order.applymap(lambda x: 0 if x<=0 else 1) \nbasket_branch = branch_encoded ","e7ddf563":"#Apriori en yayg\u0131n kullan\u0131lan fonk olarak da bilinmektedir. Support de\u011feri i\u00e7in bir e\u015fik de\u011feri se\u00e7ilir ve support de\u011feri hesaplan\u0131r.\nfrq_items = apriori(basket_branch, min_support = 0.01, use_colnames = True)","fd343b93":"# Support i\u015fleminin ilk be\u015f g\u00f6zlem birimine eri\u015filmi\u015ftir.\nfrq_items.head()","ab7842e9":"#association_rules fonk kullan\u0131larak \"confidence ve lift\" de\u011ferlerimize eri\u015fmi\u015f olduk. Peki bu de\u011ferler neyi ifade etmektedir.\n#Support: \u00d6rne\u011fin X ve Y \u00fcr\u00fcnleri olsun. Bu ikisinin birlikte g\u00f6r\u00fclme olas\u0131l\u0131\u011f\u0131n\u0131 ifade etmektedir.\n#Confidence: \u00d6rne\u011fin X ve Y \u00fcr\u00fcnleri olsun. X'i alanlar\u0131n % \u015fu kadar\u0131 Y'yide alacaklar. Bu bize confidence de\u011ferini verecektir.\n#Lift: Bir \u00fcr\u00fcn\u00fcn al\u0131nmas\u0131 di\u011fer \u00fcr\u00fcn\u00fcn al\u0131nmas\u0131n\u0131 % ka\u00e7 artt\u0131rmaktad\u0131r. Bizlere bu bilgiyi vermektedir. \n#Bu bizim i\u00e7in ayn\u0131 zamanda final tablosudur.\nrules = association_rules(frq_items, metric =\"confidence\", min_threshold = 0.20) \nrules = rules.sort_values(['confidence', 'lift'], ascending =[False, False]) \nrules.head(50) ","2bafb15c":"# Association Rules Analysis\nBirliktelik Analizi veri i\u00e7erisindeki pattern'leri (ili\u015fkileri, yap\u0131lar\u0131) bulmak i\u00e7in kullan\u0131lan kural tabanl\u0131 bir makine \u00f6\u011frenmesi tekni\u011fidir. Bu notebook da ger\u00e7ek hayattan bir s\u00fcpermarkete ait veri seti ile birliktelik analizi ger\u00e7ekle\u015ftirilmi\u015ftir.\n\n![birliktelik%20analizi.png](attachment:birliktelik%20analizi.png)","c9de37ea":"# YORUMLAR\n**Birliktelik analizi i\u00e7in gerekli olan de\u011ferlerimizi (support, confidence, lift) hesaplad\u0131k ve buradan 3 \u00e7ift se\u00e7ilerek yorumlar yap\u0131lacakt\u0131r. Bu yorumlar i\u00e7in \u00e7iftler a\u015fa\u011f\u0131da yer almaktad\u0131r.**\n- \u0130lk olarak Kraker ve Bisk\u00fcvi \u00c7e\u015fitleri  ele al\u0131nacakt\u0131r. \n\n- Daha sonra Meyve ve Sebze ele al\u0131nacakt\u0131r. \n\n- Son olarak (Kek ve Pasta) ve Bisk\u00fcvi \u00c7e\u015fitleri ele al\u0131nacakt\u0131r. \n\n**1)     Kraker ve Bisk\u00fcvi \u00c7e\u015fitleri ele al\u0131nd\u0131\u011f\u0131nda;**\n   - Kraker ve Bisk\u00fcvi t\u00fcm al\u0131\u015fveri\u015flerin %1.13'\u00fcnde birlikte g\u00f6zlenmektedir. Yani 100 al\u0131\u015fveri\u015fin 1.13'\u00fcnde Kraker ve Bisk\u00fcvi beraber al\u0131nmaktad\u0131r.\n\n   - Kraker alan m\u00fc\u015fterilerin %53'\u00fc Bisk\u00fcvi'de almaktad\u0131r. Yani 100 ki\u015fi Kraker al\u0131yorsa 53 ki\u015fi Kraker'in yan\u0131na Bisk\u00fcvi'de almaktad\u0131r. \n\n   - Kraker olan al\u0131\u015fveri\u015flerde Bisk\u00fcvi \u00fcr\u00fcn\u00fcn sat\u0131\u015f\u0131 7,90 kat artmaktad\u0131r. \n\n**2)     Meyve ve Sebze ele al\u0131nd\u0131\u011f\u0131nda;**\n   - Meyve ve Sebze t\u00fcm al\u0131\u015fveri\u015flerin %2.11'inde birlikte g\u00f6zlenmektedir. Yani 100 al\u0131\u015fveri\u015fin 2.11'inde Meyve ve Sebze beraber al\u0131nmaktad\u0131r. \n\n   - Meyve alan m\u00fc\u015fterilerin %43'\u00fc de Sebze'de almaktad\u0131r. Yani 100 ki\u015fi Meyve al\u0131yorsa 43 ki\u015fi Meyve'nin yan\u0131na Sebze'de almaktad\u0131r. \n\n   - Meyve olan al\u0131\u015fveri\u015flerde Sebze \u00fcr\u00fcn\u00fcn sat\u0131\u015f\u0131 1,90 kat artmaktad\u0131r. \n  \n**3)     (Kek ve Pasta) ve Bisk\u00fcvi \u00c7e\u015fitleri ele al\u0131nd\u0131\u011f\u0131nda;**\n   - (Kek ve Pasta) ve Bisk\u00fcvi t\u00fcm al\u0131\u015fveri\u015flerin %1,44'\u00fcnde birlilkte g\u00f6zlenmektedir. Yani 100 al\u0131\u015fveri\u015fin 1.44'\u00fcnde (Kek ve Pasta) ve Bisk\u00fcvi beraber al\u0131nmaktad\u0131r.\n\n   - (Kek ve Pasta) alan m\u00fc\u015fterilerin %41'i Bisk\u00fcvi'de almaktad\u0131r. Yani 100 ki\u015fi (Kek ve Pasta) al\u0131yorsa 41 ki\u015fi (Kek ve Pasta)'n\u0131n yan\u0131na Bisk\u00fcvi'de almaktad\u0131r. \n\n   - (Kek ve Pasta) olan al\u0131\u015fveri\u015flerde Bisk\u00fcvi \u00fcr\u00fcn\u00fcn sat\u0131\u015f\u0131 6,10 kat artmaktad\u0131r.\n   "}}