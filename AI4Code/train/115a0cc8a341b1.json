{"cell_type":{"9cd1f916":"code","6d33117e":"code","8dec7060":"code","631dd6d4":"code","650da435":"code","4b0dffe7":"code","ff60112f":"code","50665fc4":"code","c4036adc":"markdown","a34e6cb1":"markdown","58436a75":"markdown"},"source":{"9cd1f916":"import numpy as np \nimport pandas as pd \nimport os\nfrom scipy.stats import entropy","6d33117e":"sub1 = pd.read_csv('..\/input\/average-efficientnet\/submission.csv')\nsub2 = pd.read_csv('..\/input\/classification-densenet201-efficientnetb7\/submission.csv')\nsub3 = pd.read_csv('..\/input\/tf-zoo-models-on-tpu\/submission.csv')\nsub4 = pd.read_csv('..\/input\/fork-of-plant-2020-tpu-915e9c\/submission.csv')\nsub = pd.read_csv('..\/input\/plant-pathology-2020-fgvc7\/sample_submission.csv')","8dec7060":"ent1 = entropy(sub1.loc[:,'healthy' : ], base=2, axis = 1)\nent2 = entropy(sub2.loc[:,'healthy' : ], base=2, axis = 1)\nent3 = entropy(sub3.loc[:,'healthy' : ], base=2, axis = 1)\nent4 = entropy(sub4.loc[:,'healthy' : ], base=2, axis = 1)\nentropies = np.array([ent1, ent2, ent3, ent4]).transpose()\nentropies.shape\n\nselected = np.argmin(entropies, axis = 1)","631dd6d4":"# pred1 = np.argmax(np.array(sub1.loc[:,'healthy' : ]), axis = 1)\n# pred2 = np.argmax(np.array(sub2.loc[:,'healthy' : ]), axis = 1)\n# pred3 = np.argmax(np.array(sub3.loc[:,'healthy' : ]), axis = 1)\n# pred4 = np.argmax(np.array(sub4.loc[:,'healthy' : ]), axis = 1)\n# preds = np.array([pred1, pred2, pred3, pred4], dtype=np.int32).transpose()","650da435":"# for i in range(1821):\n#     if len(set(preds[1]))>1:\n#         selected = selected_argmax[i]\n#         if selected ==0:\n#             sub.loc[i, 'healthy' : ] = sub1.loc[i, 'healthy' :]\n#         elif selected ==1:\n#             sub.loc[i, 'healthy' : ] = sub2.loc[i, 'healthy' :]\n#         elif selected == 2:\n#             sub.loc[i, 'healthy' : ] = sub3.loc[i, 'healthy' :]\n#         elif selected == 3:\n#             sub.loc[i, 'healthy' : ] = sub4.loc[i, 'healthy' :]\n    \n#     else:\n#         selected = selected_argmin[i]\n#         if selected ==0:\n#             sub.loc[i, 'healthy' : ] = sub1.loc[i, 'healthy' :]\n#         elif selected ==1:\n#             sub.loc[i, 'healthy' : ] = sub2.loc[i, 'healthy' :]\n#         elif selected == 2:\n#             sub.loc[i, 'healthy' : ] = sub3.loc[i, 'healthy' :]\n#         elif selected == 3:\n#             sub.loc[i, 'healthy' : ] = sub4.loc[i, 'healthy' :]\n        \n        \n        \n","4b0dffe7":"# sub.healthy = ( sub1.healthy + sub2.healthy + sub3.healthy + sub4.healthy)\/4\n# sub.multiple_diseases = (sub1.multiple_diseases + sub2.multiple_diseases + sub3.multiple_diseases + sub4.multiple_diseases)\/4\n# sub.rust = (sub1.rust + sub2.rust + sub3.rust + sub4.rust)\/4\n# sub.scab = (sub1.scab + sub2.scab + sub3.scab + sub4.scab)\/4","ff60112f":"submission_size = len(selected)\nfor i in range(submission_size):\n    if selected[i] ==0:\n        sub.loc[i, 'healthy' : ] = sub1.loc[i, 'healthy' :]\n    elif selected[i] ==1:\n        sub.loc[i, 'healthy' : ] = sub2.loc[i, 'healthy' :]\n    elif selected[i] == 2:\n        sub.loc[i, 'healthy' : ] = sub3.loc[i, 'healthy' :]\n    elif selected[i] == 3:\n        sub.loc[i, 'healthy' : ] = sub4.loc[i, 'healthy' :]","50665fc4":"sub.to_csv('submission.csv', index=False)","c4036adc":"# Calculate Entropies","a34e6cb1":"# Data Loading","58436a75":"## The submission files of this notebook is from [This notebook](https:\/\/www.kaggle.com\/gc1023\/ensemble-top-kernels) which has LB score of 98.1. \n\n## I tried to play with entropy. My idea was to select the probability values from based on their entropy. I tried with maximum and minimum entropy values. I got the same public score of 98.1 by selecting probability distribution with minimum entropy. What do you think of this?  \n\n## Since I am new to kaggle, your valuable opinion will be highly appreciated. \n\n"}}