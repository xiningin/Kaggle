{"cell_type":{"10fc06bf":"code","fe58e847":"code","ad7ef6c8":"code","4f5c81c4":"code","d0f16e08":"code","cbee6011":"code","098a1878":"code","de9c4800":"code","fc1b48fe":"code","365b026b":"code","db83a4d8":"code","e3e150f7":"code","bf738e9a":"code","dd0ae9c3":"code","2bca4cd1":"code","74fca760":"code","ed06dc16":"code","d290b01d":"code","94c291b4":"code","2f1475dd":"code","91a0e9bd":"code","4445c79a":"code","59a3c49f":"code","8e8c6907":"code","fe2ea4b7":"code","ce15609c":"code","d4b8435c":"code","39ad504c":"code","299e9eb6":"code","40da3c62":"code","3b3559a4":"code","09570c74":"code","b233ceee":"code","f48c79d8":"code","d91a83c8":"code","7801f107":"code","709070b5":"code","c1749fcd":"code","3e369472":"code","e451123d":"markdown","08bce2d3":"markdown","85218be2":"markdown","99351d33":"markdown","bd492a29":"markdown","4d2a9c98":"markdown","7ddbaaa5":"markdown","0ced70e5":"markdown","816fb8df":"markdown","ad73ab92":"markdown","b010c5e3":"markdown","19729c11":"markdown","ab934fce":"markdown","77171c0e":"markdown","9419ec29":"markdown","62db0b13":"markdown","5ada56d1":"markdown"},"source":{"10fc06bf":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","fe58e847":"import matplotlib.pyplot as plt\n%matplotlib inline","ad7ef6c8":"#Reading the dataset\nalexa=pd.read_csv(\"..\/input\/amazon_alexa.tsv\",sep=\"\\t\")\nalexa.head()","4f5c81c4":"alexa.info()","d0f16e08":"alexa.describe()","cbee6011":"alexa.feedback.value_counts()","098a1878":"#Percentage of people who liked and disliked Alexa.\nalexa.groupby(\"feedback\").rating.count().plot(kind=\"pie\",shadow=True, autopct='%1.1f%%',explode=(0.1,0.1));","de9c4800":"#Length of reviews given by people\nalexa[\"length\"]=alexa.verified_reviews.apply(len)\nalexa.head()","fc1b48fe":"plt.figure(figsize=(8,5))\nalexa.length.plot(kind=\"box\")","365b026b":"#Who expressed their feelings better. Either sad people or happy people?\nalexa.groupby(\"feedback\").length.mean().plot(kind=\"bar\");\nplt.title(\"Average word length by both happy and unhappy people\");","db83a4d8":"alexa.groupby(\"rating\").length.mean().plot(kind=\"bar\");\nplt.title(\"rating vs length\");","e3e150f7":"#Ratings distribution\nalexa.groupby(\"rating\").feedback.count().plot(kind=\"pie\",shadow=True,autopct='%1.1f%%',explode=(0.1,0.1,0.1,0.1,0.1))","bf738e9a":"#Positive words\ngood=alexa[alexa.feedback==1].verified_reviews.unique().tolist()\ngood=\" \".join(good)\nfrom wordcloud import WordCloud\ncv=WordCloud().generate(good)\ncv\nplt.figure(figsize=(10,8))\nplt.imshow(cv)","dd0ae9c3":"#Negative reviews\nbad=alexa[alexa.feedback==0].verified_reviews.unique().tolist()\nbad=\" \".join(bad)\nfrom wordcloud import WordCloud\ncv=WordCloud().generate(bad)\ncv\nplt.figure(figsize=(10,8))\nplt.imshow(cv)","2bca4cd1":"#Comparing both wordcloud and creating a list of words that occur in both oftenly including stopwords\ncommon=[\"Amazon\",\"device\",\"Alexa\",\"one\",\"Echo\",\"work\",\"product\"]\nfrom nltk.corpus import stopwords\nstop=stopwords.words(\"english\")\nstop.extend([\"Amazon\",\"device\",\"Alexa\",\"one\",\"Echo\",\"work\",\"product\",\"amazon\",\"alexa\",\"thing\",\"echo\",\"dot\",\"use\"])","74fca760":"#Converting to lower case\nalexa.verified_reviews=alexa.verified_reviews.str.lower()","ed06dc16":"#Removing special characters (\"[^a-z]\">> This signifies that replace everything apart from lower case alphabets with white space)\nalexa.verified_reviews=alexa.verified_reviews.str.replace(\"[^a-z]\",\" \")","d290b01d":"#split into a list\nalexa.verified_reviews=alexa.verified_reviews.str.split()","94c291b4":"alexa.verified_reviews=alexa.verified_reviews.apply(lambda x:[word for word in x if word not in stop])","2f1475dd":"alexa.verified_reviews=alexa.verified_reviews.apply(lambda x: \" \".join(word for word in x))","91a0e9bd":"#Positive words\ngood=alexa[alexa.feedback==1].verified_reviews.unique().tolist()\ngood=\" \".join(good)\nfrom wordcloud import WordCloud\ncv=WordCloud().generate(good)\ncv\nplt.figure(figsize=(10,8))\nplt.imshow(cv)","4445c79a":"#Negative reviews\nbad=alexa[alexa.feedback==0].verified_reviews.unique().tolist()\nbad=\" \".join(bad)\nfrom wordcloud import WordCloud\ncv=WordCloud().generate(bad)\ncv\nplt.figure(figsize=(10,8))\nplt.imshow(cv)","59a3c49f":"alexa.verified_reviews=alexa.verified_reviews.str.split()","8e8c6907":"#Using wordlemmatizer to remove any plural word like \"dogs\" will become \"dog\"\nfrom nltk.stem import WordNetLemmatizer\nwll=WordNetLemmatizer()\nalexa.verified_reviews=alexa.verified_reviews.apply(lambda x:[wll.lemmatize(word) for word in x])","fe2ea4b7":"#Using portstemmer to convert words to its base form\nfrom nltk.stem.porter import PorterStemmer\nps=PorterStemmer()\nalexa.verified_reviews=alexa.verified_reviews.apply(lambda x:\" \".join([ps.stem(word) for word in x]))","ce15609c":"alexa.head(10)","d4b8435c":"from sklearn.feature_extraction.text import CountVectorizer\ncv=CountVectorizer()\nX=cv.fit_transform(alexa.verified_reviews)\nX=X.toarray()","39ad504c":"y=alexa.feedback.tolist()\ny=np.asarray(y)","299e9eb6":"y.shape,X.shape","40da3c62":"from sklearn.model_selection import train_test_split\nX_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.2,random_state=0)","3b3559a4":"from sklearn.tree import DecisionTreeClassifier\ndc=DecisionTreeClassifier()\ndc.fit(X_train,y_train)","09570c74":"from sklearn.ensemble import RandomForestClassifier\nrc=RandomForestClassifier()\nrc.fit(X_train,y_train)","b233ceee":"y_pred_dc=dc.predict(X_test)","f48c79d8":"y_pred_rf=rc.predict(X_test)","d91a83c8":"from sklearn.metrics import accuracy_score\naccuracy_score_dc=accuracy_score(y_test,y_pred_dc)","7801f107":"from sklearn.metrics import accuracy_score\naccuracy_score_rf=accuracy_score(y_test,y_pred_rf)","709070b5":"from sklearn import svm\nsv=svm.SVC()\nsv.fit(X_train,y_train)\ny_pred_sv=sv.predict(X_test)","c1749fcd":"accuracy_score_sv=accuracy_score(y_test,y_pred_sv)","3e369472":"print(\"Decision Tree Accuracy=\",accuracy_score_dc)\nprint(\"Random Forest=\",accuracy_score_rf)\nprint(\"SVM accuracy=\",accuracy_score_sv)","e451123d":"Now our wordcloud look a bit better with different work, Removing irrelevant words can help in attaining great accuracy.","08bce2d3":"There are a couple of extra non alphabetic characters and numbers present in the review section. So we need to remove those undesirable characters for creating a better model. ","85218be2":"Again Creating wordcloud","99351d33":"Seems unhappy people expressed with more words","bd492a29":"**Now we can go for Sentiment Analysis using some common models like Decison tree, Random Forest and SVM and compare the accuracies**","4d2a9c98":"Now our data set seems to be ready for furthur process. Since the machine wont understand meaning of these words so we need to vectorize them.\nWe will create multiple models. \n1. Supervised learning with positive and negative reviews\n2. Unsupervised by clustering.","7ddbaaa5":"> **BUT First let's analyze some data**","0ced70e5":"This shows that feedback columns is tilted towards the positive  reviews.","816fb8df":"Now the stopwords and common word has been removed. We can keep on adding irrelevant word to stop list and run the code again for better model creation","ad73ab92":"Hmmmmmm. Seems there are a lot similar words in them. So we need to remove these prominent common words so that it becomes easier for our model","b010c5e3":"Ok so the people are happy about it","19729c11":"1. Supervised learning\n","ab934fce":"Seems Alexa is doing gud. I also should buy one","77171c0e":"Converted all words to vectors. Now we will split the data into training and test data","9419ec29":"Negative data are too less so high probability that if we go for model it may overfit. So we will try for both supervised way and unsupervised way","62db0b13":"Let us visualize some words which people use for expressing positive as well as negative reviews","5ada56d1":"Stay tuned for Unsupervised learning and leave your opinion."}}