{"cell_type":{"ad95a421":"code","cf01dc67":"code","d4704d0a":"code","c99c1168":"code","fc3401f5":"code","7d8cbfde":"code","691ec664":"code","ae3a1eb8":"code","d04fdb90":"code","613dff65":"code","b0a4ff12":"markdown"},"source":{"ad95a421":"import sys\nsys.path.append('..\/input\/pycaret\/pyod')\nsys.path.append('..\/input\/pycaret\/pycaret')\nfrom pycaret.regression import *\n\nimport pandas as pd\nimport numpy as np\n\nimport warnings\nwarnings.filterwarnings('ignore')","cf01dc67":"train = pd.read_csv('..\/input\/tabular-playground-series-jan-2022\/train.csv')\ntest = pd.read_csv('..\/input\/tabular-playground-series-jan-2022\/test.csv')","d4704d0a":"def feature_eng(df):\n    df['date'] = pd.to_datetime(df['date'])\n    df['year'] = df.date.dt.year\n    df['month'] = df.date.dt.month\n    df['week']= df['date'].dt.week\n    df['day'] = df.date.dt.day\n    df['dayofweek'] = df.date.dt.dayofweek\n    df['dayofyear'] = df['date'].dt.dayofyear\n    df.drop(columns=['date'],inplace=True)  \n\nfeature_eng(train)\nfeature_eng(test)","c99c1168":"train = pd.get_dummies(train)\ntest = pd.get_dummies(test)","fc3401f5":"reg = setup(data = train,\n            target = 'num_sold',\n            train_size = 0.75, \n            normalize = True, \n            normalize_method = 'robust', \n            transform_target = True, \n            data_split_shuffle = False, \n            feature_interaction = True, \n            silent = True, \n            fold = 5, \n            n_jobs = -1) ","7d8cbfde":"def smape(y_true, y_pred):\n    return np.mean( np.abs(y_true - y_pred) \/ (y_true + np.abs(y_pred)) * 200 )\n\nadd_metric('SMAPE', 'SMAPE', smape, greater_is_better = False)","691ec664":"lightgbm = create_model('lightgbm')","ae3a1eb8":"pred = predict_model(lightgbm, data=test)\npred.head()","d04fdb90":"submission = pd.read_csv('..\/input\/tabular-playground-series-jan-2022\/sample_submission.csv')\nsubmission.num_sold = pred.Label\nsubmission.to_csv('submission.csv', index = False)","613dff65":"submission.head()","b0a4ff12":"# TPS Jan 2022 with Light Gradient Boosting Method"}}