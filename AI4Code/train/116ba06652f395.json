{"cell_type":{"58aa564b":"code","0658cd16":"code","01064c4c":"code","4b8ccbd6":"code","91c7c406":"code","0a3c5911":"code","7eb6e899":"code","572604c0":"code","56e50a98":"code","85d25dd6":"code","9d1f93ba":"code","2a186f1b":"code","b5d22b3c":"code","3ff3ca59":"code","ddf3d470":"code","036d168f":"code","51e6ff8f":"code","94097bc3":"markdown","0d822baf":"markdown","a02ade71":"markdown","bde9d1b0":"markdown","0700d837":"markdown","c0ead704":"markdown","a66532e4":"markdown","fff7aa3f":"markdown","438e603b":"markdown"},"source":{"58aa564b":"# importing the essential Libraries\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sb\nimport tensorflow as tf\n\n# loading data\ndataFrame = pd.read_csv('\/kaggle\/input\/superconductor-dataset\/train.csv')\n\n#doing a sanity check\ndataFrame[0:10]","0658cd16":"plt.style.use('ggplot')\nplt.figure(figsize = (50, 50))\nsb.heatmap(dataFrame.corr(), annot= True)\nplt.show()","01064c4c":"# lets try to visualize range of tc, it's distribution and outliers\nsb.displot(data = dataFrame, x = 'critical_temp')\nsb.displot(data = dataFrame, x = 'critical_temp', kind = 'kde')\n\n","4b8ccbd6":"# plotting scatter plot for sample's Temperature\nplt.style.use('ggplot')\nplt.figure(figsize = (10, 7))\nplt.scatter(dataFrame.index, dataFrame['critical_temp'], color = 'green')\nplt.title('Scatter Plot for Sample Temperature')\nplt.show()","91c7c406":"featuresNeeded = dataFrame.columns[: -1]\n\nfeatures = np.array (dataFrame[featuresNeeded])\ntargets =  np.array(dataFrame['critical_temp'])\n\n# let standardize our feature Vector First for PCA and futher usage\nfrom sklearn.preprocessing import StandardScaler\nstdc = StandardScaler()\nfeatures = stdc.fit_transform(features)\n\nfrom sklearn.decomposition import PCA\npca = PCA(n_components = 2)\npca.fit(features)\ndimReducedFrame = pca.transform(features)","0a3c5911":"# converting to dataFrame and Plotting\ndimReducedFrame = pd.DataFrame(dimReducedFrame)\ndimReducedFrame = dimReducedFrame.rename(columns = {0: 'V1', 1 : 'V2'})\ndimReducedFrame['critical_temp'] = targets\n\n# Plotting\nplt.figure(figsize = (10, 7))\nsb.scatterplot(data = dimReducedFrame, x = 'V1', y = 'V2', hue = 'critical_temp')\nplt.grid(True)\nplt.show()","7eb6e899":"plt.figure(figsize = (15, 5))\nplt.subplot(1, 2, 1)\nsb.regplot(data = dimReducedFrame, x = 'V1', y = 'critical_temp' , color = 'green')\nplt.title('Relation of Tc with 1st Principal Compnent')\n\nplt.subplot(1, 2, 2)\nsb.regplot(data = dimReducedFrame, x = 'V2', y = 'critical_temp' , color = 'green')\nplt.title('Relation of Tc with 2nd  Principal Compnent')\n\n\nplt.show()","572604c0":"# Running some Pandas Queries \n\nl0 = len (dataFrame[ (dataFrame['critical_temp'] >= 0) & \n                     (dataFrame['critical_temp'] <= 49)\n                   ]\n         )\n\nprint ('Number of samples with Tc in range 0 K- 49 K:   {}'.format(l0))\n\n\nl1 = len (dataFrame[ (dataFrame['critical_temp'] >= 50) & \n                     (dataFrame['critical_temp'] <= 100)\n                   ]\n         )\n\nprint ('Number of samples with Tc in range 50 K- 100 K:   {}'.format(l1))\n\n\nl2 = len (dataFrame[ (dataFrame['critical_temp'] >= 101) & \n                     (dataFrame['critical_temp'] <= 140)\n                   ]\n         )\n\nprint ('Number of samples with Tc in range 101 K- 140 K:   {}'.format(l2))\n\n\nl3 = len (dataFrame[ (dataFrame['critical_temp'] >= 140) & \n                     (dataFrame['critical_temp'] <= 150)\n                   ]\n         )\n\nprint ('Number of samples with Tc in range 141 K- 150 K:   {}'.format(l3))\n\nl4 = len (dataFrame[ (dataFrame['critical_temp'] >= 151)])\n\nprint ('Number of samples with Tc greater than 150K: {}'.format(l4))\n","56e50a98":"# normalizing our targets\nmaxTc = max(targets)\ntargets = targets\/1\n\n# splitting data into train and test frame\nfrom sklearn.model_selection import train_test_split\nxTrain, xTest, yTrain, yTest = train_test_split(features, targets, test_size = 0.2, random_state = 42)\n","85d25dd6":"# writting Function to visualize our models performance\nfrom sklearn.metrics import mean_squared_error as mse\ndef PerformanceCalculator(trueVals, predVals, name):\n    plt.plot([0,0.001,0.01,1], [0,0.001,0.01,1], color = 'blue')\n    plt.scatter(trueVals, predVals, color = 'green')\n    er = mse(trueVals, predVals)\n    er = pow(er, 0.5)\n    er = int(er * 10000) \/ 10000\n    plt.title('RMSE: ' + str(er) + ' for '+ name)\n    plt.show()\n    \n    ","9d1f93ba":"# lets start our Analysis with linear regression\nfrom sklearn.linear_model import LinearRegression\nlr = LinearRegression()\nlr.fit(xTrain, yTrain)\n\npredictions = lr.predict(xTest)\nPerformanceCalculator(yTest, predictions, 'Linear Regression')","2a186f1b":"# lets do one better by using a decission Tree\nfrom sklearn.tree import DecisionTreeRegressor\nlr = DecisionTreeRegressor()\nlr.fit(xTrain, yTrain)\n\npredictions = lr.predict(xTest)\nPerformanceCalculator(yTest, predictions, 'Decission Tree Regressor')","b5d22b3c":"# Decission Tree looks an improvement over linear regression\n# observe alot more samples are now along y = x line which is a good sign\n# lets Try gradient Boosting Regressor\nfrom sklearn.ensemble import GradientBoostingRegressor\nlr = GradientBoostingRegressor()\n\nlr.fit(xTrain, yTrain)\n\npredictions = lr.predict(xTest)\nPerformanceCalculator(yTest, predictions, 'Gradient Boosting Regressor')","3ff3ca59":"# lets try Random Forest\nfrom sklearn.ensemble import RandomForestRegressor\n\nlr1 = RandomForestRegressor()\nlr1.fit(xTrain, yTrain)\n\npredictions = lr1.predict(xTest)\nPerformanceCalculator(yTest, predictions, 'Random Forest Regressor')","ddf3d470":"# Let's try bagging classifier\nfrom sklearn.ensemble import BaggingRegressor\nlr = BaggingRegressor()\n\n#lr = RandomForestRegressor()\nlr.fit(xTrain, yTrain)\n\npredictions = lr.predict(xTest)\nPerformanceCalculator(yTest, predictions, 'Bagging Regressor')","036d168f":"# lets try essembling\npred1 = lr1.predict(xTest)\npred2 = lr.predict(xTest)\npredictions = (pred1 + pred2)\/ 2\n\nPerformanceCalculator(yTest, predictions, '(Random Forest + Bagging)')","51e6ff8f":"ylab = yTest\npredVals = lr1.predict(xTest)\n\ndiff = abs(ylab - predVals)\nansFrame = {\n    'True Tc' :  ylab,\n    'Predicted Tc': predVals,\n    'Absolute error': diff\n}\n\nansFrame = pd.DataFrame(ansFrame)\nansFrame[0:20]","94097bc3":"# 2D visualization of dataset using Dimentionality Reduction\n","0d822baf":"Thanks for Reading...","a02ade71":"# Inference from distributions\nFrom the above distribution Plot we can infer:\n* A majority of the samples in our data set has very low Tc (14855 samples to be precise).\n* 5611 samples have Tc between 50K - 100K .\n* 760 samples have Tc between 101K - 140 K.\n* 2 samples have Tc between 141K - 150K.\n* only 1 sample has Tc greater than 150K.","bde9d1b0":"# Introduction\n![](data:image\/jpeg;base64,\/9j\/4AAQSkZJRgABAQAAAQABAAD\/2wCEAAkGBxISEhUSEhIVFRUVFhUXFRUVFRUYFRUVFRUWFhUVFRUYHSggGBolHRUVITEhJSkrLi4uFx8zODMtNygtLisBCgoKDg0OFQ8PFysdFR0tLS0tLS0rKysrKy0rKystLS0tLS0tLS0tLSstLSstLSstKy0tLS0tLS0tLS0tLS0rLf\/AABEIAKgBLAMBIgACEQEDEQH\/xAAcAAACAwEBAQEAAAAAAAAAAAADBAECBQAGBwj\/xAA+EAACAQIDBAcFBQcFAQEAAAAAAQIDEQQhMUFRYXEFEoGRocHwBhOx0eEUFSKS8TJCQ1JTcqIWI4LC0jMH\/8QAGAEBAQEBAQAAAAAAAAAAAAAAAgEAAwT\/xAAfEQEBAQEBAAICAwAAAAAAAAAAARESAgMTMVEhQWH\/2gAMAwEAAhEDEQA\/APjaLxBovEYDwYeAtFh4MUE1TY3TYlTY1TY4B6kx2izPpMcpMcGtOjI0KEjLoMfoscc61KEjQoTMqhIfoyOkCtajMcpSMujMdpTFArQhIPCQlTmHjIQm1IupC0ZF1ImLo3WOcgXWIciY2rykDlIrKYKUhYmunIWqyLzkK1ZkqyA1piFeYxWmIVpBpQtWkZ9aQ1XkIVmc66QrXkIVmNVmI1WCnC1ZidVjFVilVgpwvUYvNhqjATBTgM2CYSbBSIQbIJZBFSi8QZeJmGiGgBgFixiYgxmmxSDGabLBp2kxykxCkxuixwK0KMh+jMzKQ9QHArToyH6MzLpSHKMhwK1aMx2lMy6T4jdKYhrTpzGITM+nMapXeib5C0TkZFlIWTYRSLo4N1iHIH1iHI2su5ApyIlIFORNZE5CtWRepIVqzIQNViVZh60xGtUYaUL1mIVpDNWoJVZgpwtWYjWHakhKrIFOFZq4lVY5UYlXBThaowE2FmwM2GnApsHIvJg5BKBsgllSKsi8WDRZMrDJhYMBELFlExBjFNi0BqmKDTNIdpIRhIPTYoNaVOfEbo1DMpMdpOw4FjTpSG6UzMoyHKTFBadKY5SqmXSkOUpDgVp06ojPpCpGblGTSTeWyy4BYzshCbzzOfyX8L8cegwXtH1n+NJPfnb6GzCtCa6ysm1rfI8HvHeja04SXVlbetljjp3xHq6zsrdXPW6t6Rzgmrpq2el9i2mLU6WrZ5rVpOy09fALDpuo0\/wxTtnqu3IXVHmNHqJu2j7AFSm9dm8WXT6y\/wBtNbeeuV0Mrpum1nB5W0t2CnyUb4JVZClWQ\/VxtGprGUW9qSXJtaGVimk2lLrLer\/BnSe5U5sArTEqsw1WoJ1Zo1WAVZClVh6khWow04WqyYpVYxVYnWkClAajFqgSpIXlIJwGrEVmNyYvVQaUpZg5BJsEwnFWQSyoVWsSiIsuoixloBYg4xCwV9hRo9JjdODFEuqHpVmKBf8ADUIMao03uYmqgzSYoNPUk1+6ximxWnN72NUqj3ijmbpyGqTE4y4IapSW1CSnqchmncSh1d7HKbyyYgpiMmBqZjVGm3fkDqUHdZanP3+XTxSryH8MrbOOXLMo6a0sMU8r8jnhWuq2SWubvbc95brKT42ts2hYxXV\/EtnEX6ivKz5Lb2FAadNWyKdVJZethMLpW435FakMiopGF9V3bNwtj8pW7x7CxyfP15GdipJyfd3ZD8paTqzFKjD1mLVZiWAzFKsg1SdxOsw0gqjFqoSpIWlMFKA1RWY1KQvUiE4EwFUO07AKu4iwpMGwk1YG0F0irIJsd1SYrglOVgKLRLGw6qitoT7zcgFNhlEQYLTkMQjfTuFo5DNKRYNEghuhOwJWavtJhJFGn4NbxijUsIwYxSY4DQhK4zTE6KG4xewQ03TsNRjuE6XIfpp2zyKJ7o9ZSfIdoSyz8RTAr8DW2+nZk+Q0o2Ofr8rBJ4bJNcyVTa7cvAaguJyp556BWl5v8Oejy5cBRytZ6PXv9MbxKa7dgFpO18ipFYxVr6LL0yZO\/rI6bsrLT4FU7Z633+fYZhaLSi77b+BgVaj7zYxsurTfJeL39rMGch+RBrSE6khiohSsUoWq1BaTCzAyTDTCnK4tVYeaAthqwrJFQlQHJkNFSotBOa2lqzYFBJ1XMWaCzkAkyFHMqzrkqRCcoloolQLxhvMmugGplYtBIlC0SEQsURIJFCEalkXggdNBUtxRpimO0YITo0m2aFKmlxEJrD0Xb5jEY7iMLJtDdGlmWVFqEWmadF3WeoCEEHjyKmLSg4tNZPYzQwmIjJWeUuOj5AYRbViqw5kxrUbrYNVIXvsM\/C4vqWUl1ktu36j0OkKbX7y7EHEpapT3gKlKy3XT+Y9UxlLR3e7IWniKUrXk+VmbE0lKm1awRQTfPLhxYeWLpLV2vwYBY6gnfreDfkbG0j05UySW1\/BfUx3wHuka6nO8b9VZK+3PUUlJbPEcUrOVgFaCYepLgL1iFCUkBqIdcbX4ieIhuJVKTzAVkMxiyKlK619cAlCDyA1t4XEIVcthCgU2VehaSsCqS2EIKpEBKIxIo4hw5SzOCyRTqEwtMda2hMc9QkqFmFp0r7CueqRpho07BadHgO0sJfZoUdK0qdxiOHSWY2sOlqd7rcUbSvU2JDFGiMU8LtGoUrLMqaFRp20GoQz0D4bDuSuotra0m14Gph+hK8l1o0Kr3fglZ8nYo6Tw8B6lFLNsYo+z+Kl\/An2qy8R3D+zGKa\/+Vv7pRXmVNhSkopby7rxRq4b2TxL1jCPOa7\/w3GF7H1nq6S\/5S\/8AJU1kU662DKxDtx3mpT9j6u2dNdsn\/wBQv+k6uiqQtv8AxX7reZtiayPfX1tzSBzk9xvQ9k53zqxtwi34XCR9lpf1Y\/kfzNsbXm1UdsxSpWvyPVVvY9tq1ZW2\/gd+64JexT\/rq39j\/wDRdia87CSazYjiINPXI9dP2JnsrR7Yv5g6nsZVat72n\/l36G2M8a5FG1vPWVPYSvbKtTb3NSS77eQvP2HxC0lSf\/KSfc4m1tjzdaPMVmm2ev8A9G4q38N8Ou8u9WAf6RxSz92nynDv1Mux5edIXqx3LU9VW9lsWv4L7JQf\/YzqvQGJhG8qFRcVFv4EXqPNOL8BOcJJnoqvRdZWvRqLPJuEs+WRnYiKzi1a3eTF1j1L3FKsFfQ2JUgVTDXzWpMKVkqnfK\/IWlSa2GrLDbSK2H2raTC6Y8oFGh+dHgUdMmHpRWepKoxe8NKkQoGbTlKjfUaoYdtqMU23kkldt7rI+q4D2OwdKz925vfUfW\/xVl4HoMPTjFKMIqMd0Ukl2IU8OF+X9R8r6L9kcVOz9w0t82o+Dd\/A9Pg\/YWq7dedOK1y60nytZLxPZqXrzDxqWFzHP7PTzFL2Cpfv1Zv+2MY+LuO4X2Mwcf2oSn\/fN5dkLG7734F41C4N9X9s+l7NYRJWw8Hbem++7zNKjg6cLONOEWtHGEU0t10iVMs5dpR0WLLOfMUlV7H8fqCnNv5eaIx6VW21EPEL1n8DPc2t9gcpfR38DFjQ+3L5\/oRPpC2zzyMybBSqELGrU6S7uRT70trYx1PeDnMi416nS0vVrA5dLy3+T+RiTkDVXvK3Le++Hz+BH3xJ7fAwnUKRqWZG5ehfTD3pdhD6ae74\/MwpVuJEau3abW5j0P3vnnp4\/Iv98cPI846zCxru2RdS+Xo4dKJ7PALHHLVo83Gq9\/PPVhoTfZ8e8o2PQrFp+si8ayef6GDCb235X9WDwqvZ46d3mZMasZbblK1GM1aSjLg0nfncTjLi3y0D06naUf4J1uhsNLKWHpPf\/tx2ckZ1X2SwTafuUrfyynFdyeZ6CYJrPYZNs\/t5LE+wWFecZVYcFKMlzzi34mdiP\/z3K0K9+E4W8U\/I92yjZshT36\/b5VjvYPFxV1GE+EJ590kr9hhYroOvTv7yjOPFxdu\/Q+4sG3mHmOk+Wvz66JZYU+24\/ofD13epRhJ6da1pfmjmY9X2Kwsnde8gt0ZJr\/JN+JuXT7Xo4vu4l1l+nzAQkr8WtCYz3arYVyw1BZF1bJPvF3U2LtSzJ9672vfsMmG4vc\/qXUtwk527dgRVFbzva3Mo2H4TW3IlysIqd1rnw\/QvCrtyXD0ipyNObBt8beZbrp6oiUFx9cyNArteviikmg8o7mCcFfO3riiHKFNAZQ4DigtLrtYRUF\/MiFrKlF225C8kz0EcLEh4GL2GxO48zUTb0YNxZ6j7FDcS8HD+UuJ9keXSJ6vA9P8AY4bIon7JDcTlfsjy04lcz1LwcNyBvo+Gtl2G5b7I844tbC0b21+Zvz6PhtRH2GFthsbuMmnFB1xfmNywS\/mXLIpLCSWjXeXE6CvyXDdzCRhtz+YSnhpLW3N28w0cPxXZ9WUL\/KlOO+73a5jtFLSxWKSVsy6yz2G1sqWBlK\/AmpN\/LUDLbftM2LdZaFWQ5b8iIyRlxEnuBzkFl6\/QE422mXFGictvmEpxSJ6tyauPPxxV7XS7JJDMKz26czxlPFXbbzS0W9jX3hlm+zRHPXo4exVbjlvLQmnpot31PJUOlWlrb+3LLixql0zZ36ysubf1L0P116aE7t\/N+YSnLPhs\/RnnvvWL0avrdpX5XvkOU+mIKOfdG1\/iXRvitdVE75pPl8blqcm1klbn9DIXSVPqptys+Lv8Q0ek4O3V8bl1Oa0vf9XK9+S+QXr3M+OIe29u\/wBdxaFaLzz5Zp\/U2jhlvWz9dgOdTt9bwFTGLfbg7ZgI4hb3yvfyJpSGauIeywpKq9rsCnNXyfgBqT4\/MhyLyrtbXcBOu977ys5bcxeUwnIZeKntlLvZeGOqL9+WeubM\/rndc2rzD0ekKl\/25fmZf7wqr+JL8zM5TO94bU5n6P8A26f9SX5mR9vqf1J\/mYip3ONrcw\/9ob1bfFsPSxFtpnRuGXFlSxq08Vd6vyY3SrX087+JjU6i+thmFXlzzLKFjWjU4vt+qLvEO2eXh3Gaq7eq7bfJl1X2ZLmn5i1zvk\/SrX25d5d1M\/SQn763HkvNFViHnkr7svFouphyU93f8inXz+PpCTrPVpR5vL4FZY2Cy8U8u82rydk87537yvX4eT7hCpj9zXD1mAnjnpt9bdpNblp+8u3s7ikqm137zJ+1ZtZZrdZgauKfrdwNq8tiWJj2+t5McYY8q99Hou\/sLwrZfDkVHgo1bJXet8uZSdV5erWOOOFr24meLeS3BFi0tDjiauJWKk9WFhitzOONrYNDpSSy7wi6Re15\/DkScXUwzR6alpe\/F5\/ENHpTi0+D8iThDfMSul7bW297y7i8ul21qr8kccZuY6jj3L9p5cSJY93yaSOOM2RSeP7eZV42PI44hSKPGRbI+1q+pxxFwR4hbyFXVtTjipiI4k547fc44i5BqeOinqEn0mll+jOOEHMTDpC91kuRE8e47briccZMjp9Kfh\/C7cFcGulb2TuzjjLzBX0pJO3Wy3MvQ6RvdXOOLBvmYXj0h+JqT1yDQrKScb+kccWB6BjXs+q\/05EPEvVv9n4HHFQb7Ur9ZPRELEx6yXHLk0ccUbFuq1K8XldLv2DMLW1SOOKNj\/\/Z)\n\nA superconductor is a substance that conducts electricity without resistance when it becomes colder than a \"critical temperature. The intention of this Notebook is do an Expolatory Data Analysis on the given data and:\n* Find the factors the affects Tc.\n* Visualizing the given data in 2D in space using PCA.\n* Develope and compare Various models for predicting Tc.","0700d837":"# True values, Predicted values, errors for Random Forest","c0ead704":"Since All of our features numeric lets check the correlation of various parameters with Tc","a66532e4":"# Inference from Correlation Plot\nFrom the above heatmap we can see Tc has **High Positive Correlation**  with the following features:\n* Number of Elements           (0.60)\n* Entropy_atomic_mass          (0.54)\n* wtd_entropy_atomic mass      (0.63)\n* range_atomic_mass            (0.49)\n* entropy_fie                  (0.57)\n* range_fie                    (0.6)\n* std_fie                      (0.54)\n* wtd_std_fie                  (0.58)\n* entropy_atomic_radius        (0.56)\n* wtd_entropy_atomic_radius    (0.6)\n* range_atomic_radius          (0.65)\n* std_atomic_radius            (0.56)\n* wtd_std_atomic_radius        (0.60)\n* entropy_fusion_heat          (0.55)\n* wtd_entropy_fusion_heat      (0.56)\n* range_thermal_conductivity   (0.69)\n* std_thermal_conductivity     (0.65)\n* wtd_std_thermal_conductivty  (0.72)\n* entropy_valence              (0.56)\n* wtd_entropy_valence          (0.6)\n\nAnd with Following features Tc has **Strong negative Correlation** :\n* gmean_density     (-0.54)\n* wtd_gmean_density (-0.54)\n* mean_valence      (-0.60)\n* wtd_mean_valence  (-0.63)\n* gmean_valence     (-0.57)\n* wtd_gmean_valence (-0.62)\n\n\nCommentary: This dataset is highly correlated we might not be having any major problems developing a model for this data!","fff7aa3f":"# Developing Models & Usual sklearn stuff..","438e603b":"Inference: This looks like Sample with higher Tc values tends to have low values for V1 (first principal component) and V2 (second principal component) with exceptions. Let's check this infernce with regplots."}}