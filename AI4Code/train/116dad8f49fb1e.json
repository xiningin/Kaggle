{"cell_type":{"24bcad5c":"code","634ebdd2":"code","3a23c095":"code","de5b9d4c":"code","04a8befd":"code","6b2dc141":"code","6ea08b10":"code","df599fc8":"code","fa7f6a64":"code","3e3498f8":"code","38ba003d":"code","b5d5d6d0":"code","5a44ff89":"markdown","41e8f522":"markdown","53631786":"markdown","6c8726ee":"markdown","b4924490":"markdown","e0ed0ffc":"markdown","be41f638":"markdown","84d26e67":"markdown","cfa9104c":"markdown","7e680044":"markdown","5341a9a2":"markdown","b034bf37":"markdown"},"source":{"24bcad5c":"import os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","634ebdd2":"import pandas as pd","3a23c095":"data_df = pd.read_csv(\"\/kaggle\/input\/unmet-needs-for-medical-examination-in-europe\/hlth_silc_14.tsv\", sep='\\t')","de5b9d4c":"print(list(data_df.columns))","04a8befd":"pivot_data_col = data_df.columns[0]\ntime_columns = data_df.columns[1:]","6b2dc141":"data_df['unit'] = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[0])\ndata_df['isced11'] = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[1])\ndata_df['age'] = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[2])\ndata_df['sex']     = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[3])\ndata_df['reason'] = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[4])\ndata_df['geography'] = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[5])","6ea08b10":"selected_columns = list(['unit', 'isced11', 'age', 'sex', 'reason', 'geography']) +  list(time_columns)\ndata_df = data_df[selected_columns]","df599fc8":"data_tr_df = data_df.melt(id_vars=['unit', 'isced11', 'age', 'sex', 'reason', 'geography'], \n        var_name=\"date\", \n        value_name=\"value\")\ndata_tr_df['date'] = data_tr_df['date'].apply(lambda x: int(x))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"b\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"bp\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"c\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"d\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"e\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"n\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"p\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"u\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"z\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\": \", \"NAN\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: float(x))","fa7f6a64":"print(f\"Transformed data shape: {data_tr_df.shape} (rows\/columns)\")\ndata_tr_df.head()","3e3498f8":"data_tr_df.tail()","38ba003d":"import pandas_profiling\npandas_profiling.ProfileReport(data_tr_df)","b5d5d6d0":"data_tr_df.to_csv(\"unmet_needs_for_medical_exam.csv\", index=False)","5a44ff89":"# Export data in csv format","41e8f522":"We select now only the new columns resulted from splitting the `pivot_data_col` and the time columns.","53631786":"Then, we split from `pivot_data_col` the 6 separate fields:\n* unit;\n* isced11 - ISCED-11 education attainment level classification;\n* age (this is age group actually);\n* sex;\n* reason (this is the reason of unmet medical examination needs, according to own declaration);\n* geography (countries and Euro country groups).","6c8726ee":"Next, we pivot the time columns using `melt` operation in pandas.  \nWe also make sure we transform `date` to be an integer (here is a year data).  \nWe set `value` to be a float, after we replace \": \" (for N\/A) with `NAN`.","b4924490":"## Load the data\n\nThe datafiles are in TSV format. We will read the files using pandas, just include in the function call the `sep` (tab separator data).\nWe demonstrate first how to read and process the Annual data.","e0ed0ffc":"\/kaggle\/input\/unmet-needs-for-medical-exami# Data pre-processing\n\nWe start by defining two working lists.","be41f638":"# Introduction\n\nWe show in this Kernel how we can process the data to prepare it for easier processing. Let's check the data files.","84d26e67":"Let's glimpse the data columns.","cfa9104c":"# Analysis preparation\n\n## Load packages","7e680044":"# A very preliminary exploratory data analysis\n\nThis would be a very short exploratory data analysis. The role of this Kernel is just to show how we can prepare the annual data for analysis and we already did this.","5341a9a2":"The first column is a composed one, containing 5 different information (unit, sex, age, isced-11 education attainment levels classification and geography). The next columns are the year value, from last (2020) to first (1983).","b034bf37":"Let's inspect the result."}}