{"cell_type":{"7379f75c":"code","ac3dce00":"code","62be98d6":"code","68290cd1":"code","a78fa052":"code","a246287d":"code","436908bb":"code","bc7ff312":"code","d8717ed7":"code","6fe4fb8f":"code","776a13d5":"code","0152e820":"code","38651649":"code","57191eee":"code","72a90546":"code","e56127e4":"code","764b07f6":"code","233fb5c4":"code","f314d90b":"code","65348e4d":"code","0b44c4dc":"code","2dc4976c":"code","39c6a520":"code","78360d4b":"code","2f334a79":"code","b4aa1104":"code","f122011e":"code","de3c14ee":"markdown","ec0665c7":"markdown","3d3fc792":"markdown","5d01a9a3":"markdown","de9fca81":"markdown","7e4239df":"markdown","03186d46":"markdown","20eb94e1":"markdown","d68d76b0":"markdown","ea0be541":"markdown","0c0011bb":"markdown","4f9884fc":"markdown"},"source":{"7379f75c":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\nimport warnings\nwarnings.filterwarnings('ignore')","ac3dce00":"districts_data=pd.read_csv(\"..\/input\/learnplatform-covid19-impact-on-digital-learning\/districts_info.csv\")\ndistricts_data.head()","62be98d6":"def count_values(df, col_name):\n    # Calculate value counts and percentage of a numeric column\n    series = pd.DataFrame(df[col_name].value_counts())\n    series['percentage'] = (series[col_name]\/df[col_name].value_counts().sum())*100\n    series.reset_index(inplace=True)\n    series.columns = [col_name, 'count', 'percentage']\n\n    return series","68290cd1":"def plotbar_horizontal(series, value_col, label_col, percentage_col, title, palette = None,  color = 'gray', percentage_text = True,\n                        xlabel_text = \"\", ylabel_text = \"\", figsize = (12,10), barwidth=0.5, pctlcnadjust=1):\n    # ------------------------------------------------------------------ #\n    # Horizontal bar graph\n    # ------------------------------------------------------------------ #\n\n    fig = plt.figure(figsize=figsize)\n    gs = fig.add_gridspec(1, 1)\n    ax = fig.add_subplot(gs[0, 0])\n\n    # Remove some axis lines\n    for s in [\"right\", \"top\",\"left\", \"bottom\"]:\n        ax.spines[s].set_visible(False)\n\n    n_unique = series.shape[0]\n    value = series[value_col]\n    label = series[label_col]\n\n    ax_sns = sns.barplot(ax=ax, x=label, y=value, color=color, palette=palette)\n\n    # Customize\/Remove ticks\n    ax.tick_params(axis = \"y\", which = \"both\", left = False, labelcolor='gray')\n    ax.tick_params(width=0, length=0)\n    ax.set_xticklabels(label, rotation=90)\n    # Customize\/Remove labels\n    ax.set_ylabel(xlabel_text,color='lightgray')    \n    ax.set_xlabel(ylabel_text,color='lightgray')\n\n    plt.title(title, fontsize=14, weight='bold', color=\"gray\")\n\n    # Change bar width\n    def change_width_horizontal(ax, new_value):\n        for patch in ax.patches :\n            current_width = patch.get_width()\n            diff = current_width - new_value\n\n            # we change the bar width\n            patch.set_width(new_value)\n\n            # we recenter the bar\n            patch.set_x(patch.get_x() + diff * .5)\n\n    change_width_horizontal(ax, .5)\n\n    if percentage_text:\n        for p, percentage in zip(ax.patches, series[percentage_col]):\n            label_1 = \"%.0f%%\" %percentage\n            x = p.get_x() + p.get_width() \/ 2\n            y = p.get_height() + pctlcnadjust\n            ax.text(x, y, label_1, ha='center', va='center', color='gray', fontsize=8)\n\n    plt.show()","a78fa052":"col_name = 'state'\nstate_series = count_values(districts_data, col_name)\nstate_series","a246287d":"value_col = 'count'\nlabel_col = 'state'\npercentage_col = 'percentage'\nxlabel_text = \"Number of rows\"\nylabel_text = ''\ntitle = 'Percentage of Districts from each State in the data'\nfigsize = (12,10)\npctlcnadjust = 0.8\npalette = None\ncolor = 'gray'\npercentage_text = True\nbarwidth = 0.5\n\nplotbar_horizontal(state_series, value_col, label_col, percentage_col, title, palette = palette,  color = color, percentage_text = percentage_text,\n                   xlabel_text = xlabel_text, ylabel_text = ylabel_text, figsize = figsize, barwidth = barwidth, pctlcnadjust = pctlcnadjust)","436908bb":"def plotbar_vertical(series, value_col, label_col, percentage_col, title, palette = None,  color = 'gray', percentage_text = True,\n                    xlabel_text = \"\", ylabel_text = \"\", figsize = (12,10), barwidth=0.5, pctlcnadjust=1):\n    # ------------------------------------------------------------------ #\n    # Vertical bar graph\n    # ------------------------------------------------------------------ #\n\n    fig = plt.figure(figsize=figsize)\n    gs = fig.add_gridspec(1, 1)\n    ax = fig.add_subplot(gs[0, 0])\n\n    # Remove some axis lines\n    for s in [\"right\", \"top\",\"left\", \"bottom\"]:\n        ax.spines[s].set_visible(False)\n\n    n_unique = series.shape[0]\n    value = series[value_col]\n    label = series[label_col]\n\n    ax_sns = sns.barplot(ax=ax, x=value, y=label, color=color, palette=palette)\n\n    # Customize\/Remove ticks\n    ax.tick_params(axis = \"x\", which = \"both\", left = False, labelcolor='gray')\n    ax.tick_params(width=0, length=0)\n    ax.set_xticklabels([]) # remove x tick label\n    # Customize\/Remove labels\n    ax.set_ylabel(xlabel_text,color='lightgray')    \n    ax.set_xlabel(ylabel_text,color='lightgray')\n\n    plt.title(title, fontsize=14, weight='bold', color=\"gray\")\n\n    # Change bar width for vertical plot\n    def change_width_vertical(ax, new_value) :\n        for patch in ax.patches :\n            current_width = patch.get_height()\n            diff = current_width - new_value\n\n            # we change the bar width\n            patch.set_height(new_value)\n\n            # we recenter the bar\n            patch.set_y(patch.get_y() + diff * .5)\n\n    change_width_vertical(ax, barwidth)\n\n    if percentage_text:\n        for p, percentage in zip(ax.patches, series[percentage_col]):\n            label_1 = \"%.0f%%\" %percentage\n            y = p.get_y() + p.get_height() \/ 2\n            x = p.get_width() + pctlcnadjust\n            ax.text(x, y, label_1, ha='center', va='center', color='gray', fontsize=10)\n\n    plt.show()","bc7ff312":"col_name = 'locale'\nlocale_series = count_values(districts_data, col_name)\nlocale_series","d8717ed7":"value_col = 'count'\nlabel_col = 'locale'\npercentage_col = 'percentage'\npalette = [\"darkred\" if x=='Suburb' else 'gray' for x in locale_series['locale']]\ncolor = 'gray'\npercentage_text = True\nxlabel_text = \"\"\nylabel_text = ''\ntitle = 'Distribution of locale in the data'\nfigsize = (8,6)\nbarwidth = 0.3\npctlcnadjust = 5\n\nplotbar_vertical(locale_series, value_col, label_col, percentage_col, title, palette = palette,  color = color, percentage_text = True,\n                 xlabel_text = xlabel_text, ylabel_text = ylabel_text, figsize = figsize, barwidth=barwidth, pctlcnadjust=pctlcnadjust)","6fe4fb8f":"col_name = 'pct_black\/hispanic'\npopulation_series = count_values(districts_data, col_name)\n\nranges = {\"[0, 0.2[\" : \"0-20%\",\n         \"[0.2, 0.4[\" : \"20-40%\",\n         \"[0.4, 0.6[\" : \"40-60%\",\n         \"[0.6, 0.8[\" : \"60-80%\",\n         \"[0.8, 1[\" : \"80-100%\"}\n\npopulation_series[\"Balck\/Hispanic_population\"] = population_series[\"pct_black\/hispanic\"].map(ranges)\n\npopulation_series","776a13d5":"value_col = 'count'\nlabel_col = 'Balck\/Hispanic_population'\npercentage_col = 'percentage'\npalette = [\"darkred\" if x=='0-20%' else 'gray' for x in population_series['Balck\/Hispanic_population']]\ncolor = 'gray'\npercentage_text = True\nxlabel_text = \"\"\nylabel_text = ''\ntitle = 'Distribution of Black\/Hispanic population in the districts'\nfigsize = (8,6)\nbarwidth = 0.4\npctlcnadjust = 5\n\nplotbar_vertical(population_series, value_col, label_col, percentage_col, title, palette = palette,  color = color, percentage_text = True,\n                 xlabel_text = xlabel_text, ylabel_text = ylabel_text, figsize = figsize, barwidth=barwidth, pctlcnadjust=pctlcnadjust)","0152e820":"col_name = 'pct_free\/reduced'\nincome_series = count_values(districts_data, col_name)\n\nranges = {\"[0, 0.2[\" : \"0-20%\",\n         \"[0.2, 0.4[\" : \"20-40%\",\n         \"[0.4, 0.6[\" : \"40-60%\",\n         \"[0.6, 0.8[\" : \"60-80%\",\n         \"[0.8, 1[\" : \"80-100%\"}\n\nincome_series[\"FreeLunchEligible_population\"] = income_series[\"pct_free\/reduced\"].map(ranges)\n\nincome_series","38651649":"value_col = 'count'\nlabel_col = 'FreeLunchEligible_population'\npercentage_col = 'percentage'\npalette = None\ncolor = 'gray'\npercentage_text = True\nxlabel_text = \"\"\nylabel_text = ''\ntitle = 'Distribution of Free\/Reduced-price lunch eligible population in the districts'\nfigsize = (12,8)\nbarwidth = 0.3\npctlcnadjust = 1.3\n\nplotbar_vertical(income_series, value_col, label_col, percentage_col, title, palette = palette,  color = color, percentage_text = True,\n                 xlabel_text = xlabel_text, ylabel_text = ylabel_text, figsize = figsize, barwidth=barwidth, pctlcnadjust=pctlcnadjust)","57191eee":"col_name = 'county_connections_ratio'\nconnection_series = count_values(districts_data, col_name)\nconnection_series","72a90546":"value_col = 'count'\nlabel_col = 'county_connections_ratio'\npercentage_col = 'percentage'\npalette = None\ncolor = 'gray'\npercentage_text = True\nxlabel_text = \"\"\nylabel_text = ''\ntitle = 'Distribution of HighSpeed Internet connection per Household Ratio in the districts'\nfigsize = (8,6)\nbarwidth = 0.3\npctlcnadjust = 5\n\nplotbar_vertical(connection_series, value_col, label_col, percentage_col, title, palette = palette,  color = color, percentage_text = True,\n                 xlabel_text = xlabel_text, ylabel_text = ylabel_text, figsize = figsize, barwidth=barwidth, pctlcnadjust=pctlcnadjust)","e56127e4":"def find_ppvalue_starting(s):\n    s = s.replace('[', ' ')\n    s = s.replace(',', ' ')\n    split_list = s.split()\n    return int(split_list[0])","764b07f6":"col_name = 'pp_total_raw'\nexpenditure_series = count_values(districts_data, col_name)\nexpenditure_series\n\n# find starting of the range of pp_total_raw to sort\nexpenditure_series['pp_starting'] = expenditure_series[col_name].apply(find_ppvalue_starting)\nexpenditure_series.sort_values(by = 'pp_starting', inplace=True)\n\nexpenditure_series","233fb5c4":"value_col = 'count'\nlabel_col = 'pp_total_raw'\npercentage_col = 'percentage'\npalette = None\ncolor = 'gray'\npercentage_text = True\nxlabel_text = \"\"\nylabel_text = ''\ntitle = 'Distribution of Per-pupil total expenditure in the districts'\nfigsize = (12,8)\nbarwidth = 0.5\npctlcnadjust = 0.8\n\n\nplotbar_horizontal(expenditure_series, value_col, label_col, percentage_col, title, palette = palette,  color = color, percentage_text = percentage_text,\n                   xlabel_text = xlabel_text, ylabel_text = ylabel_text, figsize = figsize, barwidth = barwidth, pctlcnadjust = pctlcnadjust)","f314d90b":"products_data = pd.read_csv(\"..\/input\/learnplatform-covid19-impact-on-digital-learning\/products_info.csv\")\nproducts_data.head()","65348e4d":"import re\n\ntemp_sectors = products_data['Sector(s)'].str.get_dummies(sep=\"; \")\ntemp_sectors.columns = [f\"sector_{re.sub(' ', '', c)}\" for c in temp_sectors.columns]\nproducts_data = products_data.join(temp_sectors)\nproducts_data.head()","0b44c4dc":"products_data['primary_function_main'] = products_data['Primary Essential Function'].apply(lambda x: x.split(' - ')[0] if x == x else x)\nproducts_data['primary_function_sub'] = products_data['Primary Essential Function'].apply(lambda x: x.split(' - ')[1] if x == x else x)\n\n# Synchronize similar values\nproducts_data['primary_function_sub'] = products_data['primary_function_sub'].replace({'Sites, Resources & References' : 'Sites, Resources & Reference'})\n\nproducts_data.head()","2dc4976c":"sector_dict = {'sector' : ['Corporate', 'HigherEd', 'PreK-12'],\n               'count' : [products_data['sector_Corporate'].sum(), products_data['sector_HigherEd'].sum(), products_data['sector_PreK-12'].sum()]}\n\nseries = pd.DataFrame.from_dict(sector_dict)\nseries['percentage'] = (series['count']\/products_data['sector_Corporate'].shape[0])*100\nseries.sort_values(by='count', ascending=False, inplace=True)\nseries","39c6a520":"value_col = 'count'\nlabel_col = 'sector'\npercentage_col = 'percentage'\n#palette = plt.cm.Greys(np.linspace(1, 0.2, n_unique))\npalette = [\"darkred\" if x=='PreK-12' else 'gray' for x in series['sector']]\ntitle = 'Product sector dstribution'\nfigsize=(12,8)\nbarwidth=0.3\npctlcnadjust=10\n\nplotbar_vertical(series, value_col, label_col, percentage_col, title, palette=palette, barwidth=barwidth, pctlcnadjust=pctlcnadjust, figsize=figsize)","78360d4b":"series = products_data.groupby(['primary_function_main']).agg({'primary_function_sub': 'value_counts'})\nseries","2f334a79":"series_unstacked = series.unstack()\nseries_unstacked.reset_index(inplace=True)\nseries_unstacked.columns = series_unstacked.columns.droplevel(0)\nseries_unstacked.rename(columns={ series_unstacked.columns[0]: \"primary_function_main\" }, inplace = True)\nseries_unstacked","b4aa1104":"series_melt = series_unstacked.melt(id_vars=['primary_function_main'], var_name='sub',value_name='count').sort_values('primary_function_main')\n\nseries_melt.fillna(0, inplace=True)# replace NaN with 0\nseries_melt","f122011e":"series = series_melt\nvalue_col = 'count'\nlabel_col = 'sub'\npercentage_col = ''\n#palette = plt.cm.Greys(np.linspace(1, 0.2, n_unique))\npalette = None\ncolor = 'gray'\npercentage_text = False\nxlabel_text = \"\"\nylabel_text = ''\ntitle = 'Distribution of HighSpeed Internet connection per Household Ratio in the districts'\nfigsize = (12,14)\n\n# ------------------------------------------------------------------ #\n# Vertical bar graph\n# ------------------------------------------------------------------ #\n\nfig = plt.figure(figsize=figsize)\ngs = fig.add_gridspec(1, 1)\nax = fig.add_subplot(gs[0, 0])\n\n# Remove some axis lines\nfor s in [\"top\",\"right\", \"bottom\"]:\n    ax.spines[s].set_visible(False)\n\nn_unique = series.shape[0]\nvalue = series[value_col]\nlabel = series[label_col]\n\nax_sns = sns.barplot(ax=ax, x=value, y=label, hue=series['primary_function_main'], dodge=False)\n\n# Customize\/Remove ticks\nax.tick_params(axis = \"x\", which = \"both\", left = False, labelcolor='gray')\nax.tick_params(axis = \"x\", width=1, length=1)\n#ax.set_xticklabels([]) # remove x tick label\n# Customize\/Remove labels\nax.set_ylabel(xlabel_text,color='lightgray')    \nax.set_xlabel(ylabel_text,color='lightgray')\n\nplt.title(title, fontsize=14, weight='bold', color=\"gray\")\n\n# Change bar width\ndef change_width(ax, new_value) :\n    for patch in ax.patches :\n        current_width = patch.get_height()\n        diff = current_width - new_value\n\n        # we change the bar width\n        patch.set_height(new_value)\n\n        # we recenter the bar\n        patch.set_y(patch.get_y() + diff * .5)\n        \nchange_width(ax, .3)\n\nif percentage_text:\n    for p, percentage in zip(ax.patches, series[percentage_col]):\n        label_1 = \"%.0f%%\" %percentage\n        y = p.get_y() + p.get_height() \/ 2\n        x = p.get_width() + 5\n        ax.text(x, y, label_1, ha='center', va='center', color='gray', fontsize=10)\n            \nplt.show()","de3c14ee":"References:\n\n[\ud83d\udd25\ud83d\udcaf:COVID-19 Impact on Digital Learning](#https:\/\/www.kaggle.com\/muhammadimran112233\/covid-19-impact-on-digital-learning)\n\n[How To Approach Analytics Challenges](#https:\/\/www.kaggle.com\/iamleonie\/how-to-approach-analytics-challenges)","ec0665c7":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           background-color:purple;\n           font-size:60%;\n           font-family:Verdana;\n           letter-spacing:0.5px\">\n<h1 style=\"text-align: center;\n           padding: 10px;\n              color:white\">\n<a id=\"districts_data\"> <\/a>\nDistricts data\n<\/h1>\n<\/div>","3d3fc792":"Product data provides information about the characteristics of the top 372 products with most users in 2020","5d01a9a3":"**pct_black\/hispanic** - Percentage of students in the districts identified as Black or Hispanic based on 2018-19 NCES data\n\nHow to interpret the value \"[0.8, 1[\" for pct_black\/hispanic variable?\n\nIt means the percentage of black\/hispanic for that district falls under the range of .8-1. For the purpose of data de-identification, some of the categories only shows a range and not the exact value.","de9fca81":"**pct_free\/reduced** - Percentage of students in the districts eligible for free or reduced-price lunch based on 2018-19 NCES data","7e4239df":"One-Hot Encoding the Product Sectors column\n\nReference: https:\/\/www.kaggle.com\/iamleonie\/how-to-approach-analytics-challenges","03186d46":"**pp_total_raw** - Per-pupil total expenditure (sum of local and federal expenditure) from Edunomics Lab's National Education Resource Database on Schools (NERD) project. The expenditure data are school-by-school, and we use the median value to represent the expenditure of a given school district.","20eb94e1":"Districts data provides information about the characteristics of school districts\n\nShape of districts_data = (233, 7)\n\nColumns in districts_data: 'district_id', 'state', 'locale', 'pct_black\/hispanic','pct_free\/reduced', 'county_connections_ratio', 'pp_total_raw'","d68d76b0":"## **Thank you for reading my notebook. Please Upvote \ud83d\ude4f\ud83c\udffb**","ea0be541":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           background-color:purple;\n           font-size:60%;\n           font-family:Verdana;\n           letter-spacing:0.5px\">\n<h1 style=\"text-align: center;\n           padding: 10px;\n              color:white\">\n<a id=\"Products_data\"> <\/a>\nProducts data\n<\/h1>\n<\/div>","0c0011bb":"Splitting up the Primary Essential Function column","4f9884fc":"**county_connections_ratio** - ratio (residential fixed high-speed connections over 200 kbps in at least one direction\/households) based on the county level data from FCC From 477 (December 2018 version). See FCC data for more information."}}