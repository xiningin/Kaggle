{"cell_type":{"4643cd09":"code","e4735a82":"code","cef6cd43":"code","d1954bbe":"code","85a72f1f":"code","8f9453e8":"code","b694b1ff":"code","88df33a4":"code","32217446":"code","db0f491f":"code","56dfc18b":"code","3b13d6a8":"code","f642e95a":"code","8a5506da":"code","9cf0281f":"markdown"},"source":{"4643cd09":"#Importing all the necessary libraries\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport plotly.offline as py\nfrom plotly import tools\npy.init_notebook_mode(connected=True)\nimport plotly.graph_objs as go","e4735a82":"#First we will analyze the reservoir levels in Chennai\ndf = pd.read_csv(\"..\/input\/chennai_reservoir_levels.csv\")\ndf[\"Date\"] = pd.to_datetime(df[\"Date\"], format='%d-%m-%Y')\ndf.head()","cef6cd43":"#To plot the data we'll use a scatter plot, here's a function to represent one using plotly library\ndef scatter_plot(reservoir, color,res):\n    trace = go.Scatter(\n        x=reservoir.index[::-1],\n        y=reservoir.values[::-1],\n        name=res,\n        marker=dict(\n            color=color,\n        ),\n    )\n\n    return trace\n#Creating trace objects for al 4 rservoirs\nreservoir = df[\"POONDI\"]\nreservoir.index = df[\"Date\"]\ntrace1 = scatter_plot(reservoir, 'red','POONDI')\n\nreservoir = df[\"CHOLAVARAM\"]\nreservoir.index = df[\"Date\"]\ntrace2 = scatter_plot(reservoir, 'blue','CHOLAVARAM')\n\nreservoir = df[\"REDHILLS\"]\nreservoir.index = df[\"Date\"]\ntrace3 = scatter_plot(reservoir, 'green','REDHILLS')\n\nreservoir = df[\"CHEMBARAMBAKKAM\"]\nreservoir.index = df[\"Date\"]\ntrace4 = scatter_plot(reservoir, 'purple','CHEMBARAMBAKKAM')\n","d1954bbe":"#Plotting the traces on a single plot\nfig['layout'].update(height=600, width=1200, title='Water availability in all 4 reservoirs - in mcft')\npy.iplot(fig, filename='reservoir_plots')","85a72f1f":"#From the above plot we see that water levels in the reservoirs is going down significantly since 2018","8f9453e8":"#For a better picture, let's combine the water levels and then analyze\ndf[\"total\"] = df[\"POONDI\"] + df[\"CHOLAVARAM\"] + df[\"REDHILLS\"] + df[\"CHEMBARAMBAKKAM\"]\ndf[\"total\"] = df[\"POONDI\"] + df[\"CHOLAVARAM\"] + df[\"REDHILLS\"] + df[\"CHEMBARAMBAKKAM\"]\n\nreservoir = df[\"total\"]\nreservoir.index = df[\"Date\"]\ntrace5 = scatter_plot(reservoir, 'violet','All')\n\nfig = tools.make_subplots(rows=1, cols=1)\nfig.append_trace(trace5, 1, 1)\n\n\nfig['layout'].update(height=600, width=1200, title='Total water availability from all four reservoirs - in mcft')\npy.iplot(fig, filename='reservoir_plots')","b694b1ff":"#Since the water decline has a steeper slope since 2018, let's isolate that duration \n#Selecting the data since January 2018 till June 2019(present data)\nmask = (df['Date'] > '2018-1-1')\ndf=df.loc[mask]\ndf.head()","88df33a4":"#Creating new traces for the succeeding data\nreservoir = df[\"POONDI\"]\nreservoir.index = df[\"Date\"]\ntrace1 = scatter_plot(reservoir, 'red','POONDI')\n\nreservoir = df[\"CHOLAVARAM\"]\nreservoir.index = df[\"Date\"]\ntrace2 = scatter_plot(reservoir, 'blue','CHOLAVARAM')\n\nreservoir = df[\"REDHILLS\"]\nreservoir.index = df[\"Date\"]\ntrace3 = scatter_plot(reservoir, 'green','REDHILLS')\n\nreservoir = df[\"CHEMBARAMBAKKAM\"]\nreservoir.index = df[\"Date\"]\ntrace4 = scatter_plot(reservoir, 'purple','CHEMBARAMBAKKAM')","32217446":"fig = tools.make_subplots(rows=1, cols=1)\nfig.append_trace(trace1, 1, 1)\nfig.append_trace(trace2, 1, 1)\nfig.append_trace(trace3, 1, 1)\nfig.append_trace(trace4, 1, 1)","db0f491f":"#Now, plotting the data\nfig['layout'].update(height=600, width=1200,title='Declining Water Availability since 2018')\npy.iplot(fig, filename='reservoir_plots')","56dfc18b":"#Finally let's look at combined water shortage \ndf[\"total\"] = df[\"POONDI\"] + df[\"CHOLAVARAM\"] + df[\"REDHILLS\"] + df[\"CHEMBARAMBAKKAM\"]\ndf[\"total\"] = df[\"POONDI\"] + df[\"CHOLAVARAM\"] + df[\"REDHILLS\"] + df[\"CHEMBARAMBAKKAM\"]\n\nreservoir = df[\"total\"]\nreservoir.index = df[\"Date\"]\ntrace5 = scatter_plot(reservoir, 'violet','All')\n\nfig = tools.make_subplots(rows=1, cols=1)\nfig.append_trace(trace5, 1, 1)\n\n\nfig['layout'].update(height=600, width=1200, title='Total water availability from all four reservoirs since January 2018 - in mcft')\npy.iplot(fig, filename='reservoir_plots')","3b13d6a8":"#Shocking to see the reservoir levels going down steeply since 2018, it's almmost zero right now\n#It's worrisome to see that there is almost no water in reservirs in Chennai ","f642e95a":"#Let's analyze the rain data\nrain_df = pd.read_csv(\"..\/input\/chennai_reservoir_rainfall.csv\")\nrain_df[\"Date\"] = pd.to_datetime(rain_df[\"Date\"], format='%d-%m-%Y')\n\nrain_df[\"total\"] = rain_df[\"POONDI\"] + rain_df[\"CHOLAVARAM\"] + rain_df[\"REDHILLS\"] + rain_df[\"CHEMBARAMBAKKAM\"]\n\ndef area_plot(reservoir):\n    trace = go.Scatter(\n        x=reservoir.index[::-1],\n        y=reservoir.values[::-1],\n        fill='tonexty'  \n    )\n    data=[trace]\n    return trace\n\nrain_df[\"YearMonth\"] = pd.to_datetime(rain_df[\"Date\"].dt.year.astype(str) + rain_df[\"Date\"].dt.month.astype(str), format='%Y%m')\nreservoir = rain_df.groupby(\"YearMonth\")[\"total\"].sum()\ntrace5 = area_plot(reservoir)\n\nfig = tools.make_subplots(rows=1, cols=1)\nfig.append_trace(trace5, 1, 1)\n\n\nfig['layout'].update(height=600, width=1200, title='Total rainfall in all four reservoir regions - in mm')\npy.iplot(fig, filename='rainfall_plots')\n","8a5506da":"#As we can see that the major rainfall seasons are July - November \n#Also we can see that rainfall levels are lower in 2018 compared to others \n","9cf0281f":"Find the complete blog on the same on my [Medium Post](https:\/\/medium.com\/@harjotspahwa\/interactive-data-visualization-of-chennai-water-crisis-using-plotly-15e5000ad7df)"}}