{"cell_type":{"7a9bdbb8":"code","589ce063":"code","24fe970f":"code","bc6a2895":"code","6f4152af":"code","7151a6c0":"code","1840a962":"code","34d79a9f":"code","ccb1907a":"code","d0571240":"code","6377c95c":"code","e19b00b3":"code","5c6b701f":"code","e4539b95":"code","c7ce9ae6":"code","fac99a84":"code","3fba530e":"code","387f5779":"code","064fbcf6":"code","14eb4bc2":"code","25a7c019":"code","4d385339":"code","1a67c85b":"code","d2ec4f44":"code","57ec0cef":"code","f1a3ed24":"code","0f19a52c":"code","c69735f0":"code","6abfc941":"code","a1b5cd2e":"code","85c69f09":"markdown","1d727b27":"markdown","7e2b3546":"markdown","be59c183":"markdown","ab11eeb4":"markdown","7627b48e":"markdown","a2067b5d":"markdown"},"source":{"7a9bdbb8":"import pandas as pd\nimport numpy as np\n\nfrom imblearn.over_sampling import RandomOverSampler\nfrom sklearn.preprocessing import LabelEncoder\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.metrics import r2_score, accuracy_score, mean_absolute_error, mean_squared_error, roc_curve, auc, confusion_matrix, classification_report\n\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.neighbors import KNeighborsClassifier","589ce063":"!ls ..\/input\/indian-liver-patient-records\/indian_liver_patient.csv","24fe970f":"data=pd.read_csv(\"..\/input\/indian-liver-patient-records\/indian_liver_patient.csv\")\ndata","bc6a2895":"data.isnull().sum()","6f4152af":"data.describe()","7151a6c0":"data.info()","1840a962":"data[\"Albumin_and_Globulin_Ratio\"]=data[\"Albumin_and_Globulin_Ratio\"].bfill()","34d79a9f":"data.isnull().sum()","ccb1907a":"data[\"Dataset\"].value_counts()","d0571240":"x=data.iloc[:,:-1]\ny=data.iloc[:,-1]\ny","6377c95c":"#Balancing the class\noversample = RandomOverSampler()\nx, y= oversample.fit_resample(x, y)\ntype(x)","e19b00b3":"new_data=pd.DataFrame(data=x, columns=x.columns)\nnew_data[\"Dataset\"]=y\nnew_data","5c6b701f":"#Now class is balanced\nnew_data[\"Dataset\"].value_counts()","e4539b95":"new_data.shape","c7ce9ae6":"#Converting object to int for processing\nla= LabelEncoder()\nnew_data[\"Gender\"]=la.fit_transform(new_data[\"Gender\"])","fac99a84":"corr=new_data.corr()\nplt.subplots(figsize=(12,6))\nsns.heatmap(corr, annot=True)","3fba530e":"sns.pairplot(new_data)","387f5779":"corr[\"Dataset\"].sort_values(ascending=False)","064fbcf6":"x=new_data.iloc[:,:-1]\nsc= StandardScaler()\nsc.fit_transform(x)\ny=new_data[\"Dataset\"]\nx","14eb4bc2":"xtrain, xtest, ytrain, ytest= train_test_split(x, y, test_size=0.25, random_state=42)","25a7c019":"cla= KNeighborsClassifier(n_neighbors=5)\ncla.fit(xtrain, ytrain)\ncla.get_params()","4d385339":"param={\n    'algorithm':['auto', 'ball_tree', 'kd_tree', 'brute'],\n    'n_neighbors': [ i for i in range (5,15,2)],\n    'weights':['uniform', 'distance'] \n}","1a67c85b":"grid = GridSearchCV(estimator=cla, param_grid=param, cv= 5)\ngrid.fit(xtrain, ytrain)","d2ec4f44":"# Finding best parameters\ngrid.best_params_","57ec0cef":"cla= KNeighborsClassifier(n_neighbors=13, weights='distance', algorithm='auto')\ncla.fit(xtrain, ytrain)","f1a3ed24":"ytrain_pre=cla.predict(xtrain)\nprint(\"Training accuracy is {} %\".format(accuracy_score(ytrain, ytrain_pre)*100))","0f19a52c":"ypredict=cla.predict(xtest)\nprint(\"Testing accuracy is {} %\".format(accuracy_score(ytest, ypredict)*100))","c69735f0":"pd.DataFrame({\"Actual\":ytest,\"Predicted\":ypredict})","6abfc941":"a = confusion_matrix(ytest, ypredict)\nsns.heatmap(a, annot=True)","a1b5cd2e":"print(\"KNN Model Classification Report\")\nprint(classification_report(ytest, ypredict))","85c69f09":"# Applying Model","1d727b27":"# Importing Libraries","7e2b3546":"# Checking Accuracy","be59c183":"# Data Splitting","ab11eeb4":"# Reading the Dataset","7627b48e":"# Data Visualization","a2067b5d":"# Data Preprocessing"}}