{"cell_type":{"c3efe9bc":"code","04b9feb1":"code","673e3e8a":"code","9ad9ef12":"code","9d1e1daa":"code","0e2bfcea":"code","09b43f01":"code","bb39670e":"code","5375f6de":"code","f98ff4b9":"code","59e8e444":"code","3d855077":"code","63629fee":"code","7266a3a4":"code","b62ed9d0":"code","7d1a6c04":"code","aca49b74":"code","9a00f46e":"code","a9484a09":"code","5f4ddd92":"code","973f20ad":"code","4a77be76":"code","2a00d9be":"code","24ef18e4":"code","0899c76d":"code","95ce2669":"code","5f7c1ab4":"code","258e208b":"code","8f932f29":"code","710b3dce":"code","d9ebc2c9":"code","9c71dcf9":"code","23e0b400":"code","ba8a769c":"code","55e10dc5":"code","a0446706":"code","b624e9cb":"code","ca804e25":"code","a5f20c2b":"code","dbc202f5":"code","ae86bf83":"code","bb573cd2":"code","25865354":"code","fb405b9e":"code","1c5d3966":"markdown","aadfb2a1":"markdown","96e03ddc":"markdown","13c0dc70":"markdown","d1d1e0c2":"markdown","75f795dc":"markdown","bbfaf966":"markdown","bf4aed0c":"markdown","a91fa296":"markdown","08af78e3":"markdown","96e88ad0":"markdown","0b8a70ce":"markdown","cbf0c283":"markdown","ecf38591":"markdown","ffec4d61":"markdown","062710ce":"markdown","6f819f33":"markdown","3d94e827":"markdown","3f240b68":"markdown","53605dec":"markdown","be3921f7":"markdown","c18e5d82":"markdown","0c5317fe":"markdown","d992db86":"markdown","1b78dc74":"markdown","b660ca2c":"markdown","1233926f":"markdown","99735d47":"markdown","b2df8f96":"markdown","52ea1573":"markdown","8e1b40b0":"markdown"},"source":{"c3efe9bc":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","04b9feb1":"df = pd.read_csv('..\/input\/africa-economic-banking-and-systemic-crisis-data\/african_crises.csv')\ndf.head()","673e3e8a":"df.describe().T[1:10]","9ad9ef12":"import seaborn as sns\nimport matplotlib.pyplot as plt\nimport warnings\nwarnings.filterwarnings('ignore')","9d1e1daa":"fig,ax = plt.subplots(1,2, figsize=(15,10))\nvc=df['inflation_crises'].value_counts()\n#print(vc)\nvc.plot(kind='pie',autopct='%1.1f', ax = ax[0])\n\nvc=df['banking_crisis'].value_counts()\n#print(vc)\nvc.plot(kind='pie',autopct='%1.1f',ax = ax[1])\nax[0].set_title('Percentage of Inflation Crisis')\nax[1].set_title('Percentage of Banking Crisis')\nplt.show()","0e2bfcea":"fig,ax = plt.subplots(1,2, figsize=(15,10))\nvc=df['currency_crises'].value_counts()\nvc.plot(kind='pie',autopct='%1.1f', ax = ax[0])\n\nvc=df['systemic_crisis'].value_counts()\nvc.plot(kind='pie',autopct='%1.1f',ax = ax[1])\nax[0].set_title('Percentage of Currency Crisis')\nax[1].set_title('Percentage of Systemic Crisis')\nplt.show()","09b43f01":"plt.figure(figsize=(10,7))\nsns.heatmap(df.corr(),annot=True, cmap='YlGnBu')\nplt.show()","bb39670e":"plt.figure(figsize=(12,7))\nsns.barplot(data=df, x='country', y='case')\nplt.show()","5375f6de":"plt.figure(figsize=(14,8))\nsns.scatterplot(data = df, y='year', x = 'inflation_crises',hue='inflation_crises')\nplt.show()","f98ff4b9":"plt.figure(figsize=(10,7))\nsns.distplot(df['exch_usd'], bins=20, hist=True, kde=True, color='r')\nplt.show()","59e8e444":"plt.figure(figsize=(10,7))\nsns.pointplot(y=df['exch_usd'] , x= df['inflation_crises'])\nplt.title('Exchange Rate vs. Inflation Crisis')\nplt.show()","3d855077":"topfive = df.groupby('country')['inflation_crises'].agg('sum').nlargest(5)\n\ndf['banking_crisis'] = df['banking_crisis'].map(lambda x : 1 if x == 'crisis' else 0)\ntopbank = df.groupby('country')['banking_crisis'].agg('sum').nlargest(5)","63629fee":"fig,ax = plt.subplots(1,2,figsize=(15,6))\ntopfive.plot.bar(color='m', ax = ax[0])\ntopbank.plot.bar(color='g', ax = ax[1])\nax[0].set_title('Top Five Countries of Inflation Crisis')\nax[1].set_title('Top Five Countries of Banking Crisis')\nplt.show()","7266a3a4":"curr = df.groupby('country')['currency_crises'].agg('sum').nlargest(5)\nsys = df.groupby('country')['systemic_crisis'].agg('sum').nlargest(5)\n","b62ed9d0":"fig,ax = plt.subplots(1,2,figsize=(15,6))\ncurr.plot.bar(color='r', ax = ax[0])\nsys.plot.bar(color='k', ax = ax[1])\nax[0].set_title('Top Five Countries of Currency Crisis')\nax[1].set_title('Top Five Countries of Systemic Crisis')\nplt.show()","7d1a6c04":"sns.regplot(data=df, y='inflation_crises', x='exch_usd')\nplt.show()","aca49b74":"plt.figure(figsize=(10,7))\ndf.set_index('exch_usd')['inflation_annual_cpi'].plot.line(color='r')\nplt.show()","9a00f46e":"from sklearn.model_selection import cross_val_score\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.ensemble import RandomForestClassifier \nfrom sklearn.metrics import confusion_matrix\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.preprocessing import LabelEncoder","a9484a09":"le = LabelEncoder()\ndf['country'] = le.fit_transform(df['country'])","5f4ddd92":"df['cc3'] = le.fit_transform(df['cc3'])","973f20ad":"X = df.drop('inflation_crises', axis=1)\ny = df['inflation_crises']\ncv_scr = cross_val_score(RandomForestClassifier(), X, y, cv = 10)\ncv_scr","4a77be76":"sum1 = 0\nfor i in cv_scr:\n    sum1 = sum1+i\n    i +=1\nprint(\"The average accuracy of Random Forest algorithm with 10 folds is\", sum1*100\/10, \"percent\")","2a00d9be":"cv_scr1 = cross_val_score(LogisticRegression(), X, y, cv = 10)\nsum2 = 0\nfor i in cv_scr1:\n    sum2 = sum2+i\n    i +=1\nprint(\"The average accuracy of Logistic Regression algorithm with 10 folds is\", sum2*100\/10, \"percent\")","24ef18e4":"cv_scr2 = cross_val_score(DecisionTreeClassifier(), X, y, cv = 10)\nsum3 = 0\nfor i in cv_scr2:\n    sum3 = sum3+i\n    i +=1\nprint(\"The average accuracy of Decision Tree algorithm with 10 folds is\", sum3*100\/10, \"percent\")","0899c76d":"cv_scr3 = cross_val_score(KNeighborsClassifier(), X, y, cv = 10)\nsum4 = 0\nfor i in cv_scr3:\n    sum4 = sum4+i\n    i +=1\nprint(\"The average accuracy of KNN algorithm with 10 folds is\", sum4*100\/10, \"percent\")","95ce2669":"indices = ['Random Forest','Logistic Regression','Decision Tree', 'KNN']\nbar = pd.DataFrame([sum1*10,sum2*10, sum3*10, sum4*10], index = indices)","5f7c1ab4":"bar.plot.bar(color='m')\nplt.show()","258e208b":"from sklearn.model_selection import train_test_split\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=14)","8f932f29":"model = RandomForestClassifier()\nmodel.fit(X_train,y_train)","710b3dce":"print(\"The accuracy of the model is\",model.score(X_test,y_test)*100,\"percent\")","d9ebc2c9":"plt.figure(figsize=(10,7))\ny_pred = model.predict(X_test)\ncm = confusion_matrix(y_test,y_pred)\nsns.heatmap(cm,annot=True)\nplt.show()","9c71dcf9":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=14)\nlogreg = LogisticRegression()\nlogreg.fit(X_train, y_train)\ny_pred = logreg.predict(X_test)","23e0b400":"print(\"The accuracy of the model is\",logreg.score(X_test,y_test)*100,\"percent\")","ba8a769c":"plt.figure(figsize=(10,7))\ny_pred = logreg.predict(X_test)\ncm = confusion_matrix(y_test,y_pred)\nsns.heatmap(cm,annot=True)\nplt.show()","55e10dc5":"gini = DecisionTreeClassifier()","a0446706":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=14)\ngini.fit(X_train, y_train)\ny_pred = gini.predict(X_test)","b624e9cb":"from sklearn.metrics import accuracy_score, classification_report\nprint('Accuracy Score: ',accuracy_score(y_test, y_pred)*100,\"percent\")","ca804e25":"print('Classification Report')\nprint(classification_report(y_test, y_pred))","a5f20c2b":"plt.figure(figsize=(10,7))\ny_pred = model.predict(X_test)\ncm = confusion_matrix(y_test,y_pred)\nsns.heatmap(cm,annot=True)\nplt.show()","dbc202f5":"from sklearn.neighbors import KNeighborsClassifier","ae86bf83":"knn = KNeighborsClassifier()\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=14)","bb573cd2":"from sklearn.model_selection import GridSearchCV\ngrid = {'n_neighbors':np.arange(1,25)}\nknn_cv = GridSearchCV(knn, grid, cv=5)\nknn_cv.fit(X,y)\nprint(\"Tuned Parameters are: {}\".format(knn_cv.best_params_))\nprint(\"Best Score is: {}\".format(knn_cv.best_score_))","25865354":"knn = KNeighborsClassifier(n_neighbors = 5)\n\nknn.fit(X_train,y_train)\ny_pred = knn.predict(X_test)\nprint(\"The accuracy score is\", knn.score(X_test, y_test)*100,\"percent\")","fb405b9e":"plt.figure(figsize=(10,7))\ncm = confusion_matrix(y_test,y_pred)\nsns.heatmap(cm,annot=True)\nplt.show()","1c5d3966":"> #### The cross-validation score of Decision Tree showed an accuracy of approximately 92% but on applicatiion of the Decision Tree model, we obtain an accuracy of 98.74%.","aadfb2a1":"## Exploratory Analysis","96e03ddc":"* The percentage of cases with inflation crises is highest at 12.9%, \n* The percentage of cases with systemic crisis is the lowest at 7.7%.","13c0dc70":"### Correlation Between Variables","d1d1e0c2":"### Decision Tree ","75f795dc":"### No. of Cases With Respect to Country","bbfaf966":"#### The confusion matrix also confirms the fact that the accuracy of KNN is lower than the other three models because the number of False Positives and False Negatives in this case are higher than all the other three models.","bf4aed0c":"> #### The number of years that had inflation crisis = 1 is not in continuum. It means that inflation crisis did not occur continuously from 1860 to 2020.","a91fa296":"> #### Zimbabwe and Nigeria are among the top five countries in all four kinds of crises.","08af78e3":"### Interpretation of Confusion Matrix\n\n> ### Note: 0 - No Inflation Crisis     |     1 - Inflation Crisis\n\n* The number of True Positives is 37 (column 2, row 2). This implies that these values are correctly predicted as '1' or they have inflation crisis.\n* The number of False Negatives is 3 (column 2, row 1). This implies that 3 values that are predicted as '0' are actually '1', i.e. these values are predicted as no having inflation crisis while actually they do have inflation crisis.\n* The number of False Positives is 1 (column 1, row 2). This implies that these values that are predicted as '1' are actually '0', i.e. they are predicted as having inflation crisis but actually they do not have inflation crisis.\n* The number of True Negatives is 2.8e+02 (column 1, row 1). This implies that these values that are predicted as '1' are actually '1', i.e. they are predicted as having inflation crisis and they actually do have inflation crisis.","96e88ad0":"### Comparing Cross Validation Scores of Different Algorithms","0b8a70ce":"### Logistic Regression","cbf0c283":"* The highest correlation exists between Domestic Debt in Default and Sovereign External Debt Default.\n* The lowest correlation is between Case and Exchange Used.","ecf38591":"### Scatter of Inflation Crises","ffec4d61":"> #### The kernel density is maximum between 0 to 25 (approximate range) implying that the maximum number of countries have an exchange rate in this range.","062710ce":"### Relation Between Exchange Rate and Inflation Crisis","6f819f33":"#### Hyperparametric Tuning","3d94e827":"### Distribution of Exchange Rate of Countries w.r.t US Dollar","3f240b68":"### K Nearest Neighbours","53605dec":"#### Out of the four methods that we have applied, KNN gives the lowest accuracy.","be3921f7":"> #### Objectives: \n* To explore the data, look for trends and draw inferences.\n* To classify whether a country is suffering from inflation crisis or not using different classification algorithms such as Random Forest Classifer, Decision Tree, K Nearest Neighbors & Logistic Regression.\n* To compare K-Fold scores of different models.\n* To check and compare the accuracy of the different models and confirm our findings using the Confusion Matrix.","c18e5d82":"> #### The countries with inflation crisis have a lower exchange rate (in US Dollars).","0c5317fe":"### Random Forest","d992db86":"> #### As seen in the bar chart, the cross validation score of Logistic Regression and Random Forest Classifer is almost the same, while the score for Decision Tree is the lowest.","1b78dc74":"### Percentages of Different Types of Crises","b660ca2c":"> #### The confusion matrix obtained is almost the same as the one obtained in Random Forest implying that both Random Forest and Logistic Regression predict with almost the same accuracy (as can be confirmed by the model score above).","1233926f":"> #### As the above plot shows, the relationship between Inflation Crises and Exchange Rate is not profoundly linear. Thus, linear regression algoritm is not well-application","99735d47":"### Top Five Countries of Crisis","b2df8f96":"> #### The accuracy score of Random Forest Classifier is 98.74 percent.","52ea1573":"#### Since after tuning, the best number of parameters has come out to be no. of neighbors = 5. We shall use KNN model with n_neighbors = 5 on our dataset.","8e1b40b0":"### Relationship Between Exchange Rate and Annual Inflation CPI"}}