{"cell_type":{"6f21e0c3":"code","66ff4c76":"code","2119e090":"code","2aad1397":"code","e26c920b":"code","4c3c406b":"code","0d1de90c":"code","1c3fcf25":"code","4756e146":"code","44321150":"code","148604d4":"code","29567a28":"code","954d5df9":"code","4eb9606d":"code","9b360dff":"code","4edd9ed3":"code","56c5fc5e":"code","fd216049":"code","1f03c7b2":"code","4b437ffe":"code","0a2057a6":"code","8980db43":"markdown","93bee7fe":"markdown"},"source":{"6f21e0c3":"import pandas as pd\nfrom pathlib import Path\n\ndata_dir = Path('..\/input\/tabular-playground-series-sep-2021\/')\n\ndf_train = pd.read_csv(\n    data_dir \/ \"train.csv\",\n    index_col='id',\n    nrows=25000,  # comment this row to use the full dataset\n)\n\nFEATURES = df_train.columns[:-1]\nTARGET = df_train.columns[-1]\n\ndf_train.head()","66ff4c76":"!pip install pycaret[full]","2119e090":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom pycaret.classification import *","2aad1397":"train = pd.read_csv('..\/input\/tabular-playground-series-sep-2021\/train.csv')\ntest = pd.read_csv('..\/input\/tabular-playground-series-sep-2021\/test.csv')\n\ndata = pd.concat([train, test])","e26c920b":"df_data = data.drop(columns = 'id')","4c3c406b":"plt.figure(figsize = (12, 6))\nmissing_values = df_data.isnull().sum()[:-1]\nsns.histplot(missing_values, color='violet');\nplt.show()","0d1de90c":"print('\\n')\nprint('-------- Distribution of Missing values --------')\nprint('Min:', missing_values.min())\nprint('Max:', missing_values.max())\nprint('Mean:', missing_values.mean())\nprint('------------------------------------------------')","1c3fcf25":"df_data.describe","4756e146":"train2 = df_data[:len(train)]\ntest2 = df_data[len(train):]\ntest2.drop(columns = 'claim', inplace = True)","44321150":"from pycaret.classification import *\nclf = setup(data=train2, target = 'claim', session_id=42, log_experiment=True,numeric_imputation = 'mean',normalize = True,\n        normalize_method = 'robust',fold = 3,\n        silent= True,\n        use_gpu=True,)","148604d4":"cat = create_model(estimator = 'catboost', fold = 5)\n    ","29567a28":"lgbm = create_model(estimator = 'lightgbm', fold = 5)","954d5df9":"xgb = create_model(estimator = 'xgboost', fold = 5)","4eb9606d":"boosted_lgbm = ensemble_model(lgbm, method = 'Bagging')","9b360dff":"blender = blend_models(estimator_list = [cat,boosted_lgbm,xgb], fold=5)","4edd9ed3":"pred_holdout = predict_model(blender)","56c5fc5e":"final_model = finalize_model(blender)","fd216049":"prep_pipe = get_config('prep_pipe')\nprep_pipe.steps.append(['trained_model', final_model])\npred = prep_pipe.predict_proba(test2)","1f03c7b2":"sub = pd.read_csv('..\/input\/tabular-playground-series-sep-2021\/sample_solution.csv')\nsub","4b437ffe":"result=pred","0a2057a6":"sub['claim'] = result[:, 1]\nsub.to_csv('sub.csv', index = 0)","8980db43":"Import Libraries","93bee7fe":"# Using Pycaret library Tabular Playground Competition! #"}}