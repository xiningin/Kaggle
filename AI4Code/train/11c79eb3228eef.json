{"cell_type":{"e4a3b4ed":"code","a45c7ce6":"code","581ab96f":"code","3600bcfe":"code","2c9cf6cb":"code","125dbbb2":"code","70717c9b":"code","7d594c4b":"code","09d5d7ff":"code","213a69f4":"code","d2b729b4":"code","6695917a":"code","0ad25bd8":"code","9c14ec9d":"code","84a02ba9":"code","e1a8d518":"code","d5268582":"code","eeb6a6ee":"code","58efb6cc":"code","8cac610f":"code","ce6840dd":"code","7a83205a":"code","5192bec3":"code","8e1be497":"code","331ea4a1":"code","139ca298":"code","83097216":"code","4a5626ca":"code","4c5c58a3":"code","9ab2803f":"markdown","df9c3422":"markdown","f64d7b43":"markdown","0bb01589":"markdown","1badb53d":"markdown","06c2b616":"markdown","4b3e3aa0":"markdown","797742a9":"markdown","28ac7b13":"markdown","6e273a9b":"markdown","1708c0bc":"markdown","8696c8b1":"markdown","ab92b7aa":"markdown","bd7650a9":"markdown","f2386fa8":"markdown","42d2b574":"markdown","6f7f9b18":"markdown","edcada42":"markdown","fe44502d":"markdown","1ef4c909":"markdown","54173fd1":"markdown","364beecb":"markdown","1cf7f125":"markdown","0ad6f22d":"markdown","92321808":"markdown","7649c84f":"markdown"},"source":{"e4a3b4ed":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\nfrom sklearn.preprocessing import StandardScaler\n!pip install MiniSom\n!pip install --upgrade pip\nfrom minisom import MiniSom","a45c7ce6":"dataset = pd.read_csv(\"..\/input\/mines-data\/mines_data.csv\", encoding='latin1')\ndataset","581ab96f":"data_som = dataset[['section_area', 'object_area', 'rel_height', 'object_distance']]\ndata_som","3600bcfe":"sc = StandardScaler()\ndata_som_sc = sc.fit_transform(data_som)","2c9cf6cb":"ids = dataset[['ID']]\nI = ids['ID'].tolist()\nsection = dataset[['section']]\nS = section['section'].tolist()","125dbbb2":"som = MiniSom(x = 21, y = 21, input_len = 4, neighborhood_function = 'gaussian', sigma = 1.5, learning_rate = 0.5)\nsom.random_weights_init(data_som_sc)\nsom.train_random(data = data_som_sc, num_iteration = 1000)","70717c9b":"from pylab import bone, pcolor, colorbar, plot, show\nbone()\nplt.figure(figsize=(14, 10))\npcolor(som.distance_map().T, alpha=.9)\ncolorbar()\nmarkers = ['*', 'o', 's', 'D', 'X', 'v', 'P', 'h', '^']\ncolors = ['grey', 'r', 'g', 'b', 'y', 'c', 'orange', 'fuchsia', 'lime']\nfor i, x in enumerate(data_som_sc):\n    w = som.winner(x)\n    plot(w[0] + 0.5,\n        w[1] + 0.5,\n        markers[S[i]],\n        markeredgecolor=colors[S[i]],\n        markerfacecolor='None',\n        markersize = 10,\n        markeredgewidth=2\n        )\nshow()","7d594c4b":"from matplotlib.lines import Line2D\n\nlegend_elements = [Line2D([0], [0], marker='o', color='r', label='1',\n                   markerfacecolor='w', markersize=10, linestyle='None', markeredgewidth=2),\n                   Line2D([0], [0], marker='s', color='g', label='2',\n                   markerfacecolor='w', markersize=10, linestyle='None', markeredgewidth=2),\n                   Line2D([0], [0], marker='D', color='b', label='3',\n                   markerfacecolor='w', markersize=10, linestyle='None', markeredgewidth=2),\n                   Line2D([0], [0], marker='X', color='y', label='4',\n                   markerfacecolor='w', markersize=10, linestyle='None', markeredgewidth=2),\n                   Line2D([0], [0], marker='v', color='c', label='5',\n                   markerfacecolor='w', markersize=10, linestyle='None', markeredgewidth=2),\n                   Line2D([0], [0], marker='P', color='orange', label='6',\n                   markerfacecolor='w', markersize=10, linestyle='None', markeredgewidth=2),\n                   Line2D([0], [0], marker='h', color='fuchsia', label='7',\n                   markerfacecolor='w', markersize=10, linestyle='None', markeredgewidth=2),\n                   Line2D([0], [0], marker='^', color='lime', label='8',\n                   markerfacecolor='w', markersize=10, linestyle='None', markeredgewidth=2)]\n\nfrom pylab import bone, pcolor, colorbar, plot, show\nbone()\nplt.figure(figsize=(14, 10))\npcolor(som.distance_map().T, cmap='gray_r', alpha=.7)\ncolorbar()\nmarkers = ['*', 'o', 's', 'D', 'X', 'v', 'P', 'h', '^']\ncolors = ['grey', 'r', 'g', 'b', 'y', 'c', 'orange', 'fuchsia', 'lime']\nfor i, x in enumerate(data_som_sc):\n    w = som.winner(x)\n    plot(w[0] + 0.5,\n        w[1] + 0.5,\n        markers[S[i]],\n        markeredgecolor=colors[S[i]],\n        markerfacecolor='None',\n        markersize = 10,\n        markeredgewidth=2\n        )\nplt.legend(handles=legend_elements, bbox_to_anchor=(1.27, 1.01), prop={'size': 12}, ncol=1)\nshow()","09d5d7ff":"from pylab import bone, pcolor, colorbar, plot, show\nbone()\nplt.figure(figsize=(14, 10))\npcolor(som.distance_map().T, cmap='gray_r', alpha=.7)\ncolorbar()\nmarkers = ['*', 'o', 's', 'D', 'X', 'v', 'P', 'h', '^']\ncolors = ['grey', 'r', 'g', 'b', 'y', 'c', 'orange', 'fuchsia', 'lime']\nfor i, x in enumerate(data_som_sc):\n    w = som.winner(x)\n    plot(w[0] + 0.5,\n        w[1] + 0.5,\n        markers[S[i]],\n        markeredgecolor=colors[S[i]],\n        markerfacecolor='None',\n        markersize = 10,\n        markeredgewidth=2\n        )\nwmap = {}\nim = 0\nfor x, t in zip(data_som_sc, I):\n    w = som.winner(x)\n    wmap[w] = im\n    plt. text(w[0]+.8,  w[1]+.3,  str(t),\n              color='k', fontdict={'weight': 'normal', 'size': 14})\n    im = im + 1\nplt.legend(handles=legend_elements, bbox_to_anchor=(1.27, 1.01), prop={'size': 12}, ncol=1)\nshow()","213a69f4":"ro1 = dataset[dataset['ID'] == 0]\nro1","d2b729b4":"x = dataset.object_area\nplt.figure(figsize=(10,6))\nsns.set_style(\"darkgrid\")\nsns.distplot(x, label=\"item_id\", kde=True, bins=20)","6695917a":"x = dataset.rel_height\nplt.figure(figsize=(10,6))\nsns.set_style(\"darkgrid\")\nsns.distplot(x, label=\"item_id\", kde=True, bins=20)","0ad25bd8":"x = dataset.object_distance\nplt.figure(figsize=(10,6))\nsns.set_style(\"darkgrid\")\nsns.distplot(x, label=\"item_id\", kde=True, bins=20)","9c14ec9d":"dgs2 = dataset[dataset['section'] == 2]\ndgs2","84a02ba9":"x = dataset.rel_height\nplt.figure(figsize=(10,6))\nsns.set_style(\"darkgrid\")\nsns.distplot(x, label=\"x\", kde=False, bins=20)","e1a8d518":"bd3 = dataset[dataset['section'] == 3]\nbd3","d5268582":"x = irregular.object_distance\nplt.figure(figsize=(10,6))\nsns.set_style(\"darkgrid\")\nsns.distplot(x, label=\"x\", kde=False, bins=5)","eeb6a6ee":"bd3_upper_right = bd3[bd3['object_distance'] > 30]\nbd3_upper_right","58efb6cc":"bd3_right = bd3[bd3['object_distance'] > 20]\nbd3_right","8cac610f":"bd3_lower = bd3[bd3['object_distance'] > 15]\nbd3_lower","ce6840dd":"bd3_left = bd3[bd3['object_distance'] < 10]\nbd3_left","7a83205a":"yx4 = dataset[dataset['section'] == 4]\nyx4","5192bec3":"yx4_right = yx4[yx4['object_distance'] > 10]\nyx4_right","8e1be497":"yx4_lower = yx4_upper[yx4_upper['object_distance'] > 5]\nyx4_lower","331ea4a1":"yx4_upper = yx4[yx4['object_distance'] < 10]\nyx4_upper","139ca298":"ct5 = dataset[dataset['section'] == 5]\nct5","83097216":"oc6 = dataset[dataset['section'] == 6]\noc6","4a5626ca":"fh7 = dataset[dataset['section'] == 7]\nfh7","4c5c58a3":"bgt8 = dataset[dataset['section'] == 8]\nbgt8","9ab2803f":"7. Lastly, bright green triangles, marked as research field 8, are assigned as one cluster with some outliers, near outlier from fuchsia hexagon point. And, indeed, those measurements with IDs 138 and 139, have long object distance, which makes them look similar to the measurement with ID 120 and in the same time, they are outliers within the group, where object distance is very low. Objects with small distance between each other, but larger than the rest of the cluster (except for the outliers), are located in the upper part of the bright green triangle cluster.","df9c3422":"2. Dark green squares, which are measurements from research field 2, are the second group of the very high objects, right behind outlier object. All the parameters in this cluster have small variance, so only height determines their different character.","f64d7b43":"Lowest part of the cluster contains objets with middle distance between them.","0bb01589":"Data consists of six columns.\n\nFirst three columns are connected with the measurement parameters (in sequence: section = search field ID, ID = measurement ID, section_area = search field area in hectares).\nLast three columns are connected with the shafts parameters (in sequence: object_area = area of the form (embankment + shaft) in square meters, rel_height = relative height of the embankment around the shaft in meters, object_dostance = distance between shafs (holes) in meters.\n\nMore information is in the data description in Public Dataset.","1badb53d":"Outlier part within section 4 is the cluster with objects located far away from each other. It is the right part of the section 4 on the distance map.","06c2b616":"That was all! I hope you enjoyed this simple approach to the task, I would be happy for any suggestions and thoughts.","4b3e3aa0":"First plot shows distance map between neurons. Markers correspond to the section IDs. SOM clustered shafts rather according to their origin in the terrain, including some exeptions of course. Blank spaces between markers can be interpret as borders between clusters, where bright color means very strong border and darker means border, which is not so defined.\n\nSo, red point could be interpret as the outlier in the data, group of dark green squares and blue diamonds are also strongly different from the other data. Other clusters are mixed, so there are similarities between them. I will check this hypothesis later.","797742a9":"4. Yellow X marked as research field 4 on the distance maps, are divided into 3 clusters.","28ac7b13":"To summarize: Self-Organizing Map clusters with strong borders are the most different chunks of the data. That means section 0, 2, 3 differ from each other and from the rest of the dataset the most. Section 0 is highest object with only one shaft, section 2 contains high, regular spread shafts and section 3 contains high objects, randomly distributed across the terrain.\n\nOther clusters are more similar to each other. Section 4 is divided into three parts, as there are shaft with long, medium and short distance between them. But, whole section 4 is similar to the section 3 in its character.\n\nSection 5 looks almost identical to the section 6 for our SOM. Outliers from section 7 and 8 also share one cluster in the distance map.\n\nThe conclusion is - last measurements with small objects near to each other are very similar, where first measurements differ strongly in their height, area and arrangement in the terrain.","6e273a9b":"To create SOM, I used all data, referring to the measurements and, additionally, research field area, as it carries information about shafts density and arrangement.","1708c0bc":"Third plot, the same, as previous, with addition of the following measurement IDs.","8696c8b1":"I standardarized the data, to unify units (hectares and meters).","ab92b7aa":"6. Fuchsia hexagon cluster, marked as research field 7, is one cluster with only one object, assigned by a SOM as a strong outlier. Measurement of the ID 120 is far away from other shafts and that was the determinant of the outlying.","bd7650a9":"And that is the reason for the scattered character of the cluster. The right part of the cluster contains objects with the long distance between them, with the longest values in the upper right part.","f2386fa8":"This kernel shows my implementation of the Self-Organizing Map on the Mining shafts in Poland dataset. The problem I was trying to solve was to find out classes of the shafts, based on their arrangement in the terrain. I was asked to look for similarities of the shaft classes, check if there are any differences between them etc. This information could be used as a guideline for historical origin of the shafts.","42d2b574":"5. Cyan triangle and orange cross sections are mixed and assigned by our SOM into one cluster. Those objects have similar parameters, with smaller objects located in the left part of the cluster and bigger in the right part of the cluster.","6f7f9b18":"The data is dual - there are objects very close to each other and objects far away from each other.","edcada42":"Cluster, which is upper part of the section 4, consists of objects, distributed very closely in the terrain.","fe44502d":"3. Blue diamonds is the cluster, which is also readable, but it is more scattered, than previous ones. The objects inside the cluster have similar area and they are also rather high. That, what differs them, is variance in the object arrangement in the terrain. This group is arranged more irregular.","1ef4c909":"Let's test out hypothesis.\n\n1. Outlier red circle, which is measurement ID 0 from research field 1, has obviously different parameters from the other measurements.","54173fd1":"Second plot, with markers corresponding to section ID. I reversed colors of the distance map for beter readability of the plot. Legend shows markers, which are assigned to the section IDs.","364beecb":"Finally, I trained simple SOM on not much tuned parameters. Training is just a second.","1cf7f125":"Below, I subtracted section ID and measurement ID for further plotting purposes.","0ad6f22d":"And the left part of the cluster contains objects with short distance between them.","92321808":"Cluster, which is lower part of the section 4, contains objects with medium distance between them.","7649c84f":"Firstly, import part. I used PyPI MiniSom package for SOM."}}