{"cell_type":{"65cff39e":"code","c2aca232":"code","66ec21c6":"code","a45adc11":"code","82f4ed00":"code","bd365c61":"code","654f963e":"code","9417e5d9":"code","719d5f11":"code","f1c099fc":"code","e42af3bc":"code","9565eb22":"code","e8d70401":"code","cb3b4e17":"code","743114b8":"code","8f263e0e":"code","03d30f69":"code","b514f435":"code","d9ed7b16":"code","9630ee52":"code","fa42da84":"code","cdcfb46f":"code","41a4c7f6":"code","9d098238":"code","a044e490":"code","b9253a70":"code","44611008":"code","396ee9bb":"code","ac21236f":"code","15b96589":"code","04a536b3":"code","088f8fb6":"code","fd01a041":"code","091ca7cc":"code","17930858":"code","674d9c1b":"code","73617d45":"code","58b10c53":"code","346b0e22":"code","7e30a76a":"code","5fbdc6a1":"code","f402c958":"code","3754e5a4":"code","9b04fddc":"code","a16d9cab":"code","1a042673":"code","c455f72a":"code","de3c5ab9":"markdown","b6eef3af":"markdown","4d4a342a":"markdown","b920b14b":"markdown","9ce75758":"markdown","1c251145":"markdown","88ba1386":"markdown","ab2ae443":"markdown","75813684":"markdown","134b29f9":"markdown","a6334b23":"markdown","f04ad648":"markdown","04866d99":"markdown","4465a442":"markdown","36804a7f":"markdown","cc772167":"markdown","55fccae6":"markdown","4a926479":"markdown","7e6897b4":"markdown","9d03176c":"markdown","90f2a43c":"markdown","2f2e7504":"markdown","137de2dc":"markdown","f72da40d":"markdown","151beb13":"markdown","f3466324":"markdown","749ed03c":"markdown","a6263d40":"markdown","18eb1c0f":"markdown","a71e7ac0":"markdown","0eabb50d":"markdown","e5acf05a":"markdown","e57a4333":"markdown","4137a85b":"markdown","e5e10923":"markdown","bc1afa99":"markdown","9e358736":"markdown","14b41307":"markdown","26c2b2c3":"markdown","5fb4eefd":"markdown","3b1af7ab":"markdown","4e5f1222":"markdown","0d2fd422":"markdown","1a7e0f22":"markdown","618b0d31":"markdown","22936f0f":"markdown","28c36f46":"markdown"},"source":{"65cff39e":"import pandas as pd\nimport re\nimport random\nimport os","c2aca232":"for dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","66ec21c6":"data = pd.read_csv('..\/input\/global-shark-attacks\/GSAF5.csv', encoding=\"latin-1\")\ndata.head()","a45adc11":"data.shape","82f4ed00":"data.columns","bd365c61":"data.dtypes","654f963e":"null_cols = data.isnull().sum()\nnull_cols[null_cols > 0]","9417e5d9":"data['Unnamed: 22'].fillna(0, inplace=True)\n[x for x in data['Unnamed: 22'] if x!=0]","719d5f11":"data['Unnamed: 23'].fillna(0, inplace=True)\n[y for y in data['Unnamed: 23'] if y!=0]","f1c099fc":"data['Case Number.1'].equals(data['Case Number.2'].equals(data['Case Number']))","e42af3bc":"data['Case Number.1'].equals(data['Case Number.2'])","9565eb22":"data['Case Number.1'].isin(data['Case Number.2']).value_counts()\n","e8d70401":"data['Case Number'].equals(data['Case Number.1'])","cb3b4e17":"data['Case Number'].isin(data['Case Number.1']).value_counts()","743114b8":"data['href formula'].equals(data['href'])","8f263e0e":"data['href formula'].isin(data['href']).value_counts()","03d30f69":"data = data.drop([\"Unnamed: 22\", \"Unnamed: 23\",\"Case Number.1\",\"Case Number.2\",\"Time\",\n                  \"href formula\",'pdf','original order'], axis=1)\ndata.head()","b514f435":"set(data['Date'].sample(n=30))","d9ed7b16":"len(set(data['Date']))","9630ee52":"try:\n    data['Year_']=[d[0:4] for d in data['Case Number']]\nexcept:\n    data['Year_']='00'\ntry:\n    data['Month']=[d[5:7] for d in data['Case Number']]\nexcept:\n    data['Month']='00'\ntry:\n    data['Day']=[d[8:10] for d in data['Case Number']]\nexcept:\n    data['Day']='00'\ndata.loc[data['Year_'].str.contains('(?i)ND'),'Year_']='00'\ndata.loc[data['Year_'].str.contains('ND'),'Day']='00'\ndata.loc[data['Year_'].str.contains('ND'),'Month']='00'\ndata['Year_'] = data['Year_'].replace(['0.02','0.03','0.04','0.07'],0)\ndata['Year_'] = data['Year_'].astype(int)\ndata = data[['Case Number','Day','Month','Year_','Year','Date','Type','Country','Area','Location','Activity','Name',\n           'Sex ','Age','Injury','Fatal (Y\/N)','Species ','Investigator or Source','href']]\ndata.sample(n=10)","fa42da84":"data[['Year','Year_']].sample(n=20)","cdcfb46f":"data['test'] = data['Year_']==(data['Year'])\ndata['test'].value_counts()","41a4c7f6":"data.loc[data['Year_']!=(data['Year'])]","9d098238":"data.loc[4983,'Year']=1923\ndata.loc[3662,'Year']=1961\ndata.loc[2449,'Year']=1989","a044e490":"data.rename(columns={'Date': 'Date comment'}, inplace=True)","b9253a70":"set(data['Fatal (Y\/N)'])","44611008":"data['Fatal (Y\/N)'] = data['Fatal (Y\/N)'].str.strip()\ndata['Fatal (Y\/N)'] = data['Fatal (Y\/N)'].fillna('U')\ndata['Fatal (Y\/N)'] = data['Fatal (Y\/N)'].str.replace('n', 'N')\ndata['Fatal (Y\/N)'] = data['Fatal (Y\/N)'].str.replace('#VALUE!', 'U')\ndata['Fatal (Y\/N)'] = data['Fatal (Y\/N)'].str.replace('F', 'Y')\ndata['Fatal (Y\/N)'] = data['Fatal (Y\/N)'].str.replace('UNKNOWN', 'U')\ndata.rename(columns={'Fatal (Y\/N)': 'Fatal (Y\/N\/U)'}, inplace=True)\nprint(set(data['Fatal (Y\/N\/U)']))","396ee9bb":"data['Number of victims']=data['Name']\ndata['Number of victims'].fillna('Unknown', inplace=True)\ndata.head()","ac21236f":"\nunknown=['boat','All on board perished in the crash','a charter fishing boat with James Whiteside and his party','6 m skiboat, occupants: P.A. Reeder & crew','6 m boat, occupants John Winslet & customers','5.4 m boat','5 m skiboat',\"\"\"40' fishing cutter\"\"\",\"40' bonito boat\",\"4 boats\",\"\"\"30' cabin cruiser owned by Stefano Catalani\"\"\",\"25-foot cutter\",\"\"\"25' cutter\"\"\",\"\"\"25' rigid-hulled inflatable boat, HI-2\"\"\",\"\"\"24' yacht owened by  C.L. Whitrow\"\"\",\"\"\"22' pleasure boat\"\"\",\"\"\"20' boat of Frank Stocker\"\"\",'2 USAF 4-engine planes (an HC-54 & a HC-97) each with 12 onboard collided in mid-air at low altitude and plunged into the Atlantic Ocean',\"2 boats\",\"\"\"18' boat of Morris Vorenberg\"\"\",\"\"\"16' launch\"\"\",\"\"\"16' cabin cruiser with 35 hp outboard motor\"\"\",\"\"\"15' boat\"\"\",\"\"\"14' boat, occupant: Jonathan Leodorn\"\"\",'14-foot boat Sintra',\"\"\"12' dinghy\"\"\",\"\"\"12' boat of Alf Laundy\"\"\",'10m boat Lucky Jim',\"\"\"10' dinghy\"\"\",'10.7 m boat. Occupants: John Capella & friends','Because of a mistaken belief that there were no survivors and several other successive errors, of the 100 to 150 men who survived the sinking, only 11 were rescued. Four of the Sullivan brothers died in the initial blast. ','boat','boat  Marie',\"\"\"Boat \u201cCoca Cola\u201d\"\"\",\"boat crew\",\"boat Live N Hope\",\"boat of Al Hattersly\",\"\"\"Boat of Captain Forman White,\"boat of Scot's College rowers\"\"\",\"boat of Thomas Baker\",\"boat of Wally Gibbons\",\"Boat owned by Ricardo Laneiro\",\"Boat with tourists onboard\",\"boat x 2\",'boat, occupants, P. Groenwald and others','boat, occupants: Jacob Kruger & crew','boat: Lady Charlotte, occupants: C. McSporran & his crew','Crew of Anti-submarine Squadron 23','crew','Haitian refugees perished when their boat capsized in choppy seas','males','males (wearing armor)','males, shark fishermen','mate & crew','multiple bathers','multiple boats including B.J. C. Brunt','No details','Occupants of skin boats','Passenger & crew','Passenger ferry Norman Atlantic','passenger in an automobile','pilot boat, occupants; Captain McAlister & crew','rowboat, ','rowboat, occupants: refugees fleeing Cuba','rowboats attacked by sharks','sailors','several Somali children','Severed human foot washed ashore (in sneaker with 2 Velcro closures)','ski-boat','skiboat','skiff, occupants: Russel J. Coles and others','slaves','surf patrol boat','Theodore Anderson\u2019s captain & rest of crew taken by sharks']\nzero_pers=['Jeff Wells claimed he rescued his \"daughter\" from a 4 m tiger shark']\none_pers=['After 2 days, Ann Dumas, 7,5 months pregnant, died of exposure & exhaution& her body was lashed to raft.','7.2 m boat. Occupant Kelvin Travers','5.75 m wooden boat, occupant: Yoshaiaki Ueda','5.4 m boat, occupant: Ivan Anderton','5 m skiboat; Stephanie','4.9 m fibreglass boat. Occupant: Jack Siverling',\"\"\"4.5 m boat, occupant: Rodney Lawn\"\"\",\"4.3 m skiff, occupant: Bob Shay\",\"4-m runabout. Occupant: Allen Gade\",\"\"\"24' boat Shark Tagger Occupant Keith Poe\"\"\",\"22-ft boat.  Occupant Captain Scott Fitzgerald\",\"\"\"17' boat, occupant:  Richard Wade\"\"\",\"\"\"16' skiff, occupant: W.A. Starck, II\"\"\",\"\"\"16' Dreamcatcher. Occupant: Ian Bussus\"\"\",\"\"\"16' boat, occupant: W. Lonergan\"\"\",\"\"\"15-foot boat: occupant Woodrow Smith\"\"\",\"\"\"14' catamaran, occupant: M. Leverenz\"\"\",\"\"\"12' skiff, occupant: E.R.F. Johnson\"\"\",\"\"\"12' boat Sio Ag, occupant: John Riding\"\"\",'12 m fishing boat. Occupant: Henry Tervo',\"\"\"10' rowboat, occupant: John Stephensen\"\"\",'British sailor from the  F-107','Arthur E. Taylor, a navy diver & member+G1053 of a 24-man demolition team',\"\"\"boat: 48' charter boat  GonFishin V\"\"\",\"\"\"boat: 69.5' trawler Christy Nichole\"\"\",'British sailor from the  F-107','Robert W. McGhee, Private 1st Class, 8th Infantry','Sailor of tuna vessel No.12 Taiyo Marei','U.S. soldier in 161st Infantry Regiment, 25th Infantry Division','William Mills, a British solider, 36th Regiment']\ntwo_pers=['a male & a female','a launch, occupants- Albert Cree & John Blacksall','8m inflatable boat. Occupants: Bhad Battle & Kevin Overmeyer','7 m boat, occupants: Tara Remington & Iain Rudkin','6 m boat: occupants  Stephen & Andrew Crust','5.4 m fibreglass boat, occupants: Robert & James Hogg','5 m skiboat Stephanie, occupants: Fanie Schoeman and Brigadier Bronkhorst','5 m skiboat Graanjan, occupants: Rudy van Graan, Jan de Waal Lombard','5 m boat, occupants: Don & Margaret Stubbs','5 m aluminum dinghy - occupants Mr. & Mrs. Paul Vickery',\"\"\"4.3 m skiff: occupants: James L. Randles, Jr. & James Myers\"\"\",\"\"\"35' motor launch, occupants: Bill Fulham & T. Fanning\"\"\",\"\"\"35' cruiser, Maluka II, occupants: Mr & Mrs E. Potts\"\"\",\"\"\"3.5 -metre fibreglass boat, occupants: Harry Ulbrich and another fisherman\"\"\",\"\"\"28' sea skiff, occupants: Alan Moree and another fisherman\"\"\",\"\"\"22' boat, occupants: Saul White & Charles Dillione\"\"\",\"\"\"20' boat; occupants: John Wright & a friend  \"\"\",\"\"\"19' clinker-built craft. Occupants: Ray Peckham & Mr. L.C. Wells\"\"\",\"\"\"19' boat, occupants: Ray Peckham, L.C. Wells\"\"\",\"\"\"18' launch, occupants: 2 fishermen\"\"\",\"\"\"18' boat, occupants William & Leslie Newton\"\"\",\"\"\"18' boat, occupants Richard Gunther & Donald Cavanaugh\"\"\",\"\"\"18 hp Boston Whaler boat, occupant: G. W. Bane, Jr.\"\"\",\"\"\"17' fishing launch, occupants: A. Burkitt & C. Brooke\"\"\",\"\"\"17' fishing boat; occupants 2 men\"\"\",\"\"\"16' motor launch owned by A. & E. Norton\"\"\",\"\"\"14' open boat: occupants Richard Crew & Bob Thatcher\"\"\",\"\"\"14' dinghy, 2 occupants\"\"\",\"\"\"14' boat, occupants: 2 men\"\"\",\"\"\"12' to 14' dory, occupants: John D. Burns & John MacLeod\"\"\",\"\"\"12' ski, occupants: Bill Dyer & Cliff Burgess \"\"\",\"\"\"12' open motor boat, occupants Jack Platt & Peter Keyes\"\"\",\"\"\"12' boat,           2 occupants\"\"\",'12-foot dinghy Occupants: R. Hunt & a friend.',\"\"\"11.6 m fibreglass boat. Occupants: Tony DeCriston & Dan Fink\"\"\",\"\"\"10' skiff. Occupants F. Whitehead & L. Honeybone\"\"\",\"\"\"10' row boat occupants;  Douglas Richards & George Irwin\"\"\",'boat, occupants:  Andrew Peterson & Peter Jergerson','boat, occupants:  Mike Taylor & his son, Jack, age 9','boat, occupants: Alf Dean, Jack Hood & Otto Bells','boat, occupants: Boyd Rutherford & Hamish Roper','boat, occupants: C. Nardelli & son','boat, occupants: John Griffiths & Thomas Johnson','boat, occupants: P.D. Neilly & Charlton Anderson','boat, Occupants: William Smith & Thomas Martin','boat; occupants: T & G Longhi','boat:  occupants: Nazzareno Zammit & Emmanuel',\"\"\"Boat: 14' Sunfish. Occupants Josh Long &  Troy Driscoll'\"\"\",'Boat: occupants: David Lock & his father','Boat: occupants: Tim Watson & Allan de Sylva','Bombardier J. Hall, Private Green of the Sherwood Foresters & Captain C. O. Jennings, R.E. Anti-tank Regiment','Brian Sierakowski & Barney Hanrahan','Bruce Flynn & his dive buddy','canoe, occupants: Chris Newman & Stewart Newman','canoe. Occupants: Doreen Tyrell & Frederick Bates','Captain Baxter & Dick Chares','Carlos Humberto Mendez & Esteban Robles','Colleen Chamberlin & Scott Chamberlin','Colonel B. & Sub-Lieutenant D.','Conway Plough &  Dr. Jonathan Higgs','crayfish boat. Occupants: Dave & Mitchell Duperouzel:','Curran See & Harry Lake','Dave Hamilton-Brown & Ant Rowan','dinghy, occupants: aborigine & lighthouse keeper','dinghy, occupants: Willem & Jan Groenwald','Dinghy. Occupants: Jeff Kurr and Andy Casagrande','Earl Yager & Riley McLachlan','Elena Hodgson & Isaac Ollis','Emil Uhlbrecht & unidentified person','Ensio Tiira & Fred Ericsson, deserters from the French Foreign Legion','Fishing boat. Occupants: Yunus Potur & Ali Durmaz','Gene Franken & Maurice McGregor','hobiecat, occupants: Judy Lambert  & a friend','Ida Parker & Kristen Orr','inflatable boat, occupants: Rudolf Bokelmann and Sakkie Vermeulen','inflatable dinghy, occupants: Ben Cropp, J. Harding & T. Fleischman','inflatable dinghy, occupants: Craig Ward & Gavin John Halse','\"Inflatable kayak Occupants:  Andrej Kultan & Steve Hopkins.\"',\"\"\"inflatable rescue boat. Occupants: Lauren Johnson &. Kris O'Neill\"\"\",'J.T. Hales and Kenneth J. Hislop, Australian Navy frogmen','James C. Beason & Calvin E. Smith, Jr.  spent 16 hours in life raft','John Parker & Edward Matthews','Juan & Alex Bueno','Karl Pollerer & Eric Eisesenid','Lobster boat, occupants: Mr. P. Valentine & Mr. J. van Schalkwyk ','Louis Zamperini  & Russell Phillips','Mayabrit, an ocean rowing boat. Occupants: Andrew Barnett & J.C.S. Brendana','Monte Robinson & Andrew McNeill','Mr. Child & a Kanaka','Ned & Pawn','Nicaso Balanoba & Julian Dona','Occupants: Ivan Angjus & Stevo Kentera','occupants: John Chandler & Walter Winters','Occupants: Luke Jones & James Sequin','Occupants: Scott & John Fulton','Philip Case & William B. Gray','plywood dinghy, occupants: Jack Deegan & Trevor Millett','Pollione Perrini & Fioravante Perini','rowboat, occupants: Bob Scott & John Blackwell ','rowboat, occupants: James Mitchell-Hedges & Raymond McHenry','Salvatore & Agostino Bugeja','Sgt James Lacasse & Sgt David Milsten, USAF divers','skiboat, occupants: Danie & Fanie Schoeman','skiff with Dr. William T. Healey, Dr. Henry Callahan on board','skiff, occupants: J. & A. Ayerst','Teresea Britton (on raft) & a man (on floating debris)','Tony Moolman and another surfer','Two stowaways on German steamer Vela','Waade Madigan and Dr Seyong Kim','wooden boat, occupants: Jack Bullman & Keith Campbell']\nthree_pers=['Andong & 2 others','a skill. Occupants George Lunsford & 2 companions','6 m skiboat, occupants: Terry McManus, Dan Clark and Blackie Swart','6 m Seaduce - Occupants: Allen Roberts, Jason Savage & Rob Lindsay.','6 m boat Suki Saki, occupants: E.C. Landells & 2 friends','5.5 m fibreglass boat, occupants: Steven Piggott and Kelvin & Brendan Martin','5 m aluminum boat, occupants: Ben Turnbull, Lia & Neville Parker',\"\"\"4 m dinghy, occupants: Cecil Holmes, Chris Augustyn & Allen Varley \"\"\",\"3.8-m boat with 3 people on board\",\"\"\"21' boat sank. Occupants: Max Butcher, George Hardy & Peter Thorne\"\"\",\"2.4 m rowboat, occupants: Edgar Brown, Jerry Welz & Cornelius  Stakenburg\",\"\"\"17' fishing boat. Occupants, Bubba DeMaurice, his wife & daughter\"\"\",\"\"\"13' dinghy, occupant S. Smith, Leenee Dee & Marie Farmer   \"\"\",\"\"\"12' boat. Occupants:  Capt. E.J. Wines, Maj. W. Waller & Larry Waller\"\"\",'boat, occupants; Carl Sjoistrom & 2 other crew','boat, occupants:  Nels Jacobson & Franklin Harriman Covert','boat, occupants: Captains Charles Anderson, Emit Lindberg & Oscar Benson','Boat: occupants: Matt Mitchell & 2 other people','Burgess & 2 seamen','Captain Angus Brown, his son & brother','Captain Eric Hunt, the cook & a French passenger','catboat. Occupants: Captain Tuppe & 2 young ladiesr','Chris Haenga, Wayne Rangihuna  & Tamahau Tibble','D. R. Nelson, J. Greenberg & S.H. Gruber','Fishing boat  Bingo III , occupants: Michael Perkins, George Hornack & Capt. Lonergan ','\"Fishing boat.   occupants: Laz H\u00fcseyin, Ali Osman & Tursun \"','Josh Francou, Michael Brister & Paul Bahr','launch, occupant Clive Whitrow, Dick Kuhne & Jim Pergola','Motor boat, occupants: Quintus Du Toit, J.H. van Heerden & J.P. Marais','Occupants: Andrew & Ben Donegan & Joel Ryan, ','Occupants: Jack Munro, Quinton Graham & Donald Shadler','open boat, occupants: Robert Ruark, Hoyle Dosher & Elmer Adkins','Rowgirls, an ocean rowing boat. Occupants: Sally Kettle, Claire Mills & Sue McMillan','Storm King; occupants - George Bridge & 2 sons','William Clinton Carter, Jr. & 2 other men']\nfour_pers=[\"\"\"A 'tinnie\". Occupants :Paul Sweeny, Paul Nieuwkerdk, John and Mark Kik \"\"\",'7 m skiboat Alrehmah III, occupants: Adolph Schlechter & 3 friends','6 m skiboat, occupants: Alex Mamacos, Noel Glintenkamp, Tony Mountifield & Dillon Alexandra','4.8 m skiboat, occupants: C. Cockroft & 3 men','16-foot launch, occupants: George Casey, Jack Byrnes, Julian Reynolds & Denny Laverty','Bry & David Mossman & 2 friends','Claude Hadley, William Grundy, Albert Faulkner & Frederick Faulkner','Fishing vessel. Occupants Gerry Malabago, Mark Anthony Malabago & 2 others','Inflatable dinghy, occupants: Jasmine Wigley, Greg Wilkie, Phil Rourke & Fleur Anderson','Mini Haa Haar, fiberglass boat, occupants: William Catton, Anthony Green, Tony & Kylie Barnes','rowboat, occupant: Joe Whitted, Christopher Quevedo & 2 Willard Brothers','skiboat, occupants: Gustav Boettger, Clive Mason, Keith Murrison & Sweis Olivier','William Olsen, William Peterson, Albert Thomas & R. Zekoski']\nfive_pers=['Albert Battles, James Dean & 4 crew','4.8-metre skiboat, Occupants: Rod Salm & 4 friends','boat of Dennis Kemp & 4 other occupants','boat Sea Hawk, occupants: R. Roberts & 4 others','boat, occupants:  Mr. Goslin & 4 passengers','Crew of aircraft: McGreevy, Beakley, Rosenthal, Ryan & Hodge','fishing boat, occupants: Simon Hlope & 4 other men','skiboat Double One, occupants: Anton & Michelle Gets, Ray Whitaker, John & Lyn Palmer','surf boat, occupants: Ray Sturdy and 4 other fishermen']\nsix_pers=['7 m fishing boat Metoo, occupants: Nicky & Paul Goles & 4 friends','6 m catamaran, occupants: Peter Robertson, Beauchamp Robertson, Gerald Spence & 3 crew','5 m inflatable boat, occupants: Kobus Potgieter & 5 friends',\"\"\"4.8 m  boat Peggy, occupants: John Oktober, L.A. van Zyl and 4 others\"\"\",'dinghy, occupants: T. Shipston, T. Whitta, L Cox, T. Jones, R. Genet & W. Pearce','motor boat, occupants: Mr. & Mrs. Sidney M. Colgate and their three children, Bayard, Caroline and Margaret ','Occupants: Hamza Humaid Al Sahra\u2019a & 5 crew',\"\"\"Paul Timothy Lovette, Dr. Neal Beardsley, James C. Russell, Harold H. Mackie, Dale Howard & Diego J. Terres on 42' Navy craft, Marie\"\"\"]\nseven_pers=['boat, occupants: Joseph Fitzback & 6 passengers','The June, occupants Bunny Pendelbury and crew of 6']\neight_pers=['Wes Wiggins and 7 others on the boat, Sparetime','7.5 m boat, occupants: 8 men','8 US airmen in the water, 1 was bitten by a shark']\nfor u in unknown:\n    data['Number of victims']=data['Number of victims'].replace(u,'Unknown')\nfor one in one_pers:\n    data['Number of victims']=data['Number of victims'].replace(one,1)\nfor two in two_pers:\n    data['Number of victims']=data['Number of victims'].replace(two,2)\nfor three in three_pers:\n    data['Number of victims']=data['Number of victims'].replace(three,3)\nfor four in four_pers:\n    data['Number of victims']=data['Number of victims'].replace(four,4)\nfor five in five_pers:\n    data['Number of victims']=data['Number of victims'].replace(five,5)\nfor six in six_pers:\n    data['Number of victims']=data['Number of victims'].replace(six,6)\nfor seven in seven_pers:\n    data['Number of victims']=data['Number of victims'].replace(seven,7)\nfor eight in eight_pers:\n    data['Number of victims']=data['Number of victims'].replace(eight,8)\ndata['Number of victims']=data['Number of victims'].replace('boat Swift, occupants: Dolly Samuels & 8 other men',9)\ndata['Number of victims']=data['Number of victims'].replace('\"21 m sportfishing vessel Seabiscuit. Occupants: Captain Louie Abbott & 2 dozen anglers\"',25)\ndata['Number of victims']=data['Number of victims'].replace('\"\"\"15 Royal Canadian Airforce crew & 1 passenger\"\"\"',16)\ndata['Number of victims']=data['Number of victims'].replace('135 passengers & 13 crew',148)\ndata['Number of victims']=data['Number of victims'].replace('No survivors. 189 people were lost',295)\ndata['Number of victims']=data['Number of victims'].replace('Most were women & children',42)\ndata['Number of victims']=data['Number of victims'].replace('Mamerto Daanong, Tomas Inog & others',92)\ndata['Number of victims']=data['Number of victims'].replace('male + 20',21)\ndata['Number of victims']=data['Number of victims'].replace('At least 29 (and possibly another 71) Somali & Ethiopian refugees',90)\ndata['Number of victims']=data['Number of victims'].str.extract('(\\d+)')","15b96589":"data['Number of victims'].fillna(1, inplace=True)\ndata['Number of victims']=data['Number of victims'].astype(int)\nset(data['Number of victims'])","04a536b3":"set(data['Name'].sample(n=40))","088f8fb6":"data.rename(columns={'Sex ': 'Sex'}, inplace=True)\ndata.columns = data.columns.str.strip()","fd01a041":"def correct_name(row):\n    if row[\"Name\"] == \"girl\" or row[\"Name\"] == \"Girl\":\n        return \"F\"\n    elif row[\"Name\"] == \"boy\" or row[\"Name\"] == \"Boy\":\n        return \"M\"\n    elif row[\"Name\"] == \"male\" or row[\"Name\"] == \"Male\":\n        return \"M\"\n    elif row[\"Name\"] == \"female\" or row[\"Name\"] == \"Female\":\n        return \"F\"    \n    else:\n        return\n    \ndata[\"name_corrected\"] = data.apply(correct_name, axis=1)\ndata['Sex'].fillna(data.name_corrected, inplace=True)","091ca7cc":"def error_sex(row):\n    if row['name_corrected']=='F':\n        return 'F'\n    elif row['name_corrected']=='M':\n        return 'M'\n    else:\n        return row['Sex']\ndata['Sex']=data.apply(error_sex, axis=1)","17930858":"set(data['Sex'])","674d9c1b":"data['Sex'] = data['Sex'].str.replace('N', 'M')\ndata['Sex'] = data['Sex'].str.strip()\ndata['Sex'] = data['Sex'].fillna('Unknown')\ndata['Sex'] = data['Sex'].str.replace('lli', 'Unknown')\ndata['Sex'] = data['Sex'].str.replace('.', 'Unknown')\nset(data['Sex'])","73617d45":"data['Name'].fillna('Unknown', inplace=True)\ndata.loc[data['Name'].str.contains('male',na=False),'Name']='Unknown'\ndata.loc[data['Name'].str.contains('boy',na=False),'Name']='Unknown'\ndata.loc[data['Name'].str.contains('female',na=False),'Name']='Unknown'\ndata['Name']=data['Name'].str.replace('Anonymous','Unknown')\ndata['Name']=data['Name'].str.replace('Male','Unknown')\ndata['Name']=data['Name'].str.replace('fisherman','Unknown')\ndata['Name']=data['Name'].str.replace('Female','Unknown')\ndata['Name']=data['Name'].str.replace('crewman','Unknown')\ndata['Name']=data['Name'].str.replace('a young Scotsman','Unknown')\ndata['Name']=data['Name'].str.replace('a native ','')\ndata['Name'] = data['Name'].replace('\\s+', ' ', regex=True)","58b10c53":"set(data['Type'])","346b0e22":"data['Type'] = data['Type'].str.strip()\ndata['Type'] = data['Type'].str.replace('Boating','Boat')\ndata['Type'] = data['Type'].str.replace('Invalid','Unknown')\nprint(set(data['Type']))","7e30a76a":"print(set(data['Country']))","5fbdc6a1":"data['Country'].fillna('Unknown', inplace=True)\ndata['Country'] = data['Country'].str.strip().str.upper()\nprint(set(data['Country']))","f402c958":"print(set(data['Species'].sample(n=20)))","3754e5a4":"data['Species'].fillna('Unknown', inplace=True)","9b04fddc":"data.drop(['Year_','name_corrected','test'], axis=1, inplace=True)","a16d9cab":"data.head()","1a042673":"data = data[['Case Number','Day','Month','Year','Date comment','Type','Country','Area','Location','Activity','Name','Sex','Age','Injury','Fatal (Y\/N\/U)','Number of victims','Species','Investigator or Source','href']]","c455f72a":"data.to_csv('GSAF5_clean.csv', index=False)","de3c5ab9":"After reading the web page associated, I retrieve the correct date and correct it in the \"Year\" column. Typos and mistakes are current in dataset. Data cleaning must always rely on every rows' informations. ","b6eef3af":"The columns \"Unnamed: 22\" and \"Unnamed: 23\" are curious and mostly empty. Let's examine what they contain.**","4d4a342a":"#### \"Species\" column ","b920b14b":"I think the sex informations have no place in the \"Name\" column, so I delete them by 'Unknown'","9ce75758":"The two columns seems similar, but are they really ?","1c251145":"#### \"Country' column ","88ba1386":"After checking how many values are different (10),I chose to delete this column. Moreover, it does not contain information I can use for deeper analysis.\n<br>I do the same process for \"Case Number\" and \"Case Number.1\".","ab2ae443":"The cleaning part is complete, let's now reorder the columns and save the dataset on a new file !","75813684":"#### \"Fatal\" column","134b29f9":"#### A new column : \"Number of victims\"","a6334b23":"#### \"Date\" column","f04ad648":"It seems that 5 cells are different. Let's examine them.","04866d99":"The result is the same as before, I will delete this column.\n<br> Finally, I examine the ressemblance of \"href formula\" and \"href\". Are they duplicate ?","4465a442":"Finally, let's delete our test columns.","36804a7f":"#### \"Type\"  column","cc772167":"There is less than 10% difference between the column, I choose to keep the column \"href\".","55fccae6":"A little cleaning is necessary.","4a926479":"### Columns cleaning ","7e6897b4":"After that, let's clean the various spellings of sex present in the \"Name\" column and extract them in another column named \"name_corrected\" and fill the empty cells of \"Sex\"","9d03176c":"Let's now examine the \"Fatal (Y\/N)' column. It's important because it will inform us of the proportion of attack that were fatal.","90f2a43c":"Well, it seems that the column contains a lot of unique values but also in many different format. \n<br> After many tries, I found that cleaning this column cell by cell was too much of a job. Incidentally, I saw that the column \"Case Number\" had a format that contains the date recorded (except for the unknown dat, labelled ND). I use this column to create 3 columns with the date info (year, month, day). The column \"Year1\" will be useful to see if this process worked by comparing it with the existing column \"Year\".","2f2e7504":"To prepare the Data cleaning, let's check how many empty cells there are in every column.","137de2dc":"Let's clean these values. As the value UNKNOWN is pertinent, I chose to keep it and rename the column ('Fatal (Y\/N\/U)')","f72da40d":"Surprinsingly, the 'Type' column is almost clean !","151beb13":"### Import and quick look at the dataset","f3466324":"This column is also fairly clean. Let's just transform every lower case name to upper case.","749ed03c":"### <center>The cleaning process is the most time consuming task of a Data analyst but it is essential.<br><br> This is my first Kaggle kernel, please upvote, your support is my best motivation!<br> <\/center>","a6263d40":"I create a column \"Number of victims\" based on column \"Name\" because it is the only one that really gives the number of person attacked at each event.","18eb1c0f":"### Reordering and recording ","a71e7ac0":"As all the non empty cells does not contain any important information, I delete them.\n<br> Next, I thought that the column \"Case Number.2\" could be a duplicate of \"Case Number\" and \"Case Number .1\"","0eabb50d":"Apparently it's not the case. Let's dig a little deeper and examine if \"Case Number.1\" is similar to \"Case Number.2\"...","e5acf05a":"This column needs a big cleaning but its informations are not pertinent for an analysis in my opinion. I decide to clean it just a little by filling the empty cells with 'Unknown'.","e57a4333":"The original \"Date\" column will be be more explicit if it's called \"Date comment\".","4137a85b":"I think the \"Date\" column is important for an analysis. Let's check what it contains..","e5e10923":"#### \"Name\" column","bc1afa99":"Except the \"Year\" and \"original order\" columns, all the others contain texts.","9e358736":"Shape and features","14b41307":"Now, let's deduct the number of victim by the informations present in the column. I focused ont the cells that contained several names or an entire phrase.","26c2b2c3":"Let's check if these informations could help filling the empty cells of the \"Sex\" column.\n<br> First, there is something we <b>really<\/b> don't like in Data cleaning : a space in the column's name! Let's clean every columns' name to be sure.","5fb4eefd":"Finally, let's check the data in the \"Sex\" column","3b1af7ab":"After creating this new column, I notice that in the \"Name\" column there is some informations that should be in the \"Sex\" column.","4e5f1222":"Let's see if the two \"Year\" columns match...","0d2fd422":"### <center>Cleaning data is obligatory for Data analysis.<br>Le's see what we can do with one of the most famous dataset : Shark attacks !<\/center> ","1a7e0f22":"Unfortunately, the data on the \"name_corrected\" column seems to contradict some of the \"Sex\" column... I choose to state that the \"Name\" column contains the true data and change the data on the \"Sex\" column accordingly.","618b0d31":"Now that the 'exceptions' are corrected, I fill the remaining cells by 1 because they contain the name of only 1 person.","22936f0f":"# <center>Data cleaning project<\/center><br><center><img src=\"https:\/\/thumbs.gfycat.com\/ViciousBowedGoa.webp\" width=100><\/center>","28c36f46":"### Data cleaning "}}