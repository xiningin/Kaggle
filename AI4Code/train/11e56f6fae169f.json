{"cell_type":{"a8e3fe31":"code","e80ab642":"code","97c8c689":"code","456e7213":"code","8bbb9002":"code","e2edb0ff":"code","da61549c":"code","8bef0ceb":"code","0cf8a919":"code","dd47ef4e":"code","f4db525e":"code","99775ee8":"code","b73ca5c0":"code","d99b7fb8":"code","b681bef7":"code","735700e6":"code","b6064eb7":"code","cb4b4685":"code","8fb11c8f":"code","a043ddc5":"code","fd10d924":"code","88c0f5d1":"code","b8af0b46":"code","f30b389e":"code","04e46536":"code","5152b1a5":"code","cf788943":"code","d4c6807b":"code","285c10d2":"code","a05b8ecd":"code","59bdde9b":"code","383b0014":"code","0a18ae27":"code","6963fcda":"code","bee347d2":"code","feada226":"code","8d21ca5b":"code","e4671543":"code","13612eab":"code","5d99660a":"code","08e12f70":"code","6ced5793":"code","5eaf647a":"code","8d73fcf0":"code","b3e82934":"code","24f722d1":"code","38e07fa4":"code","8371e946":"code","8b487ec2":"code","4870e8f8":"code","4d9e7fba":"code","099a6e2f":"code","7ccf65f6":"code","4c61e2ed":"code","bdef55c2":"code","8c896b86":"code","523f7e8b":"code","5a7b0186":"code","a6ec8b47":"code","9a29d90d":"code","7507478c":"code","f88edc43":"code","7d3c4888":"code","69b16e69":"code","371a4fef":"code","b2f8d5ef":"code","0ec82994":"code","dd1e8339":"code","7320af11":"code","b493b41c":"code","6fff59dc":"code","66831168":"code","e25a4ba2":"code","a96904a9":"code","c38569e0":"code","164dd00f":"code","f93f885e":"code","619953e1":"code","3c1243b2":"code","88712ad9":"code","2b099806":"markdown","c17d225c":"markdown","f6f3a6cb":"markdown","e4a657ab":"markdown","456c99fa":"markdown","f6a2ebcc":"markdown","b6a3d2eb":"markdown","71162d49":"markdown","81833648":"markdown","1d55d1f3":"markdown","2d91d3c4":"markdown","fa2c6a88":"markdown","79b7668a":"markdown","5bc03754":"markdown","e1ec08fd":"markdown"},"source":{"a8e3fe31":"import os\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n#from windrose import WindroseAxes\nfrom statsmodels.graphics.tsaplots import plot_pacf, plot_acf\n%matplotlib inline \n#os.getcwd()\n#os.chdir('C:\\\\Users\\\\amit_\\\\Desktop\\\\SPRINGBOARD PROJECTS\\\\Project-Cap3')","e80ab642":"raw_data = pd.read_csv('..\/input\/wind-turbine-scada-dataset\/T1.csv')\nraw_data.head()","97c8c689":"raw_data.info()","456e7213":" #convert the date column to datetime object\nraw_data['Date\/Time'] = pd.to_datetime(raw_data['Date\/Time']) ","8bbb9002":"#set the index to the Date time column\nraw_data.set_index('Date\/Time',inplace=True) ","e2edb0ff":"raw_data.columns","da61549c":" #change column names\nraw_data.columns = ['Power','Wind_speed','Theoretical_power','Wind_direction']","8bef0ceb":"raw_data.describe()","0cf8a919":"print(raw_data.index.min())\nprint(raw_data.index.max())","dd47ef4e":"#create a loss column\nraw_data['Loss'] = raw_data['Theoretical_power'] - raw_data['Power']\nraw_data.head(3)","f4db525e":" # due to the random noise, the data will be resampled by every hour\n\nraw_data['Power'].plot(figsize=(20,5))\nplt.show()","99775ee8":"# create an hourly,daily,weekly,monthly data frame resampled by the mean\nhourly = pd.DataFrame()\ndaily = pd.DataFrame()\nweekly = pd.DataFrame()\nmonthly = pd.DataFrame()\n\nfor col in raw_data.columns:\n    weekly[col] = raw_data[col].resample('W').mean()\n\nfor col in raw_data.columns:\n    monthly[col] = raw_data[col].resample('M').mean()\n\nfor col in raw_data.columns:\n    daily[col] = raw_data[col].resample('D').mean()\n\nfor col in raw_data.columns:\n    hourly[col] = raw_data[col].resample('H').mean()\n\n","b73ca5c0":"hourly['Power'].plot(figsize=(20,5))\nplt.show()","d99b7fb8":"daily['Power'].plot(figsize=(20,5),label='daily')\nplt.show()","b681bef7":"# create a function for a categorical column \ndef direction(x):\n    if x > 348.75 or x<11.25: return 'N'\n    if x < 33.75: return 'NNE'\n    if x < 56.25: return 'NE'\n    if x < 78.75: return 'ENE'\n    if x < 101.25: return 'E'\n    if x < 123.75: return 'ESE'\n    if x < 146.25: return 'SE'\n    if x < 168.75: return 'SSE'\n    if x < 191.25: return 'S'\n    if x < 213.75: return 'SSW'\n    if x < 236.25: return 'SW'\n    if x < 258.75: return 'WSW'\n    if x < 281.25: return 'W'\n    if x < 303.75: return 'WNW'\n    if x < 326.25: return 'NW'\n    else: return 'NNW'","735700e6":"daily.info()","b6064eb7":"# replace all Nan values with interpolated values for each column\nfor col in daily.columns:\n    daily[col] = daily[col].interpolate()","cb4b4685":"daily.info()","8fb11c8f":"#create a categorical column for the direction of wind \ndaily['Direction'] = daily['Wind_direction'].apply(direction)","a043ddc5":"daily.head(3)","fd10d924":"daily['Direction'].unique()","88c0f5d1":"daily['Loss'].plot()\nplt.title('Daily Loss')\nplt.show()","b8af0b46":"print(max(raw_data['Wind_speed']))","f30b389e":"#check number of data points in raw_data where the wind speed is above 3.3 and power is less than zero\n#create a dataframe where times of maintenance are not included\nraw_data_nm = raw_data[~((raw_data['Power']<=0) & (raw_data['Wind_speed'] > 3.3))]","04e46536":"raw_data_nm.info()","5152b1a5":"raw_data_nm.head(3)","cf788943":"# filtered loss\n_ = raw_data_nm['Loss'].plot()\n","d4c6807b":"raw_data_nm['Wind_direction'].describe()","285c10d2":"#function to create x,y component of wind direction \ndef x_y_component(wind_direction, wind_speed):\n    \"\"\"\n    Convert degrees to x,y components\n    \"\"\"\n    #convert to radians \n    radians = (wind_direction * np.pi)\/180\n    # give the x, y compenents \n    x = wind_speed * np.cos(radians)\n    y = wind_speed * np.sin(radians)\n    \n    return x,y","a05b8ecd":"raw_data_nm.columns","59bdde9b":"# create two extra columns in raw_data_nm for x,y compnenents of wind direction \nraw_data_nm['x_com'], raw_data_nm['y_com'] = x_y_component(raw_data_nm['Wind_direction'],\n                                                           raw_data_nm['Wind_speed'])","383b0014":"raw_data_nm.head(3)","0a18ae27":"raw_data_nm.describe()","6963fcda":"#resample from no maintenance dataset for every hour, day, week and month\nhourly_nm = pd.DataFrame()\ndaily_nm = pd.DataFrame()\nweekly_nm = pd.DataFrame()\nmonthly_nm = pd.DataFrame()\n\ncolumns = ['Power','Wind_speed','Theoretical_power','Wind_direction','Loss','x_com','y_com']\n\nfor column in columns:\n    hourly_nm[column] = raw_data_nm[column].resample('H').mean()\n\nfor column in columns:\n    daily_nm[column] = raw_data_nm[column].resample('D').mean()\n\nfor column in columns:\n    weekly_nm[column] = raw_data_nm[column].resample('W').mean()\n    \nfor column in columns:\n    monthly_nm[column] = raw_data_nm[column].resample('M').mean()\n    ","bee347d2":"daily_nm.info()","feada226":"hourly_nm.info()","8d21ca5b":"hourly_nm['2018-12']['Power'].plot(figsize=(15,7))\nplt.show()","e4671543":"#interpolate values for the hourly no maintenance dataset\nfor column in hourly_nm.columns:\n    hourly_nm[column] = hourly_nm[column].interpolate()","13612eab":"#last two weeks of december\nhourly_nm['2018-12-17':'2018-12-31']['Power'].plot(figsize=(15,7))","5d99660a":"#plot the difference between maintnence and no maintenance\nhourly['Loss'].plot(figsize=(10,5))\nplt.title('Average Hourly Power Loss')\nplt.xlabel('Date')\nplt.ylabel('Power Loss(KWh)')\nplt.tight_layout()\n#plt.savefig('figures\/hourly_loss.png')\nplt.show()","08e12f70":"hourly_nm['Loss'].plot(figsize=(10,5))\nplt.title('Average Hourly Power Loss after Filtering Maintenance')\nplt.ylabel('Power Loss (kWh)')\nplt.xlabel('Date')\nplt.tight_layout()\n#plt.savefig('figures\/hourly_loss_after_main.png')\nplt.show()","6ced5793":"hourly_nm[hourly_nm['Loss']> 500]","5eaf647a":"hourly_nm[((hourly_nm['Wind_speed']<6) & (hourly_nm['Power']<100))].head()\n","8d73fcf0":"hourly_nm[((hourly_nm['Power']==0) & (hourly_nm['Theoretical_power']>0))].describe()","b3e82934":"hourly_nm['Power'].plot(figsize=(20,5),label='hourly')\nhourly_nm['Theoretical_power'].plot(label='theoretical')\nplt.legend()\nplt.show()","24f722d1":"raw_data['Direction'] = raw_data['Wind_direction'].apply(direction)","38e07fa4":"raw_data.head(3)","8371e946":"#add the direction column to the daily,weekly,monthly dataframes no maintenance dataframe\ndfs = [hourly_nm, daily_nm, weekly_nm, monthly_nm]\n\nfor df in dfs:\n    df['Direction'] = df['Wind_direction'].apply(direction)\n\nmonthly_nm.head(3)","8b487ec2":"#create a function for the mean wind speed\ndef mean_wind(x):\n    intervals = [*np.arange(0.25,26,0.5)]\n\n    for i in intervals:\n            if x < i: \n                x=i-0.25\n                return x","4870e8f8":"raw_data_nm['Mean_speed'] = raw_data_nm['Wind_speed'].apply(mean_wind)","4d9e7fba":"#add mean wind speed for raw data no maintenance \nraw_data_nm.sample(5)\n","099a6e2f":"#ACF : ckecks to see if the previos time step has an impact on the next time step\n#PCF : see which lag has an impact on the next time step.\nplot_acf(hourly_nm['Power'], lags=30)\n#plt.savefig('figures\/acf.png')\nplt.show()","7ccf65f6":"plt.figsize=(20,5)\nplot_pacf(hourly_nm['Power'], lags=30)\n#plt.savefig('figures\/pacf.png')\nplt.show()","4c61e2ed":"hourly_nm['T_1'] = hourly_nm['Power'].shift(1)","bdef55c2":"hourly_nm = hourly_nm.dropna()","8c896b86":"hourly_nm.head(3)","523f7e8b":"#Test to check for stationarity, if mean and variance are roughly similar we can say the data is stationary.\ncolumns = ['Power', 'Wind_speed', 'Theoretical_power', 'Loss','x_com','y_com']\nfor column in columns:\n    feature = hourly_nm[column]\n    split = round(len(feature)\/2)\n    X_1,X_2 = feature[:split], feature[split:]\n    mean_1,mean_2 = X_1.mean(), X_2.mean()\n    var_1,var_2 = X_1.var(), X_2.var()\n    print('For {}'.format(column))\n    print('mean1=%f, mean2=%f' % (mean_1, mean_2))\n    print('variance1=%f, variance2=%f' % (var_1, var_2))\n    print('')","5a7b0186":"# Second test to check stationarity in data using adfuller test\nfrom statsmodels.tsa.stattools import adfuller\n\nadfull = {}\n\nfor column in columns:\n    X = hourly_nm[column].values\n    result = adfuller(X)\n    adfull[column] = [result[1]]\n\n    print('P-value for {}: {}'.format(column,result[1]))","a6ec8b47":"adfull_df = pd.DataFrame.from_dict(adfull)","9a29d90d":"adfull_df","7507478c":"#daily['Power'].plot(figsize=(20,5),label='daily')\nmonthly_nm['Power'].plot(label='monthly')\nweekly_nm['Power'].plot(label='weekly')\nplt.title('Daily and Monthly Average Power Generated')\nplt.ylabel('LV Power (kW)')\nplt.xlabel('Date')\nplt.legend()\nplt.show()","f88edc43":"#plot kde of power \nsns.kdeplot(raw_data_nm['Power'],shade=True)\nplt.title('KDE Plot of Power')\nplt.tight_layout()\n#plt.savefig('figures\/KDE.png')\nplt.show()","7d3c4888":"#plot kde of wind speed\nsns.kdeplot(raw_data_nm['Wind_speed'],shade=True)\nplt.title('KDE Plot of Wind Speed')\nplt.xlabel('Wind speed (m\/s)')\nplt.tight_layout()\n#plt.savefig('figures\/KDE wind_speed.png')\nplt.show()","69b16e69":"m_s_t_se = raw_data_nm.groupby('Mean_speed')['Theoretical_power'].mean()\nm_s_p_se = raw_data_nm.groupby('Mean_speed')['Power'].mean()\nplt.figure(figsize=(10,5))\nplt.tight_layout()\nplt.plot(m_s_t_se,label='Theoretical')\nplt.plot(m_s_p_se,label='Actual Power')\nplt.xlabel('Wind Speed (m\/s)')\nplt.ylabel('Power (kW)')\nplt.title('Theoretical Power vs Actual Power Curve')\nplt.grid(which='major')\nplt.legend()\n#plt.savefig('figures\/theo-actual-power-curve.png')\nplt.show()","371a4fef":"raw_data.columns","b2f8d5ef":"# ax = WindroseAxes.from_ax()\n# ax.bar(raw_data_nm['Wind_direction'], raw_data_nm['Wind_speed'], normed=True, opening=0.8, edgecolor='black')\n# ax.set_theta_direction('clockwise')\n# ax.set_theta_zero_location('N')\n# ax.set_xticklabels(['N', 'N-E', 'E', 'S-E', 'S', 'S-W', 'W', 'N-W'])\n# ax.set_legend()\n# plt.title('Wind Direction v Wind Speed (m\/s) from 10 min Intervals.')\n# plt.tight_layout()\n# plt.savefig('figures\/windrose.png')\n# plt.show()","0ec82994":"raw_data_nm['Direction'] = raw_data_nm['Wind_direction'].apply(direction)","dd1e8339":"direction_df = raw_data_nm.groupby('Direction')[['Power','Theoretical_power']].sum()\ndirection_df = direction_df.sort_values(by=['Power'],ascending=False)\ndirection_df.plot(kind='bar',figsize=(10,5))\nplt.title('Total Theoretical Power & LV Power Comparison')\nplt.ylabel('Power (kW)')\nplt.tight_layout()\n#plt.savefig('figures\/theo_vs_lv_power.png')\nplt.show()\n","7320af11":"# summary df of grouped daily direction \ndir_loss = raw_data_nm.groupby('Direction')[['Loss']].sum()\ndir_loss = dir_loss.sort_values(by=['Loss'],ascending=False)\ndir_loss.plot(kind='bar', figsize=(10,5))\nplt.title('Total Power loss')\nplt.ylabel('Power Loss (kW)')\nplt.tight_layout()\n#plt.savefig('figures\/power_loss.png')\nplt.show()","b493b41c":"raw_data_nm.head(3)","6fff59dc":"NNE = raw_data_nm[raw_data_nm['Direction']=='NNE']\nm_s_p_nne = NNE.groupby('Mean_speed')['Power'].mean()\nplt.figure(figsize=(10,5))\nplt.plot(m_s_t_se,label='Theoretical')\nplt.plot(m_s_p_nne,label='NNE Power')\nplt.xlabel('Wind Speed (m\/s)')\nplt.ylabel('Power (kW)')\nplt.title('Theoretical Power vs NNE Power Curve')\nplt.grid(which='major')\nplt.legend()\nplt.tight_layout()\n#plt.savefig('figures\/NNE_p.png')\nplt.show()\n","66831168":"ENE = raw_data_nm[raw_data_nm['Direction']=='ENE']\nm_s_p_ene = ENE.groupby('Mean_speed')['Power'].mean()\nplt.plot(m_s_t_se,label='Theoretical')\nplt.plot(m_s_p_ene,label='ENE Power')\nplt.xlabel('Wind Speed (m\/s)')\nplt.ylabel('Power (kW)')\nplt.title('Theoretical Power vs ENE Power Curve')\nplt.grid(which='major')\nplt.legend()\nplt.show()","e25a4ba2":"NE = raw_data_nm[raw_data_nm['Direction']=='NE']\nm_s_p_ne = NE.groupby('Mean_speed')['Power'].mean()\nplt.plot(m_s_t_se,label='Theoretical')\nplt.plot(m_s_p_ne,label='NE Power')\nplt.xlabel('Wind Speed (m\/s)')\nplt.ylabel('Power (kW)')\nplt.title('Theoretical Power vs NE Power Curve')\nplt.grid(which='major')\nplt.legend()\nplt.show()","a96904a9":"SSW = raw_data_nm[raw_data_nm['Direction']=='SSW']\nm_s_p_ssw = SSW.groupby('Mean_speed')['Power'].mean()\nplt.plot(m_s_t_se,label='Theoretical')\nplt.plot(m_s_p_ssw,label='SSW Power')\nplt.xlabel('Wind Speed (m\/s)')\nplt.ylabel('Power (kW)')\nplt.title('Theoretical Power vs SSW Power Curve')\nplt.grid(which='major')\nplt.legend()\nplt.show()","c38569e0":"SSW = raw_data_nm[raw_data_nm['Direction']=='SSW']\nm_s_p_ssw = SSW.groupby('Mean_speed')['Power'].mean()\nplt.figure(figsize=(12,7))\nplt.plot(m_s_t_se,label='Theoretical')\nplt.plot(m_s_p_ssw,label='SSW Power')\nplt.plot(m_s_p_ene,label='ENE Power')\nplt.plot(m_s_p_ne,label='NE Power')\nplt.plot(m_s_p_nne,label='NNE Power')\nplt.xlabel('Wind Speed (m\/s)')\nplt.ylabel('Power (kW)')\nplt.title('Theoretical Power vs Power Curve')\nplt.grid(which='major')\nplt.legend()\nplt.tight_layout()\n#plt.savefig('figures\/power_direction.png')\nplt.show()","164dd00f":"#pairplot\n_ = sns.pairplot(daily_nm,kind='reg')","f93f885e":"#plot correlation heatmap, if gausian then pearson \nfig, ax = plt.subplots(1, 1,figsize=(9,7))\nsns.heatmap(hourly_nm.corr(),annot=True,linewidth=0.5)\nplt.title('Heatmap Showing Correlations Between different features in the dataset.')\nax.set_ylabel('')\nax.set_xlabel('')\nplt.tight_layout()\n#plt.savefig('figures\/correlation.png')\nplt.show()","619953e1":"#test co-integration between features\nimport statsmodels.api as sm\n\nnum_columns = ['Wind_speed', 'Theoretical_power', 'Loss','x_com','y_com']\nP = hourly_nm[['Power']]\nco_int = {}\n\nfor column in num_columns:\n    C = hourly_nm[[column]]\n\n    C = sm.add_constant(C)\n    result = sm.OLS(P,C).fit()\n\n    #value of the gradient \n    const = result.params[1]\n    adf_g = adfuller(hourly_nm[column] - const*hourly_nm['Power'])\n    \n    co_int[column] = [adf_g[1]]\n   \n    print('The p-value for the ADF test between {} and Power is: {} '.format(column,adf_g[1]))","3c1243b2":"co_int_df = pd.DataFrame.from_dict(co_int)\nco_int_df","88712ad9":"hourly_nm.drop(labels=['Wind_direction','Direction'],axis=1,inplace=True)","2b099806":"Next to test the co-inegration between different features of the dataset. ","c17d225c":"There are times throughout the year where the turbine has experienced a large amount of Power loss. This is worth investigating further. I suspect this is due to maintenance. ","f6f3a6cb":"Consider the greatest power loss were in ENE, NE, NNE and SSW. I will investigate this further.\n\n\n","e4a657ab":"We can conclude that all the features do not follow a random walk and are stationary. ","456c99fa":"The turbine has recorded data for the year of 2018","f6a2ebcc":"**Null Hypothesis (H0)**: If failed to be rejected, it suggests the time series has a unit root, meaning it is non-stationary. It has some time dependent structure. \n\\\n\\\n**Alternate Hypothesis (H1)**: The null hypothesis is rejected; it suggests the time series does not have a unit root, meaning it is stationary. It does not have time-dependent structure.\n\\\n\\\n**p-value > 0.05**: Fail to reject the null hypothesis (H0), the data has a unit root and is non-stationary.\n\\\n**p-value <= 0.05**: Reject the null hypothesis (H0), the data does not have a unit root and is stationary.","b6a3d2eb":"**Exploratory Data Analysis (EDA)**\n","71162d49":"From filtering the data when the wind turbine is under maintenance, there are Dates throughout the year when the power loss is minimized, however during January, Febuary and December, there is still extreme power loss. I will investigate this further.","81833648":"Between 12-14km\/h (**3.3-3.8m\/s**) a wind turbine starts to generate electricity.\nIf the wind speed is higher than 3.3m\/s and the power output is zero, we can assume the turbine is under maintenance","1d55d1f3":"As the daily power generated will be used for analysis, the autocorrelation and partial autocorrelation function will be used to see if there is a similarity between observations of a function of it's previos time steps.","2d91d3c4":"It seems the turbine was functioning normally whilst the power output was low. I will keep these data points in my analysis as our model can consider the intermittency  of the wind and whilst the turbine is not as effcient as it should be.  ","fa2c6a88":"**Data Wrangling & Feature Engineering**","79b7668a":"As Wind Direction in degrees is not a suitable feature for RNN's, this will be removed from the dataset.","5bc03754":"The above test show that all numerical columns are co-integrated with the Power feature of the dataset.","e1ec08fd":"**Information about features**\n\n-Date\/Time (for 10 minutes intervals)\n\n-LV ActivePower (kW): The power generated by the turbine for that moment\n\n-Wind Speed (m\/s): The wind speed at the hub height of the turbine (the wind speed that turbine use for electricity generation)\n\n-TheoreticalPowerCurve (KWh): The theoretical power values that the turbine generates with that wind speed which is given by the turbine manufacturer\n\n-Wind Direction (\u00b0): The wind direction at the hub height of the turbine (wind turbines turn to this direction automaticly)"}}