{"cell_type":{"5fc289ce":"code","78e54982":"code","e61891a9":"code","9ad33691":"code","6fbd838d":"code","37f5403a":"code","b3932f72":"code","b673ac59":"code","e588629e":"code","23f5d8e0":"code","6d206f44":"code","095afb78":"code","2df86579":"code","ec2d9133":"code","abf6c576":"code","765263d6":"code","63b64ec0":"code","2d81ed04":"code","d284da75":"code","31bb6b41":"code","624dffc4":"code","c027f848":"code","cb2a4db3":"code","b2906fb3":"code","83896ab6":"code","37ecf3d5":"code","086d270d":"code","965a7151":"code","00e2da2f":"code","2c8776a6":"code","210b6144":"code","65858436":"code","7aeeeaa5":"code","b2deac02":"code","e6c7ed23":"code","a0ad60ce":"code","24585fb4":"code","d361dd1b":"code","fa3a1d49":"code","4c79e572":"code","fddf92e3":"code","c2cc85ab":"code","051f0052":"code","090f1318":"code","715c4207":"code","35c5a460":"code","ba1411fd":"code","4870eccc":"code","08bd5038":"code","62e8279d":"code","75eacd82":"code","9e52c156":"code","5e3a3330":"code","1cce0c82":"code","a394529c":"code","1f6d3d1a":"code","ea66b92d":"code","382de52b":"code","a35bf41d":"code","9260a70a":"code","71c15615":"code","9d85fafb":"code","c3131b23":"code","16b37d71":"code","a54bfb7e":"code","de7a4b5a":"code","87ccccae":"code","bfb7c198":"code","fa9dc1aa":"code","c508892a":"code","22f0adbc":"code","ac49aa06":"code","0763f631":"code","211830ee":"code","736d3c00":"code","6f68a0b2":"markdown","4f509571":"markdown","3ac2b110":"markdown","e4cd6537":"markdown","db21f141":"markdown","260f2d57":"markdown","d50847fa":"markdown","9e9bde38":"markdown","06e0de07":"markdown","339b8921":"markdown","7c21dbbd":"markdown","975153be":"markdown","cd41f2f6":"markdown","98c7c5a1":"markdown","833b77aa":"markdown","3014ab39":"markdown","726167fd":"markdown","9cda7706":"markdown","be83e9ba":"markdown","232dbc66":"markdown","94b6e53b":"markdown","7564bd2f":"markdown","79b2185d":"markdown","87af6ff9":"markdown","4e2d0f3f":"markdown","266df5e4":"markdown","19f46342":"markdown","5fbdd046":"markdown","649c4d0e":"markdown","a0832919":"markdown","257bf315":"markdown","38bea00f":"markdown","a70d8110":"markdown","884a8c87":"markdown","f89dee9d":"markdown","044ec44f":"markdown","5bcd671d":"markdown","1fb7e76a":"markdown","9d27f54d":"markdown","9e726472":"markdown"},"source":{"5fc289ce":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","78e54982":"pip install openpyxl","e61891a9":"import pandas as pd \nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom pandas_datareader import data as wb\nfrom scipy import stats  \nimport statsmodels.api as sm\n%matplotlib inline\nsns.set()","9ad33691":"data=wb.DataReader(\"PG\",data_source=\"yahoo\",start=\"1995-1-1\")\ndata","6fbd838d":"# divide the adjusted close of today from adjusted close of the next day\ndata[\"rate of return\"]= (data[\"Adj Close\"]\/data[\"Adj Close\"].shift(1))-1\ndata\n# the rate of return exhibite the % daily change of ajdjusted closing price\n# on most day it always lesser than 1, the significant movement of every company stock price","37f5403a":"plt.figure(figsize=(10,5))\nplt.plot(data[\"rate of return\"])","b3932f72":"#Average daily return\nrate_mean=data[\"rate of return\"].mean()\nprint(\"rate mean:\",rate_mean)\n#Average annual rate of return\n# 250 is the number of working days in a year\navg_ann_rate=round(rate_mean,5)*250\nprint(\"average annual rate:\",avg_ann_rate)\n#convert to %\navg_ann_rate_perc=avg_ann_rate*100\nprint(\"percentage of average annual rate:\",avg_ann_rate_perc,\"%\")","b673ac59":"data[\"log return\"]=np.log(data[\"Adj Close\"]\/data[\"Adj Close\"].shift(1))\ndata","e588629e":"plt.figure(figsize=(10,5))\nplt.plot(data[\"log return\"])","23f5d8e0":"#Average daily return\nlog_rat_mean=data[\"log return\"].mean()\nprint(\"rate mean:\",log_rat_mean)\n#Average annual rate of return\n# 250 is the number of working days in a year\navg_log_rat_mean=round(log_rat_mean,5)*250\nprint(\"average annual rate:\",avg_log_rat_mean)\n#convert to %\navg_log_rat_mean_perc=avg_log_rat_mean*100\nprint(\"percentage of average annual rate:\",avg_log_rat_mean_perc,\"%\")","6d206f44":"# the portfolio include Procter & Gamble, Microsoft, Ford and General Electric\ntickers=['PG','MSFT','F','GE']\ndf=pd.DataFrame()\nfor i in tickers:\n    df[i]=wb.DataReader(i,data_source='yahoo',start='1995-1-1')['Adj Close']","095afb78":"df.head()","2df86579":"# to compare the behaviour of the 4 diff stocks like they were starting from the same value\n(df\/df.iloc[0]*100).plot(figsize=(20,5))","ec2d9133":"df.plot(figsize=(20,5))","abf6c576":"returns=(df\/df.shift(1))-1\nreturns","765263d6":"# note the sum of the weight must equal to 1\nPG_Weight=0.25\nMSFT_Weight=0.25\nF_Weight=0.25\nGE_Weight=0.25\nweights=np.array([PG_Weight,MSFT_Weight,F_Weight,GE_Weight])\nannual_returns=returns.mean()*250\nportfolio_1=str(round(np.dot(annual_returns,weights),5)*100) + \"%\"\nprint('portfolio_1;',portfolio_1)\nPG_Weight=0.4\nMSFT_Weight=0.4\nF_Weight=0.15\nGE_Weight=0.05\nweights=np.array([PG_Weight,MSFT_Weight,F_Weight,GE_Weight])\nannual_returns=returns.mean()*250\nportfolio_2=str(round(np.dot(annual_returns,weights),5)*100) + \"%\"\nprint('portfolio_2;',portfolio_2)\n","63b64ec0":"# the portfolio include S&P500- \"^GSPC\" , ^NASDAQ-\"^IXIC\", German DAX- '^GDAXI', london FTSE - \"^FTSE\"\ntickers=['^GSPC','^IXIC','^GDAXI']\nind_data=pd.DataFrame()\nfor i in tickers:\n    ind_data[i]=wb.DataReader(i,data_source='yahoo',start='1997-1-1')['Adj Close']# closing stock price\nind_data.head()","2d81ed04":"ind_data.tail()","d284da75":"(ind_data\/ind_data.iloc[0]*100).plot(figsize=(20,5))","31bb6b41":"ind_data.plot(figsize=(20,5))","624dffc4":"returns=(ind_data\/ind_data.shift(1))-1\nreturns.plot(figsize=(20,5))","c027f848":"avg_returns=round((returns.mean()*250),3)*100\navg_returns","cb2a4db3":"# DJI- DOW JONES\ntickers=['^GSPC','PG','^DJI']\nstck_ind_data=pd.DataFrame()\nfor i in tickers:\n    stck_ind_data[i]=wb.DataReader(i,data_source='yahoo',start='2007-1-1')['Adj Close']# closing stock price\nstck_ind_data.head()","b2906fb3":"# Mormalize\n(stck_ind_data\/stck_ind_data.iloc[0]*100).plot(figsize=(20,5))","83896ab6":"tickers=['PG','BEI.DE']\nsec_data=pd.DataFrame()\nfor i in tickers:\n    sec_data[i]=wb.DataReader(i,data_source='yahoo',start='2007-1-1')['Adj Close']# closing stock price\nsec_data.head()","37ecf3d5":"sec_returns=np.log(sec_data\/sec_data.shift(1))\nsec_returns.head()","086d270d":"# we'll calc the risk seperatly\n# multiply by total number of trading days in a year\nsec_returns['PG'].mean()*250 # annual rate of returns\nnp.sqrt(sec_returns['PG'].std())\nsec_returns ","965a7151":"print(sec_returns['PG'].mean()*250)\nprint(sec_returns['PG'].std()*250**0.5)","00e2da2f":"print(sec_returns['BEI.DE'].mean()*250)\nprint(sec_returns['BEI.DE'].std()*250**0.5)","2c8776a6":"sec_returns .corr()","210b6144":"sec_returns.cov()","65858436":"weights=np.array([0.5,0.5])\n# Portfolio Variance\npfolio_var=np.dot(weights.T,np.dot(sec_returns.cov()*250,weights))\nprint('Portfolio Variance:',pfolio_var)\n# Portfolio Volatality\npfolio_vol=(np.dot(weights.T,np.dot(sec_returns.cov()*250,weights)))**0.5\nprint(\"Portfolio Volatality\/risk:\",pfolio_vol)\nprint(\"Portfolio Volatality\/risk percentage:\",round(pfolio_vol*100,2),'%')","7aeeeaa5":"weights=np.array([0.5,0.5])\n","b2deac02":"# diversifiable risk = portfolio variance - weighted annual variance\npg_var_a=sec_returns['PG'].var()*250\nprint(pg_var_a)\nBEI_var_a=sec_returns['BEI.DE'].var()*250\nprint(BEI_var_a)\nDR=pfolio_var-(weights[0]**2*pg_var_a)-(weights[1]**2*BEI_var_a)\nprint(DR)\nprint(round(DR,3)*100,'%')","e6c7ed23":"n_dr_1=pfolio_var-DR\nprint(n_dr_1)\nn_dr_2=(weights[0]**2*pg_var_a)+(weights[1]**2*BEI_var_a)\nprint(n_dr_2)\nprint(n_dr_1==n_dr_2)","a0ad60ce":"data=pd.read_excel('..\/input\/housing\/Housing.xlsx')\ndata.head()","24585fb4":"X=data['House Size (sq.ft.)']\nY=data['House Price']","d361dd1b":"plt.scatter(X,Y)","fa3a1d49":"plt.scatter(X,Y)\nplt.axis([0,2500,0,1500000])\nplt.ylabel('House price')\nplt.xlabel('House Size (sq.ft.)')","4c79e572":"# a simple regression will omit some important factor,which will result in an estimation error\n# simple reg is useful but not perfect","fddf92e3":"X1=sm.add_constant(X)\nreg=sm.OLS(Y,X1).fit()\nreg.summary()","c2cc85ab":"#Y=alpha+beta*x\n260800+401.9163*1000","051f0052":"slope,intercept,r_value,p_value,std_err=stats.linregress(X,Y)","090f1318":"print('Slope:',slope)\nprint('intercept:',intercept)\nprint('rvalue',r_value)\nprint('R square',r_value**2)\nprint('p_value:',p_value)\nprint('stdandard Error:',std_err)","715c4207":"assets=['PG',\"^GSPC\"]\npf_data=pd.DataFrame()\nfor i in assets:\n    pf_data[i]=wb.DataReader(i,data_source='yahoo',start='2010-1-1')[\"Adj Close\"]\npf_data.tail()","35c5a460":"# Normalize\n(pf_data\/pf_data.iloc[0]*100).plot(figsize=(20,5))","ba1411fd":"log_returns=np.log(pf_data\/pf_data.shift(1))\nprint(log_returns.mean()*250)\n","4870eccc":"# covariance\nlog_returns.cov()","08bd5038":"log_returns.corr()","62e8279d":"num_assets=len(assets)\nnum_assets","75eacd82":"weights=np.random.random(num_assets)\nweights\/=np.sum(weights)\nweights","9e52c156":"weights[0]+weights[1]","5e3a3330":"np.sum(weights*log_returns.mean())*250","1cce0c82":"np.dot(weights.T,np.dot(log_returns.cov()*250,weights))","a394529c":"np.sqrt(np.dot(weights.T,np.dot(log_returns.cov()*250,weights)))","1f6d3d1a":"pfolio_returns=[]\npfolio_volatillities=[]\nfor x in range(1000):\n    weights= np.random.random(num_assets)\n    weights\/= np.sum(weights)\n    pfolio_returns.append(np.sum(weights*log_returns.mean())*250)\n    pfolio_returns.append(np.sqrt(np.dot(weights.T,np.dot(log_returns.cov()*250,weights))))\npfolio_returns,pfolio_volatillities","ea66b92d":"pfolio_returns=[]\npfolio_volatillities=[]\nfor x in range(1000):\n    weights= np.random.random(num_assets)\n    weights\/= np.sum(weights)\n    pfolio_returns.append(np.sum(weights*log_returns.mean())*250)\n    pfolio_returns.append(np.sqrt(np.dot(weights.T,np.dot(log_returns.cov()*250,weights))))\npfolio_returns=np.array(pfolio_returns)\npfolio_volatillities=np.array(pfolio_volatillities)\n    \npfolio_returns,pfolio_volatillities","382de52b":"tickers=['PG',\"^GSPC\"]\ndata=pd.DataFrame()\nfor i in tickers:\n    data[i]=wb.DataReader(i,data_source='yahoo',start='2012-1-1',end=\"2016-12-31\")[\"Adj Close\"]\ndata.tail()","a35bf41d":"sec_returns=np.log(data\/data.shift(1))\ncov=sec_returns.cov()*250\ncov","9260a70a":"cov_with_market=cov.iloc[0,1]\ncov_with_market","71c15615":"market_var=sec_returns['^GSPC'].var()*250\nmarket_var","9d85fafb":"PG_beta=cov_with_market\/market_var\nPG_beta","c3131b23":"PG_er=0.025 + PG_beta*0.05\nPG_er","16b37d71":"sharpe=(PG_er-0.025)\/(sec_returns['PG'].std()*250**0.5)\nsharpe","a54bfb7e":"House=pd.read_excel('..\/input\/housing\/Housing.xlsx')\nHouse.head()","de7a4b5a":"X=House[['House Size (sq.ft.)','Number of Rooms','Year of Construction']]\nY=House['House Price']\nX1=sm.add_constant(X)\nreg=sm.OLS(Y,X1).fit()\nreg.summary()","87ccccae":"#### Independent variables: \"House ,House Size (sq.ft.)\"\nX=House[['House Size (sq.ft.)','Number of Rooms']]\nY=House['House Price']\nX1=sm.add_constant(X)\nreg=sm.OLS(Y,X1).fit()\nreg.summary()","bfb7c198":"rev_m=170\nrev_stdev=20\niterations=1000\nrev=np.random.normal(rev_m,rev_stdev,iterations)\nrev","fa9dc1aa":"plt.figure(figsize=(20,5))\nplt.plot(rev)","c508892a":"COGS=-(rev*np.random.normal(0.6,0.1))\nplt.figure(figsize=(20,5))\nplt.plot(COGS)","22f0adbc":"COGS.mean()","ac49aa06":"Gross_profit=rev+COGS\nplt.figure(figsize=(20,5))\nplt.plot(Gross_profit)","0763f631":"print(max(Gross_profit))\nprint(min(Gross_profit))\nprint((Gross_profit.mean()))\nprint((Gross_profit.std()))\n","211830ee":"plt.figure(figsize=(20,5))\nplt.hist(Gross_profit,bins=[40,50,60,70,80,90,100,110,120])","736d3c00":"plt.figure(figsize=(20,5))\nplt.hist(Gross_profit,bins=20)\nplt.show()","6f68a0b2":"# **Alpha,Beta,R^2**","4f509571":"### **Expected portfolio Variance**","3ac2b110":"# **Univariate Regression**","e4cd6537":"# **Beta:**","db21f141":"### **Biersdorf's risk is higher than PG, as well as its returns**","260f2d57":"#### Independent variables: \"House ,House Size (sq.ft.)\"","d50847fa":" ** stock indices are an excellent comparator to understand how your own stocks are performing**","9e9bde38":"### calc the expected return of P&G(CAPM)","06e0de07":"**Expected Value of Y:**","339b8921":"## Monte Carlo-Predicting Gross Profit-part 2","7c21dbbd":"Variability is the best method to measure risk","975153be":"# **Normalize**","cd41f2f6":"# **Obtaining the efficient frontier in python**","98c7c5a1":"# **without Normalizing**","833b77aa":"### **Expected Portfolio Returns**","3014ab39":"Compare adj closing price with one of the indices or performance of stock with stock indices","726167fd":"# **Log Returns**","9cda7706":"# **Calc the Return of a portfolio of securities**","be83e9ba":"## standard deviation of a company returns can also be call risk or volatility\n## A stock that show long deviation from it mean is said to be more volatile","232dbc66":"# **Diversifiable and Non-deiversifiable Risk of a portfolio**","94b6e53b":"# **Beiersdorf**","7564bd2f":"# **Calc Portfolio Risk**","79b2185d":"### Calculating the Beta of a stock ","87af6ff9":"# **Calculating the expected Return of a stock (CAPM)**","4e2d0f3f":"### note we are calc for returns ","266df5e4":"## Non-Diversifiable Risk\/systematic risk(can't be eliminated)- it depends on the variance of each individual security\n### it is made up day to day change in stock prices, it is cause by event that affect all company such as Recession of the economy, low customer spending, wars and forces of nature\n### if your have 500 stocks in your portfolio you are expose to systemic risk\n","19f46342":"# **Simple Rate of Return**","5fbdd046":"# **Multivariate Regression**","649c4d0e":"# **calculating the rate of return of a portfolio**","a0832919":"# **Normalization to 100**","257bf315":"# **PG**","38bea00f":"## Monte Carlo-Predicting Gross Profit-part 1","a70d8110":"# **Calculating the risk of as security**","884a8c87":"### **Expected portfolio Volatality**","f89dee9d":"# **Calc covariance and correlation**","044ec44f":"## Diversifiable risk\n### Diversifiable risk can be eliminated if we invest in non-correlated assests such as Automotive, construction, energy and technology","5bcd671d":"# **computing alpha, beta and r square**","1fb7e76a":"#### Sharpe ratio:","9d27f54d":"### ols- Ordinary least square estimates\n### we'll use variance to measure the variability of the data\n### Total Sun of squares (TSS) provides a sense of the variability of data\n### R^2= 1-(SSR-TSS)\n### R squre varies btw 0%-100%. The higher it is, the more productive power the model has","9e726472":"# **Compare performance of stocks in stock indices**"}}