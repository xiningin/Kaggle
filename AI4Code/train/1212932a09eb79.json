{"cell_type":{"8d3e33b1":"code","e72b84ee":"code","e8561665":"code","0730932e":"code","7528cf0a":"code","ed4047de":"code","1fdd98a5":"code","b3b93f6e":"markdown","cda73fce":"markdown","be013a41":"markdown","adc247b9":"markdown","de8258ff":"markdown","9f4b5bf8":"markdown","e505f829":"markdown","c03448e2":"markdown","e3dfdc4e":"markdown","2b1082b9":"markdown","e18366a0":"markdown","b5b0b3f4":"markdown"},"source":{"8d3e33b1":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","e72b84ee":"#Kullanca\u011f\u0131m\u0131z k\u00fct\u00fcphaleri ekliyoruz\nfrom keras import models\nfrom keras import layers","e8561665":"model=models.Sequential()\nmodel.add(layers.Conv2D(32,(3,3),activation=\"relu\",input_shape=(28,28,1)))\nmodel.add(layers.MaxPool2D((2,2)))\nmodel.add(layers.Conv2D(64,(3,3),activation=\"relu\"))\nmodel.add(layers.MaxPool2D((2,2)))\nmodel.add(layers.Conv2D(64,(3,3),activation=\"relu\"))\nmodel.summary()","0730932e":"model.add(layers.Flatten())\nmodel.add(layers.Dense(64,activation=\"relu\"))\nmodel.add(layers.Dense(10,activation=\"softmax\")) #0-9 aras\u0131nda ki rakamlar toplam 10 tane oldu\u011fu i\u00e7in \u00e7\u0131k\u0131\u015f katman\u0131m\u0131z\u0131 10 olarak belirledik.\n#A\u011f\u0131m\u0131z\u0131n son halini g\u00f6zden ge\u00e7irelim:\nmodel.summary()","7528cf0a":"from keras.datasets import mnist\nfrom keras.utils import to_categorical\n","ed4047de":"(train_images,train_labels),(test_images,test_labels)=mnist.load_data() #datam\u0131z\u0131 indirecek kod \n\ntrain_images=train_images.reshape((60000,28,28,1)) #E\u011fitim i\u00e7in 60000 resim,28x28 boyutunda,1 yani siyah beyaz kanal derinli\u011fini ifade eder\ntrain_images=train_images.astype(\"float32\")\/255 #255 rgb renk max de\u011ferine b\u00f6lerek normalizasyon i\u015flemi yap\u0131yoruz astype ile veri de\u011fi\u015ftirme i\u015flemi yap\u0131l\u0131r\n\ntest_images=test_images.reshape(10000,28,28,1) #Test i\u00e7in10000 resim,28x28 boyutunda,1 yani siyah beyaz kanal derinli\u011fini ifade eder\ntest_images=test_images.astype(\"float32\")\/255\n\ntrain_labels=to_categorical(train_labels) #0-9 aras\u0131 rakamlar\u0131 kategorize ediyoruz\ntest_labels=to_categorical(test_labels)\n\nmodel.compile(optimizer=\"rmsprop\",\n             loss=\"categorical_crossentropy\",\n             metrics=[\"accuracy\"]) #Tek etiketli \u00e7oklu s\u0131n\u0131fland\u0131rma i\u00e7in \"categorical_crossentropy\" kullan\u0131l\u0131r.S\u0131n\u0131f rakam etikeler 0-9 arasu-\u0131 rakamlar.Bu do\u011frultuda en iyi optimizer rmspropdur\nmodel.fit(train_images,train_labels,epochs=5,batch_size=64)\ntest_loss,test_acc=model.evaluate(test_images,test_labels)\ntest_acc","1fdd98a5":"model_no_max_pool=models.Sequential()\nmodel_no_max_pool.add(layers.Conv2D(32,(3,3),activation=\"relu\",\n                                   input_shape=(28,28,1)))\nmodel_no_max_pool.add(layers.Conv2D(64,(3,3),activation=\"relu\"))\nmodel_no_max_pool.add(layers.Conv2D(64,(3,3),activation=\"relu\"))\nmodel_no_max_pool.summary()","b3b93f6e":"# 1.2 En B\u00fcy\u00fckleri Biriktirme(Max Pooling2D):\n**Evri\u015fimli sinir a\u011f\u0131 \u00f6rne\u011finde her MaxPooling2D katman\u0131ndan sonra nitelik haritalar\u0131n\u0131n boyutlar\u0131n\u0131n yar\u0131ya d\u00fc\u015ft\u00fc\u011f\u00fcne dikkat etmi\u015fsinizdir.\u00d6rnde\u011fin,\u0130lk MaxPooling2D katman\u0131ndan \u00f6nce nitelik haritas\u0131n\u0131n boyutu 26x26 iken sonra 13x13 olmaktad\u0131r.En b\u00fcy\u00fckleri biriktirmenin g\u00f6revi:Ad\u0131ml\u0131 evri\u015fim gibi nitelik haritalar\u0131n\u0131n boyutlar\u0131n\u0131 k\u00fc\u00e7\u00fcltmeyi ama\u00e7lar.En b\u00fcy\u00fckleri biriktirme,girdi nitelik haritas\u0131ndan pencereler \u00e7\u0131kar\u0131p her kanal\u0131n en b\u00fcy\u00fck de\u011ferini almaktad\u0131r.Evri\u015fim i\u015flemine benzer bir i\u015flem yapar.Sadece farkl\u0131 olarak \u00f6\u011frenilmi\u015f bir do\u011frusal d\u00f6n\u00fc\u015f\u00fcm yerine elle belirlenmi\u015f bir kural olan max(en b\u00fcy\u00fck) tens\u00f6r i\u015flemini yapar.**\n\n**Neden nitelik haritalar\u0131n\u0131 k\u00fc\u00e7\u00fclt\u00fcyoruz ? Neden en b\u00fcy\u00fckleri biriktirmeyi kald\u0131r\u0131p b\u00fct\u00fcn yol boyunca b\u00fcy\u00fck haritalar kullanm\u0131yoruz ? \u015eimdi bu se\u00e7ene\u011fe bakal\u0131m.Evri\u015fimli temel model \u015funa benziyor**\n","cda73fce":"*Tamamen ba\u011fl\u0131 a\u011fda %97 ba\u015far\u0131 oran\u0131 al\u0131rken evri\u015fimli sinir a\u011f\u0131nda 99.3 ba\u015far\u0131m oran\u0131 yakalad\u0131k.Hi\u00e7 de fena say\u0131lmaz ! Fakat neden bu evri\u015fimli sinir a\u011f\u0131 tamamen ba\u011fl\u0131 a\u011fdan daha iyi sonu\u00e7lara ula\u015ft\u0131:Cevab\u0131 i\u00e7in Conv2D ve MaxPooling2D katmanlar\u0131n\u0131 derinlemesine inceliyece\u011fiz*","be013a41":"### \u00d6r\u00fct\u00fcler uzan\u0131msal hiyarar\u015fileri \u00f6\u011frenebilirler.\n![image.png](attachment:image.png)\n*\u0130lk evri\u015fimli katman k\u00f6\u015feler gibi k\u00fc\u00e7\u00fck b\u00f6lgesel \u00f6r\u00fcnt\u00fcleri \u00f6\u011frenirken ikinci evri\u015fimli katman ilk katman\u0131n \u00f6\u011frendi\u011fi \u00f6r\u00fcnt\u00fclerden daha geni\u015f \u00f6r\u00fcnt\u00fcler \u00f6\u011frenir ve bu b\u00f6yle devam eder*","adc247b9":"# K\u0131sa Bilgi(Daha sonra detayl\u0131 anlataca\u011f\u0131m):\n### Convolution Layer:\nFiltre k\u0131sm\u0131 olarak da ge\u00e7er.\u00d6rne\u011fin elimizde bir kedi resmi olsun.Kedi resminin kendine \u00f6zg\u00fc \u00f6zellikleri vard\u0131r.Kedinin g\u00f6z\u00fc,kuyru\u011fu ..vb \u0130\u015fte bu filtre \nsayesinde convolution katman\u0131 kullan\u0131larak ay\u0131rt etme i\u015flemi yap\u0131yoruz\n### Pooling Layer:\n\u00d6rne\u011fin resim \u00fczerinde kedinin kula\u011f\u0131n\u0131 belirledik bu 5x5 matris boyutunda olsun bu \u00e7ok b\u00fcy\u00fck yer kaplar.Bunun yerine matrisde kulak \u015feklinin say\u0131sal de\u011ferini ya da maximum de\u011ferini tutar\u0131z.B\u00f6ylelikle tek bir say\u0131 ile kula\u011f\u0131 ifade etmi\u015f oluruz.M\u00fckkemmel bir h\u0131z kazanm\u0131\u015f oluruz.Daha sonraki ad\u0131mda ise kedinin farkl\u0131 pozisyonlar\u0131 de\u011ferlendirilir \u00f6rne\u011fin amuda kalkm\u0131\u015f bir kedinin yada sa\u011fa bakan bir kedinin kula\u011f\u0131n\u0131 alg\u0131lamay\u0131 ba\u015farmak gerek.Sabit bir a\u00e7\u0131dan de\u011fil t\u00fcm a\u00e7\u0131lardan kontrol etmek gerek.\n### Max Pooling:\nAma\u00e7 boyut k\u00fc\u00e7\u00fcltmektir.\u00c7ok b\u00fcy\u00fck boyutlar bize zaman kaybettirir.Max pooling de matris i\u00e7inde ki en b\u00fcy\u00fck de\u011feri se\u00e7eriz.\n### Flatting:\n\u00d6rne\u011fin elimizde 2x2 bir matris olsun.Bu matrisi 4x1'lik formata \u00e7evirmeye flatting\n","de8258ff":"![image.png](attachment:image.png) 5x5'lik bir girdiye doldurma yaparak 25 tane 3x3'luk par\u00e7a c\u0131karmak\n","9f4b5bf8":"** Evri\u015fim i\u015flemi 3B girdi nitelik haritas\u0131 \u00fczerinde 3x3 veya 5x5'lik pencereyi kayd\u0131rarak her noktadan 3B par\u00e7alar (pecere_yuksekli\u011fi,pencere_geni\u015fli\u011fi,giri\u015f_derinli\u011fi) \u00e7\u0131kar\u0131r.Sonra t\u00fcm 3B par\u00e7alar 1B vekt\u00f6r \u015fekline (output_depth) d\u00f6n\u00fc\u015ft\u00fcr\u00fcl\u00fcr.Bu haritan\u0131n uzay koordinatlar\u0131ndaki her noktas\u0131 girdi nitelik haritas\u0131nda ayn\u0131 noktaya kar\u015f\u0131l\u0131k gelir.\u00d6rne\u011fin \u00e7\u0131kt\u0131n\u0131n sol \u00fcst k\u00f6\u015fesi girdinin sol \u00fcst k\u00f6\u015fesi hakk\u0131nda bilgi ta\u015f\u0131r.\u00d6rne\u011fin 3x3'lik filtreler kullan\u0131ld\u011f\u0131n da output[i,j,:] vekt\u00f6r\u00fc input[i-1 : i+1, j-1 : j+1, : ] 3B par\u00e7alar\u0131ndan gelir.Detayl\u0131 i\u015flem i\u00e7in \u015fekle bak\u0131n\u0131z **\n![image.png](attachment:image.png)\n\n**NOT!!:Burada \u00e7\u0131kt\u0131n\u0131n geni\u015fili\u011fi ve y\u00fcksekli\u011finin girdinin geni\u015fli\u011fi ve y\u00fcksekli\u011finden farkl\u0131 olabilece\u011fini unutmay\u0131n.Bunun iki nedeni vard\u0131r:**\n\n**Kenar Etkisi(Border Effect): girdi nitelik haritas\u0131na yap\u0131lacak doldurma(padding) i\u015flemi ile \u00e7\u00f6z\u00fclebilir.Conv2D katmalar\u0131nda doldurma padding parametresi ile yap\u0131land\u0131r\u0131labilir \"valid\" doldurma olmamas\u0131, \"same\" \u00e7\u0131kt\u0131n\u0131n girdi ile ayn\u0131 boyutta olmas\u0131 i\u00e7in gereken doldurman\u0131n yap\u0131lmas\u0131 anl\u0131mana gelir.Padding parametresinin \u00f6ntan\u0131ml\u0131 de\u011feri \"valid\" dir**\n\n**Same Padding=>\u00d6rne\u011fin elimizde 5x5 bir matrisden olu\u015fan bir resim olsun.\u00dczerine 3x3 bir filitre matris uygulayal\u0131m ve \u00e7\u0131kan matris sonucu 3x3 olur.Ancak bu istedi\u011fimiz bir \u015fey de\u011fil c\u00fcnk\u00fc veri ve bilgi kaybediyoruz. Bu y\u00fczden same padding y\u00f6ntemini kullan\u0131yoruz.5x5^lik olan matrisimizi yanlar\u0131na 0 koyarak 7x7 format\u0131na d\u00f6n\u00fc\u015ft\u00fcr\u00fcp onun \u00fczerine 3x3 filitre uyguluyoruz ve sonu\u00e7 5x5 oluyor**\n![image.png](attachment:image.png)                                \u015fekilde 5x5'lik bir girdide ge\u00e7erli 3x3'luk par\u00e7alar\n","e505f829":"*conv2d_2 (3,3,64) \u015feklinde olan \u00e7\u0131kt\u0131lar iki \u00fcst \u00fcste Dense(dense_2 ve dense_3) katman\u0131na girmeden \u00f6nce =>3 *3 *64=(576,) boyutuna d\u00fczle\u015ftirildi*\n### \u015eimdi a\u011f\u0131 MNIST \u00fczerinde e\u011fitebiliriz:\n","c03448e2":"*T\u00fcm Conv2D ve MaxPooling2D katmanlar\u0131n\u0131n \u00e7\u0131kt\u0131lar\u0131 (y\u00fckselik,geni\u015flik,kanal(renk i\u00e7in)) \u015feklinde bir 3B tens\u00f6r olmaktad\u0131r.Yani elimizdeki \u00e7\u0131kt\u0131lar 3B boyutlu.Dolay\u0131s\u0131yla ilk \u00f6nce 3B \u00e7\u0131kt\u0131lar\u0131 1B vekt\u00f6re d\u00fczle\u015ftirece\u011fiz(flatting i\u015flemi) ve birka\u00e7 Dense katman\u0131ndan ge\u00e7irece\u011fiz. Buraya kadar hi\u00e7 bir\u015fey anlamaman\u0131z normal ancak usanmadan devam edin anlayacaks\u0131n\u0131z :)*","e3dfdc4e":"## 1.0 Giri\u015f\n\n*\u00d6rne\u011fimiz de MNIST veri setini kullanaca\u011f\u0131z. A\u015fa\u011f\u0131daki kod \u00f6be\u011finde evri\u015fimli sinir a\u011flar\u0131n\u0131n neye benzedi\u011fini g\u00f6receksiniz.Conv2D ve MaxPooling2D katmanlar\u0131n\u0131n \u00fcst \u00fcste getirilmesiyle olu\u015fturulmaktad\u0131r.Neler yapabildiklerini az sonra g\u00f6receksiniz*","2b1082b9":"**Evri\u015fim 3B tens\u00f6rler \u00fczerinde i\u015flem yapar.Bu tens\u00f6r nitelik haritas\u0131 ad\u0131n\u0131 al\u0131r(Feature Map)**\n\n**Feature Map:Kedinin g\u00f6z\u00fc kuyru\u011fu kula\u011f\u0131 gibi nesneler belirlendikten sonra hangisinin ne oldu\u011funu anlamak Feature Map sayesinde ger\u00e7ekle\u015fir**\n\n**MNIST \u00f6rne\u011finde ilk evir\u015fim katman\u0131 (28,28,1) boyutunda nitelik haritas\u0131 al\u0131r ve (26,26,32) boyutunda bir nitelik \u00e7\u0131kt\u0131 \u00fcretir.Yani girdi \u00fczerinde 32 filtre hesaplar.Bu 32 \u00e7\u0131kt\u0131 kanal\u0131 da 26x26'l\u0131k grid de\u011ferleri bulundurur ve filtre,girdi \u00fczerine uyguland\u0131\u011f\u0131n da cevap haritas\u0131n\u0131(output feature map)  verir.Bu filtrenin girdinin farkl\u0131 b\u00f6lgerine cevab\u0131 i\u00e7in \u015fekle bak\u0131n\u0131z**\n![image.png](attachment:image.png)\n\n**Nitelik \u00e7\u0131kt\u0131 haritas\u0131n\u0131n derinli\u011fi-Evri\u015fim esnas\u0131nda hesaplanacak filtre say\u0131s\u0131d\u0131r.\u00d6rne\u011fimizde 32 ile ba\u015fl\u0131y\u0131p 64 ile bitirdik.\nKeras'ta Conv2D katman\u0131 bu iki parametreyi ilk iki parametre olarak almaktad\u0131r. =>Conv2D(\u00e7\u0131kt\u0131_derinli\u011fi),pencere_y\u00fcksekli\u011fi,pencere_geni\u015fli\u011fi)**","e18366a0":"# 1.1 EVR\u0130\u015e\u0130M \u0130\u015eLEM\u0130\n*Tamamen ba\u011fl\u0131 katman ve evri\u015fim katman\u0131 aras\u0131ndaki fark \u015fudur:Dense katmanlar kendi girdilerinin nitelik uzay\u0131bdaki global \u00f6r\u00fcnt\u00fclerini \u00f6\u011frenirken evri\u015fimli katman b\u00f6lgesel \u00f6r\u00fcnt\u00fcleri \u00f6\u011frenir.[![image.png](attachment:image.png)](http:\/\/)(\u015eekile bak\u0131n\u0131z.)Resimler i\u00e7in konu\u015facak olursak girdilerden k\u00fc\u00e7\u00fck iki boyutlu pencereler \u00f6\u011frenirler.Bir \u00f6nceki \u00f6rne\u011fimiz de bunlar 3x3 boyuntundayd\u0131lar*\n\n### Bu anahtar \u00f6zellik evri\u015fimli sinir a\u011flar\u0131na iki ilgin\u00e7 nitelik vermektedir.\n*\u00d6\u011frendikleri \u00f6r\u00fcnt\u00fcler y\u00f6n de\u011fi\u015fmezdir.Bir resmin sol alt k\u00f6\u015fesinde \u00f6\u011frendi\u011fi bir \u00f6r\u00fcnt\u00fcy\u00fc her yerde tan\u0131yabilir.Tamamen ba\u011fl\u0131 a\u011flarda b\u00f6yle bir \u015fey s\u00f6z konusu de\u011fildir.Buda evri\u015fimli sinir a\u011flar\u0131n\u0131 g\u00f6r\u00fcnt\u00fc i\u015flemede etkin bir hale getiriyor ve daha az veri ile gennele\u015ftirme g\u00fcc\u00fc y\u00fcksek g\u00f6sterimleri \u00f6\u011frenebilmektedir*\n\n","b5b0b3f4":"### Bu mimaride hatal\u0131 olan \u015fey nedir ? Asl\u0131na iki \u015fey var.\n\n**1-)Uzan\u0131msal hiyerar\u015fileri \u00f6\u011frenmeye olanak sa\u011flamaz.\u00dc\u00e7\u00fcnc\u00fc katmandaki 3x3'l\u00fck bir pencere ba\u015flang\u0131\u00e7 girdisi 7x7'lik bir pencereden gelen bilgiyi i\u00e7erecektir.\u0130lk girdi boyutuna g\u00f6re y\u00fcksek seviyeli \u00f6r\u00fcnt\u00fcler k\u00fc\u00e7\u00fck kalacakt\u0131r ve rakamlar s\u0131n\u0131fland\u0131rmay\u0131 \u00f6\u011frenemeyecektir.**\n\n**2-)Son nitelik haritas\u0131 \u00f6rnek ba\u015f\u0131na 22x22x64=30976 katsay\u0131ya sahiptir.E\u011fer bu katman\u0131n \u00fczerine 512 boyutunda bir Dense katman\u0131 koyarsan\u0131z,bu katman\u0131n 15.8 milyon parametresi olur.Bu kadar k\u00fc\u00e7\u00fck bir model i\u00e7in \u00e7ok fazla muhtemelen a\u015f\u0131r\u0131 uydurma ile sonu\u00e7lan\u0131r.**\n\nK\u0131saca,boyut k\u00fc\u00e7\u00fcltme yapmam\u0131z\u0131n nedeni daha az katsay\u0131ya i\u015flem yapmak ve uzamsal hiyerar\u015fileri ortaya \u00e7\u0131karacak \u015feklilde evri\u015fim katmanlar\u0131n\u0131 her seferinde daha b\u00fcy\u00fck pencerelere bakt\u0131rmakt\u0131r."}}