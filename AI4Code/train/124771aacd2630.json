{"cell_type":{"d727bce1":"code","3f17b1f9":"code","bfc0c674":"code","418c3b53":"code","5b0df8f8":"code","011bb038":"code","60d072df":"code","266763cf":"code","02d03427":"code","1d900121":"code","2c3ad334":"code","843129c7":"code","75c77614":"markdown","93848258":"markdown","bc40a176":"markdown"},"source":{"d727bce1":"!pip install autoxgb","3f17b1f9":"# Importing Libraries\nimport numpy as np \nimport pandas as pd \n\nfrom sklearn.model_selection import StratifiedKFold, KFold\nfrom sklearn.metrics import accuracy_score, roc_auc_score\nfrom sklearn.preprocessing import RobustScaler\nfrom sklearn.experimental import enable_iterative_imputer\nfrom sklearn.impute import IterativeImputer\n\nfrom autoxgb import AutoXGB","bfc0c674":"# Path\ntrain_path = \"..\/input\/song-popularity-prediction\/train.csv\"\ntest_path = \"..\/input\/song-popularity-prediction\/test.csv\"","418c3b53":"# Read Data\ntrain_df = pd.read_csv(train_path)\ntest_df = pd.read_csv(test_path)\nids = test_df[\"id\"]\n\ntrain_df","5b0df8f8":"# Check for Null values in train data\ntrain_df.isnull().sum()","011bb038":"# Check for Null values in test data\ntest_df.isnull().sum()","60d072df":"features = [f for f in train_df.columns if f not in(\"id\",\"fold\",\"song_popularity\")]","266763cf":"features","02d03427":"# Drop Null values & ID as they are not useful\nimputer = IterativeImputer()\n\ntrain_df_temp = pd.DataFrame(imputer.fit_transform(train_df[features]))\ntest_df_temp = pd.DataFrame(imputer.transform(test_df[features]))\n\ntrain_df_temp.columns = features\ntest_df_temp.columns = features\n\ntrain_df = pd.concat([train_df_temp, train_df[\"song_popularity\"]], axis = 1)\ntest_df = test_df_temp\n\ntrain_df.to_csv(\".\/train_imputer.csv\", index = False)\ntest_df.to_csv(\".\/test_imputer.csv\", index = False)","1d900121":"# Define Model parameters\ntrain_filename = \".\/train_imputer.csv\"\noutput =  '\/kaggle\/working\/auto_xgb'\ntest_filename = \".\/test_imputer.csv\"\n\ntask = \"classification\"\ntargets = [\"song_popularity\"]\nidx = \"id\"\nfeatures = features\nuse_gpu = True\nnum_folds = 5\nseed = 42\nnum_trials = 2000\ntime_limit = 3600\nfast = False\n\n\n# Now its time to train the model!\naxgb = AutoXGB(\n    train_filename=train_filename,\n    output=output,\n    test_filename=test_filename,\n    task=task,\n    idx=idx,\n    targets=targets,\n    features=features,\n    use_gpu=use_gpu,\n    num_folds=num_folds,\n    seed=seed,\n    num_trials=num_trials,\n    time_limit=time_limit,\n    fast=fast,\n)\naxgb.train()","2c3ad334":"# Make submission file\nsub = pd.read_csv(\".\/auto_xgb\/test_predictions.csv\")\nfinal = pd.DataFrame()\nx = pd.read_csv(test_path)\nfinal[\"id\"] = ids\nfinal[\"song_popularity\"] = sub[\"1\"]\nfinal.to_csv(\"submission.csv\", index = False)","843129c7":"final.head()","75c77614":"## Data Preprocessing","93848258":"## Import Libraries & Read Data","bc40a176":"## Train Model"}}