{"cell_type":{"874b9d38":"code","91c61120":"code","051f9b28":"code","e587c0f6":"code","fae9d518":"code","390e8ea9":"code","46ea4e1a":"code","ad86c16f":"code","10a8dc27":"code","fd69269e":"code","8b46fe87":"code","d16c3894":"code","aef404c1":"code","2f9cfba6":"code","1e185247":"code","f3d794a7":"code","94ae159a":"code","bbaac5e4":"code","65d51dd3":"code","06935c16":"code","c326d6c2":"code","870eff57":"markdown","e4cf53c7":"markdown","5a229ee7":"markdown"},"source":{"874b9d38":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns","91c61120":"df = pd.read_csv('..\/input\/water-potability\/water_potability.csv')\ndf","051f9b28":"# checking missing value\ndf_missing = df.isna().sum()\nprint(df_missing[df_missing > 0])","e587c0f6":"# potability check value\nsns.countplot(data=df, x='Potability')","fae9d518":"plt.figure(figsize=(12, 8))\nsns.heatmap(data=df.corr(), annot=True)\nplt.show()","390e8ea9":"df.dtypes","46ea4e1a":"df.describe()","ad86c16f":"from sklearn.model_selection import train_test_split\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.model_selection import RandomizedSearchCV\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.compose import ColumnTransformer\nfrom sklearn.impute import SimpleImputer\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.ensemble import RandomForestClassifier","10a8dc27":"X = df.drop('Potability', axis=1)\ny = df.Potability\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, stratify=y, random_state=42)","fd69269e":"numerical_pipeline = Pipeline([\n    ('scaler', StandardScaler()),\n    ('impute', SimpleImputer(strategy='median'))\n])","8b46fe87":"preprocessor = ColumnTransformer([\n    ('numeric', numerical_pipeline, X_train.columns)\n])","d16c3894":"pipeline = Pipeline([\n    ('pre', preprocessor),\n    ('algo', RandomForestClassifier(random_state=42))\n])","aef404c1":"pipeline.fit(X_train, y_train)","2f9cfba6":"pipeline.score(X_train, y_train), pipeline.score(X_test, y_test)","1e185247":"pipeline.get_params()","f3d794a7":"parameter = {\n    'algo__n_estimators':[100,200, 350, 500], \n    'algo__min_samples_leaf':[2, 10, 30]\n}","94ae159a":"model = GridSearchCV(pipeline, parameter, cv=5, n_jobs=-1, verbose=1)\nmodel.fit(X_train, y_train)","bbaac5e4":"model.score(X_train, y_train), model.score(X_test, y_test)","65d51dd3":"from sklearn.metrics import accuracy_score\nfrom sklearn.metrics import f1_score","06935c16":"y_pred = model.predict(X_test)\naccuracy = accuracy_score(y_test, y_pred)\nf_acc = f1_score(y_test, y_pred)\n\nprint(accuracy)\nprint(f_acc)","c326d6c2":"output = pd.DataFrame({'Potability': y_pred})\noutput.to_csv('submission.csv', index=False)","870eff57":"## **Evalution**","e4cf53c7":"## **Exploratory Data Analysis**","5a229ee7":"have a bad correlation"}}