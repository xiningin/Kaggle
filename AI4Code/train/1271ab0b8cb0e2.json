{"cell_type":{"e1afeb94":"code","f6f33b50":"code","2d01972d":"code","6bac0e17":"code","5fb6c2a7":"code","023235df":"code","748e7479":"code","84b1b001":"code","e62a5c59":"code","f5fa4d25":"code","6646a6c9":"code","f6287be7":"code","f7672a6d":"code","c3d37be2":"code","f6fde556":"code","0f709b4c":"code","e2a282c8":"code","366fdc7e":"code","bbba081d":"code","bebb5737":"markdown","9f113dd8":"markdown","33a10507":"markdown","c32f2667":"markdown"},"source":{"e1afeb94":"import numpy as np \nimport pandas as pd\nimport matplotlib.pyplot as plt\n\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.preprocessing import StandardScaler\n\nfrom sklearn.cluster import KMeans\nfrom sklearn.decomposition import PCA","f6f33b50":"data=pd.read_csv('..\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv')","2d01972d":"data","6bac0e17":"data.drop('CustomerID', axis=1,inplace=True)","5fb6c2a7":"encoder = LabelEncoder()\ndata['Gender'] = encoder.fit_transform(data['Gender'])\ndata","023235df":"plt.figure(figsize=(7, 5))\nplt.bar(data.Age,data['Annual Income (k$)'])\nplt.xlabel('Age')\nplt.ylabel('Income')\nplt.show()","748e7479":"scaler=StandardScaler()\nscaled_data=pd.DataFrame(scaler.fit_transform(data), columns=data.columns)","84b1b001":"scaled_data","e62a5c59":"max_clusters=50","f5fa4d25":"kmeans_tests = [KMeans(n_clusters=i, n_init=10) for i in range(1, max_clusters)]\ninertias = [kmeans_tests[i].fit(scaled_data).inertia_ for i in range(len(kmeans_tests))]","6646a6c9":"inertias","f6287be7":"#Elbow Method:- Used to know the K or no. of clusters\nplt.figure(figsize=(7, 5))\nplt.plot(range(1, max_clusters), inertias)\nplt.xlabel(\"Number of Clusters\")\nplt.ylabel(\"Inertia\")\nplt.title(\"Choosing the Number of Clusters\")\nplt.show()","f7672a6d":"kmeans=KMeans(n_clusters=10,n_init=10)\ncluster=kmeans.fit_predict(scaled_data)\ncluster","c3d37be2":"scaled_data['clusters']=cluster\nscaled_data.head()","f6fde556":"pca = PCA(n_components=2)\nreduced_data = pd.DataFrame(pca.fit_transform(scaled_data), columns=['PC1','PC2'])\nreduced_data","0f709b4c":"kmeans.cluster_centers_","e2a282c8":"reduced_centers=pca.fit_transform(kmeans.cluster_centers_)\nreduced_centers","366fdc7e":"reduced_data['clusters'] = cluster\nreduced_data","bbba081d":"plt.figure(figsize=(14, 10))\n\nplt.scatter(reduced_data[reduced_data['clusters'] == 0].loc[:, 'PC1'], reduced_data[reduced_data['clusters'] == 0].loc[:, 'PC2'], color='red')\nplt.scatter(reduced_data[reduced_data['clusters'] == 1].loc[:, 'PC1'], reduced_data[reduced_data['clusters'] == 1].loc[:, 'PC2'], color='blue')\nplt.scatter(reduced_data[reduced_data['clusters'] == 2].loc[:, 'PC1'], reduced_data[reduced_data['clusters'] == 2].loc[:, 'PC2'], color='yellow')\nplt.scatter(reduced_data[reduced_data['clusters'] == 3].loc[:, 'PC1'], reduced_data[reduced_data['clusters'] == 3].loc[:, 'PC2'], color='orange')\nplt.scatter(reduced_data[reduced_data['clusters'] == 4].loc[:, 'PC1'], reduced_data[reduced_data['clusters'] == 4].loc[:, 'PC2'], color='cyan')\nplt.scatter(reduced_data[reduced_data['clusters'] == 5].loc[:, 'PC1'], reduced_data[reduced_data['clusters'] == 5].loc[:, 'PC2'], color='black')\nplt.scatter(reduced_data[reduced_data['clusters'] == 6].loc[:, 'PC1'], reduced_data[reduced_data['clusters'] == 6].loc[:, 'PC2'], color='brown')\nplt.scatter(reduced_data[reduced_data['clusters'] == 7].loc[:, 'PC1'], reduced_data[reduced_data['clusters'] == 7].loc[:, 'PC2'], color='pink')\nplt.scatter(reduced_data[reduced_data['clusters'] == 8].loc[:, 'PC1'], reduced_data[reduced_data['clusters'] == 8].loc[:, 'PC2'], color='green')\nplt.scatter(reduced_data[reduced_data['clusters'] == 9].loc[:, 'PC1'], reduced_data[reduced_data['clusters'] == 9].loc[:, 'PC2'], color='purple')\n\n\nplt.xlabel(\"PC1\")\nplt.ylabel(\"PC2\")\n\nplt.show()","bebb5737":"**EDA**","9f113dd8":"**Clustering**","33a10507":"**PCA**","c32f2667":"**Data Visualization**"}}