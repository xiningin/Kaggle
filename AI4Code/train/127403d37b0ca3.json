{"cell_type":{"327d7957":"code","b65ea88f":"code","f75f09fc":"code","915e77e2":"code","51f81617":"code","8a59379a":"code","581e4f02":"code","e276198f":"code","2626f33c":"code","02656bf1":"code","c0531667":"code","d5e6fe78":"code","aa0cc20c":"code","cdccb599":"code","1535a128":"code","eaf63150":"code","5abce7d5":"code","1ea9dffc":"code","ba711dcb":"code","5f253de1":"code","b0f0fe5b":"code","fc7dbdb9":"code","02c084ce":"code","3e14b8dd":"code","4e0774fd":"markdown","263e4a31":"markdown","32de5fab":"markdown","83c42436":"markdown","e94fb266":"markdown","d7d12440":"markdown","914cb0e1":"markdown","39b28e81":"markdown","89e24a1a":"markdown","1102e307":"markdown","8d0f346f":"markdown","9753d25d":"markdown","430ff48d":"markdown","200da381":"markdown","94623684":"markdown","8cce258e":"markdown","0083cd29":"markdown","be42faf0":"markdown","3766ef66":"markdown","e2bc9d66":"markdown","e5330dc9":"markdown","0f0b6ee9":"markdown"},"source":{"327d7957":"!git clone https:\/\/github.com\/KI-labs\/ML-Navigator.git ML_Navigator","b65ea88f":"!cp -fr .\/ML_Navigator\/* .\/\n!rm -r .\/ML_Navigator\n!rm -r .\/docs","f75f09fc":"!cat requirements.txt | xargs -n 1 pip install","915e77e2":"from flows.flows import Flows","51f81617":"flow = Flows(3)","8a59379a":"path = '\/kaggle\/input\/ieee-fraud-detection\/'\nfiles_list = ['train_transaction.csv','test_transaction.csv']","581e4f02":"dataframe_dict, columns_set = flow.load_data(path, files_list, rows_amount=10000)","e276198f":"dataframe_dict[\"train_transaction\"].head()","2626f33c":"files_list_2 = ['train_identity.csv','test_identity.csv']\ndataframe_dict_identity, columns_set_identity = flow.load_data(path, files_list_2, rows_amount=10000)","02656bf1":"dataframe_dict_identity[\"train_identity\"].head()","c0531667":"import pandas as pd\ndataframe_train =  pd.merge(dataframe_dict[\"train_transaction\"],\n                            dataframe_dict_identity[\"train_identity\"], how=\"left\",\n                            on='TransactionID') \ndataframe_test = pd.merge(dataframe_dict[\"test_transaction\"],\n                            dataframe_dict_identity[\"test_identity\"], how=\"left\",\n                            on='TransactionID') ","d5e6fe78":"print(dataframe_train.shape)\nprint(dataframe_test.shape)","aa0cc20c":"dataframe_dict = {}\ndataframe_dict[\"train\"] = dataframe_train\ndataframe_dict[\"test\"] = dataframe_test","cdccb599":"columns_set = flow.update_data_summary(dataframe_dict)","1535a128":"dataframe_dict, columns_set = flow.encode_categorical_feature(dataframe_dict, print_results=10)","eaf63150":"ignore_columns = ['isFraud']","5abce7d5":"dataframe_dict, columns_set = flow.drop_columns_constant_values(dataframe_dict, ignore_columns)","1ea9dffc":"dataframe_dict, columns_set = flow.drop_correlated_columns(dataframe_dict, ignore_columns)","ba711dcb":"ignore_columns = [\"TransactionID\", \"isFraud\"]","5f253de1":"dataframe_dict, columns_set = flow.scale_data(dataframe_dict, ignore_columns)","b0f0fe5b":"flow.exploring_data(dataframe_dict, \"train\")","fc7dbdb9":"columns = dataframe_dict[\"train\"].columns\ntotal_columns = columns_set[\"train\"][\"continuous\"] +\\\ncolumns_set[\"train\"][\"categorical_integer\"]\n\ntrain_dataframe = dataframe_dict[\"train\"][\n    [x for x in total_columns if x not in ignore_columns]]\ntest_dataframe = dataframe_dict[\"test\"][\n    [x for x in total_columns if x not in ignore_columns]]\ntrain_target = dataframe_dict[\"train\"][\"isFraud\"]","02c084ce":"parameters_lightgbm = {\n    \"data\": {\n        \"train\": {\"features\": train_dataframe, \"target\": train_target.to_numpy()},\n    },\n    \"split\": {\n        \"method\": \"kfold\",  # \"method\":\"kfold\"\n        \"fold_nr\": 5,  # foldnr:5 , \"split_ratios\": 0.8 # \"split_ratios\":(0.7,0.2)\n    },\n    \"model\": {\"type\": \"lightgbm\",\n              \"hyperparameters\": dict(objective='binary', metric='cross-entropy', num_leaves=5,\n                                      boost_from_average=True,\n                                      learning_rate=0.05, bagging_fraction=0.99, feature_fraction=0.99, max_depth=-1,\n                                      num_rounds=10000, min_data_in_leaf=10, boosting='dart')\n              },\n    \"metrics\": [\"accuracy_score\", \"roc_auc_score\"],\n    \"predict\": {\n        \"test\": {\"features\": test_dataframe}\n    }\n}","3e14b8dd":"model_index_list, save_models_dir, y_test = flow.training(parameters_lightgbm)","4e0774fd":"The models are saved locally in `save_models_dir`.","263e4a31":"Let us load the second dataset similar to the first dataset","32de5fab":"The ID and the target should not be scaled. Therefore, we update the `ignore_columns` variable as follows:","83c42436":"<img src=\".\/tutorials\/flow_3.png\">","e94fb266":"Here we can come back to the flow by using one command only.","d7d12440":"# ML Navigator\n\nGithub https:\/\/github.com\/KI-labs\/ML-Navigator<br>\nDocumentation: https:\/\/ki-labs.github.io\/ML-Navigator\/index.html<br>\nPypi: https:\/\/pypi.org\/project\/ML-Navigator\/<br>\n\nFor more than one and a half year I have been organizing Kaggle Munich meetup in Munich. I met a lot of interesting, smart people who would like to start their career as data scientists. Most of the time I hear the same question, which is: where should I start?\n\nThe question inspired me to think of a solution that helps data scientists to exchange knowledge in a white-box mode. That is how I come up with my first open-source project: **ML-Navigator**\n\nML-Navigator is a tutorial-based informative Machine Learning framework. The main component of ML-Navigator is the flow. A flow is a collection of compact methods\/functions that can be stuck together with guidance texts.\n\nThe flow functions as a map which shows the road from point A to point B. The guidance texts function as navigator instructions that help the user to figure out the next step after executing the current step.\n\nLike the car navigator, the user is not forced to follow the path. At any point, the user can take a break to explore data, modify the features and make any necessary changes. The user can always come back to the main path which the flow defines.\n\nThe flows are created by the community for the community. Therefore, your contributions and constructive feedback are very welcome.\n\nBig thanks to KI labs and my great team for supporting me at every step of this project.","914cb0e1":"Here we will merge both datasets. This causes that we diverge from the flow that we load.","39b28e81":"Exploring the data and comparing the statistics properties of the features from different datasets should be helpful to understand the model quality variation between training and testing datasets.","89e24a1a":"# Why ML-Navigator\nML-Navigator standardizes exchanging knowledge among data scientists. Junior data scientists can learn and apply data science best-practice in a white-box mode. Senior data scientists can automate many repetitive processes and share experience effectively. Enterprises can standardize data science among different departments.","1102e307":"Run the following commands to install ML-Navigator successfully and to ensure a successful kernel commit:","8d0f346f":"## Quick Start","9753d25d":"# Summary\nML-Navigator provides out of the box informative tools that help the user to get knowing the data before proceeding to the next steps. The flow helps the user to figure out how different Machine Learning components are working together. The user can modify the flow on the fly to adapt case-specific required changes. Last but not least, ML-Navigator helps to exchange experiences systemically and cleanly. Your feedback and your contributions are very welcome.","430ff48d":"Preparing the data for training by ensuring that all datasets contains the same features as the training dataset:","200da381":"As you can see above, the method `load_data` provides a summary of every dataset. It can figure out which type of data that each column contains. Moreover, it can find out which columns are the best candidates for the id and for the target that should be predicted. It figures out the type of problem that should be solved. In this example, it is a classification problem.","94623684":"## Install ML-Navigator\nThe normal way for installing ML-Navigator is use the `pip` tool:\n\n`pip install ML-Navigator`\n\nSince the Kaggle kernels don't support most of the recent versions of the Python libraries you need to install ML-Navigator from the Github repository.","8cce258e":"Define the parmaters object for training the model using the LightGBM using K-Fold method. Five folds are used. If the `predict` key is defined, the model is used to calculate the target for test dataset.","0083cd29":"How to apply the flow to your data? It is straightforward. You need to point to the location of your data and the name of the datasets after loading a particular flow. Currently, the framework supports only reading CSV files.","be42faf0":"In case of large dataset, you can use `rows_amount` variable to limit the number of the rows that are loaded.","3766ef66":"The visualization of the flow helps to get a general overview about operations that are included in this flow.","e2bc9d66":"The next step is to encode the categorical variables","e5330dc9":"Run the following command to ensure that the recent Python libraries are installed","0f0b6ee9":"For dropping columns with constant values and highly correlated columns, it is a good idea to exclude some important columns that we want to keep them in the dataset, e.g. the target."}}