{"cell_type":{"52c0e45f":"code","046f365a":"code","cf7571e8":"code","8f362325":"code","245a0e88":"code","6e2140ef":"code","16553cf4":"code","901c9410":"code","a505fa3e":"code","dee0ce4b":"code","3409f45b":"code","81c4a1e2":"code","aa387113":"code","11978f09":"code","2027927c":"code","c4ecf977":"code","ab0ed3ec":"code","40a0f085":"code","3f37081f":"code","9ddb9072":"code","aab6a5dd":"code","d2d41fa0":"code","a75c6d0c":"code","7b498903":"code","3db54924":"code","ee86f0e4":"code","64a34189":"code","beb68e50":"code","48a5a236":"code","9ef0f763":"markdown","4c212bf5":"markdown","d448ba02":"markdown","014be805":"markdown","4b1f6974":"markdown"},"source":{"52c0e45f":"str_save_filename = 'Genes_pro-angiogenic_proliferative_action_on_endothelial_cells.csv'\nlist_proangiogenic_prolif = ['Vegfa', 'Vegfb', 'Vegfc', 'Vegfd','Angpt1','Angpt2','Flt1','Sema3a','Sema3f','Fgf2','Pgf','Hgf','Slit1','Slit2','Svep1','Ccbe1','Adamts3','Adamts9','Adamts1','Adamts18','Tgfb1','Tgfb2','Tgfb3','Dll4','Dll1','Bmp9','Bmp10','Pdgfb','Apln']\nlist_genes = list_proangiogenic_prolif\nprint(len(list_genes),list_genes)","046f365a":"import numpy as np\nimport pandas as pd \nimport time \nimport matplotlib.pyplot as plt","cf7571e8":"!pip install mygene\nimport mygene\n\nmg = mygene.MyGeneInfo()\ng = mg.getgene('ENSG00000000003') # return info on ensemble gene with id 'ENSG00000000003'\nprint(type(g )) # dictionary\nprint(len(g.keys() ))  # 37\nprint((g.keys() ))  \n\nprint()\nprint( str(g)[:2000])","8f362325":"print('Mouse')\ngname = list_genes[0]\ng = mg.query('symbol:'+gname, species='mouse')\nprint(str(g)[:500])\nentrez_gene_ID = g['hits'][0]['_id']\ng = mg.getgene(entrez_gene_ID)\nprint(str(g)[:500])\nprint(g['summary'])\nprint()\nprint('Human')\ng = mg.query('symbol:'+gname, species='human')\nprint(str(g)[:500])\nentrez_gene_ID = g['hits'][0]['_id']\ng = mg.getgene(entrez_gene_ID)\nprint(str(g)[:700])\nprint(g['summary'])\n","245a0e88":"S_phase_genes_Tirosh = ['MCM5', 'PCNA', 'TYMS', 'FEN1', 'MCM2', 'MCM4', 'RRM1', 'UNG', 'GINS2', 'MCM6', 'CDCA7', 'DTL', 'PRIM1', 'UHRF1', 'MLF1IP', 'HELLS', 'RFC2', 'RPA2', 'NASP', 'RAD51AP1', 'GMNN', 'WDR76', 'SLBP', 'CCNE2', 'UBR7', 'POLD3', 'MSH2', 'ATAD2', 'RAD51', 'RRM2', 'CDC45', 'CDC6', 'EXO1', 'TIPIN', 'DSCC1', 'BLM', 'CASP8AP2', 'USP1', 'CLSPN', 'POLA1', 'CHAF1B', 'BRIP1', 'E2F8']\nG2_M_genes_Tirosh = ['HMGB2', 'CDK1', 'NUSAP1', 'UBE2C', 'BIRC5', 'TPX2', 'TOP2A', 'NDC80', 'CKS2', 'NUF2', 'CKS1B', 'MKI67', 'TMPO', 'CENPF', 'TACC3', 'FAM64A', 'SMC4', 'CCNB2', 'CKAP2L', 'CKAP2', 'AURKB', 'BUB1', 'KIF11', 'ANP32E', 'TUBB4B', 'GTSE1', 'KIF20B', 'HJURP', 'CDCA3', 'HN1', 'CDC20', 'TTK', 'CDC25C', 'KIF2C', 'RANGAP1', 'NCAPD2', 'DLGAP5', 'CDCA2', 'CDCA8', 'ECT2', 'KIF23', 'HMMR', 'AURKA', 'PSRC1', 'ANLN', 'LBR', 'CKAP5', 'CENPE', 'CTCF', 'NEK2', 'G2E3', 'GAS2L3', 'CBX5', 'CENPA']\n\nurl = 'https:\/\/raw.githubusercontent.com\/chervov\/genes\/main\/cell_cycle_genes_reactome_extended.txt'\ncell_cycle_genes_reactome_extended = pd.read_csv(url,header= None)\ncell_cycle_genes_reactome_extended = list(cell_cycle_genes_reactome_extended[0].unique())\nprint( len(cell_cycle_genes_reactome_extended), cell_cycle_genes_reactome_extended[:10] )","6e2140ef":"import time\ngenes = pd.DataFrame()#df.copy()\nt0 = time.time()\nIX = 0\nlist_exceptions = []\nfor i,gname in enumerate(list_genes): \n    IX += 1\n    genes.loc[IX,'Gene'] = gname\n    if gname.upper() in S_phase_genes_Tirosh:\n        genes.loc[IX,'CCPhase'] = 'G1S'\n    elif gname.upper() in G2_M_genes_Tirosh:\n        genes.loc[IX,'CCPhase'] = 'G2M'\n    else:\n        genes.loc[IX,'CCPhase'] = np.nan\n    if gname.upper() in cell_cycle_genes_reactome_extended:\n        genes.loc[IX,'CCReactome'] = 1\n    else:\n        genes.loc[IX,'CCReactome'] = 0\n        \n        \n    #try:\n    if 1:\n        list_genes_exceptions = ['MLF1IP', 'UBR7', 'CASP8AP2', 'FAM64A', 'HN1','Bmp9']\n        if gname in list_genes_exceptions: # Exception list processed manually, mygene does not return \n            #list_entrez = [79682, 55148, 9994, 54478, 51155]\n            entrez_gene_ID = [79682, 55148, 9994, 54478, 51155,2658][list_genes_exceptions.index(gname) ]\n        else:\n            g = mg.query('symbol:'+gname.upper(), species='human')\n            entrez_gene_ID = g['hits'][0]['_id']\n            \n        g = mg.getgene(entrez_gene_ID)# query by Entrez id\n\n        if isinstance(g['ensembl'],list): # Stangely for UBR7 ENSG00000012963, there is second: ENSG00000278787\n            genes.loc[IX,'Ensembl Human'] = g['ensembl'][0]['gene']\n        else:\n            genes.loc[IX,'Ensembl Human'] = g['ensembl']['gene']\n        \n        if 1: # Get Ensembl for MOUSE\n            if gname == 'MLF1IP': # Exception mygene cannot regonize that symbol neither from alias list\n                genes.loc[IX,'Ensembl Mouse'] = 'ENSMUSG00000031629'\n            elif gname == 'UBR7':\n                genes.loc[IX,'Ensembl Mouse'] = 'ENSMUSG00000041712'\n            elif gname == 'CASP8AP2':\n                genes.loc[IX,'Ensembl Mouse'] = 'ENSMUSG00000028282'\n            elif gname == 'FAM64A': # Pimreg \n                genes.loc[IX,'Ensembl Mouse'] = 'ENSMUSG00000020808'\n            elif gname == 'HN1': #  \n                genes.loc[IX,'Ensembl Mouse'] = 'ENSMUSG00000020737'\n            elif gname == 'Bmp9': #  \n                genes.loc[IX,'Ensembl Mouse'] = 'ENSMUSG00000072625'\n            else:\n                if 'symbol' in g.keys():\n                    symb = g['symbol']\n                else:\n                    symb = gname\n                g_2 = mg.query('symbol:'+symb[0].upper()+symb[1:].lower(), species='mouse')\n                entrez_gene_ID_2 = g_2['hits'][0]['_id']\n\n                g_2 = mg.getgene(entrez_gene_ID_2)# query by Entrez id\n\n                if isinstance(g_2['ensembl'],list): # Stangely for UBR7 ENSG00000012963, there is second: ENSG00000278787\n                    genes.loc[IX,'Ensembl Mouse'] = g_2['ensembl'][0]['gene']\n                else:\n                    genes.loc[IX,'Ensembl Mouse'] = g_2['ensembl']['gene']\n            \n\n            \n        genes.loc[IX,'Entrez'] = entrez_gene_ID\n        #g = mg.getgene(entrez_gene_ID)\n        #print(i,ens_id)\n        #print(g.keys())\n        if 'generif' in g.keys():\n            genes.loc[IX,'count pubmed'] = len(g['generif'])\n\n        genes.loc[IX,'Length'] = np.nan    \n        if  ('genomic_pos_hg19' in g.keys()) and ( isinstance(g['genomic_pos_hg19'], dict) ):\n            tmp_l = []\n            for k in ['start','end']:\n                if k in g['genomic_pos_hg19'].keys():\n                    tmp_l.append(int( g['genomic_pos_hg19'][k]) )\n            if len( tmp_l) == 2: genes.loc[IX,'Length'] = tmp_l[1] - tmp_l[0] \n                    \n\n        list1 = [ 'name', 'symbol',   'map_location' ,    'alias', 'other_names'  ] # 'type_of_gene', 'entrezgene','symbol', \n        for k in list1:\n            if k in g.keys():\n                genes.loc[IX,k] = str(g[k])\n        if  ('genomic_pos_hg19' in g.keys()) and ( isinstance(g['genomic_pos_hg19'], dict) ):\n            for k in ['chr','start','end', 'strand' ]:\n                if k in g['genomic_pos_hg19'].keys():\n                    genes.loc[IX,k] = (g['genomic_pos_hg19'][k])\n        if 'summary' in g.keys():\n            genes.loc[IX,'summary'] = g['summary']\n            \n        if 'pathway' in g.keys():\n            for p in ['kegg','reactome', 'wikipathways']:\n                if p in g['pathway'].keys():\n                    genes.loc[IX,p] = len(g['pathway'][p])\n                \n    #except:\n    if 0:\n        print()\n        print('Exception')\n        print('i', i , 'gene name' , gname)#  entrez_gene_ID, 'kaggle_id', kaggle_id )\n        list_exceptions.append(gname)\n        pass\n    \n    if i%500 == 0:\n        print(i, np.round(time.time() - t0 ,1))\n    if i >= 10e10:\n        break\n\nprint(i, 'Finished. Seconds passed: ',  np.round(time.time() - t0 ,1))\n        \ngenes\n","16553cf4":"genes.describe()","901c9410":"genes.to_csv(str_save_filename)","a505fa3e":"gname, g","dee0ce4b":"g_2 = mg.query('symbol:'+'Cenp50', species='mouse')\nprint( g_2 )\nfor gg in  ['CENP50', 'CENPU50', 'KLIP1', 'MLF1IP', 'PBIP1']:\n    g_2 = mg.query('symbol:'+gg, species='human')\n    print( g_2 )\n    \n    ","3409f45b":"g.keys(), g['symbol'], g['alias']","81c4a1e2":"symb, g_2","aa387113":"genes.columns","11978f09":"import matplotlib.pyplot as plt","2027927c":"genes[[ 'kegg','reactome', 'wikipathways' ]].describe()\n","c4ecf977":"col = 'reactome' # 'count pubmed'\nplt.plot(np.sort( genes[col].values),'*-' )\nplt.title(col)\nplt.show()\ngenes.sort_values(col,ascending = False)\n","ab0ed3ec":"genes.to_csv('Tirosh_genes_info_cell_97_main_cycle_regulators.csv')","40a0f085":"col = 'count pubmed'\nplt.plot(np.sort( genes[col].values),'*-' )\nplt.title(col)\nplt.show()\ngenes.sort_values(col,ascending = False)","3f37081f":"col = 'Length'# 'count pubmed'\nplt.plot(np.sort( genes[col].values),'*-' )\nplt.title(col)\nplt.show()\nprint(genes[col].describe())\ngenes.sort_values(col,ascending = False)","9ddb9072":"g['pathway'].keys()\n","aab6a5dd":"g['pathway']['reactome']","d2d41fa0":"g['go']","a75c6d0c":"print('Exception list analyse by hands - Entrez Id found on wikipedia and etc ')\nprint(['MLF1IP', 'UBR7', 'CASP8AP2', 'FAM64A', 'HN1'])\nlist_entrez = [79682, 55148, 9994, 54478, 51155]\nprint( )\n\nfor entrez in list_entrez:\n    g = mg.getgene(entrez)# 'MLF1IP' 'CENPU' ['CENP50', 'CENPU50', 'KLIP1', 'MLF1IP', 'PBIP1'] query by Entrez id\n    print(g['symbol'], g['alias'], str(g)[:420] )\n    print()\n\n","7b498903":"genes.columns","3db54924":"# MCM5\n# The encoded protein is upregulated in the transition from the G0 to G1\/S phase of the cell cycle and may actively participate in cell cycle regulation.\n# There is whole family: MCM2, MCM4, MCM6  - The protein encoded by this gene is one of the highly conserved mini-chromosome maintenance proteins (MCM) \n\n#SLBP G1S 31.0 19755.0 4p16.3\n#stem-loop binding protein HBP\n#This gene encodes a protein that binds to the stem-loop structure in replication-dependent histone mRNAs. Histone mRNAs do not contain introns or polyadenylation signals, and are processed by endonucleolytic cleavage. The stem-loop structure is essential for efficient processing but this structure also controls the transport, translation and stability of histone mRNAs. Expression of the protein is regulated during the cell cycle, increasing more than 10-fold during the latter part of G1. [provided by RefSeq, Jul 2008].\n\n# CTCF G2M 264.0 76776.0 16q22.1\n# CCCTC-binding factor ['CFAP108', 'FAP108', 'MRD21']\n# This gene is a member of the BORIS + CTCF gene family and encodes a transcriptional regulator protein with 11 highly conserved zinc finger (ZF) domains. This nuclear protein is able to use different combinations of the ZF domains to bind different DNA target sequences and proteins. Depending upon the context of the site, the protein can bind a histone acetyltransferase (HAT)-containing complex and function as a transcriptional activator or bind a histone deacetylase (HDAC)-containing complex and function as a transcriptional repressor. If the protein is bound to a transcriptional insulator element, it can block communication between enhancers and upstream promoters, thereby regulating imprinted expression. Mutations in this gene have been associated with invasive breast cancers, prostate cancers, and Wilms' tumors. Alternatively spliced transcript variants encoding different isoforms have been found for this gene. [provided by RefSeq, Jul 2010].\n\n\n# NEK2 G2M 112.0 12846.0 1q32.3\n# NIMA related kinase 2 ['HsPK21', 'NEK2A', 'NLK1', 'PPP1R111', 'RP67']\n# This gene encodes a serine\/threonine-protein kinase that is involved in mitotic regulation. \n# This protein is localized to the centrosome, and undetectable during G1 phase, \n# but accumulates progressively throughout the S phase, reaching maximal levels in late G2 phase. \n# Alternatively spliced transcript variants encoding different isoforms with distinct C-termini have been noted for this gene. \n# [provided by RefSeq, Feb 2011].\n\n","ee86f0e4":"for i in range(len(genes)):\n    print(genes.loc[i+1,'Gene'], genes.loc[i+1,'CCPhase'],genes.loc[i+1, 'count pubmed'],  genes.loc[i+1,'Length'], \n          genes.loc[i+1,'map_location'] )\n    print(genes.loc[i+1,'name'], genes.loc[i+1,'alias'] ) # 'symbol', 'map_location', 'alias'\n    print(genes.loc[i+1,'summary'])\n    print()\n    ","64a34189":"c = 0\nfor i in range(len(genes)):\n    if isinstance(genes.loc[i+1,'summary'], str) and ( 'G2' in genes.loc[i+1,'summary']):\n        c +=1\n        print(c, 'G2 found in summary' )\n        print(genes.loc[i+1,'Gene'], genes.loc[i+1,'CCPhase'],genes.loc[i+1, 'count pubmed'],  genes.loc[i+1,'Length'], \n              genes.loc[i+1,'map_location'] )\n        print(genes.loc[i+1,'name'], genes.loc[i+1,'alias'] ) # 'symbol', 'map_location', 'alias'\n        print(genes.loc[i+1,'summary'])\n        print()","beb68e50":"c = 0\nfor i in range(len(genes)):\n    if isinstance(genes.loc[i+1,'summary'], str) and ( 'G1' in genes.loc[i+1,'summary']):\n        c +=1\n        print(c, 'G1 found in summary' )\n        print(genes.loc[i+1,'Gene'], genes.loc[i+1,'CCPhase'],genes.loc[i+1, 'count pubmed'],  genes.loc[i+1,'Length'], \n              genes.loc[i+1,'map_location'] )\n        print(genes.loc[i+1,'name'], genes.loc[i+1,'alias'] ) # 'symbol', 'map_location', 'alias'\n        print(genes.loc[i+1,'summary'])\n        print()","48a5a236":"c = 0\nfor i in range(len(genes)):\n    if isinstance(genes.loc[i+1,'summary'], str) and ( 'cycle' in genes.loc[i+1,'summary']):\n        c +=1\n        print(c, 'cycle found in summary' )\n        print(genes.loc[i+1,'Gene'], genes.loc[i+1,'CCPhase'],genes.loc[i+1, 'count pubmed'],  genes.loc[i+1,'Length'], \n              genes.loc[i+1,'map_location'] )\n        print(genes.loc[i+1,'name'], genes.loc[i+1,'alias'] ) # 'symbol', 'map_location', 'alias'\n        print(genes.loc[i+1,'summary'])\n        print()","9ef0f763":"# Post processing information","4c212bf5":"# Genes info","d448ba02":"# Main part","014be805":"# What is about ?\n\nWe collect information (in particular different Ids) on the:\n\nList of genes with known pro-angiogenic\/proliferative action on endothelial cells\n \n\nlist_proangiogenic_prolif = ['Vegfa', 'Vegfb', 'Vegfc', 'Vegfd','Angpt1','Angpt2','Flt1','Sema3a','Sema3f','Fgf2','Pgf','Hgf','Slit1','Slit2','Svep1','Ccbe1','Adamts3','Adamts9','Adamts1','Adamts18','Tgfb1','Tgfb2','Tgfb3','Dll4','Dll1','Bmp9','Bmp10','Pdgfb','Apln']\n\n\nWe use nice Python package \"mygene\". \n\n","4b1f6974":"# Install, Import mygene package \n\nand small use example "}}