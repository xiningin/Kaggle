{"cell_type":{"1a8b79d3":"code","eb09e630":"code","0b7b9396":"code","402d0ba2":"code","a7a9fe5b":"code","06c06c18":"code","a54e55c7":"code","5ffb1657":"code","849625b1":"code","9e330706":"code","08a988a4":"markdown","82425e98":"markdown","5f9e4989":"markdown","5662c9d6":"markdown","963128bc":"markdown","220a9934":"markdown","f9c3f8db":"markdown"},"source":{"1a8b79d3":"from fastai2.vision.all import *\nfrom utils import *\nimport matplotlib.pyplot as plt","eb09e630":"img_dir = '\/content\/Simpson\/simpsons_dataset'","0b7b9396":"img_dir = '\/content\/Simpson\/simpsons_dataset'\npath=Path(img_dir)\nimg = DataBlock(\n    blocks=(ImageBlock, CategoryBlock), \n    #get_items=get_image_files,#using_attr(get_image_files(recurse=True)),\n    get_items=partial(get_image_files,recurse=true),\n    #splitter=RandomSubsetSplitter(0.2, 0.1),#RandomSplitter(valid_pct=0.2, seed=42),\n    splitter=RandomSplitter(seed=42),\n    get_y=parent_label,\n    item_tfms=Resize(128))\n#img.summary(path)","402d0ba2":"img = img.dataloaders(path)","a7a9fe5b":"img.valid.show_batch(max_n=4, nrows=2)","06c06c18":"import warnings\nwarnings.filterwarnings('ignore')\nlearn = cnn_learner(img, resnet34, metrics=accuracy, opt_func=Adam, model_dir=\"\/tmp\/model\/\")\nlearn.fine_tune(4)\n#learn.summary","a54e55c7":"interp = ClassificationInterpretation.from_learner(learn)\ninterp.plot_confusion_matrix(figsize=(12,12), dpi=80)","5ffb1657":"learn.unfreeze()\nlearn.lr_find()","849625b1":"learn.fit_one_cycle(6, lr_max=1e-5)","9e330706":"from fastai2.callback.fp16 import *\nlearn = cnn_learner(img, resnet50, metrics=accuracy).to_fp16()\nlearn.fine_tune(10, freeze_epochs=3)","08a988a4":"![image.png](attachment:image.png)","82425e98":"**i have reached 97% accuracy in training this model.**","5f9e4989":"![image.png](attachment:image.png)","5662c9d6":"![image.png](attachment:image.png)","963128bc":"![image.png](attachment:image.png)","220a9934":"![image.png](attachment:image.png)","f9c3f8db":"![image.png](attachment:image.png)"}}