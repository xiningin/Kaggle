{"cell_type":{"e08fa95d":"code","4cf72224":"code","8912a3d1":"code","a3f1d990":"code","b2b26914":"code","6f1a728d":"code","30bb9964":"code","9240baa4":"code","7d1202e6":"code","f9081852":"code","500ca7f5":"code","bfe23e2e":"code","e4e67829":"code","ce7ee234":"code","bf06361c":"code","c2803d30":"code","c4361485":"code","9226904f":"code","5c75459e":"code","0ebe2aa7":"code","bf934e96":"code","f89d3545":"code","c9257862":"code","d6ecdcfa":"code","560658c9":"code","0c862e8d":"markdown","8905eb6f":"markdown","b46a5355":"markdown","2c857944":"markdown","cf30a91a":"markdown","add6bcbc":"markdown","019ea996":"markdown","eebe018f":"markdown","9a1d57d7":"markdown","29cc5077":"markdown","b22b2d3d":"markdown","0f137d44":"markdown"},"source":{"e08fa95d":"#Modules for EDA\nimport numpy as np \nimport pandas as pd\n\nimport seaborn as sns\nfrom matplotlib import pyplot as plt\nplt.style.use('fivethirtyeight')\n\n#Modules for Machine Learning and Data Preprocessing\nfrom tensorflow import keras\nfrom sklearn.metrics import classification_report,confusion_matrix\nfrom sklearn.preprocessing import MinMaxScaler\nfrom sklearn.model_selection import train_test_split\n\nfrom imblearn.over_sampling import SMOTE\n%matplotlib inline","4cf72224":"df = pd.read_csv('..\/input\/company-bankruptcy-prediction\/data.csv')\ndf.shape","8912a3d1":"df.info()","a3f1d990":"pd.set_option('max_columns',96)","b2b26914":"df.describe()","6f1a728d":"cols_for_scale = df.max()[df.max()>1]\ncols_for_scale","30bb9964":"df.min()[df.min()<0]","9240baa4":"scale = MinMaxScaler()\nscalled = scale.fit_transform(df[cols_for_scale.keys()])","7d1202e6":"i = 0\nfor column in cols_for_scale.keys():\n    df[column] = scalled[:,i]\n    i += 1","f9081852":"df[cols_for_scale.keys()].describe()","500ca7f5":"df.sample(5)","bfe23e2e":"sns.countplot(x=df['Bankrupt?'])\nplt.show()","e4e67829":"df['Bankrupt?'].value_counts()","ce7ee234":"df['Bankrupt?'].value_counts().plot(kind='pie',autopct=\"%.2f\")\nplt.show()","bf06361c":"x, y = df.drop('Bankrupt?',axis=1),df['Bankrupt?']\nx.shape,y.shape","c2803d30":"smote = SMOTE(sampling_strategy='minority')\nx,y = smote.fit_resample(x,y)","c4361485":"x.shape,y.shape","9226904f":"y.value_counts().plot(kind='pie',autopct=\"%.2f\")\nplt.show()","5c75459e":"x_train,x_test,y_train,y_test = train_test_split(x, y, test_size=0.3)\nx_train.shape,x_test.shape,y_train.shape,y_test.shape","0ebe2aa7":"model = keras.Sequential([\n    keras.layers.Dense(95,input_shape=(95,),activation='relu'),\n    keras.layers.Dense(1,activation='sigmoid')\n])\n\nmodel.compile(\n    optimizer='adam',\n    metrics=['accuracy'],\n    loss='binary_crossentropy'\n)","bf934e96":"model.fit(x_train,y_train,epochs=200)","f89d3545":"model.evaluate(x_test,y_test)","c9257862":"def predict(model,x):\n    pred  = model.predict(x)\n    pred[pred >= 0.5] = 1\n    pred[pred < 0.5] = 0\n    return pred\n\ndef predict_graph(y_true,y_pred,title):\n    cm = confusion_matrix(y_true,y_pred)\n    plt.figure(figsize=(7,7))\n    sns.heatmap(cm,annot=True,fmt='g',cmap=\"YlGnBu\",\n                xticklabels=['No Bankruptcy','Bankruptcy'],yticklabels=['No Bankruptcy','Bankruptcy'])\n    plt.title(title)\n    plt.show()\n    \n    print(\"\\n\")\n    print(\"Classification Report:\")\n    print(classification_report(y_true,y_pred))\n    ","d6ecdcfa":"y_test_pred = predict(model,x_test)\npredict_graph(y_test,y_test_pred,'Test Data Predictions')","560658c9":"y_train_pred = predict(model,x_train)\npredict_graph(y_train,y_train_pred,'Train Data Predictions')","0c862e8d":"# **Columns for feature Scaling**\n**Because I want Values in range (0-1)**","8905eb6f":"# **Test Predictions**","b46a5355":"# **Splitting and training**","2c857944":"# **Train Predictions**","cf30a91a":"# **Scaling these columns using MinMaxScalar**","add6bcbc":"### **Values are scalled successfully**","019ea996":"No columns are <0","eebe018f":"# **Attribute Information**\n\n### **Version 2: Updated column names and description to make the data easier to understand <br>(Y = Output feature, X = Input features)**\n\n* **Y - Bankrupt?** : Class label\n* **X1 - ROA(C) before interest and depreciation before interest** : Return On Total Assets(C)\n* **X2 - ROA(A) before interest and % after tax** : Return On Total Assets(A)\n* **X3 - ROA(B) before interest and depreciation after tax** : Return On Total Assets(B)\n* **X4 - Operating Gross Margin** : Gross Profit\/Net Sales\n* **X5 - Realized Sales Gross Margin** : Realized Gross Profit\/Net Sales\n* **X6 - Operating Profit Rate** : Operating Income\/Net Sales\n* **X7 - Pre-tax net Interest Rate** : Pre-Tax Income\/Net Sales\n* **X8 - After-tax net Interest Rate** : Net Income\/Net Sales\n* **X9 - Non-industry income and expenditure\/revenue** : Net Non-operating Income Ratio\n* **X10 - Continuous interest rate (after tax)** : Net Income-Exclude Disposal Gain or Loss\/Net Sales\n* **X11 - Operating Expense Rate** : Operating Expenses\/Net Sales\n* **X12 - Research and development expense rate** : (Research and Development Expenses)\/Net Sales\n* **X13 - Cash flow rate** : Cash Flow from Operating\/Current Liabilities\n* **X14 - Interest-bearing debt interest rate** : Interest-bearing Debt\/Equity\n* **X15 - Tax rate (A)** : Effective Tax Rate\n* **X16 - Net Value Per Share (B)** : Book Value Per Share(B)\n* **X17 - Net Value Per Share (A)** : Book Value Per Share(A)\n* **X18 - Net Value Per Share (C)** : Book Value Per Share(C)\n* **X19 - Persistent EPS in the Last Four Seasons** : EPS-Net Income\n* **X20 - Cash Flow Per Share**\n* **X21 - Revenue Per Share (Yuan \u00a5)** : Sales Per Share\n* **X22 - Operating Profit Per Share (Yuan \u00a5)** : Operating Income Per Share\n* **X23 - Per Share Net profit before tax (Yuan \u00a5)** : Pretax Income Per Share\n* **X24 - Realized Sales Gross Profit Growth Rate**\n* **X25 - Operating Profit Growth Rate** : Operating Income Growth\n* **X26 - After-tax Net Profit Growth Rate** : Net Income Growth\n* **X27 - Regular Net Profit Growth Rate** : Continuing Operating Income after Tax Growth\n* **X28 - Continuous Net Profit Growth Rate** : Net Income-Excluding Disposal Gain or Loss Growth\n* **X29 - Total Asset Growth Rate** : Total Asset Growth\n* **X30 - Net Value Growth Rate** : Total Equity Growth\n* **X31 - Total Asset Return Growth Rate Ratio** : Return on Total Asset Growth\n* **X32 - Cash Reinvestment %** : Cash Reinvestment Ratio\n* **X33 - Current Ratio**\n* **X34 - Quick Ratio** : Acid Test\n* **X35 - Interest Expense Ratio** : Interest Expenses\/Total Revenue\n* **X36 - Total debt\/Total net worth** : Total Liability\/Equity Ratio\n* **X37 - Debt ratio %** : Liability\/Total Assets\n* **X38 - Net worth\/Assets** : Equity\/Total Assets\n* **X39 - Long-term fund suitability ratio (A)** : (Long-term Liability+Equity)\/Fixed Assets\n* **X40 - Borrowing dependency** : Cost of Interest-bearing Debt\n* **X41 - Contingent liabilities\/Net worth** : Contingent Liability\/Equity\n* **X42 - Operating profit\/Paid-in capital** : Operating Income\/Capital\n* **X43 - Net profit before tax\/Paid-in capital** : Pretax Income\/Capital\n* **X44 - Inventory and accounts receivable\/Net value** : (Inventory+Accounts Receivables)\/Equity\n* **X45 - Total Asset Turnover**\n* **X46 - Accounts Receivable Turnover**\n* **X47 - Average Collection Days** : Days Receivable Outstanding\n* **X48 - Inventory Turnover Rate (times)**\n* **X49 - Fixed Assets Turnover Frequency**\n* **X50 - Net Worth Turnover Rate (times)** : Equity Turnover\n* **X51 - Revenue per person** : Sales Per Employee\n* **X52 - Operating profit per person** : Operation Income Per Employee\n* **X53 - Allocation rate per person** : Fixed Assets Per Employee\n* **X54 - Working Capital to Total Assets**\n* **X55 - Quick Assets\/Total Assets**\n* **X56 - Current Assets\/Total Assets**\n* **X57 - Cash\/Total Assets**\n* **X58 - Quick Assets\/Current Liability**\n* **X59 - Cash\/Current Liability**\n* **X60 - Current Liability to Assets**\n* **X61 - Operating Funds to Liability**\n* **X62 - Inventory\/Working Capital**\n* **X63 - Inventory\/Current Liability**\n* **X64 - Current Liabilities\/Liability**\n* **X65 - Working Capital\/Equity**\n* **X66 - Current Liabilities\/Equity**\n* **X67 - Long-term Liability to Current Assets**\n* **X68 - Retained Earnings to Total Assets**\n* **X69 - Total income\/Total expense**\n* **X70 - Total expense\/Assets**\n* **X71 - Current Asset Turnover Rate** : Current Assets to Sales\n* **X72 - Quick Asset Turnover Rate** : Quick Assets to Sales\n* **X73 - Working capitcal Turnover Rate** : Working Capital to Sales\n* **X74 - Cash Turnover Rate** : Cash to Sales\n* **X75 - Cash Flow to Sales**\n* **X76 - Fixed Assets to Assets**\n* **X77 - Current Liability to Liability**\n* **X78 - Current Liability to Equity**\n* **X79 - Equity to Long-term Liability**\n* **X80 - Cash Flow to Total Assets**\n* **X81 - Cash Flow to Liability**\n* **X82 - CFO to Assets**\n* **X83 - Cash Flow to Equity**\n* **X84 - Current Liability to Current Assets**\n* **X85 - Liability-Assets Flag** : 1 if Total Liability exceeds Total Assets, 0 otherwise\n* **X86 - Net Income to Total Assets**\n* **X87 - Total assets to GNP price**\n* **X88 - No-credit Interval**\n* **X89 - Gross Profit to Sales**\n* **X90 - Net Income to Stockholder's Equity**\n* **X91 - Liability to Equity**\n* **X92 - Degree of Financial Leverage (DFL)**\n* **X93 - Interest Coverage Ratio (Interest expense to EBIT)**\n* **X94 - Net Income Flag** : 1 if Net Income is Negative for the last two years, 0 otherwise\n* **X95 - Equity to Liability**","9a1d57d7":"# **Predictions**","29cc5077":"# **Note**\n#### **If you're using any Machine Learning algorithms like logistic regression, SVC, knn etc.. then there is a chance of less accuracy because we have 95 unique features.**\n#### **You have to implement feature selection methods**","b22b2d3d":"**Using SMOTE method to over sample the data**","0f137d44":"# **Imbalanced Data :(**"}}