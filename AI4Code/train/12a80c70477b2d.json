{"cell_type":{"dd9a0d77":"code","e4ae0654":"code","0c6fe4f2":"code","d3f891ff":"code","eb0b8270":"code","83e5b7b6":"code","a6b6bc92":"code","5ee2209c":"code","c2fe7b7e":"code","9daa2684":"code","ef3ab5be":"code","62e6f4be":"code","2989fd09":"code","9f417668":"code","94084e3c":"code","81521ca1":"code","7acf392c":"markdown","078e1e1e":"markdown","d63bb3b0":"markdown","5f2cb8a1":"markdown","5cf639d7":"markdown","2b27d31c":"markdown","93dc06ba":"markdown"},"source":{"dd9a0d77":"filename_train = '..\/input\/cat-in-the-dat-ii\/train.csv'\nfilename_test  = '..\/input\/cat-in-the-dat-ii\/test.csv'","e4ae0654":"import pandas as pd\n\ndf_train = pd.read_csv(filename_train, index_col='id')\ndf_test  = pd.read_csv(filename_test, index_col='id')","0c6fe4f2":"df_train","d3f891ff":"df_test","eb0b8270":"obj_col = 'target'","83e5b7b6":"X_train = df_train.drop([obj_col], axis=1)\nX_train","a6b6bc92":"X_test = df_test\nX_test","5ee2209c":"y_train = df_train[obj_col]\ny_train","c2fe7b7e":"def to_category(df):\n    for col, type in zip(df.columns, df.dtypes):\n        if type == object:\n            df[col] = df[col].astype('category')\n    \n    return df","9daa2684":"X_train = to_category(X_train)\nX_test  = to_category(X_test)","ef3ab5be":"import numpy as np\nimport lightgbm as lgb\nfrom sklearn.metrics import accuracy_score\n\ndef acc_score(preds, data):\n    y_true = data.get_label()\n    y_pred = np.where(preds > 0.5, 1, 0)\n    acc = accuracy_score(y_true, y_pred)\n    return 'acc', acc, True\n\nlgb_train = lgb.Dataset(X_train, y_train)\n\nparams = {\n    'objective': 'binary',    \n    'min_data_in_leaf': 15,  \n    'force_row_wise': True,\n}\n\ncv_rslt = lgb.cv(params, \n                 lgb_train, \n                 nfold=5, \n                 num_boost_round=10000, \n                 early_stopping_rounds=20,               \n                 feval=acc_score,\n                 return_cvbooster=True)","62e6f4be":"cvbooster = cv_rslt['cvbooster']","2989fd09":"cv_rslt['acc-mean']","9f417668":"y_preds = cvbooster.predict(X_test, num_iteration=cvbooster.best_iteration)\ny_pred = np.mean(y_preds, axis=0)\ny_pred = pd.Series(y_pred, name='target')\ny_pred","94084e3c":"answer = pd.concat([df_test.index.to_series().reset_index(drop=True), y_pred], axis=1)\nanswer","81521ca1":"filename_output = '.\/submission.csv'\nanswer.to_csv(filename_output, index=False)","7acf392c":"## Explanatory variables","078e1e1e":"# Preprocessing","d63bb3b0":"# Modeling","5f2cb8a1":"# Load files","5cf639d7":"# Prediction","2b27d31c":"## Change object-type to category-type","93dc06ba":"## Objective variables"}}