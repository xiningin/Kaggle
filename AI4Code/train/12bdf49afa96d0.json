{"cell_type":{"310fd123":"code","49fad33d":"code","262ccb35":"code","b08fb868":"code","ca786166":"code","56073945":"code","18f9b653":"code","76f5e5b3":"code","ca7b48de":"code","7fe5fe96":"code","847dc750":"code","a33d4d74":"code","344eceee":"code","1a0ac9a1":"code","568fdc69":"code","8dbe5629":"code","0d72ebd9":"code","f4bfe8fb":"code","4e5ce1e5":"code","b44e3575":"code","21cdcae6":"code","6c59484d":"code","75778f2a":"code","a627ecbd":"code","9a4cdbec":"code","7deba0c6":"code","d2ae6a3f":"code","8108c766":"code","8ef8f583":"code","cfc4137e":"code","1e8de67c":"code","88544bdc":"code","2e78b22d":"code","6d9791c6":"code","9bb16ad6":"markdown","fad73e70":"markdown","7bf9a1f7":"markdown","71e1ea06":"markdown","20e1b9ec":"markdown","1fdee9c4":"markdown","93d2c04d":"markdown","20e682a7":"markdown","3913e2f2":"markdown","ee868fd3":"markdown","d4f2a639":"markdown","98b01a52":"markdown","86b29ecd":"markdown"},"source":{"310fd123":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport warnings\nwarnings.filterwarnings('ignore')\n%matplotlib inline ","49fad33d":"data = pd.read_csv(\"..\/input\/red-wine-quality-cortez-et-al-2009\/winequality-red.csv\")","262ccb35":"data.info()","b08fb868":"data.head(10)","ca786166":"data.describe()","56073945":"data.isnull().sum()","18f9b653":"plt.figure(figsize = (20, 10))\nsns.heatmap(data.corr(), annot = True)","76f5e5b3":"data.columns[0]","ca7b48de":"fig, axes = plt.subplots(5, 2,figsize=(24, 24))\naxes = axes.flatten()\nfor idx, ax in enumerate(axes):\n    sns.histplot(data = data, x = data.columns[idx] ,ax=ax,palette = [\"#2a9d8f\"])\n\nfig.supxlabel('Distribution of the features', ha='center')\nfig.tight_layout()\nplt.show()","7fe5fe96":"data['fixed acidity'] = np.log(data['fixed acidity'])\nsns.histplot(data['fixed acidity'])","847dc750":"data['volatile acidity'] = np.log(data['volatile acidity'])\nsns.histplot(data['volatile acidity'])","a33d4d74":"q75, q25 = np.percentile(data.loc[:, 'residual sugar'], [75, 25])\nintr_qr = q75 - q25\nmax_t = q75 + (1.5 * intr_qr)\nmin_t = q25 - (1.5 * intr_qr)\ndata.loc[data['residual sugar'] < min_t, 'residual sugar'] = np.nan\ndata.loc[data['residual sugar'] > max_t, 'residual sugar'] = np.nan\ndata['residual sugar'] = data['residual sugar'].fillna(data['residual sugar'].median())\n# Plotting the new distribution.\nsns.histplot(data['residual sugar'])","344eceee":"data['free sulfur dioxide'] = data['free sulfur dioxide'] ** (1 \/ 2)\nsns.histplot(data['free sulfur dioxide'])","1a0ac9a1":"q75, q25 = np.percentile(data.loc[:, 'chlorides'], [75, 25])\nintr_qr = q75 - q25\nmax_t = q75 + (1.5 * intr_qr)\nmin_t = q25 - (1.5 * intr_qr)\ndata.loc[data['chlorides'] < min_t, 'chlorides'] = np.nan\ndata.loc[data['chlorides'] > max_t, 'chlorides'] = np.nan\ndata['chlorides'] = data['chlorides'].fillna(data['chlorides'].median())\n# Plotting the new distribution.\nsns.histplot(data['chlorides'])","568fdc69":"data['total sulfur dioxide'] = data['total sulfur dioxide'] ** (1 \/ 4)\nsns.histplot(data['total sulfur dioxide'])","8dbe5629":"data['alcohol'] = data['alcohol'] ** (1 \/ 2)\nsns.histplot(data['alcohol'])","0d72ebd9":"data['sulphates'] = np.log(data['sulphates'])\nsns.histplot(data['sulphates'])","f4bfe8fb":"sns.countplot(data['quality'])","4e5ce1e5":"sns.histplot(data['pH'])","b44e3575":"sns.histplot(data['fixed acidity'])","21cdcae6":"plt.figure(figsize = (20, 10))\nsns.heatmap(data.corr(), annot = True)","6c59484d":"data.drop(['fixed acidity'], axis = 1, inplace = True)","75778f2a":"X = data.drop(['quality'], axis = 1)\ny = data['quality']\ny = [1 if i >= 7 else 0 for i in y]","a627ecbd":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.25, random_state = 51)","9a4cdbec":"from sklearn.model_selection import ShuffleSplit\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.svm import SVC\nfrom sklearn.neighbors import KNeighborsClassifier\ncv = ShuffleSplit(n_splits = 5, test_size = 0.2, random_state = 42)","7deba0c6":"cross_val_score(DecisionTreeClassifier(random_state=42), X, y, cv = cv)","d2ae6a3f":"cross_val_score(RandomForestClassifier(), X, y, cv = cv)","8108c766":"cross_val_score(SVC(), X, y, cv = cv)","8ef8f583":"cross_val_score(KNeighborsClassifier(), X, y, cv = cv)","cfc4137e":"from sklearn.model_selection import GridSearchCV \ngrid = {\n                'n_estimators': [10, 20, 40, 50, 100, 150, 200, 500],\n                'max_features': ['auto', 'sqrt'],\n                'max_depth': [3, 5, 7, 9, 11, 15],\n                'bootstrap': [True, False]\n                }\nrf = RandomForestClassifier()\nrf_random = GridSearchCV(estimator = rf, param_grid = grid, cv = 3, verbose=2, n_jobs = -1)\nrf_random.fit(X_train, y_train)","1e8de67c":"rf_random.score(X_train, y_train)","88544bdc":"rf_random.score(X_test, y_test)","2e78b22d":"from sklearn.metrics import confusion_matrix\ny_pred = rf_random.predict(X_test)\nconf_matrix = confusion_matrix(y_test, y_pred)\nsns.heatmap(conf_matrix, annot = True, fmt='g')","6d9791c6":"from sklearn.metrics import classification_report\nprint(classification_report(y_test, y_pred))","9bb16ad6":"# Explorary Data Analysis and Feature Scaling\n","fad73e70":"**Fixed acidity**, **volatile acidity** and **sulphates** data distributions are close to normal distribution but a little bit left skewed, to get a better accuracy. I will apply log transformation on these features since its weaker compared to other transformations. ","7bf9a1f7":"# Data Loading & proccesing","71e1ea06":"# Model Fitting","20e1b9ec":"Luckily this dataset doesn't have any null values and has few columns, lets have a close look at them!","1fdee9c4":"# Parameter tuning","93d2c04d":"Looks like our wines with 7+ quality are underpresented in data, this could affect the outcome little bit.","20e682a7":"Seems like we had a somewhat good overall accuracy but the less number of good wines led to higher false negatives. Setting the threshold lower could lessen this affect. Thanks for reading!","3913e2f2":"After looking into our correlation map second time I realized fixed acidity has somewhat higher correlation with pH, density and citric acid. Since pH's distribution is closer to normal distribution dropping the fixed acidity column makes more sense.","ee868fd3":"Wine quality dataset is a public dataset published by UCI in 2009. The original dataset has also white wine classification that can be found in the UCI ML website. In this notebook I will transform the target variable into 1(good) and 0(bad) with those 7 and higher as being good as it is said in the UCI website. Lets start with loading the neccesary libraries!","d4f2a639":"Looks like our best model is random forest classifier lets try to increase accuracy by changing the parameters.","98b01a52":"And finally **chlorides** and **residual** features would have nearly perfect normal distribution if it wasn't the outliers, IQR method seems perfect for this fit.","86b29ecd":"On the other hand **citric acid**, **free sulfur dioxide** and **total sulfur dioxide** columns have exponential distribution, square root transformation may help to transform these variables. "}}