{"cell_type":{"27487f12":"code","15d87348":"code","0495f2fc":"code","cc965b8a":"code","482c71e5":"code","aa12a685":"code","55cc0363":"code","7710e1b8":"code","331439d1":"code","21d6d615":"code","b0de2632":"code","1f06eccb":"code","edf8c424":"code","a421521a":"code","c7c1287e":"code","7123d4a8":"code","b9d11546":"code","3b349a80":"code","8a5f6960":"code","68531f03":"code","7ac9d206":"code","836869f7":"code","a7d09904":"code","cb01f589":"code","a2975e13":"code","d63c8d31":"code","30e33bef":"code","ff2377db":"code","7796e78c":"code","1549d382":"code","bf935901":"code","1efccbd9":"code","f179f8c3":"code","28344bda":"code","c24a469c":"code","54de7fbd":"code","0ac53f03":"markdown","0ccbd230":"markdown","ddafcae6":"markdown","ef6e23cd":"markdown","b770311a":"markdown","42a87329":"markdown","5746f53b":"markdown","4e4b9071":"markdown","f66b09eb":"markdown","8bc90632":"markdown","37b55b06":"markdown","25520f7b":"markdown","46b3d745":"markdown","94b12e79":"markdown","fe9d15ae":"markdown","79df631d":"markdown","b441015d":"markdown","2e5c2174":"markdown","0fa86aa9":"markdown","633f8e5f":"markdown","4b4c6e9a":"markdown","c7269432":"markdown","b614eb89":"markdown","d42f9acf":"markdown","0c072174":"markdown","4fe7c060":"markdown","ca900ac1":"markdown","555848e9":"markdown","b5f23cb6":"markdown","637ac9fc":"markdown","138100b0":"markdown","ad60740e":"markdown","74f3471c":"markdown","608cc1a2":"markdown","a994612d":"markdown","c94733c3":"markdown","4e49ce6a":"markdown","164602e3":"markdown","82b4d521":"markdown","3369b80f":"markdown","64a703ac":"markdown"},"source":{"27487f12":"import pandas as pd \nimport matplotlib.pyplot as plt \nimport numpy as np\nimport seaborn as sns \nplt.style.use('ggplot')","15d87348":"df = pd.read_csv(\"..\/input\/adult-pmr3508\/train_data.csv\", na_values='?')\ndf.head()","0495f2fc":"df.drop(\"Id\", inplace=True, axis=1)","cc965b8a":"df.info()","482c71e5":"df.describe()","aa12a685":"from sklearn.preprocessing import LabelEncoder\n\nle = LabelEncoder()\n\ndf.income = le.fit_transform(df.income)","55cc0363":"sns.pairplot(df, hue=\"income\", plot_kws={\"alpha\":0.5},\n                diag_kws={'bw':\"1.0\"})\nplt.show()","7710e1b8":"sns.violinplot(x=\"income\", y=\"hours.per.week\", data=df)\nplt.show()\nprint(df.groupby(\"income\")[\"hours.per.week\"].describe())","331439d1":"df_g =  pd.DataFrame(df.groupby(\"sex\").income.value_counts(normalize=True))\ndf_g.rename(columns={'income': 'count'}, inplace=True)\ndf_g.reset_index(inplace=True)\nsns.barplot(x=\"sex\", y=\"count\", hue=\"income\", data=df_g)\nplt.show()","21d6d615":"df.groupby(\"sex\").income.value_counts(normalize=True)","b0de2632":"df_g =  pd.DataFrame(df.groupby(\"income\").sex.value_counts(normalize=True))\ndf_g.rename(columns={'sex': 'count'}, inplace=True)\ndf_g.reset_index(inplace=True)\nsns.barplot(x=\"income\", y=\"count\", hue=\"sex\", data=df_g)\nplt.show()","1f06eccb":"df.groupby(\"income\").sex.value_counts(normalize=True)","edf8c424":"sns.countplot(x=\"workclass\", data=df)\nplt.xticks(\n    rotation=45, \n    horizontalalignment='right',\n    fontweight='light'  \n)\nplt.show()","a421521a":"df_g =  pd.DataFrame(df.groupby(\"workclass\").income.value_counts(normalize=True))\ndf_g.rename(columns={'income': 'count'}, inplace=True)\ndf_g.reset_index(inplace=True)\ndf_g.sort_values('count',inplace=True)\nsns.barplot(y=\"workclass\", x=\"count\", hue=\"income\", data=df_g)\n\nplt.show()","c7c1287e":"sns.catplot(y=\"workclass\", x=\"income\", kind=\"bar\", data=df);","7123d4a8":"sns.distplot(df['age'])\nplt.show()\nprint(df['age'].describe())","b9d11546":"sns.violinplot(x=\"income\", y=\"age\", data=df)\nplt.show()","3b349a80":"sns.countplot(x=\"race\", data=df)\nplt.xticks(\n    rotation=45, \n    horizontalalignment='right',\n    fontweight='light'  \n)\nplt.show()","8a5f6960":"sns.catplot(x=\"race\", y=\"income\", kind=\"bar\", data=df);\nplt.xticks(\n    rotation=45, \n    horizontalalignment='right',\n    fontweight='light'  \n)\nplt.show()","68531f03":"df_g =  pd.DataFrame(df.groupby(\"race\").income.value_counts(normalize=True))\ndf_g.rename(columns={'income': 'count'}, inplace=True)\ndf_g.reset_index(inplace=True)\ndf_g.sort_values('count',inplace=True)\nsns.barplot(y=\"race\", x=\"count\", hue=\"income\", data=df_g)\n\nplt.show()","7ac9d206":"df.isna().sum()\/df.shape[0]*100 #Porcentagem de NaN","836869f7":"sns.countplot(x=\"workclass\", data=df)\nplt.xticks(\n    rotation=45, \n    horizontalalignment='right',\n    fontweight='light'  \n)\nplt.show()","a7d09904":"sns.countplot(x=\"occupation\", data=df)\nplt.xticks(\n    rotation=45, \n    horizontalalignment='right',\n    fontweight='light'  \n)\nplt.show()","cb01f589":"sns.countplot(x=\"native.country\", data=df)\nplt.xticks(\n    rotation=90, \n    horizontalalignment='right',\n    fontweight='light'  \n)\nplt.show()","a2975e13":"df.drop(['native.country'], axis=1, inplace=True)","d63c8d31":"from sklearn.impute import SimpleImputer\nfor i in [\"workclass\", \"occupation\"]:\n    imp_mf = SimpleImputer(missing_values=np.nan, strategy='most_frequent')\n\n    imp_mf.fit(np.array(df[i]).reshape(-1, 1))\n    df[i] = imp_mf.transform(np.array(df[i]).reshape(-1, 1))","30e33bef":"df.isna().sum()","ff2377db":"categorical = [\"workclass\", \"marital.status\",  \"sex\", \"race\", \n               \"occupation\", \"relationship\"]\ndf = pd.get_dummies(df, columns=categorical, prefix=categorical)\ndf.head()","7796e78c":"from sklearn.preprocessing import StandardScaler\n\nsl = StandardScaler()\ndf[[\"hours.per.week\", \"age\", \"education.num\"]] = sl.fit_transform(df[[\"hours.per.week\",\n                                                                                    \"age\", \"education.num\"]])\ny = df[\"income\"]\nX = df.drop([\"fnlwgt\", \"education\", \"income\"], axis =1)","1549d382":"from sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.model_selection import cross_val_score\n\nk_max = None\nmax_acc=0\nfor k in range(20, 31):\n    \n    KNNclf = KNeighborsClassifier(n_neighbors=k, algorithm='brute')\n    \n    score = cross_val_score(KNNclf, X, y, cv = 5).mean()\n    \n    print(k,\" vizinhos; Acur\u00e1cia:\" , round(score,6), \";\")\n    if score > max_acc:\n        k_max = k\n        max_acc = score\n        \nprint('\\nMelhor k: {}'.format(k_max))","bf935901":"knn = KNeighborsClassifier(n_neighbors=k_max, algorithm='brute')\nknn.fit(X, y)","1efccbd9":"df_teste = pd.read_csv(\"..\/input\/adult-pmr3508\/test_data.csv\", na_values='?')\ncategorical = [\"workclass\", \"marital.status\",  \"sex\", \"race\", \n               \"occupation\", \"relationship\"]\ndf_teste = pd.get_dummies(df_teste, columns=categorical, prefix=categorical) ","f179f8c3":"from sklearn.preprocessing import StandardScaler\n\nsl = StandardScaler()\ndf_teste[[\"hours.per.week\", \"age\", \"education.num\"]] = sl.fit_transform(df_teste[[\"hours.per.week\",\n                                                                                    \"age\", \"education.num\"]])\n\ndf_teste.drop([\"fnlwgt\", \"education\", \"native.country\", \"Id\"], inplace=True, axis=1)","28344bda":"X_test= df_teste.values","c24a469c":"y_pred = knn.predict(X_test)","54de7fbd":"pred = pd.DataFrame(columns = [\"Id\",\"income\"])\n\npred.Id = df_teste.index\npred.income=y_pred\npred.income.replace({0:\"<=50K\", 1:\">50K\" }, inplace=True)\npred.to_csv(\"submission.csv\", index=False)","0ac53f03":"#### 3.2.3 Histograma por Idade \nComo que a idade se distribue de acordo com o income? Ser\u00e1 que quanto mais velho maior o sal\u00e1rio?","0ccbd230":"Descri\u00e7\u00e3o de missing values e tipo de dados que estamos lidando. ","ddafcae6":"### 2.3 Transformando o Income em num\u00e9rica","ef6e23cd":"### 2.2 Breve Descri\u00e7\u00e3o dos Dados ","b770311a":"A mediana de ambas as classes \u00e9 mesma: 40 horas semanais. No entanto, quem ganha mais tende a trabalhar um pouco mais, vide a maior m\u00e9dia.","42a87329":"Salvando os valores e enviando para o Kaggle! ","5746f53b":"#### 3.2.4 ViolinPlot Age","4e4b9071":"## 1. Import","f66b09eb":"Ou seja, a ra\u00e7a que tem uma maior quantidade de >50k \u00e9 Asian-Pac-Islander.","8bc90632":"N\u00e3o \u00e9 t\u00e3o igualit\u00e1rio assim. Dentre os mais ricos, apenas 15% s\u00e3o mulheres. Realmente h\u00e1 Gender Gap Wage. ","37b55b06":"### 3.1.2 Rela\u00e7\u00e3o entre horas trabalhadas e renda. ","25520f7b":"H\u00e1 uma grande quantidade de pessoas trabalhando na iniciativa privada. E, de certa forma, isso representa bem a realidade. \n\nQual a porcentagem de pessoas ganhando mais que 50k divididas pro profiss\u00e3o?","46b3d745":"#### 3.2.1 Histograma por  sexo \nSer\u00e1 que realmente existe o Gender Wage Gap?","94b12e79":"Renda M\u00e9dia por Ra\u00e7a:","fe9d15ae":"Breve an\u00e1lise estat\u00edstica dos nossos dados.","79df631d":"## 2. DataPrep","b441015d":"Com esse ViolinPlot, d\u00e1 para retirar algumas informa\u00e7\u00f5es da rela\u00e7\u00e3o age\/income. \nA idade do grupo de maior renda \u00e9 mais elevada que do grupo de menor. ","2e5c2174":"### 4.3 Scaling\/Sele\u00e7\u00e3o das features num\u00e9ricas.\nForam testados tanto o MinMaxScaler e o StandardScaler. No entanto, obteve-se melhores resultados com StandardScaler. \nTamb\u00e9m foi notado, atrav\u00e9s de testes, que as features \"fnlwgt\" e \"education\", abaixavam a acur\u00e1cia do classificador.","0fa86aa9":"#### 3.2.2 Histograma por classe de profiss\u00e3o.   \nComo se distribuem as classes de profiss\u00f5es nos dados que temos? ","633f8e5f":"### 3.2 Vari\u00e1veis Discretas\nPara termos uma melhor no\u00e7\u00e3o de como est\u00e3o relacionadas as vari\u00e1veis categ\u00f3ricas histogramas s\u00e3o uma boa ideia. ","4b4c6e9a":"Nos dados em quest\u00e3o, a \u00fanica classe que a maior parte ganha mais que 50k \u00e9 a self-emp-inc.\n\nExcetuando quem nunca trabalhou ou n\u00e3o ganha nada, a iniciativa privada tem a menor porcentagem de pessoas ganhando mais que o limiar. ","c7269432":"## 3. Data Visualization ","b614eb89":"#### 3.2.5 Quest\u00e3o Racial\/Nacional \n\nDe que forma a ra\u00e7a impacta no seu sal\u00e1rio? \n\nDistribui\u00e7\u00e3o racial no dataset:","d42f9acf":"#### Intui\u00e7\u00e3o:\n\nUm pouco dif\u00edcil de entender quais as correla\u00e7\u00f5es entre elas. N\u00e3o \u00e9 t\u00e3o esclarecedor. \nMas j\u00e1 d\u00e1 para tirar algumas intui\u00e7\u00f5es:\n\n1. No gr\u00e1fico que relaciona \"education.num\" e \"hours.per.week\" d\u00e1 para ter uma no\u00e7\u00e3o de que, quanto maior o estudo e maior a quantidade de horas trabalhadas leva a uma maior remunera\u00e7\u00e3o. \n\n***\n\n2. \"age\" x \"hours.per.week\". Quanto mais jovem e menos horas de trabalho menor a renda. \n\n","0c072174":"### 3.1.1 PairPlot","4fe7c060":"J\u00e1 podemos visualizar algumas estat\u00edsticas e descri\u00e7\u00f5es do nossos dados.","ca900ac1":"# PMR-3508 \n## Dataset Adult \nParte da disciplina \"Aprendizado de M\u00e1quina e Reconhecimento de Padr\u00f5es\", esse trabalho tem como objetivo implantar um algoritmo de KNN para previs\u00e3o de renda no Dataset Adult. \nAl\u00e9m de, claro, fazer uma an\u00e1lise dos dados antes.","555848e9":"## 4. Tratando Missing Values e Vari\u00e1veis Categ\u00f3ricas","b5f23cb6":"Perceba que h\u00e1 uma diferen\u00e7a grande diferen\u00e7a na propor\u00e7\u00e3o entre mulheres e homens que recebem mais de 50k. Cerca de 90% das mulheres recebem menos que 50K, j\u00e1 nos homens, essa taxa \u00e9 menor que 70%. \n\nUma outra perspectiva \u00e9 analisar se, dentro dos mais ricos, h\u00e1 uma propor\u00e7\u00e3o entre homens e mulheres mais igualit\u00e1ria? ","637ac9fc":"## 6. Predi\u00e7\u00e3o dos Valores ","138100b0":"### 4.2 Encoding das vari\u00e1veis categ\u00f3ricas\nUsaremos aqui um OneHotEncoder para transformar vari\u00e1veis categ\u00f3ricas em vari\u00e1veis num\u00e9ricas. Foi testado tamb\u00e9m o LabelEncoder, no entanto n\u00e3o obteve bons resultados.","ad60740e":"## 5. Modelo KNN\nSer\u00e1 feito uma varredura entre todos os K Neighbors entre 20 e 30, na busca do melhor valor usando cross-validation.","74f3471c":"Perceba que o melhor k encontrado foi k = 24! \n\nModelo que usaremos para prever a base de treino:","608cc1a2":"Lendo o arquivo e fazendo todo o preprocessamento de dados.","a994612d":"Perceba que temos poucos missing values... Como ser\u00e1 que est\u00e3o distribu\u00eddos?","c94733c3":"### 3.1 Vari\u00e1veis Cont\u00ednuas","4e49ce6a":"Daquei n\u00e3o conseguimos tirar muitas informa\u00e7\u00f5es, apenas uma m\u00e9dia da idade e uma ideia da\ndistribui\u00e7\u00e3o dos dados. ","164602e3":"### 4.1 Impute de Missing Values \nA ideia aqui \u00e9 simplesmente \u00e9 inserir os valores mais frequentes.","82b4d521":"### 2.1 Leitura do Arquivo .csv\nNesse dataset o dados faltantes est\u00e3o inseridos como \"?\".","3369b80f":"Primeiramente, vamos ter uma ideia de como se relacionam as vari\u00e1veis num\u00e9ricas desse dataset. ","64a703ac":"Os dados de nacionalidade n\u00e3o dizem muito, optarei por retir\u00e1-los do dataset."}}