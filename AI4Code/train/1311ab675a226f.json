{"cell_type":{"6c65b6d2":"code","cf52ac69":"code","20eeac27":"code","ee2e4263":"code","8047d74c":"code","9c9b747c":"code","67a99964":"code","fa7d0086":"code","34c2efee":"code","6d25fb92":"code","30e1f65c":"code","623c9e94":"code","7b6c8507":"code","fb597b68":"code","47771522":"code","c26d9d3d":"code","e6920660":"code","e78438a1":"code","bd042f87":"code","090cbead":"code","aa8e6583":"code","994b6f71":"code","3c7fa008":"code","e713c49a":"code","8762961a":"code","916c1081":"code","f720592c":"code","f172dfb9":"code","041e187c":"code","5dc3ce57":"code","b0d02228":"code","77c631bf":"code","925037ec":"code","38c4241f":"code","627e3e06":"code","3bd3ad87":"code","414fc496":"code","8a05b35a":"code","6847d3bb":"code","97d33451":"code","d39f45c1":"code","3052353a":"code","ad8b153f":"code","02e48de4":"code","2a022e7d":"code","90fee285":"code","bd00cafd":"code","d5e5a51c":"code","8e100504":"code","dbae1ccc":"code","241d5c6d":"code","69c3fd13":"code","03e30528":"code","d8dd0292":"code","bef6c3c6":"code","5532cd13":"code","6e8e990a":"code","d946d131":"code","15294131":"code","c3dadc07":"code","25577f26":"code","d0068c5a":"code","6c28bc1e":"code","699ea023":"code","9266a4f4":"code","f3f0417f":"code","311b33fd":"code","6c3a9065":"code","5910798b":"code","9138ee4f":"code","1e14a647":"code","7990b984":"code","17017c6f":"code","b09a19d2":"code","d6979df4":"code","6554a871":"code","02384578":"code","add19e66":"code","888ef868":"code","47bfa12c":"code","22f8e4b0":"code","fcc576c9":"code","419961b8":"code","f3470594":"code","aab870db":"code","04075ec8":"code","fbb1e2b0":"code","225b1491":"code","cd8d5835":"code","44e09908":"code","bbf67d93":"code","b8f5d719":"code","e360fd05":"code","cf736b9d":"code","a5988f69":"code","54084043":"code","ec642077":"code","818b0299":"markdown","3a38f9fa":"markdown","781a6455":"markdown","5f8806d6":"markdown","e5265c50":"markdown","1fccdad8":"markdown","c9021cdb":"markdown","b1ba06e3":"markdown","5dbf0f61":"markdown","d5b85012":"markdown","61a48885":"markdown","a5776bb4":"markdown","91a4e68e":"markdown","469ee440":"markdown","12949276":"markdown","5c46659b":"markdown","75ef345f":"markdown","fb3101ce":"markdown","6d81826e":"markdown","19b7955a":"markdown","ec4b5845":"markdown","02b6327e":"markdown","d80f823b":"markdown","76b22e4b":"markdown","198d6c54":"markdown","033822f5":"markdown","74012128":"markdown","4aa747f6":"markdown","bb820716":"markdown","688bba57":"markdown","e5fb86ba":"markdown","f42bd6bc":"markdown","7f2f6470":"markdown","72279669":"markdown","fd46402a":"markdown","c3bc966e":"markdown","34905cb9":"markdown","02148f91":"markdown","c268f9d2":"markdown","f94051e0":"markdown","95cecd2c":"markdown","4eadbbaf":"markdown","cf8898fc":"markdown","cbcfb4f8":"markdown","b52e49b1":"markdown","b7928313":"markdown","c24e0a4f":"markdown"},"source":{"6c65b6d2":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport re","cf52ac69":"df=pd.read_csv('..\/input\/bengaluru-house-price-data\/Bengaluru_House_Data.csv')","20eeac27":"df.shape","ee2e4263":"df.columns.values","8047d74c":"df.head()","9c9b747c":"df.info()","67a99964":"df.isnull().sum()","fa7d0086":"df['price']=df['price']*100000\ndf.head()","34c2efee":"for i in df.columns:\n    print(i)\n    print(df[i].value_counts())\n    #print('\\n')\n    print('__________________________________________________________________________________________\\n')","6d25fb92":"df['size'].value_counts()","30e1f65c":"df['size'].describe()","623c9e94":"#Replacing size null Values with 0\ndf['size'].fillna('0',inplace=True)\ndf[df['size']=='0']","7b6c8507":"df['size'].unique()","fb597b68":"df['size'] = df['size'].apply(lambda x : int(x.split()[0]))\ndf.head()","47771522":"df.bath.describe()","c26d9d3d":"df[df['bath'].isnull()].head()","e6920660":"df.balcony.describe()","e78438a1":"df[df['balcony'].isnull()].head()","bd042f87":"for bedr in df['size']:\n    if bedr==0:\n        df['bath']=df['bath'].fillna(0)\n        df['balcony']=df['balcony'].fillna(0)\n    elif bedr >=5:\n        df['bath']=df['bath'].fillna(3)\n        df['balcony']=df['balcony'].fillna(3)\n    else:\n        df['bath']=df['bath'].fillna(int(df['bath'].mean()))\n        df['balcony']=df['balcony'].fillna(int(df['balcony'].mean()))","090cbead":"df.head()","aa8e6583":"def is_float(x):\n    try:\n        float(x)\n    except:\n        return False\n    return True\ndf[~df['total_sqft'].apply(is_float)].head(10)","994b6f71":"def total_sqft_modification(my_list):\n    if len(my_list) == 1:\n        \n        try:\n            return float(my_list[0])\n        except:\n            strings = ['Sq. Meter', 'Sq. Yards', 'Perch', 'Acres', 'Cents', 'Guntha', 'Grounds']\n            split_list = re.split('(\\d*.*\\d)', my_list[0])[1:]\n            area = float(split_list[0])\n            type_of_area = split_list[1]\n            \n            if type_of_area == 'Sq. Meter':\n                area_in_sqft = area * 10.7639\n            elif type_of_area == 'Sq. Yards':\n                area_in_sqft = area * 9.0\n            elif type_of_area == 'Perch':\n                area_in_sqft = area * 272.25\n            elif type_of_area == 'Acres':\n                area_in_sqft = area * 43560.0\n            elif type_of_area == 'Cents':\n                area_in_sqft = area * 435.61545\n            elif type_of_area == 'Guntha':\n                area_in_sqft = area * 1089.0\n            elif type_of_area == 'Grounds':\n                area_in_sqft = area * 2400.0\n            return float(area_in_sqft)\n        \n    else:\n        return (float(my_list[0]) + float(my_list[1]))\/2.0","3c7fa008":"df['total_sqft'] = df.total_sqft.str.split('-').apply(total_sqft_modification)","e713c49a":"df.total_sqft.describe()","8762961a":"df.head()","916c1081":"df['availability']=df['availability'].apply(lambda x : str(x.split('-')[0]))","f720592c":"df.head()","f172dfb9":"for i in df['availability'].unique():\n    if i!='Immediate Possession':\n        if i!='Ready To Move':\n            a='20'+i\n            int(a)\n            df['availability']=df['availability'].replace(i,a)","041e187c":"df.head()","5dc3ce57":"df.availability.value_counts()","b0d02228":"df[df['location'].isnull()]","77c631bf":"#Filling null values of location by Others\ndf['location'].fillna('Others',inplace=True)","925037ec":"df.drop('society',axis=1,inplace=True)\ndf.head()","38c4241f":"df['price_per_sqft']=df['price']\/df['total_sqft']\ndf.head()","627e3e06":"df[df['total_sqft']<300]","3bd3ad87":"df.drop(df[df['total_sqft']<300].index,inplace=True)","414fc496":"df[df['price_per_sqft']>=40000].head()","8a05b35a":"df.drop(df[df['price_per_sqft']>=40000].index,inplace=True)","6847d3bb":"df[df.price_per_sqft<=1500].head()","97d33451":"df.drop(df[df['price_per_sqft']<=1500].index,inplace=True)","d39f45c1":"df.shape","3052353a":"df[(df['size']==1) & (df['total_sqft']\/df['size']>=1800)]","ad8b153f":"df.drop(df[(df['size']==1) & (df['total_sqft']\/df['size']>=1800)].index,inplace=True)","02e48de4":"df[(df['size']>1) & (df['size']<4) & (df['total_sqft']\/df['size']>=3000)]","2a022e7d":"df.drop(df[(df['size']>1) & (df['size']<4) & (df['total_sqft']\/df['size']>=3000)].index,inplace=True)","90fee285":"df[(df['size']>3) & (df['total_sqft']\/df['size']>=4000)]","bd00cafd":"df.drop(df[(df['size']>3) & (df['total_sqft']\/df['size']>=4000)].index,inplace=True)","d5e5a51c":"df[df['total_sqft']\/df['size']<300].head()","8e100504":"df.drop(df[df['total_sqft']\/df['size']<300].head().index,inplace=True)","dbae1ccc":"df[df['bath']>=df['size']+2].head()","241d5c6d":"df.drop(df[df['bath']>df['size']+2].index,inplace=True)","69c3fd13":"df[(df['size']<=5) & (df['bath']>=df['size']+2)].head()","03e30528":"df.drop(df[(df['size']<=5) & (df['bath']>=df['size']+2)].index,inplace=True)","d8dd0292":"df[df['size']>=17]","bef6c3c6":"df.drop(df[df['size']>=17].index,inplace=True)","5532cd13":"locations=dict(df['location'].value_counts())\nlocations","6e8e990a":"for k,v in list(locations.items()):\n    if v>10:\n        del locations[k]\nlocations","d946d131":"df.location.replace(list(locations.keys()),'Others',inplace=True)","15294131":"df.location.value_counts()","c3dadc07":"df.shape","25577f26":"def remove_pps_outliers(df):\n  df_out = pd.DataFrame()\n  for key, subdf in df.groupby('location'):\n    m=np.mean(subdf.price_per_sqft)\n    st=np.std(subdf.price_per_sqft)\n    reduced_df = subdf[(subdf.price_per_sqft>(m-st))&(subdf.price_per_sqft<=(m+st))]\n    df_out = pd.concat([df_out, reduced_df], ignore_index = True)\n  return df_out\n\ndf = remove_pps_outliers(df)\ndf.shape","d0068c5a":"def plot_scatter_chart(df1,location):\n    bhk2 = df1[(df1['location']==location) & (df1['size']==2)]\n    bhk3 = df1[(df1['location']==location) & (df1['size']==3)]\n    plt.rcParams['figure.figsize'] = (15,10)\n    plt.scatter(bhk2['total_sqft'],bhk2['price'],color='orange',label='2 BHK', s=50)\n    plt.scatter(bhk3['total_sqft'],bhk3['price'],marker='*', color='blue',label='3 BHK', s=50)\n    plt.xlabel(\"Total Square Feet Area\")\n    plt.ylabel(\"Price (Lakh Indian Rupees)\")\n    plt.title(location)\n    plt.legend()\nplot_scatter_chart(df,\"Yelahanka\")","6c28bc1e":"def remove_bhk_outliers(df):\n    exclude_indices = np.array([])\n    for location, location_df in df.groupby('location'):\n        bhk_stats = {}\n        for bhk, bhk_df in location_df.groupby('size'):\n            bhk_stats[bhk] = {\n                'mean': np.mean(bhk_df.price_per_sqft),\n                'std': np.std(bhk_df.price_per_sqft),\n                'count': bhk_df.shape[0]\n            }\n        for bhk, bhk_df in location_df.groupby('size'):\n            stats = bhk_stats.get(bhk-1)\n            if stats and stats['count']>5:\n                exclude_indices = np.append(exclude_indices, bhk_df[bhk_df.price_per_sqft<(stats['mean'])].index.values)\n    return df.drop(exclude_indices,axis='index')\ndf = remove_bhk_outliers(df)","699ea023":"df.shape","9266a4f4":"def plot_scatter_chart(df1,location):\n    bhk2 = df1[(df1['location']==location) & (df1['size']==2)]\n    bhk3 = df1[(df1['location']==location) & (df1['size']==3)]\n    plt.rcParams['figure.figsize'] = (15,10)\n    plt.scatter(bhk2['total_sqft'],bhk2['price'],color='orange',label='2 BHK', s=50)\n    plt.scatter(bhk3['total_sqft'],bhk3['price'],marker='*', color='blue',label='3 BHK', s=50)\n    plt.xlabel(\"Total Square Feet Area\")\n    plt.ylabel(\"Price (Lakh Indian Rupees)\")\n    plt.title(location)\n    plt.legend()\nplot_scatter_chart(df,\"Yelahanka\")","f3f0417f":"df.describe()","311b33fd":"import matplotlib.pyplot as plt\nplt.rcParams[\"figure.figsize\"] = (10,6)","6c3a9065":"def scatter(parameter):\n    plt.scatter(df[parameter],df['price'])\n    plt.xlabel(parameter)\n    plt.ylabel('price range')\n    plt.title((parameter+' available in  range'))\n    plt.yticks(np.arange(10000000,250000000,10000000))","5910798b":"def bar(parameter):\n    value_count_list=dict(df[parameter].value_counts())\n    plt.bar(value_count_list.keys(),value_count_list.values())\n    plt.xlabel(parameter)\n    plt.ylabel('Count')\n    plt.title(parameter+' Vs total count')","9138ee4f":"plt.xticks(np.arange(1,17,1))\nbar('size')","1e14a647":"plt.xticks(np.arange(1, 17, 1))\nscatter('size')","7990b984":"plt.hist(df['price_per_sqft'],rwidth=0.9,align='left',bins=8)\nplt.xlabel('Per Square Feet')\nplt.ylabel('Count')\nplt.xticks(np.arange(0,30000,2500))\nplt.title('Price per square foot vs total count in that price range')","17017c6f":"plt.xticks(np.arange(1,18,1))\nplt.yticks(np.arange(0,40000,2500))\nplt.scatter(df['size'],df['price_per_sqft'])\nplt.xlabel('size(in bhk)')\nplt.ylabel('Price Per Square Feet')\nplt.title('size(in bhk) availability vs price per square feet')","b09a19d2":"bar('area_type')","d6979df4":"bar('availability')","6554a871":"scatter('availability')","02384578":"bar('balcony')","add19e66":"plt.xticks(np.arange(1,11,1))\nbar('bath')","888ef868":"import seaborn as sns\nnum_vars = [\"bath\", \"balcony\",'total_sqft','size','price']\nsns.heatmap(df[num_vars].corr(),cmap=\"coolwarm\", annot=True)\n","47bfa12c":"df.drop(['price_per_sqft','area_type','balcony'],axis=1,inplace=True)","22f8e4b0":"df.head()","fcc576c9":"availability_dummy=pd.get_dummies(df.availability)\navailability_dummy.head(3)","419961b8":"location_dummy=pd.get_dummies(df.location)\nlocation_dummy.head(3)","f3470594":"df_final=pd.concat([df,availability_dummy,location_dummy.drop('Others',axis=1)],axis=1)\ndf_final.drop(['availability','location'],axis=1,inplace=True)\ndf_final.head()","aab870db":"X=df_final.drop(['price'],axis=1)\ny=df_final['price']","04075ec8":"X.head(3)","fbb1e2b0":"y.head()","225b1491":"from sklearn.model_selection import train_test_split\nX_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.2)\nprint('Shape of X_train : ',X_train.shape)\nprint('Shape of y_train : ',y_train.shape)\nprint('Shape of X_test : ',X_test.shape)\nprint('Shape of y_test : ',y_test.shape)","cd8d5835":"from sklearn.linear_model import LinearRegression, Lasso,Ridge,BayesianRidge,OrthogonalMatchingPursuit,LassoLars\nfrom sklearn.tree import DecisionTreeRegressor, ExtraTreeRegressor\nfrom sklearn.ensemble import RandomForestRegressor, GradientBoostingRegressor\nfrom sklearn.cross_decomposition import PLSRegression\nfrom xgboost import XGBRegressor\nfrom sklearn.model_selection import ShuffleSplit, cross_val_score, GridSearchCV","44e09908":"model_parameters={\n    \n    'Linear Regression':{\n        'model' :             LinearRegression(),\n        'params':{\n            'normalize':     [True, False]\n        }\n    },\n    \n    'Decision Regression':{\n        'model' :             DecisionTreeRegressor(),\n        'params':{\n            'criterion':     ['mse', 'friedman_mse'],\n            'splitter':      ['best','random'],\n            'max_features':  [None,'auto', 'sqrt', 'log2']\n        }\n    },\n    \n    'Random Forest Regression':{\n        'model' :             RandomForestRegressor(),\n        'params':{\n            'max_features':  [None,'auto','sqrt','log2']\n        }\n    },\n    \n    'Gradient Boosting Regressor':{\n        'model' :             GradientBoostingRegressor(),\n        'params':{\n            'loss':          ['ls', 'lad', 'huber', 'quantile'],\n            'criterion':     ['friedman_mse', 'mse'],\n            'max_features':  [None,'auto', 'sqrt', 'log2']\n        }\n    },\n    \n    'Lasso Regressor':{\n        'model' :             Lasso(),\n        'params':{\n            'selection':     ['random', 'cyclic']\n        }\n    },\n    \n    'Ridge Regressor':{\n        'model' :            Ridge(),\n        'params':{\n            'solver':        ['auto','lsqr','saga'],\n            'alpha' :        [0,0.2,0.4,0.6,0.8,1]\n        }\n    },\n    \n    'Extra Tree Regressor':{\n        'model' :             ExtraTreeRegressor(),\n        'params':{\n            'max_features':  ['sqrt','log2']\n        }\n    },\n    \n    'Bayesian Ridge Regressor':{\n        'model' :             BayesianRidge(),\n        'params':{}\n    },\n    \n    'PLS Regression':{\n        'model' :             PLSRegression(),\n        'params':{}\n    },\n    \n    'OrthogonalMatchingPursuit Regressor':{\n        'model' :             OrthogonalMatchingPursuit(),\n        'params':{}\n    },\n    \n    'LassoLars Regressor':{\n        'model' :             LassoLars(),\n        'params':{}\n    },\n    \n    'XGB Regressor':{\n        'model' :              XGBRegressor(),\n        'params':{\n            'n_estimators':[10,50,100,500,1000]\n        }\n    }\n}","bbf67d93":"def best_regression_parameters_model(X,y):\n    scores=[]\n    cv = ShuffleSplit(n_splits=5, test_size=0.2, random_state=0)\n    for model_name, parameters in model_parameters.items():\n        gs=GridSearchCV(parameters['model'],parameters['params'],return_train_score=False,cv=cv)\n        gs.fit(X,y)\n        \n        scores.append({\n            'Model':            model_name,\n            'Best Parameters':  gs.best_params_,\n            'Best Score':       gs.best_score_\n        })\n    model= pd.DataFrame(scores,columns=['Model','Best Parameters','Best Score'])\n    return model\nmodels=best_regression_parameters_model(X,y)","b8f5d719":"models['Best Score']=models['Best Score']*100\nmodels","e360fd05":"models[models['Best Score']>83]","cf736b9d":"for a in [10,50,100,500,1000]:\n    xgb_reg = XGBRegressor(n_estimators=a)\n    xgb_reg.fit(X_train,y_train)\n    print(a,\" : \",xgb_reg.score(X_test,y_test)*100)","a5988f69":"from sklearn.model_selection import cross_val_score\ncross_val_score(XGBRegressor(n_estimators=500),X_train,y_train,cv=10)","54084043":"model= XGBRegressor(n_estimators=500)\nmodel.fit(X_train,y_train)\nmodel.score(X_test,y_test)*100","ec642077":"model.predict(X_test)#predicting test data","818b0299":"Removing Apartments having total_sqft less than 300","3a38f9fa":"Using OneHotEncoder for creating dummy columns of availability and location","781a6455":"Converting Location values having total count less than or equal to 10 to 'Others'  \nThis also helps while buliding model as there will less columns in dummy","5f8806d6":"Removing Society from Dataframe as most of the data is missing","e5265c50":"# Data Science Regression Project : Bengaluru House Price Prediction","1fccdad8":"From above table it is observed that best score is achieved by using Xboost Algorithm  \nSo 'Xboost' is used for price prediction","c9021cdb":"Filling Null Values of bath and balcony ","b1ba06e3":"Most of the apartments in Bengaluru are of size 2-3 bhk","5dbf0f61":"Size Data Featuring","d5b85012":"Removing outliers using help of 'price per sqrt'  taking std and mean per location\n","61a48885":"# Data Visualization","a5776bb4":"Removing Apartments having price per sqft rate higher than 40000","91a4e68e":"# Building the Model","469ee440":"Creating a function for plotting scatter of various parameters against price","12949276":"Removing Data having number of bathrooms much greater than size(bhk)  \neg. A 3 bhk or less apartment usually don't have 5 baths(can be max with 1 common and 3 with attached bedroom)  \nBut in case of apartments with size greater than 4 may have baths equal to size+2","5c46659b":"Most of the apartments have 1-2 balconies","75ef345f":"Most of the data of area type was given in Super built-up Area","fb3101ce":"Finding best model using GridSearchCV","6d81826e":"Looking for the corelation of few parameters with price","19b7955a":"# Trying Different Regression Algorithms and  selecting one with highest score","ec4b5845":"# Preprocessing Data for building ML Model","02b6327e":"Most of the apartments have 2 baths","d80f823b":"The below graph shows the expected results at Yelahanka","76b22e4b":"The data shown below is invalid because  \n1] 18 bhk houses usually dont exist  \n2] And if they exist their total_sqft is not as low as shown below","198d6c54":"total_sqft data Featuring","033822f5":"# Creating Final DataFrame for Model Deployment","74012128":"Most of the Apartments are in range of 5000-10000 price per sqft","4aa747f6":"Removing sufix such as 'BHK', 'Bedroom', 'RK',etc from size values","bb820716":"Creating a function for plotting histogram of unique values of various parameters","688bba57":"Finding total_sqft values which are in string format","e5fb86ba":"Adding New Feature of Price per Square Feet","f42bd6bc":"Converting availability values with month year to only year  \neg. 19-Dec to 2019","7f2f6470":"Bath and Balcony Data Featuring","72279669":"Loading Bengaluru House Price Dataset into Dataframe","fd46402a":"From the above graph it is observed that the price of 2 BHK apartment having approximately same total sqft have higher price than that of 3 BHK ","c3bc966e":"Above total_sqft data shows values are in form of range or in different units  \nConverting values which are in range by simply taking mean of min snd max of range.  \neg. for 2100-2850 the mean will be (2100+2850)\/2=2475  \nAnd for values with different units, converting them to square foot by unit conversion.","34905cb9":"# Data Wrangling","02148f91":"Graph of 2 BHK and 3 BHK apartments at Yelahanka(location) with Price Vs Total Sqft","c268f9d2":"Removing 'Balcony' column as the corelation of balcony is very less with price  \nAnd also removing Price per sqft as it was created only data featuring  \nAnd area type because it also don't affect the price","f94051e0":"Finding unique values and count for each parameter","95cecd2c":"Removing Apartments according to size and total square foot  \neg. Its generally not possible for 1 bhk Apartments to have 10763.9 sqft area so excluding such types","4eadbbaf":"Removing Apartments having price per square foot rate less than 1500","cf8898fc":"Availability Data Featuring","cbcfb4f8":"# Short Analysis","b52e49b1":"Converting Price(in lakhs) to normal form","b7928313":"So Removing such type of apartments from same location having size 's' whose price_per_sqft is less than mean price_per_sqft that of size 's-1'","c24e0a4f":"Most of the apartments are available for Ready to move while a thousand are ready till 2018"}}