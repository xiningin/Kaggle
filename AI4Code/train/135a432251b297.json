{"cell_type":{"90c02252":"code","1b7ec001":"code","3ca470a2":"code","f9b8d9f6":"code","9f6ba892":"code","56756b22":"code","5ec99c36":"code","4468e5f3":"code","c4e8539e":"code","d2d5b869":"code","c3f1de44":"code","cfd5f2f2":"code","83eb0a66":"code","78404b55":"code","70df9442":"code","1632a7fc":"code","691d758f":"markdown","5fcc6393":"markdown","28ff4c31":"markdown","b43dfa53":"markdown"},"source":{"90c02252":"import numpy as np\nimport pandas as pd\n\nfrom sklearn import preprocessing\nfrom sklearn import model_selection # train_test_split\nfrom sklearn import pipeline\nfrom sklearn import ensemble   # RandomForestClassifier\nfrom sklearn import impute\nfrom sklearn import compose\nfrom sklearn import metrics    # accuracy_score, balanced_accuracy_score, plot_confusion_matrix\nfrom sklearn import inspection # permutation_importance, plot_partial_dependence","1b7ec001":"train = pd.read_csv(\"..\/input\/murcia-car-challenge\/train.csv\", index_col=\"Id\")\ntest  = pd.read_csv(\"..\/input\/murcia-car-challenge\/test.csv\",  index_col=\"Id\")\nsub   = pd.read_csv(\"..\/input\/murcia-car-challenge\/sampleSubmission.csv\", index_col=\"Id\")","3ca470a2":"train.head(1)","f9b8d9f6":"# 'Modelo',  'Localidad' 'Puertas',\ncat_vars = ['Marca',  'Provincia', 'Cambio', 'Combust',  'Vendedor']\nnum_vars = ['A\u00f1o', 'Kms', 'Cv']\ntarget_var = 'Precio'\n\nx = train[cat_vars + num_vars]\ny = train[target_var]","9f6ba892":"x.info()","56756b22":"# train = train.dropna(axis='rows')\n# test  = test.dropna(axis='rows')","5ec99c36":"num_preprocessing = pipeline.Pipeline(steps=[\n    ('imputer', impute.SimpleImputer(strategy='median')),\n    ('encoder', preprocessing.StandardScaler())\n])\n\ncat_preporcessing = pipeline.Pipeline(steps=[\n    ('imputer', impute.SimpleImputer(strategy='constant', fill_value='missing')),\n    ('encoder', preprocessing.OrdinalEncoder())\n])\n\npreprocessor = compose.ColumnTransformer(transformers=[\n    ('num', num_preprocessing, num_vars),\n    ('cat', cat_preporcessing, cat_vars)\n])","4468e5f3":"# cat_encoder = ce.OrdinalEncoder    or     preprocessing.OrdinalEncoder()","c4e8539e":"x_train, x_valid, y_train, y_valid = model_selection.train_test_split(x, y,\n                                                      test_size=0.2,\n                                                      random_state=0)","d2d5b869":"model = ensemble.RandomForestRegressor(n_jobs=-1)\n\nprep_model = pipeline.Pipeline(steps=[\n    ('preprocessor', preprocessor),\n    ('classifier', ensemble.RandomForestRegressor(\n                              n_estimators=100,\n                              n_jobs=-1\n    ))\n])","c3f1de44":"prep_model.fit(x_train, y_train);","cfd5f2f2":"preds = prep_model.predict(x_valid)\npreds","83eb0a66":"metrics.mean_squared_log_error(y_valid, preds)","78404b55":"test_preds = prep_model.predict(test)\ntest_preds","70df9442":"sub['Precio'] = test_preds # test_preds.astype(int)\nsub.head()","1632a7fc":"sub.to_csv('sub.csv', header=True, index=True)","691d758f":"# Train","5fcc6393":"# Preprocessing","28ff4c31":"# Predict test data","b43dfa53":"# Evaluate"}}