{"cell_type":{"0b2d8331":"code","bfc645cb":"code","340e858c":"code","896e07b7":"code","23d1136e":"code","52571a51":"code","eb28e482":"code","66655569":"code","bc42530d":"code","2e070d8c":"code","b8a42aca":"code","11c47b79":"code","cd4bb98d":"code","0cab5115":"markdown","422f430d":"markdown","c127d211":"markdown","fe260f59":"markdown","a72d5ea6":"markdown","38d8e1b6":"markdown","34805fa2":"markdown"},"source":{"0b2d8331":"import pandas as pd\nimport numpy as np\nfrom scipy.stats import chi2_contingency\nimport matplotlib.pyplot as plt\nimport seaborn as sns","bfc645cb":"df=pd.read_csv('..\/input\/mushroom-classification\/mushrooms.csv')","340e858c":"df.head()","896e07b7":"plt.subplots(4,6,figsize=(20,10))\na=1\nfor i,s in enumerate(df.columns):\n    plt.subplot(4,6,a)\n    sns.countplot(x=df[s],hue=df['class'])\n    a+=1","23d1136e":"def cramerV(var_1,var2) :\n    cont_tab =np.array(pd.crosstab(var1,var2)) \n    chi2 = chi2_contingency(cont_tab)[0] \n    sample = np.sum(cont_tab) \n    minimum = min(cont_tab.shape)-1 \n    return (chi2\/(sample*minimum))","52571a51":"from sklearn.preprocessing import LabelEncoder\nle=LabelEncoder()\ndf_coded = pd.DataFrame() \n\nfor i in df.columns :\n    df_coded[i]=le.fit_transform(df[i])","eb28e482":"df=pd.get_dummies(df,drop_first=True)","66655569":"y=df['class_p']\nX=df.drop(\"class_p\",axis=1)","bc42530d":"from sklearn.model_selection import train_test_split\nX_train,X_test,y_train,y_test=train_test_split(X,y)","2e070d8c":"from sklearn.linear_model import LogisticRegression\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.metrics import classification_report,confusion_matrix\nlr=LogisticRegression()\nlr.fit(X_train,y_train)\nprint(\"The cross validation sample score is\",cross_val_score(lr,X_train,y_train,cv=5).mean())\npred=lr.predict(X_test)\nprint(classification_report(y_test,pred))\n\nsns.heatmap(confusion_matrix(y_test,pred),annot=True)","b8a42aca":"from sklearn.tree import DecisionTreeClassifier\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.metrics import classification_report,confusion_matrix\ndtc=DecisionTreeClassifier()\ndtc.fit(X_train,y_train)\nprint(\"The cross validation sample score is\",cross_val_score(lr,X_train,y_train,cv=5).mean())\npred=dtc.predict(X_test)\nprint(classification_report(y_test,pred))\n\nsns.heatmap(confusion_matrix(y_test,pred),annot=True)","11c47b79":"from sklearn.ensemble import RandomForestClassifier\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.metrics import classification_report,confusion_matrix\nrf=RandomForestClassifier()\nrf.fit(X_train,y_train)\nprint(\"The cross validation sample score is\",cross_val_score(lr,X_train,y_train,cv=5).mean())\npred=rf.predict(X_test)\nprint(classification_report(y_test,pred))\n\nsns.heatmap(confusion_matrix(y_test,pred),annot=True)","cd4bb98d":"pd.DataFrame(rf.feature_importances_,index=X_train.columns).sort_values(0,ascending=False).head(10).plot(kind='barh')","0cab5115":"# Random Forest Classifer","422f430d":"# EDA","c127d211":"# Decision Tree Classifier","fe260f59":"As we saw in the correlation the odor is probably the strongest indicator of whether a mushroom is poisonous or not.Furthermoregill_size & ring_type are also important features to be evaluated","a72d5ea6":"# Feature Engineering","38d8e1b6":"\n# Cramer V \n","34805fa2":"\n# Logistic Regression"}}