{"cell_type":{"8c62308c":"code","2be5b574":"code","ff57e9c6":"code","080f3d4e":"code","581bbbd7":"code","a82d84ba":"code","4b0ddbb5":"code","1f6d2e46":"code","e38745cc":"code","0e7fa80f":"code","ccb4b3f1":"code","7c9e4741":"code","06c1e9d9":"code","382e8ce5":"code","4f34f7d3":"code","4b087800":"code","e70cd47f":"code","0c84fdb3":"code","5f663e82":"code","e2911108":"code","ac0724c3":"code","55c2b0ef":"code","a758b4b4":"code","d768f503":"code","c3fcf8ad":"code","d6da03ab":"code","4cf476a6":"code","db2e4d9f":"code","6c32509d":"code","556c8296":"code","b9059409":"code","821d61c7":"code","190a4667":"code","2d0b02a2":"code","5bde3129":"code","46924294":"code","32f02f0f":"code","842c4b86":"code","00415d03":"code","69e4fa29":"code","fc2a2a03":"code","eea82047":"code","b27d414e":"code","a763dfdf":"code","462e585f":"code","e39e1cda":"code","2ae5ef24":"code","744ab40a":"code","2b66290f":"code","b542b3d6":"code","4f2a7c56":"code","28df504b":"code","5e8aaab0":"code","a4a75bb2":"code","976255be":"code","8c78a3f2":"code","3d878303":"markdown","440a857d":"markdown","65a3a0c5":"markdown","fe55b057":"markdown","80cdceaf":"markdown","15f9a2de":"markdown","9f5878c0":"markdown","f7ce20fc":"markdown","1cc5dbc8":"markdown","dd6a54a3":"markdown","977451f8":"markdown","478c0aac":"markdown","da264e9b":"markdown","076944ec":"markdown","616f77ca":"markdown","596d0444":"markdown","0f6262b8":"markdown","b68b82b5":"markdown","09170f72":"markdown","3a90476e":"markdown","12f620ad":"markdown","39471028":"markdown","03df3016":"markdown","f05e2ca8":"markdown","63693257":"markdown"},"source":{"8c62308c":"import pandas as pd\nimport numpy as np\nimport sklearn","2be5b574":"adult = pd.read_csv(\"..\/input\/adult-pmr3508\/train_data.csv\",\n        index_col=['Id'], na_values=\"?\")","ff57e9c6":"adult.head()","080f3d4e":"adult.shape","581bbbd7":"adult[\"hours.per.week\"].value_counts()","a82d84ba":"import matplotlib.pyplot as plt","4b0ddbb5":"adult[\"age\"].value_counts().plot(kind=\"bar\")","1f6d2e46":"adult[\"workclass\"].value_counts().plot(kind=\"bar\")","e38745cc":"adult[\"education.num\"].value_counts().plot(kind=\"bar\")","0e7fa80f":"adult[\"marital.status\"].value_counts().plot(kind=\"bar\")","ccb4b3f1":"adult[\"occupation\"].value_counts().plot(kind=\"bar\")","7c9e4741":"adult[\"race\"].value_counts().plot(kind=\"bar\")","06c1e9d9":"adult[\"sex\"].value_counts().plot(kind=\"bar\")","382e8ce5":"adult[\"education\"].value_counts().plot(kind=\"bar\")","4f34f7d3":"adult_lapidado = adult.dropna()","4b087800":"adult_lapidado.shape","e70cd47f":"teste_adult = pd.read_csv(\"..\/input\/adult-pmr3508\/test_data.csv\",\n        index_col=['Id'], na_values=\"?\")","0c84fdb3":"teste_adult.shape","5f663e82":"teste_adult_lapidado = teste_adult.dropna()","e2911108":"teste_adult_lapidado.head()","ac0724c3":"Xadult = adult_lapidado[[\"age\",\"education.num\",\"capital.gain\", \"capital.loss\", \"hours.per.week\"]]","55c2b0ef":"Yadult = adult_lapidado[[\"income\"]]\nnp.ravel(Yadult)","a758b4b4":"from sklearn.neighbors import KNeighborsClassifier","d768f503":"knn = KNeighborsClassifier(n_neighbors=3)","c3fcf8ad":"from sklearn.model_selection import cross_val_score","d6da03ab":"scores = cross_val_score(knn, Xadult, Yadult, cv = 10)","4cf476a6":"scores","db2e4d9f":"scores.mean()","6c32509d":"knn = KNeighborsClassifier(n_neighbors=10)","556c8296":"scores = cross_val_score(knn, Xadult, Yadult, cv = 10)","b9059409":"scores","821d61c7":"scores.mean()","190a4667":"knn = KNeighborsClassifier(n_neighbors=15)","2d0b02a2":"scores = cross_val_score(knn, Xadult, Yadult, cv = 10)","5bde3129":"scores","46924294":"scores.mean()","32f02f0f":"knn = KNeighborsClassifier(n_neighbors=20)","842c4b86":"scores = cross_val_score(knn, Xadult, Yadult, cv = 10)","00415d03":"scores","69e4fa29":"scores.mean()","fc2a2a03":"knn = KNeighborsClassifier(n_neighbors=25)","eea82047":"scores = cross_val_score(knn, Xadult, Yadult, cv = 10)","b27d414e":"scores","a763dfdf":"scores.mean()","462e585f":"knn = KNeighborsClassifier(n_neighbors=30)","e39e1cda":"scores = cross_val_score(knn, Xadult, Yadult, cv = 10)","2ae5ef24":"scores\n","744ab40a":"scores.mean()","2b66290f":"Xteste = teste_adult[[\"age\",\"education.num\",\"capital.gain\", \"capital.loss\", \"hours.per.week\"]]","b542b3d6":"classificador = KNeighborsClassifier(n_neighbors=16)\nclassificador.fit(Xadult, Yadult)\n\npredicao = classificador.predict(Xteste)\npredicao","4f2a7c56":"submissao = pd.DataFrame()","28df504b":"submissao[0] = Xteste.index\nsubmissao[1] = predicao\nsubmissao.columns = [\"Id\", \"Income\"]\nsubmissao.head()","5e8aaab0":"submissao.to_csv('submissao.csv',index = False)","a4a75bb2":"import seaborn as sns","976255be":"adult_lapidado[\"income\"] = adult_lapidado[\"income\"].map({\"<=50K\": 0, \">50K\":1})\nadult_lapidado[\"sex.num\"] = adult_lapidado[\"sex\"].map({\"Male\": 1, \"Female\":0})","8c78a3f2":"sns.catplot(y=\"sex\", x=\"income\", kind=\"bar\", data=adult_lapidado);","3d878303":"Leremos tamb\u00e9m a base de dados de teste tamb\u00e9m fornecida no Kaggle","440a857d":"# EP1 PMR3508, BY: Gustavo de Mattos","65a3a0c5":"Para um k=15, teremos:","fe55b057":"Agora, plotaremos gr\u00e1ficos de algumas colunas, com int\u00faito de observar a distribui\u00e7\u00e3o desses dados.\nPara isso, importaremos a biblioteca matplotlib, e usaremos o comando .value_counts().plot para plotar esses gr\u00e1ficos.","80cdceaf":"Como podemos ver, h\u00e1 uma grande diferen\u00e7a, enquanto 30% dos homens recebem >50k, enquanto apenas 10% das mulheres recebem esse valor. Isso mostra que infelizmente, a desigualdade salarial entre os sexos \u00e9 consider\u00e1vel atualmente.","15f9a2de":"Agora, usaremos o k=10 para ver se nossa acur\u00e1cia melhora","9f5878c0":"Vemos, portanto, que a grande maioria trabalha em torno de 40 horas por semana, o que \u00e9 um dado esperado, tendo em vista que o expediente comum \u00e9 de 8 horas por dia, durante os 5 dias da semana.","f7ce20fc":"Tamb\u00e9m mostraremos o tamanho de nossa base de dados (n\u00famero de linhas, n\u00famero de colunas) por meio do comando .shape","1cc5dbc8":"Assim como fizemos com a base de dados de treino, tamb\u00e9m verificaremos o tamanho dessa base de dados, por meio do comando .shape, e em seguida, tamb\u00e9m criaremos um teste_adult_lapidado, excluindo os dados faltantes.","dd6a54a3":"Por meio do comando .value_counts(), analisaremos somente a coluna \"hours.per.week\" para termos no\u00e7\u00e3o de como esses dados est\u00e3o distribu\u00eddos.","977451f8":"Para um k=20:","478c0aac":"Come\u00e7aremos o teste com o k = 3, e veremos a acur\u00e1cia para esse valor","da264e9b":"Note que, foram exclu\u00eddas a maioria das colunas, para manter apenas as colunas que julgamos ter maior impacto para o classificador.","076944ec":"A partir daqui, criaremos Xadult, que corresponde aos valores de cada uma das colunas para o mesmo indiv\u00edduo, e o Yadult, que corresponde ao valor de income desse indiv\u00edduo, ou seja, se ele recebe menos ou mais de 50K","616f77ca":"Em seguida, leremos a base de dados treino, fornecida no Kaggle, e criaremos uma tabela \"adult\", que recebe a base de dados.\nPara as c\u00e9lulas cujos dados s\u00e3o inexistentes, daremos o nome de \"?\".","596d0444":"Mostraremos, ent\u00e3o, como est\u00e1 a estrutura da nossa tabela, por meio do comando .head()","0f6262b8":"Para k=25:","b68b82b5":"Primeiramente, importaremos as bibliotecas que ser\u00e3o necess\u00e1rias para o desenvolvimento deste programa.","09170f72":"Agora, predizeremos os dados do dados_teste e faremos a submiss\u00e3o no Kaggle.Para isso criaremos um classificador e a predi\u00e7\u00e3o.","3a90476e":"Para k=30:","12f620ad":"Ap\u00f3s feita a submiss\u00e3o, a t\u00edtulo de curiosidade faremos um pequeno experimento social envolvendo os dados de sexo, e os relacionando com o r\u00f3tulo de <=50k ou >50k, e para isso, importaremos a biblioteca seaborn.\n","39471028":"Agora, criaremos a tabela adult_lapidado, que \u00e9 a mesma tabela adult, s\u00f3 que com a retirada dos dados faltantes, pois n\u00e3o h\u00e1 interesse em trabalhar com eles.\nUma op\u00e7\u00e3o seria preencher os dados faltantes com a moda, mas afim de evitar falsas suposi\u00e7\u00f5es, foi optado por retir\u00e1los, por meio do comando drop.na()","03df3016":"Vimos que ap\u00f3s a exclus\u00e3o dos dados faltantes, ocorre uma retirada de aproximadamente 2000 linhas da tabela.","f05e2ca8":"Portanto, o maior valor de k encontrado foi o de k=30.","63693257":"Agora faremos um classificador knn com cross-validation igual a 10, a fim de encontrar um k que seja favor\u00e1vel para o classificador, para isso, testaremos algum dos valores para k."}}