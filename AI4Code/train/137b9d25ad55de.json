{"cell_type":{"41dff547":"code","30ad2188":"code","335f6535":"code","1b53718d":"code","4cde2a95":"code","9045d9b6":"code","9aa0c090":"code","85276e15":"code","f18e37e9":"code","8112e08b":"code","3d24338a":"code","129cb307":"code","9f9fc3ba":"code","73835b60":"code","9a12166a":"code","034c5e12":"markdown","f3e7d036":"markdown","de4855ee":"markdown","54c51d21":"markdown"},"source":{"41dff547":"import warnings\nimport pandas as pd\nimport plotly.express as px\nimport sqlite3","30ad2188":"data = pd.read_csv(\"..\/input\/fifa-2018-world-cup-players\/all_wc_18_players_fifa.csv\")\nconn = sqlite3.connect(\"fifa_wc_18.db\")\ndata.to_sql(\"fifa_wc_18\", conn)","335f6535":"pd.read_sql('select * from fifa_wc_18;', conn)","1b53718d":"# PLotting a chart of average height of players from each country\n\nheight_players = pd.read_sql('select team as \"Country\", avg(height) as \"Average Height\" from fifa_wc_18 group by \"Country\" order by \"Country\";', conn)\nheight_players","4cde2a95":"px.bar(height_players, x=\"Country\", y=\"Average Height\", title=\"Average height of players from each participant country\", color=\"Average Height\")","9045d9b6":"# Finding the tallest player(s) during the tournament\n\ntallest_player = pd.read_sql('select name as \"Name\", team as \"Country\", height as \"Height\", weight as \"Weight\" from fifa_wc_18 where \"Height\" = (select max(height) from fifa_wc_18);', conn)\ntallest_player","9aa0c090":"# Finding the shortest player(s) during the tournament\n\nshortest_player = pd.read_sql('select name as \"Name\", team as \"Country\", height as \"Height\", weight as \"Weight\" from fifa_wc_18 where \"Height\" = (select min(height) from fifa_wc_18);', conn)\nshortest_player","85276e15":"# Plotting a chart of average weight of players from each country\n\nweight_country = pd.read_sql('select team as \"Country\", avg(weight) as \"Average Weight\" from fifa_wc_18 group by \"Country\" order by \"Country\";', conn)\nweight_country","f18e37e9":"px.bar(weight_country, x=\"Country\", y=\"Average Weight\", color=\"Average Weight\", title=\"Average weight of players from each particpating team\")","8112e08b":"# Plotting a chart depicting the relation between average weight and height of players.\n\nheight_weight = pd.read_sql('select height as \"Height\", avg(weight) as \"Average Weight\" from fifa_wc_18 group by \"Height\" order by \"height\";', conn)\nheight_weight","3d24338a":"px.line(height_weight, x=\"Height\", y=\"Average Weight\", title=\"Height-Weight Relationship\")","129cb307":"# Participation of players from each league\n\npart_league = pd.read_sql('select league as \"League\", count(league) as \"Participants\" from fifa_wc_18 group by \"League\" order by \"League\";', conn)\npart_league ","9f9fc3ba":"px.bar(part_league, x=\"League\", y=\"Participants\", color=\"Participants\", title=\"Participation of players from each league\")","73835b60":"# Average age of players from each team\n\nage_team = pd.read_sql('select team as \"Country\", avg(age) as \"Average Age\" from fifa_wc_18 group by \"Country\" order by \"Average Age\";', conn)\n\npx.bar(age_team, x=\"Country\", y=\"Average Age\", color=\"Average Age\", title=\"Average age of players based on country\")","9a12166a":"# Player in the tournament with 100 or more caps.\n# For those who dont know, caps represent the number of international apperances a player has made for his country.\n\ntop_caps = pd.read_sql('select name as \"Name\", team as \"Country\", caps as \"Caps\" from fifa_wc_18 where \"Caps\" >= 100 order by caps desc;', conn)\ntop_caps","034c5e12":"**SECTION 2:** Participation and various forms of data based on the <code>club and league<\/code> of players.","f3e7d036":"**Section 1:** Basic health analysis of players like <code>height and weight.<\/code>","de4855ee":"**SECTION 3:** Sorting players and team based on their <code>experience, caps and position.<\/code>","54c51d21":"# A small debrief of FIFA WC18 using SQL\n\nThe notebook is divided into 3 major sections:\n\n1. **SECTION 1:** Basic healt analysis of players like <code>height and weight.<\/code>\n    * Plotting chart of average heigth of players from each country.\n    * Finding the tallest player(s) during the tournament.\n    * Finding the shortest player(s) during the tournament.\n    * Plotting chart of average weight of players from each country.\n    * Plotting chart depicting height-weight relation of players in tournament.\n    \n2. **SECTION 2:** Participation and various forms of data based on the <code>club and league<\/code> of players.\n    * Participation of players from each league\n    \n3. **SECTION 3:** Sorting players and team based on their <code>experience, caps and position.<\/code>\n    * Average age of players from each country\n    * Players in the tournament with 100 or more caps."}}