{"cell_type":{"c5fc05e1":"code","20a8d224":"code","0b66ffdd":"code","a5506013":"code","ee6b65fa":"code","925922ff":"code","94bfbc28":"code","a4231ab0":"code","286aace6":"code","8b64e133":"code","76ebd82e":"code","bad52168":"code","4feaad11":"code","0a682825":"code","1bf6b1ff":"code","ab080006":"code","d15d4278":"markdown","5df41cbb":"markdown","bc06428d":"markdown","8496d4e2":"markdown","4c056d73":"markdown","0eabfcc3":"markdown","847fb6e9":"markdown","c999ff5d":"markdown","829c4fc6":"markdown","b6a6bf1d":"markdown","cc8d679e":"markdown","a3944ac0":"markdown","67657a06":"markdown","694a7b32":"markdown","3c1ffbc2":"markdown","9d664cae":"markdown","eca693ba":"markdown","d70bc6f5":"markdown","d601d7dc":"markdown"},"source":{"c5fc05e1":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns","20a8d224":"df=pd.read_csv('..\/input\/covid19-india-news-headlines-for-nlp\/raw_data.csv',usecols=['Headline','Sentiment','Description'])\ndf.head()","0b66ffdd":"df.shape","a5506013":"df.info()","ee6b65fa":"X=df.drop('Sentiment',axis=1)\ny=df['Sentiment']","925922ff":"messages=X.copy()","94bfbc28":"import re\nimport nltk\nfrom nltk.stem import PorterStemmer\nfrom nltk.corpus import stopwords\nps=PorterStemmer()\ncorpus=[]\nfor i in range(len(messages)):\n    review=re.sub('[^a-zA-Z]',' ',messages['Headline'][i])\n    review=review.lower()\n    review=review.split()\n    review=[ps.stem(word) for word in review if not word in stopwords.words('english')]\n    review=' '.join(review)\n    corpus.append(review)","a4231ab0":"corpus","286aace6":"voc_size=5000\n\nfrom tensorflow.keras.layers import Embedding\nfrom tensorflow.keras.preprocessing.sequence import pad_sequences\nfrom tensorflow.keras.models import Sequential\nfrom tensorflow.keras.preprocessing.text import one_hot\nfrom tensorflow.keras.layers import LSTM\nfrom tensorflow.keras.layers import Dense","8b64e133":"onehot_repr=[one_hot(words,voc_size) for words in corpus]\nonehot_repr","76ebd82e":"sent_length=20\nembedded_docs=pad_sequences(onehot_repr,padding='pre',maxlen=sent_length)\nprint(embedded_docs)","bad52168":"from tensorflow.keras.layers import Dropout\nembedding_vector_features=40\nmodel=Sequential()\nmodel.add(Embedding(voc_size,embedding_vector_features,input_length=sent_length))\nmodel.add(Dropout(0.5))\nmodel.add(LSTM(200))\nmodel.add(Dropout(0.5))\nmodel.add(Dense(1,activation='sigmoid'))\nmodel.compile(loss='binary_crossentropy',optimizer='adam',metrics=['accuracy'])","4feaad11":"import numpy as np\n\nX_final=np.array(embedded_docs)\ny_final=np.array(y)","0a682825":"from sklearn.model_selection import train_test_split\nX_train,X_test,y_train,y_test=train_test_split(X_final,y_final,test_size=0.33,random_state=42)","1bf6b1ff":"model.fit(X_train,y_train,validation_data=(X_test,y_test),epochs=10,batch_size=64)","ab080006":"y_pred=model.predict_classes(X_test)\n\nfrom sklearn.metrics import accuracy_score\nprint(accuracy_score(y_test,y_pred))","d15d4278":"One of the most important step in NLP is to convert text data to vector so that it generalizes well to the predictions\u00a0. One of the word representation technique is One Hot Representation where we assign index to the words based on a vocabulary size\u00a0. https:\/\/medium.com\/p\/6b633f296337\/edit You can refer my mediuma article for intuition ,\n\nOne of the disadvantage is that semantic information is not captured and size is also huge\u00a0. It won't treat 'good' and 'great' similar\u00a0.","5df41cbb":"![image.png](attachment:811e5ccd-00dc-4b7c-bdf0-70dbbd8d3c3f.png)!","bc06428d":"Steps followed\n\n* Importing Dataset and required libraries\n* Text Data pre-processing (Cleaning)\n* One Hot representation (converting words to vector)\n* Padding sequence and embedding layer\n* Creating LSTM model\n","8496d4e2":"# Introduction","4c056d73":" **Sentiment Analysis is the process of computationally identifying and categorizing opinions from a piece of text and determining whether attitude towards a product\/topic is positive\u00a0, negative or neutral. Sentiment Analysis is one of the main applications of Natural Language processing.**","0eabfcc3":"**In this kernel, let's go through the basic steps in creating a basic sentiment analysis system where it will predict whether the news is positive or negative.**","847fb6e9":"**Before passing One Hot representation to the embedding layer\u00a0, we need to make sure that all the length of the sentences are equal\u00a0. If it is not the same\u00a0, we apply pre padding with zeroes to make the lengths equal by first defining a sentence length\u00a0.**","c999ff5d":"# C] One Hot Representation","829c4fc6":"**First lets define the independent and dependent variable**","b6a6bf1d":"# Objective","cc8d679e":"# A] Importing Dataset and libraries","a3944ac0":"![image.png](attachment:feb16b8e-91ab-458e-a176-ef69abb21a09.png)!","67657a06":"# E] LSTM Model building","694a7b32":"# B] Text Data pre-processing and cleaning","3c1ffbc2":"# D] Padding sequence and embedding layer","9d664cae":"![image.png](attachment:566b8987-0076-4de5-85ee-74e6f5a35e32.png)!","eca693ba":"**Here the positive sentiment is represented by '1' and negative sentiment by '0'. Sentiment is our target variable and other variables as independent(X) variables.**","d70bc6f5":"![image.png](attachment:4c83009a-953c-440b-aed8-d3e03f89ebdb.png)!","d601d7dc":"* 1)The first step is to remove the Stop words like 'the'\u00a0, 'of'\u00a0, 'is'\u00a0, 'a' from every sentence as they do not contribute to the algorithm performance and then perform Stemming on each word where we remove the suffix of the word and reduce it to it's root word. eg.) history-histori\n\n* 2) We do stemming on the corpus of text to bring uniformity as there are many words which have same meaning with different suffixes. So we reduce such similar words to one root word. Stemming words at times makes no sense as the words it produces may not have dictionary meaning. So, we also use Lemmatization at times because it gives dictionary meaning of words. Stemming is used in Sentiment Analysis and Lemmatization is used in Q\/A applications, chatbots.\n\n* 3) We also convert all the words to similar cases so that two similar words with different cases won't be treated distinct.\n\n* 4) We use NLTK library, regular expressions library, PorterStemmer(for stemming)."}}