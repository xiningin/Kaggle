{"cell_type":{"aa0c1964":"code","b6e21cca":"code","de7a996e":"code","b79f16b2":"code","dcff1100":"code","c5285a03":"code","8a5b2239":"code","1996ba28":"code","8e739b9f":"code","39f9d478":"code","9223dd01":"code","fc5740a3":"code","ffdf24fb":"code","4513f1c8":"code","56fcf696":"code","45b0cbae":"code","8fbb5eca":"code","b1c9b38c":"code","edb21c9e":"code","5d61ec57":"code","c49181a0":"code","41ddbf88":"code","c1d998fe":"code","e1075081":"code","404a56cb":"code","bc092c2c":"code","32183ad9":"code","faf40d02":"code","425d5a1c":"code","eb2e46c8":"code","fde15fab":"code","bca0e5c1":"code","3714914f":"code","02049b77":"code","201e8731":"code","7c889d14":"code","831bc13f":"code","e8838646":"code","abecb9bb":"code","45dedb93":"code","0e4d3f98":"code","87e7b57f":"code","76655657":"code","e0f41215":"code","1fe50b8d":"code","e0980540":"code","7507d768":"code","14cb5db1":"code","3bd7f129":"code","54aa3fff":"code","cebdfc7c":"code","d309dbe9":"code","c4909d5e":"code","9b8054b9":"code","54190498":"code","f02f8845":"code","79c32001":"code","c3391b81":"code","a5f2a500":"code","c7822ce1":"code","21359414":"code","78ed82b4":"code","22083d40":"code","0886824d":"code","2cd74d70":"code","b6bd5b31":"code","a0127f4a":"code","1581f695":"code","7632578f":"code","7069b240":"code","0f4f1f5a":"code","4f39755d":"code","44438415":"code","3bf71b57":"code","7521873e":"code","7ac3c60c":"code","8fc6d7a4":"code","5fdaa9fc":"code","4674250c":"code","86ab1202":"code","3208b6b3":"code","d8723cdb":"code","9b703d4a":"code","93f84282":"code","ee5e46e7":"code","f8997ad6":"code","f158fdfd":"code","62511c35":"code","c2779d52":"code","abcf62a0":"code","065c458a":"code","7ee0b729":"code","89cd2aa7":"code","b4adabec":"code","a6302202":"code","d520f99e":"markdown","5b0b8e61":"markdown","ea1c645d":"markdown","284431a3":"markdown","70eddbca":"markdown","73840730":"markdown","452e96e5":"markdown","11d6caca":"markdown","be789216":"markdown","f2f60c0f":"markdown","edb3e132":"markdown","7e72efab":"markdown","ea627b5d":"markdown","555f6a7b":"markdown","eca53af6":"markdown","4223aff9":"markdown","55c68246":"markdown","57dc4e35":"markdown","0408931d":"markdown","9d3258df":"markdown","febef2dd":"markdown","ec7942cc":"markdown","7f87c340":"markdown","1ec9cecd":"markdown","1a8428a6":"markdown","ed602193":"markdown","77397f78":"markdown","acfc08a4":"markdown","581ef4f7":"markdown","8e97a820":"markdown","3c9fa401":"markdown","a851ee96":"markdown","baf68396":"markdown","769512d1":"markdown","18f0e682":"markdown","2d485c0b":"markdown","75aa3636":"markdown","3f084f5b":"markdown","532833a6":"markdown","dcf7eea4":"markdown","a470aed0":"markdown","06f62ffe":"markdown","94afef2b":"markdown","281b1221":"markdown","cd7e152a":"markdown","249e4fed":"markdown","db9ea361":"markdown","a7cb3287":"markdown","c843ef88":"markdown","7a8d999d":"markdown","2348953f":"markdown","ab9a6140":"markdown","dc57aa0c":"markdown","ec60e053":"markdown","d63ad266":"markdown","2652630c":"markdown","f48dcd30":"markdown","2805dd7d":"markdown","754fe009":"markdown","7b339a38":"markdown","bc8b205c":"markdown","b2ebe96d":"markdown","3cd5833b":"markdown","181cd3d0":"markdown","35fb6e08":"markdown","23dcdd4c":"markdown","65c0cbda":"markdown","fc954511":"markdown","12a0d4f2":"markdown","165c401c":"markdown","2d277ccd":"markdown","90487857":"markdown","a3c3625c":"markdown","ccabb5b4":"markdown","ccece458":"markdown","c4e70438":"markdown","cb29d127":"markdown","a31d415d":"markdown","b6d52664":"markdown","7730b347":"markdown","b1e6af16":"markdown","2e355af7":"markdown","4952d1a1":"markdown","193711bf":"markdown","15303403":"markdown","7084f665":"markdown","a2fbdc73":"markdown","2e448e8a":"markdown","f01c737e":"markdown","de8a1c68":"markdown","0a70949a":"markdown","83bc986b":"markdown","9f359685":"markdown","e3122aff":"markdown","ad385b87":"markdown","40f1d21f":"markdown","a8ed440a":"markdown","43c50a4d":"markdown","ef83d51f":"markdown","34c70f87":"markdown","1340b104":"markdown","fca07f9e":"markdown","e833bb06":"markdown"},"source":{"aa0c1964":"import math\nimport pandas as pd\nimport matplotlib\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport plotly.express as px\n%matplotlib inline\nimport numpy as np\nfrom sklearn.linear_model import LinearRegression, SGDRegressor\nfrom sklearn import metrics, preprocessing\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.model_selection import train_test_split","b6e21cca":"medical_df = pd.read_csv('..\/input\/health-insurance-dataset\/Health_insurance.csv')\nmedical_df","de7a996e":"medical_df.info()","b79f16b2":"medical_df.describe()","dcff1100":"sns.set_style('darkgrid')\nmatplotlib.rcParams['font.size'] = 14\nmatplotlib.rcParams['figure.figsize'] = (10, 6)\nmatplotlib.rcParams['figure.facecolor'] = '#00000000'","c5285a03":"medical_df.age.describe()","8a5b2239":"fig = px.histogram(medical_df, x='age', marginal='box', nbins=64-18+1, title='Age Distribution')\nfig.update_layout(bargap=0.1)\nfig.show()","1996ba28":"medical_df.bmi.describe()","8e739b9f":"fig = px.histogram(medical_df, x='bmi', title='BMI Distribution', marginal='box', color_discrete_sequence=['orange'])\nfig.update_layout(bargap=0.1)\nfig.show()","39f9d478":"medical_df.charges.describe()","9223dd01":"fig = px.histogram(medical_df, x='charges', color='smoker', color_discrete_sequence=['red', 'green'], title='Charges Distribution-Smoker', marginal='box')\nfig.update_layout(bargap=0.1)\nfig.show()","fc5740a3":"fig = px.histogram(medical_df, x='charges', color='sex', color_discrete_sequence=['pink', 'black'], title='Charges Distribution-Sex', marginal='box')\nfig.update_layout(bargap=0.1)\nfig.show()","ffdf24fb":"fig = px.histogram(medical_df, x='charges', color='region', color_discrete_sequence=['red', 'green', 'blue', 'yellow'], title='Charges Distribution-Region', marginal='box')\nfig.update_layout(bargap=0.1)\nfig.show()","4513f1c8":"medical_df.smoker.value_counts()\n#many are non-smokers","56fcf696":"px.histogram(medical_df, x='smoker', color='sex', title='Smoker-Sex')","45b0cbae":"fig = px.scatter(medical_df, x='age', y='charges', color='smoker', color_discrete_sequence=['red','blue'], opacity=0.8, title='Age Vs Charges', hover_data=['sex'])\nfig.update_traces(marker_size=5)\nfig.show()","8fbb5eca":"fig = px.scatter(medical_df, x='bmi', y='charges', color='smoker', color_discrete_sequence=['red','blue'], opacity=0.8, title='BMI Vs Charges', hover_data=['sex'])\nfig.update_traces(marker_size=5)\nfig.show()","b1c9b38c":"medical_df.sex.value_counts() #uniform distribution","edb21c9e":"fig = px.violin(medical_df, x='sex', y='charges', title='Sex Vs Charges', hover_data=['sex'])\nfig.show()","5d61ec57":"fig = px.violin(medical_df, x='children', y='charges', title='Number of Children Vs Charges', hover_data=['sex'])\nfig.show()","c49181a0":"fig = px.violin(medical_df, x='region', y='charges', title='Regions Vs Charges', hover_data=['sex'])\nfig.show()","41ddbf88":"fig = px.violin(medical_df, x='smoker', y='charges', title='Smoking Vs Charges', hover_data=['sex'])\nfig.show()","c1d998fe":"print('Correlation between Age and charges =',medical_df.charges.corr(medical_df.age))","e1075081":"print('Correlation between BMI and charges =',medical_df.charges.corr(medical_df.bmi))","404a56cb":"print('Correlation between Children and charges =',medical_df.charges.corr(medical_df.children))","bc092c2c":"smoker_values = {'no':0, 'yes':1}\nsmoker_val = medical_df.smoker.map(smoker_values)\nprint('Correlation between Smoker and Charges = ', medical_df.charges.corr(smoker_val))","32183ad9":"sex_values = {'female':0, 'male':1}\nsex_val = medical_df.sex.map(sex_values)\nprint('Correlation between Sex and Charges = ', medical_df.charges.corr(sex_val))","faf40d02":"region_values = {'female':0, 'male':1}\nregion_val = medical_df.sex.map(region_values)\nprint('Correlation between Region and Charges = ', medical_df.charges.corr(sex_val))","425d5a1c":"medical_df.corr()  #other easy way","eb2e46c8":"sns.heatmap(medical_df.corr(), annot=True, cmap='Reds');\nplt.title('Correlation Matrix');","fde15fab":"non_smokers = medical_df[medical_df.smoker=='no']\nX = np.array(non_smokers['age'])\nX = X.reshape((-1,1))\nY = np.array(non_smokers['charges'])\nY = Y.reshape((-1,1))   #comment this for SGD regressor","bca0e5c1":"sns.scatterplot(data=non_smokers, x='age', y='charges', alpha=0.7, s=15);\nplt.title('Age Vs Charges (For Non-Smokers)');","3714914f":"model = LinearRegression()  \n#model = SGDRegressor()\nmodel.fit(X,Y)","02049b77":"Y_pred = model.predict(X)","201e8731":"print('Mean Squared Error =',math.sqrt(metrics.mean_squared_error(Y, Y_pred)))","7c889d14":"print('W =',model.coef_[0][0],'\\nb =',model.intercept_[0])\n#print('W =',model.coef_[0],'\\nb =',model.intercept_[0])  # for SGDRegressor","831bc13f":"sns.scatterplot(data =non_smokers, x='age', y='charges', alpha=0.7, s=15);\nplt.plot(non_smokers['age'], Y_pred, color='r')\nplt.title('Age Vs Charges (For Non-Smokers)');","e8838646":"smokers = medical_df[medical_df.smoker=='yes']\nX = np.array(smokers['age'])\nX = X.reshape((-1,1))\nY = np.array(smokers['charges'])\nY = Y.reshape((-1,1))   #comment this for SGD regressor","abecb9bb":"sns.scatterplot(data=smokers, x='age', y='charges', alpha=0.7, s=15);\nplt.title('Age Vs Charges (For Smokers)');","45dedb93":"model = LinearRegression()  \n#model = SGDRegressor()\nmodel.fit(X,Y)","0e4d3f98":"Y_pred = model.predict(X)","87e7b57f":"print('Mean Squared Error =',math.sqrt(metrics.mean_squared_error(Y, Y_pred)))","76655657":"print('W =',model.coef_[0][0],'\\nb =',model.intercept_[0])\n#print('W =',model.coef_[0],'\\nb =',model.intercept_[0])  # for SGDRegressor","e0f41215":"sns.scatterplot(data=smokers, x='age', y='charges', alpha=0.7, s=15);\nplt.plot(smokers['age'], Y_pred, color='r')\nplt.title('Age Vs Charges (Smokers)');","1fe50b8d":"non_smokers = medical_df[medical_df.smoker=='no']\nX = np.array(non_smokers[['age', 'bmi']])\nY = np.array(non_smokers['charges'])\nY = Y.reshape((-1,1))   #comment this for SGD regressor","e0980540":"model = LinearRegression().fit(X, Y)","7507d768":"Y_pred = model.predict(X)","14cb5db1":"print('Mean Squared Error =',math.sqrt(metrics.mean_squared_error(Y, Y_pred)))","3bd7f129":"print('Correlation Between BMI and Charges for Non-Smokers',medical_df.charges.corr(non_smokers['bmi']))","54aa3fff":"sns.scatterplot(data=non_smokers, x='bmi', y='charges', alpha=0.7, s=15);\nplt.title('BMI Vs Charges (For Non-Smokers)');","cebdfc7c":"print('W for Age =',model.coef_[0][0],'\\nW for BMI =',model.coef_[0][1],'\\nb =',model.intercept_[0])","d309dbe9":"fig = px.scatter_3d(non_smokers, x='age', y='bmi', z='charges')\nfig.update_traces(marker_size=3, marker_opacity=0.5)\nfig.show()","c4909d5e":"non_smokers = medical_df[medical_df.smoker=='no']\nX = np.array(non_smokers[['age', 'bmi', 'children']])\nY = np.array(non_smokers['charges'])\nY = Y.reshape((-1,1))   #comment this for SGD regressor","9b8054b9":"fig = px.strip(non_smokers, x='children', y='charges', title= \"Children vs. Charges\")\nfig.update_traces(marker_size=4, marker_opacity=0.7)\nfig.show()","54190498":"model = LinearRegression().fit(X, Y)","f02f8845":"Y_pred = model.predict(X)","79c32001":"print('Mean Squared Error =',math.sqrt(metrics.mean_squared_error(Y, Y_pred)))","c3391b81":"print('Correlation Between Children and Charges for Non-Smokers',non_smokers.charges.corr(non_smokers['children']))","a5f2a500":"print('W for Age =',model.coef_[0][0],'\\nW for BMI =',model.coef_[0][1],'\\nW for Children =',model.coef_[0][2],'\\nb =',model.intercept_[0])","c7822ce1":"X = np.array(medical_df[['age', 'bmi', 'children']])\nY = np.array(medical_df['charges'])\nY = Y.reshape((-1,1))   #comment this for SGD regressor","21359414":"model = LinearRegression().fit(X, Y)","78ed82b4":"Y_pred = model.predict(X)","22083d40":"print('Mean Squared Error =',math.sqrt(metrics.mean_squared_error(Y, Y_pred)))","0886824d":"px.scatter(medical_df, x='age', y='charges', color='smoker', title='Age Vs Charges')","2cd74d70":"smoker_codes = {'no':0, 'yes':1}\nmedical_df['smoker_codes'] = medical_df.smoker.map(smoker_codes)","b6bd5b31":"print('Correlation Between Smoker_codes and Charges =',medical_df.charges.corr(medical_df.smoker_codes))","a0127f4a":"X = np.array(medical_df[['age', 'bmi', 'children', 'smoker_codes']])\nY = np.array(medical_df['charges'])\nY = Y.reshape((-1,1))","1581f695":"model = LinearRegression().fit(X, Y)","7632578f":"Y_pred = model.predict(X)","7069b240":"print('Mean Squared Error =',math.sqrt(metrics.mean_squared_error(Y, Y_pred)))","0f4f1f5a":"sex_codes = {'female':0, 'male':1}\nmedical_df['sex_codes'] = medical_df.sex.map(sex_codes)","4f39755d":"print('Correlation Between Sex_Codes and Charges =',medical_df.charges.corr(medical_df.sex_codes))","44438415":"X = np.array(medical_df[['age', 'bmi', 'children', 'smoker_codes', 'sex_codes']])\nY = np.array(medical_df['charges'])\nY = Y.reshape((-1,1))","3bf71b57":"model = LinearRegression().fit(X, Y)","7521873e":"Y_pred = model.predict(X)","7ac3c60c":"print('Mean Squared Error =',math.sqrt(metrics.mean_squared_error(Y, Y_pred)))","8fc6d7a4":"encoder = preprocessing.OneHotEncoder()\nencoder.fit(medical_df[['region']])\nencoder.categories_","5fdaa9fc":"one_hot = encoder.transform(medical_df[['region']]).toarray()\nmedical_df[['northeast','northwest','southeast','southwest']] = one_hot","4674250c":"X = np.array(medical_df[['age', 'bmi', 'children', 'smoker_codes', 'sex_codes','northeast','northwest','southeast','southwest']])\nY = np.array(medical_df['charges'])\nY = Y.reshape((-1,1))","86ab1202":"model = LinearRegression().fit(X, Y)","3208b6b3":"Y_pred = model.predict(X)","d8723cdb":"print('Mean Squared Error =',math.sqrt(metrics.mean_squared_error(Y, Y_pred)))","9b703d4a":"non_smokers = medical_df[medical_df.smoker=='no']\nX = np.array(non_smokers[['age', 'bmi', 'children', 'smoker_codes', 'sex_codes','northeast','northwest','southeast','southwest']])\nY = np.array(non_smokers['charges'])\nY = Y.reshape((-1,1))","93f84282":"model = LinearRegression().fit(X, Y)\nY_pred = model.predict(X)\nprint('Mean Squared Error =',math.sqrt(metrics.mean_squared_error(Y, Y_pred)))","ee5e46e7":"smokers = medical_df[medical_df.smoker=='yes']\nX = np.array(smokers[['age', 'bmi', 'children', 'smoker_codes', 'sex_codes','northeast','northwest','southeast','southwest']])\nY = np.array(smokers['charges'])\nY = Y.reshape((-1,1))","f8997ad6":"model = LinearRegression().fit(X, Y)\nY_pred = model.predict(X)\nprint('Mean Squared Error =',math.sqrt(metrics.mean_squared_error(Y, Y_pred)))","f158fdfd":"numeric_cols = ['age', 'bmi', 'children']\nscaler = StandardScaler()\nscaler.fit(medical_df[numeric_cols])\nscaled_X = scaler.transform(medical_df[numeric_cols])\nscaled_X","62511c35":"cat_cols = ['smoker_codes', 'sex_codes', 'northeast', 'northwest', 'southeast', 'southwest']\ncategorical_data = medical_df[cat_cols].values\nX = np.concatenate((scaled_X, categorical_data), axis=1)\nY = medical_df.charges","c2779d52":"model = LinearRegression().fit(X, Y)","abcf62a0":"Y_pred = model.predict(X)","065c458a":"print('Mean Squared Error =',math.sqrt(metrics.mean_squared_error(Y, Y_pred)))","7ee0b729":"X_train, X_test, Y_train, Y_test = train_test_split(X, Y, test_size =0.2)","89cd2aa7":"model = LinearRegression().fit(X_train, Y_train)","b4adabec":"Y_train_pred = model.predict(X_train)\nY_test_pred = model.predict(X_test)","a6302202":"print('Mean Squared Training Error =',math.sqrt(metrics.mean_squared_error(Y_train, Y_train_pred)))\nprint('Mean Squared Testing Error =',math.sqrt(metrics.mean_squared_error(Y_test, Y_test_pred)))","d520f99e":"#### Correlation Between Children And Charges For Non-Smokers","5b0b8e61":"#### Fitting Model","ea1c645d":"#### Fitting Model","284431a3":"### 9) Scatterplot : Sex - Charges","70eddbca":"#### Predict","73840730":"20% smokers; 80% non-smokers<br><br>\n159 male smokers; 115 female smokers(total = 274)<br>\n58% male smokers; 42% female smokers<br><br>\n517 male non-smokers; 547 female non-smokers (total = 1064)<br>\n51% male non-smokers; 49% female non-smokers<br>","452e96e5":"#### Error Prediction\n\nDue to outliers such error","11d6caca":"#### Predict","be789216":"Adding categorical value (smoker_codes) is like adding penalty for smokers <br>i.e, weight becomes 1 for a smoker and 0 for non-smoker which increases cost for a smoker.\n\n$charges = w_1 \\times age + w_2 \\times bmi + w_3 \\times charges + w_4 \\times smoker + w_5 \\times sex + b$\n\n<b>Note:<\/b> Smoking does not add any effect to other weights.<br>\n\nSo we have two options to decide as a data scientist:<br>\n    1) Use Single Linear Regression Model<br>\n    2) Use Two separate Linear Regression Models for Smokers and Non-Smokers respectively <br>\n    and to choose which gives the least error.\n<br><br>Errors can be compared by comparing error of the single regression model (Option 1) with average of the two models' errors (Option 2)","f2f60c0f":"#### Extract Age and Charges from Dataset","edb3e132":"## Correlation\n\n### Strength\n    0       : No Correlation<br>\n    1 or -1 : Perfect Linear Relation\n    \n### Direction\n    + : When a variable increases other variable also increases (Vice Versa)\n    - : When a variable increases other variable decreases (Vice Versa)","7e72efab":"# 3) Linear Regression - Multiple Features\n### 1) Age and BMI Vs Charges For Non-Smokers\n#### Extract Age, BMI and Charges from Dataset","ea627b5d":"First 50% of male and female charged almost same probably the younger aged people","555f6a7b":"### 6) Smoker","eca53af6":"#### Train","4223aff9":"#### Error","55c68246":"# 1) Data Analysis\n## Dataset Summary\nTotal entries(samples) = 1338 non null ocunt is 1338 i.e,no null values in dataset","57dc4e35":"#### Predict","0408931d":"### 1) Numeric Values","9d3258df":"### 2) BMI variable","febef2dd":"#### Predict","ec7942cc":"#### Train","7f87c340":"#### Parameters","1ec9cecd":"#### Extract Age, BMI, Children, Smoker_codes and Charges from Dataset","1a8428a6":"### Result & Conclusion\nError (with smoker_codes + sex_codes) = 6056.100708754546<br>\nError (with smoker_codes + sex_codes + regions) = 6041.679651174452\n\nSince error is not significantly reduced, regions are also not a needed parameter","ed602193":"#### Error Reduced When Parameter BMI is included (Not Significant)\nError (Age) = 4662.505766636395 <br>\nError (Age + BMI) = 4662.3128354612945\n\nError reduced is very less because,<br>\nCorrelation Between BMI and Charges = 0.08403654312833271 (For Non-Smokers)\n\nAlso for non_smokers, W and B for Age Vs Charges:<br>\nW = 267.2489128311997 <br>\nb = -2091.4205565650864<br>\n\nwhich is almost same as<br>\n\nW[0] and B for Age, BMI Vs Charges:<br>\nW for Age = 266.876578165998<br>\nb = -2293.6320906488727<br>\n\nThe graph also does not show any linear relation between BMI and charges\n\n#### Result\nThere is no relationship between BMI and Charges.\nSo no matter how the dataset, what model to use can't predict charges with BMI","77397f78":"#### Error Prediction","acfc08a4":"### 2) Age, BMI and Children Vs Charges For Non-Smokers\n#### Extract Age, BMI, Children and Charges from Dataset","581ef4f7":"### 4) Charges - Sex","8e97a820":"#### Predict","3c9fa401":"### 1) Age Vs Charges For Smokers","a851ee96":"#### <u>Analysis<\/u>\n\n    1) For most of the smokers, charges are between 10K to 50K\n    2) For most of the Non-smokers, charges are between 0K to 16K","baf68396":"#### <u>Analysis<\/u>\n    For same population of male and female,\n    1) More amount of male are charged negative than female (practically not charged).\n    2) More amount of female are charged between 0K to 10K than male.\n    3) More amount of male are charged above 30K than female.\n    ","769512d1":"### 3) Charges - Smoker","18f0e682":"### Result & Conclusion\nError is not reduced in linear regression.<br>\nBut the predicted weights are as follows,\n<img src=\"https:\/\/raw.githubusercontent.com\/avinash-218\/Annual-Medical-Expenditure-Prediction\/main\/image2.png\">\nNow this is making sense to our previous results.","2d485c0b":"#### Visualise Regression Line","75aa3636":"#### Visualize","3f084f5b":"#### Fitting Model\n\nsklearn.linear_model.LinearRegression uses <b>'Ordinary Least Squares'<\/b> optimization","532833a6":"#### Predict","dcf7eea4":"Error Reduced When Parameter BMI is included (Not Significant)<br>\nError (Age) = 4662.505766636395<br>\nError (Age + BMI) = 4662.3128354612945<br>\nError (Age + BMI + Children) = 4608.470405038247<br>\n\nError reduced is very less because,\nCorrelation Between Children and Charges = 0.13892870453542205 (For Non-Smokers)\n\n###### W and B for Age Vs Charges:\nW = 267.2489128311997\nb = -2091.4205565650864\n\n###### W and B for Age, BMI Vs Charges:\nW for Age = 266.876578165998 \nW for BMI = 7.075476658142241 \nb = -2293.6320906488727\n\n###### W and B for Age, BMI,Children Vs Charges:\nW for Age = 265.29384429763684 \nW for BMI = 5.2795631320416305 \nW for Children = 580.659650525571 \nb = -2809.297603223591\n\n\n###### Result\nThere is no relationship between Children and Charges. So no matter how the dataset, what model to use can't predict charges with Children","a470aed0":"# Load dataset","06f62ffe":"### Result & Conclusion\nError (without smoker_codes) = 11355.317901125973<br>\nError (with smoker_codes) = 6056.439217188081","94afef2b":"# 2) Linear Regression - Single Feature\n### 1) Age Vs Charges For Non-Smokers","281b1221":"#### Predict","cd7e152a":"Non smokers (green) are more in number<br>\nNon smokers charged less (but some non smokers are also have more charge)<br>\nSmokers (red) are less in number<br>\nAll smokers charged more (above 12K) - from the data only (not as a rule)<br><br>\nDoesn't mean all smokers WILL be charged more since there is a possibility number of smokers > number of non-smokers<br>\nHave taken life insurance so that more smokers fall the higher side or smokers are older so charged more<br>","249e4fed":"## 1) Non-Smokers","db9ea361":"# 5) Separate Linear Regression For Smokers and Non-Smokers ?","a7cb3287":"#### Error","c843ef88":"### 11) Scatterplot : Regions - Charges","7a8d999d":"## Dataset Statistics","2348953f":"### 12) Scatterplot : Smoking - Charges","ab9a6140":"Looks like normal or gaussian distribution with mean 30 i.e, average BMI is around 30 (overweight t obese)\n<br><br>\nBMI < 18.5             : underweight<br>\nBMI 18.5-24.9          : normal weight<br>\nBMI 25-29.9            : overweight<br>\nBMI 30-39.9            : obesity<br>\nBMI > 40               : morbid obesity","dc57aa0c":"### 2) Categorical Values","ec60e053":"#### <u>Analysis<\/u>\n\nSmokers - Red\n<br>\nNon-Smokers - Blue\n\n    1) Three Clusters each with increasing slope means charges increase with age\n    2) Top cluster - Entirely Smokers\n    3) Bottom cluster - Entirely Non-smokers\n    4) Middle Cluster - Mix of Smokers and Non-Smokers\n    5) Most non-smokers are charged less: \n        For age 0-30 : <5K\n        For age >60  : Around 15K\n    6) Some non-smokers probably due to accident like unexpected events charged more\n    7) Some smokers are charged 10K to 30K\n    8) Some smokers are charged 30K to 50K (probably due to smoking and obese or they are heavy smokers etc...)","d63ad266":"#### Train","2652630c":"## 2) One-Hot Encoding\n\n![](https:\/\/i.imgur.com\/n8GuiOO.png)\n\n### Encoding Regions","f48dcd30":"Eastern part people are charged more (north-eastern and south-eastern)","2805dd7d":"#### Parameters","754fe009":"#### <u>Analysis<\/u>\n\n    As number of children increases charges increases very slightly","7b339a38":"### 10) Scatterplot : Number Of Children - Charges","bc8b205c":"### 2) Age, BMI and Children Vs Charges For All (Smokers and Non-Smokers)\n#### Extract Age, BMI, Children and Charges from Dataset","b2ebe96d":"#### Train","3cd5833b":"#### Extract Age and Charges from Dataset","181cd3d0":"### 1) Age variable","35fb6e08":"### Result & Conclusions\nError of the Single Linear Regression Model = 6041.679651174452<br>\nAverage Error of the Two Linear Regression Models = $(5668.4678821121515 + 4573.074988795492)\/2 =5120.771435453822$\n\nTherefore, it is good to use two separate linear regression models (for smokers and non-smokers separately).\n\n<b>Note : BMI made a big difference for smoker but not for non-smokers<\/b>","23dcdd4c":"### 8) Scatterplot : BMI - Charges","65c0cbda":"# 7) Creating Test Data\n\nSplitting 20% of Data as  Test Data","fc954511":"#### Visualise Regression Line","12a0d4f2":"#### Error","165c401c":"## 2) Smokers","2d277ccd":"#### Predict","90487857":"#### Error Prediction\n\nDue to outliers such error","a3c3625c":"Each of the age have around 25-30 customers (except 18, 19 which are twice)<br>\nAge distribution is uniform except for age 18, 19<br>\nFor ages 18, 19 more customers are present(twice). This might be due to lower premium for such ages","ccabb5b4":"#### Extract Age, BMI, Children, Smoker_codes, Sex_codes and Charges from Dataset","ccece458":"#### Error","c4e70438":"# 4) Using Categorical Features\n## 1) Binary Encoding\n### a)  Smoker_Codes","cb29d127":"#### Extract Age, BMI, Children, Smoker_codes, Sex_codes,Regions and Charges from Dataset","a31d415d":"#### Why High Error ?\nSince out of Age, BMI, Children <b>Only Age is Linearly Dependent on charges.<\/b>\nAnd from the scatter plot of 'Age Vs Charges'<br> shows two collection - Smokers and Non-Smokers\nwhich are separated far from each other which is the reason for the high error.","b6d52664":"#### Conclusion\nSince smoker increases the error (which is a categorical value), so smoker (may be other categorical values too)<br> is also to be included in the model.","7730b347":"### Correlation Vs Causation\n\n<b>Correlation<\/b> is a statistical technique which tells us how strongly the pair of variables are linearly related and change together. It does not tell us why and how behind the relationship but it <b>just says the relationship exists.<\/b><br>\n\n<b>Causation<\/b> takes a step further than correlation. It says any change in the value of one variable will cause a change in the value of another variable, which means <b>one variable makes other to happen<\/b>.\n\nExample: When a person is exercising then the amount of calories burning goes up every minute. Former is causing latter to happen.<br>\n\nSo <b>\u201cCorrelation does not imply causation!\u201d<\/b>","b1e6af16":"#### Result\nAge and charges grow together<br>\nBMI and charges don't","2e355af7":"#### Error","4952d1a1":"### 5) Charges - Regions","193711bf":"#### <u>Analysis<\/u>\n\nSmokers - Red\n<br>\nNon-Smokers - Blue\n\n    1) Non-smokers are mostly charged < 13K (even for BMI >50)\n    2) Smoking is more injurious than being obese because even non-smoker obese people are charged less\n       while smoking normal weighed people are charge more.\n    3) For non-smokers, no relation between BMI and Charges\n    4) For smokers, there are two clusters\n        i)  BMI < 30 are charged below 30K\n        ii) BMI >30 are charge above 30K","15303403":"#### Parameters","7084f665":"<img src=\"https:\/\/i.imgur.com\/3XUpDlw.png\" width=\"360\">\n\nThe correlation coefficient has the following formula:\n\n<img src=\"https:\/\/i.imgur.com\/unapugP.png\" width=\"360\">","a2fbdc73":"#### Train","2e448e8a":"#### Error","f01c737e":"#### Train","de8a1c68":"#### Train","0a70949a":"### Scaling Non-Categorical Values","83bc986b":"### Result & Conclusion\nError (with smoker_codes) = 6056.439217188081<br>\nError (with smoker_codes + sex_codes) = 6056.100708754546\n\nSince error is not significantly reduced, Sex is not a needed parameter","9f359685":"#### Error","e3122aff":"#### 3D Visualisation","ad385b87":"#### Visualize","40f1d21f":"## Change Styles of Visualisation","a8ed440a":"# Importing Libraries","43c50a4d":"#### Correlation Between BMI and Charges For Non-Smokers","ef83d51f":"#### Predict","34c70f87":"### 7) Scatterplot : Age - Charges","1340b104":"#### Predict","fca07f9e":"# 6) Model Improvements\n## a) Feature Scaling\nWhy feature scaling ?<br>\nSuppose we want to predict a particular sample as [28, 30, 2, 1, 0, 0, 1, 0, 0]<br>\nThe predicted weights are as follows,<br>\n<img src=\"https:\/\/raw.githubusercontent.com\/avinash-218\/Annual-Medical-Expenditure-Prediction\/main\/image1.png\">\n<br><b>Note : <\/b>1 - Bias\n\n<br>While it seems like BMI and the \"northeast\" have a higher weight than age which contradicts to our previous results & solutions.<br>\n<b>Note :<\/b> The range of values for BMI is limited (15 to 40) and the \"northeast\" column only takes the values 0 and 1.\n\n<br>Because different columns have different ranges, we run into two issues:\n\n    1) We can't compare the weights of different column to identify which features are important\n    2) A column with a larger range of inputs may disproportionately affect the loss and dominate the optimization process.\nFor this reason, it's common practice to scale (or standardize) the values in numeric column by subtracting the mean and dividing by the standard deviation.\n![](https:\/\/i.imgur.com\/dT5fLFI.png)\n\n<b> Note :<\/b> It is not needed to scale categorical values since they are already scaled between [0,1]","e833bb06":"### b) Sex_Codes"}}