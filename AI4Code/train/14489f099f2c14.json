{"cell_type":{"623541c5":"code","c438e7bc":"code","f807f00d":"code","c07c49a0":"code","fc67ae84":"code","306c506b":"code","a170ba3d":"code","53e5350a":"code","d1f24ae4":"markdown","2344e96d":"markdown","330f43e9":"markdown","bc276d8e":"markdown","d4106b1a":"markdown","e170b698":"markdown","a48f9673":"markdown","6437856c":"markdown"},"source":{"623541c5":"df = pd.read_csv(filepath)\ndf","c438e7bc":"target_col = 'col'\nprint(df[target_col].unique())\nprint('-----------------------')\nprint(df[target_col].value_counts())\nprint('-----------------------')\nprint(df.dtypes)\nprint('-----------------------')\nprint(df.isna().sum())","f807f00d":"y = df[target_col]\nX = df.drop(columns=[target_col])\nfrom sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y)\n","c07c49a0":"para = list(range(100, 601, 100))\nprint(para)","fc67ae84":"from sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import classification_report, accuracy_score, f1_score\nresults = {}\nfor n in para:\n    print('para=', n)\n    model = RandomForestClassifier(n_estimators=n)\n    model.fit(X_train, y_train)\n    preds = model.predict(X_test)\n    accu = accuracy_score(y_true=y_test, y_pred=preds)\n    f1 = f1_score(y_true=y_test, y_pred=preds, average='micro')\n    print(classification_report(y_true=y_test, y_pred=preds))\n    print('--------------------------')\n    results[n] = f1","306c506b":"import matplotlib.pylab as plt\n# sorted by key, return a list of tuples\nlists = sorted(results.items()) \np, a = zip(*lists) # unpack a list of pairs into two tuples\nplt.plot(p, a)\nplt.show()","a170ba3d":"best_para = max(results, key=results.get)\nprint('best para', best_para)\nprint('value', results[best_para])\n\n\n","53e5350a":"sub_df.to_csv('sub.csv', index=False)","d1f24ae4":"# prepare X, y and split data ","2344e96d":"# show results ","330f43e9":"# Hyperparameter range ","bc276d8e":"# discover your data \n## define target \n## checking missing values, and value counts ","d4106b1a":"# write predcitions ","e170b698":"# select best parameters ","a48f9673":"# build model + parameter tuning ","6437856c":"# load your data "}}