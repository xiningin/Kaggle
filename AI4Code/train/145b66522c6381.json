{"cell_type":{"88241c5c":"code","095a8d19":"code","c54b0dbd":"code","62eb8209":"code","623fdd7a":"code","3dc76e26":"code","9864de58":"code","2e72d321":"code","0706a6a5":"code","69e2073b":"code","3ae45120":"code","cdae051a":"code","00b0c0ab":"code","ca24c18e":"code","8bcf30ef":"code","8a39db96":"code","59f2936f":"code","2d17e5d8":"code","844fc02e":"code","620b08c2":"code","9028bde9":"code","fa8bc5eb":"code","dc0d3522":"code","784aefb2":"code","931ef349":"code","0be04e97":"code","4f78cb20":"code","ae79fd2b":"code","96792f5e":"markdown","dc26141c":"markdown","30b11968":"markdown","039c07fa":"markdown"},"source":{"88241c5c":"!pip install tensorflow==2.1","095a8d19":"!pip install transformers","c54b0dbd":"from transformers import pipeline","62eb8209":"summarizer = pipeline(\"summarization\", model=\"t5-base\", tokenizer=\"t5-base\", framework=\"tf\") # T5 (Text-To-Text Transfer Transformer) 's summarizer function\n\nsummarizer(\"Sam Shleifer writes the best docstring examples in the whole world.\", min_length=5, max_length=10)","623fdd7a":"# directory = 'C:\/Users\/N1110\/Desktop\/CORD19\/march30KeywordSearchQ1\/'\n# df = pd.read_csv(directory + 'mostRelatedQ1POLYMERASEabstract.csv')  #20 paper abstracts of size 300 on average","3dc76e26":"abs1=\"ltpgtltbgtltbgt there is no specific drug that has been approved for 2019ncov there are a number of factors that pose major challenges in their development approaches to the development of anti2019ncov include screening existing broadspectrum antiviral drugs repositioning of readily available clinical compounds and ltitalicgtde novoltitalicgt development of novel and specific agents for 2019ncov candidate compounds can be developed either to inhibit virusbased targets such as rna proteases polymerase spike glycoproteins and viral envelop and membrane proteins or to inhibit hostbased targets such as receptors and proteases that are utilized by virus for viral entry and endocytosis recently the rna polymerase remdesivir had demonstrated clinical efficacy in one patient with severe novel coronavirus pneumonia ncp the broadspectrum viral protease inhibitor kaletraltsupgtregltsupgt is also recommended in the current ncp clinical practice both drugs had lately been proceeded into multiple controlled phase iii clinical trials to test their safety and efficacy in ncp combinational therapies consisting of multiple drugs provide other viable options against 2019ncov based on scientific and clinical rationales using bioinformatics and database analysis we have identified 75 clinically compounds including 20 marketed compounds that are efficacious in inhibiting key targets in virus and hostbased approaches which may facilitate the development of new therapeutic options for 2019ncov ltpgt\"","9864de58":"summarizer(abs1, min_length=50, max_length=100) # 300 words summary run for so long?","2e72d321":"# original 208 words; summary 67 words\n\n","0706a6a5":"summarizer(abs1, min_length=20, max_length=50)","69e2073b":"#even short summary 37 words and still valid\n# so start to apply summarizer on the Question Answering Outputs (20 paper abstracts of size 300 on average)","3ae45120":"import numpy as np\nimport pandas as pd","cdae051a":"data_path = \"\/content\/drive\/My Drive\/Colab Notebooks\/cord19\/data\/\"\ndata_filename = data_path +\"mostRelatedQ1POLYMERASEabstract.csv\"\nprint(data_filename)","00b0c0ab":"# allow access to google drive files\nfrom google.colab import drive\ndrive.mount('\/content\/drive')","ca24c18e":"df = pd.read_csv(data_filename)\ndf.head(5)","8bcf30ef":"df.shape[0]","8a39db96":"df.ABS[0]","59f2936f":"abs=[]\n\n","2d17e5d8":"for i in range(df.shape[0]):\n  abs.append(df.ABS[i])\n  print(\"Summary for \" + str(i)+\"th Abstract is:\")\n  print(summarizer(abs[i], min_length=20, max_length=50))\n  ","844fc02e":"for i in range(df.shape[0]):\n  abs.append(df.ABS[i])\n  print(\"Summary for \" + str(i)+\"th Abstract is:\")\n  #print(summarizer(abs[i], min_length=20, max_length=50))\n  df[\"index\"].iloc[i]= str(summarizer(abs[i], min_length=20, max_length=50)[0].values()) #df[\"index\"].iloc[0]= str(summary0[0].values())\n  print(df[\"index\"].iloc[i]) #index should be named \"summary\"","620b08c2":"type(summarizer(abs1, min_length=20, max_length=50))","9028bde9":"summary0= summarizer(abs[0], min_length=20, max_length=50)\n\n","fa8bc5eb":"# summary0.values()\n\nsummary0","dc0d3522":"summary0[0].values()","784aefb2":"df[\"index\"].iloc[0]= str(summary0[0].values())\n","931ef349":"df[\"index\"]","0be04e97":"ABSsummary = ' '.join(df[\"index\"])","4f78cb20":"ABSsummary","ae79fd2b":"# put all the summaries of 20 paper abstracts together to generate a 600-1000 words summary\n\n# in this way we let T5 help us read the 20 abstracts output\n# further generate word cloud for ABSsummary to viz info","96792f5e":"## T5 validation of Question Answering Outputs\n\n#### T5 (Text-To-Text Transfer Transformer) \u2018s summarizer function helped me read the 20 abstracts output form my Question Answering system (see the last post about my Kaggle submission). The results are exciting!\n\nAs we got 20 most related papers to the question as shown in *Part 4 Identify similar papers based cosine similarity* in the link below, I used T5 to help me read these 20 abstracts.\n\nhttps:\/\/www.kaggle.com\/leijiang1\/part-4-identify-similar-papers-based-on-cossim#Example-of-Question-Answering-system\n\n\nFor my original question \n### \u201cWhat are clinical effective therapeutics or drugs for COVID-19?\u201d, \nT5 generated a about 800 words summary when join all the above output strings together. The last sentence \u201c\u2018biocentury lists some of the drugs that are being developed for the coronavirus epidemic . remdesivir from gilead is one of the most advanced rna virus therapies . covid19\u2032\u201d point out \n### \u201cremdesivir from gilead is one of the most advanced rna virus therapies\u201c! \nwhich is exactly answering my specific question! I am excited about the results!\n\n\n### The workflow I used and methods used at each step:\n\n![image.png](attachment:image.png)\n\n(you can also use Recursive Keyword Window Search to retrieve any information of your interest)\n\n\n\n## Colab for the code\nhttps:\/\/colab.research.google.com\/github\/lj89\/CORD19\/blob\/master\/T5_validation_of_Question_Answering_Outputs.ipynb\n\n\n\n## Results\nThe results are attached below.\nNot sure why the first two input repeated. I\u2019ll debug my code. (I will post a colab of the code on my github, maybe you can help me debug). But the results are amazing! \n\nSummary for 0th Abstract is:\n\n[{\u2018summary_text\u2019: \u2018there is no specific drug that has been approved for 2019ncov there are a number of factors that pose major challenges in their development approaches to the development of anti2019ncov . screening existing broadspectrum antiviral drugs re\u2019}]\n\nSummary for 1th Abstract is:\n\n[{\u2018summary_text\u2019: \u2018limited data is available on feline leishmaniosis fel caused by leishmania infantum . leishvet group presents in this report a review of the current knowledge on fel the epidemiological role of the cat\u2019}]\n\nSummary for 2th Abstract is:\n\n[{\u2018summary_text\u2019: \u2018there is no specific drug that has been approved for 2019ncov there are a number of factors that pose major challenges in their development approaches to the development of anti2019ncov . screening existing broadspectrum antiviral drugs re\u2019}]\n\nSummary for 3th Abstract is:\n\n[{\u2018summary_text\u2019: \u2018limited data is available on feline leishmaniosis fel caused by leishmania infantum . leishvet group presents in this report a review of the current knowledge on fel the epidemiological role of the cat\u2019}]\n\nSummary for 4th Abstract is:\n\n[{\u2018summary_text\u2019: \u2018antiviral drugs continue to be an important option for the treatment of influenza disease and will likely be the only option during the early phases of pandemic . however the limited number of drug classes licensed for treatment raises several issues particularly in\u2019}]\n\nSummary for 5th Abstract is:\n\n[{\u2018summary_text\u2019: \u2018background rapid molecular methods have created new opportunities for the clinical microbiology laboratory to affect patient care in the areas of initial diagnosis and therapy rapid diagnostic tests provide collaborative opportunities for antimicrobial stewardship teams ast to improve patient\u2019}]\n\nSummary for 6th Abstract is:\n\n[{\u2018summary_text\u2019: \u2018the differentiation of viral from bacterial pneumonia is important in determining whether antibiotics are appropriate for treatment of these infections advances in diagnostic technologies such as respiratory panels rp may aid in this differentiation however some studies have shown limited impact for this purpose\u2019}]\n\nSummary for 7th Abstract is:\n\n[{\u2018summary_text\u2019: \u2018the arsenal of antivirals is complex as of march 2014 it consists of approximately 50 drugs approved by the fda approximately half of which are directed against hiv antiviral drug creation strategies focus on two different approaches targeting the viruses\u2019}]\n\nSummary for 8th Abstract is:\n\n[{\u2018summary_text\u2019: \u2018we developed a datadriven drug repositioning framework which applies both machine learning and statistical analysis approaches to systematically integrate and mine largescale knowledge graph literature and transcriptome data to discover the potential drug candidates against sarscov2\u2019}]\n\nSummary for 9th Abstract is:\n\n[{\u2018summary_text\u2019: \u2018in this study 26 blood samples were collected from 25 healthy cats and one cat with clinical signs suggestive of feline infectious peritonitis fip namely fever weight loss enlarged abdomen and ascites . the high rate of\u2019}]\n\nSummary for 10th Abstract is:\n\n[{\u2018summary_text\u2019: \u2018the current available antiviral drugs target 3 main groups of viruses herpes hepatitis and influenza viruses with the exception of the antisense molecule fomivirsen all antiherpes drugs inhibit viral replication\u2019}]\n\nSummary for 11th Abstract is:\n\n[{\u2018summary_text\u2019: \u2018a 2019ncov related pangolin coronavirus gxp2vpangolin2017 guangxi was described . a library of 2406 clinically approved drugs were screened for their ability to\u2019}]\n\nSummary for 12th Abstract is:\n\n[{\u2018summary_text\u2019: \u2018abstract since the last handbook of clinical neurology volume on this topic viral diagnosis has made tremendous strides moving from the margin to the mainstream of clinical care for many years conventional virus isolation was the mainstay of viral diagnosis since it was sensitive and\u2019}]\n\nSummary for 13th Abstract is:\n\n[{\u2018summary_text\u2019: \u2018zika fever is a mosquitoborne infectious disease caused by zika virus zikv is an epidemic disease for which no effective therapy has been established . outbreaks of zika in brazil and french polynesia have been\u2019}]\n\nSummary for 14th Abstract is:\n\n[{\u2018summary_text\u2019: \u2018a positive rvp n 127 63 was associated with a more complicated clinical course . this was due largely to more severe disease seen in younger children . those with respiratory syncytial virus \u2018}]\n\nSummary for 15th Abstract is:\n\n[{\u2018summary_text\u2019: \u2018there has been a wealth of promising clinical data suggesting that a more effective treatment regimen and potentially a cure for hepatitis c virus hcv infection is close at hand . direct acting antivirals da\u2019}]\n\nSummary for 16th Abstract is:\n\n[{\u2018summary_text\u2019: \u2018nitazoxanide ntz may be beneficial for treating acute respiratory viral illness methods from march 2014 through march 2017 a doubleblind placebocontrolled trial was conducted in 260 participants 1 year old hospitalized with influenzalike illness at\u2019}]\n\nSummary for 17th Abstract is:\n\n[{\u2018summary_text\u2019: \u2018abstract bovine respirovirus 3 also known as bovine parainfluenza virus type 3 bpiv3 rapid diagnosis could contribute greatly in containing epidemics and thus avoid economic losses . the lack of robust isother\u2019}]\n\nSummary for 18th Abstract is:\n\n[{\u2018summary_text\u2019: \u2018up to 25 of patients with profound neutropenia lasting for 10 days develop lung infiltrates which rarely respond to broadspectrum antibacterial therapy . a causative pathogen remains undetected in the majority of\u2019}]\n\nSummary for 19th Abstract is:\n\n[{\u2018summary_text\u2019: \u2018biocentury lists some of the drugs that are being developed for the coronavirus epidemic . remdesivir from gilead is one of the most advanced rna virus therapies . covid19\u2019}]","dc26141c":"### code from colab attached below","30b11968":"## Discussion for Part 4\n\nI don't want to rerun the code for the ouput for Part 4, so I add some discssuion for that part here. \n\n### Reflection on my choices of optimization\n### matrix operation\n\nmy method used matrix operation which is much faster than for loop.\n\nresult = np.sum(NParray1941papers512vector*test1,axis=1)\/(np.sqrt(np.sum(NParray1941papers512vector*NParray1941papers512vector,axis=1))*np.sqrt(np.sum(test1*test1)))\n\nI also see in some disscussion that np and scipy could be slow to compute, may try faiss to improve to performance.\n\n\n### choice of model\n> The best model might not be the most useful.\n\n> \"It's not a matter of which is the BEST model, but whether it is this the BEST choice to solve MY problem.\"\n\ncited from the article *When Not to Choose the Best NLP Model*.\n\n\nI happened to see this last year's article today after I done project with USE. I had similar concerns when making the decsions on model choice but I did not explain as clear as in the above post. This article suggested USE is better for identifying the similarity between pairs of sentences.\n\n\"Why are they better suited to these tasks? The USE is trained on a number of tasks but one of the main tasks is to identify the similarity between pairs of sentences. The authors note that the task was to identify \u201csemantic textual similarity (STS) between sentence pairs scored by Pearson correlation with human judgments\u201d. This would help explain why the USE is better at the similarity task.\"\n\nAnd the reason I put ELMo in lower priority to try? The abstracts are \"long sentences\". ELMO struggles with context-dependency on larger sentences. \n\n\"ELMo was trained to generate embeddings of words based on the context they were used in, so it solved both of these problems in one go. ELMo does compare favorably with the USE as a model that could be used for sentence similarity. Since it does not use the transformer architecture, however, it struggles with context-dependency on larger sentences. This is the advantage of any model using the transformer architecture over the RNN\/LSTM approach\"\n\nFrom my readings from papers and blogs, BERT is said to be quite slow in this use case (we have lightweighted ALBERT now, worth trying). Also, BERT works best for Masked language model  or Next sentence prediction instead of sentence similarity task.  \n\nSciBERT dimension 768. I think it would not be faster than BERT but may pad with less (unknown) *<Unknown>* for scientific terms.\n\nXLNet said to have good performance in classification problems, but not so good embeddings for unsupervised tasks. \n\n\n\nAnother paper compared these methods:\n*BERT, ELMo, USE and InferSentSentence Encoders: The Panacea forResearch-Paper Recommendation?*\nthey choose BM25-base over bert etc...\n\n\n\nDue to the time budget and the limited computational resources, there are so many methods I did not get a chance to try. I definitely would like to try more in future.\n\n\n","039c07fa":"## Code"}}