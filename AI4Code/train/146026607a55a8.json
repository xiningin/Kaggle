{"cell_type":{"82c7eae1":"code","f65e49f4":"code","bd56297d":"code","5a907449":"code","96d7803f":"code","742fa637":"code","9fc1f1f4":"code","88f30abd":"markdown","879df02d":"markdown","6447b216":"markdown","35bc2ec3":"markdown","c55623cb":"markdown","a03da472":"markdown","4bf68695":"markdown"},"source":{"82c7eae1":"import pandas as pd\n\nnews_df = pd.read_csv(\"..\/input\/uci-news-aggregator.csv\", sep = \",\")\n# news_df.CATEGORY.unique()","f65e49f4":"import string\n\nnews_df['CATEGORY'] = news_df.CATEGORY.map({ 'b': 1, 't': 2, 'e': 3, 'm': 4 })\nnews_df['TITLE'] = news_df.TITLE.map(\n    lambda x: x.lower().translate(str.maketrans('','', string.punctuation))\n)\n\nnews_df.head()","bd56297d":"from sklearn.model_selection import train_test_split\n\nX_train, X_test, y_train, y_test = train_test_split(\n    news_df['TITLE'], news_df['CATEGORY'],random_state = 1)\n\nprint(\"Training dataset: \", X_train.shape[0])\nprint(\"Test dataset: \", X_test.shape[0])","5a907449":"from sklearn.feature_extraction.text import CountVectorizer\n\ncount_vector = CountVectorizer(stop_words = 'english')\ntraining_data = count_vector.fit_transform(X_train)\ntesting_data = count_vector.transform(X_test)","96d7803f":"from sklearn.naive_bayes import MultinomialNB\n\nnaive_bayes = MultinomialNB()\nnaive_bayes.fit(training_data, y_train)","742fa637":"predictions = naive_bayes.predict(testing_data)\npredictions","9fc1f1f4":"from sklearn.metrics import accuracy_score, recall_score, precision_score, f1_score\n\nprint(\"Accuracy score: \", accuracy_score(y_test, predictions))\nprint(\"Recall score: \", recall_score(y_test, predictions, average = 'weighted'))\nprint(\"Precision score: \", precision_score(y_test, predictions, average = 'weighted'))\nprint(\"F1 score: \", f1_score(y_test, predictions, average = 'weighted'))","88f30abd":"### 5. Train Multinomial Naive Bayes classifier","879df02d":"### 7. Evaluate model performance\n* This is a multi-class classification. So, for these evaulation scores, explicitly specify `average` = `weighted`","6447b216":"### 2. Preprocess data\n* Transform categories into discrete numerical values;\n* Transform all words to lowercase;\n* Remove all punctuations.","35bc2ec3":"## NEWS ARTICLE CLASSIFICATION\n\n### 1. Load data\n* Records in the file are comma delimited;\n* Column titles are included in the text file;\n* Load the data into a Pandas data frame;\n* View unique values for the `category` column for later transformation to discrete numerical values.","c55623cb":"### 6. Generate predictions","a03da472":"### 3. Split into train and test data sets","4bf68695":"### 4. Extract features\n* Apply bag of words processing to the dataset"}}