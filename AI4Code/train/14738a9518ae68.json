{"cell_type":{"8764c661":"code","7b91267f":"code","588d88e3":"code","6cf9b3f1":"code","392989a4":"code","706a6f22":"code","049b2641":"code","e3f87b61":"code","b7476900":"code","1246e26b":"code","76120579":"code","d3d7f619":"code","949b24eb":"code","75505712":"code","223588a8":"code","64ebdca2":"code","b708d384":"code","2110b9d4":"code","36413f4b":"markdown","c2f508ea":"markdown","318b03c4":"markdown","dc76b2b5":"markdown","8ab59960":"markdown","20506239":"markdown","8f85f420":"markdown"},"source":{"8764c661":"#Get tools\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom scipy.stats import f_oneway\nimport sklearn\nimport datetime","7b91267f":"#Get data\nstore_df=pd.read_csv('..\/input\/store.csv')\ntrain_df=pd.read_csv('..\/input\/train.csv',parse_dates=True,low_memory=False,index_col='Date')","588d88e3":"#Allow for data extraction\ntrain_df['Year']=train_df.index.year\ntrain_df['Month']=train_df.index.month\ntrain_df['Week']=train_df.index.week\ntrain_df['Day']=train_df.index.weekday_name\n\n#Sales per customer helps retailers monitor\n#the average purchase basket\ntrain_df['SalesperCustomer']=train_df['Sales']\/train_df['Customers']\n\n#Concatenate store data with training data\n#for extra information on stores\ntrain_store=pd.merge(train_df,store_df,how='inner',on='Store')\n\ntrain_store.head()\n\n","6cf9b3f1":"#There are 4 store types and 3 merchandise\n#assortment types: a - basic; b - extra;\n#c - extended.  They are distributed as\n#follows.\nstore_df.groupby(['StoreType','Assortment']).Assortment.count()","392989a4":"store_open=train_store[(train_store.Open==1)]\n\nsaledaystype=store_open.groupby(['StoreType','Day']).sum()['Sales'].groupby(level=0).apply(lambda x:100*x\/x.sum()).unstack().loc[:,[\n    'Monday',\n    'Tuesday',\n    'Wednesday',\n    'Thursday',\n    'Friday',\n    'Saturday',\n    'Sunday']]\n\nplt.figure(figsize=(10,10))\n\nsns.heatmap(saledaystype,cmap='Blues').set_title('Day % of Weekly Sales by Store Type')\nplt.show()","706a6f22":"sns.catplot(data=store_open,x='Month',y='Customers',palette='colorblind',hue='Promo',kind='bar',height=5,\n           aspect=8\/5)\nplt.title('Promotional Impact on Customer Volume')\n\nsns.catplot(data=store_open, x='Month',y='Sales',palette='colorblind',hue='Promo',kind='bar',height=5,\n           aspect=8\/5)\n\nplt.title('Promotional Impact on Sales Volume')\n","049b2641":"sns.catplot(data=store_open,x='Year',y='SalesperCustomer',col='StoreType',col_order=['a','b','c','d'],\n            hue='Promo',palette='colorblind',col_wrap=2, kind='box')","e3f87b61":"sns.catplot(data=store_open,x='Year',y='Customers',col='StoreType',col_order=['a','b','c','d'],\n            hue='Promo',palette='colorblind',col_wrap=2,kind='box')","b7476900":"store_open.groupby(['StoreType','Promo','Assortment']).SalesperCustomer.describe()\n","1246e26b":"#Rossmann store promotions seem like\n#weekly events that run from Monday\n#through Friday.\n\nstore_open.groupby(['Day','Promo']).Promo.count()","76120579":"#For stores that participate in promotional events,\n#promotional impact by day of week.\n\nsns.catplot(data=store_open,x='Day',y='SalesperCustomer',hue='Promo',kind='bar',\n           height=5,aspect=8\/5,palette='colorblind',order=['Monday','Tuesday','Wednesday',\n                                                          'Thursday','Friday','Saturday',\n                                                          'Sunday'])\nplt.title('Promotional Impact on Average Spending Behaviour by Day')","d3d7f619":"sns.catplot(data=store_open,x='Day',y='Customers',hue='Promo',kind='bar',\n           height=5,aspect=8\/5,palette='colorblind',order=['Monday','Tuesday',\n                                                           'Wednesday','Thursday',\n                                                          'Friday','Saturday',\n                                                          'Sunday'])\nplt.title('Promotional Impact on Customer Volume by Day')","949b24eb":"df=store_open[(store_open.Week>44)]\nsns.catplot(data=df,x='Week',y='SalesperCustomer',col='StoreType',col_order=['a','b','c','d'],\n            hue='Promo',color='StateHoliday',palette='colorblind', col_wrap=2,kind='bar')\n          ","75505712":"sns.catplot(data=df,x='Week',y='Sales',col='StoreType',col_order=['a','b','c','d'],\n            hue='Promo',color='StateHoliday',palette='colorblind',col_wrap=2, kind='bar')","223588a8":"#It appears that promotions do provide a lift to \n#sales.  Let's test to see if this is really the\n#case and not due to chance market fluctuation.\n\ndf_promo=store_open[(store_open.Promo==1)]\ndf_nopromo=store_open[(store_open.Promo==0)]\n\n#Look at the distribution of sales\nf,axes=plt.subplots(ncols=2,figsize=(20,5))\n\nsns.distplot(df_nopromo['Sales'],kde=False, color='orange',ax=axes[0])\naxes[0].set_ylabel('Frequency')\naxes[0].text(25000, 60000, r'$\\mu$='+str(round(df_nopromo['Sales'].mean(),2)), \n         fontsize=12)\naxes[0].set_title('Sales Distribution: Stores without Promotions')\n\nsns.distplot(df_promo['Sales'],kde=False, color='orange',ax=axes[1])\naxes[1].set_ylabel('Frequency')\naxes[1].set_ylim([0,80000])\naxes[1].text(25000,60000,r'$\\mu$='+str(round(df_promo['Sales'].mean(),2)),\n             fontsize=12)\naxes[1].set_title('Sales Distribution: Stores with Promotions')\nplt.show()","64ebdca2":"df_nopromo.Sales.describe()","b708d384":"df_promo.Sales.describe()","2110b9d4":"#Sales are not normally distributed but\n#sample size is large.  Consider one-way ANOVA as it\n#is a fairly robust test against normality\n#assumption.\n#H0: Means are equal (Promotions have no effect)\n#H1: Means are not equal (Promotions have effect)\n\nstat,p = f_oneway(df_nopromo.Sales,df_promo.Sales)\nprint('Statistic= %.3f, p= %.3f'%(stat,p))\n\n#Interpret\nalpha=0.05\nif p>alpha:\n    print('Cannot reject H0, i.e. means are not significantly different')\nelse:\n    print('Reject H0, i.e. means are different.')","36413f4b":"The weeks leading up to Christmas are very important for \nretailers. Even though promotions have little impact \non the average individual spending at Store Type 'b', they still\nprovide overall sales lift. Consumers today have come to expect \npromotions during the weeks before Christmas. Stores with promotions\nattract higher customer volume than those without.","c2f508ea":"For stores that participate in promotional events, Mondays \nshow the biggest increase in average spending behaviour as \nwell as customer volume. This is likely because \na) there are no such events over the weekends; \nb) most stores are closed on Sundays; and\/or \nc) advertising for events started over the weekends.\n","318b03c4":"Customer base at Store Type 'b' with merchandise allocation \n'b' are more likely to visit the stores just for specific promotional \nitems and leave without buying anything else if those items weren't \navailable. For the majority of its customer base, promotional events \nprovide negligible lift to the average spending per person.\n\nSome customers at Store Type 'a' with merchandise allocation 'a' \nexhibit similar tendency, ie target only specific promotional items. But \noverall, most will still increase the size of their purchase basket during \na promotional event.\n\nCustomers at Store Type 'c' and 'd' are more sensitive to promotional events.","dc76b2b5":"This is an exercise on the impact of promotional events on Rossmann store sales.  Using a one-way ANOVA, it is determined that promotional events have an impact on store sales. \n\nStore Types 'a' and 'd' are the most numerous and account for more than 80% of total sales; Store Type 'b', while relatively few in number, plug an important market place gap - cater to Sunday shoppers.  Germany-based Rossmann operates in Europe where Sunday store operating hours are regulated and stores are mostly closed on Sundays.  It's not surprising that Sundays account for the highest sales at Store Type 'b', while for other store types, Mondays represent the highest sales day of the week.  Store Type 'b' customers tend to have the smallest average purchase basket relative to those at the other store types.  But customer volume is highest for Store Type 'b' as it operates 7 days a week.\n\nPromotional events tend to have the biggest impact on Mondays for stores that have them.  These are weekly events that start on Monday and end on Friday.  Advertising for the following event likely starts during the weekend.  It is imperative for stores with promotions to ensure the promoted items that are part of their merchandise allocation are stocked and displayed by Monday to avoid customer dissatisfaction.\n\nThe spending behaviour of customers at Store Type 'b' is the least sensitive of all store types to promotional events.  In fact, Store Type 'b' customers are more likely to visit the store for specific promoted items and leave without buying anything else if those items weren't available.  Store Type 'a' customers show a similar tendency but most will still increase their purchase basket during a promotion.  Customers at Store Type 'c' and 'd' seem more responsive to promotions.\n\nKnowing this, it is best not to have \"door buster deals\" (loss leaders) that are part of the Store Type 'b' with 'b' merchandise allocation line-up.  These will have a more desired impact at the other store types.  Impulse buy items likely will increase average spending at Store Type 'c' and 'd' much more than at Store Type 'b', where shelf space might be better used for staples and \"emergency\" items.\n\n ","8ab59960":"Overall, promotional events provide lift to both customer and \nsales volume.  The impact is most noticeable during the month\nof December which is when consumers shop for Christmas and New Year.  \nPromotional events provide a lift of less than 1.50\u20ac on the average \npurchase basket of each customer for most months except December.","20506239":"Compared to other store types, customer behaviour at \nStore Type 'b' is the least sensitive to promotional \nevents.","8f85f420":"Rossmann operates mostly in Germany where stores are typically closed on Sundays.  \nOf all the four store types, only Store Type 'b' opens on Sundays."}}