{"cell_type":{"6cff35c7":"code","394efaed":"code","f432d4fb":"code","782243b7":"code","93229828":"code","83871190":"code","d9158d8f":"code","6f6df798":"code","12e016bd":"code","3c87f977":"code","7a3a7e87":"code","88127f7c":"code","9920e158":"code","46dd5817":"code","86d0bb11":"code","5a81e6ff":"code","7e14c721":"code","8e3ba9fb":"code","35db7478":"code","6d7e30db":"code","1254559d":"code","b59df451":"code","b2a7e391":"code","9f72c200":"code","758d8a18":"code","7473fc41":"code","aff4b30f":"code","79854365":"code","db5618f3":"code","1c15340a":"code","e7d63a0c":"code","2a6bed9f":"code","5f733ab7":"code","1a65f9c0":"code","5e1f02f0":"code","e3e2374b":"code","bb85f82c":"code","0710046a":"code","ed6c6286":"code","a155c433":"code","fe5c659c":"code","2a0b1631":"code","e278cf1c":"code","a6a93691":"code","7e4fae93":"code","e9259acd":"code","f95fc88b":"markdown","9dc44656":"markdown","e8c19124":"markdown","bf11a73a":"markdown","6c211f0b":"markdown","2ad988b7":"markdown","1c95730d":"markdown","33f12337":"markdown","7ed57e66":"markdown","ace90294":"markdown","fcffedad":"markdown","80dfefa1":"markdown","34289c32":"markdown","b81e8dda":"markdown","48fe2148":"markdown","e6238e74":"markdown","484d394f":"markdown","ed8265b0":"markdown","0276a548":"markdown","6885ad2d":"markdown","895a4258":"markdown","960f5ff7":"markdown","b5d7d529":"markdown","784db2d3":"markdown"},"source":{"6cff35c7":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","394efaed":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport plotly.express as px\nimport warnings\n\nwarnings.filterwarnings('ignore')","f432d4fb":"red_wine = pd.read_csv('\/kaggle\/input\/red-wine-quality-cortez-et-al-2009\/winequality-red.csv')","782243b7":"red_wine.head()","93229828":"red_wine.shape","83871190":"red_wine.columns","d9158d8f":"red_wine['quality'].value_counts()","6f6df798":"red_wine.iloc[:,:11].describe()","12e016bd":"red_wine.info()","3c87f977":"#First grouping by quality score and then calculating mean for each quality score on various features\nx = red_wine.groupby('quality')\nx.mean()","7a3a7e87":"#standard deviation\nx.std()","88127f7c":"#pair plot\nsns.pairplot(red_wine, hue=\"quality\",height=1)\nplt.show()","9920e158":"#to-do: need to put all this in a loop\n#plotting means of quality scores vs each feature\nplt.rcParams[\"figure.figsize\"] = (20,15)\nfig, axes = plt.subplots(3, 5)\nfig.figsize = (20, 20)\naxes[0, 0].plot(x.mean().index, x.mean().iloc[:, 0])\naxes[0, 0].set_title(f\"Quality vs Means of {x.mean().columns[0]}\")\naxes[0, 0].set_xlabel(\"Quality\")\naxes[0, 0].set_ylabel(f\"Means of {x.mean().columns[0]}\")\n\naxes[0, 1].plot(x.mean().index, x.mean().iloc[:, 1])\naxes[0, 1].set_title(f\"Quality vs Means of {x.mean().columns[1]}\")\naxes[0, 1].set_xlabel(\"Quality\")\naxes[0, 1].set_ylabel(f\"Means of {x.mean().columns[1]}\")\n\naxes[0, 2].plot(x.mean().index, x.mean().iloc[:, 2])\naxes[0, 2].set_title(f\"Quality vs Means of {x.mean().columns[2]}\")\naxes[0, 2].set_xlabel(\"Quality\")\naxes[0, 2].set_ylabel(f\"Means of {x.mean().columns[2]}\")\n\naxes[0, 3].plot(x.mean().index, x.mean().iloc[:, 3])\naxes[0, 3].set_title(f\"Quality vs Means of {x.mean().columns[3]}\")\naxes[0, 3].set_xlabel(\"Quality\")\naxes[0, 3].set_ylabel(f\"Means of {x.mean().columns[3]}\")\n\naxes[0, 4].plot(x.mean().index, x.mean().iloc[:, 4])\naxes[0, 4].set_title(f\"Quality vs Means of {x.mean().columns[4]}\")\naxes[0, 4].set_xlabel(\"Quality\")\naxes[0, 4].set_ylabel(f\"Means of {x.mean().columns[4]}\")\n\naxes[1, 0].plot(x.mean().index, x.mean().iloc[:, 5])\naxes[1, 0].set_title(f\"Quality vs Means of {x.mean().columns[5]}\")\naxes[1, 0].set_xlabel(\"Quality\")\naxes[1, 0].set_ylabel(f\"Means of {x.mean().columns[5]}\")\n\naxes[1, 1].plot(x.mean().index, x.mean().iloc[:, 6])\naxes[1, 1].set_title(f\"Quality vs Means of {x.mean().columns[6]}\")\naxes[1, 1].set_xlabel(\"Quality\")\naxes[1, 1].set_ylabel(f\"Means of {x.mean().columns[6]}\")\n\n\naxes[1, 2].plot(x.mean().index, x.mean().iloc[:, 7])\naxes[1, 2].set_title(f\"Quality vs Means of {x.mean().columns[7]}\")\naxes[1, 2].set_xlabel(\"Quality\")\naxes[1, 2].set_ylabel(f\"Means of {x.mean().columns[7]}\")\n\n\naxes[1, 3].plot(x.mean().index, x.mean().iloc[:, 8])\naxes[1, 3].set_title(f\"Quality vs Means of {x.mean().columns[8]}\")\naxes[1, 3].set_xlabel(\"Quality\")\naxes[1, 3].set_ylabel(f\"Means of {x.mean().columns[8]}\")\n\naxes[1, 4].plot(x.mean().index, x.mean().iloc[:, 9])\naxes[1, 4].set_title(f\"Quality vs Means of {x.mean().columns[9]}\")\naxes[1, 4].set_xlabel(\"Quality\")\naxes[1, 4].set_ylabel(f\"Means of {x.mean().columns[9]}\")\n\naxes[2, 0].plot(x.mean().index, x.mean().iloc[:, 10])\naxes[2, 0].set_title(f\"Quality vs Means of {x.mean().columns[10]}\")\naxes[2, 0].set_xlabel(\"Quality\")\naxes[2, 0].set_ylabel(f\"Means of {x.mean().columns[10]}\")\n\n\n","46dd5817":"#fixed acidity and quality\nsns.FacetGrid(red_wine, hue='quality', size=6).map(sns.distplot, \"fixed acidity\").add_legend()","86d0bb11":"sns.boxplot(x='quality',y='fixed acidity', data=red_wine)","5a81e6ff":"#volatile acidity and quality\nsns.FacetGrid(red_wine, hue='quality', size=6).map(sns.distplot, \"volatile acidity\").add_legend()","7e14c721":"sns.boxplot(x='quality',y='volatile acidity', data=red_wine)","8e3ba9fb":"#citric acid and quality\nsns.FacetGrid(red_wine, hue='quality', size=6).map(sns.distplot, \"citric acid\").add_legend()\n","35db7478":"#residual sugar and quality\nsns.FacetGrid(red_wine, hue='quality', size=6).map(sns.distplot, \"residual sugar\").add_legend()","6d7e30db":"#chlorides and quality\nsns.FacetGrid(red_wine, hue='quality', size=6).map(sns.distplot, \"chlorides\").add_legend()","1254559d":"#free sulfur dioxide and quality\nsns.FacetGrid(red_wine, hue='quality', size=6).map(sns.distplot, \"free sulfur dioxide\").add_legend()","b59df451":"#total sulfur dioxide and quality\nsns.FacetGrid(red_wine, hue='quality', size=6).map(sns.distplot, \"total sulfur dioxide\").add_legend()","b2a7e391":"#density and quality\nsns.FacetGrid(red_wine, hue='quality', size=6).map(sns.distplot, \"density\").add_legend()","9f72c200":"sns.boxplot(x='quality',y='density', data=red_wine)","758d8a18":"#pH and quality\nsns.FacetGrid(red_wine, hue='quality', size=6).map(sns.distplot, \"pH\").add_legend()","7473fc41":"sns.boxplot(x='quality',y='pH', data=red_wine)","aff4b30f":"#sulphates and quality\nsns.FacetGrid(red_wine, hue='quality', size=6).map(sns.distplot, \"sulphates\").add_legend()","79854365":"sns.boxplot(x='quality',y='sulphates', data=red_wine)","db5618f3":"#alcohol and quality\nsns.FacetGrid(red_wine, hue='quality', size=6).map(sns.distplot, \"alcohol\").add_legend()","1c15340a":"sns.boxplot(x='quality',y='alcohol', data=red_wine)","e7d63a0c":"#first split quality\nred_wine_x = red_wine.iloc[:,:11]\nred_wine_y = red_wine.iloc[:,-1]","2a6bed9f":"red_wine_y","5f733ab7":"#first standardizing data\nfrom sklearn.preprocessing import StandardScaler\nstd_red_wine = StandardScaler().fit_transform(red_wine_x)","1a65f9c0":"#using t-SNE alogorithm for vizualization\nfrom sklearn.manifold import TSNE\nmodel = TSNE(n_components=2, perplexity=50, random_state=0)\ntsne_data = model.fit_transform(std_red_wine)\ntsne_data = np.vstack((tsne_data.T, red_wine_y)).T\ntsne_df = pd.DataFrame(data=tsne_data, columns=(\"Dim_1\", \"Dim_2\", \"quality\"))\nsns.set_style(\"darkgrid\")\nsns.FacetGrid(tsne_df, hue='quality', height=10).map(plt.scatter, 'Dim_1', 'Dim_2').add_legend()\nplt.show()","5e1f02f0":"#changing perplexity and iterations for t-SNE algorithm\nfrom sklearn.manifold import TSNE\nmodel = TSNE(n_components=2, perplexity=30, n_iter=5000, random_state=0)\ntsne_data = model.fit_transform(std_red_wine)\ntsne_data = np.vstack((tsne_data.T, red_wine_y)).T\ntsne_df = pd.DataFrame(data=tsne_data, columns=(\"Dim_1\", \"Dim_2\", \"quality\"))\nsns.FacetGrid(tsne_df, hue='quality', height=10).map(plt.scatter, 'Dim_1', 'Dim_2').add_legend()\nplt.show()","e3e2374b":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn import model_selection","bb85f82c":"#first break the dataset into training, cross validation and testing dataset\n\nred_wine = pd.read_csv('\/kaggle\/input\/red-wine-quality-cortez-et-al-2009\/winequality-red.csv')","0710046a":"red_wine","ed6c6286":"#separating 'quality column'\nred_wine_x = red_wine.iloc[:,:-1]\nred_wine_y = red_wine.iloc[:,-1]","a155c433":"red_wine_x","fe5c659c":"#column standardization\nfrom sklearn.preprocessing import StandardScaler\nred_wine_x = StandardScaler().fit_transform(red_wine_x)","2a0b1631":"#simplifying classes for kNN \nred_wine_y_copy = red_wine_y.copy()\nred_wine_y = red_wine_y.replace([3,4],0)\nred_wine_y = red_wine_y.replace([5,6],1)\nred_wine_y = red_wine_y.replace([7,8],2)  \n\nred_wine_y.value_counts()","e278cf1c":"X = np.array(red_wine_x)\nY = np.array(red_wine_y)","a6a93691":"# split the data set into train and test\nX_1, X_test, Y_1, Y_test = model_selection.train_test_split(X,Y,test_size = 0.3, random_state=0)\n\n#split X_1, Y_1 into training and cross validation datasets\nx_train, x_cv, y_train, y_cv = model_selection.train_test_split(X_1, Y_1, test_size = 0.3)\n\n#7-NN\nknn = KNeighborsClassifier(n_neighbors=7)\n\n#fitting data on training datasets\nknn.fit(x_train, y_train)\n\n#predict on x cross validation\npredict_cv = knn.predict(x_cv)\n\n#accuracy on y cross validation\naccuracy_cv = accuracy_score(y_cv, predict_cv, normalize=True) * float(100)\nprint(f\"Cross Validation accuracy for k=7 is {accuracy_cv}\")","7e4fae93":"#now testing on X_test\nknn = KNeighborsClassifier(n_neighbors=7)\n\nknn.fit(x_train, y_train)\n#testing on X_test\npredict_test = knn.predict(X_test)\n\n#accuracy on Y_test\naccuracy_test = accuracy_score(Y_test, predict_test, normalize=True) * float(100)\nprint(f\"Test dataset accuracy for k=7 is {accuracy_test}\")","e9259acd":"#predicting on train set to verify overfitting\npredict_train = knn.predict(x_train)\n\naccuracy_train = accuracy_score(y_train, predict_train, normalize=True) * float(100)\nprint(f\"Train dataset accuracy for k=7 is {accuracy_train}\")","f95fc88b":"# EDA - Conclusion","9dc44656":"Therefore, no overfitting","e8c19124":"From the above analysis, we can say that the main components that effect the quality of the wine are volatile acidity, amount of sulphates and alcohol content. Most of the wine has been given an average quality score i.e., 5 and 6. Higher amount of sulphates and alcohol content and a decrease in the volatile acidity increases the quality of the wine.","bf11a73a":"From the above t-SNE vizualization, we see that the quality scores 5 and 6 are spread all over and quality scores 7 and 8 are cornered and distinguishable.","6c211f0b":"We can see that the quality increases when the means of volatile acidity decreases. The means of critic acid and the means of sulphates have an upward trend.\n\nMeanwhile, means of chlorides and means of alcohol contribute to the quality of the wine to an extent. ","2ad988b7":"The median for quality scores 3 and 4 is almost the same, but the medians for 5,6,7 and 8 are increasing exponentially.\n\nTherefore, quality wines have higher alcohol content.","1c95730d":"<h2>1. Importing libraries<\/h2>","33f12337":"# **Univariate Analysis**","7ed57e66":"<h2>5. Simplifying classes for kNN<\/h2>","ace90294":"# **t-SNE for vizualization**","fcffedad":"# Mean","80dfefa1":"# Standard Deviation","34289c32":"Fixed acidity is not a proper feature to judge the wine quality","b81e8dda":"<h2>4. Column Standardization<\/h2>","48fe2148":"Here we can see that the medians for quality score 3 and 4 is almost the same but it increases as the score increases. \nTherefore, sulphate content is higher in quality wine.","e6238e74":"<h2>3. Separating the target from the features<\/h2>","484d394f":"<h2>Conclusion<\/h2>\n<h4>The accuracy when we predict the red wine quality with k-Nearest Neighbors when k = 7 is 82.7%","ed8265b0":"<h2>6. Converting into a numpy array<\/h2","0276a548":"Here, we can see that the quality increases as the volatile acidity decreases","6885ad2d":"Even though the quality is 0 to 10, there is no observation with score 1,2,9 and 10. Majority of the wines have been rated average i.e., 5 and 6","895a4258":"<h2>7. Splitting data into train, cross validation and test datasets and fitting the model<\/h2>","960f5ff7":"# **Bivariate Analysis**","b5d7d529":"<h2>2. Loading dataset into pandas DataFrame<\/h2>","784db2d3":"# **Red Wine Quality Prediction Using k-Nearest Neighbors**"}}