{"cell_type":{"5360840a":"code","e374d7ec":"code","dcb588eb":"code","e6e25814":"code","e9be5cd2":"code","ce0dac11":"code","f5c03ba6":"code","f0c17ac3":"code","58431c30":"code","e888c16f":"code","340b3ca9":"code","54b8d1b2":"code","337aa3c8":"code","f233a6b2":"code","d201ae75":"code","1c8cbaa4":"code","c11b9dbf":"code","fb810b43":"code","035be2b9":"code","5cf650f4":"code","87136728":"code","c38e9bfb":"code","e8dda39f":"code","1140e0e4":"code","c1a1f35e":"code","91bac726":"code","f666f686":"code","9c83590f":"code","9dbca583":"code","4c5686c5":"code","44a2d626":"code","ff60ed2c":"markdown","6c8572fe":"markdown","72297fba":"markdown","5b3ec49f":"markdown"},"source":{"5360840a":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport missingno as msno","e374d7ec":"df = pd.read_csv('..\/input\/insurance\/insurance.csv')","dcb588eb":"df.head()","e6e25814":"msno.matrix(df)","e9be5cd2":"df[df.isnull()].count()","ce0dac11":"df.info()","f5c03ba6":"df.describe()","f0c17ac3":"df.head()","58431c30":"Male = pd.get_dummies(df['sex'], drop_first=True)\ndf = pd.concat([df, Male], axis=1 )","e888c16f":"Smoker = pd.get_dummies(df['smoker'], drop_first=True)\ndf = pd.concat([df, Smoker], axis=1 )","340b3ca9":"df = df.rename(columns={'yes':'Smoker'})","54b8d1b2":"df['region'].unique()","337aa3c8":"region = pd.get_dummies(df['region'])\ndf = pd.concat([df, region], axis=1 )\n#df.drop('region', axis=1,inplace=True)\n#df.drop(['sex','smoker'], axis=1, inplace=True)","f233a6b2":"df.head()","d201ae75":"plt.figure(figsize=(12,6))\nsns.set_style('white')\nsns.countplot(x='sex', data = df, palette='GnBu')\nsns.despine(left=True)\n","1c8cbaa4":"plt.figure(figsize=(14,10))\nsns.set_style('white')\nsns.boxplot(x='sex', y='charges', data = df, palette='OrRd', hue='Smoker')\nsns.despine(left=True)\n","c11b9dbf":"fig, ax =plt.subplots(nrows= 1, ncols = 3, figsize= (14,6))\nsns.scatterplot(x='age', y='charges', data = df, palette='coolwarm', hue='sex', ax=ax[0])\nsns.scatterplot(x='age', y='charges', data = df, palette='GnBu', hue='Smoker', ax=ax[1])\nsns.scatterplot(x='age', y='charges', data = df, palette='magma_r', hue='region', ax=ax[2])\nsns.set_style('dark')\nsns.despine(left=True)\nplt.legend(bbox_to_anchor=(1.05, 1), loc=2, borderaxespad=0.)","fb810b43":"fig, ax =plt.subplots(nrows= 1, ncols = 2, figsize= (14,6))\nsns.boxplot(x='region', y='charges', data = df, palette='GnBu', hue='Smoker', ax=ax[0])\nsns.boxplot(x='region', y='charges', data = df, palette='coolwarm', hue='sex', ax=ax[1])","035be2b9":"fig, ax =plt.subplots(nrows= 1, ncols = 2, figsize= (14,6))\nsns.scatterplot(x='bmi', y='charges', data = df, palette='GnBu_r', hue='sex', ax=ax[0])\nsns.scatterplot(x='bmi', y='charges', data = df, palette='magma', hue='Smoker', ax=ax[1])\nsns.set_style('dark')\nsns.despine(left=True)\nplt.legend(bbox_to_anchor=(1.05, 1), loc=2, borderaxespad=0.)","5cf650f4":"df.drop(['sex', 'region', 'smoker', 'southwest'], axis=1, inplace=True)","87136728":"df.head()","c38e9bfb":"plt.figure(figsize=(16,6))\nsns.heatmap(df.corr(), cmap='OrRd')","e8dda39f":"X=df.drop('charges', axis=1)\ny=df['charges']","1140e0e4":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X,y,test_size=0.25)\nfrom sklearn.preprocessing import MinMaxScaler\nscaler = MinMaxScaler()\nscaler.fit(X_train)\nX_train = scaler.transform(X_train)\nX_validate = scaler.transform(X_test)","c1a1f35e":"from tensorflow.keras.models import Sequential\nfrom tensorflow.keras.layers import Dense, Dropout\nfrom tensorflow.keras.callbacks import EarlyStopping","91bac726":"model = Sequential()\nmodel.add(Dense(units = 8, activation = 'relu'))\nmodel.add(Dense(units = 3, activation = 'relu'))\n#model.add(Dropout(0.5))\n\n#model.add(Dense(units = 2, activation = 'relu'))\n#model.add(Dense(units = 4, activation = 'relu'))\n#model.add(Dense(units = 4, kernel_initializer = 'uniform', activation = 'relu'))\n\n\n\nmodel.add(Dense(units = 1))\nmodel.compile(optimizer = 'adam', loss = 'mse')\nearly_stop = EarlyStopping(monitor='val_loss', mode= 'min', verbose= 0, patience=15)\n","f666f686":"model.fit(x=X_train, y=y_train, epochs = 2000, validation_data=(X_test, y_test), batch_size=128, callbacks=[early_stop])","9c83590f":"loss = pd.DataFrame(model.history.history)","9dbca583":"loss.plot()","4c5686c5":"from sklearn.metrics import mean_squared_error\npred = model.predict(X_test)\nnp.sqrt(mean_squared_error(y_test,pred))","44a2d626":"entry_1 = df[:][257:477].drop('charges', axis=1)\npred = model.predict(entry_1)\nnp.sqrt(mean_squared_error(df[:][257:477]['charges'], pred))","ff60ed2c":"# Predictive Analysis","6c8572fe":"# Data Cleaning and Feature Engineering ","72297fba":"* We will be keeping the categorical columns for now because we want to perform exploratory analysis on them\n* Will drop them before applying predictive models","5b3ec49f":"# Hello Guys! \n* Hope you are doing well. This is my notebook where I have worked on predicting insurance cost based on the features provided in the data set\n* I wanted to test the dataset with different regression models\n* I have also done feature engineering initially and then exploratory analysis to build an understanding of the relationship between variables.\n* Hope you Enjoy!"}}