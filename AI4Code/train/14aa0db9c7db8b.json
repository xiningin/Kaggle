{"cell_type":{"dd8246c4":"code","cb2990d8":"code","5b407473":"code","b6558f38":"code","5ba31a3e":"code","a48ea6b1":"code","806f9bdf":"code","bb5eb48b":"markdown","f1add904":"markdown"},"source":{"dd8246c4":"# Using Library\n\nimport pandas as pd\nimport numpy as np\nfrom sklearn.cluster import KMeans\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn import datasets, linear_model\nimport matplotlib.pyplot as plt","cb2990d8":"CC = pd.read_csv('..\/input\/ccdata\/CC GENERAL.csv')\nCC","5b407473":"CC.isnull().sum()","b6558f38":"cc = CC.iloc[:,[1,14]].values\ncc","5ba31a3e":"#drawing dendogram\nimport scipy.cluster.hierarchy as shc\n\nplt.figure(figsize=(10, 7))  \nplt.title(\"Shopping Dendograms\")  \ndend = shc.dendrogram(shc.linkage(cc, method='ward')) ","a48ea6b1":"#Now clustering the data points\nfrom sklearn.cluster import AgglomerativeClustering\n\ncluster = AgglomerativeClustering(n_clusters=2, affinity='euclidean', linkage='ward')  \ncluster_labels=cluster.fit_predict(cc)  \nprint(cluster.labels_) \nprint(cluster_labels) \n\nplt.scatter(cc[:,0],cc[:,1], c=cluster_labels, cmap='rainbow')","806f9bdf":"# Using Silhouette_score\nfrom sklearn.metrics import silhouette_score\nsilhouette_avg = silhouette_score(cc, cluster_labels)\nprint(\"For n_clusters =\", 2,\n          \"The average silhouette_score is :\", silhouette_avg)","bb5eb48b":"# Apply agglomerative clustering using ward linkage method.\n- Form the clusters.\n- Visualize the clusters formed by agglomerative clustering.\n","f1add904":"#  Determine the number of clusters using dendogram. Use ward linkage method"}}