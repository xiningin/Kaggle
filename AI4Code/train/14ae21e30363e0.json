{"cell_type":{"bb34c7b9":"code","f0a2a7d0":"code","caa23b79":"code","63718f31":"code","353cb7e8":"code","7b5bf431":"code","3d24dce8":"code","0bf7fcb1":"code","1ce73615":"code","dbb19a84":"code","4afbe2b0":"code","fce31e85":"code","c584b908":"code","3c359b2b":"code","a16e5627":"code","438af54d":"code","598ee1bc":"code","5966b707":"code","1a646575":"code","546cc98a":"code","d8e98a1c":"code","72d856d9":"code","7df543d3":"markdown","20148afc":"markdown","80faf67b":"markdown","713478da":"markdown","5cd9b8aa":"markdown","356cdf95":"markdown","912409f1":"markdown","f0b2d969":"markdown","da4bd5ee":"markdown","a2b16061":"markdown","a8b945a5":"markdown","fbb773a7":"markdown","bac49cc1":"markdown","e3383a41":"markdown","c078e387":"markdown","80727953":"markdown","7aa0435d":"markdown","f60597a1":"markdown","5b8212df":"markdown"},"source":{"bb34c7b9":"# library imports\n\nimport re\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.discriminant_analysis import LinearDiscriminantAnalysis\nfrom sklearn.naive_bayes import GaussianNB\nfrom sklearn.svm import SVC\n\nfrom sklearn.metrics import classification_report\nfrom sklearn.metrics import confusion_matrix\n\n# system settings\npd.set_option('display.max_columns', 1000)\npd.set_option('display.max_rows', 100)","f0a2a7d0":"# dataset imports\nloan_df = pd.read_csv('..\/input\/loan-default-prediction\/Default_Fin.csv')","caa23b79":"loan_df.head()","63718f31":"loan_df.shape","353cb7e8":"# observe distribution of employed \nsns.countplot(x='Employed', data=loan_df)","7b5bf431":"# observe distribution of Bank Balance\nsns.displot(x='Bank Balance', data=loan_df)","3d24dce8":"# observe distribution of Annual Salary\nsns.displot(x='Annual Salary', data=loan_df)","0bf7fcb1":"# observe distribution of defaulted\nsns.countplot(x='Defaulted?', data=loan_df)","1ce73615":"# get correlation between features \ncorrMatrix = loan_df.corr()\nsns.heatmap(corrMatrix, annot=True, linewidths=.5, cmap=\"YlGnBu\")\nplt.show()","dbb19a84":"# investigate defaulting by employment\nsns.countplot(x='Employed', hue='Defaulted?', data=loan_df)","4afbe2b0":"loan_df.groupby(['Employed'])['Defaulted?'].sum().reset_index()","fce31e85":"# investigate defaulting vs not bank balance distributions\n\n# create sub-dataframes filtered by default\ndefaulted = loan_df[loan_df['Defaulted?']==1]\nnot_defaulted = loan_df[loan_df['Defaulted?']==0]\n\nfig = plt.figure(figsize=(10,6))\n\nsns.kdeplot(defaulted['Bank Balance'])\nsns.kdeplot(not_defaulted['Bank Balance'])\n\nfig.legend(labels=['Defaulted', 'Not Defaulted'])\nplt.show()","c584b908":"# investigate defaulting vs not bank balance distributions\n\n# create sub-dataframes filtered by default\ndefaulted = loan_df[loan_df['Defaulted?']==1]\nnot_defaulted = loan_df[loan_df['Defaulted?']==0]\n\nfig = plt.figure(figsize=(10,6))\n\nsns.kdeplot(defaulted['Annual Salary'])\nsns.kdeplot(not_defaulted['Annual Salary'])\n\nfig.legend(labels=['Defaulted', 'Not Defaulted'])\nplt.show()","3c359b2b":"# split data into features and labels\nX = loan_df.drop(['Defaulted?'], axis=1)\ny = loan_df['Defaulted?']","a16e5627":"# Split data and labels into training and testing sets\nX_train, X_test, y_train, y_test = train_test_split(X, y, random_state=42)","438af54d":"logreg = LogisticRegression()\nlogreg.fit(X_train, y_train)\n\nprint(\"Accuracy on training set: {:.2f}\".format(logreg.score(X_train, y_train) * 100))\nprint(\"Accuracy on testing set: {:.2f}\".format(logreg.score(X_test, y_test) * 100))","598ee1bc":"d_tree = DecisionTreeClassifier()\nd_tree.fit(X_train, y_train)\n\nprint(\"Accuracy on training set: {:.2f}\".format(d_tree.score(X_train, y_train) * 100))\nprint(\"Accuracy on testing set: {:.2f}\".format(d_tree.score(X_test, y_test) * 100))","5966b707":"knn = KNeighborsClassifier()\nknn.fit(X_train, y_train)\n\nprint(\"Accuracy on training set: {:.2f}\".format(knn.score(X_train, y_train) * 100))\nprint(\"Accuracy on testing set: {:.2f}\".format(knn.score(X_test, y_test) * 100))","1a646575":"lda = LinearDiscriminantAnalysis()\nlda.fit(X_train, y_train)\n\nprint(\"Accuracy on training set: {:.2f}\".format(lda.score(X_train, y_train) * 100))\nprint(\"Accuracy on testing set: {:.2f}\".format(lda.score(X_test, y_test) * 100))","546cc98a":"gnb = GaussianNB()\ngnb.fit(X_train, y_train)\n\nprint(\"Accuracy on training set: {:.2f}\".format(gnb.score(X_train, y_train) * 100))\nprint(\"Accuracy on testing set: {:.2f}\".format(gnb.score(X_test, y_test) * 100))","d8e98a1c":"svc = SVC()\nsvc.fit(X_train, y_train)\n\nprint(\"Accuracy on training set: {:.2f}\".format(svc.score(X_train, y_train) * 100))\nprint(\"Accuracy on testing set: {:.2f}\".format(svc.score(X_test, y_test) * 100))","72d856d9":"pred = knn.predict(X_test)\ncm = confusion_matrix(y_test, pred)\n\nsns.heatmap(cm, annot=True)\nprint(classification_report(y_test, pred))","7df543d3":"### Interactions Between data","20148afc":"#### K-Nearest Neighbors","80faf67b":"#### Gaussian Naive Bayes","713478da":"#### Generate a report on the Linear Discriminant Analysis","5cd9b8aa":"On average, defaulted loans come from individuals with a higher bank balance while non-defaulted loans average bank balances are lower. This seems odd, but without knowing the size of the loan, it is impossible to know if this is the product of behavior or a lack of causality from the feature. ","356cdf95":"#### Support Vector Machine","912409f1":"The distribution of annual salary is somewhat bimodal, with a mode near $200,000 and another near $500,000. The relatively high salaries are interesting because they do not not seem to be indicative of a likelihood to default. Determining if the salary is related to probability of defaulting is going to be vital to utilizing this feature.","f0b2d969":"The number of defaults are similar for both employed and unemployed individuals, but a higher proportion of unemployed people defaulted compared to employed peers. Approximately 4% of unemployed individuals defaulted on their loan while about 3% of employed individuals defaulted. This is not a strong correlation individually, but it does indicate a link.","da4bd5ee":"Approximately 30% of the individuals in this dataset are unemployed. Determining if employment is correlated with defaulting seems like an obvious next step.","a2b16061":"### Basic Insights","a8b945a5":"In this dataset, about three percent of the 10,000 indiviudals defaulted on their loans. This does not appear to clearly line up with one single feature of the dataset and thus is likely the result of numerous features compounded.","fbb773a7":"For the linear discriminant analysis (the model that was most accurate in classifying the evaluation dataset), non-defaulted loans were predicted correctly nearly perfectly, but the accuracy for labeling defaulted loans is fairly poor. This dataset is extremely unbalanced and the machine learning models assume that more values are non-defaulted than actually are. The dataset is not an effective set to make predictions with. ","bac49cc1":"Using a heatmap, it can be seen that there are few features that have strong correlation with one another. The strongest correlation is between annual salary and employment (annual salary does not default to $0 when the Employed feature is false) and another mild correlation is between bank balance and defaulting.","e3383a41":"#### Decision Tree","c078e387":"#### Logistic Regression","80727953":"On average, those who defaulted on their loans had lower average annual salaries than those who did not default on their loans. This is contrary to the relationship between defaulting and bank balance. ","7aa0435d":"### Creating Models to Predict ","f60597a1":"The majority of bank balance values are normally distributed around $10,000 with a large blip near $0. This makes sense\u2014 some people do not have any savings. Determining if those with no savings are more likely to default is likely to reveal useful information.","5b8212df":"#### Linear Discriminant Analysis"}}