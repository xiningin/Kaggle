{"cell_type":{"62eedced":"code","8ddb7369":"code","fc34a58e":"code","231755ab":"code","e74687aa":"code","7c4c5ff0":"code","9d255163":"code","44678cec":"code","0114281f":"code","8838a687":"code","139a5e19":"code","a9947393":"code","1f6295be":"code","b2a5d114":"code","2996e76c":"code","65689b65":"code","bedbefb8":"code","8ccef752":"code","3e6799bb":"code","06013016":"code","99e6d35d":"code","09dae41f":"code","885373c1":"code","108be812":"code","001e9683":"code","f054fb47":"code","8b7247f2":"code","8842b931":"code","874b6845":"code","3bd4669e":"code","ac28f708":"code","942e200e":"markdown","36901311":"markdown","ff559dea":"markdown","ac099137":"markdown","5b876057":"markdown","9ae765c1":"markdown","4d3230e4":"markdown","65f691c2":"markdown","6bc0ea53":"markdown","e3bdc479":"markdown","f8893d57":"markdown","00fdd435":"markdown","fc28aacb":"markdown"},"source":{"62eedced":"import pandas as pd\nimport numpy as np\nimport matplotlib\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom scipy.stats import skewnorm\nfrom scipy.stats import norm\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import scale\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.kernel_ridge import KernelRidge\nfrom xgboost import XGBRegressor\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.metrics import mean_absolute_error\nfrom sklearn.metrics import mean_squared_error,r2_score\n\n%matplotlib inline","8ddb7369":"pop_dataset=pd.read_csv(\"..\/input\/world-population-by-year\/WorldPopulation.csv\",index_col='Year')\npop_dataset.head()","fc34a58e":"pop_dataset.shape","231755ab":"pop_dataset.info()","e74687aa":"pop_dataset.describe()","7c4c5ff0":"print(pop_dataset.isnull().sum())","9d255163":"RP=plt.figure(figsize=(10,10))\nfor i, feature in enumerate(pop_dataset.columns):\n    r=RP.add_subplot(3,2,i+1)\n    plt.hist(pop_dataset[feature])\n    r.set_title(feature+\" Histogram Plot\",color='DarkRed')\nRP.tight_layout()  ","44678cec":"RP=plt.figure(figsize=(10,10))\nfor i, feature in enumerate(pop_dataset.columns):\n    r=RP.add_subplot(3,2,i+1)\n    sns.distplot(pop_dataset[feature],rug=True,bins=10,fit=skewnorm,kde=False) #for normalising, used skewnorm\n    r.set_title(feature+\" Distribution\",color='DarkRed')\n    if(feature=='Population' or feature=='Urban'):\n        plt.yscale('log')\nRP.tight_layout()  ","0114281f":"RP=plt.figure(figsize=(10,10))\nfor i, feature in enumerate(pop_dataset.columns):\n    r=RP.add_subplot(3,2,i+1)\n    sns.distplot(pop_dataset[feature],rug=True,bins=10,fit=norm,kde=False) #for normalising, used skewnorm\n    r.set_title(feature+\" Distribution\",color='DarkRed')\n    if(feature=='Population' or feature=='Urban'):\n        plt.yscale('log')\nRP.tight_layout()  ","8838a687":"RP=plt.figure(figsize=(10,10))\nfor i, feature in enumerate(pop_dataset.columns):\n    r=RP.add_subplot(3,2,i+1)\n    sns.lineplot(pop_dataset.index,pop_dataset[feature])\n    r.set_title(feature+\" by Year\",color='DarkRed')\nRP.tight_layout()  ","139a5e19":"pop_correl=pop_dataset.corr()\nprint(pop_correl)","a9947393":"sns.heatmap(pop_correl,annot=True)","1f6295be":"plt.figure(figsize=(5,200))\nsns.heatmap(pop_dataset,annot=True,square=True)","b2a5d114":"sns.pairplot(pop_dataset)","2996e76c":"RP=plt.figure(figsize=(10,10))\nfor i, feature in enumerate(pop_dataset.columns):\n    r=RP.add_subplot(3,2,i+1)\n    plt.boxplot(pop_dataset[feature],data=pop_dataset)\n    r.set_title(feature,color='DarkRed')\nRP.tight_layout()  ","65689b65":"X=pop_dataset.drop(['Population','Urban','NetChange'],axis=1)\nX=pd.DataFrame(scale(X))\nX.index=pop_dataset.index\nY=pop_dataset['Population']\nX_train,X_test,Y_train,Y_test=train_test_split(X,Y,test_size=0.3,random_state=0)","bedbefb8":"model_LR=LinearRegression()\nmodel_LR.fit(X_train,Y_train)\nY_pred_LR=model_LR.predict(X_test)\nprint('Score:',model_LR.score(X_test,Y_test)*100)","8ccef752":"plt.scatter(X_test.index, Y_test, color = 'red')\nsns.lineplot(X_test.index,Y_pred_LR, color = 'blue')\nplt.title('World Population Prediction: Linear Regression')\nplt.xlabel('Year')\nplt.ylabel('Population')\nplt.show()","3e6799bb":"print('Mean Absolute Error:',mean_absolute_error(Y_test,Y_pred_LR))\nprint('Linear Regression Coefficients:',model_LR.coef_)\nprint('R2 Score:',r2_score(Y_test,Y_pred_LR))\nprint('Mean Square Error:',mean_squared_error(Y_test,Y_pred_LR))","06013016":"model_LGR=LogisticRegression()\nmodel_LGR.fit(X_train,Y_train)\nY_pred_LGR=model_LGR.predict(X_test)","99e6d35d":"plt.scatter(X_test.index, Y_test, color = 'red')\nsns.lineplot(X_test.index,Y_pred_LGR, color = 'blue')\nplt.title('World Population Prediction: Logistic Regression')\nplt.xlabel('Year')\nplt.ylabel('Population')\nplt.show()","09dae41f":"print('Mean Absolute Error:',mean_absolute_error(Y_test,Y_pred_LGR))\nprint('Linear Regression Coefficients:\\n',model_LGR.coef_)\nprint('R2 Score:',r2_score(Y_test,Y_pred_LGR))\nprint('Mean Square Error:',mean_squared_error(Y_test,Y_pred_LGR))","885373c1":"model_KR=KernelRidge(kernel='rbf', alpha=0.1, gamma=0.1)\nmodel_KR.fit(X_train,Y_train)\nY_pred_KR=model_KR.predict(X_test)\nprint('Score:',model_KR.score(X_test,Y_test)*100)","108be812":"plt.scatter(X_test.index, Y_test, color = 'red')\nsns.lineplot(X_test.index,Y_pred_KR, color = 'blue')\nplt.title('World Population Prediction: Kernel Ridge')\nplt.xlabel('Year')\nplt.ylabel('Population')\nplt.show()","001e9683":"print('Mean Absolute Error:',mean_absolute_error(Y_test,Y_pred_KR))\nprint('R2 Score:',r2_score(Y_test,Y_pred_KR))\nprint('Mean Square Error:',mean_squared_error(Y_test,Y_pred_KR))","f054fb47":"model_XGB = XGBRegressor(n_estimators=500, learning_rate=0.05)\nmodel_XGB.fit(X_train, Y_train, early_stopping_rounds=5, eval_set=[(X_test, Y_test)], verbose=False)\nY_pred_XGB=model_XGB.predict(X_test)\nprint('Score:',model_XGB.score(X_test,Y_test)*100)","8b7247f2":"plt.scatter(X_test.index, Y_test, color = 'red')\nsns.lineplot(X_test.index,Y_pred_XGB, color = 'blue')\nplt.title('World Population Prediction: XGBoost Regressor')\nplt.xlabel('Year')\nplt.ylabel('Population')\nplt.show()","8842b931":"print('Mean Absolute Error:',mean_absolute_error(Y_test,Y_pred_XGB))\nprint('R2 Score:',r2_score(Y_test,Y_pred_XGB))\nprint('Mean Square Error:',mean_squared_error(Y_test,Y_pred_XGB))","874b6845":"model_RFR = RandomForestRegressor(n_estimators=100, random_state=0)\nmodel_RFR.fit(X_train,Y_train)\nY_pred_RFR=model_RFR.predict(X_test)\nprint('Score:',model_RFR.score(X_test,Y_test)*100)","3bd4669e":"plt.scatter(X_test.index, Y_test, color = 'red')\nsns.lineplot(X_test.index,Y_pred_RFR, color = 'blue')\nplt.title('World Population Prediction: Random Forest Regressor')\nplt.xlabel('Year')\nplt.ylabel('Population')\nplt.show()","ac28f708":"print('Mean Absolute Error:',mean_absolute_error(Y_test,Y_pred_RFR))\nprint('R2 Score:',r2_score(Y_test,Y_pred_RFR))\nprint('Mean Square Error:',mean_squared_error(Y_test,Y_pred_RFR))","942e200e":"### Kernel Ridge","36901311":"# Data Description","ff559dea":"Population is directly related to Urban population and Urban population percent.\nAnd its obvious with the density (population per square km area) to increase with the increasing population.\nPopulation is almost inversely related to percentage change in population.","ac099137":"From the box-plot, Net change in population has a outlier. So, removing the feature for final model evaluation.\n\nSince, from the heat map and pair plot, it can be seen that urban percent and urban are highly correlated and also, the features almost caters same practical use, but since, urban percent is approximately normalized, so, removing urban in the feature column will prevent the model from overfitting.","5b876057":"# Models","9ae765c1":"No data missing in the given dataset.","4d3230e4":"### Logistic Regression","65f691c2":"### Random Forest Regressor","6bc0ea53":"Feature scaling is the process of normalising the range of features in a dataset. Real-world datasets often contain features that are varying in degrees of magnitude, range and units. Therefore, in order for machine learning models to interpret these features on the same scale, we need to perform feature scaling.","e3bdc479":"### XGBoost Regressor","f8893d57":"### Linear Regression","00fdd435":"#### Right skewed distribution:\nPopulation Distribution, Density Distribution, Urban Distribution\n#### Left skewed distribution:\nChange Percent Distribution, Net Change Distribution\n#### Approximately normal distribution:\nUrban Percentage Distribution","fc28aacb":"# Data Visualization"}}