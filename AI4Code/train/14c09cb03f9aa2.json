{"cell_type":{"0cb0a3c9":"code","679d54eb":"code","e0b58159":"code","8e003060":"code","bce9bc64":"code","a36c712c":"code","f4c4f0a4":"code","42628bd1":"code","b5c82382":"code","a448de06":"code","9376a586":"code","083a5192":"code","526a0b8c":"code","26ebed9a":"code","2ad734d5":"code","cb497938":"code","0d9262fd":"code","749b63d4":"code","98801e60":"code","90547a84":"code","bba3b810":"code","3e9f82a4":"code","f155d13f":"code","a2bbe07e":"code","5e158b0b":"code","148624b1":"code","c84844fe":"code","75eaef9e":"code","f05b5076":"code","dbfbfedc":"code","651986cb":"code","6374d438":"code","70d5d4d6":"code","28418d7d":"code","ee1341eb":"code","10fd04f5":"code","54a928cb":"code","09cda4ea":"code","d8791d1f":"code","5b9e3e80":"code","dad5abd9":"code","938f7698":"code","b3c5d3af":"code","f7e55d9e":"code","0bbb39b5":"code","3288ef15":"code","c908be93":"code","dec059fb":"code","46658487":"code","687c8235":"code","c430be49":"code","ce178e56":"code","3ddc566b":"code","d151466d":"code","0234d5cb":"markdown","3f8a8c58":"markdown","415ab7ac":"markdown","b279f250":"markdown","eb5c4591":"markdown","86ca3425":"markdown","2fd4efd8":"markdown","2b0e5ed3":"markdown","021b30a0":"markdown","f9bd5b38":"markdown","0a423cd0":"markdown","f3fac888":"markdown","713d3234":"markdown","7d89fbf3":"markdown","e1507685":"markdown","d5128bbd":"markdown","6f369bdf":"markdown","ebc9adcf":"markdown","e07d6d9c":"markdown","8a66f47b":"markdown","262e38e7":"markdown","fc255e2a":"markdown","990b0f5e":"markdown","55bcca4e":"markdown","d8334a65":"markdown","ef7a2e8d":"markdown","ff46f132":"markdown","109a3c69":"markdown"},"source":{"0cb0a3c9":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","679d54eb":"import seaborn as sns\nimport matplotlib.pyplot as plt\nfrom sklearn.preprocessing import StandardScaler","e0b58159":"train = pd.read_csv(\"..\/input\/ml-club-nits\/train.csv\") \ntrain","8e003060":"train.isnull().sum()","bce9bc64":"train=train.dropna()\ntrain.isnull().sum()","a36c712c":"train.info()","f4c4f0a4":"train[\"Gender\"].unique()","42628bd1":"from sklearn.preprocessing import OneHotEncoder\nfrom sklearn.preprocessing import LabelEncoder","b5c82382":"df_categories = train.select_dtypes(include=[object])\nprint(df_categories.head())\nprint(df_categories.columns)\nprint(df_categories.shape)","a448de06":"X_label = df_categories.apply(LabelEncoder().fit_transform)\nX_label.columns=[\"Gender_Label\"]\nprint(X_label.head())","9376a586":"X_1hot = OneHotEncoder().fit_transform(X_label).toarray()","083a5192":"df_1hot = pd.DataFrame(X_1hot)\ndf_1hot.columns=[\"Female\",\"Male\"]\ntrain= pd.concat([train.drop('Gender',axis=1), df_1hot], axis=1, sort=False)\nprint(train.head())","526a0b8c":"train.isnull().sum()\ntrain=train.dropna()\ntrain.isnull().sum()","26ebed9a":"del train['ID']\nplt.figure(figsize=(12,10))\ncor = train.corr()\nsns.heatmap(cor, annot=True, cmap=plt.cm.Reds)\nplt.show()","2ad734d5":"#Correlation with output variable\ncor_target = abs(cor[\"Dataset\"])\n#Selecting highly correlated features\nrelevant_features = cor_target[cor_target>0.15]\nrelevant_features","cb497938":"relevant_features.index[0:6]","0d9262fd":"sns.countplot(x ='Male', hue = \"Dataset\", data = train)\nplt.show()","749b63d4":"sns.countplot(x ='Female', hue = \"Dataset\", data = train,palette=\"Set2\")\nplt.show()","98801e60":"plt.figure(figsize=(6,8))\nage = sns.violinplot(x=\"Dataset\", y=\"Age\",data=train,hue=\"Male\")\nage = sns.swarmplot(x=\"Dataset\", y=\"Age\", data=train,hue=\"Male\", color=\"green\",alpha=0.6)","90547a84":"fig, ax = plt.subplots(1,1, figsize=(5,10), dpi=72)\nsns.scatterplot(data=train, x='Dataset', y='Total_Bilirubin', ax=ax)\nplt.show()","bba3b810":"fig, ax = plt.subplots(1,1, figsize=(5,10), dpi=72)\nsns.scatterplot(data=train, x='Dataset', y='Direct_Bilirubin', ax=ax)\nplt.show()","3e9f82a4":"sns.regplot(x=\"Direct_Bilirubin\", y=\"Total_Bilirubin\", data=train);","f155d13f":"from sklearn.ensemble import ExtraTreesClassifier","a2bbe07e":"X = pd.get_dummies(train.drop(columns=['Dataset']))\ny=train['Dataset'] \n\nmodel = ExtraTreesClassifier()\n#you can change algorithmn\nmodel.fit(X,y)\nprint(model.feature_importances_) \n\nfeat_importances = pd.Series(model.feature_importances_, index=X.columns)\nfeat_importances.plot(kind='barh')\n\nplt.show()","5e158b0b":"feat_importances.nlargest(8).plot(kind='barh')\n#select top 8 feature\nplt.show()","148624b1":"feature=feat_importances.nlargest(8).index\nfeature","c84844fe":"from sklearn.model_selection import train_test_split","75eaef9e":"X = train[feature]\nX","f05b5076":"y=train['Dataset'] \ny","dbfbfedc":"X_train, X_test, y_train, y_test = train_test_split( X, y, test_size=0.2, random_state=20,shuffle=True)","651986cb":"test=pd.read_csv('..\/input\/ml-club-nits\/test.csv')\n\nX_test_data=test[feature]\n\n","6374d438":"from sklearn.linear_model import LogisticRegression\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.metrics import classification_report, confusion_matrix\nfrom sklearn import metrics\nfrom sklearn.model_selection import GridSearchCV","70d5d4d6":"lr = LogisticRegression()\nlr.fit(X_train, y_train)\ny_pred_lr=lr.predict(X_test)\nprint('the accuracy of Test data is:',accuracy_score(y_test,y_pred_lr)*100,'%')","28418d7d":"print(confusion_matrix(y_test,y_pred_lr))\nprint(classification_report(y_test,y_pred_lr))","ee1341eb":"y_lr=lr.predict(X_test_data)\ny_lr","10fd04f5":"test['Dataset'] = y_lr\nlr_csv = test[['ID','Dataset']]\nlr_csv.head()\nlr_csv.to_csv('.\/lr_submit.csv', index = False)","54a928cb":"from sklearn.neighbors import KNeighborsClassifier","09cda4ea":"leaf_size = list(range(1,50))\nn_neighbors = list(range(1,30))\np=[1,2]\n#Convert to dictionary\nhyperparameters = dict(leaf_size=leaf_size, n_neighbors=n_neighbors, p=p)\n#Create new KNN object\nknn_2 = KNeighborsClassifier()\n#Use GridSearch\nclf = GridSearchCV(knn_2, hyperparameters, cv=10)\n#Fit the model\nbest_model = clf.fit(X,y)\n#Print The value of best Hyperparameters\nprint('Best leaf_size:', best_model.best_estimator_.get_params()['leaf_size'])\nprint('Best p:', best_model.best_estimator_.get_params()['p'])\nprint('Best n_neighbors:', best_model.best_estimator_.get_params()['n_neighbors'])","d8791d1f":"knn= KNeighborsClassifier(n_neighbors=17)\nknn.fit(X_train, y_train)\ny_pred_knn=knn.predict(X_test)\nprint('the accuracy of Test data is:',accuracy_score(y_test,y_pred_knn)*100,'%')","5b9e3e80":"print(confusion_matrix(y_test,y_pred_knn))\nprint(classification_report(y_test,y_pred_knn))","dad5abd9":"y_knn=knn.predict(X_test_data)\ny_knn","938f7698":"test['Dataset'] = y_knn\nknn_csv = test[['ID','Dataset']]\nknn_csv.head()\nknn_csv.to_csv('.\/knn_submit.csv', index = False)","b3c5d3af":"from sklearn.ensemble import RandomForestClassifier","f7e55d9e":"rf=RandomForestClassifier()\nrf.fit(X_train,y_train)\nprint('the accuracy of Test data is:',accuracy_score(y_test,rf.predict(X_test))*100,'%')","0bbb39b5":"print(confusion_matrix(y_test,rf.predict(X_test)))\nprint(classification_report(y_test,rf.predict(X_test)))","3288ef15":"y_rf=rf.predict(X_test_data)\ny_rf","c908be93":"test['Dataset'] = y_rf\nrf_csv = test[['ID','Dataset']]\nrf_csv.head()\nrf_csv.to_csv('.\/rf_submit.csv', index = False)","dec059fb":"from sklearn.svm import SVC","46658487":"svclassifier = SVC(kernel='linear')\nsvclassifier.fit(X_train, y_train)\ny_pred_svm=svclassifier.predict(X_test)\nprint('the accuracy of Test data is:',accuracy_score(y_test,y_pred_svm)*100,'%')","687c8235":"print(confusion_matrix(y_test,y_pred_svm))\nprint(classification_report(y_test,y_pred_svm))","c430be49":"X_test_data.shape","ce178e56":"X_train.shape","3ddc566b":"y_svm=svclassifier.predict(X_test_data)\ny_svm","d151466d":"test['Dataset'] = y_svm\nsvm_csv = test[['ID','Dataset']]\nsvm_csv.head()\nsvm_csv.to_csv('.\/svm_submit.csv', index = False)","0234d5cb":"From graph, Dataset = 1 If Male get older has a chance to get liver disease more than Female , but mean age of Dataset 1 and Dataset2 not much different. Maybe age not have much effect to liver disease","3f8a8c58":"Male or Female has a chance to get liver disease.\n\n\nDataset 1 = yes  2 = no","415ab7ac":"Heat map","b279f250":"If get older, will  get liver disease easily ? and I want to see age distribution","eb5c4591":"Total_Bilirubin will have effect to get liver disease?","86ca3425":"\"You have to predict whether the patient has a liver disease or not. Here 1 means yes and 2 means no.\"\nthat mean you have to predict \"Dataset\" column is 1 or 2","2fd4efd8":"# Import data","2b0e5ed3":"# SVM","021b30a0":"real test data","f9bd5b38":"real test data","0a423cd0":"real test data","f3fac888":"if you have high Total_Bilirubin you will have a chance to get liver disease easily","713d3234":"Male has a chance to get liver disease more than Female","7d89fbf3":"# Feature selection","e1507685":"test data","d5128bbd":"# LOGISTIC REGRESSION","6f369bdf":"From heat map you can see Direct_Bilirubin and Total_Bilirubin have high correlation, I will plot linear graph to show you","ebc9adcf":"1 = Male 0 = Female","e07d6d9c":"# Modeling","8a66f47b":"one hot encoding Gender column","262e38e7":"real test data","fc255e2a":"# KNN","990b0f5e":"# Clean data","55bcca4e":"# Analyst and visualize data","d8334a65":"if you have high Direct_Bilirubin you will have a chance to get liver disease easily","ef7a2e8d":"Direct_Bilirubin  will have effect to get liver disease?","ff46f132":"find best parameter","109a3c69":"# Random Forest Classifier"}}