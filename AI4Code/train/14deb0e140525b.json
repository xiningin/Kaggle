{"cell_type":{"dfe0a5d9":"code","a0e67a36":"code","e29b51f8":"code","e0098e58":"code","40e128fe":"code","e0314e63":"code","823ebded":"code","488ebfbb":"code","6fcae436":"code","a934fb2f":"code","f5152b6f":"code","0bd82022":"code","6eaded5e":"code","d0e166dd":"code","ab5c8651":"code","c1fcbf0a":"code","d9d3a744":"code","26c3bbfe":"code","60831fc6":"code","99192590":"code","6ba3f060":"code","67edd4a0":"code","13f01936":"code","eea9c756":"code","d99d0346":"code","c67165c1":"code","f41584ba":"code","4bfe5cdc":"code","e76be2c4":"code","760f0095":"code","811e9639":"code","b56272be":"code","8e59e5e8":"code","7ec16533":"code","1bd0351b":"code","9e2d9d85":"code","7a40d995":"code","09b6baff":"code","89555142":"code","e7287a4e":"code","6c25fd7b":"code","bc15c048":"code","544fc26f":"code","ea9d56ed":"code","dd4e4397":"code","c0db173f":"code","d752f334":"code","3c6be109":"code","0f60db7c":"code","50bf7fe7":"markdown","3e943588":"markdown","045b126a":"markdown","572755ab":"markdown","bfa4cdf3":"markdown","ca99fac2":"markdown","72ac38d1":"markdown","4d61caee":"markdown","8be977ef":"markdown"},"source":{"dfe0a5d9":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","a0e67a36":"dfp= pd.read_csv('..\/input\/quantium-data-analytics-virtual-experience-program\/PurchaseBehaviour.csv')\ndft= pd.read_csv('..\/input\/quantium-data-analytics-virtual-experience-program\/Transactions.csv')","e29b51f8":"dfp.head()","e0098e58":"dft.head()","40e128fe":"len(dft)-len(dft.drop_duplicates())","e0314e63":"len(dfp)-len(dfp.drop_duplicates())","823ebded":"dft_unique=dft.drop_duplicates()","488ebfbb":"dft_unique.describe()","6fcae436":"dfp.describe()","a934fb2f":"dft_unique.isna().sum()","f5152b6f":"dfp.isna().sum()","0bd82022":"base_date = pd.Timestamp('1901-01-01')  \ndates = [\n    base_date + pd.DateOffset(dft['DATE'][i]) \n    for i in range(len(dft['DATE']))\n]\n\nprint(dates[0:5])","6eaded5e":"dft['DATE']=dates\ndft['DATE'].head()","d0e166dd":"dft['DATE']=dft['DATE'].dt.date","ab5c8651":"dft['DATE'].head()","c1fcbf0a":"noncommon = dft_unique[~dft_unique.LYLTY_CARD_NBR.isin(dfp.LYLTY_CARD_NBR)]","d9d3a744":"len(noncommon)","26c3bbfe":"merged_df = pd.merge(left=dfp, right=dft, how='outer', left_on='LYLTY_CARD_NBR', right_on='LYLTY_CARD_NBR')","60831fc6":"merged_df.head()","99192590":"merged_df.tail()","6ba3f060":"merged_df.shape","67edd4a0":"merged_df.isna().sum()","13f01936":"import re","eea9c756":"def _removeNonAscii(s):\n    return \"\".join(i for i in s if  ord(i)<128)\ndef punctuation(s):\n    return re.sub(r'[^\\w\\s]', '', s)","d99d0346":"merged_df['PROD_NAME']=merged_df['PROD_NAME'].apply(_removeNonAscii)\nmerged_df['PROD_NAME']=merged_df['PROD_NAME'].apply(punctuation)","c67165c1":"merged_df['PROD_NAME_1'] = merged_df['PROD_NAME'].str.replace('\\d+','')","f41584ba":"from collections import Counter\nCounter(\" \".join(merged_df['PROD_NAME_1']).split()).most_common(50)","4bfe5cdc":"merged_df['Last'] = merged_df['PROD_NAME'].str.strip().str[-1]","e76be2c4":"merged_df['Last'].value_counts()","760f0095":"merged_df['PROD_SIZE']=merged_df['PROD_NAME'].str.extract('(\\d+)')","811e9639":"merged_df.PROD_SIZE=merged_df.PROD_SIZE.astype('int64')","b56272be":"merged_df=merged_df.drop('PROD_NAME',axis=1)","8e59e5e8":"chip_words=['Chip','Chips','Tortilla','Crisp','Twisties']","7ec16533":"merged_df['PROD_QTY'].min()","1bd0351b":"merged_df['PROD_QTY'].max()","9e2d9d85":"merged_df[merged_df['PROD_QTY']==200]","7a40d995":"merged_df =merged_df[merged_df['PROD_QTY'] !=200]","09b6baff":"def convertsize(number):\n    if number < 100:\n        return 'Small'\n    if number >= 100 and number < 200:\n        return 'Medium'\n    if number >= 200:\n        return 'Large'","89555142":"merged_df['PROD_SIZE']=merged_df['PROD_SIZE'].apply(convertsize)","e7287a4e":"merged_df.groupby(by='PROD_SIZE')['PREMIUM_CUSTOMER'].value_counts()","6c25fd7b":"import matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set(rc={'figure.figsize':(20, 20)})\n","bc15c048":"date_df=merged_df\n","544fc26f":"date_df.set_index('DATE')","ea9d56ed":"sns.set(rc={'figure.figsize':(10, 5)})\ndate_df.groupby('LIFESTAGE').TOT_SALES.sum().plot(kind='bar')","dd4e4397":"sns.set(rc={'figure.figsize':(10, 5)})\ndate_df.groupby('PREMIUM_CUSTOMER').TOT_SALES.sum().plot(kind='bar')","c0db173f":"pd.pivot_table(merged_df, values='TOT_SALES', index=['PREMIUM_CUSTOMER'],\n                    columns=['LIFESTAGE'], aggfunc=np.sum)","d752f334":"merged_df.groupby(by='PREMIUM_CUSTOMER')['PROD_NAME_1'].value_counts()","3c6be109":"fig, ax = plt.subplots(figsize=(20,8))\nsns.histplot(binwidth=0.5, x=\"LIFESTAGE\", hue=\"PREMIUM_CUSTOMER\", data=merged_df, stat=\"count\", multiple=\"stack\")","0f60db7c":"import matplotlib.pyplot as plt\nimport seaborn as sns\n\ndate_df.groupby('DATE').TOT_SALES.sum().plot(kind='line')","50bf7fe7":"No Empty values and no duplicates. We can merge the dataset now. ","3e943588":"They're both bought by the same customer. Looks like a wholesale customer. We can omit this data","045b126a":"Sales peak during December. This could be because of Christmas.\n","572755ab":" Converting Date time to just Time ","bfa4cdf3":"There is one duplicate. We will remove it","ca99fac2":"No duplicates in this table","72ac38d1":"#### convert date to date format from int\n\n","4d61caee":"'g' is the most common because it appears in every product to indicate it's size","8be977ef":"The highest proportion of mainstream customers come from young families, which could be because they earn not too much and might be just starting out in careers. "}}