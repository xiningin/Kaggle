{"cell_type":{"850016e2":"code","8879c174":"code","1d8b29bd":"code","545c926e":"code","fb7b6b3d":"code","821a89d1":"code","6abf4e21":"code","c3891703":"code","5ad53de0":"code","e7a77b8d":"code","e95cc8f7":"code","09648677":"code","0c59037e":"code","e3e0bfde":"code","b2746144":"markdown","856e1aad":"markdown"},"source":{"850016e2":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport re\nimport matplotlib.pyplot as plt\nplt.style.use('ggplot')\nimport matplotlib.cm as cm\n\n#------------------------------------------------------------------\n# Functions used in this exercise\n# Note: There is probably much better way in separating the player name and country from player.\n# Since the primary objective is to analyze the data, I'm compromising the elegancy \ndef get_player_name( player):\n    vals = re.findall(r'\\((.*?)\\)', player)\n    name = player\n    for v in vals:\n        to_rep = '(' + v + ')'\n        name = name.replace(to_rep, '')\n\n    return name\n\ndef get_country( player):\n    vals = re.findall(r'\\((.*?)\\)', player)\n    country = vals[-1]\n    if 'ICC' in country and len(country.split('\/')) == 2: # If a player played for his country and ICC, then ignore ICC\n        country = country.replace('ICC','').replace('\/','')\n    return country\n#------------------------------------------------------------------\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Read the data in\nprint (\"Reading the data...\")\ndf = pd.read_csv('\/kaggle\/input\/icc-test-cricket-runs\/ICC Test Batting Figures.csv', encoding='ISO-8859-1')\nprint (\"Done\")\n\n# preview the data\ndf.head()\n\n","8879c174":"# Drop the player profile column.. No use\n\ndf.drop('Player Profile', axis=1, inplace=True)\n\n# Player contains the player name and country\n# Create 2 new columns with just player name and country\n\ndf['Name'] = df['Player'].apply(get_player_name)\ndf['Country'] = df['Player'].apply(get_country)\n\n# Look at the number of players by country\ndf.groupby('Country').count()\n\n","1d8b29bd":"# hhmm there are some players played for multiple countries\n# Lets add another column to store the number of countries\ndf['NumCountries'] = df['Country'].apply(lambda x: len(x.split('\/')))\n\n# Did someone play for more than 2 countries?\nprint (\"Number of Countries\")\nprint (df.NumCountries.value_counts())","545c926e":"# Who played for more than 1 country?\nprint (df.loc[ df['NumCountries'] > 1 , ['Player', 'Mat'] ])\n\n","fb7b6b3d":"# Out of 3001 players, 15 played for multiple countries. That is 0.5% Small number.. Delete these players\ndf.drop( df[ df['NumCountries'] > 1 ].index, inplace=True )","821a89d1":"# Lets do some charting\n\n# How many players per country?\n\nplayers_by_country =  df.groupby('Country')['Player'].count()\n\nplt.xticks(rotation='vertical')\nplt.bar(x = players_by_country.index,height=players_by_country.values)\nplt.show()","6abf4e21":"# Look at the column types\ndf.dtypes","c3891703":"# Remove * in HS. This indicates the batsman was not-out..\ndf['HS'] = df['HS'].str.replace('*','')\n\n# Inn, NO, Runs, HS, Avg, 100, 50, 0 are object.. Convert them to numeric... Some players have not scored any runs or does not\n# have avergage.. Convert them to NaN using 'coerce'\n\nfor col in ['Inn', 'NO', 'Runs', 'Avg', 'HS', '100', '50', '0']:\n    df[col] = pd.to_numeric(df[col], errors='coerce')\n\n    \n# Now look at the types\ndf.dtypes\n","5ad53de0":"df","e7a77b8d":"# Span contains the range of the year in which the player played\n# Create new columns From\/To store the debut year and retired\/finally dropped from the team year\n\ndf = pd.concat(\n    [\n        df,\n        df['Span'].apply(\n            lambda x:\n                pd.Series(\n                    {\n                        'From' : int(x.split('-')[0]),\n                        'To' : int(x.split('-')[1])\n                    }\n                )\n        )\n    ],\n    axis=1)\n\ndf.head()\n","e95cc8f7":"# Create a column to store the number of years the player was active\ndf['SpanYears'] = df['To'] - df['From']\n\ndf.head()","09648677":"# Which player had longest career\n\nprint (\"Player with longest career\")\n\n# Using this approach instead of idxmax so we can identify if there are more than 1 player with long career\ndf[\n    ['Player', 'Span']\n][\n    df['SpanYears'] == df['SpanYears'].max()\n]","0c59037e":"# Who had more number of ducks (0)\n\nprint (\"Player with most ducks\")\ndf[\n    ['Player', 'Inn', 'Runs', '0']\n][\n    df['0'] == df['0'].max()\n]\n\n# No surprise who that player is.. But he is a great bowler and gentleman though","e3e0bfde":"# Who coverts 50s to 100s more often\n# For this create a new data frame which has players who scored more than 1000 runs\n# to avoid cases where tail enders or players who have not played many matches scoring 1 or 2 100s by luck\n\n\ngp = df.drop( df[ df['Runs'] < 1000 ].index )\ngp['100To50'] = gp['100'] \/ gp['50']\n\nprint (\"Player who converts more 50s to 100s\")\ngp[\n    ['Player', 'Inn', 'Runs', '100', '50', '100To50']\n][\n    gp['100To50'] == gp['100To50'].max()\n].sort_values('Runs', ascending=True)","b2746144":"I remember Kepler Wessels, Rankin and Traicos.. It happened in my lifetime !!!!","856e1aad":"Ofcourse, Eng has more players as they played from early and they play a lot"}}