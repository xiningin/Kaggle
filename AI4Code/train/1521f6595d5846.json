{"cell_type":{"0e8d1040":"code","786983f3":"code","86e828c6":"code","dd36972c":"code","a654b989":"code","3cf5865f":"code","9ea59259":"code","591a2c1a":"code","c2a81fc7":"code","dd466c09":"code","23921e8c":"code","78636553":"code","4fd9eae4":"code","214647f2":"code","c475262e":"code","9a32835e":"code","c7d8a78e":"code","98f35aa0":"code","dc23e77d":"code","602da443":"code","5a041675":"code","1e2e0583":"code","e57e65f5":"code","e2eaedec":"code","213eef8e":"code","e289b599":"code","7fa71e6c":"code","f54af770":"code","65c68844":"code","6f700f14":"code","1642274d":"code","8cbafc40":"code","56c0007c":"code","837ab6d5":"code","b47d8f08":"code","ae4c5143":"code","fc2fd853":"code","d5eee532":"code","f3db1ec3":"code","eb293250":"markdown","64815eac":"markdown","300b5a9e":"markdown","87f25da6":"markdown","8485aae2":"markdown","2bb950c1":"markdown","3581d608":"markdown","0b3004ea":"markdown","821dffc6":"markdown","fee967f2":"markdown","df5a6b54":"markdown","72ed6593":"markdown","00d48925":"markdown","1a9e0632":"markdown","4864b02c":"markdown","2be79f1c":"markdown","2e1541a5":"markdown","126b22ff":"markdown","1f9aee54":"markdown","b3851423":"markdown","d4467e6a":"markdown"},"source":{"0e8d1040":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns","786983f3":"df = pd.read_csv('\/kaggle\/input\/telecom-users-dataset\/telecom_users.csv')\nprint(df.shape)\ndf.head()","86e828c6":"df.info()","dd36972c":"df = df.drop(['Unnamed: 0', 'customerID'], axis=1)\ndf = df.replace('No', 0)\ndf = df.replace('Yes', 1)\ndf = df.replace('No internet service', 0)","a654b989":"df.head()","3cf5865f":"df['InternetService'].value_counts()","9ea59259":"df['InternetService'] = df['InternetService'].replace('Fiber optic', 2)\ndf['InternetService'] = df['InternetService'].replace('DSL', 1)","591a2c1a":"df['Contract'].value_counts()","c2a81fc7":"df['Contract'] = df['Contract'].replace('Two year', 24)\ndf['Contract'] = df['Contract'].replace('One year', 12)\ndf['Contract'] = df['Contract'].replace('Month-to-month', 1)","dd466c09":"df['PaymentMethod'].value_counts()","23921e8c":"df['PaymentMethod'] = df['PaymentMethod'].replace('Electronic check', 1)\ndf['PaymentMethod'] = df['PaymentMethod'].replace('Mailed check', 2)\ndf['PaymentMethod'] = df['PaymentMethod'].replace('Bank transfer (automatic)', 3)\ndf['PaymentMethod'] = df['PaymentMethod'].replace('Credit card (automatic)', 4)\n\ndf['MultipleLines'] = df['MultipleLines'].replace('No phone service', 0)","78636553":"df['gender'] = df['gender'].replace('Male', 1)\ndf['gender'] = df['gender'].replace('Female', 0)","4fd9eae4":"df['MultipleLines'] = df['MultipleLines'].astype(int)\ndf['MonthlyCharges'] = df['MonthlyCharges'].astype(int)\ndf['TotalCharges'] = df['TotalCharges'].astype(str)","214647f2":"df['TotalCharges'] = df['TotalCharges'].replace(' ', 0)\ndf['TotalCharges'] = df['TotalCharges'].astype(float)\ntotal_charge = df['TotalCharges']","c475262e":"for i in range(0, len(df)-1):\n    total_charge[i] = int(total_charge[i])\ndf['TotalCharges'] = df['TotalCharges'].astype(int)","9a32835e":"df.head()","c7d8a78e":"df.info()","98f35aa0":"sns.barplot(x='Partner', y='MonthlyCharges', data=df)","dc23e77d":"sns.barplot(x='Contract', y='MonthlyCharges', data=df)\nplt.ylabel('Charge')","602da443":"sns.barplot(x='SeniorCitizen', y='MonthlyCharges', data=df)\nplt.xlabel('Non senior - Senior')","5a041675":"sns.barplot(x='InternetService', y='MonthlyCharges', data=df)\nplt.xlabel('No Internet - DSL - Fiber optic')","1e2e0583":"corr = df.corr()","e57e65f5":"plt.figure(figsize=(30,10))\nsns.heatmap(corr, cmap='coolwarm', annot = True)\nplt.show()","e2eaedec":"corr[abs(corr['Churn']) > 0.1].index","213eef8e":"df = df[['SeniorCitizen', 'Partner', 'Dependents', 'tenure', 'InternetService',\n       'OnlineSecurity', 'TechSupport', 'Contract', 'PaperlessBilling',\n       'PaymentMethod', 'MonthlyCharges', 'TotalCharges', 'Churn']]","e289b599":"from sklearn.model_selection import train_test_split\nfrom sklearn.metrics import classification_report\nfrom sklearn import metrics","7fa71e6c":"x = df.drop(['Churn'], axis=1)\ny = df['Churn']","f54af770":"x.shape, y.shape","65c68844":"x_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.2, random_state=42)","6f700f14":"from sklearn.linear_model import LogisticRegression\nlogistic = LogisticRegression()\nlogistic.fit(x_train, y_train)\nprediction_lr = logistic.predict(x_test)\nprint(classification_report(y_test,prediction_lr))\nmetrics.plot_roc_curve(logistic, x_test, y_test)","1642274d":"from sklearn.tree import DecisionTreeClassifier\ntree = DecisionTreeClassifier()\ntree.fit(x_train, y_train)\nprediction_dt = tree.predict(x_test)\nprint(classification_report(y_test, prediction_dt))\nmetrics.plot_roc_curve(tree, x_test, y_test)","8cbafc40":"from sklearn.ensemble import RandomForestClassifier\nforest = RandomForestClassifier()\nforest.fit(x_train, y_train)\nprediction_rf = forest.predict(x_test)\nprint(classification_report(y_test, prediction_rf))\nmetrics.plot_roc_curve(forest, x_test, y_test) ","56c0007c":"import keras\nfrom keras.layers import Dense\nfrom keras.models import Sequential\nfrom keras.layers import Dropout","837ab6d5":"x.shape","b47d8f08":"model = Sequential([\n    Dense(32, activation='relu', input_dim=12),\n    Dropout(0.5),\n    Dense(16, activation='relu'),\n    Dense(1, activation='sigmoid')\n])\nmodel.compile(optimizer='adam', loss='mean_squared_error', metrics=['accuracy'])\nmodel.summary()","ae4c5143":"history = model.fit(x_train, y_train, batch_size=10, epochs=200,verbose=2)","fc2fd853":"print(history.history.keys())","d5eee532":"plt.plot(history.history['accuracy'], label='Accuracy', color='blue')\nplt.plot(history.history['loss'], label='Loss', color='red')\nplt.legend()","f3db1ec3":"prediction_nn = model.predict(x_test)\nprediction_nn = [1 if y>=0.5 else 0 for y in prediction_nn]\nprint(classification_report(y_test, prediction_nn))","eb293250":"<img src=\"https:\/\/media.giphy.com\/media\/jV4wbvtJxdjnMriYmY\/giphy.gif\">","64815eac":"**ARTIFICIAL NEURAL NETWORK**","300b5a9e":"**Payment Method:**\n* 'Electronic Check' = 1\n* 'Mailed Check' = 2\n* 'Bank Transfer' = 3\n* 'Credit Card' = 4","87f25da6":"**DECISION TREE**","8485aae2":"I will not be looking each column one by one. I will choose the most correlated ones and use them in my models.","2bb950c1":"Also as you can see on the above, we can change the *contract*, *internet service* and *payment method* types as well without changing column purpose. I labeled them accordingly so I will be showing these labels when we are visualizing the data.","3581d608":"And finally, I do think that montly and total charge values can be integers. They are determinant factors but their fraction values are not that important.","0b3004ea":"We achieved around %80 accuracy with different models. If we do some feature engineering after the preprocess maybe we can increase the accuracy little bit more.","821dffc6":"# TELECOMMUNICATION","fee967f2":"**LOGISTIC REGRESSION**","df5a6b54":"# Simple Data Analysis","72ed6593":"**Contract:**\n* 'Month-to-month' = 1\n* 'Two Year' = 24\n* 'One Year' = 12","00d48925":"# Prediction","1a9e0632":"* Data has no null variables so that is great.\n* We do not need some of these columns in both data analysis and prediction approaches.\n* Also 'Yes' and 'No' is not ideal to have a classification model so I will change them to 1 = 'Yes' and 0 = 'No'.","4864b02c":"# Data Preprocess","2be79f1c":"This is it for this notebook. I hope you like it. If you do, upvotes are welcomed. Take care.","2e1541a5":"**RANDOM FOREST**","126b22ff":"* Having a partner or not having a partner does not effect the monthly charges that much, the effect is very minimal.\n* Contract year effects monthly costs. The contract with the most length has the lowest prices because of the commitment of the customer.\n* Senior citizens pays more than non senior citizens. That might be because younger people use more internet so their contracts have more throughput.\n* Fiber optic is the fastest and most reliable internet right now. It is not surprise that it is the most expensive one.","1f9aee54":"Now the data is ready. Every column is in integer form.\nI will be looking for correlations of the columns with the *Churn* and if I find any uncorrelated columns I will drop them.","b3851423":"<img src=\"https:\/\/media.giphy.com\/media\/xUPOqo6E1XvWXwlCyQ\/giphy.gif\">","d4467e6a":"**Internet service:**\n* Fiber optic = 2\n* DSL = 1"}}