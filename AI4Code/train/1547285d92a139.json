{"cell_type":{"d8bd98bd":"code","918a8b85":"code","c78bc336":"code","4bc87fce":"code","3c941892":"code","02d0f50a":"code","a6f3041c":"code","00266d3d":"code","166c4b74":"code","415f193b":"code","98ff694b":"code","15bf8191":"code","9728f62c":"code","e622010b":"code","4fb61112":"code","30b3b14b":"code","aeccb7f6":"code","df49767a":"code","4b7b995d":"code","8c1c1a68":"code","c648ca9a":"code","a1184a8f":"code","2852a661":"markdown","49caca0e":"markdown","db0c59b6":"markdown","02befcc8":"markdown","6db8e7fc":"markdown","a86203cf":"markdown","1078810c":"markdown","48a09953":"markdown","0a3ce6f5":"markdown","ddb18a31":"markdown","310bbf29":"markdown","bda9b88a":"markdown","d8d97f78":"markdown","245141ec":"markdown","3880f79b":"markdown","a492fb19":"markdown","b5aad9ed":"markdown","5d02ccea":"markdown","d65cf368":"markdown","aa8ac0c5":"markdown","85ed1fe1":"markdown"},"source":{"d8bd98bd":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.preprocessing import StandardScaler,PolynomialFeatures\n%matplotlib inline","918a8b85":"data = pd.read_csv('\/kaggle\/input\/housesalesprediction\/kc_house_data.csv')","c78bc336":"data.head(5)","4bc87fce":"data.dtypes","3c941892":"data.drop([\"id\",\"date\"], axis=1, inplace=True)","02d0f50a":"data.isnull().sum()","a6f3041c":"data.describe()","00266d3d":"f, axes = plt.subplots(1, 2,figsize=(15,5))\nsns.boxplot(x=\"bedrooms\", y=\"price\", data=data, ax=axes[0])\nsns.boxplot(x=\"bathrooms\", y=\"price\", data=data, ax=axes[1])\nf, axes = plt.subplots(1, 2,figsize=(15,5))\nsns.boxplot(x=\"floors\", y=\"price\", data=data, ax=axes[0])\nsns.boxplot(x=\"waterfront\", y=\"price\", data=data, ax=axes[1])\nf, axes = plt.subplots(1, 2,figsize=(15,5))\nsns.boxplot(x=\"view\", y=\"price\", data=data, ax=axes[0])\nsns.boxplot(x=\"grade\", y=\"price\", data=data, ax=axes[1])","166c4b74":"sns.regplot(x=\"sqft_living\", y=\"price\", data=data)","415f193b":"data['bedrooms'].value_counts().plot(kind='bar')\nplt.title('Number of Bedrooms')\nplt.xlabel('Bedrooms')\nplt.ylabel('Count')","98ff694b":"corrmat = data.corr()\nf, ax1 = plt.subplots(figsize=(12,9))\n\nax1=sns.heatmap(corrmat,vmax = 0.8);","15bf8191":"corrmat = data.corr()\nf, ax1 = plt.subplots(figsize=(12,9))\n\nax1=sns.heatmap(corrmat,vmax = 0.8,annot = True);","9728f62c":"from sklearn.linear_model import LinearRegression\nlm = LinearRegression()","e622010b":"x_data = data.drop('price',axis=1)\ny_data = data['price']","4fb61112":"from sklearn.model_selection import train_test_split\n\nx_train, x_test, y_train, y_test = train_test_split(x_data, y_data, test_size=0.3, random_state=1)\n\nprint(\"Number of test samples :\", x_test.shape[0])\nprint(\"Number of training samples:\",x_train.shape[0])","30b3b14b":"lm.fit(x_train,y_train)","aeccb7f6":"lm.score(x_test,y_test)","df49767a":"lm.intercept_","4b7b995d":"lm.coef_","8c1c1a68":"from sklearn import ensemble\nclf = ensemble.GradientBoostingRegressor(n_estimators=400, max_depth=5, min_samples_split=2, \n                                         learning_rate=0.1, loss='ls')","c648ca9a":"clf.fit(x_train,y_train)","a1184a8f":"clf.score(x_test,y_test)","2852a661":"Next, we check whether there are missing values in our data.","49caca0e":"70% of the data will be used as our training data, while 30% will be our test data. We randomize the splitting of the data using random_state.","db0c59b6":"### Multiple Linear Regression","02befcc8":"We look at the first 5 columns of the dataframe to know how it looks like. Then, we display the data types of each column.","6db8e7fc":"We use multiple linear regression to predict the price. We set price as our criterion variable (y_data) and all the other features except price as our predictors (x_data).","a86203cf":"## Importing Data","1078810c":"## Data Wrangling","48a09953":"Now, we explore the correlation between different features.","0a3ce6f5":"Using the function regplot, we can see that the feature \"sqft_living\" has a positive correlation with \"price\".","ddb18a31":"We drop the columns \"id\" and \"date\".","310bbf29":"First, we import the packages that we will be using. Then, we import our dataset.","bda9b88a":"Since there are no missing values in all columns, then we proceed to obtain the statistical summary of our data to examine their averages and other relevant values.","d8d97f78":"The accuracy of the new model is now at **89%**\u2014a lot better than the first one!","245141ec":"Let's take a closer look by examining their correlation coefficients.","3880f79b":"In the graph below, we could see that the most commonly sold houses are those having 3 bedrooms.","a492fb19":"## Model Development","b5aad9ed":"In the boxplots below, we could infer that bedrooms, bathrooms, waterfront, and grade have effect on price. View has also an effect on price but only less, while floors has no effect at all.","5d02ccea":"### Gradient Boosting Regression","d65cf368":"## Exploratory Data Analysis","aa8ac0c5":"The accuracy of the model is only at **69%**.","85ed1fe1":"Since we want higher accuracy, we try to use a different method. We will now use gradient boosting regression."}}