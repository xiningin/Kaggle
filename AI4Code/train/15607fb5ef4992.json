{"cell_type":{"fccd3111":"code","a3c58f27":"code","503d0caa":"code","1e61f04a":"code","f8204028":"code","c729101c":"code","35cf29b9":"code","34a9f5d5":"code","68bea024":"code","3ebbc7e6":"code","7054534c":"code","c727d7da":"code","a95b3d9d":"code","50b434f5":"code","678132b5":"code","48551f34":"code","b7616309":"code","27724896":"code","40e5aba0":"code","90f6ade4":"code","81859af9":"code","07967d2a":"code","4c5ca42e":"code","2c7c7d46":"code","0ba4afe1":"code","77dd6983":"code","6c417e4e":"code","5346e4f4":"code","c7ad1e12":"code","3e9ab1ca":"code","3bbaf0de":"code","8043ca1b":"code","c078ef50":"code","6ef5e997":"code","d89dd4fa":"code","5806b9ad":"code","774819cd":"code","141178a7":"code","0b07bb0e":"code","2beede9e":"code","c1558a4c":"code","c2ada149":"code","0dde80fb":"code","45ea8b57":"code","ad38b8de":"code","763e0c01":"code","87cf79e7":"code","b654ce13":"code","da167115":"code","1fc43e22":"code","511eb0be":"code","9a151382":"code","dc5b11ac":"code","04962c9d":"code","d353d88e":"code","2892669c":"code","2c372912":"code","0fa8df61":"code","4bf0668d":"code","8a00f843":"code","340ea22d":"code","7fe37297":"code","be8d1563":"code","5b070f19":"code","0ecee61a":"code","abe8bcd1":"code","bc1df397":"code","03958448":"code","4441da5a":"code","5d9e9694":"code","bfff3e53":"code","f03d9c2f":"code","6235bc97":"code","53a5e7c2":"code","967b8df4":"code","9ede3dc8":"code","84c3a31d":"code","2cab26f1":"code","d8504abb":"code","39885529":"code","736833a9":"code","3bd825c0":"code","5126df65":"code","f7135127":"code","68a78e9d":"code","925e64d6":"code","2c323987":"code","fb0a69bd":"code","929f10e9":"code","888f052e":"code","3389b679":"code","6df900e8":"code","e39be86a":"code","3094b8ab":"markdown","fa862c25":"markdown","4d5f7ebc":"markdown","396c839b":"markdown","a436de9d":"markdown","eb2af70d":"markdown","997ae870":"markdown","a973a045":"markdown","79fc4b5f":"markdown","04d39765":"markdown","c591a579":"markdown","d8b74de4":"markdown","45b659fd":"markdown","497ee962":"markdown","f647df39":"markdown","36bf66ac":"markdown","c28d1ab2":"markdown","fc893e8b":"markdown","e3d64cc2":"markdown","633d626d":"markdown","2ac07ff2":"markdown","b1b35fee":"markdown","3b83c913":"markdown","c3b94131":"markdown","eb786ddf":"markdown","872fe614":"markdown","1946f0fd":"markdown","4d3d720f":"markdown","60f7f182":"markdown","8e71a71a":"markdown","e5f9e8c7":"markdown","3ec6176a":"markdown","737e8079":"markdown","b36a8fa9":"markdown","5e9410f8":"markdown"},"source":{"fccd3111":"from mpl_toolkits.mplot3d import Axes3D\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.linear_model import LinearRegression,Ridge,Lasso\nimport matplotlib.pyplot as plt # plotting\n%matplotlib inline\nimport seaborn as sns\nimport numpy as np # linear algebra\nfrom sklearn.cluster import KMeans\nfrom sklearn.metrics import silhouette_score,silhouette_samples\nimport os # accessing directory structure\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\npd.plotting.register_matplotlib_converters()\nfrom sklearn.metrics import mean_squared_error,r2_score\nfrom sklearn.preprocessing import PolynomialFeatures\nfrom sklearn.svm import SVR\nfrom datetime import timedelta\nfrom statsmodels.tsa.api import Holt,SimpleExpSmoothing,ExponentialSmoothing\nfrom statsmodels.tsa.stattools import adfuller\nfrom statsmodels.tsa.arima_model import ARIMA\nfrom statsmodels.graphics.tsaplots import plot_acf,plot_pacf\nfrom fbprophet import Prophet\nimport plotly.express as px\nstd=StandardScaler()\nimport geopandas as gpd\nimport folium\nfrom folium import plugins\nfrom folium.plugins import HeatMap\nprint(\"Setup Complete\")","a3c58f27":"for dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n","503d0caa":"covid = pd.read_csv('\/kaggle\/input\/covid19-cases-in-so-paulo-daily-updated\/dados_covid_sp.csv', delimiter=';')\ncovid.dataframeName = 'dados_covid_sp.csv'","1e61f04a":"covid.head(5)","f8204028":"covid = covid[pd.notnull(covid['codigo_ibge'])]","c729101c":"print(\"Size\/Shape of the dataset: \",covid.shape)\nprint(\"Checking for null values:\\n\",covid.isnull().sum())\nprint(\"Checking Data-type of each column:\\n\",covid.dtypes)","35cf29b9":"covid['dateInt']=\"2020\" + covid['mes'].astype(str).str.zfill(2)+ covid['dia'].astype(str).str.zfill(2)\ncovid['Date'] = pd.to_datetime(covid['dateInt'], format='%Y%m%d')\ncovid.codigo_ibge = covid.codigo_ibge.astype(str)\ncovid['codigo_ibge'] = covid['codigo_ibge'].str[:7]","34a9f5d5":"print (covid.Date)","68bea024":"print(covid.codigo_ibge)","3ebbc7e6":"covid.head(5)","7054534c":"leitos_sus = pd.read_csv('\/kaggle\/input\/leitos-sus-abril-2020\/leitos_abril_2020_2.csv', delimiter=';')\ncovid.dataframeName = 'leitos_abril_2020_2.csv'","c727d7da":"leitos_sus.head(5)","a95b3d9d":"leitos_sus['Munic\u00edpio']=leitos_sus['Munic\u00edpio'].str.slice(start=6)\nleitos_sus.head(5)\n","50b434f5":"covid_geo = gpd.read_file(\"..\/input\/so-paulo-shapefile\/35MUE250GC_SIR.shp\")","678132b5":"covid_geo.head(200)","48551f34":"covid = pd.merge (covid, covid_geo, how = 'left', left_on = ['codigo_ibge'], right_on = ['CD_GEOCMU'])\ncovid.shape\ncovid.head(5)","b7616309":"covid.rename(columns={'NM_MUNICIP':'City','casos':'Confirmed','obitos':'Deaths','latitude':'Lat','longitude':'Long','geometry':'Geometry','Quantidade_existente':'Beds'}, inplace=True)","27724896":"covid.head(5)","40e5aba0":"covid.isna().sum()","90f6ade4":"covid.info","81859af9":"type(covid)","07967d2a":"temp = covid.groupby('Date')['Confirmed', 'Deaths'].sum().reset_index()\ntemp = temp[temp['Date']==max(temp['Date'])].reset_index(drop=True)\ntemp.style.background_gradient(cmap='Pastel1')","4c5ca42e":"map = folium.Map(width=800,height=500, location=[-22.164767, -48.605910], tiles='openstreetmap', zoom_start=7)\nmap.choropleth(geo_data=covid_geo, data=covid,\n             columns=['Cases', 'Deaths'],\n             key_on='feature.id',\n             fill_color='YlGn', fill_opacity=0.7, line_opacity=0.2,\n             legend_name='Participation Rate (%)')\nmap","2c7c7d46":"# Create a base map\ncovid_heatmap = folium.Map(width=800,height=500, location=[-22.164767, -48.605910], tiles='openstreetmap', zoom_start=7)\n\n# Add a heatmap to the base map\nHeatMap(data=covid[['Lat', 'Long']], radius=15).add_to(covid_heatmap)\n\nminimap = plugins.MiniMap()\ncovid_heatmap.add_child(minimap)\n\n# Display the map\ncovid_heatmap","0ba4afe1":"datewise=covid.groupby([\"Date\"]).agg({\"casos\":'sum',\"obitos\":'sum'})\ndatewise[\"Days Since\"]=datewise.index-datewise.index.min()\nprint(datewise)","77dd6983":"print(\"Basic Information\")\nprint(\"Total number of cities in S\u00e3o Paulo with Disease Spread: \",len(covid[\"munic\"].unique()))\nprint(\"Total number of Confirmed Cases in S\u00e3o Paulo: \",datewise[\"casos\"].iloc[-1])\nprint(\"Total number of Deaths Cases in S\u00e3o Paulo: \",datewise[\"obitos\"].iloc[-1])","6c417e4e":"datewise[\"WeekOfYear\"]=datewise.index.weekofyear\n\nweek_num=[]\nweekwise_confirmed=[]\nweekwise_deaths=[]\nw=1\nfor i in list(datewise[\"WeekOfYear\"].unique()):\n    weekwise_confirmed.append(datewise[datewise[\"WeekOfYear\"]==i][\"casos\"].iloc[-1])\n    weekwise_deaths.append(datewise[datewise[\"WeekOfYear\"]==i][\"obitos\"].iloc[-1])\n    week_num.append(w)\n    w=w+1\n\nplt.figure(figsize=(8,5))\nplt.plot(week_num,weekwise_confirmed,linewidth=3)\nplt.plot(week_num,weekwise_deaths,linewidth=3)\nplt.ylabel(\"Number of Cases\")\nplt.xlabel(\"Week Number\")\nplt.title(\"Weekly progress of Different Types of Cases\")\nplt.xlabel","5346e4f4":"fig, (ax1,ax2) = plt.subplots(1, 2,figsize=(15,5))\nsns.barplot(x=week_num,y=pd.Series(weekwise_confirmed).diff().fillna(0),ax=ax1)\nsns.barplot(x=week_num,y=pd.Series(weekwise_deaths).diff().fillna(0),ax=ax2)\nax1.set_xlabel(\"Week Number\")\nax2.set_xlabel(\"Week Number\")\nax1.set_ylabel(\"Number of Confirmed Cases\")\nax2.set_ylabel(\"Number of Death Cases\")\nax1.set_title(\"Weekly increase in Number of Confirmed Cases\")\nax2.set_title(\"Weekly increase in Number of Death Cases\")","c7ad1e12":"print(\"Average increase in number of Confirmed Cases every day: \",np.round(datewise[\"casos\"].diff().fillna(0).mean()))\nprint(\"Average increase in number of Deaths Cases every day: \",np.round(datewise[\"obitos\"].diff().fillna(0).mean()))\n\nplt.figure(figsize=(15,6))\nplt.plot(datewise[\"casos\"].diff().fillna(0),label=\"Daily increase in Confirmed Cases\",linewidth=3)\nplt.plot(datewise[\"obitos\"].diff().fillna(0),label=\"Daily increase in Death Cases\",linewidth=3)\nplt.xlabel(\"Timestamp\")\nplt.ylabel(\"Daily Increment\")\nplt.title(\"Daily increase in different Types of Cases in S\u00e3o Paulo state\")\nplt.xticks(rotation=90)\nplt.legend()","3e9ab1ca":"citywise=covid[covid[\"Date\"]==covid[\"Date\"].max()].groupby([\"munic\"]).agg({\"casos\":'sum',\"obitos\":'sum'}).sort_values([\"casos\"],ascending=False)\ncitywise[\"Mortality\"]=(citywise[\"obitos\"]\/citywise[\"casos\"])*100","3bbaf0de":"fig, (ax1, ax2) = plt.subplots(2, 1,figsize=(10,12))\ntop_15_confirmed=citywise.sort_values([\"casos\"],ascending=False).head(15)\ntop_15_deaths=citywise.sort_values([\"obitos\"],ascending=False).head(15)\nsns.barplot(x=top_15_confirmed[\"casos\"],y=top_15_confirmed.index,ax=ax1)\nax1.set_title(\"Top 15 cities as per Number of Confirmed Cases\")\nax1.set_xlabel(\"Cases\")\nax1.set_ylabel(\"Cities\")\nsns.barplot(x=top_15_deaths[\"obitos\"],y=top_15_deaths.index,ax=ax2)\nax2.set_title(\"Top 15 cities as per Number of Death Cases\")\nax2.set_xlabel(\"Cases\")\nax2.set_ylabel(\"Cities\")","8043ca1b":"# Set the width and height of the figure\nplt.figure(figsize=(14,7))\n\n# Add title\nplt.title(\"Average Arrival Delay for Each Airline, by Month\")\n\n# Heatmap showing average arrival delay for each airline by month\ntemp=citywise.drop('obitos',1)\ntemp=temp.drop('Mortality',1)\nsns.heatmap(temp.head(20), annot=True)\n\n# Add label for horizontal axis\nplt.xlabel(\"Airline\")","c078ef50":"citywise=covid[covid[\"Date\"]==covid[\"Date\"].max()].groupby([\"munic\"]).agg({\"casos\":'sum',\"obitos\":'sum'}).sort_values([\"casos\"],ascending=False)\ncitywise[\"Mortality\"]=(citywise[\"obitos\"]\/citywise[\"casos\"])*100","6ef5e997":"datewise[\"Mortality Rate\"]=(datewise[\"obitos\"]\/datewise[\"casos\"])*100\n\n#Plotting Mortality and Recovery Rate \nfig, (ax1) = plt.subplots(1,figsize=(12,6))\nax1.plot(datewise[\"Mortality Rate\"],label='Mortality Rate',linewidth=3)\nax1.axhline(datewise[\"Mortality Rate\"].mean(),linestyle='--',color='black',label=\"Mean Mortality Rate\")\nax1.set_ylabel(\"Mortality Rate\")\nax1.set_xlabel(\"Timestamp\")\nax1.set_title(\"Overall Datewise Mortality Rate\")\nax1.legend()\nfor tick in ax1.get_xticklabels():\n    tick.set_rotation(90)  \nprint(\"Average Mortality Rate\",datewise[\"Mortality Rate\"].mean())\nprint(\"Median Mortality Rate\",datewise[\"Mortality Rate\"].median())","d89dd4fa":"###Top 25 Cities as per Mortatlity Rate with more than 500 Confirmed Cases","5806b9ad":"fig, (ax1) = plt.subplots(1,figsize=(10,8))\ncitywise_plot_mortal=citywise[citywise[\"casos\"]>500].sort_values([\"Mortality\"],ascending=False).head(15)\nsns.barplot(x=citywise_plot_mortal[\"Mortality\"],y=citywise_plot_mortal.index,ax=ax1)\nax1.set_title(\"Top 15 Cities according High Mortatlity Rate\")\nax1.set_xlabel(\"Mortality (in Percentage)\")\nax1.set_ylabel(\"Cities\")","774819cd":"X=citywise[[\"casos\",\"obitos\"]]\nX=std.fit_transform(X)","141178a7":"wcss=[]\nsil=[]\nfor i in range(2,11):\n    clf=KMeans(n_clusters=i,init='k-means++',random_state=42)\n    clf.fit(X)\n    labels=clf.labels_\n    centroids=clf.cluster_centers_\n    sil.append(silhouette_score(X, labels, metric='euclidean'))\n    wcss.append(clf.inertia_)","0b07bb0e":"fig, (ax1, ax2) = plt.subplots(1, 2,figsize=(16,5))\nx=np.arange(2,11)\nax1.plot(x,wcss,marker='o')\nax1.set_xlabel(\"Number of Clusters\")\nax1.set_ylabel(\"Within Cluster Sum of Squares (WCSS)\")\nax1.set_title(\"Elbow Method\")\nx=np.arange(2,11)\nax2.plot(x,sil,marker='o')\nax2.set_xlabel(\"Number of Clusters\")\nax2.set_ylabel(\"Silhouette Score\")\nax2.set_title(\"Silhouette Score Method\")","2beede9e":"clf_final=KMeans(n_clusters=4,init='k-means++',random_state=42)\nclf_final.fit(X)","c1558a4c":"citywise[\"Clusters\"]=clf_final.predict(X)","c2ada149":"cluster_summary=pd.concat([citywise[citywise[\"Clusters\"]==1].head(6),citywise[citywise[\"Clusters\"]==2].head(6),citywise[citywise[\"Clusters\"]==3].head(6),citywise[citywise[\"Clusters\"]==4].head(6),citywise[citywise[\"Clusters\"]==0].head(6)])\ncluster_summary.style.background_gradient(cmap='Reds')","0dde80fb":"datewise[\"Days Since\"]=datewise.index-datewise.index[0]\ndatewise[\"Days Since\"]=datewise[\"Days Since\"].dt.days","45ea8b57":"train_ml=datewise.iloc[:int(datewise.shape[0]*0.95)]\nvalid_ml=datewise.iloc[int(datewise.shape[0]*0.95):]\nmodel_scores=[]","ad38b8de":"lin_reg=LinearRegression(normalize=True)","763e0c01":"lin_reg.fit(np.array(train_ml[\"Days Since\"]).reshape(-1,1),np.array(train_ml[\"casos\"]).reshape(-1,1))","87cf79e7":"prediction_valid_linreg=lin_reg.predict(np.array(valid_ml[\"Days Since\"]).reshape(-1,1))","b654ce13":"model_scores.append(np.sqrt(mean_squared_error(valid_ml[\"casos\"],prediction_valid_linreg)))\nprint(\"Root Mean Square Error for Linear Regression: \",np.sqrt(mean_squared_error(valid_ml[\"casos\"],prediction_valid_linreg)))","da167115":"plt.figure(figsize=(11,6))\nprediction_linreg=lin_reg.predict(np.array(datewise[\"Days Since\"]).reshape(-1,1))\nplt.plot(datewise[\"casos\"],label=\"Actual Confirmed Cases\")\nplt.plot(datewise.index,prediction_linreg, linestyle='--',label=\"Predicted Confirmed Cases using Linear Regression\",color='black')\nplt.xlabel('Time')\nplt.ylabel('Confirmed Cases')\nplt.title(\"Confirmed Cases Linear Regression Prediction\")\nplt.xticks(rotation=90)\nplt.legend()","1fc43e22":"train_ml=datewise.iloc[:int(datewise.shape[0]*0.95)]\nvalid_ml=datewise.iloc[int(datewise.shape[0]*0.95):]","511eb0be":"poly = PolynomialFeatures(degree = 4) ","9a151382":"train_poly=poly.fit_transform(np.array(train_ml[\"Days Since\"]).reshape(-1,1))\nvalid_poly=poly.fit_transform(np.array(valid_ml[\"Days Since\"]).reshape(-1,1))\ny=train_ml[\"casos\"]","dc5b11ac":"linreg=LinearRegression(normalize=True)\nlinreg.fit(train_poly,y)","04962c9d":"prediction_poly=linreg.predict(valid_poly)\nrmse_poly=np.sqrt(mean_squared_error(valid_ml[\"casos\"],prediction_poly))\nmodel_scores.append(rmse_poly)\nprint(\"Root Mean Squared Error for Polynomial Regression: \",rmse_poly)","d353d88e":"comp_data=poly.fit_transform(np.array(datewise[\"Days Since\"]).reshape(-1,1))\nplt.figure(figsize=(11,6))\npredictions_poly=linreg.predict(comp_data)\nplt.plot(datewise[\"casos\"],label=\"Train Confirmed Cases\",linewidth=3)\nplt.plot(datewise.index,predictions_poly, linestyle='--',label=\"Best Fit for Polynomial Regression\",color='black')\nplt.xlabel('Time')\nplt.ylabel('Confirmed Cases')\nplt.title(\"Confirmed Cases Polynomial Regression Prediction\")\nplt.xticks(rotation=90)\nplt.legend()","2892669c":"new_prediction_poly=[]\nfor i in range(1,18):\n    new_date_poly=poly.fit_transform(np.array(datewise[\"Days Since\"].max()+i).reshape(-1,1))\n    new_prediction_poly.append(linreg.predict(new_date_poly)[0])","2c372912":"train_ml=datewise.iloc[:int(datewise.shape[0]*0.95)]\nvalid_ml=datewise.iloc[int(datewise.shape[0]*0.95):]","0fa8df61":"svm=SVR(C=1,degree=5,kernel='poly',epsilon=0.01)","4bf0668d":"svm.fit(np.array(train_ml[\"Days Since\"]).reshape(-1,1),np.array(train_ml[\"casos\"]).reshape(-1,1))","8a00f843":"prediction_valid_svm=svm.predict(np.array(valid_ml[\"Days Since\"]).reshape(-1,1))","340ea22d":"plt.figure(figsize=(11,6))\nprediction_svm=svm.predict(np.array(datewise[\"Days Since\"]).reshape(-1,1))\nplt.plot(datewise[\"casos\"],label=\"Train Confirmed Cases\",linewidth=3)\nplt.plot(datewise.index,prediction_svm, linestyle='--',label=\"Best Fit for SVR\",color='black')\nplt.xlabel('Time')\nplt.ylabel('Confirmed Cases')\nplt.title(\"Confirmed Cases Support Vector Machine Regressor Prediction\")\nplt.xticks(rotation=90)\nplt.legend()","7fe37297":"model_scores.append(np.sqrt(mean_squared_error(valid_ml[\"casos\"],prediction_valid_svm)))\nprint(\"Root Mean Square Error for Support Vectore Machine: \",np.sqrt(mean_squared_error(valid_ml[\"casos\"],prediction_valid_svm)))","be8d1563":"plt.figure(figsize=(11,6))\nprediction_svm=svm.predict(np.array(datewise[\"Days Since\"]).reshape(-1,1))\nplt.plot(datewise[\"casos\"],label=\"Train Confirmed Cases\",linewidth=3)\nplt.plot(datewise.index,prediction_svm, linestyle='--',label=\"Best Fit for SVR\",color='black')\nplt.xlabel('Time')\nplt.ylabel('casos')\nplt.title(\"Confirmed Cases Support Vector Machine Regressor Prediction\")\nplt.xticks(rotation=90)\nplt.legend()","5b070f19":"new_date=[]\nnew_prediction_lr=[]\nnew_prediction_svm=[]\nfor i in range(1,18):\n    new_date.append(datewise.index[-1]+timedelta(days=i))\n    new_prediction_lr.append(lin_reg.predict(np.array(datewise[\"Days Since\"].max()+i).reshape(-1,1))[0][0])\n    new_prediction_svm.append(svm.predict(np.array(datewise[\"Days Since\"].max()+i).reshape(-1,1))[0])","0ecee61a":"pd.set_option('display.float_format', lambda x: '%.6f' % x)\nmodel_predictions=pd.DataFrame(zip(new_date,new_prediction_lr,new_prediction_poly,new_prediction_svm),\n                               columns=[\"Dates\",\"Linear Regression Prediction\",\"Polynonmial Regression Prediction\",\"SVM Prediction\"])\nmodel_predictions.head()","abe8bcd1":"model_train=datewise.iloc[:int(datewise.shape[0]*0.95)]\nvalid=datewise.iloc[int(datewise.shape[0]*0.95):]","bc1df397":"holt=Holt(np.asarray(model_train[\"casos\"])).fit(smoothing_level=0.2, smoothing_slope=0.1,optimized=False)\ny_pred=valid.copy()","03958448":"y_pred[\"Holt\"]=holt.forecast(len(valid))\nmodel_scores.append(np.sqrt(mean_squared_error(y_pred[\"casos\"],y_pred[\"Holt\"])))\nprint(\"Root Mean Square Error Holt's Linear Model: \",np.sqrt(mean_squared_error(y_pred[\"casos\"],y_pred[\"Holt\"])))","4441da5a":"plt.figure(figsize=(10,5))\nplt.plot(model_train.casos,label=\"Train Set\",marker='o')\nvalid.casos.plot(label=\"Validation Set\",marker='*')\ny_pred.Holt.plot(label=\"Holt's Linear Model Predicted Set\",marker='^')\nplt.ylabel(\"Confirmed Cases\")\nplt.xlabel(\"Date Time\")\nplt.title(\"Confirmed Holt's Linear Model Prediction\")\nplt.xticks(rotation=90)\nplt.legend()","5d9e9694":"holt_new_date=[]\nholt_new_prediction=[]\nfor i in range(1,18):\n    holt_new_date.append(datewise.index[-1]+timedelta(days=i))\n    holt_new_prediction.append(holt.forecast((len(valid)+i))[-1])\n\nmodel_predictions[\"Holt's Linear Model Prediction\"]=holt_new_prediction\nmodel_predictions.head()","bfff3e53":"model_train=datewise.iloc[:int(datewise.shape[0]*0.95)]\nvalid=datewise.iloc[int(datewise.shape[0]*0.95):]\ny_pred=valid.copy()","f03d9c2f":"es=ExponentialSmoothing(np.asarray(model_train['casos']),seasonal_periods=5,trend='mul', seasonal='mul').fit()","6235bc97":"y_pred[\"Holt's Winter Model\"]=es.forecast(len(valid))","53a5e7c2":"model_scores.append(np.sqrt(mean_squared_error(y_pred[\"casos\"],y_pred[\"Holt's Winter Model\"])))\nprint(\"Root Mean Square Error for Holt's Winter Model: \",np.sqrt(mean_squared_error(y_pred[\"casos\"],y_pred[\"Holt's Winter Model\"])))","967b8df4":"plt.figure(figsize=(10,5))\nplt.plot(model_train.casos,label=\"Train Set\",marker='o')\nvalid.casos.plot(label=\"Validation Set\",marker='*')\ny_pred[\"Holt\\'s Winter Model\"].plot(label=\"Holt's Winter Model Predicted Set\",marker='^')\nplt.ylabel(\"Confirmed Cases\")\nplt.xlabel(\"Date Time\")\nplt.title(\"Confiremd Cases Holt's Winter Model Prediction\")\nplt.xticks(rotation=90)\nplt.legend()","9ede3dc8":"holt_winter_new_prediction=[]\nfor i in range(1,18):\n    holt_winter_new_prediction.append(es.forecast((len(valid)+i))[-1])\nmodel_predictions[\"Holt's Winter Model Prediction\"]=holt_winter_new_prediction\nmodel_predictions.head()","84c3a31d":"model_train=datewise.iloc[:int(datewise.shape[0]*0.95)]\nvalid=datewise.iloc[int(datewise.shape[0]*0.95):]\ny_pred=valid.copy()","2cab26f1":"prophet_c=Prophet(interval_width=0.95,weekly_seasonality=True,)\nprophet_confirmed=pd.DataFrame(zip(list(datewise.index),list(datewise[\"casos\"])),columns=['ds','y'])","d8504abb":"prophet_c.fit(prophet_confirmed)","39885529":"forecast_c=prophet_c.make_future_dataframe(periods=30)\nforecast_confirmed=forecast_c.copy()","736833a9":"confirmed_forecast=prophet_c.predict(forecast_c)","3bd825c0":"model_scores.append(np.sqrt(mean_squared_error(datewise[\"casos\"],confirmed_forecast['yhat'].head(datewise.shape[0]))))\nprint(\"Root Mean Squared Error for Prophet Model: \",np.sqrt(mean_squared_error(datewise[\"casos\"],confirmed_forecast['yhat'].head(datewise.shape[0]))))","5126df65":"print(prophet_c.plot(confirmed_forecast))","f7135127":"print(prophet_c.plot_components(confirmed_forecast))","68a78e9d":"prophet_c=Prophet(interval_width=0.95,weekly_seasonality=True,)\nprophet_deaths=pd.DataFrame(zip(list(datewise.index),list(datewise[\"obitos\"])),columns=['ds','y'])","925e64d6":"prophet_c.fit(prophet_deaths)","2c323987":"forecast_c=prophet_c.make_future_dataframe(periods=30)\nforecast_deaths=forecast_c.copy()","fb0a69bd":"deaths_forecast=prophet_c.predict(forecast_c)","929f10e9":"model_scores.append(np.sqrt(mean_squared_error(datewise[\"obitos\"],deaths_forecast['yhat'].head(datewise.shape[0]))))\nprint(\"Root Mean Squared Error for Prophet Model: \",np.sqrt(mean_squared_error(datewise[\"obitos\"],deaths_forecast['yhat'].head(datewise.shape[0]))))","888f052e":"print(prophet_c.plot(deaths_forecast))","3389b679":"print(prophet_c.plot_components(deaths_forecast))","6df900e8":"model_names=[\"Linear Regression\",\"Polynomial Regression\",\"Support Vector Machine Regressor\",\"Holt's Linear\",\"Holt's Winter Model\",\"Facebook's Prophet Model\"]\nmodel_summary=pd.DataFrame(zip(model_names,model_scores),columns=[\"Model Name\",\"Root Mean Squared Error\"]).sort_values([\"Root Mean Squared Error\"])\nmodel_summary","e39be86a":"model_predictions[\"Prophet's Prediction\"]=list(confirmed_forecast[\"yhat\"].tail(17))\nmodel_predictions[\"Prophet's Upper Bound\"]=list(confirmed_forecast[\"yhat_upper\"].tail(17))\nmodel_predictions.head()","3094b8ab":"#### Facebook's Prophet Model forecasting for Confirmed Cases","fa862c25":"### Preparing S\u00e3o Paulo Health Department Data","4d5f7ebc":"#### Linear Regression Model for Confirm Cases Prediction","396c839b":"Dropping column as \"codigo_ibge\" have some null records.","a436de9d":"Let' see how the data looks like now:","eb2af70d":"### Summary of Clustes","997ae870":"#### Time Series Forecasting","a973a045":"Predictions of Linear Regression are nowhere close to actual values.","79fc4b5f":"There is 1 csv file in the current version of the dataset, a new version will be deployed daily, as soon as it is publish by S\u00e3o Paulo state health department. We wil also load S\u00e3o Paulo State shapefile from IBGE.","04d39765":"### Preparing SUS Data","c591a579":"### Preparing S\u00e3o Paulo Shapefile (IBGE)","d8b74de4":"Holt's Linear Model","45b659fd":"### Daily increase in Number of Cases","497ee962":"Let's take a quick look at what the data looks like:","f647df39":"Let's use a datewise approach to sum the cases and deaths by date to be used in the following summary:","36bf66ac":"#### Support Vector Machine ModelRegressor for Prediction of Confirmed Cases","c28d1ab2":"### Clustering of Cities","fc893e8b":"### Datewise Data Analysis","e3d64cc2":"#### Polynomial Regression for Prediction of Confirmed Cases","633d626d":"## Data Preparation","2ac07ff2":"## Introduction\nThis kernel was made for educational purposes using \"dados_covid_sp.csv\" file that is publish daily by S\u00e3o Paulo state health department on http:\/\/saopaulo.sp.gov.br. Python base code and visualizations were base on https:\/\/www.kaggle.com\/neelkudu28\/covid-19-visualizations-predictions-forecasting kernel made by Neel Kudu.","b1b35fee":"Let's start to explore the data visualy to undestand COVID-19 behavior across cities in S\u00e3o Paulo:","3b83c913":"### Overall Datewise Mortality Rate","c3b94131":"### Weekly increase in Number of Cases","eb786ddf":"Now let's massage the data a little bit, using \"Dia\" and \"Mes\" fields to find the date of ocurrence and clean the IBGE code:","872fe614":"### Prediction Using Machine Leaning Models","1946f0fd":"### Weekly Progress of COVID-19","4d3d720f":"### Citywise Analysis","60f7f182":"#### Summarization of Forecast Using Different Time Series Models","8e71a71a":"### Let's play with some graphs:","e5f9e8c7":"Correct number of clusters would be 4, due to where the Elbow is located.","3ec6176a":"### Calculating Mortality Rate","737e8079":"## Initial Setup","b36a8fa9":"#### Facebook's Prophet Model forecasting for Deaths","5e9410f8":"Holt's Winter Model for Daily Time Series"}}