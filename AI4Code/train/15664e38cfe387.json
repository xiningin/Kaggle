{"cell_type":{"081a8f58":"code","b0cf31a4":"code","4cf8b484":"code","fdc005d5":"code","d26c7e08":"code","533702db":"code","e2605270":"code","b7c5e045":"code","34a4ff05":"code","504009a0":"code","fc53f7ee":"code","e9211f41":"code","4b9530c3":"code","ed612bad":"code","3b7c89cc":"code","9ca4c2f3":"code","3c95a182":"code","92c6fb34":"code","fa1a2f28":"code","010209e2":"code","5e756c05":"code","86bed2e9":"code","0917aca8":"code","8b6dbedc":"code","61c48a24":"code","02602e3a":"code","e55c6332":"code","1a96b495":"code","0687bb32":"code","3a91c079":"code","b7724c86":"code","74cc09e4":"code","3410ec9c":"code","ffa4b8fa":"code","1e18fded":"code","12480df4":"code","59ba3280":"code","d92d95cb":"code","03749fee":"code","5cd9b1e0":"code","7ded454c":"code","8eb152d9":"code","e0dcb7bc":"code","2c0eefd2":"code","7d08ec0a":"code","5e22cc28":"code","09ac8e75":"code","fb459c5f":"code","26ea47d6":"code","9bfe552f":"markdown","5efa2948":"markdown","8764442b":"markdown","f49781c7":"markdown","2c4981a3":"markdown","15b99ac6":"markdown","daa5b82d":"markdown","90d897b1":"markdown","8c3cd826":"markdown","6c85c074":"markdown","40494000":"markdown","8d7b4322":"markdown","da414a35":"markdown","cdd3cd23":"markdown","f1a0cfe4":"markdown","006bcf6b":"markdown","bf967bce":"markdown","67814172":"markdown","7feb5d01":"markdown","108d35fa":"markdown","ed9ee134":"markdown","d1e2ea90":"markdown","12bb8c17":"markdown","7b37f850":"markdown","28e18ff9":"markdown","3db59ce6":"markdown"},"source":{"081a8f58":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nfrom matplotlib import pyplot as plt\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import MinMaxScaler, LabelEncoder, StandardScaler, RobustScaler\n\npd.set_option('display.max_columns', None)\npd.set_option('display.max_rows', 20)\npd.set_option('display.float_format', lambda x: '%.3f' % x)\npd.set_option('display.width', 170)","b0cf31a4":"df=pd.read_csv(\"..\/input\/insurance\/insurance.csv\")","4cf8b484":"df.head()","fdc005d5":"df.shape","d26c7e08":"df.isnull().sum()","533702db":"#Ayk\u0131r\u0131 de\u011fer yok gibi g\u00f6z\u00fck\u00fcyor.\nsns.boxplot(x=df[\"age\"])\nplt.show()","e2605270":"#\u00c7ok fazla ayk\u0131r\u0131 de\u011fer var.\nsns.boxplot(x=df[\"charges\"])\nplt.show()","b7c5e045":"q1 = df[\"charges\"].quantile(0.25)\nq3 = df[\"charges\"].quantile(0.75)\niqr = q3 - q1\nup = q3 + 1.5 * iqr\nlow = q1 - 1.5 * iqr","34a4ff05":"df.loc[df[\"charges\"] < low,\"charges\"]=low","504009a0":"df.loc[df[\"charges\"] > up,\"charges\"]=up","fc53f7ee":"df.describe().T","e9211f41":"df.info()","4b9530c3":"def grab_col_names(dataframe, cat_th=10, car_th=20):    \n    cat_cols = [col for col in dataframe.columns if dataframe[col].dtypes == \"O\"]\n    num_but_cat = [col for col in dataframe.columns if dataframe[col].nunique() < cat_th and\n                   dataframe[col].dtypes != \"O\"]\n    cat_but_car = [col for col in dataframe.columns if dataframe[col].nunique() > car_th and\n                   dataframe[col].dtypes == \"O\"]\n    cat_cols = cat_cols + num_but_cat\n    cat_cols = [col for col in cat_cols if col not in cat_but_car]\n\n    # num_cols\n    num_cols = [col for col in dataframe.columns if dataframe[col].dtypes != \"O\"]\n    num_cols = [col for col in num_cols if col not in num_but_cat]\n\n    print(f\"Observations: {dataframe.shape[0]}\")\n    print(f\"Variables: {dataframe.shape[1]}\")\n    print(f'cat_cols: {len(cat_cols)}')\n    print(f'num_cols: {len(num_cols)}')\n    print(f'cat_but_car: {len(cat_but_car)}')\n    print(f'num_but_cat: {len(num_but_cat)}')\n    return cat_cols, num_cols, cat_but_car","ed612bad":"cat_cols, num_cols, cat_but_car = grab_col_names(df)\nnum_cols","3b7c89cc":"for col in num_cols:\n    if col!=\"charges\" :\n        cor=df[[col, \"charges\"]].corr().loc[col, \"charges\"]\n        print(col, cor)","9ca4c2f3":"df.groupby(\"age\")[\"charges\"].mean()","3c95a182":"def generate(df,c,a,b,t,y,y1,y2):\n    df.loc[(df[c] < a), t] = y\n    df.loc[(df[c] >= a) & (df[c] < b), t] = y1\n    df.loc[(df[c] >= b), t] = y2\n    return df[t]","92c6fb34":"df[\"age\"].describe()","fa1a2f28":"generate(df,\"age\",27,51,\"new_age\",\"young\",\"mature\",\"senior\")","010209e2":"df.head()","5e756c05":"df[\"region\"].unique()","86bed2e9":"df[\"bmi\"].describe()","0917aca8":"generate(df,\"bmi\",30,35,\"bmi_risk\",\"usual\",\"risky\",\"unhealthy\")","8b6dbedc":"generate(df,\"children\",2,4,\"children_C\",\"A\",\"B\",\"C\")","61c48a24":"def twice_col(df,col1,col2):\n    n=df[col1].unique().tolist()\n    l=len(n)\n    n1=df[col2].unique().tolist()\n    l1=len(n1)\n    for i in n:\n        for j in range(l):\n            for z in n1:\n                for t in range(l1):\n                    df.loc[(df[col1] == n[j]) & (df[col2] == n1[t]), str(col1) + \"_\" + str(col2)]=str(n[j]) +\"_\"+ str(n1[t])\n","02602e3a":"twice_col(df,\"children_C\",\"smoker\")","e55c6332":"df[\"children_C_smoker\"].nunique()","1a96b495":"df.head()","0687bb32":"liste=df[\"children_C_smoker\"].unique().tolist()","3a91c079":"# 1 \u00e7ocuk oldu\u011funda veya hi\u00e7 olmad\u0131\u011f\u0131nda harcamalar daha y\u00fcksekmi\u015f.\nfor i in liste:\n    a=df[df[\"children_C_smoker\"]==i][[\"charges\"]].mean()\n    print(i,\":\",a,sep=\" \")\n    ","b7724c86":"df[df[\"children_C_smoker\"]==\"C_yes\"][[\"charges\"]].mean()","74cc09e4":"twice_col(df,\"children_C\",\"sex\")","3410ec9c":"twice_col(df,\"new_age\",\"sex\")","ffa4b8fa":"twice_col(df,\"children_C\",\"bmi_risk\")","1e18fded":"df.head()","12480df4":"df.shape","59ba3280":"from sklearn.preprocessing import LabelEncoder","d92d95cb":"binary_cols = [col for col in df.columns if df[col].dtype not in [int, float]\n               and df[col].nunique() == 2]","03749fee":"binary_cols ","5cd9b1e0":"labelencoder = LabelEncoder()","7ded454c":"for i in binary_cols:\n    df[i] = labelencoder.fit_transform(df[i])","8eb152d9":"ohe_cols = [col for col in df.columns if 10 >= df[col].nunique() > 2]","e0dcb7bc":"df=pd.get_dummies(df, columns=ohe_cols, drop_first=True)","2c0eefd2":"for col in num_cols:\n    transformer = MinMaxScaler().fit(df[[col]])\n    df[col] = transformer.transform(df[[col]])","7d08ec0a":"from sklearn.model_selection import train_test_split, cross_val_score\nfrom sklearn.metrics import mean_squared_error","5e22cc28":"from sklearn.linear_model import LinearRegression\ny = df[\"charges\"]\nX = df.drop([\"charges\"], axis=1)\n\nX_train, X_test, y_train, y_test = train_test_split(X,\n                                                    y,\n                                                    test_size=0.20, random_state=1)\n\nreg_model = LinearRegression().fit(X, y)\nreg_model.intercept_\nreg_model.coef_","09ac8e75":"# Test RMSE\ny_pred = reg_model.predict(X_test)\nnp.sqrt(mean_squared_error(y_test, y_pred))","fb459c5f":"# Test RKARE\nreg_model.score(X_test, y_test)","26ea47d6":"np.mean(np.sqrt(-cross_val_score(reg_model,\n                                 X,\n                                 y,\n                                 cv=10,\n                                 scoring=\"neg_mean_squared_error\")))\n","9bfe552f":"* \u00c7ocuk say\u0131s\u0131na g\u00f6re kategorilere ay\u0131rma i\u015flemi","5efa2948":"*  Region parametresinde s\u0131n\u0131f say\u0131s\u0131 az oldu\u011fundan one hot encoding i\u015fleminde 1-0 olarak d\u00f6n\u00fc\u015fecek bu y\u00fczden kategorilere ay\u0131rma i\u015flemini yapm\u0131yoruz.","8764442b":"* \u0130ki farkl\u0131 columnu birle\u015ftirmek i\u015flemi i\u00e7in fonksiyon","f49781c7":"* Age de\u011fi\u015fkeninin \u00e7eyrekliklerine denk gelen say\u0131lara g\u00f6re kategorilere ay\u0131rma i\u015flemi","2c4981a3":"* Gerekli k\u00fct\u00fcphanelerin import edilmesi ve  set_option ayarlar\u0131n\u0131n yap\u0131lmas\u0131","15b99ac6":"* Ya\u015f ve cinsiyete g\u00f6re bir column olu\u015fturulmas\u0131","daa5b82d":"* \u00c7ocuk say\u0131s\u0131 ve v\u00fccut kitle indeksine g\u00f6re bir column olu\u015fturulmas\u0131","90d897b1":"* Eksik de\u011fer kontrol\u00fc","8c3cd826":"* \u00c7ocuk say\u0131s\u0131 ve sigara i\u00e7ip i\u00e7meme durumu da harcamalar\u0131 etkileyece\u011finden bu \u015fekilde 6 ayr\u0131 s\u0131n\u0131f olu\u015fturulur","6c85c074":"* Verinin Okutulmas\u0131","40494000":"* Veri setinin modele girebilmesi i\u00e7in encoding i\u015flemlerinin yap\u0131lmas\u0131","8d7b4322":"* Ayk\u0131r\u0131 de\u011ferlerin bask\u0131lanmas\u0131","da414a35":"* Modelin veriyi a\u00e7\u0131klayabilme y\u00fczdesi","cdd3cd23":"* Veri setindeki numerik columnlar ile ba\u011f\u0131ml\u0131 de\u011fi\u015fken aras\u0131ndaki korelasyona bak\u0131lmas\u0131","f1a0cfe4":"* Hata kareler ortalamas\u0131n\u0131n karek\u00f6k\u00fc olan rmse de\u011feri 0'a ne kadar yak\u0131n olursa model m\u00fckemmele o kadar yak\u0131n olur.","006bcf6b":"* Verinin boyut bilgisi","bf967bce":"* V\u00fccut kitle indeksine g\u00f6re bmi de\u011ferlerini kategorilere ay\u0131rma i\u015flemi","67814172":"* Ayk\u0131r\u0131 de\u011fer kontrol\u00fc","7feb5d01":"* Columnlar\u0131 kategorilere ay\u0131rmak i\u00e7in bir fonksiyon","108d35fa":"Veri Seti Hakk\u0131nda Bilgi: ABD'nin bir yerle\u015fim b\u00f6lgesindeki sigortaya kay\u0131tl\u0131 ki\u015filerin;cinsiyet,sa\u011fl\u0131k sigortas\u0131 kapsam\u0131ndaki \u00e7ocuk say\u0131s\u0131,yerle\u015fim yeri ve benzeri ba\u011f\u0131ms\u0131z de\u011fi\u015fkenleriyle ba\u011f\u0131ml\u0131 de\u011fi\u015fken olan sigortaya kay\u0131tl\u0131 ki\u015finin faturalanan t\u0131bbi masraflar\u0131 verilmi\u015ftir.\nBu bilgilerle t\u0131bbi masraf tahminlemesi yap\u0131labilir mi onu test ettik.\nVeri seti 1338 g\u00f6zlem 7 parametreden olu\u015fuyor.\n","ed9ee134":"## L\u0130NEER REGRESYON MODEL\u0130 \u0130LE MASRAF TAHM\u0130N\u0130","d1e2ea90":"* Standartla\u015ft\u0131rma i\u015fleminin yap\u0131lmas\u0131","12bb8c17":"* \u00c7ocuk say\u0131s\u0131 ve cinsiyete g\u00f6re harcamalara bak\u0131lmas\u0131 i\u00e7in bu \u015fekilde bir column olu\u015fturuyoruz.","7b37f850":"* Kategorik, numerik columnlara eri\u015filmesi i\u00e7in fonksiyon","28e18ff9":"* \u00c7ocuk say\u0131s\u0131 verideki max. say\u0131da oldu\u011funda ve sigara kullan\u0131lmas\u0131 durumunda ortalama harcama de\u011feri","3db59ce6":"* Modelin kurulmas\u0131"}}