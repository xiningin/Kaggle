{"cell_type":{"7174e760":"code","505e68c3":"code","ae8e441f":"code","4d6bfcd0":"code","aac1619a":"code","ff76bac3":"code","97d485f6":"code","804e0376":"code","35a9715d":"code","9cd00372":"code","31aed127":"code","8218e1a1":"code","75d01569":"code","705094ca":"code","26d334ff":"code","1e313a70":"code","d2df6000":"code","5d1432f1":"code","377deefa":"code","0abc9b9b":"code","469325cf":"code","c604f653":"code","c19fe54b":"code","c06a5e36":"code","8c531b45":"code","5da893cb":"code","149411a8":"code","7291b894":"markdown","54e097f1":"markdown"},"source":{"7174e760":"import pandas as pd\nimport numpy as np\nimport holoviews as hv\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nhv.extension('bokeh')\n","505e68c3":"data=pd.read_csv(\"\/kaggle\/input\/okcupid-profiles\/okcupid_profiles.csv\")\ndata.head()","ae8e441f":"data.dtypes","4d6bfcd0":"data[\"sex\"].unique()","aac1619a":"## Make a category of Status\ndata[\"sex\"]=data[\"sex\"].astype(\"category\")\ndata[\"sex\"].cat.set_categories([\"m\",\"f\"], inplace=True)\n","ff76bac3":"pd.pivot_table(data=data, index=data.sex, values=\"income\", aggfunc=np.mean)","97d485f6":"pd.pivot_table(data=data, index=data.education, values=[\"age\", \"income\"],aggfunc=np.mean)","804e0376":"pd.pivot_table(data=data, index=[\"education\", \"sex\"],aggfunc=np.mean)","35a9715d":"pd.pivot_table(data=data, index=[\"smokes\", \"drinks\"], values=\"income\")","9cd00372":"pd.pivot_table(data=data, index=[\"smokes\", \"drinks\"], values=[\"income\"])","31aed127":"pd.pivot_table(data=data, index=\"education\", values=[\"income\"], aggfunc=[np.mean,len], fill_value=0)\n","8218e1a1":"pd.pivot_table(data=data, \n               index=[\"status\", \"sex\"], \n               values=[\"income\", \"age\"],\n               aggfunc=np.mean, \n               fill_value=0, \n               margins=True)\n","75d01569":"pd.pivot_table(data=data, \n               index=[\"status\", \"sex\"], \n               values=[\"income\", \"age\"],\n               aggfunc={\"income\": np.mean, \"age\": np.median}, \n               fill_value=0, \n               margins=True)","705094ca":"table=pd.pivot_table(data=data, \n               index=[\"status\", \"sex\"], \n               values=[\"income\", \"age\"],\n               columns=\"orientation\",\n               aggfunc={\"income\": np.mean, \"age\": np.median}, \n               fill_value=0, \n               margins=True)\ntable","26d334ff":"table=pd.pivot_table(data=data, \n               index=[\"status\", \"sex\"], \n               values=[\"income\", \"age\"],\n               columns=\"orientation\",\n               aggfunc=[len, np.mean],\n               fill_value=0, \n               margins=True)\ntable","1e313a70":"table.query('status==[\"available\"]')","d2df6000":"table.query('status==[\"available\", \"married\"]')","5d1432f1":"data.head()","377deefa":"pd.set_option('display.max_rows', None) \npd.pivot_table(data,\n               index=[\"drugs\", \"drinks\", \"smokes\"], \n               values=[\"age\", \"income\"], \n               aggfunc=[np.mean, len],\n               margins=True)","0abc9b9b":"pd.set_option('display.max_rows', None) \nbad_habit=pd.pivot_table(data,\n               index=[\"drugs\", \"drinks\", \"smokes\"], \n               values=\"income\", \n               aggfunc=[np.mean, len],\n               margins=True)\nbad_habit","469325cf":"bad_habit.query('smokes==\"yes\" and drugs==\"never\"', inplace=True)\nbad_habit","c604f653":"pd.set_option('display.max_rows', None) \nbad_habit=pd.pivot_table(data,\n               index=[\"drugs\", \"drinks\", \"smokes\"], \n               values=\"income\", \n               aggfunc=[np.mean, len],\n               margins=True)\nbad_habit","c19fe54b":"bad_habit.xs((\"never\", \"not at all\", \"no\")) ## Never use Drugs, no drinking but no smoking","c06a5e36":"bad_habit.xs((\"sometimes\", \"very often\", \"yes\")) ## Sometimes use Drugs, very often drinking but smoking","8c531b45":"bad_habit.dtypes","5da893cb":"bad_habit.query('drugs==\"never\"')","149411a8":"bad_habit.query('drugs==\"never\" & drinks==[\"desperately\",\"not at all\"] & smokes==\"no\"')","7291b894":"on average, the average age for both men and women is 32, men are taller than women and receive on average a twice higher salary","54e097f1":"on Average the age is 32y.o and the average income is around 20 000\u20ac"}}