{"cell_type":{"ef21591d":"code","87b45352":"code","4efe2902":"code","c413436c":"code","6fae0535":"code","f0c1d8e7":"code","c241eb32":"code","36dedfaf":"code","d6477663":"code","f2644ced":"code","2854abc7":"code","12fe757e":"code","cc135c3c":"code","56d39bf7":"code","6943372e":"code","25b570be":"code","3c5cc811":"code","4fc4bd6a":"code","fde8be82":"code","4e84de2b":"code","cb153c14":"code","3959bb11":"code","7bbfb96c":"code","1d702e01":"code","d6d65cb6":"code","dcc5f408":"code","f6a27cc4":"code","a62485e2":"code","1021ab06":"code","e556a63f":"code","fd778134":"code","3bc90f87":"code","75531517":"code","deb5e96a":"code","0b8aa92d":"code","63e3f211":"code","f1d0846c":"code","30f85cf8":"code","e63ffebd":"code","7cfd0d12":"code","d304dda9":"code","de063fb0":"code","8a9a4366":"code","186f4391":"code","a100f44a":"code","d20d8a2d":"code","c2790380":"code","7033be57":"code","c5772723":"code","375817fb":"code","436234fe":"code","199e209f":"code","5de17878":"code","589cc454":"code","40f489e6":"code","932d1dc5":"code","16bcb801":"code","6e5d9e23":"code","c0018d32":"code","059ec755":"code","42fcebf1":"code","9706f227":"code","5d57b3de":"code","9725298d":"code","d00235cc":"code","b6941279":"code","80fa4be5":"code","78e382b8":"code","dbffa1c4":"code","981de3d7":"code","6fde8625":"code","7a27311d":"code","646a261a":"code","0c22bab0":"code","cfe79aed":"code","aa9fe2f1":"code","66ed419b":"code","ab825125":"code","2afd4e0a":"code","8504880a":"code","064ddd54":"code","230d0f7e":"code","39831a14":"code","8a08d857":"code","d4f0ec06":"code","1c5257ea":"code","29982b2c":"code","3af2055a":"code","ce091892":"code","11878242":"code","b6ddb0c0":"code","2eceb1c6":"code","391cddb0":"code","0323af54":"code","fbb41499":"code","b48a170e":"code","3e9abaf9":"code","54903178":"code","c99e1c37":"code","a2a69108":"code","95b13f38":"code","0fe7bc3a":"code","a27ca00d":"code","1ed89df4":"code","fbb14ff8":"code","99f05a27":"code","8090e977":"code","3614f22d":"code","55b68b0a":"code","3b7c3d58":"code","bc884c07":"code","b74b5f8b":"code","ab6a3702":"code","e02c7d60":"code","ae7d8357":"code","ce9bb9c9":"code","fccb7414":"code","103ff7df":"code","baa3de9a":"code","e454c940":"code","35ef2ac6":"code","5b2126d2":"code","4616e321":"code","a610482c":"code","85641cac":"code","af8d14ef":"code","00dcd84e":"code","b6474314":"code","6fef8fce":"code","3f0ff015":"code","a17a1506":"code","2529bea5":"code","c3b88d43":"code","c817c81f":"code","cba032c9":"code","861d35ae":"code","282b5b5c":"code","044b73e1":"code","b7089ded":"code","d0ea7954":"code","7c4081d5":"code","7710ebb4":"code","d99b67cd":"code","86f6d2f3":"code","ff72adc1":"code","01876136":"code","71da9f94":"code","0d693f65":"code","5e46642c":"code","2047b1a2":"code","978627bb":"code","ed9af9a6":"code","f1b2b6f7":"code","64dfcc01":"code","4948f4e1":"code","21c8220d":"code","296827bd":"code","a2571bf0":"code","c0615a73":"code","21fb9a7c":"code","69c45e7c":"code","30f9b4ae":"code","51227328":"code","036b143d":"code","c26574c8":"code","e3a2693c":"code","79b3f476":"code","33f4a0ef":"code","aecce2c5":"code","6d4e6816":"code","77bbafd3":"code","982db81f":"code","00d5d586":"code","9e7d8c3a":"code","026d99b6":"code","eddf5a0a":"code","d1a30d9e":"code","490d572d":"code","e5bcd08a":"code","83b46cd8":"code","18cc7661":"code","3fb4f729":"code","cb252044":"code","f4378dce":"code","b01664e6":"code","e46a01a7":"code","c2b5e81d":"code","acf5d715":"code","810b15af":"code","af912b31":"code","a5d1e046":"code","a1bcc613":"code","7faab824":"code","4b91663e":"code","c032993a":"code","6d0f67c7":"code","027296e6":"code","429bce50":"code","cc99fdb5":"code","cf56cd2c":"code","dee6c5b3":"code","981d630a":"code","96d2cdd8":"code","7ef08067":"code","91a737bc":"code","c3d0cdd0":"code","88d679ee":"code","0ed9e770":"code","3565206e":"code","c0d6e5cf":"code","857ed248":"code","a557dd24":"code","8c066150":"code","a61cb85c":"code","4aae41dc":"code","ea539b4c":"code","c3ed9422":"code","f16bdcdb":"code","937a6614":"code","166fa9cc":"code","a97222a3":"code","dcba9513":"code","095b2af6":"code","6a452136":"code","7aff03e7":"code","58d40258":"code","ba51eaa1":"code","38a7b566":"code","735579f6":"code","b7467b0e":"code","a2e64d53":"code","e990672a":"code","f7951baa":"code","4a383b68":"code","9d02d036":"code","581722fd":"code","29d60743":"code","98a4ea32":"code","c3a8e449":"code","853fba09":"code","b2fcbf23":"code","b5be185c":"code","229a5abf":"code","3cc97073":"code","8185fa92":"code","0adac2d7":"code","ccbc493a":"code","0c40b2cd":"code","cef490c4":"code","13cc90f0":"markdown","1a246bb7":"markdown","c20ff6b9":"markdown","ae426a31":"markdown","b9d5620c":"markdown","d20fb1d2":"markdown","03b89bbe":"markdown","28dd20af":"markdown","917e84a1":"markdown","514095db":"markdown","0e343e16":"markdown","ae7829f6":"markdown","123a7079":"markdown"},"source":{"ef21591d":"import numpy as np\nimport pandas as pd\n\nimport os\nimport re","87b45352":"from sklearn.datasets import fetch_20newsgroups\nfrom collections import Counter","4efe2902":"print(os.listdir(\"..\/input\"))","c413436c":"train = pd.read_csv('..\/input\/20-newsgroups-ciphertext-challenge\/train.csv')\ntest = pd.read_csv('..\/input\/20-newsgroups-ciphertext-challenge\/test.csv')","6fae0535":"train_chars = train['ciphertext'].map(len).sum()\ntest_chars = test['ciphertext'].map(len).sum()","f0c1d8e7":"train_plain = fetch_20newsgroups(subset='train')\ntest_plain = fetch_20newsgroups(subset='test')","c241eb32":"train_plain = pd.DataFrame(data = np.c_[train_plain['data'], train_plain['target']],\n                    columns= ['plaintext','target'])\n\ntest_plain = pd.DataFrame(data = np.c_[test_plain['data'], test_plain['target']],\n                    columns= ['plaintext','target'])","36dedfaf":"train_plain_chars = train_plain['plaintext'].map(len).sum()\ntest_plain_chars = test_plain['plaintext'].map(len).sum()","d6477663":"print('# of characters in train ciphertexts: {:,}'.format(train_chars))\nprint('# of characters in test ciphertexts: {:,}'.format(test_chars))\nprint('# of characters in train&test ciphertexts: {:,}'.format(train_chars + test_chars))","f2644ced":"print('# of characters in train plaintexts: {:,}'.format(train_plain_chars))\nprint('# of characters in test plaintexts: {:,}'.format(test_plain_chars))\nprint('# of characters in train&test plaintexts: {:,}'.format(train_plain_chars + test_plain_chars))","2854abc7":"difficulty_level = 1\n\ndf_c = pd.concat([train[train['difficulty']==difficulty_level][['ciphertext']],\n                  test[test['difficulty']==difficulty_level][['ciphertext']]], axis = 0).rename(columns={'ciphertext':'text'})\n\ndf_p = pd.concat([train_plain[['plaintext']],\n                  test_plain[['plaintext']]], axis = 0).rename(columns={'plaintext':'text'})","12fe757e":"def char_freqs(df):\n    text = ''.join(df['text'])\n    freqs = 100 * pd.Series(Counter(text)) \/ len(text)\n    freqs.sort_values(ascending= False, inplace=True)\n    return(freqs)","cc135c3c":"c_freqs = char_freqs(df_c)\np_freqs = char_freqs(df_p)","56d39bf7":"c_freqs.head()","6943372e":"p_freqs.head()","25b570be":"c_freqs.describe()","3c5cc811":"p_freqs.describe()","4fc4bd6a":"def filter_freqs(freqs, freqs_thresh, freqs_sep_thresh):\n    freqs = freqs[freqs > freqs_thresh]\n    freqs_sep = pd.concat([freqs.diff(-1),-freqs.diff(1)],axis=1).apply(np.nanmin, axis=1)\n    freqs_sep = freqs_sep[freqs_sep > freqs_sep_thresh]\n    return(freqs[freqs_sep.index])","fde8be82":"c_freqs = filter_freqs(c_freqs, 0.25, 0.10)\np_freqs = filter_freqs(p_freqs, 0.25, 0.10)","4e84de2b":"char_dic = pd.concat([pd.DataFrame(c_freqs).reset_index().rename(columns={'index' : 'c',0:'c_freq'}),\n                      pd.DataFrame(p_freqs).reset_index().rename(columns={'index' : 'p',0:'p_freq'})],\n                      axis=1).dropna()","cb153c14":"char_dic","3959bb11":"ciphertext = '1'.join(df_c['text'])\nplaintext = ' '.join(df_p['text'])","7bbfb96c":"def word_freqs(s, seps):\n    words = list(filter(None, re.split('[' + ''.join(seps) + ']+',s)))\n    freqs = pd.Series(words).value_counts()\n    freqs = freqs.reset_index().rename(columns={'index' : 'word', 0:'count'})\n    freqs['word_len'] = freqs['word'].map(len)\n    freqs['abs_freq'] = 100 * freqs['count'] \/ len(words)\n    freqs = pd.merge(freqs,\n                     freqs.groupby('word_len')[['count']].sum().reset_index().rename(columns={'count' : 'word_len_count'}),\n                     on='word_len')\n    freqs['rel_freq'] = 100 * freqs['count'] \/ freqs['word_len_count']\n    freqs.sort_values(by='abs_freq',ascending=False,inplace=True)\n    return(freqs)","1d702e01":"c_words = word_freqs(ciphertext,['1','s'])","d6d65cb6":"p_words = word_freqs(plaintext,[' ','\\n'])","dcc5f408":"c_words.head(15)","f6a27cc4":"p_words.head(15)","a62485e2":"c_words.describe()","1021ab06":"p_words.describe()","e556a63f":"c_freqs = filter_freqs(c_words.set_index('word')['abs_freq'], 0.25, 0.05)\np_freqs = filter_freqs(p_words.set_index('word')['abs_freq'], 0.25, 0.05)","fd778134":"words_dic = pd.concat([pd.DataFrame(c_freqs).reset_index().rename(columns={'index' : 'c',0:'c_freq'}),\n                      pd.DataFrame(p_freqs).reset_index().rename(columns={'index' : 'p',0:'p_freq'})],\n                      axis=1).dropna()","3bc90f87":"words_dic","75531517":"words_dic = words_dic.loc[words_dic.iloc[:,0].map(len) == words_dic.iloc[:,2].map(len)]","deb5e96a":"def dico_update(c_list, p_list, dico):\n    for i, w in enumerate(c_list):\n        for j, c in enumerate(w):\n            if c in dico:\n                assert(dico[c] == p_list[i][j])\n            elif p_list[i][j] in dico.values():\n                assert(c == p_list[i][j])\n            else:\n                dico[c] =  p_list[i][j]\n    return(dico)","0b8aa92d":"cp_dico = dico_update(words_dic.iloc[:,0].values,words_dic.iloc[:,2].values,dict(zip(''.join(char_dic['c']), ''.join(char_dic['p']))))","63e3f211":"cp_dico","f1d0846c":"translation = str.maketrans(''.join(cp_dico.keys()), ''.join(cp_dico.values()))\nc_words['word'] = c_words['word'].map(lambda x: x.translate(translation))","30f85cf8":"c_words.head()","e63ffebd":"word_len = 3","7cfd0d12":"c_words[c_words['word_len'] == word_len].sort_values(by='rel_freq',ascending=False).head(10)","d304dda9":"p_words[p_words['word_len'] == word_len].sort_values(by='rel_freq',ascending=False).head(10)","de063fb0":"cp_dico['o'] = 'y'\ncp_dico['c'] = 'u'\ncp_dico['_'] = 'c'\ncp_dico['{'] = 'T'\ncp_dico['\\x03'] = 'b' ","8a9a4366":"ciphertext = '1'.join(df_c['text'])\nc_words = word_freqs(ciphertext,['1','s'])\ntranslation = str.maketrans(''.join(cp_dico.keys()), ''.join(cp_dico.values()))\nc_words['word'] = c_words['word'].map(lambda x: x.translate(translation))","186f4391":"word_len = 4","a100f44a":"c_words[c_words['word_len'] == word_len].sort_values(by='rel_freq',ascending=False).head(10)","d20d8a2d":"p_words[p_words['word_len'] == word_len].sort_values(by='rel_freq',ascending=False).head(10)","c2790380":"cp_dico['z'] = 'v'\ncp_dico['a'] = 'i'\ncp_dico['W'] = 'w'\ncp_dico['-'] = 'm'","7033be57":"ciphertext = '1'.join(df_c['text'])\nc_words = word_freqs(ciphertext,['1','s'])\ntranslation = str.maketrans(''.join(cp_dico.keys()), ''.join(cp_dico.values()))\nc_words['word'] = c_words['word'].map(lambda x: x.translate(translation))","c5772723":"word_len = 5","375817fb":"c_words[c_words['word_len'] == word_len].sort_values(by='rel_freq',ascending=False).head(10)","436234fe":"p_words[p_words['word_len'] == word_len].sort_values(by='rel_freq',ascending=False).head(10)","199e209f":"cp_dico['*'] = 'F'\ncp_dico['G'] = ':'\ncp_dico[';'] = '\\''\ncp_dico['f'] = 'k'","5de17878":"ciphertext = '1'.join(df_c['text'])\nc_words = word_freqs(ciphertext,['1','s'])\ntranslation = str.maketrans(''.join(cp_dico.keys()), ''.join(cp_dico.values()))\nc_words['word'] = c_words['word'].map(lambda x: x.translate(translation))","589cc454":"word_len = 6","40f489e6":"c_words[c_words['word_len'] == word_len].sort_values(by='rel_freq',ascending=False).head(10)","932d1dc5":"p_words[p_words['word_len'] == word_len].sort_values(by='rel_freq',ascending=False).head(10)","16bcb801":"cp_dico['F'] = 'L'\ncp_dico['\\''] = 'p'\ncp_dico['d'] = 'g'","6e5d9e23":"ciphertext = '1'.join(df_c['text'])\nc_words = word_freqs(ciphertext,['1','s'])\ntranslation = str.maketrans(''.join(cp_dico.keys()), ''.join(cp_dico.values()))\nc_words['word'] = c_words['word'].map(lambda x: x.translate(translation))","c0018d32":"word_len = 8","059ec755":"c_words[c_words['word_len'] == word_len].sort_values(by='rel_freq',ascending=False).head(10)","42fcebf1":"p_words[p_words['word_len'] == word_len].sort_values(by='rel_freq',ascending=False).head(10)","9706f227":"c_words[c_words['word_len'] == word_len].sort_values(by='rel_freq',ascending=False).head(10).iloc[1,0][0]","5d57b3de":"cp_dico['>'] = 'S'\ncp_dico['X'] = 'j'\ncp_dico['d'] = 'g'\ncp_dico['\\x1a'] = 'q' ","9725298d":"ciphertext = '1'.join(df_c['text'])\nc_words = word_freqs(ciphertext,['1','s'])\ntranslation = str.maketrans(''.join(cp_dico.keys()), ''.join(cp_dico.values()))\nc_words['word'] = c_words['word'].map(lambda x: x.translate(translation))","d00235cc":"word_len = 9","b6941279":"c_words[c_words['word_len'] == word_len].sort_values(by='rel_freq',ascending=False).head(15)","80fa4be5":"p_words[p_words['word_len'] == word_len].sort_values(by='rel_freq',ascending=False).head(15)","78e382b8":"cp_dico['w'] = 'K'\ncp_dico['2'] = 'C'\ncp_dico[':'] = 'I'\ncp_dico['9'] = 'P'","dbffa1c4":"ciphertext = '1'.join(df_c['text'])\nc_words = word_freqs(ciphertext,['1','s'])\ntranslation = str.maketrans(''.join(cp_dico.keys()), ''.join(cp_dico.values()))\nc_words['word'] = c_words['word'].map(lambda x: x.translate(translation))","981de3d7":"word_len = 10","6fde8625":"c_words[c_words['word_len'] == word_len].sort_values(by='rel_freq',ascending=False).head(15)","7a27311d":"p_words[p_words['word_len'] == word_len].sort_values(by='rel_freq',ascending=False).head(15)","646a261a":"cp_dico['@'] = 'U'\ncp_dico['x'] = 'D'\ncp_dico['+'] = 'x'","0c22bab0":"ciphertext = '1'.join(df_c['text'])\nc_words = word_freqs(ciphertext,['1','s'])\ntranslation = str.maketrans(''.join(cp_dico.keys()), ''.join(cp_dico.values()))\nc_words['word'] = c_words['word'].map(lambda x: x.translate(translation))","cfe79aed":"word_len = 11","aa9fe2f1":"c_words[c_words['word_len'] == word_len].sort_values(by='rel_freq',ascending=False).head(15)","66ed419b":"p_words[p_words['word_len'] == word_len].sort_values(by='rel_freq',ascending=False).head(15)","ab825125":"cp_dico['T'] = ','\ncp_dico['%'] = 'O'","2afd4e0a":"ciphertext = '1'.join(df_c['text'])\nc_words = word_freqs(ciphertext,['1','s'])\ntranslation = str.maketrans(''.join(cp_dico.keys()), ''.join(cp_dico.values()))\nc_words['word'] = c_words['word'].map(lambda x: x.translate(translation))","8504880a":"word_len = 12","064ddd54":"c_words[c_words['word_len'] == word_len].sort_values(by='rel_freq',ascending=False).head(15)","230d0f7e":"p_words[p_words['word_len'] == word_len].sort_values(by='rel_freq',ascending=False).head(15)","39831a14":"c_words[c_words['word_len'] == word_len].sort_values(by='rel_freq',ascending=False).head(15).iloc[1,0][-1]","8a08d857":"c_words[c_words['word_len'] == word_len].sort_values(by='rel_freq',ascending=False).head(15).iloc[3,0][3]","d4f0ec06":"cp_dico['\\x08'] = '.'\ncp_dico['q'] = '-'\ncp_dico['\\x1e'] = 'R' \ncp_dico['h'] = 'z'","1c5257ea":"ciphertext = '1'.join(df_c['text'])\nc_words = word_freqs(ciphertext,['1','s'])\ntranslation = str.maketrans(''.join(cp_dico.keys()), ''.join(cp_dico.values()))\nc_words['word'] = c_words['word'].map(lambda x: x.translate(translation))","29982b2c":"word_len = 13","3af2055a":"c_words[c_words['word_len'] == word_len].sort_values(by='rel_freq',ascending=False).head(15)","ce091892":"p_words[p_words['word_len'] == word_len].sort_values(by='rel_freq',ascending=False).head(15)","11878242":"c_words[c_words['word_len'] == word_len].sort_values(by='rel_freq',ascending=False).head(15).iloc[2,0][2]","b6ddb0c0":"cp_dico['!'] = 'X'\ncp_dico['\\x7f'] = 'N'\ncp_dico['\/'] = 'A'","2eceb1c6":"ciphertext = '1'.join(df_c['text'])\nc_words = word_freqs(ciphertext,['1','s'])\ntranslation = str.maketrans(''.join(cp_dico.keys()), ''.join(cp_dico.values()))\nc_words['word'] = c_words['word'].map(lambda x: x.translate(translation))","391cddb0":"word_len = 14","0323af54":"c_words[c_words['word_len'] == word_len].sort_values(by='rel_freq',ascending=False).head(15)","fbb41499":"p_words[p_words['word_len'] == word_len].sort_values(by='rel_freq',ascending=False).head(15)","b48a170e":"cp_dico['b'] = '@'","3e9abaf9":"ciphertext = '1'.join(df_c['text'])\n\nundecoded = ''.join(set(ciphertext).difference(set(cp_dico.keys())))\nset_undecoded = set(undecoded)\n\nc_words = word_freqs(ciphertext,['1','s'])\nc_words['to_decode'] = c_words['word'].map(lambda x: any((c in set(undecoded)) for c in x))\ntranslation = str.maketrans(''.join(cp_dico.keys()), ''.join(cp_dico.values()))\nc_words['word'] = c_words['word'].map(lambda x: x.translate(translation))","54903178":"word_len = 6","c99e1c37":"c_words[(c_words['word_len'] == word_len) & (c_words['to_decode'] == True)].sort_values(by='rel_freq',ascending=False).head(15)","a2a69108":"cp_dico['}'] = 'J'\ncp_dico['J'] = 'B'\ncp_dico['e'] = 'M'\ncp_dico['\"'] = 'G'","95b13f38":"target = 1","0fe7bc3a":"df_c = train[(train['difficulty'] == difficulty_level) & (train['target'] == target)].copy()\ntranslation = str.maketrans(''.join(cp_dico.keys()), ''.join(cp_dico.values()))\ndf_c['ciphertext'] = df_c['ciphertext'].map(lambda x: x.translate(translation))","a27ca00d":"df_c.head()","1ed89df4":"df_p = pd.concat([train_plain[train_plain['target'] == str(target)],\n                  test_plain[test_plain['target'] == str(target)]], axis = 0)","fbb14ff8":"def complete_dico(c,p):\n    cp_dico_temp = {}\n    for i,cc in enumerate(c.replace('\\n ','\\n')):\n        if cc != p[i]:\n            if cc not in cp_dico_temp:\n                cp_dico_temp[cc] = p[i]\n                print('cp_dico[\\'{}\\'] = \\'{}\\''.format(cc,p[i]))","99f05a27":"c_index = 398\nc = df_c.loc[c_index,'ciphertext']\nprint(c)","8090e977":"c_sample = 'dfr@usna.navy.mil'","3614f22d":"df_p.head()","55b68b0a":"df_p[df_p['plaintext'].str.contains(c_sample)]","3b7c3d58":"p_index = 5620\np = df_p.loc[p_index,'plaintext']\nprint(p)","bc884c07":"complete_dico(c,p)","b74b5f8b":"c","ab6a3702":"p","e02c7d60":"cp_dico['|'] = '('\ncp_dico['y'] = ')'\ncp_dico['g'] = 'H'\ncp_dico['u'] = '3'\ncp_dico['\\x06'] = '7'\ncp_dico['\\t'] = '5'\ncp_dico[','] = '4'\ncp_dico['L'] = '1'\ncp_dico['\\\\'] = '0'\ncp_dico['n'] = '8'\ncp_dico['['] = '>'\ncp_dico[r' '] = '<'","ae7d8357":"df_c = train[(train['difficulty'] == difficulty_level) & (train['target'] == target)].copy()\ntranslation = str.maketrans(''.join(cp_dico.keys()), ''.join(cp_dico.values()))\ndf_c['ciphertext'] = df_c['ciphertext'].map(lambda x: x.translate(translation))","ce9bb9c9":"df_c.head()","fccb7414":"c_index = 146\nc = df_c.loc[c_index,'ciphertext']\nprint(c)","103ff7df":"c_sample = 'now back to lurking'","baa3de9a":"df_p[df_p['plaintext'].str.contains(c_sample)]","e454c940":"p_index = 1156\np = df_p.loc[p_index,'plaintext']\nprint(p)","35ef2ac6":"p = p[p.find(c_sample):]","5b2126d2":"complete_dico(c,p)","4616e321":"cp_dico['r'] = '&'\ncp_dico['l'] = 'W'\ncp_dico['\\x18'] = 'V'","a610482c":"df_c = train[(train['difficulty'] == difficulty_level) & (train['target'] == target)].copy()\ntranslation = str.maketrans(''.join(cp_dico.keys()), ''.join(cp_dico.values()))\ndf_c['ciphertext'] = df_c['ciphertext'].map(lambda x: x.translate(translation))","85641cac":"df_c.head(15)","af8d14ef":"c_index = 807\nc = df_c.loc[c_index,'ciphertext']\nprint(c)","00dcd84e":"c_sample = 'bpirenne@eso.org'","b6474314":"df_p[df_p['plaintext'].str.contains(c_sample)]","6fef8fce":"p_index = 3864\np = df_p.loc[p_index,'plaintext']\nprint(p)","3f0ff015":"c_sample = 'iga computer.'\np = p[p.find(c_sample):]\nprint(p)","a17a1506":"complete_dico(c,p)","2529bea5":"cp_dico['U'] = '['\ncp_dico['i'] = ']'\ncp_dico['3'] = ';'\ncp_dico[' '] = '<'\ncp_dico['~'] = '+'\ncp_dico['<'] = '9'\ncp_dico['H'] = '2'\ncp_dico['5'] = '6'","c3b88d43":"df_c = train[(train['difficulty'] == difficulty_level) & (train['target'] == target)].copy()\ntranslation = str.maketrans(''.join(cp_dico.keys()), ''.join(cp_dico.values()))\ndf_c['ciphertext'] = df_c['ciphertext'].map(lambda x: x.translate(translation))","c817c81f":"df_c.tail(15)","cba032c9":"c_index = 38295\nc = df_c.loc[c_index,'ciphertext']\nprint(c)","861d35ae":"c_sample = 'ones I know about are from Maximum Strategy'","282b5b5c":"df_p[df_p['plaintext'].str.contains(c_sample)]","044b73e1":"p_index = 3474\np = df_p.loc[p_index,'plaintext']\nprint(p)","b7089ded":"c_sample = 'y that can do 180MB'\np = p[p.find(c_sample):]\nprint(p)","d0ea7954":"complete_dico(c,p)","7c4081d5":"cp_dico['?'] = '\/'","7710ebb4":"df_c = train[(train['difficulty'] == difficulty_level)].copy()\nc_alphabet = pd.Series(Counter(''.join(df_c['ciphertext'])))\nc_alphabet.shape","d99b67cd":"len(cp_dico)","86f6d2f3":"print('We have manually decoded {:.0%} of the cipher #1'.format(len(cp_dico)\/c_alphabet.shape[0]))","ff72adc1":"df_p = pd.concat([train_plain,test_plain], axis = 0)","01876136":"undecoded = set(c_alphabet.index).difference(cp_dico.keys())\nundecoded = list(undecoded)\nprint(undecoded)","71da9f94":"df_c_focus = df_c[df_c['ciphertext'].str.contains('4')].copy()\n\ntranslation = str.maketrans(''.join(cp_dico.keys()), ''.join(cp_dico.values()))\ndf_c_focus['ciphertext'] = df_c_focus['ciphertext'].map(lambda x: x.translate(translation))\n\ndf_c_focus","0d693f65":"c_sample = 'Imagination is more important than knowledge'\ndf_c_focus[df_c_focus['ciphertext'].str.contains(c_sample)]","5e46642c":"c_index = 34448\nc = df_c_focus.loc[c_index,'ciphertext']\nprint(c)","2047b1a2":"c_sample = 'Imagination is more important than knowledge'","978627bb":"df_p[df_p['plaintext'].str.contains(c_sample)]","ed9af9a6":"p_index = 7391\np = df_p.loc[p_index,'plaintext']\nprint(p)","f1b2b6f7":"p = df_p.loc[p_index,'plaintext'].iloc[1]","64dfcc01":"print(p)","4948f4e1":"complete_dico(c,p[-350:]) ","21c8220d":"cp_dico['4'] = '|'\ncp_dico['Z'] = '='\ncp_dico['.'] = '~'\ncp_dico['m'] = '\\\\'\ncp_dico['\\x10'] = 'Y'\ncp_dico[')'] = '_'","296827bd":"undecoded = set(c_alphabet.index).difference(cp_dico.keys())\nundecoded = list(undecoded)\nprint(undecoded)","a2571bf0":"df_c_focus = df_c[df_c['ciphertext'].str.contains('S')].copy()\n\ntranslation = str.maketrans(''.join(cp_dico.keys()), ''.join(cp_dico.values()))\ndf_c_focus['ciphertext'] = df_c_focus['ciphertext'].map(lambda x: x.translate(translation))\n\ndf_c_focus","c0615a73":"c_index = 15690\nc = df_c_focus.loc[c_index,'ciphertext']\nprint(c)","21fb9a7c":"c_sample = 'I know there are lots of graphics-board companies out'\ndf_p[df_p['plaintext'].str.contains(c_sample)]","69c45e7c":"p_index = 9998\np = df_p.loc[p_index,'plaintext']\nprint(p)","30f9b4ae":"complete_dico(c,p) ","51227328":"p","036b143d":"c","c26574c8":"cp_dico['S'] = '\\x08'\ncp_dico['6'] = '\"'\ncp_dico['&'] = '?'","e3a2693c":"undecoded = set(c_alphabet.index).difference(cp_dico.keys())\nundecoded = list(undecoded)\nprint(undecoded)","79b3f476":"df_c_focus = df_c[df_c['ciphertext'].str.contains('I')].copy()\n\ntranslation = str.maketrans(''.join(cp_dico.keys()), ''.join(cp_dico.values()))\ndf_c_focus['ciphertext'] = df_c_focus['ciphertext'].map(lambda x: x.translate(translation))\n\ndf_c_focus","33f4a0ef":"c_index = 1501\nc = df_c_focus.loc[c_index,'ciphertext']\nprint(c)","aecce2c5":"c_sample = 'got the same error when I tried to build'\ndf_p[df_p['plaintext'].str.contains(c_sample)]","6d4e6816":"p_index = 9368\np = df_p.loc[p_index,'plaintext']\nprint(p)","77bbafd3":"complete_dico(c,p[862:])  ","982db81f":"cp_dico['\\x1c'] = '*'\ncp_dico['Q'] = '\\t'\ncp_dico['I'] = '}'","00d5d586":"undecoded = set(c_alphabet.index).difference(cp_dico.keys())\nundecoded = list(undecoded)\nprint(undecoded)","9e7d8c3a":"df_c_focus = df_c[df_c['ciphertext'].str.contains('B')].copy()\n\ntranslation = str.maketrans(''.join(cp_dico.keys()), ''.join(cp_dico.values()))\ndf_c_focus['ciphertext'] = df_c_focus['ciphertext'].map(lambda x: x.translate(translation))\n\ndf_c_focus","026d99b6":"c_index = 37028\nc = df_c_focus.loc[c_index,'ciphertext']\nprint(c)","eddf5a0a":"c_sample = 'to think about for the remote machine'\ndf_p[df_p['plaintext'].str.contains(c_sample)]","d1a30d9e":"p_index = 2593\np = df_p.loc[p_index,'plaintext']\nprint(p)","490d572d":"p = df_p.loc[p_index,'plaintext'].iloc[1]\nprint(p)","e5bcd08a":"complete_dico(c,p[23543:])   ","83b46cd8":"cp_dico['`'] = '#'\ncp_dico['B'] = '$'\ncp_dico['P'] = '!'\ncp_dico['k'] = '{'\ncp_dico['Y'] = '`'","18cc7661":"undecoded = set(c_alphabet.index).difference(cp_dico.keys())\nundecoded = list(undecoded)\nprint(undecoded)","3fb4f729":"df_c_focus = df_c[df_c['ciphertext'].str.contains('V')].copy()\n\ntranslation = str.maketrans(''.join(cp_dico.keys()), ''.join(cp_dico.values()))\ndf_c_focus['ciphertext'] = df_c_focus['ciphertext'].map(lambda x: x.translate(translation))\n\ndf_c_focus","cb252044":"c_index = 3\nc = df_c_focus.loc[c_index,'ciphertext']\nprint(c)","f4378dce":"c_sample = 'also hearty proponents of'\ndf_p[df_p['plaintext'].str.contains(c_sample)] ","b01664e6":"p_index = 928\np = df_p.loc[p_index,'plaintext']\nprint(p)","e46a01a7":"p = df_p.loc[p_index,'plaintext'].iloc[0]\nprint(p)","c2b5e81d":"complete_dico(c,p[2617:])   ","acf5d715":"cp_dico['V'] = 'Q'","810b15af":"undecoded = set(c_alphabet.index).difference(cp_dico.keys())\nundecoded = list(undecoded)\nprint(undecoded)","af912b31":"df_c_focus = df_c[df_c['ciphertext'].str.contains('D')].copy()\n\ntranslation = str.maketrans(''.join(cp_dico.keys()), ''.join(cp_dico.values()))\ndf_c_focus['ciphertext'] = df_c_focus['ciphertext'].map(lambda x: x.translate(translation))\n\ndf_c_focus","a5d1e046":"c_index = 4840\nc = df_c_focus.loc[c_index,'ciphertext']\nc","a1bcc613":"c_sample = 'out the environment and their future'\ndf_p[df_p['plaintext'].str.contains(c_sample)] ","7faab824":"p_index = 11142\np = df_p.loc[p_index,'plaintext']\nprint(p)","4b91663e":"p[2642:]","c032993a":"cp_dico['D'] = '\\x0c'   ","6d0f67c7":"undecoded = set(c_alphabet.index).difference(cp_dico.keys())\nundecoded = list(undecoded)\nprint(undecoded)","027296e6":"df_c_focus = df_c[df_c['ciphertext'].str.contains('=')].copy()\n\ntranslation = str.maketrans(''.join(cp_dico.keys()), ''.join(cp_dico.values()))\ndf_c_focus['ciphertext'] = df_c_focus['ciphertext'].map(lambda x: x.translate(translation))\n\ndf_c_focus","429bce50":"c_index = 31228\nc = df_c_focus.loc[c_index,'ciphertext']\nprint(c)","cc99fdb5":"c_sample = 'Kyle P Hunter'\ndf_p[df_p['plaintext'].str.contains(c_sample)] ","cf56cd2c":"p_index = 5507\np = df_p.loc[p_index,'plaintext']\nprint(p)","dee6c5b3":"p = df_p.loc[p_index,'plaintext'].iloc[1]","981d630a":"print(p)","96d2cdd8":"complete_dico(c,p)   ","7ef08067":"cp_dico['='] = '\\x10'","91a737bc":"df_c_focus = df_c[df_c['ciphertext'].str.contains('\\$')].copy()\n\ntranslation = str.maketrans(''.join(cp_dico.keys()), ''.join(cp_dico.values()))\ndf_c_focus['ciphertext'] = df_c_focus['ciphertext'].map(lambda x: x.translate(translation))\n\ndf_c_focus","c3d0cdd0":"c_index = 11727\nc = df_c_focus.loc[c_index,'ciphertext']\nprint(c)","88d679ee":"c_sample = 'georgel@NeoSoft.com'\ndf_p[df_p['plaintext'].str.contains(c_sample)] ","0ed9e770":"p_index = 5150\np = df_p.loc[p_index,'plaintext']\nprint(p)","3565206e":"p = df_p.loc[p_index,'plaintext'].iloc[1]","c0d6e5cf":"complete_dico(c,p[292:])   ","857ed248":"cp_dico['$'] = '\\x02'","a557dd24":"df_c_focus = df_c[df_c['ciphertext'].str.contains('K')].copy()\n\ntranslation = str.maketrans(''.join(cp_dico.keys()), ''.join(cp_dico.values()))\ndf_c_focus['ciphertext'] = df_c_focus['ciphertext'].map(lambda x: x.translate(translation))\n\ndf_c_focus","8c066150":"c_index = 232\nc = df_c_focus.loc[c_index,'ciphertext']\nprint(c)","a61cb85c":"c_sample = 'From: szh@zcon.com'\ndf_p[df_p['plaintext'].str.contains(c_sample)] ","4aae41dc":"p_index = 7361\np = df_p.loc[p_index,'plaintext']\nprint(p)","ea539b4c":"p = df_p.loc[p_index,'plaintext'].iloc[1]","c3ed9422":"complete_dico(c,p)   ","f16bdcdb":"cp_dico['K'] = 'Z'","937a6614":"df_c_focus = df_c[df_c['ciphertext'].str.contains('p')].copy()\n\ntranslation = str.maketrans(''.join(cp_dico.keys()), ''.join(cp_dico.values()))\ndf_c_focus['ciphertext'] = df_c_focus['ciphertext'].map(lambda x: x.translate(translation))\n\ndf_c_focus","166fa9cc":"c_index = 9981\nc = df_c_focus.loc[c_index,'ciphertext']\nprint(c)","a97222a3":"c_sample = 'Since it is a Life Time membership, you won'\ndf_p[df_p['plaintext'].str.contains(c_sample)] ","dcba9513":"p_index = 4938\np = df_p.loc[p_index,'plaintext']\nprint(p)","095b2af6":"p = df_p.loc[p_index,'plaintext'].iloc[0]","6a452136":"print(p)","7aff03e7":"cp_dico['p'] = '\\x1e'  ","58d40258":"df_c_focus = df_c[df_c['ciphertext'].str.contains('\\(')].copy()\n\ntranslation = str.maketrans(''.join(cp_dico.keys()), ''.join(cp_dico.values()))\ndf_c_focus['ciphertext'] = df_c_focus['ciphertext'].map(lambda x: x.translate(translation))\n\ndf_c_focus","ba51eaa1":"c_index = 38567\nc = df_c_focus.loc[c_index,'ciphertext']\nprint(c)","38a7b566":"c_sample = 'After all the space walking,  they are going to  re-boost the HST'\ndf_p[df_p['plaintext'].str.contains(c_sample)] ","735579f6":"p_index = 810\np = df_p.loc[p_index,'plaintext']\nprint(p)","b7467b0e":"p = df_p.loc[p_index,'plaintext'].iloc[1]","a2e64d53":"print(p)","e990672a":"cp_dico[r'('] = '^'","f7951baa":"df_c_focus = df_c[df_c['ciphertext'].str.contains('\\x0c')].copy()\n\ntranslation = str.maketrans(''.join(cp_dico.keys()), ''.join(cp_dico.values()))\ndf_c_focus['ciphertext'] = df_c_focus['ciphertext'].map(lambda x: x.translate(translation))\n\ndf_c_focus","4a383b68":"c_index = 38788\nc = df_c_focus.loc[c_index,'ciphertext']","9d02d036":"c","581722fd":"c_sample = 'From: dbl@visual.com'\ndf_p[df_p['plaintext'].str.contains(c_sample)] ","29d60743":"p_index = 1459\np = df_p.loc[p_index,'plaintext']\nprint(p)","98a4ea32":"p = df_p.loc[p_index,'plaintext'].iloc[0]","c3a8e449":"p","853fba09":"cp_dico['\\x0c'] = r'%'","b2fcbf23":"df_c_focus = df_c[df_c['ciphertext'].str.contains('E')].copy()\n\ntranslation = str.maketrans(''.join(cp_dico.keys()), ''.join(cp_dico.values()))\ndf_c_focus['ciphertext'] = df_c_focus['ciphertext'].map(lambda x: x.translate(translation))\n\ndf_c_focus","b5be185c":"c_index = 392\nc = df_c_focus.loc[c_index,'ciphertext']\nc","229a5abf":"cp_dico['E'] = 'E'","3cc97073":"print('We have manually decoded {:.2%} of the cipher #1'.format(len(cp_dico)\/c_alphabet.shape[0]))","8185fa92":"cipher1_df = pd.DataFrame(list(cp_dico.values()),index=list(cp_dico.keys()),columns=['plain']).reset_index().rename(columns={'index' : 'cipher'})","0adac2d7":"cipher1_df.head()","ccbc493a":"cipher1_df.to_csv('cipher1_map.csv', index=False)","0c40b2cd":"cipher2_df = pd.read_csv('..\/input\/cipher-2-full-solution\/cipher2_map.csv')","cef490c4":"cipher2_df.to_csv('cipher2_map.csv', index=False)","13cc90f0":"# And we are done!","1a246bb7":"# And using either manual or automated cryptanalysis...\nIt is as easy to decrypt cipher #2","c20ff6b9":"We focus on cipher #1","ae426a31":"# Character Analysis\n\nAs discussed in other kernels, like https:\/\/www.kaggle.com\/mithrillion\/enigma-was-gimped-by-weather-reports, cipher #1 is very probably a substitution cipher, so we start our cryptanalysis by attempting to match character frequencies.","b9d5620c":"# Word Analysis\n\nThanks to the previous step, we have been able to identify some important characters, namely some word separators, blank space and newline. We can now move on to words frequency analysis.\n\nWe start by looking at the most frequent words overall, then we look at the most frequent words by word length and last we look at words that contain specific characters.","d20fb1d2":"Now that our mapping dictionary has reached a decent size, we have to refine our search to avoid stumbling only upon fully decoded characters, since we started by the most frequent ones.","03b89bbe":"Stay tuned for the next kernel on automated cryptanalysis in which we will sum up the lessons learnt during the above manual work... and for the cryptanalysis of cipher #3 if you request it enough ;-)","28dd20af":"# Loading the Datasets","917e84a1":"So as discussed https:\/\/www.kaggle.com\/c\/20-newsgroups-ciphertext-challenge\/discussion\/74701 , the mapping between plain and cipher texts will probably not be exact as their number of characters are not equal.","514095db":"Where do we stand now?","0e343e16":"To finish the cryptanalysis we have to look specifically for the undecoded characters in plaintext\/ciphertext message pairs","ae7829f6":"# Message Analysis\n\nAfter the previous step, we could move one to fully pairing messages together","123a7079":"This kernel focuses on the cryptanalysis of the ciphers.\n* It contains a **full manual cryptanalysis of cipher #1** before we move on to an automated one (cipher1_map.csv).\n* It contains also the results of a **full cryptanalysis of cipher #2** (cipher2_map.csv)\n\nThe sole purpose of the manual cryptanalysis illustrated on cipher #1 are:\n* To give an idea of what's doable manually on cipher #1 (spoiler alert: a lot)\n* To demonstrate how tedious and time-consuming this manual analysis can be\n* To illustrate the needs and requirements for automated cryptanalysis tools  (spoiler alert: fuzzywuzzy)\n\nThere is already a very nice automated kernel that has been published: https:\/\/www.kaggle.com\/rturley\/a-first-crack-tools-and-first-cipher-solution\n\nHere is the cryptanalysis plan we will follow:\n* Take advantage of the existing knowledge on the issue at hand, here we know that:\n  * The plaintexts corresponding to our ciphertexts are part of the 20 newsgroups dataset\n  * The cipher #1 is a substitution cipher: it is a simple table wich maps a plaintext character to a ciphertext character  \n* Analyze the most frequent characters in the ciphertexts and compare them to the plaintexts ones. \n  * Our hope is to be able to match a few usual suspects that pop out statistically in English like e or t. \n  * And more importantly to identify words separators (the space or newline characters) which would allow us to move on to the next step\n* Analyze the most frequent words in the ciphertexts and compare them to the plaintexts ones.\n  * If we have partially decoded words that we can recognize then we can increase of knowledge of the cipher map\n* Complete the cryptanalysis by specifically looking for less frequent characters and matching plaintexts and ciphertexts pairs\n\nIn short: Characters > Words > Messages\n    "}}