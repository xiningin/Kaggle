{"cell_type":{"1dc7cae4":"code","4875d162":"code","158e90c8":"code","08ca9010":"code","74a05d13":"code","776eb303":"code","a8b6f65b":"code","eb5decfc":"code","b728e672":"code","3493c8ff":"code","a4b1f3c6":"code","c695bcdd":"code","b09db2b0":"code","a7a5ff85":"code","c41e1bec":"code","8e6d4a75":"code","302c94e0":"code","05dd9072":"code","85980c0c":"code","52dd047d":"code","5f7db6a9":"code","dc57bd38":"code","9f29ecee":"code","d4bbab49":"code","10ae24be":"code","4fa7e6d4":"code","4eb9516f":"code","0c866003":"code","dfc315ec":"markdown","b41e608e":"markdown","c02213b8":"markdown","f723c968":"markdown","d9e16c88":"markdown","85e42456":"markdown","49bb0e03":"markdown","6ac29fbf":"markdown"},"source":{"1dc7cae4":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport warnings\nwarnings.filterwarnings('ignore')","4875d162":"sms=pd.read_csv('..\/input\/sms-spam-collection-dataset\/spam.csv')\nsms.head()","158e90c8":"pd.set_option('display.max_colwidth', None)","08ca9010":"sms.head()","74a05d13":"#Removing unneccesary columns\nsms.drop(['Unnamed: 2','Unnamed: 3','Unnamed: 4'],axis=1,inplace=True)\n\n#Renaming rest columns\nsms.rename(columns={'v1':'label','v2':'message'},inplace=True)","776eb303":"sms.head()","a8b6f65b":"sms.shape","eb5decfc":"sms['label'].value_counts()","b728e672":"print('Spam Ratio = ',np.round(len(sms[sms[\"label\"]=='spam'])\/len(sms['label']),2)*100)\nprint('Ham Ratio = ',np.round(len(sms[sms[\"label\"]=='ham'])\/len(sms['label']),2)*100)","3493c8ff":"#New column for length of message\nsms['length']=sms['message'].str.len()\nsms.head()","a4b1f3c6":"#Label coding 0 and 1\nsms['label'].replace({'ham':0,'spam':1},inplace=True)","c695bcdd":"sms['label'].value_counts()","b09db2b0":"#Convert all messages to lower case\nsms['message']=sms['message'].str.lower()","a7a5ff85":"sms.head()","c41e1bec":"#Replace email addresses with 'email_address'\nsms['message']=sms['message'].str.replace(r'\\w+\\.*\\w+@\\w+\\.\\w+','email_address')\n\n#URL's with 'web_address'\nsms['message']=sms['message'].str.replace(r'https\\:\/\/\\w+\\.\\w+\\.\\w+','web_address')\n\n#Replace money symbols with 'moneysymb'\nsms['message']=sms['message'].str.replace(r'\\$|\u20ac|\u20b9|rs\\.*','moneysymb')\n\n#Replace phone numbers with 'phone_num'\nsms['message']=sms['message'].str.replace(r'\\d{11}|\\d{12}','phone_num')\n\n#Replace number with 'num_ber'\nsms['message']=sms['message'].str.replace(r'\\d+\\.{0,1}\\d+','num_ber')","8e6d4a75":"#Remove punctuations\nsms['message']=sms['message'].str.replace(r'[^\\w\\d\\s]',' ')\n\n#Replace white spaces with one space\nsms['message']=sms['message'].str.replace(r'[\\s+]',' ')\n\n#Remove leading and trailing space\nsms['message']=sms['message'].str.replace(r'^\\s+|\\s+$','')","302c94e0":"#Removing Stopwords\nfrom nltk.corpus import stopwords\nsw=set(stopwords.words('english')+['u','\u016b','ur','im','dont','doin','ure'])\n\nsms['message']=sms['message'].apply(lambda x: ' '.join(term for term in x.split() if term not in sw))","05dd9072":"#New column (clean length) after removal of punctuations and stopwords\nsms['clean_length']=sms['message'].str.len()\nsms.head()","85980c0c":"print('Original length',sms['length'].sum())\nprint('Cleaned length',sms['clean_length'].sum())","52dd047d":"#Message distribution before cleaning\nf,ax=plt.subplots(1,2,figsize=(15,8))\n\nsns.distplot(sms[sms['label']==1]['length'],bins=20,ax=ax[0],label='Spam message distribution',color='r')\n\nax[0].set_xlabel('Spam message length')\nax[0].legend()\n\nsns.distplot(sms[sms['label']==0]['length'],bins=20,ax=ax[1],label='Ham message distribution',color='b')\n\nax[1].set_xlabel('Ham message length')\nax[1].legend()\n\nplt.show()","5f7db6a9":"#Message distribution after cleaning\nf,ax=plt.subplots(1,2,figsize=(15,8))\n\nsns.distplot(sms[sms['label']==1]['clean_length'],bins=20,ax=ax[0],label='Spam message distribution',color='r')\n\nax[0].set_xlabel('Spam message length')\nax[0].legend()\n\nsns.distplot(sms[sms['label']==0]['clean_length'],bins=20,ax=ax[1],label='Ham message distribution',color='b')\n\nax[1].set_xlabel('Ham message length')\nax[1].legend()\n\nplt.show()","dc57bd38":"#Getting sense of loud words in spam\nfrom wordcloud import WordCloud\n\nspams=sms['message'][sms['label']==1]\nspamcloud=WordCloud(width=1200,height=800,background_color='white',max_words=25).generate(' '.join(spams))\n\nplt.figure(figsize=(12,8),facecolor='r')\nplt.imshow(spamcloud)\nplt.axis('off')\nplt.tight_layout(pad=0)\nplt.show()","9f29ecee":"#Getting sense of loud words in Ham\nfrom wordcloud import WordCloud\n\nspams=sms['message'][sms['label']==0]\nspamcloud=WordCloud(width=1200,height=800,background_color='white',max_words=25).generate(' '.join(spams))\n\nplt.figure(figsize=(12,8),facecolor='k')\nplt.imshow(spamcloud)\nplt.axis('off')\nplt.tight_layout(pad=0)\nplt.show()","d4bbab49":"#Convert text into vectors\n#Split feature and label\nfrom sklearn.feature_extraction.text import TfidfVectorizer\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import accuracy_score, classification_report, confusion_matrix\n\ntf_vec=TfidfVectorizer()\nfeatures=tf_vec.fit_transform(sms['message'])\n\nx=features\ny=sms['label']\n\nxtrain,xtest,ytrain,ytest=train_test_split(x,y,test_size=0.3,random_state=7)","10ae24be":"from sklearn.naive_bayes import MultinomialNB\nnaiv=MultinomialNB()\nnaiv.fit(xtrain,ytrain)\npred=naiv.predict(xtest)","4fa7e6d4":"print('Accuracy score', accuracy_score(pred,ytest))\nprint('-----------------------------------------')\nprint('Confusion Matrix')\nprint(confusion_matrix(pred,ytest))\nprint('-----------------------------------------')\nprint('Classification Report')\nprint(classification_report(pred,ytest))","4eb9516f":"from sklearn.ensemble import RandomForestClassifier\nmodel=RandomForestClassifier()\nmodel.fit(xtrain,ytrain)\npred=model.predict(xtest)","0c866003":"print('Accuracy score', accuracy_score(pred,ytest))\nprint('-----------------------------------------')\nprint('Confusion Matrix')\nprint(confusion_matrix(pred,ytest))\nprint('-----------------------------------------')\nprint('Classification Report')\nprint(classification_report(pred,ytest))","dfc315ec":"We can clearly see some words such as free, prize, win, claim, cash are indication of spam words","b41e608e":"Dataset have 5572 rows and 2 columns","c02213b8":"# Spam Detection","f723c968":"### Naive Bayes","d9e16c88":"### Random Forest","85e42456":"1. Read Dataset and make it in proper format\n2. Encode Labels\n3. Conver to lower case\n4. Remove Punctuations\n5. Remove Stopwords\n6. Check stats of messages\n7. Convert all texts into vectors\n8. Import Classifier\n9. Train and Test\n10. Check the accuracy\/Confusion matrix","49bb0e03":"# **Please Upvote if you like my work. Thanks and God Bless you!!!**","6ac29fbf":"![](https:\/\/miro.medium.com\/max\/1024\/1*pWzWiDuVsox3nmeK_8pqlg.png)"}}