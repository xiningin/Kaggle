{"cell_type":{"fc4c4a0f":"code","2720b5b7":"code","81dfc0ed":"code","fa9db11c":"code","797239db":"code","de9816b3":"code","bb3e5187":"code","8f59632b":"code","b689d3d6":"code","ff66abce":"code","d5f0a919":"code","3c66a2a3":"code","c004f787":"code","1bcd0f51":"code","0e5db807":"code","9547e7db":"code","07013165":"code","e3c2b225":"code","c0eeae29":"code","a37fcf80":"code","c7a09f0b":"code","66c9be0a":"code","9ec73223":"code","d07a1eaf":"code","28c8bdaf":"markdown","d5184c3a":"markdown","5b852804":"markdown","d2bf5331":"markdown","290877d0":"markdown","cac700e5":"markdown","361981a0":"markdown","22e89f8e":"markdown","3c67b054":"markdown","f9e63c92":"markdown","0ba35606":"markdown","96c201e4":"markdown","97c1cc01":"markdown","6605a4ea":"markdown"},"source":{"fc4c4a0f":"#importing the libraries\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport pandas as pd\nimport seaborn as sns\nfrom sklearn.metrics import mean_squared_error, r2_score\nfrom sklearn.compose import ColumnTransformer\nfrom sklearn.preprocessing import OneHotEncoder\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LinearRegression","2720b5b7":"#getting the data\ndf = pd.read_csv(\"..\/input\/fish-market\/Fish.csv\")","81dfc0ed":"#show the first five elements of the dataframe\ndf.head()","fa9db11c":"#segregation of numerical columns and categorical columns\ncat_col = df.select_dtypes(include=['object']).columns\nnum_col = df.select_dtypes(exclude=['object']).columns\ndf_cat = df[cat_col]\ndf_num = df[num_col]","797239db":"#Informations about the dataframe\ndf.info()","de9816b3":"#analyzing if there is null values\ndf_null = df.isna().mean()\ndf_null.sort_values(ascending = False)","bb3e5187":"df.dtypes","8f59632b":"outliers = ['Weight']\nplt.rcParams['figure.figsize'] = [8,8]\nsns.boxplot(data=df[outliers], orient=\"v\", palette=\"Set1\" ,whis=1.5,saturation=1, width=0.7)\nplt.title(\"Outliers Variable Distribution\", fontsize = 14, fontweight = 'bold')\nplt.ylabel(\"Profit Range\", fontweight = 'bold')\nplt.xlabel(\"Continuous Variable\", fontweight = 'bold')\ndf.shape","b689d3d6":"#checking for duplicates\n\ndf.loc[df.duplicated()]","ff66abce":"#Visualizing the diferent fish species\nplt.rcParams['figure.figsize'] = [5,5]\nax=df['Species'].value_counts().plot(kind='bar',stacked=True, colormap = 'Set1', color= \"green\")\nax.title.set_text('Number of fishes per species')\nplt.xlabel(\"Names of the Species\",fontweight = 'bold')\nplt.ylabel(\"Count of Fishes\",fontweight = 'bold')","d5f0a919":"plt.figure(figsize=(8,8))\n\nplt.title('Fishes\\' Weight Plot')\nsns.distplot(df['Weight'])","3c66a2a3":"ax = sns.pairplot(df[num_col])","c004f787":"plt.figure(figsize = (8, 8))\nsns.heatmap(df.corr(), cmap=\"RdYlGn\")\nplt.show()","1bcd0f51":"plt.figure(figsize=(8, 8))\nsns.boxplot(x = 'Species', y = 'Weight', data = df)\nplt.show()","0e5db807":"#Separating the dependent and independent values\ny = df.iloc[:, 1].values\nX = df.drop(columns=['Weight'])","9547e7db":"#transforming the categorical value\nct = ColumnTransformer(transformers = [(\"enconder\", OneHotEncoder(), [0])],\n                       remainder = \"passthrough\")\nX = np.array(ct.fit_transform(X))","07013165":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.1, random_state = 0)","e3c2b225":"regressor = LinearRegression()\nregressor.fit(X_train, y_train)","c0eeae29":"y_pred = regressor.predict(X_test)\nnp.set_printoptions(precision = 2)\nprint(np.concatenate((y_pred.reshape(len(y_pred), 1), y_test.reshape(len(y_test), 1)), 1))","a37fcf80":"r2_score(y_pred, y_test)","c7a09f0b":"print(\"R2 value is \" + str(r2_score(y_pred, y_test)))\nprint(\"The Mean Squared Error is \" + str(mean_squared_error(y_test, y_pred)))","66c9be0a":"# getting the coeficients of the model\nregressor.coef_","9ec73223":"#getting the constant of the model\nregressor.intercept_","d07a1eaf":"#Visualizing once again the dataset\ndf.head()","28c8bdaf":"Insight:\n* The distribution of weight is assimetric to the right","d5184c3a":"The R2 score is 0,921 which represents an accuracy of the linear regression of 92,1%. This is a very good model to predict future values of fishes' weight.","5b852804":"Once again, it won't be necessary do any preprocessing because there aren't no duplicated row","d2bf5331":"Insights:\n* The dimensions of the fishes are linear correlated with its weight\n* The dimensions also are linear correlated with each other","290877d0":"# Predicting Fish Weights with Multiple Linear Regression","cac700e5":"Creating a label to show the equations:\n\n$ x_{1} $ = Lenght 1\n\n$ x_{2} $ = Lenght 2\n\n$ x_{3} $ = Lenght 3\n\n$ x_{4} $ = Height\n\n$ x_{5} $ = Width\n\n$ d_{1} $ = Boolean variable to represent if the specie is Bream\n\n$ d_{2} $ = Boolean variable to represent if the specie is Parkki\n\n$ d_{3} $ = Boolean variable to represent if the specie is Perch\n\n$ d_{4} $ = Boolean variable to represent if the specie is Pike\n\n$ d_{5} $ = Boolean variable to represent if the specie is Roach\n\n$ d_{6} $ = Boolean variable to represent if the specie is Smelt\n\n$ d_{7} $ = Boolean variable to represent if the specie is WhiteFish\n\n$y$ = Weight\n\n\nSo, the equation is:\n\n$y = -808.19  - 109.91d_{1} + 42.93d_{2} + 41.33d_{3} - 260.14d_{4} + 4.42d_{5} + 347.87d_{6} -66.51d_{7} - 89.11x_{1} + 87.41x_{2} + 31.63x_{3} + 7.76x_{4} + 2.36x_{5}$","361981a0":"We can notice that, based on the values of the coeficients, the Smelt specie has the most positive impact in the weight and the Pike Specie has the most negative impact.\nAlso, the Lenght 2 has the greater positive impact in the weight and the lenght 1 has the greater negative impact.","22e89f8e":"Insight:\n* The weight is correlated with all the fishes' dimensions except the height","3c67b054":"There are 3 outliers. However, the amount of data is too low, so they won't be removed.","f9e63c92":"As can be noticed, there aren't null values in the dataset so it won't be necessary a preprocessing to take care about it.","0ba35606":"The objective of this problem is to predict the weight of some fishes based on its species and dimensions.\n\nThis problem resolution is going to be organized in the following sections:\n\n* **Section 1** - Data Analysis and Insights\n* **Section 2** - Getting the training set and the test set\n* **Section 3** - Getting the model\n* **Section 4** - Conclusions about the model","96c201e4":"Insights:\n* There are few outliers in the Roach and Smelt species","97c1cc01":"Insight:\n* The Perch specie has the largest amount of fishes\n* The Whitefish specie has the least amount of fishes ","6605a4ea":"### Section 1 - Data Analysis and Insights"}}