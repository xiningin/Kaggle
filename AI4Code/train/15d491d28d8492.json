{"cell_type":{"7b8a2043":"code","3b9e8846":"code","011986cb":"code","89974330":"code","75af2a32":"code","41234f87":"code","9e556d28":"code","7d7f7d79":"code","46ecf178":"code","e43368d8":"code","b1aead4d":"code","609acf15":"code","999c265d":"code","8048eba9":"code","e95b2ef3":"code","af7b34d4":"code","3bd1f0b3":"code","ee1e6195":"code","0dcfbb4d":"code","b5e8d910":"code","c3a74662":"code","29c1c9cf":"code","8e28ffc5":"code","67f9a256":"code","b9fea674":"code","2c137c62":"code","d2295939":"code","125f3fee":"code","4d5aff67":"code","8b0315de":"code","50695b28":"markdown","3cf5c704":"markdown","1d336cc4":"markdown","21fc0a58":"markdown","b79725fe":"markdown","cc72893b":"markdown","c94fcf0b":"markdown","09169bff":"markdown","effed023":"markdown","d27da0c7":"markdown","8dbc754d":"markdown"},"source":{"7b8a2043":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","3b9e8846":"import warnings\nwarnings.filterwarnings('ignore')","011986cb":"import matplotlib.pyplot as plt\nimport seaborn as sns\nimport datetime","89974330":"import warnings\nwarnings.filterwarnings('ignore')","75af2a32":"df_vac=pd.read_csv('\/kaggle\/input\/israel-coronavirus-dataset\/Number of vaccinators daily.csv')\ndf_covid=pd.read_csv('\/kaggle\/input\/israel-coronavirus-dataset\/corona_age_and_gender.csv')\ndf_death_hos=pd.read_csv('\/kaggle\/input\/israel-coronavirus-dataset\/Deaths and hospitalized.csv')","41234f87":"df_vac.head()","9e556d28":"df_covid.head()","7d7f7d79":"df_death_hos.head()","46ecf178":"df_vac['Date']=pd.to_datetime(df_vac['Date'],format='%d-%m-%Y')","e43368d8":"df_vac.info()","b1aead4d":"df_covid['first_week_day']=pd.to_datetime(df_covid['first_week_day'],format='%d\/%m\/%Y')\ndf_covid['last_week_day']=pd.to_datetime(df_covid['last_week_day'],format='%d\/%m\/%Y')","609acf15":"df_covid.info()","999c265d":"df_death_hos['Date']=pd.to_datetime(df_death_hos['Date'],format='%d-%m-%Y')","8048eba9":"df_vac.info()","e95b2ef3":"df_death_hos.info()","af7b34d4":"df1=pd.DataFrame(df_vac.sum())\ndf1=df1.rename(columns={0: 'Total'})\ndf1.plot.barh()","3bd1f0b3":"df_covid.plot.bar(x='first_week_day',y=['weekly_tests_num'],figsize=(20,5))","ee1e6195":"df_covid.plot.bar(x='first_week_day',y=['weekly_cases'],figsize=(20,5))","0dcfbb4d":"df_covid.plot.bar(x='first_week_day',y=['weekly_deceased'],figsize=(20,5))","b5e8d910":"df_covid.groupby(['gender'])['weekly_tests_num','weekly_cases','weekly_deceased'].sum().plot.bar(figsize=(20,8))","c3a74662":"df_covid.groupby(['age_group'])['weekly_tests_num','weekly_cases','weekly_deceased'].sum().plot.bar(figsize=(20,8))","29c1c9cf":"df_case=df_death_hos.loc[:,['new _critical_cases']]","8e28ffc5":"df_case.plot(figsize=(30,8))","67f9a256":"from keras.models import Sequential\nfrom keras.layers import Dense, Dropout, LSTM","b9fea674":"df_ts=df_case.rename(columns={'new _critical_cases': 'Num'})","2c137c62":"from sklearn.preprocessing import MinMaxScaler\nscaler = MinMaxScaler(feature_range=(0, 1))","d2295939":"dataset = df_ts\n\ntrain = dataset[0:500]\nvalid = dataset[501:]\n\nscaler = MinMaxScaler(feature_range=(0, 1))\nscaled_data = scaler.fit_transform(dataset)\n\nx_train, y_train = [], []\nfor i in range(60,len(train)):\n    x_train.append(scaled_data[i-60:i,0])\n    y_train.append(scaled_data[i,0])\nx_train, y_train = np.array(x_train), np.array(y_train)\n\nx_train = np.reshape(x_train, (x_train.shape[0],x_train.shape[1],1))\n\nmodel = Sequential()\nmodel.add(LSTM(units=50, return_sequences=True, input_shape=(x_train.shape[1],1)))\nmodel.add(LSTM(units=50))\nmodel.add(Dense(1))\n\nmodel.compile(loss='mean_squared_error', optimizer='adam')\nmodel.fit(x_train, y_train, epochs=1, batch_size=1, verbose=2)\n\ninputs = df_ts[len(df_ts) - len(valid) - 60:].values\ninputs = inputs.reshape(-1,1)\ninputs  = scaler.transform(inputs)\n\nX_test = []\nfor i in range(60,inputs.shape[0]):\n    X_test.append(inputs[i-60:i,0])\nX_test = np.array(X_test)\n\nX_test = np.reshape(X_test, (X_test.shape[0],X_test.shape[1],1))\npred = model.predict(X_test)\npred = scaler.inverse_transform(pred)","125f3fee":"rms=np.sqrt(np.mean(np.power((valid-pred),2)))\nrms","4d5aff67":"train = df_ts[:500]\nvalid = df_ts[501:]\nvalid['Predictions'] = pred\nplt.figure(figsize=(30,10))\nplt.plot(train['Num'])\nplt.plot(valid[['Num','Predictions']])","8b0315de":"train = df_ts[:500]\nvalid = df_ts[501:]\nplt.figure(figsize=(30,10))\nvalid['Predictions'] = pred\nplt.plot(valid[['Num','Predictions']])","50695b28":"# Vaccine shot is very effective to reduce critical case, hospitalize and deaths.","3cf5c704":"# 1) Data Preprocessing","1d336cc4":"# 3) Critical case prediction model by LSTM","21fc0a58":"# The numbers of each vaccines","b79725fe":"# Tests number, cases number and deceased number by gender and age group","cc72893b":"# Time series graph which I made by Tableau.\n# * By vaccine shots, the numbers of deaths, hospitalized and new critical case are decreasing !","c94fcf0b":"# 2) Visualization","09169bff":"# After third shot, how can we predict covid-19 ?","effed023":"# Weekly tests number, cases number and deceased number","d27da0c7":"![\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9 1-3.png](attachment:c582b297-4a52-4c66-87f3-0481b9474e0a.png)","8dbc754d":"![\u30c0\u30c3\u30b7\u30e5\u30dc\u30fc\u30c9 1-32.png](attachment:98c08d23-ecb8-40c3-a798-3dbb57da200c.png)"}}