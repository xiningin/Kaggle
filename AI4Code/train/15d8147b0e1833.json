{"cell_type":{"51a02b89":"code","67a4eec4":"code","57c69376":"code","d5236ad0":"code","e42eda71":"code","6af60115":"code","2d9249a7":"code","837c21d6":"code","a6f3c9fd":"code","178f382d":"code","6b4deda9":"code","e6ca3901":"markdown","4cdd1969":"markdown","407bba40":"markdown","c85780bf":"markdown","73c1f34e":"markdown","2508994c":"markdown"},"source":{"51a02b89":"import pandas as pd \nimport matplotlib.pyplot as plt\nimport seaborn as sns \nimport numpy as np\n%matplotlib inline\nfrom mlxtend.frequent_patterns import apriori\nfrom mlxtend.frequent_patterns import association_rules","67a4eec4":"df=pd.read_csv(\"..\/input\/online-retail-ii-uci\/online_retail_II.csv\")\ndf","57c69376":"df.isnull().sum()","d5236ad0":"data=df.drop(\"Customer ID\",axis=1)\ndata.dropna()\ndata.info()","e42eda71":"data[\"Description\"]=data[\"Description\"].str.strip()\ndata[\"Invoice\"]=data[\"Invoice\"].astype(\"str\")","6af60115":"data[\"Country\"].value_counts()","2d9249a7":"#Separating the transactions for france\nmybasket=(data[data[\"Country\"]==\"France\"]\n          .groupby([\"Invoice\",\"Description\"])[\"Quantity\"]\n          .sum().unstack().reset_index().fillna(0)\n          .set_index(\"Invoice\"))\nmybasket\n","837c21d6":"def encode_units(x):\n    if x<=0:\n        return 0\n    if x>=1:\n        return 1\nbasket=mybasket.applymap(encode_units)\nbasket=basket.drop(\"POSTAGE\",axis=1)\nbasket","a6f3c9fd":"frequent_itemsets=apriori(basket,min_support=0.07,use_colnames=True)\nrules=association_rules(frequent_itemsets,metric=\"lift\",min_threshold=1)\nrules.head()","178f382d":"sns.distplot(x=rules[\"confidence\"],hist=True)","6b4deda9":"rule1=rules[(rules[\"lift\"]>=0.08) & (rules[\"confidence\"])]\nrule1","e6ca3901":"# Model Training","4cdd1969":"# Data Preparation","407bba40":"# **(SET\/6 RED SPOTTY PAPER PLATES) & (SET\/6 RED SPOTTY PAPER CUPS) \n# (SET\/6 RED SPOTTY PAPER CUPS) & (SET\/6 RED SPOTTY PAPER PLATES)\n\n# are the two sets of products that are frequently bought together both the sets have highest support and confidience","c85780bf":"# Result","73c1f34e":"# Reading Data","2508994c":"Droping Customer Id and removing description having NA values and removing spaces in Description"}}