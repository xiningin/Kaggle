{"cell_type":{"58b967a1":"code","514cabfa":"code","c3ad2119":"code","cbb3f5f7":"code","bcd9b6e6":"code","d322f54d":"code","dd41ab00":"code","17e74d35":"code","7c4b20a9":"code","9b5275f2":"code","f142f47b":"code","a1ae3abd":"code","79daf12d":"code","ccd14936":"code","cd11d301":"code","0b276660":"code","93ed651b":"code","d54bb00b":"code","8e55bc90":"code","c9fc432f":"code","9f4d058d":"code","38b47a77":"code","d7381971":"code","daf71382":"code","e6dd592e":"code","48ce9e6f":"code","718d1c2f":"code","0cbfa17f":"code","6177c04f":"markdown","ae4a559c":"markdown","d3fa3c2d":"markdown","682177d9":"markdown"},"source":{"58b967a1":"#for analysis\n\nimport numpy as np \nimport pandas as pd\n\n# for vizualization\n\nimport plotly.express as px\nfrom plotly.offline import plot, iplot, init_notebook_mode\ninit_notebook_mode(connected=True)\nimport plotly.graph_objects as go\nfrom plotly.subplots import make_subplots\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\n#Machine Learning\n\nfrom sklearn.cluster import KMeans","514cabfa":"df = pd.read_csv(\"..\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv\")","c3ad2119":"df.head()","cbb3f5f7":"df.isna().sum()","bcd9b6e6":"df.info()","d322f54d":"df.shape","dd41ab00":"df.drop([\"CustomerID\"],axis=1,inplace = True)","17e74d35":"df","7c4b20a9":"\nn = 0\nfor x in [\"Age\" , 'Annual Income (k$)','Spending Score (1-100)']:\n    n += 1 \n    plt.figure(2,figsize = (38,6))\n    plt.subplot(1,3,n)\n\n    sns.distplot(df[x],bins = 20)\n    plt.title('Distplot of {}'.format(x))\n    plt.show()","9b5275f2":"n = 0\nfor x in [\"Age\" , 'Annual Income (k$)','Spending Score (1-100)']:\n    n += 1 \n    plt.figure(1,figsize = (38,6))\n    plt.subplot(1,3,n)\n    sns.violinplot(x = x,y = \"Gender\",data = df)\n    plt.ylabel(\"Gender\" if n == 1 else '')\n    plt.title('violinplot of {}'.format(x))\n    plt.show()","f142f47b":"import plotly.express as px\n\nfig = px.scatter(df, x=\"Annual Income (k$)\", y=\"Spending Score (1-100)\", facet_col=\"Gender\",\n                 width=1000, height=600)\n\nfig.update_layout(\n    margin=dict(l=20, r=20, t=20, b=20),\n    paper_bgcolor=\"LightSteelBlue\",\n)\n\nfig.show()","a1ae3abd":"\nfig = px.scatter(df, x='Annual Income (k$)', y='Spending Score (1-100)',color=\"Gender\",width=1000, height=600)\nfig.update_layout(title='Annual Income (k$) Vs Spending Score (1-100) With Gender ',\n                  xaxis_title=\"Annual Income (k$)\",yaxis_title=\"Spending Score (1-100) \",title_x=0.5)\nfig.show()","79daf12d":"plt.figure(figsize=(10,6))\nsns.kdeplot(\n   data=df, x=\"Annual Income (k$)\", hue=\"Gender\",\n   fill=True, common_norm=False, palette=\"rocket\",\n   alpha=.5, linewidth=0,\n)\n\nplt.title('Annual Income of Male vs Female', fontsize=18)\nplt.show()","ccd14936":"x1 = df.loc[:,[\"Age\" , \"Spending Score (1-100)\"]].values\n\nWCSS = []\nfor k in range(1,11):\n    kmeans = KMeans(n_clusters = k , init = \"k-means++\")\n    kmeans.fit(x1)\n    WCSS.append(kmeans.inertia_)\nplt.figure(figsize=(12,6))\nplt.grid()\nplt.plot(range(1,11),WCSS,linewidth = 2,color=\"m\",marker=\"*\")","cd11d301":"kmeans.inertia_","0b276660":"kmeans = KMeans(n_clusters=4)\nlabel = kmeans.fit_predict(x1)\nprint(label)","93ed651b":"kmeans.cluster_centers_","d54bb00b":"plt.figure(1,figsize = (12,8))\nplt.grid()\nplt.scatter(x1[:,0],x1[:,1],c = kmeans.labels_,cmap = 'rainbow')\nplt.scatter(kmeans.cluster_centers_[:,0],kmeans.cluster_centers_[:,1],color = \"k\")\nplt.xlabel(\"Age\")\nplt.ylabel(\"spending score\")\nplt.title(\"Clusters of customers\")\nplt.show()","8e55bc90":"x2 = df.loc[:,[\"Annual Income (k$)\" , \"Spending Score (1-100)\"]].values\n\nWCSS = []\nfor k in range(1,11):\n    kmeans = KMeans(n_clusters = k , init = \"k-means++\")\n    kmeans.fit(x2)\n    WCSS.append(kmeans.inertia_)\nplt.figure(figsize=(12,6))\nplt.grid()\nplt.plot(range(1,11),WCSS,linewidth = 2,color=\"red\",marker=\"*\")","c9fc432f":"kmeans1 = KMeans(n_clusters=5)\nlabel = kmeans1.fit_predict(x2)\nprint(label)","9f4d058d":"plt.figure(1,figsize = (12,8))\nplt.grid()\nplt.scatter(x2[:,0],x2[:,1],c = kmeans1.labels_,cmap = 'rainbow')\nplt.scatter(kmeans.cluster_centers_[:,0],kmeans.cluster_centers_[:,1],color = \"k\")\nplt.xlabel(\"Age\")\nplt.ylabel(\"spending score\")\nplt.title(\"Clusters of customers\")\nplt.show()","38b47a77":"x3 = df.iloc[:,1:]\nx3","d7381971":"WCSS = []\nfor k in range(1,11):\n    kmeans = KMeans(n_clusters = k , init = \"k-means++\")\n    kmeans.fit(x3)\n    WCSS.append(kmeans.inertia_)\nplt.figure(figsize=(12,6))\nplt.grid()\nplt.plot(range(1,11),WCSS,linewidth = 1,color=\"green\",marker=\"8\")","daf71382":"kmeans2 = KMeans(n_clusters=5)\nlabel = kmeans2.fit_predict(x3)\nprint(label)","e6dd592e":"kmeans2.cluster_centers_","48ce9e6f":"clusters = kmeans2.fit_predict(x3)\ndf[\"label\"] = clusters","718d1c2f":"from mpl_toolkits.mplot3d import Axes3D\n\nfig = plt.figure(figsize = (20,10))\nax = fig.add_subplot(111,projection = '3d')\n\nax.scatter(df.Age[df.label == 0] , df[\"Annual Income (k$)\"][df.label == 0] , df[\"Spending Score (1-100)\"][df.label == 0],c = \"r\",s=60)\nax.scatter(df.Age[df.label == 1] , df[\"Annual Income (k$)\"][df.label == 1] , df[\"Spending Score (1-100)\"][df.label == 1],c = \"y\",s=60)\nax.scatter(df.Age[df.label == 2] , df[\"Annual Income (k$)\"][df.label == 2] , df[\"Spending Score (1-100)\"][df.label == 2],c = \"b\",s=60)\nax.scatter(df.Age[df.label == 3] , df[\"Annual Income (k$)\"][df.label == 3] , df[\"Spending Score (1-100)\"][df.label == 3],c = \"g\",s=60)\nax.scatter(df.Age[df.label == 4] , df[\"Annual Income (k$)\"][df.label == 4] , df[\"Spending Score (1-100)\"][df.label == 4],c = \"m\",s=60)\n","0cbfa17f":"fig = px.scatter_3d(df, x=df.Age, y=df[\"Annual Income (k$)\"], z=df[\"Spending Score (1-100)\"],\n              symbol='label',size='label', size_max=18,color = 'label',\n              opacity=0.7)\nfig.update_layout(margin=dict(l=0, r=0, b=0, t=0))\nfig.show()","6177c04f":"## visualisation ","ae4a559c":"**Clustering**","d3fa3c2d":"*The same plot in a interactive way*","682177d9":"*The data is already cleaned .*"}}