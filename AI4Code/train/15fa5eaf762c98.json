{"cell_type":{"5c465b47":"code","fb161693":"code","12685735":"code","71112348":"code","a18f5408":"code","52b9c3dc":"code","03a0f99b":"code","df01dabb":"code","d53af3b4":"code","103f1a36":"code","fc9cae48":"code","368cb5ca":"code","a4a9b36a":"code","02799a18":"code","1df19c9a":"code","00ca56aa":"code","b5cd3284":"code","05d9bd41":"markdown","399e1603":"markdown","7c6cb680":"markdown","7b2d1cf8":"markdown","6b89e539":"markdown"},"source":{"5c465b47":"import numpy as np # linear algebra\nimport pandas as pd\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","fb161693":"import matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set()\n%matplotlib inline\n\ndf = pd.read_csv('..\/input\/creditcardfraud\/creditcard.csv')\nprint(df.shape)\ndf.head()","12685735":"df.isna().sum()","71112348":"df.describe()","a18f5408":"class_names = {0:'Not Fraud', 1:'Fraud'}\nprint(df.Class.value_counts().rename(index = class_names))","52b9c3dc":"fig = plt.figure(figsize = (15, 12))\n\nplt.subplot(5, 6, 1) ; plt.plot(df.V1) ; plt.subplot(5, 6, 15) ; plt.plot(df.V15)\nplt.subplot(5, 6, 2) ; plt.plot(df.V2) ; plt.subplot(5, 6, 16) ; plt.plot(df.V16)\nplt.subplot(5, 6, 3) ; plt.plot(df.V3) ; plt.subplot(5, 6, 17) ; plt.plot(df.V17)\nplt.subplot(5, 6, 4) ; plt.plot(df.V4) ; plt.subplot(5, 6, 18) ; plt.plot(df.V18)\nplt.subplot(5, 6, 5) ; plt.plot(df.V5) ; plt.subplot(5, 6, 19) ; plt.plot(df.V19)\nplt.subplot(5, 6, 6) ; plt.plot(df.V6) ; plt.subplot(5, 6, 20) ; plt.plot(df.V20)\nplt.subplot(5, 6, 7) ; plt.plot(df.V7) ; plt.subplot(5, 6, 21) ; plt.plot(df.V21)\nplt.subplot(5, 6, 8) ; plt.plot(df.V8) ; plt.subplot(5, 6, 22) ; plt.plot(df.V22)\nplt.subplot(5, 6, 9) ; plt.plot(df.V9) ; plt.subplot(5, 6, 23) ; plt.plot(df.V23)\nplt.subplot(5, 6, 10) ; plt.plot(df.V10) ; plt.subplot(5, 6, 24) ; plt.plot(df.V24)\nplt.subplot(5, 6, 11) ; plt.plot(df.V11) ; plt.subplot(5, 6, 25) ; plt.plot(df.V25)\nplt.subplot(5, 6, 12) ; plt.plot(df.V12) ; plt.subplot(5, 6, 26) ; plt.plot(df.V26)\nplt.subplot(5, 6, 13) ; plt.plot(df.V13) ; plt.subplot(5, 6, 27) ; plt.plot(df.V27)\nplt.subplot(5, 6, 14) ; plt.plot(df.V14) ; plt.subplot(5, 6, 28) ; plt.plot(df.V28)\nplt.subplot(5, 6, 29) ; plt.plot(df.Amount)\nplt.show()","03a0f99b":"from sklearn.model_selection import train_test_split","df01dabb":"feature_names = df.iloc[:, 1:30].columns\ntarget = df.iloc[:1, 30: ].columns\nprint(feature_names)\nprint(target)","d53af3b4":"data_features = df[feature_names]\ndata_target = df[target]","103f1a36":"X_train, X_test, y_train, y_test = train_test_split(data_features, data_target, train_size=0.70, test_size=0.30, random_state=1)\nprint(\"Length of X_train is: {X_train}\".format(X_train = len(X_train)))\nprint(\"Length of X_test is: {X_test}\".format(X_test = len(X_test)))\nprint(\"Length of y_train is: {y_train}\".format(y_train = len(y_train)))\nprint(\"Length of y_test is: {y_test}\".format(y_test = len(y_test)))","fc9cae48":"from sklearn.linear_model import LogisticRegression\nfrom sklearn.metrics import confusion_matrix\nfrom sklearn import metrics","368cb5ca":"type(y_train)","a4a9b36a":"y_train = y_train.values.ravel()","02799a18":"model = LogisticRegression(solver='liblinear')\nmodel.fit(X_train, y_train)","1df19c9a":"pred = model.predict(X_test)","00ca56aa":"class_names = ['not_fraud', 'fraud']\nmatrix = confusion_matrix(y_test, pred)\n# Create pandas dataframe\ndataframe = pd.DataFrame(matrix, index=class_names, columns=class_names)\n# Create heatmap\nsns.heatmap(dataframe, annot=True, cbar=None, cmap=\"Blues\", fmt = 'g')\nplt.title(\"Confusion Matrix\"), plt.tight_layout()\nplt.ylabel(\"True Class\"), plt.xlabel(\"Predicted Class\")\nplt.show()","b5cd3284":"from sklearn.metrics import f1_score, recall_score\nf1_score = round(f1_score(y_test, pred), 2)\nrecall_score = round(recall_score(y_test, pred), 2)\nprint(\"Sensitivity\/Recall for Logistic Regression Model 1 : {recall_score}\".format(recall_score = recall_score))\nprint(\"F1 Score for Logistic Regression Model 1 : {f1_score}\".format(f1_score = f1_score))","05d9bd41":"### Importing libraries","399e1603":"## Introduction","7c6cb680":"# Credit Card Fraud Detection using Python\n*Umesh Kumar*","7b2d1cf8":"## The number of Fraud and not Fraud Transactions","6b89e539":"### Evaluation\nFor a financial institution dealing with identifying fraud, Sensitivity and F1 - Score might be more important metrics. F1- Score reprsents a more balanced result as it is the harmonic mean between Precision and Recall. Sensitivity is more important in the sense that we are more interested in identifying fraud than than identifying legitimate customers. ( Assumption )"}}