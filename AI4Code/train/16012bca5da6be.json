{"cell_type":{"e1e6e4c9":"code","63bdb770":"code","de427e4b":"code","5f1742e8":"code","85ba5fba":"code","f35a0169":"code","7abf7203":"code","e038dc3a":"code","8f4ea52c":"code","9662150b":"code","c05cf8c6":"code","eaa06ea4":"code","6ff204eb":"code","40d31526":"code","9f4909c4":"code","002d9024":"code","a76abf7b":"code","05c0976a":"code","b5e546d9":"code","e835543f":"code","47a8da24":"code","def6b54a":"code","97d52abb":"code","a5d947e5":"code","cbe1403b":"code","3118e8fe":"code","411f632d":"code","643ea22e":"code","6a7acb30":"code","35623bbe":"code","15823938":"code","8c486ec8":"code","effd81d9":"code","5426aec2":"code","fb3ed495":"code","dfffb536":"code","9c1a5b4c":"code","c8f3fec4":"code","2d6d77d4":"code","ad0ba6be":"code","21493217":"code","2a863693":"code","7a35d9f2":"code","2c2efb9a":"code","cc0b706d":"markdown","7f1546b7":"markdown","f16031a8":"markdown","bbc25ab6":"markdown"},"source":{"e1e6e4c9":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","63bdb770":"train_df = pd.read_csv('..\/input\/nlp-getting-started\/train.csv')","de427e4b":"train_df.info()","5f1742e8":"train_df","85ba5fba":"train_df['text length'] = train_df['text'].apply(len)","f35a0169":"train_df.head()","7abf7203":"g = sns.FacetGrid(train_df, col='target')\ng.map(sns.histplot, 'text length', bins=35)","e038dc3a":"train_df['location'].isnull().sum()","8f4ea52c":"train_df['keyword'].isnull().sum()","9662150b":"train_df['keyword'].unique()","c05cf8c6":"sns.countplot(data=train_df, x='target')","eaa06ea4":"train_df['keyword'] = train_df['keyword'].str.replace('%20', ' ')","6ff204eb":"train_df['keyword'].nunique()","40d31526":"train_df[(train_df['target']==0)]","9f4909c4":"train_df[(train_df['target']==1)]","002d9024":"train_df['keyword'] = train_df['keyword'].fillna(train_df['keyword'].mode()[0])","a76abf7b":"train_df['location'] = train_df['location'].fillna(train_df['location'].mode()[0])","05c0976a":"plt.figure(figsize=(12, 12))\nsns.heatmap(train_df.isna())","b5e546d9":"train_df['new text'] = train_df['text'] +' '+ train_df['location'] +' '+ train_df['keyword']","e835543f":"train_df['new text'] = train_df['new text'].str.replace('#', ' ')","47a8da24":"train_df.head()","def6b54a":"test_df = pd.read_csv('..\/input\/nlp-getting-started\/test.csv')","97d52abb":"test_df","a5d947e5":"test_df['location'] = test_df['location'].fillna(test_df['location'].mode()[0])","cbe1403b":"test_df['keyword'] = test_df['keyword'].fillna(test_df['keyword'].mode()[0])","3118e8fe":"test_df['keyword'] = test_df['keyword'].str.replace('%20', ' ')","411f632d":"test_df['keyword'].nunique()","643ea22e":"test_df.isnull().sum()","6a7acb30":"plt.figure(figsize=(12, 12))\nsns.heatmap(test_df.isna())","35623bbe":"test_df['new text'] = test_df['text'] +' '+ test_df['location'] +' '+ test_df['keyword']","15823938":"test_df['new text'] = test_df['new text'].str.replace('#', ' ')","8c486ec8":"test_df.head()","effd81d9":"train_df.head()","5426aec2":"test_df.head()","fb3ed495":"from sklearn.feature_extraction.text import CountVectorizer\nfrom sklearn.naive_bayes import MultinomialNB\nfrom sklearn.pipeline import Pipeline","dfffb536":"X_train = train_df['new text']\ny_train = train_df['target']\nX_test = test_df['new text']","9c1a5b4c":"vectorizer = CountVectorizer()\nX_train = vectorizer.fit_transform(X_train)\nX_test = vectorizer.transform(X_test)","c8f3fec4":"nb = MultinomialNB()\nnb.fit(X_train, y_train)","2d6d77d4":"pipeline = Pipeline([\n    ('bow', CountVectorizer()),  # strings to token integer counts\n    ('classifier', MultinomialNB()),  # train on TF-IDF vectors w\/ Naive Bayes classifier\n])","ad0ba6be":"X_train = train_df['new text']\ny_train = train_df['target']\nX_test = test_df['new text']","21493217":"pipeline.fit(X_train, y_train)","2a863693":"y_test = pipeline.predict(X_test)","7a35d9f2":"submission_df = pd.read_csv('..\/input\/nlp-getting-started\/sample_submission.csv')\nsubmission_df['target'] = y_test\nsubmission_df.to_csv('.\/submission.csv', index=False)","2c2efb9a":"submission_df = pd.read_csv('submission.csv')\nsubmission_df","cc0b706d":"# Data Training","7f1546b7":"can't use the same training data as last time because that data has already been vectorized.","f16031a8":"# Modelling","bbc25ab6":"# Data Testing"}}