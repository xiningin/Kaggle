{"cell_type":{"020b2d61":"code","f9f1e57c":"code","d6ff525b":"code","23bdd487":"code","0774bb54":"code","63ee5fb6":"code","fb63fc0e":"code","fc870820":"code","d581d082":"code","bba53f44":"code","b3381d50":"code","7a87b64f":"code","0bed31a4":"code","f0fcedcd":"code","7042b718":"code","2852974e":"code","ba7dfdca":"code","b0f7bfa8":"code","2b23b93d":"code","ce7cad7e":"code","c5543c53":"code","e0c16e6d":"code","db14002d":"code","38ed5d91":"code","00895b7f":"code","a218060c":"code","f79d169a":"code","5760a244":"code","b8799c99":"code","8c76f0f6":"code","2f2d0f5e":"markdown","16fd8fbb":"markdown","3f94ba61":"markdown","0e5c0461":"markdown","c9bf6fac":"markdown","f7e890e4":"markdown","86a9d8e1":"markdown","30b8669b":"markdown","b7ee79c1":"markdown","776d6912":"markdown","da315f61":"markdown","e46c00ec":"markdown","ac2a8fdd":"markdown","bb1cc0ce":"markdown","d46d43a5":"markdown","501f27fb":"markdown","9dbe4edc":"markdown","74488e57":"markdown","cb0bfa7b":"markdown","da473e63":"markdown","4f2c794b":"markdown","18332e49":"markdown","c9871388":"markdown","eb6f6b1a":"markdown","5785a132":"markdown","43ce05f8":"markdown","c937ffa0":"markdown","a075dc64":"markdown","19c4a0a1":"markdown","f3d592f7":"markdown"},"source":{"020b2d61":"import pandas as pd\nimport numpy as np\nimport os\nprint(os.listdir(\"..\/input\"))","f9f1e57c":"drinks = pd.read_csv('..\/input\/drinks.csv')\n","d6ff525b":"pd.__version__","23bdd487":"pd.show_versions()\n#You can see the versions of Python, pandas, NumPy, matplotlib, and more.","0774bb54":"df = pd.DataFrame({'col one':[100, 200], 'col two':[300, 400]})\ndf","63ee5fb6":"pd.DataFrame(np.random.rand(4, 8))\n#That's pretty good, but if you also want non-numeric column names, you can coerce a string of letters to a list and then pass that list to the columns parameter:","fb63fc0e":"pd.DataFrame(np.random.rand(4, 8), columns=list('abcdefgh'))\n#As you might guess, your string will need to have the same number of characters as there are columns.","fc870820":"df","d581d082":"df = df.rename({'col one':'col_one', 'col two':'col_two'}, axis='columns')\nprint(df)","bba53f44":"df.columns = ['col_one', 'col_two']\n","b3381d50":"df.columns = df.columns.str.replace(' ', '_')","7a87b64f":"df","0bed31a4":"df.add_prefix('X_')","f0fcedcd":"df.add_suffix('_Y')","7042b718":"#Let's take a look at the drinks DataFrame:\ndrinks.head()","2852974e":"drinks.loc[::-1].head()","ba7dfdca":"drinks.loc[::-1].reset_index(drop=True).head()\n","b0f7bfa8":"drinks.loc[:, ::-1].head()","2b23b93d":"#Here are the data types of the drinks DataFrame:\ndrinks.dtypes","ce7cad7e":"drinks.select_dtypes(include='number').head()","c5543c53":"drinks.select_dtypes(include='object').head()","e0c16e6d":"drinks.select_dtypes(include=['number', 'object', 'category', 'datetime']).head()","db14002d":"drinks.select_dtypes(exclude='number').head()","38ed5d91":"df = pd.DataFrame({'col_one':['1.1', '2.2', '3.3'],\n                   'col_two':['4.4', '5.5', '6.6'],\n                   'col_three':['7.7', '8.8', '-']})\ndf","00895b7f":"df.dtypes","a218060c":"df.astype({'col_one':'float', 'col_two':'float'}).dtypes","f79d169a":"pd.to_numeric(df.col_three, errors='coerce')","5760a244":"pd.to_numeric(df.col_three, errors='coerce').fillna(0)","b8799c99":"df = df.apply(pd.to_numeric, errors='coerce').fillna(0)\ndf","8c76f0f6":"df.dtypes","2f2d0f5e":"# Rename columns\n","16fd8fbb":"If you know that the NaN values actually represent zeros, you can fill them with zeros using the fillna() method:","3f94ba61":"Now if the only thing you're doing is replacing spaces with underscores, an even better method is to use the str.replace() method, since you don't have to type out all of the column names:","0e5c0461":"What if you also wanted to reset the index so that it starts at zero?\n\nYou would use the reset_index() method and tell it to drop the old index entirely:","c9bf6fac":"As you can see, the rows are in reverse order but the index has been reset to the default integer index.","f7e890e4":"I prefer to use dot notation to select pandas columns, but that won't work since the column names have spaces. Let's fix this.\n\nThe most flexible method for renaming columns is the rename() method. You pass it a dictionary in which the keys are the old names and the values are the new names, and you also specify the axis:","86a9d8e1":"![](https:\/\/media.tenor.com\/images\/90cd700e5b9451af5a803e4441ae80d8\/tenor.gif)","30b8669b":"# Select columns by data type","b7ee79c1":"These numbers are actually stored as strings, which results in object columns:","776d6912":"All three of these methods have the same result, which is to rename the columns so that they don't have any spaces:","da315f61":"Finally, you can apply this function to the entire DataFrame all at once by using the apply() method:","e46c00ec":"This includes both int and float columns.\n\nYou could also use this method to select just the object columns:","ac2a8fdd":"Let's say you need to select only the numeric columns. You can use the select_dtypes() method:","bb1cc0ce":"You can tell it to include multiple data types by passing a list:","d46d43a5":"# Pandas...............","501f27fb":"Now if you need a much larger DataFrame, the above method will require way too much typing. In that case, you can use NumPy's random.rand() function, tell it the number of rows and columns, and pass that to the DataFrame constructor:","9dbe4edc":"This one line of code accomplishes our goal, because all of the data types have now been converted to float:","74488e57":"# Show installed versions\n\nSometimes you need to know the pandas version you're using, especially when reading the pandas documentation. You can show the pandas version by typing:\n","cb0bfa7b":"# Create an example DataFrame\nLet's say that you want to demonstrate some pandas code. You need an example DataFrame to work with.\nThere are many ways to do this, but my favorite way is to pass a dictionary to the DataFrame constructor, in which the dictionary keys are the column names and the dictionary values are lists of column values:","da473e63":"# Load example datasets","4f2c794b":"#  Reverse column order\n\nSimilar to the previous trick, you can also use loc to reverse the left-to-right order of your columns:","18332e49":"This is a dataset of average alcohol consumption by country. What if you wanted to reverse the order of the rows?\n\nThe most straightforward method is to use the loc accessor and pass it ::-1, which is the same slicing notation used to reverse a Python list:","c9871388":"# Convert strings to numbers\nLet's create another example DataFrame:","eb6f6b1a":"Finally, if you just need to add a prefix or suffix to all of your column names, you can use the add_prefix() method...","5785a132":"The colon before the comma means \"select all rows\", and the ::-1 after the comma means \"reverse the columns\", which is why \"country\" is now on the right side.","43ce05f8":"In order to do mathematical operations on these columns, we need to convert the data types to numeric. You can use the astype() method on the first two columns:","c937ffa0":"# Reverse row order","a075dc64":"However, this would have resulted in an error if you tried to use it on the third column, because that column contains a dash to represent zero and pandas doesn't understand how to handle it.\n\nInstead, you can use the to_numeric() function on the third column and tell it to convert any invalid input into NaN values:","19c4a0a1":"You can also tell it to exclude certain data types:","f3d592f7":"The best thing about this method is that you can use it to rename any number of columns, whether it be just one column or all columns.\nNow if you're going to rename all of the columns at once, a simpler method is just to overwrite the columns attribute of the DataFrame:"}}