{"cell_type":{"e662a066":"code","931a6a68":"code","0019765c":"code","406045e6":"code","2813100a":"code","a014d4e2":"code","34a82b9b":"code","855dfc99":"code","9f976d0d":"code","8dbbcb23":"code","bc8308f6":"code","0115df70":"code","6bb4f637":"code","bee77318":"code","790bbbd8":"code","be0b24f3":"code","140c6e5a":"code","701c97f8":"code","e5ae753d":"code","55a2d908":"code","30fc2d1a":"code","62605b71":"code","2a698f1d":"markdown","fda11b32":"markdown","3ad85e47":"markdown","97faf3fb":"markdown","3db3c0e9":"markdown","cf94b72f":"markdown","34ce08f4":"markdown","0eedea0b":"markdown","8c278400":"markdown","e9853a7f":"markdown"},"source":{"e662a066":"import numpy as np \nimport pandas as pd\nimport matplotlib.pyplot as plt \nimport seaborn as sns \nimport plotly as py\nimport plotly.graph_objs as go\nimport plotly.figure_factory as ff\nimport plotly.graph_objects as go\nimport plotly.express as px\nfrom plotly.subplots import make_subplots\npy.offline.init_notebook_mode(connected=True)\nfrom sklearn.cluster import KMeans\nimport warnings\nimport os\n%matplotlib inline\nwarnings.filterwarnings(\"ignore\")\npy.offline.init_notebook_mode(connected = True)","931a6a68":"df = pd.read_csv('..\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv')\ndf.head()","0019765c":"df.info()","406045e6":"df.describe().T","2813100a":"df.nunique()","a014d4e2":"# Add histogram data\nx1 = df['Age']\nx2 = df['Annual Income (k$)']\nx3 = df['Spending Score (1-100)']\n# Group data together\nhist_data = [x1, x2, x3]\ngroup_labels = ['Age', 'Annual Income (k$)', 'Spending Score (1-100)']\n\nrug_text_one = ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j',\n                'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't',\n                'u', 'v', 'w', 'x', 'y', 'z']\n\nrug_text_two = ['aa', 'bb', 'cc', 'dd', 'ee', 'ff', 'gg', 'hh', 'ii', 'jj',\n                'kk', 'll', 'mm', 'nn', 'oo', 'pp', 'qq', 'rr', 'ss', 'tt',\n                'uu', 'vv', 'ww', 'xx', 'yy', 'zz']\n\nrug_text_three = ['aaa', 'bbb', 'ccc', 'ddd', 'eee', 'fff', 'ggg', 'hhh', 'iii', 'jjj',\n                'kkk', 'lll', 'mmm', 'nnn', 'ooo', 'ppp', 'qqq', 'rrr', 'sss', 'ttt',\n                'uuu', 'vvv', 'www', 'xxx', 'yyy', 'zzz']\n\nrug_text = [rug_text_one, rug_text_two, rug_text_three] # for hover in rug plot\ncolors = ['rgb(0, 0, 100)', 'rgb(0, 200, 200)','rgb(0, 0, 200)']\n\n# Create distplot with custom bin_size\nfig = ff.create_distplot(\n    [x1, x2 ,x3], group_labels, bin_size=3,\n    rug_text=rug_text, colors=colors)\n\nfig.update_layout(title_text='Customized Distplot')\nfig.show()","34a82b9b":"plt.figure(1 , figsize = (15 , 5))\nsns.set(style=\"darkgrid\")\nax = sns.countplot(y=\"Gender\", data=df)","855dfc99":"fig = px.scatter_matrix(df,\n    dimensions=['Age', 'Annual Income (k$)', 'Spending Score (1-100)'],\n    color=\"Gender\")\nfig.show()","9f976d0d":"fig = px.scatter(df, x=\"Age\", y=\"Annual Income (k$)\", color=\"Gender\", size='Age' )\nfig.show()","8dbbcb23":"df[\"e\"] = df[\"Annual Income (k$)\"]\/100\nfig = px.scatter(df, x=\"Annual Income (k$)\", y=\"Spending Score (1-100)\", color=\"Gender\",\n                 error_x=\"e\", error_y=\"e\")\nfig.show()","bc8308f6":"df.drop(['e','CustomerID'], axis=1, inplace=True)\ndf.head()","0115df70":"fig = px.violin(df, y=\"Gender\", x=\"Age\", color=\"Gender\", box=True, points=\"all\",\n          hover_data=df.columns)\nfig.show()","6bb4f637":"fig = px.violin(df, y=\"Gender\", x=\"Annual Income (k$)\", color=\"Gender\", box=True, points=\"all\",\n          hover_data=df.columns)\nfig.show()","bee77318":"fig = px.violin(df, y=\"Gender\", x=\"Spending Score (1-100)\", color=\"Gender\", box=True, points=\"all\",\n          hover_data=df.columns)\nfig.show()","790bbbd8":"X = df.iloc[:,2:4].values","be0b24f3":"from sklearn.cluster import KMeans\n\nSum_of_squared_distances = []\n\n# Use k from 1 to 15\nK = range(1,15)\nfor k in K:\n    km = KMeans(n_clusters=k, init='random', n_init=10, max_iter=500,  tol=1e-04, random_state=0)\n    km = km.fit(X)\n    # Get sum of square distances by applying km.inertia_ \n    Sum_of_squared_distances.append(km.inertia_)\n\n# Plot Results\nplt.plot(K, Sum_of_squared_distances, marker='o')\nplt.xlabel('k')\nplt.ylabel('Sum_of_squared_distances')\nplt.title('Elbow Method For Optimal k')\nplt.show()","140c6e5a":"from sklearn.cluster import KMeans, AgglomerativeClustering, AffinityPropagation, DBSCAN\nfrom sklearn.metrics import silhouette_score\nfrom sklearn import preprocessing\nfrom sklearn import cluster, tree, decomposition\n\nfor n_cluster in range(2, 11):\n    kmeans = KMeans(n_clusters=n_cluster).fit(X)\n    label = kmeans.labels_\n    sil_coeff = silhouette_score(X, label, metric='euclidean')\n    print(\"For n_clusters={}, The Silhouette Coefficient is {}\".format(n_cluster, sil_coeff))","701c97f8":"import scipy.cluster.hierarchy as sch\nfig = ff.create_dendrogram(X,\n                           linkagefun = lambda x: sch.linkage(x, \"ward\"),)\n\n# Ward minimizes the variance of the points inside a cluster.\n\nfig.update_layout(title = 'Hierarchical Clustering', xaxis_title='Customers',\n                   yaxis_title='Euclidean Distance', width=700, height=700)\n\nfig.show()","e5ae753d":"kmeans = KMeans(n_clusters = 5, init=\"k-means++\", max_iter = 500, n_init = 10, random_state = 123)\nidentified_clusters = kmeans.fit_predict(X)\n\n\ndata_with_clusters = df.copy()\ndata_with_clusters['Cluster'] = identified_clusters\nfig = px.scatter_3d(data_with_clusters, x = 'Age', y='Annual Income (k$)', z='Spending Score (1-100)',\n              color='Cluster', opacity = 0.8, size='Age', size_max=30)\nfig.show()","55a2d908":"hc = AgglomerativeClustering(n_clusters = 5, affinity = \"euclidean\", linkage = \"ward\")\nidentified_clusters = hc.fit_predict(X)\n\ndata_with_clusters = df.copy()\ndata_with_clusters['Cluster'] = identified_clusters\n\nfig = px.scatter_3d(data_with_clusters, x = 'Age', y='Annual Income (k$)', z='Spending Score (1-100)',\n              color='Cluster', opacity = 0.8, size='Age', size_max=30)\nfig.show()","30fc2d1a":"ap = AffinityPropagation(random_state = 0)\nidentified_clusters = ap.fit_predict(X)\n\ndata_with_clusters = df.copy()\ndata_with_clusters['Cluster'] = identified_clusters\n\nfig = px.scatter_3d(data_with_clusters, x = 'Age', y='Annual Income (k$)', z='Spending Score (1-100)',\n              color='Cluster', opacity = 0.8, size='Age', size_max=30)\nfig.show()","62605b71":"DBS = DBSCAN(eps = 9, min_samples = 5)\n\nidentified_clusters = DBS.fit_predict(X)\n\ndata_with_clusters =df.copy()\ndata_with_clusters['Cluster'] = identified_clusters\n\nfig = px.scatter_3d(data_with_clusters, x = 'Age', y='Annual Income (k$)', z='Spending Score (1-100)',\n              color='Cluster', opacity = 0.8, size='Age', size_max=30)\nfig.show()","2a698f1d":"Cluster with AffinityPropagation","fda11b32":"Data Visualization","3ad85e47":"Selecting N Clusters With Silhouette Analysis","97faf3fb":"Cluster with AgglomerativeClustering","3db3c0e9":"Cluster with DBSCAN","cf94b72f":"Hierarchical Clustering","34ce08f4":"Importing Libraries.\n","0eedea0b":"Cluster With KMeans","8c278400":"Selecting N Clusters With Elbow Method","e9853a7f":"Data Exploration"}}