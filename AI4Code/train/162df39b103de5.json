{"cell_type":{"89cebe2b":"code","83886503":"code","67682bcc":"code","da30fd0f":"code","a46990d2":"code","979bb883":"code","5c5c9e6d":"code","3bd63e87":"code","61cd3051":"code","0c0870ec":"code","079b0525":"code","e2285abd":"code","2c815f58":"code","95b75c04":"code","ccaeb827":"code","4b1aa1f0":"code","5e19508c":"code","e2d16fc2":"code","124ebf31":"code","be9f7752":"code","e66dcd18":"markdown","bdd36386":"markdown","9e5f09d5":"markdown","dcd27166":"markdown","c1b7915a":"markdown","da454593":"markdown","708e9741":"markdown","34d0b75f":"markdown","62a030c9":"markdown","405c8d05":"markdown","dd4d4398":"markdown","fec02e94":"markdown","9617e6aa":"markdown","c84ab9e8":"markdown"},"source":{"89cebe2b":"#Importando as bibliotecas \nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt # Cria\u00e7\u00e3o de gr\u00e1ficos. \nimport seaborn as sns # Desing de gr\u00e1ficos mais atraentes.\n\nfrom scipy.stats import norm\nfrom scipy import stats\n\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.model_selection import train_test_split\nfrom sklearn import metrics\n\n","83886503":"%matplotlib inline","67682bcc":"#Criando o DataFrame atrav\u00e9s do arquivo Concret_Data_Yeh\ndf = pd.read_csv('..\/input\/Concrete_Data_Yeh.csv')\n\n# Vamos Renomear as colunas com a tradu\u00e7\u00e3o das nomenclaturas para o portugu\u00eas.\n# Todas as colunas de materiais est\u00e3o na unidade de Kg\/m\u00b3.\n# A idade do concreto est\u00e1 em Dias.\n# J\u00e1 o Fck est\u00e1 em Mpa.\ndf.columns = ['Cimento','Esc\u00f3ria de Alto Forno', 'Esc\u00f3ria', '\u00c1gua', 'Superplastificante', 'Agregado Graudo', 'Agregado Fino', 'Idade do Concreto', 'Fck']\ndf.head(10)","da30fd0f":"# Vamos Arredondar o valor do Fck\ndf.round({'Fck': 0})","a46990d2":"# Vamos agora obter uma descri\u00e7\u00e3o dos dados provenientes do DataFrame.\ndf.describe()","979bb883":"# Vamos avaliar a tipologia dos nossos dados;\ndf.dtypes","5c5c9e6d":"# Vamos plotar um gr\u00e1fico de barras para determinar quantas unidade de corpor de prova temos \n# para cada idade do concreto;\ndf['Idade do Concreto'].value_counts().plot.bar()\n\nplt.xlabel('Idade do Concreto')\nplt.ylabel('Quantidade de ocorr\u00eancias')","3bd63e87":"# Vamos criar um novo DataFrame apenas com os corpos de prova que tiveram sua resist\u00eancia medida \n# com 28 dias\n\ndf28 = df[df['Idade do Concreto'] == 28]\n\ndf28.head()","61cd3051":"# Agora vamos avaliar quantas entradas temos no nosso novo DataFrame\ndf28.info()","0c0870ec":"# Precisamos verificar a nova m\u00e9dia do Fck para esse novo DataFrame\n# uma vez que ela apresenta um valor de par\u00e2metro de avalia\u00e7\u00e3o.\ndf28.describe()","079b0525":"# Vamos utilizar o PairPlot para tentar visualizar como \u00e9 a distribui\u00e7\u00e3o do nossos dados.\nsns.pairplot(df28)","e2285abd":"sns.heatmap(df28.corr())","2c815f58":"# Vamos Verificar se a vari\u00e1vel de Target segue uma tendencia de distribui\u00e7\u00e3o normal.\nsns.distplot(df28['Fck'], fit=norm);\nfig = plt.figure()\nres = stats.probplot(df28['Fck'], plot=plt)","95b75c04":"# Vamos come\u00e7ar dividindo os nossos dados em atributos e r\u00f3tulos\n\n#Conjunto de todas as colunas do DataFrame,menos as colunas 'Fck' e 'Idade do Concreto'\nX = df28.drop(['Fck', 'Idade do Concreto'], axis=1) \n\n#Conjunto apenas com a coluna 'Fck', vari\u00e1vel que queremos prever\ny = df28['Fck'] ","ccaeb827":"# Agora vamos dividir os nossos dados em conjuntos de treinamento e teste.\n# Para esse exemplo vamos utilizar o m\u00e9todo 'train_test_split', que far\u00e1 a divis\u00e3o autom\u00e1tica dos dados.\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3)","4b1aa1f0":"# Primeiramente vamos instanciar a classe 'DecisionForestRegressor' e chamar o m\u00e9todo 'fit'\nrf = RandomForestRegressor (n_estimators=1000, random_state=42)\n\nrf.fit(X_train, y_train)","5e19508c":"# Para fazer previs\u00f5es no conjunto de teste vamos utilizar o m\u00e9todo 'predict'\ny_pred = rf.predict(X_test)","e2d16fc2":"# Agora vamos comparar alguns dos nossos valores previstos com os valores reais e ver o qu\u00e3o preciso \u00e9 o nosso modelo.\ndf_new = pd.DataFrame({'Valor_Real':y_test, 'Valor_Previsto':y_pred})\ndf_new","124ebf31":"# Avaliando o modelo atrav\u00e9s do pacote 'metrics'.\nprint ('Erro M\u00e9dio Absoluto:', metrics.mean_absolute_error(y_test, y_pred))\nprint ('Erro Quadr\u00e1tico M\u00e9dio:', metrics.mean_squared_error(y_test, y_pred))\nprint ('Raiz do Erro Quadr\u00e1tico M\u00e9dio:', np.sqrt(metrics.mean_squared_error(y_test, y_pred)))","be9f7752":"# Calculando o erro m\u00e9dio absoluto por outro meio\nerrors = abs(y_pred - y_test)\n\n# Aqui calculamos o percentual do erro m\u00e9dio absoluto (MAPE)\nmape =100 * (errors \/ y_test)\naccuracy = 100 - np.mean(mape)\nprint (\"Acur\u00e1cia:\", round(accuracy, 2), \"%.\")\n","e66dcd18":"A idade do concreto \u00e9 outro importante fator para essa an\u00e1lise, pois quando precisamos encontrar um modelo preditivo para a resist\u00eancia do concreto a compress\u00e3o precisamos garantir que as amostras tinham idade suficiente para atingir a resist\u00eancia progamada. \nEm geral a resist\u00eancia do concreto n\u00e3o sofre grandes varia\u00e7\u00f5es ap\u00f3s os 28 dias de idade. Sendo esta uma boa idade para considerarmos nessa an\u00e1lise. ","bdd36386":"Outra importante avalia\u00e7\u00e3o \u00e9 verificar se a nossa v\u00e1ri\u00e1vel escolhida como target, segue uma tend\u00eancia normal, afim de facilitar a nossa predi\u00e7\u00e3o.","9e5f09d5":"Alguns valores chegaram bem proximo dos valores reiais, por\u00e9m outros valores ficaram com um erro muito alto para o que \u00e9 esperado.\nIsso era esperado uma vez que o 'train_test_split', d\u00edvide os dados aleatoriamente.\n\nPara avaliar o desempenho do algoritmo de regress\u00e3o, as m\u00e9tricas comumente utilizadas s\u00e3o do **'erro m\u00e9dio absoluto'** , **'erro quadr\u00e1tico m\u00e9dio'** , e **'raiz do erro quadr\u00e1tico m\u00e9dio'** . \nA biblioteca **Scikit-Learn** cont\u00e9m fun\u00e7\u00f5es que podem ajudar a calcular esses valores para n\u00f3s. Para fazer isso, use este c\u00f3digo do **'metrics'** pacote:","dcd27166":"A fun\u00e7\u00e3o **\"heatmap\"**, apresenta a cria\u00e7\u00e3o de uma mapa de calor dos nossos dados. A documenta\u00e7\u00e3o apresenta sua fun\u00e7\u00e3o como:\n> Um mapa de calor (ou mapa de calor ) \u00e9 uma representa\u00e7\u00e3o gr\u00e1fica de dados em que os valores individuais contidos em uma matriz s\u00e3o representados como cores.","c1b7915a":"Como o nosso objetivo \u00e9 estimar o valor do **Fck**, devemos achar um modelo que consiga prever o valor deste par\u00e2metro. \n\nPode-se observar atrav\u00e9s da ultima linha de gr\u00e1ficos que o valor do **Fck**, apresenta uma leve tend\u00eancia para uma regress\u00e3o linear apenas quando comparado a quantidade de cimento presente no concreto. Oque faz sentido uma vez que o **cimento** \u00e9 o maior respons\u00e1vel pelo ganho de resist\u00eancia. Por\u00e9m essa padr\u00e3o n\u00e3o \u00e9 observado quando comparado as outras colunas.\n","da454593":"<a name=\"DATAAVAL\"><\/a>\n<a href='#TOPO'>Voltar ao \u00edndice<\/a>\n<h1>Avalia\u00e7\u00e3o do Modelo (Data Evaluation)<\/h1>","708e9741":"<a name='TOPO'><\/a>\n<h1>\u00cdndice<\/h1>\n<ol>\n<li><a href='#DATACLEANING'>Limpeza de Dados (Data Cleaning)<\/a><\/li>\n<li><a href='#DATAANALYSIS'>An\u00e1lise dos Dados (Data Analysis)<\/a><\/li>\n<li><a href='#DATATRAIN'>Separa\u00e7\u00e3o dos Dados (Data Train)<\/a><\/li>\n<li><a href='#DATAMODEL'>Modelo de Previs\u00e3o (Data Model)<\/li>\n<li><a href='#DATAAVAL'>Avalia\u00e7\u00e3o do Modelo (Data Evaluation)<\/li>\n<li><a href='#CONCLUSAO'>Conclus\u00e3o<\/li>\n<\/ol>","34d0b75f":"<a name='DATACLEANING'><\/a>\n<h1>Limpeza de Dados (Data Cleaning)<\/h1>","62a030c9":"<a name='CONCLUSAO'><\/a>\n<a href='#TOPO'>Voltar ao \u00edndice<\/a>\n<h1>Conclus\u00e3o<\/h1>\n\nEm breve postarei um nova tentativa em diminuir esse erro.\n\nCaso tenha interesse, voc\u00ea pode me seguir nas redes sociais e enviar cr\u00edticas e sugest\u00f5es. \n\n<img src = \"https:\/\/cdn-images-1.medium.com\/max\/1125\/1*dDNpLKu_oTLzStsDTnkJ-g.png\" width=75 align=left><a href='https:\/\/github.com\/13yurimiguel'>13yurimiguel<\/a><p>\n\n<img src = \"https:\/\/upload.wikimedia.org\/wikipedia\/commons\/7\/7c\/Kaggle_logo.png\" width=70 align=left><a href='https:\/\/www.kaggle.com\/yurimiguel'>yurimiguel<\/a><p>\n    \n<img src = \"http:\/\/s.glbimg.com\/po\/tt\/f\/original\/2011\/05\/18\/linkedin_logo_1.jpg\" width=70 align=left><a href='https:\/\/www.linkedin.com\/in\/yuri-miguel-23295b87\/'>Yuri Miguel<\/a><p>\n    \n<img src = \"https:\/\/upload.wikimedia.org\/wikipedia\/commons\/thumb\/2\/2a\/Instagram_logo.svg\/1200px-Instagram_logo.svg.png\" width=75 align=left><a href='https:\/\/www.instagram.com\/y.m.eng\/'>@y.m.eng<\/a><p>\n","405c8d05":"<a name=\"DATAMODEL\"><\/a>\n<a href='#TOPO'>Voltar ao \u00edndice<\/a>\n<h1>Modelo de Previs\u00e3o (Data Model)<\/h1>\n\nVamos tentar inicialmente usar um modelo de \u00e1rvore de regress\u00e3o para prever o valor do fck:\n\nPara isso vamos utilizar uma classe do **'sklearn'** chamada **'RandomForestRegressor'**","dd4d4398":"<a name=\"DATATRAIN\"><\/a>\n<a href='#TOPO'>Voltar ao \u00edndice<\/a>\n<h1>Separa\u00e7\u00e3o dos Dados (Data Train)<\/h1>","fec02e94":"<a name=\"DATAANALYSIS\"><\/a>\n<a href='#TOPO'>Voltar ao \u00edndice<\/a>\n<h1>An\u00e1lise dos Dados (Data Analysis)<\/h1>","9617e6aa":"**Modelo de Aprendizado para Previs\u00e3o da Resist\u00eancia do Concreto - por Yuri Miguel - Engenheiro Civil**\n![Concrete Civil Engineering](http:\/\/upload.wikimedia.org\/wikipedia\/commons\/thumb\/5\/5b\/US_Navy_090724-N-1831G-002_An_Indonesian_Navy_engineer_and_a_U.S._Navy_Seabee_pour_concrete_for_an_engineering_civic_action_program_at_Pusaka_Rakyat_Primary_School.jpg\/800px-thumbnail.jpg)\n\nEste trabalho busca apresentar de forma simples e direta um modelo para previs\u00e3o do **\"Fck\"** ( Valor de Resist\u00eancia do Concreto a Compress\u00e3o), atrav\u00e9s da quantidade de material usado para sua forma\u00e7\u00e3o, comumente conhecido com Tra\u00e7o do concreto. \nO Dataset utilizado \u00e9 proveniente da plataforma **Kaggle**, \u00e9 foi disponibilizado atrav\u00e9s do **'Machine Learning Reporitory'**:\n    \n> *Abstract: Concrete is the most important material in civil engineering. The concrete compressive strength is a highly nonlinear function of age and ingredients.\nOriginal Owner and Donor \nProf. I-Cheng Yeh \n**Department of Information Management \nChung-Hua University, \nHsin Chu, Taiwan 30067, R.O.C.**\ne-mail:icyeh '@' chu.edu.tw \nTEL:886-3-5186511 *\n\nDate Donated: August 3, 2007     \n\n[Link de Acesso Kaggle](http:\/\/www.kaggle.com\/maajdl\/yeh-concret-data)\n[Link de Acesso MLR](http:\/\/archive.ics.uci.edu\/ml\/datasets\/Concrete+Compressive+Strength)\n\n**OBS: \u00c9 importante salientar que o modelo apresentado tem como objetivo apenas o estudo e a divulga\u00e7\u00e3o da utiliza\u00e7\u00e3o de machine learning dentro da engenharia civil, n\u00e3o podendo ser levado em considera\u00e7\u00e3o para defini\u00e7\u00f5es t\u00e9cnicas ou para dimensionamento de estruturas. **","c84ab9e8":"A fun\u00e7\u00e3o **\"pairplot\"** \u00e9 definida por sua documenta\u00e7\u00e3o como:\n\n> Por padr\u00e3o, essa fun\u00e7\u00e3o criar\u00e1 uma grade de Eixos de forma que cada vari\u00e1vel na datavontade seja compartilhada no eixo y em uma \u00fanica linha e no eixo x em uma \u00fanica coluna. Os Eixos diagonais s\u00e3o tratados de maneira diferente, desenhando um gr\u00e1fico para mostrar a distribui\u00e7\u00e3o univariada dos dados para a vari\u00e1vel nessa coluna."}}