{"cell_type":{"f76646be":"code","a27406fd":"code","fe11e6e0":"code","63569491":"code","b7fa0f68":"code","45ad9d4e":"code","e8398e85":"code","81b08f18":"code","9cd39fe2":"code","ac283687":"code","d654e5a6":"code","7b932cf3":"markdown","8bf51409":"markdown","7457214a":"markdown","551c0518":"markdown","d5a67cbc":"markdown","25c1ab07":"markdown","937d6d4c":"markdown","c6597c33":"markdown","9f4e370a":"markdown","0aa0c201":"markdown"},"source":{"f76646be":"pip install pyspark\nfrom pyspark.sql import SparkSession # required to created a dataframe\nspark=SparkSession.builder.appName(\"Basics\").getOrCreate() \n\nimport pandas as pd\nimport numpy as np\nimport time\nimport pyspark.sql.functions\nimport pyspark.sql.types\nfrom pyspark.sql import SparkSession\nfrom pyspark.context import SparkContext\nfrom pyspark.sql.functions import round\nfrom pyspark.sql.types import DoubleType\nfrom pyspark.sql.functions import udf","a27406fd":"df = spark.read.csv(\"\/kaggle\/input\/netflix-original-films-imdb-scores\/NetflixOriginals.csv\",\n                   header = True)\ndf.show(10)","fe11e6e0":"df.select(\"Title\", \"Genre\").show(5)","63569491":"df = df.withColumn('Movie_Hour', \n                   round(df.Runtime\/60, 2))\ndf.show(5)","b7fa0f68":"df_mystery = df.filter(df.Genre == \"Mystery\")\ndf_mystery.show(10)","45ad9d4e":"df_language_genre = df.filter( (df.Genre == \"Horror thriller\") & (df.Language == \"English\") )\ndf_language_genre.show(10)","e8398e85":"drop_df = df.drop(df.Runtime)\ndrop_df.show(10)","81b08f18":"drop_df_2 = df.drop(\"Runtime\", \"IMDB Score\")\ndrop_df_2.show(10)","9cd39fe2":"df_mean_moviehour_genre = df.groupby([\"Genre\"]).mean(\"Movie_Hour\")\ndf_mean_moviehour_genre.show()","ac283687":"df_mean_moviehour_genre_lang = df.groupby([\"Genre\", \"Language\"]).mean(\"Movie_Hour\")\ndf_mean_moviehour_genre_lang.show()","d654e5a6":"df_max_time_movie = df.groupby(\"Title\").max(\"Movie_Hour\")\ndf_max_time_movie.show()","7b932cf3":"#  **Import Libraries and Load the Data**","8bf51409":"![pyspark](https:\/\/cdn.analyticsvidhya.com\/wp-content\/uploads\/2020\/02\/spark-sql.jpg)","7457214a":"# **Netflix Movie Analysis With PySpark**","551c0518":"# **Operations on PySpark SQL DataFrames**","d5a67cbc":"# **Data Merging and Data Agg. Using PySpark SQL**\n\n* mean( )\n* count( )\n* sum( )\n* min( )\n* max( )","25c1ab07":"****","937d6d4c":"## **Calculating a New Column**","c6597c33":"## **Filter Rows from a DataFrame**","9f4e370a":"## **Select Columns from a DataFrame**","0aa0c201":"## **Dropping Columns from a DataFrame**"}}