{"cell_type":{"7a36dde4":"code","de6d4b3d":"code","74354e78":"code","3a21afb3":"code","3d23e0b0":"code","ed44c889":"code","8bd23b1e":"code","5ac89dc7":"code","9f3fd0b7":"code","c9740fe9":"code","ccf2e8b7":"code","4335af0c":"code","b138da4d":"code","b04c69fc":"code","3918d98e":"code","9ee48d2f":"code","5bc88e14":"code","bf4f1391":"code","ff0587d9":"code","3c2ac541":"code","8eae9f8d":"code","05aa971a":"code","ce4715f8":"code","b669446a":"code","3b558250":"markdown","2ad7971a":"markdown","457b6cc5":"markdown","5d11f48b":"markdown","eeba730e":"markdown","92f14e04":"markdown","6fe741ee":"markdown","ad1af8ba":"markdown","eafc4791":"markdown","9b957664":"markdown","1b116245":"markdown","f6d593fe":"markdown","0c73a08e":"markdown","20535427":"markdown","df0c5bc5":"markdown"},"source":{"7a36dde4":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns","de6d4b3d":"df_fire= pd.read_csv('..\/input\/fires-from-space-australia-and-new-zeland\/fire_archive_M6_96619.csv')\ndf_fire","74354e78":"df_fire.info()","3a21afb3":"df_fire=df_fire.drop(['acq_date','acq_time','satellite','instrument','version','type'],axis=1)","3d23e0b0":"daynight = pd.get_dummies(df_fire['daynight'],drop_first=True)\ndf_fire.drop(['daynight'],axis=1,inplace=True)\ndf_fire = pd.concat([df_fire,daynight],axis=1)\n","ed44c889":"plt.figure(figsize=(20,10))\nsns.heatmap( df_fire.isnull() , yticklabels=False ,cbar=False )","8bd23b1e":"figure= plt.figure(figsize=(10,10))\nsns.heatmap(df_fire.corr(), annot=True)\n","5ac89dc7":"sns.pairplot(df_fire)","9f3fd0b7":"X= df_fire.drop('frp',axis=1)\ny=df_fire['frp']","c9740fe9":"from sklearn.model_selection import train_test_split \nX_train, X_test, y_train, y_test = train_test_split(X ,y , test_size=0.4, random_state=108)","ccf2e8b7":"from sklearn import metrics\nfrom sklearn.model_selection import cross_val_score\n\nresults_df = pd.DataFrame()\ncolumns = [\"Model\", \"Cross Val Score\", \"MAE\", \"MSE\", \"RMSE\", \"R2\"]\n\ndef evaluate(true, predicted):\n    mae = metrics.mean_absolute_error(true, predicted)\n    mse = metrics.mean_squared_error(true, predicted)\n    rmse = np.sqrt(metrics.mean_squared_error(true, predicted))\n    r2_square = metrics.r2_score(true, predicted)\n    return mae, mse, rmse, r2_square\n\ndef append_results(model_name, model, results_df, y_test, pred):\n    results_append_df = pd.DataFrame(data=[[model_name, *evaluate(y_test, pred) , cross_val_score(model, X, y, cv=10).mean()]], columns=columns)\n    results_df = results_df.append(results_append_df, ignore_index = True)\n    return results_df","4335af0c":"from sklearn.linear_model import RANSACRegressor\nransacReg= RANSACRegressor()\nransacReg.fit(X_train,y_train)\npred= ransacReg.predict(X_test)\n","b138da4d":"results_df= append_results(\"Robust Regression\",RANSACRegressor(),results_df,y_test,pred)\nresults_df","b04c69fc":"figure= plt.figure(figsize=(10,10))\nsns.distplot((y_test,pred))\n#To see the distribution between predection and acual value, if it normally distributed it means that model is correct","3918d98e":"from sklearn.linear_model import Ridge\nRidgeReg= Ridge()\nRidgeReg.fit(X_train,y_train)\npred= RidgeReg.predict(X_test)\n","9ee48d2f":"results_df= append_results(\"Ridge Regression\",Ridge(),results_df,y_test,pred)\nresults_df","5bc88e14":"figure= plt.figure(figsize=(10,10))\nsns.distplot((y_test,pred))","bf4f1391":"from sklearn.linear_model import Lasso\nLassoReg= Lasso()\nLassoReg.fit(X_train,y_train)\npred= LassoReg.predict(X_test)\n","ff0587d9":"results_df= append_results(\"Lasso Regression\",Lasso(),results_df,y_test,pred)\nresults_df","3c2ac541":"figure= plt.figure(figsize=(10,10))\nsns.distplot((y_test,pred))","8eae9f8d":"from sklearn.linear_model import ElasticNet\nElasticNetReg= ElasticNet()\nElasticNetReg.fit(X_train,y_train)\npred= ElasticNetReg.predict(X_test)\n","05aa971a":"results_df= append_results(\"ElasticNet Regression\",ElasticNet(),results_df,y_test,pred)\nresults_df","ce4715f8":"figure= plt.figure(figsize=(10,10))\nsns.distplot((y_test,pred))","b669446a":"results_df.to_csv('resultsEval.csv')","3b558250":"## 2- Ridge Regression:\n#### The ridge coefficients minimize apenalized residue of sum of squares (For multi functions data)","2ad7971a":"# In this notebook this points will be covered:\n\n#### - Quick Visualization\n#### - Robust Regression\n#### - Ridge Regression\n#### - Lasso Regression\n#### - ElasticNet regression","457b6cc5":"#### To show the correlation between variables","5d11f48b":"## - Importing Libraries and Data:","eeba730e":"### Source : https:\/\/www.kaggle.com\/aadhavvignesh\/regression-with-scikit-learn-practical-ml-1\n","92f14e04":"# We see that Robust Regression has the best evaluation cause it deals with the outliers in the dataset.","6fe741ee":"## 4- ElasticNet regression\n#### It's simply compine between Laso and Ridge regression","ad1af8ba":"## 1- Robust Regression :\n#### It's interactive method for an observed data that has outliers _outliers influance the values of estimates_","eafc4791":"## - Data preprations :","9b957664":"#### Qiuck visualization on whole dataset","1b116245":"#### View null values in the heatmab bellow:","f6d593fe":"## 3- Lasso Regression:\n#### It use shrinkage \"like mean\", it's perfect for models that have high level of multicollinearity","0c73a08e":"# - Regression model Techniques:","20535427":"## - Create Data Frame to cotain regression Evaluation:","df0c5bc5":"## - Train Test Split"}}