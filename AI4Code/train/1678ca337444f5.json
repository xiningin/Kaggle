{"cell_type":{"4681ee95":"code","d744adc4":"code","4193e5d8":"code","a2a3f565":"code","71b56626":"code","5299558a":"code","e71b5662":"code","4a7795ad":"code","e21dbd35":"code","e609081f":"code","7f7043e0":"code","03aab6ca":"code","4fd041f4":"code","ef1cc01e":"code","f3e655e7":"code","65e2b5d3":"code","086c6d24":"code","9633a85c":"code","dc0eb618":"code","360b4dfd":"code","de33e662":"code","fa2511c5":"code","8aea3768":"code","612971a3":"code","6c8ed4b3":"code","3a255308":"code","fc2c9e37":"code","12cb5470":"code","494b1298":"markdown","58936618":"markdown","0fa59533":"markdown","a254161b":"markdown","00c5bde3":"markdown","aabcef1e":"markdown","312c683a":"markdown","22f45b0b":"markdown"},"source":{"4681ee95":"import numpy as np\nimport pandas as pd\nfrom wordcloud import WordCloud,STOPWORDS\nimport matplotlib.pyplot as plt\nfrom PIL import Image\nimport plotly.plotly as py\nfrom plotly.offline import init_notebook_mode,iplot\ninit_notebook_mode(connected=True)\nimport plotly.graph_objs as go\nfrom plotly import tools\nimport re\nimport nltk\nfrom nltk.corpus import stopwords\nimport nltk as nlp","d744adc4":"episodeIV = pd.read_csv('..\/input\/star-wars-movie-scripts\/SW_EpisodeIV.txt', delim_whitespace=True, names=[\"index\",\"character\",\"dialogue\"] ,header = None)\nepisodeV = pd.read_csv('..\/input\/star-wars-movie-scripts\/SW_EpisodeV.txt', delim_whitespace=True, names=[\"index\",\"character\",\"dialogue\"] ,header = None)\nepisodeVI = pd.read_csv('..\/input\/star-wars-movie-scripts\/SW_EpisodeVI.txt', delim_whitespace=True, names=[\"index\",\"character\",\"dialogue\"] ,header = None)","4193e5d8":"episodeIV.drop(0,inplace=True)\nepisodeV.drop(0,inplace=True)\nepisodeVI.drop(0,inplace=True)\nepisodeIV.drop([\"index\"],axis=1,inplace=True)\nepisodeV.drop([\"index\"],axis=1,inplace=True)\nepisodeVI.drop([\"index\"],axis=1,inplace=True)","a2a3f565":"script_numIV=pd.DataFrame(episodeIV.character.value_counts()).iloc[:20]\nscript_numV=pd.DataFrame(episodeV.character.value_counts()).iloc[:20]\nscript_numVI=pd.DataFrame(episodeVI.character.value_counts()).iloc[:20]\n","71b56626":"greedo = episodeIV.loc[episodeIV['character']=='GREEDO']\ngreedo","5299558a":"trace = go.Bar(y=script_numIV.character, x=script_numIV.index,  marker=dict(color=\"crimson\",line=dict(color='black', width=2)),opacity=0.75)\ntrace1 = go.Bar(y=script_numV.character,x=script_numV.index,marker=dict(color=\"blue\",line=dict(color='black', width=2)),opacity=0.75)\ntrace2 = go.Bar(y=script_numVI.character, x=script_numV.index,marker=dict(color=\"green\",line=dict(color='black', width=2)),opacity=0.75)\n\n\nfig = tools.make_subplots(rows=3, cols=1,horizontal_spacing=1, subplot_titles=(\"A New Hope\",\"The Empire Strikes Back\",\"Return of The Jedi\"))\n \nfig.append_trace(trace, 1, 1)\nfig.append_trace(trace1, 2, 1)\nfig.append_trace(trace2, 3, 1)\n\nfig['layout'].update(showlegend=False ,height=800,title=\"Number of Dialogues According to Character\",paper_bgcolor='rgb(248, 248, 255)',\n    plot_bgcolor='rgb(248, 248, 255)')\n\n\niplot(fig)","e71b5662":"episodeIV[\"episode\"]=\"A New Hope\"\nepisodeV[\"episode\"]=\"The Empire Strikes Back\"\nepisodeVI[\"episode\"]=\"Return of The Jedi\"\ndata=pd.concat([episodeIV,episodeV,episodeVI],axis=0,ignore_index=True)","4a7795ad":"description_list=[]\nfor description in data.dialogue:\n    description=re.sub(\"[^a-zA-Z]\", \" \", description)\n    description=description.lower()\n    description=nltk.word_tokenize(description)\n    description=[word for word in description if not word in set(stopwords.words(\"english\"))]\n    lemma=nlp.WordNetLemmatizer()\n    description=[lemma.lemmatize(word) for word in description]\n    description=\" \".join(description)\n    description_list.append(description)\n","e21dbd35":"data[\"new_script\"]=description_list\ndata","e609081f":"luke=data[data.character==\"LUKE\"]\nyoda=data[data.character==\"YODA\"]\nhan=data[data.character==\"HAN\"]\nvader=data[data.character==\"VADER\"]","7f7043e0":"wave_mask_yoda = np.array(Image.open(\"..\/input\/star-wars-movie-scripts\/wordcloud_masks\/yoda.png\"))\nwave_mask_vader= np.array(Image.open(\"..\/input\/star-wars-movie-scripts\/wordcloud_masks\/yoda.png\"))\nwave_mask_rebel= np.array(Image.open(\"..\/input\/star-wars-movie-scripts\/wordcloud_masks\/yoda.png\"))","03aab6ca":"plt.subplots(figsize=(15,15))\nstopwords= set(STOPWORDS)\nwordcloud = WordCloud(mask=wave_mask_vader,background_color=\"black\",colormap=\"Reds\" ,contour_width=2, contour_color=\"gray\",\n                      width=950,\n                          height=950\n                         ).generate(\" \".join(vader.new_script))\n\nplt.imshow(wordcloud ,interpolation='bilinear')\nplt.axis('off')\nplt.savefig('graph.png')\n\nplt.show()","4fd041f4":"plt.subplots(figsize=(15,15))\nstopwords= set(STOPWORDS)\nwordcloud = WordCloud(mask=wave_mask_yoda,background_color=\"black\",contour_width=3, contour_color=\"olivedrab\",colormap=\"Greens\",\n                      stopwords=stopwords,   \n                      width=950,\n                          height=950\n                         ).generate(\" \".join(yoda.new_script))\n\nplt.imshow(wordcloud)\nplt.axis('off')\nplt.savefig('graph.png')\n\nplt.show()","ef1cc01e":"from sklearn.feature_extraction.text import CountVectorizer\nmax_features = 400\n\ncount_vectorizer = CountVectorizer(max_features=max_features,stop_words = \"english\")\n\nsparce_matrix = count_vectorizer.fit_transform(description_list).toarray()  # x\n\nprint(\"mosltly used {} words: {}\".format(max_features,count_vectorizer.get_feature_names()))\n","f3e655e7":"plt.subplots(figsize=(15,15))\nwordcloud = WordCloud(mask=wave_mask_rebel,background_color=\"black\",contour_width=3, contour_color=\"tan\",colormap=\"rainbow\",  \n                      width=950,\n                          height=950\n                         ).generate(\" \".join(count_vectorizer.get_feature_names()))\n\nplt.imshow(wordcloud)\nplt.axis('off')\nplt.savefig('graph.png')\n\nplt.show()","65e2b5d3":"all_episodes = episodeIV.append(episodeV).append(episodeVI)\nall_episodes.tail(15)","086c6d24":"dialogue_all_episodes = pd.DataFrame(all_episodes['dialogue'])\ndialogue_all_episodes.head()","9633a85c":"base = [row.split(',') for row in dialogue_all_episodes['dialogue']]\nbase_word = [row.split(' ') for row in dialogue_all_episodes['dialogue']]","dc0eb618":"base","360b4dfd":"from gensim.models import Word2Vec\nmodel = Word2Vec(base, min_count=1, size=50, sg=1) \n\n## sg: The training algorithm, either CBOW(0) or skip gram(1). The default training algorithm is CBOW.","de33e662":"model.similarity('Lord Vader', 'Hey')","fa2511c5":"model.most_similar('Lord Vader')[:7]","8aea3768":"char_dialogue_all_episodes = pd.DataFrame(all_episodes[['character','dialogue']])\nchar_dialogue_all_episodes.head()","612971a3":"char_dial_join = char_dialogue_all_episodes.apply(lambda x: ','.join(x.astype(str)), axis=1)\nchar_dial_join","6c8ed4b3":"char_base = [row.split(',') for row in char_dial_join]\nchar_base","3a255308":"model2 = Word2Vec(char_base, min_count=1,size= 50, window=3, sg = 1)","fc2c9e37":"model2.similarity(\"YODA\", \"THREEPIO\")","12cb5470":"model2.most_similar('Artoo')[:10]","494b1298":"![](https:\/\/media3.giphy.com\/media\/3ohuAxV0DfcLTxVh6w\/giphy.gif)","58936618":"## Embeddings?! ","0fa59533":"![](https:\/\/i.ibb.co\/rvK9q0D\/Darth-Revan.jpg)","a254161b":"## Embeddings with additional tuning","00c5bde3":"### Imports","aabcef1e":"## STAR WARS - scripts analysis:\n\n#First part is realised based on: https:\/\/www.kaggle.com\/gulsahdemiryurek\/star-wars-script-analysis \n#Great notebook!","312c683a":"# Darth Revan","22f45b0b":"![](https:\/\/cnet2.cbsistatic.com\/img\/3XDggbjQBCMg5Cvc-j5f7HxFsJ0=\/1200x675\/2019\/11\/12\/d8253cd2-87f8-414e-81b7-a174196c040a\/greedo-1.jpg)"}}