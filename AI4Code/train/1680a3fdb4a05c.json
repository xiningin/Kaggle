{"cell_type":{"10aa4c6c":"code","dcb7cb13":"code","a0528c0f":"code","2ad2d554":"code","97341e58":"code","a6b20ce5":"code","0aba5996":"code","c6c18409":"code","00b42c00":"code","34fcf684":"code","bb3f538a":"code","7237bca2":"code","6e7a55dc":"code","2f1f8f45":"code","0080dd57":"code","4a601374":"code","02b3d80a":"code","9cdbdaa2":"code","4543710c":"code","935e1966":"code","46276a10":"code","9415d06c":"code","bf4b7eff":"code","2f823d76":"code","40cdb476":"code","4e44390b":"code","1855e0ea":"code","d6983ed7":"code","a4807596":"code","1fd8d796":"code","038f3e44":"code","3843c427":"code","30d376ee":"code","7aef403f":"code","6b9b2db5":"code","2363e799":"code","6e40b54e":"code","c512bb0b":"code","7ff88f47":"code","7b7ef7c1":"code","b12516df":"code","30fac31c":"code","64c2981e":"code","fa83fc3c":"code","fc5978c3":"code","b5852a53":"code","10ea024f":"code","4eb85308":"code","0894540d":"code","57da94c9":"code","9c896e15":"markdown","a4ef8653":"markdown","a536605e":"markdown","971fe420":"markdown","b36ae462":"markdown","02d70310":"markdown","e68271f7":"markdown","25e39af0":"markdown","2dc226d7":"markdown","0ce3399f":"markdown","cd44e9b6":"markdown","04858f2d":"markdown","75c7229b":"markdown","86d4a541":"markdown","d1b47024":"markdown","be9fabf7":"markdown","f1392ed6":"markdown","e48f0562":"markdown","707cb05e":"markdown","441efa9f":"markdown","29a7b5a1":"markdown","81197d5f":"markdown","3e4b5144":"markdown","4c0b2bc9":"markdown","6df4f0ef":"markdown"},"source":{"10aa4c6c":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom scipy import stats\nimport seaborn as snb\nfrom sklearn.cluster import KMeans\nfrom sklearn.model_selection import train_test_split\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","dcb7cb13":"snb.set(style=\"darkgrid\")","a0528c0f":"data = pd.read_csv(r\"..\/input\/Mall_Customers.csv\")","2ad2d554":"data.head()","97341e58":"data.describe()","a6b20ce5":"data.groupby('Gender')['CustomerID'].nunique().plot(kind='barh')","0aba5996":"data.groupby('Gender')['Annual Income (k$)'].mean().plot(kind='barh')","c6c18409":"data.loc[data['Gender']=='Female']['Annual Income (k$)'].hist(bins=10,color='red')\ndata.loc[data['Gender']=='Male']['Annual Income (k$)'].hist(bins=10)","00b42c00":"data.loc[data['Gender']=='Female']['Spending Score (1-100)'].hist(bins=10,color='red')\ndata.loc[data['Gender']=='Male']['Spending Score (1-100)'].hist(bins=10)","34fcf684":"data.groupby('Gender')['Spending Score (1-100)'].mean().plot(kind='barh')","bb3f538a":"avg_sample_score_female = data.loc[data['Gender']=='Female','Spending Score (1-100)',].mean()\navg_sample_score_male = data.loc[data['Gender']=='Male','Spending Score (1-100)'].mean()\nn_female = data.loc[data['Gender']=='Female','Gender'].count()\nn_male = data.loc[data['Gender']=='Male','Gender'].count()\nsample_score_female_var = data.loc[data['Gender']=='Female','Spending Score (1-100)'].var()\nsample_score_male_var = data.loc[data['Gender']=='Male','Spending Score (1-100)'].var()\n\nt_num = avg_sample_score_female-avg_sample_score_male\nt_den = np.sqrt((sample_score_female_var\/n_female)+(sample_score_male_var\/n_male))\nt_stat = t_num\/t_den\n\ndf_num = np.square((sample_score_female_var\/n_female)+(sample_score_male_var\/n_male))\ndf_den1 = np.square(sample_score_female_var\/n_female)\/(n_female-1)\ndf_den2 = np.square(sample_score_male_var\/n_male)\/(n_male-1)\ndf = df_num\/(df_den1+df_den2)","7237bca2":"p_val = 1-stats.t.cdf(t_stat,df=df)\np_val","6e7a55dc":"fg = snb.FacetGrid(data=data,hue='Gender',height=5,aspect=1.5)\nfg.map(plt.scatter,'Age','Annual Income (k$)').add_legend()","2f1f8f45":"bins = pd.IntervalIndex.from_tuples([(0,20),(20,30),(30,40),(40,50),(50,60),(60,70)])\ndata['Age_cat'] = pd.cut(data['Age'],bins)","0080dd57":"fig,ax = plt.subplots(figsize=(10,5))\nsnb.boxplot(x='Age_cat',y='Annual Income (k$)',hue='Gender',data=data,ax=ax)","4a601374":"fig = snb.FacetGrid(data=data,hue='Gender',height=5,aspect=1.5)\nfig.map(plt.scatter,'Age','Spending Score (1-100)').add_legend()","02b3d80a":"fig,ax = plt.subplots(figsize=(10,5))\nsnb.boxplot(data=data,x='Age_cat',y='Spending Score (1-100)',hue='Gender',ax=ax)","9cdbdaa2":"fig = snb.FacetGrid(data=data,hue='Gender',height=5,aspect=1.5)\nfig.map(plt.scatter,'Annual Income (k$)','Spending Score (1-100)').add_legend()","4543710c":"bins = pd.IntervalIndex.from_tuples([(0,20),(20,40),(40,60),(60,80),(80,100),(100,120),(120,140)])\ndata['Annual_income_cat'] = pd.cut(data['Annual Income (k$)'],bins)","935e1966":"fig,ax = plt.subplots(figsize=(10,5))\nsnb.boxplot(data=data,x='Annual_income_cat',y='Spending Score (1-100)',hue='Gender',ax=ax)","46276a10":"data = pd.read_csv(r\"..\/input\/Mall_Customers.csv\")","9415d06c":"data.head()","bf4b7eff":"train_test_data = data.copy()\ntrain_test_data = train_test_data.drop('CustomerID',axis=1)\ntrain_test_data['Gender'] = pd.Categorical(train_test_data['Gender']).codes\ntrain_test_data['Age'] = (train_test_data['Age'] - train_test_data['Age'].mean())\/(train_test_data['Age'].max()-train_test_data['Age'].min())\ntrain_test_data['Annual Income (k$)'] = (train_test_data['Annual Income (k$)'] - train_test_data['Annual Income (k$)'].mean())\/(train_test_data['Annual Income (k$)'].max()-train_test_data['Annual Income (k$)'].min())\ntrain_test_data['Spending Score (1-100)'] = train_test_data['Spending Score (1-100)']\/100\ntrain_test_data.head()","2f823d76":"train_data,test_data = train_test_split(train_test_data,test_size=0.2)","40cdb476":"intertia = []\nfor k in range(1,20):\n    kmean_clf = KMeans(n_clusters=k).fit(train_data)\n    intertia.append(kmean_clf.inertia_)","4e44390b":"df = pd.DataFrame(list(zip(range(1,20),intertia)),columns=['num_cluster','inertia'])\nfig,ax = plt.subplots(figsize=(8,5))\ndf.plot(x='num_cluster',y='inertia',kind='line',ax=ax)","1855e0ea":"kmean_clf = KMeans(n_clusters=5).fit(train_data)\nkmean_clf.score(test_data)","d6983ed7":"train_data['cluster'] = kmean_clf.labels_","a4807596":"fig = snb.FacetGrid(data=train_data,hue='cluster',height=5,aspect=1.5)\nfig.map(plt.scatter,'Age','Annual Income (k$)').add_legend()","1fd8d796":"fig = snb.FacetGrid(data=train_data,hue='cluster',height=5,aspect=1.5)\nfig.map(plt.scatter,'Age','Spending Score (1-100)').add_legend()","038f3e44":"fig = snb.FacetGrid(data=train_data,hue='cluster',height=5,aspect=1.5)\nfig.map(plt.scatter,'Annual Income (k$)','Spending Score (1-100)').add_legend()","3843c427":"train_test_data.head()","30d376ee":"data_sub = train_test_data[['Age','Annual Income (k$)']]\ndata_sub.head()","7aef403f":"inertia = []\nfor k in range(1,10):\n    kmean_clf = KMeans(n_clusters=k).fit(data_sub)\n    inertia.append(kmean_clf.inertia_)","6b9b2db5":"df = pd.DataFrame(list(zip(range(1,10),inertia)),columns=['num_cluster','intertia'])\ndf.plot(x='num_cluster',y='intertia',kind='line')","2363e799":"kmean_clf = KMeans(n_clusters=5).fit(data_sub)","6e40b54e":"data_sub['centroid'] = kmean_clf.labels_","c512bb0b":"fig = snb.FacetGrid(data=data_sub,hue='centroid',height=5,aspect=1.5)\nfig.map(plt.scatter,'Age','Annual Income (k$)').add_legend()","7ff88f47":"data_sub = train_test_data[['Age','Spending Score (1-100)']]\ndata_sub.head()","7b7ef7c1":"inertia = []\nfor k in range(1,10):\n    kmean_clf = KMeans(n_clusters=k).fit(data_sub)\n    inertia.append(kmean_clf.inertia_)","b12516df":"df = pd.DataFrame(list(zip(range(1,10),inertia)),columns=['num_cluster','intertia'])\ndf.plot(x='num_cluster',y='intertia',kind='line')","30fac31c":"kmean_clf = KMeans(n_clusters=5).fit(data_sub)","64c2981e":"data_sub['centroid'] = kmean_clf.labels_","fa83fc3c":"fig = snb.FacetGrid(data=data_sub,hue='centroid',height=5,aspect=1.5)\nfig.map(plt.scatter,'Age','Spending Score (1-100)').add_legend()","fc5978c3":"data_sub = train_test_data[['Annual Income (k$)','Spending Score (1-100)']]\ndata_sub.head()","b5852a53":"inertia = []\nfor k in range(1,10):\n    kmean_clf = KMeans(n_clusters=k).fit(data_sub)\n    inertia.append(kmean_clf.inertia_)","10ea024f":"df = pd.DataFrame(list(zip(range(1,10),inertia)),columns=['num_cluster','intertia'])\ndf.plot(x='num_cluster',y='intertia',kind='line')","4eb85308":"kmean_clf = KMeans(n_clusters=5).fit(data_sub)","0894540d":"data_sub['centroid'] = kmean_clf.labels_","57da94c9":"fig = snb.FacetGrid(data=data_sub,hue='centroid',height=5,aspect=1.5)\nfig.map(plt.scatter,'Annual Income (k$)','Spending Score (1-100)').add_legend()","9c896e15":"from the elbow plot above 4 seems to be reasonable number for the number of clusters. Let's see how we perfrom on the test set","a4ef8653":"# Conclusion\nThe clusters came out really neat when we did clustering on selected features. This is not to say that the clusters created with all features was bad. Mayby it was only the visualization that was not clear.","a536605e":"Again the Clusters are really neat. \n<br>\nHere again the cluster 2 (green) is interesting. Customer in this group belong to higher income group and spend high too.","971fe420":"# K-mean Clustering","b36ae462":"in the data provided Male seems to be earning slightly higher then females","02d70310":"Here again looks like the spending score goes down as the age increases.But again, data is too noisy and scattered to say anything conclusivly.","e68271f7":"### Age & Total Income","25e39af0":"### Male Vs Female","2dc226d7":"This is much batter. Clusters are neatly separable. \n<br>\n<b> Cluster 0<\/b> these are people in middle age group and have higher income.Traget audience for high end product.\n<br>\n<b> Cluster 1<\/b> these are people spread through young to middle age group and have lower income. Can be targated for discuounts & offers.\n<br>\n<b> Cluster 2<\/b> these are people from old age ad have relatively lower income. targated for Product meant for the age group with lower price points.\n<br>\n<b> Cluster 3<\/b> these are people from old age ad have relatively lower income. targated for Product meant for the age group with lower price points. \n<br>\n<b> Cluster 4<\/b> these are people from young age group and have relatively higher income. good target for high end tech products.","0ce3399f":"### Age Vs Annual Income","cd44e9b6":"No sure what to make of this. The variance dramatically shirnks for the Income group 40,60 but is spred out everywhere else. could be a quark in the sample taken.","04858f2d":"### Spending Score & Total Income","75c7229b":"### Age & Spending Score","86d4a541":"#### We can do a hypothesis test and see if spending pattern indicated in sample is true over the population or not\n<b>Hypothesis 1<\/b>\n<br>\n<b>avg_score_female:<\/b> Avarage spending score for females\n<br>\n<b>avg_score_male:<\/b> Avaarage spending score or male\n<br><br>\n<b>Null Hypothesis<\/b> avg_score_male <= avg_score_male\n<br>\n<b>Alternate Hypothesis<\/b> avg_score_male <= avg_score_male","d1b47024":"From above elbow plot 5 looks like a reasonable number to pick","be9fabf7":"Again success! The clusters looks clean.\n<br>\nWe can look at individual clusters and build strategy like before. for now I want to point at cluster 2 (Green). Customer in this cluster belong to younger age group and have high spending score. This is interesting from marketing standpoint. ","f1392ed6":"The P-Value is quite high. If we consider 0.05 as critical value then we cannot reject the Null Hypothesis. Hence we can't say conclusivley that spending pattern indicated in the sampe is true for the population as well.","e48f0562":"### Annual Income Vs Spending Score","707cb05e":"# Customer Segmentation\nIn this excercise we will slice and dice the customer-segment dataset. it's toy dataset meant for basic EDA and Clustering.","441efa9f":"However female seems to be leading in spending","29a7b5a1":"The visual are not so great whatever way we slice it. let's try one more run of KMean clustering but this time let's do it on selected features instead of all features.","81197d5f":"Score is fine.Let's now try to plot the culsters and see if clusters appear visually seperable or not.","3e4b5144":"### Age Vs Spending Score","4c0b2bc9":"# EDA","6df4f0ef":"Looks like the annual income is on the lower side on the tails (age group 0,20 & 60,70). There is no apparent distiction in the trend for male and that for female. However data is too noisy & scatter to say anything conclusively."}}