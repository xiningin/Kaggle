{"cell_type":{"86753dda":"code","c1a6a918":"code","63499dff":"code","57d3eb96":"code","8f2494e3":"code","b3619351":"code","0827bbd5":"code","72d95105":"code","ad7de245":"code","544cc2d9":"code","ef1eb24d":"code","8f82975b":"code","2528a4e7":"code","6f8fb7e7":"markdown","4ee49e63":"markdown","f0b22b96":"markdown","c695cae5":"markdown","ad9e93c8":"markdown","6c7c9054":"markdown","3dbb3220":"markdown","3611e491":"markdown","4153a8c7":"markdown","c76df9b9":"markdown","e9b2874a":"markdown","47b85db1":"markdown","e1694bd2":"markdown","9d4cb7dd":"markdown"},"source":{"86753dda":"import pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom scipy.cluster.vq import whiten\nfrom scipy.cluster.hierarchy import dendrogram, linkage, fcluster\nimport warnings\nwarnings.filterwarnings('ignore')","c1a6a918":"df = pd.read_csv('..\/input\/fifa-21-complete-player-dataset\/players_21.csv')\nprint(df.shape)\ndf.head()","63499dff":"# Filter the 'passing' & 'mentality_vision' features and check for missing values\ndf[['passing', 'mentality_vision']].isnull().sum()","57d3eb96":"# Filter only the rows that do not contain missing values\ndf_notna = df[df['passing'].notna()]\ndf_notna[['passing', 'mentality_vision']].isnull().sum()","8f2494e3":"# Explore visually the relationship between 'passing' and 'mentality_vision' through a scatterplot\nfig, ax = plt.subplots(figsize=(15,8))\nax.scatter(df_notna['passing'], df_notna['mentality_vision'], color='violet')\nax.set_xlabel('Passing')\nax.set_ylabel('Mentality vision')\nplt.show()","b3619351":"# Normalize the features\npassing = df_notna['passing'].tolist()\nmentality_vision = df_notna['mentality_vision'].tolist()\n\nscaled_passing = whiten(passing)\nscaled_mvision = whiten(mentality_vision)","0827bbd5":"# Create columns with the scaled features in the dataframe\ndf_notna['scaled_passing'] = scaled_passing\ndf_notna['scaled_mvision'] = scaled_mvision","72d95105":"# Create plots illustrating the features before & after normalization.\nfig, ax = plt.subplots(1,2,figsize=(12,6))\n\nax[0].plot(df_notna['passing'], label='original', color='wheat')\nax[0].plot(df_notna['scaled_passing'], label='scaled', color='purple')\nax[0].set_title('Passing')\nax[0].legend()\nax[1].plot(df['mentality_vision'], label='original', color='wheat')\nax[1].plot(df_notna['scaled_mvision'], label='scaled', color='purple')\nax[1].set_title('Mentality vision')\nax[1].legend()\nplt.show()","ad7de245":"# Fit the data into hierarchical clustering algorithm\ndm = linkage(df_notna[['scaled_passing', 'scaled_mvision']], method='ward')\n\n# Create a dendrogram\nplt.figure(figsize=(15,8))\ndendr = dendrogram(dm)\nplt.show()","544cc2d9":"# Assign cluster label to each row\ndf_notna['labels'] = fcluster(dm, 3, criterion = 'maxclust')","ef1eb24d":"# Print cluster centers of each cluster\nprint(df_notna.groupby('labels')['scaled_passing', 'scaled_mvision'].mean())","8f82975b":"# Create the scatterplot\nplt.figure(figsize=(15,8))\nsns.scatterplot(x='passing', y='mentality_vision', hue='labels', data=df_notna)\nplt.show()","2528a4e7":"# Identify 5 players of each cluster\nfor cluster in df_notna['labels'].unique():\n    print(cluster, df_notna[df_notna['labels']==cluster]['short_name'].values[:5])","6f8fb7e7":"**Importing libraries**","4ee49e63":"The plyers from cluster 2 are the players with the highest passing and mentality vision in their attirbutes, while the players from cluster 1 comes with the lowest values on these attributes.\n\nCluster 3 consists of players somewhere in between.","f0b22b96":"For a height of around 70, we can observe that we have 3 clusters.\n\nThe smaller the height the higher the clusters. ","c695cae5":"# <span style=\"font-family: Blippo, fantasy; font-size: 18px; font-weight: bold; letter-spacing: 3px; color: #6D3FCA\">WHAT IS A DENDROGRAM?<\/span>\n- A diagram that shows how clusters are formed\n- Visual method through which clusters can be decided\n\nAXES LABELS\n - y-axis: height of the dendrogram showing the distance between merging clusters\n - x-axis: features used to create clusters\n\n","ad9e93c8":"# <span style=\"font-family: Blippo, fantasy; font-size: 18px; font-weight: bold; letter-spacing: 3px; color: #6D3FCA\">WHY IS NORMALIZATION REQUIRED FOR CLUSTERING?<\/span>\n- The features might have incomparable units: weight (kg\/lbs) vs value (dollar\/euro)\n- Data in raw form can lead to bias\n- Clusters might be highly dependent on one feature\n\n","6c7c9054":"# <span style=\"font-family: Blippo, fantasy; font-size: 18px; font-weight: bold; letter-spacing: 3px; color: #6D3FCA\">FEATURES NORMALIZATION<\/span>\n - Normalization is a process of rescaling the data to standard deviation (STD) of 1","3dbb3220":"# <p style=\"background-color: #6D3FCA; font-family: Blippo, fantasy; line-height: 1.3; font-size: 26px; letter-spacing: 3px; text-align: center; color: #DBCBFA\">Beginners Hierarchical Clustering: FIFA 21<\/p>\n\n![](https:\/\/enter21st.com\/wp-content\/uploads\/2020\/04\/FIFA-21-Release-date-Career-Mode-Ratings-Delays-PS5-Xbox.jpg)","3611e491":"**Reading data**","4153a8c7":"<hr style=\"height: 10px; border: 0; background-color: #6D3FCA\">","c76df9b9":"# <span style=\"font-family: Blippo, fantasy; font-size: 18px; font-weight: bold; letter-spacing: 3px; color: #6D3FCA\">WHAT IS CLUSTERING?<\/span>\n- Clustering is the process through which items with similar characteristics are grouped","e9b2874a":"**Features**","47b85db1":"# <span style=\"font-family: Blippo, fantasy; font-size: 18px; font-weight: bold; letter-spacing: 3px; color: #6D3FCA\">INTRODUCTION<\/span>\nIn this notebook a clustering algorithm is presented. Approaching a dataset from the field of sports & games, I want to show how <b>hierarchical clustering<\/b> can be performed shortly and easily.\nFor that purpose, 2 features will be considered:\n - 'Passing'\n - 'Mentality_Vision'\n \nThe objective is to find different groups of players based on their 'Passing' and 'Mentality_vision'\n","e1694bd2":"# <span style=\"font-family: Blippo, fantasy; font-size: 18px; font-weight: bold; letter-spacing: 3px; color: #6D3FCA\">WHAT IS A CLUSTER?<\/span>\n - A cluster refers to a group of items with similar characteristics\n \n","9d4cb7dd":"**Players in different clusters**"}}