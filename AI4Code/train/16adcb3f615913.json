{"cell_type":{"f52eb4e4":"code","d7e6aa56":"code","5e3f8ebb":"code","f864b688":"code","00497d1e":"code","674db6a2":"code","1db78c1f":"code","e4c568db":"code","a23cff39":"code","a7ceafd3":"code","906f9041":"code","af0f5215":"code","a7e47456":"code","608785bd":"code","cdd767a8":"code","a5347677":"code","893ed9cc":"markdown","5e1a67ce":"markdown","d602abf9":"markdown","760868de":"markdown","bd102ec2":"markdown"},"source":{"f52eb4e4":"import pandas as pd\nimport numpy as np\nfrom sklearn import tree\nfrom sklearn.model_selection import train_test_split\nfrom sklearn import metrics","d7e6aa56":"train_df = pd.read_csv('..\/input\/titanic\/train.csv')\ntest_df = pd.read_csv('..\/input\/titanic\/test.csv')\ntrain_df.head()","5e3f8ebb":"data_train = train_df.drop(['Name', 'PassengerId', 'Ticket', 'Cabin'], axis=1)\ndata_test = test_df.drop(['Name', 'PassengerId', 'Ticket', 'Cabin'], axis=1)","f864b688":"categorical_cols = [cname for cname in data_train.columns if\n                    data_train[cname].nunique() <= 10 and\n                    data_train[cname].dtype == 'object'\n                   ]\nnumerical_cols = [cname for cname in data_train.columns if\n                    data_train[cname].dtype in ['int64', 'float64']\n                 ]","00497d1e":"categorical_cols, numerical_cols","674db6a2":"data_train.Age = data_train['Age'].fillna(data_train['Age'].median())\ndata_test.Age = data_test['Age'].fillna(data_test['Age'].median())","1db78c1f":"data_test.Fare = data_test['Fare'].fillna(data_test['Fare'].median())","e4c568db":"data_train.dropna(subset=['Embarked'], inplace=True)","a23cff39":"data_train = pd.get_dummies(data_train)\ndata_test = pd.get_dummies(data_test)","a7ceafd3":"data_train.columns","906f9041":"x_train, x_test, y_train, y_test = train_test_split(data_train.drop('Survived', axis=1), data_train['Survived'], test_size=0.2)","af0f5215":"model = tree.DecisionTreeClassifier()\nmodel.fit(x_train, y_train)","a7e47456":"model.score(x_test, y_test) # Accuracy score","608785bd":"output = pd.DataFrame({'PassengerId':test_df.PassengerId, 'Survived':model.predict(data_test)})\noutput","cdd767a8":"output.to_csv('my_submission.csv', index=False)","a5347677":"from io import StringIO \nimport pydotplus\n\nout = StringIO()\ntree.export_graphviz(model, out_file=out)\n\ngraph = pydotplus.graph_from_dot_data(out.getvalue())\ngraph.write_png('titanic.png')","893ed9cc":"**Tree Display**","5e1a67ce":"**Data Cleaning**","d602abf9":"**Dataframe Exploration**","760868de":"**Training**","bd102ec2":"**Prediction**"}}