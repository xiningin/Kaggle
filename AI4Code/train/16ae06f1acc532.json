{"cell_type":{"1498351d":"code","08c64e2f":"code","c10a22f5":"code","9c46f262":"code","08410e65":"code","ee3a28b5":"code","e2c5dc4b":"code","a1176489":"code","ec1ebf9a":"code","9c315a36":"code","3d90bdbe":"code","85f59e05":"code","a60ec85a":"code","52da5674":"code","210cafdd":"code","7f8d0f39":"code","0e5e87ef":"code","4c1108eb":"code","ba03f66d":"code","0978b4ee":"code","510a9399":"code","10def9ab":"code","5e63d0c7":"code","05872f83":"code","a019bb33":"code","91e0b024":"code","e394e1b9":"code","c67365c9":"code","629d2486":"code","fd9754d7":"code","774689f7":"code","8e9ecb01":"code","e310bb1b":"code","91fcda4e":"code","b481c173":"code","f4f2c691":"code","8315771e":"code","83f1391e":"code","a5dbfb3b":"code","cab71a17":"code","47b8120c":"code","8a1e531e":"code","419990ab":"code","9740ba5c":"markdown","6920afd4":"markdown","984b8d8c":"markdown","e055ac7a":"markdown","55f5e60a":"markdown","2aef90e6":"markdown","6a4d9a73":"markdown","85424308":"markdown","74139125":"markdown","0b4da35d":"markdown","561fde80":"markdown","e2cc693f":"markdown","942adfc0":"markdown","a3b98a82":"markdown","6083777d":"markdown","a33d8ffc":"markdown","e8a46d29":"markdown","22510054":"markdown","bc12eea9":"markdown","f4da1e2c":"markdown","d6c112ee":"markdown","8c2cd269":"markdown","31ea17c2":"markdown","66b83e75":"markdown","acb14b40":"markdown","d6ef87cf":"markdown","7a0a0ffd":"markdown","69bb4a08":"markdown","0869170b":"markdown","b814f611":"markdown","d668e9a9":"markdown","bd2caa37":"markdown","940407cc":"markdown","06b6670b":"markdown"},"source":{"1498351d":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\nfrom pandas.tools.plotting import scatter_matrix\n\nimport matplotlib.pyplot as plt\n\nfrom sklearn import model_selection\nfrom sklearn.metrics import classification_report\nfrom sklearn.metrics import confusion_matrix\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.discriminant_analysis import LinearDiscriminantAnalysis\nfrom sklearn.naive_bayes import GaussianNB\nfrom sklearn.svm import SVC\nimport seaborn as sns\nfrom sklearn.model_selection import train_test_split\nfrom sklearn import linear_model\nfrom matplotlib import colors\nfrom matplotlib.ticker import PercentFormatter\nfrom sklearn.tree import export_graphviz\nfrom sklearn.preprocessing import StandardScaler, LabelBinarizer\nimport statsmodels.api as sm\n# auxiliary function\nfrom sklearn.preprocessing import LabelEncoder\ndef random_colors(number_of_colors):\n    color = [\"#\"+''.join([random.choice('0123456789ABCDEF') for j in range(6)])\n                 for i in range(number_of_colors)]\n    return color\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","08c64e2f":"##loading the data\niris = pd.read_csv(\"..\/input\/Iris.csv\") \n##Getting a gist of the dataset in hand\niris.describe()\n","c10a22f5":"#Glancing features\niris.info()","9c46f262":"#First few observations\niris.head(20)","08410e65":"iris.isnull().count()","ee3a28b5":"#One more way to quickly check if your assumption about the widths and lengths of Sepal and Petal \n#differs for different species\nPivot = iris.pivot(\"Species\",\"Id\")\nprint(Pivot)\nsns.heatmap(Pivot,cbar = True)","e2c5dc4b":"iris.hist()\nplt.show()\n","a1176489":"##scatter plot\n\nscatter_matrix(iris)\nplt.show()","ec1ebf9a":"iris.Species.value_counts().plot(kind='pie')\n#Pie chart shows that all 3 species are distributed equally.","9c315a36":"iris['Species']=iris['Species'].astype('category')\niris.dtypes","3d90bdbe":"plt.figure()\nfig,ax=plt.subplots(1,2,figsize=(17, 19))##\niris.plot(x=\"SepalLengthCm\",y=\"SepalWidthCm\",kind=\"scatter\",ax=ax[0],sharex=False,sharey=False,label=\"sepal\",color='g')\niris.plot(x=\"PetalLengthCm\",y=\"PetalWidthCm\",kind=\"scatter\",ax=ax[1],sharex=False,sharey=False,label=\"petal\",color='y')\nax[0].set(title='Sepal comparasion ', ylabel='sepal-width')\nax[1].set(title='Petal Comparasion',  ylabel='petal-width')\nax[0].legend()\nax[1].legend()\n##Sepal comparison shows that the range of the sepal width is between 2 to 4.5,most of the data points are between 2.5 to 3.5.\n#Petal Comparision shows that the range of the petal width is between 0.5 to 2.5,intersting observation here is that there are no points in the scatterplot between 0.5 & 1.\n#There is a gradual increase in the petal length from 1 to 2.5\n#From this we can conclude that there is a finite pattern in the sepal and petal widths,lengths.","85f59e05":"##I don't recommend this part of the code for beginners\nsetosa=iris[iris['Species']=='Iris-setosa']\nversicolor =iris[iris['Species']=='Iris-versicolor']\nvirginica =iris[iris['Species']=='Iris-virginica']\n\nprint(setosa.describe())\nprint(versicolor.describe())\nprint(virginica.describe())\n\n##using the data frame to plot a scatter plot for comparing different species\n##Thanks Abhishek Gupta for this method:)\n\n\n\nplt.figure()\nfig,ax=plt.subplots(1,2,figsize=(21, 10))##1,2 indicates the visual will be fitted in a row and 2 columns.\n\nsetosa.plot(x=\"SepalLengthCm\", y=\"SepalWidthCm\", kind=\"scatter\",ax=ax[0],label='Setosa',color='r')\nvirginica.plot(x=\"SepalLengthCm\", y=\"SepalWidthCm\", kind=\"scatter\",ax=ax[0],label='Virginica',color='g')\nversicolor.plot(x=\"SepalLengthCm\", y=\"SepalWidthCm\", kind=\"scatter\",ax=ax[0],label='Versicolor',color='b')\n\nsetosa.plot(x=\"PetalLengthCm\", y=\"PetalWidthCm\", kind=\"scatter\",ax=ax[1],label='Setosa',color='r')\nversicolor.plot(x=\"PetalLengthCm\",y=\"PetalWidthCm\",kind=\"scatter\",ax=ax[1],label='Versicolor',color='b')\nvirginica.plot(x=\"PetalLengthCm\", y=\"PetalWidthCm\", kind=\"scatter\", ax=ax[1], label='Virginica', color='g')\n\nax[0].set(title='Sepal comparasion ', ylabel='sepal-width')\nax[1].set(title='Petal Comparasion',  ylabel='petal-width')\nax[0].legend()\nax[1].legend()\n#As we have seen in the previous scatterplot,this one confirms it.","a60ec85a":"iris_1=iris.drop(['Id'],axis=1)\niris_1.head()\niris_1.corr()","52da5674":"\npd.crosstab(iris.SepalLengthCm,iris.Species).plot(kind='bar')\nplt.title('Sepal Length vs Species')\nplt.xlabel('Species')\nplt.ylabel('Sepal Length')\nplt.subplots_adjust(bottom=0.1, right=1.9, top=1.5)\n\npd.crosstab(iris.SepalWidthCm,iris.Species).plot(kind = 'bar')\nplt.title('Sepal Width vs Species')\nplt.xlabel('Species')\nplt.ylabel('Sepal Width')\nplt.subplots_adjust(bottom=0.1, right=1.9, top=1.5)\n","210cafdd":"\npd.crosstab(iris.PetalLengthCm,iris.Species).plot(kind='bar')\nplt.title('Petal Length vs Species')\nplt.xlabel('Species')\nplt.ylabel('Petal Length')\nplt.subplots_adjust(bottom=0.1, right=1.9, top=1.5)\n\npd.crosstab(iris.PetalWidthCm,iris.Species).plot(kind = 'bar')\nplt.title('Petal Width vs Species')\nplt.xlabel('Species')\nplt.ylabel('Petal Width')\nplt.subplots_adjust(bottom=0.1, right=1.9, top=1.5)\n","7f8d0f39":" sns.pairplot(iris, hue='Species', size=2.5)\n#The pair plot also shows some overlap.","0e5e87ef":"x = iris.PetalLengthCm\ny = iris.PetalWidthCm\nplt.scatter(x, y ,s = 10*x,data = iris,cmap = \"plasma\",c = iris.PetalLengthCm)\nplt.xlabel(\"PetalLengthCm\")\nplt.ylabel(\"PetalWidthCm\")\nplt.subplots_adjust(bottom=0.1, right=1.9, top=1.5)","4c1108eb":"x =iris.SepalLengthCm\ny =iris.SepalWidthCm\nplt.scatter(x,y,s = 10*x,data = iris,cmap = \"plasma\",c = iris.SepalLengthCm)\nplt.xlabel(\"SepalLength\")\nplt.ylabel(\"SepalWidth\")\nplt.subplots_adjust(bottom=0.1, right=1.9, top=1.5)","ba03f66d":"##Learned this encoding technique from Ranjeet Jain's Iris notebook\nx = iris[['SepalLengthCm','SepalWidthCm','PetalLengthCm','PetalWidthCm']]\ny = iris['Species']\nencoder = LabelEncoder()\ny = encoder.fit_transform(y)\nx_train, x_test, y_train, y_test = train_test_split(x, y, test_size = 0.3, random_state = 101)\n","0978b4ee":"lr_model = LogisticRegression()\nlr_model.fit(x_train,y_train)\nlr_predict = lr_model.predict(x_test)\nprint('Logistic Regression - ',accuracy_score(lr_predict,y_test))\n","510a9399":"print(\"Confusion Matrix\",confusion_matrix(y_test,lr_predict))\n\n","10def9ab":"print(\"Accuracy :\" ,accuracy_score(y_test,lr_predict)*100)","5e63d0c7":"print(\"Report :\" ,classification_report(y_test,lr_predict))\n","05872f83":"print(cross_val_score(lr_model,x,y,scoring = 'accuracy',cv = 10))\naccuracy_lr = cross_val_score(lr_model,x,y,scoring = 'accuracy',cv = 10).mean()*100\naccuracy_lr    ","a019bb33":"loocv = model_selection.LeaveOneOut()\nprint(cross_val_score(lr_model,x,y,cv = 10))\naccuracy_llr = cross_val_score(lr_model,x,y,cv = 10).mean()*100\naccuracy_llr ","91e0b024":"#Linear Discriminant Analysis\n\ndiscrim = LinearDiscriminantAnalysis()\ndiscrim.fit(x_train,y_train)\ndiscrim_predict = discrim.predict(x_test)\nprint(\"Accuracy Score:\",accuracy_score(discrim_predict,y_test))\n\n","e394e1b9":"print(\"Confusion Matrix\",confusion_matrix(y_test,discrim_predict))\n","c67365c9":"print(\"Accuracy :\" ,accuracy_score(y_test,discrim_predict)*100)","629d2486":"print(\"Report :\" ,classification_report(y_test,discrim_predict))\n","fd9754d7":"print(cross_val_score(discrim,x,y,scoring ='accuracy',cv = 50))\naccuracy_disc = cross_val_score(discrim,x,y,scoring = 'accuracy',cv = 50).mean()*100\naccuracy_disc","774689f7":"loocv = model_selection.LeaveOneOut()\n\nprint(cross_val_score(discrim,x,y,cv = loocv))\naccuracy_ld = (cross_val_score(discrim,x,y,cv = loocv)).mean()*100;accuracy_ld","8e9ecb01":"d_tree = DecisionTreeClassifier(max_depth = 4)\nd_tree_fit = d_tree.fit(x_train,y_train)\nd_tree_pred = d_tree.predict(x_test)\nprint(\"Decision Tree Accuracy\",accuracy_score(d_tree_pred,y_test))","e310bb1b":"print(\"Confusion Matrix: \", \n        confusion_matrix(y_test, d_tree_pred)) \n      \nprint (\"Accuracy : \", \n    accuracy_score(y_test,d_tree_pred)*100) \n      \nprint(\"Report : \", \n    classification_report(y_test, d_tree_pred))","91fcda4e":"print(cross_val_score(d_tree,x,y,scoring = 'accuracy',cv= 50))\naccuracy_dt = cross_val_score(d_tree,x,y,scoring = 'accuracy',cv= 50).mean()*100\naccuracy_dt","b481c173":"loocv = model_selection.LeaveOneOut()\n\nprint(cross_val_score(d_tree,x,y,cv= loocv))\naccuracy_ldt = cross_val_score(d_tree,x,y,cv= loocv).mean()*100\naccuracy_ldt","f4f2c691":"rf_model = RandomForestClassifier(max_depth = 3)\nrf_fit = rf_model.fit(x_train,y_train)\nfr_tree_pred = rf_fit.predict(x_test)\n","8315771e":"print(cross_val_score(rf_model, x, y, scoring='accuracy', cv = 50))\naccuracy_cv = cross_val_score(rf_model,x,y,scoring = 'accuracy',cv = 50).mean()*100\naccuracy_cv","83f1391e":"loocv = model_selection.LeaveOneOut()\n\nprint(cross_val_score(rf_model, x, y,  cv = loocv))\naccuracy_lcv = cross_val_score(rf_model,x,y,cv = loocv).mean()*100\naccuracy_lcv","a5dbfb3b":"print(\"Confusion Matrix:\",confusion_matrix(y_test,fr_tree_pred))","cab71a17":"print(\"Accuracy Score:\",accuracy_score(y_test,fr_tree_pred)*100)","47b8120c":"print(\"EvaluationReport : \",classification_report(y_test,fr_tree_pred))","8a1e531e":"from sklearn.cluster import KMeans\n# Number of clusters\nkmeans = KMeans(n_clusters=3)\n# Fitting the input data\nkmeans = kmeans.fit(x_train,y_train)\n# Getting the cluster labels\nlabels = kmeans.predict(x_test,y_test)\n# Centroid values\ncentroids = kmeans.cluster_centers_\nprint(centroids)","419990ab":"colormap = np.array(['purple', 'black', 'yellow'])\nplt.subplot(1, 2, 1)\nplt.subplots_adjust(right = 2,left = 0.3)\nplt.scatter(x_test.PetalLengthCm, x_test.PetalWidthCm, c=colormap[y_test], s=40)\nplt.title('K Mean Classification Test Data')\nplt.subplot(1, 2, 2)\nplt.scatter(x_train.PetalLengthCm, x_train.PetalWidthCm, c=colormap[y_train], s=40)\nplt.title('K Mean Classification on Train Data')\n\n","9740ba5c":"Inorder to decide which model is the best model,we can consider the accuracy scores.\nYou can see that the Accuracy score for Linear Discriminant model  is higher compared to all other models.\nOne more observation with respect to confusion matrix here is ,LDA & Random forest had 0 mis- calssification.All other models had misclassification to some degree.\n","6920afd4":"Looks like an illusion that we do not have any null values!Great,time saver!\nShould check though.","984b8d8c":"**Correlation Coefficients\n**I have already mentioned that there is a high level of predictability with the available variables.One needs to examine the correlation between the variables.\nCorrelation is applicable only for numerical data.","e055ac7a":"From this histogram we could see that there are few observations where the Sepal lengths are almost the same.\nWe coudld also see that the extreme points have distinct species captured.\nWe can confirm that there is a distinction between the Species with respect to Sepal Lengths & Widths.\n\n\n","55f5e60a":"Leave one out cross validation","2aef90e6":"Machine learning  to predict the type of Iris flower based on other parameters.\nSince this is a classification problem we will explore related algorithms.\n","6a4d9a73":"**                                                                                      Decision Tree**","85424308":"**Linear Discriminant Analysis**","74139125":"#This is another way\n#train=iris.sample(frac=0.8,random_state=200)\n#test=iris.drop(train.index)\n\ntrain,test = train_test_split(iris,test_size = 0.2)\ntrain.info();test.info()","0b4da35d":"Cross Validation for Decision Tree","561fde80":"**Evaluation**","e2cc693f":"The data that we see in the real world contains noise and are generally not ready for instant analysis.Therefore we need to cleanse them for making it usable.","942adfc0":"The mean being 94.67","a3b98a82":"Model Building","6083777d":"Interpreting the correlation matrix,\n1.SepalLengthCm - PetalLengthCm,PetalWidthCm are highly correlated positively.\n2.SepalWidthCm - Has negative relationship with all the other varaibles.\n3.PetalLengthCm - SepalLengthCm & PetalWidthCm are highly correlated.\n4.PetalWidthCm - SepalLengthCm & PetalWidthCm are highly correlated.","a33d8ffc":"Now some visualisations,basic ones.","e8a46d29":"The visual above shows that all the three categories of species are of the same proportion.","22510054":"**                                                                               Randomforest Model**","bc12eea9":"**Evaluation**","f4da1e2c":"The scatter plot depicts the Species of Iris.There are no miss classifications in the dataset.We can be assured of this as there are no overlapping dots in the graph for test set.","d6c112ee":"**Evaluation**","8c2cd269":"**Problem statement**\n\n**To predict the type of Iris species based on other features in the dataset pertaining to sepal length,width,petal length and width.\n\nHaving said that we need to know that there are different class of machine learning problems\n1.Supervised - Those which has a pre defined target variable.For every row in the dataset there is a labeled outcome which would be used as a reference to train the model.\n2.Unsupervised Learning - There is no pre defined target variable. There are no prior labellings but we have to predict,group and collate the features,so that they are meaningful.\n\nOur dataset here has a pre defined target variable Species,which qualifies this one to be a supervised learning problem.\n\nMore over our target to be predicted is categorical and hence this is a classification problem.\n**\"Be kind,fork and upvote the kernel,if you find it useful\"**","31ea17c2":"![image.png](attachment:image.png)\n\nThe heatmap above has grouped the species and indicates that our assumption about the Sepal and Petal lengths,widths are true.They all vary significantly for every speices.\nIris - Setosa has **smaller** length & width for both Petal and Sepal.\nIris - Versicolor has **Mediocre** length & width for both Petal and Sepal.\nIris - Virginica has **bigger** length & width for both Petal and Sepal.","66b83e75":"                    **General Introduction**\n\nIn any form of analysis involving data,the main goal of it will be to solve a problem,therefore there is a pipeline to reach the goal.The starting point being gathering required data ,cleaning,visualising and so on.\n\nLast step being building machine learning models and validating them.\nHave a look at this article,\nhttps:\/\/towardsdatascience.com\/a-beginners-guide-to-the-data-science-pipeline-a4904b2d8ad3\n","acb14b40":"LOOCV - Dtree","d6ef87cf":"Model validation Techniques\nI have learned that as some one who works with building machine learning models,we need to be sure that the model that one builds is scalable in every way and provides the same level of accuracy,when new data arrives.\nThis is possible,if we have validation techniques that evaluates the model in a much diligent way.\n","7a0a0ffd":"**    Analysis of the Iris Data Set**\n\nIris is the name of a flower.It is located in the Northern hemisphere zones, from Europe to Asia and across North America.The dataset that we have covers 3 types of Iris species,\nIris Setosa\nIris Virginica\nIris Versicolor\nThe dataset has an intersting history,I was able to learn about this from wiki page,\nhttps:\/\/en.wikipedia.org\/wiki\/Iris_flower_data_set\n\nThe Iris flower data set or Fisher's Iris data set is a multivariate data set introduced by the British statistician and biologist Ronald Fisher in his 1936 paper \"The use of multiple measurements in taxonomic problems as an example of linear discriminant analysis\".\nIt is sometimes called Anderson's Iris data set because Edgar Anderson collected the data to quantify the morphologic variation of Iris flowers of three related species.\n\n","69bb4a08":"Petal Length and Petal Width also shows uniqueness for different species.\nIris Setosa and Iris Virginica have clear distinction of Petal Lengths and Widths.\nSome of them have overlapping features.","0869170b":"**Logistic Regression **                     ","b814f611":"In the code above,the Species is converted to Categorical data type.","d668e9a9":"Which is the best model?","bd2caa37":"The diagonal grouping of the variables suggests that there is a relationship between the objects.This is also called as correlation of the varaibles.High correlation indicates high predictability with fewer features.We will talk about prediction later.","940407cc":"Above visual shows the max and min values of Sepal Length for different Species and some more interesting things.","06b6670b":"We could see that the dataset has 1 Identifier,4 numerical variables & 1 Categorical Variable.\nOur task is to predict the Species with the help of all other dependent variables.\nTherefore,our assumption here is that Species is the dependent variable or the variable to be predicted.\nAll other varaibles ID,SepalLengthCm,SepalWidthCm,PetalLengthCm & PetalWidthCm are Independent  variables.\n\n"}}