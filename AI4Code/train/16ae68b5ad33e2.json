{"cell_type":{"b98bba3b":"code","e76ec1e2":"code","ba4c9026":"code","c6b3cade":"code","8a4bffef":"code","4f269a71":"code","23ddb371":"code","ea660ec6":"code","8bbce44a":"code","e987dd03":"code","701a26a2":"code","cf8e1ecd":"code","11b305bf":"code","8d599836":"code","c0b4c7d4":"code","29ef77fc":"code","53f18914":"code","478c3a28":"code","29e77225":"code","81348d16":"code","3c6db48d":"markdown","9a505ecb":"markdown","a81dfbda":"markdown","30a0156a":"markdown"},"source":{"b98bba3b":"! pip install -q https:\/\/github.com\/pandas-profiling\/pandas-profiling\/archive\/master.zip","e76ec1e2":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport plotly.express as px\nfrom pandas_profiling import ProfileReport","ba4c9026":"accident = pd.read_csv('..\/input\/bicycle-accidents-in-great-britain-1979-to-2018\/Accidents.csv')\nbiker = pd.read_csv('..\/input\/bicycle-accidents-in-great-britain-1979-to-2018\/Bikers.csv')","c6b3cade":"accident.head()","8a4bffef":"biker.head()","4f269a71":"df = accident.merge(biker, on='Accident_Index', how='left')","23ddb371":"df.head()","ea660ec6":"ProfileReport(df, title=\"Bicycle Accident\", explorative=True)","8bbce44a":"def most_frequent(column,value):\n    print(f\"Frequent value for {value} {column}\")\n    print(f\"Number of accident : {df[df[column]==value].shape[0]}\")\n    df_temp = df[df[column]==value]\n    for col in df_temp.columns:\n        if col != column and col != 'Accident_Index':\n            freq_value = df_temp[col].value_counts().idxmax()\n            rate = round(df_temp[df_temp[col]==freq_value].shape[0] \/ df_temp.shape[0], 2) * 100\n            print(f\"{col} : {freq_value} -- {int(rate)}%\")","e987dd03":"for val in df['Severity'].unique():\n    most_frequent('Severity',val)\n    print(\"------------------------------------\")","701a26a2":"for val in df['Road_conditions'].unique():\n    most_frequent('Road_conditions',val)\n    print(\"------------------------------------\")","cf8e1ecd":"for val in df['Light_conditions'].unique():\n    most_frequent('Light_conditions',val)\n    print(\"------------------------------------\")","11b305bf":"for val in df['Age_Grp'].unique():\n    most_frequent('Age_Grp',val)\n    print(\"------------------------------------\")","8d599836":"df.groupby(['Date','Time'])['Accident_Index'].count().sort_values(ascending=False).head(10)","c0b4c7d4":"df[(df['Date']=='1981-11-09')&(df['Time']=='18:00')]","29ef77fc":"df.sort_values('Number_of_Vehicles',ascending=False).head(10)","53f18914":"df['Year'] = df['Date'].apply(lambda x: x.split('-')[0])\ndf_peryear = df.groupby('Year')['Accident_Index'].count().reset_index()","478c3a28":"fig = px.line(df_peryear, x=\"Year\", y=\"Accident_Index\")\nfig.show()","29e77225":"df['Month'] = df['Date'].apply(lambda x: x.split('-')[1])\ndf_permonth = df.groupby('Month')['Accident_Index'].count().reset_index()","81348d16":"fig = px.line(df_permonth, x=\"Month\", y=\"Accident_Index\")\nfig.show()","3c6db48d":"#### What date and time do accidents occur the most ?","9a505ecb":"#### Number of accident per year","a81dfbda":"#### What date was the accident involving a lot of people ?","30a0156a":"#### Number of accident per year"}}