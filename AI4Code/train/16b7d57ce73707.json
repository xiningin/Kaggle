{"cell_type":{"e81773be":"code","4e2a43b5":"code","622d1418":"code","4a2a1fcd":"code","ccd190d3":"code","e498c0ce":"code","a0b22f53":"code","8b4029a5":"code","e5249878":"code","202acee1":"code","7d1cc2b1":"code","7e6145d4":"code","465e04d6":"code","89f0cffc":"code","311524ee":"markdown"},"source":{"e81773be":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom wordcloud import WordCloud\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.feature_extraction.text import CountVectorizer, TfidfVectorizer\nfrom sklearn.naive_bayes import MultinomialNB\nfrom sklearn.metrics import f1_score\n\nimport warnings\nwarnings.simplefilter(action='ignore', category=FutureWarning)","4e2a43b5":"df = pd.read_csv('..\/input\/nlp-getting-started\/train.csv')\ndf.head()","622d1418":"df.info()","4a2a1fcd":"df.isnull().mean()","ccd190d3":"len(df.location.unique())","e498c0ce":"len(df.keyword.unique())","a0b22f53":"my_dict = dict(df.keyword.dropna().str.replace('%20', ' ').value_counts())","8b4029a5":"my_cloud = WordCloud(background_color='white', width=800, height=400).generate_from_frequencies(my_dict)\nplt.figure(figsize=(20,10))\nplt.imshow(my_cloud, interpolation='bilinear')","e5249878":"vectorizer = CountVectorizer(stop_words='english', max_df=0.8,\n                                   token_pattern=r'\\b[a-zA-Z][a-zA-Z]+\\b')\n\ndef pipeline(X_train, X_test):\n    vect_train = vectorizer.fit_transform(X_train.text.values)\n    vect_test = vectorizer.transform(X_test.text.values)\n    return (vect_train, vect_test)","202acee1":"X = df\ny = df.target\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=0)","7d1cc2b1":"X_train, X_test = pipeline(X_train, X_test)\nnb_classifier = MultinomialNB()\nnb_classifier.fit(X_train, y_train)\npred = nb_classifier.predict(X_test)\nf1_score(y_test, pred)","7e6145d4":"words = vectorizer.get_feature_names()\ncounts = X_train.sum(axis=0).tolist()[0]","465e04d6":"my_dict = dict(zip(words, counts))\nmy_cloud = WordCloud(background_color='white', width=800, height=400).generate_from_frequencies(my_dict)\nplt.figure(figsize=(20,10))\nplt.imshow(my_cloud, interpolation='bilinear')","89f0cffc":"X_test = pd.read_csv('..\/input\/nlp-getting-started\/test.csv')\n\nX_train, X_test = pipeline(X, X_test)\nnb_classifier.fit(X_train, y)\npred = nb_classifier.predict(X_test)\n\nsubmission = pd.read_csv('..\/input\/nlp-getting-started\/sample_submission.csv')\nsubmission['target'] = pred\nsubmission.to_csv('my_submission.csv', index=False)","311524ee":"# Submission File Generation\n"}}