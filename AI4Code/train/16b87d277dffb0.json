{"cell_type":{"a9811b03":"code","176768b0":"code","56b9ec8c":"code","a4f76a63":"code","9213b6d1":"code","01e7acb3":"code","89bde70d":"code","07322bd2":"code","152591ea":"code","9ce37a3c":"code","b45068ea":"code","8576d3f7":"code","a3aca5ef":"code","ba85a2ce":"code","f48fe537":"code","2e120416":"code","d2731e97":"code","829814e4":"code","791c6cf4":"code","83b02d31":"code","43370afd":"code","73ba4ce5":"code","29c31285":"code","d7739f9e":"code","a28cdb79":"code","b7c18b7e":"code","32b8b680":"code","a4a07df1":"code","2f53d69e":"code","09643154":"markdown","d783fbd1":"markdown","61ba2684":"markdown","00fa92ad":"markdown","68b6a55e":"markdown","ea8d68b5":"markdown","7cc66014":"markdown","9e732627":"markdown","e104cbc7":"markdown","d68061aa":"markdown","12cab25d":"markdown","ff2394ea":"markdown","aa01cf94":"markdown","db8291cf":"markdown","a9fccf53":"markdown","91488a93":"markdown","65146053":"markdown","17eb2319":"markdown","3dff2a74":"markdown","b4426397":"markdown","015215e5":"markdown","416bfb37":"markdown","7e40e03f":"markdown","ea54ac5e":"markdown","343efde8":"markdown","a6cfa83b":"markdown","a220d099":"markdown","699113c6":"markdown"},"source":{"a9811b03":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set()\nfrom pandas.plotting import parallel_coordinates\nfrom sklearn.tree import DecisionTreeClassifier, plot_tree\nfrom sklearn import metrics\nfrom sklearn.naive_bayes import GaussianNB\nfrom sklearn.discriminant_analysis import LinearDiscriminantAnalysis, QuadraticDiscriminantAnalysis\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.svm import SVC\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.metrics import confusion_matrix","176768b0":"dataset = pd.read_csv('..\/input\/iris-flower-dataset\/IRIS.csv')","56b9ec8c":"dataset.head(10)","a4f76a63":"dataset.info()","9213b6d1":"dataset.shape","01e7acb3":"dataset.describe()","89bde70d":"dataset.isnull().sum()","07322bd2":"dataset.species.value_counts().plot(kind=\"bar\",color='green')","152591ea":"#sns.pairplot(dataset)\nsns.pairplot(dataset, hue=\"species\", height = 2, palette = 'colorblind');","9ce37a3c":"plt.figure(figsize=(10,11))\nsns.heatmap(dataset.corr(),annot=True)\nplt.plot()","b45068ea":"sns.FacetGrid(dataset,hue=\"species\").map(plt.scatter,\"sepal_length\",\"sepal_width\").add_legend()\nplt.show()","8576d3f7":"sns.FacetGrid(dataset,hue=\"species\").map(plt.scatter,\"petal_length\",\"petal_width\").add_legend()\nplt.show()","a3aca5ef":"from pandas_profiling import ProfileReport","ba85a2ce":"design_report = ProfileReport(dataset)\ndesign_report.to_file(output_file='report.html')","f48fe537":"parallel_coordinates(dataset, \"species\", color = ['blue', 'red', 'green']);","2e120416":"list(dataset.columns)","d2731e97":"X = dataset.drop('species',axis=1)","829814e4":"y = dataset.species","791c6cf4":"from sklearn.model_selection import train_test_split\n","83b02d31":"X_train, X_test, y_train, y_test = train_test_split(X,y,test_size=0.25,stratify=y,random_state=42)","43370afd":"print(X_train.shape)\nprint(y_train.shape)\nprint(X_test.shape)\nprint(y_test.shape)","73ba4ce5":"y_test.value_counts()","29c31285":"y_train.value_counts()","d7739f9e":"classifier_dt = DecisionTreeClassifier(max_depth = 3, random_state = 1)\nclassifier_dt.fit(X_train,y_train)\nprediction=classifier_dt.predict(X_test)\nprint(\"Accuracy Score : \" , accuracy_score(prediction,y_test))","a28cdb79":"classifier_dt.feature_importances_","b7c18b7e":"fn = [\"sepal_length\", \"sepal_width\", \"petal_length\", \"petal_width\"]\ncn = ['setosa', 'versicolor', 'virginica']","32b8b680":"plt.figure(figsize = (10,8))\nplot_tree(classifier_dt, feature_names = fn, class_names = cn, filled = True);","a4a07df1":"conf_mat = metrics.plot_confusion_matrix(classifier_dt, X_test, y_test,\n                                 display_labels=cn,\n                                 cmap=plt.cm.Blues,\n                                 normalize=None)\nconf_mat.ax_.set_title('Decision Tree Confusion matrix, without normalization');","2f53d69e":"confusion = confusion_matrix(y_test, prediction)\nprint('Confusion Matrix\\n')\nprint(confusion)\n\n#importing accuracy_score, precision_score, recall_score, f1_score\nfrom sklearn.metrics import accuracy_score, precision_score, recall_score, f1_score\nprint('\\nAccuracy: {:.2f}\\n'.format(accuracy_score(y_test, prediction)))\n\n\n\nfrom sklearn.metrics import classification_report\nprint('\\nClassification Report\\n')\nprint(classification_report(y_test, prediction, target_names=['Class 1', 'Class 2', 'Class 3']))\n","09643154":"From the output and based on the indices of the four features, we know that the first two features (sepal measurements) are of no importance, and only the petal ones are used to build this tree.","d783fbd1":"### Decision Tree","61ba2684":"# Iris Flower Dataset","00fa92ad":"### Pandas Profiling","68b6a55e":"#### Import libraries","ea8d68b5":"As we have seen before, petal measurements can separate species better than the sepal ones.","7cc66014":"Let\u2019s see how our data is distributed based on Sepal Length and Width features using scatterplot.","9e732627":"There are different types of plots like bar plot, box plot, scatter plot etc.\nScatter plot is very useful when we are analyzing the relation ship between 2 features on x and y axis.\nIn seaborn library we have pairplot function which is very useful to scatter plot all the features at once instead of plotting them individually.","e104cbc7":"Let's analyse quickly our target ","d68061aa":"Similarly scatter plot of data based on Petal Length and Width features\n","12cab25d":"### Another way to show the prediction results is through a confusion matrix:","ff2394ea":"### Build Classifiers","aa01cf94":"Let's check if we have any missing values ? ","db8291cf":"### EDA","a9fccf53":"Thanks to classification report we can see precision,recal and f1 of each class.","91488a93":"### Context\n\nThe Iris flower data set is a multivariate data set introduced by the British statistician and biologist Ronald Fisher in his 1936 paper The use of multiple measurements in taxonomic problems. It is sometimes called Anderson's Iris data set because Edgar Anderson collected the data to quantify the morphologic variation of Iris flowers of three related species. The data set consists of 50 samples from each of three species of Iris (Iris Setosa, Iris virginica, and Iris versicolor). Four features were measured from each sample: the length and the width of the sepals and petals, in centimeters.","65146053":"Now, we can split the dataset into a training set and a test set. Usually, we should also have a validation set, which is used to evaluate the performance of each classifier, fine-tune, and determine the best model. The test set is mainly used for reporting. However, due to the small size of this dataset, we can simplify it by using the test set to serve the purpose of the validation set.","17eb2319":"Another cool visualization tool is parallel coordinate plot, which represents each row as a line.","3dff2a74":"- Precision: It tells you what fraction of predictions as a positive class were actually positive. To calculate precision, use the following formula: TP\/(TP+FP).\n- Recall: It tells you what fraction of all positive samples were correctly predicted as positive by the classifier. It is also known as True Positive Rate (TPR), Sensitivity, Probability of Detection. To calculate Recall, use the following formula: TP\/(TP+FN).\n- F1-score: It combines precision and recall into a single measure. Mathematically it\u2019s the harmonic mean of precision and recall. ","b4426397":"Note that some variables seem to be highly correlated, e.g. petal_length and petal_width. In addition, the petal measurements separate the different species better than the sepal ones.","015215e5":"We can use feature_importances to understand the importance of each predictor. ","416bfb37":"## Train-Test Split\n","7e40e03f":"We have now a better overview of our dataset. \nLet's conclude this EDA with my favorite automatic EDA libraries --- Pandas Profiling","ea54ac5e":"We have 50 species in each categories","343efde8":"### Import dataset","a6cfa83b":"Now we will see how these features are correlated to each other using heatmap in seaborn library. We can see that Sepal Length and Sepal Width features are slightly correlated with each other.","a220d099":"This decision tree predicts 89.4% of the test data correctly.","699113c6":"*We can also visiualize the classification rules*"}}