{"cell_type":{"d9b79cca":"code","0fe44e52":"code","e12dd89b":"code","a65d9c3a":"code","1f457f8c":"code","7f5eb2de":"code","3273088e":"code","821f3e04":"code","f49e063b":"code","f7d63ed3":"code","420437c8":"code","fda4e614":"code","b66e8851":"code","1ec56bdb":"code","33aa8209":"code","35513620":"code","e2acb464":"code","80e41d32":"markdown","ecfa273f":"markdown","d041e93c":"markdown","67f70731":"markdown","f7019390":"markdown","0e9eda97":"markdown","bfb08304":"markdown","e0fd39de":"markdown","82d76c91":"markdown","9f06415f":"markdown","c7d6e174":"markdown","7f85a0c0":"markdown","eb68a18a":"markdown"},"source":{"d9b79cca":"#Importando pacotes\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\nimport sklearn\n\nfrom sklearn import preprocessing\nfrom sklearn.metrics import confusion_matrix, classification_report, roc_curve, auc\n\nfrom sklearn.preprocessing import StandardScaler, LabelEncoder\nfrom sklearn.preprocessing import Imputer , Normalizer , scale\n\nfrom sklearn import tree\n\nfrom sklearn.tree import DecisionTreeClassifier\n\nfrom sklearn.linear_model import LogisticRegression,Perceptron,SGDClassifier\n\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.naive_bayes import GaussianNB\nfrom sklearn.svm import SVC, LinearSVC\nfrom sklearn.ensemble import RandomForestClassifier , GradientBoostingClassifier\nfrom sklearn.linear_model.stochastic_gradient import SGDClassifier\nfrom sklearn.ensemble import RandomForestClassifier\n\nfrom sklearn.model_selection import train_test_split , KFold, StratifiedKFold, GridSearchCV, cross_val_score\n\n%matplotlib inline \n\nprint (sklearn.__version__)","0fe44e52":"prefixo_arquivos = '..\/input\/serpro-wine\/'\n#Carga dos dados\nwine = pd.read_csv(prefixo_arquivos + 'wine-train.csv')\nwine_test = pd.read_csv(prefixo_arquivos + 'wine-test.csv')","e12dd89b":"wine_test.shape","a65d9c3a":"wine.head()","1f457f8c":"wine['quality'] = wine['quality'].map({'good': 1, 'bad': 0})","7f5eb2de":"wine['quality'].value_counts()","3273088e":"fig, ax = plt.subplots(1,11, figsize=(15,6))\nfig.subplots_adjust(wspace=1.5)\n\nsns.barplot(x = 'quality', y = 'fixed_acidity', data = wine,  ax=ax[0])\nsns.barplot(x = 'quality', y = 'volatile_acidity', data = wine,  ax=ax[1])\nsns.barplot(x = 'quality', y = 'citric_acid', data = wine,  ax=ax[2])\nsns.barplot(x = 'quality', y = 'residual_sugar', data = wine,  ax=ax[3])\nsns.barplot(x = 'quality', y = 'chlorides', data = wine,  ax=ax[4])\nsns.barplot(x = 'quality', y = 'free_sulfur_dioxide', data = wine,  ax=ax[5])\nsns.barplot(x = 'quality', y = 'total_sulfur_dioxide', data = wine,  ax=ax[6])\nsns.barplot(x = 'quality', y = 'density', data = wine,  ax=ax[7])\nsns.barplot(x = 'quality', y = 'ph', data = wine,  ax=ax[8])\nsns.barplot(x = 'quality', y = 'sulphates', data = wine,  ax=ax[9])\nsns.barplot(x = 'quality', y = 'alcohol', data = wine,  ax=ax[10])\n\n#fig.show()\n","821f3e04":"wine['quality'].value_counts()","f49e063b":"# Retirando identificador do vinho e qualidade do conjunto\nX = wine.drop(['quality','wine'], axis = 1)\ny = wine['quality']\nwine_test_red = wine_test.drop('wine', axis = 1)","f7d63ed3":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.3, random_state = 42)","420437c8":"# Aplicando Standard scaling para otimizar algoritmos\nsc = StandardScaler()","fda4e614":"X_train = sc.fit_transform(X_train)\nX_test = sc.fit_transform(X_test)","b66e8851":"X_train","1ec56bdb":"model = RandomForestClassifier(n_estimators=100)\nmodel.fit(X_train, y_train)\npredicted = model.predict(X_test)\nreport = classification_report(y_test, predicted)\nprint(report)","33aa8209":"model = RandomForestClassifier(n_estimators=100)\nmodel.fit(X, y)\ny_pred = model.predict( wine_test_red )\ny_pred.shape","35513620":"wine_id = wine_test.wine\nsubmissiondf = pd.DataFrame( { 'wine': wine_id , 'quality': y_pred } )\nsubmissiondf['quality'] = submissiondf['quality'].map({1: 'good', 0: 'bad'})\n\nprint(submissiondf.shape)\nprint(submissiondf.head())","e2acb464":"submissiondf.to_csv( 'RG_wine_RF100.csv' , index = False )\n#Random Forest 100 estimators","80e41d32":"### Gerando o modelo usando o conjunto de completo de treino","ecfa273f":"### Preparando o dataframe de submiss\u00e3o","d041e93c":"### Selecionando um modelo escolhido e gerando um relat\u00f3rio da classifica\u00e7\u00e3o","67f70731":"## SERPRO - WINE\n\n### Descri\u00e7\u00e3o da competi\u00e7\u00e3o \n\nO Vinho Verde, produzido na Regi\u00e3o Demarcada dos Vinhos Verdes, em Portugal, constitui uma denomina\u00e7\u00e3o de origem controlada. Por mais que soe estranho, um Vinho Verde n\u00e3o \u00e9 verde. Ali\u00e1s, pode ser tinto, branco ou ros\u00e9. E pode, inclusive, ser espumante. O Vinho Verde \u00e9 \u00fanico no mundo. Naturalmente leve e fresco, produzido no territ\u00f3rio do Entre os rios Douro e Minho, no noroeste de Portugal, numa regi\u00e3o costeira geograficamente bem localizada para a produ\u00e7\u00e3o de excelentes vinhos.\n\nNeste estudo, voc\u00ea descobrir\u00e1 quais s\u00e3o os componentes qu\u00edmicos mais importantes para se criar um Vinho Verde de boa qualidade. Ser\u00e3o consideradas amostras especificamente de vinhos brancos. Ao aplicar ferramentas de aprendizado de m\u00e1quina, voc\u00ea descobrir\u00e1 quais s\u00e3o os componentes e em quais propor\u00e7\u00f5es necess\u00e1rios para produzir um vinho de qualidade.\nSobre o conjunto de dados\n\nO conjunto de dados em quest\u00e3o foi produzido a partir da base Wine Quality Data Set, de Paulo Cortez (Universidade do Minho, Portugal), referindo-se exclusivamente \u00e0 variante branca do Vinho Verde portugu\u00eas.\n\nDevido a quest\u00f5es de privacidade e log\u00edstica, apenas vari\u00e1veis f\u00edsico-qu\u00edmicas e sensoriais est\u00e3o dispon\u00edveis nos dados. Por exemplo, n\u00e3o h\u00e1 dados sobre tipos de uvas, marca do vinho, pre\u00e7o de venda, etc.\n\nRefer\u00eancias:\n\n    P\u00e1gina oficial do Vinho Verde: http:\/\/www.vinhoverde.pt\/\n    Paulo Cortez, University of Minho, Guimar\u00e3es, Portugal, http:\/\/www3.dsi.uminho.pt\/pcortez\n    A. Cerdeira, F. Almeida, T. Matos and J. Reis, Viticulture Commission of the Vinho Verde Region (CVRVV), Porto, Portugal, 2009\n\n### Dados\n\nOs dados foram divididos em dois grupos:\n\n    conjunto de treinamento (wine-train.csv)\n    conjunto de testes (wine-test.csv)\n\nO conjunto de treinamento deve ser usado para construir seus modelos de aprendizado de m\u00e1quina. Para o conjunto de treinamento, fornecemos o resultado (tamb\u00e9m conhecido como a \u201cverdade fundamental\u201d) para cada observa\u00e7\u00e3o (neste caso, a qualidade do vinho - campo quality). Seu modelo preditivo ser\u00e1 baseado nos atributos ou features (neste caso, as caracter\u00edsticas f\u00edsico-qu\u00edmicas de cada vinho).\n\nO conjunto de testes deve ser usado para medir o desempenho do seu modelo em dados desconhecidos. Para o conjunto de testes, n\u00e3o fornecemos a verdade b\u00e1sica para cada observa\u00e7\u00e3o (neste caso, a qualidade do vinho). \u00c9 seu trabalho predizer esses resultados. Para cada observa\u00e7\u00e3o do teste, use o modelo que voc\u00ea treinou para prever quais vinhos s\u00e3o de boa qualidade e quais n\u00e3o s\u00e3o.\n\nTamb\u00e9m inclu\u00edmos o arquivo wine-example.csv, um conjunto de previs\u00f5es fict\u00edcio (com resultados aleat\u00f3rios), como um exemplo de como deve ser um arquivo de envio (submiss\u00e3o) a ser automaticamente avaliado. Esse arquivo possui apenas dois campos: wine (identifica\u00e7\u00e3o do vinho) e quality (a qualidade prevista para o vinho).\nColunas dispon\u00edveis\n\nAs colunas neste conjunto de dados s\u00e3o:\n\n- wine: identifica\u00e7\u00e3o \u00fanica do vinho no conjunto de dados\n- fixed_acidity: acidez fixa - a maioria dos \u00e1cidos envolvidos no vinho fixos ou n\u00e3o vol\u00e1teis (que n\u00e3o evaporam rapidamente)\n- volatile_acidity: acidez vol\u00e1til - a quantidade de \u00e1cido ac\u00e9tico no vinho, que a n\u00edveis demasiado elevados pode levar a um sabor desagrad\u00e1vel de vinagre\n- citric_acid: \u00e1cido c\u00edtrico - encontrado em pequenas quantidades, o \u00e1cido c\u00edtrico pode adicionar frescura e sabor aos vinhos\n- residual_sugar: a\u00e7\u00facar residual - a quantidade de a\u00e7\u00facar restante ap\u00f3s o fim da fermenta\u00e7\u00e3o, sendo raro encontrar vinhos com menos de 1 g\/L, e vinhos com mais de 45 g\/L s\u00e3o considerados doces\n- chlorides: cloretos - a quantidade de sal no vinho\n- free_sulfur_dioxide: di\u00f3xido de enxofre livre - a forma livre de SO2 existe em equil\u00edbrio entre o SO2 molecular (como um g\u00e1s dissolvido) e o \u00edon bissulfito, impedindo o crescimento microbiano e a oxida\u00e7\u00e3o do vinho\n- total_sulfur_dioxide: di\u00f3xido de enxofre total - quantidade de formas livres e ligadas de SO2, sendo que em baixas concentra\u00e7\u00f5es, o SO2 \u00e9 normalmente indetect\u00e1vel no vinho, mas em concentra\u00e7\u00f5es livres de SO2 acima de 50 ppm, o SO2 se torna evidente no nariz e no sabor do vinho\n- density: densidade - a densidade do vinho \u00e9 pr\u00f3xima da \u00e1gua, dependendo do percentual de \u00e1lcool e a\u00e7\u00facar\n- ph: pH - descreve qu\u00e3o \u00e1cido ou b\u00e1sico \u00e9 o vinho numa escala de 0 (muito \u00e1cido) a 14 (muito b\u00e1sico), sendo que a maioria dos vinhos est\u00e1 entre 3 e 4 na escala de pH\n- sulphates: sulfatos - aditivo para vinho que pode contribuir para os n\u00edveis de g\u00e1s di\u00f3xido de enxofre (SO2), atuando como antimicrobiano e antioxidante\n- alcohol: \u00e1lcool - o percentual de \u00e1lcool no vinho\n\n- quality: qualidade - podendo ser boa (good) ou ruim (bad)\n\n","f7019390":"### Transformando o valor da qualidade para num\u00e9rico","0e9eda97":"### Dividindo os dados de treino para obten\u00e7\u00e3o dos conjuntos de treino e teste","bfb08304":"### Verificando a distribui\u00e7\u00e3o dos dados","e0fd39de":"### Propor\u00e7\u00e3o da qualidade dos vinhos","82d76c91":"### Separando features e resposta","9f06415f":"### Gerando arquivo de submiss\u00e3o","c7d6e174":"### Correla\u00e7\u00e3o de cada propriedade individual com a qualidade","7f85a0c0":"### Padroniza\u00e7\u00e3o de valores","eb68a18a":"### Carregamento dos conjuntos de treino e teste"}}