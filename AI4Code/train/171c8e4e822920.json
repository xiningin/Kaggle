{"cell_type":{"723fd9bc":"code","414b8c32":"code","3da242d2":"code","01ce5f6a":"code","b20884cf":"code","b2656407":"code","0e4c900a":"code","30d64555":"code","754ad961":"code","b5baeaa2":"code","89dc4966":"code","beca9ddb":"code","2b7b0731":"code","581ce4ec":"code","7b8e8545":"code","fed6ca88":"code","e6f1602d":"code","36051c73":"code","a1af8a0b":"code","717a7c25":"code","b15703de":"code","ffbe2fd4":"code","ed36c49d":"code","11d6fc30":"code","64cf9309":"code","b1830461":"code","6576248f":"code","01d4f209":"code","88557ea8":"markdown","80d16a0e":"markdown"},"source":{"723fd9bc":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\npd.set_option('display.max_rows', 10000)\npd.set_option('display.max_columns', 1000)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory","414b8c32":"import glob\nimport os\nfiles = glob.glob('\/kaggle\/input\/us-executive-branch-finances\/Pompeo Michael R*.xlsx')\nfor file in files:\n    print(file)\n    print(os.path.splitext(file)[0].split('_')[-1])","3da242d2":"result = dict()","01ce5f6a":"def get_min_max(ser):\n    nan_cond = ser.isnull()\n    nans = ser[nan_cond]\n    nans['min_val'] = np.nan\n    nans['max_val'] = np.nan\n    not_nans = ser[~nan_cond]\n    cond = not_nans.str.contains('-')\n    hyphens = not_nans[cond]\n    non_hyphens = not_nans[~cond]\n    hdf = hyphens.str.split('-', expand=True)\n    for i in range(len(hdf.columns)):\n        hdf[i] = hdf[i].str.strip()\n        hdf[i] = hdf[i].str.replace('$', '')\n        hdf[i] = hdf[i].str.replace(',', '')\n        hdf[i] = pd.to_numeric(hdf[i])\n    if len(hdf.columns) == 2:\n        hdf.columns = ['min_val', 'max_val']\n    nhdf = non_hyphens.str.extract(r'None.*\\$([\\d,]+).*')\n    nhdf[0] = nhdf[0].str.strip()\n    nhdf[0] = nhdf[0].str.replace('$', '')\n    nhdf[0] = nhdf[0].str.replace(',', '')\n    nhdf[0] = pd.to_numeric(nhdf[0])\n    nhdf.columns = ['max_val']\n    nhdf['min_val'] = 0\n    return nans[['min_val', 'max_val']].append(hdf[['min_val', 'max_val']].append(nhdf[['min_val', 'max_val']]))","b20884cf":"xl = pd.ExcelFile('\/kaggle\/input\/us-executive-branch-finances\/Pompeo Michael R_Secretary_Department of State_Annual (2019)_06.14.2019.xlsx')\ndf = xl.parse('Table 1', header=None)\ndf","b2656407":"employment_assets = df.loc[10:11][[1, 2, 5, 6, 7]].reset_index(drop=True)\nemployment_assets.columns = employment_assets.loc[0].values\nemployment_assets = employment_assets.loc[1:].dropna(axis=0, how='all')\nlast_part = df.loc[12][0]\nemployment_assets.loc[1, 'INCOME AMOUNT'] += \" \" + last_part\n#employment_assets\n\nea_val = get_min_max(employment_assets['VALUE'])\nea = employment_assets.join(ea_val)\nea","0e4c900a":"spouse_assets = df.loc[17:31].append(df.loc[36:42])[[1, 2, 5, 6, 7]].reset_index(drop=True)\nspouse_assets.columns = spouse_assets.loc[0].values\nspouse_assets = spouse_assets.loc[1:].dropna(axis=0, how='all')\n#last_part = df.loc[38][0]\n#spouse_assets.loc[6, 'VALUE'] += \" \" + last_part\n#spouse_assets.loc[12, 'VALUE'] += \" \" + last_part\n#last_part = str(df.loc[36][0])\n#spouse_assets.loc[3, 'VALUE'] += \" \" + last_part\n#spouse_assets.loc[4, 'VALUE'] += \" \" + last_part\n#spouse_assets.loc[15, 'VALUE'] += \" \" + last_part\n#spouse_assets\n\nsa_val = get_min_max(spouse_assets['VALUE'])\nsa = spouse_assets.join(sa_val)\nsa","30d64555":"other_assets = df.loc[45:47][[1, 2, 5, 6, 7]].reset_index(drop=True)\nother_assets.columns = other_assets.loc[0].values\nother_assets = other_assets.loc[1:].dropna(axis=0, how='all')\n#last_part = df.loc[18][0]\n#spouse_assets.loc[2, 'VALUE'] += \" \" + last_part\n#spouse_assets.loc[4, 'VALUE'] = spouse_assets.loc[3, 'VALUE']\n#spouse_assets.loc[15, 'VALUE'] = spouse_assets.loc[3, 'VALUE']\n#other_assets\n\noa_val = get_min_max(other_assets['VALUE'])\noa = other_assets.join(oa_val)\noa","754ad961":"assets = pd.concat([ea, sa, oa])\nassets","b5baeaa2":"total = assets[['min_val', 'max_val']].sum()\nprint(\"Total Asset value :\")\nasset_value = (total['max_val']-total['min_val'])\/2\nasset_value","89dc4966":"result['6\/14\/2019'] = asset_value","beca9ddb":"xl = pd.ExcelFile('\/kaggle\/input\/us-executive-branch-finances\/Pompeo Michael R_Director_Central Intelligence Agency_Nominee 278 (12.23.2016)_12.23.2016.xlsx')\nxl.sheet_names\ndf = xl.parse('Table 1', header=None)\ndf","2b7b0731":"employment_assets = df.loc[9:11][[1, 2, 4, 5, 6]].reset_index(drop=True)\nemployment_assets.columns = employment_assets.loc[0].values\nemployment_assets = employment_assets.loc[1:].dropna(axis=0, how='all')\nlast_part = df.loc[11][0]\nemployment_assets.loc[1, 'INCOME AMOUNT'] += \" \" + last_part\nea_val = get_min_max(employment_assets['VALUE'])\nea = employment_assets.join(ea_val)\nea","581ce4ec":"spouse_assets = df.loc[15:17].append(df.loc[22:39])[[1, 2, 4, 5, 6]].reset_index(drop=True)\nspouse_assets.columns = spouse_assets.loc[0].values\nspouse_assets = spouse_assets.loc[1:].dropna(axis=0, how='all')\nlast_part = df.loc[18][0]\nspouse_assets.loc[2, 'VALUE'] += \" \" + last_part\nspouse_assets.loc[4, 'VALUE'] = spouse_assets.loc[3, 'VALUE']\nspouse_assets.loc[15, 'VALUE'] = spouse_assets.loc[3, 'VALUE']\n#spouse_assets\nsa_val = get_min_max(spouse_assets['VALUE'])\nsa = spouse_assets.join(sa_val)\nsa","7b8e8545":"other_assets = df.loc[41:42].append(df.loc[46:48])[[1, 2, 4, 5, 6]].reset_index(drop=True)\nother_assets.columns = other_assets.loc[0].values\nother_assets = other_assets.loc[1:].dropna(axis=0, how='all')\n#last_part = df.loc[18][0]\n#spouse_assets.loc[2, 'VALUE'] += \" \" + last_part\n#spouse_assets.loc[4, 'VALUE'] = spouse_assets.loc[3, 'VALUE']\n#spouse_assets.loc[15, 'VALUE'] = spouse_assets.loc[3, 'VALUE']\n#other_assets\n\noa_val = get_min_max(other_assets['VALUE'])\noa = other_assets.join(oa_val)\noa","fed6ca88":"assets = pd.concat([ea, sa, oa])\nassets","e6f1602d":"total = assets[['min_val', 'max_val']].sum()\nprint(\"Total Asset value :\")\nasset_value = (total['max_val']-total['min_val'])\/2\nasset_value","36051c73":"result['12\/23\/2016'] = asset_value","a1af8a0b":"xl = pd.ExcelFile('\/kaggle\/input\/us-executive-branch-finances\/Pompeo Michael R_Secretary_Department Of State_Nominee 278 (03.27.2018)_03.27.2018.xlsx')\ndf = xl.parse('Table 1', header=None)\ndf","717a7c25":"employment_assets = df.loc[11:13][[1, 2, 5, 6, 7]].reset_index(drop=True)\nemployment_assets.columns = employment_assets.loc[0].values\nemployment_assets = employment_assets.loc[1:].dropna(axis=0, how='all')\nlast_part = df.loc[13][0]\nemployment_assets.loc[1, 'INCOME AMOUNT'] += \" \" + last_part\n#employment_assets\n\nea_val = get_min_max(employment_assets['VALUE'])\nea = employment_assets.join(ea_val)\nea","b15703de":"spouse_assets = df.loc[18:35].append(df.loc[43:49])[[1, 2, 4, 5, 6]].reset_index(drop=True)\nspouse_assets.columns = spouse_assets.loc[0].values\nspouse_assets = spouse_assets.loc[1:].dropna(axis=0, how='all')\nlast_part = df.loc[38][0]\nspouse_assets.loc[6, 'VALUE'] += \" \" + last_part\nspouse_assets.loc[12, 'VALUE'] += \" \" + last_part\nlast_part = str(df.loc[36][0])\nspouse_assets.loc[3, 'VALUE'] += \" \" + last_part\nspouse_assets.loc[4, 'VALUE'] += \" \" + last_part\nspouse_assets.loc[15, 'VALUE'] += \" \" + last_part\n#spouse_assets\n\nsa_val = get_min_max(spouse_assets['VALUE'])\nsa = spouse_assets.join(sa_val)\nsa","ffbe2fd4":"other_assets = df.loc[52:56][[1, 2, 5, 6, 7]].reset_index(drop=True)\nother_assets.columns = other_assets.loc[0].values\nother_assets = other_assets.loc[1:].dropna(axis=0, how='all')\n#last_part = df.loc[18][0]\n#spouse_assets.loc[2, 'VALUE'] += \" \" + last_part\n#spouse_assets.loc[4, 'VALUE'] = spouse_assets.loc[3, 'VALUE']\n#spouse_assets.loc[15, 'VALUE'] = spouse_assets.loc[3, 'VALUE']\n#other_assets\n\noa_val = get_min_max(other_assets['VALUE'])\noa = other_assets.join(oa_val)\noa","ed36c49d":"assets = pd.concat([ea, sa, oa])\nassets","11d6fc30":"total = assets[['min_val', 'max_val']].sum()\nprint(\"Total Asset value :\")\nasset_value = (total['max_val']-total['min_val'])\/2\nasset_value","64cf9309":"result['3\/27\/2018'] = asset_value","b1830461":"result = {'dates': list(result.keys()), 'total_assets': list(result.values())}\nresult","6576248f":"total_assets = pd.DataFrame(result)\ntotal_assets['dates'] = pd.to_datetime(total_assets['dates'])\ntotal_assets = total_assets.set_index('dates')\ntotal_assets","01d4f209":"total_assets.plot()","88557ea8":"### Let's go through each file & extract total Asset values (across employment, spouse & other asset sources)","80d16a0e":"**Let's just look at say, Michael Pompeo's finances (for no real reason)**"}}