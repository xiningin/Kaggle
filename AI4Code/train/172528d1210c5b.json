{"cell_type":{"0c1aaa3c":"code","b4ed0c61":"code","7eec7025":"code","79459637":"code","95826aeb":"code","4f631966":"code","506d4fd6":"code","33fa73e4":"code","e5d14bdc":"code","e6f20cda":"code","28c642c9":"code","622ec1e1":"markdown","8a29c0bc":"markdown","8d93fd17":"markdown"},"source":{"0c1aaa3c":"import pandas as pd\nimport numpy as np\nimport h2o","b4ed0c61":"#Starting h2o\nh2o.init()","7eec7025":"#Read the training and test data\ntrain = pd.read_csv(\"..\/input\/tabular-playground-series-jan-2021\/train.csv\")\ntest = pd.read_csv(\"..\/input\/tabular-playground-series-jan-2021\/test.csv\")\n","79459637":"# convert pandas DataFrame into H2O Frame \nh2o_train = h2o.H2OFrame(train) \n# Describe  the train h20Frame \nh2o_train.describe() \n","95826aeb":"#set the x & y(target) to fit into the algorithm\nx = h2o_train.columns\ny = 'target'\nx.remove(y)","4f631966":"# import autoML from H2O \nfrom h2o.automl import H2OAutoML \n# callh20automl  function  \naml = H2OAutoML(\n    max_runtime_secs = 3000, \n    exclude_algos =['DeepLearning'], \n    seed = 42, \n    stopping_metric ='RMSE', \n    sort_metric ='RMSE', \n    # balance_classes = False,\n    max_models=60\n) \n# train model\naml.train(x = x, y = y, training_frame = h2o_train) \n","506d4fd6":"# # View the H2O aml leaderboard \nlb = aml.leaderboard \n# Print all rows instead of 10 rows \nlb.head(rows = lb.nrows)","33fa73e4":"#convert test  to h2o dataframe\nh2o_test = h2o.H2OFrame(test) ","e5d14bdc":"'''\n- h2o.as_list will convert the predictor as float64 object, from h2o dataframe\n- .values will get just the values from the object\n'''\npred = h2o.as_list(aml.leader.predict(h2o_test)).values","e6f20cda":"submissions = pd.read_csv(\"..\/input\/tabular-playground-series-jan-2021\/sample_submission.csv\")\nsubmissions.target = pred\nsubmissions.to_csv(\"submission.csv\",index=False)","28c642c9":"!kaggle competitions submit -c tabular-playground-series-jan-2021 -f submission.csv -m \"Message\"","622ec1e1":"# Running the H2OAutoML\n## REMEMBER THE PROCESS MAY TAKE >5 MINUTES","8a29c0bc":"# H2O ML Using Python ","8d93fd17":"#### The process may take long, just grab a coffe and wait till the process ends"}}