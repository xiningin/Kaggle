{"cell_type":{"e2c2620e":"code","67d1e757":"code","1836bd4a":"code","86ce6238":"code","a4161ec1":"code","3d8b16db":"code","f8b08ade":"code","f743f26b":"code","90d7068d":"code","58d6223b":"code","78341d37":"code","212ab4ea":"code","fbd814af":"code","a90460be":"code","d7e6cf0c":"code","835875f4":"code","15b2a76b":"code","6edf4177":"code","e8064282":"markdown","517def0b":"markdown","b845ce23":"markdown","92d1659b":"markdown","b76ec983":"markdown","2349d737":"markdown","01434e30":"markdown","f7338baf":"markdown","a52684a5":"markdown","816d6103":"markdown","1f086528":"markdown","3f6d1bdd":"markdown","c6dc901c":"markdown","6041a40b":"markdown","37d6c490":"markdown"},"source":{"e2c2620e":"import pandas as pd\nimport numpy as np\n\nimport matplotlib.pyplot as plt\nfrom matplotlib_venn import venn3, venn3_circles\nimport matplotlib\n#matplotlib.rc['font.size'] = 9.0\nmatplotlib.rc('font', size=20)\nmatplotlib.rc('axes', titlesize=20)\nmatplotlib.rc('axes', labelsize=20)\nmatplotlib.rc('xtick', labelsize=20)\nmatplotlib.rc('ytick', labelsize=20)\nmatplotlib.rc('legend', fontsize=20)\nmatplotlib.rc('figure', titlesize=20)\nimport seaborn as sns\n\n%matplotlib inline","67d1e757":"data = pd.read_csv(\"..\/input\/citywide-payroll-data-fiscal-year.csv\")\ndata.sample(10)","1836bd4a":"data = data.drop(['Last Name','First Name'], axis=1)\ndata['Total Pay'] = data['Regular Gross Paid'] + data['Total OT Paid']","86ce6238":"data['Fiscal Year'] = data['Fiscal Year'].astype(str)\nplt.figure(figsize=(8,5))\ng = sns.FacetGrid(data, hue='Fiscal Year', size=10, hue_order=['2014',\n                                                              '2015',\n                                                              '2016','2017'], palette=\"Paired\")\ng.map(sns.kdeplot, \"Total Pay\", shade=True)\ng.set_xticklabels(rotation=45)\ng.add_legend()\nplt.show()","a4161ec1":"data['Pay Basis'].unique()","3d8b16db":"data_per_annum = data[data['Pay Basis'].isin([' per Annum',\n                                           ' Prorated Annual',\n                                           'per Annum','Prorated Annual'])].drop('Pay Basis',\n                                                                                axis=1)\ndata_per_hour = data[data['Pay Basis'].isin([' per Hour',\n                                           'per Hour'])].drop('Pay Basis', axis=1)\ndata_per_day = data[data['Pay Basis'].isin([' per Day',\n                                           'per Day'])].drop('Pay Basis', axis=1)\n\nprint (\"Per Annum Basis --> \",data_per_annum.shape,\n       \"\\nPer Day Basis -- >\", data_per_day.shape,\n       \"\\nPer Hour Basis -- >\", data_per_hour.shape)","f8b08ade":"dist_pay_type = [data_per_annum.shape[0], data_per_day.shape[0], data_per_hour.shape[0]]\nplt.figure(figsize=(7,7))\nplt.pie(dist_pay_type, labels=['Per Annum','Per Day','Per Hour'],\n                  autopct='%1.1f%%', shadow=True, startangle=90,\n             colors=['#66b3ff','#ff9999','#99ff99'])\nplt.title(\"Pay Type Basis in the city of New York\")\nplt.show()","f743f26b":"def plot_high_low_pay(col, count, pay_basis):\n    \n    if (pay_basis=='Annum'):\n        highest_paying_annum = data_per_annum.groupby(str(col))['Total Pay'].mean().reset_index().sort_values('Total Pay', ascending=False).head(count)\n        lowest_paying_annum = data_per_annum.groupby(str(col))['Total Pay'].mean().reset_index().sort_values('Total Pay', ascending=True).head(count)\n\n        f, ax = plt.subplots(2,1,figsize=(20,25))\n        ax1 = sns.barplot(x='Total Pay', y=str(col), data=highest_paying_annum, \n                      orient='h', ax=ax[0])\n        ax1 = sns.barplot(x='Total Pay', y=str(col), data=lowest_paying_annum, \n                      orient='h', ax=ax[1])\n        ax[0].set_xlabel(\"Average Total Pay\")\n        ax[1].set_xlabel(\"Average Total Pay\")\n        plt.show()\n    elif (pay_basis == 'Day'):\n        highest_paying_day = data_per_day.groupby(str(col))['Total Pay'].mean().reset_index().sort_values('Total Pay', ascending=False).head(count)\n        lowest_paying_day = data_per_day.groupby(str(col))['Total Pay'].mean().reset_index().sort_values('Total Pay', ascending=True).head(count)\n\n        f, ax = plt.subplots(2,1,figsize=(20, 25))\n        ax1 = sns.barplot(x='Total Pay', y=str(col), \n                          data=highest_paying_day, orient='h', ax=ax[0])\n        ax1 = sns.barplot(x='Total Pay', y=str(col), \n                          data=lowest_paying_day, orient='h', ax=ax[1])\n        ax[0].set_xlabel(\"Average Total Pay\")\n        ax[1].set_xlabel(\"Average Total Pay\")\n        plt.show()\n    elif (pay_basis=='Hour'):\n        highest_paying_hour = data_per_hour.groupby(str(col))['Total Pay'].mean().reset_index().sort_values('Total Pay', ascending=False).head(count)\n        lowest_paying_hour = data_per_hour.groupby(str(col))['Total Pay'].mean().reset_index().sort_values('Total Pay', ascending=True).head(count)\n\n        f, ax = plt.subplots(2,1,figsize=(20, 25))\n        ax1 = sns.barplot(x='Total Pay', y=str(col), \n                          data=highest_paying_hour, orient='h', ax=ax[0])\n        ax1 = sns.barplot(x='Total Pay', y=str(col), \n                          data=lowest_paying_hour, orient='h', ax=ax[1])\n        ax[0].set_xlabel(\"Average Total Pay\")\n        ax[1].set_xlabel(\"Average Total Pay\")\n        plt.show()","90d7068d":"plot_high_low_pay(col='Agency Name', count=10, pay_basis='Annum')","58d6223b":"plot_high_low_pay(col='Agency Name', count=10, pay_basis='Day')","78341d37":"plot_high_low_pay(col='Agency Name', count=10, pay_basis='Hour')","212ab4ea":"plot_high_low_pay(col='Title Description', count=20, pay_basis='Annum')","fbd814af":"plot_high_low_pay(col='Title Description', count=20, pay_basis='Day')","a90460be":"plot_high_low_pay(col='Title Description', count=20, pay_basis='Hour')","d7e6cf0c":"data['Work Location Borough'] = data['Work Location Borough'].str.strip().str.upper()\nlocation_pay = data.groupby('Work Location Borough')['Total Pay'].mean().reset_index().sort_values('Total Pay',ascending=False)","835875f4":"sns.set_style(\"whitegrid\")\nplt.figure(figsize=(20,7))\nsns.boxplot(x=data['Work Location Borough'], y=data['Total Pay'],\n           data=location_pay, palette=\"coolwarm_r\")\nplt.xticks(rotation=90)\nplt.show()","15b2a76b":"data['Agency Name'] = data['Agency Name'].str.strip().str.upper()\not_ = data.groupby('Agency Name')['OT Hours'].mean().reset_index().sort_values('OT Hours',ascending=False)\not_ = ot_.head(10)\not_pay = data.groupby('Agency Name')['Total OT Paid'].mean().reset_index().sort_values('Total OT Paid',ascending=False)\not_pay = ot_pay.head(10)","6edf4177":"#sns.set_style(\"whitegrid\")\nf, ax = plt.subplots(2,1, figsize=(20,13))\nsns.barplot(y=ot_['Agency Name'], x=ot_['OT Hours'],\n           data=ot_, palette=\"BuGn_r\", orient='h',ax=ax[0])\nsns.barplot(x=ot_pay['Agency Name'], y=ot_pay['Total OT Paid'],\n           data=ot_pay, palette=\"ocean_r\", ax=ax[1])\nax[0].set_xlabel(\"Average Over Time Hours\")\nax[1].set_ylabel(\"Average Over Time Salary\")\nplt.setp(ax[1].xaxis.get_majorticklabels(), rotation=90)\nplt.show()","e8064282":"<a id='loc_pay'><\/a>\n# Average pay by Location\n\n**`Work Location Borough`** tells us the area that a particular agency in NYC belongs to so it is interesting to know which one of these areas have the highest pay!","517def0b":"# Payroll Information\n\nFour (4) columns correspond to the actual $payroll information namely -\n1. Base Salary\n2. Regular Gross Pay (Base Salary + Allowances)\n3. Over Time Pay (Total OT Paid)","b845ce23":"#### By Day","92d1659b":"### That'd be all for now, I'll continue adding some more visuals as I explore this data. \n \n**Let me know what you guys think in the comments below or if you any suggestions on how this EDA can be further extended, feel free to describe it in the comments!!**","b76ec983":"<a id='years_distro'><\/a>\n# Starting things simple!\n\nLet's visualize how the **total pay** has fared over the **years** in the form of a distribution plot.","2349d737":"<a id='title_high_low'><\/a>\n# Jobs that pay the Most & Least money in NYC\n\n#### By Annum","01434e30":"#### By Hour","f7338baf":"#### Pay by Hour","a52684a5":"**Fire Dept & Dept of correction** occupy the top 2 spots in the highest number of average overtime hours.","816d6103":"<a id='pay_basis'><\/a>\n# Pay Basis\n\nSince there is a fair bit of difference in the payroll information based on the basis of pay - \n1. Pay by Annum (Annualy)\n2. Pay by the Day\n3. Pay by the Hour\n\nSo I thought it would be a good idea to segregate this data in order to analyse them differently since there is going to be a significant difference in the thier types of employers as well.","1f086528":"# Payroll Data for the City of New York\n\n<p align=\"center\">\n  <img src=\"https:\/\/cdn.vox-cdn.com\/thumbor\/HV3csUPr4CK3UWm_eTJA5pmwG-c=\/0x0:2200x1385\/1200x800\/filters:focal(924x517:1276x869)\/cdn.vox-cdn.com\/uploads\/chorus_image\/image\/49853921\/6sqft_skyline_2020.0.jpg\"\/>\n<\/p>\n\n## This is a dataset hosted by the City of New York. \n\n**Contents:**\n\n1. [Pay over the years - Distribution](#years_distro)\n2. [Basis of Pay - Anuual, Daily, Hourly](#pay_basis)\n3. [Highest & the Lowest Paying Agencies - Annually, Daily & Hourly](#agcy_high_low)\n4. [Highest & the Lowest Paying Job Titles - Annually, Daily & Hourly](#title_high_low)\n5. [Pay by Location](#loc_pay)\n6. [Overtime Compensation](#overtime)\n\nLet us deep dive into it by gathering some necessary library imports & take a sneak peak into the data!","3f6d1bdd":"<a id='overtime'><\/a>\n# Overtime Compensations\n\n1. Which agencies are making their employees work over time & by how much?\n2. What is the average OverTime pay in these agencies?","c6dc901c":"<a id='agcy_high_low'><\/a>\n# Highest & the Lowest Paying Agencies \n\n### Pay by Annum","6041a40b":"To keep things simple, I create another column `Total Pay` which is simply the sum of Over Time & Regular Pay.","37d6c490":"#### Pay by Day"}}