{"cell_type":{"032d955e":"code","1bcc313f":"code","b0c6b93a":"code","cf0619af":"code","7ba81869":"code","87be6365":"code","3d2a2ae0":"code","b1dfd284":"code","9a3a07a6":"code","948d21f7":"code","2b4a76e7":"code","d09b87e7":"code","93906251":"code","c6930ec7":"code","e6687aae":"code","b7510d40":"code","f4e3f9f4":"code","63f30c40":"code","cb92689f":"code","434106e1":"code","c24ff30f":"markdown","74225256":"markdown","9b204661":"markdown","c2b9cd72":"markdown","566817b0":"markdown","f963f6a5":"markdown","f482c69e":"markdown","f132a3f4":"markdown"},"source":{"032d955e":"import pandas as pd\nimport numpy as np\nimport matplotlib.pylab as plt\nimport plotly.express as px\nimport json","1bcc313f":"import plotly.io as pio\npio.renderers.default = 'notebook'","b0c6b93a":"df = pd.read_csv('..\/input\/canada-weather\/canada_weather.csv')","cf0619af":"canada_pro = json.load(open('..\/input\/canada-geojson\/canada.geojson','r'))","7ba81869":"df.info()","87be6365":"df.describe()","3d2a2ae0":"df.head()","b1dfd284":"mod_df = df.drop(['Weather station','Location'],axis=1)\nmod_df.rename(columns = {'Community':'Place','Elevation':'Elevation (m)'}, inplace = True)\ndef get_province(place):\n    return place.split(',')[1].lstrip()\nmod_df['Province']=mod_df['Place'].apply(lambda x:get_province(x))\n# ONLY M AND REMOVING FEET\ndef only_m(x):\n   return x.split('(')[0].split('m')[0].rstrip().replace(',','')\nmod_df['Elevation (m)'] =mod_df['Elevation (m)'].transform(lambda x: only_m(x))\nmod_df['Elevation (m)']=mod_df['Elevation (m)'].astype(float)\n\n# GETTING ONLY CELSIUS AND REMOVING F\ndef only_C(temp):\n    return float(temp.split('(')[0].strip().replace('\u2212','-'))\nmod_df['January(Avg. high \u00b0C (\u00b0F))']  = mod_df['January(Avg. high \u00b0C (\u00b0F))'].transform(lambda x: only_C(x))\nmod_df['January(Avg. low \u00b0C (\u00b0F))']  = mod_df['January(Avg. low \u00b0C (\u00b0F))'].transform(lambda x: only_C(x))\nmod_df['July(Avg. high \u00b0C (\u00b0F))']  = mod_df['July(Avg. high \u00b0C (\u00b0F))'].transform(lambda x: only_C(x))\nmod_df['July(Avg. low \u00b0C (\u00b0F))']  = mod_df['July(Avg. low \u00b0C (\u00b0F))'].transform(lambda x: only_C(x))\nmod_df['Annual(Avg. high \u00b0C (\u00b0F))']  = mod_df['Annual(Avg. high \u00b0C (\u00b0F))'].transform(lambda x: only_C(x))\nmod_df['Annual(Avg. low \u00b0C (\u00b0F))']  = mod_df['Annual(Avg. low \u00b0C (\u00b0F))'].transform(lambda x: only_C(x))","9a3a07a6":"column = {\n    'January(Avg. high \u00b0C (\u00b0F))':'January(Avg. high \u00b0C)',\n    'January(Avg. low \u00b0C (\u00b0F))': 'January(Avg. low \u00b0C)',\n    'July(Avg. high \u00b0C (\u00b0F))': 'July(Avg. high \u00b0C)',\n    'July(Avg. low \u00b0C (\u00b0F))':'July(Avg. low \u00b0C)',\n    'Annual(Avg. high \u00b0C (\u00b0F))': 'Annual(Avg. high \u00b0C)',\n    'Annual(Avg. low \u00b0C (\u00b0F))': 'Annual(Avg. low \u00b0C)'\n}\nmod_df.rename(columns = column, inplace = True)","948d21f7":"# TAKING AVERAGE OF BOTH HIGH AND LOW TEMP\nmod_df['January Avg. \u00b0C'] = mod_df[['January(Avg. high \u00b0C)','January(Avg. low \u00b0C)']].mean(axis=1)\nmod_df['July Avg. \u00b0C'] = mod_df[['July(Avg. high \u00b0C)','July(Avg. low \u00b0C)']].mean(axis=1)\nmod_df['Annual Avg. \u00b0C'] =  mod_df[['Annual(Avg. high \u00b0C)','Annual(Avg. low \u00b0C)']].mean(axis=1)\n\n","2b4a76e7":"# RE-ARRANGING THE COLUMNS\ncolumn_names= ['Place','Elevation (m)','January(Avg. high \u00b0C)','January(Avg. low \u00b0C)','January Avg. \u00b0C','July(Avg. high \u00b0C)','July(Avg. low \u00b0C)','July Avg. \u00b0C','Annual(Avg. high \u00b0C)','Annual(Avg. low \u00b0C)','Annual Avg. \u00b0C','Province']\nmod_df = mod_df.reindex(columns=column_names)\n","d09b87e7":"### CHANGING THE ABBREVATIONS\ncan_province_names = {\n  'AB': 'Alberta',\n  'BC': 'British Columbia',\n  'MB': 'Manitoba',\n  'NB': 'New Brunswick',\n  'NL': 'Newfoundland and Labrador',\n  'NS': 'Nova Scotia',\n  'NT': 'Northwest Territories',\n  'NU': 'Nunavut',\n  'ON': 'Ontario',\n  'PE': 'Prince Edward Island',\n  'QC': 'Quebec',\n  'SK': 'Saskatchewan',\n  'YT': 'Yukon'\n}\n\nmod_df['Province']=mod_df['Province'].map(can_province_names)","93906251":"province_id = {}\nfor feature in canada_pro['features']:\n    feature['id'] = feature['properties']['prov_code']\n    province_id[feature[\"properties\"][\"prov_name_en\"]] = feature[\"id\"]\n\nmod_df['id'] = mod_df['Province'].apply(lambda x: province_id[x])\n\nmod_df.head()","c6930ec7":"avg_df = mod_df.groupby(['Province','id']).mean()\navg_df = avg_df.round(decimals=2)\navg_df.head()","e6687aae":"win_df = avg_df['January Avg. \u00b0C']\nwin_df = win_df.to_frame(name='January Avg. \u00b0C').reset_index()\nwin_df.head()","b7510d40":"fig = px.choropleth_mapbox(\n    win_df,\n    locations=\"id\",\n    geojson=canada_pro,\n    color=\"January Avg. \u00b0C\",\n    color_continuous_scale='teal',\n    width=650,\n    height=520,\n    hover_name=\"Province\",\n    hover_data=[\"January Avg. \u00b0C\"],\n    mapbox_style= 'carto-positron',\n    title=\"Weather in Canada during winters\",\n    center={\"lat\": 72.1304, \"lon\": -100.3468},\n    zoom=1,\n\n    opacity=0.8,\n)\nfig.update_traces(marker_line_width=0.5)\nfig.show()","f4e3f9f4":"sum_df = avg_df['July Avg. \u00b0C']\nsum_df = sum_df.to_frame(name='July Avg. \u00b0C').reset_index()\nsum_df.head()","63f30c40":"fig = px.choropleth_mapbox(\n    sum_df,\n    locations=\"id\",\n    geojson=canada_pro,\n    color=\"July Avg. \u00b0C\",\n    color_continuous_scale='ylorrd',\n    width=650,\n    height=520,\n    hover_name=\"Province\",\n    hover_data=[\"July Avg. \u00b0C\"],\n    mapbox_style= 'carto-positron',\n    title=\"Weather in Canada during summers\",\n    center={\"lat\": 72.1304, \"lon\": -110.3468},\n    zoom=1,\n    opacity=0.8,\n)\nfig.update_traces(marker_line_width=0) #THIS REMOVES THE BLACK OUTLINES\n\nfig.show()","cb92689f":"year_df = avg_df['Annual Avg. \u00b0C']\nyear_df = year_df.to_frame(name='Annual Avg. \u00b0C').reset_index()\nyear_df.head()","434106e1":"# CREATING A CUSTOM COLOR SCHEME \nblurd = [0, \"rgb(33, 102, 172)\"], [0.125, \"rgb(67, 147, 195)\"], [0.25, \"rgb(146, 197, 222)\"], [0.375, \"rgb(209, 229, 240)\"], [0.625, \"rgb(253, 219, 199)\"], [0.75, \"rgb(244, 165, 130)\"], [0.875, \"rgb(214, 96, 77)\"], [1, \"rgb(178, 24, 43)\"]\nfig = px.choropleth_mapbox(\n    year_df,\n    locations=\"id\",\n    geojson=canada_pro,\n    color=\"Annual Avg. \u00b0C\",\n    color_continuous_scale=blurd,\n    width=650,\n    height=520,\n    hover_name=\"Province\",\n    mapbox_style= 'carto-positron',\n    hover_data=[\"Annual Avg. \u00b0C\"],\n    title=\"Weather in Canada throughout the year\",\n    center={\"lat\": 72.1304, \"lon\": -110.3468},\n    zoom=1,\n    opacity=0.8,\n)\n\nfig.show()","c24ff30f":"#### Creating a choropleth map","74225256":"#### Importing plotly and setting the default render to notebook","9b204661":"### WEATHER IN CANADA THROUGHOUT THE YEAR","c2b9cd72":"### WEATHER IN CANADA DURING WINTERS","566817b0":"### WEATHER IN CANADA DURING SUMMERS","f963f6a5":"#### Renaming the columns","f482c69e":"### CLEANING AND MODIFYING THE DATASET","f132a3f4":"#### Creating a column called id and matching it to the provinces in geojson file."}}