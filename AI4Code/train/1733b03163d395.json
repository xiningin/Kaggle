{"cell_type":{"3d194e46":"code","59edba84":"code","133616f4":"code","03877d2e":"code","bd09657a":"code","6b7343fd":"code","097ebd57":"code","77359c47":"code","c98ebb88":"code","0e28852e":"markdown"},"source":{"3d194e46":"%matplotlib inline\nimport matplotlib.pyplot as plt\nfrom mpl_toolkits.mplot3d import Axes3D\nimport seaborn as sns\nplt.rcParams[\"figure.figsize\"] = (15, 10)\nplt.rcParams[\"figure.dpi\"] = 125\nplt.rcParams[\"font.size\"] = 14\nplt.rcParams['font.family'] = ['sans-serif']\nplt.rcParams['font.sans-serif'] = ['DejaVu Sans']\nplt.style.use('ggplot')\nsns.set_style(\"whitegrid\", {'axes.grid': False})\nplt.rcParams['image.cmap'] = 'gray' # grayscale looks better\nfrom itertools import cycle\nprop_cycle = plt.rcParams['axes.prop_cycle']\ncolors = prop_cycle.by_key()['color']","59edba84":"from pathlib import Path\nimport numpy as np\nimport pandas as pd\nfrom skimage.io import imread as imread\nfrom skimage.util import montage as montage2d\nfrom skimage.color import label2rgb\nbase_dir = Path('..') \/ 'input'","133616f4":"image_overview_df = pd.read_json(base_dir\/ 'image_subset.json')\nimage_overview_df.sample(3)","03877d2e":"from itertools import chain\nall_ingredients = list(chain.from_iterable(image_overview_df['top_ingredients'].values))\ningredient_list = pd.value_counts(all_ingredients)","bd09657a":"fig, ax1 = plt.subplots(1, 1, figsize=(20, 5))\ningredient_count = pd.value_counts(all_ingredients)\ningredient_count.plot.bar(ax=ax1)","6b7343fd":"ing_ids = ingredient_count.index.tolist()","097ebd57":"image_overview_df['ingredients_len'] = image_overview_df['top_ingredients'].map(len)\ning_arr = np.stack(\n    image_overview_df.sort_values('ingredients_len')['top_ingredients'].map(lambda x_list: [k in x_list for k in ing_ids]).values,\n    0\n)\ning_arr.shape","77359c47":"fig, ax1 = plt.subplots(1, 1, figsize=(50, 10))\nax1.imshow(ing_arr.T, cmap='viridis')\nax1.set_aspect(20)\nax1.set_xlabel('Image #')\nax1.set_ylabel('Word')\nax1.set_yticks(range(len(ing_ids)))\nax1.set_yticklabels(ing_ids);","c98ebb88":"fig, m_axs = plt.subplots(3, 3, figsize=(20, 20))\nfor c_ax, (_, c_row) in zip(m_axs.flatten(), \n                            image_overview_df.sample(9).iterrows()):\n    c_ax.imshow(imread(base_dir \/ 'subset' \/ c_row['image_path']))\n    c_ax.set_title('\\n'.join(c_row['top_ingredients'][:4]))\n    c_ax.axis('off')","0e28852e":"# Overview\nLoad and process data"}}