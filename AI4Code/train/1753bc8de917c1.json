{"cell_type":{"b8d6552b":"code","853572a8":"code","3391af96":"code","e0cd3bfd":"code","7adb2240":"code","cd22b7f1":"code","5d244993":"code","bb4361f2":"code","85c7b05e":"markdown","47e50acb":"markdown","4522251b":"markdown","da0f4bde":"markdown","60530ba8":"markdown","8f84a752":"markdown","1faf2b26":"markdown","228d5f5d":"markdown"},"source":{"b8d6552b":"import pandas as pd\nimport json\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport plotly.express as px\nimport plotly.graph_objects as go\nfrom plotly.subplots import make_subplots\nfrom collections import defaultdict","853572a8":"\n    \n\ndef combine_data_sets(country_filepath_dict):\n    dfs = []\n    for country, filepath in country_filepath_dict.items():\n        print(filepath)\n        print(country)\n        df = pd.read_json(filepath)\n        print(len(df))\n        df['country'] = country\n        dfs.append(df)\n    return pd.concat(dfs)\n\n","3391af96":"\n\n\ncountry_filepath = {\n    \"england\" : \"..\/input\/events_England.json\",\n    \"spain\" : \"..\/input\/events_Spain.json\",\n    \"germany\" : \"..\/input\/events_Germany.json\",\n    \"france\" : \"..\/input\/events_France.json\",\n    \"italy\": \"..\/input\/events_Italy.json\"\n}\n","e0cd3bfd":"combined_df = combine_data_sets(country_filepath)\n","7adb2240":"def describe_event(combined_df, event):\n    countries = list(country_filepath.keys())\n    \n    # Generating metrics\n    event_country_series_map = dict()\n    event_df = combined_df[combined_df['eventName'] == event]\n    \n    for country in countries:\n        country_event_df = event_df[event_df['country'] == country]\n        match_groups = country_event_df.groupby(\"matchId\")\n        event_counts_per_match = match_groups.eventId.agg('count')\n        event_country_series_map[country] = event_counts_per_match\n    \n    fig = make_subplots(rows=1, cols=2, specs = [[dict(type=\"polar\"), dict(type=\"box\")]],\n                       subplot_titles=[\"Average %ss per game in 17\/18 season\" %(event,),\n                                      \"%ss per game in 17\/18 season\" %(event,)])\n    \n    # ScatterPolar\n    country_event_counts_means = [ecs.mean() for ecs in \n            [event_country_series_map[country] for country in countries]]\n    fig.add_trace(go.Scatterpolar(\n          r=country_event_counts_means,\n          theta=countries,\n          fill='toself',\n          \n          name=event),\n                 row=1,col=1)\n    \n    # BOX\n    for country in countries:\n        fig.add_trace(go.Box(y=event_country_series_map[country], name=country),)\n    \n    \n    event_count_max = max(country_event_counts_means)\n    event_count_min = min(country_event_counts_means)\n    event_count_range = event_count_max - event_count_min\n    event_count_range_buffer = 0.25 * event_count_range\n    fig.update_layout(\n            polar=dict(radialaxis=dict(visible=True,\n                                      range=[event_count_min-event_count_range_buffer,\n                                            event_count_max])),\n            showlegend=False\n            )\n    fig.show()","cd22b7f1":"describe_event(combined_df, \"Pass\")","5d244993":"describe_event(combined_df, \"Shot\")","bb4361f2":"describe_event(combined_df, \"Foul\")","85c7b05e":"I would have expected Spain to come on top, owing to Tiki-taka but apparently not.","47e50acb":"# Comparing the fouls per game","4522251b":"# Comparing the shots per game","da0f4bde":"## This notebook aims to compare european leagues across stats like passes, shots, fouls, etc per game. This data is for the 17\/18 season. The various leagues compared are:\n- EPL from England\n- La Liga from Spain\n- Serie A from Italy\n- Bundesliga from Germany\n- Ligue 1 from France)","60530ba8":"# Comparing the passes per game","8f84a752":"# Sources\n- Pappalardo, Luca; Massucco, Emanuele (2019): Events. figshare. Dataset. https:\/\/doi.org\/10.6084\/m9.figshare.7770599.v1\n","1faf2b26":"- This led to a goals Galore from Icardi and Immobile","228d5f5d":"- I think we can dedicate this observation to Sergio Ramos. #TODO confirm with data"}}