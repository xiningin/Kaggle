{"cell_type":{"df008ae9":"code","a78f9111":"code","61404bb0":"code","93f4234a":"code","3881a09f":"code","6dc5277c":"code","819d59a3":"code","2f31a108":"code","b8b702a0":"code","988fa9a0":"code","fdf1f513":"code","40730a23":"code","66fc1e2e":"code","412b5418":"code","8eef56c4":"code","c65ed656":"code","bdb987f9":"code","0b8b1b31":"code","1128f55a":"code","7b506756":"code","8d4440d0":"code","bf5cbd81":"code","6d1d1917":"code","832f9b5f":"code","371aecd2":"code","0d30c245":"code","26f4c42f":"code","54d3c27d":"code","9a1d71dc":"code","6e8a80a5":"code","64cc1bbc":"code","2122e008":"code","271fc04b":"code","a2fd2b4d":"code","4a2a3488":"code","02fe8789":"code","f24ecf2f":"code","6068dd60":"code","9d080ab9":"markdown","0dfa074a":"markdown","2bca6633":"markdown","f1950ea6":"markdown","8be11e19":"markdown","dce30b69":"markdown","b27ba6f4":"markdown","320c8df5":"markdown","f900f501":"markdown","c2d5030f":"markdown","4808be10":"markdown"},"source":{"df008ae9":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport warnings\nwarnings.filterwarnings('ignore')\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set(style=\"darkgrid\")\n%matplotlib inline\n\nimport matplotlib.pyplot as plt\nplt.rcParams['figure.dpi'] = 100\n\nimport xgboost as xgb\n#Training will be done by RandomForest Algorithm\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.tree import DecisionTreeRegressor\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.svm import SVR\n\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.metrics import confusion_matrix,accuracy_score,roc_auc_score\n\nfrom sklearn.preprocessing import MinMaxScaler\nfrom sklearn.metrics import mean_squared_error\nfrom sklearn.preprocessing import StandardScaler #StandardScaler function of sklearn is used to scale down values of dataframe between 0 and 1\nfrom sklearn.model_selection import train_test_split\n\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","a78f9111":"from sklearn.metrics import mean_squared_log_error","61404bb0":"train = pd.read_csv('\/kaggle\/input\/tabular-playground-series-jul-2021\/train.csv')\ntest = pd.read_csv('\/kaggle\/input\/tabular-playground-series-jul-2021\/test.csv')","93f4234a":"display(train)\ndisplay(test)","3881a09f":"sns.pairplot(data=train)","6dc5277c":"#Remove the dates from the set, since their influence is not high\ntrain = train.drop('date_time',axis=1)","819d59a3":"#popping out the targets from the train dataset\ny_CO = train.pop('target_carbon_monoxide')\ny_BE = train.pop('target_benzene')\ny_NO = train.pop('target_nitrogen_oxides')","2f31a108":"#Checking dataset before Scaling the training dataset.This will be the input to the model\ndisplay(train)","b8b702a0":"#Scaling using MinMax Scaler\nscaler = MinMaxScaler(feature_range=(0, 1))\ntrain = scaler.fit_transform(train)","988fa9a0":"train[0]","fdf1f513":"#Training data after scaling is an numpy array datatype\nprint(train)\nprint(type(train))","40730a23":"X_train , X_cv , y_train_co , y_cv_co  = train_test_split(train ,y_CO, test_size = 0.2)\nX_train , X_test , y_train_co , y_test_co  = train_test_split(X_train ,y_train_co, test_size = 0.2)","66fc1e2e":"#Working only on the remaining NO and Benezene targets\ny_train_no , y_cv_no  = train_test_split(y_NO, test_size = 0.2)\ny_train_no , y_test_no  = train_test_split(y_train_no, test_size = 0.2)","412b5418":"y_train_be , y_cv_be  = train_test_split(y_BE, test_size = 0.2)\ny_train_be , y_test_be  = train_test_split(y_train_be, test_size = 0.2)","8eef56c4":"# Target carbon Monoxide columns has been also split same as training data.\n# Ensure the lengths of all the datasets are same\nprint(X_train.shape)\nprint(X_cv.shape)\nprint(X_test.shape)\nprint(y_train_co.shape)\nprint(y_cv_co.shape)\nprint(y_test_co.shape)","c65ed656":"#Fitting the data that matters\nCO_r = LinearRegression(normalize=True)\nCO_r.fit(X_train,y_train_co)\ny_pred_co = CO_r.predict(X_cv)\n#I am getting negative values when predicting only the CO values. So making them 0\ny_pred_co[y_pred_co < 0] = 0 \nprint(\"RMSE with simple Linear Regression\",mean_squared_log_error(y_cv_co,y_pred_co))\nBE_r = LinearRegression(normalize=True)\nBE_r.fit(X_train,y_train_be)\ny_pred_be = BE_r.predict(X_cv)\nprint(\"RMSE with simple Linear Regression\",mean_squared_log_error(y_cv_be,y_pred_be))\nNO_r = LinearRegression(normalize=True)\nNO_r.fit(X_train,y_train_no)\ny_pred_no = NO_r.predict(X_cv)\nprint(\"RMSE with simple Linear Regression\",mean_squared_log_error(y_cv_no,y_pred_no))\n","bdb987f9":"d = {'CO': list(y_cv_co), 'BE': list(y_cv_be), 'NO':list(y_cv_no)}\ny_cv = pd.DataFrame(data=d)\ny_cv.head()","0b8b1b31":"p = {'CO': list(rand_yco), 'BE': list(rand_ybe), 'NO':list(rand_yno)}\ny_rand = pd.DataFrame(data=p)\ny_rand.head()","1128f55a":"y_cv.shape","7b506756":"#Carbon Monoxide\nCO=RandomForestRegressor(n_estimators=50,random_state=0,criterion=\"mse\")\nCO.fit(X_train,y_train_co)\nrand_yco=CO.predict(X_cv)\nprint(\"mean SQ error CO:\",mean_squared_log_error(rand_yco,y_cv_co))\n#Benzene\nBE=RandomForestRegressor(n_estimators=50,random_state=0,criterion=\"mse\")\nBE.fit(X_train,y_train_be)\nrand_ybe=BE.predict(X_cv)\nprint(\"mean SQ error BE:\",mean_squared_log_error(rand_ybe,y_cv_be))\n#Nitrous Oxide\nNO=RandomForestRegressor(n_estimators=50,random_state=0,criterion=\"mse\")\nNO.fit(X_train,y_train_no)\nrand_yno=NO.predict(X_cv)\nprint(\"mean SQ error NO:\",mean_squared_log_error(rand_yno,y_cv_no))","8d4440d0":"#Carbon Monoxide\ns_CO=SVR()\ns_CO.fit(X_train,y_train_co)\ns_yco=s_CO.predict(X_cv)\nprint(\"mean SQ error CO:\",mean_squared_log_error(s_yco,y_cv_co))\n#Benzene\ns_BE=SVR()\ns_BE.fit(X_train,y_train_be)\ns_ybe=s_BE.predict(X_cv)\nprint(\"mean SQ error BE:\",mean_squared_log_error(s_ybe,y_cv_be))\n#Nitrous Oxide\ns_NO=SVR()\ns_NO.fit(X_train,y_train_no)\ns_yno=s_NO.predict(X_cv)\nprint(\"mean SQ error NO:\",mean_squared_log_error(s_yno,y_cv_no))","bf5cbd81":"#Predicting Test Carbon Monoxide with SVR\ntest_yco=s_CO.predict(X_test)\nprint(\"mean SQ error CO:\",mean_squared_log_error(test_yco,y_test_co))\n#Predicting Test Benzene with SVR\ntest_ybe=s_BE.predict(X_test)\nprint(\"mean SQ error BE:\",mean_squared_log_error(test_ybe,y_test_be))\n#Predicting Test Nitrous Oxide with SVR\ntest_yno=s_NO.predict(X_test)\nprint(\"mean SQ error NO:\",mean_squared_log_error(test_yno,y_test_no))","6d1d1917":"test.head()","832f9b5f":"#Scaling the Actual test dataframe after dropping the date column\ntest = test.drop('date_time',axis=1)","371aecd2":"trial = pd.DataFrame()\ntrial['target_carbon_monoxide'] = list(test_yco)\ntrial['target_benzene'] = list(test_ybe)\ntrial['target_nitrogen_oxides'] = list(test_yno)","0d30c245":"mean_squared_log_error(trial,sim)","26f4c42f":"sim = pd.DataFrame()\nsim['target_carbon_monoxide'] = list(y_test_co)\nsim['target_benzene'] = list(y_test_be)\nsim['target_nitrogen_oxides'] = list(y_test_no)","54d3c27d":"sim.head()","9a1d71dc":"#Scaling using MinMax Scaler\nscaler = MinMaxScaler(feature_range=(0, 1))\ntest = scaler.fit_transform(test)","6e8a80a5":"#Predicting Carbon Monoxide with SVR and competition test data\ntest_co=s_CO.predict(test)\n#Predicting Benzene with SVR and competition test data\ntest_be=s_BE.predict(test)\n#Predicting Nitrous Oxide with SVR and competition test data\ntest_no=s_NO.predict(test)\n","64cc1bbc":"#Reinitialising the competition test dataframe again\ntest = pd.read_csv('\/kaggle\/input\/tabular-playground-series-jul-2021\/test.csv')","2122e008":"test.shape","271fc04b":"test['target_carbon_monoxide'] =  test_co #Adding the Predicted Target_CO to test dataframe","a2fd2b4d":"test['target_benzene'] = test_be #Adding the Predicted Target_CO to test dataframe","4a2a3488":"test['target_nitrogen_oxides'] = test_no#Adding the Predicted Target_CO to test dataframe","02fe8789":"submission = test[['date_time','target_carbon_monoxide','target_benzene','target_nitrogen_oxides']]","f24ecf2f":"submission.shape","6068dd60":"submission.to_csv('my_submission.csv',index=False)","9d080ab9":"Plotting the scores of the targets","0dfa074a":"#Using RandomForest Regressor","2bca6633":"Mean SQ error with the test data on the SVR model has yielded the lower RMSE value","f1950ea6":"With the raw data for the model building ready, it  has to be split into 3 groups.\n1) Training Dataset\n2) Cross Validation Dataset\n3) Testing Dataset\n\nWhy split this way? \nIn this competition the goal is to reach the highest RMSE score on the test data, that is shared with all the competition. What is not shared is the sensor output based on the test data, on which the RMSE score will be calculated.\n\nYou assume the role of the competition host, and not share some of the data and results to the models that you are training. This way, you can have a \"Mock Exam\" with the models before submitting to the real competition.  ","8be11e19":"Start with the Mutual infomation for Target_Corbon_monoxide","dce30b69":"Sensor 3 is not linear as per the above patter. The components of this sensor can render a different result. So doing PCA after the Linear Regression","b27ba6f4":"After the PCA there is not much improvement in the scores, so going ahead with existing data","320c8df5":"Based on the Pairplot above, following are my 1st cut inference\n\n1) Targets are distributed along the entire range of humidity & Temperature. They can help to cluster the targets\n\n2) Sensor 1, 2, 4 and 5 seem to have linear relation to the targets.\n\n3) Sensor 3 has a non linear relationships with all three targets.\n\nStrategy : \n>> Split the data and target columns seperately.\n\n>> Scale the data \n\n>> Model the data using Random Forest, Linear Regressor and Support Vector Regressor\n\n>> Test it on the another other file, and find how well your model works.","f900f501":"Training the model with all 8 features. The models are trained with each target seperately, CO, NO and Benzene. Rationale is, each target will have unique relation with the features, so separate models will capture it better. ","c2d5030f":"Running the MI Scores for the Target Carbon Monoxides","4808be10":"## Based on the SVR, Random Regressor and Linear Regressor, the RMSE for SVR has come low"}}