{"cell_type":{"2fb64dfe":"code","0818323a":"code","63fff8ce":"code","25e354bc":"code","151388a5":"code","f696ccdd":"code","e0801747":"code","e6c22c9c":"code","360bc855":"code","624984e7":"code","73b7c773":"code","c7f258b9":"code","bf2b4983":"code","d8ed4890":"code","50944499":"code","639c5e26":"code","d30b5134":"code","5c577180":"code","1380a5be":"code","d169078f":"code","aa05b6eb":"code","5135845c":"code","594942db":"code","a28389e9":"code","a0af811c":"code","b6f1bed9":"code","059f5742":"code","a449f71a":"code","4e9e448b":"code","239a1dd9":"code","a87d25a1":"code","b3bc5c56":"code","fdf8c921":"code","e8059a98":"code","86125d49":"code","8c3e54ab":"code","4a4e9dd6":"code","ed0ff981":"code","60cc8426":"code","9ae2c42c":"code","eb3dd331":"code","ec244661":"code","8a4885d5":"code","16e58b30":"code","947f8465":"code","06890a1c":"code","03a53544":"code","d20f362b":"code","c635685d":"code","5f5a643f":"code","a62e6947":"code","4fd69ceb":"code","2b0c27c5":"code","71277cf9":"code","4977e0ef":"code","43dde02e":"code","55946b8e":"code","cefba030":"code","23f5010e":"code","649b521a":"code","ec040047":"code","07cb2ebe":"code","c0385f18":"code","08fa42a6":"code","cadeca02":"code","1b6e917f":"code","7adf589c":"code","765e6576":"markdown","5a887e7c":"markdown","13e60bc4":"markdown","ee6b9230":"markdown","32ac936b":"markdown","1e61c52a":"markdown","8ec8a293":"markdown","d81cc53e":"markdown","5bc7befb":"markdown","4d02cd04":"markdown","3e1fac6a":"markdown","d1557645":"markdown","6f486da5":"markdown","4c39b0b6":"markdown","837728f8":"markdown","20e74d99":"markdown","dba73419":"markdown","16b739fe":"markdown","f64c3e31":"markdown","bbbc48ee":"markdown","e1039b3c":"markdown","c8767c03":"markdown","c59201fa":"markdown","815cf8d3":"markdown","3bb1e499":"markdown","c9a02655":"markdown","018079be":"markdown","e5be43eb":"markdown","8dae01ef":"markdown","2d360b68":"markdown","abf9229b":"markdown","e5ea7776":"markdown","89a79b37":"markdown","ea0990c6":"markdown","ae96ab58":"markdown","b6d6919d":"markdown","71f8952f":"markdown","61339b3d":"markdown","a1dc4284":"markdown","fd8438dd":"markdown","77845dae":"markdown","38f96e4e":"markdown","054e33be":"markdown","225fc51c":"markdown","41459a27":"markdown","c1489558":"markdown","3df78b94":"markdown","e76960e9":"markdown"},"source":{"2fb64dfe":"!pip install seaborn==0.11.0","0818323a":"import numpy as np\nimport pandas as pd\nimport os\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\npd.set_option('display.max_colwidth', None)\npd.set_option('display.max_columns', None)\npd.set_option('display.max_rows', None)\n\nimport matplotlib.ticker as ticker\nprint(sns.__version__)\n\nfrom matplotlib import rcParams\nsns.set(rc={\"font.size\":18,\"axes.titlesize\":30,\"axes.labelsize\":18,\n            \"axes.titlepad\":22, \"axes.labelpad\":18, \"legend.fontsize\":15,\n            \"legend.title_fontsize\":15, \"figure.titlesize\":35})\n\nfrom plotly.offline import download_plotlyjs, init_notebook_mode, plot, iplot\ninit_notebook_mode(connected=True)\nimport plotly.graph_objects as go\nimport plotly.express as px\nfrom plotly.graph_objs.layout import Scene","63fff8ce":"#Load Train and Test Data\ndf_train = pd.read_csv(\"\/kaggle\/input\/titanic\/train.csv\")\ndf_test = pd.read_csv(\"\/kaggle\/input\/titanic\/test.csv\")\ndf_train.head(5)","25e354bc":"for col in ['Sex', 'Cabin', 'Ticket', 'Embarked']:\n    df_train[col] = df_train[col].astype('category')\n    df_test[col] = df_test[col].astype('category')\ndf_train.info(verbose=True)","151388a5":"fig = plt.figure(figsize=(22,8))\nkde = sns.kdeplot(x=\"Age\", data=df_train, cut=0, hue=\"Survived\",\n                  fill=True, legend=True, palette=\"plasma_r\")\n\nkde.xaxis.set_major_locator(ticker.MultipleLocator(1))\nkde.xaxis.set_major_formatter(ticker.ScalarFormatter())\n\nfig.suptitle(\"AGE BY SURVIVED\", x=0.125, y=1.01, ha='left',\n             fontweight=100, fontfamily='Lato', size=39);\n","f696ccdd":"fig = plt.figure(figsize=(22,8))\nhist = sns.histplot(df_train['Age'], color=\"springgreen\", kde=True, bins=50, label='Train')\nhist = sns.histplot(df_test['Age'], color=\"gold\", kde=True, bins=50, label='Test')\n\ntitle = fig.suptitle(\"DISTRIBUTION OF AGE IN TRAIN & TEST\", x=0.125, y=1.01, ha='left',\n             fontweight=100, fontfamily='Lato', size=39)\n\nhist.xaxis.set_major_locator(ticker.MultipleLocator(1))\nhist.xaxis.set_major_formatter(ticker.ScalarFormatter())\n\nplt.legend()\nplt.show()","e0801747":"fig = plt.figure(figsize=(22,8))\nkde = sns.kdeplot(x=\"Fare\", data=df_train, cut=0, hue=\"Survived\", fill=True, legend=True, palette=\"mako_r\")\n\nkde.xaxis.set_major_locator(ticker.MultipleLocator(10))\nkde.xaxis.set_major_formatter(ticker.ScalarFormatter())\n\nfig.suptitle(\"FARE BY SURVIVED\", x=0.125, y=1.01\n            , ha='left',fontweight=100, fontfamily='Lato', size=39);","e6c22c9c":"fig = plt.figure(figsize=(20,8))\nkde = sns.kdeplot(x=\"Fare\", data=df_train, cut=0, clip=[0,180], hue=\"Survived\", fill=True, legend=True, palette=\"mako_r\")\n\nkde.xaxis.set_major_locator(ticker.MultipleLocator(4))\nkde.xaxis.set_major_formatter(ticker.ScalarFormatter())\n\nfig.suptitle(\"FARE BY SURVIVED - CLIPPED TO REMOVE OUTLIERS\", x=0.12, y=1.01, ha='left',\n             fontweight=100, fontfamily='Lato', size=37);\n","360bc855":"fig = plt.figure(figsize=(20,8))\ndist = sns.histplot(df_train[(df_train.Fare > 0) & (df_train.Fare <=180)]['Fare'],\n                    color=\"gold\", kde=True, bins=50, label='Train')\ndist = sns.histplot(df_test[(df_test.Fare > 0) & (df_test.Fare <=180)]['Fare'],\n                    color=\"crimson\", kde=True, bins=50, label='Test')\n\ntitle = fig.suptitle(\"DISTRIBUTION OF FARE IN TRAIN & TEST\", x=0.12, y=1.01, ha='left',\n             fontweight=100, fontfamily='Lato', size=37)\n\ndist.xaxis.set_major_locator(ticker.MultipleLocator(4))\ndist.xaxis.set_major_formatter(ticker.ScalarFormatter())\n\nplt.legend()\nplt.show()","624984e7":"fig, ax = plt.subplots(ncols=2, figsize=(20,8))\nfor i, col in enumerate(['Pclass', 'Sex',]):\n    sns.histplot(x=col, data=df_train, hue=\"Survived\", fill=True, ax=ax[i], palette=\"afmhot_r\", kde=True)\n    #ax[i].title.set_text(col+\" by Survived\")\n    ax[i].set_title(col.upper()+\" BY SURVIVED\", x=0.0, y=1.01, ha='left',\n             fontweight=100, fontfamily='Lato', size=37)","73b7c773":"fig, ax = plt.subplots(ncols=2, figsize=(20,8))\nfor i, col in enumerate(['Pclass', 'Sex',]):\n    n_bins =df_train[col].unique().shape[0]\n    sns.histplot(df_train[col], color=\"gold\", kde=True, bins=n_bins,\n                 label='Train', ax=ax[i], legend=True)\n    sns.histplot(df_test[col], color=\"crimson\", kde=True, bins=n_bins,\n                 label='Test', ax=ax[i], legend=True)\n    #ax[i].title.set_text(col+\" by Survived\")\n    ax[i].set_title(\"DISTRIBUTION OF {} IN TRAIN & TEST\".format(col.upper())\n                    , x=0.0, y=1.01, ha='left', fontweight=100, fontfamily='Lato', size=25)\n    ax[i].legend(loc='upper left')","c7f258b9":"fig, ax = plt.subplots(ncols=2, figsize=(20,8))\nfor i, col in enumerate(['SibSp', 'Parch']):\n    sns.histplot(x=col, data=df_train, hue=\"Survived\", fill=True, ax=ax[i], palette=\"hsv_r\", kde=True)\n    ax[i].set_title(col.upper()+\" BY SURVIVED\", x=0.0, y=1.03, ha='left',\n             fontweight=100, fontfamily='Lato', size=37)","bf2b4983":"fig, ax = plt.subplots(ncols=2, figsize=(20,8))\nfor i, col in enumerate(['SibSp', 'Parch']):\n    n_bins = df_train[col].unique().shape[0]\n    hist1 = sns.histplot(df_train[col], color=\"orangered\", kde=True, bins=n_bins,\n                 label='Train', ax=ax[i], legend=True)\n    hist2 = sns.histplot(df_test[col], color=\"gold\", kde=True, bins=n_bins,\n                 label='Test', ax=ax[i], legend=True)\n    #ax[i].title.set_text(col+\" by Survived\")\n    ax[i].set_title(\"DISTRIBUTION OF {} IN TRAIN & TEST\".format(col.upper())\n                    , x=0.0, y=1.01, ha='left', fontweight=100, fontfamily='Lato', size=25)\n    ax[i].legend(loc='upper left')\n    \n    hist1.xaxis.set_major_locator(ticker.MultipleLocator(1))\n    hist2.xaxis.set_major_formatter(ticker.ScalarFormatter())","d8ed4890":"fig, ax = plt.subplots(ncols=3, figsize=(20,8))\nfor i, col in enumerate(['Pclass', 'Parch', 'SibSp']):\n    sns.violinplot(x=\"Survived\", y=col, data=df_train, ax=ax[i], palette=\"Spectral_r\", orient=\"v\")\n    ax[i].set_title(col.upper()+\" BY SURVIVED\", x=0.0, y=1.03, ha='left',\n         fontweight=200, fontfamily='Lato', size=33)","50944499":"fig, ax = plt.subplots(ncols=2, figsize=(20,8))\nfor i, col in enumerate(['Sex', 'Embarked']):\n    sns.violinplot(y=\"Survived\", x=col, data=df_train, ax=ax[i], palette=\"bone_r\", orient=\"v\")\n    ax[i].set_title(col.upper()+\" BY SURVIVED\", x=0.0, y=1.03, ha='left',\n         fontweight=200, fontfamily='Lato', size=37)","639c5e26":"fig = px.scatter(df_train,\n                 x=\"Fare\", y=\"Age\", color=\"Survived\", size=\"Pclass\",\n                 log_x=True, size_max=8, color_continuous_scale=['crimson', 'cyan'],\n                 marginal_x='violin', marginal_y='histogram',\n                 template='plotly', title='<span style=\"font-weight: 100;\">AGE VS FARE BY SURVIVED<\/span>')\n\nfig.update_layout(\n    title_x=0.08,\n    title_font_size=32,\n    title_font_color='black'\n)\n\nfig.show()","d30b5134":"trace1=go.Scatter3d(x=df_train['Age'], y=df_train['Pclass'], z=df_train['Fare'],\n                   mode='markers', marker=dict(size=3,colorscale='rdylbu',color=df_train['Survived']),\n                                             opacity=0.8, \n                    scene = 'scene')\nlayout = go.Layout(\n    scene = Scene(\n        xaxis=go.layout.scene.XAxis(title='Age'),\n        yaxis=go.layout.scene.YAxis(title='Pclass'),\n        zaxis=go.layout.scene.ZAxis(title='Fare')\n    ),\n    title='<span style=\"font-weight: 100;\">AGE VS FARE VS PCLASS BY SURVIVED<\/span>',\n    title_x=0.08,\n    title_font_size=32,\n    title_font_color='black',\n    font=dict(\n        size=10,\n        color=\"RebeccaPurple\"\n    )  \n)\n\nfig = Figure(data=trace1, layout=layout)\nfig.show()","5c577180":"fig = px.histogram(df_train, x=\"Age\", y=\"Fare\", color=\"Survived\",\n                   facet_row=\"Pclass\", facet_col=\"Sex\")\n\nfig.update_layout(\n    title='<span style=\"font-weight: 100;\">AGE VS FARE VS PCLASS BY SURVIVED<\/span>',\n    title_x=0.08,\n    height=500,\n    title_font_size=32,\n    title_font_color='black'\n)\n\nfig.show()","1380a5be":"fig = px.scatter(df_train, x=\"Age\", y=\"Fare\", color=\"Survived\",\n                   facet_row=\"Pclass\", facet_col=\"Sex\", color_continuous_scale='PiYg')\n\nfig.update_layout(\n    title='<span style=\"font-weight: 100;\">AGE VS FARE VS PCLASS BY SURVIVED<\/span>',\n    title_x=0.08,\n    height=500,\n    title_font_size=32,\n    title_font_color='black'\n)\n\nfig.show()","d169078f":"fig = px.histogram(df_train, x=\"SibSp\", y=\"Parch\", color=\"Survived\",\n                   facet_row=\"Pclass\", facet_col=\"Survived\", color_discrete_sequence=['maroon', 'mediumaquamarine'])\n\nfig.update_layout(\n    title='<span style=\"font-weight: 100;\">SIBSP VS PARCH VS PCLASS BY SURVIVED<\/span>',\n    title_x=0.08,\n    width=900,\n    height=700,\n    title_font_size=32,\n    title_font_color='black'\n)\n\nfig.show()","aa05b6eb":"features = ['Survived', 'Pclass', 'Sex', 'Age', 'SibSp',\n       'Parch', 'Fare', 'Cabin', 'Embarked']\n\npair_plt = sns.pairplot(df_train[features], hue=\"Survived\", palette=\"twilight_shifted\",\n                 diag_kind=\"kde\", height=2.5)\ntmp = pair_plt.fig.suptitle(\"FEATURES GROUPED BY SURVIVED\", x=0.085, y=1.05, ha='left',\n             fontweight=100, fontfamily='Lato', size=33)","5135845c":"full_df = pd.concat([df_train, df_test]).reset_index(drop=True)\n\ntrain_shape = df_train.shape\ntest_shape = df_test.shape","594942db":"# Label Encoding\nfull_df.loc[:, 'Sex'] = (full_df.loc[:, 'Sex'] == 'female').astype(int)","a28389e9":"full_df['Title'] = full_df['Name']\nfull_df['Title'] = full_df['Name'].str.extract('([A-Za-z]+)\\.', expand=True)\n\nc1 = sns.catplot(x=\"Title\", hue=\"Survived\", kind=\"count\", data=full_df[:train_shape[0]],\n                 aspect = 3.5, legend=True, palette=\"YlGnBu\")\n\ntitle = c1.fig.suptitle(\"COUNT BY TITLE\", x=0.04, y=1.12, ha='left',\n             fontweight=100, fontfamily='Lato', size=42)\n\n# Replacing rare titles \nmapping = {'Mlle': 'Miss', 'Ms': 'Miss', 'Mme': 'Mrs', 'Major': 'Other', \n           'Col': 'Other', 'Dr' : 'Other', 'Rev' : 'Other', 'Capt': 'Other', \n           'Jonkheer': 'Royal', 'Sir': 'Royal', 'Lady': 'Royal', \n           'Don': 'Royal', 'Countess': 'Royal', 'Dona': 'Royal'}\n           \nfull_df.replace({'Title': mapping}, inplace=True)\n\nc2 = sns.catplot(x=\"Title\", hue=\"Survived\", kind=\"count\", data=full_df[:train_shape[0]],\n                 aspect = 3.5, legend=True, palette=\"YlGnBu\")\nc2.fig.suptitle(\"COUNT BY TITLE AGGREGATED\", x=0.04, y=1.12, ha='left',\n             fontweight=100, fontfamily='Lato', size=42);","a0af811c":"full_df[\"Name_Length\"] = full_df.Name.str.replace(\"[^a-zA-Z]\", \"\").str.len()\n\nfig, ax = plt.subplots(ncols=1, figsize=(20,8))\nkde = sns.kdeplot(x=\"Name_Length\", data=full_df[:train_shape[0]], cut=True,\n                  hue=\"Survived\", fill=True, ax=ax, palette=\"mako_r\")\n\nkde.xaxis.set_major_locator(ticker.MultipleLocator(1))\nkde.xaxis.set_major_formatter(ticker.ScalarFormatter())\n\nfig.suptitle(\"NAME_LENGTH BY SURVIVED\", x=0.125, y=1.01, ha='left',\n             fontweight=100, fontfamily='Lato', size=42);","b6f1bed9":"full_df['Title_C'] = full_df['Title']\n\nfull_df = pd.get_dummies(full_df, columns=[\"Embarked\",\"Title_C\"],\\\n                         prefix=[\"Emb\",\"Title\"], drop_first=False)\n\ntitle_dict = {'Mr': 1, 'Miss': 2, 'Mrs': 3, 'Other': 4, 'Royal': 5, 'Master': 6}\nfull_df['Title'] = full_df['Title'].map(title_dict).astype('int')","059f5742":"# New feature : Family_size\nfull_df['Family_Size'] = full_df['Parch'] + full_df['SibSp'] + 1\n\nfull_df['Fsize_Cat'] = full_df['Family_Size'].map(lambda val: 'Alone' if val <= 1 else ('Small' if val < 5 else 'Big'))\n\nfig, ax = plt.subplots(ncols=2, figsize=(22,8))\nfor i, col in enumerate(['Family_Size', 'Fsize_Cat']):\n    sns.histplot(x=col, data=full_df[:train_shape[0]], hue=\"Survived\", fill=True, ax=ax[i], palette=\"afmhot_r\", kde=True)\n    ax[i].set_title(col.upper()+\" BY SURVIVED\", x=0.0, y=1.03, ha='left',\n         fontweight=200, fontfamily='Lato', size=39)\n    if(col=='Family_Size'):\n        ax[i].xaxis.set_major_locator(ticker.MultipleLocator(1))\n        ax[i].xaxis.set_major_formatter(ticker.ScalarFormatter())","a449f71a":"Fsize_dict = {'Alone':3, 'Small':2, 'Big':1}\nfull_df['Fsize_Cat'] = full_df['Fsize_Cat'].map(Fsize_dict).astype('int')","4e9e448b":"full_df['Family_Name'] = full_df['Name'].str.extract('([A-Za-z]+.[A-Za-z]+)\\,', expand=True)","239a1dd9":"MEAN_SURVIVAL_RATE = round(np.mean(df_train['Survived']), 4)\n\nfull_df['Family_Friends_Surv_Rate'] = MEAN_SURVIVAL_RATE\nfull_df['Surv_Rate_Invalid'] = 1\n\nfor _, grp_df in full_df[['Survived', 'Family_Name', 'Fare', 'Ticket', 'PassengerId']].groupby(['Family_Name', 'Fare']):                       \n    if (len(grp_df) > 1):\n        if(grp_df['Survived'].isnull().sum() != len(grp_df)):\n            for ind, row in grp_df.iterrows():\n                full_df.loc[full_df['PassengerId'] == row['PassengerId'],\n                            'Family_Friends_Surv_Rate'] = round(grp_df['Survived'].mean(), 4)\n                full_df.loc[full_df['PassengerId'] == row['PassengerId'],\n                            'Surv_Rate_Invalid'] = 0\n\nfor _, grp_df in full_df[['Survived', 'Family_Name', 'Fare', 'Ticket', 'PassengerId', 'Family_Friends_Surv_Rate']].groupby('Ticket'):\n    if (len(grp_df) > 1):\n        for ind, row in grp_df.iterrows():\n            if (row['Family_Friends_Surv_Rate'] == 0.) | (row['Family_Friends_Surv_Rate'] == MEAN_SURVIVAL_RATE):\n                if(grp_df['Survived'].isnull().sum() != len(grp_df)):\n                    full_df.loc[full_df['PassengerId'] == row['PassengerId'],\n                                'Family_Friends_Surv_Rate'] = round(grp_df['Survived'].mean(), 4)\n                    full_df.loc[full_df['PassengerId'] == row['PassengerId'],\n                                'Surv_Rate_Invalid'] = 0","a87d25a1":"fig, ax = plt.subplots(figsize=(23,8))\nsns.histplot(x='Family_Friends_Surv_Rate', data=full_df[:train_shape[0]], hue=\"Survived\", fill=True, ax=ax, palette=\"inferno_r\")\nfig.suptitle(\"FAMILY_FRIENDS_SURV_RATE BY SURVIVED\", x=0.125, y=1.01, ha='left',\n             fontweight=100, fontfamily='Lato', size=42);","b3bc5c56":"fig, ax = plt.subplots(figsize=(23,8))\nsns.barplot(y='Survived', x='Family_Friends_Surv_Rate', data=full_df[:train_shape[0]], ax=ax, palette=\"Set2_r\")\nfig.suptitle(\"FAMILY_FRIENDS_SURV_RATE BY SURVIVED\", x=0.125, y=1.01, ha='left',\n             fontweight=100, fontfamily='Lato', size=42);","fdf8c921":"# Replace missing values with 'U' for Cabin\nfull_df['Cabin'] = full_df['Cabin'].astype('category')\nfull_df['Cabin'] = full_df['Cabin'].cat.add_categories('U')\nfull_df['Cabin_Clean'] = full_df['Cabin'].fillna('U')\nfull_df['Cabin_Clean'] = full_df['Cabin_Clean'].str.strip(' ').str[0]\n# Label Encoding\ncabin_dict = {'A':9, 'B':8, 'C':7, 'D':6, 'E':5, 'F':4, 'G':3, 'T':2, 'U':1}\nfull_df['Cabin_Clean'] = full_df['Cabin_Clean'].map(cabin_dict).astype('int')\n","e8059a98":"fig, ax = plt.subplots(ncols=1, figsize=(23,8))\nsns.histplot(x=\"Cabin_Clean\", data=full_df[:train_shape[0]], hue=\"Survived\", fill=True, ax=ax, palette=\"nipy_spectral\", kde=True)\nfig.suptitle(\"CABIN_CLEAN BY SURVIVED\", x=0.125, y=1.01, ha='left',\n             fontweight=100, fontfamily='Lato', size=42);","86125d49":"import re\ndef clean_ticket(each_ticket):\n    prefix = re.sub(r'[^a-zA-Z]', '', each_ticket)\n    if(prefix):\n        return prefix\n    else:\n        return \"NUM\"\n\nfull_df[\"Tkt_Clean\"] = full_df.Ticket.apply(clean_ticket)\n\nfig, ax = plt.subplots(ncols=1, figsize=(23,8))\nsns.countplot(x=\"Tkt_Clean\", data=full_df[:train_shape[0]], hue=\"Survived\", fill=True, ax=ax, palette=\"bwr_r\")\nfig.suptitle(\"TKT_CLEAN BY SURVIVED\", x=0.125, y=1.01, ha='left',\n             fontweight=100, fontfamily='Lato', size=42);","8c3e54ab":"full_df['Ticket_Frequency'] = full_df.groupby('Ticket')['Ticket'].transform('count')\nfig, ax = plt.subplots(ncols=1, figsize=(23,8))\nsns.countplot(x=\"Ticket_Frequency\", data=full_df[:train_shape[0]], hue=\"Survived\", fill=True, ax=ax, palette=\"PiYG_r\")\n\nfig.suptitle(\"TICKET_FREQUENCY BY SURVIVED\", x=0.125, y=1.01, ha='left',\n             fontweight=100, fontfamily='Lato', size=42);\n","4a4e9dd6":"full_df = pd.get_dummies(full_df, columns=[\"Tkt_Clean\"],\\\n                          prefix=[\"Tkt\"], drop_first=True)","ed0ff981":"def fare_cat(fare):\n    if fare <= 7.0:\n        return 1\n    elif fare <= 39 and fare > 7.0:\n        return 2\n    else:\n        return 3\n\nfull_df.loc[:, 'Fare_Cat'] = full_df['Fare'].apply(fare_cat).astype('int')","60cc8426":"full_df.loc[:, 'Fare_Family_Size'] = full_df['Fare']\/full_df['Family_Size']\n\nfull_df.loc[:, 'Fare_Cat_Pclass'] = full_df['Fare_Cat']*full_df['Pclass']\nfull_df.loc[:, 'Fare_Cat_Title'] = full_df['Fare_Cat']*full_df['Title']\n\nfull_df.loc[:, 'Fsize_Cat_Title'] = full_df['Fsize_Cat']*full_df['Title']\nfull_df.loc[:, 'Fsize_Cat_Fare_Cat'] = full_df['Fare_Cat']\/full_df['Fsize_Cat'].astype('int')\n\nfull_df.loc[:, 'Pclass_Title'] = full_df['Pclass']*full_df['Title']\nfull_df.loc[:, 'Fsize_Cat_Pclass'] = full_df['Fsize_Cat']*full_df['Pclass']","9ae2c42c":"colsToRemove = []\ncols = ['Tkt_AQ', 'Tkt_AS', 'Tkt_C', 'Tkt_CA',\n         'Tkt_CASOTON', 'Tkt_FC', 'Tkt_FCC', 'Tkt_Fa', 'Tkt_LINE', 'Tkt_LP',\n         'Tkt_NUM', 'Tkt_PC', 'Tkt_PP', 'Tkt_PPP', 'Tkt_SC', 'Tkt_SCA',\n         'Tkt_SCAH', 'Tkt_SCAHBasle', 'Tkt_SCOW', 'Tkt_SCPARIS', 'Tkt_SCParis',\n         'Tkt_SOC', 'Tkt_SOP', 'Tkt_SOPP', 'Tkt_SOTONO', 'Tkt_SOTONOQ',\n         'Tkt_SP', 'Tkt_STONO', 'Tkt_STONOQ', 'Tkt_SWPP', 'Tkt_WC', \n         'Tkt_WEP', 'Fare_Cat', 'Fare_Family_Size', 'Fare_Cat_Pclass',\n         'Fare_Cat_Title', 'Fsize_Cat_Title', 'Fsize_Cat_Fare_Cat', \n         'Pclass_Title', 'Fsize_Cat_Pclass']\n\nfor col in cols:\n    if full_df[col][:train_shape[0]].std() == 0: \n        colsToRemove.append(col)\n\n# remove constant columns in the training set\nfull_df.drop(colsToRemove, axis=1, inplace=True)\nprint(\"Removed `{}` Constant Columns\\n\".format(len(colsToRemove)))\nprint(colsToRemove)","eb3dd331":"# from sklearn.experimental import enable_iterative_imputer\n# from sklearn.impute import IterativeImputer\n# from sklearn.linear_model import BayesianRidge\n# imputer = IterativeImputer(estimator=BayesianRidge(), missing_values=np.nan, sample_posterior=False, \n#                                  max_iter=4000, tol=0.001, verbose=1,\n#                                  n_nearest_features=4, initial_strategy='median')\nfrom sklearn.impute import KNNImputer\nimp_features = ['Pclass', 'Sex', 'Age', 'SibSp', 'Parch', 'Fare', 'Title',\n                 'Name_Length', 'Emb_C', 'Emb_Q', 'Emb_S','Family_Size',\n                 'Fsize_Cat', 'Family_Friends_Surv_Rate', 'Surv_Rate_Invalid',\n                 'Cabin_Clean','Ticket_Frequency', 'Tkt_AS', 'Tkt_C', 'Tkt_CA',\n                 'Tkt_CASOTON', 'Tkt_FC', 'Tkt_FCC', 'Tkt_Fa', 'Tkt_LINE',\n                 'Tkt_NUM', 'Tkt_PC', 'Tkt_PP', 'Tkt_PPP', 'Tkt_SC', 'Tkt_SCA',\n                 'Tkt_SCAH', 'Tkt_SCAHBasle', 'Tkt_SCOW', 'Tkt_SCPARIS', 'Tkt_SCParis',\n                 'Tkt_SOC', 'Tkt_SOP', 'Tkt_SOPP', 'Tkt_SOTONO', 'Tkt_SOTONOQ',\n                 'Tkt_SP', 'Tkt_STONO', 'Tkt_SWPP', 'Tkt_WC', \n                 'Tkt_WEP', 'Fare_Cat', 'Fare_Family_Size', 'Fare_Cat_Pclass',\n                 'Fare_Cat_Title', 'Fsize_Cat_Title', 'Fsize_Cat_Fare_Cat', \n                 'Pclass_Title', 'Fsize_Cat_Pclass']\n\nimputer = KNNImputer(n_neighbors=10, missing_values=np.nan)\n# full_df[imp_features] = pd.DataFrame(imputer.fit_transform(full_df[imp_features]), index=full_df.index, columns = imp_features)\nimputer.fit(full_df[imp_features])","ec244661":"full_df.loc[:, imp_features] = pd.DataFrame(imputer.transform(full_df[imp_features]), index=full_df.index, columns = imp_features)","8a4885d5":"plt.figure(figsize=(22,8))\nkde = sns.kdeplot(x=\"Age\", data=df_train, cut=0, hue=\"Survived\", fill=True, legend=True, palette=\"terrain_r\")\n#kde.title.set_text(\"Age by Survived Before Imputation\")\ntitle = kde.set_title(\"AGE BY SURVIVED BEFORE IMPUTATION\", x=0.0, y=1.03, ha='left',\n             fontweight=100, fontfamily='Lato',\n             size=41)\n\nkde.xaxis.set_major_locator(ticker.MultipleLocator(1))\nkde.xaxis.set_major_formatter(ticker.ScalarFormatter())","16e58b30":"plt.figure(figsize=(23,8))\nkde = sns.kdeplot(x=\"Age\", data=full_df[:train_shape[0]], cut=0, hue=\"Survived\", fill=True, legend=True, palette=\"terrain_r\")\n\ntitle = kde.set_title(\"AGE BY SURVIVED AFTER IMPUTATION\", x=0.0, y=1.01, ha='left',\n             fontweight=100, fontfamily='Lato', size=41)\n\nkde.xaxis.set_major_locator(ticker.MultipleLocator(1))\nkde.xaxis.set_major_formatter(ticker.ScalarFormatter())","947f8465":"df_train[df_train.Age.isnull()].head(5)","06890a1c":"tmp = full_df[:train_shape[0]]\nage_nan_indices = df_train[df_train.Age.isnull()].index.tolist()\ntmp.iloc[age_nan_indices, :].head(5)","03a53544":"full_df['Child'] = full_df['Age'].map(lambda val:1 if val<18 else 0)\nfull_df['Senior'] = full_df['Age'].map(lambda val:1 if val>70 else 0)\n\nfig, ax = plt.subplots(ncols=2, figsize=(23,8))\n\nfor i, col in enumerate(['Child', 'Senior']):\n    sns.histplot(x=col, hue='Survived', data=full_df[:train_shape[0]],\n                 ax=ax[i], fill=True, palette=\"Paired_r\", kde=True)\n    ax[i].set_title(col.upper()+\" BY SURVIVED\", x=0.0, y=1.01, ha='left',\n         fontweight=200, fontfamily='Lato', size=39)","d20f362b":"df_train_final = full_df[:train_shape[0]]\ndf_test_final = full_df[train_shape[0]:]","c635685d":"viz_features = ['PassengerId', 'Survived', 'Pclass', 'Name', 'Sex',\n                'Age', 'SibSp','Parch', 'Ticket', 'Fare', 'Cabin',\n                'Title', 'Name_Length', 'Family_Friends_Surv_Rate', \n                'Ticket_Frequency']\n\ntrain_viz = df_train_final[viz_features]","5f5a643f":"fig = px.scatter(train_viz,\n                 x=\"Name_Length\", y=\"Family_Friends_Surv_Rate\", color=\"Survived\", size=\"Pclass\",\n                 size_max=8, color_continuous_scale=['maroon', 'mediumaquamarine'],\n                 marginal_x='histogram', marginal_y='histogram',\n                 template='plotly', title='<span style=\"font-weight: 100;\">NAME_LENGTH VS SURV_RATE BY SURVIVED<\/span>')\n\nfig.update_layout(\n    title_x=0.08,\n    title_font_size=30,\n    title_font_color='black'\n)\n\nfig.show()","a62e6947":"fig = px.scatter(train_viz,\n                 x=\"Name_Length\", y=\"Ticket_Frequency\", color=\"Survived\", size=\"Pclass\",\n                 size_max=8, color_continuous_scale=['goldenrod', 'cadetblue'],\n                 marginal_x='histogram', marginal_y='histogram',\n                 template='plotly', title='<span style=\"font-weight: 100;\">NAME_LENGTH VS TKT_FREQ BY SURVIVED<\/span>')\n\nfig.update_layout(\n    title_x=0.08,\n    title_font_size=30,\n    title_font_color='black'\n)\n\nfig.show()","4fd69ceb":"full_df.to_pickle(\"full_df\")\ndf_train_final.to_pickle(\"df_train_final\")\ndf_test_final.to_pickle(\"df_test_final\")","2b0c27c5":"# df_train_final = pd.read_pickle(\"..\/input\/titanic-test\/df_train_final\")\n# df_test_final = pd.read_pickle(\"..\/input\/titanic-test\/df_test_final\")","71277cf9":"from sklearn.preprocessing import StandardScaler\nscaler_cols = ['Age', 'Fare', 'Name_Length', 'Family_Size', 'Name_Length',\n               'Ticket_Frequency', 'Fare_Family_Size', 'Fare_Cat_Pclass']\nstd = StandardScaler()\nstd.fit(df_train_final[scaler_cols])\ndf_train_final.loc[:, scaler_cols] = pd.DataFrame(std.transform(df_train_final[scaler_cols]), index=df_train_final.index, columns = scaler_cols)\ndf_test_final.loc[:, scaler_cols] = pd.DataFrame(std.transform(df_test_final[scaler_cols]), index=df_test_final.index, columns = scaler_cols)","4977e0ef":"df_train_final.describe()","43dde02e":"features = ['Pclass', 'Sex', 'Age', 'Fare', 'Title', 'Name_Length', 'Emb_C',\n       'Emb_Q', 'Emb_S', 'Title_Master', 'Title_Miss', 'Title_Mr', 'Title_Mrs',\n       'Title_Other', 'Title_Royal', 'Family_Size', 'Fsize_Cat',\n       'Family_Friends_Surv_Rate', 'Surv_Rate_Invalid', 'Cabin_Clean',\n       'Ticket_Frequency', 'Tkt_AS', 'Tkt_C', 'Tkt_CA',\n       'Tkt_CASOTON', 'Tkt_FC', 'Tkt_FCC', 'Tkt_Fa', 'Tkt_LINE', \n       'Tkt_NUM', 'Tkt_PC', 'Tkt_PP', 'Tkt_PPP', 'Tkt_SC', 'Tkt_SCA',\n       'Tkt_SCAH', 'Tkt_SCAHBasle', 'Tkt_SCOW', 'Tkt_SCPARIS', 'Tkt_SCParis',\n       'Tkt_SOC', 'Tkt_SOP', 'Tkt_SOPP', 'Tkt_SOTONO', 'Tkt_SOTONOQ', 'Tkt_SP',\n       'Tkt_STONO', 'Tkt_SWPP', 'Tkt_WC', 'Tkt_WEP', 'Fare_Cat',\n       'Fare_Family_Size', 'Fare_Cat_Pclass', 'Fare_Cat_Title',\n       'Fsize_Cat_Title', 'Fsize_Cat_Fare_Cat', 'Pclass_Title',\n       'Fsize_Cat_Pclass', 'Child', 'Senior']\nfeatures_train = ['Survived', 'Pclass', 'Sex', 'Age', 'Fare', 'Title', 'Name_Length', 'Emb_C',\n       'Emb_Q', 'Emb_S', 'Title_Master', 'Title_Miss', 'Title_Mr', 'Title_Mrs',\n       'Title_Other', 'Title_Royal', 'Family_Size', 'Fsize_Cat',\n       'Family_Friends_Surv_Rate', 'Surv_Rate_Invalid', 'Cabin_Clean',\n       'Ticket_Frequency', 'Tkt_AS', 'Tkt_C', 'Tkt_CA',\n       'Tkt_CASOTON', 'Tkt_FC', 'Tkt_FCC', 'Tkt_Fa', 'Tkt_LINE',\n       'Tkt_NUM', 'Tkt_PC', 'Tkt_PP', 'Tkt_PPP', 'Tkt_SC', 'Tkt_SCA',\n       'Tkt_SCAH', 'Tkt_SCAHBasle', 'Tkt_SCOW', 'Tkt_SCPARIS', 'Tkt_SCParis',\n       'Tkt_SOC', 'Tkt_SOP', 'Tkt_SOPP', 'Tkt_SOTONO', 'Tkt_SOTONOQ', 'Tkt_SP',\n       'Tkt_STONO', 'Tkt_SWPP', 'Tkt_WC', 'Tkt_WEP', 'Fare_Cat',\n       'Fare_Family_Size', 'Fare_Cat_Pclass', 'Fare_Cat_Title',\n       'Fsize_Cat_Title', 'Fsize_Cat_Fare_Cat', 'Pclass_Title',\n       'Fsize_Cat_Pclass', 'Child', 'Senior']\n\ndf_train_final = df_train_final[features_train]\ndf_test_final = df_test_final[features]","55946b8e":"corr_mat = df_train_final.astype(float).corr()\ncorr_mat_fil = corr_mat.loc[:, 'Survived'].sort_values(ascending=False)\ncorr_mat_fil = pd.DataFrame(data=corr_mat_fil[1:])","cefba030":"plt.figure(figsize=(15,14))\nbar = sns.barplot(x=corr_mat_fil.Survived, y=corr_mat_fil.index, data=corr_mat_fil, palette=\"Spectral\")\ntitle = bar.set_title(\"FEATURE CORRELATION\", x=0.0, y=1.01, ha='left',\n             fontweight=100, fontfamily='Lato', size=30)\n","23f5010e":"features = df_test_final.columns.to_list()\nX_train = df_train_final[features]\nY_train = df_train_final['Survived']\nX_test = df_test_final","649b521a":"from sklearn.model_selection import cross_val_predict, cross_val_score, cross_validate\nfrom sklearn.model_selection import StratifiedKFold, StratifiedShuffleSplit\nfrom sklearn.metrics import confusion_matrix, roc_curve\nfrom sklearn.metrics import precision_score, recall_score, f1_score\n\nimport tensorflow as tf\nfrom tensorflow import keras\nfrom tensorflow.keras.wrappers.scikit_learn import KerasClassifier\nfrom tensorflow.keras.models import Sequential\nfrom tensorflow.keras.utils import plot_model\nfrom tensorflow.keras.layers import Input, Dense, Dropout, AlphaDropout, BatchNormalization,Concatenate, concatenate\nfrom tensorflow.keras.optimizers import SGD, RMSprop, Adamax, Adagrad, Adam, Nadam, SGD\nfrom tensorflow.keras.regularizers import l2\nfrom tensorflow.keras.callbacks import ReduceLROnPlateau, EarlyStopping\nfrom tensorflow.keras.metrics import *","ec040047":"metrics = ['accuracy', \n           Precision(),\n           Recall()]","07cb2ebe":"def create_model():\n    model = Sequential()\n    model.add(Input(shape=X_train.shape[1], name='Input_'))\n    model.add(Dense(8, activation='relu', kernel_initializer='glorot_normal', kernel_regularizer=l2(0.001)))\n    model.add(Dense(16, activation='relu', kernel_initializer='glorot_normal', kernel_regularizer=l2(0.1)))\n    model.add(Dropout(0.5))\n    model.add(Dense(16, activation='relu', kernel_initializer='glorot_normal', kernel_regularizer=l2(0.1)))\n    model.add(Dropout(0.5))\n    model.add(Dense(1, activation='sigmoid', kernel_initializer='glorot_normal'))\n\n    model.summary()\n    optimize = Adam(lr = 0.0001)\n    model.compile(optimizer = optimize, \n                       loss = 'binary_crossentropy', \n                       metrics = metrics)\n    return model","c0385f18":"estimator = KerasClassifier(build_fn = create_model, epochs = 600, batch_size = 32, verbose = 1)\nkfold = StratifiedKFold(n_splits = 3)\nresults = cross_val_score(estimator, X_train, Y_train, cv = kfold)","08fa42a6":"train_history = estimator.fit(X_train, Y_train, epochs = 600, batch_size = 32)","cadeca02":"print(train_history.history.keys())","1b6e917f":"fig = plt.figure(figsize=(22,8))\nhist = sns.lineplot(data=train_history.history['accuracy'], color=\"darkturquoise\", label='Accuracy')\nhist = sns.lineplot(data=train_history.history['loss'], color=\"chocolate\", label='Loss')\nhist = sns.lineplot(data=train_history.history['recall'], color=\"indianred\", label='Recall')\n\ntitle = fig.suptitle(\"ACCURACY VS LOSS VS RECALL CUREVES\", x=0.125, y=1.01, ha='left',\n             fontweight=100, fontfamily='Lato', size=37)\n\nhist.xaxis.set_major_locator(ticker.MultipleLocator(20))\nhist.xaxis.set_major_formatter(ticker.ScalarFormatter())\n\nplt.legend()\nplt.show()","7adf589c":"y_preds = estimator.predict(X_test)\nsubmission = pd.read_csv(\"..\/input\/titanic\/gender_submission.csv\", index_col='PassengerId')\nsubmission['Survived'] = y_preds.astype(int)\nsubmission.to_csv('submission.csv')","765e6576":"<a id=\"corr\"><\/a>\n# 6. Checking Feature Importance by Correlation Analysis","5a887e7c":"<a id=\"famsurv\"><\/a>\n## 4.7 Derive Friends & Family Survival Rate Feature","13e60bc4":"<a id=\"length\"><\/a>\n### 4.2.2 Extract Name Length Feature from Name\n\nThe basic intuition behind this feature is that people with longer names tends to be of a higher class and thus would have likely survived. ","ee6b9230":"### Library Imports","32ac936b":"\nBehaviour of fare seems different before and after the value 39","1e61c52a":"\n<p style='text-align: left;'><span style=\"color: #0D0D0D; font-family: Segoe UI; font-size: 2.4em; font-weight: 300;\">THE TITANIC WRECKAGE MAY COMPLETELY VANISH BY 2030\nBUT, LET US ALL KEEP THE LEGACY ALIVE<\/span><\/p>\n\n\n![](https:\/\/i.pinimg.com\/originals\/a4\/08\/ef\/a408efc7cea165569dbd57826278fc8d.jpg)\n","8ec8a293":"<a id=\"morefe\"><\/a>\n# 5. Data Cleaning & More Feature Engineering\n## 5.1 Cleaning & Encoding of the Cabin","d81cc53e":"<a id=\"farecat\"><\/a>\n## 5.5 Fare into Categorical Bins\n\nKernal density estimation plot of Fare gave us some insights on its distribution and impact on survival. We will use those to add a derived categorical feature from Fare.","5bc7befb":"<a id=\"pclasssex\"><\/a>\n## 3.3 Analysis of Pclass & Sex\n\nWe see differences in survival rate for Class 1 and Class 3 passengers.\n\nWe also notice that the Men seems to have a low survival rate.","4d02cd04":"<a id=\"mis\"><\/a>\n## 5.7 Imputation of Missing Age Values","3e1fac6a":"<a id=\"feparsib\"><\/a>\n## 4.4 Derive Family Size Feature","d1557645":"<a id=\"mdev\"><\/a>\n# 8. Model Development","6f486da5":"<a id=\"mbul\"><\/a>\n## 8.1 Model Architecture Definition","4c39b0b6":"<a id=\"rel\"><\/a>\n## 3.6 Exploration of Feature Relationships\n\nThe relationships of features and their behaviour can be used later to derive new features.","837728f8":"<a id=\"trte\"><\/a>\n# 7. Preparation of Train & Test Data","20e74d99":"<a id=\"der\"><\/a>\n## 5.6 Additional Derived Features from Feature Relationships","dba73419":"<a id=\"envprep\"><\/a>\n# 2. Environment Preparation\n### Updating Seaborn to the Version 0.11.0\n","16b739fe":"<a id=\"fare\"><\/a>\n## 3.2 Exploration of Fare\n","f64c3e31":"<span style=\"color: #221E1F; font-family: Trebuchet MS; font-size: 2.2em;\">Contents<\/span>\n\n\n* [1. Introduction](#introduction)\n* [2. Environment Preparation](#envprep)\n* [3. A bit of Exploratory Data Analysis](#eda)\n    - [3.1 Analysis of Age](#aoa)\n    - [3.2 Exploration of Fare ](#fare)\n    - [3.4 Analysis of Pclass & Sex](#pclasssex)\n    - [3.5 Analysis of SibSp & Panrh](#sibpar)\n    - [3.6 Few more plots of Feature densities](#density)\n    - [3.7 Exploration of Feature Relationships](#rel)\n* [4. Feature Engineering & EDA Extended](#fe)\n    - [4.1 Encoding of Sex](#ensex)\n    - [4.2 Let's Analyze & Feature Engineer Name](#name)\n        - [4.2.1 Derive & Plot the Title Feature](#name)\n        - [4.2.2 Extract Name Length Feature from Name](#length)\n    - [4.3 One-hot Encode Embarked & Label Encode Title](#oneone)\n    - [4.4 Derive Family Size Feature](#feparsib)\n    - [4.5 Label Encoding of Family Size](#encfam)\n    - [4.6 Extract Family_Name Feature from Name](#famname)\n    - [4.7 Derive Friends & Family Survival Rate Feature](#famsurv)\n* [5. Data Cleaning & More Feature Engineering](#morefe)\n    - [5.1 Cleaning & Encoding of the Cabin](#morefe)\n    - [5.2 Cleaning the Ticket](#cltik)\n    - [5.3 Derive the Ticket Frequency](#ticfea)\n    - [5.4 One-hot Encoding Ticket](#onetick)\n    - [5.5 Fare into Categorical Bins ](#farecat)\n    - [5.6 Additional Derived Features from Feature Relationships](#der)\n    - [5.7 Imputation of Missing Age Values](#mis)\n    - [5.8 Obtain Features for Children & Seniors](#chilsen)\n    - [5.9 Exploration of Derived Features](#eder)\n    - [5.10 Pickle & Store Dataframes for Later](#pik)\n    - [5.11 Standard Scaling Data](#sca)\n    - [5.12 Select Features for Training](#sel)\n* [6. Checking Feature Importance by Correlation Analysis](#corr)\n* [7. Preparation of Train & Test Data](#trte)\n* [8. Model Development](#mdev)\n    - [8.1 Model Architecture Definition](#mbul)\n    - [8.2 Setting Cross-validation Scheme & Model Training](#cross)\n    - [8.3 Plot the Model Metric Trends](#mloss)\n* [9. Submission File Generation\t](#subfil)","bbbc48ee":"<a id=\"encfam\"><\/a>\n## 4.5 Label Encoding Family Size","e1039b3c":"<a id=\"introduction\"><\/a>\n# 1. Introduction\n\n**The reason for using a Multi-layer Perceptron or a Feed-forward Neural network was to exploit and showcase its amazing potential and capabilities if it is tuned just right with sufficient regularization.**\n\nThrougout the notebook, I have detailed out the Exploratory Data Analysis and the Feature Engineering that was carried out to best bring out the capabilities of MLPs.\n\nTuning a Neural Network with just the right amount of regularization and giving the right features to obtain an optimal low variance and bias to maximize the accuracy is a very complex and time-consuming task especially given the limited samples and nature of the dataset.\n\nHowever, I admit that investing time tuning an XGboost, KKN or other ensemble models is much more worthwhile in time-bound situations and Neural Networks may not be the best choice but, proper application of techniques with good feature engineering and driving the Model to a good local minimum with a lot of regularization yielded a great performance.\n\n**I tried Neural Network Ensembling, Mean Encoding, Grid Search, Bayesian Optimization and several other approaches to improve the model and find the best Hyperparameters at times but, the lack of options to find a representative cross-validation scheme which mimics the Public leaderboard split to represent some sort of dependancy in the model metrics was a difficult task.**\n\n**Finally, I ended up babysitting the model with manual tuning techniques to intuitively find the best hyperparameters and a single model tuned and regularized well was capable of representing the non-linear decision boundaries of the data and give the best performance.**\n\n<span style=\"color: #056e94; font-family: Trebuchet MS; font-size: 1.3em;\">I will keep updating this notebook with further details of the implementation. Thanks to the Kaggle commmunity and staff for all the support.<\/span>\n\n<span style=\"color: #056e94; font-family: Trebuchet MS; font-size: 1.3em;\">Please upvote and comment if you like my work :)<\/span>\n\n\n\n[![Ask Me Anything !](https:\/\/img.shields.io\/badge\/Ask%20me-anything-1abc9c.svg?style=flat-square&logo=kaggle)](https:\/\/www.kaggle.com\/sreevishnudamodaran)\n\n\n\n\n![TPU!](https:\/\/img.shields.io\/badge\/Accelerator-GPU-orange?style=flat-square&logo=kaggle)\n\n![Upvote!](https:\/\/img.shields.io\/badge\/Upvote-If%20you%20like%20my%20work-07b3c8?style=for-the-badge&logo=kaggle)\n\n\n\n#### Details & Description of Features:\n\n* PassengerID\n* Survived - (0 = No, 1 = Yes)\n* Pclass - Passenger Class (1 = 1st, 2 = 2nd, 3 = 3rd)\n* Name\n* Sex\n* Age\n* SibSp - Number of Siblings\/Spouses Aboard\n* Parch - Number of Parents\/Children Aboard\n* Ticket - Ticket Number\n* Fare - Passenger Fare in British pound\n* Cabin - Cabin Number\n* Embarked - Port of Embarkation (C = Cherbourg, Q = Queenstown, S = Southampton)\n<br \/>\n<br \/>\n\n#### Additional Notes:\n* Pclassis a proxy for socio-economic status (SES) : 1st ~ Upper, 2nd ~ Middle, 3rd ~ Lower\n* Fare is in Pre-1970 British Pounds : Conversion Factors:  \u00a31 = 12s (shillings) = 240d (pence) and 1s = 20d \n* Sibling : Brother, Sister, Stepbrother, or Stepsister of Passenger Aboard Titanic\n* Spouse : Husband or Wife of Passenger Aboard Titanic (Mistresses and Fiances Ignored)\n* Parent : Mother or Father of Passenger Aboard Titanic\n* Child : Son, Daughter, Stepson, or Stepdaughter of Passenger Aboard Titanic\n\n","c8767c03":"<a id=\"cltik\"><\/a>\n## 5.2 Cleaning the Ticket","c59201fa":"<a id=\"ticfea\"><\/a>\n## 5.3 Derive the Ticket Frequency","815cf8d3":"<a id=\"oneone\"><\/a>\n## 4.3 One-hot Encode Embarked & Label Encode Title\n\nAlthough Title is one-hot encodeded, it is also label encoded to a categorical feature to help derive other features later.","3bb1e499":"<a id=\"mloss\"><\/a>\n## 8.3 Plot the Model Metric Trends","c9a02655":"<a id=\"eda\"><\/a>\n# 3. A bit of Exploratory Data Analysis\n### Converting Appropriate Columns to Categorical Type","018079be":"### Import Libraries","e5be43eb":"<a id=\"chilsen\"><\/a>\n## 5.8 Obtain Features for Children & Seniors","8dae01ef":"<a id=\"ensex\"><\/a>\n## 4.1 The Encoding of Sex","2d360b68":"### Split Data back to Train and Test","abf9229b":"<a id=\"pik\"><\/a>\n## 5.10 Pickle & Store Dataframes for Later","e5ea7776":"<a id=\"subfil\"><\/a>\n# 9. Submission File Generation","89a79b37":"<a id=\"name\"><\/a>\n## 4.2 Let's Analyze & Feature Engineer Name\n### 4.2.1 Derive & Plot the Title Feature","ea0990c6":"Using Regex to get the Surname or the Last Name from the Name Feature","ae96ab58":"<a id=\"aoa\"><\/a>\n## 3.1 Analysis of Age\n\nWe see that survival rate is is different for passengers below age 9 and above age 74. We will use these limits later to categorize and derive new features.","b6d6919d":"<a id=\"fe\"><\/a>\n# 4. Feature Engineering & EDA Extended\n### Merge Train & Test for Tranformations ","71f8952f":"<a id=\"density\"><\/a>\n## 3.5 Few more plots of Feature densities\n","61339b3d":"### Train the model on full data","a1dc4284":"<a id=\"eder\"><\/a>\n## 5.9 Exploration of Derived Features","fd8438dd":"<a id=\"onetick\"><\/a>\n## 5.4 One-hot Encoding Ticket","77845dae":"### Comparing Before and After Imputed Dataframes","38f96e4e":"<a id=\"sel\"><\/a>\n## 5.12 Select Features for Training","054e33be":"<a id=\"sca\"><\/a>\n## 5.11 Standard Scaling Data","225fc51c":"<a id=\"sibpar\"><\/a>\n## 3.4 Analysis of SibSp & Panch\n\nPassengers without Siblings\/Spouse and Parents\/Children accompanying them seems to have a low survival rate.","41459a27":"### Remove Constant Columns","c1489558":"<a id=\"famname\"><\/a>\n## 4.6 Extract Family_Name Feature from Name","3df78b94":"<a id=\"cross\"><\/a>\n## 8.2 Setting Cross-validation Scheme & Model Training","e76960e9":"This seems to be one of the key features that improves scores after a lot of submissions engineering different features each time. \n\nIf passengers with the same Last names are present, we group them and attach a calculated survival rate based on the train survival data. \n\nFor no matching last names, the Ticket feature is used to group and calculate the survival rate in the same way.\n\nFrom the data, we see Tickets are given to groups travelling together and they all have the same Ticket number."}}