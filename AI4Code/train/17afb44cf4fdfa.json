{"cell_type":{"de6b7c31":"code","e8c1b291":"code","ac309598":"code","fb8e3976":"code","50aa89a6":"code","f1e89a22":"code","7f44893a":"code","7ad61348":"code","1feb5147":"code","de81364e":"code","64996eed":"markdown","e002d30f":"markdown","4c108ff6":"markdown","2f0d0c14":"markdown","4a7ae454":"markdown","9839ac72":"markdown","33bd2944":"markdown","8472902f":"markdown"},"source":{"de6b7c31":"import numpy as np \nimport pandas as pd \nimport os\n\nfrom sklearn import model_selection as sk_model_selection\nfrom sklearn.feature_extraction import text as sk_fe_text\nfrom sklearn import svm as sk_svm\nfrom sklearn import metrics as sk_metrics","e8c1b291":"base_dir = '..\/input\/nlp-getting-started\/'\ndf_train = pd.read_csv(os.path.join(base_dir, 'train.csv'))\ndf_test = pd.read_csv(os.path.join(base_dir, 'test.csv'))\ndf_submission = pd.read_csv(os.path.join(base_dir, 'sample_submission.csv'))","ac309598":"print(f'df_train shape: {df_train.shape}')\ndf_train.head()","fb8e3976":"df_train.isna().sum()","50aa89a6":"X_train = df_train[\"text\"]\ny_train = df_train[\"target\"].values","f1e89a22":"tfidf = sk_fe_text.TfidfVectorizer(stop_words = 'english')\ntfidf.fit(X_train)\nX_train = tfidf.transform(X_train)","7f44893a":"parameters = { \n    'C': [0.01, 0.1, 1],\n    'gamma': [0.7, 1, 'auto', 'scale']\n}\n\nmodel = sk_svm.SVC(\n    kernel='rbf', \n    class_weight='balanced',\n    random_state=42,\n)\n\nmodel = sk_model_selection.GridSearchCV(\n    model, \n    parameters, \n    cv=5,\n    scoring='f1',\n    n_jobs=-1,\n)\n\nmodel.fit(X_train, y_train)\n\nprint(f'Best parameters: {model.best_params_}')\nprint(f'Mean cross-validated F1 score of the best_estimator: {model.best_score_:.3f}')","7ad61348":"X_test = df_test[\"text\"]\nX_test = tfidf.transform(X_test)\ny_test_pred = model.predict(X_test)","1feb5147":"df_submission[\"target\"] = y_test_pred\ndf_submission.to_csv(\"submission.csv\",index=False)","de81364e":"df_submission","64996eed":"<a id=\"2\"><\/a>\n<h2 style='background:#FA497A; border:0; color:white'><center>TF-IDF preprocessing<center><h2>\n","e002d30f":"<a id=\"3\"><\/a>\n<h2 style='background:#FA497A; border:0; color:white'><center>SVM Training<center><h2>\n","4c108ff6":"Using GridSearchCV to find the best parameters for SVM","2f0d0c14":"<a id=\"1\"><\/a>\n<h2 style='background:#FA497A; border:0; color:white'><center>Data Loading<center><h2>","4a7ae454":"<a id=\"100\"><\/a>\n<h2 style='background:#FA497A; border:0; color:white'><center>Submission<center><h2>","9839ac72":"# Disaster Tweets - NLP Beginner\n\nPredict which Tweets are about real disasters and which ones are not","33bd2944":"<a id=\"top\"><\/a>\n\n<div class=\"list-group\" id=\"list-tab\" role=\"tablist\">\n<h3 class=\"list-group-item list-group-item-action active\" data-toggle=\"list\" style='color:white; background:#FA497A; border:0' role=\"tab\" aria-controls=\"home\"><center>Quick Navigation<\/center><\/h3>\n\n* [Data Loading](#1)\n* [TF-IDF Preprocessing](#2)\n* [SVM Training](#3)\n* [Submission](#100)","8472902f":"![](https:\/\/storage.googleapis.com\/kaggle-media\/competitions\/nlp1-cover.jpg)"}}