{"cell_type":{"13262cf0":"code","1ccccb00":"code","4a9374f5":"code","42981c89":"code","488b1908":"code","26609ae3":"markdown","804dfa91":"markdown","c827d982":"markdown","58091afe":"markdown"},"source":{"13262cf0":"import pandas as pd \nfrom datetime import datetime\n\ndf = pd.read_csv(\"..\/input\/bank-customer-segmentation\/bank_transactions.csv\")\ndf.head()","1ccccb00":"df['CustomerDOB'] = pd.to_datetime(df['CustomerDOB'])\ndf['TransactionDate'] = pd.to_datetime(df['TransactionDate'])\n\ndf['CustomerAge_atTxn'] = df.apply(lambda x : x['TransactionDate'] - x['CustomerDOB'], axis = 1)\ndf['Amount_percentage_of_Balance'] = df['TransactionAmount (INR)'] \/ df['CustAccountBalance']\ndf['TransactionTime'] = df['TransactionTime'].apply(lambda x : datetime.utcfromtimestamp(int(x)).strftime('%H:%M:%S'))\n\ndf['CustomerAge_atTxn'] = df['CustomerAge_atTxn'].apply(lambda x : str(x).split()[0])\ndf = df[df['CustomerAge_atTxn'] != 'NaT']\ndf['CustomerAge_atTxn'] = df['CustomerAge_atTxn'].astype(int)\n\ndf = df[df['CustomerAge_atTxn'] > 6570]\ndf = df[df['CustomerAge_atTxn'] < 36500]\n\ndf['TransactionHour'] = df['TransactionTime'].apply(lambda x : x.split(\":\")[0])\ndf['TransactionSeconds'] = df['TransactionTime'].apply(lambda x : x.split(\":\")[1])\n\ndf['CustAccountBalance'] = df['CustAccountBalance'].astype(float)\ndf['TransactionAmount (INR)'] = df['TransactionAmount (INR)'].astype(float)\n\ndf['CustomerAge_atTxn'] = df['CustomerAge_atTxn'].astype(float)\ndf['Amount_percentage_of_Balance'] = df['Amount_percentage_of_Balance'].astype(float)\ndf['TransactionHour'] = df['TransactionHour'].astype(float)\ndf['TransactionSeconds'] = df['TransactionSeconds'].astype(float)","4a9374f5":"user_df = df.groupby(\"CustomerID\").agg({\n                                        \"TransactionID\" : \"count\",\n                                        \"CustGender\" : \"first\",\n                                        # \"CustLocation\" : lambda x : \"|\".join(str(x)),\n                                        \"CustAccountBalance\"  : \"mean\",\n                                        \"TransactionAmount (INR)\" : \"mean\",\n                                        \"CustomerAge_atTxn\" : \"mean\",\n                                        \"Amount_percentage_of_Balance\" : \"max\",\n                                        \"TransactionHour\" : \"mean\",\n                                        \"TransactionSeconds\" : \"mean\"\n                        })\n\nuser_df = user_df.reset_index()\nuser_df.head()","42981c89":"## TO ADD ","488b1908":"## THIS NOTEbook is work in progress, will be updating it shortly \n## In the mean time feel free to check this new dataset ","26609ae3":"Other datasets to extend city information \n\n- https:\/\/www.kaggle.com\/zed9941\/top-500-indian-cities\n- https:\/\/www.kaggle.com\/parulpandey\/indian-cities-database","804dfa91":"## Customer Segmentation ","c827d982":"## Feature Engineering and Data Cleaning","58091afe":"## Bank Customer Segmentation\n\nLet's take a look at the dataset"}}