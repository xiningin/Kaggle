{"cell_type":{"63bf79e6":"code","ff0e4952":"code","fae4a6f5":"code","29c99ee6":"code","f737939c":"code","685e59a8":"code","9df21a3e":"code","eb0b9f2f":"code","98e869e6":"code","a7eab680":"markdown"},"source":{"63bf79e6":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","ff0e4952":"import torch\nfrom torch.utils.data import DataLoader, Dataset","fae4a6f5":"class my_dataset(Dataset):\n   \n    def __init__(self, res):        \n        self.res = res\n    \n    def __len__(self):\n        return N_ELEM\n    \n    def __getitem__(self, idx):\n        return torch.rand(3,self.res, self.res)","29c99ee6":"N_ELEM = 64\nBATCH_SIZE = 16","f737939c":"dataset_loader = DataLoader(my_dataset(256), \n                            batch_size=BATCH_SIZE,\n                            shuffle=False, \n                            num_workers=2)","685e59a8":"%%time\nfor i_batch, sample in enumerate(dataset_loader):\n    sample = sample*2","9df21a3e":"dataset_loader = DataLoader(my_dataset(756), \n                            batch_size=BATCH_SIZE,\n                            shuffle=False,\n                            num_workers=2)","eb0b9f2f":"%%time\nfor i_batch, sample in enumerate(dataset_loader):\n    sample = sample*2","98e869e6":"!df -h","a7eab680":"[https:\/\/github.com\/pytorch\/pytorch\/issues\/5040](https:\/\/github.com\/pytorch\/pytorch\/issues\/5040)"}}