{"cell_type":{"0ff4e9fc":"code","31b4f845":"code","47c352c2":"code","a564ad98":"code","51ecaeb3":"code","6bfb4bac":"code","e60e2bfe":"code","3851137b":"code","f8e47522":"code","4d4581dc":"code","eda873da":"code","ea82b664":"code","df9cf37e":"code","f7f8d565":"markdown","83779949":"markdown","5091c006":"markdown","63cf457d":"markdown","c8d7ca88":"markdown","740ef3ba":"markdown"},"source":{"0ff4e9fc":"import pandas as pd\nimport numpy as np\nimport altair as alt\nalt.renderers.enable('kaggle')","31b4f845":"def projects_monthly(dataset, from_date, project_list):\n    resolved2019 = dataset[dataset[\"resolved\"] > from_date]\n\n    top_resolved_2019 = resolved2019[resolved2019[\"project\"].isin(project_list)]\n\n    monthly_project = top_resolved_2019[[\"key\",\"project\"]].groupby([top_resolved_2019[\"resolved\"].dt.to_period(\"M\"),\"project\"]).count();\n    monthly_project = monthly_project.reset_index().set_index(\"resolved\").to_timestamp().reset_index()\n    return monthly_project\n\nplot_height=450\nplot_width=600","47c352c2":"pd.set_option('display.max_rows', 500)\nfile = \"\/kaggle\/input\/apache-software-foundation-contribution-statistics\/jira.csv\"\nissues = pd.read_csv(file,names=[\"key\",\"id\",\"summary\",\"author\",\"assignee\",\"created\",\"updated\",\"resolved\",\"resolution\",\"status\" ])\nissues.resolved = pd.to_datetime(issues.resolved)\nissues.created = pd.to_datetime(issues.created)\n\nissues[\"project\"] = issues.key.apply(lambda key: key.split(\"-\")[0])\n\nhadoop_issues = issues[issues[\"project\"].isin([\"HDDS\",\"HDFS\",\"MAPREDUCE\",\"YARN\",\"SUBMARINE\",\"HADOOP\"])]\n\nresolved = hadoop_issues[hadoop_issues[\"resolved\"].notnull()]\nresolved = resolved[resolved[\"status\"].isin([\"Closed\",\"Done\",\"Resolved\"])]\nresolved = resolved[resolved[\"resolution\"].isin([\"Done\",\"Fixed\",\"Resolved\",\"Implemented\",\"Information Provided\",\"Workaround\",\"Delivered\"])]\n","a564ad98":"show = resolved[resolved[\"resolved\"] > \"2018-01-01\"]\nshow = show.groupby([resolved[\"resolved\"].dt.to_period(\"M\"),\"project\"]).count()\ndel show[\"resolved\"]\nshow = show.reset_index().set_index(\"resolved\").to_timestamp().reset_index()\n\nprojects_monthly(resolved, \"2018-01-01\",[\"HDFS\",\"HDDS\",\"YARN\",\"MAPREDUCE\",\"HADOOP\",\"SUBMARINE\"])\n\nalt.Chart(show).mark_area().encode(\n    x=alt.X(\"resolved:T\",axis=alt.Axis(title=\"month\")),\n    y=alt.Y(\"key:Q\",stack=\"normalize\",axis=alt.Axis(title='# of resolved issues')),\n    color=\"project:N\"\n).configure_view(\n       height=plot_height,\n       width=plot_width,  \n    )","51ecaeb3":"show = resolved[resolved[\"resolved\"] > \"2018-01-01\"]\nshow = show.groupby([resolved[\"resolved\"].dt.to_period(\"M\"),\"project\"]).count()\ndel show[\"resolved\"]\nshow = show.reset_index().set_index(\"resolved\").to_timestamp().reset_index()\n\nalt.Chart(show).mark_area().encode(\n    x=alt.X(\"resolved:T\",axis=alt.Axis(title=\"month\")),\n    y=alt.Y(\"key:Q\",axis=alt.Axis(title='# of resolved issues')),\n    color=\"project:N\"\n).configure_view(\n       height=plot_height,\n       width=plot_width,  \n    )","6bfb4bac":"show = resolved[[\"resolved\",\"key\"]].groupby([resolved[\"resolved\"].dt.to_period(\"M\")]).count()\ndel show[\"resolved\"]\nshow = show.reset_index().set_index(\"resolved\").to_timestamp().reset_index()\nalt.Chart(show).mark_bar().encode(\n    x=alt.X(\"resolved:T\",axis=alt.Axis(title=\"month\")),\n    y=alt.Y(\"key:Q\",axis=alt.Axis(title='# of resolved issues'))\n).configure_view(\n       height=plot_height,\n       width=plot_width,  \n    )","e60e2bfe":"show = resolved[resolved[\"assignee\"].notnull()]\n# hadoop_resolved\nshow = show[[\"resolved\",\"assignee\",\"key\",\"project\"]].groupby([show[\"resolved\"].dt.to_period(\"Q\"),\"assignee\",\"project\"]).count()\ndel show[\"resolved\"]\ndel show[\"key\"]\nassignee_per_month = show.reset_index().groupby([\"resolved\",\"project\"]).count().reset_index().set_index(\"resolved\").to_timestamp().reset_index()\n# assignee_per_month\nalt.Chart(assignee_per_month).mark_bar().encode(\n    x=alt.X('resolved:N',axis=alt.Axis(title='Time')),\n    y=alt.Y(\"assignee:Q\",axis=alt.Axis(title='# unique contributors')),\n    color=\"project:N\"\n).configure_view(\n       height=plot_height,\n       width=plot_width,  \n    )","3851137b":"show = resolved[resolved[\"assignee\"].notnull()]\n# hadoop_resolved\ncontributions = show[[\"resolved\",\"assignee\",\"key\"]].groupby([\"assignee\"]).count().sort_values(\"key\",ascending=False)\n# del show[\"resolved\"]\n# del show[\"key\"]\ncontributions.head(20)","f8e47522":"\ntop_contributors = contributions.head(15).index.to_list()\nshow = show[show[\"assignee\"].isin(top_contributors)]\n\nshow = show[[\"resolved\",\"assignee\",\"key\"]].groupby([show[\"resolved\"].dt.to_period(\"Q\"),\"assignee\"]).count().sort_values(\"key\",ascending=False)\ndel show[\"resolved\"]\nshow = show.reset_index().set_index(\"resolved\").to_timestamp().reset_index()\nshow\nalt.Chart(show).mark_bar().encode(\n    x=alt.X('resolved:N',axis=alt.Axis(title='Time')),\n    y=alt.Y(\"key:Q\",axis=alt.Axis(title='# resolved issues')),\n    color=\"assignee:N\"\n).configure_view(\n       height=plot_height,\n       width=plot_width,  \n    )","4d4581dc":"#contribution timeline (time between first and last resolved jira)\nresult = resolved[resolved[\"assignee\"].notnull()].groupby([\"assignee\"]).agg({\"resolved\":[np.min,np.max]})\nresult[\"contribution_time\"] = result[('resolved', 'amax')] - result[('resolved', 'amin')]\nresult = result.drop(\"resolved\", axis=1)\nresult = result.sort_values(\"contribution_time\", ascending=False).dropna().head(30).reset_index()\nresult.columns = result.columns.get_level_values(0)\n\nresult[\"years\"] = result[\"contribution_time\"].dt.days \/ 365\ndel result[\"contribution_time\"]\nresult.columns\nbars = alt.Chart(result).mark_bar().encode(\n    x='years:Q',\n    y=alt.Y(\"assignee:N\",sort=None)\n)\n\nbars.properties(height=900)","eda873da":"\nresolved_stat = resolved[[\"project\",\"resolved\"]] \\\n   .groupby(\"project\") \\\n   .count() \\\n   .sort_values(\"resolved\", ascending=False)\nresolved_stat\n\nissue_stat = issues[[\"project\",\"key\"]] \\\n   .groupby(\"project\") \\\n   .count() \\\n   .sort_values(\"key\", ascending=False) \\\n   .rename(columns={\"key\":\"created\"})\n\n\ncontributor_stat = resolved[resolved[\"assignee\"].notnull()] \\\n   .groupby([\"project\",\"assignee\"]) \\\n   .count().reset_index()\ncontributor_stat = contributor_stat[[\"project\",\"assignee\"]].groupby(\"project\").count().sort_values(\"assignee\",ascending=False)\n\nsubprojects = contributor_stat.join(resolved_stat).join(issue_stat)\nsubprojects","ea82b664":"points = alt.Chart(subprojects.reset_index()).mark_circle().encode(\n    alt.X('resolved', scale=alt.Scale(type=\"log\"),axis=alt.Axis(title=\"Number of resolved JIRAs\")),\n    alt.Y('assignee', scale=alt.Scale(type=\"log\"),axis=alt.Axis(title=\"Number of unique conributors\")),\n    color='project'\n)\npoints\ntext = points.mark_text(\n    align='right',\n    baseline='middle',\n    dx=-4,\n    fontSize=12,\n).encode(\n    text='project',\n    size = alt.NumericFieldDefWithCondition(type=\"quantitative\")\n)\n(points + text).configure_view(\n       height=plot_height,\n       width=plot_width,  \n    )","df9cf37e":"points = alt.Chart(subprojects.reset_index()).mark_circle().encode(\n    alt.X('resolved', scale=alt.Scale(type=\"log\")),\n    alt.Y('created', scale=alt.Scale(type=\"log\")),\n    color='project',\n    size=alt.NumericFieldDefWithCondition(type=\"quantitative\",field=\"assignee\",scale=alt.Scale(type=\"log\"))\n)\ntext = points.mark_text(\n    align='right',\n    baseline='middle',\n    dx=-20,\n    fontSize=12,\n).encode(\n    text='project',\n    size = alt.NumericFieldDefWithCondition(type=\"quantitative\")\n)\n(points + text).configure_view(\n       height=plot_height,\n       width=plot_width,  \n    )","f7f8d565":"## Long-term contributors (time between last and first contribution)","83779949":"## Number of unique contributors","5091c006":"## Resolved issues all time (monthly)","63cf457d":"## Hadoop resolved issues per subprojects in last two years (normalized)","c8d7ca88":"## Top assignees of the resolved jiras","740ef3ba":"## Hadoop resolved issues per subprojects in last two years"}}