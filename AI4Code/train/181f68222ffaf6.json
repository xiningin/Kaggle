{"cell_type":{"005cab89":"code","59f479f2":"code","17690786":"code","1b32bb24":"code","e5d3ebd9":"code","684d6c35":"code","b29ff518":"code","2f1755f5":"code","47037347":"code","f728e544":"code","18dc384b":"code","aebf5eb8":"code","f5d95b75":"markdown","8af2c3aa":"markdown","e4af3ded":"markdown","cd7a1134":"markdown","ad2c72ab":"markdown","dc3431da":"markdown","65c3e28a":"markdown"},"source":{"005cab89":"import os\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport matplotlib.image as mpimg\nfrom sklearn.model_selection import train_test_split\nimport pickle\nimport tensorflow as tf\nfrom tensorflow.keras.preprocessing.image import ImageDataGenerator\nfrom tensorflow.keras.models import Sequential\nfrom tensorflow.keras.layers import *\n\nimport zipfile \nfrom tensorflow import keras\nfrom tensorflow.keras.preprocessing.image import ImageDataGenerator","59f479f2":"test = pd.read_csv('..\/input\/hcd-cropped\/sample_submission.csv')\n\nprint('Test Set Size:', test.shape)","17690786":"test.head()","1b32bb24":"#The id in the csv file does not have .tif extension, therefore we need to add it here.\ntest['id'] = test['id'].apply(lambda x:f'{x}.tif')\ntest.head()","e5d3ebd9":"test_path = \"..\/input\/hcd-cropped\/test\"\nprint('Test Images:', len(os.listdir(test_path)))","684d6c35":"BATCH_SIZE = 64\n\ntest_datagen = ImageDataGenerator(rescale=1\/255)\n\ntest_loader = test_datagen.flow_from_dataframe(\n    dataframe = test,\n    directory = test_path,\n    x_col = 'id',\n    batch_size = BATCH_SIZE,\n    shuffle = False,\n    class_mode = None,\n    target_size = (32,32)\n)","b29ff518":"cnn_model = keras.models.load_model('..\/input\/cancer-detection-cropped-images-model\/cancer_model_v00.h5')\ncnn_model.summary()","2f1755f5":"test_probs = cnn_model.predict(test_loader)\nprint(test_probs.shape)","47037347":"test_pred = np.argmax(test_probs, axis=1)\nprint(test_pred[:10]) ","f728e544":"submission = pd.read_csv('..\/input\/hcd-cropped\/sample_submission.csv')\nsubmission.head()","18dc384b":"submission.label = test_pred\nsubmission.head()","aebf5eb8":"submission.to_csv('submission.csv', header=True, index=False)","f5d95b75":"# Extract test images","8af2c3aa":"# Data generator","e4af3ded":"# Load dataframe test","cd7a1134":"# Prepare submission","ad2c72ab":"Test predictions","dc3431da":"# Import packages","65c3e28a":"# Load model"}}