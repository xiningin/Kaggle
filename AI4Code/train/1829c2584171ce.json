{"cell_type":{"5355d0d5":"code","d41c6519":"code","e75b41ba":"code","ab01185e":"code","ab3a7de8":"code","6d93f234":"code","91239fff":"code","25dde057":"markdown","e31371b2":"markdown","bb70cd16":"markdown","72ce86c9":"markdown","c3746c7a":"markdown"},"source":{"5355d0d5":"# Familiar imports\nimport numpy as np\nimport pandas as pd\n\n# For ordinal encoding categorical variables, splitting data\nfrom sklearn.preprocessing import OrdinalEncoder\nfrom sklearn.model_selection import train_test_split\n\n# For training random forest model\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.metrics import mean_squared_error","d41c6519":"# Load the training data\ntrain = pd.read_csv(\"..\/input\/30-days-of-ml\/train.csv\", index_col=0)\ntest = pd.read_csv(\"..\/input\/30-days-of-ml\/test.csv\", index_col=0)\n\n# Preview the data\ntrain.head()","e75b41ba":"# Separate target from features\ny = train['target']\nfeatures = train.drop(['target'], axis=1)\n\n# Preview features\nfeatures.head()","ab01185e":"# List of categorical columns\nobject_cols = [col for col in features.columns if 'cat' in col]\n\n# ordinal-encode categorical columns\nX = features.copy()\nX_test = test.copy()\nordinal_encoder = OrdinalEncoder()\nX[object_cols] = ordinal_encoder.fit_transform(features[object_cols])\nX_test[object_cols] = ordinal_encoder.transform(test[object_cols])\n\n# Preview the ordinal-encoded features\nX.head()","ab3a7de8":"X_train, X_valid, y_train, y_valid = train_test_split(X, y, random_state=0)","6d93f234":"# Define the model \nmodel = RandomForestRegressor(random_state=1)\n\n# Train the model (will take about 10 minutes to run)\nmodel.fit(X_train, y_train)\npreds_valid = model.predict(X_valid)\nprint(mean_squared_error(y_valid, preds_valid, squared=False))","91239fff":"# Use the model to generate predictions\npredictions = model.predict(X_test)\n\n# Save the predictions to a CSV file\noutput = pd.DataFrame({'Id': X_test.index,\n                       'target': predictions})\noutput.to_csv('submission.csv', index=False)","25dde057":"Step 5: Submit to the competition","e31371b2":"Step 4: Train a model","bb70cd16":"Step 1: Import helpful libraries","72ce86c9":"Step 2: Load the data","c3746c7a":"Step 3: Prepare the data"}}