{"cell_type":{"47aff507":"code","c547af1a":"code","292a71a9":"code","d3f3ffa6":"code","e3e97de3":"code","215ee34d":"code","3082ef7e":"code","a7be5124":"code","dbfc07d4":"code","8502960b":"code","5f21590f":"code","1b5c68f8":"code","26a62d74":"code","5a6fcb7d":"markdown"},"source":{"47aff507":"import math\nimport pandas_datareader as web\nimport numpy as np\nimport pandas as pd\nfrom sklearn.preprocessing import MinMaxScaler\nfrom keras.models import Sequential\nfrom keras.layers import Dense, LSTM\nimport matplotlib.pyplot as plt\nimport plotly.graph_objects as go\nplt.style.use ('fivethirtyeight')\nimport plotly.express as px","c547af1a":"df = pd.read_csv('..\/input\/bitcoin-data-updated-till-26jun2021\/BTC-USD.csv')\ndf = df.set_index('Date')\ndf = df.dropna()\ndf","292a71a9":"print(\"Click on the bottom right menu to show or hide the legend lines\")\n\nfig = go.Figure()\nfig.add_trace(go.Scatter(x = df.index, y = df.High,\n                    mode='lines',\n                    name='High',\n                    marker_color = '#2CA02C',\n                    visible = \"legendonly\"))\nfig.add_trace(go.Scatter(x = df.index, y = df.Low,\n                    mode='lines',\n                    name='Low',\n                    marker_color = '#D62728',\n                    visible = \"legendonly\"))\nfig.add_trace(go.Scatter(x = df.index, y = df.Open,\n                    mode='lines',\n                    name='Open',\n                    marker_color = '#FF7F0E',\n                    visible = \"legendonly\"))\nfig.add_trace(go.Scatter(x = df.index, y = df.Close,\n                    mode='lines',\n                    name='Close',\n                    marker_color = '#1F77B4'))\n\nfig.update_layout(\n    title='Closing price history',\n    titlefont_size = 28,\n    \n    xaxis = dict(\n        title='Date',\n        titlefont_size=16,\n        tickfont_size=14),\n    \n    height = 800,\n    \n    yaxis=dict(\n        title='Price in INR (\u20b9)',\n        titlefont_size=16,\n        tickfont_size=14),\n    \n    legend=dict(\n        y=0,\n        x=1.0,\n        bgcolor='rgba(255, 255, 255, 0)',\n        bordercolor='rgba(255, 255, 255, 0)'))\n\nfig.show()","d3f3ffa6":"data = df.filter(['Close'])\ndataset = data.values\ntraining_data_len = math.ceil(len(dataset) * .8)\ntraining_data_len","e3e97de3":"scaler = MinMaxScaler(feature_range=(0,1))\nscaled_data = scaler.fit_transform(dataset)\nscaled_data","215ee34d":"train_data = scaled_data[0:training_data_len, :]\nx_train = []\ny_train = []\nfor i in range(60, len(train_data)):\n    x_train.append(train_data[i-60:i, 0])\n    y_train.append(train_data[i, 0])\n    if i <= 61:\n        print(x_train)\n        print(y_train)\n        print()","3082ef7e":"x_train, y_train = np.array(x_train), np.array(y_train)\nx_train = np.reshape(x_train, (x_train.shape[0], x_train.shape[1], 1))\nx_train.shape","a7be5124":"model = Sequential()\nmodel.add(LSTM(50, return_sequences = True, input_shape = (x_train.shape[1], 1)))\nmodel.add(LSTM(50, return_sequences = False))\nmodel.add(Dense(25))\nmodel.add(Dense(1))\nmodel.compile(optimizer = 'adam', loss = 'mean_squared_error')\nmodel.fit(x_train, y_train, batch_size = 1, epochs = 1)","dbfc07d4":"test_data = scaled_data[training_data_len - 60: , :]\nx_test = []\ny_test = dataset[training_data_len:, :]\n\nfor i in range (60, len(test_data)):\n    x_test.append(test_data[i - 60:i, 0])\n\nx_test = np.array(x_test)\nx_test = np.reshape(x_test, (x_test.shape[0], x_test.shape[1], 1))\n\npredictions = model.predict(x_test)\npredictions = scaler.inverse_transform(predictions)\n\nrsme = np.sqrt(np.mean(predictions - y_test) ** 2)\nrsme","8502960b":"train = data[:training_data_len]\nvalid = data[training_data_len:]\nvalid['Predictions'] = predictions","5f21590f":"print(\"Click and drag on the plot to zoom in, you can reset using the top right option\")\n\nfig = go.Figure()\nfig.add_trace(go.Scatter(x = train.index, y = train.Close,\n                    mode='lines',\n                    name='Close',\n                    marker_color = '#1F77B4'))\nfig.add_trace(go.Scatter(x = valid.index, y = valid.Close,\n                    mode='lines',\n                    name='Val',\n                    marker_color = '#FF7F0E'))\nfig.add_trace(go.Scatter(x = valid.index, y = valid.Predictions,\n                    mode='lines',\n                    name='Predictions',\n                    marker_color = '#2CA02C'))\n\nfig.update_layout(\n    title='Model',\n    titlefont_size = 28,\n    hovermode = 'x',\n    xaxis = dict(\n        title='Date',\n        titlefont_size=16,\n        tickfont_size=14),\n    \n    height = 800,\n    \n    yaxis=dict(\n        title='Close price in INR (\u20b9)',\n        titlefont_size=16,\n        tickfont_size=14),\n    legend=dict(\n        y=0,\n        x=1.0,\n        bgcolor='rgba(255, 255, 255, 0)',\n        bordercolor='rgba(255, 255, 255, 0)'))\n\nfig.show()","1b5c68f8":"valid","26a62d74":"last_60_days = data[-60:].values\nlast_60_days_scaled = scaler.transform(last_60_days)\nX_test = []\nX_test.append(last_60_days_scaled)\nX_test = np.array(X_test)\nX_test = np.reshape(X_test, (X_test.shape[0],X_test.shape[1], 1))\npred_price = model.predict(X_test)\npred_price = scaler.inverse_transform(pred_price)\nprint ('Predicting the closing price for the next day')\nprint()\nprint(pred_price)","5a6fcb7d":"# According to the predictive model it states that the price for Bitcoin will go down on the 27th of June 2021.\n\n\n## Please let me know what you think of my EDA and Prediction modeling."}}