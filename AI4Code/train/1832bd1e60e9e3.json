{"cell_type":{"8c681022":"code","2ef4e9f7":"code","d9a7dcf2":"code","04701dc7":"code","279b8a78":"code","d4e027ed":"code","1a80ef27":"code","b3d522f6":"code","d4b286e6":"code","8757d734":"code","d5f3963d":"code","0329146f":"code","85e6e0a3":"code","9d665c4f":"code","d9be0c1b":"code","db788d59":"code","a80961e3":"code","6ead9d48":"code","6610e785":"code","d9b735b0":"code","b6180402":"code","f572bfd1":"code","80d74fe5":"code","fba6630a":"code","e4e95242":"code","fdaa1be3":"code","4124b0d6":"code","6ce0d775":"code","604dff84":"code","f84496dd":"code","9a9ccb5a":"code","e188f34a":"code","2918a061":"code","9e8015cb":"code","b12cfd02":"code","ab616118":"code","86138695":"code","82f20183":"code","28d74eba":"code","9c86eb1f":"code","c3ad4178":"code","9bce9e55":"code","0865c4bf":"code","37466586":"code","fe0842e8":"code","3b1fbdf8":"code","a9cd17db":"code","9fc9a1c7":"code","a9cfda42":"code","51add114":"code","9619739e":"code","b103f700":"code","da83d49b":"code","2f41fd47":"code","e9f08af8":"code","e37d0a5a":"code","a0fe3675":"code","94d3caa1":"code","3466ef70":"code","9c3f7885":"code","443da720":"code","0c069670":"code","027a8674":"code","b05a8824":"code","07d58c69":"code","7f4bf4f1":"markdown","29581f8f":"markdown","e5fa363d":"markdown","859e928a":"markdown","b34c7ade":"markdown","be4d4723":"markdown","b2af7056":"markdown","55ccfa45":"markdown","3c75f3da":"markdown","c83eb824":"markdown","bb214c9d":"markdown","c76a790c":"markdown"},"source":{"8c681022":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt \nimport plotly.graph_objs as go\nimport plotly.offline as py","2ef4e9f7":"dietanic_data=pd.read_csv(\"..\/input\/titanic\/train.csv\")","d9a7dcf2":"dietanic_data1=pd.read_csv(\"..\/input\/titanic\/test.csv\")","04701dc7":"dietanic_data.head()","279b8a78":"dietanic_data.info()","d4e027ed":"dietanic_data.isnull().sum()","1a80ef27":"dietanic_data.columns","b3d522f6":"dietanic_data[\"Survived\"].describe()","d4b286e6":"dietanic_data['Survived'].value_counts().plot.bar()","8757d734":"sns.countplot('Survived',data=dietanic_data)","d5f3963d":"dietanic_data['Survived'].value_counts().plot.pie(autopct='%1.1f%%',shadow=True)","0329146f":"plt.figure(figsize=(3,5))\nsns.barplot(y=\"Survived\", x=\"Sex\",hue=\"Sex\",data=dietanic_data)\n","85e6e0a3":"dietanic_data[['Sex','Survived']].groupby(['Sex']).mean().plot.bar()","9d665c4f":"pd.crosstab(dietanic_data.Sex,dietanic_data.Survived,margins=True).style.background_gradient(cmap='summer_r')","d9be0c1b":"pd.crosstab(dietanic_data.Pclass,dietanic_data.Survived,margins=True).style.background_gradient(cmap='summer_r')","db788d59":"f,axes=plt.subplots(1,2,figsize=(18,8))\ndietanic_data['Pclass'].value_counts().plot.bar(ax=axes[0])\naxes[0].set_title(\"Passengers\")\nsns.countplot(x='Pclass',hue='Survived',data=dietanic_data)\n","a80961e3":"pd.crosstab([dietanic_data.Pclass,dietanic_data.Sex],dietanic_data.Survived,margins=True).style.background_gradient(cmap='summer_r')","6ead9d48":"sns.factorplot('Pclass','Survived',hue='Sex',data=dietanic_data)\nplt.show()","6610e785":"sns.barplot('Sex','Survived',hue='Pclass',data=dietanic_data)","d9b735b0":"dietanic_data.Age.describe()","b6180402":"f,ax=plt.subplots(1,2,figsize=(18,8))\nsns.violinplot(\"Pclass\",'Age',hue=\"Survived\",data=dietanic_data,ax=ax[0])\nsns.violinplot(\"Sex\",'Age',hue=\"Survived\",data=dietanic_data,ax=ax[1])\nplt.show()","f572bfd1":"dietanic_data.isna().sum()","80d74fe5":"dietanic_data['Initial']=0\nfor i in dietanic_data:\n    dietanic_data['Initial']=dietanic_data.Name.str.extract('([A-Za-z]+)\\.') #lets extract the Salutations","fba6630a":"dietanic_data.head()","e4e95242":"pd.crosstab(dietanic_data.Initial,dietanic_data.Sex)","fdaa1be3":"dietanic_data[\"Initial\"].replace(['Countess','Dr','Don','Capt','Col','Jonkheer','Lady','Major','Mlle','Mme','Ms','Rev','Sir'],['Mrs','Mr','Mr','Mr','Other','Other','Miss','Other','Mrs','Mrs','Miss','Other','Mr'],inplace=True)","4124b0d6":"pd.crosstab(dietanic_data.Initial,dietanic_data.Sex)","6ce0d775":"dietanic_data.groupby('Initial')[\"Age\"].mean()","604dff84":"## Assigning the NaN Values with the Ceil values of the mean ages\ndietanic_data.loc[(dietanic_data.Age.isnull())&(dietanic_data.Initial=='Mr'),'Age']=33\ndietanic_data.loc[(dietanic_data.Age.isnull())&(dietanic_data.Initial=='Mrs'),'Age']=36\ndietanic_data.loc[(dietanic_data.Age.isnull())&(dietanic_data.Initial=='Master'),'Age']=5\ndietanic_data.loc[(dietanic_data.Age.isnull())&(dietanic_data.Initial=='Miss'),'Age']=22\ndietanic_data.loc[(dietanic_data.Age.isnull())&(dietanic_data.Initial=='Other'),'Age']=46","f84496dd":"dietanic_data.isna().sum()","9a9ccb5a":"dietanic_data['Embarked'].fillna('S',inplace=True)","e188f34a":"dietanic_data=dietanic_data.drop([\"Cabin\"],axis=1)","2918a061":"dietanic_data.isna().sum()","9e8015cb":"sns.heatmap(dietanic_data.corr(),annot=True,cmap='RdYlGn',linewidths=0.2) #dietanic_data.corr()-->correlation matrix\nfig=plt.gcf()\nfig.set_size_inches(10,8)\nplt.show()","b12cfd02":"from sklearn.linear_model import LogisticRegression\nfrom sklearn import svm #support vector Machine\nfrom sklearn.ensemble import RandomForestClassifier #Random Forest\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.naive_bayes import GaussianNB\nfrom sklearn.tree import DecisionTreeClassifier #Decision Tree\nfrom sklearn.model_selection import train_test_split #training and testing data split\nfrom sklearn import metrics #accuracy measure\nfrom sklearn.metrics import confusion_matrix #for confusion matrix","ab616118":"train_y=dietanic_data[[\"Survived\"]]","86138695":"train_y.head()","82f20183":"train_x=dietanic_data","28d74eba":"train_x=train_x.drop([\"Initial\",\"Name\",\"Survived\",\"PassengerId\",\"Ticket\"],axis=1)","9c86eb1f":"train_x.isna().sum()","c3ad4178":"train_x.info()","9bce9e55":"train_x = pd.get_dummies(train_x)","0865c4bf":"train_x.head()","37466586":"train_x.shape","fe0842e8":"X_train, X_test, y_train, y_test =train_test_split(train_x,\n                    train_y,test_size=0.3,random_state=231)","3b1fbdf8":"X_train.shape","a9cd17db":"X_test.shape","9fc9a1c7":"#TEST DATA","a9cfda42":"dietanic_data1=dietanic_data1.drop([\"Name\",\"PassengerId\",\"Ticket\",\"Cabin\"],axis=1)","51add114":"dietanic_data1.isna().sum()","9619739e":"dietanic_data1.Age.fillna(dietanic_data1.Age.mean(),\n                inplace=True)","b103f700":"dietanic_data1.Fare.fillna(dietanic_data1.Fare.mean(),\n                inplace=True)","da83d49b":"dietanic_data1.isna().sum()","2f41fd47":"dietanic_data1 = pd.get_dummies(dietanic_data1)","e9f08af8":"model=svm.SVC(kernel='rbf',C=1,gamma=0.1)\nmodel.fit(train_x,train_y)\nprediction1=model.predict(dietanic_data1)\n\n","e37d0a5a":"prediction1","a0fe3675":"model=svm.SVC(kernel='linear',C=0.1,gamma=0.1)\nmodel.fit(train_x,train_y)\nprediction2=model.predict(dietanic_data1)\n","94d3caa1":"model = LogisticRegression()\nmodel.fit(train_x,train_y)\nprediction3=model.predict(dietanic_data1)\n","3466ef70":"model=DecisionTreeClassifier()\nmodel.fit(train_x,train_y)\nprediction4=model.predict(dietanic_data1)\n","9c3f7885":"model=KNeighborsClassifier() \nmodel.fit(train_x,train_y)\nprediction5=model.predict(dietanic_data1)\n","443da720":"model=GaussianNB()\nmodel.fit(train_x,train_y)\nprediction6=model.predict(dietanic_data1)\n","0c069670":"model=RandomForestClassifier(n_estimators=100)\nmodel.fit(train_x,train_y)\nprediction7=model.predict(dietanic_data1)\n","027a8674":"final_pred=pd.DataFrame(prediction6)","b05a8824":"sub_df=pd.read_csv('..\/input\/titanic\/gender_submission.csv')","07d58c69":"datasets=pd.concat([sub_df['PassengerId'],final_pred],axis=1)\ndatasets.columns=['PassengerId','Survived']\ndatasets.to_csv('sample_submission.csv',index=False)","7f4bf4f1":"## Random Forests","29581f8f":"## Decision tree","e5fa363d":"# Splitting just for Practice","859e928a":"# Prediction time","b34c7ade":"### dummy variabls for categorical variables","be4d4723":"## Radial Support Vector Machines(rbf-SVM","b2af7056":"## Gaussian Naive Bayes","55ccfa45":"## K-Nearest Neighbours(KNN)","3c75f3da":"## Linear Support Vector Machine(linear-SVM)","c83eb824":"## Logistic Regression","bb214c9d":"# age","c76a790c":"# heatmap"}}