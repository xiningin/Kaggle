{"cell_type":{"18ade08c":"code","c73062db":"code","a302a4df":"code","efcbc41a":"code","e8be68c2":"code","b099e13c":"code","3f293dc8":"code","c4c9cbc0":"code","ba6eb865":"code","bc72ecf1":"code","1f390175":"code","9aa63950":"code","505c42e8":"code","52caa813":"code","80ea28c9":"code","ff1dc529":"code","0f863c9e":"code","c58e6024":"code","383a9207":"code","b6d5058c":"code","ad2a95f7":"code","f9f9592e":"code","3ec0527d":"code","1c192508":"code","326c3c3d":"code","3ea2e6c1":"code","a986ef96":"code","e0aed9f0":"code","020fb138":"code","87a7856f":"code","56f03751":"code","8c28b3d8":"code","f69de13a":"code","9f8f960b":"markdown","33a9e419":"markdown","5bf13a54":"markdown","fda08c41":"markdown","c17caad9":"markdown","89043138":"markdown","01466840":"markdown","93e76f5c":"markdown","a3cc2c9f":"markdown","8acd25cd":"markdown","32eb907c":"markdown","c776a798":"markdown","11054b34":"markdown","0de71d85":"markdown","da35bb14":"markdown","57dab598":"markdown","b2cdeb63":"markdown","69db0c83":"markdown","a05586a4":"markdown","591c61b3":"markdown","726c9d74":"markdown"},"source":{"18ade08c":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport matplotlib.ticker as mtick","c73062db":"cust= pd.read_csv('..\/input\/telco-customer-churn\/WA_Fn-UseC_-Telco-Customer-Churn.csv')","a302a4df":"cust.head()","efcbc41a":"cust.describe","e8be68c2":"cust.info()","b099e13c":"cust.isnull().sum()","3f293dc8":"cust['Churn'].value_counts()","c4c9cbc0":"cust.dtypes","ba6eb865":"cust.shape","bc72ecf1":"cust.duplicated()","1f390175":"cust.TotalCharges = pd.to_numeric(cust.TotalCharges, errors='coerce')\n","9aa63950":"cust.dtypes","505c42e8":"cust.isnull().sum()","52caa813":"total_charges_median = cust.TotalCharges.median()\ncust['TotalCharges'].fillna(total_charges_median, inplace=True)","80ea28c9":"cust = cust.drop('customerID', axis=1)","ff1dc529":"cust.head(5)","0f863c9e":"cust.describe()","c58e6024":"colors = ['#003f7f','#ff007f']\nax = (cust['gender'].value_counts()*100.0 \/len(cust)).plot(kind='bar',\n                                                           stacked = True,\n                                                           rot = 0,\n                                                           color = colors)\nax.yaxis.set_major_formatter(mtick.PercentFormatter())\nax.set_ylabel('% Customers')\nax.set_xlabel('Gender')\nax.set_ylabel('% Customers')\nax.set_title('Gender Distribution')","383a9207":"\nsns.countplot(cust['SeniorCitizen'],palette='twilight');\ncust['SeniorCitizen'].value_counts()","b6d5058c":"plt.hist(cust['tenure'], bins = 30, color = 'green')\nplt.title('Distribution of tenure')","ad2a95f7":"\nplt.figure(figsize = [10,5])\nsns.countplot(cust['Contract'],palette='rocket')\nplt.title('Customer vs Contarct Type',fontsize=20)\nplt.xlabel('Gender', fontsize=16)\nplt.ylabel('Count', fontsize=16)\nplt.show()","f9f9592e":"plt.figure(figsize=(8, 4))\nsns.countplot(cust['Churn'], palette='tab20')","3ec0527d":"cust[['MonthlyCharges', 'TotalCharges']].plot.scatter(x = 'MonthlyCharges',\n                                                              y='TotalCharges')","1c192508":"corr=cust.corr().round(2)\nplt.figure(figsize=(10,10))\nsns.heatmap(corr, annot = True)","326c3c3d":"df2=cust","3ea2e6c1":"df2 = cust.iloc[:,1:]\n#Convertin the predictor variable in a binary numeric variable\ndf2['Churn'].replace(to_replace='Yes', value=1, inplace=True)\ndf2['Churn'].replace(to_replace='No',  value=0, inplace=True)\n\n#Let's convert all the categorical variables into dummy variables\ndf_dummies = pd.get_dummies(df2)\ndf_dummies.head()","a986ef96":"cust.describe()","e0aed9f0":"y = df_dummies['Churn'].values\nX = df_dummies.drop(columns = ['Churn'])\nfrom sklearn.preprocessing import MinMaxScaler\nfeatures = X.columns.values\nscaler = MinMaxScaler(feature_range = (0,1))\nscaler.fit(X)\nX = pd.DataFrame(scaler.transform(X))\nX.columns = features","020fb138":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=101)","87a7856f":"from sklearn.linear_model import LogisticRegression\nmodel = LogisticRegression()\nresult = model.fit(X_train, y_train)","56f03751":"from sklearn import metrics\nprediction_test = model.predict(X_test)\n# Print the prediction accuracy\nprint (metrics.accuracy_score(y_test, prediction_test))","8c28b3d8":"from sklearn.ensemble import RandomForestClassifier","f69de13a":"random_forest = RandomForestClassifier(criterion = \"gini\", \n                                       min_samples_leaf = 1, \n                                       min_samples_split = 10,   \n                                       n_estimators=100, \n                                       max_features='auto', \n                                       oob_score=True, \n                                       random_state=1, \n                                       n_jobs=-1)\n\nrandom_forest.fit(X_train, y_train)\ny_pred = random_forest.predict(X_test)\nrandom_forest.score(X_train, y_train)\nprint(\"Score: \", round(random_forest.oob_score_, 4)*100, \"%\")","9f8f960b":"![](https:\/\/encrypted-tbn0.gstatic.com\/images?q=tbn:ANd9GcTx-9z3sly5qV-SbWOQZhb88Enw010Wsty1RA&usqp=CAU)","33a9e419":"We will observe that the total charges increases as the monthly bill for a customer increases.","5bf13a54":"# Lets Build Random Forest Model","fda08c41":"The prediction accuracy for the test data set using the above Logistic Regression is 80%","c17caad9":"**After going through the above EDA we will develop some predictive models and compare them.**","89043138":"We sucessfully drop customer ID Column","01466840":"****Problem Statement \u2013****\n\nChurn is a one of the biggest problem in the telecom industry.You are the Data Scientist at a telecom company \u201cNeo\u201d whose customers are churning out to its competitors. You have to analyse the data of your company and find insights and stop your customers from churning out to other \ntelecom companies.\n\n****Industry: Telecom****\n\nData Description:\n\nEach row represents a customer, each column contains customer\u2019s attributes described on the column Metadata.\n\nThe data set includes information about:\n\n1. Customers who left within the last month \u2013 the column is called Churn\n2. Services that each customer has signed up for \u2013 phone, multiple lines, internet, online security, online backup, device protection, tech support, and streaming TV and movies\n3. Customer account information \u2013 how long they\u2019ve been a customer, contract, payment method, paperless billing, monthly charges, and total charges\n4. Demographic info about customers \u2013 gender, age range, and if they have partners and dependents\n ","93e76f5c":"As we can see from this graph most of the customers are in the month to month contract. While there are equal number of customers in the 1 year and 2 year contracts.","a3cc2c9f":"By checking feature's unique values we can see that the column `customerID` have unique identifiers for each customer This feature does not contribute for this analysis, therefore we are going to drop the column.","8acd25cd":"The prediction accuracy for the test data set using the above Random Forest is 79.7%","32eb907c":"2. Contracts: To understand the above graph, lets first look at the # of customers by different contracts.","c776a798":"# lets Build Logistic Regression Model","11054b34":"We can see Null Values Present on Total Charges columns. So we removed those Null Values.Replace those Null values using median method.","0de71d85":"Lets Starts Descriptive statistics","da35bb14":"The feature `TotalCharges` got read by Pandas as `object` data type. This have impacts during the exploratory analysis and have to be handled. We will convert datatype to `float64` in the coming sections.\"","57dab598":"**Tenure**: After looking at the above histogram we can see that a lot of customers have been with the telecom company for just a month, while quite a many are there for about 72 months. This could be potentially because different customers have different contracts","b2cdeb63":" Demographics - Let us first understand the gender, age range, patner and dependent status of the customers\n\nGender Distribution - From above graph half of the customers in our data set are male while the other half are female","69db0c83":"Imports Required Libraries","a05586a4":"3- Now let's take a quick look at the relation between monthly and total charges","591c61b3":" It is important to scale the variables in logistic regression so that all of them are within a range of 0 to 1. This helped me improve the accuracy from 79.7% to 80.7%.","726c9d74":"Customer Account Information: Let u now look at the tenure, contract****"}}