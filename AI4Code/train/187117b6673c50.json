{"cell_type":{"a117b94f":"code","b4d1d149":"code","e20b8155":"code","a5d2239e":"code","c65d715c":"code","bbe35157":"code","603fd610":"code","ce986900":"code","03b6691d":"code","b000c3d6":"code","d58efe47":"code","f1464b47":"code","949f5376":"code","1ffbce2a":"code","23a520e8":"code","8189d907":"code","cd31203d":"code","0e9648cc":"code","ef83d235":"code","d506869d":"code","2db85487":"code","653fd25e":"code","e1d198b5":"code","f8f9aba7":"code","e894dceb":"code","9a72d80a":"code","14e305b1":"code","555be4e3":"code","e930c030":"code","ff900e3b":"markdown"},"source":{"a117b94f":"%reload_ext autoreload\n%autoreload 2\n%matplotlib inline","b4d1d149":"from fastai import *\nfrom fastai.vision import *","e20b8155":"bs=64\nnp.random.seed(2)","a5d2239e":"data_path = \"..\/input\/ancient_language_dataset\"\ndata = ImageDataBunch.from_folder(data_path,ds_tfms=get_transforms(),size=224,bs=bs,num_workers=0).normalize(imagenet_stats)","c65d715c":"data.show_batch(rows=3, figsize=(7,6))","bbe35157":"data.classes","603fd610":"learn = create_cnn(data, models.resnet34, metrics=accuracy, path=\".\")","ce986900":"learn.fit_one_cycle(4)","03b6691d":"learn.save(\"stage-1\")","b000c3d6":"interp = ClassificationInterpretation.from_learner(learn)\n\nlosses,idxs=interp.top_losses()\nlen(data.valid_ds)==len(losses)==len(idxs)","d58efe47":"interp.plot_top_losses(9,figsize=(15,11))","f1464b47":"interp.plot_confusion_matrix(figsize=(12,12),dpi=60)","949f5376":"interp.most_confused(min_val=1)","1ffbce2a":"learn.unfreeze()","23a520e8":"learn.fit_one_cycle(1)","8189d907":"learn.load(\"stage-1\");","cd31203d":"learn.lr_find()","0e9648cc":"learn.recorder.plot()","ef83d235":"learn.fit_one_cycle(2,max_lr=slice(7e-4,1e-3))","d506869d":"data = ImageDataBunch.from_folder(data_path,ds_tfms=get_transforms(),size=299,bs=bs\/\/2,num_workers=0).normalize(imagenet_stats)","2db85487":"learn = create_cnn(data, models.resnet50, path=\".\", metrics=accuracy)","653fd25e":"learn.lr_find()","e1d198b5":"learn.recorder.plot()","f8f9aba7":"learn.fit_one_cycle(8)","e894dceb":"learn.save('stage-1-50')","9a72d80a":"learn.unfreeze()\nlearn.fit_one_cycle(6,max_lr=slice(1e-5,1e-4))","14e305b1":"interp = ClassificationInterpretation.from_learner(learn)","555be4e3":"interp.plot_confusion_matrix()","e930c030":"interp.most_confused(min_val=0)","ff900e3b":"## Resnet 50"}}