{"cell_type":{"1ee3ed3a":"code","f886083b":"code","e6ce4333":"code","a7762826":"code","1896fcd9":"code","ab3e4c3a":"code","40f49e6d":"code","14543f97":"code","cc282b4e":"code","e07424f3":"code","1d2e48f9":"code","1dd64aeb":"code","d39748a6":"code","d2558dd1":"code","ffa9ff52":"code","5ba34ee9":"code","f4baa316":"code","d6b94f8e":"code","12a2b5ab":"markdown","4e9bec68":"markdown"},"source":{"1ee3ed3a":"from load_kaggle import load_kaggle","f886083b":"subm, train, test = load_kaggle()\nprint(train.shape, test.shape, subm.shape)\ntrain.head()","e6ce4333":"targets = ['target_carbon_monoxide','target_benzene','target_nitrogen_oxides']\nlen(targets)","a7762826":"# To perform feature engg, we need Featurewiz, an autoML library for feature engg\n!pip install featurewiz","1896fcd9":"import featurewiz as FW","ab3e4c3a":"ts_column = 'date_time'\ntrain1, ts_cols1 = FW.FE_create_time_series_features(train, ts_column)","40f49e6d":"### we need to make sure the same columns are created in test ###\ntest1, ts_cols2 = FW.FE_create_time_series_features(test, ts_column, ts_cols1)","14543f97":"### we now need to make sure that train and test have the same columns ##","cc282b4e":"rem_cols = [x for x in list(train) if x not in [ts_column]+targets]\nrem_cols","e07424f3":"train2 = train1[rem_cols+ts_cols2+targets]\ntrain2.shape","1d2e48f9":"test2 = test1[rem_cols+ts_cols2]\ntest2.shape","1dd64aeb":"train3, test3 = FW.FE_convert_all_object_columns_to_numeric(train2, test2)","d39748a6":"train3.head()","d2558dd1":"from sklearn.ensemble import RandomForestRegressor\nfrom catboost import CatBoostRegressor\n#BL = RandomForestRegressor(n_estimators=100)\nBL = CatBoostRegressor(objective='MultiRMSE')\nBL","ffa9ff52":"BL.fit(train3[rem_cols+ts_cols2], train3[targets])","5ba34ee9":"y_preds = BL.predict(test3[rem_cols+ts_cols2])\ny_preds[:4]","f4baa316":"subm[targets] = y_preds\nsubm.head()","d6b94f8e":"subm.to_csv('submission_Cat_FW.csv', index=False)","12a2b5ab":"# Load the \"Add Utility Script\" from File Menu and search for my \"Load Kaggle\" script","4e9bec68":"# we need to create time series features from date-time column"}}