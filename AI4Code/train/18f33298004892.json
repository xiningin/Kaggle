{"cell_type":{"8a3673a8":"code","7d89ab44":"code","e7c1ef5e":"code","a70d6339":"code","3a244270":"code","46c120f5":"code","d5398e6a":"code","d1c83691":"code","0801724b":"code","338be5e9":"code","1e75f560":"markdown","2c01e5c3":"markdown","2a34e470":"markdown","6b47a15b":"markdown"},"source":{"8a3673a8":"# import des biblioth\u00e8ques utilis\u00e9es\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt","7d89ab44":"# chargement des donn\u00e9es \ndata = pd.read_csv(\"\/kaggle\/input\/refined-data\/data_hard_refined.csv\")\ndata_full = pd.read_csv(\"\/kaggle\/input\/refined-data\/data_filtered.csv\")\nobjectColumns = list(data.dtypes[data.dtypes == np.object].index)\nnumericColumns = list(data.dtypes[data.dtypes != np.object].index)\nobjectColumns = list(data.dtypes[data.dtypes == np.object].index)\nnumericColumns = list(data.dtypes[data.dtypes != np.object].index)\nprint(objectColumns)\nprint(numericColumns)","e7c1ef5e":"print(data['BuildingType'].unique())\nprint(data['PrimaryPropertyType'].unique())","a70d6339":"# analyse de variables quantitatives\ndata['Energy\/Surface'] = data['SiteEnergyUse(kBtu)']\/data['PropertyGFATotal']\ndata['GHG\/Surface'] = data['TotalGHGEmissions']\/data['PropertyGFATotal']\ncolumns_to_boxplot=['SiteEnergyUse(kBtu)','Energy\/Surface', 'TotalGHGEmissions', 'GHG\/Surface']\nfor column in columns_to_boxplot:\n    print('column: {}'.format(column))\n    n_bins = 12\n    subset = data[column]\n    print('all datas: \\n\\tmean: {}\\n\\tmed: {}\\n\\tmod: {}\\n\\tvar: {}\\n\\tstd: {}\\n\\tskew: {}\\n\\tkur: {}'\n          .format(subset.mean(),subset.median(), subset.mode()[0],subset.var(ddof=0),subset.std(ddof=0),subset.skew(),subset.kurtosis()))\n    plt.hist(subset,n_bins,label='all datas', alpha=0.5)\n    plt.title(column)\n    plt.legend(loc='best')\n    plt.show()\n    subset.plot.box(vert=False)\n    plt.title(column)\n    plt.show()\n    # https:\/\/towardsdatascience.com\/create-and-customize-boxplots-with-pythons-matplotlib-to-get-lots-of-insights-from-your-data-d561c9883643 \n    print('='*120)","3a244270":"# d\u00e9tection des outliers \nfor column in columns_to_boxplot:\n    i= 0\n    quartile_1 = data[column].quantile(0.25)\n    quartile_3 = data[column].quantile(0.75)   \n    iqr = quartile_3 - quartile_1\n    min_value = quartile_1 - 1.5*iqr\n    max_value = quartile_3 + 1.5*iqr\n    outliers = data[(data[column]>max_value) | (data[column]<min_value)]\n    i += outliers.shape[0]\n    print('colonnes {}, {} outliers d\u00e9tect\u00e9s'.format(column,i))","46c120f5":"# analyse des variables quantitatives continues: pour les groupes de PrimaryPropertyType)\ngroups = data['PrimaryPropertyType'].unique()\n\nfor column in columns_to_boxplot:\n    print('column: {}'.format(column))\n    n_bins = 12\n    values=[]\n    assessment =  []\n    subset = data[column]\n    # var = variance empirique, std = ecart type empirique\n    print('all datas: \\n\\tmean: {}\\n\\tmed: {}\\n\\tmod: {}\\n\\tvar: {}\\n\\tstd: {}\\n\\tskew: {}\\n\\tkur: {}'\n          .format(subset.mean(),subset.median(), subset.mode()[0],subset.var(ddof=0),subset.std(ddof=0),subset.skew(),subset.kurtosis()))\n    plt.hist(subset,n_bins,label='all datas', alpha=0.5)\n    plt.show()\n    subset.plot.box(vert=False)\n    plt.title(column)\n    plt.show()\n    \n    fig = plt.figure(figsize=(36,18))\n    for group in  groups:\n        subset = data[data.PrimaryPropertyType == group][column] # Cr\u00e9ation du sous-\u00e9chantillon\n        values.append(subset)\n        assessment.append([group,subset.mean(),subset.median(), subset.mode()[0],subset.var(ddof=0),subset.std(ddof=0),subset.skew(),subset.kurtosis()])\n        plt.hist(subset,n_bins,label=group, alpha=0.3) \n        \n    plt.legend(loc='best')\n    plt.title(column)\n    plt.show() # Affiche l'histogramme\n    fig = plt.figure(figsize=(36,18))\n    plt.hist(values, n_bins, histtype='bar', label=groups)\n    plt.legend(loc='best')\n    plt.title(column)\n    plt.show() # Affiche l'histogramme\n    \n    df_assessment = pd.DataFrame(assessment,columns=['group', 'moy', 'med', 'mod','var','std','skew','kur'])\n    display(df_assessment)\n            \n    # https:\/\/towardsdatascience.com\/create-and-customize-boxplots-with-pythons-matplotlib-to-get-lots-of-insights-from-your-data-d561c9883643 \n    \n    fig, ax = plt.subplots(figsize=(36,10))\n    ax.boxplot(values, labels=groups)\n    plt.show()\n    \n    print('='*120)","d5398e6a":"#### d\u00e9tection des outliers par groupe\ndata_refined = data.copy()\ncolumns_outliers_to_delete=['Energy\/Surface', 'GHG\/Surface']\nfor column in columns_outliers_to_delete:\n    print('colonne {}'.format(column))\n    i= 0\n    for group in groups:\n        j=0\n        subset = data_refined[data_refined.PrimaryPropertyType == group]\n        quartile_1 = subset[column].quantile(0.25)\n        quartile_3 = subset[column].quantile(0.75)   \n        iqr = quartile_3 - quartile_1\n        min_value = quartile_1 - 1.5*iqr\n        max_value = quartile_3 + 1.5*iqr\n        outliers = subset[(subset[column]>max_value) | (subset[column]<min_value)]\n        j += outliers.shape[0]\n        i += j \n        print('groupe {}, {} outliers d\u00e9tect\u00e9s'.format(group,j))\n        data_refined.drop(outliers.index.values,inplace=True)\n    print('Total {}, {} outliers d\u00e9tect\u00e9s'.format(column,i))\n    print('='*120)","d1c83691":"print(data.shape)\nprint(data_refined.shape)\ndata_refined.to_csv('data_without_outliers.csv', index=False)","0801724b":"# d\u00e9tection des outliers \ndata_refine = data.copy()\ncolumns_outliers_to_delete==['SiteEnergyUse(kBtu)', 'TotalGHGEmissions']\nfor column in columns_outliers_to_delete:\n    i= 0\n    quartile_1 = data_refine[column].quantile(0.25)\n    quartile_3 = data_refine[column].quantile(0.75)   \n    iqr = quartile_3 - quartile_1\n    min_value = quartile_1 - 1.5*iqr\n    max_value = quartile_3 + 1.5*iqr\n    outliers = data_refine[(data_refine[column]>max_value) | (data_refine[column]<min_value)]\n    i += outliers.shape[0]\n    print('colonnes {}, {} outliers d\u00e9tect\u00e9s'.format(column,i))\n    data_refine.drop(outliers.index.values,inplace=True)","338be5e9":"print(data.shape)\nprint(data_refine.shape)","1e75f560":"Ramener notre analyse \u00e0 la surface r\u00e9duit bien notre quantit\u00e9 d'outliers, comme je l'avais pens\u00e9. Essayons de faire la m\u00eame chose par cat\u00e9gorie d'habitations car il parait \u00e9vident qu'un hopital consommera plus qu'un hotel.","2c01e5c3":"<div style=\"width:100%;text-align: center;\">\n    <img src=\"https:\/\/user.oc-static.com\/upload\/2019\/02\/24\/15510245026714_Seattle_logo_landscape_blue-black.png\" \/>\n<\/div>\n\n# Introduction\n\nVous travaillez pour la ville de Seattle. Pour atteindre son objectif de ville neutre en \u00e9missions de carbone en 2050, votre \u00e9quipe s\u2019int\u00e9resse de pr\u00e8s aux \u00e9missions des b\u00e2timents non destin\u00e9s \u00e0 l\u2019habitation.\n\nDes relev\u00e9s minutieux ont \u00e9t\u00e9 effectu\u00e9s par vos agents en 2015 et en 2016. Cependant, ces relev\u00e9s sont co\u00fbteux \u00e0 obtenir, et \u00e0 partir de ceux d\u00e9j\u00e0 r\u00e9alis\u00e9s, vous voulez tenter de pr\u00e9dire les \u00e9missions de CO2 et la consommation totale d\u2019\u00e9nergie de b\u00e2timents pour lesquels elles n\u2019ont pas encore \u00e9t\u00e9 mesur\u00e9es.\n\nVotre pr\u00e9diction se basera sur les donn\u00e9es d\u00e9claratives du permis d'exploitation commerciale (taille et usage des b\u00e2timents, mention de travaux r\u00e9cents, date de construction..)\n\nVous cherchez \u00e9galement \u00e0 \u00e9valuer l\u2019int\u00e9r\u00eat de l\u2019\"ENERGY STAR Score\" pour la pr\u00e9diction d\u2019\u00e9missions, qui est fastidieux \u00e0 calculer avec l\u2019approche utilis\u00e9e actuellement par votre \u00e9quipe.\n","2a34e470":"On peut observer qu'en proc\u00e9dant par force brute nous aurions d\u00e9tect\u00e9s et supprim\u00e9s 50% d'outliers en plus.","6b47a15b":"**postulat:** peu d'immeuble tr\u00e8s haut entraineront une consommation d'\u00e9nergie importante, ce qui pourrait passer pour des outliers seraient donc des valeurs coh\u00e9rentes. Ils serait int\u00e9ressant de ramener la consommation \u00e9lectrique proportionnellement \u00e0 la surface du b\u00e2timent, nous pourrions ainsi remarquer de vrai outliers qui ont une consommation anormale."}}