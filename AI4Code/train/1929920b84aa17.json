{"cell_type":{"c1096cc3":"code","a62256c5":"code","959ee23b":"code","c87a6637":"code","1af5376f":"code","8993336b":"code","f86f0e6c":"code","570a5138":"code","f34c783a":"code","ede94ae1":"code","d12425dd":"code","ffc82175":"code","3c270288":"code","016695f0":"code","097af59f":"code","edf27071":"code","609ca913":"markdown","b19cc7a3":"markdown"},"source":{"c1096cc3":"import gc\nfrom tqdm import tqdm\nimport numpy as np\nimport pandas as pd\nfrom pylab import rcParams\nimport matplotlib.pyplot as plt\nfrom sklearn.metrics import mean_squared_error\nfrom scipy.stats import probplot\nimport datetime as dt\nfrom datetime import date\nfrom datetime import timedelta\nfrom fbprophet import Prophet\n%matplotlib inline\nimport os\nimport warnings\nwarnings.filterwarnings(\"ignore\")","a62256c5":"data0 = pd.read_csv(\"..\/input\/daily-temperature-of-major-cities\/city_temperature.csv\")\ndata0[-5:]","959ee23b":"drop=data0[data0['AvgTemperature']==-99.0].index.tolist()\ndata0=data0.drop(index=drop).reset_index(drop=True)","c87a6637":"date=[]\nfor y,m,d in zip(data0['Year'],data0['Month'],data0['Day']):\n    date+=[dt.datetime(y,m,d).strftime('%Y-%m-%d')]\ndata0['Date']=date\ndata0","1af5376f":"print(data0['City'].unique().tolist())","8993336b":"cities=['Tokyo','New York City','London']","f86f0e6c":"data1=data0[data0['City']=='Tokyo']","570a5138":"data2=data1[['Date','AvgTemperature']].reset_index(drop=True)\ndata2","f34c783a":"item1=data2\n\nitem1.columns = ['ds','y']\nitem1.y = item1.y.astype('float')\nitem1.ds = item1.ds.astype('datetime64')\n\nrcParams['figure.figsize'] = 20,5\nplt.plot(item1.ds, item1.y)","ede94ae1":"ph = Prophet()\nph.fit(item1)\nforecast1=ph.predict(item1)\nfigure = ph.plot(forecast1)\nfigure.show()","d12425dd":"from datetime import timedelta\nstart0 = dt.datetime.strptime('2020-01-01','%Y-%m-%d').date()\nend0   = dt.datetime.strptime('2022-12-31','%Y-%m-%d').date()\nprint((end0-start0).days)","ffc82175":"def daterange(start,end):\n    for i in range((end-start).days):\n        return start+timedelta(i)  ","3c270288":"dates0=[]\nfor i in range((end0-start0).days):\n    dates0+=[(start0+timedelta(i)).strftime('%Y-%m-%d') ]\nprint(dates0[0:10])","016695f0":"dates0_df=pd.DataFrame(dates0)\ndates0_df.columns=['ds']\ndates0_df","097af59f":"ph = Prophet()\nph.fit(item1)\nforecast3=ph.predict(dates0_df)\nfigure = ph.plot(forecast3)\nfigure.show()","edf27071":"for item in cities:\n    data1=data0[data0['City']==item]\n    #data1['date']=pd.to_datetime(data1['date'])\n    item1=data1[['Date','AvgTemperature']]\n\n    item1.columns = ['ds','y']\n    item1.y = item1.y.astype('float')\n    item1.ds = item1.ds.astype('datetime64')\n\n    ph = Prophet()\n    ph.fit(item1[-365*3:])\n    forecast3=ph.predict(dates0_df)\n    figure = ph.plot(forecast3)\n    plt.title(item)\n    figure.show()","609ca913":"# fit past and predict future","b19cc7a3":"# fit past and predict past"}}