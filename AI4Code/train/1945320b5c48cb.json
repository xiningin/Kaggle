{"cell_type":{"32b5fb43":"code","8d8563fc":"code","a73cb849":"code","c14124d1":"code","7d96fb3c":"code","b15637c7":"code","083a9c1d":"code","ebb157e6":"code","c187fffc":"code","8c4007d6":"code","d12df612":"code","9adf71e2":"code","7d199ef6":"code","3a8b0ab9":"code","e08e3467":"code","b6cf0507":"code","25f7d149":"code","0573d42c":"code","6d97eb82":"code","9a99cafe":"code","2ee6ff54":"code","ba749674":"code","85157941":"code","4414e81b":"markdown"},"source":{"32b5fb43":"import pandas as pd\nimport numpy as np\nfrom sklearn import tree\nimport graphviz\nfrom sklearn.model_selection import cross_val_score","8d8563fc":"df = pd.read_csv('\/kaggle\/input\/predict-the-income-bi-hack\/train.csv')\ndft = pd.read_csv('\/kaggle\/input\/predict-the-income-bi-hack\/test.csv')\nprint('train dataset length',len(df),'\\ntest dataset length',len(dft))\n","a73cb849":"print(len(df.columns))\nprint(len(dft.columns))","c14124d1":"df.head(3)","7d96fb3c":"ids=dft['ID']\ndf.drop('ID', axis=1,inplace =True)\ndft.drop('ID', axis=1,inplace =True)","b15637c7":"df.columns","083a9c1d":"df = pd.get_dummies(df, columns=['Work', 'Education', 'Marital_Status', 'Occupation', 'Relationship', 'Race', 'Gender','Nationality'])\ndft = pd.get_dummies(dft, columns=['Work', 'Education', 'Marital_Status', 'Occupation', 'Relationship', 'Race', 'Gender','Nationality'])","ebb157e6":"df.drop('Nationality_Holand-Netherlands',axis=1, inplace=True)","c187fffc":"print(len(df.columns))\nprint(len(dft.columns))","8c4007d6":"df['Income'].value_counts()","d12df612":"df[\"Income\"] = df[\"Income\"].replace({'<=50K':1,'>50K':0})# creating binary for income","9adf71e2":"d_train = df.copy()\nd_test = dft.copy()\ndf1 = df","7d199ef6":"X = d_train.drop('Income', axis=1)\ny = d_train['Income']","3a8b0ab9":"from sklearn.model_selection import train_test_split","e08e3467":"X_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.30,random_state=42)","b6cf0507":"t = tree.DecisionTreeClassifier(criterion='entropy', max_depth=7)","25f7d149":"t = t.fit(X_train,y_train)","0573d42c":"t.score(X_test,y_test)","6d97eb82":"print(len(df.columns))\nprint(len(dft.columns))","9a99cafe":"sol=t.predict(dft)\nprint(sol)","2ee6ff54":"with open('income-predicted.csv','w') as fw:\n    fw.write('ID,Income\\n')\n    ct=24001\n    for i in sol:\n        s=\"\"\n        if i==1:\n            s=\"<=50K\"\n        else:\n            s=\">50K\"\n        fw.write(str(ct)+','+str(s)+'\\n')\n        ct+=1","ba749674":"sdf = pd.read_csv('income-predicted.csv', sep=',')\nsdf.head()","85157941":"sdf.Income.value_counts()","4414e81b":"#### ML Model"}}