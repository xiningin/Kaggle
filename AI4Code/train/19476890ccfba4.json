{"cell_type":{"5a494524":"code","5ca321b1":"code","c10f52af":"code","a6b58955":"code","6ee85ad1":"code","75a31ab0":"code","462251a3":"code","77409bdd":"code","531e3688":"code","07441b06":"code","5adbd888":"code","82d56b61":"code","7fa5a802":"code","70a35389":"code","2548254c":"code","93aaada6":"code","22b05b15":"code","03b22314":"code","25597d96":"code","f3adaed9":"code","8ad8ca2e":"code","11867c0a":"code","72ac9bd8":"code","34345b32":"code","f4b2a2a1":"code","f218dd3c":"code","31d24e68":"code","bde580db":"code","8d45a9ab":"code","110e62f0":"code","d8696978":"code","b98ea69c":"code","d5fe0f2c":"code","08a4bc5b":"code","dd9d9bbc":"code","dc16c035":"code","ffffc042":"code","dcca257e":"code","87824454":"markdown","94c1184d":"markdown","f574c3a6":"markdown","cb66f9c3":"markdown","b29b847a":"markdown","1ac33f30":"markdown","31403236":"markdown","db4af2b8":"markdown","460868e1":"markdown","5903d131":"markdown","2d2140ae":"markdown","bab34bbd":"markdown","399be0e2":"markdown","c7369cba":"markdown","11279773":"markdown","4e8e3585":"markdown","a6dab6d0":"markdown","fcbf4347":"markdown","120a4a93":"markdown","7d1c8f15":"markdown","9dca876a":"markdown","a19b3c3a":"markdown","9b6c553a":"markdown"},"source":{"5a494524":"import os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","5ca321b1":"import numpy as np \nimport pandas as pd \nimport seaborn as sns\nfrom matplotlib import pyplot as plt\nplt.style.use('fivethirtyeight')\n\n#Modules for ML\nfrom tensorflow import keras\nfrom sklearn.preprocessing import MinMaxScaler\nfrom sklearn.model_selection import train_test_split,cross_val_score,GridSearchCV\nfrom sklearn.metrics import mean_squared_error, r2_score, mean_absolute_error\n\n#Regression classes\nfrom sklearn.linear_model import LinearRegression,Lasso,Ridge\nfrom sklearn.tree import DecisionTreeRegressor\nfrom sklearn.neighbors import KNeighborsRegressor\nfrom sklearn.svm import SVR\nfrom sklearn.ensemble import RandomForestRegressor\n%matplotlib inline","c10f52af":"df = pd.read_csv('..\/input\/pizza-price-prediction\/pizza_v1.csv')\ndf.shape","a6b58955":"df.info()","6ee85ad1":"df.head()","75a31ab0":"plt.figure(figsize=(7,7))\ndf['company'].value_counts().plot(kind='pie',autopct='%.2f')\nplt.title('Companies involved')\nplt.ylabel('')\nplt.show()","462251a3":"plt.figure(figsize=(7,7))\ndf['size'].value_counts().plot(kind='pie',autopct='%.2f')\nplt.title('Size types')\nplt.ylabel('')\nplt.show()","77409bdd":"def countplot_of_2(x,hue,title=None,figsize=(7,7)):\n    plt.figure(figsize=figsize)\n    sns.countplot(data=df[[x,hue]],x=x,hue=hue)\n    plt.title(title)\n    plt.show()","531e3688":"countplot_of_2('size','extra_sauce','Size and Extra sauce')","07441b06":"countplot_of_2('size','extra_cheese','Size and Extra Cheese')","5adbd888":"countplot_of_2('company','size','Company and their pizza size')","82d56b61":"countplot_of_2('topping', 'size', 'Size and Topping',(20,10))","7fa5a802":"countplot_of_2('topping','extra_sauce','Toppings and Extra Sauce',(20,10))","70a35389":"countplot_of_2('topping','extra_cheese','Toppings and Extra Cheese',(20,10))","2548254c":"plt.figure(figsize=(7,7))\nsns.histplot(data=df[['size','diameter']],x='diameter',hue='size')\nplt.title('Diameter and its size')\nplt.show()","93aaada6":"df.head()","22b05b15":"df['price_rupiah'] = df['price_rupiah'].str.replace('\\D+','',regex=True)\ndf['price_rupiah'] = pd.to_numeric(df['price_rupiah'])\ndf['price_rupiah'].dtype","03b22314":"sns.histplot(data=df[['price_rupiah']],x='price_rupiah')\nplt.show()","25597d96":"cols_to_encode = df.drop(['diameter','price_rupiah'],axis=1).columns\ncols_to_encode","f3adaed9":"dummies = pd.get_dummies(df[cols_to_encode],drop_first=True)\ndummies.shape","8ad8ca2e":"dummies.head()","11867c0a":"df.drop(cols_to_encode,axis=1,inplace=True)\ndf.head()","72ac9bd8":"cols_to_scale = ['diameter']\nscale = MinMaxScaler()\nscalled = scale.fit_transform(df[cols_to_scale])","34345b32":"df['diameter'] = scalled[:,0]\n#No need to scale price price_rupiah column","f4b2a2a1":"df[cols_to_scale].describe()","f218dd3c":"new_df = pd.concat([dummies,df],axis=1)\nnew_df.shape","31d24e68":"new_df.head()","bde580db":"x,y = new_df.drop('price_rupiah',axis=1),df['price_rupiah']\nx.shape,y.shape","8d45a9ab":"x_train, x_test, y_train, y_test = train_test_split(x,y,test_size=0.3)\nx_train.shape, x_test.shape, y_train.shape, y_test.shape","110e62f0":"models = [LinearRegression(),Ridge(),Lasso(),DecisionTreeRegressor(),RandomForestRegressor(),SVR(),KNeighborsRegressor()]","d8696978":"mean_scores = []\n\nfor model in models:\n    print(\"Model:\",model)\n    cv_score = cross_val_score(model,x,y,cv=3)\n    print(\"CV scores:\",cv_score)\n    mean_score = cv_score.mean()\n    print(\"Mean Score:\",mean_score)\n    print('\\n')\n    mean_scores.append(mean_score)","b98ea69c":"mean_scores = np.array(mean_scores)","d5fe0f2c":"plt.figure(figsize=(7,7))\nplt.barh(range(6),mean_scores[1:]*100)\nplt.title('Regression Models Mean Accuracy')\nplt.yticks(range(6),models[1:])\nplt.show()","08a4bc5b":"rf_model = RandomForestRegressor()\nrf_model.fit(x_train,y_train)\nrf_model.score(x_test,y_test)","dd9d9bbc":"dt_model = DecisionTreeRegressor()\ndt_model.fit(x_train,y_train)\ndt_model.score(x_test,y_test)","dc16c035":"def predict(model,x):\n    pred = model.predict(x)\n    return pred\n\ndef actual_vs_predicted(label,y_true,y_pred,title=None):\n    ap = pd.DataFrame({f'{label} Actual':y_true,f'{label} Predicted':y_pred})\n    \n    plt.figure(figsize=(7,7))\n    sns.scatterplot(data=ap, x=f'{label} Actual', y=f'{label} Predicted')\n    plt.title(title)\n    plt.show()","ffffc042":"y_test_pred = predict(dt_model,x_test)\n\nactual_vs_predicted('Test',y_test,y_test_pred,'Test Data Predictions')","dcca257e":"y_train_pred = predict(dt_model,x_train)\n\nactual_vs_predicted('Train',y_train,y_train_pred,'Train Data Predictions')","87824454":"# **Model Building**","94c1184d":"# **Feature Scaling**","f574c3a6":"# **Predictions**","cb66f9c3":"# **Size and Extra Sauce**","b29b847a":"# **Which Company produce which size of pizza(s).**","1ac33f30":"# **Feature Engineering**","31403236":"# **Train Data Predictions**","db4af2b8":"# **Exploratory Data Analysis**","460868e1":"# **Size and Extra cheese**","5903d131":"# **Train and Test data split**","2d2140ae":"# **Test Data Predictions**","bab34bbd":"# **Diameter and its size**","399be0e2":"# **Size Types**","c7369cba":"# **Let's Work on Decision Tree Regression**","11279773":"# **Toppings and extra cheese**","4e8e3585":"# **Splitting the Data**","a6dab6d0":"# **Size and It's topping**","fcbf4347":"# **Concact Dummies and DF**","120a4a93":"# **One Hot Encoding**","7d1c8f15":"# **Toppings and extra sauce**","9dca876a":"# **Companies Involved**","a19b3c3a":"# **Converting 'price_rupiah' column to numeric values**","9b6c553a":"# **Countplots of any two**"}}