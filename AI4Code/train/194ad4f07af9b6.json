{"cell_type":{"c01bc22e":"code","d6821f19":"code","35701a09":"code","5ceb50e1":"code","d37977f7":"code","e449faae":"code","744b4b71":"code","c020f165":"code","9cb46239":"code","05781b10":"code","b970d12e":"code","2073a7e8":"code","8f5d6b9a":"code","b51a5051":"code","f7db26e7":"code","925df81b":"code","32e4bfee":"code","31f0d3ae":"code","e591d48d":"code","24b7ae1b":"code","8236a7c6":"code","7676648a":"code","3e77b1db":"code","780e5a4f":"code","966ccffb":"code","f607078a":"code","698736a7":"code","22d816d4":"code","e582e8ee":"code","ce85655e":"code","d9ccdd59":"markdown","a93777b3":"markdown"},"source":{"c01bc22e":"import pandas as pd\nwater=pd.read_csv('..\/input\/water-potability\/water_potability.csv')\nwater.head()","d6821f19":"water.info()","35701a09":"water.describe()","5ceb50e1":"Potability_0=water[water.Potability==0]\nPotability_0.head()","d37977f7":"round(Potability_0.isnull().sum()*100\/len(Potability_0),2).sort_values(ascending=False)","e449faae":"Potability_0.describe()","744b4b71":"Potability_0.fillna(Potability_0.median(), inplace=True)\nPotability_0.describe()","c020f165":"Potability_1=water[water.Potability==1]\nPotability_1.head()","9cb46239":"round(Potability_1.isnull().sum()*100\/len(Potability_1),2).sort_values(ascending=False)","05781b10":"Potability_1.fillna(Potability_1.median(), inplace=True)\nPotability_1.describe()","b970d12e":"import numpy as np\nwater=pd.concat([Potability_1, Potability_0], axis=0)\nwater = water.iloc[np.random.permutation(len(water))]\nwater=water.reset_index(drop=True)\nwater.head()","2073a7e8":"water.nunique()","8f5d6b9a":"round(water.Potability.value_counts()*100\/len(water),2)","b51a5051":"data = water.sample(frac=0.8, random_state=42)\ndata_unseen = water.drop(data.index)\ndata.reset_index(inplace=True, drop=True)\ndata_unseen.reset_index(inplace=True, drop=True)\nprint('Data for Modeling: ' + str(data.shape))","f7db26e7":"print('Unseen Data For Predictions: ' + str(data_unseen.shape))","925df81b":"round(data.Potability.value_counts()*100\/len(data),2)","32e4bfee":"!pip install pycaret","31f0d3ae":"from pycaret.classification import *","e591d48d":"water_test= setup(data = data, target = 'Potability', session_id=42,\n                  normalize = True, \n                  transformation = True, \n                  log_experiment = True,\n                  handle_unknown_categorical = True, \n                  unknown_categorical_method = 'most_frequent',\n                  remove_multicollinearity = True, #rop one of the two features that are highly correlated with each other\n                  ignore_low_variance = True,#all categorical features with statistically insignificant variances are removed from the dataset.\n                  combine_rare_levels = True,\n                  fix_imbalance = True\n                 )","24b7ae1b":"catboost = create_model('catboost')","8236a7c6":"print(catboost)","7676648a":"tuned_catboost = tune_model(catboost,optimize = 'AUC')","3e77b1db":"plot_model(tuned_catboost, plot = 'auc')","780e5a4f":"plot_model(tuned_catboost, plot = 'pr')","966ccffb":"plot_model(tuned_catboost, plot='feature')","f607078a":"plot_model(tuned_catboost, plot = 'confusion_matrix')","698736a7":"evaluate_model(tuned_catboost)","22d816d4":"predict_model(tuned_catboost)","e582e8ee":"unseen_predictions = predict_model(tuned_catboost, data=data_unseen)\nunseen_predictions.head()","ce85655e":"print(\"Confidence Score :   {}\".format(round(unseen_predictions.Score.mean(),2)))#Confidence Score","d9ccdd59":"#### Treating Missing value for Potability_0 records","a93777b3":"#### Treating Missing value for Potability_1 records"}}