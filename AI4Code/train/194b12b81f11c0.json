{"cell_type":{"6e5215c7":"code","547f9c8c":"code","6f25b02f":"code","982d99e5":"code","41cc0219":"code","d49e80f5":"code","fcd26ab7":"code","5b3c1ed8":"code","2b984db5":"code","6f4e62e3":"code","2a9e5ef1":"code","af1ed6ff":"code","13a4a762":"code","8a9646e1":"code","9c0678e3":"code","d41cefa5":"code","7373ae45":"code","1bcb2ca8":"code","56b50325":"code","4383fdfc":"code","ec28221b":"code","b7add740":"code","240091d6":"markdown","ae2f34d6":"markdown"},"source":{"6e5215c7":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sn\nimport re","547f9c8c":"data= pd.read_csv('..\/input\/electronics\/electronics.csv')\ndata","6f25b02f":"data.isnull().sum()","982d99e5":"data['brand']=data.drop(['brand'],axis=1)\ndata['user_attr']=data.drop(['user_attr'],axis=1)\ndata.isnull().sum()","41cc0219":"sn.heatmap(data.corr(),annot=True)","d49e80f5":"pd.get_dummies(data[[\"model_attr\"]]).head()","fcd26ab7":"pd.get_dummies(data[['category']]).head()","5b3c1ed8":"data_elec= pd.concat([pd.get_dummies(data[[\"model_attr\"]]),pd.get_dummies(data[[\"category\"]]),data['item_id'],data['user_id'],data['rating'],data['year']],axis=1)\ndata_elec","2b984db5":"from sklearn.preprocessing import MinMaxScaler","6f4e62e3":"min_max_scaler = MinMaxScaler()\ndata_elec = min_max_scaler.fit_transform(data_elec)","2a9e5ef1":"np.round(data_elec,2)","af1ed6ff":"from sklearn.neighbors import NearestNeighbors","13a4a762":"nbrs = NearestNeighbors(n_neighbors=6, algorithm='auto').fit(data_elec)","8a9646e1":"distances, indices = nbrs.kneighbors(data_elec)","9c0678e3":"distances","d41cefa5":"indices","7373ae45":"def get_index_from_name(name):\n    return data[data[\"category\"]==name].index.tolist()[0]","1bcb2ca8":"get_index_from_name('Portable Audio & Video')","56b50325":"indices[0][1:]","4383fdfc":"data.iloc[indices[0][1:],:]['user_id']","ec28221b":"def print_similar_names(user_id=None):\n     if user_id:\n        found_id = get_index_from_name(user_id)\n        for id in indices[found_id][1:]:\n            print(data.iloc[id][\"user_id\"],'[','User ID =',data.iloc[id][\"model_attr\"],',','Category =',data.iloc[id][\"category\"],']')","b7add740":"#print_similar_names(input('user_id=')) # prediction by user_id","240091d6":"# prediction by user_id","ae2f34d6":"# **Using KNN algorithm to find our prediction**"}}