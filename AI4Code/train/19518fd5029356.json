{"cell_type":{"656e7fc4":"code","de81cac7":"code","82ff7f16":"code","d694eb16":"code","016240b9":"code","cd3be8fd":"code","fbbf7c5e":"code","b7949d68":"code","e69c3abb":"code","d5fd8a38":"code","05d6e778":"code","7307c3df":"code","f4d8fc66":"code","2bd894de":"code","7ee6d3d1":"code","c3feec37":"code","719054dc":"code","98acaf3b":"code","6967058b":"code","67afa5e4":"code","32bef0b5":"code","2154855c":"code","fbd07001":"code","8b4aef77":"markdown","4ecacda1":"markdown"},"source":{"656e7fc4":"# Installing Dependencies\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport pandas_datareader as web\nimport datetime as dt\n\nimport math\n\nfrom sklearn.metrics import mean_squared_error\nfrom sklearn.preprocessing import MinMaxScaler\nfrom tensorflow.keras.layers import Dense, Dropout, LSTM\nfrom tensorflow.keras.models import Sequential","de81cac7":"#PRIMARY OPTION - Grabs pricing for Bitcoin from YahooFinance\ncrypto = 'BTC' #Change code to cryptocurrency of choice\ncurrency = 'USD'#Change code to fiat currency of choice\n\nstart = dt.datetime(2016,1,1)\nend = dt.datetime.now()\n\ndf = web.DataReader(f'{crypto}-{currency}', data_source='yahoo', start=start, end=end)","82ff7f16":"#SECONDARY OPTION - Grabs pricing for Bitcoin from crytocurrencypricehistory, a historical cryptocurrency dataset\n#df = pd.read_csv('..\/input\/backupdataset')","d694eb16":"df.head()","016240b9":"df.tail()","cd3be8fd":"df.shape","fbbf7c5e":"df.describe()","b7949d68":"df.isnull().sum()","e69c3abb":"#Draws line plot based on current date and closing price data available\nsns.set(rc = {'figure.figsize':(16,8)})\nplt.legend(bbox_to_anchor=(1.05, 1), loc=2, borderaxespad=0.)\nplt.title(f'{crypto} Close Price History', fontsize=16)\nplt.ylabel(f'Close Price ({currency})', fontsize=14)\nplt.xlabel('Date', fontsize=14)\nax = sns.lineplot(data=df,x='Date',y='Close')\nplt.show()","d5fd8a38":"#Scales data\nscaler = MinMaxScaler(feature_range=(0,1))\n#Pulls only 'Close' column and reshapes data\nscaled_data = scaler.fit_transform(df['Close'].values.reshape(-1,1))\n#Assigns number of days the prediction is based on\nprediction_days = 60","05d6e778":"x_train = []\ny_train = []\n\n#Grabs 59 days for x_train and the 60th day for y_train\nfor i in range (prediction_days, len(scaled_data)):\n    x_train.append(scaled_data[i-prediction_days:i, 0])\n    y_train.append(scaled_data[i, 0])","7307c3df":"#Converts to numpy array\nx_train = np.array(x_train)\ny_train = np.array(y_train)","f4d8fc66":"#Adds additional dimension as the model requires 3 dimensions\nx_train = np.reshape(x_train, (x_train.shape[0], x_train.shape[1], 1))","2bd894de":"#Builds Neural Network\nmodel = Sequential()\n#Adds LSTM layer\nmodel.add(LSTM(units=50, return_sequences=True, input_shape=(x_train.shape[1], 1)))\n#Prevents overfitting\nmodel.add(Dropout(0.2))\nmodel.add(LSTM(units=50, return_sequences=True))\nmodel.add(Dropout(0.2))\nmodel.add(LSTM(units=50))\nmodel.add(Dropout(0.2))\n#Actual price prediction\nmodel.add(Dense(units=1))","7ee6d3d1":"#Compiles model\nmodel.compile(optimizer='adam', loss='mean_squared_error')\nmodel.fit(x_train, y_train, epochs=200, batch_size=32)","c3feec37":"#Testing model\n#Assigns start and end times for the test\ntest_start = dt.datetime.now() - dt.timedelta(days=365)\ntest_end = dt.datetime.now()\n#Applies start and end times to the test\ntest_data = web.DataReader(f'{crypto}-{currency}', 'yahoo', test_start, test_end)\n#Assigns the actual closing prices to a value\nactual_prices = test_data['Close'].values\n#Combines the original dataset with the test dataset\ntotal_dataset = pd.concat((df['Close'], test_data['Close']), axis=0)","719054dc":"#Creates model inputs to be used for prediction\n#Takes the total dataset and removes any data being used for testing\nmodel_inputs = total_dataset[len(total_dataset) - len(test_data) - prediction_days:].values\nmodel_inputs = model_inputs.reshape(-1, 1)\n#Scales model inputs to test scale\nmodel_inputs = scaler.fit_transform(model_inputs)","98acaf3b":"#Creates test data\nx_test = []\nfor i in range(prediction_days, len(model_inputs)):\n    x_test.append(model_inputs[i-prediction_days:i, 0])\n    \nx_test = np.array(x_test)\nx_test = np.reshape(x_test, (x_test.shape[0], x_test.shape[1], 1))","6967058b":"#Pulls actual prediction for every 60th day based on the past 59 days\nprediction_prices = model.predict(x_test)\n#Reverts prior scaling\nprediction_prices = scaler.inverse_transform(prediction_prices)","67afa5e4":"#Draws line plot based on current date and closing price data available\nplt.plot(actual_prices, color='red', label='Actual prices')\nplt.plot(prediction_prices, color='green', label='Predicted prices')\nplt.title(f'{crypto} to {currency} Price Prediction', fontsize=16)\nplt.xlabel('Time (Days)', fontsize=14)\nplt.ylabel(f'Close Price ({currency})', fontsize=14)\nplt.legend(loc='upper left')\nplt.show()","32bef0b5":"#Re-scales actual and prediction pricing data for RMSE values\nactual_norm = scaler.fit_transform(actual_prices.reshape(-1,1))\nprediction_norm = scaler.fit_transform(prediction_prices.reshape(-1,1))\n#Compares scaled real pricing data to scaled predicted pricing data to ascertain RMSE value\nrmse = math.sqrt(mean_squared_error(actual_norm,prediction_norm))\nprint(\"Root Mean Square Error:\", rmse)","2154855c":"#Adds extra date to computation for future date calculations\nreal_data = [model_inputs[len(model_inputs) + 1 - prediction_days:len(model_inputs) + 1, 0]]\nreal_data = np.array(real_data)\nreal_data = np.reshape(real_data, (real_data.shape[0], real_data.shape[1], 1))","fbd07001":"#Performs prediction for tomorrow's closing price\nprediction = model.predict(real_data)\nprediction = scaler.inverse_transform(prediction)\nprint(crypto, \"Predicted Closing Price for Tomorrow:\", prediction, currency)","8b4aef77":"**SECONDARY (BACKUP) OPTION FOR PRICING DATASET**","4ecacda1":"**PRIMARY OPTION FOR PRICING DATASET**"}}