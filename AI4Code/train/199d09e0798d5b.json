{"cell_type":{"d3863417":"code","e72cfd6d":"code","7b52ed9f":"code","1020262f":"code","b96dc215":"code","5c6cce2f":"code","522722a0":"code","3c45dd82":"code","0abd9a86":"markdown"},"source":{"d3863417":"import sys\npackage_dir = '..\/input\/autokeras-april-2021'\nsys.path.insert(0, package_dir)","e72cfd6d":"import os\n\nimport numpy as np\nimport pandas as pd\nimport tensorflow as tf\n\nimport autokeras as ak","7b52ed9f":"train_file = pd.read_csv(\"..\/input\/commonlitreadabilityprize\/train.csv\")\ntrain_file = train_file[['excerpt', 'target']]\ntrain_file['excerpt'] = train_file['excerpt'].apply(lambda x: \"<START> \"+x+\" <END>\")\n\ntrain = train_file[:2800]\nvalid = train_file[2800:]","1020262f":"train_data = train['excerpt'].values\ntrain_target = train['target'].values\n\nvalid_data = valid['excerpt'].values\nvalid_target = valid['target'].values\n\nprint(train_data.shape, train_target.shape)\nprint(valid_data.shape, valid_target.shape)","b96dc215":"# Initialize the text regressor.\nreg = ak.TextRegressor(overwrite=True, max_trials=7)  # It tries 10 different models.\n# Feed the text regressor with training data.\nreg.fit(train_data, train_target, epochs=25)\n# Predict with the best model.\npredicted_y = reg.predict(valid_data)\n# Evaluate the best model with testing data.\nprint(reg.evaluate(valid_data, valid_target))","5c6cce2f":"# Testing code\ntest_file = pd.read_csv(\"..\/input\/commonlitreadabilityprize\/test.csv\")\ntest_ids = test_file['id'].tolist()\ntest_text = test_file['excerpt'].apply(lambda x: \"<START> \"+x+\" <END>\").values\n\ntest_file.head()","522722a0":"# Get the predictions \npreds = reg.predict(test_text).squeeze().tolist()","3c45dd82":"# Store into a dataframe\nsubmission = pd.DataFrame()\nsubmission['id'] = test_ids\nsubmission['target'] = preds\n\n# Save the dataframe\nsubmission.to_csv(\"submission.csv\", index=None)","0abd9a86":"# Basic Text Regressor using Auto-Keras\n\nCurrently very very basic and I will be adding more preprocessing steps later."}}