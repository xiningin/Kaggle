{"cell_type":{"e8e691f1":"code","2048710b":"code","de50fab6":"code","18800c5f":"code","a0d9751a":"code","2ed54906":"code","04d5bb17":"code","90fb7197":"code","24155ae5":"code","a7f2f45d":"code","59f9319e":"code","c4f50000":"code","bc861c5c":"code","e43bdaf8":"code","92ed9779":"code","9c689f9a":"code","e0298d07":"markdown","18d7e68d":"markdown"},"source":{"e8e691f1":"import numpy as np, pandas as pd\nfrom glob import glob\nimport shutil, os\nimport matplotlib.pyplot as plt\nfrom sklearn.model_selection import GroupKFold\nfrom tqdm.notebook import tqdm\nimport seaborn as sns\nimport cv2\nfrom os import listdir\nfrom os.path import isfile, join\nimport yaml","2048710b":"import torch\nfrom IPython.display import Image, clear_output","de50fab6":"# shutil.copytree, essential but can run only once\nif  '\/kaggle\/working\/yolov5' not in os.listdir('\/kaggle\/working\/'):\n    shutil.copytree('\/kaggle\/input\/yolov5-official-v31-dataset\/yolov5', '\/kaggle\/working\/yolov5') ","18800c5f":"os.chdir('\/kaggle\/working\/yolov5')\nclear_output()\nprint('Setup complete. Using torch %s %s' % (torch.__version__, torch.cuda.get_device_properties(0) if torch.cuda.is_available() else 'CPU'))","a0d9751a":"# shutil.copytree, essential but can run only once\nif '\/kaggle\/working\/images' not in os.listdir('\/kaggle\/working\/'):\n    shutil.copytree('\/kaggle\/input\/self-driving-cars\/images', '\/kaggle\/working\/images')","2ed54906":"for item in os.listdir('\/kaggle\/working\/images'):\n    if item[:-4][-1]!='0' and item[:-4][-1]!='5':\n        os.remove('\/kaggle\/working\/images\/'+item)\nprint(os.listdir('\/kaggle\/working\/images')[0:10])","04d5bb17":"!python detect.py --weights yolov5s.pt --img 640 --conf 0.25 --source ..\/images\/","90fb7197":"from matplotlib import animation, rc\nrc('animation', html='jshtml')","24155ae5":"def create_animation(ims):\n    fig=plt.figure(figsize=(12,12))\n    plt.axis('off')\n    im=plt.imshow(cv2.cvtColor(ims[0],cv2.COLOR_BGR2RGB))\n    \n    def animate_func(i):\n        im.set_array(cv2.cvtColor(ims[i],cv2.COLOR_BGR2RGB))\n        return [im]\n\n    return animation.FuncAnimation(fig, animate_func, frames=len(ims), interval=1000\/\/4)","a7f2f45d":"imgdir ='\/kaggle\/working\/yolov5\/runs\/detect\/exp\/' ","59f9319e":"paths0=[]\nfor dirname, _, filenames in os.walk(imgdir):\n    for filename in filenames:\n        paths0+=[os.path.join(dirname, filename)]\npaths0[0:5]","c4f50000":"paths1=[]\nfor item in paths0:\n    if item[-4:]=='.jpg':\n        paths1+=[item]\npaths1[0:5]","bc861c5c":"order=[]\nfor item in paths1:\n    order+=[int(item[:-6].split('\/')[-1])]\npaths2=pd.DataFrame(paths1)\npaths2[1]=order\npaths2.columns=['path','int']\npaths2=paths2.sort_values('int')\npaths3=paths2['path'].tolist()\npaths3[0:5]","e43bdaf8":"images0=[]\nfor i in tqdm(range(0,len(paths3),1)):\n    images0+=[cv2.imread(paths3[i])]","92ed9779":"print(len(images0))","9c689f9a":"create_animation(np.array(images0)[400:800])","e0298d07":"# Create animation","18d7e68d":"# YOLOv5"}}