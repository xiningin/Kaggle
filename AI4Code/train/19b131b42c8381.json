{"cell_type":{"4eb170ce":"code","269f6862":"code","2d7ef68b":"code","7995e4da":"code","bc422872":"code","a0521adc":"code","2a5d1250":"code","976e8b60":"code","6f161ed6":"code","5f14c771":"code","046c44c6":"code","f0a25d62":"code","6dbf7e5d":"code","f982f6da":"code","2a0b42f7":"code","9476ef0a":"markdown"},"source":{"4eb170ce":"import pandas as pd\nimport numpy as np","269f6862":"from keras.datasets import mnist\nfrom keras.models import Sequential\nfrom keras.layers import Dense,Conv2D,MaxPool2D,Dropout,Flatten\nfrom keras.losses import categorical_crossentropy\nfrom keras.optimizers import RMSprop\nfrom keras.metrics import categorical_accuracy\nfrom keras.utils import to_categorical","2d7ef68b":"df_train=pd.read_csv(\"\/kaggle\/input\/digit-recognizer\/train.csv\")\ndf_test=pd.read_csv(\"\/kaggle\/input\/digit-recognizer\/test.csv\")","7995e4da":"df_train.head()","bc422872":"X=df_train.drop('label',axis=1)\/255\nY=to_categorical(df_train['label'])","a0521adc":"X=np.array(X).reshape(42000,28,28,1)\nX_predict=np.array(df_test\/255).reshape(28000,28,28,1)","2a5d1250":"from sklearn.model_selection import train_test_split\nX_train,X_test,Y_train,Y_test=train_test_split(X,Y,test_size=0.2,random_state=101)","976e8b60":"network=Sequential()\nnetwork.add(Conv2D(128,(3,3),activation='relu',input_shape=(28,28,1)))\nnetwork.add(MaxPool2D(2,2))\nnetwork.add(Conv2D(128,(3,3),activation='relu'))\nnetwork.add(MaxPool2D(2,2))\nnetwork.add(Conv2D(128,(3,3),activation='relu'))\n#network.add(MaxPool2D(2,2))\nnetwork.add(Flatten())\nnetwork.add(Dropout(0.2))\nnetwork.add(Dense(256,activation='relu'))\nnetwork.add(Dense(512,activation='relu'))\nnetwork.add(Dense(256,activation='relu'))\nnetwork.add(Dense(10,activation='softmax'))","6f161ed6":"network.summary()","5f14c771":"network.compile(loss='categorical_crossentropy',optimizer=RMSprop(lr=0.0001),metrics=['acc'])","046c44c6":"network.fit(X_train,Y_train,epochs=30,batch_size=256)","f0a25d62":"network.evaluate(X_test,Y_test,batch_size=128)","6dbf7e5d":"submission=pd.DataFrame(range(1,df_test.shape[0]+1),columns=['ImageId'])\nsubmission['Label']=network.predict_classes(X_predict,batch_size=128)\nsubmission.head(5)","f982f6da":"filename='submission.csv'\nsubmission.to_csv(filename,index=False)","2a0b42f7":"from IPython.display import FileLink\nFileLink(filename)","9476ef0a":"Train the model with complete training data and do prediction for the test set to get better result"}}