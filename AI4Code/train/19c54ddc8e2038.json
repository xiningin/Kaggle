{"cell_type":{"f1f16812":"code","5434a207":"code","0e533eb6":"code","3b15314b":"code","c5ad0790":"code","0b3bf52a":"code","ab4b9b1e":"code","ce0b0cae":"code","eda302e8":"code","80ca83ec":"code","41edf6fd":"code","078c0fa1":"code","932102f0":"code","96b794bc":"code","7c8ab1f5":"code","86b05aef":"code","72d06a8f":"code","d4267fb0":"code","65818782":"code","4f08a1cd":"code","88c2ee70":"code","76284c20":"code","9419a203":"code","5010b3ed":"code","a09c0132":"code","545a751a":"code","75f44cb2":"code","2d051a7b":"code","655ade76":"code","950e7543":"code","a930de7f":"code","8bc33bf0":"code","6964147d":"code","ca1e0949":"markdown","967e2ccd":"markdown","58a44c0f":"markdown"},"source":{"f1f16812":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline","5434a207":"train = pd.read_csv('..\/input\/digit-recognizer\/train.csv')\ntest = pd.read_csv('..\/input\/digit-recognizer\/test.csv')","0e533eb6":"y_train= train['label']","3b15314b":"X_train = np.array(train.drop('label',axis=1))","c5ad0790":"img= X_train[1].reshape(28,28)\nplt.imshow(img,cmap='gist_gray')","0b3bf52a":"X_train = X_train.reshape(42000,28,28,1)","ab4b9b1e":"X_train.shape","ce0b0cae":"from sklearn.model_selection import train_test_split","eda302e8":"X_train1, X_test, y_train1, y_test = train_test_split(X_train, y_train, test_size=0.33, random_state=42)","80ca83ec":"from tensorflow.keras.utils import to_categorical","41edf6fd":"y_cat_train1 = to_categorical(y_train1)\ny_cat_test = to_categorical(y_test)","078c0fa1":"y_cat_test.shape","932102f0":"from tensorflow.keras.models import Sequential\nfrom tensorflow.keras.layers import Dense,Conv2D,MaxPool2D,Flatten,Dropout\nfrom tensorflow.keras.callbacks import EarlyStopping","96b794bc":"model = Sequential()\n\n#Convolution layer\nmodel.add(Conv2D(filters=64,kernel_size=(4,4),activation='relu',input_shape=(28,28,1)))\n#Pooling layer\nmodel.add(MaxPool2D())\n\n#Convolution layer\nmodel.add(Conv2D(filters=64,kernel_size=(4,4),activation='relu',input_shape=(28,28,1)))\nmodel.add(Conv2D(filters=64,kernel_size=(4,4),activation='relu',input_shape=(28,28,1)))\nmodel.add(Conv2D(filters=64,kernel_size=(4,4),activation='relu',input_shape=(28,28,1)))\n#Pooling layer\nmodel.add(MaxPool2D())\n\n#Flatten\nmodel.add(Flatten())\n\n#Dense layer\nmodel.add(Dense(128,activation='relu'))\nDropout(0.4)\n#Output layer\nmodel.add(Dense(10,activation='softmax'))\n\n#Compiling\nmodel.compile(loss='categorical_crossentropy',optimizer='adam',\n             metrics=['accuracy'])","7c8ab1f5":"model.summary()","86b05aef":"early_stop = EarlyStopping(monitor='val_loss',patience=2)","72d06a8f":"model.fit(X_train1,y_cat_train1,epochs=20,validation_data=(X_test,y_cat_test),callbacks=early_stop)","d4267fb0":"metrics = pd.DataFrame(model.history.history)","65818782":"metrics","4f08a1cd":"metrics.columns","88c2ee70":"metrics[['loss','val_loss']].plot()\nmetrics[['accuracy','val_accuracy']].plot()","76284c20":"predictions = np.argmax(model.predict(X_test),axis=-1)","9419a203":"from sklearn.metrics import classification_report","5010b3ed":"print(classification_report(y_test,predictions))","a09c0132":"X_test_1 = np.array(test)","545a751a":"X_test_1.shape","75f44cb2":"X_test_1=X_test_1.reshape(28000,28,28,1)","2d051a7b":"predictions = np.argmax(model.predict(X_test_1),axis=-1)","655ade76":"df = pd.DataFrame(predictions,columns=['Label'])","950e7543":"ImageId = [i for i in range(1,28001)]","a930de7f":"df['ImageId']=ImageId","8bc33bf0":"df = df.set_index('ImageId')","6964147d":"df.to_csv('submission1.csv')","ca1e0949":"## Model Creation","967e2ccd":"## Train test split","58a44c0f":"## Predictions on test data"}}