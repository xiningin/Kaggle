{"cell_type":{"8bf65db1":"code","290b5445":"code","d2b63bf7":"code","88990093":"code","a18fdb8b":"code","8c8c85be":"code","badc9448":"code","c5fdb7c9":"code","0180998b":"code","6d80feb4":"code","6920d79e":"code","4fab40b0":"code","33a2da22":"code","5002ebd6":"code","63e3da58":"code","d2471eca":"code","50829a54":"code","bc4d83a3":"code","8111f429":"code","3db71a8a":"code","391bca54":"code","29fcfb53":"code","dcfcb040":"code","5500d798":"code","ac558bc4":"code","b511949a":"code","e603fbf3":"code","c44fe975":"code","d97bb030":"code","89d016b1":"code","896f4236":"code","ca823c0c":"code","9ffb930f":"code","64f89422":"code","9a2a8f54":"code","27ddf18b":"code","ba82474f":"code","3e502ca5":"code","4d017216":"code","fb104840":"code","c3b4d915":"code","5bf62a9b":"code","dedab6b3":"code","10103ec4":"code","cb67b2e7":"code","5b4448a4":"code","15778045":"code","d662418e":"markdown"},"source":{"8bf65db1":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\nsns.set(style=\"whitegrid\")\nimport os\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LogisticRegression\nimport scipy\nfrom scipy import ndimage\nimport glob as gb\nimport cv2\nimport tensorflow as tf\nimport keras\nfrom keras.preprocessing.image import ImageDataGenerator\nimport random\nimport skimage\nfrom scipy import misc , ndimage\nfrom keras.applications.inception_v3 import preprocess_input\nfrom keras.utils import to_categorical\nfrom keras.optimizers import Adam\nfrom keras import backend as K\nfrom keras.models import Model\nfrom keras.layers import Dense\nfrom keras import optimizers\nfrom keras.preprocessing.image import ImageDataGenerator\nfrom keras.preprocessing import image\nfrom sklearn.metrics import classification_report, confusion_matrix, accuracy_score\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.svm import SVC, LinearSVC\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.naive_bayes import GaussianNB\nfrom sklearn.linear_model import Perceptron\nfrom sklearn.linear_model import SGDClassifier\nfrom sklearn.tree import DecisionTreeClassifier","290b5445":"Data = pd.read_csv('..\/input\/the-factors-determining-the-preference-for-vaccine\/Data.csv', keep_default_na=False , na_values=[' '])","d2b63bf7":"Data['covid_vaccine']","88990093":"Data.head(20)","a18fdb8b":"f,ax = plt.subplots(figsize=(50, 50))\nsns.heatmap(pd.DataFrame(Data).corr(), annot=True, linewidths=.5, fmt= '.1f',ax=ax)","8c8c85be":"Data.info()","badc9448":"total = Data.isnull().sum().sort_values(ascending=False)\npercent = (Data.isnull().sum()\/Data.isnull().count()).sort_values(ascending=False)\nmissing_data = pd.concat([total, percent], axis=1, keys=['Total', 'Percent'])\nmissing_data.head(20)","c5fdb7c9":"Data_New = Data.drop(['fm_mem_covid_hospitalized', 'family_member_covid_test', 'fam_mem_covid_dx', 'covid_vaccine_cause___4', 'covid_vaccine_cause___5', 'covid_vaccine_cause___3', 'covid_vaccine_cause___2', 'covid_vaccine_cause___1', 'Region', 'Knowledge_normalized', 'Perceived_threat_normalized', 'child', 'baby_wipes', 'hot_beverages', 'Census_region', 'US_State', 'nasal_spray', 'summary_explanation_of_research_timestamp', 'Perceived_threat_normalized', 'Knowledge_normalized'], axis=1)\nData_New.head(10)","0180998b":"Data_New.info()","6d80feb4":"Data_New.describe()","6920d79e":"Data_New.mode()","4fab40b0":"Data_New.describe(include=['O'])","33a2da22":"Data_New = Data_New.rename(columns = {\"Vaccine_Launch (PRE_POST)\":\"Vaccine_Launch\"})","5002ebd6":"Data_New.describe(include=['O'])","63e3da58":"Data_New['your_race'].fillna('White', inplace=True)\nData_New['Gender_string'].fillna('Female', inplace=True)\nData_New['Vaccine_Launch'].fillna('Yes', inplace=True)","d2471eca":"Data_New['Gender'] = pd.Series(len(Data_New['Gender_string']), index=Data_New.index)\nData_New['Gender'] = 0 \nData_New.loc[Data_New['Gender_string']== 'Male','Gender'] = 0\nData_New.loc[Data_New['Gender_string']== 'Female','Gender'] = 1\nData_New.head()","50829a54":"final = pd.get_dummies(Data_New, prefix=['your_race'], columns=['your_race'])","bc4d83a3":"final.head()","8111f429":"final['VaccineLaunch'] = pd.Series(len(final['Vaccine_Launch']), index=final.index)\nfinal['VaccineLaunch'] = 0\nfinal.loc[final['Vaccine_Launch']== 'No','VaccineLaunch'] = 0\nfinal.loc[final['Vaccine_Launch']== 'Yes','VaccineLaunch'] = 1\nfinal.head()","3db71a8a":"Data_N = final.drop(['Vaccine_Launch', 'Gender_string'], axis=1)","391bca54":"Data_N.head()","29fcfb53":"Data_N.info()","dcfcb040":"Data_N.columns","5500d798":"cols = [\"healthcare_worker\", \"family_member_covid\", \"covid_follow\",\n       \"covid_information_source___1\", \"covid_information_source___2\",\n       \"covid_information_source___3\", \"covid_information_source___4\",\n       \"covid_information_source___5\", \"covid_information_source___6\",\n       \"covid_information_source___7\", \"covid_information_source___8\",\n       \"covid_information_source___9\", \"covid_information_source___10\",\n       \"confine\", \"job\", \"infection\", \"food\", \"death\", \"hospital_access\",\n       \"covid_state\", \"sd\", \"ld\", \"hw\", \"fm\", \"er\", \"reopening\", \"second_wave\",\n       \"number\", \"state\", \"belief\", \"age\", \"smoke\", \"dm\", \"immune\",\n       \"hosp_rate\", \"death_rate\", \"incubation\", \"corona\", \"animal\",\n       \"screening\", \"hand_wash\", \"climate\", \"sunlight\", \"hand_sanitize\",\n       \"covid_symptoms___1\", \"covid_symptoms___2\", \"covid_symptoms___3\",\n       \"covid_symptoms___4\", \"covid_symptoms___5\", \"vaccine_pcv_flu\",\n       \"mask_gloves___1\", \"mask_gloves___2\", \"social_distance_feet\",\n       \"isolation\", \"corona_live\", \"spread___1\", \"spread___2\", \"spread___3\",\n       \"spread___4\", \"chloroquin\", \"drug_trial\", \"vaccine_trial\", \"hospital\",\n       \"vent\", \"administration\", \"new_vaccine\", \"new_medication\",\n       \"covid_vaccine\", \"flu_shot_y_n\", \"confidence_level\", \"your_age\",\n       \"your_education\", \"financial_status\", \"Gender\", \"your_race_White\",\"your_race_Asian\",\"your_race_Hispanic\",\"your_race_Black\",\"your_race_Other\",\n       \"VaccineLaunch\"]\nData_N[cols]=Data_N[cols].fillna(Data_N.mode().iloc[0])","ac558bc4":"Data_N.head(10)","b511949a":"Data_N.info()","e603fbf3":"X = Data_N.drop(['covid_vaccine'], axis=1)\ny = Data_N[\"covid_vaccine\"]\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.30, random_state=30 , shuffle= True)","c44fe975":"X_train.shape, y_train.shape, X_test.shape","d97bb030":"y_test","89d016b1":"#Logistic Regression\nlogreg = LogisticRegression(solver='lbfgs', max_iter=100000)\nlogreg.fit(X_train, y_train)\nscore = logreg.score(X_train, y_train)\nscore2 = logreg.score(X_test, y_test)\nacc_log = round(logreg.score(X_test, y_test) * 100, 2)\nacc_log\n#print(\"Training set accuracy: \", '%.3f'%(score))\n#print(\"Test set accuracy: \", '%.3f'%(score2))","896f4236":"# Support Vector Machines\nsvc = SVC(max_iter=100000 ,probability=True)\nsvc.fit(X_train, y_train)\nY_pred = svc.predict(X_test)\nacc_svc = round(svc.score(X_test, y_test) * 100, 2)\nacc_svc","ca823c0c":"#knn \nknn = KNeighborsClassifier(n_neighbors = 3)\nknn.fit(X_train, y_train)\nY_pred = knn.predict(X_test)\nacc_knn = round(knn.score(X_test, y_test) * 100, 2)\nacc_knn","9ffb930f":"#Gaussian Naive Bayes\ngaussian = GaussianNB()\ngaussian.fit(X_train, y_train)\nY_pred = gaussian.predict(X_test)\nacc_gaussian = round(gaussian.score(X_test, y_test) * 100, 2)\nacc_gaussian","64f89422":"#Perceptron\nperceptron = Perceptron(max_iter=100000)\nperceptron.fit(X_train, y_train)\nY_pred = perceptron.predict(X_test)\nacc_perceptron = round(perceptron.score(X_test, y_test) * 100, 2)\nacc_perceptron","9a2a8f54":"# Linear SVC\nlinear_svc = LinearSVC(max_iter=100000)\nlinear_svc.fit(X_train, y_train)\nY_pred = linear_svc.predict(X_test)\nacc_linear_svc = round(linear_svc.score(X_test, y_test) * 100, 2)\nacc_linear_svc","27ddf18b":"# Stochastic Gradient Descent\nsgd = SGDClassifier(max_iter=10000000)\nsgd.fit(X_train, y_train)\nY_pred = sgd.predict(X_test)\nacc_sgd = round(sgd.score(X_test, y_test) * 100, 2)\nacc_sgd","ba82474f":"# Decision Tree\ndecision_tree = DecisionTreeClassifier()\ndecision_tree.fit(X_train, y_train)\nY_pred = decision_tree.predict(X_test)\nacc_decision_tree = round(decision_tree.score(X_test, y_test) * 100, 2)\nacc_decision_tree","3e502ca5":"# Random Forest\nrandom_forest = RandomForestClassifier(n_estimators=20,random_state=1)\nrandom_forest.fit(X_train, y_train)\nY_pred = random_forest.predict(X_test)\nrandom_forest.score(X_train, y_train)\nacc_random_forest = round(random_forest.score(X_test, y_test) * 100, 2)\nacc_random_forest","4d017216":"models = pd.DataFrame({\n    'Model': ['Support Vector Machines', 'KNN', 'Logistic Regression', \n              'Random Forest', 'Naive Bayes', 'Perceptron', \n              'Stochastic Gradient Decent', 'Linear SVC', \n              'Decision Tree'],\n    'Score': [acc_svc, acc_knn, acc_log, \n              acc_random_forest, acc_gaussian, acc_perceptron, \n              acc_sgd, acc_linear_svc, acc_decision_tree]})\nmodels.sort_values(by='Score', ascending=False)","fb104840":"predictions = random_forest.predict_proba(X_test)","c3b4d915":"y_pred=svc.predict(X_test)","5bf62a9b":"cm=confusion_matrix(y_test,y_pred)\ncm","dedab6b3":"from mlxtend.plotting import plot_confusion_matrix\nimport matplotlib.pyplot as plt\nimport numpy as np\nfig, ax = plot_confusion_matrix(conf_mat=cm, show_absolute=True,\n                                show_normed=True,\n                                colorbar=True)\nplt.show()","10103ec4":"from sklearn.metrics import precision_recall_fscore_support as score\nprecision, recall, fscore, support = score(y_test, y_pred)\nprint('precision: {}'.format(precision))\nprint('recall: {}'.format(recall))\nprint('fscore: {}'.format(fscore))","cb67b2e7":"import sklearn\nfrom sklearn.metrics import f1_score, precision_score, recall_score\nsklearn.metrics.f1_score(y_test, y_pred, labels=None, pos_label=1, average='weighted')","5b4448a4":"sklearn.metrics.precision_score(y_test, y_pred, labels=None, pos_label=1, average='weighted')\n","15778045":"sklearn.metrics.recall_score(y_test, y_pred, labels=None, pos_label=1, average='weighted')","d662418e":"**Introduction**\n\nCoronavirus vaccines and the beginning of the vaccination program caused some controversy about the importance of the vaccine. Some people were greatly influenced by conspiracy theories and refused the vaccine due to the widespread of fake news about it, while others have personal exceptions for not accepting the vaccine.\n\nThe outbreak of the Corona virus and the large number of infections required the use of machine learning techniques which help to struggle the virus rapidly. As the capacity for immediate clinical decisions and effective usage of healthcare resources is decisive, a lot of work is related to machine learning techniques that rely on machine learning emerged.  This work has tried to help health centers, doctors and health workers in their decisive effort to eliminate the pandemic. One of the methods of work that emerged focused on predicting infection with the Corona virus using eight features like sex, age, known contact with an infected individual and the appearance of five initial clinical symptoms. Other work focused on deep learning such as trying to detect the infection through images taken by CT and X-Ray scans of infected patients.\n\nThe idea in this project is to predict the percentage of the acceptance of coronavirus.  This will be done using dataset which was taken from \u201cMendeley Data\u201d website. The dataset includes information about US citizens like age, race, education level and financial statues.\n\nPredicting the likelihood of receiving the vaccine in the community is an effective option to struggle the virus. The higher rate of acceptance of the vaccine in the community means increasing the ability to get rid of the virus. On the other hand, decreasing this percentage requires taking measures such as raising awareness and struggling the misleading information about the vaccine that widely spread on social media.\n\nIn this project, many machine learning algorithms have been used for the prediction task like logistic regression, Random Forest, KNN and Support Vector Machine. The results showed acceptable accuracy achieved by most of these algorithms.\n\n**MATERIALS AND METHODS**\n\n* Dataset Description\nThe dataset which was used in this work was taken from \u201cMendeley Data\u201d website and includes information from approximately 2978 respondents. This information includes 94 features like age, gender, sources of Covid-19 updates, financial status, race and education level all of which was collected through a survey. The survey was conducted on the assumption that socio-demographic factors can affect the decision about accepting a vaccine or not. The survey showed that 81.1% of the participants indicated their willingness to accept the vaccine.\n\nThe features in the dataset were used as input while \u201ccovid_vaccine\u201d feature was used as output. \u201ccovid_vaccine\u201d feature represents the answer of the question: Would you like to get COVID-19 vaccine, If available?\nThe dataset was divided to two parts, first part was used as train data while second part was used as test data with ratio of 70% and 30% respectively.\n\n* Data Processing\nThe database that was used in this project was not ideal as it had many flaws such as misinformation. In addition, there are many features which have object type and must be converted into numbers to allow computer interpretation. \n\nInitially, the data was checked to get idea about the null cells for each feature. The features which have high number of null cells were dropped. Most of the dropped features are not important and don\u2019t affect the prediction task (i.e. US_State, child and nasal_spray). For example, the state where the respondent lives, doesn't affect his decision to accept or refuse the vaccine. \u201cYour_race\u201d feature wasn\u2019t dropped because the number of null cells is not high and it is considered as an important factor which can affect the result. The number of remaining features is 76.\n\nMany of these 76 features also have null cells but they were treated in a different way; however, the null cells in these features were filled with the most frequent integer, float or object. For example, the most frequent integer in \u201chealthcare_worker\u201d feature was 0. This feature describes if the respondent is healthcare worker (1) or not (0).\n\nThe same procedure was applied to the features which have object components where the null cells were filled with the most frequent object. After filling the null cells, object values in the features were replaced by integers to present it which is an important step for prediction task. For example, the components of the feature \u201cGender_string\u201d were replaced as follows: Male=0 and Female=1. In addition, some features like \u201cyour_race\u201d were encoded as a one-hot numeric array.\nData selection technique was used to eliminate the features that don\u2019t have correlation with the output.\n\nThe heat map shows the correlation between the features. The features which have positive and negative correlation with the output were kept. The number of remaining features after applying this technique are 44.\n\n\n**Experiments**\n\nMachine learning algorithms were used in this work for the classification task. Considering that there are a large number of algorithms in machine learning, the algorithms that were used in this work were chosen on the basis that the project focuses on classification task, as the aim is to identify the relationship between many variables or features and the output (will accept the vaccine or not). In addition, supervised machine learning category was performed as the model will be trained with the given dataset.\n\nWith regard to the previous two criteria, the models which were chosen are Random Forest, Logistic Regression, Linear SVC, Support Vector Machines, Naive Bayes, Stochastic Gradient Decent, KNN and Perceptron.\n\nRandom forest is classification and regression algorithm which is based on decision trees algorithm. The model consists of large number of individual decision trees that operate as a set. The difference between random forest and decision tree is that a decision tree depends on all dataset for classification or regression, while random forest choose the features randomly to make its decision trees and take the average of the all results. \nLogistic Regression is a machine learning algorithm which depends on the probability. Logistic Regression is generally used when the value of the target variable is categorical.\n\nThe Linear SVC algorithm depends on a linear kernel function for classification. This algorithm works well with big datasets which include high number of samples.\nSupport vector machine is a supervised learning method which can be used for classification, regression and outlier detection. SVM is effective in high dimensional datasets.\n\nA Naive Bayes is a probabilistic machine learning algorithm, it is used for classification task. Naive Bayes classifier is based on the Bayes theorem. Bayes theorem can be summarized as: we can find the probability of A happening, given that B has occurred as the following equation shows with respecting that the predictors are independent.\n\nP(A\u2216B)=(P(A\u2216B)P(A))\/(P(B))\n\nKNN is a classification model that classifies the data according to the data that is most similar. This algorithm is widely used specially in simple recommendation systems.\nPerceptron is a linear and binary classifier. it is used in supervised learning and its output can only be either a 0 or 1.\n\n\n"}}