{"cell_type":{"63f7113b":"code","1959fef9":"code","e834a221":"code","bf600cbf":"code","6866d836":"code","627292a6":"code","0d16c570":"code","ce8c7e51":"code","5733ad44":"code","a25ebdd4":"code","8c906233":"code","30895607":"code","d29972c4":"code","d64ec455":"code","3d09dcf3":"code","aab43c3e":"code","40ddcf9c":"code","fd8a3e7c":"code","94cdb9ec":"code","1e44ee02":"code","6fe3dde2":"code","cd9c23f0":"code","caf2c8c3":"code","e534d572":"code","e786c62f":"code","d5f0ab52":"code","1d0b131f":"code","abf30842":"code","f34dc9f1":"code","c677e420":"code","fec69884":"code","193c068d":"code","6ab98f74":"markdown","b2b2e678":"markdown","7beb4a06":"markdown","e59ed715":"markdown","62e3fa15":"markdown","31ce6194":"markdown","e901d986":"markdown"},"source":{"63f7113b":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport os","1959fef9":"train_df = pd.read_csv('..\/input\/digit-recognizer\/train.csv')\ntest_df = pd.read_csv('..\/input\/digit-recognizer\/test.csv')","e834a221":"X_train = (train_df.drop('label',axis=1)).values\ny_train = train_df['label'].values","bf600cbf":"X_train = X_train.reshape((42000,28,28))","6866d836":"plt.imshow(X_train[0])","627292a6":"y_train[0]","0d16c570":"X_test = test_df.values","ce8c7e51":"X_test = X_test.reshape(((28000, 28,28)))","5733ad44":"plt.imshow(X_test[0])","a25ebdd4":"X_train = X_train \/  255\nX_test =  X_test \/  255","8c906233":"from sklearn.model_selection import train_test_split\nX_train, X_val, y_train, y_val = train_test_split(X_train, y_train, test_size=0.2, random_state=1)","30895607":"print(X_train.shape)\nprint(y_train.shape)","d29972c4":"print(X_val.shape)\nprint(y_val.shape)","d64ec455":"from tensorflow.keras.utils import to_categorical\ny_train_cat =to_categorical(y_train,10)\ny_val_cat =to_categorical(y_val,10)","3d09dcf3":"X_train = X_train.reshape((33600, 28, 28,1))\nX_val = X_val.reshape((8400, 28, 28,1))","aab43c3e":"X_test = X_test.reshape((28000,28,28,1))","40ddcf9c":"import tensorflow as tf\nfrom tensorflow.keras.models import Sequential\nfrom tensorflow.keras.layers import Dense,Conv2D,MaxPool2D,Flatten\nfrom tensorflow.keras.callbacks import EarlyStopping","fd8a3e7c":"physical_devices = tf.config.list_physical_devices('GPU') \ntf.config.experimental.set_memory_growth(physical_devices[0], True)","94cdb9ec":"early_stop = EarlyStopping(monitor='val_loss',patience=1)","1e44ee02":"with tf.device('\/gpu:0'):\n    model = Sequential()\n    model.add(Conv2D(filters=32,kernel_size=(4,4),input_shape=(28,28,1),activation='relu'))\n    model.add(MaxPool2D(pool_size=(2,2)))\n    \n    model.add(Flatten())\n    model.add(Dense(128,activation='relu'))\n    \n    model.add(Dense(10,activation='softmax'))\n    model.compile(loss='categorical_crossentropy',optimizer='adam' ,metrics=['accuracy'])\n    model.fit(x=X_train,y=y_train_cat,epochs=10,validation_data = (X_val,y_val_cat),\n             callbacks=[early_stop])\n   ","6fe3dde2":"losses_acc = pd.DataFrame(model.history.history)\nlosses_acc","cd9c23f0":"losses_acc[['loss','val_loss']].plot()","caf2c8c3":"losses_acc[['accuracy','val_accuracy']].plot()","e534d572":"model.metrics_names","e786c62f":"model.evaluate(X_val,y_val_cat)","d5f0ab52":"predictions = model.predict_classes(X_test)","1d0b131f":"predictions","abf30842":"predictions.shape","f34dc9f1":"X_test.shape","c677e420":"plt.imshow(X_test[0].reshape((28,28)))","fec69884":"result = pd.DataFrame({'ImageId': np.arange(1,len(predictions)+1),'Label' : predictions})","193c068d":"result.to_csv(os.getcwd() + '\/out.csv',index=False)\n","6ab98f74":"# Output","b2b2e678":"# Normalizing","7beb4a06":"# Evaluating","e59ed715":"# OneHot labels","62e3fa15":"# Imports","31ce6194":"# Model","e901d986":"# Reading Data"}}