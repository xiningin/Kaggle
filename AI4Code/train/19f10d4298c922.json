{"cell_type":{"ee5924e8":"code","955245c2":"code","713e6ef2":"code","fbf1c84c":"code","e0123881":"code","5c017b51":"code","88ea5756":"code","5bd27a95":"code","ce1301ca":"code","a83f64e2":"code","e298b57b":"code","0beb2354":"code","2acd6dd3":"code","1f10944d":"code","33f24e20":"code","dcee405f":"code","0d196dd8":"code","a0552025":"code","18097da5":"code","f0b19a38":"code","9a655db1":"code","1fd56761":"code","67443766":"code","d53c0e41":"code","db9f58c6":"code","83ea4d35":"code","f1679456":"markdown","157c51f2":"markdown","da4f9abf":"markdown","f37785ff":"markdown","44278e6a":"markdown","39cc940f":"markdown","3be5f54b":"markdown","792dcbb7":"markdown","df451436":"markdown","2d475f0e":"markdown","45ead75d":"markdown","7ca12f3d":"markdown","3d03355e":"markdown","0ce263af":"markdown","4e16b3ff":"markdown"},"source":{"ee5924e8":"!pip install openpyxl\nimport pandas as pd\nimport seaborn as sns\nimport geopandas as gpd\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport json\nimport plotly.express as px","955245c2":"df = pd.read_excel('..\/input\/india-covid19-vaccination-data\/Covid-19 India Vaccination Status.xlsx')\nshp_gdf = gpd.read_file('..\/input\/india-gis-data\/India States\/Indian_states.shp')\nindia_states = json.load(open(\"..\/input\/geojson-for-indian-states\/states_india.geojson\", \"r\"))","713e6ef2":"df.tail(10)","fbf1c84c":"df = df.dropna()","e0123881":"def calculatePercentage(row):\n    val = (row['Total Vaccination Doses'] \/ row['Population']) * 100\n    return val","5c017b51":"df[\"PercentageVaccinated\"] = df.apply(calculatePercentage, axis=1)","88ea5756":"df.head()","5bd27a95":"df1 = df[['STATE\/UTs', 'PercentageVaccinated']]","ce1301ca":"df1.head(40)","a83f64e2":"shp_gdf.head(40)","e298b57b":"df1['STATE\/UTs'][0] = 'Andaman & Nicobar Island'\ndf1['STATE\/UTs'][2] = 'Arunanchal Pradesh'\ndf1['STATE\/UTs'][13] = 'Jammu & Kashmir'\ndf1['STATE\/UTs'][8] = 'NCT of Delhi'","0beb2354":"merged = shp_gdf.set_index('st_nm').join(df1.set_index('STATE\/UTs'))\nmerged.head(40)\n## In Shape file, as Dadara & nagar Havelli and Daman & Diu are seperate so we will just divide the percetange \/ 2 and set it here\nmerged['PercentageVaccinated']['Dadara & Nagar Havelli'] = '48.5'\nmerged['PercentageVaccinated']['Daman & Diu'] = '48.5'","2acd6dd3":"fig, ax = plt.subplots(1, figsize=(12, 12))\nax.axis('off')\nax.set_title('Percentage Vaccinated State Wise as of 25th July, 2021',\n             fontdict={'fontsize': '15', 'fontweight' : '3'})\nfig = merged.plot(column='PercentageVaccinated', cmap='cool', linewidth=0.5, ax=ax, edgecolor='0.2',legend=True)","1f10944d":"state_id_map = {}\nfor feature in india_states[\"features\"]:\n    feature[\"id\"] = feature[\"properties\"][\"state_code\"]\n    #print(feature[\"properties\"][\"st_nm\"])\n    state_id_map[feature[\"properties\"][\"st_nm\"]] = feature[\"id\"]\n    ","33f24e20":"state_id_map","dcee405f":"df['STATE\/UTs'][0] = 'Andaman and Nicobar'\ndf['STATE\/UTs'][7] = 'Dadra and Nagar Haveli and Daman and Diu'\ndf['STATE\/UTs'][13] = 'Jammu and Kashmir'\ndf['STATE\/UTs'][31] = 'Telengana'","0d196dd8":"avg = (df['PercentageVaccinated'][13] + df['PercentageVaccinated'][17])\/2\navg","a0552025":"df['PercentageVaccinated'][13] = avg\ndf = df.drop(17)","18097da5":"df[\"id\"] = df[\"STATE\/UTs\"].apply(lambda x: state_id_map[x])","f0b19a38":"fig = px.choropleth_mapbox(\n    df,\n    locations=\"id\",\n    geojson=india_states,\n    color=\"PercentageVaccinated\",\n    hover_name=\"STATE\/UTs\",\n    hover_data=[\"Total Vaccination Doses\"],\n    title=\"Percentage of People Vaccinated\",\n    mapbox_style=\"stamen-watercolor\",\n    center={\"lat\": 24, \"lon\": 78},\n    zoom=3,\n    opacity=0.5\n)\nfig.show()","9a655db1":"import folium\nindia_states = json.load(open('..\/input\/indian-gis-shp-file\/india_state_geo.json', 'r'))","1fd56761":"# Checking the keys\nindia_states.keys()","67443766":"for feature in india_states[\"features\"]:\n    feature[\"id\"] = feature[\"properties\"][\"NAME_1\"]\n    print(feature[\"properties\"][\"NAME_1\"])\n","d53c0e41":"df[\"STATE\/UTs\"][0] = 'Andaman and Nicobar'\ndf[\"STATE\/UTs\"][25] = 'Orissa'\ndf[\"STATE\/UTs\"][34] = 'Uttaranchal'\ndf[\"STATE\/UTs\"][13] = 'Jammu and Kashmir'","db9f58c6":"map_choropleth_high_public = folium.Map(location = [20.5937,78.9629],tiles='cartodbpositron',min_zoom=4, max_zoom=6, zoom_start = 4)\n","83ea4d35":"folium.Choropleth(geo_data=india_states,\n                 data=df,\n                 name='CHOROPLETH',\n                 key_on='id',\n                 columns = ['STATE\/UTs','PercentageVaccinated'],\n                 fill_color='YlOrRd',\n                 fill_opacity=0.7,\n                 line_opacity=0.8,\n                 legend_name='Percentage of People Vaccinated',\n                 highlight=True).add_to(map_choropleth_high_public)\n\nfolium.LayerControl().add_to(map_choropleth_high_public)\ndisplay(map_choropleth_high_public)","f1679456":"### We can see these states having different name, so we will rename them","157c51f2":"### This data includes, total population(as per 2019), so there will be some change in the actual vaccinated record","da4f9abf":"### Now let's add this to J&K and remove Ladakh","f37785ff":"# *Plotting using Folium Map*","44278e6a":"![Vaccine.jpg](attachment:2b7842e9-4064-43e8-adbd-b9ffb04f4d4e.jpg)","39cc940f":" ### Merging data file and shape file based on names of Indian states","3be5f54b":"### Calculating the percentage of people vaccinated in each state\n","792dcbb7":"# *Visualizing Indian Map by Percentage Vaccinated as of 25th July, 2021*","df451436":"# *Plotting in Choropleth Mapbox*","2d475f0e":"### Dropping the misc. data\n","45ead75d":"### Changing the name to match the state_id_map","7ca12f3d":"### To read xlsx, we need to do openpyxl, so please give the following in the console 'pip install openpyxl'\n","3d03355e":"### Here Ladakh is not present in the json file, hence we can average it with J&K","0ce263af":"### Renaming some of the states to match with our json file","4e16b3ff":"### Let us compare our shp and our df states name"}}