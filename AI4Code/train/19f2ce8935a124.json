{"cell_type":{"43809d87":"code","982d447e":"code","44033ee0":"code","522e3188":"code","dce6bb44":"code","4cafc13b":"code","1bd5c552":"code","57915642":"code","b5c206fc":"code","9412a867":"code","c9d86f6d":"code","17eea831":"code","ddddef72":"code","49392dcc":"code","a7b3765e":"code","c4880d4a":"code","ad46dc13":"code","e3ddccf5":"code","d2e21913":"code","d4249e52":"code","f0e39ebd":"code","40254624":"code","78ef226f":"code","f8facb4e":"code","8138eabc":"code","e88a16c0":"code","e63ae1a8":"code","7270ac99":"code","5cc3018a":"code","a1b584d5":"code","61a5bb55":"code","4b614924":"code","efc7fb32":"markdown","50d1a041":"markdown","04b6a8a4":"markdown","c81389b6":"markdown","ebbfcee5":"markdown","e29c3650":"markdown","4cc276de":"markdown","02e360e4":"markdown","478c107a":"markdown","3b9063d6":"markdown","3bf6a4a6":"markdown","14befc1e":"markdown","437aa727":"markdown","ef0fc339":"markdown","c7d77909":"markdown","ecb4fc23":"markdown","41b83195":"markdown","d9831532":"markdown","ee84e720":"markdown","0205e069":"markdown","51bef39d":"markdown","3922db79":"markdown","efcda7b8":"markdown","6ac3f3bb":"markdown","ee26f442":"markdown","88220f78":"markdown","d921f4c1":"markdown","fa19eb03":"markdown","6abb30f3":"markdown","7c60f919":"markdown","b8b08de8":"markdown","ac396f1f":"markdown","e61c80fd":"markdown","acdf66d5":"markdown","b0c9a6cf":"markdown","9f7f5940":"markdown","8c720cc4":"markdown","92b6716a":"markdown","dd91dd67":"markdown","5383603f":"markdown","4c6a3067":"markdown","eeab3bd0":"markdown","b8c777db":"markdown","6ebcb9e2":"markdown","8a441f59":"markdown","ff6fcd76":"markdown","7309a340":"markdown","01114c55":"markdown"},"source":{"43809d87":"from IPython.display import IFrame\nfrom IPython.core.display import display\n\ndisplay(IFrame('https:\/\/ourworldindata.org\/grapher\/cardiovascular-disease-death-rates', '100%', '600px'))","982d447e":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\nsns.set()\n\n\n# import graph objects as \"go\" and import tools\nimport plotly.graph_objs as go\nfrom plotly import tools\nimport plotly.express as px\nimport plotly.offline as py","44033ee0":"df = pd.read_csv('..\/input\/heart-attack-prediction-data-set\/heart.csv')","522e3188":"len(df)","dce6bb44":"df.head()","4cafc13b":"df.info()","1bd5c552":"df.isnull().sum().sum()","57915642":"pd.set_option(\"display.precision\", 2) # to decrease the display precision to 2 digits\ndf.describe()","b5c206fc":"df.duplicated().any()","9412a867":"df[df.duplicated()]","c9d86f6d":"dups = df[df.duplicated(keep=False)]\n\ndups = dups.groupby(list(dups)).apply(lambda x: tuple(x.index)).tolist()\nprint (dups)","17eea831":"df[163:165]","ddddef72":"df = df.drop_duplicates()\n# let's see if we have any duplicaed sample anymore?\ndf[df.duplicated()]","49392dcc":"# Definition of some colors used in diagrams\n\nG0_color = '#ef553b' # Gender 0\nG1_color = '#636efa' # Gender 1\n\n#G0_color = 'rgb(239,85,59)' # Gender 0\n#G1_color = 'rgb(99,110,250)' # Gender 1\n\nH_color = '#239b56' # Healthy\nR_color = '#e74c3c' # Risky","a7b3765e":"df.columns = ['Age', 'Gender', 'ChestPainType', 'RestingBloodPressure', 'CholesterolLevel',\n              'FastingBloodSugar', 'RestingECG', 'MaxHR', 'ExerciseInducedAngina', 'ST_Depression',\n              'ST_Slope', 'NumMajorVessels', 'Thalassemia', 'Prediction']","c4880d4a":"Labels = ['Gender 0', 'Gender 1']\nv0 = len(df[df['Gender'] == 0])\nv1 = len(df[df['Gender'] == 1])\nValues = [v0, v1]\n\nfig = go.Figure(data=[go.Pie(labels=Labels,\n                             values=Values,\n                             #hovertext=df['Gender'],\n                             textfont_size=20,\n                             #legendgrouptitle=dict(text='Gender'),\n                             title=dict(position='top center',text ='Gender Distribution among the data'),\n                             marker=dict(colors=[G0_color, G1_color])\n                            )\n                     ]\n               )\n\nfig.show()","ad46dc13":"def plot_histogram(data, col, color, title, shade=False, shade_options=[]):\n    '''\n    This fuctions plot the histogram of the [col] feature of the [data] data frame in [color] color with the [title] title\n    '''    \n    fig = go.Figure()\n    fig.add_trace(go.Histogram(\n        x=data[col],\n        name=col,\n        xbins=dict(\n            start=data[col].min(),\n            end=data[col].max(),\n            size=1\n        ),\n\n        marker_color=color,\n        opacity=0.75,\n    ))\n\n    fig.update_layout(\n        title_text= title, # title of plot\n        xaxis_title_text=col, # xaxis label\n        yaxis_title_text='Quantity', # yaxis label\n        bargap=0.2, # gap between bars of adjacent location coordinates\n    )\n    \n    if shade:\n        fig.add_vrect(\n            x0=shade_options[0], x1=shade_options[1],\n            fillcolor=shade_options[2], opacity=0.5,\n            layer=\"below\", line_width=0,\n            )\n    fig.update_layout(xaxis_range=[df[col].min(),df[col].max()]) # to force all figures to have equal x-axis range\n    fig.show()\n    \nplot_histogram(df, 'Age', 'navy', 'Age Distribution of all the samples:', shade=True, shade_options=[40, 60, 'dimgray'])    ","e3ddccf5":"df.head()","d2e21913":"df['AgeGroup'] = ''\n\ndf.loc[(df['Age'] >= 29) & (df['Age'] < 39), 'AgeGroup'] = 'A'\ndf.loc[(df['Age'] >= 39) & (df['Age'] < 49), 'AgeGroup'] = 'B'\ndf.loc[(df['Age'] >= 49) & (df['Age'] < 59), 'AgeGroup'] = 'C'\ndf.loc[(df['Age'] >= 59) & (df['Age'] < 69), 'AgeGroup'] = 'D'\ndf.loc[(df['Age'] >= 69) & (df['Age'] < 79), 'AgeGroup'] = 'E'","d4249e52":"Gender_0 = df[df['Gender'] == 0]\nG0_Groups = Gender_0['AgeGroup'].value_counts().sort_index().tolist()\nGender_1 = df[df['Gender'] == 1]\nG1_Groups = Gender_1['AgeGroup'].value_counts().sort_index().tolist()\nGroups = sorted(df['AgeGroup'].unique().tolist())\n\nfig = go.Figure(data=[\n    go.Bar(name='Gender 0', x= Groups, y=G0_Groups),\n    go.Bar(name='Gender 1', x= Groups, y=G1_Groups)\n]\n               )\nfig.add_trace(\n    go.Scatter(\n        x=Groups,\n        y=G0_Groups,\n        line=dict(color=G1_color, shape ='spline'),\n        marker=dict(opacity=0),\n        showlegend=False\n    ))\nfig.add_trace(\n    go.Scatter(\n        x=Groups,\n        y=G1_Groups,\n        line=dict(color=G0_color, shape ='spline'),\n        marker=dict(opacity=0),\n        showlegend=False\n    ))\n\nfig.update_layout(\n    xaxis = dict(\n        tickmode = 'array',\n        tickvals = Groups,\n        ticktext = ['29-38', '39-48', '49-58', '59-68', '69-78']),\n        xaxis_title_text='Age Groups', # xaxis label\n        yaxis_title_text='Quantity', # yaxis label\n        barmode='group' # change the barchart mode\n    )\n\nfig.show()","f0e39ebd":"df['Label'] = ''\n\ndf.loc[df['Prediction'] == 0, 'Label'] = 'Healthy'\ndf.loc[df['Prediction'] == 1, 'Label'] = 'Risky'\n\n\nhealthies = df[df['Prediction'] == 0]\nriskies = df[df['Prediction'] == 1]","40254624":"from plotly.subplots import make_subplots\n\nfig = make_subplots(rows=2, cols=1)\n\nplot_histogram(healthies, 'Age', 'darkgreen', 'Age Distribution of healthy samples:', shade=True, shade_options=[41, 55, 'lightgreen'])\nplot_histogram(riskies, 'Age', 'maroon', 'Age Distribution of risky samples:', shade=True, shade_options=[41, 55, 'salmon'])","78ef226f":"H_Zeros= len(healthies[healthies['Gender'] == 0])\nR_Zeros = len(riskies[riskies['Gender'] == 0])\n\nH_Ones = len(healthies[healthies['Gender'] == 1])\nR_Ones = len(riskies[riskies['Gender'] == 1])\n\nfig = make_subplots(rows=1, cols=2, specs=[[{'type':'domain'}, {'type':'domain'}]])\n\nfig.add_trace(\n    go.Pie(labels=['Healthy', 'Risky'], values=[H_Zeros, R_Zeros], title='Gender 0'), row=1, col=1)\nfig.update_traces(textfont_size=20, marker=dict(colors=['limegreen', 'red']))\n\nfig.add_trace(\n    go.Pie(labels=['Healthy', 'Risky'], values=[H_Ones, R_Ones], title='Gender 1'), row=1, col=2)\nfig.update_traces(textfont_size=20, marker=dict(colors=[H_color, R_color]))\n\nfig.show()","f8facb4e":"# Import the two methods from heatmap library\nfrom heatmap import heatmap, corrplot","8138eabc":"plt.figure(figsize=(16, 16))\ncorrplot(df.corr(), size_scale=500);","e88a16c0":"feature = 'ChestPainType'\n\nH_values = healthies[feature].value_counts().sort_index().tolist()\nR_values = riskies[feature].value_counts().sort_index().tolist()\n\nGroups = sorted(df[feature].unique().tolist())\nprint(Groups)\n\nfig = go.Figure(data=[\n    go.Bar(name='Healthy', x = Groups, y = H_values, marker_color=H_color),\n    go.Bar(name='Risky', x = Groups, y = R_values, marker_color=R_color)\n]\n               )\n\nfig.add_trace(\n    go.Scatter(\n        x=[number - 0 for number in Groups],\n        y=H_values,\n        line=dict(color=H_color, shape ='spline'),\n        marker=dict(opacity=0),\n        showlegend=False\n    ))\nfig.add_trace(\n    go.Scatter(\n        x=[number + 0 for number in Groups],\n        y=R_values,\n        line=dict(color=R_color, shape ='spline'),\n        marker=dict(opacity=0),\n        showlegend=False\n    ))\n\nfig.update_layout(\n    title = 'Chest Pain Type Distribution Comparison Between Healthy & Risky Samples',\n    xaxis = dict(\n        tickmode = 'array',\n        tickvals = Groups,\n        ticktext = ['typical angina', 'atypical angina', 'non-anginal pain', 'asymptomatic']),\n        xaxis_title_text='Chest Pain Type', # xaxis label\n        yaxis_title_text='Quantity', # yaxis label\n        barmode='group' # change the barchart mode\n    )\n\nfig.show()","e63ae1a8":"fig = px.scatter(df, x=\"Age\", y=\"ChestPainType\",\n                color=\"Label\", color_discrete_sequence= [H_color, R_color])\n\nfig.update_traces(marker=dict(size=10,\n                              line=dict(width=2,\n                                        color='DarkSlateGrey')),\n                              selector=dict(mode='markers'))\n\nfig.update_layout(\n    yaxis = dict(\n        tickmode = 'array',\n        tickvals = [0, 1, 2, 3],\n        ticktext = ['typical angina', 'atypical angina', 'non-anginal pain', 'asymptomatic']),  \n        xaxis_title_text='Age', # xaxis label\n        yaxis_title_text='ChestPainType', # yaxis label\n        barmode='group', # change the barchart mode\n        title='Age\/Chest Pain Type Correlations with the Target Feature'\n    )\n\nfig.show()","7270ac99":"feature = 'ST_Slope'\n\nH_values = healthies[feature].value_counts().sort_index().tolist()\nR_values = riskies[feature].value_counts().sort_index().tolist()\nGroups = sorted(df[feature].unique().tolist())\n\nfig = go.Figure(data=[\n    go.Bar(name='Healthy', x = Groups, y = H_values, marker_color=H_color),\n    go.Bar(name='Risky', x = Groups, y = R_values, marker_color=R_color)\n]\n               )\n\nfig.add_trace(\n    go.Scatter(\n        x=[number - 0 for number in Groups],\n        y=H_values,\n        line=dict(color=H_color, shape ='spline'),\n        marker=dict(opacity=0),\n        showlegend=False\n    ))\nfig.add_trace(\n    go.Scatter(\n        x=[number + 0 for number in Groups],\n        y=R_values,\n        line=dict(color=R_color, shape ='spline'),\n        marker=dict(opacity=0),\n        showlegend=False\n    ))\n\nfig.update_layout(\n    xaxis = dict(\n        tickmode = 'array',\n        tickvals = Groups,\n        ticktext = ['downsloping', 'flat', 'upsloping']),\n        xaxis_title_text='ST Slope Type', # xaxis label\n        yaxis_title_text='Quantity', # yaxis label\n        barmode='group' # change the barchart mode\n    )\n\nfig.show()","5cc3018a":"fig = px.scatter(df, x=\"Age\", y=\"MaxHR\",\n                color=\"Label\", color_discrete_sequence= [H_color, R_color])\n\nfig.update_traces(marker=dict(size=10,\n                              line=dict(width=2,\n                                        color='DarkSlateGrey')),\n\n                  selector=dict(mode='markers'))\n\n\nfig.add_shape(type=\"circle\",\n    xref=\"x\", yref=\"y\",\n    x0=35, y0=135,\n    x1=58, y1=195,\n    opacity=0.2,\n    fillcolor=\"green\",\n    line_color=\"green\",\n)\n\nfig.add_shape(type=\"circle\",\n    xref=\"x\", yref=\"y\",\n    x0=50, y0=85,\n    x1=70, y1=170,\n    opacity=0.2,\n    fillcolor=\"red\",\n    line_color=\"red\",\n)\n\nfig.update_layout(  \n        xaxis_title_text='Age', # xaxis label\n        yaxis_title_text='Max HR achieved during Thalium stress test ', # yaxis label\n        barmode='group', # change the barchart mode\n        title='Age\/Max Thalium HR Correlations with the Target Feature'\n    )\n\nfig.show()","a1b584d5":"import plotly.figure_factory as ff\n\n\n\ndef show_feature_dist(feature, binsize, rug=True, curve=False):\n    H_values = healthies[feature]\n    R_values = riskies[feature]\n\n    hist_data = [H_values, R_values]\n\n    group_labels = ['Healthy', 'Risky']\n\n    fig = ff.create_distplot(hist_data,\n                             group_labels,\n                             bin_size=[binsize, binsize],\n                             colors=[H_color, R_color],\n                             show_hist =True,\n                             curve_type='kde',\n                             show_curve=curve,\n                             show_rug = rug , \n                             #rug_text=['Healthy', 'Risky']\n                            )\n\n    fig.update_layout(  \n            xaxis_title_text = feature + ' Values',\n            yaxis_title_text = 'Label Probability Density',\n            title = feature + 'distribution for healthy and risky samples'\n        )\n\n\n    fig.show()\n    \nshow_feature_dist('ST_Depression', 0.5, rug=False, curve=True)","61a5bb55":"show_feature_dist('NumMajorVessels', 1, rug=False, curve=True)","4b614924":"show_feature_dist('CholesterolLevel', 3, rug=True, curve=True)","efc7fb32":"Now, it is time to take a look at `MaxHR` difference between <span style=\"color:red\">**risky**<\/span> and <span style=\"color:green\">**risky**<\/span> samples.","50d1a041":"## Features correlations\n\nNow, it is time to take a look at the existing correlations between our features.\nIn the following **corellation diagram**, each correlation between a pairs of two features is illustrated as a colored squared. The value of the correlation varies between **[-1, 1]** where **bigger red square** expresses a **stronger negative correlation** between two features and a **bigger bue square** can be interpreted as a **stronger positive correlation**.\n\nIn this diagram, we are interested in two types of correlation:\n1. a **strong correlation (positive or negative) between each input feature and the target feature (output)**. To this aim, we should pay attention to the lowest row or the most right column of the diagram and their squares (bigger is better).\n\n2. We also need to pay attention to the **strong corelations between each pair of the input features**. Here, we hope **<u>not to see a strong correlation<\/u>** (the bigger th square the worse it is) because each big square (strong correlation) between two input features indicates a **co-linearity** between those features that in simple words means, those two features will present the same information to the model and so, one of them should be removed from the set of input features. Therefore, having such a sitution between each pair of input features may lead to less number of features that we have to feed to the model which means there is less useful information among the data.","04b6a8a4":"Now, it is time to investigate features that have a <span style=\"color:red;font-size:18pt\">**strong direct correlation**<\/span> with the **target feature** to see if they are also useful enough to  be used in our prediction model.\n\nLet's start with `ST_Depression` that indicates ST depression induced by exercise relative to rest:","c81389b6":"In the above diagram, there are <span style=\"color:blue;font-size:18pt\">**2 obvious clusters**<\/span> of <span style=\"color:green;font-size:18pt\">**healthy (green) samples at top left**<\/span> and <span style=\"color:red;font-size:18pt\">**risky (red) samples at bottom right**<\/span> that show the `MaxHr` feature can be used as a useful input feature to discriminate healthy and risky samples from each other.","ebbfcee5":"\nAs can be seen in the above diagrams, having a <span style=\"color:green; font-size:20pt\">**typical angina chest pain**<\/span> is **more common among <span style=\"color:green; font-size:20pt\">healthy<\/span> samples**, \n\nwhile having a <span style=\"color:red;font-size:20pt\">**non-anginal pain**<\/span> is **more likely in younger <span style=\"color:red;font-size:20pt\">risky<\/span> samples**. ","e29c3650":"Another a possible approach for further data investigation would be to separate our samples to **<span style=\"color:green;font-size:20pt\">healthy<\/span>** and **<span style=\"color:red;font-size:20pt\">risky<\/span>** samples based on the likelihhod of a potential heart attack for them and see how they are different in various aspects and what insights we can obtain from these diffwerences:","4cc276de":"Apparently, <span style=\"color:red;font-size:16pt\">low `ST Depression` values are more common among risky samples<\/span>, while <span style=\"color:green;font-size:16pt\">healthy people are more likely to have higher values of this feature<\/span>. \n\nThe sitaution is almost the same for `NumMajorVessels` feature:","02e360e4":"---\n\n##### Some questions that we may ask about the problem (before any data exploration or going further to the analysis steps):\n\n- What are the most important factors that increase the risk of heart attack occurrences?\n- What is the amount of correlation between the given features and heart attack occurrences? \n- Does the sex affect the heart attack occurrences? \n- How is the rate of heart attack occurrence in different countries?\n- Is there a special period of time during the day or night that the rate of heart attack occurrence increases?\n- Is there a special year that the rate of heart attack increased? if yes, why?\n- How does the rate of heart attack change during different seasons of a year?\n- What is the most effective strategy or medicine to prevent the heart attack occurances?\n- Which factor(s) determine(s) if a heart attack leads to death or not?\n- What kind of the chest pain can be considered as a serious warning of potencial heart attack for a patient?\n- Is there any correlation between levels of        \n  * blood pressure\n  * cholestoral \n  * blood sugar      \n  and the risk of having a heart attack?\n- which features can be considered as the heart health measures that may reduce the risk of having a heart attack in a patient?  \n\n   \nMore questions can be proposed during the data analysis process.","478c107a":"! pip install heatmapz","3b9063d6":"### Identifying Challenges\n\nIn this step, we need to clarify **which challenges we are facing regarding the project and the data**. Here, as the most important action, we need to <span style=\"color:red;font-size:18pt;font-weight: bold\">check data reliability<\/span> <u>to be sure if the data is a good source of knowledge to provide proper answers to our questions about the problem or not<\/u>. \n\nAfter such an examination, we need to consider **technical challenges** as well. For example, in a case that we are going work with an unstructured data like texts, we should be aware of the **operational comlexities** in required technical steps such as extracting information from text files, converting unstructured information into the structured format, and so on to be able to <u>**determine the required time and resources for those steps**<\/u>.\n\n### Project Properties\n\nAs the next step, we should also determine **key objectives of the project*, **project specifications**, **project schedule**, **calculate time requirements** and **prioritize project elements**.\n\n### Extra Decorations\n\nDuring our technical data analysis process, it is really recommended to add some **artistic aspects** to the final result (report) in the form of supplementary images, diagrams, and figures to help stakeholders understand the usefulness of the provided insights, and support them in their decision-making process. In this way, they can digest the provided knowledge and act on it.","3bf6a4a6":"So, the above mentioned sample is repeated in indices **163, 164**. see:","14befc1e":"-------------------------\n\n### External obtained knowledege about input features of the project\n\nAs explianed before, since we do not have a partner, we cannot get more information about these features from our partner. So, we search over the internet and try to get some information about them.\n\n3.**cp**: This feature is related to some well-known **chest pain types** as follows:\n       \n- **Typical angina (TA)**: is defined as substernal chest pain precipitated by physical exertion or emotional stress and relieved with rest or nitroglycerin. Angina chest pain is a pressure or squeezing like sensation that is usually caused when your heart muscle doesn\u2019t get an adequate supply of oxygenated blood.\n\n- **Atypical angina**: When one experiences chest pain that doesn\u2019t meet the criteria for angina, it\u2019s known as atypical chest pain. If the chest pain cannot be considered as angina, then that person is said to suffer from atypical chest pain, which unlike typical chest pain, doesn\u2019t occur in the sternum and may radiate to other parts of the body.\n\n- **Nonanginal pain**: Which has one characteristic of typical angina. Nonanginal chest pain carries intermediate risk for CAD (stable coronary artery disease) in women older than 60 years and men older than 40 years.\n\n- **asymptomatic (Silent myocardial ischemia - SMI)**: is defined as a transient alteration in myocardial perfusion in the absence of chest pain or the usual anginal equivalents. Patients may be classified as having one of the three types of SMI: \n    - **type A**: totally asymptomatic patients with no history of angina or myocardial infarction,\n    - **type B**: asymptomatic patients with previous myocardial infarction,\n    - **type C**: patients with angina and asymptomatic ischemic episodes.\n\n4.**trtbps**: Normal resting blood pressure, in an adult is approximately \"120\/80 mmHg\"\n       \n6.**fbs**: Fasting blood sugar test. A blood sample will be taken after an overnight fast. A fasting blood sugar level less than 100 mg\/dL (5.6 mmol\/L) is normal. A fasting blood sugar level from 100 to 125 mg\/dL (5.6 to 6.9 mmol\/L) is considered prediabetes. If it's 126 mg\/dL (7 mmol\/L) or higher on two separate tests, you have diabetes\n       \n7.**restecg**: is used to assess known cardiovascular diseases\n\n9.**exng**: Exercise-induced angina (AP) is a common complaint of cardiac patients, particularly when exercising in the cold. This feature indicates whether the patient had the experience of the exercise induced angina or not. \n\n12.**caa**: number of major vessels. The major blood vessels connected to your heart are \n  - aorta, \n  - superior vena cava, \n  - inferior vena cava, \n  - pulmonary artery (which takes oxygen-poor blood from the heart to the lungs where it is oxygenated), \n  - pulmonary veins (which bring oxygen-rich blood from the lungs to the heart), and \n  - coronary arteries (which supply blood to the heart muscle). \n\n    This feature indicates the **number of observable major vessels colored by fluoroscopy for each patient**. \n\n    **Fluoroscopy** is a test that uses a steady beam of x-rays (like a movie) to look at parts of the body and movement within the body, such as blood moving through a blood vessel. Fluoroscopy also can be used to help find a foreign object in the body, position a needle for a medical procedure, or realign a broken bone.","437aa727":"### Increasing the readability of the data and code\n\nBased on the well-known coding guideleines, it is always recommended to **select meaningful names for your variables and functions**. The same is true for a data analysis process. So, it is always a good idea to have meaningful names for all the features (columns) among your data. Regarding the name of DataFrame(s), many people prefer to keep it simple to keep it more understandble for others. Therefore, using a name like `data` of `df` for your main DataFrame is quite acceptable:\n\nLet's rename our features as follows to have a better feeling when working with them:\n\n'age' &#8594; 'Age'\n\n'sex' &#8594; 'Gender'\n\n'cp' &#8594; 'ChestPainType'\n\n'trtbps' &#8594; 'RestingBloodPressure'\n\n'chol' &#8594; 'CholesterolLevel'\n\n'fbs' &#8594; 'FastingBloodSugar'\n\n'restecg' &#8594; 'RestingECG'\n\n'thalachh' &#8594; 'MaxHR'\n\n'exng' &#8594; 'ExerciseInducedAngina'\n\n'oldpeak' &#8594; 'ST_Depression'\n\n'slp' &#8594; 'ST_Slope'\n\n'caa' &#8594; 'NumMajorVessels'\n\n'thall' &#8594; 'Thalassemia'\n\n'output' &#8594; 'Prediction'","ef0fc339":"As you may geuss, we use the well-known and powerful **pandas** library to put the data in and work on it.\n\n**Pandas** library has a data structure called **DataFrame (DF)**.\n\n**DataFrames** are <u>similar but not equal<\/u> to **SQL tables and spreadsheets**. In many cases, pandas DataFrames are faster, easier to use, and more powerful than tables or spreadsheets because they are an integral part of the Python and NumPy ecosystems. So, they provide a wide range of **<u>high-performance data analysis tools<\/u>**.\n\nSo, the first step is to read the data from the **csv file** and put it into a pandas **DataFrame**:","c7d77909":"As describe before, the second feature that has a **direct correlation with the heart attack probabilty** is `ST_Slope`.","ecb4fc23":"**YES**, we have! \n\nLet's check **what is the duplicated sample** and on **which indices do we have a duplication**:","41b83195":"Beautiful!\n\nThe age feature rangeis [29,76] and as can be seen **most of our samples** are **<u>between 40 and 60 years old<\/u>**. But the age distribution alone, is not so informative.\n\nLet's define some age groups and plot their distribution along with age distribution to have a more clear overview on these two important features:\n","d9831532":"Comparing the aboved figures, it is reasonable to conclude **samples with age between 41 and 55 years old** (inside the highlighted area) are **<u>more likely to have a heart attack<\/u>**. So, possibly, **<span style=\"color:darkred\">there is an anti-correlaton between the age of a sample and his\/her risk to have a heart attack in the future(!)<\/span>**.\n\n<span style=\"color:red;font-size:14pt;font-weight: bold\">Such an insight is really questionable that may indicate a serious bias among the data <\/span>, don't you think so?","ee84e720":"As you see, **both genders have almost the same age distribution**. So, we can be sure <span style=\"color:blue;font-size:20pt\">**there is no bias due to different age distributions**<\/span>.","0205e069":"now, let's take a look at the size of the data and the very first rows of the data we just read :","51bef39d":"! pip install numpy==1.17.4","3922db79":"### Checking data redundancies\n\nIf you are familiar with the concept of data storage and retrieval, you should know **data redundancy (having duplicated rows among the data)** may lead to data anomalies and corruption and should be avoided when using a pandas DataFrame as well. \n\nTo detect data redundencies in a pandas DataFrame, we can use the `.duplicated()` method. \n\nLet's see, if we have any **duplicated sample** among the data:","efcda7b8":"From the above cells, we can see, the data **has no missed values**. \n\nIt is also abvious that we do not have **<u>object type (non-numric) features<\/u>**. Therefore, there is no need to perform **data type transformation and imputation techniques** (as part of feature engineering or pre-processing) to transfom non-numeric (categorial) features into numerical values.\n\nNow, let's see want insights can we obtain through basic statistical chracteristics of the feature.\nHere, the `.describe()` function can provide a summary of statistics of the DataFrame columns:","6ac3f3bb":"Therefore, to save more lives, <span style=\"color:red;font-size:16pt\">**it is important to detect cardiovascular disease as early as possible**<\/span> so that management with counseling and medicines can begin.\n\n---\n\nThe final objectives of this project is to use the provided data to perform the following tasks:\n\n1. Performing EDA to obtain useful primary insights \n2.  Using the provided set of input features and their corresponding labels to <span style=\"color:green;font-size:14pt\">**predict the likelihood of a potential heart attack**<\/span> in each sample. In other words, the problem is to provide a binary classifier that is able to predict if a person is prone to a heart attack or not.","ee26f442":"Based on the above diagram input features can be categorized in 3 groups w.r.t. their correlation with the target feature (output):\n\n1. `RestingBloodPressure`, `CholesterolLevel`, `FastingBloodSugar` and `RestingECG` features <span style=\"color:blue;font-size:20pt\">**DO NOT have a strong correlation**<\/span> with the **target feature**.\n2. `ChestPainType`, `ST_Slope`and `MaxHR` features have a <span style=\"color:red;font-size:20pt\">**strong direct correlation**<\/span> with the **target feature**, which means <span style=\"color:red\">**the higher value they have, the more likelihood the patient has to have a heart attack in the future**<\/span>.\n3. `ExerciseInducedAngina`, `ST_Depression`, `NumMajorVessels`, and `Thalassemia` features have a <span style=\"color:green;font-size:20pt\">**strong reverse correlation**<\/span> with the **target feature**, which means <span style=\"color:green\">**the higher value they have, the less likelihood the patient has to have a heart attack in the future**<\/span>.","88220f78":"- As mentioned before, our data is somehow <span style=\"color:red\">**inbalance with respect to the gender of patients**<\/span>.\n- In addition, the **target feature values (being healthy or risky)** have **completely different distributions in two genders**. While, \n  \n  - the <span style=\"color:red\">**majority of Gender 0 samples (75%)**<\/span> are labeled as <span style=\"color:red\">**risky**<\/span>. \n  - the <span style=\"color:green\">**majority of the Gender 1 samples (55.3%)**<\/span> are labeled as <span style=\"color:green\">**healthy**<\/sapn>, \n  \n- So, either \n    - the **gender has a strong correlation with the target feature**\n    - or, the sampling strategy of the <u>dataset is biased<\/u> towards <span style=\"color:red\">**risky Gender 0 samples**<\/span> and <span style=\"color:green\">**healthy Gender 1 samples**<\/span>.","d921f4c1":"Different primary insights can be obtained from the above table. For example:\n\n- The age range of the patients is **[29, 77]** and the average age is **54.37**.\n- Some sex (gender) information (**mean: 0.68**) reveals that most of the sample paitients are **male**.\n- Cholestrol values show, the colestrol level of **25%** of patients is below **211**.","fa19eb03":"## Business understanding\n\nTo this aim, we should get the **domain knowledge** by speaking to the stakeholders, industrial partners, and domain experts. In addition, we should get enough information about the company\/customer itself, their business\/services, and their intended products. \n\nFurthermore, by reading the **documentation of the project** including data\/feature descriptions, the format of provided data files and other primary technical aspects, we can get useful information about the data and get familiar with it that may help us to identify potential problems.\n\nTo this aim, the following 3 steps can be considered as the best starting points:\n\n1. We should make clear, **which questions do we want to answer in this project** to provide useful insights from the data and improve decision-making process as well as providing data-driven solutions? By **designing meaningful and insightful questions** that should be answered during the analysis, we can correctly understand and interpret hidden relations that will be discovered during the data analysis process.\n\n\n2. Moreover, it is really recommended to **search over the internet and review reliable external sources** to add some useful aspects, insights and suggestions to the project or provide some hints to perform useful Exploratory Data Analysis (EDA) and data visualization steps. It is also a good idea to **find some valid documentation (information\/reports\/research\/analysis), evidence, and statistics** that support the obtained knowledge.\n\n\n3. Finally, if it is possible, it is strongly recommended to **add reliable supplementary data to the original data set** and if required, combine structured and unstructured data. ","6abb30f3":"![Heart.png](attachment:Heart.png)","7c60f919":"# Project properties\n\n## Data exploration\n\nThe provided data for the project is in the shape of **two CSV files** of `heart.csv` and `o2Saturation.csv`.\n\nThe `heart.csv` file includes **13 input features** and their corrsponding **target feature** for **303 samples**.\n\nBeside the first tow features that express the **age** and the **gender** of each sample (person), remaining **11 featurs** are providing some values of various medical measurements of that person.\n\n**3 input features** as well as the **target feature** have **binary values ({0,1})** , while others have numerical values in different ranges. So, although there is no categorial feature among the data that should be transferred a numrical feature, in the case of using some specific machine learning models, we may need to normalize our numerical input features before feeding them to the selected model. \n\nThe `o2Saturation.csv` is a single column csv file that includes **3585 floating point values** without nay further infomation. So, using the values of this file along our data analysis process without any clu about its meaning and its different dimensionality with respect to the data of the `heart.csv` file, can be quite challenging.","b8b08de8":"Let's start our coding journey. First, we need to **import some necessary libraries**:","ac396f1f":"-----------------------","e61c80fd":"As *Jake VanderPlas* mentioned in his book **Python Data Science Handbook**:\n\n\"**No matter what the data are, the first step in making them analyzable will be to transform them into arrays of\nnumbers**\". \n\nHere are some primary hints:\n\n- Since we are going to work with mathematical models, obviously we should work with numbers. So, in the data, if we see any column that has **non-numerical values**, we need to tranfrom it in some way into numbers. \n\n- In addition, any column with the type of `object` should be transformed to a numerical data type as well, even if the object contains only numberical values. \n\n  As an example, when you see the type of a columns using `.info()` or `.dtypes` methods of a pandas DataFrame as:\n\n    ```\n    area 5000 non-null object\n    ```\n\n    we should note, although the feature value is numerical, the data type of the feature is `object`. So, it should be transformed into a **numrical data type**  using pandas `.astype()` method.","acdf66d5":"### Conclusion\n\nAt this point, we have extracted several insights during our EDA process. Unfortunately, there are several indications that these insights are in contradiction with the reliable and accepted medical evidences. For example:\n\n- While medical reports, as well as our everyday experiences, show the risk of having a heart attack is higher when we get old, one of our extracted insights indicates the risk of heart attack is at maximum level for patients between 41 and 55 years old, and the likelihood of having a heart attack decreases after the age 55!\n\n\n- Medical reports reveal although men tend to develop coronary artery disease earlier in life, after age 65 the risk of heart disease in women is almost the same as in men. In spite of this medical fact, our insights indicate gender has a strong correlation with the risk of having heart attacks.\n\n\n- According to numerous medical studies, at higher levels of cholesterol, the human body can develop fatty deposits in blood vessels. Eventually, these deposits grow and make it difficult for enough blood to flow through arteries. Sometimes, those deposits can break suddenly and form a clot that causes a heart attack or stroke. Nevertheless, in the previous diagram, with a drastic increase in the level of cholesterol, the risk of heart attack tends to zero!\n\nBased on all the above contradictions, we can conclude, <span style=\"color:red;font-size:16pt;font-weight:bold\">the provided data is not reliable enough to be used for the prediction of the heart attack probability<\/span>.\n\n","b0c9a6cf":"Okay, as can be ssen, the data has **303 samples** in total.\n\nIt seems the data is <u>nice and clear<\/u>. All the features have numerical values and some of them are binary variables.\n\nLet's check if our assumption is correct and if the data contains any **missed values** for any feature.\nHere, `.info()` method of the pandas DataFrame can be used to get a concise summary of the dataframe data:","9f7f5940":"One of the important simple's charcteristics in our data is **gender**. So, we might need to know, how is our data distribution w.r.t. this feature","8c720cc4":"Now, it is time to **drop duplicated values** and get rid of them!","92b6716a":"Regarding the **Gender** feature, it is not clear what do values `0` and `1` mean. We cannot simply interpret `0` as **Female** and `1` as **Male** and vice versa. So, we prefer to keep the vague `0` and `1` and use them accordingly. But, it is obvious that <span style=\"color:red;font-size:20pt\">**our data is imbalanced with respect to Gender distribution**<\/span> that me need to addredd later in our preprocessing staps.\n\n\nLet's take alook at **Age distribution** as well:","dd91dd67":"As can be seen in the above diagram, while the <span style=\"color:blue;font-size:15pt\">downsloping ST (left group of bars)<\/span> value <span style=\"color:blue\">**can be equaly seen among risky and healthy samples**<\/span>, the <span style=\"color:green;font-size:15pt\">flat ST slope (middle group of bars)<\/span> can be cosidered as an <span style=\"color:green\">**indication for healthy samples**<\/span> , while the <span style=\"color:red;font-size:15pt\">upsloping ST (right group of bars)<\/span> can be cosidered as the <span style=\"color:red\">**indication for risky samples**<\/span>. ","5383603f":"This diagram indicates:\n1. most of the samples in both groups (healthy\/risky) have almost the same values of Cholestrol level (somewhere between 200 & 300)\n2. There are more healthy samples that have cholesterol levels higher than 250. \n\nThe above-mentioned insights are telling us the **cholestrol level is a neutral factor for heart attcks(!)** which is in contrast with medical evidences including WHO report on heart attack risk factors. So, this is <span style=\"color:red;font-size:16pt;font-weight:bold\">another indicator for a possible bias in the data<\/span>.","4c6a3067":"### Primary Data Observation \n\nNow that we have **no duplication among**, **our features are all numerical** and **our features' names are meaningful enough**, it's time to **get familiar with data through some data visualization steps**:\n\nFirst, let's see if our data is balanced w.r.t \"**age**\" and \"**Gender**\" of samples or not:","eeab3bd0":"Let's take a look at the correlation between the **Cholesterol Level**, as **one of the known heart attack risk factors** and the target feature (heart attack prediction result) among the data:","b8c777db":"## Feature description:\n\nThe very short documentation of the project, provides following descriptions for each feature of the the `heart.csv` file: \n\n1. **Age**: Age of the patient in years\n\n2. **Sex**: Gender of the patient, possibly:\n    - 0: Female\n    - 1: Male\n    \n3. **cp**: Chest Pain type, For this feature, possible values and their meaning are as follows:\n    - 0: typical angina\n    - 1: atypical angina\n    - 2: non-anginal pain\n    - 3: asymptomatic    \n    \n4. **trtbps**: resting blood pressure (in mm Hg on admission to the hospital)\n\n5. **chol**: Serum cholestoral (mg\/dl) fetched via BMI sensor\n\n6. **fbs**: (fasting blood sugar > 120 mg\/dl)\n  - 0: No\n  - 1: Yes\n\n7. **restecg**: resting electrocardiographic results. \n    \n    For this feature, possible values and their meaning are as follows:\n  - 0: hypertrophy (enlargement and thickening of the walls of heart's main pumping chamber - left ventricle)\n  - 1: normal\n  - 2: having ST-T wave abnormality (T wave inversions and\/or ST elevation or depression of > 0.05 mV)\n  \n8. **thalach**: maximum heart rate achieved during thalium stress test  \n  \n9. **exng**: exercise induced angina:\n    - 0: No\n    - 1: Yes\n    \n10. **oldpeak**: ST depression induced by exercise relative to rest    \n\n11. **slp**: the slope of the peak exercise ST segment:\n  - 0: downsloping\n  - 1: flat\n  - 2: upsloping\n    \n12. **caa**: number of major vessels colored by flourosopy (0-3) .\n\n13. **thall**: Thalium stress test result: \n    - 1: fixed defect\n    - 2: normal\n    - 3: reversible defect\n\n14. **output**: the predicted angiographic disease status (target feature)\n    - 0: less than 50% diameter narrowing\n    - 1: more than 50% diameter narrowing","6ebcb9e2":"### 1. Exploratory Data Analysis\n\nExploratory Data Analysis (EDA) is one of the first steps in the data analytics process. This step can be difined as the application of different data visualization techniques on the data to achieve all or some of the following objectives:\n\n1. Gaining new insights about the data\n2. Identifying important chracteristics of the data \n3. Discovering the hidden relations among the data\n4. Detecting outliers and anomalies of the data\n5. Catching mistakes and anomalies\n6. Testing our primary assumption about the data\n\nand much more.","8a441f59":"# Our usecase: Heart attack prediction problem\n\nBased on the above-mentioned steps, we determine the following points for the current project:\n\n## Problem Identification\/ Problem statement\n\nThe problem, this project is going to analyze is <u>**one of the most common and deadly human body failures**<\/u>: <span style=\"color:red;font-size:16pt\">**The heart attack**<\/span>. \n\nAccording to the <span style=\"color:#008dc9;font-size:16pt\">**World Health Organization (WHO)**<\/span> <a href=\"https:\/\/www.who.int\/news-room\/fact-sheets\/detail\/cardiovascular-diseases-(cvds)\">report<\/a>:\n- <span style=\"color:#5C1009;font-size:16pt;font-weight:bold\">Cardiovascular diseases (CVDs)<\/span> are the **leading cause of death globally**. \n- An estimated **17.9 million people died from CVDs in 2019**, representing **32% of all global deaths**. Of these deaths, 85% were due to **heart attack** and **stroke**.\n- Over **three quarters of CVD deaths** take place in **low- and middle-income countries**.\n- Out of the **17 million premature deaths (under the age of 70)** due to noncommunicable diseases in **2019**, **38% were caused by CVDs**.\n- Most cardiovascular diseases <u>can be prevented<\/u> by addressing **behavioural risk factors** such as:\n    - **tobacco use**, \n    - **unhealthy diet** and **obesity**, \n    - **physical inactivity** and **harmful use of alcohol**.\n\nAnother report reveals about half of all Americans (47%) have at least 1 of 3 key risk factors for heart disease: \n- **high blood pressure**, \n- **high cholesterol**, and \n- **smoking**'.\n\nIn addition, while some actions can be taken to decrease the effect of the above-mentioned risk factors, some other risk factors of heart disease such as the **age** or the **family history** cannot be controlled.\n\nThe following map (<a href=\"https:\/\/ourworldindata.org\/grapher\/cardiovascular-disease-death-rates\">source<\/a>) illustrates how **different life styles** and **eating habits** of the people around the world varies the death rate from CVDs in different countries:","ff6fcd76":"---\n## Data Analytics Process","7309a340":"## More illustrations on features with direction correlation with heart attack probability\n\nAs discussed in the second item of the above section, `cp`, `slp`and `talachh` are 3 features that seem to have a **direct correlation with the heart attack probabilty**.\n\nThe first feature, `ChestPainType` (chest pain type), can be considered as a <u>phisical sign that something is wrong<\/u>. Generally speaking, when a person has pain in the chest, it is more possible to conclude that the person is more prone to have a kind of heart problem. \n\nSince the `ChestPainType` featues <u>does <span style=\"color:red\">**NOT**<\/span> include<\/u> any values that indicates **no chest pain**, we cannot determine the correlation between **having the chest pain** and the **probability of having a heart attack in the future**. Instead, we can investigate **which types of the chest pain can be considered as serious signs of a potetial heart attack**:","01114c55":"# Preface\n\nIn each data analysis project like this, there is a certain path toward success. Such a path can be considered as the set of following steps that we need to go through to take the required actions, gather the necessary information, and finally perform a well-structured data analysis.\n\n## Problem Identification\/ Problem statement\n\nFirst of all, in each project, we should understand what exactly the problem is, which reasons exist behind the problem, how does it affect all the involved parties and what are clarified points in the main goal of this data science project or the business goal of the action. \n\nTo clarify the final objective of the project, we may ask oursekves the following question: \n\n***For what purpose can the company\/customer use the provided analysis?***"}}