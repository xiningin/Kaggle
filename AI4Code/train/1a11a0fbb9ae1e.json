{"cell_type":{"924b87b0":"code","854bd926":"code","eaf8cc17":"code","42b3d2c3":"code","47de6a23":"code","7a4b3550":"code","f3a67624":"code","2c4e1d59":"code","cde53496":"code","0d15e2d8":"code","a132a791":"code","9c119654":"code","a53ff30e":"code","9eddeac5":"code","3ed2ab6b":"code","b3c14f52":"code","6daaee49":"code","a9996854":"code","85a2ff3b":"code","e31a3aa4":"code","7bbe9562":"code","a7adf1f8":"code","c8ff6bee":"code","5d4074af":"code","9b9be096":"code","ac3c1c5f":"code","3e02d883":"code","d5783f5a":"code","d05b96ae":"code","be5dc822":"code","327f7271":"code","4e9a18d3":"code","5464bd0a":"code","e0e1a59c":"code","bf4b8dd3":"code","e3eded6f":"code","92666072":"code","bf11c523":"code","74be4f81":"markdown","f89667b2":"markdown","933871c5":"markdown","bf97fb54":"markdown","8076ff03":"markdown","977bba1e":"markdown","05e8e5e5":"markdown","74f4eb78":"markdown","61d6c4cf":"markdown","2461acbf":"markdown","14ce01a2":"markdown","4fa0345c":"markdown","fa3c97a5":"markdown","7b01b7ed":"markdown","51ade23d":"markdown"},"source":{"924b87b0":"# Drug classification problem ","854bd926":"import pandas as pd\nimport numpy as np","eaf8cc17":"df_drug =pd.read_csv(\"..\/input\/drug-classification\/drug200.csv\")\ndf_drug.head()","42b3d2c3":"df_drug.shape","47de6a23":"df_drug.describe()","7a4b3550":"df_drug.describe(include=object)","f3a67624":"df_drug.duplicated().sum()","2c4e1d59":"df_drug.isnull().sum()","cde53496":"100*df_drug['Drug'].value_counts()\/len(df_drug)","0d15e2d8":"import seaborn as sns\nimport matplotlib.pyplot as plt\nimport plotly.express as px\nimport plotly.graph_objects as go","a132a791":"df_drug.head()","9c119654":"plt.figure(figsize=(8,6))\nsns.countplot(x=df_drug['Drug'])\nplt.title('COUNTPOT OF TYPE OF DRUGS')\nplt.xlabel(\"Drugs type\")\nplt.grid(True)\nplt.show()","a53ff30e":"100*df_drug['Drug'].value_counts()\/len(df_drug)","9eddeac5":"sns.pairplot(df_drug)\nplt.show()","3ed2ab6b":"import scipy.stats as st\nprint(' Na to k',st.shapiro(df_drug['Na_to_K']))\nprint(\"Age\",st.shapiro(df_drug['Age']))\n# from shapiro test it is clear p value is almost zero ,show distribution is not normal","b3c14f52":"sns.heatmap(df_drug.corr(),annot=True)\nplt.show()","6daaee49":"fig = px.scatter_3d(df_drug, x='Age', y='Na_to_K', z='BP',\n              color='Drug')\nfig.show()","a9996854":"fig = px.scatter_3d(df_drug, x='Age', y='Na_to_K', z='Cholesterol',\n              color='Drug')\nfig.show()","85a2ff3b":"plt.figure(figsize=(8,6))\nsns.stripplot(x=df_drug['BP'],y=df_drug['Age'])\nplt.show()","e31a3aa4":"plt.figure(figsize=(8,6))\nsns.stripplot(x=df_drug['BP'],y=df_drug['Na_to_K'])\nplt.show()","7bbe9562":"plt.figure(figsize=(8,6))\nsns.stripplot(x=df_drug['Cholesterol'],y=df_drug['Na_to_K'])\nplt.show()","a7adf1f8":"plt.figure(figsize=(8,6))\nsns.boxplot(x=df_drug['Drug'],y=df_drug['Age'],hue =df_drug['Sex'])\nplt.show()","c8ff6bee":"plt.figure(figsize=(8,6))\nsns.violinplot(x=df_drug['Drug'],y=df_drug['Na_to_K'],hue =df_drug['Sex'],split=True)\nplt.show()","5d4074af":"df_drug.head()","9b9be096":"df_drug = pd.get_dummies(df_drug, columns =['BP','Sex', 'Cholesterol'],drop_first=True)","ac3c1c5f":"df_drug.head()","3e02d883":"# applying base algorithm\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import RandomForestClassifier\n\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import LabelEncoder","d5783f5a":"from sklearn.metrics import plot_confusion_matrix, plot_roc_curve, confusion_matrix, classification_report, roc_auc_score, cohen_kappa_score,accuracy_score\nfrom sklearn.model_selection import cross_val_score","d05b96ae":"X= df_drug.drop(\"Drug\",axis=1)\ny = df_drug['Drug']\nle = LabelEncoder()\ny = le.fit_transform(y)\ndt=DecisionTreeClassifier()\nX_train, X_test, y_train, y_test = train_test_split( X, y, test_size=0.3, random_state=42)\nprint(X_train.shape)\nprint(y_train.shape)\nprint(X_test.shape)\nprint(y_test.shape)\nprint(y)","be5dc822":"dt_model = dt.fit(X_train,y_train)\ny_predict = dt_model.predict(X_test)\nprint(confusion_matrix(y_test,y_predict))\nprint(classification_report(y_test,y_predict,digits=6))","327f7271":"roc_auc_score(y_test,dt_model.predict_proba(X_test),multi_class='ovr')","4e9a18d3":"feat =dt_model.feature_importances_\ndf_imp_dt =pd.DataFrame(feat,index = df_drug.drop(\"Drug\",axis=1).columns,columns=['val'])\ndf_imp_dt.sort_values(by='val',ascending=False)","5464bd0a":"barplot_feature =px.bar(df_imp_dt.sort_values(by='val',ascending=False))\nbarplot_feature.show()","e0e1a59c":"rf =RandomForestClassifier()\nrf_model =rf.fit(X_train,y_train)\ny_predict = rf_model.predict(X_test)\nprint(confusion_matrix(y_test,y_predict))\nprint(classification_report(y_test,y_predict,digits=6))","bf4b8dd3":"roc_auc_score(y_test,rf_model.predict_proba(X_test),multi_class='ovo')","e3eded6f":"feat =rf_model.feature_importances_\ndf_imp_rf =pd.DataFrame(feat,index = df_drug.drop(\"Drug\",axis=1).columns,columns=['val'])\ndf_imp_rf.sort_values(by='val',ascending=False)\n\nbarplot_feature_random_forest =px.bar(df_imp_rf.sort_values(by='val',ascending=False))\nbarplot_feature_random_forest.show()","92666072":"plot_confusion_matrix(rf_model,X_test,y_test)\nplt.title(\"CONFUSION MATRIX OF RANDOM FOREST MODEL\")\nplt.show()  # in the matrix  0,1,2,3,4 refers to ['DrugY' 'drugA' 'drugB' 'drugC' 'drugX'] respcetively","bf11c523":"print(\"Kappa score\")\nprint(cohen_kappa_score(y_test,y_predict))\nprint(\"AUC score\")\ny_predict_prob = rf_model.predict_proba(X_test)\nprint(roc_auc_score(y_test,y_predict_prob,multi_class='ovr'))","74be4f81":"Graph shows\n1. drug b is generally given to people of high bp and age above 50, drg A is preferred for high bp with age less than 40\n2. all other drugs except drug b and drug are give to all age person, \n3. the drug c,drug x, drud b , drug a, are preffered for low level of NA to K , drug x for low and normal bp, drug c for normal bp, and drug a and b fro high bp  ","f89667b2":"Here ,it is clear the count od drugy and drug x are high while drug c and drug b are less in count","933871c5":"Since the decision tree is performin well, there is no need to apply approach like random forest , but if the aim is to make the model robust than random\nforest model will be great","bf97fb54":"Graph shows that there is high cholestrol that have link to low Na_to_k","8076ff03":"# Visualization","977bba1e":"From the graph we can make sure that the distribution of drugs gender wise along with sodasium to potasium ratio is not uniform for both sex. It lead us to think in different direction that , is the drug acts differently on the femal and male body or it is just an odd observation in small sample of the data.","05e8e5e5":"from the heatmap it is clear that that there is not high or moderate correlation between age and Na_to_K","74f4eb78":"### Data conversion","61d6c4cf":"From the graph it  is clear that there is huge difference in gender for the drugB, it brings question whether drug is effective for female with age greater \nthan 50 but not in male, or the graph might be like this only due to availability of samples in the data","2461acbf":"# Modelling","14ce01a2":"the graph make sure that problem of high BP does not belongs to particular category","4fa0345c":"# Improvng model with random forest","fa3c97a5":"\n\n# Important feature","7b01b7ed":"From the graph the disctribution of age is not norma, howevel Na_to_K appear to follow normal distribution","51ade23d":"from the 2 3d graph it is clear that the drug c is preffered for high cholesterol "}}