{"cell_type":{"34ccab2f":"code","84ebc563":"code","fb4b3b76":"code","7898bbbf":"code","feb35a08":"code","7bd1895f":"code","6a478959":"code","2953ec33":"code","1dd87a19":"code","d27e5e36":"code","04e95043":"code","73903bab":"code","d817261d":"code","b8bfa42b":"code","53497b0e":"code","0fdf871f":"code","60992ae4":"code","75971067":"code","47c4a23c":"code","68059df6":"code","ca9efa3b":"code","8b041819":"code","6a428c7e":"code","2f8a6015":"code","c230116b":"code","c4f5cfc5":"code","a5daedc8":"code","1d0cfb10":"code","c96161c0":"code","954706b6":"code","dbe5d0ec":"code","86359019":"code","999039d3":"code","f46d72f2":"code","a59ac6fd":"markdown","70bca21d":"markdown","004bcf7e":"markdown","6a302d20":"markdown","02b6cd69":"markdown","1b059806":"markdown","87131855":"markdown","24ab166b":"markdown","fae3080d":"markdown","c2f3d002":"markdown","c42f0067":"markdown","92ed8e83":"markdown","4466a7ed":"markdown","edc69031":"markdown"},"source":{"34ccab2f":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.preprocessing import LabelEncoder\n\nfrom sklearn.model_selection import train_test_split, cross_val_score\n","84ebc563":"df = pd.read_csv('..\/input\/summer-products-and-sales-in-ecommerce-wish\/summer-products-with-rating-and-performance_2020-08.csv')\ndf.head()","fb4b3b76":"df.head().T","7898bbbf":"df.info()","feb35a08":"df.describe()","7bd1895f":"df.isna().sum()","6a478959":"max_unique = 60\nhigh_unique = [col for col in df.select_dtypes(exclude=np.number)\n                   if df[col].nunique() > max_unique]\ndf = df.drop(columns=high_unique)\ndf.info()","2953ec33":"df.head().T","1dd87a19":"df['currency_buyer'].value_counts()","d27e5e36":"corr = df.corr()\ncorr","04e95043":"fig,ax = plt.subplots(figsize = (16,16))\nax = sns.heatmap(corr,\n                 annot=True,\n                 linewidths=1.2,\n                 fmt=\".2f\",\n                 cmap=\"YlGnBu\");","73903bab":"sns.countplot(df['origin_country']);","d817261d":"sns.countplot(df['urgency_text']);","b8bfa42b":"sns.barplot(x = df.origin_country,y = df.units_sold);","53497b0e":"df['has_urgency_banner'].value_counts()","0fdf871f":"df = df.drop(['crawl_month','origin_country','rating_count','shipping_option_name','urgency_text'],axis = 1)","60992ae4":"df.head().T","75971067":"df.info()","47c4a23c":"le = LabelEncoder()\ndf['currency_buyer'] = le.fit_transform(df['currency_buyer'])\ndf['theme'] = le.fit_transform(df['theme'])","68059df6":"for label,content in df.items():\n    if pd.api.types.is_numeric_dtype(content):\n        if pd.isna(content).sum():\n            print(label)","ca9efa3b":"df['has_urgency_banner'].value_counts()","8b041819":"df['has_urgency_banner'] = df['has_urgency_banner'].fillna(0)","6a428c7e":"for label,content in df.items():\n    if pd.api.types.is_numeric_dtype(content):\n        if pd.isna(content).sum():\n            df[label] = content.fillna(content.median())","2f8a6015":"df.info()","c230116b":"df.head()","c4f5cfc5":"df.isna().sum()","a5daedc8":"x = df.drop('units_sold',axis = 1)\ny = df['units_sold']","1d0cfb10":"x_train,x_test,y_train,y_test = train_test_split(x,y, test_size = 0.2)","c96161c0":"model = RandomForestRegressor(n_estimators = 1000,random_state = 42)\nmodel.fit(x_train,y_train)","954706b6":"model.score(x_test,y_test)","dbe5d0ec":"model1 = LinearRegression()\nmodel1.fit(x_train,y_train)","86359019":"model1.score(x_test,y_test)","999039d3":"scores = pd.DataFrame({'RandomForest': model.score(x_test,y_test),\n                       'LinearRegression': model1.score(x_test,y_test)},\n                        index = [0])\n","f46d72f2":"scores.T.plot(kind = 'bar',\n              figsize = (10,10))\nplt.title('Scores of all Model')\nplt.xlabel('Model Name')\nplt.ylabel('Scores');","a59ac6fd":"## Building correlation","70bca21d":"## Loading The data","004bcf7e":"# Plotting the scores of both the model","6a302d20":"## Some Basic Data Exploration","02b6cd69":"# Building the models\n# RandomForest","1b059806":"filling all the other columns with meadian","87131855":"## Visualizing some columns","24ab166b":"filling 'has_urgency_banner' column with 0 ","fae3080d":"Dropping some more columns","c2f3d002":"# LinearRegression","c42f0067":"Checking all the columns with Missing values","92ed8e83":"## Dropping Some Columns\nDropping the columns with many unique categories coz they wont be very helpful and they will just add many dimensions to the data.","4466a7ed":"# Splitting the data into Training and Testing sets","edc69031":"# LabelEncoding 'currency_buyer'& 'theme' columns"}}