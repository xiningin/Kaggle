{"cell_type":{"4b71aafa":"code","45be24e5":"code","42c88da7":"code","02752320":"code","82a0582d":"code","78be7c6e":"code","e78b84d8":"code","1e42f283":"code","48fe7981":"code","1002e9cd":"code","c4e72d5f":"code","10bc950e":"code","b1e2ec2d":"code","ae1ab8b9":"code","061321dd":"markdown","cabaee55":"markdown","184642c8":"markdown","7ff756a4":"markdown"},"source":{"4b71aafa":"import pandas as pd","45be24e5":"import os\nprint (os.listdir('..\/input\/adult-data'))","42c88da7":"train = pd.read_csv('..\/input\/adult-data\/train_data.csv', na_values = '?')\ntest = pd.read_csv('..\/input\/adult-data\/test_data.csv', na_values = '?')","02752320":"train.head()","82a0582d":"#nao usei fnlwgt para aumentar acuracia\nXtrain = train[['education.num', 'capital.gain', 'capital.loss', 'hours.per.week']] \nYtrain = train[['income']]\n\nprint(Xtrain.head())\nprint(Ytrain.head())","78be7c6e":"print(Xtrain.shape, Ytrain.shape)\nprint(Xtrain.dropna().shape, Ytrain.dropna().shape)\n#percebe-se que n\u00e3o h\u00e1 dados NaN nas vari\u00e1veis quantitativas","e78b84d8":"Xtest = test[['education.num', 'capital.gain', 'capital.loss', 'hours.per.week']]\n\nprint(Xtest.shape)\nprint(Xtest.dropna().shape)","1e42f283":"from sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.model_selection import cross_val_score","48fe7981":"import numpy as np","1002e9cd":"for i in range(1,30):\n    knn = KNeighborsClassifier(n_neighbors = i)\n    scores = cross_val_score(knn, Xtrain, Ytrain.values.ravel(), cv = 5)\n    \n    print(i, np.mean(scores))","c4e72d5f":"knn = KNeighborsClassifier(n_neighbors = 16)\nknn.fit(Xtrain, Ytrain.values.ravel())","10bc950e":"Ypred = knn.predict(Xtest) #predi\u00e7\u00e3o type = numpy array","b1e2ec2d":"Ypred_d = pd.DataFrame(data = Ypred) #transformo a minha numpy array em um DataFrame de Pandas","ae1ab8b9":"Ypred_d.to_csv('submission7.csv') #crio o arquivo para submeter no Kaggle","061321dd":"Agora vou buscar o melhor parametro (numero de vizinhos) para o meu banco de dados:","cabaee55":"A maior acur\u00e1cia foi obtida com 16 neighbors, logo vou montar o meu classificador com esse valor.","184642c8":"A partir desse resultado, percebe-se que, avaliando apenas as colunas quantitativas, n\u00e3o h\u00e1 valores NaN. Agora vou fazer o mesmo tratamento de cima para o meu banco de testes.","7ff756a4":"A an\u00e1lise dos meus dados me mostra que os dados quantitativos s\u00e3o: fnlwgt, education.num, capital.gain, capital.loss, hours.per.week\nO meu target \u00e9 o income (<=50k ou >=50k)"}}