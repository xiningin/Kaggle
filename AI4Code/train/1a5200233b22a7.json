{"cell_type":{"3f2af0d6":"code","a1941231":"code","ee8f0499":"code","3d688b21":"code","272dbe87":"code","8ae93bbe":"code","3260ae7b":"code","92f75b6b":"code","2dcde878":"code","848573de":"code","dfe2d0c2":"code","73174264":"code","c8b22c50":"code","1a2e34fa":"code","87ba751d":"code","7c396b48":"code","4a614ca8":"code","b7cc1a72":"code","31f9797d":"code","2f1582a3":"code","8afd201b":"code","532580b2":"code","dea6a342":"code","e8d4ddd8":"code","6edf0b69":"code","c53923f2":"code","328783fe":"code","fb16a68b":"code","347c6401":"code","ccc4f720":"code","bdefd58c":"code","17ae2bb4":"code","cbd56007":"code","2f45ce16":"code","6ea3a290":"code","2d0f7d7a":"code","ba987919":"code","edd235a6":"code","6332bbe8":"code","176b186e":"code","391192bf":"markdown","7045fe43":"markdown"},"source":{"3f2af0d6":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","a1941231":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport matplotlib as mpl\nfrom scipy import stats\nfrom scipy.stats import norm\nimport seaborn as sns\nimport os\nimport warnings\nwarnings.filterwarnings('ignore')\n\nsns.set_style('whitegrid')\n%matplotlib inline","ee8f0499":"path = '\/kaggle\/input\/walmart-recruiting-store-sales-forecasting\/'\n\nfeatures = pd.read_csv(path + 'features.csv.zip')\nsampleSubmission = pd.read_csv(path + 'sampleSubmission.csv.zip')\nstores = pd.read_csv(path + 'stores.csv')\ntrain = pd.read_csv(path + 'train.csv.zip')\ntest = pd.read_csv(path + 'test.csv.zip')","3d688b21":"sampleSubmission.sample(4)","272dbe87":"print(features.shape)\nfeatures.sample(4)","8ae93bbe":"print(train.shape)\ntrain.sample(4)","3260ae7b":"print(test.shape)\ntest.sample(4)","92f75b6b":"print(stores.shape)\nstores.sample(4)","2dcde878":"data_val = test.copy(deep = True)\ndata_train = train.copy(deep = True)","848573de":"import pandas as pd\nstores = pd.read_csv(\"..\/input\/walmart-recruiting-store-sales-forecasting\/stores.csv\")","dfe2d0c2":"import pandas as pd\nstores = pd.read_csv(\"..\/input\/walmart-recruiting-store-sales-forecasting\/stores.csv\")","73174264":"combined_train = pd.merge(data_train, stores, how = 'left', on = 'Store')\ncombined_test = pd.merge(data_val, stores, how = 'left', on = 'Store')","c8b22c50":"combined_train = pd.merge(combined_train, features, how = 'inner', on = ['Store', 'Date'])\ncombined_test = pd.merge(combined_test, features, how = 'inner', on = ['Store', 'Date'])","1a2e34fa":"data = pd.concat([combined_train, combined_test], axis = 0, ignore_index = True)","87ba751d":"print('The size of the train data {}'.format(train.shape[0]))","7c396b48":"# Make datetypes constant for all datasets\n\ndata['Date'] = pd.to_datetime(data['Date'], format=\"%Y-%m-%d\")","4a614ca8":"data.drop(['IsHoliday_y'], axis = 1, inplace = True)\ndata.rename(columns = {'IsHoliday_x': 'IsHoliday'}, inplace = True)","b7cc1a72":"Total = data.isnull().sum().sort_values(ascending = False)\nPercent = Total \/ data.shape[0]\nDataTypes = data.dtypes\n\npd.concat([Total, Percent, DataTypes], axis = 1, keys = ['Total', 'Percent', 'DataTypes']).sort_values(by = ['Total'], ascending = False)","31f9797d":"data.loc[data['Weekly_Sales'] < 0, 'Weekly_Sales'] = 0\ndata.loc[data['MarkDown1'] < 0, 'Weekly_Sales'] = 0\ndata.loc[data['MarkDown2'] < 0, 'Weekly_Sales'] = 0\ndata.loc[data['MarkDown3'] < 0, 'Weekly_Sales'] = 0\ndata.loc[data['MarkDown4'] < 0, 'Weekly_Sales'] = 0\ndata.loc[data['MarkDown5'] < 0, 'Weekly_Sales'] = 0","2f1582a3":"data.fillna(0, inplace = True)\ndata.isnull().sum().to_frame()","8afd201b":"data.dtypes","532580b2":"plt.figure(figsize = (12, 10))\n\nsns.set_style('whitegrid')\n\nax0 = sns.lineplot(x = 'Date', y = 'CPI', data = data[0:421570].loc[data['CPI'] < 180], palette = 'mako')\nax0.set(title = 'The CPI of the City ', xlabel = 'Date', ylabel = 'CPI index')","dea6a342":"plt.figure(figsize = (12, 10))\n\nsns.set_style('whitegrid')\n\nax1 = sns.lineplot(x = 'CPI', y = 'Weekly_Sales', data = data[0:421570].loc[data['CPI'] < 180], palette = 'mako')\nplt.title('The relationship of CPI and Weekly Sales', fontsize = 15)\nplt.xlabel('CPI Index', fontsize = 15)\nplt.ylabel('Weekly Sales', fontsize = 15)","e8d4ddd8":"plt.figure(figsize = (12, 10))\n\nsns.set_style('whitegrid')\n\nax2 = sns.catplot(x = 'Size', y = 'Weekly_Sales', data = data.loc[0:421570], palette = 'mako')\n# ax2.set(title = 'The relationship of Size and Weekly Sales', xlabel = 'Size', ylabel = 'Weekly Sales')\nplt.title('The relationship of Size and Weekly Sales', fontsize = 15)\nplt.xlabel('Size', fontsize = 15)\nplt.ylabel('Weekly Sales', fontsize = 15)\nplt.show()","6edf0b69":"plt.figure(figsize = (12, 10))\n\nsns.set_style('whitegrid')\n\nax3 = sns.boxplot(y = 'Weekly_Sales', x = 'Type', hue = 'IsHoliday', data = data.loc[0:421570].loc[data['Weekly_Sales'] < 50000], palette = 'mako')\nax3.set(title = 'The relationship of Weekly Sales and Stroe Types', xlabel = 'Store Type', ylabel = 'Week Sales')","c53923f2":"plt.figure(figsize = (12, 10))\n\nsns.set_style('whitegrid')\n\nax4 = sns.violinplot(x = 'Type', y = 'Weekly_Sales', hue = 'IsHoliday', split = True, data = data.loc[0:421570].loc[data['Weekly_Sales'] < 100000], palette = 'mako')\nax4.set(title = 'The distrubtion of the Type and Weekly Sales', xlabel = 'The type of the Stores', ylabel = 'Weekly Sales')","328783fe":"plt.figure(figsize = (12, 10))\nsns.set_style('whitegrid')\nax5 = sns.catplot(x = 'Size', hue = 'Type', kind = 'count', data = data.loc[0:421570], palette = 'mako')\nax5.set(title = 'The distrubtion of the Type of the stores', xlabel = 'The size of the Stores', ylabel = 'Type of the stores')\nplt.xticks(rotation = 45)","fb16a68b":"plt.figure(figsize = (12, 10))\n\nsns.set_style('whitegrid')\n\nax6 = sns.distplot(data.loc[0:421570, 'Weekly_Sales'], hist = True, fit = norm)","347c6401":"ax7 = plt.figure(figsize = (12, 10))\n\nax7.add_subplot(1, 2, 1)\nres = stats.probplot(data.loc[0:421570, 'Weekly_Sales'] ,  plot = plt)\n\nax7.add_subplot(1, 2, 2)\nres = stats.probplot(np.log1p(data.loc[0:421570, 'Weekly_Sales']) , plot = plt)","ccc4f720":"groupedData = data.loc[0:421570].groupby(['Dept', 'Date']).mean().round(0).reset_index()\nprint(groupedData.shape)\ngroupedData.sample(4)","bdefd58c":"print('The values of Dept'.center(50, '-'))\nprint(data.loc[0:421570,'Dept'].unique())\nprint('The number of Dept'.center(50, '-'))\ndata.loc[0:421570, 'Dept'].nunique()","17ae2bb4":"print('The values of Dept'.center(50, '-'))\nprint(groupedData['Dept'].unique())\nprint('The number of Dept'.center(50, '-'))\ngroupedData['Dept'].nunique()","cbd56007":"groupedData2 = groupedData[['Dept', 'Date', 'Weekly_Sales']]\ngroupedData2.sample(4)","2f45ce16":"dept = groupedData2['Dept'].unique()\n\ndept.sort()\ndept_1=dept[0:20]\ndept_2=dept[20:40]\ndept_3=dept[40:60]\ndept_4=dept[60:]\n\nfig, ax = plt.subplots(2,2,figsize=(20,10))\nfig.subplots_adjust(wspace=0.5, hspace=0.5)\nfig.subplots_adjust(left=0.1, right=0.9, bottom=0.1, top=0.9)\n\nfor i in dept_1 :\n    data_1=groupedData2[groupedData2['Dept']==i]\n    ax[0,0].plot(data_1['Date'], data_1['Weekly_Sales'],label='Dept_1_mean_sales')\n\nfor i in dept_2 :\n    data_1=groupedData2[groupedData2['Dept']==i]\n    ax[0,1].plot(data_1['Date'], data_1['Weekly_Sales'],label='Dept_1_mean_sales')\n    \nfor i in dept_3 :\n    data_1=groupedData2[groupedData2['Dept']==i]\n    ax[1,0].plot(data_1['Date'], data_1['Weekly_Sales'],label='Dept_1_mean_sales')    \n\nfor i in dept_4 :\n    data_1=groupedData2[groupedData2['Dept']==i]\n    ax[1,1].plot(data_1['Date'], data_1['Weekly_Sales'],label='Dept_1_mean_sales')        \n    \nax[0,0].set_title('Mean sales record by department(0~19)')\nax[0,1].set_title('Mean sales record by department(20~39)')\nax[1,0].set_title('Mean sales record by department(40~59)')\nax[1,1].set_title('Mean sales record by department(60~)')\n\n\nax[0,0].set_ylabel('Mean sales')\nax[0,0].set_xlabel('Date')\nax[0,1].set_ylabel('Mean sales')\nax[0,1].set_xlabel('Date')\nax[1,0].set_ylabel('Mean sales')\nax[1,0].set_xlabel('Date')\nax[1,1].set_ylabel('Mean sales')\nax[1,1].set_xlabel('Date')\n\n\nplt.show()","6ea3a290":"groupedData3 = data.loc[0:421570].groupby(['Store', 'Date']).mean().reset_index()\ngroupedData3.shape","2d0f7d7a":"print(groupedData3['Store'].unique())\nprint(groupedData3['Store'].nunique())","ba987919":"groupedData4 = groupedData3[['Store', 'Date', 'Weekly_Sales']]\ngroupedData4.head(4)","edd235a6":"store = groupedData4['Store'].unique()","6332bbe8":"store_1 = store[0 : 10]\nstore_2 = store[11 : 21]\nstore_3 = store[22 : 33]\nstore_4 = store[34 : -1]\n\nfig, ax = plt.subplots(2,2,figsize=(20,10))\nfig.subplots_adjust(wspace=0.5, hspace=0.5)\nfig.subplots_adjust(left=0.1, right=0.9, bottom=0.1, top=0.9)\n\nfor i in store_1 :\n    data_1=groupedData4[groupedData4['Store']==i]\n    ax[0,0].plot(data_1['Date'], data_1['Weekly_Sales'],label='Dept_1_mean_sales')\n\nfor i in store_2 :\n    data_1=groupedData4[groupedData4['Store']==i]\n    ax[0,1].plot(data_1['Date'], data_1['Weekly_Sales'],label='Dept_1_mean_sales')\n    \nfor i in store_3 :\n    data_1=groupedData4[groupedData4['Store']==i]\n    ax[1,0].plot(data_1['Date'], data_1['Weekly_Sales'],label='Dept_1_mean_sales')    \n\nfor i in store_4 :\n    data_1=groupedData4[groupedData4['Store']==i]\n    ax[1,1].plot(data_1['Date'], data_1['Weekly_Sales'],label='Dept_1_mean_sales')        \n    \nax[0,0].set_title('Mean sales record by department(0~10)')\nax[0,1].set_title('Mean sales record by department(11~21)')\nax[1,0].set_title('Mean sales record by department(22~33)')\nax[1,1].set_title('Mean sales record by department(34~)')\n\n\nax[0,0].set_ylabel('Mean sales')\nax[0,0].set_xlabel('Date')\nax[0,1].set_ylabel('Mean sales')\nax[0,1].set_xlabel('Date')\nax[1,0].set_ylabel('Mean sales')\nax[1,0].set_xlabel('Date')\nax[1,1].set_ylabel('Mean sales')\nax[1,1].set_xlabel('Date')\n\n\nplt.show()","176b186e":"print(data.shape)\ndata.head(4)","391192bf":"#### Joining Tables","7045fe43":"#### Handled the missing value"}}