{"cell_type":{"21a7d66d":"code","88590215":"code","6a83b828":"code","e6187b90":"code","efc90e56":"code","634eb138":"code","e61d42e1":"code","9420a960":"code","d81eb618":"code","4365004e":"code","8eaeb60f":"code","27be391b":"code","350a8be4":"code","72f23190":"code","e6498cb6":"markdown","6609ad5f":"markdown","49327e91":"markdown","3d7af329":"markdown","e4b45419":"markdown","7f228342":"markdown","542f9931":"markdown","1ecb524d":"markdown","d2813e79":"markdown","736b5d32":"markdown"},"source":{"21a7d66d":"!pip -q install catboost\n\n#Install visualization tools:\n#  Install the ipywidgets Python package (version 7.x or higher is required):\n!pip -q install ipywidgets\n\n#Turn on t he widgets extension:\n!jupyter nbextension enable --py widgetsnbextension\n","88590215":"import catboost as cb\nfrom catboost.datasets import titanic\nimport numpy as np\nfrom catboost import CatBoostClassifier, Pool, cv\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.model_selection import train_test_split\n\nimport pandas as pd\nimport seaborn as sns\n\nsns.set(rc = {'figure.figsize': (14,8)})","6a83b828":"df = pd.read_csv('..\/input\/tabular-playground-series-jun-2021\/train.csv')\n\ntrain_df, eval_df = train_test_split(df, train_size=0.75, random_state=42)\n\ntrain_df.head()","e6187b90":"x_train = train_df.drop( [ 'id' , 'target'] , axis = 1)\ny_train = train_df[ 'target']\n\nx_eval = eval_df.drop( [ 'id' , 'target'] , axis = 1)\ny_eval = eval_df[ 'target']","efc90e56":"# Model Creation\n\nparams = {\n    'iterations': 50,\n    #'learning_rate': 0.1,\n    'random_seed': 42,\n    'loss_function':'MultiClass',\n    'logging_level': 'Silent',\n    'use_best_model': True\n}\n\nmodel = CatBoostClassifier(**params\n)\n\n","634eb138":"model.fit(\n    x_train, y_train,\n    eval_set=(x_eval, y_eval),\n     logging_level='Verbose',  # you can uncomment this for text output\n    plot=True);","e61d42e1":"test_df = pd.read_csv('..\/input\/tabular-playground-series-jun-2021\/test.csv')\nx_test = test_df.drop( [ 'id' ] , axis = 1)\nx_test.head()","9420a960":"predictions_probs = model.predict_proba(x_test)\npredictions_probs[:10]","d81eb618":"sub = pd.DataFrame(predictions_probs)\n\nsample_df = pd.read_csv('..\/input\/tabular-playground-series-jun-2021\/sample_submission.csv')\nsample_df[sample_df.columns[1:]] = sub\n\nsample_df.head()\nsample_df.to_csv('submission.csv' , index = False)","4365004e":"# Predict \npredictions = model.predict(x_test)\nprint(predictions[:10])","8eaeb60f":"validate_pool = Pool(x_eval , y_eval)","27be391b":"model = CatBoostClassifier(iterations=50, random_seed=42, logging_level='Silent').fit(validate_pool)\nfeature_importances = model.get_feature_importance(validate_pool)\n\nsns.histplot(x = feature_importances , bins = len(feature_importances )  , legend = True , kde=True)","350a8be4":"model.plot_tree(tree_idx=0)","72f23190":"# Model Saving\nmodel = CatBoostClassifier(iterations=10, random_seed=42, logging_level='Silent').fit(train_pool)\nmodel.save_model('catboost_model.dump')\nmodel = CatBoostClassifier()\nmodel.load_model('catboost_model.dump');","e6498cb6":"# Make Predictions**","6609ad5f":"# Feature Importances","49327e91":"# Plotting Tree","3d7af329":"# TPS June 2021 dataset","e4b45419":"# What is Catboost?\n\n- Catboost is an algorithm for gradient boosting on decision trees. It is in open-source.\n","7f228342":"## How to Install","542f9931":"# Model saving and loading","1ecb524d":"By default in Kaggle- all the modules come pre-installed.","d2813e79":"# Topics for future notebook\n- Integrating Tensorboard","736b5d32":"### Functions in Catboost library\n\n- Models \n    - CatBoostClassifier\n    - CatBoostRegressor\n- Utils to improve\n    - eval_metric\n    - get_confusion_matrix\n    - get_gpu_device_count() - Returns \u201c0\u201d if the installed or compiled package does not support training on GPU.\n    - quantize\n    - select_threshold\n- Model analysis\n    - Feature importance\n    - Feature analysis charts\n    - Feature interaction"}}