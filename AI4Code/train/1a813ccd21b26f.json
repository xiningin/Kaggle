{"cell_type":{"4cae1165":"code","50b92bfc":"code","ae854075":"code","1b6eba27":"code","35c4c55a":"code","7f77b950":"code","be8ee968":"code","44bbba1b":"markdown","a5edd404":"markdown","9a2a9bb6":"markdown","dae5a1b2":"markdown","499a5c10":"markdown","87602bb8":"markdown"},"source":{"4cae1165":"import pandas as pd","50b92bfc":"rdf = pd.read_json(\"..\/input\/ranking_full_bundesliga.json\")","ae854075":"# Grouping columns by season\ngrouped = rdf.groupby(\"season\", as_index=False)\n\n# Getting rows that have \"Bayern\" in them\n# for the last matchday of each season\ndf = pd.concat(\n    objs=[\n        rdf[\n            (rdf[\"season\"] == g)\n            & (rdf[\"md\"] == grouped.get_group(g)[\"md\"].max())\n            & (rdf[\"team\"].str.contains(\"bayern\", case=False))\n        ]\n        for g in grouped.groups\n    ],\n    ignore_index=True,\n)","1b6eba27":"df","35c4c55a":"# Sorting the data in descending order to clean\n# and extracting the top 10 results\ndf[[\"season\", \"team\", \"played\", \"gf\"]].sort_values(\n    by=\"gf\", ascending=False, ignore_index=True,\n)[:10]","7f77b950":"df[\"points\"] = (3 * df[\"won\"]) + df[\"draw\"]","be8ee968":"df[\"gf\"].describe()","44bbba1b":"### Which were the top 10 seasons for Bayern Munich where they had scored maximum goals?\n\n#### Approach\n\nFirstly we read the ranking table from the database because that table has `gf` field that contains the number of goals scored by each team. We can then get the rows for each season that have the of the last matchday from them for each season as the field is cumulative in nature. After that we can extract the rows that have \"Bayern\" in `team` column. This can be sorted in descending order and then the top 10 records can be extracted and that would be our required result set.","a5edd404":"#### Using Pandas","9a2a9bb6":"The general formula for counting points is: $points = (3 * won) + draw$ because 3 points are awarded for a win and 1 for a draw.\n\nBut it can be seen that for some seasons in the beginning, each team was awarded 2 points for a win and not 3. So we need get all the data first to be calculated using same formula.","dae5a1b2":"Thus it can be seen that \"Bayern Munich\" score $75 \\pm 12$ goals each season on average","499a5c10":"This normalizes the points using the same formula and now we can use it to know annual data about \"Bayern Munich\"","87602bb8":"# Starter: German Football Scores"}}