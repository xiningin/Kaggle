{"cell_type":{"df306ace":"code","093cd8c2":"code","cba9dd7d":"code","36433007":"code","0a11af59":"code","757e7926":"code","e22b57ba":"code","32742d3c":"code","6dfeab36":"code","ea79bb8e":"code","4cb99164":"code","cc623b76":"code","bde72917":"code","63f41531":"code","27ba0c8b":"code","935d7dbe":"code","bd95b832":"code","01b3f820":"code","823f889f":"code","53a455de":"code","54278c45":"code","40dc18c6":"code","0cce9f1c":"code","11f0af2f":"code","e05dfd87":"code","966b6bc3":"code","08eb6ed5":"code","804755c4":"code","1dd90bdb":"code","61154cf7":"code","93ce7500":"code","9bc0f7d1":"code","92dd1594":"code","ece0fc85":"code","8e75c858":"code","3c82cdb7":"code","334b2f4e":"code","520d1a83":"code","3be0cf89":"code","46c3c885":"markdown","95f32a81":"markdown","9d4e9ec9":"markdown","76b547fd":"markdown","624d8e60":"markdown"},"source":{"df306ace":"import pandas as pd\nimport numpy as np\nfrom sklearn import linear_model\nfrom sklearn import tree\nfrom sklearn.tree import DecisionTreeRegressor \nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import mean_squared_error, r2_score\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.ensemble import RandomForestClassifier","093cd8c2":"df_train = pd.read_csv(\"..\/input\/socc-ai-assignment-1\/train.csv\")\ndf_test = pd.read_csv(\"..\/input\/socc-ai-assignment-1\/test.csv\")\n","cba9dd7d":"#df_train.head(20)","36433007":"#df_test.head(20)","0a11af59":"df_train['Churn']=df_train['Churn'].replace('Yes',1)\ndf_train['Churn']=df_train['Churn'].replace('No',0)","757e7926":"df_train.drop(['customerID'],axis=1,inplace=True)","e22b57ba":"df_test.drop(['customerID'],axis=1,inplace=True)","32742d3c":"#df_train.dtypes","6dfeab36":"y= df_train['Churn']","ea79bb8e":"#from sklearn.preprocessing import LabelEncoder","4cb99164":"df_train.drop(['Churn'],axis=1,inplace=True)","cc623b76":"df_train['gender']=df_train['gender'].replace('Male',1)\ndf_train['gender']=df_train['gender'].replace('Female',0)\ndf_test['gender']=df_test['gender'].replace('Male',1)\ndf_test['gender']=df_test['gender'].replace('Female',0)","bde72917":"df_train['Partner']=df_train['Partner'].replace('Yes',1)\ndf_train['Partner']=df_train['Partner'].replace('No',0)\ndf_test['Partner']=df_test['Partner'].replace('Yes',1)\ndf_test['Partner']=df_test['Partner'].replace('No',0)","63f41531":"df_train['Dependents']=df_train['Dependents'].replace('Yes',1)\ndf_train['Dependents']=df_train['Dependents'].replace('No',0)\ndf_test['Dependents']=df_test['Dependents'].replace('Yes',1)\ndf_test['Dependents']=df_test['Dependents'].replace('No',0)","27ba0c8b":"df_train['PhoneService']=df_train['PhoneService'].replace('Yes',1)\ndf_train['PhoneService']=df_train['PhoneService'].replace('No',0)\ndf_test['PhoneService']=df_test['PhoneService'].replace('Yes',1)\ndf_test['PhoneService']=df_test['PhoneService'].replace('No',0)","935d7dbe":"df_train['PaperlessBilling']=df_train['PaperlessBilling'].replace('Yes',1)\ndf_train['PaperlessBilling']=df_train['PaperlessBilling'].replace('No',0)\ndf_test['PaperlessBilling']=df_test['PaperlessBilling'].replace('Yes',1)\ndf_test['PaperlessBilling']=df_test['PaperlessBilling'].replace('No',0)","bd95b832":"'''LE= LabelEncoder()\ndf_train=LE.fit_transform(column=['Churn'])'''","01b3f820":"#'a = df_train['Churn']''","823f889f":"df_train['TotalCharges'] = df_train['TotalCharges'].replace(r'\\s+', np.nan, regex=True)\ndf_train['TotalCharges'] = pd.to_numeric(df_train['TotalCharges'])\ndf_test['TotalCharges'] = df_test['TotalCharges'].replace(r'\\s+', np.nan, regex=True)\ndf_test['TotalCharges'] = pd.to_numeric(df_test['TotalCharges'])","53a455de":"df_train['TotalCharges']=df_train['TotalCharges'].fillna(df_train['TotalCharges'].median())\ndf_test['TotalCharges']=df_test['TotalCharges'].fillna(df_test['TotalCharges'].median())","54278c45":"one_hot_encoded_training_predictors = pd.get_dummies(columns=['MultipleLines','InternetService','OnlineSecurity','OnlineBackup','DeviceProtection','TechSupport','StreamingTV','StreamingMovies','Contract','PaymentMethod'],data=df_train)\none_hot_encoded_test_predictors = pd.get_dummies(columns=['MultipleLines','InternetService','OnlineSecurity','OnlineBackup','DeviceProtection','TechSupport','StreamingTV','StreamingMovies','Contract','PaymentMethod'],data=df_test)","40dc18c6":"\n'''\ndf_train['abs_title_sentiment_polarity']=df_train['abs_title_sentiment_polarity'].replace(['0'],np.nan)\ndf_train['global_rate_negative_words']=df_train['global_rate_negative_words'].replace(['0'],np.nan)\ndf_train['rate_positive_words']=df_train['rate_positive_words'].replace(['0'],np.nan)\ndf_train['abs_title_subjectivity']=df_train['abs_title_subjectivity'].replace(['0'],np.nan)\ndf_train['title_sentiment_polarity']=df_train['title_sentiment_polarity'].replace(['0'],np.nan)\ndf_train['title_subjectivity']=df_train['title_subjectivity'].replace(['0'],np.nan)\ndf_train['max_negative_polarity']=df_train['max_negative_polarity'].replace(['0'],np.nan)\ndf_train['min_negative_polarity']=df_train['min_negative_polarity'].replace(['0'],np.nan)\ndf_train['avg_negative_polarity']=df_train['avg_negative_polarity'].replace(['0'],np.nan)\ndf_train['max_positive_polarity']=df_train['max_positive_polarity'].replace(['0'],np.nan)\ndf_train['min_positive_polarity']=df_train['min_positive_polarity'].replace(['0'],np.nan)\ndf_train['avg_positive_polarity']=df_train['avg_positive_polarity'].replace(['0'],np.nan)\ndf_train['rate_negative_words']=df_train['rate_negative_words'].replace(['0'],np.nan)\n'''","0cce9f1c":"#df_train = df_train.dropna(how='any',axis=0)","11f0af2f":"'''\nx = df[:-20]\ny = df[-20:]\n'''","e05dfd87":"one_hot_encoded_training_predictors","966b6bc3":"one_hot_encoded_test_predictors","08eb6ed5":"#model = LinearRegression().fit(df_train, y)\n#model.fit(df_train, y)","804755c4":"model = RandomForestClassifier(n_estimators=100, max_features='auto', bootstrap=True, max_depth=10, min_samples_leaf=2,min_samples_split=9).fit(one_hot_encoded_training_predictors,y)","1dd90bdb":"test_preds = model.predict(one_hot_encoded_test_predictors)","61154cf7":"model.fit(one_hot_encoded_training_predictors,y)","93ce7500":"#model.coef_","9bc0f7d1":"#model.intercept_","92dd1594":"submit = pd.DataFrame()\nsubmit['Id'] = np.arange(0,len(test_preds))\nsubmit['Expected'] = test_preds","ece0fc85":"submit['Expected']=submit['Expected'].replace(1,'Yes')\nsubmit['Expected']=submit['Expected'].replace(0,'No')","8e75c858":"submit.to_csv(\"Churn_predictat.csv\", index=False)","3c82cdb7":"'''submit1['Churn']=submit1['Churn'].replace(1,'Yes')\nsubmit1['Churn']=submit1['Churn'].replace(0,'No')'''","334b2f4e":"model.score(one_hot_encoded_training_predictors,y)","520d1a83":"#accuracy_score(test_preds, y_test)","3be0cf89":"# The coefficients\n\n#print('Coefficients: \\n', model.coef_)\n","46c3c885":"# Linear Regression","95f32a81":"# Understanding","9d4e9ec9":"# Random Forest","76b547fd":"# Manipulation and Cleaning","624d8e60":"# Getting it out"}}