{"cell_type":{"0b721fcc":"code","972782a4":"code","f17e4ebe":"markdown"},"source":{"0b721fcc":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","972782a4":"import pandas as pd\nimport lightgbm as lgb\nfrom sklearn.model_selection import train_test_split\n\ndf = pd.read_csv('..\/input\/Kannada-MNIST\/train.csv')\ncol = ['pixel%d'%i for i in range(784)]\n\nlgb_params = {\n    \"objective\" : \"multiclass\",\n    \"metric\" : \"multi_logloss\",\n    \"num_class\" : 10,\n    \"max_depth\" : 12,\n    \"num_leaves\" : 15,\n    \"learning_rate\" : 0.05,\n    \"bagging_fraction\" : 0.9,\n    \"feature_fraction\" : 0.9,\n    \"lambda_l1\" : 0.01,\n    \"lambda_l2\" : 0.0,\n}\n\nX_train, X_test, Y_train, Y_test = train_test_split(df[col], df['label'], test_size=0.1)\n\nlgtrain = lgb.Dataset(X_train, label=Y_train)\nlgtest = lgb.Dataset(X_test, label=Y_test)\nlgb_clf = lgb.train(lgb_params, lgtrain, 1500, \n                    valid_sets=[lgtrain, lgtest], \n                    early_stopping_rounds=10, \n                    verbose_eval=20)\n\ndf = pd.read_csv('..\/input\/Kannada-MNIST\/test.csv')\nres = lgb_clf.predict( df[col] ).argmax(axis=1)\n\ndf = pd.read_csv('..\/input\/Kannada-MNIST\/sample_submission.csv')\ndf['label'] = res\ndf.to_csv('submission.csv', index=False)","f17e4ebe":"This is a copy of the following notebook from the MNIST dataset: https:\/\/www.kaggle.com\/tanreinama\/lightgbm-baseline\nIf you find this script useful, please upvote the above notebook as well."}}