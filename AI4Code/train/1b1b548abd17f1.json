{"cell_type":{"906d7b0b":"code","40e43c64":"code","5254dd68":"code","60a15531":"code","a74ee20c":"code","496b4c74":"code","a23460c6":"code","775a3d3c":"code","f4b5a308":"code","7dcab20a":"code","01f9250d":"code","820d63c0":"code","9d0816ab":"code","02381a4b":"code","3446f6b9":"code","143f7fe1":"code","8aa5d9c8":"code","18856047":"markdown","074f358a":"markdown","2f1f1883":"markdown","acd62e07":"markdown","b9067a67":"markdown","74c69feb":"markdown","fce45f4e":"markdown","af907f7c":"markdown","f0197273":"markdown","622078e1":"markdown","cff6d605":"markdown","5f90a081":"markdown","8d63b5e3":"markdown","634e7cd4":"markdown","59d56238":"markdown","0f3db4c5":"markdown"},"source":{"906d7b0b":"import pandas as pd\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\nfrom scipy.stats import mannwhitneyu\nfrom scipy.stats import normaltest\n\ndata = pd.read_csv(\"..\/input\/reviews.csv\", index_col=0)","40e43c64":"data.head()","5254dd68":"print('total number of reviews: ', len(data.index))","60a15531":"genres = list(data.columns[:-2])\nprint('Among the music genres are: ',end='')\nfor genre in genres[:7]:\n    print(' '+genre+', ',end='')\nprint('...')\n\nprint('total number of genres: ',len(genres))\n","a74ee20c":"authors = list(data.AUTHOR.unique())\nprint('Review authors are denoted by letters: ',authors)","496b4c74":"grades = [i for i in range(11)]\nprint('possible grades range from ',0,' (worst) to ', 10, ' (best) with \"-\" denoting a missing value')","a23460c6":"genre_abs = [data.loc[:,g].sum() for g in genres]\ngc_data = pd.DataFrame({'genre' : genres, 'abs_freq': genre_abs}).sort_values('abs_freq',ascending=False)\ngc_data = gc_data.iloc[:20,:]\n\n# plot the top ten genres\nplt.figure(figsize=(18,10))\nplot = sns.barplot(x=gc_data.genre, y=gc_data.abs_freq)\nplt.title(\"Top 20 most reviewed heavy metal subgenres\")\nplt.xlabel(\"Heavy metal subgenres\")\nplt.ylabel(\"Number of reviews\")\nt = plt.xticks(rotation=90)\n","775a3d3c":"genre_corr = data.loc[:, gc_data.genre.tolist()].corr()\nplt.figure(figsize=(16,12))\nplot = sns.heatmap(data=genre_corr)","f4b5a308":"print('There are ',len(data[data.RATING == '-']),' reviews with missing rating. We will exclude them from the dataset.')","7dcab20a":"data = data[data.RATING != '-']\ndata.RATING = data.RATING.astype(int)","01f9250d":"grade_counts = [len(data[data.RATING == grade]) for grade in grades]\nplt.figure(figsize=(14,10))\nplot = sns.barplot(x=grades,y=grade_counts)\na = plt.title(\"Distribution of grades\")\na = plt.xlabel(\"Grades\")\na = plt.ylabel(\"Absolute frequency\")\n","820d63c0":"print('The median is ',data.RATING.median())\nprint('The mean is ', data.RATING.mean())\nprint('The skew is ',data.RATING.skew())","9d0816ab":"stat, p_value = normaltest(data.RATING)\n\nif p_value < 0.05:\n    print(\"We reject the null-hypothesis with p_value \", p_value)\nelse:\n    print(\"We confirm the null_hypothesis with p_value \", p_value)","02381a4b":"# returns the favourite genre of an author aut\ndef favourite(aut):\n    rev = data.loc[data.AUTHOR == aut]\n    genre_abs = pd.DataFrame({\"genre\": genres, \"counts\" : [rev.loc[:,g].sum() for g in genres]})\n    return genre_abs.genre[genre_abs.counts.idxmax()]\n","3446f6b9":"favourite_genres = pd.DataFrame({\"author\" : authors, \"favourite_genre\" : [favourite(aut) for aut in authors]})\nfavourite_genres","143f7fe1":"favourite_ratings = pd.Series([])\nnon_favourite_ratings = pd.Series([])\nfor aut in authors:\n    fav_gen = favourite(aut)\n    favourite_ratings = favourite_ratings.append(data[(data.loc[:,fav_gen] == 1) & (data.loc[:,\"AUTHOR\"] == aut)].RATING)\n    non_favourite_ratings = non_favourite_ratings.append(data[(data.loc[:,fav_gen] != 1) & (data.loc[:,\"AUTHOR\"] == aut)].RATING)\n    \nprint('number of \"favourite reviews\": ',len(favourite_ratings))\nprint('number of \"non-favourite reviews\": ',len(non_favourite_ratings))\n\nfav_cnts = pd.Series([sum(favourite_ratings == i) for i in range(11)])\nnon_fav_cnts = pd.Series([sum(non_favourite_ratings == i) for i in range(11)])\n\nplt.figure(figsize=(14,10))\na = sns.distplot(favourite_ratings, bins=[0,1,2,3,4,5,6,7,8,9,10,11], hist=True, kde=False, norm_hist=True, label=\"favourite\")\na = sns.distplot(non_favourite_ratings, bins=[0,1,2,3,4,5,6,7,8,9,10,11], hist=True, kde=False, norm_hist=True, label=\"non-favourite\")\nplt.title(\"relative frequency of ratings when reviewing favourite vs. non-favourite genres\")\na = plt.legend()","8aa5d9c8":"stat, p_value = mannwhitneyu(non_favourite_ratings,favourite_ratings, alternative=\"less\")\n\nif p_value < 0.05:\n    print(\"We reject the null-hypothesis with p_value \",p_value)\nelse:\n    print(\"We confirm the null-hypothesis with p_value \", p_value)\n","18856047":"Aaaaand here's our first unanticipated result: **Black metal** has by far gotten the most reviews. Followed by genres which you would \nmore probably have expected to find among the first few places. What's the cause of this? Since I didn't mine all the reviews but just the reviews\nwritten by a subset of reviewers we might have oversampled reviews of black metal lovers. ","074f358a":"## Is a reviewer more likely to give good grades to albums in his favourite subgenre?\n\nThis is an interesting question. Let's say you like metal in general but if you had to choose one single favourite genre, there would be no doubt about it - \n*Majestic voices singing about glory and death on the battlefield, drums like the thundering charge of the cavalry, intertwined guitar and \nkeyboard solos like bolts of fire and ice from a wizard's wand* - If you had to choose **one** genre it would be **power metal** and\nyou can name the \n3 first albums of every halfway popular power metal band of the last 20 years. \n\nNow, years later, you are a free editor of big heavy metal webzine and\nsomeone asks you to review a power metal cd. Are you more likely to give that cd a good grade because you generally like power metal bands better than\nother metal bands? Or are you more likely to give a new power metal cd a lower grade because most new releases just sound cheap to you compared to the \nmany stellar power metal releases of your old heroes? \n\n#### Let's find out!\n\nFirst of all we have to think about how to determine every reviewers *favourite* subgenre. We will keep it simple and assume that every editor \ncan choose which cds to review. So, an editors favourite genre will most likely be the one where he has written the most reviews in. ","2f1f1883":"Let's have a look at the data first:","acd62e07":"Columns correspond to heavy metal subgenres, the reviewer and the grade given by the reviewer.\nA value of 1 in a column corresponding to a music genre denotes that the reviewer categorized the album under that subgenre. A single album can belong to more than one subgenre.","b9067a67":"So as one might have suspected, a reviewer is more likely to give good ratings to albums in his favourite genre. \n\nThis concludes my first glimpse into the data of heavy metal music reviews and as I'm writing this there are many more \nideas coming to my mind, what one could do with such data. If you made it this far I hope you had as much fun reading this\nanalysis as I had in writing it. Thank you for reading and please let me know what you think in the comments.\n\n## Up the Irons! ","74c69feb":"Every review is written by one of 12 authors (denoted by letters A-L).","fce45f4e":"What immediately catches our eye are the two bright spots close to the center (everything is symmetric so there is actually only one spot).\nHere we see a strong correlation between **melodic metal** and **power metal**. Makes sense! I have a hard time thinking of a non-melodic \npower metal band. I don't think that the melodic metal genre is as well-defined as the power metal genre, but I can imagine that a reviewer\nof a power metal album would often choose melodic metal as a second category when looking for another genre label.\n\nOther interesting (and expected) correlations are \n* hard rock and classic rock\n* nwobhm and heavy metal\n* doom metal and sludge\n* power metal and heavy metal\n* modern metal and metalcore\n* metalcore and melodic death metal \n\nWhat I find remarkable is that **doom metal** looks to be correlated more strongly with **black metal** and **sludge** than with melodic \nstyles of metal like **heavy metal**. Usually doom metal itself falls roughly into the two categories of traditional and melodic doom \nmetal bands like Black Sabbath, Candlemass or Witchfinder General or modern and non-melodic bands closer to black metal. The overall high amount\nof black metal reviews leads me to conclude that doom cds were for the most part coming from the second family of doom bands. Maybe, looking at a \nsubset of more traditionally oriented reviewers could have yielded different correlations.","af907f7c":"The distribution is centered around the grade 7 with a longer left than right tail. It certainly doesn't look like a normal distribution to me. \nLet's try to confirm our hypothesis with a D'Agostino and Pearson normality test (The null-hypothesis is that our collected data comes from a normally distributed\nvariable).","f0197273":"## Structure of the data:","622078e1":"The distributions look somewhat similar but we can clearly see that ratings between 3 and 6 occur more frequently for non-favourite reviews. Conversely, ratings \nbetween 7 and 9 occur more frequently for favourite reviews. Let's check if there really is a higher probability of giving an album in your favourite genre a good grade \nthan an album in your non-favourite genres. For this we use a Mann-Whitney U test. Even though the sample size is fairly large I don't think it is justified to use\na traditional **t-test** for two reasons:\n1. The probability distribution isn't very normal (as seen above)\n2. We can't really be sure if our grading data is proper interval data\n\nThe good thing about **Mann-Whitney U** is that it doesn't assume normality of your data and works well with ordinal data. The null-hypothesis is that there is no difference\nin probability of giving good grades, whether an album belongs to your favourite or non-favourite genres. The alternative is that reviews in your non-favourite genres are\nless likely to get good grades.","cff6d605":"## Let's take a look at the distribution of ratings:\n\nFirst we have to take care of missing rating values. ","5f90a081":"# Music reviews and heavy metal subgenres\n\nMy dear fellow metalheads and music enthusiasts,\n\nI've spent the weekend web mining a popular heavy metal webzine to gather some data on the world's best music genre. \nThe dataset consists of roughly 3000 reviews of album releases of international (popular and underground) heavy metal \nbands. Each row in the dataset represents one album review. The columns contain information on the reviewer, the rating \ngiven by the reviewer and the music subgenres the album falls into. \n\n### Let's do some EDA (recommended listening: Iron Maiden - The Trooper)\n\n![](https:\/\/store.playstation.com\/store\/api\/chihiro\/00_09_000\/container\/CH\/de\/999\/EP4067-NPEB01320_00-AVPOPULUSM003114\/1550731490000\/image?w=240&h=240&bg_color=000000&opacity=100&_version=00_09_000)\n","8d63b5e3":"Let's think of the set of reviews as the disjoint union of \"favourite reviews\" and \"non-favourite reviews\". A \"favourite review\" is a review of an album that\nthe reviewer categorized under his favourite subgenre. A \"non-favourite review\" is a review of an album that is categorized under different subgenres. For example \nevery review of author \"A\" of an album with label \"modern_metal\" (among other genres) is considered a favourite review.\n\nNow, let's plot the distributions of favourite and non-favourite reviews:","634e7cd4":"   ## What are the top 20 most reviewed music genres?","59d56238":"## Can we see correlation of genres in the data?\n\nAs a longtime metalhead you develop a working knowledge of which metal subgenres are closely related to each other (i.e. overlap) and which genres \nare further apart. There is a very rough 2-part distinction between genres in which singers actually \"sing\" in a traditional\nway (like power metal, hard rock, etc.) and genres with growled or screamed vocals (e.g. death metal, black metal, etc.). \nLet's look at a heatmap of the correlations between genres and see if we can rediscover some familiar connections. ","0f3db4c5":"Let's plot the distribution of grades given by the reviewers."}}