{"cell_type":{"39e37b37":"code","439d8ec6":"code","3ed02f8e":"code","f2fea9ab":"code","bdf3b990":"code","bfde89a8":"code","33d55969":"code","3d6a011f":"code","a16a6652":"code","c5618259":"code","d354ff85":"code","d6f9855d":"code","aec60c25":"code","20065897":"code","0546c639":"code","0eb75818":"code","e44e1d29":"code","2e763b66":"code","6c8cb122":"code","0e0f9842":"code","2b82bd66":"code","2fb3e508":"code","9f8322ae":"code","bbd36569":"code","f74222f4":"markdown","7f02e2bc":"markdown","08813488":"markdown","1ee24e76":"markdown","a3d3a1d6":"markdown","6e53e65a":"markdown","d4ab220a":"markdown","3e92fa73":"markdown","a56fc908":"markdown","cde57322":"markdown","58238051":"markdown","993e48ec":"markdown","d5e3d63e":"markdown","46040629":"markdown","1f0e9b88":"markdown","841b3585":"markdown","778ea9b6":"markdown","037e47f1":"markdown","4ea3f112":"markdown","3d027d78":"markdown","65bf1e2f":"markdown","d6d825b5":"markdown","eb215bbd":"markdown"},"source":{"39e37b37":"from IPython.display import YouTubeVideo\nYouTubeVideo('PLcE3AI9wwE', width=800, height=300)","439d8ec6":"# Data Manipulation Libraries\nimport numpy as np\nimport pandas as pd\n\n# Plotting Libraries\nimport plotly.express as px\nfrom iso3166 import countries\nfrom statsmodels.tsa.arima_model import ARIMA\nimport matplotlib\nimport matplotlib.pyplot as plt\nfrom datetime import datetime, timedelta\nfrom collections import OrderedDict\nfrom statsmodels.tsa.seasonal import seasonal_decompose","3ed02f8e":"df = pd.read_csv('\/kaggle\/input\/all-space-missions-from-1957\/Space_Corrected.csv')\n\ndf.columns = ['Unnamed: 0', 'Unnamed: 0.1', 'Company Name', 'Location', 'Datum', 'Detail', 'Status Rocket', 'Rocket', 'Status Mission']\ndf = df.drop(['Unnamed: 0', 'Unnamed: 0.1'], axis=1)\n\ndf.head()","f2fea9ab":"df.info()","bdf3b990":"# Calculating\npercent_missing = df.isnull().sum() * 100 \/ len(df)\nmissing_value_df = pd.DataFrame({'column': df.columns,\n                                 'percent': percent_missing})\nmissing_value_df.sort_values('percent', inplace=True)\nmissing_value_df.reset_index(drop=True, inplace=True)\nmissing_value_df = missing_value_df[missing_value_df['percent']>0]\n\n# Plotting\nfig = px.bar(\n    missing_value_df, \n    x='percent', \n    y=\"column\", \n    orientation='h', \n    title='Columns with Missing Values', \n    height=200, \n    width=600\n)\nfig.show()","bfde89a8":"ds = df['Company Name'].value_counts().reset_index()\nds.columns = ['company', 'number of starts']\nds = ds.sort_values(['number of starts'],  ascending=False)\nfig = px.bar(ds, x=\"company\", y='number of starts', \n    \n    color=\"number of starts\",\n    orientation='v', \n    title='Number of Launches by Company'\n)\nfig.update_layout(title_x=0.5, xaxis_title = 'Companies', yaxis_title = 'Number of Starts')\nfig.update_xaxes(tickangle=60)\nfig.show()","33d55969":"\nds = df['Status Mission'].value_counts().reset_index()\nds.columns = ['mission_status', 'count']\n\n\n\nfig = px.pie(\n    ds, \n    values='count', \n    names=\"mission_status\", \n    title='Success and Failure of the Rocket Missions', \n    width=500, \n    height=500,\n    hole = 0.4\n)\n\nfig.update_layout( title_x = 0.5)\nfig.show()\n\n\n\nfig = px.bar(\n    ds, \n    x='mission_status', \n    y=\"count\",\n    color = \"count\",\n    orientation='v',  \n    width=500\n)\nfig.update_layout(title = 'Mission Status Distribution', title_x=0.5, \n                  xaxis_title = 'Success or Failure', \n                  yaxis_title = 'Number of Starts')\nfig.update_xaxes(tickangle=30)\nfig.show()","3d6a011f":"ds = df['Status Rocket'].value_counts().reset_index()\nds.columns = ['status', 'count']\nfig = px.pie(\n    ds, \n    values='count', \n    names=\"status\", \n    title='Rocket status', \n    width=500, \n    height=500,\n    hole = 0.5\n)\nfig.show()","a16a6652":"df['Rocket'] = df['Rocket'].fillna(0.0).str.replace(',', '')\ndf['Rocket'] = df['Rocket'].astype(np.float64).fillna(0.0)\ndf['Rocket'] = df['Rocket'] * 1000000\n\ndf.loc[df['Rocket']>4000000000, 'Rocket'] = 0.0\nfig = px.histogram(\n    df, \n    \"Rocket\", \n    nbins=50, \n    width=700, \n    height=500\n)\nfig.update_layout(    title='Rocket Value Distribution', title_x=0.5, \n                  xaxis_title = 'Value of Rockets', \n                  yaxis_title = 'Counts')\nfig.show()\n","c5618259":"df['country'] = df['Location'].str.split(', ').str[-1]\n\ncountries_dict = {\n    'Russia' : 'Russian Federation',\n    'New Mexico' : 'USA',\n    \"Yellow Sea\": 'China',\n    \"Shahrud Missile Test Site\": \"Iran\",\n    \"Pacific Missile Range Facility\": 'USA',\n    \"Barents Sea\": 'Russian Federation',\n    \"Gran Canaria\": 'USA'\n}\n\ndf['country'] = df['country'].replace(countries_dict)","d354ff85":"sun = df.groupby(['country', 'Company Name', 'Status Mission'])['Datum'].count().reset_index()\nsun.columns = ['country', 'company', 'status', 'count']\nfig = px.sunburst(\n    sun, \n    path=[\n        'country', \n        'company', \n        'status'\n    ], \n    values='count', \n    title='Success of all countries at a glance',\n    width=600,\n    height=600\n)\nfig.update_layout(title_x = 0.5)\nfig.show()","d6f9855d":"country_dict = {}\nfor c in countries:\n    country_dict[c.name] = c.alpha3\n    \ndf['alpha3'] = df['country']\ndf = df.replace({\"alpha3\": country_dict})\n\n# Handling two exceptions. \ndf.loc[df['country'] == \"North Korea\", 'alpha3'] = \"PRK\"\ndf.loc[df['country'] == \"South Korea\", 'alpha3'] = \"KOR\"\n\n\n\n# Country Plotting Utility Function\ndef plot_map(dataframe, target_column, title, width=800, height=600):\n    mapdf = dataframe.groupby(['country', 'alpha3'])[target_column].count().reset_index()\n    fig = px.choropleth(\n        mapdf, \n        locations=\"alpha3\", \n        hover_name=\"country\", \n        color=target_column, \n        projection=\"natural earth\", \n        title=title\n    )\n    fig.update_layout(title = title, title_x = 0.5)\n    fig.show()","aec60c25":"plot_map(df, 'Status Mission', 'Number of starts per country')","20065897":"fail_df = df[df['Status Mission'] == 'Failure']\nplot_map(fail_df, 'Status Mission', 'Number of Fails per country')","0546c639":"# Data Preparation \nsuccess_ratio = df.groupby(['country', 'Status Mission']).count()['Datum'].unstack().fillna(0).reset_index().copy()\ntotal_attempts = success_ratio.iloc[:, 1:6].values.sum(axis = 1)\nsuccess_ratio['ratio'] = success_ratio['Success'] \/ total_attempts \nsuccess_ratio.sort_values(['ratio'], ascending = False, inplace =True)\n\n# Plotting\nfig = px.bar(success_ratio, x=\"country\", y='ratio',  color=\"ratio\",\n    orientation='v', \n    title='Ratio of Success for the Countries', \n    color_continuous_scale=px.colors.sequential.Viridis_r\n)\nfig.update_layout(title_x=0.5, xaxis_title = 'Countries', yaxis_title = 'Percentage of Success')\nfig.update_xaxes(tickangle=60)\nfig.show()","0eb75818":"df[df['country'] == 'Kenya']","e44e1d29":"data = df.groupby(['country'])['Rocket'].sum().reset_index()\ndata = data[data['Rocket'] > 0]\n\ndata.columns = ['country', 'money']\ndata.sort_values(['money'], ascending = False, inplace = True)\nfig = px.bar(\n    data, \n    x='country', \n    y=\"money\",\n    color = \"money\", \n    orientation='v',  \n    color_continuous_scale=px.colors.sequential.Viridis_r\n)\nfig.update_layout(title='Country-wise Expenditure',title_x=0.5, xaxis_title = 'Countries', yaxis_title = 'Total Money Spent')\nfig.update_xaxes(tickangle=30)\nfig.show()","2e763b66":"# Calculation\nmoney = df.groupby(['country'])['Rocket'].sum()\nstarts = df['country'].value_counts().reset_index()\nstarts.columns = ['country', 'count']\n\nav_money_df = pd.merge(money, starts, on='country')\nav_money_df['avg'] = av_money_df['Rocket'] \/ av_money_df['count']\nav_money_df = av_money_df[av_money_df['avg']>0]\nav_money_df = av_money_df.reset_index()\nav_money_df.sort_values(['avg'], ascending = False, inplace = True)\n\n# Plotting\nfig = px.bar(\n    av_money_df, \n    x='country', \n    y=\"avg\",\n    color = 'avg',\n    orientation='v', \n    color_continuous_scale=px.colors.sequential.Viridis_r\n)\nfig.update_layout(title='Average money per one launch', title_x=0.5, xaxis_title = 'Countries', yaxis_title = 'Money Spent per Mission')\nfig.update_xaxes(tickangle=30)\nfig.show()","6c8cb122":"data = df.groupby(['Company Name'])['Rocket'].sum().reset_index()\ndata = data[data['Rocket'] > 0]\ndata.columns = ['company', 'money']\ndata.sort_values(['money'], ascending = False, inplace = True)\nfig = px.bar(\n    data, \n    x='company', \n    y=\"money\",\n    color = \"money\",\n    orientation='v',\n    color_continuous_scale=px.colors.sequential.Viridis_r)\nfig.update_layout(    title='Total money spent on missions', title_x=0.5, xaxis_title = 'Companies', yaxis_title = 'Money Spent in Total')\nfig.update_xaxes(tickangle=60)\nfig.show()","0e0f9842":"money = df.groupby(['Company Name'])['Rocket'].sum()\nstarts = df['Company Name'].value_counts().reset_index()\nstarts.columns = ['Company Name', 'count']\n\nav_money_df = pd.merge(money, starts, on='Company Name')\nav_money_df['avg'] = av_money_df['Rocket'] \/ av_money_df['count']\nav_money_df = av_money_df[av_money_df['avg']>0]\nav_money_df = av_money_df.reset_index()\nav_money_df.sort_values(['avg'], ascending = False, inplace = True)\n\nfig = px.bar(\n    av_money_df, \n    x='Company Name', \n    y=\"avg\", \n    color = 'avg',\n    orientation='v',\n    color_continuous_scale=px.colors.sequential.Viridis_r\n)\nfig.update_layout(       title='Average money per one launch', title_x=0.5, xaxis_title = 'Companies', yaxis_title = 'Money Spent per Launch')\nfig.update_xaxes(tickangle=60)\nfig.show()","2b82bd66":"df['date'] = pd.to_datetime(df['Datum'])\ndf['year'] = df['date'].apply(lambda datetime: datetime.year)\ndf['month'] = df['date'].apply(lambda datetime: datetime.month)\ndf['weekday'] = df['date'].apply(lambda datetime: datetime.weekday())","2fb3e508":"ds = df.groupby(['Company Name'])['year'].nunique().reset_index()\nds.columns = ['company', 'count']\nds.sort_values(['count'], inplace = True, ascending = False)\nfig = px.bar(\n    ds, \n    x=\"company\", \n    y=\"count\",\n    color = \"count\", \n    color_continuous_scale=px.colors.sequential.Viridis_r\n)\n\nfig.update_layout( title='Most Experienced Companies (years of experience)', title_x=0.5, xaxis_title = 'Companies', yaxis_title = 'Years of Experience')\nfig.update_xaxes(tickangle=60)\nfig.show()","9f8322ae":"res = []\nfor group in df.groupby(['Company Name']):\n    res.append(group[1][['Company Name', 'year']].head(1))\ndata = pd.concat(res)\ndata = data.sort_values('year', ascending = False)\ndata['year'] = 2020 - data['year']\nfig = px.bar(\n    data, \n    x=\"year\", \n    y=\"Company Name\",\n    color = 'year',\n    orientation='h', \n    color_continuous_scale=px.colors.sequential.Viridis_r, height = 1000\n)\nfig.update_layout( title='Years from last mission', title_x=0.5, xaxis_title = 'Years after last mission', yaxis_title = 'Companies Name')\n\nfig.show()","bbd36569":"data","f74222f4":"Let us add split date to include more temporal features. ","7f02e2bc":"### Geographical Location of the Countries Launching\nLet us have a look at the countries on the map with notable work on space shuttle launch. But before we dive into that, we will quickly convert the conuntry names to a standard name to fit it into our plotting library. ","08813488":"<a id=\"3\"><\/a>\n<h2 style='background:#FB5F00; border:0; color:white'><center>3. Company Analysis <center><h2>","1ee24e76":"### Average Money spent in Mission for each Companies","a3d3a1d6":"Now let us have a look at the present condition of the rockets. Some of them are still active and some of them are retired. ","6e53e65a":"### Time Since Last Mission (in years)\nLet's have a look at the time so far from the last launch. Here the companies associated with the highest values have been sitting duck for the longest period of time. ","d4ab220a":"### Number of  Failures for Countries\nNow let us look at the number of failures of each of the countries. ","3e92fa73":"In the above information of the data itself, there are 7 columns and among them only one of the columns `Rocket` has most of the values missing. We will have to deal with that later on. Right now Let's have a look at the percentage of the missing data. ","a56fc908":"Here one interesting thing is that the ratio of success of **Kenya** is 100%. Let's try to find out what caused that. It turns out there is a launch station in Kenya which was previously owned and controlled by USA. However, USA handed the control of that platform to France from 2004. So these are basically the space exploration of the USA. However, for the EDA, they are kept as they are. For more you can have a look at [The San Marco Launch Platform](https:\/\/en.wikipedia.org\/wiki\/Broglio_Space_Center) wikipedia page to understand the conundrum. ","cde57322":"<a id=\"2\"><\/a>\n<h2 style='background:#FB5F00; border:0; color:white'><center>2. Geographic Analysis<center><h2>","58238051":"### Space Expenditure for the Countries","993e48ec":"### Average Money Spent on Each Launch","d5e3d63e":"### Success\/Failure of Countries","46040629":"### Most Experienced Companies","1f0e9b88":"Now let us have a look at the success and failures of these all missions. ","841b3585":"<a id=\"top\"><\/a>\n\n<div class=\"list-group\" id=\"list-tab\" role=\"tablist\">\n<h3 class=\"list-group-item list-group-item-action active\" data-toggle=\"list\" style='background:#FB5F00; border:0' role=\"tab\" aria-controls=\"home\"><center>Table of Contents<\/center><\/h3>\n\n* [1. Dataset Overview](#1)\n* [2. Geographic Analysis](#2)\n* [3. Company Analysis](#3)    \n* [4. Some Interesting Questions](#4)\n* [5. Dynamics Prediction for CASC](#5)\n* [6. USA vs USSR ](#6)\n* [7. Top of Every Year](#7)\n* [8. Time series ](#8)","778ea9b6":"<img src=\"https:\/\/i.ibb.co\/2gXbJgY\/banner.png\" alt=\"Banner\" class=\"center\">","037e47f1":"Let us have a look at the price of the rockets. Some of the values are missing. We set them to zero. In the graph values are shown in Billions. ","4ea3f112":"### Total money spent by companies","3d027d78":"At first we change some names in the `country` column in the dataframe. Then we will perform different operations on them. ","65bf1e2f":"The above chart shows that one column has almost 80% data missing. Maybe we will drop this column at some time for ease of visualization.  \nNow let us have a look at the number of launches each companies did over time. ","d6d825b5":"<a id=\"1\"><\/a>\n<h2 style='background:#FB5F00; border:0; color:white'><center>1. Dataset Overview<center><h2>","eb215bbd":"### Ratio of Success of Countries\nOne of the important factor in space exploration is the success rate. There might be many failed attempts for a country. But success\/total attempts marks all the difference. Let us have a look at success to the number of attempts ratio for all the countries. "}}