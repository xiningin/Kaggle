{"cell_type":{"169fa0c7":"code","4b53d808":"code","609b201c":"code","a2ac1faa":"code","be307b76":"code","f7410c55":"code","5c9407b2":"code","280cd85a":"code","5bb46ad1":"code","fdb0b548":"code","c5a8c3cf":"code","615265d5":"code","f7412648":"code","5c68f1f6":"code","30a33f68":"code","ff63331f":"code","7633aed0":"code","c2fd8a8c":"code","7b903494":"code","0d65bfd6":"code","102ed98f":"code","7f91b9f0":"markdown","6b12e204":"markdown","f8306a6e":"markdown","dc1eda2b":"markdown","28899ea0":"markdown","ba4699e6":"markdown","d7f84378":"markdown"},"source":{"169fa0c7":"import numpy as np \nimport pandas as pd \nimport matplotlib.pyplot as plt\n# las de clustering \nfrom scipy.spatial import distance_matrix\nfrom scipy.cluster.hierarchy import dendrogram, linkage","4b53d808":"datacredit = pd.read_csv(\"..\/input\/ccdata\/CC GENERAL.csv\")\ndatacredit.head()","609b201c":"## let's see the columns with nas\ndatacredit.isna().sum()","a2ac1faa":"## We fill the na's on the dataset with the mean of each columns \nmp_mean = datacredit['MINIMUM_PAYMENTS'].mean()\ndatacredit['MINIMUM_PAYMENTS'].fillna(value = mp_mean, inplace = True)\ndatacredit['CREDIT_LIMIT'].fillna(value = mp_mean, inplace = True)","be307b76":"datacredit.hist(figsize = (15,20));","f7410c55":"# after the imputation \ndatacredit.head()","5c9407b2":"datacredit.drop(\"CUST_ID\", axis = 1, inplace = True)\ndatacredit.head()","280cd85a":"datacredit.describe()","5bb46ad1":"## escalamiento \nfrom sklearn.preprocessing import StandardScaler\n\nescala = StandardScaler()\n\ncopiadata = escala.fit_transform(datacredit)\ndatacopia = pd.DataFrame(copiadata, columns= datacredit.columns)\ndatacopia.head()","fdb0b548":"enlaces = linkage(datacopia, method = \"ward\")\nenlaces","c5a8c3cf":"dendrogram(enlaces);\n\n# se identifican 4 clusters ","615265d5":"## let see minimized dendrogram \nplt.figure(figsize=(25,10))\ndend = dendrogram(enlaces, truncate_mode=\"lastp\", p = 10, show_leaf_counts= True, show_contracted= True) ","f7412648":"## automatic cut of the dendrogram \n\nfrom scipy.cluster.hierarchy import inconsistent","5c68f1f6":"## inconsistent method \n\ndepth = 5\nincons = inconsistent(enlaces, depth)\nincons[-10:]","30a33f68":"## m\u00e9todo del codo \nlast = enlaces[-10:,2]\nlast_rev = last[::-1]\nprint(last_rev)\n\nidx = np.arange(1, len(last)+1)\nplt.plot(idx, last_rev)\n\nacc = np.diff(last,2)\nacc_rev = acc[::-1]\nprint(acc_rev)\nplt.plot(idx[:-2]+1, acc_rev)","ff63331f":"## visualization of cluster \n\nfrom scipy.cluster.hierarchy import fcluster\n\n## Put the tags in the elements \nclusteres = fcluster(enlaces, 4, criterion=\"maxclust\")\ndatacredit['Cluster'] = clusteres\ndatacopia['Cluster'] = clusteres\ndatacredit.head()","7633aed0":"\ndatacopia.boxplot(figsize = (25,25), fontsize = 8, by='Cluster', rot =45, autorange = True );\nplt.ylim(-5, 30)","c2fd8a8c":"datacopia.boxplot(column='PURCHASES', by='Cluster' )\nplt.ylim(-1,30)","7b903494":"datacopia.boxplot(column='ONEOFF_PURCHASES', by='Cluster' )\nplt.ylim(-1,30)","0d65bfd6":"datacopia.boxplot(column='CREDIT_LIMIT', by='Cluster' )\nplt.ylim(-1,30)","102ed98f":"datacopia.boxplot(column='BALANCE', by='Cluster' )\nplt.ylim(-1,20)","7f91b9f0":"## We will see the appropiate number of clusters","6b12e204":"## Model construction","f8306a6e":"## Data Processing","dc1eda2b":"\n# Credit Card Dataset  \n### By: Fabio Pinto","28899ea0":"## Evaluation and conclussions","ba4699e6":"This notebook is an example of using clustering for customer segmentation to define a marketing strategy. This sample dataset that summarizes the usage behavior of about 9000 active credit card holders during the last 6 months.\n\nIt includes the following variables:\n\nCUST_ID: Identification of Credit Card holder\nBALANCE: Balance amount left in their account to make purchases\nBALANCE_FREQUENCY: How frequently the Balance is updated, score between 0 and 1\nPURCHASES: Amount of purchases made from account\nONEOFF_PURCHASES: Maximum purchase amount done in one-go\nINSTALLMENTS_PURCHASES: Amount of purchase done in installment\nCASH_ADVANCE: Cash in advance given by the user\nPURCHASES_FREQUENCY: How frequently the Purchases are being made, score between 0 and 1 (1 = frequently purchased, 0 = not frequently purchased)\nONEOFF_PURCHASES_FREQUENCY: How frequently Purchases are happening in one-go (1 = frequently purchased, 0 = not frequently purchased)\nPURCHASES INSTALLMENTS FREQUENCY: How frequently purchases in installments are being done (1 =\nfrequently done, 0 = not frequently done)\nCASHADVANCE_FREQUENCY: How frequently the cash in advance being paid\nCASHADVANCE_TRX: Number of Transactions made with \"Cash in Advanced\"\nPURCHASES_TRX: Number of purchase transactions made\nCREDIT_LIMIT: Limit of Credit Card for user\nPAYMENTS: Amount of Payment done by user\nMINIMUM_PAYMENTS: Minimum amount of payments made by user\nPRC_FULL_PAYMENT: Percent of full payment paid by user\nTENURE: Tenure of credit card service for user","d7f84378":"# CONCLUSSION\n## IDENTIFIED CLUSTERS \n\n+ CLUSTER 1 - PEOPLE WITH LOW LEVEL OF INCOME. Not Frequent purchases.\n+ CLUSTER 2 - PEOPLE WITH MEDIAN LEVEL O INCOME. High Frequent purchases. \n+ CLUSTER 3 - PEOPLE WITH HIGH LEVEL OF INCOME. Not Frequent purchases and the most high advance level. \n+ CLUSTER 4 - PEOPLE WITH LOW LEVEL OF INCOME. Frequent purchases. "}}