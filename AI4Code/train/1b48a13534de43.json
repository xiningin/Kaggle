{"cell_type":{"c3ef59ed":"code","b686af28":"code","bc5e5ad6":"code","11c0b064":"code","168e9646":"code","d301e92f":"code","4593d503":"code","5e237be1":"code","351a9268":"code","d86b4a52":"code","0eae0be2":"code","e6bbf48a":"code","65353c53":"code","3a046fb3":"code","1a419b4e":"code","45cd4885":"code","d96ba251":"code","60ad0883":"markdown","fdf2778d":"markdown","7459e0aa":"markdown","2401b13b":"markdown","fb555980":"markdown","9786cc61":"markdown","c7163731":"markdown","ffc2cef4":"markdown","6f21bc63":"markdown","5d14acc9":"markdown","33b045ac":"markdown","4bc5b6bd":"markdown","8f4a661e":"markdown","6f6a3387":"markdown","ee13b4e3":"markdown","038c9db4":"markdown","7dc7e7e7":"markdown","04d16967":"markdown","6df36ae8":"markdown"},"source":{"c3ef59ed":"import pandas as pd\nimport seaborn as sns\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.model_selection import train_test_split, GridSearchCV\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.pipeline import make_pipeline\nimport dill","b686af28":"data = pd.read_csv('..\/input\/Admission_Predict_Ver1.1.csv').set_index('Serial No.')\ndata = data.rename(columns={'Chance of Admit ': 'Chance of Admit', 'LOR ': 'LOR'})","bc5e5ad6":"print('The dataset has {} rows.'.format(len(data)))\nprint('The dataset has {} columns'.format(data.columns))","11c0b064":"print(data.info())","168e9646":"print(data.isnull().any())","d301e92f":"sns.heatmap(data.corr(), annot=True)","4593d503":"sns.pairplot(data.drop(columns='Research'))","5e237be1":"X_train, X_test, y_train, y_test = train_test_split(data.drop(columns='Chance of Admit'), data['Chance of Admit'], test_size=0.2)","351a9268":"X_train.describe()","d86b4a52":"dfm = X_train.melt(var_name='columns')\ng = sns.FacetGrid(dfm, col='columns')\ng = (g.map(sns.distplot, 'value'))","0eae0be2":"scaler = StandardScaler().fit(X_train)\nX_train_norm = scaler.transform(X_train)\nX_test_norm = scaler.transform(X_test)\nX_train = pd.DataFrame(X_train_norm, columns=X_train.columns)\nX_test = pd.DataFrame(X_test_norm, columns=X_test.columns)","e6bbf48a":"dfm = X_train.melt(var_name='columns')\ng = sns.FacetGrid(dfm, col='columns')\ng = (g.map(sns.distplot, 'value'))","65353c53":"gridsearch = GridSearchCV(estimator=RandomForestRegressor(),\n                          param_grid={\n                              'n_estimators': [50, 100, 250, 300],\n                              'max_depth': [None, 100, 200, 300, 400]\n                          },\n                          cv=3,\n                          return_train_score=False,\n                          scoring='r2')\ngridsearch.fit(X=X_train, y=y_train)\npd.DataFrame(gridsearch.cv_results_).set_index('rank_test_score').sort_index()","3a046fb3":"pipe = make_pipeline(scaler, gridsearch)","1a419b4e":"print('Original model: ' + str(gridsearch.predict(X=scaler.transform(data.drop(columns='Chance of Admit').iloc[0].values.reshape(1, -1)))[0]))\nprint('Pipeline model: ' + str(pipe.predict(X=data.drop(columns='Chance of Admit').iloc[0].values.reshape(1, -1))[0]))","45cd4885":"with open('rf_v1.pkl', 'wb') as f:\n    dill.dump(pipe, f)","d96ba251":"with open('rf_v1.pkl', 'rb') as f:\n    model = dill.load(f)\n    print(model.predict(X=data.drop(columns='Chance of Admit').iloc[0].values.reshape(1, -1))[0])","60ad0883":"The Chance of Admit strongly correlates with CGPA, GRE Score and TOEFL Score. It has a weaker correlation with University Rating, SOP and LOR. The Research has the least correlation.","fdf2778d":"Let us look at individual features and their properties","7459e0aa":"Splitting the data into training and testing set","2401b13b":"Because Random Forest is \"random\", the results and the inference above might change when this Notebook is run when making the commit.","fb555980":"Creating a Grid Search for Random Forest Regressor","9786cc61":"None of the values have any Null values","c7163731":"The Research feature is a binary value and will not show any significant results in the PairPlot. It can be dropped","ffc2cef4":"We can see that all the values have 0 mean and have a normal distribution. This enables the model to make better predictions.","6f21bc63":"The PairPlot gives a lot of information in one plot. Let us disect it by each feature.\n    1. As GRE Score increases, the TOEFL Scores also increases and even the CGPA Score increases. This means that students who score good GRE Scores also score good TOEFL Scores and have better CGPAs.\n    2. GRE Score has a distribution with a mean near 320 and majority of students score between 310 to 330 which is indicated by the peaks in the graph.\n    3. Students from higher University Rating have higher GRE Scores, TOEFL Scores and CGPA.\n    4. Students have better LOR and SOP rating when they are from higher rated universities.\n    5. We can see a similar trend for relation between GRE Scores, TOEFL Scores, CGPA Scores, LOR Ratings and SOP Ratings. They all increases together, i.e., as students with better SOPs also tend to have better LORs, better GRE, TOEFL and CGPA Scores and are from higher rated universities and they have a higher chance of admit.","5d14acc9":"Import statements","33b045ac":"Reading the Version 1.1 of the dataset\n\nThe Serial No. can be set as the index as it does not have any other purpose\n\nRenaming the columns which had extra white spaces","4bc5b6bd":"Taking a look at the Grid Search results, we can see that the Random Forest Regressor with a maximum depth of 200 and 300 estimators gave the best results. But, when we look more closely, we can see that the regressor with maximum depth as None and number of estimators as 50 give almost the same result (difference is 0.001465) but takes less than half the time to make the predictions. If time is of concern, this model should be picked.","8f4a661e":"The ranges of all the features are very distinct and should be scaled correctly before making any predictions","6f6a3387":"The predictions are the same. We can now export the pipeline.","ee13b4e3":"Testing out the predictions of the pipeline and the model trained above.","038c9db4":"We can see that the model is exported correctly and when imported, gives the same prediction for the same data.","7dc7e7e7":"Creating a pipeline","04d16967":"This pipeline can be used to deploy this model. It contains the complete model which scales the input data and runs it through the Random Forest to get a prediction.","6df36ae8":"Checking the correlation between all the features"}}