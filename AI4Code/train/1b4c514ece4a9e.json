{"cell_type":{"f64eb31b":"code","e72d7c76":"code","fcf58a20":"code","a9d47325":"code","29e7247b":"code","867c4814":"code","fc3d4de1":"code","3b89ea4b":"code","a204e245":"code","e2b0c837":"code","b87c39b4":"code","ce544fd8":"code","c51ffc72":"code","30dcb948":"code","6a1584d7":"markdown","4106d081":"markdown","19f6ed9d":"markdown","7881cfc4":"markdown","a9426c39":"markdown","2571509c":"markdown","4bee79f6":"markdown"},"source":{"f64eb31b":"\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nfrom IPython.display import display, Image\nimport matplotlib.pyplot as plt\nimport cv2\nimport os\nimport glob\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    print(dirname)\n#     for filename in filenames:\n#         print(os.path.join(dirname, filename))\n","e72d7c76":"folders = glob.glob('\/kaggle\/input\/ade20k\/ADE20K_2016_07_26\/images\/training\/*')\nfolders.sort()","fcf58a20":"dict_count = {\"category\":[],\"count\":[]}\nfor folder in folders:\n    \n    sub_folders = glob.glob(folder+'\/*')\n    sub_folders.sort()\n    \n    for sub_folder in sub_folders:\n        if 'misc' not in sub_folder:\n            files = glob.glob(sub_folder+'\/*.jpg')\n            dict_count['category'].append(sub_folder.split('\/')[-1])\n            dict_count['count'].append(len(files))\ndf = pd.DataFrame(dict_count)\ndf = df.sort_values(by=['count'],ascending=False)\ndf.head()","a9d47325":"df = df.replace(0,np.NaN)\ndf = df.dropna()\ndf = df.sort_values(by=['count'],ascending=True)\ndf.head()","29e7247b":"dict_ = df.groupby(['count']).groups\ndict_","867c4814":"!pip install keras-segmentation","fc3d4de1":"def show(img):\n    return(Image(cv2.imencode(\".png\",img)[1].tobytes()))","3b89ea4b":"from keras_segmentation.pretrained import pspnet_50_ADE_20K ","a204e245":"model = pspnet_50_ADE_20K()","e2b0c837":"images = glob.glob('\/kaggle\/input\/ade20k\/ADE20K_2016_07_26\/images\/validation\/b\/bedroom\/*.jpg')\nprint(len(images))","b87c39b4":"test_img = cv2.imread(images[3])\ntest_img = cv2.resize(test_img,(473,473))\nshow(test_img)","ce544fd8":"out = model.predict_segmentation(\n    inp=images[3],\n    out_fname=\"\/kaggle\/output\/out.png\"\n)\n\n# plt.imshow(out)","c51ffc72":"out_img = np.zeros(shape=(473,473,3),dtype=int)\nout_img[:,:,0] = out*20\nout_img[:,:,1] = out*20\nout_img[:,:,2] = out*10\nout_img = np.array(out_img,dtype='i8')\ntest_img = np.array(test_img,dtype='i8')\n# print(test_img.shape,out_img.shape)\n# print(type(test_img),type(out_img))\n# print(test_img.dtype,out_img.dtype)\n# show(cv2.addWeighted(test_img,0.7,out_img,0.5,0))\n# show()\nshow(out_img)","30dcb948":"# show(cv2.addWeighted(test_img,0.7,out_img,0.5,0))","6a1584d7":"# Prediction","4106d081":"# Test Image","19f6ed9d":"# EDA","7881cfc4":"<h3>Instances per Scene<\/h3>","a9426c39":"# Visualize Results","2571509c":"# Load Model","4bee79f6":"# Read Data"}}