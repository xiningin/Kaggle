{"cell_type":{"c0a57c4b":"code","2a51d330":"code","fe43cec7":"code","00ceba5b":"code","974045db":"code","882abcab":"code","536e09c1":"code","df1378f3":"code","9a3bb3b0":"code","a939a3af":"code","855f8464":"markdown","050c2ef2":"markdown","1c8ad5a6":"markdown","00c84517":"markdown","cd2c2d3f":"markdown","976404c4":"markdown","ca55b2fe":"markdown","53edb542":"markdown","d3eff41e":"markdown","b0d03ab3":"markdown","297c6e6b":"markdown","9291a39b":"markdown","876668e4":"markdown","5045c3a5":"markdown"},"source":{"c0a57c4b":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt","2a51d330":"train = pd.read_csv('..\/input\/tabular-playground-series-nov-2021\/train.csv')","fe43cec7":"train.head()","00ceba5b":"# Alleged size of the chunk\nCS = 60000","974045db":"zero_target = train['target'] == 0\ntrain.loc[zero_target, 'target'] = -1","882abcab":"train['target_cumsum'] = train['target'].cumsum()","536e09c1":"plt.plot(train['target_cumsum'])\nfor i in range(10):\n    plt.axvline(60000*i,color = 'lightgray',alpha = 0.3)\nplt.ylabel('Cumulative sum of target')\nplt.xlabel('id');","df1378f3":"# Reverse the 0 to -1 replacement in the target\ntarget_m1 = train['target'] == -1\ntrain.loc[target_m1, 'target'] = 0\n\nfor i in range(10):\n    chunk = train['target'][i*CS:(i+1)*CS]\n    print(f'Mean in chunk {i} is {np.mean(chunk):.2f}')","9a3bb3b0":"m = np.zeros(10)\ns = np.zeros(10)\nfor i in range(10):\n    print(f'Chunk {i}')\n\n    m[i] = np.mean(train['f27'][i*CS:(i+1)*CS])\n    s[i] = np.std(train['f27'][i*CS:(i+1)*CS])\n    \n    print(f'   Mean {m[i]:.4f}')\n    print(f'   Std  {s[i]:.4f}')","a939a3af":"plt.hist(train['f27'][:CS], bins = np.arange(-0.2, 0.3, 0.01));\nplt.hist(train['f27'][9*CS:], bins = np.arange(-0.2, 0.3, 0.01), alpha = 0.2);","855f8464":"Wow, large differences!","050c2ef2":"The differences between chunks are clearly visible","1c8ad5a6":"# Import the data","00c84517":"# Cumulative sum of target differs between chunks?","cd2c2d3f":"As suggested by @grayjay in the comments, it is easier to see the difference if we replace \ntarget zero with target -1","976404c4":"This is the variable we should be looking at","ca55b2fe":"# Introduction","53edb542":"So the standard deviation in the last chunk is indeed much smaller.","d3eff41e":"Allegedly there are feature differences between the chunks, namely f27. Let's take a look at mean and std within the chunks","b0d03ab3":"So indeed, the training data has been chunked in groups of 60k","297c6e6b":"Mean target in the individual chunks:","9291a39b":"# Difference in the features","876668e4":"The feature histogram in the first and last chunk are clearly different:","5045c3a5":"As found out by [@grayjay](https:\/\/www.kaggle.com\/grayjay) [here](https:\/\/www.kaggle.com\/c\/tabular-playground-series-nov-2021\/discussion\/286731), the train data appears to be in ten chunks with different average target value and differently distributed features. Here we check these statements with a few plots."}}