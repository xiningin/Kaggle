{"cell_type":{"0025119b":"code","7e21aecc":"code","30739233":"code","418a535d":"code","5ea5aec2":"code","9e4ac9ff":"code","ed6f3261":"code","4c060943":"code","f966a455":"code","ba321a3f":"code","d25e44fe":"code","9171fd22":"code","d031d4f4":"code","03ea511b":"code","0db9ace0":"code","d3271154":"code","c8648ace":"code","cdc91480":"code","ac9424bc":"code","ad5406b1":"code","4819b332":"code","e48cf906":"code","1295d831":"markdown","49397ce5":"markdown","790b24dd":"markdown","ec74254c":"markdown","44866ebe":"markdown","440b904f":"markdown","d56a329a":"markdown","dc0a9824":"markdown","76bb1ca8":"markdown","6bfab6b2":"markdown","004d001d":"markdown","5be45a2f":"markdown","8de731b9":"markdown","060f427a":"markdown"},"source":{"0025119b":"# Making Firefox directory to save the \"firefox-63.0.3.tar.bz2\" in the directory\n!mkdir \"..\/working\/firefox\"\n!ls -l \"..\/working\"\n!cp -a \"..\/input\/firefox-63.0.3.tar.bz2\/firefox\/.\" \"..\/working\/firefox\"\n!chmod -R 777 \"..\/working\/firefox\"\n\n# After that installed the webdriverdownloader of V0.23.0\n!pip install webdriverdownloader\nfrom webdriverdownloader import GeckoDriverDownloader\ngdd = GeckoDriverDownloader()\ngdd.download_and_install(\"v0.23.0\")\n\n# Install selenium\n!pip install selenium\n!apt-get install -y libgtk-3-0 libdbus-glib-1-2 xvfb\n!export DISPLAY=:99","7e21aecc":"# Import libraries and modules\nimport pandas as pd\nimport seaborn as sns\n\n# Import Beautiful soup\nfrom bs4 import BeautifulSoup\nimport requests\n\n# Import Selenium\nfrom selenium import webdriver\nfrom selenium.webdriver.common.by import By\nfrom selenium.webdriver.support.select import Select\nfrom selenium.webdriver.firefox.options import Options as opt\nfrom selenium.webdriver.common.desired_capabilities import DesiredCapabilities as dc\nfrom selenium import webdriver as selenium_webdriver\nbrowser_options = opt()\n\n# Browser details\nbrowser_options.add_argument(\"--headless\")\nbrowser_options.add_argument(\"--window-size=1920,1080\")\n\ncapabilities_argument = dc().FIREFOX\ncapabilities_argument[\"marionette\"] = True\n\nbrowser = selenium_webdriver.Firefox(options=browser_options,\n                                     firefox_binary=\"..\/working\/firefox\/firefox\",\n                                     capabilities=capabilities_argument)","30739233":"# Get the url data\nbrowser.get('https:\/\/www.bseindia.com\/corporates\/corporates_act.html')","418a535d":"# From Date calendar selection\nfrom_date_selection = browser.find_element_by_xpath('\/html\/body\/div[4]\/div[2]\/div[2]\/input')\nfrom_date_selection.click()\n\n# From Date calendar month selection list box\nfrom_month = browser.find_element_by_xpath('\/html\/body\/div[8]\/div\/div\/select[1]')\nselected_from_month = Select(from_month)\nselected_from_month.select_by_visible_text(\"Feb\")\n\n# From Date calendar month selection list box\nfrom_year = browser.find_element_by_xpath('\/html\/body\/div[8]\/div\/div\/select[2]')\nselected_from_year = Select(from_year)\nselected_from_year.select_by_visible_text(\"2020\")\n\n# From Date calendar date selection \nfrom_date = browser.find_element_by_xpath(\"\/\/td[not(contains(@class,'ui-datepicker-month'))]\/a[text()='5']\")\nfrom_date.click()\n\n# Selected value on From Date selection\nfrom_date_selection.get_attribute('value')","5ea5aec2":"# To Date calendar selection\nto_date_selection = browser.find_element_by_xpath('\/html\/body\/div[4]\/div[2]\/div[4]\/input')\nto_date_selection.click()\n\n# From Date calendar month selection list box\nto_month = browser.find_element_by_xpath('\/html\/body\/div[8]\/div\/div\/select[1]')\nselected_to_month = Select(to_month)\nselected_to_month.select_by_visible_text(\"Feb\")\n\n# From Date calendar month selection list box\nto_year = browser.find_element_by_xpath('\/html\/body\/div[8]\/div\/div\/select[2]')\nselected_to_year = Select(to_year)\nselected_to_year.select_by_visible_text(\"2020\")\n\n# From Date calendar date selection \nto_date = browser.find_element_by_xpath(\"\/\/td[not(contains(@class,'ui-datepicker-month'))]\/a[text()='5']\")\nto_date.click()\n\n# Selected value on From Date selection\nto_date_selection.get_attribute('value')","9e4ac9ff":"# Select Date selection list box to select \"Ex Date\"\nselect_date = browser.find_element_by_xpath('\/html\/body\/div[4]\/div[1]\/div[4]\/select')\nprefered_select_date = Select(select_date)\nprefered_select_date.select_by_visible_text(\"Ex Date\")\n\n# Display Value\nselect_date.get_attribute('value')","ed6f3261":"# Segment selection list box to select \"Equity\"\nselect_segment = browser.find_element_by_xpath('\/html\/body\/div[4]\/div[1]\/div[2]\/select')\nprefered_segment = Select(select_segment)\nprefered_segment.select_by_visible_text(\"Equity\")\n\n# Display Value\nselect_segment.get_attribute('value')","4c060943":"# After selection, Click submit button to select the prefered content in table\nbrowser.find_element_by_xpath('\/\/input[@id=\"btnSubmit\"]').click()","f966a455":"# Count the row and column of table\nrows = len(browser.find_elements_by_xpath(\"\/\/table[@class='mGrid ng-scope']\/tbody\/tr\"))\ncolumns = len(browser.find_elements_by_xpath(\"\/\/table[@class='mGrid ng-scope']\/tbody\/tr\/th\"))\nprint(f'Table contains {rows} rows and {columns} columns including header')","ba321a3f":"# Fetch the column header for dataframe from table\ncol_names = []\nr = 1\nfor c in range(1,columns+1):\n    col_names.append(browser.find_element_by_xpath('\/html\/body\/div[5]\/div\/div\/div\/table[1]\/tbody\/tr\/td\/div\/table\/tbody\/tr['+str(r)+']\/th['+str(c)+']').text)","d25e44fe":"# Prepare dataframe with extracted column names\ndf_ws = pd.DataFrame(columns=col_names)","9171fd22":"# Extract row and column content from table and include in dataframe\nfor r in range(2,rows+1):\n    content=[]\n    for c in range(1,columns+1):\n        content.append(browser.find_element_by_xpath('\/html\/body\/div[5]\/div\/div\/div\/table[1]\/tbody\/tr\/td\/div\/table\/tbody\/tr['+str(r)+']\/td['+str(c)+']').text)\n    df_ws.loc[r] = content\ndf_ws.reset_index(inplace=True,drop=True)","d031d4f4":"# Visualise Dataframe\ndf_ws","03ea511b":"header={'authority': 'www.bseindia.com','method': 'GET','path': '\/corporates\/corporates_act.html',\n        'accept-encoding': 'gzip, deflate, br', \n        'user-agent': 'Mozilla\/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit\/537.36 (KHTML, like Gecko) Chrome\/93.0.4577.82 Safari\/537.36'}\n\nimport urllib3\nimport regex as re\n\nhttp = urllib3.PoolManager()\n\ndata = http.request('GET', \"https:\/\/api.bseindia.com\/BseIndiaAPI\/api\/DefaultData\/w?Fdate=20200205&Purposecode=&TDate=20200205&ddlcategorys=E&ddlindustrys=&scripcode=&segment=0&strSearch=S.html\",headers=header,).data","0db9ace0":"# Decode the binary data to \"UTF-8\"\ntable_data = re.findall('\\{.*?\\}',data.decode('utf8').replace(\"'\", '\"'))","d3271154":"df_wos = pd.DataFrame(columns=list(eval(table_data[0]).keys()))\nfor i,d in enumerate(table_data):\n    df_wos.loc[i] = list(eval(d).values())","c8648ace":"df_wos.columns","cdc91480":"df_ws.columns","ac9424bc":"col_dict = {'scrip_code':'Security Code',\n            'long_name':'Security Name',\n            'Ex_date':'Ex Date',\n            'RD_Date':'Record Date',\n            'BCRD_FROM':'BC Start Date',\n            'BCRD_TO':'BC End Date',\n            'ND_START_DATE':'ND Start Date',\n            'ND_END_DATE':'ND End Date',\n            'payment_date':'Actual Payment Date'\n            \n}","ad5406b1":"df_wos.rename(columns=col_dict,inplace=True)\ndf_wos = df_wos[col_names]","4819b332":"# Visualise Dataframe\ndf_wos","e48cf906":"df_ws.to_csv('Corporate_Extract_Selenium.csv')\ndf_wos.to_csv('Corporate_Extract_urllib.csv')","1295d831":"### From Date Selection","49397ce5":"## Scrap Webpage using Selenium","790b24dd":"### Scrap the selected data from table","ec74254c":"### Click Submit button","44866ebe":"### Prefer Equity selection from \"Segment\" dropdown","440b904f":"### Prefer Ex Date selection from \"Select Date\" dropdown","d56a329a":"### Update Column names","dc0a9824":"### To Date Selection","76bb1ca8":"## Scrap data from webpage using urllib3","6bfab6b2":"## Save Dataframe","004d001d":"### Extract Data and prepare dataframe","5be45a2f":"## Library Import","8de731b9":"## Basic Setup to scrap BSE webpage","060f427a":"### Extract column names and prepare Dataframe"}}