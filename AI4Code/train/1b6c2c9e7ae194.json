{"cell_type":{"d75978e5":"code","27d0fd29":"code","5fa59583":"code","50e93333":"code","6e1ec0c8":"code","9baec874":"code","6c69658f":"code","ace9a66f":"code","651c5abd":"code","0a4a8cdf":"code","22573559":"code","b8391101":"code","fa7006b6":"code","1b66c04d":"code","a014240a":"code","b8d0bc69":"code","7b8884a7":"code","4766723e":"code","696428d2":"code","4ec97e60":"code","60ca9223":"code","51073034":"code","5ebc6eb9":"code","a37654ee":"code","1d874853":"code","598f4121":"code","60c11a31":"code","56e419bf":"code","9093fb16":"code","ad393dd9":"code","614868fc":"markdown","0ac944e7":"markdown","78312bb0":"markdown","677f575c":"markdown","8cf05411":"markdown","4b3c1e24":"markdown","a0c2af1c":"markdown","cdf0e293":"markdown","cc573a54":"markdown","ea6f6543":"markdown","2257e5b2":"markdown","9cbc1f21":"markdown","1e3bb49d":"markdown","7088ef22":"markdown","d58d7540":"markdown","edc5d663":"markdown","7eb43c8d":"markdown","ec604173":"markdown","26191674":"markdown","d6759dc9":"markdown","d7e577c3":"markdown"},"source":{"d75978e5":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","27d0fd29":"df=pd.read_csv(\"..\/input\/mushroom-classification\/mushrooms.csv\")","5fa59583":"df.head()","50e93333":"df.dtypes","6e1ec0c8":"df[\"class\"].replace([\"p\",\"e\"],[1,0],inplace=True)","9baec874":"df.head()","6c69658f":"df.shape","ace9a66f":"df.isnull().sum()","651c5abd":"sns.countplot(\"class\",data=df)","0a4a8cdf":"for i in [ 'cap-shape', 'cap-surface', 'cap-color', 'bruises', 'odor',\n       'gill-attachment', 'gill-spacing', 'gill-size', 'gill-color',\n       'stalk-shape', 'stalk-root', 'stalk-surface-above-ring',\n       'stalk-surface-below-ring', 'stalk-color-above-ring',\n       'stalk-color-below-ring', 'veil-type', 'veil-color', 'ring-number',\n       'ring-type', 'spore-print-color', 'population', 'habitat']:\n    \n    plt.subplots()\n    sns.countplot(x=i,hue=\"class\",data=df,order = df[i].value_counts().index,palette=['green',\"red\"])\n    plt.legend()\n    plt.show()","22573559":"plt.figure()\nsns.countplot(x=\"class\",data=df)\nplt.figure()\nsns.countplot(x=\"veil-type\",hue=\"class\",data=df,order = df[\"veil-type\"].value_counts().index,palette=['green',\"red\"])\nplt.legend()\nplt.show()","b8391101":"df.drop([\"veil-type\"],axis=1,inplace=True)","fa7006b6":"plt.figure()\nsns.countplot(x=\"class\",data=df)\nplt.figure()\nsns.countplot(x=\"gill-attachment\",hue=\"class\",data=df,order = df[\"gill-attachment\"].value_counts().index,palette=['green',\"red\"])\nplt.legend()\nplt.show()","1b66c04d":"df.drop([\"gill-attachment\"],axis=1,inplace=True)","a014240a":"plt.figure()\nsns.countplot(x=\"odor\",hue=\"class\",data=df,order = df[\"odor\"].value_counts().index,palette=['green',\"red\"])\nplt.legend()\nplt.show()","b8d0bc69":"df.drop([\"odor\"],axis=1,inplace=True)","7b8884a7":"df.columns","4766723e":"x=pd.get_dummies(df,columns=['cap-shape', 'cap-surface', 'cap-color', 'bruises',\n       'gill-spacing', 'gill-size', 'gill-color', 'stalk-shape', 'stalk-root',\n       'stalk-surface-above-ring', 'stalk-surface-below-ring',\n       'stalk-color-above-ring', 'stalk-color-below-ring', 'veil-color',\n       'ring-number', 'ring-type', 'spore-print-color', 'population',\n       'habitat']).drop(\"class\",axis=1)\ny=df[\"class\"]","696428d2":"from sklearn.model_selection import train_test_split\nx_train,x_test,y_train,y_test= train_test_split(x,y,test_size=0.25,random_state=42)","4ec97e60":"from sklearn.preprocessing import MinMaxScaler,StandardScaler,QuantileTransformer\nfrom sklearn.model_selection import GridSearchCV, cross_val_score,StratifiedKFold\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.svm import SVC\nfrom sklearn.ensemble import RandomForestClassifier, VotingClassifier\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.metrics import accuracy_score, recall_score,f1_score\nfrom sklearn.metrics import confusion_matrix","60ca9223":"Confusion_Matrices=[]\nClassifiers=[]\nScores=[]\nBest_Parameters=[]\nCross_Val_Test_Scores=[]\nrandom_state=42","51073034":"dt_param_grid = {\"min_samples_split\" : range(20,400,20),\n                \"max_depth\": range(2,18,2)}\n\n\nclf=GridSearchCV(DecisionTreeClassifier(random_state = random_state),param_grid=dt_param_grid,cv=StratifiedKFold(n_splits = 5),scoring=\"accuracy\")\nclf.fit(x_train,y_train)\nScores.append(clf.best_score_)\nConfusion_Matrices.append(confusion_matrix(y_test, clf.predict(x_test)))\nClassifiers.append(\"Decision Tree\")\nCross_Val_Test_Scores.append(cross_val_score(clf, x_test, y_test,scoring=\"accuracy\", cv=5).mean())\nBest_Parameters.append(clf.best_estimator_)","5ebc6eb9":"svc_param_grid = {\"kernel\" : [\"rbf\"],\n                 \"gamma\": [0.001, 0.01, 0.1, 1],\n                 \"C\": [1,10,50,100,200,1000]}\n\n\n\nclf=GridSearchCV(SVC(random_state = random_state),param_grid=svc_param_grid,cv=StratifiedKFold(n_splits = 5),scoring=\"accuracy\")\nclf.fit(x_train,y_train)\nScores.append(clf.best_score_)\nConfusion_Matrices.append(confusion_matrix(y_test, clf.predict(x_test)))\nClassifiers.append(\"SVC\")\nCross_Val_Test_Scores.append(cross_val_score(clf, x_test, y_test,scoring=\"accuracy\", cv=5).mean())\nBest_Parameters.append(clf.best_estimator_)","a37654ee":"rf_param_grid = {\"max_features\": [1,3,10],\n                \"min_samples_split\":[2,3,10],\n                \"min_samples_leaf\":[1,3,10],\n                \"bootstrap\":[False],\n                \"n_estimators\":[100,300],\n                \"criterion\":[\"gini\"]}\n\n\n\nclf=GridSearchCV(RandomForestClassifier(random_state = random_state),param_grid=rf_param_grid,cv=StratifiedKFold(n_splits = 5),scoring=\"accuracy\")\nclf.fit(x_train,y_train)\nScores.append(clf.best_score_)\nConfusion_Matrices.append(confusion_matrix(y_test, clf.predict(x_test)))\nClassifiers.append(\"Random Forest\")\nCross_Val_Test_Scores.append(cross_val_score(clf, x_test, y_test,scoring=\"accuracy\", cv=5).mean())\nBest_Parameters.append(clf.best_estimator_)","1d874853":"logreg_param_grid = {\"C\":np.logspace(-3,3,7)}\nclf=GridSearchCV(LogisticRegression(random_state = random_state),param_grid=logreg_param_grid,cv=StratifiedKFold(n_splits = 5),scoring=\"accuracy\")\nclf.fit(x_train,y_train)\nScores.append(clf.best_score_)\nConfusion_Matrices.append(confusion_matrix(y_test, clf.predict(x_test)))\nClassifiers.append(\"Logistic Regression\")\nCross_Val_Test_Scores.append(cross_val_score(clf, x_test, y_test,scoring=\"accuracy\", cv=5).mean())\nBest_Parameters.append(clf.best_estimator_)\n","598f4121":"knn_param_grid = {\"n_neighbors\": np.linspace(1,19,10, dtype = int).tolist(),\n                 \"weights\": [\"uniform\",\"distance\"],\n                 \"metric\":[\"euclidean\",\"manhattan\"]}\n\nclf=GridSearchCV(KNeighborsClassifier(),param_grid=knn_param_grid,cv=StratifiedKFold(n_splits = 5),scoring=\"accuracy\")\nclf.fit(x_train,y_train)\nScores.append(clf.best_score_)\nConfusion_Matrices.append(confusion_matrix(y_test, clf.predict(x_test)))\nClassifiers.append(\"KNN\")\nCross_Val_Test_Scores.append(cross_val_score(clf, x_test, y_test,scoring=\"accuracy\", cv=5).mean())\nBest_Parameters.append(clf.best_estimator_)","60c11a31":"graph_data= pd.DataFrame(list(zip(Classifiers,Cross_Val_Test_Scores)),columns =['Classifiers', 'Cross_Val_Test_Scores']) \ngraph_data=graph_data.sort_values(\"Cross_Val_Test_Scores\",ascending=False)\nstandartscaler=QuantileTransformer()\ngraph_data[\"Scaled Scores\"]=standartscaler.fit_transform(graph_data[\"Cross_Val_Test_Scores\"].values.reshape(-1,1))\nplt.figure(figsize=(16,8))\nsns.barplot(x=graph_data[\"Classifiers\"],y=graph_data[\"Scaled Scores\"])\nplt.title(\"Scores with scaled data\")\nplt.figure(figsize=(16,8))\nsns.barplot(x=graph_data[\"Classifiers\"],y=graph_data['Cross_Val_Test_Scores'])\nplt.title(\"Scores with real data\")","56e419bf":"graph_data.head()","9093fb16":"for i in range(len(Cross_Val_Test_Scores)):\n    plt.subplots()\n    sns.heatmap(Confusion_Matrices[i],annot=True,fmt='d')\n    plt.title(\"Confusion Matrix of {}\".format(Classifiers[i]))","ad393dd9":"votingC = VotingClassifier(estimators = [(\"knn\",Best_Parameters[4]),\n                                        (\"lr\",Best_Parameters[3]),\n                                        (\"rf\",Best_Parameters[2])],\n                                        voting = \"soft\", n_jobs = -1)\nvotingC = votingC.fit(x_train, y_train)\nprint(accuracy_score(votingC.predict(x_test),y_test))","614868fc":"All variables are categorical variable.","0ac944e7":"There is no missing value so it's good for us. We don't have to spend effort on this and since all of them categorical we don't have any outliers.","78312bb0":"As we can see odor variable is highly correlated with class so it can cause data leakage. Maybe odor name named after class name so it will be better if we drop that variable in order to prevent data leakage.","677f575c":"The number of both classes is about the same, but edible ones are slightly more.","8cf05411":"As we can see veil-type's behavior does not give information about class so we can drop it.","4b3c1e24":"# Categorical Data Analysis with Visualization","a0c2af1c":"And gill-attachment's behavior is similar to veil-type's one and it does not give information so we can drop it too.","cdf0e293":"At the end we created a model that has 100% accuracy.","cc573a54":"As we can see some variables are similar and some of are not correlated much with target like gill-attachment and veil-type. these two variables does not give information about target so we can drop them.","ea6f6543":"# Load and Check Data","2257e5b2":"I marked poisonous ones as 1 in order to make achieve my goal by using recall scoring.","9cbc1f21":"# Train Test Split","1e3bb49d":"This will be one of my first projects, in this project, I aim to create a model that will detect whether mushrooms are poisonous or not.\n\nI will use accuracy scoring,grid search, cross-validation and most of the classification models, and create an ensembled model.\n\nSince I am a newbie in this field, I will have mistakes and shortcomings, so I ask you to indicate the places that you see incorrect or missing in the comments :)","7088ef22":"Still I cannot see any problem from any of the models.","d58d7540":"Since all of my variables are categorical I changed every x variable to make suitable for my model.","edc5d663":"# Check and Drop Values","7eb43c8d":"# Ensemble Modelling","ec604173":"All of models that I used with their best parameters gave more than 99% accuracy. But still I will use an ensemble model for both creating a better model and avoid overfitting as much as possible.","26191674":"-I will use DecisionTreeClassifier,SVC,RandomForestClassifier, LogisticRegression,KNeighborsClassifier\n\n-I want to create a model that detects all poisonous mushrooms since no one would eat them.  I will use \"Recall Scoring\" because  I labelled poisonous mushrooms \"1\" and I want my model to detect all of the positive labels. That's why I will use \"Recall Scoring\".\n\n-I will use GridSearch to find the best parameters for all of the classifiers.\n\n-I will score them by using cross-validation.\n\n-I will find the best 3 or 4 models and I will create an ensembled model then I will finish.","d6759dc9":"I hope you liked it, please do not forget to mention the wrong and missing places in the comments.","d7e577c3":"# Modelling"}}