{"cell_type":{"d7dbea6d":"code","6135d110":"code","4c037b96":"code","7df77a5e":"code","cb4aa620":"code","687367a3":"code","8d857371":"code","564669b0":"code","a2432f96":"code","eef47b18":"code","b79c8e45":"code","b8b9a9ba":"code","ba1f7e93":"code","472abe76":"code","405e1c3a":"code","e4b30883":"code","97c8a0d7":"code","3ff5939e":"code","6d86ff44":"code","4b48c1d0":"code","72d483cf":"code","4cbe2263":"code","91a4504b":"code","f6471966":"code","43d3c662":"code","f296a214":"code","36fba06e":"code","7b8c587d":"code","472347f3":"code","703ae47e":"code","f6c59c3d":"code","12fa69c3":"code","75a69f16":"code","97dea079":"code","cc94583b":"code","9d00105f":"code","2d9e4fb1":"code","0ac578b7":"code","ab2966c4":"code","894b8590":"code","bba5e163":"code","95b20d8b":"code","71e58203":"code","868e6b0d":"code","4d5949ef":"code","5cc77775":"code","539165b9":"code","0c3ee312":"code","8208bb8d":"code","a9d40a83":"code","4e73068c":"code","f2b546d1":"code","6ae66591":"code","8ba1051c":"code","86bcd299":"code","07078393":"code","47e45b32":"code","27950ca9":"code","adb77980":"code","1fa74eb7":"code","34c7dec2":"code","70a5e36e":"code","06e4e3ce":"code","6060af73":"code","910977da":"code","af61b02c":"code","f00ff344":"code","e9314dec":"code","bea27cb4":"code","f430f0a3":"code","1502d1a4":"code","635f79a6":"code","a313fbcf":"code","fa66c2e5":"markdown","71bdfbf4":"markdown","22f35ca2":"markdown","778e4774":"markdown","522037e3":"markdown","92455858":"markdown","2794011f":"markdown","c8ec9cdb":"markdown","968668d5":"markdown","cbd85618":"markdown","cc4a12f4":"markdown","938475f9":"markdown","15b8b155":"markdown","882e74ff":"markdown","478f3bd1":"markdown","47a3de08":"markdown","af5d1fa8":"markdown","0c8919e6":"markdown","4277972c":"markdown","9bae7f09":"markdown","09c18b72":"markdown","a0d1a8ee":"markdown","3f79c021":"markdown","7409f38c":"markdown","62f467b2":"markdown"},"source":{"d7dbea6d":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\npd.set_option(\"display.max_columns\",None);\npd.set_option(\"display.max_rows\",None);\nretail=pd.read_excel(\"..\/input\/online-retail-ii-dataset\/online_retail_II.xlsx\", sheet_name=\"Year 2010-2011\")\n","6135d110":"df=retail.copy()","4c037b96":"df.head(5)","7df77a5e":"df.info()","cb4aa620":"df.isna().sum()  ","687367a3":"import missingno as msno\nmsno.bar(df);","8d857371":"df[df.isnull().any(axis=1)].shape","564669b0":"import missingno as msno\nmsno.heatmap(df);","a2432f96":"df[df.isnull().any(axis=1)].shape","eef47b18":"135080\/541910","b79c8e45":"missingdf=df[(df[\"Description\"].isnull()==True)  & (df[\"Customer ID\"].isnull()==True)].head()\nmissingdf.head()","b8b9a9ba":"missingdf.groupby(\"Country\").agg({\"Price\":np.mean})","ba1f7e93":"df=df[df.notnull().all(axis=1)]\nprint(df.shape)","472abe76":"df.head()","405e1c3a":"df[\"Customer ID\"]=df[\"Customer ID\"].astype(\"int64\")","e4b30883":"df.head(1)","97c8a0d7":"df[df[\"Invoice\"].astype(\"str\").str.get(0)==\"C\"].shape","3ff5939e":"df[df[\"Invoice\"].astype(\"str\").str.get(0)==\"C\"].head()","6d86ff44":"df=df[df[\"Invoice\"].astype(\"str\").str.get(0)!=\"C\"]","4b48c1d0":"df[df[\"Invoice\"].astype(str).str.get(0)!=\"5\"].head()","72d483cf":"df[df[\"Quantity\"]<0]","4cbe2263":"df.info()","91a4504b":"df.Country.value_counts().head()","f6471966":"df[df.duplicated([\"Description\",\"Invoice\"],keep=False)].head()","43d3c662":"df=df.drop([125])\ndf[df.duplicated([\"Description\",\"Invoice\"],keep=False)].head()","f296a214":"df.groupby(\"Country\").agg({\"Price\":\"sum\"}).applymap('{:,.2f}'.format).sort_values(by=\"Price\", ascending=True).head(10)","36fba06e":"# Unique products","7b8c587d":"df[\"Description\"].nunique()","472347f3":"# Each products counts are..","703ae47e":"df.Description.value_counts().head() # counts of categorical values","f6c59c3d":"# Best-seller","12fa69c3":"df.groupby(\"Description\").agg({\"Quantity\":sum}).sort_values(by=\"Quantity\", ascending=False).head()","75a69f16":"# Unique invoice","97dea079":"df[\"Invoice\"].nunique()","cc94583b":"df[\"Total_price\"]=df[\"Quantity\"]*df[\"Price\"]","9d00105f":"df.head(5)","2d9e4fb1":"pd.set_option(\"display.float_format\", lambda x: \"%.2f\" % x)","0ac578b7":"# The top invoices for price","ab2966c4":"df.groupby(\"Invoice\").agg({\"Total_price\":sum}).head()","894b8590":"df.groupby(\"Invoice\").agg({\"Total_price\":\"sum\"}).sort_values(\"Total_price\", ascending=False).head(11)","bba5e163":"# The highest invoice","95b20d8b":"df[df[\"Invoice\"]==581483]","71e58203":"# The most expensive product is \"POSTAGE\"","868e6b0d":"df.sort_values(\"Price\",ascending=False).head()","4d5949ef":"# Countries total prices","5cc77775":"df.groupby(\"Country\").agg({\"Total_price\":\"sum\"}).sort_values(\"Total_price\",ascending=False).head()","539165b9":"print(df[\"InvoiceDate\"].max())\nprint(df[\"InvoiceDate\"].min())","0c3ee312":"import datetime as dt\ntoday_date=dt.datetime(2011,12,10)\nprint(today_date)\ndf.groupby(\"Customer ID\").agg({\"InvoiceDate\":max}).sort_values(\"InvoiceDate\", ascending=False).head(3)","8208bb8d":"rec_df=today_date-df.groupby(\"Customer ID\").agg({\"InvoiceDate\":max})\nrec_df.head(3)","a9d40a83":"rec_df.rename(columns={\"InvoiceDate\": \"Recency\"}, inplace=True)\nrec_df.head(3)","4e73068c":"rec_df=rec_df[\"Recency\"].apply(lambda x: x.days)\nrec_df.head()","f2b546d1":"df.head(2)","6ae66591":"df.groupby([\"Customer ID\",\"Invoice\"]).agg({\"Invoice\":\"count\"}).head(5)","8ba1051c":"df[df[\"Customer ID\"]==17841].head(10)","86bcd299":"df.groupby(\"Customer ID\").agg({\"InvoiceDate\":\"nunique\"}).head(10)","07078393":"freq_df=df.groupby(\"Customer ID\").agg({\"InvoiceDate\":\"nunique\"})\nfreq_df.head(10)\n","47e45b32":"freq_df.rename(columns={\"InvoiceDate\": \"Frequency\"}, inplace=True)\nfreq_df.head(3)","27950ca9":"monetary_df=df.groupby(\"Customer ID\").agg({\"Total_price\":\"sum\"})\nmonetary_df.head(7)","adb77980":"monetary_df.rename(columns={\"Total_price\":\"Monetary\"}, inplace=True)\nmonetary_df.head()","1fa74eb7":"rfm=pd.concat([rec_df,freq_df, monetary_df], axis=1)\nrfm.head(7)","34c7dec2":"rfm[\"Recency_Score\"]= pd.qcut(rfm[\"Recency\"],5, labels=[5,4,3,2,1])","70a5e36e":"rfm[\"Frequency_Score\"]= pd.qcut(rfm[\"Frequency\"].rank(method=\"first\"),5, labels=[1,2,3,4,5])\n","06e4e3ce":"rfm[\"Monetary_Score\"]=pd.qcut(rfm[\"Monetary\"],5, labels=[1,2,3,4,5])","6060af73":"rfm.head(7)","910977da":"rfm[\"RFM\"]=rfm[\"Recency_Score\"].astype(str)+rfm[\"Frequency_Score\"].astype(str)+rfm[\"Monetary_Score\"].astype(str)\nrfm.head(10)","af61b02c":"rfm.head(6)","f00ff344":"seg_map={r'[1-2][1-2]': \"Hibernating\", r'[1-2][3-4]': \"At Risk\", r'[1-2]5': \"Can't Lose\", r'3[1-2]': \"About to Sleep\",\n        r'33': \"Need Attention\", r'[3-4][4-5]': \"Loyal Customers\", r'41': \"Promising\", r'51': \"New Customers\",\n        r'[4-5][2-3]': \"Potential Loyalist\", r'5[4-5]': \"Champions\"}","e9314dec":"rfm[\"Segment\"]=rfm[\"Recency_Score\"].astype(str)+ rfm[\"Frequency_Score\"].astype(str)\nrfm[\"Segment\"]=rfm[\"Segment\"].replace(seg_map,regex=True)","bea27cb4":"rfm.head()","f430f0a3":"rfm[[\"Segment\",\"Recency\",\"Frequency\",\"Monetary\"]].groupby(\"Segment\").agg([\"min\",\"max\",\"mean\",\"count\"])","1502d1a4":"rfm[rfm[\"Segment\"]==\"Need Attention\"].index","635f79a6":"dff=pd.DataFrame()\ndff[\"Need_Attention_ID\"]=rfm[rfm[\"Segment\"]==\"Need Attention\"].index\ndff.head()","a313fbcf":"dff.to_csv(\"Need_Attention.csv\")","fa66c2e5":"### This dataset has 8 columns and 541.910 observations.","71bdfbf4":"They are customers who used to visit and purchase quite often, but haven\u2019t been visiting recently. If we don't take any actions immediately, we will lose them.\n* We can bring them back with relevant promotions, \n* We can run surveys to find out what went wrong and avoid losing them to a competitor.\n\n\n* There are 64 customers in this group.\n* Their last purchases was 131 days ago, meanly.\n* The frequency of the group's purchase mean is 8.3.\n* The mean of the total purchase for one person who is in this group is 2791 sterlin.","22f35ca2":"# %24 of the dataset is missing. It so much.","778e4774":"# Are these NA Values are formed RANDOMLY?","522037e3":"# New Customers\n\nThey are customers who have a high overall RFM score but are not frequent shoppers. \n* We can start building relationships with these customers by providing onboarding support and special offers to increase their visits.\n\n* There are 42 customers in this group.\n* Their last purchases was 6.4 days ago, meanly.\n* The frequency of the group's purchase mean is 1.\n* The mean of the total purchase for one person who is in this group is 388 sterlin.","92455858":"# ID Excel File for Need Attention Segmentation ","2794011f":"### I grouped this data set by country. \n### Price mean is 0 and there is only one country. Therefore, trying to fill these observations will be meaningless.","c8ec9cdb":"# RFM SCORES","968668d5":"# New df without NA","cbd85618":"# \"At Risk\"","cc4a12f4":"# MONETARY","938475f9":"## RECENCY","15b8b155":"### I focused Customer ID and Invoice No then checked the price values.","882e74ff":"### How about the Price?","478f3bd1":"## FREQUENCY","47a3de08":"## I checked Invoice values if it starts with \"c\" letter or not","af5d1fa8":"# Can't Lose","0c8919e6":"### I used heatmap method.\n### I concluded that %10 of the observations which have NA for ID also have NA for Description.","4277972c":"## Identify the data","9bae7f09":"## Description of data set\n* InvoiceNo: Invoice number. Nominal. A 6-digit integral number uniquely assigned to each transaction. **If this code starts with the letter 'c', it indicates a cancellation.**\n* StockCode: Product (item) code. Nominal. A 5-digit integral number uniquely assigned to each distinct product.\n* Description: Product (item) name. Nominal.\n* Quantity: The quantities of each product (item) per transaction. Numeric.\n* InvoiceDate: Invice date and time. Numeric. The day and time when a transaction was generated.\n* UnitPrice: Unit price. Numeric. Product price per unit in sterling (\u00c2\u00a3).\n* CustomerID: Customer number. Nominal. A 5-digit integral number uniquely assigned to each customer.\n* Country: Country name. Nominal. The name of the country where a customer resides.","09c18b72":"### Whole data value count is 397.925 and 354.345 of these data from UK. Nearly 90% of the data observations are from United Kingdom. ","a0d1a8ee":"At Risk Customers are customers who purchased often and spent big amounts, but haven\u2019t purchased recently.\n* We can send them personalized reactivation campaigns to reconnect,\n* We can offer renewals and helpful products to encourage another purchase.\n\n\n\n\n* There are 594 customers in this group.\n* Their last purchases was 153 days ago, meanly. \n* The frequency of the group's purchase mean is 2.8.\n* The mean of the total purchase for one person who is in this group is 1079 sterlin.","3f79c021":"### There are 135.080 NA values in Customer ID column and 1.454 NA values in Description column.","7409f38c":"# NA VALUES","62f467b2":"# RFM ANALYSIS FOR ONL\u0130NE RETAIL DATA SET"}}