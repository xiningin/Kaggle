{"cell_type":{"86ce3b68":"code","2ff6fcf5":"code","24d98b0c":"code","56883a85":"code","4c118e0b":"code","47a59187":"code","b6177e7d":"code","45b85ee1":"code","5799abd8":"code","d297080a":"code","9b46f4da":"code","430ffe8b":"code","a5dfb447":"code","43971db2":"code","24c66382":"code","e189883e":"code","2c8f42db":"code","bcf43c77":"code","7cc26bce":"code","94d5abd5":"code","5c091abe":"code","465e3761":"code","0ac1d601":"code","f85e5112":"code","5596f160":"code","905ff058":"code","391afd80":"code","4e630b14":"code","e516e4e3":"code","cc7835fb":"code","f2e913ab":"code","41bf377d":"code","97434807":"markdown","b1b5214f":"markdown","c15695ea":"markdown","7e203490":"markdown","7222fa4a":"markdown","7e5185bc":"markdown","651159e8":"markdown","dbba7dc7":"markdown","31782f51":"markdown","8358e45d":"markdown","3b9e97f1":"markdown","9745f61a":"markdown"},"source":{"86ce3b68":"#important libraries\n\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set()","2ff6fcf5":"data = pd.read_csv('..\/input\/pima-indians-diabetes-database\/diabetes.csv')","24d98b0c":"data.head()\n#print(data.tail())\n","56883a85":"#some random values from our data\ndata.sample(5)","4c118e0b":"data.info()","47a59187":"data.describe()","b6177e7d":"#check is there any NaN value.\ndata.isnull().sum()","45b85ee1":"#let's check outlier now.\nplt.figure(figsize=(20,8))\nplt.boxplot(data)\nplt.show()","5799abd8":"import warnings\nwarnings.filterwarnings('ignore')","d297080a":"sns.distplot(data[\"Insulin\"])","9b46f4da":"q=data['Insulin'].quantile(.99)\ndata1=data[data['Insulin']<q]","430ffe8b":"sns.distplot(data1[\"Insulin\"])","a5dfb447":"plt.boxplot(data['Insulin'])\nplt.show()","43971db2":" bl=data['Outcome'].value_counts()","24c66382":"bl.plot(kind='bar',rot=360,color='red')","e189883e":"data1.plot(kind= 'kde' , subplots=True, layout=(3,3), sharex=False, sharey=False, figsize=(15,10))\nplt.show()","2c8f42db":"# Create a correlation matrix\ncorr_metrics =data1.corr()\n\ncorr_metrics.style.background_gradient()","bcf43c77":"# Age vs BloodPressure with hue = Outcome\nplt.figure(figsize=(12,8))\nax = sns.scatterplot(x=\"BloodPressure\", y=\"Age\", alpha=0.4,label=\"0\", data=data[data['Outcome'] == 0])\nsns.scatterplot(x=\"BloodPressure\", y=\"Age\", alpha=1, label=\"1\",data=data[data['Outcome'] == 1], ax=ax)\nplt.show()","7cc26bce":"data2 = data1[data1['BloodPressure'] != 0]","94d5abd5":"#crosscheck\nsum(data2['BloodPressure']==0)","5c091abe":"# Splitting into features and value to be predicted\nX = data2.drop(columns=['Outcome'])\ny = data2['Outcome']\n\n","465e3761":"fig, ax = plt.subplots(1,2 ,figsize = (10,5))\n\nsns.barplot(x=['0', '1'], y =[sum(y == 0), sum(y == 1)], ax = ax[0])\nax[0].set_title(\"Before Oversampling\")\nax[0].set_xlabel('Outcome')\n\n#Using SMOTE to balance the Data\nfrom imblearn.over_sampling import SMOTE\n\nsm = SMOTE(random_state = 2) \nX, y = sm.fit_resample(X, y) \n\nsns.barplot(x=['0', '1'], y =[sum(y == 0), sum(y == 1)], ax = ax[1])\nax[1].set_title(\"After Oversampling\")\nax[1].set_xlabel('Outcome')\n\nplt.tight_layout()\nplt.show()","0ac1d601":"from sklearn.model_selection import train_test_split\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=40)\n","f85e5112":"from sklearn.svm import SVC\nfrom sklearn.pipeline import make_pipeline\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.preprocessing import MinMaxScaler\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.preprocessing import Normalizer\nfrom sklearn.preprocessing import RobustScaler\n\n\npipe1 = make_pipeline(MinMaxScaler(), SVC())\npipe2 = make_pipeline(Normalizer(), SVC())\npipe3 = make_pipeline(RobustScaler(), SVC())\npipe4 = make_pipeline(StandardScaler(), SVC())","5596f160":"parameter = {'svc__C': [0.001,0.01, 0.02, 0.05, 0.1, 0.2, 0.5, 1, 2, 5, 10, 20, 50, 100,200],\n              'svc__gamma': [0.001,0.01, 0.02, 0.05, 0.1, 0.2, 0.5, 1, 2, 5, 10, 20, 50, 100,200]} ","905ff058":"# for minmaxscaler\ngrid = GridSearchCV(pipe1,parameter, cv=5)\ngrid.fit(X_train, y_train)\nprint(\"Best cross-validation accuracy:\", grid.best_score_)\nprint(\"Test set score:\", grid.score(X_test, y_test))\nprint(\"Test error rate:\", 1-grid.score(X_test, y_test))\nprint(\"Best parameters:\", grid.best_params_)","391afd80":"#for Normalizer\ngrid = GridSearchCV(pipe2,parameter, cv=5)\ngrid.fit(X_train, y_train)\nprint(\"Best cross-validation accuracy:\", grid.best_score_)\nprint(\"Test set score:\", grid.score(X_test, y_test))\nprint(\"Test error rate:\", 1-grid.score(X_test, y_test))\nprint(\"Best parameters:\", grid.best_params_)","4e630b14":"#RobustScaler\ngrid = GridSearchCV(pipe3,parameter, cv=5)\ngrid.fit(X_train, y_train)\nprint(\"Best cross-validation accuracy:\", grid.best_score_)\nprint(\"Test set score:\", grid.score(X_test, y_test))\nprint(\"Test error rate:\", 1-grid.score(X_test, y_test))\nprint(\"Best parameters:\", grid.best_params_)","e516e4e3":"# StandardScaler\ngrid = GridSearchCV(pipe4,parameter, cv=5)\ngrid.fit(X_train, y_train)\nprint(\"Best cross-validation accuracy:\", grid.best_score_)\nprint(\"Test set score:\", grid.score(X_test, y_test))\nprint(\"Test error rate:\", 1-grid.score(X_test, y_test))\nprint(\"Best parameters:\", grid.best_params_)","cc7835fb":"prediction = grid.predict(X_test)\nprediction","f2e913ab":"from sklearn.metrics import confusion_matrix\nconfusion_matrix(y_test,prediction)","41bf377d":"from sklearn.metrics import accuracy_score\naccuracy_score(y_test,prediction)","97434807":"Our Data is clearly not balanced. We will balance this data using SMOTE technique after some visualizations.\n\nSMOTE is an oversampling technique where the synthetic samples are generated for the minority class. This algorithm helps to overcome the overfitting problem posed by random oversampling. It focuses on the feature space to generate new instances with the help of interpolation between the positive instances that lie together.\n","b1b5214f":"Firstly lets check that if our data is balanced or not","c15695ea":"Split data into train and test ","7e203490":"## SVM(support vector machine)","7222fa4a":"## Data Cleaning","7e5185bc":"It seems like most attributes are normally distributed.","651159e8":"Here, remove top 1% outlier in Insulin attribute   ","dbba7dc7":"# EDA","31782f51":"first, Bloodpressure never be zero","8358e45d":"reference \n#https:\/\/www.nhs.uk\/common-health-questions\/lifestyle\/what-is-blood-pressure\/\n2\nhttps:\/\/www.quora.com\/What-will-happen-when-the-blood-pressure-goes-zero","3b9e97f1":"## Load dataset.","9745f61a":"outliner seen in column 5\n"}}