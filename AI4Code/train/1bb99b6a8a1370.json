{"cell_type":{"1e3707ee":"code","6596de5b":"code","5d28322f":"code","405dfe38":"code","db9841ae":"code","6746f2bd":"code","e6fe1989":"code","0af15ec8":"code","516d7ae8":"code","49677faa":"code","41465b41":"code","6a5751dd":"code","5830c518":"code","01b439ea":"code","79bdc668":"code","c1ecf01a":"code","9a7aea48":"code","dfa2958c":"code","04fe88e8":"code","65688ee8":"code","0c06bb9c":"code","6352da5b":"code","f6d74d68":"code","78d249c7":"code","8da1e8b7":"code","b47b58cf":"code","7a43e1bb":"code","0a0e98be":"code","9fa4f3e0":"code","d259fafa":"code","3d3cbcee":"code","604936d9":"code","9453389a":"code","dcb36e4b":"code","9a494d8f":"code","d7a0e6be":"code","ebd8a240":"code","80cdc011":"code","410dd6f2":"code","ca6b06f5":"code","701eeb5e":"code","e5a1a0ea":"code","1a822452":"code","b7941d97":"code","9ec4b576":"code","2a5a9b08":"code","a0509dea":"code","557c60ac":"code","ddcf5c00":"code","e7eb6fdd":"code","6ce193fd":"code","4f977ab1":"code","4edca008":"code","f0f6a5d9":"code","e407528c":"code","253f1d11":"code","eaeada88":"code","3cd5088a":"code","55623967":"code","52559a2e":"markdown","64a6c757":"markdown","71c43d94":"markdown","3f542438":"markdown","50440a7a":"markdown","0e22a182":"markdown","dcf06095":"markdown","a1073d4c":"markdown","4012a813":"markdown","7cf356ef":"markdown","8a33337f":"markdown","77f3b65b":"markdown","bc73261c":"markdown","c0a80eed":"markdown"},"source":{"1e3707ee":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nfrom matplotlib import pyplot as plt\nimport seaborn as sns\nfrom collections import Counter\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","6596de5b":"data = pd.read_csv('\/kaggle\/input\/movies-on-netflix-prime-video-hulu-and-disney\/MoviesOnStreamingPlatforms_updated.csv')","5d28322f":"data = data.iloc[:,1:]","405dfe38":"data.head()","db9841ae":"total_platforms = data[['Netflix', 'Hulu', 'Prime Video', 'Disney+']].apply(pd.Series.value_counts).reset_index()\ntotal_platforms.columns = ['Present', 'Netflix', 'Hulu', 'Prime Video', 'Disney+']","6746f2bd":"total_platforms","e6fe1989":"labels = ['Netflix', 'Hulu', 'Prime Video', 'Disney+']","0af15ec8":"plt.figure(figsize=(12,8))\np = plt.pie(total_platforms[total_platforms.Present == 1].iloc[:,1:], labels=labels, explode = (0.1, 0.1, 0.1, 0.1), \n            autopct='%1.0f%%', labeldistance=1.1, shadow=True)","516d7ae8":"for i in labels:\n    data['rating_'+i] = data['IMDb'] * data[i]","49677faa":"imdb_platforms = data.replace(0, np.nan)","41465b41":"imdb_platforms = imdb_platforms[['rating_Netflix', 'rating_Hulu', 'rating_Prime Video', 'rating_Disney+']].mean().reset_index()\nimdb_platforms.columns = ['ratings', 'mean']\nimdb_platforms.sort_values(by='mean', ascending=False)","6a5751dd":"plt.figure(figsize=(12,8))\nax = sns.barplot(x=\"ratings\", y=\"mean\", data=imdb_platforms)\nl = ax.set(ylim=(5.5, 6.5))","5830c518":"# Prime Video has more films but less quality types","01b439ea":"fig, axes = plt.subplots(2, 2,figsize=(22,15))\n\nax1 = data[data.Netflix == 1].groupby('IMDb')['ID'].count().plot(xlim=(0, 10), ax=axes[0,0])\nax2 = data[data.Hulu == 1].groupby('IMDb')['ID'].count().plot(xlim=(0, 10),ax=axes[0,1])\nax3 = data[data['Prime Video'] == 1].groupby('IMDb')['ID'].count().plot(xlim=(0, 10),ax=axes[1,0])\nax4 = data[data['Disney+'] == 1].groupby('IMDb')['ID'].count().plot(xlim=(0, 10),ax=axes[1,1])\n\nax1.title.set_text(labels[0])\nax2.title.set_text(labels[1])\nax3.title.set_text(labels[2])\nax4.title.set_text(labels[3])\n\nplt.show()","79bdc668":"# Prime Video has a larger proportion of movies rated under 4","c1ecf01a":"fig, axes = plt.subplots(2, 2,figsize=(22,15))\n\nax1 = data[data.Netflix == 1].groupby('Year')['ID'].count().plot(xlim=(data['Year'].min(), data['Year'].max()), ax=axes[0,0])\nax2 = data[data.Hulu == 1].groupby('Year')['ID'].count().plot(xlim=(data['Year'].min(), data['Year'].max()),ax=axes[0,1])\nax3 = data[data['Prime Video'] == 1].groupby('Year')['ID'].count().plot(xlim=(data['Year'].min(), data['Year'].max()),ax=axes[1,0])\nax4 = data[data['Disney+'] == 1].groupby('Year')['ID'].count().plot(xlim=(data['Year'].min(), data['Year'].max()),ax=axes[1,1])\n\nax1.title.set_text(labels[0])\nax2.title.set_text(labels[1])\nax3.title.set_text(labels[2])\nax4.title.set_text(labels[3])\n\nplt.show()","9a7aea48":"# Netflix, Hulu and Prime Video (which has some bumps in the 40s and 80s) have their peak in the 2010s\n# Disney+ in the 2000s and in the late 2010s","dfa2958c":"fig = plt.figure(figsize=(35,15))\n\nage_netflix = data[data.Netflix == 1].groupby(['Age', 'Netflix']).count()['ID'].reset_index()[['Age', 'ID']]\nage_hulu = data[data.Hulu == 1].groupby(['Age', 'Hulu']).count()['ID'].reset_index()[['Age', 'ID']]\nage_prime = data[data['Prime Video'] == 1].groupby(['Age', 'Prime Video']).count()['ID'].reset_index()[['Age', 'ID']]\nage_disney = data[data['Disney+'] == 1].groupby(['Age', 'Disney+']).count()['ID'].reset_index()[['Age', 'ID']]\n\nax = plt.subplot2grid((2,4),(0,0))\np = plt.pie(age_netflix['ID'], labels=age_netflix.Age, explode = (0.05, 0.05, 0.05, 0.05, 0.05), autopct='%1.0f%%', labeldistance=1.1, shadow=True)\nplt.title('Netflix')\nax = plt.subplot2grid((2,4),(0,1))\np = plt.pie(age_hulu['ID'], labels=age_hulu.Age, explode = (0.05, 0.05, 0.05, 0.05, 0.05), autopct='%1.0f%%', labeldistance=1.1, shadow=True)\nplt.title('Hulu')\nax = plt.subplot2grid((2,4),(1,0))\np = plt.pie(age_prime['ID'], labels=age_prime.Age, explode = (0.05, 0.05, 0.05, 0.05, 0.05), autopct='%1.0f%%', labeldistance=1.1, shadow=True)\nplt.title('Prime Video')\nax = plt.subplot2grid((2,4),(1,1))\np = plt.pie(age_disney['ID'], labels=age_disney.Age, explode = (0.05, 0.05, 0.05, 0.05, 0.05), autopct='%1.0f%%', labeldistance=1.1, shadow=True)\nplt.title('Disney+')\nplt.show()","04fe88e8":"# Disney has a lot more accessible contents (91% of all or 7+)","65688ee8":"# Getting the same colours\nnb_genres = data[['ID', 'Genres']]\nnb_genres = nb_genres.dropna()\nnb_genres['Genres'] = nb_genres['Genres'].astype(str)\nnb_genres = pd.concat([pd.Series(row['ID'], row['Genres'].split(','))              \n                    for _, row in nb_genres.iterrows()]).reset_index()\nnb_genres = nb_genres.groupby('index').count().reset_index()\nnb_genres.columns = ['Genres', 'nb']\nnb_genres = nb_genres.sort_values(by='nb', ascending=False)\nnb_genres['colors'] = sns.color_palette(n_colors=len(nb_genres))","0c06bb9c":"genres_plat = data[['Netflix', 'Hulu', 'Prime Video', 'Disney+', 'Genres']]\ngenres_plat = genres_plat.dropna()\ngenres_plat['Genres'] = genres_plat['Genres'].astype(str)\n\n# Netflix\ngenres_netflix = genres_plat[genres_plat.Netflix == 1]\ngenres_netflix = pd.concat([pd.Series(row['Netflix'], row['Genres'].split(','))              \n                    for _, row in genres_netflix.iterrows()]).reset_index()\ngenres_netflix.columns = ['Genres', 'Count']\ngenres_netflix = genres_netflix.groupby('Genres').count().reset_index().sort_values(by='Count', ascending=False)\ngenres_netflix['Count'] = genres_netflix['Count'] \/ len(genres_netflix)\n\n# Hulu\ngenres_hulu = genres_plat[genres_plat.Hulu == 1]\ngenres_hulu = pd.concat([pd.Series(row['Hulu'], row['Genres'].split(','))              \n                    for _, row in genres_hulu.iterrows()]).reset_index()\ngenres_hulu.columns = ['Genres', 'Count']\ngenres_hulu = genres_hulu.groupby('Genres').count().reset_index().sort_values(by='Count', ascending=False)\ngenres_hulu['Count'] = genres_hulu['Count'] \/ len(genres_hulu)\n\n# Prime Video\ngenres_prime = genres_plat[genres_plat['Prime Video'] == 1]\ngenres_prime = pd.concat([pd.Series(row['Prime Video'], row['Genres'].split(','))              \n                    for _, row in genres_prime.iterrows()]).reset_index()\ngenres_prime.columns = ['Genres', 'Count']\ngenres_prime = genres_prime.groupby('Genres').count().reset_index().sort_values(by='Count', ascending=False)\ngenres_prime['Count'] = genres_prime['Count'] \/ len(genres_prime)\n\n# Disney+\ngenres_disney = genres_plat[genres_plat['Disney+'] == 1]\ngenres_disney = pd.concat([pd.Series(row['Disney+'], row['Genres'].split(','))              \n                    for _, row in genres_disney.iterrows()]).reset_index()\ngenres_disney.columns = ['Genres', 'Count']\ngenres_disney = genres_disney.groupby('Genres').count().reset_index().sort_values(by='Count', ascending=False)\ngenres_disney['Count'] = genres_disney['Count'] \/ len(genres_disney)","6352da5b":"genres_netflix = pd.merge(genres_netflix, nb_genres, on='Genres')\ngenres_hulu = pd.merge(genres_hulu, nb_genres, on='Genres')\ngenres_prime = pd.merge(genres_prime, nb_genres, on='Genres')\ngenres_disney = pd.merge(genres_disney, nb_genres, on='Genres')","f6d74d68":"fig = plt.figure(figsize=(35,15))\nax = plt.subplot2grid((2,4),(0,0))\np = plt.pie(genres_netflix['Count'][:10], labels=genres_netflix.Genres[:10], colors = genres_netflix.colors[:10], explode = (0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05), autopct='%1.0f%%', labeldistance=1.1, shadow=True)\nplt.title('Netflix')\nax = plt.subplot2grid((2,4),(0,1))\np = plt.pie(genres_hulu['Count'][:10], labels=genres_hulu.Genres[:10], colors = genres_hulu.colors[:10], explode = (0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05), autopct='%1.0f%%', labeldistance=1.1, shadow=True)\nplt.title('Hulu')\nax = plt.subplot2grid((2,4),(1,0))\np = plt.pie(genres_prime['Count'][:10], labels=genres_prime.Genres[:10], colors = genres_prime.colors[:10], explode = (0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05), autopct='%1.0f%%', labeldistance=1.1, shadow=True)\nplt.title('Prime Video')\nax = plt.subplot2grid((2,4),(1,1))\np = plt.pie(genres_disney['Count'][:10], labels=genres_disney.Genres[:10], colors = genres_disney.colors[:10], explode = (0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05, 0.05), autopct='%1.0f%%', labeldistance=1.1, shadow=True)\nplt.title('Disney+')\nplt.show()\n","78d249c7":"# Netflix, Hulu and Prime Video have nearly the same top genres\n# More movies with Adventure and Family in Disney+, less drama than the others","8da1e8b7":"plt.figure(figsize=(20,8))\ng = sns.countplot(data.Year)\nt = plt.xticks(rotation=90)","b47b58cf":"# Peak in 2017 because platforms have to wait 2 years after they've been in theaters before having them in streaming","7a43e1bb":"# Better way to see it as a percentage for the years","0a0e98be":"genres = data[['Year', 'Genres']]\ngenres = genres.dropna()\ngenres['Genres'] = genres['Genres'].astype(str)","9fa4f3e0":"genres = pd.concat([pd.Series(row['Year'], row['Genres'].split(','))              \n                    for _, row in genres.iterrows()]).reset_index()\ngenres.columns = ['Genres', 'Year']","d259fafa":"total_year = genres.groupby('Year').count()\ntotal_year = total_year.reset_index()\ntotal_year.columns = ['Year', 'total']","3d3cbcee":"genres_year = genres.groupby(['Year', 'Genres'])['Genres'].count()\ngenres_year = genres_year.reset_index(name=\"count\")","604936d9":"genres_year = genres_year.loc[genres_year.groupby('Year')['count'].nlargest(1).index.get_level_values(1)]","9453389a":"genres_year = pd.merge(genres_year, total_year, on='Year')\ngenres_year['perc_mc'] = genres_year['count'] \/ genres_year['total']","dcb36e4b":"fig,ax = plt.subplots()\nfig.set_size_inches(20,10)\nax = sns.barplot(x='Year',y='perc_mc',hue='Genres', data=genres_year, dodge=False, palette='Paired')\nplt.xticks(rotation=90)\nax.legend(loc='upper right')\nplt.show()","9a494d8f":"# Seems like a lot of Drama movies","d7a0e6be":"plt.figure(figsize=(20,8))\ng = sns.countplot(data.IMDb)\nt = plt.xticks(rotation=90)","ebd8a240":"# What are the best rated movies in all platform ?\ndata[data.IMDb == data.IMDb.max()][['Title', 'IMDb', 'Genres', 'Runtime']]","80cdc011":"# A lot of Documentaries\n# This ratings don't seem accurate : My Next Guest... has a 7.9 rating and Bounty 7 after checking\n# The rest is correct or has less than 0.3 difference","410dd6f2":"age = data.groupby('Age').count()['ID'].reset_index()\nage.columns = ['Age', 'count']","ca6b06f5":"age.sort_values(by='count', ascending=False)","701eeb5e":"plt.figure(figsize=(12,8))\np = plt.pie(age['count'], labels=age.Age, explode = (0.05, 0.05, 0.05, 0.05, 0.05), autopct='%1.0f%%', labeldistance=1.1, shadow=True)","e5a1a0ea":"# before 1960 \/ 1960-80 \/ 1980-2000 \/ 2000+","1a822452":"ratings = data[['Year', 'IMDb']]\nratings = ratings.dropna()","b7941d97":"for i, row in ratings.iterrows():\n    if row['Year'] < 1960:\n        ratings.loc[i,'period'] = '-1960'\n    elif ((row['Year'] >=1960) &  (row['Year'] <1980)):\n        ratings.loc[i,'period'] = '1960-80'\n    elif ((row['Year'] >=1980) &  (row['Year'] <2000)):\n        ratings.loc[i,'period'] = '1980-2000'\n    else:\n        ratings.loc[i,'period'] = '2000+'","9ec4b576":"ratings = ratings.groupby('period')['IMDb'].mean().reset_index()\nratings.columns = ['period', 'mean']","2a5a9b08":"plt.figure(figsize=(12,8))\nax = sns.barplot(x=\"period\", y=\"mean\", data=ratings)\nl = ax.set(ylim=(5.5, 6.2))","a0509dea":"countries = data[['Country']]\ncountries = countries.dropna()\ncountries = pd.concat([pd.Series(row['Country'].split(','))              \n                    for _, row in countries.iterrows()]).reset_index()\ncountries.columns = ['index', 'Country']","557c60ac":"plt.figure(figsize=(15,8))\ng = sns.countplot(x='Country',data=countries, order = countries['Country'].value_counts().iloc[:10].index)","ddcf5c00":"# Majority of movies are made in the US\n# So we suppose majority of the movies are in English","e7eb6fdd":"language = data[['Language']]\nlanguage = language.dropna()\nlanguage = pd.concat([pd.Series(row['Language'].split(','))              \n                    for _, row in language.iterrows()]).reset_index()\nlanguage.columns = ['index', 'Language']","6ce193fd":"plt.figure(figsize=(15,8))\ng = sns.countplot(x='Language',data=language, order = language['Language'].value_counts().iloc[:10].index)","4f977ab1":"data['Runtime'].mean()","4edca008":"plt.figure(figsize=(10,6))\nsns.kdeplot(data['Runtime'])","f0f6a5d9":"# Big Right Skew\n# How many movies with more than 200 min  (3h+)?","e407528c":"print('%.2f%% movies have more than 300 min runtime' %(data[data.Runtime > 200].count()['ID'] \/ len(data) *100))","253f1d11":"# Colorado with 20h+\ndata[data.Runtime == data['Runtime'].max()][['Title', 'Runtime']]","eaeada88":"# Let's remove this noise\nruntime = data[data.Runtime < 200]","3cd5088a":"plt.figure(figsize=(15,8))\nsns.distplot(runtime['Runtime'], bins=50, kde=False)","55623967":"print('The most frequent runtime is %d min' % data['Runtime'].mode().values[0])","52559a2e":"### Movies Ages repartition on Platform","64a6c757":"### Ratings per Period","71c43d94":"### Movies ratings","3f542438":"### Number of films","50440a7a":"# Movies Exploration","0e22a182":"### Age repartition","dcf06095":"# Comparing Platforms","a1073d4c":"### Countries and languages","4012a813":"### Platforms most frequent genres","7cf356ef":"### Runtime","8a33337f":"### Movies ratings","77f3b65b":"### Movies year","bc73261c":"### Movies genre per Year","c0a80eed":"### Movies Year"}}