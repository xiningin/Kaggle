{"cell_type":{"25b9fc92":"code","9ccc82cc":"code","62ea17bf":"code","4567bf49":"code","211f19fc":"code","ef2cec9c":"code","67bfe39b":"code","124c27aa":"code","9d20c583":"code","bbf91532":"code","eafc2009":"code","6f698990":"code","fc3dc66e":"code","3c2a6174":"code","e34829ae":"code","6d466065":"code","6f8cb5d4":"code","4d4b9984":"code","c9af0b30":"code","17f96cac":"code","c669242c":"code","2c895505":"code","121a0f32":"code","84b0e774":"code","02817021":"code","eaa2af65":"code","3efd6a78":"code","b488f0e6":"code","829ca5c8":"code","6287dd1f":"code","466f39af":"code","00804bb3":"code","ea03d6d0":"code","b2f15fdd":"code","70cf3497":"code","e2dc1571":"code","5a717df5":"code","8a405ffb":"code","0c4e314c":"markdown","57c15a1b":"markdown","1b161e14":"markdown","b68357be":"markdown","50d865bd":"markdown","66e6a191":"markdown","ea7c0e3e":"markdown","709ce1ee":"markdown","975f6c22":"markdown","8a33031a":"markdown","f468022f":"markdown","13ef1240":"markdown","cdb3ab01":"markdown","9ece0c59":"markdown","8df14371":"markdown","41a06e33":"markdown","5e6c073e":"markdown","4e87139d":"markdown","510e3bcd":"markdown","5a10073b":"markdown","25ff7e4b":"markdown","d0997dd7":"markdown","150e0ca5":"markdown","90022e88":"markdown","d080f516":"markdown","2bc5f670":"markdown","ecb60f7c":"markdown","a81056ed":"markdown","8ef8c6ea":"markdown","4d284261":"markdown","183d24b4":"markdown"},"source":{"25b9fc92":"import pandas as pd\nimport numpy as np \nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline\n\nimport warnings\nwarnings.filterwarnings('ignore')","9ccc82cc":"iris = pd.read_csv(\"..\/input\/iris-flower-dataset\/IRIS.csv\")","62ea17bf":"iris.head(2)","4567bf49":"iris.tail(2)","211f19fc":"iris.shape","ef2cec9c":"iris.info()","67bfe39b":"iris['species'].value_counts()","124c27aa":"fig = iris[iris.species=='Iris-setosa'].plot(kind='scatter',x='sepal_length',y='sepal_width',color='orange', label='Setosa')\niris[iris.species=='Iris-versicolor'].plot(kind='scatter',x='sepal_length',y='sepal_width',color='blue', label='versicolor',ax=fig)\niris[iris.species=='Iris-virginica'].plot(kind='scatter',x='sepal_length',y='sepal_width',color='yellow', label='virginica',ax=fig)\nfig.set_xlabel(\"Sepal Length\")\nfig.set_ylabel(\"Sepal Width\")\nfig.set_title(\"Sepal Length VS Width\")\nfig=plt.gcf()\nfig.set_size_inches(10,6)\nplt.show()\n\n\n","9d20c583":"fig= iris[iris.species=='Iris-setosa'].plot(kind='scatter',x='petal_length',y='petal_width',color='orange', label='Setosa')\niris[iris.species=='Iris-versicolor'].plot(kind='scatter', x='petal_length',y='petal_width',color='blue', label='versicolor',ax=fig)\niris[iris.species=='Iris-virginica'].plot(kind='scatter', x='petal_length',y='petal_width',color='yellow',label='virginica',ax=fig)\nfig.set_xlabel(\"Petal Length\")\nfig.set_ylabel(\"Petal Width\")\nfig.set_title(\"Petal Length VS Width\")\nfig=plt.gcf()\nfig.set_size_inches(10,6)\nplt.show()\n","bbf91532":"iris.hist(edgecolor=\"black\", linewidth=1.4)\nfig=plt.gcf()\nfig.set_size_inches(12,8)\nplt.show()","eafc2009":"plt.figure(figsize=(10,8))\nplt.subplot(2,2,1)\nsns.violinplot(x='species',y='petal_length',data=iris)\nplt.subplot(2,2,2)\nsns.violinplot(x='species',y='petal_width',data=iris)\nplt.subplot(2,2,3)\nsns.violinplot(x='species',y='sepal_length',data=iris)\nplt.subplot(2,2,4)\nsns.violinplot(x='species',y='sepal_width',data=iris)","6f698990":"sns.FacetGrid(iris,hue=\"species\",height=6).map(sns.distplot,\"petal_length\").add_legend();","fc3dc66e":"sns.FacetGrid(iris,hue=\"species\",height=6).map(sns.distplot,\"petal_width\").add_legend();","3c2a6174":"sns.FacetGrid(iris,hue=\"species\",height=6).map(sns.distplot,\"sepal_length\").add_legend();","e34829ae":"sns.FacetGrid(iris,hue=\"species\",height=6).map(sns.distplot,\"sepal_width\").add_legend();","6d466065":"plt.figure(figsize=(10,8))\nsns.set_style('whitegrid')\nsns.pairplot(data=iris,hue='species',palette=['orange','blue','yellow'])","6f8cb5d4":"plt.figure(figsize=(7,5))\nsns.heatmap(iris.corr(),annot=True,cmap='cubehelix_r')\n#draws  heatmap with input as the correlation matrix calculted by(iris.corr())\nplt.show()","4d4b9984":"from sklearn.linear_model import LogisticRegression\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn import metrics\nfrom sklearn import svm \nfrom sklearn.neighbors import KNeighborsClassifier\n","c9af0b30":"train, test = train_test_split(iris, test_size = 0.3)\nprint(train.shape)\nprint(test.shape)","17f96cac":"train_X = train[['sepal_length','sepal_width','petal_length','petal_width']]\ntrain_y=train.species\ntest_X= test[['sepal_length','sepal_width','petal_length','petal_width']]\ntest_y =test.species","c669242c":"train_X.head(2)","2c895505":"test_X.head(2)","121a0f32":"train_y.head()","84b0e774":"model=LogisticRegression()\nmodel.fit(train_X,train_y)\nprediction=model.predict(test_X)\nprint('The accuracy of the Logistic Regression is',metrics.accuracy_score(prediction,test_y))","02817021":"model=DecisionTreeClassifier()\nmodel.fit(train_X,train_y)\nprediction=model.predict(test_X)\nprint('The accuracy of the Decision Tree is',metrics.accuracy_score(prediction,test_y))","eaa2af65":"model=KNeighborsClassifier(n_neighbors=3)\nmodel.fit(train_X,train_y)\nprediction=model.predict(test_X)\nprint('The accuracy of the K-Nearest Neighbours is',metrics.accuracy_score(prediction,test_y))","3efd6a78":"model = svm.SVC()\nmodel.fit(train_X,train_y)\nprediction=model.predict(test_X)\nprint('The accuracy of the SVM is',metrics.accuracy_score(prediction,test_y))","b488f0e6":"x = iris.drop(['species'],axis=1)\ny = iris.species","829ca5c8":"from sklearn.preprocessing import StandardScaler\nx = StandardScaler().fit_transform(x)","6287dd1f":"iris_cov_matrix = np.cov(x.T)\niris_cov_matrix","466f39af":"eig_vals, eig_vecs = np.linalg.eig(iris_cov_matrix)\nprint('\\nEigenvalues \\n%s' %eig_vals)\nprint('Eigenvectors \\n%s' %eig_vecs)","00804bb3":"eig_pairs = [(np.abs(eig_vals[i]), eig_vecs[:,i]) for i in range(len(eig_vals))]\nprint('Eigenvalues in descending order:')\nfor i in eig_pairs:\n    print(i[0])","ea03d6d0":"total = sum(eig_vals)\nvar_exp = [(i \/ total)*100 for i in sorted(eig_vals, reverse=True)]\ncum_var_exp = np.cumsum(var_exp)\nprint('Variance captured by each component is \\n',var_exp)\nprint('Cumulative variance captured as we travel with each component \\n',cum_var_exp)","b2f15fdd":"from sklearn import decomposition\n\npca = decomposition.PCA(n_components=2)\n\nx_transform = pca.fit_transform(x)","70cf3497":"pc_df = pd.DataFrame(data = x_transform, columns = ['PC1', 'PC2'])\npc_df['species'] = y","e2dc1571":"pc_df.head()","5a717df5":"pca.get_covariance()","8a405ffb":"explained_variance=pca.explained_variance_ratio_\nexplained_variance","0c4e314c":"As we can see that the Petal Features are giving a better cluster division compared to the Sepal features. This is an indication that the Petals can help in better and accurate Predictions over the Sepal. We will check that later.","57c15a1b":"Splitting The Data into Training And Testing Dataset","1b161e14":"The above graph shows relationship between the sepal length and width. Now we will check relationship between the petal length and width.","b68357be":"Load the important required libraries","50d865bd":"The correlation between the Sepal Width and Length was very low whereas the correlation between Petal Width and Length was very high.\n\nWe will use all the features for training the algorithm and check the accuracy.","66e6a191":"**Modelling with PCA**","ea7c0e3e":"From above plot, we see that on the basis of petal width setosa is separable while the other two are overlapping","709ce1ee":"Decision Tree","975f6c22":"#importing alll the necessary packages to use the various classification algorithms\n","8a33031a":"From above plot, we see that on the basis of sepal width all species are tight overlapping","f468022f":"Now let us see how are the length and width are distributed","13ef1240":"Finding the shape of data. Total no of rows and columns.","cdb3ab01":"Support Vector Machine (SVM)","9ece0c59":"Some Exploratory Data Analysis With Iris","8df14371":"Lets check the Train and Test Dataset","41a06e33":"# **Iris DataSet Information**\n\nIris is a genus of 260\u2013300 species of flowering plants with showy flowers. Iris is also widely used as a common name for all Iris species, as well as some belonging to other closely related genera. Iris is extensively grown as ornamental plant in home and botanical gardens. The Iris flowers color ranges from white, pink, orange, purple, lavender.\n\n**Date contains following Attributes:**\n1. sepal Length in CM\n2. sepal width in CM\n3. Petal Length In CM\n4. Petal length In CM\n5. Species:1-Iris Setosa 2-Iris Versicolour 3-Iris Virginica\n\n","5e6c073e":"# **Observations:**\n\n* Using Petals over Sepal for training the data gives a much better accuracy.\n* This was expected as we saw in the heatmap above that the correlation between the Sepal Width and Length was very low whereas the correlation between Petal Width and Length was very high.\n* Thank You!!","4e87139d":"# **Preview of Data**\n1. There are 150 observations with 4 features each (sepal length, sepal width, petal length, petal width).\n2. There are no null values, so we don't have to worry about that.\n3. There are 50 observations of each species (setosa, versicolor, virginica).","510e3bcd":"K-Nearest is giving very good accuracy.","5a10073b":"Let's check count for each species.","25ff7e4b":"Load the dataset now","d0997dd7":"K-Nearest Neighbours","150e0ca5":"Logistic Regression","90022e88":"Now let us see how the length and width vary according to the species","d080f516":"* We can see here iris data set is a balanced dataset. The Iris dataset consists of 150 data instances. Each have 50 instances \n\n**There are 3 classes(Features)**\n* Iris Setosa,\n* Iris Versicolor\n* Iris Virginica \n","2bc5f670":"Checking first  and last records from the datasets","ecb60f7c":"**From above plot we can see that,**\n\nIn case of sepal length & sepal width, setosa is easily seperable but versicolor & virginica have some overlap.\nIn case of petal length & petal width, all the species are quite seperable. And the useful features to distinguish flower types.","a81056ed":"From above plot, we see that on the basis of petal length setosa is separable while the other two are overlapping","8ef8c6ea":"Fin out the information of the data.","4d284261":"Together, the first two principal components contain 95.80% of the information. The first principal component contains 72.77% of the variance and the second principal component contains 23.03% of the variance. The third and fourth principal component contained the rest of the variance of the dataset.","183d24b4":"From above plot, we see that on the basis of sepal length all species are overlapping"}}