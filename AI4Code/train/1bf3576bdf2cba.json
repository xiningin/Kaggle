{"cell_type":{"b273b222":"code","7b62aaf2":"code","b86319ad":"code","2228a236":"code","47aec2db":"code","f4111be2":"code","91812b83":"code","6546377f":"code","312e7a6e":"code","5cb5eec7":"markdown","4f28de61":"markdown","1515405a":"markdown"},"source":{"b273b222":"!pip install tez","7b62aaf2":"import os\n\nimport tez\nimport torch\nimport torch.nn as nn\nimport torchvision\nimport pandas as pd\nimport albumentations\nimport matplotlib.pyplot as plt\n\nfrom tez.datasets import ImageDataset\nfrom tez.callbacks import EarlyStopping\nfrom torch.nn import functional as F\n\nfrom sklearn import metrics, model_selection, preprocessing\n\n%matplotlib inline","b86319ad":"dfx = pd.read_csv('..\/input\/dlub-summer-school-challenge-2021\/train.csv')\ndf_train, df_valid = model_selection.train_test_split(\n        dfx, test_size=0.1, random_state=42, stratify=dfx.category_id.values\n)\n\ndf_train = df_train.reset_index(drop=True)\ndf_valid = df_valid.reset_index(drop=True)\n\nimage_path = \"..\/input\/dlub-summer-school-challenge-2021\/train\/train\"\ntrain_image_paths = [os.path.join(image_path, x) for x in df_train.filename.values]\nvalid_image_paths = [os.path.join(image_path, x) for x in df_valid.filename.values]\ntrain_targets = df_train.category_id.values\nvalid_targets = df_valid.category_id.values","2228a236":"train_dataset = ImageDataset(\n    image_paths=train_image_paths,\n    targets=train_targets,\n    augmentations=None,\n)\n\nvalid_dataset = ImageDataset(\n    image_paths=valid_image_paths,\n    targets=valid_targets,\n    augmentations=None,\n)","47aec2db":"train_dataset[0]","f4111be2":"def plot_image(img_dict):\n    image_tensor = img_dict[\"image\"]\n    target = img_dict[\"targets\"]\n    print(target)\n    plt.figure(figsize=(10, 10))\n    image = image_tensor.permute(1, 2, 0) \/ 255\n    plt.imshow(image)","91812b83":"plot_image(train_dataset[0])","6546377f":"train_aug = albumentations.Compose(\n    [\n        albumentations.RandomResizedCrop(256, 256),\n        albumentations.Transpose(p=0.5),\n        albumentations.HorizontalFlip(p=0.5),\n        albumentations.VerticalFlip(p=0.5),\n        albumentations.ShiftScaleRotate(p=0.5),\n    ]\n)\n\n# resizing via augmentations\ntrain_dataset = ImageDataset(\n    image_paths=train_image_paths,\n    targets=train_targets,\n    augmentations=train_aug,\n)","312e7a6e":"plot_image(train_dataset[0])","5cb5eec7":"# Data Augmentations","4f28de61":"# Original Image","1515405a":"# Read csv, split & create dataset"}}