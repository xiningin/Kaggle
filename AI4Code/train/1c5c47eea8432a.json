{"cell_type":{"5da61aea":"code","dfb70656":"code","029f92b1":"code","49005dc8":"code","9acf5eec":"code","ec4f7a59":"code","78e5e620":"code","0d942f05":"code","360d94f4":"code","a7a81da2":"code","e42044b7":"code","6e4ab9af":"code","f288e069":"code","b9999f78":"code","621e2895":"code","e069deb2":"code","a8c6af29":"code","76aae799":"code","7472acc4":"code","0726757c":"code","802af751":"code","81923930":"code","1e97813d":"code","12e1cb44":"code","7353da07":"code","5785ca72":"code","0fd2697d":"code","0fcf1586":"code","abf404bd":"code","38d20bab":"code","c0019c97":"code","5ba117b2":"code","4e854b2f":"code","dd8ffd88":"code","cb94fe5b":"code","631c6114":"code","3c9465d8":"code","ce770c98":"code","bba1a491":"code","dff6752b":"code","5f02eda4":"markdown","7296b0db":"markdown","0752dd1d":"markdown","d1c1515c":"markdown","c505f9a7":"markdown","eb396867":"markdown","2404326d":"markdown","5be13068":"markdown","9fefd608":"markdown","fd48f0c3":"markdown","420273f0":"markdown","cffb3180":"markdown","65196648":"markdown","6b610ec0":"markdown","e8bc8f61":"markdown","33855639":"markdown","73f8cb3e":"markdown","978a458b":"markdown","06186a1d":"markdown","21923895":"markdown","cdc3b7af":"markdown","e8a4d5f1":"markdown","e0c10fd0":"markdown","4b7cc334":"markdown","8463a229":"markdown","ad5612f3":"markdown","17f33a77":"markdown","3efd73ec":"markdown"},"source":{"5da61aea":"\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns","dfb70656":"\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","029f92b1":"train = pd.read_csv(\"\/kaggle\/input\/tabular-playground-series-jan-2022\/train.csv\")\ntest = pd.read_csv(\"\/kaggle\/input\/tabular-playground-series-jan-2022\/test.csv\")\nsubmission = pd.read_csv(\"\/kaggle\/input\/tabular-playground-series-jan-2022\/sample_submission.csv\")","49005dc8":"train","9acf5eec":"test","ec4f7a59":"submission","78e5e620":"sns.distplot(train['num_sold'])","0d942f05":"for x in ['num_sold']:\n    q75,q25 = np.percentile(train.loc[:,x],[75,25])\n    intr_qr = q75-q25\n \n    max = q75+(2.5*intr_qr)\n    min = q25-(2.5*intr_qr)\n \n    train.loc[train[x] < min,x] = np.nan\n    train.loc[train[x] > max,x] = np.nan\n","360d94f4":"train['num_sold'].isnull().sum()\n","a7a81da2":"\ntrain = train.dropna(axis = 0)\ntrain\n","e42044b7":"target = train['num_sold']\n\nsns.distplot(train['num_sold'])","6e4ab9af":"combi = train.drop(['num_sold'], axis=1).append(test)\ncombi","f288e069":"combi = combi.drop(['row_id'], axis=1)\ncombi","b9999f78":"combi.isnull().sum()","621e2895":"combi['date'] = pd.to_datetime(combi['date'], errors='coerce')\ncombi","e069deb2":"from datetime import datetime\n\ncombi[\"day_of_week\"] = combi['date'].dt.dayofweek\ncombi[\"weekend\"] = combi['day_of_week'] > 4\n\ncombi","a8c6af29":"combi['weekend'] = combi['weekend']* 1\ncombi","76aae799":"sns.displot(combi['day_of_week'])","7472acc4":"combi['year'] = combi['date'].dt.year\ncombi['month'] = combi['date'].dt.month\ncombi['day'] = combi['date'].dt.day\n\ncombi","0726757c":"if combi['month'] is 12 and combi['day'] is 25:\n    combi['xmas1'] = True\nelse:\n    combi['xmas1'] = False\n\ncombi['xmas1'] = combi['xmas1'] * 1\n\ncombi","802af751":"if combi['month'] is 12 and combi['day'] is 26:\n    combi['xmas2'] = True\nelse:\n    combi['xmas2'] = False\n\ncombi['xmas2'] = combi['xmas2'] * 1\n\ncombi","81923930":"if combi['month'] is 1 and combi['day'] is 1:\n    combi['new_year'] = True\nelse:\n    combi['new_year'] = False\n\ncombi['new_year'] = combi['new_year'] * 1\n\ncombi","1e97813d":"if combi['year'] is 2015 and combi['month'] is 4 and combi['day'] is 3:\n    combi['good_friday'] = True\nelif combi['year'] is 2016 and combi['month'] is 3 and combi['day'] is 25:\n    combi['good_friday'] = True\nelif combi['year'] is 2017 and combi['month'] is 4 and combi['day'] is 14:\n    combi['good_friday'] = True\nelif combi['year'] is 2018 and combi['month'] is 3 and combi['day'] is 30:\n    combi['good_friday'] = True\nelif combi['year'] is 2019 and combi['month'] is 4 and combi['day'] is 19:\n    combi['good_friday'] = True\nelse:\n    combi['good_friday'] = False\n\ncombi['good_friday'] = combi['good_friday'] * 1\n\ncombi","12e1cb44":"if combi['year'] is 2015 and combi['month'] is 4 and combi['day'] is 5:\n    combi['easter'] = True\nelif combi['year'] is 2016 and combi['month'] is 3 and combi['day'] is 27:\n    combi['easter'] = True\nelif combi['year'] is 2017 and combi['month'] is 4 and combi['day'] is 16:\n    combi['easter'] = True\nelif combi['year'] is 2018 and combi['month'] is 4 and combi['day'] is 1:\n    combi['easter'] = True\nelif combi['year'] is 2019 and combi['month'] is 4 and combi['day'] is 21:\n    combi['easter'] = True\nelse:\n    combi['easter'] = False\n\ncombi['easter'] = combi['easter'] * 1\n\ncombi","7353da07":"if combi['year'] is 2015 and combi['month'] is 4 and combi['day'] is 6:\n    combi['easter_monday'] = True\nelif combi['year'] is 2016 and combi['month'] is 3 and combi['day'] is 28:\n    combi['easter_monday'] = True\nelif combi['year'] is 2017 and combi['month'] is 4 and combi['day'] is 17:\n    combi['easter_monday'] = True\nelif combi['year'] is 2018 and combi['month'] is 4 and combi['day'] is 2:\n    combi['easter_monday'] = True\nelif combi['year'] is 2019 and combi['month'] is 4 and combi['day'] is 22:\n    combi['easter_monday'] = True\nelse:\n    combi['easter_monday'] = False\n\ncombi['easter_monday'] = combi['easter_monday'] * 1\n\ncombi","5785ca72":"from sklearn import preprocessing\nfrom sklearn.preprocessing import OrdinalEncoder\n\nenc = OrdinalEncoder()\n\nfor col in combi:\n    if combi[col].dtype==\"object\":\n        combi[col] = enc.fit_transform(combi[col].values.reshape(-1,1))\ncombi\n","0fd2697d":"import datetime \n\ncombi['date_num'] = combi['date'].dt.strftime('%d%m%Y')\ncombi['date_num'] = combi['date_num'].astype(int)\ncombi","0fcf1586":"combi.drop(['date'], axis=1, inplace=True)\ncombi.drop(['year'], axis=1, inplace=True)\ncombi","abf404bd":"combi.isnull().sum()","38d20bab":"#combi = (combi - combi.min()) \/ (combi.max() - combi.min())\n#combi","c0019c97":"#combi = (combi - np.average(combi)) \/ (np.std(combi))\n#combi","5ba117b2":"y = target\nX = combi[: len(train)]\nX_test = combi[len(train) :]","4e854b2f":"from sklearn.model_selection import train_test_split\n\nX_train, X_val, y_train, y_val = train_test_split(X, y, test_size=0.1, random_state=42)\nX_train.shape, X_val.shape, y_train.shape,y_val.shape, X_test.shape","dd8ffd88":"from sklearn.experimental import enable_hist_gradient_boosting \nfrom sklearn.ensemble import HistGradientBoostingRegressor\n\nmodel = HistGradientBoostingRegressor().fit(X_train, y_train)\nprint(model.score(X_train, y_train))","cb94fe5b":"y_pred = model.predict(X_val)\nprint(model.score(X_val, y_val))","631c6114":"from sklearn.metrics import mean_squared_error\n\nrmse = mean_squared_error(y_val, y_pred, squared=False)\nrmse","3c9465d8":"df=pd.DataFrame({'Actual': y_val, 'Predicted':y_pred})\ndf","ce770c98":"fig, ax = plt.subplots()\nax.scatter(y_val, y_pred, edgecolors=(0, 0, 0))\nax.plot([y.min(), y.max()], [y.min(), y.max()], 'k--', lw=4)\nax.set_xlabel('Measured')\nax.set_ylabel('Predicted')\nplt.show()","bba1a491":"preds = model.predict(X_test)\npreds = preds.astype(int)\npreds[preds < 0] = 0\npreds","dff6752b":"submission.num_sold = preds\nsubmission.to_csv('submission.csv', index=False)\nsubmission = pd.read_csv(\"submission.csv\")\nsubmission","5f02eda4":"Ordinal encode","7296b0db":"Standardise combi","0752dd1d":"Remove outliers","d1c1515c":"Load","c505f9a7":"Check for Easter","eb396867":"Check for new year","2404326d":"Predict on validation set","5be13068":"Datestamp date","9fefd608":"Check for null values","fd48f0c3":"Analyse target","420273f0":"Predict on test set and submit","cffb3180":"Import","65196648":"drop id","6b610ec0":"Check if date is weekend","e8bc8f61":"Split","33855639":"Combine train and test","73f8cb3e":"Read","978a458b":"Convert boolean to integar","06186a1d":"Drop date and year","21923895":"Check for null values","cdc3b7af":"Convert date to number","e8a4d5f1":"Problem statement:-\n\nThere are two (fictitious) independent store chains selling Kaggle merchandise that want to become the official outlet for all things Kaggle. We've decided to see if the Kaggle community could help us figure out which of the store chains would have the best sales going forward. So, we've collected some data and are asking you to build forecasting models to help us decide.\n\nHelp us figure out whether KaggleMart or KaggleRama should become the official Kaggle outlet!","e0c10fd0":"Define model","4b7cc334":"Check for christmas 2","8463a229":"Define X and y","ad5612f3":"Check for Christmas 1","17f33a77":"Get month and day from date","3efd73ec":"Normalise "}}