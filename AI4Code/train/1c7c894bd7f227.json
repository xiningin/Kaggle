{"cell_type":{"87638d25":"code","ba9b7b03":"code","07f99871":"code","9a22e84a":"code","6ec9423f":"code","7b68a3e7":"code","d105aa3c":"code","69ee1cd1":"code","bda76118":"code","88abc352":"code","f61efc14":"code","cf549de9":"code","ff32fc61":"code","f53decea":"code","dfc7b310":"code","8f082362":"code","d8f61bdf":"code","fc5c0893":"code","e0df9558":"code","89ef1b6b":"code","037e97af":"code","7d42c677":"code","b93429e8":"code","75660dc7":"code","bdf31033":"code","60b595e5":"code","29fd4468":"code","3b11c9e7":"code","b0545218":"code","26de982b":"code","bef3f186":"code","d788e621":"code","4ed9eaad":"code","756ffd03":"code","a4e8f2c1":"code","4569a0d4":"code","4b93bbaa":"code","7f71666b":"code","17c15ee9":"code","e8f4fb87":"code","aabec7ae":"code","2b72b480":"code","c9ef7994":"code","fa1292de":"code","2b9b92a5":"code","6754cc37":"code","5e349f70":"code","68ef8477":"code","c1262b24":"code","c7bd88a2":"markdown","1a183df6":"markdown","8270d1bc":"markdown","3f78f4e5":"markdown","0a1a7648":"markdown","81228167":"markdown","470e1ff8":"markdown","5716d6e0":"markdown","55ec4f7d":"markdown","4b30f6c2":"markdown","c1b1f807":"markdown","c4c207e7":"markdown","b9ab771f":"markdown","e8bfbd18":"markdown","59b25666":"markdown","e758c18a":"markdown","9aab207a":"markdown","6b53f2ef":"markdown","b0597bbc":"markdown","df93fd72":"markdown","981014e4":"markdown"},"source":{"87638d25":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport json\nimport altair as alt\n\nfrom collections import Counter, OrderedDict\nfrom IPython.display import HTML\nfrom altair.vega import v3\n#alt.renderers.enable('notebook')\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","ba9b7b03":"##-----------------------------------------------------------\n# This whole section \nvega_url = 'https:\/\/cdn.jsdelivr.net\/npm\/vega@' + v3.SCHEMA_VERSION\nvega_lib_url = 'https:\/\/cdn.jsdelivr.net\/npm\/vega-lib'\nvega_lite_url = 'https:\/\/cdn.jsdelivr.net\/npm\/vega-lite@' + alt.SCHEMA_VERSION\nvega_embed_url = 'https:\/\/cdn.jsdelivr.net\/npm\/vega-embed@3'\nnoext = \"?noext\"\n\npaths = {\n    'vega': vega_url + noext,\n    'vega-lib': vega_lib_url + noext,\n    'vega-lite': vega_lite_url + noext,\n    'vega-embed': vega_embed_url + noext\n}\n\nworkaround = \"\"\"\nrequirejs.config({{\n    baseUrl: 'https:\/\/cdn.jsdelivr.net\/npm\/',\n    paths: {}\n}});\n\"\"\"\n\n#------------------------------------------------ Defs for future rendering\ndef add_autoincrement(render_func):\n    # Keep track of unique <div\/> IDs\n    cache = {}\n    def wrapped(chart, id=\"vega-chart\", autoincrement=True):\n        if autoincrement:\n            if id in cache:\n                counter = 1 + cache[id]\n                cache[id] = counter\n            else:\n                cache[id] = 0\n            actual_id = id if cache[id] == 0 else id + '-' + str(cache[id])\n        else:\n            if id not in cache:\n                cache[id] = 0\n            actual_id = id\n        return render_func(chart, id=actual_id)\n    # Cache will stay outside and \n    return wrapped\n            \n@add_autoincrement\ndef render(chart, id=\"vega-chart\"):\n    chart_str = \"\"\"\n    <div id=\"{id}\"><\/div><script>\n    require([\"vega-embed\"], function(vg_embed) {{\n        const spec = {chart};     \n        vg_embed(\"#{id}\", spec, {{defaultStyle: true}}).catch(console.warn);\n        console.log(\"anything?\");\n    }});\n    console.log(\"really...anything?\");\n    <\/script>\n    \"\"\"\n    return HTML(\n        chart_str.format(\n            id=id,\n            chart=json.dumps(chart) if isinstance(chart, dict) else chart.to_json(indent=None)\n        )\n    )\n\nHTML(\"\".join((\n    \"<script>\",\n    workaround.format(json.dumps(paths)),\n    \"<\/script>\",\n    \"This code block sets up embedded rendering in HTML output and<br\/>\",\n    \"provides the function `render(chart, id='vega-chart')` for use below.\"\n)))","07f99871":"# Create matches and deliveries DataFrames\nmatches = pd.read_csv(\"..\/input\/matches.csv\")\ndeliveries = pd.read_csv(\"..\/input\/deliveries.csv\")","9a22e84a":"matches.head()","6ec9423f":"deliveries.head()","7b68a3e7":"# Check the number of rows and columns in matches dataset\nmatches.shape","d105aa3c":"# Check the number of rows and columns in deliveries dataset\ndeliveries.shape","69ee1cd1":"# Check if there are any null value columns.\nmatches.isnull().sum()","bda76118":"# Drop Umpire3 column from matches dataframe.\nmatches.drop(['umpire3'],axis=1,inplace=True)","88abc352":"# Validate to see the umpire3 column has been dropped.\n\nmatches.columns","f61efc14":"# Teams played in IPL from 2008 to 2017\n\nnp.unique(np.concatenate((matches['team1'].unique(), matches['team2'].unique()), axis=0))","cf549de9":"# How many unique teams have played IPL till now?\n\nprint(\"There are {} teams played in IPL till 2017 season\".format(len(np.unique(np.concatenate((matches['team1'].unique(), matches['team2'].unique()), axis=0)))))","ff32fc61":"# What are the seasons available to us?\nnp.sort(matches['season'].unique())","f53decea":"# Modify the team names in matches DataFrame to their short forms.\n\nmatches.replace(['Chennai Super Kings', 'Deccan Chargers', 'Delhi Daredevils',\n       'Gujarat Lions', 'Kings XI Punjab', 'Kochi Tuskers Kerala',\n       'Kolkata Knight Riders', 'Mumbai Indians', 'Pune Warriors',\n       'Rajasthan Royals', 'Rising Pune Supergiant',\n       'Rising Pune Supergiants', 'Royal Challengers Bangalore',\n       'Sunrisers Hyderabad'],\n               ['CSK', 'DC', 'DD', 'GL', 'KXIP', 'KTK', 'KKR', 'MI', 'PW', 'RR', 'RPS', 'RPS', 'RCB', 'SRH'],inplace=True)\n","dfc7b310":"# Modify the team names in deliveries DataFrame to their short forms.\n\ndeliveries.replace(['Chennai Super Kings', 'Deccan Chargers', 'Delhi Daredevils',\n       'Gujarat Lions', 'Kings XI Punjab', 'Kochi Tuskers Kerala',\n       'Kolkata Knight Riders', 'Mumbai Indians', 'Pune Warriors',\n       'Rajasthan Royals', 'Rising Pune Supergiant',\n       'Rising Pune Supergiants', 'Royal Challengers Bangalore',\n       'Sunrisers Hyderabad'],\n               ['CSK', 'DC', 'DD', 'GL', 'KXIP', 'KTK', 'KKR', 'MI', 'PW', 'RR', 'RPS', 'RPS', 'RCB', 'SRH'],inplace=True)","8f082362":"# Total number of matches played in IPL till end of 2017 season.\n\nprint(\"Total Matches played: \", matches.shape[0])","d8f61bdf":"# Cities at which the IPL matches were played.\n\nprint(\" \\n Cities Played at: \", matches['city'].dropna().unique())","fc5c0893":"# Unique teams played in IPL\n\nprint(\" \\n Unique teams played: \",np.unique(np.concatenate((matches['team1'].unique(), matches['team2'].unique()), axis=0)))","e0df9558":"# Number of Unique teams played in IPL\nprint(\" \\n Number of Unique teams played: \", len(matches['team1'].unique()))","89ef1b6b":"# Venues where the IPL MATCHES were played \n    \nprint (\"Venues for IPL matches:\\n\")\nfor i in matches['venue'].unique():\n    print(i)","037e97af":"# Number of unique venues\nprint(\"Number of Unique Venues used:\", matches['venue'].nunique())","7d42c677":"# Number of Unique cities \nprint(\"Number of Unique cities played at: \", matches[\"city\"].nunique())","b93429e8":"#  Which team has won the toss most times.\nmatches['toss_winner'].value_counts()","75660dc7":"matches['toss_winner'].value_counts().idxmax()","bdf31033":"# Which team has won the match most times.\n\nmost_match_winnning_team = matches['winner'].value_counts().idxmax()\nprint(\"{} has won the matches most number of times.\".format(most_match_winnning_team))","60b595e5":"# Which city has hosted most IPL matches\n\nmost_matches_hosting_city = matches['city'].value_counts().idxmax()\nprint(\"{} has hosted most IPL matches.\".format(most_matches_hosting_city))","29fd4468":"# Who has won player of the match most?\n\nmost_times_player = matches['player_of_match'].value_counts().idxmax()\nprint(\"'{}' was the player of match most times across IPL Seasons\".format(most_times_player))","3b11c9e7":"# Finding Maximum win_by_runs from all the seasons.\n\nmatches['win_by_runs'].max()","b0545218":"# What were the teams participated in the 146 win by runs match.\n\nwbr = matches.iloc[[matches['win_by_runs'].idxmax()]]\nwbr[['season', 'team1', 'team2', 'toss_winner', 'winner','win_by_wickets', 'win_by_runs']]","26de982b":"# Finding maximum win_by_wickets from all seasons.\n# Showing only few columns for that row.\n\nwbw = matches.iloc[[matches['win_by_wickets'].idxmax()]]\nwbw[['season', 'team1', 'team2', 'toss_winner', 'winner', 'win_by_wickets', 'win_by_runs']]\n","bef3f186":"chart = alt.Chart(matches).mark_bar().encode(\n# alt.X('season:N', scale=alt.Scale(rangeStep=50), axis=alt.Axis(title='IPL Seasons')),\n    alt.X('season:N', scale=alt.Scale(rangeStep=50), axis=alt.Axis(title='IPL Seasons')),\n    alt.Y('count(id)', axis=alt.Axis(title='Number of matches')),\n    color=alt.Color('season', scale=alt.Scale(scheme='plasma'), legend=None),\n    tooltip=['season', alt.Tooltip('count(id)', title='Number of Matches')]\n#color=alt.condition(if_false=)\n).configure_axis(\n    domainWidth=1,\n    titleFontSize=20,\n    labelFontSize=15\n).properties(\n    height=450,\n    width=600,\n    title='Number of Matches played in each season')\n","d788e621":"render(chart, id='vega-chart')","4ed9eaad":"# Toss Decisions across Seasons\nchart = alt.Chart(matches).mark_bar().encode(\n    alt.X('toss_decision', axis=alt.Axis(title='')),\n    alt.Y('count(id)', axis=alt.Axis(title='Number of decisions')),\n    column='season',\n    color=alt.Color('toss_decision',title='Toss Decision'),\n    tooltip=['season', alt.Tooltip('count(id)', title='Count')]\n).configure_axis(\n    domainWidth=1,\n    titleFontSize=20,\n    labelFontSize=15\n).properties(height=400, width=50).configure_view(\n    stroke='transparent'\n)\nrender(chart, id='vega-chart')","756ffd03":"# Validate above result by finding the number of \"field\" and \"bat\" toss_decisions \nmatches.loc[(matches['season']==2008) & (matches['toss_decision']=='field')].shape","a4e8f2c1":"matches.loc[(matches['season']==2008) & (matches['toss_decision']=='bat')].shape","4569a0d4":"# Number of times each team has won Toss\n\nmatches['toss_winner'].value_counts()\n\n","4b93bbaa":"# Maximum Times Toss winner across seasons\nchart=alt.Chart(matches).mark_bar().encode(\n    alt.X('toss_winner', sort=alt.EncodingSortField(field='count():Q', op='count', order='descending'), axis=alt.Axis(title='Toss Winning Team')),\n#     x = \"np.sort(matches['toss_winner'].value_counts()):N\",\n    alt.Y('count()', axis=alt.Axis(title='Number of Toss Wins')),\n#     color = 'toss_winner',\n    color = alt.Color('toss_winner', title='Toss Winner', scale=alt.Scale(scheme='viridis')),\n    order = alt.Order( 'count()', sort = 'ascending'),\n    tooltip = [alt.Tooltip('toss_winner', title='Toss Winner'), alt.Tooltip('count(id)', title='count')]\n).configure_axis(\n    domainWidth=1,\n    labelFontSize=15,\n    titleFontSize=20\n).properties(height=400, width=600, title='Toss Winners Across Seasons')\nrender(chart, id='vega-chart')","7f71666b":"mpt = pd.concat([matches['team1'], matches['team2']])\nmpt = mpt.value_counts().reset_index()\nmpt.columns = ['Team', 'Number_of_matches_played']\nmpt['wins']=matches['winner'].value_counts().reset_index()['winner']\n\ntotal_matches_played = alt.Chart(mpt).mark_bar().encode(\n    alt.X('Team',axis=alt.Axis(title='Teams Played in IPL'), sort=alt.EncodingSortField(field='Number_of_matches_played:Q', op='count', order='ascending')),  \n    alt.Y('Number_of_matches_played:Q', axis=alt.Axis(title='Matches Played') ),\n    tooltip=['Team', alt.Tooltip('sum(Number_of_matches_played)', title='Total Matches Played')],\n).properties(height=400, width=600)\n\nwins = alt.Chart(mpt).mark_bar(color='orange').encode(\n    alt.X('Team',axis=alt.Axis(title='Teams Played in IPL'), sort=alt.EncodingSortField(field='Number_of_matches_played:Q', op='count', order='ascending')), \n    alt.Y('wins', axis=alt.Axis(title='Wins')), \n    tooltip=['Team', alt.Tooltip('sum(wins)', title='Matches Won')],\n).properties(height=400, width=600)\n\nchart = alt.layer(total_matches_played, wins, title='Total Matches Played vs Total Wins')\nrender(chart, id='vega-chart')","17c15ee9":"deliveries_by_season = matches[['id', 'season']].merge(deliveries, left_on='id', right_on='match_id', how='left').drop('id', axis=1)","e8f4fb87":"runsBySeason = deliveries_by_season.groupby(['season'])['total_runs'].sum().reset_index()","aabec7ae":"# Runs across the Seasons\nchart=alt.Chart(runsBySeason).mark_line(point=True).encode(\n    alt.X('season:N', axis=alt.Axis(title='IPL Seasons')),\n    alt.Y('total_runs:Q', scale=alt.Scale(zero=False),axis=alt.Axis(title='Total Runs')),\n    tooltip=['season', alt.Tooltip('total_runs', title='Runs Scored')]\n    ).configure_axis(\n    domainWidth=1,\n    labelFontSize=15,\n    titleFontSize=20\n).properties(height=400, width=600, title='Total Runs scored in each Season')\nrender(chart, id='vega-chart')","2b72b480":"avgRuns = matches.groupby(['season']).count().id.reset_index()\navgRuns.rename(columns={'id':'num_matches'}, inplace=True)\navgRuns['total_runs'] = runsBySeason['total_runs']\navgRuns['avg_runs_this_season']=avgRuns['total_runs']\/avgRuns['num_matches']\n","c9ef7994":"chart=alt.Chart(avgRuns).mark_line(point=True).encode(\n    alt.X('season:N', scale=alt.Scale(zero=False), axis=alt.Axis(title='IPL Seasons')),\n    alt.Y('avg_runs_this_season:Q', scale=alt.Scale(zero=False), axis=alt.Axis(title='Average runs')),\n    tooltip=['season', alt.Tooltip('avg_runs_this_season', title='Average Runs')]\n    ).configure_axis(\n        domainWidth=1,\n        labelFontSize=15,\n        titleFontSize=20\n        ).properties(height=400, width=600, title='Average Runs scored across seasons')\nrender(chart, id='vega-chart')","fa1292de":"# Below command is used to bypass the error\n#(MaxRowsError: The number of rows in your dataset is greater than the maximum allowed (5000). \n# For information on how to plot larger datasets in Altair, see the documentation)\n\n#alt.data_transformers.enable('json')\nalt.data_transformers.enable('default', max_rows=None)","2b9b92a5":"# Sixes and Fours Across the Season\n\nboundaries = deliveries_by_season[(deliveries_by_season['batsman_runs'] == 4) | (deliveries_by_season['batsman_runs'] == 6)]\n\nchart=alt.Chart(boundaries).mark_line(point=True).encode(\n    alt.X('season:N', axis=alt.Axis(title='IPL Seasons')),\n    alt.Y('count()', axis=alt.Axis(title='Number of Boundaries')),\n    tooltip=(alt.Tooltip('season',title='season'), alt.Tooltip('count()', title='boundaries')),\n    color=alt.Color('batsman_runs:O', legend=alt.Legend(title='Boundaries'), scale=alt.Scale(domain=[4,6], range=['green', 'blue'])),    \n).configure_axis(\n    domainWidth=1,\n    labelFontSize=15,\n    titleFontSize=20\n).properties(width=600, height=400, title='Boundaries across IPL Seasons')\n\nrender(chart, id='vega-chart')\n","6754cc37":"# Favorite Grounds\nchart=alt.Chart(matches).mark_bar().encode(\n    alt.Y('venue:O', sort=alt.EncodingSortField(field='count():Q', op='count', order='descending')),\n    alt.X('count():Q'),\n    color=alt.Color('count():Q', scale=alt.Scale(scheme='purpleorange'), legend=None),\n    tooltip=[ 'venue', alt.Tooltip('count()', title='number of matches'), 'city']\n    ).configure_axis(\n    domainWidth=5,\n    labelFontSize=15,\n    titleFontSize=20\n    ).properties(height=700, width=600, title='Favourite Grounds for IPL')\nrender(chart, id='vega-chart')","5e349f70":"# Maximum Man Of Matches\n\nchart=alt.Chart(matches).mark_bar().encode(\n    alt.Y('count():Q', axis=alt.Axis(title='Number of Titles')),\n    alt.X('player_of_match:O',  axis=alt.Axis(title='Man of the Match'), sort=alt.EncodingSortField(field='count():Q', op='count', order='descending' )),\n    alt.Color('count():Q', scale=alt.Scale(scheme='viridis'), legend=None),\n    tooltip=(alt.Tooltip('player_of_match:O', title='player'), alt.Tooltip('count():Q', title='number of titles')),\n    ).configure_axis(\n        domainWidth=1,\n        titleFontSize=20\n    ).properties(height=700, width=2500, title='Man of the match')\nrender(chart, id='vega-chart')","68ef8477":"top_20_players = matches['player_of_match'].value_counts().head(20).reset_index()\n\ntop_20_players.columns=('Player', 'Number_of_Titles')","c1262b24":"# top 20 \"man of the match\" winners\n\nchart=alt.Chart(top_20_players).mark_bar().encode(\n    alt.X('Number_of_Titles:Q', axis=alt.Axis(title='Number of Awards'), ),\n    alt.Y('Player:O', axis=alt.Axis(title='Man of the Match'), sort=alt.EncodingSortField(field='Number_of_Titles', op='count')),\n    alt.Color('Number_of_Titles:Q', scale=alt.Scale(scheme='purpleorange'), legend=None),\n    tooltip=['Player:O', alt.Tooltip('Number_of_Titles:Q', title='Number of awards')]\n    ).configure_axis(\n        domainWidth=1,\n        labelFontSize=15,\n        titleFontSize=20).properties(height=600, width=600)\nrender(chart, id='vega-chart')","c7bd88a2":"Kaggle does not work with altair provided 'notebook' renderer. We need to create custom renderer for kaggle. Source for my implementation is found [here](https:\/\/www.kaggle.com\/notslush\/altair-visualization-2018-stackoverflow-survey) ","1a183df6":"## Maximum Times Toss Winner across Seasons","8270d1bc":"* We have data available for IPL seasons from 2008 till 2017.","3f78f4e5":"## Total Matches Played vs Total Matches Won","0a1a7648":"## Who Won Maximum Man of the Matches","81228167":"## Boundaries scored in each IPL Season","470e1ff8":"**'KKR' has won match against 'GL' by 10 wickets during the 2017 IPL season. This is the maximum win by wickets across IPL seasons. **","5716d6e0":"   ## Number of Matches played in each season","55ec4f7d":"**Exploring India Ka Tyohaar - IPL with Altair**\n\n\nFor all the cricket fans in india IPL is like a festival. During the period of IPL matches, wherever you go, you can hear somebody talking about the matches and players skills. Everyone want to analyze the IPL matches to understand the trends and performance of different teams in IPL.  I have made an effort to analyze the IPL dataset using Altair visualization library. \n\nThe reason for choosing Altair visualizaion library for this exercise is because of its declarative nature and also as it uses vega-lite visualization grammer. Because of its declarative nature, it becomes easy for the developers to reduce the coding but at the same time ploting a graph with all required fields and features.\n\nMost of the plots in the notebook are interactive, meaning on hovering the mouse on the plot, you can see the required information being displayed. \n\nI will keep adding more graphs that will help others to understand the IPL data better. \n\nPlease Upvote if you like the notebook.  Thanks.","4b30f6c2":"## Runs scored across IPL seasons","c1b1f807":"## Favourite Grounds for IPL","c4c207e7":"## Average Runs scored in each season","b9ab771f":"## Top 20 Man of the Match awardees","e8bfbd18":"## Toss Decisions across Seasons","59b25666":"**MI has won the toss maximum times across IPL seasons.**","e758c18a":"**From the above result, it is clear that city, winner, player_of_match, umpire1, umpire2 and umpire3 columns have null values. But \"umpire3\" entirely is null. Matches dataset has 636 rows and \"umpire3\" column has 636 missing values, which means, \"umpire3\" column does not have any value. So, \"umpire3\" colum can be dropped.**","9aab207a":"A team has won on another team by a record 146 runs. This is the maximum win by runs  across IPL seasons.","6b53f2ef":"**'CH Gayle' is the top 'Man of the Match' awardee across IPL seasons. He has won the award for 18 times.**","b0597bbc":"\nMumbai Indians has won the toss most of the times through out the IPL history","df93fd72":"**'MI' has won the match against 'DD' by 146 runs during the 2017 IPL season and this the record highest win by runs though out IPL history.**","981014e4":"**Thanks for your time to scroll though. Hope you had good time here. I will add more visualizations soon.**\n"}}