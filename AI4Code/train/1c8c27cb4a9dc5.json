{"cell_type":{"199e6611":"code","c58d85f1":"code","9bb56916":"code","2e4c06e9":"code","2685ec6b":"code","47a23c40":"code","7a81c924":"code","0dfc0320":"code","89f7a411":"code","c8d9cd55":"code","4dcf06fb":"code","ebbf3346":"code","fc80f494":"code","1dbd2052":"code","27bc2181":"code","82641c89":"code","4977d337":"code","9dfe4712":"code","98a23a59":"code","701a5dc9":"code","fe03ac88":"code","6651701e":"code","0d3315ef":"code","852226b5":"markdown","f4c82fe2":"markdown","5946e610":"markdown","cf3c412b":"markdown","d4b5234c":"markdown","7054a94d":"markdown"},"source":{"199e6611":"!curl -s https:\/\/course.fast.ai\/setup\/colab | bash\nfrom fastai.vision import *\nfrom fastai.tabular import *\nfrom pathlib import Path","c58d85f1":"cp -R \/kaggle\/input\/platesv2\/plates\/plates \/kaggle\/input\/plate","9bb56916":"ls \/kaggle\/input\/plate","2e4c06e9":"path = Path('\/kaggle\/input\/plate')","2685ec6b":"np.random.seed(42)\ndata = ImageDataBunch.from_folder(path\/\"train\", train=\".\", valid_pct=0.2,\n        ds_tfms=get_transforms(), bs=16, size=224, num_workers=4).normalize(imagenet_stats)","47a23c40":"data.classes","7a81c924":"data.show_batch(rows=5, figsize=(7,8))","0dfc0320":"data.classes, data.c, len(data.train_ds), len(data.valid_ds)","89f7a411":"learn = cnn_learner(data, models.resnet18, metrics=error_rate)","c8d9cd55":"learn.fit_one_cycle(100)","4dcf06fb":"learn.unfreeze()","ebbf3346":"learn.lr_find()","fc80f494":"learn.recorder.plot()","1dbd2052":"learn.fit_one_cycle(200, max_lr=slice(3e-6,2e-6))","27bc2181":"learn.save(\"\/kaggle\/working\/stage\")","82641c89":"interp = ClassificationInterpretation.from_learner(learn)","4977d337":"interp.plot_confusion_matrix()","9dfe4712":"img = open_image(path\/'test\/0000.jpg')\nimg","98a23a59":"pred_class,pred_idx,outputs = learn.predict(img)\npred_class","701a5dc9":"from os import listdir\nsample_list = [f[:4] for f in listdir(path\/\"test\")]\nsample_list.sort()","fe03ac88":"pred_list_cor = []\nfor f in sample_list :\n    file = f+\".jpg\"\n    p,_,_ = learn.predict(open_image(path\/\"test\"\/file))\n    pred_list_cor.append(p.obj)","6651701e":"final_df = pd.DataFrame({'id':sample_list,'label':pred_list_cor})\nfinal_df.to_csv('\/kaggle\/working\/plate_submission.csv', header=True, index=False)","0d3315ef":"final_df.head()","852226b5":"## Train model","f4c82fe2":"## Interpretation","5946e610":"## View data","cf3c412b":"## One Picture","d4b5234c":"## CSV result","7054a94d":"# Result"}}