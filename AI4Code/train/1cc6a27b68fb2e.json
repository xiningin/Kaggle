{"cell_type":{"ed2d2662":"code","ebab37e4":"code","21d56d20":"code","d65dcdc1":"code","9f715bf8":"code","c48e4607":"code","0b2d483a":"code","c5af6c5e":"code","7e052f50":"code","d176db40":"code","66c8379e":"code","cc9fad51":"code","3a8394b4":"code","3fd97f12":"code","ea9a3bed":"code","e37f4287":"code","7eb6f2f0":"markdown","99906abb":"markdown","bd97b502":"markdown"},"source":{"ed2d2662":"# Clone the Transformer TTS and MelGAN repos\n!git clone https:\/\/github.com\/as-ideas\/TransformerTTS.git\n!git clone https:\/\/github.com\/seungwonpark\/melgan.git","ebab37e4":"# Install requirements\n!apt-get install -y espeak\n!pip install -r TransformerTTS\/requirements.txt","21d56d20":"!cd TransformerTTS\/; git checkout c3405c53e435a06c809533aa4453923469081147","d65dcdc1":"# Set up the paths\nfrom pathlib import Path\nMelGAN_path = 'melgan\/'\nTTS_path = 'TransformerTTS\/'\n\nimport sys\nsys.path.append(TTS_path)","9f715bf8":"!pip install ruamel.yaml","c48e4607":"!pip install phonemizer\n!pip install webrtcvad\n!pip install pyworld","0b2d483a":"# Load pretrained model\nfrom model.factory import tts_ljspeech\nfrom data.audio import Audio\n\nmodel, config = tts_ljspeech()\naudio = Audio(config)","c5af6c5e":"# Synthesize text\nsentence = 'Scientists at the CERN laboratory, say they have discovered a new particle.'\nout_normal = model.predict(sentence)","7e052f50":"# Convert spectrogram to wav (with griffin lim)\nwav = audio.reconstruct_waveform(out_normal['mel'].numpy().T)","d176db40":"import IPython.display as ipd\n\nipd.display(ipd.Audio(wav, rate=config['sampling_rate']))","66c8379e":"# 20% faster\nsentence = 'Scientists at the CERN laboratory, say they have discovered a new particle.'\nout = model.predict(sentence, speed_regulator=1.20)\nwav = audio.reconstruct_waveform(out['mel'].numpy().T)\nipd.display(ipd.Audio(wav, rate=config['sampling_rate']))","cc9fad51":"# 10% slower\nsentence = 'Scientists at the CERN laboratory, say they have discovered a new particle.'\nout = model.predict(sentence, speed_regulator=.9)\nwav = audio.reconstruct_waveform(out['mel'].numpy().T)\nipd.display(ipd.Audio(wav, rate=config['sampling_rate']))","3a8394b4":"# Do some sys cleaning\nsys.path.remove(TTS_path)\nsys.modules.pop('model')","3fd97f12":"sys.path.append(MelGAN_path)\nimport torch\nimport numpy as np\n\nvocoder = torch.hub.load('seungwonpark\/melgan', 'melgan')\nvocoder.eval()\n\nmel = torch.tensor(out_normal['mel'].numpy().T[np.newaxis,:,:])","ea9a3bed":"if torch.cuda.is_available():\n    vocoder = vocoder.cuda()\n    mel = mel.cuda()\n\nwith torch.no_grad():\n    audio = vocoder.inference(mel)","e37f4287":"# Display audio\nipd.display(ipd.Audio(audio.cpu().numpy(), rate=22050))","7eb6f2f0":"### MelGAN","99906abb":"You can also vary the speech speed","bd97b502":"<center> \n    <h1> Transformer TTS: A Text-to-Speech Transformer in TensorFlow 2 <\/h1>\n    <h2> Audio synthesis with Forward Transformer TTS and MelGAN Vocoder<\/h2>\n<\/center>\n\n## Forward Model"}}