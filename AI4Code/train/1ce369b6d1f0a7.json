{"cell_type":{"b9be8dc8":"code","5e44f5be":"code","62051b63":"code","6ca1abb0":"code","34b03325":"code","fce17359":"code","4f4b3953":"code","22f583f5":"code","8d0e0d8e":"code","56f08094":"code","e013d131":"code","7bb494c0":"code","66e7d886":"code","b1b42555":"code","803eaed7":"code","ffad2e64":"code","a5489032":"code","6b4eebc6":"markdown","7fb84798":"markdown","4e16ee54":"markdown","0772f7b8":"markdown","50ff57e8":"markdown","6ceb6d2a":"markdown","3fd399e4":"markdown","8d4bcf24":"markdown","e7472982":"markdown","de56d05d":"markdown","26638fed":"markdown","6dcc3751":"markdown","a40b349b":"markdown","60cff534":"markdown","ee6246ef":"markdown","5546b0d0":"markdown"},"source":{"b9be8dc8":"import tensorflow as tf\nimport pandas as pd\nimport numpy as np\nimport os\nfrom sklearn.preprocessing import OneHotEncoder\nfrom tensorflow.keras import models, layers","5e44f5be":"IMAGE_WIDTH = 28\nIMAGE_HEIGHT = 28\nEPOCHS = 5","62051b63":"path = \"..\/input\/digit-recognizer\/\"\nos.listdir(path)","6ca1abb0":"train, test = pd.read_csv(path + \"train.csv\"), pd.read_csv(path + \"test.csv\")","34b03325":"def process(ds):\n    ds_y = ds[\"label\"]\n    ds_x = ds.drop(labels=\"label\", axis=1)\n    ds_x = ds_x\/255.0\n    for col in ds_x.columns:\n        ds_x[col] = ds_x[col].astype(\"float32\")\n    \n    \n    ds_y = ds_y.values.reshape(len(ds_y),)\n    \n    arr = []\n    for i, item in enumerate(ds_y):\n        temp = [0.0 for i in range(10)]\n        temp[int(item)] = 1.0\n        arr.append(temp)\n    labels = np.asarray(arr)\n    \n    \n    return ds_x.values.reshape([len(ds_x), 28, 28, 1]), labels.reshape(len(ds_y), 10)","fce17359":"train_x, train_y = process(train)\ntrain_x.shape, train_y.shape","4f4b3953":"model = tf.keras.Sequential()\nmodel.add(tf.keras.layers.Conv2D(32, (3, 3), activation='relu', kernel_initializer='he_uniform', input_shape=(28, 28, 1)))\nmodel.add(tf.keras.layers.MaxPooling2D((2, 2)))\nmodel.add(tf.keras.layers.Conv2D(64, (3, 3), activation='relu', kernel_initializer='he_uniform'))\nmodel.add(tf.keras.layers.Conv2D(64, (3, 3), activation='relu', kernel_initializer='he_uniform'))\nmodel.add(tf.keras.layers.MaxPooling2D((2, 2)))\nmodel.add(tf.keras.layers.Flatten())\nmodel.add(tf.keras.layers.Dense(100, activation='relu', kernel_initializer='he_uniform'))\nmodel.add(tf.keras.layers.Dense(10, activation='softmax'))","22f583f5":"model.compile(optimizer=\"sgd\", loss=tf.keras.losses.CategoricalCrossentropy(), metrics=[\"accuracy\"])","8d0e0d8e":"for i in range(EPOCHS):\n    model.fit(train_x, train_y, verbose=1)","56f08094":"test_x = test\/255.0\nfor col in test_x.columns:\n    test_x[col] = test_x[col].astype(\"float32\")\n    \ntest_x = test_x.values.reshape([len(test_x), 28, 28, 1])","e013d131":"y_pred = model.predict_classes(test_x)","7bb494c0":"type(y_pred)","66e7d886":"y_pred","b1b42555":"output = pd.DataFrame(data=y_pred, columns=[\"Label\"])","803eaed7":"output","ffad2e64":"output.index = np.arange(1, len(output) + 1)","a5489032":"output.to_csv(\"\/kaggle\/working\/panda.csv\", index_label=\"ImageId\")","6b4eebc6":"## Define Predictions as a Pandas Dataframe","7fb84798":"## Process the Test Data","4e16ee54":"# Create Submission","0772f7b8":"## Predict with the data","50ff57e8":"## Compile the Model","6ceb6d2a":"## Train over the dataset for the number of Epochs","3fd399e4":"# Import Necessary Modules","8d4bcf24":"# Predictions","e7472982":"## Model Definition","de56d05d":"# PreProcessing","26638fed":"## Process The Arrays","6dcc3751":"## Loading CSVs into pandas","a40b349b":"## Export to CSV","60cff534":"# Define Constants","ee6246ef":"# Build the Model","5546b0d0":"## Define a PreProcessing Function"}}