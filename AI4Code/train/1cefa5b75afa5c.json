{"cell_type":{"5389ac94":"code","0754fd70":"code","0586afad":"code","65410fa2":"code","ebd2ed01":"code","c4d48262":"code","45c7ac05":"code","ba4ef614":"code","27e5c1f2":"code","a9fe8544":"code","a4eff851":"code","b902382c":"code","2fa73730":"code","851dbdb2":"code","f838b6b9":"code","bb01edf7":"code","7e2ecbc6":"code","15abc77e":"code","a497192f":"code","8e85356d":"code","5c34d525":"code","25538ac3":"code","2b07b16b":"code","3fcee0ce":"code","492fd7e3":"code","60ba5c42":"code","f8f41025":"code","48891ae7":"code","5654f708":"code","714d164e":"code","84aa57c2":"code","8bbc38fc":"code","d5cd3ca1":"code","9c47625c":"code","cd287c0b":"code","5a13ee67":"code","dc286dc6":"code","e30c31da":"code","4cf33996":"code","660a477b":"code","2f243ea7":"code","f1116ecc":"code","6ca012e1":"code","45bdd941":"code","2026d610":"code","981c6de1":"code","53f30646":"markdown","758dc9d8":"markdown","8fe64ca1":"markdown","823de281":"markdown","5c5017cf":"markdown","cb196bd4":"markdown","838cd9a0":"markdown","67412af6":"markdown","475ee576":"markdown","86014e0d":"markdown","29e5bcd5":"markdown","c5b5757d":"markdown","83875483":"markdown","43b12094":"markdown","cecc017e":"markdown","317ed734":"markdown"},"source":{"5389ac94":"import re\nimport sys\n\nimport pandas as pd\nimport numpy as np\n\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\n\nimport time\nimport datetime\n\nimport warnings\nwarnings.filterwarnings(\"ignore\")\n\nfrom sklearn import preprocessing\n\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import Ridge, Lasso\n\nfrom sklearn import metrics\nfrom sklearn.metrics import accuracy_score, mean_squared_error,mean_absolute_error,r2_score\n","0754fd70":"data = pd.read_csv(\"..\/input\/googleplaystore.csv\")","0586afad":"# Print first few rows from data\n\ndata.head()","65410fa2":"# Print last few rows from data\n\ndata.tail()","ebd2ed01":"# Shape of data \n\ndata.shape","c4d48262":"# Basic information of data\n\ndata.info()","45c7ac05":"# Checking null values\n\ndata.isnull().sum()","ba4ef614":"# Types of data\n\ndata.dtypes","27e5c1f2":"# Describing our data\n\ndata.describe()","a9fe8544":"# Columns present in our data\n\ndata.columns","a4eff851":"# The best way to fill missing values might be using the median instead of mean\n\ndata['Rating'] = data['Rating'].fillna(data['Rating'].median())","b902382c":"# Lets convert all the versions in the format number.number to simplify the data\n# We have to clean all non numerical values & unicode charachters \n\nreplaces = [u'\\u00AE', u'\\u2013', u'\\u00C3', u'\\u00E3', u'\\u00B3', '[', ']', \"'\"]\nfor i in replaces:\n    data['Current Ver'] = data['Current Ver'].astype(str).apply(lambda x : x.replace(i, ''))\n\nregex = [r'[-+|\/:\/;(_)@]', r'\\s+', r'[A-Za-z]+']\nfor j in regex:\n    data['Current Ver'] = data['Current Ver'].astype(str).apply(lambda x : re.sub(j, '0', x))\n\ndata['Current Ver'] = data['Current Ver'].astype(str).apply(lambda x : x.replace('.', ',',1).replace('.', '').replace(',', '.',1)).astype(float)\ndata['Current Ver'] = data['Current Ver'].fillna(data['Current Ver'].median())\n","2fa73730":"# Count the number of unique values in category column \n\ndata['Category'].unique()","851dbdb2":"# Check the record  of unreasonable value which is 1.9\ni = data[data['Category'] == '1.9'].index\ndata.loc[i]","f838b6b9":"# Drop this bad column\ndata = data.drop(i)","bb01edf7":"# Removing NaN values\ndata = data[pd.notnull(data['Last Updated'])]\ndata = data[pd.notnull(data['Content Rating'])]","7e2ecbc6":"plt.figure(figsize=(20, 10))\nsns.countplot(x='Category', data=data, palette='Set1')\nplt.xticks(rotation=90)\nplt.xlabel('Categories', fontsize=20)\nplt.ylabel('Counts', fontsize=20)\nplt.title('Count of application according to category', fontsize=15, color='r')","15abc77e":"from pylab import rcParams\n\nrcParams['figure.figsize'] = 11.7, 8.27\ng = sns.kdeplot(data.Rating, color=\"Red\", shade = True)\ng.set_xlabel(\"Rating\")\ng.set_ylabel(\"Frequency\")\nplt.title('Distribution of Rating',size = 20)","a497192f":"labels =data['Type'].value_counts(sort = True).index\nsizes = data['Type'].value_counts(sort = True)\n\n\ncolors = [\"lightblue\",\"orangered\"]\nexplode = (0.1,0)  # explode 1st slice\n \nrcParams['figure.figsize'] = 5,5\n# Plot\nplt.pie(sizes, explode=explode, labels=labels, colors=colors,\n        autopct='%1.1f%%', shadow=True, startangle=150,)\n\nplt.title('Percent of Free App in data', size = 15)\nplt.show()","8e85356d":"from wordcloud import WordCloud\nwordcloud1 = WordCloud(max_font_size=350, collocations=False, max_words=33, width=1600, height=800, background_color=\"white\").generate(' '.join(data['Category']))\nplt.figure(figsize=(12,8))\nplt.imshow(wordcloud1, interpolation=\"bilinear\")\nplt.axis(\"off\")\nplt.tight_layout(pad=0)\nplt.show()","5c34d525":"plt.figure(figsize=(10,8))\nax = sns.countplot(y='Content Rating', data=data)","25538ac3":"# App values encoding\n\nLE = preprocessing.LabelEncoder()\ndata['App'] = LE.fit_transform(data['App'])","2b07b16b":"# Category features encoding\n\nCategoryList = data['Category'].unique().tolist() \nCategoryList = ['cat_' + word for word in CategoryList]\ndata = pd.concat([data, pd.get_dummies(data['Category'], prefix='cat')], axis=1)","3fcee0ce":"# Genres features encoding\n\nLE = preprocessing.LabelEncoder()\ndata['Genres'] = LE.fit_transform(data['Genres'])","492fd7e3":"# Content Rating features encoding\n\nLE = preprocessing.LabelEncoder()\ndata['Content Rating'] = LE.fit_transform(data['Content Rating'])\n","60ba5c42":"# Type encoding\n\ndata['Type'] = pd.get_dummies(data['Type'])","f8f41025":"# Last Updated encoding\n\ndata['Last Updated'] = data['Last Updated'].apply(lambda x : time.mktime(datetime.datetime.strptime(x, '%B %d, %Y').timetuple()))\n","48891ae7":"# Price cleaning\n\ndata['Price'] = data['Price'].apply(lambda x : x.strip('$'))","5654f708":"# Installs cleaning\n\ndata['Installs'] = data['Installs'].apply(lambda x : x.strip('+').replace(',', ''))","714d164e":"# Convert kbytes to Mbytes\n\nk_indices = data['Size'].loc[data['Size'].str.contains('k')].index.tolist()\n\nconverter = pd.DataFrame(data.loc[k_indices, 'Size'].apply(lambda x: x.strip('k')).astype(float).apply(lambda x: x \/ 1024).apply(lambda x: round(x, 3)).astype(str))\n\ndata.loc[k_indices,'Size'] = converter","84aa57c2":"# Size cleaning\n\ndata['Size'] = data['Size'].apply(lambda x: x.strip('M'))\ndata[data['Size'] == 'Varies with device'] = 0\ndata['Size'] = data['Size'].astype(float)","8bbc38fc":"features = ['App', 'Reviews', 'Size', 'Installs', 'Type', 'Price', 'Content Rating', 'Genres', 'Last Updated', 'Current Ver']\nfeatures.extend(CategoryList)\n\nX = data[features]\ny = data['Rating']","d5cd3ca1":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.30, random_state=10)","9c47625c":"from sklearn import tree","cd287c0b":"clf = tree.DecisionTreeRegressor(criterion='mae', max_depth=5, min_samples_leaf=5, random_state=42)","5a13ee67":"clf.fit(X_train, y_train)","dc286dc6":"accuracy = clf.score(X_test, y_test)\naccuracy","e30c31da":"model = RandomForestRegressor(n_estimators = 200, n_jobs=-1, random_state=10)","4cf33996":"model.fit(X_train, y_train)","660a477b":"acc = model.score(X_test, y_test)\nacc","2f243ea7":"Pred = model.predict(X_test)\n'Mean Absolute Error:', metrics.mean_absolute_error(y_test, Pred)","f1116ecc":"'Mean Squared Error:', metrics.mean_squared_error(y_test, Pred)","6ca012e1":"'Root Mean Squared Error:', np.sqrt(metrics.mean_squared_error(y_test, Pred))","45bdd941":"X = data.loc[:,['Reviews', 'Size', 'Installs', 'Content Rating']]\n\nx_train, x_cv, y_train, y_cv = train_test_split(X, data.Rating)\n\nclf = tree.DecisionTreeRegressor(criterion='mae', max_depth=5, min_samples_leaf=5, random_state=42)","2026d610":"clf.fit(x_train, y_train)","981c6de1":"ac = clf.score(x_cv, y_cv)\nac","53f30646":"## Categorical Data Encoding\n\nWe need to convert categorical features (strings) to numerical features (numbers). \n\nMany machine learning algorithms can support categorical values without further manipulation but there are many more algorithms that do not. We need to make all data ready for the model, so we will convert categorical variables (variables that stored as text values) into numerical variables. ","758dc9d8":"## Feature Selection\n\nFeature selection is a process where you automatically select those features in your data that contribute most to the prediction variable or output in which you are interested. \n\nThree benefits of performing feature selection before modeling your data are:\n\n*  **Reduces Overfitting:** Less redundant data means less opportunity to make decisions based on noise.\n*  **Improves Accuracy:** Less misleading data means modeling accuracy improves.\n*  **Reduces Training Time:** Less data means that algorithms train faster.","8fe64ca1":"3.) Let's check out the percentage of free apps in data","823de281":"## Plotting\n\n1.) Count of application according to Category","5c5017cf":"## Data Exploration\n\nExploring our data","cb196bd4":"5.) Content Distribution","838cd9a0":"Looks like there are missing values in \"Rating\", \"Type\", \"Content Rating\", \"Current Ver\" and \" Android Ver\".","67412af6":"**Thanks for reading this kernel till here. If you like it, please upvote this kernel. This will help me to write more.**\n\n**If you have doubts please leave a comment.**\n\n**Thanks!!**","475ee576":"Majority of the apps are free\n\n4.) Category Distribution\n\n*   Wordcloud represents categories with highest number of active apps \n\n","86014e0d":"#### Random Forest Regression Model\n\nThe RandomForestRegressor class of the sklearn.ensemble library is used to solve regression problems via random forest. The most important parameter of the RandomForestRegressor class is the n_estimators parameter. This parameter defines the number of trees in the random forest.\n","29e5bcd5":"Seems like family and games category have quite large number \n\n2.) Let's look at the Rating distribution","c5b5757d":"It's obvious that the first value of this record is missing (App name) and all other values are respectively propagated backward starting from \"Category\" towards the \"Current Ver\"; and the last column which is \"Android Ver\" is left null. It's better to drop the entire recored instead of consider these unreasonable values while cleaning each column!\n\n","83875483":"### Cross-Validation\n\n### Splitting into training and CV for Cross-Validation","43b12094":"#### Decision Tree Regression\n\nDecision tree regression observes features of an object and trains a model in the structure of a tree to predict data in the future to produce meaningful continuous output. Continuous output means that the output\/result is not discrete, i.e., it is not represented just by a discrete, known set of numbers or values.","cecc017e":"## Data Cleaning\n\n*   Removing null values\n*   Filling missing values\n*   Remove certain characters from the string and convert it into usable format.\n\n\n\n\n","317ed734":"## Building Machine Learning Model"}}