{"cell_type":{"d01b163e":"code","988e0f77":"code","fc3f9d7a":"code","1ba9f5e5":"code","4c4c7a13":"code","bf180b35":"code","f6d6524e":"code","7e15cb17":"markdown","1bd3d13a":"markdown","f433c13d":"markdown","a797443f":"markdown","263e705c":"markdown","9863e738":"markdown","81b67c74":"markdown"},"source":{"d01b163e":"# Libraries\nimport pandas as pd\nfrom lightgbm import LGBMClassifier\nfrom sklearn.metrics import roc_auc_score\nfrom sklearn.model_selection import train_test_split","988e0f77":"# Read data\ntrain = pd.read_csv('..\/input\/tabular-playground-series-mar-2021\/train.csv', index_col=0)\n\n# Predictors & target\npredictors = train.columns[:-1]\ntarget = train.columns[-1]\n\n# Data processing\ncat_cols = [col for col in predictors if 'cat' in col]\ntrain[cat_cols] = train[cat_cols].astype('category')\ntrain[target] = train[target].astype('category')\n\n# Split\nX_train, X_test, y_train, y_test = train_test_split(train[predictors], train[target])","fc3f9d7a":"# Create and train model\nmodel = LGBMClassifier()\nmodel.fit(X_train, y_train)","1ba9f5e5":"# Predict\nmodel.predict(X_test)","4c4c7a13":"# Score\ny_pred = model.predict(X_test)\nroc_auc_score(y_test, y_pred)","bf180b35":"# Predict\nmodel.predict_proba(X_test)","f6d6524e":"# Score\ny_pred = model.predict_proba(X_test)[:, 1]\nroc_auc_score(y_test, y_pred)","7e15cb17":"## Using predict","1bd3d13a":"## Train model","f433c13d":"Array of 'probability to be in each class' given to each observation.  \nWe need to use the probability to be in the class '1'.  ","a797443f":"## With *predict_proba[X_test][:, 1]* the score is far better despite using the exact same model !!","263e705c":"## Just a small notebook to show you that you should use predict_proba for this competition","9863e738":"Array of 'class label' given to each observation.","81b67c74":"## predict_proba"}}