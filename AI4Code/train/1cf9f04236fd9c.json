{"cell_type":{"86cdf681":"code","d18438f0":"code","4d8c2111":"code","1ee1f5d8":"code","289127f1":"code","4ef33d21":"code","fed8ca1d":"code","be0f792d":"code","a1ea63a2":"code","4186fb44":"code","e8a6c63b":"code","439a6bf4":"code","48fc063f":"code","10a7d759":"code","3e314bf0":"code","78a1bd42":"code","86b11fb1":"code","a7f58844":"code","071dc556":"code","c330bfac":"code","cb9e5367":"code","b7fdc9fd":"code","1defcc22":"code","ec6ae361":"code","fac59f0f":"code","fadb481e":"code","f46766c4":"code","92dcb092":"code","6eb59d46":"code","741f5e3b":"code","5e70b0d5":"code","980c8ccb":"code","27e178bd":"code","6cf5d684":"code","54a30341":"code","c3d03e1e":"code","16970f6a":"code","779388b2":"code","0af1cfd7":"code","3fdb4733":"code","8cc90a49":"code","714240d6":"code","6acd6bb7":"code","2bef4769":"code","ca2c6f50":"code","de7bd41f":"code","62610b21":"code","11f8e282":"code","3268b4aa":"markdown","76da655b":"markdown","14af8195":"markdown","e428532b":"markdown","b5c2e6d7":"markdown","559c4f49":"markdown","d1b8301e":"markdown","a2971333":"markdown","a7504566":"markdown","274f3312":"markdown","03f53c59":"markdown","f82f1bce":"markdown","484cb69a":"markdown","bfda1bab":"markdown","fd32eb34":"markdown","d113f62d":"markdown","ed871387":"markdown"},"source":{"86cdf681":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport os\nimport scipy as sp\nimport string\nimport warnings\nwarnings.filterwarnings(\"ignore\")\n%matplotlib inline\n\n\n","d18438f0":"data=pd.read_csv(\"..\/input\/fake-news-classifier-data\/test.csv\")\n","4d8c2111":"data","1ee1f5d8":"data.head()","289127f1":"data.info()","4ef33d21":"data.describe()","fed8ca1d":"data.value_counts","be0f792d":"data.dtypes","a1ea63a2":"data.shape","4186fb44":"data.columns","e8a6c63b":"data.isnull().sum()","439a6bf4":"data.isnull().any()","48fc063f":"###Drop Nan Values\ndata=data.dropna()\n","10a7d759":"data.isnull().sum()","3e314bf0":"## Get the Independent Features\n\nX=data.drop('id',axis=1)\n","78a1bd42":"y=data['id']\n","86b11fb1":"y.value_counts()\n","a7f58844":"X.shape","071dc556":"y.shape","c330bfac":"plt.style.use(\"default\")\nsns.barplot(x=\"id\", y=\"title\",data=data[180:190])\nplt.title(\"ID vs TITLE\",fontsize=15)\nplt.xlabel(\"ID\")\nplt.ylabel(\"TITLE\")\nplt.show()\n\n\n","cb9e5367":"data.columns","b7fdc9fd":"sns.set_palette(\"Paired\")\nsns.pairplot(data,hue='text',height=5,palette='colorblind')\nplt.show()\n","1defcc22":"plt.figure(figsize=(14,10))\nsns.set_style(style='whitegrid')\nplt.subplot(2,3,1)\nsns.boxplot(x='id',data=data)\n\n","ec6ae361":"sns.pairplot(data=data)","fac59f0f":"import tensorflow as tf\n","fadb481e":"from tensorflow.keras.layers import Embedding\nfrom tensorflow.keras.preprocessing.sequence import pad_sequences\nfrom tensorflow.keras.models import Sequential\nfrom tensorflow.keras.preprocessing.text import one_hot\nfrom tensorflow.keras.layers import LSTM\nfrom tensorflow.keras.layers import Dense\n\n","f46766c4":"### Vocabulary size\nvoc_size=5000\n","92dcb092":"messages=X.copy()\n","6eb59d46":"messages.reset_index(inplace=True)\n\n","741f5e3b":"import nltk\nimport re\nfrom nltk.corpus import stopwords","5e70b0d5":"nltk.download('stopwords')\n","980c8ccb":"### Dataset Preprocessing\nfrom nltk.stem.porter import PorterStemmer\nps = PorterStemmer()\ncorpus = []\nfor i in range(0, len(messages)):\n    print(i)\n    review = re.sub('[^a-zA-Z]', ' ', messages['title'][i])\n    review = review.lower()\n    review = review.split()\n    \n    review = [ps.stem(word) for word in review if not word in stopwords.words('english')]\n    review = ' '.join(review)\n    corpus.append(review)\n","27e178bd":"corpus","6cf5d684":"onehot_repr=[one_hot(words,voc_size)for words in corpus] \nonehot_repr","54a30341":"sent_length=20\nembedded_docs=pad_sequences(onehot_repr,padding='pre',maxlen=sent_length)\nprint(embedded_docs)\n","c3d03e1e":"embedded_docs[0]\n","16970f6a":"## Creating model\nembedding_vector_features=40\nmodel=Sequential()\nmodel.add(Embedding(voc_size,embedding_vector_features,input_length=sent_length))\nmodel.add(LSTM(100))\nmodel.add(Dense(1,activation='sigmoid'))\nmodel.compile(loss='mae',optimizer='adam',metrics=['accuracy'])\n\n","779388b2":"model.summary()","0af1cfd7":"import numpy as np\nX_final=np.array(embedded_docs)\ny_final=np.array(y)\n","3fdb4733":"X_final.shape,y_final.shape","8cc90a49":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X_final, y_final, test_size=0.3, random_state=42)\n","714240d6":"model.fit(X_train,y_train,validation_data=(X_test,y_test),epochs=50,batch_size=256)\n","6acd6bb7":"from tensorflow.keras.layers import Dropout\n## Creating model\nembedding_vector_features=40\nmodel=Sequential()\nmodel.add(Embedding(voc_size,embedding_vector_features,input_length=sent_length))\nmodel.add(Dropout(0.3))\nmodel.add(LSTM(100))\nmodel.add(Dropout(0.3))\nmodel.add(Dense(1,activation='sigmoid'))\nmodel.compile(loss='mae',optimizer='adam',metrics=['accuracy'])","2bef4769":"y_pred=model.predict(X_test)\n","ca2c6f50":"y_pred","de7bd41f":"print((y_pred > 0.5))\n","62610b21":"from tensorflow.keras.utils import plot_model\nplot_model(model, show_shapes = True)\n","11f8e282":"model.summary()","3268b4aa":"***So we have to drop the null values .***","76da655b":"# **Exploratory Data Analysis**","14af8195":"# **Thank You** ","e428532b":"**Stemming and Lemmatization are Text Normalization (or sometimes called Word Normalization) techniques in the field of Natural Language Processing that are used to prepare text, words, and documents for further processing.**","b5c2e6d7":"**Types of Loss Functions:**\n\n**1) Mean Squared Error**\n\n**2) Regression Loss Function**\n\n**3) Mean Absolute Error Loss**\n\n**4) Binary Classification Loss Function**\n\n**5) Binary Cross Entropy Loss**\n","559c4f49":"**Types of Activation Functions:**\n\n**1) Relu**\n\n**2) Sigmoid**\n\n**3) Threshold**\n\n**4) Hyperbolic Tangent**","d1b8301e":"**NLTK**","a2971333":"# IMPORTING THE LIBRARIES","a7504566":"![](https:\/\/miro.medium.com\/max\/1400\/1*RGVPc-MT0q_DCHCavFRHvA.jpeg)","274f3312":"# LOADING THE DATASET","03f53c59":"**Types of Optimizers:**\n\n**1) Gradient Descent (GD)**\n\n**2) Stochastic Gradient Descent**\n\n**3) Mini-Batch Gradient Descent**\n\n**4) Adagrad**\n\n**5) RMSProp**\n\n\n\n","f82f1bce":"**LSTM**","484cb69a":"**With Dense we can also use Dropout and Batch Normalization**","bfda1bab":"# FAKE NEWS CLASSIFIER ","fd32eb34":"**MODEL CREATION**","d113f62d":"# **Checking Null Values**","ed871387":"***So now we can see all the null values have been dropped .***"}}