{"cell_type":{"59acde25":"code","5d68a5c4":"code","5b99cc6c":"code","e4982489":"code","e7eadfc5":"code","c09c19ea":"code","b93d602f":"code","df67fbaa":"code","ab3ac96a":"code","a90cc854":"code","8b986d33":"code","d82ed0f2":"code","6a28b330":"code","114853cc":"code","3edbc8a2":"code","c6ca9cb2":"code","7af13703":"code","0bf8b3b9":"code","bba25d39":"code","56244021":"code","ca0cab77":"code","d051eef4":"code","4ea93748":"code","ee1ebbd2":"code","b6cb9f63":"code","aa7e00c2":"code","46a171c3":"code","4d4a4cc2":"code","7725fa2b":"code","28a61546":"code","e4551844":"code","ab9bbf0b":"code","00366798":"code","c6c676b4":"code","b765f9d2":"code","dcdc4fd0":"markdown","f0611e5e":"markdown","c0bcaa61":"markdown","96fce6ef":"markdown","14f530fd":"markdown","f115e1f4":"markdown","eb087c48":"markdown","f579f15f":"markdown","f57691b5":"markdown","0c7d3ea4":"markdown","01f8f53f":"markdown","86d94401":"markdown","a07551f6":"markdown","feb51085":"markdown","2318349a":"markdown","6021e92b":"markdown","4e765083":"markdown","7aeadbb7":"markdown","f21e0595":"markdown","624eb219":"markdown","2ce60493":"markdown"},"source":{"59acde25":"import numpy as np\nimport pandas as pd\n\nfrom matplotlib import pyplot as plt\nimport seaborn as sns","5d68a5c4":"df = pd.read_csv('..\/input\/heart-attack-analysis-prediction-dataset\/heart.csv')","5b99cc6c":"df.head()","e4982489":"df.info()","e7eadfc5":"df[df.duplicated(keep=False)]","c09c19ea":"df.drop_duplicates(inplace=True)  # \u0443\u0434\u0430\u043b\u044f\u0435\u043c \u0434\u0443\u0431\u043b\u044c\ndf.shape","b93d602f":"df.dropna()\ndf.shape","df67fbaa":"df.plot(subplots=True, figsize=(10, 30))","ab3ac96a":"import seaborn as sns\nsns_plot = sns.pairplot(df)\nsns_plot.savefig('.\/pairplot.png')  ","a90cc854":"df.describe()","8b986d33":"import seaborn as sns\n\n\nplt.subplots(figsize=(10,10))\nsns.heatmap(df.corr(), fmt=\".2f\", annot=True, square=True)\nplt.show()","d82ed0f2":"columns_to_show = ['thalachh']\ndf.groupby(['output'])[columns_to_show].agg([np.mean]).plot(kind='bar')","6a28b330":"columns_to_show = ['cp', 'slp']\ndf.groupby(['output'])[columns_to_show].agg([np.mean]).plot(kind='bar')","114853cc":"columns_to_show = ['exng', 'oldpeak', 'caa', 'thall']\ndf.groupby(['output'])[columns_to_show].agg([np.mean]).plot(kind='bar')","3edbc8a2":"pd.crosstab(df['output'], df['age'])","c6ca9cb2":"df['sex'].mean()","7af13703":"pd.crosstab(df['output'], df['sex'])","0bf8b3b9":"X = np.array(df[df._get_numeric_data().drop(columns=['output']).columns])","bba25d39":"y = df['output'].values","56244021":"X_scaled = (X - X.T.mean())\/X.T.std()","ca0cab77":"X_scaled","d051eef4":"from sklearn.manifold import TSNE\nfrom sklearn.preprocessing import StandardScaler\n\n\n\nX_tdsne = df.drop(['output'], axis=1)\n\nscaler = StandardScaler()\nX_tdsne_scaled = scaler.fit_transform(X_tdsne)\n\n\ntsne = TSNE(random_state=17)\ntsne_representation = tsne.fit_transform(X_tdsne_scaled)\n\nplt.scatter(tsne_representation[:, 0], tsne_representation[:, 1]);","4ea93748":"plt.scatter(tsne_representation[:, 0], tsne_representation[:, 1], \n            c=df['output'].map({0: 'blue', 1: 'orange'}));","ee1ebbd2":"from sklearn.neighbors import KNeighborsClassifier\nfrom sklearn import dummy\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.model_selection import train_test_split\n\nX_train, X_test, y_train, y_test = train_test_split(X_scaled, y, test_size=0.2)\nknn = KNeighborsClassifier()\nknn.fit(X_train, y_train)\npreds = knn.predict(X_test)\naccuracy_score(y_test, preds)","b6cb9f63":"dummy_clf = dummy.DummyClassifier(\"most_frequent\").fit(X_train, y_train)\ny_dummy = dummy_clf.predict(X_test)\naccuracy_score(y_test, y_dummy)","aa7e00c2":"X_scaled","46a171c3":"from sklearn.model_selection import GridSearchCV\n\nknn_grid = {'n_neighbors': np.array(np.linspace(5, 30, 25), dtype='int')}\ngs = GridSearchCV(knn, knn_grid, cv=5, n_jobs=1) # \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c \u043a\u0440\u043e\u0441\u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u044e\ngs.fit(X, y)","4d4a4cc2":"def grid_plot(x, y, x_label, title, y_label='cross_val'):\n    plt.figure(figsize=(12, 6))\n    plt.grid(True)\n    plt.plot(x, y, 'go-')\n    plt.xlabel(x_label)\n    plt.ylabel(y_label)\n    plt.title(title)","7725fa2b":"grid_plot(knn_grid['n_neighbors'], gs.cv_results_['mean_test_score'], 'n_neighbors', 'KNeighborsClassifier')","28a61546":"print(gs.best_params_, gs.best_score_)","e4551844":"from sklearn.linear_model import LogisticRegression\n\nlogreg = LogisticRegression(solver='liblinear', max_iter=1000)\n\n\nlogreg_grid = {'C': [1e-4, 1e-3, 1e-1, 1, 10]}\ngs = GridSearchCV(\n    logreg,\n    logreg_grid,\n    cv=5, # \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c \u043a\u0440\u043e\u0441\u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u044e\n    n_jobs=-1,\n    scoring=[\"accuracy\", \"precision\", \"recall\", \"f1\"],\n    refit='recall', # \u043c\u0430\u043a\u0441\u0438\u043c\u0438\u0437\u0438\u0440\u0443\u0435\u043c recall\n)\ngs.fit(X, y)\n\nprint(gs.best_params_, gs.best_score_)","ab9bbf0b":"fit_results = pd.DataFrame(gs.cv_results_)\nfit_results[['params', 'mean_test_accuracy', 'mean_test_precision', 'mean_test_recall', 'mean_test_f1']]","00366798":"from sklearn import metrics\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.5)\nlogreg = LogisticRegression(solver='liblinear', max_iter=100, C=0.1)\nknn = KNeighborsClassifier(n_neighbors=12)\nknn.fit(X_train, y_train)\nlogreg.fit(X_train, y_train)\ny_logreg = logreg.predict_proba(X_test)\ny_knn = knn.predict_proba(X_test)","c6c676b4":"y_logreg_positive_prob = pd.DataFrame(y_logreg)[1].values\ny_knn_positive_prob = pd.DataFrame(y_knn)[1].values","b765f9d2":"plt.figure()\n\n\nfor index, res in enumerate([y_logreg_positive_prob, y_knn_positive_prob]):\n    fpr, tpr, _ = metrics.roc_curve(y_test, res)\n    plt.plot(fpr, tpr, label=f'ROC curve {index} (area = %0.2f)' % metrics.auc(fpr, tpr))\n\nplt.grid(True)\nplt.plot([0, 1], [0, 1], 'k--')\nplt.xlim([0.0, 1.0])\nplt.ylim([0.0, 1.05])\nplt.xlabel('False Positive Rate')\nplt.ylabel('True Positive Rate')\nplt.title('LogReg ROC AUC')\nplt.legend(loc=\"lower right\")\nplt.show()\n","dcdc4fd0":"# \u041c\u0435\u0442\u0440\u0438\u043a\u0438","f0611e5e":"\u043f\u043e\u043b\u0443\u0447\u0438\u043b\u0438 \u043e\u0447\u0435\u043d\u044c \u043f\u043b\u043e\u0445\u0438\u0435 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b, \u043f\u0440\u043e\u0431\u0443\u0435\u043c \u043f\u0440\u0438\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u0435\u0440\u0435\u0431\u043e\u0440 \u0433\u0438\u043f\u0435\u0440\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432 + \u043a\u0440\u043e\u0441\u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u044e","c0bcaa61":"\u043d\u0430\u0438\u0431\u043e\u043b\u0435\u0435 \u044f\u0440\u043a\u043e \u0432\u044b\u0440\u0430\u0436\u0435\u043d\u043d\u044b\u0435 \u043e\u0431\u0440\u0430\u0442\u043d\u044b\u0435 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438","96fce6ef":"# \u041c\u0430\u0442\u0440\u0438\u0446\u0430 \u043a\u043e\u0440\u0440\u0435\u043b\u044f\u0446\u0438\u0438\n\n\u043f\u043e \u043c\u0430\u0442\u0440\u0438\u0446\u0435 \u0432\u0438\u0434\u0438\u043c \u0447\u0442\u043e \u0441 cp (\u0442\u0438\u043f \u0431\u043e\u043b\u0438 \u0432 \u0433\u0440\u0443\u0434\u0438), thalachh (\u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439 \u043f\u0443\u043b\u044c\u0441?) \u043f\u0440\u043e\u0441\u043b\u0435\u0436\u0438\u0432\u0430\u0435\u0442\u0441\u044f \u043f\u043e\u043b\u043e\u0436\u0438\u0442\u0435\u043b\u044c\u043d\u0430\u044f \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u044c\n\u0430 \u043f\u043e \u043d\u0435\u043a\u043e\u0442\u043e\u0440\u044b\u043c \u043f\u0440\u0438\u0437\u043d\u0430\u043a\u043e\u043c \u0434\u043e\u0432\u043e\u043b\u044c\u043d\u043e \u0441\u0438\u043b\u044c\u043d\u0430\u044f \u043e\u0431\u0440\u0430\u0442\u043d\u0430\u044f \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u044c.","14f530fd":"\u043d\u0430\u0438\u0431\u043e\u043b\u0435\u0435 \u044f\u0440\u043a\u043e \u0432\u044b\u0440\u0430\u0436\u0435\u043d\u043d\u044b\u0435 \u043f\u0440\u044f\u043c\u044b\u0435 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438","f115e1f4":"**\u0412\u044b\u0432\u043e\u0434\u044b:** \n* \u043d\u0430\u0448\u0435\u043b\u0441\u044f \u043e\u0434\u0438\u043d \u0434\u0443\u0431\u043b\u0438\u043a\u0430\u0442\n* \u043f\u0440\u043e\u043f\u0443\u0441\u043a\u043e\u0432 \u043d\u0435\u0442, \u0432\u043e \u0432\u0441\u0435\u0445 302 \u043f\u0440\u0438\u043c\u0435\u0440\u0430\u0445 \u0434\u0430\u043d\u043d\u044b\u0435 \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u044b.\n* \u0412 \u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u043e\u0447\u0442\u0438 \u043d\u0435\u0442 \u0432\u044b\u0431\u0440\u043e\u0441\u043e\u0432 \u043a\u0440\u043e\u043c\u0435 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u0432\u044b\u0441\u043e\u043a\u043e\u0433\u043e \u0443\u0440\u043e\u0432\u043d\u044f \u0445\u043e\u043b\u0435\u0441\u0442\u0435\u0440\u043e\u043b\u0430, \u043d\u043e \u0435\u0433\u043e \u0443\u0434\u0430\u043b\u044f\u0442\u044c \u043d\u0435 \u0441\u0442\u0430\u043b.","eb087c48":"# \u041e\u0431\u0443\u0447\u0430\u0435\u043c \u043c\u0435\u0442\u043e\u0434\u043e\u043c KNN","f579f15f":"\u043e\u0447\u0435\u043d\u044c \u043a\u0440\u0443\u0442\u043e!, \u0432\u0438\u0434\u0438\u043c \u0447\u0442\u043e \u043c\u044b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u043c\u043e\u0436\u0435\u043c \u0432\u044b\u0434\u0435\u043b\u0438\u0442\u044c \u043d\u0435\u043a\u043e\u0442\u043e\u0440\u0443\u044e \u043e\u0431\u043b\u0430\u0441\u0442\u044c \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 \u043f\u043b\u043e\u0442\u043d\u043e\u0441\u0442\u044c \u0437\u0430\u0431\u043e\u043b\u0435\u0432\u0448\u0438\u0445 \u043d\u0430\u043c\u043d\u043e\u0433\u043e \u0431\u043e\u043b\u044c\u0448\u0435,\n\u0442\u0430\u043a\u0436\u0435 \u0432\u0438\u0434\u0438\u043c \u043d\u0435\u043a\u043e\u0442\u043e\u0440\u044b\u0435 '\u0432\u044b\u0431\u0440\u043e\u0441\u044b' \u043e\u0440\u0430\u043d\u0436\u0435\u0432\u044b\u0445 \u0442\u043e\u0447\u0435\u043a, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0441\u0438\u043b\u044c\u043d\u043e \u0437\u0430\u043b\u0435\u0437\u0430\u044e\u0442 \u0432 \u0441\u0438\u043d\u0438\u044e \u043e\u0431\u043b\u0430\u0441\u0442\u044c","f57691b5":"\u0440\u0430\u0441\u043a\u0440\u0430\u0441\u0438\u043c \u043d\u0430\u0448\u0435 \u0432 \u043c\u043d\u043e\u0436\u0435\u0441\u0442\u0432\u043e \u0438 \u0442\u0435\u0445 \u043a\u0442\u043e \u0437\u0430\u0431\u043e\u043b\u0435\u043b \u043e\u0440\u0430\u043d\u0436\u0435\u0432\u044b\u043c","0c7d3ea4":"# \u041e\u0431\u0443\u0447\u0430\u0435\u043c \u043c\u0435\u0442\u043e\u0434\u043e\u043c LogReg\n\n* \u043c\u0430\u043a\u0441\u0438\u043c\u0438\u0437\u0438\u0440\u0443\u0435\u043c recall\n* \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c \u043a\u0440\u043e\u0441\u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u044e (\u043c\u0430\u043b\u0435\u043d\u044c\u043a\u0438\u0439 \u0434\u0430\u0442\u0430\u0441\u0435\u0442)\n* \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c \u043f\u0435\u0440\u0435\u0431\u043e\u0440 \u0433\u0438\u043f\u0435\u0440\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430 \u0421 (\u043e\u0431\u0440\u0430\u0442\u043d\u0430\u044f \u0441\u0438\u043b\u0430 \u0440\u0435\u0433\u0443\u043b\u044f\u0440\u0438\u0437\u0430\u0446\u0438\u0438)","01f8f53f":"# t-distributed Stohastic Neighbor Embedding","86d94401":"# \u041f\u0435\u0440\u0432\u0438\u0447\u043d\u043e\u0435 \u0438\u0441\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u043d\u0438\u0435","a07551f6":"\u0432\u0438\u0434\u0438\u043c \u0447\u0442\u043e \u0432 \u0441\u043b\u0443\u0447\u0430\u0435 \u0441 knn \u043f\u043e\u043b\u0443\u0447\u0430\u043b\u043e\u0441\u044c \u043e\u0447\u0435\u043d\u044c \u043c\u043d\u043e\u0433\u043e \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u043e\u0432 \u0441 \u043e\u0434\u0438\u043d\u0430\u043a\u043e\u0432\u044b\u043c\u0438 \u0432\u0435\u0440\u043e\u044f\u0442\u043d\u043e\u0441\u0442\u044f\u043c\u0438 \u043f\u043e\u0437\u0438\u0442\u0438\u0432\u043d\u044b\u0445\/\u043d\u0435\u0433\u0430\u0442\u0438\u0432\u043d\u044b\u0445 \u043e\u0442\u0432\u0435\u0442\u043e\u0432 \u0438\u0437-\u0437\u0430 \u0447\u0435\u0433\u043e \u043a\u0440\u0438\u0432\u0430\u044f \u0434\u043b\u044f knn \u043e\u0447\u0435\u043d\u044c \u0447\u0430\u0441\u0442\u043e '\u0433\u0430\u0434\u0430\u043b\u0430' \u043a \u0447\u0435\u043c\u0443 \u043e\u0442\u043d\u0435\u0441\u0442\u0438 \u0434\u0430\u043d\u043d\u044b\u0439 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u044b\u0439 \u043f\u0440\u0438\u043c\u0435\u0440.","feb51085":"\u0441\u0443\u0434\u044f \u043f\u043e \u0434\u0430\u043d\u043d\u044b\u043c \u043d\u0435 \u0432\u0438\u0434\u043d\u043e \u0441\u0438\u043b\u044c\u043d\u043e \u0432\u044b\u0440\u0430\u0436\u0435\u043d\u043d\u043e\u0439 \u043f\u0440\u044f\u043c\u043e\u0439 \u0437\u0430\u0444\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u043e\u0442 \u0432\u043e\u0437\u0440\u0430\u0441\u0442\u0430","2318349a":"\u0412\u0438\u0434\u0438\u043c \u0447\u0442\u043e \u043f\u0440\u0438 \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u043c recall, \u043c\u0435\u0442\u0440\u0438\u043a\u0430 f1 \u0442\u0430\u043a\u0436\u0435 \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u0435\u0442 \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435, \u043f\u043e\u043b\u0443\u0447\u0438\u043b\u0438 \u0445\u043e\u0440\u043e\u0448\u0438\u0439 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u0432 \u0441\u0440\u0430\u0432\u043d\u0435\u043d\u0438\u0438 \u0441 KNN.","6021e92b":"# \u041f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0434\u0430\u043d\u043d\u044b\u0445","4e765083":"\u043d\u0430\u0438\u043b\u0443\u0447\u0448\u0438\u0439 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u043f\u043e\u043b\u0443\u0447\u0438\u043b\u0438 \u043f\u0440\u0438 12 \u0441\u043e\u0441\u0435\u0434\u044f\u0445, \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u043f\u043e \u043f\u0440\u0435\u0436\u043d\u0435\u043c\u0443 \u043f\u043b\u043e\u0445\u0438","7aeadbb7":"# \u041e\u0441\u043d\u043e\u0432\u043d\u043e\u0435 \u0438\u0441\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u043d\u0438\u0435","f21e0595":"\u0441\u0443\u0434\u044f \u043f\u043e \u0434\u0430\u043d\u043d\u044b\u043c \u0436\u0435\u043d\u0449\u0438\u043d\u044b \u0431\u043e\u043b\u0435\u044e\u0442 \u0447\u0430\u0449\u0435","624eb219":"# \u041f\u043e\u0441\u0442\u0440\u043e\u0438\u043c \u0433\u0440\u0430\u0444\u0438\u043a ROC AUC","2ce60493":"# \u041d\u043e\u0440\u043c\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0439 \u043f\u0440\u0438\u0437\u043d\u0430\u043a\u043e\u0432\n\n\u0432\u043e\u0437\u0440\u0430\u0441\u0442 \u0438 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u043d\u0438\u0435 \u0445\u043e\u043b\u0435\u0441\u0442\u0438\u0440\u043e\u043b\u0430 \u043e\u0442\u043c\u0430\u0448\u0442\u0430\u0431\u0438\u0440\u043e\u0432\u0430\u0442\u044c\n\u044d\u0442\u0438 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u043c\u043e\u0433\u0443\u0442 \u0441\u0438\u043b\u044c\u043d\u043e \u043f\u043e\u0432\u043b\u0438\u044f\u0442\u044c \u043f\u0440\u0438 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u0438 \u043c\u0435\u0442\u043e\u0434\u043e\u043c KNN \u043d\u0430 \u0440\u0430\u0441\u0447\u0435\u0442 \u0440\u0430\u0441\u0441\u0442\u043e\u044f\u043d\u0438\u0439\n\n\u043a\u0430\u043a \u0432\u044b\u044f\u0441\u043d\u0438\u043b\u043e\u0441\u044c \u0432 \u043f\u043e\u0441\u043b\u0435\u0434\u0441\u0442\u0432\u0438\u0438 \u043a\u043e\u0433\u0434\u0430 \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u043b \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u0435 \u0441 KNN \u044d\u0442\u043e \u043f\u0440\u0430\u043a\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u043d\u0435 \u043f\u043e\u0432\u043b\u0438\u044f\u043b\u043e \u043d\u0430 \u043c\u0435\u0442\u0440\u0438\u043a\u0443, \u043d\u043e \u0430\u043b\u0433\u043e\u0440\u0438\u0442\u043c \u0432 \u0446\u0435\u043b\u043e\u043c \u0434\u0430\u043b \u043e\u0447\u0435\u043d\u044c \u043f\u043b\u043e\u0445\u0438\u0435 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b\n"}}