{"cell_type":{"56275277":"code","68602861":"code","a5680112":"code","1e27a239":"code","b76ad4a5":"code","f6e417c8":"code","6dab9c53":"code","5f742adc":"code","75ca953e":"code","997436dd":"markdown","8af53d7d":"markdown","2af97604":"markdown","1c9d4505":"markdown","9be528a3":"markdown"},"source":{"56275277":"%config Completer.use_jedi = False\nimport os\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport pickle\n\nfrom sklearn.model_selection import train_test_split\n\nimport tensorflow as tf\nfrom tensorflow.keras.models import Sequential\nfrom tensorflow.keras.layers import *","68602861":"train = pd.read_csv('..\/input\/challenges-in-representation-learning-facial-expression-recognition-challenge\/train.csv')\n\nprint('Training Set Size:', train.shape)","a5680112":"train.head()","1e27a239":"# Convert the string of pixels to an array\ntrain['pixels'] = [np.fromstring(x, dtype=int, sep=' ').reshape(-1,48,48,1) for x in train['pixels']]","b76ad4a5":"emotion_cat = {0:'Anger', 1:'Disgust', 2:'Fear', 3:'Happiness', 4: 'Sadness', 5: 'Surprise', 6: 'Neutral'}\ntrain['emotion'] = train['emotion'].apply(lambda x: emotion_cat[x])","f6e417c8":"pixels = np.concatenate(train['pixels'])\nlabels = train.emotion.values\n\nprint(pixels.shape)\nprint(labels.shape)","6dab9c53":"train.emotion.value_counts().plot(kind='bar', figsize=(7, 6), rot=0)\nplt.xlabel(\"Emotions\")\nplt.ylabel(\"Count\")\nplt.title(\"Distribution of Emotions\")","5f742adc":"(train.emotion.value_counts() \/ len(train)).to_frame().T","75ca953e":"plt.close()\nplt.rcParams[\"figure.figsize\"] = [16,16]\n\nrow = 0\nfor emotion in np.unique(labels):\n    all_emotion_images = train[train['emotion'] == emotion]\n    for i in range(5):\n        \n        img = all_emotion_images.iloc[i,].pixels.reshape(48,48)\n        lab = emotion\n\n        plt.subplot(7,5,row+i+1)\n        plt.imshow(img, cmap='binary_r')\n        plt.text(-30, 5, s = str(lab), fontsize=10, color='b')\n        plt.axis('off')\n    row += 5\n\nplt.show()","997436dd":"# View the Distribution of Emotions","8af53d7d":"# Import Statements","2af97604":"# Load Data","1c9d4505":"# Display Select Images","9be528a3":"The pixels for each picture are stored in a single string separated by a whitespace. We will need to convert the strings into a single 4D array with a shape of (28709,48,48,1). We will accomplish this by converting each string into its own array and combining all the arrays into a single array."}}