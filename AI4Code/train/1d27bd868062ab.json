{"cell_type":{"e9363282":"code","97079da0":"code","330186dc":"code","e15f0881":"code","64c6e273":"code","e7a24901":"code","630386b4":"code","b5e7d89a":"code","1754f6d9":"code","2b05c1ac":"code","720ff8dc":"code","7b6ec858":"code","2f3277fc":"code","55818654":"code","1a7dcaf8":"code","158f9ff6":"code","3f59387a":"code","19dfc530":"code","9c5d9a9d":"code","6abf5b64":"markdown","f0d29f79":"markdown","64807318":"markdown","95f139d2":"markdown","6958342e":"markdown","5efe786c":"markdown","d512dc4e":"markdown","e47d13ac":"markdown","76ab4b1e":"markdown","a89b0d73":"markdown","bab1bce5":"markdown","ef32c33a":"markdown","5561ca8d":"markdown"},"source":{"e9363282":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline","97079da0":"df = pd.read_csv('..\/input\/college-data\/College_Data',index_col=0)  #setting the first column as the index","330186dc":"df.head()","e15f0881":"df.info()","64c6e273":"df.describe()","e7a24901":"import warnings\nwarnings.filterwarnings(\"ignore\")","630386b4":"sns.set_style('whitegrid')\nsns.lmplot('Room.Board','Grad.Rate',data=df, hue='Private',\n           palette='coolwarm',size=6,aspect=1,fit_reg=False)","b5e7d89a":"sns.set_style('whitegrid')\nsns.lmplot('Outstate','F.Undergrad',data=df, hue='Private',\n           palette='coolwarm',size=6,aspect=1,fit_reg=False)","1754f6d9":"sns.set_style('darkgrid')\ng = sns.FacetGrid(df,hue=\"Private\",palette='coolwarm',size=6,aspect=2)\ng = g.map(plt.hist,'Outstate',bins=20,alpha=0.7)","2b05c1ac":"sns.set_style('darkgrid')\ng = sns.FacetGrid(df,hue=\"Private\",palette='coolwarm',size=6,aspect=2)\ng = g.map(plt.hist,'Grad.Rate',bins=20,alpha=0.7)","720ff8dc":"df[df['Grad.Rate'] > 100]","7b6ec858":"\ndf['Grad.Rate']['Cazenovia College'] = 100","2f3277fc":"df[df['Grad.Rate'] > 100]","55818654":"sns.set_style('darkgrid')\ng = sns.FacetGrid(df,hue=\"Private\",palette='coolwarm',size=6,aspect=2)\ng = g.map(plt.hist,'Grad.Rate',bins=20,alpha=0.7)","1a7dcaf8":"from sklearn.cluster import KMeans\nkmeans = KMeans(n_clusters=2, random_state=78)\n\nkmeans.fit(df.drop('Private',axis=1))    #model fitting on data minus private label\n\n\nkmeans.cluster_centers_     #cluster center vectors","158f9ff6":"def converter(cluster):\n    if cluster=='Yes':\n        return 1\n    else:\n        return 0\n","3f59387a":"df['Cluster'] = df['Private'].apply(converter)\n","19dfc530":"df.head()","9c5d9a9d":"from sklearn.metrics import confusion_matrix,classification_report\n\nprint('Confusion Matrix:')\nprint('*****************')\nprint(confusion_matrix(df['Cluster'],kmeans.labels_))\nprint('\\n')\nprint('Classification Report:')\nprint('***********************')\nprint(classification_report(df['Cluster'],kmeans.labels_))","6abf5b64":"### EDA:","f0d29f79":"Data:\n\n* We will use a data frame with 777 observations on the following 18 variables.\n\n* Private: A factor with levels No and Yes indicating private or public university\n* Apps: Number of applications received\n* Accept: Number of applications accepted\n* Enroll: Number of new students enrolled\n* Top10perc: Pct. new students from top 10% of H.S. class\n* Top25perc: Pct. new students from top 25% of H.S. class\n* F.Undergrad: Number of fulltime undergraduates\n* P.Undergrad: Number of parttime undergraduates\n* Outstate: Out-of-state tuition\n* Room.Board: Room and board costs\n* Books: Estimated book costs\n* Personal: Estimated personal spending\n* PhD: Pct. of faculty with Ph.D.\u2019s\n* Terminal: Pct. of faculty with terminal degree\n* S.F.Ratio: Student\/faculty ratio\n* perc.alumni: Pct. alumni who donate\n* Expend: Instructional expenditure per student\n* Grad.Rate: Graduation rate","64807318":"##### There seems to be a private school with a graduation rate of higher than 100%:","95f139d2":"##### The algorithm's performance is fair enough considering that it is using purely features to cluster the universities. ","6958342e":"#### F.Undergrad versus Outstate where the points are colored by the Private column:","5efe786c":"#### Scatterplot of Grad.Rate versus Room.Board where the points are colored by the Private column:","d512dc4e":"#### Import the libraries:","e47d13ac":"##### Let's set that school's graduation rate to 100 so it makes sense:","76ab4b1e":"#### Model Building:","a89b0d73":"##### Let's create a confusion matrix and classification report to see how well the Kmeans clustering worked without being given any labels:","bab1bce5":"### Clustering Universities into Public and Private using KMeans Algorithm:\n\n\n##### We usually don't see any labels when dealing with Clustering algorithm as it is an Unsupervised algorithm but here we will be considering the labels at the end to evaluate the model","ef32c33a":"#### Out of State Tuition based on the Private column:","5561ca8d":"#### Evaluation:\n\n##### There is no perfect way to evaluate clustering if you don't have the labels, however since we do have the labels, so we take advantage of this to evaluate our clusters\n\n\n##### Let's create a new column for df called 'Cluster', which is a 1 for a Private school, and a 0 for a public school:"}}