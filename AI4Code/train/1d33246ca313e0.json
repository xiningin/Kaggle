{"cell_type":{"eb78a358":"code","41fe3b33":"code","22379b02":"code","13a4e0db":"code","d3e1de83":"code","558b46b6":"code","bfddde7f":"code","4a1ed984":"code","b8dd4ee7":"code","53f14cd7":"code","cdda0286":"markdown"},"source":{"eb78a358":"!pip install openpyxl\n\n#Data Manipulation\nimport pandas as pd\nimport numpy as np\nimport openpyxl\nfrom openpyxl import load_workbook\nfrom openpyxl.styles import Font\nfrom openpyxl.chart import BarChart, Reference\nimport string","41fe3b33":"data=pd.read_excel('..\/input\/supermarket-sales\/supermarket_sales - Sheet1.csv')\ndata.columns","22379b02":"data[['Gender','Product line','Total']]","13a4e0db":"report_table=data.pivot_table(index='Gender',\n                             columns='Product line',\n                             values='Total',\n                             aggfunc='sum').round(0)\nreport_table","d3e1de83":"report_table.to_excel('SalesReport2021.xlsx',sheet_name='Report',startrow=4)","558b46b6":"#workbook reference\nwb=load_workbook('SalesReport2021.xlsx')\nsheet=wb['Report']\n\n#cell reference\nmin_column=wb.active.min_column\nmax_column=wb.active.max_column\nmin_row=wb.active.min_row\nmax_row=wb.active.max_row","bfddde7f":"print(min_column)\nprint(max_column)\nprint(min_row)\nprint(max_row)","4a1ed984":"#Barchart\nbarchart=BarChart()\n\n#locate Data\nbar_data= Reference(sheet,\n                   min_col=min_column+1,\n                   max_col=max_column,\n                   min_row=min_row,\n                   max_row=max_row)\nbar_categories= Reference(sheet,\n                   min_col=min_column,\n                   max_col=min_column,\n                   min_row=min_row+1,\n                   max_row=max_row)\n\n#adding data and categories\nbarchart.add_data(bar_data,titles_from_data=True)\nbarchart.set_categories(bar_categories)\n\n#location of chart\nsheet.add_chart(barchart,'B12')\n\nbarchart.title = 'Sales by Product line'\nbarchart.style = 4\n\nwb.save('SalesReport2021.xlsx')","b8dd4ee7":"alphabet=list(string.ascii_uppercase)\nexcel_alphabet=alphabet[0:max_column]\nexcel_alphabet","53f14cd7":"#Sum in columns B-G\nfor i in excel_alphabet:\n    if i!='A':\n        sheet[f'{i}{max_row+1}']=f'=SUM({i}{min_row}:{i}{max_row})'\n        sheet[f'{i}{max_row+1}'].style='Currency'\n        \n#Adding title\nsheet[f'{excel_alphabet[0]}{max_row+1}']='Total'\nsheet[f'{excel_alphabet[0]}{max_row+1}'].font=Font('Arial', bold=True, size=10)\n#Format Workbook\nsheet['A1'] = 'Sales Report'\nsheet['A2'] = '2021'\nsheet['A1'].font = Font('Arial', bold=True, size=20)\nsheet['A2'].font = Font('Arial', bold=True, size=10)\n\nwb.save('SalesReport2021.xlsx')","cdda0286":"# Importing Libraries"}}