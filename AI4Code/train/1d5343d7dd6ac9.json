{"cell_type":{"b3e8cc15":"code","ef3af542":"code","dd9e40ac":"code","d0f79430":"code","3fc1f5b6":"code","31c0724b":"code","476b5fe7":"code","72b31b30":"code","345585fe":"code","4f1f23d2":"code","d6ea6040":"code","589e233e":"code","e03edcfb":"code","db6354e0":"code","55e78146":"code","b7b379b7":"code","ebeb1b96":"markdown","45e3aae3":"markdown","fabb049a":"markdown","fbb439ec":"markdown"},"source":{"b3e8cc15":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","ef3af542":"df = pd.read_csv(\"..\/input\/advertising.csv\/Advertising.csv\")\ndf.head()","dd9e40ac":"# Understand my variables\nprint(df.columns)\ndf.describe()","d0f79430":"# Dropping redundant variables\ndf = df.copy().drop(['Unnamed: 0'],axis=1)","3fc1f5b6":"# Sanity check\nprint(df.columns)\nprint(df.shape)\ndf.isna().sum()","31c0724b":"# Calculate correlation matrix\ncorr = df.corr()\nsns.heatmap(corr, xticklabels=corr.columns, yticklabels=corr.columns, annot=True, cmap=sns.diverging_palette(220, 20, as_cmap=True))\n","476b5fe7":"# Scatterplot of all variables\nsns.pairplot(df)","72b31b30":"df.boxplot(\"TV\")","345585fe":"df.boxplot(\"radio\")","4f1f23d2":"df.boxplot(\"newspaper\")","d6ea6040":"X = df.loc[:, df.columns != 'sales']\ny = df['sales']","589e233e":"from sklearn.ensemble import RandomForestRegressor\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import mean_absolute_error as mae\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=.25, random_state=0)\nmodel = RandomForestRegressor(random_state=1)\nmodel.fit(X_train, y_train)\npred = model.predict(X_test)","e03edcfb":"feat_importances = pd.Series(model.feature_importances_, index=X.columns)\nfeat_importances.nlargest(25).plot(kind='barh',figsize=(10,10))","db6354e0":"import statsmodels.formula.api as sm\nmodelA = sm.ols(formula=\"sales~TV+radio+newspaper\", data=df).fit()\nmodelB = sm.ols(formula=\"sales~TV+radio+newspaper\", data=df).fit()\nprint(modelA.summary())\nprint(modelB.summary())","55e78146":"y_pred = modelB.predict()\nlabels = df['sales']\ndf_temp = pd.DataFrame({'Actual': labels, 'Predicted':y_pred})\ndf_temp.head()","b7b379b7":"from matplotlib.pyplot import figure\nfigure(num=None, figsize=(15, 6), dpi=80, facecolor='w', edgecolor='k')\n\ny1 = df_temp['Actual']\ny2 = df_temp['Predicted']\n\nplt.plot(y1, label = 'Actual')\nplt.plot(y2, label = 'Predicted')\nplt.legend()\nplt.show()","ebeb1b96":"# Exploratory Data Analysis","45e3aae3":"# Setup","fabb049a":"# OLS Model","fbb439ec":"# Feature Importance"}}