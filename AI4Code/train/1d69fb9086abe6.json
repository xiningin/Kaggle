{"cell_type":{"b27204ac":"code","4145d4b5":"code","edd7702e":"code","e8e21d76":"code","9ceccf68":"code","282a1ff2":"code","914e12f5":"code","6160a891":"code","77db4ece":"code","48363d89":"code","baf6aebc":"code","13b36170":"code","68251ac8":"code","8c3007b2":"code","043452b7":"code","1e773757":"code","f3472cb0":"code","be5eedf3":"code","0add156f":"code","c413e9bc":"code","3b6ed46b":"code","56f0ce87":"code","8311d349":"code","6983a99c":"code","1459e4e9":"code","5cbaedc4":"code","0455e108":"code","17596f1f":"code","dc077900":"code","283968a0":"code","71bb8e05":"code","124387ff":"markdown","d60b61ff":"markdown","16d9b981":"markdown","b9e2fc84":"markdown","a7ec1436":"markdown","6b0a9615":"markdown","aef0ac3d":"markdown","71947d0e":"markdown","511e17d2":"markdown","8018ee16":"markdown"},"source":{"b27204ac":"import numpy as np\nimport pandas as pd","4145d4b5":"data=pd.read_csv(\"..\/input\/creditcard.csv\")","edd7702e":"data.head()","e8e21d76":"data.describe()","9ceccf68":"data.Class.value_counts()","282a1ff2":"data.isna().sum()","914e12f5":"from matplotlib import pyplot as plt","6160a891":"import seaborn as sns","77db4ece":"sns.stripplot(data.Class[0:10000],data.Time[0:10000])\n    \n\n    ","48363d89":"data1=data[:10000]\ndata1.head()","baf6aebc":"for i in data1.columns:\n    print(i)\n    if i!='Class':\n        sns.stripplot(data1.Class,data1[i])\n        plt.show()\n#sns.stripplot(data.Class[0:10000],data.Time[0:10000])","13b36170":"####PREAPARING THE TRAINING DATA USING THE 10000 SAMPLES","68251ac8":"data_train_x=data1[['V17','V16','V14','V12','V11','V10','V9','V4','V3']].copy()","8c3007b2":"data_train_x.shape","043452b7":"data_train_y=data1['Class']\ndata_train_y.head()","1e773757":"from sklearn.linear_model import LogisticRegression\nfrom sklearn import metrics\nfrom sklearn.model_selection import train_test_split","f3472cb0":"X_train, X_test, y_train, y_test = train_test_split(data_train_x, data_train_y, test_size=0.3, random_state=0)","be5eedf3":"logreg = LogisticRegression()\nlogreg.fit(X_train, y_train)","0add156f":"y_pred = logreg.predict(X_test)\nprint('Accuracy of logistic regression classifier on test set: {:.2f}'.format(logreg.score(X_test, y_test)))","c413e9bc":"cnf_matrix = metrics.confusion_matrix(y_test, y_pred)\n","3b6ed46b":"cnf_matrix","56f0ce87":"y_tes=data.Class[10000:]","8311d349":"x_tes=data[['V17','V16','V14','V12','V11','V10','V9','V4','V3']].copy()\nx_tes=x_tes[10000:]","6983a99c":"y_pre=logreg.predict(x_tes)","1459e4e9":"cnf_mat = metrics.confusion_matrix(y_tes, y_pre)","5cbaedc4":"cnf_mat","0455e108":"logreg.score(x_tes, y_tes)","17596f1f":"from sklearn.metrics import recall_score\nprint(recall_score(y_tes, y_pre, average='macro'))\nprint(recall_score(y_tes, y_pre, average='micro'))\nprint(recall_score(y_tes, y_pre, average='weighted'))\nprint(recall_score(y_tes, y_pre, average=None))","dc077900":"from sklearn.metrics import average_precision_score","283968a0":"average_precision = average_precision_score(y_tes, y_pre)","71bb8e05":"print(average_precision)","124387ff":"Now running the fitted model to the entire dataset ie from 10000 to the end","d60b61ff":"Checking for Size of Data Set and Null values in Dataset","16d9b981":"# This Model Uses Logistic regression for Prdeicting a credit card Fraud","b9e2fc84":"ALL the Dependent Variables and the independent class variable are numbers ","a7ec1436":"For accuracy Matrix the confusion matrix is plotted with this data","6b0a9615":"IMPORTING NECESSARY LIBRARIES FOR DATA MANIPULATION","aef0ac3d":"Reading The downloaded CSV File","71947d0e":"# Implementing the Logistic Regression algorithm using 10000 samples by dividing it into test data and train data ","511e17d2":"Visualizing the dependency of the Class variable using all the inependednt variables.For simplicity as the data load takes so much time taken the sample size of first ten thousand records","8018ee16":"From the plot its clear that the variables that affect the Class are V17,V16,V14,V12,V11,V10,V9,V4,V3"}}