{"cell_type":{"2013c6fe":"code","8a46fec7":"code","d449f99b":"code","ad2f2294":"code","f558ed30":"code","33fd1079":"code","a736859d":"code","bab548fb":"code","43e33255":"code","1752e53f":"code","3533aa0c":"code","9ef3d465":"code","fe86a8bb":"code","922cf1ae":"code","ca461f0e":"code","a33130da":"code","81b81a4d":"code","0ba77851":"code","7e18d8b5":"markdown","136d5166":"markdown"},"source":{"2013c6fe":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\n\nimport matplotlib.pyplot as plt\n\nfrom keras.layers import Activation, Dropout, Flatten, Dense\nfrom keras.preprocessing.image import ImageDataGenerator, load_img\nfrom keras.layers import Conv2D, MaxPooling2D\nfrom keras.models import Sequential\n\nimport os","8a46fec7":"os.getcwd()","d449f99b":"os.listdir('..\/input\/chest_xray\/chest_xray')","ad2f2294":"img_name = 'IM-0119-0001.jpeg'\nimg_normal = load_img('..\/input\/chest_xray\/chest_xray\/train\/NORMAL\/' + img_name)\nplt.imshow(img_normal)\nplt.show()","f558ed30":"img_name = 'person1016_bacteria_2947.jpeg'\nimg_infected = load_img('..\/input\/chest_xray\/chest_xray\/train\/PNEUMONIA\/' + img_name)\n\nplt.imshow(img_infected)\nplt.show","33fd1079":"num_train_normal = os.listdir('..\/input\/chest_xray\/chest_xray\/train\/NORMAL\/')\nnum_train_pneumonia = os.listdir('..\/input\/chest_xray\/chest_xray\/train\/PNEUMONIA\/')","a736859d":"sns.set_style('whitegrid')\nsns.barplot(x = ['NORMAL', 'PNEUMONIA'], y = [len(num_train_normal),len(num_train_pneumonia)])","bab548fb":"infected = len(num_train_pneumonia)\nnormal = len(num_train_normal)\ntotal = infected + normal","43e33255":"print('INFECTED = ', infected)\nprint('NORMAL = ', normal)\nprint('TOTAl = ', total)","1752e53f":"image_height = 150 \nimage_width = 150\nbatch_size = 16\nnum_epoch = 10\n","3533aa0c":"model = Sequential()\n\nmodel.add(Conv2D(64,(3,3), strides = (1,1),input_shape=(image_height,image_width, 3), activation = 'relu'))\nmodel.add(MaxPooling2D(pool_size= (2,2)))\n\nmodel.add(Conv2D(64,(3,3), strides = (1,1), activation = 'relu'))\nmodel.add(MaxPooling2D(pool_size= (2,2)))\nmodel.add(Dropout(0.3))\n\nmodel.add(Conv2D(64,(3,3), strides = (1,1),activation = 'relu'))\nmodel.add(MaxPooling2D(pool_size= (2,2)))\n\nmodel.add(Conv2D(64,(3,3), strides = (1,1), activation = 'relu'))\nmodel.add(MaxPooling2D(pool_size= (2,2)))\nmodel.add(Dropout(0.2))\n\nmodel.add(Flatten())\n\nmodel.add(Dense(128, activation = 'relu'))\nmodel.add(Dropout(0.5))\nmodel.add(Dense(units = 1, activation= 'sigmoid'))\n\n\nmodel.compile(optimizer = 'adam', loss = 'binary_crossentropy', metrics = ['accuracy'])\n\n\n","9ef3d465":"model.summary()","fe86a8bb":"train_data_dir = '..\/input\/chest_xray\/chest_xray\/train'\nvalidation_data_dir = '..\/input\/chest_xray\/chest_xray\/val'\ntest_data_dir = '..\/input\/chest_xray\/chest_xray\/test'\n\n\n\n","922cf1ae":"# Rescale\ntrain_datagen = ImageDataGenerator(rescale = 1. \/ 255, shear_range = 0.1)\ntest_datagen = ImageDataGenerator(rescale = 1. \/ 255)\nval_datagen = ImageDataGenerator(rescale = 1.\/ 255)","ca461f0e":"train_generator = train_datagen.flow_from_directory(train_data_dir, target_size =(image_width, image_height), batch_size = batch_size,\n                                                    class_mode = 'binary')","a33130da":"test_generator = test_datagen.flow_from_directory(test_data_dir, target_size =(image_width, image_height), batch_size = batch_size,\n                                                    class_mode = 'binary')","81b81a4d":"val_generator = val_datagen.flow_from_directory(validation_data_dir, target_size =(image_width, image_height), batch_size = batch_size,\n                                                    class_mode = 'binary')","0ba77851":"model.fit_generator(\ntrain_generator,\nsteps_per_epoch = total\/\/ batch_size,\nepochs = num_epoch,\nvalidation_data = val_generator, \nvalidation_steps = 17\/\/ batch_size)","7e18d8b5":"**Pnemonia**","136d5166":"**NORMAL**"}}