{"cell_type":{"09e28f13":"code","ed736156":"code","f674eacd":"code","42ce80f4":"code","4d641935":"code","cd44724e":"code","7af5709c":"code","8a21cb17":"code","ade2387c":"code","8e8c913a":"code","3776f58d":"code","0cf72f95":"code","1f6f911b":"code","48f0b490":"markdown"},"source":{"09e28f13":"import numpy as np\nimport pandas as pd","ed736156":"trainpath='..\/input\/titanic\/train.csv'\ntestpath='..\/input\/titanic\/test.csv'\n\ntrain_data = pd.read_csv(trainpath)\ntest_data = pd.read_csv(testpath)","f674eacd":"print(\"Train nulls:\\n\",train_data.isnull().sum())\nprint(\"-\"*15)\nprint(\"Test nulls:\\n\",test_data.isnull().sum())","42ce80f4":"df = pd.concat([train_data,test_data],ignore_index=True)\ndf.groupby(\"SibSp\")[\"Age\"].mean()","4d641935":"df[\"Age\"] = df.groupby(\"SibSp\")[\"Age\"].apply(lambda x:x.fillna(x.mean()))\ndf.isnull().sum()","cd44724e":"Age_interval = pd.cut(df[\"Age\"],[0,10,20,30,40,50,60,70,80])\ndf['Age_interval'] = Age_interval\ndf.head()","7af5709c":"df.pivot_table((\"Survived\"),[Age_interval],[('Sex'),('Pclass')],dropna=True)","8a21cb17":"train_data = df[df['Survived'].notna()]\ntest_data = df[df['Survived'].isna()]","ade2387c":"from sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.model_selection import train_test_split\n\nfeatures = [\"Pclass\",\"Sex\",\"SibSp\",\"Parch\",\"Age_interval\"]\ny = train_data[\"Survived\"]\nX = pd.get_dummies(train_data[features])\n\nX_train,X_test,y_train,y_test = train_test_split(X,y,test_size=0.3, random_state=42)\n\nmodel = RandomForestClassifier(n_estimators=100,max_depth=5,random_state=1)\nmodel.fit(X_train,y_train)","8e8c913a":"test_predictions = model.predict(X_test)\nscore = accuracy_score(y_test,test_predictions)\nscore","3776f58d":"X_test = pd.get_dummies(test_data[features])\nPredictions = model.predict(X_test)","0cf72f95":"output1 = pd.DataFrame({'PassengerID':test_data.PassengerId,'Survived':Predictions})\noutput1.Survived = output1.Survived.astype(int)","1f6f911b":"output1.to_csv('.\/My_submission8.csv',index=False)","48f0b490":"# **Model Fitting**"}}