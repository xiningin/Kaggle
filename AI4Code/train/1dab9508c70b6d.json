{"cell_type":{"f570f8ce":"code","cfda50d0":"code","37cc04f8":"code","77be76f4":"code","101cab2a":"code","c921e845":"code","9b4cf3f3":"code","c1ba1aca":"code","203a21c2":"code","0c9eb78c":"code","589f9b0b":"code","0860ba1b":"code","28429fa2":"markdown","7c4bf395":"markdown","c31e24cd":"markdown","68e73e6e":"markdown","39ebcdae":"markdown","2883f0b6":"markdown","e28f33bb":"markdown","d8dd40e9":"markdown","78bf69fc":"markdown","5505fe8d":"markdown","233526ac":"markdown","7c8c5bf7":"markdown","594d924e":"markdown","331a760a":"markdown","9047d720":"markdown","e755cc53":"markdown","324b640d":"markdown"},"source":{"f570f8ce":"import numpy as np\nimport matplotlib.pyplot as plt\nimport pandas as pd","cfda50d0":"dataset = pd.read_csv('..\/input\/dataset\/Position_Salaries.csv')\nX = dataset.iloc[:, 1:-1].values\ny = dataset.iloc[:, -1].values","37cc04f8":"dataset.head()","77be76f4":"print(X)","101cab2a":"print(y)","c921e845":"from sklearn.linear_model import LinearRegression\nlin_reg = LinearRegression()\nlin_reg.fit(X, y)","9b4cf3f3":"from sklearn.preprocessing import PolynomialFeatures\npoly_reg = PolynomialFeatures(degree = 4)\nX_poly = poly_reg.fit_transform(X)\nlin_reg_2 = LinearRegression()\nlin_reg_2.fit(X_poly, y)","c1ba1aca":"plt.scatter(X, y, color = 'red')\nplt.plot(X, lin_reg.predict(X), color = 'blue')\nplt.title('Truth or Bluff (Linear Regression)')\nplt.xlabel('Position Level')\nplt.ylabel('Salary')\nplt.show()","203a21c2":"plt.scatter(X, y, color = 'red')\nplt.plot(X, lin_reg_2.predict(poly_reg.fit_transform(X)), color = 'blue')\nplt.title('Truth or Bluff (Polynomial Regression)')\nplt.xlabel('Position level')\nplt.ylabel('Salary')\nplt.show()","0c9eb78c":"X_grid = np.arange(min(X), max(X), 0.1)\nX_grid = X_grid.reshape((len(X_grid), 1))\nplt.scatter(X, y, color = 'red')\nplt.plot(X_grid, lin_reg_2.predict(poly_reg.fit_transform(X_grid)), color = 'blue')\nplt.title('Truth or Bluff (Polynomial Regression)')\nplt.xlabel('Position level')\nplt.ylabel('Salary')\nplt.show()","589f9b0b":"lin_reg.predict([[6.5]])","0860ba1b":"lin_reg_2.predict(poly_reg.fit_transform([[6.5]]))","28429fa2":"Now we have indeed a way more adaptive regression curve coming indeed much closer to the real result.\nSo if we compare these points where we had issues previously with the linear regression model well we can clearly see now that the issue is resolved because indeed the predictions on this blue curve come a way closer to the real salaries and this is only with N equals 4.","7c4bf395":"**Importing the Dataset**","c31e24cd":"**Visualising the Polynomial Regression results (for higher resolution and smoother curve)**","68e73e6e":"**Importing Libraries**","39ebcdae":"By using **Polynomial Regression**, the predicted salary is **one hundred and fifty eight**. Well actually one hundred fifty nine thousand dollars which is super close to the salary mentioned by this person.\n\nSo now we can be a hundred percent confident to hire this person because not only it is a good fit for the job but also it is a very harnessed person and we figured that out with polynomial regression. So that concludes the basic of **Polynomial Regression** with comparison with **Linear Regression**. Please add if is missed something and correct me if there is any mistake.","2883f0b6":"**Training the Linear Regression model on the whole dataset**","e28f33bb":"**Visualising the Linear Regression results**","d8dd40e9":"Well let's imagine the following scenario. Let us imagine that we are actually an HR department and that we want to hire someone and we actually found someone that seems to be a great fit for the job. So we would like to offer this person a position in our company.\n\nAnd so this person says yes but at the end of the interview process comes the inevitable question What is your salary expectation and the person is asking for one hundred and sixty thousand dollars per year and then also as H.R. negotiators we ask this person why are you expecting such a high salary and this person replies Well that's because that's what I earned in my previous company.\n\nThat was my salary in my previous company I earned one hundred and sixty thousand dollars per year so I am expecting at least one hundred and sixty thousand dollars per year in your company.\n\nIs that the truth or is that a bluff. Well that's exactly what we're gonna figure out thanks to our polynomial regression model. We're going to build a polynomial regression model to predict the previous salary of this candidate.\n\nSo, we have a data set in which we have 3 columns named as (Position, Level, Salary). \n**Position:** have descriptive values\n**Level:** Unique value assigned to each position\n**Salary:** Position wise salaries.\n\nSo in order to extrapolate we're going to suppose that this person has a position in between six and seven level and we'll consider this position to be six point five. So that then we can actually deploy our moral you know after training it of course on the position level six point five so that we can get the predicted salary of such a position level and we will compare this predicted salary to the salary expected by this person to see if indeed there is truth or bluff.\n\nSo that's the strategy.","78bf69fc":"We have just droped the column **Position** from the main dataset as it is column **Level** already have unique value for each **Position.**","5505fe8d":"All right.\n\nSo first of all to recap the red points here are the real salaries you know going from zero to I think one million for the CEO so these are all the real salaries of this column.\n\nAnd then the blue line is of course the regression line containing all our predictions but the predictions of the linear regression model. So first of all we can see that indeed the linear regression model is not well adapted to this dataset.\n\nWell the prediction is far from the real result here. Imagine if we wanted to use that model to predict if someone is saying the truth or bluffing about a salary that is contained here. Well you know we would have offered a way higher salary than we would be supposed to.\n\nSo that would not be the best negotiation. So that linear regression model is not well adapted.","233526ac":"**Predicting a new result with Polynomial Regression**","7c8c5bf7":"**Training the Polynomial Regression model on the whole dataset**","594d924e":"**Predicting a new result with Linear Regression**","331a760a":"let's remember that this person asked for a 160 K salary and this is justified by the fact that this person earned a one hundred sixty K salary in the previous company which is what we have to check right now and we're going to check that first with the linear regression model which returns indeed a salary of three hundred and thirty thousand dollars per year.\n\nSo if we actually use this model to negotiate with that person we would actually find it super weird\nright. Because this predicted salary is way over the real salary that this person had in its previous company.\n\nSo clearly the prediction here is wrong. And you know that's what we can clearly see on the graph.","9047d720":"We are comparing here two Regression Model Linear Regression and Polynomial Regression.","e755cc53":"So that's what we'll do in this next and last tutorial we will first predict that salary of the position level 6.5 with linear regression and then with polynomial regression","324b640d":"**Visualising the Polynomial Regression results**"}}