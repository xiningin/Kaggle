{"cell_type":{"1f40ba49":"code","59497716":"code","ef521897":"code","26e0bd2b":"code","e8a2c994":"code","ff6b7ebf":"code","dc5c8f6e":"code","6239fe89":"code","efe6519d":"code","54aede24":"code","a40bd69c":"code","737149ad":"code","03f136b9":"code","756932cf":"code","60342743":"code","5ac04cb9":"code","c28fd7fc":"code","e96a3635":"code","d8a3ace9":"code","7c59b8dd":"code","e739b756":"code","0560fe75":"markdown","cc068cfa":"markdown","73bc9ae9":"markdown","09b09d7c":"markdown"},"source":{"1f40ba49":"%reload_ext autoreload\n%autoreload 2\n%matplotlib inline","59497716":"import os\nfrom fastai import *\nfrom fastai.vision import *","ef521897":"os.listdir(\"..\/input\/parkinsons-drawings\/\")","26e0bd2b":"path = Path('..\/input\/parkinsons-drawings\/')\n","e8a2c994":"path.ls()","ff6b7ebf":"bs = 64\nsize = 224\nnum_workers = 0 ","dc5c8f6e":"tfms = get_transforms()                               #Do standard data augmentation\ndata = (ImageList.from_folder(path)               #Get data from path\n        .split_by_rand_pct()                        #Randomly separate 20% of data for validation set\n        .label_from_folder()                          #Label based on dir names\n        .transform(tfms, size=size)                   #Pass in data augmentation\n        .databunch(bs=bs, num_workers=num_workers)    #Create ImageDataBunch\n        .normalize(imagenet_stats))                   #Normalize using imagenet stats","6239fe89":"print(len(data.train_ds))\nprint(len(data.valid_ds))","efe6519d":"data.classes","54aede24":"data.show_batch(rows=3, figsize=(7,6))","a40bd69c":"learn = create_cnn(data, models.resnet50, metrics=accuracy, model_dir='\/tmp\/models')\n","737149ad":"learn.fit_one_cycle(4)","03f136b9":"learn.save('stage-1')","756932cf":"learn.unfreeze()","60342743":"learn.lr_find()\nlearn.recorder.plot(suggestion=True)","5ac04cb9":"learn.fit_one_cycle(2, max_lr=slice(1e-6,1e-4))","c28fd7fc":"learn.save('stage-2')","e96a3635":"interp = ClassificationInterpretation.from_learner(learn)\nlosses,idxs = interp.top_losses()\nlen(data.valid_ds)==len(losses)==len(idxs)","d8a3ace9":"interp.plot_top_losses(9, figsize=(15,11))","7c59b8dd":"interp.plot_confusion_matrix(figsize=(9,9), dpi=60)","e739b756":"interp.most_confused(min_val=2)","0560fe75":"Import data","cc068cfa":"**Visualization of Data**","73bc9ae9":"Create Learner using pre-trained model\n\nWe use Resnet-50","09b09d7c":"**Create Data Block**"}}