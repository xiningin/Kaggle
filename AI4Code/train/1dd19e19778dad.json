{"cell_type":{"acc2f0bf":"code","a073e34c":"code","ce06fad6":"code","b73ddccb":"code","73f019ff":"code","d3f6dc74":"code","c8092b88":"code","ecdb5fb2":"code","e76b0fc7":"code","3c589edb":"code","501fefc4":"code","2808e4ef":"code","04f332f0":"code","910cbd4b":"code","de31f3ba":"code","bc31a203":"code","9a5f4a79":"code","ca79ae6a":"code","d3ebfdbc":"code","663e5cae":"code","389943d1":"code","6399e974":"code","11469e51":"code","ad54d988":"code","b1658fe1":"code","8e5e4513":"code","18892549":"code","496b4e8b":"code","71abc5b5":"code","a443cad2":"code","7e3008d2":"code","5ce56b29":"code","0f17110f":"code","28c165e7":"code","b58a51f2":"code","720dcda0":"code","6cdd977d":"code","9e77dd57":"code","40d166ac":"code","cc8a6c35":"code","a4cbdbd6":"code","9a9f14e0":"code","c32705ab":"code","8bc7e7f0":"code","96b23073":"code","a3568155":"code","5647bf48":"code","2d80022d":"code","8ca91b5a":"code","12cd9ddd":"code","86382135":"markdown","db946cb1":"markdown","9218d3f9":"markdown","2ba871ad":"markdown","aaee5add":"markdown","8f780aa9":"markdown","a62492f5":"markdown","bea975a7":"markdown","c884ea70":"markdown","6ade3bcd":"markdown","d82b40a2":"markdown","e0d5deb0":"markdown","7d604eeb":"markdown","6b9d624b":"markdown","395c55dd":"markdown","7e01e43d":"markdown","c4acde23":"markdown","17fd3ce2":"markdown","ba67fb15":"markdown"},"source":{"acc2f0bf":"import warnings\nwarnings.filterwarnings('ignore')","a073e34c":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\nimport seaborn as sns\nimport matplotlib.pyplot as plt","ce06fad6":"df= pd.read_csv('..\/input\/iris\/Iris.csv')\ndf1=df.copy()\ndf","b73ddccb":"df.info()","73f019ff":"df.describe(include='all')","d3f6dc74":"df.duplicated().sum()","c8092b88":"df.Species.hist(edgecolor='black', linewidth=2);","ecdb5fb2":"## df.isnull()\ndf.isna().sum()","e76b0fc7":"df.notna().mean()*100","3c589edb":"df.skew()","501fefc4":"### axis =1 for columns\n## Axis =0 for rows\n\ndf.drop('Id', axis=1, inplace=True)","2808e4ef":"df.hist(edgecolor='Black', linewidth=2, figsize=(8,5));\nplt.tight_layout()","04f332f0":"j= 1\nplt.figure(figsize=(22,7))\nfor i in df.select_dtypes('number'):\n    plt.subplot(1,4,j)\n    sns.distplot(df[i], rug=True );\n    j= j+1\nplt.show()","910cbd4b":"df.kurt()","de31f3ba":"plt.title('Species Count')\nsns.countplot(df['Species'], palette='flare');","bc31a203":"plt.figure(figsize=(12,6))\nplt.title('Comparison between sepal width and length on the basis of species')\nsns.scatterplot(df['SepalLengthCm'], df['SepalWidthCm']);","9a5f4a79":"plt.figure(figsize=(12,6))\nplt.title('Comparison between sepal width and length on the basis of species')\nsns.scatterplot(df['SepalLengthCm'], df['SepalWidthCm'], hue = df['Species']);","ca79ae6a":"plt.figure(figsize=(16,6))\nplt.title('Comparison between petal width and length')\nsns.scatterplot(df['PetalLengthCm'], df['PetalWidthCm']);","d3ebfdbc":"plt.figure(figsize=(12,6))\nplt.title('Comparison between petal width and length on the basis of species')\nsns.scatterplot(df['PetalLengthCm'], df['PetalWidthCm'], hue = df['Species']);","663e5cae":"sns.pairplot(df,hue=\"Species\",height=3);","389943d1":"df.corr()","6399e974":"fig = plt.figure(figsize = (15,9))\nsns.heatmap(df.corr(), cmap='Blues', annot = True);","11469e51":"### KDE vs Contour\nsns.kdeplot(data=df, x=\"SepalLengthCm\", hue=\"Species\");","ad54d988":"sns.kdeplot(data=df, x=\"SepalLengthCm\", hue=\"Species\", multiple=\"stack\");","b1658fe1":"sns.kdeplot(data=df, x=\"SepalLengthCm\", hue=\"Species\", multiple=\"fill\");","8e5e4513":"plt.figure(figsize=(12,4))\nplt.subplot(1,2,1)\nsns.scatterplot(data=df, x=\"SepalLengthCm\", y=\"SepalWidthCm\");\nplt.title('Scatter Plot', fontsize=20)\nplt.subplot(1,2,2)\nsns.kdeplot(data=df, x=\"SepalLengthCm\", y=\"SepalWidthCm\");\nplt.title('Contour Plot', fontsize=20)\nplt.show();","18892549":"df_setosa = df[df['Species']=='Iris-setosa']\ndf_setosa ### Created a dataframe of only setosa\n\nplt.figure(figsize=(18,4))\nplt.subplot(1,4,1)\nsns.scatterplot(data=df_setosa, x=\"PetalLengthCm\", y=\"PetalWidthCm\");\nplt.title('Scatter Plot', fontsize=20)\nplt.subplot(1,4,2)\nsns.kdeplot(data=df_setosa,  x=\"PetalLengthCm\", y=\"PetalWidthCm\");\nplt.title('Contour Plot', fontsize=20)\nplt.subplot(1,4,3)\nsns.scatterplot(data=df_setosa, x=\"PetalLengthCm\", y=\"PetalWidthCm\", color='black');\nsns.kdeplot(data=df_setosa,  x=\"PetalLengthCm\", y=\"PetalWidthCm\");\nplt.title('Contour + Scatter Plot', fontsize=20)\nplt.subplot(1,4,4)\nsns.kdeplot(data=df_setosa,  x=\"PetalLengthCm\", y=\"PetalWidthCm\", fill=True);\nplt.title('Contour Heatmap', fontsize=20)\nplt.tight_layout()\nplt.show();","496b4e8b":"sns.kdeplot(data=df, x=\"SepalLengthCm\", y=\"SepalWidthCm\", hue=\"Species\");","71abc5b5":"sns.kdeplot(data=df, x=\"SepalLengthCm\", y=\"SepalWidthCm\", fill=True);","a443cad2":"sns.kdeplot(data=df, x=\"SepalLengthCm\", y=\"SepalWidthCm\", hue=\"Species\", fill=True, palette = 'Paired');","7e3008d2":"g= sns.FacetGrid(df, hue='Species', height=5).map(sns.histplot,'PetalWidthCm').add_legend();\ng.fig.suptitle('Demo of FacetGrid');","5ce56b29":"sns.FacetGrid(df,hue=\"Species\",height=5).map(sns.distplot,\"PetalWidthCm\").add_legend();","0f17110f":"sns.FacetGrid(df,hue=\"Species\",height=5).map(sns.distplot,\"PetalLengthCm\").add_legend();","28c165e7":"sns.FacetGrid(df,hue=\"Species\",height=5).map(sns.distplot,\"SepalLengthCm\").add_legend();","b58a51f2":"sns.FacetGrid(df,hue=\"Species\",height=5).map(sns.distplot,\"SepalWidthCm\").add_legend();","720dcda0":"fig, axes = plt.subplots(2, 2, figsize=(16,9))\nsns.boxplot(  y=\"PetalWidthCm\",  x= \"Species\", data=df,  orient='v' , ax=axes[0, 0])\nsns.boxplot(  y=\"PetalLengthCm\", x= \"Species\", data=df,  orient='v' , ax=axes[0, 1])\nsns.boxplot(  y=\"SepalWidthCm\",  x= \"Species\", data=df,  orient='v' , ax=axes[1, 0])\nsns.boxplot(  y=\"SepalLengthCm\", x= \"Species\", data=df,  orient='v' , ax=axes[1, 1])\nplt.show()","6cdd977d":"fig, axes = plt.subplots(2, 2, figsize=(16,9))\nsns.violinplot(y=\"PetalWidthCm\",  x= \"Species\", data=df,  orient='v' , ax=axes[0, 0])\nsns.violinplot(y=\"PetalLengthCm\", x= \"Species\", data=df,  orient='v' , ax=axes[0, 1])\nsns.violinplot(y=\"SepalWidthCm\",  x= \"Species\", data=df,  orient='v' , ax=axes[1, 0])\nsns.violinplot(y=\"SepalLengthCm\", x= \"Species\", data=df,  orient='v' , ax=axes[1, 1])\nplt.show()","9e77dd57":"sns.relplot(y=\"PetalLengthCm\",  x= \"Species\", data=df,  hue='Species');","40d166ac":"### Another way to for subplot ###\n\nplt.figure(figsize=(12,8))\nplt.subplot(2,2,1)\nsns.scatterplot(y=\"PetalWidthCm\",  x= \"Species\", data=df,  hue='Species')\nplt.grid(True)\nplt.subplot(2,2,2)\nsns.scatterplot(y=\"PetalLengthCm\",  x= \"Species\", data=df,  hue='Species')\nplt.grid(True)\nplt.subplot(2,2,3)\nsns.scatterplot(y=\"SepalWidthCm\",  x= \"Species\", data=df,  hue='Species')\nplt.grid(True)\nplt.subplot(2,2,4)\nsns.scatterplot(y=\"SepalLengthCm\",  x= \"Species\", data=df,  hue='Species')\nplt.grid(True)\nplt.tight_layout()\nplt.show()","cc8a6c35":"from sklearn.tree import DecisionTreeClassifier","a4cbdbd6":"##### For the time being lets only use PetalLength and PetalWidth only #####\n\ny= df.pop('Species')\nx= df.iloc[:, 2:]\ndisplay(y.sample(5))\nprint('training dataset')\ndisplay(x.sample(5))","9a9f14e0":"### Defining a decision Tree Model\ntree_clf1= DecisionTreeClassifier(max_depth=2)","c32705ab":"### Fiting the model on dataset\ntree_clf1.fit(x,y)","8bc7e7f0":"!pip install graphviz","96b23073":"from sklearn.tree import export_graphviz","a3568155":"export_graphviz(\n            tree_clf1,\n            out_file='tree.dot',\n            feature_names=df.columns[2:],\n            class_names=df1.Species,\n            rounded=True,\n            filled=True\n        )","5647bf48":"from subprocess import call\ncall(['dot', '-Tpng', 'tree.dot', '-o', 'tree.png', '-Gdpi=600'])\n# Display in jupyter notebook\nfrom IPython.display import Image\nImage(filename = 'tree.png',width = 400, height = 200)","2d80022d":"### Now will perform same thing for petal but with depth = 4\n\n### Defining a decision Tree Model\ntree_clf1D= DecisionTreeClassifier(max_depth=4)\n### Fiting the model on dataset\ntree_clf1D.fit(x,y)\n\nexport_graphviz(\n            tree_clf1D,\n            out_file='tree-depth4.dot',\n            feature_names=df.columns[2:],\n            class_names=df1.Species,\n            rounded=True,\n            filled=True\n        )\n\nfrom subprocess import call\ncall(['dot', '-Tpng', 'tree-depth4.dot', '-o', 'tree-depth4.png', '-Gdpi=600'])\n\n# Display in jupyter notebook\nImage(filename = 'tree-depth4.png')","8ca91b5a":"### Now will perform same thing for sepal\nx1= df.iloc[:, 0:2]\nprint('y being same')\nprint()\nprint('training dataset for Sepal')\ndisplay(x1.sample(5))\n\n\n### Defining a decision Tree Model\ntree_clf2= DecisionTreeClassifier(max_depth=2)\n### Fiting the model on dataset\ntree_clf2.fit(x1,y)\n\n\nexport_graphviz(\n            tree_clf2,\n            out_file='Sepaltree.dot',\n            feature_names=df.columns[:2],\n            class_names=df1.Species,\n            rounded=True,\n            filled=True\n        )\n\nfrom subprocess import call\ncall(['dot', '-Tpng', 'Sepaltree.dot', '-o', 'Sepaltree.png', '-Gdpi=600'])\n\n# Display in jupyter notebook\nImage(filename = 'Sepaltree.png',width = 700, height = 350)","12cd9ddd":"print('For Petal model trained for depth of 2')\nImage(filename = 'tree.png',width = 500, height = 250)\n","86382135":"### Before training a model we must **split the dataset** but I haven't because I am using DT for analysis not prediction.","db946cb1":"### Correlation Between Variables\n![1200px-Correlation_examples2.svg (1).png](attachment:7f845387-47ae-4f3f-8309-86c4668f287a.png)","9218d3f9":"# Conclusion from Data Analysis\n\n*     The dataset is balanced i.e. equal records are present for all three species.\n*     We have four numerical columns while just one categorical column which in turn is our target column.\n*     A strong correlation is present between petal width and petal length.\n*     The setosa species is the most easily distinguishable because of its small feature size.\n*     The Versicolor and Virginica species are usually mixed and are sometimes hard to separate, while usually Versicolor has average feature sizes and virginica has larger feature sizes.\n* Petal Length and width can help us predict label easily","2ba871ad":"## Kurtosis vs Skew\nDefination in 1 line\n* Skew is about `distributional symmetry`\n* Kurtosis is about the `thickness` of the `tails` or(and) the `center of distribution.` ","aaee5add":"# Introduction to IRIS Dataset","8f780aa9":"### Effects of skewness\nReal life distributions are usually skewed. If there are too much skewness in the data, then many statistical model don\u2019t work but why.\n\n**So in skewed data, the tail region may act as an outlier for the statistical model and we know that outliers adversely affect the model\u2019s performance especially regression-based models.** \nThere are statistical model that are robust to outlier like a Tree-based models but it will limit the possibility to try other models. So there is a necessity to transform the skewed data to close enough to a Gaussian distribution or Normal distribution. This will allow us to try more number of statistical model.\n\nExamples:  \n* **Positive skewness** Wealth Distribution,comment length \n* **Symmetrical Distribution** Age , weight, height distribution etc `Most of the ML Prefer this distribution`\n* **Negative Skew** Life span (some die early some out live avg age)\n\n### How to solve for Skewness in \n**Log transformation:**  \n***A log transformation can help to fit a very skewed distribution into a Gaussian one.*** After log transformation we can easily see pattern in our data.","a62492f5":"## Ploting the decision tree","bea975a7":"`NOTE: How histogram is different from barplot`  \nUnlike a bar chart, the area of a bar in a histogram represents the frequency, not the height. The frequency is calculated by multiplying the width of the bin by the height. The height of a bar in a histogram indicates frequency (counts) only if the bin widths are evenly spaced. For example, if you are plotting magnitudes of earthquakes and your bins are 3-5, 5-7 and 7-9, each bin is spaced two numbers apart and so the height of the bar would equal the frequency. However, histograms don\u2019t always have even bins. When a histogram has uneven bins, the height does not equal the frequency.","c884ea70":"**What is STD?**  \nStandard deviation measures the spread of a data distribution. It measures the typical distance between each data point and the mean.\n\n***What is IQR?***   \ninterquartile range (IQR) is a `measure of statistical dispersion`, which is the spread of the data.\n\n***What is Outlier?***   \nOutliers here are defined as observations that fall below Q1 \u2212 1.5 IQR or above Q3 + 1.5 IQR. Or outlier is a data point that differs significantly from other observations\n\n![1_NRlqiZGQdsIyAu0KzP7LaQ (1).png](attachment:64fbaa36-6eb5-4d85-812d-80549997d6df.png)\n\n**What is percentile  **\n\n![percentile.png](attachment:4d66454e-d85c-4be4-b10a-3890076e3ffc.png)\n\n![1_oHu3Qpq-8rRQ3fJL2p6ewg.png](attachment:a42c1651-cbfb-4f18-b3ef-11c2320e1239.png)\n\n***Why do we square and then under root in std?*** [Source: Quora](https:\/\/www.quora.com\/We-use-square-and-square-root-to-find-standard-deviation-but-why-not-use-a-cube-and-root-cube)    \nThere is a short way and a longer way to answer this question. The short answer is that the point of squaring the difference between a sample value and the sample mean is so that deviations in either direction count in the same direction. In other words, having one sample 3 under and another sample 3 over the mean would cancel rather than accumulate as is needed for a measure of deviation. Cubing the difference would not remedy the cancellation \/ accumulation problem, but squaring does.\n\nWhy not use the absolute value, which would remedy the sign (+\/-) problem described above, without transforming the data by squaring it? I don't know, and have wondered that myself. It could be that a square transform has some properties that are favorable for particular purposes but I don't know what those considerations might be. Conceptually the absolute value would be more transparent than a square, but a statistician would need to answer that.\n\nPlainly though, the cube simply would not provide a valid measure of deviation because different directions would cancel each other rather than accumulate.","6ade3bcd":"### **FacetGrid**  \nsns.FacetGrid(df, col='Species').map(sns.histplot, 'SepalLengthCm')  \nsns.FacetGrid(df, hue='Species',height=5).map(sns.histplot, 'SepalLengthCm')  \n\n### 1. Setup FacetGrid\nsns.FacetGrid()  \n### 2. Specify plot type\ng.map()  \ng.map_dataframe()  \n### 3. Customise FacetGrid using `Methods and Attributes` of FacetGrid","d82b40a2":"### What is Kurtosis?\nLike skewness, `kurtosis is a statistical measure that is used to describe distribution.` Whereas *skewness differentiates extreme values in one versus the other tail,* ***kurtosis measures extreme values in either tail. Distributions with large kurtosis exhibit tail data exceeding the tails of the normal distribution*** (e.g., five or more standard deviations from the mean). **Distributions with low kurtosis exhibit tail data that are `generally less extreme` than the tails of the normal distribution.**","e0d5deb0":"[Read more about distribution functions on](https:\/\/www.analyticsvidhya.com\/blog\/2021\/07\/probability-types-of-probability-distribution-functions\/)","7d604eeb":"So what is this petal Length Cm and all  \nand what is **sepal** and **petal**  \n\n\n![petal vs sepal.jpg](attachment:b65d35c3-ec20-4b7b-9259-4002ed4e6d60.jpg)\n\n![1_nfK3vGZkTa4GrO7yWpcS-Q.png](attachment:28c23381-7798-4c06-aafc-6d8df2675a7b.png)","6b9d624b":"*     The Highest frequency of sepal width is between 3.0 to 3.5 which is around 70.\n*     The Highest frequency of sepal length is between 5.5 and 6.0 which is around 35.\n*     The Highest frequency of petal width is between 0 to 0.5 which is around 50.\n*     The Highest frequency of petal length is between 0 to 0.5 which is around 50.","395c55dd":"## Univariate Analysis of our columns\nUnivariate analysis is the simplest form of analyzing data. \u201cUni\u201d means \u201cone\u201d, so in other words your data has only one variable. It doesn't deal with causes or relationships (unlike regression ) and it's major purpose is to describe; It takes data, summarizes that data and finds patterns in the data.","7e01e43d":"## Bivariate distribution","c4acde23":"Checking for **Skew** and **Kurt**  \n![1_nj-Ch3AUFmkd0JUSOW_bTQ.jpeg](attachment:f07ce888-16ba-4ad6-82eb-064e8a790518.jpeg)\n\n![skw.png](attachment:f8595b04-dd08-4d63-bb9f-5c2e9a793fa3.png)","17fd3ce2":"# Decision Tree\n`Note:` This is not the way to create model, I am using DT for analysis purpose only.\n\n![photo_2021-12-06_23-11-25.jpg](attachment:99734881-7055-4047-929d-c6ef0f184f1f.jpg)","ba67fb15":"# Vizualization with Seaborn"}}