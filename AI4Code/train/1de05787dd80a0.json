{"cell_type":{"d35dbd93":"code","f7a07a97":"code","5bf07ba2":"code","42c96592":"code","8bb76e5c":"code","2bfb30fd":"code","d176ae3e":"code","6da3576d":"code","c5357fe9":"code","f47b1455":"code","dcc2bba8":"code","89035043":"code","c64f7f66":"code","a2fb1ca6":"code","6ac4fbcc":"code","bfc19b62":"code","fded0952":"code","8cf65f11":"code","8706a7f1":"code","19f8ab14":"code","60df7368":"code","8529d01b":"code","d472f650":"code","c099c41a":"code","04ce2c5f":"code","c2e41b8d":"code","1b5cfabe":"code","6d833ad8":"code","27599a39":"markdown","9033eec3":"markdown","27e31023":"markdown","25e3171e":"markdown","10d0721f":"markdown"},"source":{"d35dbd93":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import classification_report, accuracy_score, confusion_matrix\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.ensemble import RandomForestClassifier, BaggingClassifier, GradientBoostingClassifier","f7a07a97":"df = pd.read_csv('..\/input\/health-care-data-set-on-heart-attack-possibility\/heart.csv')\ndf.head()","5bf07ba2":"df.shape","42c96592":"df.info()","8bb76e5c":"df.isnull().sum()","2bfb30fd":"df.shape","d176ae3e":"df.columns","6da3576d":"catcols = ['sex', 'cp', 'fbs', 'restecg', 'exang', 'slope', 'ca',\t'thal']\nnumcols = ['age', 'trestbps', 'chol', 'thalach', 'oldpeak']","c5357fe9":"plt.figure(figsize=(10,15))\nfor i in range(0,8):\n  plt.subplot(4,2,i+1)\n  sns.barplot(df['target'], df[catcols[i]])","f47b1455":"plt.figure(figsize=(10,15))\nfor i in range(0,8):\n  plt.subplot(4,2,i+1)\n  sns.countplot(df[catcols[i]], hue ='target', data = df)","dcc2bba8":"plt.figure(figsize=(10,15))\nfor i in range(0,5):\n  plt.subplot(4,2,i+1)\n  sns.distplot(df[numcols[i]])","89035043":"plt.figure(figsize=(10,15))\nfor i in range(0,5):\n  plt.subplot(4,2,i+1)\n  sns.boxplot(df[numcols[i]])","c64f7f66":"plt.figure(figsize=(12,6))\nsns.heatmap(df.corr(),annot=True)","a2fb1ca6":"plt.figure(figsize=(8,4))\nsns.violinplot(x='target',y='thalach',data=df)\nplt.title('violen plot for target and thalach variable')","6ac4fbcc":"plt.figure(figsize=(8,4))\nsns.lineplot(x='target',y='thalach',data=df)\nplt.title('line plot for target and thalach variable')","bfc19b62":"plt.figure(figsize=(8,4))\nsns.barplot(x='target',y='cp',data=df)\nplt.title('bar plot for target and cp variable')","fded0952":"from scipy import stats\nimport numpy as np\nz = np.abs(stats.zscore(df))\nprint(np.where(z > 3))","8cf65f11":"df_withoutoutlier = df[(z < 3).all(axis=1)]","8706a7f1":"X = df_withoutoutlier.copy()\nX = X.drop('target', axis =1)\ny = df_withoutoutlier['target']","19f8ab14":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.25, random_state =100)","60df7368":"X_train.shape, X_test.shape, y_train.shape, y_test.shape","8529d01b":"model_LG = LogisticRegression()\nmodel_LG.fit(X_train, y_train)\ny_pred = model_LG.predict(X_test)\nprint(classification_report(y_test, y_pred))","d472f650":"print(confusion_matrix(y_test, y_pred))","c099c41a":"model_RF = RandomForestClassifier()\nmodel_RF.fit(X_train, y_train)","04ce2c5f":"data = pd.Series(model_RF.feature_importances_, index = X_train.columns)","c2e41b8d":"data.sort_values(ascending=True, inplace=True)","1b5cfabe":"data.plot.barh()","6d833ad8":"y_pred = model_RF.predict(X_test)\nprint(classification_report(y_test, y_pred))","27599a39":"Attribute Information\n1) age\n2) sex\n3) chest pain type (4 values)\n4) resting blood pressure\n5) serum cholestoral in mg\/dl\n6)fasting blood sugar > 120 mg\/dl\n7) resting electrocardiographic results (values 0,1,2)\n8) maximum heart rate achieved\n9) exercise induced angina\n10) oldpeak = ST depression induced by exercise relative to rest\n11)the slope of the peak exercise ST segment\n12) number of major vessels (0-3) colored by flourosopy\n13) thal: 0 = normal; 1 = fixed defect; 2 = reversable defect\n14) target: 0= less chance of heart attack 1= more chance of heart attack","9033eec3":"The dataset is small since i am removing outliers from the datset for better model","27e31023":"Exploratory Data Analysis of all the variables","25e3171e":"Important Features of the dataset","10d0721f":"Logistic Regression gives the best results on the above dataset or we can also build our model using some best features."}}