{"cell_type":{"2dac9029":"code","56ae1a31":"code","01697f84":"code","39f410d4":"code","482e0a4c":"code","9b861621":"code","feb0183b":"code","06a5bff5":"code","dddc05a4":"code","cedca591":"markdown","72a6abb6":"markdown","0f50448f":"markdown","433c50db":"markdown"},"source":{"2dac9029":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/competition\" directory.","56ae1a31":"df = pd.read_csv(\"..\/input\/predicting-traffic-on-a-bridge\/commuters_clf_train.csv\")\ndf.head()","01697f84":"X = df[['weekday', 'hour']]\ny = df.crowded","39f410d4":"from sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.model_selection import GridSearchCV\n\nclf = KNeighborsClassifier()\n\nparam_grid = [\n    {'n_neighbors': range(1, 100, 20)}\n]\n\nsearch = GridSearchCV(clf, param_grid, cv=10)\n\nsearch.fit(X, y)\nprint(\"Best parameter (CV score={:.2f}):{})\".format(search.best_score_, search.best_params_))","482e0a4c":"df_test = pd.read_csv(\"..\/input\/predicting-traffic-on-a-bridge\/commuters_clf_test.csv\").set_index('index')  # important - setting the index!\ndf_test.head()","9b861621":"prediction = search.predict(df_test[['weekday', 'hour']])\nprediction","feb0183b":"# set the prediction column to crowded (see sample-submission csv file)\ndf_test['crowded'] = prediction","06a5bff5":"df_test.head()","dddc05a4":"df_submission = df_test[['crowded']]  # important - only provide the target column\ndf_submission.reset_index(inplace=True) # important - the column \"index\" is required for submission\n\ndf_submission.to_csv('submission.csv', index=False)  # index=False is important - there shouldn't be another pandas index!\ndf_submission.head()","cedca591":"# Read the training data and create feature matrix + target vector","72a6abb6":"# Use this model to predict the unlabeled test data","0f50448f":"# Find a good configuration for a first model, based on kNN","433c50db":"# Write your prediction to a submission csv file\n# Only the columns \"index\" and \"crowded\" are relevant - see competition description and sample-submission csv."}}