{"cell_type":{"3117f7e5":"code","4e3bfbba":"code","69d22bdc":"code","f55cb679":"code","9a843e96":"code","6c7b262d":"code","6ef5d0a4":"code","a5d0c8b1":"code","c8f1999b":"code","d440b99c":"code","35cf3cfe":"code","a2eb2554":"code","00773162":"code","59e346ff":"code","64582e72":"code","47d044c2":"code","77d235fa":"code","7481c079":"code","0877851e":"code","7e73634f":"code","1fbe87b8":"code","cc79a3c2":"code","e2e9dbd4":"code","8ef64605":"code","521a11b5":"code","b3f99744":"code","60ab5557":"code","f660db9e":"code","454ba74a":"code","836294c3":"code","14dd423c":"code","a3aefb25":"code","82e7bdec":"code","56d74df3":"code","3a6760bb":"code","7e66f704":"code","9e20f845":"code","b30fd24f":"code","b34cf3e6":"code","83b8b7c3":"code","f930e0fa":"code","cb102e2f":"code","39b1ac09":"code","e42ed1f5":"code","c3f57172":"code","1306fd3e":"code","69c5aa53":"code","e49f3ab9":"code","0f376f2c":"code","502fb7b0":"code","0f52727f":"code","80ba9796":"code","f43b376f":"code","c8f36c0a":"code","8ec952e7":"code","e666dfdd":"code","ad973fcc":"code","b755e0ab":"code","8d905a7d":"code","ca05f837":"code","7451d64e":"code","d66c0187":"code","8e4d0cfa":"code","91954425":"markdown","cbfd5816":"markdown","20314262":"markdown","1be57bb2":"markdown","d88b2223":"markdown","ec2671e3":"markdown","26214624":"markdown","40c47a91":"markdown","6096ea55":"markdown","fb6530d1":"markdown","b55ca09c":"markdown","8b5d1c05":"markdown","536d9b23":"markdown","6dc1d4ba":"markdown","d1267879":"markdown","917887a5":"markdown","73ccc43b":"markdown","c5eb66d2":"markdown","6f74551f":"markdown","8c6b215f":"markdown","086cf674":"markdown","7998f822":"markdown","c9a65582":"markdown","540bf7a3":"markdown","a5772bdb":"markdown","b1b36d6a":"markdown","55eb778d":"markdown","68dd5ef0":"markdown","1202bc78":"markdown","b293ce8f":"markdown"},"source":{"3117f7e5":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport scipy.stats as stats\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport shap\nimport eli5\nfrom collections import Counter\n\nimport warnings\nwarnings.filterwarnings('ignore')\nplt.style.use('fivethirtyeight')\n%matplotlib inline\n\nshap.initjs()\n\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","4e3bfbba":"df = pd.read_csv('\/kaggle\/input\/usedcarscatalog\/cars.csv')","69d22bdc":"df.shape","f55cb679":"df.info()","9a843e96":"feature='odometer_value'\nplt.figure(figsize=(16,10))\nplt.xlim(df[feature].min()-10000, df[feature].max()+10000)\nsns.distplot(df.loc[df[feature]<1200000, feature],\n             hist=True, kde=True, \n             kde_kws={'shade': True, 'linewidth': 3},\n             hist_kws={'rwidth':0.9},\n             label=feature,\n             color='green', \n             axlabel=feature)\nplt.title(f\"{feature.capitalize()}\")\nplt.show()\n\nprint(f'Mean value for {feature}: {df[feature].mean()}')\nprint(f'Median value for {feature}: {df[feature].median()}')\nprint(f'Min value for {feature}: {df[feature].min()}')\nprint(f'Max value for {feature}: {df[feature].max()}')","6c7b262d":"feature='odometer_value'\nplt.figure(figsize=(16,10))\nplt.xlim(df[feature].min()-10000, 710000)\nsns.distplot(df.loc[df[feature]<1200000, feature],\n             hist=True, kde=True, \n             kde_kws={'shade': True, 'linewidth': 3},\n             hist_kws={'rwidth':0.9},\n             label=feature,\n             color='green', \n             axlabel=feature)\nplt.title(f\"{feature.capitalize()}\")\nplt.show()","6ef5d0a4":"feature='year_produced'\nplt.figure(figsize=(12,8))\ndf[feature].value_counts().reindex(sorted(df[feature].unique()))\\\n                .plot(kind='bar', \n                      xticks=df[feature].unique())\nplt.show()","a5d0c8b1":"feature='price_usd'\nplt.figure(figsize=(10,7))\nplt.xlim(-1000, df[feature].max())\nsns.distplot(df.loc[df[feature]<200000, feature],\n             hist=True, kde=True, \n             kde_kws={'shade': True, 'linewidth': 3},\n             hist_kws={'rwidth':0.9},\n             label=feature,\n             color='green', \n             bins=90,\n             axlabel=feature)\nplt.title(f\"{feature.capitalize()}\")\nplt.show()\n\nprint(f'Mean value for {feature}: {df[feature].mean()}')\nprint(f'Median value for {feature}: {df[feature].median()}')\nprint(f'Min value for {feature}: {df[feature].min()}')\nprint(f'Max value for {feature}: {df[feature].max()}')","c8f1999b":"feature='price_usd'\nplt.figure(figsize=(10,7))\nplt.xlim(-1000, 21000)\nsns.distplot(df.loc[df[feature] < 21000, feature],\n             hist=True, kde=True, \n             kde_kws={'shade': True, 'linewidth': 3},\n             hist_kws={'rwidth':0.9},\n             label=feature,\n             color='green', \n#              bins=50,\n             axlabel=feature)\nplt.title(f\"{feature.capitalize()}\")\nplt.show()","d440b99c":"feature='drivetrain'\nplt.figure(figsize=(5,5))\ndf[feature].value_counts()\\\n                .plot(kind='bar')\nplt.show()","35cf3cfe":"plt.figure(figsize=(4.5, 7))\nplt.ylim(-1000, 40000)\nax = sns.boxplot(x=feature, \n                 y='price_usd', \n                 data=df, \n                 linewidth=1.5,\n                 order=[\"front\", \"rear\", \"all\"])","a2eb2554":"cat_feature = 'engine_type'\nnumerical_feature = 'price_usd'\n\ndf[cat_feature].describe()","00773162":"plt.figure(figsize=(4.5, 8))\nax = sns.boxplot(x=cat_feature, \n                 y=numerical_feature, \n                 data=df, linewidth=1.5,\n                 order=[\"gasoline\", \"diesel\", \"electric\"])","59e346ff":"plt.figure(figsize=(5,5))\nplt.figure(figsize=(4.5, 6))\ndf[cat_feature].value_counts()\\\n                .plot(kind='bar')\nplt.show()","64582e72":"df.loc[df[cat_feature]=='electric']\\\n    [['manufacturer_name', 'price_usd']].sample(5)","47d044c2":"feature = 'engine_capacity'\ndf[feature].describe()","77d235fa":"feature='engine_capacity'\nplt.figure(figsize=(10,7))\nplt.xlim(0.5, 8)\nsns.distplot(df.loc[df[feature]<10, feature],\n             hist=True, kde=True, \n             kde_kws={'shade': True, 'linewidth': 3},\n             hist_kws={'rwidth':0.9},\n             label=feature,\n             color='green', \n             axlabel=feature)\nplt.title(f\"{feature.capitalize()}\")\nplt.show()\n\nprint(f'Mean falue for {feature}: {df[feature].mean()}')\nprint(f'Median falue for {feature}: {df[feature].median()}')","7481c079":"df[cat_feature].describe()","0877851e":"df.loc[df[cat_feature]==True].shape[0]","7e73634f":"cat_feature = 'is_exchangeable'\nnumerical_feature = 'price_usd'\n\n\nplt.figure(figsize=(4.5, 8))\nax = sns.boxplot(x=cat_feature, \n                 y=numerical_feature, \n                 data=df, linewidth=1.5)","1fbe87b8":"plt.figure(figsize=(5,5))\nplt.figure(figsize=(4.5, 6))\ndf[cat_feature].value_counts()\\\n                .plot(kind='bar')\nplt.show()","cc79a3c2":"feature = 'up_counter'\ndf[feature].describe()","e2e9dbd4":"feature='up_counter'\nplt.figure(figsize=(10,5))\nhist, bins, _ = plt.hist(df[feature], bins=20, rwidth=0.9)\nplt.ylabel('Number of cars')\nplt.xlabel(feature)\nplt.show()\n\nprint(f'Mean falue for {feature}: {df[feature].mean()}')\nprint(f'Median falue for {feature}: {df[feature].median()}')","8ef64605":"logbins = np.logspace(np.log10(bins[0]),np.log10(bins[-1]),20)\nplt.figure(figsize=(10,5))\nplt.hist(df[feature], bins=logbins, rwidth=0.9)\nplt.xscale('log')\nplt.ylabel('Number of cars')\nplt.xlabel('log(up_counter)')\nplt.show()","521a11b5":"feature = 'manufacturer_name'\ndf['brand_count'] = df.groupby(feature)[feature].transform('count')","b3f99744":"plt.figure(figsize=(8,5))\ndf.loc[df['brand_count'] > 200]['manufacturer_name'].value_counts().plot(kind='bar')\nplt.ylabel('Number of cars')\nplt.xlabel(feature)\nplt.show()","60ab5557":"cat_feature = 'transmission'\nnumerical_feature = 'price_usd'\n\n\nplt.figure(figsize=(4.5, 8))\nplt.ylim(-1000, 60000)\nax = sns.boxplot(x=cat_feature, \n                 y=numerical_feature, \n                 data=df, linewidth=1.5,\n                 order=['mechanical', 'automatic'])","f660db9e":"plt.figure(figsize=(5,5))\nplt.figure(figsize=(4.5, 6))\ndf[cat_feature].value_counts()\\\n                .plot(kind='bar')\nplt.show()","454ba74a":"models_dict = df['model_name'].value_counts().to_dict()\nprint(len(models_dict), 'models in total!\\n\\n')\n\nfrom itertools import islice\n\nfor model in list(islice(models_dict, 20)):\n    print(model, '---->', models_dict[model], 'cars')","836294c3":"df['color'].describe()","14dd423c":"cat_feature = 'color'\nnumerical_feature = 'price_usd'\n\n\nplt.figure(figsize=(10, 8))\nplt.ylim(-1000, 60000)\nax = sns.boxplot(x=cat_feature, \n                 y=numerical_feature, \n                 data=df, linewidth=1.5,\n                 order=['black','silver','blue', 'white',\n                        'grey', 'red', 'green', 'other', \n                        'brown', 'violet', 'yellow', 'orange'])","a3aefb25":"plt.figure(figsize=(8, 6))\ndf[cat_feature].value_counts()\\\n                .plot(kind='bar')\nplt.show()","82e7bdec":"cat_feature = 'engine_fuel'\nnumerical_feature = 'price_usd'\n\n\nplt.figure(figsize=(8, 6))\nplt.ylim(-1000, 60000)\nax = sns.boxplot(x=cat_feature, \n                 y=numerical_feature, \n                 data=df, linewidth=1.5)","56d74df3":"df.loc[df[cat_feature]=='electric']\\\n    [['manufacturer_name', 'model_name', 'price_usd', 'year_produced']]","3a6760bb":"cat_feature = 'engine_has_gas'\nnumerical_feature = 'price_usd'\n\n\nplt.figure(figsize=(8, 6))\nplt.ylim(-1000, 60000)\nax = sns.boxplot(x=cat_feature, \n                 y=numerical_feature, \n                 data=df, linewidth=1.5)","7e66f704":"plt.figure(figsize=(5, 4))\ndf[cat_feature].value_counts()\\\n                .plot(kind='bar')\nplt.show()","9e20f845":"df.loc[df['engine_has_gas'] == True]['engine_has_gas'].value_counts()","b30fd24f":"df.loc[df['engine_has_gas'] == False]['engine_has_gas'].value_counts()","b34cf3e6":"cat_feature = 'body_type'\nnumerical_feature = 'price_usd'\n\n\nplt.figure(figsize=(10, 6))\nplt.ylim(-1000, 40000)\nax = sns.boxplot(x=cat_feature, \n                 y=numerical_feature, \n                 data=df, linewidth=1.5,\n                 order=['sedan', 'hatchback', 'universal',\n                       'suv', 'minivan', 'minibus', 'van', \n                       'coupe', 'liftback', 'pickup',\n                       'cabriolet', 'limousine'])","83b8b7c3":"plt.figure(figsize=(10, 5))\ndf[cat_feature].value_counts()\\\n                .plot(kind='bar')\nplt.show()","f930e0fa":"cat_feature = 'has_warranty'\nnumerical_feature = 'price_usd'\n\n\nplt.figure(figsize=(4, 6))\nplt.ylim(-1000, 100000)\nax = sns.boxplot(x=cat_feature, \n                 y=numerical_feature, \n                 data=df, linewidth=1.5)","cb102e2f":"plt.figure(figsize=(4, 5))\ndf[cat_feature].value_counts()\\\n                .plot(kind='bar')\nplt.show()","39b1ac09":"df.loc[df[cat_feature]==True]\\\n    [['manufacturer_name', 'model_name', 'year_produced', 'price_usd']]\\\n    .sample(7)","e42ed1f5":"cat_feature = 'state'\nnumerical_feature = 'price_usd'\n\nplt.figure(figsize=(4, 6))\nplt.ylim(-1000, 100000)\nax = sns.boxplot(x=cat_feature, \n                 y=numerical_feature, \n                 data=df, linewidth=1.5)","c3f57172":"plt.figure(figsize=(4, 5))\ndf[cat_feature].value_counts()\\\n                .plot(kind='bar')\nplt.show()","1306fd3e":"brands_dict = df[cat_feature].value_counts().to_dict()\nfor index, key in enumerate(brands_dict): \n    print(key, '----->', brands_dict[key], 'cars')","69c5aa53":"cat_feature = 'location_region'\nnumerical_feature = 'price_usd'\n\n\nplt.figure(figsize=(10, 8))\nplt.ylim(-1000, 25000)\nax = sns.boxplot(x=cat_feature, \n                 y=numerical_feature, \n                 data=df, linewidth=1.5,\n                 order=['\u041c\u0438\u043d\u0441\u043a\u0430\u044f \u043e\u0431\u043b.', '\u0413\u043e\u043c\u0435\u043b\u044c\u0441\u043a\u0430\u044f \u043e\u0431\u043b.', \n                        '\u0412\u0438\u0442\u0435\u0431\u0441\u043a\u0430\u044f \u043e\u0431\u043b.', '\u0411\u0440\u0435\u0441\u0442\u0441\u043a\u0430\u044f \u043e\u0431\u043b.',\n                        '\u041c\u043e\u0433\u0438\u043b\u0435\u0432\u0441\u043a\u0430\u044f \u043e\u0431\u043b.', '\u0413\u0440\u043e\u0434\u043d\u0435\u043d\u0441\u043a\u0430\u044f \u043e\u0431\u043b.'])","e49f3ab9":"plt.figure(figsize=(10, 5))\ndf[cat_feature].value_counts()\\\n                .plot(kind='bar')\nplt.show()","0f376f2c":"feature='number_of_photos'\nplt.figure(figsize=(12,8))\ndf[feature].value_counts().reindex(sorted(df[feature].unique()))\\\n                .plot(kind='bar', \n                      xticks=df[feature].unique())\nplt.show()","502fb7b0":"plt.figure(figsize=(8,8))\nplt.scatter(df['price_usd'], \n            df['number_of_photos'], \n            s=3,\n            )\nplt.xlabel('price_usd')\nplt.ylabel('number_of_photos')\nplt.xlim([0, 75000])\nplt.ylim([0, 60])\nplt.show()","0f52727f":"plt.figure(figsize=(10,10))\nplt.hist2d(df['price_usd'], \n           df['number_of_photos'], \n           (300,300),cmap=plt.cm.jet)\nplt.colorbar()\nplt.xlim([0, 50000])\nplt.ylim([0, 60])\nplt.show()","80ba9796":"plt.figure(figsize=(10,10))\nplt.hist2d(df['price_usd'], \n           df['number_of_photos'], \n           (600,600),cmap=plt.cm.jet)\nplt.colorbar()\nplt.xlim([0, 20000])\nplt.ylim([1, 20])\nplt.show()","f43b376f":"feature='duration_listed'\nplt.figure(figsize=(12,10))\nplt.xlim(df[feature].min(), df[feature].max())\ndf[feature].plot(kind=\"hist\", rwidth=0.92, \n                 bins=100,\n                 color='red')\nplt.title(f\"{feature.capitalize()}\")\nplt.tight_layout()\nplt.show()","c8f36c0a":"feature='duration_listed'\nplt.figure(figsize=(12,10))\nplt.xlim(df[feature].min(), 250)\ndf.loc[df[feature]<250][feature].plot(kind=\"hist\", rwidth=0.9, \n                 bins=80,\n                 color='red')\nplt.title(f\"{feature.capitalize()}\")\nplt.tight_layout()\nplt.show()","8ec952e7":"df['feature_0'].describe()","e666dfdd":"df['feature_1'].describe()","ad973fcc":"df['feature_3'].describe()","b755e0ab":"df['feature_4'].describe()","8d905a7d":"df['feature_5'].describe()","ca05f837":"df['feature_6'].describe()","7451d64e":"df['feature_7'].describe()","d66c0187":"df['feature_8'].describe()","8e4d0cfa":"df['feature_9'].describe()","91954425":"## has_warranty","cbfd5816":"If we make a scatter plot to check the correlation between number of photos and price_usd we get this:","20314262":"## Conlusion\nThat was a pretty basic exploratory analysis of the dataset. ","1be57bb2":"We love nice numbers: 200k, 250k, 300k, 350k, 400k, 450k, 500k! There are also plenty of cars with 0 odometer state (brand new).","d88b2223":"## up_counter\nIndicates how many times the sample has been upped in the catalog to raise its position.","ec2671e3":"Scatter plot gives a wrong view of the data, if we make a densiyt plot, we can see the region responsible for the vast majority of the samples.","26214624":"## engine_has_gas\n*engine_has_gas == True* signifies that car has been modified in a way that it can use propane as a fuel, this means that there is an additional propane reservoir, usually in the trunk, and a bunch of additional tubes so the gas can flow into the engine.","40c47a91":"# Explorative Data Analysis","6096ea55":"## is_exchangeable\nis_exhangeable parameter indicates if the person is willing to participate in exchanging the vehicle.","fb6530d1":"## state","b55ca09c":"Less than 4% of the cars have gas equipment installed.","8b5d1c05":"## color","536d9b23":"The distribution is highly skewed to the right.","6dc1d4ba":"## engine_capacity","d1267879":"Plot using logarithmic scale.","917887a5":"## location_region","73ccc43b":"> ## engine_fuel","c5eb66d2":"## number_of_photos\nExpensive cars presumably have higher price because there is more to show.","6f74551f":"The most popular model is VW Passat, as expected!","8c6b215f":"## manufacturer_name","086cf674":"## duration_listed","7998f822":"## odometer_value\nOne of the very important parameters for the used car is the odometer state which shows how many kilometers the car has been driven over the years in total. There is a feature for each car called odometer_value which shows exactly that.","c9a65582":"## feature_0 - feature_9\nindicate that there is a feature present in the car like air conitioner, alloys, xenon lamps, etc.","540bf7a3":"## engine_type","a5772bdb":"## model_name","b1b36d6a":"## body_type","55eb778d":"## transmission","68dd5ef0":"## year_produced\n","1202bc78":"## price\nprice is going to be the target value during model building process.","b293ce8f":"## drivetrain"}}