{"cell_type":{"52f34ef4":"code","802dd2d6":"code","b6f26ab9":"code","4be55667":"code","97a16c43":"code","2367aff0":"code","6bc13ecb":"code","cf696b33":"code","d51c2b04":"code","66a8140d":"code","9ae18728":"code","7abcf020":"code","3f6e8cbc":"code","93ef61db":"code","76532741":"code","abe53c19":"code","88197e2f":"code","b62850b5":"code","12804cf2":"code","44bc39d4":"markdown","8a3134a1":"markdown","e8497f59":"markdown","2a7cc456":"markdown","9f8cc9d7":"markdown","be09bbea":"markdown","a3c84b39":"markdown","a9cd09ba":"markdown","36250f80":"markdown","467e0b28":"markdown","315efff7":"markdown"},"source":{"52f34ef4":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames[0:1]:\n        print(os.path.join(dirname, filename))","802dd2d6":"pip install 'lightning-flash[image]'","b6f26ab9":"import torch\nimport flash\nfrom flash.image import ImageClassificationData, ImageClassifier","4be55667":"#ImageClassifier.available_backbones()","97a16c43":"datamodule = ImageClassificationData.from_folders(\n    train_folder=\"\/kaggle\/input\/chest-xray-pneumonia\/chest_xray\/chest_xray\/train\/\", \n    val_split=0.2\n)","2367aff0":"model = ImageClassifier(backbone=\"resnet50\", num_classes=datamodule.num_classes)\nprint(datamodule.num_classes)","6bc13ecb":"torch.cuda.device_count()","cf696b33":"trainer = flash.Trainer(max_epochs=1, gpus=torch.cuda.device_count())","d51c2b04":"trainer.finetune(model, datamodule=datamodule, strategy=\"freeze\")","66a8140d":"trainer.save_checkpoint(\"xray_pneumonia_classification_model.pt\")","9ae18728":"model.predict([\"\/kaggle\/input\/chest-xray-pneumonia\/chest_xray\/val\/NORMAL\/NORMAL2-IM-1431-0001.jpeg\",\n              \"\/kaggle\/input\/chest-xray-pneumonia\/chest_xray\/val\/PNEUMONIA\/person1947_bacteria_4876.jpeg\"])","7abcf020":"from collections import Counter\nimport glob\npreds_normal = []\nfor file in glob.glob('\/kaggle\/input\/chest-xray-pneumonia\/chest_xray\/test\/NORMAL\/*'):\n    preds_normal.append(model.predict([file]))","3f6e8cbc":"flat_list = [item for sublist in preds_normal for item in sublist]","93ef61db":"Counter(flat_list)","76532741":"import glob\npreds_pneu = []\nfor file in glob.glob('\/kaggle\/input\/chest-xray-pneumonia\/chest_xray\/test\/PNEUMONIA\/*'):\n    preds_pneu.append(model.predict([file]))","abe53c19":"flat_list_p = [item for sublist in preds_pneu for item in sublist]","88197e2f":"Counter(flat_list_p)","b62850b5":"reloaded_model = ImageClassifier.load_from_checkpoint('\/kaggle\/working\/xray_pneumonia_classification_model.pt')","12804cf2":"for file in glob.glob('\/kaggle\/input\/chest-xray-pneumonia\/chest_xray\/val\/*\/*'):\n    print(\"File Name: \",file, \"--Prediction: \", reloaded_model.predict([file]))","44bc39d4":"Training the model","8a3134a1":"Generating inferences from a saved model","e8497f59":"Saving the model","2a7cc456":"Defining the train and validation folders","9f8cc9d7":"Checking the number of available GPUs","be09bbea":"# Lightning Flash (Pytorch) Classification Example\n\nThe goal of this notebook is to test this library with an image classification example using the xray-pneumonia dataset\n\nBy: Jhonnatan Torres\n___","a3c84b39":"Generating inferences over the entire validation folder","a9cd09ba":"Installing the requried library","36250f80":"Reloading from a saved model","467e0b28":"Defining the model","315efff7":"Generating a couple of inferences"}}