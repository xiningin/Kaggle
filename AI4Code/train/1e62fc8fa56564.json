{"cell_type":{"a8fa39cc":"code","9ce2bdd2":"code","4aee1a1c":"code","4830ec8f":"code","3242e22a":"code","17b01b35":"code","da7e0e8d":"code","fadfc148":"code","5907e8c5":"code","f638577f":"code","3258c096":"code","92ceede5":"code","d45e9c59":"code","61cb2361":"code","a2535636":"code","9aea9012":"code","56fceead":"code","eab70c33":"code","6fac263c":"code","2555e1d8":"code","75c6e722":"code","b952d0ac":"code","30e224af":"code","50384d65":"code","0a3b1fad":"code","3524ee88":"code","beb7fb5a":"code","29d4f090":"code","1360a2c0":"code","542fc3f5":"code","15423b0d":"code","42ffa959":"code","0d1b1ec5":"code","35df978a":"code","c2f56bf1":"code","bdd474b1":"code","8df62f81":"code","b81ac4cc":"code","79b791ec":"code","a4d39a95":"code","66ea339b":"code","f9f71da9":"code","68a799b1":"code","8ead2ea3":"code","b90c8570":"markdown","133e2fe0":"markdown","f71c8d75":"markdown","dbdbe67d":"markdown","e3836b9b":"markdown","cd93397a":"markdown","f97ca47e":"markdown","c08ac646":"markdown","bc44963e":"markdown","11bf17e2":"markdown","4ce8b8b1":"markdown","e8c3e03c":"markdown","6dbe65e4":"markdown","392f55f7":"markdown","bbf3ee18":"markdown","15790725":"markdown","888b4a87":"markdown","91e62d7c":"markdown","43e035b9":"markdown","0173be1a":"markdown","5143682e":"markdown","b07427b8":"markdown","9f05b709":"markdown","4381e0fe":"markdown","a5b1f440":"markdown","2cff546e":"markdown","525eb114":"markdown","1e743bbc":"markdown","3a0f7c52":"markdown","2cce03f7":"markdown","9c336c5d":"markdown","ecaa1c19":"markdown","0a947900":"markdown","5c37f252":"markdown","06180105":"markdown","14b9e91b":"markdown","639c6845":"markdown","e5d2d2d9":"markdown","f9d2a96c":"markdown","079a5492":"markdown","2cae3c03":"markdown","787ed314":"markdown","794a494d":"markdown","84ad0460":"markdown","81d888f8":"markdown","98ce737c":"markdown","f22b4ae8":"markdown"},"source":{"a8fa39cc":"import os\nprint(os.listdir('..\/input\/'))","9ce2bdd2":"# Ignore  the warnings\nimport warnings\nwarnings.filterwarnings('always')\nwarnings.filterwarnings('ignore')\n\n# data visualisation and manipulation\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nfrom matplotlib import style\nimport seaborn as sns\nimport missingno as msno\n\n#configure\n# sets matplotlib to inline and displays graphs below the corressponding cell.\n%matplotlib inline  \nstyle.use('fivethirtyeight')\nsns.set(style='whitegrid',color_codes=True)\n\n#import the necessary modelling algos.\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.svm import LinearSVC\nfrom sklearn.svm import SVC\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import GradientBoostingClassifier\nfrom sklearn import datasets\nfrom sklearn.naive_bayes import GaussianNB\n\n#model selection\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.model_selection import KFold\nfrom sklearn.metrics import accuracy_score,precision_score,recall_score,confusion_matrix,roc_curve,roc_auc_score\nfrom sklearn.model_selection import GridSearchCV\n\n#dim red\nfrom sklearn.decomposition import PCA\n\n#preprocess.\nfrom sklearn.preprocessing import MinMaxScaler,StandardScaler,Imputer,LabelEncoder,OneHotEncoder","4aee1a1c":"train=pd.read_csv(r'..\/input\/pima-indians-diabetes-database\/diabetes.csv')","4830ec8f":"train.head(10)","3242e22a":"df=train.copy()","17b01b35":"df.head(10)","da7e0e8d":"df.shape # this gives the dimensions of the dataset.","fadfc148":"df.index   ","5907e8c5":"df.columns # gives a short description of each feature.","f638577f":"# check for null values.\ndf.isnull().any()   ","3258c096":"msno.matrix(df)  # just to visualize. no missing value.","92ceede5":"df.describe()","d45e9c59":"def plot(feature):\n    fig,axes=plt.subplots(1,2)\n    sns.boxplot(data=df,x=feature,ax=axes[0])\n    sns.distplot(a=df[feature],ax=axes[1],color='#ff4125')\n    fig.set_size_inches(15,5)","61cb2361":"plot('Pregnancies')","a2535636":"plot('Glucose')","9aea9012":"plot('BloodPressure')","56fceead":"plot('SkinThickness')","eab70c33":"plot('Insulin')","6fac263c":"plot('BMI')","2555e1d8":"plot('DiabetesPedigreeFunction')","75c6e722":"plot('Age')","b952d0ac":"sns.countplot(data=df,x='Outcome')","30e224af":"df['Outcome'].value_counts()","50384d65":"# drawing features against the target variable.\n\ndef plot_against_target(feature):\n    sns.factorplot(data=df,y=feature,x='Outcome',kind='box')\n    fig=plt.gcf()\n    fig.set_size_inches(7,7)","0a3b1fad":"plot_against_target('Glucose') # 0 for no diabetes and 1 for presence of it","3524ee88":"plot_against_target('BloodPressure')","beb7fb5a":"plot_against_target('SkinThickness')","29d4f090":"plot_against_target('Age') ","1360a2c0":"df.shape","542fc3f5":"df.head(10)","15423b0d":"scaler=MinMaxScaler()\nscaled_df=scaler.fit_transform(df.drop('Outcome',axis=1))\nX=scaled_df\nY=df['Outcome'].as_matrix()","42ffa959":"x_train,x_test,y_train,y_test=train_test_split(X,Y,test_size=0.20,random_state=42)","0d1b1ec5":"clf_lr=LogisticRegression()\nclf_lr.fit(x_train,y_train)\npred=clf_lr.predict(x_test)\nprint(accuracy_score(pred,y_test))","35df978a":"clf_knn=KNeighborsClassifier()\nclf_knn.fit(x_train,y_train)\npred=clf_knn.predict(x_test)\nprint(accuracy_score(pred,y_test))","c2f56bf1":"clf_svm=SVC()\nclf_svm.fit(x_train,y_train)\npred=clf_svm.predict(x_test)\nprint(accuracy_score(pred,y_test))","bdd474b1":"clf_dt=DecisionTreeClassifier()\nclf_dt.fit(x_train,y_train)\npred=clf_dt.predict(x_test)\nprint(accuracy_score(pred,y_test))","8df62f81":"clf_rf=RandomForestClassifier()\nclf_rf.fit(x_train,y_train)\npred=clf_rf.predict(x_test)\nprint(accuracy_score(pred,y_test))","b81ac4cc":"clf_gb=GradientBoostingClassifier()\nclf_gb.fit(x_train,y_train)\npred=clf_gb.predict(x_test)\nprint(accuracy_score(pred,y_test))","79b791ec":"models=[LogisticRegression(),LinearSVC(),SVC(kernel='rbf'),KNeighborsClassifier(),RandomForestClassifier(),\n        DecisionTreeClassifier(),GradientBoostingClassifier(),GaussianNB()]\nmodel_names=['LogisticRegression','LinearSVM','rbfSVM','KNearestNeighbors','RandomForestClassifier','DecisionTree',\n             'GradientBoostingClassifier','GaussianNB']\n\nacc=[]\nd={}\n\nfor model in range(len(models)):\n    clf=models[model]\n    clf.fit(x_train,y_train)\n    pred=clf.predict(x_test)\n    acc.append(accuracy_score(pred,y_test))\n     \nd={'Modelling Algo':model_names,'Accuracy':acc}","a4d39a95":"acc_frame=pd.DataFrame(d)\nacc_frame","66ea339b":"sns.barplot(y='Modelling Algo',x='Accuracy',data=acc_frame)","f9f71da9":"clf_svm=SVC()\nclf_svm.fit(x_train,y_train)\npred=clf_svm.predict(x_test)\nprint(accuracy_score(pred,y_test))","68a799b1":"ids=[]\nfor i,obs in enumerate(x_test):\n    s='id'+'_'+str(i)\n    ids.append(s)","8ead2ea3":"# ids\nd={'Ids':ids,'Outcome':pred}\nfinal_pred=pd.DataFrame(d)\nfinal_pred.to_csv('predictions.csv',index=False)","b90c8570":"## 1.2 ) Loading the Dataset","133e2fe0":"#### RANDOM FOREST","f71c8d75":"#### INFERENCES--\n\n1) Firstly note that 0->'absence' and 1->'presence'.\n\n2) Note that the boxpot depicts that people having diabetes have higher Glucose levels.","dbdbe67d":"In this section I have performed the univariate analysis. Note that since all of the features are 'numeric' the most reasonable way to plot them would either be a 'histogram' or a 'boxplot'.","e3836b9b":"## 3 ) Preprocessing the Data","cd93397a":"## 2.2 ) Missing Values Treatment","f97ca47e":"#### 3 ) Preprocessing the Data","c08ac646":"#### 5 ) Exporting to a CSV file","bc44963e":"#### INFERENCES--\n\n1) Firstly again note that 0->'absence' and 1->'presence' of diabetes.\n\n2) Note that the boxpot depicts that people having diabetes tend to have higher age as expected.","11bf17e2":"## CONTENTS::","4ce8b8b1":"# Please Upvote if u like it;)","e8c3e03c":"#### DECISION TREE  ","6dbe65e4":"## 2 )  Exploratory Data Analysis (EDA)","392f55f7":"#### 4 ) Modelling ","bbf3ee18":"#### LOGISTIC REGRESSSION","15790725":"## 2.1 ) The features and the 'Target' variable","888b4a87":"## 1 )  Importing Various Modules and Loading the Dataset","91e62d7c":"#### We can now move onto comparing the results of various modelling algorithms.","43e035b9":"# Pima Indian Diabetes Dataset ","0173be1a":"#### Short description of each feature.","5143682e":"#### 1 ) Importing Various Modules and Loading the Dataset","b07427b8":"## 2.4.1 ) Plotting the Features against the 'Target' variable","9f05b709":"## 2.4 ) Bivariate Analysis","4381e0fe":"#### GRADIENT BOOSTING","a5b1f440":"## 4) Modelling","2cff546e":"## 3.1 ) Normalizing the Features.","525eb114":"## Please Upvote if u liked my work ;)","1e743bbc":"## 1.1 ) Importing Various Modules","3a0f7c52":"Here I have just written a small utility function that plots the 'Outcome' column vs the provided feature on a boxplot. In this way I have plotted some of the features against our target variable. This makes it easier to see the effect of the corresponding feature on the 'Outcome'.","2cce03f7":"## THE END!!!","9c336c5d":"#### Support Vector Machine (SVM)","ecaa1c19":"## 5) Exporting to a CSV file","0a947900":"#### 2 ) Exploratory Data Analysis (EDA)","5c37f252":"#### We can go on for analyzing the other features in the data frame and can draw similar inferences.","06180105":"#### Finally saving predictions to a CSV\/.XLSX file.","14b9e91b":"#### A utility function to plot the distribution of various features.","639c6845":"####  We can draw similar inferences from the plots plotted ahead for each of the 'feature' aginst the target which is 'Outcome' in our case.","e5d2d2d9":"This shows the first 10 rows or the 'data points' of the dataset.","f9d2a96c":"SVM gives best accuracy on the dataset. So using it to predict on the validation set.","079a5492":"####  Note that  we have more number of observations in which Diabetes is not diagnosed which is expected.","2cae3c03":"#### INFERENCES--\n\n1) First of all note that the values are in compliance with that observed from describe method.\n\n2) Note that we have a couple of outliers w.r.t. to 1.5 quartile rule (reprsented by a 'dot' in the box plot).\n\n3) Also note from the distplot that the distribution seems to be a bit +ve skewed (Right Tailed). ","787ed314":"#### Note that we have 768 observations each described by 8 features and the target variable is the presence or absence of the diabetes disease.","794a494d":"## 2.3 ) Univariate Analysis","84ad0460":"#### kNN","81d888f8":"## 3.2) Splitting into Training and Validation sets.","98ce737c":"Note that we dont have any missing value in any of the column. Hence no imputation is required.","f22b4ae8":"**Pregnancies:- ** Number of times pregnant\n\n**Glucose:- ** Plasma glucose concentration a 2 hours in an oral glucose tolerance test\n\n**BloodPressure:- ** Diastolic blood pressure (mm Hg)\n\n**SkinThickness:- ** Triceps skin fold thickness (mm)\n\n**Insulin2:- ** Hour serum insulin (mu U\/ml)\n\n**BMI:- ** Body mass index (weight in kg\/(height in m)^2)\n\n**DiabetesPedigreeFunction:- ** Diabetes pedigree function\n\n**Age:- ** Age (years)\n\n**Outcome (The Target):- ** Class variable (0 or 1) 268 of 768 are 1, the others are 0"}}