{"cell_type":{"1a5a6c1c":"code","8662b820":"code","640faf29":"code","5e60c656":"code","9d62510c":"code","2afcfd6a":"code","b6b47bc4":"code","6e5667ab":"code","c3b37972":"code","caede248":"code","0c381e1e":"code","ad8ef430":"code","ab295fda":"code","82854dad":"code","9825a4f6":"code","40fdcde9":"code","528c935c":"code","fe50ddf1":"code","977c0669":"code","c12f45cf":"code","9be1ceed":"code","3c1cff04":"code","586d3c53":"code","bdb93996":"code","30c008a8":"code","c3e86912":"code","1886a5ff":"code","d2a1189d":"code","4756019a":"code","9ee1cd4b":"markdown"},"source":{"1a5a6c1c":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom datetime import datetime\nfrom keras.models import Sequential\nfrom keras.layers import LSTM,Dense,Dropout\nfrom keras.models import load_model, Model","8662b820":"item_categories = pd.read_csv('..\/input\/competitive-data-science-predict-future-sales\/item_categories.csv')\nitems = pd.read_csv('..\/input\/competitive-data-science-predict-future-sales\/items.csv')\nshops = pd.read_csv('..\/input\/competitive-data-science-predict-future-sales\/shops.csv')\nsample_submission = pd.read_csv('..\/input\/competitive-data-science-predict-future-sales\/sample_submission.csv')\ntest = pd.read_csv('..\/input\/competitive-data-science-predict-future-sales\/test.csv')\nsales_train = pd.read_csv('..\/input\/competitive-data-science-predict-future-sales\/sales_train.csv')\n\nitem_categories.head()","640faf29":"\nitem_categories.isnull().sum()","5e60c656":"items.head()","9d62510c":"items.item_id.nunique()","2afcfd6a":"x=items.groupby(['item_category_id']).count()\nx=x.sort_values(by='item_id',ascending=False)\nx=x.iloc[0:10].reset_index()","b6b47bc4":"plt.figure(figsize=(8,4))\nax= sns.barplot(x.item_category_id, x.item_id, alpha=0.8)\nplt.title(\"Items per Category\")\nplt.ylabel('# of items', fontsize=12)\nplt.xlabel('Category', fontsize=12)\nplt.show()","6e5667ab":"shops.head()","c3b37972":"sample_submission.head()","caede248":"test.head()","0c381e1e":"sales_train.head()","ad8ef430":"sales_train.describe()","ab295fda":"sales_train = sales_train.query('item_price > 0')\n\n# test.csv'de bulunan shop ve item'lar al\u0131nm\u0131\u015ft\u0131r.\nsales_train = sales_train[sales_train['shop_id'].isin(test['shop_id'].unique())]\nsales_train = sales_train[sales_train['item_id'].isin(test['item_id'].unique())]\n","82854dad":"sales_train = sales_train.query('item_cnt_day >= 0 and item_price < 75000')","9825a4f6":"sales_train['year'] = pd.to_datetime(sales_train['date']).dt.strftime('%Y')\nsales_train['month'] = pd.to_datetime(sales_train['date']).dt.strftime('%m')\nsales_train.head(5)","40fdcde9":"cleaned = pd.DataFrame(sales_train.groupby(['year','month'])['item_cnt_day'].sum().reset_index())\nsns.pointplot(x='month', y='item_cnt_day', hue='year', data=cleaned)","528c935c":"\nmonthly_sales=sales_train.groupby([\"date_block_num\",\"shop_id\",\"item_id\"])[\"date_block_num\",\"date\",\"item_price\",\"item_cnt_day\"].agg({\"date_block_num\":'mean',\"date\":[\"min\",'max'],\"item_price\":\"mean\",\"item_cnt_day\":\"sum\"})\n\nmonthly_sales.head()","fe50ddf1":"\nsales_data_flat = monthly_sales.item_cnt_day.apply(list).reset_index()\n#Sadece ge\u00e7erli test verileri saklan\u0131r.\n\nsales_data_flat.head(10)","977c0669":"sales_data_flat = pd.merge(test,sales_data_flat,on = ['item_id','shop_id'],how = 'left')\nsales_data_flat.head(10)\n\n\n\nsales_data_flat.fillna(0,inplace = True)\nsales_data_flat.drop(['shop_id','item_id'],inplace = True, axis = 1)\nsales_data_flat.head(10)","c12f45cf":"sales = sales_data_flat.pivot_table(index='ID', columns='date_block_num',fill_value = 0,aggfunc='sum' )\nsales.head(10)","9be1ceed":"# Son s\u00fctun hari\u00e7 hepsini X e at\u0131yoruz.\nX_train = np.expand_dims(sales.values[:,:-1],axis = 2)\n# Son s\u00fctunu y ye at\u0131yoruz (tahmin edilecek olan de\u011fer)\ny_train = sales.values[:,-1:]\n\n# test i\u00e7in olu\u015fturulan X\nX_test = np.expand_dims(sales.values[:,1:],axis = 2)\n\n \nprint(X_train.shape,y_train.shape,X_test.shape)","3c1cff04":"\nsales_model = Sequential()\nsales_model.add(LSTM(units = 64,input_shape = (33,1)))\nsales_model.add(Dropout(0.5))\nsales_model.add(Dense(1))\n\nsales_model.compile(loss = 'mse',optimizer = 'adam', metrics = ['mean_squared_error'])\nsales_model.summary()","586d3c53":"sales_model.fit(X_train,y_train,batch_size = 4096,epochs = 6)","bdb93996":"submission_output = sales_model.predict(X_test)\n# Beklenen s\u00fctunlarla df olu\u015fturuldu. \nsubmission = pd.DataFrame({'ID':test['ID'],'item_cnt_month':submission_output.ravel()})\nsubmission.head()","30c008a8":"# Olu\u015fan df'den csv dosyas\u0131 olu\u015fturuldu.\nsubmission.to_csv('submission.csv',index = False)","c3e86912":"\nts=sales_train.groupby([\"date_block_num\"])[\"item_cnt_day\"].sum()\nts.index=pd.date_range(start = '2013-01-01',end='2015-10-01', freq = 'MS')\nts=ts.reset_index()\nts.head()","1886a5ff":"from fbprophet import Prophet\n# date s\u00fctunu = DS , value s\u00fctunu = Y\nts.columns=['ds','y']\nmodel = Prophet(yearly_seasonality=True) \nmodel.fit(ts)","d2a1189d":"# Gelecek 5 ay i\u00e7in tahmin\nfuture = model.make_future_dataframe(periods = 5, freq = 'MS')  \n\nforecast = model.predict(future)\nforecast[['ds', 'yhat', 'yhat_lower', 'yhat_upper']].tail()","4756019a":"model.plot_components(forecast)\n","9ee1cd4b":"B\u00fc\u015fra Gen\u00e7 - 160201058\nbusraggenc@gmail.com"}}