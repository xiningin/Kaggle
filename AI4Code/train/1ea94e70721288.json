{"cell_type":{"52823ae8":"code","228dc3b8":"markdown"},"source":{"52823ae8":"import pandas as pd\n#pd.set_option('display.max_rows', None)\nfrom IPython.display import Markdown\n\nUsers       = pd.read_csv(\"..\/input\/meta-kaggle\/Users.csv\")\nSubmissions = pd.read_csv(\"..\/input\/meta-kaggle\/Submissions.csv\")\n\nUsers['RegisterDate'] = pd.to_datetime(Users['RegisterDate'])\nUsers['Year'] = Users['RegisterDate'].dt.year\nUsers_before_2012 = Users.query(\"Year <= 2011\")\nn_users_before_2012 = Users_before_2012.shape[0]\n\nSubmissions['SubmissionDate'] = pd.to_datetime(Submissions['SubmissionDate'])\nSubmissions['Year'] = Submissions['SubmissionDate'].dt.year\nSubmissions_in_2021 = Submissions.query(\"Year == 2021\")\n\noverlap = pd.merge(Users_before_2012, Submissions_in_2021, how='inner', left_on=['Id'], right_on=['SubmittedUserId'])\nn_active_veterans = overlap.UserName.nunique()\n\ndisplay(Markdown('### ' + f'{n_users_before_2012:,}' + ' users joined kaggle in 2011 or before, of which ' + f'{n_active_veterans:,}' + '  of them have participated in a competition in 2021:'))\n# take a look\n#overlap.DisplayName.value_counts().to_frame(name=\"Number of submissions in 2021\")\nveteran_users = overlap.UserName.value_counts().to_frame(name=\"Number of submissions in 2021\")\n\nname_mapping = dict(Users_before_2012[['UserName','DisplayName']].values)\ndef make_clickable_link(UserName):\n    DisplayName = name_mapping.get(UserName)\n    return f'<a target=\"_blank\" href=\"https:\/\/www.kaggle.com\/{UserName}\">{DisplayName}<\/a>'\n\nveteran_users[\"User\"]  = veteran_users.index.map(lambda x: make_clickable_link (x))\nveteran_users = veteran_users[[\"User\",\"Number of submissions in 2021\"]].style.format({'url': make_clickable_link})\nveteran_users.hide_index()","228dc3b8":"### Related notebooks\n* [\"Kaggle in Numbers\"](https:\/\/www.kaggle.com\/carlmcbrideellis\/kaggle-in-numbers)\n* [\"Simple EDA of kaggle Grandmasters\"](https:\/\/www.kaggle.com\/carlmcbrideellis\/simple-eda-of-kaggle-grandmasters)"}}