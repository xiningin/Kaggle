{"cell_type":{"3334a805":"code","b916a5fb":"code","96a940e1":"code","cc8d1a84":"code","c6dcad26":"code","d9065f65":"code","b23a259e":"code","27a55264":"code","1ef5a9ce":"code","12c3025d":"code","f708f2f5":"code","19a6fd24":"code","10b81356":"code","7748a187":"code","fc968468":"code","8a37cca7":"code","3d6dd270":"code","6a04ca6b":"code","849df5f0":"code","e4722543":"code","4f9b347e":"code","00420bc2":"markdown","74c1ee85":"markdown","1891773d":"markdown","37169e8d":"markdown","c727fae0":"markdown","83657865":"markdown","e05e9c8b":"markdown","696f7f86":"markdown","da094326":"markdown","de54138e":"markdown","0e785e1d":"markdown","66cc1ece":"markdown","7a0f2520":"markdown","9d148163":"markdown","a39452db":"markdown","7b923280":"markdown","f11cfbd6":"markdown","9e22e427":"markdown","ed8abd31":"markdown","2b5f1b96":"markdown"},"source":{"3334a805":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns # data visualization library\nimport matplotlib.pyplot as plt # mathematical plotting library\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.svm import SVC\nfrom sklearn.metrics import confusion_matrix, classification_report\nfrom sklearn.preprocessing import StandardScaler, LabelEncoder\nfrom sklearn.model_selection import train_test_split, GridSearchCV, cross_val_score\n%matplotlib inline","b916a5fb":"#read the dataset\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename));\n        \nwine_df = pd.read_csv('..\/input\/red-wine-quality-cortez-et-al-2009\/winequality-red.csv')\nwine_df.head(5)","96a940e1":"wine_df.quality.value_counts()","cc8d1a84":"from pandas_profiling import ProfileReport\nprofile = ProfileReport(wine_df);","c6dcad26":"profile.to_widgets()","d9065f65":"wine_df.describe()","b23a259e":"#unique values in each column\nwine_df.nunique()","27a55264":"range_df = pd.concat([wine_df.max(),wine_df.min(),wine_df.max()-wine_df.min()],axis=1)\nrange_df.rename(columns={0:\"max\",1:\"min\",2:\"range\"},inplace=True)\nrange_df","1ef5a9ce":"matrix = np.triu(wine_df.corr())\nplt.figure(figsize=(14,14))\n#plot heat map\ng=sns.heatmap(wine_df.corr(),mask= matrix,annot=True,cmap=\"bwr\")","12c3025d":"wine_df.hist(bins = 30, figsize=(12,10), color= 'orange');","f708f2f5":"col=wine_df.columns\nfor i in range(len(col)-1):\n    dss=pd.DataFrame((wine_df.groupby('quality')[col[i]].max()-wine_df.groupby('quality')[col[i]].min()).sort_index())\n    sns.barplot(x=dss.index, y=col[i], data=dss)\n    plt.show()","19a6fd24":"#Converting quality into categorical data\n#Dividing wine as bad, average, good and best by giving the limit for the quality\nbins = [2, 3, 4, 7, 8]\ngroup_names = ['bad', 'average', 'good', 'best']\nwine_df['quality'] = pd.cut(wine_df['quality'], bins = bins, labels = group_names)","10b81356":"#converting categorical into binary data\nfrom sklearn.preprocessing import StandardScaler, LabelEncoder\nLE = LabelEncoder()\nwine_df['quality'] = LE.fit_transform(wine_df['quality'])","7748a187":"# spitting the dataset\nX = wine_df.iloc[:,:-1].values\ny = wine_df.loc[:,\"quality\"].values","fc968468":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.20, random_state = 0)","8a37cca7":"from sklearn.preprocessing import StandardScaler\nsc = StandardScaler()\nX_train = sc.fit_transform(X_train)\nX_test = sc.transform(X_test)","3d6dd270":"from sklearn.neighbors import KNeighborsClassifier\nknn_class = KNeighborsClassifier(n_neighbors = 4, metric = 'minkowski', p = 2)\nknn_class.fit(X_train, y_train)\n\ny_pred_knn = knn_class.predict(X_test)","6a04ca6b":"from sklearn.metrics import confusion_matrix, accuracy_score\ncm = confusion_matrix(y_test, y_pred_knn)\nprint(\"KNN accuracy: {:2.2f}%\" .format(accuracy_score(y_test, y_pred_knn) * 100) )","849df5f0":"from sklearn.ensemble import RandomForestClassifier\nrfc_class = RandomForestClassifier(n_estimators=200)\nrfc_class.fit(X_train, y_train)\n\ny_pred_rfc = rfc_class.predict(X_test)","e4722543":"#from sklearn.metrics import confusion_matrix, accuracy_score\ncm = confusion_matrix(y_test, y_pred_rfc)\nprint(\"random forest accuracy: {:2.2f}%\" .format(accuracy_score(y_test, y_pred_rfc) * 100) )","4f9b347e":"#Now lets try to do some evaluation for random forest model using cross validation.\nrfc_eval = cross_val_score(estimator = rfc_class, X = X_train, y = y_train, cv = 5)\nprint(rfc_eval.mean()*100)","00420bc2":"## Feature selection","74c1ee85":"# Preprocessing data","1891773d":"# Perform Exploratory data analysis","37169e8d":"## Cross Validation Score for random forest and SGD","c727fae0":"> cross validation improves the accuracy","83657865":"# Importing Libraries and the Dataset","e05e9c8b":"## Prepare train_test data","696f7f86":"$$\\textrm{If you like the work please upvote :-), Comments are Welcome}$$","da094326":"> In this notebook I have done some exploration of wine quality data\n\n> Visualize the average content of ingredients that effect the quality of wine\n\n> Use Classification models to predict the quality of wine as:\n   * Bad \n   * Average\n   * Good\n   * Best","de54138e":"## Random Forest Classifier","0e785e1d":"## KNearest Neighbour","66cc1ece":"# Correlation plot","7a0f2520":"# Plotting of the features\n## Distribution of contents in wine and their effect on quality","9d148163":"> **These plots shows the average quantity required for the particular ingredient in the wine to effect its quality**","a39452db":"Alcohol has the highest effect on the quality of wine","7b923280":"# $$\\textrm{Wine quality classification and analysis}$$","f11cfbd6":"# Preparing the model","9e22e427":"$$\\textrm{The range of the columns is varied therefore the features has to be normalized before modelling the classification model}$$","ed8abd31":"# Introduction\nIn this notebook the wine qulaity dataset is used to plot correlations with the ingedients of wine.\nClassification models have been created to predict the quality of the wine.\n\n## Content\n---\n**Input variables (based on physicochemical tests):** | **Output variable (based on sensory data):**\n---|---\nfixed acidity |  quality (score between 0 and 10)\nvolatile acidity |\ncitric acid|\nresidual sugar|\nchlorides|\nfree sulfur dioxide|\ntotal sulfur dioxide|\ndensity|\npH|\nsulphates|\nalcohol|\n\n","2b5f1b96":"> Range of the columns"}}