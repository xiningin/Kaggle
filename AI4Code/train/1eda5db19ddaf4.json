{"cell_type":{"11aedf86":"code","3e1d5415":"code","de434207":"code","2093ec93":"code","a9d13871":"code","9e1c1f51":"code","34627e5c":"code","6ee68813":"code","b4a60603":"code","85d0724c":"code","fd9b5963":"code","5ceed7f7":"code","6610d119":"code","5bc9bb46":"code","a678c362":"code","755e2223":"code","a675851b":"code","3377dea5":"code","e8168533":"code","65078dbb":"code","5b28aced":"code","98507fe6":"code","15c40c62":"code","3bab325f":"code","ffc17b44":"code","a8e06cbf":"code","a52c872b":"code","1d5efad6":"code","d4ba0f6f":"code","fb27a2f9":"markdown","1346d509":"markdown","193a3412":"markdown","022158ae":"markdown","1a9d9d5a":"markdown","c4406100":"markdown","b259a1e5":"markdown","c14be4d3":"markdown","0edb2f65":"markdown","2e9e86a8":"markdown","7630d7f4":"markdown","7a993fdc":"markdown","fa724729":"markdown","e484631e":"markdown","2bf6fe24":"markdown","614f025c":"markdown","d4d47af2":"markdown","620235e6":"markdown","0e5f65af":"markdown","7a8392e2":"markdown","15bb3aee":"markdown","a141ece3":"markdown","37c84f73":"markdown","93f986d6":"markdown"},"source":{"11aedf86":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt","3e1d5415":"# import data\nlefthandedbyage = pd.read_csv(\"..\/input\/lefthandedness-and-deathrates\/lh_data.csv\")","de434207":"lefthandedbyage.head()","2093ec93":"lefthandedbyage.info()","a9d13871":"lefthandedbyage.describe()","9e1c1f51":"# plot the dataset\nfig, ax = plt.subplots()\nax.plot('Age', 'Female', data = lefthandedbyage, marker = '.')\nax.plot('Age', 'Male', data = lefthandedbyage, marker = 'x')\nax.legend()\nax.set_xlabel(\"Age\")\nax.set_ylabel(\"Percentage of people who are left-handed\")","34627e5c":"# create a new column for the average of male and female\nlefthandedbyage['Average'] = lefthandedbyage[['Female', 'Male']].mean(axis = 1)","6ee68813":"lefthandedbyage.head()","b4a60603":"fig, ax = plt.subplots()\nax.plot('Age', 'Average', data = lefthandedbyage)\nax.set_xlabel(\"Age\")\nax.set_ylabel(\"Percentage of people who are left-handed\")","85d0724c":"deathbyage = pd.read_csv(\"..\/input\/lefthandedness-and-deathrates\/cdc_vs00199_table310.tsv\", sep = '\\t', skiprows = [1])","fd9b5963":"deathbyage.head()","5ceed7f7":"deathbyage.info()","6610d119":"deathbyage.describe()","5bc9bb46":"fig, ax = plt.subplots()\nax.plot('Age', 'Female', data = deathbyage, marker = '.')\nax.plot('Age', 'Male', data = deathbyage, marker = 'x')\nax.legend() # add a legend\nax.set_xlabel(\"Age\")\nax.set_ylabel(\"Percentage of people who are left-handed\")","a678c362":"deathbyage = deathbyage.drop(index= deathbyage.index[0], axis = 0)","755e2223":"deathbyage.rename(columns={\"Both Sexes\" : \"Deaths\"}, inplace = True)","a675851b":"deathbyage","3377dea5":"deathbyage.drop(['Male', 'Female'], axis = 1, inplace = True)","e8168533":"deathbyage = deathbyage.dropna(subset = [\"Deaths\"])","65078dbb":"deathbyage","5b28aced":"# total number of people who died as a function of age\nfig, ax = plt.subplots()\nax.plot('Age', 'Deaths', data = deathbyage, marker='.')\nax.set_xlabel(\"Age\")\nax.set_ylabel(\"Number of people who died\")","98507fe6":"def P_LH_A(ages_of_death):\n    \n    # use the mean of the 5 neighbouring points for rates before and after the start \n    rate_before = lefthandedbyage['Average'][-5:].mean()\n    rate_after = lefthandedbyage['Average'][:5].mean()\n    rate_middle = lefthandedbyage.loc[lefthandedbyage['Age'].isin(ages_of_death)]['Average']\n    \n    youngest_age = 10 # the youngest age in the dataset is 10\n    oldest_age = 86 # the oldest age in the dataset is 86\n    \n    P = np.zeros(ages_of_death.shape)\n    \n    # extract rate of left-handedness for people of age age_of_death\n    P[ages_of_death > oldest_age] = rate_before \/ 100\n    P[ages_of_death < youngest_age] = rate_after \/ 100\n    P[np.logical_and((ages_of_death <= oldest_age), (ages_of_death >= youngest_age))] = rate_middle \/ 100\n \n    return P","15c40c62":"def P_LH(deathbyage): \n    \n    # sum over P_LH for each age\n    p_list = P_LH_A(deathbyage['Age'])*deathbyage['Deaths']\n    P = np.sum(p_list)\n    P = P\/np.sum(deathbyage['Deaths'])\n    return P \n\nprint(P_LH(deathbyage))","3bab325f":"def P_A_LH(ages_of_death, deathbyage):\n    \n    P_A = deathbyage['Deaths'][ages_of_death] \/ np.sum(deathbyage['Deaths'])\n    P_Left = P_LH(deathbyage)\n    P_Left_Age = P_LH_A(ages_of_death)\n\n    return P_Left_Age*P_A\/P_Left","ffc17b44":"def P_A_RH(ages_of_death, deathbyage):\n    \n    P_A = deathbyage['Deaths'][ages_of_death] \/ np.sum(deathbyage['Deaths'])\n    P_RH = 1 - P_LH(deathbyage)\n    P_RH_A = 1 - P_LH_A(ages_of_death)\n    \n    return P_RH_A*P_A\/P_RH","a8e06cbf":"ages = deathbyage.Age # make a list of ages of death to plot\n\n# for each age, calculate the probability of being left or right-handed\nleft_handed_probability = P_A_LH(ages, deathbyage)\nright_handed_probability = P_A_RH(ages, deathbyage)","a52c872b":"fig, ax = plt.subplots() # create figure and axis objects\nax.plot(ages, left_handed_probability, label = \"Left-handed\")\nax.plot(ages, right_handed_probability, label = \"Right-handed\")\nax.legend()\nax.set_xlabel(\"Age at death\")\nax.set_ylabel(\"Probability of being age A at death\")","1d5efad6":"# calculating average ages for left-handed and right-handed groups\naverage_lh_age =  np.nansum(ages*np.array(left_handed_probability))\naverage_rh_age =  np.nansum(ages*np.array(right_handed_probability))\n\nprint(average_lh_age)\nprint(average_rh_age)","d4ba0f6f":"print(\"The difference in average ages is \" + str(round(average_rh_age - average_lh_age, 1)) + \" years.\")","fb27a2f9":"### 5. Overall probability of the person who died at X age to be left-handed - P(LH)","1346d509":"### 3. Bayes' Rule","193a3412":"We got a pretty big age gap between left-handed and right-handed people purely as a result of the changing rates of left-handedness in the population. However, the reported rates of left-handedness have increased from just 3% in the early 1900s to about 12-14% today, which means that older people are much more likely to be reported as right-handed than left-handed, and so looking at a sample of recently deceased people will have more old right-handers. Therefore, if we do the same analysis on a newer dataset of lefthandedness, the result would be an even lesser gap between the average death ages.","022158ae":"Drop NaN values from the Deaths columns\n\n\n\n\n\n","1a9d9d5a":"### The difference in average death age of left and right handers is 4.8 years. Meaning, left-handed people seem to die 4.8 years younger than right-handed people as per the given datasets of the 1990s","c4406100":"We are concered with the total number and not gender-wise, hence drop those columns","b259a1e5":"### 6. Calcuting the main probability in question - P(A | LH)","c14be4d3":"Drop the first row since the total is not needed","0edb2f65":"### 8. Conclusion to the question","2e9e86a8":"### 1. Import the left handedness data and analyze\/visualize it","7630d7f4":"## Do Left Handers Die Younger than Right Handers?","7a993fdc":"Function P_LH() calculates the overall probability of left-handedness in the population for a given study year.\n\nCreate a series by multiplying the number of dead people in the Deaths column with the probability of their being lefthanded using P_LH_A(). Get the summation of this for all ages. Finally, divide this by the total number of dead people.","fa724729":"For right handers:\n\nOverall probability of right-handedness P(RH) can be calcuated as 1-P(LH). Probability of being right-handed given that you died at age A, P(RH | A) is equal to 1-P(LH | A)","e484631e":"The data for <code>lefthandedbyage<\/code> ranges from Ages 10 to 86. The <code>deathbyage<\/code> data ranges from ages 1 to 120. We therefore need to find the <code>lefthandedbyage<\/code> values for the missing ages i.e 1 to 9 and 87 to 120. I assume this rate of lefthandedness for these age groups as the mean of the last 5 and the first 5 age wise entries in the <code>lefthandedbyage<\/code> dataset.\n\nFor ages 10 to 86, the rate would be as given in the <code>lefthandedbyage<\/code> dataset. \n\nThe required probability will then be a the corresponding rate for the age divied by 100 (since rate is given in %).","2bf6fe24":"I look to answer this question using probability approach. I specifically use the Bayer's Theorem to solve this question.","614f025c":"Now I can use all three quantities: P(A), P(LH), and P(LH | A) using Bayes' Rule to get P(A | LH), the probability of being age A at death given that you are left-handed. \n\nTo make this answer meaningful, though, I also want to compare it to P(A | RH), the probability of being age A at death given that you're right-handed.\n\nFor left-handers:","d4d47af2":"### 4. Probability of left handedness given age of death - P(LH | A)","620235e6":"Finally we find the average age of a left-hander and a right-hander. We can do this by calculating the mean of these probability distributions in the same way I calculated P(LH) earlier, weighting the probability distribution by age and summing over the result.\n<p>$$\\text{Average age of left-handed people at death} = \\sum_A A P(A | LH)$$<\/p>\n<p>$$\\text{Average age of right-handed people at death} = \\sum_A A P(A | RH)$$<\/p>","0e5f65af":"Plotting the distributions of conditional probabilities","7a8392e2":"P(LH) is the probability that a person who died in is left-handed, assuming we know nothing else about them. This is the average left-handedness in the population of deceased people.\n\nWe can calculate it by summing up all of the left-handedness probabilities for each age, weighted with the number of deceased people at each age, then divided by the total number of deceased people to get a probability. In equation form:\n<p><img src=\"https:\/\/i.imgur.com\/gBIWykY.png\" alt=\"equation\" width=\"220\"><\/p>\nwhere N(A) is the number of people who died at age A (given by the dataframe <code>deathbyage<\/code>)\n<!--- $$P(LH) = \\frac{\\sum_{\\text{A}} P(LH | A) N(A)}{\\sum_{\\text{A}} N(A)}$$ -->","15bb3aee":"We require 2 datasets that are of importance to solve this question:\n    \n1) Percentage of left and right handed people in the population\n\n2) Data related to deaths distributed by the ages\n\nThe dataset used is from back in 1990s, when a survey conducted for the rate of left-handedness was published in this <a href=\"https:\/\/pubmed.ncbi.nlm.nih.gov\/1528408\/\">paper<\/a>. \n\nThe death distribution data comes from the CDC site at - https:\/\/www.cdc.gov\/nchs\/data\/statab\/vs00199_table310.pdf.\n\n<b>Both these datasets are available at https:\/\/gist.github.com\/mbonsma\/<\/b>","a141ece3":"### 2. Import the death distribution data and analyze\/visualize it","37c84f73":"### 7. Find the concerned probabilities for all ages, for both left and right handedness","93f986d6":"We want to calculate the probability of dying at age A given that you are left-handed. Write this as P(A | LH). To compare this result, we also want the same quantity for right-handers: P(A | RH).\n\nIn order the calculate this probabilty, we look at the <strong>Bayes' Theorem<\/strong>\n\nBayes' theorem for the two events we care about: left-handedness (LH) and dying at age A.\n<p>$$P(A | LH) = \\frac{P(LH|A) P(A)}{P(LH)}$$<\/p>\n\nP(LH | A) is the probability that you are left-handed <em>given that<\/em> you died at age A. P(A) is the overall probability of dying at age A, and P(LH) is the overall probability of being left-handed. \n\nI will now calculate each of these three quantities."}}