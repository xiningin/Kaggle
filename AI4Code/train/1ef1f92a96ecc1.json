{"cell_type":{"d71eb5d6":"code","205bd7bd":"code","ad87cd3e":"code","9e52ec06":"code","cef0eb32":"code","d64f57a0":"code","5f1b460a":"code","166c54cc":"code","07396eaf":"code","b52bf3c1":"code","7a5f6c52":"code","fcdbb950":"code","e7521dfe":"code","88e6ac85":"code","31b0b4c5":"code","1a4ee511":"code","64e0b525":"code","6994facb":"code","620ccbe4":"code","cf08f280":"code","9ac11186":"code","688698c1":"code","b583b4ae":"code","9c8e4e97":"code","d246b531":"code","ab24f7ef":"code","c392d915":"code","ad97b4fd":"code","7c3a7be2":"code","9139fb85":"code","0c3b0bc4":"code","0e0fb398":"code","6de969e7":"code","e46858c8":"code","733466e4":"code","319ca00d":"code","0acd0cad":"code","8178aa7b":"code","bd99eb85":"code","2fbff494":"code","595756c8":"code","e048848e":"code","4395e2df":"code","b2732c3e":"code","7893ab47":"code","caba268c":"code","3e0ff76d":"code","8101a6f3":"code","98147fac":"code","5ff80fda":"code","738e0095":"code","aed41d42":"markdown","e37c5d23":"markdown","3b2de853":"markdown","500ae77b":"markdown","7f417f47":"markdown","f79b901d":"markdown","d504ceb8":"markdown","eab75678":"markdown","2f6e5331":"markdown","233c1dce":"markdown","4f721885":"markdown","ba45e3b1":"markdown","a6e96b64":"markdown","112b8a01":"markdown","1470176e":"markdown","513ea7fd":"markdown","2122dc19":"markdown"},"source":{"d71eb5d6":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\nsns.set(color_codes=True)\nimport plotly.express as px\nimport plotly.io as pio\npio.renderers.default='notebook'\nimport warnings\nwarnings.filterwarnings('ignore')","205bd7bd":"df = pd.read_csv('..\/input\/heart-disease-uci\/heart.csv')\ndf.head()","ad87cd3e":"df.columns.values","9e52ec06":"df.target.value_counts()","cef0eb32":"df.shape","d64f57a0":"df.info()","5f1b460a":"df.describe().T","166c54cc":"corr_matrix = df.corr()\ncorr_matrix['target'].sort_values(ascending=False)","07396eaf":"sns.countplot(data=df,x='target');","b52bf3c1":"plt.pie(x=df.target.value_counts(),labels=['Disease','No Disease'],autopct='%1.1f%%',shadow=True);\nplt.legend(loc='best');","7a5f6c52":"sns.countplot(data=df,x='target',hue='sex');\nplt.title('Heart Disease Frequency for Sex');\nplt.xlabel('Sex (0 = Female, 1 = Male)');\nplt.xticks(rotation=0);\nplt.legend([\"Haven't Disease\", \"Have Disease\"]);\nplt.ylabel('Frequency');","fcdbb950":"df.isnull().sum()","e7521dfe":"sns.distplot(df.age,kde=False);","88e6ac85":"df['age'].value_counts()","31b0b4c5":"pd.crosstab(df.age,df.target).plot(kind='bar',figsize=(20,6));\nplt.title('Heart Disease Frequency for Ages');\nplt.xlabel('Age');\nplt.ylabel('Frequency');\nplt.legend([\"Haven't Disease\", \"Have Disease\"]);","1a4ee511":"plt.figure(figsize=(20,6))\nsns.barplot(x='cp',y='age',data=df,hue='target');\nplt.legend(loc='upper right');","64e0b525":"px.scatter(data_frame=df,x='age',y='thalach',title='Distribution of Max Heart Rate over Age',color='target')","6994facb":"pd.crosstab(df.cp,df.target).plot(kind=\"bar\",figsize=(15,6),color=['#11A5AA','#AA1190' ])\nplt.title('Heart Disease Frequency According To Chest Pain Type')\nplt.xlabel('Chest Pain Type')\nplt.xticks(rotation = 0)\nplt.ylabel('Frequency of Disease or Not')\nplt.show()","620ccbe4":"data = df[['trestbps','chol','thalach']]\npx.box(data_frame=data)","cf08f280":"px.scatter(data_frame=df,x='age',y='chol')","9ac11186":"plt.figure(figsize=(10,7))\nsns.boxplot(x='target',y='age',data=df)\nsns.swarmplot(x='target',y='age',data=df,palette=\"Pastel1\")","688698c1":"sns.pairplot(data=df)","b583b4ae":"from sklearn.ensemble import ExtraTreesRegressor\nX = df.drop('target',axis=1)\nY = df['target']\nmodel = ExtraTreesRegressor()\nmodel.fit(X,Y)\nprint(model.feature_importances_)","9c8e4e97":"# plot graph of feature importance for better visualization\nfeat_import = pd.Series(model.feature_importances_,index = X.columns)\nfeat_import.nlargest(8).plot(kind='barh')\nplt.show()","d246b531":"X = df.drop('target',axis=1).values\nY = df['target'].values","ab24f7ef":"from sklearn.model_selection import train_test_split\nX_train,X_test,y_train,y_test = train_test_split(X,Y,test_size = 0.2,random_state=42)\nscore = []","c392d915":"from sklearn.model_selection import cross_val_score\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.svm import SVC\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.naive_bayes import GaussianNB","ad97b4fd":"lr = LogisticRegression()\nlr.fit(X_train,y_train)\ns1 = np.mean(cross_val_score(lr,X_train,y_train,scoring='accuracy',cv=10))\nscore.append(s1*100)","7c3a7be2":"dt = DecisionTreeClassifier()\ndt.fit(X_train,y_train)\ns2 = np.mean(cross_val_score(dt,X_train,y_train,scoring='accuracy',cv=10))\nscore.append(s2*100)","9139fb85":"rf = RandomForestClassifier(n_estimators=300)\nrf.fit(X_train,y_train)\ns3 = np.mean(cross_val_score(rf,X_train,y_train,scoring='accuracy',cv=10))\nscore.append(s3*100)","0c3b0bc4":"svc = SVC()\nsvc.fit(X_train,y_train)\ns4 = np.mean(cross_val_score(svc,X_train,y_train,scoring='accuracy',cv=10))\nscore.append(s4*100)","0e0fb398":"knn = KNeighborsClassifier()\nknn.fit(X_train,y_train)\ns5 = np.mean(cross_val_score(knn,X_train,y_train,scoring='accuracy',cv=10))\nscore.append(s5*100)","6de969e7":"nb = GaussianNB()\nnb.fit(X_train,y_train)\ns6 = np.mean(cross_val_score(nb,X_train,y_train,scoring='accuracy',cv=10))\nscore.append(s6*100)","e46858c8":"models = ['LogisticRegression','DecisionTreeClassifier','RandomForestClassifier','SVC','KNeighborsClassifier','GaussianNB']\nfor i in range(len(models)):\n    print('The Accuracy Score for',models[i],'is',score[i])","733466e4":"from sklearn.model_selection import RandomizedSearchCV","319ca00d":"parameters = {\n    'n_estimators':range(10,500,10),\n    'criterion': ('gini','entropy'),\n    'max_features':('auto','sqrt','log2'),\n    'min_samples_split':[2,5,10],\n    'min_samples_leaf':[1,2,4],\n    'bootstrap': [True,False]\n}\ngrid = RandomizedSearchCV(rf,param_distributions=parameters,scoring='accuracy',cv=5,verbose=0,n_iter=50,random_state=42,n_jobs=1)\ngrid.fit(X_train,y_train)","0acd0cad":"grid.best_params_","8178aa7b":"grid.best_score_","bd99eb85":"from tensorflow.keras.models import Sequential\nfrom tensorflow.keras.layers import Dense,Dropout","2fbff494":"model = Sequential()\nmodel.add(Dense(units=32,kernel_initializer='uniform',activation='relu',input_dim=13))\nmodel.add(Dense(64,activation='relu'))\nmodel.add(Dense(128,activation='relu'))\nmodel.add(Dense(256,activation='relu'))\nmodel.add(Dense(1,activation='sigmoid'))","595756c8":"model.compile(optimizer='adam',metrics=['accuracy'],loss='binary_crossentropy')","e048848e":"model.fit(X_train,y_train,validation_data=(X_test,y_test),epochs=300,batch_size=10)","4395e2df":"metrics = pd.DataFrame(model.history.history)","b2732c3e":"model.evaluate(X_test,y_test)","7893ab47":"metrics[['loss','val_loss']].plot()","caba268c":"metrics[['accuracy','val_accuracy']].plot()","3e0ff76d":"pred = model.predict_classes(X_test)\npred","8101a6f3":"from sklearn.metrics import confusion_matrix,classification_report,accuracy_score\ncm = confusion_matrix(y_test,pred)","98147fac":"cm","5ff80fda":"accuracy_score(y_test,pred)","738e0095":"print(classification_report(y_test,pred))","aed41d42":"**According to above results we can choose Logistic regression or Random Forest Classifier**","e37c5d23":"**Lets Perform Hyper Parameter Tuning to increase Accuracy**","3b2de853":"## Building an Artificial Neural Networks(ANN)","500ae77b":"### Looking for correlation","7f417f47":"Patients with chest pain \"typical angina\" don't suffer from heart disease.\nPatients with chest pain \"non-anginal pain\" are  more prone to heart disease","f79b901d":"### Predicting the Test set results","d504ceb8":"## Atrributes Information\n\nage<br>\nsex(1 = male; 0 = female)<br>\ncp:chest pain type (4 values)<br>\ntrestbps:resting blood pressure (in mm Hg on admission to the hospital)<br>\nchol:serum cholestoral in mg\/dl<br>\nfbs:fasting blood sugar > 120 mg\/dl(1 = true; 0 = false)<br>\nrestecg:resting electrocardiographic results (values 0,1,2)<br>\nthalach:maximum heart rate achieved<br>\nexang:exercise induced angina(1 = yes; 0 = no)<br>\noldpeak = ST depression induced by exercise relative to rest<br>\nslope:the slope of the peak exercise ST segment<br>\nca:number of major vessels (0-3) colored by flourosopy<br>\nthal: 3 = normal; 6 = fixed defect; 7 = reversable defect<br>\ntarget - have disease or not (1=yes, 0=no)\n\n\n\n### Types of chest pain(cp)\nValue 0: typical angina<br>\nValue 1: atypical angina<br>\nValue 2: non-anginal pain<br>\nValue 3: asymptomatic<br>\n\n### Types of restecg\nrestecg: resting electrocardiographic results<br>\nValue 0: normal<br>\nValue 1: having ST-T wave abnormality (T wave inversions and\/or ST elevation or depression of > 0.05 mV)<br>\nValue 2: showing probable or definite left ventricular hypertrophy by Estes' criteria<br>\n\n### Types of slope\n0: upsloping<br>\n1: flat<br>\n2: downsloping<br>\n","eab75678":"**Handling Missing**","2f6e5331":"**Name of columns**","233c1dce":"**Now lets see in Target column,How many Male Females are suffering from heart Diesease**","4f721885":"Therefore there are more patients in age group between 55-60.","ba45e3b1":"Clearly we can see in both the cases(Disease and No Disease) Males are dominating","a6e96b64":"### Feature Importance","112b8a01":"Therefore there is no Missing Values in the dataset","1470176e":"from the above plot we can say there are 54.5% patients in the dataset having heart disease","513ea7fd":"Therefore chest pain(cp) & number of major vessels(ca) are the most important features","2122dc19":"## Building a Model"}}