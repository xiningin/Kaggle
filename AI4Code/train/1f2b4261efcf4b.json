{"cell_type":{"2d99bb63":"code","1364b7f5":"code","2bef6b21":"code","f33af9aa":"code","d786df1a":"code","ee438e54":"markdown","341ae2f8":"markdown","563ecc01":"markdown"},"source":{"2d99bb63":"import matplotlib.pyplot as plt\nimport seaborn as sns\nimport numpy as np \nimport pandas as pd \nfrom sklearn import tree\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.model_selection import train_test_split, learning_curve","1364b7f5":"plt.style.use('seaborn')\nfilepath = '\/kaggle\/input\/heart-failure-clinical-data\/heart_failure_clinical_records_dataset.csv'\ndf = pd.read_csv(filepath, low_memory = False)\ndf.head()","2bef6b21":"categorical = ['anaemia','diabetes','high_blood_pressure','sex','smoking','DEATH_EVENT']\nnumeric = ['age','creatinine_phosphokinase','ejection_fraction','platelets','serum_creatinine','serum_sodium','time']\n\ndf = df[numeric+categorical]\n\n# Feature names\nfeatures = numeric+categorical[:-1]","f33af9aa":"X = np.array([df[features].iloc[i].values for i in range(len(df))])\ny = np.array(df['DEATH_EVENT'].values)\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.10, random_state=666)\nprint('X_train shape:',X_train.shape)\nprint('X_test shape:',X_test.shape)","d786df1a":"rnd_clf = RandomForestClassifier(n_estimators=75, max_leaf_nodes=5, n_jobs=-1)\nrnd_clf.fit(X_train, y_train)\ny_pred_rf = rnd_clf.predict(X_test)\nprint(rnd_clf.__class__.__name__,'accuracy {:.2f}%'.format(accuracy_score(y_test, y_pred_rf)*100))","ee438e54":"# Predicting Heart Failure","341ae2f8":"# Random Forest Classifier","563ecc01":"## Split data into training and test sets:"}}