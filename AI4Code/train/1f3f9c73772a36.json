{"cell_type":{"64a04121":"code","a2a04a2a":"code","45f8482b":"code","7e94fba1":"code","650327f2":"code","35c5bf5b":"code","94b0c5a8":"code","52bb6df0":"code","abb1b471":"code","5e954298":"code","b345ba5b":"markdown","ddd3ef4a":"markdown","ef52cc7d":"markdown"},"source":{"64a04121":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt # data visualization\nimport seaborn as sns # data visualization\nsns.set_context('talk')\nimport matplotlib.style as style \nstyle.use('seaborn-poster')\nstyle.use('ggplot')\nfrom sklearn.feature_extraction.text import CountVectorizer\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.naive_bayes import MultinomialNB\nfrom sklearn.metrics import accuracy_score\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","a2a04a2a":"data = pd.read_csv('\/kaggle\/input\/sms-spam-collection-dataset\/spam.csv', encoding='Latin1')\ndata.head()","45f8482b":"#drop unnecessary columns and rename \ndata.drop(['Unnamed: 2','Unnamed: 3', 'Unnamed: 4'], axis=1, inplace=True)\ndata.columns = ['label', 'msg']\ndata.head()","7e94fba1":"data.groupby('label').describe()","650327f2":"sns.countplot(data['label'], palette=('Accent'));","35c5bf5b":"data['msg_len'] = data['msg'].apply(lambda x: len(x))","94b0c5a8":"data.hist('msg_len', by='label');","52bb6df0":"# Split the dataset into training and testing set.\nX_train, X_test, y_train, y_test = train_test_split(data['msg'], data['label'], random_state=1)","abb1b471":"# Convert text to BoW (Bag of Words). \ncount_vector = CountVectorizer()\ntraining_data = count_vector.fit_transform(X_train)\ntesting_data = count_vector.transform(X_test)","5e954298":"# Apply the naive bayes algorithm.\nnaive_bayes = MultinomialNB()\nnaive_bayes.fit(training_data, y_train)\npred = naive_bayes.predict(testing_data)\nprint(\"{0:.2%}\".format(accuracy_score(y_test,pred)))","b345ba5b":"Looks like lengthy messages are more likely to be 'spam'.","ddd3ef4a":"The message count for 'ham' is much more than 'spam'","ef52cc7d":"'Sorry, I'll call later' message has the highest frequency in ham messages"}}