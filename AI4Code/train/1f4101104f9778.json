{"cell_type":{"a396d862":"code","ed744173":"code","24fb52bc":"code","0f4007c2":"code","81aa48cc":"code","856df4dc":"code","7846ac5e":"code","14d05ffc":"code","9dfba3e1":"code","282c11eb":"code","6cc659ba":"code","998e6e19":"code","31b51c19":"code","aa4880f7":"code","ed157597":"code","84fcb0e7":"code","ef09c16c":"code","b8240d6f":"code","651f966f":"code","477c3f0b":"code","b0d5b059":"code","aec86692":"code","e04d55b0":"code","3cb501c8":"markdown","071c06b0":"markdown","1e5e7bdc":"markdown","ca24d4ec":"markdown","6d8d88db":"markdown","77d7dfaa":"markdown","0b08046a":"markdown","e1ad5de3":"markdown","079c7c32":"markdown","f81c53c1":"markdown"},"source":{"a396d862":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport datetime","ed744173":"train = pd.read_csv('..\/input\/predict-volcanic-eruptions-ingv-oe\/train.csv')\n\ntrain_dir = \"..\/input\/predict-volcanic-eruptions-ingv-oe\/train\/\"\ntest_dir =  \"..\/input\/predict-volcanic-eruptions-ingv-oe\/test\/\"","24fb52bc":"\"\"\"Converting time_to_eruption to hours, minutes & seconds\"\"\"\n\ntrain['h:m:s'] = (train['time_to_eruption']\n                  .apply(lambda x:datetime.timedelta(seconds = x\/100)))\ntrain.head()","0f4007c2":"sample = pd.read_csv('..\/input\/predict-volcanic-eruptions-ingv-oe\/train\/1000015382.csv')\nsample.head()","81aa48cc":"sample.describe()","856df4dc":"sample.fillna(0).plot(subplots = True, figsize = (20,15))\nplt.tight_layout()\nplt.show()","7846ac5e":"'''Function to get training data'''\ndef get_csv(index):\n    \n    train_data = pd.read_csv(train_dir + str(train.segment_id.iloc[index]) + \".csv\")\n    train_data['time_to_eruption'] = train.time_to_eruption.iloc[index]\n    \n    for feat in train_data.drop('time_to_eruption',1).columns:\n        train_data[feat] = train_data[feat].mean()\n    \n    train_data = train_data.sample()\n    \n    return(train_data)","14d05ffc":"data = pd.DataFrame()\n\nfor index in range(train.shape[0]):\n    data = pd.concat([get_csv(index), data])\n    ","9dfba3e1":"data.shape","282c11eb":"data.head()","6cc659ba":"for i in data:\n    data[i] = data[i].replace(np.nan, data[i].mean())\n\ndata.isnull().sum()","998e6e19":"test = pd.read_csv(\"..\/input\/predict-volcanic-eruptions-ingv-oe\/sample_submission.csv\")\n\n'''Function to get test data'''\ndef get_csv_test(index):\n    \n    test_data = pd.read_csv(test_dir + str(test.segment_id.iloc[index]) + \".csv\")\n    \n    for feat in test_data.columns:\n        test_data[feat] = test_data[feat].mean()\n    \n    test_data = test_data.sample()\n    \n    return(test_data)","31b51c19":"data_test = pd.DataFrame()\n\nfor index in range(test.shape[0]):\n    data_test = pd.concat([get_csv_test(index), data_test])","aa4880f7":"data_test.shape","ed157597":"for i in data_test:\n    data_test[i] = data_test[i].replace(np.nan, data_test[i].mean())\ndata_test.isnull().sum()","84fcb0e7":"x_train = data.drop('time_to_eruption', axis = 1)\ny_train = data.time_to_eruption\nx_test = data_test.copy()","ef09c16c":"from sklearn.discriminant_analysis import LinearDiscriminantAnalysis as LDA\nlda = LDA(n_components = 5)\nx_train = lda.fit_transform(x_train, y_train) \nx_test = lda.transform(x_test)","b8240d6f":"import xgboost as xgb\nfrom xgboost import XGBRegressor\n\nmodel = XGBRegressor(max_depth = 10, n_estimators = 20, learning_rate = 0.3)\nmodel.fit(x_train, y_train)","651f966f":"xgb.plot_importance(model)\nplt.rcParams['figure.figsize'] = [5, 5]\nplt.show()","477c3f0b":"pred = model.predict(x_test)\npred","b0d5b059":"test['time_to_eruption'] = pred\nsub = test[['segment_id', 'time_to_eruption']]","aec86692":"sub.head()","e04d55b0":"sub.to_csv('submission.csv',index=False)","3cb501c8":"# **XGBoost**","071c06b0":"Importance Graph","1e5e7bdc":"# Reading train.csv and Train & Test folder","ca24d4ec":"Plotting sample data","6d8d88db":"**Data for Test Set**","77d7dfaa":"> [](http:\/\/)**Sample train dataset**","0b08046a":"# Dimensionality Reduction","e1ad5de3":" **Data for Training Set**","079c7c32":"Predictions","f81c53c1":"# Importing Libraries "}}