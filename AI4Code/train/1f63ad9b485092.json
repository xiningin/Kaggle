{"cell_type":{"0d638057":"code","92d65673":"code","5a3ac0ca":"code","62f09fc0":"code","d9e671a5":"code","195c0b7f":"code","f912b0df":"code","0bad1751":"code","3337f09f":"code","d36b5680":"code","d6a4bc5f":"code","7efe87bf":"code","33981d90":"code","399bae8a":"code","1281cec1":"code","0e7340c6":"code","d523ba9c":"code","86364cbe":"code","63ced310":"code","7c405172":"code","4dea00df":"code","25237bfe":"code","3d4fb3b2":"code","3870b024":"code","3a7596dc":"code","7cc01a65":"code","53939b4a":"code","fa9bcaa2":"code","94df2891":"code","2a2fbe4c":"code","1b2e0dfa":"code","be7e5db1":"code","bf67e688":"code","af8b0b70":"code","6ac12c93":"code","f92f2bc9":"code","c6c336dd":"code","93527887":"markdown","49e8be9b":"markdown","8a80d9b1":"markdown","f0e7d8d6":"markdown","eed0f3b2":"markdown","f79c9506":"markdown","26c3eb2d":"markdown","529109b1":"markdown","f9f994d1":"markdown","49504e58":"markdown"},"source":{"0d638057":"import os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","92d65673":"import numpy as np    # For array operations\nimport pandas as pd   # For DataFrames","5a3ac0ca":"train = pd.read_csv('\/kaggle\/input\/mnist-digit-recognition-using-knn\/train_sample.csv')\ntest = pd.read_csv('\/kaggle\/input\/mnist-digit-recognition-using-knn\/test_sample.csv')","62f09fc0":"train.head()","d9e671a5":"X_train = train.iloc[:,1:]\ny_train = train.iloc[:,0]\n\nprint(X_train.shape)\nprint(y_train.shape)","195c0b7f":"X_test = test.iloc[:,1:]\ny_test = test.iloc[:,0]\n\nprint(X_test.shape)\nprint(y_test.shape)","f912b0df":"s = np.random.choice(range(X_train.shape[0]), size=12)\nlist(enumerate(s))","0bad1751":"import matplotlib.pyplot as plt    # For plotting \n%matplotlib inline                 \n\nplt.figure(figsize=(10,5)) #Width and heigth of the image displayed below (Optional)\n\nfor i,j in enumerate(s):\n    plt.subplot(4,6,i+1)                                      # Subplot flag\n    plt.imshow(np.array(X_train.loc[j]).reshape(28,28))      # Plot the image\n    plt.title('Digit: '+str(y_train.loc[j]))                 # Target of the image\n    plt.gray()                                                # For gray scale images ","3337f09f":"from sklearn.neighbors import KNeighborsClassifier\n\nknn = KNeighborsClassifier(algorithm='brute', n_neighbors=5, p=2, weights='distance')\n# 'brute' for searching through all the samples\n# p=2 for Euclidean; p=1 for Mannhatten Distance\n# Check the help file for all the arguments\n\nknn.fit(X_train, y_train)","d36b5680":"from sklearn.metrics import confusion_matrix\n\npred_train = knn.predict(X_train) \ncm_test = confusion_matrix(y_true=y_train, y_pred=pred_train)\nprint(cm_test)","d6a4bc5f":"#pd.crosstab(y_train, pred_train, rownames=['True'], colnames=['Predicted'])","7efe87bf":"pred_test = knn.predict(X_test) \ncm_test = confusion_matrix(y_true=y_test, y_pred=pred_test)\nprint(cm_test)","33981d90":"#pd.crosstab(y_test, pred_test, rownames=['True'], colnames=['Predicted'])","399bae8a":"acc_test = float(np.trace(cm_test))\/np.sum(cm_test)\nprint(acc_test)","1281cec1":"#r = 0\nr = np.random.choice(X_test.shape[0],1)    # Uncomment this to set a random query\nprint(r)\n\nquery = X_test.iloc[r].values\n#print(query)","0e7340c6":"nn=5                        # Number of search results\nout = knn.kneighbors(n_neighbors=nn, return_distance=True, X=query)  # Print 'out' and Check the object type\nprint(out)\n#print(type(out))\n#out(knn.kneighbors) is a tuple. You will get an error if you run this cell for 2nd time","d523ba9c":"distances = out[0]          # Distance of each retrieved sample\nresults = out[1][0]            # Retrieved sample index\nprint(distances)         \nprint(results)","86364cbe":"# Plot Qeury Vs Search Results\nplt.figure(figsize=(15,5))\nplt.subplot(1,nn+1,1)\nplt.imshow(np.array(query).reshape(28,28))\nplt.title('Query: '+str(y_test.iloc[r]))\nplt.gray()\n\nfor i,j in enumerate(results):\n    plt.subplot(1,nn+1,i+2)\n    plt.imshow(np.array(X_train.iloc[j]).reshape(28,28))\n    plt.title('Neighbor '+str(i+1)+': '+str(y_train.iloc[j]))\n    plt.gray()","63ced310":"## Randomly Generate some Data\nimport numpy as np\nimport pandas as pd\nfrom sklearn import preprocessing","7c405172":"#Generate 1000 rows and 4 columns randomly -- size=(1000,4)\n#Each value ranges between 2 and 100\n#The column names are T, A, B, C (T is target)\n\ndata  = pd.DataFrame(np.random.randint(2,100,size=(10000, 4)), columns=list('TABC'))","4dea00df":"#Activity1: #Find the Dimesnions of Dataframe\n\n","25237bfe":"#Activity2: #Display first 5 rows\n\n","3d4fb3b2":"#Activity3: #Display last 10 rows\n\n#data","3870b024":"from sklearn.model_selection import train_test_split\ntrain, test = train_test_split(data, test_size=0.2) #80-20 ratio train test split\nprint(train.shape, test.shape)","3a7596dc":"#Store train target as Y_train\nY_train = train[\"T\"]","7cc01a65":"#Store test target as y_test\ny_test = test[\"T\"]","53939b4a":"#Normalize the data (x-min(x))\/(max(x)-min(x))\nscaler = preprocessing.MinMaxScaler(feature_range=(0, 1))\n\n#Standardize the data (x-mean(x))\/std(x)\n#scaler = preprocessing.StandardScaler()\n\nscaler.fit(train.iloc[:,1:])\n\nstdtrain = pd.DataFrame(scaler.transform(train.iloc[:,1:]), columns=list(\"abc\"))\nstdtest = pd.DataFrame(scaler.transform(test.iloc[:,1:]), columns=list(\"abc\"))","fa9bcaa2":"print(stdtrain.head(5))\nprint(stdtest.head(5))","94df2891":"#X_train = stdtrain.iloc[:,1:]\n#y_train = stdtrain.iloc[:,0]\nprint(stdtrain.shape)\nprint(Y_train.shape)","2a2fbe4c":"stdtrain.head(5)","1b2e0dfa":"#X_test = stdtest.iloc[:,1:]\n#y_test = stdtest.iloc[:,0]\n\nprint(stdtest.shape)\nprint(y_test.shape)","be7e5db1":"from sklearn.neighbors import KNeighborsRegressor\nknn = KNeighborsRegressor(n_neighbors=5, p=2)\nknn.fit(stdtrain, Y_train)","bf67e688":"predictions = knn.predict(stdtest)","af8b0b70":"#Activity 4: Function to calculate mse\n","6ac12c93":"#mse(predictions,y_test)","f92f2bc9":"#to call inbuilt error metrics from sklearn\nfrom sklearn import metrics","c6c336dd":"metrics.mean_squared_error(predictions, y_test)","93527887":"## Classification","49e8be9b":"# K Nearest Neighbors","8a80d9b1":"## 1. K Nearest Neighbor Classification","f0e7d8d6":"# KNN Regression and Classification","eed0f3b2":"## Confusion Matrix","f79c9506":"* MNIST database (Modified National Institute of Standards and Technology database)\n* Digits written by high school students and employees of the United States Census Bureau\n* The MNIST database contains 60,000 training images and 10,000 testing images\n* A sample of 5,000 training images and 1,000 testing images are taken\n\n    <img src=\"mnist.png\">","26c3eb2d":"## Plot the data","529109b1":"## Accuracy","f9f994d1":"## 2. KNN Regression","49504e58":"Let us display a sample of 12 numbers from train data and visualize them"}}