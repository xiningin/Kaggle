{"cell_type":{"2200615f":"code","be0dc4ca":"code","deb0f9cb":"code","cca68589":"code","9a7d155b":"code","e4913c2a":"code","f345ca9b":"code","115e87d2":"code","76720702":"code","246e4db6":"code","1a66fdd9":"code","63775acb":"code","7e07d0c6":"code","50fbfcc6":"code","0a64170b":"code","36593e54":"code","398932f4":"code","43e60e55":"code","ae526587":"code","9152c1f4":"code","8bda8352":"code","111d103c":"code","865cdc51":"code","7b77575c":"code","fffc8cd3":"code","99997109":"code","47fa2e13":"code","dd50b93e":"code","413165d4":"markdown","8bbf0009":"markdown","61d6d021":"markdown","7ed43f5f":"markdown","d5d33b20":"markdown","6f07f796":"markdown"},"source":{"2200615f":"import numpy as np\nimport pandas as pd\n\nimport seaborn as sns\nimport matplotlib.pyplot as plt","be0dc4ca":"#train = pd.read_csv(\"..\/input\/predict-volcanic-eruptions-ingv-oe\/train.csv\")\n#train.head()","deb0f9cb":"train_dir = \"..\/input\/predict-volcanic-eruptions-ingv-oe\/train\/\"\ntest_dir = \"..\/input\/predict-volcanic-eruptions-ingv-oe\/test\/\"    ","cca68589":"def read_csv(index):\n    train1 = pd.read_csv(train_dir + str(train.segment_id.iloc[index]) + \".csv\")\n\n    train1['timetoerupt'] = train.time_to_eruption.iloc[index]\n    \n    for feat in train1.drop('timetoerupt',1).columns:\n        train1[feat] = train1[feat].mean()\n    \n    train1 = train1.sample(1)\n           \n    return (train1)","9a7d155b":"#data = pd.DataFrame()\n\n#for idx in range(train.shape[0]):\n#    df = read_csv(idx)\n    \n#    data=pd.concat([df,data])","e4913c2a":"# load training data\ndata = pd.read_csv(\"..\/input\/volcano-eruption-data\/data.csv\")\ndata.head()","f345ca9b":"# this will confirm whether we have read all the files or not\ndata.shape","115e87d2":"data.isnull().sum()","76720702":"# replace null values with the mean value\nfor feat in data:\n    data[feat] = data[feat].replace(np.nan, data[feat].mean())","246e4db6":"data.isnull().sum()","1a66fdd9":"from sklearn import linear_model\nfrom sklearn.linear_model import LinearRegression\n\nimport statsmodels.api as sm\n\nfrom sklearn.model_selection import train_test_split","63775acb":"X_train, X_test, y_train, y_test = train_test_split(data, data.timetoerupt, test_size=0.2, random_state=42)","7e07d0c6":"X_train.drop('timetoerupt',1,inplace = True)\n\n# Add a constant to get an intercept\nX_train_sm = sm.add_constant(X_train)\n\n# train the model\nlr = sm.OLS(y_train, X_train_sm).fit()","50fbfcc6":"print(lr.summary())","0a64170b":"X_test.drop('timetoerupt',1,inplace = True)\n\n# Add a constant to get an intercept\nX_test_sm = sm.add_constant(X_test)\n\n# prediction on training dataset\ny_test_pred = lr.predict(X_test_sm)","36593e54":"from sklearn.metrics import mean_squared_error\nfrom sklearn.metrics import r2_score","398932f4":"r_squared = r2_score(y_test_pred, y_test)\nr_squared","43e60e55":"sub = pd.read_csv(\"..\/input\/predict-volcanic-eruptions-ingv-oe\/sample_submission.csv\")\nsub.head()","ae526587":"def read_csv(index):\n    \n    test1 = pd.read_csv(test_dir + str(sub.segment_id.iloc[index]) + \".csv\")\n\n    for feat in test1.columns:\n        test1[feat] = test1[feat].mean()\n    \n    test1 = test1.sample(1)\n           \n    return (test1)","9152c1f4":"#test = pd.DataFrame()\n\n#for idx in range(sub.shape[0]):\n#    df = read_csv(idx)\n    \n#    test = pd.concat([df,test])","8bda8352":"# I have ran the steps mentioned above and saved the file, loading it now\ntest = pd.read_csv(\"..\/input\/volcano-eruption-data\/test.csv\")\ntest.head()","111d103c":"# again verify whether all the files were read correctly or not\ntest.shape","865cdc51":"test.isnull().sum()","7b77575c":"# same as we did for the training data\nfor feat in test:\n    test[feat] = test[feat].replace(np.nan, test[feat].mean())","fffc8cd3":"#test.to_csv('test.csv',index=False)","99997109":"# Add a constant to get an intercept\ntest_sm = sm.add_constant(test)\n\n# prediction on test dataset\npredictions = lr.predict(test_sm)\n\nsub['time_to_eruption'] = predictions","47fa2e13":"sub.head()","dd50b93e":"# submission file\nsub.to_csv('submission.csv',index=False)","413165d4":"### Helper function to read csv files in the test folder","8bbf0009":"I have already ran the above steps, created the dataframe, saved it into a csv file, and loaded it back for further use.\nWe will load the same file below.","61d6d021":"# Model Building","7ed43f5f":"# Approach:\n\n1) Read a csv file given in \"train\" folder, take mean of all features and put it into a dataframe.\n2) Add \"time to erupt\" feature from the train.csv file to the dataframe created in step # 1\n3) repeat steps # 1 and 2 for all the csv files present in \"train\" folder\n\nAt the end of step3, we will have a dataframe which would contain data for all the segments, mean of recordings from all the censors. I saved this file and loaded back into \"..\/input\/volcano-eruption-data\" and thats why you may find some code has been commented out to save execution time.\n\nNext, I have built a naive model to predict the \"time to erupt\" for test data.","d5d33b20":"### Read the files and create a dataframe","6f07f796":"### Helper function to read csv files present in the \"train\" folder"}}