{"cell_type":{"0d75bc23":"code","e65dc627":"code","49ee4b6f":"code","73658345":"code","24bff474":"code","1b8914e5":"code","4daf6c0e":"code","4e502ab0":"code","bf03d361":"code","e60af236":"code","c6fdd95f":"code","e9413464":"code","4e6586df":"code","99464d9d":"code","90302726":"code","b546e29d":"code","b97bf52d":"code","e45120bf":"code","1ee254f9":"code","d76a001b":"code","f51163c6":"code","d124e42b":"code","963953fd":"code","1b665bcc":"code","4cbe720e":"code","2f204895":"code","e79004fe":"code","4fdf2a4b":"code","6e50fd64":"code","e1b991cc":"code","3a765d0a":"code","4c605de5":"code","607d0291":"code","a7a728a9":"code","08cfdbe2":"code","e16cda70":"code","abd47531":"code","14dc7630":"code","1412c2cb":"code","08edc899":"code","853b654f":"markdown","f390823e":"markdown","5dc48a8c":"markdown","5ca25bc1":"markdown","6d8c6f17":"markdown","ac18593d":"markdown","ec45e145":"markdown","9e803bdd":"markdown","16d2a7af":"markdown","b6d952a9":"markdown"},"source":{"0d75bc23":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","e65dc627":"data = pd.read_csv('\/kaggle\/input\/new-york-city-airbnb-open-data\/AB_NYC_2019.csv')","49ee4b6f":"data['reviews_per_month'] = data['reviews_per_month'].fillna(0)\ndata.drop('host_name',axis=1,inplace=True)  # host_id and host_name imply the same thing ,thus drop one of these\ndata.isna().sum()","73658345":"data['neighbourhood_group'].unique() # array(['Brooklyn', 'Manhattan', 'Queens', 'Staten Island', 'Bronx']\nlen(data['neighbourhood'].unique()) #221\ndata['room_type'].unique() # array(['Private room', 'Entire home\/apt', 'Shared room']","24bff474":"data.describe()","1b8914e5":"plt.figure(figsize=(20,7))\nplt.subplot(1,2,1)\nplt.xlabel('neighbourhood_group')\nplt.ylabel('count')\nplt.hist(data['neighbourhood_group'])\n\nplt.subplot(1,2,2)\ndata['neighbourhood_group'].value_counts()\ncategory = [\"Manhattan\", \"Brooklyn\", \"Queens\", \"Bronx\",\"Staten Island\"]\ncount = [21661, 20104, 5666, 1091,373]\nplt.title(\"neighbourhood_count\")\nplt.pie(count, labels = category, autopct = \"%1.1f%%\")\nplt.show()","4daf6c0e":"plt.figure(figsize=(20,7))\nplt.subplot(1,2,1)\nplt.hist(data['room_type'])\nplt.xlabel('room_type')\nplt.ylabel('count')\n\nplt.subplot(1,2,2)\nplt.title(\"room_type\") # \u5716\u7684\u6a19\u984c\nroom=['Entire home\/apt', 'Private room', 'Shared room']\ncount_r = [25409,22326,1160]\nplt.pie(count_r, labels = room, autopct = \"%1.1f%%\") # \u7e6a\u88fd\u5713\u9905\u5716\nplt.show() # \u986f\u73fe\u5716\u5f62 ","4e502ab0":"plt.figure(figsize=(20,7))\nsns.histplot(x = data[\"neighbourhood_group\"], hue = data[\"room_type\"],multiple=\"dodge\", shrink=.8)\nplt.show()","bf03d361":"plt.figure(figsize=(20,14))\nsns.displot(data[data['price']<800]['price'],kde=True)","e60af236":"plt.figure(figsize=(20,14))\nsns.displot(data[data['number_of_reviews']>0]['number_of_reviews'],kde=True)","c6fdd95f":"plt.figure(figsize=(10,10))\nplt.plot(data['price'],data['number_of_reviews'],'.')\nplt.xlabel(\"PRICE\", fontsize = 12)\nplt.ylabel(\"NUMBER_OF_REVIEWS\", fontsize = 12)\nplt.xticks(rotation = 45)\nplt.show()","e9413464":"data_price = data[data['price']>0]\ndata_price.describe()","4e6586df":"print(data_price['price'].describe())\nprint('\\nquantile(0.80) : {}'.format(data_price['price'].quantile(0.80)))","99464d9d":"plt.figure(figsize=(25,7))\nplt.subplot(1,2,1)\nsns.boxplot(x='neighbourhood_group', y='price', data=data_price, showfliers = False, order=[\"Manhattan\", \"Brooklyn\", \"Queens\", \"Bronx\",\"Staten Island\"])\nplt.subplot(1,2,2)\nsns.boxplot(x='neighbourhood_group', y='price',hue='room_type', data=data_price, order=[\"Manhattan\", \"Brooklyn\", \"Queens\", \"Bronx\",\"Staten Island\"], showfliers = False)","90302726":"for i in range(5):\n    print('\\n{} :\\n'.format(data_price['neighbourhood_group'].unique()[i]),data_price[data_price['neighbourhood_group']==data_price['neighbourhood_group'].unique()[i]]['price'].describe())","b546e29d":"#from statistical table we can find there are some outlier, thus I remove them for a better visualization.\n#I choose 800 as 99% quantile\n\nnormal_price = data_price[data_price['price']<200 ]\nhigh_price = data_price[data_price['price']>= 200 ]\nplt.figure(figsize=(20,7))\n\nplt.subplot(1,2,1)\nsns.boxplot(x='neighbourhood_group', y='price', data=normal_price, order=[\"Manhattan\", \"Brooklyn\", \"Queens\", \"Bronx\",\"Staten Island\"], showfliers = False)\n\nplt.subplot(1,2,2)\nsns.boxplot(x='neighbourhood_group', y='price', data=high_price, order=[\"Manhattan\", \"Brooklyn\", \"Queens\", \"Bronx\",\"Staten Island\"], showfliers = False)","b97bf52d":"plt.figure(figsize=(17,10))\nplt.subplot(1,2,1)\nsns.violinplot(x='neighbourhood_group',y='price',data=normal_price, order=[\"Manhattan\", \"Brooklyn\", \"Queens\", \"Bronx\",\"Staten Island\"])\n\nplt.subplot(1,2,2)\nsns.violinplot(x='neighbourhood_group',y='price',data=high_price, order=[\"Manhattan\", \"Brooklyn\", \"Queens\", \"Bronx\",\"Staten Island\"])","e45120bf":"for i in range(5):\n    print('\\n{} :\\n'.format(normal_price['neighbourhood_group'].unique()[i]),normal_price[normal_price['neighbourhood_group']==normal_price['neighbourhood_group'].unique()[i]]['price'].describe())","1ee254f9":"for i in range(5):\n    print('\\n{} :\\n'.format(high_price['neighbourhood_group'].unique()[i]),high_price[high_price['neighbourhood_group']==high_price['neighbourhood_group'].unique()[i]]['price'].describe())","d76a001b":"plt.figure(figsize=(20,7))\nsns.boxplot(x='neighbourhood_group', y='price',hue='room_type', data=normal_price, order=[\"Manhattan\", \"Brooklyn\", \"Queens\", \"Bronx\",\"Staten Island\"], showfliers = False)","f51163c6":"plt.figure(figsize=(20,7))\nsns.boxplot(x='neighbourhood_group', y='price',hue='room_type', data=high_price, order=[\"Manhattan\", \"Brooklyn\", \"Queens\", \"Bronx\",\"Staten Island\"], showfliers = False)","d124e42b":"data[data['reviews_per_month']==0].describe()\ndata[['price','number_of_reviews','reviews_per_month','availability_365','calculated_host_listings_count']].corr(method='spearman')","963953fd":"data[data['availability_365'] == 0].describe()","1b665bcc":"# review vs avilibility ","4cbe720e":"data_review = data.drop(data[(data['availability_365']==0)] .index)\ndata_review[['number_of_reviews','reviews_per_month']].describe()","2f204895":"data_review[['price','number_of_reviews','reviews_per_month','availability_365','calculated_host_listings_count']].corr(method='spearman')","e79004fe":"plt.figure(figsize=(20,14))\nplt.subplot(2,1,1)\nsns.histplot(x=data_review.neighbourhood_group,hue=data_review.room_type,multiple=\"dodge\", shrink=.8)\nplt.subplot(2,1,2)\nsns.boxplot(x='neighbourhood_group', y='reviews_per_month',hue='room_type', data=data_review, showfliers = False)","4fdf2a4b":"data_review_q1 = data_review[data_review['reviews_per_month'] < data_review['reviews_per_month'].quantile(0.25)]\ndata_review_q3 = data_review[data_review['reviews_per_month'] > data_review['reviews_per_month'].quantile(0.75)]","6e50fd64":"plt.figure(figsize=(20,14))\nplt.subplot(2,1,1)\nsns.countplot(x=data_review_q3.neighbourhood_group, hue=data_review_q3.room_type, order=[\"Brooklyn\",\"Manhattan\", \"Queens\",\"Staten Island\", \"Bronx\"],hue_order=['Private room', 'Entire home\/apt', 'Shared room'])\nplt.subplot(2,1,2)\nsns.boxplot(x='neighbourhood_group', y='reviews_per_month',hue='room_type', data=data_review_q3, showfliers = False, order=[\"Brooklyn\",\"Manhattan\", \"Queens\",\"Staten Island\", \"Bronx\"],hue_order=['Private room', 'Entire home\/apt', 'Shared room'])","e1b991cc":"data_review_q3['price'].describe()","3a765d0a":"def get_group(element):\n    if element <= 70:\n        return 0\n    elif 70<element<100:\n        return 1\n    elif 100 <= element<165:\n        return 2\n    else:\n        return 3","4c605de5":"data_review = data_review.drop(data_review[data_review['price']==0].index)\ndata_review['price_type']=list(map(get_group, data_review['price'].values))\ndata_review = data_review[data_review['reviews_per_month'] > data_review['reviews_per_month'].quantile(0.75)]","607d0291":"plt.figure(figsize=(20,21))\nplt.subplot(4,1,1)\nsns.histplot(x=data_review.neighbourhood_group,hue=data_review.price_type,multiple=\"dodge\", shrink=.8)\n\nplt.subplot(4,1,2)\nsns.boxplot(x='neighbourhood_group', y='reviews_per_month',hue='price_type', data=data_review, showfliers = False)\n\nplt.subplot(4,1,3)\nsns.histplot(x=data_review.room_type,hue=data_review.price_type,multiple=\"dodge\", shrink=.8)\n\nplt.subplot(4,1,4)\nsns.boxplot(x='room_type', y='reviews_per_month',hue='price_type', data=data_review, showfliers = False)","a7a728a9":"plt.figure(figsize=(20,12))\nsns.scatterplot(x='longitude',y='latitude',hue='neighbourhood_group', data=data_review_q1)","08cfdbe2":"plt.figure(figsize=(20,12))\nsns.scatterplot(x='longitude',y='latitude',hue='neighbourhood_group', data=data_review_q3)","e16cda70":"import cv2\nplt.figure(figsize=(16,12))\nimage = cv2.imread('..\/input\/file-image\/New_York_City_.png')\nplt.imshow(image,extent=[-74.258, -73.7, 40.49,40.92])\nsns.scatterplot(x='longitude',y='latitude',hue='neighbourhood_group', data=data_review_q3)\nplt.show()","abd47531":"plt.figure(figsize=(16,12))\nimage = cv2.imread('..\/input\/file-image\/New_York_City_.png')\nplt.imshow(image,extent=[-74.258, -73.7, 40.49,40.92])\nsns.scatterplot(x='longitude',y='latitude',hue='neighbourhood_group', data=data_review_q1)\nplt.show()","14dc7630":"plt.figure(figsize=(16,12))\nimage = cv2.imread('..\/input\/file-image\/New_York_City_.png')\nplt.imshow(image,extent=[-74.25, -73.69, 40.49,40.92])\nplt.scatter(x='longitude',y='latitude',s=5,c='price',data=data_review_q3,cmap='hsv')\ncbar = plt.colorbar()\ncbar.set_label('price')","1412c2cb":"data_review_q1[['neighbourhood_group','neighbourhood']].value_counts().head(20)","08edc899":"data_review_q3[['neighbourhood_group','neighbourhood']].value_counts().head(20)","853b654f":"# \u5730\u7406\u4f4d\u7f6e VS \u50f9\u9322","f390823e":"- id : listing id ; only not duplicated (\u623f\u5c4bID)\n- name : name of the listing; comment (\u623f\u9593\u4ecb\u7d39)\n- host_id : host id (\u6301\u6709\u8005)\n- host_name : name of the host\n- neighbourhood_group : location\n- neighbourhood : area\n- latitude & longitude : Geographic information\n- room_type : listing space type\n- price : price in dollars(\u50f9\u9322\u9ad8\u4f4d\u8c6a\u83ef\u578b\uff0c\u82e5\u70ba0\u8868\u793a\u6536\u96c6\u8cc7\u6599\u6642\u623f\u9593\u70ba\u66ab\u6642\u95dc\u9589)\n- minimum_nights : amount of nights minimum\n- number_of_reviews : number of reviews\n- last_review : latest review\n- reviews_per_month : number of reviews per month\n- calculated_host_listings_count : amount of listing per host  ( if calculated_host_listings_count is 6 then u can see that host_name has exactly 6 rows in that dataset.)\n- availability_365 : number of days when listing is available for booking(\u53ef\u9810\u8a02\u5929\u6578\uff0c\u82e5\u70ba0\u8868\u793a\u6536\u96c6\u8cc7\u6599\u6642\u623f\u9593\u70ba\u66ab\u6642\u95dc\u9589)","5dc48a8c":"> <p>\u5f9e\u7d71\u8a08\u5716\u8868\u4f86\u770b\uff0c\u5e73\u5747\u4f86\u8aaa\u6700\u8cb4\u7684\u623f\u50f9\u5728Manhattan\u4e2d\u4f4d\u6578\u843d\u5728150\u5143\u6bcf\u665a\uff1b\u5176\u6b21\u662fBrooklyn\u5340\uff0c\u5176\u4e2d\u4f4d\u6578\u843d\u572890\u5143\u6bcf\u665a\uff1bQueens \u548c Staten Island \u5728\u50f9\u683c\u4e0a\u6709\u76f8\u4f3c\u7684\u5206\u5e03,\u800cBronx\u662f\u88e1\u9762\u6700\u4fbf\u5b9c\u7684\u3002\u7121\u8ad6\u4ec0\u9ebc\u623f\u578b\u5728Manhattan\u90fd\u6703\u82b1\u6bd4\u5176\u4ed6\u5340\u66f4\u591a\u5f97\u9322\uff0c\u4f46\u662fManhattan\u548cBrooklyn\u5340\u6709\u66f4\u591a\u7684\u623f\u9593\u53ef\u4ee5\u4f9b\u9078\u64c7\uff0c\u5206\u5225\u5360\u4e86\u6b64\u5340\u6240\u6709\u623f\u9593\u768444.3% \u820744.1%\uff0c\u76f8\u5c0d\u7684Bronx\u8207Staten Island\u96d6\u8aaa\u662f\u88e1\u9762\u6700\u4fbf\u5b9c\u7684\u5340\u6bb5\u4f46\u53ef\u4f9b\u9078\u64c7\u7684\u623f\u6e90\u7a00\u5c11\u5206\u5225\u53ea\u4f54\u4e862.23%\u82070.8%\u3002<\/p>\n> <p>\u623f\u578b\u4f86\u770b\uff0cEntire home\/apt\u50f9\u9322\u666e\u904d\u9ad8\u65bcPrivate room \u548c Shared room\uff0cShared room\u7684\u623f\u6e90\u7a00\u5c11\u540c\u6642\u4e5f\u662f\u76f8\u5c0d\u4f4e\u50f9\u7684\uff0c\u9810\u7b97\u5728800\u4ee5\u4e0a\u7684\u5962\u83ef\u623f\u578b\u4e3b\u8981\u662f\u843d\u5728Manhattan\u7684Entire home\/apt\u3002\n<\/p>\n","5ca25bc1":"# relation of price and neighbourhood_group or room_type","6d8c6f17":"* from spearman or pearson correlation can find high relationship between number of reviews and review per month, and when reviews per month equal to 0 , number of reviews be 0 too.\n* we can find most of listing are zero under 25% quantile, thus i decide to drop zero to analysis  ","ac18593d":"# data exploration","ec45e145":"# review, neightborhood, room type and price","9e803bdd":"We can find when number_of_reviews=0, last_review and reviews_per_month will be 0 either.<\/br>\nI decide to fill na as 0 in column **review_per_month** and keep na in column **last_review**. <\/br>","16d2a7af":"#### data_price = data.drop(data[data['price']==0].index)","b6d952a9":"# price"}}