{"cell_type":{"ebcd8056":"code","9c1960a6":"code","66d9ea6f":"code","4db69fd3":"code","855c424c":"code","b355e0d6":"code","17e906e9":"code","caace1f5":"code","b94837e0":"code","29889000":"code","7e1f6862":"code","9916a1be":"code","7364537c":"code","834752b3":"code","1f043b5e":"code","644577ca":"code","7c8e70d1":"code","a2871bd9":"code","5f26bc8d":"code","98ac293b":"code","e0752fbf":"code","2f0f162f":"markdown","9286007d":"markdown","0df4a232":"markdown","0769ad22":"markdown","6914d2c9":"markdown","7df999c4":"markdown"},"source":{"ebcd8056":"!pip3 install --upgrade fastai\n!pip install fast_tabnet # Not Required","9c1960a6":"from fastai.test_utils import *\nshow_install(True)","66d9ea6f":"from fastai.tabular.all import *\nfrom fast_tabnet.core import *\nfrom pathlib import Path","4db69fd3":"def seed_everything(seed):\n    random.seed(seed)\n    os.environ['PYTHONHASHSEED'] = str(seed)\n    np.random.seed(seed)\n    torch.manual_seed(seed)\n    torch.cuda.manual_seed(seed)\n    torch.backends.cudnn.benchmark = False\n    torch.backends.cudnn.deterministic = True\nseed_everything(1234)","855c424c":"root = \"..\/input\/titanic\"\ntrain = Path(root)\/\"train.csv\"\ntest = Path(root )\/\"test.csv\"\nsub = Path(root )\/\"gender_submission.csv\"","b355e0d6":"df = pd.read_csv(train)\ndft = pd.read_csv(test)","17e906e9":"df = pd.read_csv(train)\ndf.Cabin = df.Cabin.apply(lambda x:x  if type(x) == float else x[0])\ndf.head()","caace1f5":"dep_var = 'Survived'\ncat_names = ['Pclass', 'Sex', 'Embarked', 'Ticket', 'Cabin']\ncont_names = ['Age', 'Fare', 'SibSp', 'Parch']\nprocs = [Categorify, FillMissing, Normalize]","b94837e0":"split_sample = np.random.choice(df.shape[0], 200)\ndls = TabularDataLoaders.from_df(df, root, procs, cat_names, cont_names, y_names=dep_var, valid_idx=split_sample, bs=64, y_block=CategoryBlock)\nlearn = tabular_learner(dls, model_dir=\"\/tmp\/model\/\", metrics=[accuracy]).to_fp16()","29889000":"dls.valid.show_batch()","7e1f6862":"learn.lr_find()","9916a1be":"learn.fine_tune(3, 1e-2)","7364537c":"learn.lr_find()","834752b3":"learn.fit_one_cycle(5, lr_max=1e-3)","1f043b5e":"learn.lr_find()","644577ca":"learn.fit_one_cycle(10, lr_max=2e-7)","7c8e70d1":"interp = ClassificationInterpretation.from_learner(learn)\ninterp.plot_confusion_matrix(figsize=(5,5), dpi=60)","a2871bd9":"dft = pd.read_csv(test)\ndft.loc[dft.Fare.isnull(), 'Fare'] = np.median(df.Fare)","5f26bc8d":"dft.Cabin = dft.Cabin.apply(lambda x:x  if type(x) == float else x[0])\ndl = learn.dls.test_dl(dft, bs=64)","98ac293b":"dlp, _  = learn.get_preds(dl=dl)","e0752fbf":"submission = pd.read_csv(sub)\nsubmission.Survived = np.argmax(dlp, axis=1)\nsubmission.to_csv('submission.csv', index=False)","2f0f162f":"![Titanic](https:\/\/images-na.ssl-images-amazon.com\/images\/I\/51--1X%2BTEsL._AC_SL1024_.jpg)","9286007d":"Lets double check that we have the right version of the library and detects the GPU.","0df4a232":"Lets make sure we have the latest version of FastAI.","0769ad22":"Importing required libraries.","6914d2c9":"The Test set has NULL value for the column Fare. I simply thake the median value of the Fare found in the training set and replace.","7df999c4":"The aim of this notebook is to get started as quickly as possible and make a submission to Kaggle. What we will learn\n\n- Loading Data\n- Preprocessing\n- Model Training\n- Model Confusion Matrix (Visualization)\n- Inference and Submission"}}