{"cell_type":{"86fdc1d1":"code","59f2ade3":"code","55bab0bb":"code","a06b0599":"code","7f9961de":"code","5562634b":"code","2f6ded54":"code","5ccc4508":"code","51405789":"code","adc972cb":"code","e3121948":"code","630011dc":"code","7984ea79":"code","f1bd26e8":"code","02c0413d":"code","da0086af":"code","4dc5040b":"code","5986ac0c":"code","4dfa1f30":"code","17b50039":"code","f4882cbc":"code","6734252d":"code","7c4ca153":"code","b67530cc":"code","42a62074":"code","7b9cd4c4":"code","b8bf8e8b":"code","121d4536":"code","d9a59e5d":"code","1fa385ba":"code","4aecb816":"code","03e3701d":"code","65af06e3":"code","5b8fb0e2":"code","889dbafe":"markdown","087436f5":"markdown","418944d7":"markdown","0e7eb031":"markdown","097e49bb":"markdown"},"source":{"86fdc1d1":"import os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n","59f2ade3":"import pandas as pd\nfrom sklearn.tree import DecisionTreeClassifier\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport numpy as np\n\ndf=pd.read_csv('\/kaggle\/input\/online-shoppers-intention\/online_shoppers_intention.csv')","55bab0bb":"df.info()\nsns.countplot(x='Revenue',data=df)\n#the data is skew!","a06b0599":"df","7f9961de":"df.Weekend = df.Weekend.replace({True: 1, False: 0})\ndf.Revenue = df.Revenue.replace({True: 1, False: 0})","5562634b":"dummies= pd.get_dummies(df['VisitorType'],drop_first=True) \ndf=pd.concat([df.drop('VisitorType', axis=1), dummies],axis=1) \ndf=df.drop('Other',axis=1)","2f6ded54":"df.Month.unique()","5ccc4508":"df['Month'] = df['Month'].map({'Feb':2,'Mar':3,'May':5,'Oct':10,'June':6,'Jul':7,'Aug':8,'Nov':11,'Sep':9,'Dec':12})","51405789":"df.info()","adc972cb":"df = df.dropna()","e3121948":"df.corr()\nplt.figure(figsize=(12,7))\nsns.heatmap(df.corr(),annot=True,cmap='viridis')\nsns.distplot(df['Revenue'],kde=False,bins=40)","630011dc":"df.corr()['Revenue'].sort_values().plot(kind='bar')","7984ea79":"x = df.drop('Revenue',axis=1).values\ny = df['Revenue'].values","f1bd26e8":"from sklearn.model_selection import train_test_split\nx_train, x_test, y_train, y_test = train_test_split(x,y,test_size=0.2,random_state=101)","02c0413d":"from sklearn.preprocessing import MinMaxScaler\nscaler = MinMaxScaler()\nscaler.fit(x_train)\nx_train = scaler.transform(x_train)\nx_test = scaler.transform(x_test)\n","da0086af":"scores=[]\nfor i in range(1,25):\n  tree=DecisionTreeClassifier(max_depth = i) \n  tree.fit(x_train, y_train) \n  scores.append(tree.score(x_test,y_test)) \nplt.plot(range(1,25),scores) \nplt.show()\n","4dc5040b":"tree=DecisionTreeClassifier(max_depth =5) \ntree.fit(x_train, y_train) \ntree.score(x_test,y_test)","5986ac0c":"predict=tree.predict([x_test[0]])\npredict","4dfa1f30":"y_test[0]","17b50039":"predictions = tree.predict(x_test) \nfrom sklearn.metrics import classification_report,confusion_matrix \nprint(classification_report(y_test,predictions)) \nprint(confusion_matrix(y_test,predictions))\n","f4882cbc":"from sklearn.ensemble import RandomForestClassifier","6734252d":"scores=[]\nfor i in (np.arange(100,2000,100)):\n  classifier = RandomForestClassifier(n_estimators =i, max_depth=5, random_state =101) \n  classifier.fit(x_train, y_train) \n  scores.append(classifier.score(x_test,y_test)) \nplt.plot(np.arange(100,2000,100),scores) \nplt.show()\n","7c4ca153":"classifier = RandomForestClassifier(n_estimators =1000,max_depth=5, random_state =101)\nclassifier.fit(x_train, y_train)\nprint(classifier.score(x_test,y_test))","b67530cc":"classifier = RandomForestClassifier(n_estimators =1000,max_depth=5, random_state =101)\nclassifier.fit(x_train, y_train)\nprint(classifier.score(x_test,y_test))","42a62074":"from sklearn.svm import SVC\n\nscores=[]\nfor i in (np.arange(0.01,1,0.02)):\n  classifier = SVC(kernel = 'linear', C = i)\n  classifier.fit(x_train,y_train) \n  scores.append(classifier.score(x_test,y_test)) \nplt.plot(np.arange(0.01,1,0.02),scores) \nplt.show()","7b9cd4c4":"scores=[]\nfor i in (np.arange(0.01,1,0.02)):\n  classifier = SVC(kernel = 'rbf', gamma=i, C = i)\n  classifier.fit(x_train,y_train) \n  scores.append(classifier.score(x_test,y_test)) \nplt.plot(np.arange(0.01,1,0.02),scores) \nplt.show()","b8bf8e8b":"classifier = SVC(kernel = 'linear', C = 1)\nclassifier.fit(x_train,y_train) \nclassifier.score(x_test,y_test)","121d4536":"predictions = classifier.predict(x_test) \nfrom sklearn.metrics import classification_report,confusion_matrix \nprint(classification_report(y_test,predictions)) \nprint(confusion_matrix(y_test,predictions))","d9a59e5d":"import tensorflow as tf\nfrom tensorflow.keras.models import Sequential\nfrom tensorflow.keras.layers import Dense, Activation\nfrom tensorflow.keras.callbacks import EarlyStopping","1fa385ba":"from tensorflow.keras.layers import Dropout\n\nmodel = Sequential()\nmodel.add(Dense(units=35,activation='relu'))\nmodel.add(Dropout(0.5))\nmodel.add(Dense(units=35,activation='relu'))\nmodel.add(Dropout(0.5))\nmodel.add(Dense(units=1,activation='sigmoid')) \nmodel.compile(loss='binary_crossentropy', optimizer='adam',metrics=['accuracy'])\n\n","4aecb816":"early_stop = EarlyStopping(monitor='val_loss', mode='min', verbose=1, patience=5)\n\nmodel.fit(x_train,y_train,epochs=50,validation_data=(x_test, y_test), verbose=1, callbacks=[early_stop])\n","03e3701d":"losses = pd.DataFrame(model.history.history)\n\nlosses[['accuracy','val_accuracy']].plot()\nlosses[['loss','val_loss']].plot()\n","65af06e3":"print(model.metrics_names)\nprint(model.evaluate(x_test,y_test,verbose=0))","5b8fb0e2":"from sklearn.metrics import classification_report,confusion_matrix\n\npredictions = model.predict_classes(x_test)\nprint(classification_report(y_test,predictions))","889dbafe":"**SVM**","087436f5":"**Random Forest**","418944d7":"**ANN**","0e7eb031":"Hello, I want to share my humble work regarding this dataset. I tried to make ML models to predict whether the shoppers will be generated revenue or not based on customer behaviour. Here you can see the performance difference between the ML algorithms (decision tree, random forest, SVM, ANN).","097e49bb":"**Decision Tree**"}}