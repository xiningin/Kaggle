{"cell_type":{"52216b08":"code","833dfb45":"code","40d7fdd4":"code","662042e1":"code","dba421c8":"code","67ee71bd":"code","10b5635b":"code","d81b2024":"code","9f72244d":"code","ab2d0ee0":"code","2bc8b55e":"code","107a7893":"code","e5face03":"code","8251f99d":"code","06f97f99":"code","a4d1eb30":"code","9b7098f1":"code","4187ee00":"code","e8fcb5bd":"code","c7374eff":"code","2bbe41d0":"code","faac602b":"code","ca182d8e":"code","df71e263":"code","d5691449":"code","00cc2dde":"code","23c6c9df":"code","912d4447":"code","573d2485":"code","898b4374":"code","bf7c0813":"code","2870f8fa":"code","5bf574a7":"code","9fffa676":"code","49b3e1a4":"code","4e46cb6b":"code","ada5b52a":"code","d9e4f62c":"code","2f35d143":"code","b3f3bef3":"code","521b3303":"code","c734525a":"code","c9789afa":"code","d966905c":"code","c9ed62a6":"code","265696a3":"code","bc3198e6":"code","bcce5e26":"code","d2d024fc":"code","a915ad95":"code","8f750a86":"code","bea58e2d":"code","a5abd876":"code","90b29a23":"code","3981f239":"code","deaab2af":"code","a52c33d7":"markdown","fa6f9b4a":"markdown","f0834d98":"markdown","2e3378c8":"markdown","ace717b8":"markdown","42e378b7":"markdown","b319e08c":"markdown","85e566a3":"markdown","ef2ea54f":"markdown","b72a1aa1":"markdown","1a60ee8e":"markdown","e841c0b2":"markdown","e44f06f2":"markdown","5406093f":"markdown","6b04338d":"markdown","23b7013d":"markdown","13649982":"markdown","9c585043":"markdown","fbba8028":"markdown","98441ad0":"markdown","1726b399":"markdown","4d4159a8":"markdown","ed4a0c36":"markdown"},"source":{"52216b08":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","833dfb45":"import random as rnd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport eli5\n\n#statistic\nfrom scipy import stats\nfrom pandas import DataFrame\nfrom scipy.stats import chisquare\nfrom scipy.stats import chi2_contingency\nfrom statsmodels.graphics.mosaicplot import mosaic\n\n# machine learning structures\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.svm import SVC, LinearSVC\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.naive_bayes import GaussianNB\nfrom sklearn.linear_model import Perceptron\nfrom sklearn.linear_model import SGDClassifier\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.tree import export_graphviz\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.metrics import classification_report\nfrom sklearn import metrics\nimport statsmodels.api as sm\nfrom IPython import display\nimport graphviz\nfrom sklearn.metrics import roc_curve, auc\nfrom sklearn.metrics import confusion_matrix\nfrom sklearn.metrics import accuracy_score\nfrom eli5.sklearn import PermutationImportance\n\npd.options.mode.chained_assignment = None  #hide any pandas warnings\n\n# get the data\nhd_data_path = '..\/input\/heart-disease-uci\/heart.csv'\nhd_data = pd.read_csv(hd_data_path)\n","40d7fdd4":"hd_data = hd_data.apply(pd.to_numeric)\n\n# preview the data\nhd_data.head()","662042e1":"# check whether data has null value\nhd_data.info()","dba421c8":"# missing values\nhd_data.isnull().sum()","67ee71bd":"# see basic values about the data\nhd_data.describe()","10b5635b":"# check correlation between columns\nplt.figure(figsize=(16, 12))\ncorr = hd_data.corr()\nax = sns.heatmap(\n    corr, square=True, annot=True, fmt='.2f'\n)\nplt.show()","d81b2024":"hd_data.groupby('target').mean()","9f72244d":"colors=['cadetblue', 'gold']\nsns.countplot(x=\"target\", data=hd_data, palette=colors, alpha=0.5, edgecolor='black', linewidth=2)\nplt.show()","ab2d0ee0":"hd_data_target_1=hd_data[hd_data.target==1]\nhd_data_target_0=hd_data[hd_data.target==0]","2bc8b55e":"f,ax=plt.subplots(3,2,figsize=(16,12))\nf.delaxes(ax[2,1])\n\nfor i,feature in enumerate(['age','thalach','chol','trestbps','oldpeak','age']):\n    colors = ['cadetblue', 'gold']\n    sns.countplot(x=feature,data=hd_data,hue='target',ax=ax[i\/\/2,i%2], palette = colors, alpha=0.7, linewidth=2)\n    \n    #sns.despine(ax[i\/\/2,i%2]=ax[i\/\/2,i%2], left=True)\n    ax[i\/\/2,i%2].set_ylabel(\"frequency\", fontsize=12)\n    ax[i\/\/2,i%2].set_xlabel(str(feature), fontsize=12)\n\nplt.tight_layout()\nplt.show()","107a7893":"# the code from https:\/\/www.kaggle.com\/vincentlugat\/heart-disease-analysis-and-prediction\n\nf,ax=plt.subplots(3,2,figsize=(12,12))\nf.delaxes(ax[2,1])\n\nfor i,feature in enumerate(['age','thalach','chol','trestbps','oldpeak','age']):\n    sns.distplot(hd_data[hd_data['target']==0][(feature)], ax=ax[i\/\/2,i%2], kde_kws={\"color\":\"cadetblue\"}, hist=False )\n    sns.distplot(hd_data[hd_data['target']==1][(feature)], ax=ax[i\/\/2,i%2], kde_kws={\"color\":\"gold\"}, hist=False )\n\n    # Get the two lines from the ax[i\/\/2,i%2]es to generate shading\n    l1 = ax[i\/\/2,i%2].lines[0]\n    l2 = ax[i\/\/2,i%2].lines[1]\n\n    # Get the xy data from the lines so that we can shade\n    x1 = l1.get_xydata()[:,0]\n    y1 = l1.get_xydata()[:,1]\n    x2 = l2.get_xydata()[:,0]\n    y2 = l2.get_xydata()[:,1]\n    ax[i\/\/2,i%2].fill_between(x2,y2, color=\"gold\", alpha=0.6)\n    ax[i\/\/2,i%2].fill_between(x1,y1, color=\"cadetblue\", alpha=0.6)\n\n     #grid\n    ax[i\/\/2,i%2].grid(b=True, which='major', color='grey', linewidth=0.3)\n    \n    ax[i\/\/2,i%2].set_title('{} - target'.format(feature), fontsize=18)\n    ax[i\/\/2,i%2].set_ylabel('count', fontsize=12)\n    ax[i\/\/2,i%2].set_xlabel('Modality', fontsize=12)\n\n    #sns.despine(ax[i\/\/2,i%2]=ax[i\/\/2,i%2], left=True)\n    ax[i\/\/2,i%2].set_ylabel(\"frequency\", fontsize=12)\n    ax[i\/\/2,i%2].set_xlabel(str(feature), fontsize=12)\n\nplt.tight_layout()\nplt.show()","e5face03":"f,ax=plt.subplots(3,2,figsize=(12,12))\nf.delaxes(ax[2,1])\n\nfor i,feature in enumerate(['age','thalach','chol','trestbps','oldpeak','age']):\n    colors = ['cadetblue', 'gold']\n    sns.boxplot(x=\"target\", y=feature , data=hd_data, ax=ax[i\/\/2,i%2], palette=colors, boxprops=dict(alpha=0.8))\n\n    # Get the two lines from the ax[i\/\/2,i%2]es to generate shading\n    l1 = ax[i\/\/2,i%2].lines[0]\n    l2 = ax[i\/\/2,i%2].lines[1]\n\n    # Get the xy data from the lines so that we can shade\n    x1 = l1.get_xydata()[:,0]\n    y1 = l1.get_xydata()[:,1]\n    x2 = l2.get_xydata()[:,0]\n    y2 = l2.get_xydata()[:,1]\n    ax[i\/\/2,i%2].fill_between(x2,y2, color=\"gold\", alpha=0.6)\n    ax[i\/\/2,i%2].fill_between(x1,y1, color=\"cadetblue\", alpha=0.6)\n\n     #grid\n    ax[i\/\/2,i%2].grid(b=True, which='major', color='grey', linewidth=0.3)\n    \n    ax[i\/\/2,i%2].set_title('{} - target'.format(feature), fontsize=18)\n    ax[i\/\/2,i%2].set_ylabel('count', fontsize=12)\n    ax[i\/\/2,i%2].set_xlabel('Modality', fontsize=12)\n\n    #sns.despine(ax[i\/\/2,i%2]=ax[i\/\/2,i%2], left=True)\n    ax[i\/\/2,i%2].set_ylabel(\"frequency\", fontsize=12)\n    ax[i\/\/2,i%2].set_xlabel(str(feature), fontsize=12)\n\nplt.tight_layout()\nplt.show()","8251f99d":"# t-test\n\n# age and target\ntTestResult = stats.ttest_ind(hd_data_target_1['age'], hd_data_target_0['age'])\ntTestResultDiffVar = stats.ttest_ind(hd_data_target_1['age'], hd_data_target_0['age'], equal_var=False)\nprint('* age & target')\nprint(tTestResultDiffVar)\nprint(\"\")\n\n# trestbps and target\ntTestResult = stats.ttest_ind(hd_data_target_1['trestbps'], hd_data_target_0['trestbps'])\ntTestResultDiffVar = stats.ttest_ind(hd_data_target_1['trestbps'], hd_data_target_0['trestbps'], equal_var=False)\nprint('* trestbps & target')\nprint(tTestResultDiffVar)\nprint(\"\")\n\n# chol and target\ntTestResult = stats.ttest_ind(hd_data_target_1['chol'], hd_data_target_0['chol'])\ntTestResultDiffVar = stats.ttest_ind(hd_data_target_1['chol'], hd_data_target_0['chol'], equal_var=False)\nprint('* chol & target')\nprint(tTestResultDiffVar)\nprint(\"\")\n\n# thalach and target\ntTestResult = stats.ttest_ind(hd_data_target_1['thalach'], hd_data_target_0['thalach'])\ntTestResultDiffVar = stats.ttest_ind(hd_data_target_1['thalach'], hd_data_target_0['thalach'], equal_var=False)\nprint('* thalach & target')\nprint(tTestResultDiffVar)\nprint(\"\")\n\n# oldpeak and target\ntTestResult = stats.ttest_ind(hd_data_target_1['oldpeak'], hd_data_target_0['oldpeak'])\ntTestResultDiffVar = stats.ttest_ind(hd_data_target_1['oldpeak'], hd_data_target_0['oldpeak'], equal_var=False)\nprint('* oldpeak & target')\nprint(tTestResultDiffVar)\nprint(\"\")","06f97f99":"# scatter plot between numeric variables\nvar=['age', 'thalach', 'oldpeak', 'target']\nsns.pairplot(hd_data[var], kind='scatter', diag_kind='hist')\nplt.show()","a4d1eb30":"# check regression plot\n\n# age and thalach\nf, ax = plt.subplots(figsize=(8, 6))\nax = sns.regplot(x=\"age\", y=\"thalach\", data=hd_data)\nplt.show()\n\n# age and oldpeak\nf, ax = plt.subplots(figsize=(8, 6))\nax = sns.regplot(x=\"age\", y=\"oldpeak\", data=hd_data)\nplt.show()\n\n# thalach and oldpeak\nf, ax = plt.subplots(figsize=(8, 6))\nax = sns.regplot(x=\"thalach\", y=\"oldpeak\", data=hd_data)\nplt.show()","9b7098f1":"# check correlation between columns\nplt.figure(figsize=(16, 12))\ncorr = hd_data[var].corr()\nax = sns.heatmap(\n    corr, square=True, annot=True, fmt='.2f')\nplt.show()","4187ee00":"# code from https:\/\/www.kaggle.com\/vincentlugat\/heart-disease-analysis-and-prediction\n\nf,ax=plt.subplots(4,2,figsize=(12,12))\n\nfor i,feature in enumerate(['sex','cp','fbs','restecg','exang','slope','ca','thal']):\n    colors = ['cadetblue', 'gold']\n    sns.countplot(x=feature,data=hd_data,hue='target',ax=ax[i\/\/2,i%2], palette = colors, alpha=0.7, edgecolor=('black'), linewidth=2)\n    ax[i\/\/2,i%2].grid(b=True, which='major', color='grey', linewidth=0.4)\n    ax[i\/\/2,i%2].set_title('Count of {} vs target'.format(feature), fontsize=18)\n    ax[i\/\/2,i%2].legend(loc='best')\n    ax[i\/\/2,i%2].set_ylabel('count', fontsize=12)\n    ax[i\/\/2,i%2].set_xlabel('modality', fontsize=12)\n\nplt.tight_layout()\nplt.show()","e8fcb5bd":"mosaic(hd_data.sort_values('sex'), ['target', 'sex'],\n      title='Mosaic chart of sex and target')\nplt.show()\n\nmosaic(hd_data.sort_values('cp'), ['target', 'cp'],\n      title='Mosaic chart of cp and target')\nplt.show()\n\nmosaic(hd_data.sort_values('fbs'), ['target', 'fbs'],\n      title='Mosaic chart of fbs and target')\nplt.show()\n\nmosaic(hd_data.sort_values('restecg'), ['target', 'restecg'],\n      title='Mosaic chart of restecg and target')\nplt.show()\n\nmosaic(hd_data.sort_values('exang'), ['target', 'exang'],\n      title='Mosaic chart of exang and target')\nplt.show()\n\nmosaic(hd_data.sort_values('slope'), ['target', 'slope'],\n      title='Mosaic chart of slope and target')\nplt.show()\n\nmosaic(hd_data.sort_values('ca'), ['target', 'ca'],\n      title='Mosaic chart of ca and target')\nplt.show()\n\nmosaic(hd_data.sort_values('thal'), ['target', 'thal'],\n      title='Mosaic chart of thal and target')\nplt.show()","c7374eff":"print(hd_data.groupby('sex')['target'].value_counts())\nprint(hd_data.groupby('cp')['target'].value_counts())\nprint(hd_data.groupby('fbs')['target'].value_counts())\nprint(hd_data.groupby('restecg')['target'].value_counts())\nprint(hd_data.groupby('slope')['target'].value_counts())\nprint(hd_data.groupby('exang')['target'].value_counts())\nprint(hd_data.groupby('ca')['target'].value_counts())\nprint(hd_data.groupby('thal')['target'].value_counts())","2bbe41d0":"sex_target0, sex_target1 = [24, 114], [72, 93]\nsex_target = DataFrame([sex_target0, sex_target1], columns=['sex=0(F)', 'sex=1(M)'], index=['target=0(No Disease)', 'target=1(Have Disease)'])\n\ncp_target0, cp_target1 = [104, 9, 18, 7], [39, 41, 69, 16]\ncp_target = DataFrame([cp_target0, cp_target1], columns=['cp=0', 'cp=1', 'cp=2', 'cp=3'], index=['target=0(No Disease)', 'target=1(Have Disease)'])\n\nfbs_target0, fbs_target1 = [116, 22], [142, 23]\nfbs_target = DataFrame([fbs_target0, fbs_target1], columns=['fbs=0(<=120mg\/dl)', 'fbs=1(>120mg\/dl)'], index=['target=0(No Disease)', 'target=1(Have Disease)'])\n\nrest_target0, rest_target1 = [79, 56, 3], [68, 96, 1]\nrest_target = DataFrame([rest_target0, rest_target1], columns=['restecg=0(normal)', 'restecg=1(ST-T)', 'restecg=2(Probable)'], index=['target=0(No Disease)', 'target=1(Have Disease)'])\n\nslp_target0, slp_target1 = [12, 91, 35], [9, 49, 107]\nslp_target = DataFrame([slp_target0, slp_target1], columns=['slp=0', 'slp=1', 'slp=2'], index=['target=0(No Disease)', 'target=1(Have Disease)'])\n\nex_target0, ex_target1 = [62, 76], [142, 23]\nex_target = DataFrame([ex_target0, ex_target1], columns=['ex=0(not induced)', 'ex=1(induced)'], index=['target=0(No Disease)', 'target=1(Have Disease)'])\n\nca_target0, ca_target1 = [45, 44, 31, 17, 1], [130, 21, 7, 3, 4]\nca_target = DataFrame([ca_target0,ca_target1], columns=['ca=0', 'ca=1', 'ca=2', 'ca=3', 'ca=4'], index=['target=0(No Disease)', 'target=1(Have Disease)'])\n\nthal_target0, thal_target1 = [1, 12, 36, 89], [1, 6, 130, 28]\nthal_target = DataFrame([thal_target0,thal_target1], columns=['thal=0', 'thal=1', 'thal=2', 'thal=3'], index=['target=0(No Disease)', 'target=1(Have Disease)'])\n","faac602b":"sex_target","ca182d8e":"cp_target","df71e263":"fbs_target","d5691449":"rest_target","00cc2dde":"rest_target0, rest_target1 = [79, 59], [68, 97]\nrest_target = DataFrame([rest_target0, rest_target1], columns=['restecg=0(normal)', 'restecg=1(ST-T)'], index=['target=0(No Disease)', 'target=1(Have Disease)'])\nrest_target","23c6c9df":"slp_target","912d4447":"ex_target","573d2485":"ca_target","898b4374":"ca_target0, ca_target1 = [45, 44, 31, 18], [130, 21, 7, 7]\nca_target = DataFrame([ca_target0,ca_target1], columns=['ca=0', 'ca=1', 'ca=2', 'ca=3'], index=['target=0(No Disease)', 'target=1(Have Disease)'])\nca_target","bf7c0813":"thal_target","2870f8fa":"thal_target0, thal_target1 = [13, 36, 89], [7, 130, 28]\nthal_target = DataFrame([thal_target0,thal_target1], columns=['thal=1', 'thal=2', 'thal=3'], index=['target=0(No Disease)', 'target=1(Have Disease)'])\nthal_target","5bf574a7":"# code from https:\/\/m.blog.naver.com\/PostView.nhn?blogId=parksehoon1971&logNo=221589203965&proxyReferer=https%3A%2F%2Fwww.google.com%2F\n\nchi2, p, dof, expected = chi2_contingency([sex_target0, sex_target1])\nprint(\" * sex - target expected frequency\")\nprint(expected)\nprint(\"\")\n\nchi2, p, dof, expected = chi2_contingency([cp_target0, cp_target1])\nprint(\" * cp - target expected frequency\")\nprint(expected)\nprint(\"\")\n\nchi2, p, dof, expected = chi2_contingency([fbs_target0, fbs_target1])\nprint(\" * fbs - target expected frequency\")\nprint(expected)\nprint(\"\")\n\nchi2, p, dof, expected = chi2_contingency([rest_target0, rest_target1])\nprint(\" * rest - target expected frequency\")\nprint(expected)\nprint(\"\")\n\nchi2, p, dof, expected = chi2_contingency([slp_target0, slp_target1])\nprint(\" * slp - target expected frequency\")\nprint(expected)\nprint(\"\")\n\nchi2, p, dof, expected = chi2_contingency([ex_target0, ex_target1])\nprint(\" * ex - target expected frequency\")\nprint(expected)\nprint(\"\")\n\nchi2, p, dof, expected = chi2_contingency([ca_target0, ca_target1])\nprint(\" * ca - target expected frequency\")\nprint(expected)\nprint(\"\")\n\nchi2, p, dof, expected = chi2_contingency([thal_target0, thal_target1])\nprint(\" * thal - target expected frequency\")\nprint(expected)\nprint(\"\")","9fffa676":"sex_target_result = chisquare(sex_target0, f_exp=sex_target1)\ncp_target_result = chisquare(cp_target0, f_exp=cp_target1)\nfbs_target_result = chisquare(fbs_target0, f_exp=fbs_target1)\nrest_target_result = chisquare(rest_target0, f_exp=rest_target1)\nslp_target_result = chisquare(slp_target0, f_exp=slp_target1)\nex_target_result = chisquare(ex_target0, f_exp=ex_target1)\nca_target_result = chisquare(ca_target0, f_exp=ca_target1)\nthal_target_result = chisquare(thal_target0, f_exp=thal_target1)","49b3e1a4":"print(\" * sex-target\")\nprint(sex_target_result)\nprint(\"\")\nprint(\" * cp-target\")\nprint(cp_target_result)\nprint(\"\")\nprint(\" * fbs-target\")\nprint(fbs_target_result)\nprint(\"\")\nprint(\" * rest-target\")\nprint(rest_target_result)\nprint(\"\")\nprint(\" * slp-target\")\nprint(slp_target_result)\nprint(\"\")\nprint(\" * ex-target\")\nprint(ex_target_result)\nprint(\"\")\nprint(\" * ca-target\")\nprint(ca_target_result)\nprint(\"\")\nprint(\" * thal-target\")\nprint(thal_target_result)\nprint(\"\")","4e46cb6b":"y = hd_data.target\nX = hd_data","ada5b52a":"# choose the cols(which has p value smaller than 0.01)\nfiltered_col = ['age', 'sex', 'cp', 'restecg', 'thalach', 'exang', 'oldpeak', 'slope', 'ca', 'thal']\ny1 = y\nX1 = X[filtered_col]\n\n# split into train set and test set\ntrain_X1, test_X1, train_y1, test_y1 = train_test_split(X1, y1, random_state=0)","d9e4f62c":"# Random Forest\nrandom_forest = RandomForestClassifier(n_estimators=100, max_depth = 7)\nrandom_forest.fit(train_X1, train_y1)\ny_pred = random_forest.predict(test_X1)\n\nacc_RandomForest = accuracy_score(test_y1, y_pred)*100\nprint(acc_RandomForest)","2f35d143":"# code from https:\/\/towardsdatascience.com\/how-to-visualize-a-decision-tree-from-a-random-forest-in-python-using-scikit-learn-38ad2d75f21c\n\nestimator = random_forest.estimators_[1]\n\nexport_graphviz(estimator, out_file='tree.dot', \n                feature_names = train_X1.columns,\n                class_names = [\"0(No disease)\",\"1(Have disease)\"],\n                rounded = True, proportion = True, \n                label='root', filled = True,\n                precision = 2)\n\nfrom subprocess import call\ncall(['dot', '-Tpng', 'tree.dot', '-o', 'tree.png', '-Gdpi=600'])\n\nfrom IPython.display import Image\nImage(filename = 'tree.png')","b3f3bef3":"# code fromhttps:\/\/www.kaggle.com\/cdabakoglu\/heart-disease-classifications-machine-learning\n\n# KNN\n# try ro find best k value\nscoreList = []\nfor i in range(1,20):\n    knn2 = KNeighborsClassifier(n_neighbors = i)  # n_neighbors means k\n    knn2.fit(train_X1, train_y1)\n    y_pred = knn2.predict(test_X1)\n    scoreList.append(accuracy_score(test_y1, y_pred))\n    \nplt.plot(range(1,20), scoreList)\nplt.xticks(np.arange(1,20,1))\nplt.xlabel(\"K value\")\nplt.ylabel(\"Score\")\nplt.show()\n\naccuracies = {}\nacc = max(scoreList)*100\naccuracies['KNN'] = acc\nprint(\"Maximum KNN Score is {:.2f}%\".format(acc))\n\n","521b3303":"# KNN\nknn = KNeighborsClassifier(n_neighbors = 13)\nknn.fit(train_X1, train_y1)\ny_pred = knn.predict(test_X1)\nacc_knn = accuracy_score(test_y1, y_pred)*100\nprint(acc_knn)","c734525a":"# Gaussian Naive Bayes\n\ngaussian = GaussianNB()\ngaussian.fit(train_X1, train_y1)\ny_pred = gaussian.predict(test_X1)\nacc_gaussian_naive_bayes = accuracy_score(test_y1, y_pred)*100\nprint(acc_gaussian_naive_bayes)\n","c9789afa":"# Perceptron\n\nperceptron = Perceptron()\nperceptron.fit(train_X1, train_y1)\ny_pred = perceptron.predict(test_X1)\nacc_perceptron = accuracy_score(test_y1, y_pred)*100\nprint(acc_perceptron)\n","d966905c":"# Linear SVC\n\nlinear_svc = LinearSVC()\nlinear_svc.fit(train_X1, train_y1)\ny_pred = linear_svc.predict(test_X1)\nacc_linear_svc = accuracy_score(test_y1, y_pred)*100\nprint(acc_linear_svc)\n","c9ed62a6":"# Stochastic Gradient Descent\n\nsgd = SGDClassifier()\nsgd.fit(train_X1, train_y1)\ny_pred = sgd.predict(test_X1)\nacc_stochastic_gradient_descent = accuracy_score(test_y1, y_pred)*100\nprint(acc_stochastic_gradient_descent)\n","265696a3":"# Decision Tree\n\ndecision_tree = DecisionTreeClassifier(max_depth=7)\ndecision_tree.fit(train_X1, train_y1)\ny_pred = decision_tree.predict(test_X1)\nacc_decision_tree = accuracy_score(test_y1, y_pred)*100\nprint(acc_decision_tree)\n","bc3198e6":"export_graphviz(decision_tree, out_file=\"tree.dot\",\n                feature_names=train_X1.columns, \n                class_names=[\"0(No disease)\",\"1(Have disease)\"], \n                rounded = True, proportion = True, \n                label='root', precision = 2,\n                filled=True, impurity=True)\nfrom subprocess import call\ncall(['dot', '-Tpng', 'tree.dot', '-o', 'tree.png', '-Gdpi=600'])\n\nfrom IPython.display import Image\nImage(filename = 'tree.png')","bcce5e26":"# Logistic Regression\n\nlogistic_regression_model = LogisticRegression()\nlogistic_regression_model.fit(train_X1, train_y1)\nX1=sm.add_constant(X)\nmodel=sm.OLS(y, X1)\nres=model.fit()\ny_pred = logistic_regression_model.predict(test_X1)\nacc_logistic_regression=accuracy_score(test_y1, y_pred)*100\nprint(acc_logistic_regression)\n","d2d024fc":"models = pd.DataFrame({\n    'Model': ['KNN', 'Logistic Regression', \n              'Random Forest', 'Naive Bayes', 'Perceptron', \n              'Stochastic Gradient Decent', 'Linear SVC', \n              'Decision Tree'],\n    'Score': [acc_knn, acc_logistic_regression, \n              acc_RandomForest, acc_gaussian_naive_bayes, acc_perceptron, \n              acc_stochastic_gradient_descent, acc_linear_svc, acc_decision_tree]})\nmodels.sort_values(by='Score', ascending=False)","a915ad95":"plt.rcParams['figure.figsize']=(15,8)\n\ncolors = ['palegoldenrod','lightgreen','cadetblue','gold','greenyellow','aquamarine','steelblue','khaki']\n\nax = plt.bar(x='Model', data=models, height=\"Score\", alpha=0.7, color=colors, edgecolor=('black'), linewidth=2)\nplt.ylabel('accuracy score', fontsize=12)\nplt.xlabel('model', fontsize=12)\nplt.title('Accuracy score of Models', fontsize=18)\nplt.show()\n","8f750a86":"# code from https:\/\/www.kaggle.com\/tentotheminus9\/what-causes-heart-disease-explaining-the-model\n\ny_pred = random_forest.predict(test_X1)\ny_pred_quant = random_forest.predict_proba(test_X1)[:, 1]\ny_pred_bin = random_forest.predict(test_X1)","bea58e2d":"confusion_matrix = confusion_matrix(test_y1, y_pred_bin)\nconfusion_matrix","a5abd876":"total=sum(sum(confusion_matrix))\n\nsensitivity = confusion_matrix[0,0]\/(confusion_matrix[0,0]+confusion_matrix[1,0])\nprint('Sensitivity : ', sensitivity )\n\nspecificity = confusion_matrix[1,1]\/(confusion_matrix[1,1]+confusion_matrix[0,1])\nprint('Specificity : ', specificity)","90b29a23":"fpr, tpr, thresholds = roc_curve(test_y1, y_pred_quant)\n\nfig, ax = plt.subplots()\nax.plot(fpr, tpr)\nax.plot([0, 1], [0, 1], transform=ax.transAxes, ls=\"--\", c=\".3\")\nplt.xlim([0.0, 1.0])\nplt.ylim([0.0, 1.0])\nplt.rcParams['font.size'] = 12\nplt.title('ROC curve')\nplt.xlabel('False Positive Rate (1 - Specificity)')\nplt.ylabel('True Positive Rate (Sensitivity)')\nplt.grid(True)","3981f239":"auc(fpr, tpr)","deaab2af":"perm = PermutationImportance(random_forest, random_state=1).fit(test_X1, test_y1)\neli5.show_weights(perm, feature_names = test_X1.columns.tolist())","a52c33d7":"The count of 'restecg=2' is so small that it will be combined into 'restecg=1'.","fa6f9b4a":"# 4. Make machine learning model","f0834d98":"# Heart Disease Prediction\n\nFinding the best machine learning model with Heart Disease UCI data.\n> 1. About the columns\n> 2. Get data, Import Libraries\n> 3. Explore data\n    * 3.1 target\n    * 3.2 numerical attributes & target\n    * 3.3 correlation between numerical attributes\n    * 3.4 categorical attributes & target\n> 4. Make machine learning model\n    * 4.1 Choose the attributes & Make train\/test set\n    * 4.2 Make models\n    * 4.3 Model evaluation","2e3378c8":"# AUC\n\n- 0.90 - 1.00 = excellent\n- 0.80 - 0.90 = good\n- 0.70 - 0.80 = fair\n- 0.60 - 0.70 = poor\n- 0.50 - 0.60 = fail","ace717b8":"# 4.1 Choose the attributes & Make train\/test set","42e378b7":"It's excellent!","b319e08c":"# 3.3 Correlation between numerical attributes\n- scatter plot - age, thalach, oldpeak\n- age & thalach\n- age & oldpeak\n- thalach & oldpeak","85e566a3":"The best model is Random Forest!!","ef2ea54f":"# 4.3 Model Evaluation","b72a1aa1":"Thanks!!","1a60ee8e":"fbs -> p-value>0.01 -> remove fbs from modeling attributes.","e841c0b2":"# 1. About the columns\n","e44f06f2":"The count of 'ca=4' is so small that it will be combined into 'ca=3'.","5406093f":"check the expected value","6b04338d":"The count of 'thal=0' is so small that it will be combined into 'thal=1'.","23b7013d":"# 3.2 Numerical attributes & target\n- crosstab\n- kde\n- boxplot\n- t-test (critical value = 0.01)","13649982":"# 3. Explore data","9c585043":"# 2. Get data, Import libraries","fbba8028":"# 4.2 Make various machine learning models\n- Random Forest\n- KNN\n- Gausian Naive Bayes\n- Perceptron\n- Linear SVC\n- Stochastic Gradient Descent\n- Decision Tree\n- Logistic Regression","98441ad0":"trestbps & chol -> p-value > 0.01\nRemove trestbps, chol from the modeling attributes.\n\nage & thalach & oldpeak -> p-value < 0.01\nUse them to modeling.","1726b399":"# 3.1 target","4d4159a8":"# 3.4 Categorical attributes & target\n- crosstab\n- mosaic plot\n- chi-sqare test","ed4a0c36":"- **age**\n- **sex** 1 = male, 0 = female\n- **cp:** The chest pain experienced (Value 1: typical angina, Value 2: atypical angina, Value 3: had pain but not angina, Value 4: had no pain)\n- **trestbps:** Resting Blood Pressure\n- **chol:** Cholesterol level\n- **fbs:** Fasting Blood Sugar (Blood Sugar Level on empty stomach, over 126mg\/dl => Diabetes area) (> 120 mg\/dl, 1 = true; 0 = false)\n- **restecg:** Resting electrocardiogram(ECG) (0 = normal, 1 = having ST-T change, 2 = left ventricular hypertrophy(serious))\n- **thalach:** Maximum Heart Rate\n- **exang:** Stable angina (angina caused by exercise) (1 = yes; 0 = no)\n- **oldpeak:** ST depression (how low EGC's ST segments point is from the base line)\n- **slope:** the slope of the peak exercise ST segment (Value 0: upsloping(ST-elevation), Value 1: flat(Normal), Value 2: downsloping(ST-depression))\n- **ca:** The number of major blood vessels (0-4) colored by fluoroscopy(X-ray)\n- **thal:** Thalassemia (Anemia caused by defective globine genes. Fail to produce normal hemoglobin.)\n- **target:** Have Heart Disease (0 = no, 1 = yes)"}}