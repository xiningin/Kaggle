{"cell_type":{"e9476b61":"code","48637daf":"code","e1777919":"code","42459d7f":"code","d6ca7cc7":"code","5074e747":"code","399b364c":"code","f012fdd1":"code","ce6b7bb0":"code","72e30e55":"code","385d9310":"code","5da08177":"code","5f2b2eb9":"code","4150d77c":"code","93253600":"code","06a79def":"code","fb48e529":"code","c7fb6601":"code","c60c0cc5":"code","92ce172f":"code","d31030da":"code","e782bafb":"code","06a1ed86":"code","cfa8ce07":"code","2b50fe60":"code","e13605b5":"code","755bc2c1":"code","c7200e64":"markdown","059c8216":"markdown","3022306c":"markdown","9763ca71":"markdown","3bd7fc92":"markdown","65b263c1":"markdown","15ba7770":"markdown","dbb6a0a1":"markdown","f5e94fbd":"markdown","bc316b84":"markdown","8777f1e1":"markdown","0e2dd2db":"markdown","35671552":"markdown","aa62c6f7":"markdown","ced2f4d6":"markdown","7b68e0c6":"markdown","961777a2":"markdown","eeb89976":"markdown","72f809a7":"markdown"},"source":{"e9476b61":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nplt.style.use('fivethirtyeight')\nsns.set_style('whitegrid')\n\n#plotly\nimport plotly.express as px\nimport plotly.graph_objects as go\nfrom plotly.subplots import make_subplots\n\nimport folium\nimport datetime\nimport calendar\n\n\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n","48637daf":"#get the data\ndf = pd.read_csv('..\/input\/nypd-motor-vehicle-collisions\/nypd-motor-vehicle-collisions.csv', dtype=str)","e1777919":"#sohw dataframe\ndf.head(3)","42459d7f":"#dataset shape\nprint('DATASET SHAPE: ', df.shape)","d6ca7cc7":"#show feature data types\ndf.info()","5074e747":"#replace capslock to lowercase\ndf.columns = [i.lower() for i in df.columns]\n#date to pandas datetime object\ndf['accident date'] = pd.to_datetime(df['accident date'])\ndf['accident time'] = pd.to_datetime(df['accident time']).dt.time","399b364c":"#convert back the numeric features\nnum_feat = [i for i in df.columns if 'number' in i] + ['latitude', 'longitude']\ndf[num_feat] = df[num_feat].apply(pd.to_numeric, errors='coerce')","f012fdd1":"#show null value percentage per feature\npd.DataFrame(df.isnull().sum() \/ df.shape[0] *100, columns=['Missing Value %'])","ce6b7bb0":"plt.figure(figsize=(12,5))\nplt.title('HEATMAP OF MISSING VALUES', fontsize=18)\nsns.heatmap(df.isnull(), yticklabels=False)","72e30e55":"plt.figure(figsize=(10,5))\nplt.title('ACCIDENTS COUNTPLOT PER BOROUGH')\nsns.barplot(x=df.groupby('borough').size().index,\n            y=df.groupby('borough').size().values)","385d9310":"accidents_bor_df = df.groupby('borough')[['number of persons injured', 'number of persons killed']].sum()\n\n\nfig, ax = plt.subplots(1,2,figsize=(14,5))\nplt.suptitle('DISTRIBUTION PER NUMBER OF INJURED AND KILLED')\n\nax[1].set_xticklabels(labels=accidents_bor_df.index,rotation=30)\nax[0].set_xticklabels(labels=accidents_bor_df.index,rotation=30)\n\n\nsns.barplot(accidents_bor_df.index, accidents_bor_df['number of persons injured'], ax=ax[0])\nsns.barplot(accidents_bor_df.index, accidents_bor_df['number of persons killed'], ax=ax[1], palette='deep')\n\n","5da08177":"fig, ax = plt.subplots(1,2, figsize=(14,5))\nplt.suptitle('DISTRIBUTION BY PERCENTAGE')\n\nax[1].set_xticklabels(labels=accidents_bor_df.index,rotation=30)\nax[0].set_xticklabels(labels=accidents_bor_df.index,rotation=30)\nax[0].set_title('INJURED PERCENTAGE', fontsize=12)\nax[1].set_title('KILLED PERCENTAGE', fontsize=12)\n\n\nsns.barplot((accidents_bor_df['number of persons injured'] \/ df.groupby('borough').size() *100).index, \n           (accidents_bor_df['number of persons injured'] \/ df.groupby('borough').size() *100).values, ax=ax[0], palette='viridis')\n\nsns.barplot((accidents_bor_df['number of persons killed'] \/ df.groupby('borough').size() *100).index, \n           (accidents_bor_df['number of persons killed'] \/ df.groupby('borough').size() *100).values, ax=ax[1], palette='magma')","5f2b2eb9":"print('MEAN INJURED: ',(accidents_bor_df['number of persons injured'] \/ df.groupby('borough').size() *100).values.mean())\nprint('MEAN KILLED: ',(accidents_bor_df['number of persons killed'] \/ df.groupby('borough').size() *100).values.mean())","4150d77c":"datewise = df.groupby(['accident date', 'borough'])[[i for i in df.columns if 'number' in i]].sum()","93253600":"fig = make_subplots(rows=2,cols=1, \n                    subplot_titles=('NUMBER OF INJURED PER DAY', 'NUMBER OF KILLED PER DAY'))\ncols = ['QUEENS', 'BROOKLYN', 'MANHATTAN', 'BRONX', 'STATEN ISLAND']\nfeat  = [i for i in df.columns if 'number' in i] + ['accident date']\n\nfor i, bor in enumerate(cols):\n    data_per_bor = df[df['borough']== bor][feat]\n    data_per_bor = data_per_bor.groupby('accident date').sum()\n    \n    fig.add_trace(go.Scatter(x=data_per_bor.index, y=data_per_bor['number of persons injured'], name=bor), row=1,col=1)\n    fig.add_trace(go.Scatter(x=data_per_bor.index, y=data_per_bor['number of persons killed'], name=bor), row=2, col=1)\n\nfig.update_layout(template='plotly_dark', width=1000, height=800)\nfig.show()","06a79def":"fig = make_subplots(rows=2,cols=1, \n                    subplot_titles=('NUMBER OF INJURED PER DAY', 'NUMBER OF KILLED PER DAY'))\ncols = ['QUEENS', 'BROOKLYN', 'MANHATTAN', 'BRONX', 'STATEN ISLAND']\nfeat  = [i for i in df.columns if 'number' in i] + ['accident date']\n\nfor i, bor in enumerate(cols):\n    data_per_bor = df[df['borough']== bor][feat]\n    data_per_bor = data_per_bor.groupby('accident date').sum()[-365:]\n    \n    fig.add_trace(go.Scatter(x=data_per_bor.index, y=data_per_bor['number of persons injured'], name=bor), row=1,col=1)\n    fig.add_trace(go.Scatter(x=data_per_bor.index, y=data_per_bor['number of persons killed'], name=bor), row=2, col=1)\n\nfig.update_layout(template='plotly_dark', width=1000, height=800)\nfig.show()","fb48e529":"df.groupby('accident date').size().mean()","c7fb6601":"weekwise = df.copy()\n\ndef week_of_month(tgtdate):\n\n    days_this_month = calendar.mdays[tgtdate.month]\n    for i in range(1, days_this_month):\n        d = datetime.datetime(tgtdate.year, tgtdate.month, i)\n        if d.day - d.weekday() > 0:\n            startdate = d\n            break\n    # now we canuse the modulo 7 appraoch\n    return (tgtdate - startdate).days \/\/7 + 1\n\nweekwise['weekofmonth'] = weekwise['accident date'].apply(lambda d: (d.day-1) \/\/ 7 + 1)\nweekwise['weekofyear'] = weekwise['accident date'].dt.weekofyear\nweekwise['month'] = weekwise['accident date'].dt.month\nweekwise['year'] = weekwise['accident date'].dt.year","c60c0cc5":"weekwise_month = weekwise.groupby('weekofmonth')[[i for i in weekwise.columns if 'number' in i]].sum()\n\nfig,ax = plt.subplots(1,2,figsize=(14,5))\nplt.suptitle('COUNTPLOT OF INJURED AND KILLED BY WEEK OF MONTH', x=0.5, y=1.02, fontsize=20)\nax[0].set_title('INJURED', fontsize=14)\nax[1].set_title('KILLED', fontsize=14)\n\n\nsns.barplot(x=weekwise_month['number of persons injured'].index ,y=weekwise_month['number of persons injured'], ax=ax[0], palette='tab20b')\nsns.barplot(x=weekwise_month['number of persons killed'].index ,y=weekwise_month['number of persons killed'], ax=ax[1], palette='magma')","92ce172f":"weekwise_year = weekwise.groupby('weekofyear')[[i for i in weekwise.columns if 'number' in i]].sum()\n\nfig,ax = plt.subplots(1,2,figsize=(14,5))\nax[1].set_xticklabels(labels=accidents_bor_df.index,rotation=90)\nax[0].set_xticklabels(labels=accidents_bor_df.index,rotation=90)\n\nplt.suptitle('COUNTPLOT OF INJURED AND KILLED BY WEEK OF MONTH', x=0.5, y=1.02, fontsize=20)\nax[0].set_title('INJURED', fontsize=14)\nax[1].set_title('KILLED', fontsize=14)\n\n\nsns.barplot(x=weekwise_year['number of persons injured'].index ,y=weekwise_year['number of persons injured'], ax=ax[0], palette='tab20b')\nsns.barplot(x=weekwise_year['number of persons killed'].index ,y=weekwise_year['number of persons killed'], ax=ax[1], palette='magma')","d31030da":"by_month = weekwise.groupby('month')[[i for i in weekwise.columns if 'number' in i]].sum()\n\nfig,ax = plt.subplots(1,2,figsize=(14,5))\nplt.suptitle('COUNTPLOT OF INJURED AND KILLED BY MONTH', x=0.5, y=1.02, fontsize=20)\nax[0].set_title('INJURED', fontsize=14)\nax[1].set_title('KILLED', fontsize=14)\n\n\nsns.barplot(x=by_month['number of persons injured'].index ,y=by_month['number of persons injured'], ax=ax[0], palette='tab20')\nsns.barplot(x=by_month['number of persons killed'].index ,y=by_month['number of persons killed'], ax=ax[1], palette='viridis')","e782bafb":"by_year = weekwise.groupby('year')[[i for i in weekwise.columns if 'number' in i]].sum()\n\nfig,ax = plt.subplots(1,2,figsize=(14,5))\nplt.suptitle('COUNTPLOT OF INJURED AND KILLED BY YEAR', x=0.5, y=1.02, fontsize=20)\nax[0].set_title('INJURED', fontsize=14)\nax[1].set_title('KILLED', fontsize=14)\n\n\nsns.barplot(x=by_year['number of persons injured'].index ,y=by_year['number of persons injured'], ax=ax[0], palette='spring')\nsns.barplot(x=by_year['number of persons killed'].index ,y=by_year['number of persons killed'], ax=ax[1], palette='coolwarm')","06a1ed86":"per_day_val = round(df.shape[0]\/df.groupby('accident date')['number of persons injured'].count().shape[0],2)\nper_week_val = round(per_day_val * 7, 2)\nper_month_val = round(per_day_val * 30, 2)\nper_year_val = per_month_val * 12\nper_hour_val = (per_day_val \/ 24)\nper_5mins_val = (per_day_val \/ 24) \/60  * 5\n\nindex = ['5mins', 'Hour', 'Day', 'Week', 'Month', 'Year']\ndata = [per_5mins_val, per_hour_val, per_day_val, per_week_val, per_month_val, per_year_val]\npd.DataFrame(index=index, data=data, columns=['Value']).T","cfa8ce07":"gr_injured = df[[i for i in df.columns for c in ['pedestrians injured', 'cyclist injured', 'motorist injured'] if c in i]].sum()\ngr_killed = df[[i for i in df.columns for c in ['pedestrians killed', 'cyclist killed', 'motorist killed'] if c in i]].sum()\ngr_injured.index = ['Pedestrian', 'Cyclist', 'Motorist']\ngr_killed.index = ['Pedestrian', 'Cyclist', 'Motorist']\n\n\nfig, ax = plt.subplots(1,2,figsize=(14,5))\nplt.suptitle('COUNTPLOT OF KILLED AND INJURED PER ACCIDENT TYPE', fontsize=20, x=0.5,y=1.02)\nax[0].set_title('INJURED', fontsize=14)\nax[1].set_title('KILLED', fontsize=14)\n\nsns.barplot(gr_injured.index, gr_injured.values, ax=ax[0], palette='Greens')\nsns.barplot(gr_killed.index, gr_killed.values, ax=ax[1], palette='Reds')\n\n\n","2b50fe60":"fig = make_subplots(rows=3,cols=1,\n                    subplot_titles=('PEDESTRIAN', 'CYCLIST', 'MOTORIST'))\n\nfeat_in  = ['number of pedestrians injured',\n         'number of cyclist injured',\n         'number of motorist injured']\n\nfeat_killed = ['number of pedestrians killed', \n         'number of cyclist killed', \n         'number of motorist killed']\n\nfor i, atype in enumerate(feat_in):\n    data_per_acc = df.groupby('accident date')[atype].sum()\n    data_per_acc1 = df.groupby('accident date')[feat_killed[i]].sum()\n    \n    fig.add_trace(go.Scatter(x=data_per_acc.index, y=data_per_acc.values, name='Injured'), row=i+1,col=1)\n    fig.add_trace(go.Scatter(x=data_per_acc1.index, y=data_per_acc1.values, name='Killed'), row=i+1, col=1)\n\nfig.update_layout(title='NUMBER OF KILLED AND INJURED PER ACCIDENT TYPE',template='plotly_dark', width=1000, height=1100)\nfig.show()","e13605b5":"contri_df = df.groupby('contributing factor vehicle 1').size().sort_values(ascending=False)\n\nplt.figure(figsize=(10,15))\nplt.title('CF VEHICLE 1', fontsize=20)\n\nsns.barplot(y = contri_df.index, x = contri_df.values)","755bc2c1":"contri_df = df.groupby('contributing factor vehicle 2').size().sort_values(ascending=False)\n\nplt.figure(figsize=(10,15))\nplt.title('CF VEHICLE 2', fontsize=20)\n\nsns.barplot(y = contri_df.index, x = contri_df.values)","c7200e64":"#### AVERAGE OF ROAD ACCIDENT IN A DAY","059c8216":"## OVERVIEW\n---\n* Road Accident analysis per Borough\n* Datewise Analysis\n* Bivariate and Univariate Analysis\n* Per Road Accident type analysis\n* Causes of Road Accident in New York City","3022306c":"### BY YEAR","9763ca71":"1. #### SNIPPET OF NUMBER OF ACCIDENTS (LAST 365 DAYS)","3bd7fc92":"### INSIGHTS\n---\n* As we can see from the plot above, the highest number of people killed per day on a car accident is 8, which was October october 2017, a terror attack that also injured 11 people.\n* There are approximately 597 road accident in a day.","65b263c1":"#### WEEK OF YEAR","15ba7770":"### BY MONTH","dbb6a0a1":"## EDA\n---","f5e94fbd":"### INSIGHTS\n---\n* According to data above, There are approximately:\n    * 217800 Road Accidents per year\n    * 19,000 Road Accidents per month\n    * 4177 Road Accidents per week\n    * 597 Road Accidents per day\n    * 25 Road Accidents per hour\n    * 2 Road Accidents per 5 minutes","bc316b84":"## CAUSES OF THE ROAD ACCIDENTS IN NEW YORK CITY\n---","8777f1e1":"### DATEWISE ANALYSIS","0e2dd2db":"#### CHECK NULL VALUES","35671552":"#### WEEK OF MONTH","aa62c6f7":"#### ROAD ACCIDENTS PER DAY","ced2f4d6":"## PER ROAD ACCIDENT TYPE ANALYSIS\n---","7b68e0c6":"### INSIGHTS\n---\n* From the information above, There is a 25% chance that you will get injured if you get into an road accident.\n* Probability of getting killed on an accident is low.","961777a2":"### ANALYSIS BY BOROUGH","eeb89976":"### INSIGHTS\n---\n* ROAD ACCIDENTS ARE MORE FREQUENT IN BROOKLYN, MANHATTAN AND QUEENS\n* STATEN ISLAND HAS THE LOWEST ACCIDENT RATE","72f809a7":"* TO BE CONTINUED"}}