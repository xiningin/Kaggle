{"cell_type":{"f540641c":"code","9f97a640":"code","50ed370b":"code","ebe028df":"code","e624428f":"code","f33ad590":"code","ec27d0db":"code","77ffb315":"code","26309e4d":"code","8f28ad37":"code","67094bb8":"code","cedb7867":"code","68118f8a":"code","fb843dc8":"code","002a2cac":"code","1fd86675":"code","30341f05":"code","546d3535":"code","dc173e87":"code","c54d5791":"code","5d5f64e2":"code","2502e931":"code","a8e22311":"code","cc34fe5b":"code","3308e219":"code","1eab888a":"code","61f63273":"code","405aabad":"code","9c37f7eb":"code","6b65bc69":"code","4be713a5":"markdown","77ec2bec":"markdown","2c60095e":"markdown","63fdf2c5":"markdown","0db8471b":"markdown","30fa2203":"markdown","2c3e0949":"markdown","96794662":"markdown","06d900fc":"markdown","dde80b37":"markdown","834259d4":"markdown","2f3dff9e":"markdown","14c7cf6f":"markdown","9bc1ae2c":"markdown","78f094a6":"markdown","88c52b00":"markdown","969b0839":"markdown","d92edde0":"markdown","8bb1ddd6":"markdown","36b8964d":"markdown","b83d48aa":"markdown","5bfa6d8d":"markdown","356b33c6":"markdown","505f2b75":"markdown","c603d886":"markdown","3b05e8d5":"markdown","3daa9d87":"markdown","63b2ae26":"markdown","f68eb3b5":"markdown","b008a668":"markdown","02173877":"markdown","97602b82":"markdown","9407a60a":"markdown","22ccad88":"markdown","fd876fd1":"markdown","a68a1b1e":"markdown","baea44ae":"markdown","75b7189c":"markdown"},"source":{"f540641c":"# Import all required modules\nimport pandas as pd\nimport numpy as np\n\n# Disable warnings\nimport warnings\nwarnings.filterwarnings(\"ignore\")\n\n# Import plotting modules\nimport seaborn as sns\nsns.set()\nimport matplotlib\nimport matplotlib.pyplot as plt\nimport matplotlib.ticker\n%matplotlib inline","9f97a640":"# Tune the visual settings for figures in `seaborn`\nsns.set_context(\n    \"notebook\", \n    font_scale=1.5,       \n    rc={ \n        \"figure.figsize\": (11, 8), \n        \"axes.titlesize\": 18 \n    }\n)\n\nfrom matplotlib import rcParams\nrcParams['figure.figsize'] = 11, 8","50ed370b":"df = pd.read_csv('..\/input\/mlbootcamp5_train.csv')\nprint('Dataset size: ', df.shape)\ndf.head()","ebe028df":"df_uniques = pd.melt(frame=df, value_vars=['gender','cholesterol', \n                                           'gluc', 'smoke', 'alco', \n                                           'active', 'cardio'])\ndf_uniques = pd.DataFrame(df_uniques.groupby(['variable', \n                                              'value'])['value'].count()) \\\n    .sort_index(level=[0, 1]) \\\n    .rename(columns={'value': 'count'}) \\\n    .reset_index()\n\nsns.factorplot(x='variable', y='count', hue='value', \n               data=df_uniques, kind='bar', size=12);","e624428f":"df_uniques = pd.melt(frame=df, value_vars=['gender','cholesterol', \n                                           'gluc', 'smoke', 'alco', \n                                           'active'], \n                     id_vars=['cardio'])\ndf_uniques = pd.DataFrame(df_uniques.groupby(['variable', 'value', \n                                              'cardio'])['value'].count()) \\\n    .sort_index(level=[0, 1]) \\\n    .rename(columns={'value': 'count'}) \\\n    .reset_index()\n\nsns.factorplot(x='variable', y='count', hue='value', \n               col='cardio', data=df_uniques, kind='bar', size=9);","f33ad590":"for c in df.columns:\n    n = df[c].nunique()\n    print(c)\n    if n <= 3:\n        print(n, sorted(df[c].value_counts().to_dict().items()))\n    else:\n        print(n)\n    print(10 * '-')","ec27d0db":"df.groupby(['gender'])['height'].mean()","77ffb315":"df['gender'].value_counts()","26309e4d":"df.groupby(['gender'])['alco'].mean()","8f28ad37":"women_smoke_per = len(df[(df['gender']== 1) & (df['smoke']==1)])\/len(df[df['gender']== 1])*100\nmen_smoke_per = len(df[(df['gender']== 2) & (df['smoke']==1)])\/len(df[df['gender']== 2])*100\nprint(women_smoke_per)\nprint(men_smoke_per)\ndiff = men_smoke_per- women_smoke_per\nprint('The difference between the percentages of smokers among men and women', round(diff))","67094bb8":"smokers_median = df[df['smoke']==1].groupby(['smoke'])['age'].agg(np.median)\nx= smokers_median[1]\/30","cedb7867":"non_smokers_median = df[df['smoke']==0].groupby(['smoke'])['age'].agg(np.median)\ny = non_smokers_median[0]\/30","68118f8a":"diff1 = x-y\nprint('Difference between median values of age for smokers and non-smokers', abs(round(diff1)))","fb843dc8":"df['chol1'] = df['cholesterol'].map({1: 4, 2: 6, 3: 4})","002a2cac":"df['age_years'] = (df['age']\/365).astype('int')","1fd86675":"smoking_old_men = df[(df['gender'] == 2) & (df['smoke'] ==1) & (df['age_years']>= 60) & (df['age_years']<65)]\nsmoking_old_men.head()","30341f05":"p = round(smoking_old_men[(smoking_old_men['cholesterol'] == 1) &\n               (smoking_old_men['ap_hi'] < 120)]['cardio'].mean(), 2)\nprint(p)","546d3535":"q = round(smoking_old_men[(smoking_old_men['cholesterol'] == 3) &\n               (smoking_old_men['ap_hi'] >= 160) &\n               (smoking_old_men['ap_hi'] < 180)]['cardio'].mean(), 2)\nprint(q)","dc173e87":"print(q\/p)","c54d5791":"df.columns","5d5f64e2":"df['bmi'] = round(df['weight']\/ ((df['height']\/100)**2), 2)","2502e931":"df.head()","a8e22311":"df['bmi'].median()","cc34fe5b":"df.groupby(['gender'])['bmi'].mean()","3308e219":"sns.heatmap(df.corr())\n","1eab888a":"corr =df.corr()\ncorr['gender'].sort_values(ascending = False)","61f63273":"df.columns","405aabad":"df_melt = pd.melt(frame=df, value_vars = ['height'],id_vars=['gender'])\nsns.violinplot(\nx='variable',\ny='value',\nhue='gender',\ndata=df_melt,\nscale='count',split=True)","9c37f7eb":"fig, axes = plt.subplots(figsize = (12,10))\ncorr1 = df[['height', 'weight', 'age', 'cholesterol', 'gluc', 'cardio', 'ap_hi', 'ap_lo', 'smoke', 'alco']].corr(method =\"spearman\")\nsns.heatmap(corr1, annot=True)","6b65bc69":"sns.set(style=\"white\", context=\"talk\")\nsns.countplot(x='age_years', hue='cardio', data = df)","4be713a5":"**Question 2.4. (1 point).** What is the smallest age at which the number of people with CVD outnumber the number of people without CVD?\n\n1. 44\n2. 55\n3. 64\n4. 70","77ec2bec":"## 2.2. Height distribution of men and women\n\nFrom our exploration of the unique values earlier, we know that the gender is encoded by the values *1* and *2*. Although you do not know the mapping of these values to gender, you can figure that out graphically by looking at the mean values of height and weight for each value of the *gender* feature.\n\n### Task:\n\nCreate a violin plot for the height and gender using [`violinplot()`](https:\/\/seaborn.pydata.org\/generated\/seaborn.violinplot.html). Use the parameters:\n- `hue` to split by gender;\n- `scale` to evaluate the number of records for each gender.\n\nIn order for the plot to render correctly, you need to convert your `DataFrame` to *long* format using the `melt()` function from `pandas`. Here is [an example](https:\/\/stackoverflow.com\/a\/41575149\/3338479) of this for your reference.","2c60095e":"If, however, cholesterol level in this age group is 3, and systolic pressure is from 160 to 180, then the proportion of people with a CVD is 93%.\nAs a result, the difference is approximately 3-fold. Not 5-fold, as the SCORE scale tells us","63fdf2c5":"## 2.4. Age\n\nPreviously, we calculated the age of the respondents in years at the moment of examination.","0db8471b":"It would be instructive to peek into the values of our variables.\n \nLet's convert the data into *long* format and depict the value counts of the categorical features using [`factorplot()`](https:\/\/seaborn.pydata.org\/generated\/seaborn.factorplot.html).","30fa2203":"**Question 1.1. (1 point). How many men and women are present in this dataset? Values of the `gender` feature were not given (whether \"1\" stands for women or for men) \u2013 figure this out by looking analyzing height, making the assumption that men are taller on average. **\n1. 45530 women and 24470 men\n2. 45530 men and 24470 women\n3. 45470 women and 24530 men\n4. 45470 men and 24530 women","2c3e0949":"** Question 2.1. (1 point).** Which pair of features has the strongest Pearson's correlation with the *gender* feature?\n\n1. Cardio, Cholesterol\n2. Height, Smoke\n3. Smoke, Alco\n4. Height, Weight","96794662":"**Question 1.6. (2 points). Choose the correct statements:**\n\n1. Median BMI in the sample is within the range of normal BMI values.\n2. The BMI for women is on average higher than for men.\n3. Healthy people have, on average, a higher BMI than the people with CVD.\n4. For healthy, non-drinking men, BMI is closer to the norm than for healthy, non-drinking women","06d900fc":"If cholesterol level in this age group is 1, and systolic pressure is below 120, then the proportion of people with CVD is 28%","dde80b37":"On the website for the European Society of Cardiology, a [SCORE scale](https:\/\/www.escardio.org\/Education\/Practice-Tools\/CVD-prevention-toolbox\/SCORE-Risk-Charts) is provided. It is used for calculating the risk of death from a cardiovascular decease in the next 10 years. Here it is:\n<img src=https:\/\/habrastorage.org\/webt\/ik\/gx\/hr\/ikgxhr3w1vzqihgitgrbdorfb14.png width=30%>\n\nLet's take a look at the upper-right rectangle, which shows a subset of smoking men aged from 60 to 65. (It's not obvious, but the values in the figure represent the upper bound).\n\nWe see the value 9 in the lower-left corner of the rectangle and 47 in the upper-right. This means that, for people in this gender-age group whose systolic pressure is less than 120, the risk of a CVD is estimated to be 5 times lower than for those with the pressure in the interval [160,180).\n\nLet's calculate that same ratio using our data.\n\nClarifications:\n- Calculate ``age_years`` feature \u2013 round age to the nearest number of years. For this task, select only the people of age 60 to 64, inclusive.\n- Cholesterol level categories differ between the figure and our dataset. The conversion for the ``cholesterol`` feature is as follows: 4 mmol\/l $\\rightarrow$ 1, 5-7 mmol\/l $\\rightarrow$ 2, 8 mmol\/l $\\rightarrow$ 3.","834259d4":"Smallest age at which the number of people with CVD outnumber the number of people without CVD = 55","2f3dff9e":"**Question 1.4. (1 point). What is the difference between median values of age for smokers and non-smokers (in months, rounded)? You'll need to figure out the units of feature `age` in this dataset.**\n\n1. 5\n2. 10\n3. 15\n4. 20","14c7cf6f":"**Question 2.2. (1 point).** Which pair of features has the strongest Spearman correlation?\n\n1. Height, Weight\n2. Age, Weight\n3. Cholesterol, Gluc\n4. Cardio, Cholesterol\n5. Ap_hi, Ap_lo\n6. Smoke, Alco","9bc1ae2c":"**Question 2.3. (1 point).** Why do these features have strong rank correlation?\n\n1. Inaccuracies in the data (data acquisition errors).\n2. Relation is wrong, these features should not be related.\n3. Nature of the data.","78f094a6":"**Question 1.5. (2 points). Calculate the fraction of the people with CVD for the two segments described above. What is the ratio of these two fractions?**\n\n1. 1\n2. 2\n3. 3\n4. 4","88c52b00":"In the end, we have:\n- 5 numerical features (excluding *id*);\n- 7 categorical features;\n- 70000 records in total.","969b0839":"## 1.1. Basic observations","d92edde0":"### Task:\n\nCreate a *count plot* using [`countplot()`](http:\/\/seaborn.pydata.org\/generated\/seaborn.countplot.html) with the age on the *X* axis and the number of people on the *Y* axis. Your resulting plot should have two columns for each age, corresponding to the number of people for each *cardio* class of that age.","8bb1ddd6":"You will use the `seaborn` library for visual analysis, so let's set that up too:","36b8964d":"## 1.3. Analyzing BMI\n### Task:","b83d48aa":"Corr(height, weight) = 0.31\n\nCorr(Age, Weight) = 0.062\n\nCorr(Cholesterol, Gluc) = 0.41\n\nCorr(Cardio, Cholesterol) = 0.22\n\nCorr(Ap_hi, Ap_lo) = 0.74\n\nCorr(Smoke, Alco) = 0.34\n\nIt seems that Ap_hi, Ap_lo features has the strongest Spearman correlation\n","5bfa6d8d":"# Part 2. Visual data analysis\n\n## 2.1. Correlation matrix visualization\n\nTo understand the features better, you can create a matrix of the correlation coefficients between the features. Use the initial dataset (non-filtered).\n\n### Task:\n\nPlot a correlation matrix using [`heatmap()`](http:\/\/seaborn.pydata.org\/generated\/seaborn.heatmap.html). You can create the matrix using the standard `pandas` tools with the default parameters.","356b33c6":"Median BMI in the sample is not within the range of normal BMI values i.e.18.5 to 25","505f2b75":"'The BMI for women is on average higher than for men' statement stands true","c603d886":"Let's get to know our data by performing a preliminary data analysis.\n\n#  Part 1. Preliminary data analysis\n\nFirst, we will initialize the environment:","3b05e8d5":"## 1.2. Risk maps\n### Task:","3daa9d87":"In this assignment, you will answer questions about a dataset on cardiovascular disease. You do not need to download the data: it is already in the repository. There are some Tasks that will require you to write code. Complete them and then answer the questions in the [form](https:\/\/docs.google.com\/forms\/d\/13cE_tSIb6hsScQvvWUJeu1MEHE5L6vnxQUbDYpXsf24). \n\n#### Problem\n\nPredict the presence or absence of cardiovascular disease (CVD) using the patient examination results.\n\n#### Data description\n\nThere are 3 types of input features:\n\n- *Objective*: factual information;\n- *Examination*: results of medical examination;\n- *Subjective*: information given by the patient.\n\n| Feature | Variable Type | Variable      | Value Type |\n|---------|--------------|---------------|------------|\n| Age | Objective Feature | age | int (days) |\n| Height | Objective Feature | height | int (cm) |\n| Weight | Objective Feature | weight | float (kg) |\n| Gender | Objective Feature | gender | categorical code |\n| Systolic blood pressure | Examination Feature | ap_hi | int |\n| Diastolic blood pressure | Examination Feature | ap_lo | int |\n| Cholesterol | Examination Feature | cholesterol | 1: normal, 2: above normal, 3: well above normal |\n| Glucose | Examination Feature | gluc | 1: normal, 2: above normal, 3: well above normal |\n| Smoking | Subjective Feature | smoke | binary |\n| Alcohol intake | Subjective Feature | alco | binary |\n| Physical activity | Subjective Feature | active | binary |\n| Presence or absence of cardiovascular disease | Target Variable | cardio | binary |\n\nAll of the dataset values were collected at the moment of medical examination.","63b2ae26":"Due to Nature of the data.","f68eb3b5":"This means gender 1 refers to female and gender 2 refers to male. Assumption here is that men are taller on average than women ","b008a668":"**Question 1.3. (1 point). What is the difference between the percentages of smokers among men and women (rounded)?**\n1. 4\n2. 16\n3. 20\n4. 24","02173877":"To make it simple, we will work only with the training part of the dataset:","97602b82":"**Question 1.2. (1 point). Which gender more often reports consuming alcohol - men or women?**\n1. women\n2. men","9407a60a":"Height & Smoke has the strongest Pearson's correlation with the gender","22ccad88":"* Create a new feature \u2013 BMI ([Body Mass Index](https:\/\/en.wikipedia.org\/wiki\/Body_mass_index)). To do this, divide weight in kilogramms by the square of the height in meters. Normal BMI values are said to be from 18.5 to 25. ","fd876fd1":"# <center>Assignment #2 (demo)\n## <center>Analyzing cardiovascular disease data ","a68a1b1e":"You can see that the distribution of cholesterol and glucose levels great differs by the value of the target variable. Is this a coincidence?\n\nNow, let's calculate some statistics for the feature unique values:","baea44ae":"<center>\n<img src=\"https:\/\/habrastorage.org\/files\/fd4\/502\/43d\/fd450243dd604b81b9713213a247aa20.jpg\">\n\n## [mlcourse.ai](https:\/\/mlcourse.ai) - Open Machine Learning Course\n    \nAuthors: [Ilya Baryshnikov](https:\/\/www.linkedin.com\/in\/baryshnikov-ilya\/), [Maxim Uvarov](https:\/\/www.linkedin.com\/in\/maxis42\/), and [Yury Kashnitsky](https:\/\/www.linkedin.com\/in\/festline\/). Translated and edited by [Inga Kaydanova](https:\/\/www.linkedin.com\/in\/inga-kaidanova-a92398b1\/), [Egor Polusmak](https:\/\/www.linkedin.com\/in\/egor-polusmak\/), [Anastasia Manokhina](https:\/\/www.linkedin.com\/in\/anastasiamanokhina\/), and [Yuanyuan Pao](https:\/\/www.linkedin.com\/in\/yuanyuanpao\/). All content is distributed under the [Creative Commons CC BY-NC-SA 4.0](https:\/\/creativecommons.org\/licenses\/by-nc-sa\/4.0\/) license.","75b7189c":"We can see that the target classes are balanced. That's great!\n\nLet's split the dataset by target values. Can you already spot the most significant feature by just looking at the plot?"}}