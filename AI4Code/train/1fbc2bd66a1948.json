{"cell_type":{"cb2a1ece":"code","23f7bd25":"code","e54ec786":"code","dd556624":"code","866b2db1":"code","b2ce0481":"code","f5e5dd68":"code","5bfadc9b":"code","72d43595":"code","4ff96daa":"code","212d5eb0":"code","84f2e503":"code","befdb091":"code","ff823dca":"code","1a88f3e8":"code","260bb26e":"code","9c7b757b":"code","9dd7ac15":"code","5a796680":"code","2416f108":"code","1b96758a":"code","9303ba99":"code","59a82f20":"code","9d563c37":"code","a7f1a18c":"code","b80fc18b":"code","93dd0ad4":"code","196c83e8":"code","0db9b7d9":"code","280dd8f3":"code","e3f0be1b":"code","2b291f7b":"code","785152f8":"code","821a4e81":"markdown"},"source":{"cb2a1ece":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","23f7bd25":"import pandas as pd\nimport numpy as np\nimport seaborn as sns","e54ec786":"df=pd.read_csv('..\/input\/churn-modelling\/Churn_Modelling.csv')\ndf.head()","dd556624":"df.info()","866b2db1":"df.describe()","b2ce0481":"df.head()","f5e5dd68":"sns.countplot(df['Exited'])","5bfadc9b":"sns.heatmap(df.isnull())","72d43595":"sns.countplot(df['Gender'])","4ff96daa":"sns.countplot(df['Geography'])","212d5eb0":"df.columns","84f2e503":"df=df.drop(['RowNumber','CustomerId','Surname'],axis=1)\n","befdb091":"df.head()\n","ff823dca":"df=pd.get_dummies(df,columns=(['Geography','Gender']))","1a88f3e8":"X=df.drop('Exited',axis=1)\ny=df['Exited']","260bb26e":"from sklearn.model_selection import train_test_split","9c7b757b":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)","9dd7ac15":"from sklearn.preprocessing import MinMaxScaler\nfrom sklearn.metrics import classification_report","5a796680":"scaler=MinMaxScaler()","2416f108":"X_train=scaler.fit_transform(X_train)\nX_test=scaler.transform(X_test)","1b96758a":"X_train.shape","9303ba99":"from sklearn.tree import DecisionTreeClassifier","59a82f20":"model_tree=DecisionTreeClassifier()\nmodel_tree.fit(X_train,y_train)\ny_pred_tr=model_tree.predict(X_train)\nprint(classification_report(y_train,y_pred_tr))","9d563c37":"y_pred=model_tree.predict(X_test)\nprint(classification_report(y_test,y_pred))","a7f1a18c":"from sklearn.ensemble import RandomForestClassifier","b80fc18b":"model_ran=RandomForestClassifier(n_estimators=10)","93dd0ad4":"model_ran.fit(X_train,y_train)\ny_pred_tr=model_ran.predict(X_train)\nprint(classification_report(y_train,y_pred_tr))","196c83e8":"y_pred=model_ran.predict(X_test)\nprint(classification_report(y_test,y_pred))","0db9b7d9":"from tensorflow.keras import Sequential\nfrom tensorflow.keras.layers import Dense,Dropout\nfrom tensorflow.keras.optimizers import Adam\nfrom tensorflow.keras.callbacks import EarlyStopping","280dd8f3":"model=Sequential()\nmodel.add(Dense(13,activation='tanh'))\nmodel.add(Dense(6,activation='tanh'))\nmodel.add(Dense(3,activation='tanh'))\nmodel.add(Dense(2,activation='tanh'))\nmodel.add(Dense(1,activation='sigmoid'))\nmodel.compile(loss='binary_crossentropy',optimizer='Adam')","e3f0be1b":"early=EarlyStopping(patience=20,monitor='loss')","2b291f7b":"model.fit(X_train,y_train,epochs=200,callbacks=[early])","785152f8":"y_pred_tr=model.predict_classes(X_train)\nprint(classification_report(y_train,y_pred_tr))","821a4e81":"So we may face the problem of imbalance dataset."}}