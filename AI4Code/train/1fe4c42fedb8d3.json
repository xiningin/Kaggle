{"cell_type":{"09a3e695":"code","ce04be5a":"code","fa97597e":"code","c0a48b1e":"code","9c749ef6":"code","e30853e7":"code","83d35ac5":"code","adb4cf82":"code","8630bbff":"code","4165e58d":"code","79c50a12":"code","65550321":"code","2171e60f":"code","aba0a851":"code","26fcb179":"code","0c2911ff":"code","86a8b9ee":"code","4f4c64e6":"code","dda8316e":"code","a2b415ca":"code","bed54773":"markdown","90ff6085":"markdown","41ef9bf7":"markdown","a6418f17":"markdown","ee6ee674":"markdown","eea41a3e":"markdown","7cc189c7":"markdown","d4b3a81a":"markdown","08796d42":"markdown","dc64f94a":"markdown","a20131f0":"markdown","4f8a63bc":"markdown","6ae98c9d":"markdown","6d9c20dc":"markdown","4a0a2ce4":"markdown","bb555923":"markdown"},"source":{"09a3e695":"#Importing Libraries\n\n\n#Graphic Libraries\nimport seaborn as sns\nimport plotly.graph_objects as go\n\n#Statistical Inference Analyis\nimport statsmodels.api as sm\nimport scipy.stats as stats\n\n#Loading Dataset\nimport numpy as np \nimport pandas as pd\n\n#Data Processing\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.preprocessing import OrdinalEncoder\nfrom sklearn.model_selection import cross_val_predict\nfrom sklearn.model_selection import cross_val_score\n\n#Feature Selection\nfrom sklearn.model_selection import train_test_split\n\n#Model\nfrom sklearn.svm import SVC\n\n\n#Validation \nfrom sklearn.metrics import f1_score\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\nimport warnings\nwarnings.filterwarnings(action='ignore')","ce04be5a":"df = pd.read_csv('..\/input\/drug-classification\/drug200.csv')\nprint(df.shape)\ndf.head()","fa97597e":"labels = df['Drug'].unique()\nvalues = df['Drug'].value_counts()\n\n\nfig = go.Figure(data=[go.Pie(labels=labels, values=values, hole=.5)])\nfig.show()","c0a48b1e":"df.head()","9c749ef6":"df.isnull().sum()","e30853e7":"for col in df.select_dtypes('O').columns:\n    print('We have {} unique values in {} column : {}'.format(len(df[col].unique()),col,df[col].unique()))\n    print('__'*30)\n","83d35ac5":"df['Drug'].value_counts(normalize=True).plot.bar(color=['green','blue','purple','red'],edgecolor='black',title='target variable')","adb4cf82":"df['Sex'].value_counts(normalize=True).plot.bar(color=['cyan','magenta'],edgecolor='black',title='sex variable')","8630bbff":"df['Cholesterol'].value_counts(normalize=True).plot.bar(color=['orange','yellow'],edgecolor='black',title='Cholestrol variable')","4165e58d":"df['BP'].value_counts(normalize=True).plot.bar(color=['orange','yellow','brown'],edgecolor='black',title='Blood Pressure variable')","79c50a12":"bp = ['HIGH','LOW','NORMAL']\ncholestrol = ['HIGH','NORMAL']\nsex = ['M','F']\nordi = OrdinalEncoder(categories=[bp,cholestrol,sex])\nDF = pd.DataFrame(ordi.fit_transform(df[['BP','Cholesterol','Sex']]),columns = ['BP_','Cholesterol_','Sex_'])","65550321":"df = pd.concat([df,DF],axis = 1)\ndf.drop(['Sex','BP','Cholesterol'],axis = 1,inplace = True)","2171e60f":"LE = LabelEncoder()\ndf['Drug_']=LE.fit_transform(df['Drug'])\ndf.drop('Drug',axis = 1,inplace = True)","aba0a851":"df.head()","26fcb179":"X = df.drop('Drug_',axis = 1)\ny = df.Drug_","0c2911ff":"X_train, X_test, y_train, y_test = train_test_split(\n    X,y,test_size=0.3, shuffle=True)","86a8b9ee":"log_reg = sm.OLS(y,X).fit()\nprint(log_reg.summary())","4f4c64e6":"log_reg.params","dda8316e":"log_reg.rsquared","a2b415ca":"clf =SVC(kernel='linear')\nclf.fit(X_train, y_train)\nclf_SVC_score = cross_val_score(clf,X_train,y_train)\nclf_SVC_predict = cross_val_predict(clf,X_train,y_train)\nscore = f1_score(y_train,clf_SVC_predict,average = 'micro')\nprint(f\"The accuracy of the model is {np.round_(score,decimals=2,out=None)*100}\")","bed54773":"* Around 52% are Male\n* Around 48% are Female","90ff6085":"* Around 38% people have High blood pressure\n* Around 32% people have Low blood pressure\n* Around 30% people have Normal blood pressure","41ef9bf7":"Note :\nThese are thre model parameters","a6418f17":"* Around 52% people have High Cholesterol\n* Around 48% people have Normal Cholesterol","ee6ee674":"The Dataset is imbalanced as the DrugB and DrugA is in low proprotion as compared to DrugY ","eea41a3e":"# **Model Selection**","7cc189c7":"# Loading the Dataset","d4b3a81a":"* Around 12% people consume DrugA \n* Around 8% people consume DrugB\n* Around 8% people consume DrugC\n* Around 27% people consume DrugX\n* Around 45% people cosnsume DrugY\n\n","08796d42":"# Spliting the data into Training & Testing Set","dc64f94a":"# Content\n1. The target feature is\n* Drug type\n2. The feature sets are:\n* Age\n* Sex\n* Blood Pressure Levels (BP)\n* Cholesterol Levels\n* Na to Potassium Ration","a20131f0":"The OLS model is giving 68% accuracy","4f8a63bc":"# Importing Libraries","6ae98c9d":"# EDA","6d9c20dc":"# Features Conversion","4a0a2ce4":"# Statistical Inference","bb555923":" **Support Vector Machine Model**"}}