{"cell_type":{"259e1cc9":"code","a2e7247e":"code","d0c9f1e5":"code","298a19ec":"code","a1e1ceda":"code","c72748d8":"code","b40f5ef6":"code","c13a630c":"code","a047e61a":"code","44af9f5a":"code","7a2a2374":"code","25b21f18":"code","903e7efe":"code","b2d0427f":"code","eae45309":"code","c69ff489":"code","33840c57":"code","c45e4752":"code","bb43cdd8":"code","b8b5753a":"code","4917933c":"code","f83c080e":"code","76340e40":"code","3f9db200":"code","7af29d79":"code","2a7dc9e3":"code","b4529897":"markdown","b2a2e16c":"markdown"},"source":{"259e1cc9":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set_style('whitegrid')\nimport warnings\nwarnings.filterwarnings('ignore')\n\n# Allow several prints in one cell\nfrom IPython.core.interactiveshell import InteractiveShell\nInteractiveShell.ast_node_interactivity = \"all\"\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n","a2e7247e":"file = '\/kaggle\/input\/netflix-shows\/netflix_titles.csv'\ndf = pd.read_csv(file)\ndf.head()","d0c9f1e5":"df.shape\n# df.date_added.dtype\ndf.describe()","298a19ec":"t = '''show_id:Unique ID for every Movie \/ Tv Show\ntype:Identifier - A Movie or TV Show\ntitle:Title of the Movie \/ Tv Show\ndirector:Director of the Movie\ncast:Actors involved in the movie \/ show\ncountry:Country where the movie \/ show was produced\ndate_added:Date it was added on Netflix\nrelease_year:Actual Release year of the move \/ show\nrating:TV Rating of the movie \/ show\nduration:Total Duration - in minutes or number of seasons\nlisted_in:Genere\ndescription:The summary description'''\ncols = [r.split(':')[0] for r in t.split('\\n')]\ndes = [r.split(':')[1] for r in t.split('\\n')]\n\ndata_info = pd.DataFrame({'column_name': cols, 'description': des})\ndata_info","a1e1ceda":"df[\"date_added\"] = pd.to_datetime(df['date_added'])\ndf['year_added'] = df['date_added'].dt.year\ndf['month_added'] = df['date_added'].dt.month\n# df['add_year'] = df['date_added'].fillna('Null').apply(lambda x: 2020 if x == 'Null' else int(x.split(', ')[-1]))\n\ndf['seaons'] = df.apply(lambda x: int(x.duration.split()[0]) if \"Season\" in x.duration else np.nan, axis=1)\ndf['length'] = df.apply(lambda x: np.nan if \"Season\" in x.duration else int(x.duration.split()[0]), axis=1)\ndf[df['year_added'] == 2020].head()","c72748d8":"movies = df[df['type'] == 'Movie']\ntv_shows = df[df['type'] == 'TV Show']\nprint(\"there are: \\n{} movies and \\n{} TV shows in the \\n{} records\".format(movies.show_id.count().sum(), tv_shows.shape[0], len(df)))","b40f5ef6":"per_year = df.groupby(['year_added', 'type'])['show_id'].count().reset_index() #unstack().unstack()\n\nf,a = plt.subplots(1,1,figsize=(14,8))\ng = sns.barplot(x='year_added',\n            y='show_id',\n            hue='type',\n            data=per_year,\n            palette='Blues_d',\n            ax = a\n            )\na.set_ylabel('Counts')\na.set_xlabel('')\nplt.xticks(rotation='30');","c13a630c":"m_directors, tv_directors = [], []\nfor c in movies.director.fillna(\"\"):\n    m_directors.extend([ci.strip() for ci in c.split(',')])\nfor c in tv_shows.director.fillna(\"\"):\n    tv_directors.extend([ci.strip() for ci in c.split(',')])    \nm_directors = pd.Series(m_directors)\n# m_casts = m_casts[m_casts != \"\"]\ntv_directors = pd.Series(tv_directors)\nm_directors.value_counts().head()\ntv_directors.value_counts().head()","a047e61a":"f,a = plt.subplots(1,2,figsize=(18,6))\nf.subplots_adjust(wspace = .4)\nsns.barplot(m_directors.value_counts()[1:16], m_directors.value_counts()[1:16].index, ax=a[0])\na[0].set_title('The 15 most productive movie directors', fontsize=15, fontweight='bold')\na[0].set_xlabel('')\nsns.barplot(tv_directors.value_counts()[1:16], tv_directors.value_counts()[1:16].index, ax=a[1])\na[1].set_title('The 15 most productive TV show directors', fontsize=15, fontweight='bold')\na[1].set_xlabel('');","44af9f5a":"m_casts, tv_casts = [], []\nfor c in movies.cast.fillna(\"\"):\n    m_casts.extend([ci.strip() for ci in c.split(',')])\nfor c in tv_shows.cast.fillna(\"\"):\n    tv_casts.extend([ci.strip() for ci in c.split(',')])    \nm_casts = pd.Series(m_casts)\n# m_casts = m_casts[m_casts != \"\"]\ntv_casts = pd.Series(tv_casts)\nm_casts.value_counts().head()\ntv_casts.value_counts().head()","7a2a2374":"f,a = plt.subplots(1,2,figsize=(18,6))\nf.subplots_adjust(wspace = .4)\nsns.barplot(m_casts.value_counts()[1:16], m_casts.value_counts()[1:16].index, ax=a[0])\na[0].set_title('The 15 most popular movie stars', fontsize=15, fontweight='bold')\na[0].set_xlabel('')\nsns.barplot(tv_casts.value_counts()[1:16], tv_casts.value_counts()[1:16].index, ax=a[1])\na[1].set_title('The 15 most popular TV show stars', fontsize=15, fontweight='bold')\na[1].set_xlabel('');","25b21f18":"people = set(m_directors.value_counts()[1:16].index.tolist() +\n             tv_directors.value_counts()[1:16].index.tolist() + \n             m_casts.value_counts()[1:16].index.tolist() + \n             tv_casts.value_counts()[1:16].index.tolist()\n            )\nprint(people)","903e7efe":"networks,works = {}, {}\n\nfor i,r in df.fillna('').iterrows():\n    group = [p.strip() for p in r['director'].split(',') if p != '']\n    group.extend([p.strip() for p in r['cast'].split(',') if p != ''])\n#     print(group)\n    for p in group:\n        if len(p) != 0 and p in people:\n            c = networks.get(p, set())\n            networks[p] = c.union(set(group))\n            works[p] = works.get(p, 0) + 1\n        \n#     break\nfor p in networks:\n    networks[p] = len(networks.get(p)) - 1\n# pd.concat([pd.Series(networks), pd.Series(works)], axis = 1)\nnetwork_vs_work = pd.DataFrame({'network_size':pd.Series(networks), 'works':pd.Series(works)})","b2d0427f":"ax = sns.regplot(x='network_size', y='works', data=network_vs_work, \n           fit_reg=False,y_jitter=0, scatter_kws={'alpha':0.2});\n#            size = 6, aspect =2);\nfor i, r in network_vs_work.iterrows():\n    ax.text(r.network_size+0.2, r.works, i)\nax.figure.set_size_inches(18, 10);","eae45309":"network_vs_work = network_vs_work.reset_index().rename(columns={'index': 'person'})","c69ff489":"network_vs_work['movie_or_tv'] = network_vs_work.apply(lambda x: 'Movie' if x['person'] in set(m_directors.value_counts()[1:16].index.tolist() + \n              m_casts.value_counts()[1:16].index.tolist()) else 'TV', axis=1)\nnetwork_vs_work.sample(6)","33840c57":"network_vs_work['dir_or_star'] = network_vs_work.apply(lambda x: 'Director' if x['person'] in set(m_directors.value_counts()[1:16].index.tolist() + \n              tv_directors.value_counts()[1:16].index.tolist()) else 'Star', axis=1)\nnetwork_vs_work.sample(6)","c45e4752":"ax = sns.scatterplot(x='network_size', y='works', hue='movie_or_tv', data=network_vs_work);\n#            size = 6, aspect =2);\nfor i, r in network_vs_work.iterrows():\n    ax.text(r.network_size+0.2, r.works, r.person)\nax.figure.set_size_inches(18, 10);","bb43cdd8":"ax = sns.scatterplot(x='network_size', y='works', hue='dir_or_star', data=network_vs_work);\n#            size = 6, aspect =2);\nfor i, r in network_vs_work.iterrows():\n    ax.text(r.network_size+0.2, r.works, r.person)\nax.figure.set_size_inches(18, 10);","b8b5753a":"df[df['cast'].fillna('').str.contains('David Attenborough')].sort_values(by='year_added')","4917933c":"movies.country.nunique()\nmovies.country.value_counts().sum()\nmovies.country.value_counts()[:20].sum()\nmovies.country.value_counts()[:20].sum() \/ movies.country.value_counts().sum() * 100\n\nmovies.country.value_counts().head(20)","f83c080e":"f,a = plt.subplots(1,2,figsize=(18,6))\nf.subplots_adjust(wspace = .4)\nsns.barplot(movies.country.value_counts().head(20), movies.country.value_counts().head(20).index, ax=a[0])\na[0].set_title('The 20 most productive (Movies) countries', fontsize=15, fontweight='bold')\na[0].set_xlabel('')\nsns.barplot(tv_shows.country.value_counts().head(20), tv_shows.country.value_counts().head(20).index, ax=a[1])\na[1].set_title('The 20 most productive (TV Shows) countries', fontsize=15, fontweight='bold')\na[1].set_xlabel('');","76340e40":"f,a = plt.subplots(1,1,figsize=(18,6))\n# f.subplots_adjust(wspace = .4)\nsns.barplot(df.rating.value_counts().index, df.rating.value_counts(), ax=a)\na.set_title('Works per category', fontsize=15, fontweight='bold')\na.set_ylabel('Counts')\na.set_xlabel('Rating');","3f9db200":"# source: https:\/\/www.kaggle.com\/vikassingh1996\/netflix-movies-and-shows-plotly-recommender-sys\nfrom wordcloud import WordCloud, STOPWORDS, ImageColorGenerator\nplt.rcParams['figure.figsize'] = (13, 13)\nwordcloud = WordCloud(stopwords=STOPWORDS,background_color = 'black', width = 1000,  height = 1000, max_words = 121).generate(' '.join(df['title']))\nplt.imshow(wordcloud)\nplt.axis('off')\nplt.title('Most Popular Words in Title',fontsize = 30)\nplt.show();","7af29d79":"'''Plotly visualization .'''\nimport plotly.offline as py\nfrom plotly.offline import iplot, init_notebook_mode\nimport plotly.graph_objs as go\npy.init_notebook_mode(connected = True) # Required to use plotly offline in jupyter notebook\n\ndef pie_plot(cnt_srs, title):\n    labels=cnt_srs.index\n    values=cnt_srs.values\n    trace = go.Pie(labels=labels, \n                   values=values, \n                   title=title, \n                   hoverinfo='percent+value', \n                   textinfo='percent',\n                   textposition='inside',\n                   hole=0.7,\n                   showlegend=True,\n                   marker=dict(colors=plt.cm.viridis_r(np.linspace(0, 1, 14)),\n                               line=dict(color='#000000',\n                                         width=2),\n                              )\n                  )\n    return trace\n\npy.iplot([pie_plot(df['rating'].value_counts(), 'Content Type')]);","2a7dc9e3":"# source: https:\/\/www.kaggle.com\/subinium\/storytelling-with-data-netflix-ver\n\nimport plotly.express as px\nyear_country2 = df.groupby('year_added')['country'].value_counts().reset_index(name='counts')\n\nfig = px.choropleth(year_country2, locations=\"country\", color=\"counts\", \n                    locationmode='country names',\n                    animation_frame='year_added',\n                    range_color=[0,200],\n                    color_continuous_scale=px.colors.sequential.OrRd\n                   )\n\nfig.update_layout(title='Comparison by country')\nfig.show();","b4529897":"Looks like David Attenborough is a scientific documentory specialist. It is possible that he has a great network but those people are not recognized in the typical show business.","b2a2e16c":"**************\nFrom other kernels"}}