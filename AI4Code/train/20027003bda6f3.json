{"cell_type":{"6af06f0f":"code","699d0a6b":"code","8d289085":"code","2903c728":"code","de739890":"code","cbe91769":"code","28f869ae":"code","2181413e":"code","7ec32116":"code","114dd04d":"code","3f140d08":"code","94038683":"code","6abf4b2b":"code","8b73ce13":"code","06fc5d6b":"code","e8f7215f":"code","2b54e4b1":"code","3b6160c0":"code","0429f1b7":"code","87587dd8":"code","2a6f6be4":"code","9de7419c":"code","675115cf":"code","cfd58385":"code","5a62a4e2":"code","86207f75":"code","009ba7ac":"code","71d5b9a8":"code","d5cf8342":"code","074b5f11":"code","4e23f505":"code","2425286d":"code","1a1bc6af":"code","8eced45d":"code","a6f4c5f4":"code","03e19d78":"code","a0090171":"code","05989e25":"code","e230b957":"code","481c49dd":"code","ad579322":"code","d3fe0ff6":"code","53345d10":"code","c490b55a":"code","9a5066b5":"code","c419081f":"code","34801ee2":"code","36bfa908":"code","7a3e219e":"code","805692db":"code","bc9d3784":"code","7f7da614":"code","510eeee9":"code","4da26cd4":"code","92ed8501":"code","c89fd2ab":"code","3b43bece":"code","f68215c5":"code","5580336e":"code","503f762d":"markdown","5aabc18d":"markdown","bec81495":"markdown","f284d384":"markdown","0a15d198":"markdown","df99bd45":"markdown","e1026385":"markdown","4b27b711":"markdown","0be6b2bb":"markdown","a72f8241":"markdown","2a52c83a":"markdown"},"source":{"6af06f0f":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","699d0a6b":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\n#%matplotlib inline\n#%matplotlib notebook\nplt.rcParams[\"figure.figsize\"] = (10,6)\nimport warnings\nwarnings.filterwarnings(\"ignore\")\nwarnings.warn(\"this will not show\")\npd.set_option('display.float_format', lambda x: '%.3f' % x)","8d289085":"df = pd.read_csv('..\/input\/heart12\/heart (3).csv')","2903c728":"df.head()","de739890":"#!pip install pandas-profiling\nimport pandas_profiling\npandas_profiling.ProfileReport(df)\n","cbe91769":"df.info()","28f869ae":"df.describe().T","2181413e":"df.corr()","7ec32116":"plt.figure(figsize=(14,8))\nsns.heatmap(df.corr(),annot = True);","114dd04d":"df.isnull().sum()","3f140d08":"df.corr()['target'].drop('target').plot.barh()","94038683":"sns.pairplot(df)","6abf4b2b":"df.duplicated().sum()","8b73ce13":"df = df.drop_duplicates()","06fc5d6b":"df['target'].value_counts()","e8f7215f":"from sklearn.preprocessing import MinMaxScaler,StandardScaler,RobustScaler\nfrom sklearn.model_selection import train_test_split","2b54e4b1":"X = df.drop('target',axis=1)","3b6160c0":"y = df['target']","0429f1b7":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.1, random_state=101)","87587dd8":"scaler = MinMaxScaler()","2a6f6be4":"X_train_scaled = scaler.fit_transform(X_train)\nX_test_scaled = scaler.transform(X_test)","9de7419c":"from sklearn.linear_model import LogisticRegression\nfrom sklearn.model_selection import GridSearchCV","675115cf":"log_model = LogisticRegression(solver='saga',multi_class=\"ovr\",max_iter=5000)\n# elasstik net SADE \"\"\"\"\"\"saga\"\"\"\"\"\" day d\u0131. t\u00fcm penalt\u0131 deperlerini kullan\u0131abilmesi i\u00e7in \n# multi class \u00e7izimler d\u00fczg\u00fcn olsun diye ovr.\n# GR\u0130D search yapmadan ben hyper parametre girdim.\n","cfd58385":"penalty = [\"l1\", \"l2\", \"elasticnet\"]\nl1_ratio = np.linspace(0, 1, 20) # aradaki de\u011ferleri linear olarak da\u011f\u0131t\u0131yor.\nC = np.logspace(0, 10, 20)  # aradaki de\u011ferleri logaritmik olarak da\u011f\u0131t\u0131yor.\n\nparam_grid = {\"penalty\" : penalty,\n             \"l1_ratio\" : l1_ratio,\n             \"C\" : C}\n# best parametreler neler bakal\u0131m.\n","5a62a4e2":"grid_model = GridSearchCV(log_model, param_grid = param_grid)\n","86207f75":"grid_model.fit(X_train_scaled,y_train)\n","009ba7ac":"grid_model.best_params_","71d5b9a8":"y_pred = grid_model.predict(X_test_scaled)\ny_pred\n","d5cf8342":"from sklearn.metrics import accuracy_score, confusion_matrix, classification_report, plot_confusion_matrix\n","074b5f11":"print(confusion_matrix(y_test, y_pred))\nprint(classification_report(y_test, y_pred))\n","4e23f505":"from sklearn.metrics import plot_roc_curve, plot_precision_recall_curve, roc_auc_score, auc, roc_curve, average_precision_score, precision_recall_curve","2425286d":"plot_roc_curve(grid_model, X_test_scaled, y_test);","1a1bc6af":"plot_precision_recall_curve(grid_model, X_test_scaled, y_test);","8eced45d":"plot_roc_curve(grid_model, X_train_scaled, y_train);","a6f4c5f4":"from sklearn.neighbors import KNeighborsClassifier","03e19d78":"knn_grid = KNeighborsClassifier()","a0090171":"k_values= range(1,30)","05989e25":"param_grid = {\"n_neighbors\":k_values, \"p\": [1,2], \"weights\": ['uniform', \"distance\"]}\n","e230b957":"knn_grid_model = GridSearchCV(knn_grid, param_grid, cv=10, scoring= 'accuracy')\n","481c49dd":"knn_grid_model.fit(X_train_scaled, y_train)\n","ad579322":"knn_grid_model.best_params_\n","d3fe0ff6":"y_pred = knn_grid_model.predict(X_test_scaled)","53345d10":"print(confusion_matrix(y_test,y_pred))","c490b55a":"print(classification_report(y_test, y_pred))","9a5066b5":"plot_roc_curve(knn_grid_model, X_test_scaled, y_test);\n","c419081f":"plot_precision_recall_curve(knn_grid_model, X_test_scaled, y_test);","34801ee2":"from sklearn.svm import SVC","36bfa908":"svm = SVC()\nparam_grid = {'C':[0.01,0.1,1,10,1000],\n              'kernel':['linear','rbf','sigmoid','poly'],\n              'gamma':[\"scale\", \"auto\"],\n              'degree':[1,2]}\nsvm_grid = GridSearchCV(svm,param_grid)","7a3e219e":"svm_grid.fit(X_train_scaled,y_train)","805692db":"svm_grid.best_params_","bc9d3784":"y_pred = svm_grid.predict(X_test_scaled)","7f7da614":"print(confusion_matrix(y_test,y_pred))","510eeee9":"print(classification_report(y_test,y_pred))","4da26cd4":"final_X_scaled = scaler.fit_transform(X)","92ed8501":"final_model = SVC(C = 0.1, degree =  1, gamma= 'scale', kernel=  'linear')","c89fd2ab":"final_model.fit(final_X_scaled,y)","3b43bece":"df.head(1)","f68215c5":"values = [[25,0,2,180,200,0,0,200,1,1.8,1,1,0]]","5580336e":"final_model.predict(values)","503f762d":"# Implement Logistic Regression and Evaluate","5aabc18d":"# Data Preprocessing","bec81495":"# Implement KNN and Evaluate","f284d384":"___\n\n<p style=\"text-align: center;\"><img src=\"https:\/\/docs.google.com\/uc?id=1lY0Uj5R04yMY3-ZppPWxqCr5pvBLYPnV\" class=\"img-fluid\" alt=\"CLRSWY\"><\/p>\n\n___","0a15d198":"# Import esential Libraries","df99bd45":"# EDA","e1026385":"Data vocabulary:\n\n1. #3 (age): age in years \n2. #4 (sex): sex (1 = male; 0 = female) \n3. #9 (cp): cp: chest pain type | Value 0: typical angina | Value 1: atypical angina | Value 2: non-anginal pain | Value 3: asymptomatic \n4. #10 (trestbps): resting blood pressure (in mm Hg on admission to the hospital) \n5. #12 (chol): serum cholestoral in mg\/dl \n6. #16 (fbs): (fasting blood sugar > 120 mg\/dl) (1 = true; 0 = false) \n7. #19 (restecg): resting electrocardiographic results | Value 0: normal | Value 1: having ST-T wave abnormality (T wave inversions and\/or ST elevation or depression of > 0.05 mV) | Value 2: showing probable or definite left ventricular hypertrophy by Estes' criteria \n8. #32 (thalach): maximum heart rate achieved \n9. #38 (exang): exercise induced angina (1 = yes; 0 = no) \n10. #40 (oldpeak): ST depression induced by exercise relative to rest \n11. #41 (slope): the slope of the peak exercise ST segment | Value 1: upsloping | Value 2: flat | Value 3: downsloping \n12. #44 (ca): number of major vessels (0-3) colored by flourosopy \n13. #51 (thal): 3 = normal; 6 = fixed defect; 7 = reversable defect \n14. #58 (num) (the predicted attribute): Value 0: < 50% diameter narrowing | Value 1: > 50% diameter narrowing ","4b27b711":"# Chose best model and make a random prediction ","0be6b2bb":"# Implement SVM and Evaluate","a72f8241":"# Ingest the data to notebook","2a52c83a":"# Visually compare models based on your chosen metric"}}