{"cell_type":{"98d8a3b7":"code","b250e250":"code","757feb88":"code","8b405beb":"code","df953772":"code","066496ae":"code","20992fbe":"code","1c4ed522":"code","c24e38ae":"code","bf9f43bc":"code","2e12eb19":"code","7130786b":"code","1ab27779":"code","8a0adfc7":"code","80e75433":"code","49c10dd4":"code","cc697177":"code","be5ffd20":"code","580f8872":"code","05f32448":"code","72c32f7f":"code","8d499c7b":"code","1c74dda0":"code","6cbfc5db":"code","94127bba":"code","61d328cb":"code","6b4808fb":"code","ac6d224f":"code","30224170":"code","680def03":"code","b92ed1dc":"markdown","3ea9b93e":"markdown","63f3709a":"markdown","0bcde0f3":"markdown","4a5c6afd":"markdown","2964767f":"markdown","235124da":"markdown","f9b944e1":"markdown","5da40d92":"markdown","48df9e1e":"markdown","8c98ebad":"markdown","fecd6a16":"markdown","5dea07bb":"markdown"},"source":{"98d8a3b7":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","b250e250":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom scipy.stats import norm,skew\nfrom sklearn.metrics import r2_score\nfrom sklearn.metrics import mean_squared_error\nfrom sklearn.linear_model import LinearRegression","757feb88":"#Uploading the Dataset with Pandas Library \n","8b405beb":"df = pd.read_csv('..\/input\/insurance\/insurance.csv')","df953772":"df.info()","066496ae":"df.head(3)","20992fbe":"sns.histplot(df['charges'])","1c4ed522":"sns.histplot(np.log1p(df['charges']))","c24e38ae":"df.isnull().sum()","bf9f43bc":"plt.figure(figsize=(11, 5))\nsns.boxplot(x=\"region\", y=\"charges\", data=df)\nplt.title(\"Box plot of the Regions\")\nplt.show()","2e12eb19":"plt.figure(figsize=(10, 6))\nsns.countplot(x=\"smoker\", data=df)\nplt.title(\"Smoker Numbers\")\nplt.show()","7130786b":"plt.figure(figsize=(10, 6))\nsns.boxplot(x=\"smoker\", y=\"charges\", data=df)\nplt.title(\"Box plot of the Smokers\")\nplt.show()","1ab27779":"plt.figure(figsize=(10, 6))\nsns.distplot(df['children'])\nplt.title(\"Distribution of Children\")\nplt.show()","8a0adfc7":"df['obese'] = df['bmi'] > 30\ndf['obese'].value_counts()","80e75433":"s = (df.dtypes == 'object')\nobject_cols = list(s[s].index)\n\nprint(\"Categorical variables:\")\nprint(object_cols)","49c10dd4":"from sklearn.preprocessing import OneHotEncoder\n\n# Apply one-hot encoder to each column with categorical data\nOH_encoder = OneHotEncoder(handle_unknown='ignore', sparse=False)\nOH_cols_train = pd.DataFrame(OH_encoder.fit_transform(X[object_cols]))\n\n\n# One-hot encoding removed index; put it back\nOH_cols_train.index = X.index\n\n\n# Remove categorical columns (will replace with one-hot encoding)\nnum_X_train = X.drop(object_cols, axis=1)\n\n# Add one-hot encoded columns to numerical features\nOH_X_train = pd.concat([num_X_train, OH_cols_train], axis=1)\n\n","cc697177":"OH_X_train","be5ffd20":"from sklearn.preprocessing import LabelEncoder\n\ncolumns = ['sex', 'region', 'smoker', 'obese']\n\nfor column in columns:\n    encoder = LabelEncoder()\n    df[column] = encoder.fit_transform(df[column])\n\ndf.head()","580f8872":"df.info()","05f32448":"X = df.drop(columns=['charges', 'bmi'])\ny = df['charges']\n\nprint(\"X's shape\", X.shape)\nprint(\"y's shape\", y.shape)","72c32f7f":"X.head(3)","8d499c7b":"from sklearn.model_selection import train_test_split\nx_train,x_test,y_train,y_test=train_test_split(X,y,train_size=.8,random_state=0)","1c74dda0":"\nlr=LinearRegression()","6cbfc5db":"lr.fit(x_train,y_train)","94127bba":"y_pred=lr.predict(x_test)\ny_pred","61d328cb":"reg = LinearRegression()\nreg.fit(x_train,y_train)","6b4808fb":"reg.score(x_test,y_test)","ac6d224f":"\n\n\nr2 = r2_score(y_test, y_pred)\nmse = mean_squared_error(y_test, y_pred)\n\nprint(\"R2 score is {}\".format(r2))\nprint(\"Mean Squared Error score is {}\".format(mse))","30224170":"fig, ax = plt.subplots()\nax.plot([0,1],[0,1], transform=ax.transAxes)\n\nplt.scatter(y_pred, y_test)\nplt.xlabel(\"Predicted Values\")\nplt.ylabel(\"Observed Values\")\n\nplt.show()","680def03":"#Please upvote if you like","b92ed1dc":"#Since charges levied is independent Variable -which is y \n#Other independent variable is Age,Sex,BMI,Children,Smoker,Region0 - which are X1,X2,X3","3ea9b93e":"Charges of Southwest Region looks high but overall it is same","63f3709a":"Checking the data set ","0bcde0f3":"Most of Famlies is 0 to 1 Chidren so this no as important factor","4a5c6afd":"There are various factors which gives us info of Charges ","2964767f":"Loading basic Libraries","235124da":"Checking the count of No of Smoker ","f9b944e1":"Doing one Hot Encoding ","5da40d92":"First EDA is to understand which of Independent Variable are corelated to Dependent Variable","48df9e1e":"Using log function states still Histogram is not normal ","8c98ebad":"Checking missing values","fecd6a16":"Charges of Smoker are higher so we will keep the this independent Variable","5dea07bb":"Assinging the Label to Independent Variable"}}