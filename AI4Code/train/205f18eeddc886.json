{"cell_type":{"a070f667":"code","684a7fa0":"code","e9f613f7":"code","8da7075c":"code","e7101010":"code","717618bf":"code","1bc33e44":"code","7f369bd2":"code","7f2e5a68":"code","0df00aac":"code","3db7b8cd":"code","5f33f9fe":"code","91a6bd7e":"code","8acfeb2e":"code","55f6f8a6":"code","89a178b3":"code","728a5321":"code","9b394da9":"code","ee8fc76f":"code","56b084af":"code","0e58e82e":"code","1d930c85":"code","cf92c31b":"code","7f0b746f":"code","545acb2f":"code","aa608bd3":"code","3c493cdc":"code","2c7b2d21":"code","77c3c3b0":"code","aef52581":"code","d8f9fb18":"code","bd0d16dc":"code","89f0cd02":"code","50c8a8b7":"code","50acaf35":"code","6d514074":"code","425d85f4":"code","248b8473":"code","1ba775ab":"code","95171f1b":"code","9bf42c32":"code","46ec4d5b":"code","100edd80":"code","f4ddfeb1":"code","068ec0a3":"code","6931f480":"code","1b26377a":"code","145af515":"markdown","a9fce35d":"markdown","c5f5e324":"markdown","c27afaae":"markdown","f944c1c0":"markdown","e32993eb":"markdown","c2e3ec53":"markdown","492b87da":"markdown","57587cc2":"markdown","edd4cd1b":"markdown","0fa8ec86":"markdown","1d31620d":"markdown","627a1f08":"markdown","0a016cea":"markdown","40391240":"markdown","248b6b10":"markdown","9cdb611b":"markdown"},"source":{"a070f667":"import pandas as pd\nimport re\nimport numpy as np\nimport os\nimport matplotlib.pyplot as plt\nimport seaborn as sns","684a7fa0":"%matplotlib inline","e9f613f7":"df = pd.read_csv(\"\/kaggle\/input\/air-pollution-dataset-india-2019\/combined.csv\", low_memory=False)","8da7075c":"df.head()","e7101010":"def lookup(s):\n    \"\"\"\n    This is an extremely fast approach to datetime parsing.\n    For large data, the same dates are often repeated. Rather than\n    re-parse these, we store all unique dates, parse them, and\n    use a lookup to convert all dates.\n    \"\"\"\n    dates = {date:pd.to_datetime(date) for date in s.unique()}\n    return s.map(dates)","717618bf":"df['datetime'] = lookup(df['datetime'])","1bc33e44":"#df.set_index('datetime', inplace=True)","7f369bd2":"df.head()","7f2e5a68":"df.info(memory_usage='deep')","0df00aac":"df.describe()","3db7b8cd":"df.drop('live', axis=1, inplace=True) #dropping unwanted column","5f33f9fe":"df.shape","91a6bd7e":"print(df['SO2'].isna().sum())\nprint(df['NO2'].isna().sum())\nprint(df['NH3'].isna().sum())\nprint(df['CO'].isna().sum())\nprint(df['OZONE'].isna().sum())","8acfeb2e":"#mean of the day\ndayMeandf =  df.loc[:,['id','SO2','NO2','NH3','CO','OZONE']].groupby([df['datetime'].dt.dayofyear ,'id']).transform('mean')","55f6f8a6":"df['SO2'].fillna(dayMeandf['SO2'], inplace=True)\ndf['NO2'].fillna(dayMeandf['NO2'], inplace=True)\ndf['NH3'].fillna(dayMeandf['NH3'], inplace=True)\ndf['CO'].fillna(dayMeandf['CO'], inplace=True)\ndf['OZONE'].fillna(dayMeandf['OZONE'], inplace=True)","89a178b3":"#mean of the week\nweekMeandf =  df.loc[:,['id','SO2','NO2','NH3','CO','OZONE']].groupby([df['datetime'].dt.weekofyear ,'id']).transform('mean')","728a5321":"df['SO2'].fillna(weekMeandf['SO2'], inplace=True)\ndf['NO2'].fillna(weekMeandf['NO2'], inplace=True)\ndf['NH3'].fillna(weekMeandf['NH3'], inplace=True)\ndf['CO'].fillna(weekMeandf['CO'], inplace=True)\ndf['OZONE'].fillna(weekMeandf['OZONE'], inplace=True)","9b394da9":"print(df['SO2'].isna().sum())\nprint(df['NO2'].isna().sum())\nprint(df['NH3'].isna().sum())\nprint(df['CO'].isna().sum())\nprint(df['OZONE'].isna().sum())","ee8fc76f":"df.dropna(how='all', inplace=True)","56b084af":"#number of state\ndf['stateid'].unique()","0e58e82e":"def myfunc(x):\n    return (x['id'].nunique())\n\nstationsPerState = df.loc[:,['stateid','id']].groupby('stateid').apply(myfunc).reset_index()","1d930c85":"stationsPerState.rename({0:'count'}, axis=1, inplace=True)","cf92c31b":"stationsPerState.sort_values('count', ascending=False, inplace=True)\nstationsPerState","7f0b746f":"fig = plt.figure(figsize=[10,4])\naxes = fig.add_axes([0,0,1,1])\naxes.bar(stationsPerState['stateid'], stationsPerState['count'])\nfig.autofmt_xdate(rotation=60)\naxes.set_xlabel('State',{\"fontsize\":12})\naxes.set_ylabel('Number of stations', {\"fontsize\":12})\naxes.set_title('Number of stations per state')","545acb2f":"def myfunc(x):\n    return (x['id'].nunique())\n\nstationsByState = df.loc[:,['stateid','cityid','id']].groupby(['stateid','cityid']).apply(myfunc)\nstationsByState","aa608bd3":"fig = plt.figure(figsize=[20,20])\naxes = fig.subplots(7,3)\naxes = axes.flatten()\nfig.tight_layout()\nfig.subplots_adjust(hspace=1, wspace=0.2)\n\nfor i,state in enumerate(stationsByState.index.get_level_values(0).unique()):\n    axes[i].bar(stationsByState[state].index,stationsByState[state].values)\n    axes[i].tick_params(axis='x', labelrotation=45)\n    axes[i].set_xlabel(state,{\"fontsize\":14})\n    axes[i].set_ylabel(\"stations\", {\"fontsize\":14})\n","3c493cdc":"averageByState = df.loc[:,['stateid','PM2.5', 'PM10', 'NO2', 'NH3', 'SO2', 'CO', 'OZONE']].groupby('stateid', as_index=False).mean()\naverageByState","2c7b2d21":"fig = plt.figure(figsize=[20,50])\npollutants = ['PM2.5', 'PM10', 'NO2', 'NH3', 'SO2', 'CO', 'OZONE']\ncolors = ['#00965d','#829600', '#dbeb34', '#34ebd3', '#004496','#7a0096','#960052']\naxes = fig.subplots(len(pollutants))\nfig.subplots_adjust(hspace=0.4)\n\nfor i,pollutant in enumerate(pollutants):\n    axes[i].bar(averageByState['stateid'], averageByState[pollutant], color=colors[i])\n    axes[i].tick_params(axis='x', labelrotation=45)\n    axes[i].set_xlabel('States', {\"fontsize\":16})\n    axes[i].set_ylabel('value', {\"fontsize\":16})\n    axes[i].set_title(pollutant, {\"fontsize\":18})","77c3c3b0":"fig = plt.figure(figsize=[20,6])\naxes = fig.add_axes([0,0,1,1])\naxes.plot(averageByState['stateid'], averageByState.loc[:,['PM2.5', 'PM10', 'NO2', 'NH3', 'SO2', 'CO', 'OZONE']])\naxes.tick_params(axis='x', labelrotation=45)\naxes.legend(labels=['PM2.5', 'PM10', 'NO2', 'NH3', 'SO2', 'CO', 'OZONE'],prop={'size': 18})\naxes.set_xlabel('State', {\"fontsize\":18})\naxes.set_ylabel('Pollutant value', {\"fontsize\":18})","aef52581":"averageByState.sort_values(['PM2.5', 'PM10', 'NO2', 'NH3', 'SO2', 'CO', 'OZONE'], ascending=False).head()","d8f9fb18":"averageByState.sort_values(['PM2.5', 'PM10', 'NO2', 'NH3', 'SO2', 'CO', 'OZONE'], ascending=True).head()","bd0d16dc":"df['month'] = df['datetime'].dt.month_name()","89f0cd02":"df['month'] = df['month'].astype(pd.CategoricalDtype(['January', 'February', 'March', 'April', 'May', 'June', 'July' ,'August', 'September', 'October', 'November', 'December'], ordered=True))","50c8a8b7":"monthlyAverage = df.loc[:,['month','PM2.5', 'PM10', 'NO2', 'NH3', 'SO2', 'CO', 'OZONE']].groupby('month', as_index=False).mean()\nmonthlyAverage","50acaf35":"fig = plt.figure(figsize=[20,6])\naxes = fig.subplots()\naxes.scatter(monthlyAverage['month'],monthlyAverage['PM2.5'], label = 'PM2.5')\naxes.scatter(monthlyAverage['month'],monthlyAverage['PM10'], label= 'PM10')\naxes.scatter(monthlyAverage['month'],monthlyAverage['SO2'], label='SO2')\naxes.scatter(monthlyAverage['month'],monthlyAverage['NO2'], label='NO2')\naxes.scatter(monthlyAverage['month'],monthlyAverage['NH3'], label='NH3')\naxes.scatter(monthlyAverage['month'],monthlyAverage['CO'], label= 'CO')\naxes.scatter(monthlyAverage['month'],monthlyAverage['OZONE'], label='OZONE')\naxes.legend()","6d514074":"df['hour'] = df['datetime'].dt.hour","425d85f4":"df['hour'] = df['hour'].astype(pd.CategoricalDtype([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16,\n       17, 18, 19, 20, 21, 22, 23], ordered=True))","248b8473":"hourlyAverage = df.loc[:,['hour','PM2.5', 'PM10', 'NO2', 'NH3', 'SO2', 'CO', 'OZONE']].groupby('hour', as_index=False).mean()","1ba775ab":"fig = plt.figure(figsize=[20,6])\naxes = fig.subplots()\naxes.scatter(hourlyAverage['hour'],hourlyAverage['PM2.5'], label = 'PM2.5')\naxes.scatter(hourlyAverage['hour'],hourlyAverage['PM10'], label= 'PM10')\naxes.scatter(hourlyAverage['hour'],hourlyAverage['SO2'], label='SO2')\naxes.scatter(hourlyAverage['hour'],hourlyAverage['NO2'], label='NO2')\naxes.scatter(hourlyAverage['hour'],hourlyAverage['NH3'], label='NH3')\naxes.scatter(hourlyAverage['hour'],hourlyAverage['CO'], label= 'CO')\naxes.scatter(hourlyAverage['hour'],hourlyAverage['OZONE'], label='OZONE')\naxes.set_xticks(range(24))\naxes.set_xlabel('hours', {\"fontsize\":16})\naxes.set_ylabel('value', {\"fontsize\":16})\naxes.set_title('Pollution by Hour', {\"fontsize\":18})\naxes.legend()","95171f1b":"df['dayoftheweek'] = df['datetime'].dt.dayofweek","9bf42c32":"df['weekend'] = 'weekday'\ndf.loc[df['dayoftheweek'].isin([5,6]),'weekend'] = 'weekend'","46ec4d5b":"df['weekend'] = df['weekend'].astype(pd.CategoricalDtype(['weekday','weekend']))\n","100edd80":"weekendGrp = df.loc[:,['weekend','PM2.5', 'PM10', 'NO2', 'NH3', 'SO2', 'CO', 'OZONE']].groupby('weekend', as_index=False).mean()\nweekendGrp","f4ddfeb1":"weekendGrp[weekendGrp['weekend'] == 'weekend'].loc[:,['PM10', 'NO2', 'NH3', 'SO2', 'CO', 'OZONE']].values[0]","068ec0a3":"fig = plt.figure(figsize=[20,6])\naxes = fig.subplots()\naxes.plot(['PM10', 'NO2', 'NH3', 'SO2', 'CO', 'OZONE'],weekendGrp[weekendGrp['weekend'] == 'weekend'].loc[:,['PM10', 'NO2', 'NH3', 'SO2', 'CO', 'OZONE']].values[0], label='weekend')\naxes.plot(['PM10', 'NO2', 'NH3', 'SO2', 'CO', 'OZONE'],weekendGrp[weekendGrp['weekend'] == 'weekday'].loc[:,['PM10', 'NO2', 'NH3', 'SO2', 'CO', 'OZONE']].values[0], label='weekday')\naxes.legend(prop={'size':18})\naxes.set_xlabel('Pollutant', {\"fontsize\":18})\naxes.set_ylabel('value', {\"fontsize\":18})\naxes.set_title('Pollution on weekdays vs weekends')","6931f480":"df[df['datetime'] == '2019-10-27'].mean()","1b26377a":"df[df['datetime'] == '2019-01-01'].mean()","145af515":"### What time of the day has more pollution ?","a9fce35d":"### Pollution during festive seasons\n###### In India, the festivals which causes air pollution are New Year and Deepavali\n###### Deepavali is on Sunday, 27 October 2019 and New year is on 01 January","c5f5e324":"#### It seems pollution is almost equal during both weekends and weekdays","c27afaae":"### Is seasonality exists in the pollution?","f944c1c0":"### States with High Pollution","e32993eb":"### Pollutant Types","c2e3ec53":"#### SO2 and NO2 pullutants\nThe most important sources of SO2 are fossil fuel combustion, smelting, manufacture of sulphuric acid, conversion of wood pulp to paper, incineration of refuse and production of elemental sulphur. Coal burning is the single largest man-made source of SO2 accounting for about 50% of annual global emissions, with oil burning accounting for a further 25-30%.\n\nGlobally, quantities of nitrogen oxides produced naturally (by bacterial and volcanic action and lightning) far outweigh anthropogenic (man-made) emissions. Anthropogenic emissions are mainly due to fossil fuel combustion from both stationary sources, i.e. power generation (21%), and mobile sources, i.e. transport (44%). Other atmospheric contributions come from non-combustion processes, for example nitric acid manufacture, welding processes and the use of explosives.\n\nNitrogen dioxide (NO2), sulfur dioxide (SO2), and carbon monoxide are important ambient air pollutants. High-intensity, confined space exposure to NO2 has caused catastrophic injury to humans, including death. Ambient NO2 exposure may increase the risk of respiratory tract infections through the pollutant's interaction with the immune system. Sulfur dioxide (SO2) contributes to respiratory symptoms in both healthy patients and those with underlying pulmonary disease.","492b87da":"#### PM2.5 and PM10 pollutants are low during 4:00 PM and 5:00 PM and O3(OZONE) pollutants are high during 2:00 PM and 3:00 PM\n#### Perfect time for jogging or outdoor activities is during 4:00 PM - 5:00 PM or 5:00 AM - 6:00 AM","57587cc2":"#### PM2.5 and PM10\nPM2.5 refers to the atmospheric particulate matter that has a diameter of less than 2.5 micrometres, which is about 3% of the diameter of human hair.\n\nThe particles in PM2.5 category are so small that they can only be detected with the help of the electron microscope. These are smaller than PM10 particles. PM10 are the particles with a diameter of 10 micrometers and they are also called fine particles. An environmental expert says that PM10 is also known as respirable particulate matter.","edd4cd1b":"### Number of stations per state","0fa8ec86":"### Top 5 states are\n'Delhi', 'Uttar Pradesh', 'Bihar', 'Haryana', 'Chandigarh'","1d31620d":"### Bottom 5 states are\n'Meghalaya ', 'Kerala', 'Karnataka', 'Andhra Pradesh', 'Maharashtra'","627a1f08":"### Fillna values by the mean of the day and mean of the week","0a016cea":"#### CO\nThe major source of atmospheric CO is the spark ignition combustion engine. Smaller contributions come from processes involving the combustion of organic matter, for example in power stations and waste incineration.","40391240":"#### OZONE\nMost O3 in the troposphere (lower atmosphere) is formed indirectly by the action of sunlight on nitrogen dioxide - there are no direct emissions of O3 to the atmosphere. About 10 - 15% of tropospheric O3 is transported from the stratosphere where it is formed by the action of ultraviolet (UV) radiation on O2.","248b6b10":"### Pollution on weekends vs weekdays","9cdb611b":"### Pollution is low during august and september and high during winters (November, December, January)"}}