{"cell_type":{"a5f34278":"code","e15161c2":"code","4dfe173d":"code","4b64b4ae":"code","517cfbb9":"code","b2a030a9":"code","9d98e5a5":"code","e8006453":"code","2d538996":"code","9ae9d5e7":"code","1286ca0e":"code","4376371f":"code","b5cef3d2":"code","0654dffb":"code","ace137ca":"code","493ea9d5":"code","f5908ffb":"code","5a4de140":"code","a8a5f93a":"code","a61b9e03":"code","526a6e6d":"code","c3ee54d2":"code","bece2f02":"code","e34db0b9":"code","79029e84":"code","86836904":"code","32fba808":"code","cdf64111":"code","d1210f9b":"code","3dba3b8a":"code","bb486cce":"code","a70a4e4f":"code","da69b4e5":"code","65fcdf31":"markdown","31166a53":"markdown","9c365a20":"markdown","3dd5b5a9":"markdown"},"source":{"a5f34278":"import pandas as pd\nimport numpy as np\nimport glob\nimport os\nimport cv2\nfrom IPython.display import Image\nimport matplotlib.pyplot as plt\nimport seaborn as sb\nfrom tensorflow.keras.layers import *\nfrom tensorflow.keras.models import * \nfrom tensorflow.keras.preprocessing import image\nfrom sklearn.model_selection import train_test_split\nfrom wordcloud import WordCloud, STOPWORDS, ImageColorGenerator\nfrom keras.applications import ResNet50\nfrom keras import applications\nfrom PIL import Image\nfrom sklearn.preprocessing import LabelEncoder\nfrom keras.utils import np_utils","e15161c2":"#No. of folders\nbase_path = '..\/input\/hackerearths-snakes-in-the-hood\/dataset\/'\nfolders = os.listdir(base_path)\nprint(folders)","4dfe173d":"#Load the dataset\ndf=pd.read_csv(\"..\/input\/hackerearths-snakes-in-the-hood\/dataset\/train.csv\")\ndf_t=pd.read_csv(\"..\/input\/hackerearths-snakes-in-the-hood\/dataset\/test.csv\")\ndf.head()","4b64b4ae":"df.shape","517cfbb9":"df.nunique()","b2a030a9":"#Get the total numbers of snake present in each breed\ndf['breed'].value_counts()","9d98e5a5":"#Get new columns\nbtype = df[\"breed\"].str.split(\"-\",expand = True)\ndf[\"Genus\"]=btype[0]\ndf[\"Type\"]=btype[1]","e8006453":"df.head()","2d538996":"df['Genus'].value_counts()","9ae9d5e7":"df['Type'].value_counts()","1286ca0e":"#Add path and .jpg to the cloumn\ndf[\"image_id\"]=\"..\/input\/hackerearths-snakes-in-the-hood\/dataset\/train\/\" + df[\"image_id\"] + \".jpg\"\ndf.head()","4376371f":"for i in range(len(df_t['image_id'])):\n    df_t['image_id'][i]=df_t['image_id'][i]+'.jpg'","b5cef3d2":"#plot first 6 images\nfig = plt.figure(figsize=(20, 7))\n\nrows = 2\ncolumns = 3\n\nImage1 = cv2.imread((df['image_id'][0]))\nImage2 = cv2.imread(df['image_id'][1])\nImage3 = cv2.imread(df['image_id'][2])\nImage4 = cv2.imread(df['image_id'][3])\nImage5 = cv2.imread(df['image_id'][4])\nImage6 = cv2.imread(df['image_id'][5])\n\nfig.add_subplot(rows, columns, 1)\n\nplt.imshow(Image1)\nplt.axis('off')\nplt.title(df['breed'][0])\n  \n# Adds a subplot at the 2nd position\nfig.add_subplot(rows, columns, 2)\n  \n# showing image\nplt.imshow(Image2)\nplt.axis('off')\nplt.title(df['breed'][1])\n  \n# Adds a subplot at the 3rd position\nfig.add_subplot(rows, columns, 3)\n  \n# showing image\nplt.imshow(Image3)\nplt.axis('off')\nplt.title(df['breed'][2])\n  \n# Adds a subplot at the 4th position\nfig.add_subplot(rows, columns, 4)\n  \n# showing image\nplt.imshow(Image4)\nplt.axis('off')\nplt.title(df['breed'][3])\n\n# Adds a subplot at the 4th position\nfig.add_subplot(rows, columns, 5)\n  \n# showing image\nplt.imshow(Image5)\nplt.axis('off')\nplt.title(df['breed'][4])\n\n# Adds a subplot at the 4th position\nfig.add_subplot(rows, columns, 6)\n  \n# showing image\nplt.imshow(Image6)\nplt.axis('off')\nplt.title(df['breed'][5])","0654dffb":"#plot the number of snakes in each breed\nplt.figure(figsize = (20,10))\nplt.axes(facecolor = \"#000000\")\nplt.xticks(rotation = 'vertical')\nsb.countplot(x=\"breed\", data=df, palette=\"gist_rainbow_r\");\nplt.show()","ace137ca":"#relation betwwen Genus and Type\nplt.figure(figsize = (20,10))\nplt.axes(facecolor = \"#000000\")\nplt.xticks(rotation = 'vertical')\nsb.stripplot(x=\"Genus\", y = \"Type\",data=df)\nplt.show()","493ea9d5":"#Make a word cloud\ncomment_words = \"\"\nfor i in df.Type: \n    i = str(i) \n    separate = i.split() \n    for j in range(len(separate)): \n        separate[j] = separate[j].lower() \n      \n    comment_words += \" \".join(separate)+\" \"","f5908ffb":"\nfinal_wordcloud = WordCloud(width = 800, height = 800, \n                background_color ='black', min_font_size = 10).generate(comment_words)\n\nplt.figure( figsize=(20,20))\nplt.tight_layout(pad=0)\nplt.imshow(final_wordcloud, interpolation='spline36')\nplt.axis(\"off\")\nplt.show()","5a4de140":"\nllist = df['breed'].tolist()\nlabel = {k: v for v, k in enumerate(set(llist))}\ny = [label[k] for k in llist]\ny = np.array(y)","a8a5f93a":"from keras.utils import to_categorical\ny = to_categorical(y)\ny","a61b9e03":"y.shape","526a6e6d":"#To read each image\ndef read_img(img_path):\n    img = cv2.imread(img_path, cv2.IMREAD_COLOR)\n    img = cv2.resize(img, (224, 224))\n    return img","c3ee54d2":"from tqdm import tqdm\ndf_img = []\nfor img_name in tqdm(df['image_id'].values):\n    df_img.append(read_img(img_name ))","bece2f02":"X = np.array(df_img, np.float32) \/ 255","e34db0b9":"print(X.shape)","79029e84":"#Using Resnet50 model\nbase_model = applications.ResNet50(weights='imagenet', include_top=False, input_shape=(224, 224, 3))","86836904":"# set model architechture \nadd_model = Sequential()\nadd_model.add(Flatten())\nadd_model.add(Dense(256, activation='relu'))\nadd_model.add(Dropout(0.2))\nadd_model.add(Dense(128, activation='relu'))\nadd_model.add(Dropout(0.3))\nadd_model.add(Dense(64, activation='relu'))\nadd_model.add(Dropout(0.5))\nadd_model.add(Dense(35, activation='tanh'))\n\nmodel = Model(inputs=base_model.input, outputs=add_model(base_model.output))\n\nmodel.compile(loss='categorical_crossentropy', optimizer='adam',\n              metrics=['accuracy'])","32fba808":"model.summary()","cdf64111":"#Data Augumentation\ntrain_datagen = image.ImageDataGenerator(rescale = 1.\/255,rotation_range=120,width_shift_range=(-50,50), height_shift_range=(-50,50),shear_range = 0.4,zoom_range = (0.1,0.6), horizontal_flip = True,vertical_flip=True,channel_shift_range=0.3,fill_mode='nearest')\n\ntrain_datagen.fit(X)","d1210f9b":"history = model.fit_generator( train_datagen.flow(X, y, batch_size=32),\n                               epochs=20)","3dba3b8a":"test_img = []\nfor img_name in tqdm(df_t['image_id'].values): \n    test_img.append(read_img(\"..\/input\/hackerearths-snakes-in-the-hood\/dataset\/test\/\" + img_name))","bb486cce":"Test_img = np.array(test_img, np.float32) \/ 255","a70a4e4f":"#Prediction\npreds = model.predict(Test_img)","da69b4e5":"preds = np.argmax(preds, axis=1)\npredy = {v:k for k,v in label.items()}\npredlabels = [predy[k] for k in preds]","65fcdf31":"# Data Visualization","31166a53":"# **Load Packages**","9c365a20":"# EDA","3dd5b5a9":"# Model Work"}}