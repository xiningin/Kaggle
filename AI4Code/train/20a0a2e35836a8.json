{"cell_type":{"c41d1c25":"code","183b8538":"code","f11295c0":"code","81074f86":"code","760e8e1c":"code","4003fa20":"code","449713cd":"code","47d38594":"code","646a69b2":"code","9cb24c8b":"code","1552b6da":"code","cb2d14f2":"code","1f9ac19d":"code","232548ab":"code","f200f00f":"code","a3540b92":"code","9c261dfc":"code","93e8e63d":"code","bdb3429b":"code","e04d049c":"code","1b7aeae4":"code","7332c937":"code","abcbb9b7":"markdown","3730293b":"markdown","eb3a6696":"markdown","2a9fa587":"markdown","2e22c8dc":"markdown","5e1d3567":"markdown","f27b458c":"markdown","5e91610f":"markdown","17fbbfe8":"markdown","63c47c0a":"markdown","d75980cb":"markdown","85c88cee":"markdown","f91cefa4":"markdown","9efe0bd4":"markdown","f7a6b32d":"markdown","b3962491":"markdown","c1e2949c":"markdown","5d031d53":"markdown"},"source":{"c41d1c25":"import math\nimport numpy as np\nimport pandas as pd\nfrom sklearn import preprocessing\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.metrics import mean_squared_error\nfrom sklearn.metrics import mean_absolute_error","183b8538":"df = pd.read_csv('..\/input\/stock-prices-apple-inc\/EOD-AAPL.csv')\ndf.head()","f11295c0":"df = df[['Adj_Open',  'Adj_High',  'Adj_Low',  'Adj_Close', 'Adj_Volume']]","81074f86":"df['HL_PCT'] = (df['Adj_High'] - df['Adj_Low']) \/ df['Adj_Close'] * 100.0","760e8e1c":"df['PCT_change'] = (df['Adj_Close'] - df['Adj_Open']) \/ df['Adj_Open'] * 100.0","4003fa20":"df = df[['Adj_Close', 'HL_PCT', 'PCT_change', 'Adj_Volume']]\ndf.head()","449713cd":"forecast_col = 'Adj_Close'\ndf.fillna(value=-99999, inplace=True)","47d38594":"forecast_out = int(math.ceil(0.01 * len(df)))","646a69b2":"df['label'] = df[forecast_col].shift(-forecast_out) #the price in future","9cb24c8b":"df.dropna(inplace=True)","1552b6da":"df.corr()","cb2d14f2":"import seaborn as sns\nheatmap = sns.heatmap(df.corr())","1f9ac19d":"sns.pairplot(df)","232548ab":"X = np.array(df.drop(['label'], 1))\ny = np.array(df['label'])","f200f00f":"X = preprocessing.scale(X)","a3540b92":"y = np.array(df['label'])","9c261dfc":"train_X, test_X, train_y, test_y = train_test_split(X, y, test_size=0.2, random_state=0)","93e8e63d":"model=LinearRegression()","bdb3429b":"model.fit(train_X,train_y)","e04d049c":"val_predictions = model.predict(test_X)\n#val_predictions","1b7aeae4":"print(\"Mean Squared Error: \")\nprint(mean_squared_error(test_y, val_predictions))","7332c937":"print(\"Mean Absolute Error: \")\nprint(mean_absolute_error(test_y, val_predictions))","abcbb9b7":"# STOCK PRICE PREDICTION USING LINEAR REGRESSION","3730293b":"Scaling the features","eb3a6696":"Calculating the High Low Percentage and Percentage Change -","2a9fa587":"## Data Preprocessing","2e22c8dc":"## Reading the dataset","5e1d3567":"Thus, the MSE of the model is 0.94 (approx.).","f27b458c":"The correlation graph and heat map shown above indicates the magnitude of correlation matrix using different intensities of colour in 2D.","5e91610f":"We can infer that label and 'Adj_Close' have a positive correlation of 1.0 while 'Adj_Volume' has a negative correlation with 'Adj_Close' and label.","17fbbfe8":"## Data Analysis","63c47c0a":"The Nan values are replaced with -99999 as the machine learning classifier cannot accept Nan data points and the replaced value will then be considered as an outlier","d75980cb":"Thus, the MAE of the model is approximately 0.76 .","85c88cee":"## Training with Linear Regression","f91cefa4":"## Model Evaluation","9efe0bd4":"Here, the features are the current values, and the label will be the price, so we have considered the future to be 1% of the entire length of the dataset out.","f7a6b32d":"Dropping the rows with NaN values","b3962491":"Target variable is y i.e. the price in future.","c1e2949c":"The above matrix shows all the possible correlations between numerical variables.\n\nNegative correlation is a relationship between 2 variables in which as one variable increases, the other decreases and vice versa. A perfect negative correlation is -1, a 0 indicates no correlation, and a +1 indicates a perfect positive correlation.\n","5d031d53":"The model is good as the error is quite low."}}