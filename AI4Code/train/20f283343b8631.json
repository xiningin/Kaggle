{"cell_type":{"b0d1e6f4":"code","56affce5":"code","f3a287e7":"code","02874d1b":"code","8a7d9773":"code","5b3ebf43":"code","c7c3ae5f":"code","9221a755":"code","b238efd8":"code","e0807cdb":"code","696d24a0":"code","f2be8062":"code","0497aa18":"code","bd315aed":"code","aee4f3d3":"code","5e8cac4f":"code","e974f256":"code","ad7b7fa7":"code","f1afb013":"code","57942bca":"code","ad7e8fff":"code","aaf3691e":"code","36630cd5":"code","84aa8674":"code","0297fdbb":"code","ca5a7995":"markdown","2c12808e":"markdown","5941b86a":"markdown","d0028702":"markdown","c4d5664d":"markdown","018da9da":"markdown","9a41bfed":"markdown","30856777":"markdown","d0ad73fd":"markdown","ef391970":"markdown","38c53be2":"markdown","e2c46248":"markdown","09ec79f3":"markdown","957bd5e1":"markdown","e2fde3a3":"markdown","e991df75":"markdown","9af49fa9":"markdown","965335eb":"markdown","d168d8cb":"markdown","0237135c":"markdown"},"source":{"b0d1e6f4":"\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n#For data Visualization \nimport matplotlib.pyplot as plt \nimport seaborn as sns \n\nimport warnings \nwarnings.filterwarnings('ignore')\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n","56affce5":"df = pd.read_csv('\/kaggle\/input\/red-wine-quality-cortez-et-al-2009\/winequality-red.csv')\ndf.head()","f3a287e7":"print(f'Wine Analysis Dataset has {df.shape[0]} rows and {df.shape[1]} columns overall.')","02874d1b":"df.info()","8a7d9773":"df.isnull().sum()","5b3ebf43":"correlation  = df.corr()\nmask = np.triu(np.ones_like(correlation , dtype = bool))\n\nplt.figure(figsize = (10,6))\nsns.heatmap(correlation , mask = mask , annot = True , linewidth = 1)\nplt.title('Correlation of Wine Analysis with respect to quality')","c7c3ae5f":"df['isgood'] = ''\nisgood = []\nfor i in df.quality : \n    if i <= 7 : \n        isgood.append(1)\n    else : \n        isgood.append(0)\n        \ndf['isgood'] = isgood \n\ndf","9221a755":"df.isgood.value_counts()","b238efd8":"df1 = df.copy()","e0807cdb":"quality_1 = df1[df1['isgood'] == 1] \nquality_0 = df1[df1['isgood'] == 0]\n\nprint(f'Shape of quality 1 : {quality_1.shape}')\nprint(f'Shape of quality 0 : {quality_0.shape}')","696d24a0":"df1_quality_0_over = quality_0.sample(len(quality_1) , replace = True)\ndf1_quality_0_over.shape","f2be8062":"df1_oversampled = pd.concat([quality_1,df1_quality_0_over] , axis = 0) \ndf1_oversampled.isgood.value_counts()","0497aa18":"correlation_oversampled  = df1_oversampled.corr()\nmask = np.triu(np.ones_like(correlation_oversampled , dtype = bool))\n\nplt.figure(figsize = (10,6))\nsns.heatmap(correlation_oversampled , mask = mask , annot = True , linewidth = 1)\nplt.title('Correlation of Wine Analysis with respect to isgood')","bd315aed":"sns.barplot( y = 'volatile acidity', x ='quality' , data = df)","aee4f3d3":"sns.barplot( y = 'chlorides', x ='quality' , data = df)","5e8cac4f":"sns.barplot( y = 'citric acid', x ='quality' , data = df)","e974f256":"sns.barplot( y = 'sulphates', x ='quality' , data = df)","ad7b7fa7":"sns.barplot( y = 'alcohol', x ='quality' , data = df)","f1afb013":"features_oversampled = df1_oversampled.iloc[:,:-1]\nlabel_oversampled = df1_oversampled['isgood']","57942bca":"from sklearn.model_selection import train_test_split \nx_train,x_test,y_train,y_test = train_test_split(features_oversampled,label_oversampled,test_size = 0.25 )\nprint(f'Length of x_train : {x_train.shape}')\nprint(f'Length of y_train : {y_train.shape}')\nprint(f'Length of x_test : {x_test.shape}')\nprint(f'Length of y_test : {y_test.shape}')\n","ad7e8fff":"from sklearn.neural_network import MLPClassifier\n\nmlp_classifier = MLPClassifier()\n\nmlp_classifier.fit(x_train,y_train)\n\nmlp_classifier.score(x_test,y_test)","aaf3691e":"y_pred = mlp_classifier.predict(x_test)\ny_pred[:5]","36630cd5":"list(y_test[:5])","84aa8674":"from sklearn.metrics import confusion_matrix , classification_report  \n\nreport = classification_report(y_test,y_pred)\nprint(report)","0297fdbb":"cm = confusion_matrix(y_test,y_pred) \nplt.figure(figsize = (5,4))\nsns.heatmap(cm , annot = True ,linewidth = 1)\nplt.title('Confusion Matrix')\nplt.xlabel('Predicted Labels')\nplt.ylabel('Actual Labels')","ca5a7995":"<b style = 'font-size :16px'>So for the classification problem , to make the labels simple we can try creating a label column in which 1 belongs to the good wine quality and 0 belongs to not to good wine quality <\/b>","2c12808e":"<b style = 'font-size :16px'>We did oversampling on the 0 label.<\/b>\n<br>\n<b style = 'font-size :16px'>So,we need to concatenate and create a new dataframe which we will be using further for creating features and label<\/b>","5941b86a":"<b>Context : <\/b>\n\nThe two datasets are related to red and white variants of the Portuguese \"Vinho Verde\" wine. For more details, consult the reference [Cortez et al., 2009]. Due to privacy and logistic issues, only physicochemical (inputs) and sensory (the output) variables are available (e.g. there is no data about grape types, wine brand, wine selling price, etc.).\n\nThese datasets can be viewed as classification or regression tasks. The classes are ordered and not balanced (e.g. there are much more normal wines than excellent or poor ones).\n\n\n<b>Content : <\/b>\n\nInput variables (based on physicochemical tests):\n\n1 - fixed acidity\n\n2 - volatile acidity\n\n3 - citric acid\n\n4 - residual sugar\n\n5 - chlorides\n\n6 - free sulfur dioxide\n\n7 - total sulfur dioxide\n\n8 - density\n\n9 - pH\n\n10 - sulphates\n\n11 - alcohol\n\nOutput variable (based on sensory data):\n\n12 - quality (score between 0 and 10)","d0028702":"<b style = 'font-size :16px'>If volatile acidity increase then the quality of the wine decreases<\/b>","c4d5664d":"<i style = 'font-size :16px'>lets do some visualization on the previous label column (quality)<\/i>","018da9da":"\n<b style = 'font-size :16px'>Seperate out 0 and 1 labels into two different datasets<\/b>","9a41bfed":"<b style = 'font-size :16px'>We have good two anologies : <\/b>\n<br>\n<b style = 'font-size :16px'>1.Columns such as volatile acidity , chlorides , density are positively correlated to isgood label.<\/b>\n<br>\n<b style = 'font-size :16px'>2.Columns such as citric acide , suplhates and alcohols are negatively correlated to isgood label.<\/b>","30856777":"<b style = 'font-size :16px'>Here,the count for 0 values is too less to be used for classification problem so we have undersampling issues.<\/b>\n<br>\n<b style = 'font-size :16px'>There are two ways to solve this issue : <\/b>\n<br>\n<b style = 'font-size :16px'>1.Oversampling technique<\/b> \n<br>\n<b style = 'font-size :16px'>2.SMOTE technique<\/b>","d0ad73fd":"<b style = 'font-size :16px'>For the classification of we will use MLP classifier of Neural Networks using sklearn <\/b>","ef391970":"<b style = 'font-size :16px'>If alcohol in wine is above 10 or close to 10 then its value can increase but in some cases in can also decrease due to other ingredients <\/b>","38c53be2":"<b style = 'font-size :16px'>If Sulphates in wine increases then the quality of wine gets also increases <\/b>","e2c46248":"<b style = 'font-size :16px'>If chlorides in wine increases then the quality of wine gets decreases <\/b>","09ec79f3":"<b style = 'font-size :16px'>Lets seperate train_test dataframes using sklearn libraries model_selection<\/b>","957bd5e1":"<b style = 'font-size :16px'>Plotting correlation with respect to quality 'label' <\/b>","e2fde3a3":"<b style = 'font-size :16px'>Importing the Required Libraries<\/b>","e991df75":"<b style='font-size:16px'>Lets try oversampling Technique<\/b>","9af49fa9":"<b style = 'font-size :16px'>Checking for NaN\/Null values<\/b>","965335eb":"<b style = 'font-size :16px'>Plotting Correlation Matrix on the new oversampled dataframe to see positive and negative correlations with respect to isgood label<\/b>","d168d8cb":"<b style = 'font-size :16px'>Lets create features and labels. <\/b>","0237135c":"<b style='font-size:16px'>Understanding the Data<\/b>"}}