{"cell_type":{"67ce217e":"code","3459f073":"code","8d616028":"code","b18fb2b1":"code","4fee4be0":"code","4cdde7a7":"code","f989f07f":"code","266b3b5b":"code","d9b3768e":"code","c2063361":"code","481a351c":"code","74905d91":"code","dd9bbd6a":"code","4fd8de0f":"code","3d4ef343":"code","5a3b4b0b":"code","cd0fc45a":"code","f7522451":"code","8dad0a0d":"markdown","4a7be45c":"markdown","9ff11419":"markdown","6de34d5b":"markdown","f49619e9":"markdown","9582cd42":"markdown","10a85ff0":"markdown","33c46868":"markdown","bfc57c69":"markdown","26ba2d0f":"markdown","88419091":"markdown","e7873d62":"markdown"},"source":{"67ce217e":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","3459f073":"import pandas as pd\ndata = pd.read_csv(\"..\/input\/hotel-booking-demand\/hotel_bookings.csv\")","8d616028":"print(data.head(5))","b18fb2b1":"print(list(data.columns))","4fee4be0":"print(\"hotel type \", data['hotel'].unique())\nprint(\"hotel value counts \",data['hotel'].value_counts())\nprint(\"Reservation status \",data['reservation_status'].unique())\nprint(\"Reservation value counts \",data['reservation_status'].value_counts())\nprint(\"meal type \", data['meal'].unique())","4cdde7a7":"data.describe()","f989f07f":"data.info()","266b3b5b":"data = data.drop(['country', 'company', 'agent'], axis=1)\nprint(list(data.columns))","d9b3768e":"cancel_corr = data.corr()[\"is_canceled\"]\ncancel_corr.abs().sort_values(ascending=False) ","c2063361":"print(\"hotel-- \", data['hotel'].unique())\nprint(\"\\narrival_date_month-- \",data['arrival_date_month'].unique())\nprint(\"\\nmeal-- \", data['meal'].unique())                         \nprint(\"\\nmarket_segment-- \", data['market_segment'].unique())                   \nprint(\"\\ndistribution_channel--  \", data['distribution_channel'].unique())\nprint(\"\\nreserved_room_type--  \", data['reserved_room_type'].unique())\nprint(\"\\nassigned_room_type--  \", data['assigned_room_type'].unique())\nprint(\"\\ndeposit_type--  \", data['deposit_type'].unique())\nprint(\"\\ncustomer_type--  \", data['customer_type'].unique())\nprint(\"\\nreservation_status--  \", data['reservation_status'].unique())\nprint(\"\\nreservation_status_date--  \", data['reservation_status_date'].unique())","481a351c":"# Import label encoder \nfrom sklearn import preprocessing \n# label_encoder object knows how to understand word labels. \nL_Encoder = preprocessing.LabelEncoder() \n\n# applyting label encoder on the hotel types \ndata['hotel'] = L_Encoder.fit_transform(data['hotel'])\n# on meal options\ndata['meal'] = L_Encoder.fit_transform(data['meal'])\n# on market segement\ndata['market_segment'] = L_Encoder.fit_transform(data['market_segment'])\n# on distribution_channel\ndata['distribution_channel'] = L_Encoder.fit_transform(data['distribution_channel'])\n# on reserved_room_type\ndata['reserved_room_type'] = L_Encoder.fit_transform(data['reserved_room_type'])\n# assigned_room_type\ndata['assigned_room_type'] = L_Encoder.fit_transform(data['assigned_room_type'])\n# deposit_type\ndata['deposit_type'] = L_Encoder.fit_transform(data['deposit_type'])\n# customer_type\ndata['customer_type'] = L_Encoder.fit_transform(data['customer_type'])\n# reservation_status\ndata['reservation_status'] = L_Encoder.fit_transform(data['reservation_status'])","74905d91":"# manually encoding the arrival date\ndata['arrival_date_month']=data['arrival_date_month'].map({'January':1, 'February': 2, 'March':3, 'April':4, 'May':5, 'June':6, 'July':7,'August':8, 'September':9, 'October':10, 'November':11, 'December':12})\nprint(data['arrival_date_month'])","dd9bbd6a":"print(data.info())","4fd8de0f":"# dropping reservation status\ndata = data.drop(['reservation_status_date'], axis = 1)\n# dropping all the rows with NA values\ndata = data.dropna(axis = 0)","3d4ef343":"# Make X and y vectors for the modeling\nX = data.drop(['previous_cancellations'], axis = 1)\ny = data['previous_cancellations']\n# import all the necessary packages \nfrom sklearn.model_selection import train_test_split \nfrom sklearn.linear_model import LinearRegression, LogisticRegression,Ridge, Lasso\n#\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=0)\n#\nregressor = LinearRegression()  \nregressor.fit(X_train, y_train) #training the algorithm\ny_pred = regressor.predict(X_test) #predicting the cancellations\n#\n","5a3b4b0b":"from sklearn import metrics\nimport numpy as np\n# the error rate in predictions using Linear Regression\nprint(np.sqrt(metrics.mean_squared_error(y_test, y_pred)))\nprint(metrics.mean_squared_error(y_test, y_pred))\nprint(metrics.mean_absolute_error(y_test, y_pred))","cd0fc45a":"regressor = LogisticRegression(random_state=0,solver = 'lbfgs')  \nregressor.fit(X_train, y_train) #training the algorithm\ny_pred = regressor.predict(X_test) #predicting the cancellations\n","f7522451":"# the error rate in predictions using Logistics Regression\nprint(np.sqrt(metrics.mean_squared_error(y_test, y_pred)))\nprint(metrics.mean_squared_error(y_test, y_pred))\nprint(metrics.mean_absolute_error(y_test, y_pred))","8dad0a0d":"test the realiability of predicted cancellations.","4a7be45c":"As we see here, there are columns which has null values such as 'country', 'company', 'agent', 'children'. So let's remove these columns from the data at the moment, except 'children'.","9ff11419":"Data has 32 columns where there are two type of hotels \n1. Resort hotel \n2. City hotel\narrival time of guests is given in terms of year, month, week number, day of month, in different columns. \nGuests stay \n","6de34d5b":"**Problem Formulation -- **\n\nFor hotel, predicting if the guest is going to cancel the reservation or not will be helpful. So let's see how does the various field correlate with the 'is_canceled' column.","f49619e9":"Let's try to reduce the mean square error by using Logistic regression.","9582cd42":"Load data below","10a85ff0":"Looking at the correlations, we can ignore the least correlated columns. But, let's keep all the columns at the moment. \nBut before predicting the cancelations, we need to transform the categorical columns. For that, we will use 'LabelEncoder'.","33c46868":"Print the data content (5 top rows). ","bfc57c69":"Also, printing the list of columns in the data.","26ba2d0f":"Let's check the categorical columns, first.","88419091":"Normalizing the data is another necessary step. But we are not applying here at the moment.\n\nLet's prepare for the prediction of 'is_canceled'.","e7873d62":"Scanning through the unique values of columns.\n"}}