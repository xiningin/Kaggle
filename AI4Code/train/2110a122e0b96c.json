{"cell_type":{"0f497b4d":"code","f8763cb4":"code","82569f8a":"code","b6c56d60":"code","c23d854b":"code","22567502":"code","d280b36e":"code","83f57e6d":"code","6558f2cf":"code","a22513c7":"code","a52b0343":"code","486e404f":"code","42a6677b":"code","6a8b4a1b":"code","bfcfa054":"code","2e93edd1":"code","ceb1c973":"code","e50a819f":"code","b7c4f61a":"code","846e8a19":"code","bad196df":"code","9307fd06":"code","61fd4ea1":"code","9d5c0ceb":"code","9baefe6b":"code","471bdc31":"code","0d5d020e":"code","2f85e582":"code","c6eaa5d0":"code","a4212a83":"code","3f7e8d1e":"code","ff245ebb":"code","b21758e1":"code","2a9a2e99":"code","e375d535":"code","1878f256":"code","add26d5f":"code","4680041c":"code","9160763e":"code","39c9e899":"code","5c004627":"code","df01dcd9":"code","92134793":"code","02c5ffd3":"code","6fe93eb5":"code","304d4f72":"code","63a4268d":"code","7c8064e7":"code","3b518149":"code","14a90d72":"code","1cf53813":"code","0a0ba486":"code","6f912592":"code","b091b971":"code","880636e6":"markdown","a73d9c6a":"markdown","67735c5c":"markdown","af3c15d6":"markdown","012ee662":"markdown","8ecf905d":"markdown","a1f88625":"markdown","3fdc4024":"markdown","3d574443":"markdown","7d1a92f5":"markdown","627b7085":"markdown","b1577e61":"markdown","032cd29a":"markdown","19b5fca2":"markdown","f940d3d0":"markdown","bded6546":"markdown","dda9f77a":"markdown"},"source":{"0f497b4d":"import pandas as pd\nimport numpy as np\nimport missingno as msno\nimport seaborn as sns\n\npd.set_option(\"display.max_colwidth\",500)\npd.set_option(\"display.max_rows\",500)\nfrom pandasql import sqldf\npsql = lambda q: sqldf(q, globals())","f8763cb4":"df=pd.read_csv(\"..\/input\/cheapest-electric-cars\/Cheapestelectriccars-EVDatabase.csv\")","82569f8a":"df.shape","b6c56d60":"df.head()","c23d854b":"df.info()","22567502":"df.Name.nunique()","d280b36e":"df['UID'] = df['Name'] +df['Subtitle']\nlen(df['UID'].unique())","83f57e6d":"df.UID.value_counts()","6558f2cf":"df[df.UID.isin(['Hyundai Kona Electric 64 kWhBattery Electric Vehicle |       64 kWh',\n                'Audi e-tron 55 quattroBattery Electric Vehicle |       86.5 kWh'\n               ,'Kia e-Soul 64 kWhBattery Electric Vehicle |       64 kWh'\n               ,'Audi e-tron Sportback 55 quattroBattery Electric Vehicle |       86.5 kWh'\n               ])].sort_values(by='Name')","a22513c7":"df['PriceinUK'] = df.PriceinUK.str.split('\u00a3',expand=True)[1]\ndf['PriceinUK'] =df.PriceinUK.str.replace(',','').astype('float32')\ndf['PriceinGermany'] = df.PriceinGermany.str.split('\u20ac',expand=True)[1]\ndf['PriceinGermany'] =df.PriceinGermany.str.replace(',','').astype('float32')","a52b0343":"df=psql(\"\"\"\n            Select UID, Name, Subtitle, Acceleration, TopSpeed,\n            Range, Efficiency, \"FastChargeSpeed\", Drive,\n            NumberofSeats, max(cast(PriceinGermany as int)) as PriceinGermany,\n            max(cast(PriceinUK as int)) as PriceinUK\n            from df\n            group by 1,2,3,4,5,6,7,8,9,10\n    \"\"\")","486e404f":"df[df.UID.isin(['Hyundai Kona Electric 64 kWhBattery Electric Vehicle |       64 kWh',\n                'Audi e-tron 55 quattroBattery Electric Vehicle |       86.5 kWh'\n               ,'Kia e-Soul 64 kWhBattery Electric Vehicle |       64 kWh'\n               ,'Audi e-tron Sportback 55 quattroBattery Electric Vehicle |       86.5 kWh'\n               ])].sort_values(by='Name')","42a6677b":"df.Drive.unique()","6a8b4a1b":"df.FastChargeSpeed.unique()","bfcfa054":"df.UID.nunique()","2e93edd1":"df.shape","ceb1c973":"df['Battery Capacity'] = df.Subtitle.str.split('|',expand=True)[1]\ndf['Battery Capacity'] = df['Battery Capacity'].str.strip().str.split(' ',expand=True)[0]\ndf['Battery Capacity'] = df['Battery Capacity'].astype('float32').round(2)\ndf['Brand_Name']=df['Name'].str.split(' ',expand=True)[0]\ndf['Acceleration']=df['Acceleration'].str.split(' ',expand=True)[0].astype('float32')\ndf['TopSpeed']=df['TopSpeed'].str.split(' ',expand=True)[0].astype('float32')\ndf['Range']=df['Range'].str.split(' ',expand=True)[0].astype('float32')\ndf['Efficiency']=df['Efficiency'].str.split(' ',expand=True)[0].astype('float32')\ndf['FastChargeSpeed']=pd.to_numeric(df['FastChargeSpeed'].str.split(' ',expand=True)[0],errors='coerce')\n","e50a819f":"df.info()","b7c4f61a":"df.head(100)","846e8a19":"df.columns","bad196df":"df=df[[ 'UID','Name','Brand_Name','Battery Capacity','Acceleration', 'TopSpeed', 'Range', 'Efficiency',\n       'FastChargeSpeed', 'Drive', 'NumberofSeats', 'PriceinGermany',\n       'PriceinUK']]","9307fd06":"df.head()","61fd4ea1":"msno.matrix(df)","9d5c0ceb":"#Deleting Rows without a Price variable\ndf=df[(df.PriceinGermany.notnull()) | (df.PriceinUK.notnull())]","9baefe6b":"df.shape","471bdc31":"msno.matrix(df)","0d5d020e":"#Missing values in Fastcharge mean No fastcharging ports. Assigning 0 value to it will provide an appropriate numeric value to it\ndf.FastChargeSpeed =df.FastChargeSpeed.fillna(0)","2f85e582":"df.corr()","c6eaa5d0":"sns.heatmap(abs(df.corr()),cmap=sns.diverging_palette(10, 220, s=60, as_cmap=True))","a4212a83":"sns.heatmap(abs(df.corr())>0.8,cmap='Blues')","3f7e8d1e":"df_Acceleration = df.Acceleration\ndf=df.drop(columns=['Acceleration','Battery Capacity'])\ndf.head()","ff245ebb":"sns.heatmap(abs(df.corr()),cmap=sns.diverging_palette(10, 220, s=60, as_cmap=True),annot=True)","b21758e1":"import matplotlib.pyplot as plt","2a9a2e99":"g = sns.PairGrid(df, diag_sharey=False)\ng.map_upper(sns.scatterplot)\ng.map_lower(sns.kdeplot)\ng.map_diag(sns.histplot)","e375d535":"fig,ax = plt.subplots(1,2,figsize=(12,3),sharey=True)\nsns.heatmap(df.pivot_table('PriceinGermany','Drive','NumberofSeats',aggfunc='count'),cmap='Blues',annot=True,ax=ax[0],cbar=False,)\nax[0].title.set_text('German EV Distribution')\nsns.heatmap(df.pivot_table('PriceinUK','Drive','NumberofSeats',aggfunc='count'),cmap='Blues',annot=True,ax=ax[1],vmax=42,)\nax[1].title.set_text('UK EV Distribution')\nplt.plot()","1878f256":"#import matplotlib.pyplot as plt\n#fig,ax[9] = plt.subplot(333)\n\n\nsns.catplot(data=df,y='PriceinGermany',x='Drive',col='NumberofSeats',kind='box',height=7,aspect=0.7,palette='Set2')\n            #fig.plot()\nsns.catplot(data=df,y='PriceinUK',x='Drive',col='NumberofSeats',kind='box',height=7,aspect=0.7,palette='Set2')\n            #fig.plot()\n","add26d5f":"df.head()","4680041c":"df_Germany = df.drop(columns='PriceinUK').dropna()\ndf_Germany['Country'] = 'Germany'\ndf_Germany.rename(columns={'PriceinGermany':'Price'},inplace=True)\n\ndf_UK = df.drop(columns='PriceinGermany').dropna()\ndf_UK['Country'] = 'UK'\ndf_UK.rename(columns={'PriceinUK':'Price'},inplace=True)","9160763e":"print(df_Germany.shape)\nprint(df_UK.shape)","39c9e899":"df_box= pd.DataFrame(columns=['Brand_Name','Country','Price'])\ndf_box =df_box.append(df_UK[['Brand_Name','Country','Price']])\ndf_box =df_box.append(df_Germany[['Brand_Name','Country','Price']])\ndf_box = df_box.sort_values(by='Price' ,ascending=False)","5c004627":"df_box.info()","df01dcd9":"df_box=df_box.groupby(by='Brand_Name').filter(lambda x: len(x) >10)","92134793":"\nf,ax= plt.subplots(1,1,figsize=(10,30),sharey=True)\nsns.boxplot('Price','Brand_Name',data=df_box,hue='Country',ax=ax,palette='Set3')","02c5ffd3":"df.head()","6fe93eb5":"#sns.scatterplot(data=df,x='Efficiency',y='PriceinUK')\nsns.regplot(data=df,x='Efficiency',y='PriceinUK',)","304d4f72":"import statsmodels.formula.api as smf","63a4268d":"summaryU = smf.ols('PriceinUK ~ Efficiency', data = df).fit().summary()\nsummaryG = smf.ols('PriceinGermany ~ Efficiency', data = df).fit().summary()","7c8064e7":"print(smf.ols('PriceinUK ~ Efficiency', data = df,).fit().summary())","3b518149":"from sklearn.linear_model import LinearRegression","14a90d72":"dfUK=df[df.PriceinUK.notnull()]\ndfDE=df[df.PriceinGermany.notnull()]","1cf53813":"modelUK=LinearRegression()\nmodelDE=LinearRegression()\n\nmodelUK.fit(X=dfUK.Efficiency.to_numpy().reshape(-1,1),y=dfUK.PriceinUK.to_numpy().reshape(-1,1))\nmodelDE.fit(X=dfDE.Efficiency.to_numpy().reshape(-1,1),y=dfDE.PriceinGermany.to_numpy().reshape(-1,1))","0a0ba486":"modelUK.rank_","6f912592":"import matplotlib.pyplot as plt\n\nf = plt.figure(figsize=(10,10))\nax1 = f.add_subplot(2,2,1)\np1 = sns.regplot(data=df,x='Efficiency',y='PriceinUK',ax=ax1)\nax2 = f.add_subplot(2,2,2)\np2 = sns.regplot(data=df,x='Efficiency',y='PriceinGermany',ax=ax2)\n\n","b091b971":"g=sns.PairGrid(data=dfUK,height=2,aspect=1)\ng.map_upper(sns.scatterplot, linewidths = 1, edgecolor = 'w', s = 10, alpha = 0.5)\ng.map_diag(plt.hist)\ng.map_lower(sns.kdeplot,shade=True)","880636e6":"Germans have significantly higher options in Front Wheel Drive 7 Seater market compared to UK, Otherwise the distribution is pretty similar","a73d9c6a":"## Understanding the columns","67735c5c":"### Correlation","af3c15d6":"## Visual Exploration","012ee662":"## Loading Data","8ecf905d":"<font color='blue'>Comments <\/font>\n<br> The data is not unique at Name-Subtitle Level.<br>\n       ","a1f88625":"<font color='blue'> Comments <\/font><br>\n    <li>Battery Capacity is correlated with Range. Range is a more relevant metric than Capacity <\/li>\n    <li>Top Speed is highly correlated (negatively) with Acceleration. We will be keeping TopSpeed variable as predictive power of TopSpeed is higher than Acceleration, which we can conclude from looking at the correlational coefficients wrt Price variables<\/li>\n    <li>Price in UK and Germany are correlated, which is alright as we will be training different models for the 2 Price variables<\/li>\n    <li> TopSpeed is highly correlated with PriceinUK, but not with PriceinGermany. This depicts the preference of UK consumers to faster cars.<br>\n    We should keep the TopSpeed variable unless we see overfitting","3fdc4024":"### Removing the units from metrics to get a numeric column","3d574443":"<font size=5>The data is unique at Name-Subtitle Level","7d1a92f5":"<font color='blue'>Comments <\/font>\n<br> The German and UK prices have been recorded in different rows<br>\nWe must combine these rows to reduce nulls and have a cleaner dataset       ","627b7085":"### Null Treatment","b1577e61":"### Transforming the dataset to be unique at Name-Subtitle level","032cd29a":"## Data Cleaning","19b5fca2":"## Data Exploration","f940d3d0":"<li> The variance in price range in Germany and UK is similar for high end cars<\/li>\n<li> The low and medium end cars are on average more expensive in Germany<\/li>\n","bded6546":"## Loading Libraries","dda9f77a":"<font color='blue'> Comments <\/font><br>\n<li>The Most expensive electric cars are 4 seater, All wheel drives and have the widest range of price options<\/li>\n<li>Cheapest Electric Cars are 2 Seater Rear wheel drives<\/li>\n<li>Most of the Price distributions are right skewed"}}