{"cell_type":{"d84c573a":"code","d32d83c6":"code","f8f92576":"code","58725e06":"code","70c420a9":"code","447fed4b":"code","aac3de82":"code","99ac4f02":"code","f2024e2a":"code","e3c76b9e":"code","19b59e42":"code","12868957":"markdown","fade0f23":"markdown","c5d4c664":"markdown","2be368c5":"markdown","e2c9cadb":"markdown"},"source":{"d84c573a":"!pip install --upgrade -q fastai wwf timm","d32d83c6":"from fastai.vision.all import *\nfrom wwf.vision.timm import *","f8f92576":"path = Path('\/kaggle\/input\/10-monkey-species')\npath.ls()","58725e06":"labels = pd.read_csv(path\/'monkey_labels.txt', sep=' *, *') \nlabels.head()","70c420a9":"lbl_dict = dict(zip(labels.iloc[:, 0], labels.iloc[:, 2])); lbl_dict","447fed4b":"bs = 64\nitem_tfms = Resize(300)\nbatch_tfms = [*aug_transforms(size=224), Normalize.from_stats(*imagenet_stats)]","aac3de82":"db = DataBlock(\n    blocks=(ImageBlock, CategoryBlock),\n    get_items=get_image_files,\n    splitter=GrandparentSplitter(train_name='training', valid_name='validation'),\n    get_y=Pipeline([parent_label, lbl_dict.__getitem__]),\n    item_tfms=item_tfms,\n    batch_tfms=batch_tfms,\n)","99ac4f02":"dls = db.dataloaders(path, bs=bs)\ndls.show_batch()","f2024e2a":"learn = timm_learner(dls, 'efficientnet_b0', metrics=accuracy)","e3c76b9e":"learn.lr_find()","19b59e42":"learn.fine_tune(6, 2e-2)","12868957":"# Loading data","fade0f23":"# Importing libraries\n- This notebook introduces the easiest way to use **EfficientNet** or any other external models from `timm` in `fastai`\n- Reference: https:\/\/walkwithfastai.com\/vision.external.timm","c5d4c664":"# Preparing data","2be368c5":"# Training","e2c9cadb":"Let's try using `EfficientNetB0`. "}}