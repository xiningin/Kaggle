{"cell_type":{"3a21fbf5":"code","6c8d5508":"code","7be564f3":"code","029576c5":"code","225842e6":"code","367050bf":"code","d9617c1a":"code","b0cdb579":"code","764a3311":"markdown","85781065":"markdown","f9303c8c":"markdown","52be8718":"markdown","46475620":"markdown","f1d3e470":"markdown","b5a8fbfc":"markdown","b9429ec0":"markdown"},"source":{"3a21fbf5":"# Importing libs and data file names\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\npd.set_option('display.max_rows', 500)\npd.set_option('display.max_columns', 500)\npd.set_option('display.width', 100000)\npd.set_option(\"display.precision\", 6)\nfrom matplotlib import pyplot as plt\nimport pickle\nimport os\n# for dirname, _, filenames in os.walk('\/kaggle\/input'):\n#     for filename in filenames:\n#         print(os.path.join(dirname, filename))\n\n# load and consolidate the data\nfiles = ['kucoin','binance','unknown','binanceUS','kraken']\ntransactions = pd.DataFrame()\nfor file in files:\n    temp = pd.read_csv('..\/input\/nano-transaction-data\/history_nano_' + file + '.csv',sep=';')\n    temp['exchange'] = file\n    transactions = transactions.append(temp)\n\ntransactions = transactions.reset_index(drop=True)\ntransactions = transactions.rename(columns={\"NANO\":\"nano\"})\ntransactions.head()","6c8d5508":"# lets start off by looking thru each exchange and see what we can learn\n# this plots each exchanges aggregate hot wallet balance across transaction history by blockheight\nplt_x,plt_y = 0,0\nplt.figure(figsize=(20,10))\nfor file in files:\n    temp = transactions.loc[transactions.exchange == file].reset_index(drop=True)\n    temp = temp.sort_values(by=['blockheight'], ascending=True).reset_index(drop=True)\n    temp['acc'] = temp['nano'].expanding().sum()\n    plt.subplot2grid((2, 3), (plt_x, plt_y))\n    temp['acc'].plot()\n    plt.xlabel('transactions', fontsize=12)\n    plt.ylabel('aggregate nano', fontsize=12)\n    plt.grid(True)\n    plt.title(file+' hot wallet', fontsize=14)\n    plt_x += 1\n    if plt_x>=2:\n        plt_x = 0\n        plt_y+= 1","7be564f3":"# this plots each exchanges aggregate hot wallet balance by timestamp, so we can see transaction spikes at various times\nplt_x,plt_y = 0,0\nplt.figure(figsize=(20,10))\nfor file in files:\n    temp = transactions.loc[(transactions.exchange == file) & (transactions.timestamp > 0)].reset_index(drop=True)\n    temp = temp.sort_values(by=['blockheight'], ascending=True).reset_index(drop=True)\n    temp['acc'] = temp['nano'].expanding().sum()\n    plt.subplot2grid((2, 3), (plt_x, plt_y))\n    plt.scatter(temp['timestamp'], temp['acc'],s=10)\n    plt.xlabel('timestamp', fontsize=12)\n    plt.ylabel('aggregate nano', fontsize=12)\n    plt.grid(True)\n    plt.title(file+' hot wallet', fontsize=14)\n    plt_x += 1\n    if plt_x >= 2:\n        plt_x = 0\n        plt_y += 1","029576c5":"# lets check the btc volatility at the time of the transaction spike between exchanges\nfilename = '..\/input\/nano-transaction-data\/binance_spot_BTCUSDT_1h_candles.pkl'\ntemp_btc = pickle.load(open(filename,\"rb\"))\ntemp_btc = temp_btc.loc[temp_btc.timestamp >= 1600000000]\n\n# btc hist returns\ntemp_btc['R-1'] = temp_btc['close'] \/ temp_btc['close'].shift() - 1\ntemp_btc['Vol-168'] = temp_btc['R-1'].rolling(window=168, min_periods=168).apply(lambda x: x.std()*(24*365)**0.5)\nplt.figure(figsize=(8,6))\nplt.xlabel('timestamp', fontsize=12)\nplt.ylabel('btc volatility', fontsize=12)\nplt.plot(temp_btc['timestamp'], temp_btc['Vol-168'])","225842e6":"# this plots the aggregate hot wallet balance across all 5 exchanges\ntemp = transactions.loc[(transactions.timestamp == 0)].reset_index(drop=True)\nnano_without_timestamp = temp['nano'].sum()\ntemp = transactions.loc[(transactions.timestamp > 0)].reset_index(drop=True)\ntemp = temp.sort_values(by=['timestamp','blockheight'], ascending=True).reset_index(drop=True)\ntemp.at[0,'nano'] += nano_without_timestamp\ntemp['acc'] = temp['nano'].expanding().sum()\nplt.figure(figsize=(8,6))\nplt.xlabel('all transactions', fontsize=12)\nplt.ylabel('aggregate nano', fontsize=12)\nplt.grid(True)\nplt.title('all hot wallets', fontsize=14)\ntemp['acc'].plot()","367050bf":"# let look at some stats on the send and receive transaction sizes across all hot wallets\ntemp = transactions.loc[(transactions.type == 'rece')].reset_index(drop=True)\nprint('All nano received by all 5 hot wallets',temp['nano'].sum())\nprint('Mean nano received',temp['nano'].mean())\nprint('Std nano received',temp['nano'].std())\nprint('---')\nplt.figure(figsize=(20,10))\nplt.subplot2grid((2, 3), (0, 0))\nplt.xlabel('all receive transactions', fontsize=12)\ntemp['nano'].hist(bins=50)\nplt.subplot2grid((2, 3), (0, 1))\nplt.xlabel('log of receive transactions > 1 nano', fontsize=12)\nnp.log(temp.loc[temp.nano>1,'nano']).hist(bins=50)\nplt.subplot2grid((2, 3), (0, 2))\nplt.xlabel('receive transactions <= 1 nano', fontsize=12)\ntemp.loc[temp.nano<=1,'nano'].hist(bins=50)\n\ntemp = transactions.loc[(transactions.type == 'send')].reset_index(drop=True)\nprint('All nano sent by all 5 hot wallets',temp['nano'].sum())\nprint('Mean nano sent',temp['nano'].mean())\nprint('Std nano sent',temp['nano'].std())\nplt.subplot2grid((2, 3), (1, 0))\nplt.xlabel('all send transactions', fontsize=12)\n(temp['nano']*-1).hist(bins=50)\nplt.subplot2grid((2, 3), (1, 1))\nplt.xlabel('log of send transactions > 1 nano', fontsize=12)\nnp.log(abs(temp.loc[temp.nano<-1,'nano'])).hist(bins=50)\nplt.subplot2grid((2, 3), (1, 2))\nplt.xlabel('send transactions <= 1 nano', fontsize=12)\n(temp.loc[temp.nano>=-1,'nano']*-1).hist(bins=50)","d9617c1a":"# here we look at the most active addresses as counterparty to the exchange hot wallet per exchange\n# there are clearly arbitragers between Binance and BinanceUS\/Kraken\nfor file in files:\n    temp = transactions.loc[transactions.exchange == file].reset_index(drop=True)\n    print('Top wallets by transactions with exchange - ',file)\n    print(temp['counterparty'].value_counts()[0:3])\n    print('---')","b0cdb579":"# here we dig into the top 2 addresses on Binance and look at their activity on other hot wallets\n# Binance to BinanceUS\/Kraken arbitrager\nprint('Address','nano_1pndfqtkxb1ob1dgeszus9jcswj4xzt8z5q6ueopdrsbphrpnjsaas9hk86e')\nfor file in files:\n    temp = transactions.loc[transactions.exchange == file].reset_index(drop=True)\n    temp = temp.loc[temp.counterparty == 'nano_1pndfqtkxb1ob1dgeszus9jcswj4xzt8z5q6ueopdrsbphrpnjsaas9hk86e']\n    print('Transactions on '+str(file),len(temp),'Received total:',temp.loc[temp.type=='rece','nano'].sum(),'Send total:',temp.loc[temp.type=='send','nano'].sum())\nprint('---')\n# Binance to BinanceUS\/Kraken arbitrager\nprint('Address','nano_1ii4fk6r9puzkzppc3j91zoxndofx8h3h4g4jefuiqhbbwxakbw3s51prz1h')\nfor file in files:\n    temp = transactions.loc[transactions.exchange == file].reset_index(drop=True)\n    temp = temp.loc[temp.counterparty == 'nano_1ii4fk6r9puzkzppc3j91zoxndofx8h3h4g4jefuiqhbbwxakbw3s51prz1h']\n    print('Transactions on '+str(file),len(temp),'Received total:',temp.loc[temp.type=='rece','nano'].sum(),'Send total:',temp.loc[temp.type=='send','nano'].sum())","764a3311":"**10-12-2020**\n\nIn this workbook we explore the Nano onchain\/onlattice transactions for the hot wallets of the top 5 exchanges. These exchanges are Binance, BinanceUS, Kraken, Kucoin, and an Unknown exchange which I believe to be Okex. This is simply a data exploration exercise.\n\nThe onchain\/onlattice data was collected from http:\/\/nanex.cc\/history ... credit here goes to u\/renesq which you can find on reddit. The historic pricing data on BTCUSDT was pulled directly from the Binance.com api.","85781065":"Key points\n* Notice the vertical line on the unknown exchange\/BinanceUS\/Kraken... indicating many transactions on the hot wallet roughly over the same period. This was likely alot of arbitrage being done when the mkt got dislocated in the recent rally\n* Kucoin might not have realised these opportunities given that withdrawals were locked post the hack, hence no movements in or out\n* The large horizontal gaps are likely to be points when no arbitrage opportunities existed, hence no reason to move coins between exchanges","f9303c8c":"Key points\n* For address nano_1pndfq*** its easy to see that a common deposit address is being used on Binance for withdrawals on BinanceUS and Kraken\n* For address nano_1ii4fk*** we see the same with a common kraken address used for deposits for withdrawals from Binance and BinanceUS\n* Overall these arbitragers are likely positive for the market because they maintain activity on the network, keep prices between exchanges alligned, and provide much need liquidity\n\nThis concludes the data exploration... thanks for reading","52be8718":"Key points\n* Net there has been an increase of nano sitting on exchange hot wallets roughly in the region of 11mil nano\n* Over the full history, these 5 hot wallets have turned over more than 200mil nano in receives and sends as compared to the 133mil supply \n* On the graphs above, both the top left and bottom left histograms show that nano transactions are incredibly skewed... i.e. there are many many more small transactions than large transaction on these hot wallet. Its interesting because thats what nano is best known for given its instant and feeless when used p2p.\n* Taking the log of both the receive and send transactions gives us the middle histograms, roughly a similar shape\n* Lastly the top right and bottom right historgrams look at transactions between 0-1 nano","46475620":"Key points\n* Ignoring the onceoff decrease which was binance moving a large chunk of nano into cold storage, the overall trend has been more nano sitting in exchange hot wallets which isnt great. After the big move into cold storage, the upward trend continues\n* Ideally we would like to see the hot wallet balances decreasing over time and nano being pulled out of cold storage on the exchanges to meet this demand\n* Recall also that nano on exchanges allows for borrowing and margin trading i.e. it allows traders to short nano. The less nano on exchanges the less script\/borrow is available for traders to short, so removing nano from exchanges can actually help the price over the longer term, not to mention further helping decentralisation by using other representatives","f1d3e470":"Key points\n* Notice that the top 2 addresses on Binance can also be found on BinanceUS and Kraken, showing a potential arbitrager\n* We can find similar highly active addresses on Kucoin","b5a8fbfc":"Key points\n* It appears as if the US exchanges (Kraken\/BinanceUS) are accumulating nano from the Asian exchanges (Binance\/Kucoin)\n* The Binance chart is on a different scale to the other 4 (1m vs 100k)\n* At its peak Binance held almost 30mil nano in its hot wallet out of a total supply of roughly 133mil\n* The large drop on the Binance chart is when they moved roughly 25mil nano into cold storage, the cold storage addreses can be found here - https:\/\/nano-faucet.org\/rich-list\/\n* The weird jagged pattern on Kucoin may be the result of arbitrage i.e. points in time when nano trades at a premium\/discount on Kucoin vs Binance\n","b9429ec0":"Key points\n* Clearly the BTC volatility spike alligns with the increase in nano transaction between the hot wallets above, indicated increased arbitrage opportunities\n* We really should do this specifically for nano prices but BTC above can act as a rough proxy"}}