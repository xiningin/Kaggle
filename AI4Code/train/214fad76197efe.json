{"cell_type":{"6fa2b4d3":"code","ebf07e4d":"code","154fe445":"code","aebd1651":"code","ce16e465":"code","c171e50b":"code","2f35c0b3":"markdown","ca71a0fc":"markdown","69f0070e":"markdown","99c3570c":"markdown"},"source":{"6fa2b4d3":"import tensorflow as tf # This is how we import tf","ebf07e4d":"# Clear any logs from previous runs\n!rm -rf .\/logs\/ \n!mkdir .\/logs\/","154fe445":"# Download Ngrok to tunnel the tensorboard port to an external port\n!wget https:\/\/bin.equinox.io\/c\/4VmDzA7iaHb\/ngrok-stable-linux-amd64.zip\n!unzip ngrok-stable-linux-amd64.zip\n\n# Run tensorboard as well as Ngrox (for tunneling as non-blocking processes)\nimport os\nimport multiprocessing\n\n\npool = multiprocessing.Pool(processes = 10)\nresults_of_processes = [pool.apply_async(os.system, args=(cmd, ), callback = None )\n                        for cmd in [\n                        f\"tensorboard --logdir .\/logs\/ --host 0.0.0.0 --port 6006 &\",\n                        \".\/ngrok http 6006 &\"\n                        ]]","aebd1651":"! curl -s http:\/\/localhost:4040\/api\/tunnels | python3 -c \\\n    \"import sys, json; print(json.load(sys.stdin)['tunnels'][0]['public_url'])\"","ce16e465":"mnist = tf.keras.datasets.mnist\n\n(x_train, y_train),(x_test, y_test) = mnist.load_data()\nx_train, x_test = x_train \/ 255.0, x_test \/ 255.0\n\ndef create_model():\n  return tf.keras.models.Sequential([\n    tf.keras.layers.Flatten(input_shape=(28, 28)),\n    tf.keras.layers.Dense(512, activation='relu'),\n    tf.keras.layers.Dropout(0.2),\n    tf.keras.layers.Dense(10, activation='softmax')\n  ])","c171e50b":"import datetime\nmodel = create_model()\nmodel.compile(optimizer='adam',\n              loss='sparse_categorical_crossentropy',\n              metrics=['accuracy'])\n\nlog_dir = \"logs\/fit\/\" + datetime.datetime.now().strftime(\"%Y%m%d-%H%M%S\")\ntensorboard_callback = tf.keras.callbacks.TensorBoard(log_dir=log_dir, histogram_freq=1)\n\nmodel.fit(x=x_train, \n          y=y_train, \n          epochs=10, \n          validation_data=(x_test, y_test), \n          callbacks=[tensorboard_callback])","2f35c0b3":"# Get the url to access tensorboad\n## Note: This block of code might throw an error while running all blocks at time. So run blocks one by one till the block below.","ca71a0fc":"# Create and train model","69f0070e":"# Start Tensorboard","99c3570c":"# Tensorboard on Kaggle"}}