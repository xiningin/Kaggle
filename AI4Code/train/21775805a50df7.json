{"cell_type":{"5dfe427e":"code","6e5ddbb6":"code","6d68f18c":"code","97881319":"code","238dd8a0":"code","8d56fa50":"code","8bd32c0f":"code","a42a738b":"code","62447ca9":"code","426185d1":"code","6a9db91c":"code","b2c2f75b":"code","7dbae30e":"code","e0952d98":"code","00f647c2":"code","9eea1c63":"code","c0295927":"code","75999ab5":"code","eb4e4142":"code","89249029":"code","847a480a":"code","c33a6315":"code","af9da064":"code","8940b472":"code","7f400661":"code","20462432":"code","b3b2ca04":"code","1aa415db":"code","c2425ca4":"code","f5b323b5":"code","fd3c07bd":"code","f2c4732c":"code","59cd1bf6":"code","212f9126":"code","204d4b10":"code","8a2e0d8f":"code","926e50dd":"code","61f555ef":"code","d8316c2d":"code","bdbcbea0":"code","11d62ae7":"code","d0d9c9ba":"code","b6c37820":"code","cad33a35":"markdown","6ee669c6":"markdown","b44a1e6f":"markdown","1d135386":"markdown","cc72ae38":"markdown","7470fbac":"markdown","ebca28e4":"markdown","cbc4c46f":"markdown","fcf61cc1":"markdown","6b32d016":"markdown","d51bf150":"markdown","da9f25b3":"markdown","025205bd":"markdown","f9037833":"markdown","70596595":"markdown","5c235277":"markdown","e8098718":"markdown","19ba3385":"markdown","bc273064":"markdown","08235bf5":"markdown","a85205d9":"markdown","8dfcbbf7":"markdown","cea9e2ae":"markdown","236b2106":"markdown","4efa7632":"markdown","d1872dd0":"markdown","802c131c":"markdown","a3fcfa31":"markdown","e678032a":"markdown","0c40ad3b":"markdown","2ad5494a":"markdown"},"source":{"5dfe427e":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n        \nfrom matplotlib import cm\nfrom collections import OrderedDict\n\n# Any results you write to the current directory are saved as output.","6e5ddbb6":"# I like to keep a version of the original data set unchanged should I ever need to\n# look at it or compare to an edited dataset as I make changes\noriginal_df = pd.read_csv('\/kaggle\/input\/new-york-city-airbnb-open-data\/AB_NYC_2019.csv')\n\n# for cleaning purposes\ndf = pd.read_csv('\/kaggle\/input\/new-york-city-airbnb-open-data\/AB_NYC_2019.csv')","6d68f18c":"# Let's take a quick look at the dataset and get a feel for what we're working with.\n# Already I notice some missing values and am considering which columns may be dropped\n# for either redundancy or lack of relevance to our analysis\ndf.head()","97881319":"# Let's get more information on the number of rows (48,895), columns (16), and data types.\ndf.info()","238dd8a0":"df['room_type'].unique()\n# we find out that Airbnb rentals are classified as one of three distinct room types\n# Private room\n# Entire home\/ apartment\n# Shared Room","8d56fa50":"# let's do the same for neighborhood_group\ndf['neighbourhood_group'].unique()","8bd32c0f":"# Let's see which columns have missing values, the kinds of missing values they have, and how many.\ndf.isnull().sum()","a42a738b":"df.drop(['name','host_name','last_review'],axis = 1,inplace=True)\n\n# we now have 13 columns to work with\ndf.head()","62447ca9":"# Now to address the missing values from the 'reviews_per_month' page\ndf['reviews_per_month'].fillna(0,inplace=True)","426185d1":"# After addressing these four columns, let's verify that we don't have any \n# missing values left:\ndf.isnull().sum()","6a9db91c":"# rename the column using the rename() method\ndf.rename(columns = {'neighbourhood_group':'borough'}, inplace = True)\n# Let's verify the change\ndf.head()","b2c2f75b":"# Let's look at some statistics by the three kinds of room types available onn Airbnb\nby_room = df.groupby('room_type').agg(['count'])\nby_room.head()","7dbae30e":"by_room.index\n# this index call will come in handy in a barchart that separates values by room type. It will go on the x axis","e0952d98":"by_room['id']['count']\n# this count will go on our y axis","00f647c2":"sns.set_style('darkgrid')\n\nplt.rcParams['axes.axisbelow'] = True\nplt.grid(b=True,which ='major',axis='y')\nmy_colors =['g','b','m']\n\n# This is the primary code guiding the structure of the plot. Notice how we specified the values for both axes.\nplt.bar(x=by_room.index, height=by_room['id']['count'], color=my_colors, alpha=.7)\n\n# Label the data\nplt.xlabel('Type of Rental',color='r',fontsize=13)\nplt.ylabel('Number of Rentals',color='r',fontsize=13)\nplt.title('Airbnb Rentals by Room Type',color='r',fontsize='20',fontweight='bold')\n\n# I set the upper y limit to 30000 in order to get a little more room at the top of the plot. \n# Otherwise, it would be a little tight \nplt.ylim(0,30000)\n","9eea1c63":"# Next, let's see how the listings are distributed across the five boroughs\nby_borough = df.groupby('borough').agg(['count'])\nby_borough.head()","c0295927":"# Here I sorted the data from highest to lowest before plotting it below\nby_borough_sorted = by_borough['id']['count'].sort_values(ascending=False)\n","75999ab5":"sns.set_style('darkgrid')\n\nplt.grid(b=True,which ='major',axis='y')\nmy_colors =['g','b','m','c','y']\n\nplt.bar(x=by_borough.index,height=by_borough_sorted,color=my_colors,alpha=.7)\n\nplt.xlabel('Borough',color='r',fontsize=13)\nplt.ylabel('# of Airbnb Rentals',color='r',fontsize=13)\nplt.title('Airbnb Rentals by Borough',color='r',fontsize='20',fontweight='bold')\n\n# I reset the upper y limit here again\nplt.ylim(0,25000)","eb4e4142":"# It would be great to break things down by borough AND room type. There are several ways to do so.\n# A pivot table is a great place to start\nroom_pivot = pd.pivot_table(df,'price',['borough','room_type'],aggfunc=np.mean)\nroom_pivot","89249029":"# Let's prepare some data through indexing, grouping and sorting before we plot it\navg_by_borough = df.groupby(['borough']).mean()\navg_price_by_borough_sorted= avg_by_borough['price'].sort_values(ascending=False)\navg_price_by_borough_sorted","847a480a":"# Here I decided to state the colors ahead of time as a named list and pass that list when plotting the bar\nsns.set_style('darkgrid')\n\nle_colors =['g','b','m','r','y']\nplt.bar(x=avg_price_by_borough_sorted.index, height=avg_price_by_borough_sorted, color=le_colors)\n\nplt.title('Average Rental Price Across Boroughs',color='r',fontsize=15,fontweight='bold')\nplt.xlabel('Borough',color='r',fontsize=13)\nplt.ylabel('Average Price',color='r',fontsize=13)\nplt.ylim(0,250)\n\n# i want to add the values for the bars","c33a6315":"sns.set_style('darkgrid')\n\nbox_price = sns.boxplot(x='borough',y='price',data=df,palette='rainbow',showfliers=False)\nbox_price.set_title('Price Distribution Across Boroughs\\n'+'price < 500',fontsize=15,color='r', fontweight='bold')\nbox_price.set_ylabel('Price',color='r', fontsize=13)\nbox_price.set_xlabel('-- Borough --',color='r',fontsize=13)","af9da064":"bx_bar = list(room_pivot[0:3]['price'])\nbx_bar","8940b472":"bk_bar = list(room_pivot[3:6]['price'])\nbk_bar","7f400661":"man_bar = list(room_pivot[6:9]['price'])\nman_bar","20462432":"qns_bar = list(room_pivot[9:12]['price'])\nqns_bar","b3b2ca04":"si_bar = list(room_pivot[12:15]['price'])\nsi_bar","1aa415db":"sns.set_style('darkgrid')\n\nN = 5\nentire = list(room_pivot['price'][[0,3,6,9,12]])\n\nind = np.arange(N)  # the x locations for the groups\nwidth = .25       # the width of the bars\n\nfig, ax = plt.subplots(figsize=(10,7))\n\nrects1 = ax.bar(ind, entire, width, color='r')\n\n\nprivate = list(room_pivot['price'][[1,4,7,10,13]])\n\nrects2 = ax.bar(ind + width, private, width, color='y')\n\n\nshared = list(room_pivot['price'][[2,5,8,11,14]])\nrects3 = ax.bar(ind + width+width, shared, width, color='b')\n\n\n# add some text for labels, title and axes ticks\nax.set_title('Average Price by Room Type\\n'+'Across Boroughs',color='r',fontsize=15, fontweight='bold')\nax.set_ylabel('Price',color='r',fontsize=13)\nax.set_xlabel('-- Borough --',color='r',fontsize=13)\nax.set_xticks(ind + width \/ 2)\nax.set_xticklabels(('Bronx', 'Brooklyn', 'Manhattan', 'Queens', 'Staten Island'))\n\nax.legend((rects1[0], rects2[0], rects3[0]), ('Entire Home\/Apt', 'Private Room','Shared Room'))\n\n\ndef autolabel(rects):\n    \"\"\"\n    Attach a text label above each bar displaying its height\n    \"\"\"\n    for rect in rects:\n        height = rect.get_height()\n        ax.text(rect.get_x() + rect.get_width()\/2., 1.01*height,\n                '%d' % int(height),\n                ha='center', va='bottom')\n\nautolabel(rects1)\nautolabel(rects2)\nautolabel(rects3)\n\n#Let's reset the y-axis limits to give some buffer room for that \n#tall $249-priced column\nplt.ylim(0,300)\n\n\nplt.show()\n\n","c2425ca4":"df['availability_365'].head(10)\n# The column lists the amount of days that the listing was available for rental throughout the 2019 calendar yea","f5b323b5":"# One useful way of visualizing this would be to separate the values into ranges of days,\n# say into 4 groups as follows:\na_availability = df[df['availability_365']<=90].count()[0]\nb_availability = df[(df['availability_365']>90) & (df['availability_365']<=180)].count()[0]\nc_availability = df[(df['availability_365']>180) & (df['availability_365']<=270)].count()[0]\nd_availability = df[(df['availability_365']>270)].count()[0]","fd3c07bd":"# With our ranges created using indexing and '&' operators, the data can be plotted in a pie chart\n\nlabels = 'Less than 90 days','Between 90 & 180 days','Between 180 & 270 days','Greater than 270 days'\nsizes = a_availability,b_availability,c_availability,d_availability\nexplode = (.1,.1,.1,.1)\n\navailability_pie = plt.pie(sizes,labels=labels,explode=explode,shadow=True,startangle=90,autopct='%1.1f%%',radius=1.1)\nplt.title('Availability of Airbnb Rentals\\n'+'As a % of the Calendar Year 2019')\n","f2c4732c":"df['host_id'].value_counts().head(20)","59cd1bf6":"# As before, I find it mentally easier to first clarify what our x and y values will be: \na = df['host_id'].value_counts()\ntop_host_values = a[0:20]\ntop_host_index = a[0:20].index","212f9126":"host_chart = sns.barplot(y=top_host_values,x=top_host_index,order=top_host_index)\nsns.set_style('darkgrid')\nsns.set(rc={'figure.figsize':(7,7)})\n\n\n# the following line sets the contentn of the xtick labels and their rotation. \nhost_chart.set_xticklabels(host_chart.get_xticklabels(), rotation=55)\n\n\nhost_chart.set_title('Top Hosts Across New York City',color='r',fontsize=16,fontweight='bold')\nhost_chart.set_ylabel('Count of listings',color='r',fontsize=14)\nhost_chart.set_xlabel('Host IDs',color='r',fontsize=14)\nplt.ylim(0,350)","204d4b10":"# Let's plot the neighborhoods in nyc with the most listings\na = df['neighbourhood'].value_counts()\na","8a2e0d8f":"top_neighbourhood_values = a[0:10]\ntop_neighbourhood_values","926e50dd":"top_neighbourhood_index = a[0:10].index\ntop_neighbourhood_index","61f555ef":"# Finally, we'll use are pre-indexed x and y axis to create the plot\nsns.set_style('darkgrid')\nsns.set(rc={'figure.figsize':(7,5)})\n\n\nneighbourhood_chart = sns.barplot(y=top_neighbourhood_values,x=top_neighbourhood_index,order=top_neighbourhood_index,alpha=.8)\n\n# Because some of the neighborhood names were long, I found that setting the rotation less then 80 degrees distorted the position of the xtick labels. \nneighbourhood_chart.set_xticklabels(neighbourhood_chart.get_xticklabels(), rotation=85)\n\n\nneighbourhood_chart.set_title('Top Neighbourhoods Across New York City',color='r',fontsize=14,fontweight='bold')\nneighbourhood_chart.set_ylabel('Number of listings',color='r',fontsize=14)\nneighbourhood_chart.set_xlabel('Neighbourhood',color='r',fontsize=14)","d8316c2d":"# First, plot the entire dataset using the location coordinates on the x and y axis\ndf.plot(kind='scatter', x='longitude', y='latitude', label='availability_365', c='price',\n                  cmap=plt.get_cmap('jet'), colorbar=True, alpha=0.4, figsize=(10,8))","bdbcbea0":"price_plot = df[df.price < 500]\nprice_plot.plot(kind='scatter', x='longitude', y='latitude', label='availability_365', c='price',\n                  cmap=plt.get_cmap('jet'), colorbar=True, alpha=0.4, figsize=(10,8))","11d62ae7":"price_plot_500 = df[df.price > 500]\nprice_plot_500.plot(kind='scatter', x='longitude', y='latitude', label='availability_365', c='price',\n                  cmap=plt.get_cmap('jet'), colorbar=True, alpha=0.4, figsize=(10,8))","d0d9c9ba":"price_plot_manhattan = df[(df.price < 500) & (df.borough=='Manhattan')]\nprice_plot_manhattan.plot(kind='scatter', x='longitude', y='latitude', label='availability_365', c='price',\n                  cmap=plt.get_cmap('jet'), colorbar=True, alpha=0.4, figsize=(10,8))","b6c37820":"plt.figure(figsize=(10,10))\nsns.set_style('darkgrid')\nsns.scatterplot(df.longitude,df.latitude,hue=df.borough)\nplt.ioff()","cad33a35":"# ----- E N D -----","6ee669c6":"### Next, let's turn our attention to price distributions","b44a1e6f":"### With enough information on prices, let's explore other facets of the data. \n\n### Let's say that Airbnb wanted to know the availability of listings throughout the year. One column in particular will help.","1d135386":"### The following plot took me some time to figure out. Instead of only showing the code for the final plot, I've left several lines of code below that show several ways of extracting information through indexing, particularly using the pivot table from above. Read the code to figure out the thinking process and see how it plays into the final plot, which indexed things a little differently.","cc72ae38":"### Important note: I intentionally removed the outliers in the boxplot. Manhattan, for example, had many outliers that would have hurt the figure's visual appeal and usefulness. This will change depending on the context. ","7470fbac":"### The result is more visually appealing and allows one to compare it to the following image that only maps rentals with prices above $500. ","ebca28e4":"### Next, what if Airbnb wanted to get some data on the top ten or twenty hosts with the most listings over the 2019 calendar year? ","cbc4c46f":"### Let's begin with a few barplots that will help us visualize the quantity, kind and distribution of listings across New York City\n","fcf61cc1":"# **1. Upload the Data**","6b32d016":"### Finally, let's make use of the provided latitude and longitude coordinates.","d51bf150":"# 3. Cleaning the Data for Analysis","da9f25b3":"A total of four columns have missing values, but we don't have to adjust all of them:\n1. 'name'\n    Unless you'd like to do a text based analysis of the rental names, this column won't add too much to your analysis.  \n**Decision: DROP**\n2. 'host_name'\n    Here again, this column contains personal information and doesn't add much to our analysis. Even if for some reason we did need to use it, its use would be limited as in most cases only the first name is provided.   \n**Decision: DROP**    \n3. 'last_review'\n    Since these are all dates, a missing value most likely means that there has been no review for this rental. I won't be using this for any analysis or visualization.  \n    **Decision: Drop **   \n\n4. 'reviews_per_month'\n    We might be able to do some analysis with this. This is the kind of situation where own intuition supplements the analysis. In this column, missing values most likely do not mean that the data points were not recorded but that they don't exist, a contrast I've learned to appreciate when dealing with missing values.   \n**Decision: REPLACE missing values with 0's**  \n","025205bd":"### It's also possible to set an extra Boolean statement to narrow down to one borough.","f9037833":"# Hi all! \n### In this notebook I'll demonstrate a simple exploratory analysis of Airbnb Data for New York City through 2019. This dataset is very accessible and presents us with great opportunities to analyze and visualize the data. I welcome advice and comments from all!\n\n### Access the data set from the [Kaggle source page](https:\/\/www.kaggle.com\/dgomonov\/new-york-city-airbnb-open-data).\n\n### Before we dive in, a quick note on the data from the data source page:\n\n### Context  \n### Since 2008, guests and hosts have used Airbnb to expand on traveling possibilities and present more unique, personalized way of experiencing the world. This dataset describes the listing activity and metrics in NYC, NY for 2019.\n\n### Content  \n### This data file includes all needed information to find out more about hosts, geographical availability, necessary metrics to make predictions and draw conclusions.","70596595":"We can see that entire home\/apt and private rooms make up the bulk of the listed 2019 airbnb rentals","5c235277":"### The result is a bit overcrowded. We can decrease the density by limiting the image to prices less then a certain threshhold. ","e8098718":"I found this cleaning process refreshingly smooth. Now on to the next step.","19ba3385":"Let's begin!","bc273064":"## 3.1 Missing Values","08235bf5":"This information will be useful in many ways. Now, let's visualize it. ","a85205d9":"### Quick hack: If you don't know how to make a plot, find an example and reverse engineer it. Here, I grabbed an example from the Matplotlib documentation and applied it to the data.","8dfcbbf7":"### I hope you've enjoyed this guide. There's always more to learn and each person will approach a given dataset from a different angle. I hope you found this walkthrough helpful.\n\n### #fortheloveofdatascience\n\nSergio A. Galeano","cea9e2ae":"## 3.2 Renaming Columns\nThe thirteen remaining columns will be easy to work with.  \n\nOne thing I would like to do is rename the neighborhood_group column, which actually corresponds to what is known in New York as the five boroughs. As I'm a native New Yorker, this is a personal choice :)","236b2106":"### Note: You can also download and import a background of New York City or a specific borough that matches your image size (you can configure the size easily).\n\n### You can also reset the image to show the locations of all listings, and instead of showing price variations, just label the points by borough.","4efa7632":"### As expected from previous price visualizations, the points are concentrated in Manhattan with the second most points across the river in Brooklyn. ","d1872dd0":"### While pie charts don't tell us specific numbers, they're good at capturing the overall percentages. Here, we see that nearly 60% of Airbnb listings are available for less then a quarter of the year.\n\n(Quick note: Because of the way I created the four ranges, the 4th range, \"Greater   than 270 days\" has five more days then the other ranges since there are 365 days in the year. )","802c131c":"# 4. Explore & Visualize the Data\n*Quick Notes*:   \n1. For larger and more complex datasets, these steps would be more clearly divided. Given the accessibility and modest size of this dataset, my intution was that these steps could be done together. \n2. Everyone approaches a dataset from a different angle and for different purposes. While a few questions may be commonplace, your curiosity may take you in different directions. The following presents only one set of analysis and visualizations. Feel free to follow your curiousity and questions as well.\n","a3fcfa31":"# 2. Quick Look & Assessment of the Data","e678032a":"Further, we've got four columns that provide information based on location:\n* neighborhood_group\n* neighborhood\n* latitude \n* longitude  \n\nWe'll deal with the first two in a bit. Latitude and longitude will be best utilized for some fun geolocation visualization towards the end.\n\n\n\n","0c40ad3b":"### Let's say that this wasn't enough and we wanted a more detailed breakdown of rental price distribution across the boroughs.   A boxplot proves mighty useful.","2ad5494a":"### Similarly, what if Airbnb wanted to find what the top ten most popular neighborhoods for rentals are across New York City?"}}