{"cell_type":{"7c4bbf91":"code","c7c71f77":"code","75ccd4d1":"code","73b01952":"code","7ac3225b":"code","6948e2d4":"code","f695f4a3":"code","e6c1e595":"code","f35cfc3c":"code","327085c5":"code","1e42bc81":"code","596ac1f5":"code","7bfa8832":"code","ac23c480":"code","5c745bf7":"code","6bce2ebc":"code","da09527c":"code","4cddc5f6":"code","f1b924cd":"code","07d08616":"code","9affd84b":"code","1accf02f":"code","e2c17542":"code","519de74e":"code","ad7cd2c2":"code","2288a5ec":"code","48a30296":"code","bc9c8349":"code","736f1111":"code","1d9a064f":"code","d43110c6":"code","7a6d99b9":"code","595f45fc":"code","b5da666b":"code","b5122e41":"code","b23df90e":"code","b13bd7c2":"code","86ab5227":"code","fdb16f80":"code","2ce25cc5":"code","c29e7d7a":"code","e370a0fc":"code","74942642":"code","01e2646a":"code","8e5da76b":"code","e4e94f75":"code","48db28a7":"code","baf403ef":"code","5ff8477c":"code","daa4b1f1":"code","caebf90f":"markdown","1f91b526":"markdown","b1c0feed":"markdown","32685990":"markdown","765ae7f3":"markdown","707ab6e0":"markdown","0a772dc0":"markdown"},"source":{"7c4bbf91":"import pandas as pd ","c7c71f77":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","75ccd4d1":"cols = [\"age\",\"workclass\",\"fnlwgt\",\"education\",\"education-num\",\"marital-status\",\"occupation\",\"relationship\",\"race\",\"sex\",\"capital-gain\",\"capital-loss\",\"hours-per-week\",\"native-country\",\"income\"]\ndf = pd.read_csv('\/kaggle\/input\/finding-donors-for-charity\/adult.data',names = cols)","73b01952":"df.head()","7ac3225b":"df.shape","6948e2d4":"df.isnull().sum() # no null values here","f695f4a3":"df.nunique() #to check unique values","e6c1e595":"print(df['age'].min()) #to check min and max age\ndf['age'].max()","f35cfc3c":"df.info()","327085c5":"df['income'] ","1e42bc81":"df['income'] = df['income'].str.strip()","596ac1f5":"df['income']","7bfa8832":"n_records = df.shape[0]\n\nn_greater_50k = df[df['income']=='>50K'].shape[0]\n\nn_at_most_50k = df[df['income']==\"<=50K\"].shape[0]\n\ngreater_percent = (n_greater_50k\/n_records)*100","ac23c480":"n_records","5c745bf7":"n_greater_50k","6bce2ebc":"n_at_most_50k","da09527c":"greater_percent","4cddc5f6":"import seaborn as sns\nimport matplotlib.pyplot as plt\n\nsns.set(style='whitegrid',color_codes=True)\nsns.factorplot(\"sex\",col='education',data=df,hue='income',kind='count',col_wrap=4)","f1b924cd":"df.hist(column='age')\nplt.show()","07d08616":"df.drop(['fnlwgt'],axis=1,inplace=True)","9affd84b":"df[df['occupation']==' ?']","1accf02f":"df[df['workclass']==' ?']","e2c17542":"df=df[df['workclass']!= ' ?']\ndf=df[df['occupation']!=' ?']\ndf=df[df['native-country']!=' ?']","519de74e":"df","ad7cd2c2":"from sklearn.preprocessing import MinMaxScaler\n\nscaler=MinMaxScaler()\nnumerical=['age','education-num','capital-gain','capital-loss','hours-per-week']\ndf[numerical]=scaler.fit_transform(df[numerical])","2288a5ec":"df[numerical]","48a30296":"df","bc9c8349":"y=df['income']","736f1111":"y.head()","1d9a064f":"x = df.drop('income',axis=1)","d43110c6":"from sklearn.preprocessing import LabelEncoder\n\nencoder=LabelEncoder()\ny=y.apply(lambda x:0 if x=='<=50K' else 1)","7a6d99b9":"y","595f45fc":"X = pd.get_dummies(x)\nX","b5da666b":"plt.figure(figsize=(15,8))\nsns.heatmap(X.corr(), annot=True,cmap='cubehelix') ","b5122e41":"from sklearn.model_selection import train_test_split\n\nX_train,X_test,Y_train,Y_test= train_test_split(X,y,test_size=0.3,random_state=0)","b23df90e":"import tensorflow as tf\nfrom tensorflow import keras","b13bd7c2":"ann = tf.keras.models.Sequential()","86ab5227":"ann.add(tf.keras.layers.Dense(units=6, activation='relu'))\nann.add(tf.keras.layers.Dense(units=6, activation='relu'))\nann.add(tf.keras.layers.Dense(units=1, activation='sigmoid'))\nann.compile(optimizer = 'adam', loss = 'binary_crossentropy', metrics = ['accuracy'])","fdb16f80":"ann.fit(X_train, Y_train, batch_size = 32, epochs = 100)","2ce25cc5":"import numpy as np\ny_pred = ann.predict(X_test)\ny_pred = (y_pred > 0.5)\n","c29e7d7a":"from sklearn.metrics import confusion_matrix, accuracy_score,classification_report\ncm = confusion_matrix(Y_test, y_pred)\nprint(cm)\naccuracy_score(Y_test, y_pred)","e370a0fc":"print(classification_report(Y_test,y_pred))","74942642":"Accuracy = (6197+1424)\/(6197+567+861+1424)\nAccuracy","01e2646a":"Precision = 6197 \/ (6197+861) \nPrecision","8e5da76b":"Recall = 6197\/(6197+567) \nRecall","e4e94f75":"Fscore = (2 * Precision * Recall) \/ (Precision + Recall)\nFscore","48db28a7":"Misclassified_Rate= (861+567)\/(6197+567+861+1424)\nMisclassified_Rate","baf403ef":"False_Positve_Rate = 861\/(861+1424) #FP\/(FP+TN)\nFalse_Positve_Rate","5ff8477c":"True_Negative_Rate =1424\/(1424+861) #TN\/(TN+FP)\nTrue_Negative_Rate","daa4b1f1":"Prevalence =(6197+861)\/(6197+567+861+1424)\nPrevalence","caebf90f":"<center><h2>Finding Donors for Charity<\/h2><\/center>\n    \n\n    \n    ","1f91b526":"## *** The Purpose of this project is for Non-profit Organization to analyze how much amount can be asked from donors for Charity based on their Income. ***\n\n\n","b1c0feed":"# Part 4 - Making the predictions and evaluating the model","32685990":"# Data Preprocessing","765ae7f3":"# Part - 2 and 3 Building and Training the ANN","707ab6e0":"### Fomrulas on how to solve Confusion Matrix Terminology","0a772dc0":"## **Please feel free to write any Feedback. Any suggestions is welcome **\n## **Thank you!!!**"}}