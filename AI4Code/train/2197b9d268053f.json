{"cell_type":{"33800e2c":"code","79e15c7c":"code","d5c8e0b5":"code","54e88364":"code","2aeaebbe":"code","2b250006":"code","93ba0766":"code","27b53638":"code","128c8a07":"code","38e8c272":"code","ba97cad8":"code","bc845d6b":"code","93493e2f":"code","fc8cf6df":"code","7cb28cf4":"code","9b04da39":"code","32288ad4":"code","c56af025":"code","8da43995":"code","26fb1a34":"code","6de83dc5":"code","abef0cd1":"code","ac7fdcf3":"code","cd08867a":"markdown","19c4f0e0":"markdown","0713d58a":"markdown"},"source":{"33800e2c":"from fastai import *\nfrom fastai.vision import *\n\nimport numpy as np \nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom sklearn.metrics import auc,roc_curve\n\nimport os\nprint(os.listdir(\"..\/input\"))","79e15c7c":"path = Path('..\/input\/IDC_regular_ps50_idx5\/')","d5c8e0b5":"fnames=get_files(path, recurse=True)","54e88364":"pattern= r'([^\/_]+).png$'","2aeaebbe":"tfms=get_transforms(flip_vert=True, max_warp=0., max_zoom=0., max_rotate=0.)","2b250006":"data = ImageDataBunch.from_name_re(path, fnames, pattern, ds_tfms=tfms, size=50, bs=64,num_workers=2\n                                  ).normalize()","93ba0766":"data.show_batch(rows=3, figsize=(8,8))","27b53638":"learner= create_cnn(data, models.resnet18, metrics=[accuracy], model_dir='\/tmp\/models\/')","128c8a07":"learner.lr_find()\nlearner.recorder.plot()","38e8c272":"lr=1e-2\nlearner.fit_one_cycle(6, lr)","ba97cad8":"learner.unfreeze()","bc845d6b":"learner.lr_find()\nlearner.recorder.plot()","93493e2f":"learner.fit_one_cycle(10,slice(1e-5,1e-4))","fc8cf6df":"learner.recorder.plot_losses()","7cb28cf4":"learner.save('stage-1', return_path=True) ","9b04da39":"learner.freeze_to(-3)","32288ad4":"learner.lr_find()\nlearner.recorder.plot()","c56af025":"learner.fit_one_cycle(2,slice(1e-5,1e-4))","8da43995":"learner.freeze_to(-2)\nlearner.fit_one_cycle(2,slice(1e-5,1e-4))","26fb1a34":"conf= ClassificationInterpretation.from_learner(learner)\nconf.plot_confusion_matrix(figsize=(10,8))","6de83dc5":"# Predictions of the validation data\npreds_val, y_val=learner.get_preds()","abef0cd1":"#  ROC curve\nfpr, tpr, thresholds = roc_curve(y_val.numpy(), preds_val.numpy()[:,1], pos_label=1)\n\n#  ROC area\npred_score = auc(fpr, tpr)\nprint(f'ROC area is {pred_score}')","ac7fdcf3":"plt.figure()\nplt.plot(fpr, tpr, color='orange', label='ROC curve (area = %0.2f)' % pred_score)\nplt.plot([0, 1], [0, 1], color='navy', linestyle='--')\nplt.xlim([-0.01, 1.0])\nplt.ylim([0.0, 1.01])\nplt.xlabel('False Positive Rate')\nplt.ylabel('True Positive Rate')\nplt.title('Receiver Operating Characteristic')\nplt.legend(loc=\"lower right\")","cd08867a":"\n## Model","19c4f0e0":"# Invasive Ductal Carcinoma Classifier\n\"Invasive Ductal Carcinoma (IDC) is the most common subtype of all breast cancers. To assign an aggressiveness grade to a whole mount sample, pathologists typically focus on the regions which contain the IDC. As a result, one of the common pre-processing steps for automatic aggressiveness grading is to delineate the exact regions of IDC inside of a whole mount slide. The original dataset consisted of 162 whole mount slide images of Breast Cancer (BCa) specimens scanned at 40x. From that, 277,524 patches of size 50 x 50 were extracted (198,738 IDC negative and 78,786 IDC positive). Each patch\u2019s file name is of the format: u_xX_yY_classC.png \u2014 > example 10253_idx5_x1351_y1101_class0.png . Where u is the patient ID (10253_idx5), X is the x-coordinate of where this patch was cropped from, Y is the y-coordinate of where this patch was cropped from, and C indicates the class where 0 is non-IDC and 1 is IDC.","0713d58a":"## Dataset "}}