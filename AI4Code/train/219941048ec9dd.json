{"cell_type":{"cf9ba124":"code","2c7c194e":"code","5f0985be":"code","c331b742":"code","910ab218":"code","93470f2c":"code","e4ec09f2":"code","52d3344e":"markdown","975f2057":"markdown","eca89e96":"markdown"},"source":{"cf9ba124":"import pandas as pd\n\nimport warnings\nwarnings.filterwarnings(\"ignore\")","2c7c194e":"sub2 = '..\/input\/sub-files\/02.csv'\nsub3 = '..\/input\/sub-files\/03.csv'\nsub4 = '..\/input\/sub-files\/04.csv'\nsub5 = '..\/input\/sub-files\/05.csv'\nsub6 = '..\/input\/sub-files\/06.csv'\nsub7 = '..\/input\/sub-files\/07.csv'\nsub8 = '..\/input\/sub-files\/08.csv'\n\n\nsub9 = '..\/input\/tps12-pseudolabels\/source_submissions\/01.csv'\nsub10 = '..\/input\/tps12-pseudolabels\/source_submissions\/02.csv'\nsub11 = '..\/input\/tps12-pseudolabels\/source_submissions\/03.csv'\nsub12 = '..\/input\/tps12-pseudolabels\/source_submissions\/04.csv'\nsub13 = '..\/input\/tps12-pseudolabels\/source_submissions\/05.csv'\nsub14 = '..\/input\/tps12-pseudolabels\/source_submissions\/06.csv'\n\n\nsub15 = '..\/input\/tpsdec-public-notebooks\/results\/p1.csv'\nsub16 = '..\/input\/tpsdec-public-notebooks\/results\/p10.csv'\nsub17 = '..\/input\/tpsdec-public-notebooks\/results\/p11.csv'\nsub18 = '..\/input\/tpsdec-public-notebooks\/results\/p2.csv'\nsub19 = '..\/input\/tpsdec-public-notebooks\/results\/p3.csv'\nsub20 = '..\/input\/tpsdec-public-notebooks\/results\/p4.csv'\nsub21 = '..\/input\/tpsdec-public-notebooks\/results\/p5.csv'\nsub22 = '..\/input\/tpsdec-public-notebooks\/results\/p6.csv'\nsub23 = '..\/input\/tpsdec-public-notebooks\/results\/p7.csv'\nsub24 = '..\/input\/tpsdec-public-notebooks\/results\/p8.csv'\nsub25 = '..\/input\/tpsdec-public-notebooks\/results\/p9.csv'\nsub26 = '..\/input\/tpsdec-public-notebooks\/results\/submission.csv'\n\nsub27 = '..\/input\/tps-dec-pseudolabels-submissions\/submission_2.csv'\n\nsub28 = '..\/input\/relupseudolabels\/submission (2).csv'\n\n\nsub29 = '..\/input\/sub-files-tps-dec-2\/submission_20.csv'\nsub30 = '..\/input\/sub-files-tps-dec-2\/submission_21.csv'\nsub31 = '..\/input\/sub-files-tps-dec-2\/submission_22.csv'\nsub32 = '..\/input\/sub-files-tps-dec-2\/submission_23.csv'\nsub33 = '..\/input\/sub-files-tps-dec-2\/submission_25.csv'\nsub34 = '..\/input\/sub-files-tps-dec-2\/submission_28.csv'\n\n\nsub35 = '..\/input\/tpsdec-public-notebooks\/submission.csv'\nsub36 = '..\/input\/tpsdec-public-notebooks\/submission_without4.csv'\n\n\nsub37 = '..\/input\/blender\/95685.csv'\n\nsub38 = '..\/input\/tpsdec-public-notebooks\/tps12-fast-blend.csv'\nsub39 = '..\/input\/tpsdec-public-notebooks\/tps12-pseudeo-submission.csv'\n\n\n\n\nresult = pd.concat([pd.read_csv(sub2, index_col = \"Id\"),\n                    pd.read_csv(sub3, index_col = \"Id\"),\n                    pd.read_csv(sub4, index_col = \"Id\"),\n                    pd.read_csv(sub5, index_col = \"Id\"),\n                    pd.read_csv(sub6, index_col = \"Id\"),\n                    pd.read_csv(sub7, index_col = \"Id\"),\n                    pd.read_csv(sub8, index_col = \"Id\"),\n                    pd.read_csv(sub9, index_col = \"Id\"),\n                    pd.read_csv(sub10, index_col = \"Id\"),\n                    pd.read_csv(sub11, index_col = \"Id\"),\n                    pd.read_csv(sub12, index_col = \"Id\"),\n                    pd.read_csv(sub13, index_col = \"Id\"),\n                    pd.read_csv(sub14, index_col = \"Id\"),\n                    pd.read_csv(sub15, index_col = \"Id\"),\n                    pd.read_csv(sub16, index_col = \"Id\"),\n                    pd.read_csv(sub17, index_col = \"Id\"),\n                    pd.read_csv(sub18, index_col = \"Id\"),\n                    pd.read_csv(sub19, index_col = \"Id\"),\n                    pd.read_csv(sub20, index_col = \"Id\"),\n                    pd.read_csv(sub21, index_col = \"Id\"),\n                    pd.read_csv(sub22, index_col = \"Id\"),\n                    pd.read_csv(sub23, index_col = \"Id\"),\n                    pd.read_csv(sub24, index_col = \"Id\"),\n                    pd.read_csv(sub25, index_col = \"Id\"),\n                    pd.read_csv(sub26, index_col = \"Id\"),\n                    pd.read_csv(sub27, index_col = \"Id\"),\n                    pd.read_csv(sub28, index_col = \"Id\"),\n                    pd.read_csv(sub29, index_col = \"Id\"),\n                    pd.read_csv(sub30, index_col = \"Id\"),\n                    pd.read_csv(sub31, index_col = \"Id\"),\n                    pd.read_csv(sub32, index_col = \"Id\"),\n                    pd.read_csv(sub33, index_col = \"Id\"),\n                    pd.read_csv(sub34, index_col = \"Id\"),\n                    pd.read_csv(sub35, index_col = \"Id\"),\n                    pd.read_csv(sub36, index_col = \"Id\"),\n                    pd.read_csv(sub37, index_col = \"Id\"),\n                    pd.read_csv(sub38, index_col = \"Id\"),\n                    pd.read_csv(sub39, index_col = \"Id\")], axis=1)\n\ntest = pd.read_csv('..\/input\/tabular-playground-series-dec-2021\/test.csv', index_col = \"Id\")","5f0985be":"def pseudo(row):\n    values = row.values\n    if (values == values[0]).all():\n        return [True, values[0]]\n    else:\n        return [False, None]\n\nresult[['Pseudo', 'Result']] = result.apply(lambda row: pd.Series(pseudo(row)), axis=1)","c331b742":"result[result.Pseudo == True]","910ab218":"# I take only this rows that every submissions tell the same prediction\npseudo_indexes = result[result.Pseudo].index\n\npseudo = test[test.index.isin(pseudo_indexes)]\n\npseudo_classes = result[result.index.isin(pseudo_indexes)]['Result'].astype(int)\n\npseudo['Cover_Type'] = pseudo_classes\npseudo.to_csv(\"tps-dec-pseudolabels.csv\")\n\npseudo.tail(5)","93470f2c":"pseudo['Cover_Type'].value_counts()","e4ec09f2":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nfrom scipy import stats\nimport matplotlib.pyplot as plt\n\n\n\n\nsub9 = '..\/input\/tps12-pseudolabels\/source_submissions\/01.csv'\nsub10 = '..\/input\/tps12-pseudolabels\/source_submissions\/02.csv'\nsub11 = '..\/input\/tps12-pseudolabels\/source_submissions\/03.csv'\nsub12 = '..\/input\/tps12-pseudolabels\/source_submissions\/04.csv'\nsub13 = '..\/input\/tps12-pseudolabels\/source_submissions\/05.csv'\nsub14 = '..\/input\/tps12-pseudolabels\/source_submissions\/06.csv'\n\n\nsub15 = '..\/input\/tpsdec-public-notebooks\/results\/p1.csv'\nsub16 = '..\/input\/tpsdec-public-notebooks\/results\/p10.csv'\nsub17 = '..\/input\/tpsdec-public-notebooks\/results\/p11.csv'\nsub18 = '..\/input\/tpsdec-public-notebooks\/results\/p2.csv'\nsub19 = '..\/input\/tpsdec-public-notebooks\/results\/p3.csv'\nsub20 = '..\/input\/tpsdec-public-notebooks\/results\/p4.csv'\nsub21 = '..\/input\/tpsdec-public-notebooks\/results\/p5.csv'\nsub22 = '..\/input\/tpsdec-public-notebooks\/results\/p6.csv'\nsub23 = '..\/input\/tpsdec-public-notebooks\/results\/p7.csv'\nsub24 = '..\/input\/tpsdec-public-notebooks\/results\/p8.csv'\nsub25 = '..\/input\/tpsdec-public-notebooks\/results\/p9.csv'\nsub26 = '..\/input\/tpsdec-public-notebooks\/results\/submission.csv'\n\nsub27 = '..\/input\/tps-dec-pseudolabels-submissions\/submission_2.csv'\n\n\n\nsub28 = '..\/input\/relupseudolabels\/submission (2).csv'\n\n\nsub29 = '..\/input\/sub-files-tps-dec-2\/submission_20.csv'\nsub30 = '..\/input\/sub-files-tps-dec-2\/submission_21.csv'\nsub31 = '..\/input\/sub-files-tps-dec-2\/submission_22.csv'\nsub32 = '..\/input\/sub-files-tps-dec-2\/submission_23.csv'\nsub33 = '..\/input\/sub-files-tps-dec-2\/submission_25.csv'\nsub34 = '..\/input\/sub-files-tps-dec-2\/submission_28.csv'\n\n\nsub35 = '..\/input\/tpsdec-public-notebooks\/submission.csv'\nsub36 = '..\/input\/tpsdec-public-notebooks\/submission_without4.csv'\n\n\nsub37 = '..\/input\/blender\/95685.csv'\n\nsub38 = '..\/input\/tpsdec-public-notebooks\/tps12-fast-blend.csv'\nsub39 = '..\/input\/tpsdec-public-notebooks\/tps12-pseudeo-submission.csv'\n\n\n\n\n\n\n\n\np2 = pd.read_csv(sub2)\np3 = pd.read_csv(sub3)\np4 = pd.read_csv(sub4)\np5 = pd.read_csv(sub5)\np6 = pd.read_csv(sub6)\np7 = pd.read_csv(sub7)\np8 = pd.read_csv(sub8)\n\np9 = pd.read_csv(sub9)\np10 = pd.read_csv(sub10)\np11 = pd.read_csv(sub11)\np12 = pd.read_csv(sub12)\np13 = pd.read_csv(sub13)\np14 = pd.read_csv(sub14)\n\np15 = pd.read_csv(sub15)\np16 = pd.read_csv(sub16)\np17 = pd.read_csv(sub17)\np18 = pd.read_csv(sub18)\np19 = pd.read_csv(sub19)\np20 = pd.read_csv(sub20)\np21 = pd.read_csv(sub21)\np22 = pd.read_csv(sub22)\np23 = pd.read_csv(sub23)\np24 = pd.read_csv(sub24)\np25 = pd.read_csv(sub25)\np26 = pd.read_csv(sub26)\n\np27 = pd.read_csv(sub27)\n\np28 = pd.read_csv(sub28)\np29 = pd.read_csv(sub29)\np30 = pd.read_csv(sub30)\np31 = pd.read_csv(sub31)\np32 = pd.read_csv(sub32)\np33 = pd.read_csv(sub33)\np34 = pd.read_csv(sub34)\np35 = pd.read_csv(sub35)\np36 = pd.read_csv(sub36)\np37 = pd.read_csv(sub37)\n\np38 = pd.read_csv(sub38)\np39 = pd.read_csv(sub39)\n\n\n\nsubmission = pd.read_csv('..\/input\/tabular-playground-series-dec-2021\/sample_submission.csv')\n\npredictions = [p2, p3, p4, p5, p6, p7, p8 ,p9,p10,p11,p12,p13,p14,p15,p16,p17,p18,p19,p20,p21,p22,p23,p24,p25,p26,p27,p28,p29,p30,p31,p32,p33,p34,p35,p36,p37,p38,p39]\nresults = pd.DataFrame()\nfor i, ds in enumerate(predictions): results[f'p{i+1}'] = ds['Cover_Type']\nresults[\"ensemble\"] = stats.mode(np.array(results), axis=1)[0]\nsubmission['Cover_Type'] = results[\"ensemble\"]\nsubmission.to_csv(\"submission.csv\", index=False)\nsubmission.head()","52d3344e":"As simple as possible - just to show how to boost score a little bit using pseudolabels.","975f2057":"# Ensemble","eca89e96":"# Pseudolabels for classification"}}