{"cell_type":{"59ab4213":"code","e3734e14":"code","2ddf721d":"code","5b3c2c1d":"code","700927d4":"code","79c59447":"code","8f051cd5":"code","eaecea20":"code","7feb8e07":"code","6efe63ac":"code","cc71eafa":"code","0b3fda72":"code","442f9c9b":"code","337273f7":"code","c55a0a10":"code","1c446e01":"code","3aab6872":"code","19b3253b":"code","d1052678":"code","bc170ace":"code","577c04de":"code","7d6594fc":"code","4f0a04be":"code","7e31f705":"code","3a5f7231":"code","15ef5c13":"code","d8d792a3":"code","f04c31bc":"code","aaa13ae1":"markdown","f6ad49c7":"markdown","e588c05e":"markdown","a97f9b61":"markdown","e607b3c9":"markdown","ec620188":"markdown","9e0aa71c":"markdown","427948b4":"markdown","3390c14d":"markdown","c83ea1b9":"markdown","4096d728":"markdown","9ffa485e":"markdown","a4784c6b":"markdown","00563fd6":"markdown","8bb5d7a2":"markdown","187693ed":"markdown","7cfdd307":"markdown"},"source":{"59ab4213":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","e3734e14":"import pandas as pd\nimport seaborn as sns\nimport numpy as np","2ddf721d":"dataset = pd.read_csv('..\/input\/autompg-dataset\/auto-mpg.csv')","5b3c2c1d":"dataset.info()","700927d4":"dataset.describe()","79c59447":"dataset.head()","8f051cd5":"dataset = dataset.drop(['car name'], axis = 1)","eaecea20":"hp_nan = pd.DataFrame(dataset.horsepower.str.isdigit())\ndataset[hp_nan['horsepower'] == False]","7feb8e07":"# replace missing values by median\ndataset = dataset.replace('?', np.nan)\nmedian_hp = dataset['horsepower'].median()\ndataset['horsepower'].replace(np.nan,median_hp,inplace=True)","6efe63ac":"# recheck\nhp_nan = pd.DataFrame(dataset.horsepower.str.isdigit())\ndataset[hp_nan['horsepower'] == False]","cc71eafa":"check = dataset['horsepower']\ncheck[32]","0b3fda72":"dataset.to_csv('mpg_isclean.csv',index=False)","442f9c9b":"# Convert data type of horse power form object to integer\ndataset['horsepower'] = dataset['horsepower'].astype('float64')","337273f7":"# cylinders\nsns.barplot(data=dataset, x=\"cylinders\", y=\"mpg\",\n            estimator=np.average)","c55a0a10":"# displacement\nsns.regplot(data=dataset, x=\"displacement\", y=\"mpg\",\n            scatter_kws={\"color\": \"darkblue\",'s': 20},\n            line_kws={\"color\": \"red\"})","1c446e01":"# horsepower\nsns.regplot(data=dataset, x=\"horsepower\", y=\"mpg\",\n            scatter_kws={\"color\": \"darkblue\",'s': 20}, \n            line_kws={\"color\": \"red\"})","3aab6872":"# weight\nsns.regplot(data=dataset, x=\"weight\", y=\"mpg\",\n            scatter_kws={\"color\": \"darkblue\",'s': 20},\n            line_kws={\"color\": \"red\"})","19b3253b":"# acceleration\nsns.regplot(data=dataset, x=\"acceleration\", y=\"mpg\",\n            scatter_kws={\"color\": \"darkblue\",'s': 20},\n            line_kws={\"color\": \"red\"})","d1052678":"# model\nsns.barplot(data=dataset, x=\"model year\", y=\"mpg\",\n           estimator=np.average)","bc170ace":"# origin\nsns.barplot(data=dataset, x=\"origin\", y=\"mpg\",\n           estimator=np.average)","577c04de":"dataset.corr(method ='pearson')","7d6594fc":"# Get one hot encoding of columns 'cylinders'\none_hot = pd.get_dummies(dataset['cylinders'])\n\n# Drop column as it is now encoded\ndataset = dataset.drop('cylinders',axis = 1)\n\n# Join the encoded df\ndataset = dataset.join(one_hot)\ndataset ","4f0a04be":"dataset = dataset.drop(['acceleration', 'model year', 'origin'],axis = 1)\ndataset","7e31f705":"X = dataset.iloc[:, 1:].values\ny = dataset.iloc[:, 0].values","3a5f7231":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.2, random_state = 42)","15ef5c13":"from sklearn.linear_model import LinearRegression\nregressor = LinearRegression()\nregressor.fit(X_train, y_train)","d8d792a3":"y_pred = regressor.predict(X_test)\nnp.set_printoptions(precision=2)\nprint(np.concatenate((y_pred.reshape(len(y_pred),1), y_test.reshape(len(y_test),1)),1))\n\npred = np.concatenate((y_pred.reshape(len(y_pred),1), y_test.reshape(len(y_test),1)),1)\npd.DataFrame(pred).to_csv('mpg_pred.csv',index=False)","f04c31bc":"from sklearn.metrics import r2_score, mean_squared_error\nr_square = print(\"R Square : \", r2_score(y_test, y_pred))\nrmse = print(\"RMSE : \", mean_squared_error(y_test, y_pred, squared = True))","aaa13ae1":"Drop others columns that we don't use to make a model.","f6ad49c7":"## Predicting the Test set results","e588c05e":"## Handle Dummy Variables (cylinders)","a97f9b61":"## Convert data type","e607b3c9":"## Importing the dataset","ec620188":"## R Square and RMSE of the model","9e0aa71c":"From Pearson's Correlation, I will choose cylinders, displacement, horsepower and weight in my model","427948b4":"## Importing the libraries","3390c14d":"## Splitting the dataset into the Training set and Test set","c83ea1b9":"## Visualising the data\n- Visualize to see the relationship of variables which may help us selecting variables to create a model","4096d728":"## Pearson's Correlation\n- summarize the strength of the linear relationship between auto mpg and others","9ffa485e":"## Training the Multiple Linear Regression model on the Training set","a4784c6b":"# Multiple Linear Regression ; Auto MPG\n- Predict Auto MPG based on multiple linear regression model","00563fd6":"we can't use 'car name' columns to predict Auto mpg, so I drop it.","8bb5d7a2":"**Please feel free to leave your suggestions. I appreciate it all.**","187693ed":"# Handle missing values","7cfdd307":"**NOTE**  The values for origin  (1, 2, 3) into 'North America', 'Europe', and 'Asia'."}}