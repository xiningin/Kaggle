{"cell_type":{"7ab2f960":"code","1ba598cc":"code","14f2f632":"code","eea93704":"code","dfdf0210":"code","035ab431":"code","1d6c40ea":"code","66bccdd8":"code","94a5a7d6":"code","f6644f8c":"code","6779ceed":"code","31b60fae":"code","472320fe":"code","5fe279b5":"code","473ddc87":"code","46d1a6bb":"code","f882fec8":"code","d7fdd4c9":"code","a5817c25":"code","616062e3":"code","5f3a297a":"code","8fd738a2":"code","09c2d797":"code","5dd712dc":"code","8689656e":"code","a7b2f72c":"code","8674c903":"markdown","595e82ad":"markdown","c47dcbb4":"markdown","19b18ea8":"markdown","3255cb10":"markdown","e3cbdb6c":"markdown","d7d1ed85":"markdown","f1fa9852":"markdown","d5682a2a":"markdown","25d629f0":"markdown","9830f16f":"markdown","14cc0036":"markdown","550cec8b":"markdown","1292e15a":"markdown","f9e9a598":"markdown"},"source":{"7ab2f960":"%%time\nimport pandas as pd\nfrom sklearn.ensemble import RandomForestClassifier","1ba598cc":"%%time\n\nimport os\nprint(os.listdir(\"..\/input\"))\n# Any results you write to the current directory are saved as output.\n\ndf_train = pd.read_csv('..\/input\/train.csv')\ndf_test = pd.read_csv('..\/input\/test.csv')\n","14f2f632":"df_train.shape","eea93704":"df_test.shape","dfdf0210":"df_train.head(2)","035ab431":"df_test.head(2)","1d6c40ea":"df_train.isnull().sum()","66bccdd8":"df_test.isnull().sum()","94a5a7d6":"\ndf_train.date  = pd.to_datetime(df_train.date, format='%Y-%m-%d')","f6644f8c":"df_train['year'] = df_train.date.dt.year\ndf_train['month']=df_train.date.dt.month\ndf_train['day']=df_train.date.dt.day","6779ceed":"df_train.head(2)","31b60fae":"\ndf_test.date  = pd.to_datetime(df_test.date, format='%Y-%m-%d')\ndf_test['year'] = df_test.date.dt.year\ndf_test['month']=df_test.date.dt.month\ndf_test['day']=df_test.date.dt.day","472320fe":"df_test.head(2)","5fe279b5":"df_train['year']=df_train['year'].astype('category')\ndf_train['month']=df_train['month'].astype('category')\ndf_train['day']=df_train['day'].astype('category')\ndf_train['store']=df_train['store'].astype('category')\ndf_train['item']=df_train['item'].astype('category')\ndf_train['sales']=df_train['sales'].astype('category')","473ddc87":"y=pd.DataFrame()\ny['sales']=df_train['sales']","46d1a6bb":"df_train=df_train.drop(columns='date',axis=1)","f882fec8":"df_train=df_train.drop(columns='sales',axis=1)","d7fdd4c9":"df_train.dtypes","a5817c25":"df_test['year']=df_test['year'].astype('category')\ndf_test['month']=df_test['month'].astype('category')\ndf_test['day']=df_test['day'].astype('category')\ndf_test['store']=df_test['store'].astype('category')\ndf_test['item']=df_test['item'].astype('category')\ndf_test=df_test.drop(columns='date',axis=1)","616062e3":"df_test=df_test.drop(columns='id',axis=1)","5f3a297a":"df_test.dtypes","8fd738a2":" clf = RandomForestClassifier(max_depth=2, random_state=0)","09c2d797":"x=df_train.iloc[:,0:5]  ","5dd712dc":"clf=clf.fit(x,y)","8689656e":"%%time\noutput=clf.predict(df_test)\nresult=pd.DataFrame(output)\nresult","a7b2f72c":"test=pd.read_csv('..\/input\/test.csv',usecols=['id'])\nfin=pd.DataFrame(test)\nfin['sales']=result\nfin.to_csv('Sales.gz',index=False,compression='gzip')\n ","8674c903":"##### Train data","595e82ad":"### Date split","c47dcbb4":"### Checking datatypes","19b18ea8":"#### Droping columns","3255cb10":"#### Checking datatypes ","e3cbdb6c":"### Modelling with Random forest classifier","d7d1ed85":"### Categorical conversion","f1fa9852":"#### INPUT size","d5682a2a":"### Loading libraries","25d629f0":"##### Test data","9830f16f":"### Checking for missing  values","14cc0036":"### Submission","550cec8b":"#### Dropping columns","1292e15a":"#### Test data ","f9e9a598":"#### Reading test and train data"}}