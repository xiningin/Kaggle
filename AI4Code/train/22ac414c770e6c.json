{"cell_type":{"a541e9a2":"code","076b38bf":"code","f597eeeb":"code","a0a41f09":"code","bcf85a8c":"code","e2967d95":"code","bee3047d":"code","1d3f2194":"code","ecee7192":"code","6c085f4d":"code","d7a5c992":"code","551271f0":"code","2fa2e038":"code","5332da08":"code","39e9d82b":"code","d7f78382":"code","7d3eba71":"code","4dd5a105":"code","98791f0c":"code","85829182":"markdown","fa93900e":"markdown","090d6044":"markdown","c116dfa9":"markdown","bd4399e4":"markdown","66426c65":"markdown","c8f13f7d":"markdown","3b4ed219":"markdown","6f3fe2bf":"markdown","953f1823":"markdown","0c3d7cd5":"markdown","3ce7d634":"markdown","2e75359d":"markdown","274aa61a":"markdown","c440735b":"markdown","c0dbf887":"markdown","3a5565fa":"markdown","f2a0b37a":"markdown","0f434c30":"markdown"},"source":{"a541e9a2":"import numpy as np\nimport pandas as pd\n\n# Plotting\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nplt.style.use('ggplot')\n\n# What do we say to python warnings? NOT TODAY\nimport warnings\nwarnings.filterwarnings(\"ignore\")","076b38bf":"dtypes_ts = {\"space_id\":\"category\",\n\"building_name\":\"str\",\n\"air_vel\":\"category\",\n\"body_presence\":\"bool\",\n\"change\":\"category\",\n\"clothing\":\"category\",\n\"comfort\":\"category\",\n\"indoor\/outdoor\":\"category\",\n\"met\":\"category\",\n\"thermal\":\"category\",\n\"user_id\":\"str\"}\n\ndtypes_md={\"user_id\":\"str\",\n\"yob\":\"int\",\n\"sex\":\"category\",\n\"height\":\"int\",\n\"weight\":\"float\",\n\"shoulder_circumference\":\"int\",\n\"years_here\":\"int\",\n\"satisfaction_weather\":\"category\",\n\"sweating\":\"category\",\n\"outdoor_hr_weekday\":\"int\",\n\"outdoor_hr_weekend\":\"int\",\n\"hsps\":\"float\",\n\"swls\":\"int\",\n\"extraversion\":\"float\",\n\"agreeableness\":\"float\",\n\"conscientiousness\":\"float\",\n\"emotional_stability\":\"float\",\n\"openness_to_experiences\":\"float\"}","f597eeeb":"ts = pd.read_csv(\"\/kaggle\/input\/longitudinal-personal-thermal-comfort-preferences\/enth_tabular_merged.csv\", dtype=dtypes_ts, parse_dates=[\"time\"])\nmd = pd.read_csv(\"\/kaggle\/input\/longitudinal-personal-thermal-comfort-preferences\/enth_surveys_renamed.csv\", dtype=dtypes_md)","a0a41f09":"# Thermal\nts.thermal.cat.rename_categories({'9.0': 'Warmer', '10.0': 'No Change', '11.0': 'Cooler'}, inplace=True)\nts.thermal.cat.reorder_categories([\"Cooler\",\"No Change\",\"Warmer\"], inplace=True)\n\n# Clothing\nts.clothing.cat.rename_categories({'8.0':'Very Light','9.0': 'Light', '10.0': 'Medium', '11.0': 'Heavy'}, inplace=True)\nts.clothing.cat.reorder_categories([\"Very Light\",\"Light\",\"Medium\",\"Heavy\"], inplace=True)\n\n# Air vel\nts.air_vel.cat.rename_categories({ \"10.0\": \"Not Perceived\", \"11.0\": \"Perceived\"}, inplace=True)\nts.air_vel.cat.reorder_categories([\"Not Perceived\",\"Perceived\"], inplace=True)\n\n# Change\nts.change.cat.rename_categories({\"11.0\": \"Yes Change\", \"10.0\": \"No Change\"}, inplace=True)\nts.change.cat.reorder_categories([\"Yes Change\",\"No Change\"], inplace=True)\n\n# indoor outdoor\nts[\"indoor\/outdoor\"].cat.rename_categories({'9.0': \"Outdoor\", \"11.0\": \"Indoor\"}, inplace=True)\nts[\"indoor\/outdoor\"].cat.reorder_categories([\"Indoor\",\"Outdoor\"], inplace=True)\n\n# met\nts.met.cat.rename_categories({\"8.0\": \"resting\", \"9.0\": \"sitting\", \"10.0\": \"standing\", \"11.0\": \"exercising\"}, inplace=True)\nts.met.cat.reorder_categories([\"resting\",\"sitting\",\"standing\", \"exercising\"], inplace=True)","bcf85a8c":"df = pd.merge(ts, md, how=\"left\", on=\"user_id\")","e2967d95":"df1 = df[[\"thermal\",\"time\",\"indoor\/outdoor\",\"indoor_floor\", \"sex\",\"met\",\"heartrate\",\"clothing\",\"temp_zone\",\"temp_outdoor\",\"humidity_zone\",\"humidity_outdoor\"]]","bee3047d":"g = sns.FacetGrid(df1, col=\"thermal\", size=4)\ng.map_dataframe(sns.countplot, x=\"indoor\/outdoor\", hue=\"sex\", palette=\"Set2_r\")\ng.add_legend()\n\ntxt=\"Figure 1: Number of answers about thermal comfort split by indoor\/outdoor space and sex.\"\nplot_text = plt.figtext(0.5, -0.05, txt, wrap=True, horizontalalignment='center', fontsize=12)","1d3f2194":"# Count number of answers\ngroup = df1[[\"thermal\",\"indoor\/outdoor\",\"sex\",\"time\"]].groupby([\"indoor\/outdoor\", \"thermal\",\"sex\"]).count().rename(columns={\"time\":\"cnt\"}).reset_index()\n# Get total number of answers\ngroup_total = pd.DataFrame(group.groupby([\"sex\",\"indoor\/outdoor\"]).cnt.sum()).reset_index()\n#Merge\ngroup = pd.merge(group, group_total, how=\"left\", on=[\"sex\",\"indoor\/outdoor\"])\n# Calculate percentage\ngroup[\"pct\"] = (group.cnt_x \/ group.cnt_y) * 100","ecee7192":"g = sns.FacetGrid(group, col=\"sex\", row=\"indoor\/outdoor\", size=4)\ng.map_dataframe(sns.barplot, y=\"pct\", x=\"thermal\", palette=\"Set2_r\")\ng.add_legend()\n\ntxt=\"Figure 2: Percentage of answers about thermal comfort grouped by indoor\/outdoor space and sex.\"\nplot_text = plt.figtext(0.5, -0.05, txt, wrap=True, horizontalalignment='center', fontsize=12)","6c085f4d":"g = sns.FacetGrid(df1, col=\"thermal\", size=4)\ng.map_dataframe(sns.boxplot, x=\"indoor\/outdoor\", y=\"heartrate\", palette=\"Set2\")\ng.add_legend()\n\ntxt=\"Figure 3: Heartrate distribution grouped by thermal comfort and colored by indoor\/outdoor space.\"\nplot_text = plt.figtext(0.5, -0.05, txt, wrap=True, horizontalalignment='center', fontsize=12)","d7a5c992":"g = sns.FacetGrid(df1, col=\"thermal\", size=4)\ng.map_dataframe(sns.stripplot, x=\"indoor\/outdoor\", y=\"met\", palette=\"Set2\",size=20, \n                marker=\"D\",edgecolor=\"gray\", alpha=.25)\n\ntxt=\"Figure 4: Metabolism distribution grouped by thermal comfort and colored by indoor\/outdoor space.\"\nplot_text = plt.figtext(0.5, -0.05, txt, wrap=True, horizontalalignment='center', fontsize=12)","551271f0":"# Count number of answers\ngroup = df1[[\"thermal\",\"indoor\/outdoor\",\"clothing\",\"time\"]].groupby([\"indoor\/outdoor\", \"thermal\",\"clothing\"]).count().rename(columns={\"time\":\"cnt\"}).reset_index()\n# Get total number of answers\ngroup_total = pd.DataFrame(group.groupby([\"clothing\",\"indoor\/outdoor\"]).cnt.sum()).reset_index()\n#Merge\ngroup = pd.merge(group, group_total, how=\"left\", on=[\"clothing\",\"indoor\/outdoor\"])\n# Calculate percentage\ngroup[\"pct\"] = (group.cnt_x \/ group.cnt_y) * 100","2fa2e038":"g = sns.FacetGrid(group, col=\"clothing\", size=4)\ng.map_dataframe(sns.pointplot,  x=\"thermal\", y=\"pct\", hue=\"indoor\/outdoor\", kind=\"point\", palette=\"Set2\")\ng.add_legend()\n\ntxt=\"Figure 5: Percentage of answers about thermal comfort grouped by level of clothing and colored by indoor\/outdoor space.\"\nplot_text = plt.figtext(0.5, -0.05, txt, wrap=True, horizontalalignment='center', fontsize=12)","5332da08":"# Count number of answers\ngroup = df1[[\"thermal\",\"indoor\/outdoor\",\"time\"]].groupby([\"indoor\/outdoor\", \"thermal\",df1.time.dt.hour]).count().rename(columns={\"time\":\"cnt\"}).reset_index()\n# Get total number of answers\ngroup_total = pd.DataFrame(group.groupby([\"indoor\/outdoor\",\"thermal\"]).cnt.sum()).reset_index()\n#Merge\ngroup = pd.merge(group, group_total, how=\"left\", on=[\"indoor\/outdoor\",\"thermal\"])\n# Calculate percentage\ngroup[\"pct\"] = (group.cnt_x \/ group.cnt_y) * 100","39e9d82b":"g = sns.FacetGrid(group, col=\"thermal\", size=4)\ng.map_dataframe(sns.lineplot,  x=\"time\", y=\"pct\", hue=\"indoor\/outdoor\", palette=\"Set2\")\ng.add_legend()\n\ntxt=\"Figure 6: Percentage of answers about thermal comfort by hour and colored by indoor\/outdoor space.\"\nplot_text = plt.figtext(0.5, -0.05, txt, wrap=True, horizontalalignment='center', fontsize=12)","d7f78382":"fig, axes = plt.subplots(1,2, figsize=(10,4))\n\np1 = sns.kdeplot(data=df1, x=\"temp_zone\", hue=\"thermal\", palette=\"Set2_r\", ax=axes[0])\naxes[0].set_title(\"Zone Temperature (\u00baC)\")\np2 = sns.kdeplot(data=df1, x=\"temp_outdoor\", hue=\"thermal\", palette=\"Set2_r\", ax=axes[1])\naxes[1].set_title(\"Outdoor Temperature (\u00baC)\")\n\nplt.tight_layout()\n\ntxt=\"Figure 6: Distribution of indoor temperature (left) and outdoor (right).\"\nplot_text = plt.figtext(0.5, -0.05, txt, wrap=True, horizontalalignment='center', fontsize=12)","7d3eba71":"fig, axes = plt.subplots(1,2, figsize=(10,4))\n\np1 = sns.kdeplot(data=df1, x=\"humidity_zone\", hue=\"thermal\", palette=\"Set2_r\", ax=axes[0])\naxes[0].set_title(\"Zone Humidity (%)\")\np2 = sns.kdeplot(data=df1, x=\"humidity_outdoor\", hue=\"thermal\", palette=\"Set2_r\", ax=axes[1])\naxes[1].set_title(\"Outdoor Humidity (%)\")\n\nplt.tight_layout()\n\ntxt=\"Figure 7: Distribution of indoor humidity (left) and outdoor (right).\"\nplot_text = plt.figtext(0.5, -0.05, txt, wrap=True, horizontalalignment='center', fontsize=12)","4dd5a105":"# Count number of answers\ngroup = df1[[\"thermal\",\"indoor_floor\",\"time\"]].groupby([\"thermal\",\"indoor_floor\"]).count().rename(columns={\"time\":\"cnt\"}).reset_index()\n# Get total number of answers\ngroup_total = pd.DataFrame(group.groupby(\"indoor_floor\").cnt.sum()).reset_index()\n#Merge\ngroup = pd.merge(group, group_total, how=\"left\", on=\"indoor_floor\")\n# Calculate percentage\ngroup[\"pct\"] = (group.cnt_x \/ group.cnt_y) * 100","98791f0c":"g = sns.FacetGrid(group, col=\"indoor_floor\", size=4)\ng.map_dataframe(sns.barplot, y=\"pct\", x=\"thermal\", palette=\"Set2_r\")\ng.add_legend()\n\ntxt=\"Figure 8: Percentage of answers about thermal comfort grouped by indoor floor.\"\nplot_text = plt.figtext(0.5, -0.05, txt, wrap=True, horizontalalignment='center', fontsize=12)","85829182":"## Part I: Participants personal features","fa93900e":"### Temperature\nOn the enviromental features temperature may be the most important one. *Figure 6* shows how the temperature distributes for each of the thermal comfort answers, for indoor spaces on the left and outdoor spaces on the right.\n\nOn the indoor spaces, first thing that can be noticed is that most of the data for \"No Change\" answers is around 24\u00baC, which is the suggested temperature for the AC. In contrast, the \"Cooler\" answer shows two peaks: one around 24\u00aaC and one around 30\u00aaC. \"Warmer\" answer seems to spread among the whole range with low density.\n\nOn the outdoor spaces behaviour is similar but at higher temperatures. \"No Change\" answer concentrates around 30\u00baC while \"Cooler\" has two peaks, around 27\u00baC and around 32\u00baC. Again, \"Warmer\" spreads on the whole range.","090d6044":"### Metabolism\n*Figure 4* shows the *met* (metabolism) feature; this variable is about the kind of activity the participants were doing when answering the comfort question. For all answers most of the participants were sitting or standing, with a few resting. Participants exercising are only present in outdoor spaces, which is consisten with the observations about *Figure 3* in previous section.","c116dfa9":"## Part II: Enviromental features","bd4399e4":"## Introduction\nBeing comfortable in a room (or open space) depends not only on enviromental variables but also on personal perception and activity. Each person is different and it may be impossible to make everyone happy, but exploring real data can give some insight on how to make most part of a group of people to feel comfortable in, for example, a classroom.\n\nFocusing on this purpose, in this report experimental data will be explored: knowing how each participant felt (wanted the room to be warmer, no change or cooler) at different moments of the day and in different spaces (indoor and outdoor) we will try to find how it relates to several variables. On the participant's personal features, sex, heartrate, metabolism and clothing will be explored. On the spaces features, floor, temperature, humidity and time of the day.","66426c65":"### Sex\nOne important feature to explore from the participants personal variables is the sex. It is known that, due to biological differences among sexes, in general women prefer warmer temperatures. In *Figure 1* is shown the number of individuals that manifested a thermal preference of cooler, no change and warmer. These answers are split in sex and indoor\/outdoor space and it summarise how many individuals belongs to each group.","c8f13f7d":"## Discussion\nIn the present report were explored different features and how they relate to the comfort perception of different spaces. \n\nWhen studying participant's personal features is noticed that sex weights in the answer given: it seems like men prefer the spaces to be colder, while women were comfortable with the temperature at the moment of answering. Related to heartrate and metabolism, observations are inconclusive; most of the participants were sitting or standing, while only a few were performing the extrem activities: resting and excercising. A more diverse sample is suggested to study this feature. \n\nWhen exploring how heavy was the participant's clothing is observed that, when being outdoor, most of the participants prefered a cooler temperature when wearing medium and heavy clothing. In the case of very light and light clothing participants outdoor were mostly comfortable. The behaviour for the indoor spaces is more erratic and doesn't seem to follow a pattern.\n\nWhen studying enviromental features space temperature is the most useful to explain comfort perception. Part of the participants who wanted the space to be cooler were exposed to a higher temperature in comparisson to those who were comfortable. This pattern was found both in indoor and outdoor spaces. Humidity values were homogenous among all groups studied (indoor\/outdoor and comfort perception). Finally, answers among the floor where the participant was when answering the comfort question shows an atypical behaviour compared to the others: in floor 5 most of the participand wanted it to be cooler, which could mean a malfunction in the temperature controller of that floor.\n\nIn all cases only a small proportion of the participants wanted the space to be warmer.","3b4ed219":"### Clothing\nIn addition to the participant's activity, clothing has an important role when feeling comfortable with the space temperature. In *Figure 5* is shown the percentage of thermal comfort answers grouped by the level of clothing of the participants.\n\nIn the case of very light clothing the most common answers is \"No Change\" both in indoor and outdoor spaces, while those participants with light clothing prefer it coolor indoor and are comfortable outdoor; there is a 10% of participants indoor that prefer it warmer. In the case of medium clothing \"Cooler\" was the most common answe outdoor while \"No Change\" indoor. Those with heavy clothing prefer it coller while being answer and is a tie between \"Cooler\" and \"No Change\" when being indoor.","6f3fe2bf":"### Time of the day\nAnother variable that could weight in understanding thermal comfort could be the hour of the day. This feature is highly related to outside temperature; this raise in temperature could get unnoticed in indoor spaces with air conditioners.\n\n*Figure 6* shows the percentage of answers at each hour colored by indoor\/outdoor spaces. Both answers \"Cooler\" and \"No Change\" seems to be higher between 10 and 17 hs, both indoor and outdoor, indicating that may not be a difference in thermal comfort based on time of the day. For the answer \"Warmer\" the behaviour seems erratic, maybe as a consequence as the sample size: only a few participants answered they wanted the temperature to be warmer.","953f1823":"## Goal\nThe goal of this report is to explore the *Longitudinal indoor personal comfort preferences* data set to understand which variables are the most important in feelling comfortable in a space. Indoor and outdoor spaces will be compared.","0c3d7cd5":"## Conclussion\nExploring the experimental data gave us some insights about the comfort perception of spaces: \n- Zone temperature seems to be the most important feature for people to feel comfortable (both indoor and outdoor)\n- Participant's sex seems to be important, needing men a cooler space to feel comfortable\n- Clothing could be important when being outdoor, participants felt hot when wearing medium and heavy clothes\n- The floor analysis could indicate a malfunction in control temperature of floor 5","3ce7d634":"### Floor\nIn general, each floor of a buildings has an independent temperature controller. In addition, the higher the floor the higher the temperature (when no AC is used). Based on this premises, *Figure 8* shows how the population of each floor answered to the thermal comfort question. As has been seen during this study, usually there is a tie (or values are similar) between the answers \"Cooler\" and \"No Change\", being \"Warmer\" an infrequent answer. Floor 6 seems to be an exception, where most of the people prefered it cooler.","2e75359d":"# Comfort perception of indoor and outdoor spaces: an analysis based on personal and enviromental variables","274aa61a":"### Heart rate\nWhen studying the heartrate values (*Figure 3*) the most evident difference among indoor and outdoor spaces belongs to the group who prefered a cooler temperature. The median value for the outdoor group is higher than the indoor, this could be related to the activity of the participant (walking or running outdoor instead of being sit in a classroom), this will be studied in the next section with the feature *metabolism*. For those participand who answered \"No Change\" and \"Warmer\" the median values are close for both spaces.","c440735b":"## Materials and Methods\nData will be explored using the *python* libraries *Pandas* for processing and *Seaborn* and *Matplotlib* for plotting.","c0dbf887":"## About the data\nFor this study, *Enth* data set will be used. This data consists of two tables:\n\n- **Participant's data** - each participant answered a survey with personal questions about habits and physical questions.\n- **Environmnental and physiological measurement** - data collected by the wearable watch of each participant and by the rooms sensors.\n\nFocus on this study is set on **thermal comfort**. which was obtained by asking the participants, at different times of the day and in different spaces, how comfortable they were with the space temperature. More than 1400 answers are contained in this data set.","3a5565fa":"First observation from these figures is that female participants are comfortable with the space temperature while men seems to prefer it cooler. When comparing indoor vs. outdoor spaces seems like a high percentage of the particpants -males and females- prefer it cooler.","f2a0b37a":"### Humidity\nAs humidity, in addition to temperature, is an important feature on thermal perception could be a complement to explain thermal comfort of the participants studied here. In this case, both indoor and outdoor spaces for the three answers seems to concentrate betwenn 50 and 60% humidity. Unfortunately, this feature may not explain the results observed in this data.","0f434c30":"*Figure 2* is similar to he previous one, but this shows the percentage distribution of answers. Here is visualized how the thermal comfort answers distribute grouped by sex and indoor\/outdoor space. \n\nAmong the female participants seems to be \"No Change\" the most common answer, both in indoor and outdoor spaces, having more than 50%. A cooler temperature is prefered in both kind of spaces, reaching more than 40% in outdoor (while in indoor spaces is around 35%). A warmer temperature is near 10% for indoor spaces and below 1% outdoor.\n\nIn the case of male participants the \"Cooler\" and \"No Change\" are close for indoor spaces, having \"Cooler\" more than 50% of the answers for outdoor spaces. A warmer temperature is prefered under 1% of the answers."}}