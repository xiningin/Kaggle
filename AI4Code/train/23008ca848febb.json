{"cell_type":{"0ee503a0":"code","ff4607f9":"code","b06a2fec":"code","263a088b":"code","f5917062":"code","c4d35f54":"code","31a8a3a6":"code","bd43943d":"code","5a089ed9":"code","a367a58b":"code","b179a59d":"code","ef72eff4":"code","1722d6a3":"code","0b143306":"code","59013273":"code","cc2d4a3f":"code","fff5be38":"code","8448599c":"code","cc913649":"code","abaa1931":"code","c44862c4":"code","1ce5089f":"code","835d22ad":"code","47cdb2ff":"code","9bdb3b28":"code","f3d4a5b7":"code","8b3548b2":"code","3fb53e6c":"code","e3f997de":"code","20d8b9eb":"code","8396d341":"code","94ff9900":"code","b46a5310":"code","4fc20387":"code","a3682f3b":"code","83728c4b":"code","bfa9d4f1":"code","542f8c50":"code","2a192e56":"markdown","93426305":"markdown","36c64767":"markdown","1f984511":"markdown","442d147e":"markdown","7bf5f7c6":"markdown","23e7ac37":"markdown"},"source":{"0ee503a0":"import numpy as np\nimport pandas as pd \nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sn","ff4607f9":"dataset=pd.read_csv('..\/input\/vehicle-dataset-from-cardekho\/car data.csv')","b06a2fec":"dataset.shape","263a088b":"dataset.info()","f5917062":"dataset.head()","c4d35f54":"dataset.tail()","31a8a3a6":"dataset.select_dtypes(include=['object']).columns.tolist()","bd43943d":"print(dataset['Seller_Type'].unique())\nprint(dataset['Transmission'].unique())\nprint(dataset['Fuel_Type'].unique())","5a089ed9":"dataset.isnull().sum()","a367a58b":"new_dataset=dataset[['Year', 'Selling_Price', 'Present_Price', 'Kms_Driven',\n       'Fuel_Type', 'Seller_Type', 'Transmission', 'Owner' ]]","b179a59d":"new_dataset","ef72eff4":"new_dataset['current_year']=2020","1722d6a3":"new_dataset['car_age']=new_dataset['current_year']-new_dataset['Year']","0b143306":"new_dataset","59013273":"new_dataset.drop(columns=['Year','current_year'],inplace=True)","cc2d4a3f":"new_dataset","fff5be38":"new_dataset=pd.get_dummies(new_dataset,drop_first=True)","8448599c":"new_dataset","cc913649":"new_dataset.hist(figsize=(12,12),bins=10)","abaa1931":"corr_matrix=new_dataset.corr()\nplt.figure(figsize=(12,12))\nhm = sn.heatmap(corr_matrix,annot=True)\nplt.show()","c44862c4":"new_dataset.head()","1ce5089f":"X=new_dataset.iloc[:,1:].values\ny=new_dataset.iloc[:,0].values","835d22ad":"from sklearn.ensemble import ExtraTreesRegressor\nimport matplotlib.pyplot as plt\nmodel = ExtraTreesRegressor()\nmodel.fit(X,y)","47cdb2ff":"print(model.feature_importances_)","9bdb3b28":"feat_importances = pd.Series(model.feature_importances_)\nfeat_importances.nlargest(5).plot(kind='barh')\nplt.show()","f3d4a5b7":"from sklearn.model_selection import train_test_split\nX_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.3,random_state=0)","8b3548b2":"from sklearn.ensemble import RandomForestRegressor\nregressor = RandomForestRegressor()","3fb53e6c":"n_estimators = [int(x) for x in np.linspace(start = 100, stop = 1200, num = 12)]\nn_estimators","e3f997de":"from sklearn.model_selection import RandomizedSearchCV\nn_estimators = [int(x) for x in np.linspace(start = 100, stop = 1200, num = 12)]\nmax_features = ['auto', 'sqrt']\nmax_depth = [int(x) for x in np.linspace(5, 30, num = 6)]\nmin_samples_split = [2, 5, 10, 15, 100]\nmin_samples_leaf = [1, 2, 5, 10]","20d8b9eb":"random_grid = {'n_estimators': n_estimators,\n               'max_features': max_features,\n               'max_depth': max_depth,\n               'min_samples_split': min_samples_split,\n               'min_samples_leaf': min_samples_leaf}\n\nprint(random_grid)","8396d341":"rf = RandomForestRegressor()\nrf_random = RandomizedSearchCV(estimator = rf, param_distributions = random_grid,scoring='neg_mean_squared_error', n_iter = 10, cv = 5, verbose=2, random_state=42, n_jobs = 1)","94ff9900":"rf_random.fit(X_train,y_train)","b46a5310":"y_pred=rf_random.predict(X_test)\ny_pred","4fc20387":"sn.distplot(y_test-y_pred)","a3682f3b":"plt.scatter(y_test,y_pred)","83728c4b":"result_np = np.concatenate((y_pred.reshape(len(y_pred), 1), (y_test.reshape(len(y_test), 1))), 1)\nresult = pd.DataFrame(result_np, columns=['Prediction', 'Real_Value'])\nresult","bfa9d4f1":"from sklearn import metrics","542f8c50":"print('MAE:', metrics.mean_absolute_error(y_test, y_pred))\nprint('MSE:', metrics.mean_squared_error(y_test, y_pred))\nprint('RMSE:', np.sqrt(metrics.mean_squared_error(y_test, y_pred)))","2a192e56":"### Features\n","93426305":"### Important Feature","36c64767":"### Training Model","1f984511":"### Test Train Split","442d147e":"#### Libraries","7bf5f7c6":"## Vehicle dataset\n\nThis dataset contains information about used cars.This data can be used for a lot of purposes such as price prediction to exemplify the use of linear regression in Machine Learning.\n\nThe columns in the given dataset are as follows:\n\n1. name\n2. year\n3. selling_price\n4. km_driven\n5. fuel\n6. seller_type\n7. transmission\n8. Owner","23e7ac37":"### Encoding categorical data"}}