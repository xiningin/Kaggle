{"cell_type":{"8e76484f":"code","477aeae0":"code","42019306":"code","6b81b9c0":"code","8e15dafe":"code","2993d7d4":"code","b7bfe5fb":"code","c8012ec1":"code","a7c9c966":"code","7f31c2f5":"code","7382fb0e":"code","77c7c2c3":"code","6b3bf82f":"code","b628e9c7":"code","01b2a026":"code","e0c70a1d":"code","ca2e3992":"code","dfe466cf":"code","4b7f7ca1":"code","c9269929":"code","5a1de472":"code","813be36e":"code","2ce07a71":"code","806cf4c0":"code","91989d3f":"code","11e9af78":"code","04ee979d":"code","d9e9351f":"code","deb4f7c1":"code","51c31444":"code","7eac4645":"code","6e818811":"code","24afd3a3":"code","97051c79":"code","584a22f3":"code","52f25ee4":"code","fca28e00":"code","3695d21b":"code","dcb1ab79":"code","b726e5a1":"code","3094b199":"code","dbd6b1ed":"code","301bf654":"code","9d9b39cf":"code","c0764810":"code","7fe65755":"code","2d7b0b60":"code","0e5b2101":"code","979e9247":"code","e4a29af9":"code","d1354acd":"code","f92efe61":"code","d2179519":"code","ca513e6a":"code","431fb256":"code","83d52ac7":"code","bf5b134d":"code","36b8eecc":"code","51a161ac":"code","187afb1d":"code","e18aaa75":"code","2d8f2de1":"code","83269876":"code","83726be5":"code","36747808":"code","423591da":"code","5f314abf":"markdown","d91b3a0e":"markdown","c0b58a08":"markdown","e832d5bd":"markdown","88a72e19":"markdown","6444f82f":"markdown","8497734e":"markdown","9e49208c":"markdown","3901a8f9":"markdown","70ee3646":"markdown","76f28712":"markdown","be01ef2b":"markdown","300b2203":"markdown","8fbaa060":"markdown","54313d52":"markdown","1182eead":"markdown","c8e8c761":"markdown","c4353c14":"markdown","dcb13d83":"markdown","91991b3d":"markdown","9ec1ae54":"markdown","118af409":"markdown","8800886f":"markdown","5d7eea35":"markdown","7f659ff9":"markdown","a7618109":"markdown","45c87c3e":"markdown","45bf88ad":"markdown","78953452":"markdown","abd923e8":"markdown","51324c08":"markdown","8bbad1c4":"markdown","1ba08f47":"markdown"},"source":{"8e76484f":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline","477aeae0":"# to ignore warnings\nimport warnings as wg\nwg.filterwarnings(\"ignore\")","42019306":"pd.set_option('max_rows', None)","6b81b9c0":"data = pd.read_csv('..\/input\/customerattritionprediction\/train.csv')","8e15dafe":"data.head()","2993d7d4":"data.info()","b7bfe5fb":"data.columns","c8012ec1":"data[['ServiceSpan','QuarterlyPayment', 'GrandPayment']].describe()","a7c9c966":"data[['sex', 'Aged', 'Married', 'TotalDependents',\n       'MobileService', '4GService', 'CyberProtection', 'HardwareSupport',\n       'TechnicalAssistance', 'FilmSubscription', 'SettlementProcess',\n         'CustomerAttrition']].describe()","7f31c2f5":"x = data.drop('CustomerAttrition', axis = 'columns')\ny = data['CustomerAttrition']","7382fb0e":"from sklearn.model_selection import train_test_split","77c7c2c3":"X_train, X_test, Y_train, Y_test = train_test_split(x, y, test_size=0.2, random_state=1, stratify=y)","6b3bf82f":"X_train.head()","b628e9c7":"# Dropping ID column\nX_train = X_train.drop('ID', axis = 'columns')","01b2a026":"X_train.columns","e0c70a1d":"# Separating numerical and categorical data to understand better \n\nnum = ['ServiceSpan','QuarterlyPayment', 'GrandPayment']\ncat = ['sex', 'Aged', 'Married', 'TotalDependents', \n       'MobileService', '4GService', 'CyberProtection', 'HardwareSupport',\n       'TechnicalAssistance', 'FilmSubscription', 'SettlementProcess']","ca2e3992":"plt.style.use('ggplot')","dfe466cf":"pair = pd.concat([X_train, Y_train], axis = 'columns')","4b7f7ca1":"# Pair plot for numerical features\nsns.pairplot(vars = num, data = pair, hue = 'CustomerAttrition')","c9269929":"colormap = sns.diverging_palette(10, 220, as_cmap = True)\nsns.heatmap(X_train[num].corr(), \n            annot = True, square = True,\n           cmap = colormap)","5a1de472":"Y_train.value_counts()","813be36e":"# Visualizing the value count of customer attribution\nsns.countplot(Y_train)","2ce07a71":"for i in num:\n#    plt.figure(figsize = (12, 6))\n    fig, axes = plt.subplots(ncols=2, figsize=(15, 5))\n#    plt.subplot(index+1,2,1)\n    sns.boxplot(x = i , data = X_train, ax = axes[0])\n    \n#    plt.subplot(index+1, 2, 2)\n    sns.distplot(X_train[i], ax = axes[1])","806cf4c0":"# Checking null values in the columns\nX_train.isna().sum()","91989d3f":"X_train.columns","11e9af78":"mean_payments = X_train[['QuarterlyPayment','GrandPayment','ServiceSpan']].groupby(['ServiceSpan']).mean()\nmean_payments = mean_payments.reset_index()\nmean_payments","04ee979d":"ax = sns.lineplot(x = 'ServiceSpan', y = 'QuarterlyPayment', data = mean_payments)\nax2 = ax.twinx()\nsns.lineplot(x = 'ServiceSpan', y = 'GrandPayment', data = mean_payments, ax=ax2, color = 'b')\nplt.show()","d9e9351f":"X_train[X_train['ServiceSpan'] <= 0].shape","deb4f7c1":"X_train[X_train['ServiceSpan'] <= 0].shape","51c31444":"X_train.shape","7eac4645":"X_train[X_train['ServiceSpan'] <= 0]['ServiceSpan'].value_counts()","6e818811":"plt.figure(figsize = (10, 5))\nX_train[X_train['ServiceSpan'] <= 0]['ServiceSpan'].value_counts().plot(kind = 'bar')","24afd3a3":"negative_span_index = X_train[X_train['ServiceSpan'] < 0].index\nnegative_span_index","97051c79":"negative_span = pd.concat([X_train[X_train['ServiceSpan'] < 0], Y_train[negative_span_index]], axis = 'columns')\nnegative_span.head()","584a22f3":"sns.countplot(x = 'CustomerAttrition', data = negative_span)","52f25ee4":"f = plt.figure(figsize = (15, 18))\ni =1\nfor  c in cat:\n    f.add_subplot(4, 3, i)\n    sns.countplot(c,data=negative_span)\n    i+=1\nplt.tight_layout()\nplt.show()","fca28e00":"negative_span[['QuarterlyPayment', 'GrandPayment']].mean()","3695d21b":"negative_span[['QuarterlyPayment', 'GrandPayment']].mean().plot(kind = 'bar')\nplt.ylabel('Mean Values')","dcb1ab79":"negative_span.describe()","b726e5a1":"zero_span = X_train[X_train['ServiceSpan'] == 0]\nzero_span.head()","3094b199":"zero_span.shape","dbd6b1ed":"zero_span.index","301bf654":"sns.countplot(Y_train[zero_span.index])","9d9b39cf":"f = plt.figure(figsize = (15, 18))\ni =1\nfor  c in cat:\n    f.add_subplot(4, 3, i)\n    sns.countplot(c,data=zero_span)\n    i+=1\nplt.tight_layout()\nplt.show()","c0764810":"zero_span[['QuarterlyPayment', 'GrandPayment']].mean()","7fe65755":"zero_span[['QuarterlyPayment', 'GrandPayment']].mean().plot(kind = 'bar')\nplt.ylabel('Mean Values')","2d7b0b60":"for i in cat:\n\n    fig, axes = plt.subplots(ncols=2, figsize=(15, 5))\n\n    sns.countplot(x = i , data = negative_span, ax = axes[0])\n    sns.countplot(x = i , data = zero_span, ax = axes[1])","0e5b2101":"# We saw above that 'GrandPayment' feature has some missing values\n# Checking out the rows having missing 'GrandPayment' values\nX_train[X_train['GrandPayment'].isnull()]","979e9247":"no_payment_index = X_train[X_train['GrandPayment'].isnull()].index","e4a29af9":"Y_train[no_payment_index]","d1354acd":"no_payment = pd.concat([X_train[X_train['GrandPayment'].isnull()], Y_train[no_payment_index]], axis = 'columns')\nno_payment","f92efe61":"lesser_grand_payment = X_train[X_train['GrandPayment'] < X_train['QuarterlyPayment']]\nlesser_grand_payment.head()","d2179519":"lesser_grand_payment.shape","ca513e6a":"lesser_grand_payment_index = X_train[X_train['GrandPayment'] < X_train['QuarterlyPayment']].index","431fb256":"sns.countplot(Y_train[lesser_grand_payment_index])","83d52ac7":"f = plt.figure(figsize = (15, 18))\ni =1\nfor  c in cat:\n    f.add_subplot(4, 3, i)\n    sns.countplot(c,data=lesser_grand_payment)\n    i+=1\nplt.tight_layout()\nplt.show()","bf5b134d":"greater_grand_payment = X_train[~(X_train['GrandPayment'] < X_train['QuarterlyPayment'])]\ngreater_grand_payment.head()","36b8eecc":"sns.countplot(Y_train[greater_grand_payment.index])","51a161ac":"for i in cat:\n#    plt.figure(figsize = (12, 6))\n    fig, axes = plt.subplots(ncols=2, figsize=(15, 5))\n#    plt.subplot(index+1,2,1)\n    sns.countplot(x = i , data = lesser_grand_payment, ax = axes[0])\n    \n#    plt.subplot(index+1, 2, 2)\n    sns.countplot(x = i , data = greater_grand_payment, ax = axes[1])","187afb1d":"X_train[cat].describe()","e18aaa75":"# Checking the number of unique values in each column\nX_train[cat].nunique()","2d8f2de1":"X_train[cat].head()","83269876":"for i in cat:\n    print(X_train[i].value_counts(),'\\n')","83726be5":"f = plt.figure(figsize = (15, 18))\ni =1\nfor  c in cat:\n    f.add_subplot(4, 3, i)\n    sns.countplot(c,data=pair, hue = 'CustomerAttrition')\n    i+=1\nplt.tight_layout()\nplt.show()","36747808":"len(cat)","423591da":"# This is just other method of above visualization, nothing else\nfig, ax = plt.subplots(6, 2, figsize = [16,25])\nsns.countplot(cat[0], data = X_train, ax = ax[0][0])\nsns.countplot(cat[1], data = X_train, ax = ax[0][1])\nsns.countplot(cat[2], data = X_train, ax = ax[1][0])\nsns.countplot(cat[3], data = X_train, ax = ax[1][1])\nsns.countplot(cat[4], data = X_train, ax = ax[2][0])\nsns.countplot(cat[5], data = X_train, ax = ax[2][1])\nsns.countplot(cat[6], data = X_train, ax = ax[3][0])\nsns.countplot(cat[7], data = X_train, ax = ax[3][1])\nsns.countplot(cat[8], data = X_train, ax = ax[4][0])\nsns.countplot(cat[9], data = X_train, ax = ax[4][1])\nsns.countplot(cat[10], data = X_train, ax = ax[5][0])\n\nplt.tight_layout()","5f314abf":"## Objective","d91b3a0e":"The training dataset contains 6338 samples and the testset contains 705 samples. Each sample contains 15 features and 1 prediction variable \"CustomerAttrition\" which indicates the class of the sample. The 15 input features and 1 prediction variable are:\n\n    \"ID\", string, the Customer ID allocated to each customer,\n\n    \"sex\", string, the gender of the person,\n\n    \"Aged\", Boolean, the gender of the person,\n\n    \"Married\", Boolean, The marrital status of the person,\n\n    \"TotalDependents\", Boolean, Tells whether the person is dependent or independent,\n\n    \"ServiceSpan\", numerical, gives the timespan of the service taken by the person,\n\n    \"4GService\",string, the intenet service taken by the person ,\n\n    \"CyberProtection\", Boolean, tells if cyber protection plan of company is taken by the person or not\n\n    \"HardwareSupport\", Boolean, tells if hardware support plan of company is taken by the person or not,\n\n    \"TechnicalAssistance\", Boolean, tells if technical assistance of company is taken by the person or not,,\n\n    \"FilmSubscription\", Boolean, tells whether the person has subscribed for films,\n\n    \"SettlementProcess\", string, The payment process chosen by the person,\n\n    \"QuarterlyPayment\", numerical, The quaterly payment made by the person,\n\n    \"GrandPayment\", numerical, The cummalative payment made by the person,\n\n    \"CustomerAttrition\", Boolean, The choice of continuation of services taken by the customer,","c0b58a08":"Now I shall compare the trend of zerospan and negativespan to ensure if i merge both of them then it won't dirupt any trend for the final ML model","e832d5bd":"Like before, Customers having Zero ServiceSpan are also showing almost the same characterstics as those of Negative Service Span\n\nI guess they can be merged i.e, changing the ServiceSpan of those having negative values to 0 would do no harm","88a72e19":"It looks like those who have missing grand_payment values were disappointed and did not enroll in the service after quaterly payment and also their ServiceSpan is very less.\n\nHence, these values are missing not at random","6444f82f":"**Describing continuous numerical data**","8497734e":"In some cases GrandPayment is lesser than QuarterlyPayment, Let's have a look at that also","9e49208c":"Comparing with the record of 5070 customers only 109 have negative ServiceSpan","3901a8f9":"In this case the GrandPayment is just little bit more than quaterly payment, may be they took little bit more time than a quater","70ee3646":"### Checking missing values and outliers","76f28712":"Only 1 value has -2 ServiceSpan which should be merged with other values","be01ef2b":"It is kind of possible that most of them are FreeLancers who require these services only for a short period of time as their GrandPayment is also low","300b2203":"It looks like Customers having Negative ServiceSpan have more chances to continue the service","8fbaa060":"**Checking out numerical features**","54313d52":"**Train Test Split**","1182eead":"So, 273 Customers have either 0 or lesser than 0 ServiceSpan, Now Let's dive deep","c8e8c761":"It looks like, the reason behind the lesser grand payment has nothing to do with CustomerAttribution","c4353c14":"So, GrandPayment contains 9 missing value which are needed to be imputed","dcb13d83":"Your task is to predict the customer Attrition for each customer in the given dataset using data science models.","91991b3d":"## EDA ","9ec1ae54":"**Checking out categorical features**","118af409":" We can also see that some ServiceSpan has negative and 0 values, Let's explore them also","8800886f":"It looks like most of the customers who have negative ServiceSpan are working because most of them are not married, not aged, not dependent, \n\nRequiring good internet and mobile service but not interested in CyberProtection, HardwareSupport, FilmSubscription and TechnicalAssistance","5d7eea35":"Now, it is totally evident that those having negative ServiceSpan are those who require these service only for a short period like freelancers","7f659ff9":"Except sex all trends are same in both hence if I merge negative values to 0 then it should not affect much our ML model","a7618109":"## Problem Statement","45c87c3e":"**Loading Data**","45bf88ad":"# Customer Attrition Prediction\n### Determine the Customer Attrition from the given dataset","78953452":"**Describing categorical data**","abd923e8":"We can clearly see that ServiceSpan has negative minimum value which is not possible and requires to be changed","51324c08":"Now, Let's have a look at 0 ServiceSpan","8bbad1c4":"    We can clearly see that ServiceSpan and GrandPayment are strongly correlated \n    And ServiceSpan and QuaterlyPayment are not correlated at all","1ba08f47":"Competition Link: https:\/\/www.kaggle.com\/c\/customerattritionprediction\/leaderboard"}}