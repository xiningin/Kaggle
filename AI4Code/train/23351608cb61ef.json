{"cell_type":{"70957bae":"code","43c07405":"code","02249e77":"code","60f21e71":"code","25823b3f":"code","847ba64d":"code","30c4e139":"code","303b0de1":"code","30476ba9":"code","f10b6ebb":"code","3f4cd821":"code","7a740992":"code","52d052c2":"code","8f324799":"code","d441d939":"code","2025bc97":"code","f5ffd24b":"code","490b0026":"code","b6439345":"code","68a52c9a":"code","0c072209":"code","1b0f936d":"code","cf66a002":"code","c1c0aa73":"code","c370a90f":"code","1d8e66d8":"markdown","a60329e3":"markdown","98c35d0a":"markdown","4191bae7":"markdown","06195990":"markdown","4f1d0035":"markdown","3a412360":"markdown","ac2e8981":"markdown","40f056f4":"markdown","5ada0fec":"markdown","ecbc4607":"markdown","69feb481":"markdown","17351c0a":"markdown","653e3386":"markdown","9f2a80f5":"markdown","3539f01f":"markdown","3a28ec43":"markdown","91231f6e":"markdown","ba6677ee":"markdown"},"source":{"70957bae":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        os.path.join(dirname, filename)\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","43c07405":"import numpy as np\nimport pandas as pd\nimport torch\nimport matplotlib.pyplot as plt\nfrom glob import glob\nfrom PIL import Image\nimport time\nfrom sklearn.preprocessing import LabelEncoder\nimport seaborn as sns\nimport cv2\nfrom pathlib import Path\nfrom collections import Counter","02249e77":"dir = \"..\/input\/rice-diseases-image-dataset\/LabelledRice\/Labelled\"\n","60f21e71":"leafblast = glob(os.path.join(dir+\"\/LeafBlast\/\"+\"*\"))\nbrownspot = glob(os.path.join(dir+\"\/BrownSpot\/\"+\"*\"))\nhispa = glob(os.path.join(dir+\"\/Hispa\/\"+\"*\"))\nhealthy = glob(os.path.join(dir+\"\/Healthy\/\"+\"*\"))\nprint(\"Images with Brown Spots, Hipsa and leaf blast are \\n\"+str(len(leafblast))+\"  \\t\"+ str(len(brownspot))+\"\\t\"+str(len(leafblast)))","25823b3f":"print(\"Healthy Images are\",len(healthy))","847ba64d":"bspot = brownspot[:9]\nhealth = healthy[:9]\nhisp = hispa[:9]\nleaf = leafblast[:9]\n","30c4e139":"plt.figure(figsize=(20,35))\nfor i,k  in enumerate(bspot):\n    image = Image.open(k)\n    plt.subplot(3,3,i+1)\n    plt.imshow(image)\n    plt.title(\"Brown Spot\")\n        ","303b0de1":"plt.figure(figsize=(20,35))\nfor i,k  in enumerate(hisp):\n    image = Image.open(k)\n    plt.subplot(3,3,i+1)\n    plt.imshow(image)\n    plt.title(\"Hispa\")\n        ","30476ba9":"plt.figure(figsize=(20,35))\nfor i,k  in enumerate(leaf):\n    image = Image.open(k)\n    plt.subplot(3,3,i+1)\n    plt.imshow(image)\n    plt.title(\"Leafblast\")\n        ","f10b6ebb":"plt.figure(figsize=(20,35))\nfor i,k  in enumerate(health):\n    image = Image.open(k)\n    plt.subplot(3,3,i+1)\n    plt.imshow(image)\n    plt.title(\"Healthy\")\n        ","3f4cd821":"new_dir = \"..\/input\/cotton-disease-dataset\/Cotton Disease\/train\"\ndis_leaf = glob(os.path.join(new_dir+\"\/\"+\"diseased cotton leaf\/\"+\"*\"))\n\ndis_plant = glob(os.path.join(new_dir+\"\/\"+\"diseased cotton plant\/\"+\"*\"))\n\nfresh_leaf = glob(os.path.join(new_dir+\"\/\"+\"fresh cotton leaf\/\"+\"*\"))\n\nfresh_plant = glob(os.path.join(new_dir+\"\/\"+\"fresh cotton plant\/\"+\"*\"))\nprint(\"Number of training images for diseased leaf are \\t\"+str(len(dis_leaf))+\"\\nfor diseases plant is \\t\"+str(len(dis_plant))\n      +\"\\nfresh leaf and plant is \\t\"+ str(len(fresh_leaf)+len(fresh_plant)))\n","7a740992":"disl = dis_leaf[:9]\nplt.figure(figsize=(20,25))\n\nfor i, k in enumerate(disl):\n    img = Image.open(k)\n    plt.subplot(3,3,i+1)\n    plt.imshow(img)\n    plt.title(\"Diseased Leaf\")","52d052c2":"disp = dis_plant[:9]\nplt.figure(figsize=(20,25))\n\nfor i, k in enumerate(disp):\n    img = Image.open(k)\n    plt.subplot(3,3,i+1)\n    plt.imshow(img)\n    plt.title(\"Diseased Plant\")","8f324799":"frel = fresh_leaf[:9]\nplt.figure(figsize=(20,25))\n\nfor i, k in enumerate(frel):\n    img = Image.open(k)\n    plt.subplot(3,3,i+1)\n    plt.imshow(img)\n    plt.title(\"Fresh leaf\")","d441d939":"frep = fresh_plant[:9]\nplt.figure(figsize=(20,25))\n\nfor i, k in enumerate(frep):\n    img = Image.open(k)\n    plt.subplot(3,3,i+1)\n    plt.imshow(img)\n    plt.title(\"Fresh Plant\")","2025bc97":"import albumentations as al\nimport cv2\n","f5ffd24b":"yellow_in_disl=[]\nfor a,b in enumerate(dis_leaf):\n    image = cv2.imread(b)\n    img = cv2.cvtColor(image,cv2.COLOR_BGR2HSV)\n    low= (25,40,40)\n    high = (35,255,255)\n    yellow_mask = cv2.inRange(img,low,high)\n    yellow_in_disl.append(float(np.sum(yellow_mask))\/255\/(1024*1024))\n    \n    ","490b0026":"sum(yellow_in_disl)","b6439345":"yellow_in_frel=[]\nfor a,b in enumerate(fresh_leaf):\n    image = cv2.imread(b)\n    img = cv2.cvtColor(image,cv2.COLOR_BGR2HSV)\n    low= (25,40,40)\n    high = (35,255,255)\n    yellow_mask = cv2.inRange(img,low,high)\n    yellow_in_frel.append(float(np.sum(yellow_mask))\/255\/(1024*1024))\n    \n    ","68a52c9a":"sum(yellow_in_frel)","0c072209":"image = cv2.imread(disl[1])\nimg = cv2.cvtColor(image,cv2.COLOR_BGR2HSV)\nlow= (25,40,40)\nhigh = (35,255,255)\nyellow_mask = cv2.inRange(img,low,high)\nplt.imshow(yellow_mask)","1b0f936d":"plt.imshow(Image.open(disl[1]))","cf66a002":"image = cv2.imread(disl[1])\nimg = cv2.cvtColor(image,cv2.COLOR_BGR2HSV)\nlow= (25,40,40)\nhigh = (35,255,255)\nyellow_mask = cv2.inRange(img,low,high)\nplt.imshow(yellow_mask)","c1c0aa73":"green_in_disl=[]\nfor a,b in enumerate(dis_leaf):\n    image = cv2.imread(b)\n    img = cv2.cvtColor(image,cv2.COLOR_BGR2HSV)\n    low= (40,40,40)\n    high = (70,255,255)\n    yellow_mask = cv2.inRange(img,low,high)\n    green_in_disl.append(float(np.sum(yellow_mask))\/255\/(1024*1024))\n    \nsum(green_in_disl)\n    ","c370a90f":"green_in_frel=[]\nfor a,b in enumerate(fresh_leaf):\n    image = cv2.imread(b)\n    img = cv2.cvtColor(image,cv2.COLOR_BGR2HSV)\n    low= (40,40,40)\n    high = (70,255,255)\n    yellow_mask = cv2.inRange(img,low,high)\n    green_in_frel.append(float(np.sum(yellow_mask))\/255\/(1024*1024))\n    \nsum(green_in_frel)\n    ","1d8e66d8":"![Leaf Blast](http:\/\/www.knowledgebank.irri.org\/images\/stories\/blast-leaf.jpg)","a60329e3":"**Presence of Yellow Pixels in the images**","98c35d0a":"![Brown Spots](http:\/\/www.knowledgebank.irri.org\/images\/stories\/brown-spot-3.jpg)","4191bae7":"# Why and where it occurs\n**The presence of grassy weeds in and near rice fields as alternate hosts harbor and encourage the pest to develop. Heavily fertilized field also encourages the damage.**\n\n**Heavy rains, especially in premonsoon or earliest monsoon periods, followed by abnormally low precipitation, minimum day-night temperature differential for a number of days, and high RH are favorable for the insect\u2019s abundance.**\nSource:http:\/\/www.knowledgebank.irri.org\/training\/fact-sheets\/pest-management\/insects\/item\/rice-hispa","06195990":"# Why and where it occurs\n**Blast can occur wherever blast spores are present.**\n\n**It occurs in areas with low soil moisture, frequent and prolonged periods of rain shower, and cool temperature in the daytime. In upland rice, large day-night temperature differences that cause dew formation on leaves and overall cooler temperatures favor the development of the disease.**\n\nSource:http:\/\/www.knowledgebank.irri.org\/training\/fact-sheets\/pest-management\/diseases\/item\/blast-leaf-collar","4f1d0035":"# Brown Spots:**Why and where it occurs\nThe disease can develop in areas with high relative humidity (86\u2212100%) and temperature between 16 and 36\u00b0C. It is common in unflooded and nutrient-deficient soil, or in soils that accumulate toxic substances\n\nBrown spot can occur at all crop stages, but the infection is most critical during maximum tillering up to the ripening stages of the crop.\n\n**","3a412360":"# The following Images are totally Healthy","ac2e8981":"![Rice Hispa](http:\/\/www.knowledgebank.irri.org\/images\/stories\/factsheet-rice-hispa.jpg)","40f056f4":"# The following are fresh leaf","5ada0fec":"*As we Saw, there are higher presence of yellow pixels in the infected leaves than in the fresh leaves*","ecbc4607":"# The following plants are infected, if we don't remove the plants, the whole corps would be affected","69feb481":"# How to Identify:\n\n1. Infected seedlings have small, circular, yellow brown or brown lesions that may girdle the coleoptile and distort primary and secondary leaves.\n\n2. Starting at tillering stage, lesions can be observed on the leaves. They are initially small, circular, and dark brown to purple-brown.\n\nSource:http:\/\/www.knowledgebank.irri.org\/training\/fact-sheets\/pest-management\/diseases\/item\/brown-spot","17351c0a":"Following is Rice Hispa,Its a insects that destroys and eat rice leaves","653e3386":"# The following are fresh plants","9f2a80f5":"# Now, checking on the Cotton Images","3539f01f":"# **The following Images are of Diseased Leaf, if we can remove the leaves fast, the plant won't be affected**","3a28ec43":"Images with Brown Spot","91231f6e":"*The green pixels in fresh leaves are higher than in Infected leaves *","ba6677ee":"# Now,lets see the images"}}