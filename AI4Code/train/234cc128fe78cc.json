{"cell_type":{"04ccc2b9":"code","9ee88313":"code","d3b7bdfe":"code","17b388cf":"code","42143417":"code","45e72aa3":"code","88a9864a":"code","e63cdf2d":"code","96462faa":"code","37073854":"code","457e2841":"code","8627f296":"code","23cd0fd4":"code","644f8cc5":"code","77c9b26f":"code","8cfc7ec1":"code","35448626":"code","02446fd0":"code","cc0860f2":"code","5706d1ae":"code","14fe82f6":"code","fd9c4cba":"code","e0655ab4":"code","2fa45df6":"code","d4820e25":"code","fcf2000b":"code","ee0d14a2":"code","76510e8b":"code","eb661380":"code","589f4cfb":"code","04a534ef":"code","f3bcf2b1":"code","04f9ffdd":"markdown","43f813f9":"markdown","d323e53c":"markdown","6142f542":"markdown","4d47d710":"markdown","eb8f4f6d":"markdown"},"source":{"04ccc2b9":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt","9ee88313":"cust=pd.read_csv(\"..\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv\")","d3b7bdfe":"cust.head(5)","17b388cf":"cust.describe()","42143417":"cust[\"Gender\"].value_counts()","45e72aa3":"%matplotlib inline\nsns.distplot(cust[\"Spending Score (1-100)\"])\nplt.xlim(0,100)\n#plt.xticks(ticks=[0,10,20,30,40,50,60,70,80,90,100])\nplt.title(\"Spending Score Distribution\")","88a9864a":"sns.distplot(cust[\"Age\"],color=\"pink\")\nplt.xlim(15,70)\nplt.title(\"Age Distribution of Customers\")","e63cdf2d":"%matplotlib inline\nsns.scatterplot(cust[\"Age\"],cust[\"Spending Score (1-100)\"],color=\"green\",hue=cust[\"Gender\"])\nplt.title(\" Spending Score vs Age\")","96462faa":"sns.scatterplot(x=cust[\"Annual Income (k$)\"],y=cust[\"Spending Score (1-100)\"],hue=cust[\"Gender\"])","37073854":"cust=cust.drop('CustomerID',axis=1)\n#cust.head(5)","457e2841":"cust.head(5)","8627f296":"corr=cust.corr()","23cd0fd4":"sns.heatmap(data=corr,square=True,cmap=\"viridis\",annot=True)","644f8cc5":"cust=pd.get_dummies(cust,columns=[\"Gender\"],drop_first=True)\ncust.head(5)","77c9b26f":"cust.columns=[\"Age\",\"Annual Income\",\"Spending Score\",\"Gender\"]\ncust.head(5)","8cfc7ec1":"cust_transform=cust.copy()","35448626":"from sklearn.preprocessing import StandardScaler\nfrom sklearn.cluster import KMeans","02446fd0":"scaler=StandardScaler()","cc0860f2":"cust_transform[\"Age\"]=scaler.fit_transform(cust[\"Age\"].values.reshape(-1,1))\ncust_transform[\"Annual Income\"]=scaler.fit_transform(cust[\"Annual Income\"].values.reshape(-1,1))\ncust_transform[\"Spending Score\"]=scaler.fit_transform(cust[\"Spending Score\"].values.reshape(-1,1))","5706d1ae":"sns.scatterplot(cust_transform[\"Age\"],cust_transform[\"Spending Score\"],hue=cust_transform[\"Gender\"],color=\"pink\")\nplt.title(\"Tranformed Data (Spending Score vs Age)\")","14fe82f6":"sns.scatterplot(cust_transform[\"Annual Income\"],cust_transform[\"Spending Score\"],hue=cust_transform[\"Gender\"],color=\"pink\")\nplt.title(\"Tranformed Data (Annual Income vs Age)\")","fd9c4cba":"wcss=[]\nfor i in range(1,12):\n    kmeans=KMeans(n_clusters=i).fit(cust_transform)\n    wcss.append(kmeans.inertia_)\n    \n\nsns.lineplot(x=range(1,12),y=wcss,color=\"red\")\nplt.title(\"The Elbow method\")","e0655ab4":"kmeans_model=KMeans(n_clusters=5).fit(cust_transform)","2fa45df6":"kmeans_cluster=kmeans_model.predict(cust_transform)\nkmeans_cluster","d4820e25":"from sklearn.metrics import silhouette_score\nsilhouette_coefficients=[]\nfor i in range(2,12):\n     kmeans = KMeans(n_clusters=i)     \n     kmeans.fit(cust_transform)\n     score = silhouette_score(cust_transform, kmeans.labels_)\n     silhouette_coefficients.append(score)\n\nsns.lineplot(x=range(2,12),y=silhouette_coefficients,color=\"green\")","fcf2000b":"kmeans_model2=KMeans(n_clusters=6).fit(cust_transform)\nkmeans_cluster2=kmeans_model2.predict(cust_transform)","ee0d14a2":"cust=pd.concat([cust,pd.DataFrame({\"Cluster Number\":kmeans_cluster2})],axis=1)\ncust","76510e8b":"cust[\"Cluster Number\"].value_counts()","eb661380":"plt.figure(figsize=[10,10])\nsns.scatterplot(x=cust[\"Age\"],y=cust[\"Spending Score\"],hue=cust[\"Cluster Number\"],palette=\"Set1\",legend=\"full\",s=100)","589f4cfb":"plt.figure(figsize=[10,10])\nsns.scatterplot(x=cust[\"Annual Income\"],y=cust[\"Spending Score\"],hue=cust[\"Cluster Number\"],palette=\"Dark2\",legend=\"full\",s=100)","04a534ef":"cust.groupby(\"Cluster Number\").mean()[\"Spending Score\"].plot(kind=\"bar\",color=\"green\")","f3bcf2b1":"cust.groupby(\"Cluster Number\").mean()[[\"Age\",\"Annual Income\"]].plot(kind=\"bar\")","04f9ffdd":"# Based on the analysis we will go for 6 clusters in the dataset","43f813f9":"# Higher spending scores are assigned to indvidual between the age of 20 to 40. Age is a very important factor in determining clusters","d323e53c":"# Data Visualisation of Clusters","6142f542":"# Cluster 2 & Cluster 4 are the clusters that have high spending score. Cluster 2 largely comprises of peoeple who have high income & are mid-age. Evaluating Cluster 4 has pretty much the same age but lower income. Both clusters indicate that age is more closely related with spendings score than Income.","4d47d710":"# Data Processing","eb8f4f6d":"# Annual Income does not have a huge impact on the spending score"}}