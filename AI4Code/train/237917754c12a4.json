{"cell_type":{"e2ba91e8":"code","b2d4047f":"code","3165f679":"code","9ecd175d":"code","ea6a9169":"code","da92c605":"code","87188558":"code","a4655e70":"code","6e6d4326":"code","d5cc25c8":"markdown","1ddbbd98":"markdown","dff9d100":"markdown","0076366c":"markdown"},"source":{"e2ba91e8":"import numpy as np\nimport pandas as pd\nimport os\nimport zipfile\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport cv2\nimport skimage.io\nfrom PIL import Image","b2d4047f":"BASE_PATH = '..\/input\/prostate-cancer-grade-assessment'\n\n# cvs files\ntrain = pd.read_csv(f'{BASE_PATH}\/train.csv').set_index('image_id')\n# test = pd.read_csv(f'{BASE_PATH}\/test.csv').set_index('image_id')\n# submission = pd.read_csv(f'{BASE_PATH}\/sample_submission.csv').set_index('image_id')\n\n# image and mask directories\ntest_dir  = f'{BASE_PATH}\/test_images'\ndata_dir = f'{BASE_PATH}\/train_images'\nmask_dir  = f'{BASE_PATH}\/train_label_masks'","3165f679":"level = 1   # [0,1,2]\nbins=256","9ecd175d":"# select image_id\n# image_id = train.index[2]   # train index\nimage_id = '4517c109e23cf3b572373db82b519303'   # image_id","ea6a9169":"train.loc[image_id,:]","da92c605":"biopsy = skimage.io.MultiImage(os.path.join(data_dir, f'{image_id}.tiff'))\nmaskfile = skimage.io.MultiImage(os.path.join(mask_dir, f'{image_id}_mask.tiff'))\n\nplt.figure(figsize=(12,10))\nplt.subplot(1,2,1)\nplt.title('image_id:{}\\nisup_grade:{}'\n          .format(image_id, train.loc[image_id, 'isup_grade']))\nplt.imshow(biopsy[level])\nplt.subplot(1,2,2)\nplt.imshow(maskfile[level][:,:,0])\nplt.title('data_provider:{}\\ngleason_score:{}'\n          .format(train.loc[image_id, 'data_provider'], train.loc[image_id, 'gleason_score']))\nplt.colorbar()\nplt.show()","87188558":"print(image_id, biopsy[level].shape, train.loc[image_id, 'data_provider'], \n      'isup_grade :', train.loc[image_id, 'isup_grade'], train.loc[image_id, 'gleason_score'])","a4655e70":"def color_hist(img, maskno):\n    img = img.reshape(-1,3)\n    plt.hist(img, color=[\"red\", \"green\", \"blue\"], histtype=\"step\", bins=bins)\n    plt.title('image_id:{}\\ndata_provider:{}\\nmask label:{}'\n          .format(image_id, train.loc[image_id, 'data_provider'], maskno))\n    plt.show()","6e6d4326":"idx = maskfile[level][:,:,0]>0\ncolor_hist(biopsy[level][idx], 'non-zero')\nfor i in np.unique(maskfile[level][:,:,0]):\n    idx = maskfile[level][:,:,0]==i\n    color_hist(biopsy[level][idx], i)","d5cc25c8":"# PANDA color histograms by mask label","1ddbbd98":"# Config","dff9d100":"# View image","0076366c":"# Color Histogram"}}