{"cell_type":{"02f5d80e":"code","a91dddcc":"code","886c1912":"code","b9a45c66":"code","f650e002":"code","3d81486c":"code","c0414fdd":"code","56b7e241":"code","eaf3f80a":"code","8fd274f8":"code","d1fd913a":"code","9133269a":"code","a426bf75":"code","5f199127":"code","d4772ae5":"code","f4e30c1b":"code","27e9350e":"code","62e6ed5b":"code","2cba19d3":"code","8ae08222":"code","ef53a05f":"code","f469f38a":"code","a1661af9":"code","8d17da53":"code","58771b79":"code","ac4bb657":"code","7aa6bfd1":"code","bf771005":"code","32edafcc":"code","280755eb":"code","1a3afb7d":"markdown","0f625c07":"markdown","5a61dfc4":"markdown","95782242":"markdown","9ebdae50":"markdown"},"source":{"02f5d80e":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport warnings\nwarnings.filterwarnings(action='ignore')\nsns.set()\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","a91dddcc":"dataset = pd.read_csv('\/kaggle\/input\/insurance\/insurance.csv')\ndataset.head()","886c1912":"dataset.shape","b9a45c66":"dataset.info()","f650e002":"obj_cols = [x for x in dataset.columns if dataset[x].dtypes == 'object']\nnum_cols = [x for x in dataset.columns if dataset[x].dtypes != 'object']\n\nprint('obj : {}, len : {}'.format(obj_cols, len(obj_cols)))\nprint('num : {}, len : {}'.format(num_cols, len(num_cols)))","3d81486c":"dataset.isna().sum()","c0414fdd":"dataset.duplicated().sum()","56b7e241":"dataset.drop_duplicates(inplace=True)","eaf3f80a":"for x in obj_cols:\n    print('unique {} : {}'.format(x, dataset[x].unique()))","8fd274f8":"dataset.describe(include='all')","d1fd913a":"#Distribution of Charges\nsns.distplot(dataset['charges'])\nplt.title('Distribution of Charges', size=16)","9133269a":"fig, axs = plt.subplots(1, 3, figsize=(25,5))\nfig.suptitle('Charges with Object Columns', size=16)\n\nfor j in range(0,3):\n    axs[j] = sns.scatterplot(data=dataset, x=obj_cols[j], y='charges', hue=obj_cols[j], ax=axs[j])\n\nfig.show()","a426bf75":"fig, axs = plt.subplots(1, 3, figsize=(25,5))\nfig.suptitle('Charges with Numeric Columns', size=16)\n\nfor j in range(0,3):\n    axs[j] = sns.scatterplot(data=dataset, x=num_cols[j], y='charges', hue=num_cols[j], ax=axs[j])\n\nfig.show()","5f199127":"categorical_cols = obj_cols.copy()\ncategorical_cols.append('children')\ncategorical_cols","d4772ae5":"fig, axs = plt.subplots(2,2, figsize=(15,7))\nfig.suptitle('Categorical Data', size=16)\n\nci = 0\nfor i in range(0,2):\n    for j in range(0,2):\n        axs[i,j] = sns.barplot(y=dataset[categorical_cols[ci]].value_counts(), x=dataset[categorical_cols[ci]].value_counts().index, ax=axs[i,j])\n        axs[i,j].set_title(categorical_cols[ci], size=13)\n        axs[i,j].set_ylabel('Amount')\n        ci += 1\n\nfig.show()","f4e30c1b":"fig, axs = plt.subplots(1,3, figsize=(22,5))\naxs[0] = sns.lineplot(data=dataset, x='children', y='charges', hue='sex', marker='o', ax=axs[0])\naxs[0].set_title('Total Children Charges by Sex', size=16)\n\naxs[1] = sns.lineplot(data=dataset, x='children', y='charges', hue='smoker', marker='o', ax=axs[1])\naxs[1].set_title('Total Children Charges by Smoker', size=16)\n\naxs[2] = sns.lineplot(data=dataset, x='children', y='charges', hue='region', marker='o', ax=axs[2])\naxs[2].set_title('Total Children Charges by Region', size=16)","27e9350e":"fig, axs = plt.subplots(1,2, figsize=(17,5))\naxs[0] = sns.lineplot(data=dataset, x='region', y='charges', hue='sex', marker='o', ax=axs[0])\naxs[0].set_title('Region Charges by Sex', size=16)\n\naxs[1] = sns.lineplot(data=dataset, x='region', y='charges', hue='smoker', marker='o', ax=axs[1])\naxs[1].set_title('Region Charges by Smoker', size=16)","62e6ed5b":"plt.figure(figsize=(6,3))\nsns.lineplot(data=dataset, x='smoker', y='charges', hue='sex')\nplt.title('Smoker Charges by Sex', size=16)","2cba19d3":"from sklearn.preprocessing import LabelEncoder, StandardScaler\nle = LabelEncoder()\nss = StandardScaler()","8ae08222":"data_pre = dataset.copy()\ndata_pre.head()","ef53a05f":"#data_pre_dummies = pd.get_dummies(data_pre, drop_first=True)\nfor x in obj_cols:\n    data_pre[x] = le.fit_transform(data_pre[x])","f469f38a":"from sklearn.model_selection import train_test_split\nfrom sklearn.ensemble import GradientBoostingRegressor\nimport statsmodels.api as sm\n \nGBR = GradientBoostingRegressor()","a1661af9":"inputs = data_pre.drop(['charges'], axis=1)\noutputs = data_pre['charges']","8d17da53":"x_train, x_test, y_train, y_test = train_test_split(inputs, outputs, test_size=0.2, random_state=0)","58771b79":"reg = GBR.fit(x_train, y_train)\nreg.score(x_train, y_train).round(2)","ac4bb657":"#predict\ntable_pred = pd.DataFrame()\ntable_pred['actual'] = y_test\ntable_pred['predict'] = reg.predict(x_test).round(5)\ntable_pred","7aa6bfd1":"from sklearn.metrics import mean_squared_error, mean_absolute_error","bf771005":"print('mean_squared_error : {}'.format(mean_squared_error(table_pred['actual'], table_pred['predict'])))\nprint('mean_error : {}'.format(mean_squared_error(table_pred['actual'], table_pred['predict'], squared=False)))\nprint('mean_absolute_error : {}'.format(mean_absolute_error(table_pred['actual'], table_pred['predict'])))","32edafcc":"xline = max(max(table_pred['actual']), max(table_pred['predict']))\nyline = min(min(table_pred['actual']), min(table_pred['predict']))","280755eb":"plt.figure(figsize=(15,5))\nsns.scatterplot(table_pred['predict'], table_pred['actual'])\nplt.plot([xline, yline], [xline, yline], c='r')","1a3afb7d":"Total Children Charges by Sex :\n- The more the number of children, the costs incurred will also increase, but when children are> 3, the costs will decrease.\n- Child medical costs for Male are slightly higher than for females, but when the number of children is> 3, the cost for females is slightly higher.\n\nTotal Children Charges by Smoker:\n- Medical costs are much higher for smokers.\n\nTotal Children Charges by Region :\n- Southeast got the first position with the most expensive medical costs of the four regions.\n- Medical costs in the southwest are volatile.","0f625c07":"# Result","5a61dfc4":"# Data Visualization","95782242":"# Data Model","9ebdae50":"Medical costs for males and smokers are much higher in all areas."}}