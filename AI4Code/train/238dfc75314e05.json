{"cell_type":{"b70383ad":"code","e4367fb9":"code","a11f9331":"code","8f9243d1":"code","27da8fa1":"code","e3c1d4dc":"code","d02e2a9d":"code","33fff412":"code","0bd55a1c":"code","148931c6":"code","da57143c":"code","af00d2b8":"code","d285c4c3":"code","7bd00c70":"markdown","b2bff0c8":"markdown","59a1c902":"markdown","f40dedbf":"markdown","51de81e0":"markdown"},"source":{"b70383ad":"# utility\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set(style='darkgrid')\nimport panel as pn\npn.extension()\n\n#bigquery\nimport bq_helper\nfrom google.cloud import bigquery\nfrom bq_helper import BigQueryHelper\n\n#folium\nimport folium\nfrom folium import plugins\nfrom folium.plugins import HeatMap\nimport bq_helper\n\nimport ipywidgets as widgets\nfrom ipywidgets import interact, interact_manual\nimport pycountry","e4367fb9":"client = bigquery.Client()\n\n# Helper object\nopenAQ = bq_helper.BigQueryHelper(active_project='bigquery-public-data',\n                                 dataset_name='openaq')\n# List of table\nopenAQ.list_tables()","a11f9331":"query1 = \"\"\"\n        SELECT DISTINCT \n        pollutant, \n        value,\n        latitude,\n        longitude,\n        city,\n        FROM `bigquery-public-data.openaq.global_air_quality` \n        WHERE timestamp >'2020-01-01'\n        \"\"\"","8f9243d1":"world_map = openAQ.query_to_pandas_safe(query1)\nworld_map.head(3)","27da8fa1":"pollutant_level=world_map[world_map.pollutant=='co']\npollutant=pollutant_level[['latitude','longitude','value']]\nm = folium.Map([42.50, 12.50], tiles='CartoDB Positron', zoom_start=2,zoom_control=True,\n               scrollWheelZoom=False,\n               dragging=True)\nHeatMap(pollutant, min_opacity=0.4).add_to(m)\n\nfolium.LayerControl().add_to(m)\n\nHeatMap(pollutant,radius=0.001).add_to(folium.FeatureGroup(name='Heat Map').add_to(m))\nfolium.LayerControl().add_to(m)\n\nloc = 'Carbon Monoxide(CO) Level in 2020'\ntitle_html = '''<h3 align=\"right\" style=\"font-size:1; font-family:'Helvetica'\"><b>{}<\/b><\/h3>\n             '''.format(loc)   \n\nm.get_root().html.add_child(folium.Element(title_html))\nm","e3c1d4dc":"query2 = \"\"\"\n        SELECT DISTINCT \n        pollutant, \n        value,\n        country,\n        EXTRACT(YEAR FROM timestamp) as year,\n        EXTRACT(MONTH FROM timestamp) as month\n        FROM `bigquery-public-data.openaq.global_air_quality` \n        WHERE country='IT' and timestamp > '2019-01-01'\n        \"\"\"","d02e2a9d":"countries= openAQ.query_to_pandas_safe(query2)","33fff412":"plt.figure(figsize=(15,7))\nsns.barplot(data=countries,x='year',y='value',hue='pollutant',edgecolor='black',linewidth=1)\nplt.title('Italy - Average pollutants value between 2019-2020',size=17)\nplt.xlabel(\"\")\nplt.show()","0bd55a1c":"it_poll = countries[countries.year==2020]\n# Plot 2020\nplt.figure(figsize=(17,5))\nax=sns.barplot(data=it_poll,x='month',y='value',hue='pollutant',edgecolor='black')\nax.set_xticklabels(['January','February','March','April','May','June','July'])\nplt.title('Italy- Average pollutants value during 2020',size=17)\nplt.xlabel('')\nplt.show()","148931c6":"query3 = \"\"\"\n        SELECT DISTINCT \n        pollutant, \n        value,\n        country,\n        city,\n        EXTRACT(YEAR FROM timestamp) as year,\n        EXTRACT(MONTH FROM timestamp) as month\n        FROM `bigquery-public-data.openaq.global_air_quality` \n        WHERE country='IT' and timestamp > '2020-01-01'\n        \"\"\"","da57143c":"it_cities= openAQ.query_to_pandas_safe(query3)","af00d2b8":"it_cities=it_cities.groupby(['pollutant','city'])['value'].mean().reset_index()","d285c4c3":"poll = it_cities[\"pollutant\"].unique()\nfig, axes = plt.subplots(1,len(poll),figsize=(17,5)) \n\nfor pol, ax in zip(poll, axes):\n    it_cities[it_cities.pollutant==pol].groupby('city')['value'].mean().reset_index().sort_values(by='value',ascending=False)[:5].plot(kind='bar',x='city',edgecolor='black',ax=ax)    \n    ax.set_title(pol)\n    ax.legend('')\n    ax.set_xlabel('',rotation=90)\n    plt.tight_layout()\n","7bd00c70":"# A quick deeper look into Italy's behaviour","b2bff0c8":"**Has there been a decrease in pollutants?**","59a1c902":"## Most polluted cities for pollutant in 2020","f40dedbf":"# Introduction \n\nIn this Paper we're gonna investigate pollution level between 2019-2020 in some countries to see if there are relevant differences due maybe to covid-19 impact on mobility and industry development:\n\nThings to know for better understanding this paper:\n\n* Sulphur dioxide ( SO2 ) : This contaminant is mainly emitted during the combustion of fossil fuels such as crude oil and coal.\n* Carbon monoxide ( CO ) : This gas consists during incomplete combustion of fuels example : A car engine running in a closed room.\n* Nitrogen dioxide ( NO2 ) : These contaminants are emitted by traffic, combustion installations and the industries.\n* Ozone ( O3 ) : Ozone is created through the influence of ultra violet sunlight (UV) on pollutants in the outside air.\n* Particulate Matter ( PM ) : Particulate matter is the sum of all solid and liquid particles suspended in air. This complex mixture includes both organic and inorganic particles, such as dust, pollen, soot, smoke, and liquid droplets. ","51de81e0":"# Carbon Monoxide Level around the world in 2020 "}}