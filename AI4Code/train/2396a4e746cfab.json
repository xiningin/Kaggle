{"cell_type":{"2e9e95ce":"code","a9861913":"code","fdfa5acd":"code","37138620":"code","885d8fc5":"code","376548cd":"code","9ad116d7":"code","39adb52e":"code","9bcf4245":"code","961be6a7":"code","9470c282":"code","3ae397b2":"code","710d1a1f":"code","96a48f9c":"code","87e48d00":"code","39eca6c2":"code","dbcf9cc7":"code","40866fff":"code","4390b770":"code","c7cfe6e0":"code","5df263e8":"code","6bbfe83f":"code","38c911c4":"code","81f84c6f":"code","9351d7ab":"code","191ff748":"code","40ca49a5":"code","07506acb":"code","f01cf813":"code","9ec3d1cb":"code","b6ce4d1c":"code","7af55bdd":"code","e2693a08":"markdown","56600cd8":"markdown","23093e7e":"markdown","7e7b213e":"markdown","358ea19f":"markdown","cf36b27d":"markdown","4baca37f":"markdown","90cd0700":"markdown","13d0f305":"markdown","1bddc18f":"markdown","2ad091ea":"markdown","35c1fe5a":"markdown","f101e191":"markdown","a10e303d":"markdown","acf2613b":"markdown","80e6e98f":"markdown","ac02d08b":"markdown","70938dde":"markdown"},"source":{"2e9e95ce":"import matplotlib.pyplot as plt \nimport tensorflow as tf\nfrom tensorflow import keras\nfrom tensorflow.keras import optimizers, losses, datasets\nfrom tensorflow.keras.models import Sequential\nfrom tensorflow.keras.layers import Dense, Dropout\nimport numpy as np\ntf.__version__","a9861913":"(train_images, train_labels),(test_images, test_labels) = datasets.mnist.load_data()","fdfa5acd":"plt.imshow(train_images[0], cmap = \"Greys\") \nprint(\"label'i =\", train_labels[0])","37138620":"train_images.shape","885d8fc5":"len(train_labels)","376548cd":"test_images.shape","9ad116d7":"len(test_labels)","39adb52e":"shape_size = 28*28","9bcf4245":"train_images = train_images.reshape(-1, shape_size)\/255.0\ntest_images = test_images.reshape(-1, shape_size)\/255.0","961be6a7":"train_images.shape","9470c282":"model = Sequential([\n    Dense(512, activation='relu', input_dim = shape_size),\n    Dense(256, activation='relu'),\n    Dense(10, activation='softmax')\n])","3ae397b2":"model.compile(optimizer='adam',\n              loss=tf.keras.losses.SparseCategoricalCrossentropy(from_logits=True),\n              metrics=['accuracy'])","710d1a1f":"model.summary()","96a48f9c":"model.fit(train_images, train_labels, epochs=10)","87e48d00":"test_loss, test_acc = model.evaluate(test_images,  test_labels, verbose=2)\n\nprint('\\nTest accuracy:', test_acc)","39eca6c2":"model = Sequential([\n    Dense(256, activation='relu', input_dim = shape_size),\n    Dropout(0.2),\n    Dense(128, activation='relu'),\n    Dense(10, activation='softmax')\n])","dbcf9cc7":"model.compile(optimizer='adam',\n              loss=tf.keras.losses.SparseCategoricalCrossentropy(from_logits=True),\n              metrics=['accuracy'])","40866fff":"model.summary()","4390b770":"model.fit(train_images, train_labels, epochs=10)","c7cfe6e0":"test_loss, test_acc = model.evaluate(test_images,  test_labels, verbose=2)\n\nprint('\\nTest accuracy:', test_acc)","5df263e8":"predictions = model.predict(test_images)","6bbfe83f":"predictions[0]","38c911c4":"np.argmax(predictions[0])","81f84c6f":"test_labels[0]","9351d7ab":"from sklearn.metrics import confusion_matrix","191ff748":"len(test_labels)","40ca49a5":"max_deger = []\nfor i in range(0,len(test_labels)):\n    max_deger.append(np.argmax(predictions[i]))","07506acb":"type(max_deger)","f01cf813":"cm = confusion_matrix(test_labels,max_deger)\nprint(cm)","9ec3d1cb":"from tensorflow.keras.preprocessing.image import load_img,img_to_array,array_to_img ","b6ce4d1c":"def img_yukle(filename):\n    img = load_img(filename,color_mode = \"grayscale\",target_size=(28, 28))\n    plt.imshow(img,cmap='Greys')\n    img = img_to_array(img)\n    img = img.reshape(1, 784)\n    img = img.astype('float32')\n    img = img \/ 255.0\n    return img","7af55bdd":"tahmin_img=img_yukle(\"..\/input\/benim-rakamlarm\/3.JPG\")\npred = model.predict(tahmin_img)\nprint(\" Tahmin :\",pred.argmax())","e2693a08":"Data \u00fczerinden biraz bilgi sahibi olal\u0131m 60000 tane e\u011fitim g\u00f6rselimiz varm\u0131\u015f ayn\u0131 \u015fekilde bunlar\u0131n her biri 28x28 pixel boyutundaym\u0131\u015f.","56600cd8":"test verilerinde ise 10000 label ve g\u00f6rsel oldu\u011funu g\u00f6r\u00fcyoruz.","23093e7e":"G\u00f6r\u00fcld\u00fc\u011f\u00fc gibi az \u00f6nce bahsetti\u011fim olaya \u00e7\u0131kt\u0131. \u015fimdi yava\u015ftan modelimizi olu\u015fturmaya ge\u00e7elim.","7e7b213e":"k\u0131saca dropouttan da bahsedeyim dropout e\u011fitim a\u015fams\u0131nda baz\u0131 katmanlar\u0131 kapatarak a\u015f\u0131r\u0131 \u00f6\u011frenmeyi \u00f6nlemeye y\u00f6nelik bir y\u00f6ntem i\u00e7ine yazd\u0131\u011f\u0131m say\u0131 0-1 aras\u0131nda bir de\u011fer al\u0131r ve o oranda kapatma i\u015flemi yapar. Ama bu da sezgisel bir orand\u0131r yani kesin bir kural yok burada da.","358ea19f":"\nG\u00f6rseli almaktan k\u0131saca bahsedeyim tensorflow'un k\u00fct\u00fcphanesi var bu k\u00fc\u00fctphaneden gerekli fonksiyonlar\u0131 import ettim ve bir fonksiyon i\u00e7inde bu fonksiyonlar\u0131 kulland\u0131m. color_mode = \"grayscale\" g\u00f6rseli siyah-beyaz gri tonlu g\u00f6rsele \u00e7eviriyor. target_size=(28, 28) ise t\u00fcm e\u011fitimi ve testi yapt\u0131\u011f\u0131m \u00e7\u00f6z\u00fcn\u00fcrl\u00fck de\u011feriydi g\u00f6rseli de ona g\u00f6re boyutland\u0131r\u0131yor. ve reshape ile 0-1 aras\u0131nda scale etme i\u015flemi yap\u0131yor. ","cf36b27d":"MNIST datasetini projeye dahil ettik train_images ile ifade etti\u011fim makine \u00f6\u011frenmesinde kulland\u0131\u011f\u0131m\u0131z X_train asl\u0131nda ayn\u0131 \u015fekilde train_labels de y_train ama ben burada bu \u015fekilde bir isimlendirme yapt\u0131m.","4baca37f":"Yak\u0131n bir sonu\u00e7 ald\u0131 modelimize dropout ekleyerek tekrardan deneyelim bakal\u0131m nas\u0131l sonu\u00e7 verecek.","90cd0700":"%97.59 do\u011fruluk oran\u0131na sahip modelimiz ayn\u0131 zamanda loss de\u011ferini de 1.4868'e kadar d\u00fc\u015f\u00fcrmeyi ba\u015farm\u0131\u015f. test verilerimizle tahminde bulunup bakal\u0131m ger\u00e7ekten ba\u015far\u0131l\u0131m\u0131 g\u00f6relim.","13d0f305":"Ayn\u0131 \u015fekilde bu g\u00f6rseller kar\u015f\u0131l\u0131k labellar da 60000 adet.","1bddc18f":"Model olu\u015fturmak i\u00e7in 2 y\u00f6ntem var bunlardan birisi model = sequential() diyip model.add diyerek modeli modifiye etmek di\u011fer bir tarz da model  sequential([.....]) modelin i\u00e7inde bunlar\u0131 tan\u0131mlamak.","2ad091ea":"Makine \u00f6\u011frenmesi modellerinde yapt\u0131\u011f\u0131m\u0131z gibi karma\u015f\u0131kl\u0131k matrisi \u00e7izdirmek istedim.","35c1fe5a":"Her g\u00f6rsele bir de label ile ifade edilmi\u015f bir \u00f6rnekle g\u00f6sterdim. cmap = \"Greys\" ifadesi g\u00f6rseli siyah beyaz aras\u0131nda gri tonlarda g\u00f6stermeye yarayan bir k\u0131s\u0131m.","f101e191":"Tamamd\u0131r e\u011fitim verisi ile e\u011fittim, test verileri test ettim peki ben bir say\u0131 \u00e7izip sordu\u011fumda onlar\u0131 tahmin edebilecek mi? ben bilgisayarda bir ka\u00e7 tane rakam \u00e7izdim onlar\u0131 tahmin ettirmek i\u00e7in dosyalar\u0131n\u0131 okuyup modelime sordum.","a10e303d":"i\u015fte bizim yapay sinir a\u011f\u0131m\u0131za bu verileri verirken bunlar\u0131 tek boyutlu halde vermemiz gerekiyor bu nedenle 2 boyutlu diziyi tek boyutlu hale az \u00f6nce g\u00f6sterdi\u011fim 3 boyutlu diziyide mant\u0131k olarak 2 boyutlu hale getirmi\u015f oluyoruz. (-1 oray\u0131 doldurmaya yarayan bir de\u011fer) 225.0'a b\u00f6lmemizin kerameti nedir o da \u015fundan dolay\u0131 yapay sinir a\u011flar\u0131 0-1 aras\u0131nda \u00f6l\u00e7eklendirmi\u015f verileri i\u015fliyorlar bu durumda her pixelin de\u011feri 0-255 aras\u0131nda oldu\u011fu i\u00e7in 255'e b\u00f6l\u00fcyoruz ki hepsi 0-1 aras\u0131nda \u00f6l\u00e7eklenmi\u015f olsun. ","acf2613b":"Burada ne yapt\u0131m k\u0131saca \u00f6zetliyeyim. g\u00f6rsellerimizin her biri 28x28 2 boyutlu say\u0131 dizileridir her pixel 0\/255 aras\u0131nda bir de\u011fere sahiptir ve bu de\u011fer onun siyahla beyaz aras\u0131ndaki gri tonunu verir 0 beyaz 255 siyaht\u0131r. ","80e6e98f":"Modeli haz\u0131rlad\u0131k fit etmeden \u00f6nce bu model ne ifade ediyor a\u00e7\u0131klayay\u0131m biraz. \u00f6ncelikle modelimizde kulland\u0131\u011f\u0131m\u0131z katmanlar\u0131 g\u00f6rmek i\u00e7in model.summary() fonksiyonunu kulland\u0131m. Dense bizim n\u00f6ral a\u011fa bir katman eklememizi sa\u011fl\u0131yor ilk girdi\u011fimiz parametre 512,256 ve 10 bizim o katmanda ka\u00e7 adet n\u00f6rondan olu\u015fmas\u0131n\u0131 istedi\u011fimizi ifade ediyoruz. bu say\u0131lar\u0131n fazla olmas\u0131 modelin fit edilme s\u00fcresini de art\u0131r\u0131yor o y\u00fczden bu say\u0131lar\u0131 tercih ettim burada daha fazla n\u00f6ronun olmas\u0131 ba\u015fra\u0131y\u0131 art\u0131racak diye bir kesin kuralda yok onu da vurgulayay\u0131m. 2 gizli katmandan olu\u015fuyor yapay sinir a\u011f\u0131m bu katmanlarda aktivasyon fonksiyonu olarak relu'yu tercih ettim. 1 adet \u00e7\u0131k\u0131\u015f katman\u0131 var onda da softmax'i tercih ettim \u00e7\u00fcnk\u00fc en fazla olan de\u011feri d\u00f6d\u00fcrd\u00fc\u011f\u00fc i\u00e7in say\u0131 tahmininde i\u015fe yarayaca\u011f\u0131n\u0131 d\u00fc\u015f\u00fcnd\u00fcm. ","ac02d08b":"Tabi bununla bitmiyor birde modelimizi compile etmemiz gerekiyor. bir optimizer parametresi se\u00e7memiz gerekiyor Keras veya Tensorflow internet sitelerinde bu parametreler anlat\u0131l\u0131yor ben adam se\u00e7tim \"Adam optimization is a stochastic gradient descent method that is based on adaptive estimation of first-order and second-order moments.\" Adam stokastic gradyan ini\u015fi kullan\u0131yor yani s\u00fcrekli azalan miktarda art\u0131rma veya azaltma yap\u0131yor sinapslar\u0131n a\u011f\u0131rl\u0131klar\u0131nda. Y\u0131\u011f\u0131n yakla\u015f\u0131m\u0131 kullan\u0131larak olu\u015fturdu\u011fumuz modelimizi a\u011f\u0131rl\u0131k art\u0131rma yada azaltma karar\u0131n\u0131 epochlarla sa\u011fl\u0131yoruz 12 se\u00e7tim ben 12 kere t\u00fcm veriyi inceliyip i\u015flemde bulunyor.","70938dde":"Bitirmeden \u00f6nce Carnegie Mellon \u00dcniversitesi'nin bir \u00f6\u011frencisi Adam Hartley'in benim olu\u015fturdu\u011fum sinir a\u011f\u0131n\u0131 g\u00f6rsel olarak payla\u015fm\u0131\u015f onun linkini at\u0131yorum. https:\/\/www.cs.cmu.edu\/~aharley\/vis\/fc\/flat.html"}}