{"cell_type":{"56ee9b44":"code","3b4a56a7":"code","fe69cf14":"code","270ce1f3":"code","fefbf1fb":"code","6e7c63a6":"code","8dcef48c":"code","63245866":"code","b8ca5586":"markdown","4792435e":"markdown","6054a332":"markdown"},"source":{"56ee9b44":"from matplotlib import pyplot as plt\nfrom matplotlib.colors import ListedColormap\nimport os\nfrom os import listdir\nfrom os.path import isfile, join\nimport numpy as np","3b4a56a7":"train_path = '\/kaggle\/input\/apple-rotting-segmentation-problem-in-the-wild\/apples_segmentation\/apples_segmentation\/max_data\/train\/'\nbackgrounds_path = '\/kaggle\/input\/apple-rotting-segmentation-problem-in-the-wild\/apples_segmentation\/apples_segmentation\/Sk_background\/'\nwild_test_path = '\/kaggle\/input\/apple-rotting-segmentation-problem-in-the-wild\/test_wild\/test_wild\/'","fe69cf14":"train_images = [join(train_path, f) for f in listdir(train_path) if isfile(join(train_path, f)) and f.split('.')[-1].lower() == 'jpg']\nbackgrounds_images = [join(backgrounds_path, f) for f in listdir(backgrounds_path) if isfile(join(backgrounds_path, f)) and f.split('.')[-1].lower() == 'jpg']\nwild_test_images = [join(wild_test_path, f) for f in listdir(wild_test_path) if isfile(join(wild_test_path, f)) and f.split('.')[-1].lower() == 'jpg']","270ce1f3":"def load_lab_mask(mask_path):\n    '''\n    Loads lab masks.\n    These masks originally had more types of apple rotting, so we are simplifying them.\n    '''\n    mask = plt.imread(mask_path)\n    mask = (mask * 255).astype('uint8')\n    \n    mask_1 = np.where(mask == 2, 2, 0) + np.where(mask == 3, 2, 0) + np.where(mask == 1, 2, 0)\n    mask_2 = np.where(mask == 4, 1, 0)\n    mask = (mask_1 + mask_2).astype('uint8')\n    \n    return mask\n\ndef load_wild_mask(mask_path):\n    mask = plt.imread(mask_path)\n    mask = (mask * 255).astype('uint8')\n\n    return mask[:, :, 0]","fefbf1fb":"def show_img_with_mask(img_path):\n    \n    img = plt.imread(img_path)\n    mask_path = img_path.replace('.jpg', '.png').replace('obj', 'msk')\n    \n    if 'apples_segmentation' in img_path:\n        mask = load_lab_mask(mask_path)\n    else:\n        mask = load_wild_mask(mask_path)\n    \n    fig, axs = plt.subplots(1, 2, figsize=(12, 18))\n    cmap = ListedColormap([[0, 0, 0], [.3, .8, .3], [1, 0, 0]])\n    \n    for ax in axs:\n        ax.set_xticks([])\n        ax.set_yticks([])\n    \n    axs[0].imshow(img)\n    axs[1].imshow(mask, cmap=cmap)\n    \n    plt.show()","6e7c63a6":"for i in range(0, 20, 4):\n    show_img_with_mask(train_images[i])","8dcef48c":"for i in range(0, 9, 3):\n    show_img_with_mask(wild_test_images[i])","63245866":"for i in range(5):\n    plt.imshow(plt.imread(backgrounds_images[i]))\n    plt.show()","b8ca5586":"## Lab images samples","4792435e":"## Wild images samples","6054a332":"## Background images samples"}}