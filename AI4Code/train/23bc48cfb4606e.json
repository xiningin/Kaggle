{"cell_type":{"a16465e7":"code","cf432c33":"code","75c0b212":"code","5380a8b7":"code","fb255b31":"code","1299f8f2":"code","3bea958f":"code","772ab6ba":"code","70f6ffc2":"code","1e6e34db":"code","7036bf26":"code","4e3f810d":"code","0af69f80":"markdown"},"source":{"a16465e7":"import numpy as np\nfrom keras.models import Sequential\nfrom keras.layers import Dense\nfrom keras.layers import Dropout\nfrom keras.layers import Flatten\nfrom keras.layers.convolutional import Conv2D\nfrom keras.layers.convolutional import MaxPooling2D\nfrom keras.utils import np_utils\nimport pandas as pd\n\n# fix dimension ordering issue\n# https:\/\/stackoverflow.com\/questions\/39547279\/loading-weights-in-th-format-when-keras-is-set-to-tf-format\nfrom keras import backend as K\nK.set_image_dim_ordering('th')","cf432c33":"from keras.applications.inception_v3 import InceptionV3\nweights = '..\/input\/inceptionv3\/inception_v3_weights_tf_dim_ordering_tf_kernels.h5'\nmodel = InceptionV3(weights=weights)\nprint (model.summary())","75c0b212":"from os import makedirs\nfrom os.path import join, exists, expanduser\n\ncache_dir = expanduser(join('~', '.keras'))\nif not exists(cache_dir):\n    makedirs(cache_dir)\nmodels_dir = join(cache_dir, 'models')\nif not exists(models_dir):\n    makedirs(models_dir)\n!cp  ..\/input\/inceptionv3\/* ~\/.keras\/models\/","5380a8b7":"from keras.applications.inception_v3 import preprocess_input, decode_predictions\nimport time\n\ncurrent_milli_time = lambda: int(round(time.time() * 1000))","fb255b31":"from keras.preprocessing import image\nimg_path = \"..\/input\/dogs-vs-cats-redux-kernels-edition\/train\/dog.4444.jpg\"\nimg = image.load_img(img_path, target_size=(224, 224))\nimg","1299f8f2":"img = image.img_to_array(img)\nimg = np.expand_dims(img, axis=0)\nimg = preprocess_input(img)\n\nstart = current_milli_time()\npreds = model.predict(img)\nend = current_milli_time()\nprint('Predicted in {} ms: {}'.format(end-start, decode_predictions(preds, top=3)[0]))","3bea958f":"from keras.preprocessing import image\nimg_path = \"..\/input\/dogs-vs-cats-redux-kernels-edition\/train\/cat.5555.jpg\"\nimg = image.load_img(img_path, target_size=(224, 224))\nimg","772ab6ba":"img = image.img_to_array(img)\nimg = np.expand_dims(img, axis=0)\nimg = preprocess_input(img)\n\nstart = current_milli_time()\npreds = model.predict(img)\nend = current_milli_time()\nprint('Predicted in {} ms: {}'.format(end-start, decode_predictions(preds, top=3)[0]))","70f6ffc2":"from keras.preprocessing import image\nimg_path = \"..\/input\/flowers-recognition\/flowers\/flowers\/daisy\/34539556222_f7ba32f704_n.jpg\"\nimg = image.load_img(img_path, target_size=(224, 224))\nimg","1e6e34db":"img = image.img_to_array(img)\nimg = np.expand_dims(img, axis=0)\nimg = preprocess_input(img)\n\nstart = current_milli_time()\npreds = model.predict(img)\nend = current_milli_time()\nprint('Predicted in {} ms: {}'.format(end-start, decode_predictions(preds, top=3)[0]))","7036bf26":"from keras.preprocessing import image\nimg_path = \"..\/input\/flowers-recognition\/flowers\/flowers\/rose\/9609569441_eeb8566e94.jpg\"\nimg = image.load_img(img_path, target_size=(224, 224))\nimg","4e3f810d":"img = image.img_to_array(img)\nimg = np.expand_dims(img, axis=0)\nimg = preprocess_input(img)\n\nstart = current_milli_time()\npreds = model.predict(img)\nend = current_milli_time()\nprint('Predicted in {} ms: {}'.format(end-start, decode_predictions(preds, top=3)[0]))","0af69f80":"**InceptionV3**\n\n* https:\/\/ai.googleblog.com\/2016\/03\/train-your-own-image-classifier-with.html\n* https:\/\/arxiv.org\/abs\/1512.00567"}}