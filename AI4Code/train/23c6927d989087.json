{"cell_type":{"756e86ab":"code","107e4fda":"code","878a7910":"code","b8197568":"code","b700c094":"code","8a41888f":"code","4bae3fff":"code","8963a3f6":"code","6c0d08c2":"code","b98d1c5b":"code","ec4cb00c":"code","cf0b228a":"code","9747ad1c":"code","7160029b":"code","465f6856":"code","a1b432ad":"code","6b2db0c4":"markdown","eb7a1d71":"markdown","27061117":"markdown","8e83edc9":"markdown","d728c227":"markdown","3d1e0dfd":"markdown","5c8818d0":"markdown","d37fba54":"markdown"},"source":{"756e86ab":"# largely based on https:\/\/www.kaggle.com\/jonathonv\/football-matches-data-analysis, credit to the author for much of this code\n\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\ndf=pd.read_csv(\"..\/input\/Bundesliga_Results.csv\")\nlen(df)\ndf.head(5)","107e4fda":"df['result'] = 'draw'\ndf.loc[df['FTHG'] > df['FTAG'], 'result'] = 'home'\ndf.loc[df['FTAG'] > df['FTHG'], 'result'] = 'visitor'\ndf.groupby('result')['result'].count()","878a7910":"df.groupby('result')['result'].count().plot(kind='pie', autopct='%1.1f%%', figsize=(4,4))","b8197568":"df['total_goals'] = df['FTAG'] + df['FTHG']\ndf.groupby('Season')['total_goals'].sum().plot()","b700c094":"# show the number of unique teams that have played in the PL\ndf['HomeTeam'].nunique()","8a41888f":"# show average goals per game per season \nab = df.groupby('Season')['total_goals'].mean().plot(kind=\"bar\", title=\"Avg. Goals Per Game Per Season\", figsize=(12, 8))\nab.set_xlabel(\"Season\")\nab.set_ylabel(\"Average Goals\")","4bae3fff":"# determine number of games per month and day\ndf['game_date'] = pd.to_datetime(df['Date'])\ndf['game_month'] = df['game_date'].dt.month\ndf['game_weekday'] = df['game_date'].dt.weekday\n# by month\ndf.groupby([df['game_date'].dt.month])[\"Div\"].count().plot(kind='bar')","8963a3f6":"# by week day - most games are on saturday\ndf.groupby('game_weekday')['Div'].count().plot(kind='bar')\n# where 0 = monday and so forth","6c0d08c2":"#goals per month\ndf.groupby('game_month')['total_goals'].sum().plot(kind='bar')","b98d1c5b":"# Goals per gameday\ndf.groupby('game_weekday')['total_goals'].sum().plot(kind='bar')","ec4cb00c":"# How many home and visitor wins added as new columns\ndf = df.merge(pd.get_dummies(df['result']), left_index=True, right_index=True)\ndf['home_wins_this_season'] = df.groupby(['Season','HomeTeam'])['home'].transform('sum')\ndf['visitor_wins_this_season'] = df.groupby(['Season','AwayTeam'])['visitor'].transform('sum')","cf0b228a":"# Which teams win the most home games on average \n(\n    df.groupby(['HomeTeam'])['home_wins_this_season']\n    .agg(['count','mean'])\n    .sort_values(ascending=False, by='mean')\n    .round(1)\n    .head(10)\n)","9747ad1c":"# Which teams win the most away games on average\n(\n    df.groupby(['AwayTeam'])['visitor_wins_this_season']\n    .agg(['count','mean'])\n    .sort_values(ascending=False, by='mean')\n    .round(1)\n    .head(10)\n)","7160029b":"# tally up the results \nvisitor_results = (df\n                   .groupby(['Season', 'AwayTeam'])['visitor']\n                   .sum()\n                   .reset_index()\n                   .rename(columns={'AwayTeam': 'team',\n                                    'visitor': 'visitor_wins'}))\n\nhome_results = (df\n                 .groupby(['Season', 'HomeTeam'])['home']\n                 .sum()\n                 .reset_index()\n                 .rename(columns={'HomeTeam': 'team',\n                                  'home': 'home_wins'}))\n\nwins_per_season = visitor_results.merge(home_results, on=['Season', 'team'])\n\nwins_per_season['total_wins'] = wins_per_season['visitor_wins'] + wins_per_season['home_wins']\nwins_per_season.head(5)","465f6856":"# Make a heatmap of wins over time\ntotal_wins_sorted_desc = (wins_per_season\n                          .groupby(['team'])['total_wins']\n                          .sum()\n                          .sort_values(ascending=False)\n                          .reset_index()['team'])\n\nwins_per_season_pivot = (wins_per_season\n                         .pivot_table(index='team',\n                                      columns='Season',\n                                      values='total_wins')\n                         .fillna(0)\n                         .reindex(total_wins_sorted_desc))\n\nplt.figure(figsize=(10, 20))\nsns.heatmap(wins_per_season_pivot, cmap='viridis')","a1b432ad":"# showing dot plot of wins per team per home\/away\nsns.set(style=\"whitegrid\")\nwps = wins_per_season.groupby(['team'])['total_wins','home_wins','visitor_wins'].sum().reset_index()\ng = sns.PairGrid(wps.sort_values(\"total_wins\", ascending=False),\n                 x_vars=wps.columns[1:], y_vars=[\"team\"],\n                 size=10, aspect=.25)\n\n# Draw a dot plot using the stripplot function\ng.map(sns.stripplot, size=10, orient=\"h\",\n      palette=\"Reds_r\", edgecolor=\"gray\")\n\n# Use the same x axis limits on all columns and add better labels\ng.set(xlabel=\"Wins\", ylabel=\"\")\n\n# Add titles for the columns\ntitles = [\"Total Wins\", \"Home Wins\", \"Away Wins\"]\n\nfor ax, title in zip(g.axes.flat, titles):\n\n    # Set a different title for each axes\n    ax.set(title=title)\n\n    # Make the grid horizontal instead of vertical\n    ax.xaxis.grid(False)\n    ax.yaxis.grid(True)\n\nsns.despine(left=True, bottom=True)","6b2db0c4":"You'll see above that some columns contain NaN. The first two seasons did not have half time results recorded, however the set will be updated with those results in the future. ","eb7a1d71":"Next we will examine the home and away wins per team and chart them.","27061117":"Next, we are going to create a results column that records whether the home team or away team won, or if there was a draw, accompanied by a pie chart.","8e83edc9":"Now we are going to examine the total goals per season over time using a line graph.","d728c227":"There have been 43 unique clubs in the Bundesliga so far.","3d1e0dfd":"This is some basic analysis of Bundesliga results based on [this](https:\/\/www.kaggle.com\/jonathonv\/football-matches-data-analysis) similar analysis. As such, some of the code below is not mine, but comes from that. Credit to the author. This is simply the code from my Premier League notebook with a few adjustments. ","5c8818d0":"Next, we will look at the number of goals per game per season.","d37fba54":"Below are the number of games per month and day, as well as the average number of goals scored on the month\/day per season."}}