{"cell_type":{"c8b02e63":"code","f34948e1":"code","6c1452a3":"code","d173c36e":"code","cbb9ad9d":"code","8de489f6":"code","132b4c6c":"code","a43bcbdb":"code","68f8ae57":"code","03a2d485":"code","6f13f11c":"code","416b0635":"code","f13e670d":"markdown","ac31e38d":"markdown","64cee18b":"markdown","c16de57f":"markdown","061ed8ad":"markdown","c0502f76":"markdown","255dbcef":"markdown","e3e350a2":"markdown"},"source":{"c8b02e63":"import os\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport zipfile\nfrom tensorflow import keras\nfrom tensorflow.keras.preprocessing.image import ImageDataGenerator\n\nfrom sklearn.model_selection import train_test_split","f34948e1":"test = pd.read_csv('..\/input\/cifar10-mu\/sample_submission.csv')\n\nprint('Test Set Size:', test.shape)","6c1452a3":"test.head()","d173c36e":"test_path = \"..\/input\/cifar10-mu\/test_images\"\nprint('Test Images:', len(os.listdir(test_path)))","cbb9ad9d":"BATCH_SIZE = 64\n\ntest_datagen = ImageDataGenerator(rescale=1\/255)\n\ntest_loader = test_datagen.flow_from_dataframe(\n    dataframe = test,\n    directory = test_path,\n    x_col = 'filename',\n    batch_size = BATCH_SIZE,\n    shuffle = False,\n    class_mode = None,\n    target_size = (32,32)\n)","8de489f6":"cnn = keras.models.load_model('..\/input\/cifar10models\/cifar10_model_v01.h5')\ncnn.summary()","132b4c6c":"test_probs = cnn.predict(test_loader)\nprint(test_probs.shape)","a43bcbdb":"print(test_probs[:10,].round(2))","68f8ae57":"test_pred = np.argmax(test_probs, axis=1)\nprint(test_pred[:10])","03a2d485":"submission = pd.read_csv('..\/input\/cifar10-mu\/sample_submission.csv')\nsubmission.head()","6f13f11c":"submission.label = test_pred[:]\nsubmission.head()","416b0635":"submission.to_csv('submission.csv', header=True, index=False)","f13e670d":"### Import Statements","ac31e38d":"### Prepare Submission","64cee18b":"### Data Generator","c16de57f":"### Load DataFrame","061ed8ad":"### Extract Test Images","c0502f76":"# CIFAR10 Submission","255dbcef":"### Test Predictions","e3e350a2":"### Load Model"}}