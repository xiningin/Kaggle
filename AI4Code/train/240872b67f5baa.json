{"cell_type":{"6f6f5ffc":"code","14302c35":"code","6959e772":"code","6fc1f11e":"code","53346dc3":"code","a3706782":"code","f6bd2f3e":"code","a0964313":"markdown"},"source":{"6f6f5ffc":"import numpy as np\nimport pandas as pd\nfrom sklearn.manifold import TSNE\nimport matplotlib.pyplot as plt\n\n%matplotlib inline","14302c35":"train = pd.read_csv('..\/input\/train.csv').drop(columns=['ID'])","6959e772":"def build_histograms(df):\n    df_X = (df.replace(0, np.nan).apply(np.log) * 10).round()\n    start = int(df_X.min().min())\n    stop = int(df_X.max().max())\n    return pd.DataFrame(data={f'bucket{cnt}': (df_X == cnt).sum() for cnt in range(start, stop + 1)})","6fc1f11e":"df_hist = build_histograms(train)","53346dc3":"tsne_res = TSNE(n_components=2, verbose=0).fit_transform(df_hist.values)","a3706782":"FEATURES40 = ['f190486d6', '58e2e02e6', 'eeb9cd3aa', '9fd594eec', '6eef030c1', \n              '15ace8c9f', 'fb0f5dbfe', '58e056e12', '20aa07010', '024c577b9', \n              'd6bb78916', 'b43a7cfd5', '58232a6fb', '1702b5bf0', '324921c7b', \n              '62e59a501', '2ec5b290f', '241f0f867', 'fb49e4212', '66ace2992', \n              'f74e8f13d', '5c6487af1', '963a49cdc', '26fc93eb7', '1931ccfdd', \n              '703885424', '70feb1494', '491b9ee45', '23310aa6f', 'e176a204a', \n              '6619d81fc', '1db387535', 'fc99f9426', '91f701ba2', '0572565c2', \n              '190db8488', 'adb64ff71', 'c47340d97', 'c5a231d81', '0ff32eb98']\n\ndef get_int_cols(df):\n    return df.columns[df.dtypes == np.int64]\n\ndef get_colors(df):\n    colors = pd.Series(index=df.columns, data='b')\n    colors[FEATURES40] = 'y'\n    colors[get_int_cols(train)] = 'g'\n    colors['target'] = 'red'   \n    return colors","f6bd2f3e":"vis_x = tsne_res[:, 0]\nvis_y = tsne_res[:, 1]\nplt.figure(figsize=(20,20))\nplt.scatter(vis_x, vis_y, c=get_colors(train));\n# Red = target, yellow = leak, green = ints, blue = floats","a0964313":"Here, we use t-SNE on histograms of feature values to show that there are many groups of features (shifted time series) and that the target technically belongs to one of the groups - hence the leak that was previously described in:\n* https:\/\/www.kaggle.com\/titericz\/the-property-by-giba\n* https:\/\/www.kaggle.com\/johnfarrell\/giba-s-property-extended-extended-result\n"}}