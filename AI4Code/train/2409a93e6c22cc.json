{"cell_type":{"92be9e6e":"code","e86ff184":"code","53a22220":"code","0a8dc2e3":"code","1ab941ae":"code","6816e281":"markdown","4165be5c":"markdown","8a759742":"markdown","4b5f46c8":"markdown","0d441d1e":"markdown","f24d43ee":"markdown"},"source":{"92be9e6e":"# Install:\n# GFootball environment (https:\/\/github.com\/google-research\/football\/),\n# SEED RL for training an agent (https:\/\/github.com\/google-research\/seed_rl\/),\n# Tensorflow 2.2, which is needed by SEED RL.\n\n!apt-get update\n!apt-get install -y libsdl2-gfx-dev libsdl2-ttf-dev\n# !pip3 install tensorflow==2.2\n# !pip3 install tensorflow_probability==0.9.0\n\n# Update kaggle-environments to the newest version.\n!pip3 install kaggle-environments -U\n\n# Make sure that the Branch in git clone and in wget call matches !!\n!git clone -b v2.8 https:\/\/github.com\/google-research\/football.git\n!mkdir -p football\/third_party\/gfootball_engine\/lib\n\n!wget https:\/\/storage.googleapis.com\/gfootball\/prebuilt_gameplayfootball_v2.8.so -O football\/third_party\/gfootball_engine\/lib\/prebuilt_gameplayfootball.so\n!cd football && GFOOTBALL_USE_PREBUILT_SO=1 pip3 install .\n\n!git clone https:\/\/github.com\/google-research\/seed_rl.git\n!cd seed_rl && git checkout 34fb2874d41241eb4d5a03344619fb4e34dd9be6\n!mkdir \/kaggle_simulations\/agent","e86ff184":"!ls ..\/input\/seedrl-1625m-model\/SEEDRL_1625M","53a22220":"!mkdir -p \/kaggle_simulations\/agent\n!cp -r ..\/input\/seedrl-1625m-model\/SEEDRL_1625M\/*  \/kaggle_simulations\/agent\/","0a8dc2e3":"from kaggle_environments import make\nenv = make(\"football\", configuration={\"save_video\": True, \"scenario_name\": \"11_vs_11_hard_stochastic\", \"running_in_notebook\": True})\noutput = env.run([\"\/kaggle_simulations\/agent\/main.py\", \"\/kaggle_simulations\/agent\/main.py\"])\nscores = output[-1][0][\"observation\"][\"players_raw\"][0][\"score\"]\nprint(\"Scores  {0} : {1}\".format(*scores))\n# env.render(mode=\"human\", width=800, height=600)","1ab941ae":"from IPython.display import HTML\nfrom visualizer import visualize\nviz = visualize(output)\nHTML(viz.to_html5_video())","6816e281":"This notebook show how to play game by using our pretrained SEED RL agent.\n\nThe detail about agent is here.  \nhttps:\/\/www.kaggle.com\/c\/google-football\/discussion\/200945\n\nThe model dataset is here.  \nhttps:\/\/www.kaggle.com\/kuto0633\/seedrl-1625m-model  ","4165be5c":"## visualized game","8a759742":"I refer the following notebook. Thanks @jaron_michal for sharing the good visualization method.  \nhttps:\/\/www.kaggle.com\/jaronmichal\/human-readable-visualization#Let's-animate-","4b5f46c8":"## play the game (self-play)","0d441d1e":"## install","f24d43ee":"## load the model from dataset"}}