{"cell_type":{"48d819bf":"code","c26420b0":"code","508d557f":"code","6c8d86f6":"code","0ae198dc":"code","13878678":"code","f8e0d077":"code","d7a55274":"code","b2adcd1f":"code","e38c1d3b":"markdown","a0b061e8":"markdown","f476675c":"markdown","4b6e4b4c":"markdown","1f813c4d":"markdown","d96e0b93":"markdown","adedf05c":"markdown","3ca38a02":"markdown","f49709e7":"markdown","10afad35":"markdown"},"source":{"48d819bf":"from IPython.display import clear_output\n\nimport numpy as np\nimport pandas as pd\n\nimport h2o\nfrom h2o.automl import H2OAutoML","c26420b0":"from h2o.automl import H2OAutoML\nh2o.init()\nclear_output()","508d557f":"train = pd.read_csv(\"..\/input\/song-popularity-prediction\/train.csv\")\ntest = pd.read_csv(\"..\/input\/song-popularity-prediction\/test.csv\")\nsubs = pd.read_csv(\"..\/input\/song-popularity-prediction\/sample_submission.csv\")\n\ntrain = h2o.H2OFrame(train)\ntest = h2o.H2OFrame(test)","6c8d86f6":"train.describe()","0ae198dc":"RANDOM_STATE = 12\nRUNTIME = 3600* 5 #5 hours\nN_FOLDS = 5\nSTOPPING_METRIC = \"auto\"\nSORT_METRIC = \"auc\"\n\nx = train.columns\ny = \"song_popularity\"\nx.remove(y)\nx.remove('id')\n\ntrain[y] = train[y].asfactor()","13878678":"aml = H2OAutoML(stopping_metric=STOPPING_METRIC , \n                nfolds=N_FOLDS, seed=RANDOM_STATE,\n                max_runtime_secs=RUNTIME , \n                sort_metric = SORT_METRIC)\naml.train(x=x, y=y, training_frame=train)\nclear_output()","f8e0d077":"lb = aml.leaderboard\nlb.head(10)","d7a55274":"mc_plot = aml.model_correlation_heatmap(train)","b2adcd1f":"sub = aml.leader.predict(test).as_data_frame()[\"p1\"]\nclear_output()\nsubs['song_popularity'] = sub\nsubs.to_csv('submission.csv',index = False)\nsubs.head()","e38c1d3b":"### Top 10 models","a0b061e8":"# Imports","f476675c":"**Created by Sanskar Hasija**\n\n**Song Popularity Prediction- H20 AUTOML \ud83e\udd16**\n\n**19 JANUARY 2022**\n","4b6e4b4c":"# <center> SONG POPULARITY PREDICTION - H20 AUTOML \ud83e\udd16<\/center>\n## <center>If you find this notebook useful, support with an upvote\ud83d\udc4d<\/center>","1f813c4d":"# Results Leaderboard","d96e0b93":"# Data Loading and Preprocessing","adedf05c":"# AutoML","3ca38a02":"# Submission","f49709e7":"# Initializing H20 Cluster","10afad35":"### Models Correlation"}}