{"cell_type":{"26c027aa":"code","7649abaf":"code","dcd7531e":"code","807827f6":"code","48325e6b":"code","2a605629":"code","466ddf99":"code","fc85c43d":"code","06f1ee3a":"code","f4b7bbc5":"code","f21b03ac":"code","08b649a6":"code","4b2c81f6":"code","0426508b":"code","94c497fe":"code","12bb42cd":"code","a2d9054f":"code","b484f1dc":"markdown","b2ff3e96":"markdown","966d2f4c":"markdown","4e590001":"markdown","ffd8de7a":"markdown","1d681f2a":"markdown","7e329691":"markdown","df19bb81":"markdown","4fe15d0c":"markdown","855da9ae":"markdown","1fca89f0":"markdown"},"source":{"26c027aa":"import numpy as np\nimport pandas as pd \n\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import accuracy_score","7649abaf":"import fastai\nprint(fastai.__version__)\nfrom fastai import *\nfrom fastai.tabular.all import *","dcd7531e":"train = pd.read_csv(\"..\/input\/titanic\/train.csv\")\ntest = pd.read_csv(\"..\/input\/titanic\/test.csv\")","807827f6":"drop_elements = ['PassengerId', 'Name', 'Ticket', 'Cabin', 'SibSp','Parch']\ntrain = train.drop(drop_elements, axis = 1)\ntest = test.drop(drop_elements, axis = 1)","48325e6b":"def checkNull_fillData(df):\n    for col in df.columns:\n        if len(df.loc[df[col].isnull() == True]) != 0:\n            if df[col].dtype == \"float64\" or df[col].dtype == \"int64\":\n                df.loc[df[col].isnull() == True,col] = df[col].mean()\n            else:\n                df.loc[df[col].isnull() == True,col] = df[col].mode()[0]\n                \ncheckNull_fillData(train)\ncheckNull_fillData(test)","2a605629":"str_list = [] \nnum_list = []\nfor colname, colvalue in train.iteritems():\n    if type(colvalue[1]) == str:\n        str_list.append(colname)\n    else:\n        num_list.append(colname)","466ddf99":"str_list","fc85c43d":"num_list","06f1ee3a":"train = pd.get_dummies(train, columns=str_list)\ntest = pd.get_dummies(test, columns=str_list)","f4b7bbc5":"target = \"Survived\"\nprocs = [Categorify, FillMissing]\nsplits = RandomSplitter(valid_pct=0.2)(range_of(train))\ncont, cat = cont_cat_split(train, 1, target)","f21b03ac":"cont","08b649a6":"cat","4b2c81f6":"to = TabularPandas(train, procs,cat, cont, y_names = target, splits=splits)\nto.show(3)","0426508b":"X_train, y_train = to.train.xs, to.train.y\nX_valid, y_valid = to.valid.xs, to.valid.y","94c497fe":"model = RandomForestClassifier(n_estimators=100, n_jobs=-1 ,random_state=2021)\nmodel.fit(X_train, y_train)","12bb42cd":"y_pred = model.predict(X_valid)\naccuracy_score(y_valid, y_pred)","a2d9054f":"to_test = TabularPandas(test, procs, cat, cont)\nresult = model.predict(to_test.xs)\nsub = pd.read_csv(\"..\/input\/titanic\/gender_submission.csv\")\nsub[\"Survived\"] = result.astype(int)\nsub.to_csv('.\/submission.csv', index=False)","b484f1dc":"# make model and predict validation data and check score","b2ff3e96":"# Delete Insignificant columns","966d2f4c":"# devide column type (string, number)","4e590001":"# Load Data","ffd8de7a":"# Check Missing Data and Fill New Data ","1d681f2a":"# category columns -> onehot encoding","7e329691":"# Import FAST AI","df19bb81":"# predict test data and submit result csv","4fe15d0c":"# set Model Variable","855da9ae":"# split Train data (Train Data + Validation Data)","1fca89f0":"\n# Import Basic "}}