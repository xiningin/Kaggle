{"cell_type":{"02fbdb49":"code","5b90b2b3":"code","bd554d15":"code","4eae82db":"code","5a515091":"code","613a47ff":"code","899114d5":"code","e65faa39":"code","76e30a4d":"code","e7ae467b":"code","98188993":"code","567ea686":"code","6fd87dc6":"markdown","9bb4ef73":"markdown","03f5a283":"markdown"},"source":{"02fbdb49":"import numpy as np\nimport pandas as pd\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline\n\nplt.style.use('seaborn-ticks')","5b90b2b3":"data = pd.read_csv(\"..\/input\/water-potability\/water_potability.csv\")\ndata.head()","bd554d15":"#shape\ndata.shape","4eae82db":"# summary\ndata.describe()","5a515091":"data.info()","613a47ff":"# visualization for distribution of columns.\nfig, axs = plt.subplots(3, 3, figsize=(20, 20))\ncols = np.array(data.columns[:9]).reshape(3, 3)\n\n\nfor i in range(3):\n    for j in range(3):\n        skewness = f\"Skewness: {data[cols[i][j]].skew()}\" # it should be between -1 to 1\n        ax = sns.histplot(data[cols[i, j]], ax=axs[i, j])\n        ax.set_title(skewness)\n        \nplt.show()","899114d5":"# fill missing values.\nfrom sklearn.impute import SimpleImputer\n\nX = data.loc[:, :'Turbidity']\ny = data['Potability']\n\n# create an object of simpleimputer\nimputer = SimpleImputer(strategy='mean')\nimputer.fit(X)\nx_trans = imputer.transform(X)\nx_trans = pd.DataFrame(x_trans, columns=X.columns)","e65faa39":"# report which features were selected by RFE\nfrom sklearn.datasets import make_classification\nfrom sklearn.feature_selection import RFE\nfrom sklearn.tree import DecisionTreeClassifier\n\n\n# define RFE\nrfe = RFE(estimator=DecisionTreeClassifier(), n_features_to_select=5)\n# fit RFE\nrfe.fit(x_trans, y)\ncol_idx = []\n\n# summarize all features\nfor i in range(x_trans.shape[1]):\n    if rfe.support_[i]:\n        col_idx.append(i)\n        \ncols = x_trans.columns\nfeature_cols = []\nfor idx in range(len(cols)):\n    if idx in col_idx:\n        feature_cols.append(cols[idx])\n\nx_trans = x_trans[feature_cols]\nx_trans.head()","76e30a4d":"# normailze the data\nfrom sklearn.preprocessing import MinMaxScaler\n\n# create an object of scaler\nscale = MinMaxScaler()\n# fit scaler\nscale.fit(x_trans)\nscaled_x = scale.transform(x_trans)\nscaled_x = pd.DataFrame(scaled_x, columns = x_trans.columns)","e7ae467b":"scaled_x.describe()","98188993":"scaled_x.isnull().sum()","567ea686":"# Building a model\nfrom sklearn import model_selection\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import accuracy_score, classification_report\nfrom sklearn.metrics import roc_curve, roc_auc_score\n\nx_train, x_test, y_train, y_test = train_test_split(scaled_x, y, train_size=0.7, random_state=123)\n\ndef predict_model(model):\n    \n    # fit model\n    model.fit(x_train, y_train)\n    pred_y = model.predict(x_test)\n    \n    score = accuracy_score(y_test, pred_y)\n    report = classification_report(y_test, pred_y)\n    return report\n    \n\nLRclf = LogisticRegression(solver=\"liblinear\")\nRFclf = RandomForestClassifier(max_depth = 5, n_estimators = 500)\nDTclf = DecisionTreeClassifier()\n\nprint(\"Classification Report: \\n\", predict_model(RFclf))\n\n## plotting roc-curve\n\nkfold = model_selection.KFold(n_splits=10, random_state=7, shuffle=True)\nscoring = 'roc_auc'\nresults = model_selection.cross_val_score(RFclf, scaled_x, y, cv=kfold, scoring=scoring)\nprint(\"Accuracy: %.3f (%.3f)\" % (results.mean(), results.std()))\n\n\n# create test array with all '0'\nneg_prob = [0 for _ in range(len(y_test))]\n\n# Roc-curve for RandomForestClassifier.\nrf_prob = RFclf.predict_proba(x_test)\n\n# Keeping probabilites for positive outcomes i.e for '1'\nrf_prob = rf_prob[:, 1]\n\n# computing roc_score for negative outcomes '0's\nneg_test_score = roc_auc_score(y_test, neg_prob)\nrf_test_score = roc_auc_score(y_test, rf_prob)\n\n# calculate roc curves\nns_fpr, ns_tpr, _ = roc_curve(y_test, neg_prob)\nlr_fpr, lr_tpr, _ = roc_curve(y_test, rf_prob)\n\n# plot roc_curves\nplt.plot(ns_fpr, ns_tpr, linestyle='--', color='r')\nplt.plot(lr_fpr, lr_tpr)\nplt.show()\n","6fd87dc6":"# Data Analysis","9bb4ef73":"# WATER QUALITY ANALYSIS\n# Context\n\nAccess to safe drinking-water is essential to health, a basic human right and a component of effective policy for health protection. This is important as a health and development issue at a national, regional and local level. In some regions, it has been shown that investments in water supply and sanitation can yield a net economic benefit, since the reductions in adverse health effects and health care costs outweigh the costs of undertaking the interventions","03f5a283":"# Data Discription\n\n\n| Features | Description |\n|--|--|\n|**1. pH value**|it should be from 6.5 to 8.5|\n|**2.Hardness**|Water containing calcium carbonate at concentrations below 60 mg\/l is generally considered as soft; 60\u2013120 mg\/l, moderately hard; 120\u2013180 mg\/l, hard;and more than 180 mg\/l, very hard (McGowan, 2000).\n|**3. Solids (Total dissolved solids - TDS)**|This is the important parameter for the use of water. The water with high TDS value indicates that water is highly mineralized. Desirable limit for TDS is 500 mg\/l and maximum limit is 1000 mg\/l which prescribed for drinking purpose.|\n|**4. Chloramines:**| Chlorine levels up to 4 milligrams per liter (mg\/L or 4 parts per million (ppm)) are considered safe in drinking water.|\n|**5. Sulfate**|Sulfate concentration in seawater is about 2,700 milligrams per liter (mg\/L). It ranges from 3 to 30 mg\/L in most freshwater supplies, although much higher concentrations (1000 mg\/L) are found in some geographic locations.|\n|**6. Conductivity**|EC value should not exceeded 400 \u03bcS\/cm.| \n|**7. Organic_carbon**|According to US EPA < 2 mg\/L as TOC in treated \/ drinking water, and < 4 mg\/Lit in source water which is use for treatment.|\n|**8. Trihalomethanes**|THM levels up to 80 ppm is considered safe in drinking water.|\n|**9. Turbidity**|The mean turbidity value obtained for Wondo Genet Campus (0.98 NTU) is lower than the WHO recommended value of 5.00 NTU.|\n|**10. Potability**|Indicates if water is safe for human consumption where 1 means Potable and 0 means Not potable.|"}}