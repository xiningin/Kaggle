{"cell_type":{"c24a93cd":"code","37458138":"code","ffdacc40":"code","e32465a0":"code","cdc9c54c":"code","6bcc49ce":"code","acec6685":"code","20b4d35a":"code","5c12375b":"code","c124c0ab":"code","9928929a":"code","9e029de1":"code","00f46e7b":"code","74e9d7c6":"code","9216ed1d":"code","d8e76612":"code","0f97f188":"code","d2c0c6fa":"code","0fe29b71":"code","fd63d62c":"code","de5d7377":"code","30c7f186":"code","5ed5c89b":"markdown","d57910fb":"markdown","917e7780":"markdown","d3fd5390":"markdown","9ada6d92":"markdown","8bd0dba8":"markdown","844eecb2":"markdown","c02fa73e":"markdown","d5135615":"markdown","03b7c98e":"markdown","fee5e705":"markdown"},"source":{"c24a93cd":"import pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\ndataset = pd.read_csv(\"..\/input\/iris-flower-dataset\/IRIS.csv\")\n\ndataset.head()","37458138":"dataset.describe()","ffdacc40":"dataset['species'].value_counts()","e32465a0":"fig = dataset[dataset['species'] == 'Iris-setosa'].plot(kind='Scatter', x='sepal_length', y='sepal_width', color='orange', label='Setosa')\ndataset[dataset['species'] == 'Iris-versicolor'].plot(kind='Scatter', x='sepal_length', y='sepal_width', color='yellow', label='Versicolor', ax=fig)\ndataset[dataset['species'] == 'Iris-virginica'].plot(kind='Scatter', x='sepal_length', y='sepal_width', color='blue', label='Verginica', ax=fig)\nfig.set_ylabel('Sepal Width')\nfig.set_xlabel('Sepal Length')\nfig.set_title('Sepal Length vs Width')\n\nfig = plt.gcf()\nfig.set_size_inches(18, 9)\nplt.show()","cdc9c54c":"dataset['species'].groupby(dataset['petal_width']).value_counts()","6bcc49ce":"dataset['species'].groupby(pd.qcut(dataset['petal_width'], 3)).value_counts()","acec6685":"dataset['petal_area'] = dataset.apply(lambda row: (row['petal_length'] * row['petal_width']), axis=1)","20b4d35a":"dataset.head()","5c12375b":"dataset['species'].groupby(pd.qcut(dataset['petal_area'], 3)).value_counts()","c124c0ab":"dataset['sepal_area'] = dataset.apply(lambda row: (row['sepal_length'] * row['sepal_width']), axis=1)","9928929a":"dataset['lensq'] = dataset.apply(lambda row: (row['sepal_length'] * row['sepal_width']), axis=1)","9e029de1":"dataset['widsq'] = dataset.apply(lambda row: (row['petal_width'] * row['petal_length']), axis=1)","00f46e7b":"dataset['squares'] = dataset.apply(lambda row: (row['lensq'] - row['widsq']), axis=1)","74e9d7c6":"dataset.head()","9216ed1d":"dataset['species'].groupby(pd.qcut(dataset['sepal_area'], 3)).value_counts()","d8e76612":"sns.lineplot(dataset['petal_area'], dataset['sepal_area'])","0f97f188":"dataset['area_diff'] = dataset.apply(lambda row: (row['sepal_area'] - row['petal_area']), axis=1)","d2c0c6fa":"dataset.head()","0fe29b71":"dataset['species'].groupby(pd.qcut(dataset['area_diff'], 3)).value_counts()","fd63d62c":"columnsTitles = ['sepal_length', 'sepal_width', 'petal_length','petal_width','petal_area', 'sepal_area','area_diff','lensq','widsq','squares','species']\ndataset=dataset.reindex(columns=columnsTitles)","de5d7377":"dataset.head(3)","30c7f186":"from sklearn.ensemble import RandomForestClassifier\n\nrf = RandomForestClassifier(criterion='gini', \n                             n_estimators=1000,\n                             min_samples_split=10,\n                             min_samples_leaf=1,\n                             max_features='auto',\n                             oob_score=True,\n                             random_state=1,\n                             n_jobs=-1)\nrf.fit(dataset.iloc[:, 0:-2], dataset.iloc[:, -1])\nprint(\"%.4f\" % rf.oob_score_)","5ed5c89b":"# Iris Species Analysis","d57910fb":"No clear correlation found between sepal_area and petal_area. There is a weak correlation found if the species 'setosa' is removed from the dataset.","917e7780":"Interestingly, the `sepal_area` column is a bit more varied than the `petal_area` column. We can also include another feature here. From our two new columns, we can make a third column from the difference between them called `area_diff`. This may give us more insight. Before doing that though, we can plot the `petal_area` with `sepal_area` to see if any linear relationship exists between the two columns.","d3fd5390":"Since we now know that the petal and sepal dimensions play a big role in the species, we now know to quantify this feature into a new column. We can create `sepal_area` and `petal_area` columns respectively.","9ada6d92":"We can finally move onto building the model. Our classifier uses only the columns that we've engineered.","8bd0dba8":"Let's import our libraries and take a look at the data.","844eecb2":"The plot above tells us a bit about the indication of sepal length and width in relation to the species. Let's take a look at how the `petal_width` and `petal_length` affect the determination of the species.","c02fa73e":"There's not much to work with. Let's take a closer look at each individual feature in relation to the species.","d5135615":"It gives us an 'out of bag' score of 95.33%. It is possible to acheive 100% with the SVM model but a clear difference can only be shown with a larger dataset. Still, this is a very respectable score.","03b7c98e":"from sklearn.ensemble import RandomForestClassifier\n\nrf = RandomForestClassifier(criterion='gini', \n                             n_estimators=1000,\n                             min_samples_split=10,\n                             min_samples_leaf=1,\n                             max_features='auto',\n                             oob_score=True,\n                             random_state=1,\n                             n_jobs=-1)\nrf.fit(dataset['area_diff'], dataset['species'])\nprint(\"%.4f\" % rf.oob_score_)","fee5e705":"At face value this doesn't seem to be very clear. We can only conclusively tell that Iris Setosa is distinct in terms of it's petal dimensions though. This is the same conclusion as the sepal dimensions that we've seen from the scatter plot above."}}