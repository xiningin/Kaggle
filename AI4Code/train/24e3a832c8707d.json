{"cell_type":{"ac71d680":"code","3dfb68b5":"code","a6409250":"code","abcf50b9":"code","b73c925f":"code","cfb9e6b5":"code","4e0291bb":"code","0931b139":"code","bf9e7831":"code","9b10e37f":"code","db8bc9ab":"code","31d033e9":"code","52692ad3":"code","db26dc24":"code","6d60192f":"code","b41a2d17":"code","e29ff6cb":"code","24d73c10":"code","2bdb331b":"code","744a76da":"code","3b2ca523":"code","08a95bbb":"code","98481a95":"code","9413deb0":"code","f0e49535":"code","00f587c4":"code","1b6ff9df":"code","7f735cd8":"code","7b2fe8e4":"code","3b0820a2":"code","af60ccd4":"code","098faa78":"code","c0c91772":"code","7fda3bd3":"code","ef192ccf":"code","a8599d2f":"code","cb60a4ed":"code","425c7182":"code","748bcf5a":"code","402ba8b5":"code","a6aacd86":"code","9d3afd4b":"code","7e594de8":"code","99831433":"code","10cbe846":"code","d00e638b":"code","2d8cbf24":"code","a114bfe6":"code","5ffb5550":"code","96fe1027":"code","c97295f8":"code","4f62a938":"code","afffe280":"code","b91aa7c6":"code","98f8d3d0":"code","d9b544f4":"code","88eaaf6c":"code","662f3ccf":"code","532b17bd":"code","ff6fd628":"code","9b8c79e4":"code","ce160922":"code","00b8b6ee":"code","17c484ad":"code","3f8a931c":"code","99c34432":"code","c3b2e0d5":"code","95630c22":"code","f502e2de":"code","9b77f147":"code","7b4696ca":"code","704242f8":"code","e37a143d":"code","39823dd5":"markdown","6e30ead8":"markdown","f60d60fe":"markdown","f95de54a":"markdown","5a7661e6":"markdown","2a989a7f":"markdown","e5f25d12":"markdown","60f0cb72":"markdown","89fda729":"markdown","8fca97b7":"markdown","d7f091ea":"markdown","c07a9ee4":"markdown","4b4e679a":"markdown","0ee33e73":"markdown","9d362cf0":"markdown","0437e640":"markdown","c2e9ff4e":"markdown","737b2d2d":"markdown","6e191d6d":"markdown","3c2fa911":"markdown","707eff9a":"markdown","9409338e":"markdown","f7605363":"markdown","ba4d1f98":"markdown","53f3149d":"markdown","762f6816":"markdown","1217f478":"markdown","c6c5b849":"markdown","b793a7c9":"markdown","9565b6b1":"markdown","8d5b2ddb":"markdown","3363f24a":"markdown","f5f00619":"markdown","8504c9d6":"markdown","7f255eb7":"markdown","c7688801":"markdown","c0484761":"markdown","3c65344e":"markdown","8afd17f0":"markdown","6293a227":"markdown"},"source":{"ac71d680":"import numpy as np \nimport pandas as pd \npd.set_option('display.max_columns', None)","3dfb68b5":"dff=pd.read_csv(\"..\/input\/german-credit-data-with-risk\/german_credit_data.csv\")","a6409250":"df=dff.copy()","abcf50b9":"df.head()","b73c925f":"df.drop(\"Unnamed: 0\",axis=1,inplace=True)","cfb9e6b5":"q1 = df[\"Age\"].quantile(0.25)\nq3 = df[\"Age\"].quantile(0.80)\niqr = q3 - q1\nup = q3 + 1.5 * iqr\nlow = q1 - 1.5 * iqr","4e0291bb":"up","0931b139":"low","bf9e7831":"df[(df[\"Age\"] < low) | (df[\"Age\"] > up)]","9b10e37f":"df[(df[\"Age\"] > up) | (df[\"Age\"] < low)].any(axis=None)","db8bc9ab":"df.loc[df[\"Age\"] < low,\"Age\"]=low","31d033e9":"df.loc[df[\"Age\"] > up,\"Age\"]=up","52692ad3":"df[(df[\"Age\"] > up) | (df[\"Age\"] < low)].any(axis=None)","db26dc24":"df.isnull().sum()","6d60192f":"df.head()","b41a2d17":"df = df.apply(lambda x: x.fillna(x.mode()[0]) if (x.dtype == \"O\" and len(x.unique()) <= 10) else x, axis=0)","e29ff6cb":"df.head()","24d73c10":"df.info()","2bdb331b":"df[\"Age\"]=[int(i) for i in df[\"Age\"]]","744a76da":"df.isnull().sum()","3b2ca523":"df[\"Age\"].describe()","08a95bbb":"q25 = df[\"Age\"].quantile(0.25)\nq90 = df[\"Age\"].quantile(0.90)","98481a95":"q25","9413deb0":"q90","f0e49535":"df.loc[df[\"Age\"]< q25,\"new_age\"]=\"young\"","00f587c4":"df.loc[(df[\"Age\"] >= q25) & (df[\"Age\"]< q90),\"new_age\"]=\"mature\"","1b6ff9df":"df.loc[(df[\"Age\"] >= q90),\"new_age\"]=\"senior\"","7f735cd8":"def twice_col(df,col1,col2):\n    n=df[col1].unique().tolist()\n    l=len(n)\n    n1=df[col2].unique().tolist()\n    l1=len(n1)\n    for i in n:\n        for j in range(l):\n            for z in n1:\n                for t in range(l1):\n                    df.loc[(df[col1] == n[j]) & (df[col2] == n1[t]), str(col1) + \"_\" + str(col2)]=str(n[j]) +\"_\"+ str(n1[t])\n        ","7b2fe8e4":"twice_col(df,\"new_age\",\"Sex\")","3b0820a2":"twice_col(df,\"Sex\",\"Housing\")","af60ccd4":"twice_col(df,'new_age',\"Housing\")","098faa78":"twice_col(df,\"Job\",\"Housing\")","c0c91772":"df[\"Job\"].value_counts()","7fda3bd3":"df[\"Duration\"].unique()","ef192ccf":"df[\"Duration\"].describe().T","a8599d2f":"df.loc[df[\"Duration\"] < 18,\"new_duration\"]= \"A\"\ndf.loc[(df[\"Duration\"] >= 18) & (df[\"Duration\"] <30),\"new_duration\"]= \"B\"\ndf.loc[(df[\"Duration\"] >= 30) & (df[\"Duration\"] <48),\"new_duration\"]= \"C\"\ndf.loc[df[\"Duration\"] >= 48,\"new_duration\"]= \"D\"","cb60a4ed":"df.head()","425c7182":"df[\"Credit amount\"].describe().T","748bcf5a":"q25 = df[\"Credit amount\"].quantile(0.25)\nq50 = df[\"Credit amount\"].quantile(0.50)\nq75 = df[\"Credit amount\"].quantile(0.75)","402ba8b5":"df.loc[(df[\"Credit amount\"] < q25),\"new_Credit_amount\"]=\"A\"","a6aacd86":"df.loc[(df[\"Credit amount\"] >= q25) & (df[\"Duration\"] < q50),\"new_Credit_amount\"]= \"B\"","9d3afd4b":"df.loc[(df[\"Credit amount\"] >= q50) & (df[\"Duration\"] < q75),\"new_Credit_amount\"]= \"C\"","7e594de8":"df.loc[(df[\"Credit amount\"] >= q75),\"new_Credit_amount\"]= \"D\"","99831433":"df.head()","10cbe846":"df[\"Risk\"].unique()","d00e638b":"from sklearn.preprocessing import LabelEncoder","2d8cbf24":"labelencoder = LabelEncoder()\ndf[\"Risk\"] = labelencoder.fit_transform(df[\"Risk\"])","a114bfe6":"df.head()","5ffb5550":"def meann(df,b):\n    a={}\n    for i in b:\n        a[i]=df.groupby(i)[\"Risk\"].mean()\n        c=print(a,\"\/n\")\n    return c   ","96fe1027":"b=['Sex_Housing','new_age_Housing','Job_Housing','new_age_Sex']","c97295f8":"#0 riskli olma durumu 1 olmama durumunu ifade ediyor.\n#\u00d6rne\u011fin female_free(kad\u0131n ve evsiz)'nin risk durumu y\u00fcksek mant\u0131ken kredisini de \u00f6deyememesini bekleriz \n#female_own ise(kendi evi olan ve kad\u0131n) 'n\u0131n 1'e daha yak\u0131n yani kendi evi olan birinin\n# kredisini \u00f6demesini bekleriz\nmeann(df,b)","4f62a938":"cat_cols, num_cols, cat_but_car=grab_col_names(df, cat_th=10, car_th=20)","afffe280":"cat_cols","b91aa7c6":"num_cols","98f8d3d0":"cat_but_car","d9b544f4":"binary_cols = [col for col in df.columns if df[col].dtype not in [int, float]\n               and df[col].nunique() == 2]\n\nfor col in binary_cols:\n    df = label_encoder(df, col)","88eaaf6c":"binary_cols","662f3ccf":"df.head()","532b17bd":"rare_analyser(df, \"Risk\", cat_cols)\n#male:1 female:0 \n#Bu dataframede male'den 310 g\u00f6zlem female'den 690 g\u00f6zlem vard\u0131r. Oranlar\u0131 310\/1000'den 0.31,\n# 690\/1000'den 0.69'dur.Ve erkeklerin risk durumu kad\u0131nlar\u0131nkinden daha y\u00fcksektir.\n#Devam\u0131 da bu \u015fekilde yorumlanabilir.","ff6fd628":"df = rare_encoder(df, 0.05)","9b8c79e4":"rare_analyser(df, \"Risk\", cat_cols)","ce160922":"ohe_cols = [col for col in df.columns if 10 >= df[col].nunique() > 2]","00b8b6ee":"ohe_cols","17c484ad":"#one_hot_encoder\ndf= pd.get_dummies(df,ohe_cols, drop_first=False)","3f8a931c":"df=one_hot_encoder(df, ohe_cols)","99c34432":"df.head()","c3b2e0d5":"from sklearn.preprocessing import MinMaxScaler, LabelEncoder, StandardScaler\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import accuracy_score","95630c22":"scaler = StandardScaler()\ndf[num_cols] = scaler.fit_transform(df[num_cols])\n\ndf[num_cols].head()","f502e2de":"df.head()","9b77f147":"y = df[\"Risk\"]\nX = df.drop(\"Risk\",axis=1)\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.20, random_state=10)\nrf_model = RandomForestClassifier(random_state=46).fit(X_train, y_train)\ny_pred = rf_model.predict(X_test)\naccuracy_score(y_pred, y_test)","7b4696ca":"dff.dropna(inplace=True)","704242f8":"dff = pd.get_dummies(dff, columns=[\"Sex\"], drop_first=True)","e37a143d":"y = dff[\"Risk\"]\nX = dff.drop([\"Unnamed: 0\",\"Risk\",\"Housing\",\"Saving accounts\",\"Checking account\",\"Purpose\"],axis=1)\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.20, random_state=10)\nrf_model = RandomForestClassifier(random_state=46).fit(X_train, y_train)\ny_pred = rf_model.predict(X_test)\naccuracy_score(y_pred, y_test)","39823dd5":"* Dataframedeki columnlara g\u00f6re toplam bo\u015f de\u011fer say\u0131s\u0131","6e30ead8":"* \u0130kili de\u011ferlere g\u00f6re risk durumunu kontrol etmek istedi\u011fimden ve bunlar\u0131 teker teker yazmak zor olaca\u011f\u0131ndan fonksiyon yaz\u0131yorum.","f60d60fe":"* Rare analyser fonksiyonu ile girilen dataframe,target ve kategorik columns parametrelerinin dataframe'deki say\u0131s\u0131n\u0131, o column'daki de\u011ferlerin say\u0131s\u0131n\u0131n toplam dataframe say\u0131s\u0131na oran\u0131n\u0131 ve columnlara g\u00f6re groupby yap\u0131ld\u0131\u011f\u0131nda target de\u011fi\u015fkeninin(Risk) ortalamas\u0131n\u0131 bize d\u00f6nd\u00fcr\u00fcr.","f95de54a":"* \u0130lk 5 sat\u0131r\u0131 g\u00f6r\u00fcnt\u00fcleme","5a7661e6":"* Age de\u011ferlerini integer'a \u00e7eviriyorum.","2a989a7f":"* Eksik de\u011fer sorunu \u00e7\u00f6z\u00fclm\u00fc\u015f m\u00fc kontrol ediyorum.","e5f25d12":"### 1-Ayk\u0131r\u0131 de\u011ferlerin belirlenmesi","60f0cb72":"* Sat\u0131rda veya s\u00fctunda ayk\u0131r\u0131 de\u011fer var m\u0131 sorusunun cevab\u0131n\u0131 d\u00f6nd\u00fcr\u00fcyor","89fda729":"### 3-Eksik de\u011fer sorunu ve null de\u011ferlerin doldurulmas\u0131","8fca97b7":"* \u015eimdi ise numerik de\u011ferlerimizi standartla\u015ft\u0131raca\u011f\u0131z \u00e7\u00fcnk\u00fc modele girerken bu i\u015flemi yapmam\u0131z gerekir.Standartla\u015ft\u0131rma, verileri belli bir say\u0131 aras\u0131nda oranlamakt\u0131r yani verileri ayn\u0131 \u00f6l\u00e7e\u011fe indirger.","d7f091ea":"* Rare encoder fonksiyonu  kendisine parametre olarak girilen dataframe ve oranla ilgili i\u015flem yap\u0131yor, girilen oran parametresini alt s\u0131n\u0131r kabul edip o s\u0131n\u0131r\u0131n alt\u0131ndakileri rare olarak adland\u0131r\u0131yor ve adland\u0131r\u0131lan bir\u00e7ok de\u011fi\u015fken olursa hepsi rare oldu\u011fundan oranlar\u0131 ve say\u0131lar\u0131 toplan\u0131yor.K\u0131sacas\u0131 di\u011fer olarak d\u00f6nd\u00fcr\u00fcl\u00fcyor. Dataframede az say\u0131da g\u00f6zlemlendi\u011finden tek tek de\u011ferlendirip modeli de kendimizi de yormuyoruz.","c07a9ee4":"* Kredi \u00f6deme miktarlar\u0131nda da ayn\u0131 \u015fekilde bir\u00e7ok unique de\u011fer oldu\u011fundan kategorize ediyorum.","4b4e679a":"* Gerekli k\u00fct\u00fcphanelerin import edilmesi","0ee33e73":"* Ayk\u0131r\u0131 de\u011fer kontrol\u00fc yap\u0131yoruz, bask\u0131lama i\u015flemimiz sorunsuz ger\u00e7ekle\u015fmi\u015f mi diye.\n* False d\u00f6nmesini bekliyoruz.","9d362cf0":"* Ayk\u0131r\u0131 de\u011ferlerin listelenmesi","0437e640":"* One hot encoder yine bir kategorik de\u011fi\u015fkenleri numerik'e d\u00f6n\u00fc\u015ft\u00fcrme y\u00f6ntemidir.Ka\u00e7 de\u011fi\u015fken d\u00f6nd\u00fcr\u00fclecekse n-1 kadar column ile matrix olu\u015fturulur.\u00d6rne\u011fin;","c2e9ff4e":"> ## GERMAN CREDIT DATASET \u00dcZER\u0130NDE \u00d6ZELL\u0130K M\u00dcHEND\u0130SL\u0130\u011e\u0130 & VER\u0130 \u00d6N \u0130\u015eLEME","737b2d2d":"* Kategorik de\u011fi\u015fkenlerde eksik de\u011fer oldu\u011fundan tipi object olan ve e\u015f\u015fiz s\u0131n\u0131f say\u0131s\u0131 10'dan k\u00fc\u00e7\u00fck olanlar\u0131n bo\u015f de\u011ferlerini mode'lar\u0131yla dolduruyoruz.","6e191d6d":"### 4-Encoding","3c2fa911":"* Model i\u00e7in kategorik,numerik ve kategorik g\u00f6r\u00fcnen fakat kardinal olan column'lar\u0131 getiriyoruz.","707eff9a":"* Veri \u00f6n i\u015flemesini bitirdi\u011fimiz veriyi modele kat\u0131yoruz.","9409338e":"### 2-Ayk\u0131r\u0131 de\u011ferleri belirledi\u011fimiz \u00e7eyreklikteki de\u011ferlere bask\u0131l\u0131yoruz.Yani 0'dan k\u00fc\u00e7\u00fck age de\u011feri varsa onlara 0 at\u0131yoruz ayn\u0131 \u015fekilde 72'den b\u00fcy\u00fck bir de\u011fer varsa da onlar\u0131 72'ye e\u015fitliyoruz bu \u015fekilde ayk\u0131r\u0131 de\u011ferler bask\u0131lan\u0131yor.","f7605363":"![image.png](attachment:79e33fe5-f6d9-4ff5-be0b-da7ee0ffa9c5.png)","ba4d1f98":"### 6-Modelleme","53f3149d":"* Age de\u011fi\u015fkenini belirledi\u011fim quantile de\u011ferlerine g\u00f6re kategorize ediyorum; gen\u00e7,yeti\u015fkin,ya\u015fl\u0131 olarak.","762f6816":"### 5-Standartla\u015ft\u0131rma","1217f478":"* Son a\u015famada veri \u00f6n i\u015fleme yap\u0131lmadan veriyi modele kat\u0131p fark\u0131 g\u00f6rmek i\u00e7in burada veriyi kopyal\u0131yoruz.","c6c5b849":"* \u015eimdi ise veri \u00f6n i\u015flemenin \u00f6nemini \u00e7ok daha iyi anlayabilmek i\u00e7in veri \u00f6n i\u015fleme yapmad\u0131\u011f\u0131m\u0131z yani verinin ilk okutuldu\u011fu halini modele kat\u0131yoruz.","b793a7c9":"* Label encoder, kategorik de\u011fi\u015fkenleri numerik de\u011fi\u015fkenlere d\u00f6n\u00fc\u015ft\u00fcrmemizi sa\u011flayan metottur.Risk de yukar\u0131da g\u00f6r\u00fcld\u00fc\u011f\u00fc gibi good ve bad olarak kategorize edilmi\u015f bu y\u00fczden 0 ve 1'e \u00e7evirece\u011fiz.","9565b6b1":"G\u00f6r\u00fcld\u00fc\u011f\u00fc \u00fczere tahmin ba\u015far\u0131m\u0131z \u00f6n i\u015fleme yap\u0131lmadan %58.0 iken \u00f6n i\u015fleme yapt\u0131\u011f\u0131m\u0131zda %70.5'e \u00e7\u0131km\u0131\u015f.\nK\u0131sacas\u0131 veri \u00f6n i\u015fleme i\u015flemi ne kadar iyi yap\u0131l\u0131rsa veriden o kadar anlaml\u0131 sonu\u00e7lar elde ederiz.\nVeri \u00f6n i\u015fleme hayat kurtar\u0131r :))\nG\u00f6r\u00fc\u015fmek \u00fczeerreeee :))","8d5b2ddb":"### ****Veri \u00d6n \u0130\u015fleme, veriden daha sa\u011fl\u0131kl\u0131 sonu\u00e7lar\u0131n \u00e7\u0131kar\u0131lmas\u0131n\u0131 sa\u011flayan bir veri temizleme y\u00f6ntemidir.Verinin bir modele girebilmesi i\u00e7in yap\u0131lan haz\u0131rl\u0131kt\u0131r.Ayk\u0131r\u0131 ve g\u00fcr\u00fclt\u00fcl\u00fc de\u011ferlerden veriyi temizlemek i\u00e7in uygulan\u0131r.****","3363f24a":"* Burada ise t\u00fcm columnlarda gezilmesini, iki e\u015fsiz s\u0131n\u0131fa sahip olan ama int ve float olmayan columnlar\u0131 d\u00f6nd\u00fcrmesini istiyoruz.D\u00f6nen columnlar kategorik oldu\u011fundan da label encoder ile numerik'e \u00e7eviriyoruz.","f5f00619":"Kullan\u0131lan data bir banka datas\u0131d\u0131r, hedef de\u011fi\u015fkeni risk olup g\u00f6zlemlerin baz\u0131 parametrelere g\u00f6re kredilerini \u00f6deyip \u00f6deyememe risklerini anlat\u0131r.Risk de\u011fi\u015fkeni 'good' ise riskli de\u011fil 'bad' ise riskli oldu\u011funu belirtir.","8504c9d6":"* Olu\u015fturdu\u011fumuz kategorilere g\u00f6re risk ortalamas\u0131na bakmak istiyoruz, bunun i\u00e7in a\u015fa\u011f\u0131daki gibi bir fonksiyon olu\u015fturdum.","7f255eb7":"* Kredi \u00f6deme s\u00fcrelerinde de fazla unique de\u011fer oldu\u011fundan model i\u00e7in 4 kategoriye ay\u0131ral\u0131m.","c7688801":"* Gereksiz bir column var indexle ayn\u0131 o y\u00fczden onu siliyoruz","c0484761":"* Modelin \u00f6n i\u015flemesini yapt\u0131\u011f\u0131m\u0131z parametrelere g\u00f6re hedef de\u011fi\u015fkeni tahmin etme oran\u0131 %70.5 'mi\u015f gayet iyi.","3c65344e":"* Rare de\u011fi\u015fkenlerimizi a\u015fa\u011f\u0131da g\u00f6rebilirsiniz.","8afd17f0":"* Verinin okutulmas\u0131","6293a227":"* Job de\u011fi\u015fkenine ait frekanslar\u0131 sayd\u0131r\u0131yorum, 4 unique de\u011fer oldu\u011funu g\u00f6r\u00fcyorum.Herhangi bir i\u015flem yapmam\u0131za gerek yok."}}