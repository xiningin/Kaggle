{"cell_type":{"447da287":"code","eab376a1":"code","bb6b8036":"code","00f6b1a4":"code","64c6579e":"code","eb46a5a8":"code","8738b63d":"code","1ce895a9":"code","61646435":"code","b5e24f1a":"code","747630ab":"code","f71521b5":"code","5ca2c382":"code","aea1694e":"code","3cd4596b":"code","d60b9050":"code","8a385d0f":"code","a00f4690":"code","5a5d0864":"code","c06e000b":"code","9b8c1043":"code","6398750f":"code","ec160bb5":"code","378be1d1":"code","2daa698a":"code","fecf7cbd":"code","59381808":"code","d2c5dfde":"code","783a464a":"code","17188d44":"code","9df414bf":"code","16c5b63f":"code","96bd53e5":"code","486c2931":"code","48cd9e7b":"code","0ead6a76":"code","19f84d1c":"code","8020025d":"markdown","85dcfc3d":"markdown","8007be54":"markdown","14ed5d28":"markdown","a4382c6c":"markdown","508197e6":"markdown","639eb19d":"markdown","a191052e":"markdown","940c4481":"markdown"},"source":{"447da287":"# importing pandas, numpy\nimport pandas as pd\nimport numpy as np\nimport random","eab376a1":"# importing packages for plots \nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\nfrom pandas import read_csv\n#from sklearn.preprocessing import Imputer\nimport numpy","bb6b8036":"# reading the training dataset\ntitanic_df = pd.read_csv(\"..\/input\/titanic\/train.csv\")","00f6b1a4":"# analyzing missing values\n\ndef missing_value_analysis(data,columns):\n    df = data[columns]\n    missing_value_perc = df.isnull().sum() *100 \/df.shape[0] \n    missing_value_perc = pd.DataFrame({'id':missing_value_perc.index, 'missing_value_perc':missing_value_perc.values})\n\n    missing_data = missing_value_perc[missing_value_perc.missing_value_perc > 0]\n    sns.set(style=\"whitegrid\")\n    plt.figure(figsize=(10,8))\n    ax = sns.barplot(x=\"id\",y=\"missing_value_perc\", data=missing_data, color='steelblue')\n    ax.set_xticklabels(ax.get_xticklabels(), rotation=90)\n    print(missing_data.shape)\n    return missing_value_perc","64c6579e":"missing_value_analysis(titanic_df,columns=['PassengerId', 'Survived', 'Pclass', 'Name', 'Sex', 'Age', 'SibSp',\n       'Parch', 'Ticket', 'Fare', 'Cabin', 'Embarked'])","eb46a5a8":"# filling mising values of age with mean of columns\n\ntitanic_df.iloc[:,5]=titanic_df.iloc[:,5].fillna(titanic_df.mean(axis=0)[3])","8738b63d":"# filling nans of embarked with S, as it is the mostly used value\n\ntitanic_df['Embarked']=titanic_df['Embarked'].fillna('S')\n\n# dropping cabin column as it ahs 77% of nas\n\ntitanic_df = titanic_df.drop([\"Cabin\"],axis=1)","1ce895a9":"# lets check for any missing values\ntitanic_df.isnull().any()","61646435":"# dropping the columns which are not useful as they are customer specific \n\ntitanic_df = titanic_df.drop([\"Ticket\"],axis=1)\ntitanic_df = titanic_df.drop([\"Name\"],axis=1)\n","b5e24f1a":"# encoding to convert string columns to numeric\ntitanic_df['Sex']=titanic_df[\"Sex\"].map({'female':1, 'male':0})\ntitanic_df['Embarked']=titanic_df['Embarked'].map({'S':0, 'C':1,'Q':2})","747630ab":"# Importing kmeans pacjage for clustering\nfrom sklearn import preprocessing\nfrom sklearn.cluster import KMeans\n\nrandom.seed(30)","f71521b5":"X = np.array(titanic_df.drop(['Survived'], 1).astype(float))\nX = preprocessing.scale(X)\ny = np.array(titanic_df['Survived'])","5ca2c382":"X","aea1694e":"# applying clustering algorithm for four clusters\n\nclf = KMeans(n_clusters=4)\nclf.fit(X)\n\ncorrect = 0\nfor i in range(len(X)):\n    predict_me = np.array(X[i].astype(float))\n    predict_me = predict_me.reshape(-1, len(predict_me))\n    prediction = clf.predict(predict_me)\n    if prediction[0] == y[i]:\n        correct += 1\n\nprint(correct\/len(X))","3cd4596b":"# convering labels to dataframe\npp1=clf.fit(X)\npredicted_class1=pp1.labels_\npredicted_class1=pd.DataFrame(predicted_class1)","d60b9050":"predicted_class1=predicted_class1.rename(columns={0: 'output'})\npredicted_class1=predicted_class1.reset_index()\ntitanic_df=titanic_df.reset_index()\ndata1=titanic_df.merge(predicted_class1,on='index')","8a385d0f":"data1['output'].value_counts()","a00f4690":"# convering labels to dataframe\npp1=clf.fit(X)\npredicted_class1=pp1.labels_\npredicted_class1=pd.DataFrame(predicted_class1)\n\npredicted_class1=predicted_class1.rename(columns={0: 'output'})\npredicted_class1=predicted_class1.reset_index()\ntitanic_df=titanic_df.reset_index()\ndata1=titanic_df.merge(predicted_class1,on='index')","5a5d0864":"data1['output'].value_counts()","c06e000b":"def distplot(data, columns, title=None, xlabel = None, ylabel = None, \n             num_bins = 30, edge_color = 'SteelBlue', fill_color = None,\n             line_width = 1.0, fig_size = (8,6), title_font = 14, adjust_top = 0.85, adjust_wspace = 0.3):\n    df = data\n    fig = plt.figure(figsize = fig_size)\n    if title != None:\n        title = fig.suptitle(title, fontsize = title_font)\n    fig.subplots_adjust(top = adjust_top, wspace = adjust_wspace)\n\n    ax1 = fig.add_subplot(1, 1, 1)\n    if xlabel != None:\n        ax1.set_xlabel(xlabel)\n    if ylabel != None:\n        ax1.set_ylabel(ylabel) \n    sns.kdeplot(df[columns], ax=ax1, shade=True, color = edge_color)","9b8c1043":"# lets visualize teh cluster across the survival rates\ndistplot(data=data1,columns=['output','Survived'],xlabel = 'clusters',ylabel='survival')","6398750f":"sns.countplot(x='output',data=data1)","ec160bb5":"class0=data1[data1['output']==0]\nclass1=data1[data1['output']==1]\nclass2=data1[data1['output']==2]\nclass3=data1[data1['output']==3]","378be1d1":"#Distribution of Gender \nsns.distplot(class0['Sex']);","2daa698a":"# Distribution of Age \nsns.set_color_codes()\nsns.distplot(class0['Age'], color=\"r\")  ","fecf7cbd":"# Distribution of Pclass \nsns.set_color_codes()\nsns.countplot(x='Pclass',data=class0)","59381808":"# Distribution of Gender \nsns.distplot(class1['Sex'],kde=False);","d2c5dfde":"#Distribution of Age \nsns.distplot(class1['Age'], color=\"r\")  ","783a464a":"#Distribution of class \nsns.countplot(x='Pclass',data=class1)","17188d44":"#Distribution of Gender\nsns.distplot(class2['Sex']);","9df414bf":"#Distribution of Age\nsns.distplot(class2['Age'], color=\"r\") ","16c5b63f":"#Distribution of Class\nsns.countplot(x='Pclass',data=class2)","96bd53e5":"#Distribution of Gender\nsns.distplot(class3['Sex']);","486c2931":"#Distribution of Age\nsns.distplot(class3['Age'], color=\"r\")  ","48cd9e7b":"#Distribution of Class\nsns.countplot(x='Pclass',data=class3)","0ead6a76":"sns.countplot(data=data1,x='output',hue='SibSp')","19f84d1c":"sns.countplot(data=data1,x='output',hue='Parch')","8020025d":"Visualizing cluster 2\n\n* This cluster has 21% of survival rate and it presents 44% passengers of titanic\n* Majority of male population,80.5% of passengers in cluster 0 are male and 19.4% female\n* No passenger from class 1\n* Majority of class 3 passengers, 70% of passengers are from class 3 and remaining from class 2\n* Population distributed across the age\n","85dcfc3d":"Distribution of Parents\/children for all four clusters\n\nAll passengers from cluster 1 has 2 or >2 dependants\n95% of passengers from cluster 2 has almost no dependent\n","8007be54":"Survival Rate amongst the 4 clusters:\n\ncluster 1- 48%\n\ncluster 2- 21%\n\ncluster 3- 62%\n\ncluster 4- 39%","14ed5d28":"***Importing missing values of column- age,embarked and cabin***","a4382c6c":"Visualizing cluster 1\n\n* This cluster has 48% of survival rate and it presents 15% passengers of titanic\n* 63% of passengers of cluster 1 are female\n* Passengers from all classes\n* Majority of class 3 passengers\n* This class contains passenger below 20\u2019s\n* 65% of passengers are from class 3, 27 % from class 2 and less than 1% from class 1","508197e6":"distribution of passengers across the 4 cluster\n\ncluster 1- 15%\n\nCluster 2- 44%\n\nCluster 3- 25%\n\nCluster 4- 16%","639eb19d":"Visualizing cluster 4\n\n* This cluster has 38% of survival rate and it presents 16% passengers of titanic\n* Majority of male population,62% of passengers in cluster 2 are male and 38% female\n* No passenger from class 1\n* Majority of class 3 passengers,89% of passengers are from class 3 and remaining from class 2\n* Majority of people from 30\u2019s\n","a191052e":"Distribution of sibling for all four clusters\n\nlast three clusters do not have any passengers having more than 2 number of siblings\n","940c4481":"Visualizing cluster 3\n\n* This cluster has 63% of survival rate and it presents 25% passengers of titanic\n* almost equal proportion of male and female population,54.5% of passengers in cluster 1 are male and 45.5% female\n* No passenger from class 3\n* Majority of class 1 passengers, 93% of passengers are from class 1 and remaining from class 2\n* Class is having elder population as well above 60\n"}}