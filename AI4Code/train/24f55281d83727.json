{"cell_type":{"b47187e9":"code","70c993fe":"code","02f8764d":"code","1f31a70f":"code","b55cdc26":"code","18f73d96":"code","cbab19b4":"code","ac382810":"markdown","0fd6cd61":"markdown","8824bbe1":"markdown","ebfcd510":"markdown","398ae3d6":"markdown","edc8158c":"markdown","0e2fe2d1":"markdown","c8ba304c":"markdown","17a11b4b":"markdown","6489d075":"markdown","906d1ab9":"markdown"},"source":{"b47187e9":"from fastai.vision.all import *              # The asterisk '*' here mean everything.\nfrom fastai.metrics import accuracy          # Using accuracy as metric for our model.","70c993fe":"path = \"..\/input\/cotton-disease-dataset\/Cotton Disease\"\n\ndata = ImageDataLoaders.from_folder(path,                              # Path refers to where the folder containing the files is. \n                                    \n                                    valid_pct = 0.3,                   # This refers to the ratio of validation data the model would test itself on.          \n                                   \n                                    bs = 4,                            # bs refers to Batch Size.\n                                    \n                                    shuffle_train = True,              # This shuffles the data before grabbing batches.\n                                   \n                                    item_tfms = Resize(512),           # item_tfms transforms the images to to the given specifications before \n                                                                       #  grabbing batches.\n                                   \n                                    batch_tfms = aug_transforms(       # batch_tfms transforms the batches.\n                                        size = 256, min_scale = 0.75)) ","02f8764d":"data.show_batch(nrows = 1, ncols = 4)","1f31a70f":"learn = cnn_learner(data,                          # data refers to the data preprocessed by the DataLoader\n                    \n                    densenet201,                   # Since we are using Transfer Learning here, lets import the DenseNet201 \n                    \n                    metrics = accuracy)         ","b55cdc26":"# Training the model for 5 epochs:\nlearn.fine_tune(5)","18f73d96":"# Lets see where our classifier got confused:\n\ninterp = ClassificationInterpretation.from_learner(learn)\n\ninterp.plot_confusion_matrix(figsize = (12,12), dpi = 60)","cbab19b4":"# Lets predict on a new images that the model has not seen:\n\nimg = plt.imread(\"..\/input\/cotton-disease-dataset\/Cotton Disease\/test\/diseased cotton leaf\/dis_leaf (124).jpg\")\n\nclassofimg, idx, probability = learn.predict(img)\n\nprint(\"Image is of a\",classofimg + \".\")\\\n\nplt.imshow(img)","ac382810":"![](https:\/\/c4.wallpaperflare.com\/wallpaper\/768\/883\/729\/close-up-photo-of-fruit-on-tree-with-shallow-dept-of-field-magnolia-japanese-magnolia-japanese-wallpaper-preview.jpg)","0fd6cd61":"# Predicting:\nBelow is a confusion matrix and an image predicted.","8824bbe1":"# Libraries\nLiterally two lines of code for importing libraries.","ebfcd510":"# Conclusion\n\nFastAI is better.\n\nThis is the end of this notebook. Thank you for going through this. :))","398ae3d6":"And the result is right!","edc8158c":"While our model did wrongly predict 4 cotton leaves as plants which is alright since the data augmentation might have cropped the images. There are 6 false positive which were classified as fresh cotton plant while they were actually diseased.","0e2fe2d1":"# Table of Content\n\n1. Libraries\n2. DataLoader\n3. Training\n4. Predicting\n5. Conclusion","c8ba304c":"# DataLoader\nDataLoader refers to the tool which helps us load our stuff into a format that woud make it easy for the model to process.","17a11b4b":"# Training\nFinally, the most important part of this notebook. Training a model is quite easy and barely takes any code in fastai libraries. ","6489d075":"Lets take a look at the data:","906d1ab9":"\n\nThe sole purpose of me coding this notebook was to see if a fastai model is actually better than stock PyTorch coded model. Not to forget that the fastai library is actually coded on top PyTorch but there's no harm in trying. \n\nCheck out my previous notebook where [I work on the same dataset using PyTorch.](https:\/\/www.kaggle.com\/vyombhatia\/98-02-accuracy-pytorch-resnet50)"}}