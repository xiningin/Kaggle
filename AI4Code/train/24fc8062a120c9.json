{"cell_type":{"274726e0":"code","3e242d41":"code","f0c3472c":"code","fa8617da":"code","73acde78":"code","c0c5687e":"code","f878db6b":"code","019c891f":"code","4cbe0cb3":"code","92986423":"code","e6a1c09e":"code","c3892758":"code","259c2bf1":"code","fb60d858":"code","14b9e92f":"code","7dccf1a0":"code","fffabb96":"code","56019a2f":"code","a5aff5b4":"code","3ed6588a":"code","40dcdf38":"code","476e9ce5":"code","690acd2d":"code","e1c5568a":"code","a35a0c8a":"code","6f14577e":"code","545f5d5d":"code","5e7dc46f":"code","3c25315e":"code","22a9b199":"code","8ed70bd0":"code","178df729":"code","0080f4e8":"code","a623c070":"code","84f65bd0":"code","5abe9f0c":"code","4192bcb1":"code","57b8a03e":"code","af87a8cd":"code","6b8ec90b":"markdown","2f979c31":"markdown","21af9d6a":"markdown","3698322f":"markdown","2d92d827":"markdown","6641d485":"markdown","e444ceb4":"markdown","d1a7d4f7":"markdown","e317b18b":"markdown","aadc547d":"markdown","7d4ae9f4":"markdown","957fa143":"markdown","26cb8e53":"markdown","5a7d8e85":"markdown","70844b15":"markdown","934ea224":"markdown","c7501d26":"markdown","bb863425":"markdown","43c69bab":"markdown","0cd28279":"markdown","52611cf6":"markdown","85df80f4":"markdown","82372952":"markdown"},"source":{"274726e0":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport matplotlib.gridspec as gridspec\nimport matplotlib.style as style\n\nstyle.use('ggplot')\n\nID = 'id'\nTARGET = 'target'\nNFOLDS = 7\nSEED = 18\nNROWS = None\nDATA_DIR = '..\/input\/suicide-rates-overview-1985-to-2016'\n\nDATA_FILE = f'{DATA_DIR}\/master.csv'","3e242d41":"df = pd.read_csv(DATA_FILE)\ndf.sample(8)","f0c3472c":"def tableSummary(df):\n    from scipy import stats\n    print(f'Dataset Shape: {df.shape}')\n    summary = pd.DataFrame(df.dtypes,columns=['dtypes'])\n    summary = summary.reset_index()\n    summary['Name'] = summary['index']\n    summary = summary[['Name','dtypes']]\n    summary['Missing'] = df.isnull().sum().values    \n    summary['Uniques'] = df.nunique().values\n    summary['First Value'] = df.loc[0].values\n    summary['Second Value'] = df.loc[1].values\n    summary['Third Value'] = df.loc[2].values\n\n    for name in summary['Name'].value_counts().index:\n        summary.loc[summary['Name'] == name, 'Entropy'] = round(stats.entropy(df[name].value_counts(normalize=True), base=2),2) \n\n    return summary","fa8617da":"generations_order = ['G.I. Generation', 'Silent', 'Boomers', 'Generation X', 'Millenials', 'Generation Z']","73acde78":"df.rename(columns={\n    ' gdp_for_year ($) ': 'gdp_for_year',\n    'gdp_per_capita ($)': 'gdp_per_capita',\n    'suicides\/100k pop': 'suicides\/100k',\n}, inplace=True)","c0c5687e":"# Drop country-year because is useless\n# Drop HDI because too many missing values\ndf = df.drop(['country-year', 'HDI for year'], axis=1)\n\ndf['country'] = df['country'].astype('category')\ndf['sex'] = df['sex'].astype('category')\ndf['age'] = df['age'].astype('category')\ndf['generation'] = df['generation'].astype('category')\n\n# Convert GDP to numerical value\ndf['gdp_for_year'] = df['gdp_for_year'].apply(lambda x: int(x.replace(',', ''))).astype('int64')","f878db6b":"tableSummary(df)","019c891f":"# Data cleaning took from https:\/\/www.kaggle.com\/fredzanella\/should-we-care-about-money-an-eda-on-suicide\n# Thanks fredzanella for the amazing work!\n\nagg_dict = { 'country':'nunique', 'age':'nunique',\n             'population':'sum', 'suicides_no':'sum',\n             'suicides\/100k':'mean' }\n\nboth_ends = df.query('year < 1988 | year > 2013')\n\nboth_ends = both_ends[['year', 'country',\n                       'age', 'population',\n                       'suicides_no',\n                       'suicides\/100k']].groupby('year').agg(agg_dict)\nboth_ends","4cbe0cb3":"# Remove 2016 for data inconsistency\ndf = df.query('year != 2016')","92986423":"aggr = { 'population':'sum', 'suicides_no':'sum' }\n\ndf_group_year = df.groupby(['year']).agg(aggr).reset_index()\ndf_group_year['suicides\/100k'] = 100000 * df_group_year['suicides_no'] \/ df_group_year['population']\ndf_group_year.head()","e6a1c09e":"fig = plt.figure(figsize = (16, 8))\nsns.barplot(x='year', y='suicides_no', data=df_group_year, palette='rocket')\nfig.suptitle('Suicides rate by Year', fontsize=18)\nplt.show()","c3892758":"fig, ax = plt.subplots(figsize=(16,8))\ndf_group_year.plot(x='year', y='suicides\/100k', ax=ax)\nfig.suptitle('Suicides rate over 100k by Year', fontsize=18)\nplt.show()","259c2bf1":"fig, ax1 = plt.subplots(1, 1, figsize=(16, 8))\nsns.lineplot(data=df_group_year, y='population', x='year', ax=ax1, label='Population')\nax1.set_ylim(1e9, 2.6e9)\nax1.legend(bbox_to_anchor=(1.112, 0.1))\n\nax2 = plt.twinx()\nsns.lineplot(data=df_group_year, y='suicides_no', x='year', ax=ax2, color='C3', label='Suicides')\nax2.set_ylim(1e5, 2.6e5)\nax2.legend(bbox_to_anchor=(1.1, 0.21))\n\nplt.title('Population vs number of suicides by year', fontsize=18)\nplt.show()","fb60d858":"df_group_sex = df.groupby(['sex']).agg({ 'suicides_no': 'sum' }).reset_index()\ndf_group_sex.head()","14b9e92f":"fig = plt.figure(figsize = (8, 6))\nsns.barplot(x='sex', y='suicides_no', data=df_group_sex, palette='rocket')\nfig.suptitle('Suicides rate by Sex', fontsize=18)\nplt.show()","7dccf1a0":"df_group_year_sex = df.groupby(['year', 'sex']).agg({ 'suicides_no': 'sum' }).reset_index()\ndf_group_year_sex.head()","fffabb96":"fig = plt.figure(figsize = (16, 8))\nsns.barplot(x='year', y='suicides_no', data=df_group_year_sex, hue='sex', palette='rocket')\nfig.suptitle('Suicides rate by Year', fontsize=18)\nplt.show()","56019a2f":"df_jp = df[df['country'] == 'Japan']\ndf_fr = df[df['country'] == 'France']","a5aff5b4":"df_mix1 = df_jp.groupby(['sex']).agg({ 'suicides_no': 'sum' }).reset_index()\ndf_mix1['country'] = 'Japan'\ndf_mix2 = df_fr.groupby(['sex']).agg({ 'suicides_no': 'sum' }).reset_index()\ndf_mix2['country'] = 'France'\n\ndf_mix = pd.concat([df_mix1, df_mix2])\ndf_mix","3ed6588a":"fig = plt.figure(figsize = (8, 6))\nsns.barplot(x='country', y='suicides_no', data=df_mix, hue='sex', palette='rocket')\nfig.suptitle('Suicides rate by Sex - Japan vs France', fontsize=18)\nplt.show()","40dcdf38":"df_group_country = df.groupby(['country']).agg({ 'suicides_no': 'sum' }).reset_index()\ndf_group_country.head()","476e9ce5":"top_countries = df_group_country.sort_values('suicides_no', ascending=False)[:20]\n\nfig = plt.figure(figsize = (16, 8))\ng = sns.barplot(x='country', y='suicides_no', data=top_countries, order=top_countries['country'], palette='rocket')\nfig.suptitle('Suicides rate by Country - top 20', fontsize=18)\ng.set_xticklabels(g.get_xticklabels(), rotation=45)\nplt.show()","690acd2d":"df_group_country_p = df.groupby(['country']).agg({ 'suicides\/100k': 'mean' }).reset_index()\ndf_group_country_p.head()","e1c5568a":"top_countries = df_group_country_p.sort_values('suicides\/100k', ascending=False)[:20]\n\nfig = plt.figure(figsize = (16, 8))\ng = sns.barplot(x='country', y='suicides\/100k', data=top_countries, order=top_countries['country'], palette='rocket')\nfig.suptitle('Suicides rate over 100k citizen - top 20', fontsize=18)\ng.set_xticklabels(g.get_xticklabels(), rotation=45)\nplt.show()","a35a0c8a":"bottom_countries = df_group_country_p.sort_values('suicides\/100k', ascending=True)\nbottom_countries.head(10)","6f14577e":"country_occ = []\n\nfor country in df_group_country_p['country']:\n    years = df[df['country'] == country]['year'].nunique()\n    country_occ.append({\n        'country': country,\n        'year_no': years\n    })\n\ndf_year_country = pd.DataFrame(country_occ)\ndf_year_country.sample(8)","545f5d5d":"print('Mean occurrences for each country:', df_year_country['year_no'].mean())","5e7dc46f":"df_year_country.sort_values('year_no', ascending=True).query('year_no < 15')","3c25315e":"df_gcp = df_group_country_p\ndf_ycfiltered = df_year_country.query('year_no >= 15')\nbottom_countries = df_gcp[df_gcp['country'].isin(df_ycfiltered['country'])].sort_values('suicides\/100k', ascending=True)[:15]\n\nfig = plt.figure(figsize = (16, 8))\ng = sns.barplot(x='country', y='suicides\/100k', data=bottom_countries, order=bottom_countries['country'], palette='rocket')\nfig.suptitle('Suicides rate over 100k citizen - bottom 15 (filtered)', fontsize=18)\ng.set_xticklabels(g.get_xticklabels(), rotation=45)\nplt.show()","22a9b199":"df_group_year_gen = df.groupby(['year', 'generation']).agg({ 'suicides_no': 'sum' }).reset_index()\ndf_group_year_gen['suicides_no'].fillna(0, inplace=True)\ndf_group_year_gen['suicides_no'] = df_group_year_gen['suicides_no'].astype('int64')\ndf_group_year_gen.head(10)","8ed70bd0":"grid = gridspec.GridSpec(30, 2)\nfig = plt.figure(figsize=(20, 150))\nfig.subplots_adjust(hspace=0.4, wspace=0.3)\n\nmin_year = min(df['year'])\nmax_year = max(df['year'])\n\nfor n, year in enumerate(range(min_year, max_year + 1)):\n    df_y = df_group_year_gen[df_group_year_gen['year'] == year]\n    ax = plt.subplot(grid[n])\n    sns.barplot(x='generation', y='suicides_no', data=df_y, palette='rocket', order=generations_order)\n    ax.set_title(f'Suicides rate by Generation - {year}', fontsize=16)\n\nplt.show()","178df729":"df_group_gen = df.groupby(['generation']).agg({ 'suicides_no': 'sum' }).reset_index()\ndf_group_gen","0080f4e8":"rocketPalette = sns.color_palette('rocket', n_colors=8)\n\npatches, texts, autotexts = plt.pie(df_group_gen['suicides_no'],\n                                    colors=rocketPalette,\n                                    labels=df_group_gen['generation'],\n                                    autopct='%1.1f%%',\n                                    startangle=90)\nplt.title('Division of suicides by Generation', fontsize=20, y=1.05)\nfor text in texts:\n    text.set_fontsize(12)\nfor autotext in autotexts:\n    autotext.set_color('white')\n    autotext.set_fontsize(12)\nplt.axis('equal')\nplt.tight_layout()\nplt.show()","a623c070":"df_group_age = df.groupby(['age']).agg({ 'suicides_no': 'sum' }).reset_index()\ndf_group_age","84f65bd0":"rocketPalette = sns.color_palette('rocket', n_colors=8)\n\npatches, texts, autotexts = plt.pie(df_group_age['suicides_no'],\n                                    colors=rocketPalette,\n                                    labels=df_group_age['age'],\n                                    autopct='%1.1f%%',\n                                    startangle=90)\nplt.title('Division of suicides by Age', fontsize=20, y=1.05)\nfor text in texts:\n    text.set_fontsize(12)\nfor autotext in autotexts:\n    autotext.set_color('white')\n    autotext.set_fontsize(12)\nplt.axis('equal')\nplt.tight_layout()\nplt.show()","5abe9f0c":"sns.jointplot(x='suicides_no', y='gdp_per_capita', data=df)\nplt.suptitle('Relation GDP per capita with Suicides number', fontsize=18, y=1.05)\nplt.show()","4192bcb1":"df_ru = df[df['country'] == 'Russian Federation']\ndf_us = df[df['country'] == 'United States']","57b8a03e":"df_ru_gdp = df_ru.groupby(['year']).agg({ 'suicides_no': 'sum', 'gdp_for_year': 'mean' }).reset_index()\n\nsns.jointplot(x='suicides_no', y='gdp_for_year', data=df_ru_gdp, kind='reg')\nplt.suptitle('Relation GDP for year with Suicides number - Russian Federation', fontsize=18, y=1.05)\nplt.show()","af87a8cd":"df_us_gdp = df_us.groupby(['year']).agg({ 'suicides_no': 'sum', 'gdp_for_year': 'mean' }).reset_index()\n\nsns.jointplot(x='suicides_no', y='gdp_for_year', data=df_us_gdp, kind='reg')\nplt.suptitle('Relation GDP for year with Suicides number - USA', fontsize=18, y=1.05)\nplt.show()","6b8ec90b":"Now we could filter countries eliminating irrelevant ones.","2f979c31":"## Informations\n- Countries in the World: **195** ([source](https:\/\/www.worldometers.info\/geography\/how-many-countries-are-there-in-the-world\/))\n\n### Generations\n- Gen Z, iGen, or Centennials: Born 1996 \u2013 Today\n- Millennials or Gen Y: Born 1977 \u2013 1995\n- Generation X: Born 1965 \u2013 1976\n- Baby Boomers: Born 1946 \u2013 1964\n- Silent Generation \/ Traditionalists: Born 1945 - 1925\n- G.I. Generation: Born 1900 - 1924\n\n### Life indexes\n- **HDI per year**: is a statistic composite index of life expectancy, education, and per capita income indicators, which are used to rank countries into four tiers of human development. \n- **GDP**: is a monetary measure of the market value of all the final goods and services produced in a specific time period.","21af9d6a":"### Suicides by age","3698322f":"### Population vs number of suicides trough history","2d92d827":"## EDA\n\n### Sucides rate by year","6641d485":"We could also analyze the top 20 countries with **lowest suicides ratio**, but we should pay attention to the quantity of data available for each of them. If a country have data for a single year only, should not be compared with the others.","e444ceb4":"### Suicides by country with population","d1a7d4f7":"### Suicides by country","e317b18b":"### Analysis Russian Federation - USA","aadc547d":"## Features and cleaning","7d4ae9f4":"# Suicide Rates Overview 1985 to 2016\n> Compares socio-economic info with suicide rates by year and country","957fa143":"We can calculate the number of *year* occurrencies for each country.","26cb8e53":"Countries with occurrences less thant 15","5a7d8e85":"This is a simple EDA to explore the data and extract some relationship with them and the actual world that we know. I want to bring attention to a visual analyzing using different plot in order to find key points inside data.","70844b15":"### GDP - suicides relationship","934ea224":"> In other western countries, males are also much more likely to die by suicide than females (usually by a factor of 3\u20134:1). It was the 8th leading cause of death for males, and 19th leading cause of death for females. Excess male mortality from suicide is lower in non-Western where as of 2015 in China (about one fifth of world population) and seven more countries it is absent, with females more likely to die by suicide than males by a factor of 1.3\u20131.6.\n[Source Wikipedia](https:\/\/en.wikipedia.org\/wiki\/Epidemiology_of_suicide)","c7501d26":"Generations order by years.","bb863425":"### Suicides division by sex","43c69bab":"### Suicides rate by year\/generation","0cd28279":"### Total suicides by generation","52611cf6":"**Is this an evidence of the [Easterlin paradox](https:\/\/en.wikipedia.org\/wiki\/Easterlin_paradox)?** We could discuss the results in the comments.","85df80f4":"## Thanks for reading!","82372952":"**China is not available as Country :(**"}}