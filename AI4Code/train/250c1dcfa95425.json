{"cell_type":{"963fad67":"code","85e5ae6d":"code","902a1e23":"code","4f717d5a":"code","bfd9d914":"code","51ace3e3":"code","c655dc1d":"code","73e4c427":"code","a58863d3":"code","72adee52":"code","5aef5255":"code","21a42bb8":"code","0dd535be":"code","9539825e":"code","08822b6b":"markdown","5be67642":"markdown","0354405d":"markdown","3ec6f1f4":"markdown"},"source":{"963fad67":"import pandas as pd\nimport numpy as np\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.preprocessing import OneHotEncoder\nfrom sklearn.compose import ColumnTransformer, make_column_transformer\nfrom sklearn.pipeline import Pipeline","85e5ae6d":"train_data = pd.read_csv('\/kaggle\/input\/machine-learning-lab-cas-data-science-fs-20\/houses_train.csv', index_col=0)","902a1e23":"X_train = train_data.drop(columns='price')\ny_train = train_data['price']","4f717d5a":"X_train, X_dev, y_train, y_dev = train_test_split(X_train, y_train, stratify=X_train['object_type_name'], test_size=0.1)","bfd9d914":"pipeline = Pipeline([\n    ('pre', make_column_transformer((OneHotEncoder(handle_unknown='ignore'), ['zipcode', 'municipality_name', 'object_type_name']), remainder='passthrough')),\n    ('clf', LinearRegression())\n])","51ace3e3":"pipeline.fit(X_train, y_train)","c655dc1d":"y_dev_pred = pipeline.predict(X_dev)","73e4c427":"def mean_absolute_percentage_error(y_true, y_pred): \n    return np.mean(np.abs((y_true - y_pred) \/ y_true)) * 100","a58863d3":"mean_absolute_percentage_error(y_dev, y_dev_pred)","72adee52":"X_test = pd.read_csv('\/kaggle\/input\/machine-learning-lab-cas-data-science-fs-20\/houses_test.csv', index_col=0)","5aef5255":"y_test_pred = pipeline.predict(X_test)","21a42bb8":"X_test_submission = pd.DataFrame(index=X_test.index)","0dd535be":"X_test_submission['price'] = y_test_pred","9539825e":"X_test_submission.to_csv('lr_submission.csv', header=True, index_label='id')","08822b6b":"# define and train model","5be67642":"# Predict and evaluate prices for dev set","0354405d":"# prepare data","3ec6f1f4":"# Predict prices for test set"}}