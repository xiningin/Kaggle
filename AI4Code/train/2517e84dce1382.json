{"cell_type":{"33790abc":"code","809addfd":"code","1f72fdf4":"code","fef0b154":"code","41e0ef1a":"code","206b1bc2":"code","cfb1b548":"code","5ed8abdd":"code","a30bd98b":"code","e3b6291e":"code","418308c1":"code","d9cb19ed":"code","f05ca70d":"code","7b1a3255":"code","cd89a777":"code","25626285":"code","ae83c9c5":"code","d943a409":"code","0b3568a7":"code","3b48ee1c":"code","c3cbe3d3":"code","d8a040a0":"code","7e480e08":"code","ee389f64":"code","17a08c96":"code","88262b8a":"code","b9ce4f38":"code","29420843":"markdown","feb556ab":"markdown","8a67bfbf":"markdown","e5fb87d1":"markdown","bd4b62cd":"markdown","e106c195":"markdown","6042f91f":"markdown"},"source":{"33790abc":"from sklearn.pipeline import Pipeline\nfrom sklearn.preprocessing import StandardScaler\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom sklearn.metrics import log_loss\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.model_selection import cross_val_score, cross_val_predict\nfrom sklearn.metrics import f1_score, roc_auc_score, confusion_matrix\nfrom sklearn.linear_model import SGDClassifier\npd.options.display.max_columns = 80","809addfd":"train_path = '\/kaggle\/input\/tabular-playground-series-jun-2021\/train.csv'\ntest_path = '\/kaggle\/input\/tabular-playground-series-jun-2021\/test.csv'","1f72fdf4":"train = pd.read_csv(train_path,index_col='id')\ntest = pd.read_csv(test_path,index_col='id')","fef0b154":"train.head()","41e0ef1a":"train.info() #n\u00e3o possui valores NaN ou nulos","206b1bc2":"train['target'].value_counts()","cfb1b548":"train.hist(figsize=(120,80))","5ed8abdd":"s = StandardScaler()\ntrain[train.columns[:10]].hist(figsize=(20,15))\nk = s.fit_transform(train[train.columns[:10]])","a30bd98b":"plt.hist(k)\nplt.show()","e3b6291e":"train_X = train.drop('target',axis=1)\ntrain_y = train['target']\nfeatures = list(train_X.columns)\nfeatures","418308c1":"pipeline = Pipeline([('scaler',StandardScaler())])","d9cb19ed":"train_prep = pipeline.fit_transform(train_X)","f05ca70d":"sgd_class = SGDClassifier(n_jobs=8)\nsgd_class.fit(train_prep,train_y)\npredictions = sgd_class.predict(train_prep)","7b1a3255":"cross_val_score(sgd_class,train_prep,train_y,cv=3,scoring='accuracy',n_jobs=8)","cd89a777":"f1_score(train_y,predictions,average='weighted')","25626285":"rf_clf = RandomForestClassifier(n_jobs=8,n_estimators=1000,max_depth=4,random_state=41)\nrf_clf.fit(train_prep,train_y)","ae83c9c5":"rf_predictions = rf_clf.predict(train_prep)","d943a409":"f1_score(train_y,rf_predictions,average='weighted')","0b3568a7":"sorted(zip(features, rf_clf.feature_importances_),key=lambda x: x[1],reverse=True)","3b48ee1c":"cross_val_score(rf_clf,train_prep,train_y,cv=3,n_jobs=8)","c3cbe3d3":"t_train_pred=cross_val_predict(rf_clf,train_prep,train_y,cv=3,n_jobs=8)","d8a040a0":"conf_mx = confusion_matrix(train_y,t_train_pred)","7e480e08":"plt.matshow(conf_mx,cmap=plt.cm.gray)","ee389f64":"conf_mx","17a08c96":"y_pred = rf_clf.predict_proba(train_prep)","88262b8a":"logloss = log_loss(train_y, y_pred)\nprint(f'Log loss: {logloss}')","b9ce4f38":"predictions = rf_clf.predict_proba(pipeline.transform(test))\nsub = pd.DataFrame(predictions, columns=['Class_1','Class_2','Class_3','Class_4','Class_5','Class_6','Class_7','Class_8','Class_9'])\nsub['id']= test.index.to_series().values\n\nsub.to_csv('submission.csv', index=False)\n\n","29420843":"### Probabilidades por classe","feb556ab":"### Log Loss","8a67bfbf":"### RandomForest Classifier","e5fb87d1":"### Separar o target","bd4b62cd":"### Caminho de treino e teste","e106c195":"### Submission","6042f91f":"### Confusion Matrix"}}