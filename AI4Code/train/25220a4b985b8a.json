{"cell_type":{"d4af0889":"code","3ca2727e":"code","150209dc":"code","96027961":"code","0dfc16e4":"code","b7e58b4b":"code","ee2bd7dd":"code","494a0b13":"code","4f8a81e2":"code","20a70dbb":"markdown","88df3cdf":"markdown","21535115":"markdown","6802f60c":"markdown","51d18a4a":"markdown","89a6dd7e":"markdown","0c66d465":"markdown","284251ac":"markdown","33768b2e":"markdown","2e62e4d9":"markdown","4b7bd533":"markdown","d2ff20bd":"markdown","575a92bb":"markdown","d990fb54":"markdown","95e688f3":"markdown","c4ce4ce1":"markdown","8bf66962":"markdown","b2011e72":"markdown","a82b4ca9":"markdown","05e40746":"markdown"},"source":{"d4af0889":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n","3ca2727e":"data = pd.read_csv(\"\/kaggle\/input\/red-wine-quality-cortez-et-al-2009\/winequality-red.csv\")\ndata.head()","150209dc":"np.random.seed(11)\nsample_7_and_above = data[data['quality'].isin([7, 8])].sample(10)[['alcohol']].reset_index().drop(columns = ['index'])\nsample_7_and_above","96027961":"x_bar = np.mean(sample_7_and_above[\"alcohol\"])\nprint(\"The mean of the sample is: \", str(x_bar))\ns = np.std(sample_7_and_above[\"alcohol\"])\nprint(\"The standard deviation of the sample is: \", str(s))","0dfc16e4":"sns.distplot(sample_7_and_above[\"alcohol\"], hist=False)\ntitle = \"X_bar_1 = \" + str(x_bar) + \", s1 = \"+ str(s)\nplt.title(title)","b7e58b4b":"seed = np.arange(0, 9)\n\nx_bar = []\nstd_dev = []\n\nfor s in seed:\n    np.random.seed(s)\n    sample_7_and_above = data[data['quality'].isin([7, 8])].sample(10)[['alcohol']].reset_index().drop(columns = ['index'])\n    x_bar.append(np.mean(sample_7_and_above[\"alcohol\"]))\n    std_dev.append(np.std(sample_7_and_above[\"alcohol\"]))\n    \nsamples = pd.DataFrame(columns = [\"Sample Means (X_bar)\", \"Sample Standard Deviation (s)\"], data= list(zip(x_bar, std_dev)))\nsamples","ee2bd7dd":"sns.distplot(samples[\"Sample Means (X_bar)\"])\nplt.title(\"Distribution of the sample means\")","494a0b13":"fig, axes = plt.subplots(nrows=3, ncols=2, figsize=(12, 10))\n\nax = fig.add_subplot(3, 2, 1)\nsns.distplot(data[\"alcohol\"])\nplt.title(\"Original distribution of Alcohol level in the entire dataset\")\n\nseed = np.arange(0, 2)\nx_bar = []\nfor s in seed:\n    np.random.seed(s)\n    sample_7_and_above = data.sample(10)[['alcohol']].reset_index().drop(columns = ['index'])\n    x_bar.append(np.mean(sample_7_and_above[\"alcohol\"]))\n\nax = fig.add_subplot(3, 2, 2)\nsns.distplot(x_bar)\nplt.title(\"Sample means of 2 samples of 10 each\")\n\nseed = np.arange(0, 7)\nx_bar = []\nfor s in seed:\n    np.random.seed(s)\n    sample_7_and_above = data.sample(10)[['alcohol']].reset_index().drop(columns = ['index'])\n    x_bar.append(np.mean(sample_7_and_above[\"alcohol\"]))\n    \nax = fig.add_subplot(3, 2, 3)\nsns.distplot(x_bar)\nplt.title(\"Sample means of 7 samples of 10 each\")\n\nseed = np.arange(0, 20)\nx_bar = []\nfor s in seed:\n    np.random.seed(s)\n    sample_7_and_above = data.sample(10)[['alcohol']].reset_index().drop(columns = ['index'])\n    x_bar.append(np.mean(sample_7_and_above[\"alcohol\"]))\n\nax = fig.add_subplot(3, 2, 4)\nsns.distplot(x_bar)\nplt.title(\"Sample means of 20 samples of 10 each\")\n\nseed = np.arange(0, 100)\nx_bar = []\nfor s in seed:\n    np.random.seed(s)\n    sample_7_and_above = data.sample(10)[['alcohol']].reset_index().drop(columns = ['index'])\n    x_bar.append(np.mean(sample_7_and_above[\"alcohol\"]))\n\nax = fig.add_subplot(3, 2, 5)\nsns.distplot(x_bar)\nplt.title(\"100 samples of 10 each\")\n\nseed = np.arange(0, 500)\nx_bar = []\nfor s in seed:\n    np.random.seed(s)\n    sample_7_and_above = data.sample(10)[['alcohol']].reset_index().drop(columns = ['index'])\n    x_bar.append(np.mean(sample_7_and_above[\"alcohol\"]))\n    \nax = fig.add_subplot(3, 2, 6)\nsns.distplot(x_bar)\nplt.title(\"500 samples of 10 each\")\n\nfig.tight_layout()\nplt.show()","4f8a81e2":"np.random.seed(11)\nsample_7_and_above = data[data['quality'].isin([7, 8])].sample(13)[['alcohol']].reset_index().drop(columns = ['index'])\nsample_7_and_above","20a70dbb":"# Sample Proportions\n\nSample proportion is simply the number of observations in the sample which meets our criteria. It is represented by p\u0302\n\n$$ \\bar p = \\frac {x} {n} $$\n\nwhere x is the number of sample that we are interested in, and n is the total number of sample\n\n# Question 5:\n### Taking a random sample of 13 observations, what is the sample proportion of having alcohol level of greater than 11.3?","88df3cdf":"So here is the 10 samples that the manager took:","21535115":"### In the above output, we have 9 out of 13 observations have an alcohol level of greater than 11.3. Hence the sample proportion is:\n\n$$ \\bar p = \\frac {x} {n} = \\frac {9} {13} = 0.69 $$","6802f60c":"### Now the question is, what is the distribution of the sample means? One way to think about it is considering the distribution of the sample means. We call this as sampling distribution.","51d18a4a":"What is the mean and standard deviation of the samples?","89a6dd7e":"# Sampling\n\nStatistics is science of inference. So to infer a value, you can infer it from the entire population or from a fraction of the population, which is called the sample. \n\nThe reason for sampling are:\n- Few cases it might be impossible to collect data on the entire population\n- Saves time and money\n\nAs we might already know, sampling will not be helpful in cases like electing a representative of a country (sample of voters vote instead of entire population of the country), collecting census data of a country\n\nSample statistics as estimators of population parameters:\n- Whenever referring to the population parameter, we refer it in Greek letters.\n- When referring to the sample estimates, we refer it in English alphabets.\n\n![image.png](attachment:image.png)","0c66d465":"# Reference:\n1. https:\/\/www.youtube.com\/watch?v=4v41z3HwLaM\n2. https:\/\/www.kaggle.com\/madhurisivalenka\/basic-machine-learning-with-red-wine-quality-data\n3. https:\/\/towardsdatascience.com\/write-markdown-latex-in-the-jupyter-notebook-10985edb91fd\n4. https:\/\/www.youtube.com\/watch?v=DmZJ1blQOns&t=1015s\n5. https:\/\/www.youtube.com\/watch?v=uIHFbMn8SBc\n6. https:\/\/www.youtube.com\/watch?v=QbGRTWLjp7c","284251ac":"# Introduction:\n\nI am fascinated with all things statistics which is the base of all the machine learning algorithms. I strongly beleive that a strong foundation in statistics will make us as not just as better data scientists, but also will make us more intutive in real life. I often say that the machine learning is just a glorified form of statistics.\n\n![image.png](attachment:image.png)\n\nIn this notebook I am explaining a concept in statistics called sampling and sampling distribution, which is very essential also to machine learning. As ML models are build on some form of sample data, and not on all the data that is available in the system.\n\n### This is a series of notebooks which will go through the techniques that is essential for the statistics and will be useful for all machine learning practitioners. It is a series of 6 notebooks:\n\n1. [This notebook] [Sampling and sample distribution](https:\/\/www.kaggle.com\/gireeshs\/learn-statistics-1-sampling-sample-distribution)\n2. [Confidence intervals](https:\/\/www.kaggle.com\/gireeshs\/learn-statistics-2-confidence-interval)\n3. [WIP] Hypothesis testing\n4. [WIP] Comparison of two populations\n5. [WIP] Analysis of variance (ANOVA)\n6. [Linear regression basics with matrix multiplication](https:\/\/www.kaggle.com\/gireeshs\/diy-from-scratch-linearregression-only-using-numpy)\n\n## Motivation:\n* I developed this notebook reading the book \"[Complete business statistics](https:\/\/www.amazon.in\/Complete-Business-Statistics-Amir-Aczel\/dp\/0071077901)\" . \n* I also like the [youtube videos](https:\/\/www.youtube.com\/c\/BrandonFoltz) by Brandon Foltz, which I often recommend to someone who starts to learn data science.","33768b2e":"# Point estimate\n\nWe are trying to make an estimation based of a large population based (like all of the students in the university, all of the workers in the industry, or in this case all of the wine quality) on the a sample.\n\nSo in this case, let us assume that we are quality control of the wine manufacturing plant and we have to make inference about the whole of the population based on the data that we have in hand. Obviously, we cannot do this on all of the wine bottle, because wine are aged and we will not be able to pop open all the bottles. So we select some sample of the wine and say, if those are okay, then everything else should be okay as well. \n\n","2e62e4d9":"# Sampling distribution\n\nTake multiple samples from our population.\n\n### Let us take 9 samples each of size 10","4b7bd533":"# Question 2:\n### Now remember, our goal was to get a mean of 11.3, but we got 11.65 for our samples. Since this is a sample and we do not expect it to be exactly 11.3, is 11.65 close enough to our acceptable goal?\n\n### Does this batch of sample accurately reflect the alcohol content of the entire population?\n\n### How can we determine that?\n\nThe point estimates are never perfect, they always have an error component. This is commenly referred to as \"margin of error\".","d2ff20bd":"### Expected value (mean) of the X\u0304:\n\n$$ E(\\bar X  _{n}) = \\mu $$\n\nThe expected value of the of the X\u0304 = population mean.\n\n### Points to consider from this:\n* The expected value of X\u0304 is the best estimate for \u03bc. But for this we have to take all the possible samples from the population, which is not our goal.\n* The best we are going to do is to come up with a range (or interval) for the value of \u03bc \n* But our interval estimate will be affected by sample size and degree of \"confidence\".\n\n# Question 3:\n### What is the error in the mean, given that the population standard deviation \ud835\udf0e = 1.55?","575a92bb":"# Question 1:\n\n### A wine can be labeled as quality 7 and above only if the alcohol level is greater than 11.3. If the level of alcohol is less, then the will won't taste sour enuogh, if the alcohol level is less than 11.3 then the wine might be bitter. \n\n### The price difference between quality 7 & 8 wine and quality 5 & 6 wine will be as much as 125%. So the company needs to be very particular to maintain this standard. \n\n### The quality control person is only allowed to open 10 bottles of wine in quality 7 & 8 to make sure the levels are sufficient. \n\n### Points to note:\n* There is no way that the company will be able to open all the bottles of wine\n* The company must take samples and then make inferences about the entire batch (population)","d990fb54":"# Question 4:\n### Given that the quality checking person is drawing a sample of 10 wines of quality 7 & 8, he assumes that the sample batch meets the alcohol level of 11.3, but he know that it is acceptable untill the batch alcohol mean level drops to 11.15. What is the the probability that the batch will have the sample mean of less than 11.15?\n\n#### Assumption: Population mean \u03bc = 11.3 and population standard deviation \ud835\udf0e = 1.55","95e688f3":"### Please upvote if you found this notebook useful and interesting!\n\n## Please visit my other notbooks on statistics here:\n\n1. [This notebook] [Sampling and sample distribution](https:\/\/www.kaggle.com\/gireeshs\/learn-statistics-1-sampling-sample-distribution)\n2. [Confidence intervals](https:\/\/www.kaggle.com\/gireeshs\/learn-statistics-2-confidence-interval)\n3. [WIP] Hypothesis testing\n4. [WIP] Comparison of two populations\n5. [WIP] Analysis of variance (ANOVA)\n6. [Linear regression basics with matrix multiplication](https:\/\/www.kaggle.com\/gireeshs\/diy-from-scratch-linearregression-only-using-numpy)","c4ce4ce1":"# Standard error of the mean:\n$$ \\sigma _ \\bar x  = \\dfrac{\\sigma}{\\sqrt{n}} $$\n\nRemember now we are given the population standard deviation as 1.55\n\n$$ \\sigma _ \\bar x  = \\dfrac{1.55}{\\sqrt{10}}  = 0.49 $$\n\n### Points to note:\n* Note that as the number of samples increases, denominator of the fraction given above reduces and the \ud835\udf0e\ud835\udc65 also reduces.\n\n## Influence of sample size.\nIf we had taken 20 samples insted of 10, what will the value of our \ud835\udf0e\ud835\udc65 be?\n\n$$ \\sigma _ \\bar x  = \\dfrac{1.55}{\\sqrt{20}}  = 0.34 $$\n\nIt does down by 0.15. What if we took 100 samples?\n\n$$ \\sigma _ \\bar x  = \\dfrac{1.55}{\\sqrt{100}}  = 0.155 $$\n\n### Another way to think about that is as the number of samples increases, we are getting a value of X\u0304 closer to the actual population mean \u03bc.","8bf66962":"### Important implication of that: The standard error of the mean will remain the SAME for ANY sample of size 10.\n\n### In our case, for any batch of 10 samples, the standard error of the mean will always remain 0.49 (assuming population standard deviation remains the same).","b2011e72":"The samples are going to have it's own distribution","a82b4ca9":"# Central limit theorem:\n\nSo we saw above that the sample means of many samples looked like familiar to the normal distribution\n\n## If we take many samples from population of any shape, then if we do a distribution of sample means, it will be normal!\n\n#### We can see from the below graphs that though the initial distribution is right skewed, as we take more and more samples, we tend to get pretty close to the normal distribution!","05e40746":"#### Here our random variable X\u0304 is normal, as per the central limit theorem, and has a mean of \u03bc. \n#### Also the standard deviation of the variable X\u0304 is equal to sigma \/ sqrt(n)\n\n$$ P(\\bar X < 11.15) = P (Z < \\frac{11.15 - \\mu}{\\sigma \/ \\sqrt(n)}) $$\n\n$$ = P (Z < \\frac{11.15 - 11.3}{1.55 \/ \\sqrt 10})$$\n\n$$ = P (Z < -0.30603) = 0.3594 $$\n\n### So if the population mean is indeed 11.3 and population standard deviation is 1.55, then there is a 35% probability that the sample taken has alcohol level less than 11.15."}}