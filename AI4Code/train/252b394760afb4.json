{"cell_type":{"49b3715e":"code","d0e8cd97":"code","616e2a2a":"code","a3706d4b":"code","983e4ad6":"code","344bd4d3":"code","9c8621a5":"code","916fd54a":"code","9300b4ff":"code","52fe67e6":"code","eeae1acd":"code","3fb4a36b":"code","882d86af":"code","40de39f6":"code","514be13d":"code","0c445b51":"code","aad3b747":"code","78f70a53":"code","77cd5209":"code","87c91a1e":"code","9015182f":"code","892b3401":"code","a4ddbc0a":"code","e225b851":"code","884470d9":"code","ce650315":"code","c572f6d7":"code","78e0794f":"code","bb26c2e1":"code","11195a9a":"code","ee57ca33":"code","18206595":"code","724c70b1":"code","691f95c9":"code","d2a76a15":"code","adc22dce":"code","501af660":"markdown","2627de17":"markdown","3bae13d7":"markdown","29550dfd":"markdown","319b0331":"markdown","13ea2551":"markdown","2255ac64":"markdown","2b82dce9":"markdown","97bf6699":"markdown","f8c2169e":"markdown","a3e763da":"markdown","f0d9dbf9":"markdown","779bc616":"markdown","ac6dddb5":"markdown","c074a5ee":"markdown","7aecb3e7":"markdown","4d40fded":"markdown","46d4b25d":"markdown","8d3dab6c":"markdown","56c7a16c":"markdown","6acd4753":"markdown","b20bd5c6":"markdown","ed54197d":"markdown","052e1e2e":"markdown","338cdaea":"markdown","59264b1b":"markdown","ad74e9db":"markdown","56836e9e":"markdown","846a80b2":"markdown","5d22f8e7":"markdown","1000fa75":"markdown","a9bb36b7":"markdown","696410bb":"markdown"},"source":{"49b3715e":"import numpy as np \nimport pandas as pd\nimport matplotlib.pyplot as plt\n%matplotlib inline \nimport seaborn as sns\nsns.set()\nimport warnings\nwarnings.filterwarnings('ignore')\n\n","d0e8cd97":"data = pd.read_csv(\"..\/input\/water-potability\/water_potability.csv\")\ndata.head()","616e2a2a":"data.describe()","a3706d4b":"data.shape","983e4ad6":"data[\"Potability\"].value_counts(normalize=True)","344bd4d3":"sns.set_style(\"whitegrid\")\nsns.countplot(x=\"Potability\",data=data,saturation=1,palette=\"magma\")","9c8621a5":"data.corr()","916fd54a":"plt.figure(figsize=(15,8))\nsns.heatmap(data.corr(),cmap='coolwarm')","9300b4ff":"fig, ((ax1, ax2), (ax3, ax4)) = plt.subplots(2, 2,figsize=(10,8))\n\nax1.hist(data[\"ph\"])\nax1.set_xlabel(\"ph\",fontsize=32)\nax2.hist(data[\"Hardness\"])\nax2.set_xlabel(\"Hardness(mg\/L)\",fontsize=32)\nax3.hist(data[\"Solids\"])\nax3.set_xlabel(\"TDS(ppm)\",fontsize=32)\nax4.hist(data[\"Chloramines\"])\nax4.set_xlabel(\"Chloramine(ppm)\",fontsize=32)\nplt.tight_layout()\n\n\n\n\n","52fe67e6":"fig, ((ax1, ax2), (ax3, ax4)) = plt.subplots(2, 2,figsize=(10,8))\n\nax1.hist(data[\"Sulfate\"])\nax1.set_xlabel(\"Sulfates(mg\/L)\",fontsize=32)\nax2.hist(data[\"Conductivity\"])\nax2.set_xlabel(\"Conductivity(uS\/cm)\",fontsize=32)\nax3.hist(data[\"Organic_carbon\"])\nax3.set_xlabel(\"TOC(ppm)\",fontsize=32)\nax4.hist(data[\"Trihalomethanes\"])\nax4.set_xlabel(\"Trihalomethanes(ug\/L)\",fontsize=32)\nplt.tight_layout()\n","eeae1acd":"data.isnull().sum()\n","3fb4a36b":"sns.heatmap(data.isnull(),cmap=\"viridis\")\nplt.gcf().set_size_inches(12,6)\n","882d86af":"sns.set_style(\"darkgrid\")\nsns.boxplot(x=\"ph\",data=data,color=\"skyblue\")\nplt.xlabel(\"PH\",fontsize=22)\nprint(data.ph.mean())\nplt.gcf().set_size_inches(10,6)","40de39f6":"data.ph=data.ph.fillna(data.ph.mean())","514be13d":"sns.set_style(\"whitegrid\")\nsns.violinplot(x=\"Sulfate\",data=data,color=\"red\")\nplt.xlabel(\"sulfates\",fontsize=22)\nprint(data.Sulfate.mean())\nplt.gcf().set_size_inches(12,6)","0c445b51":"data.Sulfate=data.Sulfate.fillna(data.Sulfate.mean())","aad3b747":"sns.set_style(\"whitegrid\")\nsns.boxenplot(x=\"Trihalomethanes\",data=data,color=\"yellow\")\nplt.xlabel(\"Trihalomethanes\",fontsize=22)\n\nprint(data.Trihalomethanes.mean())\nplt.gcf().set_size_inches(12,6)","78f70a53":"data.Trihalomethanes=data.Trihalomethanes.fillna(data.Trihalomethanes.mean())","77cd5209":"data.isnull().sum()","87c91a1e":"data.head()","9015182f":"targets = data[\"Potability\"]\nfeatures = data.drop(\"Potability\",axis=1)","892b3401":"from sklearn.preprocessing import StandardScaler\nscaler = StandardScaler().fit(features)\nscaled_features = scaler.transform(features)","a4ddbc0a":"from sklearn.model_selection import train_test_split\nx_train,x_test,y_train,y_test = train_test_split(scaled_features,targets,test_size=0.35,random_state=42)","e225b851":"sns.pairplot(data,hue = 'Potability')","884470d9":"from sklearn.tree import DecisionTreeClassifier\ndtree = DecisionTreeClassifier().fit(x_train,y_train)\npredictions = dtree.predict(x_test)","ce650315":"from sklearn.metrics import classification_report,confusion_matrix\nprint(confusion_matrix(y_test,predictions))\nprint(\"\\n\")\nprint(classification_report(y_test,predictions))","c572f6d7":"from sklearn.ensemble import RandomForestClassifier\nrfc = RandomForestClassifier(100).fit(x_train,y_train)\npredictions = rfc.predict(x_test)\n","78e0794f":"from sklearn.metrics import classification_report,confusion_matrix\nprint(confusion_matrix(y_test,predictions))\nprint(\"\\n\")\nprint(classification_report(y_test,predictions))","bb26c2e1":"from sklearn.svm import SVC\nsvc= SVC().fit(x_train,y_train)\npredictions = svc.predict(x_test)","11195a9a":"from sklearn.metrics import classification_report,confusion_matrix\nprint(confusion_matrix(y_test,predictions))\nprint(\"\\n\")\nprint(classification_report(y_test,predictions))","ee57ca33":"import xgboost\nclassifier= xgboost.XGBClassifier()\nclassifier.fit(x_train,y_train)\npredictions = classifier.predict(x_test)","18206595":"from sklearn.metrics import classification_report,confusion_matrix\nprint(confusion_matrix(y_test,predictions))\nprint(\"\\n\")\nprint(classification_report(y_test,predictions))","724c70b1":"from sklearn.model_selection import RandomizedSearchCV\n\nn_estimators = [50,100,250,500,750,1000,1500]\nmax_depth = [2,3,5,10,15]\nbooster = ['gbtree','gblinear']\nbase_score=[0.25,0.5,0.75,1]\nmin_child_weight =[1,2,3,4,5]\nlearning_rate = [0.05,0.1,0.15,0.20]\n\nhyperparameter_grid={\n    'n_estimators':n_estimators,\n    'max_depth':max_depth,\n    'booster':booster,\n    'min_child_weight':min_child_weight,\n    'learning_rate':learning_rate    \n}\n\n","691f95c9":"xgrf = RandomizedSearchCV(estimator=classifier,param_distributions=hyperparameter_grid,n_iter=50,cv=3,\n                          random_state=42,verbose=0)\n                          \n\n","d2a76a15":"xgrf.fit(x_train,y_train)","adc22dce":"xgrf2 = xgrf.best_estimator_\npredictions = xgrf2.predict(x_test)\nfrom sklearn.metrics import classification_report,confusion_matrix\nprint(confusion_matrix(y_test,predictions))\nprint(\"\\n\")\nprint(classification_report(y_test,predictions))","501af660":"# Model Selection","2627de17":"*our dataset is not heavily imbalanced , having a ratio of 60\/40*","3bae13d7":"## Feature Engineering\n\n##### Lets check if our dataset contains some missing values or not","29550dfd":"### Content\nThe water_potability.csv file contains water quality metrics for 3276 different water bodies,across various columns described below:","319b0331":"# Introduction","13ea2551":"#### 3.Trihalomethanes","2255ac64":"# 4.Xgboost","2b82dce9":"#### Lets see visualizations which will help us to choose best model for our dataset","97bf6699":"### Randomized Search CV","f8c2169e":">>> *This dataset will bring us some insights towards factor which are responsible for potability of water, so lets dive in*","a3e763da":"**Some of our features are having missing values lets deal with them**","f0d9dbf9":">>> **The mean value of ph comes around 7 , and as PH is normally distributed we will fill missing values with the mean**","779bc616":"### Some of the important points to be considered before choosing models:\n#### Its a classification problem\n#### With above visualization we can notice the classes are highly overlapped, so choosing a linear model such as logistic regression might not be a wise choice","ac6dddb5":"#### Importing basic Libraries:","c074a5ee":"# 2.Random Forest","7aecb3e7":"**Declining water quality has become a global issue of concern as human populations grow, industrial and agricultural activities expand, and climate change threatens to cause major alterations to the hydrological cycle. ... Poor water quality has a direct impact on water quantity in a number of ways.**","4d40fded":"**1. pH value** :  WHO has recommended maximum permissible limit of pH from 6.5 to 8.5\n\n**2. Hardness**: Hardness is mainly caused by calcium and magnesium salts.\n\n**3. Solids (Total dissolved solids - TDS)**:Desirable limit for TDS is 500 mg\/l and maximum limit is 1000 mg\/l which prescribed for drinking purpose.\n\n**4. Chloramines**: Chlorine levels up to 4 milligrams per liter (mg\/L or 4 parts per million (ppm)) are considered safe in drinking water.\n\n**5. Sulfate:** It ranges from 3 to 30 mg\/L in most freshwater supplies, although much higher concentrations (1000 mg\/L) are found in some geographic locations.\n\n**6. Conductivity:** According to WHO standards, EC value should not exceeded 400 \u03bcS\/cm.\n\n**7. Organic_carbon:** According to US EPA < 2 mg\/L as TOC in treated \/ drinking water, and < 4 mg\/Lit in source water which is use for treatment.\n\n**8. Trihalomethanes:** THM levels up to 80 ppm is considered safe in drinking water.\n\n**9. Turbidity:** The mean turbidity value obtained for Wondo Genet Campus (0.98 NTU) is lower than the WHO recommended value of 5.00 NTU.\n\n**10. Potability:** Indicates if water is safe for human consumption where 1 means Potable and 0 means Not potable.","46d4b25d":">>> **Now our dataset is  preprocessed & ready for model creation**","8d3dab6c":"![unnamed.jpg](attachment:unnamed.jpg)","56c7a16c":"***lets see some descriptive stats of our dataset***","6acd4753":"# 3.SVM","b20bd5c6":"# Data PreProcessing & Feature Scaling","ed54197d":"# EDA\n\n**lets get some visual insights from our dataset** ","052e1e2e":">**Having said that lets screen and train our model on 4 MACHINE LEARNING models** :\n   #### Decision Tree\n   #### Random Forest\n   #### SVM\n   #### Xgboost ","338cdaea":"# HyperParameter Tuning","59264b1b":"#### we can see that the accuracy has increased a bit.","ad74e9db":"*Now our dataset is not having any missing values*","56836e9e":"#### 2.Sulfates","846a80b2":"![safe_water.jpg](attachment:safe_water.jpg)","5d22f8e7":">>> **Its good to notice that our features are quiet normally distributed**","1000fa75":">>> **Lets see we can increase model accuracy with optimization or not , we will choose xgboost and try to impliment**","a9bb36b7":"# 1.Decision Trees \n\n","696410bb":"#### 1.PH"}}