{"cell_type":{"01ac5ba3":"code","a0f2c8e0":"code","781da152":"code","2b462937":"code","ac7bed2e":"code","7d1dff5e":"code","97cdc1a4":"code","f82ba832":"code","1e60067c":"code","d7adda7c":"code","90850529":"code","a9b83a7a":"code","e902650b":"code","e5dc8cfb":"code","00a4dab2":"code","6dec5999":"code","24880b73":"code","e3029146":"code","0f177955":"code","c7cf312d":"code","aa44366d":"code","34e064e4":"code","25775ccd":"code","b96000a4":"code","86d30a7d":"code","3f8f490f":"code","225855ec":"code","1cf7bd28":"code","d3c9bffa":"code","af34b54b":"code","bfd343c7":"code","02f8d3a6":"code","60925d57":"code","d660d91b":"code","972dcbe2":"code","7dd38dca":"code","dc864f55":"code","6a38e279":"code","963d336d":"code","730d5456":"code","4d709caa":"code","4b0583c7":"code","8961cac2":"code","7d219025":"code","529b2856":"code","816e1591":"code","ac5b9b8c":"code","4453184c":"code","2410b5b7":"code","feacb397":"code","55940428":"code","77c43846":"code","f90bb214":"code","e88dc5c6":"code","19ce38ab":"code","32a35e32":"code","bc2cf099":"code","663f0a59":"code","150dbc2c":"code","03545f47":"markdown","c80d50da":"markdown","bf4a23aa":"markdown","9f1323e1":"markdown","f35e3d25":"markdown","276db699":"markdown","cc4d955e":"markdown","bc0acb6e":"markdown","53f9322b":"markdown","9c3013ed":"markdown","a4473a26":"markdown","3da6ef16":"markdown","3fe2df21":"markdown","36cdcfc0":"markdown","14becffd":"markdown","374adb86":"markdown","e88c5274":"markdown","45389f6c":"markdown","75368bbe":"markdown","c1af5c6d":"markdown","4defb72a":"markdown","48fe12e4":"markdown","e4764601":"markdown","a7b06b8c":"markdown","1c804bce":"markdown","179f4791":"markdown","87aaa6e1":"markdown"},"source":{"01ac5ba3":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\nimport fuzzywuzzy\nfrom fuzzywuzzy import process\nimport chardet\n\nfrom subprocess import check_output","a0f2c8e0":"# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\n\n#print(check_output([\"ls\", \"..\/input\"]).decode(\"utf8\"))\n\n# Any results you write to the current directory are saved as output.\n\nNA2 = pd.read_csv(\"..\/input\/National Assembly 2002 - Updated.csv\", encoding = \"ISO-8859-1\")\nNA8 = pd.read_csv(\"..\/input\/National Assembly 2008.csv\", encoding = \"ISO-8859-1\")\nNA13 = pd.read_csv(\"..\/input\/National Assembly 2013.csv\", encoding = \"ISO-8859-1\")\nprint(\"Data Dimensions are: \", NA2.shape)\nprint(\"Data Dimensions are: \", NA8.shape)\nprint(\"Data Dimensions are: \", NA13.shape)","781da152":"print(\"NA 2002.csv\")\nNA2.info()\nprint(\"\\nNA 2008.csv\")\nNA8.info()\nprint(\"\\nNA 2013.csv\")\nNA13.info()","2b462937":"print(NA2.head())\nprint(NA8.head())\nprint(NA13.head())\nprint(NA8.columns, \"\\n>>\\n\", NA13.columns)","ac7bed2e":"\nNA8.rename(columns={'Unnamed: 0':'District'}, inplace=True)\nNA13.rename(columns={'Unnamed: 0':'District'}, inplace=True)\nprint(\"NA 8: \", NA8.columns, \"\\nNA 13: \", NA13.columns)\n#NA13 = NA13.drop('Unnamed: 11', axis=1)","7d1dff5e":"NA8.District = NA8.Seat#.str.split(\"-\", expand=True)[0]\n#Add District column\n#NA8['District'] = NA8['Seat']\nNA8['District'] = NA8['District'].str.replace(\".\",\" \") # to deal with D.I. Khan\n# remove all those substring with () \nNA8['District'] = NA8['District'].str.replace(r\"\\(.*\\)\",\"\")\n# remove numeric\nNA8['District']  = NA8['District'] .str.replace('[^a-zA-Z -]', '')\n#NA8['District'] = NA8['District'].str.replace(r\"Cum.*\",\"\")\n#NA8['District'] = NA8['District'].str.replace(r\"cum.*\",\"\")\n#na18['District'] = na18['District'].str.replace(r\"KUM.*\",\"\")\n# to convert Tribal Area III - Mohman into Tribal Area III\nNA8['District'] = NA8['District'].str.replace(r\"-.*\",\"\")\nNA8['District']  = NA8['District'] .str.replace(r\" (XX|IX|X?I{0,3})(IX|IV|V?I{0,3})$\", '')\nNA8['District']  = NA8['District'] .str.replace(r\" (XX|IX|X?I{0,3})(IX|IV|V?I{0,3})$\", '')\nNA8['District'].unique()","97cdc1a4":"NA13.District = NA13.Seat #.str.split(\"-\", expand=True)[0]\n#Add District column\n#NA13['District'] = NA13['Seat']\nNA13['District'] = NA8['District'].str.replace(\".\",\" \") # to deal with D.I. Khan\n# remove all those substring with () \nNA13['District'] = NA13['District'].str.replace(r\"\\(.*\\)\",\"\")\n# remove numeric\nNA13['District']  = NA13['District'] .str.replace('[^a-zA-Z -]', '')\nNA13['District'] = NA13['District'].str.replace(r\"Cum.*\",\"\")\n#na18['District'] = na18['Distirct'].str.replace(r\"KUM.*\",\"\")\n# to convert Tribal Area III - Mohman into Tribal Area III\nNA13['District'] = NA13['District'].str.replace(r\"-.*\",\"\")\nNA13['District']  = NA13['District'] .str.replace(r\" (XX|IX|X?I{0,3})(IX|IV|V?I{0,3})$\", '')\nNA13['District']  = NA13['District'] .str.replace(r\" (XX|IX|X?I{0,3})(IX|IV|V?I{0,3})$\", '')\nNA13['District'].unique()","f82ba832":"NA13.head()","1e60067c":"NA8['Turnout'] = NA8['Turnout'].str.rstrip('%').str.rstrip(' ')\nNA13['Turnout'] = NA13['Turnout'].str.rstrip('%').str.rstrip(' ')\nNA8['Turnout'] = pd.to_numeric(NA8['Turnout'], errors='coerce')\nNA13['Turnout'] = pd.to_numeric(NA13['Turnout'], errors='coerce')","d7adda7c":"NA2['Year'] = \"2002\"\nNA8['Year'] = \"2008\"\nNA13['Year'] = \"2013\"","90850529":"print(NA2.head(), \"\\n\", NA8.head(), \"\\n\", NA13.head())","a9b83a7a":"print(\"NA2\", NA2.isnull().any(), \"\\nNA8: \", NA8.isnull().any(), \"\\nNA13:\", NA13.isnull().any())","e902650b":"print(\"\\n NA2\", NA2.columns, \"\\n NA8\", NA8.columns, \"\\n NA13\", NA13.columns)","e5dc8cfb":"NA2.rename(columns={'Constituency_title':'ConstituencyTitle', 'Candidate_Name':'CandidateName', 'Total_Valid_Votes':'TotalValidVotes', 'Total_Rejected_Votes':'TotalRejectedVotes', 'Total_Votes':'TotalVotes', 'Total_Registered_Voters':'TotalRegisteredVoters', }, inplace=True)\nNA2.columns","00a4dab2":"df = pd.concat([NA2, NA8, NA13])\ndf.shape\ndf.head()","6dec5999":"df.isnull().any()","24880b73":"# get all the unique values in the 'District' column\n#df['District'] = df['District'].astype(str)\ndist = df['District'].unique()\n#dist.sort()\ndist","e3029146":"# convert to lower case\ndf['District'] = df['District'].str.lower()\n# remove trailing white spaces\ndf['District'] = df['District'].str.strip()","0f177955":"dist = df['District'].unique()\n#dist.sort()\ndist","c7cf312d":"# get the top 10 closest matches to \"charsadda\"\nmatches = fuzzywuzzy.process.extract(\"charsadda\", dist, limit=10, scorer=fuzzywuzzy.fuzz.token_sort_ratio)\n\n# take a look at them\nmatches","aa44366d":"# function to replace rows in the provided column of the provided dataframe\n# that match the provided string above the provided ratio with the provided string\ndef replace_matches_in_column(df, column, string_to_match, min_ratio = 90):\n    # get a list of unique strings\n    strings = df[column].unique()\n    \n    # get the top 10 closest matches to our input string\n    matches = fuzzywuzzy.process.extract(string_to_match, strings, \n                                         limit=10, scorer=fuzzywuzzy.fuzz.token_sort_ratio)\n\n    # only get matches with a ratio > 90\n    close_matches = [matches[0] for matches in matches if matches[1] >= min_ratio]\n\n    # get the rows of all the close matches in our dataframe\n    rows_with_matches = df[column].isin(close_matches)\n\n    # replace all rows with close matches with the input matches \n    df.loc[rows_with_matches, column] = string_to_match\n    ","34e064e4":"# use the function we just wrote to replace close matches to \"charsadda\" \nreplace_matches_in_column(df=df, column='District', string_to_match=\"charsadda\")","25775ccd":"dist = df['District'].unique()\n#dist.sort()\ndist","b96000a4":"replace_matches_in_column(df=df, column='District', string_to_match=\"nowshera\")\nreplace_matches_in_column(df=df, column='District', string_to_match=\"rawalpindi\")\nreplace_matches_in_column(df=df, column='District', string_to_match=\"sheikhupura\")\nreplace_matches_in_column(df=df, column='District', string_to_match=\"shikarpur\")\nreplace_matches_in_column(df=df, column='District', string_to_match=\"nankana sahib\")","86d30a7d":"del dist\n\npty = df['Party'].unique()\npty.sort()\npty","3f8f490f":"df['Party'] = df['Party'].replace(['MUTTHIDA\\xa0MAJLIS-E-AMAL\\xa0PAKISTAN'], 'Muttahidda Majlis-e-Amal Pakistan')\ndf['Party'] = df['Party'].replace(['Pakistan Muslim League'], 'Pakistan Muslim League (QA)')\n#converting text to lower case & removing white spaces\ndf['Party'] = df['Party'].str.lower()\ndf['Party'] = df['Party'].str.strip()","225855ec":"# As I coded this earlier, I wouldn't change it due to lower case letters. \nreplace_matches_in_column(df=df, column='Party', string_to_match=\"Balochistan National Movement\")\nreplace_matches_in_column(df=df, column='Party', string_to_match=\"Independent\")\nreplace_matches_in_column(df=df, column='Party', string_to_match=\"Istiqlal Party\")\nreplace_matches_in_column(df=df, column='Party', string_to_match=\"Jamote Qaumi Movement\")\nreplace_matches_in_column(df=df, column='Party', string_to_match=\"Labour Party Pakistan\")\nreplace_matches_in_column(df=df, column='Party', string_to_match=\"Mohib-e-Wattan Nowjawan Inqilabion Ki Anjuman (MNAKA)\")\nreplace_matches_in_column(df=df, column='Party', string_to_match=\"Muttahida Qaumi Movement\") # Muttahida Qaumi Movement Pakistan\nreplace_matches_in_column(df=df, column='Party', string_to_match=\"Muttahidda Majlis-e-Amal\") # Muttahidda Majlis-e-Amal Pakistan\nreplace_matches_in_column(df=df, column='Party', string_to_match=\"National Peoples Party\")\nreplace_matches_in_column(df=df, column='Party', string_to_match=\"Nizam-e-Mustafa Party\")\nreplace_matches_in_column(df=df, column='Party', string_to_match=\"Pak Muslim Alliance\")\nreplace_matches_in_column(df=df, column='Party', string_to_match=\"Pakistan Awami Party\")\nreplace_matches_in_column(df=df, column='Party', string_to_match=\"Pakistan Democratic Party\")\n# After analyzing each of the below strings.\nreplace_matches_in_column(df=df, column='Party', string_to_match=\"Pakistan Muslim League (QA)\", min_ratio =97)\nreplace_matches_in_column(df=df, column='Party', string_to_match=\"Pakistan Muslim League (N)\", min_ratio =97)\nreplace_matches_in_column(df=df, column='Party', string_to_match=\"Pakistan Muslim League (J)\", min_ratio =97)\nreplace_matches_in_column(df=df, column='Party', string_to_match=\"Pakistan Muslim League (F)\", min_ratio =97)\nreplace_matches_in_column(df=df, column='Party', string_to_match=\"Pakistan Peoples Party Parliamentarians\", min_ratio =97)\nreplace_matches_in_column(df=df, column='Party', string_to_match=\"Pakistan Peoples Party(Shaheed Bhutto)\", min_ratio =95)\nreplace_matches_in_column(df=df, column='Party', string_to_match=\"Pakistan Peoples Party(Sherpao)\", min_ratio =97)\nreplace_matches_in_column(df=df, column='Party', string_to_match=\"Pakistan Tehreek-e-Insaf\", min_ratio =95)\nreplace_matches_in_column(df=df, column='Party', string_to_match=\"Saraiki Sooba Movement Pakistan\", min_ratio =95)\n","1cf7bd28":"#fuzzywuzzy.process.extract(\"Pakistan Muslim League (QA)\", pty, limit=10, scorer=fuzzywuzzy.fuzz.token_sort_ratio) # acceptance value >97\n#fuzzywuzzy.process.extract(\"Pakistan Muslim League (N)\", pty, limit=10, scorer=fuzzywuzzy.fuzz.token_sort_ratio) # acceptance value >97\n#fuzzywuzzy.process.extract(\"Pakistan Muslim League (J)\", pty, limit=10, scorer=fuzzywuzzy.fuzz.token_sort_ratio) # acceptance value >97\n#fuzzywuzzy.process.extract(\"Pakistan Muslim League (F)\", pty, limit=10, scorer=fuzzywuzzy.fuzz.token_sort_ratio) # acceptance value >97\n#fuzzywuzzy.process.extract(\"Pakistan Peoples Party Parliamentarians\", pty, limit=10, scorer=fuzzywuzzy.fuzz.token_sort_ratio) # acceptance value >97\n#fuzzywuzzy.process.extract(\"Pakistan Peoples Party(Shaheed Bhutto)\", pty, limit=10, scorer=fuzzywuzzy.fuzz.token_sort_ratio) # acceptance value >95\n#fuzzywuzzy.process.extract(\"Pakistan Peoples Party(Sherpao)\", pty, limit=10, scorer=fuzzywuzzy.fuzz.token_sort_ratio) # acceptance value >97\n#fuzzywuzzy.process.extract(\"Pakistan Tehreek-e-Insaf\", pty, limit=10, scorer=fuzzywuzzy.fuzz.token_sort_ratio) # acceptance value >95\n#fuzzywuzzy.process.extract(\"Saraiki Sooba Movement Pakistan\", pty, limit=10, scorer=fuzzywuzzy.fuzz.token_sort_ratio) # acceptance value >95\n","d3c9bffa":"df['Party'] = df['Party'].str.lower()\n# few fixes taken from https:\/\/www.kaggle.com\/usman786\/exploratory-data-analysis-for-interesting-insights\/notebook\ndf['Party'].replace(['muttahida qaumi movement pakistan'], 'muttahida qaumi movement', inplace = True)\ndf['Party'].replace(['indeindependentdente','independent (retired)','indepndent'], 'independent',inplace = True)\ndf['Party'].replace(['indeindependentdente','independent (retired)','indepndent'], 'independent',inplace = True)\ndf['Party'].replace(['muttahidda majlis-e-amal pakistan','mutthida\\xa0majlis-e-amal\\xa0pakistan'\n                     ,'mutthida\u00ef\u00bf\u00bdmajlis-e-amal\u00ef\u00bf\u00bdpakistan'] \n                     ,'muttahidda majlis-e-amal' ,inplace = True)\ndf['Party'].replace(['nazim-e-mistafa'], 'nizam-e-mustafa party' ,inplace = True)\ndf['Party'].replace(['pakistan muslim league (qa)'], 'pakistan muslim league (q)' ,inplace = True)\ndf['Party'].replace(['pakistan muslim league council'], 'pakistan muslim league (c)' ,inplace = True)\ndf['Party'].replace(['pakistan muslim league \\x93h\\x94 haqiqi'], 'pakistan muslim league haqiqi' ,inplace = True)\ndf['Party'].replace(['pakistan muslim league(z)'], 'pakistan muslim league (z)' ,inplace = True)\ndf['Party'].replace(['pakistan peoples party(shaheed bhutto)'], 'pakistan peoples party (shaheed bhutto)' ,inplace = True)\ndf['Party'].replace(['pakistan peoples party parliamentarians'], 'pakistan peoples party parliamentarians' ,inplace = True)\ndf['Party'].replace(['pakistan sariaki party'], 'Pakistan Siraiki Party (T)' ,inplace = True)\ndf['Party'].replace(['pasban'], 'pasban pakistan' ,inplace = True)\ndf['Party'].replace(['qaumi watan party (sherpao)'], 'qaumi watan party' ,inplace = True)\ndf['Party'].replace(['tehreek-e-suba hazara'], 'tehreek-e-suba hazara pakistan' ,inplace = True)\n#...\ndf['Party'].replace(['pashtoonkhwa milli awami party'], 'pakhtoonkhwa milli Awami party' ,inplace = True)\ndf['Party'].replace(['pakistan amn party'], 'pakistan aman party' ,inplace = True)\ndf['Party'].replace(['pakistan awami inqelabi'], 'Pakistan Awami Inqelabi League' ,inplace = True)\ndf['Party'].replace(['pakistan freedom party'], 'pakistan freedom movement' ,inplace = True)\ndf['Party'].replace(['pakistan insani haqook party (pakistan human rights party)'], 'pakistan human rights party' ,inplace = True)\ndf['Party'].replace(['awami justice party'], 'awami justice party pakistan' ,inplace = True)\ndf['Party'].replace(['indeindependentdent'], 'independent' ,inplace = True)\ndf['Party'].replace(['jamiat ulama-e-pakistan  (noorani)'], 'jamiat ulama-e-pakistan (noorani)' ,inplace = True)\ndf['Party'].replace(['jumiat ulma-e-islam(nazryati)'], 'jamiat ulma-e-islam nazryati pakistan' ,inplace = True)\ndf['Party'].replace(['majlis-e-wahdat-e-muslimeen pakistan'], 'Majlis Wahdat-e-Muslimeen Pakistan' ,inplace = True)\ndf['Party'].replace(['markazi jamat-al-hadais'], 'Markazi Jamiat Ahl-e-Hadith' ,inplace = True)\ndf['Party'].replace(['mohib-e-wattan nowjawan inqilabion ki anjuman (mnaka)'], 'Muhib-e-Watan Noujawan Anqlabion Ki Anjuman (MNAKA)' ,inplace = True)\n\npty = df['Party'].unique()\npty.sort()\npty","af34b54b":"#del pty\n#convert textual content to lower case & remove trailing white spaces\ndf['CandidateName'] = df['CandidateName'].str.lower()\ndf['CandidateName'] = df['CandidateName'].str.strip()\ndf['CandidateName'].head(10)","bfd343c7":"# remove mr at the beginning of names.\ndf['CandidateName'] = df.loc[:, 'CandidateName'].replace(regex=True, to_replace=\"mr \", value=\"\")\ndf['CandidateName'] = df.loc[:, 'CandidateName'].replace(regex=True, to_replace=\"mrs \", value=\"\")\ndf['CandidateName'] = df.loc[:, 'CandidateName'].replace(regex=True, to_replace=\"miss \", value=\"\")\n#df['CandidateName'] = df.loc[:, 'CandidateName'].replace(regex=True, to_replace=\"mis \", value=\"\")\ndf['CandidateName'].head(10)","02f8d3a6":"cn = df['CandidateName'].unique()\ncn.sort()\nprint(\"cn size: \", cn.shape, \"\\nValues: \", cn) ","60925d57":"df['CandidateName']","d660d91b":"fuzzywuzzy.process.extract(\"zumurad khan\", cn, limit=10, scorer=fuzzywuzzy.fuzz.token_sort_ratio) # acceptance value >90\nfuzzywuzzy.process.extract(\"zobaida jalal\", cn, limit=10, scorer=fuzzywuzzy.fuzz.token_sort_ratio) # acceptance value >79\n#fuzzywuzzy.process.extract(\"barkat ali\", cn, limit=10, scorer=fuzzywuzzy.fuzz.token_sort_ratio) # acceptance value >90\n#fuzzywuzzy.process.extract(\"sher muhammad baloch\", cn, limit=10, scorer=fuzzywuzzy.fuzz.token_sort_ratio) # acceptance value >90\n#fuzzywuzzy.process.extract(\"gulab baloch\", cn, limit=10, scorer=fuzzywuzzy.fuzz.token_sort_ratio) # acceptance value >90\n#fuzzywuzzy.process.extract(\"babu gulab\", cn, limit=10, scorer=fuzzywuzzy.fuzz.token_sort_ratio) # acceptance value >90","972dcbe2":"replace_matches_in_column(df=df, column='CandidateName', string_to_match=\"zumurad khan\", min_ratio=92)\nreplace_matches_in_column(df=df, column='CandidateName', string_to_match=\"zobaida jalal\", min_ratio=80)\nreplace_matches_in_column(df=df, column='CandidateName', string_to_match=\"barkat ali\", min_ratio=90)\nreplace_matches_in_column(df=df, column='CandidateName', string_to_match=\"muhammad yasin baloch\", min_ratio=90)\n\nfor candi in df['CandidateName'].unique(): # 7000\n    replace_matches_in_column(df=df, column='CandidateName', string_to_match=candi, min_ratio=90)\n\n# let us know the loop is completed\nprint(\"All done!\")","7dd38dca":"#del NA2, NA8, NA13\ndf.to_csv('NA2002-18.csv', index=None) ","dc864f55":"cc = pd.read_csv(\"..\/input\/National Assembly Candidates List - 2018 Updated.csv\", encoding = \"ISO-8859-1\")\nna18 = pd.read_csv(\"..\/input\/2013-2018 Seat Changes in NA.csv\", encoding = \"ISO-8859-1\") \npp = pd.read_csv(\"..\/input\/Political Parties in 2018 Elections - Updated.csv\", encoding = \"ISO-8859-1\")\nprint(cc.shape, na18.shape, pp.shape)","6a38e279":"print(cc.columns, na18.columns)","963d336d":"cc['NA#'] = 'NA-' + cc['NA#'].astype(str)","730d5456":"print(cc['NA#'].unique().shape) # 272\nprint(na18['2018 Seat Number'].unique().shape) # 273\nna18.rename(columns={'2018 Seat Number':'NA#'}, inplace=True)\nna18.rename(columns={'Seat Name':'Seat'}, inplace=True)\nna18[na18['NA#'] == \"Old Constituency Changed Considerably\"]","4d709caa":"na18 = na18[na18['NA#'] != \"Old Constituency Changed Considerably\"]\nna18['NA#'] = na18.loc[:, 'NA#'].replace(regex=True, to_replace=\"NA-\", value=\"\")\nna18['NA#'] = pd.to_numeric(na18['NA#'])\nna18['NA#'] = na18['NA#'].astype(np.int64)\nna18['NA#'] = 'NA-' + na18['NA#'].astype(str)\n#na18['NA#'] = na18.loc[:, 'NA#'].replace(regex=True, to_replace=\".0\", value=\"\")\nna18['NA#'].head()","4b0583c7":"#Add District column & its cleani\nna18['Distirct'] = na18['Seat']\n# remove all those substring with () \nna18['Distirct'] = na18['Distirct'].str.replace(r\"\\(.*\\)\",\"\")\n# remove numeric\nna18['Distirct']  = na18['Distirct'].str.replace('[^a-zA-Z -]', '')\nna18['Distirct'] = na18['Distirct'].str.replace(r\"Cum.*\",\"\")\n#na18['Distirct'] = na18['Distirct'].str.replace(r\"KUM.*\",\"\")\n# to convert Tribal Area III - Mohman into Tribal Area III\nna18['Distirct'] = na18['Distirct'].str.replace(r\"-.*\",\"\")\nna18['Distirct']  = na18['Distirct'] .str.replace(r\" (XX|IX|X?I{0,3})(IX|IV|V?I{0,3})$\", '')\nna18['Distirct']  = na18['Distirct'] .str.replace(r\" (XX|IX|X?I{0,3})(IX|IV|V?I{0,3})$\", '')\nna18['Distirct'].unique()","8961cac2":"cc = cc.join(na18.set_index('NA#'), on='NA#')\ncc.info()","7d219025":"print(pp.shape)\npp['Name of Political Party'].unique()","529b2856":"pp.rename(columns={'Acronym':'PartyAcro'}, inplace=True)\ncc.rename(columns={'Party':'PartyAcro'}, inplace=True)\npp.rename(columns={'Name of Political Party':'Party'}, inplace=True)","816e1591":"# Clean Candidate file\npp['Party'].replace(['pakistan reh-e- haq party'], 'Pakistan Rah-e- Haq Party' ,inplace = True)\npp['Party'].replace(['Pakistan Muslim League SHER-E-BANGAL A.K. Fazal-Ul-Haque'], 'pakistan muslim league (sher-e-bangal)' ,inplace = True)\npp['Party'].replace(['Pakistan Muslim League (Zia-ul-Haq Shaheed)'], 'pakistan muslim league (z)' ,inplace = True)\npp['Party'].replace(['Pakistan Muslim League (Junejo)'], 'pakistan muslim league (j)' ,inplace = True)\npp['Party'].replace(['Pakistan Muslim League (Functional)'], 'pakistan muslim league (f)' ,inplace = True)\npp['Party'].replace(['Pakistan Muslim League (Council)'], 'pakistan muslim league (c)' ,inplace = True)\npp['Party'].replace(['Pakistan Muslim League-Nawaz'], 'pakistan muslim league (n)' ,inplace = True)\npp['Party'].replace(['Pakistan Justice & Democratic Party'], 'Pakistan Justice and Democratic Party' ,inplace = True)\npp['Party'].replace(['Pakistan Kissan Ittehad (Ch. Anwar)'], 'Pakistan Kissan Ittehad' ,inplace = True)\npp['Party'].replace(['Jamiat Ulma-e-Islam Nazryati Pakistan'], 'Jamiat Ulma-e-Islam Nazaryati Pakistan' ,inplace = True)\npp['Party'].replace(['Jamiat Ulma-e-Islam Nazryati Pakistan'], 'Jamiat Ulma-e-Islam Nazaryati Pakistan' ,inplace = True)\npp['Party'].replace(['Jamiat Ulama-e-Islam(F)'], 'Jamiat Ulama-e-Islam (F)' ,inplace = True)\npp['Party'].replace(['Jamiat Ulama-e-Islam(S)'], 'Jamiat Ulama-e-Islam (S)' ,inplace = True)\npp['Party'].replace(['Mohajir Qaumi Movement (Pakistan)'], 'Mohajir Qaumi Movement pakistan' ,inplace = True)\npp['Party'].replace(['Mutahida Majlis-e-Amal'], 'Muttahida Majlis-e-Amal' ,inplace = True)\npp['Party'].replace(['Muttahidda Qaumi Movement Pakistan'], 'Muttahida Qaumi Movement Pakistan' ,inplace = True)\n","ac5b9b8c":"# Remove duplicaties\npp.drop_duplicates(subset=['PartyAcro'], keep=\"first\", inplace=True)\npp.info()","4453184c":"pp","2410b5b7":"cc[cc['PartyAcro']=='PTI'].head()\n#pp[pp['PartyAcro']=='PTEI']","feacb397":"#del cnd\ncnd = cc.join(pp.set_index('PartyAcro'), on='PartyAcro')","55940428":"cnd.info()\ncnd.head()","77c43846":"cnd[cnd['PartyAcro']==\"PTI\"].head()\n#remove non-aplhabetic characters from Name\ncnd['Name'] = cnd['Name'].str.replace('[^a-zA-Z ]', '')\ncnd['Name'] = cnd['Name'].str.lower()\ncnd['Name'] = cnd['Name'].str.strip()\n\ncnd['Party'] = cnd['Party'].str.lower()\ncnd['Party'] = cnd['Party'].str.strip()\n\ncnd[cnd['PartyAcro']==\"PTI\"].head()","f90bb214":"print(df.columns, cnd.columns)\ndf.info()\ncnd.info()","e88dc5c6":"cnd.rename(columns={'NA#':'ConstituencyTitle'}, inplace=True)\ncnd.rename(columns={'Name of Political Party':'Party'}, inplace=True)\ncnd.rename(columns={'Name':'CandidateName'}, inplace=True)","19ce38ab":"cnd.to_csv('Canditates2018.csv', index=None) \npp.to_csv('Parties_cleand.csv', index=None)","32a35e32":"\n# Reading 2018 Results Data\nNA18 = pd.read_csv(\"..\/input\/NA-Results2018 Ver 2.csv\", encoding = \"ISO-8859-1\")\nprint(\"Data Dimensions of NA18 are: \", NA18.shape)\n\nprint(\"\\nNA 2018.csv\")\nNA18.info()\n\nNA18 = NA18.drop('Unnamed: 0', axis=1)\nNA18.rename(columns={'district':'District'}, inplace=True)\n\nNA18.District = NA18.Seat\nNA18['District'] = NA18['District'].str.replace(\".\",\" \") # to deal with D.I. Khan\nNA18['District'] = NA18['District'].str.replace(r\"\\(.*\\)\",\"\")\nNA18['District']  = NA18['District'] .str.replace('[^a-zA-Z -]', '')\nNA18['District'] = NA18['District'].str.replace(r\"-.*\",\"\")\nNA18['District']  = NA18['District'] .str.replace(r\" (XX|IX|X?I{0,3})(IX|IV|V?I{0,3})$\", '')\nNA18['District']  = NA18['District'] .str.replace(r\" (XX|IX|X?I{0,3})(IX|IV|V?I{0,3})$\", '')\nNA18['District'].unique()\n\nNA18['Turnout'] = NA18['Turnout'].str.rstrip('%').str.rstrip(' ')\nNA18['Turnout'] = pd.to_numeric(NA18['Turnout'], errors='coerce')\nNA18.rename(columns={'Constituency_Title':'ConstituencyTitle', 'Candidate_Name':'CandidateName', 'Total_Valid_Votes':'TotalValidVotes', 'Total_Rejected_Votes':'TotalRejectedVotes', 'Total_Votes':'TotalVotes', 'Total_Registered_Voters':'TotalRegisteredVoters', 'Part':'Party' }, inplace=True)\nNA18.columns","bc2cf099":"# convert to lower case\nNA18['District'] = NA18['District'].str.lower()\n# remove trailing white spaces\nNA18['District'] = NA18['District'].str.strip()\n\n# convert to lower case\nNA18['CandidateName'] = NA18['CandidateName'].str.lower()\n# remove trailing white spaces\nNA18['CandidateName'] = NA18['CandidateName'].str.strip()\n\n# convert to lower case\nNA18['Party'] = NA18['Party'].str.lower()\n# remove trailing white spaces\nNA18['Party'] = NA18['Party'].str.strip()","663f0a59":"NA18.head()","150dbc2c":"NA18.to_csv('NA2018_Clean.csv', index=None)","03545f47":"<h3><u>Note: Both files can not is mergered easily as NA mapping is changed for current year.  <\/u><\/h3>\nI will use both files in EDA and Feature Engineering.","c80d50da":"Just looking at this, We can see some problems due to inconsistent data entry: 'PESHAWAR' and Peshawar ', for example, or 'Charsadda' and 'Charsdda'.\n\nThe first thing we are going to do is make everything lower case (we can change it back at the end if need) and remove any white spaces at the beginning and end of cells. Inconsistencies in capitalizations and trailing white spaces are very common in text data and you can fix a good 80% of your text data entry inconsistencies by doing this.","bf4a23aa":"<h1> Data Wrangling of Electoral Data<\/h1>\n<h2>Get our environment set up<\/h2>\nThe first thing we'll need to do is load in the libraries we'll be using.","9f1323e1":"<h2>Data Info<\/h2>\n\nLet's look into the info of provided dataset.","f35e3d25":"So the first column should be District. We will extract district names from Seat column.\nWe will drop last column from NA13 because it contain no value..\n\n<b>Rename Column and Replace Values <\/b>","276db699":"Lets observe few to set the threshold for fuzzywuzzy","cc4d955e":"Lets fix few more","bc0acb6e":"There is no null record.\n\nFinal step before merging:\n\nJust to confirm that column names are similar in all files.","53f9322b":"<h2>Some Preliminary Text Pre-processing<\/h2>\nHere, I'm interested in cleaning up all Text columns to make sure there's no data entry inconsistencies in it. We could go through and check each row by hand, of course, and hand-correct inconsistencies when we find them. There's a more efficient way to do this though!","9c3013ed":"Lets add District column and do its cleaning","a4473a26":"We can see that two of the items in the districts are very close to \"charsadda\": 'charsadda; and 'charsdda'.\n\nLet's replace all rows in our District column that have a ratio of > 90 with \"charsadda\".\n\nFor the reusability,  I'm going to write a function to fix all these challenges ASAP.","3da6ef16":"It does look like there are some remaining inconsistencies: 'charsadda' and 'charsdda' should probably be the same. \n\nWe are going to use the fuzzywuzzy package to help identify which string are closest to each other. \n> <b>Fuzzy matching:<\/b> The process of automatically finding text strings that are very similar to the target string. In general, a string is considered \"closer\" to another one the fewer characters you'd need to change if you were transforming one string into another. So \"apple\" and \"snapple\" are two changes away from each other (add \"s\" and \"n\") while \"in\" and \"on\" and one change away (rplace \"i\" with \"o\"). You won't always be able to rely on fuzzy matching 100%, but it will usually end up saving you at least a little time.\n\nFuzzywuzzy returns a ratio given two strings. The closer the ratio is to 100, the smaller the edit distance between the two strings. Here, we're going to get the ten strings from our list of districts that have the closest distance to \"charsadda\".","3fe2df21":"<h2>Concatenate All 3 Datasets <\/h3>","36cdcfc0":"Now our dataset is aligned and ready to merge. But before merging, lets add another column  'Year'. ","14becffd":"To test the funtion","374adb86":"<h2> Data Cleaning of NA 2018 Election Results <h2>","e88c5274":"Merging .. ","45389f6c":"All three files have 11 columns. Row details are as follow:\n\n* NA 2002: 1,792\n* NA 2008: 2,315\n* NA 2013: 4,541\n\nNA 2002.cv file has fine data types. \n\nIn NA 2008 & NA 2013 files:\n* 1st column name is missing and showing that it have int64 data type. \n* Turnout column has read as object.\n\n<h2>Data Wrangling <\/h2>\nLets observe the 1st file in order to fix next two and merge them all into one dataframe.","75368bbe":"<h2>Load Data<\/h2>\n","c1af5c6d":"<h2>NAN Values<\/h2>\nLets check the status of NA values","4defb72a":"Adding \"NA-\" string in NA# column to merge it with na18 dataset.","48fe12e4":"<h2>Candidate List & Parties of 2018 Election<\/h2>\nLets se if these 2 files need some cleaning as well. We will merge both files. ","e4764601":"We will remove Mr Initial from the begining of names, But we will keep Dr Initial because it is worth gaining title. ","a7b06b8c":"<h3>Lets Clean data around Party & Candidates Name <\/h3>","1c804bce":"<h2>Use fuzzy matching to correct inconsistent data entry<\/h2>\nAlright, let's take another look at the district column and see if there's any more data cleaning we need to do.","179f4791":"We are all set with first issue. Turnout column has % symbol in it which makes it object datatype. We will remove non-numeric characters and change datatype.\n\n<b>Change the datatype of Turnout column <\/b>","87aaa6e1":"That's all from me. I tried to clean maximum of the data inconsistency issues. So, I am saving this file for the audience for the seek a reusability. You can fork kernel and continue from here.\n\nWe are all set to move towards <b>Exploratory Data Analysis <\/b>. \n\nDo share your comments and if you find it helpful, <b>please upvote! <\/b>\n<h2> Happy Exploratory Analsysis :-) <\/h2>"}}