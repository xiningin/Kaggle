{"cell_type":{"f1f64417":"code","bac718f4":"code","27c88010":"code","011954e3":"code","d5841bd9":"code","8a1e8626":"code","4c76b4b5":"code","61222346":"code","fa6f8248":"code","b5784666":"code","979cf48b":"code","ab2a6b20":"code","b5a25dcf":"code","ef80f0fb":"markdown","d134a174":"markdown","3ea9d578":"markdown","93266961":"markdown","939d097f":"markdown"},"source":{"f1f64417":"import matplotlib.pyplot as plt\nimport pandas as pd\nimport numpy as np\nimport seaborn as sns\n\n%matplotlib inline","bac718f4":"data= pd.read_csv(\"..\/input\/mushroom-classification\/mushrooms.csv\")","27c88010":"data.shape","011954e3":"data.dtypes","d5841bd9":"data.head()","8a1e8626":"data.columns","4c76b4b5":"#Number of unique values\n########################################\n#tab=[]\n#for i in range(0,8124):\n#    tab.append(i)\n    \n\n\n#data=data.assign(Random=tab)\n########################################\n\ncols=data.columns\n\nfor col in cols:\n    print(col,' : ',data[col].unique())","61222346":"# Get dummies\ndata = pd.get_dummies(data, prefix_sep='_', drop_first=True)\n# X head\ndata.head()","fa6f8248":"data.columns","b5784666":"sns.set(rc={'figure.figsize':(30,20)})\n\ncorrelation_matrix= np.corrcoef(data[data.columns].values.T)\n\nhm= sns.heatmap(data=correlation_matrix, square=True, annot=True, fmt='.2f')","979cf48b":"from sklearn.model_selection import train_test_split\n#features pour \u00e9valuer\nX=data[['cap-shape_c', 'cap-shape_f', 'cap-shape_k', 'cap-shape_s',\n       'cap-shape_x', 'cap-surface_g', 'cap-surface_s', 'cap-surface_y',\n       'cap-color_c', 'cap-color_e', 'cap-color_g', 'cap-color_n',\n       'cap-color_p', 'cap-color_r', 'cap-color_u', 'cap-color_w',\n       'cap-color_y', 'bruises_t', 'odor_c', 'odor_f', 'odor_l', 'odor_m',\n       'odor_n', 'odor_p', 'odor_s', 'odor_y', 'gill-attachment_f',\n       'gill-spacing_w', 'gill-size_n', 'gill-color_e', 'gill-color_g',\n       'gill-color_h', 'gill-color_k', 'gill-color_n', 'gill-color_o',\n       'gill-color_p', 'gill-color_r', 'gill-color_u', 'gill-color_w',\n       'gill-color_y', 'stalk-shape_t', 'stalk-root_b', 'stalk-root_c',\n       'stalk-root_e', 'stalk-root_r', 'stalk-surface-above-ring_k',\n       'stalk-surface-above-ring_s', 'stalk-surface-above-ring_y',\n       'stalk-surface-below-ring_k', 'stalk-surface-below-ring_s',\n       'stalk-surface-below-ring_y', 'stalk-color-above-ring_c',\n       'stalk-color-above-ring_e', 'stalk-color-above-ring_g',\n       'stalk-color-above-ring_n', 'stalk-color-above-ring_o',\n       'stalk-color-above-ring_p', 'stalk-color-above-ring_w',\n       'stalk-color-above-ring_y', 'stalk-color-below-ring_c',\n       'stalk-color-below-ring_e', 'stalk-color-below-ring_g',\n       'stalk-color-below-ring_n', 'stalk-color-below-ring_o',\n       'stalk-color-below-ring_p', 'stalk-color-below-ring_w',\n       'stalk-color-below-ring_y', 'veil-color_o', 'veil-color_w',\n       'veil-color_y', 'ring-number_o', 'ring-number_t', 'ring-type_f',\n       'ring-type_l', 'ring-type_n', 'ring-type_p', 'spore-print-color_h',\n       'spore-print-color_k', 'spore-print-color_n', 'spore-print-color_o',\n       'spore-print-color_r', 'spore-print-color_u', 'spore-print-color_w',\n       'spore-print-color_y', 'population_c', 'population_n', 'population_s',\n       'population_v', 'population_y', 'habitat_g', 'habitat_l', 'habitat_m',\n       'habitat_p', 'habitat_u', 'habitat_w']]\n#Attribut \u00e0 pr\u00e9dire\ny=data['class_p']\n\n \n\nxtrain, xtest, ytrain, ytest = train_test_split(X,y, test_size=0.2, random_state=0)","ab2a6b20":"from sklearn.linear_model import LogisticRegression\n\nlogit=LogisticRegression()\nlogit.fit(xtrain,ytrain)\n\n#ERROR\nerror = (1 - logit.score(xtest, ytest))*100\nprint('Erreur: %f' % error, '%')","b5a25dcf":"print('Affichons les champignons o\u00f9 l\\'on a fait une erreur.')\ny_pred = logit.predict(xtest)\ndf = pd.DataFrame({'Actual': ytest, 'Predicted': y_pred})  \ndf.loc[df['Predicted'] != df['Actual']]","ef80f0fb":"Comment faire une bonne omelette aux champignons sans risque ?\n-------","d134a174":"Notre taux de sucess est de 100% !","3ea9d578":"Il est difficile de voir une correleation car le nombre de parametres est trop grand, passons \u00e0 la regression","93266961":"**Nous n'avons aucune erreur ! Ouf pas d'empoisonnement..**","939d097f":"------------------------------------------------------------\nScript de: Matthieu 64\n-----"}}