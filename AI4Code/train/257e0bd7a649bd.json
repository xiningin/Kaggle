{"cell_type":{"61e26bfc":"code","9783c985":"code","373c5133":"code","6c22c557":"code","70e4702d":"code","942f804e":"code","8b2165bc":"code","b1ec94fd":"code","a477074f":"code","28330d90":"code","865df15a":"code","e6726da8":"code","221a0715":"code","1f71421e":"code","d7b2d012":"code","29c4306b":"code","7100cb60":"code","64119172":"code","33da5b54":"code","f5e719df":"code","2132e481":"code","90b3fe1c":"code","0467e77a":"code","421c2e9a":"code","f4c2e7d3":"code","e8b2e94d":"code","c9737d37":"code","b88ab9d3":"code","9ca839b9":"code","431dc475":"code","c66e46af":"markdown","8e7d8ced":"markdown","8ce1912e":"markdown","96695e62":"markdown","4323ac66":"markdown"},"source":{"61e26bfc":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport pandas_profiling\nimport seaborn as sns\nimport warnings\nwarnings.filterwarnings('ignore')","9783c985":"pd.set_option('display.max_columns', None)\npd.set_option('display.max_rows', None)","373c5133":"df1 = pd.read_csv('..\/input\/spam-or-ham\/spam.csv')\ndf1.head()","6c22c557":"df1 = df1.drop([\"Unnamed: 2\", \"Unnamed: 3\", \"Unnamed: 4\"], axis=1)\ndf1 = df1.rename(columns={\"v1\":\"Flag\", \"v2\":\"SMS_Original\"})\ndf1.head()","70e4702d":"df1.columns","942f804e":"df1.rename(columns={'SMS_Original':'SMS'}, inplace=True)\ndf1.head()","8b2165bc":"!pip install pycaret\n","b1ec94fd":"from nltk.corpus import stopwords","a477074f":"stop_words = stopwords.words('english')","28330d90":"from pycaret.nlp import *","865df15a":"%time su_1 = setup(data = df1, target = 'SMS', custom_stopwords=stop_words, session_id=42)","e6726da8":"%time m1 = create_model(model='lda', multi_core=True)","221a0715":"%time lda_data = assign_model(m1)","1f71421e":"lda_data.head()","d7b2d012":"evaluate_model(m1)","29c4306b":"%time m2 = create_model(model='nmf')","7100cb60":"%time nmf_data = assign_model(m2)","64119172":"nmf_data.drop(['SMS', 'Dominant_Topic'], axis=1, inplace = True)\nnmf_data.head()","33da5b54":"nmf_data.columns","f5e719df":"from pycaret.classification import *","2132e481":"%time pce_1 = setup(data = lda_data, target = 'Flag', session_id = 5)","90b3fe1c":"%time compare_models()","0467e77a":"#step1 : model creation\npce_1_m1 = create_model('rf')","421c2e9a":"#step2 : model tuning\ntuned_pce_1_m1 = tune_model(pce_1_m1)","f4c2e7d3":"#step3 : getting insights from model performance\nevaluate_model(tuned_pce_1_m1)","e8b2e94d":"pce_2 = setup(data = nmf_data, target = 'Flag', session_id = 42)","c9737d37":"compare_models()","b88ab9d3":"#step1 : model creation\npce_2_m1 = create_model('rf')","9ca839b9":"#step2 : model tuning\ntuned_pce_2_m1 = tune_model(pce_2_m1, optimize='AUC')","431dc475":"#step3 : getting insights from model performance\nevaluate_model(tuned_pce_2_m1)","c66e46af":"Repeating the above process of model building and tuning for the NMF embedded data","8e7d8ced":"# Model Building","8ce1912e":"# Data setup","96695e62":"Embedding on the processed text data","4323ac66":"# Hyper-parameters tuning"}}