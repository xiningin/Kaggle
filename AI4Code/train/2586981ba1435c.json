{"cell_type":{"dfe2c09c":"code","97962916":"code","6795a3d4":"code","0965d7eb":"code","1408a8cc":"markdown","b0f22cca":"markdown","4f2be1d5":"markdown","578b54c8":"markdown"},"source":{"dfe2c09c":"import numpy as np\nimport matplotlib.pyplot as plt\nimport pandas as pd\nimport random","97962916":"dataset = pd.read_csv('..\/input\/ads-ctr-optimisation\/Ads_CTR_Optimisation.csv')","6795a3d4":"N = 10000\nd = 10\nads_selected = []\nnumbers_of_rewards_1 = [0] * d\nnumbers_of_rewards_0 = [0] * d\ntotal_reward = 0\nfor n in range(0, N):\n    ad = 0\n    max_random = 0\n    for i in range(0, d):\n        random_beta = random.betavariate(numbers_of_rewards_1[i] + 1, numbers_of_rewards_0[i] + 1)\n        if random_beta > max_random:\n            max_random = random_beta\n            ad = i\n    ads_selected.append(ad)\n    reward = dataset.values[n, ad]\n    if reward == 1:\n        numbers_of_rewards_1[ad] = numbers_of_rewards_1[ad] + 1\n    else:\n        numbers_of_rewards_0[ad] = numbers_of_rewards_0[ad] + 1\n    total_reward = total_reward + reward\n","0965d7eb":"plt.hist(ads_selected)\nplt.title('Histogram of ads selections')\nplt.xlabel('Ads')\nplt.ylabel('Number of times each ad was selected')\nplt.show()","1408a8cc":"# **Importing the libraries**","b0f22cca":"# **Visualising the results - Histogram**","4f2be1d5":"# **Importing the dataset**","578b54c8":"# **Implementing Thompson Sampling**"}}