{"cell_type":{"8ca80f99":"code","03fb55ec":"code","0dcc6b89":"code","9a03a767":"code","751192c0":"code","41991271":"code","b814d173":"code","7de1b80b":"code","f30ec135":"code","5a65b960":"code","e2f66356":"code","b1651797":"code","ac33c311":"markdown","6e81fbec":"markdown","f396dcf4":"markdown"},"source":{"8ca80f99":"#o pacote h2o n\u00e3o est\u00e1 nativamente instalado no kaggle, precisa instalar o pacote \n!pip install h2o","03fb55ec":"# Importando as bibliotecas\nimport pandas as pd\nimport h2o\nfrom h2o.automl import H2OAutoML","0dcc6b89":"# Inicializando o cluster\nh2o.init()\nh2o.cluster().show_status()","9a03a767":"# Importando os datasets   \ntrain = h2o.import_file('\/kaggle\/input\/dsa-automl-and-fe\/train_fe.csv')\ntest = h2o.import_file('\/kaggle\/input\/dsa-automl-and-fe\/test_fe.csv')","751192c0":"# Convertendo a coluna target em fator\ntrain['target'] = train['target'].asfactor()","41991271":"train.head()","b814d173":"# Indicando as colunas preditoras e a target\nx = train.columns\nx.remove('ID')\nx.remove('v22')\ny = 'target'\n\n# Converter o target em fator\ntrain[y] = train[y].asfactor()","7de1b80b":"%%time\naml = H2OAutoML(max_models=20, \n                seed=2020, \n                nfolds=20, \n                #max_runtime_secs_per_model=600,\n                #max_runtime_secs=60000,\n                balance_classes=True,\n                sort_metric='logloss', \n                exclude_algos=['DeepLearning'], \n                verbosity='info')\naml.train(x=x, y=y, training_frame=train)\nlb = aml.leaderboard\nlb.head(rows=lb.nrows)","f30ec135":"#Melhor Modelo do AutoML\naml.leader","5a65b960":"# Gerar as previsoes no dataset de teste\npreds = aml.leader.predict(test)\n\n# Salvar o resultado no dataset de teste\nresult = preds[:,2]\ntest['PredictedProb'] = result","e2f66356":"test.head()","b1651797":"# Gravar o arquivo de submiss\u00e3o ao Kaggle\nh2o.export_file(test[['ID', 'PredictedProb']],'submission.csv')","ac33c311":"### Competi\u00e7\u00e3o DSA de Machine Learning - Dezembro 2019\n#### Previs\u00e3o de Indediza\u00e7\u00e3o aos Segurados pela Seguradora\n#### AutoML(H2O)","6e81fbec":"### Executando o H2OAutoML","f396dcf4":"# Submissions"}}