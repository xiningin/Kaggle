{"cell_type":{"4d767329":"code","dc9e2b8d":"code","b933e2c8":"code","18a70e31":"code","143bc288":"code","44df23df":"code","58bd33f3":"code","68ddef10":"code","7b612fd3":"code","621782ff":"code","4c8d2bcc":"code","43143f00":"code","5dc5e540":"code","e5cd7cd4":"code","1065cbff":"markdown","e5a8a09a":"markdown","b6c2bce2":"markdown","dc071cfd":"markdown","152f12e7":"markdown","5b6904e1":"markdown","33379119":"markdown","3f524cf9":"markdown","4569a199":"markdown","fca5770c":"markdown"},"source":{"4d767329":"import numpy as np\nimport pandas as pd\nimport re\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set_style(\"darkgrid\")\n\nfrom sklearn.linear_model import LinearRegression\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","dc9e2b8d":"ad = pd.read_excel(\"\/kaggle\/input\/carprice-assignment\/CarPrice_Assignment.xlsx\", usecols = [2,13,18,22])\ndf = ad.copy()","b933e2c8":"for col in df.columns[0:1]:\n    df[col]=df[col].str.lower()\n\ndf = df.replace(['vw dasher'],\"volkswagen dasher\")\ndf = df.replace(['vw rabbit'],\"volkswagen rabbit\")\n\ncar_name = []\ncar_brand = []\n\nfor i in df[\"CarName\"]:\n    if i.split()[0] == \"maxda\":\n        i = i.replace(\"maxda\",\"mazda\")\n    if i.split()[0] == \"porcshce\":\n        i = i.replace(\"porcshce\",\"porsche\")\n    if i.split()[0] ==(\"vokswagen\"):\n        i = i.replace(\"vokswagen\",\"volkswagen\")\n    if i.split()[0] ==(\"toyouta\"):\n        i = i.replace(\"toyouta\",\"toyota\")\n    car_brand.append(i.split()[0])\n    car_name.append(i.split(None ,1)[1:])\n    \ndic = {'car_brand': car_brand, 'car_name': car_name, 'horsepower': df[\"horsepower\"], 'engine_size': df[\"enginesize\"], 'price': df[\"price\"]}\ndf = pd.DataFrame(dic)\ndf[\"car_name\"] = df[\"car_name\"].astype(str)\ndf.loc[df.car_name.notna().index,'car_name'] = df.car_name[df.car_name.notna()].apply(lambda x: re.sub('[\\W_]+','',x))\ndf.head(10)","18a70e31":"df.describe().T","143bc288":"df.isnull().values.any()","44df23df":"f,ax=plt.subplots(figsize = (6,6))\n# corr() is actually pearson correlation\nsns.heatmap(df.corr(),annot= True,fmt = \".2f\",ax=ax, cmap = \"Reds\", cbar = False)\nplt.xticks(rotation=0)\nplt.yticks(rotation=0)\nplt.title('Correlation Map')\nplt.show()","58bd33f3":"brand_price = round(df.groupby(\"car_brand\")[\"price\"].mean())\nbrand_price.plot.barh(figsize=(10,8)).set_title(\"Average Prices by Car Brands\", size=14)\nplt.xticks(size = 10)\nplt.yticks(size = 12)\nplt.ylabel(\"\")\nplt.xlabel(\"Price\");","68ddef10":"fig, (ax1,ax2) = plt.subplots(1,2,figsize=(14,6))\n\nax1.scatter(df[\"engine_size\"], df[\"price\"])\nax1.set_title('Engine Size - Price', size = 14)\nax1.set(xlabel='enginesize', ylabel='Price')\n\nax2.scatter(df[\"horsepower\"], df[\"price\"])\nax2.set_title('Horsepower - Price', size = 14)\nax2.set(xlabel='Horsepower', ylabel='Price')\nfig.tight_layout()","7b612fd3":"x = df.iloc[:,[2,3]].values\ny = df.price.values.reshape((-1,1))","621782ff":"multiple_linear_regression = LinearRegression()\n\nmultiple_linear_regression.fit(x,y)\n\nprint(\" b0 (intercept): {} \\n b1,b2 (coef.): {},{}\".format(multiple_linear_regression.intercept_[0] , multiple_linear_regression.coef_[0][0], multiple_linear_regression.coef_[0][1]))","4c8d2bcc":"print(\"price = \" + str(\"%.2f\" % multiple_linear_regression.intercept_) + \" + engine_size * \"\n      + str(\"%.2f\" % (multiple_linear_regression.coef_)[0,0]) + \" + horsepower * \" \n      + str(\"%.2f\" % (multiple_linear_regression.coef_)[0,1]) )","43143f00":"print(\"R-Squared Score: \" + str(multiple_linear_regression.score(x,y)))","5dc5e540":"print(\"Price: $\" + str(\"%.0f\" % (-8389.73 + (120 * 122.45) + (100 * 58.85))))","e5cd7cd4":"multiple_linear_regression.predict(np.array([[140,130],[90,70]]))","1065cbff":"## Data Preprocessing","e5a8a09a":"## Prediction\n\nIf we ask the price of a car with an engine size is 120 and horsepower is 100, we can calculate it manually as follows.","b6c2bce2":"We can also find the prices car with an engine sizes are 140 and 90 and horsepowers are 130 and 70.","dc071cfd":"## Visualization","152f12e7":"## R-Squared Score","5b6904e1":"## Loading Data","33379119":"## Model Equation","3f524cf9":"# Car Price Prediction (Multiple Linear Regression)\n\n<img src=\"https:\/\/media.giphy.com\/media\/6swcfDQHr3UTm\/source.gif\">\n\nLinear regression is a linear approach to modelling the relationship between a scalar response and one or more explanatory variables (also known as dependent and independent variables). The case of one explanatory variable is called simple linear regression; for more than one, the process is called multiple linear regression. This term is distinct from multivariate linear regression, where multiple correlated dependent variables are predicted, rather than a single scalar variable.","4569a199":"## Multiple Linear Regression Model\n\n- y = b0 + b1*x1 + b2*x2\n- Price is dependent variable. (y)\n- Enginesize and horsepower are indepedent variables. (x1, x2)","fca5770c":"## Libraries and Utilities"}}