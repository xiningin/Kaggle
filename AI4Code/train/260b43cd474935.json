{"cell_type":{"88ba2630":"code","138f07b1":"code","521ba2aa":"code","6102ef42":"code","979431b9":"code","c7e04122":"code","e557a41f":"code","02e862ef":"code","7b115657":"code","5320f946":"code","53d154b1":"code","7a6c9edb":"code","397a736e":"code","3b93e8e0":"code","168bcf63":"code","403223af":"code","566f3652":"code","493246ae":"code","e1574402":"code","6382bbd4":"code","053e49d5":"markdown","f195cd03":"markdown","48fa112e":"markdown","e8e22883":"markdown","688e94a2":"markdown","c01fb725":"markdown","5f9ed2aa":"markdown"},"source":{"88ba2630":"import pandas as pd\nimport numpy as np\n\ndata = pd.read_csv('..\/input\/movies\/movies.csv', encoding='latin1')\npd.set_option('display.max_columns', None) \ndata.head()","138f07b1":"data.median() # \u043c\u0435\u0434\u0438\u0430\u043d\u0430","521ba2aa":"data.mode(dropna = False) # \u043c\u043e\u0434\u0430","6102ef42":"data.name.value_counts().head() # \u0432 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u043f\u043e\u044f\u0441\u043d\u0435\u043d\u0438\u044f \u043a \u0432\u044b\u0432\u043e\u0434\u0443 \u043c\u043e\u0434\u044b \u0432\u044b\u0448\u0435:\n# \u0447\u0430\u0441\u0442\u043e\u0432\u0441\u0442\u0440\u0435\u0447\u0430\u0435\u043c\u044b\u0445 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0439 \u0444\u0438\u043b\u044c\u043c\u043e\u0432 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e","979431b9":"data.gross.value_counts().head() # \u0432 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u043f\u043e\u044f\u0441\u043d\u0435\u043d\u0438\u044f \u043a \u0432\u044b\u0432\u043e\u0434\u0443 \u043c\u043e\u0434\u044b \u0432\u044b\u0448\u0435","c7e04122":"data.votes.value_counts().head() # \u0432 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u043f\u043e\u044f\u0441\u043d\u0435\u043d\u0438\u044f \u043a \u0432\u044b\u0432\u043e\u0434\u0443 \u043c\u043e\u0434\u044b \u0432\u044b\u0448\u0435","e557a41f":"data.mean() # \u0441\u0440\u0435\u0434\u043d\u0435\u0435","02e862ef":"data.min() # \u043c\u0438\u043d\u0438\u043c\u0443\u043c","7b115657":"data.max() # \u043c\u0430\u043a\u0441\u0438\u043c\u0443\u043c","5320f946":"# data.loc[:, ['budget', 'gross', 'runtime', 'score', 'votes', 'year']]\ndata['max-min row diff'] = np.ptp(data.loc[:, ['budget', 'gross', # \u0440\u0430\u0437\u043d\u0438\u0446\u0430 \u043c\u0435\u0436\u0434\u0443 \u043c\u0430\u043a\u0441\u0438\u043c\u0443\u043c\u043e\u043c \u0438 \u043c\u0438\u043d\u0438\u043c\u0443\u043c\u043e\u043c \u043f\u043e \u0441\u0442\u0440\u043e\u043a\u0430\u043c\n                                               'runtime', 'score', 'votes', 'year']].values, axis = 1)\n\ndata['max budget diff'] = data.budget.max() - data.budget # \u0440\u0430\u0437\u043d\u0438\u0446\u0430 \u043c\u0435\u0436\u0434\u0443 \u043c\u0430\u043a\u0441\u0438\u043c\u0443\u043c\u043e\u043c \u0431\u044e\u0434\u0436\u0435\u0442\u0430 \u0438 \u0442\u0435\u043a\u0443\u0449\u0438\u043c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435\u043c \u0431\u044e\u0434\u0436\u0435\u0442\u0430\n\ndata['min budget diff'] = data.budget - data.budget.min() # \u0440\u0430\u0437\u043d\u0438\u0446\u0430 \u043c\u0435\u0436\u0434\u0443 \u0442\u0435\u043a\u0443\u0449\u0438\u043c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435\u043c \u0431\u044e\u0434\u0436\u0435\u0442\u0430 \u0438 \u0435\u0433\u043e \u043c\u0438\u043d\u0438\u043c\u0443\u043c\u043e\u043c\n\ndata['diff min max diff'] = data['max budget diff'] - data['min budget diff'] # \u0440\u0430\u0437\u043d\u0438\u0446\u0430 \u043c\u0435\u0436\u0434\u0443 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f\u043c\u0438 \u0434\u0432\u0443\u0445 \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0438\u0445 \u043a\u043e\u043b\u043e\u043d\u043e\u043a\n\ndata.head()","53d154b1":"company1, company2, company3, company4 = data[data.company # \u0440\u0430\u0437\u0431\u0438\u0435\u043d\u0438\u0435 \u043f\u043e \u043a\u0440\u0443\u043f\u043d\u0435\u0439\u0448\u0438\u043c \u043a\u0438\u043d\u043e\u043a\u043e\u043c\u043f\u0430\u043d\u0438\u044f\u043c\n                          == 'Universal Pictures'], data[data.company \n                                                         == 'Warner Bros.'], data[data.company \n                                                                                  == 'Paramount Pictures'], data[data.company \n                                                                                                                 == 'Twentieth Century Fox Film Corporation']\ncompany1.head()","7a6c9edb":"pie_chart_data = pd.Series([len(company1), len(company2), \n                            len(company3), len(company4)],\n                           index = ['Universal Pictures', 'Warner Bros.', \n                                    'Paramount Pictures', 'Twentieth Century Fox Film Corporation'],\n                           name = 'Top 4 film companies')\n\npie_chart_data","397a736e":"pie_chart_data.plot.pie(figsize=(16, 6))","3b93e8e0":"import matplotlib as plt\ncompany1.hist(column = 'year', alpha=0.5) # \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u0444\u0438\u043b\u044c\u043c\u043e\u0432 Universal Pictures \u043f\u043e \u0433\u043e\u0434\u0430\u043c\ncompany2.plot(x = 'year', y = 'score', style = 'k--') # \u0434\u0438\u043d\u0430\u043c\u0438\u043a\u0430 \u043e\u0446\u0435\u043d\u043e\u043a \u0444\u0438\u043b\u044c\u043c\u043e\u0432 Warner Bros. \u043f\u043e \u0433\u043e\u0434\u0430\u043c","168bcf63":"company3['genre'].value_counts().plot.bar() # \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u0444\u0438\u043b\u044c\u043c\u043e\u0432 Paramount Pictures \u043f\u043e \u0436\u0430\u043d\u0440\u0430\u043c\ncompany4.plot.scatter(x = 'year', y = 'budget') # \u0434\u0438\u0430\u0433\u0440\u0430\u043c\u043c\u0430 \u0440\u0430\u0441\u0441\u0435\u044f\u043d\u0438\u044f \u0433\u043e\u0434-\u0431\u044e\u0434\u0436\u0435\u0442 \u0434\u043b\u044f 'Twentieth Century Fox Film Corporation'","403223af":"dfs = {key: data for key, data in data.groupby('genre')}\ndfs.keys()\naction, musical, crime, family = dfs['Action'], dfs['Musical'], dfs['Crime'], dfs['Family']","566f3652":"action.sort_values(by = ['gross', 'budget'], ascending=False) # \u043e\u0442\u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u044d\u043a\u0448\u043d-\u0444\u0438\u043b\u044c\u043c\u044b \u043f\u043e \u0443\u0431\u044b\u0432\u0430\u043d\u0438\u044e, \n                                                              # \u043f\u0440\u0438\u0437\u043d\u0430\u043a\u0438: \u0434\u043e\u0445\u043e\u0434 \u043e\u0442 \u0444\u0438\u043b\u044c\u043c\u0430 \u0438 \u0431\u044e\u0434\u0436\u0435\u0442","493246ae":"musical.sort_values(by = ['score', 'votes'], ascending = False) # \u043e\u0442\u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043c\u044e\u0437\u0438\u043a\u043b\u044b \u043f\u043e \u0443\u0431\u044b\u0432\u0430\u043d\u0438\u044e \n                                                                # \u043f\u043e \u043f\u0440\u0438\u0437\u043d\u0430\u043a\u0430\u043c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u043e\u0433\u043e \u0440\u0435\u0439\u0442\u0438\u043d\u0433\u0430\n                                                                # \u0438 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u0443 \u043f\u0440\u043e\u0433\u043e\u043b\u043e\u0441\u043e\u0432\u0430\u0432\u0448\u0438\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439","e1574402":"crime.sort_values(by = ['score', 'gross'], ascending = False) # \u043e\u0442\u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \"\u043a\u0440\u0438\u043c\u0438\u043d\u0430\u043b\" \u043f\u043e \u0443\u0431\u044b\u0432\u0430\u043d\u0438\u044e \n                                                              # \u043f\u043e \u043f\u0440\u0438\u0437\u043d\u0430\u043a\u0430\u043c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u043e\u0433\u043e \u0440\u0435\u0439\u0442\u0438\u043d\u0433\u0430\n                                                              # \u0438 \u0432\u044b\u0440\u0443\u0447\u043a\u0438 \u043e\u0442 \u0444\u0438\u043b\u044c\u043c\u0430","6382bbd4":"family[(family.rating == 'G') | (family.rating == 'PG')].sort_values(by = ['rating', 'score'], ascending = [True, False]) \n# \u043e\u0442\u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u0435\u043c\u0435\u0439\u043d\u044b\u0435 \u0444\u0438\u043b\u044c\u043c\u044b \u043f\u043e \u0432\u043e\u0437\u0440\u0430\u0441\u0442\u0430\u043d\u0438\u044e \u043f\u043e \u043f\u0440\u0438\u0437\u043d\u0430\u043a\u0443 \u0440\u0435\u0439\u0442\u0438\u043d\u0433\u0430 \u0438 \u043f\u043e \u0443\u0431\u044b\u0432\u0430\u043d\u0438\u044e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u043e\u0433\u043e \u0440\u0435\u0439\u0442\u0438\u043d\u0433\u0430","053e49d5":"\u041f\u0440\u0438\u0432\u0435\u0441\u0442\u0438 \u043a\u0440\u0443\u0433\u043e\u0432\u0443\u044e \u0434\u0438\u0430\u0433\u0440\u0430\u043c\u043c\u0443 \u0434\u043b\u044f \u043f\u0440\u043e\u0434\u0435\u043b\u0430\u043d\u043d\u043e\u0433\u043e \u0440\u0430\u0437\u0431\u0438\u0435\u043d\u0438\u044f","f195cd03":"\u0420\u0430\u0437\u0431\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u043d\u0430 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0431\u043b\u043e\u043a\u043e\u0432 (\u043d\u0435 \u043c\u0435\u043d\u0435\u0435 3, \u043f\u0440\u0438\u0431\u043b\u0438\u0437\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0440\u0430\u0432\u043d\u044b\u0445\n\u043f\u043e \u0440\u0430\u0437\u043c\u0435\u0440\u0443) \u043f\u043e \u043d\u0435\u043a\u043e\u0442\u043e\u0440\u043e\u043c\u0443 \u043a\u0440\u0438\u0442\u0435\u0440\u0438\u044e (\u043a\u0440\u0438\u0442\u0435\u0440\u0438\u0439 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0438\u0442\u044c\n\u0441\u0430\u043c\u043e\u0441\u0442\u043e\u044f\u0442\u0435\u043b\u044c\u043d\u043e).","48fa112e":"\u041f\u043e\u0441\u0447\u0438\u0442\u0430\u0442\u044c \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u043f\u043e\u043a\u0430\u0437\u0430\u0442\u0435\u043b\u0438:\n- \u043c\u0435\u0434\u0438\u0430\u043d\u0430,\n- \u043c\u043e\u0434\u0430,\n- \u0441\u0440\u0435\u0434\u043d\u044f\u044f,\n- \u043c\u0438\u043d\u0438\u043c\u0443\u043c,\n- \u043c\u0430\u043a\u0441\u0438\u043c\u0443\u043c.","e8e22883":"\u0412 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0438 \u043e\u0442 \u043e\u0441\u043e\u0431\u0435\u043d\u043d\u043e\u0441\u0442\u0435\u0439 \u043d\u0430\u0431\u043e\u0440\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u0431\u043b\u043e\u043a\u0430\n\u043f\u043e\u0441\u0442\u0440\u043e\u0438\u0442\u044c \u0433\u0440\u0430\u0444\u0438\u043a (\u0433\u0438\u0441\u0442\u043e\u0433\u0440\u0430\u043c\u043c\u0443, ...).","688e94a2":"\u0421\u0433\u0440\u0443\u043f\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 (GroupBy) \u043f\u043e \u043d\u0435\u043a\u043e\u0442\u043e\u0440\u043e\u043c\u0443 \u043f\u0440\u0438\u0437\u043d\u0430\u043a\u0443 \u0438 \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c\n\u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u0432 \u043d\u043e\u0432\u044b\u0435 \u0442\u0430\u0431\u043b\u0438\u0446\u044b. \u0414\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0439 \u043d\u043e\u0432\u043e\u0439 \u0442\u0430\u0431\u043b\u0438\u0446\u044b \u043f\u0440\u043e\u0432\u0435\u0441\u0442\u0438\n\u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0443 \u043f\u043e \u0441\u043b\u043e\u0436\u043d\u043e\u043c\u0443 \u043a\u043b\u044e\u0447\u0443, \u0441\u043e\u0441\u0442\u043e\u044f\u0449\u0435\u043c\u0443 \u0438\u0437 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u0445 \u043f\u0440\u0438\u0437\u043d\u0430\u043a\u043e\u0432.\n\u0414\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0439 \u0442\u0430\u0431\u043b\u0438\u0446\u044b \u0441\u0432\u043e\u044f \u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0430.","c01fb725":"\u041d\u0430\u0439\u0442\u0438 \u0433\u043e\u0442\u043e\u0432\u044b\u0439 \u0444\u0430\u0439\u043b \u0441 \u0434\u0430\u043d\u043d\u044b\u043c\u0438 (\u043d\u0435 \u043c\u0435\u043d\u0435\u0435 1000 \u0441\u0442\u0440\u043e\u043a, \u043c\u0438\u043d\u0438\u043c\u0443\u043c 3 \u043f\u043e\u043b\u044f \u2014\n\u0447\u0438\u0441\u043b\u043e\u0432\u044b\u0435, \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u0443\u0441\u043b\u043e\u0432\u0438\u0435 \u0434\u043b\u044f \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u043e\u0432 \u2116 1, 4, 7, 12, 16:\n\u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u043f\u043e\u043b\u0435 \u0441 \u0434\u0430\u0442\u043e\u0439).","5f9ed2aa":"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043d\u043e\u0432\u044b\u0439 \u0441\u0442\u043e\u043b\u0431\u0435\u0446, \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u043c \u0440\u0430\u0437\u043c\u0435\u0441\u0442\u0438\u0442\u044c \u0440\u0430\u0437\u043d\u0438\u0446\u0443 \u043c\u0435\u0436\u0434\u0443\n\u043c\u0430\u043a\u0441\u0438\u043c\u0443\u043c\u043e\u043c \u0438 \u043c\u0438\u043d\u0438\u043c\u0443\u043c\u043e\u043c."}}