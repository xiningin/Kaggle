{"cell_type":{"be92350c":"code","a15199b6":"code","f0482a7c":"code","df49302f":"code","d64279f5":"code","ac61df7f":"code","84740a0e":"code","a94721d8":"code","75c42595":"code","1078f9f0":"code","8c835191":"code","16c1bbba":"code","9b23aedd":"code","d68e1b8a":"code","6cf9b66b":"code","041c3270":"code","3ac1aad4":"code","5ec1ef3f":"code","2c650afa":"code","defc7627":"code","1c33c33d":"code","1d5b84eb":"code","3fcba3eb":"code","6160735d":"code","dbac6451":"markdown"},"source":{"be92350c":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.preprocessing import RobustScaler,StandardScaler\nfrom sklearn.metrics import confusion_matrix,classification_report\nfrom sklearn.model_selection import train_test_split\nfrom sklearn import svm","a15199b6":"data=pd.read_csv(\"..\/input\/heart-disease-uci\/heart.csv\")","f0482a7c":"data.info()","df49302f":"data.head()","d64279f5":"data.isnull().any()","ac61df7f":"data['target'].value_counts()","84740a0e":"data.corr()","a94721d8":"Y_train=data['target']\nX_train=data.drop('target',axis=1)","75c42595":"data.corr()","1078f9f0":"arr=np.array(data.columns)\narr[:-1]","8c835191":"X_train, X_test, y_train, y_test = train_test_split(X_train, Y_train, test_size=0.20)","16c1bbba":"rs = StandardScaler()\ntrain_rs=rs.fit_transform(X_train)\nprint(train_rs.shape)\nX_train=pd.DataFrame(train_rs,columns=X_train.columns)\nprint(X_train.shape)","9b23aedd":"test_rs = rs.transform(X_test)\nprint(test_rs.shape)\nX_test=pd.DataFrame(test_rs,columns=X_test.columns)\nprint(X_test.shape)","d68e1b8a":"clf = svm.SVC()\nclf.fit(X_train, y_train)\ny_pred=clf.predict(X_test)\nconfusion_matrix(y_pred,y_test)\nprint(classification_report(y_pred,y_test))","6cf9b66b":"from skopt import BayesSearchCV\nfrom skopt.space import Real,Integer","041c3270":"search_space = {\n    'gamma':Real(1e-4,0.1,'uniform'),\n    'C':Integer(1,100),\n    'kernel':['linear','poly', 'rbf', 'sigmoid'],\n    'degree':Integer(2,10)\n}","3ac1aad4":"def on_step(svc_obj):\n    print('Best score : ',model.best_score_)","5ec1ef3f":"from sklearn.metrics import f1_score,recall_score, precision_score","2c650afa":"model = BayesSearchCV(svm.SVC(),search_spaces=search_space,n_iter=32,n_points=8,cv=3,scoring=make_scorer(f1_score))\nmodel.fit(X_train,y_train,callback=on_step)","defc7627":"best_model = model.best_estimator_","1c33c33d":"best_model.get_params()","1d5b84eb":"y_pred=best_model.predict(X_test)","3fcba3eb":"print(classification_report(y_grid_pred,y_test))","6160735d":"print(confusion_matrix(y_grid_pred,y_test))","dbac6451":"## **BayesSearchCV**"}}