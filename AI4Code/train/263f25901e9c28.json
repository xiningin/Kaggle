{"cell_type":{"b7654109":"code","43ab416d":"code","2b70e32b":"code","1eea88d8":"code","f1527004":"code","ef511503":"code","fcc479f6":"code","f1265e66":"code","6490fbe1":"code","e75dc88a":"markdown","279dddd9":"markdown","16d9f44f":"markdown","2d34818d":"markdown","a59f6eb7":"markdown","de5c9427":"markdown","aab35d99":"markdown","d1837c6a":"markdown","88aced77":"markdown","cc23750f":"markdown","e8f445e8":"markdown","af040f3d":"markdown","0b2a8a52":"markdown","ba864a7a":"markdown","fb13d81a":"markdown","715f6542":"markdown","5449d782":"markdown"},"source":{"b7654109":"# Functions p and f can be defined as following:\n\nfrom sympy import Symbol\n\ntheta = Symbol('theta', positive=True)\nn = Symbol('n', integer=True, positive=True)\nS = Symbol('S', integer=True, positive=True)\nR = Symbol('R', positive=True)\n\np = 1-theta**n\n\nbatches = S\/n\ncontaminated_batches = batches * p\ncontaminated_sticks = contaminated_batches * n\n\nf = (1-R) * contaminated_sticks","43ab416d":"# An example plot of f with S=10000, R=0.307\n\nfrom sympy.plotting import plot3d\n\nf_0 = f.subs([(S, 10000), (R, 0.307)])\nplot3d(f_0, (theta, 0, 1), (n, 1, 50), size=(10, 8), \n       xlabel=\"Theta\", ylabel=\"n\")","2b70e32b":"# This part predefines a contour plot function, which will be used in some later parts\n\nimport numpy as np\nimport matplotlib.pyplot as plt\n\ndef displaycontour(S, R, \n                   xlim=(0.85, 1), ylim=(1, 15), \n                   contourlines=10, \n                   clocs=[(0.88, 10),(0.94, 6),(0.98, 2)]):\n    \n    Theta, N = np.meshgrid(np.linspace(0, 1, num=50), np.linspace(1, 50, num=100))\n    \n    F = S*(1-R)*(1-Theta**N)\n\n    _, axes = plt.subplots(1, 2, figsize=(15, 7))\n    cl = axes[0].contourf(Theta, N, F)\n    plt.colorbar(cl, ax=axes[0])\n\n    cr = axes[1].contour(Theta, N, F, contourlines)\n    \n    xleft, xright = xlim\n    yleft, yright = ylim\n    axes[1].set_xlim(xleft, xright)\n    axes[1].set_ylim(yleft, yright)\n    axes[1].clabel(cr, inline=True, manual=clocs)\n\n    plt.show()","1eea88d8":"## A community population who receives vaccine shots and its vaccine weight average ratios presented below:\n\nnAZ = 1940e3\nnPfizer = 290e3\nwgtAZ = nAZ\/(nAZ + nPfizer)\nwgtPfizer = nPfizer\/(nAZ + nPfizer)\n\nprint(\"Weighted Ratio of AZ: {}\".format(round(wgtAZ, 4)))\nprint(\"Weighted Ratio of Pfizer: {}\".format(round(wgtPfizer, 4)))","f1527004":"## R value for community with 1 dose\nRvac1 = 0.307 * wgtAZ + 0.307 * wgtPfizer;\ndisplaycontour(S=10000, R=Rvac1, contourlines=20, clocs=[(0.97,2.2), [0.95,4], [0.93,6], [0.99, 5]])\nprint(\"At community vaccinated with 1 dose, R value is {}\".format(round(Rvac1, 4)))","ef511503":"## R value for community with 2 doses\nRvac2 = 0.67 * wgtAZ + 0.937 * wgtPfizer\ndisplaycontour(S=10000, R=Rvac2, clocs=[(0.96, 2), (0.92, 3), (0.89, 3), (0.99, 10)])\nprint(\"At community vaccinated with 2 doses, R value is {}\".format(round(Rvac2, 4)))","fcc479f6":"## R value for community without vaccination. \n## The 0.05 value or %5 presents a hypothetical default resistance of a virus of any human population.\nRnull = 0.05\ndisplaycontour(S=10000, R=Rnull, contourlines=10, clocs=[(0.97,2),(0.95,4),(0.93,6)])","f1265e66":"from sympy.solvers import solve\nfrom sympy import Eq, Symbol\n\nC = Symbol('C', positive=True, integer=True)\n\nsols = solve(Eq(f, C), n)\nsols[0]","6490fbe1":"import numpy as np\n\ntheta_s = np.linspace(0.85, 1, 20)\nn_s = np.linspace(1, 20, 20)\n\n[Theta, N] = np.meshgrid(theta_s, n_s)\n\nS = 10000\nR = Rvac1\n\nF = S*(1-R)*(1-Theta**N)\n\nimport pandas as pd\npd.DataFrame(np.round(F.T), index=theta_s, columns=n_s)","e75dc88a":"# Introduction  \nCurrently, with the strong development of the COVID-19 epidemic,\ncommunity mass testing is a preventive solution used by policymakers.\nIn my opinion, such large-scale testing aims to identify potential spreaders and to notify these individuals early,\nso that they won't unknowingly transmit virus to others.  \n\nHowever, I do believe that no matter how careful a process is carried out, there is always a risk that the technician, who takes samples, can become a bridge, and accidentally bring fluid from one person to another(s). When such chance is high enough, the sampling process can transmit virus to more individuals than those it was aiming to protect.","279dddd9":"# Describing the Process From Observations\nFrom observation of several sampling processes, different communities can have different setup, and sampling techniques. For example:\n* At one place, the technician takes samples from multiple persons at a time, and holds both new and used testing sticks with the same hand. This is especially common when testing was done in a cumulative manner, at a crowded area. The new sampling sticks, which are hold together with the used ones, are used on the next persons.\n* A different procedure is that the technician takes sample one by one, and holds only one test stick for each person at a time. Used stick is then processed and put away before taking another sample (person).  \n* Alcohol hand sanitizer can be both used or not between turns. I suppose there many reasons for a sanitizer not to be used frequently. We can associate a cost to this sanitizing task and assume that this cost discourages the frequent use of a sanitizer. This sanitizing task is an example of a decontamination. I use the word **decontamination** in later parts to generalize this sanitizing task.","16d9f44f":"# Model Analysis in Scenarios","2d34818d":"At one dose vaccinated community, to keep cross infection below $4\\%$ or $\\frac{400}{100000}$, a sampling process must have $\\theta > 0.94$. A process with $\\theta \\sim 0.99$ can go on without decontamination for about $5$ samples.","a59f6eb7":"## Sampling Practice At Unvaccinated Community","de5c9427":"# Disclaimer\n\nThis notebook is my solo study.  \n\nI am NOT any health nor medical professional. I do NOT speak nor represent for any organization. However, I still think any quantitative analysis for this topic is useful or at least it can be a starting point of a more in-depth study.  \n\nAbout editing quality, I try to keep my writing at its best. However, whenever I look back, I always find some new mistakes. I think it'll take me forever to write a perfect article. So, my expectation for writing quality is that if the audiences can understand my messages, my writing is readable, no confusion, then I'm okay with it.\n","aab35d99":"In this scenario, I use $R=0.05$ to represent a hypothetical default immunity of human population against a virus. It is noticeable that taking samples at an unvaccinated community requires a much safer process and higher decontamination frequency.\n\nA process with $\\theta=0.90$ almost certainly requires a decontamination after each example just to keep cross-infection below $\\frac{1000}{10000}$ or $10\\%$.","d1837c6a":"# Selection of $n$","88aced77":"At two doses vaccinated community, we can see that sampling process is more relaxing. To keep cross infection below $3\\%$ or $\\frac{300}{10000}$, a sampling process needs to have $\\theta \\geq 0.90$. A process with $\\theta=0.99$ can go on without decontamination for about $9$ to $10$ samples.","cc23750f":"$n$ can also be selected from a referencing table as following:  \n\nSuppose a sampling process with $\\theta=0.976$ being carried out at a community with $R=Rvac1=0.3070$; then the sampling team must do decontamination every $3$ samples, in order to keep new patients from cross contamination below $\\frac{481}{10000}$ or $\\sim 4.8\\%$.","e8f445e8":"## Sampling Practice At Vaccinated Communities\n\nIn this section, I use an example community with population of $2230000$ persons, with $1940000$ persons vaccinated with AstraZeneca and $290000$ persons vaccinated with Pfizer. In addition, I use vaccine effectiveness figures against COVID-19 Delta variant from this article [[1]](https:\/\/www.nejm.org\/doi\/full\/10.1056\/NEJMoa2108891?fbclid=IwAR0XN_oeok1S6BBewccMQUBOsCl4I_Vg7pDKTDsAksa06jgs4kYqwWh_25Q), then R have values as following:\n* $R=0.3070$ for one dose vaccinated community (See $Rvac1$ calculation below)\n* $R=0.7047$ for two doses vaccinated community (See $Rvac2$ calculation below)\n\n[1] https:\/\/www.nejm.org\/doi\/full\/10.1056\/NEJMoa2108891?fbclid=IwAR0XN_oeok1S6BBewccMQUBOsCl4I_Vg7pDKTDsAksa06jgs4kYqwWh_25Q","af040f3d":"# How to Apply  \nSteps To Apply:\n1. Define a $\\%$ limit of new infections from the sampling process\n2. Identify the sampling parameter $\\theta$ of the process\n3. Estimate the $R$ value of the sampling community\n4. Calculate the $n$ value using the formula or selected from a referencing table\n5. Refresh the process with a procedural decontamination after $n$ samples.","0b2a8a52":"(Version 11 is a complete version)","ba864a7a":"## Parameters $S$ and $R$\n* I always use $S=10000$ in this notebook, for analysis convenience.\n* For values of $R$, it depends on the virus immunity rate of the sampling community. This value can be obtained from effectiveness (study) figures of vaccines. In this notebook, three scenarios that I will discuss are    \n    - Community with one dose of either AstraZeneca or Pfizer\n    - Community with two doses of either AstraZeneca or Pfizer\n    - Community without Vaccination","fb13d81a":"# Estimation of $\\theta$\nSince sampling is a process with repeated techniques and setup, I suppose it can be simulated in a lab as following:\n* Defines what it means to be a contamination. For example, fluid trace from previous sample found on the sampling stick used for next sample. If a sampling stick is clean from contamination, it is associated with a value of 1; otherwise, the value is 0.\n* Then, repeat the sampling technique N times, and record its contamination value.\n\nEventually, we have a record set to evaluate for $\\theta$, which is $\\frac{sum(record set)}{N}$. A confidence interval can also be considered if hypothesis testing is used.\n\nIn a more advanced context, I think it is even better if $\\theta$ estimation can be embedded into a sampling process. Since sampling at every community can be different, if $\\theta$ can be estimated on the field, then sampling team can be more effective in selecting $n$.","715f6542":"# The Model\nA **contaminated** process means it has transformed into a state that it can transmit virus. For example, a sampling stick has fluid trace from previous person. This stick is then used on the next person. A **safe** process means it is not or has not become contaminated.\n\nEach process takes samples repeatedly. Let $n$ be the variable representing the number of samples a process will take until it is finished or **refreshed**. A process is refreshed when it is decontaminated, or its equipment have been replaced with new ones. Refreshing guarantees a process to be brand-new. \n\nSince every process has its own risk of cross contamination, let $\\theta$, with $0 \\leq \\theta \\leq 1$, represents  the safety of a process, larger $\\theta$ means better. So, if there is a team, who follows a process with $\\theta=0.95$, and take only 1 sample, the probability of the process being safe after taken the sample is 0.95 (or it also means the probability of the process becoming contaminated is 0.05).  \n\nSo, if a process, with a safety of $\\theta$ value, is going to take $n$ samples repeatedly, it has a contamination risk value of $1-\\theta^n$. Let $p(n;\\theta)$ be a function representing this risk of contamination:\n$$p(n;\\theta):=1-\\theta^n$$  \n\nLet $S$ represent the number of new patients in the sampling day, and $R$, with $0 \\leq R \\leq 1$, be the immunity rate of a community against a virus. Then, $f(n;\\theta,S,R)$ is the function to estimate new patients from cross contamination of a sampling process:\n$$f(n;\\theta,S,R):= S(1-R)p = S(1-R)(1-\\theta^n)$$","5449d782":"With $\\theta, S, R$ available, and $C$ as the upper limit of new patients from cross contamination, then $n$ can be solved analytically as following:"}}