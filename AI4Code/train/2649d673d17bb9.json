{"cell_type":{"435a5f00":"code","c40558b9":"code","9b73f278":"code","b57555ae":"code","5e34e8ea":"code","358d1645":"code","338d6650":"code","5506cf09":"code","3a4d1003":"code","8bd3b5f8":"code","991bce06":"code","44f15cb0":"code","b3976aed":"code","f3f303b2":"code","c7b26909":"code","a4b14935":"code","ed9a5c4e":"code","cbb80c51":"code","96ab2efe":"code","34aefd10":"code","02f12738":"code","53424237":"code","98f73a85":"code","1e92abd6":"markdown","7cd22b7d":"markdown","34df17f2":"markdown","914a8d64":"markdown","3b8c563c":"markdown","3e2093a6":"markdown","4f9b8019":"markdown","19fd722d":"markdown","62ed43aa":"markdown","4fbc612c":"markdown","24ddb4e7":"markdown","2e66b7d7":"markdown"},"source":{"435a5f00":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import mean_squared_error, classification_report, accuracy_score\nfrom sklearn.feature_extraction.text import CountVectorizer, TfidfTransformer, TfidfVectorizer\n\nfrom sklearn.naive_bayes import MultinomialNB\nfrom sklearn.linear_model import LogisticRegression\n\n%matplotlib inline","c40558b9":"df = pd.read_csv('..\/input\/train-data-2.csv')","9b73f278":"df.head()","b57555ae":"df = df.drop(['id'], axis=1) # drop id karena tidak penting","5e34e8ea":"# pada kasus ini hanya menggunakan kolom review_sangat_singkat, header_review tidak digunakan.\nX = df['review_sangat_singkat']\ny = df['rating']","358d1645":"plt.title('Proporsi tiap kelas')\nsns.countplot(y)","338d6650":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=123)","5506cf09":"cvec = CountVectorizer(min_df=25, ngram_range=(1,2))\ntfidf_trans = TfidfTransformer()\nmodel = LogisticRegression()\n\ntext_clf = Pipeline([\n    ('vect', cvec),\n    ('tfidf', tfidf_trans),\n    ('clf', model),\n])\n\ntext_clf.fit(X_train, y_train)","3a4d1003":"y_train_pred = text_clf.predict(X_train)","8bd3b5f8":"print(classification_report(y_train, y_train_pred))\nprint('accuracy', accuracy_score(y_train, y_train_pred))\nprint('rmse', np.sqrt(mean_squared_error(y_train, y_train_pred)))","991bce06":"y_test_pred = text_clf.predict(X_test)","44f15cb0":"print(classification_report(y_test, y_test_pred))\nprint('accuracy', accuracy_score(y_test, y_test_pred))\nprint('rmse', np.sqrt(mean_squared_error(y_test, y_test_pred)))","b3976aed":"X_full = pd.concat([X_train, X_test])\ny_full = pd.concat([y_train, y_test])","f3f303b2":"text_clf.fit(X_full, y_full)","c7b26909":"y_full_pred = text_clf.predict(X_full)","a4b14935":"print(classification_report(y_full, y_full_pred))\nprint('accuracy', accuracy_score(y_full, y_full_pred))\nprint('rmse', np.sqrt(mean_squared_error(y_full, y_full_pred)))","ed9a5c4e":"# test_data = pd.read_csv('..\/input\/test-data-2.csv')","cbb80c51":"# test_data.head()","96ab2efe":"# test_data_pred = text_clf.predict(test_data['review_sangat_singkat'])","34aefd10":"# test_data_pred","02f12738":"# submission = pd.read_csv('..\/input\/sample-submission-2.csv')","53424237":"# submission['rating'] = test_data_pred","98f73a85":"# submission.to_csv('submission-2.csv', index=False)","1e92abd6":"### Proporsi kelas","7cd22b7d":"dari plot tersebut, sebaran kelas data tidak merata, review 4\/5 sangat banyak dibandingkan yang lain. Banyak hal yang bisa teman-teman lakukan untuk menangani data yang seperti ini. Penting untuk menganalisis nilai recall untuk rating minoritas.","34df17f2":"#### Bagi yang bingung cara mengolah dataset tersebut, kernel ini bisa dijadikan panduan. Masih banyak hal yang bisa teman-teman lakukan di luar kernel, misalnya:\n- menghapus stopwords\n- menangani kata-kata yang tidak baku\n- melakukan stemming\n- melakukan word embedding\n- menggunakan model lainnya\n- dan lainnya","914a8d64":"## Full Train","3b8c563c":"## Pipeline\n- Feature extraction\n    - CountVectorizer\n    - TfIdf\n- Modeling","3e2093a6":"hasil masil bertendensi besar untuk memprediksi ke rating 1 dan 5.\n\nApakah model logistic regression tepat untuk kita gunakan untuk kasus ini?\n\nBanyak hal lain yang bisa teman-teman lakukan untuk meningkatkan performa model","4f9b8019":"## Import Library","19fd722d":"## Submit to Kaggle","62ed43aa":"## Train score","4fbc612c":"## Split data","24ddb4e7":"## Test score","2e66b7d7":"## Load dataset"}}