{"cell_type":{"b1b3d74e":"code","11d1d7ce":"code","ba8e3cb4":"code","a994c007":"code","66675936":"code","7c658634":"code","ae59d3d6":"code","a84f9710":"markdown","c15617fa":"markdown","ff0f1525":"markdown"},"source":{"b1b3d74e":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n\nd1 = pd.read_csv(\"..\/input\/wine-quality-clustering-unsupervised\/winequality-red.csv\") \n\nd2 = d1.drop([\"quality\"], axis=1)\n\n\n","11d1d7ce":"dictionary = {\"fixed_acidity\":d2.fixed_acidity.values,\"volatile_acidity\":d2.volatile_acidity.values}\nd2 = pd.DataFrame(dictionary)\nd2.head()","ba8e3cb4":"from sklearn.cluster import KMeans\nwcss = []\n\nfor k in range(1,15):\n    kmeans = KMeans(n_clusters=k)\n    kmeans.fit(d2)\n    wcss.append(kmeans.inertia_)\n    \nplt.plot(range(1,15),wcss)\nplt.title('The Elbow Method')\nplt.xlabel(\"number of k (cluster) value\")\nplt.ylabel(\"wcss\")\nplt.show()","a994c007":"#%% k = 3 icin modelim\n\nkmeans2 = KMeans(n_clusters=3)\n\nclusters = kmeans2.fit_predict(d2)\n\nd2[\"clusters\"] = clusters\n\nd2.groupby(\"clusters\").count()\n","66675936":"plt.xlabel(\"fixed_acidity\")\nplt.ylabel(\"volatile_acidity\")\n\nplt.scatter(d2.fixed_acidity[d2.clusters == 0 ],d2.volatile_acidity[d2.clusters == 0],color = \"red\")\nplt.scatter(d2.fixed_acidity[d2.clusters == 1 ],d2.volatile_acidity[d2.clusters == 1],color = \"green\")\nplt.scatter(d2.fixed_acidity[d2.clusters == 2 ],d2.volatile_acidity[d2.clusters == 2],color = \"blue\")\n\nplt.scatter(kmeans2.cluster_centers_[:,0],kmeans2.cluster_centers_[:,1],color = \"yellow\")\nplt.show()","7c658634":"from scipy.cluster.hierarchy import linkage, dendrogram\n\nmerg = linkage(d2,method=\"ward\")\ndendrogram(merg,leaf_rotation = 90)\nplt.xlabel(\"data points\")\nplt.ylabel(\"euclidean distance\")\nplt.show()","ae59d3d6":"from sklearn.cluster import AgglomerativeClustering\n\nhiyerartical_cluster = AgglomerativeClustering(n_clusters = 5,affinity= \"euclidean\",linkage = \"ward\")\ncluster = hiyerartical_cluster.fit_predict(d2)\n\nd2[\"label\"] = cluster\n\nplt.xlabel(\"fixed_acidity\")\nplt.ylabel(\"volatile_acidity\")\n\nplt.scatter(d2.fixed_acidity[d2.clusters == 0 ],d2.volatile_acidity[d2.clusters == 0],color = \"red\")\nplt.scatter(d2.fixed_acidity[d2.clusters == 1 ],d2.volatile_acidity[d2.clusters == 1],color = \"green\")\nplt.scatter(d2.fixed_acidity[d2.clusters == 2 ],d2.volatile_acidity[d2.clusters == 2],color = \"blue\")\nplt.show()","a84f9710":"We find best K value for our model. We user elbow method.","c15617fa":"conclusion k-mean cluster model :\n\nanalyze your data\nfind best k value with elbow method\nrun kmean model with sklearn\nvirsualization your data row ","ff0f1525":"hierarcihal cluster model :\n\n"}}