{"cell_type":{"4648f2b6":"code","8efb13a2":"code","ff3e394b":"code","a9c3b9ad":"code","aa02550e":"code","db4f111a":"code","6ef7c318":"code","f015bd14":"code","57799a69":"code","310eb94a":"code","0f79781d":"code","6fd8d4ba":"code","9c589a9e":"code","60a53a6c":"code","fe13ee1b":"code","f525af2d":"code","1d520efc":"markdown","d5d5cce7":"markdown","01fef5d4":"markdown","89d67563":"markdown","3bd20653":"markdown","3518f395":"markdown","906a369a":"markdown"},"source":{"4648f2b6":"## define configuration\nPATH_TRAIN = '..\/input\/tabular-playground-series-feb-2021\/train.csv'\nPATH_TEST = '..\/input\/tabular-playground-series-feb-2021\/test.csv'\n\nPATH_AUTOSKLEARN_SUBMISSION = 'submission_autosklearn.csv'\nPATH_H2OAML_SUBMISSION = 'submission_h2oaml.csv'","8efb13a2":"## install package\n!curl https:\/\/raw.githubusercontent.com\/automl\/auto-sklearn\/master\/requirements.txt | xargs -n 1 -L 1 pip3 install\n!pip3 install auto-sklearn","ff3e394b":"## import packages\nimport pandas as pd\n\nfrom autosklearn.regression import AutoSklearnRegressor\nfrom autosklearn.metrics import mean_squared_error","a9c3b9ad":"## prepare data\ntrain = pd.read_csv(PATH_TRAIN)\ntest = pd.read_csv(PATH_TEST)\n\ntrain_test = pd.concat([train, test])\n\nfor categorical_column in [f'cat{i}' for i in range(10)]:\n    train_test[categorical_column] = train_test[categorical_column].astype('category')\n\ntrain = train_test[:train.shape[0]]\ntest = train_test[train.shape[0]:]\n\ntarget = train.target.values\ntrain.drop(['id', 'target'], axis=1, inplace=True)","aa02550e":"## run model\nautosklearnml = AutoSklearnRegressor(\n    time_left_for_this_task=600,\n    metric=mean_squared_error,\n    scoring_functions=[mean_squared_error]\n)\n\nautosklearnml.fit(X=train, y=target, dataset_name='tps_feb_2021')","db4f111a":"## check statistics\nprint(autosklearnml.sprint_statistics())","6ef7c318":"## generate predictions\npreds_autosklearnml = autosklearnml.predict(test[train.columns])","f015bd14":"## create submission\nsubmission = pd.DataFrame({\n    'id': test.id,\n    'target': preds_autosklearnml\n})\n\nsubmission.head()","57799a69":"## save submission\nsubmission.to_csv(PATH_AUTOSKLEARN_SUBMISSION, index=False)","310eb94a":"## import packages\nimport pandas as pd\n\nimport h2o\nfrom h2o.automl import H2OAutoML","0f79781d":"## prepare data\nh2o.init()\n\nh2o_train = h2o.import_file(PATH_TRAIN)\nh2o_test = h2o.import_file(PATH_TEST)","6fd8d4ba":"## run model\nfeatures = [x for x in h2o_train.columns if x not in ['id', 'target']]\n\nh2oaml = H2OAutoML(\n    max_runtime_secs=600,\n    stopping_metric='RMSE',\n    sort_metric='RMSE'\n)\n\nh2oaml.train(x=features, y='target', training_frame=h2o_train)","9c589a9e":"## check leaderboard\nh2oaml.leaderboard","60a53a6c":"## generate predictions\npreds_h2oaml = h2oaml.leader.predict(h2o_test)","fe13ee1b":"## create submission\nsubmission = pd.DataFrame({\n    'id': h2o_test['id'].as_data_frame().id,\n    'target': preds_h2oaml.as_data_frame().predict\n})\n\nsubmission.head()","f525af2d":"## save submission\nsubmission.to_csv(PATH_H2OAML_SUBMISSION, index=False)","1d520efc":"**Auto**mated **M**achine **L**earning (**AutoML**) has become widely adopted for building, experimenting and productionizing various types of machine learning models across business use-cases.\n\nThere are different open source solutions available and this notebook explores a simple baseline solution for some of them on the [Kaggle TPS (February-2021) competition](https:\/\/www.kaggle.com\/c\/tabular-playground-series-feb-2021).\n\n* [Auto-Sklearn](#Auto-Sklearn)\n* [H2O AutoML](#H2O-AutoML)","d5d5cce7":"## Auto-Sklearn\n[auto-sklearn](https:\/\/automl.github.io\/auto-sklearn) is an automated machine learning toolkit and a drop-in replacement for a scikit-learn estimator","01fef5d4":"This is just a baseline submission over which a lot of improvements can be made. You can read more about Auto-Sklearn's workflow, settings, hyperparameters, optimizations and more here:\n\n* [Documentation of auto-sklearn](https:\/\/automl.github.io\/auto-sklearn)\n* [Deep dive of auto-sklearn](https:\/\/github.com\/vopani\/fortyone#automl-series-)","89d67563":"## Similar Tutorials\nSimilar tutorials on other Kaggle TPS competitions are published here:\n\n* [AutoML Tutorial: TPS (January 2021)](https:\/\/www.kaggle.com\/rohanrao\/automl-tutorial-tps-january-2021)\n* [AutoML Tutorial: TPS (March 2021)](https:\/\/www.kaggle.com\/rohanrao\/automl-tutorial-tps-march-2021)\n* [AutoML Tutorial: TPS (April 2021)](https:\/\/www.kaggle.com\/rohanrao\/automl-tutorial-tps-april-2021)\n* [AutoML Tutorial: TPS (May 2021)](https:\/\/www.kaggle.com\/rohanrao\/automl-tutorial-tps-may-2021)\n* [AutoML Tutorial: TPS (June 2021)](https:\/\/www.kaggle.com\/rohanrao\/automl-tutorial-tps-june-2021)","3bd20653":"<div align='center'>\n    <h1>AutoML Tutorial<\/h1>\n    <img src='https:\/\/github.com\/vopani\/fortyone\/blob\/main\/images\/automl_banner_530_x_455.png?raw=true'>\n<\/div>","3518f395":"This is just a baseline submission over which a lot of improvement can be made. You can read more about H2O AutoML's workflow, settings, hyperparameters, interpretability and more here:\n\n* [Documentation of H2O AutoML](https:\/\/docs.h2o.ai\/h2o\/latest-stable\/h2o-docs\/automl.html)\n* [Deep dive of H2O AutoML](https:\/\/github.com\/vopani\/fortyone#automl-series-)","906a369a":"## H2O AutoML\n<img src='https:\/\/docs.h2o.ai\/h2o\/latest-stable\/h2o-docs\/_images\/h2o-automl-logo.jpg' width='150px'>\n\n[H2O AutoML](https:\/\/www.h2o.ai\/products\/h2o-automl) is an automated machine learning library open sourced by [H2O.ai](https:\/\/h2o.ai)"}}