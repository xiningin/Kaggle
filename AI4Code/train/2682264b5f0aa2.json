{"cell_type":{"bd5e2689":"code","50bc7e36":"code","8aa78e3e":"code","be26a6ff":"code","4f7a760a":"code","6641b5eb":"code","b5358764":"code","375994ac":"code","3e532e3c":"code","37fd08b4":"code","4edd85fd":"code","427e1a05":"code","c8fb5b79":"code","9d5420a1":"code","dea29dec":"code","94d917d6":"markdown"},"source":{"bd5e2689":"!pip3 install fastai==1.0.42","50bc7e36":"from fastai.text import * \nfrom fastai.gen_doc.nbdoc import *\nfrom fastai.datasets import * \nfrom fastai.datasets import Config\nfrom pathlib import Path\nimport pandas as pd","8aa78e3e":"path = untar_data(URLs.IMDB_SAMPLE)\npath","be26a6ff":"df = pd.read_csv(path\/'texts.csv')\ndf.head()","4f7a760a":"# Language model data\ndata_lm = TextLMDataBunch.from_csv(path, 'texts.csv')\n# Classifier model data\ndata_clas = TextClasDataBunch.from_csv(path, 'texts.csv', vocab=data_lm.train_ds.vocab, bs=32)","6641b5eb":"learn = language_model_learner(data_lm, pretrained_model=URLs.WT103, drop_mult=0.5)\nlearn.fit_one_cycle(1, 1e-2)","b5358764":"learn.unfreeze()\nlearn.fit_one_cycle(1, 1e-3)","375994ac":"learn.predict(\"This is a review about\", n_words=10)","3e532e3c":"learn.save_encoder('ft_enc')","37fd08b4":"learn = text_classifier_learner(data_clas, drop_mult=0.5)\nlearn.load_encoder('ft_enc')","4edd85fd":"data_clas.show_batch()","427e1a05":"learn.fit_one_cycle(1, 1e-2)","c8fb5b79":"learn.freeze_to(-2)\nlearn.fit_one_cycle(5, slice(5e-3\/2., 5e-3))\n","9d5420a1":"learn.unfreeze()\nlearn.fit_one_cycle(5, slice(2e-3\/100, 2e-3))","dea29dec":"learn.predict(\"This was a great movie!\")","94d917d6":"https:\/\/docs.fast.ai\/text.html"}}