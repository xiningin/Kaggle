{"cell_type":{"9e29644e":"code","3910dd8f":"code","181efe97":"code","f0deeb7b":"code","46fd75ec":"code","0c3a6d03":"code","556580d4":"code","51ec9590":"code","2b353962":"code","84441737":"code","a86ab0ee":"code","9c5c7304":"code","d2ce277b":"code","3fd83161":"code","33606e37":"code","ad2f3b3e":"code","ba7473a4":"code","756a9dcf":"code","6d814b5a":"code","953aa4b0":"code","3a4a9b6a":"code","20c722b3":"code","7e83203f":"code","bc1ba9e1":"code","1cf21202":"code","f9f55220":"code","375b7596":"code","a349d20e":"code","4f886ae7":"code","a468fa32":"code","0e2f1c27":"code","b9b4db68":"code","57f1e56f":"code","9a1b278b":"code","5b21885a":"code","c69d6998":"code","4617a227":"code","288bc3a5":"code","61af0401":"markdown","d6b39ff4":"markdown","7eb8fb5e":"markdown","554bb2ec":"markdown","5a32d32d":"markdown","866041bf":"markdown","f2495f48":"markdown","1789e877":"markdown","1f314dbb":"markdown","0ec1ebd7":"markdown"},"source":{"9e29644e":"# import libraries\nimport numpy as np\nimport pandas as pd","3910dd8f":"# constants\nDATA_DIR = \"..\/input\/petfinder-pawpularity-score\/\"","181efe97":"# read image metadata\ntrain_meta_df = pd.read_csv(DATA_DIR + 'train.csv')\ntest_meta_df = pd.read_csv(DATA_DIR + 'test.csv')\n\nprint(\"Train Metadata Shape: \", train_meta_df.shape)\nprint(\"Test Metadata Shape: \", test_meta_df.shape)","f0deeb7b":"train_meta_df.dtypes","46fd75ec":"train_meta_df.head()","0c3a6d03":"test_meta_df.head()","556580d4":"# Read sample submission file\nsubmission = pd.read_csv(DATA_DIR + 'sample_submission.csv')\ntest_meta_sample_y = submission[\"Pawpularity\"]\nsubmission.head()","51ec9590":"# Prepare X and y variables for training\nX = train_meta_df.drop(columns=[\"Id\",\"Pawpularity\"])\ny = train_meta_df[\"Pawpularity\"]\n# Copy training data to save training data predictions for comparing different models\ntrain_meta_df_pred = train_meta_df.copy()","2b353962":"# Import library for modeling\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import mean_squared_error","84441737":"# Import Random Forest regressor from sklearn\nfrom sklearn.ensemble import RandomForestRegressor","a86ab0ee":"# Building Random Forest regressor model\nrf_model = RandomForestRegressor(\n    n_estimators=300, \n    max_depth=15,\n    random_state=100,\n    verbose=2)\n# Training\nrf_model.fit(X, y)","9c5c7304":"# Random Forest prediction\nrf_train_y_pred = rf_model.predict(X)\nrf_test_y_pred = rf_model.predict(test_meta_df.drop(columns=[\"Id\"]))","d2ce277b":"train_meta_df_pred[\"RFTrainPred\"] = rf_train_y_pred\ntrain_meta_df_pred[[\"Id\", \"Pawpularity\", \"RFTrainPred\"]]","3fd83161":"# Evaluation on training and testing data\nrf_train_RMSE = mean_squared_error(train_meta_df[\"Pawpularity\"], rf_train_y_pred, squared=False)\n# Test RMSE is based on sample submission data which is not accurate\nrf_test_RMSE = mean_squared_error(test_meta_sample_y, rf_test_y_pred, squared=False)\nprint(\"RF Train RMSE: \", rf_train_RMSE)\nprint(\"RF Test RMSE: \", rf_test_RMSE)","33606e37":"# Import AdaBoost regressor from sklearn\nfrom sklearn.ensemble import AdaBoostRegressor","ad2f3b3e":"# Building AdaBoost regressor model\nadab_model = AdaBoostRegressor(\n    n_estimators=10,\n    learning_rate=0.0001,\n    loss='square',\n    random_state=100)\n# Training\nadab_model.fit(X, y)","ba7473a4":"# AdaBoost Prediction\nadab_train_y_pred = adab_model.predict(X)\nadab_test_y_pred = adab_model.predict(test_meta_df.drop(columns=[\"Id\"]))","756a9dcf":"train_meta_df_pred[\"ADABTrainPred\"] = adab_train_y_pred\ntrain_meta_df_pred[[\"Id\", \"Pawpularity\", \"RFTrainPred\", \"ADABTrainPred\"]]","6d814b5a":"# Evaluation on training and testing data\nadab_train_RMSE = mean_squared_error(train_meta_df[\"Pawpularity\"], adab_train_y_pred, squared=False)\n# Test RMSE is based on sample submission data which is not accurate\nadab_test_RMSE = mean_squared_error(test_meta_sample_y, adab_test_y_pred, squared=False)\nprint(\"ADAB Train RMSE: \", adab_train_RMSE)\nprint(\"ADAB Test RMSE: \", adab_test_RMSE)","953aa4b0":"# Import GradientBoosting regressor from sklearn\nfrom sklearn.ensemble import GradientBoostingRegressor","3a4a9b6a":"# Building GradientBoosting regressor model\ngb_model = GradientBoostingRegressor(\n    n_estimators=30,\n    learning_rate=0.01,\n    verbose=2,\n    random_state=100)\n# Training\ngb_model.fit(X, y)","20c722b3":"# GradientBoosting Prediction\ngb_train_y_pred = gb_model.predict(X)\ngb_test_y_pred = gb_model.predict(test_meta_df.drop(columns=[\"Id\"]))","7e83203f":"train_meta_df_pred[\"GBTrainPred\"] = gb_train_y_pred\ntrain_meta_df_pred[[\"Id\", \"Pawpularity\", \"RFTrainPred\", \"ADABTrainPred\", \"GBTrainPred\"]]","bc1ba9e1":"# Evaluation on training and testing data\ngb_train_RMSE = mean_squared_error(train_meta_df[\"Pawpularity\"], gb_train_y_pred, squared=False)\n# Test RMSE is based on sample submission data which is not accurate\ngb_test_RMSE = mean_squared_error(test_meta_sample_y, gb_test_y_pred, squared=False)\nprint(\"GB Train RMSE: \", gb_train_RMSE)\nprint(\"GB Test RMSE: \", gb_test_RMSE)","1cf21202":"# Import XGBoost regressor from sklearn\nimport xgboost as xgb","f9f55220":"# Split training data into training and validation data\nX_train, X_val, y_train, y_val = train_test_split(X, y, test_size=0.3, random_state=100)\n\nprint(\"Train Metadata Shape: \", X_train.shape)\nprint(\"Val Metadata Shape: \", X_val.shape)","375b7596":"# Set XGBoost parameters\nxgb_params_dist = {\n    \"n_estimators\": 350,\n    \"learning_rate\": 0.01,\n    \"verbosity\" : 2,\n    \"subsample\": 0.3,\n    \"seed\": 100,\n}\n# Building XGBoost Regressor Model\nxgb_model = xgb.XGBRegressor(**xgb_params_dist)\n# Training\nxgb_model.fit(\n    X_train,\n    y_train,\n    eval_set=[(X_val, y_val)],\n)","a349d20e":"# XGBoost Prediction\nxgb_train_y_pred = xgb_model.predict(X)\nxgb_test_y_pred = xgb_model.predict(test_meta_df.drop(columns=[\"Id\"]))","4f886ae7":"train_meta_df_pred[\"XGBTrainPred\"] = xgb_train_y_pred\ntrain_meta_df_pred[[\"Id\", \"Pawpularity\", \"RFTrainPred\", \"ADABTrainPred\", \"GBTrainPred\", \"XGBTrainPred\"]]","a468fa32":"# Evaluation on training and testing data\nxgb_train_RMSE = mean_squared_error(train_meta_df[\"Pawpularity\"], xgb_train_y_pred, squared=False)\n# Test RMSE is based on sample submission data which is not accurate\nxgb_test_RMSE = mean_squared_error(test_meta_sample_y, xgb_test_y_pred, squared=False)\nprint(\"XGB Train RMSE: \", xgb_train_RMSE)\nprint(\"XGB Test RMSE: \", xgb_test_RMSE)","0e2f1c27":"# Import Voting regressor from sklearn\nfrom sklearn.ensemble import VotingRegressor","b9b4db68":"# Building Voting regressor model\nvr_model = VotingRegressor([('rf', rf_model),\n                            ('adab', adab_model),\n                            ('gb', gb_model),\n                            ('xgb', xgb_model)],\n                           verbose=True)\n# Training\nvr_model.fit(X, y)","57f1e56f":"# Voting prediction\nvr_train_y_pred = vr_model.predict(X)\nvr_test_y_pred = vr_model.predict(test_meta_df.drop(columns=[\"Id\"]))","9a1b278b":"train_meta_df_pred[\"VRTrainPred\"] = vr_train_y_pred\ntrain_meta_df_pred[[\"Id\", \"Pawpularity\", \"RFTrainPred\", \"ADABTrainPred\", \"GBTrainPred\", \"XGBTrainPred\",\"VRTrainPred\"]]","5b21885a":"# Evaluation on training and testing data\nvr_train_RMSE = mean_squared_error(train_meta_df[\"Pawpularity\"], vr_train_y_pred, squared=False)\n# Test RMSE is based on sample submission data which is not accurate\nvr_test_RMSE = mean_squared_error(test_meta_sample_y, vr_test_y_pred, squared=False)\nprint(\"VR Train RMSE: \", vr_train_RMSE)\nprint(\"VR Test RMSE: \", vr_test_RMSE)","c69d6998":"# Test RMSE is based on sample submission data which is not accurate\nrmse_comparison = pd.DataFrame(np.array([[rf_train_RMSE,rf_test_RMSE,\n                                          adab_train_RMSE,adab_test_RMSE,\n                                          gb_train_RMSE,gb_test_RMSE,\n                                          xgb_train_RMSE,xgb_test_RMSE,\n                                          vr_train_RMSE,vr_test_RMSE]]), \n                               columns=[\"RFTrain\",\"RFTest\",\n                                        \"ADABTrain\",\"ADABTest\",\n                                        \"GBTrain\",\"GBTest\",\n                                        \"XGBTrain\",\"XGBTest\",\n                                        \"VRTrain\",\"VRTest\"])\nrmse_comparison.head()","4617a227":"# Submission dataframe\nsubmission['Id'] = test_meta_df[\"Id\"]\n\"\"\"\nTraining RMSE is similar for all regressors.\nTesting RMSE shows variations but it cannot be trusted as it is\nbased on sample submission data. After evaluating all models \non real Kaggle testing data, all models have similar\ntesting RMSE values with minor differences.\nUse any model for test prediction. Here Adaboost model is used.\n\"\"\"\nsubmission['Pawpularity'] = adab_test_y_pred\nprint(\"Submission Shape:\", submission.shape)\nsubmission.head(8)","288bc3a5":"# Submission File\nsubmission.to_csv('submission.csv', index=False)","61af0401":"Thank you for going through this notebook. I will try to improve results in upcoming notebooks using cross validation, feature extraction, and advanced models. Stay tuned!","d6b39ff4":"## RMSE Comparison","7eb8fb5e":"## Import Dataset","554bb2ec":"## Building Regression Models\n### 1. Random Forest Model","5a32d32d":"### 5. Voting Regressor Model","866041bf":"### 2. AdaBoost Model","f2495f48":"## Submission","1789e877":"### 4. XGBoost Model","1f314dbb":"### 3. Gradient Boosting Model","0ec1ebd7":"# Pawpularity Prediction Comparison of Five Regression Model: Random Forest, AdaBoost, Gradient Boosting, XGBoost, Voting\n\n## TASK Description\n1. Accurately determine a pet photo\u2019s appeal and even suggest improvements to give rescue animals a higher chance of loving homes. Analyze raw images and metadata to predict the \u201cPawpularity\u201d of pet photos.\n2. Submissions are scored on the root mean squared (RMSE) error.\n\n## Purpose of this Notebook\nBuilding simple regression models for PetFinder Pawpularity dataset (image metadata only) and comparing their results. This notebook does not contain any EDA, Feature Extraction, Cross Validation, or any advanced image models. It is meant for beginners.\nThis is work in progress.\n"}}