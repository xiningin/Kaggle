{"cell_type":{"6bb6d42e":"code","fbfee43b":"code","a74a657a":"code","9785b468":"code","00226f7f":"code","0c85be4c":"code","6eb7423e":"code","0b657281":"code","8eb8f48a":"code","8c893414":"code","72282ee8":"code","96d18876":"code","21a6adb9":"code","6b5b2ad0":"code","260f4a98":"code","a1a067de":"code","3b003569":"code","07e741dc":"code","0d042ef4":"code","86ce5684":"code","bf0d3735":"code","0be49d04":"code","85ff4970":"code","5f90e61f":"code","986ac6c0":"code","9d086a08":"code","182f6b10":"code","ec8a2135":"code","833c01e0":"code","411b47e4":"code","df622389":"code","dc8400c5":"markdown","89e0f549":"markdown","5f3c26dd":"markdown","c2267d48":"markdown","9ba844ee":"markdown","597b4696":"markdown","c059a791":"markdown","a589fec4":"markdown","a0f4e3cb":"markdown","7a827865":"markdown","9ee291aa":"markdown","3ce91c2b":"markdown","6c6447e4":"markdown","b746942b":"markdown","c585c4d2":"markdown"},"source":{"6bb6d42e":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\n\nimport warnings\nwarnings.filterwarnings('ignore')\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","fbfee43b":"from PIL import Image","a74a657a":"#Code by Ritwek Khosla https:\/\/www.kaggle.com\/vanvalkenberg\/hubble-telescope-images\/comments\n\ndef display_Image(path, save):\n    img1 = Image.open(path)\n    display(img1)\n    if save == True:\n        img1.save('santa.jpg')","9785b468":"display_Image('\/kaggle\/input\/is-that-santa-image-classification\/is that santa\/train\/santa\/108.Santa.jpg', 0)","00226f7f":"display_Image('\/kaggle\/input\/is-that-santa-image-classification\/is that santa\/train\/not-a-santa\/20.not-a-santa.jpg',True)","0c85be4c":"train_santa = \"..\/input\/is-that-santa-image-classification\/is that santa\/train\/santa\"\ntrain_not_a_santa= \"..\/input\/is-that-santa-image-classification\/is that santa\/train\/not-a-santa\"\ntest_santa= \"..\/input\/is-that-santa-image-classification\/is that santa\/test\/santa\"\ntest_not_a_santa= \"..\/input\/is-that-santa-image-classification\/is that santa\/test\/not-a-santa\"\nimage_size = 128","6eb7423e":"Image.open(train_santa+\"\/\"+\"146.Santa.jpg\")","0b657281":"Image.open(\"..\/input\/is-that-santa-image-classification\/is that santa\/train\/santa\/143.Santa.jpg\")","8eb8f48a":"print(os.listdir(\"..\/input\"))","8c893414":"#Code by Xuqiang Fang https:\/\/www.kaggle.com\/danyfang\/dog-vs-cat-classifier\n\npath_santas = r'..\/input\/is-that-santa-image-classification\/is that santa\/train\/santa\/'\npath_notsantas = r'..\/input\/is-that-santa-image-classification\/is that santa\/train\/not-a-santa\/'\npath_test_notsantas = r'..\/input\/is-that-santa-image-classification\/is that santa\/test\/not-a-santa\/'\npath_test_santas = r'..\/input\/is-that-santa-image-classification\/is that santa\/test\/santa\/'\ntraining_santas = os.listdir(path_santas)\ntraining_notsantas = os.listdir(path_notsantas)\ntesting_santas = os.listdir(path_test_santas)\ntesting_notsantas = os.listdir(path_test_notsantas)","72282ee8":"#Code by Xuqiang Fang https:\/\/www.kaggle.com\/danyfang\/dog-vs-cat-classifier\n\nif '.DS_Store' in training_santas:\n    training_santas.remove('.DS_Store')\n    \nif '.DS_Store' in testing_santas:\n    testing_santas.remove('.DS_Store')\n\nif '.DS_Store' in training_notsantas:\n    training_notsantas.remove('.DS_Store')\n    \nif '.DS_Store' in testing_notsantas:\n    testing_notsantas.remove('.DS_Store')","96d18876":"#Code by Xuqiang Fang https:\/\/www.kaggle.com\/danyfang\/dog-vs-cat-classifier\n\nsanta_fig, santa_axes = plt.subplots(3,3)\nsanta_fig.set_figheight(24)\nsanta_fig.set_figwidth(24)\n\nfor i, axis in enumerate(santa_axes):\n    for j, f in enumerate(axis):\n        img = plt.imread(path_santas+training_santas[i*3+j])\n        santa_axes[i,j].imshow(img)\n        santa_axes[i,j].set_title(\"Shape.{}\".format(img.shape))","21a6adb9":"#Code by Xuqiang Fang https:\/\/www.kaggle.com\/danyfang\/dog-vs-cat-classifier\n\nnotsanta_fig, notsanta_axes = plt.subplots(3,3)\nnotsanta_fig.set_figheight(24)\nnotsanta_fig.set_figwidth(24)\n\nfor i, axis in enumerate(notsanta_axes):\n    for j, f in enumerate(axis):\n        img = plt.imread(path_notsantas+training_notsantas[i*3+j])\n        notsanta_axes[i,j].imshow(img)\n        notsanta_axes[i,j].set_title(\"Shape.{}\".format(img.shape))","6b5b2ad0":"input_shape = (224,224,3)#ValueError: could not broadcast input array from shape (224,224,3) into shape (224,224)\nnum_classes = 2","260f4a98":"from keras.models import Sequential, load_model\nfrom keras.layers import Dense, Dropout, Flatten, Activation\n#from keras.optimizers import SGD# Don't use this \nfrom tensorflow.keras.optimizers import SGD\nfrom keras.utils import np_utils\nfrom keras.applications.mobilenet import MobileNet","a1a067de":"mobilenet = MobileNet(input_shape, weights='imagenet', include_top=False)","3b003569":"model = Sequential()\nmodel.add(mobilenet)\nmodel.add(Flatten())\nmodel.add(Dense(256, activation='relu'))\nmodel.add(Dropout(0.5))\nmodel.add(Dense(num_classes, activation='sigmoid'))\nmodel.summary()\nsgd = SGD(lr=0.0001, decay=1e-6, momentum=0.9, nesterov=True)\nmodel.compile(loss='binary_crossentropy', optimizer=sgd, metrics=['accuracy'])","07e741dc":"img_resize = (224,224) #ValueError: could not broadcast input array from shape (224,224,3) into shape (224,224)\nsantas_train = []\nnotsantas_train = []\nsantas_test = []\nnotsantas_test = []\nfor santa in training_santas:\n    img = Image.open(path_santas + santa)\n    img = img.resize(img_resize)\n    img = np.asarray(img)\n    santas_train.append(img)","0d042ef4":"for notsanta in training_notsantas:\n    img = Image.open(path_notsantas + '10.not-a-santa.jpg')\n    img = img.resize(img_resize)\n    img = np.asarray(img)\n    notsantas_train.append(img)\n    \nfor santa in testing_santas:\n    img = Image.open(path_test_santas + santa)\n    img = img.resize(img_resize)\n    img = np.asarray(img)\n    santas_test.append(img)\n    \nfor notsanta in testing_notsantas:\n    img = Image.open(path_test_notsantas + '0.not-a-santa.jpg')\n    img = img.resize(img_resize)\n    img = np.asarray(img)\n    notsantas_test.append(img)","86ce5684":"santas_train_label = [0 for _ in range(len(santas_train))]\nnotsantas_train_label = [1 for _ in range(len(notsantas_train))]\nsantas_test_label = [0 for _ in range(len(santas_test))]\nnotsantas_test_label = [1 for _ in range(len(notsantas_test))]","bf0d3735":"santas_train_label.extend(notsantas_train_label)\nsantas_test_label.extend(notsantas_test_label)\nlabel_train = np_utils.to_categorical(santas_train_label, num_classes)\nlabel_test = np_utils.to_categorical(santas_test_label, num_classes)","0be49d04":"#for train data\nsantas_train.extend(notsantas_train)\ndata_train = np.array(santas_train, dtype=np.float32)\ndata_train \/= 255\nindex = np.arange(len(data_train))\nnp.random.shuffle(index)\ndata_train = data_train[index]\nlabel_train = label_train[index]","85ff4970":"import keras\nfrom keras.layers import Conv2D,Flatten,Dense,MaxPooling2D\n\nfrom keras.preprocessing.image import ImageDataGenerator","5f90e61f":"#Code by Gajulamandyam Deva Kumar https:\/\/www.kaggle.com\/devaloo\/kerneledb31c4357\n\ntrain_datagen = ImageDataGenerator(rescale = 1\/255)\ntest_datagen = ImageDataGenerator(rescale = 1\/255)","986ac6c0":"trainset = train_datagen.flow_from_directory(r\"..\/input\/is-that-santa-image-classification\/is that santa\/train\",target_size = (150,150),class_mode='binary',batch_size=80)\ntestset = test_datagen.flow_from_directory(r\"..\/input\/is-that-santa-image-classification\/is that santa\/test\",target_size = (150,150),class_mode = 'binary',batch_size= 20)","9d086a08":"#Code by Gajulamandyam Deva Kumar https:\/\/www.kaggle.com\/devaloo\/kerneledb31c4357\n\nmodel = keras.models.Sequential([Conv2D(16,(3,3),input_shape = (150,150,3),activation = 'relu'),\n                                 MaxPooling2D(2,2),\n                                 Conv2D(32,(3,3),activation = 'relu'),\n                                 MaxPooling2D(2,2),\n                                 Conv2D(64,(3,3),activation = 'relu'),\n                                 MaxPooling2D(2,2),\n                                 Flatten(),\n                                 Dense(512,activation = 'relu'),\n                                 Dense(1,activation = 'sigmoid')\n    \n])","182f6b10":"model.summary()","ec8a2135":"#Code by Gajulamandyam Deva Kumar https:\/\/www.kaggle.com\/devaloo\/kerneledb31c4357\n\nfrom tensorflow.keras.optimizers import RMSprop\n\nmodel.compile(optimizer = RMSprop(lr = 0.001),loss = 'binary_crossentropy',metrics = ['accuracy'])","833c01e0":"model.fit_generator(trainset,steps_per_epoch=50,epochs = 10,validation_data=testset,validation_steps=20)","411b47e4":"trainset.class_indices","df622389":"#Code by Gajulamandyam Deva Kumar https:\/\/www.kaggle.com\/devaloo\/kerneledb31c4357\n\nfrom keras.preprocessing import image\ntestdata1 = image.load_img(\"..\/input\/is-that-santa-image-classification\/is that santa\/train\/santa\/151.Santa.jpg\",target_size = (150,150))\nimport numpy as np\nx1=image.img_to_array(testdata1)\nx1=np.expand_dims(x1, axis=0)\nimages = np.vstack([x1])\nans = model.predict(images)\nif ans[0][0] == 0:\n    print(\"it is not a Santa\")\nelse:\n    print(\"it is a Santa\")","dc8400c5":"<iframe width=\"535\" height=\"401\" src=\"https:\/\/www.youtube.com\/embed\/3bWkj52bLmE\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen><\/iframe>","89e0f549":"<iframe width=\"942\" height=\"530\" src=\"https:\/\/www.youtube.com\/embed\/YLBrDddVZm4\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen><\/iframe>","5f3c26dd":"#Acknowledgement\n\nXuqiang Fang https:\/\/www.kaggle.com\/danyfang\/dog-vs-cat-classifier\n\nGajulamandyam Deva Kumar https:\/\/www.kaggle.com\/devaloo\/kerneledb31c4357","c2267d48":"#Error: ValueError: could not broadcast input array from shape (224,224,3) into shape (224,224)","9ba844ee":"<center style=\"font-family:verdana;\"><h1 style=\"font-size:200%; padding: 10px; background: #B8860B;\"><b style=\"color:black;\">Mr. Hankey the Xmas Poo. He loves me, I love you<\/b><\/h1><\/center>\n\nWe've all heard of Rudolph and his shiny nose\n\nAnd we all know Frosty who's made out of snow\n\nBut all of those stories seem kind of... gay\n\nCause we all know who brightens up our holiday\n\nMr. Hankey the Christmas Poo\n\nSmall and brown he comes from you\n\nSit on the toilet here he comes\n\nSqueeze'in 'tween your festive buns\n\nA present from down below\n\nSpreading joy with a \"Howdy-Ho!\n\nHe's seen the love inside of you\n\nCause he's a piece of poo\n\nSometimes he's nutty\n\nSometimes he's corny\n\nHe can be brown or greenish brown (Mmmmhmmm!)\n\nBut if you eat fiber on Christmas eve\n\nHe might come to your town!\n\nMr. Hankey the Christmas Poo\n\nHe loves me, I love you\n\nTherefore, vicariously he loves you!\n\nCartman: Well Kyle where is he?\n\nKyle: Ehh .. He's coming!\n\nStan: Come on dude, push!\n\nKyle: Ehhhh... I'm Trying!\n\nCartman: Wait, wait I can see his head!\n\nKyle: Ehh... Here he comes!\n\nPOP!\n\nMr. Hankey: Howdy Ho!\n\nhttps:\/\/www.letras.mus.br\/south-park\/229086\/","597b4696":"#Let's go to Plan B","c059a791":"#All of this to print \"It's a Santa\"????  Really! Only Mr Hankey to save my day. Howdy Ho dear Kagglers!","a589fec4":"#Mr Hankey (The Xmas Poo) Best Moments! South Park\n\nhttps:\/\/www.youtube.com\/watch?v=YLBrDddVZm4","a0f4e3cb":"![](https:\/\/c.tenor.com\/dvEN7MbEqQwAAAAC\/bye-bye-mr-hankey.gif)tenor.com","7a827865":"![](https:\/\/media3.giphy.com\/media\/3o6Zt3griX6nVhlf32\/giphy.gif)giphy.com","9ee291aa":"![](https:\/\/c.tenor.com\/Qn06tzB2fPgAAAAM\/boy-things-are-starting-to-look-christmasy-now-mr-hankey.gif)tenor.com","3ce91c2b":"#Not a Santas","6c6447e4":"Mr. Hanky The Christmas Poo Lyrics\n\nhttps:\/\/www.youtube.com\/watch?v=3bWkj52bLmE","b746942b":"#Going to Plan C","c585c4d2":"#PIL.UnidentifiedImageError: cannot identify image file \n\nIf PIL cannot identify the image so do I too."}}