{"cell_type":{"ec3b8d42":"code","7818cf69":"code","ea6831c1":"code","d360a041":"code","cdbe72cb":"code","99e29dfe":"code","f28f7493":"code","4ea03853":"code","17c10463":"code","8808a89c":"code","e91b6690":"code","532f68fb":"code","0f8579b0":"code","071b3d7d":"code","ff189cf8":"code","d1fad570":"code","d68cb161":"code","9eb9127f":"code","f4af70dd":"code","e463bdec":"code","37e01342":"code","635e053e":"code","06d5b1bc":"code","a35d1c90":"code","d88f84f9":"code","02a325df":"code","c6c3e893":"code","b24c078b":"code","6a078543":"code","6057335c":"code","8963f1c5":"code","e6624a73":"code","829cef6d":"code","d01f9277":"code","3d4b93f0":"code","6ac9d55f":"code","fcd6e1e1":"code","8e825753":"code","b019add2":"code","810c203d":"code","4ba5bccf":"code","ffce3a9d":"code","628cb7a6":"code","50b1a493":"code","9d92bd1d":"code","17db68b1":"code","d0682c19":"code","fccbbb3f":"code","ce937c04":"code","2e4f7a15":"code","b7e388c5":"code","5ef9ae34":"code","cbad2821":"code","1ddc495a":"code","0f1d7945":"code","1319c19b":"code","20c289c6":"markdown","ef311cd6":"markdown","dfd499a9":"markdown","5faa02ad":"markdown","8d0dd2dd":"markdown","a677d1f8":"markdown","e049adb2":"markdown","098690bf":"markdown","1a710c5f":"markdown","204a394d":"markdown","c582f486":"markdown","580d2acd":"markdown","646ab247":"markdown","8762130a":"markdown","a2b14415":"markdown","246bd8fd":"markdown","3828dde1":"markdown","c94c31c9":"markdown","59ae77e3":"markdown","86ed1f35":"markdown","9fe1a6fc":"markdown","17c2cbb1":"markdown","a4df91f8":"markdown","96da9308":"markdown","11405921":"markdown","4fe91753":"markdown","85754d48":"markdown","f4e7ffe2":"markdown","3ba683d7":"markdown","fdc33ff9":"markdown"},"source":{"ec3b8d42":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","7818cf69":"data=pd.read_csv('..\/input\/new-york-ecommerce-customers\/Ecommerce Customers')","ea6831c1":"data.head()","d360a041":"print(\"The number of rows in the data are :\",data.shape[0])\nprint(\"The number of columns in the data are :\",data.shape[1])","cdbe72cb":"print(\"There are\",data.size,\"entities in the dataset\")","99e29dfe":"numcols=['Avg. Session Length','Time on App','Time on Website','Length of Membership','Yearly Amount Spent']","f28f7493":"data.describe()","4ea03853":"for i in numcols:\n    print('\\n',i)\n    print(\"1st quantile:\",data[i].quantile(0.25),\"\\nThird quantile:\",data[i].quantile(0.75),\"\\nMedian:\",data[i].quantile(0.5),\"\\nIQR:\",data[i].quantile(0.75)-data[i].quantile(0.25),'\\nUpper Whisker:',data[i].quantile(0.75)+1.5*(data[i].quantile(0.75)-data[i].quantile(0.25)),'\\nLower Whisker:',data[i].quantile(0.25)-1.5*(data[i].quantile(0.75)-data[i].quantile(0.25)))","17c10463":"data.info()","8808a89c":"print(\"The categorical variables in the data set are:\")\nfor i in data.select_dtypes(include='object').columns:\n    print(i)","e91b6690":"print(\"The numerical variables in the data set are:\")\nfor i in data.select_dtypes(exclude='object').columns:\n    print(i)","532f68fb":"catcols=['Email','Address','Avatar']","0f8579b0":"data['Avatar'].value_counts()","071b3d7d":"data.info()","ff189cf8":"data[numcols]","d1fad570":"f,ax=plt.subplots(2,2,figsize=(12,12))\nsns.boxplot(data['Avg. Session Length'],ax=ax[0][0])\nsns.boxplot(data['Time on App'],ax=ax[0][1])\nsns.boxplot(data['Time on Website'],ax=ax[1][0])\nsns.boxplot(data['Length of Membership'],ax=ax[1][1])\n","d68cb161":"sns.boxplot(data['Yearly Amount Spent'])","9eb9127f":"data['Yearly Amount Spent'].plot(kind='kde')","f4af70dd":"print('Skewness:',data['Yearly Amount Spent'].skew(),'\\nKurtosis:',data['Yearly Amount Spent'].kurtosis())","e463bdec":"data.corr()","37e01342":"sns.heatmap(data.corr(),annot=True)","635e053e":"sns.pairplot(data)","06d5b1bc":"f,ax=plt.subplots(2,2,figsize=(12,12))\nsns.scatterplot(data['Avg. Session Length'],data['Yearly Amount Spent'],ax=ax[0][0])\nsns.scatterplot(data['Time on App'],data['Yearly Amount Spent'],ax=ax[0][1])\nsns.scatterplot(data['Time on Website'],data['Yearly Amount Spent'],ax=ax[1][0])\nsns.scatterplot(data['Length of Membership'],data['Yearly Amount Spent'],ax=ax[1][1])","a35d1c90":"from sklearn.model_selection import train_test_split","d88f84f9":"X=data[numcols]","02a325df":"X.drop('Yearly Amount Spent',axis=1,inplace=True)","c6c3e893":"X","b24c078b":"y=data['Yearly Amount Spent']","6a078543":"Xtrain,Xtest,ytrain,ytest=train_test_split(X,y,test_size=0.3,random_state=42)","6057335c":"import warnings \nwarnings.filterwarnings('ignore')\nimport statsmodels.api as sm\n\nX_constant = sm.add_constant(X)\nbase_model_lin_reg = sm.OLS(y,X_constant).fit()\nbase_model_lin_reg.summary()","8963f1c5":"import statsmodels.api as sm\nsm.stats.diagnostic.linear_rainbow(res=base_model_lin_reg, frac=0.5) \n\nimport scipy.stats as stats\nimport pylab\nfrom statsmodels.graphics.gofplots import ProbPlot\nresidual = base_model_lin_reg.get_influence().resid_studentized_internal\nstats.probplot(residual, dist=\"norm\", plot = pylab)\nplt.show()","e6624a73":"import statsmodels.stats.api as sms\nfrom statsmodels.compat import lzip","829cef6d":"name = ['F statistic', 'p-value']\ntest = sms.het_goldfeldquandt(base_model_lin_reg.resid, base_model_lin_reg.model.exog) \nlzip(name, test)\n","d01f9277":"from statsmodels.stats.outliers_influence import variance_inflation_factor\nvif = [variance_inflation_factor(X_constant.values, i) for i in range(X_constant.shape[1])]\npd.DataFrame({'vif': vif[1:]}, index=X.columns).T","3d4b93f0":"from sklearn.linear_model import LinearRegression\nlinear_regression=LinearRegression()\nmodel=linear_regression.fit(Xtrain,ytrain)","6ac9d55f":"model.score(Xtest,ytest)","fcd6e1e1":"ypred=model.predict(Xtest)","8e825753":"ypredtrain=model.predict(Xtrain)","b019add2":"from sklearn import metrics","810c203d":"metrics.r2_score(ytest,ypred)","4ba5bccf":"datanew=data","ffce3a9d":"data","628cb7a6":"datanew","50b1a493":"datanew1=data","9d92bd1d":"print(\"The root mean squared Error value is \",metrics.mean_squared_error(ytest,ypred)**0.5)","17db68b1":"print(\"The mean abosulte percent Error value is \",metrics.mean_absolute_error(ytest,ypred))","d0682c19":"MAPE= np.mean(np.abs((ytest-ypred)\/ytest))*100\nprint('MAPE value: ',MAPE)","fccbbb3f":"Ypred=list(ypredtrain)+list(ypred)","ce937c04":"len(Ypred)","2e4f7a15":"datanew1=Ypred","b7e388c5":"datanew1=data","5ef9ae34":"datanew1['Predicted']=Ypred","cbad2821":"datanew1","1ddc495a":"from sklearn.ensemble import RandomForestRegressor \n  \n # create regressor object \nregressor = RandomForestRegressor(n_estimators = 100, random_state = 0) \n  \n# fit the regressor with x and y data \nregressor.fit(X, y) ","0f1d7945":"y_pred=regressor.predict(Xtest)","1319c19b":"metrics.r2_score(ytest,y_pred)","20c289c6":"#### Assumption of Multicollinearity","ef311cd6":"### 5. Split dataset into train and test (70:30)","dfd499a9":"##### From the above box plots, we can see that there are very few outliers in the varibale","5faa02ad":"### Using Ensemble technique With RandomForest Regressor, we have got an highest accuracy of 99.2%","8d0dd2dd":"#### Assumption of Linearity of residuals.","a677d1f8":"### 2. Summarize important observations from the data set","e049adb2":"With Linear Regression, we got an accuracy of 98.08% but with RandomForest Regressor,we have achieved a highest accuracy of 99.2%, where Random forest has created multiple models and choosed an aggregate value from the number of models estimated.","098690bf":"With SKLearn linear model, we got an accuracy of ","1a710c5f":"##### No variables in the dataset contains any Missing values.","204a394d":"#### From the above correlation plot, there is a considerbale significant relationship between the variables 'Time on App' and 'Yearly Amount Spent'\nWhich means that, people who are spening more the app, are more interested to use the app and tend to subscribe more in a year and hence the amount spent in a year also increses.\n#### Also, the variable 'Length of Membership' show a strong positive correlation with the target varibale 'Yearly Amount Spent'\nThis tells us that higher the time period of the membership, higher the amount spent in that year.\n#### The variable 'Time on website' Shows least or zero correlation with the target variable.\n#### There is no correlation within the independent variable\nWhich is, there is no multicollinearity within the independent variables.","c582f486":"#### Assumption of normality of residuals.\n\n#### Jarque-Bera test value from the above summary will give us trhe result of the assumption. Since the value is 0.18, close to zero, we can conclude that the residuals are normally distributed.","580d2acd":"##### The kurtosis of the distribution is leptokurtic.","646ab247":"The busines should be concentrating on retaining the customers who are long terms members.\n\nIt should also improve the app interface\/features to increase the the time spent on the App, which will tend to increase their term and usablity\n\nThe website should be maitained properly, since the users spend very less time in the website. Hence the business should focus on establishing a better website to improve the yearly ","8762130a":"#### The most significant variables are Time on App,Length of Membership.","a2b14415":"##### The target variable in our data set 'Yearly Amount Spent' is normally distributed. The metrics of the distribution are given below","246bd8fd":"### How do you improve the accuracy of the model? Write clearly the changes that you will make before re-fitting the model. Fit the final model.","3828dde1":"#### Assumption of Auto Correlation\n\n\n**From the above model summary, The Durbin Watson test shows a value of 1.887. Which shows that there is no autocorrelation**","c94c31c9":"#### The variables Avg. Session length and Time on app. shows little correlation with the target variable\n#### The varibale Length of Membership shows the highest correlation with the target variable.","59ae77e3":"### Summarize as follows","86ed1f35":"### 3. Check for defects in the data. Perform necessary actions to \u2018fix\u2019 these defects","9fe1a6fc":"#### Summarize the overall fit of the model and list down the measures to prove that it is a good model","17c2cbb1":"#### Assumption of Homoscedasticity","a4df91f8":"#### Write down a business interpretation\/explanation of the model \u2013 which variables are affecting the target the most and explain the relationship. Feel free to use charts or graphs to explain.","96da9308":"## Assumptions fro Linear Regression","11405921":"The Coeffecients of the variables 'Avg. Session Length' 'Time on App' 'Time on Website' 'Length of Membership' are 25,37,0.4,61\n\nThis means that increase of one unit in 'Avg. Session Length' is related with 25 more dollars,\nincrease of one unit in Time on App is related wiht 37 more dollars,\nincrease of one unit in Time on Website is related with 0.4 more dollars,\nincrease of one unit in Length of Membership is related wiht 61 more dollars.\n\n","4fe91753":"#### Since the p-value is >0.05, we can conclude that the data is in favour of homoscedasticity.","85754d48":"#### From the above probplot, we can conclode that the residuals are linear.","f4e7ffe2":"### 4. Summarize relationships among variables","3ba683d7":"#### From the above model summary, we got a very high condition number. To verify it we are doing a VIF test. VIF test clearly indicated that there is no multicollinearity with the data. This can be manually verified using Heatmap.","fdc33ff9":"There were no changes form the base model, as the same features which were used in the base model were used throughout.\nThe RandomForest Algorithm has given us better results than the base model."}}