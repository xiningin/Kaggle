{"cell_type":{"c49b93eb":"code","a3f70dbf":"code","1249a8fc":"code","7ab186c4":"code","9706038c":"code","216118b5":"code","c07f27eb":"code","4981ef63":"markdown","7bacc8e4":"markdown","0548b045":"markdown","fb96d039":"markdown","d3faae6a":"markdown","3be59d3c":"markdown","4e4f059f":"markdown","404e21f7":"markdown","14f1e035":"markdown"},"source":{"c49b93eb":"!pip install tensorflow_io","a3f70dbf":"import os\nimport pandas as pd\nimport numpy as np\nimport cv2\nimport matplotlib.pyplot as plt\nimport tensorflow as tf\nimport tensorflow_io as tfio","1249a8fc":"# Reading DICOM images\n\ndef read_dicom(path):\n    image_bytes = tf.io.read_file(path)\n    image = tfio.image.decode_dicom_image(\n        image_bytes, \n        dtype = tf.uint16\n    )\n    \n    image = tf.squeeze(image, axis = 0)\n    \n    image = tf.image.resize(\n        image, \n        (500, 500), \n        preserve_aspect_ratio = True\n    )\n    \n    image = image - tf.reduce_min(image)\n    image = image \/ tf.reduce_max(image)\n    image = tf.cast(image * 255, tf.uint8)\n    \n    return image","7ab186c4":"fpath = \"..\/input\/vinbigdata-chest-xray-abnormalities-detection\/train\/000434271f63a053c4128a0ba6352c7f.dicom\"\nimage = read_dicom(fpath)\n\nplt.figure(figsize = (18, 4))\n\nplt.subplot(1, 2, 1)\nplt.axis(\"off\")\nplt.title(\"Original\")\nplt.imshow(image, cmap = \"gray\");\n\nplt.subplot(1, 2, 2)\nhist, bins = np.histogram(image.numpy().flatten(), 256, [0, 256])\ncdf = hist.cumsum()\ncdf_normalized = cdf * float(hist.max()) \/ cdf.max()\nplt.plot(cdf_normalized, color = 'b')\n\nplt.hist(image.numpy().flatten(), 256, [0, 256], color = 'r')\nplt.xlim([0, 256])\nplt.legend(('cdf', 'histogram'), loc = 'upper left')\nplt.title(\"Original\")\nplt.show();","9706038c":"plt.figure(figsize = (18, 4))\n\nplt.subplot(1, 2, 1)\nplt.axis(\"off\")\nplt.title(\"Histogram Equalization\")\n\nimg_he = cv2.equalizeHist(image.numpy())\n\nplt.imshow(img_he, cmap = \"gray\");\n\nplt.subplot(1, 2, 2)\nhist, bins = np.histogram(img_he.flatten(), 256, [0, 256])\ncdf = hist.cumsum()\ncdf_normalized = cdf * float(hist.max()) \/ cdf.max()\nplt.plot(cdf_normalized, color = 'b')\n\nplt.hist(img_he.flatten(), 256, [0, 256], color = 'r')\nplt.xlim([0, 256])\nplt.legend(('cdf', 'histogram'), loc = 'upper left')\nplt.title(\"Histogram Equalization\")\nplt.show();","216118b5":"plt.figure(figsize = (18, 4))\n\nplt.subplot(1, 2, 1)\nplt.axis(\"off\")\nplt.title(\"Contrast Limited Adaptive Histogram Equalization\")\n\nclahe = cv2.createCLAHE(\n    clipLimit = 2., \n    tileGridSize = (10, 10)\n)\n    \nimg_clahe = clahe.apply(image.numpy()) \n\nplt.imshow(img_clahe, cmap = \"gray\");\n\nplt.subplot(1, 2, 2)\nhist, bins = np.histogram(img_clahe.flatten(), 256, [0, 256])\ncdf = hist.cumsum()\ncdf_normalized = cdf * float(hist.max()) \/ cdf.max()\nplt.plot(cdf_normalized, color = 'b')\n\nplt.hist(img_clahe.flatten(), 256, [0, 256], color = 'r')\nplt.xlim([0, 256])\nplt.legend(('cdf', 'histogram'), loc = 'upper left')\nplt.title(\"Contrast Limited Adaptive Histogram Equalization\")\nplt.show();","c07f27eb":"plt.figure(figsize = (18, 4))\n\nplt.subplot(1, 3, 1)\nplt.axis(\"off\")\nplt.title(\"Original\")\nplt.imshow(image, cmap = \"gray\");\n\nplt.subplot(1, 3, 2)\nplt.axis(\"off\")\nplt.title(\"Histogram Equalization\")\nplt.imshow(img_he, cmap = \"gray\");\n\nplt.subplot(1, 3, 3)\nplt.axis(\"off\")\nplt.title(\"Contrast Limited Adaptive Histogram Equalization\")\nplt.imshow(img_clahe, cmap = \"gray\");","4981ef63":"## Visualization","7bacc8e4":"### Histogram Equalization\nThis method usually increases the global contrast of images. This is done by redistributing pixel intensity.","0548b045":"### Summary","fb96d039":"A disadvantage of the method is that it is indiscriminate. It may increase the contrast of background noise.","d3faae6a":"### Contrast Limited Adaptive Histogram Equalization\nTechnique to improve the contrast of an image. It differs from ordinary histogram equalization in the respect that the adaptive method computes several histograms, each corresponding to a distinct section of the image, and uses them to redistribute the lightness values of the image. Additionally, it prevents over amplification of noise.","3be59d3c":"### Original","4e4f059f":"## Import libraries","404e21f7":"# VinBigData Chest X-ray Abnormalities Detection\nAutomatically localize and classify thoracic abnormalities from chest radiographs\n\n#### The aim of this notebook is to explore the histogram equalization technique and it's variant.","14f1e035":"## Read DICOM images"}}