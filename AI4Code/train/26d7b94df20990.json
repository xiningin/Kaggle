{"cell_type":{"73b54084":"code","8554199c":"code","17f5d978":"code","f46fa42c":"code","c362d1be":"code","81d163ec":"code","2965c118":"code","97c10aa2":"code","c0152aff":"code","1911ba54":"code","c5cf97eb":"code","dad59f6c":"code","73da70b6":"code","46f9993d":"code","46bcca45":"code","0695da63":"code","8a565ef3":"code","5f2d50bb":"code","8b8b055e":"code","e0c16f96":"code","7dc681f6":"code","33033048":"code","c2f775ad":"code","a69ef9c2":"code","c1f26a54":"code","3a9b0f90":"code","03949035":"code","dfdfeafc":"code","d1a6850b":"code","a27079cf":"code","294eac88":"code","951273da":"code","9f160671":"code","34a17f67":"code","ebd10175":"code","242c8eaf":"code","e47caddc":"code","968f2336":"code","f2fdf150":"code","71745aa1":"code","5734e071":"code","3cddbd4e":"code","55bd1761":"code","39ebb8a3":"code","d82fcf44":"code","5b440481":"code","9b2787c5":"code","09c1d60c":"code","f90365ef":"code","e7fe4ced":"code","f8fb0a58":"code","9f333133":"markdown","75240437":"markdown","17329dea":"markdown","9a79e166":"markdown","0c02d2fe":"markdown","4c169a76":"markdown","fde97d53":"markdown","dc27695b":"markdown","6c4287a3":"markdown","da2ff837":"markdown","697773fc":"markdown","f9c59d88":"markdown","bebd92ee":"markdown","012136f8":"markdown","c127f7ae":"markdown","ec49220d":"markdown","1d4b6aa7":"markdown","5dd1bafb":"markdown","e9765b0b":"markdown","a23d087e":"markdown","10f39b3d":"markdown","c142323a":"markdown","0d0ceef7":"markdown","fe5e4073":"markdown","8eb2bbd6":"markdown","7b375694":"markdown","41b3ca67":"markdown","2693672e":"markdown","30fc3f8e":"markdown"},"source":{"73b54084":"import numpy as np \nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\n%matplotlib inline","8554199c":"df = pd.read_csv('..\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv')","17f5d978":"df.info()","f46fa42c":"df.head()","c362d1be":"df.columns","81d163ec":"df.corr()","2965c118":"sns.heatmap(df.corr(), annot=True)","97c10aa2":"df.isnull().sum()","c0152aff":"df.info()","1911ba54":"df.select_dtypes(include='object')","c5cf97eb":"df_num= df.select_dtypes(exclude='object')\ndf_obj= df.select_dtypes(include='object')","dad59f6c":"df_num.info()","73da70b6":"df_obj.info()","46f9993d":"# Converting objects to number by one-hot encoding(drop_first=True:removes multi-collinearity)\ndf_obj= pd.get_dummies(df_obj, drop_first=True)","46bcca45":"Final_df= pd.concat([df_num, df_obj], axis=1)","0695da63":"Final_df.head()","8a565ef3":"plt.figure(figsize=(12,6))\nsns.histplot(data=Final_df, x='Age')","5f2d50bb":"plt.figure(figsize=(10,10))\nsns.countplot(x='Gender_Male', data=Final_df)","8b8b055e":"plt.figure(figsize=(12, 6))\nsns.histplot(data=Final_df, x='Annual Income (k$)')","e0c16f96":"plt.figure(figsize=(12, 6))\nsns.histplot(data=Final_df, x='Spending Score (1-100)')","7dc681f6":"plt.figure(figsize=(20, 15))\nsns.countplot(data=Final_df, x='Spending Score (1-100)', hue='Gender_Male' )\nplt.legend(loc=(1.1, 0.5))","33033048":"plt.figure(figsize=(20,8))\nsns.barplot(x='Annual Income (k$)',y='Spending Score (1-100)',data=Final_df)","c2f775ad":"plt.figure(figsize=(20,8))\nsns.barplot(x='Age',y='Annual Income (k$)',data=Final_df)","a69ef9c2":"from sklearn.preprocessing import StandardScaler","c1f26a54":"scaler = StandardScaler()","3a9b0f90":"scaled_X= scaler.fit_transform(Final_df) ","03949035":"scaled_X","dfdfeafc":"from sklearn.cluster import KMeans","d1a6850b":"model = KMeans(n_clusters=2)","a27079cf":"cluster_labels= model.fit_predict(scaled_X)","294eac88":"cluster_labels","951273da":"len(scaled_X)","9f160671":"len(cluster_labels)","34a17f67":"Final_df['Cluster']=cluster_labels","ebd10175":"sns.heatmap(Final_df.corr(), annot=True)","242c8eaf":"Final_df.corr()['Cluster'].sort_values()","e47caddc":"plt.figure(figsize=(15,6))\nFinal_df.corr()['Cluster'].sort_values().plot(kind='bar')","968f2336":"ssd= []\n\nfor k in range (2, 10):\n    model=KMeans(n_clusters=k)\n    \n    model.fit(scaled_X)\n    #inertia:caculate ssd\n    ssd.append(model.inertia_) ","f2fdf150":"ssd","71745aa1":"plt.plot(range(2,10), ssd, 'o--')\nplt.xlabel('K Value')\nplt.ylabel('Sum of Squared Distances')","5734e071":"pd.Series(ssd).diff()","3cddbd4e":"pd.Series(ssd).diff().plot(kind='bar')","55bd1761":"new_model = KMeans(n_clusters=5)","39ebb8a3":"new_cluster_labels= new_model.fit_predict(scaled_X)","d82fcf44":"new_cluster_labels","5b440481":"Final_df['Cluster']=new_cluster_labels","9b2787c5":"X = Final_df.iloc[:,[2,3,4]].values","09c1d60c":"X[:5]","f90365ef":"y= new_model.fit_predict(X)","e7fe4ced":"y","f8fb0a58":"fig = plt.figure(figsize = (10,10))\nax = fig.add_subplot(111, projection='3d')\nax.scatter(X[y == 0,0],X[y == 0,1],X[y == 0,2], s = 40 , color = 'red', label = \"cluster 1\")\nax.scatter(X[y == 1,0],X[y == 1,1],X[y == 1,2], s = 40 , color = 'blue', label = \"cluster 2\")\nax.scatter(X[y == 2,0],X[y == 2,1],X[y == 2,2], s = 40 , color = 'green', label = \"cluster 3\")\nax.scatter(X[y == 3,0],X[y == 3,1],X[y == 3,2], s = 40 , color = 'yellow', label = \"cluster 4\")\nax.scatter(X[y == 4,0],X[y == 4,1],X[y == 4,2], s = 40 , color = 'purple', label = \"cluster 5\")\nax.set_xlabel('Age of a customer-->')\nax.set_ylabel('Anual Income-->')\nax.set_zlabel('Spending Score-->')\nax.legend()\nplt.show()","9f333133":"# Scaling the features","75240437":"**after dummy variables we know that 0=female and 1=male so females has had more shopping in this mall**","17329dea":"**people in 40 has the most Annual Income**","9a79e166":"**the data set is ready**","0c02d2fe":"**EDA is very important in Unsupervised learning because it helps to have more domain knowledge.**","4c169a76":"**now our data set has label.**","fde97d53":"**it shows the relationship between Annual Income and Spending Score. and as it seems people with highest income have shopped  the same or even less that average people.**","dc27695b":"# Data Cleaning","6c4287a3":"**there is no special correlations**","da2ff837":"**Most of the customers have the Annual income of less that 80000 dollors.**","697773fc":"**women in 40 are really intested in shopping :)**","f9c59d88":"**it seems k=5 is a good choice because we see a significantly drop in the curve**","bebd92ee":"**as you see k=5 is a good choice for clustering**\n\n**Cluster 2 are people aged less than 40 with very high annual incomes, them having a high spending score makes sense. So, to keep this going on, these people could be given better offers to attract them.**\n\n**Cluster 2 & 4 are the best choice to attract them with offers to buy from the mall**","012136f8":"# Choosing K value","c127f7ae":"# Exploratory Data Analysis","ec49220d":"**most of the customers have spending score around of 50.**","1d4b6aa7":"# data overview","5dd1bafb":"# Unsupervised Learning(k-means)","e9765b0b":"**people at the age between 30-35 has the most shopping at this mall**","a23d087e":"### creating Dummy Variables","10f39b3d":"**luckily there is no missing value**","c142323a":"# K-Means Clustering\n\n* the main concept of this algorithm is really simple.\n\n* Each point must belong to a cluster and each point can belong to only one cluster.\n\n## k-mean steps:\n\n1. choosing K(Cluster number)\n\n1. Randomly select K distinct data point.named them as our cluster points.\n\n1. assing each remaining point to the nearest cluster points.\n\n1. Calculate the center of the cluster points( mean value of each point vector).\n\n1. assign each point to the nearest cluster center.\n\n1. repeat steps 4 and 5 until there is no reassignment.\n\n\n## choosing K value:\n\n**how can we measure goodness of fit?**\n\n1. choose a random K( usually K=2)\n\n1. Measure SSD(Square Sum of the distance)\n\n1. then we fit an entirely new Kmeans model with K+1\n\n1. then measure again the SSD for K+1\n\n1. repeat\n\ntheorically by increase of K(K equalls to data points), we have Decrease in SSD to Zero.\n\nin action we keep track of this SSD for a range of different K values until the **rate of the reduction in SSD** begins to decline. and it shows that adding extra cluster is **not** obtaining enough clarity of cluster separatin to justify increasing K **(Elbow method)**.","0d0ceef7":"**we want to do Mall Customer Segmentation Data. this data set also known as market basket analysis. I will demonstrate this by using unsupervised ML technique (KMeans Clustering Algorithm) in the simplest form.**\n\n### Content\n\n**You are owing a supermarket mall and through membership cards , you have some basic data about your customers like Customer ID, age, gender, annual income and spending score.\nSpending Score is something you assign to the customer based on your defined parameters like customer behavior and purchasing data.**\n\n### Problem Statement\n\n**You own the mall and want to understand the customers like who can be easily converge [Target Customers] so that the sense can be given to marketing team and plan the strategy accordingly.**\n\n### Inspiration\n**By the end of this case study , you would be able to answer below questions.**\n1.  How to achieve customer segmentation using machine learning algorithm (KMeans Clustering) in Python in simplest way.\n1.  Who are your target customers with whom you can start marketing strategy [easy to converse]\n1.  How the marketing strategy works in real world","fe5e4073":"\n\n**we need to be more creative in these problems, because we don't have label and we have to discover the pattern.**\n\n**there is two types of Unsupervised Learning:**\n1.  Clustering: using features, group together\n1. Dimensionality Reduction: merge the features to have component","8eb2bbd6":"# Clustering:\n\n**looking for the similarity between these unlabeled data and the segment them into separate cluster.**\n\n**we only have features.**\n\n**Cluster doesn't label these clusters for us. we have to recognize the cluster labels based on our domain knowledge from data set in real world after clustering.**\n\n**if we were sure about the discovered label, we can change the problem to the supervised learning on new data points.**","7b375694":"# Creating the model(K-means)","41b3ca67":"**Note: Supervised performance metrics will not apply for Unsupervised Learning**","2693672e":"# building model with new K value","30fc3f8e":"**annual income has the most correlation with cluster**"}}