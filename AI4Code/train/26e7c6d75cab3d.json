{"cell_type":{"d999d23b":"code","ef4b5d00":"code","9c2c1758":"code","7f903b57":"code","047d7875":"code","6f95e84b":"code","5080466f":"code","83ff244f":"code","5080c48b":"code","834a42d6":"code","b426d4af":"code","9acf05ea":"code","78cedde7":"code","91de3d05":"code","8d1d4f3f":"code","f17482f5":"code","c8ebdbfb":"code","04380d20":"code","942ac1ec":"code","60a4e006":"code","74ed45d9":"code","0d0eb384":"code","14ac870b":"code","b3fe00d3":"code","f7e99e27":"code","b227ef1e":"code","a6b21b8d":"code","a0a4976e":"code","7f4eaf07":"code","ff34efad":"code","07451b4f":"code","06a139d7":"code","062e94c0":"code","da2d1569":"code","78472685":"code","4df752b9":"code","6dda3bcc":"code","b67eb8d0":"code","25ba7a7e":"code","e4454875":"code","845cad6c":"code","26cf19bd":"markdown","1c97fefd":"markdown","0bafffe0":"markdown","afb14664":"markdown","821637b6":"markdown","d469d214":"markdown","6cb75ceb":"markdown","82d5065d":"markdown"},"source":{"d999d23b":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport plotly.express as px\npd.set_option('display.max_columns', None)\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.preprocessing import StandardScaler, LabelEncoder\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.naive_bayes import BernoulliNB\nfrom sklearn.ensemble import VotingClassifier\nfrom catboost import CatBoostClassifier, Pool\nfrom lightgbm import LGBMClassifier\nimport optuna","ef4b5d00":"train = pd.read_csv('..\/input\/tabular-playground-series-may-2021\/train.csv')\ntrain.head()","9c2c1758":"test = pd.read_csv('..\/input\/tabular-playground-series-may-2021\/test.csv')\ntest.head()","7f903b57":"sample_submission = pd.read_csv('..\/input\/tabular-playground-series-may-2021\/sample_submission.csv')\nsample_submission.head()","047d7875":"train.drop('id', axis=1, inplace= True)","6f95e84b":"test.drop('id', axis=1, inplace= True)","5080466f":"train.describe().T\\\n        .style.bar(subset=['mean'], color=px.colors.qualitative.G10[0])\\\n        .background_gradient(subset=['std'], cmap='Greens')\\\n        .background_gradient(subset=['50%'], cmap='BuGn')","83ff244f":"for i in train.columns:\n  train[i] = pd.Categorical(train[i])","5080c48b":"for i in test.columns:\n  test[i] = pd.Categorical(test[i])","834a42d6":"train.shape","b426d4af":"test.shape","9acf05ea":"train.isnull().sum()","78cedde7":"test.isnull().sum()","91de3d05":"n_rows = 11\nn_cols = 5\ninit = 1\nfeatures = train.columns.values\n\nfig = plt.figure(figsize=(100,90))\n\nfor i in features:\n    plt.subplot(n_rows, n_cols, init)\n    plt.xlabel(i)\n    sns.countplot(data=train, x=train[i])\n    init = init + 1\nplt.show()","8d1d4f3f":"n_rows = 10\nn_cols = 5\ninit = 1\nfeatures = test.columns.values\n\nfig = plt.figure(figsize=(100,90))\n\nfor i in features:\n    plt.subplot(n_rows, n_cols, init)\n    plt.xlabel(i)\n    sns.countplot(data=train, x=train[i])\n    init = init + 1\nplt.show()","f17482f5":"X = train.iloc[:,0:50]\ny = train.iloc[:,50:]","c8ebdbfb":"label = LabelEncoder()\ny = label.fit_transform(y)","04380d20":"X_train,X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state = 42)","942ac1ec":"lgbm = LGBMClassifier(objective='multiclass', n_estimators = 1000, learning_rate=0.05,num_leaves=125, max_depth=17, reg_alpha= 7.704678722351078,\n                   reg_lambda= 24.86952078162094, colsample_bytree= 0.07893216649715043, subsample= 0.1052205406887246, cat_smooth= 30.802384732840533)\nlgbm.fit(X_train,y_train)","60a4e006":"lgbm.score(X_test,y_test)","74ed45d9":"bnb = BernoulliNB()\nbnb.fit(X_train,y_train)","0d0eb384":"bnb.score(X_test,y_test)","14ac870b":"params_bnb = {\n    'alpha': [1.0,2.0,3.0,4.0,5.0,6.0,7.0,8.0]\n}","b3fe00d3":"bnb_search = GridSearchCV(bnb, params_bnb)\nbnb_search.fit(X_train,y_train)","f7e99e27":"bnb = bnb_search.best_estimator_","b227ef1e":"bnb","a6b21b8d":"bnb_search.best_score_","a0a4976e":"bnb.fit(X_train,y_train)","7f4eaf07":"bnb.score(X_test,y_test)","ff34efad":"cat_features = ['feature_0', 'feature_1', 'feature_2', 'feature_3', 'feature_4',\n       'feature_5', 'feature_6', 'feature_7', 'feature_8', 'feature_9',\n       'feature_10', 'feature_11', 'feature_12', 'feature_13', 'feature_14',\n       'feature_15', 'feature_16', 'feature_17', 'feature_18', 'feature_19',\n       'feature_20', 'feature_21', 'feature_22', 'feature_23', 'feature_24',\n       'feature_25', 'feature_26', 'feature_27', 'feature_28', 'feature_29',\n       'feature_30', 'feature_31', 'feature_32', 'feature_33', 'feature_34',\n       'feature_35', 'feature_36', 'feature_37', 'feature_38', 'feature_39',\n       'feature_40', 'feature_41', 'feature_42', 'feature_43', 'feature_44',\n       'feature_45', 'feature_46', 'feature_47', 'feature_48', 'feature_49']","07451b4f":"cat = CatBoostClassifier(task_type='GPU', cat_features= cat_features, verbose=False, depth=4,\n            max_ctr_complexity=15,\n            iterations=50000,\n            od_wait=1000, \n            od_type='Iter',\n            learning_rate=0.01,\n            min_data_in_leaf=1,\n            #use_best_model=True,\n            loss_function='MultiClass')","06a139d7":"# cat = CatBoostClassifier(task_type='GPU', \n#             cat_features= cat_features, \n#             verbose=False, \n#            # depth=4,\n#             max_ctr_complexity=15,\n#             iterations=50000,\n#             od_wait=1000, \n#             od_type='Iter',\n#             learning_rate= 0.03748196035681244,\n#             reg_lambda = 13.796757401995501,\n#             subsample =  0.374946416768779,\n#             random_strength =  0.5160756387634352,\n#             depth= 6,\n#             min_data_in_leaf= 48,\n#             num_leaves = 44,\n#             leaf_estimation_iterations=1,             \n#             #learning_rate=0.01,\n#            # min_data_in_leaf=1,\n#             #use_best_model=True,\n#             loss_function='MultiClass')","062e94c0":"#cat.fit(X_train,y_train, eval_set=(X_test,y_test), plot=True)\ncat.fit(X_train,y_train, plot=True)","da2d1569":"cat.score(X_test,y_test)","78472685":"cat.get_all_params()","4df752b9":"vote = VotingClassifier([('lgbm', lgbm),('bnb',bnb),('cat',cat)], voting='soft')","6dda3bcc":"vote.fit(X_train,y_train)","b67eb8d0":"vote.score(X_test,y_test)","25ba7a7e":"probability_predictions= vote.predict_proba(test)\nprobability_predictions","e4454875":"sample_submission.iloc[:,1:5] = probability_predictions\nsample_submission","845cad6c":"sample_submission.to_csv('submission.csv',index=False)","26cf19bd":"# Exploratory Data Analysis (EDA)","1c97fefd":"# Model Building","0bafffe0":"# Import Libraries","afb14664":"## LGBM","821637b6":"# Load train and test dataset","d469d214":"## CatBoost","6cb75ceb":"## BernoulliNB","82d5065d":"# Submission"}}