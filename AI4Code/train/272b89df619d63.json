{"cell_type":{"eb4ead82":"code","4e940148":"code","483c5649":"code","36c216f0":"code","cef42584":"code","4048cb46":"code","05195a7b":"code","36119224":"code","f35e4ccc":"code","16d891b9":"code","a4438150":"code","55b797f3":"code","d6cd59f8":"code","490d3e88":"code","04e85625":"code","d5076b81":"code","e99c8b81":"code","cf11a92b":"code","039a4745":"code","c4cd9d3b":"code","6aea9a78":"code","c68435f1":"code","d3a830dd":"markdown","e5590dbc":"markdown","ba19aa9f":"markdown","e732d208":"markdown","03ff4f18":"markdown","3478e83c":"markdown","0414a66d":"markdown","fc248ec4":"markdown","1d5cb5e5":"markdown","f35cbf8d":"markdown"},"source":{"eb4ead82":"# necessary imports \n\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nimport warnings\nwarnings.filterwarnings('ignore')\n\nplt.style.use('fivethirtyeight')\n%matplotlib inline","4e940148":"df = pd.read_csv('..\/input\/churn-modelling\/Churn_Modelling.csv')\ndf.head()","483c5649":"df.describe()","36c216f0":"df.info()","cef42584":"# checking for null values\n\ndf.isna().sum()","4048cb46":"values = df.Exited.value_counts()\nlabels = ['Not Exited', 'Exited']\n\nfig, ax = plt.subplots(figsize = (4, 3), dpi = 100)\nexplode = (0, 0.09)\n\npatches, texts, autotexts = ax.pie(values, labels = labels, autopct = '%1.2f%%', shadow = True,\n                                   startangle = 90, explode = explode)\n\nplt.setp(texts, color = 'grey')\nplt.setp(autotexts, size = 8, color = 'white')\nautotexts[1].set_color('black')\nplt.show()","05195a7b":"# visualizing categorical variables\n\nfig, ax = plt.subplots(3, 2, figsize = (18, 15))\n\nsns.countplot('Geography', hue = 'Exited', data = df, ax = ax[0][0])\nsns.countplot('Gender', hue = 'Exited', data = df, ax = ax[0][1])\nsns.countplot('Tenure', hue = 'Exited', data = df, ax = ax[1][0])\nsns.countplot('NumOfProducts', hue = 'Exited', data = df, ax = ax[1][1])\nsns.countplot('HasCrCard', hue = 'Exited', data = df, ax = ax[2][0])\nsns.countplot('IsActiveMember', hue = 'Exited', data = df, ax = ax[2][1])\n\nplt.tight_layout()\nplt.show()","36119224":"# visualizing continuous variables\n\nfig, ax = plt.subplots(2, 2, figsize = (16, 10))\n\nsns.boxplot(x = 'Exited', y = 'CreditScore', data = df, ax = ax[0][0])\nsns.boxplot(x = 'Exited', y = 'Age', data = df, ax = ax[0][1])\nsns.boxplot(x = 'Exited', y = 'Balance', data = df, ax = ax[1][0])\nsns.boxplot(x = 'Exited', y = 'EstimatedSalary', data = df, ax = ax[1][1])\n\nplt.tight_layout()\nplt.show()","f35e4ccc":"# heatmap \n\nplt.figure(figsize = (20, 12))\n\ncorr = df.corr()\n\nsns.heatmap(corr, linewidths = 1, annot = True, fmt = \".2f\")\nplt.show()","16d891b9":"# dropping useless columns \n\ndf.drop(columns = ['RowNumber', 'CustomerId', 'Surname'], axis = 1, inplace = True)\ndf.head()","a4438150":"df.Geography.value_counts()","55b797f3":"# Encoding categorical variables\n\ndf['Geography'] = df['Geography'].map({'France' : 0, 'Germany' : 1, 'Spain' : 2})\ndf['Gender'] = df['Gender'].map({'Male' : 0, 'Female' : 1})","d6cd59f8":"df.head()","490d3e88":"# creating features and label \n\nfrom tensorflow.keras.utils import to_categorical\n\nX = df.drop('Exited', axis = 1)\ny = to_categorical(df.Exited)","04e85625":"# splitting data into training set and test set\n\nfrom sklearn.model_selection import train_test_split\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.25)","d5076b81":"# Scaling data\n\nfrom sklearn.preprocessing import StandardScaler\n\nsc = StandardScaler()\nX_train = sc.fit_transform(X_train)\nX_test = sc.transform(X_test)","e99c8b81":"import keras\nfrom keras.models import Sequential\nfrom keras.layers import Dense\nfrom keras.layers import Dropout\nfrom keras.layers import BatchNormalization\n\n# initializing ann\nmodel = Sequential()\n\n# adding the first input layer and the first hidden layer\nmodel.add(Dense(10, kernel_initializer = 'normal', activation = 'relu', input_shape = (10, )))\n\n# adding batch normalization and dropout layer\nmodel.add(Dropout(rate = 0.1))\nmodel.add(BatchNormalization())\n\n# adding the third hidden layer\nmodel.add(Dense(7, kernel_initializer = 'normal', activation = 'relu'))\n\n# adding batch normalization and dropout layer\nmodel.add(Dropout(rate = 0.1))\nmodel.add(BatchNormalization())\n\n# adding the output layer\nmodel.add(Dense(2, kernel_initializer = 'normal', activation = 'sigmoid'))\n\n# compiling the model\nmodel.compile(optimizer = 'adam', loss = 'binary_crossentropy', metrics = ['accuracy'])\n\n# fitting the model to the training set \n\nmodel_history = model.fit(X_train, y_train, validation_split = 0.20, validation_data = (X_test, y_test), epochs = 100)","cf11a92b":"plt.figure(figsize = (12, 6))\n\ntrain_loss = model_history.history['loss']\nval_loss = model_history.history['val_loss'] \nepoch = range(1, 101)\nsns.lineplot(epoch, train_loss, label = 'Training Loss')\nsns.lineplot(epoch, val_loss, label = 'Validation Loss')\nplt.title('Training and Validation Loss\\n')\nplt.xlabel('Epochs')\nplt.ylabel('Loss')\nplt.legend()\nplt.show()","039a4745":"plt.figure(figsize = (12, 6))\n\ntrain_loss = model_history.history['accuracy']\nval_loss = model_history.history['val_accuracy'] \nepoch = range(1, 101)\nsns.lineplot(epoch, train_loss, label = 'Training accuracy')\nsns.lineplot(epoch, val_loss, label = 'Validation accuracy')\nplt.title('Training and Validation Accuracy\\n')\nplt.xlabel('Epochs')\nplt.ylabel('Accuracy')\nplt.legend()\nplt.show()","c4cd9d3b":"acc = model.evaluate(X_test, y_test)[1]\n\nprint(f'Accuracy of model is {acc}')","6aea9a78":"model.summary()","c68435f1":"from tensorflow.keras.utils import plot_model\n\nplot_model(model, show_shapes = True)","d3a830dd":"<p style = \"font-size : 20px; color : #34656d ; font-family : 'Comic Sans MS'; \"><strong>20% of the customers have churned and 80% haven't.<\/strong><\/p> ","e5590dbc":"<p style = \"font-size : 35px; color : #34656d ; font-family : 'Comic Sans MS'; text-align : center; background-color : #f9b208; border-radius: 5px 5px;\"><strong>Visualizing Training and Validation Loss<\/strong><\/p> ","ba19aa9f":"<p style = \"font-size : 30px; color : #4e8d7c ; font-family : 'Comic Sans MS';\"><strong>From above Plots we can conclude that:-<\/strong><\/p>\n\n<ul>\n    <li style = \"color : #03506f; font-size : 18px; font-family : 'Comic Sans MS';\"><strong>Majority of the customers are from france but most customers which churned are from germany maybe because of lack of resources as there are not many customers.<\/strong><\/li>\n    <li style = \"color : #03506f; font-size : 18px; font-family : 'Comic Sans MS';\"><strong>The proportion of female customers churning is also greater than that of female customers.<\/strong><\/li>\n    <li style = \"color : #03506f; font-size : 18px; font-family : 'Comic Sans MS';\"><strong>Majority of customers have tenure between 1 to 9 and churing rate is also high between these tenures.<\/strong><\/li>\n    <li style = \"color : #03506f; font-size : 18px; font-family : 'Comic Sans MS';\"><strong>Most of the customers have 1 or 2 products and most customers which churned are having 1 products maybe they are not satisfied so they are churning.<\/strong><\/li>\n    <li style = \"color : #03506f; font-size : 18px; font-family : 'Comic Sans MS';\"><strong>Interestingly, majority of customers that churned are those with credit cards but this can be a coincidence as majority of customers have credit cards.<\/strong><\/li>\n    <li style = \"color : #03506f; font-size : 18px; font-family : 'Comic Sans MS';\"><strong>Unsurprisingly the inactive members have a greater churn and the overall proportion of inactive members is also very high.<\/strong><\/li>\n","e732d208":"<p style = \"font-size : 50px; color : #532e1c ; font-family : 'Comic Sans MS'; text-align : center; background-color : #bedcfa; border-radius: 5px 5px;\"><strong>Churn Modelling Using ANN<\/strong><\/p>","03ff4f18":"<p style = \"font-size : 35px; color : #34656d ; font-family : 'Comic Sans MS'; text-align : center; background-color : #f9b208; border-radius: 5px 5px;\"><strong>Visualizing Training and Validation accuracy<\/strong><\/p> ","3478e83c":"<p style = \"font-size : 20px; color : #34656d ; font-family : 'Comic Sans MS'; \"><strong>We can say that there is no multicolinearity present in data.<\/strong><\/p> ","0414a66d":"<p style = \"font-size : 35px; color : #34656d ; font-family : 'Comic Sans MS'; text-align : center; background-color : #f9b208; border-radius: 5px 5px;\"><strong>Exploratory Data Analysis (EDA)<\/strong><\/p> ","fc248ec4":"<p style = \"font-size : 35px; color : #34656d ; font-family : 'Comic Sans MS'; text-align : center; background-color : #f9b208; border-radius: 5px 5px;\"><strong>Building ANN <\/strong><\/p> ","1d5cb5e5":"<p style = \"font-size : 25px; color : #f55c47 ; font-family : 'Comic Sans MS'; \"><strong>If you like my work, please do Upvote.<\/strong><\/p> ","f35cbf8d":"<p style = \"font-size : 30px; color : #4e8d7c ; font-family : 'Comic Sans MS';\"><strong>From above Plots we can conclude that:-<\/strong><\/p>\n\n<ul>\n    <li style = \"color : #03506f; font-size : 18px; font-family : 'Comic Sans MS';\"><strong>There is no significant difference in credit score distribution etween custers which are churned or not.<\/strong><\/li>\n    <li style = \"color : #03506f; font-size : 18px; font-family : 'Comic Sans MS';\"><strong>The older customers are churning more than younger ones.<\/strong><\/li>\n    <li style = \"color : #03506f; font-size : 18px; font-family : 'Comic Sans MS';\"><strong>Bank is loosing customers with significant bank balance.<\/strong><\/li>\n    <li style = \"color : #03506f; font-size : 18px; font-family : 'Comic Sans MS';\"><strong>Estimated Salary does not have a significant on the likelihood to churn.<\/strong><\/li>\n    <li style = \"color : #03506f; font-size : 18px; font-family : 'Comic Sans MS';\"><strong>Interestingly, majority of customers that churned are those with credit cards but this can be a coincidence as majority of customers have credit cards.<\/strong><\/li>\n    <li style = \"color : #03506f; font-size : 18px; font-family : 'Comic Sans MS';\"><strong>Unsurprisingly the inactive members have a greater churn and the overall proportion of inactive members is also very high.<\/strong><\/li>"}}