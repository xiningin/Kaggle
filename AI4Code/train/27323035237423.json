{"cell_type":{"afab8c11":"code","09605f1c":"code","e45e86f8":"code","9952ff5e":"code","68f56c3c":"code","221c3bc5":"code","5b4f41ba":"code","5f3506ac":"code","edbc4773":"code","a3436ed2":"code","74016e0b":"code","0e24adff":"code","fcd4df46":"code","0c1d75be":"code","bfe2779b":"code","b5507c51":"code","c057eeec":"code","a6bb8dfd":"code","f15c8c8c":"code","bc1897f8":"code","cce30942":"code","30adc60d":"code","3b200fda":"code","73dcf220":"code","e1b65bd0":"code","2c1195f5":"code","f3ec2466":"code","77d83ec3":"code","2ba66aec":"code","8323a604":"code","e9c14a68":"code","f68f359d":"code","b8af05af":"code","987fbc2f":"code","423509f6":"code","ed470cea":"code","edb08ad6":"code","53b9b2fa":"code","91c11f0f":"code","483bec18":"code","7b39e4b7":"code","20488d8a":"code","199fd77b":"code","0d196c65":"code","0cdade83":"code","059b76f7":"code","418ad838":"markdown","840d4b91":"markdown","fb92d687":"markdown","0e482e88":"markdown","7cac864f":"markdown","3d24cd37":"markdown"},"source":{"afab8c11":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline","09605f1c":"df=pd.read_csv('..\/input\/imdb-dataset-of-50k-movie-reviews\/IMDB Dataset.csv')","e45e86f8":"df.head(10)","9952ff5e":"len(df)","68f56c3c":"df.describe().T","221c3bc5":"df.info()","5b4f41ba":"df.isnull().sum()  #To check for Null Value ","5f3506ac":"df.groupby('sentiment').count()","edbc4773":"df['sentiment'].value_counts().plot(kind='pie',autopct=\"%1.0f%%\")","a3436ed2":"Length_of_ds=pd.DataFrame(df['review'].apply(len))","74016e0b":"Length_of_ds.head(10)","0e24adff":"Length_of_ds.describe()","fcd4df46":"df['review'][5]","0c1d75be":"import re\nimport nltk\nfrom nltk.corpus import stopwords                   \nfrom nltk.stem.porter import PorterStemmer            #For Stemming Of words\nfrom bs4 import BeautifulSoup                         #To remove HTML Tags","bfe2779b":"corpus_bag=[]","b5507c51":"features=df.iloc[:,0]","c057eeec":"features","a6bb8dfd":"labels=df.iloc[:,1]","f15c8c8c":"labels","bc1897f8":"df['review'][0]","cce30942":"def clean_html(text):\n    soup=BeautifulSoup(text,\"html.parser\")\n    return soup.get_text()","30adc60d":"df['review']=df['review'].apply(clean_html)","3b200fda":"def clean_mess(text):\n    return re.sub('[^a-zA-Z]',\" \",text)\n    ","73dcf220":"df['review']=df['review'].apply(clean_mess)","e1b65bd0":"df['review'][1]","2c1195f5":"from sklearn.feature_extraction.text import CountVectorizer,TfidfTransformer,TfidfVectorizer\nfrom sklearn.naive_bayes import MultinomialNB\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.svm import SVC\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.metrics import confusion_matrix,classification_report,accuracy_score","f3ec2466":"cv=CountVectorizer(ngram_range=(2,2),stop_words=stopwords.words('english'))\ntfidft=TfidfTransformer()\ntfidfv=TfidfVectorizer()\nmnb=MultinomialNB()\nlogm=LogisticRegression()\n#svm_mod=SVC()\nrfc=RandomForestClassifier()\n","77d83ec3":"cv.fit_transform(features)","2ba66aec":"data1=cv.fit_transform(features)","8323a604":"data2=tfidft.fit_transform(data1)","e9c14a68":"X_train, X_test, y_train, y_test = train_test_split(data2, labels, test_size=0.3, random_state=0)","f68f359d":"mnb.fit(X_train,y_train)","b8af05af":"mnb.predict(X_test)","987fbc2f":"pred1=mnb.predict(X_test)","423509f6":"print(classification_report(y_test,pred1))","ed470cea":"print('The Acuuracy Score : ',round(accuracy_score(y_test,pred1),2))","edb08ad6":"tfidfv_cust=TfidfVectorizer(ngram_range=(2,2),stop_words=stopwords.words('english'))","53b9b2fa":"data11=tfidfv_cust.fit_transform(features)","91c11f0f":"X1_train, X1_test, y1_train, y1_test = train_test_split(data11, labels, test_size=0.2, random_state=0)","483bec18":"mnb.fit(X1_train,y1_train)","7b39e4b7":"mnb.predict(X1_test)","20488d8a":"pred11=mnb.predict(X1_test)","199fd77b":"print(classification_report(y1_test,pred11))","0d196c65":"print(confusion_matrix(y1_test,pred11))","0cdade83":"print('The Acuuracy Score : ',round(accuracy_score(y1_test,pred11),2))","059b76f7":"df_avc=pd.DataFrame({\"Actual Class\":y1_test,\"Predicted Class\":pred11})\ndf_avc.head(10)","418ad838":"### As You Can see , i have used TfidfVectoriser with Naive Bayes Theorem -MultinomialNB classifier , and it game me about 88% Accuracy","840d4b91":"## SET 2:","fb92d687":"### So Basically this dataset have some HTML Tags and do requires some cleaning and preprocessing.","0e482e88":"# Exploratory Data Analysis :","7cac864f":"#### Since Iterating through whole 50000 records will take very much time, i am limting myself for only 5000 records.","3d24cd37":"## Text Preprocessing :"}}