{"cell_type":{"4459af22":"code","7b7e2fe7":"code","18204467":"code","4e6237b8":"code","624dd995":"code","51ea4c22":"code","736376a6":"code","e66eeaa8":"markdown","49847a7d":"markdown"},"source":{"4459af22":"from transformers import TFGPT2LMHeadModel, GPT2Tokenizer","7b7e2fe7":"tokenizer = GPT2Tokenizer.from_pretrained('gpt2')\n\n## add the EOS token as PAD token to avoid warnings\n\ngpt2 = TFGPT2LMHeadModel.from_pretrained(\"gpt2\", pad_token_id=tokenizer.eos_token_id)","18204467":"input_ids = tokenizer.encode('Robotics is the domain of', return_tensors='tf')\n\noutputs = gpt2.generate(input_ids, max_length=50)\n\nprint(\"Output:\\n\"+ tokenizer.decode(outputs[0], skip_special_tokens=True))","4e6237b8":"beam_out = gpt2.generate(input_ids, max_length=50, num_beams=5, early_stopping=True)\n\nprint(\"Output:\\n\"+ tokenizer.decode(beam_out[0], skip_special_tokens=True))","624dd995":"beam_out = gpt2.generate(input_ids, \n                         max_length=50, \n                         num_beams=5, \n                         no_repeat_ngram_size=3,\n                         early_stopping=True)\n\nprint(\"Output:\\n\"+ tokenizer.decode(beam_out[0], skip_special_tokens=True))","51ea4c22":"beam_outputs = gpt2.generate(input_ids,\n                            max_length=50,\n                            num_beams=7,\n                            no_repeat_ngram_size=3,\n                            num_return_sequences=3,\n                            early_stopping=True,\n                            temperature=0.7)\n\nfor i, beam_out in enumerate(beam_outputs):\n    print(f\"Output {i+1}:\\n {tokenizer.decode(beam_out, skip_special_tokens=True)}\")","736376a6":"## Top-K sampling\n\nbeam_out = gpt2.generate(input_ids, \n                         max_length=50, \n                         do_sample=True,\n                         top_k=25,\n                         temperature=2)\n\nprint(\"Output:\\n\"+ tokenizer.decode(beam_out[0], skip_special_tokens=True))","e66eeaa8":"### Multiple Beam Outputs","49847a7d":"## Beam Search Outputs"}}