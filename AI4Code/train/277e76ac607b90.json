{"cell_type":{"59f4858b":"code","0ff37d92":"code","fc0c2936":"code","1c85a95c":"code","fe4a9c45":"code","3a4fec63":"code","f406eea5":"code","5c1d2b59":"code","b310738d":"code","fafe7af6":"code","48d39580":"code","b5baea56":"code","bc37d66d":"code","93678969":"code","3175dba2":"code","2408a2da":"code","1f60e58a":"code","6ef96f87":"code","820ea668":"code","c8028bd9":"code","4e25e7b3":"code","a4df606d":"code","1a4954eb":"code","e7065b67":"code","50897006":"code","5183d774":"code","d2a98e9b":"code","67818be6":"code","a8fc4117":"code","73ad34af":"code","ff5f7f84":"code","3a4c0098":"code","7afd8049":"code","3eebc7d1":"code","71cf3880":"code","06e38660":"code","fcb09a63":"code","81609dcb":"code","a1585dbe":"code","47ee5aa3":"code","21c885c2":"code","cc4bb694":"code","9b65873e":"code","22e2d05c":"code","535c650d":"code","2031ffc4":"code","8277a525":"code","0eef81ba":"code","5b0b6d03":"code","e7bf5afc":"code","9ddd0497":"code","bf991972":"code","a0fdee9b":"markdown","275979e1":"markdown","eae69110":"markdown","6db8f60c":"markdown","99370e76":"markdown","feb0f4ca":"markdown","820d69dc":"markdown","f0cfaa67":"markdown","daa3847e":"markdown","6d331e60":"markdown","dfa82741":"markdown","1a19bb15":"markdown","e5438f7c":"markdown","16ffe40c":"markdown","acab19bc":"markdown","bb6f1583":"markdown","84bf3f78":"markdown","17fee2c5":"markdown","d2294547":"markdown","1f59dbad":"markdown","d502488c":"markdown","777ed5aa":"markdown","0ffd836c":"markdown","ed044365":"markdown","1b95a54c":"markdown","bfaf614c":"markdown","d27dc070":"markdown","45618a47":"markdown","4134f482":"markdown","da3dc04e":"markdown","1dbd8065":"markdown","d885f533":"markdown","a80d9998":"markdown"},"source":{"59f4858b":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt","0ff37d92":"sales=pd.read_csv('..\/input\/summer-products-and-sales-in-ecommerce-wish\/summer-products-with-rating-and-performance_2020-08.csv',header=0)\nsales.head()","fc0c2936":"sales['price'].plot(kind='hist',figsize=(10,10))\nplt.xlabel('Value of price')\nplt.ylabel('Frequency')","1c85a95c":"sales['retail_price'].plot(kind='hist',figsize=(10,10))\nplt.xlabel('Retail price')\nplt.ylabel('Frequency')","fe4a9c45":"sales['units_sold'].plot(kind='hist',figsize=(10,10))\nplt.xlabel('Units Sold')\nplt.ylabel('Frequency')","3a4fec63":"sales['rating'].plot(kind='hist',figsize=(10,10))\nplt.xlabel('Rating')\nplt.ylabel('Frequency')","f406eea5":"sales['rating_count'].plot(kind='hist',figsize=(10,10))\nplt.xlabel('Rating Count')\nplt.ylabel('Frequency')","5c1d2b59":"sales['badges_count'].plot(kind='hist',figsize=(10,10))\nplt.xlabel('Number of Badges')\nplt.ylabel('Frequency')","b310738d":"sales['shipping_option_price'].plot(kind='hist',figsize=(10,10))\nplt.xlabel('Shipping Cost')\nplt.ylabel('Frequency')","fafe7af6":"sales.groupby('origin_country')['product_id'].count().sort_values(ascending=False).plot(kind='bar',figsize=(10,10),title='Country wise products count')","48d39580":"sales.info()","b5baea56":"to_be_removed=['merchant_title','merchant_has_profile_picture','merchant_profile_picture','product_url','product_picture','crawl_month','has_urgency_banner','urgency_text']","bc37d66d":"sales.drop(to_be_removed,axis=1,inplace=True)\nsales.info()","93678969":"sales.describe()","3175dba2":"sales['price_difference']=sales['retail_price']-sales['price']","2408a2da":"sales.columns","1f60e58a":"sales['currency_buyer'].value_counts()","6ef96f87":"to_be_used=['price','retail_price','uses_ad_boosts','rating','rating_count','rating_five_count','rating_four_count','rating_three_count','rating_two_count','rating_one_count','badges_count','badge_local_product','badge_product_quality','badge_fast_shipping','shipping_option_price','shipping_is_express','countries_shipped_to','merchant_rating_count','units_sold']","820ea668":"f=plt.figure(figsize=(25,25))\nplt.matshow(sales[to_be_used].corr(),fignum=f.number)\nplt.xticks(range(sales[to_be_used].shape[1]), sales[to_be_used].columns, fontsize=14, rotation=45)\nplt.yticks(range(sales[to_be_used].shape[1]), sales[to_be_used].columns, fontsize=14)\ncb=plt.colorbar()\ncb.ax.tick_params(labelsize=14)","c8028bd9":"l=[]\n\nfor i in to_be_used:\n    if abs(sales['units_sold'].corr(sales[i])>=0.05):\n        l.append(i)\nl.remove('units_sold')\nl","4e25e7b3":"sales.describe(include='object')","a4df606d":"sales['shipping_option_name'].value_counts()","1a4954eb":"sales['origin_country'].value_counts()","e7065b67":"a=pd.get_dummies(sales['origin_country'])\na.info()","50897006":"sales1=sales.merge(a,how='outer',left_index=True, right_index=True)\nsales1.info()","5183d774":"to_be_used1=['AT','CN','GB','SG','US','VE','units_sold']\nf1=plt.figure(figsize=(10,15))\nplt.matshow(sales1[to_be_used1].corr(),fignum=f1.number)\nplt.xticks(range(sales1[to_be_used1].shape[1]), sales1[to_be_used1].columns, fontsize=14, rotation=45)\nplt.yticks(range(sales1[to_be_used1].shape[1]), sales1[to_be_used1].columns, fontsize=14)\ncb=plt.colorbar()\ncb.ax.tick_params(labelsize=14)","d2a98e9b":"b=pd.get_dummies(sales['shipping_option_name'])\nb","67818be6":"sales2=sales.merge(b,how='outer',left_index=True,right_index=True)\nsales2.info()","a8fc4117":"to_be_used2=list(sales2.columns[36:51])","73ad34af":"f2=plt.figure(figsize=(10,10))\nplt.matshow(sales2[to_be_used2].corr(),fignum=f2.number)\nplt.xticks(range(sales2[to_be_used2].shape[1]), sales2[to_be_used2].columns, fontsize=14, rotation=45)\nplt.yticks(range(sales2[to_be_used2].shape[1]), sales2[to_be_used2].columns, fontsize=14)\ncb=plt.colorbar()\ncb.ax.tick_params(labelsize=14)","ff5f7f84":"#to_be_removed2.remove('units_sold')\nfor i in to_be_used2:\n    if abs(sales2['units_sold'].corr(sales2[i]))>=0.5:\n        print(i)","3a4c0098":"sales['units_sold'].describe()","7afd8049":"category=[]\nfor i in sales['units_sold']:\n    if i>=0 and i<=100:\n        category.append('very_cold')\n    elif i>=101 and i<=1000:\n        category.append('cold')\n    elif i>=1001 and i<=5000:\n        category.append('warm')\n    elif i>=5001:\n        category.append('hot')\nlen(category)        ","3eebc7d1":"sales['class']=category","71cf3880":"sales.head()","06e38660":"l.append('units_sold')\nl.append('class')","fcb09a63":"l=np.array(l)\nl","81609dcb":"sales_df=sales[l]\nsales_df.head()","a1585dbe":"sales_df.info()","47ee5aa3":"sales_df.dropna(inplace=True)","21c885c2":"sales_df.info()","cc4bb694":"X=sales_df[['rating_count', 'rating_five_count', 'rating_four_count','rating_three_count', 'rating_two_count', 'rating_one_count','badge_product_quality', 'merchant_rating_count', 'units_sold']].values\nX[0:5]","9b65873e":"from sklearn import preprocessing\nX = preprocessing.StandardScaler().fit(X).transform(X.astype(float))\nX[0:5]","22e2d05c":"y = sales_df['class'].values\ny[0:5]","535c650d":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split( X, y, test_size=0.2, random_state=4)\nprint ('Train set:', X_train.shape,  y_train.shape)\nprint ('Test set:', X_test.shape,  y_test.shape)","2031ffc4":"from sklearn.neighbors import KNeighborsClassifier","8277a525":"k = 4\n#Train Model and Predict  \nneigh = KNeighborsClassifier(n_neighbors = k).fit(X_train,y_train)\nneigh","0eef81ba":"yhat = neigh.predict(X_test)\nyhat[0:5]","5b0b6d03":"from sklearn import metrics\nprint(\"Train set Accuracy: \", metrics.accuracy_score(y_train, neigh.predict(X_train)))\nprint(\"Test set Accuracy: \", metrics.accuracy_score(y_test, yhat))","e7bf5afc":"Ks = 10\nmean_acc = np.zeros((Ks-1))\nstd_acc = np.zeros((Ks-1))\nConfustionMx = [];\nfor n in range(1,Ks):\n    \n    #Train Model and Predict  \n    neigh = KNeighborsClassifier(n_neighbors = n).fit(X_train,y_train)\n    yhat=neigh.predict(X_test)\n    mean_acc[n-1] = metrics.accuracy_score(y_test, yhat)\n\n    \n    std_acc[n-1]=np.std(yhat==y_test)\/np.sqrt(yhat.shape[0])\n\nmean_acc","9ddd0497":"plt.plot(range(1,Ks),mean_acc,'g')\nplt.fill_between(range(1,Ks),mean_acc - 1 * std_acc,mean_acc + 1 * std_acc, alpha=0.10)\nplt.legend(('Accuracy ', '+\/- 3xstd'))\nplt.ylabel('Accuracy ')\nplt.xlabel('Number of Nabors (K)')\nplt.tight_layout()\nplt.show()","bf991972":"pwd\n","a0fdee9b":"<h1>Thank You!!!<h1>","275979e1":"<b>Distribution of Shipping Cost<\/b>","eae69110":"<p1><b>Lets assign each of the entry to a class based on their sales<\/b><\/p1>","6db8f60c":"<b>Distribution of Number of rating<\/b>","99370e76":"There features are all not in the same range. Hence lets bring them to the same order:","feb0f4ca":"#### What about other K?\nK in KNN, is the number of nearest neighbors to examine. It is supposed to be specified by the User. So, how can we choose right value for K?\nThe general solution is to reserve a part of your data for testing the accuracy of the model. Then chose k =1, use the training part for modeling, and calculate the accuracy of prediction using all samples in your test set. Repeat this process, increasing the k, and see which k is the best for your model.\n\nWe can calculate the accuracy of KNN for different Ks.","820d69dc":"<p1><b>There are several columns that we won't need, for instance 'merchant_has_profile_picture','merchant_profile_picture', which can be removed<\/b><\/p1>","f0cfaa67":"<p1><b>We have a seen the influence of numerical variables on the sales. Lets see the impact of the categorical variable on sales. People do get influenced by other factors like Counrty of origin, merchant details, etc<\/b><\/p1>","daa3847e":"### Train Test Split  \nOut of Sample Accuracy is the percentage of correct predictions that the model makes on data that that the model has NOT been trained on. Doing a train and test on the same dataset will most likely have low out-of-sample accuracy, due to the likelihood of being over-fit.\n\nIt is important that our models have a high, out-of-sample accuracy, because the purpose of any model, of course, is to make correct predictions on unknown data. So how can we improve out-of-sample accuracy? One way is to use an evaluation approach called Train\/Test Split.\nTrain\/Test Split involves splitting the dataset into training and testing sets respectively, which are mutually exclusive. After which, you train with the training set and test with the testing set. \n\nThis will provide a more accurate evaluation on out-of-sample accuracy because the testing dataset is not part of the dataset that have been used to train the data. It is more realistic for real world problems.","6d331e60":"<h2>Feel free to share your comments on this work. If there are any errors, inaccuracies, or if you wish to share an alternative approach to tackle this problem, feel free to share them in the comments. I am here to learn so I am all ears to any constructive feedbacks :)<\/h2>","dfa82741":"<h3>K nearest neighbor (KNN)<\/h3>","1a19bb15":"<b><p1>We will use the following convention:<\/p1>\n<ol>\n<li>Sales value from 0 to 100: Very Cold<\/li>\n<li>Sales value from 101 to 1000: Cold<\/li>\n<li>Sales value from 1001 to 5000: Warm<\/li>\n<li>Sales value from 5001 to 100000: Hot<\/li>    \n<\/ol>\n\n<\/b>","e5438f7c":"<b>Lets focus only on the factor that exert a descent amount of influence on the sales<\/b>","16ffe40c":"<p1><b>We have managed to remove 7 columns which might have nothing to contribute to our analysis.<\/b><\/p1><p2>That being said, lets articulate what needs to be achieved in this project:<\/p2>\n\n<p3>Based on available data about products we would have to figure out those products that are potential hot cakes. For this let use K means clustering based approach. Lets classify the products into hot, warm, cold and very cold products based on their sales <\/p3>","acab19bc":"Lets see what are all the categorical variables present in this data set","bb6f1583":"<b>Distribution of Rating<\/b>","84bf3f78":"<h2>Its time for some EDA<\/h2>","17fee2c5":"<h2><b>What matters to users is the amount that can be saved by purchasing the product here. Hence lets add one more column<\/b><\/h2>","d2294547":"### Training\n\nLets start the algorithm with k=4 for now:","1f59dbad":"<b>Distribution of price<\/b>","d502488c":"<b>Country wise distribution of total number of products<\/b>","777ed5aa":"Most products are priced between 5 to 10 Euros. ","0ffd836c":"Lets see how various variables in this data set are correlated to each other\n","ed044365":"<p1><b>Lets see if the county of origin and shipping company name has any impact on purchase<\/b><\/p1>","1b95a54c":"<b>Distribution of Units sold<\/b>","bfaf614c":"### Accuracy evaluation\nIn multilabel classification, __accuracy classification score__ is a function that computes subset accuracy. This function is equal to the jaccard_similarity_score function. Essentially, it calculates how closely the actual labels and predicted labels are matched in the test set.","d27dc070":"<b>Lets see if the shipping option has any impact on the sales<\/b>","45618a47":"<b>Distribution of Retail price<\/b>","4134f482":"<b>From the matrix, we see that the country of orgin does not have significant impact on purchases<\/b>","da3dc04e":"<p1><b>Lets see how many different currencies are supported in this platform<\/b><\/p1>","1dbd8065":"<b>Distribution of number of Badges<\/b>","d885f533":"<b>Lets plot the correlation of various variables with the 'units sold' variable to see which are the influential ones<\/b>","a80d9998":"To use scikit-learn library, we have to convert the Pandas data frame to a Numpy array:"}}