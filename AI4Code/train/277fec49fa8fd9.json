{"cell_type":{"b033c11d":"code","6bc861b5":"code","22ee11d5":"code","6bbf24b4":"code","1f4ac1c5":"code","e97afeb0":"code","7f1c8bf7":"code","cd3faa8d":"code","f6565316":"markdown","45d14f7d":"markdown","0248217e":"markdown","926a7d3e":"markdown","f1c169c9":"markdown","5f1d8383":"markdown","a8d92aff":"markdown","e87523cf":"markdown","67c2f3b8":"markdown"},"source":{"b033c11d":"# Install PyCaret\nfrom os import system\nsystem('pip install pycaret'); # Instal PyCaret without console log","6bc861b5":"# Dependancies\nimport pandas as pd\nfrom pycaret.regression import *","22ee11d5":"# Read data\ntrain = pd.read_csv('..\/input\/tabular-playground-series-jan-2021\/train.csv', index_col='id')\ntest = pd.read_csv('..\/input\/tabular-playground-series-jan-2021\/test.csv', index_col='id')","6bbf24b4":"# Setup PyCaret\nsetup(data=train,          # Data used for training\n      target='target',     # Target column nameold tu use for cross-validation\n      silent=True,         # No data type validation by user\n      verbose=False,       # No print of the setup params grid\n      session_id=2021);    # Seed","1f4ac1c5":"# Init model\nmodel = create_model('lightgbm')","e97afeb0":"# Tune model\ntuned_model = tune_model(model,                               # Model to tune\n                         custom_grid=None,                    # Use default search space\n                         optimize='R2',                       # Metrics to optimize\n                         search_library='optuna',             # Underlying framework to use\n                         n_iter=50,                           # Number max of iterations\n                         early_stopping=True,                 # Stop if no progress is done\n                         choose_better=True)                  # Return best performing model","7f1c8bf7":"# Train on all training data\nfinal_model = finalize_model(tuned_model) ","cd3faa8d":"# Submission - with finalize\nprediction = predict_model(final_model, test)\nprediction['Label'].rename('target').to_csv('submission.csv')","f6565316":"## Make prediction and submission file","45d14f7d":"## Read data and setup PyCaret\n\nDocumentation for setup: [link](https:\/\/pycaret.readthedocs.io\/en\/latest\/api\/regression.html#pycaret.regression.setup)","0248217e":"<img src=\"https:\/\/miro.medium.com\/max\/1024\/1*Cku5-rqmqSIuhUyFkIAdIA.png\" width=\"600\" class=\"center\"\/>","926a7d3e":"## Finalize by training on all available data\n**Documentation for *finalize_model*:** [link](https:\/\/pycaret.readthedocs.io\/en\/latest\/api\/regression.html#pycaret.regression.finalize_model)","f1c169c9":"#### ***Note: I will gladly welcome all suggestions, critics or even thoughts on my work. Feel free to leave a comment or just an upvote. Any feedback helps me to become better. Thank you!***","5f1d8383":"## Tune model hyper-parameters\n**Documentation for *tune_model*:** [link](https:\/\/pycaret.readthedocs.io\/en\/latest\/api\/regression.html#pycaret.regression.tune_model)","a8d92aff":"## Install PyCaret and import it","e87523cf":"<center>\n    <h1>Create and Tune LGB model with PyCaret<\/h1>\n    <h4>PyCaret is an open source, low-code machine learning library in Python that allows you to go from preparing your data to deploying your model within minutes in your choice of notebook environment.<\/h4>\n<\/center>","67c2f3b8":"## Create and train LGB model\n**Documentation for *create_model*:** [link](https:\/\/pycaret.readthedocs.io\/en\/latest\/api\/regression.html#pycaret.regression.create_model)"}}