{"cell_type":{"1be6c59c":"code","ae82eab6":"code","f4183173":"code","abe052b3":"code","e3455e74":"code","9c41af8e":"code","de0a423a":"code","b4ce2248":"code","181993b4":"markdown"},"source":{"1be6c59c":"# Load libraries\nimport pandas as pd\nimport tensorflow as tf","ae82eab6":"# Load csv files\ndata_dir = \"..\/input\/vietai-c6-assignment3-extracted-dataset\/train.csv\"\nsub_dir = \"..\/input\/vietai-c6-assignment3-extracted-dataset\/sample_submission.csv\"\ntrain_df = pd.read_csv(data_dir)\nsubmission_df = pd.read_csv(sub_dir)","f4183173":"train_df","abe052b3":"submission_df","e3455e74":"# Create one-hot encoding\nclasses = [\"book\", \"can\", \"cardboard\", \"glass_bottle\", \"pen\", \"plastic_bottle\"]\ntrain_y = train_y = train_df.label\nnum_classes = len(np.unique(train_y))\ny_ohe = tf.keras.utils.to_categorical(train_y, num_classes=num_classes)\ny_ohe","9c41af8e":"# Show sample images\nfrom PIL import Image\nfrom tqdm import tqdm\nimport os\nimport matplotlib.pyplot as plt\nimport cv2\nimport numpy as np\n\ndef show_gallery(df, n=5, shuffle=True):\n    plt.subplots(figsize=(20,20))\n    if shuffle:\n        df = df.sample(frac=1).reset_index(drop=True)\n    k=1\n    for i in range(n*n):\n        im = cv2.imread(os.path.join(\"..\/input\/vietai-c6-assignment3-extracted-dataset\/train\/\" + classes[df.loc[k, \"label\"]],df.loc[k,\"image\"]))\n        im = cv2.cvtColor(im, cv2.COLOR_BGR2RGB)\n        label = classes[df.loc[k,\"label\"]]\n        plt.subplot(n,n,k)\n        plt.imshow(im)\n        plt.title(\"Label: {}\".format(label))\n        plt.axis(\"off\")\n        k += 1\n\nshow_gallery(train_df)","de0a423a":"# Load images using ImageDataGenerator\n\nfrom tensorflow.keras.preprocessing.image import ImageDataGenerator\n\nIMG_SIZE = 224\nBATCH_SIZE = 32\n\ntrain_data_gen = ImageDataGenerator(rescale=1.\/255, validation_split=0.2) \ntrain_gen = train_data_gen.flow_from_directory(\"..\/input\/vietai-c6-assignment3-extracted-dataset\/train\", batch_size=BATCH_SIZE,\n                                              target_size=(IMG_SIZE, IMG_SIZE), subset=\"training\")\nvalid_gen = train_data_gen.flow_from_directory(\"..\/input\/vietai-c6-assignment3-extracted-dataset\/train\", batch_size=BATCH_SIZE,\n                                              target_size=(IMG_SIZE, IMG_SIZE), subset=\"validation\")","b4ce2248":"# Fit your data as normal\n\n# model.fit(train_gen, validation_data = valid_gen)","181993b4":"# 6 classes Image Classification\n\nThis is a starter notebook. The dataset is taken from VietAI Foundation class 06 - Image classification assignment."}}