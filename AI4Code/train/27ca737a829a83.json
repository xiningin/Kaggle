{"cell_type":{"3497211a":"code","fc2bc4c2":"code","749cdb25":"code","92ce9f6b":"code","9a56dc32":"code","3cf01eab":"markdown"},"source":{"3497211a":"%matplotlib inline\nimport os\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport pandas as pd\n\nfrom mpl_toolkits.axes_grid1 import ImageGrid\nfrom keras.preprocessing import image\nfrom keras.applications import resnet50","fc2bc4c2":"def load_img(img_id, train_or_test, size=(224, 224)):\n    IMG_DIR = '\/kaggle\/input\/dog-breed-identification\/'\n    img = image.load_img(os.path.join(IMG_DIR, train_or_test, f'{img_id}.jpg'),target_size=size)\n    return img\n\ndef predict(img, model):\n    img = image.img_to_array(img)\n    X = np.expand_dims(img, axis=0)\n    X = resnet50.preprocess_input(X)\n    r = model.predict(X)\n    return resnet50.decode_predictions(r, top=1)","749cdb25":"data_dir = '\/kaggle\/input\/dog-breed-identification\/'\nlabels = pd.read_csv(os.path.join(data_dir, 'labels.csv'))","92ce9f6b":"model = resnet50.ResNet50()","9a56dc32":"fig = plt.figure(figsize=(16, 16))\ngrid = ImageGrid(fig, 111, nrows_ncols=(2, 3), axes_pad=0.05)\nfor i, row in labels.sample(n=6).reset_index().iterrows():\n    ax = grid[i]\n    img = load_img(row['id'], 'train')\n    _, pred_breed, likelihood = predict(img, model)[0][0]\n    img = image.img_to_array(img)\n    ax.imshow(img \/ 255.)\n    ax.text(10, 180, f'ResNet50: {pred_breed} ({likelihood:.2f})', color='w', backgroundcolor='k', alpha=0.8)\n    ax.text(10, 200, f'Label: {row[\"breed\"]}', color='k', backgroundcolor='w', alpha=0.8)\n    ax.axis('off')\nplt.show()","3cf01eab":"Source:\n1. [Dog Breed - Pretrained keras models(LB 0.3)](https:\/\/www.kaggle.com\/gaborfodor\/dog-breed-pretrained-keras-models-lb-0-3)\n2. [ResNet-50 & Dog Breed Classification](https:\/\/medium.com\/i-a\/dog-breed-classification-using-resnet-50-f9bc6c7cba58)"}}