{"cell_type":{"7d4fcd2e":"code","87f524b4":"code","1e0dbbf7":"code","5f0370fd":"code","4177ef0b":"code","f426b621":"code","6c306330":"code","022b5f5a":"code","0a0562d2":"code","118194a3":"markdown"},"source":{"7d4fcd2e":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\nimport os\nprint(os.listdir(\"..\/input\"))","87f524b4":"df_train = pd.read_csv(\"..\/input\/train.csv\")\nprint(df_train.shape)\ndf_train.head()","1e0dbbf7":"df_test = pd.read_csv(\"..\/input\/test.csv\")\nprint(df_test.shape)\ndf_test.head()","5f0370fd":"# unique identifier per seat\/pilot, per crew, per experiemnt\ndf_train[\"pilot_key\"] = df_train[\"crew\"].astype(str)+df_train.experiment+df_train[\"seat\"].astype(str)\ndf_test[\"pilot_key\"] = df_test[\"crew\"].astype(str)+df_test.experiment+df_test[\"seat\"].astype(str)\n\n# another key - maybe what the pilot next to you was doing is also relevant ? \ndf_train[\"crew_exp_key\"] = df_train[\"crew\"].astype(str)+df_train.experiment\ndf_test[\"crew_exp_key\"] = df_test[\"crew\"].astype(str)+df_test.experiment","4177ef0b":"df_train[\"date\"] = pd.to_datetime(\"01-01-2018\")\ndf_test[\"date\"] = pd.to_datetime(\"01-01-2018\")","f426b621":"df_train[\"date\"] = df_train[\"date\"] + pd.to_timedelta(df_train[\"time\"], unit='s')\ndf_test[\"date\"] = df_test[\"date\"] + pd.to_timedelta(df_test[\"time\"], unit='s')\n\ndf_test.tail()","6c306330":"print(\"crews, experiments in train: \", df_train[[\"crew\",\"experiment\"]].nunique())\nprint(\"crews, experiments in test: \", df_test[[\"crew\",\"experiment\"]].nunique())","022b5f5a":"print(set(df_train.experiment))\nprint(set(df_test.experiment))","0a0562d2":"df_train.to_csv(\"aviation_fatal_train_raw.csv.gz\",index=False,compression=\"gzip\")\ndf_test.to_csv(\"aviation_fatal_test_raw.csv.gz\",index=False,compression=\"gzip\")","118194a3":"## Export for time series"}}