{"cell_type":{"c9f73860":"code","40639b64":"code","59edf5ed":"code","41955596":"code","92def031":"code","c6642974":"code","054a4bec":"code","23203d85":"code","3ea71d23":"code","a7923d9f":"code","002af69f":"code","65ceebf9":"code","a1633a3c":"code","51d5a95a":"code","6f17bdc4":"code","ce82cb98":"code","1df43335":"code","4e443cf6":"code","dc1b4b82":"code","57deab23":"code","833749ca":"code","7d93d338":"code","8d13c581":"code","a16c0af6":"code","884af31b":"code","db9b6c2d":"code","1276dcd3":"code","64960dde":"code","33f4583f":"code","c31ae88d":"code","d410a97e":"code","9936a809":"code","7377a01e":"code","2f482d50":"code","219a9e96":"code","c066b52e":"code","8a49919c":"code","19630f63":"code","654e75d3":"code","5d2ea139":"code","338a9067":"code","b1acbd9c":"code","68bfe832":"code","5ad3cc8d":"code","3bc04091":"markdown","c1939340":"markdown","0b46ca9e":"markdown","ec7aed7a":"markdown","6bb34928":"markdown","7e45db50":"markdown","3da8f8e2":"markdown","fb3d7344":"markdown","6e2b51c8":"markdown","2f30def7":"markdown","035366f0":"markdown","e9b98bdf":"markdown","f626bf04":"markdown","d3682f67":"markdown","fd6d88cd":"markdown","c3f8fdc2":"markdown","4ef97797":"markdown","ecaca911":"markdown","4f0297af":"markdown","430cc51e":"markdown","a5545788":"markdown","89c7b195":"markdown","77c74c6a":"markdown","7b62902f":"markdown","61949225":"markdown","f91089a0":"markdown","fa9bf33c":"markdown","1fa30c05":"markdown","4349c14a":"markdown","f71af9cb":"markdown","0d423143":"markdown","530bd0af":"markdown","138d6725":"markdown","9553709b":"markdown","930dbf89":"markdown"},"source":{"c9f73860":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","40639b64":"# Use pd.read_csv to read file\npath = \"..\/input\/star-categorization-giants-and-dwarfs\/Star99999_raw.csv\"\nraw_data = pd.read_csv(path)\n\nraw_data","59edf5ed":"raw_data.columns","41955596":"# read some statistics of the dataset\nraw_data.describe()","92def031":"# Check the DataType of our dataset\nraw_data.info()","c6642974":"# Convert Columns data type to float values\nraw_data[\"Vmag\"] = pd.to_numeric(raw_data[\"Vmag\"], downcast=\"float\", errors='coerce')\nraw_data[\"Plx\"] = pd.to_numeric(raw_data[\"Plx\"], downcast=\"float\", errors='coerce')\nraw_data[\"e_Plx\"] = pd.to_numeric(raw_data[\"e_Plx\"], downcast=\"float\", errors='coerce')\nraw_data[\"B-V\"] = pd.to_numeric(raw_data[\"B-V\"], downcast=\"float\", errors='coerce')","054a4bec":"# Check the DataType of our dataset\nraw_data.info()","23203d85":"# Actually , if you want to show all the columns you can add parameter `include='all'`.\nraw_data.describe(include='all')","3ea71d23":"# get the number of missing data points per column\nmissing_values_count = raw_data.isnull().sum()\n\nmissing_values_count","a7923d9f":"# how many total missing values do we have?\ntotal_cells = np.product(raw_data.shape)\ntotal_missing = missing_values_count.sum()\n\n# percentage of data that is missing\npercent_missing = (total_missing\/total_cells)\nprint(\"Percentage Missing:\", \"{:.2%}\".format(percent_missing))","002af69f":"# remove all the rows that contain a missing value\n# better to store it into a new variable to avoid confusion\nraw_data_na_dropped = raw_data.dropna() \n\nraw_data_na_dropped","65ceebf9":"# just how much rows did we drop?\ndropped_rows_count = raw_data.shape[0]-raw_data_na_dropped.shape[0]\nprint(\"Rows we dropped from original dataset: %d \\n\" % dropped_rows_count)\n\n# Percentage we dropped\npercent_dropped = dropped_rows_count\/raw_data.shape[0]\nprint(\"Percentage Loss:\", \"{:.2%}\".format(percent_dropped))","a1633a3c":"raw_data_na_dropped.describe()","51d5a95a":"#The best way to do this in pandas is to use drop:\nraw_data_na_dropped = raw_data_na_dropped.drop('Unnamed: 0', axis=1)","6f17bdc4":"raw_data_na_dropped.describe()","ce82cb98":"raw_data_na_dropped.info()","1df43335":"raw_data_na_dropped_reindex = raw_data_na_dropped.reset_index(drop=True)","4e443cf6":"raw_data_na_dropped_reindex.info()","dc1b4b82":"#Optional - Save our progress\n#raw_data_na_dropped_reindex.to_csv(\"Star99999_na_dropped.csv\", index=False)","57deab23":"#Save a copy, so I can call it in a easier way\ndf = raw_data_na_dropped_reindex.copy()\ndf","833749ca":"#Dropping rows that `Plx` = 0\ndf = df[df.Plx != 0]\n\n#Reindex the dataframe\ndf = df.reset_index(drop=True)\n\ndf","7d93d338":"#Implement the equation\ndf[\"Amag\"] = df[\"Vmag\"] + 5* (np.log10(abs(df[\"Plx\"]))+1)\n\ndf","8d13c581":"df.info()","a16c0af6":"df.describe()","884af31b":"# Take a look at our SpType column\ndf['SpType']","db9b6c2d":"#Copy the SpType column to a new column called TargetClass\ndf['TargetClass'] = df['SpType']\n\ndf","1276dcd3":"#The intuitive approach (Could take a long time if you have a huge dataset)\nfor i in range(len(df['TargetClass'])):\n    if \"V\" in df.loc[i,'TargetClass']: \n        if \"VII\" in df.loc[i,'TargetClass']: \n            df.loc[i,'TargetClass'] = 0 # VII is Dwarf\n        else:\n            df.loc[i,'TargetClass'] = 1 # IV, V, VI are Giants\n    elif \"I\" in df.loc[i,'TargetClass']: \n        df.loc[i,'TargetClass'] = 0 # I, II, III are Dwarfs\n    else: \n        df.loc[i,'TargetClass'] = 9 # None\n        \ndf['TargetClass']","64960dde":"df.describe(include='all')","33f4583f":"#Save our progress\n#df.to_csv(\"Star99999_preprocessed0821.csv\", index=False)","c31ae88d":"df['TargetClass'].value_counts()","d410a97e":"import matplotlib.pyplot as plt # plot graphs\nimport seaborn as sns # plot graphs\n\nsns.countplot(df['TargetClass'])","9936a809":"#Dropping rows that `TargetClass` = 9\ndf = df[df.TargetClass != 9]\n\n#Reindex the dataframe\ndf = df.reset_index(drop=True)\n\ndf","7377a01e":"# Separate the labels\ndf_giants = df[df.TargetClass == 1]\ndf_dwarfs = df[df.TargetClass == 0]","2f482d50":"# Numbers of rows of Giants and Dwarfs\nnum_of_giant = df_giants.shape[0]\nnum_of_dwarf = df_dwarfs.shape[0]\nprint(\"Giants(1):\",num_of_giant)\nprint(\"Dwarfs(0):\",num_of_dwarf)","219a9e96":"from sklearn.utils import resample","c066b52e":"# Downsample majority class\ndf_giants_downsampled = resample(df_giants, \n                                 replace=False,    # sample without replacement\n                                 n_samples=num_of_dwarf,     # to match minority class\n                                 random_state=1) # reproducible results\n \n# Combine minority class with downsampled majority class\ndf_downsampled = pd.concat([df_giants_downsampled, df_dwarfs])","8a49919c":"df_downsampled['TargetClass'].value_counts()","19630f63":"sns.countplot(df_downsampled['TargetClass'])","654e75d3":"df_downsampled.describe(include='all')","5d2ea139":"df_downsampled.info()","338a9067":"df_balanced = df_downsampled.reset_index(drop=True)\n\ndf_balanced.info()","b1acbd9c":"df_balanced","68bfe832":"df_balanced = df_balanced.sample(frac=1).reset_index(drop=True)\n\ndf_balanced","5ad3cc8d":"#Save our dataset, we can finally play with it!!!\ndf_balanced.to_csv(\"Star39552_balanced.csv\", index=False)","3bc04091":"## Checking Missing data\nIt is very common that a dataset have some missed values.","c1939340":"Looks like we have finally cleaned out all the missing values!\n\nFinally, we can save our progress to a csv file.\n* Remember to use `index=False` if you don't want to create separate column of indexes again!\n\nhttps:\/\/pandas.pydata.org\/pandas-docs\/stable\/reference\/api\/pandas.DataFrame.to_csv.html\nhttps:\/\/stackoverflow.com\/questions\/20845213\/how-to-avoid-python-pandas-creating-an-index-in-a-saved-csv","0b46ca9e":"Here are some useful info you might want to look at before playing with this notebook:\n\n* [Data Cleaning course on Kaggle Learn](https:\/\/www.kaggle.com\/alexisbcook\/handling-missing-values)","ec7aed7a":"* `Vmag` - Visual Apparent Magnitude of the Star \n* `Plx` - Distance Between the Star and the Earth \n* `e_Plx` - Standard Error of `Plx` (Drop the Row if you find the e_Plx is too high!)\n* `B-V` - B-V color index. (A hot star has a B-V color index close to 0 or negative, while a cool star has a B-V color index close to 2.0. Other stars are somewhere in between.)\n* `SpType` -  [Stellar classification.](https:\/\/en.wikipedia.org\/wiki\/Stellar_classification) (Roman Numerals &gt;IV are giants. Otherwise are dwarfs) \n","6bb34928":"^Why the describe function is not returning summary of all columns?\n\nIt is probably because this dataframe has mixed column types. The default behavior of pandas describe function is to only provide a summary for the numerical columns.\n\nhttps:\/\/stackoverflow.com\/questions\/24524104\/pandas-describe-is-not-returning-summary-of-all-columns","7e45db50":"^Oh, almost forgot, we need to drop the first column of dataset.","3da8f8e2":"## Convert SpType into Giants and Dwarf\n\n* Roman Numerals >IV are giants. Otherwise are dwarfs\n\n","fb3d7344":"Yeah, Reindex.","6e2b51c8":"## Dropping Unwanted Column\n\nThis Stackoverflow link will give you idea of how to drop a column from pandas dataframe.\nhttps:\/\/stackoverflow.com\/questions\/13411544\/delete-column-from-pandas-dataframe","2f30def7":"^When we use the data to analysis, the label is better in numeric values otherwise we might need to map them.","035366f0":"Lastly, read the statistics and info again.","e9b98bdf":"We only need the Dwarfs and Giants Record.","f626bf04":"# Data Cleaning","d3682f67":"Did you notice? Since we concat the 2 Dataframes, we need to shuffle our data before feeding them to a model.\n\n> Pandas has a shuffle method called `sample`.\n> You can also use sklearn to shuffle if you want to.\n\nhttps:\/\/stackoverflow.com\/questions\/29576430\/shuffle-dataframe-rows","fd6d88cd":"# Column Mapping\n\nIn this session, we will create a new column `TargetClass` to store whether it is a Giant or Dwarf.","c3f8fdc2":"Finally done!","4ef97797":"### Take a first look at the data\nThe first thing we'll need to do is\n* Import Libraries\n* Check the files we have\n* Load the raw dataset","ecaca911":"^We can see the dataset included duplicated Index column, so we need to remove it later.\n\nLets read some statistics of the dataset first.","4f0297af":"To downsample the class, we can just use a loop to loop through the records, but there is a way better approach.\n\nLet's import `resample` from `sklearn`.","430cc51e":"^As we can see, Both `Vmag`, `Plx`, `e_Plx`,`B-V` are marked as object, but they were supposed to be float value.\n\nThen we should convert our columns to numeric.","a5545788":"Our Dataset is finally balanced!\n![](https:\/\/i.imgflip.com\/303krn.jpg)","89c7b195":"We can see the SpType contains the Roman Numerals we need.\n\n> Best Practice is to use Regex (Regular Expression) to extract the pattern.\n\nBut I will try to use an intuitive approach first.\n\nI just took a look from the dataset, the Roman Numeral contains: I, II, III, IV, V, VI, VII in the string.\nTherefore:\n\n* Dwarfs (I, II, III, VII)\n* Giants (IV, V, VI)\n* Other Special Stars (None)\n\n^Edit0821: Sorry I made a huge mistake here... Now fixed!\n\nFor the First Character of the String, we don't need to worry there will be I or V.\n![](https:\/\/cdn.britannica.com\/17\/143617-050-6042AB2A\/diagram-Hertzsprung-Russell-Annie-Jump-Cannon-type-order.jpg)","77c74c6a":"Looks like we successfully dropped all the rows that `Plx` = 0.","7b62902f":"# Preprocessing the StarDataset\n\nIn this notebook, I will try to demonstrate how to preprocess this messy Star Dataset.\n\nhttps:\/\/www.kaggle.com\/vinesmsuic\/star-categorization-giants-and-dwarfs","61949225":" Last but not Least, we need to check our dataset to see whether there are still some problem.","f91089a0":"Now let's check the info again.","fa9bf33c":"^We noticed the Int64Index have 96742 entries, but only 0 to 99998.\n\nTherefore we need to reindex our dataframe.\n\nhttps:\/\/stackoverflow.com\/questions\/40755680\/how-to-reset-index-pandas-dataframe-after-dropna-pandas-dataframe","1fa30c05":"## Dropping Missing Data","4349c14a":"Since we have so many records, we will just downsample the majority class.","f71af9cb":"If you run this code:\n```python\n# Convert Columns data type to float values\nraw_data[\"Vmag\"] = pd.to_numeric(raw_data[\"Vmag\"], downcast=\"float\")\nraw_data[\"Plx\"] = pd.to_numeric(raw_data[\"Plx\"], downcast=\"float\")\nraw_data[\"e_Plx\"] = pd.to_numeric(raw_data[\"e_Plx\"], downcast=\"float\")\nraw_data[\"B-V\"] = pd.to_numeric(raw_data[\"B-V\"], downcast=\"float\")\n```\nError would Occur : `ValueError: Unable to parse string \"     \" at position 25189`\n\nFrom Above Error, we can observe that some cells were filled with whitespaces, so they become unable to parse.\n\nWe can add a parameter `errors='coerce'` to force the function to convert bad non-numeric values to NaN.\n\nhttps:\/\/stackoverflow.com\/questions\/40790031\/pandas-to-numeric-find-out-which-string-it-was-unable-to-parse","0d423143":"## Finding Absolute Magnitude\n\nThe absolute magnitude of the stars were generated via the equation:\n![](https:\/\/i.imgur.com\/tt1h8bu.png)\nWhere $M$ represents the absolute magnitude `Amag`, \n$m$ represents the visual apparent magnitude `Vmag`\nand $p$ represents stellar parallax `Plx`.\n\n\nIn this session, we will create a new column `Amag` to store $M$.\n\nThings need to be aware:\n* Taking log of 0 would result in a infinity, which is what we dont want to see\n  * To fix this: Dropping rows with `Plx` = 0\n* Taking log of -ve numbers would result complex numbers, which is what we dont want to see too.\n  * To fix this: Taking Absolute value of `Plx`\n","530bd0af":"# Balancing Data\nAlmost forgot, we need to balance the data.\n\nThis post will give you the idea of why do we need to balance the data.\n<br>\nhttps:\/\/elitedatascience.com\/imbalanced-classes","138d6725":"^From the percentage of missing data, since it is so small (only 0.7%), we can just drop the rows.\n\nLet's see what will happen if we remove all the rows that contain a missing value.","9553709b":"You can use this link to check more notebooks about this dataset:\n\nhttps:\/\/www.kaggle.com\/vinesmsuic\/star-categorization-giants-and-dwarfs\/notebooks\n","930dbf89":"# Creating New Column for Amag"}}