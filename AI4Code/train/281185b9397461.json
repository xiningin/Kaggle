{"cell_type":{"54f2e4d0":"code","3f26c08e":"code","41464475":"code","0392c08b":"code","6694edda":"code","2c691618":"code","4d5d9a57":"code","2b13f32c":"code","7b8c55bb":"code","425e1a05":"code","c6f6e3e8":"code","d1dc98e9":"code","5b6fa31f":"code","75b55b62":"code","03bd84a7":"code","7f3be210":"code","d7e14d66":"markdown","81177213":"markdown","15e8ed37":"markdown","83f3cc63":"markdown","b15b8490":"markdown","3653c610":"markdown"},"source":{"54f2e4d0":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sn\n%matplotlib inline","3f26c08e":"carprice= pd.read_csv(\"..\/input\/car-price-prediction\/CarPrice_Assignment.csv\", encoding = \"utf-8\")\ncarprice.head(10)","41464475":"carprice.info()","0392c08b":"carprice.keys()","6694edda":"na_data=carprice.isna().sum()\nprint(na_data)","2c691618":"from sklearn import preprocessing\nlabel_encoder=preprocessing.LabelEncoder()\n","4d5d9a57":"carprice['CarName']= label_encoder.fit_transform(carprice['CarName'])\ncarprice['CarName'].unique()","2b13f32c":"correlation_matrix=carprice.corr()\nimport seaborn as sn\nimport matplotlib.pyplot as plt\nplt.figure(figsize=(10,10))\nsn.heatmap(data=correlation_matrix,annot=True)","7b8c55bb":"plt.figure(figsize=(5,5))\nfeatures=carprice.enginesize\ntarget=carprice.price\nfor i in enumerate (features):\n    x=features\n    y=target\n    plt.scatter(x,y)\n    plt.title(\"variation of price wrt engine size\")\n    plt.xlabel(\"engine size\")\n    plt.ylabel(\"price\")","425e1a05":"x = carprice[[\"carlength\",\"carwidth\",\"enginesize\",\"horsepower\",\"citympg\",\"highwaympg\"]]\nY= carprice[\"price\"]\ndata= carprice[[\"carlength\",\"carwidth\",\"enginesize\",\"horsepower\",\"citympg\",\"highwaympg\",\"price\"]]\npair_plot=sn.pairplot(data=data)\nplt.show","c6f6e3e8":"x=carprice[['enginesize','horsepower']]\ny=carprice['price']\nfrom sklearn.model_selection import train_test_split\nx_train,x_test,y_train,y_test = train_test_split(x,y,test_size=0.15,random_state= 10)\nprint (x_train.shape)\nprint (x_test.shape)\nprint(y_train.shape)\nprint(y_test.shape)","d1dc98e9":"from sklearn.linear_model import LinearRegression\nfrom sklearn.metrics import mean_squared_error\n\nlin_model = LinearRegression()  # Make an instance of the model\nlin_model.fit(x_train, y_train)","5b6fa31f":"y_train_predict = lin_model.predict(x_train)\nrmse = (np.sqrt(mean_squared_error(y_train, y_train_predict)))\n\nprint(\"The model performance for training set\")\nprint('RMSE is {}'.format(rmse))\nprint(\"\\n\")\n\n# on testing set\ny_test_predict = lin_model.predict(x_test)\nrmse = (np.sqrt(mean_squared_error(y_test, y_test_predict)))\n\nprint(\"The model performance for testing set\")\nprint('RMSE is {}'.format(rmse))\n\nfrom sklearn.metrics import r2_score\nprint(r2_score(y_test,y_test_predict))","75b55b62":"plt.scatter(y_test, y_test_predict)\n\nplt.plot([min(y_test_predict),max(y_test_predict)],[min(y_test_predict),max(y_test_predict)], color='red')\n\nplt.xlabel('Actual')\nplt.ylabel('Predicted')","03bd84a7":"x=carprice[['enginesize','horsepower','stroke','compressionratio','peakrpm','citympg', 'highwaympg']]\ny=carprice['price']\n\nx_train, x_test, y_train, y_test = train_test_split(x, y, test_size = 0.15, random_state=5)\nlin_model.fit(x_train, y_train)\n\ny_train_predict = lin_model.predict(x_train)\nrmse = (np.sqrt(mean_squared_error(y_train, y_train_predict)))\n\nprint(\"The model performance for training set\")\nprint('RMSE is {}'.format(rmse))\nprint(\"\\n\")\n\n# on testing set\ny_test_predict = lin_model.predict(x_test)\nrmse = (np.sqrt(mean_squared_error(y_test, y_test_predict)))\n\nprint(\"The model performance for testing set\")\nprint('RMSE is {}'.format(rmse))\n\nfrom sklearn.metrics import r2_score\nprint(r2_score(y_test,y_test_predict))","7f3be210":"plt.scatter(y_test, y_test_predict)\n\nplt.plot([min(y_test_predict),max(y_test_predict)],[min(y_test_predict),max(y_test_predict)], color='red')\n\nplt.xlabel('Actual')\nplt.ylabel('Predicted')","d7e14d66":"Visualization: Plotting the graph of a feature variables vs the target variable 'price' ","81177213":"> As we are to train a linear regression model lets see the linear correlation between different features of the dataset.******","15e8ed37":"FITTING THE LINEAR REGRESSION MODEL USING OTHER VARIABLES","83f3cc63":"Predicting the variables that have high linear correlation ","b15b8490":"PLOT THE GRAPH","3653c610":"PREDICTIONS ON TEST DATASET"}}