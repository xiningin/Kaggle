{"cell_type":{"214442c0":"code","cece6649":"code","3a2f42c6":"code","aebbc5d8":"code","5b569b6c":"code","9de631ad":"code","178e54da":"code","c2d25cc4":"code","ac82c225":"code","8ae7e3ec":"code","0cd64851":"code","b8c06967":"code","8561062a":"code","10d4a7fb":"code","a2e34e66":"code","42042728":"code","ee604cd1":"code","f0d1f39a":"code","88fa2883":"code","c39b60b3":"code","fe32a6c2":"code","3e815662":"code","4367021f":"code","7e37f004":"code","6a1edd45":"code","097f4313":"code","ab1a84a9":"code","f177258b":"code","7a6f9d50":"code","6b8a61fb":"code","e1e566eb":"code","bdcf920e":"code","bb76d27c":"code","998819d5":"code","7847f4ff":"code","cf17fe33":"code","cda198c9":"code","4acfffe8":"code","6f0659fa":"code","af0da407":"code","e8e4fa4a":"code","5bec5114":"code","2e7af27e":"code","574d0a32":"code","5c35fb4f":"code","f6bececc":"code","9743b4a1":"code","c5f3cfd2":"markdown","b0892472":"markdown","1760e2a9":"markdown","851f0425":"markdown","39968349":"markdown","3cc262a8":"markdown"},"source":{"214442c0":"#Importing basic libraries\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline\nsns.set_style(\"whitegrid\")\nplt.rcParams['figure.figsize']=[8,6]","cece6649":"#Loading the dataset\ndf = pd.read_csv(\"..\/input\/heart-attack-analysis-prediction-dataset\/heart.csv\")","3a2f42c6":"#Checking first few rows of our dataset\ndf.head()","aebbc5d8":"#Checking column datatype and shape of dataset\ndf.info()","5b569b6c":"#Checking the summary of numeric columns\ndf.describe()","9de631ad":"#Comparing the age distribution of patients who had heart attack and those who didn't\nsns.histplot(data=df,x=\"age\",hue=\"output\",bins=30, kde=True)\nplt.title(\"Distribution of age in output class\")\nplt.show()","178e54da":"#Comparing the population of different sex in each class\nsns.histplot(data=df,x=\"age\",hue=\"sex\",bins=30, kde=True)\nplt.title(\"Distribution of age based on sex\")\nplt.show()","c2d25cc4":"#Infering the effect of maximum heart rate achieved on occurence of heart attack\nsns.histplot(data=df,x=\"thalachh\",hue=\"output\",bins=30, kde=True)\nplt.title(\"Maximum Heart Rate achieved in each output class\")\nplt.show()","ac82c225":"#Resting blood pressure vs occurence of heart-attack for different sex class\nsns.boxplot(data=df,x=\"output\",y=\"trtbps\",hue=\"sex\")\nplt.title(\"Resting blood pressure for each gender and output class\")\nplt.show()","8ae7e3ec":"#Previous peak heart rate vs occurence of heart-attack for different sex class\nsns.boxplot(data=df,x=\"sex\",y=\"oldpeak\",hue=\"output\")\nplt.title(\"Previous peak heart rate for each gender and output class\")\nplt.show()","0cd64851":"sns.countplot(data=df,x=\"sex\",hue=\"output\")\nplt.title(\"Population distribution of output in each gender class\")\nplt.show()","b8c06967":"sns.countplot(data=df,x=\"fbs\",hue=\"output\")\nplt.title(\"Population distribution of output in fbs class\")\nplt.show()","8561062a":"sns.countplot(data=df,x=\"exng\",hue=\"output\")\nplt.title(\"Population distribution of output in exercise induced cases\")\nplt.show()","10d4a7fb":"#Infering the effect of maximum heart rate achieved on occurence of heart attack\nsns.histplot(data=df,x=\"chol\",hue=\"output\",bins=40, kde=True)\nplt.title(\"Distribution of cholestrol level in output class\")\nplt.show()","a2e34e66":"sns.boxplot(data=df,x=\"sex\",y=\"chol\",hue=\"output\")\nplt.title(\"Cholestrol levels in sex and output class\")\nplt.show()","42042728":"sns.countplot(data=df,x=\"cp\",hue=\"output\")\nplt.title(\"Population distribution of output class in chest pain category\")\nplt.show()","ee604cd1":"sns.countplot(data=df,x=\"thall\",hue=\"output\")\nplt.title(\"Population Distribution of output class according to Thallium Stress Test Results\")\nplt.show()","f0d1f39a":"sns.countplot(data=df,x=\"slp\",hue=\"output\")\nplt.title(\"Population Distribution of output class according to slope\")\nplt.show()","88fa2883":"fig=plt.figure(figsize=(15,10))\nfig=sns.heatmap(df.corr(),annot=True,cmap='RdYlGn_r')\nplt.title(\"Correlation Matrix\")\nplt.show()","c39b60b3":"df.replace({\"cp\":{0: \"typical\",1: \"atypical\", 2: \"non-anginal\", 3: \"asymptomatic\"}},inplace=True)","fe32a6c2":"df=df.join(pd.get_dummies(df.cp,drop_first=True))\ndf.drop('cp',axis=1,inplace=True)","3e815662":"df.replace({\"restecg\":{0 : \"Normal\", 1 : \"ST-T\", 2 : \"Left_ventricular-hypertrophy\"}},inplace=True)","4367021f":"df=df.join(pd.get_dummies(df.restecg,drop_first=True))\ndf.drop('restecg',axis=1,inplace=True)","7e37f004":"# Importing model building libraries\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.metrics import classification_report\nfrom sklearn.metrics import f1_score, accuracy_score, precision_score, recall_score\nfrom sklearn.metrics import roc_curve,roc_auc_score","6a1edd45":"X=df.drop(\"output\",axis=1)\ny=df.output","097f4313":"X_train, X_test, y_train, y_test=train_test_split(X,y,test_size=0.3,random_state=101)","ab1a84a9":"model=LogisticRegression(max_iter=500,solver='liblinear',random_state=101)","f177258b":"model.fit(X_train,y_train)","7a6f9d50":"X_train_pred=model.predict(X_train)","6b8a61fb":"print(classification_report(y_train, X_train_pred))","e1e566eb":"print(classification_report(y_test, model.predict(X_test)))","bdcf920e":"X_test_prob=model.predict_proba(X_test)[:,1]","bb76d27c":"scores=pd.DataFrame()","998819d5":"scores.loc[:,[\"Cutoff\",\"Accuracy\",\"Precision\",\"Recall\",\"F1_Score\"]]=\"\"","7847f4ff":"for i in range(101):\n    x=i\/100\n    cutoff=x\n    accuracy=accuracy_score(y_test,np.where(X_test_prob>=x,1,0))\n    precision=precision_score(y_test,np.where(X_test_prob>=x,1,0))\n    recall=recall_score(y_test,np.where(X_test_prob>=x,1,0))\n    f1=f1_score(y_test,np.where(X_test_prob>=x,1,0))\n    scores.loc[i,:]=[cutoff,accuracy,precision,recall,f1]","cf17fe33":"scores","cda198c9":"plt.figure(figsize=[15,8])\nscores.Accuracy.plot()\nscores.Precision.plot()\nscores.Recall.plot()\nscores.F1_Score.plot()\nplt.legend()\nplt.show()","4acfffe8":"print(classification_report(y_test, model.predict(X_test)))","6f0659fa":"print(classification_report(y_test, np.where(model.predict_proba(X_test)[:,1]>=0.44, 1, 0)))","af0da407":"a1,b1,c1=roc_curve(y_train,model.predict_proba(X_train)[:,1])\na2,b2,c2=roc_curve(y_test,model.predict_proba(X_test)[:,1])","e8e4fa4a":"plt.figure(dpi=100)\ntrain_auc=round(roc_auc_score(y_train,model.predict(X_train)),2)\ntest_auc=round(roc_auc_score(y_test,model.predict(X_test)),2)\nplt.plot(a1,b1,label=\"Training Data - AUC: {}\".format(train_auc))\nplt.plot(a2,b2,label=\"Testing Data - AUC: {}\".format(test_auc))\nplt.legend()\nplt.show()","5bec5114":"X_train_pred_new=np.where(model.predict_proba(X_train)[:,1]>=0.44,1,0)\nX_test_pred_new=np.where(model.predict_proba(X_test)[:,1]>=0.44,1,0)","2e7af27e":"a1,b1,c1=roc_curve(y_train,model.predict(X_train))\na2,b2,c2=roc_curve(y_train,X_train_pred_new)","574d0a32":"x1,y1,z1=roc_curve(y_test,model.predict(X_test))\nx2,y2,z2=roc_curve(y_test,X_test_pred_new)","5c35fb4f":"plt.figure(figsize=[12,6],dpi=200)\nplt.subplot(1,2,1)\n\ntrain_auc=round(roc_auc_score(y_train,model.predict(X_train)),2)\ntrain_auc_new=round(roc_auc_score(y_train,X_train_pred_new),2)\nplt.plot(a1,b1,label=\"Cutoff - 0.5 - AUC: {}\".format(train_auc))\nplt.plot(a2,b2,label=\"Cutoff - 0.44 - AUC: {}\".format(train_auc_new))\nplt.title(\"Training Set\")\nplt.legend()\n\nplt.subplot(1,2,2)\ntest_auc=round(roc_auc_score(y_test,model.predict(X_test)),2)\ntest_auc_new=round(roc_auc_score(y_test,X_test_pred_new),2)\nplt.plot(x1,y1,label=\"Cutoff - 0.5 - AUC: {}\".format(test_auc))\nplt.plot(x2,y2,label=\"Cutoff - 0.44 - AUC: {}\".format(test_auc_new))\nplt.title(\"Testing Set\")\n\nplt.legend()\nplt.show()","f6bececc":"coeffs=pd.DataFrame(list(model.coef_[0]),index=list(X.columns),columns=[\"Co-efficient\"])\ncoeffs.sort_values(by=\"Co-efficient\",inplace=True,ascending=False)\ncoeffs","9743b4a1":"plt.figure(dpi=100)\nsns.barplot(y=coeffs.index,x=coeffs['Co-efficient'])\nplt.show()","c5f3cfd2":"## Logistic Regression","b0892472":"age - Age of the patient  \n  \nsex - Sex of the patient  \n\ncp - Chest pain type ~ 0 = Typical Angina, 1 = Atypical Angina, 2 = Non-anginal Pain, 3 = Asymptomatic\n\ntrtbps - Resting blood pressure (in mm Hg)\n\nchol - Cholestoral in mg\/dl fetched via BMI sensor\n\nfbs - (fasting blood sugar > 120 mg\/dl) ~ 1 = True, 0 = False\n\nrestecg - Resting electrocardiographic results ~ 0 = Normal, 1 = ST-T wave normality, 2 = Left ventricular hypertrophy\n\nthalachh - Maximum heart rate achieved\n\noldpeak - Previous peak\n\nslp - Slope\n\ncaa - Number of major vessels\n\nthall - Thalium Stress Test result ~ (0,3)\n\nexng - Exercise induced angina ~ 1 = Yes, 0 = No\n\noutput - Target variable","1760e2a9":"## Predictor","851f0425":"## Data Visualization","39968349":"## Data Manipulation","3cc262a8":"## Model Building - Training and Test Data"}}