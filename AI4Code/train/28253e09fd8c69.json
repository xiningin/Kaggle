{"cell_type":{"6232cae4":"code","9b71e126":"code","ee6fcf83":"code","497bd143":"code","fcf0c082":"code","608cfa7e":"code","4849be3f":"code","92758b01":"code","e8d9dfee":"code","00768913":"code","259cac02":"code","b7f088c2":"code","50c13f63":"code","7f3e3629":"code","ab4a97b4":"code","12f44188":"code","968fdf34":"code","1cc5d932":"code","ede27774":"code","dcb8b07c":"code","997b0c4d":"code","231e4895":"code","c3c70156":"code","bdd0950d":"code","4cde203c":"code","796724f3":"code","79394937":"code","18131b56":"code","b7096240":"code","5800b3d8":"code","46de06d2":"code","c316a3ff":"code","2e31141a":"code","b76e5781":"code","c08fd2db":"code","608ea7dc":"code","11c9b485":"code","6d1215cb":"code","e5f44db1":"code","5fc76c2b":"code","3af6d98a":"code","b4bceaea":"code","211949f9":"code","8a5eb010":"code","fdd0ece2":"code","d2f212a4":"code","1b3861c0":"code","4695ffe6":"code","61aea95b":"code","437b688a":"code","10c86b65":"code","57eeea9b":"code","3684861c":"code","62105b49":"code","b09c4338":"code","fbaaf15e":"code","f12b6d89":"code","593893f9":"code","d399d8a4":"code","361344cd":"code","59386c18":"code","e6585556":"code","5862bf33":"code","1cc73161":"code","11b3c886":"code","4398285d":"code","03dcf65f":"code","69c8a6fc":"code","4779647e":"code","0d313bfe":"code","f2001f37":"markdown","be5f23b0":"markdown","29fd72c2":"markdown","ee8fd991":"markdown","0247e686":"markdown","3e9755c0":"markdown","9417fff4":"markdown","95cfc1c3":"markdown","6fdde82f":"markdown","cd8d4ac2":"markdown","6221cd55":"markdown","9acf1655":"markdown","e33aa99b":"markdown","a5f48608":"markdown","3d224b77":"markdown","0263fb66":"markdown","6c9d882e":"markdown","b05605b6":"markdown","e7711cbc":"markdown","3e05b4a9":"markdown","4d4635ba":"markdown","c9ce5721":"markdown","d68b16cc":"markdown"},"source":{"6232cae4":"import os\nimport numpy as np \nimport pandas as pd \nfrom itertools import islice, cycle\nfrom more_itertools import pairwise\n\nprint('Dataset:')\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","9b71e126":"df = pd.read_csv('..\/input\/mts-library\/interactions.csv')\ndf_users = pd.read_csv('..\/input\/mts-library\/users.csv')\ndf_items = pd.read_csv('..\/input\/mts-library\/items.csv')","ee6fcf83":"df.info()","497bd143":"df['start_date'] = pd.to_datetime(df['start_date'])","fcf0c082":"duplicates = df.duplicated(subset=['user_id', 'item_id'], keep=False)\ndf_duplicates = df[duplicates].sort_values(by=['user_id', 'start_date'])\ndf = df[~duplicates]","608cfa7e":"df_duplicates = df_duplicates.groupby(['user_id', 'item_id']).agg({\n    'progress': 'max',\n    'rating': 'max',\n    'start_date': 'min'\n})\ndf = df.append(df_duplicates.reset_index(), ignore_index=True)","4849be3f":"df['progress'] = df['progress'].astype(np.int8)\ndf['rating'] = df['rating'].astype(pd.SparseDtype(np.float32, np.nan))","92758b01":"df.info()","e8d9dfee":"df.to_pickle('interactions_preprocessed.pickle')","00768913":"!ls -lah","259cac02":"df_users.head()","b7f088c2":"df_users.info()","50c13f63":"df_users.nunique()","7f3e3629":"df_users['age'] = df_users['age'].astype('category')\ndf_users['sex'] = df_users['sex'].astype(pd.SparseDtype(np.float32, np.nan))","ab4a97b4":"df_users.info()","12f44188":"interaction_users = df['user_id'].unique()\n\ncommon_users = len(np.intersect1d(interaction_users, df_users['user_id']))\nusers_only_in_interaction = len(np.setdiff1d(interaction_users, df_users['user_id']))\nusers_only_features = len(np.setdiff1d(df_users['user_id'], interaction_users))\ntotal_users = common_users + users_only_in_interaction + users_only_features\nprint(f'\u041a\u043e\u043b-\u0432\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 - {total_users}')\nprint(f'\u041a\u043e\u043b-\u0432\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 c \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f\u043c\u0438 \u0438 \u0444\u0438\u0447\u0430\u043c\u0438 - {common_users} ({common_users \/ total_users * 100:.2f}%)')\nprint(f'\u041a\u043e\u043b-\u0432\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u0442\u043e\u043b\u044c\u043a\u043e c \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f\u043c\u0438 - {users_only_in_interaction} ({users_only_in_interaction \/ total_users * 100:.2f}%)')\nprint(f'\u041a\u043e\u043b-\u0432\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u0442\u043e\u043b\u044c\u043a\u043e c \u0444\u0438\u0447\u0430\u043c\u0438 - {users_only_features} ({users_only_features \/ total_users * 100:.2f}%)')","968fdf34":"df_users.to_pickle('users_preprocessed.pickle')","1cc5d932":"!ls -lah","ede27774":"df_items.head()","dcb8b07c":"df_items.info(memory_usage='full')","997b0c4d":"def num_bytes_format(num_bytes, float_prec=4):\n    units = ['bytes', 'Kb', 'Mb', 'Gb', 'Tb', 'Pb', 'Eb']\n    for unit in units[:-1]:\n        if abs(num_bytes) < 1000:\n            return f'{num_bytes:.{float_prec}f} {unit}'\n        num_bytes \/= 1000\n    return f'{num_bytes:.4f} {units[-1]}'","231e4895":"num_bytes = df_items.memory_usage(deep=True).sum()\nnum_bytes_format(num_bytes)","c3c70156":"df_items.nunique()","bdd0950d":"df_items['year'].value_counts().tail(25)","4cde203c":"df_items[df_items['year'] == '1898, 1897, 1901']","796724f3":"for col in ['genres', 'authors', 'year']:\n    df_items[col] = df_items[col].astype('category')","79394937":"df_items.info(memory_usage='full')","18131b56":"num_bytes = df_items.memory_usage(deep=True).sum()\nnum_bytes_format(num_bytes)","b7096240":"interaction_items = df['item_id'].unique()\n\ncommon_items = len(np.intersect1d(interaction_items, df_items['id']))\nitems_only_in_interaction = len(np.setdiff1d(interaction_items, df_items['id']))\nitems_only_features = len(np.setdiff1d(df_items['id'], interaction_items))\ntotal_items = common_items + items_only_in_interaction + items_only_features\nprint(f'\u041a\u043e\u043b-\u0432\u043e \u043a\u043d\u0438\u0433 - {total_items}')\nprint(f'\u041a\u043e\u043b-\u0432\u043e \u043a\u043d\u0438\u0433 c \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f\u043c\u0438 \u0438 \u0444\u0438\u0447\u0430\u043c\u0438 - {common_items} ({common_items \/ total_items * 100:.2f}%)')\nprint(f'\u041a\u043e\u043b-\u0432\u043e \u043a\u043d\u0438\u0433 \u0442\u043e\u043b\u044c\u043a\u043e c \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f\u043c\u0438 - {items_only_in_interaction} ({items_only_in_interaction \/ total_items * 100:.2f}%)')\nprint(f'\u041a\u043e\u043b-\u0432\u043e \u043a\u043d\u0438\u0433 \u0442\u043e\u043b\u044c\u043a\u043e c \u0444\u0438\u0447\u0430\u043c\u0438 - {items_only_features} ({items_only_features \/ total_items * 100:.2f}%)')","5800b3d8":"df_items.to_pickle('items_preprocessed.pickle')","46de06d2":"!ls -lah","c316a3ff":"df_true = pd.DataFrame({\n    'user_id': ['\u0410\u043d\u044f',                '\u0411\u043e\u0440\u044f',               '\u0412\u0430\u0441\u044f',         '\u0412\u0430\u0441\u044f'],\n    'item_id': ['\u041c\u0430\u0441\u0442\u0435\u0440 \u0438 \u041c\u0430\u0440\u0433\u0430\u0440\u0438\u0442\u0430', '451\u00b0 \u043f\u043e \u0424\u0430\u0440\u0435\u043d\u0433\u0435\u0439\u0442\u0443', '\u0417\u0435\u043b\u0435\u043d\u0430\u044f \u043c\u0438\u043b\u044f', '\u0420\u0438\u0442\u0430 \u0425\u0435\u0439\u0443\u043e\u0440\u0442 \u0438 \u0441\u043f\u0430\u0441\u0435\u043d\u0438\u0435 \u0438\u0437 \u0428\u043e\u0443\u0448\u0435\u043d\u043a\u0430'],\n    'value':   [4,                    5,                    3,            5]\n})\ndf_true","2e31141a":"df_recs = pd.DataFrame({\n    'user_id': ['\u0410\u043d\u044f',                '\u0411\u043e\u0440\u044f',               '\u0412\u0430\u0441\u044f',         '\u0412\u0430\u0441\u044f'],\n    'item_id': ['\u041c\u0430\u0441\u0442\u0435\u0440 \u0438 \u041c\u0430\u0440\u0433\u0430\u0440\u0438\u0442\u0430', '451\u00b0 \u043f\u043e \u0424\u0430\u0440\u0435\u043d\u0433\u0435\u0439\u0442\u0443', '\u0417\u0435\u043b\u0435\u043d\u0430\u044f \u043c\u0438\u043b\u044f', '\u0420\u0438\u0442\u0430 \u0425\u0435\u0439\u0443\u043e\u0440\u0442 \u0438 \u0441\u043f\u0430\u0441\u0435\u043d\u0438\u0435 \u0438\u0437 \u0428\u043e\u0443\u0448\u0435\u043d\u043a\u0430'],\n    'value':   [3.28,                 3.5,                  4.06,           4.73]\n})\ndf_recs","b76e5781":"df_true = df_true.set_index(['user_id', 'item_id'])\ndf_recs = df_recs.set_index(['user_id', 'item_id'])\n\ndf_merged = df_true.join(df_recs, how='left', lsuffix='_true', rsuffix='_recs')\ndf_merged","c08fd2db":"df_merged['MAE'] = (df_merged['value_true'] - df_merged['value_recs']).abs()\ndf_merged['MSE'] = (df_merged['value_true'] - df_merged['value_recs']) ** 2\ndf_merged","608ea7dc":"print(f\"MAE  - {df_merged['MAE'].mean():.4f}\")\nprint(f\"MSE  - {df_merged['MSE'].mean():.4f}\")\nprint(f\"RMSE - {np.sqrt(df_merged['MSE'].mean()):.4f}\")","11c9b485":"df_true = pd.DataFrame({\n    'user_id': ['\u0410\u043d\u044f',                '\u0411\u043e\u0440\u044f',               '\u0412\u0430\u0441\u044f',         '\u0412\u0430\u0441\u044f'],\n    'item_id': ['\u041c\u0430\u0441\u0442\u0435\u0440 \u0438 \u041c\u0430\u0440\u0433\u0430\u0440\u0438\u0442\u0430', '451\u00b0 \u043f\u043e \u0424\u0430\u0440\u0435\u043d\u0433\u0435\u0439\u0442\u0443', '\u0417\u0435\u043b\u0435\u043d\u0430\u044f \u043c\u0438\u043b\u044f', '\u0420\u0438\u0442\u0430 \u0425\u0435\u0439\u0443\u043e\u0440\u0442 \u0438 \u0441\u043f\u0430\u0441\u0435\u043d\u0438\u0435 \u0438\u0437 \u0428\u043e\u0443\u0448\u0435\u043d\u043a\u0430'],\n})\ndf_true","6d1215cb":"df_recs = pd.DataFrame({\n    'user_id': [\n        '\u0410\u043d\u044f', '\u0410\u043d\u044f', '\u0410\u043d\u044f', \n        '\u0411\u043e\u0440\u044f', '\u0411\u043e\u0440\u044f', '\u0411\u043e\u0440\u044f', \n        '\u0412\u0430\u0441\u044f', '\u0412\u0430\u0441\u044f', '\u0412\u0430\u0441\u044f',\n    ],\n    'item_id': [\n        '\u041e\u0442\u0432\u0435\u0440\u0436\u0435\u043d\u043d\u044b\u0435', '\u0414\u0432\u0435\u043d\u0430\u0434\u0446\u0430\u0442\u044c \u0441\u0442\u0443\u043b\u044c\u0435\u0432', '\u0413\u0435\u0440\u043e\u0438 \u043d\u0430\u0448\u0435\u0433\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438', \n        '451\u00b0 \u043f\u043e \u0424\u0430\u0440\u0435\u043d\u0433\u0435\u0439\u0442\u0443', '1984', '\u041e \u0434\u0438\u0432\u043d\u044b\u0439 \u043d\u043e\u0432\u044b\u0439 \u043c\u0438\u0440',\n        '\u0414\u0435\u0441\u044f\u0442\u044c \u043d\u0435\u0433\u0440\u0438\u0442\u044f\u0442', '\u0418\u0441\u043a\u0440\u0430 \u0436\u0438\u0437\u043d\u0438', '\u0417\u0435\u043b\u0435\u043d\u0430\u044f \u043c\u0438\u043b\u044f', \n    ],\n    'rank': [\n        1, 2, 3,\n        1, 2, 3,\n        1, 2, 3,\n    ]\n})\ndf_recs","e5f44db1":"df_merged = df_true.set_index(['user_id', 'item_id']).join(df_recs.set_index(['user_id', 'item_id']), how='left')\ndf_merged","5fc76c2b":"df_merged['hit@2'] = df_merged['rank'] <= 2\ndf_merged","3af6d98a":"df_merged['hit@2\/2'] = df_merged['hit@2'] \/ 2\ndf_merged","b4bceaea":"df_prec2 = df_merged.groupby(level=0)['hit@2\/2'].sum()\ndf_prec2","211949f9":"print(f'Precision@2 - {df_prec2.mean()}')","8a5eb010":"df_merged['hit@2\/2'].sum() \/ df_merged.index.get_level_values('user_id').nunique()","fdd0ece2":"users_count = df_merged.index.get_level_values('user_id').nunique()\nfor k in [1, 2, 3]:\n    hit_k = f'hit@{k}'\n    df_merged[hit_k] = df_merged['rank'] <= k\n    print(f'Precision@{k} = {(df_merged[hit_k] \/ k).sum() \/ users_count:.4f}')","d2f212a4":"df_merged['users_item_count'] = df_merged.groupby(level='user_id')['rank'].transform(np.size)\ndf_merged","1b3861c0":"for k in [1, 2, 3]:\n    hit_k = f'hit@{k}'\n    # \u0423\u0436\u0435 \u043f\u043e\u0441\u0447\u0438\u0442\u0430\u043d\u043e\n    # df_merged[hit_k] = df_merged['rank'] <= k  \n    print(f\"Recall@{k} = {(df_merged[hit_k] \/ df_merged['users_item_count']).sum() \/ users_count:.4f}\")","4695ffe6":"df_true = pd.DataFrame({\n    'user_id': ['\u0410\u043d\u044f',                '\u0411\u043e\u0440\u044f',               '\u0412\u0430\u0441\u044f',         '\u0412\u0430\u0441\u044f'],\n    'item_id': ['\u041c\u0430\u0441\u0442\u0435\u0440 \u0438 \u041c\u0430\u0440\u0433\u0430\u0440\u0438\u0442\u0430', '451\u00b0 \u043f\u043e \u0424\u0430\u0440\u0435\u043d\u0433\u0435\u0439\u0442\u0443', '\u0417\u0435\u043b\u0435\u043d\u0430\u044f \u043c\u0438\u043b\u044f', '\u0420\u0438\u0442\u0430 \u0425\u0435\u0439\u0443\u043e\u0440\u0442 \u0438 \u0441\u043f\u0430\u0441\u0435\u043d\u0438\u0435 \u0438\u0437 \u0428\u043e\u0443\u0448\u0435\u043d\u043a\u0430'],\n})\ndf_true ","61aea95b":"df_recs = pd.DataFrame({\n    'user_id': [\n        '\u0410\u043d\u044f', '\u0410\u043d\u044f', '\u0410\u043d\u044f', \n        '\u0411\u043e\u0440\u044f', '\u0411\u043e\u0440\u044f', '\u0411\u043e\u0440\u044f', \n        '\u0412\u0430\u0441\u044f', '\u0412\u0430\u0441\u044f', '\u0412\u0430\u0441\u044f',\n    ],\n    'item_id': [\n        '\u041e\u0442\u0432\u0435\u0440\u0436\u0435\u043d\u043d\u044b\u0435', '\u0414\u0432\u0435\u043d\u0430\u0434\u0446\u0430\u0442\u044c \u0441\u0442\u0443\u043b\u044c\u0435\u0432', '\u0413\u0435\u0440\u043e\u0438 \u043d\u0430\u0448\u0435\u0433\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438', \n        '451\u00b0 \u043f\u043e \u0424\u0430\u0440\u0435\u043d\u0433\u0435\u0439\u0442\u0443', '1984', '\u041e \u0434\u0438\u0432\u043d\u044b\u0439 \u043d\u043e\u0432\u044b\u0439 \u043c\u0438\u0440',\n        '\u0414\u0435\u0441\u044f\u0442\u044c \u043d\u0435\u0433\u0440\u0438\u0442\u044f\u0442', '\u0420\u0438\u0442\u0430 \u0425\u0435\u0439\u0443\u043e\u0440\u0442 \u0438 \u0441\u043f\u0430\u0441\u0435\u043d\u0438\u0435 \u0438\u0437 \u0428\u043e\u0443\u0448\u0435\u043d\u043a\u0430', '\u0417\u0435\u043b\u0435\u043d\u0430\u044f \u043c\u0438\u043b\u044f', \n    ],\n    'rank': [\n        1, 2, 3,\n        1, 2, 3,\n        1, 2, 3,\n    ]\n})\ndf_recs","437b688a":"df_merged = df_true.set_index(['user_id', 'item_id']).join(df_recs.set_index(['user_id', 'item_id']), how='left')\ndf_merged = df_merged.sort_values(by=['user_id', 'rank'])\ndf_merged","10c86b65":"df_merged['reciprocal_rank'] = 1 \/ df_merged['rank']\ndf_merged","57eeea9b":"mrr = df_merged.groupby(level='user_id')['reciprocal_rank'].max()\nmrr","3684861c":"print(f\"MRR = {mrr.fillna(0).mean()}\")","62105b49":"df_merged['cumulative_rank'] = df_merged.groupby(level='user_id').cumcount() + 1\ndf_merged['cumulative_rank'] = df_merged['cumulative_rank'] \/ df_merged['rank']\ndf_merged['users_item_count'] = df_merged.groupby(level='user_id')['rank'].transform(np.size)\ndf_merged","b09c4338":"users_count = df_merged.index.get_level_values('user_id').nunique()\nmap3 = (df_merged[\"cumulative_rank\"] \/ df_merged[\"users_item_count\"]).sum() \/ users_count\nprint(f\"MAP@3 = {map3}\")","fbaaf15e":"test_dates = df['start_date'].unique()[-7:]\ntest_dates","f12b6d89":"test_dates = list(pairwise(test_dates))\ntest_dates","593893f9":"split_dates = test_dates[0]\ntrain = df[df['start_date'] < split_dates[0]]\ntest = df[(df['start_date'] >= split_dates[0]) & (df['start_date'] < split_dates[1])]\ntest = test[(test['rating'] >= 4) | (test['rating'].isnull())]\nsplit_dates, train.shape, test.shape","d399d8a4":"class PopularRecommender():\n    def __init__(self, max_K=100, days=30, item_column='item_id', dt_column='date'):\n        self.max_K = max_K\n        self.days = days\n        self.item_column = item_column\n        self.dt_column = dt_column\n        self.recommendations = []\n        \n    def fit(self, df, ):\n        min_date = df[self.dt_column].max().normalize() - pd.DateOffset(days=self.days)\n        self.recommendations = df.loc[df[self.dt_column] > min_date, self.item_column].value_counts().head(self.max_K).index.values\n    \n    def recommend(self, users=None, N=10):\n        recs = self.recommendations[:N]\n        if users is None:\n            return recs\n        else:\n            return list(islice(cycle([recs]), len(users)))","361344cd":"pop_model = PopularRecommender(days=7, dt_column='start_date')\npop_model.fit(train)","59386c18":"top10_recs = pop_model.recommend()\ntop10_recs","e6585556":"item_titles = pd.Series(df_items['title'].values, index=df_items['id']).to_dict()\nitem_titles[128115]","5862bf33":"list(map(item_titles.get, top10_recs))","1cc73161":"recs = pd.DataFrame({'user_id': test['user_id'].unique()})\ntop_N = 10\nrecs['item_id'] = pop_model.recommend(recs['user_id'], N=top_N)\nrecs.head()","11b3c886":"recs = recs.explode('item_id')\nrecs.head(top_N + 2)","4398285d":"recs['rank'] = recs.groupby('user_id').cumcount() + 1\nrecs.head(top_N + 2)","03dcf65f":"test_recs = test.set_index(['user_id', 'item_id']).join(recs.set_index(['user_id', 'item_id']))\ntest_recs = test_recs.sort_values(by=['user_id', 'rank'])\ntest_recs.tail()","69c8a6fc":"test_recs['users_item_count'] = test_recs.groupby(level='user_id', sort=False)['rank'].transform(np.size)\ntest_recs['reciprocal_rank'] = 1 \/ test_recs['rank']\ntest_recs['reciprocal_rank'] = test_recs['reciprocal_rank'].fillna(0)\ntest_recs['cumulative_rank'] = test_recs.groupby(level='user_id').cumcount() + 1\ntest_recs['cumulative_rank'] = test_recs['cumulative_rank'] \/ test_recs['rank']\ntest_recs.tail()","4779647e":"test_recs[test_recs['rank'].notnull()].head()","0d313bfe":"print(f'\u041c\u0435\u0442\u0440\u0438\u043a \u043f\u043e test ({str(split_dates[0])[:10]}, {str(split_dates[1])[:10]})')\nusers_count = test_recs.index.get_level_values('user_id').nunique()\nfor k in range(1, top_N + 1):\n    hit_k = f'hit@{k}'\n    test_recs[hit_k] = test_recs['rank'] <= k\n    print(f'Precision@{k} = {(test_recs[hit_k] \/ k).sum() \/ users_count:.4f}')\n    print(f\"Recall@{k} = {(test_recs[hit_k] \/ test_recs['users_item_count']).sum() \/ users_count:.4f}\")\n\nmapN = (test_recs[\"cumulative_rank\"] \/ test_recs[\"users_item_count\"]).sum() \/ users_count\nprint(f\"MAP@{top_N} = {mapN}\")\n\nmrr = test_recs.groupby(level='user_id')['reciprocal_rank'].max().mean()\nprint(f\"MRR = {mrr}\")","f2001f37":"Precision@K \u0438 Recall@K \u043d\u0435\u043f\u043b\u043e\u0445\u0438\u0435 \u043c\u0435\u0442\u0440\u0438\u043a\u0438, \u0447\u0442\u043e\u0431\u044b \u043e\u0446\u0435\u043d\u0438\u0442\u044c \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u043e \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u0439, \u043d\u043e \u043e\u043d\u0438 \u0443\u0447\u0438\u0442\u044b\u0432\u0430\u044e\u0442 \u0442\u043e\u043b\u044c\u043a\u043e \"\u043f\u043e\u043f\u0430\u0434\u0430\u043d\u0438\u044f\" (hits, true positives). \n\u041d\u043e \u043d\u0430 \u0441\u0430\u043c\u043e\u043c \u0434\u0435\u043b\u0435 \u043d\u0430\u043c \u0432\u0430\u0436\u043d\u043e \u043d\u0430\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0432\u044b\u0441\u043e\u043a\u043e \u043f\u043e \u043f\u043e\u0437\u0438\u0446\u0438\u044f\u043c \u043d\u0430\u0445\u043e\u0434\u044f\u0442\u0441\u044f \u044d\u0442\u0438 \u0441\u0430\u043c\u044b\u0435 \u043f\u043e\u043f\u0430\u0434\u0430\u043d\u0438\u044f. \n\n\u041f\u0440\u043e\u0441\u0442\u043e\u0439 \u043f\u0440\u0438\u043c\u0435\u0440, \u043f\u0443\u0441\u0442\u044c \u0434\u0432\u0435 \u043c\u043e\u0434\u0435\u043b\u0438 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u0439 \u0434\u043b\u044f \u043e\u0434\u043d\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u043f\u043e\u043b\u0443\u0447\u0438\u043b\u0438 \u0442\u0430\u043a\u0438\u0435 hit@3 \u043d\u0430 \u0442\u0435\u0441\u0442\u0435:\n* model1 - 1, 0, 0, 1\n* model2 - 1, 0, 1, 0\n\nPrecision@4 \u0434\u043b\u044f \u043d\u0438\u0445 \u0431\u0443\u0434\u0435\u0442 \u043e\u0434\u0438\u043d\u0430\u043a\u043e\u0432\u044b\u0439 - 0.5, \u0445\u043e\u0442\u044f model2 \u043d\u0435\u043c\u043d\u043e\u0433\u043e \u043b\u0443\u0447\u0448\u0435, \u0442\u0430\u043a \u043a\u0430\u043a 2-\u043e\u0435 \u043f\u043e\u043f\u0430\u0434\u0430\u043d\u0438\u0435 \u043d\u0430\u0445\u043e\u0434\u0438\u0442\u0441\u044f \u0432\u044b\u0448\u0435, \u0447\u0435\u043c \u0443 model1","be5f23b0":"<a id=\"metrics\"><\/a>\n# Metrics\n\n\u041a\u0430\u043a \u044d\u0442\u043e \u0432\u043e\u0434\u0438\u0442\u0441\u044f \u0432 \u043c\u0430\u0448\u0438\u043d\u043d\u043e\u043c \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u0438, \u0434\u043b\u044f \u043f\u043e\u0434\u0441\u0447\u0435\u0442\u0430 \u043c\u0435\u0442\u0440\u0438\u043a \u043d\u0430\u043c \u043d\u0443\u0436\u043d\u043e \u0434\u0432\u0430 \u043c\u0430\u0441\u0441\u0438\u0432\u0430: \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439 \u043e\u0442\u0432\u0435\u0442\u044b \u0438 \u043f\u0440\u0435\u0434\u0441\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0435 \u043e\u0442\u0432\u0435\u0442\u044b.\n\u0418 \u0435\u0441\u043b\u0438 \u0432 \u043a\u043b\u0430\u0441\u0441\u0438\u0447\u0435\u0441\u043a\u043e\u043c \u043c\u0430\u0448\u0438\u043d\u043d\u043e\u043c \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u0438 \u044d\u0442\u043e \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0434\u0432\u0430 \u043c\u0430\u0441\u0441\u0438\u0432\u0430, \u0442\u043e \u0432 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0445 \u0441\u0438\u0441\u0442\u0435\u043c\u0430\u0445 \u043d\u0430\u043c \u043d\u0443\u0436\u043d\u0430 \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u0432 \u043a\u0430\u0447\u0435\u0432\u0441\u0442\u0432\u0435 \u043a\u043b\u044e\u0447\u0430 \u0438\u043b\u0438 \u0438\u043d\u0434\u0435\u043a\u0441\u0430 \u0431\u0443\u0434\u0435\u0442 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u043f\u0430\u0440\u044b \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c-\u043e\u0431\u044a\u0435\u043a\u0442.\n\n\u0412 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u0442\u0430\u043a\u043e\u0439 \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u044b \u0432\u043f\u043e\u043b\u043d\u0435 \u043f\u043e\u0434\u043e\u0439\u0434\u0435\u0442 \u0443\u0436\u0435 \u0438\u0437\u0432\u0435\u0441\u0442\u043d\u044b\u0439 pandas.DataFrame. \n\u041f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0435 \u043c\u0435\u0442\u043a\u0438 (true) \u043c\u044b \u043c\u043e\u0436\u0435\u043c \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u0432 \u0432\u0438\u0434\u0435 dataframe \u0441\u043e \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u043c\u0438 \u0441\u0442\u043e\u043b\u0431\u0446\u0430\u043c\u0438:\n* user_id - ID \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\n* item_id - ID \u043e\u0431\u044a\u0435\u043a\u0442\u0430\n* value - \u043e\u0446\u0435\u043d\u043a\u0430 \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f (\u043e\u043f\u0446\u0438\u043e\u043d\u0430\u043b\u044c\u043d\u043e, \u043c\u043e\u0436\u0435\u0442 \u0438 \u043d\u0435 \u0431\u044b\u0442\u044c, \u0435\u0441\u043b\u0438 \u043c\u044b, \u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u0437\u0430 \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u0431\u0435\u0440\u0435\u043c \u043f\u0440\u043e\u0441\u0442\u043e \u043a\u043b\u0438\u043a \u0438\u043b\u0438 \u0444\u0430\u043a\u0442 \u043f\u043e\u043a\u0443\u043f\u043a\u0438)\n\n\u0421\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0435\u043d\u043d\u043e, \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u0438\/\u043f\u0440\u0435\u0434\u0441\u043a\u0430\u0437\u0430\u043d\u0438\u044f (recs) \u0432 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u043c:\n* user_id - ID \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\n* item_id - ID \u043e\u0431\u044a\u0435\u043a\u0442\u0430\n* value - \u043f\u0440\u0435\u0434\u0441\u043a\u0430\u0437\u0430\u043d\u043d\u0430\u044f \u043e\u0446\u0435\u043d\u043a\u0430 \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \n    * \u0427\u0438\u0441\u043b\u0435\u043d\u043d\u0430\u044f \u043e\u0446\u0435\u043d\u043a\u0430, \u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 \u0440\u0435\u0439\u0442\u0438\u043d\u0433\n    * \u041f\u043e\u0437\u0438\u0446\u0438\u044f, \u0435\u0441\u043b\u0438 \u043c\u044b \u0440\u0430\u043d\u0436\u0438\u0440\u0443\u0435\u043c \u043a\u043e\u043d\u0442\u0435\u043d\u0442\n    \n\u0414\u043b\u044f \u043f\u043e\u0434\u0441\u0447\u0435\u0442\u0430 \u043c\u0435\u0442\u0440\u0438\u043a \u043c\u044b \u043c\u043e\u0436\u0435\u043c \u043e\u0431\u044a\u0435\u0434\u0438\u043d\u0438\u0442\u044c \u044d\u0442\u0438 \u0434\u0432\u0430 \u0434\u0430\u0442\u0430\u0444\u0440\u0435\u043c\u0430 \u043f\u043e `(user_id, item_id)`. \u0412 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u043c\u0435\u0442\u043e\u0434\u0430 \u043e\u0431\u044a\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f \u043c\u043e\u0436\u043d\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043c\u0435\u0442\u043e\u0434\u044b join\/merge \u0438\u0437 pandas.DataFrame.","29fd72c2":"<a id=\"general-marks\"><\/a>\n# General marks\n\n\u041e\u0441\u043d\u043e\u0432\u043d\u0430\u044f \u0446\u0435\u043b\u044c \u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u0438 - \u043e\u0446\u0435\u043d\u0438\u0442\u044c \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u043e \u043c\u043e\u0434\u0435\u043b\u0438 \u043f\u0435\u0440\u0435\u0434 \u0432\u043d\u0435\u0434\u0440\u0435\u043d\u0438\u0435\u043c \u0432 \"\u043f\u0440\u043e\u0434\u0430\u043a\u0448\u0435\u043d\" \u0438\u043b\u0438 \u0441\u0430\u0431\u043c\u0438\u0442\u043e\u043c \u0432 \u0441\u043e\u0440\u0435\u0432\u043d\u043e\u0432\u0430\u043d\u0438\u0438. \u041e\u0442\u0441\u044e\u0434\u0430 \u0432\u044b\u0442\u0435\u043a\u0430\u0435\u0442 \u043e\u0434\u043d\u043e \u0438\u0437 \u0441\u0430\u043c\u044b\u0445 \u0432\u0430\u0436\u043d\u044b\u0445 \u0442\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u0435 \u043a \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0443 \u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u0438 - *\u0441\u0445\u0435\u043c\u0430 \u0434\u043e\u043b\u0436\u043d\u0430 \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e \u0442\u043e\u0447\u043d\u043e \u0432\u043e\u0441\u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u044c \u0443\u0441\u043b\u043e\u0432\u0438\u044f, \u0432 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u043c\u043e\u0434\u0435\u043b\u044c \u0431\u0443\u0434\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f.* \u042d\u0442\u043e \u043a\u0430\u0441\u0430\u0435\u0442\u0441\u044f \u043a\u0430\u043a \u043f\u0440\u043e\u0434\u0430\u043a\u0448\u0435\u043d\u0430, \u0442\u0430\u043a \u0438 \u0441\u043e\u0440\u0435\u0432\u043d\u043e\u0432\u0430\u043d\u0438\u0439, \u043f\u0440\u0438\u0447\u0435\u043c \u043d\u0435 \u0442\u043e\u043b\u044c\u043a\u043e \u0432 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0445 \u0441\u0438\u0441\u0442\u0435\u043c\u0430\u0445, \u0430 \u0432 \u043b\u044e\u0431\u043e\u0439 \u0437\u0430\u0434\u0430\u0447\u0435 \u043c\u0430\u0448\u0438\u043d\u043d\u043e\u0433\u043e \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f. **\u041f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u0430\u044f \u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u044f - \u043a\u043b\u044e\u0447 \u043a \u0443\u0441\u043f\u0435\u0445\u0443** :)\n\n\u041a\u043b\u044e\u0447\u0435\u0432\u044b\u0435 \u0432\u043e\u043f\u0440\u043e\u0441\u044b, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043d\u0430\u0434\u043e \u043e\u0442\u0432\u0435\u0442\u0438\u0442\u044c:\n* \u0427\u0442\u043e \u0445\u043e\u0442\u0438\u043c \u043e\u0442 \u043c\u043e\u0434\u0435\u043b\u0438?\n    * \u041f\u0440\u0435\u0434\u0441\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0434\u043b\u044f \u043f\u0430\u0440\u044b \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c-\u043e\u0431\u044a\u0435\u043a\u0442 (\u0440\u0435\u0439\u0442\u0438\u043d\u0433 \u0438\u043b\u0438 \u0432\u0435\u0440\u043e\u044f\u0442\u043d\u043e\u0441\u0442\u044c)\n    * \u0420\u0430\u043d\u0436\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432 \u0434\u043b\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f (\u0442\u043e\u043f \u0444\u0438\u043b\u044c\u043c\u043e\u0432)\n* \u041a\u0430\u043a \u0431\u0443\u0434\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u043c\u043e\u0434\u0435\u043b\u044c? \n    * \u0420\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u0438 \u0431\u0443\u0434\u0443\u0442 \u0441\u0447\u0438\u0442\u0430\u0442\u044c\u0441\u044f \u0431\u0430\u0442\u0447\u0430\u043c\u0438 \u0440\u0430\u0437 \u0432 \u043f\u0435\u0440\u0438\u043e\u0434 (1 \u0440\u0430\u0437 \u0432 \u0434\u0435\u043d\u044c)\n    * \u041e\u043d\u043b\u0430\u0439\u043d-\u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u0438\n    * \u0421\u0432\u044f\u0437\u044c \u0431\u0438\u0437\u043d\u0435\u0441-\u043c\u0435\u0442\u0440\u0438\u043a \u0441 \u043e\u0444\u0444\u043b\u0430\u0439\u043d-\u043c\u0435\u0442\u0440\u0438\u043a\u0430\u043c\u0438\n* \u041a\u0430\u043a\u0438\u0435 \u0442\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u044f?\n    * \u041f\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u043f\u043e\u0441\u0442\u0440\u043e\u0435\u043d\u0438\u044f \u043a\u0430\u043a \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u0432 \u0446\u0435\u043b\u043e\u043c, \u0442\u0430\u043a \u0438 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u044b\u0445 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u0439 (\u0447\u0435\u043c \u043c\u0435\u043d\u044c\u0448\u0435 \"\u0436\u0435\u043b\u0435\u0437\u0430\", \u0442\u0435\u043c \u043f\u0440\u043e\u0449\u0435 \u0434\u043e\u043b\u0436\u043d\u0430 \u0431\u044b\u0442\u044c \u043c\u043e\u0434\u0435\u043b\u044c)\n    * \u041a\u0430\u043a\u0438\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u0431\u0443\u0434\u0443\u0442 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b \u0432 \u043e\u043d\u043b\u0430\u0439\u043d-\u0440\u0435\u0436\u0438\u043c\u0435\n* \u041a\u0430\u043a \u0435\u0441\u0442\u044c \u043e\u0441\u043e\u0431\u0435\u043d\u043d\u043e\u0441\u0442\u0438 \u0443 \u0437\u0430\u0434\u0430\u0447\u0438?\n    * \u0420\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0443\u0435\u043c \u043b\u0438 \u0434\u043b\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u043e\u0431\u044a\u0435\u043a\u0442\u044b, \u0441 \u043a\u043e\u0442\u043e\u0440\u044b\u043c \u043e\u043d \u0443\u0436\u0435 \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u043e\u0432\u0430\u043b (\u0434\u043b\u044f \u0444\u0438\u043b\u044c\u043c\u043e\u0432 \u0438\u043b\u0438 \u043a\u043d\u0438\u0433 - \u0441\u043a\u043e\u0440\u0435\u0435 \u0432\u0441\u0435\u0433\u043e \u043d\u0435\u0442, \u0434\u043b\u044f \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u043e\u0432\u043e\u0433\u043e \u0440\u0438\u0442\u0435\u0439\u043b\u0430 - \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u0438 \u0434\u0430)\n    * Cold-start - \u043a\u0430\u043a \u043c\u043d\u043e\u0433\u043e \u043f\u043e\u044f\u0432\u0438\u0442\u0441\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u0438\u043b\u0438 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432, \u0434\u043b\u044f \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u043d\u0435 \u0438\u0437\u0432\u0435\u0441\u0442\u043d\u0430\u044f \u0438\u0441\u0442\u043e\u0440\u0438\u044f \u043f\u043e \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f\u043c\n    * \u041a\u0430\u043a \u043c\u043d\u043e\u0433\u043e \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0439 \u043f\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\u043c \u0435\u0441\u0442\u044c \u0432 \u0434\u0430\u043d\u043d\u044b\u0445","ee8fd991":"**Mean Reciprocal Rank**\n![image.png](attachment:image.png)\n\u0413\u0434\u0435 Q - \u044d\u0442\u043e query \u0438\u043b\u0438 \u043d\u0430\u0448 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c, \u0430 rank_i - \u043f\u043e\u0437\u0438\u0446\u0438\u044f \u043f\u0435\u0440\u0432\u043e\u0439 \u0440\u0435\u043b\u0435\u0432\u0430\u043d\u0442\u043d\u043e\u0439 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u0438","0247e686":"<a id=\"regression\"><\/a>\n## Regression\n\n\u042d\u0442\u0438 \u043c\u0435\u0442\u0440\u0438\u043a\u0438 \u043e\u0446\u0435\u043d\u0438\u0432\u0430\u044e\u0442 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u0440\u0435\u0434\u0441\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0445 \u0447\u0438\u0441\u043b\u0435\u043d\u043d\u044b\u0445 \u043e\u0446\u0435\u043d\u043e\u043a. \u041f\u0440\u0438\u043c\u0435\u0440\u044b \u043c\u0435\u0442\u0440\u0438\u043a:\n* Mean Squared Error - \u0441\u0440\u0435\u0434\u043d\u0435\u043a\u0432\u0430\u0434\u0440\u0430\u0442\u0438\u0447\u043d\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430\n* Root Mean Squared Error - \u043a\u043e\u0440\u0435\u043d\u044c \u0438\u0437 \u0441\u0440\u0435\u0434\u043d\u0435\u043a\u0432\u0430\u0434\u0440\u0430\u0442\u0438\u0447\u043d\u043e\u0439 \u043e\u0448\u0438\u0431\u043a\u0438\n* Mean Absolute Error - \u0441\u0440\u0435\u0434\u043d\u0438\u0439 \u043e\u0448\u0438\u0431\u043a\u0430 \u043f\u043e \u043c\u043e\u0434\u0443\u043b\u044e\n![image.png](attachment:image.png)\n\u042d\u0442\u0438 \u043c\u0435\u0442\u0440\u0438\u043a\u0438 \u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u044e\u0442\u0441\u044f, \u043a\u0430\u043a \u0445\u043e\u0440\u043e\u0448\u043e \u043c\u043e\u0434\u0435\u043b\u044c \"\u0432\u043e\u0441\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0435\u0442\" \u043a\u0430\u043a\u0438\u0435-\u0442\u043e \u0447\u0438\u0441\u043b\u0435\u043d\u043d\u044b\u0435 \u043e\u0446\u0435\u043d\u043a\u0438, \u043d\u043e \u043d\u0435 \u0442\u043e, \u043d\u0430\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0445\u043e\u0440\u043e\u0448\u0438 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u0438","3e9755c0":"![image.png](attachment:image.png)","9417fff4":"\u041f\u043e\u0447\u0435\u043c\u0443 \u043a\u043e\u043b\u043e\u043d\u043a\u0430 `year` \u0442\u0438\u043f\u0430 `object`, \u0430 \u043d\u0435 `int`?","95cfc1c3":"<a id=\"classification\"><\/a>\n## Classification\n\n\u042d\u0442\u0438 \u043c\u0435\u0442\u0440\u0438\u043a\u0438 \u043e\u0446\u0435\u043d\u0438\u0432\u0430\u044e\u0442 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u043e \u0442\u043e\u043f-N \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u0439. \u0412 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u043d\u0430\u043f\u0440\u044f\u043c\u0443\u044e \u043f\u0435\u0440\u0435\u043a\u043e\u0447\u0435\u0432\u0430\u043b\u0438 \u0438\u0437 \u043c\u0435\u0442\u043e\u0434\u043e\u0432 \u043e\u0446\u0435\u043d\u043a\u0438 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0430 \u0431\u0438\u043d\u0430\u0440\u043d\u043e\u0439 \u043a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438.\n\u0412\u0441\u0435 \u0441\u0447\u0438\u0442\u0430\u0435\u0442\u0441\u044f \u043d\u0430 \u043e\u0441\u043d\u043e\u0432\u0435 4 \u0431\u0430\u0437\u043e\u0432\u044b\u0445 \u0441\u043b\u0443\u0447\u0430\u0435\u0432:\n* True positive  (TP) - \u043c\u043e\u0434\u0435\u043b\u044c \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u043e\u0432\u0430\u043b\u0430 \u043e\u0431\u044a\u0435\u043a\u0442, \u0441 \u043a\u043e\u0442\u043e\u0440\u044b\u043c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043f\u0440\u043e\u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u043e\u0432\u0430\u043b\n* False positive (FP) - \u043c\u043e\u0434\u0435\u043b\u044c \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u043e\u0432\u0430\u043b\u0430 \u043e\u0431\u044a\u0435\u043a\u0442, \u0441 \u043a\u043e\u0442\u043e\u0440\u044b\u043c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043d\u0435 \u043f\u0440\u043e\u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u043e\u0432\u0430\u043b\n* True negative  (TN) - \u043c\u043e\u0434\u0435\u043b\u044c \u043d\u0435 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u043e\u0432\u0430\u043b\u0430 \u043e\u0431\u044a\u0435\u043a\u0442, \u0441 \u043a\u043e\u0442\u043e\u0440\u044b\u043c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043d\u0435 \u043f\u0440\u043e\u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u043e\u0432\u0430\u043b\n* False negative (FN) - \u043c\u043e\u0434\u0435\u043b\u044c \u043d\u0435 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u043e\u0432\u0430\u043b\u0430 \u043e\u0431\u044a\u0435\u043a\u0442, \u0441 \u043a\u043e\u0442\u043e\u0440\u044b\u043c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043f\u0440\u043e\u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u043e\u0432\u0430\u043b\n\n\u0427\u0442\u043e \u0438\u0437 \u044d\u0442\u043e\u0433\u043e \u0432\u0441\u0435\u0433\u043e \u0432\u0430\u0436\u043d\u0435\u0439? \u0412 \u043f\u0435\u0440\u0432\u0443\u044e \u043e\u0447\u0435\u0440\u0435\u0434\u044c \u044d\u0442\u043e True positive. \u041c\u044b \u0445\u043e\u0442\u0438\u043c \u0441\u0442\u0440\u043e\u0438\u0442\u044c \u043d\u0430\u0438\u0431\u043e\u043b\u0435\u0435 \u0440\u0435\u043b\u0435\u0432\u0430\u043d\u0442\u043d\u044b\u0435 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u0438 \u0434\u043b\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f. \n\u0412\u043e \u0432\u0442\u043e\u0440\u0443\u044e \u043e\u0447\u0435\u0440\u0435\u0434\u044c \u044d\u0442\u043e False negative, \u043e\u043f\u044f\u0442\u044c \u0436\u0435 \u043f\u043e\u0442\u043e\u043c\u0443, \u0447\u0442\u043e \u043c\u044b \u043d\u0435 \u0445\u043e\u0442\u0438\u043c, \u0447\u0442\u043e\u0431\u044b \u043c\u043e\u0434\u0435\u043b\u044c \"\u0442\u0435\u0440\u044f\u043b\u0430\" \u0440\u0435\u043b\u0435\u0432\u0430\u043d\u0442\u043d\u044b\u0435 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u0438.\n\n\u0410 \u0447\u0442\u043e \u0441 FP \u0438 TN? \u041d\u0430 \u0441\u0430\u043c\u043e\u043c \u0434\u0435\u043b\u0435, \u044d\u0442\u0438 \u0432\u0435\u043b\u0438\u0447\u0438\u043d\u044b \u043d\u0435 \u043f\u043e\u043a\u0430\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u044b. \u041e\u043d\u0438 \u043e\u0431\u044b\u0447\u043d\u043e \u043e\u0447\u0435\u043d\u044c \u0431\u043e\u043b\u044c\u0448\u0435, \u0442\u0430\u043a \u043a\u0430\u043a \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0438 \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0443\u044e\u0442 \u0441 \u043e\u0447\u0435\u043d\u044c \u043c\u0430\u043b\u044b\u043c \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432 \u043e\u0442\u043d\u043e\u0441\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u043e\u0431\u0449\u0435\u0433\u043e \u0447\u0438\u0441\u043b\u0430 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432.\n\u0418 \u043f\u0440\u0430\u043a\u0442\u0438\u043a\u0430 \u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442, \u0447\u0442\u043e \u044d\u0442\u0438\u043c\u0438 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f\u043c\u0438 \u043c\u043e\u0436\u043d\u043e \u043f\u0440\u0435\u043d\u0435\u0431\u0440\u0435\u0447\u044c.\n\n\u0414\u043b\u044f \u0438\u0437\u043c\u0435\u0440\u0435\u043d\u0438\u044f \u0434\u043e\u043b\u0438 TP \u0438 FN \u043f\u0440\u0438\u043c\u0435\u043d\u044f\u044e\u0442\u0441\u044f \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0435 \u043c\u0435\u0442\u0440\u0438\u043a\u0438:\n* **Precision@K** - \u0434\u043e\u043b\u044f \u0440\u0435\u043b\u0435\u0432\u0430\u043d\u0442\u043d\u044b\u0445 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u0439 \u0441\u0440\u0435\u0434\u0438 \u0432\u0441\u0435\u0445 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u0439\n    * \u0424\u043e\u0440\u043c\u0443\u043b\u0430 - `TP \/ (TP + FP)`\n    * \u041c\u043e\u0436\u043d\u043e \u0437\u0430\u043c\u0435\u0442\u0438\u0442\u044c, \u0447\u0442\u043e \u043f\u043e\u0434 positives \u043c\u044b \u043f\u043e\u043d\u0438\u043c\u0430\u0435\u043c \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u043e\u0432\u0430\u043d\u043d\u044b\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u044b, \u0442\u043e \u0435\u0441\u0442\u044c \u043d\u0430\u0448 \u0442\u043e\u043f-\u041a, \u0437\u043d\u0430\u0447\u0438\u0442 `TP + FP = K`\n    * \u0418\u0442\u043e\u0433\u043e\u0432\u0430\u044f \u0444\u043e\u0440\u043c\u0443\u043b\u0430 - `TP \/ K`\n    * \u0421\u0447\u0438\u0442\u0430\u0435\u043c \u043f\u043e \u043a\u0430\u0436\u0434\u043e\u043c\u0443 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044e \u0438 \u0434\u043b\u044f \u043d\u0435\u043a\u0442\u043e\u0440\u044b\u0445 \u041a\n    * \u0423\u0441\u0440\u0435\u0434\u043d\u044f\u0435\u043c \u043f\u043e \u0432\u0441\u0435\u043c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\n* **Recall@K** - \u0434\u043e\u043b\u044f \u0440\u0435\u043b\u0435\u0432\u0430\u043d\u0442\u043d\u044b\u0445 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u0439 \u0441\u0440\u0435\u0434\u0438 \u0432\u0441\u0435\u0445 \u0440\u0435\u043b\u0435\u0432\u0430\u043d\u0442\u043d\u044b\u0445 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432\n    * \u0424\u043e\u0440\u043c\u0443\u043b\u0430 - `TP \/ (TP + FN)`\n    * `TP + FN` \u044d\u0442\u043e \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0438\u0437\u0432\u0435\u0441\u0442\u043d\u044b\u0445 \u0440\u0435\u043b\u0435\u0432\u0430\u043d\u0442\u044b\u0445 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432 \u0434\u043b\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\n    * \u0421\u0447\u0438\u0442\u0430\u0435\u043c \u043f\u043e \u043a\u0430\u0436\u0434\u043e\u043c\u0443 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044e \u0438 \u0434\u043b\u044f \u043d\u0435\u043a\u0442\u043e\u0440\u044b\u0445 \u041a\n    * \u0423\u0441\u0440\u0435\u0434\u043d\u044f\u0435\u043c \u043f\u043e \u0432\u0441\u0435\u043c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\n\n\u042d\u0442\u043e \u043e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u043c\u0435\u0442\u0440\u0438\u043a\u0438, \u043d\u043e \u043d\u0430 \u043e\u0441\u043d\u043e\u0432\u0435 TP, FP, TN, FN \u043c\u043e\u0436\u043d\u043e \u043f\u043e\u0441\u0447\u0438\u0442\u0430\u0442\u044c \u0432\u0441\u0435 \u0447\u0442\u043e \u0443\u0433\u043e\u0434\u043d\u043e :)\n![image.png](attachment:image.png)\n\u0418\u0441\u0442\u043e\u0447\u043d\u0438\u043a - [confusion matrix](https:\/\/en.wikipedia.org\/wiki\/Confusion_matrix)","6fdde82f":"# Metrics, validation strategies and baselines\n\n\u0412 \u0434\u0430\u043d\u043d\u043e\u043c jupyter notebook \u0440\u0430\u0441\u0441\u043c\u0430\u0442\u0440\u0438\u0432\u0430\u044e\u0442\u0441\u044f \u043f\u0440\u0438\u043c\u0435\u0440\u044b \u0442\u043e\u0433\u043e, \u043a\u0430\u043a\u0438\u0435 \u0441\u0445\u0435\u043c\u044b \u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u0438 \u0438 \u043c\u0435\u0442\u0440\u0438\u043a\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442\u0441\u044f \u0432 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0445 \u0441\u0438\u0441\u0442\u0435\u043c\u0430\u0445.\n\u0422\u0430\u043a\u0436\u0435 \u043f\u043e\u0441\u0442\u0440\u043e\u0438\u043c \u043f\u0440\u043e\u0441\u0442\u044b\u0435 \u043c\u043e\u0434\u0435\u043b\u0438 (\u0431\u0435\u0439\u0437\u043b\u0430\u0439\u043d\u044b) \u043d\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 \u041c\u0422\u0421 \u0411\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0438. \n\n* [Preprocessing](#preprocessing)\n* [General remarks](#general-remarks)\n* [Metrics](#metrics)\n    * [Regression](#regression)\n    * [Classification](#classification)\n    * [Ranking](#ranking)\n* [Validation strategies](#validation)\n* [Baselines](#baselines)","cd8d4ac2":"### \u0412 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u0434\u043e\u043c\u0430\u0448\u043d\u0435\u0433\u043e \u0437\u0430\u0434\u0430\u043d\u0438\u044f:\n* \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u043f\u043e\u0441\u0447\u0438\u0442\u0430\u0442\u044c \u0442\u0435\u043f\u0435\u0440\u044c \u043c\u0435\u0442\u0440\u0438\u043a \u043f\u043e \u0432\u0441\u0435\u043c \u0444\u043e\u043b\u0434\u0430\u043c \u0432 test_dates \u0438 \u043e\u0446\u0435\u043d\u0438\u0442\u044c mean, std \u0432\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438. \u0421\u0442\u0430\u0431\u0438\u043b\u044c\u043d\u0430 \u043b\u0438 \u043c\u043e\u0434\u0435\u043b\u044c \u0432\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438?\n* \u041f\u043e\u0441\u0442\u0440\u043e\u0439\u0442\u0435 \u043f\u043e\u043f\u0443\u043b\u044f\u0440\u043d\u043e\u0435 \u043f\u043e \u0433\u0440\u0443\u043f\u043f\u0430\u043c: \u0432\u043e\u0437\u0440\u0430\u0441\u0442\u0430\u043c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 \u0438\u043b\u0438 \u0436\u0430\u043d\u0440\u0430\u043c \u043a\u043d\u0438\u0433. \u041c\u0435\u0442\u0440\u0438\u043a\u0438 \u0441\u0442\u0430\u043b\u0438 \u043b\u0443\u0447\u0448\u0435?","6221cd55":"## Users","9acf1655":"## Items","e33aa99b":"<a id=\"ranking\"><\/a>\n## Ranking\n\n\u042d\u0442\u0438 \u043c\u0435\u0442\u0440\u0438\u043a\u0438 \u043e\u0446\u0435\u043d\u0438\u0432\u0430\u044e\u0442 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u043e \u0442\u043e\u043f-N \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u0439 c \u0443\u0447\u0435\u0442\u043e\u043c \u0440\u0430\u043d\u0433\u043e\u0432\/\u043f\u043e\u0437\u0438\u0446\u0438\u0439. \u041e\u0441\u043d\u043e\u0432\u043d\u0430\u044f \u0438\u0434\u0435\u044f - \u043e\u0446\u0435\u043d\u0438\u0442\u044c \"\u043f\u043e\u043f\u0430\u0434\u0430\u043d\u0438\u044f\" \u0441 \u0432\u0435\u0441\u043e\u043c, \u0437\u0430\u0432\u0438\u0441\u044f\u0449\u0438\u043c \u043e\u0442 \u043f\u043e\u0437\u0438\u0446\u0438\u0438 (\u043e\u0431\u044b\u0447\u043d\u043e \u044d\u0442\u043e \u043e\u0431\u0440\u0430\u0442\u043d\u0430\u044f \u043f\u0440\u043e\u043f\u043e\u0440\u0446\u0438\u0430\u043b\u044c\u043d\u0430\u044f \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u044c, \u0442\u043e \u0435\u0441\u0442\u044c \u0447\u0435\u043c \u0431\u043e\u043b\u044c\u0448\u0435 \u043f\u043e\u0437\u0438\u0446\u0438\u044f, \u0442\u0435\u043c \u043c\u0435\u043d\u044c\u0448\u0435 \u0432\u0435\u0441).\n\u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u043c\u0435\u0442\u0440\u0438\u043a\u0438 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0435:","a5f48608":"## Interactions","3d224b77":"## \u0420\u0430\u0437\u0431\u0438\u0435\u043d\u0438\u0435 \u043f\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438\n\n\u0427\u0430\u0449\u0435 \u0432\u0441\u0435\u0433\u043e \u0432\u0441\u0442\u0440\u0435\u0447\u0430\u0435\u0442\u0441\u044f \u043d\u0430 \u043f\u0440\u0430\u043a\u0442\u0438\u043a\u0435. \u041e\u0431\u044b\u0447\u043d\u043e \u0432\u044b\u0431\u0438\u0440\u0430\u0435\u0442\u0441\u044f \u0440\u0430\u0437\u043c\u0435\u0440 test \u043f\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438 \u0438 \u043f\u0435\u0440\u0438\u043e\u0434 \u0434\u0430\u0442 \u0434\u043b\u044f \u0440\u0430\u0437\u0434\u0435\u043b\u0435\u043d\u0438\u044f \u043d\u0430 train\/test.\n\n\u041d\u0430\u043f\u0440\u0438\u043c\u0435\u0440: test - 1 \u0434\u0435\u043d\u044c, \u043f\u0435\u0440\u0438\u043e\u0434 \u0434\u043b\u044f \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f 7 \u0434\u043d\u0435\u0439.\n\n\u0414\u043b\u044f \u043d\u0430\u0448\u0438\u0445 \u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u043e \u041c\u0422\u0421 \u0411\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0435 \u0432\u044b\u0431\u0440\u0435\u043c 7 \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0445 \u0434\u043d\u0435\u0439 \u0438 \u0431\u0443\u0434\u0435\u043c \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043d\u0430 \u043d\u0438\u0445 \u043f\u043e\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u043d\u043e.","0263fb66":"\u041d\u043e \u0432\u043e\u043e\u0431\u0449\u0435 \u0448\u0430\u0433 \u0441 \u0433\u0440\u0443\u043f\u043f\u0438\u0440\u043e\u0432\u043a\u043e\u0439 \u043f\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\u043c \u0434\u043b\u044f Precision@K \u043d\u0435 \u043d\u0443\u0436\u0435\u043d","6c9d882e":"\u0412\u043d\u0430\u0447\u0430\u043b\u0435 \u043f\u043e\u0441\u0447\u0438\u0442\u0430\u0435\u043c \u043c\u0435\u0442\u0440\u0438\u043a \u0434\u043b\u044f \u0442\u043e\u043f-2 (\u0442.\u0435. \u041a = 2). \u0410\u043b\u0433\u043e\u0440\u0438\u0442\u043c \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439:\n* \u0420\u0435\u043b\u0435\u0432\u0430\u043d\u0442\u043d\u044b\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u044b, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043d\u0435 \u0431\u044b\u043b\u0438 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u043e\u0432\u0430\u043d\u044b \u0438\u0433\u043d\u043e\u0440\u0438\u0440\u0443\u0435\u043c (NaN)\n* \u041e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u043c, \u043a\u0430\u043a\u0438\u0435 \u0440\u0435\u043b\u0435\u0432\u0430\u0442\u043d\u044b\u0435 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u0438 \u043f\u043e\u043f\u0430\u043b\u0438 \u0432 \u0442\u043e\u043f-2 (hit)\n    * True positive \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\n* \u0414\u0435\u043b\u0438\u043c TP \u043d\u0430 K  \n* \u0421\u0447\u0438\u0442\u0430\u0435\u043c Precision@K \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u043a\u0430\u043a \u0441\u0443\u043c\u043c\u0443 \u0435\u0433\u043e TP\/K\n* \u0412\u0441\u0435 Precision@K \u0443\u0441\u0440\u0435\u0434\u043d\u044f\u0435\u043c","b05605b6":"<a id=\"baselines\"><\/a>\n# Baselines\n\n\u0421\u0430\u043c\u044b\u043c \u043f\u043e\u043f\u0443\u043b\u044f\u0440\u043d\u044b\u043c \u0431\u0435\u0439\u0437\u043b\u0430\u0439\u043d\u043e\u043c \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043f\u0440\u043e\u0441\u0442\u043e \u043f\u043e\u0441\u0442\u0440\u043e\u0435\u043d\u0438\u0435 \u043f\u043e\u043f\u0443\u043b\u044f\u0440\u043d\u043e\u0433\u043e :)\n\u0413\u0438\u043f\u0435\u0440\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u043c \u0442\u0430\u043a\u043e\u0439 \u043c\u043e\u0434\u0435\u043b\u0438 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 \u043e\u043a\u043d\u043e, \u0437\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0435 \u043c\u044b \u0441\u0447\u0438\u0442\u0430\u0435\u043c \u043f\u043e\u043f\u0443\u043b\u044f\u0440\u043d\u043e\u0435.\n\n\u041c\u043e\u0434\u0435\u043b\u044c \u043c\u043e\u0436\u043d\u043e \u0440\u0430\u0441\u0448\u0438\u0440\u044f\u0442\u044c \u0437\u0430\u0441\u0447\u0435\u0442 \u0443\u0447\u0435\u0442\u0430 \u0444\u0438\u0447\u0435\u0439, \u0447\u0442\u043e\u0431\u044b \u0441\u0447\u0438\u0442\u0430\u0442\u044c \u043f\u043e\u043f\u0443\u043b\u044f\u0440\u043d\u043e\u0435 \u0432 \u0440\u0430\u043c\u043a\u0430\u0445 \u043a\u0430\u043a\u0438\u0445-\u0442\u043e \u0433\u0440\u0443\u043f\u043f.\n\n\u041d\u043e \u043d\u0430 \u0441\u0430\u043c\u043e\u043c \u0434\u0435\u043b\u0435 \u0431\u0435\u0439\u0437\u043b\u0430\u0439\u043d\u044b \u0432 \u043f\u0435\u0440\u0432\u0443\u044e \u043e\u0447\u0435\u0440\u0435\u0434\u044c \u0437\u0430\u0432\u0438\u0441\u044f\u0442 \u043e\u0442 \u0442\u0438\u043f\u0430 \u0434\u0430\u043d\u043d\u044b\u0445. \u0412 \u043d\u0435\u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u0441\u043b\u0443\u0447\u0430\u044f\u0445 \u044d\u0442\u043e \u043c\u043e\u0433\u0443\u0442 \u0431\u044b\u0442\u044c \u043f\u0440\u043e\u0441\u0442\u044b\u0435 \u043c\u043e\u0434\u0435\u043b\u0438 (\u0438\u043b\u0438 \u0434\u0430\u0436\u0435 \u0431\u0438\u0437\u043d\u0435\u0441-\u043f\u0440\u0430\u0432\u0438\u043b\u0430), \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043f\u0440\u043e\u0441\u0442\u043e \u0443\u0447\u0438\u0442\u044b\u0432\u0430\u044e\u0442 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442 \u0437\u0430\u0434\u0430\u0447\u0438.","e7711cbc":"**Mean Average Precision**\n![image.png](attachment:image.png)\n\u0422\u043e \u0435\u0441\u0442\u044c MAP - \u044d\u0442\u043e \u0443\u0441\u0440\u0435\u0434\u043d\u0435\u043d\u0438\u0435 AveragePrecision \u043f\u043e \u0432\u0441\u0435\u043c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\u043c. \n\u0410 AveragePrecision \u0432 \u0441\u0432\u043e\u044e \u043e\u0447\u0435\u0440\u0435\u0434\u044c, \u044d\u0442\u043e \u0441\u0440\u0435\u0434\u043d\u0438\u0439 Precision@K \u043f\u043e \u0440\u0435\u043b\u0435\u0432\u0430\u043d\u0442\u043d\u044b\u043c \u043e\u0431\u044a\u0435\u043a\u0442\u0430\u043c \u043e\u0434\u043d\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f","3e05b4a9":"\u0421\u043e\u0431\u0435\u0440\u0435\u043c \u0438\u0437 \u044d\u0442\u0438\u0445 \u0434\u0430\u0442 \u043f\u043e\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043f\u0430\u0440\u044b. \u041f\u0435\u0440\u0432\u0430\u044f \u0434\u0430\u0442\u0430 \u0431\u0443\u0434\u0435\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0434\u043b\u044f \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u044f \u043d\u0430 train, \u0438 \u043e\u0431\u0435 \u0434\u0430\u0442\u044b \u0431\u0443\u0434\u0443\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0434\u043b\u044f \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f test","4d4635ba":"C Recall@K \u043f\u043e\u0445\u043e\u0436\u0430\u044f \u0438\u0441\u0442\u043e\u0440\u0438\u044f, \u043d\u0430\u043c \u0442\u0430\u043a\u0436\u0435 \u043d\u0443\u0436\u043d\u043e \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c hit@K, \u043d\u043e \u0434\u0435\u043b\u0438\u0442\u044c \u0443\u0436\u0435 \u0431\u0443\u0434\u0435\u043c \u043d\u0430 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0440\u0435\u043b\u0435\u0432\u0430\u043d\u0442\u043d\u044b\u0445 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432 \u0443 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f","c9ce5721":"<a id=\"validation\"><\/a>\n# Validation\n\n\u0414\u043b\u044f \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f train\/test (\u0438\u043b\u0438 train\/validation\/test) \u0433\u043b\u043e\u0431\u0430\u043b\u044c\u043d\u043e \u0435\u0441\u0442\u044c \u0434\u0432\u0430 \u043f\u043e\u0434\u0445\u043e\u0434\u0430:\n* \u0421\u043b\u0443\u0447\u0430\u0439\u043d\u043e\u0435 \u0440\u0430\u0437\u0431\u0438\u0435\u043d\u0438\u0435\n    * \u041f\u043e \u0432\u0441\u0435\u043c \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f\u043c\n    * \u041f\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044e \u0438\u043b\u0438 \u043e\u0431\u044a\u0435\u043a\u0442\u0443\n* \u0420\u0430\u0437\u0431\u0438\u0435\u043d\u0438\u0435 \u043f\u043e \u0432\u0440\u0435\u043c\u0435\u043d\u0438\n\n## \u0421\u043b\u0443\u0447\u0430\u0439\u043d\u043e\u0435 \u0440\u0430\u0437\u0431\u0438\u0435\u043d\u0438\u0435\n\n\u041e\u0431\u044b\u0447\u043d\u043e \u043f\u0440\u0438\u043c\u0435\u043d\u044f\u0435\u0442\u0441\u044f \u0441\u0445\u0435\u043c\u0430 Leave-one-out \u0438\u043b\u0438 Leave-P-out. \u0418\u0434\u0435\u044f \u043f\u0440\u043e\u0441\u0442\u0430, \u0434\u0430\u0432\u0430\u0439\u0442\u0435 \u0434\u043b\u044f \u043e\u0434\u043d\u043e\u0433\u043e (Leave-one-out) \u0438\u043b\u0438 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u0445 (Leave-P-out) \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439, \u0434\u043b\u044f \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u0435\u0441\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435 2 \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0439, \u043e\u0441\u0442\u0430\u0432\u0438\u043c \u043e\u0434\u043d\u043e \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u0432 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u0442\u0435\u0441\u0442\u0430.\n\u041d\u0430 \u043f\u0440\u0430\u043a\u0442\u0438\u043a\u0435 \u0442\u0430\u043a\u043e\u0439 \u043c\u0435\u0442\u043e\u0434 \u0440\u0435\u0434\u043a\u043e \u043f\u0440\u0438\u043c\u0435\u043d\u044f\u0435\u0442\u0441\u044f \u043f\u043e \u0434\u0432\u0443\u043c \u043f\u0440\u0438\u0447\u0438\u043d\u0430\u043c:\n* \u0414\u043e\u0440\u043e\u0433\u043e\u0441\u0442\u043e\u044f\u0449\u0430\u044f \u0441\u0445\u0435\u043c\u0430 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438, \u043d\u0430 \u0431\u043e\u0435\u0432\u044b\u0445 \u0434\u0430\u043d\u043d\u044b\u0445 \u0442\u0430\u043a\u043e\u0435 \u0441\u0447\u0438\u0442\u0430\u0442\u044c\u0441\u044f \u0431\u0443\u0434\u0435\u0442 \u0434\u043e\u043b\u0433\u043e\n* \u0427\u0430\u0441\u0442\u043e \u0432 \u0434\u0430\u043d\u043d\u044b\u0445 \u043f\u0440\u0438\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u0432\u0440\u0435\u043c\u0435\u043d\u043d\u0430\u044f \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u044c\n\n\u0420\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u0442\u044c \u043c\u043e\u0436\u043d\u043e \u0447\u0435\u0440\u0435\u0437 pandas.DataFrame.sample","d68b16cc":"<a id=\"preprocessing\"><\/a>\n# Preprocessing\n\n\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u043c \u043d\u0430\u0448\u0438 \u0434\u0430\u043d\u043d\u044b\u0435, \u0442\u0435\u043f\u0435\u0440\u044c \u0443\u0436\u0435 \u0441 \u0444\u0438\u0447\u0430\u043c\u0438, \u0438 \u043f\u0440\u0438\u043c\u0435\u043d\u0438\u043c \u0437\u043d\u0430\u043d\u0438\u044f \u0438\u0437 [pandas-scipy-for-recsys](https:\/\/www.kaggle.com\/sharthz23\/pandas-scipy-for-recsys)"}}