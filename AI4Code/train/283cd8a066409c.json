{"cell_type":{"1c834229":"code","9c62954f":"code","0babde38":"code","a0e5ee91":"code","0adcf81e":"code","28e22114":"code","a1148bdf":"code","70258114":"code","ad9727f8":"code","6a69b1eb":"code","6b29d0a7":"code","00f401a5":"code","9c0e0ce5":"code","98276e9b":"code","6ba65384":"code","e4d4b129":"code","69c2c9fd":"code","8135c9bd":"code","af850be9":"code","bb297178":"code","59166b80":"code","e98bca10":"code","9de604f8":"code","3dfb3f0e":"code","a1682de0":"code","f5ea2efd":"markdown"},"source":{"1c834229":"import matplotlib.pyplot as plt\nimport seaborn as sns\nimport pandas as pd\nimport numpy as np\nfrom sklearn import metrics\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.metrics import classification_report\nfrom sklearn.metrics import confusion_matrix\nfrom sklearn.model_selection import cross_val_predict\nfrom sklearn.metrics import precision_score, recall_score\n%matplotlib inline","9c62954f":"mediamix = pd.read_csv(\"..\/input\/mediamix_sales.csv\")\nmediamix.tail()","0babde38":"mediamix.describe()","a0e5ee91":"sns.jointplot(x='tv_sponsorships',y='sales',kind='hex', data=mediamix)  #visualisation to observe relationships between dependent and independent variables","0adcf81e":"sns.pairplot(mediamix)","28e22114":"#correlation matrix\ncorr_media = mediamix.corr()\nf, ax = plt.subplots(figsize=(12, 9))\nsns.heatmap(corr_media, cmap='viridis', annot=True, square=True);","a1148bdf":"#visualise Sales when from search when\nsns.set_palette(\"GnBu_d\")\nsns.set_style('whitegrid')\nsns.jointplot(x='radio',y='sales',data=mediamix)  #ads are run on radio\nsns.jointplot(x='Search',y='sales',data=mediamix)  #ads are run on search engines\nsns.jointplot(x='tv_sponsorships',y='sales',data=mediamix)   #sponsored ads are run on tv\nsns.jointplot(x='tv_cricket',y='sales',data=mediamix)  #sponsored ads are run on tv during cricket telecast\nsns.jointplot(x='Display_Rest',y='sales',data=mediamix)   #ads are just on stationary display","70258114":"#Creating a Linear Model Plot for sales from radio ads\nsns.lmplot(x='radio', y='sales', data=mediamix)\nsns.lmplot(x='Search', y='sales', data=mediamix)\nsns.lmplot(x='tv_sponsorships', y='sales', data=mediamix)\nsns.lmplot(x='tv_cricket', y='sales', data=mediamix)\nsns.lmplot(x='Display_Rest', y='sales', data=mediamix)","ad9727f8":"#Split dataset and train\ny=mediamix['sales']\nX=mediamix[['tv_sponsorships', 'tv_cricket', 'tv_RON', 'radio', 'NPP', 'Magazines', 'OOH', 'Social', 'Programmatic', 'Display_Rest', 'Search', 'Native']]\n\nX11=mediamix[['Native', 'Programmatic', 'OOH', 'Magazines', 'NPP', 'radio', 'tv_RON', 'tv_cricket', 'tv_sponsorships']]\nX12=mediamix[['Native', 'Search', 'Display_Rest', 'Programmatic', 'Social', 'OOH', 'Magazines', 'NPP', 'radio', 'tv_RON', 'tv_cricket', 'tv_sponsorships']]\n#X13=mediamix[['Native', 'Search', 'Display_Rest', 'Programmatic', 'Social', 'OOH', 'Magazines', 'NPP', 'radio', 'tv_RON', 'tv_cricket', 'tv_sponsorships']]\n#X14=mediamix[['Native', 'Search', 'Display_Rest', 'Programmatic', 'Social', 'OOH', 'Magazines', 'NPP', 'radio', 'tv_RON', 'tv_cricket', 'tv_sponsorships']]\nX15=mediamix[['Native', 'Programmatic', 'Social', 'OOH', 'Magazines', 'NPP', 'radio', 'tv_RON', 'tv_cricket']]\n#X16=mediamix[['Native', 'Display_Rest', 'Programmatic', 'OOH', 'Magazines', 'NPP', 'radio', 'tv_RON', 'tv_cricket']]\n#X17=mediamix[['Native', 'Search', 'Programmatic', 'OOH', 'Magazines', 'NPP', 'radio', 'tv_RON', 'tv_cricket']]\n\nX21=mediamix[['Native', 'Search', 'Display_Rest', 'Programmatic', 'Social', 'OOH', 'NPP', 'radio', 'tv_RON', 'tv_cricket', 'tv_sponsorships']]\nX22=mediamix[['Native', 'Search', 'Display_Rest', 'Programmatic', 'Social', 'OOH', 'Magazines', 'radio', 'tv_RON', 'tv_cricket', 'tv_sponsorships']]\nX23=mediamix[['Native', 'Search', 'Display_Rest', 'Programmatic', 'Social', 'OOH', 'Magazines', 'NPP', 'radio', 'tv_RON', 'tv_cricket', 'tv_sponsorships']]\n\nX31=mediamix[['Native', 'Search', 'Display_Rest', 'Programmatic', 'Social', 'OOH', 'Magazines', 'NPP', 'radio', 'tv_RON', 'tv_cricket', 'tv_sponsorships']]\n#X32=mediamix[['Native', 'Search', 'Display_Rest', 'Programmatic', 'Social', 'OOH', 'Magazines', 'NPP', 'radio', 'tv_RON', 'tv_cricket', 'tv_sponsorships']]","6a69b1eb":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=101)\n\nX11_train, X11_test, y11_train, y11_test = train_test_split(X11, y, test_size=0.3, random_state=101)\nX12_train, X12_test, y12_train, y12_test = train_test_split(X12, y, test_size=0.3, random_state=101)\n#X13_train, X13_test, y13_train, y13_test = train_test_split(X13, y, test_size=0.3, random_state=101)\n#X14_train, X14_test, y14_train, y14_test = train_test_split(X14, y, test_size=0.3, random_state=101)\nX15_train, X15_test, y15_train, y15_test = train_test_split(X15, y, test_size=0.3, random_state=101)\n\nX21_train, X21_test, y21_train, y21_test = train_test_split(X21, y, test_size=0.3, random_state=101)\nX22_train, X22_test, y22_train, y22_test = train_test_split(X22, y, test_size=0.3, random_state=101)\nX23_train, X23_test, y23_train, y23_test = train_test_split(X23, y, test_size=0.3, random_state=101)\n\nX31_train, X31_test, y31_train, y31_test = train_test_split(X31, y, test_size=0.3, random_state=101)\n#X32_train, X32_test, y32_train, y32_test = train_test_split(X32, y, test_size=0.3, random_state=101)","6b29d0a7":"mm_model = LinearRegression()\nmm_model.fit(X_train,y_train)\n\nmm_model11 = LinearRegression()\nmm_model11.fit(X11_train,y11_train)\nmm_model12 = LinearRegression()\nmm_model12.fit(X12_train,y12_train)\n#mm_model13 = LinearRegression()\n#mm_model13.fit(X13_train,y13_train)\n#mm_model14 = LinearRegression()\n#mm_model14.fit(X14_train,y14_train)\nmm_model15 = LinearRegression()\nmm_model15.fit(X15_train,y15_train)\n\nmm_model21 = LinearRegression()\nmm_model21.fit(X21_train,y21_train)\nmm_model22 = LinearRegression()\nmm_model22.fit(X22_train,y22_train)\nmm_model23 = LinearRegression()\nmm_model23.fit(X23_train,y23_train)\n\nmm_model31 = LinearRegression()\nmm_model31.fit(X31_train,y31_train)\n#mm_model32 = LinearRegression()\n#mm_model32.fit(X32_train,y32_train)","00f401a5":"mm_model.pvalues","9c0e0ce5":"#MODELX EVALUATION\nmodelX_forecast = mm_model.predict(X_test)\nplt.scatter(y_test, modelX_forecast)\nplt.xlabel('Y test')\nplt.ylabel('Predicted Y')\n\nprint('Coefficients: \\n', mm_model.coef_)\nprint ('MAE :', metrics.mean_absolute_error(y_test, modelX_forecast))\nprint ('MSE :', metrics.mean_squared_error(y_test, modelX_forecast))\nprint ('RMSE :', np.sqrt(metrics.mean_squared_error(y_test, modelX_forecast)))","98276e9b":"#MODEL11 EVALUATION\nmodel11_forecast = mm_model11.predict(X11_test)\nplt.scatter(y11_test, model11_forecast)\nplt.xlabel('Y test')\nplt.ylabel('Predicted Y')\nprint('Coefficients: \\n', mm_model11.coef_)\nprint ('MAE :', metrics.mean_absolute_error(y11_test, model11_forecast))\nprint ('MSE :', metrics.mean_squared_error(y11_test, model11_forecast))\nprint ('RMSE :', np.sqrt(metrics.mean_squared_error(y11_test, model11_forecast)))","6ba65384":"#MODEL12 EVALUATION\nmodel12_forecast = mm_model12.predict(X12_test)\nplt.scatter(y12_test, model12_forecast)\nplt.xlabel('Y test')\nplt.ylabel('Predicted Y')\nprint('Coefficients: \\n', mm_model12.coef_)\nprint ('MAE :', metrics.mean_absolute_error(y12_test, model12_forecast))\nprint ('MSE :', metrics.mean_squared_error(y12_test, model12_forecast))\nprint ('RMSE :', np.sqrt(metrics.mean_squared_error(y12_test, model12_forecast)))","e4d4b129":"#MODEL13 EVALUATION\nmodel13_forecast = mm_model13.predict(X13_test)\nplt.scatter(y13_test, model13_forecast)\nplt.xlabel('Y test')\nplt.ylabel('Predicted Y')\nprint('Coefficients: \\n', mm_model13.coef_)\nprint ('MAE :', metrics.mean_absolute_error(y13_test, model13_forecast))\nprint ('MSE :', metrics.mean_squared_error(y13_test, model13_forecast))\nprint ('RMSE :', np.sqrt(metrics.mean_squared_error(y13_test, model13_forecast)))","69c2c9fd":"#MODEL15 EVALUATION\nmodel15_forecast = mm_model15.predict(X15_test)\nplt.scatter(y15_test, model15_forecast)\nplt.xlabel('Y test')\nplt.ylabel('Predicted Y')\nprint('Coefficients: \\n', mm_model15.coef_)\nprint ('MAE :', metrics.mean_absolute_error(y15_test, model15_forecast))\nprint ('MSE :', metrics.mean_squared_error(y15_test, model15_forecast))\nprint ('RMSE :', np.sqrt(metrics.mean_squared_error(y15_test, model15_forecast)))","8135c9bd":"#MODEL21 EVALUATION\nmodel21_forecast = mm_model21.predict(X21_test)\nplt.scatter(y21_test, model21_forecast)\nplt.xlabel('Y test')\nplt.ylabel('Predicted Y')\nprint('Coefficients: \\n', mm_model21.coef_)\nprint ('MAE :', metrics.mean_absolute_error(y21_test, model21_forecast))\nprint ('MSE :', metrics.mean_squared_error(y21_test, model21_forecast))\nprint ('RMSE :', np.sqrt(metrics.mean_squared_error(y21_test, model21_forecast)))","af850be9":"#MODEL22 EVALUATION\nmodel22_forecast = mm_model22.predict(X22_test)\nplt.scatter(y22_test, model22_forecast)\nplt.xlabel('Y test')\nplt.ylabel('Predicted Y')\nprint('Coefficients: \\n', mm_model22.coef_)\nprint ('MAE :', metrics.mean_absolute_error(y22_test, model22_forecast))\nprint ('MSE :', metrics.mean_squared_error(y22_test, model22_forecast))\nprint ('RMSE :', np.sqrt(metrics.mean_squared_error(y22_test, model22_forecast)))","bb297178":"#MODEL23 EVALUATION\nmodel23_forecast = mm_model23.predict(X23_test)\nplt.scatter(y23_test, model23_forecast)\nplt.xlabel('Y test')\nplt.ylabel('Predicted Y')\nprint('Coefficients: \\n', mm_model23.coef_)\nprint ('MAE :', metrics.mean_absolute_error(y23_test, model23_forecast))\nprint ('MSE :', metrics.mean_squared_error(y23_test, model23_forecast))\nprint ('RMSE :', np.sqrt(metrics.mean_squared_error(y23_test, model23_forecast)))","59166b80":"#MODEL31 EVALUATION\nmodel31_forecast = mm_model31.predict(X31_test)\nplt.scatter(y31_test, model31_forecast)\nplt.xlabel('Y test')\nplt.ylabel('Predicted Y')\nprint('Coefficients: \\n', mm_model31.coef_)\nprint ('MAE :', metrics.mean_absolute_error(y31_test, model31_forecast))\nprint ('MSE :', metrics.mean_squared_error(y31_test, model31_forecast))\nprint ('RMSE :', np.sqrt(metrics.mean_squared_error(y31_test, model31_forecast)))","e98bca10":"#MODEL32 EVALUATION\nmodel32_forecast = mm_model32.predict(X32_test)\nplt.scatter(y32_test, model32_forecast)\nplt.xlabel('Y test')\nplt.ylabel('Predicted Y')\nprint('Coefficients: \\n', mm_model32.coef_)\nprint ('MAE :', metrics.mean_absolute_error(y32_test, model32_forecast))\nprint ('MSE :', metrics.mean_squared_error(y32_test, model32_forecast))\nprint ('RMSE :', np.sqrt(metrics.mean_squared_error(y32_test, model32_forecast)))","9de604f8":"print('Coefficients: \\n', mm_model.coef_)","3dfb3f0e":"sales_forecast = mm_model.predict(X_test)\nplt.scatter(y_test,sales_forecast)\nplt.xlabel('Y test')\nplt.ylabel('Predicted Y')","a1682de0":"print ('MAE :', metrics.mean_absolute_error(y_test, sales_forecast))\nprint ('MSE :', metrics.mean_squared_error(y_test, sales_forecast))\nprint ('RMSE :', np.sqrt(metrics.mean_squared_error(y_test, sales_forecast)))","f5ea2efd":"**Model 11 tv_sponsorships 0.5**\nNative, Programmatic, OOH, Magazines, NPP, radio, tv_RON, tv_cricket\n\n**Model 12 tv_cricket 0.46**\nNative, Search, Display_Rest, Programmatic, Social, OOH, Magazines, NPP, radio, tv_RON, tv_sponsorships\n\n**Model 13 tv_RON 0.4**\nNative, Search, Display_Rest, Programmatic, Social, OOH, Magazines, NPP, radio, tv_cricket, tv_sponsorships\n\n**Model 14 radio 0.58**\nNative, Search, Display_Rest, Programmatic, Social, OOH, Magazines, NPP, tv_RON, tv_cricket, tv_sponsorships\n\n**Model 15 social**\nNative, Programmatic, Social, OOH, Magazines, NPP, radio, tv_RON, tv_cricket\n\n**Model 16 Display_Rest**\nNative, Display_Rest, Programmatic, OOH, Magazines, NPP, radio, tv_RON, tv_cricket\n\n**Model 17 Search**\nNative, Search, Programmatic, OOH, Magazines, NPP, radio, tv_RON, tv_cricket\n\n**Model 21 NPP**\nNative, Search, Display_Rest, Programmatic, Social, OOH, radio, tv_RON, tv_cricket, tv_sponsorships\n\n**Model 22 Magazines**\nNative, Search, Display_Rest, Programmatic, Social, OOH, radio, tv_RON, tv_cricket, tv_sponsorships\n\n**Model 23 Programmatic**\nNative, Search, Display_Rest, Programmatic, Social, OOH, Magazines, NPP, radio, tv_RON, tv_cricket, tv_sponsorships\n\n**Model 31 OOH**\nNative, Search, Display_Rest, Programmatic, Social, OOH, Magazines, NPP, radio, tv_RON, tv_cricket, tv_sponsorships\n\n**Model 32 Native**\nNative, Search, Display_Rest, Programmatic, Social, OOH, Magazines, NPP, radio, tv_RON, tv_cricket, tv_sponsorships"}}