{"cell_type":{"04631966":"code","17609ceb":"code","640eb39e":"code","15d30d33":"code","54b7d5af":"code","03153413":"code","8d6a5814":"code","4ef37ebe":"code","1f82bfd7":"code","2aa8ee74":"code","0aa5d63d":"code","74c8d75b":"code","77d6e275":"code","afce9afd":"code","ef88d9fe":"code","01f21f2b":"code","62f4978f":"code","d8f5ce6d":"code","0c0d6073":"code","f09dce9a":"code","6c0a6f66":"code","43c67a8c":"code","242a471b":"code","a869055f":"code","6f095fd5":"code","a433859d":"code","ed5e81c4":"code","cab232a0":"code","733efc87":"code","1274cbc7":"code","e6c67b72":"code","d08038f4":"code","38db21d9":"code","d72776ec":"code","c3a5f00d":"code","8925ad46":"code","74e6bc1f":"code","a7552588":"code","f814f054":"code","4aeed875":"code","c5363baf":"code","01455493":"code","aff7b2bb":"code","c9de6d7b":"code","0b125019":"code","eeda8a63":"code","40159a90":"code","3d1f1628":"code","d4458fa4":"code","2b06352e":"code","1f638767":"code","6b2d3933":"code","492b0b41":"code","f8d5a014":"code","532bb8ac":"code","9ceeaa4b":"code","efc4739e":"code","b88ed769":"code","0079ca11":"code","7d76ff4d":"markdown","b191dfff":"markdown","6ce919cf":"markdown","0f0c84c6":"markdown","a1536d3c":"markdown","865cb7a0":"markdown","25b7ecd4":"markdown","817af5f4":"markdown","5c84324f":"markdown","9e4e8b2c":"markdown","db53c39f":"markdown","67fa8592":"markdown","c0ccb6f0":"markdown","50e34bf5":"markdown","fc8f3ca2":"markdown","62f7ad03":"markdown","a3123ef1":"markdown","7cba2056":"markdown","d44c5dbb":"markdown","9a8ea215":"markdown"},"source":{"04631966":"import pandas as pd\nimport seaborn as sns\nimport numpy as np\nimport matplotlib.pyplot as plt\n%matplotlib inline","17609ceb":"df = pd.read_csv('..\/input\/california-housing-prices\/housing.csv')","640eb39e":"df","15d30d33":"df['ocean_proximity'].value_counts()","54b7d5af":"df.info()","03153413":"df.isnull().sum()","8d6a5814":"df.drop(['longitude','latitude'],axis=1,inplace =True)","4ef37ebe":"df.info()","1f82bfd7":"df['total_bedrooms'].fillna(df['total_bedrooms'].mean(),inplace=True)","2aa8ee74":"df.info()","0aa5d63d":"df.head()","74c8d75b":"df.corr()","77d6e275":"sns.heatmap(df.corr(),annot=True);","afce9afd":"df.hist(figsize=(20,15));","ef88d9fe":"sns.scatterplot(data=df,x='median_income',y='median_house_value')\nplt.title('Median Income vs Median House value');","01f21f2b":"sns.boxplot(data=df,y='median_house_value'); #let's see the box plot to see the mean house price ","62f4978f":"df['median_house_value'].mean()","d8f5ce6d":"sns.scatterplot(data=df,x='total_rooms',y='median_house_value')\nplt.title('Total no of rooms vs Median House value');","0c0d6073":"sns.scatterplot(data=df,x='total_bedrooms',y='median_house_value')\nplt.title('Total no of rooms vs Median House value');","f09dce9a":"# Let's see the distribution of of the Median house age\nsns.displot(data=df,x='housing_median_age',kde=True);","6c0a6f66":"sns.countplot(data=df,x='ocean_proximity');\ndf['ocean_proximity'].value_counts()","43c67a8c":"house_near_onehocean = df[df['ocean_proximity'] == '<1H OCEAN']\nhouse_near_onehocean.describe()","242a471b":"df.groupby('ocean_proximity').mean()","a869055f":"house_near_inland = df[df['ocean_proximity'] == 'INLAND']\nhouse_near_inland.describe()","6f095fd5":"house_near_bay = df[df['ocean_proximity'] == 'NEAR BAY']\nhouse_near_bay.describe()","a433859d":"house_near_ocean = df[df['ocean_proximity'] == 'NEAR OCEAN']\nhouse_near_ocean.describe()","ed5e81c4":"house_near_island = df[df['ocean_proximity'] == 'ISLAND']\nhouse_near_island.describe()","cab232a0":"X = df.drop('median_house_value',axis=1)","733efc87":"X = pd.get_dummies(data=X)\nX.head()","1274cbc7":"X['ocean_proximity_<1H_OCEAN'] = X['ocean_proximity_<1H OCEAN']","e6c67b72":"X = X.drop('ocean_proximity_<1H OCEAN',axis=1)","d08038f4":"X.head()","38db21d9":"print('Shape of input features',X.shape) # 2D array","d72776ec":"y = df['median_house_value']\ny.head()","c3a5f00d":"print('Shape of input features',y.shape)","8925ad46":"y.values # 1D array","74e6bc1f":"from sklearn.model_selection import train_test_split","a7552588":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33, random_state=42 )","f814f054":"from sklearn.linear_model import LinearRegression","4aeed875":"house_price_model = LinearRegression()","c5363baf":"house_price_model.fit(X_train,y_train)","01455493":"y_predictions = house_price_model.predict(X_test)\ny_predictions","aff7b2bb":"from sklearn.metrics import mean_absolute_error, mean_squared_error, r2_score","c9de6d7b":"y_test.mean()","0b125019":"#df['median_house_value'].mean()","eeda8a63":"y_predictions.mean()","40159a90":"mean_absolute_error(y_test,y_predictions)","3d1f1628":"def mape(actual, pred): \n    actual, pred = np.array(actual), np.array(pred)\n    return np.mean(np.abs((actual - pred) \/ actual)) * 100\n\nmape(y_test,y_predictions)","d4458fa4":"np.sqrt(mean_squared_error(y_test,y_predictions))","2b06352e":"#### Accuracy of the model\nr2_score(y_test,y_predictions)","1f638767":"X.columns","6b2d3933":"house_price_model.coef_","492b0b41":"house_price_model.intercept_","f8d5a014":"test_residuals = y_test - y_predictions","532bb8ac":"test_residuals","9ceeaa4b":"sns.scatterplot(x=y_test,y=test_residuals)\nplt.axhline(y=0,color='red')\nplt.title('Residual Plot');","efc4739e":"sns.displot(test_residuals,bins=30,kde=True);","b88ed769":"from joblib import dump","0079ca11":"dump(house_price_model,'House_prediction_model.joblib')","7d76ff4d":"#### Above plot tells us that there is a positive relation b\/w the median income and median house value telling us that more the income of the houseolds , they buy expensive property","b191dfff":"### Saving the model","6ce919cf":"#### So we after calculating MAPE we found out that we are off by or we have 28.9% i.e. 29% as error rate\n\n#### So is that error acceptable - it depends on context and consider our scenario - 29 % error is surely not  completely acceptable but it can give us a fair idea about the prices of the houses","0f0c84c6":"# EDA","a1536d3c":"#### Training model on training data","865cb7a0":"### We can see that only median house age is normally distributed rest all are right skewed","25b7ecd4":"### We can see that the data residual plot shows us that the points are normally distributed along the line, so we can conclude that the underlying dataset a valid choice for Linear Regression.\n\n### As for the low model accuracy, it might be because of less data and also in model coefficients we have some negative coefficients values which we can remove to get better accuracy.","817af5f4":"## Feature Selection ","5c84324f":"### We have filled in the null values","9e4e8b2c":"## Model Creation","db53c39f":"#### 1.After seperating the category by the ocean proximity we can see the average housel value and we can tell that houses located near Island are expensive which also justifies because island mostly being a vacation place has higher value of houses. But we cant rely on this data as we have information just 5 houses in this category, so to have clear idea of thus we might need more data.\n\n#### 2.Other than this we can see that houses located at the Bay area are expensive than houses of other areas.\n\n#### 3.So we can say that the location of house from nearby oceans plays vital role in prices of the houses.\n\n#### 4.There is very little positive relation as seen from plots, between the total no of rooms and bedrooms within a block and the price of the houses.","67fa8592":"### Total no of bedrooms has null values, we will fill them using mean","c0ccb6f0":"### Now that we have predicted the test data using the model we need to find out the accuracy of this model and find out whether Linear Regerssion was best algo for this data","50e34bf5":"So our model accuracy is 63%","fc8f3ca2":"### Predicting the house values on test data","62f7ad03":"### Let's seperate the data by ocean proxmity and then see detailed information to gain insight","a3123ef1":"##### We can that we have a high RMSE than our MAE, whcih suggests that for most of the data the predicted value is having fair accuracy but for few points\/data features the predicted house value is havng very high errors","7cba2056":"#### Now we want to know if the underlying dataset was a valid dataset for Linear Regression , by checking the residual plots if there was a sttrange pattern that we coul not see in some multidimensional level\n\n#### Let's visualize the residual plots to see that ","d44c5dbb":"### Even the distribution tells us that the errors\/residuals are somewhat distributed normally and also the kde shows us that the mean is pretty close to zero\n\n### Also we can see there is undershoot of a little bit but having a little bit skewed on one way or the other is not too bad.","9a8ea215":"### We wont be doing spatial analysis so we will remove the latitude and longitude columns"}}