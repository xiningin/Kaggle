{"cell_type":{"e612343c":"code","cfe45123":"code","632be1b8":"code","2bc95a96":"code","1435615c":"code","69702625":"code","62d55844":"code","680eb2d8":"code","673f234c":"code","5d34ce44":"code","3531d10b":"code","d981ed18":"code","649a9d26":"code","0fa617b7":"code","49984743":"code","e7019efd":"code","0cf7c456":"code","62a56fa2":"code","c98258bb":"code","ea38bcd5":"code","41daa068":"code","683c425a":"code","931b8c7a":"code","3feff269":"code","bfae8bd8":"code","ed655fb2":"code","b8db1b03":"code","f33f47a9":"code","213473a9":"code","a85f75f5":"code","f3af0649":"code","41d72e34":"code","eb518e93":"code","f4327f8f":"code","64174143":"code","f3ab49be":"code","f6741de8":"code","ac84bc27":"code","49e6f6f3":"code","117ec7d3":"code","a9fe8cbf":"code","b7c274d3":"code","74bf4c4f":"code","187cc6aa":"code","d2fd80e2":"code","abea060f":"code","78d1ad7d":"code","9408d054":"code","6f0ea55b":"code","6040b73c":"code","0578c1ae":"code","6e164881":"code","8bf2a6a9":"code","a2011e6e":"code","eb121433":"code","af2279ae":"code","1faf0a57":"code","2314fa50":"code","d6fc3945":"code","24368856":"code","e4918cd9":"markdown","fd253ec2":"markdown","0f473cc9":"markdown","b223b56c":"markdown","d8a7625b":"markdown","c1042628":"markdown","bc6e11cf":"markdown","de2e86b6":"markdown","fa5f1eb1":"markdown","21f8b8b6":"markdown","e3a3688a":"markdown","f57a26e1":"markdown"},"source":{"e612343c":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns","cfe45123":"raw_data = pd.read_csv('..\/input\/housesalesprediction\/kc_house_data.csv')\ndf = raw_data.copy()","632be1b8":"df.info()","2bc95a96":"df.drop('id',axis=1,inplace=True)","1435615c":"plt.figure(figsize=(10,6))\nsns.distplot(df['price'],bins=30)","69702625":"new_df = df[df['price']<2e6].copy()","62d55844":"plt.figure(figsize=(10,6))\nsns.distplot(new_df['price'],bins=30)","680eb2d8":"(len(df)-len(new_df))*100\/len(df)","673f234c":"new_df.corr()['price'].sort_values()","5d34ce44":"%matplotlib inline","3531d10b":"plt.figure(figsize=(10,5))\nsns.countplot(x='bathrooms',data=new_df)","d981ed18":"plt.figure(figsize=(8,24))\nplt.subplot(3,1,1)\nplt.scatter(y='sqft_living15',x='price',data=new_df,s=1)\nplt.ylabel('sqft_living15')\nplt.xlabel('price')\nplt.subplot(3,1,2)\nplt.scatter(y='sqft_living',x='price',data=new_df,s=1)\nplt.ylabel('sqft_living')\nplt.xlabel('price')\nplt.subplot(3,1,3)\nplt.scatter(y='sqft_above',x='price',data=new_df,s=1)\nplt.ylabel('sqft_above')\nplt.xlabel('price')","649a9d26":"plt.figure(figsize=(10,5))\nsns.countplot(x='grade',data=new_df)","0fa617b7":"new_df.head()","49984743":"new_df['date'].apply(lambda x:x[:-7])","e7019efd":"new_df['date'] = pd.to_datetime(new_df['date'])","0cf7c456":"new_df['month'] = new_df['date'].apply(lambda date:date.month)\nnew_df['year'] = new_df['date'].apply(lambda date:date.year)","62a56fa2":"new_df.corr()['price'].sort_values()","c98258bb":"new_df.drop('zipcode',axis=1,inplace=True)","ea38bcd5":"new_df.groupby('month').mean()['price'].plot()","41daa068":"new_df.groupby('year').mean()['price'].plot()","683c425a":"new_df.drop('date',axis=1,inplace=True)","931b8c7a":"new_df['sqft_basement'].value_counts()","3feff269":"def convert_to_dummy(value):\n    if value == 0:\n        return 0\n    else:\n        return 1\nnew_df['basement']=new_df['sqft_basement'].apply(convert_to_dummy)\nnew_df['basement'].value_counts()","bfae8bd8":"new_df.drop('sqft_basement',axis=1,inplace=True)","ed655fb2":"new_df['yr_renovated'].value_counts()","b8db1b03":"def convert_to_dummy(value):\n    if value == 0:\n        return 0\n    else:\n        return 1\nnew_df['renovated']=new_df['yr_renovated'].apply(convert_to_dummy)\nnew_df['renovated'].value_counts()","f33f47a9":"new_df.drop('yr_renovated',axis=1,inplace=True)","213473a9":"new_df.columns","a85f75f5":"from sklearn.model_selection import train_test_split","f3af0649":"X = new_df.drop('price',axis=1)\ny = new_df['price']\nX_train, X_test, y_train, y_test = train_test_split(X,y,test_size=0.3,random_state=101)","41d72e34":"from sklearn.preprocessing import MinMaxScaler","eb518e93":"scaler=MinMaxScaler()","f4327f8f":"X_train = scaler.fit_transform(X_train)\nX_test = scaler.transform(X_test)","64174143":"import tensorflow as tf","f3ab49be":"model = tf.keras.Sequential([\n    tf.keras.layers.Dense(19,activation='relu'),\n    tf.keras.layers.Dense(50,activation='relu'),\n    tf.keras.layers.Dense(50,activation='relu'),\n    tf.keras.layers.Dense(50,activation='relu'),\n    tf.keras.layers.Dense(50,activation='relu'),\n    tf.keras.layers.Dense(50,activation='relu'),\n    tf.keras.layers.Dense(1)\n])","f6741de8":"model.compile(optimizer='adam',loss='mse')","ac84bc27":"num_epochs=100\nmodel.fit(X_train,y_train.values,epochs=num_epochs,batch_size=128,verbose=2)","49e6f6f3":"loss_df = pd.DataFrame(model.history.history)","117ec7d3":"loss_df.plot()","a9fe8cbf":"from sklearn.metrics import mean_absolute_error,mean_squared_error,explained_variance_score","b7c274d3":"predictions = model.predict(X_test)","74bf4c4f":"# Our predictions\nplt.scatter(y_test,predictions)\n\n# Perfect predictions\nplt.plot(y_test,y_test,'r')","187cc6aa":"Deep_Net =['Deep Net',mean_absolute_error(y_test,predictions),np.sqrt(mean_squared_error(y_test,predictions)),explained_variance_score(y_test,predictions)]","d2fd80e2":"error_metrics=pd.DataFrame({'model':[],'mean absolute error':[],'root mean squared error':[],'Explained variance score':[]})","abea060f":"error_metrics.loc[0]= Deep_Net","78d1ad7d":"error_metrics","9408d054":"from sklearn.tree import DecisionTreeClassifier","6f0ea55b":"dtree = DecisionTreeClassifier()\ndtree.fit(X_train,y_train)","6040b73c":"pred = dtree.predict(X_test)","0578c1ae":"# Our predictions\nplt.scatter(y_test,pred)\n\n# Perfect predictions\nplt.plot(y_test,y_test,'r')","6e164881":"Decision_Tree =['Decision Tree',mean_absolute_error(y_test,pred),np.sqrt(mean_squared_error(y_test,pred)),explained_variance_score(y_test,pred)]","8bf2a6a9":"error_metrics.loc[1] = Decision_Tree","a2011e6e":"error_metrics","eb121433":"from sklearn.linear_model import LinearRegression","af2279ae":"lm=LinearRegression()","1faf0a57":"lm.fit(X_train,y_train)","2314fa50":"pred_lm = lm.predict(X_test)","d6fc3945":"# Our predictions\nplt.scatter(y_test,pred_lm)\n\n# Perfect predictions\nplt.plot(y_test,y_test,'r')","24368856":"Linear_model =['Linear Regression',mean_absolute_error(y_test,pred_lm),np.sqrt(mean_squared_error(y_test,pred_lm)),explained_variance_score(y_test,pred_lm)]\n\nerror_metrics.loc[2]= Linear_model\n\nerror_metrics","e4918cd9":"So,we removed less than 1% of our dataset.","fd253ec2":"* So,our data has no missing values as number of values in each column are equal.","0f473cc9":"Let's visually explore highly correlated factors.","b223b56c":"Ah! Attributes month and year do not seem important.But I will still keep them to analyse their effect on my model.\nThough, I will drop attribute zipcode.","d8a7625b":"There are some outliers.Let's remove them for better analysis.","c1042628":"Let's explore date column","bc6e11cf":"# Decision Trees","de2e86b6":"I have applied deep neural networks,decision trees and linear regression model to predict house prices.","fa5f1eb1":"Feature Engineering Section:","21f8b8b6":"# Using Deep Neural Network","e3a3688a":"I will categorize this column as having a basement(0) or not(1).","f57a26e1":"# Linear Regression Model"}}