{"cell_type":{"ce75a588":"code","ba842ebb":"code","1e302c81":"code","6fe0f532":"code","8d6dc72c":"code","56883469":"code","0b71a1c5":"code","74a8c54b":"code","4f992244":"code","02323767":"code","8a5be7a4":"code","fdfa221a":"code","e66242ae":"code","c6b324e5":"code","5cd908dc":"code","8aeed2c3":"code","8b3058e0":"code","c8659db1":"code","01e16b6d":"code","3ea3e143":"code","50fe54d5":"code","2ca86011":"code","e65d3cbd":"code","42d7d0b1":"code","ace0ea0f":"code","13bbd7f1":"code","fcdb4acc":"code","3bf3252f":"code","d5bb3b16":"code","dd4c55bf":"code","e88f59fb":"code","ee74975c":"code","11c70261":"code","70f78434":"code","67037f28":"markdown"},"source":{"ce75a588":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom sklearn.feature_extraction.text import CountVectorizer,TfidfVectorizer\nfrom sklearn.linear_model import *\nfrom sklearn.ensemble import *\nfrom sklearn.tree import *","ba842ebb":"from IPython.display import display","1e302c81":"pos_train=pd.read_csv('\/kaggle\/input\/arabic-sentiment-twitter-corpus\/train_Arabic_tweets_positive_20190413.tsv',sep='\\t',header=None)\nneg_train=pd.read_csv('\/kaggle\/input\/arabic-sentiment-twitter-corpus\/train_Arabic_tweets_negative_20190413.tsv',sep='\\t',header=None)\ntrain_data=pd.concat([pos_train,neg_train],ignore_index=True)\ntrain_data.columns=['label','tweet']\ndel pos_train,neg_train","6fe0f532":"train_data.head()","8d6dc72c":"train_data.isnull().sum()","56883469":"train_data.tail()","0b71a1c5":"train_data.duplicated().sum()","74a8c54b":"train_data[train_data.duplicated()]","4f992244":"train_data[train_data['tweet']=='\u0637\u0628\u0639\u0627 \u0633\u0627\u0645\u0639\u064a\u0646 \ud83d\ude48']","02323767":"train_data.shape","8a5be7a4":"train_data.drop_duplicates(inplace=True)","fdfa221a":"train_data.duplicated().sum()","e66242ae":"train_data[train_data['tweet']=='\u0637\u0628\u0639\u0627 \u0633\u0627\u0645\u0639\u064a\u0646 \ud83d\ude48']","c6b324e5":"sns.countplot(data=train_data,x='label')","5cd908dc":"#reading test dataset\ntest_pos=pd.read_csv(\"\/kaggle\/input\/arabic-sentiment-twitter-corpus\/test_Arabic_tweets_positive_20190413.tsv\",sep='\\t',header=None)\ntest_neg=pd.read_csv(\"\/kaggle\/input\/arabic-sentiment-twitter-corpus\/test_Arabic_tweets_negative_20190413.tsv\",sep='\\t',header=None)\ntest_data=pd.concat([test_pos,test_neg],ignore_index=True)\ntest_data.columns=['label','tweet']\ndel test_pos,test_neg","8aeed2c3":"test_data.head()","8b3058e0":"test_data.tail()","c8659db1":"training_data=train_data.copy()\ntesting_data=test_data.copy()","01e16b6d":"from sklearn.svm import SVC","3ea3e143":"vectorizer=TfidfVectorizer(analyzer='char_wb',ngram_range=(3,5),min_df=0.01,max_df=0.3)","50fe54d5":"clf=SVC(kernel='rbf')","2ca86011":"from sklearn.pipeline import make_pipeline\npipe=make_pipeline(vectorizer,clf)","e65d3cbd":"pipe.fit(training_data.tweet,training_data.label)","42d7d0b1":"y_pred=pipe.predict(testing_data.tweet)","ace0ea0f":"from sklearn.metrics import accuracy_score,confusion_matrix,ConfusionMatrixDisplay,roc_curve,auc,RocCurveDisplay,classification_report","13bbd7f1":"accuracy_score(testing_data.label,y_pred)","fcdb4acc":"print(classification_report(testing_data.label,y_pred))","3bf3252f":"cm = confusion_matrix(testing_data.label, y_pred, labels=pipe.classes_)\ndisp = ConfusionMatrixDisplay(confusion_matrix=cm,\n                              display_labels=pipe.classes_)\ndisp.plot()\nplt.show()","d5bb3b16":"y_label=np.array([1 if x=='pos' else 0 for x in testing_data.label])","dd4c55bf":"predictions=np.array([1 if x=='pos' else 0 for x in y_pred])","e88f59fb":"fpr, tpr, thresholds = roc_curve(y_label, predictions)\nroc_auc = auc(fpr, tpr)\ndisplay = RocCurveDisplay(fpr=fpr, tpr=tpr, roc_auc=roc_auc,\n                                   estimator_name='estimator')\ndisplay.plot()\nplt.show()","ee74975c":"clf2=RandomForestClassifier()\npipe2=make_pipeline(vectorizer,clf2)\npipe2.fit(training_data.tweet,training_data.label)\npred=pipe2.predict(testing_data.tweet)","11c70261":"print(classification_report(testing_data.label,pred))","70f78434":"print('Score:',accuracy_score(testing_data.label,pred))","67037f28":"* remove duplicates from training data"}}