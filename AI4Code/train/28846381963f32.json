{"cell_type":{"3a103fbc":"code","b96ea1b9":"code","7d4b1768":"code","e220a50d":"code","bc8e533c":"code","a30cf86f":"code","f1cc8945":"code","6f0c671b":"code","9683d46e":"code","19482f5e":"code","0b938cc6":"code","3c3a385a":"code","0ab6eb6e":"code","8e16d1ba":"code","d5354ec3":"code","87dfbd7d":"code","1990765a":"code","cd943850":"code","2d900efd":"code","ce7522cb":"code","7c1f0abe":"code","2f7296e9":"code","9b57b383":"code","673bc50f":"code","ed53d7a7":"code","c8084403":"code","2cc4a4b3":"code","3ea7cd7a":"code","fd5af3e7":"code","7daa0732":"markdown","b7d1bbb4":"markdown","ad6daf44":"markdown","3fbc72a7":"markdown","3fd03368":"markdown","1cd6ba31":"markdown","bb6cca85":"markdown","ed258bf6":"markdown","9b7725e8":"markdown","4951ea35":"markdown","788205f3":"markdown","55b50b06":"markdown","b9735054":"markdown","bfb66c0a":"markdown","28fa90b0":"markdown","0368e12a":"markdown","45ce5561":"markdown","da081cbd":"markdown","e92a3672":"markdown","07bf83e1":"markdown","ba2b7e05":"markdown","33ab78de":"markdown","5a7d92fe":"markdown","6a0b35bb":"markdown","b977b8b3":"markdown","02c074a9":"markdown","d190b5f2":"markdown","474c626b":"markdown"},"source":{"3a103fbc":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns; sns.set(style=\"ticks\", color_codes=True)\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.ensemble import ExtraTreesRegressor, RandomForestRegressor\nfrom sklearn.neighbors import KNeighborsRegressor\nfrom sklearn.svm import SVR\nfrom sklearn.feature_selection import RFE\nfrom sklearn.neural_network import MLPRegressor\nfrom sklearn.metrics import mean_absolute_error\nfrom sklearn.model_selection import KFold\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","b96ea1b9":"dt_train = pd.read_csv('\/kaggle\/input\/covid19-global-forecasting-week-4\/train.csv') \ndt_test = pd.read_csv('\/kaggle\/input\/covid19-global-forecasting-week-4\/test.csv')","7d4b1768":"display(dt_train.head())\ndisplay(dt_train.describe())\ndisplay(dt_train.info())","e220a50d":"viz = dt_train[[\"ConfirmedCases\", \"Fatalities\"]]\nviz.hist()\nplt.show","bc8e533c":"plt.scatter(dt_train.ConfirmedCases, dt_train.Fatalities)\nplt.xlabel(\"ConfirmedCases\")\nplt.ylabel(\"Fatalities\")\nplt.show","a30cf86f":"plt.scatter(dt_train.Date, dt_train.Fatalities)\nplt.xlabel(\"Date\")\nplt.ylabel(\"Fatalities\")\nplt.show","f1cc8945":"plt.figure(figsize=(18,50))\nplt.scatter(dt_train.ConfirmedCases, dt_train.Country_Region)\nplt.xlabel(\"ConfirmedCases\")\nplt.ylabel(\"Country_Region\")\nplt.show","6f0c671b":"usa = dt_train[dt_train[\"Country_Region\"]==\"US\"]","9683d46e":"dt_train","19482f5e":"usa.head()","0b938cc6":"usa.tail()","3c3a385a":"plt.figure(figsize=(10,8))\nplt.plot(usa[\"ConfirmedCases\"])\nplt.xlabel(\"Time\")\nplt.ylabel(\"The Number of Confirmed Cases in USA\")","0ab6eb6e":"plt.figure(figsize=(10,8))\nplt.plot(usa[\"Fatalities\"])\nplt.xlabel(\"Time\")\nplt.ylabel(\"The Number of Fatalities in USA\")","8e16d1ba":"tab_info = pd.DataFrame(dt_train.dtypes).T.rename(index={0:'column Type'}) \ntab_info = tab_info.append(pd.DataFrame(dt_train.isnull().sum()).T.rename(index={0:'null values (nb)'}))\ntab_info = tab_info.append(pd.DataFrame(dt_train.isnull().sum()\/dt_train.shape[0]*100).T.rename(index={0: 'null values (%)'}))\ntab_info","d5354ec3":"usa_states = dt_train[dt_train[\"Country_Region\"]==\"US\"][\"Province_State\"].unique()","87dfbd7d":"def province(state, country):\n    if state == \"nan\":\n        return country\n    return state","1990765a":"dt_train = dt_train.fillna (\"nan\")","cd943850":"dt_train[\"Province_State\"] = dt_train.apply(lambda x: province(x[\"Province_State\"], x[\"Country_Region\"]), axis = 1)","2d900efd":"dt_train","ce7522cb":"usa_states","7c1f0abe":"import seaborn as sns\ncorr = dt_train.corr()\nplt.figure(figsize=(10,10))\nsns.heatmap(corr, \n            annot=True, fmt=\".3f\",\n            xticklabels=corr.columns.values,\n            yticklabels=corr.columns.values)\nplt.show()","2f7296e9":"sns.pairplot(dt_train, vars=[\"ConfirmedCases\", \"Fatalities\", \"Date\", \"Province_State\", \"Country_Region\"])","9b57b383":"sns.pairplot(dt_train.fillna(0), vars=[\"ConfirmedCases\", \"Fatalities\", \"Date\", \"Province_State\", \"Country_Region\"])","673bc50f":"for name, group in dt_train.groupby([\"Province_State\", \"Country_Region\"]):\n    plt.title(name)\n    plt.scatter(range(len(group)), group[\"ConfirmedCases\"])\n    plt.show()\n    break","ed53d7a7":"# Using sklearn package to model the data\nfrom sklearn import linear_model\nregr = linear_model.LinearRegression()\ntrain_x = np.asanyarray(dt_train[['ConfirmedCases']])\ntrain_y = np.asanyarray(dt_train[['Fatalities']])\nregr.fit (train_x, train_y)\n\n# The coefficients\nprint ('Coefficients: ', regr.coef_)\nprint ('Intercept: ',regr.intercept_)","c8084403":"plt.scatter(dt_train.ConfirmedCases, dt_train.Fatalities,  color='blue')\nplt.plot(train_x, regr.coef_[0][0]*train_x + regr.intercept_[0], '-r')\nplt.xlabel(\"ConfirmedCases\")\nplt.ylabel(\"Fatalities\")","2cc4a4b3":"display(dt_test.head())\ndisplay(dt_test.describe())\ndisplay(dt_test.info())","3ea7cd7a":"from sklearn.metrics import r2_score\n\ntest_x = np.asanyarray(dt_train[['ConfirmedCases']])\ntest_y = np.asanyarray(dt_train[['Fatalities']])\ntest_y_ = regr.predict(test_x)\n\nprint(\"Mean absolute error: %.2f\" % np.mean(np.absolute(test_y_ - test_y)))\nprint(\"Residual sum of squares (MSE): %.2f\" % np.mean((test_y_ - test_y) ** 2))\nprint(\"R2-score: %.2f\" % r2_score(test_y_ , test_y) )","fd5af3e7":"dt_train.to_csv('submission.csv', index = False)","7daa0732":"The Coefficient and Intercept are used to create a fit line using the two parameters for estimate.","b7d1bbb4":"**Thank you and stay safe!**","ad6daf44":"**Checking for the Number of States Represented in the Dataset**","3fbc72a7":"**Plotting of the Model Output**","3fd03368":"![](https:\/\/unsplash.com\/photos\/ci2rHJqgC1M)","1cd6ba31":"**Extracting Data from United States of America (USA) and then Plotting it**","bb6cca85":"The above shows that there were no confirmed cases or fatalities in states like Alabama as from the 2020-01-22.","ed258bf6":"First, I downloaded the dataset, in csv format, which contains confirmed cases of the COVID-19 and fatalities globally. Dataset source is from Kaggle.","9b7725e8":"This graph will be used to show the number of fatalities in USA.","4951ea35":"I used the COVID-19 train and test datasets to draw as much meaningful insights as possible regarding the COVID-19 Pandemic spread and forecast.","788205f3":"**Creating a Model using the Training Dataset**","55b50b06":"**Download of the Libraries and Data Importation**","b9735054":"Now we have all the states in the USA that are represented in the dataset.","bfb66c0a":"**Visual Forecasting of the Spread**","28fa90b0":"This graph will be used to show the number of confirmed cases in USA.","0368e12a":"I will use the MSE model evaluation metrics to calculate the accuract of my model based on the test set provided. Focusing more on the  large errors and how close the data are to the fitting regression line.","45ce5561":"The two graphs above show the growth of both the confirmed cases and the fatalities in USA alone against time.","da081cbd":"This is week 4 of Kaggle's COVID-19 forecasting series, following the Week 3 competition. This is the 4th competition round launched in this series. All of the prior discussion forums have been migrated to this competition for continuity.\n\n**Background**\nThe White House Office of Science and Technology Policy (OSTP) pulled together a coalition research groups and companies (including Kaggle) to prepare the COVID-19 Open Research Dataset (CORD-19) to attempt to address key open scientific questions on COVID-19. Those questions are drawn from National Academies of Sciences, Engineering, and Medicine\u2019s (NASEM) and the World Health Organization (WHO).\n\n**The Challenge**\nKaggle is launching a companion COVID-19 forecasting challenges to help answer a subset of the NASEM\/WHO questions. While the challenge involves forecasting confirmed cases and fatalities between April 15 and May 14 by region, the primary goal isn't only to produce accurate forecasts. It\u2019s also to identify factors that appear to impact the transmission rate of COVID-19.\n\n\n**Companies and Organizations**\nThere is also a call to action for companies and other organizations: If you have datasets that might be useful, please upload them to Kaggle\u2019s dataset platform and reference them in this forum thread. That will make them accessible to those participating in this challenge and a resource to the wider scientific community.\n\n**Acknowledgements**\nJHU CSSE for making the data available to the public. The White House OSTP for pulling together the key open questions. The image comes from the Center for Disease Control.","e92a3672":"Using simple regression model with a coefficient of B = (B1,.....Bn) to help minimize the residual sum of squares between the x values in the dataset and the y values by using linear approximation.","07bf83e1":"However, when we check on the mnth of April and current dtae, we see a large number of confirmed cases in Wyoming at 261.","ba2b7e05":"**Reading of the Dataset**","33ab78de":"**Evaluating the Model using the Test Dataset**","5a7d92fe":"**Using the Model to Predict the Unknown Values of the Potential Spread of the COVID-19**","6a0b35bb":"**Data Exploration**","b977b8b3":"Comparing the actual COVID-19 dataset values collected and then predicting the values to calculate the accuracy of the model. This is to provide more insights to the areas that require more atention.","02c074a9":"![COVID-19](https:\/\/unsplash.com\/photos\/ci2rHJqgC1M)","d190b5f2":"Now. let's plot each of the above graphs features versus the Dates, regions, and provinces\/states to see how linear is their relation.","474c626b":"**Plotting of the Graph**"}}