{"cell_type":{"2725db34":"code","4c321df3":"code","6e081862":"code","a5a16e1c":"code","cfe5b4ca":"code","19cc7eca":"code","62a3d8b8":"code","1a29c352":"code","e8609e6e":"code","70ea641f":"code","cc5135ff":"code","c1053b2c":"code","4b9bdb28":"markdown","386dffd9":"markdown","84135ad8":"markdown","382dd239":"markdown","65496a9c":"markdown","8eaab089":"markdown","06b7a563":"markdown","dd143c47":"markdown","2b0e5358":"markdown","d43cd8d1":"markdown"},"source":{"2725db34":"import keras\nfrom keras.models import Sequential\nfrom keras.layers import Dense, Dropout, Flatten\nfrom keras.layers import Conv2D, MaxPooling2D\nfrom keras.utils import to_categorical\nfrom keras.preprocessing import image\n\nimport numpy as np\nimport pandas as pd\n\nimport matplotlib.pyplot as plt\n%matplotlib inline\n\nfrom sklearn.model_selection import train_test_split\n\nfrom tqdm import tqdm","4c321df3":"data = pd.read_csv('..\/input\/movie-classifier\/Multi_Label_dataset\/train.csv')\ndata = data.head(2000)\ndata.head()","6e081862":"Data_columns = data.columns\nData_columns","a5a16e1c":"train_image = []\nfor i in tqdm(range(data.shape[0])):\n    img = image.load_img('..\/input\/movie-classifier\/Multi_Label_dataset\/Images\/'+\n                         data['Id'][i]+\n                         '.jpg',\n                         target_size=(400,400,3))\n    img = image.img_to_array(img)\n    img = img\/255\n    train_image.append(img)\n    \nX = np.array(train_image)","cfe5b4ca":"X.shape","19cc7eca":"y = np.array(data.drop(['Id', 'Genre'],axis=1))\ny.shape","62a3d8b8":"X_train, X_test, y_train, y_test = train_test_split(X, y, random_state=25, test_size=0.1)\n","1a29c352":"model = Sequential()\nmodel.add(Conv2D(filters=16, kernel_size=(5, 5), activation=\"relu\", input_shape=(400,400,3)))\nmodel.add(MaxPooling2D(pool_size=(2, 2)))\nmodel.add(Dropout(0.25))\nmodel.add(Conv2D(filters=32, kernel_size=(5, 5), activation='relu'))\nmodel.add(MaxPooling2D(pool_size=(2, 2)))\nmodel.add(Dropout(0.25))\nmodel.add(Conv2D(filters=32, kernel_size=(5, 5), activation='relu'))\nmodel.add(MaxPooling2D(pool_size=(2, 2)))\nmodel.add(Dropout(0.25))\nmodel.add(Conv2D(filters=64, kernel_size=(5, 5), activation=\"relu\"))\nmodel.add(MaxPooling2D(pool_size=(2, 2)))\nmodel.add(Dropout(0.25))\nmodel.add(Conv2D(filters=64, kernel_size=(5, 5), activation='relu'))\nmodel.add(MaxPooling2D(pool_size=(2, 2)))\nmodel.add(Dropout(0.25))\nmodel.add(Flatten())\nmodel.add(Dense(128, activation='relu'))\nmodel.add(Dropout(0.5))\nmodel.add(Dense(64, activation='relu'))\nmodel.add(Dropout(0.5))\nmodel.add(Dense(25, activation='sigmoid'))","e8609e6e":"model.summary()","70ea641f":"model.compile(optimizer='adam', loss='binary_crossentropy', metrics=['accuracy'])","cc5135ff":"history = model.fit(X_train, y_train, epochs=10, validation_data=(X_test, y_test), batch_size=50)","c1053b2c":"img = image.load_img('..\/input\/movie-classifier\/Multi_Label_dataset\/Images\/tt0102428.jpg',\n                     target_size=(400,400,3))\nplt.imshow(img)\n\nimg = image.img_to_array(img)\nimg = img\/255.0\nimg = img.reshape(1,400,400,3)\n\nclasses = data.columns[2:]\ny_pred = model.predict(img)\n\ngenre =np.argsort(y_pred[0])[:-6:-1]\nfor i in range(5):\n    print(classes[genre[i]])","4b9bdb28":"Above are the result for the Poster provided.\n\nThat's look impresive :)\n\nDo UPVOTE the Notebook.\nAnd, Happy Coding","386dffd9":"Split the Output Label","84135ad8":"## Train & Test Split\n\nI used 0.1 test_size here, so that model is trained over more values","382dd239":"## Model Defination\n\nWhole model structure which I used is build here:","65496a9c":"## Importing necessary libraries","8eaab089":"First we need to find how many different Genre are present in Dataset","06b7a563":"So, now let's train the Model\nI trained for 10 Epoches and with Batch Size of 50 at a time","dd143c47":"# Movie Genre Just by Poster\n\nMovie's Poster contains many vital information. It not only tells about Who are the Cast but could also tell which Genre movie belong to.\nUsing this dataset I tried to build a Movie Genre Prediction just by looking the poster.\n\nIn this model I predicted top 5 Prediction of Genre\n\nHave a look.\n\nAnd if you like my work do UPVOTE. :)","2b0e5358":"## Let's test for some Images","d43cd8d1":"## Reading the dataset\n\nI used only 2000 images to train this model here beacuse of the limitation og Kaggle's Computation.\nYou could train for all images in your System or on Cloud."}}