{"cell_type":{"535f4812":"code","1ad26961":"code","1555f2bc":"code","6ddb9e12":"code","0bb554d3":"code","616bbb2e":"code","599fc783":"code","d3f4251c":"code","c3ece497":"code","e3e9e152":"code","5aaabd21":"code","e933f2bc":"code","a9a1451f":"markdown"},"source":{"535f4812":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn import svm #Import svm model\nfrom sklearn import metrics #Import scikit-learn metrics module for accuracy calculation\nfrom sklearn.metrics import confusion_matrix,roc_curve,roc_auc_score,accuracy_score, plot_confusion_matrix,classification_report\n","1ad26961":"df=pd.read_csv('..\/input\/heartdataset\/heart.csv')","1555f2bc":"df.head()","6ddb9e12":"df.describe()","0bb554d3":"df.plot(kind='scatter',x='age',y='chol',alpha=0.5,color='red')\nplt.xlabel('Age')\nplt.ylabel('Cholesterol')\nplt.title('Age Cholesterol Plot')","616bbb2e":"x=df.drop('target',axis=1)\ny=df.target","599fc783":"from sklearn.model_selection import train_test_split\nx_train,x_test,y_train,y_test=train_test_split(x,y,test_size=0.3,random_state=100)","d3f4251c":"from sklearn.model_selection import GridSearchCV\nml = svm.SVC()\n\nparam_grid = {'C': [ 1, 10, 100, 1000,10000], \n              'gamma': [1,0.1,0.01,0.001,0.0001],\n              'kernel': ['rbf']} \ngrid = GridSearchCV(ml, param_grid, refit = True, verbose = 1,cv=15)\n\ngrid_search=grid.fit(x_train, y_train)","c3ece497":"print(grid_search.best_params_)","e3e9e152":"accuracy = grid_search.best_score_ *100\nprint(\"Accuracy for our training dataset with tuning is : {:.2f}%\".format(accuracy) )","5aaabd21":"y_test_hat=grid.predict(x_test)\ntest_accuracy=accuracy_score(y_test,y_test_hat)*100\ntest_accuracy\nprint(\"Accuracy for our testing dataset with tuning is : {:.2f}%\".format(test_accuracy) )","e933f2bc":"confusion_matrix(y_test,y_test_hat)\ndisp=plot_confusion_matrix(grid, x_test, y_test,cmap=plt.cm.Greens)","a9a1451f":"*29 patients were predicted that they will have Heart Disease,the Prediction was CORRECT (True-Positive)\n\n*41 patients were predicted that they will NOT have Heart Disease,the Prediction was CORRECT (True-Negative)\n\n*17 patients were predicted that they will have Heart Disease but the Prediction was WRONG (False-Positive)\n\n*4 patients were predicted that they will NOT have Heart Disease but the Prediction was WRONG (False-Negative)"}}