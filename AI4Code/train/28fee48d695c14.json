{"cell_type":{"a7fa0f3f":"code","db91e3d0":"code","d5da83fa":"code","f3b2c1ae":"code","776a8267":"code","30c4c8d2":"code","f1ee57cc":"code","4be501c3":"code","bddf37f5":"code","10f0b213":"code","a2c57d94":"code","2f01bc2b":"code","5e364ceb":"code","36171d25":"code","d8416cbc":"code","e95d01a9":"markdown","f7d2118d":"markdown","6605ed40":"markdown","27a54060":"markdown","7e2db467":"markdown","db316461":"markdown","e5f0bc2b":"markdown","b9f83f40":"markdown","f704791f":"markdown","9508a6f5":"markdown","21840a45":"markdown","f3fb3057":"markdown","3722fc04":"markdown","0065aa6f":"markdown"},"source":{"a7fa0f3f":"import pandas as pd\nimport numpy as np\n\n# Importing libraries for plotting the data:\nimport matplotlib.pyplot as plt\nimport seaborn as sns","db91e3d0":"malldata = pd.read_csv(\"..\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv\")","d5da83fa":"malldata.head()","f3b2c1ae":"malldata.isnull().sum()","776a8267":"malldata.drop(['CustomerID'], inplace=True, axis=1)","30c4c8d2":"malldata.columns","f1ee57cc":"import plotly.express as px\n\ndf = px.data.tips()\n\nfig = px.histogram(malldata, x='Spending Score (1-100)', y = 'Annual Income (k$)',\n                  color = 'Gender', hover_data = malldata.columns, marginal = 'box')\n\nfig.show()\n","4be501c3":"# Literally the first time I am using plotly and it is amazing:\nimport plotly.graph_objects as go\nplt.figure(figsize=(10,10))\nfig = go.Figure(data= [go.Mesh3d(x = malldata['Spending Score (1-100)'],\n                                 y = malldata['Annual Income (k$)'],\n                                 z = malldata['Age'],\n                                 opacity = 0.5, color = 'skyblue')])\n\nfig.update_layout(scene = dict(xaxis_title='Spending Score',\n                               yaxis_title='Annual Income',\n                               zaxis_title='Age'),\n                  )\n\nfig.show()","bddf37f5":"d = px.data.gapminder()\n    \nf = px.bar(malldata, x = malldata[\"Gender\"], y = malldata[\"Spending Score (1-100)\"],\n           color = malldata[\"Gender\"], animation_frame = malldata[\"Age\"],\n           range_y = [0,100])\n\nfig.update_layout(scene = dict(xaxis_title='Gender',\n                               yaxis_title='Spending Score (1-100)',\n                               zaxis_title='Age'))\nf.show()","10f0b213":"sns.set_context(\"poster\", font_scale=.7)\nsns.set_palette([\"skyblue\", \"magenta\"])\nplt.figure(figsize=(8,8))\nsns.scatterplot(data=malldata, x='Annual Income (k$)', y='Spending Score (1-100)', hue='Gender')","a2c57d94":"encdata = malldata.copy()\n\nfrom sklearn.preprocessing import LabelEncoder\n\nlab = LabelEncoder()\n\nencdata['Gender'] = lab.fit_transform(encdata['Gender'])\n","2f01bc2b":"from sklearn.preprocessing import StandardScaler\n\nscale = StandardScaler()\n\nscaleddata = scale.fit_transform(encdata)","5e364ceb":"from sklearn.cluster import KMeans\n\nkm = KMeans(n_clusters = 4, init=\"k-means++\")\n\ncluster = pd.DataFrame(km.fit_predict(scaleddata), columns=['cluster'])\n","36171d25":"newdata = pd.concat([cluster, malldata], axis=1)","d8416cbc":"plt.figure(figsize=(5,5))\nsns.pairplot(newdata, hue='cluster')","e95d01a9":"Lets now switch to seaborn to plot a scatterplot trying to visualize the correlation between age and spending score:","f7d2118d":"Standardising:","6605ed40":"# KMeans Algorithm:","27a54060":"The CustomerID feels useless so lets drop it:","7e2db467":"KMEANS TIME!","db316461":"Okay, so we have a clean dataset.","e5f0bc2b":"So it can be seen that a lot of the cutomers here cluster somewhere around the centre, and with a naked eye I can assume that here we have about 5 clusters so lets segment the customers. But first, converting the categorical column into numerical one is a must or else the KMeans algorithm wouldn't work. Also, lets Standardise it:","b9f83f40":"Lets check if our malldata has NaN values:","f704791f":"# Visualizing the Data:\n","9508a6f5":"Time to plot the ScatterPlot:","21840a45":"Here's an interactive histogram expressing how the spending scores in males and females change with their age.","f3fb3057":"Well, it seems like the idea to find clusters in this data isn't working or maybe I don't have the ability to provide better insights but lets keep learning now,shall we?\n\nThank you for going through this Notebook, an upvote would be much appreciated and help my journey!","3722fc04":"Concatenating the data and the cluster column so that we can use it in the scatterplot:","0065aa6f":"Lets look at how the three main elements in this data, Age, Spending Score and Annual Income interact:"}}