{"cell_type":{"279d045f":"code","37fb77e0":"code","b6ce0610":"code","cb1e8695":"code","5ddd9eea":"code","67be1638":"code","223830e8":"code","e14005b7":"code","75d717de":"code","c300c801":"code","09309619":"code","3c1763e1":"code","0b35e310":"code","124ba964":"code","360aa4b4":"code","cce81238":"code","2503fafe":"code","ad740fcb":"code","7d80b8dc":"code","e5dadef0":"code","4e52fae6":"markdown","bd5f6718":"markdown","2eac5c63":"markdown","a4f8d529":"markdown","46a293b6":"markdown","ccc9d3e9":"markdown","0b7681ba":"markdown","ada188af":"markdown","81224d1d":"markdown","e6ba1243":"markdown","512ae3b2":"markdown","a058ba49":"markdown","67a38926":"markdown","9fb1213a":"markdown","30fd8219":"markdown","52420adc":"markdown","e7c2b80e":"markdown","68d27d50":"markdown","d54932ce":"markdown","2874fabd":"markdown","13a51d45":"markdown","4902051f":"markdown","5351e229":"markdown","be2bf70b":"markdown","4348773d":"markdown","c549c03c":"markdown","11f80b38":"markdown"},"source":{"279d045f":"#Importing Libraries\nimport pandas as pd\n\npd.set_option('display.max_columns', 20)\npd.set_option('display.max_rows', 20)\npd.set_option('display.float_format', lambda x: '%.5f' % x)","37fb77e0":"!pip install xlrd\n!pip install openpyxl","b6ce0610":"df_ = pd.read_excel(\"..\/input\/uci-online-retail-ii-data-set\/online_retail_II.xlsx\", sheet_name=\"Year 2010-2011\",engine='openpyxl')","cb1e8695":"df = df_.copy()\ndf.head()","5ddd9eea":"df.describe().T","67be1638":"df.isnull().sum().any() #We have missing observations in our data set.","223830e8":"df.isnull().sum()","e14005b7":"df.dropna(inplace=True)","75d717de":"df.isnull().sum() #We removed our missing observations","c300c801":"df[\"Description\"].nunique()","09309619":"df[\"Description\"].value_counts()","3c1763e1":"df.groupby(\"Description\").agg({\"Quantity\": \"sum\"}).sort_values(by =\"Quantity\",ascending=False)","0b35e310":"df = df[~df[\"Invoice\"].str.contains(\"C\", na=False)]\ndf[\"Invoice\"].head(50)","124ba964":"df = df[(df['Quantity'] > 0)]\ndf = df[(df['Price'] > 0)]\n\ndf[\"TotalPrice\"] = df[\"Quantity\"] * df[\"Price\"]\ndf.head()","360aa4b4":"# Note 1: For the recency value, accept today's date as (2011, 12, 11)\ndf[\"InvoiceDate\"].max()\nimport datetime as dt\ntoday_date = dt.datetime(2011, 12, 11)\n# Calculate customer specific Recency, Frequency and Monetary metrics with groupby, agg and lambda.\ndf.groupby('Customer ID').agg({'InvoiceDate': lambda InvoiceDate: (today_date - InvoiceDate.max()).days,\n                                     'Invoice': lambda Invoice: Invoice.nunique(),\n                                     'TotalPrice': lambda TotalPrice: TotalPrice.sum()})\n\n\n# Assign your calculated metrics to a variable named rfm.\nrfm = df.groupby('Customer ID').agg({'InvoiceDate': lambda InvoiceDate: (today_date - InvoiceDate.max()).days,\n                                     'Invoice': lambda Invoice: Invoice.nunique(),\n                                     'TotalPrice': lambda TotalPrice: TotalPrice.sum()})\n# Change the names of the metrics you created to recency, frequency and monetary.\nrfm.columns = ['recency', 'frequency', 'monetary']\n\n\n# Note 2: After creating the rfm dataframe, filter the dataset to \"monetary>0\"\nrfm = rfm[(rfm['monetary'] > 0)]","cce81238":"# Convert Recency, Frequency and Monetary metrics to scores between 1-5 with the help of qcut.\nrfm[\"recency_score\"] = pd.qcut(rfm['recency'], 5, labels=[5, 4, 3, 2, 1])\nrfm[\"frequency_score\"] = pd.qcut(rfm[\"frequency\"].rank(method=\"first\"), 5, labels=[1, 2, 3, 4, 5])\nrfm[\"monetary_score\"] = pd.qcut(rfm['monetary'], 5, labels=[1, 2, 3, 4, 5])\n\n# Record these scores as recency_score, frequency_score and monetary_score.\n# CAUTION! We do not include Monetary score\n# Express the value of 2 different variables as a single variable and save it as RFM_SCORE\nrfm[\"RFM_SCORE\"] = (rfm['recency_score'].astype(str) + rfm['frequency_score'].astype(str))","2503fafe":"rfm[\"RFM_SCORE\"]","ad740fcb":"seg_map = {\n    r'[1-2][1-2]': 'hibernating',\n    r'[1-2][3-4]': 'at_risk',\n    r'[1-2]5': 'cant_loose',\n    r'3[1-2]': 'about_to_sleep',\n    r'33': 'need_attention',\n    r'[3-4][4-5]': 'loyal_customers',\n    r'41': 'promising',\n    r'51': 'new_customers',\n    r'[4-5][2-3]': 'potential_loyalists',\n    r'5[4-5]': 'champions'\n}\nrfm['segment'] = rfm['RFM_SCORE'].replace(seg_map, regex=True) #regex'i kullanabiliriz replace yaparken ; da\u011f\u0131t\u0131k metin i\u00e7indeki ifadelerden istedi\u011fimiz ifadeleri belirli formatta almam\u0131z\u0131 sa\u011flar.\nrfm = rfm[[\"recency\", \"frequency\", \"monetary\", \"segment\"]]\nrfm.head()","7d80b8dc":"rfm[[\"segment\",\"recency\",\"frequency\",\"monetary\"]].groupby(\"segment\").agg([\"mean\",\"count\",\"median\"])\n\nnew_df = pd.DataFrame()","e5dadef0":"new_df[\"Loyal CustomerID\"] = rfm[rfm[\"segment\"] == \"Loyal Customer\"].index\nnew_df.to_excel(\"Loyal_Customer.xlsx\")","4e52fae6":"# TASK 4:\n\n> Defining RFM scores as segments\n\n* Segment definitions to make the generated RFM scores more explainable do it.\n\n* Convert the scores into segments with the help of the seg_map below.","bd5f6718":"**Understanding Monetary Value**\n\nHow much did a customer spend in total. Depending on the total value of his purchases (as by the sum of his order value) assign a monetary value score.\n\n![image.png](attachment:36d1cee3-3674-4548-a42a-90567d7043cc.png)","2eac5c63":"# Dataset Story\n\nThe dataset named Online Retail II shows the sales of a UK-based online store between 01\/12\/2009 - 09\/12\/2011.\ncontains.\n\nThe product catalog of this company includes souvenirs.\n\nThe vast majority of the company's customers are corporate customers.","a4f8d529":"# Project Steps\n\n**Apply RFM analysis to sheet named \"Year2010-2011\" of online_retail_II.xlsx dataset**","46a293b6":"![image.png](attachment:8baddff1-12c6-498c-88cf-e7a596feccfb.png)","ccc9d3e9":"* **Question 6**: How many of each product are there?","0b7681ba":"# Action !!\nChampions are the first class that is important to focus on and interpret for the business and as it is understood from its naming and interpretation.\nAlready, these customers are regularly on the move and there is always a continuity. The rate of loss of these people is low.\nI think these people shouldn't be given discounts too often. Because they are already our fixed contacts.\nAlready, they leave more money to the business than others in the money flow.\nDiscounts with other classes must be different from the discount for champions or their days.\nMaybe it's a good thing you have prizes can be distributed to the champions :)\nOr \"real\" gifts that will be considered as attention-grabbing in the field of social responsibility can be made.\nIn order not to lose from the champions :)\n\n\n**1. for new customer;**\n> There are 42 clients:\n\n> frequency is 1 because it is a new customer\n\nAlthough it is thought of as an ineffective class compared to others, we can say that it is the most important group in the positive deterioration of the balance between classes.\nWe can look at new customers as follows, if they are satisfied with their first experience, they will make the next experience and share it with their stakes and gain new customers.\nTherefore, campaigns can be made for new customers that will create more experience than champions.\n\n\n**2. Loyal Customers:**\n> 819 customers\n> average novelty value : 30.\n> shopping frequency is : 5.\n\nWe can say that it is a class with a high income in general. I would say it is an active group.\nPopular products they are #interested in can accelerate the return with attractive discounts after shopping and make it easier to meet the next class.\nIt can be effective in increasing the #frequency value.\n\n**3. At Risk:**\n> There are 593 customers.\n\nIs a group whose income is not high and it is likely to be high.\nSo these people should try harder than others to get their attention and get them out of this class.\nMaybe because it's critical to make them feel more empathetic and help them know which products they want discount on, price range suitability, being at risk.\nForms can be sent where they can receive their complaints as well as supply and demand.","ada188af":"* **Question 5**: How many unique products?","81224d1d":"# Hellooooo, I \u2764\ufe0f VBO \n\n**- I will explain my Customer Segmentation project in my weekly assignments in order to turn it into a contribution for you.**","e6ba1243":"# TASK 2:\n\n> Calculating RFM metrics\n\n* Make the definitions of Recency, Frequency and Monetary.\n\n*  Calculate customer specific Recency, Frequency and Monetary metrics with groupby, agg and lambda.\n\n* Assign your calculated metrics to a variable named rfm.\n\n*  Change the names of the metrics you created to recency, frequency and monetary.\n\n\n**Note 1:** For the recency value, accept today's date as (2011, 12, 11).\n\n**Note 2:** After creating the rfm dataframe, filter the dataset to \"monetary>0\"","512ae3b2":"* **Question 1:** Online Retail II excelindeki 2010-2011 verisini okuyunuz. Olu\u015fturdu\u011funuz dataframe\u2019in kopyas\u0131n\u0131 olu\u015fturunuz.","a058ba49":"# TASK 3:\n\n> Generating and converting RFM scores to a single variable\n\n*  Convert Recency, Frequency and Monetary metrics to scores between 1-5 with the help of qcut.\n\n*  Record these scores as recency_score, frequency_score and monetary_score.\n\n*  Express the value of 2 different variables as a single variable and save it as RFM_SCORE.\n\n\n**E.g;**\nCreate the recency_score, frequency_score scores of 5, 2, respectively, in separate variables, with the naming of the RFM_SCORE variable.\n\n**CAUTION!** We do not include Monetary score","67a38926":"**Understanding Frequency**\n\nHow often did a customer buy. Depending on the number of purchases (as by distinct order days) assign a frequency score.\n\n![image.png](attachment:a7cedddb-f989-451a-adcb-4821973c2e16.png)","9fb1213a":"**Understanding Recency**\n\nDepending on how recent a customer make his last purchase (as by the number of days elapsed) assign a recency score.\n\n![image.png](attachment:283c985f-47d7-427a-b927-70e419c8b293.png)","30fd8219":"**What is RFM Segmentation?**\n\nRFM is a proven marketing model that is used to segment and analyse customers based on their behavior. RFM Segments are used to create relevant communication and to achieve higher response rates.\n\n**What does RFM stand for?**\n\nRFM stands for the 3 behavioral dimensions by which customer are categorized:\n\n**Recency:** How recent did the customer make his last purchase\n\n**Frequency:** How often did the customer make a purchase\n\n**Monetary Value:** How much in total did the customer spent","52420adc":"# Customer Segmentation using RFM","e7c2b80e":"# Variables\n\n* **InvoiceNo** \u2013 Invoice Number\n> If this code starts with C, it means that the operation has been cancelled.\n\n* **StockCode** \u2013 Product code\n> Unique number for each product.\n\n* **Description** \u2013 Product name\n\n* **Quantity** \u2013 Number of products\n> It expresses how many of the products on the invoices have been sold.\n\n* **InvoiceDate** \u2013 Invoice date\n\n* **UnitPrice** \u2013 Invoice price (Sterling)\n\n* **CustomerID** \u2013 Unique customer number\n\n* **Country** \u2013 Country name","68d27d50":"* **Question 2**: Examine the descriptive statistics of the data set.","d54932ce":"# Business Problem\n\n\nAn e-commerce company wants to segment its customers and determine marketing strategies according to these segments.\n\nThe company believes that marketing activities specific to customer segments that exhibit common behaviors will increase revenue.\n\nFor example, it is desired to organize different campaigns for new customers and different campaigns to retain customers, which are very profitable for the company.\n\nSegment customers with the RFM method.","2874fabd":"# TASK 5:\n\n> It's action time!\n\n* Select the 3 segments you find important. These three segments;\n\n1. Both in terms of action decisions,\n\n2. Both in terms of the structure of the segments (mean RFM values) please comment.\n\n* Select the customer IDs of the \"Loyal Customers\" class and get the excel output.","13a51d45":"* **Question 9**: Create a variable named 'TotalPrice' that represents the total earnings per invoice.","4902051f":"# TASK 1:","5351e229":"* **Question 7**: Rank the 5 most ordered products from most to least.","be2bf70b":"* **Question 4**: Remove the missing observations from the data set. Use the 'inplace=True' parameter for subtraction.","4348773d":"We can use ***regex*** when replacing; It allows us to get the expressions we want from the expressions in the distributed text in a certain format.","c549c03c":"* **Question 3**: Are there any missing observations in the dataset? If yes, how many missing observations in each variable?","11f80b38":"* **Question 8**: The 'C' in the invoices shows the canceled transactions. Remove the canceled transactions from the dataset."}}