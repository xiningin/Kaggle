{"cell_type":{"d4c076dd":"code","12ffaec1":"code","f7e25b86":"code","643eb541":"code","af850a87":"code","aa885724":"code","97c5aaed":"code","e0e52cb9":"code","f7024af3":"code","c4c8691e":"code","adf62a6d":"code","a89b43a8":"code","1fe1f43e":"markdown","1e99d190":"markdown","a5e1719b":"markdown","8f1bf3c3":"markdown","fa1cf64b":"markdown","625a416c":"markdown","122f9d32":"markdown","15d57fc1":"markdown","92407387":"markdown","0912be0c":"markdown","7c8f48c1":"markdown","745b6286":"markdown","f79379da":"markdown","a3efbcbb":"markdown","984350f9":"markdown","c2cda4b9":"markdown","1ecbe432":"markdown","b9dd122a":"markdown","57e0bbd5":"markdown","cef87849":"markdown","9e32990c":"markdown","f62fa56c":"markdown","791581f4":"markdown","7e67c8f1":"markdown","93abf2f0":"markdown"},"source":{"d4c076dd":"#!pip install plotly","12ffaec1":"import pandas as pd\nimport numpy as np\nfrom matplotlib import pyplot as plt\nimport seaborn as sns\nimport plotly.offline as py\nimport warnings\nimport pycountry\nwarnings.filterwarnings('ignore')\n\npy.init_notebook_mode(connected=True)\nimport plotly.graph_objs as go","f7e25b86":"PATH = '..\/input\/120-years-of-olympic-history-athletes-and-results\/athlete_events.csv'\ndata = pd.read_csv(PATH)\ndata.head(3)","643eb541":"colors = ['#f4cb42', '#cd7f32', '#a1a8b5'] #gold,bronze,silver\nmedal_counts = data.Medal.value_counts(sort=True)\nlabels = medal_counts.index\nvalues = medal_counts.values\n\npie = go.Pie(labels=labels, values=values, marker=dict(colors=colors))\nlayout = go.Layout(title='Medal distribution')\nfig = go.Figure(data=[pie], layout=layout)\npy.iplot(fig)","af850a87":"topn = 10\nmale = data[data.Sex=='M']\nfemale = data[data.Sex=='F']\ncount_male = male.dropna().NOC.value_counts()[:topn].reset_index()\ncount_female = female.dropna().NOC.value_counts()[:topn].reset_index()\n\npie_men = go.Pie(labels=count_male['index'],values=count_male.NOC,name=\"Men\",hole=0.4,domain={'x': [0,0.46]})\npie_women = go.Pie(labels=count_female['index'],values=count_female.NOC,name=\"Women\",hole=0.4,domain={'x': [0.5,1]})\n\nlayout = dict(title = 'Top-10 countries with medals by sex', font=dict(size=15), legend=dict(orientation=\"h\"),\n              annotations = [dict(x=0.2, y=0.5, text='Men', showarrow=False, font=dict(size=20)),\n                             dict(x=0.8, y=0.5, text='Women', showarrow=False, font=dict(size=20)) ])\n\nfig = dict(data=[pie_men, pie_women], layout=layout)\npy.iplot(fig)","aa885724":"games = data[data.Season=='Summer'].Games.unique()\ngames.sort()\nsport_counts = np.array([data[data.Games==game].groupby(\"Sport\").size().shape[0] for game in games])\nbar = go.Bar(x=games, y=sport_counts, marker=dict(color=sport_counts, colorscale='Reds', showscale=True))\nlayout = go.Layout(title='Number of sports in the summer Olympics by year')\nfig = go.Figure(data=[bar], layout=layout)\npy.iplot(fig)","97c5aaed":"topn = 10\ntop10 = data.dropna().NOC.value_counts()[:topn]\n\ngold = data[data.Medal=='Gold'].NOC.value_counts()\ngold = gold[top10.index]\nsilver = data[data.Medal=='Silver'].NOC.value_counts()\nsilver = silver[top10.index]\nbronze = data[data.Medal=='Bronze'].NOC.value_counts()\nbronze = bronze[top10.index]\n\nbar_gold = go.Bar(x=gold.index, y=gold, name = 'Gold', marker=dict(color = '#f4cb42'))\nbar_silver = go.Bar(x=silver.index, y=silver, name = 'Silver', marker=dict(color = '#a1a8b5'))\nbar_bronze = go.Bar(x=bronze.index, y=bronze, name = 'Bronze', marker=dict(color = '#cd7f32'))\n\nlayout = go.Layout(title='Top-10 countries with medals', yaxis = dict(title = 'Count of medals'))\n\nfig = go.Figure(data=[bar_gold, bar_silver, bar_bronze], layout=layout)\npy.iplot(fig)","e0e52cb9":"tmp = data.groupby(['Sport'])['Height', 'Weight'].agg('mean').dropna()\ndf1 = pd.DataFrame(tmp).reset_index()\ntmp = data.groupby(['Sport'])['ID'].count()\ndf2 = pd.DataFrame(tmp).reset_index()\ndataset = df1.merge(df2) #DataFrame with columns 'Sport', 'Height', 'Weight', 'ID'\n\nscatterplots = list()\nfor sport in dataset['Sport']:\n    df = dataset[dataset['Sport']==sport]\n    trace = go.Scatter(\n        x = df['Height'],\n        y = df['Weight'],\n        name = sport,\n        marker=dict(\n            symbol='circle',\n            sizemode='area',\n            sizeref=10,\n            size=df['ID'])\n    )\n    scatterplots.append(trace)\n                         \nlayout = go.Layout(title='Mean height and weight by sport', \n                   xaxis=dict(title='Height, cm'), \n                   yaxis=dict(title='Weight, kg'),\n                   showlegend=True)\n\nfig = dict(data = scatterplots, layout = layout)\npy.iplot(fig)","f7024af3":"men = data[data.Sex=='M'].Age\nwomen = data[data.Sex=='F'].Age\n\nbox_m = go.Box(x=men, name=\"Male\", fillcolor='navy')\nbox_w = go.Box(x=women, name=\"Female\", fillcolor='lime')\nlayout = go.Layout(title='Age by sex')\nfig = go.Figure(data=[box_m, box_w], layout=layout)\npy.iplot(fig)","c4c8691e":"#!pip install pycountry","adf62a6d":"def get_name(code):\n    '''\n    Translate code to name of the country\n    '''\n    try:\n        name = pycountry.countries.get(alpha_3=code).name\n    except:\n        name=code\n    return name\n\ncountry_number = pd.DataFrame(data.NOC.value_counts())\ncountry_number['country'] = country_number.index\ncountry_number.columns = ['number', 'country']\ncountry_number.reset_index().drop(columns=['index'], inplace=True)\ncountry_number['country'] = country_number['country'].apply(lambda c: get_name(c))\ncountry_number.head(3)","a89b43a8":"worldmap = [dict(type = 'choropleth', locations = country_number['country'], locationmode = 'country names',\n                 z = country_number['number'], autocolorscale = True, reversescale = False, \n                 marker = dict(line = dict(color = 'rgb(180,180,180)', width = 0.5)), \n                 colorbar = dict(autotick = False, title = 'Number of athletes'))]\n\nlayout = dict(title = 'The Nationality of Athletes', geo = dict(showframe = False, showcoastlines = True, \n                                                                projection = dict(type = 'Mercator')))\n\nfig = dict(data=worldmap, layout=layout)\npy.iplot(fig, validate=False)","1fe1f43e":"Of course, we can not do without the Bar. \n\nLet's draw a bar chart of the number of sports in different years.","1e99d190":"The whole rendering scheme is the same, now the base class is __go.Bar__.\n\n- Dictionary __marker__ sets the drawing style of the chart and allows you to display the color scale\n- To learn more, read the <a href='https:\/\/plot.ly\/python\/bar-charts\/'>go.Bar documentation<\/a>","a5e1719b":"It was beautiful, wasn't it? We can interactively remove the sport we are interested in, zoom in and analyze the charts in every possible way.\n\n- Dictionary __marker__ again defines the drawing view, sets the shape type (try, for example, square), dimensions, and more. The possibilities are almost endless.\n- To learn more, read the <a href='https:\/\/plot.ly\/python\/line-and-scatter\/'>go.Scatter documentation<\/a>","8f1bf3c3":"Again, let's complicate the graph and display the number of different medals for the top 10 countries","fa1cf64b":"## <a id=\"bar\">2. Bar<\/a>  ","625a416c":"Here you will see how to draw interactive graphics easily and with a minimum of code. Plotly is an extremely powerful tool and it is impossible to cover all its features at once, so I'll show you how to build the most relevant and interesting graphics.","122f9d32":"We will display statistics on age for men and women participating in the Olympics with Boxplot.","15d57fc1":"The dataset has the following features:\n\n- __ID__ - Unique number for each athlete\n- __Name__ - Athlete's name\n- __Sex__ - M or F\n- __Age__ - Integer\n- __Height__ - In centimeters\n- __Weight__ - In kilograms\n- __Team__ - Team name\n- __NOC__ - National Olympic Committee 3-letter code\n- __Games__ - Year and season\n- __Year__ - Integer\n- __Season__ - Summer or Winter\n- __City__ - Host city\n- __Sport__ - Sport\n- __Event__ - Event\n- __Medal__ - Gold, Silver, Bronze, or NA","92407387":"- To learn more, read the <a href='https:\/\/plot.ly\/python\/choropleth-maps\/'>go.Box documentation<\/a>","0912be0c":"- This graph describes the distribution of the data. The center vertical line corresponds to the median, and the boundaries of the rectangle correspond to the first and third quartiles. The points show the outliers. In addition, you can see the minimum and maximum values.\n- Who do you think is the __youngest__ (10 y.o.) and the __oldest__ (97 y.o.) participant of the Olympics? Find them :)\n- To learn more, read the <a href='https:\/\/plot.ly\/python\/box-plots\/'>go.Box documentation<\/a>","7c8f48c1":"## <a id=\"box\">4. Box<\/a> ","745b6286":"- Parameter __hole__ sets the size of the hole in the center of the pie\n- Parameter __domain__ sets the offset. The X array set the horizontal position whilst the Y array sets the vertical. For example, x: [0,0.5], y: [0, 0.5] would mean the bottom left position of the plot.\n- Dict __annotations__ sets the format of the text inside the Pie.\n- To learn more, read the <a href='https:\/\/plot.ly\/python\/pie-charts\/'>go.Pie documentation<\/a>","f79379da":"All the main classes for drawing graphs are located in <strong>plotly.graph_objs<\/strong> as <strong>go<\/strong>:\n\n- __go.Pie__ is a graph object with any of the named arguments or attributes listed below. \n- __go.Layout__ allows you to customize axis labels, titles, fonts, sizes, margins, colors, and more to define the appearance of the chart.\n- __go.Figure__ just creates the final object to be plotted, and simply just creates a dictionary-like object that contains both the data object and the layout object.","a3efbcbb":"## <a id=\"choropleth\">5. Choropleth<\/a> ","984350f9":"## <a id=\"scatter\">3. Scatter<\/a>  ","c2cda4b9":"Okay, that was too easy. Let's complicate the chart a bit, we will use two Pie on one chart.\n\nWe will display the top 10 countries whose athletes win any medals. Separate for men and women.","1ecbe432":"Let's draw a beautiful scatter plot showing average height and weight for athletes from different sports.\n\nWe will make circles of different sizes depending on the popularity of the sport and, as a result, the sample size of athletes.","b9dd122a":"First, if you don't already have Plotly installed, run:","57e0bbd5":"That's it, you've learned how plotly works and mastered simple but beautiful interactive graphics.","cef87849":"### <center>We will use the popular open source library Plotly for data visualization.<\/center>","9e32990c":"Let's determine how many participants were sent by different countries during the whole period of the Olympics.","f62fa56c":"#### Useful links\n\n- <a href='https:\/\/plot.ly\/'>Plotly website<\/a>\n- <a href='https:\/\/www.kaggle.com\/kanncaa1\/plotly-tutorial-for-beginners'>Plotly for beginners<\/a>\n- <a href='https:\/\/www.kaggle.com\/hakkisimsek\/plotly-tutorial-3'>Plotly tutorials<\/a>","791581f4":"Let's draw the simplest graph possible. Display the percentages of three types of medals among the total number of medals.","7e67c8f1":"## <a id=\"pie\">1. Pie<\/a>  ","93abf2f0":"- <a href='#pie'>Pie<\/a>  \n- <a href='#bar'>Bar<\/a>  \n- <a href='#scatter'>Scatter<\/a> \n- <a href='#box'>Box<\/a>  \n- <a href='#choropleth'>Choropleth<\/a>  "}}