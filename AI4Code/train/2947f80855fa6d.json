{"cell_type":{"b7cf4c13":"code","cbe89cc7":"code","3cfcee2f":"code","919aceb2":"code","00dd0645":"code","3ffe9b94":"code","d1ab178d":"code","fa3a4947":"markdown","852a0401":"markdown","72b12cce":"markdown","c83be31c":"markdown","5cbf05e5":"markdown"},"source":{"b7cf4c13":"import pandas as pd\n\n# Use only Q1 to Q26 features plus nerdy\nQ_cols = [f\"Q{i}\" for i in range(1, 27)]\ndata = pd.read_csv('..\/input\/predicting-nerdiness\/NPAS-data-16December2018\/data.csv',\n                        low_memory = True, usecols = [*Q_cols, \"nerdy\"])\ndata.head()","cbe89cc7":"# This relevant section is copied and pasted directly\n# from codebook.txt into this cell\n\n# Subjects choose a number that reflects whether they\n# agree or disagree with these statements.\n\nquestion_codebook = \"\"\"Q1\tI am interested in science.\n\nQ2\tI was in advanced classes.\n\nQ3\tI like to play RPGs. (Ex. D&D)\n\nQ4\tMy appearance is not as important as my intelligence.\n\nQ5\tI collect books.\n\nQ6\tI prefer academic success to social success.\n\nQ7\tI watch science related shows.\n\nQ8\tI spend recreational time researching topics others might find dry or overly rigorous.\n\nQ9\tI like science fiction.\n\nQ10\tI would rather read a book than go to a party.\n\nQ11\tI am more comfortable with my hobbies than I am with other people.\t\t\n\nQ12\tI spend more time at the library than any other public place.\n\nQ13\tI would describe my smarts as bookish.\n\nQ14\tI like to read technology news reports.\n\nQ15\tI have started writing a novel.\n\nQ16\tI gravitate towards introspection.\n\nQ17\tI am more comfortable interacting online than in person.\n\nQ18\tI love to read challenging material.\n\nQ19\tI have played a lot of video games.\n\nQ20\tI was a very odd child.\n\nQ21\tI sometimes prefer fictional people to real ones.\n\nQ22\tI enjoy learning more than I need to.\n\nQ23\tI get excited about my ideas and research.\n\nQ24\tI am a strange person.\n\nQ25\tI care about super heroes.\n\nQ26\tI can be socially awkward at times.\n\n\"\"\"\nquestion_dict = {}\nfor line in question_codebook.split('\\n'):\n    if not line: continue\n    try:\n        left, right = line.strip().split(\"\\t\")\n    except ValueError:\n        continue\n    question_dict[left] = right","3cfcee2f":"# Definition of question_dict is in above hidden cell\nquestion_dict","919aceb2":"# Split into X and y\nX, y = data.drop('nerdy', axis = 1), data['nerdy']\n\n# Rename X columns to their respective questions\nX = X.rename(columns = question_dict)\n\n# To simplify, we will make target variable binary:\n# Those who answer 5, 6, 7 (agree a little, agree moderately, agree strongly)\n# are put into one group; the rest in the other.\ny = (y > 4).astype(int)","00dd0645":"from sklearn.ensemble import GradientBoostingClassifier\nfrom sklearn.model_selection import cross_val_score\n\nmodel = GradientBoostingClassifier(n_estimators = 10_000, n_iter_no_change = 250,\n                                   validation_fraction = 0.3)\n\ncross_val_score(model, X, y)","3ffe9b94":"%%time\n\nmodel.fit(X, y)\n\nimport shap\n\nexplainer = shap.TreeExplainer(model)\nshap_values = explainer.shap_values(X)","d1ab178d":"shap.summary_plot(shap_values, X, max_display = 26)","fa3a4947":"# Visualization of Shapley values","852a0401":"# Closing\n\nThere you have it. I hope it has been fun and useful. Feel free to upvote and fork this notebook if you like!\n\nHappy data-sciencing!","72b12cce":"# Gradient Boosting Classifier\n\nLet's use a gradient boosting method out of the box from scikit-learn and judge its accuracy using cross-validation.\n\nIt turns out the classifier can do pretty well with around 80% accuracy.","c83be31c":"Based on the above plot of Shapley values, let's note down some interesting things.\n\nPreferring academic success over social success is the most impacting factor in considering if someone is a nerd. Surprisingly, writing a novel, too.\n\nAlmost all question statements are a \"nerd\" trait, i.e. if one agrees, one is more likely to agree that one is a nerd. Take note how the reds and blues shape different forms. For the sake of the following discussion, consider \"I am interested in science\". The red dots are clumped together on slightly to the right. In comparison, the blue dots are spread thinly across the left and right side of the plot. This happens almost on all of the question statements. This shows how disagreeing with the statement makes you not easily categorizable into a nerd (or not).","5cbf05e5":"# Introduction\n\nThis is a lightweight and for-fun notebook that attempts to explain: What is a \"nerd\"? Which traits are important to distinguish a nerd? How is it related?\n\nThis dataset is a survey result in which the subjects tell whether they agree or disagree with the given statements. Using those statements as a predictor, we will try to predict whether they are nerds. Afterwards, we use Shapley values to explain how our model does.\n\nEnjoy!"}}