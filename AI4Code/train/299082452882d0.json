{"cell_type":{"36ad0cc5":"code","7bc3b308":"code","7682cb0c":"code","3627778b":"code","e98e94b0":"code","c6df5412":"code","5dae69c1":"code","971ada1d":"code","3c47fb41":"code","c7dbd6c9":"code","3fa5d2b7":"code","df305cc3":"markdown","e6a94711":"markdown","55150144":"markdown"},"source":{"36ad0cc5":"import pandas as pd\n\ntrain = pd.read_csv(\"..\/input\/train.csv\")\ntest = pd.read_csv(\"..\/input\/test.csv\")\nprint(train.info())","7bc3b308":"print(test.info())","7682cb0c":"train[\"id\"] = [int(i.split(\"_\")[1]) for i in train.ID_code]\nlabel = train.target\ntrain.drop([\"target\", \"ID_code\"], axis=1, inplace=True)","3627778b":"import numpy as np\nfrom lightgbm import LGBMClassifier\nfrom sklearn.model_selection import cross_val_score","e98e94b0":"model  = LGBMClassifier(num_iterations=500, learning_rate=0.1)\ngbm = cross_val_score(model, train, label, scoring=\"roc_auc\", cv=5)\nprint([round(i, 4) for i in gbm])\nprint(np.mean(gbm), \"+\/-\", np.std(gbm))","c6df5412":"model  = LGBMClassifier(num_iterations=1000, learning_rate=0.05)\ngbm = cross_val_score(model, train, label, scoring=\"roc_auc\", cv=5)\nprint([round(i, 4) for i in gbm])\nprint(np.mean(gbm), \"+\/-\", np.std(gbm))","5dae69c1":"model  = LGBMClassifier(num_iterations=2000, learning_rate=0.01)\ngbm = cross_val_score(model, train, label, scoring=\"roc_auc\", cv=5)\nprint([round(i, 4) for i in gbm])\nprint(np.mean(gbm), \"+\/-\", np.std(gbm))","971ada1d":"model  = LGBMClassifier(num_iterations=2000, learning_rate=0.03)\ngbm = cross_val_score(model, train, label, scoring=\"roc_auc\", cv=5)\nprint([round(i, 4) for i in gbm])\nprint(np.mean(gbm), \"+\/-\", np.std(gbm))","3c47fb41":"model = LGBMClassifier(num_iterations=2000, learning_rate=0.03).fit(train, label)","c7dbd6c9":"ids = test.ID_code\ntest[\"id\"] = [int(i.split(\"_\")[1]) for i in test.ID_code]\ntest.drop([\"ID_code\"], axis=1, inplace=True)\nprobabilities = model.predict_proba(test)\n\nsubmission = pd.DataFrame({\n    \"ID_code\": ids,\n    \"target\": probabilities[:,1]\n})\nsubmission.to_csv(\"submission_lightgbm.csv\", index=False)","3fa5d2b7":"import pickle\n\npickle.dump(model, open(\"model_gbm.pickle\", \"wb\"))","df305cc3":"# Import the data","e6a94711":"# Save the model","55150144":"# Baseline Lightgbm"}}