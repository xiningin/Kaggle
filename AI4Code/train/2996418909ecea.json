{"cell_type":{"f0c1338c":"code","81c488f0":"code","2cce8749":"code","34ccc022":"code","46e5068b":"code","ba291cae":"code","625ce041":"code","1041ded0":"code","a0c277f6":"code","720d00ba":"code","c959e69b":"code","a440a61f":"code","9e8da6ce":"code","67142e4e":"code","6837c238":"code","0172c9dd":"code","dde2e272":"code","7e26b7bf":"code","e7dc55e0":"code","a066c86d":"code","a7a34620":"code","66b92625":"code","255cced6":"code","7c774c58":"code","3273c947":"code","a19093d1":"code","ad0f6ddd":"code","7f13bfbf":"code","085f9c35":"code","a48177c3":"code","dcb8549e":"code","c4e1bde2":"code","9409d4b3":"code","c14920cd":"code","6f84f9ac":"code","8d3fadc0":"code","a2cafa9f":"code","e96f2a66":"code","ba0d8dab":"code","eceabf07":"code","0f9f0e6b":"code","750f5838":"code","b74a9b48":"code","eebada25":"code","711bd119":"code","c7ce6ed1":"code","e337a4da":"code","3e00c7a0":"code","2d5ea456":"code","83d55344":"code","4f3d2711":"code","c197447f":"code","a7ff7e2c":"code","c27bab89":"code","372d576d":"code","e5da0d61":"code","1c352308":"code","666843ba":"code","f6b2fa15":"code","a306a305":"code","12e41c01":"code","f9c8446c":"code","ef64038c":"code","59843c90":"code","8682feba":"code","3f2df43d":"code","7af5ff1c":"code","2f976205":"code","a827ccef":"code","dd783b0d":"code","655cfb39":"code","bbe88aa1":"code","db9426bd":"code","ef7e21b8":"code","85ecb3b3":"code","ff1f142c":"code","506dcee2":"code","8716ea28":"markdown","debfc3dd":"markdown","78195dd3":"markdown","5cddd5f1":"markdown","e1853970":"markdown","cc55218c":"markdown","c169ecce":"markdown","7ff01c7c":"markdown","99f8c647":"markdown","cb101889":"markdown","734a5e0b":"markdown","a32d58b3":"markdown","69c317b8":"markdown","eada18e7":"markdown","4260121a":"markdown","19d36180":"markdown","b0a866f8":"markdown","a8a3c3ba":"markdown","9740164c":"markdown","bac5458b":"markdown"},"source":{"f0c1338c":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","81c488f0":"df = pd.read_csv(\"..\/input\/insurance\/insurance.csv\")","2cce8749":"df.head()","34ccc022":"df.describe()","46e5068b":"plt.figure(figsize=(12,6))\nsns.displot(data=df,x='charges',kde=True)","ba291cae":"df['region'].unique()","625ce041":"df.isna().sum()","1041ded0":"len(df)","a0c277f6":"from sklearn.preprocessing import LabelEncoder","720d00ba":"le = LabelEncoder()","c959e69b":"df['sex'] = le.fit_transform(df['sex'])","a440a61f":"df.head()","9e8da6ce":"df['smoker'] = le.fit_transform(df['smoker'])","67142e4e":"df.head()","6837c238":"df['region'] = le.fit_transform(df['region'])","0172c9dd":"df.head()","dde2e272":"df.head()","7e26b7bf":"df.info()","e7dc55e0":"df.corr()['charges'].sort_values()[:-1]","a066c86d":"plt.figure(figsize=(12,6))\nsns.heatmap(data=df.corr(),annot=True,cmap='plasma')","a7a34620":"X = df.drop('charges',axis=1)\ny = df['charges']","66b92625":"from sklearn.model_selection import train_test_split","255cced6":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42)","7c774c58":"from sklearn.preprocessing import StandardScaler","3273c947":"sc = StandardScaler()","a19093d1":"X_train = sc.fit_transform(X_train)\nX_test = sc.transform(X_test)","ad0f6ddd":"X_train","7f13bfbf":"from sklearn.linear_model import LinearRegression","085f9c35":"lr = LinearRegression(fit_intercept=True)","a48177c3":"lr.fit(X_train,y_train)","dcb8549e":"X_train.shape","c4e1bde2":"X_test.shape","9409d4b3":"lr_pred = lr.predict(X_test)","c14920cd":"from sklearn.metrics import mean_squared_error,mean_absolute_error, r2_score","6f84f9ac":"(mean_squared_error(y_test,lr_pred))**0.5","8d3fadc0":"from catboost import CatBoostRegressor","a2cafa9f":"cb = CatBoostRegressor(random_state=42)","e96f2a66":"cb.fit(X_train,y_train,use_best_model=True,eval_set=(X_test,y_test),early_stopping_rounds=30)","ba0d8dab":"cb_pred = cb.predict(X_test)","eceabf07":"(mean_squared_error(y_test,cb_pred))**0.5","0f9f0e6b":"r2_score(y_test,cb_pred)","750f5838":"from sklearn.neighbors import KNeighborsRegressor","b74a9b48":"knn = KNeighborsRegressor(n_neighbors=5)","eebada25":"knn.fit(X_train,y_train)","711bd119":"knn_pred = knn.predict(X_test)","c7ce6ed1":"(mean_squared_error(y_test,knn_pred))**0.5","e337a4da":"from sklearn.svm import SVR","3e00c7a0":"svr = SVR()","2d5ea456":"svr.fit(X_train,y_train)","83d55344":"svr_pred = svr.predict(X_test)","4f3d2711":"(mean_squared_error(y_test,svr_pred))**0.5","c197447f":"from sklearn.ensemble import RandomForestRegressor","a7ff7e2c":"rf = RandomForestRegressor(random_state=42,n_estimators=100)","c27bab89":"rf.fit(X_train,y_train)","372d576d":"rf_pred = rf.predict(X_test)","e5da0d61":"(mean_squared_error(y_test,rf_pred))**0.5","1c352308":"df2 = pd.read_csv(\"..\/input\/insurance\/insurance.csv\")","666843ba":"df2.head()","f6b2fa15":"from sklearn.compose import ColumnTransformer\nfrom sklearn.preprocessing import OneHotEncoder","a306a305":"ct = ColumnTransformer(transformers = [('encoder',OneHotEncoder() , [1,3,4,5])],remainder='passthrough')","12e41c01":"X2 = df.drop('charges',axis=1)\ny2 = df['charges']\nX_train_2, X_test_2, y_train_2, y_test_2 = train_test_split(X2, y2, test_size=0.3, random_state=42)","f9c8446c":"X_train_2 = np.array(ct.fit_transform(X_train_2))\nX_test_2 = np.array(ct.transform(X_test_2))","ef64038c":"X_train_2 = sc.fit_transform(X_train_2)\nX_test_2 = sc.transform(X_test_2)","59843c90":"X_train_2","8682feba":"X_train_2.shape","3f2df43d":"X_test_2.shape","7af5ff1c":"lr2 = LinearRegression()","2f976205":"lr2.fit(X_train_2,y_train_2)","a827ccef":"lr2_pred = lr2.predict(X_test_2)","dd783b0d":"(mean_squared_error(y_test_2,lr2_pred))**0.5","655cfb39":"cb2 = CatBoostRegressor(random_state=42)","bbe88aa1":"cb2.fit(X_train_2,y_train_2,use_best_model=True,eval_set=(X_test_2,y_test_2),early_stopping_rounds=30,plot=True)","db9426bd":"cb2_pred = cb2.predict(X_test_2)","ef7e21b8":"(mean_squared_error(y_test_2,cb2_pred))**0.5","85ecb3b3":"df.describe()","ff1f142c":"from sklearn.metrics import r2_score","506dcee2":"r2_score(y_test_2,cb2_pred)","8716ea28":"# Region: Southwest=3   ; Northwest=1   ; Southeast=2   ; Northeast=0","debfc3dd":"# 5) Random Forest","78195dd3":"# SVR worst","5cddd5f1":"# LET'S TRY LABEL ENCODING FIRST THEN WE CAN DO ONE-HOT-ENCODING","e1853970":"# Relatively better than LR","cc55218c":"# BEST PRACTICE FOR THIS CASE WOULD BE TO USE CB WITH LABEL ENCODING","c169ecce":"# 1) Linear Regression","7ff01c7c":"# female = 0\n# male = 1","99f8c647":"# Bad Results with LR","cb101889":"# 2) CatBoost Regression","734a5e0b":"# smoker:\n# Yes = 1\n# No = 0","a32d58b3":"# 4) SVR","69c317b8":"# RF 2nd best after CB","eada18e7":"# NOW LET'S TRY IMPLEMENTING ONE-HOT ENCODING","4260121a":"# 1) LINEAR REGRESSION","19d36180":"# 2) CatBoost Regression","b0a866f8":"# 3) KNN Regression","a8a3c3ba":"# KNN better than LR but worse than CB","9740164c":"# ONE HOT ENCODING MADE THE MODEL A BIT MORE WORSE","bac5458b":"# So the best method was CatBoost Regression"}}