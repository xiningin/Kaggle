{"cell_type":{"f3c83e98":"code","81df5cb5":"code","7291598d":"code","3a189c0a":"code","c1fbaeff":"code","cb823052":"code","51322bf2":"code","492116b2":"code","30ba951a":"code","5f65847c":"code","f18901f8":"code","ee62034b":"code","ef7150b2":"code","744a7b0f":"code","e71ef7ae":"code","5e74097b":"code","baea8449":"code","f3ee972d":"code","f9b6e81c":"code","e9b99b39":"code","b87c4ab4":"code","9919cafc":"code","0c5a375c":"code","d8c0ee6e":"code","fd550620":"code","47fd0d8c":"code","63c7d586":"code","edcb7a50":"code","9857f244":"code","fa73c423":"code","ee7859fe":"code","9b983031":"code","155e143f":"code","35dcbb9a":"code","746c6a72":"code","9fb245f5":"code","b3e64c6a":"code","d313db7b":"code","42d1177b":"code","59a81b0c":"code","6aae7607":"code","cde91356":"code","c1a9b91f":"code","73dd1470":"code","bf6f907a":"code","478f3c86":"code","c628ad79":"code","2c5ee29e":"code","c62cc1b0":"code","6af502e7":"code","88607455":"code","5137e255":"code","d162dbd4":"code","0fa63945":"code","3405da4e":"code","0a0191c4":"code","1f5943f2":"code","b68629bc":"code","a80f82fe":"code","b75e3d5d":"code","b43006b7":"code","44281175":"code","c92b8862":"markdown","d72eec58":"markdown","4955a20d":"markdown","275a6068":"markdown","7c3ebe95":"markdown","ed352b81":"markdown","32cbea21":"markdown","d8babed7":"markdown","e5053e53":"markdown","5c5c777e":"markdown","2fec3fb5":"markdown","4ff6882e":"markdown","e75a71d1":"markdown","c5f1d041":"markdown","08180f6f":"markdown","03045759":"markdown","03e73c5c":"markdown","f51443ae":"markdown","f7f46312":"markdown","a7885d66":"markdown","79e415e8":"markdown","6dc5b328":"markdown","0611eb75":"markdown","186478cd":"markdown","dd0416d1":"markdown","3f2b4935":"markdown","1120d6a7":"markdown","b48143b5":"markdown","2e030932":"markdown","38e56323":"markdown","1e1c276f":"markdown","a04db8d7":"markdown","ce43088e":"markdown","cf88d3a6":"markdown","f89e7d1d":"markdown","11a83c95":"markdown","16606242":"markdown","15c2052a":"markdown","353b8474":"markdown","c22643d8":"markdown","722d6a29":"markdown","106a3cf2":"markdown","2e2b0e21":"markdown","e12e2e3e":"markdown","facb90e6":"markdown","37add0f4":"markdown","3625097b":"markdown","4377944d":"markdown","9a322a14":"markdown","45f5af44":"markdown","15a9889d":"markdown","a9392c30":"markdown","92a08e6f":"markdown","5225de0a":"markdown","392cf2b1":"markdown","c205f6fb":"markdown","b3dc6a17":"markdown","d231cc1f":"markdown","7e3bc38f":"markdown","0c03522b":"markdown","773d6773":"markdown","9df3c667":"markdown","4bfd17e1":"markdown","835e1dea":"markdown","bc1d5fb4":"markdown","c563320f":"markdown","06bbcb0b":"markdown","2f907552":"markdown","d065ccc6":"markdown","c84dfa8b":"markdown","d04ccc65":"markdown","133efd2c":"markdown","25a5bc77":"markdown","51001e15":"markdown","1c982210":"markdown","50216cf7":"markdown","b4c7937f":"markdown","8a397142":"markdown","fa4fb29c":"markdown","a6d8d57b":"markdown","d0521020":"markdown","daaef209":"markdown"},"source":{"f3c83e98":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport plotly.express as px\n%matplotlib inline\n\n# Make Plotly work in your Jupyter Notebook\nfrom plotly.offline import download_plotlyjs, init_notebook_mode, plot, iplot \ninit_notebook_mode(connected = True)\n\nimport cufflinks as cf\n\n# Use Plotly locally\ncf.go_offline()","81df5cb5":"df = pd.read_csv(\"\/kaggle\/input\/clothessizeprediction\/final_test.csv\")\ndf.head()","7291598d":"df.info()","3a189c0a":"df.describe().T","c1fbaeff":"age_unique = df[\"age\"].unique()\nprint(\"Unique values in age column:\\n\", age_unique)","cb823052":"fig = px.box(df, x = \"size\", y = \"age\", color = \"size\")\n\nfig.update_layout(\n    plot_bgcolor = \"#ECECEC\",\n    autosize = True,\n    xaxis = dict(\n        title_text = \"Size\",\n        titlefont = dict(size = 12)\n    ),\n    yaxis = dict(\n        title_text = \"Age\",\n        titlefont = dict(size = 12)\n    ),\n    title = \"<b>Outlier detection in case of age vs size<\/b>\",\n    title_font_size = 16,\n    title_font_color = \"black\",\n    title_pad_t = 5,\n    title_pad_l = 20\n)\n\n\nfig.update_yaxes(showticklabels = True, showline = True, linewidth = 2, linecolor = \"black\")\nfig.update_xaxes(showticklabels = True, showline = True, linewidth = 2, linecolor = \"black\")\n\n\nfig.show()","51322bf2":"index_age = df[(df['age'] >= 80)|(df['age'] <= 10)].index\ndf.drop(index_age, inplace=True)\ndf['age'].describe()","492116b2":"fig = px.box(df, x = \"size\", y = \"age\", color = \"size\")\n\nfig.update_layout(\n    plot_bgcolor = \"#ECECEC\",\n    autosize = True,\n    xaxis = dict(\n        title_text = \"Size\",\n        titlefont = dict(size = 12)\n    ),\n    yaxis = dict(\n        title_text = \"Age\",\n        titlefont = dict(size = 12)\n    ),\n    title = \"<b>Plot after removal of outlier<\/b>\",\n    title_font_size = 16,\n    title_font_color = \"black\",\n    title_pad_t = 5,\n    title_pad_l = 20\n)\n\n\nfig.update_yaxes(showticklabels = True, showline = True, linewidth = 2, linecolor = \"black\")\nfig.update_xaxes(showticklabels = True, showline = True, linewidth = 2, linecolor = \"black\")\n\n\nfig.show()","30ba951a":"age_nan = df[df[\"age\"].isna()]\nage_nan","5f65847c":"age_mean = df.groupby(\"size\")[\"age\"].mean().round()\nage_mean","f18901f8":"def missing_age(df, size, mean_age):\n    \n    \"\"\"\n    Select the value of age column corresponding to the size and nan value. \n    Return the average value according to size.\n    \"\"\"\n    \n    df.loc[(df[\"size\"] == size) & (df[\"age\"].isnull()), \"age\"] = mean_age\n    \n    return df","ee62034b":"missing_age(df, \"L\", 34)\nmissing_age(df, \"M\", 33)\nmissing_age(df, \"S\", 33)\nmissing_age(df, \"XL\", 35)\nmissing_age(df, \"XXL\", 36)\nmissing_age(df, \"XXS\", 32)\nmissing_age(df, \"XXXL\", 36)","ef7150b2":"fig = px.histogram(df, x = \"age\",\n                  color_discrete_sequence = [\"#ff1c49\"] * len(df))\n\nfig.update_layout(\n    plot_bgcolor = \"#ECECEC\",\n    autosize = True,\n    xaxis = dict(\n        title_text = \"Age\",\n        titlefont = dict(size = 12)\n    ),\n    yaxis = dict(\n        title_text = \"Age Count\",\n        titlefont = dict(size = 12)\n    ),\n    title = \"<b>Distribution of age <\/b>\",\n    title_font_size = 16,\n    title_font_color = \"black\",\n    title_pad_t = 5,\n    title_pad_l = 20\n)\n\n\nfig.update_yaxes(showticklabels = True, showline = True, linewidth = 2, linecolor = \"black\")\nfig.update_xaxes(showticklabels = True, showline = True, linewidth = 2, linecolor = \"black\")\n\n\nfig.show()","744a7b0f":"height_unique = df[\"height\"].unique()\nheight_unique","e71ef7ae":"fig = px.box(df, x = \"size\", y = \"height\", color = \"size\")\n\nfig.update_layout(\n    plot_bgcolor = \"#ECECEC\",\n    autosize = True,\n    xaxis = dict(\n        title_text = \"Size\",\n        titlefont = dict(size = 12)\n    ),\n    yaxis = dict(\n        title_text = \"Height\",\n        titlefont = dict(size = 12)\n    ),\n    title = \"<b>Outlier detection in case of height vs size<\/b>\",\n    title_font_size = 16,\n    title_font_color = \"black\",\n    title_pad_t = 5,\n    title_pad_l = 20\n)\n\n\nfig.update_yaxes(showticklabels = True, showline = True, linewidth = 2, linecolor = \"black\")\nfig.update_xaxes(showticklabels = True, showline = True, linewidth = 2, linecolor = \"black\")\n\n\nfig.show()","5e74097b":"height_index = df[(df['height'] >= 180)|(df['height'] <= 144)].index\ndf.drop(height_index, inplace=True)\ndf['height'].describe()","baea8449":"fig = px.box(df, x = \"size\", y = \"height\", color = \"size\")\n\nfig.update_layout(\n    plot_bgcolor = \"#ECECEC\",\n    autosize = True,\n    xaxis = dict(\n        title_text = \"Size\",\n        titlefont = dict(size = 12)\n    ),\n    yaxis = dict(\n        title_text = \"Height\",\n        titlefont = dict(size = 12)\n    ),\n    title = \"<b>Plot after removal of outlier<\/b>\",\n    title_font_size = 16,\n    title_font_color = \"black\",\n    title_pad_t = 5,\n    title_pad_l = 20\n)\n\n\nfig.update_yaxes(showticklabels = True, showline = True, linewidth = 2, linecolor = \"black\")\nfig.update_xaxes(showticklabels = True, showline = True, linewidth = 2, linecolor = \"black\")\n\n\n\n\nfig.show()","f3ee972d":"height_missing = df[df[\"height\"].isna()]\nheight_missing","f9b6e81c":"height_mean = df.groupby(\"size\")[\"height\"].mean()\nheight_mean","e9b99b39":"def missing_height(df, size, mean_height):\n    \n    \"\"\"\n    Selcting the rows according to size and null values in height column.\n    Return the average value accoring to size.\n    \"\"\"\n    \n    df.loc[(df[\"size\"] == size) & (df[\"height\"].isnull()), \"height\"] = mean_height\n    \n    return df","b87c4ab4":"missing_height(df, \"L\", 166.51)\nmissing_height(df, \"M\", 165.28)\nmissing_height(df, \"S\", 163.66)\nmissing_height(df, \"XL\", 167.10)\nmissing_height(df, \"XXL\", 159.04)\nmissing_height(df, \"XXS\", 161.29)\nmissing_height(df, \"XXXL\", 167.01)","9919cafc":"fig = px.histogram(df, x = \"height\",\n                  color_discrete_sequence = [\"#d21cff\"] * len(df))\n\n\nfig.update_layout(\n    plot_bgcolor = \"#ECECEC\",\n    autosize = True,\n    xaxis = dict(\n        title_text = \"Height\",\n        titlefont = dict(size = 12)\n    ),\n    yaxis = dict(\n        title_text = \"Height Count\",\n        titlefont = dict(size = 12)\n    ),\n    title = \"<b>Distribution of height <\/b>\",\n    title_font_size = 16,\n    title_font_color = \"black\",\n    title_pad_t = 5,\n    title_pad_l = 20\n)\n\n\nfig.update_yaxes(showticklabels = True, showline = True, linewidth = 2, linecolor = \"black\")\nfig.update_xaxes(showticklabels = True, showline = True, linewidth = 2, linecolor = \"black\")\n\n\n\nfig.show()","0c5a375c":"weight_unique = df[\"weight\"].unique()\nweight_unique","d8c0ee6e":"fig = px.box(df, x = \"size\", y = \"weight\", color = \"size\")\n\nfig.update_layout(\n    plot_bgcolor = \"#ECECEC\",\n    autosize = True,\n    xaxis = dict(\n        title_text = \"Size\",\n        titlefont = dict(size = 12)\n    ),\n    yaxis = dict(\n        title_text = \"Weight\",\n        titlefont = dict(size = 12)\n    ),\n    title = \"<b>Outlier detection in case of weight vs size<\/b>\",\n    title_font_size = 16,\n    title_font_color = \"black\",\n    title_pad_t = 5,\n    title_pad_l = 20\n)\n\n\nfig.update_yaxes(showticklabels = True, showline = True, linewidth = 2, linecolor = \"black\")\nfig.update_xaxes(showticklabels = True, showline = True, linewidth = 2, linecolor = \"black\")\n\n\n\nfig.show()","fd550620":"weight_index = df[(df['weight'] >= 90)|(df['weight'] <= 40)].index\ndf.drop(weight_index, inplace=True)\ndf['weight'].describe()","47fd0d8c":"fig = px.box(df, x = \"size\", y = \"weight\", color = \"size\")\n\nfig.update_layout(\n    plot_bgcolor = \"#ECECEC\",\n    autosize = True,\n    xaxis = dict(\n        title_text = \"Size\",\n        titlefont = dict(size = 12)\n    ),\n    yaxis = dict(\n        title_text = \"Weight\",\n        titlefont = dict(size = 12)\n    ),\n    title = \"<b>Plot after removal of outlier<\/b>\",\n    title_font_size = 16,\n    title_font_color = \"black\",\n    title_pad_t = 5,\n    title_pad_l = 20\n)\n\n\nfig.update_yaxes(showticklabels = True, showline = True, linewidth = 2, linecolor = \"black\")\nfig.update_xaxes(showticklabels = True, showline = True, linewidth = 2, linecolor = \"black\")\n\n\nfig.show()","63c7d586":"fig = px.histogram(df, x = \"weight\", color_discrete_sequence = [\"#ffd735\"] * len(df))\n\n\nfig.update_layout(\n    plot_bgcolor = \"#ECECEC\",\n    autosize = True,\n    xaxis = dict(\n        title_text = \"Weight\",\n        titlefont = dict(size = 12)\n    ),\n    yaxis = dict(\n        title_text = \"Weight Count\",\n        titlefont = dict(size = 12)\n    ),\n    title = \"<b>Distribution of weight <\/b>\",\n    title_font_size = 16,\n    title_font_color = \"black\",\n    title_pad_t = 5,\n    title_pad_l = 20\n)\n\n\nfig.update_yaxes(showticklabels = True, showline = True, linewidth = 2, linecolor = \"black\")\nfig.update_xaxes(showticklabels = True, showline = True, linewidth = 2, linecolor = \"black\")\n\nfig.show()","edcb7a50":"df.info()","9857f244":"df.describe().T","fa73c423":"fig = px.histogram(df, x= \"height\", y = \"weight\", color = \"size\")\n\nfig.update_layout(\n    plot_bgcolor = \"#ECECEC\",\n    autosize = True,\n    xaxis = dict(\n        title_text = \"Height(cm)\",\n        titlefont = dict(size = 12)\n    ),\n    yaxis = dict(\n        title_text = \"Weight(kg)\",\n        titlefont = dict(size = 12)\n    ),\n    title = \"<b>Variation of size with height and weight<\/b>\",\n    title_font_size = 16,\n    title_font_color = \"black\",\n    title_pad_t = 5,\n    title_pad_l = 20\n)\n\n\nfig.update_yaxes(showticklabels = True, showline = True, linewidth = 2, linecolor = \"black\")\nfig.update_xaxes(showticklabels = True, showline = True, linewidth = 2, linecolor = \"black\")\n\nfig.show()","ee7859fe":"fig = px.histogram(df, x = \"size\", color = \"size\")\n\nfig.update_layout(\n    plot_bgcolor = \"#ECECEC\",\n    autosize = True,\n    xaxis = dict(\n        title_text = \"Size\",\n        titlefont = dict(size = 12)\n    ),\n    yaxis = dict(\n        title_text = \"Count\",\n        titlefont = dict(size = 12)\n    ),\n    title = \"<b>Most popular size<\/b>\",\n    title_font_size = 16,\n    title_font_color = \"black\",\n    title_pad_t = 5,\n    title_pad_l = 20\n)\n\n\nfig.update_yaxes(showticklabels = True, showline = True, linewidth = 2, linecolor = \"black\")\nfig.update_xaxes(showticklabels = True, showline = True, linewidth = 2, linecolor = \"black\")\n\n\nfig.show()","9b983031":"fig = px.scatter_matrix(df, dimensions=[\"age\", \"weight\", \"height\"], color=\"size\",\n                       labels = {\n                           \"age\": \"Age\",\n                           \"weight\":\"Weight\",\n                           \"height\":\"Height\"\n                       })\n\nfig.update_layout(\n    plot_bgcolor = \"#ECECEC\",\n    autosize = True,\n    title = \"<b>Scatter Matrix showing relation between the features<\/b>\",\n    title_font_size = 16,\n    title_font_color = \"black\",\n    title_pad_t = 5,\n    title_pad_l = 20\n)\n\n\nfig.show()","155e143f":"import plotly.figure_factory as ff\ncorr = df.corr()\n\nfig = ff.create_annotated_heatmap(z=corr.to_numpy(), \n                                  x=corr.columns.tolist(),\n                                  y=corr.columns.tolist(),\n                                  colorscale=px.colors.sequential.Purp,\n                                  hoverinfo=\"none\", #Shows hoverinfo for null values\n                                  showscale=True, ygap=1, xgap=1\n                                 )\n\nfig.update_xaxes(side=\"bottom\")\n\nfig.update_layout(\n    title_text='<b>Heatmap<\/b>', \n    title_x=0.5, \n    xaxis_showgrid=False,\n    yaxis_showgrid=False,\n    yaxis_autorange='reversed',\n    template='plotly_white'\n)\n\nfig.show()","35dcbb9a":"from sklearn.preprocessing import LabelEncoder\nlabelencoder = LabelEncoder()\ndf[\"size_num\"] = labelencoder.fit_transform(df[\"size\"])","746c6a72":"from sklearn.preprocessing import OneHotEncoder\n\nenc = OneHotEncoder(handle_unknown='ignore')\n\ndf_enc = pd.DataFrame(enc.fit_transform(df[['size']]).toarray())\n\ndf_enc.columns = enc.get_feature_names(['size'])\nprint(df_enc.columns)\ndf_enc.head()","9fb245f5":"data = df.values\n\nX = data[:, :-2]\n\ny_label = data[:, -1]\ny_ohe = df_enc.values","b3e64c6a":"X = X.astype(\"int\")\nX.dtype","d313db7b":"y_label = y_label.astype(\"int\")\ny_label.dtype","42d1177b":"y_ohe = y_ohe.astype(\"int\")\ny_ohe.dtype","59a81b0c":"from sklearn.model_selection import train_test_split\n\n# Split \nX_train, X_test, y_train, y_test = train_test_split(X,y_label,test_size=0.2)\nX_train_ohe, X_test_ohe, y_train_ohe, y_test_ohe = train_test_split(X,y_ohe,test_size=0.2)\n","6aae7607":"print(f'''The shape of label encoded : \ntrain data is:{X_train.shape}, {y_train.shape} \ntest data is: {X_test.shape}, {y_test.shape}.''')","cde91356":"print(f'''The shape of OneHotEncoded:\ntrain data is: {X_train_ohe.shape}, {y_train_ohe.shape}\ntest data is: {X_test_ohe.shape}, {y_test_ohe.shape}.''')","c1a9b91f":"import xgboost as xgb\nfrom sklearn.metrics import accuracy_score\n\npars_l = {\n        'colsample_bytree': 0.8,                 \n        'learning_rate': 0.08,\n        'max_depth': 10,\n        'subsample': 1,\n        'objective':'multi:softprob',\n        'num_class':7,\n        'eval_metric':'mlogloss',\n        'min_child_weight':3,\n        'gamma':0.25,\n        'n_estimators':5\n    }\n\n\n# create XGBoost instance with default hyper-parameters\nxgb_estimator = xgb.XGBClassifier(pars = pars_l)\n\n# fit the model\nxgb_estimator.fit(X_train, y_train)","73dd1470":"# evaluate on test data\ny_pred = xgb_estimator.predict(X_test)\nprint('Accuracy on test data: {:.1f}%'.format(accuracy_score(y_test, y_pred)*100))","bf6f907a":"# The histogram of scores compared to true labels\nfig = px.histogram(\n    x=y_pred, color=y_test, \n    labels=dict(color='True Labels', x='Predicted Label')\n)\n\n\nfig.update_layout(\n    plot_bgcolor = \"#ECECEC\",\n    autosize = True,\n    xaxis = dict(\n        title_text = \"Predicted Labels\",\n        titlefont = dict(size = 12)\n    ),\n    yaxis = dict(\n        title_text = \"Count\",\n        titlefont = dict(size = 12)\n    ),\n    title = \"<b>Comaprison of accuracy using Label Encoded Values<\/b>\",\n    title_font_size = 16,\n    title_font_color = \"black\",\n    title_pad_t = 5,\n    title_pad_l = 20\n)\n\n\nfig.update_yaxes(showticklabels = True, showline = True, linewidth = 2, linecolor = \"black\")\nfig.update_xaxes(showticklabels = True, showline = True, linewidth = 2, linecolor = \"black\")\n\n\nfig.show()","478f3c86":"import xgboost as xgb\nfrom sklearn.multioutput import MultiOutputClassifier\nfrom sklearn.metrics import accuracy_score\n\npars_ohe = {\n        'colsample_bytree': 0.8,                 \n        'learning_rate': 0.08,\n        'max_depth': 10,\n        'subsample': 1,\n        'objective':'binary:logistic',\n        'num_class':7,\n        'eval_metric':'mlogloss',\n        'min_child_weight':3,\n        'gamma':0.25,\n        'n_estimators':5\n    }\n\n\n# create XGBoost instance with default hyper-parameters\nxgb_estimator = xgb.XGBClassifier(pars = pars_ohe)\n\n# create MultiOutputClassifier instance with XGBoost model inside\nmultilabel_model = MultiOutputClassifier(xgb_estimator)\n\n# fit the model\nmultilabel_model.fit(X_train_ohe, y_train_ohe)","c628ad79":"# evaluate on test data\ny_pred_ohe = multilabel_model.predict(X_test_ohe)\nprint('Accuracy on test data: {:.1f}%'.format(accuracy_score(y_test_ohe,y_pred_ohe)*100))","2c5ee29e":"df_out = pd.read_csv(\"\/kaggle\/input\/clothessizeprediction\/final_test.csv\")","c62cc1b0":"df_null = df_out.groupby(\"size\").mean().round()\ndf_null","6af502e7":"def missing_value(df, size,value, mean_value):\n    \n    \"\"\"\n    Selcting the rows according to size and null values in height column.\n    Return the average value accoring to size.\n    \"\"\"\n    \n    df.loc[(df[\"size\"] == size) & (df[value].isnull()), value] = mean_value\n    \n    return df","88607455":"missing_value(df_out, \"XXS\", \"age\", 32.0)\nmissing_value(df_out, \"S\", \"age\", 33.0)\nmissing_value(df_out, \"M\", \"age\", 33.0)\nmissing_value(df_out, \"L\", \"age\", 34.0)\nmissing_value(df_out, \"XL\", \"age\", 35.0)\nmissing_value(df_out, \"XXL\", \"age\", 36.0)\nmissing_value(df_out, \"XXXL\", \"age\", 36.0)\n\nmissing_value(df_out, \"XXS\", \"height\", 161.0)\nmissing_value(df_out, \"S\", \"height\", 164.0)\nmissing_value(df_out, \"M\", \"height\", 165.0)\nmissing_value(df_out, \"L\", \"height\", 167.0)\nmissing_value(df_out, \"XL\", \"height\", 168.0)\nmissing_value(df_out, \"XXL\", \"height\", 160.0)\nmissing_value(df_out, \"XXXL\", \"height\", 168.0)","5137e255":"df_out.info()","d162dbd4":"from sklearn.preprocessing import LabelEncoder\nlabelencoder = LabelEncoder()\ndf_out[\"size_num\"] = labelencoder.fit_transform(df_out[\"size\"])","0fa63945":"df_out.head()","3405da4e":"df_out_value = df_out.values\nX, y = df_out_value[:, :-2], df_out_value[:, -1]","0a0191c4":"X = X.astype(\"int\")\ny = y.astype(\"int\")","1f5943f2":"from sklearn.model_selection import train_test_split\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = .2, random_state=1)","b68629bc":"X_train.shape, y_train.shape","a80f82fe":"from sklearn.ensemble import IsolationForest\n\n# identify outliers in the training dataset\niso = IsolationForest(contamination=0.1)\nyhat = iso.fit_predict(X_train)\n\n# select all rows that are not outliers\nmask = yhat != -1\nX_train, y_train = X_train[mask, :], y_train[mask]\n\n# summarize the shape of the updated training dataset\nprint(X_train.shape, y_train.shape)","b75e3d5d":"from sklearn.metrics import mean_absolute_error\nimport xgboost as xgb\n\npars_l = { 'colsample_bytree': 0.8,\n           'learning_rate': 0.08, \n           'max_depth': 10, \n           'subsample': 1, \n           'objective':'multi:softprob', \n           'num_class':7, \n           'eval_metric':'mlogloss', \n           'min_child_weight':3, \n           'gamma':0.25, \n           'n_estimators':5 }\n\n# create XGBoost instance with default hyper-parameters\nxgb_estimator = xgb.XGBClassifier()\n\n# fit the model\nxgb_estimator.fit(X_train, y_train)","b43006b7":"# evaluate on test data\nfrom sklearn.metrics import accuracy_score\n\n# evaluate the model\ny_pred = xgb_estimator.predict(X_test)\nprint('Accuracy on test data: {:.1f}%'.format(accuracy_score(y_test, y_pred)*100))","44281175":"# The histogram of scores compared to true labels\nfig = px.histogram(\n    x=y_pred, color=y_test, \n    labels=dict(color='True Labels', x='Predicted Label')\n)\n\n\nfig.update_layout(\n    plot_bgcolor = \"#ECECEC\",\n    autosize = True,\n    xaxis = dict(\n        title_text = \"Predicted Labels\",\n        titlefont = dict(size = 12)\n    ),\n    yaxis = dict(\n        title_text = \"Count\",\n        titlefont = dict(size = 12)\n    ),\n    title = \"<b>Comaprison of accuracy using Isolation Forest<\/b>\",\n    title_font_size = 16,\n    title_font_color = \"black\",\n    title_pad_t = 5,\n    title_pad_l = 20\n)\n\n\nfig.update_yaxes(showticklabels = True, showline = True, linewidth = 2, linecolor = \"black\")\nfig.update_xaxes(showticklabels = True, showline = True, linewidth = 2, linecolor = \"black\")\n\n\nfig.show()","c92b8862":"## Analyzing missing values","d72eec58":"# Weight","4955a20d":"From above it is clear that XXXL has distribution which is different from other sizes for the weight. Let us take 40kg as minimum and 90kg as maximum value for the outliers.","275a6068":"From above heat map we can see their is hardly any correlation between the features.","7c3ebe95":"## Calculating the mean","ed352b81":"## Label Encode data","32cbea21":"From above we can see that the Medium size is the most popular.","d8babed7":"# About data\n1. Age: in years\n2. Weight: in kg\n3. Height: in cm","e5053e53":"A spike is present at the height of 162 cm. Also some count for height is very low.","5c5c777e":"### Convert data into array","2fec3fb5":"Let us see if there is any null value in the age column after removing outlier rows.","4ff6882e":"From the table we can see some values for min and max range of age, weight which could be considered as outliers depending on other parameters.","e75a71d1":"## For label encoded values","c5f1d041":"# XGBOOST","08180f6f":"## Replacing missing values with the mean","03045759":"## Displaying the unique values","03e73c5c":"# Histogram showing the variation of size with height and weight","f51443ae":"As there is no nan value in this column let us now see the distribution of weight.","f7f46312":"In above figure we can see outliers correctly thus I am using trimming method to eliminate the outliers. While using this method it is kept in mind that not too much data is removed.","a7885d66":"Clearly for our dataset label encoder works better than one hot encoder.","79e415e8":"### Check the shape","6dc5b328":"## Plotting to see result of trimming","0611eb75":"## Weight distribution","186478cd":"## Plotting to see height distribution\nAfter removing outliers and replacing nan values let us see the height distribution.","dd0416d1":"## Displaying unique values","3f2b4935":"## Calculating the mean","1120d6a7":"## Read the data from the file","b48143b5":"## Plotting to see result of trimming","2e030932":"## Data","38e56323":"## Check the dataframe again","1e1c276f":"The above plot shows that the 29-30 years is the maximum age and the plot is skewed towards the right.","a04db8d7":"# Sizes\nLet us see the most common size purchsed by users.","ce43088e":"There is a slight improvement in accuracy. But we can say model is not providing us with good accuracy.","cf88d3a6":"## Plotting the weight to see outliers","f89e7d1d":"# Checking Again","11a83c95":"# Heat map","16606242":"The above model shows us that it is not efficient and much has to be done to improve its efficiency such as hyperparameter tuning etc.\nIf you find the work good please upvote","15c2052a":"We will take both type of encoded colum and see how our model behave to each of them.","353b8474":"## Read the data","c22643d8":"Let us create the function to replace the nan value. In the function three parameters are passed namely dataframe, size and mean age value. ","722d6a29":"Histogram showing height, weight and size of clothing required. From this we can indeed see the curve for each size.","106a3cf2":"## Replacing missing values with the mean","2e2b0e21":"As we can see that null values are present thus they need to be handled properly. In order to achieve this I will replace the null value according to the size of the clothes. That is the average value of size \"L\" will replace the nan presesent in age column corresponding to the \"L\" size.","e12e2e3e":"# Label Prediction\n## Encoding the label","facb90e6":"### Convert the data into array","37add0f4":"137.16 is the minimum value while 193.04 is the maximum value. nan is also present in the column. Let us see the distribution of height according to the clothing size.","3625097b":"## IsolationForest Outlier detection","4377944d":"After vizualizing the above plot we see that outliers lies below 144 cm and above 180 cm. Let us remove these outiers to make our data more clean.","9a322a14":"## Describe the statistics of the column.\nThe describe function help us to see the integer\/float value column statistics. By adding the keyword 'all' we can see the statistics of object column also. ","45f5af44":"## See the information about the dtypes\nDtypes tell us what is the data column like. It also help us to determine if the column has correct dtype or not.","15a9889d":"After removing the outliers and replacing the nan value with mean value let us see the distribution of age.","a9392c30":"## Plotting to see result of trimming","92a08e6f":"From the data frame df_enc we can see column is formed for each size.","5225de0a":"Seeing from the above plot it is clear that most of the outliers are less than 10 or greater than 80.\nAssuming that people above 80 and below 10 years of age are not going for too much online shopping I removed those rows which has value in specified range.","392cf2b1":"# Scatter matrix to see the relation between features and labels","c205f6fb":"Around 9580 rows are removed from the dataset","b3dc6a17":"After label encoding we will use the OneHotEncoder from sklearn. The label encoder may confuse our model that the label number are in certain order. For example is label number 3 is in any relationship with 4 such as 3 < 4. To remove such confusion we will provide each label a value of 1 but seperate columns will be formed for each of them.","d231cc1f":"The minimum value is 22kg and maximum is 136 kg. There is no nan value present in the weight column.","7e3bc38f":"### Check the astype. \nIt should be int type.","0c03522b":"## Plotting to see age distribution","773d6773":"Let us replace the nan values in height column. The same procedure as above is followed to replace the values.","9df3c667":"Since our label are object we should encode them to numbers. This can be easily done with the help of label encoder in sklearn.","4bfd17e1":"## XGBoost Classifier","835e1dea":"# Age","bc1d5fb4":"We will use XGBoost classification algorithm and see the result for both type of encoded data.","c563320f":"# Height","06bbcb0b":"### Split the data","2f907552":"# Outlier correction using sklearn","d065ccc6":"## Unique values\nLet us see the list of unique values present in the height column","c84dfa8b":"Let us see what are the different unique values present in the age column.","d04ccc65":"## Analyzing the missing values","133efd2c":"## Plotting to see outliers","25a5bc77":"# Split the data","51001e15":"## Plotting to see outliers","1c982210":"The nan values in the age column are replaced by the mean values. ","50216cf7":"From above we can see that some values in age, height column are null in nature.","b4c7937f":"The above array contain minimum value of nan, 0 which we can say is of child who is not yet 1 year old and maximum value of 117 which means the person is very old. But it is clear that these values according to their cloth size may not be correct.","8a397142":"## Dropping the rows in specific range","fa4fb29c":"### Fill nan values","a6d8d57b":"## For OneHotEncoded Values","d0521020":"## Dropping the rows in specific range","daaef209":"In order to achieve the result I grouped the rows according to the size and calculated the mean of the age."}}