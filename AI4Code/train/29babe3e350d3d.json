{"cell_type":{"8564eeee":"code","7db559b7":"code","b287c6bb":"code","af4daf64":"code","f6c4545a":"code","3c8ceb33":"code","a5daf34a":"code","89f42847":"code","38180a05":"code","c495ad85":"code","db4fff39":"markdown"},"source":{"8564eeee":"# \u30e9\u30a4\u30d6\u30e9\u30ea\u3092import\u3057\u307e\u3059\nimport os\nimport numpy as np\nimport pandas as pd\nfrom pandas import DataFrame\nimport matplotlib.pyplot as plt\n\nfrom sklearn.metrics import roc_auc_score\nfrom sklearn.neighbors import LocalOutlierFactor\nfrom sklearn.ensemble import IsolationForest\nfrom sklearn.svm import OneClassSVM\nfrom sklearn.preprocessing import MinMaxScaler\nfrom tqdm.notebook import tqdm\nimport librosa \nimport librosa.display\nimport IPython","7db559b7":"INPUT = '\/kaggle\/input\/hah-data-science-challenge\/'","b287c6bb":"# \u30c7\u30fc\u30bf\u8aad\u307f\u8fbc\u307f\ndf_train = pd.read_csv(INPUT + 'train.csv', index_col=False)\ndf_test = pd.read_csv(INPUT + 'test.csv', index_col=False)\n\n# meta_data\u306b\u30d5\u30a1\u30a4\u30eb\u30d1\u30b9\u3092\u8ffd\u52a0\ndf_train['filepath'] = INPUT+ 'train\/train\/' + df_train['\u30d5\u30a1\u30a4\u30eb']\ndf_test['filepath'] = INPUT + 'test\/test\/' + df_test['\u30d5\u30a1\u30a4\u30eb']\n\n# train\u3068test\u3092\u3072\u3068\u3064\u306b\ndf = pd.concat([df_train, df_test]).reset_index(drop=True)\n\nsub = pd.read_csv('..\/input\/hahlb082548sub\/submission.csv')","af4daf64":"# \u540d\u5bc4\u305b\nrecording_map = {\n    'PC\u5185\u81d3': 'PC\u5185\u8535', \n    'PC\u5185\u8535': 'PC\u5185\u8535', \n    'USB1': 'USB1', \n    'USB2': 'USB2', \n    'USB3': 'USB3', \n    'USB4': 'USB4', \n    '\u30b9\u30de\u30db': '\u30b9\u30de\u30db', \n    '\u30b9\u30de\u30db\u306e\u30dc\u30a4\u30b9\u30ec\u30b3\u30fc\u30c0': '\u30b9\u30de\u30db', \n    '\u5185\u8535\u30de\u30a4\u30af': 'PC\u5185\u8535'\n}\n\ndistance_map = {\n    '10cm': '10cm',\n    '10\u339d': '10cm',\n    '1M': '1m',\n    '20cm': '20cm',\n    '20\u339d': '20cm',\n    '2M': '2m',\n    '2m': '2m',\n    '30cm': '30cm',\n    '30cn': '30cm',\n    '30\u339d': '30cm',\n    '3m': '3m',\n    '40cm': '40cm',\n    '40\u339d': '40cm',\n    '50cm': '50cm',\n    '50\u339d': '50cm',\n    '5cm': '5cm',\n    '8cm': '8cm',\n    '\uff11\uff2d': '1m'\n}\n\ndf['\u9332\u97f3\u65b9\u6cd5'] = df['\u9332\u97f3\u65b9\u6cd5'].replace(recording_map)\ndf['\u30de\u30a4\u30af\u8ddd\u96e2'] = df['\u30de\u30a4\u30af\u8ddd\u96e2'].replace(distance_map)","f6c4545a":"# \u6b63\u5e38\u306b\u306a\u3044\u6761\u4ef6\u306eid\u3092\u62bd\u51fa\ndf['\u6761\u4ef6'] = df['\u306d\u3058'] + '_' + df['\u30d7\u30ec\u30fc\u30c8'] + '_' + df['\u9332\u97f3\u65b9\u6cd5'] + '_' + df['\u30de\u30a4\u30af\u8ddd\u96e2']\ndf.loc[df['Target']==0, '\u6b63\u5e38'] = 1\ndf['\u6b63\u5e38'] = df['\u6b63\u5e38'].fillna(0)\nset_norm = set(df.loc[df['\u6b63\u5e38']==1, '\u6761\u4ef6'].unique().tolist())\nset_other = set(df.loc[df['\u6b63\u5e38']==0, '\u6761\u4ef6'].unique().tolist())\nother_only = list(set_other - set_norm)\nother_only","3c8ceb33":"other_only_id = df.loc[df['\u6761\u4ef6'].isin(other_only), 'ID'].tolist()","a5daf34a":"sub.loc[sub['ID'].isin(other_only_id), 'Target']","89f42847":"# \u6b63\u5e38\u306b\u306a\u3044\u6761\u4ef6\u306eid\u306e\u7570\u5e38\u5ea6\u306b\u88dc\u6b63\u3092\u639b\u3051\u308b\nw = 0.85\nsub.loc[sub['ID'].isin(other_only_id), 'Target'] = sub.loc[sub['ID'].isin(other_only_id), 'Target'] * w","38180a05":"sub.loc[sub['ID'].isin(other_only_id), 'Target']","c495ad85":"sub = sub.set_index('ID')\nsub.to_csv('submission.csv')\nsub","db4fff39":"\u6b63\u5e38\u306b\u306a\u3044\u6761\u4ef6\u306f\u7570\u5e38\u5ea6\u304c\u9ad8\u304f\u3067\u305d\u3046\u306a\u306e\u3067\u3001\u88dc\u6b63\u3059\u308b"}}