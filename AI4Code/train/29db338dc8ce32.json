{"cell_type":{"c0546e3c":"code","0abf64e8":"code","5b342661":"code","d0cf8154":"code","33be67ce":"code","0d5cef5b":"code","63021906":"code","1f4a6b87":"code","1371a1ab":"code","c34dd71e":"code","1eee7943":"markdown","92e8d1f9":"markdown","ce4e98a1":"markdown","d24a0919":"markdown","25bdf527":"markdown","e986debc":"markdown","9041a8ca":"markdown","da886971":"markdown","91b6004f":"markdown","441df150":"markdown","ee5c4496":"markdown"},"source":{"c0546e3c":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\ntrain_identity = pd.read_csv('\/kaggle\/input\/ieee-fraud-detection\/train_identity.csv', index_col='TransactionID')\ntrain_transaction = pd.read_csv('\/kaggle\/input\/ieee-fraud-detection\/train_transaction.csv', index_col='TransactionID')\n\n# merge the two dataframe in a single set\ntrain = train_transaction.merge(train_identity, how='left', left_index=True, right_index=True)","0abf64e8":"# compile list of C columns\nc_list = []\nfor i in range(1,15):    \n    c_list.append('C' + str(i))\n\n# compile list of D columns\nd_list = []\nfor i in range(1,16):    \n    d_list.append('D' + str(i))\n\n# compile list of V columns\nv_list = []\nfor i in range(1,340):    \n    v_list.append('V' + str(i))\n\n# compile list of id columns\nid_list = []\nfor i in range(1,12):\n    ii = str(i).zfill(2)    \n    id_list.append('id_' + str(ii))\nid_list.extend(['id_13','id_14','id_17','id_18','id_19','id_20','id_21',\\\n                'id_22','id_24','id_25','id_26','id_32'])\n\n# create list of columns label for correlation check\ncolums_for_corr = ['isFraud','TransactionAmt','card1','card2','card3','card5','addr1','addr2','dist1','dist2']\ncolums_for_corr.extend(c_list)\ncolums_for_corr.extend(d_list)\ncolums_for_corr.extend(v_list)\ncolums_for_corr.extend(id_list)\n\ncorr_matrix = train[colums_for_corr].corr()","5b342661":"sns.set(rc={'figure.figsize':(20,20)})\nsns.heatmap(corr_matrix, cmap=\"RdBu\")","d0cf8154":"isFraud_corr = corr_matrix['isFraud']\n\ncolumns_with_correlation = isFraud_corr.loc[isFraud_corr >= 0.2]\n\nprint(columns_with_correlation.sort_values(ascending=False))","33be67ce":"def check_corr_fraud(df, col):\n    \n    fr1 = (df.loc[df['isFraud'] == 1][col].value_counts())\n    fr0 = (df.loc[df['isFraud'] == 0][col].value_counts())\n    \n    fr = pd.merge(fr1, fr0, how = 'left',\n                  left_on  = fr1.index,\n                  right_on = fr0.index)\n    \n    fr = fr.rename(columns={'key_0': col,\n                            f'{col}_x': 'Fraud',\n                            f'{col}_y': 'Not Fraud'})\n    \n    fr['tot count'] = fr['Fraud'] + fr['Not Fraud']\n    \n    fr['% Fraud'] = 100 * np.divide(fr['Fraud'], fr['tot count'])\n    \n    fr['% Not Fraud'] = 100 * np.divide(fr['Not Fraud'], fr['tot count'])\n    \n    return fr","0d5cef5b":"def plot_corr_fraud(df,col):\n    \n    a = check_corr_fraud(train,col)\n\n    sns.set(rc={'figure.figsize':(11.7,8.27)})\n    plt.bar(a[col], a['% Fraud'])\n    plt.ylim([0,100])\n    plt.ylabel('% Fraud',fontsize=12)\n    plt.xlabel(col,fontsize=12)\n    plt.xticks(rotation=90)\n    plt.subplots_adjust(bottom=0.4)\n    \n    return\n\ndef plot_corr_fraud_large(df,col):\n    \n    a = check_corr_fraud(train,col)\n\n    sns.set(rc={'figure.figsize':(101.7,8.27)})\n    plt.bar(a[col], a['% Fraud'])\n    plt.ylim([0,100])\n    plt.ylabel('% Fraud',fontsize=12)\n    plt.xlabel(col,fontsize=12)\n    plt.xticks(rotation=90)\n    plt.subplots_adjust(bottom=0.4)\n    \n    return","63021906":"plot_corr_fraud(train,'P_emaildomain')","1f4a6b87":"plot_corr_fraud(train,'R_emaildomain')","1371a1ab":"plot_corr_fraud_large(train,'id_31')","c34dd71e":"plot_corr_fraud_large(train,'DeviceInfo')","1eee7943":"Numerical data are find in all `C`, `D`, `V` columns, some `id_` and `card` columns, `TransactionAmt`, `addr1-2` and `dist1-2`.\n\nLet's select them and check the correlation among all these variables.","92e8d1f9":"From the global correlation matrix, let's extract just the *isFraud* column and see labels with correlation higher than 0.20. (also correlation < - 0.2 would be interesting, but the minimum value encountered was about -0.14.","ce4e98a1":"In the following, I will select just the graphs with relevant correlation between labels and `isFraud=1`.","d24a0919":"Some email domains look to be more exposed to fraudulent transactions.","25bdf527":"# Conclusion\n\nFrom numerical variables, some from the `V` group showed an appreciable correlation with the `isFraud` label.\n\nFrom categorical variables, `emaildomain` and `DeviceInfo` showed an appreciable correlation with the `isFraud` label.\n\n","e986debc":"Hello world!\nIn this notebook you will find a short EDA focused on correlation between variables and the `isFraud` feature.\n\nFirst of all, let's load packages and train data.","9041a8ca":"For categorical variables, let's explore via graph the correlation between labels and `isFraud`.\n\nFirst of all, let's create a function that counts the 1 and 0 values in `isFraud` for each label. Please note that this function neglect all labels that have at least one value with `isFraud=0` but no one with `isFraud=1`. At this stage, this is not a high limitation as we are interested to check correlation with `isFraud=1`.","da886971":"*(Right-click and open in a new window to see the full size image)*\n\nSome devices look to be more exposed to fraudulent transactions.","91b6004f":"Let's prepare also a function ready to make plots for categorical variables.\nNote that the `ylim` property was set to `[0,100]`, in order to avoid misleading charts.\nThe *large* function is to make a larger graph (for many categorical variables).","441df150":"Let's plot a heatmap to have a sight about correlation. \nGenerally speaking, `C` and `D` show a high internal correlation. The same for `V`, but with some exceptions.","ee5c4496":"*(Right-click and open in a new window to see the full size image)*\n\nSome browser look to be more exposed to fraudulent transactions."}}