{"cell_type":{"e51fd804":"code","f4deaa25":"code","9f175feb":"code","964f9d5e":"code","ea36e31e":"code","419427b9":"code","71012377":"code","24591b92":"code","2298efbf":"code","5b5ba64e":"code","3efbb30d":"code","6c22d745":"code","2f81b774":"code","37200d7a":"code","19217ef7":"markdown","9aec09e7":"markdown","cda183c7":"markdown"},"source":{"e51fd804":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\n\nfrom tqdm import tqdm\nimport h2o\nfrom h2o.automl import H2OAutoML\n\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","f4deaa25":"df_train = pd.read_csv('\/kaggle\/input\/tabular-playground-series-jul-2021\/train.csv')\ndf_test = pd.read_csv('\/kaggle\/input\/tabular-playground-series-jul-2021\/test.csv')\ndf_train.date_time = df_train.date_time.astype('datetime64[ns]')\ndf_test.date_time = df_test.date_time.astype('datetime64[ns]')","9f175feb":"h2o.init(nthreads=-1)","964f9d5e":"hf_train = h2o.H2OFrame(df_train)\nhf_test = h2o.H2OFrame(df_test)","ea36e31e":"## run model for carbon monoxide\nfeatures = [x for x in hf_train.columns if x not in ['target_carbon_monoxide', 'target_benzene', 'target_nitrogen_oxides']]\n\ntarget_carbon_monoxide = H2OAutoML(\n    max_runtime_secs=360,\n    stopping_metric='RMSLE',\n    sort_metric='RMSLE'\n)\n\ntarget_carbon_monoxide.train(x=features, y='target_carbon_monoxide', training_frame=hf_train)","419427b9":"## check leaderboard for carbon monoxide\ntarget_carbon_monoxide.leaderboard","71012377":"target_benzene = H2OAutoML(\n    max_runtime_secs=360,\n    stopping_metric='RMSLE',\n    sort_metric='RMSLE'\n)\n\ntarget_benzene.train(x=features, y='target_benzene', training_frame=hf_train)","24591b92":"# check leaderboard for benzene\ntarget_benzene.leaderboard","2298efbf":"target_nitrogen_oxides = H2OAutoML(\n    max_runtime_secs=720,\n    stopping_metric='RMSLE',\n    sort_metric='RMSLE'\n)\n\ntarget_nitrogen_oxides.train(x=features, y='target_nitrogen_oxides', training_frame=hf_train)","5b5ba64e":"# check leaderboard for nitrogen oxides\ntarget_nitrogen_oxides.leaderboard","3efbb30d":"submission = pd.read_csv('\/kaggle\/input\/tabular-playground-series-jul-2021\/sample_submission.csv')\nsubmission","6c22d745":"submission.target_carbon_monoxide = target_carbon_monoxide.leader.predict(hf_test).as_data_frame()\nsubmission.target_benzene = target_benzene.leader.predict(hf_test).as_data_frame()\nsubmission.target_nitrogen_oxides = target_nitrogen_oxides.leader.predict(hf_test).as_data_frame()\nsubmission\n\n\n","2f81b774":"submission.describe()","37200d7a":"submission.to_csv('h2o_base_submission.csv',index=False)","19217ef7":"## Preict Benzene","9aec09e7":"## Predict Carbon monoxide","cda183c7":"## Predict Nitrogen Oxides"}}