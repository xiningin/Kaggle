{"cell_type":{"50d1ee8c":"code","1d65f791":"code","424e2ae0":"code","676500d7":"code","407c3419":"code","5ce19e23":"code","c9ef24e4":"code","8b4d75bc":"code","291db1ff":"code","a34035a9":"code","0c0d7598":"code","b00c7eab":"code","8816e5a7":"code","c0d78048":"code","9e117a7c":"code","72c37a30":"code","942580b6":"code","b15559b6":"code","7c1ff16f":"code","7b8dcf42":"code","f551bf08":"code","d2ab6bed":"code","9479c85a":"code","40e10b15":"code","cd6077aa":"code","bf4be288":"code","edc78121":"code","c9439dc0":"code","cf1c058e":"code","b93ce9f1":"code","9bf51d82":"code","6b60ba20":"code","e3a697e7":"code","5d8d2248":"code","7e6855e5":"code","b3f9fdca":"code","354d3f9a":"code","0a1a0e68":"code","42595383":"code","920e93e1":"code","62bff477":"code","27adcbf6":"code","0ec085c4":"code","de0626a9":"code","9a70d3ad":"code","fc876e48":"code","e8b6eb15":"code","4565b541":"code","4295221a":"code","61156323":"code","4a5ad3d7":"code","689c7434":"code","ea97c74b":"code","cfdb3461":"code","cf930f44":"code","74200d7a":"code","869db00b":"code","1fb7775c":"code","906c8707":"code","379f155b":"code","c79af4c3":"code","c8b21d94":"code","69cf2fb8":"code","35f4f202":"code","ad9a0ca7":"code","656e256d":"code","3d239569":"code","acd9e12c":"code","cd65e96f":"code","215918d9":"code","f8c1a9d8":"code","586900e3":"code","77652ea6":"code","800c1d12":"code","b2b55280":"code","3827058c":"code","6354d517":"code","83c35c53":"code","7eaa07f5":"code","d8564dc9":"code","e58af4c1":"code","a300b465":"code","4a691ff3":"code","b494a7a3":"code","85901fd5":"code","e1dc636f":"code","d27c4c26":"code","c66bc630":"code","2ae519c6":"code","d4877685":"markdown","98b9ef60":"markdown","3cbeb003":"markdown","aa239128":"markdown","e52ca473":"markdown","38297d0f":"markdown","7fc931c6":"markdown","5e53c5ec":"markdown","e221ec8b":"markdown","48f1958b":"markdown","dc46883e":"markdown","723d24f1":"markdown","bf61a1d7":"markdown","5673e3b3":"markdown","38675058":"markdown","12b09142":"markdown","a8c658be":"markdown","ee81d0c6":"markdown","8830abc1":"markdown","513c4037":"markdown","4da16f4a":"markdown","99e10815":"markdown","90468b71":"markdown","8fdf4e44":"markdown","15210580":"markdown"},"source":{"50d1ee8c":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set()\n%matplotlib inline","1d65f791":"df = pd.read_csv('\/kaggle\/input\/cardiovascular-disease-dataset\/cardio_train.csv', sep=';')\ndf.head()","424e2ae0":"df.shape","676500d7":"# Check for missing values\ndf.isnull().sum()","407c3419":"df['cardio'].unique()","5ce19e23":"# Convert age from days to years\ndf['age'] =  df['age'] \/ 365","c9ef24e4":"df.head()","8b4d75bc":"# Rename columns to make features more clearly understood\ndf.rename(columns={'ap_hi': 'systolic', 'ap_lo': 'diastolic', 'gluc': 'glucose', 'alco': 'alcohol', 'cardio': 'cardiovascular disease'}, inplace=True)","291db1ff":"df.head()","a34035a9":"sns.lmplot(x='weight', y='height', hue='gender', data=df, fit_reg=False, height=6)\nplt.show()","0c0d7598":"sns.countplot(x='gender', data=df, hue='cardiovascular disease')\nplt.show()\n\n# Not much of a difference between females (1) and males (2) and the chance of getting cardiovascular disease.","b00c7eab":"df.describe()","8816e5a7":"df_train = df.drop('id', axis=1)","c0d78048":"df_train.head()","9e117a7c":"df_train.info()","72c37a30":"# 24 Duplicated entries\ndf_train.duplicated().sum()","942580b6":"df_train[df_train.duplicated()]","b15559b6":"df_train.drop_duplicates(inplace=True)","7c1ff16f":"df_train.count()","7b8dcf42":"df_train.isnull().sum()","f551bf08":"df_train.head()","d2ab6bed":"sns.countplot(x='gender', hue='cardiovascular disease', data=df_train)\nplt.show()","9479c85a":"sns.countplot(x='cholesterol', hue='cardiovascular disease', data=df_train)\nplt.show()\n# There appears to be a correlation between higher cholesterol levels and cardiovascular disease\n# chloesterol levels: 1 = normal, 2 = above normal, 3 = well above normal","40e10b15":"sns.countplot(x='glucose', hue='cardiovascular disease', data=df_train)\nplt.show()\n# There appears to be another correlation between higher glucose levels and cardiovascular disease\n# glucose levels: 1 = normal, 2 = above normal, 3 = well above normal","cd6077aa":"sns.countplot(x='active', hue='cardiovascular disease', data=df_train)\nplt.show()","bf4be288":"sns.countplot(x='smoke', hue='cardiovascular disease', data=df_train)\nplt.show()","edc78121":"sns.countplot(x='alcohol', hue='cardiovascular disease', data=df_train)\nplt.show()","c9439dc0":"sns.distplot(df_train['weight'], kde=False)\nplt.show()","cf1c058e":"df_train['weight'].sort_values().head()","b93ce9f1":"sns.distplot(df_train['height'], kde=False)\nplt.show()","9bf51d82":"df_train['height'].max()","6b60ba20":"df_train['height'].sort_values().head()","e3a697e7":"df_train['BMI'] = df_train['weight'] \/ df_train['height'] \/ df_train['height'] * 10000\ndf_train['pulse pressure'] = df_train['systolic'] - df_train['diastolic']","5d8d2248":"df_train.head()\n# Quick look at the dataframe to make sure these new features have been added","7e6855e5":"plt.figure(figsize=(8,4))\nsns.distplot(df_train['BMI'], bins=50, kde=False)\nplt.show()","b3f9fdca":"df_train[df_train['BMI'] > 100].head(10)","354d3f9a":"df_train[(df_train['pulse pressure'] >= 60 ) & (df_train['cholesterol'] == 3)].head(15)","0a1a0e68":"plt.figure(figsize=(8,4))\nsns.distplot(df_train['height'], kde=False)\nplt.show()","42595383":"# Splitting data into training and testing datasets\nX = df_train.drop(['weight', 'height', 'cardiovascular disease'], axis=1)\ny = df_train['cardiovascular disease']\n\nfrom sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=17)","920e93e1":"#Feature Scaling\nfrom sklearn.preprocessing import StandardScaler\nsc_X = StandardScaler()\nX_train = sc_X.fit_transform(X_train)\nX_test = sc_X.transform(X_test)","62bff477":"len(X_train)","27adcbf6":"len(y_train)","0ec085c4":"# Random Forest\nfrom sklearn.ensemble import RandomForestClassifier\nrfc = RandomForestClassifier(n_estimators=100)\nrfc.fit(X_train, y_train)","de0626a9":"y_pred_rfc = rfc.predict(X_test)","9a70d3ad":"# Random Forest Model Evaluation\nfrom sklearn.metrics import confusion_matrix, classification_report\nprint(confusion_matrix(y_test, y_pred_rfc))\nprint(classification_report(y_test, y_pred_rfc))","fc876e48":"rfc.score(X_test, y_test)","e8b6eb15":"#Applying k-Fold Cross Validation\nfrom sklearn.model_selection import cross_val_score\naccuracies_rfc = cross_val_score(estimator=rfc, X=X_train, y=y_train, cv=10)","4565b541":"accuracies_rfc","4295221a":"accuracies_rfc.mean()","61156323":"accuracies_rfc.std()","4a5ad3d7":"# SVM\nfrom sklearn.svm import SVC\nsvc = SVC(gamma='auto')\nsvc.fit(X_train, y_train)","689c7434":"y_pred_svc = svc.predict(X_test)","ea97c74b":"# SVM Model Evaluation\nprint(confusion_matrix(y_test, y_pred_svc))\nprint(classification_report(y_test, y_pred_svc))","cfdb3461":"svc.score(X_test, y_test)","cf930f44":"#Applying k-Fold Cross Validation\naccuracies_svc = cross_val_score(estimator=svc, X=X_train, y=y_train, cv=10, n_jobs=4)","74200d7a":"accuracies_svc","869db00b":"accuracies_svc.mean()","1fb7775c":"accuracies_svc.std()","906c8707":"# KNN\nfrom sklearn.neighbors import KNeighborsClassifier\nknn = KNeighborsClassifier(n_neighbors=100)\nknn.fit(X_train, y_train)","379f155b":"y_pred_knn = knn.predict(X_test)","c79af4c3":"# KNN Model Evaluation\nprint(confusion_matrix(y_test, y_pred_knn))\nprint(classification_report(y_test, y_pred_knn))","c8b21d94":"knn.score(X_test, y_test)","69cf2fb8":"#Applying k-Fold Cross Validation\naccuracies_knn = cross_val_score(estimator=knn, X=X_train, y=y_train, cv=10)","35f4f202":"accuracies_knn","ad9a0ca7":"accuracies_knn.mean()","656e256d":"accuracies_knn.std()","3d239569":"# Naive Bayes\nfrom sklearn.naive_bayes import GaussianNB\nnbc = GaussianNB()\nnbc.fit(X_train, y_train)","acd9e12c":"y_pred_nbc = nbc.predict(X_test)","cd65e96f":"# Naive Bayes Model Evaluation\nprint(confusion_matrix(y_test, y_pred_nbc))\nprint(classification_report(y_test, y_pred_nbc))","215918d9":"nbc.score(X_test, y_test)","f8c1a9d8":"#Applying k-Fold Cross Validation\naccuracies_nbc = cross_val_score(estimator=nbc, X=X_train, y=y_train, cv=10)","586900e3":"accuracies_nbc","77652ea6":"accuracies_nbc.mean()","800c1d12":"accuracies_nbc.std()","b2b55280":"# XGBoost Model\nfrom xgboost import XGBClassifier\nxgb = XGBClassifier(learning_rate=0.02, n_estimators=600)\nxgb.fit(X_train, y_train)","3827058c":"y_pred_xgb = xgb.predict(X_test)","6354d517":"# XGBoost Model Evaluation\nprint(confusion_matrix(y_test, y_pred_xgb))\nprint(classification_report(y_test, y_pred_xgb))","83c35c53":"xgb.score(X_test, y_test)","7eaa07f5":"#Applying k-Fold Cross Validation\naccuracies_xgb = cross_val_score(estimator=xgb, X=X_train, y=y_train, cv=10)","d8564dc9":"accuracies_xgb","e58af4c1":"accuracies_xgb.mean()","a300b465":"accuracies_xgb.std()","4a691ff3":"#Applying Grid Search to find the best model and best parameters (XGBoost)\n#from sklearn.model_selection import GridSearchCV\n\n#define set of parameters that will be investigated by Grid Search\n#parameters = {\n#            'learning_rate': [0.01, 0.02, 0.05, 0.1],\n#            'n_estimators': [100, 200, 300, 500],\n#            'min_child_weight': [1, 5, 10],\n#            'gamma': [0.5, 1, 1.5, 2, 5],\n#            'subsample': [0.6, 0.8, 1.0],\n#            'colsample_bytree': [0.6, 0.8, 1.0],\n#            'max_depth': [3, 4, 5]\n#            }","b494a7a3":"#grid_search = GridSearchCV(estimator=xgb,\n#                          param_grid = parameters,\n#                          scoring = 'accuracy',\n#                          cv = 10,\n#                          n_jobs = -1)","85901fd5":"#grid_search = grid_search.fit(X_train, y_train)","e1dc636f":"#Applying Grid Search to find the best model and best parameters (SVM)\n#from sklearn.model_selection import GridSearchCV\n\n#define set of parameters that will be investigated by Grid Search\n#parameters = {'C': [1, 10, 100, 1000], 'kernel': ['rbf']}","d27c4c26":"#grid_search = GridSearchCV(estimator=svc,\n#                          param_grid = parameters,\n#                          scoring = 'accuracy',\n#                          cv = 10,\n#                          n_jobs = -1)","c66bc630":"#grid_search = grid_search.fit(X_train, y_train)","2ae519c6":"model = ['Random Forest', 'SVM', 'KNN', 'Naive Bayes', 'XGBoost']\nscores = [accuracies_rfc.mean(),accuracies_svc.mean(),accuracies_knn.mean(),accuracies_nbc.mean(),accuracies_xgb.mean()]\n\nsummary = pd.DataFrame(data=scores, index=model, columns=['Mean Accuracy'])\nsummary.sort_values(by='Mean Accuracy', ascending=False)","d4877685":"**K-Fold cross-valuidation of KNN model**","98b9ef60":"**Random Forest Model Investigation**","3cbeb003":"**Body Mass Index (BMI)** is a common metric used for medical evaluation and heart health <br>\nBMI can be calculated by the following: BMI = weight(kg) \/ height (cm) \/ height (cm) x 10,000 <br>\n<br>\n**Pulse Pressure** is another indicator of heart health <br>\nPulse Pressure can be calculated by the following: Pulse Pressure = systolic - diastolic <br>\nTypically, a pulse pressure greater than 60 can be a useful predictor of heart attacks or other cardiovascular diseases","aa239128":"This maximum height of 250 cm\/8.2 ft seems unlikely ","e52ca473":"**K-Fold cross-valuidation of Naive Bayes model**","38297d0f":"## Model Selection","7fc931c6":"The minimum height of 55 cm\/1.8 ft also seems unlikely and unrealistic. <br>\nThis dataset may not be legitimate; however, we will continue on with the data analysis and model selection.","5e53c5ec":"**Note:** Very strange observations in the height and weight. Minimum and maximum values do not look realistic.","e221ec8b":"**Grid Search for the top two models** <br>\nBased on this investigation so far, the two best performers are the *XGBoost* and *SVM* models with mean accuracy scores of *73.7%* and *72.7%*, respectively. <br>\n**Note:** Grid search has been commented out due to length of processing time.","48f1958b":"Quick observation to see if extremely high BMI values correlate to cardiovascular disease","dc46883e":"**K-Fold cross-valuidation of SVM model**","723d24f1":"**K-Fold cross-valuidation of Random Forest Model**","bf61a1d7":"**K-Fold cross-valuidation of XGBoost model**","5673e3b3":"- The XGBoost model was the best performer out of the five models giving us a mean accuracy score of 73.7%. <br>\n- K-Fold cross validation was used to ensure no overfitting was done. <br>\n- Grid search can be further performed on the best model candidates; however, this step can be time intensive, potentially demanding a great deal of CPU usage.","38675058":"**This is one of my first data science projects. <br>\n<br>\nIn this notebook, I take a look at a dataset containing 70,000 entries of patients' medical information such as height, weight, age, blood pressure, glucose levels, and cholesterol levels. <br>\n<br>\nThe goal of this project is to use these features in order to make predictions if a patient has cardiovascular disease. <br>\nSeveral classification models will be investigated in this project. <br>\n<br>\nAny constructive feedback is welcomed and upvotes would be greately appreciated!!","12b09142":"**XGBoost Model Investigation**","a8c658be":"## Feature Engineering","ee81d0c6":"## Conclusion","8830abc1":"Cursory glance at individuals who have both high pulse pressure (>=60) *and* well above normal cholesterol levels (3). <br>\nUpon inspection of the first several entries, having both high pulse pressure and well above normal cholesterol levels correlate to a higher likelihood of having cardiovascular disease.","513c4037":"## Exploratory Data Analysis","4da16f4a":"We will investigate different classification models and evaluate each to select the best performer.\nThe models that will be evaluted are the following:\n- Random Forest\n- SVM\n- KNN\n- Naive Bayes\n- XGBoost","99e10815":"**SVM Model Investigation**","90468b71":"**Naive Bayes Model Investigation**","8fdf4e44":"**K-Nearest Neighbor Model Investigation**","15210580":"## Cardiovascular Disease Project Introduction"}}