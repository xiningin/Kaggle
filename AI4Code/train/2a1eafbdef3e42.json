{"cell_type":{"0c9cd2ae":"code","dffab621":"code","cd5f53d7":"code","84d24794":"code","f4a8014d":"code","935e5b84":"code","5a0a31e2":"code","6d027cbc":"code","104c72e0":"code","2236d918":"code","0f5bb59b":"code","7c20ccf7":"code","505e7274":"code","c87b8fdd":"code","cc4af78c":"code","dca78173":"code","3eb8b3ab":"markdown","fdfb9c50":"markdown","e3f4534c":"markdown","0229227b":"markdown","7c287bf3":"markdown","a1a24927":"markdown","bb1db04f":"markdown"},"source":{"0c9cd2ae":"!pip install pyspark","dffab621":"!wget https:\/\/raw.githubusercontent.com\/prasadpatil99\/Recommendation-System\/master\/ratings.csv","cd5f53d7":"from pyspark.sql import SparkSession\nfrom pyspark.ml.evaluation import RegressionEvaluator\nfrom pyspark.ml.recommendation import ALS","84d24794":"spark = SparkSession.builder.appName('rec').getOrCreate()","f4a8014d":"data1 = spark.read.csv('ratings.csv',inferSchema=True,header=True)\nfeatures_drop = ['timestamp']\ndata = data1.drop(*features_drop)","935e5b84":"data.printSchema()","5a0a31e2":"data.show()","6d027cbc":"data.describe().show()","104c72e0":"(train, test) = data.randomSplit([0.7, 0.2])","2236d918":"als = ALS(maxIter=4, regParam=0.15, userCol=\"userId\", \n          itemCol=\"movieId\", ratingCol=\"rating\", coldStartStrategy=\"drop\")\nmodel = als.fit(train)","0f5bb59b":"predictions = model.transform(test)","7c20ccf7":"predictions.show()","505e7274":"evaluator = RegressionEvaluator(metricName=\"rmse\", labelCol=\"rating\",predictionCol=\"prediction\")\nrmse = evaluator.evaluate(predictions)\nprint(\"Root-mean-square error = \" + str(rmse))","c87b8fdd":"predict = test.filter(test['userId']>500).select(['movieId','userId'])","cc4af78c":"reccomendations = model.transform(predict)","dca78173":"reccomendations.orderBy('prediction',ascending=False).show()","3eb8b3ab":"Predictions for a multiple users","fdfb9c50":"Evaluate Predictions via Root - Mean - Square ","e3f4534c":"Install Pyspark","0229227b":"Request for dataset","7c287bf3":"Create Pysprark Session & Import Dataset","a1a24927":"Split Dataset into train & test","bb1db04f":"Training Model"}}