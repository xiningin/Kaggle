{"cell_type":{"417aba27":"code","d5c6a888":"code","43718625":"code","1aef46ce":"code","d0957eda":"code","62319188":"code","3a66e94e":"code","8d2fd739":"code","7f735075":"code","ab258fd9":"code","a16f0eb6":"code","634ea0c8":"code","a3b0bfd9":"code","2bc225e4":"code","c15153f8":"code","c70f620c":"code","de4659ed":"code","ba48a973":"code","116bdb81":"code","dbda726e":"code","e581e04b":"code","621e90ca":"code","fb385c28":"code","6537fa45":"code","8cae42fe":"code","2a08454a":"code","97b37fd5":"code","39e91899":"code","44067e2e":"code","8051629b":"code","4d73612e":"code","ba91835e":"code","00b8b6a3":"markdown","aa053513":"markdown","7c060c89":"markdown","002b76c3":"markdown","fc0bdf53":"markdown","229c28ee":"markdown","ec4e440e":"markdown","3898739c":"markdown","0872f544":"markdown","3e97c442":"markdown","de8428a7":"markdown","f6e306eb":"markdown","0f0227e7":"markdown","f72857dd":"markdown","00f29570":"markdown","fc02cd29":"markdown","665e5021":"markdown","6e25f1ed":"markdown","51187747":"markdown","e88c13f4":"markdown","4005e280":"markdown"},"source":{"417aba27":"# Importing libraries\nimport sqlite3\nimport numpy as np\nimport pandas as pd\npd.set_option('max_rows', 10)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport warnings\nwarnings.filterwarnings('ignore')","d5c6a888":"conn = sqlite3.connect('..\/input\/world-development-indicators\/database.sqlite')","43718625":"# Displaying SQL tables included in the dataset\npd.read_sql(\"\"\" SELECT *\n                FROM sqlite_master\n                WHERE type='table';\"\"\", conn)","1aef46ce":"# Structure of the Indicators table\npd.read_sql(\"\"\"SELECT *\n               FROM Indicators\n               LIMIT 5;\"\"\", conn)","d0957eda":"# Structure of the Series table\npd.read_sql(\"\"\" SELECT *\n                FROM Series\n                LIMIT 3;\"\"\",conn)\n","62319188":"# Structure of the Country table\npd.read_sql(\"\"\" SELECT *\n                FROM Country\n                LIMIT 3;\"\"\",conn)","3a66e94e":"# Total number of indicators\npd.read_sql(\"\"\"SELECT COUNT(DISTINCT IndicatorName) AS Num_indicators\n               FROM Indicators;\"\"\",conn)","8d2fd739":"# There are no null values in the dataset\npd.read_sql(\"\"\"SELECT COUNT(*) AS Num_of_null\n               FROM Indicators\n               WHERE IndicatorName IS NULL;\"\"\",conn)","7f735075":"# Retrieving 10 randomly selected example indicator names\npd.options.display.max_colwidth = 300\npd.read_sql(\"\"\" SELECT IndicatorName\n                FROM Indicators\n                ORDER BY RANDOM()\n                Limit 10;\"\"\",conn)","ab258fd9":"# Number of countries by region throughout the years\nregions = pd.read_sql(\"\"\"SELECT Region, COUNT(*) AS Num_countries\n               FROM Country \n               GROUP BY Region\n               ORDER BY 2 ASC;\"\"\", conn)\nregions","a16f0eb6":"# Visualing number of countries per region\nregions['Region'][4] = 'Unknown'\nsns.set_theme()\nfig, ax = plt.subplots(figsize=(12,8))\ncolors = sns.color_palette('cubehelix',16)\nax = sns.barplot(x=\"Num_countries\", y=\"Region\", data=regions, palette=colors)\nax.set(xlabel='Number of Countries',ylabel=None)\nax.set_title('Number of Countries per Region', fontsize = 16)\nfor ax in fig.axes:\n    for label in ax.get_yticklabels():\n        label.set_rotation(0)","634ea0c8":"# Top 20 countries that have the most number of indicators in 2014\ntop20_ind = pd.read_sql(\"\"\"SELECT CountryName,COUNT(DISTINCT IndicatorName) AS Num_ind\n               FROM Indicators\n               WHERE Year = 2014\n               GROUP BY CountryName\n               ORDER BY 2 DESC\n               LIMIT 20;\"\"\", conn)\ntop20_ind","a3b0bfd9":"# Visualising top 20 contries\nsns.set_theme()\nfig, ax = plt.subplots(figsize=(12,8))\ncolors = sns.color_palette('cubehelix',25)\nax = sns.barplot(x=\"Num_ind\", y=\"CountryName\", data=top20_ind, palette=colors)\nax.set(xlabel='Number of indicators',ylabel=None)\nax.set_title('Countries with most number of indicators in 2014', fontsize = 16)\nax.set(xlim=(620, 720))\nfor ax in fig.axes:\n    for label in ax.get_yticklabels():\n        label.set_rotation(0)","2bc225e4":"# Countries with the 10 smallest populations in 2014\nsmallest_count = pd.read_sql(\"\"\"SELECT CountryName, Value AS Population, Year\n                           FROM Indicators\n                           WHERE IndicatorName = 'Population, total'\n                           AND Year = 2014\n                           ORDER BY Value ASC\n                           LIMIT 10;\"\"\",conn)\nsmallest_count","c15153f8":"# Visualising countries with the 10 smallest populations in 2014\nsns.set_theme()\nfig, ax = plt.subplots(figsize=(12,8))\ncolors = sns.color_palette('cubehelix',20)\nax = sns.barplot(x=\"Population\", y=\"CountryName\", data=smallest_count, palette=colors)\nax.set(xlabel='Poulation, total',ylabel=None)\nax.set_title('Countries with the 10 smallest populations in 2014 in 2014', fontsize = 16)\nfor ax in fig.axes:\n    for label in ax.get_yticklabels():\n        label.set_rotation(0)","c70f620c":"# Country with the highest GDP per capita per year from 2000-2014\nhighest_gdp_per_year = pd.read_sql(\"\"\"SELECT CountryName, Year, MAX (Value) AS GDP_per_capita\n                                       FROM Indicators\n                                       WHERE IndicatorName = 'GDP per capita (current US$)'\n                                       AND Year >= 2000\n                                       GROUP BY Year\n                                       ORDER BY Year;\"\"\",conn)\nhighest_gdp_per_year","de4659ed":"# Countries with 10 highest GDP per capita in 2014\nhighest_gdp = pd.read_sql(\"\"\"SELECT CountryName, Value AS GDP_per_capita\n               FROM Indicators\n               WHERE IndicatorName='GDP per capita (current US$)'\n               AND Year= 2014\n               ORDER BY Value DESC\n               LIMIT 10;\"\"\",conn)\nhighest_gdp","ba48a973":"# Visualising results\nsns.set_theme()\nfig, ax = plt.subplots(figsize=(12,8))\ncolors = sns.color_palette('cubehelix',20)\nax = sns.barplot(x=\"GDP_per_capita\", y=\"CountryName\", data=highest_gdp, palette=colors)\nax.set(xlabel='GDP per capita (US$)',ylabel=None)\nax.set_title('Countries with 10 highest GDP per capita in 2014', fontsize = 16)\nax.set(xlim=(50000, 120000 ))\nfor ax in fig.axes:\n    for label in ax.get_yticklabels():\n        label.set_rotation(0)","116bdb81":"# Indicator names that include the word 'unemployment'\npd.options.display.max_colwidth = 200\npd.read_sql(\"\"\" SELECT IndicatorName\n                FROM Indicators\n                WHERE IndicatorName LIKE '%unemployment%'\n                GROUP BY IndicatorName;\"\"\", conn)","dbda726e":"pd.reset_option(\"max_colwidth\")\n\n# 10 countries with the highest unemployment (% of total labor force) in 2014\nhigh_unemp = pd.read_sql(\"\"\"SELECT CountryName, Value AS [Unemployment_rate]\n               FROM Indicators\n               WHERE IndicatorName= 'Unemployment, total (% of total labor force)'\n               AND Year= 2014\n               ORDER BY Value DESC\n               LIMIT 10;\"\"\",conn)\nhigh_unemp","e581e04b":"# Visualising results\nsns.set_theme()\nfig, ax = plt.subplots(figsize=(12,8))\ncolors = sns.color_palette('cubehelix',16)\nax = sns.barplot(x=\"Unemployment_rate\", y=\"CountryName\", data=high_unemp, palette=colors)\nax.set(xlabel='Unemployment rate (% of total labor force)',ylabel=None)\nax.set_title('10 Highest Unemployment Rates in the World in 2014', fontsize = 16)\nax.set(xlim=(20, 32))\nfor ax in fig.axes:\n    for label in ax.get_yticklabels():\n        label.set_rotation(0)","621e90ca":"# 6 types of CO2 emission exapmles with their long definitions from the Series table\npd.options.display.max_colwidth = 600\npd.read_sql(\"\"\" SELECT i.CountryName, i.IndicatorName, s.LongDefinition, i.Year\n                FROM Indicators i\n                LEFT JOIN Series s\n                USING (IndicatorName)\n                WHERE i.IndicatorName LIKE 'CO2 emissions%'\n                AND CountryName = 'World' AND Year = 2011\n                LIMIT 6;\"\"\",conn)","fb385c28":"# Level of central government debt of European Union member states in 2012 (the data on some EU countries is not included in the dataset)\n\neu_debt = pd.read_sql(\"\"\" SELECT CountryName, IndicatorName, Year, Value AS Debt\n                FROM Indicators\n                WHERE IndicatorName = 'Central government debt, total (% of GDP)'\n                AND CountryName IN (\"Austria\", \"Belgium\", \"Bulgaria\", \"Croatia\", \"Republic of Cyprus\", \"Czech Republic\", \\\n                    \"Denmark\", \"Estonia\", \"Finland\", \"France\", \"Germany\", \"Greece\", \"Hungary\", \"Ireland\", \"Italy\", \"Latvia\", \"Lithuania\",\\\n                    \"Luxembourg\", \"Malta\", \"Netherlands\", \"Poland\", \"Portugal\", \"Romania\", \"Slovakia\", \"Slovenia\", \"Spain\", \"Sweden\")\n                AND Year = 2012\n                ORDER BY 4 ASC;\"\"\",conn)\neu_debt","6537fa45":"# Visualizing debt of EU member states\nfig, ax = plt.subplots(figsize=(16,6))\ncolors = sns.color_palette('cubehelix_r',24)\nax = sns.barplot(x=\"CountryName\", y=\"Debt\", data=eu_debt, palette=colors)\n# ax.set_xticklabels(ax.get_xticklabels(),rotation=-90)\nax.set(ylabel='Central government debt, total (% of GDP)',xlabel=None)\nax.set_title('Debt of European Union Member States in 2012', fontsize = 16)\nfor ax in fig.axes:\n    for label in ax.get_xticklabels():\n        label.set_rotation(-90)\nfor p in ax.patches: # displaying percentages\n    height = p.get_height()\n    ax.text(p.get_x()+p.get_width()\/2., height+1, '{:.0f}%'.format(height), horizontalalignment='center', fontsize=12) \n      ","8cae42fe":"# European and Central Asian countries' level of CO2 emission per capita and their average CO2 emission\neu_central_asia_co2 = pd.read_sql(\"\"\" WITH co2_levels AS (\n                                        SELECT i.CountryName, i.Value AS CO2\n                                        FROM Indicators i\n                                        LEFT JOIN Country c\n                                        ON i.CountryCode = c.CountryCode\n                                        WHERE c.Region = 'Europe & Central Asia'\n                                        AND i.IndicatorName = 'CO2 emissions (metric tons per capita)'\n                                        AND i.Year = 2011\n                                        ORDER BY 2),\n\n                                        avg_level AS (             \n                                        SELECT AVG(CO2) AS Average_CO2\n                                        FROM co2_levels)\n\n                                      SELECT c.CountryName, c.CO2, Average_CO2, \n                                      CASE\n                                          WHEN c.CO2 > a.Average_CO2 THEN 'Yes'\n                                          WHEN c.CO2 < a.Average_CO2 THEN 'No'\n                                          WHEN c.CO2 = a.Average_CO2 THEN 'Average'\n                                      END AS Is_over_avg\n                                      FROM co2_levels c, avg_level a;\"\"\",conn)\neu_central_asia_co2","2a08454a":"sns.set_theme()\nfig, ax = plt.subplots(figsize=(20,12))\ncolors = sns.color_palette('cubehelix_r',60)\nax = sns.barplot(x=\"CountryName\", y=\"CO2\", data=eu_central_asia_co2,palette=colors)\nax = sns.lineplot(x=\"CountryName\", y=\"Average_CO2\", data=eu_central_asia_co2, label = 'Average CO2 level',color='red')\nax.set_xticklabels(ax.get_xticklabels(),rotation=-90)\nax.set(ylabel='CO2 Emissions (Metric Tons Per Capita)',xlabel=None)\nax.legend(fontsize='large')\nax.set_title('CO2 emissions per capita in Europe and Central Asia in 2011', fontsize = 16)\nfor ax in fig.axes:\n    for label in ax.get_xticklabels():\n        label.set_rotation(-90)\n","97b37fd5":"# European and Central Asian countries above average CO2 level in 2011 using CTEs (Common Table Expression)\n\npd.read_sql(\"\"\" WITH cte_co2_levels AS (\n                    SELECT i.CountryName, i.Value AS CO2\n                    FROM Indicators i\n                    LEFT JOIN Country c\n                    ON i.CountryCode = c.CountryCode\n                    WHERE c.Region = 'Europe & Central Asia'\n                    AND i.IndicatorName = 'CO2 emissions (metric tons per capita)'\n                    AND i.Year = 2011\n                    ORDER BY 2),\n\n                    cte_avg_level AS (             \n                    SELECT AVG(CO2) AS Average_CO2\n                    FROM cte_co2_levels)\n\n                 SELECT c.CountryName, c.CO2\n                 FROM cte_co2_levels c, cte_avg_level a\n                 WHERE c.CO2 > a.Average_CO2;\"\"\",conn)","39e91899":"ger_ind_per_year = pd.read_sql(\"\"\"  SELECT Year, COUNT(*) AS num_ind\n                                    FROM Indicators\n                                    WHERE CountryName = 'Germany'\n                                    GROUP BY Year;\"\"\",conn)\nger_ind_per_year","44067e2e":"# Visualizing indicators for Germany\nfig, ax = plt.subplots(figsize=(20,8))\ncolors = sns.color_palette('cubehelix_r',58)\nsns.barplot(x=\"Year\", y=\"num_ind\", data=ger_ind_per_year,palette=colors)\nax.set(ylabel='Number of Indicators',xlabel=None)\nax.set_title('Number of Indicators Per Year for Germany', fontsize = 16)\nfor ax in fig.axes:\n    for label in ax.get_xticklabels():\n        label.set_rotation(-90)","8051629b":"# Number of indicators present in 2013 but not present in 2014\npd.read_sql(\"\"\" WITH cte_ger_2013 AS (\n                    SELECT *\n                    FROM Indicators\n                    WHERE CountryName = 'Germany' AND Year = 2013\n                    ),\n\n                    cte_ger_2014 AS (\n                    SELECT *\n                    FROM Indicators\n                    WHERE CountryName = 'Germany' AND Year = 2014)\n                \n                SELECT COUNT(*) AS Num_ind\n                FROM cte_ger_2013 g_13\n                LEFT JOIN cte_ger_2014 g_14\n                USING (IndicatorName)\n                WHERE g_14.Value IS NULL;\"\"\", conn)","4d73612e":"# Saving land area of countries in South Asia\nland_south_asia = pd.read_sql(\"\"\" SELECT i.CountryName, i.Value\n                                    FROM Indicators i\n                                    LEFT JOIN Country c\n                                    USING (CountryCode)\n                                    WHERE c.Region = 'South Asia'\n                                    AND i.IndicatorName = 'Land area (sq. km)'\n                                    AND i.Year = 2010\n                                    ORDER BY 2;\"\"\",conn)\nland_south_asia","ba91835e":"# Visualizing the distribution of land area by country in South Asia\nland_south_asia['land_percent'] = round(land_south_asia.Value \/ land_south_asia.Value.sum() * 100,1)\nfig, ax = plt.subplots(figsize=(12,8))\ncolors=sns.color_palette('cubehelix',14)\nsns.barplot(x=\"CountryName\", y=\"land_percent\", data=land_south_asia,palette=colors)\nax.set(ylabel='Percentage of Total Land Area',xlabel=None)\nax.set_title('Distribution of Land Area of South Asian Countries', fontsize = 16)\nfor p in ax.patches: # displaying percentages\n    height = p.get_height()\n    ax.text(p.get_x()+p.get_width()\/2., height+1, '{:.1f}%'.format(height), horizontalalignment='center', fontsize=12) ","00b8b6a3":"### Question: What are the 10 smallest countries by population in 2014?","aa053513":"### Question: What are the countries with the 10 highest GDP per capita in 2014?","7c060c89":"### Question: How many indicators are \"lost\", i.e. <span style=\"color:red\">not<\/span> included about Germany in 2014 that were included in 2013?","002b76c3":"### Question: What are the countries with the highest GDP per capita per year from 2000 to 2014?","fc0bdf53":"### Display long definitions of six CO2-related indicators","229c28ee":"### Question: What is the number of different indicators per year for Germany?","ec4e440e":"# Retrieving basic data from tables","3898739c":"### Question: What indicators does the dataset have about different types of unemployment?","0872f544":"### Question: What is the indivitual level and the average level of CO2 emissions per capita by European and Central Asian countries?","3e97c442":"**Answer:** there are 208 indicators \"lost\" from 2013 to 2014 about Germany. ","de8428a7":"### Question: How many different indicators do countries have in 2014? Limit to top 20.","f6e306eb":"# Filtering, grouping","0f0227e7":"# Joining tables, CTEs, subqueries and aggregate functions","f72857dd":"### Question: How many countries are there by region including all years?","00f29570":"The following notebook serves the purpose of showcasing types of SQL queries made using a dataset about world development indicators.\n\nThe dataset can be accessed [here](https:\/\/www.kaggle.com\/worldbank\/world-development-indicators).\n","fc02cd29":"### What is the level of central government debt of European Union member states in 2012?","665e5021":"### Question: What is the distribution of land area of South Asian countries?","6e25f1ed":"#### Question: Which countries are above the average CO2 emission in Europe and Central Asia?","51187747":"Total number of indicators in the dataset: 1344","e88c13f4":"# Introduction","4005e280":"### Question: What are the countries with the 10 highest unemployment rates in 2014?"}}