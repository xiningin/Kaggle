{"cell_type":{"7f94c755":"code","c3ebe34b":"code","7bdb4ccb":"code","485a308d":"code","980c45ef":"code","093a2594":"code","3548a71b":"code","b1444103":"code","72782911":"code","88d5ace6":"code","ff6c61c6":"code","51d8b5f8":"code","3e3b540f":"code","5dfc39aa":"code","63a27219":"code","4fdde899":"code","c2b5f936":"code","ce23954b":"code","627b5664":"code","28c07165":"code","951fea31":"code","d30d5db6":"code","5ae30ca7":"code","5231739d":"code","6f418e48":"code","df6e1db7":"code","dd3c71f5":"code","aa9fcffd":"code","34b0b69f":"code","36aece73":"code","1a9cf30c":"code","d6c81eca":"code","7093ec30":"code","d37d7e43":"code","6c0a131e":"code","3f0c6b7e":"markdown","2e82cd22":"markdown","51bbc96b":"markdown","2ac64e1a":"markdown","6c45c589":"markdown","6df41c01":"markdown","64a9b5d9":"markdown","56c15fd7":"markdown","da2723df":"markdown","a4033dee":"markdown","26ed8a46":"markdown","37c6d8a3":"markdown","7eed49af":"markdown","f2e744ee":"markdown","c22895db":"markdown","1f2d1839":"markdown","ec40c19f":"markdown","3785c5a3":"markdown","1b8633ef":"markdown","c06a17dc":"markdown","782c5c0f":"markdown","529e6cd1":"markdown","8fe6aa5d":"markdown","ebe9402d":"markdown","c88c4978":"markdown","894d4a26":"markdown","3dc4f8fe":"markdown","bc13d249":"markdown","4849ca1b":"markdown","51ffe6d2":"markdown"},"source":{"7f94c755":"!pip install lucifer-ml","c3ebe34b":"import matplotlib.pyplot as plt\nplt.style.use('fivethirtyeight')\nplt.style.use('dark_background')\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\n#Importing LuciferML\nfrom luciferml.supervised.classification import Classification\n\n\nimport warnings\nwarnings.simplefilter(action='ignore', category=Warning)","7bdb4ccb":"dataset = pd.read_csv('..\/input\/heart-attack-analysis-prediction-dataset\/heart.csv')","485a308d":"dataset.head()","980c45ef":"dataset.shape","093a2594":"dataset.describe()\n","3548a71b":"dataset.info()","b1444103":"dataset.isnull().values.any()\n","72782911":"dataset['output'].agg(['count', 'size', 'nunique'])\n","88d5ace6":"pd.value_counts(dataset['output'])","ff6c61c6":"plt.figure(figsize=(12, 6))\nsns.countplot(x=\"output\", data=dataset, palette='magma');","51d8b5f8":"plt.figure(figsize=(18, 10))\nsns.countplot(x=dataset[\"age\"]);  # using countplot\nplt.title(\"Age to Count Plot\", fontsize=20)\nplt.xlabel(\"AGE\", fontsize=20)\nplt.ylabel(\"COUNT\", fontsize=20)\nplt.show();","3e3b540f":"plt.figure(figsize=(20, 17))\nmatrix = np.triu(dataset.corr())\nsns.heatmap(dataset.corr(), annot=True,\n            linewidth=.8, mask=matrix, cmap=\"rocket\");\n","5dfc39aa":"sns.catplot(x=\"sex\", data=dataset, kind=\"count\", hue=\"output\")\nsns.catplot(x=\"cp\", data=dataset, kind=\"count\", hue=\"output\")\nsns.catplot(x=\"fbs\", data=dataset, kind=\"count\", hue=\"output\")\nsns.catplot(x=\"restecg\", data=dataset, kind=\"count\", hue=\"output\")\nsns.catplot(x=\"exng\", data=dataset, kind=\"count\", hue=\"output\")\nsns.catplot(x=\"slp\", data=dataset, kind=\"count\", hue=\"output\")\nsns.catplot(x=\"caa\", data=dataset, kind=\"count\", hue=\"output\")\nsns.catplot(x=\"thall\", data=dataset, kind=\"count\", hue=\"output\");","63a27219":"sns.catplot(x=\"output\", y=\"age\", data=dataset, kind=\"box\")\nsns.catplot(x=\"output\", y=\"trtbps\", data=dataset, kind=\"box\")\nsns.catplot(x=\"output\", y=\"chol\", data=dataset, kind=\"box\")\nsns.catplot(x=\"output\", y=\"thalachh\", data=dataset, kind=\"box\")\nsns.catplot(x=\"output\", y=\"oldpeak\", data=dataset, kind=\"box\");","4fdde899":"chest_pain_count = dataset[\"cp\"].value_counts().reset_index()\nchest_pain_count","c2b5f936":"plt.figure(figsize=(20, 10))\n\nsns.barplot(x=chest_pain_count[\"index\"], y=chest_pain_count[\"cp\"]);\nplt.title(\"TYPE OF CHEST PAIN WITH NUMBER OF PATIENTS\", fontsize=20)\nplt.xlabel(\"CHEST PAIN TYPE\", fontsize=20)\nplt.ylabel(\"COUNT\", fontsize=20)\nplt.show();","ce23954b":"\nsns.displot(dataset[\"trtbps\"]) ;  #using displot here\nplt.title(\"DISTRIBUTION OF BLOOD PRESSURE AMONG PATIENTS\",fontsize=18)\nplt.xlabel(\"BLOOD PRESSURE\",fontsize=20)\nplt.ylabel(\"COUNT\",fontsize=20)\nplt.show();","627b5664":"\nsns.set_color_codes()\nsns.displot(dataset[\"chol\"], color=\"y\");\nplt.title(\"DISTRIBUTION OF CHOLESTROL LEVEL AMONG PATIENTS\", fontsize=18)\nplt.xlabel(\"CHOLESTROL LEVEL\", fontsize=20)\nplt.ylabel(\"COUNT\", fontsize=20)\nplt.show();\n","28c07165":"\nsns.displot(dataset[\"thalachh\"], color=\"blue\");\nplt.title(\"DISTRIBUTION OF HEART RATE AMONG PATIENTS\", fontsize=18)\nplt.xlabel(\"HEART RATE\", fontsize=20)\nplt.ylabel(\"COUNT\", fontsize=20)\nplt.show();\n","951fea31":"plt.figure(figsize=(12, 8))\n\nsns.histplot(data=dataset, x='age', hue='output');\nplt.title(\"AGE EFFECT ON THE HEART-ATTACK\")\nplt.xlabel(\"Age\")\nplt.ylabel(\"Count\")\nplt.show();\n","d30d5db6":"sns.pairplot(dataset, hue=\"output\", palette=\"husl\");","5ae30ca7":"features = dataset.iloc[:, 0:-1]\nlabels = dataset.iloc[:, -1]\n","5231739d":"features.shape, labels.shape","6f418e48":"accuracy_scores =  {}","df6e1db7":"params = {'C': 0.23357214690901212, 'penalty': 'l1', 'solver': 'saga'}\nclassifier =  Classification(predictor = 'lr', \n                                               params=params, lda = 'y',smote = 'y')\nclassifier.fit(features, labels)\nresult = classifier.result()\naccuracy_scores[result['Classifier']] = result['Accuracy']\n","dd3c71f5":"params = {'C': 0.004832930238571752, 'gamma': 0.7, 'kernel': 'sigmoid'}\nclassifier =  Classification(predictor = 'svm', \n                                               params=params, lda = 'y',smote = 'y')\nclassifier.fit(features, labels)\nresult = classifier.result()\naccuracy_scores[result['Classifier']] = result['Accuracy']\n","aa9fcffd":"params = {'algorithm': 'auto', 'n_jobs': 1, 'n_neighbors': 20, 'weights': 'uniform'}\nclassifier =  Classification(predictor = 'knn', \n                                               params=params, lda = 'y',smote = 'y')\nclassifier.fit(features, labels)\nresult = classifier.result()\naccuracy_scores[result['Classifier']] = result['Accuracy']\n","34b0b69f":"params = {'criterion': 'entropy', 'max_depth': 4, 'max_features': 3, 'splitter': 'best', 'random_state': 42}\n\nclassifier =  Classification(predictor = 'dt', params=params, smote = 'y')\nclassifier.fit(features, labels)\nresult = classifier.result()\naccuracy_scores[result['Classifier']] = result['Accuracy']\n","36aece73":"classifier =  Classification(predictor = 'nb', lda = 'y',smote = 'y')\nclassifier.fit(features, labels)\nresult = classifier.result()\naccuracy_scores[result['Classifier']] = result['Accuracy']\n","1a9cf30c":"params = {'criterion': 'gini', 'max_features': 'auto', 'n_estimators': 150,'random_state':0}\nclassifier =  Classification(predictor = 'rfc', params=params, lda = 'y',smote = 'y')\nclassifier.fit(features, labels)\nresult = classifier.result()\naccuracy_scores[result['Classifier']] = result['Accuracy']\n","d6c81eca":"params = {'learning_rate':0.02, 'n_estimators':600, 'objective':'binary:logistic', 'eval_metric':'logloss', 'nthread':-1}\nclassifier =  Classification(predictor = 'xgb',params=params, lda = 'y',smote = 'y')\nclassifier.fit(features, labels)\nresult = classifier.result()\naccuracy_scores[result['Classifier']] = result['Accuracy']\n","7093ec30":"classifier =  Classification(predictor = 'ann', params=params, lda = 'y',smote = 'y')\nclassifier.fit(features, labels)\nresult = classifier.result()\naccuracy_scores[result['Classifier']] = result['Accuracy']\n","d37d7e43":"maxKey = max(accuracy_scores, key=lambda x: accuracy_scores[x])\nprint('The model with highest K-Fold Validation Accuracy score is  {0} with an accuracy of  {1:.2f}'.format(\n    maxKey, accuracy_scores[maxKey]))\n","6c0a131e":"plt.figure(figsize=(12, 6))\nmodel_accuracies = list(accuracy_scores.values())\nmodel_names = list(accuracy_scores.keys())\nsns.barplot(x=model_accuracies, y=model_names, palette='YlOrBr');\n","3f0c6b7e":"<div style=\"color:white;\n           display:fill;\n           border-radius:15px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:#f56f42;\n           color:Black;\n           font-family:cursive;\n            padding:5px 5px 5px 5px;\n           \">\n<h1 style=\"text-align:center;font-weight: bold\">\ud83c\udf89And the Winner is\ud83c\udf89<\/h1>\n<h2 style=\"text-align:center;font-weight: bold\">XGBoost Classifier<\/h2>\n<\/div>\n\n\n\n\n\n","2e82cd22":"<div style=\"color:white;\n           display:fill;\n           border-radius:15px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:#f56f42;\n           color:Black;\n           font-family:cursive;\n            padding:5px 5px 5px 5px;\n           \">\n<h3 style=\"text-align:center;font-weight: bold\">Support Vector Machine<\/h3><\/div>\n\n","51bbc96b":"<div style=\"color:white;\n           display:fill;\n           border-radius:15px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:#f56f42;\n           color:Black;\n           font-family:cursive;\n            padding:5px 5px 5px 5px;\n           \">\n<h1 style=\"text-align:center;font-weight: bold\">Importing Libraries<\/h1><\/div>\n\n","2ac64e1a":"\n<div style=\"color:white;\n           display:fill;\n           border-radius:15px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:#f56f42;\n           color:Black;\n           font-family:cursive;\n            padding:5px 5px 5px 5px;\n           \">\n<h1 style=\"text-align:center;font-weight: bold\">Finding which classifier performed best<\/h1><\/div>\n\n\n","6c45c589":"<div style=\"color:white;\n           display:fill;\n           border-radius:15px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:#f56f42;\n           color:Black;\n           font-family:cursive;\n            padding:5px 5px 5px 5px;\n           \">\n<h1 style=\"text-align:center;font-weight: bold\">Training Models<\/h1><\/div>\n\n","6df41c01":"<div style=\"color:white;\n           display:fill;\n           border-radius:15px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:#f56f42;\n           color:Black;\n           font-family:cursive;\n            padding:5px 5px 5px 5px;\n           \">\n<h1 style=\"text-align:center;font-weight: bold\">Please share your feedback in the comment section. I'll be more than happy to hear ya'll and If you liked my work and learned from it Please Consider Upvoting.<\/h1>\n\n<\/div>\n\n\n\n","64a9b5d9":"<div style=\"color:white;\n           display:fill;\n           border-radius:10px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:#f56f42;\n           color:Black;\n           font-family:cursive;\n            padding:5px 5px 5px 5px;\n           \">\n<h1 style=\"text-align:center;font-weight: bold;\">Symptoms<\/h1>\n    <h3 style=\"text-align:center;font-weight: bold\">Symptoms of a heart attack include:\n\n<ul>\n<li>Discomfort, pressure, tightness, squeezing, or pain in your chest or arm or below your breastbone<\/li>\n<li>Discomfort that goes into your back, jaw, throat, or arm<\/li>\n<li>Fullness, indigestion, or a choking feeling (it may feel like heartburn)<\/li>\n<li>Sweating, upset stomach, vomiting, or dizziness<\/li>\n<\/ul>\n\n\n\n<\/h3>\n\n\n<\/div>\n\n\n\n","56c15fd7":"<div style=\"color:white;\n           display:fill;\n           border-radius:10px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:#f56f42;\n           color:Black;\n           font-family:cursive;\n            padding:5px 5px 5px 5px;\n           \">\n<h1 style=\"text-align:center;font-weight: bold;\">What is Heart Attack?<\/h1>\n    <h3 style=\"text-align:center;font-weight: bold\">A heart attack happens when something blocks the blood flow to your heart so it can\u2019t get the oxygen it needs.<\/h3>\n\n\n<\/div>\n\n\n\n","da2723df":"<div style=\"color:white;\n           display:fill;\n           border-radius:15px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:#f56f42;\n           color:Black;\n           font-family:cursive;\n            padding:5px 5px 5px 5px;\n           \">\n<h3 style=\"text-align:center;font-weight: bold\">Training XGBoost Classification<\/h3><\/div>\n\n","a4033dee":"<div style=\"color:white;\n           display:fill;\n           border-radius:15px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:#f56f42;\n           color:Black;\n           font-family:cursive;\n            padding:5px 5px 5px 5px;\n           \">\n<h1 style=\"text-align:center;font-weight: bold\">Visualising Categorical Data<\/h1><\/div>\n\n","26ed8a46":"<div style=\"color:white;\n           display:fill;\n           border-radius:15px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:#f56f42;\n           color:Black;\n           font-family:cursive;\n            padding:5px 5px 5px 5px;\n           \">\n<h3 style=\"text-align:center;font-weight: bold\">Training Decision Trees<\/h3><\/div>\n\n","37c6d8a3":"People age above 40 and below 68 are more likely to get heart attack. People at the age of 58 are highly prone to heart attacks.","7eed49af":"<div style=\"color:white;\n           display:fill;\n           border-radius:15px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:#f56f42;\n           color:Black;\n           font-family:cursive;\n            padding:5px 5px 5px 5px;\n           \">\n<h3 style=\"text-align:center;font-weight: bold\">Training Neural Network<\/h3><\/div>\n\n","f2e744ee":"## Finding Correlation among the variables","c22895db":"<div style=\"color:white;\n           display:fill;\n           border-radius:15px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:#f56f42;\n           color:Black;\n           font-family:cursive;\n            padding:5px 5px 5px 5px;\n           \">\n<h3 style=\"text-align:center;font-weight: bold\">Training Logistic Regression<\/h3><\/div>\n\n","1f2d1839":"![](https:\/\/media3.giphy.com\/media\/8cBhJBU2wlq6H6qY4W\/giphy.gif)\n[Source](https:\/\/media3.giphy.com\/media\/8cBhJBU2wlq6H6qY4W\/giphy.gif)","ec40c19f":"<div style=\"color:white;\n           display:fill;\n           border-radius:10px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:#f56f42;\n           color:Black;\n           font-family:cursive;\n            padding:5px 5px 5px 5px;\n           \">\n<h1 style=\"text-align:center;font-weight: bold;\">CPR<\/h1>\n<\/div>\n\n![](https:\/\/thumbs.gfycat.com\/EssentialKeenEastrussiancoursinghounds-max-1mb.gif)\n\n","3785c5a3":"<div style=\"color:white;\n           display:fill;\n           border-radius:15px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:#f56f42;\n           color:Black;\n           font-family:cursive;\n            padding:5px 5px 5px 5px;\n           \">\n<h3 style=\"text-align:center;font-weight: bold\">Training Gaussian Naive Bayes<\/h3><\/div>\n\n","1b8633ef":"<div style=\"color:white;\n           display:fill;\n           border-radius:15px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:#f56f42;\n           color:Black;\n           font-family:cursive;\n            padding:5px 5px 5px 5px;\n           \">\n<h1 style=\"text-align:center;font-weight: bold\">Exploratory Data Analysis<\/h1><\/div>\n\n","c06a17dc":"### Yayy!!! No Null Values","782c5c0f":"<div style=\"color:white;\n           display:fill;\n           border-radius:10px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:#f56f42;\n           color:Black;\n           font-family:cursive;\n            padding:5px 5px 5px 5px;\n           \">\n<h1 style=\"text-align:center;font-weight: bold;\">Heart Attack\ud83d\udc94 Prediction.<\/h1>\n\n\n<\/div>\n\n\n\n","529e6cd1":"<div style=\"color:white;\n           display:fill;\n           border-radius:15px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:#f56f42;\n           color:Black;\n           font-family:cursive;\n            padding:5px 5px 5px 5px;\n           \">\n<h3 style=\"text-align:center;font-weight: bold\">Training Random Forest Classification<\/h3><\/div>\n\n","8fe6aa5d":"<div style=\"color:white;\n           display:fill;\n           border-radius:10px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:#f56f42;\n           color:Black;\n           font-family:cursive;\n            padding:5px 5px 5px 5px;\n           \">\n<h1 style=\"text-align:center;font-weight: bold;\">First Aid<\/h1>\n    <h3 style=\"text-align:center;font-weight: bold\">1) Call Ambulance Helpline<\/h3>\n    <h3 style=\"text-align:center;font-weight: bold\">2) Apply CPR<\/h3>\n   \n\n<\/div>\n\n\n\n","ebe9402d":"<div style=\"color:white;\n           display:fill;\n           border-radius:15px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:#f56f42;\n           color:Black;\n           font-family:cursive;\n            padding:5px 5px 5px 5px;\n           \">\n<h1 style=\"text-align:center;font-weight: bold\">LuciferML<\/h1>\n    <h3 style=\"text-align:center;font-weight: bold\">This is my own ML-Library whose purpose is to take away all your hassles and does all the hard work for you. It's currently in development stage. Preprocesses and Trains different models on your Data. More about LuciferML <a href = \"https:\/\/github.com\/d4rk-lucif3r\/LuciferML\">here<\/a><\/h3>\n    \n\n<\/div>\n\n","c88c4978":"<div style=\"color:white;\n           display:fill;\n           border-radius:15px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:#f56f42;\n           color:Black;\n           font-family:cursive;\n            padding:5px 5px 5px 5px;\n           \">\n<h1 style=\"text-align:center;font-weight: bold\">Data Preprocessing<\/h1><\/div>\n\n","894d4a26":"<div style=\"color:white;\n           display:fill;\n           border-radius:15px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:#f56f42;\n           color:Black;\n           font-family:cursive;\n            padding:5px 5px 5px 5px;\n           \">\n<h1 style=\"text-align:center;font-weight: bold\">Visualising Numerical Data<\/h1><\/div>\n\n","3dc4f8fe":"<div style=\"color:white;\n           display:fill;\n           border-radius:15px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:#f56f42;\n           color:Black;\n           font-family:cursive;\n            padding:5px 5px 5px 5px;\n           \">\n<h3 style=\"text-align:center;font-weight: bold\">K-Nearest Neighbours<\/h3><\/div>\n\n","bc13d249":"<div style=\"color:white;\n           display:fill;\n           border-radius:10px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:#f56f42;\n           color:Black;\n           font-family:cursive;\n            padding:5px 5px 5px 5px;\n           \">\n<h1 style=\"text-align:center;font-weight: bold;\">Do you know?<\/h1>\n    <h3 style=\"text-align:center;font-weight: bold\">1) Each day, your heart \u2665 pumps about 2,000 gallons of blood.<\/h3>\n    <h3 style=\"text-align:center;font-weight: bold\">2) If you were to stretch out your blood vessel system, it would extend over 60,000 miles.<\/h3>\n    <h3 style=\"text-align:center;font-weight: bold\">3) A woman\u2019s heart beats slightly faster than a man\u2019s.<\/h3>\n\n<\/div>\n\n\n\n","4849ca1b":"<div style=\"color:white;\n           display:fill;\n           border-radius:15px;\n           font-size:110%;\n           font-family:cursive;\n           letter-spacing:0.5px;\n           background-color:#f56f42;\n           color:Black;\n           font-family:cursive;\n            padding:5px 5px 5px 5px;\n           \">\n<h1 style=\"text-align:center;font-weight: bold\">Importing Dataset<\/h1><\/div>\n\n","51ffe6d2":"## Inference\n- In general, 40 to 58 aged people have more chance of heart attack.\n- Most Common Chest Pain - Non-anginal type\n- Resting Blood Pressure - range of 120 to 140\n- Cholesterol level - 200 to 260"}}