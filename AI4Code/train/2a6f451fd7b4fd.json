{"cell_type":{"21b4cfac":"code","52b470ca":"code","9b352756":"code","4b7cd8db":"code","dc3c9e42":"code","2de161e1":"code","8bc00fa2":"code","185d362d":"code","f50704bc":"markdown","4e3de871":"markdown"},"source":{"21b4cfac":"import numpy as np\nimport pandas as pd\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LinearRegression\nfrom seaborn import regplot \nimport matplotlib.pyplot as plt","52b470ca":"df = pd.read_csv('..\/input\/wine-whitered\/Wine_red.csv', sep=';')\ndf.head()","9b352756":"regplot(x='density',y='quality',data=df)","4b7cd8db":"(df_train,df_test) = train_test_split(df,\n                                     train_size=0.8,\n                                     test_size=0.2,\n                                     random_state =0)","dc3c9e42":"feature_train = df_train.iloc[:,0]","2de161e1":"feature_train.values.reshape(-1,1).shape","8bc00fa2":"df.columns[0]","185d362d":"lr = LinearRegression()\n\nfeature_name = []\nR2_train = []\nR2_test = []\n\ntarget_train = df_train.iloc[:,-1]\ntarget_test = df_test.iloc[:,-1]\n\nfor k in range(df.shape[1]-1):\n    feature_train = df_train.iloc[:,k]\n    feature_test = df_test.iloc[:,k]\n    lr.fit(feature_train.values.reshape(-1,1),target_train)\n    feature_name.append(df.columns[k])\n    R2_train.append(lr.score(feature_train.values.reshape(-1,1),target_train))\n    R2_test.append(lr.score(feature_test.values.reshape(-1,1),target_test))\n    \nresults =pd.DataFrame()\nresults['feature'] = feature_name\nresults['train R2'] = R2_train\nresults['test R2'] = R2_test\nresults.sort_values('test R2',ascending = False).head(5)","f50704bc":"## Determine the importance of each feature for predicting the quality of red wine. Compute train adn test R2 for each feature","4e3de871":"## Example (Simple Linear Regression for Red Wine)"}}