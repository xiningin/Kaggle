{"cell_type":{"d7fcbf09":"code","9e0e0eb1":"code","17c92272":"code","cb3ed604":"code","7665ded2":"code","e940894a":"code","2c3dde72":"code","775a6323":"code","318d96dd":"code","808b472d":"code","1fb3c1b2":"code","369249b7":"code","3445c6c9":"code","531a9034":"code","17867e07":"code","e624e191":"code","c00cd632":"code","d0628323":"code","5363a97c":"code","e0c2ff71":"code","c7a4f637":"code","fed0f33d":"code","4e623be1":"code","fc5f8b3e":"code","46bd6264":"code","a173c438":"code","dcebd9b6":"code","f444b20c":"code","e5a8bdf8":"code","d5863951":"code","d02b5ed9":"code","84706b99":"code","67d9d509":"code","88ed70eb":"code","96ef7ef0":"markdown","5d61e4fa":"markdown","b0081451":"markdown","dd04040f":"markdown","2ff3cc9d":"markdown","d18d9472":"markdown","248602d7":"markdown","ee90b2e0":"markdown"},"source":{"d7fcbf09":"# Importanto os pacotes que ser\u00e3o utilizados\n\nimport numpy as np \nimport pandas as pd \nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport geopandas as gpd\nimport plotly.express as px\nimport fiona\n\nimport warnings\nwarnings.filterwarnings('ignore')\n\nimport plotly.graph_objects as go\nimport folium\nimport matplotlib.patches as mpatches\nimport matplotlib.colors as mcolors\n\nfrom matplotlib.colors import ListedColormap\n\nfrom fbprophet import Prophet\nimport random\nfrom datetime import timedelta\nfrom fbprophet.plot import add_changepoints_to_plot\n","9e0e0eb1":"import os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","17c92272":"# Curva de casos no Mundo e ao longo do tempo\n\n# Carregando os dados\ndf = pd.read_csv('..\/input\/novel-corona-virus-2019-dataset\/covid_19_data.csv',parse_dates=['Last Update'])\ndf_confirmed = pd.read_csv(\"\/kaggle\/input\/novel-corona-virus-2019-dataset\/time_series_covid_19_confirmed.csv\")\n\n# Preprocessamento\n\n# Renomeando colunas\ndf.rename(columns={'ObservationDate':'Date', 'Country\/Region':'Country'}, inplace=True)\ndf_confirmed.rename(columns={'Country\/Region':'Country'}, inplace=True)\n\n# Filtrando Dataframe\ndf_confirmed = df_confirmed[[\"Province\/State\",\"Lat\",\"Long\",\"Country\"]]","cb3ed604":"print(\"Primeiro vamos plotar a curva de casos pelo tempo que ilustra a evolu\u00e7a\u00f5 da pandemia no mundo\")\n# Dataframes auxiliares\nconfirmed = df.groupby(['Date']).sum()['Confirmed'].reset_index()\ndeaths = df.groupby(['Date']).sum()['Deaths'].reset_index()\nrecovered = df.groupby(['Date']).sum()['Recovered'].reset_index()\n\nfig = go.Figure()\nfig.add_trace(go.Scatter(x=confirmed['Date'], \n                         y=confirmed['Confirmed'],\n                         mode='lines+markers',\n                         name='Confirmados',\n                         line=dict(color='blue', width=2)\n                        ))\nfig.add_trace(go.Scatter(x=deaths['Date'], \n                         y=deaths['Deaths'],\n                         mode='lines+markers',\n                         name='Mortos',\n                         line=dict(color='Red', width=2)\n                        ))\nfig.add_trace(go.Scatter(x=recovered['Date'], \n                         y=recovered['Recovered'],\n                         mode='lines+markers',\n                         name='Recuperados',\n                         line=dict(color='Green', width=2)\n                        ))\nfig.update_layout(\n    title='Evolu\u00e7\u00e3o Global da Pandemia de Coronavirus',\n    xaxis_tickfont_size=14,\n    yaxis=dict(\n        title='N\u00e9muro de Casos',\n        titlefont_size=16,\n        tickfont_size=14,\n    ),\n    legend=dict(\n        x=0,\n        y=1.0,\n        bgcolor='rgba(255, 255, 255, 0)',\n        bordercolor='rgba(255, 255, 255, 0)'\n    )\n)\nfig.show()","7665ded2":"print(\"Agora a pr\u00f3xima d\u00favida natural ao visualizar este grafico \u00e9 quais pa\u00edses e quando eles foram mais afetados pela pandemia?\")\n\n\n# Curva de casos \n\nplt.figure(figsize=(16, 10))\nteste_curvas = df.copy()\nteste_curvas['Country'].replace({'Mainland China': 'China'}, inplace=True)\nteste_curvas = teste_curvas.groupby(['Country','Date']).sum()['Confirmed'].reset_index()\nteste_curvas['Date'] = pd.to_datetime(teste_curvas['Date'], format='%m\/%d\/%Y')\n\n# Filtro Pais -> US\ntemp_pais = teste_curvas[['Date', 'Confirmed']][teste_curvas['Country'] == 'US']\nplt.plot(temp_pais['Date'], temp_pais['Confirmed'])\n\n# Filtro Pais -> Italy\ntemp_pais = teste_curvas[['Date', 'Confirmed']][teste_curvas['Country'] == 'Italy']\nplt.plot(temp_pais['Date'], temp_pais['Confirmed'])\n\n# Filtro Pais -> China\ntemp_pais = teste_curvas[['Date', 'Confirmed']][teste_curvas['Country'] == 'China']\nplt.plot(temp_pais['Date'], temp_pais['Confirmed'])\n\n# Filtro Pais -> Russia\ntemp_pais = teste_curvas[['Date', 'Confirmed']][teste_curvas['Country'] == 'Russia']\nplt.plot(temp_pais['Date'], temp_pais['Confirmed'])\n\n# Filtro Pais -> Brazil\ntemp_pais = teste_curvas[['Date', 'Confirmed']][teste_curvas['Country'] == 'Brazil']\nplt.plot(temp_pais['Date'], temp_pais['Confirmed'])\n\n# Filtro Pais -> India\ntemp_pais = teste_curvas[['Date', 'Confirmed']][teste_curvas['Country'] == 'India']\nplt.plot(temp_pais['Date'], temp_pais['Confirmed'])\n\nplt.title('Curva de casos confirmados de Covid-19 por Pa\u00eds', size=30)\nplt.xlabel('Data', size=5)\nplt.ylabel('Quantidade de Casos', size=30)\nplt.legend(['US', 'Italia', 'China', 'Russia', 'Brasil', 'India'], prop={'size': 20})\nplt.xticks(size=20)\nplt.yticks(size=20)\nplt.show()","e940894a":"print(\"Agora a curva de \u00f3bitos ocorridos em decorrencia do contagio com da covid-19...\")\n\n# CURVA DISTINTA POR PAIS, pode ser pros 10 maiores\n\nplt.figure(figsize=(16, 10))\nteste_curvas = df.copy()\nteste_curvas['Country'].replace({'Mainland China': 'China'}, inplace=True)\nteste_curvas = teste_curvas.groupby(['Country','Date']).sum()['Deaths'].reset_index()\nteste_curvas['Date'] = pd.to_datetime(teste_curvas['Date'], format='%m\/%d\/%Y')\n\n# Filtro Pais\ntemp_pais = teste_curvas[['Date', 'Deaths']][teste_curvas['Country'] == 'US']\nplt.plot(temp_pais['Date'], temp_pais['Deaths'])\n\n# Filtro Pais\ntemp_pais = teste_curvas[['Date', 'Deaths']][teste_curvas['Country'] == 'Italy']\nplt.plot(temp_pais['Date'], temp_pais['Deaths'])\n\n# Filtro Pais\ntemp_pais = teste_curvas[['Date', 'Deaths']][teste_curvas['Country'] == 'China']\nplt.plot(temp_pais['Date'], temp_pais['Deaths'])\n\n# Filtro Pais\ntemp_pais = teste_curvas[['Date', 'Deaths']][teste_curvas['Country'] == 'Russia']\nplt.plot(temp_pais['Date'], temp_pais['Deaths'])\n\n# Filtro Pais\ntemp_pais = teste_curvas[['Date', 'Deaths']][teste_curvas['Country'] == 'Brazil']\nplt.plot(temp_pais['Date'], temp_pais['Deaths'])\n\n# Filtro Pais\ntemp_pais = teste_curvas[['Date', 'Deaths']][teste_curvas['Country'] == 'India']\nplt.plot(temp_pais['Date'], temp_pais['Deaths'])\n\nplt.title('Curva de mortes confirmadas de \u00f3bitos causados pela Covid-19 por Pa\u00eds', size=30)\nplt.xlabel('Data', size=30)\nplt.ylabel('Quantidade de Casos', size=30)\nplt.legend(['US', 'Italia', 'China', 'Russia', 'Brasil', 'India'], prop={'size': 20})\nplt.xticks(size=20)\nplt.yticks(size=20)\nplt.show()","2c3dde72":"print(\"Neste vis\u00e3o alternativa \u00e9 possivel observar a dissemina\u00e7\u00e3o do virus apelo tempo, alguns pa\u00edses tiveram os primeiros casos da doen\u00e7a tardiamente, mas isso n\u00e3o \u00e9 determinante para a quantidade de casos que ser\u00e3o registrados naquele pa\u00eds.\")\n# Dataframe com latitue e longitute\ndf_temp = df.copy()\ndf_temp['Country'].replace({'Mainland China': 'China'}, inplace=True)\n\n# Confirmados\ndf_temp = df_temp.groupby(['Country','Date']).sum()['Confirmed'].reset_index()\ndf_confirmed = df_confirmed.drop_duplicates(subset=['Country'])\ndf_temp_estado = pd.merge(df_temp, df_confirmed[[\"Lat\",\"Long\",\"Country\"]], on=[\"Country\"])\ndf_temp_estado['Lat'][df_temp_estado.Country == 'France'] = 46.1390\ndf_temp_estado['Long'][df_temp_estado.Country == 'France'] = -2.4351\n\nfig = px.density_mapbox(df_temp_estado, \n                        z='Confirmed',\n                        lat=\"Lat\", \n                        lon=\"Long\", \n                        hover_name=\"Country\", \n                        hover_data=[\"Confirmed\"],   # ,\"Deaths\",\"Recovered\"], \n                        animation_frame=\"Date\",\n                        #color_continuous_scale=\"Portland\",\n                        range_color =[0, 200000],\n                        radius=30, \n                        zoom=1.8,height=900)\nfig.update_layout(title='Casos Confirmados Mundo Afora',\n                  font=dict(family=\"Courier New, monospace\",\n                            size=18,\n                            color=\"#7f7f7f\")\n                 )\nfig.update_layout(mapbox_style=\"open-street-map\", mapbox_center_lon=0)\nfig.update_layout(margin={\"r\":0,\"t\":0,\"l\":0,\"b\":0})\n\n\nfig.show()","775a6323":"# Mapa de Calor de \u00f3bitos ao longo do tempo\n\n# Dataframe com latitue e longitute\ndf_temp = df.copy()\ndf_temp['Country'].replace({'Mainland China': 'China'}, inplace=True)\n\n# Deaths\ndf_temp = df_temp.groupby(['Country','Date']).sum()['Deaths'].reset_index()\ndf_confirmed = df_confirmed.drop_duplicates(subset=['Country'])\ndf_temp_estado = pd.merge(df_temp, df_confirmed[[\"Lat\",\"Long\",\"Country\"]], on=[\"Country\"])\ndf_temp_estado['Lat'][df_temp_estado.Country == 'France'] = 46.1390\ndf_temp_estado['Long'][df_temp_estado.Country == 'France'] = -2.4351\n\nfig = px.density_mapbox(df_temp_estado, \n                        z='Deaths',\n                        lat=\"Lat\", \n                        lon=\"Long\", \n                        hover_name=\"Country\", \n                        hover_data=[\"Deaths\"],   # ,\"Deaths\",\"Recovered\"], \n                        animation_frame=\"Date\",\n                        #color_continuous_scale=\"Portland\",\n                        range_color =[0,20000],\n                        radius=30, \n                        zoom=1.8,height=900)\nfig.update_layout(title='\u00d3bitos Confirmados Mundo Afora',\n                  font=dict(family=\"Courier New, monospace\",\n                            size=18,\n                            color=\"#7f7f7f\")\n                 )\nfig.update_layout(mapbox_style=\"open-street-map\", mapbox_center_lon=0)\nfig.update_layout(margin={\"r\":0,\"t\":0,\"l\":0,\"b\":0})\n\n\nfig.show()","318d96dd":"# Caratecisticas regionais das cidades\npath = '\/kaggle\/input\/am091-dataset\/infraestrutura_saude.csv'\ninfra_saude = pd.read_csv(path, sep =';')\n\n# Ministerio da Saude Casos e Mortes\npath_min_saude = '\/kaggle\/input\/am091-dataset\/casos_covid_min_saude.csv'\nmin_saude = pd.read_csv(path_min_saude,sep =';', encoding='utf-8')\nmin_saude.tail()\n\n# Carregando o mapa\npath_mapa = '\/kaggle\/input\/mapas-brasil\/bcim_2016_21_11_2018.gpkg'\nmapa = gpd.read_file(path_mapa, layer = 'lim_municipio_a')\nmapa.rename(columns={'geocodigo':'codigo_municipio_completo'}, inplace=True)\nmapa['codigo_municipio_completo'] =mapa['codigo_municipio_completo'].astype(np.float) \n#fiona.listlayers(path_mapa)","808b472d":"aux = infra_saude['populacao'] \/ 10000\ninfra_saude['Leitos por 10 mil Habitantes antes da pandemia'] = infra_saude['leitos_uti_fev'] \/ aux \ninfra_saude['Leitos por 10 mil Habitantes depois da pandemia'] = infra_saude['leitos_uti_jun'] \/ aux \n\n# Aderencia recomenda\u00e7\u00e3o da OMS antes da pandemia\narray = []\n\nfor i in range(0,len(infra_saude)):\n    if infra_saude['Leitos por 10 mil Habitantes antes da pandemia'][i]>= 1 : a = 'Sim'\n    else: a = 'Nao'\n    array.append(a)\n\ninfra_saude['Atende recomenda\u00e7\u00e3o da OMS para Leitos de Uti'] = array\n\n# Aderencia recomenda\u00e7\u00e3o da OMS durante a pandemia\narray = []\n\nfor i in range(0,len(infra_saude)):\n    if infra_saude['Leitos por 10 mil Habitantes depois da pandemia'][i]>= 1 : a = 'Sim'\n    else: a = 'Nao'\n    array.append(a)\n\ninfra_saude['Atende recomenda\u00e7\u00e3o da OMS para Leitos de Uti depois da pandemia?'] = array\n\n# Adiciona os objetos do mapa\nmapa_leito = pd.merge(mapa, infra_saude, on = ['codigo_municipio_completo'])","1fb3c1b2":"# Mapa atendia oms antes da pandemia\n\nfig, ax = plt.subplots(figsize=(10, 10))\n\nax.set_title('Municipios aderentes \u00e0 recomenda\u00e7\u00e3o da OMS antes da pandemia', \n             pad = 20, \n             fontdict={'fontsize':20})\n\nred_patch = mpatches.Patch(color='purple', label='N\u00e3o atende \u00e0 recomenda\u00e7\u00e3o da OMS')\nyellow_path = mpatches.Patch(color='yellow', label='Atende \u00e0 recomenda\u00e7\u00e3o da OMS')\n\n\nplt.xlabel('Latitude')\nplt.ylabel('Longitude')\n\nplt.legend(handles=[red_patch,yellow_path ])\n\n\nmapa_leito.plot(column= 'Atende recomenda\u00e7\u00e3o da OMS para Leitos de Uti', cmap='viridis', ax=ax)\nplt.show()\n\n\nlabels = [\"Sim\",\"Nao\"]\nvalues = [len(infra_saude['Atende recomenda\u00e7\u00e3o da OMS para Leitos de Uti'][infra_saude['Atende recomenda\u00e7\u00e3o da OMS para Leitos de Uti']=='Sim']), len(infra_saude['Atende recomenda\u00e7\u00e3o da OMS para Leitos de Uti'][infra_saude['Atende recomenda\u00e7\u00e3o da OMS para Leitos de Uti']=='Nao'])]\n\n\nfig = px.pie(infra_saude, values=values, names=labels, color_discrete_sequence=['darkblue','green'], hole=0.5)\nfig.update_layout(\n    title='Porcentagem de Municipios que atendem \u00e0 recomenda\u00e7\u00e3o durante a pandemia',\n)\nfig.show()","369249b7":"# Grafico de mapa atendia oms depois da pandemia\n\nfig, ax = plt.subplots(figsize=(10, 10))\n\nax.set_title('Municipios aderentes \u00e0 recomenda\u00e7\u00e3o da OMS durante a pandemia', \n             pad = 20, \n             fontdict={'fontsize':20})\n\nred_patch = mpatches.Patch(color='purple', label='N\u00e3o atende \u00e0 recomenda\u00e7\u00e3o da OMS')\nyellow_path = mpatches.Patch(color='yellow', label='Atende \u00e0 recomenda\u00e7\u00e3o da OMS')\nplt.xlabel('Latitude')\nplt.ylabel('Longitude')\nplt.legend(handles=[red_patch,yellow_path ])\n\n\nmapa_leito.plot(column= 'Atende recomenda\u00e7\u00e3o da OMS para Leitos de Uti depois da pandemia?', cmap='viridis', ax=ax)\nplt.show()\n\n\nlabels = [\"Sim\",\"Nao\"]\nvalues = [len(infra_saude['Atende recomenda\u00e7\u00e3o da OMS para Leitos de Uti depois da pandemia?'][infra_saude['Atende recomenda\u00e7\u00e3o da OMS para Leitos de Uti depois da pandemia?']=='Sim']), len(infra_saude['Atende recomenda\u00e7\u00e3o da OMS para Leitos de Uti depois da pandemia?'][infra_saude['Atende recomenda\u00e7\u00e3o da OMS para Leitos de Uti depois da pandemia?']=='Nao'])]\n\n\nfig = px.pie(infra_saude, values=values, names=labels, color_discrete_sequence=['darkred','green'], hole=0.5)\nfig.update_layout(\n    title='Porcentagem de Municipios que atendem \u00e0 recomenda\u00e7\u00e3o durante a pandemia',\n)\nfig.show()","3445c6c9":"# 20 microrregi\u00f5es com mais leitos uti geral\ntemp = infra_saude.groupby(['cod_microregiao', 'nome_microrregiao', 'nome_uf']).sum()['leitos_uti_jun'].reset_index()\n\ntemp['nome'] = temp['nome_microrregiao'] +' - '+temp['nome_uf']\ntemp = temp[['leitos_uti_jun', 'nome']].sort_values(by = ['leitos_uti_jun'],ascending = False)[:20].reset_index(drop=True)\n\n\nfig = go.Figure(data=[go.Bar(\n            x=temp['nome'][0:20], y=temp['leitos_uti_jun'][0:20],\n            text=temp['leitos_uti_jun'][0:20],\n            textposition='auto',\n            marker_color='black',\n            \n\n        )])\nfig.update_layout(\n    title='20 maiores Microrregi\u00f5es em Leitos de UTI em Junho de 2020',\n    xaxis_title=\"Microregi\u00f5es\",\n    yaxis_title=\"Leitos de UTI\",\n        template='plotly_white'\n\n)\nfig.show()","531a9034":"# 20 microrregi\u00f5es com mais leitos uti covid\ntemp = infra_saude.groupby(['cod_microregiao', 'nome_microrregiao', 'nome_uf']).sum()['leitos_covid_junho'].reset_index()\n\ntemp['nome'] = temp['nome_microrregiao'] +' - '+temp['nome_uf']\ntemp = temp[['leitos_covid_junho', 'nome']].sort_values(by = ['leitos_covid_junho'],ascending = False)[:20].reset_index(drop=True)\n\n\nfig = go.Figure(data=[go.Bar(\n            x=temp['nome'][0:20], y=temp['leitos_covid_junho'][0:20],\n            text=temp['leitos_covid_junho'][0:20],\n            textposition='auto',\n            marker_color='black',\n            \n\n        )])\nfig.update_layout(\n    title='20 maiores Microrregi\u00f5es em Leitos de UTI especificos para Covid-19 em Junho de 2020',\n    xaxis_title=\"Microregi\u00f5es\",\n    yaxis_title=\"Leitos de UTI espec. Covid-19\",\n        template='plotly_white'\n\n)\nfig.show()","17867e07":"# 20 microrregi\u00f5es com mais respiradores\ntemp = infra_saude.groupby(['cod_microregiao', 'nome_microrregiao', 'nome_uf']).sum()['respiradores_junho'].reset_index()\n\ntemp['nome'] = temp['nome_microrregiao'] +' - '+temp['nome_uf']\ntemp = temp[['respiradores_junho', 'nome']].sort_values(by = ['respiradores_junho'],ascending = False)[:20].reset_index(drop=True)\n\n\nfig = go.Figure(data=[go.Bar(\n            x=temp['nome'][0:20], y=temp['respiradores_junho'][0:20],\n            text=temp['respiradores_junho'][0:20],\n            textposition='auto',\n            marker_color='black',\n            \n\n        )])\nfig.update_layout(\n    title='20 maiores Microrregi\u00f5es em Respiradores em Junho de 2020',\n    xaxis_title=\"Microregi\u00f5es\",\n    yaxis_title=\"Respiradores\/Ventiladores\",\n        template='plotly_white'\n\n)\nfig.show()","e624e191":"# 30 microrregi\u00f5es que mais compraram Leitos de UTI a cada 10.000 habitantes\ntemp = infra_saude.groupby(['cod_microregiao', 'nome_microrregiao', 'nome_uf']).sum()[['leitos_uti_fev','leitos_uti_jun', 'populacao']].reset_index()\n\ntemp['nome'] = temp['nome_microrregiao'] +' - '+temp['nome_uf']\ntemp['varia\u00e7\u00e3o_leitos'] = temp['leitos_uti_jun'] - temp['leitos_uti_fev']\ntemp['varia\u00e7\u00e3o_leitos_normalizado'] = temp['varia\u00e7\u00e3o_leitos']\/ temp['populacao']*10000\ntemp['varia\u00e7\u00e3o_leitos_normalizado'] = temp['varia\u00e7\u00e3o_leitos_normalizado'].round(2)\n\ntemp = temp[['varia\u00e7\u00e3o_leitos_normalizado', 'nome']].sort_values(by = ['varia\u00e7\u00e3o_leitos_normalizado'],ascending = False)[:-10].reset_index(drop=True)\n\nfig = go.Figure(data=[go.Bar(\n            x=temp['nome'][0:20], y=temp['varia\u00e7\u00e3o_leitos_normalizado'][0:30],\n            text=temp['varia\u00e7\u00e3o_leitos_normalizado'][0:30],\n            textposition='auto',\n            marker_color='black',\n            \n\n        )])\nfig.update_layout(\n    title='30 Microrregi\u00f5es que mais adquiriram leitos de UTI a cada 10.000 habitantes entre Fevereiro e Junho de 2020',\n    xaxis_title=\"Microregi\u00f5es\",\n    yaxis_title=\"Leitos de UTI \/ 10.000 habitantes\",\n        template='plotly_white'\n\n)\nfig.show()","c00cd632":"# 30 microrregi\u00f5es que mais compraram Leitos de UTI a cada 10.000 habitantes\ntemp = infra_saude.groupby(['cod_microregiao', 'nome_microrregiao', 'nome_uf']).sum()[['leitos_covid_junho', 'populacao']].reset_index()\n\ntemp['nome'] = temp['nome_microrregiao'] +' - '+temp['nome_uf']\ntemp['varia\u00e7\u00e3o_leitos_normalizado'] = temp['leitos_covid_junho']\/ temp['populacao']*10000\ntemp['varia\u00e7\u00e3o_leitos_normalizado'] = temp['varia\u00e7\u00e3o_leitos_normalizado'].round(2)\n\ntemp = temp[['varia\u00e7\u00e3o_leitos_normalizado', 'nome']].sort_values(by = ['varia\u00e7\u00e3o_leitos_normalizado'],ascending = False)[:-10].reset_index(drop=True)\n\nfig = go.Figure(data=[go.Bar(\n            x=temp['nome'][0:20], y=temp['varia\u00e7\u00e3o_leitos_normalizado'][0:30],\n            text=temp['varia\u00e7\u00e3o_leitos_normalizado'][0:30],\n            textposition='auto',\n            marker_color='black',\n            \n\n        )])\nfig.update_layout(\n    title='30 Microrregi\u00f5es que mais adquiriram leitos de UTI especificos para Covid-19 a cada 10.000 habitantes entre Fevereiro e Junho de 2020',\n    xaxis_title=\"Microregi\u00f5es\",\n    yaxis_title=\"Leitos de UTI espec. Covid-19 \/ 10.000 habitantes\",\n        template='plotly_white'\n\n)\nfig.show()","d0628323":"# 30 microrregi\u00f5es que mais compraram Leitos de UTI a cada 10.000 habitantes\ntemp = infra_saude.groupby(['cod_microregiao', 'nome_microrregiao', 'nome_uf']).sum()[['respiradores_fev', 'respiradores_junho', 'populacao']].reset_index()\n\ntemp['nome'] = temp['nome_microrregiao'] +' - '+temp['nome_uf']\ntemp['varia\u00e7\u00e3o_leitos'] = temp['respiradores_junho'] - temp['respiradores_fev']\ntemp['varia\u00e7\u00e3o_leitos_normalizado'] = temp['varia\u00e7\u00e3o_leitos']\/ temp['populacao']*10000\ntemp['varia\u00e7\u00e3o_leitos_normalizado'] = temp['varia\u00e7\u00e3o_leitos_normalizado'].round(2)\n\ntemp = temp[['varia\u00e7\u00e3o_leitos_normalizado', 'nome']].sort_values(by = ['varia\u00e7\u00e3o_leitos_normalizado'],ascending = False)[:-10].reset_index(drop=True)\n\nfig = go.Figure(data=[go.Bar(\n            x=temp['nome'][0:20], y=temp['varia\u00e7\u00e3o_leitos_normalizado'][0:30],\n            text=temp['varia\u00e7\u00e3o_leitos_normalizado'][0:30],\n            textposition='auto',\n            marker_color='black',\n            \n\n        )])\nfig.update_layout(\n    title='30 Microrregi\u00f5es que mais adquiriram Respiradores a cada 10.000 habitantes entre Fevereiro e Junho de 2020',\n    xaxis_title=\"Microregi\u00f5es\",\n    yaxis_title=\"Respiradores \/ 10.000 habitantes\",\n        template='plotly_white'\n\n)\nfig.show()","5363a97c":"# Grafico de barra -  municipio com maior incidencia ?\n\nfiltro_data = min_saude[['data', 'casosAcumulado', 'obitosAcumulado', 'codmun', 'municipio','estado']][(min_saude['data'] == '15\/08\/2020') & (min_saude['codmun'].isnull() != True)].copy()\nfiltro_data['codmun'] = filtro_data['codmun'].astype(np.int64)\nfiltro_data.rename(columns={'codmun':'codigo_municipio_sem_digito'}, inplace= True)\n\nfinal_df = pd.merge(filtro_data, infra_saude[[\"populacao\",\"codigo_municipio_sem_digito\"]], on=[\"codigo_municipio_sem_digito\"])\nfinal_df['incidencia_caso'] = final_df['casosAcumulado'] \/ final_df['populacao'] * 10000\nfinal_df['incidencia_mortes'] = final_df['obitosAcumulado'] \/ final_df['populacao'] * 10000\n\nfinal_df['incidencia_caso'], final_df['incidencia_mortes'] = final_df['incidencia_caso'].round(1), final_df['incidencia_mortes'].round(1)\n\n# DataTable Gradient\nqueste = final_df[['municipio','populacao','casosAcumulado', 'obitosAcumulado', 'incidencia_caso', 'incidencia_mortes']].copy()\nqueste = queste.sort_values(by=['populacao'], ascending = False)[0:30].reset_index(drop=True)\nqueste.style.background_gradient(cmap='Greens')\n","e0c2ff71":"final_df['municipio'] = final_df['municipio'] +' - '+final_df['estado']\ntemp = final_df[['incidencia_caso', 'municipio']].sort_values(by = ['incidencia_caso'],ascending = False)[:30].reset_index(drop=True)\n\n\nfig = go.Figure(data=[go.Bar(\n            x=temp['municipio'][0:30], y=temp['incidencia_caso'][0:30],\n            text=temp['incidencia_caso'][0:30],\n            textposition='auto',\n            marker_color='black',\n            \n\n        )])\nfig.update_layout(\n    title='30 maiores municipios em incid\u00eancia de casos confirmados por 10.000 habitantes',\n    xaxis_title=\"Municipios\",\n    yaxis_title=\"Casos Confirmados\",\n        template='plotly_white'\n\n)\nfig.show()\n","c7a4f637":"temp = final_df[['incidencia_mortes', 'municipio']].sort_values(by = ['incidencia_mortes'],ascending = False)[:30].reset_index(drop=True)\n\nfig = go.Figure(data=[go.Bar(\n            x=temp['municipio'][0:30], y=temp['incidencia_mortes'][0:30],\n            text=temp['incidencia_mortes'][0:30],\n            textposition='auto',\n            marker_color='black',\n            \n\n        )])\nfig.update_layout(\n    title='30 maiores municipios em incid\u00eancia de \u00f3bitos confirmados por 10.000 habitantes',\n    xaxis_title=\"Municipios\",\n    yaxis_title=\"\u00d3bitos Confirmados\",\n        template='plotly_white'\n\n)\nfig.show()\n","fed0f33d":"def media_movel_7(dados):\n    media_movel = []\n    lista_dia=[]\n    total_dias = len(dados['y']-1)\n\n    for j in range(8,total_dias):\n\n        a = 0\n        for i in range(0,7):\n            dia = dados.loc[j][0] + timedelta(-i)\n            numerico = dados['y'][dados['ds'] == dia].values\n            if numerico >0:\n                a = a + numerico.min()\n        media = a\/7\n\n        #print(media)\n        #print(dados.loc[j][0])\n        media_movel.append(media)\n        lista_dia.append(dados.loc[j][0])\n    \n    tendencia = pd.DataFrame(columns=['ds', 'y'])\n    tendencia['ds'] = lista_dia\n    tendencia['y'] = media_movel\n    return tendencia;\n\n\ndef df_aux(min_saude, estado):\n    corte_estado = min_saude[['data', 'casosNovos']][(min_saude['estado'] == estado) & (min_saude['codmun'].isnull() == True)]\n\n    corte_estado.rename(columns={'casosNovos':'y', 'data':'ds'}, inplace=True)\n    corte_estado['ds'] =pd.to_datetime(corte_estado['ds'], format='%d\/%m\/%Y')\n    dados_casos = corte_estado[['ds','y']].copy()\n\n\n    corte_estado = min_saude[['data', 'obitosNovos']][(min_saude['estado'] == estado) & (min_saude['codmun'].isnull() == True)]\n    corte_estado.rename(columns={'obitosNovos':'y', 'data':'ds'}, inplace=True)\n    corte_estado['ds'] =pd.to_datetime(corte_estado['ds'], format='%d\/%m\/%Y')\n    dados_mortes = corte_estado[['ds','y']].copy()\n    \n    return dados_casos.reset_index(drop=True), dados_mortes.reset_index(drop=True);\n\ndef plot_casos_mortes(dados_casos,dados_mortes, estado):\n    \n    plt.figure(figsize=(16, 10))\n    plt.bar(dados_casos['ds'], dados_casos['y'])\n    media = media_movel_7(dados_casos)\n    plt.plot(media['ds'], media['y'], color='orange', linestyle='dashed')\n    plt.title('Curva de casos confirmados diarios em '+estado, size=30)\n    plt.xlabel('Data', size=30)\n    plt.ylabel('# casos confirmados', size=30)\n    plt.legend(['M\u00e9dia m\u00f3vel de {} dias'.format(7), 'de novos casos confirmados diarios'], prop={'size': 20})\n    plt.xticks(size=20)\n    plt.yticks(size=20)\n    plt.show()\n\n\n    plt.figure(figsize=(16, 10))\n    plt.bar(dados_mortes['ds'], dados_mortes['y'])\n    media = media_movel_7(dados_mortes)\n    plt.plot(media['ds'], media['y'], color='orange', linestyle='dashed')\n    plt.title('Curva de novas mortes confirmadas diariamente em '+estado, size=30)\n    plt.xlabel('Data', size=30)\n    plt.ylabel('# de \u00f3bitos', size=30)\n    plt.legend(['M\u00e9dia m\u00f3vel de {} dias'.format(7), 'de novas mortes confirmados diarios'], prop={'size': 20})","4e623be1":"teste_casos, teste_mortes = df_aux(min_saude, 'SP')\nplot_casos_mortes(teste_casos, teste_mortes, 'S\u00e3o Paulo')","fc5f8b3e":"teste_casos, teste_mortes = df_aux(min_saude, 'MG')\nplot_casos_mortes(teste_casos, teste_mortes, 'Minas Gerais')","46bd6264":"teste_casos, teste_mortes = df_aux(min_saude, 'RJ')\nplot_casos_mortes(teste_casos, teste_mortes, 'Rio de Janeiro')","a173c438":"teste_casos, teste_mortes = df_aux(min_saude, 'SC')\nplot_casos_mortes(teste_casos, teste_mortes, 'Santa Catarina')","dcebd9b6":"teste_casos, teste_mortes = df_aux(min_saude, 'BA')\nplot_casos_mortes(teste_casos, teste_mortes, 'Bahia')","f444b20c":"teste_casos, teste_mortes = df_aux(min_saude, 'CE')\nplot_casos_mortes(teste_casos, teste_mortes, 'Cear\u00e1')","e5a8bdf8":"teste_casos, teste_mortes = df_aux(min_saude, 'AM')\nplot_casos_mortes(teste_casos, teste_mortes, 'Amaz\u00f4nia')","d5863951":"# Tendencia futura Brasil Casos Confirmados - M\u00e9dia Movel\ncorte_pais = min_saude[['data', 'casosAcumulado']][min_saude['regiao']== 'Brasil']\n\ncorte_pais.rename(columns={'casosAcumulado':'y', 'data':'ds'}, inplace=True)\ncorte_pais['ds'] =pd.to_datetime(corte_pais['ds'], format='%d\/%m\/%Y')\n\ntemp  = corte_pais[['ds','y']].copy()\ndados = media_movel_7(temp)\n\nm = Prophet(interval_width=0.95)\nm.fit(dados)\nfuture = m.make_future_dataframe(periods=30)\nfuture_confirmed = future.copy() # for non-baseline predictions later on\nforecast = m.predict(future_confirmed)\nfig = m.plot(forecast)\na = add_changepoints_to_plot(fig.gca(), m, forecast)\nm.plot_components(forecast);","d02b5ed9":"# Tendencia futura Brasil novos casos - M\u00e9dia Movel\ncorte_pais = min_saude[['data', 'casosNovos']][min_saude['regiao']== 'Brasil']\n\ncorte_pais.rename(columns={'casosNovos':'y', 'data':'ds'}, inplace=True)\ncorte_pais['ds'] =pd.to_datetime(corte_pais['ds'], format='%d\/%m\/%Y')\n\ntemp  = corte_pais[['ds','y']].copy()\ndados = media_movel_7(temp)\n\n\nm = Prophet(interval_width=0.95)\nm.fit(dados)\nfuture = m.make_future_dataframe(periods=30)\nfuture_confirmed = future.copy() # for non-baseline predictions later on\nforecast = m.predict(future_confirmed)\nfig = m.plot(forecast)\na = add_changepoints_to_plot(fig.gca(), m, forecast)\nm.plot_components(forecast);","84706b99":"# Tendencia futura Brasil novos obitos - M\u00e9dia Movel\ncorte_pais = min_saude[['data', 'obitosNovos']][min_saude['regiao']== 'Brasil']\n\ncorte_pais.rename(columns={'obitosNovos':'y', 'data':'ds'}, inplace=True)\ncorte_pais['ds'] =pd.to_datetime(corte_pais['ds'], format='%d\/%m\/%Y')\n\ntemp  = corte_pais[['ds','y']].copy()\ndados = media_movel_7(temp)\n\n\nm = Prophet(interval_width=0.95)\nm.fit(dados)\nfuture = m.make_future_dataframe(periods=30)\nfuture_confirmed = future.copy() # for non-baseline predictions later on\nforecast = m.predict(future_confirmed)\nfig = m.plot(forecast)\na = add_changepoints_to_plot(fig.gca(), m, forecast)\nm.plot_components(forecast);","67d9d509":"# Tendencia de casos\n\ndef plot_prophet_estado(coluna,estado, periodo, string):\n    print('Curva predita para ',string, 'para os proximos ', periodo, 'dias')\n    \n    #filtra o estado escolhido\n    corte_estado = min_saude[['data', coluna]][(min_saude['estado'] == estado) & (min_saude['codmun'].isnull() == True)]\n    \n    corte_estado.rename(columns={coluna:'y', 'data':'ds'}, inplace=True)\n    corte_estado['ds'] =pd.to_datetime(corte_estado['ds'], format='%d\/%m\/%Y')\n    \n    dados = corte_estado[['ds','y']].copy()\n    \n    m = Prophet(interval_width=0.95)\n    m.fit(dados)\n    future = m.make_future_dataframe(periods=periodo)\n    future_confirmed = future.copy() # for non-baseline predictions later on\n    forecast = m.predict(future_confirmed)\n    fig = m.plot(forecast)\n    a = add_changepoints_to_plot(fig.gca(), m, forecast)\n    m.plot_components(forecast);\n\n    \n","88ed70eb":"plot_prophet_estado('casosAcumulado','SP', 30, 'Casos Confirmados em S\u00e3o Paulo')\n","96ef7ef0":"Contexto Brasileiro\n\n- Infraestrutura de Sa\u00fade.  OK\n- Quais cidades e regi\u00f5es estavam preparadas? OK\n- Curva de casos por microrregi\u00e3o de sa\u00fade.\n- Curva com m\u00e9dia movel. OK \n- Regi\u00f5es com mais casos. OK\n- Curvas por estado.","5d61e4fa":"## AM091 - Proposta 5\n\n\nComo parte dos m\u00e9todos avaliativos da disciplina AM091 oferecido extraordinariamente como disciplina eletiva durante a pandemia, este notebook foi desenvolvido como parte da avalia\u00e7\u00e3o requerida pela orientadora e docente do departamento de estatistica do IMECC (Instituto de Matematica Aplica e Computacional) Prof\u00ba Dr\u00ba Samara Flamini Kiihl. Dentre os projetos possiveis foi proposto aos alunos inscritos a elabora\u00e7\u00e3o de projetos que visem a divulga\u00e7\u00e3o de dados relacionados \u00e0 pandemia de maneira clara e concisa, atrav\u00e9s de coleta e organiza\u00e7\u00e3o de dados gerados por \u00f3rg\u00e3os oficiais, tanto no n\u00edvel de pa\u00edses quanto na escala de estados e munic\u00edpios brasileiros, a s\u00edntese desses dados e visualiza\u00e7\u00e3o atrav\u00e9s de gr\u00e1ficos, mapas, tabelas usando as mais diversas linguagens computacionais. \n\n\nA pandemia de Covid-19 causada pelo novo coronavirus da sindrome respirat\u00f3ria aguda grave ou \"SARS-CoV-2\" como este novo virus foi registrado dentro do meio cientifico, a doen\u00e7a foi identificada inicialmente em Wuhan, na prov\u00edncia de Hubei, Rep\u00fablica Popular da China, em 1 de dezembro de 2019, mas o primeiro caso foi reportado em 31 de dezembro do mesmo ano, por\u00e9m existem evidencias da presen\u00e7a desse virus no esgoto anteriormente mas como a pandemia ainda est\u00e1 em curso n\u00e3o \u00e9 possivel identificar com precis\u00e3o absoluta qual a origem da doen\u00e7a. ","b0081451":"Obrigado por ler esse notebook, sugest\u00f5es s\u00e3o bem-vindas! :)","dd04040f":"Forecast - Media movel \n* Casos Acumulados\n* Novos Casos diarios\n* Novas Mortes Diarias","2ff3cc9d":"MIN_SAUDE","d18d9472":"CONTEXTO MUNDIAL\n","248602d7":"**Plota m\u00e9dia m\u00f3vel por estado**","ee90b2e0":"Forecast S\u00e3o Paulo"}}