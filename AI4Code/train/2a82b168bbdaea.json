{"cell_type":{"f2540817":"code","c2992942":"code","6aa73bae":"code","eb18f306":"code","86b8acbf":"code","de482436":"code","7a9d112d":"code","616b70da":"code","851fe4ad":"code","74ac7bc1":"markdown","7cdada8a":"markdown","1b16880a":"markdown"},"source":{"f2540817":"import numpy as np\nimport pandas as pd\n\nfrom fastai.vision import *\nfrom fastai.callbacks import *\n\nfrom pathlib import Path\n\nimport os\nimport shutil\n\nnp.random.seed(10)\n\n%matplotlib inline\n%reload_ext autoreload\n%autoreload 2","c2992942":"data_folder = Path(\"..\/input\")\ntrain_df = pd.read_csv(\"..\/input\/train.csv\")\ntest_df = pd.read_csv(\"..\/input\/sample_submission.csv\")","6aa73bae":"test_img = ImageList.from_df(test_df, path=data_folder\/'test', folder='test')\n\ntrfm = get_transforms(do_flip=True, flip_vert=True, max_rotate=12.0, max_zoom=1.1, max_lighting=0.2, max_warp=0.2, p_affine=0.75, p_lighting=0.75)\n\ntrain_img = (ImageList.from_df(train_df, path=data_folder\/'train', folder='train')\n        .split_by_rand_pct(0.01)\n        .label_from_df()\n        .add_test(test_img)\n        .transform(trfm, size=128)\n        .databunch(path='.', bs=64, device= torch.device('cuda:0'))\n        .normalize(imagenet_stats)\n       )","eb18f306":"learn_densnet = cnn_learner(train_img, models.densenet201, metrics=[error_rate, accuracy], model_dir=\"\/tmp\/model\/\")","86b8acbf":"learn_densnet.lr_find()\nlearn_densnet.recorder.plot()","de482436":"lr = 1e-02\nlearn_densnet.fit_one_cycle(5 , slice(lr))","7a9d112d":"preds,_ = learn_densnet.get_preds(ds_type=DatasetType.Test)","616b70da":"test_df.has_cactus = preds.numpy()[:, 0]\ntest_df.head()","851fe4ad":"test_df.to_csv('submission.csv', index=False)","74ac7bc1":"## Training DenseNet-201","7cdada8a":"# Aerial Cactus Identification","1b16880a":"## Initialize library"}}