{"cell_type":{"c9ef5556":"code","a6bef948":"code","d1d51154":"code","b6150182":"code","8b834919":"code","23ae941f":"code","82ed77fa":"code","202799f4":"code","a2981e0f":"code","1a192198":"code","98050cd5":"code","befe80da":"code","76fd004d":"code","e74baa96":"code","699f408e":"code","c93cd600":"code","6bb865d6":"code","9b1f9820":"code","b29bfb9d":"code","846854bf":"code","9e67b089":"code","dc8f57d1":"code","226cdb70":"code","2f8b3a8c":"code","e63b8263":"code","63ba470f":"code","96df04ad":"code","ffa1a6ce":"code","53c74541":"code","c250c883":"code","08a4c76a":"code","75e8f53f":"code","b521eb53":"code","eb6f56b5":"code","9aa1a796":"code","3fedb1a3":"code","5648647d":"code","f756e080":"code","c33d3aa6":"code","50d816de":"code","60570141":"code","43f6e03c":"code","6e51ece9":"code","d3c4e21a":"code","0a2075d3":"code","0c0c4a3e":"code","7ae42da4":"code","a958c896":"code","c83503b4":"code","fba113dc":"code","cfc7327c":"code","6ebdfbb7":"code","926254c7":"code","1a5d0533":"code","98085388":"code","adae1c9c":"code","3a680dbd":"code","6cdfa2f9":"code","388323d8":"code","4f51dabb":"code","bffa9dec":"code","7f26a63e":"code","fb8675c1":"code","1a087730":"markdown","02036854":"markdown","b7dbe848":"markdown","083ae9e9":"markdown","342691e5":"markdown","73c0b348":"markdown","eaa2b883":"markdown","cafe1d7e":"markdown","cc0e7621":"markdown","3214f18b":"markdown","f8ce7242":"markdown","1feb3e2c":"markdown","801fa050":"markdown"},"source":{"c9ef5556":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport warnings\nwarnings.filterwarnings('ignore')","a6bef948":"Data=pd.read_csv('..\/input\/lending-club-loan-data-analysis\/loan_data.csv')","d1d51154":"Data.head()","b6150182":"Data.info()","8b834919":"Data.isna().sum()","23ae941f":"Data.corr()","82ed77fa":"plt.figure(figsize=(13,8))\nsns.countplot(Data['credit.policy'])\nplt.show()","202799f4":"plt.figure(figsize=(13,8))\nsns.countplot(Data['purpose'])\nplt.show()","a2981e0f":"dummy_purpose=pd.get_dummies(Data['purpose'])","1a192198":"dummy_purpose.head()","98050cd5":"New_Data=pd.concat(([Data.iloc[:,0],dummy_purpose,Data.iloc[:,2:]]),axis=1)","befe80da":"New_Data.head()","76fd004d":"import statsmodels.api as sm\n\nprint(sm.OLS(endog=New_Data.iloc[:,0],exog=New_Data.iloc[:,1:]).fit().summary())","e74baa96":"Data.describe().transpose()","699f408e":"def show_data(data_name):\n  fig,axs = plt.subplots(nrows=4,ncols=3,figsize=(15,15))\n  b=0\n  c=0\n  a=3\n  for i in data_name:\n    axs[b,c].scatter(y=Data['credit.policy'],x=Data[f'{i}'])\n    axs[b,c].set_ylabel('credit.policy')\n    axs[b,c].set_xlabel(f'{i}',color='red')\n    c+=1\n    if c==a:\n      b+=1\n      c=0\n    elif b==4:\n      break\n  plt.show()","c93cd600":"show_data(Data.columns[2:]) ","6bb865d6":"x=New_Data.copy().drop(columns='credit.policy')\ny=New_Data.copy()['credit.policy']","9b1f9820":"x.head()","b29bfb9d":"y.head()","846854bf":"x_array=x.values\ny_array=y.values","9e67b089":"x.shape","dc8f57d1":"y.shape","226cdb70":"from sklearn.model_selection import train_test_split\n\nx_train,x_val,y_train,y_val=train_test_split(x_array,y_array,test_size=0.05,random_state=42)\nx_train,x_test,y_train,y_test=train_test_split(x_train,y_train,test_size=0.20,random_state=42)","2f8b3a8c":"x_train.shape","e63b8263":"y_train.shape","63ba470f":"x_val.shape","96df04ad":"y_val.shape","ffa1a6ce":"x_test.shape","53c74541":"y_test.shape","c250c883":"from sklearn.preprocessing import StandardScaler\n\nobje_ss=StandardScaler()\n\nx_train_ss=obje_ss.fit_transform(x_train)\nx_val_ss=obje_ss.fit_transform(x_val)\nx_test_ss=obje_ss.fit_transform(x_test)","08a4c76a":"x_train","75e8f53f":"x_train_ss","b521eb53":"from sklearn.metrics import r2_score,classification_report,accuracy_score,confusion_matrix","eb6f56b5":"from sklearn.linear_model import LogisticRegression\n\nmodel_log=LogisticRegression(solver='lbfgs',max_iter=200,random_state=42).fit(x_train,y_train)\ny_pred=model_log.predict(x_val)\nprint(model_log)","9aa1a796":"print(confusion_matrix(y_val,y_pred))","3fedb1a3":"print('Train success rate: %',model_log.score(x_train,y_train)*100)\nprint('Test success rate: %',accuracy_score(y_val,y_pred)*100)","5648647d":"print(classification_report(y_val,y_pred))","f756e080":"from sklearn.svm import SVC\n\nmodel_svc=SVC(C=1,kernel='rbf',degree=3,random_state=42).fit(x_train_ss,y_train)\ny_pred=model_svc.predict(x_val_ss)\nprint(model_svc)","c33d3aa6":"print(confusion_matrix(y_val,y_pred))","50d816de":"print('Train success rate: %',model_svc.score(x_train_ss,y_train)*100)\nprint('Test success rate: %',accuracy_score(y_val,y_pred)*100)","60570141":"print(classification_report(y_val,y_pred))","43f6e03c":"from sklearn.neighbors import KNeighborsClassifier\n\nmodel_knn=KNeighborsClassifier(n_neighbors=5,metric='minkowski').fit(x_train,y_train)\ny_pred=model_knn.predict(x_val)\nprint(model_knn)","6e51ece9":"print(confusion_matrix(y_val,y_pred))","d3c4e21a":"print('Train success rate: %',model_knn.score(x_train,y_train)*100)\nprint('Test success rate: %',accuracy_score(y_val,y_pred)*100)","0a2075d3":"print(classification_report(y_val,y_pred))","0c0c4a3e":"from sklearn.naive_bayes import  BernoulliNB\n\nmodel_bnb=BernoulliNB().fit(x_train,y_train)\ny_pred=model_bnb.predict(x_val)\nprint(model_bnb)","7ae42da4":"print(confusion_matrix(y_val,y_pred))","a958c896":"print('Train success rate: %',model_bnb.score(x_train,y_train)*100)\nprint('Test success rate: %',accuracy_score(y_val,y_pred)*100)","c83503b4":"print(classification_report(y_val,y_pred))","fba113dc":"from sklearn.ensemble import RandomForestClassifier\n\nmodel_rfr=RandomForestClassifier(n_estimators=100,criterion='gini',random_state=42,n_jobs=-1).fit(x_train,y_train)\ny_pred=model_rfr.predict(x_val)\nprint(model_rfr)","cfc7327c":"print(confusion_matrix(y_val,y_pred))","6ebdfbb7":"print('Train success rate: %',model_rfr.score(x_train,y_train)*100)\nprint('Test success rate: %',accuracy_score(y_val,y_pred)*100)","926254c7":"print(classification_report(y_val,y_pred))","1a5d0533":"from xgboost import XGBClassifier\n\nmodel_xgb=XGBClassifier(max_depth=4,learning_rate=0.1,n_estimators=100,objective='binary:logistic',n_jobs=-1,random_state=42).fit(x_train,y_train)\ny_pred=model_xgb.predict(x_val)\nprint(model_xgb)","98085388":"print(confusion_matrix(y_val,y_pred))","adae1c9c":"print('Train success rate: %',model_xgb.score(x_train,y_train)*100)\nprint('Test success rate: %',accuracy_score(y_val,y_pred)*100)","3a680dbd":"print(classification_report(y_val,y_pred))","6cdfa2f9":"def test_score(model_name):\n\n  for i in model_name:\n    print(f'{i.__class__} \\n{classification_report(y_test,i.predict(x_test))}')\n","388323d8":"model_names=[model_log,model_knn,model_bnb,model_rfr,model_xgb]","4f51dabb":"test_score(model_names)","bffa9dec":"from sklearn.model_selection import cross_val_score","7f26a63e":"def cross_score(model_name):\n\n  for i in model_name:\n    print(f'{i.__class__}  | Cross val score: %{cross_val_score(i,X=x_train,y=y_train,cv=5,n_jobs=-1).mean()*100}')","fb8675c1":"cross_score(model_names)","1a087730":"## Cross validation","02036854":"### Boosting","b7dbe848":"## Test\n","083ae9e9":"### KNN","342691e5":"### SVC","73c0b348":"### LogisticRegression","eaa2b883":"## Data Upload","cafe1d7e":"### Tree Models","cc0e7621":"## Scaler","3214f18b":"## Data Analysis","f8ce7242":"### Navie Bayes","1feb3e2c":"## Models","801fa050":"## Train-Validation-Test"}}