{"cell_type":{"67dd62c1":"code","b94547c7":"code","f6c5bbc8":"code","4869f264":"code","2d960f8d":"code","b9a34cd1":"code","96ae39d0":"code","c36a2eed":"code","3b2cc536":"code","c0195376":"code","bd62439b":"code","8cdb311f":"code","1e2905c9":"code","75893f4d":"code","5da99988":"code","36330a17":"code","d203e53e":"code","f627eda8":"code","c1949451":"code","afd9f967":"markdown","af7ff586":"markdown"},"source":{"67dd62c1":"import numpy as np\nimport pandas as pd","b94547c7":"# \u30c7\u30fc\u30bf\u8aad\u307f\u8fbc\u307f\ntrain_df = pd.read_csv(\"..\/input\/uec2021-exercise-1\/train.csv\")\ntest_df = pd.read_csv(\"..\/input\/uec2021-exercise-1\/test.csv\")\nsample_submission_df = pd.read_csv(\"..\/input\/uec2021-exercise-1\/sample_submission.csv\")","f6c5bbc8":"train_df.head(2)","4869f264":"train_df.groupby(\"lead_time\")[\"is_canceled\"].mean().plot()","2d960f8d":"train_df[\"lt_qcut\"] = pd.qcut(train_df[\"lead_time\"], 10)","b9a34cd1":"train_df.groupby(\"lt_qcut\")[\"is_canceled\"].mean().plot()","96ae39d0":"train_df.groupby([\"deposit_type\"])[\"is_canceled\"].agg([\"mean\", \"count\"])","c36a2eed":"cond_a = train_df[\"deposit_type\"] ==\"No Deposit\"\ncond_b = train_df[\"deposit_type\"] ==\"Non Refund\"\ntrain_df[cond_a].groupby([\"lt_qcut\"])[\"is_canceled\"].mean().plot()\ntrain_df[cond_b].groupby([\"lt_qcut\"])[\"is_canceled\"].mean().plot()","3b2cc536":"_, bins = pd.qcut(train_df[\"lead_time\"], 10, retbins=True, labels=False)\ntest_df[\"lt_qcut\"] = pd.cut(test_df[\"lead_time\"], bins=bins, labels=False, include_lowest=True)","c0195376":"test_df[[\"lead_time\", \"lt_qcut\"]].head()","bd62439b":"train_df[\"lt_qcut\"] = pd.qcut(train_df[\"lead_time\"], 10, labels=False)","8cdb311f":"conda = train_df[cond_a].groupby(\"lt_qcut\")[\"is_canceled\"].mean().reset_index()\ncondb = train_df[cond_b].groupby(\"lt_qcut\")[\"is_canceled\"].mean().reset_index()","1e2905c9":"conda.index=conda[\"lt_qcut\"].astype(int)\nconda = conda[\"is_canceled\"].to_dict()\ncondb.index=condb[\"lt_qcut\"].astype(int)\ncondb = condb[\"is_canceled\"].to_dict()","75893f4d":"test_df[\"conda\"] = test_df[\"lt_qcut\"].map(conda)\ntest_df[\"condb\"] = test_df[\"lt_qcut\"].map(condb)\ntest_df[\"condc\"] = 0.2196","5da99988":"test_df[\"pred\"] = np.where(test_df[\"deposit_type\"]==\"No Deposit\", test_df[\"conda\"], 0.2196)\ntest_df[\"pred\"] = np.where(test_df[\"deposit_type\"]==\"Non Refund\", test_df[\"condb\"], test_df[\"pred\"])","36330a17":"test_df[[\"deposit_type\", \"lead_time\", \"pred\"]]","d203e53e":"# \u30c7\u30fc\u30bf\u4f5c\u6210\nsub_df = pd.DataFrame({\n    \"id\": test_df[\"id\"], \n    \"pred\": test_df[\"pred\"]\n})","f627eda8":"sub_df.head()","c1949451":"# \u30d5\u30a1\u30a4\u30eb\u3078\u306e\u66f8\u304d\u51fa\u3057\nsub_df.to_csv(\"groupby.csv\", index=False)","afd9f967":"# \u3053\u306eNotebook\u306e\u76ee\u7684\nKaggle Notebook\u74b0\u5883\u3092\u7406\u89e3\u3057\u3066\u3082\u3089\u3046\u3053\u3068","af7ff586":"\u3053\u3053\u3067\u66f8\u304d\u51fa\u3057\u305f\u30d5\u30a1\u30a4\u30eb\u306f\u3001Notebook\u3092Commit\u3057\u305f\u306e\u3061\u306b\u3001Notebook\u306e\u5b9f\u884c\u5f8c\u306e\u753b\u9762\u304b\u3089submit\u3067\u304d\u307e\u3059"}}