{"cell_type":{"1f2b5912":"code","f498576c":"code","0b9877bc":"code","fda42f11":"code","6664d6d2":"code","e6430699":"code","88ef96f4":"code","26619ef8":"code","a617cf76":"code","138aec5d":"code","2a154435":"code","64e63dc2":"code","39748e10":"code","09d19521":"code","010dc049":"code","7dee9e58":"code","009130c0":"code","e55ced39":"code","0b454e84":"code","fe619676":"code","bf055f30":"markdown"},"source":{"1f2b5912":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","f498576c":"FILEPATH = '\/kaggle\/input\/creditcardfraud\/creditcard.csv'","0b9877bc":"df = pd.read_csv(FILEPATH)","fda42f11":"df.shape","6664d6d2":"df = pd.read_csv(FILEPATH, engine='python')\n\ndf.head(10)","e6430699":"#Description of DataFrame\ndf.describe()","88ef96f4":"#See if missing values are present\ndf.isnull().values.any()","26619ef8":"#How many types of values are present\nprint(pd.value_counts(df['Class']))","a617cf76":"import matplotlib.pyplot as plt","138aec5d":"LABELS = [\"Normal\", \"Fraud\"]","2a154435":"#Display plot of value counts\nclass_counts = pd.value_counts(df['Class'], sort = True)\nclass_counts.plot(kind = 'bar', rot=0, color=['blue','red']) #Added colors as a list \nplt.title('Counts of Fraud\/Normal')\nplt.xticks(range(2), LABELS)\nplt.xlabel(\"Class\")\nplt.ylabel(\"Count\")","64e63dc2":"fraud = df[df[\"Class\"]==1]\n\nnormal = df[df[\"Class\"]==0]","39748e10":"print(fraud.shape, normal.shape)","09d19521":"#Use describe to look at how much the range of values are in the entire DataFrames\n#fraud.describe()\n#For specific column add column name like so\nfraud.Amount.describe()","010dc049":"normal.Amount.describe()","7dee9e58":"#Subplots can be used to add multiple plots in the same window\nfig, (ax1, ax2) = plt.subplots(2, 1, sharex=True)\nfig.suptitle(\"Amount per class\", fontsize='large')\nbins = 50 #Best view possible\n#Specify which axis where you are going to plot\nax1.hist(fraud.Amount, bins = bins)\nax1.set_title('Fraudulent amount')\n#ax1.set_ylabel('Number of Transactions') Line shortened\nax2.hist(normal.Amount, bins = bins)\nax2.set_title('Normal amount')\nplt.xlabel('Amount ($)')\nplt.ylabel('Number of Transactions')\n#plt.xlim((0, 20000))\nplt.yscale('log') # Used to better view the second plot\nplt.show()","009130c0":"df_sample = df.sample(frac=0.1, random_state=1)\n\nX = df_sample[df.columns.tolist()]\ny = df_sample[\"Class\"]\n\noutlier_fraction = len(fraud)\/ float(len(normal))\nstate = np.random.RandomState(42)","e55ced39":"from sklearn.metrics import classification_report,accuracy_score\nfrom sklearn.ensemble import IsolationForest\nfrom sklearn.neighbors import LocalOutlierFactor\nfrom sklearn.svm import OneClassSVM","0b454e84":"classifiers = {\n    \"Isolation Forest\":IsolationForest(n_estimators=100, max_samples=len(X), \n                                       contamination=outlier_fraction, random_state=state, verbose=0),\n    \"Local Outlier Factor\":LocalOutlierFactor(n_neighbors=20, algorithm='auto', \n                                              leaf_size=30, metric='minkowski',\n                                              p=2, metric_params=None, contamination=outlier_fraction),\n    \"Support Vector Machine\":OneClassSVM(kernel='rbf', degree=3, gamma=0.1,nu=0.05, \n                                         max_iter=-1) #Random state not in OneClassSVM\n   \n}","fe619676":"n_outliers = len(fraud)\nfor i, (clf_name,clf) in enumerate(classifiers.items()):\n    #Fit the data and tag outliers\n    if clf_name == \"Local Outlier Factor\":\n        y_pred = clf.fit_predict(X)\n        scores_prediction = clf.negative_outlier_factor_\n    elif clf_name == \"Support Vector Machine\":\n        clf.fit(X)\n        y_pred = clf.predict(X)\n    else:    \n        clf.fit(X)\n        scores_prediction = clf.decision_function(X)\n        y_pred = clf.predict(X)\n    #Reshape the prediction values to 0 for Valid transactions , 1 for Fraud transactions\n    y_pred[y_pred == 1] = 0\n    y_pred[y_pred == -1] = 1\n    n_errors = (y_pred != y).sum()\n    # Run Classification Metrics\n    print(\"{}: {}\".format(clf_name,n_errors))\n    print(\"Accuracy Score :\")\n    print(accuracy_score(y,y_pred))\n    print(\"Classification Report :\")\n    print(classification_report(y,y_pred))","bf055f30":"# Sources:\n\nhttps:\/\/www.kaggle.com\/pavansanagapati\/anomaly-detection-credit-card-fraud-analysis\n\nhttps:\/\/matplotlib.org\/3.3.0\/api\/_as_gen\/matplotlib.pyplot.xticks.html\n\nhttps:\/\/matplotlib.org\/3.3.0\/api\/_as_gen\/matplotlib.pyplot.subplots.html\n\nhttps:\/\/matplotlib.org\/3.1.1\/api\/_as_gen\/matplotlib.pyplot.suptitle.html\n\nhttps:\/\/www.geeksforgeeks.org\/matplotlib-pyplot-xlim-in-python\/#:~:text=The%20xlim()%20function%20in,limits%20of%20the%20current%20axes.\n\nhttps:\/\/matplotlib.org\/3.3.0\/api\/_as_gen\/matplotlib.pyplot.yscale.html\n\nhttps:\/\/pandas.pydata.org\/pandas-docs\/stable\/reference\/api\/pandas.DataFrame.sample.html\n\nhttps:\/\/en.wikipedia.org\/wiki\/Isolation_forest"}}