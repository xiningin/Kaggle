{"cell_type":{"78fa79d4":"code","63b52422":"code","06d6a81f":"code","6f54facd":"code","563ae1a2":"code","aa9c4c10":"code","ea85fc48":"code","5c98d05d":"code","cd24eab9":"code","749e589c":"code","85d2a6d8":"code","4d2babf1":"code","4a4d8cd3":"markdown","1232e200":"markdown"},"source":{"78fa79d4":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","63b52422":"import h2o\nfrom h2o.automl import H2OAutoML\n\nh2o.init(max_mem_size='4G')","06d6a81f":"%%time\ntrain = h2o.import_file(\"..\/input\/train.csv\")\ntest = h2o.import_file(\"..\/input\/test.csv\")","6f54facd":"train.describe()","563ae1a2":"x = train.columns\ny = \"Survived\"","aa9c4c10":"# For binary classification, response should be a factor\ntrain[y] = train[y].asfactor()\nx.remove(y)","ea85fc48":"%%time\n# Run AutoML for 10 base models (limited to 1 hour max runtime by default)\naml = H2OAutoML(seed=42, max_runtime_secs=720000)\naml.train(x=x, y=y, training_frame=train)","5c98d05d":"lb = aml.leaderboard\nlb.head(rows=lb.nrows)  # Print all rows instead of default (10 rows)","cd24eab9":"aml.leader # Best model","749e589c":"# If you need to generate predictions on a test set, you can make\n# predictions directly on the `\"H2OAutoML\"` object, or on the leader\n# model object directly\n\npreds = aml.predict(test)","85d2a6d8":"predictions = preds[0].as_data_frame().values.flatten()","4d2babf1":"sample_submission = pd.read_csv('..\/input\/gender_submission.csv')\nsample_submission['Survived'] = predictions\nsample_submission.to_csv('h2O_titanic_1.csv', index=False)","4a4d8cd3":"### References::  \n* Bojan Tunguz's https:\/\/www.kaggle.com\/tunguz\/elo-with-h2o-automl \n* The H2O AutoML tutorial (https:\/\/github.com\/h2oai\/h2o-tutorials\/blob\/master\/h2o-world-2017\/automl\/Python\/automl_binary_classification_product_backorders.ipynb)","1232e200":"### So the best model gets an AUC of 0.876 (and this is without any parameter tuning)"}}