{"cell_type":{"d04ea61e":"code","1f01715d":"code","af797119":"code","464bf05a":"code","a1b3e2e4":"code","42d36d43":"code","664828cc":"markdown","3a244b56":"markdown","1a445039":"markdown","a388cae8":"markdown","33030e1b":"markdown","477308a1":"markdown"},"source":{"d04ea61e":"from IPython.display import clear_output\n!pip install pycaret --user\nclear_output()","1f01715d":"import numpy as np\nimport pandas as pd\nimport pycaret\nfrom pycaret.classification import *\nfrom sklearn.model_selection import train_test_split,StratifiedKFold","af797119":"TARGET = \"Survived\"\nSESSION_ID = 2021\nSEED = 42\nFEATURE = \"feature\"\nEXPERIMENT_NAME = 'titanic_prediction'\nN_SPLITS = 10","464bf05a":"train = pd.read_csv(\"..\/input\/titanic\/train.csv\")\ntest = pd.read_csv(\"..\/input\/titanic\/test.csv\")","a1b3e2e4":"test_pred = np.zeros(test.shape[0])\n\nskf = StratifiedKFold(n_splits=N_SPLITS, shuffle=False, random_state=SEED)\n\nfor fold, (trn_idx, val_idx) in enumerate(skf.split(X=train, y=train[TARGET])):    \n    setup(data = train.iloc[trn_idx], \n      target = TARGET, \n      session_id=SESSION_ID, \n      experiment_name=EXPERIMENT_NAME,\n      silent=True,\n      normalize=True,\n      transformation=True,\n     )\n    \n    lightgbm = create_model('lightgbm')\n    lightgbm.random_state = SEED\n    \n    \n    lgbm_params = {'num_leaves': np.arange(10,200,1),\n                'max_depth': np.arange(1,100,1),\n                'learning_rate': np.arange(0.0001,1,0.0001),\n                'n_estimators':np.arange(1,2000,1),\n                'min_child_samples':np.arange(1,100,1),\n                'subsample_freq':np.arange(0,100,1),\n             }\n\n    tuned_lightgbm = tune_model(lightgbm, custom_grid = lgbm_params)\n    \n    final_lightgbm = finalize_model(tuned_lightgbm)\n    \n    test_pred += predict_model(final_lightgbm, data=test)[\"Label\"] \/ N_SPLITS\n    ","42d36d43":"submission = pd.read_csv(\"..\/input\/titanic\/gender_submission.csv\")\nsubmission.Survived = (test_pred > 0.5).astype(int)\nsubmission.to_csv(\"submission.csv\",index=False)\nsubmission.head(10)","664828cc":"#  0.3 global variables","3a244b56":"# 2.StratifiedKFold Stacking","1a445039":"# 0.2 import libraries","a388cae8":"# 1.load data","33030e1b":"# 0.1 install pycaret ","477308a1":"# 3.Submission"}}