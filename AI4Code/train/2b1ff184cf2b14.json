{"cell_type":{"f64692d9":"code","f8753c9d":"code","0c5c90f0":"code","b27b7f46":"code","38a55dbc":"code","b9e7879a":"code","64f2aad1":"code","391e3146":"code","2b809608":"code","daba2b00":"code","345d68df":"code","788bc604":"code","bc31cf10":"code","68a607f2":"code","3b46ad68":"markdown","25142eb9":"markdown","3a911f81":"markdown","e75546e5":"markdown","dfa0b14e":"markdown","122814c9":"markdown","8ce63e56":"markdown","3c1d9e11":"markdown","3bb663ae":"markdown","d9a32e26":"markdown","5065245f":"markdown","7e5a4fe2":"markdown","8efbedb1":"markdown"},"source":{"f64692d9":"import os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","f8753c9d":"import pandas as pd","0c5c90f0":"data_df = pd.read_csv(\"\/kaggle\/input\/self-perceived-health-of-migrants-in-europe\/hlth_silc_23.tsv\", sep='\\t')","b27b7f46":"print(list(data_df.columns))","38a55dbc":"data_df.head()","b9e7879a":"data_df.tail()","64f2aad1":"pivot_data_col = data_df.columns[0]\nyear_columns = data_df.columns[1:]","391e3146":"data_df['sex'] = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[0])\ndata_df['age'] = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[1])\ndata_df['c_birth'] = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[2])\ndata_df['lev_perc'] = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[3])\ndata_df['geo']     = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[4])","2b809608":"selected_columns = list(['sex', 'age', 'c_birth', 'lev_perc', 'geo']) +  list(year_columns)\ndata_df = data_df[selected_columns]","daba2b00":"data_tr_df = data_df.melt(id_vars=['sex', 'age', 'c_birth', 'lev_perc', 'geo'], \n        var_name=\"year\", \n        value_name=\"value\")\ndata_tr_df['geo'] = data_tr_df['geo'].apply(lambda x: str(x))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"e\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"b\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"u\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"c\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"d\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"n\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"z\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"p\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\": \", \"NAN\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: float(x))","345d68df":"print(f\"Transformed data shape: {data_tr_df.shape} (rows\/columns)\")\ndata_tr_df.head()","788bc604":"data_tr_df.tail()","bc31cf10":"import pandas_profiling\npandas_profiling.ProfileReport(data_tr_df)","68a607f2":"data_tr_df.to_csv(\"self_perceived_health.csv\", index=False)","3b46ad68":"# Data pre-processing\n\nWe start by defining two working lists.","25142eb9":"# Introduction\n\nWe show in this Kernel how we can process the data to prepare it for easier processing. Let's check the data files.","3a911f81":"# Analysis preparation\n\n## Load packages","e75546e5":"Let's glimpse the data columns.","dfa0b14e":"Let's also take a look to few of the rows.","122814c9":"The first column is a composed one, containing 5 different information (unit, isced11 education indicator, isced13 education indicator, sex, geography). The next columns are temporal values, the years value.","8ce63e56":"Then, we split from `pivot_data_col` the 5 separate fields from `sex,age,c_birth,lev_perc,unit,geo\\time`:\n* sex;\n* age;   \n* c_birth;    \n* lev_perc;  \n* unit;  \n* geo - geography - mainly countries but also aggregated countries in EU;","3c1d9e11":"## Load the data\n\nThe datafiles are in TSV format. We will read the files using pandas, just include in the function call the `sep` (tab separator data).\nWe demonstrate first how to read and process the Annual data.","3bb663ae":"# Export data in csv format","d9a32e26":"Let's inspect the result.","5065245f":"Next, we pivot the time columns using `melt` operation in pandas.  \nWe also make sure we transform `date` to be an integer (here is a year data).  \nWe set `value` to be a float, after we replace \": \" (for N\/A) with `NAN`.","7e5a4fe2":"We select now only the new columns resulted from splitting the `pivot_data_col` and the time columns.","8efbedb1":"# A very preliminary exploratory data analysis\n\nThis would be a very short exploratory data analysis. The role of this Kernel is just to show how we can prepare the annual data for analysis and we already did this."}}