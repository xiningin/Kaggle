{"cell_type":{"a99f1c5a":"code","7fafa251":"code","15adf3fc":"code","d68c59c0":"code","56825a02":"code","70e81eb7":"code","5d9d6cbd":"code","804dc3fb":"code","6bca8370":"code","29417b71":"markdown","42571d23":"markdown","acb52ea5":"markdown","0a36592b":"markdown","5fa398ed":"markdown","31ff6588":"markdown"},"source":{"a99f1c5a":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)","7fafa251":"train = pd.read_csv('..\/input\/tabular-playground-series-aug-2021\/train.csv')\ntest = pd.read_csv('..\/input\/tabular-playground-series-aug-2021\/test.csv')\nprint('train shape:',train.shape)\nprint('test shape:',test.shape)","15adf3fc":"train.head()","d68c59c0":"# Train data\nX=train.drop(columns = ['loss','id'])\ny=train['loss'].values\n\n# Test data\nX_test=test.drop(columns = ['id'])\nprint('Train set:', X.shape)\nprint('Test set:', X_test.shape)","56825a02":"from catboost import CatBoostRegressor\n\nmodel = CatBoostRegressor(random_state = 44,\n                         thread_count = 4,\n                         verbose = False,\n                         loss_function = 'RMSE',\n                         eval_metric = 'RMSE',\n                         od_type = \"Iter\",\n                         early_stopping_rounds = 500,\n                         iterations = 10000,\n                         task_type = \"CPU\")\nmodel.fit(X, y, verbose=0)","70e81eb7":"from sklearn import metrics\n\nprint('R2 score: ', model.score(X, y))\npredicted = model.predict(X)\nrmse = metrics.mean_squared_error(y, predicted, squared=False)\nprint('RMSE: ', rmse)","5d9d6cbd":"y_pred = model.predict(X_test)","804dc3fb":"preds = pd.read_csv(\"..\/input\/tabular-playground-series-aug-2021\/sample_submission.csv\")\npreds.loss = y_pred\npreds.head()","6bca8370":"preds.to_csv('submission_catboost_101.csv', index=False)","29417b71":"# Imports","42571d23":"# Load dataset","acb52ea5":"# Prediction","0a36592b":"# Submission","5fa398ed":"# Train Catboost model","31ff6588":"# Model performance"}}