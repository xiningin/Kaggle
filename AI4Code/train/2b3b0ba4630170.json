{"cell_type":{"f4f2ba8f":"code","87edaae4":"code","61dfa8fc":"code","437f79b1":"code","6bf4b3c2":"code","6ca71bc3":"code","c9468766":"code","15f275c0":"code","fe56a223":"code","327db039":"code","3bc0143f":"code","c733907f":"markdown"},"source":{"f4f2ba8f":"pip install paramiko","87edaae4":"import numpy as np\nimport matplotlib.pyplot as plt\nimport pandas as pd\nimport math\nfrom pathlib import Path\nimport os\nimport itertools\nimport pytz","61dfa8fc":"import os\nfrom pathlib import Path\nimport os\nimport sqlite3\nimport paramiko\nimport numpy as np\nimport ftplib\nimport ipywidgets as widgets\nfrom IPython.display import display\n\ndef get_modbus(host_ip,port,username,password,pass_hours):\n     \n    \"\"\" Arg:\n        - host_ip  :     IP address of the data site\n        - port     :     Port number of the data site\n        - username :     \n        - password :\n        - pass_hours :   number of pass data point\n   \n    Returns:\n        - PV_data : dataframe with pass 12 hours solar power data in hourly rate.\n    \"\"\"\n    #host = \"80.113.19.27\"\n    #port = 22\n    #password = \"controlsystem\"\n    #username = \"pi\"\n\n    ssh = paramiko.SSHClient()\n    ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())\n    ssh.connect(host_ip, port, username, password)\n\n    ftp = ssh.open_sftp()\n    \n    data_d = ftp.chdir('\/mnt\/dav\/Data')\n    cwd=ftp.getcwd()\n    path = Path.cwd()\n    \n    ftp.get(\"modbusData.db\",\"modbusData.db\",callback=None)\n    \n    conn = sqlite3.connect(\"modbusData.db\")\n    query = '''SELECT * from PV'''\n    PV_data= pd.read_sql_query(query,conn)\n    PV_data['Time']=pd.to_datetime(PV_data['Time'],unit='s')\n    \n    # PV data hourly rate resample\n    PV_data= PV_data.sort_values(by='Time', ascending=True)\n    PV_data['Time']=pd.to_datetime(PV_data['Time'],unit='s')\n    PV_data = PV_data.set_index('Time')\n    PV_data=PV_data.resample('60min').mean()\n    PV_data = PV_data.tail(pass_hours)\n    \n    PV_data['index'] = PV_data.index\n    PV_data['index'] = PV_data['index'].apply(lambda x:x.to_pydatetime())\n    PV_data['year']  = PV_data['index'].apply(lambda x:x.year)\n    PV_data['month'] = PV_data['index'].apply(lambda x:x.month)\n    PV_data['day']   = PV_data['index'].apply(lambda x:x.day)\n    PV_data['hour']  = PV_data['index'].apply(lambda x:x.hour)\n    \n    return PV_data","437f79b1":"host_ip = \"80.113.19.27\"\nport = 22\npassword = \"controlsystem\"\nusername = \"pi\"\npass_hours = 12\n\nPV_data = get_modbus(host_ip,port,username,password,pass_hours)","6bf4b3c2":"PV_data","6ca71bc3":"# import module we'll need to import our custom module\nfrom shutil import copyfile\nfrom shutil import copytree\n\n# copy our file into the working directory (make sure it has .py suffix)\ncopytree(src = \"..\/input\/tripy-v0\/Tripy\", dst = \"..\/working\/Tripy\")","c9468766":"#!mkdir tripy\n#!mkdir tripy\/core","15f275c0":"# copy our file into the working directory (make sure it has .py suffix)\n#copyfile(src = \"..\/input\/tripy-v0\/Tripy\/fieldbus.py\", dst = \"..\/working\/tripy\/fieldbus.py\")\n#copyfile(src = \"..\/input\/tripy-v0\/Tripy\/model.py\", dst = \"..\/working\/tripy\/model.py\")\n#copyfile(src = \"..\/input\/tripy-v0\/Tripy\/core\/render.py\", dst = \"..\/working\/tripy\/core\/render.py\")\n#!ls -la","fe56a223":"#!cp -r ..\/input\/tripy-v0\/* .\/","327db039":"import Tripy as trp\n%matplotlib inline","3bc0143f":"#help(trp.Model)","c733907f":"# Example loading the triphase system model"}}