{"cell_type":{"90aa81c9":"code","fc961421":"code","6a63d37b":"code","91adf941":"code","8d22dec2":"code","7640e9b3":"code","03526b6e":"code","d6282052":"code","9084fd37":"code","e53be62c":"code","cfa778e0":"code","72bf699f":"code","6d301cea":"code","51d88860":"code","d537dba1":"code","29ae5074":"code","6467c80b":"code","af69c9db":"code","5edeb230":"code","ee87e7e0":"code","c2612578":"code","095c4a98":"code","e56e2484":"markdown","30f3d1d3":"markdown","f98dd4fa":"markdown","5ada1b66":"markdown","9262e122":"markdown"},"source":{"90aa81c9":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport statsmodels.api as sm\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import mean_absolute_error\nfrom sklearn.neighbors import KNeighborsRegressor","fc961421":"data=pd.read_csv('..\/input\/mt-cars\/Lesson 3 Practice\/mtcars.csv')","6a63d37b":"data.head()","91adf941":"sns.distplot(data['hp'])\nplt.axvline(data['hp'].values.mean(), color='red', linestyle='dashed', linewidth=1)\n","8d22dec2":"data=data.dropna()","7640e9b3":"plt.figure(figsize=(18,8))\nsns.heatmap(data.corr(),annot = True, vmin=-1, vmax=1, center= 0, cmap= 'coolwarm', linewidths=3, linecolor='black')\n","03526b6e":"#Changing the matrix shape\n\n\nplt.figure(figsize=(15, 10))\nmatrix= np.zeros_like(data.corr())\nmatrix[np.triu_indices_from(data.corr())] = True\nmatrix = np.triu(data.corr())\nsns.heatmap(data.corr(), annot = True, vmin=-1, vmax=1, center= 0, cmap= 'coolwarm', mask=matrix)","d6282052":"# Horse power is pretty dependent on  Cyl , Disp , wt and carb","9084fd37":"x=data[['cyl']]","e53be62c":"y=data['hp'].values","cfa778e0":"model1 = sm.OLS(x,y)\nresults = model1.fit()\nprint(results.summary())","72bf699f":"# Trying out linear regression\nx=data[['cyl','disp','wt','carb']].values","6d301cea":"lr=LinearRegression()","51d88860":"X_train, X_test, y_train, y_test = train_test_split( x, y, test_size=0.2)","d537dba1":"lr.fit(X_train,y_train)","29ae5074":"print('The mean absolute score is :',mean_absolute_error(lr.predict(X_test),y_test))","6467c80b":"ad=KNeighborsRegressor(metric='euclidean', n_jobs=1, n_neighbors=1,\n                    weights='distance')","af69c9db":"ad.fit(X_train,y_train)","5edeb230":"print('The mean absolute score is :',mean_absolute_error(ad.predict(X_test),y_test))","ee87e7e0":"#HRK work starts here onward\nfrom xgboost import XGBRegressor\n# XGBoost with Parameter Tuning\nmy_model = XGBRegressor(n_estimators=1000, learning_rate=0.01, n_jobs=4)\nmy_model.fit(X_train, y_train, \n             early_stopping_rounds=5, \n             eval_set=[(X_test, y_test)], \n             verbose=False)","c2612578":"predictions = my_model.predict(X_test)\nprint(\"Mean Absolute Error: \" + str(mean_absolute_error(predictions, y_test)))","095c4a98":"# That is a remarkable reduction in MAE","e56e2484":"MT CARS ","30f3d1d3":"![download.jpg](attachment:download.jpg)","f98dd4fa":"![dataset-cover.jpg](attachment:dataset-cover.jpg)","5ada1b66":"Over here the red dashed line represents  the mean of the horse power of the mt cars company which shows that the average horse power of the cars basically lines on 150 which is pretty much the average of the most of the cars in USA but looking at the bigger picture we also see that most of the cars lies in between the range of 50-100 horsepower .. ..","9262e122":"From this we can see most of the cars have horse power which is between 50-100 which is pretty low huh !!\nIt has been recorded that average cars have horse power like 170 -190 and small one's can have like 120-130 but 50-100 is low!!"}}