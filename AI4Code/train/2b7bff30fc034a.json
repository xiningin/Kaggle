{"cell_type":{"c168ba79":"code","18262119":"code","65b0d4f1":"code","653d62f9":"code","b2baf673":"code","3b0ee790":"code","e8aea633":"code","df888fe6":"code","71b35bcb":"code","ad95d68e":"code","0b3083e0":"code","38a63f04":"code","9bcb84cd":"code","a9b11206":"code","42ca81eb":"code","25783fe7":"code","e504be29":"code","3c288cce":"code","a8083579":"code","27d1cfa2":"code","4a91f09c":"code","56fab923":"code","3060bf09":"code","8bc5bb9a":"code","10e0cdf8":"code","52a7e23d":"code","6e88e618":"code","7e4c5411":"code","e8470dd7":"code","ddb378c9":"code","cf9505a5":"code","69846c5c":"code","2e530366":"code","d9df1f5b":"code","ed6357cf":"code","b48211cf":"code","cbda3aee":"code","fbab583a":"code","73b125a4":"code","48076a6f":"code","cea72123":"code","e958cd14":"code","b56a4b87":"code","cade7bbc":"markdown","24db7083":"markdown","6c639230":"markdown","08378fc4":"markdown","e68f0040":"markdown","1994a381":"markdown","77ac335d":"markdown","8650b411":"markdown","fff83c51":"markdown","79a3bb5a":"markdown","766a96cb":"markdown","4d7c48b3":"markdown","e288ea85":"markdown","df245159":"markdown","278d63f6":"markdown","0a6bc324":"markdown","6df0cf7b":"markdown","77624b05":"markdown","3a6d302c":"markdown","b15ae984":"markdown","e3d0ec01":"markdown","d45a5994":"markdown"},"source":{"c168ba79":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns","18262119":"import os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","65b0d4f1":"# Local\n# df = pd.read_csv('Data\/dataset.csv')\n\n# Kaggle\ndf = pd.read_csv('\/kaggle\/input\/brain-weight-in-humans\/dataset.csv')\ndf.head()","653d62f9":"df","b2baf673":"df.info()","3b0ee790":"df.isnull().sum()","e8aea633":"plt.figure(figsize=(20,10))\nplt.title('Histogram of Brain Weight(grams)')\nsns.histplot(data=df, x='Brain Weight(grams)', kde=True, bins=15);","df888fe6":"plt.figure(figsize=(20,10))\nplt.title('Histogram of Brain Weight(grams), colored by Gender')\nsns.histplot(data=df, x='Brain Weight(grams)',hue='Gender', kde=True, bins=15);","71b35bcb":"plt.figure(figsize=(20,10))\nplt.title('Plot of Head Size(cm^3) vs Brain Weight(grams), colored by Gender')\nsns.scatterplot(data=df, x='Brain Weight(grams)',y='Head Size(cm^3)', hue='Gender',s=150);","ad95d68e":"plt.figure(figsize=(20,10))\nplt.title('Plot of Head Size(cm^3) vs Brain Weight(grams), colored by Age Group')\nsns.scatterplot(data=df, x='Brain Weight(grams)',y='Head Size(cm^3)', hue='Age Range',s=150);","0b3083e0":"plt.figure(figsize=(20,10))\nplt.title('Boxplot of Brain Weight(grams)')\nsns.boxplot(data=df, x='Brain Weight(grams)');","38a63f04":"plt.figure(figsize=(20,10))\nplt.title('Boxplot of Head Size(cm^3)')\nsns.boxplot(data=df, x='Head Size(cm^3)');","9bcb84cd":"df[(df['Brain Weight(grams)']<1000) | (df['Brain Weight(grams)'] > 1570)]","a9b11206":"df[df['Head Size(cm^3)'] > 4600]","42ca81eb":"X = df.drop('Brain Weight(grams)', axis=1)\ny = df['Brain Weight(grams)']","25783fe7":"from sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import StandardScaler","e504be29":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)","3c288cce":"scaler = StandardScaler()\nX_train = scaler.fit_transform(X_train)\nX_test = scaler.transform(X_test)","a8083579":"from sklearn.linear_model import Ridge\nfrom sklearn.linear_model import Lasso\nfrom sklearn.linear_model import ElasticNet\nfrom sklearn.neighbors import KNeighborsRegressor\nfrom sklearn.svm import SVR, LinearSVR\nfrom sklearn.tree import DecisionTreeRegressor\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.ensemble import GradientBoostingRegressor\nfrom sklearn.ensemble import AdaBoostRegressor\nfrom xgboost import XGBRegressor, XGBRFRegressor\nfrom catboost import CatBoostRegressor\nfrom sklearn.linear_model import LinearRegression","27d1cfa2":"from sklearn.metrics import mean_squared_error, r2_score","4a91f09c":"def fit_and_score(models, X_train, X_test, y_train, y_test):\n    np.random.seed(42)\n    \n    model_scores = {}\n    model_rsme = {}\n    model_r2 = {}\n    \n    for name, model in models.items():\n        model.fit(X_train,y_train)\n        model_scores[name] = model.score(X_test,y_test)\n        y_preds = model.predict(X_test)\n        model_rsme[name] = np.sqrt(mean_squared_error(y_test,y_preds))\n        model_r2[name] = r2_score(y_test,y_preds)\n\n    model_scores = pd.DataFrame(model_scores, index=['Score']).transpose()\n    model_scores = model_scores.sort_values('Score')\n    \n    model_rsme = pd.DataFrame(model_rsme, index=['RSME']).transpose()\n    model_rsme = model_rsme.sort_values('RSME')\n    \n    model_r2 = pd.DataFrame(model_r2, index=['R2']).transpose()\n    model_r2 = model_r2.sort_values('R2')\n        \n    return model_scores,model_rsme, model_r2","56fab923":"models = {'Ridge' : Ridge(),\n         'Lasso': Lasso(),\n         'ElasticNet': ElasticNet(),\n         'KNeighborsRegressor': KNeighborsRegressor(),\n         'SVR': SVR(),\n         'DecisionTreeRegressor': DecisionTreeRegressor(),\n         'RandomForestRegressor':RandomForestRegressor(),\n         'GradientBoostingRegressor': GradientBoostingRegressor(),\n         'AdaBoostRegressor': AdaBoostRegressor(),\n        'XGBRegressor': XGBRegressor(objective='reg:squarederror'),\n        'XGBRFRegressor': XGBRFRegressor(objective='reg:squarederror'),\n          'CatBoostRegressor': CatBoostRegressor(verbose=0)\n         }","3060bf09":"model_scores_baseline, model_rsme_baseline, model_r2_baseline = fit_and_score(models, X_train, X_test, y_train, y_test)","8bc5bb9a":"model_scores_baseline","10e0cdf8":"model_rsme_baseline.sort_values('RSME', ascending=False)","52a7e23d":"model_r2_baseline","6e88e618":"from sklearn.model_selection import GridSearchCV\nfrom warnings import filterwarnings","7e4c5411":"filterwarnings('ignore')","e8470dd7":"def gridsearch_cv_scores(models, params, X_train, X_test, y_train, y_test):\n    np.random.seed(42)\n    \n    model_gs_scores = {}\n    model_gs_best_param = {}\n    \n    for name, model in models.items():\n        gs_model = GridSearchCV(model,\n                                param_grid=params[name],\n                                scoring='neg_root_mean_squared_error',\n                                n_jobs=-1,\n                                cv=5,\n                                verbose=2)\n        \n        gs_model.fit(X_train,y_train)\n\n        model_gs_scores[name] = gs_model.score(X_test,y_test)\n        model_gs_best_param[name] = gs_model.best_params_\n\n    model_gs_scores = pd.DataFrame(model_gs_scores, index=['neg_mean_squared_error'])\n    model_gs_scores = model_gs_scores.transpose().sort_values('neg_mean_squared_error')\n        \n    return model_gs_scores, model_gs_best_param","ddb378c9":"models = {'Ridge': Ridge()}\nparams = {'Ridge':{}}","cf9505a5":"model_gs_scores_base, model_gs_best_param_base =  gridsearch_cv_scores(models, params, X_train, X_test, y_train, y_test)","69846c5c":"model_gs_scores_base","2e530366":"models = {'Ridge': Ridge()}\n\nparams = {'Ridge':{'alpha': np.arange(0,1,0.01),\n                  'fit_intercept': [True,False],\n                  'normalize':[True, False],\n                  'solver': ['auto', 'svd', 'cholesky', 'lsqr', 'sparse_cg', 'sag', 'saga']}\n         }","d9df1f5b":"model_gs_scores_1, model_gs_best_param_1 =  gridsearch_cv_scores(models, params, X_train, X_test, y_train, y_test)","ed6357cf":"model_gs_scores_1","b48211cf":"model_gs_best_param_1","cbda3aee":"model = Ridge()\nmodel.fit(X_train, y_train)\ny_preds = model.predict(X_test)","fbab583a":"feat_importance = pd.DataFrame(model.coef_, index=X.columns)","73b125a4":"feat_importance","48076a6f":"plt.figure(figsize=(20,10))\nplt.title('Feature Importance')\nsns.barplot(data= feat_importance.sort_values(0).T);","cea72123":"from sklearn.metrics import mean_absolute_error","e958cd14":"r2 = r2_score(y_test,y_preds)\nmae = mean_absolute_error(y_test, y_preds)\nmse = mean_squared_error(y_test, y_preds)\nrmse = np.sqrt(mse)","b56a4b87":"print(f'R2 Score: {r2}')\nprint(f'Mean Absolute Error: {mae}')\nprint(f'Mean Square Error: {mse}')\nprint(f'Root Mean Square Error: {rmse}')","cade7bbc":"## Import Models","24db7083":"## Baseline Models and Scores","6c639230":"# Brain weight in humans Regression","08378fc4":"## Reading the DataSet","e68f0040":"We will use the Ridge model and Tune the hyperparameter to see how it perform","1994a381":"## Standard Import","77ac335d":"## Grid CV search","8650b411":"Going to take the following approach:\n\n1. Problem definition\n2. Data\n3. Evaluation\n4. Features\n5. Modelling\n6. Model Evaluation\n7. Experimentation \/ Improvements","fff83c51":"# 5. Modelling","79a3bb5a":"## Outlier detection","766a96cb":"# 6. Model Evalution ","4d7c48b3":"### GS model 1","e288ea85":"# 4. Features\n\n## Inputs \/ Features\n\n    1. Gender - 1 represents Male , 2 represents Female\n    2. Age Range - 1 represents >18 years of age , 2 represents <18 years of age\n    3. Head Size(cm^3) - Head volume in cubic centimetres\n\n## Output \/ Label\n    4. Brain Weight(grams)Mass of brains in grams","df245159":"# 3. Evaluation\n\nAs this is a Regression problem, we will use the Root mean square error for evauluting the model","278d63f6":"As from the boxplot we can see that there are outlier in this dataset.\nAs We are no domain expert in this field, we will choose to keep in the dataset as the data suggest that is linear","0a6bc324":"Since there is no improvment with the grid search CV, we will use the base model and do a Evalution on it.","6df0cf7b":"### Baseline Grid Search CV","77624b05":"## Feature Importance","3a6d302c":"## Metrics Evalution","b15ae984":"## Data Exporation","e3d0ec01":"# 2. Data\n\nData from: https:\/\/www.kaggle.com\/anubhabswain\/brain-weight-in-humans\n\n## Context\n\nThis dataset was compiled using a medical study conducted on a group of people.\n\n## Content\n\nThis dataset shows a few variations of head sizes and masses of brains, it also consists additional gender and age group columns.\n","d45a5994":"# 1. Problem Definition\n\nHow we can use various python based Machine Learning Model and the given parameters to predict The weight of a human brain?"}}