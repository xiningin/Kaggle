{"cell_type":{"2902d2c4":"code","ee4c909f":"code","5c6e9bfb":"code","8728346b":"code","2ad5fa3f":"code","2d08ec2d":"code","49cfc343":"code","a8bb35b7":"code","35c3dcc6":"code","0e0cef78":"code","04ece934":"code","964233d1":"code","89fda714":"code","0e57cddf":"code","1e8cde18":"code","59ba2da1":"code","9ea2f15a":"code","ac51799c":"code","555c6a65":"markdown"},"source":{"2902d2c4":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns","ee4c909f":"df= pd.read_csv('..\/input\/heart-attack-analysis-prediction-dataset\/heart.csv')\ndf.head()","5c6e9bfb":"df.shape","8728346b":"df.info()","2ad5fa3f":"for i in df.columns:\n    print('Unique Values of {} are {}\\n'.format(i.upper(), df[i].unique()))\n    print(df[i].value_counts(normalize= True))\n    print('-' * 100)","2d08ec2d":"l= ['age', 'trtbps', 'chol', 'thalachh', 'oldpeak']\nplt.figure(figsize= (15,20))\n\nn=1\nfor i in l:\n    plt.subplot(3,2,n)\n    sns.boxplot(x= 'output', y= i, data= df,)\n    plt.title('Boxplot of {}'.format(i.upper()), fontsize= 16)\n    n+=1","49cfc343":"l= ['age', 'trtbps', 'chol', 'thalachh', 'oldpeak']\nplt.figure(figsize= (15,20))\n\nn=1\nfor i in l:\n    plt.subplot(3,2,n)\n    sns.histplot(x= i, data= df, kde= True, hue= 'output')\n    plt.title('Histogram of {}'.format(i.upper()), fontsize= 16)\n    n+=1","a8bb35b7":"sns.pairplot(df, y_vars= ['age', 'trtbps', 'chol', 'thalachh', 'oldpeak'], \n             x_vars= ['age', 'trtbps', 'chol', 'thalachh', 'oldpeak'],\n            diag_kind= None, hue= 'output', kind= 'reg')","35c3dcc6":"plt.figure(figsize= (15,20))\n\nplt.subplot(4,2,1)\nplt.pie(df.output.value_counts(), explode= [0.05, 0.05], labels= df.output.value_counts().index, \n        autopct= '%.2f%%', startangle= 90, shadow= True)\nplt.title('Output', fontsize= 16)\nplt.legend(['More Chance of Heart Attack', 'Less Chance of Heart Attack'])\n\nplt.subplot(4,2,2)\nplt.pie(df.sex.value_counts(), explode= [0.05, 0.05], labels= df.sex.value_counts().index, \n        autopct= '%.2f%%', startangle= 90, shadow= True)\nplt.title('SEX', fontsize= 16)\n\nplt.subplot(4,2,3)\nplt.pie(df.cp.value_counts(), explode= [0.05, 0.05, 0.05, 0.05], labels= df.cp.value_counts().index, \n        autopct= '%.2f%%', startangle= 90, shadow= True)\nplt.title('Chest Pain Type', fontsize= 16)\nplt.legend(['Typical Angina', 'Atypical Angina', ' Non-Anginal Pain', 'Asymptomatic'])\n\nplt.subplot(4,2,4)\nplt.pie(df.fbs.value_counts(), explode= [0.05, 0.05], labels= df.fbs.value_counts().index, \n        autopct= '%.2f%%', startangle= 90, shadow= True)\nplt.title('Fasting Blood Sugar', fontsize= 16)\nplt.legend(['fbs < 120mg\/dl', 'fbs > 120mg\/dl'])\n\nplt.subplot(4,2,5)\nplt.pie(df.restecg.value_counts(), explode= [0.05, 0.05, 0.05], labels= df.restecg.value_counts().index, \n        autopct= '%.2f%%', startangle= 90, shadow= True)\nplt.title('Resting Electrocardiographic Results', fontsize= 16)\nplt.legend(['Normal', ' Having ST-T Wave Abnormality', ' Probable or Definite Left Ventricular Hypertrophy'])\n\nplt.subplot(4,2,6)\nplt.pie(df.exng.value_counts(), explode= [0.05, 0.05], labels= df.exng.value_counts().index, \n        autopct= '%.2f%%', startangle= 90, shadow= True)\nplt.title('Exercise Induced Angina', fontsize= 16)\nplt.legend(['No', 'Yes'])\n\nplt.subplot(4,2,7)\nplt.pie(df.caa.value_counts(), explode= [0.05, 0.05, 0.05, 0.05, 0.2], labels= df.caa.value_counts().index, \n        autopct= '%.2f%%', startangle= 90, shadow= True)\nplt.title('Number of Major Vessels', fontsize= 16)\n\nplt.subplot(4,2,8)\nplt.pie(df.thall.value_counts(), explode= [0.05, 0.05, 0.05, 0.2], labels= df.thall.value_counts().index, \n        autopct= '%.2f%%', startangle= 90, shadow= True)\nplt.title('Maximum Heart Rate Achieved', fontsize= 16)\n\nplt.show()","0e0cef78":"corr= df.corr()\n\nplt.figure(figsize= (15,7))\nsns.heatmap(corr, annot= True, linewidths= 2)\nplt.title('Correlation Matrix', fontsize= 16)\n\nplt.show()","04ece934":"from sklearn.metrics import accuracy_score, classification_report, confusion_matrix\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.model_selection import train_test_split, cross_val_score, KFold\nfrom sklearn.ensemble import AdaBoostClassifier, RandomForestClassifier\nfrom sklearn.svm import SVC\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.tree import DecisionTreeClassifier","964233d1":"seed= 123\nnp.random.seed(seed)\n\nx= df.drop(columns= 'output')\ny= df.output\n\nx_train, x_test, y_train, y_test= train_test_split(x, y, test_size= 0.5, stratify= y)","89fda714":"pipelines= []\n\npipelines.append(('AdaBoost', Pipeline([('Scaler', StandardScaler()), ('AdaBoost', AdaBoostClassifier())])))\npipelines.append(('RandomForest', Pipeline([('Scaler', StandardScaler()), ('RandomForest', RandomForestClassifier())])))\npipelines.append(('SVC', Pipeline([('Scaler', StandardScaler()), ('SVC', SVC())])))\npipelines.append(('Logistic', Pipeline([('Scaler', StandardScaler()), ('Logistic', LogisticRegression())])))\npipelines.append(('KNeighbors', Pipeline([('Scaler', StandardScaler()), ('KNeighbors', KNeighborsClassifier())])))\npipelines.append(('DecisionTree', Pipeline([('Scaler', StandardScaler()), ('DecisionTree', DecisionTreeClassifier())])))\npipelines","0e57cddf":"np.random.seed(seed)\n\nresults= []\nnames= []\n\nfor name, model in pipelines:\n    kfold= KFold(n_splits= 10, shuffle= True)\n    cv_results= cross_val_score(estimator= model, X= x_train, y= y_train, cv= kfold, scoring= 'accuracy')*100\n    mean= cv_results.mean()\n    std= cv_results.std()\n    print('{:12} : Average Accuracy {:.2f}% - Std {:.2f}%'.format(name, mean, std))\n    results.append(cv_results)\n    names.append(name)","1e8cde18":"plt.figure(figsize= (10,5))\nplt.boxplot(results, labels= names)\nplt.title('Models Comparison', fontsize= 16)\nplt.show()","59ba2da1":"np.random.seed(seed)\n\nscaler= StandardScaler()\nx_train_scaler= scaler.fit_transform(x_train)\nx_test_scaler= scaler.fit_transform(x_test)\n\nmodel= SVC()\nmodel.fit(x_train_scaler, y_train)\ny_pred= model.predict(x_test_scaler)","9ea2f15a":"print('Classification Report\\n', classification_report(y_test, y_pred))\n\nprint('Accuracy: {}%\\n'.format(round((accuracy_score(y_test, y_pred)*100),2)))","ac51799c":"plt.figure(figsize= (15,7))\n\nplt.subplot(1,2,1)\ncm= confusion_matrix(y_test, y_pred)\nsns.heatmap(cm, annot= True, fmt= 'd', xticklabels=['Less Chance', 'More Chance'],\n           yticklabels=['Less Chance', 'More Chance'])\nplt.title('Confusion Matrix - Normal')\n\nplt.subplot(1,2,2)\ncmp= confusion_matrix(y_test, y_pred, normalize= 'true')\nsns.heatmap(cmp, annot= True, xticklabels=['Less Chance', 'More Chance'],\n           yticklabels=['Less Chance', 'More Chance'])\nplt.title('Confusion Matrix - Percent')","555c6a65":"## Heart Attack Analysis & Prediction Dataset"}}