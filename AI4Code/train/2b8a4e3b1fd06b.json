{"cell_type":{"c91606d4":"code","8993f4fe":"code","8e71678e":"code","12f62f0b":"code","2cbf4d2d":"code","6e61c743":"code","1a620e8d":"code","0c0371a6":"code","3ce3e671":"code","2f0d0ead":"code","302a5e6d":"code","9d176256":"code","3c7b641a":"code","c3cad6e8":"code","fa5ade0b":"code","92203133":"code","bca442b4":"code","5bc792ad":"code","f6e5e23b":"markdown","3b7612e5":"markdown","a2f7bdde":"markdown","edd5b32d":"markdown","40a16b96":"markdown","16fe84eb":"markdown"},"source":{"c91606d4":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns","8993f4fe":"data = pd.read_csv('..\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv')\ndata","8e71678e":"data.info()","12f62f0b":"data.describe()","2cbf4d2d":"data.isnull().sum() #Checking if any null value in any column","6e61c743":"sns.countplot(x=\"Gender\",data = data) #Count the number of each gender","1a620e8d":"#creating boxplot to show the median, Quartile 1, Quartile 3, minimum value, maximum value and Outliers. \n\nplt.figure(figsize=(15,6))\nplt.subplot(1,2,1)\nsns.boxplot(y=data[\"Spending Score (1-100)\"], color=\"red\")\nplt.subplot(1,2,2)\nsns.boxplot(y=data[\"Annual Income (k$)\"])\nplt.show()","0c0371a6":"#Count the range of the age of customers\nage10_20 = data.Age[(data.Age <= 20) & (data.Age >= 10)]\nage21_30 = data.Age[(data.Age <= 30) & (data.Age >= 21)]\nage31_40 = data.Age[(data.Age <= 40) & (data.Age >= 31)]\nage41_50 = data.Age[(data.Age <= 50) & (data.Age >= 41)]\nage50above = data.Age[data.Age >= 51]\n\nx = [\"10-20\",\"21-30\",\"31-40\",\"41-50\",\"50+\"]\ny = [len(age10_20),len(age21_30),len(age31_40),len(age41_50),len(age50above)]\n\nplt.figure(figsize=(15,6))\nsns.barplot(x=x, y=y, palette=\"rocket\")\nplt.title(\"Number of Customer and Ages\")\nplt.xlabel(\"Age range\")\nplt.ylabel(\"Number of Customer\")\nplt.show()","3ce3e671":"#Number of customers according to their spending scores.\n\nss1_20 = data[\"Spending Score (1-100)\"][(data[\"Spending Score (1-100)\"] >= 1) & (data[\"Spending Score (1-100)\"] <= 20)]\nss21_40 = data[\"Spending Score (1-100)\"][(data[\"Spending Score (1-100)\"] >= 21) & (data[\"Spending Score (1-100)\"] <= 40)]\nss41_60 = data[\"Spending Score (1-100)\"][(data[\"Spending Score (1-100)\"] >= 41) & (data[\"Spending Score (1-100)\"] <= 60)]\nss61_80 = data[\"Spending Score (1-100)\"][(data[\"Spending Score (1-100)\"] >= 61) & (data[\"Spending Score (1-100)\"] <= 80)]\nss81_100 = data[\"Spending Score (1-100)\"][(data[\"Spending Score (1-100)\"] >= 81) & (data[\"Spending Score (1-100)\"] <= 100)]\n\nscore_range = [\"1-20\", \"21-40\", \"41-60\", \"61-80\", \"81-100\"]\nnumber = [len(ss1_20), len(ss21_40), len(ss41_60), len(ss61_80), len(ss81_100)]\n\nplt.figure(figsize=(15,6))\nsns.barplot(x=score_range, y=number)\nplt.title(\"Spending Scores\")\nplt.xlabel(\"Score\")\nplt.ylabel(\"Number of Customer Having the Score\")\nplt.show()","2f0d0ead":"#Number of customers according to their annual income. \n\nai0_30 = data[\"Annual Income (k$)\"][(data[\"Annual Income (k$)\"] >= 0) & (data[\"Annual Income (k$)\"] <= 30)]\nai31_60 = data[\"Annual Income (k$)\"][(data[\"Annual Income (k$)\"] >= 31) & (data[\"Annual Income (k$)\"] <= 60)]\nai61_90 = data[\"Annual Income (k$)\"][(data[\"Annual Income (k$)\"] >= 61) & (data[\"Annual Income (k$)\"] <= 90)]\nai91_120 = data[\"Annual Income (k$)\"][(data[\"Annual Income (k$)\"] >= 91) & (data[\"Annual Income (k$)\"] <= 120)]\nai121_150 = data[\"Annual Income (k$)\"][(data[\"Annual Income (k$)\"] >= 121) & (data[\"Annual Income (k$)\"] <= 150)]\n\nMoney_range = [\"$ 0 - 30,000\", \"$ 30,001 - 60,000\", \"$ 60,001 - 90,000\", \"$ 90,001 - 120,000\", \"$ 120,001 - 150,000\"]\nnumber = [len(ai0_30), len(ai31_60), len(ai61_90), len(ai91_120), len(ai121_150)]\n\nplt.figure(figsize=(15,6))\nsns.barplot(x=Money_range, y=number)\nplt.title(\"Annual Incomes\")\nplt.xlabel(\"Income\")\nplt.ylabel(\"Number of Customer\")\nplt.show()","302a5e6d":"data.drop('CustomerID',axis=1,inplace=True)","9d176256":"sns.pairplot(data) # Gives insight of how columns are related to each other","3c7b641a":"from sklearn.cluster import KMeans","c3cad6e8":"X1 = data[['Annual Income (k$)' , 'Spending Score (1-100)']].values\nX1","fa5ade0b":"cluster_sumofsquare = [] # Will save the values of all clusters sum of squares, which means how far the observed values is from centroid\n\nfor k in range(1,11):\n    kmeans = KMeans(n_clusters=k)\n    kmeans.fit(X1)\n    cluster_sumofsquare.append(kmeans.inertia_)\n\nplt.figure(figsize=(12,6))    \nplt.grid()\nplt.plot(cluster_sumofsquare)\nplt.xlabel(\"K Value\")\nplt.ylabel(\"WCSS\")\nplt.show()","92203133":"model = (KMeans(n_clusters = 5) )\n\nmodel.fit(X1)\nmodel","bca442b4":"labels2 = model.labels_\ncentroids2 = model.cluster_centers_\n\nprint(labels2)  #Labels of each point, means to which cluster they belong\nprint(centroids2) #centroids of each cluster in both columns","5bc792ad":"#Clusters in 3d projection\n\ndata['label'] = labels2 \n\nfig = plt.figure(figsize=(20,10))\nax = fig.add_subplot(111, projection='3d')\nax.scatter(data[\"Annual Income (k$)\"][data.label == 0], data[\"Spending Score (1-100)\"][data.label == 0], c='blue', s=60)\nax.scatter(data[\"Annual Income (k$)\"][data.label == 1], data[\"Spending Score (1-100)\"][data.label == 1], c='red', s=60)\nax.scatter(data[\"Annual Income (k$)\"][data.label == 2], data[\"Spending Score (1-100)\"][data.label == 2], c='green', s=60)\nax.scatter(data[\"Annual Income (k$)\"][data.label == 3], data[\"Spending Score (1-100)\"][data.label == 3], c='orange', s=60)\nax.scatter(data[\"Annual Income (k$)\"][data.label == 4], data[\"Spending Score (1-100)\"][data.label == 4], c='purple', s=60)\nax.view_init(30, 185)\nplt.xlabel(\"Annual Income\")\nplt.ylabel(\"Spending Score (1-100)\")\n\nplt.show()","f6e5e23b":"We can see at k=5, Elbow is Bending so k=5 is best number of Cluster in this case.","3b7612e5":"Majority of customers having score between 41 to 60","a2f7bdde":"The majority of the customers have annual income in the range 60000 and 90000.","edd5b32d":"#### Business Engagement \nAssumption - \n1. Customers came to a shop in Mall.\n2. They have some definite income and the money they spend is scored between 1 to 100 (More the score, More they spend). ","40a16b96":"Now first we will find the optimal value of K. ","16fe84eb":"Now we will cluster our data, that is dividing the dataset into groups. \nWe will segment our data based on Annual income and spending score only as the rest of the data seems clean. \nWe will use K-Means clustering algorithm which is an unsupervised learning algorithm"}}