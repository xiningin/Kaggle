{"cell_type":{"2b53f81e":"code","aebbf206":"code","6dd3b546":"code","939ccb13":"code","1cd17359":"code","b1d09bf0":"code","573263a9":"code","07441e2c":"code","d204a6f9":"code","28f8fc76":"code","9a6abd76":"code","e4573ba6":"code","b73f963a":"code","98681f33":"code","f7221a7c":"code","e54bd238":"code","087ebfff":"markdown","7477a774":"markdown"},"source":{"2b53f81e":"import pandas as pd \nimport numpy as np\nfrom matplotlib import pyplot as plt\nimport seaborn as sns\n%matplotlib inline\n\n","aebbf206":"df=pd.read_csv(\"..\/input\/titanic\/train.csv\",index_col=\"PassengerId\")\n\n","6dd3b546":"l,b=df.shape\ndf[\"Age\"].fillna(df[\"Age\"].median(),inplace=True)\ndf[\"Cabin\"].fillna(\"ab\",inplace=True)\ndf[\"Embarked\"].fillna(\"S\",inplace=True)\n","939ccb13":"#df[\"Sex\"]=df[\"Sex\"].replace({\"male\":str(0),\"female\":str(1)})\n#filt=(df[\"Survived\"]==1)\n#dff=df[[\"Survived\",\"Sex\"]]\n#dff=dff.groupby(\"Sex\")\n#dff[\"Survived\"].sum().plot(kind=\"bar\")","1cd17359":"df[\"Sex\"]=df[\"Sex\"].replace({\"male\":str(1),\"female\":str(0)}).astype(int)","b1d09bf0":"from sklearn.preprocessing import LabelEncoder\nle=LabelEncoder()\ndf[\"Embarked\"]=le.fit_transform(df[\"Embarked\"])","573263a9":"q=df[\"Fare\"].quantile(0.99)\ndf2=df[df[\"Fare\"]<q]\ntar=df2['Survived']\nfea=df2.drop([\"Survived\",\"Name\",\"Ticket\",\"Cabin\"],axis=1)\n\n","07441e2c":"#scaler=MinMaxScaler()\n#fea[[\"Fare\",\"Age\"]]=scaler.fit_transform(fea[[\"Fare\",\"Age\"]])","d204a6f9":"from sklearn.model_selection import train_test_split\nxtrain,xtest,ytrain,ytest=train_test_split(fea,tar,test_size=0.3,random_state=42,shuffle=True)","28f8fc76":"from sklearn.model_selection import cross_validate,GridSearchCV\nfrom sklearn.metrics import confusion_matrix , accuracy_score\nfrom xgboost import XGBClassifier\nreg=XGBClassifier()\n","9a6abd76":"params={\"n_estimators\":[67,70,100,120],'reg_lambda':[2,1],'gamma':[0,0.3,0.2,0.1]\n       ,'eta':[0.06,0.05,0.04]\n        ,\"max_depth\":[3,5],'objective':['binary:logistic']}\n\n","e4573ba6":"clf=GridSearchCV(reg,params,cv=10,n_jobs=-1,verbose=1)\nclf.fit(xtrain,ytrain)","b73f963a":"ypred=clf.predict(xtrain)\ntpred=clf.predict(xtest)\nprint(accuracy_score(ypred,ytrain))\nprint(accuracy_score(tpred,ytest))\nclf.best_params_","98681f33":"#gen=pd.read_csv(\"C:\/Users\/hp\/Downloads\/gender_submission (1).csv\")\n#gpred=gen[\"Survived\"]","f7221a7c":"tes=pd.read_csv(\"..\/input\/titanic\/test.csv\",index_col=\"PassengerId\")\n","e54bd238":"tes[\"Age\"]=tes[\"Age\"].fillna(tes[\"Age\"].median())\ntes[\"Sex\"]=le.fit_transform(tes[\"Sex\"])\ntes[\"Embarked\"]=le.fit_transform(tes[\"Embarked\"])\ntes[\"Fare\"]=tes[\"Fare\"].fillna(tes[\"Fare\"].median())\ntes.isnull().sum()\ntfea=tes.drop([\"Name\",\"Ticket\",\"Cabin\"],axis=1)\n#tfea[[\"Fare\",\"Age\"]]=scaler.fit_transform(tfea[[\"Fare\",\"Age\"]])\nmy_pred=clf.predict(tfea)\nsubmit=pd.DataFrame(tes.index,columns=[\"PassengerId\"])\nsubmit[\"Survived\"]=my_pred\nsubmit","087ebfff":"removing outliers.","7477a774":"# Data preprocessing.\n1.Cleaning"}}