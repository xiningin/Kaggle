{"cell_type":{"ebd663ab":"code","80db416a":"code","dbec7e9f":"code","a559cd57":"code","ee4a10bd":"code","2751271a":"code","f8ce0d6b":"code","578d9e7e":"code","005afc51":"code","b47ce566":"code","d4cbd8d0":"code","77b9248d":"code","acb46237":"code","19174295":"code","7aaf4f6a":"code","e3274e36":"code","4473cf59":"code","cb6b365d":"code","f57c54c8":"code","0b4e92f6":"code","89e3d7a7":"code","2d167b36":"code","481a3d71":"code","5c5cf3f4":"markdown","b02058cc":"markdown","3b8ed445":"markdown","7b9eacbc":"markdown","3a56b961":"markdown","f68c16b1":"markdown","11e429b3":"markdown","7d104b56":"markdown","7f2dd039":"markdown","400d83e9":"markdown","4ddce7eb":"markdown","35550482":"markdown","4d47ffaa":"markdown","f5d6b760":"markdown","a5dd258f":"markdown","9e4ec5e0":"markdown","786a0917":"markdown","4c890a71":"markdown","69c74042":"markdown","f917afe3":"markdown","76d41794":"markdown","f9d33244":"markdown","d7591f26":"markdown","dc7deb58":"markdown","e06ee102":"markdown","636f03ee":"markdown","301175b0":"markdown","ae92fb4d":"markdown","ebc9ac9e":"markdown","1661879e":"markdown","5b074941":"markdown","67e7d490":"markdown","dcb926eb":"markdown","57070040":"markdown"},"source":{"ebd663ab":"import bq_helper\nfrom bq_helper import BigQueryHelper\n\nimport numpy as np \nimport pandas as pd \nimport os\nimport plotly.plotly as py\nfrom plotly.offline import init_notebook_mode, iplot\nimport plotly.graph_objs as go\nimport seaborn as sns\ninit_notebook_mode(connected=True)\ncolor = sns.color_palette()\n\nimport matplotlib.pyplot as plt\nimport matplotlib\nmatplotlib.rc('figure', figsize=(10, 8))","80db416a":"# https:\/\/www.kaggle.com\/sohier\/introduction-to-the-bq-helper-package\nchromeUXreport = bq_helper.BigQueryHelper(active_project=\"bigquery-public-data\",\n                                   dataset_name=\"chrome-ux-report.all\")\nchromeUXreportUS = bq_helper.BigQueryHelper(active_project=\"bigquery-public-data\",\n                                   dataset_name=\"chrome-ux-report.country_us\")\nchromeUXreportIN = bq_helper.BigQueryHelper(active_project=\"bigquery-public-data\",\n                                   dataset_name=\"chrome-ux-report.country_in\")","dbec7e9f":"query1 = \"\"\"SELECT\n    bin.start,\n    SUM(bin.density) AS density\nFROM\n    `chrome-ux-report.all.201806`,\n    UNNEST(first_contentful_paint.histogram.bin) AS bin\nWHERE\n    origin = 'https:\/\/www.kaggle.com'\nGROUP BY\n    bin.start\nORDER BY\n    bin.start;\n        \"\"\"\n\nprint(chromeUXreport.estimate_query_size(query1))\nresponse1 = chromeUXreport.query_to_pandas_safe(query1, max_gb_scanned= 5)\nresponse1.head(20)","a559cd57":"result1 = response1.head(10)\ntrace1 = go.Bar(\n                x = result1.start,\n                y = result1.density,\n                name = \"citations\",\n                marker = dict(color = 'rgba(0, 0, 255, 0.8)',\n                             line=dict(color='rgb(0,0,0)',width=1.5)),\n                text = result1.start)\ndata = [trace1]\nlayout = go.Layout(barmode = \"group\",title='First Contentful Paint Density Per Bin', xaxis = dict(title='Start (ms)'), yaxis = dict(title='Density'))\nfig = go.Figure(data = data, layout = layout)\niplot(fig)","ee4a10bd":"query2 = \"\"\"SELECT\n    SUM(bin.density) AS density\nFROM\n    `chrome-ux-report.all.201806`,\n    UNNEST(first_contentful_paint.histogram.bin) AS bin\nWHERE\n    bin.start < 5000 AND\n    origin = 'https:\/\/www.kaggle.com';\n        \"\"\"\nprint(chromeUXreport.estimate_query_size(query2))\nresponse2 = chromeUXreport.query_to_pandas_safe(query2,max_gb_scanned=5)\nresponse2.head(20)","2751271a":"query3 = \"\"\"\n#standardSQL\nSELECT\n    effective_connection_type.name AS ect,\n    SUM(bin.density) AS density\nFROM\n    `chrome-ux-report.all.201806`,\n    UNNEST(first_contentful_paint.histogram.bin) AS bin\nWHERE\n    bin.end <= 5000 AND\n    origin = 'https:\/\/www.kaggle.com'\nGROUP BY\n    ect\nORDER BY\n    density DESC;\n        \"\"\"\nprint(chromeUXreport.estimate_query_size(query3))\nresponse3 = chromeUXreport.query_to_pandas_safe(query3,max_gb_scanned=5)\nresponse3.head(20)","f8ce0d6b":"result3 = response3\nsns.factorplot(x='ect', y='density', data=result3, kind='bar', size=4, aspect=2.0)","578d9e7e":"query4 = \"\"\"\n#standardSQL\nWITH\n    countries AS (\n      SELECT *, 'All' AS country FROM `chrome-ux-report.all.201806`\n    UNION ALL\n      SELECT *, 'India' AS country FROM `chrome-ux-report.country_in.201806`\n    UNION ALL\n      SELECT *, 'US' AS country FROM `chrome-ux-report.country_us.201806`)\n      \nSELECT\n    country,\n    effective_connection_type.name AS ect,\n    SUM(bin.density) AS density\nFROM\n    countries,\n    UNNEST(first_contentful_paint.histogram.bin) AS bin\nWHERE\n    bin.end <= 5000 AND\n    origin = 'https:\/\/www.kaggle.com'\nGROUP BY\n    country,\n    ect\nORDER BY\n    density DESC;\n        \"\"\"\nprint(chromeUXreport.estimate_query_size(query4))\nresponse4 = chromeUXreport.query_to_pandas_safe(query4,max_gb_scanned=6)\nresponse4.head(20)","005afc51":"result4 = response4\nsns.factorplot(x='country', y='density', hue='ect', data=result4, kind='bar', size=4, aspect=2.0)","b47ce566":"query5 = \"\"\"\nSELECT\n  ROUND(SUM(IF(fid.start < 100, fid.density, 0)), 4) AS fast_fid\nFROM\n  `chrome-ux-report.all.201806`,\n  UNNEST(experimental.first_input_delay.histogram.bin) AS fid\nWHERE\n  origin = 'https:\/\/www.kaggle.com';\n        \"\"\"\nprint(chromeUXreport.estimate_query_size(query5))\nresponse5 = chromeUXreport.query_to_pandas_safe(query5,max_gb_scanned=3)\nresponse5.head(20)","d4cbd8d0":"query6 = \"\"\"\nSELECT\n  ROUND(SUM(IF(fid.start < 100, fid.density, 0)) \/ SUM(fid.density), 4) AS fast_fid\nFROM\n  `chrome-ux-report.all.201806`,\n  UNNEST(experimental.first_input_delay.histogram.bin) AS fid;\n        \"\"\"\nprint(chromeUXreport.estimate_query_size(query6))\nresponse6 = chromeUXreport.query_to_pandas_safe(query6,max_gb_scanned=3)\nresponse6.head(20)","77b9248d":"query7 = \"\"\"\nSELECT\n  form_factor.name AS form_factor,\n  ROUND(SUM(IF(fid.start < 100, fid.density, 0)) \/ SUM(fid.density), 4) AS fast_fid\nFROM\n  `chrome-ux-report.all.201806`,\n  UNNEST(experimental.first_input_delay.histogram.bin) AS fid\nWHERE\n  origin = 'https:\/\/www.kaggle.com'\nGROUP BY\n  form_factor;\n        \"\"\"\nprint(chromeUXreport.estimate_query_size(query7))\nresponse7 = chromeUXreport.query_to_pandas_safe(query7,max_gb_scanned=3)\nresponse7.head(20)","acb46237":"result7 = response7\nsns.factorplot(x='form_factor', y='fast_fid', data=result7, kind='bar', size=4, aspect=2.0)","19174295":"query8 = \"\"\"#standardSQL\nSELECT\n    origin,\n    ROUND(SUM(IF(fcp.start < 1000, fcp.density, 0)) \/ SUM(fcp.density) * 100) AS fast_fcp\nFROM\n    `chrome-ux-report.all.201806`,\n    UNNEST(first_contentful_paint.histogram.bin) AS fcp\nWHERE\n    origin IN ('https:\/\/www.analyticsvidhya.com', 'https:\/\/www.kdnuggets.com','https:\/\/medium.com')\nGROUP BY\n    origin;\n        \"\"\"\nprint(chromeUXreport.estimate_query_size(query8))\nresponse8 = chromeUXreport.query_to_pandas_safe(query8,max_gb_scanned=5)\nresponse8.head(20)","7aaf4f6a":"result8 = response8\nsns.factorplot(x='origin', y='fast_fcp', data=result8, kind='bar', size=4, aspect=2.0)","e3274e36":"query9 = \"\"\"#standardSQL\nSELECT\n  origin,\n  ROUND(SUM(IF(bin.start < 1000, bin.density, 0)) \/ SUM(bin.density), 4) AS fast_fcp,\n  ROUND(SUM(IF(bin.start >= 1000 AND bin.start < 3000, bin.density, 0)) \/ SUM(bin.density), 4) AS avg_fcp,\n  ROUND(SUM(IF(bin.start >= 3000, bin.density, 0)) \/ SUM(bin.density), 4) AS slow_fcp\nFROM\n    `chrome-ux-report.all.201806`,\n    UNNEST(first_contentful_paint.histogram.bin) AS bin\nWHERE\n    origin IN ('https:\/\/www.analyticsvidhya.com', 'https:\/\/www.kdnuggets.com','https:\/\/medium.com')\nGROUP BY\n    origin;\n        \"\"\"\nprint(chromeUXreport.estimate_query_size(query9))\nresponse9 = chromeUXreport.query_to_pandas_safe(query9,max_gb_scanned=5)\nresponse9.head(20)","4473cf59":"barWidth = 0.85\nr = response9.origin\ngreenBars = response9.fast_fcp\norangeBars = response9.avg_fcp\nblueBars = response9.slow_fcp\n# Create green Bars\nplt.bar(r, greenBars, color='#b5ffb9', edgecolor='white', width=barWidth)\n# Create orange Bars\nplt.bar(r, orangeBars, bottom=greenBars, color='#f9bc86', edgecolor='white', width=barWidth)\n# Create blue Bars\nplt.bar(r, blueBars, bottom=[i+j for i,j in zip(greenBars, orangeBars)], color='#a3acff', edgecolor='white', width=barWidth)","cb6b365d":"query10 = \"\"\"#standardSQL\nSELECT\n    origin,\n    ROUND(SUM(IF(form_factor.name = 'desktop', fcp.density, 0)) \/ SUM(fcp.density) * 100) AS pct_desktop,\n    ROUND(SUM(IF(form_factor.name = 'phone', fcp.density, 0)) \/ SUM(fcp.density) * 100) AS pct_phone,\n    ROUND(SUM(IF(form_factor.name = 'tablet', fcp.density, 0)) \/ SUM(fcp.density) * 100) AS pct_tablet\n    \nFROM\n    `chrome-ux-report.all.201806`,\n    UNNEST(first_contentful_paint.histogram.bin) AS fcp\nWHERE\n    origin IN ('https:\/\/www.analyticsvidhya.com', 'https:\/\/www.kdnuggets.com','https:\/\/medium.com')\nGROUP BY\n    origin;\n        \"\"\"\nprint(chromeUXreport.estimate_query_size(query10))\nresponse10 = chromeUXreport.query_to_pandas_safe(query10,max_gb_scanned=3)\nresponse10.head(20)","f57c54c8":"barWidth = 0.85\nr = response10.origin\ngreenBars = response10.pct_desktop\norangeBars = response10.pct_phone\nblueBars = response10.pct_tablet\n\n# Create green Bars\nplt.bar(r, greenBars, color='#b5ffb9', edgecolor='white', width=barWidth)\n# Create orange Bars\nplt.bar(r, orangeBars, bottom=greenBars, color='#f9bc86', edgecolor='white', width=barWidth)\n# Create blue Bars\nplt.bar(r, blueBars, bottom=[i+j for i,j in zip(greenBars, orangeBars)], color='#a3acff', edgecolor='white', width=barWidth)","0b4e92f6":"query11 = \"\"\"#standardSQL\nSELECT\n  origin,\n  effective_connection_type.name AS ect,\n  ROUND(SUM(bin.density), 4) AS density\n    \nFROM\n    `chrome-ux-report.all.201806`,\n    UNNEST(first_contentful_paint.histogram.bin) AS bin\nWHERE\n    origin IN ('https:\/\/www.analyticsvidhya.com', 'https:\/\/www.kdnuggets.com','https:\/\/medium.com')\nGROUP BY\n    origin,\n    ect\nORDER BY\n    origin,\n    ect;\n        \"\"\"\nprint(chromeUXreport.estimate_query_size(query11))\nresponse11 = chromeUXreport.query_to_pandas_safe(query11,max_gb_scanned=3)\nresponse11.head(20)","89e3d7a7":"result11 = response11\nsns.factorplot(x='origin', y='density', hue='ect', data=result11, kind='bar', size=4, aspect=2.0)","2d167b36":"query12 = \"\"\"\nSELECT\n  origin,\n  ROUND(SUM(IF(fid.start < 100, fid.density, 0)), 4) AS fast_fid\nFROM\n  `chrome-ux-report.all.201806`,\n  UNNEST(experimental.first_input_delay.histogram.bin) AS fid\nWHERE\n  origin IN ('https:\/\/www.analyticsvidhya.com', 'https:\/\/www.kdnuggets.com','https:\/\/medium.com')\nGROUP BY\n  origin;\n        \"\"\"\nprint(chromeUXreport.estimate_query_size(query12))\nresponse12 = chromeUXreport.query_to_pandas_safe(query12,max_gb_scanned=3)\nresponse12.head(20)","481a3d71":"result12 = response12\nsns.factorplot(x='origin', y='fast_fid', data=result12, kind='bar', size=4, aspect=2.0)","5c5cf3f4":"## <a id='41'>4.1 First Contentful Paint Density Sum Less Than 1 sec<\/a>","b02058cc":"## <a id='35'>3.5 First Input Delay Less Than 100 ms on Kaggle<\/a>","3b8ed445":"## <a id='21'>2.1 Load libraries<\/a>","7b9eacbc":"*  The results of this query show that *84% of FID* experiences are less than *100 ms*. So *kaggle.com* is above average.","3a56b961":"## <a id='37'>3.7 First Input Delay Less Than 100 ms on Kaggle By Form Factor Name<\/a>","f68c16b1":"*  From *80%* of page loads experience the FCP in under 5 second comes from 4G network. \n*  *61% *page loads experience from* 4G network*\n*  *19%* page loads experience from* 3G network*","11e429b3":"*  FCP in less than 1 sec of *kdnuggets.com* is better that other two.\n*  FCP of *kdnuggets.com* is 23%.\n*  FCP of* medium.com* is 14%.\n*  FCP of *analyticsvidhya.com *is 12%.","7d104b56":"*  Kaggle.com *94% of FID* on desktop than *71% on phone.* \n*  Which means *kaggle.com* on phone pretty less. But phone kaggle users are less in population, so it will not affect much.","7f2dd039":"## <a id='45'>4.5 First Input Delay Less Than 100 ms<\/a>","400d83e9":"*  Almost all three gives same result.","4ddce7eb":"*  The results show that *94% of FID* experiences on medium.com origin are perceived as instantaneous. That seems really very good.\n*  *90% of FID* experiences on analyticsvidhya.com. That is also good score.\n*  *72% of FID* experiences on kdnuggets.com. That is not a good score.","35550482":"## <a id='33'>3.3 First Contentful Paint Density Sum Less Than 5 sec By Different Connection Speeds<\/a>","4d47ffaa":"| The Experience        | The Metric           |\n| ------------- |:-------------:|\n|Is it happening?      | First Paint (FP) \/ First Contentful Paint (FCP) |\n| Is it useful?      | First Meaningful Paint (FMP) \/ Hero Element Timing      |\n| Is it usable? | Time to Interactive (TTI)      |\n| Is it delightful? | Long Tasks (technically the absence of long tasks)     |","f5d6b760":"# <a id='2'>2. Setup for Retrieving the Data<\/a>","a5dd258f":"*  In US *80%* page loads experience from *4G network* and *6%* from *3G network*.\n*  In INDIA *48%* page loads experience from *4G network* and *30%* from *3G network*","9e4ec5e0":"# More To Come. Stay Tuned. !!","786a0917":"![](https:\/\/image.ibb.co\/eyRTJd\/dataset_cover.jpg)","4c890a71":"## <a id='34'>3.4 First Contentful Paint Density Sum By Country<\/a>","69c74042":"*  As we know from above intro section, First Input Delay (FID) measures the time from when a user first interacts with your site (i.e. when they click a link, tap on a button, or use a custom, JavaScript-powered control) to the time when the browser is actually able to respond to that interaction.\n\n*  The results show that *90% of FID* experiences on *kaggle.com* origin are perceived as *instantaneous*. That seems really good, but how does it compare to all origins in the dataset?","f917afe3":"## <a id='31'>3.1 First Contentful Paint Distribution<\/a>","76d41794":"# <a id='4'>4. Compare Top 3 Data Science Blog Sites <\/a>","f9d33244":"## <a id='intro'>1. Intoduction<\/a>\n---------------------------------------\nThe Chrome User Experience Report provides user experience metrics for how real-world Chrome users experience popular destinations on the web.\n\nThe Chrome User Experience Report is powered by real user measurement of key user experience metrics across the public web, aggregated from users who have opted-in to syncing their browsing history, have not set up a Sync passphrase, and have usage statistic reporting enabled. The resulting data is made available via:\n\n   1. **PageSpeed** Insights, which provides URL-level user experience metrics for popular URLs that are known by Google's web crawlers.\n   2. **Public Google BigQuery** project, which aggregates user experience metrics by origin, for all origins that are known by Google's web crawlers, and split across multiple dimensions outlined below.\n   \n### <a> Metrics<\/a>\n---------------------------------------\n\nMetrics provided by the public Chrome User Experience Report hosted on Google BigQuery are powered by standard web platform APIs exposed by modern browsers and aggregated to origin-resolution. \n\n1. **First Paint:** First Paint reports the time when the browser first rendered after navigation. This excludes the default background paint, but includes non-default background paint. This is the first key moment developers care about in page load \u2013 when the browser has started to render the page.\n\n2. **First Contentful Paint:** First Contentful Paint reports the time when the browser first rendered any text, image (including background images), non-white canvas or SVG. This includes text with pending webfonts. This is the first time users could start consuming page content. \n\n3. **DOMContentLoaded:** The DOMContentLoaded reports the time when the initial HTML document has been completely loaded and parsed, without waiting for stylesheets, images, and subframes to finish loading.\n\n4. **onload:** The load event is fired when the page and its dependent resources have finished loading.\n\n5. **First Input Delay:** First Input Delay (FID) measures the time from when a user first interacts with your site (i.e. when they click a link, tap on a button, or use a custom, JavaScript-powered control) to the time when the browser is actually able to respond to that interaction.\n\n### <a> Dimensions<\/a>\n---------------------------------------\n\nPerformance of web content can vary significantly based on device type, properties of the network, and other variables.\n\n1. **Effective Connection Type:** Provides the effective connection type (\u201cslow-2g\u201d, \u201c2g\u201d, \u201c3g\u201d, \u201c4g\u201d, or \u201coffline\u201d) as determined by round-trip and bandwidth values based on real user measurement observations.\n\n2. **Device Type:** Coarse device classification (\u201cphone\u201d, \u201ctablet\u201d, or \u201cdesktop\u201d), as communicated via User-Agent.\n\n3. **Country:** Geographic location of users at the country-level, inferred by their IP address. Countries are identified by their respective ISO 3166-1 alpha-2 codes.\n","d7591f26":"## <a id='44'>4.4 First Contentful Paint Density Sum By Network<\/a>","dc7deb58":"*  As we know from above intro, First Contentful Paint reports the time when the browser first rendered any text, image (including background images), non-white canvas or SVG. This includes text with pending webfonts. This is the first time users could start consuming page content.\n* After *500ms (0.5s)* the kaggle webpage starts quick rendered. \n* Between *0.5s to 1.5s* the kaggle webpage rendered quite good amount. How much ? Will see in next section. :) ","e06ee102":"## <a id='22'>2.2 Setup BigQuery Data Connection <\/a>","636f03ee":"*  FCP of *kdnuggets.com* is very good in first 1 sec but than after medium.com is very good FCP page loads experience in b\/w 1 & 3 sec.\n*  FCP of *analyticsvidhya.com* and kdnuggets.com become same after 3 sec.\n*  Overall the starting of *kdnuggets.com* is good but after that medium.com give very good page loads experience.","301175b0":"*  4G network FCP scores dominating on 3G","ae92fb4d":"# <a id='3'>3. Kaggle Site Analysis<\/a>","ebc9ac9e":"## <a id='32'>3.2 First Contentful Paint Density Sum Less Than 5 sec<\/a>","1661879e":"## <a id='42'>4.2 First Contentful Paint Density Sum By Sec<\/a>","5b074941":"- <a href='#intro'>1. Introduction<\/a>\n\n- <a href='#2'>2. Setup for Retrieving the Data<\/a>\n\n\t- <a href='#21'>2.1 Load libraries<\/a>\n\t- <a href='#22'>2.2 Setup BigQuery Data Connection <\/a>\n\n- <a href='#3'>3. Kaggle Site Analysis<\/a>\n\n\t- <a href='#31'>3.1 First Contentful Paint Distribution<\/a>\n\t- <a href='#32'>3.2 First Contentful Paint Density Sum Less Than 5 sec<\/a>\n\t- <a href='#33'>3.3 First Contentful Paint Density Sum Less Than 5 sec By Different Connection Speeds<\/a>\n\t- <a href='#34'>3.4 First Contentful Paint Density Sum By Country<\/a>\n\t- <a href='#35'>3.5 First Input Delay Less Than 100 ms on Kaggle<\/a>\n\t- <a href='#36'>3.6 First Input Delay Less Than 100 ms on all Origins in The Dataset<\/a>\n\t- <a href='#37'>3.7 First Input Delay Less Than 100 ms on Kaggle By Form Factor Name<\/a>\n\n- <a href='#4'>4. Compare Top 3 Data Science Blog Sites <\/a>\n\t\n\t- <a href='#41'>4.1 First Contentful Paint Density Sum Less Than 1 sec<\/a>\n\t- <a href='#42'>4.2 First Contentful Paint Density Sum By Sec<\/a>\n\t- <a href='#43'>4.3 First Contentful Paint Density Sum By Form Factor Name<\/a>\n\t- <a href='#44'>4.4 First Contentful Paint Density Sum By Network<\/a>\n\t- <a href='#45'>4.5 First Input Delay Less Than 100 ms<\/a>","67e7d490":"* As we all know kaggle has news feed (i.e kernel, discussion contents), So it can take little time. But kaggle site has good or infact we say better optimization, So that it rendered *80%* of page loads experience the FCP in under *5 second*.","dcb926eb":"## <a id='43'>4.3 First Contentful Paint Density Sum By Form Factor Name<\/a>","57070040":"## <a id='36'>3.6 First Input Delay Less Than 100 ms on all Origins in The Dataset<\/a>"}}