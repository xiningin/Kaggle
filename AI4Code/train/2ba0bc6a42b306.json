{"cell_type":{"5fda988d":"code","c3de49e6":"code","4b7ccbcb":"code","650523a8":"code","0a004773":"code","2c52641c":"markdown"},"source":{"5fda988d":"from pathlib import Path\n\nfrom fastai.text.all import *","c3de49e6":"is_cpu = False if torch.cuda.is_available() else True\n\ndf_test = pd.read_csv(\"..\/input\/commonlitreadabilityprize\/test.csv\")\n\nlearn = load_learner(\"..\/input\/common-lit-fastai-awd-lstm\/final.pkl\", cpu=is_cpu)","4b7ccbcb":"test_dl = learn.dls.test_dl(df_test.excerpt)\npreds, _ = learn.get_preds(dl=test_dl)","650523a8":"df_sub = pd.read_csv(\"..\/input\/commonlitreadabilityprize\/sample_submission.csv\")\ndf_sub['target'] = preds.numpy()\ndf_sub.to_csv('submission.csv',index=False)","0a004773":"df_sub","2c52641c":"# About this notebook\n\n* AWD-LSTM model finetuned on the competition dataset.\n* Inference notebook for the Fastai training [notebook](https:\/\/www.kaggle.com\/snnclsr\/commonlit-fastai-training-with-language-model)\n\nSimply loads the trained model and make predictions on the test dataset."}}