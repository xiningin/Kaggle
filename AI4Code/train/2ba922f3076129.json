{"cell_type":{"8da6729f":"code","0484852e":"code","487da970":"code","fc258cb1":"code","24bd7a26":"code","c9a249d4":"code","d0c8d29d":"code","e0e18235":"code","b4ccc415":"code","92ddb3fd":"code","9c388554":"code","058edd20":"code","f410f851":"code","78cfac8c":"code","ada7af0e":"code","e8b31e83":"markdown","85e86157":"markdown","4824df21":"markdown","0c469f9f":"markdown","4fba22d5":"markdown","e7df6c54":"markdown","c0b56870":"markdown","ff47124c":"markdown","9afa4890":"markdown","0cc4747e":"markdown","12208e75":"markdown"},"source":{"8da6729f":"import numpy as np \nimport pandas as pd ","0484852e":"from keras.preprocessing.image import ImageDataGenerator\nfrom keras.preprocessing import image","487da970":"image_gen = ImageDataGenerator(\n                               width_shift_range=0.1, \n                               height_shift_range=0.1, \n                               rescale=1\/255, \n                               shear_range=0.2, \n                               zoom_range=0.2, \n                               fill_mode='nearest'\n                              )","fc258cb1":"image_shape = (350,350,1)\nbatch_size = 16\ntrain_image_gen = image_gen.flow_from_directory('..\/input\/recognizance\/train',color_mode='grayscale',\n                                               target_size=image_shape[:2],\n                                               batch_size=batch_size,\n                                               class_mode='binary',seed=42)","24bd7a26":"from keras.models import Sequential\nfrom keras.layers import Activation, Flatten, Dense, Conv2D, MaxPool2D","c9a249d4":"model = Sequential()\n\nmodel.add(Conv2D(filters=64, kernel_size=(3,3),input_shape=(350,350,1), activation='relu',))\nmodel.add(MaxPool2D(pool_size=(2, 2)))\n\nmodel.add(Conv2D(filters=128, kernel_size=(3,3),activation='relu',))\nmodel.add(MaxPool2D(pool_size=(2, 2)))\n\nmodel.add(Conv2D(filters=128, kernel_size=(3,3), activation='relu',))\nmodel.add(MaxPool2D(pool_size=(2, 2)))\n\nmodel.add(Flatten())\n\nmodel.add(Dense(512))\nmodel.add(Activation('relu'))\n\n\nmodel.add(Dense(1))\nmodel.add(Activation('sigmoid'))\n\nmodel.compile(loss='binary_crossentropy',\n              optimizer='adam',\n              metrics=['accuracy'])\n\n\nmodel.fit_generator(generator=train_image_gen,epochs=20)","d0c8d29d":"model.fit_generator(generator=train_image_gen,epochs=5)","e0e18235":"model.fit_generator(generator=train_image_gen,epochs=5)","b4ccc415":"import os\nfiles = []\n\nfor dirname, _, filenames in os.walk('\/kaggle\/input\/recognizance\/test\/'):\n    for filename in filenames:\n        files.append(filename)","92ddb3fd":"pred = []\nfor i in files:\n    img = image.load_img('..\/input\/recognizance\/test\/'+i, target_size=(350,350,1),color_mode = \"grayscale\")\n    img = image.img_to_array(img)\n    img = np.expand_dims(img, axis=0)\n    img = img\/255\n    pred.append(model.predict_classes(img)[0][0])","9c388554":"sub = pd.DataFrame(pred,files).reset_index()\nsub.columns = ['image','label']\nsub.to_csv('sub4.csv',index=False)","058edd20":"!gzip sub4.csv","f410f851":"model.save(\"model.h5\")","78cfac8c":"model.save_weights(\"modelweights.h5\")","ada7af0e":"from IPython.display import FileLink\nFileLink(r'modelweights.h5')","e8b31e83":"# Modeling","85e86157":"# Importing the Basic Libraries","4824df21":"Then the File names with their classes are made into a Dataframe for submission","0c469f9f":"Here all the Images have been resized to 350 x 350 in black and white mode and used <br>\n\nBatch size of 16 is used <br>\n\nThe images have been loaded from the Directory(recognizance\/train) in B\/W mode with ImageDataGenerator <br>\n\nThe ImageDataGenerator Now reads 16 images in B\/W mode each time","4fba22d5":"All the filenames inside the test folder are read and stored in a array","e7df6c54":"Then each corresponding image is loaded using Keras.image.load_img in B\/W mode and with dimension of 350 <br>\n\nThen the class of the Image(Positive\/negative) is predicted and the value is appended in a Array","c0b56870":"# Importing the ImageDataGenerator","ff47124c":"<b>Here the given list of augments has been made to improve the learning.<\/b>\n\n1)Width Shift (Shifting the Image Horizontally)\n\n2)Height Shift (Shifting the Image Vertically)\n\n3)Rescale (Converting the pixel values from 0 - 255 to 0 - 1)\n\n4)Shear (Shifting one part of a Image) <a href=\"https:\/\/docs.gimp.org\/2.10\/en\/gimp-tool-shear.html#:~:text=Shear%20tool%20is%20used%20to,A%20rectangle%20becomes%20a%20diamond.\">Please refer this link for shear Example<\/a>\n\n5)Zoom","9afa4890":"# Predicting the Test Data","0cc4747e":"The CNN model is implemented using the Keras Library. <br>\n\nLoss Function used - Binary Crossentropy <br>\nOptimizer - Adam <br>\nEpochs Used - 30","12208e75":"ImageDataGenerator is used to load the images from the respective Directory with the mentioned batch size and Image size, also several augments of the image can also be made with the ImageDataGenerator"}}