{"cell_type":{"ce4108e1":"code","2d22952e":"code","c59d641e":"code","99b0931c":"code","7be689e1":"code","8f286791":"code","078c0b42":"code","6f28a1b5":"code","09ecf951":"code","bb024032":"code","05b48187":"code","eae8944d":"code","010c896d":"markdown"},"source":{"ce4108e1":"# Pacotes de an\u00e1lise de dados:\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport pandas_profiling\nimport matplotlib.pyplot as plt\nimport matplotlib.gridspec as gridspec\nfrom pylab import rcParams\n\n# Pacotes para aprendizagem de maquina via sklearn:\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import confusion_matrix","2d22952e":"# Entrada de dados:\ndf = pd.read_csv(\"..\/input\/iris\/Iris.csv\")\ndf.drop('Id', axis=1, inplace=True)\ndf.head()","c59d641e":"## Analise explorat\u00f3ria de dados\n# Estat\u00edstica Descritiva:\nround(df.describe(),3)","99b0931c":"# Verifica\u00e7\u00e3o da vari\u00e1vel target:\nplt.figure(figsize=(12,5))\nsns.countplot('Species',data=df)\nplt.title(\"Verifica\u00e7\u00e3o da vari\u00e1vel target\")\nplt.show()","7be689e1":"# Histogramas com foco no target:\nplt.figure(figsize=(12,5))\ngs = gridspec.GridSpec(4,1)\nax = plt.subplot()\nsns.distplot(df['PetalWidthCm'][df.Species == 'Iris-setosa'], bins=10)\nsns.distplot(df['PetalWidthCm'][df.Species == 'Iris-versicolor'], bins=10)\nsns.distplot(df['PetalWidthCm'][df.Species == 'Iris-virginica'], bins=10)\nax.set_xlabel('')\nax.set_title('Histograma rela\u00e7\u00e3o de vari\u00e1veis com o Target: ' + str('PetalWidthCm'))\nplt.show()\n\nplt.figure(figsize=(12,5))\ngs = gridspec.GridSpec(4,1)\nax = plt.subplot()\nsns.distplot(df['PetalLengthCm'][df.Species == 'Iris-setosa'], bins=10)\nsns.distplot(df['PetalLengthCm'][df.Species == 'Iris-versicolor'], bins=10)\nsns.distplot(df['PetalLengthCm'][df.Species == 'Iris-virginica'], bins=10)\nax.set_xlabel('')\nax.set_title('Histograma rela\u00e7\u00e3o de vari\u00e1veis com o Target: ' + str('PetalLengthCm'))\nplt.show()\n\nplt.figure(figsize=(12,5))\ngs = gridspec.GridSpec(4,1)\nax = plt.subplot()\nsns.distplot(df['SepalWidthCm'][df.Species == 'Iris-setosa'], bins=10)\nsns.distplot(df['SepalWidthCm'][df.Species == 'Iris-versicolor'], bins=10)\nsns.distplot(df['SepalWidthCm'][df.Species == 'Iris-virginica'], bins=10)\nax.set_xlabel('')\nax.set_title('Histograma rela\u00e7\u00e3o de vari\u00e1veis com o Target: ' + str('SepalWidthCm'))\nplt.show()\n\nplt.figure(figsize=(12,5))\ngs = gridspec.GridSpec(4,1)\nax = plt.subplot()\nsns.distplot(df['SepalLengthCm'][df.Species == 'Iris-setosa'], bins=10)\nsns.distplot(df['SepalLengthCm'][df.Species == 'Iris-versicolor'], bins=10)\nsns.distplot(df['SepalLengthCm'][df.Species == 'Iris-virginica'], bins=10)\nax.set_xlabel('')\nax.set_title('Histograma rela\u00e7\u00e3o de vari\u00e1veis com o Target: ' + str('SepalLengthCm'))\nplt.show()","8f286791":"# Mapa de correla\u00e7\u00f5es\nsns.set(rc={'figure.figsize':(8,6)})\nsns.heatmap(df.corr(method='spearman'),fmt = '.2f',cmap='Greens')\nplt.title('Correla\u00e7\u00e3o entre vari\u00e1veis')\nplt.show()","078c0b42":"# Pacotes para AutoML:\nimport h2o\nfrom h2o.automl import H2OAutoML\n \n# Start cluster:\nh2o.init()","6f28a1b5":"# Divis\u00e3o do dataset:\ntrain, test = train_test_split(df, test_size=0.2)\n\n# Convers\u00e3o para h2o frame:\ntraindf = h2o.H2OFrame(train)\ntestdf = h2o.H2OFrame(test)\n\n# Cria\u00e7\u00e3o das vari\u00e1veis de entrada no AutoML:\ny = \"Species\"\nx = list(traindf.columns)\nx.remove(y)\n \n# Tratamento na vari\u00e1vel target:\ntraindf[y] = traindf[y].asfactor()\ntestdf[y] = testdf[y].asfactor()","09ecf951":"# AutoML H2O:\naml = H2OAutoML(max_models = 100, max_runtime_secs = 600, seed = 7450)\naml.train(x = x, y = y, training_frame = traindf)\n\n# Leader board:\nprint(aml.leaderboard)","bb024032":"# Previs\u00f5es e tratamentos:\npredict = aml.predict(testdf)\np = predict.as_data_frame()\nprint(\" \")\n\n# Convers\u00e3o para dataframe pandas:\ndata = {'actual': test.Species,'Ypredict': p['predict'].tolist()}\ndf = pd.DataFrame(data, columns = ['actual','Ypredict'])\nprint(df.head(3))","05b48187":"# Matriz confus\u00e3o:\nconfusion_matrix = pd.crosstab(df['actual'], df['Ypredict'], rownames=['Actual'], colnames=['Predicted'])\n\nsns.set(rc={'figure.figsize':(8,6)})\nsns.set(font_scale=1.4)\nsns.heatmap(confusion_matrix,annot=True,annot_kws={\"size\": 16},cmap='Greens')\nplt.title(\"Matriz de confus\u00e3o\")\nplt.show()","eae8944d":"# Shutdown h2o cluster:\nh2o.cluster().shutdown(prompt = False)","010c896d":"## AutoML com H2O com o dataset iris\n\nUm notebook feito para demostrar um fluxo de aprendizagem de m\u00e1quina com AutoML do H2O e uma pequena an\u00e1lise explorat\u00f3ria de dados."}}