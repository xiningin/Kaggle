{"cell_type":{"ed69cd7c":"code","64029cef":"code","9a268c72":"code","2c2f9dc0":"code","30361a96":"code","e59dcbe5":"code","87a09786":"code","71f23bfe":"code","ccf74e6a":"code","d7d5f3ea":"code","d8cef38a":"code","d92b0a8f":"code","7ebce962":"code","176961c0":"code","cb7afb4c":"code","58b0f2f6":"code","c533aaa7":"code","4016a06f":"code","d3a85821":"code","f25e5374":"code","e1065451":"code","98b49956":"code","e75b2951":"code","3738c110":"code","a1d148f0":"code","0fdce1c1":"code","7499d803":"code","1e504896":"code","28952d96":"code","e2488d90":"code","da75387f":"code","7c02c450":"code","4500ca64":"code","bab50933":"code","dfdda6a9":"code","b3a8f50c":"code","e6c5d178":"code","c3b3990f":"code","412a1eb9":"code","7f3f43e9":"code","271953b4":"code","80c7647e":"code","bf8afad2":"code","2a9eb5db":"code","c016e259":"code","2ca69292":"code","0c20949d":"markdown","cf18189d":"markdown","c1e4ff6d":"markdown","6e1a2dc2":"markdown","a3583efb":"markdown","ffe4b8db":"markdown","b733d8a6":"markdown","6a982fad":"markdown","39f8287d":"markdown","4aeb1616":"markdown","b8f32f6f":"markdown","59fd99e2":"markdown","86fea0b3":"markdown","595998ea":"markdown","9c9f0230":"markdown","7de28b4a":"markdown","96f6f092":"markdown","afb09af9":"markdown","c65bd790":"markdown","6fc35c37":"markdown","6a003fb7":"markdown","6435b4d1":"markdown","ea875d0b":"markdown","03748316":"markdown","0adb1711":"markdown","7ff10bf4":"markdown","48e37b19":"markdown","a7530c93":"markdown","c780b73b":"markdown","bc942adf":"markdown","78f78562":"markdown","b99fc722":"markdown","5408eeb8":"markdown","e57d931e":"markdown","fcdd6414":"markdown","17ef883e":"markdown","dd6587d9":"markdown"},"source":{"ed69cd7c":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","64029cef":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nsns.set_style('ticks')\nplt.rcParams[\"figure.figsize\"] = (10,8)\n\nimport warnings\nwarnings.filterwarnings(\"ignore\")\n\n%matplotlib inline","9a268c72":"df = pd.read_csv(\"\/kaggle\/input\/telco-customer-churn\/WA_Fn-UseC_-Telco-Customer-Churn.csv\")","2c2f9dc0":"df.head()","30361a96":"df.shape","e59dcbe5":"df.columns","87a09786":"df.describe()","71f23bfe":"plt.figure(figsize=(18,6))\ndf[\"Churn\"].value_counts().plot(kind=\"barh\")\nplt.xlabel(\"Count\")\nplt.ylabel(\"Class\")\nplt.title(\"Count of Target Variable\")\n\ndf[\"Churn\"].value_counts()","ccf74e6a":"# Feature dtypes\ndef df_summary(df):\n    '''\n    input the dataframe, and it will return a summary table with columns datails.\n    '''\n    #create a dataframe call summary\n    summary = pd.DataFrame(df.dtypes, columns=['dtype'])\n\n    # Number of Missing values (-1 count)\n    summary['num_missing'] = df.isna().sum().values    \n\n    # Number of unique values by features\n    summary['num_uniques'] = df.nunique().values\n    \n    return summary\n","d7d5f3ea":"summary = df_summary(df)\nsummary","d8cef38a":"print(\"Unique values of each columns: \")\nfor col in df.columns:\n  print(f\"{col}: \\n{df[col].unique()}\\n\")","d92b0a8f":"df_data = df.copy()","7ebce962":"df_data['TotalCharges'] = pd.to_numeric(df_data['TotalCharges'], errors='coerce')\nsummary.loc[\"TotalCharges\",\"dtype\"] = \"float64\"","176961c0":"df_data.isna().sum() ","cb7afb4c":"df_data[df_data[\"TotalCharges\"].isna() == True]","58b0f2f6":"df_data.dropna(inplace=True)","c533aaa7":"df_data.isna().sum() ","4016a06f":"df_data[\"tenure\"].max()","d3a85821":"labels = [f\"{i} - {i+11}\" for i in range(1,72,12)]\ndf_data['tenure_group'] = pd.cut(df_data.tenure, range(1, 80, 12), right=False, labels=labels)","f25e5374":"df_data['tenure_group'].value_counts()","e1065451":"df_data.drop(columns=[\"tenure\",\"customerID\"],inplace=True)","98b49956":"df_data.head()","e75b2951":"summary","3738c110":"# Put the columns into groups \ncustomer_count = ['gender', 'SeniorCitizen', 'Partner', 'Dependents']\ncontract_count = [ 'Contract', 'PaperlessBilling', 'PaymentMethod'] #  'MonthlyCharges', 'TotalCharges' is not catagories col.\nphoneser_count = ['PhoneService', 'MultipleLines']\ninternetser_count = [ 'InternetService', 'OnlineSecurity', 'OnlineBackup', 'DeviceProtection', 'TechSupport', 'StreamingTV', 'StreamingMovies']","a1d148f0":"def uni_plot(categorical_list):\n  df_categoric = df.loc[:, categorical_list]\n  for i in categorical_list:\n    plt.figure()\n    plt.figure(figsize=(10,8))\n    sns.countplot(x = i, data = df_categoric)\n    plt.title(f\"Distribution of {i}\")\n    # plt.xticks(rotation = 45)","0fdce1c1":"uni_plot(customer_count)","7499d803":"uni_plot(contract_count)","1e504896":"uni_plot(phoneser_count)","28952d96":"uni_plot(internetser_count)","e2488d90":"plt.figure(figsize=(10,8))\nsns.countplot(df_data['tenure_group'])\nplt.title(f\"Distribution of tenure_group\")","da75387f":"plt.figure(figsize=(10,8))\nsns.countplot(df_data['tenure_group'], hue=df_data[\"Churn\"])\nplt.title(f\"Distribution of tenure_group\")","7c02c450":"# Put the columns into groups \ncustomer_col = ['gender', 'SeniorCitizen', 'Partner', 'Dependents', \"Churn\"]\ncontract_col = [ 'Contract', 'PaperlessBilling', 'PaymentMethod', \"Churn\"] #  'MonthlyCharges', 'TotalCharges' is not catagories col.\nphoneser_col = ['PhoneService', 'MultipleLines', \"Churn\"]\ninternetser_col = [ 'InternetService', 'OnlineSecurity', 'OnlineBackup', 'DeviceProtection', 'TechSupport', 'StreamingTV', 'StreamingMovies', \"Churn\"]","4500ca64":"def category_plot(categorical_list):\n  df_categoric = df.loc[:, categorical_list]\n  for i in categorical_list:\n    plt.figure()\n    plt.figure(figsize=(10,8))\n    sns.countplot(x = i, data = df_categoric, hue = \"Churn\")\n    plt.title(f'{i} in term of CHURN')\n    # plt.xticks(rotation = 45)","bab50933":"category_plot(customer_col)","dfdda6a9":"category_plot(contract_col)","b3a8f50c":"category_plot(phoneser_col)","e6c5d178":"category_plot(internetser_col)","c3b3990f":"df_data['gender'] = df_data['gender'].map({\"Male\":1,\"Female\":0}).astype(\"int\")\ndf_data[\"Partner\"] = df_data[\"Partner\"].map({\"No\":0,\"Yes\":1}).astype(\"int\")\ndf_data[\"Dependents\"] = df_data[\"Dependents\"].map({\"No\":0,\"Yes\":1}).astype(\"int\")\ndf_data[\"PhoneService\"] = df_data[\"PhoneService\"].map({\"No\":0,\"Yes\":1}).astype(\"int\")\ndf_data[\"PaperlessBilling\"] = df_data[\"PaperlessBilling\"].map({\"No\":0,\"Yes\":1}).astype(\"int\")\n","412a1eb9":"df_data[\"Churn\"] = df_data[\"Churn\"].map({\"Yes\":1, \"No\":0}).astype(\"int\")\n\n# another way to convert\n# df_data[\"Churn\"] = np.where(df_data[\"Churn\"] == \"Yes\", 1, 0)","7f3f43e9":"df_data","271953b4":"data_dummies = pd.get_dummies(df_data)","80c7647e":"data_dummies","bf8afad2":"plt.figure(figsize=(10,8))\nMth = sns.kdeplot(data_dummies.MonthlyCharges[(data_dummies[\"Churn\"] == 0) ],\n                color=\"Red\", shade = True)\nMth = sns.kdeplot(data_dummies.MonthlyCharges[(data_dummies[\"Churn\"] == 1) ],\n                ax =Mth, color=\"Blue\", shade= True)\nMth.legend([\"No Churn\",\"Churn\"],loc='upper right')\nMth.set_ylabel('Density')\nMth.set_xlabel('Monthly Charges')\nMth.set_title('Monthly charges by churn')","2a9eb5db":"plt.figure(figsize=(10,8))\nTot = sns.kdeplot(data_dummies.TotalCharges[(data_dummies[\"Churn\"] == 0) ],\n                color=\"Red\", shade = True)\nTot = sns.kdeplot(data_dummies.TotalCharges[(data_dummies[\"Churn\"] == 1) ],\n                ax =Tot, color=\"Blue\", shade= True)\nTot.legend([\"No Churn\",\"Churn\"],loc='upper right')\nTot.set_ylabel('Density')\nTot.set_xlabel('Total Charges')\nTot.set_title('Total charges by churn')","c016e259":"plt.figure(figsize=(20,6))\ndata_dummies.corr()['Churn'].sort_values(ascending = False).plot(kind='bar')","2ca69292":"data_dummies.to_csv(\"telecom-churn_dummies_2.csv\",index = False)","0c20949d":"# Data Cleaning and Analysis","cf18189d":"### Data Converting","c1e4ff6d":"Lets take a look on the target class","6e1a2dc2":"**Create a copy dataset to keep the original remain unchange**\n","a3583efb":"# Prepare","ffe4b8db":"# Ask \n#### Business Task\nBy predicting the Churn possibility of a customer, to develop a focused customer retention programs.\n\n<br>\n\n#### Key stakeholders\nWho will be interested in this case study, who will be benefitted from this case study\n- Management\n- Marketing Team\n- Operation Team \n\n<br>\n\n#### Any Questions help to understand\/ get to the main tasks\n- What is the important features towards Churn rates?\n  - Who are the most likey to churn?\n  - What can be improve in order to keep the customer?","b733d8a6":"**Observation:**\n- Higher churn in lower total charges, which is surprising.","6a982fad":"Since we have transform the Total Charges into numeric, lets check is any N\/A data again.","39f8287d":"**Observation:**\n- If the customer is a Senior Citizen, seems to have a higher churn ratio,\n- If the customer does not have partner, seems like having higher probrobility leave to leave the company, the same case shows on dependents. Maybe for this part of customer, stable is not their first thing to consider.  \n","4aeb1616":"### Introduction\n#### - What is the Churn\n\nGenerally, in industry with subsricption\/yearly-renewal contract as the bases, the **Churn rate** refers to the proportion of customers who leave the company during a given time period.\n\n<br>\n\n#### - Why it is important to analysis the churn rate\n\nBy observating the churn rate and studying the factors of group who stays and group who leaves, it help the companies modify their products, services or marketing stretgy in a more competitive way to the market.\n\n<br>\n\n#### - Purpose of this case study\n\nFrom the above, I am going to define the main purposes of this case study are:\n1. Understanding the important features of customers who leaves\n2. Build a model to predict the possibility of churn of a customer given his\/her data\n\n<br>\n\n\n### Background Information\n\n#### - Sources of data\n\nThe dataset that will applied for this case study is from Kaggle \n\n<br>\n\n#### - Describe the data\n\nEach row represents a customer, each column contains customer\u2019s attributes described on the column Metadata.\n\nThe data set includes information about:\n\n- Customers who left within the last month - the column is called Churn\n- Services that each customer has signed up for \u2013 phone, multiple lines, internet, online security, online backup, device protection, tech support, and streaming TV and movies\n- Customer account information \u2013 how long they\u2019ve been a customer, contract, payment method, paperless billing, monthly charges, and total charges\n- Demographic info about customers \u2013 gender, age range, and if they have partners and dependents\n\n<br>\n\n#### - Work Flow\n\nThis project will devided into the following parts:\n1. Churn\n2. Data anaylsis (with EDA)\n3. Prediction models building\n4. Deploy final model\n\nFor the first part, we will have a EDA on the dataset to find out insights that this dataset brought us; the second part will be the machine learning models construction, try to build a model that can predict the probability of the churn action from inputing some customers information.","b8f32f6f":"### Bivariate Analysis\n","59fd99e2":"#### Feature variable","86fea0b3":"Observation:\n- Features help to lower the churn rate:\n  - Longer in Contract term and tenure,\n  - No internet service in \"Device Protection\", \"Streaming Movies\", \"Streaming TV\", \"Tech Support\", \"Online Backup\", \"Online Security\"\n\n- Features that have a positive relation with churn rete:\n  - Monthly Contract term, short tenure remains,\n  - Have internet but doesn't use the \"Online Security\", \"Tech Support\", \"Online Backup\", \"Device Protection\"","595998ea":"#### Catagorical columns","9c9f0230":"## Data Exploration","7de28b4a":"# Telecom Chuan Case Study","96f6f092":"#### Target variable","afb09af9":"**Then is the Tenure columns**","c65bd790":"Seems like nothing are very special here, lets drop them,","6fc35c37":"For this case study, customer ID will not be applied, it will be droped with \"tenure\" together.","6a003fb7":"**Observation:**\n- More churn in higher monthly charges, this maybe related to the fiber optic case since normally fiber optic is more expensive then others internet services.","6435b4d1":"**Observation:**\n- Customers who uses fiber optic internet service are much likely to churn among three kind of internet connection service, maybe something wrong with the company's fiber optic service? \n\n","ea875d0b":"**Observation**\n- Most of our customers have used our phone services, among these customers, around \u00bd have multiple lines.","03748316":"Since the target class only have Yes or No, so it is a binery classification problem. **And We have an imbalance target variale distribution in class, we have to take this imbalance situation into account in the after analysis and solve it before building our models.**","0adb1711":"Lets have a deep look on the N\/A data.","7ff10bf4":"### Data Correlation ","48e37b19":"**Load data file**\n","a7530c93":"**Observations:**\n- Seems like no N\/A values in the dataset, while we still have to check the string, since the collector may input N\/A data with string labels.\n- TotalCharges should be in number format, we have to charge its dtype,\n- Tenure is count in month, maybe we can transform it into year, and get a cross-check with Contract columns\n- In MultipleService column, \"No phone service\" shares similar meaning with \"No\", should combine into \"No\", the same logic applied to \"OnlineSecurity\", 'OnlineBackup', 'DeviceProtection', 'TechSupport', 'StreamingTV', 'StreamingMovies'","c780b73b":"**Observations:**\n- SeniorCitizen is a catagory columns since it only have 1 and 0;\n- 75% of customers have tenure less the 55 months and the means of tenure is 32.4 months;\n- The average monthly charges is \\$64.76, 25% of customers are paying more than \\$89.85 per month","bc942adf":"**Observation:**\n- Most of the customers are using the phone service provided by the company>\n","78f78562":"**Observations:**\n\nThe dataset have 7043 observation records.","b99fc722":"### Observation Sum-up\n- If customers are does not have partner, imdependent, they are more likely to churn.\n- If customers with short tenure remains, and having monthly contract with the company, they are more likely to churn.\n- If the customers are uses fiber optic internet services, they are more likely to churn among all.\n","5408eeb8":"**Observation**\n- Around half of our customers signed **month-to-month contract** with us.\n- More customers are going to pay with electronic check.\n","e57d931e":"**Import libraries**\n","fcdd6414":"**Observation:**\n- Equal distribution in Gender, Partner,\n- Most of our customers are not Senior Citizen, only 1\/7 are Senior Citizen\n- \u2154 of our customers are enconomic independents and \u2153 of our customers are enconomic dependent\n","17ef883e":"### Univariate Analysis","dd6587d9":"**Observation:**\n- As expected, customers with short-term contract are more likely to churn, vice versa.\n- Customers who pay with electronic check also are more likely to leave, while when it comes to a compare with other payment types, electronic check is more common, we have to go deeper to check is there a relationship between them.\n"}}