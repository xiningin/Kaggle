{"cell_type":{"2897d3b4":"code","d8331c3e":"code","32caf50d":"code","2160ae89":"code","ed148b68":"code","cf6b14f7":"code","fb35673e":"code","ebb03628":"code","57ea0e60":"code","99bab4e0":"code","877fdba1":"code","68791dd1":"code","8e1491ab":"code","a22f55d7":"code","7843e160":"code","798f1198":"code","43f951af":"markdown","49114c84":"markdown","ce67b6a5":"markdown","c99e3b72":"markdown"},"source":{"2897d3b4":"#import library\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport nltk\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.feature_extraction.text import CountVectorizer\nfrom sklearn.feature_extraction.text import TfidfVectorizer\nfrom sklearn.naive_bayes import MultinomialNB\nfrom sklearn.metrics import accuracy_score","d8331c3e":"df = pd.read_csv('..\/input\/apple-iphone-se-reviews-ratings\/APPLE_iPhone_SE.csv')","32caf50d":"df.shape","2160ae89":"df.head()","ed148b68":"#set text to lower case\nreview = df['Reviews'].apply(lambda x: x.lower())\nratings = df['Ratings']","cf6b14f7":"#stemming text\nstemmer = nltk.stem.SnowballStemmer('english')\nreview = review.apply(lambda x: \" \".join(stemmer.stem(x) for x in x.split()))\nprint(review)","fb35673e":"X_train, X_test, y_train, y_test = train_test_split(review, ratings, test_size = 0.3, random_state = 1)\nprint(X_train.shape)\nprint(X_test.shape)\nprint(y_train.shape)\nprint(y_test.shape)","ebb03628":"#countvectorizer method\ncv = CountVectorizer()\nvector_x_train = cv.fit_transform(X_train) \nvector_x_test = cv.transform(X_test)","57ea0e60":"nb = MultinomialNB()\nnb.fit(vector_x_train, y_train)\n%time nb.fit(vector_x_train, y_train)","99bab4e0":"y_pred = nb.predict(vector_x_test)\nprint(y_pred)","877fdba1":"df_2 = pd.DataFrame({'Actual' : y_test, 'Prediction' : y_pred})\ndf_2.head()","68791dd1":"#accuracy score\naccuracy = accuracy_score(y_test, y_pred)\nprint('Accuracy Score : ', accuracy)\nprint('Percentage : ', int(accuracy * 100), '%')","8e1491ab":"#tfidfvectorizer method\ntfid = TfidfVectorizer()\nvector_x_train_2 = tfid.fit_transform(X_train) \nvector_x_test_2 = tfid.transform(X_test)","a22f55d7":"nb = MultinomialNB()\nnb.fit(vector_x_train_2, y_train)\n%time nb.fit(vector_x_train_2, y_train)","7843e160":"y_pred_2 = nb.predict(vector_x_test_2)\nprint(y_pred_2)","798f1198":"accuracy = accuracy_score(y_test, y_pred_2)\nprint('Accuracy Score : ', accuracy)\nprint('Percentage : ', int(accuracy * 100), '%')","43f951af":"# Apple Iphone Reviews Classification","49114c84":"## Naive Bayes Model","ce67b6a5":"## Data Extraction","c99e3b72":"## Text Processing"}}