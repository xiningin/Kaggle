{"cell_type":{"b539d9d4":"code","c8e4dd7a":"code","b1801c4f":"code","e2454f94":"code","99180d2c":"code","0d4fd7f6":"code","e4ae0a48":"code","b7b18ab3":"code","b25bb794":"code","d74282b2":"code","176b8356":"code","27b36f6d":"code","9d9d84c7":"code","32e27929":"code","bd5c76ec":"code","24cd4619":"code","021388fd":"code","5333e3f8":"code","46cbc08b":"code","f691fc4c":"code","166fcfb5":"code","c4631ba4":"code","9dd5f5a0":"code","10a1f187":"code","c8f1dea6":"code","03e774c8":"code","85d264ea":"code","43a8645a":"code","4d7181e5":"code","b4a5bdc5":"markdown","aaca775b":"markdown","4605123c":"markdown","3b244215":"markdown","d64de01f":"markdown","df37d236":"markdown","01410eea":"markdown","eea57272":"markdown"},"source":{"b539d9d4":"import tensorflow as tf\nimport matplotlib.pyplot as plt \nimport numpy as np \n\nfrom tensorflow.keras import datasets, layers, models\nfrom PIL import Image","c8e4dd7a":"(train_images, train_labels), (test_images, test_labels) = datasets.cifar10.load_data()","b1801c4f":"train_images, test_images = train_images \/ 255.0, test_images \/ 255.0","e2454f94":"class_names = ['airplane', 'car', 'bird', 'cat', 'deer',\n               'dog', 'frog', 'horse', 'ship', 'truck']","99180d2c":"plt.imshow(train_images[46])","0d4fd7f6":"class_names[train_labels[46][0]]","e4ae0a48":"plt.figure(figsize=(10,10))\nfor i in range(25):\n    plt.subplot(5,5,i+1)\n    plt.xticks([])\n    plt.yticks([])\n    plt.grid(False)\n    plt.imshow(train_images[i], cmap=plt.cm.binary)\n    plt.xlabel(class_names[train_labels[i][0]])\nplt.show()","b7b18ab3":"plt.imshow(train_images[10])","b25bb794":"train_images.shape","d74282b2":"test_images.shape","176b8356":"train_images[0][0][0] # Size 32 by 32, the 3 represents RGB colour","27b36f6d":"model = models.Sequential([\n    layers.Conv2D(32, (3, 3), activation='relu', input_shape=(32, 32, 3)),\n    layers.MaxPooling2D((2, 2)),\n    layers.Conv2D(64, (3, 3), activation='relu'),\n    layers.MaxPooling2D((2, 2)),\n    layers.Conv2D(64, (3, 3), activation='relu'),\n    layers.Flatten(),\n    layers.Dense(64, activation='relu'),\n    layers.Dense(10)\n])","9d9d84c7":"model.summary()","32e27929":"model.compile(optimizer='adam',\n              loss=tf.keras.losses.SparseCategoricalCrossentropy(from_logits=True),\n              metrics=['accuracy'])","bd5c76ec":"trained_model = model.fit(train_images, train_labels, epochs=10, \n                validation_data=(test_images, test_labels))","24cd4619":"model.save('cifar_cnn2.h5')","021388fd":"plt.plot(trained_model.history['accuracy'], label='accuracy')\nplt.plot(trained_model.history ['val_accuracy'], label = 'validation accuracy')\nplt.xlabel('Epoch')\nplt.ylabel('Accuracy')\nplt.ylim([0.5, 1])\nplt.legend(loc='lower right')","5333e3f8":"test_loss, test_acc = model.evaluate(test_images,  test_labels, verbose=2)","46cbc08b":"plt.figure()\nplt.imshow(test_images[2])\nplt.colorbar()\nplt.grid(False)\nplt.show()","f691fc4c":"class_names[np.argmax(model.predict(test_images[2:3]))]","166fcfb5":"plt.figure()\nplt.imshow(test_images[64])\nplt.colorbar()\nplt.grid(False)\nplt.show()","c4631ba4":"class_names[np.argmax(model.predict(test_images[64:65]))]","9dd5f5a0":"def pred_img(x):\n    img1 = Image.open(x).convert(mode=\"RGB\")\n    img1 = img1.resize((32,32))\n    array1 = np.array(img1.getdata())\n    img_np_array = np.reshape(array1, (32,32,3)) \/ 255.0\n\n    plt.imshow(np.reshape(array1, (32,32,3)))\n    a = np.expand_dims(img_np_array, axis=0)\n    return class_names[np.argmax(model.predict(a))], model.predict(a)","10a1f187":"pred_img('..\/input\/images\/2.jpg')","c8f1dea6":"pred_img('..\/input\/images\/3.jpg')","03e774c8":"pred_img('..\/input\/images\/car.jpg')","85d264ea":"pred_img('..\/input\/images\/a.jpg')","43a8645a":"pred_img('..\/input\/images\/b.jpg')","4d7181e5":"pred_img('..\/input\/images\/c.jpg')","b4a5bdc5":"# Creating Neural Network ","aaca775b":"Training model","4605123c":"# Testing Neural Network","3b244215":"# Loading Data","d64de01f":"# Imports","df37d236":"# Saving Model","01410eea":"# Testing With My Images\n","eea57272":"# Displaying Data"}}