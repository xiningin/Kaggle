{"cell_type":{"cf0b7cb7":"code","0c1c26f8":"code","89bb41de":"code","554f481f":"code","83feb2cf":"code","f2ed1756":"code","23d66bb1":"code","ead585d3":"code","30315e90":"code","768458b8":"code","46c0d134":"code","5a7828fc":"code","2d2922c4":"code","d16c2941":"code","8803cb6e":"code","14d2d8ad":"code","35b5b2b1":"code","c6a3aff2":"code","12df84c4":"code","9cf0cc7b":"code","d9751e3a":"code","7eb972be":"code","9bca13aa":"code","4f93b7fb":"code","a27c0554":"code","7eec2ded":"code","6c0e4058":"markdown","927386aa":"markdown","48c52192":"markdown","64c58c01":"markdown","e458fd81":"markdown","f289e4d7":"markdown","6bdb0b1f":"markdown","31ffb350":"markdown","c5414176":"markdown","33287682":"markdown","124691b3":"markdown","7edeb091":"markdown","115b7db6":"markdown","a3ece003":"markdown","e490d61a":"markdown","26cfc9f9":"markdown","8b0874a3":"markdown","1d85bb35":"markdown","d187212b":"markdown","99d64a76":"markdown","e3524fe4":"markdown","0d44e6e8":"markdown","7049322e":"markdown"},"source":{"cf0b7cb7":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport plotly.express as px\nfrom sklearn.preprocessing import PowerTransformer\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import r2_score\nfrom sklearn.linear_model import LinearRegression","0c1c26f8":"df=pd.read_csv(r'..\/input\/advertising-dataset\/advertising.csv')\ndf.head()","89bb41de":"df.shape","554f481f":"df.info()","83feb2cf":"df.describe()","f2ed1756":"df.isna().sum()","23d66bb1":"color_discrete_sequence1=['red','green','blue','magenta']\nfor i in range(0,len(df.columns)):\n    fig=px.box(df,df.columns[i],color_discrete_sequence=[color_discrete_sequence1[i]])\n    fig.update_layout(\n    autosize=False,\n    width=500,\n    height=500,\n    margin=dict(\n        l=50,\n        r=50,\n        b=100,\n        t=100,\n        pad=4\n    ),\n    paper_bgcolor=\"Black\",\n)\n    fig.show()","ead585d3":"q3=df['Newspaper'].quantile(0.75)\nq1=df['Newspaper'].quantile(0.25)\niqr=q3-q1\nub=q3+1.5*iqr\nlb=q1-1.5*iqr\nnew_df=df[~((df['Newspaper'] < lb) | (df['Newspaper'] > ub))]","30315e90":"color_discrete_sequence1=['red','green','blue','magenta']\nfor i in range(0,len(new_df.columns)):\n    fig=px.box(new_df,new_df.columns[i],color_discrete_sequence=[color_discrete_sequence1[i]])\n    fig.update_layout(\n    autosize=False,\n    width=500,\n    height=500,\n    margin=dict(\n        l=50,\n        r=50,\n        b=100,\n        t=100,\n        pad=4\n    ),\n    paper_bgcolor=\"black\",\n)\n    fig.show()","768458b8":"new_df.skew()","46c0d134":"sns.pairplot(new_df,x_vars=['TV','Radio','Newspaper','Sales'],y_vars=['TV','Radio','Newspaper','Sales'],diag_kind='kde')\nplt.show()","5a7828fc":"df1=new_df.copy(deep=True)\npt=PowerTransformer(standardize=False)\npt_sc=pt.fit_transform(df1)\npt_sc=pd.DataFrame(pt_sc,columns=df1.columns)\npt_sc","2d2922c4":"sns.pairplot(pt_sc,x_vars=['TV','Radio','Newspaper','Sales'],y_vars=['TV','Radio','Newspaper','Sales'],diag_kind='kde')\nplt.show()","d16c2941":"pt_sc.skew()","8803cb6e":"X=pt_sc.drop(['Sales'],axis=1)\ny=pt_sc['Sales']","14d2d8ad":"xtrain,xtest,ytrain,ytest=train_test_split(X,y,test_size=0.3,random_state=48)","35b5b2b1":"print(xtrain.shape)\nprint(xtest.shape)\nprint(ytrain.shape)\nprint(ytest.shape)","c6a3aff2":"fig=px.scatter(pt_sc,x=pt_sc['TV'], y=pt_sc['Sales'],trendline='ols',trendline_color_override='red')\nfig.show()\nresults = px.get_trendline_results(fig)\nprint(results)\nresults.px_fit_results.iloc[0].summary()","12df84c4":"fig=px.scatter(pt_sc,x=pt_sc['Radio'], y=pt_sc['Sales'],trendline='ols',trendline_color_override='magenta')\nfig.show()\nresults = px.get_trendline_results(fig)\nprint(results)\nresults.px_fit_results.iloc[0].summary()","9cf0cc7b":"fig=px.scatter(pt_sc,x=pt_sc['Newspaper'], y=pt_sc['Sales'],trendline='ols',trendline_color_override='green')\nfig.show()\nresults = px.get_trendline_results(fig)\nprint(results)\nresults.px_fit_results.iloc[0].summary()","d9751e3a":"model = LinearRegression()\nmodel.fit(X, y)\n\ncolors = ['Positive' if c > 0 else 'Negative' for c in model.coef_]\n\nfig = px.bar(\n    x=X.columns, y=model.coef_, color=colors,\n    color_discrete_sequence=['blue'],\n    labels=dict(x='Feature', y='Linear coefficient'),\n    title='Weight of each feature for predicting Sales'\n)\nfig.show()","7eb972be":"ypred_test=model.predict(xtest)\nypred_train=model.predict(xtrain)","9bca13aa":"r2_score_test=r2_score(ytest,ypred_test)\nr2_score_test","4f93b7fb":"r2_score_test=r2_score(ytrain,ypred_train)\nr2_score_test","a27c0554":"model.coef_","7eec2ded":"model.intercept_","6c0e4058":"## TV Advertising Vs Sales","927386aa":"For **Advertising** data, the least square fit for the regression of sales on **Radio** is shown.","48c52192":" For **Advertising** data, the least square fit for the regression of sales on **TV** is shown.","64c58c01":"All the values of skewness are in range of -0.5 to +0.5 except of the Newspaper column so we need to correct them","e458fd81":"As we can se that Outliers has been removed from the Newspaper column.","f289e4d7":"## Radio Advertising Vs Sales","6bdb0b1f":"## Newspaper Advertising vs Sales","31ffb350":"## After Power Transformer","c5414176":"No null values present","33287682":"## Pairplot","124691b3":"**We can see that all the columns are of type float64.**","7edeb091":"## Dependent and Independent Variable","115b7db6":"## Removing Outliers:","a3ece003":"We can see that there are Outliers in the newspaper columns which need to beremoved for further analysis.","e490d61a":"## Fitting Multiple Linear Regression","26cfc9f9":"## Visualizing the Boxplot","8b0874a3":"Skewness has been removed using power transformer.","1d85bb35":"# Visualizing the results","d187212b":"## Checking for null values:","99d64a76":"## Exploring the Numeric Variables-Five number summary","e3524fe4":"## Splitting the Data into Train Test Split.","0d44e6e8":"For **Advertising** data, the least square fit for the regression of sales on **Newspaper** is shown.","7049322e":"## checking the skewness"}}