{"cell_type":{"e945f4a0":"code","52dbd904":"code","459bfebe":"code","d498da5c":"code","a1cb08f4":"code","d83e530f":"code","c4817987":"code","e7946bf2":"code","c59aeef7":"code","545cf244":"code","baf59a20":"code","a53f2e42":"code","723b8a0f":"code","21d124b9":"code","35ba467c":"code","deecf8ca":"code","44e20982":"code","3c829867":"code","2bfad178":"code","a90db186":"code","8194a701":"code","45735308":"code","df7f4281":"code","961abf71":"code","484ca88b":"code","38051ebe":"code","aeeb4867":"code","c359c8c5":"code","f3058ba1":"code","4e1c40f6":"code","8af15296":"code","435a0c69":"code","19086667":"code","7690206b":"code","9a17d29e":"code","1b3babb8":"code","fb8135c4":"code","c8f97031":"code","f5314fa7":"code","8bc30491":"code","709042f0":"markdown","df56ca4b":"markdown","da65c0ea":"markdown","1cd29d86":"markdown","f3c94cdc":"markdown","8b58316e":"markdown","ffcf141f":"markdown","382a8d6e":"markdown","42a4e2d4":"markdown","af9d0112":"markdown","572c97ac":"markdown","6d3bd967":"markdown","054d85c9":"markdown","2561d871":"markdown","9739a69a":"markdown","4e83ddbc":"markdown","c417b0a2":"markdown","5ecd2995":"markdown","3e2c9cfc":"markdown","1b0e2130":"markdown","1df63f1c":"markdown","280547dc":"markdown","7f11111a":"markdown","5f2ba83b":"markdown","d10b7125":"markdown"},"source":{"e945f4a0":"import numpy as np \nimport pandas as pd \nfrom matplotlib import pyplot as plt\nimport seaborn as sns\n\nimport warnings\nwarnings.filterwarnings(\"ignore\") \n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n","52dbd904":"df=pd.read_csv('\/kaggle\/input\/market-segmentation-in-insurance-unsupervised\/Customer Data.csv')","459bfebe":"df.head()","d498da5c":"df.tail()","a1cb08f4":"df.shape","d83e530f":"df.info()","c4817987":"df.describe()","e7946bf2":"df.isnull().sum()","c59aeef7":"df[\"MINIMUM_PAYMENTS\"] = df[\"MINIMUM_PAYMENTS\"].fillna(df[\"MINIMUM_PAYMENTS\"].mean())\ndf[\"CREDIT_LIMIT\"] = df[\"CREDIT_LIMIT\"].fillna(df[\"CREDIT_LIMIT\"].mean())","545cf244":"df.isnull().sum()","baf59a20":"df.duplicated().sum()","a53f2e42":"df.drop(columns=[\"CUST_ID\"],axis=1,inplace=True)","723b8a0f":"df.head()","21d124b9":"df.columns","35ba467c":"plt.figure(figsize=(30,45))\nfor i, col in enumerate(df.columns):\n    if df[col].dtype != 'object':\n        ax = plt.subplot(9, 2, i+1)\n        sns.kdeplot(df[col], ax=ax)\n        plt.xlabel(col)\n        \nplt.show()","deecf8ca":"plt.figure(figsize=(10,60))\nfor i in range(0,17):\n    plt.subplot(17,1,i+1)\n    sns.distplot(df[df.columns[i]],kde_kws={'color':'black','bw': 0.1,'lw':3,'label':'KDE'},hist_kws={'color':'g'})\n    plt.title(df.columns[i])\nplt.tight_layout()","44e20982":"plt.figure(figsize=(15,15))\nsns.heatmap(df.corr(), annot=True)\nplt.show()","3c829867":"from sklearn.preprocessing import StandardScaler\nfrom sklearn.decomposition import PCA\nfrom sklearn.cluster import KMeans,AgglomerativeClustering,DBSCAN,SpectralClustering\nfrom sklearn.mixture import GaussianMixture\nfrom sklearn.metrics import silhouette_samples, silhouette_score\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import classification_report\nfrom sklearn import tree\nfrom sklearn import metrics","2bfad178":"scalar=StandardScaler()","a90db186":"scaled_df = scalar.fit_transform(df)","8194a701":"pca = PCA(n_components=2)\nprincipal_components = pca.fit_transform(scaled_df)\npca_df = pd.DataFrame(data=principal_components ,columns=[\"PCA1\",\"PCA2\"])\npca_df","45735308":"inertia = []\nrange_val = range(1,15)\nfor i in range_val:\n    kmean = KMeans(n_clusters=i)\n    kmean.fit_predict(pd.DataFrame(scaled_df))\n    inertia.append(kmean.inertia_)\nplt.plot(range_val,inertia,'bx-')\nplt.xlabel('Values of K') \nplt.ylabel('Inertia') \nplt.title('The Elbow Method using Inertia') \nplt.show()","df7f4281":"kmeans_model=KMeans(4)\nkmeans_model.fit_predict(scaled_df)\npca_df_kmeans= pd.concat([pca_df,pd.DataFrame({'cluster':kmeans_model.labels_})],axis=1)","961abf71":"plt.figure(figsize=(8,8))\nax=sns.scatterplot(x=\"PCA1\",y=\"PCA2\",hue=\"cluster\",data=pca_df_kmeans,palette=['red','green','blue','black'])\nplt.title(\"Clustering using K-Means Algorithm\")\nplt.show()","484ca88b":"cluster_centers = pd.DataFrame(data=kmeans_model.cluster_centers_,columns=[df.columns])","38051ebe":"\ncluster_centers = scalar.inverse_transform(cluster_centers)\ncluster_centers = pd.DataFrame(data=cluster_centers,columns=[df.columns])\ncluster_centers\n","aeeb4867":"cluster_df = pd.concat([df,pd.DataFrame({'Cluster':kmeans_model.labels_})],axis=1)\ncluster_df","c359c8c5":"cluster_1_df = cluster_df[cluster_df[\"Cluster\"]==0]\ncluster_1_df","f3058ba1":"cluster_2_df = cluster_df[cluster_df[\"Cluster\"]==1]\ncluster_2_df","4e1c40f6":"cluster_3_df = cluster_df[cluster_df[\"Cluster\"]==2]\ncluster_3_df","8af15296":"cluster_4_df = cluster_df[cluster_df[\"Cluster\"] == 3]\ncluster_4_df","435a0c69":"sns.countplot(x='Cluster', data=cluster_df)","19086667":"for c in cluster_df.drop(['Cluster'],axis=1):\n    grid= sns.FacetGrid(cluster_df, col='Cluster')\n    grid= grid.map(plt.hist, c)\nplt.show()","7690206b":"#Saving Scikitlearn models\nimport joblib\njoblib.dump(kmeans_model, \"kmeans_model.pkl\")","9a17d29e":"cluster_df.to_csv(\"Clustered_Customer_Data.csv\")","1b3babb8":"#Split Dataset\nX = cluster_df.drop(['Cluster'],axis=1)\ny= cluster_df[['Cluster']]\nX_train, X_test, y_train, y_test =train_test_split(X, y, test_size=0.3,random_state=3)","fb8135c4":"X_train\n","c8f97031":"X_test","f5314fa7":"\nmodel= DecisionTreeClassifier(criterion=\"entropy\")\nmodel.fit(X_train, y_train)\ny_pred = model.predict(X_test)","8bc30491":"#Confusion_Matrix\nprint(metrics.confusion_matrix(y_test, y_pred))\nprint(classification_report(y_test, y_pred))","709042f0":"# checking for duplicate rows in the dataset","df56ca4b":"# filling mean value in place of missing values in the dataset","da65c0ea":"# Training and Testing the model accuracy using decision tree","1cd29d86":"# Visualization","f3c94cdc":"# find all cluster centers","8b58316e":"# Now Some Visulaization ","ffcf141f":"# Creating a target column \"Cluster\" for storing the cluster segment","382a8d6e":"# Hyperparameter tuning \n","42a4e2d4":"# Loading the dataset","af9d0112":"# Dimensionality reduction\nConverting the DataFrame into 2D DataFrame for visualization","572c97ac":"# Decision Tree Classifier","6d3bd967":"# Model Building using KMeans","054d85c9":"# inverse transform the data","2561d871":"# Now Import Some More Important Libs","9739a69a":"# Visualizing the clustered dataframe","4e83ddbc":"# My Accuracy Score is 94%","c417b0a2":"# Now read all columns name","5ecd2995":"\n# Finding 'k' value by Elbow Method","3e2c9cfc":"# Checking The head and tail of the dataset","1b0e2130":"#  Now Scaling the DataFrame","1df63f1c":"# Now Start EDA","280547dc":"# drop CUST_ID column because it is not used","7f11111a":"# Thank You \n\n\n# Hopefully this notebook is helping you .","5f2ba83b":"# WHAT IS MARKET SEGMENTATION?\n\nMarket Segmentation\nIn marketing, market segmentation is the process of dividing a broad consumer or business market, normally consisting of existing and potential customers, into sub groups of consumers based on some type of shared characteristics.","d10b7125":"# Saving the kmeans clustering model and the data with cluster label"}}