{"cell_type":{"d638ebb5":"code","5baa4bff":"code","5841bbdf":"code","3392a010":"code","2bf73a33":"code","35d4ad5d":"code","bbcd85ee":"code","ec25eda4":"code","3c971414":"code","3cf5daf3":"code","194592b6":"code","dfa9db79":"code","05a0068b":"code","b37f4922":"code","154b9bff":"code","52d1726e":"code","49f40ca2":"code","735c856b":"code","7f14e9ed":"code","6220759c":"code","c2eafc38":"code","8d438051":"code","080b9a45":"markdown","6e525ea4":"markdown","ca30f6c8":"markdown","da39864c":"markdown","43a8ebed":"markdown","f3db1e47":"markdown","000a463c":"markdown","185d7307":"markdown"},"source":{"d638ebb5":"import numpy as np\nimport pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport plotly.express as px\nimport folium, json, math, requests, plotly\nfrom branca.colormap import linear\nfrom bs4 import BeautifulSoup","5baa4bff":"states = pd.read_csv('\/kaggle\/input\/brazilianstates\/states.csv')\nstates.head()","5841bbdf":"corona = pd.read_csv('\/kaggle\/input\/corona-virus-brazil\/brazil_covid19.csv')\ncorona = corona.merge(states, on='state')\ncorona['potentials'] = corona['population'] * 0.2\ncorona['potentials'] = corona['potentials'].astype(int)\ncorona['date'] = pd.to_datetime(corona['date'])\ncorona.head()","3392a010":"corona.dtypes","2bf73a33":"group_uf = corona.groupby('state')\nuf = group_uf.tail(1).sort_values('cases', ascending=False).drop(columns=['date','hour']).set_index('state')\nuf.style.background_gradient(cmap='Reds', subset=['suspects','refuses','cases','deaths'])","35d4ad5d":"d = {'cases' : uf['cases'].sum(), 'deaths': uf['deaths'].sum()}\ntotal = pd.DataFrame(d.items(), columns=['type', 'total_count']).set_index('type')\ntotal","bbcd85ee":"plt.figure(figsize=(10, 6))\nbar = sns.barplot(x=total.index, y=\"total_count\", data=total)\nfor p in bar.patches:\n    bar.annotate('{:.0f}'.format(p.get_height()), (p.get_x()+0.4, p.get_height()),ha='center', va='bottom',color= 'black')\nbar.set_title('Total count of cases on Brazil until {}'.format(corona.iloc[-1,0].strftime('%d\/%m\/%Y')), fontsize=16)\nplt.xlabel('Cases types')\nplt.ylabel('Cases counts')\nplt.show()","ec25eda4":"cumulated = corona.groupby('date').sum()","3c971414":"ig, ax = plt.subplots(figsize=(16, 8))\nsns.set(style=\"darkgrid\")\nsns.lineplot(x=cumulated.index, y='cases', data=cumulated, color='orange')\nplt.yscale(\"log\")\nplt.xticks(rotation=90, ha='right')\nplt.title('COVID-19 confirmed cases on Brazil until {}'.format(corona.iloc[-1,0].strftime('%d\/%m\/%Y')), fontsize=14)\nplt.ylabel('Number of cases', fontsize=12)\nplt.xlabel('Date', fontsize=12)\nplt.axvline('2020-03-16', 0, 1200, c='dodgerblue', linestyle='--', linewidth=2, alpha=1, label='Companies start quarantine')\nplt.axvline('2020-03-21', 0, 1200, c='k', linestyle='dotted', linewidth=2, alpha=1, label='SP government declares quarantine')\nplt.legend(loc=2, fancybox=True, fontsize=10)\nplt.show();","3cf5daf3":"fig, ax = plt.subplots(figsize=(16, 8))\nsns.set(style=\"darkgrid\")\n\nlabels = []\nfor s in uf.index[:10]:\n    l = sns.lineplot(x='date', y='cases', data=corona[(corona['state'] == s)])\n    labels.append(s)\nplt.ylabel('Casos Confirmados', fontsize=12)\nplt.xlabel('Data', fontsize=12)\nplt.xticks(rotation=90, ha='right')\nplt.title('COVID-19 Casos Confirmados no Brasil Por Estados At\u00e9 {} (em escala linear)'.format(corona.iloc[-1,0].strftime('%d\/%m\/%Y')), fontsize=14)\n\nfig.legend(loc=6, bbox_to_anchor=(0.063, 0.4), labels=labels)\nplt.legend(loc=2, fancybox=True, fontsize=10)\nplt.xlim(xmin=\"2020-02-22\")\n\nplt.show();","194592b6":"fig, ax = plt.subplots(figsize=(16, 8))\nsns.set(style=\"darkgrid\")\n\nlabels = []\nfor s in uf.index[:10]:\n    l = sns.lineplot(x='date', y='cases', data=corona[(corona['state'] == s)])\n    labels.append(s)\nplt.yscale(\"log\")\nplt.ylabel('Casos Confirmados', fontsize=12)\nplt.xlabel('Data', fontsize=12)\nplt.xticks(rotation=90, ha='right')\nplt.title('COVID-19 Casos Confirmados no Brasil Por Estados At\u00e9 {} (em escala logar\u00edtmica)'.format(corona.iloc[-1,0].strftime('%d\/%m\/%Y')), fontsize=14)\n\nfig.legend(loc=6, bbox_to_anchor=(0.063, 0.4), labels=labels)\nplt.legend(loc=2, fancybox=True, fontsize=10)\nplt.xlim(xmin=\"2020-02-22\")\n\nplt.show();","dfa9db79":"for s in uf.index:\n    ig, ax = plt.subplots(figsize=(20, 8))\n    plt.xticks(rotation=90, ha='right')\n    sns.lineplot(x='date', y='cases', data=corona[(corona['state'] == s)])\n    sns.lineplot(x='date', y='suspects', data=corona[(corona['state'] == s)])\n    plt.title('Number of cases on {}'.format(s), fontsize=14);\n    plt.legend(labels=['confirmed','suspects'])\n    plt.ylabel('Number of cases', fontsize=12)\n    plt.xlabel('Date', fontsize=12)\n    plt.show();","05a0068b":"events = corona.groupby('date').sum()\nevents.tail()","b37f4922":"events.sum()","154b9bff":"ig, ax = plt.subplots(figsize=(12, 8))\nbar = sns.barplot(x=uf['uf'], y=uf['cases'])\nfor p in bar.patches:\n    bar.annotate('{:.0f}'.format(p.get_height()), (p.get_x()+0.4, p.get_height()),ha='center', va='bottom',color= 'black')\nplt.ylabel('Total confirmed cases', fontsize=12)\nplt.xlabel('States', fontsize=12)\nplt.title('Number of confirmed cases by state until {}'.format(corona.iloc[-1,0].strftime('%d\/%m\/%Y')), fontsize=14)\nplt.show();","52d1726e":"url = '\/kaggle\/input\/brazil-geojson\/brazil_geo.json'\ngeo = json.load(open(url))","49f40ca2":"df = uf.reset_index().set_index('uf')\ndf.head()","735c856b":"colormap = linear.YlOrRd_09.scale(0,50)\n\nmap = folium.Map(\n    width=800, height=600,\n    location=[-15.77972, -47.92972], \n    zoom_start=4\n)\nfolium.GeoJson(\n    geo,\n    name='cases',\n    style_function=lambda feature: {\n        'fillColor': colormap(df['cases'][feature['id']]),\n        'color': 'black',\n        'weight': 0.4,\n    }\n).add_to(map)\ncolormap.caption = 'Confirmed COVID-19 cases per state'\ncolormap.add_to(map)\n\nmap","7f14e9ed":"weeks = corona.groupby('state').tail(7)\nweeks['date'] = weeks['date'].dt.strftime('%d\/%m\/%Y')\nweeks = weeks.pivot_table(index='uf', columns='date', values='suspects').fillna(0)\nweeks.style.background_gradient(cmap='Reds')","6220759c":"ig, ax = plt.subplots(figsize=(10, 10))\nsns.heatmap(weeks, linewidths=1, cmap=\"Blues\")\nplt.ylabel('States', fontsize=12)\nplt.xlabel('Dates', fontsize=12)\nplt.title('Suspect cases until {}'.format(corona.iloc[-1,0].strftime('%d\/%m\/%Y')), fontsize=16)\nplt.show();","c2eafc38":"weeks = corona.groupby('state').tail(7)\nweeks['date'] = weeks['date'].dt.strftime('%d\/%m\/%Y')\nweeks = weeks.pivot_table(index='uf', columns='date', values='cases').fillna(0)\nweeks.style.background_gradient(cmap='Reds')","8d438051":"ig, ax = plt.subplots(figsize=(10, 10))\nsns.heatmap(weeks, linewidths=1, cmap=\"Blues\")\nplt.ylabel('States', fontsize=12)\nplt.xlabel('Dates', fontsize=12)\nplt.title('Confirmed cases until {}'.format(corona.iloc[-1,0].strftime('%d\/%m\/%Y')), fontsize=16)\nplt.show();","080b9a45":"## Total number of cases by state\nThe following code shows the total number of cases of the top 10 states.","6e525ea4":"## Data Processing\nOn the following snippets, I download the updated COVID-19 dataframe, provided by Brazil's Health Ministry. Beyond the given data, I added a new feature to the dataframe, named `potentials`. This columns contains the number of potential cases, based on the average transmission rate of 20% over the total population.","ca30f6c8":"# Coronavirus on Brazil\n\nThe current notebook proposes a visual analysis of the present Coronavirus pandemic in Brazil, comparing different states' situations over time. The [COVID-19 dataset](https:\/\/www.kaggle.com\/unanimad\/corona-virus-brazil) was provided by [Raphael Fontes](https:\/\/www.kaggle.com\/unanimad), gathered from Brazilian's Health Ministry.","da39864c":"## Number of confirmed cases on the last days","43a8ebed":"### Due to the crescent number of confirmed cases, on March 20th the Health Ministry stopped counting the number of suspected cases.","f3db1e47":"## Number of suspect cases on the last days\n### Due to the crescent number of confirmed cases, on March 20th the Health Ministry stopped counting the number of suspected cases.","000a463c":"## Number of confirmed cases over time per state","185d7307":"## Number of cases over time per states\nThe following chart shows the transmission progression over time per state, comparing:\n* The number of confirmed cases per day\n* The number of suspect cases per day"}}