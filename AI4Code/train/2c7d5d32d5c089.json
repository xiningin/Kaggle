{"cell_type":{"27e349eb":"code","3e1eb51c":"markdown"},"source":{"27e349eb":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\n\ndef import_file():\n    data=pd.read_csv('..\/input\/cracow-apartments-data-set\/cracow_apartments.csv')\n    m=len(data)\n    return data,m\n\n#Let us get only the price and size for now\ndef clean(data):\n    y, X=data['price'].to_numpy(), data['size'].to_numpy()\n    return y,X\n\n#Get the cost value. Important to check the cost plot\ndef cost(prediction, y, m):\n    vals=[(Ho-Y)**2 for Ho,Y in zip(prediction,y)]\n    cost_value=sum(vals)\/(2*m)\n    return cost_value\n\n#Calculate the predicted value given the parameters\ndef predict(w0,b,X):\n    prediction=[w0*x+b for x in X]\n    prediction=np.array(prediction)\n    return prediction\n\n#Train our model to get the correct parameters\ndef train(X,y,m,iterations,learning_rate=0.0002):\n    accumulated_cost=[]\n    w0,b=0,0\n    \n    for i in range(iterations):\n        final_predictions=predict(w0,b,X)\n        w0-=learning_rate*(sum(np.multiply((final_predictions - y),X)))\/m\n        b-=learning_rate*(sum(final_predictions - y))\/m\n        accumulated_cost.append(cost(final_predictions,y,m))\n    print('The function is price={}*size + {} at {} iterations'.format(np.round(w0,2),np.round(b,2),iterations))\n    return final_predictions,accumulated_cost\n\n#Visualize the results\ndef visualize(X,y,final_predictions,iterations,accumulated_cost):\n    #compare actual data to predicted data\n    fig1,(ax1,ax2)=plt.subplots(1,2,sharey=True)\n    fig1.suptitle('Housing prices prediction')\n    ax1.scatter(X,y)\n    ax1.set_title('Actual data')\n    ax1.set_xlabel('Size of apartment')\n    ax1.set_ylabel('Price')\n    ax2.scatter(X,final_predictions)\n    ax2.set_title('Predicted data')\n    ax2.set_xlabel('Size of apartment')\n    plt.show()\n    \n    #check the cost graph\n    plt.figure(2)\n    plt.plot(range(iterations), accumulated_cost)\n    plt.title('Cost Function')\n    plt.xlabel('Iterations')\n    plt.ylabel('Cost')\n    plt.xlim((0,len(X)))\n    plt.show()\n\n#Run the program. You can specify the number of iterations\ndef program(iterations=1000):\n    data,m=import_file()\n    y,X=clean(data)\n    final_predictions,accumulated_cost=train(X,y,m,iterations)\n    visualize(X,y,final_predictions,iterations,accumulated_cost)\n\n#Execute\nprogram()","3e1eb51c":"# This is a practice with Linear Regression using pure code. Not using sklearn."}}