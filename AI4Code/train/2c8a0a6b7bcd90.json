{"cell_type":{"69e376c2":"code","0bee4766":"code","0c32f9df":"code","f74b9010":"code","8acf7284":"code","9bb3a4dd":"code","ab441eee":"code","5c1d5c70":"code","8e86ab09":"code","ebc1f259":"code","b870568a":"code","e2d51afd":"code","29d51916":"code","ecc73594":"code","bbf88c96":"code","375248e6":"code","2d09c947":"code","3372eca0":"code","8c46c84f":"code","b05d2a37":"code","f44d1699":"code","6d51b91b":"code","b07b0a27":"code","c7054b98":"code","1cffbcc8":"code","ddaacef3":"markdown","1e6bb41c":"markdown","d8d94221":"markdown","f03bc4cb":"markdown","51454b3a":"markdown","b6832955":"markdown","dbb6ea50":"markdown","26bccefa":"markdown","eee9c72f":"markdown","52ecd053":"markdown","4d9bcba2":"markdown","1066364c":"markdown","73091b84":"markdown","1cedeaaa":"markdown"},"source":{"69e376c2":"## Import numpy, pandas\n\nimport pandas as pd\nimport numpy as np\nimport warnings\nwarnings.filterwarnings('ignore')\n\n\n## Import Logistic regression, Randomforest, DecisionTree and SVC\n\nfrom sklearn.model_selection import train_test_split \nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.svm import SVC\nfrom sklearn.tree import DecisionTreeClassifier\n\n# Plots\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline\nfrom itertools import cycle\n\n# Data processing, metrics and modeling\nfrom sklearn import preprocessing\nfrom sklearn.metrics import confusion_matrix, classification_report,plot_confusion_matrix, accuracy_score\n\n","0bee4766":"data=pd.read_csv(\"..\/input\/heart-attack-analysis-prediction-dataset\/heart.csv\")\ndata.head()\n","0c32f9df":"## Check the shape of data.\ndata.shape","f74b9010":"color_cycle = cycle(plt.rcParams['axes.prop_cycle'].by_key()['color'])\n\nsns.countplot(data['output'])\nplt.show()","8acf7284":"data.isnull().sum()","9bb3a4dd":"data.duplicated().sum()","ab441eee":"data.drop_duplicates(inplace = True)","5c1d5c70":"plt.figure(figsize =(12,6))\nsns.heatmap(data.corr(),robust=True,fmt='.1g',linewidths=1.3,linecolor='gold',annot=True);","8e86ab09":"# separate the data from the target attributes\nX = data.drop([\"output\"],axis = 1)\ny = data.output\n# normalize the data attributes\nnormalized_X = preprocessing.normalize(X)","ebc1f259":"X_train,X_val,y_train,y_val = train_test_split(X,y,test_size=1\/3,random_state=42, stratify=y)","b870568a":"X_train.shape","e2d51afd":"X_val.shape","29d51916":"model_1 = DecisionTreeClassifier(random_state=10)\nmodel_1.fit(X_train,y_train)","ecc73594":"val_predictions = model_1.predict(X_val)\nscore_model1 =accuracy_score(y_val,val_predictions)\nprint(score_model1)","bbf88c96":"report_model1=classification_report(y_val,val_predictions)\nprint(report_model1)","375248e6":"conf_mat1=confusion_matrix(y_val,val_predictions)\nplt.figure(figsize=(6,6))\nsns.heatmap(conf_mat1,annot=True,fmt=\".0f\")\nplt.ylabel(\"Actual\")\nplt.xlabel(\"Predicted\")\nplt.title(\"Confusion Matrix for Decision Tree\")\nplt.show()","2d09c947":"model_2 = RandomForestClassifier(random_state=10)\nmodel_2.fit(X_train,y_train)","3372eca0":"val_predictions_1 = model_2.predict(X_val)\nscore_model2 =accuracy_score(y_val,val_predictions_1)\nprint(score_model2)","8c46c84f":"report_model2=classification_report(y_val,val_predictions_1)\nprint(report_model2)","b05d2a37":"conf_mat2=confusion_matrix(y_val,val_predictions_1)\nplt.figure(figsize=(6,6))\nsns.heatmap(conf_mat2,annot=True,fmt=\".0f\")\nplt.ylabel(\"Actual\")\nplt.xlabel(\"Predicted\")\nplt.title(\"Confusion Matrix for Random Forest\")\nplt.show()","f44d1699":"model_3 = SVC(random_state=10)\nmodel_3.fit(X_train,y_train)","6d51b91b":"val_predictions_2 = model_3.predict(X_val)\nscore_model3 =accuracy_score(y_val,val_predictions_2)\nprint(score_model3)","b07b0a27":"report_model3=classification_report(y_val,val_predictions_2)\nprint(report_model3)","c7054b98":"conf_mat3=confusion_matrix(y_val,val_predictions_2)\nplt.figure(figsize=(6,6))\nsns.heatmap(conf_mat3,annot=True,fmt=\".0f\")\nplt.ylabel(\"Actual\")\nplt.xlabel(\"Predicted\")\nplt.title(\"Confusion Matrix for Support Vector Machine\")\nplt.show()","1cffbcc8":"# Comparison Graph for used algorithms \nalgo_names=['Random Forest','SVM','Decision Tree']\nalgo_scores=(score_model2,score_model3,score_model1)\nplt.figure(figsize=(12,10))\nplt.ylim([0.60,1])\nplt.bar(algo_names,algo_scores,width=0.3)\nplt.xlabel('Algorithm Names')\nplt.ylabel('Algorithm Scores')","ddaacef3":"<h1 style=\"background-color:#ABFF9B;font-size:20px;color:#00033E;font-weight : bold\">Correlation Matrix<\/h1>","1e6bb41c":"<h1 style=\"background-color:#ABFF9B;font-size:20px;color:#00033E;font-weight : bold\"> Importing Required Libraries<\/h1>","d8d94221":"<h1 style=\"background-color:#ABFF9B;font-size:20px;color:#00033E;font-weight : bold\">Read the data <\/h1>","f03bc4cb":"## **Balancing the dataset**","51454b3a":"<h1 style=\"background-color:#ABFF9B;font-size:20px;color:#00033E;font-weight : bold\">Check missing values in the dataset<\/h1>","b6832955":"<h1 style=\"background-color:#ABFF9B;font-size:20px;color:#00033E;font-weight : bold\"> 1.Decision Tree <\/h1>","dbb6ea50":"<span style=\"font-size:20px;color:#0026D8;font-weight : bold\">Problem statement : Comparing different Machine learning algorithms to classify if a person is prone to Heart attacks or not<\/span>\n\n<span style=\"font-size:20px;color:#0026D8;font-weight : bold\">Data Description: Dataset of Heart Attack<\/span>\n\n\n- **Age** : Age of the patient\n- **Sex** : Sex of the patient\n- **exang**: exercise induced angina (1 = yes; 0 = no)\n- **ca**: number of major vessels (0-3)\n- **cp** : Chest Pain type chest pain type\n   - Value 1: typical angina\n   - Value 2: atypical angina\n   - Value 3: non-anginal pain\n   - Value 4: asymptomatic\n- **trtbps** : resting blood pressure (in mm Hg)\n- **chol** : cholestoral in mg\/dl fetched via BMI sensor\n- **fbs** : (fasting blood sugar > 120 mg\/dl) (1 = true; 0 = false)\n- **rest_ecg** : resting electrocardiographic results\n   - Value 0: normal\n   - Value 1: having ST-T wave abnormality (T wave inversions and\/or ST elevation or depression of > 0.05 mV)\n   - Value 2: showing probable or definite left ventricular hypertrophy by Estes' criteria\n- **thalach** : maximum heart rate achieved\n- **target** : 0= less chance of heart attack 1= more chance of heart attack","26bccefa":"<h1 style=\"background-color:#ABFF9B;font-size:20px;color:#00033E;font-weight : bold\">Scaling the data<\/h1>","eee9c72f":"<h1 style=\"background-color:#ABFF9B;font-size:20px;color:#00033E;font-weight : bold\"> 2.Random Forest<\/h1>","52ecd053":"<h1 style=\"background-color:#ABFF9B;font-size:20px;color:#00033E;font-weight : bold\"> Algorithms<\/h1>","4d9bcba2":"<h1 style=\"background-color:#ABFF9B;font-size:20px;color:#00033E;font-weight : bold\"> 3.SVM <\/h1>","1066364c":"<h1 style=\"background-color:#ABFF9B;font-size:20px;color:#00033E;font-weight : bold\">Splitting Dataset Into Training & Validation Set<\/h1>","73091b84":"<br>\n<h1 style = \"font-size:25px; font-family:monospace ; font-weight : bold; text-align: center; border-radius: 10px 10px;\">Therefore,Random Forest performed better with 80% accuracy. <\/h1>\n<br>","1cedeaaa":"<h1 style=\"background-color:#ABFF9B;font-size:20px;color:#00033E;font-weight : bold\">Check duplicate values in the dataset<\/h1>"}}