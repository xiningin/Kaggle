{"cell_type":{"e0eb42c9":"code","bb4f01eb":"code","1ea70940":"code","a22221dc":"code","33d1f14b":"code","0e9183e5":"code","edd798df":"code","7dcd9fa6":"code","59a13544":"code","a929c3bf":"code","c1489198":"code","8b17862d":"code","86460f55":"code","721a221a":"code","54d3a925":"code","ca9b4c53":"code","970f5939":"code","d908e676":"code","3edfa094":"code","bd1b89cf":"code","1523eee8":"code","341f245e":"code","d23a290a":"code","601fe0ac":"code","06a4156f":"code","226e692e":"code","7ea09360":"code","7b8ecef8":"code","3323489b":"code","7e82eb40":"code","5321b26d":"code","3d64be3c":"code","11fbc614":"code","ef782fe8":"code","a3bd5c08":"code","9329241d":"code","4d3e6e8f":"code","caeee799":"code","6574644a":"code","7076f958":"code","e8d163cf":"code","970d4223":"code","2d7d3944":"code","e44acaaa":"code","8365ccb2":"code","76667b37":"code","4c98483c":"code","57b9bf7b":"code","3a6e2e6e":"code","cbf424bf":"code","a38dca89":"code","077fb636":"code","fe31ea65":"code","e2717560":"code","b6e49110":"code","007977c4":"code","09d878dd":"code","0c9597f5":"code","9d4552cf":"code","f9eb5afc":"code","0a1e22cd":"code","42fdb873":"code","ea9b376c":"markdown","3a9c448a":"markdown","4f8348aa":"markdown","8e0773f1":"markdown","fa411f31":"markdown","6e917ec9":"markdown","a7db9c9f":"markdown","5171c9d5":"markdown","3ae05c4e":"markdown","1daa5427":"markdown","d68b96ac":"markdown","e0a35780":"markdown","0856775f":"markdown","b34dfd8e":"markdown","74fc95c4":"markdown","1920f223":"markdown","be09e1cc":"markdown","76df1ec7":"markdown","a32a0f85":"markdown","7f5adb32":"markdown","5163ee70":"markdown","25ad1607":"markdown"},"source":{"e0eb42c9":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport scipy.stats as sc","bb4f01eb":"sns.set()","1ea70940":"data=pd.read_csv(r\"..\/input\/insurance\/insurance.csv\")","a22221dc":"data.head(10)","33d1f14b":"data.isnull().sum()#No Missing Values","0e9183e5":"data.describe().T","edd798df":"data['smoker'].value_counts()","7dcd9fa6":"plt.subplot(1,2,1)\nplt.pie(data['smoker'].value_counts(),labels=data['smoker'].value_counts().index,autopct=\"%.1f%%\")\nplt.title('Smoker vs Non-Smoker Count')\n\nplt.subplot(1,2,2)\nplt.pie(data['sex'].value_counts(),labels=data['sex'].value_counts().index,autopct=\"%.1f%%\")\nplt.title('Male vs Female Count')\nplt.show()","59a13544":"plt.figure(figsize=(4,4))\nsns.heatmap(data.corr(),cmap='coolwarm',annot=True,linewidths=0.5)\nplt.show()\n","a929c3bf":"plt.figure(figsize=(8,12))\nplt.subplot(3,1,1)\nsns.boxplot(data['age'])\nplt.subplot(3,1,2)\nsns.boxplot(data['bmi'])\nplt.subplot(3,1,3)\nsns.boxplot(data['charges'])\nplt.show()","c1489198":"sc.skew(data['charges'])\n#Charges data is highly skewed","8b17862d":"gender_smoker=pd.crosstab(data['sex'],data['smoker'])\ngender_smoker","86460f55":"gender_smoker.plot(kind=\"bar\")\nplt.title(\"Smoker(Yes\/No) Count by Gender\")\nplt.show()","721a221a":"sns.pairplot(data)","54d3a925":"#LET'S GRAB THE USEFUL ONES","ca9b4c53":"plt.figure(figsize=(20,5))\nplt.subplot(1,3,1)\nsns.scatterplot(data['bmi'],data['charges'],hue=data.smoker)\nplt.subplot(1,3,2)\nsns.scatterplot(data['age'],data['charges'],hue=data.smoker)\nplt.subplot(1,3,3)\nsns.scatterplot(data['children'],data['charges'],hue=data.smoker)\nplt.show()","970f5939":"plt.figure(figsize=(12,4))\nplt.subplot(1,2,1)\nsns.scatterplot(data[data[\"sex\"]==\"female\"]['age'],data[data[\"sex\"]==\"female\"]['charges'],hue=data[data[\"sex\"]==\"female\"][\"smoker\"])\nplt.title(\"Female CHARGES vs AGE\")\nplt.subplot(1,2,2)\nsns.scatterplot(data[data[\"sex\"]==\"male\"]['age'],data[data[\"sex\"]==\"male\"]['charges'],hue=data[data[\"sex\"]==\"male\"][\"smoker\"])\nplt.title(\"Male CHARGES vs AGE\")\nplt.show()","d908e676":"sns.distplot(data['age'])\nplt.title(\"Distribution of Age\")\nplt.show()","3edfa094":"young_smokers=data[(data['age']<20) & (data['smoker']=='yes')]\nyoung_smokers.head()","bd1b89cf":"sns.boxplot(x=young_smokers.charges)\nplt.title(\"Charges range of young smokers < 20 yrs of age\")\nplt.show()","1523eee8":"sns.boxplot(x=young_smokers['region'],y=young_smokers['charges'])\nplt.title(\"Regionwise Charges Distribution for smokers of age < 20yrs \")\nplt.show()","341f245e":"young_smokers.groupby(['region','smoker']).sum()['charges']","d23a290a":"young_smokers[young_smokers.smoker=='yes']['region'].value_counts()","601fe0ac":"sns.boxplot(x=data['region'],y=data['charges'],hue=data.smoker)\nplt.title(\"Regionwise Charges Distribution\")\nplt.show()","06a4156f":"sns.countplot(data.region,hue=data.smoker)","226e692e":"higher_charge=data[data.charges>16639.912515]","7ea09360":"plt.figure(figsize=(10,12))\nplt.subplot(3,1,1)\nsns.countplot(higher_charge['region'],hue=higher_charge['smoker'])\nplt.subplot(3,1,2)\nsns.countplot(higher_charge['sex'],hue=higher_charge['smoker'])\nplt.subplot(3,1,3)\nsns.boxplot(higher_charge['age'],color=\"0.25\")\nplt.show()","7b8ecef8":"higher_charge.head(2)","3323489b":"higher_charge['BMI Category']=pd.cut(higher_charge.bmi,bins=[0,18.5,25,30,53],labels=['Underweight','Healthy weight','Overweight','Obese']).values\nhigher_charge['Age Category']=pd.cut(higher_charge.age,bins=[18,30,42,54,64],labels=['Young Adult','Middle Adult','Senior Adult','Elder']).values\nhigher_charge","7e82eb40":"plt.figure(figsize=(15,5))\nplt.subplot(1,2,1)\nsns.scatterplot(higher_charge['age'],higher_charge['charges'],hue=higher_charge['BMI Category'])\nplt.subplot(1,2,2)\nsns.scatterplot(higher_charge['age'],higher_charge['charges'],hue=higher_charge['smoker'])\nplt.show()","5321b26d":"plt.figure(figsize=(12,5))\nplt.subplot(1,2,1)\nsns.countplot(higher_charge['BMI Category'])\nplt.subplot(1,2,2)\nsns.countplot(higher_charge['Age Category'])\nplt.show()","3d64be3c":"sns.countplot(higher_charge.sex,hue=higher_charge['BMI Category'])\nplt.show()","11fbc614":"plt.figure(figsize=(20,5))\nsns.countplot(data.age,hue=data.smoker)\nplt.title(\"AGE COUNT\")\nplt.show()","ef782fe8":"Ho=\"Gender has no effect on smoking habits\"\nHa=\"Gender has effect on smoking habits\"\nchi,p_value,dof,expected=sc.chi2_contingency(gender_smoker)\nif (p_value>0.05):\n    print(Ho)\nelse:\n    print(Ha)","a3bd5c08":"chi\n#tabular_chi=3.84,thus reject Ho","9329241d":"gender_smoker#clearly we have more male smokers","4d3e6e8f":"Ho=\"Region has no effect on charges\"\nHa=\"Region has effect on charges\"\nsample=data.sample(100)\ncharges=pd.cut(sample['charges'].sort_values(ascending=False),bins=15)\nchi2,p,ddof,ex=sc.chi2_contingency(pd.crosstab(sample['region'],charges))","caeee799":"if (chi2<58.124):\n    print(Ho)\nelse:\n    print(Ha)","6574644a":"sns.distplot(data['charges'])\n","7076f958":"#Forming sample dataset randomly\nimport random\nn=1000\nks=100\nsample_dataset=[]\nfor i in range(0,n):\n    sample_dataset.append(random.choices(data[\"charges\"],k=ks))","e8d163cf":"#Calculating mean from means of sample sets: SAMPLE MEAN\/s_mean\nsample_means=[]\nfor i in sample_dataset:\n    sample_means.append(np.mean(i))\ns_mean=np.mean(sample_means)\ns_mean","970d4223":"#ACTUAL DATA MEAN\ndata['charges'].mean()","2d7d3944":"s_var=np.var(sample_means)\ns_std=np.std(sample_means)","e44acaaa":"s_var","8365ccb2":"data['charges'].var()\/(100)#Actual variance","76667b37":"s_std","4c98483c":"data['charges'].std()\/np.sqrt(100)#Actual standard_deviation","57b9bf7b":"data[data['charges']>16639.912515]\n#this comprises of about 25% data","3a6e2e6e":"ub_bmi=34.595000+1.5*(34.595-26.315)#upperboundary_bmi","cbf424bf":"data['bmi']=np.where(data['bmi']>ub_bmi,ub_bmi,data['bmi'])#replacing outliers in bmi with ub_bmi","a38dca89":"data['bmi'].plot(kind=\"box\")\nplt.show()#No outliers","077fb636":"data=pd.get_dummies(data)#encoding CATEGORICAL DATA","fe31ea65":"data.head()","e2717560":"sns.heatmap(data.corr(),cmap=\"cool\")#High corr with smoker","b6e49110":"#Splitting data into train & test\nfrom sklearn.model_selection import train_test_split\nx=data.drop(['charges'],axis=1)\ny=data['charges']\nx_train,x_test,y_train,y_test=train_test_split(x,y,test_size=0.2,random_state=0)","007977c4":"#Training the model\nfrom sklearn.linear_model import LinearRegression\nlr=LinearRegression()\nlr.fit(x_train,y_train)","09d878dd":"#Predicting the values\ny_pred=lr.predict(x_test)\ny_pred_train=lr.predict(x_train)","0c9597f5":"from sklearn.metrics import mean_squared_error,r2_score#TO TEST THE MODEL","9d4552cf":"mean_squared_error(y_test,y_pred)","f9eb5afc":"np.sqrt(35746516.8773678)","0a1e22cd":"r2_score(y_test,y_pred)","42fdb873":"r2_score(y_train,y_pred_train)","ea9b376c":"*1.Clearly, smokers are paying much extra*\n\n*2.Relation of bmi & charges is not prominent for non-smokers.\nWhile for smokers, we do see a linear relationship which suggests: smokers with high bmi are definitely paying much more.*\n\n*3. A linear relation of age & charges is prominent for non-smokers. Few datapoints are random & towards the higher charges, maybe due to bmi as additional factor*\n","3a9c448a":"# Central Limit Theorm On CHARGES","4f8348aa":"# Hypothesis Testing","8e0773f1":"# Handling Missing Values","fa411f31":"# Linear Regression","6e917ec9":"*Charges Outliers are predominantly due to MALE-SOUTHEAST smokers* ","a7db9c9f":"  *More male smokers than female*","5171c9d5":"*Let's go deep into REGION-CHARGES relation*","3ae05c4e":"# Descriptive Statistics","1daa5427":"1. Effect of gender on smoking habits SEX-SMOKER","d68b96ac":"*Male & Female CHARGES vs AGE has similar pattern*","e0a35780":"*Sample statistics is almost equal to population statistics for CHARGES*","0856775f":"*MALE OBESE is significantly higher than FEMALE*","b34dfd8e":"*We have got smokers of age less than 20*","74fc95c4":"*Sample mean is almost equal to actual data mean*","1920f223":"# Data Preprocessing","be09e1cc":"*Maximum insurances are done in 18-19yrs of age*","76df1ec7":"2. Effect of region on Charges: REGION-CHARGES","a32a0f85":"1. Age is uniformly distributed\n\n2. Bmi has few extreme values\n\n3. Charges data is highly skewed","7f5adb32":"*Charges(Senior Adult> Middle Adult> Young Adult> Elder)*\n","5163ee70":"*The higher charges data is pulled CLEARLY by OBESE i.e bmi>30 and they turned out to be smoker too(about>140), which is why they are paying high insurance*","25ad1607":"*In SOUTH EAST region, the young smokers are paying more as compared to other regions*"}}