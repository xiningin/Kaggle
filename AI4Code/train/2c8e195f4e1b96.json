{"cell_type":{"543afcb9":"code","0db45a37":"code","c5d1a032":"code","7d668cac":"code","f4b30a7a":"code","31c56b9d":"code","9f2e3ec8":"code","b88d1fca":"code","e5c1c8a6":"code","20a5c074":"code","4c39039b":"code","a5254728":"code","ccb24c43":"code","d06416a9":"code","4eb0b1a5":"code","9f461227":"code","d262586b":"code","d1105be6":"code","890b50ae":"code","c9705db5":"code","ffddb154":"code","c0fa2f90":"code","72952efc":"code","2495d1f9":"code","0e97f1f7":"code","169fed91":"code","c92890f2":"code","1ec4a188":"code","5df15755":"code","d42f3328":"code","b327d68c":"code","20666373":"code","ae69e0bc":"code","3e395346":"code","f1545b29":"code","cc2467c2":"code","c12ca8b8":"code","4c4aee5c":"code","cc3718c4":"code","5cc6517a":"code","af3a5308":"code","908305ae":"code","d3d87b92":"code","5ec78cc0":"code","edf2bb79":"code","70adb89a":"code","afb9adb4":"code","ee4bfa63":"code","63195387":"code","7f53472c":"markdown","53827206":"markdown","3d4447ed":"markdown","875c293f":"markdown","2faf83d9":"markdown","13449a94":"markdown","2ad1398b":"markdown"},"source":{"543afcb9":"import pandas as pd\nimport numpy as np","0db45a37":"df = pd.read_csv(\"..\/input\/red-wine-quality-cortez-et-al-2009\/winequality-red.csv\")\ndf","c5d1a032":"conditions = [\n    (df['quality'] >=6),\n    (df['quality'] <6)\n]","7d668cac":"values = ['1','0']","f4b30a7a":"df['qualitygood'] = np.select(conditions,values)\ndf","31c56b9d":"import seaborn as sns","9f2e3ec8":"df.isnull()","b88d1fca":"sns.boxplot(data=df, x = 'quality', y = 'fixed acidity') ","e5c1c8a6":"sns.boxplot(data=df, x = 'quality', y = 'volatile acidity')","20a5c074":"sns.boxplot(data=df, x = 'quality', y = 'citric acid') ","4c39039b":"sns.boxplot(data=df, x = 'quality', y = 'residual sugar')","a5254728":"sns.boxplot(data=df, x = 'quality', y = 'chlorides')","ccb24c43":"sns.boxplot(data=df, x = 'quality', y = 'free sulfur dioxide') ","d06416a9":"sns.boxplot(data=df, x = 'quality', y = 'total sulfur dioxide') ","4eb0b1a5":"sns.boxplot(data=df, x = 'quality', y = 'density') ","9f461227":"sns.boxplot(data=df, x = 'quality', y = 'pH') ","d262586b":"sns.boxplot(data=df, x = 'quality', y ='sulphates')","d1105be6":"sns.boxplot(data=df, x = 'quality', y ='alcohol') ","890b50ae":"df.plot.scatter(x='quality', y='alcohol')","c9705db5":"df.plot.scatter(x='quality', y='sulphates')","ffddb154":"df.plot.scatter(x='quality', y='density')","c0fa2f90":"df.plot.scatter(x='quality', y='volatile acidity')","72952efc":"df.plot.scatter(x='quality', y='citric acid')","2495d1f9":"X = df.drop(['quality','qualitygood'], axis = 1)\ny = df.qualitygood","0e97f1f7":"from sklearn.model_selection import train_test_split","169fed91":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.30, random_state=42)","c92890f2":"print(X_train.shape)\nprint(X_test.shape)\nprint(y_train.shape)\nprint(y_test.shape)","1ec4a188":"from sklearn.pipeline import Pipeline\nfrom sklearn.ensemble import RandomForestClassifier\n\nfrom sklearn.preprocessing import MinMaxScaler\nfrom sklearn.preprocessing import StandardScaler\n\nfrom sklearn.metrics import accuracy_score, confusion_matrix, classification_report\nfrom sklearn import metrics","5df15755":"pipe = Pipeline([\n    ('StandScaler', StandardScaler()),\n    ('rf' , RandomForestClassifier(n_estimators=100, max_depth = 4, min_samples_split = 0.1))\n])","d42f3328":"pipe.fit(X_train, y_train)\n\ny_pred = pipe.predict(X_test)","b327d68c":"print(accuracy_score(y_test,y_pred))","20666373":"print(confusion_matrix(y_test,y_pred))","ae69e0bc":"sns.heatmap(confusion_matrix(y_test, y_pred), annot=True, fmt='d', cmap = 'coolwarm')","3e395346":"print(classification_report(y_test, y_pred))","f1545b29":"from sklearn.model_selection import GridSearchCV\nfrom sklearn.model_selection import KFold\nfrom sklearn.feature_selection import SelectKBest, f_regression\nfrom sklearn.linear_model import Lasso","cc2467c2":"kf = KFold(n_splits = 3, shuffle = True)","c12ca8b8":"pipe3 = Pipeline([\n    ('minmaxscaler', StandardScaler()),\n    ('rf' , RandomForestClassifier())\n])","4c4aee5c":"parameters = {#'selectkbest__k':[8, 12],\n              'rf__n_estimators': [200, 300],\n              'rf__max_depth': [12, 15],\n              'rf__min_samples_split' : [0.0005, 0.0001]}","cc3718c4":"gs = GridSearchCV(pipe, \n                  scoring = 'neg_mean_squared_error',\n                  param_grid = parameters, \n                  cv = kf,\n                  verbose = 1,\n                  n_jobs = -1,\n                 )","5cc6517a":"gs.fit(X_train, y_train)","af3a5308":"gs.cv_results_","908305ae":"gs.best_params_","d3d87b92":"y_pred3 = gs.predict(X_test)","5ec78cc0":"print(confusion_matrix(y_test,y_pred3))","edf2bb79":"sns.heatmap(confusion_matrix(y_test, y_pred3), annot=True, fmt='d', cmap = 'coolwarm')","70adb89a":"print(classification_report(y_test, y_pred3))","afb9adb4":"from sklearn.model_selection import KFold\nfrom sklearn.metrics import accuracy_score","ee4bfa63":"from sklearn.model_selection import cross_val_score","63195387":"cross_val_score(RandomForestClassifier(), X, y, cv = KFold(5))","7f53472c":"**Defini\u00e7\u00e3o de X e y**\n\nOptou-se por testar o modelo em 30% da amostra.","53827206":"**Contexto do dataset**\n\nAssim como o famoso 'vinho do porto', Portugal tamb\u00e9m \u00e9 conhecido pela produ\u00e7\u00e3o do 'vinho verde' que \u00e9 cultivado na regi\u00e3o hom\u00f4nima ao noroeste do pa\u00eds entre os rios Douro e Minho. Por constituir dominia\u00e7\u00e3o de origem controlada torna-se \u00fanico ao redor do mundo, apreciado pela leveza e frescor.\n\nO dataset \u00e9 constitu\u00eddo por 1.599 observa\u00e7\u00f5es e suas respectivas classifica\u00e7\u00f5es sensoriais e psicoqu\u00edmicas. Por quest\u00f5es de privacidade nenhum tipo de uva foi discriminada, assim como r\u00f3tulos e pre\u00e7os. Temos dispon\u00edveis 12 vari\u00e1veis distintas, sendo que 11 s\u00e3o caracter\u00edsticas sensoriais\/psicoqu\u00edmicas e 1 com o score final do produto (escala de 0 - 10).\n\nSum\u00e1rio de vari\u00e1veis:\n\n1 - fixed acidity\n\n2 - volatile acidity\n\n3 - citric acid\n\n4 - residual sugar\n\n5 - chlorides\n\n6 - free sulfur dioxide\n\n7 - total sulfur dioxide\n\n8 - density\n\n9 - pH\n\n10 - sulphates\n\n11 - alcohol\n\n12 - quality (score between 0 and 10)\n\nO dataset foi encontrado no reposit\u00f3rio de machine learning da UCI: https:\/\/archive.ics.uci.edu\/ml\/datasets\/wine+quality\n\nCita\u00e7\u00e3o: P. Cortez, A. Cerdeira, F. Almeida, T. Matos and J. Reis. Modeling wine preferences by data mining from physicochemical properties. In Decision Support Systems, Elsevier, 47(4):547-553, 2009.","3d4447ed":"**Treinamento e predi\u00e7\u00e3o com pipeline e GridSearch**\n\nA utiliza\u00e7\u00e3o do GridSearch aumentou a capacidade de classifica\u00e7\u00e3o em quase 10 p.p. de acur\u00e1cia. Abaixo resultados:\n\n**Matriz de Confus\u00e3o:**\n\nVerdadeiro negativo: 165;\nFalso positivo: 48;\nFalso negativo: 46;\nVerdadeiro positivo: 221.\nAcur\u00e1cia: 0.80\n\nPrecis\u00e3o: 0.821\n\nRecal: 0.827\n\nCross validation - 5 Kfolds: array([0.69375 , 0.753125 , 0.7125 , 0.759375 , 0.71159875]","875c293f":"**An\u00e1lise explorat\u00f3ria de dados**\n\nConsidera\u00e7\u00f5es:\n* O dataset n\u00e3o possui nenhum null value;\n* Por outro lado, diversos outliers foram encontrados entre as vari\u00e1veis, principalmente nas vari\u00e1veis 'a\u00e7ucar res\u00eddual' e 'cloreto';\n* 'Acidez fixa': n\u00e3o \u00e9 capaz de predizer a qualidade, uma vez que a varia\u00e7\u00e3o entre diferentes notas foi parecida;\n* 'Acidez vol\u00e1til': indica correla\u00e7\u00e3o entre indicador de acidez e nota. Quanto maior nota menor a acidez;\n* 'Acidez c\u00edtrica': n\u00e3o indica maior ou melhor qualidade, por\u00e9m as notas mais altas (7 e 8) apontam maior equil\u00edbrio entre as distribui\u00e7\u00f5es;\n* 'A\u00e7ucar res\u00eddual': varia\u00e7\u00e3o equilibrada mas com diversos outliers (especialmente com as notas intermedi\u00e1rias como 5 e 6);\n* 'Cloreto': varia\u00e7\u00e3o equilibrada com diversos outliers (especialmente com as notas intermedi\u00e1rias como 5 e 6);\n* 'PH': notas mais altas (acima de 6) apresentaram limites inferiores menores do que as demais notas;\n* 'Sulfato': notas mais altas apresentaram maior \u00edndice de sulfato;\n* '\u00c1lcool': notas mais altas apresentaram maior volume de \u00e1lcool.","2faf83d9":"**Treinamento e predi\u00e7\u00e3o com pipeline**\n\nDentro do pipeline foi utilizado o 'standarscaler' como padroniza\u00e7\u00e3o e o 'RandomForest' como algortimo de classifica\u00e7\u00e3o. Abaixo os resultados:\n\n**Matriz de Confus\u00e3o:**\n\n* Verdadeiro negativo: 155;\n* Falso positivo: 58;\n* Falso negativo: 71;\n* Verdadeiro positivo: 193.\n\nAcur\u00e1cia: 0.725 Precis\u00e3o: 0.768 Recal: 0.731","13449a94":"**Considera\u00e7\u00f5es finais**\n\nConsiderando o cutoff de qualidade como 6 (>=6 \u00e9 considerado como 'bom'), o modelo possui acuracidade de 80% partindo das caracter\u00edsticas qu\u00edmicas e sensoriais. O algoritimo pode servir de par\u00e2metro para a \u00e1rea comercial, estabelecendo um primeiro filtro em rela\u00e7\u00e3o \u00e0 qualidade do vinho.\n\nComo pr\u00f3ximos passos a empresa poderia (partindo da sua pr\u00f3pria base de dados) executar um algoritmo de regress\u00e3o com intu\u00edto de atribuir um score inicial, assim como poss\u00edvel precificia\u00e7\u00e3o. Par\u00e2metros que devem ser refinados posteriormente com a degusta\u00e7\u00e3o dos especialistas e aceita\u00e7\u00e3o do mercado","2ad1398b":"**Problema de neg\u00f3cio**\n\nUma grande importadora de vinhos brasileira compreende que a amplia\u00e7\u00e3o de sua presen\u00e7a no mercado passa pelo aumento do portif\u00f3lio de produtos. Tal constata\u00e7\u00e3o parte do crescimento da sua maior concorrente (evino.com), que al\u00e9m de ter sido concebida em ambiente digital, possui grande capacidade de negocia\u00e7\u00e3o e amplo mix de produtos\/vin\u00edculas.\n\nCom intu\u00edto de ampliar e buscar diferencia\u00e7\u00e3o, a importadora se compromete a visitar e negociar com novos produtores. A partir do momento em que come\u00e7a a prospec\u00e7\u00e3o acaba por ter acesso a um universo muito grande de r\u00f3tulos. Considerando o momento de pandemia, que impossibilita a visita\u00e7\u00e3o, e a necessidade imediata, opta por estabelecer uma rela\u00e7\u00e3o com os vinhos que j\u00e1 fazem parte da sua carta considerando suas caracter\u00edsticas qu\u00edmicas e sensoriais.\n\nO objetivo \u00e9 encontrar uma rela\u00e7\u00e3o entre os componentes dos vinhos e suas respectivas notas, habilitando o comprador da importadora a ter uma pr\u00e9-sele\u00e7\u00e3o com base no score atribu\u00eddo.\n\nEntende-se como 'bom' vinho um score igual ou maior do que 6."}}