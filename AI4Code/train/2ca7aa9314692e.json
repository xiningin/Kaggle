{"cell_type":{"9c2316af":"code","960c272d":"code","5797dbdc":"code","81f8b673":"code","a8cbead3":"code","9b73ab4a":"code","55649a90":"code","e63d6152":"code","58904bc4":"code","4df383a2":"code","c53b630c":"code","2e71d897":"code","75adf398":"code","49f04eee":"code","e7fda957":"code","8be412c3":"code","2454c865":"code","9f5f053c":"code","37d7699d":"code","a50b5662":"code","c6618616":"code","a779fc6a":"code","0514f584":"code","d50b03ca":"code","81f0b6cd":"code","939425e8":"code","19efbb6f":"markdown","418afaef":"markdown","ee782e7d":"markdown","cd128173":"markdown","5de7ecb1":"markdown","2cea858b":"markdown"},"source":{"9c2316af":"#install library\n!pip install openpyxl","960c272d":"#import library\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.model_selection import train_test_split\nfrom sklearn import metrics\nimport statsmodels.api as sm\nimport openpyxl","5797dbdc":"acc = pd.read_excel('..\/input\/social-media-platform-with-most-subscribers\/MostSubscribers.xlsx')","81f8b673":"acc.shape","a8cbead3":"acc.head()","9b73ab4a":"#transform target\nacc['Subscribers(millions)'] = acc['Subscribers(millions)'].astype(int)\nacc.head()","55649a90":"acc.describe()","e63d6152":"acc.info()","58904bc4":"#heatmap correlation\nplt.figure(figsize = (12,9))\nsns.heatmap(acc.corr(), annot = True, cmap = 'OrRd')\nplt.title(\"Pearson Correlation\")\nplt.show()","4df383a2":"#handling categorical data\ndf = pd.get_dummies(acc, drop_first = True)\ndf.head()","c53b630c":"#split data\nX = df.drop('Subscribers(millions)', axis = 1)\ny = df['Subscribers(millions)']\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.3, random_state = 0)\nprint(X_train.shape)\nprint(y_train.shape)\nprint(X_test.shape)\nprint(y_test.shape)","2e71d897":"#linear regression model\nlr = LinearRegression()\n%time lr.fit(X_train, y_train)","75adf398":"#prediction\ny_pred = lr.predict(X_test)\nprint(y_pred)","49f04eee":"#result\nprediction = pd.DataFrame({'Actual' : y_test, 'Predicted' : y_pred})\nprediction.head()","e7fda957":"#check MAE\nprint('Mean Absolute Error : ', metrics.mean_absolute_error(y_test, y_pred).round(2))","8be412c3":"#check MSE\nprint('Mean Squared Error : ', metrics.mean_squared_error(y_test, y_pred).round(2))","2454c865":"#check RMSE\nprint('Root Mean Squared Error : ', np.sqrt(metrics.mean_absolute_error(y_test, y_pred).round(2)))","9f5f053c":"#check R squared\nprint('R Squared : ', metrics.r2_score(y_test, y_pred))","37d7699d":"#visualize model\nx = y_test\ny = y_pred\n\nplt.figure(figsize = (10,6))\nplt.title(\"Linear Regression Plot Model\")\nplt.plot(x, y, 'o')\n\nm, b = np.polyfit(x, y, 1)\nplt.plot(x, m * x + b)","a50b5662":"#distribution\nplt.figure(figsize = (10,6))\nsns.distplot(df['Subscribers(millions)'])\nplt.title(\"Distribution of Subscriber\")\nplt.show()","c6618616":"#defining feature\ncoef = pd.Series(lr.coef_, index = X.columns)\n\nimp_coef = pd.concat([coef.sort_values().head(10),\n                     coef.sort_values().tail(10)])","a779fc6a":"#visualize feature\nplt.figure(figsize = (10,6))\nimp_coef.plot(kind = 'barh')\nplt.title(\"Feature Importance\")\nplt.xlabel('Score')\nplt.ylabel('Features')\nplt.show()","0514f584":"plt.figure(figsize = (10,6))\nchart = sns.countplot(data = acc, x = 'Country', palette = 'Set1')\nchart.set_xticklabels(chart.get_xticklabels(), rotation = 45)\nplt.title(\"Country\")\nplt.show()","d50b03ca":"plt.figure(figsize = (10,6))\nchart = sns.countplot(data = acc, x = 'Language', palette = 'Set1')\nchart.set_xticklabels(chart.get_xticklabels(), rotation = 45)\nplt.title(\"Language\")\nplt.show()","81f0b6cd":"plt.figure(figsize = (10,6))\nchart = sns.countplot(data = acc, x = 'Category', palette = 'Set1')\nchart.set_xticklabels(chart.get_xticklabels(), rotation = 45)\nplt.title(\"Category\")\nplt.show()","939425e8":"lr = LinearRegression()\nlr.fit(X_train, y_train)\nmodel = sm.OLS(lr.predict(X_train), X_train)\nprint(model.fit().summary())","19efbb6f":"## Data Extraction","418afaef":"# Social Media Prediction","ee782e7d":"## Visualization","cd128173":"## Check Feature Importance","5de7ecb1":"## Summary of Linear Regression Model","2cea858b":"## Linear Regression Model"}}