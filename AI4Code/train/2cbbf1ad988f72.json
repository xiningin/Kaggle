{"cell_type":{"4dd2193c":"code","5b48cc01":"code","ab94925e":"code","3bf1c9d8":"code","6de923cc":"code","c5de2077":"code","0ce6a506":"code","c08c22c7":"code","f7a6c40e":"code","d03d426b":"code","c1b4dc1e":"code","bc5cf6fa":"code","aa23c32b":"markdown","25a98765":"markdown"},"source":{"4dd2193c":"!pip install git+https:\/\/github.com\/AutoViML\/Auto_TS.git","5b48cc01":"import numpy as np\nimport pandas as pd","ab94925e":"## You need to restart the kernel after installing auto-ts ##\nfrom auto_ts import auto_timeseries","3bf1c9d8":"train = pd.read_csv('..\/input\/train.csv' ,parse_dates=['date'], index_col='date')\ntest = pd.read_csv('..\/input\/test.csv', parse_dates=['date'],index_col='date').drop('id', axis=1)\nsample = pd.read_csv('..\/input\/sample_submission.csv')\nprint(train.shape)\ntrain.head()","6de923cc":"train = train[:]","c5de2077":"model = auto_timeseries(score_type='rmse',forecast_period=10,\n                time_interval='D',\n                non_seasonal_pdq=None, seasonality=False, seasonal_period=1,\n                model_type=['ML'],dask_xgboost_flag=False, num_boost_rounds=1000,\n                verbose=2)","0ce6a506":"ts_column = 'date'\ntarget = 'sales'","c08c22c7":"model.fit(train, ts_column,target)","f7a6c40e":"predictions = model.predict( testdata = test, model = 'ML' )\npredictions","d03d426b":"sample['sales'] = predictions['sales'].values","c1b4dc1e":"sample.head()","bc5cf6fa":"sample.to_csv('submission.csv',index=False)","aa23c32b":"import pdb\nresults = []\ntr_start,tr_end = '2015-01-01','2017-09-30'\nte_start,te_end = '2017-10-01','2017-12-31'\ntarget = 'sales'\nts_column = 'date'\nfor i in range(1,51):\n    for s in range(1,11):\n        buf = df[(df.item==i)&(df.store==s)].copy()\n        #train_test_split\n        tra = buf['sales'][tr_start:tr_end]#.dropna()\n        tes = buf['sales'][te_start:te_end]#.dropna()\n        \n        tra = tra.reset_index()\n        tes = tes.reset_index()\n        #fitting\n        mod = auto_timeseries(score_type='rmse',\n                time_interval='D',\n                non_seasonal_pdq=None, seasonality=False, \n                              seasonal_period=7,\n                model_type=['ML'],\n                verbose=0)\n        \n        mod.fit(tra, ts_column, target, cv=0)\n        \n        pred = mod.predict(tes)\n        \n        results.extend(pred['yhat'])\n        print('item:',i,'store:',s,'Finished.')","25a98765":"# We are going to use this excellent notebook as a starting point\nhttps:\/\/www.kaggle.com\/poiupoiu\/how-to-use-sarimax\nMany Thanks to YUUT!!"}}