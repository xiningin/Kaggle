{"cell_type":{"0a38f026":"code","3dc1a768":"code","ad4c47e2":"code","dee27b9a":"code","3c2ed992":"code","6b0e2697":"code","43009fd0":"code","cb6acf73":"code","883cf770":"code","131984d2":"code","1599bf55":"code","365fabde":"code","888f28bc":"code","b1896a30":"code","4e99e398":"code","ba6e34ce":"code","649533a4":"markdown","aaf6568c":"markdown","6f8f1999":"markdown","a89697b3":"markdown","e27a8ef0":"markdown","10b76d2e":"markdown","c08d6df1":"markdown","ef8035ec":"markdown","066a1e28":"markdown","626eae2e":"markdown","7c8ae7a2":"markdown","8ca62501":"markdown","1157b361":"markdown","8556db2d":"markdown","ded6e971":"markdown","d2a74ed2":"markdown"},"source":{"0a38f026":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\npd.set_option(\"display.max_rows\",8)\nfrom plotnine import *\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","3dc1a768":"#read data\nPATH = \"\/kaggle\/input\/fifa-world-cup\/\"\n\nplayers = pd.read_csv(PATH+\"WorldCupPlayers.csv\")\ncups = pd.read_csv(PATH+\"WorldCups.csv\")\nmatches = pd.read_csv(PATH+\"WorldCupMatches.csv\").dropna()","ad4c47e2":"cups.head()","dee27b9a":"#ggplot(dataframe) is creating the graph objectm and geom_line() is a line plot layer.\n# note: when we use columns from the dataframe, we must put them inside the aesthetics (aes=()...)\np = ggplot(cups) + geom_line(aes(x=\"Year\", y=\"GoalsScored\")) \n#show the object. When using Pycharm, print it.\np","3c2ed992":"# Nice trick: if you wrap your ggplot object with round brackets, you can drop down to a new row.\n# This way, you can make your code more readable and add comments\n\n#add labels\np = (p + labs(title = \"Fifa World Cup Goals Scored per Year\",x=\"Tournament Year\", y='Goals Scored') + \n    #add more xticks\n    scale_x_continuous(breaks = range(1930,2014,8)) + \n    #add theme.\n    theme_bw())\n\n# you can use draw() function and add ; if you want avoid the <ggplot...> object tag.\np.draw();","6b0e2697":"#create our barplot and plot it\n(ggplot(cups) + geom_bar(aes(x=\"Winner\"))).draw();","43009fd0":"#create a sorted list of national teams, by number of wins\nsorted_champions = cups['Winner'].value_counts().index.tolist()\n\nprint(\"Sorted list by winnings:\\n\",sorted_champions)\n\n#create the plot object\n(ggplot(cups)    \n     #add bars colored by values\n    + geom_bar(aes(x='Winner', fill='Winner')) \n     #sort by sorted list of values\n    + scale_x_discrete(limits=sorted_champions) \n     #add xticks angle\n    + theme(axis_text_x = element_text(angle = 45)) \n     #add title and axis labels\n    + labs(title=\"World Cup Wins\", x='National Team',y='Titles')).draw();","cb6acf73":"(ggplot(cups)    \n     #add bars colored by values\n    + geom_bar(aes(x='Winner', fill='blue')));","883cf770":"(ggplot(cups)    \n     # add bars colored by plain color\n    + geom_bar(aes(x='Winner'), fill='orangered')\n     # add angle to xticks\n    + theme(axis_text_x = element_text(angle = 45))\n     # add titles\n    + labs(title=\"World Cup Wins\", x='National Team',y='Titles')).draw();","131984d2":"(ggplot(cups)    \n     # add winners bars colored in red, width smaller width\n    + geom_bar(aes(x='Winner'), fill='orangered', width=.3)\n     # add runner up thin bars colored in blue, nuged to the right\n    + geom_bar(aes(x=\"Runners-Up\"), fill='lightblue', position = position_nudge(x = 0.3), width=.3)\n     # rotate xticks\n     + theme(axis_text_x = element_text(angle = 45))\n     # add title\n    + labs(title=\"World Cup Wins\", x='National Team',y='Titles')).draw();\n","1599bf55":"cups[['Winner','Runners-Up']].melt()","365fabde":"#create ggplot object over melted data\n(ggplot(cups[['Winner','Runners-Up']].melt()) + \n     # add bars, color splitted by variable (winner or runner up)\n     # position = 'dodge' is for side-by-side bars. for stacked bars use position=\"stack\"\n     geom_bar(aes(x='value', fill='variable'),position = \"dodge\", width=0.9)\n     # rotate xticks and  set figure size\n     + theme(axis_text_x = element_text(angle = 45), figure_size=[10,4])\n     # add title\n    + labs(title=\"World Cup Wins\", x='National Team',y='Titles')\n     # change legend title and set new legend labels\n    + scale_fill_discrete(name = \"Final Place\", labels=[\"2nd Place\",\"1st Place\"])).draw();","888f28bc":"matches.head()\n","b1896a30":"#create ggplot object for matches data\n(ggplot(matches) \n     # add boxplots. We need to use the Year.astype() since year is a float\n     + geom_boxplot(aes(x='Year.astype(\"str\")', y='Attendance'))\n     # rotate xticks and  set figure size\n     + theme(axis_text_x = element_text(angle = 45), figure_size=[8,4])\n     # add title\n    + labs(title=\"World Cups Attendance by Year\", x='Year')\n     # change legend title and set new legend labels\n    ).draw();","4e99e398":"matches['Total Goals'] = matches['Home Team Goals'] + matches['Away Team Goals']\n\np3 = (ggplot(matches) + geom_boxplot(aes(y=\"Total Goals\", x='Year.astype(str)', fill='Year'))\n      + theme(axis_text_x = element_text(angle = 90), figure_size=[8,4])\n     # add title\n    + labs(title=\"World Cups Goals by Year\", x='Year'))\n     # change legend title and set new legend labels\n\np3.draw();","ba6e34ce":"matches.Stage[matches['Stage'].str.contains(\"Group\")] = \"Group Stage\"\nmatches.Stage[~matches['Stage'].str.contains(\"Group\")] = \"Knockout\"\n\np3 + facet_wrap(\"~Stage\")","649533a4":"### Matches Dataframe\n\nLet's take a look on another dataframe we have, the matches.","aaf6568c":"The second method is a very nice trick that can help you create very easy plots with legend in few lines of code.\nWe will use the `melt` function from `pandas` library, to meltdown the data we want to visualize, and then use aes colors to seperate it.\n\nAfter using `melt`, our data should look like this:","6f8f1999":"Now, we can use the same methods we have already seen to draw this plot. Notice that we can easily split our columns by using the `variable` column to fill our bars with the right color.","a89697b3":"# World Cup Data\n\nAs a first step, We want to have a quick peek on the WC data. This is a data about all the FIFA World Cups in history, since the first one in 1930 up to 2014.\n","e27a8ef0":"**Note:** When using \"color\" attribute inside the aesthetics (aes() function), you must use a feature name in your data. For example, the following code will raise an error:","10b76d2e":"You can read more about ggplot themes here:<br>\nhttps:\/\/plotnine.readthedocs.io\/en\/stable\/generated\/plotnine.themes.theme.html\n\nNow, let say we want to create a bar plot, that present the number of cups each national team won (among the teams that won at least one time). \nYou have guessed it right! We can use the \"geom_bar\" function.","c08d6df1":"At the beginning of this notebook, we counted the goals scored on each tournament.\nNow, we can create a more sofisticated plot of this feature, using boxplot over the matches of each year.","ef8035ec":"Now, what if we want to add the winners graph the runner up national teams?\n\nThe first method (and for my opinion the less elegant way) is just \"moving\" the bars a bit and make some space for new bars.","066a1e28":"Again, we will want to spruce up our figure a little bit, and make it more readable.\n1. Order the bars\n2. Give the xticks an angle for better readability\n3. Add colors\n4. Add title, labels, etc.","626eae2e":"### World Cups Dataframe\n\nWe can use pandas head() function to see the top five rows of our data:","7c8ae7a2":"So, here we have quite simple dataframe, with 10 features. As a starter, let's try to plot the number of goals scored on each world cup.","8ca62501":"If you are using R, there is a very good chance that you are using the almighty [ggplot2](https:\/\/ggplot2.tidyverse.org\/index.html) package for your data visualization. As a big fan of ggplot, it was a very nice surprise for me to find out the [plotnine](https:\/\/plotnine.readthedocs.io\/en\/stable\/) library for Python 3.\n\nPlotnine is a great library that has a very intuitive syntax, and can help you to create easy and elegant visualizations in python. The main problem is that most of the information online is written in R, and some of the Python programmers might struggle with the syntax. \n\nIn this notebook, I want to present to you how simple and easy can plotnine be, and add some tricks that will be helpful for you while creating knit and elegant graphs.","1157b361":"Great! our very first plotnine figure! Now, we might want to make it a bit more attractive.\nLet's add title,fix the axis labels, and add more xticks. Note that different objects from the library can be added to the graph object.","8556db2d":"So, the right way to color your geometric layer with a solid color, is doing it outside of the aes() function.","ded6e971":"We can also split this figure using the `facet_wrap` function.\n\nYou can read more about facets here:\nhttps:\/\/plotnine.readthedocs.io\/en\/stable\/generated\/plotnine.facets.facet_wrap.html","d2a74ed2":"Now, we want to draw a boxplot of the match attendance per World Cup tournament.\nTo do so we can use the `geom_boxplot`."}}