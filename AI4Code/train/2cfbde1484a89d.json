{"cell_type":{"2dd654e0":"code","2bebce43":"code","d8ae1e0a":"code","fdd30309":"code","23f5f6a7":"code","dcfd4202":"markdown","62c8e39b":"markdown","d3ac026a":"markdown","bc288554":"markdown","eeeaf15b":"markdown","7c0b5a59":"markdown"},"source":{"2dd654e0":"import pandas as pd\nfrom scipy.io import loadmat \nfrom pathlib import Path\n\ndatapath = Path('..\/input\/')","2bebce43":"MAT = loadmat(datapath\/'cars_annos.mat')\n\nprint(\"Annotations\")\nprint(MAT[\"annotations\"][0,:5])\nprint(\"Class Names\")\nprint(MAT[\"class_names\"][0][:5])","d8ae1e0a":"def get_labels():\n    MAT = loadmat(datapath\/'cars_annos.mat')\n    annotations = MAT[\"annotations\"][0,:]\n    nclasses = len(MAT[\"class_names\"][0])\n    class_names = dict(zip(range(1,nclasses),[c[0] for c in MAT[\"class_names\"][0]]))\n    \n    labelled_images = {}\n    dataset = []\n    for arr in annotations:\n        # the first entry in the row is the image name\n        # The rest is the data, first bbox, then classid then a boolean for whether in train or test set\n        dataset.append([arr[0][0].replace('car_ims\/','')] + [y[0][0] for y in arr][1:])\n    # Convert to a DataFrame, and specify the column names\n    DF = pd.DataFrame(dataset, \n                      columns =['filename',\"BBOX_Y2\",\"BBOX_X1\",\"BBOX_Y1\",\"BBOX_X2\",\"ClassID\",\"TestSet\"])\n\n    DF = DF.assign(ClassName=DF.ClassID.map(dict(class_names)))\n    return DF\n\nDF = get_labels()\nDF.head()","fdd30309":"from pylab import imread,subplot,imshow,show\nimport matplotlib.pyplot as plt\n\nimage = imread(datapath\/'cars_train\/cars_train\/00001.jpg')  \nplt.imshow(image)","23f5f6a7":"image = imread(datapath\/'cars_test\/cars_test\/00001.jpg')  #\/\/ choose image location\n\nplt.imshow(image)","dcfd4202":"# Inaccurate Labels in Kaggle Stanford Cars Data Set?\nThis notebook documents apparent problems in the labels of the data set at https:\/\/www.kaggle.com\/jessicali9530\/stanford-cars-dataset\/version\/2","62c8e39b":"According to this table, the class ID for image 000001.jpg is 1 which should be a Hummer.\nLets take a look at the Test set 00001.jpg file and can see its actually an Audi sedan.","d3ac026a":"It may be possible that I am misinterpreting the data format, or that there is something else going on here.  In any case, be warned before you try to use this data set that it is either corrupt, or not easy to parse correctly.  :-)  If you know what the trick is, let me know!","bc288554":"The get_labels functions creates a dataframe with the filnames and meta-data for easier interpretation.","eeeaf15b":"Juat in case, also checking in the test data set, which is also not a hummer.\n","7c0b5a59":"\nThe data comes in as a .mat file from matlab, and the structure is not well documented.  My interpretation is that the first column in annotations appears to be the file name.  The next 4 columns represent the car bbox, while the 6th column apparently represents the car class index.  The 7th column apparently represents whether the file is in the train or test data set.\n"}}