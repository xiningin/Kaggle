{"cell_type":{"87c06c85":"code","de6c95b6":"code","c0dbe2d8":"code","da5fc13d":"code","8817aa71":"code","80dddcd3":"code","abc29dfb":"code","6e0df7d1":"code","5e64303f":"code","de66b711":"code","635461a4":"code","7b6f37a6":"code","864ea2bd":"code","66a3e1be":"code","ad684d87":"code","158cbb6e":"code","7431c82c":"code","203380be":"code","7a77d6ba":"code","13f3898b":"code","ef41104f":"code","9dd4b5f1":"code","fcf75662":"code","50319ce0":"code","df053326":"code","7f855e3b":"code","40aed21e":"code","e56df28e":"code","fce466b9":"code","ca2d5409":"code","07c053b2":"code","ca7edaa8":"code","5df0e2b8":"code","ddd5e93f":"code","b6fa246f":"code","e2e36fc7":"code","4e2f6bfa":"code","cec06b3a":"code","c42be00c":"code","f9410fa1":"markdown","faaa92c5":"markdown","e7819fd8":"markdown","19372a02":"markdown","3be8c3fb":"markdown","b6e6c63d":"markdown","ff351e5f":"markdown","97e7657c":"markdown","6e26a2b7":"markdown","45d085c1":"markdown","c21d29d0":"markdown","2265d46b":"markdown","a2697765":"markdown","ad46767e":"markdown","37747302":"markdown","7d585123":"markdown","1adf1109":"markdown","bb47e9d1":"markdown","0e977ab6":"markdown","327b5d7d":"markdown","7b38c280":"markdown","a53dd1c1":"markdown","596070bf":"markdown","231020c7":"markdown","8f37cd12":"markdown","bcf563b7":"markdown","e5bf4f85":"markdown","89ad7e4d":"markdown","406b82c6":"markdown","1612c5ab":"markdown","34f5cf63":"markdown","66659bbc":"markdown","e998ceb5":"markdown","50aad30a":"markdown","15741721":"markdown","32603e91":"markdown","3c340a6b":"markdown","f5faf4dd":"markdown","4cbd0aa5":"markdown","ed80a2e5":"markdown"},"source":{"87c06c85":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","de6c95b6":"df = pd.read_csv('\/kaggle\/input\/profiles-dating-app\/profiles.csv')\ndf.info()","c0dbe2d8":"print(df['sign'].value_counts())","da5fc13d":"sns.histplot(data=df, x='age', stat='count')\nplt.axvline(x=df.age.mean(), color='red')","8817aa71":"sns.histplot(data=df, x='age', stat='count', hue='sex')","80dddcd3":"sns.histplot(data=df, x='height', hue='sex')","abc29dfb":"sns.histplot(data=df, x='income', hue='sex')","6e0df7d1":"sns.countplot(data=df, y='sex')","5e64303f":"sns.countplot(data=df, y='body_type')","de66b711":"sns.countplot(data=df, y='body_type', hue='sex')","635461a4":"sns.countplot(data=df, y='diet')","7b6f37a6":"sns.countplot(data=df, y='drinks')","864ea2bd":"sns.countplot(data=df, y='drugs')","66a3e1be":"sns.countplot(data=df, y='education')","ad684d87":"print(df['ethnicity'].value_counts())","158cbb6e":"sns.countplot(data=df, y='job')","7431c82c":"sns.countplot(data=df, y='offspring')","203380be":"sns.countplot(data=df, y='orientation')","7a77d6ba":"sns.countplot(data=df, y='orientation', hue='sex')","13f3898b":"sns.countplot(data=df, y='pets')","ef41104f":"df['newReligion'] = df['religion'].str.split().str.get(0)\nsns.countplot(data=df, y='newReligion')","9dd4b5f1":"sns.countplot(data=df, y='smokes')","fcf75662":"df['newSign'] = df['sign'].str.split().str.get(0)","50319ce0":"sns.countplot(data=df, y='newSign')","df053326":"sns.countplot(data=df, y='status')","7f855e3b":"df.info()","40aed21e":"print(df.isnull().sum())","e56df28e":"ft = ['body_type', 'diet', 'job', 'offspring', 'orientation', 'sex', 'newReligion', 'newSign']\ndf = df[ft].dropna()\ndf.shape","fce466b9":"for col in ft[:-1]:\n    df = pd.get_dummies(df, columns = [col], prefix = [col])","ca2d5409":"df.head()","07c053b2":"df.newSign.value_counts()","ca7edaa8":"col_len = len(df.columns)\n\n# X adalah train dan Y adalah validasi\nX = df.iloc[:, 1:col_len]\nY = df.iloc[:, 0:1]\n\nfrom sklearn.model_selection import train_test_split\nX_train, X_val, Y_train, Y_val = train_test_split(X, Y, test_size = 0.3, random_state = 0)\n\n#turn into 1d array\nY_train = Y_train.to_numpy().ravel()\nY_val = Y_val.to_numpy().ravel()","5df0e2b8":"from sklearn.linear_model import LogisticRegression\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.neighbors import KNeighborsClassifier","ddd5e93f":"lr_model = LogisticRegression(solver='liblinear').fit(X_train, Y_train)\nlr_predict = lr_model.predict(X_train)","b6fa246f":"from sklearn.metrics import classification_report\nprint(classification_report(Y_train, lr_predict))","e2e36fc7":"dt_model = DecisionTreeClassifier()\ndt_model.fit(X_train, Y_train)\ndt_predict = dt_model.predict(X_train)","4e2f6bfa":"print(classification_report(Y_train, dt_predict))","cec06b3a":"knn_model = KNeighborsClassifier(n_neighbors = 12)\nknn_model.fit(X_train, Y_train)\nknn_predict = knn_model.predict(X_train)","c42be00c":"print(classification_report(Y_train, dt_predict))","f9410fa1":"#### Drugs\nSebagian besar dari pengguna OKCupid tidak pernah mengkonsumsi narkoba, tapi ada ~8000 pengguna yang kadang mengkonsumsi itu dan ada juga beberapa yang sering mengkonsumsi narkoba.","faaa92c5":"Final akurasi dari Decision Tree adalah 85%. Itu adalah hasil yang sangat bagus untuk sebuah model machine learning, dan ini sangat jauh berbeda dengan akurasi dari Logistic Regression.","e7819fd8":"Sesuai dengan grafik dibawah, bisa kita lihat bahwa sebagian besar dari pengguna tidak memasukkan income mereka.","19372a02":"#### Status\nSudah kita bisa ketahui bersama bahwa semua pengguna OKCupid pastinya single.","3be8c3fb":"#### Logistic Regression\n\nModel pertama adalah menggunakan Logistic Reression dengan multinomial class.","b6e6c63d":"#### Job\nDari grafik dibawah terlihat bahwa ada ~5500 siswa yang memilik akun OKCupid dan ada 250 pengguna yang sudah pensiun.","ff351e5f":"#### Label Imbalance\nKetidakseimbangan prediksi label harus dicek. Ini penting sejak masalah multi-class dimana 2 atau lebih outcomes bisa dimiliki. Ketidakseimbangan itu nggak bagus karena itu berarti ada label yang hanya terjadi beberapa kali. Dan ini bisa menjadi masalah untuk algoritma machine learning jika data tidak cukup untuk dilatih dan akan menghasilkan prediksi yang jelek.\n\nTapi untungnya jumlah data dari semua sodiak tidak terlalu jauh perbedaannya. Karenanya kita tidak perlu terlalu khawatir tentang masalah imbalance ini.","97e7657c":"#### Offspring\nGrafik menunjukkan bahwa sebagian besar pengguna tidak memiliki anak.","6e26a2b7":"#### Smokes\nSebagian besar pengguna tidak merokok dan ada sekitar 10,538 pengguna yang merokok.","45d085c1":"#### Orientation\nDari garfik dibawah terlihat ada 2767 pengguna yang memiliki orientasi bisexual dan ada 5573 pengguna yang gay.\n","c21d29d0":"# Explore the data","2265d46b":"#### Education\nKebanyakan pengguna OKCupid lulus dari universitas dan ada sekitar ~9000 pengguna yang telah menyelesaikan master programnya.","a2697765":"Bersihkan sign column, dengan mengambil kata pertamanya saja, karena hanya ada 12 horoscope. ","ad46767e":"#### Preprocessing\n\nMemproses data sangat penting untuk modeling machine learning, agar model kita bisa berjalan lebih cepat dan menghasilkan prediksi yang baik.\n\nJadi kita akan hanya memilih beberapa feature yang mungkin bagus untuk menjadi predictor untuk tanda horoskop.","37747302":"#### Decision Tree","7d585123":"#### Ethnicity","1adf1109":"#### Income","bb47e9d1":"#### Pets\nDari grafik dibawah terlihat sebagian besar pengguna menyukai anjing dan kucing.","0e977ab6":"Dibawah menggunakan chart yang sama, tapi dengan pembagian sesuai gender, bisa dilihat kedua gender memiliki proporsi yang sama dari umur, tapi overall perempuan lebih sedikit.","327b5d7d":"Final akurasi dari KNN adalah 85% yang mana itu sama dengan hasil akurasi dari Decision Tree.","7b38c280":"#### Height\nDibawah adalah distribusi dari kolom height sesuai dengan jenis kelamin, terlihat jelas bahwa perempuan terlihat lebih pendek dari pada laki-laki.","a53dd1c1":"#### Religion\nSebagian besar pengguna OKCupid memiliki keyakinan Agnosticism, lalu diurutan kedua memiliki keyakinan Atheism.","596070bf":"## Prediction\n\n#### Model Building\n\nSekarang saatnya kita membuat model. Untuk projekt ini digunakan tiga algoritma untuk membuat model, yaitu Logistic Regression, Decision Tree dan KNN.","231020c7":"terlihat bahwa kebanyakan bisexual adalah perempuan.","8f37cd12":"#### Body Type\nGrafik Body type kolom dibawah menunjukkan, kebanyakan pengguna mendeskripsikan dirinya sebagai average, athletic atau fit.","bcf563b7":"## Discrete Variables","e5bf4f85":"#### Dummy Variable\n\nDummy Variable dibuat untuk menghandle categorical variable, jadi dummy variable akan mengubah kategori per variable ke binary identifier-nya sendiri. ","89ad7e4d":"Final akurasi dari Logistic Regression adalah 13% yang mana itu termasuk buruk.","406b82c6":"Grafik dibawah menunjukkan Body Type kolom berdasarkan jenis kelamin. Terlihat jelas bahwa kebanyakan yang menrepresentasikan dirinya athletic adalah laki-laki dan yang menrepresentasikan dirinya curvy adalah kebanyakan perempuan.","1612c5ab":"#### Diet\n\nDari grafik dibawah bisa dilihat bahwa diet type dari pengguna OKCupid adalah memakan semua jenis makanan, tapi itu dibagi tiga, yaitu strictly anything, mostly anything dan anything. Menjadi Open-Minded adalah signal yang populer untuk mendapatkan pasangan.","34f5cf63":"# Continous Variable\n\nKita akan melihat distribusi dari continous variable menggunakan grafik, di dataset ini ada 3 continous variable :\n\n1. Age\n2. Height\n3. Income","66659bbc":"#### K-Nearest Neighbors","e998ceb5":"Yang pertama kita harus explore adalah kolom sign, dari hasil print dibawah kita bisa lihat ada 48 macam horoscope, tapi sebenarnya hanya ada 12 saja. Selain itu kita akan drop row yang memiliki nan value di kolom sign.","50aad30a":"#### Age\nPlot dibawah menunjukkan distribusi dari kolom age, terlihat bahwa sebagian besar umur dari pengguna OKCupid berada pada rentang 20 - 35 tahun. Garis merah dibawah menunjukkan rata-rata umur dari pengguna adalah 32 tahun.","15741721":"#### Sign","32603e91":"#### Sex\nPengguna OKCupid kebanyakan adalah laki-laki dengan jumlah ~36000, sedangkan perempuan ~23000","3c340a6b":"#### Drinks\nDari grafik dibawah terlihat sebagian besar pengguna OKCupid mengkonsumsi alkohol secara socially","f5faf4dd":"#### Splitting Data\nSelanjutnya data harus dipisah menjadi train dan validation set. Disini kita menggunakan 30% data untuk validation dan 70% sisanya digunakan untuk train set.","4cbd0aa5":"## Data Preperation\n\n#### Missing Data\n\nMissing data tidak bisa di handle oleh Machine Learning, makanya sebelum kita memproses data kita harus mempersiapkannya terlebih dahulu,salah satu langkahnya adalah menangani Missing Data.","ed80a2e5":"Distribusi data dari tanda horoscope terlihat tidak terlalu extreme perbedaanya, dengan leo yang paling terbanyak dan capricorn yang paling sedikit."}}