{"cell_type":{"5f5f3595":"code","b679f1b5":"code","ae8fcc2a":"code","f3b5a193":"code","f031e67f":"code","3a64a2dc":"code","f398a9cc":"code","d2c65444":"code","1d56b817":"code","8c000f77":"code","1081f435":"code","76799ec0":"code","1701a620":"code","1c0c1800":"code","af2c7251":"code","a591243f":"code","58cfcbed":"code","6e499678":"markdown","966452ab":"markdown"},"source":{"5f5f3595":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","b679f1b5":"import numpy as np \nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.linear_model import SGDClassifier\nfrom sklearn.datasets import fetch_openml\nfrom sklearn.metrics import f1_score,recall_score,precision_score,accuracy_score,confusion_matrix,roc_curve\nfrom sklearn.model_selection import train_test_split,StratifiedKFold,cross_val_score\nfrom sklearn.multiclass import OneVsOneClassifier,OneVsRestClassifier\nfrom sklearn.neighbors import  KNeighborsClassifier\nfrom sklearn.svm import SVC","ae8fcc2a":"# df=pd.read_csv('\/content\/drive\/MyDrive\/drug200.csv')\ndf=pd.read_csv('\/kaggle\/input\/drug-classification\/drug200.csv')\n# print(set(df['Drug']))\n# df.head()\n","f3b5a193":"drugs_type_binary=[]\nfor drug in df['Drug']:\n  if drug==\"drugA\":\n    drugs_type_binary.append(0)\n  elif drug==\"drugB\":\n    drugs_type_binary.append(1)\n  elif drug==\"drugC\":\n    drugs_type_binary.append(2)\n  elif drug==\"drugX\":\n    drugs_type_binary.append(3)\n  else:\n    drugs_type_binary.append(4)\ndrugs=np.array(drugs_type_binary)\ndf['drugs']=drugs","f031e67f":"choll=[]\nfor chol in df['Cholesterol']:\n  if chol=='HIGH':\n    choll.append(2)\n  elif chol=='LOW':\n    choll.append(0)\n  else:\n    choll.append(1)\ndf[\"cholesterol\"]=np.array(choll)","3a64a2dc":"bp=[]\nfor x in df['BP']:\n  if x=='HIGH':\n    bp.append(2)\n  elif x=='LOW':\n    bp.append(0)\n  else:\n    bp.append(1)\ndf['bp']=np.array(bp)","f398a9cc":"sex=[]\nfor i in df['Sex']:\n  if i=='M':\n    sex.append(1)\n  else:\n    sex.append(0)\ndf['sex']=np.array(sex)","d2c65444":"xtrain,xvalid,ytrain,yvalid=train_test_split(np.c_[df['Na_to_K'],\n                                                   df['bp']],np.array(df['drugs']),test_size=0.2)","1d56b817":"model=OneVsOneClassifier(KNeighborsClassifier())\n# model=SVC()\nkfold=StratifiedKFold(7)","8c000f77":"sc=[]\nfor train,test in kfold.split(xtrain,ytrain):\n  model.fit(xtrain[train],ytrain[train])\n  y2=model.predict(xtrain[test])\n  sc.append(accuracy_score(ytrain[test],y2))\nsc=np.array(sc)","1081f435":"ypre=model.predict(xvalid)\naccuracy_score(yvalid,ypre)","76799ec0":"sns.countplot(ypre==yvalid)","1701a620":"cmx=confusion_matrix(yvalid,ypre)\narr=cmx.sum(axis=1)\ncmx=cmx\/arr\nplt.imshow(cmx,plt.cm.binary)","1c0c1800":"dict_answer={0:'drugA',1:'drugB',2:\"drugC\",3:\"drugX\",4:\"drugY\"}","af2c7251":"noskhe_list=[]\nfor i in range(100):\n  noskhe=model.predict(np.array([np.random.randint(0,39),np.random.randint(0,3)]).reshape(1,2))\n  noskhe_list.append(noskhe)","a591243f":"sns.countplot(np.array(noskhe_list).reshape(100,))","58cfcbed":"sns.countplot(df['drugs'])","6e499678":"https:\/\/www.kaggle.com\/prathamtripathi\/drug-classification\nthis is our dataset\n","966452ab":" # 85% acc in drugs task\n\n #anybody have some advice to me for increase this number?"}}