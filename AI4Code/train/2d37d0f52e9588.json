{"cell_type":{"c092ee2d":"code","f7a93140":"code","3b2421d9":"code","c0598b6e":"code","a46a1a06":"code","ce7cbf24":"code","8b119e30":"code","57615481":"code","25e81f74":"code","97fe1f25":"code","6f5734f1":"code","fe782479":"code","62e5d4b5":"code","0f7b8088":"code","6ad454d9":"code","30ef31ec":"code","c45045d5":"code","0f8aff79":"code","cbb6e9e9":"code","fa131b46":"code","d5b01e86":"code","c64aefa4":"code","73023306":"code","e1d12993":"code","c767a8b0":"code","15f9ab6d":"code","3917b0dc":"code","1bcbaf3c":"code","84a1c780":"code","f671f350":"code","ab130def":"code","8b026611":"code","65a75f1b":"code","8ccf3987":"code","7ab2b98b":"code","c4a68641":"code","e6ae066a":"code","94718cba":"code","34270178":"code","fbee985f":"code","e14e9b21":"code","6b622d7e":"code","caf7f5e6":"code","be8c8ee0":"code","1889d8e0":"code","5218e461":"code","4047b168":"code","c07c8106":"code","6339f31c":"code","84b095ef":"code","9ff7a643":"code","110d952b":"code","5607101e":"code","51fc2ce4":"code","e35ec53f":"code","a98d8fcc":"code","dc37f511":"code","afc61e05":"code","5f29dbc5":"code","fbb6f384":"code","58cecd88":"code","a80416b0":"code","483e854f":"code","df7c4581":"code","3d61bb5f":"code","b1d43161":"code","4d0c399d":"code","a80d8061":"code","630f79d4":"code","2f164dca":"code","6fe23c15":"code","c2669016":"code","273fcbae":"code","72cbd37a":"code","47b428f7":"code","174cc6e5":"code","ab9b3e66":"code","dd1356af":"code","ad31c7c9":"code","dfc0df2c":"code","71786751":"code","9448947f":"code","73c4f1fb":"code","11452046":"code","3c61f2d6":"code","10d4e8e4":"code","87ecf21b":"code","12d0174e":"code","43c28a62":"code","5b65b670":"markdown","8be09db4":"markdown","629f6546":"markdown","dc91ae26":"markdown","95ff9f84":"markdown","b7b63bbf":"markdown","9ab8bd50":"markdown","d9ab849e":"markdown","62d18742":"markdown","7d0931d3":"markdown","ff0ba8d1":"markdown","cdadaf2c":"markdown","5327ea9c":"markdown","d52bf0ed":"markdown","184a61c4":"markdown","9d86f343":"markdown","5b72813b":"markdown","1bcb3406":"markdown","7bcc0e64":"markdown","216c053d":"markdown","405ecc46":"markdown","c104bee2":"markdown","017e780c":"markdown","172e89e9":"markdown","2f59b7d0":"markdown","79a58c27":"markdown","4c3b4b73":"markdown","d0cc53b7":"markdown","a7611618":"markdown","94fbd9cb":"markdown"},"source":{"c092ee2d":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline","f7a93140":"data = pd.read_csv(\"..\/input\/heart-attack-analysis-prediction-dataset\/heart.csv\")","3b2421d9":"data.head()","c0598b6e":"duplicate_rows = data[data.duplicated()]\nprint(\"Number of duplicate rows: \", duplicate_rows.shape)","a46a1a06":"data = data.drop_duplicates()","ce7cbf24":"duplicate_rows = data[data.duplicated()]\nprint(\"Number of duplicate rows: \", duplicate_rows.shape)","8b119e30":"data.info()","57615481":"data.isnull().sum()","25e81f74":"data.describe().transpose()","97fe1f25":"data[\"output\"].value_counts(normalize=True)*100","6f5734f1":"plt.figure(figsize=(12,7))\nsns.countplot(x=data[\"output\"], color=\"red\", alpha=0.4)","fe782479":"print(\"The min value for age is: \", data[\"age\"].min())\nprint(\"The mean value for age is: \", data[\"age\"].mean())\nprint(\"The max value for age is: \", data[\"age\"].max())","62e5d4b5":"plt.figure(figsize=(12,7))\nsns.distplot(x=data[\"age\"], bins=15, color=\"red\")","0f7b8088":"sns.jointplot(x=\"age\", y=\"chol\", data=data, hue=\"output\")","6ad454d9":"data[\"chol\"].max()","30ef31ec":"plt.figure(figsize=(12,7))\nsns.distplot(x=data[\"chol\"], bins=10, color=\"green\")","c45045d5":"data = data[data[\"chol\"] < 380]","0f8aff79":"data[\"chol\"].max()","cbb6e9e9":"data[\"sex\"].value_counts(normalize=True)*100","fa131b46":"plt.figure(figsize=(15,7))\nsns.set_context(\"paper\", font_scale=1.5)\nsns.countplot(x=\"sex\", palette=\"plasma\", data=data, hue=\"output\")\nplt.title(\"Gender\")\nplt.legend(title=\"Target Variable\")","d5b01e86":"gender_gb = data.groupby(\"output\")[\"sex\"]\ngender_gb.value_counts()","c64aefa4":"prob_female_total = 69\/len(data[\"sex\"])*100\nprob_female_total","73023306":"prob_male_total = 92\/len(data[\"sex\"])*100\nprob_male_total","e1d12993":"plt.figure(figsize=(15,7))\nsns.set_context(\"paper\", font_scale=1.5)\nsns.countplot(x=\"cp\", color=\"gold\", data=data, hue=\"sex\")\nplt.xlabel(\"Chest Pain: 1 typical angina, 2 atypical angina, 3 non-anginal pain, 4 asymptomatic\")","c767a8b0":"g = sns.FacetGrid(data, col=\"sex\", hue=\"output\")\ng.map(plt.scatter, \"age\", \"chol\").add_legend()","15f9ab6d":"prob_female = 69\/(69+22)*100\nprob_male = 93\/(114+93)*100\nprint(\"Given the female population in the dataset, the probability of a female having higher chance of heart attack is: {:.2f}%\".format(prob_female))\nprint(\"\\n\")\nprint(\"Given the male population in the dataset, the probability of a male having higher chance of heart attack is: {:.2f}%\".format(prob_male))","3917b0dc":"plt.figure(figsize=(15,7))\nsns.set_context(\"paper\", font_scale=1.5)\nsns.countplot(x=\"cp\", palette=\"Reds_r\", data=data, hue=\"output\")\nplt.xlabel(\"Chest Pain: 0 typical angina, 1 atypical angina, 2 non-anginal pain, 3 asymptomatic\")","1bcbaf3c":"plt.figure(figsize=(15,7))\nsns.boxplot(x=\"cp\", y=\"trtbps\", data=data, hue=\"output\")\nplt.xlabel(\"Chest Pain: 0 typical angina, 1 atypical angina, 2 non-anginal pain, 3 asymptomatic\")\nplt.ylabel(\"Resting blood pressure (in mm Hg)\")\nsns.set_context(\"paper\", font_scale=1.5)","84a1c780":"g = sns.FacetGrid(data, col=\"sex\", hue=\"output\")\ng.map(plt.scatter, \"trtbps\", \"thalachh\").add_legend()","f671f350":"plt.figure(figsize=(12,7))\nsns.distplot(x=data[\"trtbps\"], bins=10, color=\"blue\")","ab130def":"data = data[data[\"trtbps\"] < 180]","8b026611":"data[\"trtbps\"].max()","65a75f1b":"plt.figure(figsize=(12,7))\nsns.distplot(x=data[\"thalachh\"], bins=15, color=\"red\")","8ccf3987":"data = data[data[\"thalachh\"] > 100]","7ab2b98b":"data[\"thalachh\"].min()","c4a68641":"data.columns","e6ae066a":"data[\"fbs\"].value_counts(normalize=True)*100","94718cba":"plt.figure(figsize=(9,6))\nsns.countplot(x=data[\"fbs\"], color=\"red\", alpha=0.4)","34270178":"plt.figure(figsize=(12,7))\nsns.boxplot(x=\"exng\", y=\"thalachh\", data=data, hue=\"output\", palette=\"seismic\")","fbee985f":"data.columns","e14e9b21":"plt.figure(figsize=(15,7))\nsns.boxplot(x=\"slp\", y=\"oldpeak\", data=data, hue=\"output\")","6b622d7e":"plt.figure(figsize=(15,7))\nsns.violinplot(x=\"slp\", y=\"oldpeak\", data=data, hue=\"output\", palette=\"plasma\")","caf7f5e6":"data[\"caa\"].value_counts(normalize=True)*100","be8c8ee0":"data[\"restecg\"].value_counts(normalize=True)*100","1889d8e0":"data[\"restecg\"].value_counts()","5218e461":"ekg_normal = len(data[data[\"restecg\"] == 0])\/len(data[\"restecg\"])*100\nekg_normal","4047b168":"ekg1 = len(data[data[\"restecg\"] == 1])\/len(data[\"restecg\"])*100\nekg2 = len(data[data[\"restecg\"] == 2])\/len(data[\"restecg\"])*100\nekg_normal = len(data[data[\"restecg\"] == 0])\/len(data[\"restecg\"])*100\n\nprint(\"Abnormal EKG: {:.2f}\".format(ekg1))\nprint(\"\\n\")\nprint(\"Hypertrophy by Estes: {:.2f}\".format(ekg2))\nprint(\"\\n\")\nprint(\"Normal EKG: {:.2f}\".format(ekg_normal))\n","c07c8106":"plt.figure(figsize=(12,7))\nsns.countplot(x=\"output\", data=data, hue=\"sex\", palette=\"seismic\")","6339f31c":"data.corr()[\"output\"].sort_values(ascending=False)","84b095ef":"plt.figure(figsize=(18,7))\nsns.heatmap(data.corr(method=\"pearson\"), cmap=\"PuRd\", annot=True, lw=0.1)","9ff7a643":"plt.figure(figsize=(15,7))\nsns.kdeplot(x=\"age\", y=\"cp\", data=data, hue=\"output\", fill=True, palette=\"Reds\")","110d952b":"data.columns","5607101e":"data.skew(axis=0, skipna=True)","51fc2ce4":"data[\"caa\"].value_counts()","e35ec53f":"data[\"caa\"] = data[\"caa\"].replace([2,3,4],1)\ndata[\"caa\"].value_counts()","a98d8fcc":"data[\"oldpeak\"].min()","dc37f511":"data[\"oldpeak\"] = data[\"oldpeak\"].replace(0.0, 0.01)\ndata[\"oldpeak\"].value_counts()","afc61e05":"data[\"log_oldpeak\"] = np.log10(data[\"oldpeak\"])","5f29dbc5":"data.skew(axis=0, skipna=True)","fbb6f384":"data = data.drop(\"oldpeak\", axis=1)","58cecd88":"data.corr()[\"output\"]","a80416b0":"data = data.drop([\"trtbps\", \"chol\", \"restecg\", \"fbs\", \"age\", \"sex\"], axis=1)","483e854f":"data.corr()[\"output\"]","df7c4581":"data.head()","3d61bb5f":"X = data.drop(\"output\", axis=1)\ny = data[\"output\"]","b1d43161":"from sklearn.model_selection import train_test_split","4d0c399d":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)","a80d8061":"from sklearn.tree import DecisionTreeClassifier","630f79d4":"tree_model = DecisionTreeClassifier(max_depth=15, random_state=42)","2f164dca":"tree_model.fit(X_train, y_train)","6fe23c15":"tree_predict = tree_model.predict(X_test)","c2669016":"from sklearn.metrics import classification_report, confusion_matrix","273fcbae":"print(classification_report(y_test, tree_predict))\nprint(\"Confusion Report:\")\nprint(confusion_matrix(y_test, tree_predict))","72cbd37a":"from sklearn.ensemble import RandomForestClassifier","47b428f7":"random_model = RandomForestClassifier(n_estimators=80, bootstrap=True, random_state=42, criterion=\"entropy\")","174cc6e5":"random_model.fit(X_train, y_train)","ab9b3e66":"random_predict = random_model.predict(X_test)","dd1356af":"print(confusion_matrix(y_test, random_predict))\nprint(\"Confusion Report:\")\nprint(classification_report(y_test, random_predict))","ad31c7c9":"from sklearn.linear_model import LogisticRegression","dfc0df2c":"log_model = LogisticRegression(solver=\"liblinear\", random_state=42)","71786751":"log_model.fit(X_train, y_train)","9448947f":"log_predict = log_model.predict(X_test)","73c4f1fb":"print(classification_report(y_test, log_predict))\nprint(\"Confusion Report:\")\nprint(confusion_matrix(y_test, log_predict))","11452046":"from sklearn.naive_bayes import GaussianNB","3c61f2d6":"gaussian_model = GaussianNB()","10d4e8e4":"gaussian_model.fit(X_train, y_train)","87ecf21b":"gaussian_predict = gaussian_model.predict(X_test)","12d0174e":"print(classification_report(y_test, gaussian_predict))\nprint(\"Confusion Report:\")\nprint(confusion_matrix(y_test, gaussian_predict))","43c28a62":"report = [[\"GaussianNB\", 0.84, 0.84, 0.84, 0.84], [\"Random Forest\", 0.82, 0.83, 0.82, 0.82], \n          [\"DecisionTreeClassifier\", 0.81, 0.81, 0.81, 0.81],\n          [\"LogisticRegression\", 0.88, 0.87, 0.86, 0.86]]\noverall_result = pd.DataFrame(report, columns=[\"Model\", \"Accuracy Score\", \"Precision\", \"Recall\", \"F1-score\"])\noverall_result.sort_values(\"Accuracy Score\", ascending=False)\n","5b65b670":"### Predictive Model: Decision Trees","8be09db4":"### The data correlation in the heatmap below shows us that cp, thalachh, and s\/p have the highest correlation with output, our target variable. ","629f6546":"# Dataset Description:\n\n\n## Age : Age of the patient\n\n## Sex : Sex of the patient\n\n## exang: exercise induced angina (1 = yes; 0 = no)\n\n## ca: number of major vessels (0-3)\n\n## cp : Chest Pain type chest pain type\n\n* Value 1: typical angina \n* Value 2: atypical angina \n* Value 3: non-anginal pain \n* Value 4: asymptomatic\n\n## trtbps : resting blood pressure (in mm Hg)\n\n## chol : cholestoral in mg\/dl fetched via BMI sensor\n\n## fbs : (fasting blood sugar > 120 mg\/dl) (1 = true; 0 = false)\n\n## rest_ecg : resting electrocardiographic results\n\n* Value 0: normal \n* Value 1: having ST-T wave abnormality (T wave inversions and\/or ST elevation or depression of > 0.05 mV) \n* Value 2: showing probable or definite left ventricular hypertrophy by Estes' criteria thalach : maximum heart rate achieved\n\n## target : 0= less chance of heart attack 1= more chance of heart attack","dc91ae26":"### Drilling down into number of males and females having higher chance of heart attack","95ff9f84":"### Removing outlier","b7b63bbf":"### A quick glance using the graph below, age 50 with non-anginal chest type has the highest risk of having a heart attack.","9ab8bd50":"### Basic descriptive analysis","d9ab849e":"### I had high hope on GaussianNB model but looks like this model yields ~0.84. The recall at 0.90 on 1 is remarkable. ","62d18742":"# Fun Fact:\n### Given the dataset, the probability of a picking a female patient with having higher chance of heart attack is 23%\n\n### Given the dataset, the probability of a picking a male patient with having higher chance of heart attack is 31%","7d0931d3":"### Predictive Model: Random Forest","ff0ba8d1":"### The precision score for 0 and 1 is ~0.80s, which I think is acceptable, but on the low end. ","cdadaf2c":"### The target feature \"output\" has sorta balanced dataset","5327ea9c":"### Exploratory Data Analysis","d52bf0ed":"### Importing libraries","184a61c4":"# Overall, Logistic Regression yields the highest score across the board on this dataset. ","9d86f343":"## Project Objective:\n### To predict the outcome, if there is a high or less chance of having heart attack. The target feature or y-variable is \"output\", where 0= less chance of heart attack 1= more chance of heart attack.  ","5b72813b":"## Potential Impact:\n### Healthier population, less money spent on healthcare, reduce mortality rate due to cardiovascular disease. ","1bcb3406":"### The logistic regression model, by far, performs the best with precision score 0.95 on 0, and recall at 0.97 on 1. The f1-score 0.88 for 1 is very good. ","7bcc0e64":"# Healthcare: Predicting Heart Attack","216c053d":"### Creating X and y variables for training the model","405ecc46":"### Checking for duplicates","c104bee2":"### Noted in general, males have higher count than females across all types of chest pain, as shown in the graph below. This is because of the gender proportion in the dataset. ","017e780c":"### Predictive Model: Logistic Regression","172e89e9":"### Noted that the data types are integers and float with no null values","2f59b7d0":"## Description:\n### Cardiovascular disease is one of the top contributors to mortality in the world. Millions of dollars were spent on medical treatment included medications, surgical intervention, and so forth. Instead of spending humongous amount of money in treatment, preventive measures can significantly impact population health in positive way. People can benefit from early diagnosis before heart attack and gives them the opportunity to take preventive actions. ","79a58c27":"### Noted outliers in choleterol feature. Will just drop these extreme numbers. ","4c3b4b73":"### The feature fbs has skewness >2. Also noted this feature has the lowest correlation, especially with target feature as shown in the heatmap. Will just drop this feature.\n\n### Features oldpeak and caa will be log-transformed hopefully it can improve the data skewness.","d0cc53b7":"## Process:\n### This interesting project will start of with basic descriptive analysis, followed by data visualization along with exploratory data analysis, preparing the data, splitting train and test data, and fit into the model. Finally, the model's performance will be evaluated by classification report and confusion matrix. ","a7611618":"### The Random Forest yields a slightly better precision score for 0 and 1 at ~0.82s, which I think is acceptable, but on the low end. Too bad my favorite model is not doing so well in this dataset. ","94fbd9cb":"### The gender proportion is imbalanced with male accounts for ~69% and female ~31%."}}