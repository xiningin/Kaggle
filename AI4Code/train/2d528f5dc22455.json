{"cell_type":{"80c3e0bb":"code","09624705":"code","2b0be843":"code","7f2c976f":"code","12918fa5":"code","c04302ae":"code","a65f85b5":"code","38932f01":"code","780a20a7":"code","27eab41c":"code","ffdd0a8f":"code","14010ffd":"code","5585320a":"code","71fcaf63":"code","2d0d35a5":"code","21748de4":"code","f59d5ea8":"code","b39efcd3":"code","07bfa247":"code","7237efc3":"code","c65f3b94":"code","9005c144":"code","1b93db65":"code","616d87a0":"code","6f59667c":"markdown","cb151d42":"markdown","d43c325f":"markdown","8f4ccdae":"markdown","648c2701":"markdown","d3190605":"markdown","1bc95311":"markdown","a89e304d":"markdown","e7fcc3fd":"markdown","872b24d1":"markdown","5d30aa6c":"markdown","891e3d01":"markdown","afffe354":"markdown","3f06bd1e":"markdown","b0a01827":"markdown","8feaac0a":"markdown","88b4587e":"markdown","1261fa90":"markdown","732b6a21":"markdown","63311fa9":"markdown","b1056e00":"markdown","5530160a":"markdown","8b1ae2d2":"markdown","1cb41648":"markdown","c644f757":"markdown"},"source":{"80c3e0bb":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport time\n\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.svm import SVC,LinearSVC\nfrom sklearn.ensemble import RandomForestClassifier,AdaBoostClassifier\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.naive_bayes import GaussianNB,BernoulliNB","09624705":"import warnings  as wrn\nwrn.filterwarnings(\"ignore\")","2b0be843":"data = pd.read_csv('..\/input\/star-type-classification\/Stars.csv')\ndata.head()","7f2c976f":"import random\ndef getRandomColor():\n    R,G,B = random.randint(0,255),random.randint(0,255),random.randint(0,255)\n    return (R,G,B)","12918fa5":"def getRandomPalette():\n    palettes = ['Accent', 'Accent_r', 'Blues', 'Blues_r', 'BrBG', 'BrBG_r', 'BuGn', 'BuGn_r', 'BuPu', 'BuPu_r', 'CMRmap', 'CMRmap_r', 'Dark2', 'Dark2_r', 'GnBu', 'GnBu_r', 'Greens', \n                'Greens_r', 'Greys', 'Greys_r', 'OrRd', 'OrRd_r', 'Oranges', 'Oranges_r', 'PRGn', 'PRGn_r', 'Paired', 'Paired_r', 'Pastel1', 'Pastel1_r', 'Pastel2', 'Pastel2_r', 'PiYG',\n                'PiYG_r', 'PuBu', 'PuBuGn', 'PuBuGn_r', 'PuBu_r', 'PuOr', 'PuOr_r', 'PuRd', 'PuRd_r', 'Purples', 'Purples_r', 'RdBu', 'RdBu_r', 'RdGy', 'RdGy_r', 'RdPu', 'RdPu_r', 'RdYlBu',\n                'RdYlBu_r', 'RdYlGn', 'RdYlGn_r', 'Reds', 'Reds_r', 'Set1', 'Set1_r', 'Set2', 'Set2_r', 'Set3', 'Set3_r', 'Spectral', 'Spectral_r', 'Wistia', 'Wistia_r', 'YlGn', 'YlGnBu', 'YlGnBu_r', \n                'YlGn_r', 'YlOrBr', 'YlOrBr_r', 'YlOrRd', 'YlOrRd_r', 'afmhot', 'afmhot_r', 'autumn', 'autumn_r', 'binary', 'binary_r', 'bone', 'bone_r', 'brg', 'brg_r', 'bwr', 'bwr_r', 'cividis', 'cividis_r',\n                'cool', 'cool_r', 'coolwarm', 'coolwarm_r', 'copper', 'copper_r', 'crest', 'crest_r', 'cubehelix', 'cubehelix_r', 'flag', 'flag_r', 'flare', 'flare_r', 'gist_earth', 'gist_earth_r', 'gist_gray',\n                'gist_gray_r', 'gist_heat', 'gist_heat_r', 'gist_ncar', 'gist_ncar_r', 'gist_rainbow', 'gist_rainbow_r', 'gist_stern', 'gist_stern_r', 'gist_yarg', 'gist_yarg_r', 'gnuplot', 'gnuplot2', 'gnuplot2_r',\n                'gnuplot_r', 'gray', 'gray_r', 'hot', 'hot_r', 'hsv', 'hsv_r', 'icefire', 'icefire_r', 'inferno', 'inferno_r', 'jet', 'jet_r', 'magma', 'magma_r', 'mako', 'mako_r', 'nipy_spectral', 'nipy_spectral_r', \n                'ocean', 'ocean_r', 'pink', 'pink_r', 'plasma', 'plasma_r', 'prism', 'prism_r', 'rainbow', 'rainbow_r', 'rocket', 'rocket_r', 'seismic', 'seismic_r', 'spring', 'spring_r', 'summer', 'summer_r', 'tab10', \n                'tab10_r', 'tab20', 'tab20_r', 'tab20b', 'tab20b_r', 'tab20c', 'tab20c_r', 'terrain', 'terrain_r', 'turbo', 'turbo_r', 'twilight', 'twilight_r', 'twilight_shifted', 'twilight_shifted_r', 'viridis', 'viridis_r', \n                'vlag', 'vlag_r', 'winter', 'winter_r']\n    return random.choice(palettes)","c04302ae":"data.head()","a65f85b5":"data.info()","38932f01":"plt.subplots(figsize=(6,4))\nplt.title(\"Class Distribution\")\nsns.countplot(data[\"Type\"],palette=\"twilight\")\nplt.show()","780a20a7":"temp_by_class = data.groupby(\"Type\")[\"Temperature\"].mean()\ntemp_by_class","27eab41c":"plt.subplots(figsize=(6,4))\nplt.title(\"Temperature - Type Relation\")\nsns.barplot(temp_by_class.index,temp_by_class.values,palette=getRandomPalette())\nplt.show()","ffdd0a8f":"l_by_class = data.groupby(\"Type\")[\"L\"].mean()\nl_by_class","14010ffd":"plt.subplots(figsize=(6,4))\nplt.title(\"L - Type Relation\")\nsns.barplot(l_by_class.index,l_by_class.values,palette=getRandomPalette())\nplt.show()","5585320a":"r_by_class = data.groupby(\"Type\")[\"R\"].mean()\nr_by_class","71fcaf63":"plt.subplots(figsize=(6,4))\nplt.title(\"R - Type Relation\")\nsns.barplot(r_by_class.index,r_by_class.values,palette=getRandomPalette())\nplt.show()","2d0d35a5":"am_by_class = data.groupby(\"Type\")[\"A_M\"].mean()\nam_by_class","21748de4":"plt.subplots(figsize=(6,4))\nplt.title(\"A_M - Type Relation\")\nsns.barplot(am_by_class.index,am_by_class.values,palette=getRandomPalette())\nplt.show()","f59d5ea8":"data.head()","b39efcd3":"data = pd.get_dummies(data,[\"Spectral_Class\",\"Type\"])\ndata.head()           ","07bfa247":"data_scaled = (data - np.min(data)) \/ (np.max(data) - np.min(data))\ndata_scaled.head()","7237efc3":"X = np.asarray(data_scaled.drop(\"Type\",axis=1))\nY = np.asarray(data_scaled.Type,dtype=int)\nprint(X.shape)\nprint(Y.shape)","c65f3b94":"x_train,x_test,y_train,y_test = train_test_split(X,Y,test_size=0.25,random_state=42)\nprint(x_train.shape)\nprint(x_test.shape)\nprint(y_train.shape)\nprint(y_test.shape)\n","9005c144":"def compareModels(classifiers,data,test_data):\n    result_dict = {}\n    for clf in classifiers:\n        clf.fit(data[0],data[1])\n        result_dict[str(type(clf))] = clf.score(test_data[0],test_data[1])\n    return result_dict","1b93db65":"results = compareModels([SVC(),\n                         LinearSVC(),\n                         GaussianNB(),\n                         BernoulliNB(),\n                         AdaBoostClassifier(DecisionTreeClassifier()),\n                         RandomForestClassifier()\n                        ],\n                        (x_train,y_train),\n                        (x_test,y_test))","616d87a0":"results","6f59667c":"# Table of Content\n1. Preparing Environment\n1. Data Overview\n    * Checking Missing Data\n    * Class Distribution\n    * Temperature - Type Relation\n    * R - Type Relation\n    * L - Type Relation\n    * A_M - Type Relation\n1. Preparing Data\n    * One Hot Encoding\n    * Scaling Between 0 and 1\n    * Train Test Splitting\n1. Machine Learning\n1. Conclusion","cb151d42":"* As you see we have two categorical features: Color and Spectral_Class. \n* So we should one hot encode those features.","d43c325f":"# Preparing Data\nIn this section we're going to prepare our data and make it ready to use in a machine learning model. Let's take a look at the dataframe again to understand what we need to do.","8f4ccdae":"* Now let's split our target and descriptive data.","648c2701":"* We'll use this formula to scale our data between 1 and 0\n\n**(value - min(data)) \/( max(data) - min(data))**","d3190605":"# 2. Data Overview\nIn this section we're going to take a look at the data in order to understand it properly. But before starting I'll define some functions to ease our jobs.","1bc95311":"* Class 0,1,2,3 have small values.\n* Class 4 has a small value as well but it's bigger than others.\n* Class 5 has a really big value so this feature might be descriptive.","a89e304d":"### L - Type (Target) Relation\n","e7fcc3fd":"# Machine Learning\nIn this section we're going to fit a machine learning model using our little dataset.","872b24d1":"* As we can see there are differences between the classes so this feature might be good for our classification problem.","5d30aa6c":"### R - Type (Target) Relation\n","891e3d01":"# 1. Preparing Environment\nIn this section we're going to import libraries and import the data.","afffe354":"* And now we can split our dataset into test and train set.","3f06bd1e":"* Although there is no big differences this feature might be descriptive as well, so we won't drop it too.","b0a01827":"### A_M - Type (Target) Relation","8feaac0a":"* And now as we see, our features need to be scaled because there are really big scale differences between them.","88b4587e":"* Class 0,1,2 have really small values, 3 has a small value but it's bigger than 0,1,2.\n* Class 4,5 have really big values.\n\nSo this feature might be good as well to create a model for this mission.","1261fa90":"* We have a small dataset so results might be misleading, but even though we created nice models.","732b6a21":"### Temperature - Type (Target) Relation","63311fa9":"# Conclusion\nThanks for your attention, if you have a question please ask me in the comment section and mention me. I'll return to you as soon as possible.\n","b1056e00":"### Are there any problem in the data?","5530160a":"* We have 6 classes and 40 sample for each class. \n* Data is insanely balanced. \n","8b1ae2d2":"### Class Distribution","1cb41648":"# Star Classification: Detailed EDA - Machine Learning\nWelcome to this kernel community, in this kernel we're going to explore the star classification dataset using visualization tools and pandas. And then we're going to try several types of machine learning algorithms and find the best.\n\n","c644f757":"* We don't have a missing data\n* All data types seem true, so we can move on and check the class distribution."}}