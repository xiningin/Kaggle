{"cell_type":{"8f8e8c23":"code","5c127c6b":"code","e3a92309":"code","50e3c0cc":"code","452115ce":"code","4145b72e":"code","c86b5db2":"code","084bf0f9":"code","79f3b8ff":"code","dcf6c1cb":"code","7d3d48d4":"code","8ebd83b6":"code","32f2d94e":"code","7b087326":"code","a253d090":"code","c732dbdd":"code","8536343c":"code","e2a9ca2e":"code","1d8434fc":"code","747ca44e":"code","9430722a":"code","d8d1599b":"code","b197cd61":"code","f73c5304":"code","f4da523e":"code","afbc3a1a":"code","59fd50b4":"code","86f072c8":"code","390e38af":"code","61981093":"code","b2314c0a":"code","87bf233a":"code","36211064":"code","1d1187bc":"code","33fb8273":"code","7fd40cd3":"code","6c4fc2c3":"code","7f8807db":"code","f42d6468":"markdown","be59c428":"markdown","3a5d4c4d":"markdown","d163bce1":"markdown","e0d8820f":"markdown","b1c14666":"markdown","98cfa56d":"markdown","7f7b7bcc":"markdown","f611034c":"markdown"},"source":{"8f8e8c23":"import pandas as pd\n\nimport scipy.stats as stats\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set(rc={'figure.figsize':(16,8)})\nsns.set(font_scale=1.3)\nplt.style.use('fivethirtyeight')\n\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.model_selection import train_test_split\n\nimport h2o\n\nimport warnings\nwarnings.filterwarnings('ignore')","5c127c6b":"data = pd.read_csv('..\/input\/weather-dataset-rattle-package\/weatherAUS.csv')","e3a92309":"data.head()","50e3c0cc":"data.shape","452115ce":"(data.isnull().sum()\/len(data))*100","4145b72e":"data.drop(columns=['Evaporation','Sunshine','Cloud9am','Cloud3pm'], inplace=True)","c86b5db2":"data.head()","084bf0f9":"# Fill missing values with the mean\ndef missing_value_number(data):\n    for col in data.select_dtypes(['int','float']):\n        data[col] = data[col].fillna(data[col].median())\n    return data\n\n# Fill missing values\ndef missing_values_object(data):\n    for col in data.select_dtypes(['object']):\n        data[col] = data[col].fillna(method='ffill')\n    return data\n\n# Encoding\ndef encoder(data):\n    le = LabelEncoder()\n    for col in data.select_dtypes('object'):\n        data[col] = le.fit_transform(data[col])\n    return data\n\n# Plot\ndef plt_percente(plot, feature):\n    total = len(feature)\n    for p in plot.patches:\n        percentage = '{:.1f}%'.format(100 * p.get_height()\/total)\n        x = p.get_x() + p.get_width() \/ 2 - 0.05\n        y = p.get_y() + p.get_height()\n        ax.annotate(percentage, (x, y), size = 18)\n    plt.show()","79f3b8ff":"data = missing_value_number(data)\ndata = missing_values_object(data)","dcf6c1cb":"data.describe().T.style.bar(subset=['mean'], color='#205ff2')\\\n                            .background_gradient(subset=['std'], cmap='Reds')\\\n                             .background_gradient(subset=['50%'], cmap='coolwarm')","7d3d48d4":"plt.subplots(figsize=(16,8))\nsns.countplot(data=data, x='WindGustDir').set_title('Gust of Wind');","8ebd83b6":"plt.subplots(figsize=(16,8))\nsns.countplot(data=data, x='WindDir9am').set_title('Wind Direction 9am');","32f2d94e":"plt.subplots(figsize=(16,8))\nsns.countplot(data=data, x='WindDir3pm').set_title('Wind Direction 3pm');","7b087326":"plt.subplots(figsize=(8,6))\nax = sns.countplot(data=data, x='RainToday');\n\nplt_percente(ax, data.RainToday)","a253d090":"plt.subplots(figsize=(8,6))\nax = sns.countplot(data=data, x='RainTomorrow');\n\nplt_percente(ax, data.RainTomorrow)","c732dbdd":"data['Date'] = pd.to_datetime(data['Date'])\ndata['Day'] = data['Date'].dt.day\ndata['Month'] = data['Date'].dt.month\ndata['Year'] = data['Date'].dt.year","8536343c":"data = encoder(data)","e2a9ca2e":"plt.figure(figsize=(18,15))\nsns.heatmap(data.corr(), cmap=plt.cm.Reds, cbar_kws={'shrink': .6}, square=True, \n            annot=True, fmt='.2f', linewidths=.8)\nplt.show()","1d8434fc":"plt.subplots(figsize=(20,30))\ncol = data.columns[2:17]\nlenght = len(col)\n\nfor i, j in zip(col, range(lenght)):\n    plt.subplot((lenght\/2), 3, j+1)\n    plt.subplots_adjust(wspace=.2, hspace=.5)\n    sns.distplot(data[i], kde=False, fit=stats.norm)\n    plt.title(i)","747ca44e":"df = data.iloc[:730,:]\nplt.subplots(figsize=(18,6))\nplt.plot(df['Date'], df['Rainfall'], color='violet');\nplt.title('Rainfall by Date');","9430722a":"plt.subplots(figsize=(18,6))\nplt.plot(df['Date'], df['WindGustSpeed'], color='violet');\nplt.title('WindGustSpeed by Date');","d8d1599b":"plt.subplots(figsize=(18,6))\nplt.plot(df['Date'], df['MinTemp'], color='blue', linewidth=1, label= 'MinTemp')\nplt.plot(df['Date'], df['MaxTemp'], color='red',  linewidth=1, label= 'MaxTemp')\nplt.fill_between(df['Date'], df['MinTemp'], df['MaxTemp'], facecolor = '#EBF78F')\nplt.title('MinTemp vs MaxTemp by Date')\nplt.legend(loc='lower left', frameon=False);","b197cd61":"plt.subplots(figsize=(18,6))\nplt.plot(df['Date'], df['WindSpeed9am'],color='blue', linewidth=2, label= 'WindSpeed9am')\nplt.plot(df['Date'], df['WindSpeed3pm'],color='green', linewidth=2, label= 'WindSpeed3pm')\nplt.legend(frameon=False)\nplt.title('WindSpeed9am vs WindSpeed3pm by Date');","f73c5304":"plt.subplots(figsize=(18,6))\nplt.plot(df['Date'], df['Pressure9am'],color='blue', linewidth=2, label= 'WindSpeed9am')\nplt.plot(df['Date'], df['Pressure3pm'],color='green', linewidth=2, label= 'WindSpeed3pm')\nplt.legend(frameon=False)\nplt.title('Pressure9am vs Pressure3pm by Date');","f4da523e":"columns = data.columns[2:17]\nplt.subplots(figsize=(20,30))\nlength = len(columns)\n\nfor i, j in zip(columns, range(length)):\n    plt.subplot((length\/2), 3, j+1)\n    plt.subplots_adjust(wspace=.2, hspace=.5)\n    sns.boxplot(y=data[i])\n    plt.title(i)","afbc3a1a":"h2o.init(nthreads= -1)","59fd50b4":"data = h2o.H2OFrame(data)","86f072c8":"data['Location'] = data['Location'].asfactor()\ndata['WindGustDir'] = data['WindGustDir'].asfactor()\ndata['WindDir9am'] = data['WindDir9am'].asfactor()\ndata['WindDir3pm'] = data['WindDir3pm'].asfactor()\ndata['RainToday'] = data['RainToday'].asfactor()\ndata['RainTomorrow'] = data['RainTomorrow'].asfactor()","390e38af":"features = ['Location','MinTemp','MaxTemp','Rainfall','WindGustDir','WindGustSpeed',\n            'WindDir9am','WindDir3pm','WindSpeed9am','WindSpeed3pm','Humidity9am','Humidity3pm','Pressure9am',\n            'Pressure3pm','Temp9am','Temp3pm','RainToday','Day','Month','Year']","61981093":"split = data.split_frame(ratios = [0.8])\n\ntrain = split[0]\ntest = split[1] ","b2314c0a":"from h2o.estimators.glm import H2OGeneralizedLinearEstimator\n\nglm_default = H2OGeneralizedLinearEstimator(family = 'binomial', model_id = 'glm_default', \n                                            keep_cross_validation_predictions = True, nfolds =5, \n                                            fold_assignment=\"stratified\", balance_classes=True)\n\nglm_default.train(x = features, y = 'RainTomorrow', training_frame = train)","87bf233a":"plt.figure(figsize=(5,5))\nvariable = glm_default.varimp_plot()\nplt.show()","36211064":"performace = glm_default.model_performance(train=True)\nperformace.plot();","1d1187bc":"performace = glm_default.model_performance(test)\nperformace.plot()","33fb8273":"from h2o.estimators.random_forest import H2ORandomForestEstimator\n\ndrf_default = H2ORandomForestEstimator(model_id='drf_default', keep_cross_validation_predictions=True,\n                                       nfolds=5, fold_assignment=\"stratified\", balance_classes=True)\n\ndrf_default.train(x = features, y='RainTomorrow', training_frame=train)","7fd40cd3":"plt.figure(figsize=(5,5))\nvariable = drf_default.varimp_plot()\nplt.show()","6c4fc2c3":"performace = drf_default.model_performance(train=True)\nperformace.plot()","7f8807db":"performace = drf_default.model_performance(test)\nperformace.plot()","f42d6468":"<a name=\"eda\">\n\n# <p style=\"background-color:#1c56c9; font-family:newtimeroman; font-size:150%; text-align:center; border-radius:  25px; color:#ffffff; padding-top:5px; padding-bottom:5px;\">EDA<\/p>","be59c428":"<p style='font-family: \"Lucida Console\", \"Courier New\", monospace;font-size:125%; '>The Evaporation, Sunshine, Cloud9am and Cloud9am columns have too many missing values so they will be deleted.<\/p>","3a5d4c4d":"<p style='font-family: \"Lucida Console\", \"Courier New\", monospace;font-size:125%; '>The outliers will not be removed, because in periods of rain we will have values much higher than in periods without rain.<\/p>","d163bce1":"<a name=\"import\">\n\n# <p style=\"background-color:#1c56c9; font-family:newtimeroman; font-size:150%; text-align:center; border-radius:  25px; color:#ffffff; padding-top:5px; padding-bottom:5px;\">Import<\/p>","e0d8820f":"<a name=\"functions\">\n\n# <p style=\"background-color:#1c56c9; font-family:newtimeroman; font-size:150%; text-align:center; border-radius:  25px; color:#ffffff; padding-top:5px; padding-bottom:5px;\">Funtions<\/p>","b1c14666":"<img src='https:\/\/www.greenmebrasil.com\/wp-content\/uploads\/2020\/10\/montanhas-chuva.jpg'>","98cfa56d":"* <a href=\"#import\">Import<\/a>\n\n* <a href=\"#missing\">Missing Values<\/a>\n\n* <a href=\"#functions\">Functions<\/a>\n\n* <a href=\"#eda\">EDA<\/a>\n\n* <a href=\"#h2o\">H2O<\/a>","7f7b7bcc":"<a name=\"missing\">\n\n# <p style=\"background-color:#1c56c9; font-family:newtimeroman; font-size:150%; text-align:center; border-radius:  25px; color:#ffffff; padding-top:5px; padding-bottom:5px;\">Missing Values<\/p>","f611034c":"<a name=\"h2o\">\n\n# <p style=\"background-color:#1c56c9; font-family:newtimeroman; font-size:150%; text-align:center; border-radius:  25px; color:#ffffff; padding-top:5px; padding-bottom:5px;\">H2O<\/p>"}}