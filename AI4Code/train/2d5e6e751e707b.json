{"cell_type":{"b0fa363c":"code","71d96931":"code","b0b06697":"code","2b0a3a78":"code","044e5c8a":"code","03558198":"code","6fe8bea5":"code","94c8c7fc":"code","6b7da6ef":"code","4e71535e":"code","4c66b2bb":"code","7204e4c4":"code","b14bb2b9":"code","0631dc8c":"code","bf04a1b9":"code","f768f543":"markdown","81d5290b":"markdown","78814c73":"markdown","44eea5d0":"markdown"},"source":{"b0fa363c":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set(style='darkgrid')\n\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import confusion_matrix\n\nfrom warnings import filterwarnings\nfilterwarnings(\"ignore\")\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","71d96931":"#read datasets\ndf_inf=pd.read_csv(\"..\/input\/polycystic-ovary-syndrome-pcos\/PCOS_infertility.csv\", encoding='iso-8859-1')\ndf_noinf=pd.read_csv(\"..\/input\/polycystic-ovary-syndrome-pcos\/data without infertility _final.csv\", encoding='iso-8859-1')\nprint(f\"Shape of df_inf:{df_inf.shape}\")\nprint(f\"Shape of df_noinf:{df_noinf.shape}\")","b0b06697":"#Sample data from df_inf\ndf_inf.sample(5)","2b0a3a78":"#Sample data from df_noinf\ndf_noinf.sample(5)","044e5c8a":"#Identifying Features which have more than 0.40 correlation with PCOS(Y\/N)\n\ncorr_features=df_noinf.corrwith(df_noinf[\"PCOS (Y\/N)\"]).abs().sort_values(ascending=False)\n#features with correlation more than 0.4\ncorr_features=corr_features[corr_features>0.4].index\ncorr_features","03558198":"df_inf.corrwith(df_inf[\"PCOS (Y\/N)\"]).abs()","6fe8bea5":"df_noinf=df_noinf[corr_features]\ndf_noinf.head()","94c8c7fc":"df_noinf.columns","6b7da6ef":"plt.figure(figsize=(14,5))\nplt.subplot(1,6,1)\nsns.boxplot(x='PCOS (Y\/N)',y='Follicle No. (R)',data=df_noinf)\n#plt.subplot(1,7,2)\n#sns.boxplot(x='PCOS (Y\/N)',y='Insulin levels (\u00e6IU\/ml)',data=df_noinf)\nplt.subplot(1,6,2)\nsns.boxplot(x='PCOS (Y\/N)',y='Follicle No. (L)',data=df_noinf)\nplt.subplot(1,6,3)\nsns.boxplot(x='PCOS (Y\/N)',y='Skin darkening (Y\/N)',data=df_noinf)\nplt.subplot(1,6,4)\nsns.boxplot(x='PCOS (Y\/N)',y='hair growth(Y\/N)',data=df_noinf)\nplt.subplot(1,6,5)\nsns.boxplot(x='PCOS (Y\/N)',y='Weight gain(Y\/N)',data=df_noinf)\nplt.subplot(1,6,6)\nsns.boxplot(x='PCOS (Y\/N)',y='Cycle(R\/I)',data=df_noinf)\n\nplt.show()","4e71535e":"plt.figure(figsize=(6,5))\nsns.heatmap(df_noinf.corr(), annot=True)\nplt.show()","4c66b2bb":"y=df_noinf['PCOS (Y\/N)']\nX=df_noinf.drop(['PCOS (Y\/N)'], axis=1)","7204e4c4":"X_train,X_test,y_train, y_test=train_test_split(X,y, test_size=0.2)","b14bb2b9":"model=LogisticRegression()\nmodel.fit(X_train,y_train)\nprint(f\"Score in Train Data : {model.score(X_train,y_train)}\")","0631dc8c":"y_pred=model.predict(X_test)","bf04a1b9":"print(f\"Score in Test Data : {model.score(X_test,y_test)}\")\n\ncm=confusion_matrix(y_test, y_pred)\np_right=cm[0][0]+cm[1][1]\np_wrong=cm[0][1]+cm[1][0]\n\nprint(f\"Right classification : {p_right}\")\nprint(f\"Wrong classification : {p_wrong}\")\ncm","f768f543":"## Prediction","81d5290b":"## Model Evaluation","78814c73":"## Training Model","44eea5d0":"## Feature Selection"}}