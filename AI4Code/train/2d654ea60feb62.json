{"cell_type":{"fce26471":"code","ca38f172":"code","06d1e1f5":"code","065d6b05":"code","19720e3e":"code","e4388bd9":"code","bb8eb672":"code","9b1dbbe4":"code","b0302254":"code","248537b2":"code","6257c0b1":"code","544e0e54":"code","ae2dbe7d":"code","0ab012b3":"code","5d6f9213":"code","03a2a71d":"code","818b9e24":"code","b07e6bb8":"code","d98d7432":"code","980df200":"code","5a84406b":"code","fa16a18f":"code","1d0a06a3":"code","f6ad2cc8":"code","2345e394":"code","4f125337":"code","3bfcbe70":"code","979783b7":"code","4ba8e719":"code","cca78784":"code","69101f93":"code","0e63b27b":"code","c236d0c0":"code","7802128f":"code","30742884":"code","2c08910b":"code","30c0a415":"code","c7f079d4":"code","47a98266":"code","0f7fb147":"code","1a494207":"code","693435bc":"code","df36e60b":"code","f4085d1d":"code","ec98bf80":"code","1849865c":"markdown","5ccfc516":"markdown","d1082145":"markdown","9486984e":"markdown","8f050cd1":"markdown","10a150a5":"markdown","306f2ab8":"markdown","1426b4bd":"markdown","406a7883":"markdown","78ab6ac1":"markdown","4a6307f4":"markdown","3da59c4a":"markdown","d081de61":"markdown","24552c8e":"markdown","49a2c45b":"markdown","4412dd9f":"markdown","f44f0e93":"markdown","f0077766":"markdown","bfc97efe":"markdown","e3dd5129":"markdown","76a88b90":"markdown","8a922f70":"markdown","e22e5783":"markdown","901de761":"markdown","f2b3e993":"markdown","18204a54":"markdown","e379dc22":"markdown","c739148a":"markdown","f80d8af7":"markdown","7384df3e":"markdown","bbd1a7bf":"markdown","bb42170e":"markdown","c2ac9b8a":"markdown","cc27c150":"markdown","a097fec0":"markdown","abfa862d":"markdown","f405bd24":"markdown","ce3355bc":"markdown","2d288fab":"markdown","62389451":"markdown","2195bf88":"markdown","c6e830e6":"markdown","25fab51a":"markdown","39ba683e":"markdown","950918fc":"markdown","5ac3d32e":"markdown","6f92c566":"markdown","2b2f9996":"markdown","3d163033":"markdown","8b0dfb36":"markdown","9401806b":"markdown","5a79ebcb":"markdown","91c0569f":"markdown","dc8b8043":"markdown","7448f2c4":"markdown","8573a8ce":"markdown","6a5727da":"markdown","e2d9a87e":"markdown","84c8acb7":"markdown","1a5242e3":"markdown","ba6f5cc3":"markdown","eb6bb90e":"markdown","8e44d1a0":"markdown","c133c0c2":"markdown","f41ab91e":"markdown","84d0c97e":"markdown","3fcaa3cc":"markdown","b33b56f7":"markdown","bc4285fa":"markdown","e59bb76f":"markdown","9e677621":"markdown","9a2788d0":"markdown","f3794d83":"markdown","218739d8":"markdown","f9b93612":"markdown","df772ea5":"markdown","0096013d":"markdown","646a33c1":"markdown","e27a669e":"markdown","7678518c":"markdown","dfdabb86":"markdown","a4009518":"markdown","14348d3d":"markdown","63351b56":"markdown","b8514707":"markdown","4d080914":"markdown","b1cef848":"markdown","18bd9908":"markdown","722e4eca":"markdown","1b1f42fb":"markdown","132feb88":"markdown","38f84175":"markdown","afa231d6":"markdown","0b6787bb":"markdown","60022faf":"markdown","408acf35":"markdown","b98ea398":"markdown","fff66272":"markdown"},"source":{"fce26471":"import os\nimport gc\nimport numpy as np\nimport pandas as pd\nfrom tqdm import tqdm\ntqdm.pandas()\nfrom collections import Counter\nfrom operator import itemgetter\nimport scipy\nimport cv2\nfrom cv2 import imread\nimport matplotlib\nimport matplotlib.pyplot as plt\nimport seaborn as sns","ca38f172":"DATA_LEN = 109237\nSAMPLE_SIZE= 50000","06d1e1f5":"rows = np.arange(0, DATA_LEN)\nselect_rows = np.random.choice(rows, SAMPLE_SIZE, replace=False)","065d6b05":"train_images = []\nimage_dirs = np.take(os.listdir('..\/input\/train'), select_rows)\n\nfor image_dir in tqdm(sorted(image_dirs)):\n    image = imread('..\/input\/train\/'+image_dir)\n    train_images.append(image)\n    del image\n    gc.collect()\n    \ntrain_images = np.array(train_images)","19720e3e":"train_df = pd.read_csv('..\/input\/train.csv')\ntargets_df = train_df.loc[(train_df.id.apply(lambda x: x + '.png')).isin(image_dirs)]","e4388bd9":"labels_df = pd.read_csv('..\/input\/labels.csv')\nlabel_dict = dict(zip(labels_df.attribute_id, labels_df.attribute_name))\nfor key in label_dict:\n    if 'culture' in label_dict[key]:\n        label_dict[key] = label_dict[key][9:]\n    if 'tag' in label_dict[key]:\n        label_dict[key] = label_dict[key][5:]","bb8eb672":"train_targets = []\n\nfor targets in targets_df.attribute_ids:\n    target = targets.split()\n    target = list(map(lambda x: label_dict[int(x)], target))\n    train_targets.append(target)\n    \ntrain_targets = np.array(train_targets)","9b1dbbe4":"fig, ax = plt.subplots(nrows=4, ncols=4, figsize=(50, 50))\ncount = 0\n\nfor i in range(4):\n    for j in range(4):\n        ax[i, j].imshow(cv2.cvtColor(train_images[count], cv2.COLOR_BGR2RGB))\n        ax[i, j].set_title(str(train_targets[count]), fontsize=24)\n        count = count + 1","b0302254":"def display_culture_examples(culture, fraction=1, max_count=5):\n    count = 0\n    for i in range(int(len(train_images)*fraction)):\n        if count == max_count:\n            break\n        if culture in train_targets[i]:\n            fig, ax = plt.subplots(figsize=(3, 3))\n            ax.imshow(cv2.cvtColor(train_images[i], cv2.COLOR_BGR2RGB))\n            plt.title(train_targets[i], fontsize=8)\n            plt.show()\n            matplotlib.rcParams.update(matplotlib.rcParamsDefault)\n            count = count + 1\n            \ndef show_common_tags(culture, palette):\n    tags = []\n    for i in range(len(train_images)):\n        if culture in train_targets[i]:\n            tags.extend(train_targets[i])\n    tag_counts = Counter(tags)\n    size = len(tag_counts.keys())\n    tags_df = pd.DataFrame(np.zeros((size, 2)))\n    tags_df.columns = ['tag', 'count']\n    tags_df['tag'] = list(tag_counts.keys())\n    tags_df['count'] = list(tag_counts.values())\n    tags_df = tags_df.sort_values(by=['count'], ascending=False)\n    tags_df = tags_df.reset_index()\n    del tags_df['index']\n    tag_counts = sorted(tag_counts.items(), key = lambda kv:(kv[1], kv[0]))\n    tags = reversed(list(tag_counts)[-6:-1])\n    \n    print(\"MOST COMMON \" + culture.upper() + \" TAGS\")\n    print(\"\")\n    for i, tag in enumerate(tags_df[1:6].tag):\n        print(str(i+1) + '). ' + tag)\n    \n    sns.set_context(rc={'xtick.labelsize': 10})\n    fig, ax = plt.subplots(figsize=(12, 5))\n    plot = sns.barplot(x='tag', y='count', data=tags_df.loc[1:6], palette=palette)\n    plt.title('Common ' + culture[0].upper() + culture[1:] + ' tags')\n    plt.show()\n    sns.reset_defaults()","248537b2":"display_culture_examples('french')","6257c0b1":"show_common_tags('french', palette=['blue', 'blue', 'navajowhite', 'navajowhite', 'red', 'red'])","544e0e54":"display_culture_examples('spanish')","ae2dbe7d":"show_common_tags('spanish', palette=['red', 'red', 'yellow', 'yellow', 'red', 'red'])","0ab012b3":"display_culture_examples('italian')","5d6f9213":"show_common_tags('italian', palette=['forestgreen', 'forestgreen', 'navajowhite', 'navajowhite', 'crimson', 'crimson'])","03a2a71d":"display_culture_examples('german')","818b9e24":"show_common_tags('german', palette=['black', 'black', 'red', 'red', 'yellow' ,'yellow'])","b07e6bb8":"display_culture_examples('russian')","d98d7432":"show_common_tags('russian', palette=['navajowhite', 'navajowhite', 'blue', 'blue', 'red', 'red'])","980df200":"display_culture_examples('danish')","5a84406b":"show_common_tags('danish', palette=['red', 'navajowhite', 'red', 'navajowhite', 'red', 'navajowhite'])","fa16a18f":"display_culture_examples('swedish')","1d0a06a3":"show_common_tags('swedish', palette=['blue', 'yellow', 'blue', 'yellow', 'blue', 'yellow'])","f6ad2cc8":"display_culture_examples('iran')","2345e394":"show_common_tags('iran', palette=['limegreen', 'limegreen', 'navajowhite', 'navajowhite', 'red', 'red'])","4f125337":"display_culture_examples('syrian')","3bfcbe70":"show_common_tags('syrian', palette=['red', 'red', 'green', 'black', 'black'])","979783b7":"display_culture_examples('assyrian')","4ba8e719":"show_common_tags('assyrian', palette=['red', 'red', 'navajowhite', 'navajowhite', 'red', 'red'])","cca78784":"display_culture_examples('india')","69101f93":"show_common_tags('india', palette=['darkorange', 'darkorange', 'navajowhite', 'navajowhite', 'green', 'green'])","0e63b27b":"display_culture_examples('china')","c236d0c0":"show_common_tags('china', palette=['gold', 'red', 'red', 'red', 'red', 'gold'])","7802128f":"display_culture_examples('japan')","30742884":"show_common_tags('japan', palette=['navajowhite', 'navajowhite', 'red', 'red', 'navajowhite', 'navajowhite'])","2c08910b":"display_culture_examples('vietnam')","30c0a415":"show_common_tags('vietnam', palette=['red', 'red', 'yellow', 'yellow', 'red', 'red'])","c7f079d4":"display_culture_examples('thailand')","47a98266":"show_common_tags('thailand', palette=['crimson', 'navajowhite', 'darkblue', 'darkblue', 'navajowhite', 'crimson'])","0f7fb147":"display_culture_examples('egyptian')","1a494207":"show_common_tags('egyptian', palette=['red', 'red', 'navajowhite', 'navajowhite', 'black', 'black'])","693435bc":"display_culture_examples('american')","df36e60b":"show_common_tags('american', palette=['darkblue', 'navajowhite', 'red', 'red', 'navajowhite', 'darkblue'])","f4085d1d":"display_culture_examples('mexican')","ec98bf80":"show_common_tags('mexican', palette=['green', 'green', 'navajowhite', 'navajowhite', 'red', 'red'])","1849865c":"Some examples","5ccfc516":"### Import necessary libraries","d1082145":"Some examples","9486984e":"Vietnamese Culture generally consists of utilitarian objects like ewers (wide jugs), pots, containers etc.But, the main highlights are the religious objects representing the Hindu and Buddhist religions and the jewellery. Many metal carvings and artefacts representing Hindu gods like Shiva can be found. There is also ancient jewellery. **There seems to be more focus on religion in Vietnamese cultural objects compared to Japan.**","8f050cd1":"Some examples","10a150a5":"Most common tags","306f2ab8":"## Scandinavia","1426b4bd":"### Visualize some images from the data","406a7883":"Assyrian culture has similarities with both Irani and Syrian culture. Like Irani culture, there are several inscriptions and objects depicting animals like rams and sphinxes. On the other, there are also seals containing depictions of humans, but there is not much focus on writing (unlike Syrian culture).","78ab6ac1":"## North America","4a6307f4":"### This concludes my cultural analysis ! Thanks for reading ! I hope you found it useful :)","3da59c4a":"Indian Culture mainly focuses on gods and mythical figures. It consits on many texts, manuscripts and inscriptions about religions like Jainism and Hinduism. There are also depictions of gods like Shiva and Vishnu and animals like the Cow (which is of great importance to Hindus). There are also depictions of human figures.","d081de61":"Most common tags","24552c8e":"## North Africa","49a2c45b":"Most common tags","4412dd9f":"Most common tags","f44f0e93":"Russian culture also seems to **mainly consist of paintings and portraits of humans, especially women**. More art tends to focus on women. There is also an important role of nature in Russian culture. **One special object that appears many times is Russian lace.**","f0077766":"<center><img src=\"https:\/\/i.imgur.com\/vHYGK5g.jpg\" width=\"500px\"><\/center>","bfc97efe":"Most common tags","e3dd5129":"### Thailand","76a88b90":"Some examples","8a922f70":"### Denmark","e22e5783":"Most common tags","901de761":"### Vietnam","f2b3e993":"Most common tags","18204a54":"Some examples","e379dc22":"### Assyria (modern day Turkey)","c739148a":"### Japan","f80d8af7":"Some examples","7384df3e":"### Conclusion\nMiddle-Eastern Culture tends to focus a lot on animals like rams, horses etc, which the people at that time relied on for their livelihood . It also consists of several seals and slabs containg ancient writings and depictions of humans and animals.","bbd1a7bf":"Syrian culture mainly consists of ancient writing systems and seals. There are also inscriptions depicting human figures alongside these ancient writings. There are also some utilitarian objects like clothing, accessories and even daggers involved in Syrian culture.","bb42170e":"### Sweden","c2ac9b8a":"## Eastern Europe","cc27c150":"## Middle-East","a097fec0":"American Culture does not consist of any antique objects. It contains modern objects like fashion, accessories and movie posters. There are mainly portraits or pictures of people (men and women), who are generally actresses or actors. There is also modern clothing and accessories on display. Many objects are advertisements of iconic American products, like fashion, food etc.","abfa862d":"Some examples","f405bd24":"### Select 50k random rows from the data","ce3355bc":"The most commmon objects in French culture seem to be portraits and paintings involving human lives (men and women) and nature (flowers and leaves). Some paintings involve couples and some involve people coexisitng with nature (trees and animals). ","2d288fab":"Mexican Culture mostly consits of paintings of men, who are in many cases soldiers. There are many writings written by soldiers related to war. The most common objects, however, are tools and equipment used for activities like cooking. There is also plenty of traditional jewellery, traditional musical instruments, inscriptions and utilitarian objecs like purses. There are also several inscriptions. There are many interesting cartoons involving skeletons, demons and other cartoons depicting anger.","62389451":"Some examples","2195bf88":"Most common tags","c6e830e6":"### Conclusion\nScandinavian Culture mainly focuses on utilitarian objects in general, like cutlery, plates, candlesticks etc, but it also includes paintings focused on women and sometimes music.","25fab51a":"### Load multilabel targets","39ba683e":"### Germany","950918fc":"### Egypt","5ac3d32e":"### Mexico","6f92c566":"### Define functions for visualizing the images and their tags","2b2f9996":"### Structure the labels into a list of lists","3d163033":"### Syria","8b0dfb36":"Most common tags","9401806b":"Most common tags","5a79ebcb":"Egyptian Culture generally consists of architectural fragments from pyramids, places of worship etc. One major feature of this culture is heiroglyphs, the symbolic writings on the inner walls of pyramids. There are also sculptures of Egyptian gods and pharaohs. Additionally, one can find tools and equipment used by Egyptians.","91c0569f":"Some examples","dc8b8043":"Most common tags","7448f2c4":"Danish cultural objects also mainly consist of portraits and paintings of women (men also, but more of women). It also includes nature in the form of flowers, such as floral plates, floral paintings etc. One important feature of Danish objects is utilitarian objects such as plates, cutlery etc.","8573a8ce":"**Swedish culture is the first culture so far, that does not focus a lot on daily human life.** It mainly includes objects related to Stockholm, the Swedish capital. The objects are generally utilitarian objects like candlesticks and firearms. Some objects are also paintings that focus on music and musicians (guitar) and other paintings include nude women and men.","6a5727da":"Some examples","e2d9a87e":"Most common tags","84c8acb7":"### America","1a5242e3":"## South Asia","ba6f5cc3":"### Russia","eb6bb90e":"Most common tags","8e44d1a0":"## Western Europe","c133c0c2":"Some examples","f41ab91e":"Japanese Culture focuses a lot on nature as well. It includes paintings of flowers, trees and birds. There are also paintings of humans, boats and water. This represents the importance of the sea and water to the island nation. There are several utilitarian objects like dishes and vases as well as ornamentory items like models of animals like dogs. There are many manuscripts, poems and other forms of writing.","84d0c97e":"### Specify constants","3fcaa3cc":"### Conclusion\nSoutheast Asian cultures generally include several ancient utilitarian objects like boxes, pots, jugs etc and each country has its own signature style when it comes to these things. In Japan, paintings and writings are more common, whereas in Thailand, utilitarian objects and religious sculptures of Hindu gods and Buddha are more common. Also, Japanses culture tends to put more focus on nature.","b33b56f7":"### Load images from the selected rows","bc4285fa":"### Please post your feedback and suggestions in the comments.","e59bb76f":"### Italy","9e677621":"Most common tags","9a2788d0":"Most common tags","f3794d83":"Most common tags","218739d8":"German cultural objects focus mainly on humans (men and women) and nature (flowers) as well. But, **the main difference between German cultural objects and other Western European objects is that German objects tend to focus more on books than paintings or textiles. German objects also focus on religion, with references to Christ, St. Jermone etc.**","f9b93612":"Most common tags","df772ea5":"Spanish culture also includes paintings (like French culture), but more often, you would find textile fragments, accessories and other things related to fashion and clothing. The Spanish paintings mainly focus on humans (men and women) and nature (flowers and leaves), similar like French culture.","0096013d":"### China","646a33c1":"### France","e27a669e":"Some examples","7678518c":"## Introduction\n### In this kernel, I will explore the types of objects associated with each culture and talk about the similarities and differences between cultures. I will group different cultures based on their geographic locations and analyze each one separately.","dfdabb86":"Some examples","a4009518":"Unlike Indian Culture, Chinese Culture seems to foucs more on nature (in the form of birds and flowers) and utilitarian objects than religion. It consists of short tapestries and papers containing poems and other writings. There are several utilitarian objects like dishes, vases and especially bottles. There is also the mythical dragon involved in several pieces of art and utilitarian objects.","14348d3d":"Some examples","63351b56":"### Spain","b8514707":"Some examples","4d080914":"Similar to Vietnamese Culture, Thai Culture includes jewellery and metal carvings of Buddha. There are also several utilitarian objects like tea pots and boxes and ornaments like necklaces.","b1cef848":"## Culture Analysis","18bd9908":"## Southeast Asia","722e4eca":"Some examples","1b1f42fb":"Most common tags","132feb88":"### Conclusion\nIn general, Western European cultures focus on daily human life and nature. But, some countries' cultures, like Germany and Italy tend to focus more on religion, spirituality and mythical creatures compared to France and Spain. ","38f84175":"### India","afa231d6":"Some examples","0b6787bb":"### Create dictionary for cultures and tags","60022faf":"### Iran","408acf35":"Some examples","b98ea398":"Italian cultural objects consist mainly of paintings involving men, women and nature (like France) and textile fragments (like Spain), but **the key difference is that Italian cultural objects (paintings and textiles) tend to have more religious and spiritual references than their Italian and Spanish counterparts. These references include saints, mythical creatures like Cupid etc.**","fff66272":"Irani culture mainly focuses on animals, such as rams, sphinxes etc. They are generally objects depicting these animals. Irani culture also includes small objects like pins, beads and fragments of antique vases. "}}