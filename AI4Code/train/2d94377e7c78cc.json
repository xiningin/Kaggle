{"cell_type":{"3e64d3bd":"code","61ada3fd":"code","c9aff8ca":"code","208b31b4":"code","46f3a964":"code","49cd0e05":"code","01da1d08":"code","8062e92f":"code","43016a19":"code","1a56aba0":"code","b2bece9c":"code","03847c95":"code","ba41923b":"code","3f169eba":"code","a471e87b":"code","b48db5dc":"code","e1a0816a":"code","9c124404":"code","ebbcccb1":"code","f86a1c9f":"code","77d78085":"code","96797bbc":"code","a710bf04":"code","f8d77692":"code","70cf24e1":"code","ce381c2c":"code","e9496d62":"code","813e0ddb":"code","ba849ad7":"code","b94282c0":"code","cc08c1d3":"code","f902df8a":"code","b2a1d06d":"code","eadc7572":"code","9410d6b9":"code","eb5a6aaf":"code","b65682e9":"code","26c90dd6":"markdown","cd91ea76":"markdown","8aa9281a":"markdown","dbd29eb7":"markdown","fd7c881f":"markdown","450b5aa1":"markdown","de9c6b9d":"markdown","83459d03":"markdown","29427b06":"markdown","0c0455fb":"markdown","406509d5":"markdown"},"source":{"3e64d3bd":"import numpy as np\nimport pandas as pd\nimport plotly.express as px\nimport seaborn as sns\nimport matplotlib.pyplot as plt","61ada3fd":"df = pd.read_csv('..\/input\/student-grade-prediction\/student-mat.csv')","c9aff8ca":"df_prediction = df[['absences','Walc','goout','health','internet','romantic','studytime','freetime','G1', 'G2', 'G3']]\ndf_prediction.head()","208b31b4":"dummies = pd.get_dummies(df_prediction[['internet','romantic']])\ndummies","46f3a964":"df_prediction.pop('internet')\ndf_prediction.pop('romantic')","49cd0e05":"df_prediction = pd.concat([df_prediction,dummies],axis=1)\ndf_prediction.head()","01da1d08":"df_target = df_prediction['G3']\ndf_prediction.drop('G3',axis=1,inplace=True)\n","8062e92f":"df_prediction","43016a19":"import tensorflow as tf","1a56aba0":"from sklearn.model_selection import train_test_split","b2bece9c":"X_train, X_test, y_train, y_test = train_test_split(df_prediction, df_target, random_state = 42)","03847c95":"X_train.shape","ba41923b":"tf.random.set_seed(42)\nmodel = tf.keras.models.Sequential()\nmodel.add(tf.keras.layers.Dense(10,input_shape=(296,12),activation='relu'))\nmodel.add(tf.keras.layers.Dense(20,activation='relu'))\nmodel.add(tf.keras.layers.Dense(20,activation='relu'))\nmodel.add(tf.keras.layers.Dense(20,activation='relu'))\nmodel.add(tf.keras.layers.Dense(20,activation='relu'))\nmodel.add(tf.keras.layers.Dense(1,activation='relu'))","3f169eba":"model.compile(\noptimizer = 'Adam',\nloss = 'MAE',\nmetrics= 'accuracy')","a471e87b":"model.fit(X_train,y_train, epochs = 100)","b48db5dc":"prediction = model.predict(X_test)","e1a0816a":"prediction = pd.DataFrame(prediction)\ny_test = pd.DataFrame(y_test)\nprediction.reset_index(inplace=True)\ny_test.reset_index(inplace=True)","9c124404":"comparison = pd.concat([prediction,y_test],axis=1)\n","ebbcccb1":"comparison.pop('index')\n","f86a1c9f":"comparison.columns= ['prediction', 'real']\ncomparison","77d78085":"comparison['error'] = abs(comparison['real']- comparison['prediction'])\ncomparison","96797bbc":"comparison['error'].mean()","a710bf04":"fig = px.pie(query,values = query.groupby('romantic').size(), names = ['no','yes'], title = 'N\u00famero de estudantes em um relacionamento com nota superior a 15' ,color_discrete_sequence = px.colors.sequential.amp)\nfig.show()","f8d77692":"query_20 = df.query('absences > 20')\nquery_20","70cf24e1":"query_10 = df.query('absences < 10')\nquery_10","ce381c2c":"\nplt.figure(figsize=(16,14))\nplt.title('Distribui\u00e7\u00e3o de faltas dos alunos',fontsize = 22)\nsns.histplot(df['absences'],kde=True)\nplt.show()","e9496d62":"from scipy.stats import median_absolute_deviation as MAD","813e0ddb":"print(\" Menor ou igual a 10 faltas: {} Mais que 20 faltas: {}\".format(MAD(query_10['G3']),MAD(query_20['G3'])))","ba849ad7":"query_20['G3'].mean()","b94282c0":"query_10['G3'].mean()","cc08c1d3":"query_estudo1 = df.query('studytime == 1')\nquery_estudo2 = df.query('studytime == 2')\nquery_estudo3 = df.query('studytime == 3')\nquery_estudo4 = df.query('studytime == 4')","f902df8a":"query_estudo1['G3'].median()","b2a1d06d":"query_estudo2['G3'].median()","eadc7572":"query_estudo3['G3'].median()","9410d6b9":"query_estudo4['G3'].median()","eb5a6aaf":"estudo = {'horas':[1,2,3,4],\"mediana\":[10,11,12,12]}\nestudo = pd.DataFrame.from_dict(estudo)\nestudo","b65682e9":"\n\nax =sns.barplot(x =estudo['horas'],y = estudo['mediana'],palette='crest',)\nax.set_xlabel('tempo de estudo')","26c90dd6":"# Criando o Modelo","cd91ea76":"# Vamos analisar a varia\u00e7\u00e3o das notas de cada subconjunto","8aa9281a":"# MAE = 0.8142 durante a fase de treino","dbd29eb7":"# Vamos Analisar como algumas vari\u00e1veis influenciam no subconjunto de alunos que tiraram notas superiores a 15\/20","fd7c881f":"# Colunas ( Dados obtidos do site)\n* school - student's school (binary: 'GP' - Gabriel Pereira or 'MS' - Mousinho da Silveira)\n* sex - student's sex (binary: 'F' - female or 'M' - male)\n* age - student's age (numeric: from 15 to 22)\n* address - student's home address type (binary: 'U' - urban or 'R' - rural)\n* famsize - family size (binary: 'LE3' - less or equal to 3 or 'GT3' - greater than 3)\n* Pstatus - parent's cohabitation status (binary: 'T' - living together or 'A' - apart)\n* Medu - mother's education (numeric: 0 - none, 1 - primary education (4th grade), 2 \u00e2\u20ac\u201c 5th to 9th grade, 3 \u00e2\u20ac\u201c secondary education or 4 \u00e2\u20ac\u201c higher education)\n* Fedu - father's education (numeric: 0 - none, 1 - primary education (4th grade), 2 \u00e2\u20ac\u201c 5th to 9th grade, 3 \u00e2\u20ac\u201c secondary education or 4 \u00e2\u20ac\u201c higher education)\n* Mjob - mother's job (nominal: 'teacher', 'health' care related, civil 'services' (e.g. administrative or police), 'at_home' or 'other')\n* Fjob - father's job (nominal: 'teacher', 'health' care related, civil 'services' (e.g. administrative or police), 'at_home' or 'other')\n* reason - reason to choose this school (nominal: close to 'home', school 'reputation', 'course' preference or 'other')\n* guardian - student's guardian (nominal: 'mother', 'father' or 'other')\n* traveltime - home to school travel time (numeric: 1 - <15 min., 2 - 15 to 30 min., 3 - 30 min. to 1 hour, or 4 - >1 hour)\n* studytime - weekly study time (numeric: 1 - <2 hours, 2 - 2 to 5 hours, 3 - 5 to 10 hours, or 4 - >10 hours)\n* failures - number of past class failures (numeric: n if 1<=n<3, else 4)\n* schoolsup - extra educational support (binary: yes or no)\n* famsup - family educational support (binary: yes or no)\n* paid - extra paid classes within the course subject (Math or Portuguese) (binary: yes or no) \n* activities - extra-curricular activities (binary: yes or no)\n* nursery - attended nursery school (binary: yes or no)\n* higher - wants to take higher education (binary: yes or no)\n* internet - Internet access at home (binary: yes or no)\n* romantic - with a romantic relationship (binary: yes or no)\n* famrel - quality of family relationships (numeric: from 1 - very bad to 5 - excellent)\n* freetime - free time after school (numeric: from 1 - very low to 5 - very high)\n* goout - going out with friends (numeric: from 1 - very low to 5 - very high)\n* Dalc - workday alcohol consumption (numeric: from 1 - very low to 5 - very high)\n* Walc - weekend alcohol consumption (numeric: from 1 - very low to 5 - very high)\n* health - current health status (numeric: from 1 - very bad to 5 - very good)\n* absences - number of school absences (numeric: from 0 to 93)","450b5aa1":"# apesar de ambas as m\u00e9dias serem pr\u00f3ximas, podemos verificar que a m\u00e9dia do conjunto de alunos com falta superior a 20 dias descreve melhor a realidade, j\u00e1 que o desvio m\u00e9dio mediano \u00e9 menor","de9c6b9d":"# Preparando os Dados","83459d03":"# Carregando os Dados","29427b06":"# Importando Bibliotecas\n","0c0455fb":"# Por \u00faltimo, \u00e9 poss\u00edvel analisar uma rela\u00e7\u00e3o de aumento da mediana das notas com o aumento do tempo de estudo","406509d5":"# Erro M\u00e9dio Absoluto = 1.19"}}