{"cell_type":{"d15c320c":"code","89c6970d":"code","34303502":"code","b4017862":"code","a97ec628":"code","ba7a2ee7":"code","ba5e8457":"code","c05537f5":"code","bbda8ff5":"code","8c65492b":"markdown","b24593c1":"markdown","32d1a055":"markdown","1bd3d2bd":"markdown","30796c88":"markdown","80aa4818":"markdown","8e6c942e":"markdown","467ecb06":"markdown","02824d70":"markdown"},"source":{"d15c320c":"!pip install mglearn\nimport re\nimport numpy as np\nimport pandas as pd\nimport sklearn as sk\nfrom sklearn.feature_extraction.text import CountVectorizer\nfrom sklearn.decomposition import LatentDirichletAllocation\nimport mglearn\nimport matplotlib.pyplot as plt","89c6970d":"tweet_df = pd.read_csv('..\/input\/auspol2019.csv')","34303502":"tweet_df.head(5)","b4017862":"tweet_df['full_text2'] = tweet_df['full_text'].map(lambda x: re.sub('[,\\.!?]', '', x))                                       # remove ,.!?\ntweet_df['full_text2'] = tweet_df['full_text2'].map(lambda x: re.sub('#[A-Za-z0-9]+', '', x))                       # remove hashtag\ntweet_df['full_text2'] = tweet_df['full_text2'].map(lambda x: re.sub('https:\/\/t.co\/[A-Za-z0-9]+', '', x))  # remove link\n\n\nvect = CountVectorizer(max_features=100, max_df=.15, stop_words='english')\nX = vect.fit_transform(tweet_df[\"full_text2\"])\n\ntopics =2\nlda = LatentDirichletAllocation(n_components = topics, learning_method=\"batch\", max_iter=5, random_state=0)\ndocument_topics = lda.fit_transform(X)\nsorting = np.argsort(lda.components_, axis=1)[:, ::-1]\nfeature_names = np.array(vect.get_feature_names())\nmglearn.tools.print_topics(topics=range(topics), feature_names=feature_names, sorting=sorting, topics_per_chunk=5, n_words=10)","a97ec628":"topic_df = pd.DataFrame(document_topics, columns=['topic0', 'topic1'])\ntweet_df = pd.concat([tweet_df.reset_index(drop=True), topic_df.reset_index(drop=True)],axis =1)\ntweet_df[\"topic_diff\"] = tweet_df['topic1']-tweet_df['topic0']\ntweet_df.head()","ba7a2ee7":"plt.hist(tweet_df['topic_diff'], 20)\nplt.xlabel(\"<--- Scott Morrison    Bill Shorten -->        \")\nplt.show()","ba5e8457":"tweet_df.describe(percentiles=[.95, .99, .999])","c05537f5":"th99 = 1224\n\ntweet0 = tweet_df.query('topic_diff < -0.75 & favorite_count > ' +str(th99))\n\ntw0= tweet0['full_text'].values\n\nfor tw in tw0:\n    print('\\n' + tw.replace('\\n', ' '))\n","bbda8ff5":"tweet1 = tweet_df.query('topic_diff > 0.75 & favorite_count > ' + str(th99))\ntw1= tweet1['full_text'].values\n\nfor tw in tw1:\n    print('\\n' + tw.replace('\\n', ' '))","8c65492b":"#### Favored tweets related to Bill Shorten","b24593c1":"### See the distribution\n\n","32d1a055":"### Summary\n\nWe can see the characteristics of these opinions as follows.\n\n- There are a lot of emotional messages, rather than news contents conveying objective information.\n- They can be divided into the following three categories.\n  1. Joy in the victory\n  1. Grudge or anger at the defeat\n  1. Encouragement for voting","1bd3d2bd":"### Execute topic modeling\n\nDivide tweets into two topic groups by topic modeling.","30796c88":"### What did they say in their popular tweets related to Scott Morrison and Bill Shorten?\n\nWe are going to check tweets meeting the following conditions.\n- They have a lot of favorite counts (over 99.9 percentile (=1224)).\n- Their topics are about either Scott Morrison (topic score < .75) or Bill Shorten (topic score > .75).\n\n#### Favored tweets related to Scott Morrison","80aa4818":"- It seems that the distribution has three peaks; Scott Morrison topics(-.75 to -.50), neutral topics (around 0.0), Bill Shoren topics(.50 to .75)\n\n### Check the percentiles","8e6c942e":"### Summary of results\n\n- The two major topics are about two leaders, Scott Morrison and Bill Shorten (as exptected).\n- One of the most interested topics related to Bill Shorten seems climate changes.\n\n### Calculate topic score for each tweet\n\n- Score = Topic1(Bill Shorten) - Topic0(Scott Morrison)\n- Tweets related to topics of Bill Shorten have scores close to 1, while Scott Morrison topics have scores close to -1.\n- Neutral topics have scores close to zero.","467ecb06":"### Read tweet data","02824d70":"# Topic modeling for tweets on election"}}