{"cell_type":{"b8e521c9":"code","d9bfa9d5":"code","2566c68f":"code","d4fd174c":"code","ba58bd6d":"code","5982417d":"code","777e832d":"code","fc0838b9":"code","e1621a29":"code","7a6f86af":"code","a068a9ad":"code","a228dbce":"code","e04ec508":"code","162e4ba1":"markdown","bd2858ed":"markdown","a65a4f13":"markdown","3f4eefc5":"markdown","489a53e7":"markdown"},"source":{"b8e521c9":"import pandas as pd\nimport numpy as np\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import accuracy_score","d9bfa9d5":"df = pd.read_csv(\"..\/input\/breast-cancer-wisconsin-data\/data.csv\")  #read in the data\ndf","2566c68f":"df.columns","d4fd174c":"X = df[['radius_worst', 'texture_worst',\n       'perimeter_worst', 'area_worst', 'smoothness_worst',\n       'compactness_worst', 'concavity_worst', 'concave points_worst',\n       'symmetry_worst', 'fractal_dimension_worst']]\nX #features dataframe","ba58bd6d":"y = df.diagnosis.map({\"M\":1, \"B\":0})\ny #labels","5982417d":"#split into training set and testing set\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=1, stratify=y)","777e832d":"from sklearn.neighbors import KNeighborsClassifier\nknn = KNeighborsClassifier(n_neighbors = 3)\nknn.fit(X_train, y_train)","fc0838b9":"knn.predict(X_test)","e1621a29":"knn.score(X_test, y_test)","7a6f86af":"from sklearn.model_selection import cross_val_score\n\nknn_cv = KNeighborsClassifier(n_neighbors=3)\ncv_scores = cross_val_score(knn_cv, X, y, cv=5)\nprint(cv_scores)\nprint(\"cv_scores mean:{}\".format(np.mean(cv_scores)))","a068a9ad":"from sklearn.model_selection import GridSearchCV\nknn = KNeighborsClassifier()\n\n#create a dictionary of all values we want to test for n_neighbors\nparam_grid = {\"n_neighbors\": np.arange(1, 25)}\n\n#use gridsearch to test all values for n_neighbors\nknn_gscv = GridSearchCV(knn, param_grid, cv=5)\n\n#fit model to data\nknn_gscv.fit(X, y)","a228dbce":"#check top performing n_neighbors value\nknn_gscv.best_params_","e04ec508":"#check mean score for the top performing value of n_neighbors\nknn_gscv.best_score_","162e4ba1":"# Hypertuning model parameters using GridSearchCV","bd2858ed":"# KNN","a65a4f13":"# KNN with k-fold Cross Validation","3f4eefc5":"modeled after Eijaz Allibhai's article:\nhttps:\/\/towardsdatascience.com\/building-a-k-nearest-neighbors-k-nn-model-with-scikit-learn-51209555453a","489a53e7":"![image.png](attachment:image.png)\n\n5 fold cross validation"}}