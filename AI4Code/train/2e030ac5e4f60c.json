{"cell_type":{"1f76b84a":"code","39bccff5":"code","7e29c59a":"code","982a6167":"code","33c2c38e":"code","1b1dce54":"code","08d32ef2":"code","994afe18":"code","89dc3ff6":"code","4f752178":"code","5f9532f3":"code","915dff83":"code","63dcd143":"code","ec81a9ae":"code","bbca2e34":"code","d83d97f3":"code","b77c7014":"code","41e14bc4":"code","f911f790":"code","94c4a238":"code","79f9f8db":"code","b3791912":"code","5b850707":"code","f0f71e35":"code","8054d13c":"code","5328e808":"code","48c40d36":"code","51fd1bd0":"code","2313bca8":"code","8365ea2f":"code","eae6a95b":"code","d550f7a9":"code","5501d350":"code","4d615e9c":"code","43800b70":"code","088b1771":"code","992453a0":"code","dad96860":"code","d0ae25b8":"code","6a7caa11":"code","a57d3224":"code","8c46bd41":"code","6a1e94d2":"markdown","6009d5f7":"markdown","969504ee":"markdown","707542f7":"markdown","323eeb6e":"markdown","259866e6":"markdown","76de53f1":"markdown","465cb459":"markdown","4e37c9f2":"markdown","f17bca67":"markdown","ea130f39":"markdown","3df4c4dc":"markdown"},"source":{"1f76b84a":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline","39bccff5":"df=pd.read_csv('..\/input\/titanic\/train.csv')","7e29c59a":"df.head()","982a6167":"df.shape","33c2c38e":"df.info()","1b1dce54":"df.describe()","08d32ef2":"df.corr()['Survived'].sort_values()","994afe18":"sns.pairplot(df,hue='Survived')","89dc3ff6":"sns.scatterplot(data=df, x='Survived', y='Fare',color='y')\nplt.axhline(y=300,color='r')","4f752178":"index_drop=df[(df['Fare']>300)].index\ndf=df.drop(index_drop, axis=0)","5f9532f3":"sns.scatterplot(data=df, x='Survived', y='Parch',color='g')","915dff83":"sns.scatterplot(data=df, x='Survived', y='SibSp',color='b')\nplt.axhline(y=5,color='r')","63dcd143":"index_drop=df[(df['SibSp']>5)].index\ndf=df.drop(index_drop, axis=0)","ec81a9ae":"sns.scatterplot(data=df, x='Survived', y='Age',color='#03fce3')\nplt.axhline(y=75,color='r')","bbca2e34":"index_drop=df[(df['Age']>75)].index\ndf=df.drop(index_drop, axis=0)","d83d97f3":"sns.scatterplot(data=df, x='Survived', y='Pclass',color='#d119cb')","b77c7014":"sns.scatterplot(data=df, x='Survived', y='PassengerId',color='#19d166')","41e14bc4":"def missing_percent(df):\n    nan_percent=(df.isnull().sum()\/len(df))*100\n    nan_percent=nan_percent[nan_percent>0].sort_values()\n    return nan_percent\nnan_percent=missing_percent(df)\nsns.barplot(x=nan_percent.index,y=nan_percent)","f911f790":"df[df['Embarked'].isnull()]","94c4a238":"df= df.dropna(axis=0, subset=['Embarked'])","79f9f8db":"df=df.drop('Cabin',axis=1 )","b3791912":"df.corr()['Age'].sort_values()","5b850707":"df.groupby('Pclass')['Age'].mean()","f0f71e35":"df['Age']=df.groupby('Pclass')['Age'].transform(lambda val: val.fillna(val.mean()))","8054d13c":"df.columns","5328e808":"df_num= df[['Survived','Pclass','Age','SibSp','Parch','Fare']]\ndf_obj= df[['Sex','Embarked']]","48c40d36":"df_obj= pd.get_dummies(df_obj, drop_first=True)","51fd1bd0":"Final_df= pd.concat([df_num, df_obj], axis=1)\nFinal_df.shape","2313bca8":"Final_df.isnull()","8365ea2f":"df=Final_df","eae6a95b":"df.head()","d550f7a9":"X= df.drop('Survived', axis=1)\ny= df['Survived']","5501d350":"from sklearn.model_selection import train_test_split","4d615e9c":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=101)","43800b70":"from sklearn.preprocessing import StandardScaler\nscaler= StandardScaler()\nscaler.fit(X_train)\nscaled_X_train= scaler.transform(X_train)\nscaled_X_test= scaler.transform(X_test)","088b1771":"from sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.metrics import classification_report, confusion_matrix, accuracy_score\ntest_error_rate= []\nfor k in range (1, 30):\n    knn_model = KNeighborsClassifier(n_neighbors=k)\n    knn_model.fit(scaled_X_train, y_train)\n    \n    y_pred_test = knn_model.predict(scaled_X_test)\n    \n    test_error=1- accuracy_score(y_test, y_pred_test)\n    test_error_rate.append(test_error)","992453a0":"test_error_rate","dad96860":"plt.figure(figsize=(10, 6))\nplt.plot(range(1, 30), test_error_rate, label='Test Error')\nplt.legend()\nplt.ylabel('Error Rate')\nplt.xlabel('K Value')","d0ae25b8":"scaler= StandardScaler()\nknn= KNeighborsClassifier()\nknn.get_params().keys()\noperations= [('scaler', scaler), ('knn', knn)]\nfrom sklearn.pipeline import Pipeline\npipe= Pipeline(operations)\nfrom sklearn.model_selection import GridSearchCV\nk_values= list(range(1, 20))\nparam_grid= {'knn__n_neighbors': k_values}\nfull_cv_classifier= GridSearchCV(pipe, param_grid, cv=5, scoring='accuracy')\nfull_cv_classifier.fit(X_train, y_train)","6a7caa11":"full_cv_classifier.best_estimator_.get_params()","a57d3224":"full_cv_classifier.cv_results_.keys()","8c46bd41":"from sklearn.neighbors import KNeighborsClassifier\nknn12= KNeighborsClassifier(n_neighbors=12)\noperations= [('scaler', scaler), ('knn12', knn12)]\npipe= Pipeline(operations)\npipe.fit(X_train, y_train)\npipe_pred= pipe.predict(X_test)\nprint(classification_report(y_test, pipe_pred))","6a1e94d2":"# **Step8:Scaling the Features**","6009d5f7":"# **Step7:Split to Train & test**","969504ee":"# Step4: EDA","707542f7":"# **Step6:Features&Label**","323eeb6e":"# **Step5: Data Preperation**","259866e6":"# **Step9:Choosing K Values**","76de53f1":"**9-2: Pipeline for finding K valu**","465cb459":"# Step1:Import Libraries ","4e37c9f2":"**9-1:Elbow Method for Choosing K Values**","f17bca67":"# **Step10: Train the Model\/Predicting\/Evaluating**","ea130f39":"# Step2:Read  Dataset","3df4c4dc":"# Step3:Data Overview "}}