{"cell_type":{"6c81e50a":"code","718bae63":"code","98924185":"code","8a29da7a":"code","b29dea15":"code","a5f908dc":"code","6919b713":"code","8a0c6b6b":"code","71750c90":"code","2b80224b":"code","6dbba870":"code","e4014e93":"code","01e14823":"code","23b6b035":"code","0c0430f5":"code","33bbc4ec":"code","2b2003c9":"code","4a1f01f9":"code","4a1565fb":"code","a067c84e":"code","1d298edb":"markdown","a4dd74c6":"markdown","ba4b0d2d":"markdown","71f31a09":"markdown","7de029bf":"markdown","dbd2169f":"markdown","0cf08ea3":"markdown","15ed5ad8":"markdown","5a411c18":"markdown","3ef4d3a5":"markdown","2b23361b":"markdown","8d3a0d3b":"markdown","55b5fc52":"markdown","8175f2e2":"markdown","29b0c3b2":"markdown","846592e1":"markdown","a4c00fe0":"markdown","c3d45643":"markdown"},"source":{"6c81e50a":"# Import Libraries\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\nsns.set_style('darkgrid')","718bae63":"# Load the training and test data\ntrain = pd.read_csv(\"..\/input\/30-days-of-ml\/train.csv\", index_col=0)\ntest = pd.read_csv(\"..\/input\/30-days-of-ml\/test.csv\", index_col=0)","98924185":"# look at a few rows\ndisplay(train.head())\ndisplay(train.tail())","8a29da7a":"# rows, columns\ntrain.shape","b29dea15":"# basic information\ntrain.info()","a5f908dc":"test.info()","6919b713":"train.index[:50]","8a0c6b6b":"test.index[:50]","71750c90":"train.describe()","2b80224b":"train.describe(include=['object'])","6dbba870":"cat_columns = [col for col in train.columns if 'cat' in col]\nnum_columns = [col for col in train.columns if 'cont' in col]","e4014e93":"for col in cat_columns:\n    print(f'Column Name: {col}')\n    print(sorted(train[col].unique()))\n    print(f'Unique values: {train[col].nunique()}')\n    print()","01e14823":"sns.displot(x='target', data=train)\nplt.show()","23b6b035":"sns.displot(x='target', binrange=(6,11), data=train)\nplt.show()","0c0430f5":"sns.displot(x='target', kind='ecdf', data=train)\nplt.show()","33bbc4ec":"# plot class distributions\nfor col in cat_columns:\n    sns.countplot(y=col, data=train)\n    plt.show()","2b2003c9":"# plot scatterplots for numerical columns vs target variable\nfor col in num_columns:\n    sns.scatterplot(x=col, y='target', data=train, alpha=0.2)\n    plt.axhline(train.target.mean(),color='r',linestyle='dashed',linewidth=2)\n    plt.show()","4a1f01f9":"for col in cat_columns:\n    display(train.groupby(col).mean())","4a1565fb":"# histograms of all numerical columns\ntrain.hist(figsize=(10,10), column=num_columns)\nplt.show()","a067c84e":"# heatmap of correlations\ncorrelations = train.corr()\nmask = np.zeros_like(correlations)\nmask[np.triu_indices_from(mask)] = 1\n\nsns.set_style('white')\nplt.figure(figsize=(9,8))\nsns.heatmap(correlations * 100,\n            cmap='RdBu_r',\n           annot=True,\n           fmt='.0f',\n           mask=mask,\n           cbar=False)\nplt.show()","1d298edb":"Let's take a look at the cumulative distribution:","a4dd74c6":"#### 3. Exploratory Analysis","ba4b0d2d":"Let's see if the mean of the numerical columns varies with the different classes of the categorical columns:","71f31a09":"Correlations are not too high for any of the columns. We can see that **cont1**, and **cont13** are completely uncorrelated to the rest. Most importantly, **target** seems to have no correlation to the numerical variables..","7de029bf":"Now let's look at the distribution of our **target** variable:","dbd2169f":"I think that the Kaggle team created a synthetic dataset of 500,000 rows, and then split it randomly between train and test. 300,000 rows (60%) for train and 200,000 (40%) for test.\n\nLet's look at the distribution of the numeric columns:","0cf08ea3":"Let's get the histograms of all the numercial columns:","15ed5ad8":"And now at the distribution of the categorical columns:","5a411c18":"## 30 Days of ML Exploratory Data Analysis\n\nBefore trying different algorithms, I will explore the dataset to get a feel for the features, their distribution, etc","3ef4d3a5":"#### 1. Library Imports","2b23361b":"#### 2. Import Data","8d3a0d3b":"We can see that **cat4**, **cat6**, and **cat7** are almost just one class. That could be interesting information.\n\nMy next step is to create boxplots for the numerical columns vs the target variable.","55b5fc52":"We can make a mental note to possibly exclude *cat9* from one_hot encoding because of its high cardinality.\n\nLet's create separate list of categorical and numeric columns:\n","8175f2e2":"Let's look at the unique values in the categorical columns:","29b0c3b2":"Let's zoom in from 6 to 11:","846592e1":"It is interesting that the **index** goes from 1 to 499,999","a4c00fe0":"What about the distributions of the categorical columns:","c3d45643":"Let's make a heatmap of the correlations between the numerical columns:"}}