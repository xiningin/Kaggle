{"cell_type":{"ed6cf637":"code","d08d382b":"code","e5478a60":"code","77704da4":"code","9291ae3d":"code","c3acf9ed":"code","e5eab942":"code","6bf3f40d":"code","271c23cc":"code","2edbaf0b":"code","f4044279":"code","7ae4b12b":"code","a0549331":"code","561e400f":"code","d21e8e01":"code","c8b06bfc":"code","f1ac468d":"code","b2a32939":"code","fe835bff":"code","7005dc7b":"code","5493df79":"code","6517c01c":"code","ac18f516":"code","3f28ce33":"code","34819eb0":"code","84708054":"code","6222e837":"code","a4de00bb":"code","8afe1fbd":"code","5397b25f":"code","77bec142":"code","de9ecd29":"code","e0ecb1e5":"code","51f31683":"code","a1ed33d1":"code","35e76fb5":"code","5a28aeab":"code","75c27877":"code","4632e907":"code","dde9954c":"code","e3b4e850":"code","3c73cfa6":"code","43771bae":"code","812e6d5e":"code","a8a5ec0b":"code","3c9d586d":"code","6e12503a":"code","db1eb503":"code","7cd20c89":"code","ebbc85a4":"code","1be595ad":"code","099a4011":"markdown","b5c926c6":"markdown","fb5d9ca0":"markdown","aa7f3f5d":"markdown","f2deae8e":"markdown","9160124e":"markdown"},"source":{"ed6cf637":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","d08d382b":"df=pd.read_csv('\/kaggle\/input\/wine-quality\/winequalityN.csv')\ndf\n","e5478a60":"df.quality.value_counts()","77704da4":"df.quality.unique()","9291ae3d":"df.isna().sum()","c3acf9ed":"df['volatile acidity'].fillna(value=0.339691,inplace=True)\ndf['pH'].fillna(value=3.218395,inplace=True)\ndf['fixed acidity'].fillna(value=7.000000,inplace=True)\ndf['sulphates'].fillna(value=0.510000,inplace=True)\ndf.drop(['citric acid','residual sugar','chlorides'],axis=1,inplace=True)","e5eab942":"a=[2,6,9]\nlabel=['bad','good']\ndf['quality']=pd.cut(df['quality'],bins=a,labels=label)","6bf3f40d":"df.head()","271c23cc":"df.quality.value_counts()","2edbaf0b":"from sklearn.preprocessing import LabelEncoder\nlabelencoder_target=LabelEncoder()\ndf['quality']=labelencoder_target.fit_transform(df['quality'])","f4044279":"df.quality.head(15)","7ae4b12b":"df.describe()","a0549331":"corr=df.corr()","561e400f":"import seaborn as sns\nimport matplotlib.pyplot as plt\nplt.figure(figsize=[23,23])\nsns.heatmap(df.corr(),annot=True)","d21e8e01":"sns.countplot('quality',data=df)","c8b06bfc":"sns.barplot(x='quality',y='alcohol',data=df)","f1ac468d":"f,(axes,sa)= plt.subplots(1,2,figsize=(16,5))\nsns.distplot(df['fixed acidity'],ax=sa)\nsns.violinplot(x='quality',y='fixed acidity',data=df,hue=df['quality'],ax=axes)","b2a32939":"f,axes=plt.subplots(1,2,figsize=(16,6))\nsns.distplot(df['volatile acidity'],ax=axes[0])\nsns.violinplot(x='quality',y='volatile acidity',data=df,hue=df['quality'],ax=axes[1])","fe835bff":"f,axes=plt.subplots(2,2,figsize=(16,5))\nsns.distplot(df['alcohol'],ax=axes[0,0])\nsns.violinplot(x='quality',y='alcohol',data=df,ax=axes[0,1])\nsns.distplot(df['sulphates'],ax=axes[1,0])\nsns.violinplot(x='quality',y='sulphates',data=df,ax=axes[1,1])","7005dc7b":"df.drop(['density','volatile acidity'],axis=1,inplace=True)","5493df79":"df=pd.get_dummies(df,columns=['type'],drop_first=True)","6517c01c":"df","ac18f516":"y=df.quality\ny=y.values.reshape(-1,1)\ny","3f28ce33":"\nX=df.drop('quality',axis=1).values\nX","34819eb0":"X,y","84708054":"from sklearn.model_selection import train_test_split\nX_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.25)","6222e837":"X_train.shape","a4de00bb":"from sklearn.preprocessing import StandardScaler\nsc=StandardScaler()\nsc.fit_transform(X,y)","8afe1fbd":"from sklearn.linear_model import LogisticRegression\nclf=LogisticRegression()\nclf.fit(X_train,y_train.ravel())","5397b25f":"from sklearn.model_selection import cross_val_score\ncross_val_score(estimator=clf,X=X_train,y=y_train.ravel(),cv=7)","77bec142":"from sklearn.metrics import accuracy_score\ny_pred_train=clf.predict(X_train)\naccuracy_score(y_train,y_pred_train)","de9ecd29":"from sklearn.metrics import accuracy_score\ny_pred_test=clf.predict(X_test)\naccuracy_score(y_test,y_pred_test)","e0ecb1e5":"from sklearn.metrics import confusion_matrix\nconfusion_matrix(y_test,y_pred_test)","51f31683":"from sklearn.ensemble import RandomForestClassifier\nclf_rand=RandomForestClassifier(n_estimators=500,criterion='entropy',max_features=6,max_depth=10,random_state=42)\nclf_rand.fit(X_train,y_train.ravel())","a1ed33d1":"cross_val_score(estimator=clf_rand,X=X_train,y=y_train.ravel(),cv=7).mean()","35e76fb5":"y_pred_train=clf_rand.predict(X_train)\naccuracy_score(y_train,y_pred_train)\n","5a28aeab":"y_pred_test=clf_rand.predict(X_test)\naccuracy_score(y_test,y_pred_test)","75c27877":"confusion_matrix(y_test,y_pred_test)","4632e907":"from sklearn.model_selection import GridSearchCV\nrandom_classifier = RandomForestClassifier()\nparameters = { 'max_features':np.arange(4,7),'n_estimators':[58],'min_samples_leaf': [5,10,15],'criterion':['entropy']}\nrandom_grid = GridSearchCV(random_classifier, parameters, cv = 7)","dde9954c":"random_grid.fit(X_train,y_train.ravel())","e3b4e850":"random_grid.best_params_","3c73cfa6":"cross_val_score(estimator=random_classifier,X=X_train,y=y_train.ravel(),cv=7).mean()","43771bae":"random_grid.score(X_train,y_train)","812e6d5e":"y_pred_train=random_grid.predict(X_train)\naccuracy_score(y_train,y_pred_train)","a8a5ec0b":"y_pred_test=random_grid.predict(X_test)\naccuracy_score(y_test,y_pred_test)","3c9d586d":"confusion_matrix(y_test,y_pred_test)","6e12503a":"from sklearn.naive_bayes import GaussianNB\ncls_nb=GaussianNB()\ncls_nb.fit(X_train,y_train.ravel())","db1eb503":"cross_val_score(estimator=cls_nb,X=X_train,y=y_train.ravel(),cv=7).mean()","7cd20c89":"y_prd=cls_nb.predict(X_train)\naccuracy_score(y_train,y_prd)","ebbc85a4":"y_prd_ttest=cls_nb.predict(X_test)\naccuracy_score(y_test,y_prd_ttest)","1be595ad":"confusion_matrix(y_test,y_prd_ttest)","099a4011":"# LogisticRegression Classifier","b5c926c6":"# Naive Bayes","fb5d9ca0":"Feature  Scaling (Standard Scaler)","aa7f3f5d":"# RandomForestClassifier","f2deae8e":"# Feature Scaling","9160124e":"# Using HyperParameter Optimization(grid Search CV)"}}