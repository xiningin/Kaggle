{"cell_type":{"1f2e9d86":"code","30ec3943":"code","98fb8010":"code","0f86de4b":"code","40e1c7d5":"code","b5c14a0b":"code","205f20d4":"code","8448b8f1":"code","e364417c":"code","2d113015":"code","b23300d5":"code","808ebef5":"code","36952e08":"code","41abaf70":"markdown","7ea794f6":"markdown","23294d7c":"markdown","30aa7bac":"markdown","89ade987":"markdown","f4813cc5":"markdown","93aaee02":"markdown","6b30f21a":"markdown","5b9793d2":"markdown","2777a694":"markdown","349519bd":"markdown"},"source":{"1f2e9d86":"import scipy.linalg as ln\nimport numpy as np\nm, n = 2, 3\nn_diag = min(m, n)\n#Init normal standard random variable A with size (m, n)\nA = np.random.rand(m, n)\nU, S_diag, V = ln.svd(A)\n#Create diagonal matrix S based on diagonal\nS = np.zeros((n_diag, n_diag))\nnp.fill_diagonal(S, S_diag)\nif m > n:\n    S = np.concatenate((S, np.zeros((1, n))), axis = 0)\nelif m < n:\n    S = np.concatenate((S, np.zeros((m, 1))), axis = 1)\n        \nprint('Matrix A: \\n %s \\n'%A)\nprint('orthogonal matrix U: \\n %s \\n'%U)\nprint('Check Frobenius U^TU-I: \\n %s \\n'%ln.norm(np.dot(U.T,U)-np.eye(m, m), 'fro'))\nprint('orthogonal matrix V: \\n %s \\n'%V)\nprint('Check Frobenius V^TV-I: \\n %s \\n'%ln.norm(np.dot(V.T,V)-np.eye(n, n), 'fro'))\nprint('Diagonal matrix S: \\n %s \\n'%S_diag)\nprint('Matrix S: \\n %s \\n'%S)\nprint('Check Frobenius U.S.V - A: \\n %s \\n'%ln.norm(np.dot(U, S.dot(V))-A,'fro'))","30ec3943":"import numpy as np\nimport matplotlib.pyplot as plt\n%matplotlib inline\n\nn = 100\nx = np.arange(n)\n\n# add 1 column in the last of X to create X matrix\nX = np.concatenate((x.reshape(n, 1), np.ones((n, 1))), axis = 1)\ny = np.random.randn(n)*10 + 2*x\nplt.plot(x, y)","98fb8010":"# Calculate matrix A, b\nA = np.dot(X.T, X)\nb = np.dot(X.T, y)\n\n# Matrix factorization SVD \nU, S_diag, V = np.linalg.svd(A)\nS = np.zeros((S_diag.shape[0], S_diag.shape[0]))\nnp.fill_diagonal(S, S_diag)\nS_inv = np.linalg.inv(S)\n\n# Pseudo - inverse matrix\nA_pse =  np.dot(V.T, np.dot(S_inv, U))\n\n# Estimate coefficient\nw_svd = np.dot(A_pse, b)\nprint('w calculated from SVD: %s' %str(w_svd))","0f86de4b":"from sklearn import linear_model\nln_reg = linear_model.LinearRegression(fit_intercept = False)\nln_reg.fit(X, y)\nprint('w calculated from sklearn: %s' %str(ln_reg.coef_))","40e1c7d5":"import matplotlib.pyplot as plt\nimport numpy as np\nimport scipy.linalg as ln\nfrom PIL import Image\nimport urllib.request\nfrom io import BytesIO\n\n%matplotlib inline\n\nurl = str('https:\/\/anh.eva.vn\/upload\/3-2017\/images\/2017-07-11\/ghen-ti-voi-nhung-thu-chi-thuoc-ve-nu-than-han-quoc-song-hye-kyo-3-1499791578-width500height330.jpg')\nwith urllib.request.urlopen(url) as url:\n    f = BytesIO(url.read())\n\nig = np.array(Image.open(f))\nprint('Image shape: %s'%str(ig.shape))\n# Convert to grey\nig = ig.dot([0.299, 0.5870, 0.114])\nplt.imshow(ig)","b5c14a0b":"def SVD_pic(n_evl):\n    \"\"\"\n    n_evl: number of highest eigenvalues taken\n    \"\"\"\n    #Take m, n shape\n    m = ig.shape[0]\n    n = ig.shape[1]\n    #Singular Value Decomposition\n    U, S, V = ln.svd(ig) \n    #Get id position of n highest eigenvalues\n    id_trunc = np.argsort(S)[::-1][:n_evl]\n    #Extract matrix U_t, V_t, S_t\n    U_t = U[np.ix_(np.arange(m), id_trunc)]\n    V_t = V[np.ix_(id_trunc, np.arange(n))]\n    S_diag = S[id_trunc]\n    S_t = np.zeros((n_evl, n_evl))\n    np.fill_diagonal(S_t, S_diag)\n    #Return picture\n    A = np.dot(U_t, S_t.dot(V_t))\n    #Norm Frobenius\n    fb = ln.norm(A-ig, 'fro')\n    prt_retain = (1-fb**2\/np.sum(S**2))*100\n    plt.imshow(A)\n    print('Percentage of information retained: %.2f%s \\n'%(prt_retain, '%'))","205f20d4":"SVD_pic(10)","8448b8f1":"SVD_pic(20)","e364417c":"class Data(object):\n    \"\"\"\n    This class used to manage data.\n    Two arguments:\n    dataset: pandas data frame include user_id, item_id and rating\n    split_rate: number train ratings\/ total ratings\n    \"\"\"\n    def __init__(self, dataset, split_rate):\n        self.dataset = dataset\n        self.split_rate = split_rate\n        self.train, self.test = self.split_train_test(self.dataset)\n        self.n_users = np.max(self.train[:, 0] + 1) #plus one because index start from 0\n        self.n_items = np.max(self.train[:, 1] + 1)\n        self.Ytrain, self.Rtrain = self.utility_matrix(self.train)\n        self.Ytest , self.Rtest  = self.utility_matrix(self.test)\n        self.Ystad,  self.u_mean = self.standardize_Y(self.Ytrain)\n        self.n_ratings = self.train.shape[0]\n        \n    def split_train_test(self, dataset):\n        \"split train and test\"\n        gb = dataset.groupby('user_id')\n        ls = [gb.get_group(x) for x in gb.groups]\n        items = [x for x in gb.groups]\n        index_size = [{'i': i, 'index':gb.groups[i], 'size':len(gb.groups[i])} for i in items]\n        index_train = pd.Int64Index([])\n        index_test = pd.Int64Index([])\n        for x in index_size:\n            np.random.shuffle(x['index'].values)\n            le = int(x['size']*self.split_rate)\n            index_train = index_train.append(x['index'][:le])\n            index_test = index_test.append(x['index'][le:])\n        train = dataset.iloc[index_train].values\n        test = dataset.iloc[index_test].values\n        #minus id to 1 to index start from 0\n        train[:, 0] -= 1\n        train[:, 1] -= 1\n        test[:, 0] -= 1\n        test[:, 1] -= 1\n        return train, test\n    \n    def utility_matrix(self, data_mtx):\n        \"create Y and R matrix\"\n        Y = np.zeros(shape = (self.n_items, self.n_users))\n        Y = sparse.coo_matrix((data_mtx[:, 2], (data_mtx[:, 1], data_mtx[:, 0])), \\\n                              shape = (self.n_items, self.n_users), dtype = np.float).toarray()\n        R = sparse.coo_matrix((np.ones((data_mtx.shape[0],)), (data_mtx[:, 1], data_mtx[:, 0])), \\\n                              shape = (self.n_items, self.n_users)).toarray()\n        return Y, R\n    \n    def standardize_Y(self, Y):\n        \"standard data to mean ratings of each user = 0\"\n        sum_rating = Y.sum(axis = 0)\n        u_rating = np.count_nonzero(Y, axis = 0)\n        u_mean = sum_rating\/u_rating\n        for n in range(self.n_users):\n            for m in range(self.n_items):\n                if Y[m, n] != 0:\n                    Y[m, n] -= u_mean[n]\n        return Y, u_mean","2d113015":"class Model():\n    \"\"\"\n    This class manage update U and I matrix, predict and evaluate error\n    Two arguments:\n    data: instance from Data class which supplies the data for model\n    n_evl: number of eigenvalues\n    \"\"\"\n    def __init__(self, data, n_evl = None):\n        self.data = data\n        self.n_evl = n_evl\n        self.Yhat_std = self.fit(self.data, self.n_evl)\n        self.Yhat = self.pred()\n        \n    def fit(self, data, n_evl):\n        U, S, V = ln.svd(data.Ystad)\n        #When n_evl is undefined, we set it equal to diagonal length\n        if self.n_evl is None:\n            n_evl = S.shape[0]\n        #Get id position of n highest eigenvalues\n        id_trunc = np.argsort(S)[::-1][:n_evl]\n        #Extract matrix U_t, V_t, S_t\n        U_t = U[np.ix_(np.arange(U.shape[0]), id_trunc)]\n        V_t = V[np.ix_(id_trunc, np.arange(V.shape[1]))]\n        S_diag = S[id_trunc]\n        S_t = np.zeros((n_evl, n_evl))\n        np.fill_diagonal(S_t, S_diag)\n        #Return matrix forecast\n        self.Yhat_std = np.dot(U_t, S_t.dot(V_t))\n        return self.Yhat_std\n    \n    def pred(self):\n        #invert to forecast values by plus user's mean ratings\n        self.Yhat = self.Yhat_std.copy()\n        for n in range(self.data.n_users):\n            self.Yhat[:, n] += self.data.u_mean[n]\n        #convert to interger values because of rating is integer\n        self.Yhat = self.Yhat.astype(np.int32) \n        #replace values > 5 by 5 and values < 1 by 1\n        self.Yhat[self.Yhat > 5] = 5\n        self.Yhat[self.Yhat < 1] = 1\n        return self.Yhat\n\n    def pred_train_test(self, Yhat, R):\n        #replace values have not yet rated by 0 \n        Y_pred = Yhat.copy()\n        Y_pred[R == 0] = 0\n        return Y_pred\n    \n    def RMSE(self, Y, Yhat):\n        error = Y - Yhat\n        n_ratings = np.sum(Y != 0)\n        rmse = math.sqrt(np.linalg.norm(error, 'fro')**2\/n_ratings)\n        return rmse","b23300d5":"class MF():\n    \"\"\"\n    This class used to manage model and data\n    Two main arguments:\n    data: control the data\n    model: control the functions which execute model\n    \"\"\"\n    def __init__(self, data, model):\n        self.data = data\n        self.model = model\n        self.Y_pred_train = None\n        self.Y_pred_test = None\n        self.Yhat = None\n        \n    def fit(self):\n        #fiting model\n        self.model.fit(self.data, self.model.n_evl)\n        #calculate Y_hat\n        self.Yhat = self.model.pred()\n        #calculate Y_pred_train by replace non ratings by 0\n        self.Y_pred_train = self.model.pred_train_test(self.Yhat, self.data.Rtrain)\n        self.Y_pred_test  = self.model.pred_train_test(self.Yhat, self.data.Rtest)\n        print('RMSE: {}'.\\\n              format(self.model.RMSE(self.data.Ytest, self.Y_pred_test)))\n\n    def recommend_for_user(self, user_id, k_neighbors):\n        recm = np.concatenate((np.arange(1, self.Y_pred_test.shape[0]+1).reshape(-1, 1), \\\n                               self.Y_pred_test[:, user_id - 1].reshape(-1, 1)), axis = 1)\n        recm.sort(axis = 0)\n        print('Top %s item_id recommended to user_id %s: %s'%\\\n              (k_neighbors, user_id, str(recm[-k_neighbors:, 0])))","808ebef5":"import numpy as np\nimport scipy.linalg as ln\nimport pandas as pd\nimport scipy.sparse as sparse\nimport math\n\ncolumns = ['user_id', 'item_id', 'rating', 'timestamp']\nmovie_length = pd.read_csv('..\/input\/ratings.dat', header = 0, \\\n                           names = columns, sep = '::', engine = 'python')\nmovie_length = movie_length.sort_values(['user_id', 'item_id'])\n\ndata = Data(dataset = movie_length, split_rate = 2\/3)","36952e08":"# Fitting model  \nmodel = Model(data = data, n_evl = 2)\nmf = MF(data = data, model = model)\nmf.fit()","41abaf70":"## 2.3. T\u00e0i li\u1ec7u tham kh\u1ea3o.\n1. [C\u00e1c \u0111\u1ecbnh ngh\u0129a li\u00ean quan \u0111\u1ebfn ma tr\u1eadn - Wiki](https:\/\/vi.wikipedia.org\/wiki\/Ma_tr%E1%BA%ADn_(to%C3%A1n_h%E1%BB%8Dc))\n2. [Singular Value Decomposition - Blog machine learning c\u01a1 b\u1ea3n](https:\/\/machinelearningcoban.com\/2017\/06\/07\/svd\/)\n3. [Singular Value Decomposition - Princeton](https:\/\/www.cs.princeton.edu\/courses\/archive\/spring12\/cos598C\/svdchapter.pdf)\n4. [Singular Value Decomposition - Standford - Youtube](https:\/\/www.youtube.com\/watch?v=P5mlg91as1c)\n5. [Singular Value DecomposItion - wiki](https:\/\/en.wikipedia.org\/wiki\/Singular_value_decomposition)\n6. [Singular Value DecomposItion - Carnegie Mellon University](https:\/\/www.cs.cmu.edu\/~venkatg\/teaching\/CStheory-infoage\/book-chapter-4.pdf)\n7. [Singular Value DecomposItion - Standford - Stephen Boyd](https:\/\/see.stanford.edu\/materials\/lsoeldsee263\/16-svd.pdf)\n8. [Pseudo - Inverse, Least Squares, PCA, SVD - Utah university](http:\/\/www.sci.utah.edu\/~gerig\/CS6640-F2012\/Materials\/pseudoinverse-cis61009sl10.pdf)","7ea794f6":"## 2.2. \u00c1p d\u1ee5ng cho thu\u1eadt to\u00e1n recommendation system.\n\nTrong c\u00e1c thu\u1eadt to\u00e1n recommendation ph\u01b0\u01a1ng ph\u00e1p SVD c\u0169ng t\u1ecf ra hi\u1ec7u qu\u1ea3 h\u01a1n so v\u1edbi c\u00e1c ph\u01b0\u01a1ng ph\u00e1p `matrix factorization` s\u1eed d\u1ee5ng `gradient descent`. \u00dd t\u01b0\u1edfng khi \u00e1p d\u1ee5ng v\u00e0o recommendation system c\u0169ng t\u01b0\u01a1ng t\u1ef1 nh\u01b0 n\u00e9n \u1ea3nh \u0111\u00f3 l\u00e0 c\u0103n c\u1ee9 v\u00e0o nh\u1eefng c\u1eb7p (user, item) \u0111\u00e3 \u0111\u01b0\u1ee3c rating c\u1ee7a ma tr\u1eadn ti\u1ec7n \u00edch ta s\u1ebd t\u00ecm ra m\u1ed9t ma tr\u1eadn x\u1ea5p x\u1ec9 t\u1ed1t nh\u1ea5t v\u1edbi ma tr\u1eadn ti\u1ec7n \u00edch. S\u1eed d\u1ee5ng ma tr\u1eadn x\u1ea5p x\u1ec9 \u0111\u1ec3 d\u1ef1 b\u00e1o cho nh\u1eefng c\u1eb7p (user, item) ch\u01b0a \u0111\u01b0\u1ee3c rating.","23294d7c":"## 1.5. B\u00e0i to\u00e1n x\u1ea5p x\u1ec9 low-rank.\nB\u00e0i to\u00e1n x\u1ea5p x\u1ec9 low-rank l\u00e0 m\u1ed9t trong nh\u1eefng \u1ee9ng d\u1ee5ng ph\u1ed5 bi\u1ebfn c\u1ee7a ph\u00e2n t\u00edch suy bi\u1ebfn. M\u1ee5c ti\u00eau ch\u00ednh c\u1ee7a b\u00e0i to\u00e1n l\u00e0 t\u00ecm m\u1ed9t ma tr\u1eadn x\u1ea5p x\u1ec9 t\u1ed1t nh\u1ea5t v\u1edbi ma tr\u1eadn g\u1ed1c nh\u01b0ng c\u00f3 h\u1ea1ng x\u00e1c \u0111\u1ecbnh tr\u01b0\u1edbc v\u00e0 nh\u1ecf h\u01a1n h\u1ea1ng c\u1ee7a ma tr\u1eadn g\u1ed1c. M\u1ee9c \u0111\u1ed9 x\u1ea5p x\u1ec9 \u0111\u01b0\u1ee3c \u0111o l\u01b0\u1eddng th\u00f4ng qua chu\u1ea9n Frobenius c\u1ee7a hi\u1ec7u 2 ma tr\u1eadn. B\u00e0i to\u00e1n c\u00f3 d\u1ea1ng nh\u01b0 sau:\n$$\\arg\\min_{rank(X) = k} ||\\mathbf{\\mathbf{A-X}||_{F}^{2}}$$\nNg\u01b0\u1eddi ta ch\u1ee9ng minh \u0111\u01b0\u1ee3c r\u1eb1ng nghi\u1ec7m c\u1ee7a b\u00e0i to\u00e1n low-rank ch\u00ednh l\u00e0 ph\u00e9p truncate SVD \u0111\u1ed1i v\u1edbi $k$ tr\u1ecb ri\u00eang l\u1edbn nh\u1ea5t. Xem ch\u1ee9ng minh [SVD - princeton](https:\/\/www.cs.princeton.edu\/courses\/archive\/spring12\/cos598C\/svdchapter.pdf). \n\n\n# 2. \u00c1p d\u1ee5ng ph\u00e2n t\u00edch suy bi\u1ebfn\n## 2.1. Gi\u1ea3i ph\u01b0\u01a1ng tr\u00ecnh tuy\u00ean t\u00ednh.\nSVD \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng trong vi\u1ec7c gi\u1ea3i c\u00e1c ph\u01b0\u01a1ng tr\u00ecnh h\u1ed3i qui tuy\u1ebfn t\u00ednh trong tr\u01b0\u1eddng h\u1ee3p t\u1ed5ng qu\u00e1t. Nh\u01b0 chung ta \u0111\u00e3 bi\u1ebft b\u00e0i to\u00e1n h\u1ed3i qui tuy\u1ebfn t\u00ednh s\u1ebd t\u00ecm m\u1ed9t ph\u01b0\u01a1ng tr\u00ecnh c\u00f3 d\u1ea1ng tuy\u1ebfn t\u00ednh sao cho kh\u00e1c bi\u1ec7t gi\u1eefa c\u00e1c \u0111i\u1ec3m d\u1eef li\u1ec7u d\u1ef1 b\u00e1o v\u00e0 th\u1ef1c t\u1ebf l\u00e0 nh\u1ecf nh\u1ea5t. Kh\u00e1c bi\u1ec7t n\u00e0y \u0111\u01b0\u1ee3c \u0111o l\u01b0\u1eddng th\u00f4ng qua m\u1ed9t h\u00e0m loss function c\u00f3 d\u1ea1ng:\n$$\\mathcal{L}(\\mathbf{w}) = \\frac{1}{2n}||\\mathbf{y - Xw}||_2^{2}$$\nTrong \u0111\u00f3 $\\mathbf{y} \\in \\mathbb{R}^{m}$ l\u00e0 vector bi\u1ebfn m\u1ee5c ti\u00eau (ho\u1eb7c bi\u1ebfn ph\u1ee5 thu\u1ed9c). Ma tr\u1eadn $\\mathbf{X} \\in \\mathbb{R}^{m \\times n}$ l\u00e0 ma tr\u1eadn m\u1edf r\u1ed9ng c\u1ee7a ma tr\u1eadn \u0111\u1ea7u v\u00e0o c\u00f3 m\u1ed7i d\u00f2ng l\u00e0 m\u1ed9t quan s\u00e1t v\u00e0 m\u1ed7i c\u1ed9t l\u00e0 m\u1ed9t chi\u1ec1u d\u1eef li\u1ec7u. Ma tr\u1eadn n\u00e0y c\u00f3 c\u1ed9t cu\u1ed1i c\u00f9ng b\u1eb1ng 1 \u0111\u1ea1i di\u1ec7n cho h\u1ec7 s\u1ed1 t\u1ef1 do. $\\mathbf{w} \\in \\mathbb{R}^{n}$ l\u00e0 vector c\u00e1c h\u1ec7 s\u1ed1 c\u1ee7a ph\u01b0\u01a1ng tr\u00ecnh h\u1ed3i qui v\u00e0 l\u00e0 \u0111\u1ea1i l\u01b0\u1ee3ng bi\u1ebfn \u0111\u1ed5i trong ph\u01b0\u01a1ng tr\u00ecnh loss function.\nTh\u00f4ng qua vi\u1ec7c gi\u1ea3i ph\u01b0\u01a1ng tr\u00ecnh \u0111\u1ea1o h\u00e0m b\u1eadc nh\u1ea5t c\u1ee7a h\u00e0m loss function ta c\u00f3 th\u1ec3 t\u00ecm \u0111\u01b0\u1ee3c $\\mathbf{w}$.\n\nTheo ph\u01b0\u01a1ng tr\u00ecnh \u0111\u1ea1o h\u00e0m t\u00edch (Product rules) ta c\u00f3: $\\nabla_\\mathbf{x} (f^{\\mathbf{T}}g) = (\\nabla_\\mathbf{x}f)g + (\\nabla_\\mathbf{x}g) f$.\nDo \u0111\u00f3 \u0111\u1ea1o h\u00e0m $\\nabla_\\mathbf{x} (f^{\\mathbf{T}}f) = 2(\\nabla_\\mathbf{x}f)f$. \u00c1p d\u1ee5ng v\u00e0o tri\u1ec3n khai \u0111\u1ea1o h\u00e0m $\\mathcal{L}(\\mathbf{w})$.\n\n$$\\begin{eqnarray}\n\\frac{\\partial \\mathcal{L}(\\mathbf{w})}{\\partial\\mathbf{w}} & = & \\frac{1}{2n}\\frac{\\partial (\\mathbf{y - Xw})^{\\mathbf{T}}(\\mathbf{y - Xw})}{\\partial\\mathbf{w}} \\\\\n& = & \\frac{1}{n}\\frac{(\\partial(\\mathbf{y - Xw}))(\\mathbf{y - Xw})}{\\partial\\mathbf{w}} \\\\\n& = & \\frac{1}{n}\\frac{\\mathbf{X^{T}(y - Xw)}}{\\partial\\mathbf{w}}\n\\end{eqnarray}$$\n\n\u0110\u1eb3ng th\u1ee9c d\u00f2ng th\u1ee9 3 x\u1ea3y ra l\u00e0 do $\\nabla_{\\mathbf{x}} \\mathbf{Xw} = \\mathbf{X^T}$. \n\u0110\u1eb7t $\\mathbf{A} := \\mathbf{X^TX}$ v\u00e0 $\\mathbf{X^Ty} := \\mathbf{b}$ \nNh\u01b0 v\u1eady nghi\u1ec7m $\\mathbf{w}$ c\u1ee7a h\u00e0m loss function s\u1ebd th\u1ecfa m\u00e0n $\\mathbf{Aw} = \\mathbf{b}$. Trong tr\u01b0\u1eddng h\u1ee3p $\\mathbf{A}$ kh\u1ea3 ngh\u1ecbch ph\u01b0\u01a1ng tr\u00ecnh c\u00f3 nghi\u1ec7m $\\mathbf{w} = \\mathbf{A}^{-1}\\mathbf{b}$. Tuy nhi\u00ean tr\u01b0\u1eddng h\u1ee3p $\\mathbf{A}$ kh\u00f4ng kh\u1ea3 ngh\u1ecbch \u0111\u1ec3 t\u00ecm nghi\u1ec7m c\u1ee7a b\u00e0i to\u00e1n ta c\u1ea7n s\u1eed d\u1ee5ng \u0111\u1ebfn ma tr\u1eadn gi\u1ea3 ngh\u1ecbch \u0111\u1ea3o (c\u00f2n g\u1ecdi l\u00e0 ma tr\u1eadn Pseudo - Inverse ho\u1eb7c ma tr\u1eadn Moore - Penrose) c\u1ee7a $\\mathbf{A}$ \u0111\u01b0\u1ee3c k\u00ed hi\u1ec7u l\u00e0 $\\mathbf{A}^{\\dagger}$. C\u00e1c \u0111\u1ecbnh ngh\u0129a v\u00e0 t\u00ednh ch\u1ea5t v\u1ec1 ma tr\u1eadn gi\u1ea3 ngh\u1ecbch \u0111\u1ea3o c\u00f3 th\u1ec3 t\u00ecm hi\u1ec3u t\u1ea1i [Pseudo - Inverse](http:\/\/www.sci.utah.edu\/~gerig\/CS6640-F2012\/Materials\/pseudoinverse-cis61009sl10.pdf). Ma tr\u1eadn gi\u1ea3 ngh\u1ecbch \u0111\u1ea3o c\u00f3 th\u1ec3 \u0111\u01b0\u1ee3c gi\u1ea3i nh\u1edd ph\u00e9p ph\u00e2n t\u00edch suy bi\u1ebfn c\u1ee7a $\\mathbf{A}$. N\u1ebfu ma tr\u1eadn $\\mathbf{A}$ c\u00f3 bi\u1ec3u di\u1ec5n ph\u00e2n t\u00edch suy bi\u1ebfn d\u1ea1ng:\n$$\\mathbf{A} = \\mathbf{U\\Sigma V^{T}}$$\n\nKhi \u0111\u00f3 ma tr\u1eadn gi\u1ea3 ngh\u1ecbch \u0111\u1ea3o c\u1ee7a $\\mathbf{A}$ s\u1ebd l\u00e0:\n$$\\mathbf{A}^{\\dagger} = \\mathbf{V\\Sigma^{-1} U^{T}}$$\nTa th\u1ea5y ma tr\u1eadn gi\u1ea3 ngh\u1ecbch \u0111\u1ea3o v\u1eabn c\u00f3 t\u00ednh ch\u1ea5t nh\u01b0 ma tr\u1eadn ngh\u1ecbch \u0111\u1ea3o \u0111\u00f3 l\u00e0 $\\mathbf{A}^{\\dagger}\\mathbf{A} = \\mathbf{I}$.\nB\u00ean d\u01b0\u1edbi ta s\u1ebd s\u1eed d\u1ee5ng SVD \u0111\u1ec3 gi\u1ea3i ph\u01b0\u01a1ng tr\u00ecnh h\u1ed3i qui tuy\u1ebfn t\u00ednh.","30aa7bac":"\n## 1.3. Ph\u00e1t bi\u1ec3u ph\u00e2n t\u00edch suy bi\u1ebfn.\nTrong \u0111\u1ea1i s\u1ed1 tuy\u1ebfn t\u00ednh, ph\u00e9p ph\u00e2n t\u00edch suy bi\u1ebfn l\u00e0 m\u1ed9t d\u1ea1ng c\u1ee7a `matrix factorization` nh\u1eb1m ph\u00e2n t\u00edch m\u1ed9t ma tr\u1eadn th\u00e0nh t\u00edch c\u1ee7a c\u00e1c ma tr\u1eadn s\u1ed1 th\u1ef1c ho\u1eb7c ma tr\u1eadn s\u1ed1 ph\u1ee9c. \u0110\u00e2y l\u00e0 m\u1ed9t t\u1ed5ng qu\u00e1t t\u1ed5ng qu\u00e1t c\u1ee7a ph\u00e2n t\u00edch ri\u00eang trong tr\u01b0\u1eddng h\u1ee3p ma tr\u1eadn kh\u00f4ng vu\u00f4ng khi n\u00f3 bi\u1ec3u di\u1ec5n ma tr\u1eadn g\u1ed1c th\u00e0nh t\u00edch c\u1ee7a  hai ma tr\u1eadn tr\u1ef1c giao v\u00e0 m\u1ed9t ma tr\u1eadn \u0111\u01b0\u1eddng ch\u00e9o. Ph\u00e1t bi\u1ec3u c\u1ee7a ph\u00e9p ph\u00e2n t\u00edch suy bi\u1ebfn s\u1ebd \u0111\u01b0\u1ee3c tr\u00ecnh b\u00e0y c\u00f3 d\u1ea1ng nh\u01b0 sau.\n\n### 1.3.1. Ph\u00e2n t\u00edch suy bi\u1ebfn. \n\u0110\u1ec3 \u0111\u01a1n gi\u1ea3n ta s\u1ebd k\u00ed hi\u1ec7u ch\u1ec9 s\u1ed1 k\u00edch th\u01b0\u1edbc ma tr\u1eadn \u1edf b\u00ean d\u01b0\u1edbi. Ma tr\u1eadn $\\mathbf{A}_{mn}$ l\u00e0 k\u00ed hi\u1ec7u cho ma tr\u1eadn $\\mathbf{A} \\in \\mathbb{R}^{m \\times n}$. Ph\u00e9p ph\u00e2n t\u00edch suy bi\u1ebfn c\u1ee7a ma tr\u1eadn $\\mathbf{A}_{mn}$ l\u00e0 m\u1ed9t d\u1ea1ng matrix factorization. C\u0169ng gi\u1ed1ng nh\u01b0 ph\u01b0\u01a1ng ph\u00e1p ph\u00e2n t\u00edch ri\u00eang, n\u00f3 s\u1ebd bi\u1ec3u di\u1ec5n ma tr\u1eadn g\u1ed1c d\u01b0\u1edbi d\u1ea1ng t\u00edch c\u1ee7a 3 ma tr\u1eadn \u0111\u1eb7c bi\u1ec7t nh\u01b0 sau:\n$$\\mathbf{A}_{mn} = \\mathbf{U}_{mm}\\mathbf{\\Sigma}_{mn}\\mathbf{V}_{nn}^\\mathbf{T}$$\nTrong \u0111\u00f3 $\\mathbf{U}_{mm}, \\mathbf{V}_{nn}$ l\u00e0 c\u00e1c ma tr\u1eadn tr\u1ef1c giao v\u00e0 $\\mathbf{\\Sigma}_{mn}$ l\u00e0 ma tr\u1eadn \u0111\u01b0\u1eddng ch\u00e9o. \n\nV\u1ec1 m\u1eb7t h\u00ecnh h\u1ecdc ph\u00e9p ph\u00e2n t\u00edch suy bi\u1ebfn s\u1ebd l\u1ea7n l\u01b0\u1ee3t tr\u1ea3i qua: ph\u00e9p xoay (rotation), ph\u00e9p n\u1edbi r\u1ed9ng (scaling) v\u00e0 ph\u00e9p xoay \u1edf cu\u1ed1i c\u00f9ng. N\u1ebfu ta coi c\u00e1c d\u00f2ng c\u1ee7a ma tr\u1eadn $\\mathbf{A}$ l\u00e0 c\u00e1c \u0111i\u1ec3m d\u1eef li\u1ec7u v\u00e0 c\u00e1c chi\u1ec1u d\u1eef li\u1ec7u l\u00e0 c\u00e1c c\u1ed9t. Khi \u0111\u00f3 nh\u00e2n c\u00e1c \u0111i\u1ec3m d\u1eef li\u1ec7u v\u1edbi ma tr\u1eadn tr\u1ef1c giao $\\mathbf{U}_{mm}$ ch\u00ednh l\u00e0 vi\u1ec7c ta th\u1ef1c hi\u1ec7n m\u1ed9t ph\u00e9p xoay v\u00e0 ph\u00e9p xoay n\u00e0y kh\u00f4ng l\u00e0m thay \u0111\u1ed5i t\u00edch v\u00f4 h\u01b0\u1edbng c\u1ee7a c\u00e1c vector. Ph\u00e9p nh\u00e2n v\u1edbi ma tr\u1eadn \u0111\u01b0\u1eddng ch\u00e9o $\\mathbf{\\Sigma}$ s\u1ebd co d\u00e3n \u0111\u1ed9 l\u1edbn c\u00e1c chi\u1ec1u theo gi\u00e1 tr\u1ecb c\u1ee7a c\u00e1c tr\u1ecb ri\u00eang tr\u00ean \u0111\u01b0\u1eddng ch\u00e9o ch\u00ednh. V\u00e0 cu\u1ed1i c\u00f9ng ph\u00e9p nh\u00e2n v\u1edbi ma tr\u1eadn tr\u1ef1c giao $\\mathbf{V^{T}}$ l\u1ea1i th\u1ef1c hi\u1ec7n ph\u00e9p bi\u1ebfn xoay m\u1ed9t l\u1ea7n n\u1eefa. \n\n![](https:\/\/raw.githubusercontent.com\/phamdinhkhanh\/MovieLen\/master\/svd2.png)\n\n> H\u00ecnh 1: Minh h\u1ecda bi\u1ebfn \u0111\u1ed5i h\u00ecnh h\u1ecdc c\u1ee7a ph\u00e9p ph\u00e2n t\u00edch suy bi\u1ebfn. (Ngu\u1ed3n [wikipedia](https:\/\/en.wikipedia.org\/wiki\/Singular_value_decomposition#\/media\/File:Singular-Value-Decomposition.svg))\n\n### 1.3.2. M\u1ed1i li\u00ean h\u1ec7 gi\u1eefa ph\u00e2n t\u00edch suy bi\u1ebfn v\u00e0 ph\u00e2n t\u00edch ri\u00eang.\n\nTa c\u00f3 th\u1ec3 th\u1ea5y ph\u00e2n t\u00edch suy bi\u1ebfn kh\u00e1c v\u1edbi ph\u00e2n t\u00edch ri\u00eang \u1edf ch\u1ed7 n\u00f3 \u00e1p d\u1ee5ng cho ma tr\u1eadn b\u1ea5t k\u00ec m\u00e0 kh\u00f4ng y\u00eau c\u1ea7u ma tr\u1eadn \u0111\u00f3 ph\u1ea3i vu\u00f4ng. \u0110\u1ec3 th\u1ea5y \u0111\u01b0\u1ee3c m\u1ed1i li\u00ean h\u1ec7 m\u1eadt thi\u1ebft gi\u1eefa ph\u00e9p ph\u00e2n t\u00edch suy bi\u1ebfn v\u00e0 ph\u00e2n t\u00edch ri\u00eang sau khi khai tri\u1ec3n t\u00edch $\\mathbf{A^{T}A}$:\n\n$$\\begin{eqnarray}\\mathbf{A^{T}A} & = & \\mathbf{(U\\Sigma V^{T})^{T}}\\mathbf{U\\Sigma V^{T}} \\\\\n& = & \\mathbf{V \\Sigma^{T}U^{T}}\\mathbf{U\\Sigma V^{T}} \\\\\n& = & \\mathbf{V \\Sigma^{T}}\\mathbf{\\Sigma V^{T}}\n\\end{eqnarray}$$\n\nD\u1ea5u b\u1eb1ng th\u1ee9 3 x\u1ea3y ra l\u00e0 v\u00ec $\\mathbf{U^{T}U} = \\mathbf{I_n}$. Ngo\u00e0i ra $\\mathbf{\\Sigma^{T}\\Sigma}$ l\u00e0 m\u1ed9t ma tr\u1eadn \u0111\u01b0\u1eddng ch\u00e9o c\u00f3 c\u00e1c th\u00e0nh ph\u1ea7n tr\u00ean \u0111\u01b0\u1eddng ch\u00e9o ch\u00ednh l\u1ea7n l\u01b0\u1ee3t l\u00e0 $\\sigma_1^{2}, \\sigma_2^{2},...,\\sigma_{n}^2 > 0$. Nh\u01b0 v\u1eady $\\mathbf{A^{T}A}$ l\u00e0 m\u1ed9t ph\u00e2n t\u00edch ri\u00eang c\u1ee7a ma tr\u1eadn tr\u1ef1c giao $\\mathbf{V}$ v\u00e0 ma tr\u1eadn \u0111\u01b0\u1eddng ch\u00e9o $\\mathbf{\\Sigma^{T}\\Sigma}$. Ho\u00e0n to\u00e0n t\u01b0\u01a1ng t\u1ef1 ta c\u0169ng c\u00f3 $\\mathbf{AA^{T}}$ l\u00e0 m\u1ed9t ph\u00e2n t\u00edch ri\u00eang cua ma tr\u1eadn tr\u1ef1c giao $\\mathbf{U}$ v\u00e0 ma tr\u1eadn \u0111\u01b0\u1eddng ch\u00e9o $\\mathbf{\\Sigma\\Sigma^{T}}$. C\u00e1c ph\u1ea7n t\u1eed $\\sigma_i$ tr\u00ean \u0111\u01b0\u1eddng ch\u00e9o ch\u00ednh c\u1ee7a $\\mathbf{\\Sigma}$ \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 gi\u00e1 tr\u1ecb suy bi\u1ebfn (singular values) c\u1ee7a ma tr\u1eadn $\\mathbf{A}$. C\u00e1c c\u1ed9t c\u1ee7a ma tr\u1eadn $\\mathbf{V}$ l\u00e0 h\u1ec7 vector ri\u00eang \u1ee9ng v\u1edbi tr\u1ecb ri\u00eang c\u1ee7a $\\mathbf{\\Sigma^{T}\\Sigma}$ v\u00e0 c\u00f2n \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 h\u1ec7 vector suy bi\u1ebfn tr\u00e1i (left-singular vectors). C\u00e1c c\u1ed9t c\u1ee7a $\\mathbf{U}$ \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 h\u1ec7 vector suy bi\u1ebfn ph\u1ea3i (right-singular vectors).\n\n### 1.3.3. Ph\u00e2n t\u00edch suy bi\u1ebfn trong python\nTrong python ph\u00e9p ph\u00e2n t\u00edch suy bi\u1ebfn c\u1ee7a m\u1ed9t ma tr\u1eadn \u0111\u01b0\u1ee3c th\u1ef1c hi\u1ec7n d\u1ec5 d\u00e0ng th\u00f4ng qua vi\u1ec7c s\u1eed d\u1ee5ng h\u00e0m *SVD* c\u1ee7a package scipy nh\u01b0 sau:","89ade987":"### 1.4.2 . Ph\u01b0\u01a1ng ph\u00e1p Compact SVD.\nTa c\u00f3 th\u1ec3 bi\u1ec3u di\u1ec5n ma tr\u1eadn $\\mathbf{A}$ d\u01b0\u1edbi d\u1ea1ng t\u1ed5ng c\u1ee7a c\u00e1c t\u00edch vector c\u1ed9t $\\mathbf{u_i} \\in \\mathbb{R}^{m}$ c\u1ee7a $\\mathbf{U}_{mm}$ v\u00e0 vector d\u00f2ng $\\mathbf{v_i} \\in \\mathbb{R}^{n}$ c\u1ee7a $\\mathbf{V}_{nn}^{\\mathbf{T}}$ nh\u01b0 sau:\n$$\\mathbf{A} = \\sum_{i = 1}^{n}\\mathbf{u_i\\sigma_i v_i}\\tag{4}$$\nC\u00e1c vector $\\mathbf{u_i}$ v\u00e0 $\\mathbf{v_i}$ l\u00e0 c\u00e1c h\u1ec7 c\u01a1 s\u1edf \u0111\u1ed9c l\u1eadp tuy\u1ebfn t\u00ednh. Th\u00f4ng th\u01b0\u1eddng trong ma tr\u1eadn \u0111\u01b0\u1eddng ch\u00e9o $\\mathbf{\\Sigma}_{nn}$ ch\u1ec9 m\u1ed9t l\u01b0\u1ee3ng l\u1edbn c\u00e1c tr\u1ecb ri\u00eang c\u00f3 l\u1edbn h\u01a1n 0. C\u00e1c tr\u1ecb ri\u00eang c\u00f2n l\u1ea1i \u0111\u1ec1u x\u1ea5p x\u1ec9 0. Do \u0111\u00f3 ch\u1ec9 t\u1ea1i $r$ v\u1ecb tr\u00ed d\u00f2ng v\u00e0 c\u1ed9t t\u01b0\u01a1ng \u1ee9ng v\u1edbi c\u00e1c tr\u1ecb ri\u00eang \u0111\u1ee7 l\u1edbn ta m\u1edbi th\u1ef1c hi\u1ec7n t\u00ednh to\u00e1n SVD. Bi\u1ec3u di\u1ec5n ma tr\u1eadn $\\mathbf{A}_{mn}$ d\u01b0\u1edbi d\u1ea1ng compact SVD nh\u01b0 sau:\n$$\\mathbf{A} = \\mathbf{U}_{r}\\mathbf{\\Sigma}_{r}\\mathbf{V}_{r}^\\mathbf{T}$$\nTrong \u0111\u00f3 c\u00e1c ma tr\u1eadn $\\mathbf{U_r, \\Sigma_r, V_r}^{\\mathbf{T}}$ l\u1ea7n l\u01b0\u1ee3t l\u00e0 c\u00e1c ma tr\u1eadn sau khi \u0111\u00e3 r\u00fat g\u1ecdn c\u00e1c d\u00f2ng v\u00e0 c\u1ed9t \u0111\u1ec3 ch\u1ec9 gi\u1eef l\u1ea1i c\u00e1c v\u1ecb tr\u00ed t\u01b0\u01a1ng \u1ee9ng v\u1edbi $\\sigma_i$ \u0111\u1ee7 l\u1edbn.\nN\u1ebfu $r << n$ th\u00ec c\u00e1ch t\u00ednh n\u00e0y ti\u1ebft ki\u1ec7m \u0111\u01b0\u1ee3c nhi\u1ec1u s\u1ed1 l\u01b0\u1ee3ng t\u00ednh to\u00e1n v\u00e0 l\u01b0u tr\u1eef h\u01a1n so v\u1edbi ph\u01b0\u01a1ng ph\u00e1p l\u00e0m m\u1ecfng SVD.\n\n### 1.4.3. Ph\u01b0\u01a1ng ph\u00e1p Truncate SVD.\nTrong ph\u01b0\u01a1ng ph\u00e1p n\u00e0y ta gi\u1ea3 \u0111\u1ecbnh ma tr\u1eadn $\\mathbf{A}$ l\u00e0 ma tr\u1eadn b\u00e1n x\u00e1c \u0111\u1ecbnh d\u01b0\u01a1ng. Khi \u0111\u00f3 m\u1ecdi tr\u1ecb ri\u00eang c\u1ee7a n\u00f3 \u0111\u1ec1u kh\u00f4ng \u00e2m. Ph\u01b0\u01a1ng ph\u00e1p Truncate SVD c\u0169ng t\u01b0\u01a1ng t\u1ef1 nh\u01b0 Compact SVD. Tuy nhi\u00ean thay v\u00ec c\u00e1c d\u00f2ng v\u00e0 c\u1ed9t t\u01b0\u01a1ng \u1ee9ng v\u1edbi tr\u1ecb ri\u00eang \u0111\u1ee7 l\u1edbn tr\u00ean ma tr\u1eadn \u0111\u01b0\u1eddng ch\u00e9o $\\mathbf{\\Sigma}_{mn}$ th\u00ec ch\u00fang ta s\u1ebd ch\u1ec9 l\u1ea5y ra $t$ d\u00f2ng v\u00e0 c\u1ed9t \u1ee9ng v\u1edbi top $t$ c\u00e1c tr\u1ecb ri\u00eang $\\sigma_1 > \\sigma_2 >...> \\sigma_t > 0$ l\u1edbn nh\u1ea5t c\u1ee7a $\\mathbf{A}$ t\u1eeb $\\mathbf{U, V}^{\\mathbf{T}}$ . Ph\u1ea7n c\u00f2n l\u1ea1i c\u1ee7a ma tr\u1eadn s\u1ebd b\u1ecb lo\u1ea1i b\u1ecf. Nh\u01b0 v\u1eady trong ph\u01b0\u01a1ng ph\u00e1p Truncate SVD ta s\u1ebd thu \u0111\u01b0\u1ee3c ma tr\u1eadn x\u1ea5p x\u1ec9 c\u1ee7a ma tr\u1eadn $\\mathbf{A}$ l\u00e0 ma tr\u1eadn:\n$$\\mathbf{\\hat{A}} = \\mathbf{U}_{t}\\mathbf{\\Sigma}_{t}\\mathbf{V}_{t}^\\mathbf{T}$$\nHo\u1eb7c ta c\u00f3 th\u1ec3 bi\u1ec3u di\u1ec5n d\u01b0\u1edbi d\u1ea1ng t\u1ed5ng c\u1ee7a t\u00edch v\u00f4 h\u01b0\u1edbng c\u00e1c vector c\u1ed9t v\u00e0 d\u00f2ng c\u1ee7a $\\mathbf{U, V}^{\\mathbf{T}}$ nh\u01b0 sau:\n$$\\mathbf{A} = \\sum_{i = 1}^{t}\\mathbf{u_i\\sigma_i v_i}\\tag{5}$$\nKhi \u0111\u00f3 ta c\u00f2n t\u00ednh \u0111\u01b0\u1ee3c kho\u1ea3ng c\u00e1ch norm Frobenius gi\u1eefa $\\mathbf{\\hat{A}}$ v\u00e0 $\\mathbf{A}$ ch\u00ednh b\u1eb1ng t\u1ed5ng b\u00ecnh ph\u01b0\u01a1ng c\u1ee7a c\u00e1c tr\u1ecb ri\u00eang c\u00f2n l\u1ea1i t\u1eeb $\\sigma_{t+1}$ \u0111\u1ebfn $\\sigma_n$ (v\u1edbi gi\u1ea3 \u0111\u1ecbnh $\\mathbf{A}$ c\u00f3 $n$ tr\u1ecb ri\u00eang) nh\u01b0 sau:\n\n$$\\begin{eqnarray}||\\mathbf{A}-\\mathbf{\\hat{A}}||_{F}^{2} & = & (\\mathbf{A}-\\mathbf{\\hat{A}})^{\\mathbf{T}}(\\mathbf{A}-\\mathbf{\\hat{A}}) \\\\\n& = & (\\sum_{i = t+1}^{n}\\mathbf{u_i\\sigma_i v_i})^{\\mathbf{T}}(\\sum_{i = t+1}^{n}\\mathbf{u_i\\sigma_i v_i}) \\\\\n& = & (\\sum_{i = t+1}^{n}\\mathbf{\\sigma_i v_i^{T} u_i^{T}})(\\sum_{i = t+1}^{n}\\mathbf{\\sigma_i u_i v_i}) \\\\\n& = & \\sum_{i = t+1}^{n}\\sum_{j = t+1}^{n}\\mathbf{\\sigma_i \\sigma_j v_i^{T} u_i^{T}u_j v_j} \\\\\n& = & \\sum_{i = t+1}^{n}\\mathbf{\\sigma_i^{2} v_i^{T} u_i^{T}}\\mathbf{u_i v_i} \\\\\n& = & \\sum_{i = t+1}^{n}\\mathbf{\\sigma_i^{2} v_i^{T} v_i} \\\\\n& = & \\sum_{i = t+1}^{n}\\mathbf{\\sigma_i^{2}} \\\\\n\\end{eqnarray}$$\n\nD\u1ea5u b\u1eb1ng th\u1ee9 3 l\u00e0 v\u00ec l\u1ea5y \u0111\u1eb3ng th\u1ee9c (4) tr\u1eeb \u0111i (5). D\u1ea5u b\u1eb1ng th\u1ee9 5 x\u1ea3y ra l\u00e0 do ma c\u00e1c vector c\u1ed9t c\u1ee7a $\\mathbf{U, V}$ l\u00e0 nh\u1eefng h\u1ec7 tr\u1ef1c giao n\u00ean $\\mathbf{u_i^{T}u_j} = 0, \\mathbf{v_i^{T}v_j} = 0 , ~ \\forall 1 \\leq i \\neq j \\leq n$. C\u00e1c d\u1ea5u b\u1eb1ng 6, 7 l\u00e0 do $\\mathbf{u_i^{T}u_i} = 1, \\mathbf{v_i^{T}v_i} = 1,~ \\forall 1 \\leq i \\leq n$. Nh\u01b0 v\u1eady ta \u0111\u00e3 hi\u1ec3u l\u00fd do t\u1ea1i sao ch\u00fang ta ch\u1ec9 ch\u1ecdn ra top $t$ tr\u1ecb ri\u00eang c\u00f3 gi\u00e1 tr\u1ecb l\u1edbn nh\u1ea5t. Khi \u0111\u00f3 sai s\u1ed1 c\u1ee7a 2 ma tr\u1eadn s\u1ebd l\u00e0 nh\u1ecf nh\u1ea5t v\u00ec b\u1eb1ng t\u1ed5ng b\u00ecnh ph\u01b0\u01a1ng c\u1ee7a c\u00e1c tr\u1ecb ri\u00eang c\u00f2n l\u1ea1i. Ph\u01b0\u01a1ng ph\u00e1p truncate SVD c\u00f2n cho ta bi\u1ebft \u0111\u01b0\u1ee3c t\u1ef7 l\u1ec7 ph\u1ea7n tr\u0103m l\u01b0\u1ee3ng th\u00f4ng tin l\u01b0u gi\u1eef trong ma tr\u1eadn x\u1ea5p x\u1ec9 th\u00f4ng qua c\u00f4ng th\u1ee9c:\n$$\\frac{\\sum_{i = 1}^{t}\\sigma_i^2}{\\sum_{j = 1}^{n}\\sigma_j^2}$$","f4813cc5":"## 1.4. C\u00e1c ph\u00e9p gi\u1ea3m chi\u1ec1u SVD.\nTh\u00f4ng th\u01b0\u1eddng vi\u1ec7c ph\u00e2n t\u00edch suy bi\u1ebfn m\u1ed9t ma tr\u1eadn c\u00f3 k\u00edch th\u01b0\u1edbc l\u1edbn s\u1ebd r\u1ea5t l\u00e2u v\u00ec \u0111\u00f2i h\u1ecfi ph\u1ea3i gi\u1ea3i ph\u01b0\u01a1ng tr\u00ecnh \u0111\u1eb7c tr\u01b0ng \u0111\u1ec3 t\u00ecm ra c\u00e1c gi\u00e1 tr\u1ecb \u0111\u1eb7c tr\u01b0ng, t\u1eeb \u0111\u00f3 suy ra ma tr\u1eadn \u0111\u01b0\u1eddng ch\u00e9o $\\mathbf{\\Sigma}$. T\u1eeb ph\u01b0\u01a1ng tr\u00ecnh ph\u00e2n t\u00edch ri\u00eang $\\mathbf{A^{T}A} = \\mathbf{V\\Sigma^{T}\\Sigma V^{T}}$ suy ra $\\mathbf{A^{T}AV} = \\mathbf{V\\Sigma^{T}\\Sigma}$, s\u1eed d\u1ee5ng ph\u01b0\u01a1ng tr\u00ecnh \u1ee9ng v\u1edbi t\u1eebng c\u1ed9t c\u1ea3 2 v\u1ebf tr\u00e1i v\u00e0 ph\u1ea3i \u0111\u1ec3 t\u00ednh ra \u0111\u01b0\u1ee3c c\u00e1c vector ri\u00eang \u1ee9ng v\u1edbi m\u1ed7i tr\u1ecb ri\u00eang v\u00e0 suy ra \u0111\u01b0\u1ee3c ma tr\u1eadn $\\mathbf{V}$. C\u00e1ch t\u00ecm ma tr\u1eadn $\\mathbf{U}$ c\u0169ng \u0111\u01b0\u1ee3c suy ra t\u01b0\u01a1ng t\u1ef1 t\u1eeb ph\u01b0\u01a1ng tr\u00ecnh ph\u00e2n t\u00edch ri\u00eang $\\mathbf{AA^{T}} = \\mathbf{U\\Sigma\\Sigma^{T} U^{T}}$. Qu\u00e1 tr\u00ecnh n\u00e0y ph\u1ea3i tr\u1ea3i qua nhi\u1ec1u b\u01b0\u1edbc v\u00e0 khi k\u00edch th\u01b0\u1edbc ma tr\u1eadn l\u1edbn, chi ph\u00ed th\u1eddi gian v\u00e0 l\u01b0u tr\u1eef s\u1ebd r\u1ea5t l\u1edbn. V\u00ec v\u1eady c\u00e1c d\u1ea1ng gi\u1ea3m chi\u1ec1u SVD s\u1ebd r\u00fat g\u1ecdn qu\u00e1 tr\u00ecnh t\u00ednh to\u00e1n.\n\n\n### 1.4.1. Ph\u01b0\u01a1ng ph\u00e1p l\u00e0m m\u1ecfng SVD.\nXu\u1ea5t ph\u00e1t t\u1eeb \u00fd t\u01b0\u1edfng s\u1ed1 quan s\u00e1t th\u01b0\u1eddng l\u1edbn g\u1ea5p r\u1ea5t nhi\u1ec1u l\u1ea7n so v\u1edbi s\u1ed1 chi\u1ec1u hay $m >> n$ trong h\u1ea7u h\u1ebft c\u00e1c tr\u01b0\u1eddng h\u1ee3p c\u1ee7a ma tr\u1eadn $\\mathbf{A}$ n\u00ean thay v\u00ec ph\u1ea3i t\u00ednh to\u00e1n b\u1ed9 ma tr\u1eadn $\\mathbf{U}_{mm}$ ta s\u1ebd ch\u1ec9 t\u00ednh n c\u1ed9t \u0111\u1ea7u ti\u00ean l\u00e0 $\\mathbf{U}_{mn}$. S\u1ed1 chi\u1ec1u c\u1ee7a ma tr\u1eadn \u0111\u01b0\u1eddng ch\u00e9o $\\mathbf{\\Sigma}_{mn}$ c\u0169ng gi\u1ea3m xu\u1ed1ng th\u00e0nh $\\mathbf{\\Sigma}_{nn}$ . Khi \u0111\u00f3 ma tr\u1eadn $\\mathbf{A}$ \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n d\u01b0\u1edbi d\u1ea1ng:\n$$\\mathbf{A} = \\mathbf{U}_{mn}\\mathbf{\\Sigma}_{nn}\\mathbf{V}_{nn}^\\mathbf{T}$$\nNh\u01b0 v\u1eady s\u1ed1 l\u01b0\u1ee3ng c\u00e1c tr\u1ecb ri\u00eang c\u1ea7n t\u00ecm ch\u1ec9 c\u00f2n $n$ v\u00e0 s\u1ed1 l\u01b0\u1ee3ng vector ri\u00eang ch\u1ec9 c\u00f2n $2n$ ($n$ c\u1ed9t c\u1ee7a ma tr\u1eadn $\\mathbf{U}_{mn}$ v\u00e0 $n$ c\u1ed9t c\u1ee7a ma tr\u1eadn $\\mathbf{V}_{nn}$).","93aaee02":"# 1. Ph\u01b0\u01a1ng ph\u00e1p ph\u00e2n t\u00edch suy bi\u1ebfn.\n\n## 1.1. Gi\u1edbi thi\u1ec7u chung.\nPh\u01b0\u01a1ng ph\u00e1p *ph\u00e2n t\u00edch suy bi\u1ebfn* (singular value decomposition) \u0111\u01b0\u1ee3c vi\u1ebft t\u1eaft l\u00e0 SVD l\u00e0 m\u1ed9t trong nh\u1eefng ph\u01b0\u01a1ng ph\u00e1p thu\u1ed9c nh\u00f3m matrix factorization \u0111\u01b0\u1ee3c ph\u00e1t tri\u1ec3n l\u1ea7n \u0111\u1ea7u b\u1edfi nh\u1eefng nh\u00e0 h\u00ecnh h\u1ecdc vi ph\u00e2n. Ban \u0111\u1ea7u m\u1ee5c \u0111\u00edch c\u1ee7a ph\u01b0\u01a1ng ph\u00e1p n\u00e0y l\u00e0 t\u00ecm ra m\u1ed9t ph\u00e9p xoay kh\u00f4ng gian sao cho t\u00edch v\u00f4 h\u01b0\u1edbng c\u1ee7a c\u00e1c vector kh\u00f4ng thay \u0111\u1ed5i. T\u1eeb m\u1ed1i li\u00ean h\u1ec7 n\u00e0y kh\u00e1i ni\u1ec7m v\u1ec1 ma tr\u1eadn tr\u1ef1c giao \u0111\u00e3 h\u00ecnh th\u00e0nh \u0111\u1ec3 t\u1ea1o ra c\u00e1c ph\u00e9p xoay \u0111\u1eb7c bi\u1ec7t. Ph\u01b0\u01a1ng ph\u00e1p SVD \u0111\u00e3 \u0111\u01b0\u1ee3c ph\u00e1t tri\u1ec3n d\u1ef1a tr\u00ean nh\u1eefng t\u00ednh ch\u1ea5t c\u1ee7a ma tr\u1eadn tr\u1ef1c giao v\u00e0 ma tr\u1eadn \u0111\u01b0\u1eddng ch\u00e9o \u0111\u1ec3 t\u00ecm ra m\u1ed9t ma tr\u1eadn x\u1ea5p x\u1ec9 v\u1edbi ma tr\u1eadn g\u1ed1c. Ph\u01b0\u01a1ng ph\u00e1p n\u00e0y sau \u0111\u00f3 \u0111\u00e3 \u0111\u01b0\u1ee3c \u1ee9ng d\u1ee5ng r\u1ed9ng r\u00e3i trong c\u00e1c l\u0129nh v\u1ef1c nh\u01b0 h\u00ecnh h\u1ecdc vi ph\u00e2n, h\u1ed3i qui tuy\u1ebfn t\u00ednh, x\u1eed l\u00fd h\u00ecnh \u1ea3nh, clustering, c\u00e1c thu\u1eadt to\u00e1n n\u00e8n v\u00e0 gi\u1ea3m chi\u1ec1u d\u1eef li\u1ec7u, v\u00e0 \u0111\u1eb7c bi\u1ec7t \u0111\u1eb7c bi\u1ec7t hi\u1ec7u qu\u1ea3 trong c\u00e1c b\u00e0i to\u00e1n recommendation m\u00e0 ta s\u1ebd tr\u00ecnh b\u00e0y \u1edf cu\u1ed1i b\u00e0i vi\u1ebft.\n\n### 1.1.1. M\u1ee5c ti\u00eau c\u1ee7a ph\u00e2n t\u00edch suy bi\u1ebfn.\nPh\u01b0\u01a1ng ph\u00e1p SVD s\u1ebd t\u00ecm ra m\u1ed9t l\u1edbp c\u00e1c ma tr\u1eadn x\u1ea5p x\u1ec9 t\u1ed1t nh\u1ea5t v\u1edbi m\u1ed9t ma tr\u1eadn cho tr\u01b0\u1edbc d\u1ef1a tr\u00ean kho\u1ea3ng c\u00e1ch norm Frobenios gi\u1eefa 2 ma tr\u1eadn. Ng\u01b0\u1eddi ta \u0111\u00e3 ch\u1ee9ng minh \u0111\u01b0\u1ee3c r\u1eb1ng ma tr\u1eadn x\u1ea5p x\u1ec9 t\u1ed1t nh\u1ea5t \u0111\u01b0\u1ee3c bi\u1ec3u di\u1ec5n d\u01b0\u1edbi d\u1ea1ng t\u00edch c\u1ee7a 3 ma tr\u1eadn r\u1ea5t \u0111\u1eb7c bi\u1ec7t bao g\u1ed3m 2 *ma tr\u1eadn tr\u1ef1c giao* (orthogonal matrix) v\u00e0 1 *ma tr\u1eadn \u0111\u01b0\u1eddng ch\u00e9o* (diagonal matrix). Qu\u00e1 tr\u00ecnh nh\u00e2n ma tr\u1eadn th\u1ef1c ch\u1ea5t l\u00e0 qu\u00e1 tr\u00ecnh bi\u1ebfn \u0111\u1ed5i c\u00e1c \u0111i\u1ec3m d\u1eef li\u1ec7u c\u1ee7a ma tr\u1eadn g\u1ed1c th\u00f4ng qua nh\u1eefng ph\u00e9p xoay tr\u1ee5c (rotation) v\u00e0 ph\u00e9p thay \u0111\u1ed5i \u0111\u1ed9 l\u1edbn (scaling) v\u00e0 t\u1eeb \u0111\u00f3 t\u1ea1o ra nh\u1eefng \u0111i\u1ec3m d\u1eef li\u1ec7u m\u1edbi trong kh\u00f4ng gian m\u1edbi. \u0110i\u1ec1u \u0111\u1eb7c bi\u1ec7t c\u1ee7a ma tr\u1eadn \u0111\u01b0\u1eddng ch\u00e9o \u0111\u00f3 l\u00e0 c\u00e1c ph\u1ea7n t\u1eed c\u1ee7a n\u00f3 ch\u00ednh l\u00e0 nh\u1eefng gi\u00e1 tr\u1ecb ri\u00eang c\u1ee7a ma tr\u1eadn g\u1ed1c. Nh\u1eefng \u0111i\u1ec3m d\u1eef li\u1ec7u trong kh\u00f4ng gian m\u1edbi c\u00f3 th\u1ec3 gi\u1eef \u0111\u01b0\u1ee3c 100% th\u00f4ng tin ban \u0111\u1ea7u ho\u1eb7c ch\u1ec9 gi\u1eef m\u1ed9t ph\u1ea7n l\u1edbn th\u00f4ng tin c\u1ee7a d\u1eef li\u1ec7u ban \u0111\u1ea7u th\u00f4ng qua c\u00e1c ph\u00e9p truncate SVD. B\u1eb1ng c\u00e1ch s\u1eafp x\u1ebfp c\u00e1c tr\u1ecb ri\u00eang theo th\u1ee9 t\u1ef1 gi\u1ea3m d\u1ea7n tr\u00ean \u0111\u01b0\u1eddng ch\u00e9o ch\u00ednh thu\u1eadt to\u00e1n SVD c\u00f3 th\u1ec3 thu \u0111\u01b0\u1ee3c ma tr\u1eadn x\u1ea5p x\u1ec9 t\u1ed1t nh\u1ea5t m\u00e0 v\u1eabn \u0111\u1ea3m b\u1ea3o gi\u1ea3m \u0111\u01b0\u1ee3c h\u1ea1ng c\u1ee7a ma tr\u1eadn sau bi\u1ebfn \u0111\u1ed5i v\u00e0 k\u00edch th\u01b0\u1edbc c\u00e1c ma tr\u1eadn nh\u00e2n t\u1eed n\u1eb1m trong gi\u1edbi h\u1ea1n cho ph\u00e9p. Do \u0111\u00f3 n\u00f3 ti\u1ebft ki\u1ec7m \u0111\u01b0\u1ee3c th\u1eddi gian v\u00e0 chi ph\u00ed t\u00ednh to\u00e1n v\u00e0 \u0111\u1ed3ng th\u1eddi c\u0169ng t\u00ecm ra \u0111\u01b0\u1ee3c m\u1ed9t gi\u00e1 tr\u1ecb d\u1ef1 b\u00e1o cho ma tr\u1eadn g\u1ed1c v\u1edbi m\u1ee9c \u0111\u1ed9 ch\u00ednh x\u00e1c cao. \n\nTr\u00ean \u0111\u00e2y l\u00e0 nh\u1eefng th\u00f4ng tin chung nh\u1ea5t v\u1ec1 thu\u1eadt to\u00e1n SVD. Ch\u1eafc r\u1eb1ng ch\u00fang ta s\u1ebd r\u1ea5t m\u01a1 h\u1ed3 khi m\u1edbi l\u1ea7n \u0111\u1ea7u ti\u1ebfp c\u1eadn ph\u01b0\u01a1ng ph\u00e1p n\u00e0y. Ch\u00ednh v\u00ec v\u1eady ki\u1ebfn th\u1ee9c v\u1ec1 \u0111\u1ea1i s\u1ed1 tuy\u1ebfn t\u00ednh s\u1ebd \u0111\u01b0\u1ee3c h\u1ec7 th\u1ed1ng tr\u01b0\u1edbc khi \u0111i v\u00e0o thu\u1eadt to\u00e1n.\n\n## 1.2. Ki\u1ebfn th\u1ee9c chung v\u1ec1 \u0111\u1ea1i s\u1ed1 tuy\u1ebfn t\u00ednh.\n**H\u1ec7 tr\u1ef1c giao:** Trong \u0111\u1ea1i s\u1ed1 tuy\u1ebfn t\u00ednh, h\u1ec7 tr\u1ef1c giao l\u00e0 m\u1ed9t l\u00fd thuy\u1ebft quan tr\u1ecdng. M\u1ed9t h\u1ec7 vector c\u01a1 s\u1edf $\\mathbf{U = [u_1, u_2, ..., u_n]} \\in \\mathbb{R}^{n}$ \u0111\u01b0\u1ee3c g\u1ecdi l\u00e0 m\u1ed9t *h\u1ec7 tr\u1ef1c giao* (orthogonal) n\u1ebfu th\u1ecfa m\u00e3n h\u1ec7 \u0111i\u1ec1u ki\u1ec7n:\n$$\\mathbf{||u_i||_{2}^{2}} > 0, \\mathbf{u_{i}^{T}u_{j}} = 0 ~ \\forall 1 \\leq i \\neq j \\leq n$$\n\n**H\u1ec7 tr\u1ef1c chu\u1ea9n:** *H\u1ec7 tr\u1ef1c chu\u1ea9n* (orthonormal) l\u00e0 m\u1ed9t tr\u01b0\u1eddng h\u1ee3p \u0111\u1eb7c bi\u1ec7t c\u1ee7a h\u1ec7 tr\u1ef1c giao khi \u0111i\u1ec1u ki\u1ec7n $\\mathbf{||u_i||_{2}^{2}} > 0$ \u0111\u01b0\u1ee3c thay th\u1ec3 th\u00e0nh $\\mathbf{||u_i||_{2}^{2}} = 1$. \n\n**Ma tr\u1eadn tr\u1ef1c giao:** *Ma tr\u1eadn tr\u1ef1c giao* (orthogonal matrix) l\u00e0 ma tr\u1eadn vu\u00f4ng th\u1ecfa m\u00e3n c\u00e1c d\u00f2ng v\u00e0 c\u1ed9t c\u1ee7a n\u00f3 l\u00e0 m\u1ed9t h\u1ec7 tr\u1ef1c chu\u1ea9n. \u0110i\u1ec1u \u0111\u00f3 c\u00f3 ngh\u0129a l\u00e0 m\u1ed9t ma tr\u1eadn $\\mathbf{U} \\in \\mathbb{R}^{n \\times n}$ s\u1ebd bao g\u1ed3m c\u00e1c c\u1ed9t $\\mathbf{u}_{i} in \\mathbb{R}^{n}$ c\u00f3 t\u00ednh ch\u1ea5t:\n$$\\mathbf{||u_i||_{2}^{2}} > 0, \\mathbf{u_{i}^{T}u_{j}} = 0 ~ \\forall 1 \\leq i \\neq j \\leq n$$\nT\u1eeb \u0111\u00f3 suy ra \n$$\\mathbf{U^TU = I_{n}}$$\n\nMa tr\u1eadn tr\u1ef1c giao c\u00f3 nh\u1eefng t\u00ednh ch\u1ea5t \u0111\u1eb7c bi\u1ec7t sau:\n1. N\u1ebfu $\\mathbf{U}$ tr\u1ef1c giao th\u00ec $\\mathbf{U}^{T}$ c\u0169ng tr\u1ef1c giao.\n2. Ma tr\u1eadn tr\u1ef1c giao c\u00f3 chuy\u1ec3n v\u1ecb b\u1eb1ng ma tr\u1eadn ngh\u1ecbch \u0111\u1ea3o. T\u1eeb \u0111\u1eb3ng th\u1ee9c $\\mathbf{U^TU = I_{n}}$ suy ra $\\mathbf{U^{T} = U^{-1}}$.\n3. N\u1ebfu ma tr\u1eadn $\\mathbf{U} \\in \\mathbb{R}^{n \\times n}$ l\u00e0 ma tr\u1eadn tr\u1ef1c giao th\u00ec ma tr\u1eadn $\\mathbf{U_r} \\in \\mathbb{R}^{n \\times r}$ \u0111\u01b0\u1ee3c r\u00fat ra t\u1eeb $r$ c\u1ed9t \u0111\u1ea7u ti\u00ean c\u1ee7a ma tr\u1eadn $\\mathbf{U}$ c\u00f3 t\u00ednh ch\u1ea5t: $\\mathbf{U_r^{T}U_r = I_r}$.\n\u0110\u1ec3 ch\u1ee9ng minh t\u00ednh ch\u1ea5t n\u00e0y ta c\u1ea7n s\u1eed d\u1ee5ng \u0111\u1ebfn khai tri\u1ec3n t\u00edch c\u1ee7a 2 ma tr\u1eadn d\u1ef1a tr\u00ean c\u00e1c ma tr\u1eadn con (\u0111\u01b0\u1ee3c tr\u00edch ra t\u1eeb c\u00e1c d\u00f2ng v\u00e0 c\u1ed9t c\u1ee7a ma tr\u1eadn g\u1ed1c). Gi\u1ea3 s\u1eed $\\mathbf{A ,B} \\in \\mathbb{R}^{n \\times n}$. Ma tr\u1eadn $\\mathbf{M} \\in \\mathbb{R}^{r \\times n}$ g\u1ed3m $r$ d\u00f2ng \u0111\u1ea7u ti\u00ean c\u1ee7a ma tr\u1eadn $\\mathbf{A}$ v\u00e0 ma tr\u1eadn $\\mathbf{\\bar{M}}$ l\u00e0 ma tr\u1eadn ph\u1ea7n b\u00f9 c\u1ee7a $\\mathbf{U}$ \u0111\u01b0\u1ee3c t\u1ea1o th\u00e0nh t\u1eeb c\u00e1c d\u00f2ng c\u00f2n l\u1ea1i. T\u01b0\u01a1ng t\u1ef1, ma tr\u1eadn $\\mathbf{N} \\in \\mathbb{R}^{n \\times r}$ g\u1ed3m $r$ c\u1ed9t \u0111\u1ea7u ti\u00ean c\u1ee7a ma tr\u1eadn $\\mathbf{B}$ v\u00e0 $\\mathbf{\\bar{N}}$ l\u00e0 ma tr\u1eadn ph\u1ea7n b\u00f9 c\u1ee7a $\\mathbf{V}$. Khi \u0111\u00f3 t\u00edch $\\mathbf{AB}$ \u0111\u01b0\u1ee3c khai tri\u1ec3n theo $\\mathbf{M,N}$ v\u00e0 c\u00e1c ma tr\u1eadn ph\u1ea7n b\u00f9 nh\u01b0 sau:\n$$\\begin{bmatrix}\\mathbf{AB}\\end{bmatrix} = \n\\begin{bmatrix}\\mathbf{M} \\\\ \\mathbf{\\bar{M}}\\end{bmatrix}\n\\begin{bmatrix}\\mathbf{N} ~~ \\mathbf{\\bar{N}}\\end{bmatrix} = \n\\begin{bmatrix}\\mathbf{MN} ~~ \\mathbf{M\\bar{N}}\\\\ \\mathbf{\\bar{M}N} ~~ \\mathbf{\\bar{M}\\bar{N}}\\end{bmatrix}\n$$\nKhi \u00e1p d\u1ee5ng t\u00ednh ch\u1ea5t tr\u00ean cho ma tr\u1eadn $\\mathbf{U_r}$ ta suy ra t\u00edch $\\mathbf{U_r^{T}U_r}$ s\u1ebd l\u00e0 ma tr\u1eadn \u0111\u01b0\u1ee3c t\u1ea1o th\u00e0nh b\u1edfi r d\u00f2ng v\u00e0 r c\u1ed9t \u0111\u1ea7u ti\u00ean c\u1ee7a t\u00edch $\\mathbf{U^TU}$. Do \u0111\u00f3 $\\mathbf{U_r^{T}U_r}= \\mathbf{I_r}$.\n4. Ma tr\u1eadn tr\u1ef1c giao kh\u00f4ng l\u00e0m thay \u0111\u1ed5i gi\u00e1 tr\u1ecb t\u00edch v\u00f4 h\u01b0\u1edbng c\u1ee7a 2 vector. Th\u1eadt v\u1eady, n\u1ebfu coi $\\mathbf{x, y} \\in \\mathbb{R}^{n}$ l\u00e0 c\u00e1c vector \u0111\u01b0\u1ee3c bi\u1ebfn \u0111\u1ed5i b\u1eb1ng c\u00e1c nh\u00e2n v\u1edbi ma tr\u1eadn tr\u1ef1c giao $\\mathbf{U} \\in \\mathbb{R}^{n \\times n}$. Khi \u0111\u00f3 t\u00edch v\u00f4 h\u01b0\u1edbng c\u1ee7a 2 vector m\u1edbi nh\u01b0 sau:\n$$\\mathbf{(Ux)^{T}Uy} = \\mathbf{x^{T}U^{T}Uy} = \\mathbf{x^Ty}$$\n\n**Ma tr\u1eadn \u0111\u01b0\u1eddng ch\u00e9o:** M\u1ed9t ma tr\u1eadn $\\mathbf{D}$ l\u00e0 ma tr\u1eadn \u0111\u01b0\u1eddng ch\u00e9o khi c\u00e1c ph\u1ea7n t\u1eed c\u1ee7a n\u00f3 th\u1ecfa m\u00e3n:\n$$d_{ii} \\neq 0, d_{ij} = 0 ~ \\forall i \\neq j$$\nHay n\u00f3i c\u00e1ch kh\u00e1c ma tr\u1eadn c\u00f3 c\u00e1c ph\u1ea7n t\u1eed tr\u00ean \u0111\u01b0\u1eddng ch\u00e9o ch\u00ednh kh\u00e1c 0 v\u00e0 c\u00e1c ph\u1ea7n t\u1eed c\u00f2n l\u1ea1i b\u1eb1ng 0. Ma tr\u1eadn \u0111\u01a1n v\u1ecb $\\mathbf{I_n}$ l\u00e0 m\u1ed9t tr\u01b0\u1eddng h\u1ee3p \u0111\u1eb7c bi\u1ec7t c\u1ee7a ma tr\u1eadn \u0111\u01b0\u1eddng ch\u00e9o. Ma tr\u1eadn \u0111\u01b0\u1eddng ch\u00e9o c\u00f3 th\u1ec3 kh\u00f4ng vu\u00f4ng. Ngo\u00e0i ra ta c\u00f3 th\u1ec3 nh\u1eadn th\u1ea5y m\u1ed1i li\u00ean h\u1ec7 gi\u1eefa h\u1ec7 tr\u1ef1c giao v\u00e0 ma tr\u1eadn \u0111\u01b0\u1eddng ch\u00e9o \u0111\u00f3 l\u00e0 m\u1ed9t ma tr\u1eadn $\\mathbf{U} \\in \\mathbb{R}^{n \\times n}$ c\u00f3 c\u00e1c c\u1ed9t t\u1ea1o th\u00e0nh m\u1ed9t h\u1ec7 tr\u1ef1c giao th\u00ec t\u00edch c\u1ee7a n\u00f3 v\u1edbi ma tr\u1eadn chuy\u1ec3n v\u1ecb s\u1ebd t\u1ea1o th\u00e0nh m\u1ed9t ma tr\u1eadn \u0111\u01b0\u1eddng ch\u00e9o.\n\n**Trace c\u1ee7a ma tr\u1eadn:** h\u00e0m *trace* c\u1ee7a ma tr\u1eadn $\\mathbf{A}$ k\u00ed hi\u1ec7u l\u00e0 $\\mathbf{trace(A)}$ l\u00e0 t\u1ed5ng c\u1ee7a t\u1ea5t c\u1ea3 c\u00e1c ph\u1ea7n t\u1eed tr\u00ean \u0111\u01b0\u1eddng ch\u00e9o c\u1ee7a ma tr\u1eadn \u0111\u00f3. \nM\u1ed9t s\u1ed1 \u0111\u1eb3ng th\u1ee9c c\u1ee7a *trace*:\n\n1. $\\mathbf{trace(A) = trace(A^{T})}$. \u0110i\u1ec1u n\u00e0y l\u00e0 hi\u1ec3n nhi\u00ean do ph\u00e9p chuy\u1ec3n v\u1ecb kh\u00f4ng l\u00e0m thay \u0111\u1ed5i c\u00e1c v\u1ecb tr\u00ed tr\u00ean \u0111\u01b0\u1eddng ch\u00e9o ch\u00ednh c\u1ee7a $\\mathbf{A}$.\n\n2. $\\mathbf{trace(AB) = trace(BA)}$. Ch\u1ee9ng minh t\u00ednh ch\u1ea5t n\u00e0y kh\u00e1 \u0111\u01a1n gi\u1ea3n. Gi\u1ea3 s\u1eed $\\mathbf{A}^{(i)}$ l\u00e0 vector d\u00f2ng th\u1ee9 i c\u1ee7a $\\mathbf{A}$ v\u00e0 $\\mathbf{B}_{j}$ l\u00e0 vector c\u1ed9t th\u1ee9 j c\u1ee7a $\\mathbf{B}$. Khi \u0111\u00f3 ph\u1ea7n t\u1eed $AB_{ij}$ \u1edf d\u00f2ng th\u1ee9 i c\u1ed9t th\u1ee9 j c\u1ee7a ma tr\u1eadn t\u00edch $\\mathbf{AB}$ l\u00e0:\n$$AB_{ij} = \\mathbf{A}^{(i)}\\mathbf{B}_{j} = \\sum_{k}(a_{ik}b_{kj})$$\nDo \u0111\u00f3:\n$$\\mathbf{trace(AB)} = \\sum_{i} AB_{ii} = \\sum_{i}\\sum_{k}(a_{ik}b_{ki}) \\tag{1}$$\nHo\u00e0n to\u00e0n bi\u1ebfn \u0111\u1ed5i t\u01b0\u01a1ng t\u1ef1:\n$$\\mathbf{trace(BA)} = \\sum_{i} BA_{ii} = \\sum_{i}\\sum_{k}(b_{ik}a_{ki}) \\tag{2}$$\nTa nh\u1eadn th\u1ea5y ch\u1ec9 s\u1ed1 $i, k$ b\u00ecnh \u0111\u1eb3ng trong c\u1ea3 2 bi\u1ec3u th\u1ee9c (1) v\u00e0 (2) n\u00ean n\u1ebfu ho\u00e1n v\u1ecb i v\u00e0 k cho nhau kh\u00f4ng l\u00e0m thay \u0111\u1ed5i k\u1ebft qu\u1ea3 t\u1ed5ng. M\u1eb7t kh\u00e1c ph\u00e9p ho\u00e1n v\u1ecb n\u00e0y s\u1ebd bi\u1ebfn bi\u1ec3u th\u1ee9c (1) th\u00e0nh (2) n\u00ean suy ra gi\u00e1 tr\u1ecb c\u1ee7a 2 bi\u1ec3u th\u1ee9c l\u00e0 b\u1eb1ng nhau.\n3. $\\mathbf{trace(ABC) = trace(CAB) = trace(BCA)}$. T\u00ednh ch\u1ea5t n\u00e0y suy ra t\u1eeb t\u00ednh ch\u1ea5t 2.\n4. $\\mathbf{trace(A + B) = trace(A) + trace(B)}$. D\u1ec5 d\u00e0ng suy ra t\u00ednh ch\u1ea5t n\u00e0y do $\\mathbf{A, B}$ ph\u1ea3i c\u00f9ng k\u00edch th\u01b0\u1edbc v\u00e0 v\u1ecb tr\u00ed c\u00e1c ph\u1ea7n t\u1eed tr\u00ean \u0111\u01b0\u1eddng ch\u00e9o ch\u00ednh c\u1ee7a 2 ma tr\u1eadn n\u00e0y l\u00e0 tr\u00f9ng nhau.\n\n**Tr\u1ecb ri\u00eang c\u1ee7a ma tr\u1eadn:** Ch\u00fang ta ch\u1eafc h\u1eb3n \u0111\u00e3 l\u00e0m quen r\u1ea5t nhi\u1ec1u v\u1edbi tr\u1ecb ri\u00eang (eigen-value) c\u1ee7a m\u1ed9t ma tr\u1eadn vu\u00f4ng. \u0110\u00f3 l\u00e0 m\u1ed9t \u0111\u1ea1i l\u01b0\u1ee3ng v\u00f4 h\u01b0\u1edbng (scaler) c\u00f3 t\u00ednh ch\u1ea5t \u0111\u1eb7c bi\u1ec7t sau: ma tr\u1eadn $\\mathbf{A} \\in \\mathbb{R}^{n \\times n}$ c\u00f3 tr\u1ecb ri\u00eang l\u00e0 $\\lambda$ khi t\u1ed3n t\u1ea1i m\u1ed9t vector $\\mathbf{x} \\in \\mathbb{R}^{n}$ th\u1ecfa m\u00e3n:\n$$\\mathbf{Ax} = \\lambda \\mathbf{x}$$\nKhai tri\u1ec3n bi\u1ec3u th\u1ee9c tr\u00ean \u0111\u1ec3 \u0111\u01b0a v\u1ec1 d\u1ea1ng t\u00edch c\u1ee7a $\\mathbf{x}$:\n$$\\begin{eqnarray}\n\\mathbf{Ax} - \\lambda \\mathbf{x} & = & 0\\\\\n\\mathbf{Ax} - \\lambda \\mathbf{I}_{n} \\mathbf{x} & = & 0\\\\\n(\\mathbf{A} - \\lambda \\mathbf{I}_{n}) \\mathbf{x} & = & 0 \\tag{3}\\\\\n\\end{eqnarray}$$\nD\u00f2ng th\u1ee9 2 \u0111\u1ea1t \u0111\u01b0\u1ee3c l\u00e0 nh\u1edd t\u00edch c\u1ee7a m\u1ed9t ma tr\u1eadn v\u1edbi ma tr\u1eadn \u0111\u01a1n v\u1ecb th\u00ec b\u1eb1ng ch\u00ednh n\u00f3 ($\\mathbf{I}_{n} $ l\u00e0 k\u00ed hi\u1ec7u cho ma tr\u1eadn \u0111\u01a1n v\u1ecb b\u1eadc $n$). Ch\u00fang ta g\u1ecdi $\\mathbf{x}$ l\u00e0 vector ri\u00eang (eigen vector) \u1ee9ng v\u1edbi tr\u1ecb ri\u00eang $\\lambda$.\n\nTr\u1ecb ri\u00eang v\u00e0 vector ri\u00eang c\u1ee7a ma tr\u1eadn c\u00f3 nh\u1eefng t\u00ednh ch\u1ea5t \u0111\u1eb7c bi\u1ec7t sau:\n\n1. N\u1ebfu $\\mathbf{x}$ l\u00e0 vector ri\u00eang t\u01b0\u01a1ng \u1ee9ng c\u1ee7a tr\u1ecb ri\u00eang $\\lambda$ th\u00ec $k\\mathbf{x}$ c\u0169ng l\u00e0 m\u1ed9t vector ri\u00eang c\u1ee7a $\\lambda$. T\u00ednh ch\u1ea5t n\u00e0y cho th\u1ea5y m\u1ed9t tr\u1ecb ri\u00eang c\u00f3 th\u1ec3 c\u00f3 nhi\u1ec1u vector ri\u00eang. Tuy nhi\u00ean v\u1edbi m\u1ed9t vector ri\u00eang ch\u1ec9 c\u00f3 duy nh\u1ea5t m\u1ed9t tr\u1ecb ri\u00eang.\n1. M\u1ed9t ma tr\u1eadn c\u00f3 $n$ tr\u1ecb ri\u00eang bao g\u1ed3m c\u1ea3 l\u1eb7p l\u1ea1i v\u00e0 tr\u1ecb ri\u00eang ph\u1ee9c. \u0110i\u1ec1u n\u00e0y c\u00f3 \u0111\u01b0\u1ee3c l\u00e0 v\u00ec tr\u1ecb ri\u00eang  l\u00e0 nghi\u1ec7m c\u1ee7a m\u1ed9t \u0111a th\u1ee9c b\u1eadc $n$. Th\u1eadt v\u1eady, bi\u1ec3u th\u1ee9c (3) v\u1ec1 b\u1ea3n ch\u00e2t l\u00e0 t\u1ed5 h\u1ee3p tuy\u1ebfn t\u00ednh c\u1ee7a c\u00e1c c\u1ed9t ma tr\u1eadn $\\mathbf{A} - \\lambda \\mathbf{I}_{n}$ v\u1edbi c\u00e1c ph\u1ea7n t\u1eed c\u1ee7a vector $\\mathbf{x}$. Do k\u1ebft qu\u1ea3 b\u1eb1ng 0 n\u00ean c\u00e1c c\u1ed9t c\u1ee7a ma tr\u1eadn $\\mathbf{A} - \\lambda \\mathbf{I}_{n}$ l\u00e0 ph\u1ee5 thu\u1ed9c tuy\u1ebfn t\u00ednh. T\u1eeb \u0111\u00f3 suy ra $\\mathbf{det}(\\mathbf{A} - \\lambda \\mathbf{I}_{n}) = 0$. Tri\u1ec3n khai \u0111\u1ecbnh th\u1ee9c n\u00e0y ta thu \u0111\u01b0\u1ee3c m\u1ed9t \u0111a th\u1ee9c $\\mathbf{P}_{n}(\\lambda)$ b\u1eadc $n$. Do \u0111\u00f3 ma tr\u1eadn c\u00f3 $n$ tr\u1ecb ri\u00eang bao g\u1ed3m c\u1ea3 l\u1eb7p v\u00e0 ph\u1ee9c.\n2. Khi ma tr\u1eadn $\\mathbf{A}$ l\u00e0 ma tr\u1eadn \u0111\u1ed1i x\u1ee9ng th\u00ec c\u00e1c tr\u1ecb ri\u00eang c\u1ee7a $\\mathbf{A}$ l\u00e0 c\u00e1c s\u1ed1 th\u1ef1c.\n3. Khi ma tr\u1eadn $\\mathbf{A}$ l\u00e0 ma tr\u1eadn [x\u00e1c \u0111\u1ecbnh d\u01b0\u01a1ng](https:\/\/vi.wikipedia.org\/wiki\/Ma_tr\u1eadn_(to\u00e1n_h\u1ecdc) th\u00ec c\u00e1c tr\u1ecb ri\u00eang c\u1ee7a n\u00f3 l\u00e0 c\u00e1c s\u1ed1 th\u1ef1c d\u01b0\u01a1ng v\u00e0 n\u1ebfu ma tr\u1eadn $\\mathbf{A}$ l\u00e0 ma tr\u1eadn n\u1eeda x\u00e1c \u0111\u1ecbnh d\u01b0\u01a1ng th\u00ec c\u00e1c tr\u1ecb ri\u00eang c\u1ee7a n\u00f3 kh\u00f4ng \u00e2m. Ch\u1ee9ng minh nh\u01b0 sau: $\\lambda \\mathbf{x^{T}x} = \\mathbf{x^{T}Ax} > 0$ khi $\\mathbf{A}$ x\u00e1c \u0111\u1ecbnh d\u01b0\u01a1ng. M\u1eb7t kh\u00e1c $\\lambda \\mathbf{x^{T}x} = \\lambda \\mathbf{||x||_{2}^2}, \\mathbf{||x||_{2}^2} > 0 \\forall \\mathbf{x} \\neq 0$. Suy ra $\\lambda > 0$, nh\u01b0 v\u1eady m\u1ecdi tr\u1ecb ri\u00eang c\u1ee7a $\\mathbf{A}$ \u0111\u1ec1u d\u01b0\u01a1ng. Ch\u1ee9ng minh t\u01b0\u01a1ng t\u1ef1 cho tr\u01b0\u1eddng h\u1ee3p $\\mathbf{A}$ b\u00e1n x\u00e1c \u0111\u1ecbnh \u0111\u01b0\u01a1ng.\n4. T\u1ed5ng c\u00e1c ph\u1ea7n t\u1eed tr\u00ean \u0111\u01b0\u1eddng ch\u00e9o ch\u00ednh c\u1ee7a ma tr\u1eadn $\\mathbf{A} \\in \\mathbb{R}^{n \\times n}$ th\u00ec b\u1eb1ng t\u1ed5ng c\u00e1c tr\u1ecb ri\u00eang. \u0110\u1ec3 ch\u1ee9ng minh c\u00f4ng th\u1ee9c n\u00e0y c\u1ea7n s\u1eed d\u1ee5ng \u0111\u1ebfn ph\u00e9p ph\u00e2n t\u00edch ri\u00eang s\u1ebd \u0111\u01b0\u1ee3c tr\u00ecnh b\u00e0y b\u00ean d\u01b0\u1edbi. Khi ma tr\u1eadn $\\mathbf{A}$ \u0111\u1ed9c l\u1eadp tuy\u1ebfn t\u00ednh n\u00f3 c\u00f3 th\u1ec3 bi\u1ec3u di\u1ec5n d\u01b0\u1edbi d\u1ea1ng ph\u00e2n t\u00edch ri\u00eang nh\u01b0 sau:\n$$\\mathbf{A = PDP^{-1}}$$\n\u00c1p d\u1ee5ng h\u1eb1ng \u0111\u1eb3ng th\u1ee9c $\\mathbf{trace(AB) = trace(BA)}$ ta c\u00f3:\n$$\\mathbf{trace(A) = trace(PDP^{-1}) = trace((PD)P^{-1}) = trace(P^{-1}PD) = trace(D)}$$\nT\u1eeb \u0111\u00f3 suy ra t\u1ed5ng c\u00e1c ph\u1ea7n t\u1eed tr\u00ean \u0111\u01b0\u1eddng ch\u00e9o ch\u00ednh c\u1ee7a ma tr\u1eadn $\\mathbf{A}$ b\u1eb1ng t\u1ed5ng c\u00e1c tr\u1ecb ri\u00eang.\n5. \u0110inh th\u1ee9c c\u1ee7a ma tr\u1eadn $\\mathbf{A} \\in \\mathbb{R}^{n \\times n}$ th\u00ec b\u1eb1ng t\u00edch c\u00e1c tr\u1ecb ri\u00eang c\u1ee7a n\u00f3.\nS\u1eed d\u1ee5ng ph\u00e9p ph\u00e2n t\u00edch ri\u00eang \u0111\u1ed1i v\u1edbi ma tr\u1eadn $\\mathbf{A}$ \u0111\u1ed9 l\u1eadp tuy\u1ebfn t\u00ednh ta c\u00f3:\n$$\\mathbf{A = PDP^{-1}} \\Rightarrow \\mathbf{det(A) = det(PDP^{-1}) = det(P).det(D).det(P^{-1}) = det(D)}$$.\n\n**Ph\u00e9p ph\u00e2n t\u00edch ri\u00eang:** Ph\u00e9p ph\u00e2n t\u00edch ri\u00eang (EigenDecomposition) c\u0169ng l\u00e0 m\u1ed9t d\u1ea1ng matrix factorization. N\u00f3 c\u00f3 m\u1ed1i li\u00ean h\u1ec7 ch\u1eb7t ch\u1ebd v\u1edbi SVD. Trong \u0111\u1ea1i s\u1ed1 tuy\u1ebfn t\u00ednh ch\u00fang ta lu\u00f4n c\u00f3 th\u1ec3 ph\u00e2n t\u00edch m\u1ed9t ma tr\u1eadn vu\u00f4ng \u0111\u1ed9c l\u1eadp tuy\u1ebfn t\u00ednh $\\mathbf{A} \\in \\mathbb{R}^{n \\times n}$ th\u00e0nh t\u00edch c\u1ee7a nh\u1eefng ma tr\u1eadn vu\u00f4ng $\\mathbf{P} \\in \\mathbb{R}^{n \\times n}$ kh\u1ea3 ngh\u1ecbch v\u00e0 ma tr\u1eadn \u0111\u01b0\u1eddng ch\u00e9o $\\mathbf{D} \\in \\mathbb{R}^{n \\times n}$ theo c\u00f4ng th\u1ee9c:\n$$\\mathbf{A} = \\mathbf{PDP}^{-1}$$\n\u0110\u1eb3ng th\u1ee9c tr\u00ean t\u01b0\u01a1ng \u0111\u01b0\u01a1ng v\u1edbi:\n$$\\mathbf{AP} = \\mathbf{PD}$$\nB\u00e2y gi\u1edd ta ch\u1ec9 x\u00e9t \u0111\u1ebfn c\u1ed9t th\u1ee9 i c\u1ee7a c\u1ea3 2 ma tr\u1eadn b\u00ean v\u1ebf tr\u00e1i v\u00e0 ph\u1ea3i:\n$$\\mathbf{Ap_{i}} = \\mathbf{Pd_{i}}$$\nTrong \u0111\u00f3 $\\mathbf{p_{i}, d_{i}}$ l\u1ea7n l\u01b0\u1ee3t l\u00e0 c\u1ed9t th\u1ee9 i c\u1ee7a ma tr\u1eadn $\\mathbf{P}$ v\u00e0 $\\mathbf{D}$. M\u1eb7t kh\u00e1c do $\\mathbf{D}$ l\u00e0 ma tr\u1eadn \u0111\u01b0\u1eddng ch\u00e9o n\u00ean $\\mathbf{d_{i}}$ ch\u1ec9 c\u00f3 duy nh\u1ea5t m\u1ed9t ph\u1ea7n t\u1eed kh\u00e1c 0 l\u00e0 $d_{ii}$ n\u00ean $\\mathbf{Pd_{i}} = \\mathbf{p_{i}}d_{ii}$. Nh\u01b0 v\u1eady:\n$$\\mathbf{Ap_{i}} = \\mathbf{p_{i}}d_{ii}$$\n\u0110\u00e2y ch\u00ednh l\u00e0 ph\u01b0\u01a1ng tr\u00ecnh x\u00e1c \u0111\u1ecbnh tr\u1ecb ri\u00eang c\u1ee7a $\\mathbf{A}$. Ta c\u00f3 th\u1ec3 th\u1ea5y $d_{ii}$ ch\u00ednh l\u00e0 tr\u1ecb ri\u00eang c\u1ee7a ma tr\u1eadn $\\mathbf{A}$ v\u00e0 $\\mathbf{p_{i}}$ l\u00e0 c\u00e1c vector ri\u00eang t\u01b0\u01a1ng \u1ee9ng c\u1ee7a $d_{ii}$.\n\nNh\u01b0 v\u1eady \u0111i\u1ec3m \u0111\u1eb7c bi\u1ec7t c\u1ee7a ph\u00e2n t\u00edch ri\u00eang \u0111\u00f3 l\u00e0 \u0111\u01b0\u1eddng ch\u00e9o ch\u00ednh c\u1ee7a $\\mathbf{D}$ l\u00e0 c\u00e1c tr\u1ecb ri\u00eang c\u1ee7a ma tr\u1eadn $\\mathbf{A}$ v\u00e0 c\u00e1c c\u1ed9t c\u1ee7a $\\mathbf{P}$ l\u00e0 c\u00e1c vector ri\u00eang t\u01b0\u01a1ng \u1ee9ng v\u1edbi tr\u1ecb ri\u00eang n\u1eb1m tr\u00ean \u0111\u01b0\u1eddng ch\u00e9o ch\u00ednh. Ngo\u00e0i ra ph\u00e9p ph\u00e2n t\u00edch ri\u00eang kh\u00f4ng l\u00e0 duy nh\u1ea5t. N\u1ebfu ma tr\u1eadn tr\u1ef1c giao $\\mathbf{P}$ th\u1ecfa m\u00e3n ph\u01b0\u01a1ng tr\u00ecnh ph\u00e2n t\u00edch ri\u00eang th\u00ec ma tr\u1eadn $k\\mathbf{P}$ c\u0169ng th\u1ecfa m\u00e3n ph\u01b0\u01a1ng tr\u00ecnh ph\u00e2n t\u00edch ri\u00eang \u0111\u00f3.","6b30f21a":"Ta s\u1ebd th\u1ef1c hi\u1ec7n n\u00e9n \u1ea3nh theo ph\u01b0\u01a1ng ph\u00e1p SVD sao cho ch\u1ec9 l\u1ea5y l\u1ea7n l\u01b0\u1ee3t v\u1edbi 10 v\u00e0 20 tr\u1ecb ri\u00eang l\u1edbn nh\u1ea5t \u0111\u1ec3 l\u01b0u gi\u1eef th\u00f4ng tin.","5b9793d2":"## 2.2. Gi\u1ea3m chi\u1ec1u d\u1eef li\u1ec7u h\u00ecnh \u1ea3nh.\n\nGi\u1ea3 s\u1eed ta c\u00f3 m\u1ed9t t\u1eadp d\u1eef li\u1ec7u nhi\u1ec1u \u1ea3nh c\u00f3 k\u00edch th\u01b0\u1edbc r\u1ea5t l\u1edbn. Kh\u1ea3 n\u0103ng l\u01b0u tr\u1eef c\u1ee7a server l\u00e0 c\u00f3 h\u1ea1n. Trong t\u00ecnh hu\u1ed1ng n\u00e0y l\u00e0m th\u1ec3 n\u00e0o \u0111\u1ec3 gi\u1ea3m k\u00edch th\u01b0\u1edbc c\u1ee7a b\u1ed9 \u1ea3nh v\u1eeba v\u1edbi dung l\u01b0\u1ee3ng server m\u00e0 th\u00f4ng tin c\u1ee7a c\u00e1c b\u1ee9c \u1ea3nh v\u1eabn gi\u1eef \u0111\u01b0\u1ee3c m\u1ed9t l\u01b0\u1ee3ng l\u1edbn. C\u00e2u tr\u1ea3 l\u1eddi s\u1ebd c\u00f3 sau khi khi ta th\u1ef1c h\u00e0nh n\u00e9n m\u1ed9t b\u1ee9c \u1ea3nh b\u1eb1ng thu\u1eadt to\u00e1n truncate SVD.\n\n**B\u1ee9c \u1ea3nh g\u1ed1c**","2777a694":"**K\u1ebft qu\u1ea3 n\u00e9n \u1ea3nh v\u1edbi l\u1ea7n l\u01b0\u1ee3t 10 v\u00e0 20 tr\u1ecb ri\u00eang l\u1edbn nh\u1ea5t**","349519bd":"Nh\u01b0 v\u1eady v\u1edbi 10 tr\u1ecb ri\u00eang l\u1edbn nh\u1ea5t \u0111\u00e3 th\u1ec3 hi\u1ec7n \u0111\u01b0\u1ee3c \u0111\u01b0\u1ee3c 99.39% th\u00f4ng tin b\u1ee9c \u1ea3nh v\u00e0 v\u1edbi 20 tr\u1ecb ri\u00eang l\u1edbn nh\u1ea5t th\u1ec3 hi\u1ec7n \u0111\u01b0\u1ee3c 99.74% th\u00f4ng tin b\u1ee9c \u1ea3nh. So v\u1edbi b\u1ee9c \u1ea3nh g\u1ed1c ta ph\u1ea3i l\u01b0u tr\u1eef ma tr\u1eadn c\u00f3 k\u00edch th\u01b0\u1edbc l\u00e0 330x500. Trong khi v\u1edbi 20 chi\u1ec1u vector ta ch\u1ec9 ph\u1ea3i l\u01b0u tr\u1eef c\u00e1c ma tr\u1eadn $\\mathbf{U_t}, \\mathbf{V_t}$ c\u00f3 k\u00edch th\u01b0\u1edbc l\u00e0 330x20, 20x500 v\u00e0 ma tr\u1eadn $\\mathbf{S}$ c\u00f3 k\u00edch th\u01b0\u1edbc l\u00e0 20x20. Gi\u1ea3 \u0111\u1ecbnh m\u1ed7i ph\u1ea7n t\u1eed c\u1ee7a ma tr\u1eadn \u0111\u01b0\u1ee3c l\u01b0u v\u1edbi c\u00f9ng s\u1ed1 byte. Nh\u01b0 v\u1eady s\u1ed1 l\u01b0\u1ee3ng th\u00f4ng tin ta c\u1ea7n l\u01b0u ch\u1ec9 l\u00e0:\n$$\\frac{330 \\times 20 + 20 \\times 500 + 20 \\times 20}{330 \\times 500} = 10 \\text{%}$$\nD\u00f3 \u0111\u00f3 ph\u01b0\u01a1ng ph\u00e1p truncate SVD th\u01b0\u1eddng \u0111\u01b0\u1ee3c s\u1eed d\u1ee5ng trong n\u00e9n th\u00f4ng tin r\u1ea5t hi\u1ec7u qu\u1ea3."}}