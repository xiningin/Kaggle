{"cell_type":{"8cd8d860":"code","94597ed2":"code","f2b9e66c":"code","cc6f1535":"code","a53778d3":"code","5d57e0ac":"code","f1911c82":"code","5531defc":"code","c800eff9":"code","20a0e256":"code","f56357f5":"code","6a52f42c":"code","3b96550f":"code","b494cb54":"markdown","2eee7f66":"markdown","f46fad04":"markdown","440caa6c":"markdown","8a9e3e19":"markdown","267e1fff":"markdown","e7ac6b4f":"markdown","1e18a7da":"markdown","8c5a7b56":"markdown","fa512979":"markdown"},"source":{"8cd8d860":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.preprocessing import LabelEncoder\nimport os\n\npd.set_option('display.max_columns', None)","94597ed2":"test = pd.read_csv(\"\/kaggle\/input\/caisx\/test_data.csv\")\ntrain = pd.read_csv(\"\/kaggle\/input\/caisx\/train_data.csv\")","f2b9e66c":"train.head()","cc6f1535":"train['G3'].describe()","a53778d3":"sns.displot(train['G3'], bins=20)","5d57e0ac":"#skewness and kurtosis\nprint(\"Skewness: %f\" % train['G3'].skew())\nprint(\"Kurtosis: %f\" % train['G3'].kurt())","f1911c82":"num_cols = train._get_numeric_data().columns\ncategorical_cols = train.columns[~train.columns.isin(num_cols)]","5531defc":"fig, axes = plt.subplots(12, 3, figsize=(20, 90), sharey=True)\nfig.subplots_adjust(hspace=0.4, wspace=0.4)\ni=0\nj=0\nfor col in categorical_cols:\n    sns.stripplot(ax=axes[j,i], x=col, y='G3', data=train, jitter=True, edgecolor='none', alpha = 0.4)\n    axes[j,i].set_title(col)\n    if i == 2:\n        j=j+1\n        i=-1\n    i+=1\n    \nfor col in num_cols:\n    sns.boxplot(ax=axes[j,i], x=col, y='G3', data=train)\n    if i == 2:\n        j=j+1\n        i=-1\n    i+=1","c800eff9":"binary = ['schoolsup', 'famsup', 'paid', 'activities', 'nursery', 'higher', 'internet', 'romantic', 'Math', 'Portuguese', 'Pstatus', 'famsize', 'school']\nnominal = ['Mjob', 'Fjob', 'reason', 'guardian']\nordinal = [] # There are no ordinal variables that aren't binary","20a0e256":"# encode binary variables\n# label_encoder object knows how to understand word labels.\nlabel_encoder = LabelEncoder()\n\nfor i in binary:\n    train[i] = label_encoder.fit_transform(train[i])\n\n# encode nominal variables using one hot encoding\nfor j in nominal:\n    train = pd.concat([train, pd.get_dummies(train[j], prefix=j)], axis=1)\n    train.drop(j, axis=1, inplace=True)","f56357f5":"corrmat = train.corr()\nf, ax = plt.subplots(figsize=(16, 16))\nsns.heatmap(corrmat, vmax=.8, square=True)","6a52f42c":"k = 10 #number of variables for heatmap\ncols = corrmat.nlargest(k, 'G3')['G3'].index\ncm = np.corrcoef(train[cols].values.T)\nsns.set(font_scale=1.25)\nhm = sns.heatmap(cm, cbar=True, annot=True, square=True, fmt='.2f', annot_kws={'size': 10}, yticklabels=cols.values, xticklabels=cols.values)\nplt.show()","3b96550f":"train.drop(['Portuguese'], axis=1, inplace=True)","b494cb54":"## Encoding\n- There are categorical variables that we can encode (turn to numeric varibales), we're going to do this in order to include them in our heatmap.\n- Any variable that has no\/yes values can be encoded to 0\/1.\n\nNorminal Encoding - Where order of data doesn't matter\n- We will using One Hot Encoding (OHE)\n\nOrdinal Encoding - Where order of data matters\n- We will use Label Encoding","2eee7f66":"I hope this gave you an idea on where to start by understanding our variables to a deeper level.\nGood luck everyone!","f46fad04":"## Imports","440caa6c":"## Relationship with numeric variables","8a9e3e19":"As you can see from this graph, it will be important to predict not just the final grade, but whether a student failed or not. ","267e1fff":">- Let's keep these plots in mind when checking out the correlations below.\n>- One important thing to note is that G1 and G2 are seemingly the only variables that have a strong correlation with G3. We will confirm\/deny this in the next section. ","e7ac6b4f":"## Twins\n>- We can see that Math and Portuguese have an opposite correlation of eachother, only one of them will be valuble in the model.\n>- They are essentially the same variable but opposite, include one will act as a binary value.\n>- (A student is either a Portuguese or a Math student, not both)","1e18a7da":"## Exploration of G3 Variable\nWhat is G3?\n>- G3 is the our target, what we are trying to predict\n>- A students final grade 0-20","8c5a7b56":"The following graphs show G3 mapped with each variable, this is a good way to see how the data is distributed, and if there are any patterns to help us predict G3.","fa512979":"The heatmap is one of the best ways to get a quick overview of our data, seeing what correlation exists between the variables.\n\nIf we look at the 'G3' variable, there a few correlations to take note of,\n- G1 and G2 : have very high correlation, we will plot them below to take a look\n- failures : has a negative correlation - higher amount of failures, lower the grade\n- studytime, higher(wants to take higher education),   : notable positive correlation, should help us in predicting the final grade\n- the rest have around no correlation, most should still be used in modelling despite the lack of correlation, any help we can get will improve the model."}}