{"cell_type":{"2091c3c4":"code","fd1059af":"code","476a8f95":"code","52e150a1":"code","61b4d549":"code","e8756d19":"code","30bb05a2":"code","fc6e85d8":"code","15086063":"code","3f015bd7":"code","dc585d98":"code","f53fb978":"code","403c5aa8":"code","e7ce51f9":"code","9dba273c":"code","7a5b73a1":"code","77d8083e":"code","669e40bd":"code","18c8d33d":"code","19313143":"code","935f725f":"code","18a339b3":"code","13a360f3":"code","34934b6c":"code","7d78bccc":"code","0afb2a7b":"code","4f98b836":"code","08b9762a":"code","33fe07be":"code","a1fe1b8c":"code","50016b14":"code","eb225f67":"code","f6a24669":"code","c2a317c6":"code","c2db80f2":"code","4d74aecb":"markdown","06b5dbec":"markdown","bcd5800f":"markdown","5f92a09a":"markdown","e4876325":"markdown","b4b1e722":"markdown","591cc7fa":"markdown","4617c578":"markdown","dbe51965":"markdown","c5878497":"markdown","fb525d54":"markdown","53248e98":"markdown","dd5571f8":"markdown","93fec687":"markdown","ca23922c":"markdown","53a6dea6":"markdown","5e382425":"markdown","33592e56":"markdown","85d2cd4b":"markdown","cfc69c7c":"markdown","2d50653b":"markdown","71834e73":"markdown","be44e107":"markdown","c5fcb75c":"markdown","2a4ef470":"markdown"},"source":{"2091c3c4":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set_palette(\"rainbow\")\nsns.set_style('whitegrid')\n%matplotlib inline\nimport missingno as msno\n\nimport warnings\nwarnings.filterwarnings('ignore')\n\nfrom sklearn import model_selection\nfrom sklearn.model_selection import cross_val_score, KFold, train_test_split\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn import tree\nfrom sklearn.tree import DecisionTreeClassifier, export_graphviz","fd1059af":"df = pd.read_csv(\"..\/input\/train.csv\")","476a8f95":"df.head()","52e150a1":"df.info()","61b4d549":"df['Dependents'].unique()","e8756d19":"msno.matrix(df)","30bb05a2":"missing_values = df.isnull().sum().sort_values(ascending = False)\nmissing_values","fc6e85d8":"df['Dependents'].replace(to_replace = '3+', value = 3, inplace = True)\ndf['Dependents'].fillna(df['Dependents'].median(), inplace = True)\ndf['Dependents'] = df['Dependents'].astype(int)","15086063":"df['LoanAmount'].fillna(df['LoanAmount'].mean(), inplace = True)\ndf['Loan_Amount_Term'].fillna(df['Loan_Amount_Term'].mean(), inplace = True)","3f015bd7":"for column in ['Credit_History', 'Self_Employed', 'Gender', 'Married']:\n    df[column].fillna(df[column].ffill(), inplace=True)","dc585d98":"sns.boxplot('Loan_Status','LoanAmount', data = df)","f53fb978":"sns.boxplot('Loan_Status','CoapplicantIncome', data = df)","403c5aa8":"sns.boxplot('Loan_Status','ApplicantIncome', data = df)","e7ce51f9":"sns.catplot(x=\"Loan_Status\", y=\"LoanAmount\", hue=\"Gender\", kind=\"bar\", data=df);","9dba273c":"sns.catplot(x=\"Loan_Status\", y=\"LoanAmount\", hue=\"Education\", kind= \"bar\" , data=df)","7a5b73a1":"df.drop(df[df['CoapplicantIncome']>10000].index, inplace= True)\ndf.drop(df[df['ApplicantIncome']>20000].index, inplace= True)\ndf.drop(df[df['LoanAmount']>550].index, inplace= True)","77d8083e":"df['total_amount'] = df['ApplicantIncome'] +df['CoapplicantIncome']\ndf['ratio']= df['total_amount']\/df['LoanAmount']","669e40bd":"sns.distplot(df['ApplicantIncome'])","18c8d33d":"df.describe()","19313143":"df.skew(axis=0).sort_values(ascending= False)","935f725f":"cols = ['ratio','LoanAmount','total_amount']\ndf[cols] = np.log1p(df[cols])","18a339b3":"df.drop('Loan_ID', axis = 1, inplace = True)\ndf.drop('ApplicantIncome', axis = 1, inplace = True)\ndf.drop('CoapplicantIncome', axis = 1, inplace = True)","13a360f3":"df1 = pd.get_dummies(df, columns=list(df.select_dtypes(exclude=np.number)))\ndf1.head()","34934b6c":"col= ['Loan_Status_N','Loan_Status_Y']\ndf1.drop(columns = col,axis = 1,inplace = True)","7d78bccc":"df1.head()","0afb2a7b":"df1['Loan_status'] = df[\"Loan_Status\"]\nX = df1.iloc[:,0:16]\ny = df1.iloc[:,17]","4f98b836":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33, random_state=42)","08b9762a":"rf = RandomForestClassifier()\nm = rf.fit(X_train, y_train)\ny_pred = m.predict(X_test)\naccuracy_score(y_test, y_pred)","33fe07be":"import sklearn.model_selection as ms\nparameters= {'n_estimators':[5,50,500],\n            'max_depth':[5,10,12,15],\n            'max_features':[5,10,15],\n            'min_samples_split' : [2, 5, 10],\n            'min_samples_leaf' : [1, 2, 4]}\n\n\nrf = RandomForestClassifier()\nrf_model = ms.GridSearchCV(rf, param_grid=parameters, cv=5)\nrf_model.fit(X_train,y_train)\n\nprint('The best value of Alpha is: ',rf_model.best_params_)","a1fe1b8c":"rf1 = RandomForestClassifier(n_estimators = 500,max_depth = 10, max_features=15, min_samples_leaf = 4, min_samples_split= 10,bootstrap = True)\nrf_random = rf1.fit(X_train,y_train)\n\nscores_rf = cross_val_score(rf_random, X_train, y_train, cv=5)\nscores_rf.mean()","50016b14":"y_pred = rf_random.predict(X_test)\naccuracy_score(y_test, y_pred)","eb225f67":"from sklearn.model_selection import RandomizedSearchCV\nrandom_grid ={'bootstrap': [True, False],\n             'max_depth': [10, 20, 30, 40, 50, 60, 70, 80, 90, 100],\n             'max_features': [1,3,5,7,9,11,13,15],\n             'min_samples_leaf': [1, 2,3, 4],\n             'min_samples_split': [2, 5, 10],\n             'n_estimators': [50,100,500,1000]}\n\nrf = RandomForestClassifier()\nrf_random = RandomizedSearchCV(estimator = rf, param_distributions = random_grid, n_iter = 50, cv = 3, verbose=2, random_state=42, n_jobs = -1)","f6a24669":"rf_random.fit(X_train,y_train)\nrf_random.best_params_","c2a317c6":"rf = RandomForestClassifier(n_estimators = 500,max_depth = 10, max_features=5, min_samples_leaf = 3, min_samples_split= 10,bootstrap = True)\nrf_random = rf.fit(X_train,y_train)\n\nscores_rf = cross_val_score(rf_random, X_train, y_train, cv=5)\nscores_rf.mean()","c2db80f2":"y_pred = rf_random.predict(X_test)\naccuracy_score(y_test, y_pred)","4d74aecb":"The boxplots give us an idea about outliers in the numerical columns. Also, the bar plots estimates the mean values of different categories.","06b5dbec":"# Dropping the outliers","bcd5800f":"# CHECKING THE SKEWNESS OF THE DATA","5f92a09a":"## That was my beginner code and I am proud to say I have come a long way and look forward to keep going. This was something which gave me the boost to keep working. I hope it helps you the same! \n\n## THANK YOU! Keep learning. Upvote | Comment | Share.","e4876325":"For the categorical columns,we use the ffill method.  'ffill' stands for 'forward fill' and will propagate last valid observation forward.","b4b1e722":"Dropping the columns that are not required.","591cc7fa":"Categorical columns will give an error if you try to plug these variables into most machine learning models in Python without \"encoding\" them first. One hot encoding creates new (binary) columns, indicating the presence of each possible value from the original data.","4617c578":"Creating two new features as per our intuition.","dbe51965":"The plot gives us a general idea about the completeness of the data where the white horizontal lines represent missing values. Let us go ahead and find the exact number of missing values in our data","c5878497":"Taking a first look at our data.","fb525d54":"As we saw in the boxplots, there are some outliers in our data. It is best to remove them for better results.","53248e98":"Now randomized search is supposed to be faster and give better results (if you know about your model and its parameters).","dd5571f8":"We need to change the datatype of dependents to an integer and fill the missing values. For Loan amount and its term, we fill the missing values with their respective mean.","93fec687":"We notice some missing values in the data. Also, the Dependents column represents a numerical value(number of dependents on the applicant). But it is of object datatype. So let us check what unique values does that column hold.","ca23922c":"# IMPORTING ALL THE REQUIRED LIBRARIES","53a6dea6":"The ApplicantIncome looks skewed so we look at the other numerical columns for skewness and transform the required columns to fit normal distribution.","5e382425":"# CONVERTING CATEGORICAL COLUMNS TO NUMERICAL ONES","33592e56":"Starting off with hackathons for the first time but dont know how to approach a problem? Built a basic model but not able to improve scores? This notebook is for you! \n\nWhen I started my journey, I often used to feel lost. This gave me inspiration to upload a notebook for those who struggle during their initial days of solving a problem. This notebook demonstrates the pre-processing and model tuning steps for the same. I have used the ever famous Loan Prediction problem for this notebook. With this approach I was among the top 2% in the competition.\n\n**UPVOTE IF YOU LIKE MY EFFORTS. IT KEEPS ME MOTIVATED TO PUBLISH QUALITY CONTENT.**","85d2cd4b":"# Splitting the data and fitting a basic model first","cfc69c7c":"# CHECKING FOR MISSING DATA AND FILLING THE VALUES","2d50653b":"Observe that we get a decent accuracy score by pre processing our data correctly. \nLet us go ahead and tune our model to improve the accuracy.","71834e73":"Now, this gives us the best parameters but takes a lot of time as it is an iterative process and tries out all the possiblities. Quite tiresome.","be44e107":"# VISUALIZATIONS","c5fcb75c":"The problem statement requires automating the loan eligibility process (real time) based on customer detail provided while filling online application form. These details are Gender, Marital Status, Education, Number of Dependents, Income, Loan Amount, Credit History and others. ","2a4ef470":"# Model Fitting with Hyperparameter Tuning\nNow, parameter tuning is driven by the knowledge of parameters and your model. Given the amount of computational resources we have, we need that knowledge to select the range for our parameter search better. Do play around before setting up the parameter search. It will give you better idea into how your model is working for the dataset. So DO NOT AVOID GOING IN-DEPTH with your theory!\n\nThat knowledge will work wonders for your leaderboard in any competition you take part in. DO NOT SKIP IT! "}}