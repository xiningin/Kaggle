{"cell_type":{"f391b91d":"code","5d09403d":"code","68b9e4d2":"code","c309a532":"code","e3ce3462":"code","97b9f46a":"code","b8a2e383":"code","32a156ee":"code","5a366e62":"code","172cca95":"markdown","44b70468":"markdown","9d167305":"markdown","5b8e0f63":"markdown","9ee5b600":"markdown","1d18461f":"markdown","d3a5f157":"markdown"},"source":{"f391b91d":"import pandas as pd\n# Not limiting the column number when displaying dataframe\npd.set_option(\"display.max_columns\", None)","5d09403d":"df = pd.read_csv(\"..\/input\/customer-personality-analysis\/marketing_campaign.csv\", sep = \"\\t\", skipinitialspace = True)\n\ndf = df.fillna(0)\n\ndf.head()","68b9e4d2":"df[\"Education\"] = df[\"Education\"].astype(str)\ndf[\"Marital_Status\"] = df[\"Marital_Status\"].astype(str)\ndf[\"Dt_Customer\"] = df[\"Dt_Customer\"].astype(str)\n\nfrom sklearn import preprocessing\n\nnumber = preprocessing.LabelEncoder()\n\ndf[\"Education\"] = number.fit_transform(df[\"Education\"])\ndf[\"Marital_Status\"] = number.fit_transform(df[\"Marital_Status\"])\ndf[\"Dt_Customer\"] = number.fit_transform(df[\"Dt_Customer\"])\n\ndf.head()","c309a532":"X = df[[\"Income\", \"MntWines\"]]\n\nfrom sklearn.preprocessing import StandardScaler\n\nscaler = StandardScaler()\n\nX_transformed = scaler.fit_transform(X)","e3ce3462":"X_transformed","97b9f46a":"from sklearn.cluster import KMeans\n\nmodel = KMeans(n_clusters = 6)\n\nmodel.fit(X_transformed)","b8a2e383":"labels = model.labels_\n\nprint(labels)","32a156ee":"centers = model.cluster_centers_\ncenters_transformed = scaler.inverse_transform(centers)\nprint(scaler.inverse_transform(centers))","5a366e62":"import matplotlib.pyplot as plt\n\nplt.figure(figsize = (16, 16))\nplt.title(\"Clusters created by KMeans (Displayed for Income and Money spent on wine)\", fontsize = 20)\nplt.xlabel(\"Income\", fontsize = 16)\nplt.ylabel(\"MntWines\", fontsize = 16)\n\nplt.scatter(df[\"Income\"], df[\"MntWines\"], c = labels, s = 10, alpha = 0.5)\nplt.scatter(centers_transformed[:, 0], centers_transformed[:, 1], c = \"red\", marker = \"X\", s = 50)\nplt.show()","172cca95":"#### **Clustering**","44b70468":"#### **Scaling data**","9d167305":"#### **Visualizing Clusters**","5b8e0f63":"# **Customer Grouping**","9ee5b600":"### **Loading & Visualizing data**","1d18461f":"#### **Pre-processing data**","d3a5f157":"### **Clustering**"}}