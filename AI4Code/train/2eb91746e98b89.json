{"cell_type":{"947471da":"code","fa57e702":"code","601cdee5":"code","0d4d6951":"code","5a7c2627":"code","e4d85c9d":"code","fd987480":"code","e5c6b879":"code","9d8d5faf":"code","86d9b18d":"code","062e791e":"code","0c413cd9":"code","0d794b05":"code","37afc58f":"code","83f4c493":"code","2dba1ecf":"code","c4ff8c97":"code","ea457fac":"code","02902f43":"code","197bada5":"code","d154954d":"code","67bead1f":"code","681e9fbb":"code","e70036b8":"code","5245fed5":"code","e7a24da9":"code","2712ccb8":"code","717b6887":"code","0a4f1979":"code","ee40a035":"code","1b5f8bfe":"code","8675f667":"code","5c906136":"code","92d3a9b9":"code","6264641d":"code","63673035":"code","9fcd27d7":"code","5b888a10":"code","5b62d086":"code","080fa2c4":"code","f608084a":"code","6e179c81":"code","2a22c4ba":"code","a63ba38d":"code","0669f452":"code","53586a98":"code","75f14e88":"code","e9e728df":"code","d5eb0023":"code","cc91216d":"code","8b33c93f":"code","022cc2c7":"code","e5f29bbe":"code","2bd6375f":"code","e12edcc4":"code","8c507f7a":"code","c533a76d":"code","821e840b":"code","c4261567":"code","dd30badc":"code","632de626":"code","29fb64d8":"code","c61e04b0":"code","3d0bbf93":"code","345e42af":"code","1be094d4":"code","eb6a5ef6":"code","df86c441":"markdown","2f6577dd":"markdown","da2cce4c":"markdown","73f35421":"markdown","57feae03":"markdown","bcee57a9":"markdown","fd1481f8":"markdown","432c0fdd":"markdown","96d94357":"markdown","5a4cfe3b":"markdown","b488f2fc":"markdown","ced4dc92":"markdown","02bab6bc":"markdown","90271324":"markdown","69642add":"markdown"},"source":{"947471da":"#import modules\nimport pandas as pd\nimport numpy as np","fa57e702":"# enable showing all columns and rows\npd.set_option('display.max_columns', None)\npd.set_option('display.max_rows', None)\n\n# load dataframe\ndf = pd.read_csv(\"..\/input\/us-election-2020\/president_county_candidate.csv\")\n\n# change boolean value to integer for easier use\nmask = df.applymap(type) != bool\nd = {True: 1, False: 0}\ndf = df.where(mask, df.replace(d))\n\n# remove the word \"County\" from county names to sync dataframes\ndf['county'] = df['county'].str.replace('County', '')","601cdee5":"# create two subsets based on who won an individual county\ndf_biden_won = df[(df['won'] == 1) & (df['candidate'] == 'Joe Biden')] \ndf_trump_won = df[(df['won'] == 1) & (df['candidate'] == 'Donald Trump')]","0d4d6951":"df_biden_won.dtypes","5a7c2627":"df_biden_won = df_biden_won.sort_values(by = 'county', ascending = True) \n\n# reset index \ndf_biden_won.reset_index(inplace = True) \n\n# select and drop original columns relevant to task at hand\ncol = ['index']\ndf_biden_won = df_biden_won.drop(col, axis=1)\n\ndf_biden_won.head(20)","e4d85c9d":"df_trump_won = df_trump_won.sort_values(by = 'county', ascending = True) \n\n# reset index \ndf_trump_won.reset_index(inplace = True) \n\n# select and drop original columns relevant to task at hand\ncol = ['index']\ndf_trump_won = df_trump_won.drop(col, axis=1)\n\ndf_trump_won.head(20)","fd987480":"# remove whitespace in column names to enable further merge\ndf_biden_won.state = df_biden_won.state.str.replace(' ', '')\ndf_biden_won.county = df_biden_won.county.str.replace(' ', '')\n\n# create 'CountyState' column with both county and state name\n# this is for preventing mixing different counties with the same name\ndf_biden_won['CountyState'] = df_biden_won[['county','state']].apply(lambda x : '{}_{}'.format(x[0],x[1]), axis=1)","e5c6b879":"df_trump_won.state = df_trump_won.state.str.replace(' ', '')\ndf_trump_won.county = df_trump_won.county.str.replace(' ', '')\ndf_trump_won['CountyState'] = df_trump_won[['county','state']].apply(lambda x : '{}_{}'.format(x[0],x[1]), axis=1)","9d8d5faf":"df_biden_won = df_biden_won.sort_values(by = 'CountyState', ascending = True) \n\n# reset index \ndf_biden_won.reset_index(inplace = True) \n\n# select and drop original columns relevant to task at hand\ncol = ['index']\ndf_biden_won = df_biden_won.drop(col, axis=1)","86d9b18d":"df_trump_won = df_trump_won.sort_values(by = 'CountyState', ascending = True) \n\n# reset index \ndf_trump_won.reset_index(inplace = True) \n\n# select and drop original columns relevant to task at hand\ncol = ['index']\ndf_trump_won = df_trump_won.drop(col, axis=1)","062e791e":"df_biden_won.head(20)","0c413cd9":"df_trump_won.head(20)","0d794b05":"#get dataframe shape\nshape = df_biden_won.shape\nprint('\\nDataFrame Shape :', shape)\nprint('\\nNumber of rows :', shape[0])\nprint('\\nNumber of columns :', shape[1])","37afc58f":"#get dataframe shape\nshape = df_trump_won.shape\nprint('\\nDataFrame Shape :', shape)\nprint('\\nNumber of rows :', shape[0])\nprint('\\nNumber of columns :', shape[1])","83f4c493":"# select preferred columns\ndf_biden_counties = df_biden_won.loc[:,['CountyState', 'candidate', 'won']]","2dba1ecf":"df_trump_counties = df_trump_won.loc[:,['CountyState', 'candidate', 'won']]","c4ff8c97":"# load dataframe\ndf_county_covid = pd.read_csv(\"..\/input\/covid-19-us-counties-22-2020\/covid_us_county.csv\")\n\ndf_county_covid.head(10)","ea457fac":"df_county_covid.dtypes","02902f43":"# change column to DateTime format\ndf_county_covid['date'] =  pd.to_datetime(df_county_covid['date'], infer_datetime_format=True)","197bada5":"# mask timeframe covering two weeks after election\nstart_date = '2020-11-03'\nend_date = '2020-11-18'\n\n# wear a mask\nmask = (df_county_covid['date'] >= start_date) & (df_county_covid['date'] < end_date)\ndf_county_covid = df_county_covid.loc[mask]\n\n# drop NaN rows with no date data\ndf_county_covid.dropna(subset=['date'], inplace=True)\n\n# reset index \ndf_county_covid.reset_index(inplace = True) ","d154954d":"#get dataframe shape\nshape = df_county_covid.shape\nprint('\\nDataFrame Shape :', shape)\nprint('\\nNumber of rows :', shape[0])\nprint('\\nNumber of columns :', shape[1])","67bead1f":"# remove whitespace from column names\ndf_county_covid.county = df_county_covid.county.str.replace(' ', '')\ndf_county_covid.state = df_county_covid.state.str.replace(' ', '')\ndf_county_covid.state_code = df_county_covid.state_code.str.replace(' ', '')\n\n#rename column\ndf_county_covid.rename(columns = {'state_code':'StateCode'}, inplace = True) \n\n# create similar 'CountyState' column as in the election result dataframe \ndf_county_covid['CountyState'] = df_county_covid[['county','state']].apply(lambda x : '{}_{}'.format(x[0],x[1]), axis=1)","681e9fbb":"df_county_covid = df_county_covid.sort_values(by = 'CountyState', ascending = True) \n\n# reset index \ndf_county_covid.reset_index(inplace = True) \n\n# select and drop original columns relevant to task at hand\ncol = ['index', 'level_0', 'fips']\ndf_county_covid = df_county_covid.drop(col, axis=1)","e70036b8":"df_county_covid.head(20)","5245fed5":"# selecting rows based on condition \ndf_county_covid_0411 = df_county_covid.loc[df_county_covid['date'] == '2020-11-04'] \ndf_county_covid_1711 = df_county_covid.loc[df_county_covid['date'] == '2020-11-17'] ","e7a24da9":"#get dataframe shape\nshape = df_county_covid_0411.shape\nprint('\\nDataFrame Shape :', shape)\nprint('\\nNumber of rows :', shape[0])\nprint('\\nNumber of columns :', shape[1])","2712ccb8":"#get dataframe shape\nshape = df_county_covid_1711.shape\nprint('\\nDataFrame Shape :', shape)\nprint('\\nNumber of rows :', shape[0])\nprint('\\nNumber of columns :', shape[1])","717b6887":"df_county_covid_0411 = df_county_covid_0411.sort_values(by = 'CountyState', ascending = True) \n\n\n# reset index \ndf_county_covid_0411.reset_index(inplace = True) \n\n\n# select and drop original columns relevant to task at hand\ncols = ['index']\ndf_county_covid_0411 = df_county_covid_0411.drop(cols, axis=1)\n#df_county_covid_1711 = df_county_covid_0411.drop(cols, axis=1)","0a4f1979":"df_county_covid_0411.head(20)","ee40a035":"df_county_covid_1711 = df_county_covid_1711.sort_values(by = 'CountyState', ascending = True) \ndf_county_covid_1711.reset_index(inplace = True)\n\n# select and drop original columns relevant to task at hand\ncols = ['index']\n\ndf_county_covid_1711 = df_county_covid_1711.drop(cols, axis=1)","1b5f8bfe":"df_county_covid_1711.head(20)","8675f667":"# select relevant columns for further use\ndf_county_covid_0411 = df_county_covid_0411.loc[:,['date', 'CountyState', 'cases', 'deaths', 'StateCode']]\ndf_county_covid_1711 = df_county_covid_1711.loc[:,['date', 'CountyState', 'cases', 'deaths', 'StateCode']]","5c906136":"df_county_covid_0411.head()","92d3a9b9":"df_biden_0411 = pd.merge(df_biden_counties, df_county_covid_0411, how='left')\ndf_biden_1711 = pd.merge(df_biden_counties, df_county_covid_1711, how='left')","6264641d":"df_trump_0411 = pd.merge(df_trump_counties, df_county_covid_0411, how='left')\ndf_trump_1711 = pd.merge(df_trump_counties, df_county_covid_1711, how='left')","63673035":"df_biden_0411 = df_biden_0411.dropna()\ndf_biden_0411.head(20)","9fcd27d7":"df_trump_0411 = df_trump_0411.dropna()\ndf_trump_0411.head(20)","5b888a10":"df_biden_1711 = df_biden_1711.dropna()\ndf_biden_1711.head(20)","5b62d086":"df_trump_1711 = df_trump_1711.dropna()\ndf_trump_1711.head(20)","080fa2c4":"#get dataframe shape\nshape = df_biden_0411.shape\nprint('\\nshape :', shape)\nprint('\\nNumber of rows :', shape[0])\nprint('\\nNumber of columns :', shape[1])","f608084a":"#get dataframe shape\nshape = df_trump_0411.shape\nprint('\\nshape :', shape)\nprint('\\nNumber of rows :', shape[0])\nprint('\\nNumber of columns :', shape[1])","6e179c81":"#get dataframe shape\nshape = df_biden_1711.shape\nprint('\\nshape :', shape)\nprint('\\nNumber of rows :', shape[0])\nprint('\\nNumber of columns :', shape[1])","2a22c4ba":"#get dataframe shape\nshape = df_trump_1711.shape\nprint('\\nshape :', shape)\nprint('\\nNumber of rows :', shape[0])\nprint('\\nNumber of columns :', shape[1])","a63ba38d":"# rename columns for further use\ndf_biden_0411.rename(columns = {'cases':'cases_0411'}, inplace = True) \ndf_biden_0411.reset_index(inplace = True)\ncol = ['index']\ndf_biden_0411 = df_biden_0411.drop(col, axis=1)\n\ndf_biden_1711.rename(columns = {'cases':'cases_1711'}, inplace = True) \ndf_biden_1711.reset_index(inplace = True)\ncol = ['index']\ndf_biden_1711 = df_biden_1711.drop(col, axis=1)\n\ndf_trump_0411.rename(columns = {'cases':'cases_0411'}, inplace = True) \ndf_trump_0411.reset_index(inplace = True)\ncol = ['index']\ndf_trump_0411 = df_trump_0411.drop(col, axis=1)\n\ndf_trump_1711.rename(columns = {'cases':'cases_1711'}, inplace = True)\ndf_trump_1711.reset_index(inplace = True)\ncol = ['index']\ndf_trump_1711 = df_trump_1711.drop(col, axis=1)","0669f452":"df_biden_0411.head(10)","53586a98":"df_biden_1711.head(10)","75f14e88":"df_trump_0411.head(10)","e9e728df":"df_trump_1711.head(10)","d5eb0023":"# values to list\nlist = df_biden_1711['cases_1711'].values.tolist()\n\n# flatten list\nlist = np.array(list).flatten()\n\n#create new column \"Spread\" for relative infections\ndf_biden_0411['cases_1711'] = np.array(list)\n\ndf_biden_0411.head(10)","cc91216d":"# values to list\nlist = df_trump_1711['cases_1711'].values.tolist()\n\n# flatten list\nlist = np.array(list).flatten()\n\n#create new column \"Spread\" for relative infections\ndf_trump_0411['cases_1711'] = np.array(list)\n\ndf_trump_0411.head(10)","8b33c93f":"#create new column for case increase between the two dates\ndf_biden_0411['CaseIncrease'] = df_biden_0411['cases_1711'] -  df_biden_0411['cases_0411']\n\ndf_biden_0411.head(10)","022cc2c7":"df_trump_0411['CaseIncrease'] = df_trump_0411['cases_1711'] -  df_trump_0411['cases_0411']\n\ndf_trump_0411.head(10)","e5f29bbe":"# make case number integers\ndf_biden_0411.cases_0411= df_biden_0411.cases_0411.astype(int)\ndf_biden_0411.cases_1711= df_biden_0411.cases_1711.astype(int)\ndf_biden_0411.deaths = df_biden_0411.deaths.astype(int)\ndf_biden_0411.CaseIncrease= df_biden_0411.CaseIncrease.astype(int)\n\ndf_biden_0411.head(10)","2bd6375f":"df_trump_0411.cases_0411= df_trump_0411.cases_0411.astype(int)\ndf_trump_0411.cases_1711= df_trump_0411.cases_1711.astype(int)\ndf_trump_0411.deaths = df_trump_0411.deaths.astype(int)\ndf_trump_0411.CaseIncrease= df_trump_0411.CaseIncrease.astype(int)\n\ndf_trump_0411.head(10)","e12edcc4":"print(df_biden_0411.loc[df_biden_0411['cases_0411'] == 0])","8c507f7a":"df_biden_0411 = df_biden_0411[df_biden_0411.cases_0411 != 0]","c533a76d":"#get dataframe shape\nshape = df_biden_0411.shape\nprint('\\nshape :', shape)\nprint('\\nNumber of rows :', shape[0])\nprint('\\nNumber of columns :', shape[1])","821e840b":"# values to two lists\nlist_1 = df_biden_0411['CaseIncrease'].values.tolist()\nlist_2 = df_biden_0411['cases_0411'].values.tolist()\n\n# empty list\nCasePerc = []\n\n# function to calculate relative infection rate using two lists of values\ndef relative_spread(x1, x2): \n                    result =  [(x1 \/ x2 * 100) for (x1, x2) in zip(list_1,list_2)] \n                    CasePerc.append(result)   \n            \n# execute function on list values            \nrelative_spread (list_1,list_2)\n\n# flatten results list\nCasePerc = np.array(CasePerc).flatten()\n\n# round to one digit\nCasePerc = np.round(CasePerc, 1)\n\n#create new column\ndf_biden_0411['IncreasePerc'] = np.array(CasePerc)","c4261567":"df_biden_0411.head(10)","dd30badc":"biden_mean = df_biden_0411['IncreasePerc'].mean()\nbiden_median = df_biden_0411['IncreasePerc'].median()\n\nprint('\\nBiden county mean :', biden_mean)\nprint('\\nBiden county median :', biden_median)","632de626":"print(df_trump_0411.loc[df_trump_0411['cases_0411'] == 0])","29fb64d8":"df_trump_0411 = df_trump_0411[df_trump_0411.cases_0411 != 0]","c61e04b0":"#get dataframe shape\nshape = df_trump_0411.shape\nprint('\\nshape :', shape)\nprint('\\nNumber of rows :', shape[0])\nprint('\\nNumber of columns :', shape[1])","3d0bbf93":"# values to two lists\nlist_1 = df_trump_0411['CaseIncrease'].values.tolist()\nlist_2 = df_trump_0411['cases_0411'].values.tolist()\n\n# empty list\nCasePerc = []\n\n# function to calculate relative infection rate using two lists of values\ndef relative_spread(x1, x2): \n                    result =  [(x1 \/ x2 * 100) for (x1, x2) in zip(list_1,list_2)] \n                    CasePerc.append(result)   \n            \n# execute function on list values            \nrelative_spread (list_1,list_2)\n\n# flatten results list\nCasePerc = np.array(CasePerc).flatten()\n\n# round to one digit\nCasePerc = np.round(CasePerc, 1)\n\n#create new column\ndf_trump_0411['IncreasePerc'] = np.array(CasePerc)","345e42af":"df_trump_0411.head(10)","1be094d4":"trump_mean = df_trump_0411['IncreasePerc'].mean()\ntrump_median = df_trump_0411['IncreasePerc'].median()\n\nprint('\\nTrump county mean :', trump_mean)\nprint('\\nTrump county median :', trump_median)","eb6a5ef6":"print('\\naverage increase percent of new COVID-19 cases (04.11.2020-17.11.2020) in counties Joe Biden won :', biden_mean)\nprint('\\naverage increase percent of new COVID-19 cases (04.11.2020-17.11.2020) in counties Donald Trump won :', trump_mean)","df86c441":"We need only two days of data from the COVID-19 dataset: the first and the last day of the two-week period under further analysis.","2f6577dd":"By average, counties Donald Trump won had a 35-percent increase of new COVID-19 cases in two weeks following the election. Conversely, counties where Joe Biden won had only about a 23-percent increase in new virus cases. \n\n***This does not automatically mean that the increased COVID-19 cases are a direct consequence of Trump supporter voting day activity. Not all Biden voters stayed at home on November 3rd, nor did all Trump supporters actively mingle with other people with no masks and social distancing. What we see is a larger trendline, one fact among others, with numerous possible explanations.*** ","da2cce4c":"The 'date' column in the dataframe needs to be change into DateTime format.","73f35421":"Now we can merge datasets by using left join. The result is four new dataframes - two on Biden and two on Trump - consisting both county election data and COVID-19 case data.","57feae03":"Next we bring in the county COVID-19 data to later match it with the election results.","bcee57a9":"We must check if there are null values in our case data, since the data will be used in division calculation later. In this case, possible insufficient data will be dropped.","fd1481f8":"Next the COVID-19 case data from the two dates we are interested in is collected in the same dataframe. As result, we get one dataframe for Biden and one for Trump with all the data we need.","432c0fdd":"Next, case increase percentage will be calculated. The two columns used for this are the case numbers from November 4th and the number of increased COVID-19 cases (from November 4th to November 17th) calculated earlier.","96d94357":"We can now see the average and median increase percentage of Biden counties and their respected COVID-19 cases in the two weeks following the election.","5a4cfe3b":"***Disclaimer: this is personal practice notebook and a learning project made public, not a major achievement in data analysis or a political pamphlet.***","b488f2fc":"First we divide the county results to Trump and Biden counties based on who won there.","ced4dc92":"Now we can get the average and median percentages also on Trump counties.","02bab6bc":"From dataframe shape, we can see that by quantity Trump won twice as many individual counties as Joe Biden, whose supporters mostly live near large metro areas.","90271324":"In the Trump data, there are null values especially in Utah data. As we are not concentrating on state differences, those rows will be dropped.","69642add":"In the 2020 U.S. presidential election, the actual voting procedure was very different compared to recent elections. Because of COVID-19, the Democratic candidate Joe Biden encouraged his supporters to rely on mail-in ballots, whereas the incumbent president Donald Trump openly campaigned for in-person voting on election day. As proven by vote count, people did respond to both. In many states, the early lead of Donald Trump vanished after the mail-in ballots were counted.\n\nThe research question this notebook asks is whether all this might have had any effect on COVID-19 surge in different parts of United States. \nAs the county data on COVID-19 is now available on CDC website, it was possible to compare it with the existing data on vote count.\n\nThe data used in this notebook is available online on Kaggle.com with additional descriptive information. Since I did not require the most recent data on COVID-19 cases, I uploaded an older version of this data as an own dataset. This was because there is a government transition going on in the U.S., which often leads to changes also in data use and collection. I wanted to make sure the format of the dataset will continue to be compatible with this notebook without me checking in on this notebook every day.\n\n*The Kaggle datasets (thank you for Kaggle user **Raphael Fontes** for US Election data and user **Heads or Tails** for COVID-19 county data) can be found on the following links (here as external):*\n\n__[U.S. county COVID-19 data](https:\/\/www.kaggle.com\/headsortails\/covid19-us-county-jhu-data-demographics)__\n\n__[U.S. election 2020 data](https:\/\/www.kaggle.com\/unanimad\/us-election-2020)__\n\nIn this notebook, the timeframe is the first two weeks after the presidential election. This is the suspected incubation period of COVID-19, so had someone been infected on election day and tested positive since, this would've shown up some time during the respected two weeks of COVID-19 data.\n\nOn election day, many Biden supporters who voted early allegedly stayed home. Conversely, the Trump supporters allegedly were out and about. <br>\n\n*Did the counties that Donald Trump won have a larger increase of new COVID-19 cases in the two weeks following the election day?*\n\n*Let's find out.*\n\n***December 1st, 2020***<br>\n***Jari Peltola***"}}