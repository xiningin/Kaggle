{"cell_type":{"e2b9f817":"code","bcac9d5b":"code","7194cb6b":"code","08dd89fc":"code","f033c296":"code","9edead57":"code","9795b145":"code","3b1c7d37":"code","3f084474":"code","69cad8ff":"code","0b4335af":"code","61f7880a":"code","d7d8dd95":"code","810674c9":"markdown","4b944b81":"markdown","723fe22f":"markdown","8ec022ca":"markdown","1731f82a":"markdown","2d282ee6":"markdown","316de216":"markdown","fe1fcd55":"markdown","0e1d8c88":"markdown","2866e1ef":"markdown","32565abb":"markdown","b8a0870b":"markdown"},"source":{"e2b9f817":"import pandas as pd\ndf = pd.read_csv(\"\/kaggle\/input\/cafecombyterwinequality\/train.csv\")\ndfTestCompetition = pd.read_csv(\"\/kaggle\/input\/cafecombyterwinequality\/test.csv\")","bcac9d5b":"df","7194cb6b":"df = df.drop(columns=[\"id\"])","08dd89fc":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(df.drop(columns=[\"quality\"]), df[\"quality\"].values, test_size=0.10, random_state=42)","f033c296":"from sklearn.tree import DecisionTreeClassifier\n# Cria um modelo de \u00e1rvore de decis\u00e3o\nmodel = DecisionTreeClassifier()\n# Treino esse modelo, com o m\u00e9todo fit. X_train representa as caracteristicas (features) de cada vinho, y_Train \u00e9 a nota de cada um desses vinhos\nmodel.fit(X_train,y_train)","9edead57":"predictions = model.predict(X_test)\npredictions","9795b145":"from sklearn.metrics import accuracy_score\naccuracy_score(y_test, predictions)","3b1c7d37":"dfTestCompetition","3f084474":"# Novamente, o id n\u00e3o \u00e9 usado no modelo, ele serve apenas para identificar o vinho, e ser\u00e1 \u00fatil apenas na hora da submiss\u00e3o\npredictionsCompetition = model.predict(dfTestCompetition.drop(columns=[\"id\"]))\npredictionsCompetition","69cad8ff":"submission = pd.DataFrame()\nsubmission[\"id\"] = dfTestCompetition[\"id\"]\nsubmission[\"quality\"] = predictionsCompetition","0b4335af":"submission","61f7880a":"from IPython.display import HTML\nimport pandas as pd\nimport numpy as np\nimport base64\n\ndef create_download_link(df, title = \"Download CSV file\", filename = \"data.csv\"):  \n    csv = df.to_csv(index=False)\n    b64 = base64.b64encode(csv.encode())\n    payload = b64.decode()\n    html = '<a download=\"{filename}\" href=\"data:text\/csv;base64,{payload}\" target=\"_blank\">{title}<\/a>'\n    html = html.format(payload=payload,title=title,filename=filename)\n    return HTML(html)","d7d8dd95":"# Cria um link para baixar nosso resultado em um arquivo .csv\ncreate_download_link(submission)","810674c9":"Pra baixar esse dataset e submeter, vamos precisar de uma fun\u00e7\u00e3ozinha auxiliar, para gerar um link:","4b944b81":"Para submeter as avalia\u00e7\u00f5es para a competi\u00e7\u00e3o temos que usar o dataset de teste para a competi\u00e7\u00e3o\n#### Este dataset n\u00e3o tem a coluna falando qual \u00e9 a qualidade do vinho, \u00e9 justamente essa que ser\u00e1 enviada para a competi\u00e7\u00e3o para avaliar os melhores\n","723fe22f":"Criando um dataframe e preenchendo com as informa\u00e7\u00f5es a serem submetidas","8ec022ca":"### Carrega datasets para nosso modelo\ntest.csv ser\u00e1 usado para a predi\u00e7\u00e3o final e para a competi\u00e7\u00e3o\n","1731f82a":"Faz a predi\u00e7\u00e3o dos dados que n\u00e3o foram usados para o treino do modelo\n","2d282ee6":"Voc\u00ea pode alterar o nome do arquivo e enviar na competi\u00e7\u00e3o :)","316de216":"Separa nosso dataset de treino em outros dataset de treino e teste. Para treinar e testar se nosso modelo est\u00e1 bom\n","fe1fcd55":"#### Avalia a acur\u00e1cia do nosso modelo, quanto mais pr\u00f3ximo de 1 melhor\n","0e1d8c88":"\u00c9 aqui onde nosso modelo \u00e9 definido e treinado, altere aqui para testar outros modelos","2866e1ef":"Nessa caso, nosso modelo de \u00e1rvore de decis\u00e3o conseguiu ter uma acur\u00e1cia de 72.2%, ou seja, em 72.2% dos casos ela acertou qual era a nota do vinho...","32565abb":"N\u00e3o usamos a coluna de id para treinamento, ela n\u00e3o s\u00f3 representa um identificador do vinho\n","b8a0870b":"# Caf\u00e9ComBytes - Wine Quality"}}