{"cell_type":{"7a8a3e42":"code","08941623":"code","f7a64822":"code","f9717bbc":"code","a6275960":"code","68a65fb4":"code","1069ae1b":"code","7f5077da":"code","260381e2":"code","c2093c5a":"code","d2ddff44":"code","b4337d92":"code","139c1f92":"code","fa846e25":"code","29283bf3":"code","0f0fcc45":"code","197511e3":"code","ddb89a60":"code","33d9d711":"code","3da58380":"code","7dc9f5d0":"code","ff8c2e09":"code","5f9fccc5":"code","9b331922":"code","224665ab":"code","68c088df":"code","f43d4e5b":"code","bd197027":"code","d5c41bb8":"code","ae5aa27d":"code","bc367287":"code","2d0e1ba7":"code","32e5b0eb":"code","f5901a85":"code","f9ac265b":"code","49cb290f":"code","cad8ca58":"code","f75475f2":"code","844ef378":"code","be401580":"code","ce18ef6c":"code","158f37e2":"code","2628f0a5":"code","5f3ca4f9":"code","cfd19ba8":"code","ef6bf405":"code","a0e785c6":"code","898fc79c":"code","26d8de4f":"code","ec5ae643":"code","63e77144":"code","c8128b8a":"code","5cf57eab":"code","7d541e35":"code","acc9ce1d":"code","94e26196":"code","eca64c92":"code","1792cdb9":"code","afece84e":"code","0771710c":"code","eb6dbe38":"code","b9f97963":"markdown","2f5efb11":"markdown","432baa12":"markdown","d34539a2":"markdown","4a082047":"markdown","fa2525e3":"markdown","bb1c85fb":"markdown","d8c94001":"markdown","cfa9c8b0":"markdown","5af0060c":"markdown","b38b7de1":"markdown","73c3b943":"markdown","8a9e5df7":"markdown","1ce8b610":"markdown","d7263618":"markdown","d0642960":"markdown","21dea368":"markdown","6778f30b":"markdown"},"source":{"7a8a3e42":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt","08941623":"from scipy import stats\nfrom sklearn.model_selection import train_test_split","f7a64822":"customer_data = pd.read_csv(\"..\/input\/mall-customers\/Mall_Customers.csv\")","f9717bbc":"customer_data.shape","a6275960":"customer_data.head()","68a65fb4":"customer_data.columns = [\"ID\", \"gender\", \"age\", \"income\", \"spending_score\"]","1069ae1b":"customer_data.head(3)","7f5077da":"customer_data.isnull().sum()","260381e2":"from sklearn.preprocessing import LabelEncoder\nencoder = LabelEncoder()","c2093c5a":"customer_data[\"gender\"] = encoder.fit_transform(customer_data[\"gender\"])","d2ddff44":"customer_data.info()","b4337d92":"customer_data.head(2)","139c1f92":"plt.figure(figsize=(12, 7))\ncorr_mat = customer_data.corr()\nsns.heatmap(corr_mat)","fa846e25":"sns.scatterplot(customer_data[\"ID\"], customer_data[\"income\"])","29283bf3":"customer_data[\"spending_score\"].describe()","0f0fcc45":"fig, ax = plt.subplots(nrows=1, ncols=2, figsize=(15, 5))\nsns.distplot(customer_data[\"spending_score\"], bins=50, ax=ax[0])\nsns.boxplot(customer_data[\"spending_score\"], ax=ax[1])","197511e3":"customer_data[\"gender\"].unique()","ddb89a60":"sns.countplot(customer_data[\"gender\"])","33d9d711":"customer_data[\"gender\"].value_counts(normalize=True)","3da58380":"customer_data[\"age\"].unique()","7dc9f5d0":"plt.figure(figsize=(20, 7))\nsns.countplot(customer_data[\"age\"])","ff8c2e09":"customer_data[\"income\"].describe()","5f9fccc5":"fig, ax = plt.subplots(nrows=1, ncols=2, figsize=(15, 5))\nsns.distplot(customer_data[\"income\"], bins=50, ax=ax[0])\nsns.boxplot(customer_data[\"income\"], ax=ax[1])","9b331922":"plt.figure(figsize=(12, 7))\ncorr_mat = customer_data.corr()\nsns.heatmap(corr_mat, annot=True)","224665ab":"customer_data.groupby(\"gender\")[\"spending_score\"].describe()","68c088df":"fig, ax = plt.subplots(nrows=1, ncols=2, figsize=(20, 7))\nsns.boxplot(customer_data[\"gender\"], customer_data[\"spending_score\"], ax=ax[0])\nsns.kdeplot(customer_data[customer_data[\"gender\"] == 0][\"spending_score\"], color='r',ax=ax[1])\nsns.kdeplot(customer_data[customer_data[\"gender\"] == 1][\"spending_score\"], color='g',ax=ax[1])","f43d4e5b":"plt.figure(figsize=(20, 7))\nsns.boxplot(customer_data[\"age\"], customer_data[\"spending_score\"])","bd197027":"plt.figure(figsize=(20, 7))\nsns.regplot(customer_data[\"age\"], customer_data[\"spending_score\"])","d5c41bb8":"plt.figure(figsize=(20, 7))\nsns.boxplot(customer_data[\"income\"], customer_data[\"spending_score\"])","ae5aa27d":"plt.figure(figsize=(20, 7))\nsns.jointplot(customer_data[\"income\"], customer_data[\"spending_score\"], kind=\"hex\")","bc367287":"plt.figure(figsize=(20, 7))\nsns.scatterplot(customer_data[\"income\"], customer_data[\"spending_score\"], hue=customer_data[\"age\"])","2d0e1ba7":"from sklearn.preprocessing import StandardScaler\nscaler = StandardScaler()\n\ndata = customer_data.copy()\ndata[\"age\"] = scaler.fit_transform(data[\"age\"].values.reshape(-1, 1))\ndata[\"income\"] = scaler.fit_transform(data[\"income\"].values.reshape(-1, 1))\ndata[\"spending_score\"] = scaler.fit_transform(data[\"spending_score\"].values.reshape(-1, 1))","32e5b0eb":"data.head()","f5901a85":"X = data.drop(columns=[\"ID\", \"spending_score\"])\ny = data[\"spending_score\"]","f9ac265b":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.20, random_state=12)","49cb290f":"from sklearn.linear_model import LinearRegression\nfrom sklearn.metrics import mean_squared_error","cad8ca58":"linear_reg = LinearRegression()\nlinear_reg.fit(X_train, y_train)\nlinear_reg_pred = linear_reg.predict(X_test)","f75475f2":"np.sqrt(mean_squared_error(scaler.inverse_transform(y_test), scaler.inverse_transform(linear_reg_pred)))","844ef378":"plt.scatter(range(0, len(y_test)), y_test, color='r')\nplt.scatter(range(0, len(y_test)), linear_reg_pred, color='b')","be401580":"X = data[\"income\"]\ny = data[\"spending_score\"]","ce18ef6c":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=12)","158f37e2":"linear_reg = LinearRegression()\nlinear_reg.fit(np.array(X_train).reshape(-1, 1), y_train)\nlinear_reg_pred = linear_reg.predict(np.array(X_test).reshape(-1, 1))","2628f0a5":"np.sqrt(mean_squared_error(scaler.inverse_transform(y_test), scaler.inverse_transform(linear_reg_pred)))","5f3ca4f9":"plt.scatter(range(0, len(y_test)), y_test, color='r')\nplt.scatter(range(0, len(y_test)), linear_reg_pred, color='b')","cfd19ba8":"X = data[\"age\"]\ny = data[\"spending_score\"]","ef6bf405":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=12)","a0e785c6":"linear_reg = LinearRegression()\nlinear_reg.fit(np.array(X_train).reshape(-1, 1), y_train)\nlinear_reg_pred = linear_reg.predict(np.array(X_test).reshape(-1, 1))","898fc79c":"np.sqrt(mean_squared_error(scaler.inverse_transform(y_test), scaler.inverse_transform(linear_reg_pred)))","26d8de4f":"plt.scatter(range(0, len(y_test)), y_test, color='r')\nplt.scatter(range(0, len(y_test)), linear_reg_pred, color='b')","ec5ae643":"X = data[\"gender\"]\ny = data[\"spending_score\"]","63e77144":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=12)","c8128b8a":"linear_reg = LinearRegression()\nlinear_reg.fit(np.array(X_train).reshape(-1, 1), y_train)\nlinear_reg_pred = linear_reg.predict(np.array(X_test).reshape(-1, 1))","5cf57eab":"np.sqrt(mean_squared_error(scaler.inverse_transform(y_test), scaler.inverse_transform(linear_reg_pred)))","7d541e35":"plt.scatter(range(0, len(y_test)), y_test, color='r')\nplt.scatter(range(0, len(y_test)), linear_reg_pred, color='b')","acc9ce1d":"from sklearn.svm import SVR","94e26196":"X = data.drop(columns=[\"ID\", \"spending_score\"])\ny = data[\"spending_score\"]\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=12)\n\nsvr = SVR(C=1)\nsvr.fit(X_train, y_train)\nsvr_pred = svr.predict(X_test)","eca64c92":"np.sqrt(mean_squared_error(scaler.inverse_transform(y_test), scaler.inverse_transform(svr_pred)))","1792cdb9":"plt.scatter(range(0, len(y_test)), y_test, color='r')\nplt.scatter(range(0, len(y_test)), svr_pred, color='b')","afece84e":"from sklearn.model_selection import learning_curve\n\ntrain_size, train_score, test_score = \\\n        learning_curve(svr, X, y, train_sizes=np.linspace(0.1, 1.0, 10), cv=5, shuffle=True)","0771710c":"train_mean = np.mean(train_score, axis=1)\ntrain_std = np.std(train_score, axis=1)\ntest_mean = np.mean(test_score, axis=1)\ntest_std = np.std(test_score, axis=1)","eb6dbe38":"plt.plot(train_size, train_mean, color='blue', marker='o', markersize=5)\nplt.fill_between(train_size, train_mean+train_std, train_mean-train_std, alpha=0.15, color='blue')\nplt.plot(train_size, test_mean, color=\"red\", marker='s')\nplt.fill_between(train_size, test_mean+test_std, test_mean-test_std, alpha=0.15, color='red')","b9f97963":"#### Age","2f5efb11":"### Univerent Analysis","432baa12":"#### Spending Score","d34539a2":"#### Prediction Using Just Gender Column","4a082047":"#### Prediction Using Just Age Column","fa2525e3":"##### Conclusion:","bb1c85fb":"### Support Vector Machine","d8c94001":"#### Income","cfa9c8b0":"#### Income","5af0060c":"#### Age, Income and Spending Score","b38b7de1":"#### Age","73c3b943":"#### Gender","8a9e5df7":"### Linear Regression using all columns","1ce8b610":"#### Prediction Using Just Income Column","d7263618":"According to the trend it seems like one of the two assumption is right\n1> Value of ID column is assigned on the bassis of income i.e. first, income column is arraged in ascending order than for each value an id is assigned\n2> the data is of single day i.e. people comming in the morning(id-> 0 to 25) have low income and as the day runs higher income people comes\n\nBut the chances of assumption 2 to be correct is low since it does not have any outliers","d0642960":"### Learning Curve","21dea368":"#### Gender","6778f30b":"### Multivarient Analysis"}}