{"cell_type":{"e75abeec":"code","0df27aff":"code","764e9785":"code","993c2781":"code","87ad2dbf":"code","b5c32fe7":"code","331ac5df":"code","2a239175":"code","242876f2":"code","08af8905":"code","6882258b":"code","9423f3bf":"code","b1bba7d1":"code","1bb9b2bc":"code","22dd65e2":"markdown","a8727845":"markdown","e45c23d7":"markdown","05ac6804":"markdown","8933b298":"markdown","716ac6f4":"markdown","a2d7edae":"markdown","d5509a46":"markdown"},"source":{"e75abeec":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.preprocessing import MinMaxScaler\nfrom sklearn.model_selection import KFold\nfrom sklearn.metrics import mean_squared_error","0df27aff":"RANDOM_STATE=42\nN_SPLITS=5","764e9785":"train = pd.read_csv('..\/input\/pceo-ml-2022winter\/train.csv').iloc[:,1:]\ntest = pd.read_csv('..\/input\/pceo-ml-2022winter\/test.csv').iloc[:,1:]\nsample_submission = pd.read_csv('..\/input\/pceo-ml-2022winter\/sample_submission.csv')","993c2781":"train.isna().sum()","87ad2dbf":"test.isna().sum()","b5c32fe7":"train.dtypes","331ac5df":"y_train = train.song_popularity\nX_train = train.drop('song_popularity', axis=1) ","2a239175":"scaler = MinMaxScaler()\nscaled_train = scaler.fit_transform(X_train)\nX_train = pd.DataFrame(scaled_train, columns=X_train.columns, index=list(X_train.index.values))","242876f2":"scaled_test = scaler.transform(test)\ntest = pd.DataFrame(scaled_test, columns=test.columns, index=list(test.index.values))","08af8905":"kf = KFold(n_splits=N_SPLITS, random_state=RANDOM_STATE, shuffle=True)\nmodels = []\nscores = []\nfor train_idx, valid_idx in kf.split(X_train):\n    train_x, valid_x = X_train.iloc[train_idx], X_train.iloc[valid_idx]\n    train_y, valid_y = y_train.iloc[train_idx], y_train.iloc[valid_idx]\n    model = RandomForestRegressor(random_state=RANDOM_STATE)\n    model.fit(train_x, train_y)\n    predict = model.predict(valid_x)\n    rmse = mean_squared_error(valid_y, predict)**0.5\n    print(\"RMSE is {0}\".format(rmse))\n    models.append(model)\n    scores.append(rmse)\nprint(\"Final CV Score is {0}\".format(np.mean(scores)))","6882258b":"importance = models[0].feature_importances_\nimportance_idx = np.argsort(importance)[::-1]\nfor i in range(10):\n    print(\"{}. feature name : {} ({:.3f})\".format(i+1, X_train.columns[importance_idx][i], importance[importance_idx[i]]))","9423f3bf":"predictions = []\nfor i in range(len(models)):\n    predictions.append(models[i].predict(test))","b1bba7d1":"final_prediction = np.mean(predictions, axis=0)","1bb9b2bc":"sample_submission.song_popularity = final_prediction\nsample_submission.to_csv('.\/baseline_submission.csv', index=False)","22dd65e2":"# 2022-Winter-Baseline\n\n\uac04\ub2e8\ud55c RandomForestRegressor\ub97c \ud1b5\ud55c \ubca0\uc774\uc2a4\ub77c\uc778 \ubaa8\ub378\ub9c1\uc785\ub2c8\ub2e4. \ub2e4\uc591\ud55c \uc2dc\ub3c4\ub97c \ud1b5\ud574\uc11c \uc810\uc218\ub97c \ud5a5\uc0c1\ud574\ubcf4\uc138\uc694.","a8727845":"## Cross Validation \ubc0f Model Traning\nKFold\ub97c \uc0ac\uc6a9\ud558\uc5ec 5 fold \ub9cc\ud07c Cross Validation\uc744 \uc218\ud589\ud558\uc5ec over fitting\uc774 \uc77c\uc5b4\ub098\uc9c0 \uc54a\uac8c \ud569\ub2c8\ub2e4.","e45c23d7":"\uc544\ub798 \ucf54\ub4dc\ub85c \uac01 feature\ub4e4\uc758 importance\ub97c \uad6c\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4. Feature Engineering \uacfc\uc815\uc5d0\uc11c \uc720\uc6a9\ud558\uac8c \uc0ac\uc6a9\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.","05ac6804":"\uc22b\uc790 \ud615\uc2dd\uc758 \ub370\uc774\ud130\ub4e4\uc740 \ucd5c\uc885 popularity \uac12\uc744 \uc81c\uc678\ud558\uace0 MinMaxScaler\ub97c \uc0ac\uc6a9\ud558\uc5ec normalize \ud574\uc918\uc57c\ud569\ub2c8\ub2e4.","8933b298":"## \ub370\uc774\ud130 \ub85c\ub4dc \ubc0f \uc804\ucc98\ub9ac","716ac6f4":"\uc704\uc640 \uac19\uc774 train \ubc0f test \ub370\uc774\ud130\uc5d0 NaN\uac12\uc740 \uc804\ud600 \uc5c6\uc2b5\ub2c8\ub2e4","a2d7edae":"\ub370\uc774\ud130\uc758 \ud615\uc2dd\uc740 \ubaa8\ub450 \uc22b\uc790 \ud615\uc2dd\uc73c\ub85c, categorical feature\uac00 \ud3ec\ud568\ub418\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4. ","d5509a46":"## Model \uc608\uce21 \ubc0f Submission"}}