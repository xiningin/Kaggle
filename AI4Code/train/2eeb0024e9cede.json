{"cell_type":{"d7333249":"code","b29a0252":"code","401bdb15":"code","88434eaf":"code","26b417a7":"code","7eb07eef":"code","07777837":"code","572684d2":"code","cc8092a4":"code","797711db":"code","c40d44fb":"code","70354f2a":"code","c9886576":"code","102f119c":"code","143ac781":"code","414d8ce8":"code","32c20384":"code","a5e3a85e":"code","2ef79894":"code","64d19c1e":"code","895a66f5":"code","9d74b478":"code","7e49a583":"code","dda7fd4a":"code","2753c27c":"code","cb8d3c6e":"code","0d1023ed":"code","0fd4705c":"code","9bd5adf2":"code","9f92af7b":"code","047a07b4":"code","b5135f07":"code","83a0afde":"code","ca8099a0":"code","b0e361e0":"code","5a381ae7":"code","a448e2c6":"code","0ee6b46b":"code","051108c3":"code","803a2fc2":"code","520cbee5":"code","9bcc086d":"code","02cd01ec":"code","46a4b014":"code","a54d239e":"code","5babeecf":"code","e74ec987":"code","670fe9de":"code","03aa1559":"code","16ab1c0a":"code","758adc65":"code","159023d4":"code","c2afb5c4":"code","0e94e94b":"code","c3a9afb2":"code","b198b0b3":"code","86ce9152":"code","bce6a1f1":"code","0b11d03d":"code","bcfe7a6f":"code","9a16104b":"code","381d16f0":"code","c0b38624":"code","7f8c6e25":"markdown","f743d2ac":"markdown","1059f537":"markdown","789400a4":"markdown","0f6b99e6":"markdown","3c17198f":"markdown","bde5c84c":"markdown","3f0e9196":"markdown","bc421254":"markdown","8bf8e4cf":"markdown","48cd506e":"markdown","073d84d4":"markdown","99acfdc8":"markdown","04eafa63":"markdown","22236a88":"markdown","a08be349":"markdown"},"source":{"d7333249":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","b29a0252":"import matplotlib.pyplot as plt\nimport seaborn as sns\nimport plotly.express as px\nimport warnings\nwarnings.filterwarnings('ignore')\n","401bdb15":"from sklearn.preprocessing import MinMaxScaler\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import mean_squared_error, mean_absolute_error, explained_variance_score, r2_score \nfrom sklearn.metrics import mean_poisson_deviance, mean_gamma_deviance, accuracy_score\nfrom xgboost import XGBRegressor","88434eaf":"df_bitcoin = pd.read_csv('..\/input\/all-cryptocurrencies-price-20152021\/Bitcoin\/BTC-USD.csv')","26b417a7":"df_bitcoin.head()","7eb07eef":"df_bitcoin.shape","07777837":"missing_values=pd.DataFrame(df_bitcoin.isna().sum().sort_values(ascending=False),columns=['Missing_values'])\nmissing_values['%']=(missing_values.Missing_values\/2193)*100","572684d2":"missing_values","cc8092a4":"df_dogecoin = pd.read_csv('..\/input\/all-cryptocurrencies-price-20152021\/Dogecoin\/DOGE-USD.csv')","797711db":"df_dogecoin.head()","c40d44fb":"missing_values2=pd.DataFrame(df_dogecoin.isna().sum().sort_values(ascending=False),columns=['Missing_values'])\nmissing_values2['%']=(missing_values.Missing_values\/2193)*100","70354f2a":"missing_values2","c9886576":"df_ethereum = pd.read_csv('..\/input\/all-cryptocurrencies-price-20152021\/Ethereum\/ETH-USD.csv')","102f119c":"df_ethereum.head()","143ac781":"missing_values3=pd.DataFrame(df_ethereum.isna().sum().sort_values(ascending=False),columns=['Missing_values'])\nmissing_values3['%']=(missing_values.Missing_values\/2193)*100","414d8ce8":"missing_values3","32c20384":"df_cardano = pd.read_csv('..\/input\/all-cryptocurrencies-price-20152021\/Cardano\/ADA-USD.csv')","a5e3a85e":"missing_values4=pd.DataFrame(df_ethereum.isna().sum().sort_values(ascending=False),columns=['Missing_values'])\nmissing_values4['%']=(missing_values.Missing_values\/2193)*100","2ef79894":"missing_values4.head()","64d19c1e":"for col in df_bitcoin.columns:\n    print(type(col))","895a66f5":"df_bitcoin['Date']=pd.to_datetime(df_bitcoin['Date'])\ndf_dogecoin['Date']=pd.to_datetime(df_dogecoin['Date'])\ndf_ethereum['Date']=pd.to_datetime(df_ethereum['Date'])\ndf_cardano['Date']=pd.to_datetime(df_cardano['Date'])","9d74b478":"df_bitcoin.head()","7e49a583":"fig = plt.figure(figsize = (16,7))\n\nplt.plot(df_bitcoin.Date,df_bitcoin.Close,color='purple')\nplt.plot(df_dogecoin.Date,df_dogecoin.Close,color='red')\nplt.plot(df_ethereum.Date,df_ethereum.Close,color='violet')\nplt.plot(df_cardano.Date,df_cardano.Close,color='yellow')\n\nplt.title('Closing Price Trend')\nplt.legend(['Bitcoin','Dogecoin','Ethereum','Cardano'])\nplt.show()","dda7fd4a":"fig = plt.figure(figsize = (17,11))\n\nplt.subplot(2,2,1)\nplt.plot(df_bitcoin.Date,df_bitcoin.Volume,color='purple')\nplt.title('Bitcoin')\n\n\nplt.subplot(2,2,2)\nplt.plot(df_dogecoin.Date,df_dogecoin.Volume,color='red')\nplt.title('Dogecoin')\n\nplt.subplot(2,2,3)\n\nplt.plot(df_ethereum.Date,df_ethereum.Volume,color='blue')\nplt.title('Ethereum')\n\n\nplt.subplot(2,2,4)\n\nplt.plot(df_cardano.Date,df_cardano.Volume,color='violet')\nplt.title('Cardano')\n\nfig.tight_layout()","2753c27c":"two_year_bitcoin=df_bitcoin[df_bitcoin.Date>'2019-09']\ntwo_year_dogecoin=dogecoin=df_dogecoin[df_dogecoin.Date>'2019-09']\ntwo_year_ethereum=df_ethereum[df_ethereum.Date>'2019-09']\ntwo_year_cardano=df_cardano[df_cardano.Date>'2019-09']","cb8d3c6e":"fig = plt.figure(figsize = (16,7))\n\nplt.plot(two_year_bitcoin.Date,two_year_bitcoin.Close,color='purple')\nplt.plot(two_year_dogecoin.Date,two_year_dogecoin.Close,color='red')\nplt.plot(two_year_ethereum.Date,two_year_ethereum.Close,color='blue')\nplt.plot(two_year_cardano.Date,two_year_cardano.Close,color='violet')\nplt.title('Closing Price over 2 years')\nplt.legend(['Bitcoin','Dogecoin','Ethereum','Cardano'])\nplt.show()","0d1023ed":"fig = plt.figure(figsize = (16,7))\n\nplt.plot(two_year_bitcoin.Date,two_year_bitcoin.Volume,color='purple')\nplt.plot(two_year_dogecoin.Date,two_year_dogecoin.Volume,color='red')\nplt.plot(two_year_ethereum.Date,two_year_ethereum.Volume,color='blue')\nplt.plot(two_year_cardano.Date,two_year_cardano.Volume,color='violet')\n\nplt.title('Volume over two years')\nplt.legend(['Bitcoin','Dogecoin','Ethereum','Cardano'])\nplt.show()","0fd4705c":"fig = plt.figure(figsize = (17,17))\n\nplt.subplot(4, 1, 1)\nplt.plot(two_year_bitcoin.Date,two_year_bitcoin['Close'],color='purple')\nplt.plot(two_year_bitcoin.Date,two_year_bitcoin['Open'],color='red')\nplt.legend(['Closing','Open'])\nplt.title('Bitcoin')\n\nplt.subplot(4, 1, 2)\nplt.plot(two_year_dogecoin.Date,two_year_dogecoin['Close'],color='red')\nplt.plot(two_year_dogecoin.Date,two_year_dogecoin['Open'],color='green')\nplt.legend(['Closing','Open'])\nplt.title('Dogecoin')\n\nplt.subplot(4, 1, 3)\nplt.plot(two_year_ethereum.Date,two_year_ethereum['Close'],color='black')\nplt.plot(two_year_ethereum.Date,two_year_ethereum['Open'],color='green')\nplt.legend(['Closing','Open'])\nplt.title('Ethereum')\n\nplt.subplot(4, 1, 4)\nplt.plot(two_year_cardano.Date,two_year_cardano['Close'],color='green')\nplt.plot(two_year_cardano.Date,two_year_cardano['Open'],color='purple')\nplt.legend(['Closing','Open'])\nplt.title('Cardano')\n\n\nfig.tight_layout()","9bd5adf2":"fig = plt.figure(figsize = (15,10))\n\nplt.subplot(2, 2, 1)\nplt.plot(df_bitcoin.Date,df_bitcoin['Adj Close'].pct_change(),color='purple')\nplt.title('Bitcoin')\n\nplt.subplot(2, 2, 2)\nplt.plot(df_dogecoin.Date,df_dogecoin['Adj Close'].pct_change(),color='red')\nplt.title('Dogecoin')\n\nplt.subplot(2, 2, 3)\nplt.plot(df_ethereum.Date,df_ethereum['Adj Close'].pct_change(),color='yellow')\nplt.title('Ethereum')\n\nplt.subplot(2, 2, 4)\nplt.plot(df_cardano.Date,df_cardano['Adj Close'].pct_change(),color='green')\nplt.title('Cardano')\n\n\nfig.tight_layout()","9f92af7b":"fig = plt.figure(figsize = (15,10))\n\nplt.subplot(2, 2, 1)\nsns.distplot(df_bitcoin['Adj Close'].pct_change(),kde=True,color='blue')\nplt.xlabel('Daily Return')\nplt.ylabel('Daily Return')\nplt.title('Bitcoin')\n\nplt.subplot(2, 2, 2)\nsns.distplot(df_dogecoin['Adj Close'].pct_change(),color='red')\nplt.xlabel('Daily Return')\nplt.ylabel('Daily Return')\nplt.title('Dogecoin')\n\nplt.subplot(2, 2, 3)\nsns.distplot(df_ethereum['Adj Close'].pct_change(),color='purple')\nplt.xlabel('Daily Return')\nplt.ylabel('Daily Return')\nplt.title('Ethereum')\n\nplt.subplot(2, 2, 4)\nsns.distplot(df_cardano['Adj Close'].pct_change(),color='green')\nplt.title('Cardano')\nplt.xlabel('Daily Return')\nplt.ylabel('Daily Return')\n\nfig.tight_layout()","047a07b4":"from tensorflow.keras.models import Sequential\nfrom tensorflow.keras.layers import Dense\nfrom tensorflow.keras.layers import LSTM\n","b5135f07":"final_df=df_bitcoin[['Date','Close']]","83a0afde":"final_df=final_df[final_df.Date>'2020-09']","ca8099a0":"final_df.head()","b0e361e0":"fig = plt.figure(figsize = (10,10))\nplt.plot(final_df.Date,final_df.Close,color='purple')\nplt.title('Close Price History')\nplt.xlabel('Date',fontsize=18)\nplt.xticks(rotation=90)\nplt.show()","5a381ae7":"final_df=final_df.set_index('Date')","a448e2c6":"data=final_df.filter(['Close'])","0ee6b46b":"data.head()","051108c3":"data.isna().sum()","803a2fc2":"data=data.dropna(subset=['Close'])","520cbee5":"data.shape","9bcc086d":"dataset=data.values","02cd01ec":"training_data_len=int(np.ceil(len(dataset)*0.8))","46a4b014":"training_data_len","a54d239e":"mms=MinMaxScaler(feature_range=(0,1))","5babeecf":"scaled_data=mms.fit_transform(dataset)","e74ec987":"train_data=scaled_data[0:training_data_len ,:]","670fe9de":"len(train_data)","03aa1559":"X_train=[]\ny_train=[]\n\nfor i in range(60,len(train_data)):\n    X_train.append(train_data[i-60:i,0])\n    y_train.append(train_data[i,0])","16ab1c0a":"X_train,y_train=np.array(X_train),np.array(y_train)","758adc65":"X_train=np.reshape(X_train,(X_train.shape[0],X_train.shape[1],1))","159023d4":"X_train.shape","c2afb5c4":"model=Sequential()\nmodel.add(LSTM(128,return_sequences=True,input_shape=(X_train.shape[1],1)))\nmodel.add(LSTM(64,return_sequences=False))\nmodel.add(Dense(25))\nmodel.add(Dense(1))","0e94e94b":"model.compile(optimizer='adam',loss='mean_squared_error')","c3a9afb2":"model.fit(X_train, y_train, batch_size=1, epochs=1)","b198b0b3":"test_data=scaled_data[training_data_len-60:621:,:]\n\nX_test=[]\ny_test=dataset[training_data_len:,:]\n\nfor i in range(60,len(test_data)):\n    X_test.append(test_data[i-60:i,0])","86ce9152":"X_test=np.array(X_test)","bce6a1f1":"X_test=np.reshape(X_test,(X_test.shape[0],X_test.shape[1],1))","0b11d03d":"X_test.shape","bcfe7a6f":"predictions=model.predict(X_test)\npredictions=mms.inverse_transform(predictions)","9a16104b":"train=data[:training_data_len]\nvalid=data[training_data_len:]\nvalid['Predictions']=predictions","381d16f0":"train","c0b38624":"\nplt.figure(figsize=(15,15))\nplt.title('Model')\n\nplt.xlabel('Date',fontsize=16)\nplt.ylabel('Closed Price ',fontsize=16)\n\nplt.plot(train['Close'])\nplt.plot(valid[['Close','Predictions']])\n\nplt.legend(['Train','Validation','Predictions'])\nplt.show()","7f8c6e25":"# Bitcoin Predictions","f743d2ac":"# LSTM Model","1059f537":"# Creating a Training dataset","789400a4":"# Trend followed by Volume over the last two years","0f6b99e6":"# Density plots for daily return","3c17198f":"# Daily Change of Cryptocurrency","bde5c84c":"# New Dataframe with only the Closed column","3f0e9196":"# Volume Trend","bc421254":"# Test Data set","8bf8e4cf":"# Train the model\n","48cd506e":"# Converting the Date column to datetime","073d84d4":"# Scale the Data","99acfdc8":"# Predicted Price","04eafa63":"# Analysis of Closing price over the last two years","22236a88":"# Trend followed by closing price","a08be349":"# Comparion between open and closing price for Cryptocurrencies\n"}}