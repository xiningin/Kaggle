{"cell_type":{"778f57e4":"code","d021c224":"code","bacadf2b":"code","47c7a8bd":"code","85fd5b3f":"code","56b163da":"code","e19cf969":"code","733f84e3":"code","518574e7":"code","ae4871b7":"code","a32ee357":"markdown","e802282c":"markdown","8f644f3f":"markdown","ac0fc101":"markdown","15be1d76":"markdown","854dfd3f":"markdown","73b80a43":"markdown"},"source":{"778f57e4":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns # for making graphs\nimport os\n\nfrom sklearn.model_selection import train_test_split\n\nfor dirname, _, filenames in os.walk('\/kaggle\/input\/titanic'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","d021c224":"train_df = pd.read_csv(\"..\/input\/titanic\/train.csv\")\ntrain_df.head()","bacadf2b":"sns.distplot(train_df[(train_df[\"Survived\"]==0) & (train_df[\"Age\"].isna() == False)].Age, bins=17, kde=False)\nsns.distplot(train_df[(train_df[\"Survived\"]==1) & (train_df[\"Age\"].isna() == False)].Age, bins=17, kde=False)","47c7a8bd":"def transform_data(df_in):\n    df_out = df_in.copy()\n    df_out[\"age_imputed\"] = df_out.Age\n    df_out[\"age_imputed\"].fillna(value=df_out.Age.mean(), inplace=True)\n    return df_out","85fd5b3f":"train_filled = transform_data(train_df)\n\nprint(sum(train_filled.Age.isna()))\nprint(sum(train_filled.age_imputed.isna()))","56b163da":"from sklearn.linear_model import LogisticRegression\n\nlogmodel = LogisticRegression()\nlogmodel.fit(np.array(train_filled.age_imputed).reshape(-1,1),train_filled.Survived)","e19cf969":"test_df = pd.read_csv(\"..\/input\/titanic\/test.csv\")\ntest_df.head()","733f84e3":"test_filled = transform_data(test_df)\npredictions = logmodel.predict(np.array(test_filled.age_imputed).reshape(-1,1))","518574e7":"predictions","ae4871b7":"submission = pd.DataFrame(test_filled.PassengerId)\nsubmission[\"Survived\"] = predictions\nsubmission.to_csv(\"submission.csv\", index=False)","a32ee357":"## Make predictions","e802282c":"## Build a model\n\nWe are going to use logistic regression using the `glm` function.","8f644f3f":"## Setup\n\nThis code loads all the libraries that we will need, and also lists the input files that we have available to us.","ac0fc101":"## Estimate missing passenger ages\n\nA number of the passengers do not have recorded ages. We are going to fill in those missing ages with the average (mean) age for every passenger!\n\nAs we are also going to have to fill in any missing ages in the test dataset (when we make our predictions for submission), we will create a function so that we can just write the code once.","15be1d76":"## Read training data file into a dataframe","854dfd3f":"## Explore the data","73b80a43":"If we apply this function to our training data, `train_df`, we see that the 177 missing values in the Age column get replaced."}}