{"cell_type":{"775e0529":"code","d9f01465":"code","84ba5aa5":"code","db1ac197":"code","7192200f":"code","b7d22635":"code","405f44c3":"code","cd7523eb":"code","8a721522":"code","2d2bcab0":"code","3042a970":"code","bf662810":"code","a710f24c":"code","144af1a4":"code","c193a5b5":"code","e4b9988e":"code","ee150cff":"code","4f90511f":"code","88383b1d":"code","345a9355":"code","211c3c99":"code","fe7b80d3":"code","20492509":"code","c2eeb616":"code","51ee69d3":"code","bb85a9e4":"code","80fd9b2f":"code","d9c5fc6d":"code","64e02a21":"code","43ea36bf":"code","83ad201b":"code","9a250b6a":"code","f96010d4":"code","d3ac6e10":"code","61540379":"code","56daffb6":"code","80ed5e24":"code","43d58142":"code","10c93d3b":"code","e899a58a":"markdown","06ddb513":"markdown","e5b23c1a":"markdown","fcf9a10d":"markdown","22f99e6e":"markdown","1fc69b7f":"markdown","7bb78161":"markdown","297b37a2":"markdown","617b191b":"markdown","ee4c6a13":"markdown"},"source":{"775e0529":"# Load libraries:\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)","d9f01465":"# Read a data set from a CSV file:\ndf = pd.read_csv('..\/input\/telecom_churn.csv')\n# CSV is a simple text-based comma-separated format\n# First few lines of the above file are:\n#\n# State,Account length,Area code,International plan,Voice mail plan,Number vmail messages,Total day minutes,Total day calls,Total day charge,Total eve minutes,Total eve calls,Total eve charge,Total night minutes,Total night calls,Total night charge,Total intl minutes,Total intl calls,Total intl charge,Customer service calls,Churn\n# KS,128,415,No,Yes,25,265.1,110,45.07,197.4,99,16.78,244.7,91,11.01,10.0,3,2.7,1,False\n# OH,107,415,No,Yes,26,161.6,123,27.47,195.5,103,16.62,254.4,103,11.45,13.7,3,3.7,1,False\n\n","84ba5aa5":"# A quick look at the first few rows, nicely formatted:\ndf.head()\n# The 2D DataFrame object\n# - rows = examples, columns = features\n# Rows and columns have indexes\n# - in this case, rows are indexed by number, column by name","db1ac197":"# Indexing by a column name gives a one-dimensional Series:\n# (much more on indexing later)\ndf.head()['State']","7192200f":"# Basic info about the dataset:\nprint('Number of rows, columns', df.shape)\nprint('Columns (features):')\nprint(' ',df.columns)","b7d22635":"# Some more details\n# - type of each feature\n# - how many missing values for each feature?\n# - memory usage\ndf.info()","405f44c3":"# Get a section of rows by row number:\ndfSmall = df[0:6]\ndfSmall","cd7523eb":"# get one column (as a one-dimensional Series):\ndfSmall['International plan']","8a721522":"# get one value:\ndfSmall['International plan'][0]","2d2bcab0":"# Selecting specified rows and columns by index:\ndfSmall.loc[:4,['State','Voice mail plan']]","3042a970":"# Selecting specified rows and columns by index:\ndfSmall.loc[:4,'State':'Voice mail plan']","bf662810":"# Selecting specified rows and columns by number (position)\ndf.iloc[[1,4,5],1:4]","a710f24c":"# compute a simple boolean condition on rows of a DataFrame:\ndfSmall['International plan']=='Yes'","144af1a4":"# compute a more complicated boolean condition on rows of a DataFrame:\n(dfSmall['International plan']=='Yes') & (dfSmall['State']=='OH')","c193a5b5":"# compute a really complicated boolean condition on rows of a DataFrame:\ndfSmall.apply(lambda row : row['State'].startswith('O')\n                              and row['International plan']=='Yes',\n              axis=1)","e4b9988e":"dfSmall[dfSmall['International plan']=='Yes']","ee150cff":"# Summary stats on numeric features:\ndf.describe()","4f90511f":"# Summary stats on categorical features:\ndf.describe(include=['object','bool'])","88383b1d":"# describe returns a DataFrame!\ndf.describe().loc[['mean','std'],['Account length','Total night calls']]","345a9355":"# individual stat functions on a DataFrame - returns a Series:\ndf.mean()","211c3c99":"# individual stat functions on a Series - returns a value:\ndf['Account length'].mean()","fe7b80d3":"# value counts for a categorical feature - returns a Series:\ndf['State'].value_counts()","20492509":"df['State'].value_counts(normalize=True).loc[['NY','DC']]","c2eeb616":"df['State'].value_counts(normalize=True)['NY']","51ee69d3":"# Summary stats on numeric features for those with an international plan:\ndf[df['International plan']=='Yes'].describe()","bb85a9e4":"# Churn percentage for those living in NY or NJ:\ndf[(df['State']=='NY') | (df['State']=='NJ')]['Churn'].value_counts(normalize=True)","80fd9b2f":"# Churn percentage by state:\ndf.groupby(['State'])['Churn'].agg([np.mean])\n# can also use multiple features in each of the above lists","d9c5fc6d":"# Churn percentage by state, sorted in increasing order:\ndf.groupby(['State'])['Churn'].agg([np.mean,len]).sort_values(by='mean')\n","64e02a21":"# Another way to get churn by state:\npd.crosstab(df['Churn'],df['State'])","43ea36bf":"# And yet another - this time showing both churn and total day minutes:\ndf.pivot_table(['Churn','Total day minutes'],['State'],aggfunc='mean')","83ad201b":"# Add a column in end position:\nmeanDayMinutes = df['Total day minutes'].mean()\ndf['Heavy day user'] = df['Total day minutes'] > meanDayMinutes\ndf.head()","9a250b6a":"# Delete a column:\ndf.drop('Heavy day user',axis=1,inplace=True)\n# use axis=0 to delete rows\ndf.head()","f96010d4":"# Add a column in a specified position:\ndf.insert(loc=1, column='Heavy day user', value = df['Total day minutes']>meanDayMinutes)\ndf.head()","d3ac6e10":"df['Heavy day user'].value_counts()","61540379":"# Are heavy day users more likely to churn?\ndf.pivot_table(['Churn'],['Heavy day user'],aggfunc=['mean',len])\n","56daffb6":"# Drop rows with churn unavailable\n# (will do nothing on this dataset):\ndf.dropna(axis=0, subset=['Churn'], inplace=True)\ndf.info()","80ed5e24":"# convert 'International plan' and 'Voice mail plan' to int 0\/1:\ndf['International plan'] = (df['International plan']=='Yes').astype('int')\n# Or could use map (supply a list of original -> transformed values):\n# df['Voice mail plan'] = df['Voice mail plan'].map({'Yes':1,'No':0})\n# Or could use apply (most general - supply a function that converts the values):\ndf['Voice mail plan'] = df['Voice mail plan'].apply(lambda x : int(x=='Yes'))\n\n# convert 'Heavy day user' and 'Churn' to int 0\/1:\ndf['Heavy day user'] = df['Heavy day user'].astype('int')\ndf['Churn'] = df['Churn'].astype('int')\ndf.head()","43d58142":"# Convert DataFrame column to numpy array (ex. for use by ML algorithms):\ndf['Churn'].values","10c93d3b":"# Convert DataFrame to numpy matrix (ex. for use by ML algorithms):\ndf.drop(['State','Churn'],axis=1).values","e899a58a":"# Select parts of the DataFrame by row\/column:","06ddb513":"# Select rows of a DataFrame by boolean condition:\n\nFirst, compute a Series that contains the condition's value for each row:","e5b23c1a":"# Get some quick info about the data:","fcf9a10d":"# Some data manipulation:","22f99e6e":"# Ingest data:","1fc69b7f":"Once you have the boolean Series, you can simply index the DataFrame using it:\n\nThis selects the rows with a true boolean value.","7bb78161":"# More detailed stats on a DataFrame:","297b37a2":"This notebook is mostly based on https:\/\/www.kaggle.com\/kashnitsky\/topic-1-exploratory-data-analysis-with-pandas\n","617b191b":"pandas can also handle other file formats and data sources\n\nexample: Excel (.xls, .xslx) - pandas.read_excel(path, sheet_name, ... )\n- see https:\/\/pandas.pydata.org\/pandas-docs\/stable\/reference\/api\/pandas.read_excel.html\n\nexample: SQL - pandas.read_sql(sql,con, ... )\n- see https:\/\/pandas.pydata.org\/pandas-docs\/stable\/reference\/api\/pandas.read_sql.html#pandas.read_sql\n\nMany other possible sources - see https:\/\/pandas.pydata.org\/pandas-docs\/stable\/reference\/io.html\n\n","ee4c6a13":"# Starting to look at the data in more complex ways:"}}