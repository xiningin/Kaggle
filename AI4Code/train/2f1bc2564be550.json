{"cell_type":{"0062ffd8":"code","7b51b0f5":"code","1f9e4d33":"code","c88acc15":"code","24a043eb":"code","b95d7a38":"markdown","f1ddb685":"markdown","6de2759b":"markdown","7324203d":"markdown"},"source":{"0062ffd8":"import numpy as np\nimport pandas as pd\nfrom sklearn import *\nimport warnings; warnings.filterwarnings(\"ignore\")\n\ntrain = pd.read_csv('..\/input\/train.csv')\ntest = pd.read_csv('..\/input\/test.csv')\nsub = pd.read_csv('..\/input\/sample_submission.csv')\ntrain.shape, test.shape, sub.shape","7b51b0f5":"import matplotlib.pyplot as plt\nimport networkx as nx\nG=nx.Graph()\n\ncol = [c for c in train.columns if c not in ['id', 'target']]\n\nG.add_node('Start')\nfor i in range(4):\n    G.add_node('Column Section '+ str(i))\n    G.add_edge('Start','Column Section '+ str(i))\n    for c in train[col].columns:\n        if c.split('-')[i] not in G.nodes():\n            G.add_node(c.split('-')[i])\n            G.add_edge('Column Section '+ str(i), c.split('-')[i])\n        if c not in G.nodes():\n            G.add_node(c)\n        G.add_edge(c.split('-')[i],c)\nplt.figure(1,figsize=(12,12))\nnx.draw_networkx(G, node_size=1,font_size=6)\nplt.axis('off'); plt.show()","1f9e4d33":"df = []\nfor c in train.columns:\n    if c not in ['target', 'id', 'wheezy-copper-turtle-magic']:\n        l1 = test[c].unique()\n        l2 = train[c].unique()\n        df.append([c, len(l1), len(l2), len(l1)- 131073, len(l2) - 262144])\ndf = pd.DataFrame(df, columns=['col', 'test_unique', 'train_unique', 'test_diff', 'train_diff'])\nfor c in ['test_unique', 'train_unique', 'test_diff', 'train_diff']:\n    print(df[c].min(), df[c].max())\n    \n#col = list(df[((df['test_diff']<-1900) & (df['train_diff']<-7500))]['col'].values)\ndf.head()","c88acc15":"col = [c for c in train.columns if c not in ['id', 'target', 'wheezy-copper-turtle-magic']]\n\ndf_all = pd.concat((train,test), axis=0, ignore_index=True).reset_index(drop=True)\ndf_all['wheezy-copper-turtle-magic'] = df_all['wheezy-copper-turtle-magic'].astype('category')\n\ntrain = df_all[:train.shape[0]].reset_index(drop=True)\ntest = df_all[train.shape[0]:].reset_index(drop=True)\ndel df_all\ntrain.shape, test.shape","24a043eb":"test_ = []\n\nkn = neighbors.KNeighborsClassifier(n_neighbors=17, p=2.9)\nsv = svm.NuSVC(kernel='poly', degree=4, random_state=4, probability=True, coef0=0.08)\n\nfor s in sorted(train['wheezy-copper-turtle-magic'].unique()):\n    train2 = train[train['wheezy-copper-turtle-magic']==s].reset_index(drop=True).copy()\n    test2 = test[test['wheezy-copper-turtle-magic']==s].reset_index(drop=True).copy()\n    kn.fit(train2[col], train2['target'])\n    sv.fit(train2[col], train2['target'])\n    test2['target'] = (kn.predict_proba(test2[col])[:,1] * 0.2) + (sv.predict_proba(test2[col])[:,1] * 0.8)\n    test_.append(test2)\n\ntest_ = pd.concat(test_).reset_index(drop=True)\ntest_[['id','target']].to_csv(\"submission.csv\", index=False)","b95d7a38":"How unique are the column values\n==========","f1ddb685":"Getting wheezy\n=====","6de2759b":"Lets Race\n======","7324203d":"Wordplay in Column Names\n=============================="}}