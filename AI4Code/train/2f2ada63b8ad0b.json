{"cell_type":{"31c29382":"code","7a820e80":"code","bef118fa":"code","a7c86b05":"code","927c7d72":"code","27a79342":"code","0b326da9":"code","58e43451":"code","d83aeef7":"code","d267d62f":"code","945f8a16":"code","08133f13":"code","3a94f292":"code","cb8b345b":"code","473ac3ac":"code","960eec0a":"code","112251d2":"code","3867ba03":"code","5b89df05":"code","b9d5944c":"code","29ed64d1":"code","3de9daf3":"code","3b110645":"code","cbf84e24":"markdown","f272a07c":"markdown","443302c6":"markdown","4d0ffa45":"markdown","713b5807":"markdown","65c423a8":"markdown","b7e44d96":"markdown","4831c25e":"markdown","d50e5c1a":"markdown","56f35198":"markdown","56541840":"markdown","60654dba":"markdown","17c62c79":"markdown","b9e5afd5":"markdown","f8485177":"markdown","7fe7fe78":"markdown"},"source":{"31c29382":"import pandas as pd","7a820e80":"GLstats = pd.read_csv('..\/input\/uber-lyft-cab-prices\/cab_rides.csv')","bef118fa":"import numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline\nimport warnings\nwarnings.filterwarnings('ignore')","a7c86b05":"sns.set_style('whitegrid')\nf, axes = plt.subplots (2,1, figsize=(4,6))\n\n#histogram\nx=['Uber','Lyft']\ny = [GLstats.cab_type[(GLstats.cab_type)=='Uber'].count(),\\\n     GLstats.cab_type[(GLstats.cab_type)=='Lyft'].count()]\n\nvis1= sns.barplot(x,y,palette='Accent',ax=axes[0])\nvis1.set(xlabel='Cab Type',ylabel='Number of cab')\n\n\nfor p in vis1.patches:\n             vis1.annotate(\"%.f\" % p.get_height(), (p.get_x() + p.get_width() \/ 2., p.get_height()),\n                 ha='center', va='center', fontsize=11, color='gray', xytext=(0, 20),\n                 textcoords='offset points')\n\n\n#Pie\nNcab_type = [GLstats.cab_type[(GLstats.cab_type)=='Uber'].count(),\\\n             GLstats.cab_type[(GLstats.cab_type)=='Lyft'].count()]\n     \ncab_type = ['Uber','Lyft']\n\nplt.pie(Ncab_type, labels=cab_type, startangle=90, autopct='%.1f%%')\n\n\nplt.show()","927c7d72":"Taxi=GLstats[GLstats.name == 'Taxi'].index\nGLstats.drop(Taxi , inplace=True)\nvis1=sns.scatterplot(x=GLstats.distance,y=GLstats.price,data=GLstats, hue=GLstats.cab_type, hue_order=cab_type,alpha=0.3, legend='full')","27a79342":"vis1=sns.scatterplot(x=GLstats.distance,y=GLstats.surge_multiplier,data=GLstats, hue=GLstats.cab_type, hue_order=cab_type)","0b326da9":"LyftOnly=GLstats[GLstats.cab_type == 'Lyft']\nA=LyftOnly.groupby(['name','surge_multiplier'],as_index=False).count()\nA","58e43451":"A[:][22:29]\nB=A[22:29]['id']\nSurge = B\n     \nSurge_Factor = ['1.0x','1.25x','1.5x','1.75x','2.0x','2.5x','3.0x']\n\nvis1= sns.barplot(x=Surge_Factor,y=B)\nvis1.set(xlabel='Surge Multiplier',ylabel='Number of times')\n\ntotal=sum(B\/100)\nfor p in vis1.patches:\n     height = p.get_height()\n     vis1.text(p.get_x()+p.get_width()\/2.,\n            height + 3,\n            '{:1.4f}%'.format(height\/total),\n            ha=\"center\") \n\nplt.show()","d83aeef7":"GLstats2=GLstats.copy()\n\nfor i in (list(GLstats2.index.values)):\n    if GLstats2.cab_type[i]=='Uber': \n        pass\n    elif (GLstats2.cab_type[i]=='Lyft') & (GLstats2.surge_multiplier[i]!=1.0):\n        GLstats2.price[i]=(GLstats.price[i] * GLstats2.surge_multiplier[i])","d267d62f":"g, axes = plt.subplots (1,2, figsize=(16,6))\n\nvis1=sns.scatterplot(x=GLstats.distance,y=GLstats.price,data=GLstats, hue=GLstats.cab_type, hue_order=cab_type,alpha=0.3, ax=axes[0])\n\nvis2=sns.scatterplot(x=GLstats2.distance,y=GLstats2.price,data=GLstats2, hue=GLstats2.cab_type, hue_order=cab_type, alpha=0.3,ax=axes[1])\n\nvis1.set(xlim=(-0.5, 8.5))\nvis1.set(ylim=(-5, 200))\nvis2.set(xlim=(-0.5, 8.5))\nvis2.set(ylim=(-5, 200))\nvis1.set(xlabel='Distance in Miles',ylabel='Price in USD')\nvis1.set(xlabel='Distance in Miles',ylabel='Price in USD')\n\n\naxes[0].set_title('Estimated Fare')\naxes[1].set_title('Actual Fare charged')\n\nplt.ioff()","945f8a16":"h, axes = plt.subplots (1,2, figsize=(12,4))\n\nUx=GLstats.name[GLstats.cab_type=='Uber'].unique()\nLx=GLstats.name[GLstats.cab_type=='Lyft'].unique()\nUy = GLstats.name[GLstats.name=='UberXL'].count(),GLstats.name[GLstats.name=='Black'].count(),\\\n     GLstats.name[GLstats.name=='UberX'].count(),GLstats.name[GLstats.name=='WAV'].count(),\\\n     GLstats.name[GLstats.name=='Black SUV'].count(),GLstats.name[GLstats.name=='UberPool'].count()\n\nLy=GLstats.name[GLstats.name=='Shared'].count(),GLstats.name[GLstats.name=='Lux'].count(),\\\n     GLstats.name[GLstats.name=='Lyft'].count(),GLstats.name[GLstats.name=='Lux Black XL'].count(),\\\n     GLstats.name[GLstats.name=='Lyft XL'].count(),GLstats.name[GLstats.name=='Lux Black'].count()\n\nvis1= sns.barplot(Ux,Uy,palette='Accent',ax=axes[0])\nvis2= sns.barplot(Lx,Ly,palette='Accent',ax=axes[1])\n\naxes[0].set_title('Number of Uber Rides')\naxes[1].set_title('Number of Lyft Rides')\nplt.ioff()","08133f13":"LyftOnly2=GLstats2[GLstats2.cab_type == 'Lyft']\nUberOnly=GLstats2[GLstats2.cab_type == 'Uber']\n\ng, axes = plt.subplots (1,2, figsize=(16,6))\n\nvis1=sns.scatterplot(x=LyftOnly2.distance,y=LyftOnly2.price,data=LyftOnly2, hue=LyftOnly.name, ax=axes[1])\nvis2=sns.scatterplot(x=UberOnly.distance,y=UberOnly.price,data=UberOnly, hue=UberOnly.name, ax=axes[0])\n\nvis1.set(xlim=(-0.5, 8.5))\nvis1.set(ylim=(-5, 200))\nvis2.set(xlim=(-0.5, 8.5))\nvis2.set(ylim=(-5, 200))\nvis1.set(xlabel='Distance in Miles',ylabel='Price in USD')\nvis2.set(xlabel='Distance in Miles',ylabel='Price in USD')\n\n\naxes[1].set_title('Lift Fare vs Distance by car type')\naxes[0].set_title('Uber Fare vs Distance by car type')\nplt.ioff()","3a94f292":"Join_TDS=UberOnly.merge(LyftOnly2, how='inner',on=['time_stamp','destination','source'])","cb8b345b":"Join_TDS = Join_TDS.drop(columns=[\"id_x\",\"product_id_x\",\"id_y\",\"product_id_y\",\"surge_multiplier_x\",\"surge_multiplier_y\"])","473ac3ac":"A=Join_TDS[Join_TDS.name_x == 'WAV'].index\nJoin_TDS.drop(A , inplace=True)\nA=Join_TDS[Join_TDS.name_x == 'Black'].index\nJoin_TDS.drop(A , inplace=True)\nA=Join_TDS[Join_TDS.name_y == 'Lux'].index                \nJoin_TDS.drop(A , inplace=True)\nA=Join_TDS[Join_TDS.name_y == 'Lux Black'].index                \nJoin_TDS.drop(A , inplace=True)\n","960eec0a":"g, axes = plt.subplots (1,2, figsize=(16,6))\n\nU1=['UberX','Black SUV','UberXL','UberPool']\nL1=['Lyft','Lux Black XL','Lyft XL','Shared']\n\nvis1=sns.scatterplot(x=Join_TDS.distance_x,y=Join_TDS.price_x,data=Join_TDS,hue='name_x',hue_order=U1,ax=axes[0])\nvis2=sns.scatterplot(x=Join_TDS.distance_y,y=Join_TDS.price_y,data=Join_TDS,hue='name_y',hue_order=L1,ax=axes[1])\n\nvis1.set(xlim=(-0.2, 7))\nvis1.set(ylim=(-5, 200))\nvis2.set(xlim=(-0.2, 7))\nvis2.set(ylim=(-5, 200))\nvis1.set(xlabel='Distance in Miles',ylabel='Price in USD')\nvis2.set(xlabel='Distance in Miles',ylabel='Price in USD')\nvis1.set_title('Grab Ride')\nvis2.set_title('Lyft Ride')\n\nplt.ioff()","112251d2":"sns.set_style('whitegrid')\ng, axes = plt.subplots (2,2, figsize=(14,10))\n\n\nU1=['UberX','Black SUV','UberXL','UberPool']\nL1=['Lyft','Lux Black XL','Lyft XL','Shared']\n\nvis1=sns.scatterplot(x=Join_TDS.distance_x,y=Join_TDS.price_x,data=Join_TDS,hue='name_x',hue_order=U1,ax=axes[1,0])\nvis2=sns.scatterplot(x=Join_TDS.distance_y,y=Join_TDS.price_y,data=Join_TDS,hue='name_y',hue_order=L1,ax=axes[1,1])\n\nvis1.set(xlim=(-0.2, 7))\nvis1.set(ylim=(-5, 50))\nvis2.set(xlim=(-0.2, 7))\nvis2.set(ylim=(-5, 50))\nvis1.set(xlabel='Distance in Miles',ylabel='Price in USD')\nvis2.set(xlabel='Distance in Miles',ylabel='Price in USD')\n\n\n\nUx=['UberX', 'Black SUV', 'UberXL', 'UberPool']\nLx=['Lyft', 'Lux Black XL', 'Lyft XL', 'Shared']\nUy = Join_TDS.name_x[Join_TDS.name_x=='UberX'].count(),Join_TDS.name_x[Join_TDS.name_x=='Black SUV'].count(),\\\n     Join_TDS.name_x[Join_TDS.name_x=='UberXL'].count(),Join_TDS.name_x[Join_TDS.name_x=='UberPool'].count()\n\nLy=Join_TDS.name_y[Join_TDS.name_y=='Lyft'].count(),Join_TDS.name_y[Join_TDS.name_y=='Lux Black XL'].count(),\\\n     Join_TDS.name_y[Join_TDS.name_y=='Lyft XL'].count(),Join_TDS.name_y[Join_TDS.name_y=='Shared'].count()\n\nvis3= sns.barplot(Ux,Uy,ax=axes[0,0])\n\nvis4= sns.barplot(Lx,Ly,ax=axes[0,1])\n\n\nfor p in vis3.patches:\n             vis3.annotate(\"%.2f\" % p.get_height(), (p.get_x() + p.get_width() \/ 2., p.get_height()),\n                 ha='center', va='center', fontsize=10, color='gray', xytext=(0, 6),\n                 textcoords='offset points')\nfor p in vis4.patches:\n             vis4.annotate(\"%.2f\" % p.get_height(), (p.get_x() + p.get_width() \/ 2., p.get_height()),\n                 ha='center', va='center', fontsize=10, color='gray', xytext=(0, 6),\n                 textcoords='offset points')\n        \nplt.ioff()\n\n\naxes[0,0].set_title('Number of Uber Rides')\naxes[0,1].set_title('Number of Lyft Rides')\nplt.ioff()\n\n\nplt.legend(bbox_to_anchor=(0.8,0.25))\n\nplt.ioff()","3867ba03":"list(Join_TDS.columns.values)\nA = Join_TDS[['time_stamp',\n 'destination','source',\n'distance_x', 'cab_type_x', 'price_x', 'name_x']]\n\nA.columns=['time_stamp',\n 'destination','source',\n'distance', 'cab_type', 'price', 'name']\n\nB = Join_TDS[['time_stamp',\n 'destination','source',\n'distance_y', 'cab_type_y', 'price_y', 'name_y']]\n\nB.columns=['time_stamp',\n 'destination','source',\n'distance', 'cab_type', 'price', 'name']\nFPM=A.append(B)","5b89df05":"FPM['fare_per_mile']= round(FPM.price\/FPM.distance,2)","b9d5944c":"O1=['UberX', 'Black SUV', 'UberXL', 'UberPool', 'Lyft', 'Lux Black XL',\n        'Lyft XL','Shared']\n\nimport matplotlib as mpl\nsns.set_style('darkgrid')\nplt.figure(figsize=(10, 8))\n\nvis1 = sns.boxplot( data = FPM, x = 'name', y = 'fare_per_mile', \\\n                   showfliers=False, hue='cab_type',order=O1,palette='Set3')\n\n\nvis1.get_xaxis().set_minor_locator(mpl.ticker.AutoMinorLocator())\nvis1.get_yaxis().set_minor_locator(mpl.ticker.AutoMinorLocator())\n\nvis1.set_title('Fare($) Per Mile')\nvis1.set(xlabel='Cab Type',ylabel='Fare ($) Per Mile')\n\nvis1.grid(b=True, which='major', color='w', linewidth=1)\nvis1.grid(b=True, which='minor', color='w', linewidth=0.5)\nplt.ioff()\n","29ed64d1":"import datetime\n#convert 13digit time stamp to datetime format\nGLstats2['time']= pd.to_datetime(GLstats2['time_stamp'], unit='ms')\n#extract hours only\nGLstats2['hour']= GLstats2['time'].dt.hour\nGLstats2['fare_per_mile']= round(GLstats2.price\/GLstats2.distance,2)\n\n#drop unwanted rows that is not comparable\nA=GLstats2[GLstats2.name == 'WAV'].index\nGLstats2.drop(A , inplace=True)\nA=GLstats2[GLstats2.name == 'Black'].index\nGLstats2.drop(A , inplace=True)\nA=GLstats2[GLstats2.name == 'Lux'].index                \nGLstats2.drop(A , inplace=True)\nA=GLstats2[GLstats2.name == 'Lux Black'].index                \nGLstats2.drop(A , inplace=True)","3de9daf3":"LyftOnly=GLstats2[GLstats2.cab_type == 'Lyft']\nUberOnly=GLstats2[GLstats2.cab_type == 'Uber']\n\nvis1 = sns.distplot(LyftOnly.hour, bins=24,kde=False, color='blue')\nvis2 = sns.distplot(UberOnly.hour, bins=24,kde=False,color='yellow')\n\nplt.xticks(range(0, 25,2))\nplt.legend(title='cab type', loc='upper left', labels=['Lyft','Uber'],bbox_to_anchor=(1,1))\nvis1.set(ylabel='Number of rides')\n\n\nplt.ioff()","3b110645":"vis1 = sns.lineplot(x=GLstats2.hour, y=GLstats2.fare_per_mile,\\\n                    data=GLstats2, hue=GLstats2.name,err_style=None)\n\nplt.xticks(range(0, 25,2))\nvis1.set(xlabel='Hour of day',ylabel='Fare ($) per mile')\nplt.legend(title='cab type', loc='upper left', labels=['Lyft Shared', 'Lyft','Lyft Lux Black XL','Lyft XL',\\\n                                                     'UberXL','UberX','Uber Black SUV','UberPool'],bbox_to_anchor=(1,1))\n\nplt.ioff()","cbf84e24":"About 92% of the time, surge does not happen. about 4% 1.25x surge multiplier happens to the fare, 2% for 1.5x surge multiplier and so on. In this case I will multiply the surge multiplier to the initial estimated fare, to show the actual price for Lyft rides.","f272a07c":"For shared ride (\"Shared\" for Lyft and \"Uberpool' for Uber), Lyft has a cheaper rate compared to Uber.\nFor other rides, both sides looks similar pretty similar and it is difficult to tell which one is cheaper yet.\nSo, a boxplot of price per mile travelled vs ride type is plotted:","443302c6":"Further drop other rides that are hard to compare:\nWAV= wheelchar accessible (Uber) that is not specified in Lyft\nUber Black which I am not sure to compare with Lyft Lux or Lyft Lux Black","4d0ffa45":"After multiplying with the surge multiplier, Lyft fare shows higher range of fare. Does this means Uber has a better fare rate? The answer is No. I'll prove it in the coming visualizations.\nFirst, let's break down into the types of rides both companies have. As we know there are normal rides, carpool rides, SUV rides, luxury rides etc....each has a different rate.","713b5807":"Let's make a quick investigation on the surge trend for Lyft:","65c423a8":"Before showing a general price vs distance chart, drop 'Taxi' from Uber cabs as they use a different fare structure (in the dataset Taxi fare is always 0 USD)\nBased on the chart above, it can be observed that Lyft has a lower minimum fare compared to Uber, at the same time Lyft has higher maximum fare. Also, Uber travel distances are generally higher than Lyft.","b7e44d96":"This hourly chart gives us the following info:\n\n*From Top*\n* **First two pair lines:** The average fare for Lyft Lux Black XL has a less deviation with respect to hour of the day compared to Uber Black SUV\n* **2nd line pair:** The average fare per mile for UberXL is more expensive than Lyft XL rides\n* **3rd line pair:** Lyft ordinary ride beats UberX ordinary ride in terms of average fare\n* **Final pair:** Lyft Shared ride which average about 3USD is cheaper than UberPool that averages above 5USD.\n\n**So far, I infer Lyft rides has a better rate compared to Uber for this particular dataset.**\n\nFuture work: \nDay of the week factor\nTraffic condition of the given area are not compared exactly, only time is common","4831c25e":"From the distribution we can say that the trend of rides are similar for both company, with Uber having more rides than Lyft.","d50e5c1a":"The dataset has equal number of ride types for both company, with Uber having roughly 5000 more rides than Lyft for each category. Next we will look at the fare for each category.","56f35198":"This notebook contains process of data exploration and visualization that helps me to make inference on deciding which of the 2 ridesharing company is better for consumer point of view.\n\n**Objective**: To compare the fare between Lyft and Uber\n\nTime frame: 26th Nov 2018 to 19th Dec 2018 (24 days)\n\nLocation: Boston, MA","56541840":"We also know there is a 'surge multiplier' factor in Lyft, where the fare is multiplied by a certain rate during rush hours.\n\nWhen prices surge , Uber does not show a multiplier and instead quotes only the higher price up front. Lyft marks up its Prime Time pricing with a percentage: If the rate is 50 percent, a fare that would normally be USD10 costs USD15.\n[[source](https:\/\/www.nytimes.com\/2019\/04\/17\/technology\/personaltech\/uber-vs-lyft.html)]\nThis will be verified with the visualization below:","60654dba":"Except \"Shared\" type Lyft, most of the Lyft cbs shows a similar number of \"surge multiplier\" occurence. Chart below will show a rough idea on the occurence rate.","17c62c79":"Unfortunately the chart looks a little messy and it is difficult to compare, so let's further break down the types of rides.\nBased on some online results, we can say the following for both competiting company rides:\n\n**Lyft vs Uber**\n* Lyft ordinary ride fare is comparable to UberX\n* Lux Black XL is comparable to Black SUV\n* Lyft XL is comparable to UberXL\n* Shared is comparable to UberPool\n\nAt the same time, we will join the intersection of Lyft and Uber rides that shares the same time frame (timestamp) and source & destination. This way it is a fair comparison as we are comparing the exact time\/weather\/traffic condition from both company.\n","b9e5afd5":"Lyft has a better rate for carpool category.\nLyft XL has a slightly lower fare per mile than UberXL.\nUber Black SUV shows lower rate than Lyft Black XL.\nLyft ordinary ride and UberX has similar rates, in which Lyft is better up till 3rd quarter of sample.\n\nNext let's look at the time factor that might affect the availability and fare for the rides","f8485177":"It looks like our first observation still stands, Lyft has a bigger range of fare rate, at the same time lower minumum charge. Let's zoom both chart to the majority data located, which is price below 50 USD","7fe7fe78":"Uber gets a more rides compared to Lyft in this particular dataset"}}