{"cell_type":{"00b17e7a":"code","5e1a1879":"code","b0d376fd":"code","f8df5f1c":"code","22c2eb8d":"code","bf9749e0":"code","3b8355a1":"code","8a9e166e":"code","e8a8e6fd":"code","26afadd2":"code","20c593b3":"code","dbb6d1c8":"code","a296fd70":"code","69f3b9fb":"markdown"},"source":{"00b17e7a":"from google.cloud import bigquery\nfrom bq_helper import BigQueryHelper\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt","5e1a1879":"#Set up a dataset instance\nbq_assistant = BigQueryHelper(\"bigquery-public-data\",\"world_bank_intl_education\")\nbq_assistant.list_tables()","b0d376fd":"#Table of interest -- international education\nbq_assistant.table_schema('international_education')","f8df5f1c":"#Table at a glance\nbq_assistant.head('international_education',10)","22c2eb8d":"#Explore indicators \nquery0 = '''\n            select distinct(indicator_name),indicator_code \n            from `bigquery-public-data.world_bank_intl_education.international_education`\n            '''\nindicators = bq_assistant.query_to_pandas_safe(query0)\nnum_indicators = len(indicators.index)\nprint ('There are %d indicators'%(num_indicators))\nindicators.head()","bf9749e0":"#Number of indicators by category in terms of education level\nfor ed in ['primary','secondary','higher']:\n    num_indicators = len(indicators[indicators['indicator_name'].str.contains('%s education'%(ed))].index)\n    print ('%d indicators are related to %s education'%(num_indicators,ed))","3b8355a1":"#Exploratory analysis based on primary education\nindicators_PE = indicators[indicators['indicator_name'].str.contains('primary education')].copy()\nindicators_PE.tail(10)","8a9e166e":"#Repetition rate in primary education(all grades) by country\n#Top 20 countries with highest repetition rate in primary education(all grades) after year 2000\nindicator = \"UIS.REPR.1.M\"\nquery1 = '''\n             select country_name,AVG(value) as percentage_of_repetition\n             from `bigquery-public-data.world_bank_intl_education.international_education`\n             where indicator_code = \"UIS.REPR.1.M\"\n             and year > 2000\n             group by country_name\n             order by percentage_of_repetition desc\n             limit 20 '''\nrepetition = bq_assistant.query_to_pandas_safe(query1)\nrepetition.head(5)","e8a8e6fd":"#plot\nfig = plt.figure(figsize=(16,9))\npl = fig.add_subplot(111)\npl.barh(np.arange(len(repetition.index)),np.array(repetition['percentage_of_repetition']),color='burlywood')\nplt.yticks(np.arange(len(repetition.index)),repetition['country_name'])\nplt.title('Repetition Rate in Primary Education(all grades) after 2000')\nplt.xlabel('percentage')\nplt.ylabel('country')\nplt.show()","26afadd2":"#Pupil\/trained teacher ratio in primary educatio\nindicator =\"UIS.PTRHC.1.TRAINED\"\nquery2 = '''\n             select country_name,AVG(value) as pupil_teacher_ratio\n             from `bigquery-public-data.world_bank_intl_education.international_education`\n             where indicator_code = \"UIS.PTRHC.1.TRAINED\"\n             and year > 2000\n             group by country_name\n             order by pupil_teacher_ratio desc\n             limit 20 '''\npt_ratio = bq_assistant.query_to_pandas_safe(query2)\npt_ratio.head(5)","20c593b3":"#plot\nfig = plt.figure(figsize=(16,9))\npl = fig.add_subplot(111)\npl.barh(np.arange(len(pt_ratio.index)),np.array(pt_ratio['pupil_teacher_ratio']),color='chartreuse')\nplt.yticks(np.arange(len(pt_ratio.index)),pt_ratio['country_name'])\nplt.title('pupil\/teacher ratio in Primary Education(all grades) after 2000')\nplt.xlabel('ratio')\nplt.ylabel('country')\nplt.show()","dbb6d1c8":"#Theoritical duration of primary education(in years) after 2000\nquery3 = '''\n             select count(country_name) as number_of_countries, value as duration_of_primary_school\n             from `bigquery-public-data.world_bank_intl_education.international_education`\n             where indicator_code = \"SE.PRM.DURS\"\n             and year > 2000\n             group by duration_of_primary_school\n             order by number_of_countries desc\n             limit 20 '''\nduration_PE = bq_assistant.query_to_pandas_safe(query3)\nduration_PE.head(5)","a296fd70":"#plot\nfig = plt.figure(figsize=(4,4))\npl = fig.add_subplot(111)\nsizes = duration_PE['number_of_countries']\nlabels = duration_PE['duration_of_primary_school']\npl.pie(sizes,labels = labels,autopct='%1.1f%%',\n        shadow=True, startangle=90)\n\nplt.title('Duration of Primary School')\nplt.show()","69f3b9fb":"**This kernel explores World Bank's international education database with a focus on primary education."}}