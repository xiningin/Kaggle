{"cell_type":{"af8ede11":"code","b22aa05d":"code","b12588c9":"code","491b4603":"code","35c338bc":"code","7e1fc700":"markdown"},"source":{"af8ede11":"import numpy as np\nimport pandas as pd\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.feature_extraction.text import CountVectorizer\nfrom sklearn.svm import LinearSVC\nfrom sklearn.feature_extraction.text import TfidfTransformer\nfrom sklearn.multiclass import OneVsRestClassifier\nfrom sklearn import preprocessing","b22aa05d":"def save_csv(qid,label):\n    with open('submission.csv','a') as f:\n        f.write(qid+','+label)\n        f.write(\"\\n\")\n    f.close()\n    \nwith open('submission.csv','a') as f:\n    f.write('qid,prediction')\n    f.write(\"\\n\")\nf.close()","b12588c9":"# Train data\ndf = pd.read_csv('..\/input\/train.csv')\ndf.isnull().any()\nX_train = df.question_text\ny_train = df.target.astype(str)\nlb = preprocessing.MultiLabelBinarizer()\ny_train = lb.fit_transform(y_train)\n\n# Test data\ndf_test = pd.read_csv('..\/input\/test.csv')","491b4603":"classifier = Pipeline([\n    ('vectorizer', CountVectorizer(max_df=0.5, ngram_range=(1, 2))),\n    ('tfidf', TfidfTransformer()),\n    ('clf', OneVsRestClassifier(LinearSVC()))])\nclassifier.fit(X_train, y_train)","35c338bc":"for f, b in zip(df_test.qid, df_test.question_text):\n    X_test = np.array([b])\n    predicted = classifier.predict(X_test)    \n    count = 0\n    label = None\n    \n    for i in predicted[0]:\n        if i == 1:\n            label = count\n        count += 1\n\n    save_csv(str(f),str(label))","7e1fc700":"**Notebook Objective:**\n\nA simple approach using sciki-learn to solve the problem. Not the winner position on the Leaderboard, but certanly faster than most other Kernels on this competition, and not so far behind (LB: 0.61 \/ Runtime: 739s)."}}