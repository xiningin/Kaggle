{"cell_type":{"75a4601b":"code","e59fb82b":"code","bc079daf":"code","8ea8e85f":"code","55ce5237":"code","b7c15969":"code","5dfd60d7":"code","470342d7":"code","5e79fa11":"code","a8947a28":"code","3b1562de":"code","21e4c072":"code","0ce704d4":"code","7f168cf1":"code","82fcc82b":"code","bcb71300":"code","ab1554fe":"code","2aca31e2":"code","7dcc1289":"code","e1e0b8fb":"markdown","bd63397d":"markdown","9659bb95":"markdown","45cae98e":"markdown"},"source":{"75a4601b":"\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport tensorflow as tf\nfrom tensorflow import keras\nfrom tensorflow.keras.preprocessing.image import ImageDataGenerator\nfrom tensorflow.keras import Sequential, layers, losses\n\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","e59fb82b":"train_data = pd.read_csv(\"..\/input\/digit-recognizer\/train.csv\")\ntest_data = pd.read_csv(\"..\/input\/digit-recognizer\/test.csv\")\nprint(train_data.shape)\nprint(test_data.shape)\ntrain_data.head()","bc079daf":"X = train_data.drop(['label'], axis = 1).values\nY = train_data['label'].values","8ea8e85f":"plt.imshow(X[0].reshape([28,28]))","55ce5237":"X = X.reshape([42000,28,28,1])\nY = Y.reshape([42000,1])","b7c15969":"#one hot encoding\nfrom keras.utils.np_utils import to_categorical\nY = to_categorical(Y, num_classes = 10)","5dfd60d7":"from sklearn.model_selection import train_test_split\nx_train, x_test, y_train, y_test = train_test_split(X, Y, test_size = 0.1, random_state = 14)","470342d7":"x_train = x_train\/255\nx_test = x_test\/255","5e79fa11":"plt.imshow(x_train[0])","a8947a28":"model = Sequential()\nmodel.add(layers.Flatten(input_shape=(28,28)))\nmodel.add(layers.Dense(128, activation='relu'))\nmodel.add(layers.Dense(64, activation='relu'))\nmodel.add(layers.Dense(32, activation='relu'))\nmodel.add(layers.Dense(10, activation='softmax'))","3b1562de":"model.summary()","21e4c072":"model.compile(optimizer='adam', loss = 'categorical_crossentropy',\n              metrics=['accuracy']\n             )","0ce704d4":"model.fit(x_train, y_train, epochs=50)","7f168cf1":"model.evaluate(x_test,y_test)","82fcc82b":"data = test_data.values\ndata = data.reshape([28000, 28, 28, 1])\ndata = data\/255\nprint(data.shape)","bcb71300":"test_pred = model.predict(data)\ntest_pred = np.argmax(test_pred, axis=1)\ntest_pred","ab1554fe":"sample_submission = pd.read_csv(\"..\/input\/digit-recognizer\/sample_submission.csv\")\nsample_submission","2aca31e2":"index = sample_submission.ImageId\ndata = {'ImageId' : index,'Label': test_pred}\ndf = pd.DataFrame(data)\ndf.head","7dcc1289":"df.to_csv('submission2.csv', index=False)","e1e0b8fb":"## Reading the data","bd63397d":"## visualizing examples","9659bb95":"## Reshapping and splitting","45cae98e":"## Network architecture"}}