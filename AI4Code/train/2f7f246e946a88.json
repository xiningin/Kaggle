{"cell_type":{"ac29655c":"code","b86d7da6":"code","7936d779":"code","a9537e31":"code","bd84372b":"code","7087bdb5":"code","41a3661b":"code","8821c20d":"code","42a1ba1a":"markdown","ef91c43c":"markdown","1f92cd05":"markdown","ac7d1802":"markdown"},"source":{"ac29655c":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\nimport os\n","b86d7da6":"!git clone --recurse-submodules https:\/\/github.com\/mikel-brostrom\/Yolov5_DeepSort_Pytorch.git","7936d779":"!cd Yolov5_DeepSort_Pytorch && pip install -r requirements.txt","a9537e31":"!cp ..\/input\/nfl-train-yolo-single-class\/yolov5\/weights\/best.pt Yolov5_DeepSort_Pytorch\/.","bd84372b":"!cd Yolov5_DeepSort_Pytorch && python3 track.py --source ..\/..\/input\/nfl-health-and-safety-helmet-assignment\/test\/58102_002798_Sideline.mp4 --yolo_weights best.pt --img 640  --save-vid","7087bdb5":"from IPython.core.display import display, HTML\ndisplay(HTML('<blockquote class=\"imgur-embed-pub\" lang=\"en\" data-id=\"ywtmLsF\"><a href=\"https:\/\/imgur.com\/ywtmLsF\">View post on imgur.com<\/a><\/blockquote><script async src=\"\/\/s.imgur.com\/min\/embed.js\" charset=\"utf-8\"><\/script>'))","41a3661b":"!cp Yolov5_DeepSort_Pytorch\/inference\/output\/58102_002798_Sideline.mp4 .","8821c20d":"!rm -rf Yolov5_DeepSort_Pytorch","42a1ba1a":"# NFL helmet with Yolov5-deepsort starter\n\nIn this competition NFL ask Kaggler to develop a solution for tracking identity of player helmet in order to have better understanding of player collision during the game. For machine learning, it's a problem named as \"Multi-Object Tracking\" or MOT in short which ultilize object detection and tracking detection box across frames. Paper with Codes leaderboard for SOTA method: https:\/\/paperswithcode.com\/task\/multi-object-tracking\n\nThe below code use Deepsort: https:\/\/arxiv.org\/abs\/1703.07402 which is a old but simple algothrim to try extracting detection box and link player identity.","ef91c43c":"What's makes multi-objec tracking a difficult problem? From the above video it can already see clearly that some helmets are not tracked consistently throughout the video. Besides from false positive\/false negative problem from traditional object detection there are also other issues. \n\n![](https:\/\/i.imgur.com\/7IBr47d.png)\n![](https:\/\/i.imgur.com\/DyUtK4y.png)\n\nFor example in the above two image the identity of two players switch after they are close together. \n\n![](https:\/\/i.imgur.com\/7QzHM6q.png)\n![](https:\/\/i.imgur.com\/1RHItha.png)\n\nAlso, sometimes the model use duplicated id to indicates the same object.\n\nTherefore usually in multiple-object tracking paper there are multiple criteria to judge the model's performance\n\n![TransMOT: Spatial-Temporal Graph Transformer for Multiple Object Tracking](https:\/\/i.imgur.com\/tPMqbpv.png)\n![Real-Time Multiple Object Tracking A Study on the Importance of Speed](https:\/\/i.imgur.com\/jG5wRTE.png)\n\nHope this notebook would be useful!","1f92cd05":"Yolov5 helmet detection weight from https:\/\/www.kaggle.com\/tarobxl\/nfl-train-yolo-single-class","ac7d1802":"Let see the output:"}}