{"cell_type":{"fb94d4a9":"code","8d5bb879":"code","823d7b88":"code","fa25cad4":"code","2bec876f":"code","ca432495":"code","a0aafe1c":"code","f6dafbb1":"code","cdf449db":"markdown","9f70eec2":"markdown"},"source":{"fb94d4a9":"import sys\n!cp ..\/input\/rapids\/rapids.0.18.0 \/opt\/conda\/envs\/rapids.tar.gz\n!cd \/opt\/conda\/envs\/ && tar -xzvf rapids.tar.gz > \/dev\/null\nsys.path = [\"\/opt\/conda\/envs\/rapids\/lib\/python3.7\/site-packages\"] + sys.path\nsys.path = [\"\/opt\/conda\/envs\/rapids\/lib\/python3.7\"] + sys.path\nsys.path = [\"\/opt\/conda\/envs\/rapids\/lib\"] + sys.path \n!cp \/opt\/conda\/envs\/rapids\/lib\/libxgboost.so \/opt\/conda\/lib\/","8d5bb879":"import cugraph","823d7b88":"import cupy as cp\nimport cuml, cudf\nfrom sklearn.model_selection import train_test_split \n\nfrom cuml.metrics import mean_squared_error\nfrom tqdm.notebook import tqdm","fa25cad4":"WRSCResults = cudf.read_csv('..\/input\/ncaaw-march-mania-2021\/WDataFiles_Stage2\/WRegularSeasonCompactResults.csv')\nWTeams = cudf.read_csv('..\/input\/ncaaw-march-mania-2021\/WDataFiles_Stage2\/WTeams.csv')\nWRSCResults.head()","2bec876f":"WTeams.head()","ca432495":"WRSCResults_2021 = WRSCResults[WRSCResults['Season'] == 2021]\nWRSCResults_2021.head()","a0aafe1c":"G1 = cugraph.Graph()\nG1.from_cudf_edgelist(WRSCResults_2021, source='LTeamID', destination='WTeamID')","f6dafbb1":"pr1 = cugraph.pagerank(G1, alpha = 0.85, max_iter = 500, tol = 1.0e-05)\npr1.columns = ['pagerank', 'TeamID']\npr1 = pr1.merge(WTeams)\npr1 = pr1.sort_values(by='pagerank',  ascending=False).reset_index(drop=True)\npr1.head(10)","cdf449db":"This is a simlpe cuGraph example of calculating \"Page Rank\" for NCAAW basketball teams based on the wins and losses in a single season. We treat two teams as having a \"link\" between them if they've played a game against each other, with the \"link\" proceeding from the losing team to the winning team.\n\nI've used cuGraph to calculate Page Rank not becasue I need a lot of speed - we are dealing here with a very small dataset. But primarily becasue I am familiar with it, and it's part of Rapids library, whcih I am all too eager to promote. ;) Unfortunately, cuGraph is still not available in Kaggle Docker, so I have to install it from skrach here from Chris Deotte's dataset.","9f70eec2":"We see that some of the top teams are all relatively unknown, and not really otherwise that highly ranked. In other words, this measure doesn't seem to have a lot of \"face validity\". This was not a very strong signal, but when I looked at my feature importances it usually ranked in the top 10."}}