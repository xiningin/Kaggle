{"cell_type":{"25355265":"code","a41d0465":"code","233594db":"code","76ef3ea0":"code","6b4878f9":"code","2bf76dcf":"code","1d2da13d":"code","4b006bff":"code","7341a75f":"code","9838e4e3":"code","aeaeb567":"code","55aec325":"markdown","1eea6d06":"markdown","871bf5ab":"markdown","f85754b2":"markdown","72f44ff3":"markdown","bcfb47dd":"markdown","96e85b16":"markdown","1185314f":"markdown","c9c7bfe9":"markdown","d2d6c277":"markdown","ce61faee":"markdown","cd4550f2":"markdown"},"source":{"25355265":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nfrom scipy.stats import weibull_min\nfrom statistics import median","a41d0465":"n = 10 # number of cities\nside = 100 # cities will be uniformly distributed over a sidexside square\n\nX = side*np.random.random((n,2))","233594db":"plt.scatter(X[:,0], X[:,1])\nplt.show()","76ef3ea0":"def distance(u, v):\n    return np.linalg.norm(X[u]-X[v])\n\ndef cost(s):\n    return sum(distance(s[u], s[(u+1)%n]) for u in range(n))","6b4878f9":"def random_solution():\n    s = np.array(range(n))\n    np.random.shuffle(s)\n    return s","2bf76dcf":"def minimum(m):\n    return min(cost(random_solution()) for i in range(m))","1d2da13d":"def minima(k, m):\n    return sorted([minimum(m) for i in range(k)])","4b006bff":"k = 1000 # number of samples\nm = 100 # sample size\nz = minima(k, m)\n\nplt.figure(figsize=(10,8))\nplt.hist(z)\nplt.show()","7341a75f":"ln = np.log\n\ndef estimates(a):\n    b = z[np.int(np.floor(0.63*k))+1]-a\n    c = ln(-ln(0.5))\/(ln(median(z)-a)-ln(b))\n    linf = z[0]-b\n    lsup = z[0]\n    return {'loc':a, 'scale':b, 'shape':c, 'linf':linf, 'lsup':lsup}\n\n# Golden and Alt, 1979\ngolden = estimates(2*z[0]-z[1])\n\n# Zanakis (1979)\nzanakis = estimates((z[0]*z[-1]-z[1]**2)\/(z[0]+z[-1]-2*z[1]))\n\n# Cooke 1979.\ncooke = estimates(2*z[0]-(np.e-1)*(sum(np.exp(-(i+1))*z[i] for i in range(k))))\n\n# Scipy Maximum Likelihood Estimate (MLE)\ncMLE, aMLE, bMLE = weibull_min.fit(z, cooke['shape'], loc=cooke['loc'], scale=cooke['scale'])\nMLE = {'loc':aMLE, 'scale':bMLE, 'shape':cMLE, 'linf':z[0]-bMLE, 'lsup':z[0]}\n\ndf = pd.DataFrame([golden, zanakis, cooke, MLE], \n                  index = ['Goden and Alt (1979)', 'Zanakis (1979)', 'Cooke (1979)', 'MLE'])\ndf","9838e4e3":"ls = np.linspace(0.9*z[0], 1.1*z[-1], 100)\n\nplt.figure(figsize=(10,8))\nplt.plot(ls, weibull_min(c=cooke['shape'], loc=cooke['loc'], scale=cooke['scale']).pdf(ls), '-b', label = 'Cooke (1979)')\nplt.plot(ls, weibull_min(c=MLE['shape'], loc=MLE['loc'], scale=MLE['scale']).pdf(ls), '-r', label = 'MLE')\nplt.hist(z, density=True, alpha=0.2)\nplt.legend(loc=\"upper left\")\nplt.show()","aeaeb567":"def enumeration(n):\n    i = 0\n    s = [-1]*n\n    visited = [False]*n\n    \n    while i >= 0:\n        if not s[i] == -1:\n            visited[s[i]] = False\n        s[i] += 1\n        while s[i] < n and visited[s[i]]:\n            s[i] += 1\n        \n        if s[i] == n:\n            s[i] = -1\n            i -= 1\n        else:\n            visited[s[i]] = True\n            \n            if i < n-1:\n                i += 1\n            else:\n                yield cost(s)\n                \nopt = min(enumeration(n))\nprint(f'Optimal solution: {opt}')","55aec325":"Functions for the Euclidean distance between two vertices and cost of a solution:","1eea6d06":"Function for obtaining the best solutions of $k$ samples of $m$ solutions each:","871bf5ab":"Plot the points:","f85754b2":"Function for obtaining the best solution from a sample of $m$ random solutions:","72f44ff3":"## Estimating the Weibull Distribution Parameters\n\nA point estimate for the optimal value $a$ given by Golden and Alt (1979) is $\\tilde{a} = 2z_1 - z_2$. An estimate given by Zanakis (1979) is $\\hat{a} = \\frac{z_1z_n-z_2^2}{z_1+z_n-2z_2}$. Cooke (1979) proposes $a^* = 2z_1-(e-1)\\sum_{i=1}^{k}\\frac{z_i}{e^i}$.\n\nAccording to Zanakis and Evans (1981) the order of accuracy is $a^*$, $\\hat{a}$, $\\tilde{a}$.\n\nA $1-e^{-k}$% confidence interval for $a$ was proposed by Golden and Alt (1979): $[z_1-\\tilde{b}, z_1]$, where $\\tilde{b} = z_{\\lfloor 0.63k \\rfloor+1} - \\overline{a}$; $\\overline{a}$ can be $\\tilde{a}, \\hat{a}, a^*$.\n\nGolden and Alt (1979) also give an estimate for $c$, $\\tilde{c} = \\frac{\\ln(-\\ln(0.5))}{\\ln(z_M-\\overline{a})-\\ln{\\overline{b}}}$, where $z_M$ is the median of $z_1, \\ldots, z_k$.\n\nIn fact, Golden and Alt (1979) recommend using Maximum Likelihood Estimation (MLE) to refine $\\overline{a}$, $\\tilde{b}$, $\\tilde{c}$. According to Zanakis and Evans (1981), this is not justifiable.","bcfb47dd":"# Using Random Samples to Estimate Optimal Solutions of Combinatorial Optimization Problems","96e85b16":"Lets obtain the optimal solution by enumeration (only for very small $n$):","1185314f":"Let $S$ be a sample of size $m$ from a probability distribution bounded below by $a$, let $z$ be the minimum value in the sample. As $m$ increases, the distribution of $z$ approaches a *Weibull distribution* having $a$ as its location parameter (displacement) (Golden and Alt, 1979; Rardin and Uzsoy, 2001).\n\nThe CDF of the Weibull distribution is $F_x(x_0) = prob\\{x \\leq x_0\\} = 1 - e^{-(\\frac{x_0-a}{b})^c}$, where $a$ is the location parameter, $b$ is the scale parameter, and $c$ the shape parameter.\n\nBy considering $k$ samples and their corresponding minimum values $z_1, \\ldots, z_k$, we can try to estimate the parameters of the Weibull distribution. We will assume $z_1, \\ldots, z_k$ are in non-decreasing order.\n\nWe can use this result to estimate the value of the optimal solution of a combinatorial optimization problem.\n\nBy taking a problem instance as a probability distribution, the best solution in a sample $m$ random solutions for the instance should approach a Weibull distribution. By considering $k$ samples, we can estimate the distribution parameters, in particular, $a$ is an estimate of the optimal solution value.","c9c7bfe9":"## An example - The Traveling Salesman Problem\nSample $n$ points on a 2D plane:","d2d6c277":"## References\n\nP. Cooke. Statistical Inference for Bounds of Random Variables. Biometrika. 1979.\n\nB. L. Golden and F. B. Alt. Interval Estimation of a Global Optimum for Large Combinatorial Problems. Naval Research Logistics Quarterly. 1979.\n\nR. L. Rardin and R. Uzsoy. Experimental Evaluation of Heuristic Optimization Algorithms: A Tutorial. Journal of Heuristics. 2001.\n\nS. H. Zanakis. A Simulation Study of Some Simple Estimators for the Three-parameter Weibull Distribution. Journal of Statistical Computation and Simulation. 1979.\n\nS. H. Zanakis and J. R. Evans. Heuristic \"Optimization\": Why, When, and How to Use It. Interfaces. 1981.","ce61faee":"Function for generating a random solution:","cd4550f2":"Lets plot a histogram of $z_1, \\ldots, z_k$"}}