{"cell_type":{"e916d266":"code","cfdd3f1e":"code","96102b17":"code","9998d7c6":"code","e4b7929e":"code","02ef32cd":"code","978b5238":"code","3c9fc696":"markdown","30e1f11a":"markdown","d22a4438":"markdown","cd9571c1":"markdown"},"source":{"e916d266":"import glob\nimport joblib\nimport pickle\nimport pydicom\nimport pandas as pd\nfrom tqdm.notebook import tqdm","cfdd3f1e":"dicom_files = glob.glob('..\/input\/rsna-str-pulmonary-embolism-detection\/train\/*\/*\/*')\nprint( len(dicom_files) )\nprint( dicom_files[0] )","96102b17":"def read_meta(fn):\n    dc = pydicom.dcmread(fn, stop_before_pixels=True )\n    RES = {}\n    for i in list(dc.keys()):\n        RES[dc[i].description()] = dc[i].value\n    return RES\n\n#Read 1% of train files\nRES = joblib.Parallel(n_jobs=2)(joblib.delayed(read_meta)(fn) for fn in tqdm(dicom_files[:int(0.01*len(dicom_files))]))","9998d7c6":"print(len(RES))\nprint(RES[0])","e4b7929e":"df = pd.DataFrame(RES)\ndf.sample(10).head(10)","02ef32cd":"df.sample(10).head(10)","978b5238":"df.to_pickle('train-metadata.pkl')","3c9fc696":"# Transform in a Pandas DataFrame for better visualization","30e1f11a":"# Metadata is read using a dict","d22a4438":"# Write to file","cd9571c1":"# Search for all .dicom files available for train set"}}