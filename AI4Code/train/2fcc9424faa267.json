{"cell_type":{"02245502":"code","22c74997":"code","8628e96c":"code","17427a2a":"code","a2770139":"code","7c24a6a5":"code","2c7e7adc":"code","06b59977":"code","c405b22b":"code","28c40aef":"code","9899affb":"code","1c176035":"code","98eccd1d":"code","5c834d18":"code","40e12a38":"code","bbd3e4ef":"code","bce2c9e5":"code","b2eb4e03":"code","edb40933":"code","0abf2d05":"code","9280f55f":"code","ed4d1638":"code","2b9c3825":"code","a263ff41":"code","4dfaa51e":"code","f28bb999":"code","03a08fff":"code","b058f26a":"code","9e3eaa4c":"code","3b2a92e6":"code","a589ad6c":"code","295de28d":"code","1423c46f":"code","0181c23d":"code","8482f614":"code","22d2df00":"code","54aa2a3b":"code","f5cbe0cb":"code","b9cf74b7":"code","d26527b0":"code","deea6732":"markdown"},"source":{"02245502":"import pandas as pd\nwater= pd.read_csv(\"..\/input\/nyc-beach-water-quality-data\/dohmh-beach-water-quality-data-1.csv\")\nwater.head(9)","22c74997":"water['Sample Location'].value_counts()","8628e96c":"water['Sample Location']= water['Sample Location'].replace('Rigth','Right')\nround(water['Sample Location']. value_counts()*100\/len(water),2)","17427a2a":"water.nunique()","a2770139":"water.info()","7c24a6a5":"water['Sample Date']=pd.to_datetime(water['Sample Date'])\nwater.info()","2c7e7adc":"water.isnull().sum()*100\/len(water)","06b59977":"missing=water[water.isna().any(axis=1)]\nmissing.head()","c405b22b":"missing.isnull().sum()*100\/len(missing)","28c40aef":"missing.nunique()","9899affb":"missing['Units or Notes'].value_counts()*100\/len(missing)","1c176035":"water[water['Units or Notes']=='Result below detection limit'].head()","98eccd1d":"water[water['Units or Notes']=='Result below detection limit'].info()","5c834d18":"water[water['Units or Notes']!='Result below detection limit'].head()","40e12a38":"water[water['Units or Notes']!='Result below detection limit'].info()","bbd3e4ef":"water['Enterococci Results']=water['Enterococci Results'].fillna(0)\nwater.isnull().sum()*100\/len(missing)","bce2c9e5":"water=water.dropna()\nwater.info()","b2eb4e03":"water.nunique()","edb40933":"water.head()","0abf2d05":"water=water.drop(['Units or Notes'],axis=1)\nwater.head()","9280f55f":"#paper : https:\/\/www.environment.nsw.gov.au\/-\/media\/OEH\/Corporate-Site\/Documents\/Water\/Beaches\/state-of-beaches-2019-2020-statewide-summary-200302.pdf\nwater.loc[water['Enterococci Results'] <= 50, 'Category'] = 'open'\nwater.loc[water['Enterococci Results'] >500, 'Category'] = 'closed'\nwater.loc[(water['Enterococci Results'] >50) & (water['Enterococci Results'] <=500), 'Category'] = 'advisory'\nround(water['Category'].value_counts()*100\/len(water))","ed4d1638":"water.rename(columns = {'Enterococci Results':'Enterococci Results (MPN\/100 ml)'}, inplace = True)\nwater.head()","2b9c3825":"!pip install pandas-profiling","a263ff41":"from pandas_profiling import ProfileReport\nProfileReport(water, title=\"EDA Report\")","4dfaa51e":"!pip install pycaret","f28bb999":"data = water.sample(frac=0.8, random_state=42)\ndata_unseen = water.drop(data.index)\ndata.reset_index(inplace=True, drop=True)\ndata_unseen.reset_index(inplace=True, drop=True)\nprint('Data for Modeling: ' + str(data.shape))","03a08fff":"print('Unseen Data For Predictions: ' + str(data_unseen.shape))","b058f26a":"from pycaret.classification import *","9e3eaa4c":"water= setup(data = data, target = 'Category', session_id=42,\n                  normalize = True, \n                  transformation = True, \n                  log_experiment = True,\n                  handle_unknown_categorical = True, \n                  unknown_categorical_method = 'most_frequent',\n                  remove_multicollinearity = True, #drop one of the two features that are highly correlated with each other\n                  ignore_low_variance = True,#all categorical features with statistically insignificant variances are removed from the dataset.\n                  combine_rare_levels = True,# all levels in categorical features below the threshold defined in rare_level_threshold param are combined together as a single level\n                  numeric_imputation='median',\n           ignore_features=['Sample ID'],\n            date_features=['Sample Date'],\n             high_cardinality_features =['Beach Name'],           \n           fix_imbalance = True,\n            train_size = 0.8\n          )","3b2a92e6":"dt = create_model('dt')","a589ad6c":"print(dt)","295de28d":"tuned_dt = tune_model(dt,optimize = 'AUC')","1423c46f":"plot_model(tuned_dt, plot = 'auc')","0181c23d":"plot_model(tuned_dt, plot = 'pr')","8482f614":"plot_model(tuned_dt, plot='feature')","22d2df00":"plot_model(tuned_dt, plot = 'confusion_matrix')","54aa2a3b":"evaluate_model(tuned_dt)","f5cbe0cb":"predict_model(tuned_dt)","b9cf74b7":"unseen_predictions = predict_model(tuned_dt, data=data_unseen)\nunseen_predictions.head()","d26527b0":"print(\"Confidence Score :   {}\".format(round(unseen_predictions.Score.mean(),2)))#Confidence Score","deea6732":"# Sample Location"}}