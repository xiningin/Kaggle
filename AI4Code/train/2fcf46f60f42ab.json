{"cell_type":{"c8df4840":"code","c889f1d2":"code","3a0b6ddb":"code","7215f52e":"code","65a9cb3f":"code","78bb6117":"code","d5da4503":"code","99448661":"code","6f7993a0":"code","913459d5":"code","8e99581c":"code","6ae2e3f1":"code","4ecc0470":"code","725c52f5":"code","784c20a5":"code","cfbfa70b":"code","b98e23e4":"code","dd25b338":"code","0bf48055":"code","17d03436":"code","bc284aa0":"code","b4ef3f92":"code","63d65891":"code","8974a6c4":"code","7dccdab1":"code","bfc75c1f":"code","c636acea":"code","8b57f53b":"code","b1041a54":"code","82c7cbb7":"code","446d3546":"code","5a569c23":"code","80c3db26":"code","38d1bced":"code","0ef14e82":"code","b732ef76":"code","1406cee3":"code","a1eac1df":"code","0bbebb85":"code","2f050300":"code","c358f765":"code","3bae5865":"code","5ece5ca4":"code","5b94b964":"code","60e14b9c":"code","97eebdd1":"code","68940d53":"code","725c8db9":"code","839b6bd1":"code","80cd2142":"code","70894707":"code","bbce8d94":"code","c67dff49":"code","aadbdd39":"code","a035812d":"code","6a224de1":"code","9093d947":"code","1a4dd445":"code","c77548aa":"code","013f01f9":"code","0adccbaf":"code","efa5e212":"code","70370b87":"code","60375e53":"code","8b7186de":"code","62f646d5":"code","3f017261":"code","2d276009":"code","ecc3e205":"code","a1296b90":"code","5ddd38e2":"code","b6c2bf88":"code","a58143d9":"code","47df2617":"code","bc14ec16":"code","13b86516":"code","555e21b4":"code","317671d5":"code","2e30573c":"code","7bfd43f6":"code","96e14456":"code","9110fb65":"code","25491cb7":"code","ab76eaeb":"code","1d8dc923":"code","81cf8932":"code","ab92164b":"code","7f294788":"code","f6aff2ac":"code","cd9c8a31":"code","e1e57044":"code","bc2a8f63":"code","5bcf2e83":"code","a8e0dbae":"code","f4d97670":"code","b005269d":"code","78e7e23b":"code","e80acb24":"code","c1b96688":"code","5a9f7e03":"code","d6c533d0":"code","b5e8f8af":"code","83d0ea1b":"code","7e4b8f37":"code","e10783f5":"code","67b741ad":"code","f3176212":"markdown","a117f17e":"markdown","b7c4d362":"markdown","998e2b6e":"markdown","3610f3a4":"markdown","393e8f16":"markdown","5ff7bb53":"markdown","5ea97358":"markdown","41b536c0":"markdown","bd8ef41f":"markdown","96bfb35c":"markdown","ef98dce3":"markdown","38de72d9":"markdown","0b7bc6bc":"markdown","22119e65":"markdown","d3fe75b7":"markdown","088f53d8":"markdown","04c25343":"markdown","a44d3078":"markdown","b346a311":"markdown","5c9fe094":"markdown","91e61d2c":"markdown","2b977ab0":"markdown","da33c8ff":"markdown","d482aee9":"markdown","a6e6bbf4":"markdown","c126fae8":"markdown","b464081d":"markdown","1a33ba59":"markdown","9234bb57":"markdown","97bddeaa":"markdown","6ab01f9f":"markdown","a75a3a33":"markdown","7a65d181":"markdown","b8667dbc":"markdown"},"source":{"c8df4840":"#GENERAL\nimport pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport matplotlib as mpl\nimport random\nimport time\n#PATH PROCESS\nimport os\nimport os.path\nfrom pathlib import Path\nimport glob\nfrom scipy.io import loadmat\nimport nibabel as nib\nimport csv\n#IMAGE PROCESS\nfrom PIL import Image\nfrom keras.preprocessing import image\nfrom tensorflow.keras.preprocessing.image import ImageDataGenerator\nimport cv2\nfrom keras.applications.vgg16 import preprocess_input, decode_predictions\nfrom keras.preprocessing import image\nfrom skimage.feature import hessian_matrix, hessian_matrix_eigvals\nfrom scipy.ndimage.filters import convolve\nfrom skimage import data, io, filters\nimport skimage\nfrom skimage.morphology import convex_hull_image, erosion\nfrom IPython import display\nfrom scipy.ndimage import gaussian_filter\nfrom mpl_toolkits.mplot3d.art3d import Poly3DCollection\nimport matplotlib.patches as patches\n#SCALER & TRANSFORMATION\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.preprocessing import MinMaxScaler\nfrom keras.utils.np_utils import to_categorical\nfrom sklearn.model_selection import train_test_split\nfrom keras import regularizers\nfrom sklearn.preprocessing import LabelEncoder\n#ACCURACY CONTROL\nfrom sklearn.metrics import confusion_matrix, accuracy_score, classification_report, roc_auc_score, roc_curve\nfrom sklearn.model_selection import GridSearchCV, cross_val_score\nfrom sklearn.metrics import mean_squared_error, r2_score\n#OPTIMIZER\nfrom keras.optimizers import RMSprop,Adam,Optimizer,Optimizer, SGD\n#MODEL LAYERS\nfrom tensorflow.keras.models import Sequential\nfrom keras.layers import Dense, Dropout, Flatten, Conv2D, MaxPool2D, BatchNormalization,MaxPooling2D,BatchNormalization,\\\n                        Permute, TimeDistributed, Bidirectional,GRU, SimpleRNN,\\\nLSTM, GlobalAveragePooling2D, SeparableConv2D, ZeroPadding2D, Convolution2D, ZeroPadding2D,Reshape, Conv2DTranspose,\\\nLeakyReLU, GaussianNoise, GlobalMaxPooling2D, ReLU, Input, Concatenate\nfrom keras import models\nfrom keras import layers\nimport tensorflow as tf\nfrom keras.applications import VGG16,VGG19,inception_v3\nfrom keras import backend as K\nfrom keras.utils import plot_model\nfrom keras.datasets import mnist\nimport keras\nfrom keras.models import Model\n#IGNORING WARNINGS\nfrom warnings import filterwarnings\nfilterwarnings(\"ignore\",category=DeprecationWarning)\nfilterwarnings(\"ignore\", category=FutureWarning) \nfilterwarnings(\"ignore\", category=UserWarning)","c889f1d2":"Main_Path = Path(\"..\/input\/sdobenchmark\/SDOBenchmark_example\/training\")","3a0b6ddb":"Main_Train_CSV = list(Main_Path.glob(r\"**\/*.csv\"))","7215f52e":"print(len(Main_Train_CSV))","65a9cb3f":"Train_CSV = Main_Train_CSV[0]","78bb6117":"print(Train_CSV)","d5da4503":"Reading_CSV = pd.read_csv(Train_CSV)","99448661":"print(Reading_CSV.columns)","6f7993a0":"print(len(Reading_CSV))","913459d5":"print(Reading_CSV.head(-1))","8e99581c":"print(Reading_CSV.isnull().sum())","6ae2e3f1":"print(Reading_CSV[\"peak_flux\"][0])","4ecc0470":"print(int(Reading_CSV[\"peak_flux\"][0]))","725c52f5":"print(int(Reading_CSV[\"peak_flux\"][414]))","784c20a5":"print(Reading_CSV[\"start\"][414])","cfbfa70b":"print(Reading_CSV[\"start\"][414][0:10])","b98e23e4":"print(type(Reading_CSV[\"start\"][414][0:10]))","dd25b338":"Testing_Date_Transformation = Reading_CSV[\"start\"][414][0:10].replace(\"-\",\"\")","0bf48055":"print(Testing_Date_Transformation)","17d03436":"Testing_Date_Array = np.array(int(Testing_Date_Transformation))","bc284aa0":"print(type(Testing_Date_Array))","b4ef3f92":"JPG_Path = list(Main_Path.glob(r\"**\/*.jpg\"))","63d65891":"Sorted_JPG_Path = sorted(JPG_Path)","8974a6c4":"Reading_CSV[\"New_ID\"] = Sorted_JPG_Path[40:457]","7dccdab1":"print(Reading_CSV.head(-1))","bfc75c1f":"print(Reading_CSV[\"New_ID\"][0])\nprint(\"---\"*10)\nprint(Reading_CSV[\"id\"][0])","c636acea":"New_Start = []\nNew_End = []\nNew_Path = []\n\nfor x_start,x_end,x_path in zip(Reading_CSV.start.values,Reading_CSV.end.values,Reading_CSV.New_ID.values):\n    \n    x_start = x_start[0:10]\n    x_start = x_start.replace(\"-\",\"\")\n    x_start = np.array(x_start,dtype=\"float32\")\n    \n    x_end = x_end[0:10]\n    x_end = x_end.replace(\"-\",\"\")\n    x_end = np.array(x_end,dtype=\"float32\")\n    \n    New_Start.append(x_start)\n    New_End.append(x_end)\n    New_Path.append(x_path)\n    ","8b57f53b":"print(\"LEN START: \",len(New_Start))\nprint(\"LEN END: \",len(New_End))\nprint(\"LEN PATH: \",len(New_Path))","b1041a54":"print(New_Start[0])\nprint(\"--\"*10)\nprint(New_End[0])\nprint(\"--\"*10)\nprint(New_Path[0])","82c7cbb7":"print(type(New_Start[0]))\nprint(\"--\"*10)\nprint(type(New_End[0]))\nprint(\"--\"*10)\nprint(type(New_Path[0]))","446d3546":"Start_Series = pd.Series(New_Start,name=\"START\").astype(np.float32)\nEnd_Series = pd.Series(New_End,name=\"END\").astype(np.float32)\nPath_Series = pd.Series(New_Path,name=\"PATH\").astype(str)","5a569c23":"Main_Data = pd.concat([Path_Series,Start_Series,End_Series],axis=1)","80c3db26":"print(Main_Data.head(-1))","38d1bced":"Example_IMG = cv2.cvtColor(cv2.imread(Main_Data[\"PATH\"][33]),cv2.COLOR_BGR2RGB)\n\nfigure = plt.figure(figsize=(10,10))\n\nplt.xlabel(Example_IMG.shape)\nplt.ylabel(Example_IMG.size)\nplt.imshow(Example_IMG)","0ef14e82":"figure,axis = plt.subplots(5,5,figsize=(10,10))\n\nfor indexing,operations in enumerate(axis.flat):\n    \n    Reading_IMG = cv2.cvtColor(cv2.imread(Main_Data[\"PATH\"][indexing]),cv2.COLOR_BGR2RGB)\n    \n    operations.set_xlabel(Reading_IMG.shape)\n    operations.set_ylabel(Reading_IMG.size)\n    operations.imshow(Reading_IMG)\n\nplt.tight_layout()\nplt.show()","b732ef76":"Example_IMG = cv2.cvtColor(cv2.imread(Main_Data[\"PATH\"][13]),cv2.COLOR_BGR2RGB)\n\nfigure = plt.figure(figsize=(10,10))\n\nplt.xlabel(Example_IMG[:,:,0].shape)\nplt.ylabel(Example_IMG[:,:,0].size)\nplt.imshow(Example_IMG[:,:,0])","1406cee3":"Example_IMG = cv2.cvtColor(cv2.imread(Main_Data[\"PATH\"][13]),cv2.COLOR_BGR2RGB)\n_,Threshold_IMG = cv2.threshold(Example_IMG,200,255,cv2.THRESH_BINARY)\n\nfigure = plt.figure(figsize=(10,10))\n\nplt.xlabel(Threshold_IMG.shape)\nplt.ylabel(Threshold_IMG.size)\nplt.imshow(Threshold_IMG)","a1eac1df":"figure,axis = plt.subplots(1,2,figsize=(10,10))\n\nExample_IMG = cv2.cvtColor(cv2.imread(Main_Data[\"PATH\"][13]),cv2.COLOR_BGR2RGB)\n_,Threshold_IMG = cv2.threshold(Example_IMG,200,255,cv2.THRESH_BINARY)\n\naxis[0].imshow(Example_IMG)\naxis[0].axis(\"off\")\naxis[1].imshow(Threshold_IMG)\naxis[1].axis(\"off\")","0bbebb85":"figure,axis = plt.subplots(1,2,figsize=(10,10))\n\nExample_IMG = cv2.cvtColor(cv2.imread(Main_Data[\"PATH\"][23]),cv2.COLOR_BGR2RGB)\n_,Threshold_IMG = cv2.threshold(Example_IMG,200,255,cv2.THRESH_BINARY)\n\naxis[0].imshow(Example_IMG)\naxis[0].axis(\"off\")\naxis[1].imshow(Threshold_IMG)\naxis[1].axis(\"off\")","2f050300":"figure,axis = plt.subplots(1,2,figsize=(10,10))\n\nExample_IMG = cv2.cvtColor(cv2.imread(Main_Data[\"PATH\"][2]),cv2.COLOR_BGR2RGB)\n_,Threshold_IMG = cv2.threshold(Example_IMG,200,255,cv2.THRESH_BINARY)\n\naxis[0].imshow(Example_IMG)\naxis[0].axis(\"off\")\naxis[1].imshow(Threshold_IMG)\naxis[1].axis(\"off\")","c358f765":"figure,axis = plt.subplots(1,2,figsize=(10,10))\n\nExample_IMG = cv2.cvtColor(cv2.imread(Main_Data[\"PATH\"][404]),cv2.COLOR_BGR2RGB)\n_,Threshold_IMG = cv2.threshold(Example_IMG,200,255,cv2.THRESH_BINARY)\n\naxis[0].imshow(Example_IMG)\naxis[0].axis(\"off\")\naxis[1].imshow(Threshold_IMG)\naxis[1].axis(\"off\")","3bae5865":"figure,axis = plt.subplots(1,3,figsize=(10,10))\n\nExample_IMG = cv2.cvtColor(cv2.imread(Main_Data[\"PATH\"][404]),cv2.COLOR_BGR2GRAY)\nHessian_IMG = hessian_matrix(Example_IMG,sigma=0.20,order=\"rc\")\nMax_IMG,Min_IMG = hessian_matrix_eigvals(Hessian_IMG)\n\naxis[0].imshow(Example_IMG)\naxis[0].axis(\"off\")\naxis[1].imshow(Max_IMG)\naxis[1].axis(\"off\")\naxis[2].imshow(Min_IMG)\naxis[2].axis(\"off\")","5ece5ca4":"figure,axis = plt.subplots(1,3,figsize=(10,10))\n\nExample_IMG = cv2.cvtColor(cv2.imread(Main_Data[\"PATH\"][44]),cv2.COLOR_BGR2GRAY)\nHessian_IMG = hessian_matrix(Example_IMG,sigma=0.20,order=\"rc\")\nMax_IMG,Min_IMG = hessian_matrix_eigvals(Hessian_IMG)\n\naxis[0].imshow(Example_IMG)\naxis[0].axis(\"off\")\naxis[1].imshow(Max_IMG)\naxis[1].axis(\"off\")\naxis[2].imshow(Min_IMG)\naxis[2].axis(\"off\")","5b94b964":"figure,axis = plt.subplots(1,3,figsize=(10,10))\n\nExample_IMG = cv2.cvtColor(cv2.imread(Main_Data[\"PATH\"][55]),cv2.COLOR_BGR2GRAY)\nHessian_IMG = hessian_matrix(Example_IMG,sigma=0.20,order=\"rc\")\nMax_IMG,Min_IMG = hessian_matrix_eigvals(Hessian_IMG)\n\naxis[0].imshow(Example_IMG)\naxis[0].axis(\"off\")\naxis[1].imshow(Max_IMG)\naxis[1].axis(\"off\")\naxis[2].imshow(Min_IMG)\naxis[2].axis(\"off\")","60e14b9c":"figure,axis = plt.subplots(1,3,figsize=(10,10))\n\nExample_IMG = cv2.cvtColor(cv2.imread(Main_Data[\"PATH\"][55]),cv2.COLOR_BGR2RGB)\n_,Threshold_IMG = cv2.threshold(Example_IMG,200,255,cv2.THRESH_BINARY)\nCanny_IMG = cv2.Canny(Threshold_IMG,10,100)\n\n\naxis[0].imshow(Example_IMG)\naxis[0].axis(\"off\")\naxis[1].imshow(Threshold_IMG)\naxis[1].axis(\"off\")\naxis[2].imshow(Canny_IMG)\naxis[2].axis(\"off\")","97eebdd1":"figure,axis = plt.subplots(1,3,figsize=(10,10))\n\nExample_IMG = cv2.cvtColor(cv2.imread(Main_Data[\"PATH\"][333]),cv2.COLOR_BGR2RGB)\n_,Threshold_IMG = cv2.threshold(Example_IMG,200,255,cv2.THRESH_BINARY)\nCanny_IMG = cv2.Canny(Threshold_IMG,10,100)\n\n\naxis[0].imshow(Example_IMG)\naxis[0].axis(\"off\")\naxis[1].imshow(Threshold_IMG)\naxis[1].axis(\"off\")\naxis[2].imshow(Canny_IMG)\naxis[2].axis(\"off\")","68940d53":"figure,axis = plt.subplots(1,3,figsize=(15,15))\n\nExample_IMG = cv2.cvtColor(cv2.imread(Main_Data[\"PATH\"][333]),cv2.COLOR_BGR2RGB)\n_,Threshold_IMG = cv2.threshold(Example_IMG,200,255,cv2.THRESH_BINARY)\nCanny_IMG = cv2.Canny(Threshold_IMG,10,100)\nConcat_IMG = cv2.addWeighted(Example_IMG[:,:,0],0.8,Canny_IMG,0.4,0.5)\n\naxis[0].imshow(Example_IMG)\naxis[0].axis(\"off\")\naxis[1].imshow(Canny_IMG)\naxis[1].axis(\"off\")\naxis[2].imshow(Concat_IMG)\naxis[2].axis(\"off\")","725c8db9":"figure,axis = plt.subplots(1,3,figsize=(15,15))\n\nExample_IMG = cv2.cvtColor(cv2.imread(Main_Data[\"PATH\"][13]),cv2.COLOR_BGR2RGB)\n_,Threshold_IMG = cv2.threshold(Example_IMG,200,255,cv2.THRESH_BINARY)\nCanny_IMG = cv2.Canny(Threshold_IMG,10,100)\nConcat_IMG = cv2.addWeighted(Example_IMG[:,:,0],0.8,Canny_IMG,0.4,0.5)\n\naxis[0].imshow(Example_IMG)\naxis[0].axis(\"off\")\naxis[1].imshow(Canny_IMG)\naxis[1].axis(\"off\")\naxis[2].imshow(Concat_IMG)\naxis[2].axis(\"off\")","839b6bd1":"figure,axis = plt.subplots(1,3,figsize=(15,15))\n\nExample_IMG = cv2.cvtColor(cv2.imread(Main_Data[\"PATH\"][13]),cv2.COLOR_BGR2RGB)\n_,Threshold_IMG = cv2.threshold(Example_IMG,200,255,cv2.THRESH_BINARY)\nCanny_IMG = cv2.Canny(Threshold_IMG,10,100)\nConcat_IMG = cv2.addWeighted(Example_IMG[:,:,0],0.8,Canny_IMG,0.4,0.5)\ncontours,_ = cv2.findContours(Canny_IMG,cv2.RETR_EXTERNAL,cv2.CHAIN_APPROX_SIMPLE)\n\nfor contour in contours:\n    x,y,w,h = cv2.boundingRect(contour)\n    Rect_IMG = cv2.rectangle(Concat_IMG,(x,y),(x+w,y+h),(255,0,0),2)\n    \naxis[0].imshow(Example_IMG)\naxis[0].axis(\"off\")\naxis[1].imshow(Concat_IMG,cmap=\"hot\")\naxis[1].axis(\"off\")\naxis[2].imshow(Threshold_IMG)\naxis[2].axis(\"off\")","80cd2142":"figure,axis = plt.subplots(1,3,figsize=(15,15))\n\nExample_IMG = cv2.cvtColor(cv2.imread(Main_Data[\"PATH\"][113]),cv2.COLOR_BGR2RGB)\n_,Threshold_IMG = cv2.threshold(Example_IMG,200,255,cv2.THRESH_BINARY)\nCanny_IMG = cv2.Canny(Threshold_IMG,10,100)\nConcat_IMG = cv2.addWeighted(Example_IMG[:,:,0],0.8,Canny_IMG,0.4,0.5)\ncontours,_ = cv2.findContours(Canny_IMG,cv2.RETR_EXTERNAL,cv2.CHAIN_APPROX_SIMPLE)\n\nfor contour in contours:\n    x,y,w,h = cv2.boundingRect(contour)\n    Rect_IMG = cv2.rectangle(Concat_IMG,(x,y),(x+w,y+h),(255,0,0),2)\n    \naxis[0].imshow(Example_IMG)\naxis[0].axis(\"off\")\naxis[1].imshow(Concat_IMG,cmap=\"hot\")\naxis[1].axis(\"off\")\naxis[2].imshow(Threshold_IMG)\naxis[2].axis(\"off\")","70894707":"figure,axis = plt.subplots(1,3,figsize=(15,15))\n\nExample_IMG = cv2.cvtColor(cv2.imread(Main_Data[\"PATH\"][188]),cv2.COLOR_BGR2RGB)\n_,Threshold_IMG = cv2.threshold(Example_IMG,200,255,cv2.THRESH_BINARY)\nCanny_IMG = cv2.Canny(Threshold_IMG,10,100)\nConcat_IMG = cv2.addWeighted(Example_IMG[:,:,0],0.8,Canny_IMG,0.4,0.5)\ncontours,_ = cv2.findContours(Canny_IMG,cv2.RETR_EXTERNAL,cv2.CHAIN_APPROX_SIMPLE)\n\nfor contour in contours:\n    x,y,w,h = cv2.boundingRect(contour)\n    Rect_IMG = cv2.rectangle(Concat_IMG,(x,y),(x+w,y+h),(255,0,0),2)\n    \naxis[0].imshow(Example_IMG)\naxis[0].axis(\"off\")\naxis[1].imshow(Concat_IMG,cmap=\"hot\")\naxis[1].axis(\"off\")\naxis[2].imshow(Threshold_IMG)\naxis[2].axis(\"off\")","bbce8d94":"figure,axis = plt.subplots(1,3,figsize=(15,15))\n\nExample_IMG = cv2.cvtColor(cv2.imread(Main_Data[\"PATH\"][13]),cv2.COLOR_BGR2RGB)\n_,Threshold_IMG = cv2.threshold(Example_IMG,200,255,cv2.THRESH_BINARY)\nCanny_IMG = cv2.Canny(Threshold_IMG,10,100)\n\nCopy_Main = Example_IMG.copy()\nCopy_Main[Canny_IMG == 1] = [0,255,0]\nCopy_Main[Canny_IMG == 2] = [0,0,255]\nCopy_Main_Two = Example_IMG.copy()\n\nConcat_IMG = cv2.addWeighted(Copy_Main,0.5,Copy_Main_Two,0.7,0,Copy_Main_Two)\n\naxis[0].imshow(Example_IMG)\naxis[0].axis(\"off\")\naxis[1].imshow(Canny_IMG)\naxis[1].axis(\"off\")\naxis[2].imshow(Concat_IMG)\naxis[2].axis(\"off\")","c67dff49":"figure,axis = plt.subplots(1,3,figsize=(15,15))\n\nExample_IMG = cv2.cvtColor(cv2.imread(Main_Data[\"PATH\"][13]),cv2.COLOR_BGR2RGB)\n_,Threshold_IMG = cv2.threshold(Example_IMG,200,255,cv2.THRESH_BINARY)\nCanny_IMG = cv2.Canny(Threshold_IMG,10,100)\n\nCopy_Main = Example_IMG.copy()\nCopy_Main[Canny_IMG == 255] = [255,0,0]\n\naxis[0].imshow(Example_IMG)\naxis[0].axis(\"off\")\naxis[1].imshow(Canny_IMG)\naxis[1].axis(\"off\")\naxis[2].imshow(Copy_Main)\naxis[2].axis(\"off\")","aadbdd39":"figure,axis = plt.subplots(1,3,figsize=(15,15))\n\nExample_IMG = cv2.cvtColor(cv2.imread(Main_Data[\"PATH\"][123]),cv2.COLOR_BGR2RGB)\n_,Threshold_IMG = cv2.threshold(Example_IMG,200,255,cv2.THRESH_BINARY)\nCanny_IMG = cv2.Canny(Threshold_IMG,10,100)\n\nCopy_Main = Example_IMG.copy()\nCopy_Main[Canny_IMG == 255] = [255,0,0]\n\naxis[0].imshow(Example_IMG)\naxis[0].axis(\"off\")\naxis[1].imshow(Canny_IMG)\naxis[1].axis(\"off\")\naxis[2].imshow(Copy_Main)\naxis[2].axis(\"off\")","a035812d":"figure,axis = plt.subplots(1,3,figsize=(15,15))\n\nExample_IMG = cv2.cvtColor(cv2.imread(Main_Data[\"PATH\"][223]),cv2.COLOR_BGR2RGB)\n_,Threshold_IMG = cv2.threshold(Example_IMG,200,255,cv2.THRESH_BINARY)\nCanny_IMG = cv2.Canny(Threshold_IMG,10,100)\n\nCopy_Main = Example_IMG.copy()\nCopy_Main[Threshold_IMG[:,:,0] == 255] = [255,0,0]\n\naxis[0].imshow(Example_IMG)\naxis[0].axis(\"off\")\naxis[1].imshow(Threshold_IMG)\naxis[1].axis(\"off\")\naxis[2].imshow(Copy_Main)\naxis[2].axis(\"off\")","6a224de1":"figure,axis = plt.subplots(1,3,figsize=(15,15))\n\nExample_IMG = cv2.cvtColor(cv2.imread(Main_Data[\"PATH\"][1]),cv2.COLOR_BGR2RGB)\n_,Threshold_IMG = cv2.threshold(Example_IMG,200,255,cv2.THRESH_BINARY)\nCanny_IMG = cv2.Canny(Threshold_IMG,10,100)\n\nCopy_Main = Example_IMG.copy()\nCopy_Main[Threshold_IMG[:,:,0] == 255] = [255,0,0]\n\naxis[0].imshow(Example_IMG)\naxis[0].axis(\"off\")\naxis[1].imshow(Threshold_IMG)\naxis[1].axis(\"off\")\naxis[2].imshow(Copy_Main)\naxis[2].axis(\"off\")","9093d947":"figure,axis = plt.subplots(1,3,figsize=(15,15))\n\nExample_IMG = cv2.cvtColor(cv2.imread(Main_Data[\"PATH\"][17]),cv2.COLOR_BGR2RGB)\n_,Threshold_IMG = cv2.threshold(Example_IMG,200,255,cv2.THRESH_BINARY)\nCanny_IMG = cv2.Canny(Threshold_IMG,10,100)\n\nCopy_Main = Example_IMG.copy()\nCopy_Main[Threshold_IMG[:,:,0] == 255] = [255,0,0]\n\naxis[0].imshow(Example_IMG)\naxis[0].axis(\"off\")\naxis[1].imshow(Threshold_IMG)\naxis[1].axis(\"off\")\naxis[2].imshow(Copy_Main)\naxis[2].axis(\"off\")","1a4dd445":"X_Start = []\nX_End = []\nX_Image = []\n\nfor img,start_i,end_i in zip(Main_Data.PATH.values,Main_Data.START.values,Main_Data.END.values):\n    Picking_IMG = cv2.cvtColor(cv2.imread(img),cv2.COLOR_BGR2RGB)\n    Picking_IMG = cv2.resize(Picking_IMG,(180,180))\n    Picking_IMG = Picking_IMG \/ 255.\n    \n    X_Image.append(Picking_IMG)\n    X_Start.append(start_i)\n    X_End.append(end_i)","c77548aa":"print(np.shape(np.array(X_Image)))\nprint(np.shape(np.array(X_Start)))\nprint(np.shape(np.array(X_End)))","013f01f9":"Train_JPG = np.array(X_Image,dtype=\"float32\")\nTrain_START = np.array(X_Start,dtype=\"float32\")\nTrain_END = np.array(X_End,dtype=\"float32\")","0adccbaf":"print(Train_JPG.shape)\nprint(Train_START.shape)\nprint(Train_END.shape)","efa5e212":"Scalar_Function = MinMaxScaler()\n\nTrain_START_R = Scalar_Function.fit_transform(Train_START.reshape(-1,1))\nTrain_END_R = Scalar_Function.fit_transform(Train_END.reshape(-1,1))","70370b87":"X_Mask = []\nX_New_IMG = []\n\nfor img_i in Main_Data.PATH.values:\n    Picking_IMG = cv2.cvtColor(cv2.imread(img_i),cv2.COLOR_BGR2RGB)\n    _,Threshold_IMG = cv2.threshold(Picking_IMG,200,255,cv2.THRESH_BINARY)\n    Canny_IMG = cv2.Canny(Threshold_IMG,10,100)\n\n    Copy_Main = Picking_IMG.copy()\n    Copy_Main[Canny_IMG == 255] = [255,0,0]\n    \n    Copy_Main = cv2.resize(Copy_Main,(180,180))\n    Copy_Main = Copy_Main \/ 255.\n    \n    Picking_IMG = cv2.resize(Picking_IMG,(180,180))\n    Picking_IMG = Picking_IMG \/ 255.\n    \n    X_Mask.append(Copy_Main)\n    X_New_IMG.append(Picking_IMG)","60375e53":"X_Mask = np.array(X_Mask,dtype=\"float32\")\nX_New_IMG = np.array(X_New_IMG,dtype=\"float32\")","8b7186de":"print(X_New_IMG.shape)\nprint(X_Mask.shape)","62f646d5":"figure,axis = plt.subplots(1,2,figsize=(15,15))\n\naxis[0].imshow(X_New_IMG[0])\naxis[0].axis(\"off\")\naxis[1].imshow(X_Mask[0])\naxis[1].axis(\"off\")","3f017261":"figure,axis = plt.subplots(1,2,figsize=(15,15))\n\naxis[0].imshow(X_New_IMG[100])\naxis[0].axis(\"off\")\naxis[1].imshow(X_Mask[100])\naxis[1].axis(\"off\")","2d276009":"figure,axis = plt.subplots(1,2,figsize=(15,15))\n\naxis[0].imshow(X_New_IMG[200])\naxis[0].axis(\"off\")\naxis[1].imshow(X_Mask[200])\naxis[1].axis(\"off\")","ecc3e205":"figure,axis = plt.subplots(1,2,figsize=(15,15))\n\naxis[0].imshow(X_New_IMG[231])\naxis[0].axis(\"off\")\naxis[1].imshow(X_Mask[231])\naxis[1].axis(\"off\")","a1296b90":"Early_Stopper = tf.keras.callbacks.EarlyStopping(monitor=\"loss\",patience=3,mode=\"min\")\nCheckpoint_Model = tf.keras.callbacks.ModelCheckpoint(monitor=\"val_accuracy\",\n                                                      save_best_only=True,\n                                                      save_weights_only=True,\n                                                      filepath=\".\/modelcheck\")\nReduce_Model = tf.keras.callbacks.ReduceLROnPlateau(monitor=\"val_accuracy\",\n                                                   factor=0.1,\n                                                   patience=5)","5ddd38e2":"compile_loss = \"binary_crossentropy\"\ncompile_optimizer = Adam(lr=0.0000001)\noutput_class = 1","b6c2bf88":"E_AE = Sequential()\n#\nE_AE.add(Conv2D(32,(5,5),kernel_initializer = 'he_normal',use_bias = True, padding=\"valid\"))\nE_AE.add(BatchNormalization())\nE_AE.add(ReLU())\n#\nE_AE.add(Conv2D(64,(5,5),kernel_initializer = 'he_normal',use_bias = True, padding=\"valid\"))\nE_AE.add(BatchNormalization())\nE_AE.add(ReLU())\n#\nE_AE.add(Conv2D(128,(5,5),kernel_initializer = 'he_normal',use_bias = True, padding=\"valid\"))\nE_AE.add(BatchNormalization())\nE_AE.add(ReLU())\n#\nE_AE.add(Conv2D(256,(5,5),kernel_initializer = 'he_normal',use_bias = True, padding=\"valid\"))\nE_AE.add(BatchNormalization())\nE_AE.add(ReLU())\n\n\n\n\nD_AE = Sequential()\n#\nD_AE.add(Conv2DTranspose(128,(5,5), padding=\"valid\"))\nD_AE.add(ReLU())\n#\nD_AE.add(Conv2DTranspose(64,(5,5), padding=\"valid\"))\nD_AE.add(ReLU())\n#\nD_AE.add(Conv2DTranspose(32,(5,5), padding=\"valid\"))\nD_AE.add(ReLU())\n#\nD_AE.add(Conv2DTranspose(output_class,(5,5), padding=\"valid\"))\nD_AE.add(ReLU())","a58143d9":"Auto_Encoder = Sequential([E_AE,D_AE])\nAuto_Encoder.compile(loss=compile_loss,optimizer=compile_optimizer,metrics=[\"mse\"])","47df2617":"Model_AutoEncoder = Auto_Encoder.fit(X_New_IMG,X_Mask,epochs=55,callbacks=[Checkpoint_Model])","bc14ec16":"plt.style.use(\"dark_background\")","13b86516":"Prediction_MASK_Seen = Auto_Encoder.predict(X_New_IMG[:20])","555e21b4":"figure,axis = plt.subplots(1,2,figsize=(15,15))\npre_img_number = 1\n\nOriginal_Img = X_New_IMG[pre_img_number]\nPredict_Mask = Prediction_MASK_Seen[pre_img_number]\n\naxis[0].imshow(Original_Img)\naxis[0].set_xlabel(Original_Img.shape)\naxis[0].set_ylabel(Original_Img.size)\naxis[0].set_title(\"IMAGE\")\naxis[0].axis(\"off\")\naxis[1].imshow(Predict_Mask)\naxis[1].set_xlabel(Predict_Mask.shape)\naxis[1].set_ylabel(Predict_Mask.size)\naxis[1].set_title(\"PREDICTION\")\naxis[1].axis(\"off\")","317671d5":"figure,axis = plt.subplots(1,2,figsize=(15,15))\npre_img_number = 2\n\nOriginal_Img = X_New_IMG[pre_img_number]\nPredict_Mask = Prediction_MASK_Seen[pre_img_number]\n\naxis[0].imshow(Original_Img)\naxis[0].set_xlabel(Original_Img.shape)\naxis[0].set_ylabel(Original_Img.size)\naxis[0].set_title(\"IMAGE\")\naxis[0].axis(\"off\")\naxis[1].imshow(Predict_Mask)\naxis[1].set_xlabel(Predict_Mask.shape)\naxis[1].set_ylabel(Predict_Mask.size)\naxis[1].set_title(\"PREDICTION\")\naxis[1].axis(\"off\")","2e30573c":"figure,axis = plt.subplots(1,2,figsize=(15,15))\npre_img_number = 3\n\nOriginal_Img = X_New_IMG[pre_img_number]\nPredict_Mask = Prediction_MASK_Seen[pre_img_number]\n\naxis[0].imshow(Original_Img)\naxis[0].set_xlabel(Original_Img.shape)\naxis[0].set_ylabel(Original_Img.size)\naxis[0].set_title(\"IMAGE\")\naxis[0].axis(\"off\")\naxis[1].imshow(Predict_Mask)\naxis[1].set_xlabel(Predict_Mask.shape)\naxis[1].set_ylabel(Predict_Mask.size)\naxis[1].set_title(\"PREDICTION\")\naxis[1].axis(\"off\")","7bfd43f6":"figure,axis = plt.subplots(1,2,figsize=(15,15))\npre_img_number = 4\n\nOriginal_Img = X_New_IMG[pre_img_number]\nPredict_Mask = Prediction_MASK_Seen[pre_img_number]\n\naxis[0].imshow(Original_Img)\naxis[0].set_xlabel(Original_Img.shape)\naxis[0].set_ylabel(Original_Img.size)\naxis[0].set_title(\"IMAGE\")\naxis[0].axis(\"off\")\naxis[1].imshow(Predict_Mask)\naxis[1].set_xlabel(Predict_Mask.shape)\naxis[1].set_ylabel(Predict_Mask.size)\naxis[1].set_title(\"PREDICTION\")\naxis[1].axis(\"off\")","96e14456":"figure,axis = plt.subplots(1,2,figsize=(15,15))\npre_img_number = 5\n\nOriginal_Img = X_New_IMG[pre_img_number]\nPredict_Mask = Prediction_MASK_Seen[pre_img_number]\n\naxis[0].imshow(Original_Img)\naxis[0].set_xlabel(Original_Img.shape)\naxis[0].set_ylabel(Original_Img.size)\naxis[0].set_title(\"IMAGE\")\naxis[0].axis(\"off\")\naxis[1].imshow(Predict_Mask)\naxis[1].set_xlabel(Predict_Mask.shape)\naxis[1].set_ylabel(Predict_Mask.size)\naxis[1].set_title(\"PREDICTION\")\naxis[1].axis(\"off\")","9110fb65":"figure,axis = plt.subplots(1,2,figsize=(15,15))\npre_img_number = 6\n\nOriginal_Img = X_New_IMG[pre_img_number]\nPredict_Mask = Prediction_MASK_Seen[pre_img_number]\n\naxis[0].imshow(Original_Img)\naxis[0].set_xlabel(Original_Img.shape)\naxis[0].set_ylabel(Original_Img.size)\naxis[0].set_title(\"IMAGE\")\naxis[0].axis(\"off\")\naxis[1].imshow(Predict_Mask)\naxis[1].set_xlabel(Predict_Mask.shape)\naxis[1].set_ylabel(Predict_Mask.size)\naxis[1].set_title(\"PREDICTION\")\naxis[1].axis(\"off\")","25491cb7":"figure,axis = plt.subplots(1,2,figsize=(15,15))\npre_img_number = 7\n\nOriginal_Img = X_New_IMG[pre_img_number]\nPredict_Mask = Prediction_MASK_Seen[pre_img_number]\n\naxis[0].imshow(Original_Img)\naxis[0].set_xlabel(Original_Img.shape)\naxis[0].set_ylabel(Original_Img.size)\naxis[0].set_title(\"IMAGE\")\naxis[0].axis(\"off\")\naxis[1].imshow(Predict_Mask,cmap=\"hot\")\naxis[1].set_xlabel(Predict_Mask.shape)\naxis[1].set_ylabel(Predict_Mask.size)\naxis[1].set_title(\"PREDICTION\")\naxis[1].axis(\"off\")","ab76eaeb":"figure,axis = plt.subplots(1,2,figsize=(15,15))\npre_img_number = 8\n\nOriginal_Img = X_New_IMG[pre_img_number]\nPredict_Mask = Prediction_MASK_Seen[pre_img_number]\n\naxis[0].imshow(Original_Img)\naxis[0].set_xlabel(Original_Img.shape)\naxis[0].set_ylabel(Original_Img.size)\naxis[0].set_title(\"IMAGE\")\naxis[0].axis(\"off\")\naxis[1].imshow(Predict_Mask,cmap=\"hot\")\naxis[1].set_xlabel(Predict_Mask.shape)\naxis[1].set_ylabel(Predict_Mask.size)\naxis[1].set_title(\"PREDICTION\")\naxis[1].axis(\"off\")","1d8dc923":"figure,axis = plt.subplots(1,2,figsize=(15,15))\npre_img_number = 9\n\nOriginal_Img = X_New_IMG[pre_img_number]\nPredict_Mask = Prediction_MASK_Seen[pre_img_number]\n\naxis[0].imshow(Original_Img)\naxis[0].set_xlabel(Original_Img.shape)\naxis[0].set_ylabel(Original_Img.size)\naxis[0].set_title(\"IMAGE\")\naxis[0].axis(\"off\")\naxis[1].imshow(Predict_Mask,cmap=\"hot\")\naxis[1].set_xlabel(Predict_Mask.shape)\naxis[1].set_ylabel(Predict_Mask.size)\naxis[1].set_title(\"PREDICTION\")\naxis[1].axis(\"off\")","81cf8932":"figure,axis = plt.subplots(1,2,figsize=(15,15))\npre_img_number = 10\n\nOriginal_Img = X_New_IMG[pre_img_number]\nPredict_Mask = Prediction_MASK_Seen[pre_img_number]\n\naxis[0].imshow(Original_Img)\naxis[0].set_xlabel(Original_Img.shape)\naxis[0].set_ylabel(Original_Img.size)\naxis[0].set_title(\"IMAGE\")\naxis[0].axis(\"off\")\naxis[1].imshow(Predict_Mask,cmap=\"jet\")\naxis[1].set_xlabel(Predict_Mask.shape)\naxis[1].set_ylabel(Predict_Mask.size)\naxis[1].set_title(\"PREDICTION\")\naxis[1].axis(\"off\")","ab92164b":"figure,axis = plt.subplots(1,2,figsize=(15,15))\npre_img_number = 11\n\nOriginal_Img = X_New_IMG[pre_img_number]\nPredict_Mask = Prediction_MASK_Seen[pre_img_number]\n\naxis[0].imshow(Original_Img)\naxis[0].set_xlabel(Original_Img.shape)\naxis[0].set_ylabel(Original_Img.size)\naxis[0].set_title(\"IMAGE\")\naxis[0].axis(\"off\")\naxis[1].imshow(Predict_Mask,cmap=\"jet\")\naxis[1].set_xlabel(Predict_Mask.shape)\naxis[1].set_ylabel(Predict_Mask.size)\naxis[1].set_title(\"PREDICTION\")\naxis[1].axis(\"off\")","7f294788":"figure,axis = plt.subplots(1,2,figsize=(15,15))\npre_img_number = 12\n\nOriginal_Img = X_New_IMG[pre_img_number]\nPredict_Mask = Prediction_MASK_Seen[pre_img_number]\n\naxis[0].imshow(Original_Img)\naxis[0].set_xlabel(Original_Img.shape)\naxis[0].set_ylabel(Original_Img.size)\naxis[0].set_title(\"IMAGE\")\naxis[0].axis(\"off\")\naxis[1].imshow(Predict_Mask,cmap=\"jet\")\naxis[1].set_xlabel(Predict_Mask.shape)\naxis[1].set_ylabel(Predict_Mask.size)\naxis[1].set_title(\"PREDICTION\")\naxis[1].axis(\"off\")","f6aff2ac":"Reading_IMG = cv2.cvtColor(cv2.imread(\"..\/input\/sdobenchmark\/SDOBenchmark_example\/test\/11476\/2012_05_14_16_18_57_0\/2012-05-14T041857__335.jpg\"),cv2.COLOR_BGR2RGB)\nReading_IMG = cv2.resize(Reading_IMG,(180,180))","cd9c8a31":"Reading_IMG_Shape = Reading_IMG.reshape(1,Reading_IMG.shape[0],Reading_IMG.shape[1],Reading_IMG.shape[2])","e1e57044":"figure = plt.figure(figsize=(10,10))\n\nplt.imshow(Reading_IMG)","bc2a8f63":"MASK_Seen = Auto_Encoder.predict(Reading_IMG_Shape)","5bcf2e83":"figure,axis = plt.subplots(1,2,figsize=(14,14))\n\naxis[0].imshow(Reading_IMG)\naxis[0].set_xlabel(Reading_IMG.shape)\naxis[0].set_ylabel(Reading_IMG.size)\naxis[0].set_title(\"IMAGE\")\naxis[0].axis(\"off\")\naxis[1].imshow(MASK_Seen[0])\naxis[1].set_xlabel(MASK_Seen[0].shape)\naxis[1].set_ylabel(MASK_Seen[0].size)\naxis[1].set_title(\"PREDICTION\")\naxis[1].axis(\"off\")","a8e0dbae":"Reading_IMG = cv2.cvtColor(cv2.imread(\"..\/input\/sdobenchmark\/SDOBenchmark_example\/test\/11476\/2012_05_14_16_18_57_0\/2012-05-14T144857__magnetogram.jpg\"),cv2.COLOR_BGR2RGB)\nReading_IMG = cv2.resize(Reading_IMG,(180,180))\nReading_IMG_Shape = Reading_IMG.reshape(1,Reading_IMG.shape[0],Reading_IMG.shape[1],Reading_IMG.shape[2])\nMASK_Seen = Auto_Encoder.predict(Reading_IMG_Shape)\n\n\n\nfigure,axis = plt.subplots(1,2,figsize=(14,14))\n\naxis[0].imshow(Reading_IMG)\naxis[0].set_xlabel(Reading_IMG.shape)\naxis[0].set_ylabel(Reading_IMG.size)\naxis[0].set_title(\"IMAGE\")\naxis[0].axis(\"off\")\naxis[1].imshow(MASK_Seen[0])\naxis[1].set_xlabel(MASK_Seen[0].shape)\naxis[1].set_ylabel(MASK_Seen[0].size)\naxis[1].set_title(\"PREDICTION\")\naxis[1].axis(\"off\")","f4d97670":"Reading_IMG = cv2.cvtColor(cv2.imread(\"..\/input\/sdobenchmark\/SDOBenchmark_example\/test\/11476\/2012_05_14_16_18_57_0\/2012-05-14T160857__193.jpg\"),cv2.COLOR_BGR2RGB)\nReading_IMG = cv2.resize(Reading_IMG,(180,180))\nReading_IMG_Shape = Reading_IMG.reshape(1,Reading_IMG.shape[0],Reading_IMG.shape[1],Reading_IMG.shape[2])\nMASK_Seen = Auto_Encoder.predict(Reading_IMG_Shape)\n\n\n\nfigure,axis = plt.subplots(1,2,figsize=(14,14))\n\naxis[0].imshow(Reading_IMG)\naxis[0].set_xlabel(Reading_IMG.shape)\naxis[0].set_ylabel(Reading_IMG.size)\naxis[0].set_title(\"IMAGE\")\naxis[0].axis(\"off\")\naxis[1].imshow(MASK_Seen[0],cmap=\"hot\")\naxis[1].set_xlabel(MASK_Seen[0].shape)\naxis[1].set_ylabel(MASK_Seen[0].size)\naxis[1].set_title(\"PREDICTION\")\naxis[1].axis(\"off\")","b005269d":"Reading_IMG = cv2.cvtColor(cv2.imread(\"..\/input\/sdobenchmark\/SDOBenchmark_example\/test\/11476\/2012_05_14_16_18_57_0\/2012-05-14T111857__94.jpg\"),cv2.COLOR_BGR2RGB)\nReading_IMG = cv2.resize(Reading_IMG,(180,180))\nReading_IMG_Shape = Reading_IMG.reshape(1,Reading_IMG.shape[0],Reading_IMG.shape[1],Reading_IMG.shape[2])\nMASK_Seen = Auto_Encoder.predict(Reading_IMG_Shape)\n\n\n\nfigure,axis = plt.subplots(1,2,figsize=(14,14))\n\naxis[0].imshow(Reading_IMG)\naxis[0].set_xlabel(Reading_IMG.shape)\naxis[0].set_ylabel(Reading_IMG.size)\naxis[0].set_title(\"IMAGE\")\naxis[0].axis(\"off\")\naxis[1].imshow(MASK_Seen[0],cmap=\"hot\")\naxis[1].set_xlabel(MASK_Seen[0].shape)\naxis[1].set_ylabel(MASK_Seen[0].size)\naxis[1].set_title(\"PREDICTION\")\naxis[1].axis(\"off\")","78e7e23b":"Reading_IMG = cv2.cvtColor(cv2.imread(\"..\/input\/sdobenchmark\/SDOBenchmark_example\/test\/12033\/2014_04_10_12_00_00_0\/2014-04-10T000000__continuum.jpg\"),cv2.COLOR_BGR2RGB)\nReading_IMG = cv2.resize(Reading_IMG,(180,180))\nReading_IMG_Shape = Reading_IMG.reshape(1,Reading_IMG.shape[0],Reading_IMG.shape[1],Reading_IMG.shape[2])\nMASK_Seen = Auto_Encoder.predict(Reading_IMG_Shape)\n\n\n\nfigure,axis = plt.subplots(1,2,figsize=(14,14))\n\naxis[0].imshow(Reading_IMG)\naxis[0].set_xlabel(Reading_IMG.shape)\naxis[0].set_ylabel(Reading_IMG.size)\naxis[0].set_title(\"IMAGE\")\naxis[0].axis(\"off\")\naxis[1].imshow(MASK_Seen[0],cmap=\"gist_yarg\")\naxis[1].set_xlabel(MASK_Seen[0].shape)\naxis[1].set_ylabel(MASK_Seen[0].size)\naxis[1].set_title(\"PREDICTION\")\naxis[1].axis(\"off\")","e80acb24":"Reading_IMG = cv2.cvtColor(cv2.imread(\"..\/input\/sdobenchmark\/SDOBenchmark_example\/test\/12033\/2014_04_10_12_00_00_0\/2014-04-10T103000__magnetogram.jpg\"),cv2.COLOR_BGR2RGB)\nReading_IMG = cv2.resize(Reading_IMG,(180,180))\nReading_IMG_Shape = Reading_IMG.reshape(1,Reading_IMG.shape[0],Reading_IMG.shape[1],Reading_IMG.shape[2])\nMASK_Seen = Auto_Encoder.predict(Reading_IMG_Shape)\n\n\n\nfigure,axis = plt.subplots(1,2,figsize=(14,14))\n\naxis[0].imshow(Reading_IMG)\naxis[0].set_xlabel(Reading_IMG.shape)\naxis[0].set_ylabel(Reading_IMG.size)\naxis[0].set_title(\"IMAGE\")\naxis[0].axis(\"off\")\naxis[1].imshow(MASK_Seen[0],cmap=\"cubehelix\")\naxis[1].set_xlabel(MASK_Seen[0].shape)\naxis[1].set_ylabel(MASK_Seen[0].size)\naxis[1].set_title(\"PREDICTION\")\naxis[1].axis(\"off\")","c1b96688":"Reading_IMG = cv2.cvtColor(cv2.imread(\"..\/input\/sdobenchmark\/SDOBenchmark_example\/test\/12473\/2015_12_31_06_38_01_0\/2015-12-30T183801__335.jpg\"),cv2.COLOR_BGR2RGB)\nReading_IMG = cv2.resize(Reading_IMG,(180,180))\nReading_IMG_Shape = Reading_IMG.reshape(1,Reading_IMG.shape[0],Reading_IMG.shape[1],Reading_IMG.shape[2])\nMASK_Seen = Auto_Encoder.predict(Reading_IMG_Shape)\n\n\n\nfigure,axis = plt.subplots(1,2,figsize=(14,14))\n\naxis[0].imshow(Reading_IMG)\naxis[0].set_xlabel(Reading_IMG.shape)\naxis[0].set_ylabel(Reading_IMG.size)\naxis[0].set_title(\"IMAGE\")\naxis[0].axis(\"off\")\naxis[1].imshow(MASK_Seen[0],cmap=\"cubehelix\")\naxis[1].set_xlabel(MASK_Seen[0].shape)\naxis[1].set_ylabel(MASK_Seen[0].size)\naxis[1].set_title(\"PREDICTION\")\naxis[1].axis(\"off\")","5a9f7e03":"encoder = Sequential()\nencoder.add(Flatten(input_shape=[180,180,3]))\nencoder.add(Dense(300,activation=\"relu\"))\nencoder.add(Dense(200,activation=\"relu\"))\nencoder.add(Dense(100,activation=\"relu\"))\nencoder.add(Dense(50,activation=\"relu\"))\nencoder.add(Dense(25,activation=\"relu\"))\n\ndecoder = Sequential()\ndecoder.add(Dense(50,input_shape=[25],activation=\"relu\"))\ndecoder.add(Dense(100,activation=\"relu\"))\ndecoder.add(Dense(200,activation=\"relu\"))\ndecoder.add(Dense(300,activation=\"relu\"))\ndecoder.add(Dense(180*180*3,activation=\"sigmoid\"))\ndecoder.add(Reshape([180,180,3]))","d6c533d0":"AutoEncoder_II = Sequential([encoder,decoder])","b5e8f8af":"AutoEncoder_II.compile(loss=\"binary_crossentropy\",optimizer=\"rmsprop\",metrics=[\"mse\"])","83d0ea1b":"AutoEncoder_II.fit(X_New_IMG,X_New_IMG,epochs=40)","7e4b8f37":"PRE_Img = AutoEncoder_II.predict(X_New_IMG[:10])","e10783f5":"figure,axis = plt.subplots(1,2,figsize=(14,14))\npre_img_number = 1\n\nOriginal_Img = X_New_IMG[pre_img_number]\nPredict_Reduce = PRE_Img[pre_img_number]\n\naxis[0].imshow(Original_Img)\naxis[0].set_xlabel(Original_Img.shape)\naxis[0].set_ylabel(Original_Img.size)\naxis[0].set_title(\"IMAGE\")\naxis[0].axis(\"off\")\naxis[1].imshow(Predict_Reduce)\naxis[1].set_xlabel(Predict_Reduce.shape)\naxis[1].set_ylabel(Predict_Reduce.size)\naxis[1].set_title(\"PREDICTION\")\naxis[1].axis(\"off\")","67b741ad":"figure,axis = plt.subplots(1,2,figsize=(14,14))\npre_img_number = 2\n\nOriginal_Img = X_New_IMG[pre_img_number]\nPredict_Reduce = PRE_Img[pre_img_number]\n\naxis[0].imshow(Original_Img)\naxis[0].set_xlabel(Original_Img.shape)\naxis[0].set_ylabel(Original_Img.size)\naxis[0].set_title(\"IMAGE\")\naxis[0].axis(\"off\")\naxis[1].imshow(Predict_Reduce)\naxis[1].set_xlabel(Predict_Reduce.shape)\naxis[1].set_ylabel(Predict_Reduce.size)\naxis[1].set_title(\"PREDICTION\")\naxis[1].axis(\"off\")","f3176212":"#### 2D","a117f17e":"![](https:\/\/upload.wikimedia.org\/wikipedia\/commons\/thumb\/5\/5e\/Solar_Cycle_Prediction.gif\/400px-Solar_Cycle_Prediction.gif)","b7c4d362":"# HISTORY\n\n#### Context\n* Solar flares are intense bursts of radiation which can disrupt the power grids of a continent, shut down the GPS system or irradiate people exposed in space.\n* Developing systems for predicting solar flares would allow us to precisely aim our observation instruments at upcoming events, and eventually enable countermeasures against such worst-case scenarios.\n\n#### Acknowledgements\n* This dataset was created by Roman Bolzern and Michael Aerni from the Institute for Data Science, FHNW, Switzerland. We owe our thanks to the SDO satellite mission, and to JSOC Stanford for providing the raw data.\n\n#### Inspiration\n* The prediction of solar flares proves to be a challenging problem, some even compare it to weather forecasting. And regarding Machine Learning, we find this dataset to be particularly challenging because of the complexity of a single sample (up to 40 images), the relatively small size of samples (8'000 for training), and the fact that it is a regression problem. Yet Kagglers have proven time and time again that predictions can be made on the most complex of data. By providing this dataset, we hope to encourage Kaggle machine learners to push the envelope of solar flare predictions.","998e2b6e":"# AUTO ENCODER MODEL","3610f3a4":"#### STRUCTURE","393e8f16":"# AUTO ENCODER MODEL II","5ff7bb53":"# DATA TRANSFORMATION","5ea97358":"#### DATETIME TRANSFORMATION","41b536c0":"#### MAIN PATH","bd8ef41f":"#### PREDICTION","96bfb35c":"#### LAYER CONCAT","ef98dce3":"#### CSV PROCESS","38de72d9":"#### HESSIAN SPECTRUM","0b7bc6bc":"#### TRAINING","22119e65":"#### ENGINEERING","d3fe75b7":"#### STRUCTURE","088f53d8":"#### FOR PREDICTION","04c25343":"# OVERVIEW","a44d3078":"#### TO DATAFRAME","b346a311":"![](https:\/\/upload.wikimedia.org\/wikipedia\/commons\/thumb\/2\/28\/Sunspot_Numbers.png\/400px-Sunspot_Numbers.png)","5c9fe094":"#### CALLBACKS & PARAMETERS","91e61d2c":"# DATA PROCESS","2b977ab0":"#### FOR AUTO-ENCODER","da33c8ff":"#### THRESHOLD","d482aee9":"#### MULTI","a6e6bbf4":"#### CANNY-THRESHOLD CONCAT","c126fae8":"#### TEST SET PREDICTION","b464081d":"#### RANDOM TEST SET PREDICTION","1a33ba59":"# PACKAGES AND LIBRARIES","9234bb57":"#### TRAINING","97bddeaa":"#### SIMPLE","6ab01f9f":"#### PREDICTION","a75a3a33":"#### CONTOURS","7a65d181":"#### NEW DATA","b8667dbc":"# VISION"}}