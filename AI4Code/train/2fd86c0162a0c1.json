{"cell_type":{"2dc87ff9":"code","7e75de8b":"code","21d2112e":"code","59c4063f":"code","edec2c68":"code","9d8159ea":"code","51c9f683":"code","427295bb":"code","918355ad":"code","921418ed":"code","b609ce56":"code","a8ee6ef0":"code","328ef4d6":"code","258880fa":"code","cfe04de1":"code","c45777b9":"code","d646d008":"code","54a7d137":"code","8824bcb2":"code","16f83ff1":"code","c035ed07":"code","003729c8":"code","6657a7d3":"code","069617b4":"code","36dd5040":"code","a45d3d5c":"code","6c956720":"code","2be13d21":"code","b3082af7":"code","e4106f6b":"code","1c516c4f":"code","f444bc43":"code","6d1b401e":"code","7cde71c8":"code","67e0d314":"code","a368de35":"code","eb972e48":"code","1c83a8fd":"code","93f7364b":"code","fe129c54":"code","f7d2e4d7":"code","54f69a17":"code","ea4998c4":"code","9239b7cb":"code","5b14c7ff":"code","7ef85015":"code","d59d6b2d":"code","9de5ba93":"markdown","a10e7892":"markdown","f4791d72":"markdown","10e82c9f":"markdown","8493054a":"markdown","525e963d":"markdown","50feac3e":"markdown","b5521ce7":"markdown","378b5bf6":"markdown","852cfe42":"markdown","1cc6244b":"markdown","024fbdbe":"markdown","909d1a56":"markdown","bf85dbcc":"markdown","49e5f88b":"markdown","931502b2":"markdown","2084c5db":"markdown","dbf364f0":"markdown","bfe0c8b7":"markdown","089d5fcb":"markdown","b5a6f12d":"markdown","90705024":"markdown","683a02b1":"markdown","4574fa07":"markdown","fefee890":"markdown","c2ae70ea":"markdown","6aadbc2e":"markdown","090086fe":"markdown","55117f49":"markdown","a901b185":"markdown","e49009a6":"markdown","85dfc267":"markdown","e148fe80":"markdown","bad80489":"markdown","1e15c55d":"markdown","53289765":"markdown","ba57d363":"markdown","97479320":"markdown","172fcaa4":"markdown","0b312207":"markdown","0b0a42eb":"markdown","f77a0e7a":"markdown","5bc37ed7":"markdown","ac6b48f1":"markdown","3d000467":"markdown","67de076b":"markdown","b4cc4a82":"markdown","5396a54a":"markdown"},"source":{"2dc87ff9":"import numpy as np\nimport pandas as pd \nfrom pandas import Series,DataFrame\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.impute import SimpleImputer\n\nimport warnings\nwarnings.filterwarnings('ignore')\n\n%matplotlib inline","7e75de8b":"gender_submission = pd.read_csv(\"..\/input\/titanic\/gender_submission.csv\")\ntest = pd.read_csv(\"..\/input\/titanic\/test.csv\")\ntrain = pd.read_csv(\"..\/input\/titanic\/train.csv\")","21d2112e":"print('Test data shape: ', train.shape)\ntrain.head()","59c4063f":"train.describe()","edec2c68":"train.info()","9d8159ea":"train.isnull().sum()","51c9f683":"test.isnull().sum()","427295bb":"imputer = SimpleImputer(np.nan, \"mean\")\n\ntrain['Age'] = imputer.fit_transform(np.array(train['Age']).reshape(891, 1)) \ntrain.Embarked.fillna(method='ffill', inplace=True) \ntrain.drop(['PassengerId', 'Name','Ticket'], axis=1, inplace=True)\ntrain.head()","918355ad":"test['Age'] = imputer.fit_transform(np.array(test['Age']).reshape(418, 1))\ntest.Embarked.fillna(method='ffill', inplace=True)\ntest.Fare.fillna(method='ffill', inplace=True)\ntest.drop(['Name', 'Ticket'], axis=1, inplace=True)\ntest.head()","921418ed":"train['Survived'].value_counts()","b609ce56":"plt.figure(figsize=[10,5])\nsns.countplot(x = 'Sex', hue = 'Survived', data = train)\nplt.xticks(rotation = 20);","a8ee6ef0":"sns.barplot(x='Sex', y='Survived', data=train, palette=('RdPu'));","328ef4d6":"print('% of survived females:', train['Survived'][train['Sex'] == 'female'].value_counts(normalize = True)[1]*100)\nprint('% of survived males:', train['Survived'][train['Sex'] == 'male'].value_counts(normalize = True)[1]*100)","258880fa":"train[['Sex', 'Survived']].groupby(['Sex'], as_index=False).mean().sort_values(by='Survived', ascending=False)","cfe04de1":"fig, ax = plt.subplots(figsize = (10,6))\nax = sns.countplot(x = 'Survived', hue = 'Pclass', data = train, palette = 'YlOrRd')\nax.set_xlabel('Survived')\nax.set_title('Survival Rate for Passenger Classes', fontsize = 14, fontweight='bold');","c45777b9":"ax = sns.catplot(x=\"Pclass\", hue=\"Sex\", col=\"Survived\",\n                data=train, kind=\"count\",\n                height=4, aspect=.7, palette = 'OrRd');","d646d008":"sns.countplot(x = \"Pclass\", hue = \"Survived\", data = train, palette = 'RdPu');","54a7d137":"sns.barplot(x=\"Pclass\", y=\"Survived\", data= train, palette = 'BuGn');","8824bcb2":"perc = train[['Pclass', 'Survived']].groupby(['Pclass'], as_index=False).mean().sort_values(by='Survived', ascending=False)\nperc*100","16f83ff1":"sns.factorplot(x='Pclass', y='Survived', hue = 'Sex', data = train, palette = 'PRGn');","c035ed07":"sns.boxplot(x='Sex', y='Age', hue = 'Survived',data=train);","003729c8":"grid = sns.FacetGrid(train, col='Survived')\ngrid.map(plt.hist, 'Age', bins=25, color = 'y').add_legend();\nsns.set(style=\"ticks\", color_codes=True);","6657a7d3":"plt.figure(figsize=(10,5))\nsns.distplot(train['Age'], bins=24, color='g');","069617b4":"avg_age_train = train [\"Age\"].mean()\nstd_age_train = train [\"Age\"].std()\n\navg_age_test = test[\"Age\"].mean()\nstd_age_test = test [\"Age\"].std()","36dd5040":"bins = [0, 1, 12, 18, 21,  60, np.inf]\nlabels = ['Infant', 'Child', 'Teenager',' Young Adult', 'Adult', 'Senior']\ntrain['AgeGroup'] = pd.cut(train[\"Age\"], bins, labels = labels)\ntest['AgeGroup'] = pd.cut(test[\"Age\"], bins, labels = labels)\nsns.barplot(x=\"AgeGroup\", y=\"Survived\", data= train)\nplt.show;","a45d3d5c":"train.head()","6c956720":"train[['AgeGroup', 'Survived']].groupby(['AgeGroup'], as_index=False).mean().sort_values(by='Survived', ascending=False)","2be13d21":"AgeGroup_train  = pd.get_dummies(train['AgeGroup'])\nAgeGroup_train.columns = ['Infant', 'Child', 'Teenager',' Young Adult', 'Adult', 'Senior']\nAgeGroup_test  = pd.get_dummies(test['AgeGroup'])\nAgeGroup_test.columns = ['Infant', 'Child', 'Teenager',' Young Adult', 'Adult', 'Senior']\n\ntrain = train.join(AgeGroup_train)\ntest = test.join(AgeGroup_test)","b3082af7":"age_mapping = {'Infant': 1, 'Child': 2, 'Teenager': 3, 'Young Adult': 4, 'Adult': 5, 'Senior': 7}\ntrain['AgeGroup'] = train['AgeGroup'].map(age_mapping)\ntest['AgeGroup'] = test['AgeGroup'].map(age_mapping)\n\ntrain.head()\n","e4106f6b":"train.drop(['AgeGroup', 'Age'],axis=1,inplace=True)\ntest.drop(['AgeGroup', 'Age'],axis=1,inplace=True)\ntrain.head()","1c516c4f":"train[\"Cabin_new\"] = (train[\"Cabin\"].notnull().astype('int'))\ntest[\"Cabin_new\"] = (test[\"Cabin\"].notnull().astype('int'))\ntrain = train.drop(['Cabin'], axis = 1)\ntest = test.drop(['Cabin'], axis = 1)\n","f444bc43":"print(\"% of Cabin = 1 survived:\", train[\"Survived\"][train[\"Cabin_new\"] == 1].value_counts(normalize = True)[1]*100)\nprint(\"% of Cabin = 0 survived:\", train[\"Survived\"][train[\"Cabin_new\"] == 0].value_counts(normalize = True)[1]*100)\n\nsns.barplot(x=\"Cabin_new\", y=\"Survived\", data=train).set_title('Cabin vs No Cabin')\nplt.show()","6d1b401e":"train[[\"SibSp\", \"Survived\"]].groupby(['SibSp'], as_index=False).mean().sort_values(by='Survived', ascending=False)","7cde71c8":"train[[\"Parch\", \"Survived\"]].groupby(['Parch'], as_index=False).mean().sort_values(by='Survived', ascending=False)","67e0d314":"train['FamilySize'] = train['Parch'] + train['SibSp']\ntest['FamilySize'] = test['Parch'] + test['SibSp']\n#train.drop(['Parch', 'SibSp'], axis=1,inplace=True)\n#test.drop(['Parch', 'SibSp'], axis=1,inplace=True)\nsns.barplot(x=\"FamilySize\", y=\"Survived\", data=train)\nplt.show;","a368de35":"sns.pointplot(x='FamilySize', y = 'Survived', data = train);","eb972e48":"train[['Embarked', 'Survived']].groupby(['Embarked'], as_index=False).mean().sort_values(by='Survived', ascending=False)","1c83a8fd":"embark_perc = train[[\"Embarked\", \"Survived\"]].groupby(['Embarked'],as_index=False).mean()\nsns.barplot(x='Embarked', y='Survived', data=embark_perc,order=['S','C','Q']);","93f7364b":"sns.countplot(x='Embarked', hue='Survived', data=train);","fe129c54":"embark_dummies_train  = pd.get_dummies(train['Embarked'])\nembark_dummies_test  = pd.get_dummies(test['Embarked'])\n\ntrain = train.join(embark_dummies_train)\ntest = test.join(embark_dummies_test)\ntrain.head()","f7d2e4d7":"train = train.drop(['Embarked'], axis = 1)\ntest = test.drop(['Embarked'], axis = 1)\ntrain.head()","54f69a17":"sex_mapping = {\"male\": 0, \"female\": 1}\ntrain['Sex'] = train['Sex'].map(sex_mapping)\ntest['Sex'] = test['Sex'].map(sex_mapping)\n\ntrain.head()","ea4998c4":"f, ax = plt.subplots(figsize=(6, 6))\ncmap = sns.cubehelix_palette(as_cmap=True)\nsns.kdeplot(train['Survived'], train['Sex'],cbar = cmap,shade=True);","9239b7cb":"g = sns.jointplot(x='Survived', y = 'Sex', data=train, kind=\"kde\", color=\"m\")\ng.plot_joint(plt.scatter, c=\"w\", s=30, linewidth=1, marker=\"+\")\ng.ax_joint.collections[0].set_alpha(0)\ng.set_axis_labels(\"Survived\", \"Gender\")","5b14c7ff":"f, ax = plt.subplots(figsize=(6, 6))\nsns.kdeplot(train['Survived'], train['Sex'], ax=ax)\nsns.rugplot(train['Survived'], color=\"g\", ax=ax)\nsns.rugplot(train['Sex'], vertical=True, ax=ax);","7ef85015":"# convert from float to int\ntrain['Fare'] = train['Fare'].astype(int)\ntest['Fare']= test['Fare'].astype(int)\n\n# get fare for survived & didn't survive passengers \nfare_not_survived = train[\"Fare\"][train[\"Survived\"] == 0]\nfare_survived = train[\"Fare\"][train[\"Survived\"] == 1]\n\n# get average and std for fare of survived\/not survived passengers\navgerage_fare = DataFrame([fare_not_survived.mean(), fare_survived.mean()])\nstd_fare = DataFrame([fare_not_survived.std(), fare_survived.std()])\n\n# plot\ntrain['Fare'].plot(kind='hist', figsize=(15,3),bins=100, xlim=(0,50), color = 'purple')\n\navgerage_fare.index.names = std_fare.index.names = [\"Survived\"]\navgerage_fare.plot(yerr=std_fare,kind='bar',legend=False, color = 'r');","d59d6b2d":"mask = np.zeros_like(train.corr(), dtype=np.bool)\n## in order to reverse the bar replace \"RdBu\" with \"RdBu_r\"\nplt.subplots(figsize = (15,12))\nsns.heatmap(train.corr(), annot=True,mask = False,cmap = 'OrRd', linewidths=.7, linecolor='black',fmt='.2g',center = 0,square=True)\n\nplt.title(\"Correlations\", y = 1.03,fontsize = 20, fontweight = 'bold', pad = 40);","9de5ba93":"## Age","a10e7892":"## Port of Embarkation","f4791d72":"To analyse the data based on the family size, first, create new column:","10e82c9f":"Now, let's take a look at the titanic data: There are 891 rows by 12 columns observations in total. Just by the logic, I would assume that Age, Passenger Class, and Sex are major factors in the survival rate on the Titanic.","8493054a":"## Treating Missing Values","525e963d":"Looking at the Age distribution for men and women, it's clear that the average age for both was about 30. Many men older 50 years old and children after 8 years old did not survive. However, it's opposite for women: most of the women older 50 years old survived. The middle age of men, who did not survive, was between 24 and 36 years old, for women - between 18 and 32. The oldest person on the Titanic survived who was 80 years old. ","50feac3e":"Now, I map each Gender value to a numerical value:","b5521ce7":"![Titanic](https:\/\/resize-pdm.francedimanche.ladmedia.fr\/rcrop\/635,500\/img\/2017-04\/titanic.png?version=v1)","378b5bf6":"### Passenger Class","852cfe42":"Reading in data from the competition page:\nhttps:\/\/www.kaggle.com\/c\/titanic","1cc6244b":"### Survived","024fbdbe":"Missing Values in the column Age can be fixed by imputing values, in our case, using average, of this column. \nFor the column Embarked the missing values can be fixed by 'ffil' that implaces last valid observation in this column. At the same time, I dropped PassengerId, Name and Ticket columns.","909d1a56":"And here is the rate of survival by class:","bf85dbcc":"To look at the correlation between passenger class and survival statistics I would plot a countplot.","49e5f88b":"By creating Age subgroups we can examen the data even more.","931502b2":"Since for the Predictions everyone uses more of less the same models, in this Notebook I would like to cover Data Analysis and Data Visualisation. ","2084c5db":"As many of us here, I have been a part of the [Titanic Competition](https:\/\/www.kaggle.com\/c\/titanic) and I have done my share of submissions.","dbf364f0":"## Data Analysis\n","bfe0c8b7":"## Correlations  and Heatmap","089d5fcb":"## Missing values","b5a6f12d":"The average Age is around 30 years old which is not a surprise considering the time.","90705024":"As expected, 3rd class passngers has the lowest survival rate, while the 1st class has the highest.","683a02b1":"Distribution of survived: 1 is for survived and 0 is for not. ","4574fa07":"Note: Some of the seaborn color palettes can be found here:\nhttps:\/\/images.app.goo.gl\/a4gDzjx5ZgAvf5Kf8","fefee890":"At the catplot below we can see the detailed distribution of the survival rate between different passenger classes on the Titanic for men and women.  ","c2ae70ea":"Here is another representation of this correlation:","6aadbc2e":"## Family Size","090086fe":"And the next 3 plots are just cool kdeplots for Gender and Survival Rate ","55117f49":"In this case, I decided to use mapping each Embarked value to a numerical value instead of creating a dummies.","a901b185":"### Gender","e49009a6":"## Cabin","85dfc267":"Let's started by importing our libraries:","e148fe80":"Some additional statistics for both data sets: Average and Standard Deviation.","bad80489":"## Fare","1e15c55d":"And now for the test data:","53289765":"Looking at the survaval data for each port separetely, port Southampton has the highest number of survivors. At the same time, the largest number of victims came from port Cherbourg.","ba57d363":"The percentage of survived women is a lot higher. However, it was expected since the women and children were put on the emergency boats first.","97479320":"Below, another representation of the survivors and victims for each ticket class.","172fcaa4":"Another way to present it:","0b312207":"The survival rate of women is a lot higher than men.","0b0a42eb":"#### Barplot of survival rate between men and women:","f77a0e7a":"Another way to calculate these % using groupby():","5bc37ed7":"Instead of creating dummies like I did above, you can map values to each category. And, as you can see, these works.","ac6b48f1":"As a metter of fact, passangers with the Cabin were more likely to survive.","3d000467":"#### I hope you find this kernel useful and your UPVOTES would be highly appreciated","67de076b":"Now, it's clear that 1st class had 63%, 2nd class is almost 'fifty-fifty' and 3rd class had only 24% survival rate.","b4cc4a82":"Most of the passengers are between 15 and 40 years old and many infants had survived. ","5396a54a":"Percentages of who survived: The men's survival is tragically a lot lower than women's."}}