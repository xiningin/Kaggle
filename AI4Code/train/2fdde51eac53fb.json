{"cell_type":{"2e78a457":"code","15690978":"code","c35e6c24":"code","108c71de":"code","f0483e60":"code","79744fce":"code","cecef13a":"code","48ea0093":"code","a1e813d5":"code","4670ecf7":"code","8561dd67":"code","f1c9ff1b":"code","cae655a3":"code","0c69036b":"code","93acfd09":"code","61d4adbc":"code","4c53c4ea":"code","ede3914d":"code","1a98f95a":"code","40fb70f3":"code","6a940903":"code","2db4247c":"code","d14cac15":"code","4b5052b9":"code","30f548d5":"code","96eca60c":"code","22f9751b":"code","8611f666":"code","a8c0c621":"code","47f5baaf":"code","e17f47a4":"code","6241fdbb":"code","94f5e4dc":"code","a2be98af":"code","0555dbbc":"code","47552250":"code","13e15a3a":"code","3d818f1b":"code","037e0c6c":"code","b47a0925":"code","3e4fc4c7":"code","d8289bc0":"code","ca27eaef":"code","4b7b0cbf":"code","c88ee949":"code","ad02da5f":"code","500b2db6":"code","30907746":"code","8eeb4b3a":"code","3b805c7c":"code","e70588a2":"code","b7701997":"code","03f1320c":"code","18ebbba6":"code","3cfdfdc0":"code","2bcbb257":"code","084fa629":"code","239d6f07":"code","263c550d":"code","0c567630":"code","ee76e229":"code","8a617cea":"code","630f4cb7":"code","ea1e1404":"code","1697c030":"code","21cdcac0":"code","1a0eac44":"markdown","4f2b429e":"markdown","0727016d":"markdown","2ad580f7":"markdown","dcdbdfb3":"markdown","61574330":"markdown","8f27225b":"markdown","809991a9":"markdown","53e76055":"markdown","d442bbed":"markdown","9166b7de":"markdown","010746c8":"markdown","e90b2740":"markdown","47fd148a":"markdown","bd31df6d":"markdown","57ad2289":"markdown","7b92428c":"markdown","94ecc011":"markdown","f197203b":"markdown","fd846b99":"markdown","2155e357":"markdown","37e94caf":"markdown","f5d52c7c":"markdown","86c4c712":"markdown","d3ae3d9d":"markdown","5daa092b":"markdown","e7388474":"markdown","51ee032d":"markdown","33d13f7a":"markdown","5ba03e67":"markdown","75a936ea":"markdown","276986d0":"markdown","94b84be3":"markdown","33adbfbc":"markdown","b95ccae0":"markdown","267d4260":"markdown","9bed3c23":"markdown","71f00b6b":"markdown","44fced9a":"markdown","00e4daa8":"markdown","c09a3ea8":"markdown","f1a24ade":"markdown","b55196d9":"markdown","deac0e0f":"markdown","0bf8dc1c":"markdown","367d99ae":"markdown","6786ee75":"markdown","103e79e4":"markdown","2ff5e7a2":"markdown","e81309f2":"markdown"},"source":{"2e78a457":"#import Useful Library\nimport pandas as pd\nimport numpy as np\n\n#for making graph\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline\n\n#for warnings\nimport warnings\nwarnings.filterwarnings(\"ignore\")","15690978":"df = pd.read_csv('..\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv')","c35e6c24":"df.columns = ['id','gender','age','income','spending']\ndf.info()","108c71de":"df.head()","f0483e60":"df.describe()","79744fce":"sns.boxplot(x=\"age\", data=df)","cecef13a":"sns.boxplot(x=\"income\", data=df)","48ea0093":"sns.boxplot(x=\"spending\", data=df)","a1e813d5":"bins_size = np.arange(18,75,2)\nplt.hist(x=\"age\", data=df, bins= bins_size,rwidth=0.9);\nplt.title('Distribution of Age');\nplt.ylabel('Count');\nplt.xlabel('Age');","4670ecf7":"plt.figure(figsize=(12,3))\nbins_size = np.arange(15,134,1)\nplt.hist(x=\"income\", data=df, bins= bins_size,rwidth=0.9);\nplt.title('Distribution of Annual Income');\nplt.ylabel('Count');\nplt.xlabel('Annual Income (1000 $)');","8561dd67":"plt.figure(figsize=(8,3))\nbins_size = np.arange(1,100,3)\nplt.hist(x=\"spending\", data=df, bins= bins_size,rwidth=0.9);\nplt.title('Distribution of Spending Score');\nplt.ylabel('Count');\nplt.xlabel('Spending Score');","f1c9ff1b":"sns.distplot(df.age);","cae655a3":"sns.distplot(df.spending);","0c69036b":"sns.distplot(df.income);","93acfd09":"df.describe()","61d4adbc":"df.income.unique()","4c53c4ea":"df.income.nunique()","ede3914d":"df.spending.unique()","1a98f95a":"df.spending.nunique()","40fb70f3":"df.age.unique()","6a940903":"df.age.nunique()","2db4247c":"df.duplicated().sum()","d14cac15":"plt.figure(figsize =(8,8))\n#ax.set_ylim(4.0, 0)\nax= sns.heatmap(df.corr(),square = True, annot = True,cmap= 'Spectral' )\nax.set_ylim(4.0, 0)","4b5052b9":"df.info()","30f548d5":"plt.figure(1 , figsize = (15 , 7))\nn = 0 \nfor x in ['age' , 'income' , 'spending']:\n    for y in ['age' , 'income' , 'spending']:\n        n += 1\n        plt.subplot(3 , 3 , n)\n        plt.subplots_adjust(hspace = 0.5 , wspace = 0.5)\n        sns.regplot(x = x , y = y , data = df)\n        plt.ylabel(y.split()[0]+' '+y.split()[1] if len(y.split()) > 1 else y )\nplt.show()","96eca60c":"col = sns.color_palette()[0]","22f9751b":"sns.barplot(x=\"gender\", y=\"spending\", data=df, color=col)","8611f666":"sns.barplot(x=\"gender\", y=\"income\", data=df, color=col)","a8c0c621":"plt.figure(figsize=(15,5))\nsns.barplot(x=\"age\", y=\"spending\", data=df, color=col)","47f5baaf":"plt.figure(figsize=(15,5))\nsns.barplot(x=\"age\", y=\"income\", data=df, color=col)","e17f47a4":"plt.figure(figsize=(20,5))\nsns.barplot(x=\"spending\", y=\"income\", data=df, color=col)","6241fdbb":"plt.figure(figsize=(10,10))\nsns.pairplot(df, vars=[\"age\", \"income\",\"spending\"])","94f5e4dc":"sns.pairplot(df, vars=[\"age\", \"income\",\"spending\"], hue = \"gender\")","a2be98af":"df.duplicated().sum()","0555dbbc":"df.drop(columns=['id'], inplace = True)","47552250":"df.info()","13e15a3a":"a = df.groupby(['gender', 'age'])\na.first()","3d818f1b":"plt.figure(figsize = (10 , 5))\nsns.scatterplot(x = 'income',y = 'spending', data = df, hue = 'gender', s=200,alpha =0.7)","037e0c6c":"labels = ['Female', 'Male']\nsize = df['gender'].value_counts()\ncolors = ['lightblue', 'pink']\nexplode = [0, 0.1]\n\nplt.rcParams['figure.figsize'] = (5, 5)\nplt.pie(size, colors = colors, explode = explode, labels = labels, shadow = True, autopct = '%.2f%%')\nplt.title('Gender', fontsize = 20)\nplt.axis('off')\nplt.legend()\nplt.show()","b47a0925":"plt.figure(figsize = (5 , 5))\nsns.stripplot(df['gender'], df['age'], palette = 'Purples', size = 6)\nplt.title('Gender vs Age', fontsize = 10)\nplt.show()","3e4fc4c7":"x = df.income\ny = df.age\nz = df.spending\nplt.figure(figsize = (10 , 5))\nsns.lineplot(x, y, color = 'blue')\nsns.lineplot(x, z, color = 'pink')\nplt.title('Annual Income vs Age and Spending Score', fontsize = 20)\nplt.ylabel('Spending Score');\nplt.xlabel('Annual Income (k$)');\nplt.show()","d8289bc0":"x1 = df.iloc[:, [2, 3]].values\nx1.shape","ca27eaef":"from sklearn.cluster import KMeans\nwcss_1 = []\nfor i in range(1, 11):\n    km = KMeans(n_clusters = i, init = 'k-means++', max_iter = 300, n_init = 10, random_state = 0)\n    km.fit(x1)\n    wcss_1.append(km.inertia_)\n    ","4b7b0cbf":"plt.figure(figsize = (9 ,5))\nplt.plot(np.arange(1 , 11) , wcss_1 , 'o')\nplt.plot(np.arange(1 , 11) , wcss_1 , '-' , alpha = 0.5)\nplt.title('The Elbow Method', fontsize = 20)\nplt.xlabel('No. of Clusters')\nplt.ylabel('wcss_1')\nplt.show()","c88ee949":"kmeans_1=KMeans(n_clusters=5,init='k-means++',max_iter=300,n_init=10,random_state=0)\ny_kmeans_1=kmeans_1.fit_predict(x1)","ad02da5f":"labels_1 = kmeans_1.labels_\ncentroids_1 = kmeans_1.cluster_centers_","500b2db6":"labels_1","30907746":"centroids_1","8eeb4b3a":"plt.figure(figsize=(15,5))\nplt.scatter(x1[y_kmeans_1 == 0, 0], x1[y_kmeans_1 == 0, 1], s = 100, c = 'pink', label = 'miser')\nplt.scatter(x1[y_kmeans_1 == 1, 0], x1[y_kmeans_1 == 1, 1], s = 100, c = 'yellow', label = 'general')\nplt.scatter(x1[y_kmeans_1 == 2, 0], x1[y_kmeans_1 == 2, 1], s = 100, c = 'cyan', label = 'target')\nplt.scatter(x1[y_kmeans_1 == 3, 0], x1[y_kmeans_1 == 3, 1], s = 100, c = 'magenta', label = 'spendthrift')\nplt.scatter(x1[y_kmeans_1 == 4, 0], x1[y_kmeans_1 == 4, 1], s = 100, c = 'orange', label = 'careful')\nplt.scatter(centroids_1[:,0], centroids_1[:, 1], s = 50, c = 'blue' , label = 'centeroid')\n\nplt.style.use('fivethirtyeight')\nplt.title('Clusters: Annual Income vs Spending Score', fontsize = 20)\nplt.xlabel('Annual Income')\nplt.ylabel('Spending Score')\nplt.legend()\nplt.grid()\nplt.show()","3b805c7c":"x2 = df.iloc[:, [1,3]].values\nx2.shape","e70588a2":"wcss_2 = []\nfor i in range(1, 11):\n    km = KMeans(n_clusters = i, init = 'k-means++', max_iter = 300, n_init = 10, random_state = 0)\n    km.fit(x2)\n    wcss_2.append(km.inertia_)","b7701997":"plt.figure(figsize = (9 ,5))\nplt.plot(np.arange(1 , 11) , wcss_2 , 'o')\nplt.plot(np.arange(1 , 11) , wcss_2 , '-' , alpha = 0.5)\nplt.title('The Elbow Method', fontsize = 20)\nplt.xlabel('No. of Clusters')\nplt.ylabel('wcss_2')\nplt.show()","03f1320c":"kmeans_2=KMeans(n_clusters=4,init='k-means++',max_iter=300,n_init=10,random_state=0)\ny_kmeans_2=kmeans_2.fit_predict(x2)","18ebbba6":"y_kmeans_2","3cfdfdc0":"labels_2= kmeans_2.labels_\ncentroids_2 = kmeans_2.cluster_centers_","2bcbb257":"plt.figure(figsize=(15,5))\nplt.title('Clusters: Age vs Spending Score', fontsize = 20)\n\nplt.scatter(x2[y_kmeans_2 == 0, 0], x2[y_kmeans_2 == 0, 1], s = 100, c = 'pink', label = 'Usual Customers' )\nplt.scatter(x2[y_kmeans_2 == 1, 0], x2[y_kmeans_2 == 1, 1], s = 100, c = 'orange', label = 'Priority Customers')\nplt.scatter(x2[y_kmeans_2 == 2, 0], x2[y_kmeans_2 == 2, 1], s = 100, c = 'lightgreen', label = 'Target Customers(Young)')\nplt.scatter(x2[y_kmeans_2 == 3, 0], x2[y_kmeans_2 == 3, 1], s = 100, c = 'red', label = 'Target Customers(Old)')\nplt.scatter(centroids_2[:, 0],centroids_2[:, 1], s = 50, c = 'black')\n\nplt.style.use('fivethirtyeight')\nplt.xlabel('Age')\nplt.ylabel('Spending Score (1-100)')\nplt.legend()\nplt.grid()\nplt.show()","084fa629":"x3 = df.iloc[:, [1,2]].values\nx3.shape","239d6f07":"wcss_3 = []\nfor i in range(1, 11):\n    km = KMeans(n_clusters = i, init = 'k-means++', max_iter = 300, n_init = 10, random_state = 0)\n    km.fit(x3)\n    wcss_3.append(km.inertia_)","263c550d":"plt.figure(figsize = (9 ,5))\nplt.plot(np.arange(1 , 11) , wcss_3 , 'o')\nplt.plot(np.arange(1 , 11) , wcss_3 , '-' , alpha = 0.5)\nplt.title('The Elbow Method', fontsize = 20)\nplt.xlabel('No. of Clusters')\nplt.ylabel('wcss_3')\nplt.show()","0c567630":"kmeans_3=KMeans(n_clusters=6,init='k-means++',max_iter=300,n_init=10,random_state=0)\ny_kmeans_3=kmeans_3.fit_predict(x3)","ee76e229":"labels_3 = kmeans_3.labels_\ncentroids_3 = kmeans_3.cluster_centers_","8a617cea":"plt.figure(figsize=(15,4))\nplt.title('Clusters: Age vs Annual Income', fontsize = 20)\n\nplt.scatter(x3[y_kmeans_3 == 0, 0], x3[y_kmeans_3 == 0, 1], s = 100, c = 'pink', label = 'High Earners' )\nplt.scatter(x3[y_kmeans_3 == 1, 0], x3[y_kmeans_3 == 1, 1], s = 100, c = 'orange', label = 'Young Low Earners')\nplt.scatter(x3[y_kmeans_3 == 2, 0], x3[y_kmeans_3 == 2, 1], s = 100, c = 'lightgreen', label = 'Average Earners')\nplt.scatter(x3[y_kmeans_3 == 3, 0], x3[y_kmeans_3 == 3, 1], s = 100, c = 'red', label = 'Old Average Earners')\nplt.scatter(x3[y_kmeans_3 == 4, 0], x3[y_kmeans_3 == 4, 1], s = 100, c = 'magenta', label = 'Old Low Earners')\nplt.scatter(x3[y_kmeans_3 == 5, 0], x3[y_kmeans_3 == 5, 1], s = 100, c = 'cyan', label = 'Young Average Earners')\n\nplt.scatter(centroids_3[:, 0],centroids_3[:, 1], s = 50, c = 'black')\n\nplt.style.use('fivethirtyeight')\nplt.xlabel('Age')\nplt.ylabel('Annual Income')\nplt.legend()\nplt.grid()\nplt.show()","630f4cb7":"df_1 = df[['income','spending']]\ndf_1['Clusters'] = pd.DataFrame(labels_1)\ndf_1.head()","ea1e1404":"df_2 = df[['age','spending']]\ndf_2['Clusters'] = pd.DataFrame(labels_2)\ndf_2.head()","1697c030":"df_3 = df[['age','income']]\ndf_3['Clusters'] = pd.DataFrame(labels_3)\ndf_3.head()","21cdcac0":"#to csv\ndf_1.to_csv(\"Income_and_spendings.csv\", index=False)\ndf_2.to_csv(\"age_and_spendings.csv\", index=False)\ndf_3.to_csv(\"age_and_income.csv\",index=False)","1a0eac44":"#### Generating Array of Features","4f2b429e":"### Finding the relation between Age and spending score","0727016d":"- Cluster 1- High income low spending = Miser\n\n- Cluster 2- Medium income medium spending = General\n\n- Cluster 3- High Income and high spending =Target\n\n- Cluster 4- Low Income and high spending = Spendthrift\n\n- Cluster 5- Low Income and low spending = Careful","2ad580f7":"## Distribution of Gender in Data","dcdbdfb3":"### Visualizing the clusters : 2-D Scatter plot","61574330":"### b. Histogram \u2013 Distribution of Target Variable","8f27225b":"# Customer Segmentation Dataset\n\n## By HImanshu Sharma (DSOCT03)","809991a9":"## Steps\n- Data wrangling, which consists of:\n    - Gathering data\n    - Assessing data\n    - Cleaning data\n- Storing, analyzing, and visualizing our wrangled data\n- Making Report on\n    - Aboout data wrangling efforts and\n    - About data analyses and visualizations","53e76055":"### j. Pair plot","d442bbed":"### Using Elbow method to find the optiminal cluster number","9166b7de":"### Applying K means to the Dataset","010746c8":"> We can see people in age group of 30-40 people have high Annual income\n\n> I have divided them into 6 different categories namely High Earners, Young Low Earners, Average Earners,Senior Citizen average Earners, Senior Citizen low Earners, Young average Earners. Then after getting the results we can accordingly make different marketing strategies and policies to optimize the spending scores of the customer in the Mall.","e90b2740":"> This Clustering Analysis gives us a very clear insight about the different segments of the customers in the Mall. There are clearly Five segments of Customers namely Miser, General, Target, Spendthrift, Careful based on their Annual Income and Spending Score which are reportedly the best factors\/attributes to determine the segments of a customer in a Mall.","47fd148a":"## Benefits of customer segmentation\n\n\n- By enabling companies to target specific groups of customers, a customer segmentation model allows for the effective allocation of marketing resources and the maximization of cross- and up-selling opportunities.\n\n\n- When a group of customers is sent personalized messages as part of a marketing mix that is designed around their needs, it's easier for companies to send those customers special offers meant to encourage them to buy more products. Customer segmentation can also improve customer service and assist in customer loyalty and retention.\n\n\n- As a by-product of its personalized nature, marketing materials sent out using customer segmentation tend to be more valued and appreciated by the customer who receives them as opposed to impersonal brand messaging that doesn't acknowledge purchase history or any kind of customer relationship.\n\n\n- Other benefits of customer segmentation include staying a step ahead of competitors in specific sections of the market and identifying new products that existing or potential customers could be interested in or improving products to meet customer expectations.","bd31df6d":"### g. Correlation \u2013 Heatmap","57ad2289":"> We can clearly see that Only young people (18-40 age group) are involved in High Spending. As age increases people fall into average or Low spending category\n\n> I have aggregated them into 4 different categories namely Usual Customers, Priority Customers, Senior Citizen Target Customers, Young Target Customers. Then after getting the results we can accordingly make different marketing strategies and policies to optimize the spending scores of the customer in the Mall.","7b92428c":"- The Above Graph for Showing the linear correlation between the different attributes of the Mall Customer Segementation Dataset, This Heat map reflects the most correlated features with Blue Color and least correlated features with Red color.We can clearly see that these attributes do not have good correlation among them.","94ecc011":"### Visualizing the clusters : : 2-D Scatter plot","f197203b":"#### Generating Array of Features","fd846b99":"#### There is no formatting issues.","2155e357":"- By looking at the above graph-, It can be seen that the Ages from 27 to 39 are very much frequent but there is no clear pattern, we can only find some group wise patterns such as the the older age groups are lesser frequent in comparison. Interesting Fact, There are equal no. of Visitors in the Mall for the Agee 18 and 67. People of Age 55, 56, 69, 64 are very less frequent in the Malls. People at Age 32 are the Most Frequent Visitors in the Mall.","37e94caf":"### e. Unique Values across all columns","f5d52c7c":"- This graph explains about the distribution of Gender in the Mall, The Females are in the lead with a share of 56% whereas the Males have a share of 44%, that's a huge gap specially when the population of Males is comparatively higher than Females.","86c4c712":"### f. Duplicate values across all columns","d3ae3d9d":"## 2. Drop all duplicate rows","5daa092b":"## 9. Grouping and extracting the grouped output as a .csv file.","e7388474":"### Using Elbow method to find the optiminal cluster number","51ee032d":"### d. Aggregation for all numerical Columns","33d13f7a":"- This is also a chart to better explain the Distribution of Each Income level, Interesting there are customers in the mall with a very much comparable frequency with their Annual Income ranging from 15k US Dollars to 134K US Dollars. There are more Customers in the Mall who have their Annual Income as 54k US Dollars or 78k US Dollars.","5ba03e67":"## 7. Build model \u2013 Clustering problem statement, hence build K- Means clustering model.","75a936ea":"we can conclude that most of the Customers have their Spending Score in the range of 35-60. Interesting there are customers having 1 spending score also, and 99 Spending score also, Which shows that the mall caters to the variety of Customers with Varying needs and requirements available in the Mall.","276986d0":"### Applying K means to the Dataset","94b84be3":"## Introduction\n> Customer segmentation is the practice of dividing a customer base into groups of individuals that are similar in specific ways relevant to marketing, such as age, gender, interests and spending habits.","33adbfbc":"### Visualizing the clusters :  2-D Scatter plot","b95ccae0":"## 4. Clean the data with formatting issues if any. (converting datatypes, replacing dollars, etc.)","267d4260":"#### Generating Array of Features","9bed3c23":"## 6. Plot an elbow curve to identify what\u2019s the best K \u2013 Value.","71f00b6b":"### Finding the relation between Age and Annual Income","44fced9a":" - The above Plot Between Annual Income and Age represented by a blue color line, and a plot between Annual Income and the Spending Score represented by a pink color. shows how Age and Spending Varies with Annual Income.","00e4daa8":"## 8. Build models with every variable against each other to understand the grouping.","c09a3ea8":"### h. Regression Plot","f1a24ade":"## 1. Perform Basic EDA\n### a. Boxplot","b55196d9":"### i. Bar Plot","deac0e0f":"## 5. Add your view of EDA to enhance understanding of data. i.e., Grouping data and observing the way data is distributed. Try to add as many layers of EDA as possible.","0bf8dc1c":"### Finding the relation between Age and Annual Income","367d99ae":"## Approach - Machine Learning\n> Unsupervised Learning is a class of Machine Learning techniques to find the patterns in data. The data given to unsupervised algorithm are not labelled, which means only the input variables(X) are given with no corresponding output variables. In unsupervised learning, the algorithms are left to themselves to discover interesting structures in the data.\n\n> There are some analytics techniques that can help you with segmenting your customers. These are useful especially when you have a large number of customers and it\u2019s hard to discover patterns in your customer data just by looking at transactions. The twocommon ones are:\n\n> Clustering: Clustering is an exploration technique for datasets where relationships between different observations may be too hard to spot with the eye.\n\n> In my code, I takes advantage of the Customer Segmentation Data to demonstrate the ability of K-Means clustering algorithm to identify customer's segments.","6786ee75":"### Using Elbow method to find the optiminal cluster number","103e79e4":"### Applying K means to the Dataset :\n- K-means clustering is an unsupervised machine learning algorithm for clustering \u2018n\u2019 observations into \u2018k\u2019 clusters where k is predefined or user-defined constant.","2ff5e7a2":"### c. Distribution Plot \u2013 Target Variable","e81309f2":"## 3. Drop all non-essential features"}}