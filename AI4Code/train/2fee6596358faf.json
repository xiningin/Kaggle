{"cell_type":{"8b9394f7":"code","2012d976":"code","784c9e1d":"code","63d6a69c":"code","8bee395c":"code","22ebdb78":"code","a58f9fa2":"code","7fdde5c7":"code","237dde18":"code","249a8541":"code","8c2f13a3":"code","31a9beb1":"code","12ac8fd6":"code","c5f01a1b":"code","07790d07":"code","4ebd4806":"code","e8ead21b":"code","c6163f28":"code","57b797e9":"code","b20fe578":"code","0aa76403":"code","aaf7cdfa":"code","59cabe86":"code","dcc623e8":"code","9f303073":"code","c099a6b1":"code","c7b5c977":"code","bf07e996":"code","4f33f90c":"code","6292a414":"code","77dfd897":"markdown","394b5ab1":"markdown","e74babf8":"markdown","78856eec":"markdown","39ad673f":"markdown","eca39b20":"markdown","f228e9f8":"markdown","1f25546f":"markdown","e4b35af7":"markdown","1012a73a":"markdown","0ace05eb":"markdown","f03924d3":"markdown","a1b14878":"markdown","add3390c":"markdown","9087f7ad":"markdown","a80e2ffa":"markdown","bf1c582b":"markdown","1973cc45":"markdown","7f8c773b":"markdown","f6831fc5":"markdown","2b863609":"markdown","55ddf9b0":"markdown","ec68fa6f":"markdown","61ab3227":"markdown"},"source":{"8b9394f7":"import glob, pylab, pandas as pd\nimport pydicom, numpy as np\nfrom os import listdir\nfrom os.path import isfile, join\nimport matplotlib.pylab as plt\nimport os\nimport seaborn as sns\n\n","2012d976":"from keras import layers\nfrom keras.applications import DenseNet121\nfrom keras.preprocessing.image import ImageDataGenerator\nfrom keras.callbacks import Callback, ModelCheckpoint\nfrom keras.preprocessing.image import ImageDataGenerator\nfrom keras.models import Sequential\nfrom keras.optimizers import Adam\nfrom tqdm import tqdm","784c9e1d":"!ls ..\/input","63d6a69c":"train = pd.read_csv('..\/input\/rsna-intracranial-hemorrhage-detection\/stage_1_train.csv')\n","8bee395c":"train.head(10)","22ebdb78":"train.shape\n","a58f9fa2":"newtable = train.copy()","7fdde5c7":"train.Label.isnull().sum()","237dde18":"# Images Example\ntrain_images_dir = '..\/input\/rsna-intracranial-hemorrhage-detection\/stage_1_train_images\/'\ntrain_images = [f for f in listdir(train_images_dir) if isfile(join(train_images_dir, f))]\ntest_images_dir = '..\/input\/rsna-intracranial-hemorrhage-detection\/stage_1_test_images\/'\ntest_images = [f for f in listdir(test_images_dir) if isfile(join(test_images_dir, f))]\nprint('5 Training images', train_images[:5]) # Print the first 5","249a8541":"print('Total File sizes')\nfor f in os.listdir('..\/input\/rsna-intracranial-hemorrhage-detection'):\n    if 'zip' not in f:\n        print(f.ljust(30) + str(round(os.path.getsize('..\/input\/rsna-intracranial-hemorrhage-detection\/' + f) \/ 1000000, 2)) + 'MB')","8c2f13a3":"print('Number of train images:', len(train_images))\nprint('Number of test images:', len(test_images))","31a9beb1":"fig=plt.figure(figsize=(15, 10))\ncolumns = 5; rows = 4\nfor i in range(1, columns*rows +1):\n    ds = pydicom.dcmread(train_images_dir + train_images[i])\n    fig.add_subplot(rows, columns, i)\n    plt.imshow(ds.pixel_array, cmap=plt.cm.bone)\n    fig.add_subplot","12ac8fd6":"print(ds) # this is file type of image","c5f01a1b":"im = ds.pixel_array\nprint(type(im))\nprint(im.dtype)\nprint(im.shape)","07790d07":"sns.countplot(train.Label)\n","4ebd4806":"train.Label.value_counts()","e8ead21b":"\npylab.imshow(im, cmap=pylab.cm.gist_gray)\npylab.axis('on')","c6163f28":"train['Sub_type'] = train['ID'].str.split(\"_\", n = 3, expand = True)[2]\ntrain['PatientID'] = train['ID'].str.split(\"_\", n = 3, expand = True)[1]\n","57b797e9":"train.head()","b20fe578":"gbSub = train.groupby('Sub_type').sum()\ngbSub","0aa76403":"sns.barplot(y=gbSub.index, x=gbSub.Label, palette=\"deep\")","aaf7cdfa":"fig=plt.figure(figsize=(10, 8))\n\nsns.countplot(x=\"Sub_type\", hue=\"Label\", data=train)\n\nplt.title(\"Total Images by Subtype\")","59cabe86":"\ndef window_image(img, window_center,window_width, intercept, slope):\n\n    img = (img*slope +intercept)\n    img_min = window_center - window_width\/\/2\n    img_max = window_center + window_width\/\/2\n    img[img<img_min] = img_min\n    img[img>img_max] = img_max\n    return img \n    ","dcc623e8":"def get_first_of_dicom_field_as_int(x):\n    #get x[0] as in int is x is a 'pydicom.multival.MultiValue', otherwise get int(x)\n    if type(x) == pydicom.multival.MultiValue:\n        return int(x[0])\n    else:\n        return int(x)\n\ndef get_windowing(data):\n    dicom_fields = [data[('0028','1050')].value, #window center\n                    data[('0028','1051')].value, #window width\n                    data[('0028','1052')].value, #intercept\n                    data[('0028','1053')].value] #slope\n    return [get_first_of_dicom_field_as_int(x) for x in dicom_fields]","9f303073":"train_images_dir\n\ndef view_images(images, title = '', aug = None):\n    width = 5\n    height = 2\n    fig, axs = plt.subplots(height, width, figsize=(15,5))\n    \n    for im in range(0, height * width):\n        ''''\n        image = pydicom.read_file(os.path.join(train_images_dir,'ID_'+images[im]+ '.dcm')).pixel_array\n        i = im \/\/ width\n        j = im % width\n        axs[i,j].imshow(image, cmap=plt.cm.bone) \n        axs[i,j].axis('off')'''''\n        \n        data = pydicom.read_file(os.path.join(train_images_dir,'ID_'+images[im]+ '.dcm'))\n        image = data.pixel_array\n        window_center , window_width, intercept, slope = get_windowing(data)\n        image_windowed = window_image(image, window_center, window_width, intercept, slope)\n\n\n        i = im \/\/ width\n        j = im % width\n        axs[i,j].imshow(image_windowed, cmap=plt.cm.bone) \n        axs[i,j].axis('off')\n        \n        \n    plt.suptitle(title)\n    plt.show()","c099a6b1":"view_images(train[(train['Sub_type'] == 'epidural') & (train['Label'] == 1)][:10].PatientID.values, title = 'Images of hemorrhage epidural')","c7b5c977":"view_images(train[(train['Sub_type'] == 'intraparenchymal') & (train['Label'] == 1)][:20].PatientID.values, title = 'Images of hemorrhage intraparenchymal')","bf07e996":"view_images(train[(train['Sub_type'] == 'intraventricular') & (train['Label'] == 1)][:20].PatientID.values, title = 'Images of hemorrhage intraventricular')","4f33f90c":"view_images(train[(train['Sub_type'] == 'subarachnoid') & (train['Label'] == 1)][:20].PatientID.values, title = 'Images of hemorrhage subarachnoid')","6292a414":"view_images(train[(train['Sub_type'] == 'subdural') & (train['Label'] == 1)][:20].PatientID.values, title = 'Images of hemorrhage subdural')","77dfd897":"###  **I hope you find this kernel helpful and some <font color=\"red\"><b>UPVOTES<\/b><\/font> would be very much appreciated**","394b5ab1":"### What are the types of ICH?\n\nThere are four types of ICH:\n\n- epidural hematoma\n- subdural hematoma\n- subarachnoid hemorrhage\n- intracerebral hemorrhage","e74babf8":"## <div style=\"text-align: center\"> First Impression about this RSNA Intracranial Hemorrhage\n<\/div>\n<img src=\"https:\/\/images.idgesg.net\/images\/article\/2017\/09\/data-science-certification10-100734865-large.jpg\">\n\n   Bleeding, also called hemorrhage, is the name used to describe blood loss. It can refer to blood loss inside the body, called internal bleeding, or to blood loss outside of the body, called external bleeding.\n\nIn this we are working with 4 types and another any\n\n- 1_epidural\n- intraparenchymal\n- intraventricular\n- subarachnoid\n- subdural\n- any\n\n **I hope this kernel helpful and some <font color=\"red\"><b>UPVOTES<\/b><\/font> would be very much appreciated**","78856eec":"<a id=\"3\"><\/a> <br>\n## 3- Load Data\n\n**stage_1_train.csv** - the training set. Contains Ids and target information.\n**stage_1_sample_submission.csv** - a sample submission file in the correct format. Contains Ids for the test set.\n\n\nStage 1 Images - **stage_1_train_images.zip** and **stage_1_test_images.zip**\n\n- images for the current stage. Filenames are also patient names.\n\n","39ad673f":"###### [Go to top](#top)","eca39b20":"<a id=\"10\"><\/a> <br>\n## 10- Visualization of hemorrhage subarachnoid","f228e9f8":"<a id=\"5\"><\/a> <br>\n## 5- Visualization of data","1f25546f":"<a id=\"8\"><\/a> <br>\n## 8- Visualization of hemorrhage intraparenchymal","e4b35af7":"### Intracerebral hemorrhage\nIntracerebral hemorrhage is when there\u2019s bleeding inside of your brain. This is the most common type of ICH that occurs with a stroke. It\u2019s not usually the result of injury.\n\nA prominent warning sign is the sudden onset of neurological deficit. This is a problem with your brain\u2019s functioning. The symptoms progress over minutes to hours. They include:\n\n- headache\n- difficulty speaking\n- nausea\n- vomiting\n- decreased consciousness\n- weakness in one part of the body\n- elevated blood pressure","1012a73a":"**<a id=\"1\"><\/a> <br>**\n## 1- What is an intracranial hemorrhage","0ace05eb":"###  Good luck!","f03924d3":"### Subdural hematoma\n\nA subdural hematoma is a collection of blood on the surface of your brain.\n\nIt\u2019s typically the result of your head moving rapidly forward and stopping, such as in a car accident. However, it could also suggest abuse in children. This is the same type of movement a child experiences when being shaken.\n\nA subdural hematoma is more common than other ICHs in older people and people with history of heavy alcohol use.","a1b14878":"<a id=\"11\"><\/a> <br>\n## 11- Visualization of hemorrhage subdural","add3390c":"<a id=\"9\"><\/a> <br>\n## 9- Visualization of hemorrhage intraventricular","9087f7ad":"### To take a look at this first DICOM image, let's use the pylab.imshow() method:","a80e2ffa":"### Epidural hematoma\n\n<img src=\" \">\n\nA hematoma is a collection of blood, in a clot or ball, outside of a blood vessel. An epidural hematoma occurs when blood accumulates between your skull and the outermost covering of your brain.\n\nIt typically follows a head injury, and usually with a skull fracture. High-pressure bleeding is a prominent feature. If you have an epidural hematoma, you may briefly lose consciousness and then regain consciousness.","bf1c582b":"## Overview of DICOM files and medical images\nMedical images are stored in a special format known as DICOM files (*.dcm). They contain a combination of header metadata as well as underlying raw image arrays for pixel data. In Python, one popular library to access and manipulate DICOM files is the pydicom module. To use the pydicom library, first find the DICOM file for a given patientId by simply looking for the matching file in the stage_1_train_images\/ folder, and the use the pydicom.read_file() method to load the data:","1973cc45":"<img src=\"https:\/\/www.googleapis.com\/download\/storage\/v1\/b\/kaggle-user-content\/o\/inbox%2F603584%2F56162e47358efd77010336a373beb0d2%2Fsubtypes-of-hemorrhage.png?generation=1568657910458946&alt=media\">","7f8c773b":"<a id=\"top\"><\/a> <br>\n## Notebook  Content\n\n1. [What is an intracranial hemorrhage](#1)\n1. [Import](#2)\n1. [Load Data](#3)\n1. [Check images](#4)\n1. [Visualization](#5)\n1. [Working newTable ](#6)\n1. [Visualization of hemorrhage epidural](#7)\n1. [Visualization of hemorrhage Intraparenchymal](#8)\n1. [Visualization of hemorrhage Intraparenchymal](#9)\n1. [Visualization of hemorrhage Subarachnoid](#10)\n1. [Visualization of hemorrhage subdural](#11)\n\n","f6831fc5":"Intracranial hemorrhage (ICH) refers to acute bleeding inside your skull or brain. It\u2019s a life-threatening emergency. You should go to the emergency room right away or call 911 if you think you or someone you know is experiencing ICH.","2b863609":"<a id=\"4\"><\/a> <br>\n## 4- Check images","55ddf9b0":"<a id=\"7\"><\/a> <br>\n## 7- Visualization of hemorrhage epidural\n\nReference of Correcting windows : https:\/\/www.kaggle.com\/omission\/eda-view-dicom-images-with-correct-windowing @Richard_McKinley","ec68fa6f":"**<a id=\"2\"><\/a> <br>**\n## 2- Import","61ab3227":"<a id=\"6\"><\/a> <br>\n## 6- Working newTable "}}