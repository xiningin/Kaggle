{"cell_type":{"1aa1c03f":"code","24d54f6f":"code","631ea47e":"code","29080ea1":"code","8ff990f5":"code","69dd9485":"code","34741125":"code","8b3f24ea":"code","12e6bc77":"code","8f416667":"code","c2b5a283":"code","39666c3e":"code","6b0035ac":"code","c7a1649c":"code","0e8f5f7a":"code","d0b9f49c":"code","98d92189":"code","3bec6839":"code","09d02743":"code","77e68276":"code","86cbb538":"code","00d7b0bc":"code","a66f7349":"code","6b0c9986":"code","56846a09":"code","4864ec72":"code","ac952132":"code","9c49cfc0":"code","c93768e8":"code","7d19e230":"code","739088c3":"code","42fd5a99":"code","0d356b9f":"code","b0132a22":"code","76ac53bb":"code","bee4e9c6":"code","689937a9":"code","9c89962e":"code","df9dd402":"code","3f7dbc44":"code","6f0bb798":"code","175ad6e6":"code","d26c6126":"code","fd69ac3d":"code","245cf8c1":"code","f8d9ce0f":"code","7a4c4ae1":"code","612e9a81":"code","e928285a":"code","aa47b2e0":"code","54b59794":"code","5007c949":"code","f4761516":"code","6240657d":"code","a9a52e26":"markdown","6e96c2bb":"markdown","099a745a":"markdown","caff7862":"markdown","d0586240":"markdown","325cd585":"markdown","e9f0942e":"markdown","3361e914":"markdown","c7ed1c99":"markdown","367631a4":"markdown","87b7a5ca":"markdown","0518b4c0":"markdown","fc4cbdce":"markdown","c14f6ae0":"markdown","105bd350":"markdown","ac117136":"markdown","730ff0a9":"markdown","f7d0be0f":"markdown","49a51a1d":"markdown","54a7c080":"markdown","8b69f9f3":"markdown","9aeb7f25":"markdown","6ddc6d45":"markdown"},"source":{"1aa1c03f":"import pandas as pd\nimport numpy as np","24d54f6f":"df = pd.read_csv('..\/input\/covid19-confirmed-cases-kerala\/Covid 19 Confirmed Cases-Kerala.csv',index_col='Date',parse_dates=True)","631ea47e":"df.head()","29080ea1":"df.tail()","8ff990f5":"df.index.freq='D'","69dd9485":"df.index","34741125":"df.plot(figsize=(13,8))","8b3f24ea":"df_rolling=df.rolling(window=31).mean()","12e6bc77":"df_rolling","8f416667":"\ndf['Confirmed'].plot(figsize=(13,8),legend=True)\ndf_rolling['Confirmed'].plot(legend=True,color='red');","c2b5a283":"df['Confirmed']=df['Confirmed'].astype(float)","39666c3e":"df=df.loc['2020-06-01':]","6b0035ac":"df","c7a1649c":"df_rolling=df.rolling(window=7).mean()","0e8f5f7a":"df['Confirmed'].plot(figsize=(13,8),legend=True)\ndf_rolling['Confirmed'].plot(legend=True,color='red');","d0b9f49c":"from statsmodels.tsa.seasonal import seasonal_decompose  ","98d92189":"result = seasonal_decompose(df['Confirmed'],model='mul')","3bec6839":"result.plot();","09d02743":"pip install statsmodels","77e68276":"from statsmodels.tsa.stattools import adfuller","86cbb538":"def adf_test(series,title=''):\n    \"\"\"\n    Pass in a time series and an optional title, returns an ADF report\n    \"\"\"\n    print(f'Augmented Dickey-Fuller Test: {title}')\n    result = adfuller(series.dropna(),autolag='AIC') # .dropna() handles differenced data\n    \n    labels = ['ADF test statistic','p-value','# lags used','# observations']\n    out = pd.Series(result[0:4],index=labels)\n\n    for key,val in result[4].items():\n        out[f'critical value ({key})']=val\n        \n    print(out.to_string())          # .to_string() removes the line \"dtype: float64\"\n    \n    if result[1] <= 0.05:\n        print(\"Strong evidence against the null hypothesis\")\n        print(\"Reject the null hypothesis\")\n        print(\"Data has no unit root and is stationary\")\n    else:\n        print(\"Weak evidence against the null hypothesis\")\n        print(\"Fail to reject the null hypothesis\")\n        print(\"Data has a unit root and is non-stationary\")","00d7b0bc":"adf_test(df['Confirmed'])","a66f7349":"len(df)","6b0c9986":"train = df.iloc[:418]\ntest = df.iloc[418:]","56846a09":"from statsmodels.tsa.holtwinters import ExponentialSmoothing","4864ec72":"model = ExponentialSmoothing(train['Confirmed'],trend='mul',seasonal='mul')","ac952132":"fitted_model = model.fit()","9c49cfc0":"trained_values = fitted_model.fittedvalues.rename('trained_values')","c93768e8":"trained_values","7d19e230":"train['Confirmed'].plot(figsize=(13,8),legend=True)\ntrained_values.plot(legend=True)\n","739088c3":"predictions = fitted_model.forecast(5).rename('predictions')","42fd5a99":"test['Confirmed'].plot(figsize=(13,8),legend=True)\npredictions.plot(figsize=(13,8),legend=True)","0d356b9f":"train[-5:].plot(figsize=(13,8))\ntest['Confirmed'].plot(figsize=(13,8))\npredictions.plot(figsize=(13,8))","b0132a22":"from statsmodels.tools.eval_measures import rmse\n\nerror = rmse(test['Confirmed'], predictions)","76ac53bb":"df['Confirmed'].describe()","bee4e9c6":"error","689937a9":"pip install  pmdarima","9c89962e":"from pmdarima import auto_arima","df9dd402":"from statsmodels.graphics.tsaplots import plot_acf,plot_pacf","3f7dbc44":"title = 'Autocorrelation: Confirmed cases'\nlags = 40\nplot_acf(df['Confirmed'],title=title,lags=lags);","6f0bb798":"title = 'Partial Autocorrelation: Confirmed cases'\nlags = 40\nplot_pacf(df['Confirmed'],title=title,lags=lags);","175ad6e6":"stepwise_fit = auto_arima(df['Confirmed'],start_p=0,start_q=0,seasonal=False,trace=True)","d26c6126":"stepwise_fit.summary()","fd69ac3d":"from statsmodels.tsa.arima_model import ARIMA","245cf8c1":"model = ARIMA(df['Confirmed'],order=(2,1,5))\nfitted_model = model.fit()\nfcast = fitted_model.predict(len(train),len(train)+len(test)-1,typ='levels').rename('ARIMA(2,1,5) Predicted')","f8d9ce0f":"fcast","7a4c4ae1":"fcast.plot(figsize=(13,8),legend=True)\ntest['Confirmed'].plot(legend=True)","612e9a81":"from statsmodels.tools.eval_measures import rmse\n\nerror = rmse(test['Confirmed'], fcast)","e928285a":"error","aa47b2e0":"df.tail()","54b59794":"forecast = fitted_model.predict(len(df),len(df)+5,typ='levels').rename('ARIMA(2,1,5) Future')","5007c949":"forecast","f4761516":"forecast.plot(figsize=(13,8))","6240657d":"forecast.plot(figsize=(13,8))\ndf['Confirmed'].plot(figsize=(13,8))","a9a52e26":"# GRID SEARCH FOR BEST POSSIBLE p,q,d","6e96c2bb":"# Holt Winters Method","099a745a":"# REMOVNIG INITIAL VALUES CLOSE TO 0","caff7862":"# CHECKING PREDICTIONS ON TEST DATA","d0586240":"THERE IS VERY LOW SEASONALITY\nBUT SOME INCREASING GENERAL TREND","325cd585":"# READING THE DATASET AND MAKING CHANGING THE INDEX","e9f0942e":"VISUALLY NOT MUCH STATIONARITY IS VISIBLE","3361e914":"SHARP DROP IN PACF PLOT AFTER LAG OF 2 => p should be around 1\nCONTINOUSLY DECREASING AUTO CRRELATION VALUES WITH TIME=> Q should be around 0","c7ed1c99":"# RUNNING ETS(ERROR TREND SEASONALITY) DECOMPOSITION","367631a4":"SINCE THE ANALYSIS IS DONE ON 31-07-2021\nWE CAN ACTUALLY CHECK 5 DAYS LATER HOW MUCH OUR FORECAST MATCHES","87b7a5ca":"# IGNORING SMALL SEASONALITY FOR NOW","0518b4c0":"NOT PASSING SEASONAL PERIODS AS IT CANNOT BE COMMENTED CLEARLY","fc4cbdce":"about 1\/3 times less error than that of Holtwinters","c14f6ae0":"# MAKING ACF,PACF PLOTS TO GET ROUGH IDEA FOR p,q,d","105bd350":"# CHECKING MOVING AVERAGES","ac117136":"# ARIMA MODEL WITH p=2,d=1,q=5","730ff0a9":"# ARIMA","f7d0be0f":"# LOOKS MUCH BETTER FIT","49a51a1d":"# AUGMENTED DICKEY FULLER TEST FOR CHECKING STATIONARITY","54a7c080":"# FORECASTING INTO UNKNOWN FUTURE","8b69f9f3":"LOOKS ACCEPTABLE ","9aeb7f25":"WILL NEED TO CHECK HOW MUCH THESE PREDICTIONS MATCH ON 3rd AUGUST 2021","6ddc6d45":"# DATASET IS NON STATIONARY p value >0.05 "}}