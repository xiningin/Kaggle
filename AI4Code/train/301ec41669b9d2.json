{"cell_type":{"cd904a4e":"code","f00eb674":"code","75f3c51e":"code","13a5c6cc":"code","b9226e87":"code","206cde09":"code","d83c081c":"code","801ce291":"code","9b4beec3":"code","23123622":"code","81ce8d99":"code","6bfb3dd8":"code","9bb9d1ad":"markdown","067d7442":"markdown"},"source":{"cd904a4e":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\n\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","f00eb674":"from keras.models import Sequential\nfrom keras.layers import Input,Convolution2D,MaxPooling2D,Dense,Flatten,Dropout\nfrom keras.utils import np_utils\nimport tensorflow","75f3c51e":"x = pd.read_csv('..\/input\/fashionmnist\/fashion-mnist_train.csv')\nX_ = np.array(x)\nX = X_[:,1:]\nX = X\/255.0\ny = X_[:,0]\nprint(X.shape,y.shape)","13a5c6cc":"print(y[:100])","b9226e87":"x.head()","206cde09":"np.unique(y,return_counts=True)","d83c081c":"X_train = X.reshape((-1,28,28,1))\nY_train = np_utils.to_categorical(y)\n\n\nprint(X_train.shape,Y_train.shape)","801ce291":"import matplotlib.pyplot as plt\nfor i in range(10):\n    plt.imshow(X_train[i].reshape(28,28),cmap = 'gray')\n    plt.show()","9b4beec3":"model = Sequential()\nmodel.add(Convolution2D(32,(3,3),activation='relu',input_shape = (28,28,1)))\nmodel.add(Convolution2D(64,(3,3),activation='relu'))\nmodel.add(Dropout(0.25))\nmodel.add(MaxPooling2D(2,2))\nmodel.add(Convolution2D(32,(5,5),activation='relu'))\nmodel.add(Convolution2D(8,(5,5),activation='relu'))\nmodel.add(Flatten())\nmodel.add(Dense(10,activation='softmax'))\nmodel.summary()","23123622":"model.compile(loss=\"categorical_crossentropy\",optimizer=\"adam\",metrics=[\"accuracy\"])","81ce8d99":"hist = model.fit(X_train,Y_train,epochs=10,batch_size=256,shuffle=True,validation_split=0.20)","6bfb3dd8":"plt.figure(0)\nplt.plot(hist.history['loss'],'g')\nplt.plot(hist.history['val_loss'],'b')\nplt.plot(hist.history['accuracy'],'r')\nplt.plot(hist.history['val_accuracy'],'black')\nplt.show()","9bb9d1ad":"### Data Preparation","067d7442":"### CNN"}}