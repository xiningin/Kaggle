{"cell_type":{"2ca66b36":"code","5a2089c1":"code","86fd5611":"code","6fa3f20a":"code","af44dc2f":"code","e5f6ce7a":"code","d2223a4e":"code","3226cfa1":"code","0462af36":"code","20ffaf76":"code","5da329c7":"code","626112e8":"code","3ac9dd72":"code","9733536f":"code","ddc368f5":"code","ac18f753":"code","f6abcb35":"code","74bfa5f6":"code","e309a494":"code","c42b3607":"code","fc7f2fcf":"markdown","235d56af":"markdown","3b7a6860":"markdown","bdaf05af":"markdown","d71474fa":"markdown","b4b0eedb":"markdown"},"source":{"2ca66b36":"import pandas as pd","5a2089c1":"train_data = pd.read_csv('..\/input\/titanic\/train.csv', index_col='PassengerId')\ntest_data = pd.read_csv('..\/input\/titanic\/test.csv', index_col='PassengerId')","86fd5611":"y = train_data['Survived'] # Setting target\ntrain_data.drop(['Survived'], axis=1, inplace=True) # Dropping target from features data","6fa3f20a":"numerical_cols = [col for col in train_data.columns\n                    if train_data[col].dtype in ['int64', 'float64']]\nprint(numerical_cols)","af44dc2f":"categorical_cols = [col for col in train_data.columns\n                        if train_data[col].dtype == 'object'\n                        and train_data[col].nunique() < 10]\nprint(categorical_cols)","e5f6ce7a":"# Selecting columns\nmy_cols = numerical_cols + categorical_cols\nX = train_data[my_cols]\nX_test = test_data[my_cols]","d2223a4e":"from sklearn.pipeline import Pipeline\nfrom sklearn.compose import ColumnTransformer\nfrom sklearn.preprocessing import OneHotEncoder\nfrom sklearn.impute import SimpleImputer","3226cfa1":"num_transformer = SimpleImputer()","0462af36":"cat_transformer = Pipeline(steps=[\n    ('imputer', SimpleImputer(strategy='most_frequent')),\n    ('onehot', OneHotEncoder(handle_unknown='ignore'))\n])","20ffaf76":"preprocessor = ColumnTransformer(\n    transformers=[\n        ('num', num_transformer, numerical_cols),\n        ('cat', cat_transformer, categorical_cols)\n    ])","5da329c7":"from sklearn.ensemble import RandomForestClassifier","626112e8":"model = RandomForestClassifier(n_estimators=50, max_features=6, n_jobs=4)","3ac9dd72":"my_pipeline = Pipeline(steps=[\n    ('preprocessor', preprocessor),\n    ('model', model)\n])","9733536f":"from sklearn.model_selection import cross_val_score","ddc368f5":"cv_scores = cross_val_score(my_pipeline, X, y, cv=5, scoring='accuracy', n_jobs=4)","ac18f753":"print('Mean Accuracy: {:.3f}'.format(cv_scores.mean()))","f6abcb35":"my_pipeline.fit(X, y)","74bfa5f6":"test_preds = my_pipeline.predict(X_test)","e309a494":"output = pd.DataFrame({\n    'PassengerId': X_test.index,\n    'Survived': test_preds\n})","c42b3607":"output.to_csv('submission.csv', index=False)","fc7f2fcf":"### Pipeline","235d56af":"### Training Model","3b7a6860":"### Test Predictions","bdaf05af":"### Preprocessors","d71474fa":"### Cross Validation","b4b0eedb":"### Model"}}