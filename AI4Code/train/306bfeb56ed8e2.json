{"cell_type":{"be61c4cc":"code","81249d9c":"code","76c44a2a":"code","47cb847b":"code","9cd1bd51":"code","1d07ae60":"code","e10d3548":"code","95ef6f0d":"code","93a9c3f9":"code","8b67b5ee":"code","e726a762":"code","6c36273b":"code","10c3af1d":"code","945f01cb":"code","fc795ce1":"code","c90055ed":"code","a608e7a8":"code","9bd40241":"code","785f6235":"code","a3d01e36":"code","1ec9ef28":"code","7ba1a908":"code","0a09d1f0":"code","386decb0":"code","a4df9f86":"code","3b5b3305":"code","a697f23a":"code","ce1242e1":"code","dfac36b8":"code","d05547a9":"code","0c6fef39":"code","bd58e80f":"code","e0501ca1":"code","6d6a9668":"code","87137dfc":"code","38683e6c":"code","97110597":"code","66a6467f":"code","e885fa9a":"code","ba36cc18":"code","ce7c98f9":"code","4e39b51a":"code","ab484638":"markdown","f57fd597":"markdown","ddcae757":"markdown","ef206cad":"markdown","1d6ddee1":"markdown","fe897261":"markdown","c91934aa":"markdown","68ea6e3c":"markdown","61d57fbd":"markdown"},"source":{"be61c4cc":"pip install langdetect","81249d9c":"pip install vaderSentiment","76c44a2a":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport plotly.express as px\nfrom langdetect import detect\nfrom sklearn.decomposition import PCA\nimport nltk\n# from nltk.sentiment.vader import SentimentIntensityAnalyzer\nfrom vaderSentiment.vaderSentiment import SentimentIntensityAnalyzer\n%matplotlib inline\nfrom IPython.display import Image\nimport array\nimport tensorflow as tf\nfrom tensorflow import keras\nfrom tensorflow.keras.models import Sequential\nfrom tensorflow.keras.layers import Activation, Dense\nfrom tensorflow.keras.optimizers import Adam\nfrom tensorflow.keras.metrics import categorical_crossentropy","47cb847b":"df_reviews = pd.read_csv('..\/input\/airbnbla\/reviews.csv')\ndf_listings = pd.read_csv('..\/input\/airbnbla\/listings.csv')\n","9cd1bd51":"df_reviews.dtypes\n","1d07ae60":"df_listings.dtypes","e10d3548":"df_reviews['id'].isin(df_listings['id']).value_counts()\n","95ef6f0d":"df = pd.merge(df_reviews, df_listings[['id', 'review_scores_rating']], \n              left_on='listing_id', right_on='id')\n\n# df = pd.merge(df_reviews, df_listings[['id', 'review_scores_rating']],\n              #on='id')","93a9c3f9":"df","8b67b5ee":"df= df.truncate(after=1000)\n\n# a fun\u00e7\u00e3o sample poderia ter sido usada - d\u00e1 amostra aleatoria, em vez de truncar os primeiros","e726a762":"df","6c36273b":"del df[\"reviewer_name\"]\ndel df[\"reviewer_id\"]\ndel df[\"date\"]\ndel df[\"id_x\"]\ndel df[\"id_y\"]\ndel df[\"listing_id\"]","10c3af1d":"# Missing Value Evaluation\ndf.isnull().sum()","945f01cb":"#Dropping the records with comments missing in reviews dataframe.\ndf = df [~df.comments.isnull()].copy()\n\n#Checking the missing values in the dataset after treatment.\ndf.isnull().sum()","fc795ce1":"def language_detection(text):\n    try:\n        return detect(text)\n    except:\n        return None\n    \ndef language_count(x):\n    return df.language.value_counts().head(x)","c90055ed":"# Leva uma 1 hora 16 min para rodar se usar o dataset inteiro!!\n# %%time\ndf['language'] =df['comments'].apply(language_detection)","a608e7a8":"# df_reviews = pd.read_csv('..\/input\/airbnbla\/Reviews_file_name.csv')\n","9bd40241":"language_count(int ('50'))","785f6235":"# df.language.value_counts().head(50)","a3d01e36":"df","1ec9ef28":"# df_reviews.to_csv ('.\/df_reviews_nova.csv')# para salvar o dataframe e n\u00e3o perder o material processado","7ba1a908":"# Retirar os coment\u00e1rios em todas as linguas que n\u00e3o sejam o Ingl\u00eas, que corresponde por 93% das reviews, quase 1 milh\u00e3o\ndf=df[df.language == 'en']","0a09d1f0":"df.language.value_counts().head(50)","386decb0":"analyzer = SentimentIntensityAnalyzer()","a4df9f86":"def compound_score(text):\n    compound_value = analyzer.polarity_scores(text)['compound']\n    return compound_value","3b5b3305":"df['sentiment_compound'] = df['comments'].apply(compound_score)","a697f23a":"df","ce1242e1":"df= df[['sentiment_compound', 'review_scores_rating']]","dfac36b8":"df\n","d05547a9":"df[~df.sentiment_compound.isnull()].copy()\n# Checking the missing values in the dataset after treatment.\n# Checking the missing values in the dataset after treatment.\ndf.isnull().sum()","0c6fef39":"df","bd58e80f":"sentiment= df[['sentiment_compound']]\nsentiment","e0501ca1":"score=df[['review_scores_rating']]\nscore","6d6a9668":"x_sentiment_array=sentiment.to_numpy()\n#print(x_sentiment_array)","87137dfc":"y_score_array=score.to_numpy()\n#print(y_score_array)","38683e6c":"model = Sequential([\n    Dense(units=16, input_shape=(1,), activation='relu'),\n    Dense(units=32, activation='relu'),\n    Dense(units=10, activation='softmax')\n])","97110597":"model.compile(optimizer=Adam(learning_rate=0.0001), loss='sparse_categorical_crossentropy', metrics=['accuracy'])","66a6467f":"train_labels = df.y_score_array\ntrain_samples = df.x_sentiment_array","e885fa9a":"from sklearn.utils import shuffle\nfrom sklearn.preprocessing import MinMaxScaler","ba36cc18":"scaler = MinMaxScaler(feature_range=(0,1))\nscaled_train_samples = scaler.fit_transform(train_samples.reshape(-1,1))","ce7c98f9":"#scaled_train_samples = train_samples","4e39b51a":"#model.fit(x=scaled_train_samples, y=train_labels, batch_size=10, epochs=30, verbose=2)","ab484638":"![IMG_8334_Squeezed.jpg](attachment:1f724c67-e645-46b8-aec5-8da3ee01f275.jpg)","f57fd597":"## Data Treatment","ddcae757":"## Sentiment Data Analysis\n#### Introductory Data Science Course Practice - Airbnb Dataset - Los Angeles Data as of april 26, 2021.\n*http:\/\/insideairbnb.com\/get-the-data.html*","ef206cad":"## Code","1d6ddee1":"## An\u00e1lise de Sentimentos","fe897261":"## Imports","c91934aa":"#### Comments in 46 languages were detected. English=93%","68ea6e3c":"## Terminar essa parte:","61d57fbd":"#### Language Detection"}}