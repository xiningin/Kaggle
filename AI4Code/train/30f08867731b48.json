{"cell_type":{"b377f427":"code","b1ce494f":"code","b0664047":"code","7ab558cd":"code","a872c221":"code","ffdc4b12":"code","a94ac2c4":"markdown"},"source":{"b377f427":"import numpy as np\nimport pandas as pd\nimport os\nimport matplotlib.pyplot as plt\nfrom tqdm import tqdm\nfrom random import sample\nimport cv2","b1ce494f":"from tensorflow import keras \nfrom tensorflow.keras.models import load_model","b0664047":"model = load_model(\"..\/input\/pawpularity-aug\/efnetb7_1.h5\",compile=False)","7ab558cd":"testpath = \"..\/input\/petfinder-pawpularity-score\/test\/\"\nids = [t.split(\".\")[0] for t in os.listdir(testpath)]\n\n\n###for batch wise conversion\n# batch_size=200\n# y_pred=np.zeros((len(ids),1))\n# for i in range(0,len(ids)\/\/batch_size):\n#     images = np.array([cv2.cvtColor(cv2.resize(cv2.imread(testpath+image+\".jpg\"),(224,224)),cv2.COLOR_BGR2RGB) for image in ids[batch_size*i:batch_size*(i+1)]])\n#     y_pred[i*batch_size:(i+1)*batch_size] = model.predict(images)*100\nimages = np.array([cv2.cvtColor(cv2.resize(cv2.imread(testpath+image+\".jpg\"),(224,224)),cv2.COLOR_BGR2RGB) for image in ids])\ny_pred = model.predict(images)*100\n\nround2 = lambda x,y=None:round(x+1e-15,y)\ny_pred = [round2(t[0],2) for t in y_pred]","a872c221":"df = pd.DataFrame()\ndf[\"Id\"] = ids\ndf[\"Pawpularity\"] = y_pred\ndf.to_csv(\"submission.csv\",index=False)","ffdc4b12":"df.head()","a94ac2c4":"## INFERENCE NOTEBOOOK \n\nINFERENCE NOTEBOOK FOR THE KERAS CODE - https:\/\/www.kaggle.com\/bhavesjain\/pawpularity-aug\n"}}