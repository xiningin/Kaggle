{"cell_type":{"9c6ed0ac":"code","5ac1a5a1":"code","8ecde4d4":"code","a1973c9b":"code","5c62227b":"code","e6c8a64a":"code","ac95bc42":"code","8dcc2e8c":"code","bde0f156":"code","6d29637a":"code","77449c47":"code","ed7c9ff7":"code","598711bd":"code","5025219b":"code","aaa62c65":"code","557c06a7":"code","d7a6eb41":"code","2b985893":"code","64c38cc0":"markdown","2cc2f5b1":"markdown","178c39c3":"markdown","28bd1c8c":"markdown","453be8a4":"markdown"},"source":{"9c6ed0ac":"import os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","5ac1a5a1":"import h2o\nimport pandas as pd\nimport numpy as np\nfrom h2o.estimators.glm import H2OGeneralizedLinearEstimator","8ecde4d4":"h2o.init()","a1973c9b":"df = h2o.import_file(\"..\/input\/santander-customer-satisfaction\/train.csv\")\ndf.summary()","5c62227b":"df.col_names","e6c8a64a":"y = 'TARGET'\nx = df.col_names\nx.remove(y)\nx.remove('ID')","ac95bc42":"print(\"Response = \" + y)\nprint(\"Pridictors = \" + str(x))","8dcc2e8c":"df['TARGET'] = df['TARGET'].asfactor()\ndf['TARGET'].levels()","bde0f156":"train, test = df.split_frame(ratios=[.7],seed = 2019)\nprint(df.shape)\nprint(train.shape)\n#print(valid.shape)\nprint(test.shape)","6d29637a":"glm_logistic = H2OGeneralizedLinearEstimator(family = \"binomial\")","77449c47":"glm_logistic.train(x=x, y= y, training_frame=train, \n                   validation_frame=test, model_id=\"glm_logistic\")\n","ed7c9ff7":"print(glm_logistic.confusion_matrix() )\nprint(glm_logistic.auc())\nprint(glm_logistic.varimp_plot())","598711bd":"df_test_pd = pd.read_csv('..\/input\/santander-customer-satisfaction\/test.csv')","5025219b":"df_test = h2o.H2OFrame(df_test_pd)\ndf_test.col_names","aaa62c65":"x_test = df_test.col_names.remove('ID')\ny_pred = glm_logistic.predict(test_data=df_test)\ny_pred_df = y_pred.as_data_frame()","557c06a7":"p1 = y_pred_df[\"p1\"]\nid = df_test_pd[\"ID\"]","d7a6eb41":"h2o.cluster().shutdown()","2b985893":"submit = pd.DataFrame({'ID':id, 'TARGET':p1})\nsubmit.to_csv(\"submit_h2o_glm.csv\",index=False)","64c38cc0":"### Import test dataset","2cc2f5b1":"### Import train dataset","178c39c3":"### Initialize h2o","28bd1c8c":"### Shutdown h2o","453be8a4":"## Santander Customer Satisfaction Solution using h2o"}}