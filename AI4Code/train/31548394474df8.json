{"cell_type":{"b2ef687d":"code","68bc07f1":"code","f0896629":"code","93b703ae":"code","89add4d5":"code","659d68fa":"code","992d9172":"code","58ecde7c":"code","1ae05f68":"code","0379b94f":"code","b28eea3a":"code","def9cc97":"code","a4e89979":"code","718a5029":"code","94eed9aa":"code","57cd2a41":"code","367e803d":"code","72eff792":"code","cadecfda":"code","605bd943":"code","11ca89a5":"code","98be7e97":"code","6b85ca93":"code","1c108500":"code","24ab1f59":"code","7dc8bb22":"code","54f98312":"code","f1148646":"code","0298ca7c":"code","6878c520":"code","07894f74":"code","e75a0868":"code","b044ba20":"code","74b6780c":"code","64125af9":"code","1d8c0956":"code","6f31935f":"code","2dd1e1f0":"code","35dfb458":"code","d285f869":"code","f917b965":"code","58d8125b":"code","0d2f0b97":"code","db7d7308":"code","e1537868":"code","f6df6fcd":"code","9102b82a":"code","6831a643":"code","79d33ab3":"code","3f75dbec":"code","9eacfc57":"code","77b7b689":"code","43c297f0":"markdown","533021bc":"markdown","baa38be2":"markdown","decb9cd5":"markdown","d33b12e0":"markdown","fd56ef62":"markdown","ab358e21":"markdown","2d24ae47":"markdown","63b0228e":"markdown","cf640fec":"markdown","a131f07c":"markdown","64608f67":"markdown","d4a1fe4a":"markdown","c97e9356":"markdown","71918c78":"markdown","3d284cf1":"markdown","04e33bfe":"markdown","55bda197":"markdown","de1c62eb":"markdown","0103bfab":"markdown","6d99981d":"markdown","da1d4b18":"markdown","2d9da899":"markdown","d8f1cb43":"markdown","fdb1617e":"markdown","2b318bd0":"markdown","fca42ad0":"markdown","cb17aabd":"markdown","0e929d4a":"markdown","f38d3662":"markdown","6c01c99a":"markdown","c1c7a2ac":"markdown","dda916ab":"markdown","9fe7c6bd":"markdown","4f6ef446":"markdown","5c3d09e6":"markdown","63f7b6be":"markdown","a6f4487c":"markdown","a3fe8553":"markdown","ec419c60":"markdown","e10c077d":"markdown","734a819f":"markdown","f24fba8c":"markdown","61b2c88a":"markdown"},"source":{"b2ef687d":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport re\n\nfrom pathlib import Path\nfrom sklearn.preprocessing import MinMaxScaler,StandardScaler\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.svm import LinearSVC\n\nimport warnings\nwarnings.filterwarnings(\"ignore\")","68bc07f1":"path = Path('\/kaggle\/input\/nfl-big-data-bowl-2021')\ndf_games = pd.read_csv(path\/'games.csv')\ndf_players = pd.read_csv(path\/'players.csv')\ndf_plays = pd.read_csv(path\/'plays.csv')\ndf_week1 = pd.read_csv(path\/'week1.csv')","f0896629":"df_games.visitorTeamAbbr.sort_values().unique() == df_games.homeTeamAbbr.sort_values().unique()","93b703ae":"team_names = df_games.visitorTeamAbbr.sort_values().unique()\ndf_teams = pd.DataFrame(team_names,columns=['team'])","89add4d5":"df_teams['wins'] = 0\ndf_teams['score'] = 0","659d68fa":"#creating columns for the offence formation\ndf_teams['I_FORM'] = 0\ndf_teams['SINGLEBACK'] = 0\ndf_teams['SHOTGUN'] = 0\ndf_teams['EMPTY'] = 0\ndf_teams['PISTOL'] = 0\ndf_teams['WILDCAT'] = 0\ndf_teams['JUMBO'] = 0","992d9172":"for index,game in df_games.iterrows():\n    home_team = game.homeTeamAbbr\n    visitor_team = game.visitorTeamAbbr\n    home_team_index = df_teams[df_teams.team == home_team].index\n    visitor_team_index = df_teams[df_teams.team == visitor_team].index\n    #total score and index\n    home_score = df_plays[df_plays.gameId == game.gameId].preSnapHomeScore.max()\n    visitor_score = df_plays[df_plays.gameId == game.gameId].preSnapVisitorScore.max()\n    if home_score > visitor_score:\n        total_wins = df_teams[df_teams.team == home_team].wins.values\n        df_teams['wins'][home_team_index] = total_wins + 1\n    elif visitor_score > home_score:\n        total_wins = df_teams[df_teams.team == visitor_team].wins.values\n        df_teams['wins'][visitor_team_index] = total_wins + 1\n    else:\n        pass\n    total_home_score = df_teams[df_teams.team == home_team].score.values\n    total_visiter_score = df_teams[df_teams.team == visitor_team].score.values\n    df_teams['score'][home_team_index] = total_home_score + home_score\n    df_teams['score'][visitor_team_index] = total_visiter_score + visitor_score\n    #offence\n    ht_offence = df_plays[(df_plays.gameId == game.gameId) & (df_plays.possessionTeam == home_team)].offenseFormation.value_counts()\n    vt_offence = df_plays[(df_plays.gameId == game.gameId) & (df_plays.possessionTeam == visitor_team)].offenseFormation.value_counts()\n    ht_offence_dict = ht_offence.to_dict()\n    for k,v in ht_offence_dict.items():\n        total_of = df_teams[df_teams.team == home_team][k].values\n        df_teams[k][home_team_index] = total_of + v\n    vt_offence_dict = vt_offence.to_dict()\n    for k,v in vt_offence_dict.items():\n        total_of = df_teams[df_teams.team == visitor_team][k].values\n        df_teams[k][visitor_team_index] = total_of + v","58ecde7c":"df_teams.sort_values(by='score', ascending=False)","1ae05f68":"df_offence_persd = df_plays.groupby('offenseFormation')['personnelD'].value_counts()\ndf_offence_defbox = df_plays.groupby('offenseFormation')['defendersInTheBox'].value_counts()","0379b94f":"df_offence_persd['EMPTY'].head(7),df_offence_defbox['EMPTY'].sort_values(ascending=False).head(4)","b28eea3a":"df_offence_persd['I_FORM'].head(6),df_offence_defbox['I_FORM'].sort_values(ascending=False).head(5)","def9cc97":"df_offence_persd['SINGLEBACK'].head(5),df_offence_defbox['SINGLEBACK'].sort_values(ascending=False).head(5)","a4e89979":"df_offence_persd['SHOTGUN'].head(7),df_offence_defbox['SHOTGUN'].sort_values(ascending=False).head(5)","718a5029":"df_offence_persd['PISTOL'].head(7),df_offence_defbox['PISTOL'].sort_values(ascending=False).head(4)","94eed9aa":"df_offence_persd['WILDCAT'].head(4),df_offence_defbox['WILDCAT'].sort_values(ascending=False).head(3)","57cd2a41":"df_offence_persd['JUMBO'].head(8),df_offence_defbox['JUMBO'].sort_values(ascending=False).head(4)","367e803d":"df_formation_counts = df_plays.offenseFormation.value_counts().to_frame()\ndf_formation_counts.plot(kind='bar',title='Offence Formations')","72eff792":"df_offence_perso = df_plays.groupby('offenseFormation')['personnelO'].value_counts()\ndf_offence_rushers = df_plays.groupby('offenseFormation')['numberOfPassRushers'].value_counts()","cadecfda":"df_offence_perso['I_FORM'].head(7),df_offence_rushers['I_FORM'].sort_values(ascending=False).head(6)","605bd943":"df_offence_perso['SINGLEBACK'].head(5),df_offence_rushers['SINGLEBACK'].sort_values(ascending=False).head(5)","11ca89a5":"df_offence_perso['SHOTGUN'].head(5),df_offence_rushers['SHOTGUN'].sort_values(ascending=False).head(6)","98be7e97":"df_offence_perso['EMPTY'].head(6),df_offence_rushers['EMPTY'].sort_values(ascending=False).head(5)","6b85ca93":"df_offence_perso['PISTOL'].head(4),df_offence_rushers['PISTOL'].sort_values(ascending=False).head(4)","1c108500":"df_offence_perso['WILDCAT'],df_offence_rushers['WILDCAT'].sort_values(ascending=False).head(3)","24ab1f59":"df_offence_perso['JUMBO'].head(7),df_offence_rushers['JUMBO'].sort_values(ascending=False).head(4)","7dc8bb22":"    df_dropback = df_plays.typeDropback.value_counts().reset_index()","54f98312":"sns.catplot(data=df_dropback,x='typeDropback',y='index',kind='bar',palette=\"viridis\")\nplt.title('dropback type')","f1148646":"df_penalties = df_plays.penaltyCodes.value_counts().head(10).reset_index()\nsns.catplot(data=df_penalties,x='penaltyCodes',y='index',kind='bar',palette=\"magma\")\nplt.title('top penalties')","0298ca7c":"def get_teams(players):\n    away_team = []\n    home_team = []\n    for k,v in players.index:\n        if k == 'away':\n            away_team.append(v)\n        elif k == 'home':\n            home_team.append(v)\n        else:\n            pass\n    return away_team,home_team","6878c520":"def plot_play(gameid,playid,df_week):\n    players = df_week[(df_week.playId == playid) & (df_week.gameId == gameid)].groupby('team')['nflId'].value_counts()\n    away_team,home_team = get_teams(players)\n    plt.figure(figsize=(12,6))\n    plt.xlim(0,120)\n    plt.ylim(0,53.3)\n    for at in away_team:\n        df = pd.DataFrame(df_week[(df_week.playId == playid) & (df_week.gameId == gameid) & (df_week.nflId == at)]['x'])\n        df['y'] = df_week[(df_week.playId == playid) & (df_week.gameId == gameid) & (df_week.nflId == at)]['y']\n        df.reset_index()\n        plt.scatter(df.iloc[0]['x'],df.iloc[0]['y'],c='r')\n        plt.plot('x','y',data=df,c='r')\n    for ht in home_team:\n        df = pd.DataFrame(df_week[(df_week.playId == playid) & (df_week.gameId == gameid) & (df_week.nflId == ht)]['x'])\n        df['y'] = df_week[(df_week.playId == playid) & (df_week.gameId == gameid) & (df_week.nflId == ht)]['y']\n        df.reset_index()\n        plt.scatter(df.iloc[0]['x'],df.iloc[0]['y'],c='b')\n        plt.plot('x','y',data=df,c='b')\n    dfball = pd.DataFrame(df_week[(df_week.playId == playid) & (df_week.gameId == gameid) & (df_week.displayName == 'Football')]['x'])\n    dfball['y'] = df_week[(df_week.playId == playid) & (df_week.gameId == gameid) & (df_week.displayName == 'Football')]['y']\n    dfball.reset_index()\n    plt.scatter(dfball.iloc[0]['x'],dfball.iloc[0]['y'],c='g')\n    plt.plot('x','y',data=dfball,c='g',alpha=0.8,ls='dashed')\n    plt.show()","07894f74":"plot_play(2018090909,2430,df_week1)","e75a0868":"df_week16 = pd.read_csv(path\/'week16.csv')","b044ba20":"df_plays.iloc[19237].playDescription\nplot_play(2018122201,1719,df_week16)","74b6780c":"plt.figure(figsize=(12,6))\nplt.xlim(67.5,77.5)\nplt.ylim(17.5,27.5)\n#\ndf1 = pd.DataFrame(df_week16[(df_week16.gameId == 2018122201) & (df_week16.playId == 1719) & (df_week16.displayName == 'Keenan Allen') & (df_week16.frameId > 35) & (df_week16.frameId < 40)]['x'])\ndf1['y'] = df_week16[(df_week16.gameId == 2018122201) & (df_week16.playId == 1719) & (df_week16.displayName == 'Keenan Allen') & (df_week16.frameId > 35) & (df_week16.frameId < 40)]['y']\ndf1.reset_index()\nplt.scatter(df1.iloc[0]['x'],df1.iloc[0]['y'],c='b')\nplt.plot('x','y',data=df1,c='b')\n#\ndf2 = pd.DataFrame(df_week16[(df_week16.gameId == 2018122201) & (df_week16.playId == 1719) & (df_week16.displayName == 'Tony Jefferson') & (df_week16.frameId > 35) & (df_week16.frameId < 40)]['x'])\ndf2['y'] = df_week16[(df_week16.gameId == 2018122201) & (df_week16.playId == 1719) & (df_week16.displayName == 'Tony Jefferson') & (df_week16.frameId > 35) & (df_week16.frameId < 40)]['y']\ndf2.reset_index()\nplt.scatter(df2.iloc[0]['x'],df2.iloc[0]['y'],c='r')\nplt.plot('x','y',data=df2,c='r')\n#\ndfb = pd.DataFrame(df_week16[(df_week16.gameId == 2018122201) & (df_week16.playId == 1719) & (df_week16.displayName == 'Football') & (df_week16.frameId > 35) & (df_week16.frameId < 40)]['x'])\ndfb['y'] = df_week16[(df_week16.gameId == 2018122201) & (df_week16.playId == 1719) & (df_week16.displayName == 'Football') & (df_week16.frameId > 35) & (df_week16.frameId < 40)]['y']\ndfb.reset_index()\nplt.scatter(dfb.iloc[0]['x'],dfb.iloc[0]['y'],c='g')\nplt.plot('x','y',data=dfb,c='g',alpha=0.8,ls='dashed')","64125af9":"# getting full list of games and plays with DPI\ndf_week1_plays_ = pd.DataFrame(df_plays[df_plays.penaltyCodes == 'DPI'].groupby('gameId')['playId'].unique())","1d8c0956":"unique_games_week1 = df_week1.gameId.unique()","6f31935f":"#i need a function to filter last names of players, don't see other way to get them in a case i query the data\ndef last_name_filter(desc):\n    result = []\n    result_2 = []\n    str1 = str(desc)\n    re1 = re.compile(r'([A-Z]([a-z]+)?\\.[A-Z][a-z]+)')\n    s1 = re1.findall(str1)\n    for f in s1[1:]:\n        str2 = str(f)\n        re2 = re.compile(r'(\\.[A-Z][a-z]+)')\n        s2 = re2.findall(str2)\n        result.append(s2[0])\n    for d in result:\n        re3 = re.compile(r'([A-Z][a-z]+)')\n        str3 = str(d)\n        s3 = re3.findall(str3)\n        result_2.append(s3[0])\n    return result_2","2dd1e1f0":"df_dpi = pd.DataFrame(columns=['p1p2x','p1p2y','p1bx','p1by','p2bx','p2by','pl1speed','pl2speed','bspeed','dpi'])","35dfb458":"#creating main function to query data with DPI\n#finding 'pass outcome incomplete' frame id\n#we need just last 3-5 frames before that (feel free to experiment with more\\less frames tho)\ndef dpi_positive(game_id_dpi):\n    global df_dpi\n    try:\n        play_dpi_id_list = df_week1_plays_.loc[game_id_dpi]['playId']\n        for k in play_dpi_id_list:\n            play_dpi_id = int(k)\n            frameId_num = df_week1[(df_week1.gameId == game_id_dpi) & (df_week1.playId == play_dpi_id) & (df_week1.event == 'pass_outcome_incomplete')].frameId.mean()\n            description = df_plays[(df_plays.gameId == game_id_dpi) & (df_plays.playId == play_dpi_id) & (df_plays.penaltyCodes == 'DPI')]['playDescription'].values\n            lnf = last_name_filter(description)\n            if len(lnf) < 2 or len(lnf) > 2:\n                pass\n            pl1x = df_week1[(df_week1.gameId == game_id_dpi) & (df_week1.playId == play_dpi_id) & (df_week1.displayName.str.endswith(lnf[0])) & (df_week1.frameId > (frameId_num-4)) & (df_week1.frameId < frameId_num)]['x'].mean()\n            pl1y = df_week1[(df_week1.gameId == game_id_dpi) & (df_week1.playId == play_dpi_id) & (df_week1.displayName.str.endswith(lnf[0])) & (df_week1.frameId > (frameId_num-4)) & (df_week1.frameId < frameId_num)]['y'].mean()\n            pl1speed = df_week1[(df_week1.gameId == game_id_dpi) & (df_week1.playId == play_dpi_id) & (df_week1.displayName.str.endswith(lnf[0])) & (df_week1.frameId > (frameId_num-4)) & (df_week1.frameId < frameId_num)]['s'].mean()\n            pl2x = df_week1[(df_week1.gameId == game_id_dpi) & (df_week1.playId == play_dpi_id) & (df_week1.displayName.str.endswith(lnf[1])) & (df_week1.frameId > (frameId_num-4)) & (df_week1.frameId < frameId_num)]['x'].mean()\n            pl2y = df_week1[(df_week1.gameId == game_id_dpi) & (df_week1.playId == play_dpi_id) & (df_week1.displayName.str.endswith(lnf[1])) & (df_week1.frameId > (frameId_num-4)) & (df_week1.frameId < frameId_num)]['y'].mean()\n            pl2speed = df_week1[(df_week1.gameId == game_id_dpi) & (df_week1.playId == play_dpi_id) & (df_week1.displayName.str.endswith(lnf[1])) & (df_week1.frameId > (frameId_num-4)) & (df_week1.frameId < frameId_num)]['s'].mean()\n            bx = df_week1[(df_week1.gameId == game_id_dpi) & (df_week1.playId == play_dpi_id) & (df_week1.displayName.str.endswith('Football')) & (df_week1.frameId > (frameId_num-4)) & (df_week1.frameId < frameId_num)]['x'].mean()\n            by = df_week1[(df_week1.gameId == game_id_dpi) & (df_week1.playId == play_dpi_id) & (df_week1.displayName.str.endswith('Football')) & (df_week1.frameId > (frameId_num-4)) & (df_week1.frameId < frameId_num)]['y'].mean()\n            bspeed = df_week1[(df_week1.gameId == game_id_dpi) & (df_week1.playId == play_dpi_id) & (df_week1.displayName.str.endswith('Football')) & (df_week1.frameId > (frameId_num-4)) & (df_week1.frameId < frameId_num)]['s'].mean()\n            p1p2x = abs(pl1x - pl2x)\n            p1p2y = abs(pl1y - pl2y)\n            p1bx = abs(pl1x - bx)\n            p1by = abs(pl1y - by)\n            p2bx = abs(pl2x - bx)\n            p2by = abs(pl2y - by)\n            dpi = 1\n            new_row = {'p1p2x':p1p2x,'p1p2y':p1p2y,'p1bx':p1bx,'p1by':p1by,'p2bx':p2bx,'p2by':p2by,'pl1speed':pl1speed,'pl2speed':pl2speed,'bspeed':bspeed,'dpi':dpi}\n            df_dpi = df_dpi.append(new_row,ignore_index=True)\n    except:\n        pass","d285f869":"for game in unique_games_week1:\n    dpi_positive(game)","f917b965":"df_dpi.drop(df_dpi.index[14:],inplace=True)","58d8125b":"#that's our data with DPI\ndf_dpi.sample(5)","0d2f0b97":"df_dpi_NEG = pd.DataFrame(columns=['p1p2x','p1p2y','p1bx','p1by','p2bx','p2by','pl1speed','pl2speed','bspeed','dpi'])","db7d7308":"def dpi_NEG(game_id_dpi):\n    global df_dpi_NEG\n    try:\n        play_dpi_id_list = df_week1_plays_.loc[game_id_dpi]['playId']\n        for k in play_dpi_id_list:\n            play_dpi_id = int(k)\n            min1 = df_week1[(df_week1.gameId == game_id_dpi) & (df_week1.playId == play_dpi_id)].frameId.min()\n            max1 = df_week1[(df_week1.gameId == game_id_dpi) & (df_week1.playId == play_dpi_id)].frameId.max()\n            frameId_num = (min1 + max1)\/2\n            lnf = []\n            lnf.append(df_week1[(df_week1.gameId == game_id_dpi) & (df_week1.playId == play_dpi_id) & (df_week1.team == 'home')]['displayName'].head(1).item())\n            lnf.append(df_week1[(df_week1.gameId == game_id_dpi) & (df_week1.playId == play_dpi_id) & (df_week1.team == 'away')]['displayName'].head(1).item())\n            if len(lnf) < 2 or len(lnf) > 2:\n                pass\n            pl1x = df_week1[(df_week1.gameId == game_id_dpi) & (df_week1.playId == play_dpi_id) & (df_week1.displayName.str.endswith(lnf[0])) & (df_week1.frameId > (frameId_num-4)) & (df_week1.frameId < frameId_num)]['x'].mean()\n            pl1y = df_week1[(df_week1.gameId == game_id_dpi) & (df_week1.playId == play_dpi_id) & (df_week1.displayName.str.endswith(lnf[0])) & (df_week1.frameId > (frameId_num-4)) & (df_week1.frameId < frameId_num)]['y'].mean()\n            pl1speed = df_week1[(df_week1.gameId == game_id_dpi) & (df_week1.playId == play_dpi_id) & (df_week1.displayName.str.endswith(lnf[0])) & (df_week1.frameId > (frameId_num-4)) & (df_week1.frameId < frameId_num)]['s'].mean()\n            pl2x = df_week1[(df_week1.gameId == game_id_dpi) & (df_week1.playId == play_dpi_id) & (df_week1.displayName.str.endswith(lnf[1])) & (df_week1.frameId > (frameId_num-4)) & (df_week1.frameId < frameId_num)]['x'].mean()\n            pl2y = df_week1[(df_week1.gameId == game_id_dpi) & (df_week1.playId == play_dpi_id) & (df_week1.displayName.str.endswith(lnf[1])) & (df_week1.frameId > (frameId_num-4)) & (df_week1.frameId < frameId_num)]['y'].mean()\n            pl2speed = df_week1[(df_week1.gameId == game_id_dpi) & (df_week1.playId == play_dpi_id) & (df_week1.displayName.str.endswith(lnf[1])) & (df_week1.frameId > (frameId_num-4)) & (df_week1.frameId < frameId_num)]['s'].mean()\n            bx = df_week1[(df_week1.gameId == game_id_dpi) & (df_week1.playId == play_dpi_id) & (df_week1.displayName.str.endswith('Football')) & (df_week1.frameId > (frameId_num-4)) & (df_week1.frameId < frameId_num)]['x'].mean()\n            by = df_week1[(df_week1.gameId == game_id_dpi) & (df_week1.playId == play_dpi_id) & (df_week1.displayName.str.endswith('Football')) & (df_week1.frameId > (frameId_num-4)) & (df_week1.frameId < frameId_num)]['y'].mean()\n            bspeed = df_week1[(df_week1.gameId == game_id_dpi) & (df_week1.playId == play_dpi_id) & (df_week1.displayName.str.endswith('Football')) & (df_week1.frameId > (frameId_num-4)) & (df_week1.frameId < frameId_num)]['s'].mean()\n            p1p2x = abs(pl1x - pl2x)\n            p1p2y = abs(pl1y - pl2y)\n            p1bx = abs(pl1x - bx)\n            p1by = abs(pl1y - by)\n            p2bx = abs(pl2x - bx)\n            p2by = abs(pl2y - by)\n            dpi = 0\n            new_row = {'p1p2x':p1p2x,'p1p2y':p1p2y,'p1bx':p1bx,'p1by':p1by,'p2bx':p2bx,'p2by':p2by,'pl1speed':pl1speed,'pl2speed':pl2speed,'bspeed':bspeed,'dpi':dpi}\n            df_dpi_NEG = df_dpi_NEG.append(new_row,ignore_index=True)\n    except:\n        pass","e1537868":"for game in unique_games_week1:\n    dpi_NEG(game)","f6df6fcd":"df_dpi_NEG.sample(5)","9102b82a":"frames = [df_dpi,df_dpi_NEG]\ndf = pd.concat(frames)","6831a643":"scaler = StandardScaler()\ndf[['p1p2x','p1p2y','p1bx','p1by','p2bx','p2by','pl1speed','pl2speed','bspeed']] = scaler.fit_transform(df[['p1p2x','p1p2y','p1bx','p1by','p2bx','p2by','pl1speed','pl2speed','bspeed']])","79d33ab3":"df.sample(5)","3f75dbec":"df.reset_index(inplace=True)\nX = df.drop(['dpi'],axis=1)\ny = df['dpi']","9eacfc57":"X_train,X_test,y_train,y_test = train_test_split(X,y,test_size=0.4,random_state=5)","77b7b689":"model = LinearSVC()\nmodel.fit(X_train,y_train)\nmodel.score(X_test,y_test)","43c297f0":"**recommended team composition with PISTOL formation**","533021bc":"That's a lot of dataframes . i'll skip standard NaN\\null , values check ,implying anyone who is looking this notebook is familiar with data.\n\nFirst of all, i want to make new dataframe with high score\\low score brackets to get the idea about team composition","baa38be2":"**recommended team composition with EMPTY formation**","decb9cd5":"**creating dataframe for the DPI data**","d33b12e0":"**Feature scaling**","fd56ef62":"**recommended team composition with WILDCAT formation**","ab358e21":"**DPI PRIME EXAMPLE**","2d24ae47":"**defence against EMPTY fromation**","63b0228e":"**recommended team composition with JUMBO formation**","cf640fec":"<a id=\"ten\"><\/a>\n# model score","a131f07c":"**defence against WILDCAT formation**","64608f67":"* 'p1p2x' - distance between players by X\n* 'p1p2y' - distance between players by y\n* 'p1bx'  - distance between player 1 and a ball by X\n* 'p1by'  - distance between player 1 and a ball by y\n* 'p2bx'  - distance between player 2 and a ball by X\n* 'p2by'  - distance between player 2 and a ball by y\n* 'pl1speed' - speed of player1\n* 'pl2speed' - speed of player2\n* 'bspeed'   - speed of the ball\n* 'dpi'      - dpi occurrence","d4a1fe4a":"We have a data about dropbacks, it's literally asking to be plotted","c97e9356":"<a id=\"three\"><\/a>\n# Most popular offence formations and team composition","71918c78":"if you facing offence formation and happend to have no idea what defence pattern is more preferable.\nUse this data to begin with. Also helps to get the idea what defence pattern you could be facing otherwise","3d284cf1":"**defence against I_FORM formation**","04e33bfe":"<a id=\"eight\"><\/a>\n# DATA PREPARATION","55bda197":"<a id=\"eleven\"><\/a>\n# conclusion","de1c62eb":"<a id=\"nine\"><\/a>\n# Model creation","0103bfab":"this is made for demonstration purpose , and i want to work with one week only due to computqation\\time limits.\n\nBut that should be enough to get the idea","6d99981d":"With the last 3 frames per player\\ball we can determine with decent success (0.916 score) is there any DPI threat, before ball lands or DPI happends.\n\nDue to time\\cumputation limits i was carelessly pickig data. But with real task you should consider going though all played weeks and all players. \n\nAnd since this is basically binary classification, with more unbalanced data i would recommend to calculate F1 score, and confusion matrix.\n\nOn top of that i recommend try different kernel types and models, and maybe add\\throw away some features and frames.\n\nThere is a plenty ways for the experiment. \n","da1d4b18":"we need prepare the data first. DPI occures with at least 2 players , \n\nto predict that kind of penalty i want to transform every pair of players,\n\nin the oppisite teams, into vectorized distance as a features.\n\ni will also use distance to a ball .","2d9da899":"<a id=\"two\"><\/a>\n# Exploratory Data Analysis of defence team composition","d8f1cb43":"<a id=\"seven\"><\/a>\n# Defence Pass Interference","fdb1617e":"![](https:\/\/i.ibb.co\/5TfQCc0\/nfl.png)","2b318bd0":"<a id=\"five\"><\/a>\n# DETAILED PLAY ANALYSIS","fca42ad0":"**defence against SINGLEBACK formation**","cb17aabd":"**recommended team composition with SINGLEBACK formation**","0e929d4a":"**defence against JUMBO formation**","f38d3662":"<a id=\"six\"><\/a>\n# Plotting a play\nlets finally take a look at play","6c01c99a":"**defence against PISTOL formation**","c1c7a2ac":"**recommended team composition with SHOTGUN formation**","dda916ab":"<a id=\"one\"><\/a>\n# upload the data","9fe7c6bd":"for the sake of example i'm going to grab almost random values, but from the same games for a negative classification","4f6ef446":"# Table of Contents\n\n* [upload the data](#one)\n* [Exploratory Data Analysis of defence team composition](#two)\n* [Most popular offence formations and team composition](#three)\n* [Dropbacks and penalties](#four)\n* [Detailed play analysis](#five)\n\n    * [Plotting a play](#six)\n    * [Defence pass interference](#seven)\n    * [Data preparation](#eight)\n    * [Model creation](#nine)\n    * [model score](#ten)\n    * [conclusion](#eleven)","5c3d09e6":"train\\test sets. \n\ni want to avoid cross validation this time, because ,once again, it's just demonstration.\n\nsince i carelessly picked up data , no reason to test model multiple times","63f7b6be":"dot's are starting positions.\nGreen line is a ball, red\\blue are players from the opposite teams","a6f4487c":"**defence against SHOTGUN formation**","a3fe8553":"with that data you can have a basic understanding what to expect from team.\n And i want to go deeper into Exploratory Data Analysis of defence team composition","ec419c60":"For an another task submission, i've picked up an algorithm , which can predict defence pass interference","e10c077d":"**FILLING DATAFRAME**","734a819f":"**recommended team composition with I_FORM formation**","f24fba8c":"<a id=\"four\"><\/a>\n# Dropbacks and penalties","61b2c88a":"so this is how pre-DPI situation looks like.\n\npass receiver is slowing to catch a ball, tackler is moving at high speed towards him or with him.\n\nball is moving at high speed in close proximity.\n\nthat generally should be a sign for an algorithm that DPI could be there."}}