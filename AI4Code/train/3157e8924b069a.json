{"cell_type":{"efa8f96c":"code","a3ddc16d":"code","3e923cb1":"code","e5abcec5":"code","3eb5823d":"code","663af73c":"code","f7594ea6":"code","00908f77":"code","ad315254":"code","2b81a77d":"code","625975f5":"code","b3f45bc3":"code","fa0c8552":"markdown"},"source":{"efa8f96c":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport tensorflow as tf\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","a3ddc16d":"df=pd.read_csv(\"\/kaggle\/input\/digit-recognizer\/train.csv\")\ndf_test=pd.read_csv(\"\/kaggle\/input\/digit-recognizer\/test.csv\")\n","3e923cb1":"df.columns","e5abcec5":"y_train=df.label.values\ndf=df.drop([\"label\"],axis=1)\n","3eb5823d":"df.head()","663af73c":"x_train=df.values\nx_train.shape\nx_train_shaped=x_train.reshape(42000,28,28,1)","f7594ea6":"x_test=df_test.values\nx_test.shape\nx_test_shaped=x_test.reshape(28000,28,28,1)","00908f77":"model=tf.keras.models.Sequential([\n    tf.keras.layers.Conv2D(64,(3,3),activation=\"relu\",input_shape=(28,28,1)),\n    tf.keras.layers.MaxPooling2D(2,2),\n    tf.keras.layers.Conv2D(64,(3,3),activation=\"relu\"),\n    tf.keras.layers.MaxPooling2D(2,2),\n    tf.keras.layers.Flatten(),\n    tf.keras.layers.Dense(64,activation=\"relu\"),\n    tf.keras.layers.Dense(10,activation=\"softmax\")\n    \n])","ad315254":"model.compile(metrics=[\"accuracy\"], loss=\"sparse_categorical_crossentropy\",optimizer=\"adam\")","2b81a77d":"model.fit(x_train_shaped,y_train,epochs=5)","625975f5":"pred=model.predict(x_test_shaped)\npred.shape","b3f45bc3":"results = np.argmax(pred,axis = 1)\n\nresults = pd.Series(results,name=\"Label\")\n\nsubmission = pd.concat([pd.Series(range(1,28001),name = \"ImageId\"),results],axis = 1)\n\nsubmission.to_csv(\"result.csv\",index=False)","fa0c8552":"# feel free to edit. hope you like it."}}