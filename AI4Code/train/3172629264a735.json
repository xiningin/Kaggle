{"cell_type":{"1f7c6fb2":"code","3a14b05e":"code","77fe19fe":"code","6f6646e6":"code","7d7cefe2":"code","1ac918f0":"code","629f8bd3":"code","716b9e5b":"code","7933c1df":"code","946342b7":"code","99c71ff3":"code","b945b216":"code","b4fa5556":"code","aec5d34d":"code","0e31551a":"code","b362b577":"code","932b4364":"code","512536d6":"code","6222b654":"code","941a168f":"code","816f6f9e":"code","71cdfa50":"code","59ea073d":"code","3835bed1":"code","ce519445":"code","8ce00f6e":"code","02d63279":"code","1edc52e0":"code","1375e43f":"code","9963fd50":"code","600f4f90":"code","f3981306":"code","4920e8c2":"code","172bc92a":"code","3d223529":"markdown","51951860":"markdown","b694c91c":"markdown","579c6a01":"markdown","8f156d42":"markdown","d760edbf":"markdown","57b08fb0":"markdown","070658a9":"markdown","350ea8bc":"markdown","e45b55d5":"markdown","04fd93fc":"markdown","911c7ada":"markdown","0fec47de":"markdown"},"source":{"1f7c6fb2":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","3a14b05e":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.cluster import KMeans\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.metrics import silhouette_score\nimport warnings\nwarnings.filterwarnings('ignore')","77fe19fe":"data=pd.read_csv('\/kaggle\/input\/credit-card-customer-data\/Credit Card Customer Data.csv')","6f6646e6":"data.info()","7d7cefe2":"data.describe()","1ac918f0":"data.columns","629f8bd3":"data.isnull().sum() #no missing value has been fouond","716b9e5b":"data.drop(columns=['Sl_No', 'Customer Key'],inplace=True) # drop unnecessory column","7933c1df":"i=1\nplt.figure(figsize=(20,20))\nfor j in data.columns:\n    plt.subplot(4,3,i)\n    sns.boxplot(data=data,x=j)\n    i+=1","946342b7":"i=1\nplt.figure(figsize=(20,20))\nfor j in data.columns:\n    plt.subplot(4,3,i)\n    sns.histplot(data=data,x=data[j],kde=True)\n    i+=1","99c71ff3":"data.corr()","b945b216":"sns.pairplot(data)","b4fa5556":"sc=StandardScaler()# scaling of data\nscaled=sc.fit_transform(data)\nscaled_data=pd.DataFrame(scaled,columns=data.columns)\n","aec5d34d":"wcss=[]\nfor i in range(1,13):\n    km=KMeans(n_clusters=i)\n    km.fit(scaled_data)\n    wcss.append(km.inertia_)","0e31551a":"slh_score=[]\nfor i in range(2,13):\n    km=KMeans(n_clusters=i)\n    km.fit(data)\n    slh_score.append(silhouette_score(scaled_data,km.labels_))","b362b577":"plt.plot(range(1,13),wcss)\nplt.ylabel('wcss')\nplt.xlabel('k-value')","932b4364":"plt.plot(range(2,13),slh_score)\nplt.xlabel('Number of clusters')\nplt.ylabel('Silhouette Coefficient')\nplt.grid(True)","512536d6":"km1=KMeans(n_clusters=3)\nkm1.fit(scaled_data)\ny=km1.predict(scaled_data)\ndata['label']=y","6222b654":"sns.pairplot(data,hue='label',palette='bright')","941a168f":"center=km1.cluster_centers_# centre of clustering\ncenter","816f6f9e":"Kmean_silihoute=silhouette_score(scaled_data,km1.labels_)\nKmean_silihoute","71cdfa50":"plt.figure(figsize=(8,6))\nsns.scatterplot(data=data,y='Avg_Credit_Limit',x='Total_Credit_Cards',hue='label',palette='bright')\nplt.show()","59ea073d":"plt.figure(figsize=(8,6))\nsns.scatterplot(data=data,y='Avg_Credit_Limit',x='Total_visits_online',hue='label',palette='bright')\nplt.show()","3835bed1":"plt.figure(figsize=(8,6))\nsns.scatterplot(data=data,x='Total_calls_made',y='Total_Credit_Cards',hue='label',palette='bright')","ce519445":"plt.figure(figsize=(8,6))\nsns.scatterplot(data=data,x='Total_visits_online',y='Total_Credit_Cards',hue='label',palette='bright')","8ce00f6e":"import scipy.cluster.hierarchy as shc","02d63279":"plt.figure(figsize=(10,8))\ndend=shc.dendrogram(shc.linkage(scaled_data,method='ward'))\nplt.title('Dendrogram')\nplt.xlabel('Customers')\nplt.ylabel('Euclidean distances')\nplt.show()","1edc52e0":"from sklearn.cluster import AgglomerativeClustering","1375e43f":"h_cluster=AgglomerativeClustering(n_clusters=3,affinity='euclidean',linkage='ward')","9963fd50":"y_h=h_cluster.fit_predict(scaled_data)","600f4f90":"data['H_label']=y_h","f3981306":"H_silihoute=silhouette_score(scaled_data,h_cluster.labels_)\nH_silihoute","4920e8c2":"sns.pairplot(data=data,hue='H_label',palette='bright')","172bc92a":"print(Kmean_silihoute,H_silihoute)# silihoute score for both clustering k-mean and H-clustering","3d223529":"#### 1- avg_credit_limit and total_credit_cards has the high +ve correlation of 0.61..                                                                                                                                                  2- avg_credit_limit and total_visits_online has the high +ve correlation of 0.55..                                                                                                                                                                                                                                                                  3-total_credit_card and total_calls_made has the high -ve correlation of -0.65....                                                                                                                                                    4-total_visit_bank and total_visit_online has high -ve correlation of -0.55....                                                                                                                                                    5-total_calls_made and total_visit_bank has high -ve correlation of -0.51.....","51951860":"#### segment-0:total_credit_card[4-6] and avg_credit_limit(0-75000)----    \n#### segment-1:total_credit_card(0-3) and avg_credit_limit(0-25000)----\n#### segment-2:total_credit_card(6-10) and avg_credit_limit>75000 ----\n\n#### we can observe that higher the avg_credit_limit higher is total_credit_card aquired by customer\n\n\n\n\n\n\n\n\n","b694c91c":"#### segment-0:total_visit_online<=2 and avg_credit_limit<=100000\n#### segment-1:total_visit_online[3-5] and avg_credit_limit<=25000\n#### segment-2: total_visit_online[6-15] and avg_credit_limit>100000\n#### we can see that greater the avg_credit_limit,customer visit more frequently online(6-15)","579c6a01":"#### Here we have choose k- value such that wcss is minimum and silihoutte coefficint is more so we choose k=3","8f156d42":"#### Here we have some outlier but we dont remove it due to the loss of data","d760edbf":"sns.heatmap(data.corr(),cmap='gist_earth_r',linewidths=1,annot=True)","57b08fb0":"### BIVARIATE ANALYSIS","070658a9":"#### Silhouette Coefficient:\n#### Silhouette Coefficient or silhouette score is a metric used to calculate the goodness of a clustering technique. Its value ranges from -1 to 1.\n#### 1: Means clusters are well apart from each other and clearly distinguished.\n#### 0: Means clusters are indifferent, or we can say that the distance between clusters is not significant.\n#### -1: Means clusters are assigned in the wrong way.","350ea8bc":"### UNIVARIATE ANALYSIS","e45b55d5":"## EDA","04fd93fc":"#### here we can also see that person having credit card (6-10) more frequently he visits online[6-15]","911c7ada":"## K-MEAN CLUSTERING","0fec47de":"#### segment-0:total_call_made[0-4] and total_credit_card[4-6]\n#### segment-1:total_call_made[4-10] and total_credit_card[0-4]\n#### segment-2:total_call_made[0-2] and total_credit_card[7-10]\n#### less the total call made greater the total cedit card"}}