{"cell_type":{"c698ed05":"code","3b578e21":"code","e8449d33":"code","50153633":"code","7e45b31f":"code","ef0cc24f":"code","21b82af5":"markdown","c1e84c0d":"markdown","b8a07a0d":"markdown","aa3c8c02":"markdown","11f9ab69":"markdown","dbcb3643":"markdown","9074ebf5":"markdown","0329c27c":"markdown","2e96d6f7":"markdown","29aaf774":"markdown","00a9e885":"markdown","5375fa7f":"markdown","417be9be":"markdown","49a9f129":"markdown","ce2eed36":"markdown"},"source":{"c698ed05":"from IPython.display import Image\nimport pandas as pd\nfrom scipy.stats import shapiro\nimport scipy.stats as stats\nfrom scipy.stats import mannwhitneyu\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport warnings\nfrom sklearn.exceptions import ConvergenceWarning\nwarnings.simplefilter(action='ignore', category=FutureWarning)\nwarnings.simplefilter(\"ignore\", category=ConvergenceWarning)\nfrom termcolor import colored","3b578e21":"DataGroupA = pd.read_excel(\"..\/input\/ab-testing-data\/ab_testing_data.xlsx\" , sheet_name= \"Control Group\")\nDataGroupB = pd.read_excel(\"..\/input\/ab-testing-data\/ab_testing_data.xlsx\" , sheet_name= \"Test Group\")","e8449d33":"DataGroupA[\"Conversion Rate\"] = DataGroupA[\"Purchase\"]\/DataGroupA[\"Click\"]*100\nDataGroupB[\"Conversion Rate\"] = DataGroupB[\"Purchase\"]\/DataGroupB[\"Click\"]*100","50153633":"\nDataGroupA[\"Group\"] = \"GroupA\"\nDataGroupB[\"Group\"] = \"GroupB\"","7e45b31f":"Data = pd.concat([DataGroupA, DataGroupB], ignore_index=True)","ef0cc24f":"variables = [\"Purchase\",\"Earning\", \"Click\", \"Conversion Rate\"]\n\nfor x in variables:\n    print(colored(\" A\/B Testing for \"+x+\" \",\"blue\", \"on_white\", attrs=[\"bold\"]),\"\\n\")\n    result1 = Data.groupby(\"Group\")[x].describe().T\n    print(x)\n    print(result1, \"\\n\")\n    \n    def normald():\n        \n        GroupA_shaphiro_w, GroupA_shaphiro_p = shapiro(DataGroupA[x])\n        GroupB_shaphiro_w, GroupB_shaphiro_p = shapiro(DataGroupB[x])\n        print(\"GroupA_shaphiro_p = %.3f, GroupB_shaphiro_p = %.3f\" % (GroupA_shaphiro_p, GroupB_shaphiro_p),\"\\n\")\n    \n        if GroupA_shaphiro_p > 0.05 and GroupB_shaphiro_p > 0.05: \n            print(\"Shaphiro Wilk Test resulted as p > .05 for GroupA and GroupB which indicates that H0 can NOT be rejected. \" \n                  \"Accordingly distrubations of \"+x+\" values in\"+\" GroupA and GroupB are likely to normal distrubation.\",\"\\n\")\n            return 1\n        elif GroupA_shaphiro_p < 0.05 and GroupB_shaphiro_p < 0.05:\n            print(\"Shaphiro Wilk Test resulted as p < .05 for GroupA and GroupB which indicates that H0 is rejected. \" \n                  \"Accordingly distrubations of \"+x+\" values in\"+\" GroupA and GroupB are not likely to normal distrubation.\",\"\\n\")\n            return 2\n        elif GroupA_shaphiro_p > 0.05 and GroupB_shaphiro_p < 0.05:\n            print(\"Pay Attention!: Shaphiro Wilk Test resulted as p > .05 for GroupA while p < .05 for GroupB which indicates that H0 is rejected for GroupB. \" \n                  \"Accordingly you can check if the \"+x+\" values in\"+\" GroupB contain outlier or not\",\"\\n\")\n            return 3\n        else :\n            print(\"Pay Attention!: Shaphiro Wilk Test resulted as p > .05 for GroupB while p < .05 for GroupA which indicates that H0 is rejected for GroupA. \" \n                \"Accordingly you can check if the \"+x+\" values in\"+\" GroupA contain outlier or not\",\"\\n\")\n            return 4\n\n    result = normald()\n    if result == 1:\n        \n            levene_F, levene_p = stats.levene(DataGroupA[x], DataGroupB[x])\n            print(\"levene_F = %.3f, levene_p = %.3f\" % (levene_F, levene_p),\"\\n\")       \n            if levene_p > 0.05:\n                print(\"Levene's Test for Homogeneity resulted as p > .05 which indicates that H0 can NOT be rejected.\"\n                      \" Accordingly variances of GroupA and GroupB are equal.\",\"\\n\")\n                t_value, t_test_p = stats.ttest_ind(DataGroupA[x], DataGroupB[x], equal_var=True)\n                print(\"t_value = %.3f, t_test_p = %.3f\" % (t_value, t_test_p),\"\\n\")\n                if t_test_p > 0.05:\n                    print(\"Independent Samples t Test resulted as p > .05 which indicates that H0 can NOT be rejected.\"\n                          \" Accordingly there is no significant difference between GroupA and GroupB in \"+x+\" values.\",\"\\n\")\n                else: \n                    print(\"Independent Samples t Test resulted as p < .05 which indicates that H0 is rejected.\"\n                          \" Accordingly there is a significant difference between GroupA and GroupB in \"+x+\" values.\",\"\\n\")\n            else : \n                print(\"Levene's Test for Homogeneity resulted as p < .05 which indicates that H0 is rejected.\"\n                      \" Accordingly variances of GroupA and GroupB are not equal.\",\"\\n\")\n                t_value, t_test_p = stats.ttest_ind(DataGroupA[x], DataGroupB[x], equal_var=False)\n                print('t_value = %.3f, t_test_p = %.3f' % (t_value, t_test_p),\"\\n\")\n                if t_test_p > 0.05:\n                    print(\"Independent Samples t Test resulted as p > .05 which indicates that H0 can NOT be rejected.\"\n                          \" Accordingly there is no significant difference between GroupA and GroupB in \"+x+\" values.\",\"\\n\")\n                else: \n                    print(\"Independent Samples t Test resulted as p < .05 which indicates that H0 is rejected.\"\n                          \" Accordingly there is a significant difference between GroupA and GroupB in \"+x+\" values.\",\"\\n\")\n                    \n    elif result == 2 or result == 3 or result == 4:\n            u_value, mannw_test_p = mannwhitneyu(DataGroupA[x], DataGroupB[x])\n            print('u_value=%.3f, mannw_test_p=%.3f' % (u_value, mannw_test_p),\"\\n\")\n            if mannw_test_p > 0.05:\n                print(\"Mann Whitney U Test resulted as p > .05 which indicates that H0 can NOT be rejected.\"\n                      \" Accordingly there is no significant difference between GroupA and GroupB in distrubations of \"+x+\" values.\",\"\\n\")\n            else: \n                print(\"Mann Whitney U Test resulted as p < .05 which indicates that H0 is rejected.\"\n                      \" Accordingly there is a significant difference between GroupA and GroupB in distrubations of \"+x+\" values.\",\"\\n\")\n    else :\n            print(\"If you got this error, you either have a crazy dataset or something strange is happening. Contact your superhero(me) !\")\n            \n            \n    #sns.displot(Data, x=x, hue=\"Group\")                # You can check the site for all other displot options. http:\/\/seaborn.pydata.org\/tutorial\/distributions.html\n    #plt.show()                                         # Kaggle doesn't support the seaborn library's 0.11.0 version for now, so i had to change the graphics that i used. I turn it into a comment line and keep my old codes.\n    sns.boxplot(x=\"Group\", y=x, data=Data);  \n    plt.show()\n    \n    sns.distplot( DataGroupA[x] , color=\"blue\", label=\"GroupA\")\n    sns.distplot( DataGroupB[x] , color=\"orange\", label=\"GroupB\")\n    plt.legend()\n    plt.show()\n    # sns.swarmplot(x=\"Group\", y=a, data=Data, color= \".25\")\n    # plt.show()\nplt.show()  ","21b82af5":"## <b><font color=\"red\">A\/B TEST ROUTE <\/font><\/b>\n","c1e84c0d":"#### *Future Engineering: Conversion Rate*","b8a07a0d":"*Explanations of variables;*\n\n    * Group:             Shows the group to which the value belongs\n    * Clicks:            The number of clicks on ad links directed to Advertiser\u2019s website.\n    * Earning:           The amount of earnings achieved \n    * Purchase:          The amount of purchases\n    * Impressions:       The number of times an ad is displayed.\n    * Conversion Rate:   Rate of purchases per click. It is formulated as \"purchase\/click*100\"\n    ","aa3c8c02":"In this notebook i would like to introduce you a user developed function finalises the necesarry statistical steps of <b><font color=\"blue\">A\/B Testing<\/font><\/b> and interprets the result of the hypothesis tests that are used in <b><font color=\"blue\">A\/B Testing<\/font><\/b> process.\n\n\n\n<b><font color=\"blue\">A\/B Testing<\/font><\/b> method cover the statistical hypothesis tests are used to reveal significance of the difference in a metric variable values between two groups such a Group A and Group B. There are two statistical methods to test the significance as Independent Samples t Test and Mann-Whitney U Test. According to result of <b><font color=\"darkblue\">1. Step: Testing the Normality Assumption<\/font><\/b>, it is decided between two alternative methods.\n\n\n\n\n\n\n\n<b><mark style=\"background-color: blue\"><font color=\"white\">* A\/B Testing Steps *<\/font><\/mark><\/b>\n\n\n\n\n<b><font color=\"blue\">1. Step: Testing the Normality Assumption<\/font><\/b>\n\n\n\nIt is necesarry to decide which way of testing the significany of difference will be choosen. Shaphiro Wilks test is a way to test if the serie has normal distrubation or not. Also a Box Plot might be helpfull to observe if the serie has outliers or not.\nAccording to result of the test it can be decided between Independent Samples t Test and Mann-Whitney U Test.\n\n\n\nIf p value of the test is greater than .05 A\/B Testing method will be Independent Samples t Test.\n\n\n\nIn addition Independent Samples t Test requires another assumption which is Homogeneity, so if the result is normal then you can follow <b><font color=\"blue\">2. Step: Testing the Homogeneity Assumption<\/font><\/b>.\n\n\n\n\nIf p value of the test is less than .05 A\/B Testing method will be Mann-Whitney U Test.\n\n\n\nIn addition Mann-Whitney U Test does not require any other assumptions, so if the result is not normal then you can jump to <b><font color=\"blue\">3. Step: Alternative 2 -> Mann-Whitney U Test<\/font><\/b>.\n\n\n\n\n\n\n<b><font color=\"blue\">2. Step: Testing the Homogeneity Assumption<\/font><\/b>\n\n\n\nThis assumption is only relevant in the case of normal distrubation. It is necesarry to decide which code setting will be choosen while executing the <b><font color=\"blue\">3. Step: Alternative 1 -> Independent Samples t Test<\/font><\/b>.\n\n\n\nIf p value of the test is greater than .05 Independent Samples t Test will be done with \"equal_var=<b><font color=\"red\">True<\/font><\/b>\" extention.\n\n\n\nIf p value of the test is less than .05 Independent Samples t Test will be done with \"equal_var=<b><font color=\"red\">False<\/font><\/b>\" extention.\n\n\n\n\n<b><font color=\"blue\">3. Step: Alternative 1 -> Independent Samples t Test<\/font><\/b>\n\n\n\n\nIt can be defined as an approach that tests to statistically reveal whether there is a significant difference between the means of two groups of data.\n\n\n\n\n<b><font color=\"blue\">3. Step: Alternative 2 -> Mann-Whitney U Test<\/font><\/b>\n\n\n\nIt can be defined as an approach that tests to statistically reveal whether there is a significant difference between the distributions of two groups of data.\n\n\n![](http:\/\/miro.medium.com\/max\/791\/1*JlpbE7evTO4LD8R7c_M-sA.png)\n\n[Check out! A\/B Testing Story for more](https:\/\/ersoykubraa.medium.com\/a-b-testing-ef7e8dbb9859)","11f9ab69":"#### *Importing the Datasets: Two sets are stored in different sheets of excel*","dbcb3643":"## <b><font color=\"red\"> CONCLUSION AND DISCUSSION <\/font><\/b> ","9074ebf5":"## <b><font color=\"red\">  EXPLANATION OF STUDY <\/font><\/b> \n\n\nA Company recently introduced a new bidding type, <b><font color=\"blue\">\u201caverage bidding\u201d<\/font><\/b>, as an alternative to its exisiting bidding type, called <b><font color=\"blue\">\u201cmaximum bidding\u201d<\/font><\/b>. One of our clients has decided to test this new feature and wants to run an A\/B test to see if average bidding yields more conversions than the maximum bid. In this A\/B test, our client divides his random audience into two groups of equal size, the Test and the Control group. The ad campaign containing the  <b><font color=\"green\">\"maximum biding\" is submitted to the \"Control group\"<\/font><\/b>, another campaign containing  <b><font color=\"green\">the \"average bidding\" to the \"Test group\"<\/font><\/b>. A\/B testing has been going on for 1 month, and our customer now expects you to analyze and present the results of this A\/B test. In your presentation you should answer the following questions:\n\n\n1. How would you define the hypothesis of this A\/B test?\n2. Can we conclude statistically significant results?\n3. Which statistical test did you use, and why?\n4. Based on your answer to Question 2, what would be your recommendation to client?","0329c27c":"#### *Modules Imports*","2e96d6f7":"<font color=\"blue\">Number<\/font>|<font color=\"red\"> Variables <\/font>|<font color=\"magenda\"> Variable Type <\/font>|<font color=\"orange\"> Scale Types of Data <\/font>\n--|----------- |:-------------:|:-------------------:\n1 |Purchase | Quantitative | Ratio\n2 |Impression | Quantitative | Ratio\n3 |Earning | Quantitative | Ratio\n4 |Click | Quantitative | Ratio\n5 |Convertion Rate | Quantitative | Ratio\n","29aaf774":" #### <b><font color=\"darkred\">1. How would you define the hypothesis of this A\/B test?<\/font><\/b> \n    H0: There is NO statistically significant difference between A and B groups in Purchase values.\n\n    H1: There is a statistically significant difference between A and B groups in Purchase values.\n\n #### <b><font color=\"darkred\">2. Can we conclude statistically significant results?<\/font><\/b> \n \n     Via AB tests\n\n\n\n #### <b><font color=\"darkred\">3. Which statistical test did you use, and why?<\/font><\/b> \n \n    Based on the result from the Shaphiro Wilks Test, we used the Independent t-Test because we want to determine if there is a significant difference between the averages of the two independent groups that may be    associated with certain properties.\n\n\n #### <b><font color=\"darkred\">4. Based on your answer to Question 2, what would be your recommendation to client?<\/font><\/b> \n \n    Two independent samples test results greater than 0.05 using test and control group data set H0 hypothesis can NOT be rejected because of its outcome. \n\n    Namely, there is no statistically significant difference between the Control group that was served \u201cmaximum bidding\u201d campaign and Test group that was served \u201caverage bidding\u201d campaign. \n\n    This could be due to, the test has made on data sets containing 40 observation units. In accordance with the Law of Large Numbers, as the number of observations increases, the tests performed will produce results that are closest to reality. Both options can be preferred.\n\n","00a9e885":"##### <b><font color=\"darkred\">Step 1 : *Shaphiro Wilks Test Hypothesises* <\/font><\/b> \n\n\n- H0: The sample data are not significantly different than a normal population.\n\n- Ha: The sample data are significantly different than a normal population.\n\n##### <b><font color=\"darkred\">Step 2 : *Levene's Test of Homogeneity*   <\/font><\/b> \n\n\n- H0: The variances are equal across all samples.\n\n- Ha: The variances are not equal for at least one pair.\n\n#####  <b><font color=\"darkred\">Step 3 : *Independent Samples t-Test*   <\/font><\/b> \n\n\n* H0: There is NO statistically significant difference between A and B groups in Purchase values.\n\n* Ha: There is a statistically significant difference between A and B groups in Purchase values.\n    \n    \n","5375fa7f":"> # <font color='purple'> CASE  STUDY  A\/B TESTING<\/font> ","417be9be":"#### *Combining the Datasets*","49a9f129":"#### *Data Manipulation: Indication of Groups in A New Variable*","ce2eed36":"## <font color=\"red\"> HYPOTHESES<\/font>"}}