{"cell_type":{"2fefbf61":"code","1e57cec7":"code","074befb7":"code","4a6d9bfc":"code","f65e83b2":"code","0d317549":"code","73e084d7":"code","0fe55e9a":"code","7ea89beb":"code","5b67cb42":"code","bfe3cf76":"code","b0be8839":"code","50f4fb36":"code","6d4d9c18":"code","54589a86":"code","0e37b32d":"code","a377c975":"code","6dff289b":"code","5c11a54e":"code","09cca6a0":"code","c173320a":"code","e5763ff3":"code","a265637f":"code","7c668e1b":"code","d7d8f16c":"code","16f28035":"code","4d1cd1aa":"code","88506424":"code","87140f69":"code","d4189445":"code","f9578a61":"code","79a8d695":"code","112087b7":"code","ee63bca4":"code","cd9e7112":"code","a20d6742":"markdown","967cb94d":"markdown","5ea392ce":"markdown","b0c5119e":"markdown","eed6f5d3":"markdown","1d991ca7":"markdown","01878714":"markdown","e06e0d1e":"markdown","cf57194b":"markdown","15f94071":"markdown","7be15718":"markdown","96433ff2":"markdown","843fb408":"markdown","63c493a4":"markdown","1e8d889a":"markdown","5c83b324":"markdown","80c2ea78":"markdown","98adc143":"markdown","3059904f":"markdown","824d2048":"markdown","39786e4f":"markdown","144a28b3":"markdown","415ea2ce":"markdown","12c4afc8":"markdown","26dd9fca":"markdown","833f3b13":"markdown","05c1dab8":"markdown","e4157368":"markdown","3fbdfc7b":"markdown","d7ce0680":"markdown","753ac1b5":"markdown","3be22511":"markdown","c5da4f3f":"markdown","f3e2fd93":"markdown","f6e30e63":"markdown","47228a0a":"markdown","5047b193":"markdown","ad1d5c24":"markdown","87b08f66":"markdown","ca49fbfc":"markdown"},"source":{"2fefbf61":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt","1e57cec7":"dataset = pd.read_csv('..\/input\/bank-customers\/Churn Modeling.csv')\ndataset.head()","074befb7":"dataset.isnull().sum()","4a6d9bfc":"dataset.info()","f65e83b2":"dataset.describe()","0d317549":"value_counts = pd.value_counts(dataset['Exited'])\nplt.figure(figsize = (6,6))\nvalue_counts.plot(kind = 'pie', explode = [0,0.1],autopct='%1.1f%%', shadow=True)\nplt.title('Proportion of customer churned and retained')\nplt.show()\nvalue_counts","73e084d7":"sns.countplot(dataset['Geography'])\nplt.title('Geographical location Distribution of Bank Customers')\nplt.show()","0fe55e9a":"sns.countplot(dataset['Gender'])\nplt.title('Gender Distribution of Bank Customers')\nplt.show()","7ea89beb":"\nfig, axarr = plt.subplots(2, 2, figsize=(20, 12))\nsns.countplot(x='Geography', hue = 'Exited',data = dataset, ax=axarr[0][0])\nsns.countplot(x='Gender', hue = 'Exited',data = dataset, ax=axarr[0][1])\nsns.countplot(x='HasCrCard', hue = 'Exited',data = dataset, ax=axarr[1][0])\nsns.countplot(x='IsActiveMember', hue = 'Exited',data = dataset, ax=axarr[1][1])","5b67cb42":"sns.pairplot(dataset, hue = 'Exited')","bfe3cf76":"plt.figure(figsize = (15,15))\nsns.heatmap(dataset.corr(), annot = True, cmap = 'RdYlGn')","b0be8839":"X = dataset.iloc[:,3:-1].values\ny = dataset.iloc[:,-1].values","50f4fb36":"X","6d4d9c18":"y","54589a86":"from sklearn.preprocessing import LabelEncoder\nle = LabelEncoder()\nX[:, 2] = le.fit_transform(X[:, 2])","0e37b32d":"print(X)","a377c975":"from sklearn.compose import ColumnTransformer\nfrom sklearn.preprocessing import OneHotEncoder\nct = ColumnTransformer(transformers=[('encoder', OneHotEncoder(), [1])], remainder='passthrough')\nX = np.array(ct.fit_transform(X))","6dff289b":"X","5c11a54e":"y","09cca6a0":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X,y, test_size = 0.2, random_state = 0)","c173320a":"from sklearn.preprocessing import StandardScaler\nsc = StandardScaler()\nX_train = sc.fit_transform(X_train)\nX_test = sc.transform(X_test)","e5763ff3":"print(X_train)","a265637f":"print(y_train)","7c668e1b":"\nimport tensorflow as tf","d7d8f16c":"ann = tf.keras.models.Sequential()","16f28035":"ann.add(tf.keras.layers.Dense(units=6, activation='relu'))","4d1cd1aa":"ann.add(tf.keras.layers.Dense(units = 6, activation = 'relu'))","88506424":"ann.add(tf.keras.layers.Dense(units = 1, activation = 'sigmoid'))","87140f69":"ann.compile(optimizer  ='adam', loss = 'binary_crossentropy', metrics = ['accuracy'])","d4189445":"model_history = ann.fit(X_train, y_train,validation_split=0.33,batch_size = 10, epochs = 50)","f9578a61":"print(model_history.history.keys())","79a8d695":"plt.plot(model_history.history['accuracy'])\nplt.plot(model_history.history['val_accuracy'])\nplt.title('model accuracy')\nplt.ylabel('accuracy')\nplt.xlabel('epoch')\nplt.legend(['train', 'validation'], loc='upper left')\nplt.show()","112087b7":"plt.plot(model_history.history['loss'])\nplt.plot(model_history.history['val_loss'])\nplt.title('model loss')\nplt.ylabel('loss')\nplt.xlabel('epoch')\nplt.legend(['train', 'validation'], loc='upper right')\nplt.show()","ee63bca4":"\ny_pred = ann.predict(X_test)\ny_pred =(y_pred > 0.5)","cd9e7112":"from sklearn.metrics import confusion_matrix, accuracy_score, classification_report\ncm = confusion_matrix(y_test, y_pred)\nprint(cm)\nprint(accuracy_score(y_test, y_pred))","a20d6742":"- We have to predict that Customers of the bank will leave or not based on the given dataset.","967cb94d":"##### 4.2  Adding the input layer and the first hidden layer","5ea392ce":"#### 4.4 adding the output layer","b0c5119e":"- Here 20.4 % customers churned(leave) from the bank and 79% customers retained.\n- 0 --> not Exited\n- 1 --> Exited\n","eed6f5d3":"- Here RowNumber & CustomerID is highly negative correalted & For modeling  we will not consider these features. ","1d991ca7":"# Bank Customers Churn Prediction","01878714":"https:\/\/www.kaggle.com\/adammaus\/predicting-churn-for-bank-customers(for more detail click this link)","e06e0d1e":"##### 4.5 compile the ANN","cf57194b":"###### 4.3  Adding the second  Hidden Layer","15f94071":"#####  6.predict the test set","7be15718":"### 3. Data Preparing","96433ff2":"#### 2.1 Checking misssing values","843fb408":"#### 1 importing the libraries","63c493a4":"- Here from above information we can see that Dtype of surname , Geography & Gender  column are Object type.So we have to convert these columns into  numeric Datatype and apart from these, All column are Numeric type.","1e8d889a":"####  2.7 pair plot","5c83b324":"####  5.2 Visualizing the loss of the model","80c2ea78":"Here no null values in this datatype, So we can do further process.","98adc143":"##### 7.  Evaluate the performance","3059904f":"####  4.1 intializing the ANN","824d2048":"- Majority of the data is from persons from France.\n\n- The proportion of female customers churning is also greater than that of male customers\n- Interestingly, majority of the customers that churned are those with credit cards. Given that majority of the customers have credit cards could prove this to be just a coincidence.\n-  Inactive members have a greater churn compare to other other graph.","39786e4f":"#### 3.3 Splitting the data into train and test set","144a28b3":"##### 3.2.1 Label Encoding the \"Gender\" column","415ea2ce":"#### 2.3 Proportion of customer churned and retained","12c4afc8":"### 5. Visualizing the performace of ANN Model ","26dd9fca":"#### 5.1 visualizing the accuracy of model","833f3b13":"#### 3.2 Encoding categorical data","05c1dab8":"#### 3.1 dependent and independent features","e4157368":"- Above the graph we can see that the relation b\/w the features.","3fbdfc7b":"##### 4.6 Fitting ANN to the train set","d7ce0680":"###  Part 4  Modeling (Building the ANN)","753ac1b5":"####  2.2 checking the datatype","3be22511":" ##### 3.2.2 One Hot Encoding the \"Geography\" column","c5da4f3f":"#### 3.4  Feature scaling","f3e2fd93":"### 2. EDA","f6e30e63":"### 8. conclusion :\nHere we build a model using Artificial Neural Network and we get approx 86% accuracy.This model can predict\ncustomer will leave the bank or not based on the given dataset.","47228a0a":" ####  2.6 review the 'Status' relation with categorical variables","5047b193":"#### 2.8  finding the correlation b\/w the dataset","ad1d5c24":"#### 1.1 Loading dataset","87b08f66":"##### 2.5 Gender Distribution","ca49fbfc":"#### 2.4 location Distribution of Bank Customers"}}