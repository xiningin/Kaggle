{"cell_type":{"40b99d1f":"code","ce11adc8":"code","ae2c2e64":"code","7b5c148d":"code","b2310e12":"code","f1d5df68":"code","7a4e7cb9":"code","19df3a95":"code","29db77be":"code","37adb76e":"code","51ef628f":"code","75e601bd":"code","626ff7dc":"code","4df3ae42":"code","7ccb996f":"code","a636e6c3":"code","cfef01c8":"code","77fb7d61":"code","cf511c07":"code","3a95f96c":"code","3ac1950e":"code","a9554793":"code","c28a0356":"code","7d3416de":"code","bc3988d5":"code","66671774":"code","a45a5c19":"code","cd01bfba":"code","8430a036":"code","e957b8da":"code","6fd79bce":"code","87394aaf":"code","db5a6a34":"markdown","02984d88":"markdown","cb995180":"markdown","9bb2cfe8":"markdown","f8e3dc40":"markdown","235b1c68":"markdown","3c493582":"markdown","e97e5e3a":"markdown","cc6d3514":"markdown","02259424":"markdown","1f274da5":"markdown","377be55b":"markdown","a6f971df":"markdown","03492d7b":"markdown","9ca30682":"markdown","59bbdf9e":"markdown","37f8a251":"markdown","9e49567f":"markdown","c2730a14":"markdown","5693a984":"markdown","3d0936b9":"markdown","e9fac756":"markdown"},"source":{"40b99d1f":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport os","ce11adc8":"path = \"..\/input\/tomato\/New Plant Diseases Dataset(Augmented)\"\nos.listdir(path)","ae2c2e64":"train_path = os.path.join(path, \"train\")\nprint(os.listdir(train_path))\nprint(\"*\"*100)\ntest_path = os.path.join(path, \"valid\")\nprint(os.listdir(test_path))","7b5c148d":"from glob import glob\nfolders = glob(\"..\/input\/tomato\/New Plant Diseases Dataset(Augmented)\/train\/*\")\nfolders","b2310e12":"import matplotlib.pyplot as plt\nplt.imshow(plt.imread(\"..\/input\/tomato\/New Plant Diseases Dataset(Augmented)\/train\/Tomato___Bacterial_spot\/00416648-be6e-4bd4-bc8d-82f43f8a7240___GCREC_Bact.Sp 3110.JPG\"))\nplt.title(\"Bacterial Spot\")","f1d5df68":"plt.imshow(plt.imread(\"..\/input\/tomato\/New Plant Diseases Dataset(Augmented)\/train\/Tomato___Early_blight\/0034a551-9512-44e5-ba6c-827f85ecc688___RS_Erly.B 9432.JPG\"))\nplt.title(\"Early Blight\")","7a4e7cb9":"plt.imshow(plt.imread(\"..\/input\/tomato\/New Plant Diseases Dataset(Augmented)\/train\/Tomato___Late_blight\/0003faa8-4b27-4c65-bf42-6d9e352ca1a5___RS_Late.B 4946.JPG\"))\nplt.title(\"Late Blight\")","19df3a95":"from tensorflow.keras.layers import Input, Lambda, Dense, Flatten\nfrom tensorflow.keras.models import Model\nfrom tensorflow.keras.applications.inception_v3 import InceptionV3\nfrom tensorflow.keras.preprocessing import image\nfrom tensorflow.keras.preprocessing.image import ImageDataGenerator\nfrom tensorflow.keras.models import Sequential","29db77be":"SIZE = [128, 128]","37adb76e":"from tensorflow.keras.applications.vgg16 import VGG16\nfrom tensorflow.keras.applications.vgg19 import VGG19","51ef628f":"vg19 = VGG19(input_shape=SIZE + [3], weights=\"imagenet\", include_top=False)","75e601bd":"for layer in vg19.layers:\n    layer.trainable = False","626ff7dc":"x = Flatten()(vg19.output)","4df3ae42":"prediction = Dense(len(folders), activation=\"softmax\")(x)\n\nmodelvg = Model(inputs=vg19.input, outputs=prediction)","7ccb996f":"modelvg.summary()","a636e6c3":"modelvg.compile(loss=\"categorical_crossentropy\", metrics=[\"accuracy\"], optimizer=\"adam\")","cfef01c8":"train_datagen_vg19 = ImageDataGenerator(rescale=1.\/255)\n\ntest_datagen_vg19 = ImageDataGenerator(rescale=1.\/255)","77fb7d61":"trainning_set_vg19 = train_datagen_vg19.flow_from_directory(train_path,\n                                                 target_size=(128, 128),\n                                                 batch_size=16,\n                                                 class_mode=\"categorical\", shuffle=True)","cf511c07":"testing_set_vg19 = test_datagen_vg19.flow_from_directory(test_path,\n                                                 target_size=(128, 128),\n                                                 batch_size=16,\n                                                 class_mode=\"categorical\", shuffle=False)","3a95f96c":"import tensorflow as tf\n\ncallback = tf.keras.callbacks.EarlyStopping(monitor='val_loss', patience=3)\n\nr_vg19 = modelvg.fit_generator(trainning_set_vg19,\n                       validation_data=testing_set_vg19,\n                       epochs=100,\n                       callbacks=[callback]\n                       )","3ac1950e":"import matplotlib.pyplot as plt\naccuracy = r_vg19.history['accuracy']\nval_accuracy = r_vg19.history['val_accuracy']\nloss = r_vg19.history['loss']\nval_loss = r_vg19.history['val_loss']\nepochs = range(len(accuracy))\nplt.title(\"VGG19\")\nplt.plot(epochs, accuracy, \"b\", label=\"trainning accuracy\")\nplt.plot(epochs, val_accuracy, \"r\", label=\"validation accuracy\")\nplt.legend()\nplt.show()\n\nplt.plot(epochs, loss, \"b\", label=\"trainning loss\")\nplt.plot(epochs, val_loss, \"r\", label=\"validation loss\")\nplt.legend()\nplt.show()","a9554793":"y_pred = modelvg.predict(testing_set_vg19)","c28a0356":"y_pred","7d3416de":"y_pred = np.argmax(y_pred, axis=1)\ny_pred","bc3988d5":"test_img = plt.imread(\"..\/input\/tomato\/New Plant Diseases Dataset(Augmented)\/train\/Tomato___Bacterial_spot\/00416648-be6e-4bd4-bc8d-82f43f8a7240___GCREC_Bact.Sp 3110.JPG\")","66671774":"plt.imshow(test_img)","a45a5c19":"modelvg.save(\"vgg_19tl.model\")","cd01bfba":"import cv2\nimport tensorflow as tf\ndef prepare(filepath):\n    img_array = cv2.imread(filepath, cv2.IMREAD_COLOR)\n    img_array = img_array \/ 255\n    new_array = cv2.resize(img_array, (128, 128))\n    return new_array.reshape(-1, 128, 128, 3)\n\nmodel = tf.keras.models.load_model(\"vgg_19tl.model\")","8430a036":"class_dict = trainning_set_vg19.class_indices\nclass_dict","e957b8da":"def prediction_cls(prediction):\n    for key, clss in class_dict.items():\n        if np.argmax(prediction) == clss:\n            return key","6fd79bce":"prediction = model.predict([prepare(\"..\/input\/tomato\/New Plant Diseases Dataset(Augmented)\/valid\/Tomato___healthy\/0a334ae6-bea3-4453-b200-85e082794d56___GH_HL Leaf 310.1_flipTB.JPG\")])\nprediction_cls(prediction)","87394aaf":"prediction = model.predict([prepare(\"..\/input\/tomato\/New Plant Diseases Dataset(Augmented)\/valid\/Tomato___Tomato_Yellow_Leaf_Curl_Virus\/101849ce-d61a-4c2f-a6a7-8da0d71f237e___YLCV_NREC 2725.JPG\")])\n\nprediction_cls(prediction)","db5a6a34":"# Visualize","02984d88":"# load a image and detection","cb995180":"# VGG19 model summary","9bb2cfe8":"# Data Augmentation","f8e3dc40":"# image size","235b1c68":"# Tomato Leaf Detection","3c493582":"# glob function","e97e5e3a":"# model fit_genrator","cc6d3514":"# vgg19 with input shape and weight is imagenet","02259424":"# import necessary packages","1f274da5":"# Compile model","377be55b":"# label","a6f971df":"# import VGG19","03492d7b":"# Tomato Bacterial Spot","9ca30682":"# Visualization for VGG19","59bbdf9e":"# Class Dictionary","37f8a251":"# prediction","9e49567f":"# If you like, please upvote","c2730a14":"# Import all dependencies","5693a984":"# Join train and test with path","3d0936b9":"# path link","e9fac756":"# Save model"}}