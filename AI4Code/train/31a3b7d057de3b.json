{"cell_type":{"68e42880":"code","edb24d32":"code","5afc6777":"code","dab21ba2":"code","34c243bc":"code","cdae909c":"code","55ad7385":"code","9fb9ae96":"code","58f628f8":"markdown","d16b57e1":"markdown"},"source":{"68e42880":"!pip uninstall fastai -y\n!pip install fastai","edb24d32":"from fastai.vision.all import *","5afc6777":"path = Path('..\/input\/landmark-recognition-2020\/')\nPath.BASE_PATH = path\npath.ls()","dab21ba2":"df = pd.read_csv(path\/'train.csv', low_memory=False)\ndf.shape","34c243bc":"def add_path(s):\n    x = s[:3]\n    return f'{x[0]}\/{x[1]}\/{x[2]}\/{s}.jpg'\ndf['id'] = df['id'].apply(add_path)\n\ndf.head()","cdae909c":"gld = DataBlock(blocks=(ImageBlock, CategoryBlock),\n                splitter=RandomSplitter(),\n                get_x=ColReader('id', pref='..\/input\/landmark-recognition-2020\/train\/'),\n                get_y=ColReader('landmark_id'),\n                item_tfms=Resize(448),\n                batch_tfms=aug_transforms(size=224))","55ad7385":"dls = gld.dataloaders(df, bs=32)","9fb9ae96":"dls.show_batch(max_n=9)","58f628f8":"## Setup fastai dataloader","d16b57e1":"## Add paths to csv file"}}