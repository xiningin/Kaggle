{"cell_type":{"4c28c1b2":"code","b6d61877":"code","844b4926":"code","f19d1bd9":"code","ebd2a146":"code","c38896d3":"code","477020ce":"code","08e6a660":"code","a698c451":"code","1899c9ba":"code","4bec70f9":"code","c7f92ab9":"code","8766448e":"code","f60db6c8":"code","a027491e":"code","45d6d298":"code","2e5573c2":"code","45db89da":"code","56130f89":"code","dcaf93ff":"code","89044df2":"code","f438ab5d":"code","18aa67d3":"code","b40b8bc6":"code","77019eeb":"code","cae64eaa":"code","a5767cad":"code","c91f1e4e":"code","e394b212":"code","be0c85a4":"code","43eaea0b":"code","af1a430b":"code","5890858c":"code","95800e95":"code","4882c4eb":"code","ae4d292e":"markdown","00d1ca85":"markdown","b2bc016f":"markdown","546cff29":"markdown","b7eab0ac":"markdown","0acf448c":"markdown","400b94ca":"markdown","f078037c":"markdown","44218396":"markdown"},"source":{"4c28c1b2":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nfrom tensorflow.keras.preprocessing.image import ImageDataGenerator","b6d61877":"dataset=pd.read_csv('..\/input\/digit-recognizer\/train.csv')","844b4926":"dataset","f19d1bd9":"X_train=np.array(dataset.drop(['label'],axis=1))\nY_train=np.array(dataset['label'])","ebd2a146":"X_train","c38896d3":"Y_train","477020ce":"X_train=X_train.reshape(X_train.shape[0],28,28,1)\nX_train=X_train.astype('float32')\nX_train=X_train\/255","08e6a660":"plt.figure()\nplt.imshow(X_train[0][:,:,0])","a698c451":"# CREATE MORE IMAGES VIA DATA AUGMENTATION\ndatagen = ImageDataGenerator(\n        rotation_range=10,  \n        zoom_range = 0.10,  \n        width_shift_range=0.1, \n        height_shift_range=0.1,\n        \n         )","1899c9ba":"import tensorflow as tf","4bec70f9":"X_train.shape","c7f92ab9":"# model=tf.keras.Sequential([\n#     tf.keras.layers.Conv2D(32,(3,3),padding='same',activation=tf.nn.relu,input_shape=(28, 28, 1)),\n#     tf.keras.layers.MaxPooling2D((2,2),strides=2),\n#     tf.keras.layers.Conv2D(64,(3,3),padding='same',activation=tf.nn.relu),\n#     tf.keras.layers.MaxPooling2D((2,2),strides=2),\n#     tf.keras.layers.Flatten(),\n#     tf.keras.layers.Dense(512,activation=tf.nn.relu),\n#     tf.keras.layers.Dense(10,activation=tf.nn.softmax)\n# ])\nmodel = tf.keras.models.Sequential([\n    tf.keras.layers.Conv2D(32, (3,3), activation='relu', padding='same',input_shape=(28,28,1)),\n    tf.keras.layers.MaxPooling2D((2,2),strides=2),\n\n#     tf.keras.layers.Conv2D(64, (3,3), activation='relu'),\n#     tf.keras.layers.MaxPooling2D((2,2),strides=2),\n    \n    tf.keras.layers.Conv2D(64, (3,3), activation='relu'),\n    tf.keras.layers.MaxPooling2D((2,2),strides=2),\n    \n    tf.keras.layers.Conv2D(64, (3,3), activation='relu'),\n    tf.keras.layers.MaxPooling2D((2,2),strides=2),\n    \n    tf.keras.layers.Flatten(),\n    tf.keras.layers.Dropout(0.2),\n    tf.keras.layers.Dense(512, activation='relu'),\n    tf.keras.layers.Dropout(0.2),\n    tf.keras.layers.Dense(10,activation=tf.nn.softmax)\n])","8766448e":"model.compile(optimizer=\"adam\",\n              loss=\"sparse_categorical_crossentropy\",\n              metrics=[\"accuracy\"]\n             )","f60db6c8":"model.fit_generator(datagen.flow(X_train,Y_train, batch_size=64),\n        epochs = 60, steps_per_epoch = X_train.shape[0]\/\/64)","a027491e":"test_df=pd.read_csv('..\/input\/digit-recognizer\/test.csv')","45d6d298":"X_test=np.array(test_df)","2e5573c2":"X_test = X_test.reshape(X_test.shape[0], 28, 28, 1)","45db89da":"X_test=X_test.astype('float32')","56130f89":"X_test\/=255","dcaf93ff":"predictions=model.predict(X_test)","89044df2":"predictions[0]","f438ab5d":"np.argmax(predictions[10])","18aa67d3":"plt.figure()\nplt.imshow(X_test[10][:,:,0])","b40b8bc6":"X_test.shape","77019eeb":"predictions.shape","cae64eaa":"results=[]","a5767cad":"for i in range(28000):\n    results.append(np.argmax(predictions[i]))\n    ","c91f1e4e":"results[4]","e394b212":"results=pd.Series(results,name=\"Label\")","be0c85a4":"results","43eaea0b":"submission=pd.concat([pd.Series(range(1,28001),name=\"ImageId\"),results],axis=1)","af1a430b":"submission","5890858c":"submission.to_csv('My_submissions6',index=False)","95800e95":"my_sub=pd.read_csv('My_submissions6')","4882c4eb":"my_sub","ae4d292e":"# Training the model","00d1ca85":"# Loading Dataset","b2bc016f":"# Applying Normalization","546cff29":"# Using trained model to predict test dataset","b7eab0ac":"# Building Model","0acf448c":"# Importing libraries","400b94ca":"# Making Submission","f078037c":"# Data Augmentation","44218396":"# Splitting Data into X_train and Y_train"}}