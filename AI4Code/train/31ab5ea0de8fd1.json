{"cell_type":{"48696686":"code","16a885f9":"code","7b9f664c":"code","8bcb70de":"code","97bdf37d":"code","88f40528":"code","59f31ea5":"code","577afa0f":"code","111c56a6":"code","11cec30d":"code","5ced8265":"code","1777cc4c":"code","64efc71e":"code","5cd141a1":"code","585a9407":"code","4e9f10a9":"code","27855c78":"code","09e127cc":"code","1e7c22a7":"code","06c57050":"code","70ec045b":"code","f473e2a3":"code","1699afe1":"code","28132ef1":"code","4bf5c13c":"code","0a9e1754":"code","82cc3663":"markdown","a6c50ea4":"markdown","1dbc24d9":"markdown","844446c6":"markdown","d81ad99a":"markdown","fc41540a":"markdown","5273d8e1":"markdown","e020c108":"markdown","3510698a":"markdown","70fbab0d":"markdown","4b7f091b":"markdown","94569bed":"markdown","09bd30de":"markdown","b3920873":"markdown","609cbd90":"markdown","3f575317":"markdown","41aa11ff":"markdown","f9ae8d14":"markdown","6a8a8612":"markdown"},"source":{"48696686":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\n!pip install seaborn==0.11.0\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport plotly.offline as py\nimport plotly.express as px\nimport missingno as msno\nimport plotly.graph_objects as go\nimport plotly.figure_factory as ff\nfrom plotly.subplots import make_subplots\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","16a885f9":"df = pd.read_csv('\/kaggle\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv')\ndf.head()","7b9f664c":"col = ['cutomer_id', 'gender', 'age', 'annual_income', 'spending_score']\ndf.columns = col\n","8bcb70de":"df.info()","97bdf37d":"df.describe()","88f40528":"#Create new feature 'age_cat' to categorize values from 'age' colummn\n\ndf['age_cat'] = np.nan \n\nfor col in [df]:\n    col.loc[(col['age'] >= 18) & (col['age'] <= 35), 'age_cat'] = 'young adult'\n    col.loc[(col['age'] > 35) & (col['age'] <= 55), 'age_cat'] = 'middle age'\n    col.loc[col['age'] > 55, 'age_cat'] = 'senior adult'\n\n    \n#Create new feature 'weight_status' to categorize values from 'bmi' colummn\n\ndf[\"income_class\"] = np.nan\n\nfor col in [df]:\n    col.loc[col[\"annual_income\"] < 32, \"income_class\"] = \"poor\"\n    col.loc[(col[\"annual_income\"] >= 33) & (col[\"annual_income\"] <= 54), \"income_class\"] = \"lower middle\"\n    col.loc[(col[\"annual_income\"] >= 55) & (col[\"annual_income\"] < 106), \"income_class\"] = \"middle\"\n    col.loc[col[\"annual_income\"] >= 106, \"income_class\"] = \"upper middle\"\n    \ndf.head()","59f31ea5":"plt.figure(figsize=(8,8))\nsns.heatmap(df.corr(), cbar = True,  square = True, annot=True, cmap= 'YlGnBu')\nplt.title('FEATURE VARIABLE CORRELATIONS')","577afa0f":"def plot_dist(feature, binsize):\n   \n    hist_data = [df[feature]]\n    group_labels = [feature]\n    colors = ['#41d9b3']\n\n    fig = ff.create_distplot(hist_data, group_labels, colors = colors, show_hist = True, bin_size = binsize, curve_type='kde')\n    \n    fig['layout'].update(title = feature.upper())\n\n    py.iplot(fig, filename = 'Distribution_plot')","111c56a6":"def plot_hist(feature):\n\n    fig = px.histogram(df, x=feature)\n    fig['layout'].update(title = feature.upper())\n    fig.show()","11cec30d":"plot_dist('age', 0)","5ced8265":"plot_dist('annual_income',0)","1777cc4c":"plot_dist('spending_score',0)","64efc71e":"df_gender = df.groupby(['gender'])[['gender']].count()\ndf_gender.rename(columns={'gender':'count'}, inplace=True)\ndf_gender = df_gender.reset_index()\ndf_gender\n\nfig = make_subplots(rows=1, \n                    cols=2, \n                    specs=[[{\"type\": \"xy\"}, {\"type\": \"domain\"}]], \n                    subplot_titles=(\"Gender Count\",\"Gender Percentages\"))\n\nbar_colors=['#c73062','#41d9b3']\npie_colors=['#c73062','#41d9b3']\n\nfig.add_trace(go.Bar(x=df_gender['gender'], \n                     y=df_gender['count'],\n                     text=df_gender['count'],\n                     textposition = 'auto',\n                     name='Gender Count',\n                     opacity = 0.8, \n                     marker=dict(color=bar_colors, line=dict(color='#000000',width=1))), row=1, col=1)\n\nfig.add_trace(go.Pie(labels=df_gender['gender'], \n                     values=df_gender['count'],\n                     textfont=dict(size=15), opacity = 0.8,\n                     hole = 0.5, \n                     hoverinfo = \"label+percent+name\",\n                     domain  = dict(x = [.0,.48]),\n                     name    = \"Gender Percent\",\n                     marker  = dict(colors = pie_colors, line = dict(width = 1.5))), \n              row=1, col=2)\n\nfig.update_layout(height=500, showlegend=True)\n\nfig.show()","5cd141a1":"df_age_cat = df.groupby(['age_cat'])[['age_cat']].count()\ndf_age_cat.rename(columns={'age_cat':'count'}, inplace=True)\ndf_age_cat = df_age_cat.reset_index()\ndf_age_cat.sort_values(by='count', ascending=False, inplace=True)\n\nfig = make_subplots(rows=1, \n                    cols=2, \n                    specs=[[{\"type\": \"xy\"}, {\"type\": \"domain\"}]], \n                    subplot_titles=(\"Age Category Count\",\"Age Category Percentages\"))\n\nbar_colors=['#8fd8ff','#40b1ed', '#0075b3']\npie_colors=['#8fd8ff','#40b1ed', '#0075b3']\n\nfig.add_trace(go.Bar(x=df_age_cat['age_cat'], \n                     y=df_age_cat['count'],\n                     text=df_age_cat['count'],\n                     textposition = 'auto',\n                     name='Age Cateogry Count',\n                     opacity = 0.8, \n                     marker=dict(color=bar_colors, line=dict(color='#000000',width=1))), row=1, col=1)\n\nfig.add_trace(go.Pie(labels=df_age_cat['age_cat'], \n                     values=df_age_cat['count'],\n                     textfont=dict(size=15), opacity = 0.8,\n                     hole = 0.5, \n                     hoverinfo = \"label+percent+name\",\n                     domain  = dict(x = [.0,.48]),\n                     name    = \"Age Category Percent\",\n                     marker  = dict(colors = pie_colors, line = dict(width = 1.5))), \n              row=1, col=2)\n\nfig.update_layout(height=500, showlegend=True)\n\nfig.show()","585a9407":"df_income = df.groupby(['income_class'])[['income_class']].count()\ndf_income.rename(columns={'income_class':'count'}, inplace=True)\ndf_income = df_income.reset_index()\ndf_income.sort_values(by='count', ascending=False, inplace=True)\n\nfig = make_subplots(rows=1, \n                    cols=2, \n                    specs=[[{\"type\": \"xy\"}, {\"type\": \"domain\"}]], \n                    subplot_titles=(\"Income Class Count\",\"Income Class Percentages\"))\n\nbar_colors=['#29cf42', '#5fe373', '#9cf0a9', '#00ad1a']\npie_colors=['#29cf42', '#5fe373', '#9cf0a9', '#00ad1a']\n\nfig.add_trace(go.Bar(x=df_income['income_class'], \n                     y=df_income['count'],\n                     text=df_income['count'],\n                     textposition = 'auto',\n                     name='Income Class Count',\n                     opacity = 0.8, \n                     marker=dict(color=bar_colors, line=dict(color='#000000',width=1))), row=1, col=1)\n\nfig.add_trace(go.Pie(labels=df_income['income_class'], \n                     values=df_income['count'],\n                     textfont=dict(size=15), opacity = 0.8,\n                     hole = 0.5, \n                     hoverinfo = \"label+percent+name\",\n                     domain  = dict(x = [.0,.48]),\n                     name    = \"Income Class Percent\",\n                     marker  = dict(colors = pie_colors, line = dict(width = 1.5))), \n              row=1, col=2)\n\nfig.update_layout(height=500, showlegend=True)\n\nfig.show()","4e9f10a9":"gender_spend_sum = df.groupby(['gender'])[['spending_score']].sum().reset_index()\ngender_spend_avg = df.groupby(['gender'])[['spending_score']].mean().reset_index()\n\ngender_age_spend = df.groupby(['gender','age_cat'])[['spending_score']].sum().reset_index()\ngender_age_spend.sort_values(by='spending_score', ascending=False, inplace=True)","27855c78":"fig = px.histogram(df, \n                   x=\"spending_score\", \n                   color=\"gender\", \n                   marginal=\"box\", \n                   hover_data=df.columns,\n                   nbins = 50,\n                   color_discrete_sequence=['#41d9b3','#c73062'])\nfig.show()","09e127cc":"fig = make_subplots(rows=2, cols=2, \n                    specs=[[{\"type\": \"xy\"}, {\"type\": \"domain\"}], \n                           [{\"type\": \"xy\"}, {\"type\": \"domain\"}]], \n                    subplot_titles=(\"Spending Score Sums\", \"Spending Score Sum Percentages\",\n                                    \"Spending Score Averages\", \"Spending Score Avg Percentages\"))\n\n\nbar_colors=['#c73062','#41d9b3']\npie_colors=['#c73062','#41d9b3']\n\nfig.add_trace(go.Bar(x=gender_spend_sum['gender'], \n                     y=gender_spend_sum['spending_score'],\n                     text=gender_spend_sum['spending_score'],\n                     textposition = 'auto',\n                     name='Spending Score Sums',\n                     opacity = 0.8, \n                     marker=dict(color=bar_colors, line=dict(color='#000000',width=1))), row=1, col=1)\n\nfig.add_trace(go.Bar(x=gender_spend_avg['gender'], \n                     y=gender_spend_avg['spending_score'],\n                     text=gender_spend_avg['spending_score'].round(2),\n                     textposition = 'auto',\n                     name='Spending Score Averages',\n                     opacity = 0.8, \n                     marker=dict(color=bar_colors, line=dict(color='#000000',width=1))), row=2, col=1)\n\nfig.add_trace(go.Pie(labels=gender_spend_sum['gender'], \n                     values=gender_spend_sum['spending_score'],\n                     textfont=dict(size=15), opacity = 0.8,\n                     hole = 0.5, \n                     hoverinfo = \"label+percent+name\",\n                     domain  = dict(x = [.0,.48]),\n                     name    = \"Spending Score Sum Percent\",\n                     marker  = dict(colors = pie_colors, line = dict(width = 1.5))), \n              row=1, col=2)\n\nfig.add_trace(go.Pie(labels=gender_spend_avg['gender'], \n                     values=gender_spend_avg['spending_score'],\n                     textfont=dict(size=15), opacity = 0.8,\n                     hole = 0.5, \n                     hoverinfo = \"label+percent+name\",\n                     domain  = dict(x = [.0,.48]),\n                     name    = \"Spending Score Avg Percent\",\n                     marker  = dict(colors = pie_colors, line = dict(width = 1.5))), \n              row=2, col=2)\n\nfig.update_layout(height=800, showlegend=True)\n\nfig.show()","1e7c22a7":"f_age_spend = gender_age_spend.loc[gender_age_spend['gender'] == 'Female']\nm_age_spend = gender_age_spend.loc[gender_age_spend['gender'] == 'Male']\n\nfig = make_subplots(rows=2, cols=2, \n                    specs=[[{\"type\": \"xy\"}, {\"type\": \"domain\"}], \n                           [{\"type\": \"xy\"}, {\"type\": \"domain\"}]], \n                    subplot_titles=(\"Female Spending Score Sums\", \"Female Spending Score Percentages\",\n                                    \"Male Spending Score Sums\", \"Male Spending Score Percentages\"))\n\nf_bar_colors=['#ff4d94','#cc0245', '#912a53']\nm_bar_colors=['#6ecaff','#0687d1', '#0e5680']\nf_pie_colors=['#ff4d94','#cc0245', '#912a53']\nm_pie_colors=['#6ecaff','#0687d1', '#0e5680']\n\nfig.add_trace(go.Bar(x=f_age_spend['age_cat'], \n                     y=f_age_spend['spending_score'],\n                     text=f_age_spend['spending_score'],\n                     textposition = 'auto',\n                     name='Female Spending Score Sums',\n                     opacity = 0.8, \n                     marker=dict(color=f_bar_colors, line=dict(color='#000000',width=1))), row=1, col=1)\n\nfig.add_trace(go.Bar(x=m_age_spend['age_cat'], \n                     y=m_age_spend['spending_score'],\n                     text=m_age_spend['spending_score'],\n                     textposition = 'auto',\n                     name='Male Spending Score Sums',\n                     opacity = 0.8, \n                     marker=dict(color=m_bar_colors, line=dict(color='#000000',width=1))), row=2, col=1)\n\nfig.add_trace(go.Pie(labels=f_age_spend['age_cat'], \n                     values=f_age_spend['spending_score'],\n                     textfont=dict(size=15), opacity = 0.8,\n                     hole = 0.5, \n                     hoverinfo = \"label+percent+name\",\n                     domain  = dict(x = [.0,.48]),\n                     name    = \"Female Spending Score Percent\",\n                     marker  = dict(colors = f_pie_colors, line = dict(width = 1.5))), \n              row=1, col=2)\n\nfig.add_trace(go.Pie(labels=m_age_spend['age_cat'], \n                     values=m_age_spend['spending_score'],\n                     textfont=dict(size=15), opacity = 0.8,\n                     hole = 0.5, \n                     hoverinfo = \"label+percent+name\",\n                     domain  = dict(x = [.0,.48]),\n                     name    = \"Male Spending Score Percent\",\n                     marker  = dict(colors = m_pie_colors, line = dict(width = 1.5))), \n              row=2, col=2)\n\nfig.update_layout(height=800, showlegend=True)\n\nfig.show()","06c57050":"fig = px.scatter(df, x=\"spending_score\", y=\"age\", color='gender')\nfig.show()","70ec045b":"spending_y = df[['spending_score']].loc[df['age_cat'] == 'young adult']\nspending_m = df[['spending_score']].loc[df['age_cat'] == 'middle age']\nspending_s = df[['spending_score']].loc[df['age_cat'] == 'senior adult']\n\nyoung = spending_y['spending_score']\nmiddle = spending_m['spending_score']\nsenior = spending_s['spending_score']\n    \nhist_data = [young, middle, senior]\n    \ngroup_labels = ['young adult', 'middle age', 'senior adult']\ncolors = ['#e8b920','#2aa8a8', '#e8204b']\n\nfig = ff.create_distplot(hist_data, group_labels, colors = colors, show_hist = True, bin_size = 0, curve_type='kde')\n    \nfig['layout'].update(title = 'SPENDING SCORE x AGE CATEGORY')\n\nfig.show()\n\n# py.iplot(fig, filename = 'Density plot')","f473e2a3":"income_spend_sum = df.groupby(['income_class'])[['spending_score']].sum().reset_index()\nincome_spend_avg = df.groupby(['income_class'])[['spending_score']].mean().reset_index()\nincome_spend_avg","1699afe1":"fig = px.scatter(df, x=\"spending_score\", y=\"annual_income\", color='age_cat')\nfig.show()","28132ef1":"fig = make_subplots(rows=2, cols=2, \n                    specs=[[{\"type\": \"xy\"}, {\"type\": \"domain\"}], \n                           [{\"type\": \"xy\"}, {\"type\": \"domain\"}]], \n                    subplot_titles=(\"Spending Score Sums\", \"Spending Score Sum Percentages\",\n                                    \"Spending Score Averages\", \"Spending Score Avg Percentages\"))\n\nbar_colors=['#29cf42', '#5fe373', '#9cf0a9', '#00ad1a']\npie_colors=['#29cf42', '#5fe373', '#9cf0a9', '#00ad1a']\n\nfig.add_trace(go.Bar(x=income_spend_sum['income_class'], \n                     y=income_spend_sum['spending_score'],\n                     text=income_spend_sum['spending_score'],\n                     textposition = 'auto',\n                     name='Spending Score Sums',\n                     opacity = 0.8, \n                     marker=dict(color=bar_colors, line=dict(color='#000000',width=1))), row=1, col=1)\n\nfig.add_trace(go.Bar(x=income_spend_avg['income_class'], \n                     y=income_spend_avg['spending_score'],\n                     text=income_spend_avg['spending_score'].round(2),\n                     textposition = 'auto',\n                     name='Spending Score Averages',\n                     opacity = 0.8, \n                     marker=dict(color=bar_colors, line=dict(color='#000000',width=1))), row=2, col=1)\n\n\nfig.add_trace(go.Pie(labels=income_spend_sum['income_class'], \n                     values=income_spend_sum['spending_score'],\n                     textfont=dict(size=15), opacity = 0.8,\n                     hole = 0.5, \n                     hoverinfo = \"label+percent+name\",\n                     domain  = dict(x = [.0,.48]),\n                     name    = \"Income Class Percent\",\n                     marker  = dict(colors = pie_colors, line = dict(width = 1.5))), \n              row=1, col=2)\n\n\nfig.add_trace(go.Pie(labels=income_spend_avg['income_class'], \n                     values=income_spend_avg['spending_score'],\n                     textfont=dict(size=15), opacity = 0.8,\n                     hole = 0.5, \n                     hoverinfo = \"label+percent+name\",\n                     domain  = dict(x = [.0,.48]),\n                     name    = \"Income Class Percent\",\n                     marker  = dict(colors = pie_colors, line = dict(width = 1.5))), \n              row=2, col=2)\n\nfig.update_layout(height=800, showlegend=True)\n\nfig.show()","4bf5c13c":"fig = px.scatter(df, x=\"age\", y=\"annual_income\", color='income_class')\nfig.show()","0a9e1754":"age_income_avg = df.groupby(['age_cat'])[['annual_income']].mean().reset_index()\n\nfig = make_subplots(rows=1, cols=2, \n                    specs=[[{\"type\": \"xy\"}, {\"type\": \"domain\"}]], \n                    subplot_titles=(\"Income Averages\", \"Income Percentages\"))\n\n\nbar_colors=['#4c98a1','#2aa8a8', '#006e6e']\npie_colors=['#4c98a1','#2aa8a8', '#006e6e']\n\nfig.add_trace(go.Bar(x=age_income_avg['age_cat'], \n                     y=age_income_avg['annual_income'],\n                     text=age_income_avg['annual_income'].round(2),\n                     textposition = 'auto',\n                     name='Income Averages',\n                     opacity = 0.8, \n                     marker=dict(color=bar_colors, line=dict(color='#000000',width=1))), row=1, col=1)\n\nfig.add_trace(go.Pie(labels=age_income_avg['age_cat'], \n                     values=age_income_avg['annual_income'],\n                     textfont=dict(size=15), opacity = 0.8,\n                     hole = 0.5, \n                     hoverinfo = \"label+percent+name\",\n                     domain  = dict(x = [.0,.48]),\n                     name    = \"Income Percentages\",\n                     marker  = dict(colors = pie_colors, line = dict(width = 1.5))), \n              row=1, col=2)\n\n\n\nfig.update_layout(height=500, showlegend=True)\n\nfig.show()","82cc3663":"### GENDER COUNT AND PERCENTAGES","a6c50ea4":"### AGE CATEGORY COUNT AND PERCENTAGES","1dbc24d9":"### SPENDING SCORE SUMS AND PERCENTAGES BY GENDER & AGE CATEGORY","844446c6":"### SPENDING SCORE VS ANNUAL INCOME","d81ad99a":"### SPENDING SCORES BY GENDER","fc41540a":"### SPENDING SCORE VS AGE","5273d8e1":"# <a id='1'>I. LOAD PACKAGES & LIBRARIES<\/a>","e020c108":"# <a id='3'>III. FEATURE ENGINEERING<\/a>","3510698a":"We'll start by writing some plotting functions","70fbab0d":"# <a id='2'>II. DATA OVERVIEW & INSIGHTS<\/a>","4b7f091b":"### SPENDING SCORE SUMS & PERCENTAGES BY INCOME CLASS","94569bed":"<p  style=\"text-align: center;\"><font size=\"12\">MALL CUSTOMER SEGMENTATION<\/font><\/p>\n<p  style=\"text-align: center;\"><font size=\"4\">AN EXPLORATORY DATA ANALYSIS<\/font><\/p>\n\n<img src=\"https:\/\/images.unsplash.com\/photo-1519567241046-7f570eee3ce6?ixid=MXwxMjA3fDB8MHxzZWFyY2h8MXx8c2hvcHBpbmclMjBjZW50ZXJ8ZW58MHx8MHw%3D&ixlib=rb-1.2.1&w=1000&q=80\" alt=\"mall\">  \n\nIt is the number one goal of a mall to attract and retain customers. To meet that goal it is helpful to have insight into customers and their spending habits to aid in the development of marketing strategies.","09bd30de":"## <a id='4a'>IVa. UNIVARIATE EXPLORATION<\/a>\n\nLets take a look at the distribution of our continuous variables","b3920873":"### INCOME CLASS COUNT AND PERCENTAGES","609cbd90":"#### We'll use bar and pie plots to visualize categorical variables","3f575317":"### INCOME X AGE","41aa11ff":"## <a id='4b'>IVb. BIVARIATE EXPLORATION<\/a>","f9ae8d14":"<h3 class=\"list-group-item list-group-item-action active\" data-toggle=\"list\"  role=\"tab\" aria-controls=\"home\">Table of Contents<\/h3>\n\n* <a href='#1'>I. LOAD LIBRARIES & PACKAGES<\/a>\n\n* <a href='#2'>II. DATA OVERVIEW & INSIGHTS<\/a>\n\n* <a href='#3'>III. FEATURE ENGINEERING<\/a>\n    \n* <a href='#4'>IV. EXPLORATORY DATA ANALYSIS<\/a>\n    * <a href='#4a'>IVa. Univariate Exploration<\/a> \n    * <a href='#4b'>IVb. Bivariate Exploration<\/a> \n    ","6a8a8612":"# <a id='4'>IV. EXPLORATORY DATA ANALYSIS<\/a> "}}