{"cell_type":{"f03e513f":"code","b1b79cdf":"code","e8e7f511":"code","5fa9ac34":"code","d8167935":"code","2f0c624b":"code","19003288":"code","159db8bf":"code","09e63c5a":"code","ddd4491e":"code","1f332a1e":"code","08aeeef1":"code","fa2aeb9d":"code","0be89842":"code","ac16c51c":"code","fa36fc0d":"code","d463f155":"code","41d45da7":"code","042a3a67":"code","1a15fc2b":"code","ce85d6ca":"code","6f210e22":"code","cb7931f1":"code","c4b849a5":"code","687b4875":"code","497d97f3":"code","ca92c6ec":"code","c0cf928e":"code","f1ce0b82":"code","ea08aecc":"code","cbfbde19":"code","891079ad":"code","0354380d":"code","a8c2175f":"code","3015f9c8":"code","f2f4cb2c":"markdown","af91ba89":"markdown","2184ba1f":"markdown","45840f29":"markdown","a88e39c3":"markdown","93966fb8":"markdown","c3df1bf5":"markdown","a855345b":"markdown","89f82fad":"markdown","2d6a4c6e":"markdown","a9020d8e":"markdown","970fa1a0":"markdown","d644ed2f":"markdown","59b09d02":"markdown","6373a80f":"markdown","703d35d2":"markdown","f03c8d0a":"markdown","54e14a29":"markdown","ab8d09e8":"markdown","cf5fea4e":"markdown","b8603c68":"markdown","9c06fda5":"markdown","8d4fc014":"markdown","c75c59eb":"markdown"},"source":{"f03e513f":"import numpy as np\nimport pandas as pd \nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport warnings\n%matplotlib inline\nwarnings.filterwarnings(\"ignore\")\npd.options.display.max_columns = 10","b1b79cdf":"data_report_2021 = pd.read_csv('\/kaggle\/input\/world-happiness-report-2021\/world-happiness-report-2021.csv')\ndata_report_old = pd.read_csv('\/kaggle\/input\/world-happiness-report-2021\/world-happiness-report.csv')","e8e7f511":"data_report_2021.head()","5fa9ac34":"def set_region_label(regional_indicator):\n    '''\n    Assign to each regional indicator the main region.\n    \n    Parameters:\n        regional_indicator: column from the dataset data_report_2021\n    '''\n    if regional_indicator in ['Central and Eastern Europe', 'Western Europe']:\n        return 'Europe'\n    elif regional_indicator in ['East Asia', 'South Asia', 'Southeast Asia']:\n        return 'Asia'\n    elif regional_indicator in ['Middle East and North Africa', 'Sub-Saharan Africa']:\n        return 'Africa'\n    elif regional_indicator == 'Commonwealth of Independent States':\n        return 'Commonwealth of Independent States'\n    elif regional_indicator == 'Latin America and Caribbean':\n        return 'Latin America and Caribbean'\n    elif regional_indicator == 'North America and ANZ':\n        return 'North America and ANZ'","d8167935":"data_report_2021['region_label'] = data_report_2021['Regional indicator'].apply(set_region_label)","2f0c624b":"describing_variables = list(data_report_2021.columns[data_report_2021.columns.str.startswith('Explained')])\ndescribing_variables.append('region_label')","19003288":"print(data_report_2021['region_label'].value_counts())","159db8bf":"summary_region = data_report_2021[['Regional indicator','Ladder score','region_label']].groupby(['region_label','Regional indicator']).agg(['mean','max','min', 'median'])\nsummary_region.columns = ['{}_{}'.format(col[0], col[1]) for col in summary_region.columns]\nsummary_region.reset_index(inplace = True)\nsummary_region","09e63c5a":"summary_region.sort_values(by = 'Ladder score_mean', ascending = False, inplace = True)","ddd4491e":"sns.set(font_scale = 2, rc={'figure.figsize':(15,10)})\nregion_plot_score = sns.barplot(x=summary_region['Ladder score_mean'],y=summary_region['Regional indicator'])\nregion_plot_score.set_title('Mean score of happiness in each region in 2021', size = 20)\nregion_plot_score.set_xlabel(region_plot_score.get_xlabel(), fontsize=15)\nregion_plot_score.set_ylabel(region_plot_score.get_ylabel(), fontsize=15);","1f332a1e":"sns.set(font_scale = 2, rc={'figure.figsize':(15,10)})\nregion_swarm_score = sns.swarmplot(x=\"Ladder score\", y=\"region_label\", data=data_report_2021, size = 15)\nregion_swarm_score.set_title('Swarmplot of happiness score in regions')\nregion_swarm_score.set_ylabel('');","08aeeef1":"sns.set(font_scale = 1.5, rc={'figure.figsize':(20,15)})\nplot_describing_variables = sns.pairplot(data=data_report_2021, vars = describing_variables[:3], hue=\"region_label\", diag_kind=\"hist\", size = 5, height=7, plot_kws={'s':50})\nplot_describing_variables.fig.suptitle('Pair Plot of Socioeconomic Data in 2021', size = 30);","fa2aeb9d":"def create_combined_plots(data, columname):\n    '''\n    Draws combined two plots depends on score of hapiness (scateer plot and density plot) grouping by region.\n    \n    Parameters:\n        data: the dataset data_report_2021\n        columname: the name of column (independent variable) from data_report_2021 dataset\n    '''\n    sns.set(font_scale = 1.2)\n    plot = sns.jointplot(x = columname, y = 'Ladder score', data = data, hue = 'region_label', height =10, joint_kws=dict(sizes = 50))\n    plot","0be89842":"create_combined_plots(data = data_report_2021, columname = 'Healthy life expectancy');","ac16c51c":"create_combined_plots(data = data_report_2021, columname = 'Logged GDP per capita');","fa36fc0d":"create_combined_plots(data = data_report_2021, columname = 'Social support');","d463f155":"create_combined_plots(data = data_report_2021, columname = 'Freedom to make life choices');","41d45da7":"create_combined_plots(data = data_report_2021, columname = 'Generosity');","042a3a67":"create_combined_plots(data = data_report_2021, columname = 'Perceptions of corruption');","1a15fc2b":"'They are living in {}.'.format(data_report_2021[data_report_2021['Ladder score'] == max(data_report_2021['Ladder score'])]['Country name'].to_string(index = False))","ce85d6ca":"'They are living in {}.'.format(data_report_2021[data_report_2021['Ladder score'] == min(data_report_2021['Ladder score'])]['Country name'].to_string(index = False))","6f210e22":"happiest_countries = data_report_2021.sort_values('Ladder score', ascending = False).head(10)\nhappiest_countries['level'] = 'happiest'\nunhappiest_countries= data_report_2021.sort_values('Ladder score', ascending = True).head(10)\nunhappiest_countries['level'] = 'unhappiest'\n\ntop_countries = pd.concat([happiest_countries, unhappiest_countries], ignore_index=True)","cb7931f1":"top_countries.groupby('region_label')['level'].value_counts().sort_values().unstack().fillna(0)","c4b849a5":"color_condiction_level = ['red' if x < 7 else 'yellowgreen' for x in top_countries['Ladder score']] \nsns.set(font_scale = 2)\npp = sns.barplot(x=\"Ladder score\", y=\"Country name\", data=top_countries,\n            label=\"Ladder score\", palette = color_condiction_level);\n\nfor index, row in top_countries.iterrows():\n    pp.text(row['Ladder score'], index, round(row['Ladder score'],2), color = 'black',  size = 'small')\n\npp.set_title('The top 10 the happiest countries and the unhappiest countries in 2021',  size = 30);","687b4875":"colors = sns.color_palette(\"Paired\")\nexplainable_variables = describing_variables[:-1]\nsns.set(font_scale = 2)\nsns.barplot(x=explainable_variables[0] , y=\"Country name\", data=top_countries, label=explainable_variables[0], color=colors[1]);","497d97f3":"sns.barplot(x=explainable_variables[1] , y=\"Country name\", data=top_countries, label=explainable_variables[1], color=colors[2]);","ca92c6ec":"sns.barplot(x=explainable_variables[2] , y=\"Country name\", data=top_countries, label=explainable_variables[2], color=colors[3]);","c0cf928e":"rc={'axes.labelsize': 32, 'font.size': 32,  'axes.titlesize': 22, 'figure.figsize':(20,10)}\nsns.set(rc=rc, font_scale=2)\ng = sns.PairGrid(top_countries, x_vars=explainable_variables[3:6], y_vars=\"Country name\",\n                 height=15, aspect=.5)\ng.map(sns.stripplot, size=20, orient=\"h\", jitter=False,\n      palette=\"flare_r\", linewidth=1, edgecolor=\"w\")\n\ng.set(xlim=(0, 2), xlabel=\"\", ylabel=\"\")\n\n\nfor ax, title in zip(g.axes.flat, explainable_variables[3:6]):\n\n    ax.set(title=title)\n    ax.set_xlabel(ax.get_xlabel(), fontsize = 90)\n    ax.xaxis.grid(True)\n    ax.yaxis.grid(True)\n\n\nsns.despine(left=True, bottom=True)","f1ce0b82":"print( \"Countries, which participated in survey 2021: {}\".format(len(data_report_2021['Country name'].unique())))\nprint( \"Countries, which participate at least in the survey since 2006: {}\".format(len(data_report_old['Country name'].unique())))","ea08aecc":"region_dict = data_report_2021[['Country name','Regional indicator', 'region_label']]\ndata = data_report_old.merge(region_dict, how = 'left', on = 'Country name')","cbfbde19":"data[data['Regional indicator'].isnull()]['Country name'].value_counts()","891079ad":"data_years = data[~data['region_label'].isnull()]","0354380d":"mean_indicators_each_region = data.groupby(['region_label', 'year']).mean()\nmedian_indicators_each_region = data.groupby(['region_label', 'year']).median()\nmean_indicators_each_region.reset_index(inplace=True) \nmedian_indicators_each_region.reset_index(inplace=True) ","a8c2175f":"sns.set_theme(style=\"whitegrid\")\nmean_score_time_plot = sns.lineplot(data=mean_indicators_each_region,x = 'year', y='Life Ladder' ,palette=\"tab10\", linewidth=2.5, hue = 'region_label')\nmean_score_time_plot.set_title('Mean score of happiness in time',  size = 30);\nmean_score_time_plot.set_ylabel('mean score', fontsize=20)\nmean_score_time_plot.set_xlabel('year', fontsize=20);","3015f9c8":"sns.set_theme(style=\"whitegrid\")\nmean_score_time_plot = sns.lineplot(data=median_indicators_each_region,x = 'year', y='Life Ladder' ,palette=\"tab10\", linewidth=2.5, hue = 'region_label')\nmean_score_time_plot.set_title('Median score of happiness in time',  size = 30);\nmean_score_time_plot.set_ylabel('median score', fontsize=20)\nmean_score_time_plot.set_xlabel('year', fontsize=20);","f2f4cb2c":"## Lists of countries with some lack response on surveys","af91ba89":"## What were people asked about? -  data sources and variable definitions","2184ba1f":"### Variables \n\n**Ladder score** - Happiness score or subjective well-being. This is the national average response to the question of life evaluations. \n*  Question: *Please imagine a ladder, with steps numbered from 0 at the bottom to 10 at the top. The top of the ladder represents the best possible life for you and the bottom of the ladder represents the worst possible life for you. On which step of the ladder would you say you personally feel you stand at this time?*\n\n**Logged GDP per capita** - *The GDP-per-capita time series from 2019 to 2020 using countryspecific forecasts of real GDP growth in 2020.*\n\n**Social support** - *Is the national average of the binary responses (either 0 or 1) to the GWP question \u201cIf you were in trouble, do you have relatives or friends you can count on to help you whenever you need them, or not.*\n\n**Healthy life expectancy** - *Healthy life expectancies at birth are based on the data extracted from the World Health Organization\u2019s (WHO) Global Health Observatory data repository (Last updated: 2020-09-28)*\n\n**Freedom to make life choices** - *Is is the national average of responses to the GWP question \u201cAre you satisfied or dissatisfied with your freedom to choose what you do with your life?*\n\n**Generosity** - *Generosity is the residual of regressing national average of response to the GWP question \u201cHave you donated money to a charity in the past month?\u201d on GDP per capita.*\n\n**Perceptions of corruption** - *The measure is the national average of the survey responses to two questions in the GWP: \u201cIs corruption widespread throughout the government or not\u201d and \u201cIs corruption widespread within businesses or not?\u201d*\n\n**Ladder score in Dystopia** - *It has values equal to the world\u2019s lowest national averages. Dystopia as a benchmark against which to compare contributions from each of the six factors.*\n\n\nMore information about a survey: https:\/\/worldhappiness.report\/ed\/2021\/","45840f29":"# The representation of the distribution of score of happiness in each region (2021)\n## We should keep in mind that it occurs a disparity in scores in some regions. It will influence the aggregating results.","a88e39c3":"<a id=\"1\"><\/a>\n# <div class=\"alert alert-block alert-info\"> What's differentiates the top 10 happiest countries out of the rest?<\/div> ","93966fb8":"<a id=\"1\"><\/a>\n# <div class=\"alert alert-block alert-info\">Response results in 2021<\/div> ","c3df1bf5":"## Dotplots","a855345b":"<a id=\"1\"><\/a>\n# <div class=\"alert alert-block alert-info\">Where lived the happiest people in 2021 ?<\/div> ","89f82fad":"## **Freedom to make life choices**","2d6a4c6e":"## **Perceptions of corruption**","a9020d8e":"## **Social support**","970fa1a0":"![image.png](attachment:f6a28ede-3ae5-4baf-ac08-71239b3464f9.png)![image.png](attachment:fd594dfb-ec7c-4908-b63c-7367f473a6c7.png)","d644ed2f":"<a id=\"1\"><\/a>\n# <div class=\"alert alert-block alert-info\"> Dynamics of happiness<\/div> ","59b09d02":"## An interesting fact is that the level of generosity in almost all countries is similar. It is not a significant disproportion between them compared to other presenting plots, for example, Social support or Logged GDP per capita. ","6373a80f":"# How many countries are in each region (survey 2021) ?","703d35d2":"# World Happiness Report 2021","f03c8d0a":"<a id=\"1\"><\/a>\n# <div class=\"alert alert-block alert-info\">A general look at measure of happiness in 2021<\/div> ","54e14a29":"<a id=\"1\"><\/a>\n# <div class=\"alert alert-block alert-info\">Where lived the least happy people in 2021 ?<\/div> ","ab8d09e8":"## **Healthy life expectancy**","cf5fea4e":"## **Logged GDP per capita**","b8603c68":"## **Generosity**","9c06fda5":"# Visual ways of presenting measures, which describe the top 10 happiest countries and the unhappiest countries in 2021","8d4fc014":"# Main summary statistics","c75c59eb":"## Barplots"}}