{"cell_type":{"adb62ee0":"code","1f57e673":"code","12e5f07a":"code","081fe28b":"code","96109e58":"code","2cc2d001":"code","b5971f0f":"code","20fea979":"code","2b327e0c":"code","43fc3184":"code","d656ea3f":"code","81adb215":"code","711e6f31":"code","fc34d67a":"code","407de75f":"code","ccc36e3f":"code","7e1f2d74":"code","23c0d3db":"code","1939204f":"code","78750afc":"code","a28747f0":"code","b5f70a2c":"code","58f70416":"code","2e045126":"code","4cc40951":"code","d5c03699":"code","01510820":"code","9c23920d":"code","4f023145":"markdown","2b737795":"markdown","69021e32":"markdown","c9dc786f":"markdown","ed0eb981":"markdown","3acd173b":"markdown","9ec3375c":"markdown","4cf12ede":"markdown","96c9c9e3":"markdown","0481e1bc":"markdown","4707a220":"markdown","fd46b5b4":"markdown","381ac926":"markdown","27f5a280":"markdown"},"source":{"adb62ee0":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport missingno as msno","1f57e673":"df = pd.read_csv('..\/input\/logistic-regression\/Social_Network_Ads.csv')","12e5f07a":"df.head()","081fe28b":"df.info()","96109e58":"msno.bar(df)","2cc2d001":"Gender = pd.get_dummies(df['Gender'], drop_first=True)\n\ndf = pd.concat([df, Gender], axis=1)","b5971f0f":"df.head()","20fea979":"df['Male'] = df['Male'].astype(float)","2b327e0c":"df.info()","43fc3184":"plt.figure(figsize=(10,6))\nsns.countplot(x='Gender', data=df, palette='magma', alpha=0.4)\nsns.despine(left=True)","d656ea3f":"plt.figure(figsize=(10,6))\nsns.boxplot(x='Gender', y='EstimatedSalary', data=df, palette='plasma')\nsns.despine(left=True)","81adb215":"plt.figure(figsize=(14,10))\nsns.scatterplot(x='EstimatedSalary', y='Age', data=df, hue=df['Purchased'], palette='GnBu', s=100, alpha=0.9)\nsns.despine(left=True)","711e6f31":"df_purc = df.groupby(df['Purchased']).mean()\ndf_purc = df_purc.reset_index()\nfig, ax =plt.subplots(nrows= 1, ncols = 3, figsize= (14,6))\nw = sns.barplot(x='Purchased', y= 'Age', data=df_purc, palette='GnBu', ax=ax[0])\ni = sns.barplot(x='Purchased', y= 'EstimatedSalary', data=df_purc, palette='magma', ax=ax[1])\nh = sns.barplot(x='Purchased', y= 'Male', data=df_purc, palette='GnBu', ax=ax[2])\nsns.despine(left=True)\n\nw.set_title('Purchased or Not: Average Age')\nw.set_ylabel('Age')\n\ni.set_title('Purchased or Not: Average Estimated Salary')\ni.set_ylabel('Estimated Salary')\n\nh.set_title('Purchased or Not: Male = 1, Female = 0')\nh.set_ylabel('Gender')\n","fc34d67a":"X = df.drop(['User ID', 'Gender', 'Purchased'], axis=1)\ny = df['Purchased']","407de75f":"X.head()","ccc36e3f":"from sklearn.preprocessing import StandardScaler\nscaler = StandardScaler()\nscaler.fit(X)\nscaled_data = scaler.transform(X)","7e1f2d74":"scaled_data = pd.DataFrame(scaled_data, columns= X.columns)","23c0d3db":"scaled_data.head()","1939204f":"from sklearn.feature_selection import SelectKBest,chi2\ntest=SelectKBest(score_func=chi2,k=2)\nfit=test.fit(X,y)\nprint(fit.scores_)","78750afc":"from sklearn.model_selection import train_test_split\nX_train, X_test,y_train,y_test = train_test_split(scaled_data,y, test_size=0.3)","a28747f0":"from sklearn.linear_model import LogisticRegression\nlogreg = LogisticRegression()\nlogreg.fit(X_train, y_train)","b5f70a2c":"prediction = logreg.predict(X_test)","58f70416":"from sklearn.metrics import classification_report\nprint(classification_report(y_test, prediction))","2e045126":"from sklearn.neighbors import KNeighborsClassifier\nerror_rate = []\nfor i in range(1,16):\n    knn = KNeighborsClassifier(n_neighbors=i)\n    knn.fit(X_train, y_train)\n    prediction_k = knn.predict(X_test)\n    error_rate.append(np.mean(prediction_k !=y_test))","4cc40951":"error_rate = pd.DataFrame(error_rate,range(1,16), columns=['Error Rate']).reset_index()\nerror_rate = error_rate.rename(columns={'index': 'K Value'})","d5c03699":"plt.figure(figsize=(12,7))\ng = sns.set(style=\"white\")\ng = sns.lineplot(x='K Value', y='Error Rate', data=error_rate, color='green')\nf = sns.scatterplot(x='K Value', y='Error Rate', data=error_rate, color='red', s=100)\n\ng.set_title('Error Rate Analysis')\ng.set_ylabel('Error Rate')\ng.set_xlabel('K Value')\ng =sns.despine(left=True)","01510820":"knn = KNeighborsClassifier(n_neighbors=5)\nknn.fit(X_train, y_train)\nprediction_5 = knn.predict(X_test)","9c23920d":"from sklearn.metrics import classification_report\nprint(classification_report(y_test, prediction_k))","4f023145":"# Evaluation","2b737795":"* We will chose the K Value to be 5 because after that there is no significant drop in the error rate so this seems optimum","69021e32":"# Evaluation","c9dc786f":"# Elbow Method","ed0eb981":"# Graphical Plots to analyze relation of variables in Dataset","3acd173b":"# K Nearest Neighbor Classification","9ec3375c":"# Loading the Dataset","4cf12ede":"# Hello Guys. I have performed Logistic Regression & K Nearest Neighbor (KNN) on Online Ad purchase\n* First I loaded the Dataset\n* then I checked for any missing values and cleaned the data.\n* Changed some of the datatypes to make it more readable for the regression\n* Performed some Graphical Plotting to see the relations between vairables\n\n# Performed Logistic Regression\n* Scaled the Data\n* Performed Evaluation Report on the Model\n\n# K Nearest Classifier\n* Elbow Method for K Nearest Neighbor Model\n* Evaluation Report on the Model","96c9c9e3":"# Logistic Regression","0481e1bc":"We observe that people with age 30 and above plus salary of 80,000 and above tend to purhase more from Online advertisements","4707a220":"# Scaling the Data for Regression","fd46b5b4":"# Checking for Null Values and Changing Data Types to Clean the Data","381ac926":"* We have already scaled the data for Logistic regression\n* We have already seperated train and test data before\n* We will now directly proceed by running the model on the same data set\n","27f5a280":"# K Nearest Neighbor\n* We will now classify the same data with KNN Classifier\n* First we will perform Elbow Method to find out the right value of K\n* then we will run KNN Analysis on the Dataset\n* Finally we will evaluate the Data"}}