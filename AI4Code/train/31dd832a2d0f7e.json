{"cell_type":{"6d81611c":"code","ae6b6a6f":"code","905f300e":"code","05db27b4":"code","5640cff4":"code","f43e4bb2":"code","6f7f9045":"code","efece989":"code","3cbc9ec9":"code","c23dd5cd":"code","0aa3b926":"code","07266b66":"code","9dc62e17":"code","1050a8cd":"code","c35b00e9":"code","052286b9":"code","7bba91e6":"code","1e27e950":"code","355da4a1":"code","b42f700a":"code","585f98d8":"code","a6e65da3":"code","6b2a178c":"code","c36e8dcd":"code","65b139df":"code","15a190ec":"code","b31a85bd":"code","74fbe649":"code","af4d3071":"code","144b5a1d":"code","63628139":"code","0b75c9bd":"code","2b24ba17":"code","c0415f2c":"code","15509d2d":"code","90f60b02":"code","262656ce":"code","dd985bd2":"code","069b6866":"code","9c4c142d":"code","2cf68423":"code","a2421593":"code","61376e0e":"markdown","25fea540":"markdown","35fe76b4":"markdown","8e4187b4":"markdown","45201756":"markdown","178557fc":"markdown","e4e86179":"markdown","fcbf3357":"markdown","37981996":"markdown","2cf2cc09":"markdown","3082c066":"markdown","40226e13":"markdown","09940efe":"markdown","93b5cb8b":"markdown","3153c5bf":"markdown","57aa260c":"markdown","11c0b7b4":"markdown","6d80b4e8":"markdown","82477d09":"markdown","a6bf00b5":"markdown","453bfbdd":"markdown","ceae94de":"markdown","481583bc":"markdown","7aa36cc0":"markdown","b66b95bc":"markdown","f9e210fa":"markdown","ceda3f10":"markdown","d0c818dd":"markdown","6118821b":"markdown","14ef22bd":"markdown","96c1ca31":"markdown","b2484eaf":"markdown","a9d3b1f2":"markdown","bcfe1aab":"markdown","bd7dbd94":"markdown","7a110360":"markdown","082e6f87":"markdown","b2e14821":"markdown","79545d4c":"markdown","e7fd80ae":"markdown","ffbfb954":"markdown","d71a1c8b":"markdown","0e2533e7":"markdown","b85fab68":"markdown","c25630b0":"markdown"},"source":{"6d81611c":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set_style(\"whitegrid\")","ae6b6a6f":"data=pd.read_csv('..\/input\/insurance\/insurance.csv')\ndata.head()","905f300e":"data.iloc[:,[0,2,6]].describe()","05db27b4":"sns.distplot(data['age'])","5640cff4":"sns.boxplot(y='age',data=data,color='green')","f43e4bb2":"sns.scatterplot(x=\"age\", y=\"bmi\", hue='sex',data=data,color='red')","6f7f9045":"sns.boxplot(x='sex',y='age',data=data)","efece989":"f= plt.figure(figsize=(12,5))\n\nax=f.add_subplot(121)\nsns.distplot(data[(data.sex == 'male')][\"age\"],color='b',ax=ax)\nax.set_title('Distribution of ages of male')\n\nax=f.add_subplot(122)\nsns.distplot(data[(data.sex == 'female')]['age'],color='r',ax=ax)\nax.set_title('Distribution of ages of female')","3cbc9ec9":"sns.boxplot(x='smoker',y='age',data=data)","c23dd5cd":"f= plt.figure(figsize=(12,5))\n\nax=f.add_subplot(121)\nsns.distplot(data[(data.smoker == 'yes')][\"age\"],color='#b0b0b0',ax=ax)\nax.set_title('Distribution of ages of smoker')\n\nax=f.add_subplot(122)\nsns.distplot(data[(data.smoker == 'no')]['age'],color='#333ed6',ax=ax)\nax.set_title('Distribution of ages of non smoker')","0aa3b926":"sns.catplot(x=\"smoker\", kind=\"count\",hue = 'sex',palette='GnBu',data=data)","07266b66":"sns.boxplot(x='smoker',y='charges',palette='viridis',data=data)","9dc62e17":"f= plt.figure(figsize=(12,5))\n\nax=f.add_subplot(121)\nsns.distplot(data[(data.smoker == 'yes')][\"charges\"],color='#b0b0b0',ax=ax)\nax.set_title('Distribution of charges of smoker')\n\nax=f.add_subplot(122)\nsns.distplot(data[(data.smoker == 'no')]['charges'],color='#333ed6',ax=ax)\nax.set_title('Distribution of charges of non smoker')","1050a8cd":"sns.boxplot(x='smoker',y='charges',data=data[(data.age>=18)&(data.age<=22)])","c35b00e9":"sns.scatterplot(x=\"age\", y=\"charges\", data=data[data.smoker=='yes'],color='purple')","052286b9":"g = sns.jointplot(x=\"age\", y=\"charges\", data=data[data.smoker=='yes'], kind=\"kde\", color=\"b\")\ng.plot_joint(plt.scatter, c=\"w\", s=30, linewidth=1, marker=\"+\")\ng.ax_joint.collections[0].set_alpha(0)\ng.set_axis_labels(\"age\", \"charges\");","7bba91e6":"sns.jointplot(x=\"age\", y=\"charges\", data=data[data.smoker=='yes'], kind=\"kde\");","1e27e950":"sns.scatterplot(x=\"age\", y=\"charges\", data=data[data.smoker=='no'],color='#82113a')","355da4a1":"g = sns.jointplot(x=\"age\", y=\"charges\", data=data[data.smoker=='no'], kind=\"kde\", color=\"#82113a\")\ng.plot_joint(plt.scatter, c=\"w\", s=30, linewidth=1, marker=\"+\")\ng.ax_joint.collections[0].set_alpha(0)\ng.set_axis_labels(\"age\", \"charges\");","b42f700a":"sns.jointplot(x=\"age\", y=\"charges\", data=data[data.smoker=='no'],color='#82113a', kind=\"kde\");","585f98d8":"sns.boxplot(x='sex',y='bmi',palette='viridis',data=data)","a6e65da3":"f= plt.figure(figsize=(12,5))\n\nax=f.add_subplot(121)\nsns.distplot(data[(data.sex == 'male')][\"bmi\"],color='b',ax=ax)\nax.set_title('Distribution of bmi of male')\n\nax=f.add_subplot(122)\nsns.distplot(data[(data.sex == 'female')]['bmi'],color='r',ax=ax)\nax.set_title('Distribution of bmi of female')","6b2a178c":"f= plt.figure(figsize=(12,5))\n\nax=f.add_subplot(121)\nsns.distplot(data[(data.smoker == 'yes')][\"bmi\"],color='#b0b0b0',ax=ax)\nax.set_title('Distribution of bmi of smoker')\n\nax=f.add_subplot(122)\nsns.distplot(data[(data.smoker == 'no')]['bmi'],color='#333ed6',ax=ax)\nax.set_title('Distribution of bmi of non smoker')","c36e8dcd":"sns.catplot(x=\"region\", kind=\"count\",palette='viridis',data=data)","65b139df":"sns.catplot(x=\"region\", kind=\"count\",hue = 'sex',palette='viridis',data=data)","15a190ec":"sns.lmplot(x=\"bmi\", y=\"charges\",data=data);","b31a85bd":"sns.lmplot(x=\"bmi\", y=\"charges\", hue=\"smoker\", data=data, palette=\"Set1\")","74fbe649":"sns.lmplot(x=\"bmi\", y=\"charges\", hue=\"smoker\", col=\"sex\", data=data)","af4d3071":"sns.lmplot(x=\"bmi\", y=\"charges\", col=\"children\", data=data,aspect=.5)","144b5a1d":"g = sns.jointplot(x=\"bmi\", y=\"charges\", data=data, kind=\"kde\", color=\"#4837cc\")\ng.plot_joint(plt.scatter, c=\"w\", s=30, linewidth=1, marker=\"+\")\ng.ax_joint.collections[0].set_alpha(0)\ng.set_axis_labels(\"bmi\", \"charges\")","63628139":"sns.catplot(x=\"children\", kind=\"count\",palette='rainbow',data=data)","0b75c9bd":"sns.lmplot(x=\"children\", y=\"charges\",data=data)","2b24ba17":"sns.lmplot(x=\"children\", y=\"charges\", hue='smoker',data=data)","c0415f2c":"f, ax = plt.subplots(figsize=(10, 8))\ncorr = data.corr()\nsns.heatmap(corr)","15509d2d":"from sklearn.model_selection import train_test_split\nfrom sklearn import linear_model\nfrom sklearn.preprocessing import PolynomialFeatures\nfrom sklearn.pipeline import make_pipeline\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.tree import DecisionTreeRegressor\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.metrics import r2_score,mean_squared_error","90f60b02":"\n#sex\nle = LabelEncoder()\nle.fit(data.sex.drop_duplicates()) \ndata.sex = le.transform(data.sex)\n# smoker or not\nle.fit(data.smoker.drop_duplicates()) \ndata.smoker = le.transform(data.smoker)\n#region\nle.fit(data.region.drop_duplicates()) \ndata.region = le.transform(data.region)","262656ce":"data.head()","dd985bd2":"x = data.drop(['charges','region'], axis = 1)\ny = data.charges\n\nx_train,x_test,y_train,y_test = train_test_split(x,y, random_state = 0)","069b6866":"lreg = linear_model.LinearRegression()\nlreg.fit(x_train,y_train)\ny_train_pred = lreg.predict(x_train)\ny_test_pred = lreg.predict(x_test)\nlreg.score(x_test,y_test)","9c4c142d":"degree=2\npolyreg=make_pipeline(PolynomialFeatures(degree),LinearRegression())\npolyreg.fit(x_train,y_train)\ny_train_pred = polyreg.predict(x_train)\ny_test_pred = polyreg.predict(x_test)\npolyreg.score(x_test,y_test)","2cf68423":"dt_regressor = DecisionTreeRegressor(random_state=0)\ncross_val_score(dt_regressor,x_train, y_train, cv=10).mean()","a2421593":"Rf = RandomForestRegressor(n_estimators = 100,\n                              criterion = 'mse',\n                              random_state = 1,\n                              n_jobs = -1)\nRf.fit(x_train,y_train)\nRf_train_pred = Rf.predict(x_train)\nRf_test_pred = Rf.predict(x_test)\n\n\nr2_score(y_test,Rf_test_pred)","61376e0e":"# Age vs Charges of Non-smokers","25fea540":"# Decision Tree Regressor","35fe76b4":"# Patients Region wise","8e4187b4":"# Bmi vs Charges","45201756":"# Bmi of Male Vs Female","178557fc":"* In case of non smokers charges increase with age ,  but in case of smokers there is no such dependency.","e4e86179":"# Age distribution","fcbf3357":"* As you can see age is normally distrtibuted \n* Maximum number of patients are of 18-22 age ","37981996":"# Smokers count by gender","2cf2cc09":"# Age Vs Bmi by age","3082c066":"* distribution of bmi of  smoker and non smoker are normally distributed","40226e13":"# Correlation matrix","09940efe":"# Age distribution of Smoker vs Non-Smoker","93b5cb8b":"# Import Dataset","3153c5bf":"* As you can see there is slight change in distribution of smoker and non smoker and also we can see there is some interesting spike in % of age group between 18-22.","57aa260c":"# Bmi vs Charges of smoker Vs non smoker","11c0b7b4":"* As we can see, patients of age 18-22 smokers spend much more on treatment than non-smokers. Although we can see some outliers om non smokers this may be due to some serious disease.","6d80b4e8":"# Charges of patients Age 18-22 of smokers Vs non-smokers","82477d09":"# Cost distribution of smokers Vs non smokers ","a6bf00b5":"* There are more male smokers than female,but difference is not that big.\n* More non smokers patients than smokers patients .","453bfbdd":"* Age is ranging from 18 to 64 ,with mean of 38.2 and standard deviation of 14.04 \n* bmi is ranging from 15.96 to 53.13 , with mean of 30.6 and standard deviation of 6.09\n* charges is ranging from 1121 to 63770 , with mean of 13270 and standard deviation of 12110","ceae94de":"# Import Libraries","481583bc":"# Conclusion\n\n* Got maximum score of 0.88 from polynomial regression\n* Although random forest regressor performing good with an accuracy 0.86","7aa36cc0":"* No relation between age and bmi","b66b95bc":"<img src=\"https:\/\/i.pinimg.com\/originals\/71\/c0\/68\/71c068478e7499d73ec005eacbe42c10.gif\">","f9e210fa":"<font size=\"+3\" color='#1f0c75' ><b>Data Modelling and Evaluation <\/b><\/font>","ceda3f10":"<font size=\"+1\" color=purple ><b> I hope you enjoyed this kernel ,also if you have any suggestions to improve my model ,then feel free to comment it down .<\/b><\/font>","d0c818dd":"# Random Forest Regressor","6118821b":"# Polynomial Regression ","14ef22bd":"# Data Summary","96c1ca31":"# This notebook will cover the following\n\n1. Exploratory Data Analysis \n2. Data Modelling and Evaluation","b2484eaf":"# Childrens Vs Charges","a9d3b1f2":"# Gender wise Age distribution","bcfe1aab":"# Linear regression","bd7dbd94":"<img src=\"https:\/\/www.policybazaar.com\/pblife\/assets\/images\/pb_life_How_to_increase_Health_insurance_cover_1592063367.gif\">","7a110360":"* Smoking patients spend more ","082e6f87":"# Age vs charges of smokers","b2e14821":"<font size=\"+2\" color=chocolate ><b>Please Upvote my kernel if you like my work.<\/b><\/font>","79545d4c":"* As you can see age distribution of male and female are almost same .","e7fd80ae":"<font size=\"+3\" color='#1f0c75' ><b>Exploratory Data Analysis<\/b><\/font>","ffbfb954":"* Distribution of bmi of male and female are normally distributed","d71a1c8b":"# About Dataset","0e2533e7":"# Train Test split","b85fab68":"This dataset contains person's information like age,sex,gender,bmi,region,smoke or not and we have to predict their medical insurance cost.In this notebook I will apply regression techniques of supervised learning to predict the medical insurance costs.","c25630b0":"# Create dummy variables "}}