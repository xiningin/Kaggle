{"cell_type":{"5265f07e":"code","3b1e01e5":"code","5a671a70":"code","f71afbb8":"code","bb8fa659":"code","e588a895":"code","c935498b":"code","b3389a62":"code","b0027cb1":"code","e0c7ac49":"code","ef9670a4":"code","6cb504e7":"code","15091ba8":"code","e2d303a1":"code","7c3b2597":"code","e2e4bd16":"code","82293763":"markdown","e3d13365":"markdown","005297e2":"markdown","687300f2":"markdown","cc24227a":"markdown","38da54db":"markdown","87609b4e":"markdown","7fd14b2c":"markdown","2d73fb71":"markdown","2487fd19":"markdown","de4a9332":"markdown","800cc768":"markdown","c579e8ee":"markdown","42705f23":"markdown"},"source":{"5265f07e":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","3b1e01e5":"train_data = pd.read_csv(\"\/kaggle\/input\/cat-in-the-dat\/train.csv\")\ntest_data = pd.read_csv(\"\/kaggle\/input\/cat-in-the-dat\/test.csv\")","5a671a70":"train_data.head().T","f71afbb8":"train_data.day.value_counts()","bb8fa659":"train_data.month.value_counts()","e588a895":"import seaborn as sns\nsns.set()","c935498b":"p = sns.countplot(train_data.day)","b3389a62":"p = sns.lineplot(x = list(range(0, train_data.shape[0])), y = sorted(train_data.day))","b0027cb1":"p = sns.countplot(train_data.month)","e0c7ac49":"p = sns.lineplot(x = list(range(0, train_data.shape[0])), y = sorted(train_data.month))","ef9670a4":"import numpy as np\n\ntrain_data['day_sin'] = np.sin((train_data.day-1)*(2.*np.pi\/7))\ntrain_data['day_cos'] = np.cos((train_data.day-1)*(2.*np.pi\/7))\ntrain_data['month_sin'] = np.sin((train_data.month-1)*(2.*np.pi\/12))\ntrain_data['month_cos'] = np.cos((train_data.month-1)*(2.*np.pi\/12))","6cb504e7":"p = sns.lineplot(x = list(range(0,30)), y = train_data.day_cos[:30])","15091ba8":"p = sns.lineplot(x = list(range(0,30)), y = train_data.day_sin[:30])","e2d303a1":"sample = train_data[:5000] # roughly the first week of the data\n","7c3b2597":"ax = sample.plot.scatter('month_sin', 'month_cos').set_aspect('equal')","e2e4bd16":"ax = sample.plot.scatter('day_sin', 'day_cos').set_aspect('equal')","82293763":"The transformation of cyclic features is important because when cyclic features are untransformed then there's no way for the model to understand that the smallest value in the cycle is actually next to the largest value. \nFor example the month December is encoded 12 and January is encoded 1 and the model should understand that they are quantitatively adjacent to each other. However in their untransformed form they are far apart numerically and categorically. That's why cyclic transformations are good to explore.","e3d13365":"# Visualising after cyclic transformation","005297e2":"Let's explore the cat data","687300f2":"![](http:\/\/blog.davidkaleko.com\/images\/unit_circle.png)","cc24227a":"# Introduction to Cyclic Features","38da54db":"The main idea behind cyclic transformation is to enable cyclic data to be represented on a circle.","87609b4e":"# Visualising cyclic data before transformation","7fd14b2c":"#### The cat in the dat competition is really one of its kind and there's a lot to learn from it. There are two cyclic features in the data of this competition.  But how did the cyclic features get identified? How to identify cyclic features in any dataset?","2d73fb71":"# Why Transform?","2487fd19":"# Fundamental of cyclic transformation","de4a9332":"### Big thanks to :-\n\n* http:\/\/blog.davidkaleko.com\/feature-engineering-cyclical-features.html\n* https:\/\/ianlondon.github.io\/blog\/encoding-cyclical-features-24hour-time\/\n* https:\/\/medium.com\/ai%C2%B3-theory-practice-business\/top-6-errors-novice-machine-learning-engineers-make-e82273d394db\n* https:\/\/datascience.stackexchange.com\/questions\/5990\/what-is-a-good-way-to-transform-cyclic-ordinal-attributes\n* https:\/\/www.kaggle.com\/avanwyk\/encoding-cyclical-features-for-deep-learning","800cc768":"So the cyclic columns are :-\n* Day\n* Month","c579e8ee":"The transformations are as follows:-\n* x_sin=sin(2\u2217\u03c0\u2217x\/max(x)) \n* x_cos=cos(2\u2217\u03c0\u2217x\/max(x))\n\n\n*max(x) could be replaced by number of unique values of the cyclic features*","42705f23":"Though it is not very difficult to understand that cyclic data should show some sort of repetition, some sort of cyclic behaviour. They repeat their values after a certain number of observations and that too in a certain order. Some suitable examples are the data regarding\n\n* days of a week (1 - 7), \n* hour of the day (1 - 24), \n* number of month (1 - 12)"}}