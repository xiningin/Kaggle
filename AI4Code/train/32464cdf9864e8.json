{"cell_type":{"73538402":"code","f1365767":"code","fd132fcb":"code","1a4d166f":"code","1ec79d87":"code","95cfdeab":"code","29d5e1e2":"code","43401583":"code","c435cd1b":"code","bc174b3a":"code","1ee0ae76":"code","8a388a00":"code","3a841b28":"code","38307cca":"code","8bf95b72":"code","f6aa4e49":"code","9d252fc2":"code","92b83160":"code","19c79201":"code","0d284943":"code","e2a6f9dc":"code","e0b49ce5":"code","f10ecff7":"code","7b4f14c3":"code","e4de24c8":"markdown","8cf67122":"markdown","0397fd08":"markdown","5ef28101":"markdown","854d8f4c":"markdown","327b7ad1":"markdown","f4f7e03e":"markdown","4e23c0f4":"markdown","3e7e7cc9":"markdown","62d5b64c":"markdown","569cff76":"markdown","c1a5c5b8":"markdown","f1440374":"markdown","f53cfc4d":"markdown"},"source":{"73538402":"!pip3 install feyn","f1365767":"import feyn\nimport pandas as pd\nimport numpy as np\n\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.utils.class_weight import compute_sample_weight","fd132fcb":"random_seed = 123","1a4d166f":"data = pd.read_csv(\"\/kaggle\/input\/predict-diabetes-based-on-diagnostic-measures\/diabetes.csv\", decimal=\",\")\ndata.replace(to_replace=\"Diabetes\", value=1, inplace=True)\ndata.replace(to_replace=\"No diabetes\", value=0, inplace=True)\ndata.drop(\"patient_number\", axis=1, inplace=True)","1ec79d87":"train, test = train_test_split(data, test_size=0.4, random_state=random_seed, stratify=data['diabetes'])\ntrain.head()","95cfdeab":"sw = compute_sample_weight(\"balanced\", train[\"diabetes\"])","29d5e1e2":"ql = feyn.connect_qlattice()\nql.reset(random_seed)","43401583":"models = ql.auto_run(train,\n                     output_name=\"diabetes\",\n                     kind=\"classification\",\n                     stypes={\"gender\": \"c\"},                 \n                     criterion=\"bic\",\n                     sample_weights=sw,\n                    )","c435cd1b":"best = models[0]","bc174b3a":"best.plot(train, test)","1ee0ae76":"best.plot_roc_curve(train)\nbest.plot_roc_curve(test)","8a388a00":"ql.reset(random_seed)","3a841b28":"query = \"_['age','glucose', 2]\"","38307cca":"models = ql.auto_run(train,\n                     output_name=\"diabetes\",\n                     kind=\"classification\",\n                     stypes={\"gender\": \"c\"},                 \n                     criterion=\"bic\",\n                     sample_weights=sw,\n                     query_string=query\n                    )","8bf95b72":"best = models[0]","f6aa4e49":"best.plot(train, test)","9d252fc2":"best.plot_partial2d(train)","92b83160":"best.plot_partial(train, by=\"age\")","19c79201":"ql.reset(random_seed)","0d284943":"query = \"_['gender','glucose', 2]\"","e2a6f9dc":"models = ql.auto_run(train,\n                     output_name=\"diabetes\",\n                     kind=\"classification\",\n                     stypes={\"gender\": \"c\"},                 \n                     criterion=\"bic\",\n                     sample_weights=sw,\n                     query_string=query\n                    )","e0b49ce5":"best = models[0]","f10ecff7":"best.plot(train, test)","7b4f14c3":"best.plot_partial2d(train)","e4de24c8":"# QLattice on diabetic predictions","8cf67122":"Here we use a QLattice to determine whether `age` or `gender` has an predictive power whether someone develops diabetes or not. Here we use a community QLattice which is available for non-commercial use","0397fd08":"## Only `gender` and `glucose`","5ef28101":"In conclusion, increase in `age` also increases ones chances of developing diabetes but `gender` has no effect.","854d8f4c":"Here we will just the `auto_run` to find what are the best predictors.","327b7ad1":"The dataset is a little unbalanced so we will use sample weights.","f4f7e03e":"Here we do the same as above but instead of age we look at `gender`","4e23c0f4":"It looks like `glucose` is the best predictor here. But very little predictive power with `age` and `gender` wasn't even picked up.","3e7e7cc9":"So it looks like `glucose` has huge predictive power but does the effect vary across different age groups? Here we will use the `query_string` parameter in `auto_run` to tell the `QLattice` we want very simple models that include only `glucose` and `age`.","62d5b64c":"## Only `age` and `glucose`","569cff76":"A very simple model that has almost the same predictive power. Let's plot it!","c1a5c5b8":"Here you can see that the older one is the more like one is going to develop diabetes. However the effect is exacerbated with the higher glucose levels.","f1440374":"## Conclusion","f53cfc4d":"Here we can see that `gender` has very little effect on whether one will develope diabetes or not."}}