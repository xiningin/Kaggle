{"cell_type":{"7cd2fad8":"code","044dbc14":"code","28020817":"code","cf81bfea":"code","3299d987":"code","3af10e24":"code","5c73a277":"code","a02fc382":"code","be784896":"code","714934f6":"code","56f96fb8":"code","7057b6b4":"code","e70dd963":"code","a657759a":"code","4cbd57a1":"markdown","e6382752":"markdown","b4a5ee54":"markdown","8ce0436a":"markdown","a9ff20e4":"markdown"},"source":{"7cd2fad8":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport matplotlib.gridspec as gridspec\nfrom sklearn.ensemble import IsolationForest","044dbc14":"df_clf = pd.read_csv('https:\/\/raw.githubusercontent.com\/mesmalif\/Practical_Machine_learning\/develop_practical_ML\/isolation_forest\/data_set_A.csv')","28020817":"df_clf.head()","cf81bfea":"x_clf = df_clf.values","3299d987":"plt.scatter(x_clf[:,0], x_clf[:,1])","3af10e24":"clf = IsolationForest(contamination=.2)\nclf.fit(x_clf)\npredictions_clf = clf.predict(x_clf)","5c73a277":"(predictions_clf<0).mean()","a02fc382":"anomaly_index = np.where(predictions < 0)","be784896":"plt.scatter(x_clf[:,0], x_clf[:,1])\nplt.scatter(x_clf[anomaly_index ,0], x_clf[anomaly_index ,1], edgecolors=\"r\")","714934f6":"df_ts = pd.read_csv('https:\/\/raw.githubusercontent.com\/mesmalif\/Practical_Machine_learning\/develop_practical_ML\/isolation_forest\/sensors.csv', index_col='time')\ndf_ts.head()","56f96fb8":"df_ts.index = pd.to_datetime(df_ts.index)","7057b6b4":"x_ts = df_ts.values\n\nts = IsolationForest(contamination=.1)\npredictions_ts = ts.fit_predict(x_ts)\ndec_fun = ts.decision_function(x_ts)","e70dd963":"df_ts['health'] = dec_fun\n# the more the value is minus the more anomalies\ndf_ts.head()","a657759a":"plt.plot(dec_fun)\nplt.axhspan(-.20, -.05, alpha=0.2, color='red') # Threshold for anomaly values","4cbd57a1":"<h1 style='background:#CCE2CB; border:0; color:black'><center> Source <\/center><\/h1> ","e6382752":"<h1 style='background:#CCE2CB; border:0; color:black'><center> Anomaly Detection In Time Series <\/center><\/h1> ","b4a5ee54":"<h1 style='background:#CCE2CB; border:0; color:black'><center> Anomaly Detection In Classification Data <\/center><\/h1> ","8ce0436a":"- [https:\/\/github.com\/mesmalif\/Practical_Machine_learning\/tree\/develop_practical_ML](http:\/\/)\n- [https:\/\/www.youtube.com\/watch?v=qNDcPUeCEPI](http:\/\/)","a9ff20e4":"<h1 style='background:#CCE2CB; border:0; color:black'><center> Importing Libraries <\/center><\/h1> "}}