{"cell_type":{"49651f18":"code","a2b0a082":"code","f4bce44f":"code","4eff846e":"code","b2c1173c":"code","10002a77":"code","2d97f15c":"code","847f1866":"code","13c1e2c1":"code","be2bf6a1":"code","9e041210":"code","eb9a2d27":"code","f4db6ab2":"code","d85ea511":"markdown"},"source":{"49651f18":"import numpy as np # for numerical operations\nimport pandas as pd # for handling input data\ntrain = pd.read_csv('newtrain.csv') # uses pandas library to open a .csv file\ntest = pd.read_csv('newtest.csv')\nsample = pd.read_csv('sample_submission.csv')","a2b0a082":"x=train.drop('abs_title_sentiment_polarity',axis=1)\nlabel=train['abs_title_sentiment_polarity']\ny=np.array(label)\nx.shape","f4bce44f":"y=y.reshape(x.shape[0],1)\ny.shape","4eff846e":"b=np.ones((len(x),1))\nb.shape","b2c1173c":"x=np.append(b,x,axis=1)\nx.shape","10002a77":"def normal_equation(x,y,lamda):\n    l=np.identity(x.shape[1])\n    l[0,0]=0\n    theta=np.dot(np.linalg.inv(x.T.dot(x)+lamda*l),x.T.dot(y))\n    return theta","2d97f15c":"lamda=1\ntheta= normal_equation(x,y,lamda)\ntheta.shape","847f1866":"theta","13c1e2c1":"t=np.array(test)\nb=np.ones((test.shape[0],1))\nxfinal=np.append(b,t,axis=1)\nxfinal.shape","be2bf6a1":"test_pred=np.dot(xfinal,theta)\ntest_pred","9e041210":"test_pred=test_pred.reshape(test_pred.shape[0],)","eb9a2d27":"ids=np.array(sample['Id']) #prepare to submission\nprint(ids)","f4db6ab2":"e=pd.DataFrame({'Id':ids,'abs_title_sentiment_polarity':test_pred})\ne.to_csv('newspaper_normal_eq.CSV',encoding='utf-8',index=False)","d85ea511":"![Screenshot%202021-07-10%20061111.png](attachment:Screenshot%202021-07-10%20061111.png)"}}