{"cell_type":{"865b437e":"code","c2404cbd":"code","84aaf168":"code","b62a21c3":"code","86a2e9bc":"code","14d897b1":"code","789d94b5":"code","5b3debb3":"code","65768357":"code","cdc68596":"code","9603f4fc":"code","5937a956":"code","962bb9a1":"code","aa2b759c":"code","b5b7cb94":"code","073fcd14":"code","2f82734a":"code","9505cbec":"code","edc13c30":"code","b52ce635":"code","c7f46d8a":"code","d043f03e":"code","bbc33f24":"code","5f556285":"code","0d15ab0c":"code","a0894cea":"code","23ce1ba6":"code","573eacba":"code","6d41ef3d":"code","cd882194":"code","eaef6e37":"code","43dc2b13":"code","183db352":"code","820c408b":"code","a2e46ea6":"code","bf94088c":"code","550c2b61":"code","07fd7336":"code","997a4aa4":"code","d7a1898a":"code","9d02ca55":"code","3613d39a":"code","a45ed4df":"code","c6585990":"code","c8752a96":"code","7a459952":"code","3bf1e773":"code","0ab91186":"code","498f1b06":"code","2ab1c07d":"code","1ec656f9":"code","13623bc3":"code","2764c375":"code","208e699e":"code","6f4927df":"code","5314d913":"code","cc891879":"code","6d18b244":"code","0726e54c":"code","998de672":"code","a7382cd2":"code","b25a2da6":"code","77c4ce67":"code","f87535c5":"code","d23b2905":"code","dfcee16a":"code","3f7412c1":"code","c82209b2":"code","822743bb":"code","3bae7bcc":"code","128eeef8":"code","0ef66852":"code","ed953931":"code","6cf72784":"code","2b4e568b":"code","ea8d84d6":"code","719423b7":"code","c4909735":"code","1afc0160":"code","eec2a5ef":"code","a32ae394":"code","68ba4fe9":"code","aa4a9859":"code","aa5a6038":"code","25b0fe50":"code","54b8e904":"code","fca4895b":"code","d29276b6":"code","384dc49e":"code","d83039eb":"code","0254eeb4":"code","240bb8e1":"code","8907d76b":"code","582363eb":"code","5941770b":"code","5c7ad66d":"code","aac98da0":"code","c605725a":"code","caef440a":"code","fb27b7cc":"code","b722b9bf":"code","9894f006":"code","054bdd96":"code","5ef23051":"code","7a84fe5c":"code","1450a187":"code","2bdec55d":"code","a2d9a446":"code","78025c31":"code","4904700a":"code","fd818948":"code","878bd2a1":"code","f0a1b933":"code","bb2d94f8":"code","c0270c50":"code","cd785467":"code","791b3d4c":"code","0a088dbd":"code","769bc487":"code","cbecfb97":"code","1d01a40d":"code","e33ef68f":"code","87f1ae5a":"code","0351cd49":"code","94daa8c5":"code","e700626e":"code","4450b858":"code","a1c4322d":"code","19dc3915":"code","f17f3755":"code","65c72bfa":"code","5eb35b54":"code","70e038fb":"code","7c0e8cf0":"code","603a0f5f":"code","20503403":"code","21b10f23":"code","da26c07c":"code","f7ec7236":"code","db729e17":"code","51b045c5":"code","c10d0530":"code","9cb2fa25":"code","f03000a7":"code","ab1ab510":"code","e6b23b6a":"code","96088ee6":"code","4430838f":"code","62a60f38":"code","6df00607":"code","773d1306":"code","6ac65f76":"code","b88d23a2":"code","0689f761":"code","77a43028":"code","4a48c1ff":"code","c6173647":"code","77df7864":"code","2e2c3e52":"code","1c8b4657":"code","a357038e":"code","d33b7cb4":"markdown","8410c15f":"markdown","01c80941":"markdown","36c90c39":"markdown","0ce550c2":"markdown","bc08e338":"markdown","303d0e74":"markdown","92bae0b7":"markdown","67beafe4":"markdown","3fe5378d":"markdown","eb9eb7cc":"markdown","b5d90c43":"markdown","ef61d05e":"markdown","cb5e3f57":"markdown","7006dc01":"markdown","af79ade9":"markdown","8e23d8ac":"markdown","d93b4329":"markdown","8de3fd56":"markdown","2ffba2f3":"markdown","1f2ca606":"markdown","3bc8a4f3":"markdown","13cb98b4":"markdown","8fc05c42":"markdown","acddcf2f":"markdown","7823d390":"markdown","cd855ce8":"markdown","120d1a24":"markdown","2cf658c5":"markdown","436d22ef":"markdown","bb9ecaed":"markdown","55959468":"markdown","0ac0528a":"markdown","224e7117":"markdown","3b28475b":"markdown","afb2a2f8":"markdown","ecaef5e6":"markdown","c4bd2090":"markdown","2e9d62fb":"markdown","4281842b":"markdown","a0c542dc":"markdown","9f960861":"markdown","d2104970":"markdown","4a35a0fa":"markdown","a8ef07cb":"markdown","30fa4d99":"markdown","0d4915af":"markdown","14fed699":"markdown","a5d4f540":"markdown","3c176294":"markdown","24aff488":"markdown","e0963d0b":"markdown","3ba27c67":"markdown","72f9473d":"markdown","fa35601f":"markdown","ea15c797":"markdown","aa1cce43":"markdown"},"source":{"865b437e":"%matplotlib inline","c2404cbd":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport math\n\nfrom scipy import stats\n\nfrom scipy.special import boxcox1p\n\nfrom sklearn.linear_model import LinearRegression, Ridge, Lasso\nfrom sklearn.tree import DecisionTreeRegressor\nfrom sklearn.ensemble import RandomForestRegressor\n\nfrom sklearn import metrics\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.model_selection import train_test_split\n\nplt.style.use('seaborn-paper')","84aaf168":"# # Run this cell for local machine.\n# df_train = pd.read_csv('train.csv', index_col='Id')\n# df_test = pd.read_csv('test.csv', index_col='Id')\n# sample_sub = pd.read_csv('sample_submission.csv', index_col='Id')","b62a21c3":"# Run this cell for kaggle kernel.\nimport os\nprint(os.listdir(\"..\/input\"))\n\ndf_train = pd.read_csv('..\/input\/train.csv', index_col='Id')\ndf_test = pd.read_csv('..\/input\/test.csv', index_col='Id')\nsample_sub = pd.read_csv('..\/input\/sample_submission.csv', index_col='Id')","86a2e9bc":"# Do not truncate columns and rows of displayed dataframes.\npd.options.display.max_columns = None\n# pd.options.display.max_rows = None","14d897b1":"# The saleprice of every house is to be predicted and assign as the target.\ntarget = df_train[['SalePrice']]","789d94b5":"# Test and train data sets are joined along the index.\ndata = pd.concat([df_train, df_test], sort=False)","5b3debb3":"# Find the number of rows and columns.\npd.DataFrame([[df_train.shape[0], df_train.shape[1]],\n              [df_test.shape[0], df_test.shape[1]] ],\n             index=['Train Set', 'Test Set'],\n             columns=['Number of rows', 'Number of columns'])","65768357":"# List all the columns (features).\ndata.columns","cdc68596":"# Find columns that are only in training set and not in the test set (submission set).\n[col for col in df_train.columns if col not in df_test.columns]","9603f4fc":"data.info()","5937a956":"data.head()","962bb9a1":"# List the columns with numerical types.\nnumerical = data.dtypes[data.dtypes != object].index.tolist()\npd.DataFrame(numerical, index=range(1, len(numerical)+1), columns=['Numerical'])","aa2b759c":"# List the columns with non-numerical types.\ncategorical = data.dtypes[data.dtypes == object].index.tolist()\npd.DataFrame(categorical, index=range(1, len(categorical)+1), columns=['Categorical'])","b5b7cb94":"data.describe()","073fcd14":"# Plot the SalePrice observations in ascending order.\nplt.figure(figsize=(10,5))\nplt.scatter(range(len(target)), target.sort_values(by='SalePrice'))\nplt.xlabel('Observation',fontsize=20)\nplt.ylabel('SalePrice',fontsize=20)\nplt.title('SalePrice Observations in Ascending Order',fontsize=20)\n\nplt.rc('xtick',labelsize=15)\nplt.rc('ytick',labelsize=15)\nplt.tight_layout()\n# plt.savefig(\"saleprice_ordered.jpeg\", dpi=150)","2f82734a":"# Plot the distribution of the SalePrice observations and compare to a normal distribution.\nsns.set(rc={'figure.figsize':(10,5)})\nax = sns.distplot(target, fit=stats.norm, kde=False, hist_kws={\"label\": \"Target\"}, fit_kws={\"label\": \"Normal Fit\"})\nax.axes.set_title(\"SalePrice Distribution Plot\",fontsize=30)\nax.set_xlabel(\"SalePrice\/Target Variable\",fontsize=20)\nax.tick_params(labelsize=15)\nax.legend(fontsize='x-large', title_fontsize='40')\nplt.tight_layout()\n# plt.savefig(\"sales_dist_skew.jpeg\", dpi=150)","9505cbec":"# Calculate the skewness.\nstats.skew(target)","edc13c30":"# Plot a boxplot for Saleprice.\nsns.set(rc={'figure.figsize':(10,5)})\nax = sns.boxplot(x = target)\nax.axes.set_title(\"Box-and-Whisker\",fontsize=30)\nax.set_xlabel(\"SalePrice\/Target Variable\",fontsize=20)\nax.tick_params(labelsize=15)\nplt.tight_layout()\n# plt.savefig(\"skew_box.jpeg\", dpi=150)","b52ce635":"target.describe()","c7f46d8a":"target_log1p = np.log1p(target)","d043f03e":"# Plot the log transformed distribution of the SalePrice observations and compare to a normal distribution.\nsns.set(rc={'figure.figsize':(10,5)})\nax = sns.distplot(target_log1p, fit=stats.norm, kde=False, hist_kws={\"label\": \"Log of Target\"}, fit_kws={\"label\": \"Normal Fit\"})\nax.axes.set_title(\"Transformed SalePrice Distribution Plot\",fontsize=30)\nax.set_xlabel(\"SalePrice\/Target Variable\",fontsize=20)\nax.legend()\nax.tick_params(labelsize=15)\nplt.tight_layout()\n# plt.savefig(\"saleprice_dist_correct.jpeg\", dpi=150)","bbc33f24":"# Plot the transformed saleprice boxplot.\nsns.set(rc={'figure.figsize':(10,5)})\nax = sns.boxplot(x = target_log1p)\nax.set(xlabel='SalePrice\/Target Variable',title='Transformed Box-and-Whisker')\nplt.tight_layout()\n# plt.savefig(\"norm_box.jpeg\", dpi=150)","5f556285":"stats.skew(target_log1p)","0d15ab0c":"# Create a correlation matrix between all numerical features of the training data.\ncorrelation_matrix = df_train.corr().round(2)\nsns.set(rc={'figure.figsize':(15,12)})\nax = sns.heatmap(data=correlation_matrix, vmin=-1, vmax=1, cmap='RdBu')\nax.tick_params(labelsize=20)\nplt.tight_layout()\n# plt.savefig(\"heatmap.jpeg\", dpi=150)","a0894cea":"strongest = abs(correlation_matrix['SalePrice']).sort_values(ascending=False)[:11].index\nstrong_matrix = correlation_matrix.loc[strongest,strongest]\nstrong_matrix","23ce1ba6":"# Plot scatters of strongest numerical features vs SalePrice.\nplt.figure(figsize=(25, 15))\nstrong_features = ['OverallQual', 'GrLivArea', 'GarageCars', 'TotalBsmtSF']\n\nfor i, col in enumerate(strong_features):\n    plt.subplot(2, len(strong_features)\/2 , i+1)\n    sns.regplot(df_train[col], df_train['SalePrice'], line_kws={\"color\": \"red\"})\n    plt.title(col, fontsize=25)\n    plt.xlabel(col, fontsize=25)\n    plt.ylabel('SalePrice', fontsize=25)\nplt.tight_layout()\n# plt.savefig(\"strong_correlations.jpeg\", dpi=150)","573eacba":"df_train.columns","6d41ef3d":"# Plot linear regression fit scatter plots for first 20 numerical.\nplt.figure(figsize=(40,40))\ni = 1\nfor col in numerical[:20]:\n    plt.subplot(4,5,i)\n    sns.regplot(df_train[col], df_train['SalePrice'], line_kws={\"color\": \"red\"})\n    plt.title(col, fontsize=25)\n    plt.xlabel(col, fontsize=25)\n    plt.ylabel('SalePrice', fontsize=25)\n    plt.xticks(fontsize=14)\n    plt.xticks(fontsize=14)\n    i = i + 1","cd882194":"# Plot linear regression fit scatter plots for the rest of numerical.\nplt.figure(figsize=(40,40))\ni = 1\nfor col in numerical[20:]:\n    plt.subplot(4,5,i)\n    sns.regplot(df_train[col], df_train['SalePrice'], line_kws={\"color\": \"red\"})\n    plt.title(col, fontsize=25)\n    plt.xlabel(col, fontsize=25)\n    plt.ylabel('SalePrice', fontsize=25)\n    i = i + 1","eaef6e37":"# Plot swarmplots of first 2 categorical features.\n# It is too slow to plot all.\nplt.figure(figsize=(10,15))\ni = 1\nfor col in categorical[:2]:\n    plt.subplot(2,1,i)\n    sns.swarmplot(df_train[col], df_train['SalePrice'])\n    plt.title(col, fontsize=25)\n    plt.xlabel(col, fontsize=25)\n    plt.ylabel('SalePrice', fontsize=25)\n    i = i + 1","43dc2b13":"# Create a dataframe showing missing values for train, test and combined.\nmissing_values = pd.concat([df_train.isna().sum(), df_test.isna().sum()], axis=1, keys=['Train', 'Test'], sort=False)\nmissing_values['Combined Data'] = missing_values.sum(axis=1)\nmissing_values['Percentage Missing'] = missing_values['Combined Data']\/data.shape[0]*100\nmissing_values = missing_values[missing_values['Combined Data']>0].sort_values(by='Combined Data', ascending=False)\nmissing_values","183db352":"# Plot the missing quantities.\nax = missing_values[['Percentage Missing']].plot.bar(figsize=(10,8), width=1)\nplt.ylabel('Percentage Missing', fontsize=25)\nplt.xlabel('Feature', fontsize=25)\nplt.title('Missing Values', fontsize=25)\nax.tick_params(labelsize=15)\nplt.tight_layout()\n# plt.savefig(\"missing data.jpeg\", dpi=150)","820c408b":"# # Open, read and close the desciption text file.\n# # Only use this cell locally.\n# f = open('data_description.txt', 'r')\n# for line in f:\n#     print(line)\n# f.close()","a2e46ea6":"data['PoolQC'].value_counts()","bf94088c":"data['PoolArea'].value_counts()","550c2b61":"# Check where there is a pool but no QC value.\npools_noQC = data[(data['PoolQC'].isna()) & (data['PoolArea']!=0)][['PoolQC']].index\ndata.loc[pools_noQC, ['PoolQC','PoolArea','OverallQual', 'OverallCond', 'ExterQual', 'ExterCond']]","07fd7336":"data.loc[pools_noQC, 'PoolQC'] = 'TA'","997a4aa4":"data['PoolQC'].fillna('none', inplace=True)","d7a1898a":"data.loc[data[(data['MiscFeature'].isna()) & (data['MiscVal']!=0)].index][['MiscFeature','MiscVal']]","9d02ca55":"data['MiscFeature'].value_counts()","3613d39a":"data.loc[2550, 'MiscFeature'] = 'Othr'","a45ed4df":"data['MiscFeature'].fillna('none', inplace=True)","c6585990":"data['Alley'].fillna('none', inplace=True)","c8752a96":"data['Fence'].fillna('none', inplace=True)","7a459952":"data[(data['FireplaceQu'].isna()) & (data['Fireplaces']!=0)]","3bf1e773":"data[(data['FireplaceQu'].isna()) & (data['Fireplaces']==0)].index","0ab91186":"data['FireplaceQu'].fillna('none', inplace=True)","498f1b06":"pd.concat([data.groupby('Neighborhood').median()['LotFrontage'],\n           data.groupby('Neighborhood').mean()['LotFrontage'],\n           data.groupby('Neighborhood').mean()['SalePrice']],axis=1)","2ab1c07d":"data.groupby('Neighborhood')['LotFrontage'].describe()","1ec656f9":"data['LotFrontage'].mean(), data['LotFrontage'].median()","13623bc3":"data['LotFrontage'] = data.groupby('Neighborhood')['LotFrontage'].transform(lambda x: x.fillna(x.median()))","2764c375":"# Inspect basement related values.\ndata[data['BsmtFinSF1'].isna()][['BsmtQual',\n                                 'BsmtCond',\n                                 'BsmtExposure',\n                                 'BsmtFinType1',\n                                 'BsmtFinType2',\n                                 'BsmtFinSF1',\n                                 'BsmtFinSF2',\n                                 'BsmtUnfSF',\n                                 'TotalBsmtSF',\n                                 'BsmtHalfBath',\n                                 'BsmtFullBath']]","208e699e":"data['BsmtQual'].value_counts()","6f4927df":"data['BsmtCond'].value_counts()","5314d913":"data['BsmtExposure'].value_counts()","cc891879":"data['BsmtFinType1'].value_counts()","6d18b244":"data['BsmtFinType2'].value_counts()","0726e54c":"data.loc[2121, ['BsmtQual','BsmtCond', 'BsmtExposure', 'BsmtFinType1', 'BsmtFinType2']] = 'none'\ndata.loc[2121, ['BsmtFinSF1','BsmtFinSF2','BsmtUnfSF','TotalBsmtSF','BsmtHalfBath','BsmtFullBath']] = 0","998de672":"data[data['BsmtHalfBath'].isna()][['BsmtQual',\n                                   'BsmtCond',\n                                   'BsmtExposure',\n                                   'BsmtFinType1',\n                                   'BsmtFinType2',\n                                   'BsmtFinSF1',\n                                   'BsmtFinSF2',\n                                   'BsmtUnfSF',\n                                   'TotalBsmtSF',\n                                   'BsmtHalfBath',\n                                   'BsmtFullBath']]","a7382cd2":"data.loc[2189, ['BsmtQual','BsmtCond', 'BsmtExposure', 'BsmtFinType1', 'BsmtFinType2']] = 'none'\ndata.loc[2189, ['BsmtHalfBath','BsmtFullBath']] = 0","b25a2da6":"data[( data['BsmtFinType2'].isna() ) & ( ~( data['BsmtFinType1'].isna() ) )]\\\n    [['BsmtQual',\n      'BsmtCond',\n      'BsmtExposure',\n      'BsmtFinType1',\n      'BsmtFinType2',\n      'BsmtFinSF1',\n      'BsmtFinSF2',\n      'BsmtUnfSF',\n      'TotalBsmtSF',\n      'BsmtHalfBath',\n      'BsmtFullBath']]","77c4ce67":"data['BsmtFinType2'].value_counts()","f87535c5":"data.loc[333, ['BsmtFinType2']] = 'Unf'","d23b2905":"data[( data['BsmtFinType2'].isna() ) & ( ( data['BsmtFinType1'].isna() ) )][['BsmtQual',\n                                   'BsmtCond',\n                                   'BsmtExposure',\n                                   'BsmtFinType1',\n                                   'BsmtFinType2',\n                                   'BsmtFinSF1',\n                                   'BsmtFinSF2',\n                                   'BsmtUnfSF',\n                                   'TotalBsmtSF',\n                                   'BsmtHalfBath',\n                                   'BsmtFullBath']].describe()","dfcee16a":"# Find missing exposure values with actual basements.\nmiss_no_BSMTexp = data[( ~( data['BsmtFinType2'].isna() ) & ~( data['BsmtFinType1'].isna() ) ) &\\\n                       ( data['BsmtExposure'].isna() )]\\\n                       [['BsmtQual',\n                       'BsmtCond',\n                       'BsmtExposure',\n                       'BsmtFinType1',\n                       'BsmtFinType2',\n                       'BsmtFinSF1',\n                       'BsmtFinSF2',\n                       'BsmtUnfSF',\n                       'TotalBsmtSF',\n                       'BsmtHalfBath',\n                       'BsmtFullBath']].index","3f7412c1":"miss_no_BSMTexp","c82209b2":"data.loc[miss_no_BSMTexp, ['BsmtExposure']] = 'No'","822743bb":"miss_no_BSMTqual = data[( ~( data['BsmtFinType2'].isna() ) & ~( data['BsmtFinType1'].isna() ) ) &\\\n                       ( data['BsmtQual'].isna() )]\\\n                       [['BsmtQual',\n                       'BsmtCond',\n                       'BsmtExposure',\n                       'BsmtFinType1',\n                       'BsmtFinType2',\n                       'BsmtFinSF1',\n                       'BsmtFinSF2',\n                       'BsmtUnfSF',\n                       'TotalBsmtSF',\n                       'BsmtHalfBath',\n                       'BsmtFullBath']].index","3bae7bcc":"data.loc[miss_no_BSMTqual][['BsmtQual',\n                       'BsmtCond',\n                       'BsmtExposure',\n                       'BsmtFinType1',\n                       'BsmtFinType2',\n                       'BsmtFinSF1',\n                       'BsmtFinSF2',\n                       'BsmtUnfSF',\n                       'TotalBsmtSF',\n                       'BsmtHalfBath',\n                       'BsmtFullBath']]","128eeef8":"data.loc[[2218,2219], ['BsmtQual']] = 'TA'","0ef66852":"data[ ~( data['BsmtFinType2'].isna() ) & ( data['BsmtCond'].isna() )]\\\n                       [['BsmtQual',\n                       'BsmtCond',\n                       'BsmtExposure',\n                       'BsmtFinType1',\n                       'BsmtFinType2',\n                       'BsmtFinSF1',\n                       'BsmtFinSF2',\n                       'BsmtUnfSF',\n                       'TotalBsmtSF',\n                       'BsmtHalfBath',\n                       'BsmtFullBath']]","ed953931":"data.loc[[2041,2186,2525], ['BsmtCond']] = 'TA'","6cf72784":"data[data['BsmtFinType2'].isna()]\\\n                       [['BsmtQual',\n                       'BsmtCond',\n                       'BsmtExposure',\n                       'BsmtFinType1',\n                       'BsmtFinType2',\n                       'BsmtFinSF1',\n                       'BsmtFinSF2',\n                       'BsmtUnfSF',\n                       'TotalBsmtSF',\n                       'BsmtHalfBath',\n                       'BsmtFullBath']].describe()","2b4e568b":"data['BsmtQual'].fillna(value='none', inplace=True)\ndata['BsmtCond'].fillna(value='none', inplace=True)\ndata['BsmtExposure'].fillna(value='none', inplace=True)\ndata['BsmtFinType1'].fillna(value='none', inplace=True)\ndata['BsmtFinType2'].fillna(value='none', inplace=True)","ea8d84d6":"data['Electrical'].fillna(value=data['Electrical'].mode()[0], inplace=True)","719423b7":"data['Exterior1st'].value_counts()","c4909735":"data['Exterior1st'].fillna(value='Other', inplace=True)\ndata['Exterior2nd'].fillna(value='Other', inplace=True)","1afc0160":"data.loc[1550:1560, 'KitchenQual']","eec2a5ef":"data['KitchenQual'].fillna(method='ffill', inplace=True)","a32ae394":"data[data['SaleType'].isna()]","68ba4fe9":"data['SaleType'].value_counts()","aa4a9859":"data['SaleType'].fillna(value='Oth', inplace=True)","aa5a6038":"data[data['GarageCars'].isna()][['GarageCars',\n                                 'GarageArea',\n                                 'GarageType',\n                                 'GarageYrBlt',\n                                 'GarageFinish',\n                                 'GarageQual',\n                                 'GarageCond']]","25b0fe50":"garage_info = data[data['GarageType']=='Detchd'][['GarageArea', 'GarageCars']].describe()","54b8e904":"data['GarageArea'].fillna(value=garage_info.loc['mean','GarageArea'], inplace=True)\ndata['GarageCars'].fillna(value=int(garage_info.loc['mean','GarageCars']), inplace=True)","fca4895b":"data[data['Neighborhood'] == 'IDOTRR']['Utilities'].unique()","d29276b6":"data[data['Utilities'].isna()]","384dc49e":"data.loc[1916, 'Utilities'] = 'AllPub'\ndata.loc[1946, 'Utilities'] = 'AllPub'","d83039eb":"data['MasVnrType'].fillna(value='none', inplace=True)\ndata['MasVnrArea'].fillna(value=0, inplace=True)","0254eeb4":"data['Functional'].value_counts()","240bb8e1":"data['Functional'].fillna(value='Typ', inplace=True)","8907d76b":"data['MSZoning'].value_counts()","582363eb":"data[data['MSZoning'].isna()][['Neighborhood','MSSubClass']]","5941770b":"data[data['Neighborhood']=='IDOTRR'].groupby(['MSSubClass','MSZoning'])['MSZoning'].count()","5c7ad66d":"data.loc[2217, 'MSZoning'] = 'C (all)'\ndata.loc[1916, 'MSZoning'] = 'RM'\ndata.loc[2251, 'MSZoning'] = 'RM'","aac98da0":"data[data['Neighborhood']=='Mitchel'].groupby(['MSSubClass','MSZoning'])['MSZoning'].count()","c605725a":"data.loc[2905, 'MSZoning'] = 'RL'","caef440a":"data[~( data['GarageType'].isna() ) & ( data['GarageYrBlt'].isna() )]\\\n[['GarageCars',\n  'GarageArea',\n  'GarageType',\n  'GarageYrBlt',\n  'GarageFinish',\n  'GarageQual',\n  'GarageCond',\n  'YearBuilt',\n  'YearRemodAdd',\n  'MiscFeature',\n  'MSZoning']]","fb27b7cc":"data.loc[2127,'GarageYrBlt'] = 1910\ndata.loc[2577,'GarageYrBlt'] = 1923","b722b9bf":"data.loc[2127,'GarageCond'] = data['GarageCond'].mode()[0]\ndata.loc[2577,'GarageCond'] = data['GarageCond'].mode()[0]","9894f006":"data.loc[2127,'GarageFinish'] = data['GarageFinish'].mode()[0]\ndata.loc[2577,'GarageFinish'] = data['GarageFinish'].mode()[0]","054bdd96":"data.loc[2127,'GarageQual'] = data['GarageQual'].mode()[0]\ndata.loc[2577,'GarageQual'] = data['GarageQual'].mode()[0]","5ef23051":"data[~( data['GarageCars'].isna() ) & ( data['GarageType'].isna() )]\\\n                                                                     [['GarageCars',\n                                                                       'GarageArea',\n                                                                       'GarageType',\n                                                                       'GarageYrBlt',\n                                                                       'GarageFinish',\n                                                                       'GarageQual',\n                                                                       'GarageCond',\n                                                                       'SalePrice']].shape","7a84fe5c":"data['GarageType'].fillna(value='none', inplace=True)\ndata['GarageFinish'].fillna(value='none', inplace=True)\ndata['GarageQual'].fillna(value='none', inplace=True)\ndata['GarageCond'].fillna(value='none', inplace=True)","1450a187":"GarageYrBlt_na_index = data[data['GarageYrBlt'].isna()].index\ndata.loc[GarageYrBlt_na_index, 'GarageYrBlt'] = data.loc[GarageYrBlt_na_index, 'YearBuilt']","2bdec55d":"data[['GarageYrBlt']].sort_values(by='GarageYrBlt').head()","a2d9a446":"data[['GarageYrBlt']].sort_values(by='GarageYrBlt').tail()","78025c31":"data.loc[[2593]]","4904700a":"data.loc[2593,'GarageYrBlt'] = data.loc[2593,'YearRemodAdd']","fd818948":"data.isna().sum().sum()","878bd2a1":"data.drop('SalePrice', axis=1, inplace=True)","f0a1b933":"data.isna().sum().sum()","bb2d94f8":"data.shape","c0270c50":"data.head()","cd785467":"data = data.replace( {'MSSubClass' : {num: 'MSC'+ str(num) for num in list(data['MSSubClass'].unique())}} )","791b3d4c":"data = data.replace( {'MoSold' : {num: 'M'+ str(num) for num in list(data['MoSold'].unique())}} )","0a088dbd":"data = data.replace( {'YrSold' : {num: 'YS'+ str(num) for num in list(data['YrSold'].unique())}} )","769bc487":"numerical = data.dtypes[data.dtypes != object].index.tolist()\ncategorical = data.dtypes[data.dtypes == object].index.tolist()","cbecfb97":"# Combine all house areas and bath quantities.\ndata['TotalSF'] = data['TotalBsmtSF'] + data['1stFlrSF'] + data['2ndFlrSF']\ndata['Baths'] = data['BsmtFullBath'] + 0.5*data['BsmtHalfBath'] + data['FullBath'] + 0.5*data['HalfBath']\n\ndata.drop(['TotalBsmtSF',\n           '1stFlrSF',\n           '2ndFlrSF',\n           'BsmtFullBath',\n           'BsmtHalfBath',\n           'FullBath',\n           'HalfBath'], axis=1, inplace=True)\n\n# Combine basement areas.\ndata['BsmtTotSF'] = data['BsmtFinSF1'] + data['BsmtFinSF2'] + data['BsmtUnfSF'] + data['LowQualFinSF']\ndata.drop(['BsmtFinSF1', 'BsmtFinSF2', 'BsmtUnfSF', 'LowQualFinSF'], axis=1, inplace=True)\n\n# Combine porch\/deck type areas.\ndata['TotalPorch'] = data['WoodDeckSF'] + data['OpenPorchSF'] + data['EnclosedPorch'] + data['3SsnPorch'] + data['ScreenPorch']\ndata.drop(['WoodDeckSF','OpenPorchSF','EnclosedPorch','3SsnPorch','ScreenPorch'], axis=1, inplace=True)\n\n# For the following features with scarce scatter plots, a binary yes or no is assigned to.\ndata['Pool'] = data['PoolArea'].apply(lambda x: 'Y' if x > 0 else 'N')\ndata.drop('PoolArea', axis=1, inplace=True)\n\ndata['Garage'] = data['GarageArea'].apply(lambda x: 'Y' if x > 0 else 'N')\ndata.drop('GarageArea', axis=1, inplace=True)\n\ndata['FireP'] = data['Fireplaces'].apply(lambda x: 'Y' if x > 0 else 'N')\ndata.drop('Fireplaces', axis=1, inplace=True)\n\ndata['kitchen'] = data['KitchenAbvGr'].apply(lambda x: 'Y' if x > 0 else 'N')\ndata.drop('KitchenAbvGr', axis=1, inplace=True)\n\ndata['MiscValHigh'] = data['MiscVal'].apply(lambda x: 'Y' if x > 100 else 'N')\ndata.drop('MiscVal', axis=1, inplace=True)","1d01a40d":"numerical = data.dtypes[data.dtypes != object].index.tolist()\ncategorical = data.dtypes[data.dtypes == object].index.tolist()","e33ef68f":"def skew_features(df):\n    skew_list = []\n    for col in df.columns:\n        if ( (stats.skew(df[col])) > 0.6 ):\n            skew_before = stats.skew(df[col])\n            skew_B = stats.skew(boxcox1p(df[col], stats.boxcox_normmax(df[col] + 1)))\n            if (skew_B < skew_before) and (skew_B > 0):\n                skew_list.append(col)\n                \n            print('BoxCox', col, skew_before, skew_B)\n    return skew_list","87f1ae5a":"skew_list = skew_features(data[numerical])","0351cd49":"skew_list","94daa8c5":"# Plot skew features before transforming.\ni = 1\nsns.set(rc={'figure.figsize':(10,30)})\nfor col in skew_list:\n    plt.subplot(len(skew_list),1,i)\n    sns.distplot(data[col], fit=stats.norm, kde=False, hist_kws={\"label\": col}, fit_kws={\"label\": \"Normal Fit\"})\n    i = i + 1\nplt.tight_layout()\n# plt.savefig(\"skew_before.jpeg\", dpi=150)","e700626e":"for col in skew_list:\n    data[col] = boxcox1p(data[col], stats.boxcox_normmax(data[col] + 1))","4450b858":"# Plot transformed features.\ni = 1\nsns.set(rc={'figure.figsize':(10,30)})\nfor col in skew_list:\n    plt.subplot(len(skew_list),1,i)\n    sns.distplot(data[col], fit=stats.norm, kde=False, hist_kws={\"label\": col}, fit_kws={\"label\": \"Normal Fit\"})\n    i = i + 1\nplt.tight_layout()\n# plt.savefig(\"skew_after.jpeg\", dpi=150)","a1c4322d":"def find_outliers(df):\n    listd = []\n    for col in df.columns:\n        upper = df[col].mean() + 5*(df[col].std())\n        lower = df[col].mean() - 5*(df[col].std())\n        \n        dropp = df[(df[col] > upper) | (df[col] < lower)][[col]].index.tolist()\n        listd.append(dropp)\n        print(col, dropp)\n        #df.drop(dropp, axis=0, inplace=True)\n    return list(set([item for sublist in listd for item in sublist]))","19dc3915":"to_drop = find_outliers(data.loc[:1460, numerical])","f17f3755":"len(to_drop)\/df_test.shape[0]*100","65c72bfa":"data.drop(to_drop, inplace=True)\ntarget_log1p.drop(to_drop, inplace=True)","5eb35b54":"data.loc[:1460].shape","70e038fb":"target_log1p.shape","7c0e8cf0":"def encode_data(input_df, cols):\n    \n    input_df = pd.get_dummies(input_df, columns=cols, drop_first=True, prefix=cols, prefix_sep='_')\n    \n    return input_df","603a0f5f":"encoded_df = encode_data(data, data[categorical].columns.tolist())","20503403":"LData = encoded_df.loc[:1460]\nRData = encoded_df[:]","21b10f23":"LData['SalePrice'] = target_log1p['SalePrice'].values","da26c07c":"linear_cols = LData.corr()[abs(LData.corr()['SalePrice']) > 0.5][['SalePrice']].sort_values(by='SalePrice', ascending=False).index.tolist()\nLData.loc[:, linear_cols].corr() > 0.8","f7ec7236":"multi_coll = ['GrLivArea','GarageYrBlt','SalePrice']","db729e17":"use_cols = [col for col in linear_cols if col not in multi_coll]\nuse_cols.append('SalePrice')\nLData.loc[:, use_cols].corr()['SalePrice']","51b045c5":"use_cols.remove('SalePrice')","c10d0530":"use_cols","9cb2fa25":"RData.isna().sum().sum()","f03000a7":"# Function called after a models has been trained and predicted values.\n# This plots visuals to assess the model's performance.\ndef evaluate_models(model_label):\n    plt.figure(figsize=(15,10))\n    plt.subplot(2,3,1)\n    plt.scatter(range(len(y_train)), y_train.sort_values(by='SalePrice'), label='Actual Train SalePrice Ordered')\n    plt.scatter(range(len(y_pred_train)), sorted(y_pred_train), label='Predicted Train SalePrice Ordered')\n    plt.legend()\n    plt.xlabel('Observation')\n    plt.ylabel('SalePrice')\n    \n    plt.subplot(2,3,2)\n    errors = np.array(y_pred_train.reshape(-1,1) - y_train)\n    errors = np.round(errors, 2)\n    plt.hist(errors, label='Train Errors')\n    plt.legend()\n    plt.xlabel('Error')\n    plt.ylabel('Frequency')\n    \n    plt.subplot(2,3,3)\n    plt.scatter(y_train, y_pred_train.reshape(-1,1), label='y_train vs y_train_predicted')\n    plt.legend()\n    plt.xlabel('Actual')\n    plt.ylabel('Predicted')\n    \n    plt.subplot(2,3,4)\n    plt.scatter(range(len(y_test)), y_test.sort_values(by='SalePrice'), label='Actual Test SalePrice Ordered')\n    plt.scatter(range(len(y_pred_test)), sorted(y_pred_test), label='Predicted Test SalePrice Ordered')\n    plt.legend()\n    plt.xlabel('Observation')\n    plt.ylabel('SalePrice')\n    \n    plt.subplot(2,3,5)\n    errors = np.array(y_pred_test.reshape(-1,1) - y_test)\n    errors = np.round(errors, 2)\n    plt.hist(errors, label='Test Errors')\n    plt.legend()\n    plt.xlabel('Error')\n    plt.ylabel('Frequency')\n    \n    plt.subplot(2,3,6)\n    plt.scatter(y_test, y_pred_test.reshape(-1,1), label='y_test vs y_test_predicted')\n    plt.legend()\n    plt.xlabel('Actual')\n    plt.ylabel('Predicted')\n    \n    plt.tight_layout()\n#     plt.savefig(model_label+\".jpeg\", dpi=150)\n    plt.show()","ab1ab510":"# Function to calculate the MSE, R2 and LMSE metrics for y_actual and y_predicted.\ndef get_score(y_actual, y_predicted, label=''):\n    MSE       = metrics.mean_squared_error(y_actual, y_predicted)\n    R_squared = metrics.r2_score(y_actual, y_predicted)\n    LMSE      = np.sqrt(MSE)\n    \n    print('-------'+label+'--------')\n    print('MSE_'+label+':', MSE)\n    print('R_squared_'+label+':', R_squared)\n    print('LMSE_'+label+':', LMSE)","e6b23b6a":"y = target_log1p\nX = RData.loc[:1460,use_cols]\nX_sub = RData.loc[1461:,use_cols]","96088ee6":"X_train, X_test, y_train, y_test = train_test_split(X,\n                                                    y,\n                                                    test_size=0.2,\n                                                    random_state=42)","4430838f":"lm1 = LinearRegression()\nlm1.fit(X_train, y_train)\n\ny_pred_train = lm1.predict(X_train)\nget_score(y_train, y_pred_train, 'Train')\n\ny_pred_test = lm1.predict(X_test)\nget_score(y_test, y_pred_test, 'Test')\n\nevaluate_models('Linear')","62a60f38":"y = target_log1p\nX = RData.loc[:1460]\nX_sub = encoded_df.loc[1461:]","6df00607":"X_train, X_test, y_train, y_test = train_test_split(X,\n                                                    y,\n                                                    test_size=0.2,\n                                                    random_state=42)","773d1306":"DTreg = DecisionTreeRegressor()\nRFreg = RandomForestRegressor(n_estimators=100)\n\nDTreg.fit(X_train, y_train)\nRFreg.fit(X_train, y_train.values.ravel())\n\nmodels = [DTreg, RFreg]\nmodelstr = ['Decision', 'RandomForest']\n\ni = 0\nfor modl in models:\n    print(modl)\n    y_pred_train = modl.predict(X_train)\n    get_score(y_train, y_pred_train, 'Train')\n    \n    y_pred_test = modl.predict(X_test)\n    get_score(y_test, y_pred_test, 'Test')\n    \n    evaluate_models(modelstr[i])\n    i = i + 1\n\n    print()","6ac65f76":"scaler = StandardScaler()\nX_scaled = scaler.fit_transform(X)\nX_sub_scaled = scaler.fit_transform(X_sub)","b88d23a2":"X_train, X_test, y_train, y_test = train_test_split(X_scaled,\n                                                    y,\n                                                    test_size=0.2,\n                                                    random_state=42)","0689f761":"ridge = Ridge(alpha=10)\nlasso = Lasso(alpha=0.003)\n\nridge.fit(X_train, y_train)\nlasso.fit(X_train, y_train)\n\nmodels = [ridge, lasso ]\nmodelstr = ['ridge', 'lasso']\n\ni = 0\nfor modl in models:\n    print(modl)\n    y_pred_train = modl.predict(X_train)\n    get_score(y_train, y_pred_train, 'Train')\n    \n    y_pred_test = modl.predict(X_test)\n    get_score(y_test, y_pred_test, 'Test')\n    \n    evaluate_models(modelstr[i])\n    i = i + 1\n\n    print()","77a43028":"coeff = pd.DataFrame(lasso.coef_, X.columns, columns=['Coefficient'])","4a48c1ff":"coeff.sort_values(by='Coefficient', ascending=False)[:10]","c6173647":"coeff.sort_values(by='Coefficient', ascending=True)[:10]","77df7864":"lasso.intercept_","2e2c3e52":"# Use the sample submission file for the correct format and index.\nsub = sample_sub","1c8b4657":"# Replace the data with the lasso model (best performance) predictions\nsub['SalePrice'] = np.exp(lasso.predict(X_sub_scaled))-1","a357038e":"# save the submission\nsub.to_csv('submission.csv')","d33b7cb4":"# Multiple Linear Regression with Variable Selection","8410c15f":"----\n# Encode Categorical Features","01c80941":"Only the very extreme values are used to drop row entries. If more rows are dropped the test scores of the models decrease significantly.","36c90c39":"The first step is to load the data sets provided by the competition into dataframes. This includes a training set that will be used to train and validate the models. A test set is provided that must be used to make predictions to be submitted for a score.","0ce550c2":"A correlation matrix is created and plotted as a heatmap to see which variables are correlated to the target and to each other.","bc08e338":"The training set has entries with very high house prices that will cause a skew distrubtion of data.","303d0e74":"The sale price data will be log transformed.","92bae0b7":"The correlation heatmap shows that OverallQual and GrLivArea are two of the strongest predictors for the sale price. Multicollinearity  between predictors can also be observed. YearBuilt and GarageYBlt are strongly correlated as can be expected, since a house and its garage are built around the same year.","67beafe4":"# EDSA CPT Group 12 Linear Regression\n## kaggle House Prices: Advanced Regression Techniques","3fe5378d":"----\n# Regularized Models","eb9eb7cc":"----\n# Choose X, X_sub and y for Remaining Models","b5d90c43":"By inspecting the different values in the basement features it can be seen where 'No' or 'none' is applicable.","ef61d05e":"Investigating how the house prices vary per neighborhood, and looking at the diferences between the mean and median per neighborhood helps to indicate what value to use to fill the NaN for LotFrontage.","cb5e3f57":"The data is scaled to ensure the regularization penalties are applied fairly across all features and is not affected by a features range. The z standardization ensures a large enough range.","7006dc01":"The following simplifications are done to avoid redundant columns.\nThe simplifications gave slightly better results.","af79ade9":"The rest of the missing basement values there is no basement.","8e23d8ac":"----\n# Categorical data handling","d93b4329":"----\n# Introduction","8de3fd56":"There are a number of columns that are missing values. The columns are also of different datatypes (object, int, float) that will have to be inspected to be used as numerical or categorical features. Some of the columns might need to be changed from numerical to categorical and vice versa.","2ffba2f3":"All three features have nearly linear relationships with the target variable - SalePrice.\nThe residual variation in OverallQual looks to be constant where in general living area it fans out at higher prices and areas.","1f2ca606":"The house feature that must be predicted is its house price and will therefore be referred to as the target variable.\nAn inspection of the sale prices is done.\n\nOnly the test set contains sale price observations as the sale price must be predicted for the test set.","3bc8a4f3":"For missing basement values it is first checked if there is a basement or not.","13cb98b4":"The goals of this notebook is to analyse the data provided in order to accurately fit applicable machine learning models that can be used to predict the price of a house based on certain features.","8fc05c42":"If the features strongest correlated to SalePrice is plotted, the variation in the relationships can be seen.","acddcf2f":"The sublclass, month sold and year sold are picked up as numerical values but carry categorical meaning and is therefore converted to strings.","7823d390":"----\n## The data","cd855ce8":"----\n# Submission","120d1a24":"The SalePrice values are not normally distributed, but rather skewed to the right\/positively skewed (Skewness value > 0).\nThis means that the very expensive houses are seen as outliers. The following boxplot and descriptive statistics confirms the skewness.","2cf658c5":"----\n# Outliers","436d22ef":"In this case there is a basement so a mode value is more applicable.","bb9ecaed":"The missing fireplace qualities is checked for values>0.","55959468":"----\n## The target: Sale Price","0ac0528a":"The PoolQC has the most missing values. The different values for PoolQC is inspected and also the related feaure, namely, PoolArea. The data description text file is also consulted.","224e7117":"----\n## Correlations","3b28475b":"# Decision Tree and Random Forest","afb2a2f8":"## Evaluation Functions","ecaef5e6":"The LotFrontage is taken as the median value.","c4bd2090":"This value for GarageYrBlt is most likely a typing error and supposed to be 2007 as the year remodeling was done.","2e9d62fb":"The missing values for PoolQC without an actual pool can be set to 'none' while the three unknown pool qualities with PoolAreas will be assumed to be average\/typical.","4281842b":"----\n**Team Members**: Simphiwe Dangazela | Lakhiwe Liwani | Zipho Matiso | Purity Molala | Niel Smith","a0c542dc":"MiscFeature, Alley, and Fence are replaced with 'none' when there is no instance of the feature as per the description text.","9f960861":"Two datasets are made: one for linear regression correlation filtering and one for the rest.","d2104970":"## Correlated Columns","4a35a0fa":"The string 'none' will be used when the feautre is not there. In the case of BsmtExposure the term 'No' is used to give meaning when there is a basement but no exposure.","a8ef07cb":"----\n# Load the data sets","30fa4d99":"----\n# Load libraries and modules","0d4915af":"----\n# EDA\nThe Exploratory Data Analysis helps to understand what data cleaning and transformation steps are required. This helps to decided on what machine learning models can be considered.","14fed699":"The function below is used to plot the performance of a model.","a5d4f540":"The garage relate missing values are also fisrt checked if a garage is present. For the rest of the no garage entries 'none' and 0 are used.","3c176294":"\n----\n## Modelling","24aff488":"# Transform Skew Numerical Features","e0963d0b":"## Linear Model","3ba27c67":"----\n# Filling in missing values","72f9473d":"----\n## Choose X, X_sub and y for Linear Model","fa35601f":"The numerical features with skewed data is log transformed.","ea15c797":"At this stage only numerical features can be seen. When the categorical features are transformed into numerical features the correlations can be checked again.","aa1cce43":"# Datasets for different models"}}