{"cell_type":{"1ef32d17":"code","fe405958":"code","175cd6dd":"code","ffd649a9":"code","dc4c1d87":"code","2de8e1cc":"code","8bce6e05":"code","599caf08":"code","2d4d57a7":"code","182e2cd0":"code","4477f413":"code","95e844bf":"code","3fae5d0d":"code","2659b9d3":"code","50079719":"code","0302c9d8":"code","da6dcabc":"code","100de7d3":"code","ac0ed1b3":"code","e8cfb311":"code","e1d28b5b":"code","8183db0f":"code","fa07218d":"code","44a5817d":"code","74ca79ba":"markdown","fbfcec90":"markdown","3a371b43":"markdown","96564d33":"markdown","daa57fd3":"markdown","6e99b947":"markdown","be8fe7bb":"markdown","88c3ae5c":"markdown","297fbb98":"markdown","4b9c89ab":"markdown","88e59eb0":"markdown","225da916":"markdown","eb5e7a84":"markdown","c9aeadca":"markdown","aec4a295":"markdown","0cfff52a":"markdown","712174cc":"markdown","317d9253":"markdown","81b73107":"markdown","da787026":"markdown","a03b14dc":"markdown"},"source":{"1ef32d17":"\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns\nimport matplotlib\nimport matplotlib.pyplot as plt\nfrom pandas import DataFrame as DF\n%matplotlib inline\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n","fe405958":"path = '\/kaggle\/input\/netflix-shows\/netflix_titles.csv'\n\n\nnetflix = pd.read_csv(path)\nraw = netflix\n\n# preview\nnetflix.head()","175cd6dd":"print('The dataset consists of: \\n {} features.' .format(netflix.shape[1]))\nprint('{} observations.'.format(netflix.shape[0]))","ffd649a9":"netflix.info()","dc4c1d87":"# Exact count of missing data per columns :\n\nnetflix.isna().sum()","2de8e1cc":"# For further exploration, the 'director' , 'show_id' , 'cast', 'date_added' columns will not be considered.\n\nnetflix.drop(['director','show_id', 'cast'], \n            inplace=True,\n            axis= 'columns')\n","8bce6e05":"print('Now the remaining null values are : ')\n\nnetflix.isna().sum()[netflix.isna().sum()>0]","599caf08":"# Lets display some of the observations will null values as 'country'\nnull_select = netflix.country.isna()\nnetflix[netflix.country.isna()].head(5)","2d4d57a7":"print('The mode for the country column is :')\n\nnetflix.country.mode(dropna=True)","182e2cd0":"netflix.country.fillna('International', inplace=True)\nnetflix[null_select].head()","4477f413":"netflix.dropna(subset=['rating','date_added'] , axis= 'index', inplace=True)\n\n#lets check the dataset after tackling the null values\nnetflix.info()","95e844bf":"plt.figure(figsize=(14,5))\n\nsns.histplot(x=netflix.release_year)\nplt.xlim(1920, None)\nplt.show()\n\n\nprint('Most of the content was released in the year : {}'.format(netflix.release_year.value_counts().idxmax()))\nprint('For that release year, a total of {} contents is present on Netflix'. format(netflix.release_year.value_counts().max()))","3fae5d0d":"fig = plt.figure(figsize=(14,5))\nax1 = fig.add_subplot(121)\nax2 = fig.add_subplot(122)\n\n\nsns.kdeplot (x=netflix.release_year,\n            hue=netflix.type,\n            palette='mako',\n            ax= ax1)\n\nsns.boxplot (x=netflix.release_year,\n            hue=netflix.type,\n            palette='mako',\n            ax=ax2)\n\n\nplt.show()","2659b9d3":"# Quick look at what the data looks like\n\nnetflix.date_added.iloc[:3]","50079719":"# Some manipulation is required to extract the year content was added from the 'date_added' field.\n\n# The year will be stored in a new column of the 'netflix' dataset named 'year_added'\n# Converting values to integer\nfor lab, row in netflix.iterrows():\n    netflix.loc[lab,'year_added'] = int(row['date_added'][-4:])\n\n\nnetflix.year_added.iloc[:3]","0302c9d8":"\ndata = DF(netflix.groupby(['year_added','type'])['title'].size())\ntotals = DF(netflix.groupby('year_added')['title'].size())\n\ndata_pct = data.div(totals,level='year_added')*100\ndata_pct=data_pct.unstack(-1)\n\n# Stacked Area Plot\n\nfig= plt.figure()\nax1 = fig.add_subplot(1,2,1)\nax2 = fig.add_subplot(1,2,2)\n\n\nsns.set_theme()\n\n# First Vix\ntotals.plot.line(ax=ax1, figsize=(16,5))\nax1.get_legend().remove()\nax1.set_title('Content addition by year')\nax1.set_ylabel('Titles added')\nax1.set_xlim(2008,2020)\n\n\n# Second Viz\ndata_pct.plot.area(ax=ax2, figsize=(16,5))\nax2.legend(['Movie','TV Show'])\nax2.set_ylabel('Percentage')\nax2.set_title('Content addition by type - yearwise')\nax2.set_xlim(2008,2020)\nax2.set_ylim(0,100)\n\nplt.show()","da6dcabc":"df= netflix\ndf_agg = df.groupby(['type','country']).agg({'title': np.size})\ngroup = df_agg['title'].groupby('type', group_keys=False)\nres = group.apply(lambda x: x.sort_values(ascending=False).head(5))\nDF(res)","100de7d3":"# For this analysis, we will require 'type', 'country' and 'year_added'.\n# We will only consider as from 2016 as this is the year where the contents have been increasing drastically.\n\nTop5movie = ('United States','India','International','United Kingdom','Canada')\nTop5tv = ('United States', 'International', 'United Kingdom', 'Japan', 'South Korea')\n\ndf_mov = netflix.loc    [(netflix['year_added'] >= 2016) \n                        & (netflix['year_added'] < 2021)\n                        & (netflix['country'].isin(Top5movie)) \n                        & (netflix['type'] == 'Movie')]\n\ndf_tv = netflix.loc     [(netflix['year_added'] >= 2016) \n                        & (netflix['year_added'] < 2021)\n                        & (netflix['country'].isin(Top5tv)) \n                        & (netflix['type'] == 'TV Show')]\n\n\nmov_agg = DF(df_mov.groupby(['country','year_added'])['title'].size()).reset_index()\ntv_agg = DF(df_tv.groupby(['country','year_added'])['title'].size()).reset_index()\n\n\nfig = plt.figure(figsize=(16,5))\nax1 = fig.add_subplot(121)\nax2 = fig.add_subplot(122)\n\n\n\n# Movie Plot\nsns.lineplot    (data = 'move_agg',\n                x= mov_agg.year_added,\n                y= mov_agg.title,\n                style= mov_agg.country,\n                hue= mov_agg.country,\n                palette='magma_r',\n                markers=True,\n                ax= ax1)\n\nax1.set_ylabel('Titles added')\nax1.set_title('Movies')\nax1.set_xlim(2016,2020)\n\n# TV Show Plot\nsns.lineplot    (data = 'tv_agg',\n                x= tv_agg.year_added,\n                y= tv_agg.title,\n                style= tv_agg.country,\n                hue= tv_agg.country,\n                palette='magma_r',\n                markers=True,\n                ax = ax2)\n\nax2.set_ylabel('Titles added')\nax2.set_title('TV Shows')\nax2.set_xlim(2016,2020)\nplt.show()","ac0ed1b3":"# Selecting movies only\n# Extracting values from 'duration' column\n\nmovie_len = netflix.loc[netflix['type'] == 'Movie']\nmovie_len.duration = movie_len.duration.str.extract('(\\d+)').astype(float)\n\nmovie_len_comp = movie_len.loc[(movie_len['country'] == 'United States') | (movie_len['country'] == 'India')]\n","e8cfb311":"\nfig = plt.figure(figsize=(16,6))\n\nax1 = fig.add_subplot(121)\nax2 = fig.add_subplot(122) \n\nsns.lineplot(\n    data= movie_len,\n    x='release_year',\n    y='duration',\n    ax= ax1)\n\nsns.lineplot(\n    data= movie_len_comp,\n    x='release_year',\n    y='duration',\n    hue='country',\n    ax= ax2)\n\nax1.set_title('Overall Movie Duration')\nax2.set_title('USA and India Movie Duration')\nax1.set_xlim(1970,2020)\nax2.set_xlim(1970,2020)\nplt.show()","e1d28b5b":"# Selecting the useful columns\ncols = ['type','year_added','listed_in','country','description']\ndf = netflix.loc[:,cols]\n\n\n# Breaking 'listed_in' tags into individual entries\ndf.listed_in = df.listed_in.str.split(pat=', ')\ndf_xp = df.explode('listed_in')\n\n#grouping\ngrp = DF(df_xp.groupby(['type','listed_in']).size())\ngrp.columns = ['count']\ngrp_sort = DF(grp['count'].groupby(['type'],group_keys=False).apply(lambda x : x.sort_values(ascending=False).head(5)))\ngrp_sort\n\n","8183db0f":"grp_sort.reset_index(inplace=True)\n\n# Top5 Categories\nmov_cat = grp_sort[grp_sort['type'] == 'Movie']['listed_in'].to_list()\ntv_cat = grp_sort[grp_sort['type'] == 'TV Show']['listed_in'].to_list()","fa07218d":"mov_comp = df_xp[df_xp['listed_in'].isin(mov_cat)]\nmov_grp = DF(mov_comp.groupby(['listed_in','year_added'])['description'].size())\nmov_data = mov_grp.reset_index()\n\ntv_comp = df_xp[df_xp['listed_in'].isin(tv_cat)]\ntv_grp = DF(tv_comp.groupby(['listed_in','year_added'])['description'].size())\ntv_data = tv_grp.reset_index()\n\n\nfig = plt.figure(figsize=(16,6))\nax1 = fig.add_subplot(121)\nax2 = fig.add_subplot(122)\n\nsns.lineplot(\n    data= mov_data,\n    x = 'year_added',\n    y = 'description',\n    hue= 'listed_in',\n    style= 'listed_in',\n    markers=True,\n    palette='magma_r',\n    ax = ax1\n)\n\nsns.lineplot(\n    data= tv_data,\n    x = 'year_added',\n    y = 'description',\n    hue= 'listed_in',\n    style= 'listed_in',\n    markers=True,\n    palette='magma_r',\n    ax = ax2\n)\n\nax1.set_title('Movie Categories')\nax1.set_xlim(2013,2020)\nax1.set_ylabel('Content added')\n\nax2.set_title('TV Show Categories')\nax2.set_xlim(2013,2020)\nax2.set_ylabel('Content added')\n\n\n\nplt.show()","44a5817d":"# Imports\nfrom wordcloud import WordCloud, STOPWORDS, ImageColorGenerator\n# Gathering all the words from Description of Drama movies \ntv_desc = df_xp[df_xp['listed_in']=='TV Dramas']\ntext = ''.join(desc for desc in tv_desc.description)\n\n\n\nstopwords = set(STOPWORDS)\n#stopwords.update(['S','s',])\n\nwordcloud = WordCloud(stopwords=stopwords , background_color='white').generate(text)\n\n\n# Display the generated image\nplt.figure(figsize=(14,8))\nplt.imshow(wordcloud, interpolation='bilinear')\nplt.axis('off')\nplt.show()\n","74ca79ba":"# Are movies getting lengthier?","fbfcec90":"# Is the release year distribution same for both movies and TV shows?","3a371b43":"## Null Values","96564d33":"For Movies:\n <br> - India had almost caught up to the United States in terms of new contents in 2018.\n <br> - After 2018 new contents for the US went on increasing whereas for India were on the decline.\n <br> - The movie trend from 2019 to 2020 is on the decline overall illustrating the impact of the pandemic on movie releases.\n\n \n <br><br>For TV Shows:\n <br> - TV Shows from the US have been on a constant rise since 2016.\n <br> - The remaining countries seem to converge towards 50 new titles yearly.\n <br> - Surprisingly, the TV shows have managed to keep the increasing release trend for 2020 despite the pandemic situation.<br>\n\n ","daa57fd3":"The yearly content addition has increased drastically as from 2015. \n<br> The added contents are in majority movies and this has been the case since 2008.<br>","6e99b947":"# About the dataset","be8fe7bb":"# What are the top 5 countries for Movies  and TV shows?","88c3ae5c":"Only 1 column is listed as 'int64'.\n<br> To make a more in-depth exploration of the data, 'duration' can be converted from categorical to numerical type.<br>","297fbb98":"# Are the other countries catching up with the United States?","4b9c89ab":"The 'director' columns a high proportion of missing data.\n<br> It will be difficult to fill with a substitute value without introducing bias in the data.<br>","88e59eb0":"Overall, the movies duration since 2010 are quite stable around 100 mins.\n<br> Comparing the Top 2 countries in the movies category, movies of Indian origin were lengthier in the years 1990 - 2000. \n<br> Since 2000, the duration trend is decreasing from 160min (in 1999) to approx 120min (in 2019).","225da916":"We shall extract the categories from the 'listed_in' column.\n<br> A single Title can have several tags which are combined in the 'listed_in' column.\n<br> Some data manipulation will be required to extract the individual tags.","eb5e7a84":"United States leads in both the 'Movie' and 'TV Shows'.<br>\n","c9aeadca":"Both movies and TV shows follow a left skewed distribution and appear to peak in the same timeframe.\n<br> Due to the extreme skewness, the release_year has a large number of outliers.<br>","aec4a295":"# Dramma TV Shows Wordcloud","0cfff52a":"If we look at the titles for the dataset extract above, it does not seem convenient to replace the null values with 'United States'.\n<br>Therefore, we will create a new category called 'International' that will regroup the unkown countries.<br>","712174cc":"# What are the trending categories for the past 7 years?","317d9253":"Ignoring 'International Movies' and 'International TV Shows' :\n<br> For both Movies and TV Shows, the leading 2 categories are 'Dramas' and 'Comedies'. <br>","81b73107":"The null values were successfully replaced by 'International'.\n<br>We shall drop the 7 observations for which the rating feature is null.<br>","da787026":"# What type of content is being added the most ?","a03b14dc":"# Content distribution by release year"}}