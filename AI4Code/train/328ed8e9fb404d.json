{"cell_type":{"bb257f31":"code","99109e4e":"code","00156db8":"code","9461cf33":"code","c85e6b61":"code","3e921fa1":"code","12701d93":"code","b4138c3d":"code","ea00a560":"code","e62cc042":"code","be1bfaed":"code","edcbb377":"code","b6965037":"markdown","3f07a4c2":"markdown","39797f60":"markdown","818c7fa2":"markdown","20d6a321":"markdown","bdae3d31":"markdown","8c048bd9":"markdown","1a71e232":"markdown","ab764e7b":"markdown","081f25a5":"markdown","7d5a0779":"markdown","66c76929":"markdown"},"source":{"bb257f31":"import numpy as np\nimport pandas as pd\n\nimport gc\n\nfrom IPython.display import clear_output\n!pip install autokeras\nclear_output()\n\nimport tensorflow as tf\nfrom sklearn.model_selection import train_test_split\nimport autokeras as ak","99109e4e":"ID = \"Id\"\nTARGET = \"Cover_Type\"\nTEST_SIZE = 0.2\nRANDOM_SEED = 42\nMAX_TRIAL = 3 # for simple test \nEPOCHS = 5  # for simple test \nVALIDATION_SPLIT = 0.15","00156db8":"train = pd.read_csv(\"..\/input\/tabular-playground-series-dec-2021\/train.csv\")\ntest = pd.read_csv(\"..\/input\/tabular-playground-series-dec-2021\/test.csv\")","9461cf33":"train = train.drop([ID],axis=1)\ntest = test.drop([ID],axis=1)","c85e6b61":"y = train[TARGET]\nX = train.drop([TARGET],axis=1)\nX_test = test\n\ngc.collect()","3e921fa1":"from sklearn.preprocessing import StandardScaler\ntotal = pd.concat([X,X_test],axis=0)\ntrans = StandardScaler()\ntrans.fit(total)\n\nX= trans.transform(X)\nX_test = trans.transform(X_test)\n\ngc.collect()","12701d93":"X_train,X_val,y_train,y_val=train_test_split(X,y,test_size=TEST_SIZE,random_state=RANDOM_SEED)","b4138c3d":"clf = ak.StructuredDataClassifier(max_trials=MAX_TRIAL,seed=RANDOM_SEED)\nclf.fit(X_train, y_train, epochs=EPOCHS, validation_split=VALIDATION_SPLIT)","ea00a560":"clf.evaluate(X_val, y_val)","e62cc042":"model = clf.export_model()\nmodel.summary()","be1bfaed":"pred_test = model.predict(X_test)\npred_test[:5]","edcbb377":"sub = pd.read_csv('..\/input\/tabular-playground-series-dec-2021\/sample_submission.csv')\nsub[TARGET]=(pred_test - 0.5).astype(int) + 1\nsub.to_csv('sub.csv',index=False)\nsub.head()","b6965037":"# import libraries","3f07a4c2":"# evaluate model","39797f60":"# submission","818c7fa2":"# delete unnecessary columns","20d6a321":"# search best model and build best model ","bdae3d31":"# scaling","8c048bd9":"# split data (train set and validation set)","1a71e232":"# global variables","ab764e7b":"# load data ","081f25a5":"# split data (input data and target data)","7d5a0779":"# predict test data using best model","66c76929":"# get best model"}}