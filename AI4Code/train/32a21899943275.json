{"cell_type":{"68ff6c2f":"code","97159ce1":"code","277c3828":"code","687fae89":"code","42dddb23":"code","a801389c":"code","4fe7b026":"code","24fdb092":"code","830340a3":"code","39c647f1":"code","52bf39bb":"code","7cccc669":"code","45d2112b":"code","57a08f8b":"code","fd4ce70d":"code","5b98dc31":"code","306c73e9":"code","556df1fa":"code","f7567a7e":"code","7458ed97":"code","aeca2d7f":"code","25d04146":"code","c2593267":"code","812eabfa":"code","bfe13c7c":"code","99be9879":"code","bae2c99e":"code","30baff36":"code","c4a2a69e":"code","ea7bc207":"code","a4162d6f":"markdown"},"source":{"68ff6c2f":"%reset -f  \n\nimport warnings\nwarnings.filterwarnings(\"ignore\")\n\n# 1.1 Data manipulation library\nimport pandas as pd\nimport numpy as np\nfrom sklearn.datasets import make_blobs\n%matplotlib inline\n\n# 1.2 OS related package\n\nimport os\n\n# 1.3 Modeling librray\n# 1.3.1 Scale data\n\nfrom sklearn.preprocessing import StandardScaler\n\n# 1.4 Plotting library\n\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\n# 1.5 Import GaussianMixture class\n\nfrom sklearn.mixture import GaussianMixture\n\n# 1.6 TSNE\nfrom sklearn.manifold import TSNE\n","97159ce1":"# Display multiple outputs from a jupyter cell\n\nfrom IPython.core.interactiveshell import InteractiveShell\nInteractiveShell.ast_node_interactivity = \"all\"","277c3828":"# DateFrame object is created while reading file available at particular location given below\n\ndf=pd.read_csv(\"..\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv\")","687fae89":"df.head()","42dddb23":"df.shape","a801389c":"# Rename Columns of DataFrame with Proper name\n\ndf.rename(columns = {'CustomerID': 'Customer_ID','Gender':'Gender','Age': 'Age','Annual Income (k$)' : 'Annual_Income',\n                    'Spending Score (1-100)':'Spending_Score'},inplace=True)","4fe7b026":"df.info()","24fdb092":"# Drop Customer Id column from DataFrame\n\ndf.drop(columns = \"Customer_ID\", inplace = True)","830340a3":"# Displaying the columns of DataFrame after dropping customer id column\n\ndf.columns","39c647f1":"# Transforming Gender column to 0 and 1\n\ndf.Gender.replace(to_replace = ['Male','Female'],value = [0,1],inplace= True)","52bf39bb":"# Displaying first 5 rows after transforming gender to 0 and 1\n\ndf.head()","7cccc669":"# Shows the relationship between annual income and spending score by scatter plot\n\nsns.relplot(x=\"Annual_Income\", y=\"Spending_Score\", col=\"Gender\", data=df)\n\n# Shows the relationship between age and spending score by scatter plot\n\nsns.relplot(x=\"Age\", y=\"Spending_Score\", col=\"Gender\",data=df)","45d2112b":"# Shows the relationship between annual income and spending score by line plot\n\nsns.relplot(x=\"Annual_Income\", y=\"Spending_Score\", col=\"Gender\",kind=\"line\",data=df)\n\n# Shows the relationship between age and spending score by line plot\n\nsns.relplot(x=\"Age\", y=\"Spending_Score\", col=\"Gender\",kind=\"line\",data=df)","57a08f8b":"# Shows the relationship of each figure\n\nsns.pairplot(hue=\"Gender\",data=df)","fd4ce70d":"# Shows the gender-wise count\n\nsns.countplot(x=\"Gender\",data=df,linewidth=5,edgecolor=sns.color_palette(\"dark\", 1))","5b98dc31":"sns.distplot(df.Annual_Income,color='b')","306c73e9":"sns.distplot(df.Spending_Score,color='b')","556df1fa":"sns.regplot(x=\"Annual_Income\", y=\"Spending_Score\", data=df)","f7567a7e":"# Take the selected data from dataframe \n\ndfselecteddata = df[['Age','Annual_Income','Spending_Score']]\n\n# Scale data using StandardScaler\n    \nss = StandardScaler()                 # Create an instance of class\nss.fit(dfselecteddata)                # Train object on the data\nX = ss.transform(dfselecteddata)      # Transform data\nX[:5, :]                              # See first 5 rows","7458ed97":"# Perform clsutering using Gaussian Mixture Modelling\n\ngm = GaussianMixture(\n                     n_components = 4,\n                     n_init = 10,\n                     max_iter = 100)\n\n# Train the algorithm\ngm.fit(X)\n\n# Where are the clsuter centers\ngm.means_\n\n# Did algorithm converge?\ngm.converged_\n\n# How many iterations did it perform?\ngm.n_iter_\n\n# Clusters labels\ngm.predict(X)","aeca2d7f":"# Plot cluster and cluster centers from gmm\n\nfig = plt.figure()\n\nplt.scatter(X[:, 0], X[:, 1],\n            c=gm.predict(X),\n            s=2)\n\nplt.scatter(gm.means_[:, 0], gm.means_[:, 1],\n            marker='v',\n            s=5,               # marker size\n            linewidths=5,      # linewidth of marker edges\n            color='red'\n            )\nplt.show()","25d04146":"# Anomaly detection\n# Anomalous points are those that are in low-density region Or where density is in low-percentile of 4%\n\n\ndensities = gm.score_samples(X)       #score_samples() method gives score or density of a point at any location.\ndensities\n\ndensity_threshold = np.percentile(densities,4)\ndensity_threshold\n\nanomalies = X[densities < density_threshold]\nanomalies\nanomalies.shape                                                    ","c2593267":"# Show anomalous points\n\nfig = plt.figure()\n\nplt.scatter(X[:, 0], X[:, 1], c = gm.predict(X))\nplt.scatter(anomalies[:, 0], anomalies[:, 1],\n            marker='^',\n            s=50,               # marker size\n            linewidths=5,      # linewidth of marker edges\n            color='red'\n            )\nplt.show()","812eabfa":"# Understand differences in anomalous & unanomalous (ie normal)data.\n\n# Get first unanomalous data\n\nunanomalies = X[densities >= density_threshold]\nunanomalies.shape    \n\n# Transform both anomalous and unanomalous data to pandas DataFrame\n\ndf_anomalies = pd.DataFrame(anomalies, columns = ['x','y','z'])\ndf_anomalies['t'] = 'anomalous'   # Create a 4th constant column\ndf_normal = pd.DataFrame(unanomalies, columns = ['x','y','z'])\ndf_normal['t'] = 'unanomalous'    # Create a 4th constant column","bfe13c7c":"# Let us see density plots\n\nsns.distplot(df_anomalies['x'])\nsns.distplot(df_normal['x'])","99be9879":"# Draw boxplots\n# Ist stack two dataframes\n\ndf1 = pd.concat([df_anomalies,df_normal])\n\n# 7.4.2 Draw featurewise boxplots\n\nsns.boxplot(x = df1['t'], y = df1['x'])","bae2c99e":"# Use either AIC or BIC measures to discover ideal no of clusters\nbic = []\naic = []\nfor i in range(4):\n    gm = GaussianMixture(\n                     n_components = i+1,\n                     n_init = 10,\n                     max_iter = 100)\n    gm.fit(X)\n    bic.append(gm.bic(X))\n    aic.append(gm.aic(X))\n","30baff36":"fig = plt.figure()\nplt.plot([1,2,3,4], aic)\nplt.plot([1,2,3,4], bic)\nplt.show()","c4a2a69e":"gm = GaussianMixture(\n                     n_components = 4,\n                     n_init = 10,\n                     max_iter = 100)\ngm.fit(X)","ea7bc207":"#  Darw a 2-D t-sne plot and colour points by gmm-cluster labels\n\ntsne = TSNE(n_components = 2)\ntsne_out = tsne.fit_transform(X)\nplt.scatter(tsne_out[:, 0], tsne_out[:, 1],\n            #marker='x',\n            s=50,              # marker size\n            linewidths=5,      # linewidth of marker edges\n            c=gm.predict(X)    # Colour as per gmm\n            )","a4162d6f":"**Importing Libraries:**"}}