{"cell_type":{"954a8f48":"code","834678a9":"code","dd98b622":"code","733c8616":"code","db58aa4f":"code","e69bca26":"code","93f73bdc":"code","8339352a":"markdown","fa67cae8":"markdown","730a8c3e":"markdown","2e945d3c":"markdown","d0cb289f":"markdown","c7143c1b":"markdown","a964e2dc":"markdown","220ef2e8":"markdown","caa8c3fe":"markdown"},"source":{"954a8f48":"# library to manipulate data in Python\nimport pandas as pd\n\n# Path of the file to read the data set.\n# we call it Xy_data containing the data of features of each house\/flat `X`\n# and the target variable `y` that will be used to train the model\n# These files (look at the left panel, label: 'Data') are \n# in the directory: '..\/input\/epf-3a\/.'\n# This directory contains :\n#            - test_data.csv \n#            - test_data_reduced.csv\n#            - train_data.csv \n#            - train_data_reduced.csv\n# The reduced data files test_data_reduced.csv and train_data_reduced.csv consist   \n# in the same data that you can found in test_data.csv and train_data.csv except for\n# the non numerical columns. In this notebook, we will only work with the reduced \n# data files... figure it out ...\nXy_file_path = '..\/input\/epf-3a\/train_data_reduced.csv'\ntest_file_path = '..\/input\/epf-3a\/test_data_reduced.csv'\n\nXy_data = pd.read_csv(Xy_file_path)\ntest_data = pd.read_csv(test_file_path)\n\nprint(\"Setup Complete\")","834678a9":"# display the shape of the training data set shape=(nb rows, nb columns)\n# and the first five rows of the set Xy : \n#    -    one row correspond to one house\/flat\n#    -    columns are features of each flat described in the description\n# of the challenge\nprint(\"Shape of the training set: \\n\",Xy_data.shape)\nprint(\"First five rows of the training set: \",Xy_data.head(5))\n\nprint('-----------------------------------------------------------------------------------------')\n# we do the same for the test data. \nprint(\"Shape of the test set: \",test_data.shape)\nprint(\"First five rows of the test set: \\n\",test_data.head(5))\n\n# Question: why does the test set contains one column less than the training set ?\n","dd98b622":"# we select all the features of the training data except the Price\nfeatures = ['Build Year','Living Area','Number of Bedrooms','Number of Photos','Total Number of Rooms','Zip Code']\nX = Xy_data[features]\n# we print the first ten elements of the variable `X`\nprint(X.head(10))\n\n# we select the `Price` column of the training set as the\n# variable that we have to predict for the features of\n# the test set.\ny = Xy_data['Price']\n\nprint('-----------------------------------------------------------------------------------------')\n# we print the first ten elements of the variable `y`\nprint(y[:10])\n\n","733c8616":"# we print classical statistical elements (number of elements:count, mean, standard deviation, max, min ....) of each column of the training data X and the target variable y\nprint('Statistical elements for the columns of the training data: ')\nprint(X.describe())\n\nprint('-----------------------------------------------------------------------------------------')\nprint('Statistical elements for the target variable: ')\nprint(y.describe())","db58aa4f":"'''\n How to validate the model ?\n An important point in mahcine learning is to validate the model. In fact\n if our algorithm is trained from all the data of the training set, even if the model\n has low errors on the training set, there is no guarantee that this algorithm\n will behave good on new data (data that were not used for the train the model, like the test_data).\n For this reason, a way to validate the model is to split the set X in two sets:\n       - train_X containing the data used to train\/fit the model\n       - val_X containing the data to validate the model\n To these two sets, we associate the corresponding target variable: train_y and val_y.      \n The idea is to used train_X to fit the model and then we can predict the values of val_X with our\n model. Then we can compare these predictions with the val_y variables. \n\n                     |-------------------------------------|---------------|\n                     |                                     |               | \n                     |                                     |               |\n     X     =         |       train_X, train_y              | val_x,val_y   |\n                     |                                     |               |\n                     |                                     |               |\n                     |-------------------------------------|---------------|\n                           These data are used to            These data are\n                            train the model                  used to validate\n                                                             the model                    \n'''   \n\n# we load the function train_test_split to split our set X into train_X and val_X\nfrom sklearn.model_selection import train_test_split\n# we separate the data X between two sets : train_X and val_X standing for respectively training data and validation data\ntrain_X, val_X, train_y, val_y = train_test_split(X, y, random_state=1)\n\n# library used to load the linear regression model\nfrom sklearn.linear_model import LinearRegression\n# library used to load the DecisionTreeRegressor model\nfrom sklearn.tree import DecisionTreeRegressor\n# library used to load the RandomForestRegressor model\nfrom sklearn.ensemble import RandomForestRegressor\n\n# we define the model \nmodel = LinearRegression()\n# uncomment the line below to define a DecisionTreeRegressor model\n#model = DecisionTreeRegressor()\n# uncomment the line below to define a RandomForestRegressor model\n#model = RandomForestRegressor()\n\n# Fit the model: we compute the parameters of the model with the training data : train_X, train_y\nmodel.fit(train_X,train_y)\n","e69bca26":"# we predict the target variable for the val_X data\npredictions = model.predict(val_X)\nprint(\"First five predictions on the training data: \",predictions[:4].tolist())\n\n# we expect that our algorithm leads to: predictions = val_y\n# because val_y are the target variables of val_X\nprint(\"First five true prices:                      \", val_y.head(4).tolist())\n\n# As you can see val_y is different from predictions. These differenteces correspond to the error of our model.\n# A way to compute the error is using mean_absolute_error function\n# load the function to compute the error\nfrom sklearn.metrics import mean_absolute_error\nprint(\"The mean absolute error between val_y and predictions is: \",mean_absolute_error(val_y,predictions))\n\n","93f73bdc":"# we make predictions on the test data\nmy_test_predictions = model.predict(test_data)\n\nprint(\"We made \", len(my_test_predictions), \"predictions\")\nprint(\"First five predictions on the test data: \",my_test_predictions[:5])\n\n# we save our solution to the file \"submission.csv\" that you can upload and see your rank for this competition (see instructions below)\noutput = pd.DataFrame({'Id': range(test_data.shape[0]),\n                       'Predicted': my_test_predictions})\noutput.to_csv('submission.csv', index=False)","8339352a":"## Your first machine learning model \nThis tutorial describes how to write a simple machine learning model using Python and library for machine learning (panda).","fa67cae8":"## Have a quick look to the data","730a8c3e":"Run this cell to load the pandas library and the data files","2e945d3c":"## Build a model and fit on the data\n\nThen :\n1. we choose a model (here, a linear regression model). \n\nWe also provide, in comments, a way to load two more models: a DecisionTreeRegressor model and a RandomForestRegressor model\n2. we fit the model that is we compute the parameters of the model with the training data X and the target variable y \n","d0cb289f":"# Test Your Work\n\nTo test your results, you'll need to join the competition (if you haven't already).  So open a new window by clicking on [this link](https:\/\/www.kaggle.com\/c\/epf-3a).  Then click on the **Submit Submission** button.\n\nNext, follow the instructions below:\n1. Begin by clicking on the blue **COMMIT** button in the top right corner of this window.  This will generate a pop-up window.  \n2. After your code has finished running, click on the blue **Open Version** button in the top right of the pop-up window.  This brings you into view mode of the same page. You will need to scroll down to get back to these instructions.\n3. Click on the **Output** tab on the left of the screen.  Then, click on the **Submit to Competition** button to submit your results to the leaderboard.\n\nYou have now successfully submitted to the competition!\n\n4. If you want to keep working to improve your performance, select the blue **Edit** button in the top right of the screen. Then you can change your model and repeat the process. There's a lot of room to improve your model, and you will climb up the leaderboard as you work.\n\n# Continuing Your Progress\nThere are many ways to improve your model, and **experimenting is a great way to learn at this point.**\n\nThe best way to improve your model is to add features.  Look at the list of columns and think about what might affect home prices.  Some features will cause errors because of issues like missing values or non-numeric data types. \n\nThe **[Machine Learning course](https:\/\/www.kaggle.com\/learn\/intro-to-machine-learning)** micro-course will teach you basic notion in machine learning.","c7143c1b":"## Specify the training set and the target variable\nWe split the set `Xy_data` into two variables:\n   -   `X` which contains the features of each house\/flat\n   -   `y` which contains the target variable which is the price of the house\/flat\n   ","a964e2dc":"## Application of our model on new data and save our solution file","220ef2e8":"## Review of the data","caa8c3fe":"## Make predictions and Compute the error\nMake predictions with the model's `predict` command using `val_X` as the data. Save the results to a variable called `predictions`."}}