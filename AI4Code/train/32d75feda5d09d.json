{"cell_type":{"67a786fe":"code","037afaf3":"code","0863df76":"code","7101c873":"code","b40f0ba9":"code","2bff82b9":"code","0d97d641":"code","72c28e11":"code","135b9b55":"code","b56f65bf":"code","4a4dee1a":"code","5d928f66":"code","71b7c83c":"code","2cd0b236":"code","7271db9b":"code","c17b376f":"code","e06a090e":"code","b3b44b85":"code","b2bdc2a8":"code","c4dc87c8":"code","80a35096":"code","ac3a8b49":"code","2cbd2453":"code","5a83536d":"code","b5dfe434":"code","b12efee5":"code","c932e833":"code","284becec":"code","8ba2beb4":"code","73cf2171":"code","01cda465":"code","92a18338":"code","e2c42e62":"code","53dc7ed3":"code","83367330":"code","104dfa04":"code","cfe3ea08":"code","7d5bce52":"code","572c2a68":"code","6c179d3f":"code","752a35ac":"code","a5508335":"code","ad715b09":"markdown","95ad4245":"markdown","6935cd5e":"markdown","fe25a4e0":"markdown","a75af651":"markdown","404a50a7":"markdown","9cf11cc1":"markdown","77ff55fc":"markdown","47c71487":"markdown","1e46efbd":"markdown","00b92909":"markdown","7becd388":"markdown","5b5eceec":"markdown","11680366":"markdown","ea0bdbc5":"markdown","5f45c557":"markdown","86db6049":"markdown","586f1ccd":"markdown","bfc83fc6":"markdown","84311b7c":"markdown","1e7943b9":"markdown","90e1ea4d":"markdown","1f477dc5":"markdown","778da32a":"markdown","b5254a4e":"markdown","83388a90":"markdown","203218c9":"markdown","61111fa0":"markdown","07f1ba24":"markdown","21761b88":"markdown","e4ffc515":"markdown","d6a43958":"markdown","2ce3ad2e":"markdown","613b0a90":"markdown","b2da9ec3":"markdown","60b4ef3a":"markdown","1ef399a4":"markdown","cd8e88c7":"markdown","fef7468a":"markdown","270d3aa1":"markdown"},"source":{"67a786fe":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport sklearn\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import confusion_matrix\nfrom sklearn.metrics import accuracy_score\nimport matplotlib.pyplot as plt\n%matplotlib inline\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n","037afaf3":"raw_data = pd.read_csv(\"..\/input\/ashrae-global-thermal-comfort-database-ii\/ashrae_db2.01.csv\")\nraw_data","0863df76":"raw_data.info()","7101c873":"data = raw_data[['Season', 'Koppen climate classification', 'Building type', 'Cooling startegy_building level',\n                 'Clo', 'Met', 'Air temperature (C)', 'Relative humidity (%)','Air velocity (m\/s)', \n                 'Outdoor monthly air temperature (C)', 'Thermal comfort']]\ndata","b40f0ba9":"data.isnull().sum()","2bff82b9":"data = data.dropna()\ndata","0d97d641":"data.isnull().sum()","72c28e11":"data.dtypes","135b9b55":"data = pd.concat([data.select_dtypes([], ['object']),data.select_dtypes(['object']).apply(pd.Series.astype, dtype='category')], axis=1)\ndata.dtypes","b56f65bf":"data['Thermal comfort'].value_counts()","4a4dee1a":"data = data[data['Thermal comfort'] != 'Na']\n\ndata['Thermal comfort'] = data['Thermal comfort'].astype('int64')\ndata['Thermal comfort'].value_counts(sort=False)","5d928f66":"data['Thermal comfort'].value_counts(sort=False).plot(kind='bar', figsize=(8,8))","71b7c83c":"data.describe()","2cd0b236":"data['Season'].value_counts().plot(kind='bar', figsize=(8,8))","7271db9b":"data['Koppen climate classification'].value_counts().plot(kind='bar', figsize=(8,8))","c17b376f":"data['Building type'].value_counts().plot(kind='bar', figsize=(8,8))","e06a090e":"data['Cooling startegy_building level'].value_counts().plot(kind='bar', figsize=(8,8))","b3b44b85":"fig, ax = plt.subplots()\nfig.set_size_inches(20,10)\nsns.boxplot(x = 'Thermal comfort', y = 'Air temperature (C)', hue = 'Cooling startegy_building level', data = data)","b2bdc2a8":"fig, ax = plt.subplots()\nfig.set_size_inches(20,10)\nsns.boxplot(x = 'Thermal comfort', y = 'Relative humidity (%)', hue = 'Cooling startegy_building level', data = data)","c4dc87c8":"data = data[data['Air velocity (m\/s)'] < 1.0]\n\nfig, ax = plt.subplots()\nfig.set_size_inches(20,10)\nsns.boxplot(x = 'Thermal comfort', y = 'Air velocity (m\/s)', hue = 'Cooling startegy_building level', data = data)","80a35096":"data['Clo'] = data['Clo'].round(1)\ndata['Clo'].value_counts()","ac3a8b49":"fig, ax = plt.subplots()\nfig.set_size_inches(20,10)\nsns.boxplot(x = 'Thermal comfort', y = 'Clo', hue = 'Cooling startegy_building level', data = data)","2cbd2453":"fig, ax = plt.subplots()\nfig.set_size_inches(10,10)\nsns.distplot(data['Clo'])","5a83536d":"data = data[data['Met'] < 3.0]\n\nfig, ax = plt.subplots()\nfig.set_size_inches(20,10)\nsns.boxplot(x = 'Thermal comfort', y = 'Met', hue = 'Cooling startegy_building level', data = data)","b5dfe434":"fig, ax = plt.subplots()\nfig.set_size_inches(10,10)\nsns.distplot(data['Met'])","b12efee5":"data","c932e833":"y1 = data['Thermal comfort']\n\nfeatures1 = ['Air temperature (C)', 'Air velocity (m\/s)', 'Relative humidity (%)', 'Clo', 'Met']\n\nX1 = data[features1]\n\nX1.describe()","284becec":"X1_train, X1_test, y1_train, y1_test = train_test_split(X1, y1, test_size = 0.2, random_state = 10)","8ba2beb4":"clf1 = RandomForestClassifier(n_estimators = 100)\nclf1.fit(X1_train, y1_train)\npred1 = clf1.predict(X1_test)","73cf2171":"print('Accuracy score: %.1f' % (accuracy_score(y1_test, pred1)*100))","01cda465":"confusion_matrix(y1_test, pred1)","92a18338":"y2 = data['Thermal comfort']\n\nfeatures2 = ['Air temperature (C)', 'Air velocity (m\/s)', 'Relative humidity (%)']\n\nX2 = data[features2]\n\nX2.describe()","e2c42e62":"X2_train, X2_test, y2_train, y2_test = train_test_split(X2, y2, test_size = 0.2, random_state = 10)","53dc7ed3":"clf2 = RandomForestClassifier(n_estimators = 100)\nclf2.fit(X2_train, y2_train)\npred2 = clf2.predict(X2_test)","83367330":"print('Accuracy score : %.1f'% (accuracy_score(y2_test, pred2)*100))","104dfa04":"confusion_matrix(y2_test, pred2)","cfe3ea08":"y3 = data['Thermal comfort']\n\nfeatures3 = ['Air temperature (C)', 'Air velocity (m\/s)', 'Relative humidity (%)', 'Clo', 'Met', \n            'Season', 'Koppen climate classification', 'Building type', 'Cooling startegy_building level', 'Outdoor monthly air temperature (C)']\n\nX3 = data[features3]\n\nX3.describe()","7d5bce52":"X3 = pd.get_dummies(data = X3, drop_first = True)","572c2a68":"X3_train, X3_test, y3_train, y3_test = train_test_split(X3, y3, test_size = 0.2, random_state = 10)","6c179d3f":"clf3 = RandomForestClassifier(n_estimators = 100)\nclf3.fit(X3_train, y3_train)\npred3 = clf3.predict(X3_test)","752a35ac":"print('Accuracy score : %.1f '% (accuracy_score(y3_test, pred3)*100))","a5508335":"confusion_matrix(y3_test, pred3)","ad715b09":"Reviewing of confusion matrix, horizontal rows are actual values (1-6) and vertical columns are predicted values (1-6). Diagonals are the numbers of values that have been mapped correctly.","95ad4245":"Refining 'Thermal comfort' in dataset by removing abnormal results and rounding to closest integers (on 1 to 6 scale):","6935cd5e":"Checking distribution of clothing insulation in dataset:","fe25a4e0":"# Prediction Model 2 (using 3 features)\n\nQuestion: Does reducing the number of feature variables help to improve the prediction model?\n\nThe following 3 features related to indoor environment conditions will be used for the second prediction model:\n\n1) Air temperature (C)\n\n2) Air velocity (m\/s)\n\n3) Relative humidity (%)\n","a75af651":"**Observation: The three most common climate type included in this dataset are 1) hot semi-arid, 2) humid subtropical, 3) tropical wet savanna.**","404a50a7":"**Observations: In general, the lower the air temperature, the higher the thermal comfort.**","9cf11cc1":"No more missing data!\n\nChecking data type of columns:","77ff55fc":"A closer look at 'Thermal comfort' the target variable we are interested in for this study:","47c71487":"# Conclusion\n\nPrediction model 3, comprising of all 10 feature variables, has the best results (i.e. highest accuracy) when using random forest classification algorithm.\n\nHowever, there are limitations to using this prediction model:\n* Dataset used for training is more skewed towards hot semi-arid climate \n* Dataset used for training is more skewed towards summer season\n* Dataset used for trinaing is more skewed towards office building type\n* Approximately 55% accuracy result may not be good enough to predict thermal comfort with high confidence\n\n**Recommendations:**\n* Using more diverse and evenly distributed dataset for training (e.g. include more climate types, more different building types)\n* Include radiant temperature as one of the feature variables since this is one of the more recognised factor affecting thermal comfort\n\n","1e46efbd":"# 2) Thermal comfort VS Relative humidity (%)","00b92909":"**Observation: Building cooling strategy is relatively evenly distributed across the 3 types.**","7becd388":"**Observation: Most data points are in summer, followed by winter then spring. Least data points available in autuum.**","5b5eceec":"# Prediction Model 3 (using 10 features)\n\nIncluding in all 10 feature variables into the third prediction model to see if accuracy score can be improved:\n\n1) Air temperature (C)\n\n2) Air velocity (m\/s)\n\n3) Relative humidity (%)\n\n4) Clo\n\n5) Met \n\n6) Season \n\n7) Koppen climate classification \n\n8) Building type\n\n9) Cooling startegy_building level \n\n10) Outdoor monthly air temperature (C)","11680366":"Splitting dataset into training and testing set. We will be using 80% of dataset for training and 20% of dataset for testing:","ea0bdbc5":"For simplicity, rows with missing data were removed from the dataset:","5f45c557":"Using random forest classification algorithm:","86db6049":"**Observations: Difficult to determine if relative humidity on its own has significant impact on thermal comfort.**\n","586f1ccd":"# Dealing with missing data\n\nChecking for missing data in extracted dataset:","bfc83fc6":"**A summary on the type of information included in this dataset:**","84311b7c":"**Observation: Most data points for thermal comfort are within comfortable and very comfotable range (i.e. 5 & 6).**","1e7943b9":"# 1) Thermal comfort VS Air temperature (C):","90e1ea4d":"Checking accuracy:","1f477dc5":"**Observations: The lower the air velocity, the better the thermal comfort.**\n","778da32a":"For this study, we shall extact the following 10 feature variables which could have an impact on thermal comfort (target variable):\n\n1) Season\n\n2) Koppen climate classification\n\n3) Building type\n\n4) Cooling strategy building level\n\n5) Clo *\n\n6) Met *\n\n7) Air temperature (C) * \n\n8) Relative humidity (%) *\n\n9) Air velocity (m\/s) *\n\n10) Outdoor monthly air temperature\n\n(Factors with * are variables which are commonly found and attributed to thermal comfort models. The sixth variable, radiant temperature (C), was excluded from this study due to missing data which will affect the available size of dataset)","b5254a4e":"**Observation: Most common data points are for office building type.**","83388a90":"# Introduction\n\nThe generally accepted definition of thermal comfort according to ASHRAE is \"the condition of the mind that expresses satisfaction with the thermal environment\".\n\nThermal comfort is commonly attributed to the following 6 factors:\n\n![](https:\/\/www.pae-engineers.com\/system\/uploads\/fae\/image\/asset\/786\/1430x950_Human_Comfort.jpg)\n\nHowever, these factors can be subjective and may not always give accurate results. \n\nThe first part of this study will be to analyze the impact of variables affecitng thermal comfort using the dataset from ASHRAE Global Thermal Comfort Database II.\n\nThe second part of this study will be to determine which factors can help to create a better model for predicting thermal comfort. \n","203218c9":"# 3) Thermal comfort VS Air velocity (m\/s)\n\nAir velocities greater than 1.0 m\/s were removed as outliers in order to obtain a more accurate\/representative dataset:\n","61111fa0":"Converting 'object' data type to 'category':","07f1ba24":"# End","21761b88":"# 5) Thermal comfort VS Metabolic rate\n\nMetabolic rates greater than 3.0 were removed as outliers in order to obtain a more accurate\/representative dataset:","e4ffc515":"# PART 2 - CREATING A PREDICTION MODEL FOR THERMAL COMFORT","d6a43958":"# Part 1 - Exploratory Analysis of ASHRAE Global Thermal Comfort Database II\n\n**Loading of data from ASHRAE Global Thermal Comfort Database II:**","2ce3ad2e":"Final dataset to be used for creating a prediction model for thermal comfort:","613b0a90":"# 4) Thermal comfort VS Clothing insulation\n\nRounding of clothing insulation to 1 significant figure:","b2da9ec3":"Checking distribution of metabolic rate in dataset:","60b4ef3a":"Thermal comfort has been selected as the prediction target. Dataset will be divided into target variable (i.e. Thermal comfort) and feature variables. 3 different prediction models for thermal comfort will be explored using random forest classification algorithm.\n\n# Prediction Model 1 (using 5 features)\n\nThe following 5 common features in ASHRAE thermal comfort model will be used for the first prediction model:\n\n1) Air temperature (C)\n\n2) Air velocity (m\/s)\n\n3) Relative humidity (%)\n\n4) Clo\n\n5) Met\n","1ef399a4":"Using one hot encoding to use additional feature variables:","cd8e88c7":"# Thermal Comfort Analysis & Prediction Model\nBPS5229 Individual Assignment\nby Liu Renhao (A0111048W)","fef7468a":"**Observation: There is a slight decrease in accuracy when only 3 feature variables are used as compared to 5 feature variables in the first model.**","270d3aa1":"**Observation: There is an improvement in accuracy of thermal comfort prediction when more feature variables are included.**\n\nPrediction model 3 has the best results (i.e. highest accuracy) when using random forest classification algorithm. \n"}}