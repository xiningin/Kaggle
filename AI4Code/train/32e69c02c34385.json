{"cell_type":{"54b46e04":"code","4745fdc2":"code","5a8d6d8e":"code","9602dff0":"code","cb4d8435":"code","1b0635d3":"code","4a428c33":"code","ef26a16a":"code","8b2d1e11":"code","14d41f10":"code","7889b593":"code","f3633e6f":"code","eed9ffe0":"code","9eb2834e":"code","341c6450":"markdown","440a3c95":"markdown","3487d6ea":"markdown","f6479411":"markdown","f6512d78":"markdown","8393fe40":"markdown","e5fedb93":"markdown","2e5a9236":"markdown","67bbd794":"markdown","7000a5a9":"markdown","0853e7ab":"markdown","3ef7428f":"markdown","e68ff941":"markdown"},"source":{"54b46e04":"import os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","4745fdc2":"import pandas as pd","5a8d6d8e":"data_df = pd.read_csv(\"\/kaggle\/input\/research-development-expenditure-in-europe\/tsc00001.tsv\", sep='\\t')","9602dff0":"print(list(data_df.columns))","cb4d8435":"data_df.head()","1b0635d3":"data_df.tail()","4a428c33":"pivot_data_col = data_df.columns[0]\ngeo_columns = data_df.columns[1:]","ef26a16a":"data_df['unit'] = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[0])\ndata_df['sectperf'] = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[1])\ndata_df['geo'] = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[2])","8b2d1e11":"selected_columns = list(['unit', 'sectperf', 'geo']) +  list(geo_columns)\ndata_df = data_df[selected_columns]","14d41f10":"data_tr_df = data_df.melt(id_vars=['unit', 'sectperf', 'geo'], \n        var_name=\"year\", \n        value_name=\"value\")\ndata_tr_df['geo'] = data_tr_df['geo'].apply(lambda x: str(x))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"bp\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"b\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"u\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"d\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"p\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"e\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\": \", \"NAN\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: float(x))","7889b593":"print(f\"Transformed data shape: {data_tr_df.shape} (rows\/columns)\")\ndata_tr_df.head()","f3633e6f":"data_tr_df.tail()","eed9ffe0":"import pandas_profiling\npandas_profiling.ProfileReport(data_tr_df)","9eb2834e":"data_tr_df.to_csv(\"research_development_expenditure_eu.csv\", index=False)","341c6450":"# Introduction\n\nWe show in this Kernel how we can process the data to prepare it for easier processing. Let's check the data files.","440a3c95":"# Data pre-processing\n\nWe start by defining two working lists.","3487d6ea":"Next, we pivot the time columns using `melt` operation in pandas.  \nWe also make sure we transform `date` to be an integer (here is a year data).  \nWe set `value` to be a float, after we replace \": \" (for N\/A) with `NAN`.","f6479411":"# Export data in csv format","f6512d78":"The first column is a composed one, containing 3 different information (unit, sectperf - performance sector and geography\/time). The next columns are the yearly values.","8393fe40":"Let's glimpse the data columns.","e5fedb93":"Let's inspect the result.","2e5a9236":"## Load the data\n\nThe datafiles are in TSV format. We will read the files using pandas, just include in the function call the `sep` (tab separator data).\nWe demonstrate first how to read and process the Annual data.","67bbd794":"Let's also take a look to few of the rows.","7000a5a9":"We select now only the new columns resulted from splitting the `pivot_data_col` and the time columns.","0853e7ab":"Then, we split from `pivot_data_col` the 3 separate fields:\n* unit;\n* sectperf - performance sectors;\n* geo - geography - countries and group of countries from EU; ","3ef7428f":"# Analysis preparation\n\n## Load packages","e68ff941":"# A very preliminary exploratory data analysis\n\nThis would be a very short exploratory data analysis. The role of this Kernel is just to show how we can prepare the annual data for analysis and we already did this."}}