{"cell_type":{"2a923b40":"code","e8e0ebb4":"code","fbf9e34c":"code","245bae9d":"code","9d5fbbc6":"code","c37d0796":"code","a20117a0":"code","d53e37ab":"code","cdb3ff0f":"code","24882af8":"code","094bc58c":"code","1918189f":"code","2bbd1ca2":"code","f3109bc6":"code","08bc399c":"code","08fb4794":"code","5487613a":"code","ded9eace":"code","2edd227f":"markdown","8709999a":"markdown"},"source":{"2a923b40":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","e8e0ebb4":"df=pd.read_csv('..\/input\/Mall_Customers.csv')","fbf9e34c":"df.isnull().sum()","245bae9d":"df.describe()","9d5fbbc6":"df.columns","c37d0796":"from sklearn.cluster import KMeans","a20117a0":"df['Gender'].value_counts()","d53e37ab":" df.shape #200 records are there.","cdb3ff0f":"df.head()","24882af8":"df1=df.loc[:,'Annual Income (k$)':'Spending Score (1-100)']","094bc58c":"import seaborn as sns\nsns.pairplot(df1,diag_kind='kde')","1918189f":"from scipy.stats import zscore\ndf1=df1.apply(zscore)","2bbd1ca2":"Model=KMeans(n_clusters=3)\nModel","f3109bc6":"df1=pd.DataFrame(df1)\nModel.fit(df1)\nModel.inertia_","08bc399c":"cluster_error=[]\nfor i in range(1,15):\n    Model=KMeans(n_clusters=i,n_init=10)\n    Model=Model.fit(df1)\n    labels=Model.labels_\n    centroids=Model.cluster_centers_\n    cluster_error.append(Model.inertia_)\nclusters_df=pd.DataFrame({'n_cluster':range(1,15),'error':cluster_error})\nclusters_df\n    \n    ","08fb4794":"#Knee Plot \nimport matplotlib.pyplot as plt\nplt.plot(clusters_df.n_cluster,clusters_df.error,marker='o')","5487613a":"model=KMeans(n_clusters=6,n_init=15)\nmodel.fit(df1)\ncentroids=model.cluster_centers_","ded9eace":"x=pd.DataFrame(centroids,columns=list(df1))\nx","2edd227f":"We need to see which peaks are predominant in kde so that we can get an idea of optimum k value.\nAbout 3 clusters can be seen in kde of spending score.","8709999a":"The  elbow plot we saw k=6 is optimum.So 6 clusters are formed. Thus, we conclude that category 3 has good annual income and still spendind score is really low. So we need to focus on this category alot. "}}