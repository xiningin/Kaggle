{"cell_type":{"72842587":"code","0bbc8584":"code","3312e569":"code","d13a7da4":"code","93cb2eae":"code","04c2dc1c":"code","b5835564":"code","b9b5e798":"code","17af8098":"code","c13aeae3":"code","324ef2ce":"code","897f2364":"code","fe2eb92f":"code","36d429d9":"code","39d2d549":"code","86ff1559":"code","2064f01e":"code","9267a0fc":"code","978ee902":"code","611a1896":"code","68abd4f5":"markdown","9a86c2e2":"markdown","0bb1db18":"markdown","605e613a":"markdown","0f6bca1d":"markdown"},"source":{"72842587":"import pandas as pd\nimport numpy as np\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.ensemble import GradientBoostingRegressor\nfrom sklearn.preprocessing import OneHotEncoder\nfrom sklearn.compose import ColumnTransformer, make_column_transformer\nfrom sklearn.pipeline import Pipeline","0bbc8584":"train_data = pd.read_csv('\/kaggle\/input\/machine-learning-lab-cas-data-science-fs-20\/houses_train.csv', index_col=0)","3312e569":"X_data = train_data.drop(columns='price')\ny_data = train_data['price']","d13a7da4":"X_train, X_dev, y_train, y_dev = train_test_split(X_data, y_data, stratify=X_data['object_type_name'], test_size=0.1)","93cb2eae":"pipeline = Pipeline([\n    ('pre', make_column_transformer((OneHotEncoder(handle_unknown='ignore'), ['zipcode', 'municipality_name', 'object_type_name']), remainder='passthrough')),\n    ('clf', GradientBoostingRegressor())\n])","04c2dc1c":"from sklearn.model_selection import GridSearchCV","b5835564":"parameters = {\n    'clf__n_estimators': [10,50,100,200],\n    'clf__max_depth': [2,3,5],\n}\ngrid_search = GridSearchCV(pipeline, parameters, n_jobs=-1)","b9b5e798":"grid_search.fit(X_train, y_train)","17af8098":"grid_search.cv_results_","c13aeae3":"grid_search.best_params_","324ef2ce":"pipeline = grid_search.best_estimator_","897f2364":"y_dev_pred = pipeline.predict(X_dev)","fe2eb92f":"def mean_absolute_percentage_error(y_true, y_pred): \n    return np.mean(np.abs((y_true - y_pred) \/ y_true)) * 100","36d429d9":"mean_absolute_percentage_error(y_dev, y_dev_pred)","39d2d549":"pipeline.fit(X_data, y_data)","86ff1559":"X_test = pd.read_csv('\/kaggle\/input\/machine-learning-lab-cas-data-science-fs-20\/houses_test.csv', index_col=0)","2064f01e":"y_test_pred = pipeline.predict(X_test)","9267a0fc":"X_test_submission = pd.DataFrame(index=X_test.index)","978ee902":"X_test_submission['price'] = y_test_pred","611a1896":"X_test_submission.to_csv('gradient_boosting_submission.csv', header=True, index_label='id')","68abd4f5":"# Predict prices for test set","9a86c2e2":"# define and train model","0bb1db18":"# prepare data","605e613a":"# Train with all data","0f6bca1d":"# Predict and evaluate prices for dev set"}}