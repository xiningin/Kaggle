{"cell_type":{"a242929c":"code","9e5a0556":"code","82e1dd20":"code","415cd72f":"code","6dabb459":"code","33980cab":"code","2cf1250f":"code","327f2a3c":"code","438017f7":"markdown","5b3b56be":"markdown","065042ec":"markdown","76a31a53":"markdown"},"source":{"a242929c":"import os\n\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n\npd.set_option('display.max_columns', None)\nplt.rcParams['figure.figsize'] = [8, 8]\nplt.style.use('ggplot')","9e5a0556":"%%time\n\ntrain = pd.read_pickle('..\/input\/ubiquant-market-prediction-half-precision-pickle\/train.pkl')\ntrain.head()","82e1dd20":"train['investment_id'].value_counts().plot.hist(bins=50);","415cd72f":"some_investment_ids = train['investment_id'].value_counts().index[:10].tolist()\nprint(some_investment_ids)","6dabb459":"train_subset = train[train['investment_id'].isin(some_investment_ids)].reset_index(drop=True).copy()\ntrain_subset","33980cab":"def plot_cumulated_values(investment_id, features, ax):\n    investment_series = train_subset[train_subset['investment_id'] == investment_id]\n    for col in features:\n        ax.plot(investment_series[col].cumsum(), label=col)\n    ax.plot(investment_series['target'].cumsum(), linewidth=5, linestyle='dashed', label='target')\n    ax.set_title(f'investiment_id = {investment_id}\\nLength = {len(investment_series)}')\n    ax.legend();","2cf1250f":"fig, ax = plt.subplots(ncols=3, figsize=(20, 10))\n\nplot_cumulated_values(\n    investment_id=194,\n    features=[f'f_{i}' for i in range(10)],\n    ax=ax[0]\n)\n\nplot_cumulated_values(\n    investment_id=509,\n    features=[f'f_{i}' for i in range(10)],\n    ax=ax[1]\n)\n\nplot_cumulated_values(\n    investment_id=1062,\n    features=[f'f_{i}' for i in range(10)],\n    ax=ax[2]\n)","327f2a3c":"fig, ax = plt.subplots(ncols=3, figsize=(20, 10))\n\nplot_cumulated_values(\n    investment_id=2140,\n    features=[f'f_{i}' for i in range(10)],\n    ax=ax[0]\n)\n\nplot_cumulated_values(\n    investment_id=2385,\n    features=[f'f_{i}' for i in range(10)],\n    ax=ax[1]\n)\n\nplot_cumulated_values(\n    investment_id=1144,\n    features=[f'f_{i}' for i in range(10)],\n    ax=ax[2]\n)","438017f7":"## Selecting some investments ","5b3b56be":"Most of the investments has ~1200 time ids","065042ec":"## Checking cumulated series","76a31a53":"## EDA cumulated series\n\nPlotting some cumulated values to check the relation between cumulated target and cumulated features.   \n\nWork In Progress :) "}}