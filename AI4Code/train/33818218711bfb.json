{"cell_type":{"3514a1ef":"code","ab4c9394":"code","a71e8b3a":"code","32cbc90c":"code","1cc03694":"code","c463484a":"code","a596f76f":"code","4319f5ec":"code","be5a9955":"code","dbcbfad2":"code","424ac699":"code","3bee6578":"code","9a73f11a":"code","7a3eb5ba":"code","3278ba51":"code","53f6f28a":"markdown","65262c45":"markdown","a9b6bd89":"markdown","f32fa3eb":"markdown","a0fb9e3c":"markdown","d25eae40":"markdown","d031d223":"markdown","3e2b9e43":"markdown"},"source":{"3514a1ef":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nfrom scipy.stats import norm\n%matplotlib inline\nimport matplotlib.pyplot as plt\nimport time\nimport warnings\nwarnings.simplefilter('ignore')\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","ab4c9394":"train=pd.read_csv('\/kaggle\/input\/allstate-claims-severity\/train.csv', index_col='id')\ntest=pd.read_csv('\/kaggle\/input\/allstate-claims-severity\/test.csv', index_col='id')\nsubmission=pd.read_csv('\/kaggle\/input\/allstate-claims-severity\/sample_submission.csv', index_col='id')\nprint(train.shape, test.shape, submission.shape)","a71e8b3a":"figure, (ax1, ax2) = plt.subplots(nrows=1, ncols=2)\nfigure.set_size_inches(14,6)\nsns.distplot(train['loss'], fit=norm, ax=ax1)\nsns.distplot(np.log(train['loss']+1), fit=norm, ax=ax2)","32cbc90c":"train=train.drop(train.loc[train['loss']>40000].index)","1cc03694":"train['loss']=np.log(train['loss']+1)\nYtrain=train['loss']","c463484a":"data=train\ntrain=train[list(test)]\nall_data=pd.concat((train, test))\nall_data.shape","a596f76f":"cat_features=list(np.where(all_data.dtypes==np.object)[0])\nprint(cat_features)","4319f5ec":"from sklearn.preprocessing import LabelEncoder\nle=LabelEncoder()\nnon_numeric=list(all_data.select_dtypes(np.object))\nfor cols in non_numeric:\n    le.fit(all_data[cols])\n    all_data[cols]=le.transform(all_data[cols])","be5a9955":"print(train.shape, test.shape)\nXtrain=all_data[:len(train)]\nXtest=all_data[len(train):]\nprint(Xtrain.shape, Ytrain.shape, Xtest.shape, submission.shape)","dbcbfad2":"from catboost import CatBoostRegressor\nfrom xgboost import XGBRegressor\nfrom lightgbm import LGBMRegressor\n#import optuna\nfrom sklearn.model_selection import cross_val_score","424ac699":"model_xgb=XGBRegressor(tree_method='gpu_hist', seed=18, objective='reg:linear', n_jobs=-1, verbosity=0,\n                       colsample_bylevel=0.764115402027029, colsample_bynode=0.29243734009596956, \n                       colsample_bytree= 0.7095719673041723, gamma= 4.127534050725986, learning_rate= 0.02387231810322894, \n                       max_depth=14, min_child_weight=135, n_estimators=828,reg_alpha=0.3170105723222332, \n                       reg_lambda= 0.3660379465131937, subsample=0.611471430211575)\nmodel_xgb","3bee6578":"model_LGB=LGBMRegressor(objective='regression_l1', random_state=18, subsample_freq=1,\n                        colsample_bytree=0.3261853512759363, min_child_samples=221, n_estimators=2151, num_leaves= 45, \n                        reg_alpha=0.9113713668943361, reg_lambda=0.8220990333713991, subsample=0.49969995651550947, \n                        max_bin=202, learning_rate=0.02959820893211799) #,device='gpu')\nmodel_LGB","9a73f11a":"model_Cat=CatBoostRegressor(loss_function='MAE', random_seed=18, task_type='GPU', cat_features=cat_features, verbose=False,\n                            iterations=2681, learning_rate=0.2127106032536721, depth=7, l2_leaf_reg=5.266150673910493, \n                            random_strength=7.3001140226199315, bagging_temperature=0.26098669708900213)\nmodel_Cat","7a3eb5ba":"model_Cat.fit(Xtrain, Ytrain)\nmodel_LGB.fit(Xtrain, Ytrain)\nmodel_xgb.fit(Xtrain, Ytrain)\n\nlgb_predictions=model_LGB.predict(Xtest)\ncat_predictions=model_Cat.predict(Xtest)\nxgb_predictions=model_xgb.predict(Xtest)","3278ba51":"predictions=(lgb_predictions + cat_predictions + xgb_predictions)\/3\n\npredictions=np.exp(predictions)-1\nsubmission['loss']=predictions\nsubmission.to_csv('Result.csv')\nsubmission.head()","53f6f28a":"# Target Variable","65262c45":"# Build Models","a9b6bd89":"## LightGBM","f32fa3eb":"# Final Fit & Predict","a0fb9e3c":"## XGBoost","d25eae40":"# Load Data","d031d223":"# Preprocessing","3e2b9e43":"## CatBoost"}}