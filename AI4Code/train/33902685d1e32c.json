{"cell_type":{"a56b6933":"code","30975a72":"code","b7d5aa52":"code","8944acc6":"code","f7499286":"code","2d36c08f":"code","83c7489e":"code","6429037b":"code","4c33f798":"code","e4f63873":"code","f11cfac4":"code","0a330db3":"code","7bc8f9eb":"code","4a7b31fb":"code","d525defe":"code","2a2f6a46":"code","2c73c055":"code","f5472473":"code","64b17322":"code","2852c322":"code","8682d15e":"code","0f79760f":"code","d14e9863":"markdown","82c61f72":"markdown"},"source":{"a56b6933":"pip install pomegranate","30975a72":"pip install graphviz","b7d5aa52":"pip install libgraphviz-dev","8944acc6":"pip install cgraph","f7499286":"pip install pydot","2d36c08f":"pip install libcgraph","83c7489e":"pip install pydotplus","6429037b":"conda install pygraphviz","4c33f798":"pip install networkx","e4f63873":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nfrom sklearn.model_selection import train_test_split, KFold\nfrom sklearn.preprocessing import OneHotEncoder, LabelEncoder, OrdinalEncoder, StandardScaler, Normalizer\nfrom sklearn.naive_bayes import GaussianNB\nfrom sklearn import metrics\nimport seaborn as sns\nfrom IPython.core.display import Image\nimport matplotlib.pyplot as plt\nfrom pomegranate import *\nfrom tqdm import tqdm\nimport graphviz\nimport pydotplus\nimport pygraphviz\nimport networkx as nx\n\nsns.set(color_codes=True)\nsns.set(rc={'figure.figsize':(5,5)})\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","f11cfac4":"# Assigning a name to the dataframe\noasis_longitudinal = pd.read_csv(\"..\/input\/mri-and-alzheimers\/oasis_longitudinal.csv\")","0a330db3":"# Looking at the first 5 rows of the dataframe\nprint(\"Longitudinal MRI Data in Nondemented and Demented Older Adults\")\noasis_longitudinal.head()","7bc8f9eb":"# Dropping rows containing NaN values as the Chow-Liu algorithm does not support NaN's and checking a few features for dimentionality\n\noasis_longitudinal = oasis_longitudinal.dropna()\n\nprint(oasis_longitudinal['Hand'].value_counts())\nprint(oasis_longitudinal['M\/F'].value_counts())\nprint(oasis_longitudinal['SES'].value_counts())","4a7b31fb":"oasis_longitudinal.dtypes","d525defe":"# Dropping unnecessary columns\nX = oasis_longitudinal.drop(['Subject ID', 'MRI ID', 'Hand'], axis=1)\ny = oasis_longitudinal['Group']\n\n# Encoding categorical columns\nle_group = LabelEncoder()\nle_mf = LabelEncoder()\n\nX['Group'] = le_group.fit_transform(X['Group'])\nX['M\/F'] = le_mf.fit_transform(X['M\/F'])\n\n# Normalizing columns with large ranges\ncols_to_norm = [\"MR Delay\", \"eTIV\", \"ASF\"]\nX[cols_to_norm] = Normalizer().fit_transform(X[cols_to_norm])\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.2, random_state = 0)","2a2f6a46":"X","2c73c055":"X_train","f5472473":"X_test","64b17322":"# Naming the nodes of the DAG\nstate_names = [\"Group\", \"Visit\", \"MR Delay\", \"Male \/ Female\", \"Age\", \"EDUC\", \"SES\", \"MMSE\", \"CDR\", \"eTIV\", \"nWBV\", \"ASF\"]\n\n# Generating a Chow-Liu BN from the dataset\nmodel_chow_liu = BayesianNetwork.from_samples(X_train, algorithm='chow-liu', state_names=state_names, name=\"Chow-Liu Bayesian Network DAG\", pseudocount=0.1)","2852c322":"# Plotting the DAG\nplt.figure(figsize=(16,8))\nmodel_chow_liu.plot()","8682d15e":"# 1 = Male\n# 0 = Female\n\n# Testing what diagnosis individual 9 most likely has\n\n# The following are the observed conditions\/ stats about the individual:\nobservations = {\"Visit\": 3,\n                \"Male \/ Female\": 1,\n                \"Age\": 85,\n                \"EDUC\": 12,\n                \"SES\": 4.0,\n                \"MMSE\": 30.0,\n                \"CDR\": 0.0,\n                \"nWBV\": 0.705}\n\n# Using the learned BN algorithm, the probability of being diagnosed with Dimentia is given, along with other features\nbeliefs = map( str, model_chow_liu.predict_proba( observations ) )\nprint (\"\\n\".join( \"{}\\t\\t{}\".format( state.name, belief ) for state, belief in zip( model_chow_liu.states, beliefs ) ))\n\n# 2 = Nondemented\n# 1 = Demented\n# 0 = Converted : subjects were characterized as nondemented at the time of their initial visit and were subsequently characterized as demented at a later visit.","0f79760f":"# 1 = Male\n# 0 = Female\n\n# Testing what diagnosis individual 148 most likely has\n\n# The following are the observed conditions\/ stats about the individual:\nobservations = {\"Visit\": 2, \n                \"Male \/ Female\": 0,\n                \"Age\": 82,\n                \"EDUC\": 18,\n                \"SES\": 2.0,\n                \"MMSE\": 30.0,\n                \"CDR\": 0.0,\n                \"nWBV\": 0.690,\n               }\n\n# Using the learned BN algorithm, the probability of being diagnosed with Dimentia is given, along with other features\nbeliefs = map( str, model_chow_liu.predict_proba( observations ) )\nprint (\"\\n\".join( \"{}\\t\\t{}\".format( state.name, belief ) for state, belief in zip( model_chow_liu.states, beliefs ) ))\n\n# 2 = Nondemented\n# 1 = Demented\n# 0 = Converted : subjects were characterized as nondemented at the time of their initial visit and were subsequently characterized as demented at a later visit.","d14e9863":"Individual 148 has the highest chance of being nondemented at ~97%","82c61f72":"Individual 9 has the highest chance of being nondemented at ~78%"}}