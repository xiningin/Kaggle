{"cell_type":{"aed6bd5a":"code","a4cf180d":"code","db799afb":"code","47cb5b2e":"code","26a1e93b":"code","ab9e181b":"code","615e9765":"code","23040385":"code","d1112449":"code","614ee1b9":"code","8d6d137b":"code","7879abf6":"code","9e4605eb":"code","d2235ffb":"code","c4c1548c":"code","5f607f52":"code","d1ef140a":"markdown","02ccee89":"markdown","ebdbf7a1":"markdown","e212b849":"markdown","4fef91a9":"markdown"},"source":{"aed6bd5a":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nfrom sklearn.metrics import mean_squared_error\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.model_selection import cross_val_score, train_test_split, GridSearchCV\n\nfrom sklearn.neural_network import MLPRegressor","a4cf180d":"train_data = pd.read_csv(\"..\/input\/tabular-playground-series-aug-2021\/train.csv\")\nvalid_data = pd.read_csv(\"..\/input\/tabular-playground-series-aug-2021\/test.csv\")","db799afb":"train_data.drop('id', axis=1, inplace=True)\n\nX = train_data.drop('loss', axis=1)\ny = train_data['loss']","47cb5b2e":"ss = StandardScaler()\nX = ss.fit_transform(X)","26a1e93b":"X_train, X_test, y_train, y_test = train_test_split(\n    X, y, test_size=0.20, random_state=42)","ab9e181b":"valid_ids = valid_data['id']\nvalid_data = valid_data.drop('id',axis=1)","615e9765":"valid_data = ss.fit_transform(valid_data)","23040385":"import multiprocessing\nn_jobs = multiprocessing.cpu_count()-1\nn_jobs","d1112449":"mlp = MLPRegressor()\nparam_grid = {'hidden_layer_sizes': [i for i in range(2,20)],\n              'activation': ['relu'],\n              'solver': ['adam'],\n              'learning_rate': ['constant'],\n              'learning_rate_init': [0.01],\n              'power_t': [0.5],\n              'alpha': [0.0001],\n              'max_iter': [1000],\n              'early_stopping': [True],\n              'warm_start': [False]}\nmlp_GS = GridSearchCV(mlp, param_grid=param_grid, \n                   cv=10, verbose=True, pre_dispatch='2*n_jobs', n_jobs=n_jobs)","614ee1b9":"mlp_GS.fit(X_train, y_train)","8d6d137b":"p_hat = mlp_GS.predict(X_train)","7879abf6":"mean_squared_error(y_train, p_hat, squared=False)","9e4605eb":"sample_sub = pd.read_csv(\"..\/input\/tabular-playground-series-aug-2021\/sample_submission.csv\")","d2235ffb":"valid_loss = mlp_GS.predict(valid_data)","c4c1548c":"sample_sub.loss = valid_loss","5f607f52":"sample_sub.to_csv('mlp_loss.csv', index=False)","d1ef140a":"## Conclusion","02ccee89":"## Training the model and Tuning it with GridSearchCV","ebdbf7a1":"## Making Predictions and Exporting Results","e212b849":"## Doing Imports and Preprocessing","4fef91a9":"No. The Neural Network based `MLPRegressor` scorred signifcantly lower than the `XGBoost`, as I have done in [this notebook](https:\/\/www.kaggle.com\/hrbukhari\/optuna-tuned-boosting-models-cat-xgb)."}}