{"cell_type":{"6a58fd87":"code","b3895349":"code","f948500d":"code","184e53c5":"code","2f9e2172":"code","81649d40":"code","174fa6c1":"code","c30aa6e5":"code","83d80c13":"code","826b8df2":"code","4b73cda7":"code","7bb28a59":"code","924dbac5":"code","5e601094":"code","a935c6b4":"code","a2981a99":"code","bf62abc4":"markdown","ac5cd384":"markdown","e161743f":"markdown","848bebf0":"markdown","96556e1e":"markdown","35c4bdf0":"markdown","27b601f4":"markdown","fb8f53f9":"markdown","50778f69":"markdown","edb5ddb5":"markdown","9048f968":"markdown","51ea9306":"markdown","bb7dc791":"markdown"},"source":{"6a58fd87":"import pandas as pd\nimport numpy as np \nimport re\nimport nltk\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.naive_bayes import GaussianNB\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.metrics import confusion_matrix\nimport scikitplot as skplt\nfrom sklearn.linear_model import LogisticRegression","b3895349":"df=pd.read_csv('..\/input\/restaurant-reviews\/Restaurant_Reviews.csv')\ndf.head()","f948500d":"from nltk.corpus import stopwords\n\n# xyz is a list consisting of English Stopwords\nxyz=stopwords.words('english') \nxyz.remove('not')","184e53c5":"from nltk.stem.porter import PorterStemmer\nps=PorterStemmer()","2f9e2172":"corpus=[]\n\nfor i in range(len(df)):\n    review=re.sub('[^a-zA-Z]',' ',df.iloc[i,0]) # Removing punctuations\n    review=review.lower() # Converting to lower case.\n    review=review.split() # List of words in a review.\n    ps=PorterStemmer() # Stemming Words\n    review=[ps.stem(word) for word in review if not word in set(xyz)] #Stemming words those are not in list xyz i.e list of stopping words\n    review=' '.join(review)\n    corpus.append(review)\n    ","81649d40":"original=list(df.Review)\noriginal[:10]","174fa6c1":"corpus[0:10]","c30aa6e5":"from sklearn.feature_extraction.text import CountVectorizer\ncv = CountVectorizer()\nno_of_words=cv.fit_transform(corpus).toarray()\nlen(no_of_words[0])","83d80c13":"cv = CountVectorizer(max_features = 1500)\nX = cv.fit_transform(corpus).toarray()\ny = df.iloc[:, 1].values","826b8df2":"X_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.2)","4b73cda7":"classifier = GaussianNB()\nclassifier.fit(X_train, y_train)\nprint('Test Score : {} %'.format(classifier.score(X_test,y_test)*100))","7bb28a59":"cross_val_score(classifier,X_train,y_train,cv=10).mean()*100","924dbac5":"skplt.metrics.plot_confusion_matrix(y_test,classifier.predict(X_test),figsize=(8,8))","5e601094":"logistic_classifier=LogisticRegression()\nlogistic_classifier.fit(X_train,y_train)\nprint('Test Score : {} %'.format(logistic_classifier.score(X_test,y_test)*100))","a935c6b4":"cross_val_score(logistic_classifier,X_train,y_train,cv=10).mean()*100","a2981a99":"skplt.metrics.plot_confusion_matrix(y_test,logistic_classifier.predict(X_test),figsize=(8,8))","bf62abc4":"## Applying Stemming, Removing Stopwords and Punctuations from Reviews","ac5cd384":"## Cleaning Data","e161743f":"## Naive Bayes Classifier","848bebf0":"## Removing Punctuation \n\nWe can remove punctuation with the help of re librarry","96556e1e":"## Stemming\nSame words might be present in different forms in reviews.\nConsider this example:\n1. I Loved the food.\n2. I love the food.\n\nMeaning of both the senteance is same.So it's better to stem the words rather than filling the sparse matrix with every form of the word. ","35c4bdf0":"## Original Reviews vs Transformed Ones.\nLet's See how the reviews look after cleaning process.","27b601f4":"## Cross Val Score for Logistic Regression","fb8f53f9":"## Stop Words\nWords such as ('the' , 'is' , 'are' , 'at' , 'a' , 'an' , 'on' ) doesn't convey any meaningful information regarding reviews.\nSo it's better to remove all these words from reviews.It will also reduce the size of our sparse Matrix.","50778f69":"So we have 1566 different words in corpus list.But some of them might occur only once such as name of secific dish etc.\nSo we can take 1500 words for creating our bag of words.","edb5ddb5":"## Cross Val Score of Naive Bayes","9048f968":"## Logistic Regression","51ea9306":"## Creating Bag of Words\n\nHow many words should be have in our bag ? Let's see total number of different words in corpus list.","bb7dc791":"## Splitting Training and Test Set"}}