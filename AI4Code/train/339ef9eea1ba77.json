{"cell_type":{"0a5bdcda":"code","7cf11c36":"code","6f3258f9":"code","07383f87":"code","2553b478":"code","a2ed1409":"code","024e5d33":"code","a23826c0":"code","d5913ecd":"code","2422bca3":"code","0681bdd2":"code","20d93896":"code","55c80883":"code","03d334a6":"code","3248de01":"code","c859b043":"code","e3346235":"code","8a75980f":"markdown","1eb1fe95":"markdown","aecc9f1e":"markdown","1b2993c9":"markdown","4610ed3e":"markdown","61d43303":"markdown","21201335":"markdown","e84a540e":"markdown","46a267a3":"markdown","b382c739":"markdown","7c7d7950":"markdown","db3ce75e":"markdown","32a5e819":"markdown","7d2eec95":"markdown","180beafb":"markdown","51091dac":"markdown","2cc78026":"markdown","236546d8":"markdown","bc21d9d3":"markdown","f56dbe50":"markdown","6f4780d1":"markdown","23074564":"markdown","9234898c":"markdown"},"source":{"0a5bdcda":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import OneHotEncoder\nfrom sklearn.compose import ColumnTransformer\nfrom sklearn.metrics import accuracy_score","7cf11c36":"stars = pd.read_csv(\"..\/input\/star-dataset\/6 class csv.csv\")\nstars","6f3258f9":"stars.info()","07383f87":"stars.isna().sum()","2553b478":"fig , ax = plt.subplots(figsize = (13,10))\n\nR = stars[stars[\"Star type\"] == 0]\nB = stars[stars[\"Star type\"] == 1]\nW = stars[stars[\"Star type\"] == 2]\nM = stars[stars[\"Star type\"] == 3]\nS = stars[stars[\"Star type\"] == 4]\nH = stars[stars[\"Star type\"] == 5]\n\nax.scatter(np.log(R[\"Temperature (K)\"]), np.log(R[\"Luminosity(L\/Lo)\"]),5, label = 'Red dwarfs')\nax.scatter(np.log(B[\"Temperature (K)\"]), np.log(B[\"Luminosity(L\/Lo)\"]),7, label = 'Brown dwarfs')\nax.scatter(np.log(W[\"Temperature (K)\"]), np.log(W[\"Luminosity(L\/Lo)\"]),10, label = 'White dwarfs')\nax.scatter(np.log(M[\"Temperature (K)\"]), np.log(M[\"Luminosity(L\/Lo)\"]),15, label = 'Main sequence stars')\nax.scatter(np.log(S[\"Temperature (K)\"]), np.log(S[\"Luminosity(L\/Lo)\"]),30, label = 'Supergiants')\nax.scatter(np.log(H[\"Temperature (K)\"]), np.log(H[\"Luminosity(L\/Lo)\"]),50, label = 'Hypergiants')\n\nax.invert_xaxis()\nax.legend()\nplt.xlabel(\"Log Temperature\")\nplt.ylabel(\"Log Luminosity\")\nax.grid()\nax.set_facecolor(\"black\")","a2ed1409":"stars = stars.sample(frac=1) # shuffle the data","024e5d33":"x = stars.drop(\"Star type\", axis=1)\ny = stars[\"Star type\"]","a23826c0":"categorical_features = [\"Spectral Class\",\"Star color\"]\none_hot = OneHotEncoder()\ntransformer = ColumnTransformer([(\"one_hot\",\n                                 one_hot,\n                                 categorical_features)],\n                                remainder = \"passthrough\")\ntransformed_x = transformer.fit_transform(stars)\ntransformed_x ","d5913ecd":"x_train , x_test , y_train , y_test = train_test_split(transformed_x,y,test_size=0.2)","2422bca3":"x_train","0681bdd2":"model = RandomForestClassifier()\nmodel.fit(x_train,y_train)","20d93896":"model.score(x_train,y_train)","55c80883":"x_test","03d334a6":"y_preds = model.predict(x_test)","3248de01":"y_preds","c859b043":"y_test","e3346235":"print(model.score(x_test,y_preds))","8a75980f":"Random forest model","1eb1fe95":"Dividing the dataset into train and test data","aecc9f1e":"## Size\nStars on the basis of their size have been classified into the following main categories :\n1. Red Dwarf\n2. White Dwarf\n3. Brown Dwarf\n4. Main Sequence\n5. Supergiants\n6. Hypergiants\n\nAll these categories have their special place in the Hertzsprung Russell diagram which compares temperature and luminoscity of these stars.","1b2993c9":"### Answer to the question : Our sun is a G star, so it is evidently not even close to the hottest stars in the universe !","4610ed3e":"We got a perfect score on our train data, now let's predict the outcome using test data","61d43303":"# Modelling\nAfter some playing around with the subject and exploring the different aspects of the data , we can finally come up with model to train the data on.","21201335":"Checking for missing values","e84a540e":"## Importing the tools","46a267a3":"### As one can see , our Random Forest model correctly predicted the star types of all stars on the test dataset.","b382c739":"## Loading the star data","7c7d7950":"## Spectral class\nSpectral class of a star is the measure of amount of energy radiated by it . The series goes in decreasing order from \"O\" class (hottest) to \"M\" (coolest).<br>\nO > B > A > F > G > K > M\nThere is a good way to remember it -> O Be A Fine Gal Kiss Me (just for fun (; )","db3ce75e":"Let's check the score of our model on test dataset","32a5e819":"Thankyou for visiting this notebook. An upvote would be appreciated if you liked it.<br>\nAlso check out all of my notebooks :\n\n1. Titanic survival prediction using sklearn pipeline : https:\/\/www.kaggle.com\/rambomind\/titanic-predictions-using-sklearn-pipeline\n\n2. Heart disease classification using gridsearch CV : https:\/\/www.kaggle.com\/rambomind\/heart-disease-classification\n\n3. Dog breed identification using tranfer learning : https:\/\/www.kaggle.com\/rambomind\/dog-breed-id-using-mobilenet-v2-130-224\n\n4. Drinking water potability : https:\/\/www.kaggle.com\/rambomind\/drinking-water-potability\n\n5. Bulldozer price prediction : https:\/\/www.kaggle.com\/rambomind\/bulldozer-price-prediction\n\n\n","7d2eec95":"Other common parameters that will be used in this notebook are :\n* Absolute Temperature (in K)\n* Relative Luminosity (L\/Lo)\n* Relative Radius (R\/Ro)\n* Absolute Magnitude (Mv)\n* Star Color (white,Red,Blue,Yellow,yellow-orange etc)\n\nNow let's start the preparation of our EDA on the given dataset","180beafb":"![image.png](attachment:03652063-ee25-4bfa-983c-3d0ce84e2f91.png)","51091dac":"That looks supercool ! Compare this to the image of the hertzsprung russell diagram attached in the notebook above . Can you see the similarity ?","2cc78026":"# Star type prediction\n\nIn this notebook , exploratory data analysis has been done on the star dataset and then star type has been predicted using Random Forest Classifier.<br>\nThe data for this notebook as been taken from https:\/\/www.kaggle.com\/deepu1109\/star-dataset\n<br>\n<br>\n**If you like this notebook, kindly consider giving it an upvote**\n<br>\n<br>\n\n\nBefore we get into the exploratory analyis , let's have a look at the type of stars based on different categories...\n\n","236546d8":"Perfect ! There are no missing values","bc21d9d3":"![image.png](attachment:13cf7860-0aa5-450d-8851-fa477d4914a4.png)","f56dbe50":"## Quick Question : Do you know what is the spectral class of our sun ?<br>\n## Answer at the end of the notebook.","6f4780d1":"Converting categorical data into numerical data for usage","23074564":"## Predicting....","9234898c":"## Creating our own Hertzsprung Russell Diagram"}}