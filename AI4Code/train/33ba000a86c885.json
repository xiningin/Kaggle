{"cell_type":{"1a246b31":"code","9ce6820a":"code","33102aa1":"code","ca5ffb09":"code","79dd9d88":"code","06ffa1de":"code","58a57980":"code","b225cacf":"code","281fb462":"code","f73e4c60":"code","d80a86a4":"code","f3ca03ee":"code","bdd70adb":"code","97e7e6bd":"code","f107d911":"code","17847c17":"code","4622bcaf":"code","dd4cea31":"code","d45896c6":"code","8b310c82":"code","ecfe2042":"code","32239470":"code","f96f9d5d":"code","dfe192cb":"code","0e14e3c3":"code","dbd9b007":"code","ef68942b":"code","1e97ce91":"code","42dea686":"code","e3dad156":"code","a884c05f":"code","479b81f1":"code","9536c2e3":"code","4f88aba4":"code","723ce3e7":"code","ebb1a95c":"code","c9698a8f":"code","48de636c":"code","53e5aef1":"code","1a2b6496":"code","668a1ee6":"code","758b7446":"markdown","537345a2":"markdown","11d90f55":"markdown","1cd08a69":"markdown","b9c49e9d":"markdown","05b765b8":"markdown","5a9922b4":"markdown","b5e6300c":"markdown","168f93ca":"markdown","487c1d4e":"markdown","537d7530":"markdown","ea2decc2":"markdown"},"source":{"1a246b31":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot\nfrom sklearn.metrics import confusion_matrix, accuracy_score","9ce6820a":"msh_df = pd.read_csv('..\/input\/mushroom-classification\/mushrooms.csv')\nmsh_df.head(5)","33102aa1":"msh_df.columns","ca5ffb09":"from pandas_profiling import ProfileReport\nreport = ProfileReport(msh_df, title = 'Mushroom Dataset')#, explorative = True)\nreport.to_widgets()","79dd9d88":"msh_df = msh_df.drop(['veil-type', 'gill-attachment'], axis = 1)\nmsh_df.head(2)","06ffa1de":"msh_df.columns","58a57980":"cat_col = ['class', 'cap-shape', 'cap-surface', 'cap-color', 'bruises', 'odor',\n       'gill-spacing', 'gill-size', 'gill-color', 'stalk-shape', 'stalk-root',\n       'stalk-surface-above-ring', 'stalk-surface-below-ring',\n       'stalk-color-above-ring', 'stalk-color-below-ring', 'veil-color',\n       'ring-number', 'ring-type', 'spore-print-color', 'population',\n       'habitat']","b225cacf":"from sklearn.preprocessing import LabelEncoder\nle = LabelEncoder()","281fb462":"for x in cat_col:\n    msh_df[x] = le.fit_transform(msh_df[x])","f73e4c60":"msh_df.head()","d80a86a4":"x = msh_df.iloc[:, 1:]\nx.head()","f3ca03ee":"y = msh_df['class']\ny.head()","bdd70adb":"from sklearn.feature_selection import SelectKBest, chi2","97e7e6bd":"bst_features = SelectKBest(score_func = chi2, k = 20)\nfit = bst_features.fit(x, y)","f107d911":"dfscores = pd.DataFrame(fit.scores_)\ndfcolumns = pd.DataFrame(x.columns)","17847c17":"fscore = pd.concat([dfcolumns, dfscores], axis = 1)\nfscore.columns = ['Column', 'Score']\nfscore","4622bcaf":"print(fscore.nlargest(20, 'Score'))\n#higher the score highly the dependent variable is dependent on that variable","dd4cea31":"x_new = msh_df.iloc[:, 1:]\nx_new.head()","d45896c6":"y_new = msh_df['class']\ny_new.head()","8b310c82":"from sklearn.model_selection import train_test_split ","ecfe2042":"xtrain, xtest, ytrain, ytest = train_test_split(x_new, y_new, test_size = .2, random_state = 1)","32239470":"from sklearn.linear_model import LogisticRegression","f96f9d5d":"classifier = LogisticRegression(random_state = 1)\nclassifier.fit(xtrain, ytrain)","dfe192cb":"ypred = classifier.predict(xtest)\ncm = confusion_matrix(ytest, ypred)\nprint(cm)\naccuracy_score(ytest, ypred)","0e14e3c3":"from sklearn.neighbors import KNeighborsClassifier","dbd9b007":"classifier = KNeighborsClassifier(n_neighbors = 5, metric = 'minkowski', p = 2)\nclassifier.fit(xtrain, ytrain)","ef68942b":"ypred = classifier.predict(xtest)\ncm = confusion_matrix(ytest, ypred)\nprint(cm)\naccuracy_score(ytest, ypred)","1e97ce91":"from sklearn.svm import SVC","42dea686":"classifier = SVC(kernel = 'linear', random_state = 1)\nclassifier.fit(xtrain, ytrain)","e3dad156":"ypred = classifier.predict(xtest)\ncm = confusion_matrix(ytest, ypred)\nprint(cm)\naccuracy_score(ytest, ypred)","a884c05f":"classifier = SVC(kernel = 'rbf', random_state = 1)\nclassifier.fit(xtrain, ytrain)","479b81f1":"ypred = classifier.predict(xtest)\ncm = confusion_matrix(ytest, ypred)\nprint(cm)\naccuracy_score(ytest, ypred)","9536c2e3":"from sklearn.naive_bayes import GaussianNB","4f88aba4":"classifier = GaussianNB()\nclassifier.fit(xtrain, ytrain)","723ce3e7":"ypred = classifier.predict(xtest)\ncm = confusion_matrix(ytest, ypred)\nprint(cm)\naccuracy_score(ytest, ypred)","ebb1a95c":"from sklearn.tree import DecisionTreeClassifier","c9698a8f":"classifier = DecisionTreeClassifier(criterion = 'entropy', random_state = 1)\nclassifier.fit(xtrain, ytrain)","48de636c":"ypred = classifier.predict(xtest)\ncm = confusion_matrix(ytest, ypred)\nprint(cm)\naccuracy_score(ytest, ypred)","53e5aef1":"from sklearn.ensemble import RandomForestClassifier","1a2b6496":"classifier = RandomForestClassifier(n_estimators = 100, criterion = 'entropy', random_state = 1)\nclassifier.fit(xtrain, ytrain)","668a1ee6":"ypred = classifier.predict(xtest)\ncm = confusion_matrix(ytest, ypred)\nprint(cm)\naccuracy_score(ytest, ypred)","758b7446":"we will remove the following columns - \n1.veil type because it has a constant value\n2.gill attachment because it is highly corelate with stalk-surface-above-ring, stalk-surface-below-ring and veil color","537345a2":"# Kernel SVM","11d90f55":"# Handling Categorical Features","1cd08a69":"# Decision Tree","b9c49e9d":"# Logistic Regression","05b765b8":"# Feature Selection using Univariate Selection","5a9922b4":"# Random Forest Classifier","b5e6300c":"# KNN","168f93ca":"# Naive Bayes ","487c1d4e":"# SVM","537d7530":"Data contains;\nAttribute Information: (classes: edible=e, poisonous=p)\n\ncap-shape: bell=b,conical=c,convex=x,flat=f, knobbed=k,sunken=s\n\ncap-surface: fibrous=f,grooves=g,scaly=y,smooth=s\n\ncap-color: brown=n,buff=b,cinnamon=c,gray=g,green=r,pink=p,purple=u,red=e,white=w,yellow=y\n\nbruises: bruises=t,no=f\n\nodor: almond=a,anise=l,creosote=c,fishy=y,foul=f,musty=m,none=n,pungent=p,spicy=s\n\ngill-attachment: attached=a,descending=d,free=f,notched=n\n\ngill-spacing: close=c,crowded=w,distant=d\n\ngill-size: broad=b,narrow=n\n\ngill-color: black=k,brown=n,buff=b,chocolate=h,gray=g, green=r,orange=o,pink=p,purple=u,red=e,white=w,yellow=y\n\nstalk-shape: enlarging=e,tapering=t\n\nstalk-root: bulbous=b,club=c,cup=u,equal=e,rhizomorphs=z,rooted=r,missing=?\n\nstalk-surface-above-ring: fibrous=f,scaly=y,silky=k,smooth=s\n\nstalk-surface-below-ring: fibrous=f,scaly=y,silky=k,smooth=s\n\nstalk-color-above-ring: brown=n,buff=b,cinnamon=c,gray=g,orange=o,pink=p,red=e,white=w,yellow=y\n\nstalk-color-below-ring: brown=n,buff=b,cinnamon=c,gray=g,orange=o,pink=p,red=e,white=w,yellow=y\n\nveil-type: partial=p,universal=u\n\nveil-color: brown=n,orange=o,white=w,yellow=y\n\nring-number: none=n,one=o,two=t\n\nring-type: cobwebby=c,evanescent=e,flaring=f,large=l,none=n,pendant=p,sheathing=s,zone=z\n\nspore-print-color: black=k,brown=n,buff=b,chocolate=h,green=r,orange=o,purple=u,white=w,yellow=y\n\npopulation: abundant=a,clustered=c,numerous=n,scattered=s,several=v,solitary=y\n\nhabitat: grasses=g,leaves=l,meadows=m,paths=p,urban=u,waste=w,woods=d","ea2decc2":"# Splliting Independent and Dependent Features"}}