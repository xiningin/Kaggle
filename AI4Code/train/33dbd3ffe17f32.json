{"cell_type":{"2e968ece":"code","c9201dbf":"code","415f11cc":"code","04c02c43":"code","4e931a6f":"code","3c1d222f":"code","e2cd0ccf":"code","1c6290de":"markdown","1ee2db77":"markdown","c43569be":"markdown","550a4c94":"markdown"},"source":{"2e968ece":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n# import pyspark to work on spark\nfrom pyspark.sql import SparkSession\nspark = SparkSession.builder.appName('yelp_data_exploration').getOrCreate()\n# Any results you write to the current directory are saved as output.","c9201dbf":"#import yelp review data into dataframe\nyelp_review = spark.read.json('..\/input\/yelp_academic_dataset_review.json')\n# import yelp business data into dataframe\nyelp_business = spark.read.json('..\/input\/yelp_academic_dataset_business.json')\n# import yelp user data into dataframe\nyelp_user = spark.read.json('..\/input\/yelp_academic_dataset_user.json')\n# import yelp tip data into dataframe\n#yelp_tip = spark.read.json('..\/input\/yelp_academic_dataset_tip.json')\n# import yelp checkin data into dataframe\n#yelp_checkin = spark.read.json('..\/input\/yelp_academic_dataset_checkin.json')","415f11cc":"# now see top most reviewed business.\n# so take review data which has rating(stars) more than 3\nreview_star_three = yelp_review.filter('stars >3')\ngrouped_review = review_star_three.groupby('business_id').count()\nreview_sort = grouped_review.sort('count',ascending=False)","04c02c43":"business_only = yelp_business.select('business_id','name','categories')\nreview_business_name = business_only.join(review_sort,'business_id','inner')\nTop_ten_reviewed_business = review_business_name.limit(10)\nTop_ten_reviewed_business.show()","4e931a6f":"from pyspark.sql.functions import split,explode\ncategory = yelp_business.select('categories')\nindividual_category = category.select(explode(split('categories', ',')).alias('category'))\ngrouped_category = individual_category.groupby('category').count()\ntop_category = grouped_category.sort('count',ascending=False)\ntop_category.show(10,truncate=False)","3c1d222f":"rating = yelp_business.select('stars')\ngroup_rating = rating.groupby('stars').count()\nrating_top = group_rating.sort('count',ascending=False)\nrating_top.show(truncate=False)","e2cd0ccf":"locations = yelp_business.select('business_id','city')\nreview_city = yelp_review.select('business_id')\nmerge_city = locations.join(review_city,'business_id','inner')\ngrouped_review_city = merge_city.groupby('city').count()\nmost_reviewed_city = grouped_review_city.groupby('city').sum()\nmost_reviewed_city.sort('sum(count)',ascending=False).show(10)","1c6290de":"**Top Locations who have number of business more in world**","1ee2db77":"**Top 10 category which has most business count**","c43569be":"**Top 10 Reviewed Business**","550a4c94":"**Top Rating give by User to business**"}}