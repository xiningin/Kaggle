{"cell_type":{"e5576ec0":"code","a5bdcd8f":"code","73cf0cb5":"code","fe37ff58":"code","76286574":"code","d8e0bc4f":"code","5c40c51c":"code","25d647fb":"code","ebb5b075":"code","a3a545d6":"code","9f4776ec":"code","d5d3ed41":"code","18dcfde5":"code","99b50cc1":"code","c924db86":"code","961af8da":"code","0c315697":"code","17560f6e":"code","a7399f42":"code","f68a5659":"code","23b1c47d":"code","8032f1a9":"code","db9c136b":"code","f48fea0d":"code","de4629e3":"code","02047fa3":"markdown","393854b9":"markdown"},"source":{"e5576ec0":"# import librariea\nimport numpy as np\nimport pandas as pd\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.metrics import accuracy_score\n\nimport seaborn as sns\n\nimport matplotlib\nimport matplotlib.pyplot  as plt","a5bdcd8f":"\n#load csv file\nheart_data = pd.read_csv('..\/input\/heart-disease-uci\/heart.csv')","73cf0cb5":"#print first 5 rows\nheart_data.head()\n\n","fe37ff58":"# print last 5 rows\nheart_data.tail()\n\n","76286574":"# number of rows and columns in the dataset\nheart_data.shape\n\n","d8e0bc4f":"# getting some info about the data\nheart_data.info()\n\n\n","5c40c51c":"# checking for missing values\nheart_data.isnull().sum()\n","25d647fb":"# statistical measure about the data\nheart_data.describe()\n\n","ebb5b075":"# checking the distirbution of the Target Variable\n# 1 => Defective Heart\n# 0 => Healthy Heart\nheart_data[\"target\"].value_counts()","a3a545d6":"# spearman method in correlaction is the best one \n#The highest correlaction between attributes\ncorrelaction_matrix = heart_data.corr(method=\"spearman\")\nplt.figure(figsize=(15, 20))\n\nsns.heatmap(correlaction_matrix, annot = True)\n\nplt.title(\"Correlation matrix for Numeric Features\")\n\nplt.xlabel(\"Heart Disease UCI features\")\n\nplt.ylabel(\"Heart Disease UCI features\")\nplt.show()\n","9f4776ec":"corr_pair = correlaction_matrix.unstack()\n\nsorted_pairs = corr_pair.sort_values()\nsorted_pairs\nhigh_corr = sorted_pairs[sorted_pairs>0.4]\nhigh_corr","d5d3ed41":"plt.hist([heart_data[heart_data.target==0].age, heart_data[heart_data.target==1].age], bins = 20, alpha = 0.5, label = [\"no_heart_disease\",\"with heart disease\"])\nplt.xlabel(\"age\")\nplt.ylabel(\"percentage\")\nplt.legend()\nplt.show()\n","18dcfde5":"plt.hist([heart_data[heart_data.target==0].chol, heart_data[heart_data.target==1].chol], bins = 20, alpha = 0.5, label = [\"no_heart_disease\",\"with heart disease\"])\nplt.xlabel(\"chol\")\nplt.ylabel(\"percentage\")\nplt.legend()\nplt.show()","99b50cc1":"# splitting the feature and target \n\nX = heart_data.drop(columns = 'target', axis = 1)\nY = heart_data[\"target\"]\n\n\n","c924db86":"#splitting data into training set and testing set \n\nX_train, X_test, Y_train, Y_test = train_test_split(X,Y, test_size = 0.2, stratify = Y, random_state = 2)\n\n","961af8da":"X.shape\n","0c315697":"\nX_train.shape","17560f6e":"from sklearn.preprocessing import StandardScaler\n# sequential model to initialise our ann and dense module to build the layers\nfrom keras.models import Sequential\nfrom keras.layers import Dense\n\n# Making the Confusion Matrix\nfrom sklearn.metrics import confusion_matrix","a7399f42":"# Feature Scaling because yes we don't want one independent variable dominating the other and it makes computations easy\nsc = StandardScaler()\nX_train = sc.fit_transform(X_train)\nX_test = sc.transform(X_test)\n\n\n\n\n","f68a5659":"\n\n\nclassifier = Sequential()\n# Adding the input layer and the first hidden layer\nclassifier.add(Dense(units = 8, kernel_initializer = 'uniform', activation = 'relu', input_dim = 13))\n\n# Adding the second hidden layer\nclassifier.add(Dense(units = 8, kernel_initializer = 'uniform', activation = 'relu'))\n\n# Adding the output layer\nclassifier.add(Dense(units = 1, kernel_initializer = 'uniform', activation = 'sigmoid'))\n\n# Compiling the ANN | means applying SGD on the whole ANN\nclassifier.compile(optimizer = 'adam', loss = 'binary_crossentropy', metrics = ['accuracy'])\n\n","23b1c47d":"# Fitting the ANN to the Training set\nclassifier.fit(X_train, Y_train, batch_size = 100, epochs = 500,verbose = 0)\n\n","8032f1a9":"score, acc = classifier.evaluate(X_train, Y_train,\n                            batch_size=10)\nprint('Train score:', score)\nprint('Train accuracy:', acc)\n# Part 3 - Making predictions and evaluating the model\n\n","db9c136b":"# Predicting the Test set results\ny_pred = classifier.predict(X_test)\ny_pred = (y_pred > 0.5)\n\nprint('*'*20)\nscore, acc = classifier.evaluate(X_test, Y_test,\n                            batch_size=10)\nprint('Test score:', score)\nprint('Test accuracy:', acc)\n\n","f48fea0d":"\ncm = confusion_matrix(Y_test, y_pred)\nprint(cm)\n","de4629e3":"\n#             age, sex, cp, rbp,  chol  fbs restecg  maxHRate  exang  oldpeak  slope  ca  thal\ninput_data = (26,   0,   1, 110, 199    ,0,   0     ,120      ,0     ,1       ,4     ,2   ,3)\n\n#change input data into numpy array \n\ninput_data_as_numpy_array = np.asarray(input_data)\n\n# reshape numpy array as we are predicting for only on instance\n\ninput_data_reshaped = input_data_as_numpy_array.reshape(1,-1)\n\nprediction = classifier.predict(input_data_reshaped)   \n\nif (prediction[0] == 0):\n    print(\"doesn't have heart diseases\")\nelse:\n    print(\"have a diseases\")","02047fa3":"# **Introduction**\n\nWHO announced that cardiovascular diseases is the top one killer over the world. There are seventeen million people died from it every year, especially heart disease. Prevention is better than cure. If we can evaluate the risk of every patient who probably has heart disease, that is, not only patients but also everyone can do something earlier to keep illness away.\n\nThis dataset is a real data including important features of patients. This time we will build the predictable model by RandomFores tDecision Trees library.\n\nConfusion matrix is a common technique to figure out the accuracy of the model. From the standpoint of medicine.\n\n\n\n# Exploratory Analysis\n\nThere are thirteen features and one target as below:\n\nage: The person's age in years\nsex: The person's sex (1 = male, 0 = female)\ncp: The chest pain experienced (Value 1: typical angina, Value 2: atypical angina, Value 3: non-anginal pain, Value 4: asymptomatic)\ntrestbps: The person's resting blood pressure (mm Hg on admission to the hospital)\nchol: The person's cholesterol measurement in mg\/dl\nfbs: The person's fasting blood sugar (> 120 mg\/dl, 1 = true; 0 = false)\nrestecg: Resting electrocardiographic measurement (0 = normal, 1 = having ST-T wave abnormality, 2 = showing probable or definite left ventricular hypertrophy by Estes' criteria)\nthalach: The person's maximum heart rate achieved\nexang: Exercise induced angina (1 = yes; 0 = no)\noldpeak: ST depression induced by exercise relative to rest\nslope: the slope of the peak exercise ST segment (Value 1: upsloping, Value 2: flat, Value 3: downsloping)\nca: The number of major vessels (0-3)\nthal: A blood disorder called thalassemia (3 = normal; 6 = fixed defect; 7 = reversable defect)\n\ntarget: Heart disease (0 = no, 1 = yes)","393854b9":"## Build predictive system\n"}}