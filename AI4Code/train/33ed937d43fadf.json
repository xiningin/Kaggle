{"cell_type":{"f18728ad":"code","4a8a3fd7":"code","c23884c2":"code","a52f619d":"code","633628c6":"code","4bd18fd5":"code","c876b74c":"code","bf2b6880":"code","a6c1c115":"code","ee134f29":"code","e3582481":"code","60ec7b21":"code","87708ec4":"code","aacdaeef":"code","7f6d59d0":"code","9a7d9b57":"code","e18f24fe":"code","7842b8e6":"code","cf1619ea":"code","6f28def4":"code","8b4fda2d":"code","5e44ac73":"code","60066e0f":"code","d0a903bf":"code","2e03a19f":"code","12383570":"code","dc2ad056":"code","b9cf89ad":"code","d0597a62":"code","7719841b":"code","37ba22fd":"code","1e2ea799":"code","e5dbb9d4":"code","0646d79d":"code","d47e2b8e":"code","fbc0f1fc":"code","d9df675b":"code","62a9fb4d":"code","63e91d75":"code","88c3cf73":"code","0f8fbf75":"code","feebb20a":"code","2f261db3":"code","4b636b4f":"code","3dd24669":"code","4f274276":"code","03796b50":"code","5c25e26d":"code","37024521":"markdown","c88ba149":"markdown","4066d21b":"markdown","5f947425":"markdown","c8ad8341":"markdown","a35b58df":"markdown","3202e6b6":"markdown","de57e8b8":"markdown","001ceb6e":"markdown","68873117":"markdown","2c19a656":"markdown","9291b0d4":"markdown","abbcad61":"markdown","03464cf6":"markdown","0baaf1d2":"markdown","c65a15b9":"markdown","d19de230":"markdown","5bb4fc96":"markdown","d5e6b0c8":"markdown","701e92ef":"markdown","709c7733":"markdown","1c8b8941":"markdown","f2f3b840":"markdown"},"source":{"f18728ad":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt","4a8a3fd7":"from sklearn.preprocessing import LabelEncoder,StandardScaler\nfrom sklearn.metrics import r2_score,mean_squared_error","c23884c2":"weight_height_dataset = pd.read_csv('..\/input\/weight-height\/weight-height.csv')\nweight_height_dataset.head()","a52f619d":"weight_height_dataset.info()","633628c6":"weight_height_dataset.describe()","4bd18fd5":"weight_height_dataset.duplicated().sum()","c876b74c":"weight_height_dataset.isnull().sum()","bf2b6880":"sns.boxplot(weight_height_dataset.Weight)\nplt.show()","a6c1c115":"sns.boxplot(weight_height_dataset.Height)\nplt.show()","ee134f29":"q1 = weight_height_dataset['Weight'].quantile(0.25)\nq3 = weight_height_dataset['Weight'].quantile(0.75)\niqr = q3 - q1\nul = q3 + 1.5*iqr\nll = q1 - 1.5*iqr\nweight_height_dataset = weight_height_dataset[(weight_height_dataset.Weight >= ll) & (weight_height_dataset.Weight <= ul)]","e3582481":"q1 = weight_height_dataset['Height'].quantile(0.25)\nq3 = weight_height_dataset['Height'].quantile(0.75)\niqr = q3 - q1\nul = q3 + 1.5*iqr\nll = q1 - 1.5*iqr\nweight_height_dataset = weight_height_dataset[(weight_height_dataset.Height >= ll) & (weight_height_dataset.Height <= ul)]","60ec7b21":"sns.scatterplot(weight_height_dataset.Weight,weight_height_dataset.Height,color='g')\nplt.show()","87708ec4":"from sklearn.model_selection import train_test_split","aacdaeef":"x = pd.DataFrame(weight_height_dataset['Weight'])\ny = pd.DataFrame(weight_height_dataset['Height'])","7f6d59d0":"xtrain,xtest,ytrain,ytest = train_test_split(x,y,test_size=0.30,random_state=123)\nprint(xtrain.shape,ytrain.shape,xtest.shape,ytest.shape)","9a7d9b57":"from sklearn.linear_model import LinearRegression","e18f24fe":"lr = LinearRegression()\nlr.fit(xtrain,ytrain)\nyPredict = lr.predict(xtest)","7842b8e6":"print(lr.coef_)\nprint(lr.intercept_)","cf1619ea":"r2_score(ytest,yPredict)","6f28def4":"np.sqrt(mean_squared_error(ytest,yPredict))","8b4fda2d":"sns.scatterplot(xtrain.Weight,ytrain.Height)\nplt.plot(xtrain.Weight,lr.predict(xtrain),c='r')\nplt.show()","5e44ac73":"sns.scatterplot(xtest.Weight,ytest.Height,color='r')\nplt.plot(xtest.Weight,yPredict,c='b')\nplt.show()","60066e0f":"residual = ytest - yPredict","d0a903bf":"sns.residplot(yPredict,residual)\nplt.show()","2e03a19f":"import pylab\nimport scipy.stats as stats","12383570":"stats.probplot(residual.Height,plot=pylab)\nplt.show()","dc2ad056":"test,pvalue = stats.shapiro(residual)\nprint(pvalue)","b9cf89ad":"from statsmodels.stats.outliers_influence import variance_inflation_factor","d0597a62":"vif = [variance_inflation_factor(weight_height_dataset.drop('Gender',axis=1).values,i) for i in range(weight_height_dataset.drop('Gender',axis=1).shape[1])]","7719841b":"pd.DataFrame({'vif':vif},index=['Weight','Height']).T","37ba22fd":"from statsmodels.stats.api import het_goldfeldquandt","1e2ea799":"df = pd.DataFrame(weight_height_dataset['Height'])","e5dbb9d4":"residual2 = df - lr.predict(df)","0646d79d":"ftest,pvalue,result = het_goldfeldquandt(residual2,weight_height_dataset.drop('Gender',axis=1))\nprint(pvalue)","d47e2b8e":"from statsmodels.stats.stattools import durbin_watson","fbc0f1fc":"print(durbin_watson(residual))","d9df675b":"import statsmodels.api as sms","62a9fb4d":"model = sms.OLS(y,x).fit()\nmodel.summary()","63e91d75":"test,pvalue = sms.stats.diagnostic.linear_rainbow(model)\npvalue","88c3cf73":"weight_height_dataset[['Female','Male']] = pd.get_dummies(weight_height_dataset['Gender'])\nweight_height_dataset.head()","0f8fbf75":"weight_height_dataset.drop('Gender',axis=1,inplace=True)","feebb20a":"weight_height_dataset.head()","2f261db3":"temp = pd.DataFrame(StandardScaler().fit_transform(weight_height_dataset),columns=weight_height_dataset.columns)\ntemp.head()","4b636b4f":"x = temp.drop('Height',axis=1)\ny = temp['Height']","3dd24669":"xtrain,xtest,ytrain,ytest = train_test_split(x,y,test_size=0.30,random_state=123)\nprint(xtrain.shape,ytrain.shape,xtest.shape,ytest.shape)","4f274276":"lr = LinearRegression()\nlr.fit(xtrain,ytrain)\nyPredict = lr.predict(xtest)","03796b50":"r2_score(ytest,yPredict)","5c25e26d":"np.sqrt(mean_squared_error(ytest,yPredict))","37024521":"## IQR method to remove outliers\n\noutliers affect the regression line","c88ba149":" pvalue > 0.05,hence we fail to reject null hypothesis.ie it is not heteroscadatic.","4066d21b":"we can see on using encoder & scaling our accuracy increased by 1% & also reducing the RMSE.","5f947425":"### 2. Normal Distribution","c8ad8341":"### Split the dataset into train and test\n70:30 ratio","a35b58df":"### 4. Heteroscadastic\n\nif heteroscadastic, linear regression cannot be used. \n\nh0: residual is not heteroscadastic\n\nh1: residual is heteroscadastic","3202e6b6":"# Using One hot Encoding & Scaling to improve accuracy","de57e8b8":"### 3. Multicollinearity","001ceb6e":"### 6. Linearity\n\n- Rainbow Test\n\nh0: linear in nature\n\nh1: not linear in nature","68873117":"# Linear Regression Assumptions","2c19a656":"pvalue > 0.05, so we fail to reject null hypothesis. Thus we conclude distribution is normal.\n\n-- here alpha error = 0.05","9291b0d4":"# Univariate analysis","abbcad61":"## Check Rsquare and RMSE for accuracy","03464cf6":"# Apply Linear Regression","0baaf1d2":"# Plotting the Regression Line","c65a15b9":"p > 0.05 ,hence we fail to reject null hypothesis. Hence data is linear in nature","d19de230":"### 1. No pattern in residual","5bb4fc96":"# Bivariate analysis","d5e6b0c8":"approx 2, so no correlation between residuals.","701e92ef":"Shapio Wilk test of normality\n\nh0(null hypothesis) : residual is normal distribution\nh1(alternate hypothesis) : residual is not normal distribution","709c7733":"### Equation of line : y = 0.11x + 48.5","1c8b8941":"# Weight-Height Prediction using Linear Regression\n\nsimple linear regression model to predict the height of person for given weight","f2f3b840":"### 5. Auto-correlation\n\nThe errors should not be auto correlated in nature as it will violate the assumptions of the linear regression model.\n\n- Durbin Watson Test\n\n0 to 4\n\n[0-2) - (+)ve coorelation\n\n=2 - no correlation\n\n(2-4] - (-)ve correlaion"}}