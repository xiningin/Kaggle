{"cell_type":{"9b61c3d6":"code","138f6dca":"code","6104dd43":"code","c8f2d9b0":"code","e6f5fdb6":"code","8936343b":"code","093c83c9":"code","66a68c2e":"code","a5e7e6ce":"code","4a37df0a":"code","b859323b":"code","4ebb16cf":"code","2547add1":"code","0f00f74e":"code","26ba48a0":"code","beef0b2a":"code","49d153b4":"code","1b94564c":"code","018018e6":"code","86cd3a7d":"code","07da2b2f":"code","5941673e":"code","f5b9742b":"code","28bdf7a6":"code","957abcb9":"code","cef55f90":"code","791a3e36":"code","b4616fe7":"code","b6046f46":"code","42823d08":"code","361d28c5":"code","8cde3037":"code","7fc112b1":"code","5732f8c2":"code","940a157f":"code","c8ab190b":"code","44d66b4b":"code","af593d6c":"code","7a8a7b82":"code","ccb6297c":"code","b33cb9ab":"code","dfe46002":"code","3c49f6ed":"code","41a212c7":"code","f7cff9ad":"code","0331f79c":"code","b2786188":"code","6cdd94bf":"code","b8894695":"code","817d3356":"code","2e0b975e":"code","c202772f":"code","3a90b495":"code","128d290a":"code","4e26ac7c":"code","47276c45":"code","c8576d71":"code","6c37ed7a":"code","20063902":"code","24414ba9":"code","98520189":"code","9f63cc63":"markdown","ccdbaf20":"markdown","defa7399":"markdown","6d777191":"markdown","32cb6db8":"markdown","2cb17f55":"markdown","1feb0c8b":"markdown","4c36a7a2":"markdown","cef72ecd":"markdown","0b1ba700":"markdown","334fd560":"markdown","7ecffb7f":"markdown","eea4b8c3":"markdown","c9821690":"markdown","a77eee16":"markdown","bec908c8":"markdown","c1fac27c":"markdown","3d3171d1":"markdown","0ce395b7":"markdown"},"source":{"9b61c3d6":"import numpy as np \nimport pandas as pd \nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","138f6dca":"# the dataset\ndf_train=pd.read_csv('..\/input\/titanic\/train.csv')\n","6104dd43":"df_train.head()","c8f2d9b0":"df_train.info()","e6f5fdb6":"import matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set()","8936343b":"sns.heatmap(df_train.isnull(),yticklabels=False,cbar=False)\n\nplt.title('the missing values distribution in the data',fontsize=16)\nplt.show()","093c83c9":"# droping the column cabin\ndf_witout_cabin=df_train.drop('Cabin',axis=1)","66a68c2e":"#cheking for the rest of the columns\ndf_witout_cabin.columns","a5e7e6ce":"# we will count the percent of the missing values in order to know if the droping option is avliable for us\ndf_witout_cabin['Age'].isnull().sum()","4a37df0a":"len(df_witout_cabin['Age'])","b859323b":"percent_of_nulls=177*100\/891\n\npercent_of_nulls","4ebb16cf":"sns.boxplot(data=df_witout_cabin,y='Age',x='Sex')","2547add1":"sns.jointplot(data=df_witout_cabin,x='Age',y='Fare',kind='hex')","0f00f74e":"sns.boxplot(data=df_witout_cabin,y='Age',x='Pclass')","26ba48a0":"def f(x):\n    Age=x[0]\n    Pclass=x[1]\n    if pd.isnull(Age):\n        if Pclass==1:\n            return 38\n        elif Pclass==2:\n            return 29\n        else:\n            return 24\n    else:\n        return Age","beef0b2a":"df_witout_cabin['Age']=df_witout_cabin[['Age','Pclass']].apply(f,axis=1)","49d153b4":"sns.heatmap(df_witout_cabin.isnull(),yticklabels=False,cbar=False)\n\nplt.title('the missing values distribution in the data',fontsize=16)\nplt.show()","1b94564c":"df_witout_cabin.isnull().sum()","018018e6":"df_clean=df_witout_cabin.dropna()","86cd3a7d":"df_clean.isnull().sum()","07da2b2f":"sns.displot(data=df_clean,x='Fare')","5941673e":"df_cleaned=df_clean[(df_clean['Fare']<200)]","f5b9742b":"sns.displot(data=df_cleaned,x='Fare')","28bdf7a6":"df_cleaned.columns","957abcb9":"sns.countplot(data=df_cleaned,x='Survived',hue='Sex')","cef55f90":"sns.displot(data=df_cleaned,x='Survived')","791a3e36":"sns.pairplot(df_cleaned,corner=True)","b4616fe7":"df_train.describe(include='all')","b6046f46":"df_needed=df_cleaned[['Survived', 'Pclass', 'Sex', 'Age', 'SibSp',\n       'Parch', 'Fare', 'Embarked']]\ndf_needed.head()","42823d08":"df_dummies=pd.get_dummies(df_needed,drop_first=True)","361d28c5":"df_dummies.head()","8cde3037":"X_train=df_dummies.drop('Survived',axis=1)\ny_train=df_dummies['Survived']","7fc112b1":"X_train.head()","5732f8c2":"y_train.head()","940a157f":"import statsmodels.api as sm\n\n\nfrom scipy import stats\nstats.chisqprob = lambda chisq, df: stats.chi2.sf(chisq, df)","c8ab190b":"x=sm.add_constant(X_train)\nmodel=sm.Logit(y_train,x)\nresult=model.fit()\n\nresult.summary()","44d66b4b":"X_=X_train.drop(X_train[['Embarked_Q','Embarked_S']],axis=1)\n","af593d6c":"X_.head()","7a8a7b82":"x1=sm.add_constant(X_)\nmodel=sm.Logit(y_train,x1)\nresult=model.fit()\n\nresult.summary()","ccb6297c":"X_trial=X_.drop('Parch',axis=1)\n","b33cb9ab":"x2=sm.add_constant(X_trial)\nmodel=sm.Logit(y_train,x2)\nresult=model.fit()\n\nresult.summary()","dfe46002":"X_final=X_trial.drop('Fare',axis=1)\n","3c49f6ed":"x3=sm.add_constant(X_final)\nmodel=sm.Logit(y_train,x3)\nresult=model.fit()\n\nresult.summary()","41a212c7":"from sklearn.linear_model import LogisticRegression","f7cff9ad":"logmodel=LogisticRegression()","0331f79c":"logmodel.fit(X_final,y_train)","b2786188":"df_test = pd.read_csv('..\/input\/titanic\/test.csv')\ndf_test.head()","6cdd94bf":"df_test.describe()","b8894695":"df_test['Age']=df_test[['Age','Pclass']].apply(f,axis=1)","817d3356":"df_test_needed=df_test[['Pclass', 'Sex', 'Age', 'SibSp']]\ndf_test_needed.head()","2e0b975e":"df_test_needed.describe()","c202772f":"x_test_dummies=pd.get_dummies(df_test_needed,drop_first=True)\nx_test_dummies.head()","3a90b495":"predictions=logmodel.predict(x_test_dummies)","128d290a":"pred=pd.DataFrame(predictions,columns=['pred'])\npred.head()","4e26ac7c":"sub = pd.read_csv('..\/input\/titanic\/gender_submission.csv')\nsub_compare=sub.copy()\nsub_compare['predictions']=predictions\n#pd.set_option('display.max_rows', None)\nsub_compare.tail(20)","47276c45":"from sklearn.metrics import classification_report,confusion_matrix","c8576d71":"sub_compare.columns","6c37ed7a":"confusion_matrix(sub_compare['Survived'],pred)","20063902":"final_result=pd.DataFrame(confusion_matrix(sub_compare['Survived'],pred),index=[['actual No','actual Yes']],columns=[['predicted No','predicted Yes']])\nfinal_result","24414ba9":"classification_report(sub_compare['Survived'],pred)","98520189":"Final_submition=sub_compare.drop('Survived',axis=1)\nFinal_submition.to_csv('my_submition',index=False)","9f63cc63":"there is a relation between Age and Fare explains that most of younger people tend to buy cheaper ticket and most of the older people tend to buy more expensive tickets","ccdbaf20":" there are missing values in the columns Age and cabin columns\n \n \n for more investigations :\n","defa7399":"### Data Cleaning","6d777191":"we will expolre the relation between Age column \nand the rest of the data inorder to fill it or deciding to drop it ","32cb6db8":"### Evaluating the predictions","2cb17f55":"### Choosing The correct Featues For Our Model","1feb0c8b":"the feature with p_value greater than 0.005 has no statsticaly scnificance and must be deleted according to the back_ward_elimination_rule  \n\nbut we will jut one feature at the step","4c36a7a2":"### Building The model","cef72ecd":"### Getting the predictions","0b1ba700":"### If you liked the notebook, please upvote for it!","334fd560":"### Data Preprocessing","7ecffb7f":"### Final submition","eea4b8c3":"thre is no relation between Age and SEX","c9821690":"### (EDA) Eploratory Data Analysis","a77eee16":"### Preparing The test data before using it","bec908c8":"the figure shows that people with age around 38 tends to buy expensive ticket in the first class and people with age  around 29 tend to buy tickets in the second class however people with age around 24 tend to buy cheater tickets\n\n**so**, we can fillin null values in the Age column by informations from pclass ****","c1fac27c":"the data in the column cabin is very big so we will drop it\nin the other hand the data in the column Age is small and will distributed in the data so we will try if we can fill it","3d3171d1":"the percent is greater than 5% so if we drop the null values in the Age column, then we will not be able to use it in our model unless we find a way to fillin the null values \n\nnow we will explore the data;","0ce395b7":"### Importing the needed liberaries"}}