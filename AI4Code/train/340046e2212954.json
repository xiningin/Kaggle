{"cell_type":{"e36fac21":"code","14410b2f":"code","8c0e9fed":"code","27f0dbd6":"code","f6ca87f8":"code","1a4fb65f":"code","e4e0b91e":"code","44807f81":"code","aaf2b164":"code","dc5cfbcb":"code","82c999f0":"code","3e1491ba":"code","c4075c2c":"code","c0f79a46":"code","1e8c6bf8":"markdown"},"source":{"e36fac21":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport tensorflow_hub as hub\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","14410b2f":"import os\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport tensorflow as tf\nimport cv2 # read image\nfrom tensorflow.keras.models import Sequential\nfrom tensorflow.keras.layers import Dense, Conv2D, Flatten, Dropout, MaxPool2D, GlobalAveragePooling2D\nfrom tensorflow.keras.preprocessing import image\nfrom tensorflow.keras.preprocessing.image import ImageDataGenerator","8c0e9fed":"PATH = \"\/kaggle\/input\/shopee-product-detection-student\/\"\ntrain_dir = os.path.join(PATH, \"train\/train\/train\")\ntest_dir = os.path.join(PATH, \"test\/test\/test\")","27f0dbd6":"train_dir","f6ca87f8":"train_list = os.listdir(train_dir)\ntest_list = os.listdir(test_dir)","1a4fb65f":"df_train = pd.read_csv(os.path.join(PATH, \"train.csv\"))\ndf_train","e4e0b91e":"df_test = pd.read_csv(os.path.join(PATH, \"test.csv\"))\ndf_test","44807f81":"dir_cat = os.path.join(train_dir,\"00\")\nfirst_image_name = os.listdir(dir_cat)[0]\nfirst_im = cv2.imread(os.path.join(dir_cat, first_image_name))\nprint(type(first_im))\nprint(first_im.shape) # image height and width\nprint(first_im.min(),first_im.max()) # range from 0 to 255 \nplt.imshow(first_im)\nplt.show","aaf2b164":"sns.countplot(df_train[\"category\"])","dc5cfbcb":"batch_size = 128\nepoch = 15\nimg_h = 150\nimg_w = 150","82c999f0":"datagen = ImageDataGenerator(rescale = 1.\/255, validation_split = 0.25)\ntrain_iter = datagen.flow_from_directory(batch_size = batch_size,\n                                        directory=train_dir,\n                                        shuffle=True,\n                                        target_size=(img_h, img_w),\n                                        class_mode=\"categorical\",\n                                        subset = \"training\")\n\nval_iter = datagen.flow_from_directory(batch_size = batch_size,\n                                        directory=train_dir,\n                                        shuffle=True,\n                                        target_size=(img_h, img_w),\n                                        class_mode=\"categorical\",\n                                        subset = \"validation\")","3e1491ba":"test_iter = datagen.flow_from_directory(\n    directory = test_dir,\n    shuffle=False,\n    target_size=(img_h, img_w)\n)","c4075c2c":"URL = \"https:\/\/tfhub.dev\/google\/tf2-preview\/mobilenet_v2\/feature_vector\/2\"\nfeature_extractor = hub.KerasLayer(URL,input_shape=(img_h,img_w,3))","c0f79a46":"base_model.summary()","1e8c6bf8":"training_image:105390(42 categories)\ntesting_image:12186"}}