{"cell_type":{"4ff2a58a":"code","87393483":"code","0c4be1da":"code","56e8cf69":"code","13f1b250":"code","13c6a56a":"code","5f1db98c":"code","3184d3e5":"code","c14e4fe7":"code","2fb93a66":"code","29ef2e17":"code","66324f3b":"code","1be0d933":"code","d050f615":"code","84fbc703":"markdown","e7c6f840":"markdown","1bc5992d":"markdown","c8c49452":"markdown","dd852fb1":"markdown","79e02332":"markdown","c1e37f57":"markdown","99aa7e02":"markdown","54c5d51c":"markdown","ea27d761":"markdown","eb430b63":"markdown","c6dbd7e7":"markdown","9178e8c7":"markdown","8baf6510":"markdown","cb3f5907":"markdown","1e3318f1":"markdown"},"source":{"4ff2a58a":"from sklearn.cluster import KMeans\nfrom sklearn.metrics import pairwise_distances_argmin_min\nfrom sklearn.preprocessing import normalize\nimport matplotlib.pyplot as plt\nimport numpy as np \nimport pandas as pd\n\ndf = pd.read_csv('..\/input\/nba201718.csv')\n\nprint(df.head(10))\nprint(df.tail(10))\n\ndf.info()","87393483":"df.fillna(0, inplace=True)","0c4be1da":"len(df['Player'].unique())","56e8cf69":"df[df.groupby('Player').transform(len)['Tm'] > 1].head(10)","13f1b250":"df = df.groupby('Player').first().reset_index()\ndf.info()","13c6a56a":"df.describe()","5f1db98c":"df.drop(df[df['MP'] < 240].index, inplace = True)\ndf = df.reset_index()\ndf.describe()","3184d3e5":"col_simple = ['TRB', 'AST', 'STL', 'BLK','PTS','3PA']\ndf_simple = df[col_simple]","c14e4fe7":"df_simple_normalized = pd.DataFrame(normalize(df_simple), columns = df_simple.columns)\ndf_simple_normalized.index = df_simple.index\nkmeans = KMeans(n_clusters=5, random_state = 123)\ngroup = kmeans.fit_predict(df_simple_normalized.values)\ndf_simple = df_simple.assign(Group = pd.Series(group, index = df_simple.index))\nprint(df_simple['Group'].value_counts())\ndf = df.assign(Group =  df_simple['Group'].values)\ndf_simple_normalized = df_simple_normalized.assign(Group =  df_simple['Group'].values)\n","2fb93a66":"df_grouped = df_simple.groupby('Group').mean()\ndf_norm_grouped = df_simple_normalized.groupby('Group').mean()\n    \ndf_grouped.T","29ef2e17":"by_pos = df.groupby('Group')['Pos'].value_counts()\nprint(by_pos)","66324f3b":"# data transformation which equalizes maximum value of every skill,\n# what makes mastery of them comparable\n\ncluster_labels = ['sniper', 'classic center', 'versatile forward', 'playmaker', 'frontcourt']\n\ndf_draw = df_norm_grouped.copy()\nmaximums = []\nfor column in df_draw:\n    maximums.append(df_draw[column].max())\ntop = max(maximums)\nfor i,column in enumerate(df_draw):\n    df_draw[column] = df_draw[column] * top \/ maximums[i]\n\n# plotting 5 radar charts\ncolors = ['red', 'blue', 'green', 'yellow', 'purple']\nfig=plt.figure(figsize = (25,10))\nfor i in range(1, 6):\n    stats = df_draw.loc[i-1]\n    angles=np.linspace(0, 2*np.pi, len(col_simple), endpoint=False)\n    stats=np.concatenate((stats,[stats[0]]))\n    angles=np.concatenate((angles,[angles[0]]))\n    ax = fig.add_subplot(1, 5, i, polar=True)\n    ax.plot(angles, stats, 'o-', linewidth=3, color = colors[i-1])\n    ax.fill(angles, stats, alpha=0.25, color = colors[i-1])\n    ax.set_thetagrids(angles * 180\/np.pi, col_simple)\n    ax.set_yticklabels([])\n    sub_title = 'Group ' + str(i-1) + ' - ' + cluster_labels[i-1]\n    ax.set_title(sub_title)\n    ax.title.set_fontsize(18)\n    ax.set_rmin(0)\n    ax.grid(True)\nplt.show()\n","1be0d933":"closest, _ = pairwise_distances_argmin_min(kmeans.cluster_centers_, df_simple_normalized[col_simple])\nfor i in range(5): \n    print(\"Group\",i,\"-\",df.loc[closest[i],'Player'].split(\"\\\\\")[0])","d050f615":"# calculating distance to nearest cluster's centre\ndist = np.min(kmeans.transform(df_simple_normalized[col_simple].values), axis=1)\ndf = df.assign(dist = pd.Series(dist, index = df.index))\n\npos_color = {'PG':'red',\n             'SG':'gold',\n             'SF':'green',\n             'PF': 'cyan',\n             'C':'blue',\n             'PG-SG': 'sandybrown',\n             'SF-SG': 'olive'\n        }\n\nfor g in range(5): \n    df_g = df.loc[df['Group']==g].sort_values(by=['MP'], ascending=False).head(25).reset_index()\n    fig, ax = plt.subplots(figsize=(20,10)) \n    for p in df_g.Pos:\n        ax.scatter(df_g.dist, df_g.MP, s = 150, c=df_g.Pos.map(pos_color))\n    ax.legend(pos_color, labelspacing=2)\n    leg = ax.get_legend()\n    for nmr, c in enumerate(pos_color):\n        leg.legendHandles[nmr].set_color(pos_color[c])\n    title = \"Group \" + str(g) + ' - ' + cluster_labels[g]\n    ax.set_title(title)\n    ax.title.set_fontsize(24)\n    for i, txt in enumerate(df_g.Player):\n        ax.annotate(txt.split(\"\\\\\")[0], (df_g.dist[i], df_g.MP[i]), fontsize = 16)\nplt.show()","84fbc703":"Need better known names?\n\nLet's show players who played the most often (y axis) and accuracy of matching finded role (x-axis, closer to the left means better matching). ","e7c6f840":"I'll check if any player appears more than once.","1bc5992d":"Much better.\n\nChoosing statistics for use.\nMy choice: total rebounds, assists, steals, blocks, 3-point attempts, points","c8c49452":"540 unique values among of total 664. Let's inspect it.","dd852fb1":"Null values appear in shoot performance statistics as a result of no attempts. I'll put zeros there.","79e02332":"In group (sniper) we have Paul George, Bradley Beal, Klay Thompson. Sounds like perfect match. Also combo guards (playmakers who make many shot attempts) appear there: Kemba Walker, Donovan Mitchell, Goran Dragic.\n\nGroup 1 (classic center): Aron Baynes, Marcin Gortat, Rudy Gobert, Clint Capela, Dwight Howard, Andre Drummond. All of them play the same role on the court, which is in description of the group.\n\nGroup 2 (veratile forward): As expected variety of styles. Many tall players with good long distance shoot, like: Ersan Ilyasova, Lauri Markanen, Dirk Nowitzki.\n\nGroup 3 (playmaker): And point guards there, Ricky Rubio, Frank Ntilikina, Chris Paul. Interesting fact: LeBron James was classified here, what makes sense, as he is  ball-handler often.\n\nGroup 4 (frontcourt): Or in other words more versatile centers and poer forwards. So there are: Joel Embiid, Markieff Morris, Karl-Anthony Towns, Anthony Davis, Nikola Jokic and Giannis Antetokounmpo (I expected him in group 2 or maybe even in 1).\n","c1e37f57":"That's it. \n","99aa7e02":"Playing for more than one team is represented by multiple rows. Fortunately first row with each player name contains total season stats. I'll use only it for players who played in multiple teams.","54c5d51c":"Nice. Let's look into the numbers.","ea27d761":"Clustering:","eb430b63":"Who is the best fitted representative of each group?","c6dbd7e7":"Skillset visualisation:","9178e8c7":"Let's look into each group profile (average statistics and distribution of official players positions).","8baf6510":"Maximum values are unbelievable. I suppose they come from players who played extremely short. I'll delete stats of people with less than 240 minutes played. ","cb3f5907":"Modern basketball blurs traditional player's positions. \"Small ball\" lineups, decreasing role of centers, increasing number of long distance shooters, etc. \nIn script below I'll use K-means clustering for assigning players to 5 groups based on chosen statistics like points, rebounds, asists, blocks, steals and 3-point shoot attempts. Results will be compared to real positions, average statistics of each group will be presented to visualise their skillset. Afterwards I'll try to choose \"leaders\" and \"perfectly\" assigned players (with stats nearest to cluster's centres).\n\nLet's open the dataset.","1e3318f1":"Now I can say something about the results, even name the groups.\n\n0 - Sniper, long distance shooter, typical shooting guard.\n\n1 - Classic center, scores from short distance, rebounds and blocks shots (post player).\n\n2 - Versatile forward, plays close to basket and throws 3-pointers.\n\n3 - Playmaker, ball handler, responsible for getting his team into its offense. Capable to create shooting opportunities for colleagues and for himself, long distance shooter.\n\n4 - Frontcourt (plays close to the rim), can throw longshots, but is more focused on playing in the paint."}}