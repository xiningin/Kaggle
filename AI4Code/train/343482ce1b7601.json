{"cell_type":{"bb9ab35c":"code","5e589f5b":"code","9b312123":"code","18c058b9":"code","c618d9b0":"code","93d9230d":"code","76faac6e":"code","07a92276":"code","36990d55":"code","1114d51f":"code","fd7f7b38":"code","7beb2ced":"code","8bacfc48":"code","da24944f":"code","23dfc763":"code","293528fa":"code","59086856":"code","16da0b40":"code","8b382e5a":"code","3c7a0bed":"code","0d157670":"code","1feb8df8":"code","5f432860":"code","77e3faf7":"code","2a2deb80":"code","7438c92a":"code","5caaf99f":"code","3ec1b78b":"code","30b85da4":"code","55774aab":"code","ed61bfd8":"code","e6aff4b5":"code","9bee41cc":"code","c5c036bd":"code","eed1debc":"markdown","27f8551e":"markdown","98c8bf9a":"markdown","b74bae82":"markdown","67250a05":"markdown","c02ca864":"markdown"},"source":{"bb9ab35c":"import pandas as pd","5e589f5b":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","9b312123":"df=pd.read_csv('..\/input\/fake-news-data\/train.csv')","18c058b9":"df.head()","c618d9b0":"###Drop Nan Values\ndf=df.dropna()","93d9230d":"## Get the Independent Features\n\nX=df.drop('label',axis=1)","76faac6e":"## Get the Dependent features\ny=df['label']","07a92276":"X.shape","36990d55":"y.shape","1114d51f":"import tensorflow as tf","fd7f7b38":"tf.__version__","7beb2ced":"from tensorflow.keras.layers import Embedding\nfrom tensorflow.keras.preprocessing.sequence import pad_sequences\nfrom tensorflow.keras.models import Sequential\nfrom tensorflow.keras.preprocessing.text import one_hot\nfrom tensorflow.keras.layers import LSTM\nfrom tensorflow.keras.layers import Dense","8bacfc48":"### Vocabulary size\nvoc_size=5000","da24944f":"messages=X.copy()","23dfc763":"messages['title'][1]","293528fa":"messages.reset_index(inplace=True)","59086856":"import nltk\nimport re\nfrom nltk.corpus import stopwords","16da0b40":"nltk.download('stopwords')","8b382e5a":"### Dataset Preprocessing\nfrom nltk.stem.porter import PorterStemmer\nps = PorterStemmer()\ncorpus = []\nfor i in range(0, len(messages)):\n    print(i)\n    review = re.sub('[^a-zA-Z]', ' ', messages['title'][i])\n    review = review.lower()\n    review = review.split()\n    \n    review = [ps.stem(word) for word in review if not word in stopwords.words('english')]\n    review = ' '.join(review)\n    corpus.append(review)","3c7a0bed":"corpus","0d157670":"onehot_repr=[one_hot(words,voc_size)for words in corpus] \nonehot_repr","1feb8df8":"sent_length=20\nembedded_docs=pad_sequences(onehot_repr,padding='pre',maxlen=sent_length)\nprint(embedded_docs)","5f432860":"embedded_docs[0]","77e3faf7":"## Creating model\nembedding_vector_features=40\nmodel=Sequential()\nmodel.add(Embedding(voc_size,embedding_vector_features,input_length=sent_length))\nmodel.add(LSTM(100))\nmodel.add(Dense(1,activation='sigmoid'))\nmodel.compile(loss='binary_crossentropy',optimizer='adam',metrics=['accuracy'])\nprint(model.summary())","2a2deb80":"len(embedded_docs),y.shape","7438c92a":"import numpy as np\nX_final=np.array(embedded_docs)\ny_final=np.array(y)","5caaf99f":"X_final.shape,y_final.shape","3ec1b78b":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X_final, y_final, test_size=0.33, random_state=42)","30b85da4":"### Finally Training\nmodel.fit(X_train,y_train,validation_data=(X_test,y_test),epochs=10,batch_size=64)","55774aab":"from tensorflow.keras.layers import Dropout\n## Creating model\nembedding_vector_features=40\nmodel=Sequential()\nmodel.add(Embedding(voc_size,embedding_vector_features,input_length=sent_length))\nmodel.add(Dropout(0.3))\nmodel.add(LSTM(100))\nmodel.add(Dropout(0.3))\nmodel.add(Dense(1,activation='sigmoid'))\nmodel.compile(loss='binary_crossentropy',optimizer='adam',metrics=['accuracy'])","ed61bfd8":"y_pred=model.predict_classes(X_test)","e6aff4b5":"from sklearn.metrics import confusion_matrix","9bee41cc":"confusion_matrix(y_test,y_pred)","c5c036bd":"from sklearn.metrics import accuracy_score\naccuracy_score(y_test,y_pred)","eed1debc":"### Performance Metrics And Accuracy","27f8551e":"### Onehot Representation","98c8bf9a":"## Fake News Classifier Using LSTM\n\nDataset: https:\/\/www.kaggle.com\/c\/fake-news\/data#","b74bae82":"### Adding Dropout ","67250a05":"### Embedding Representation","c02ca864":"### Model Training"}}