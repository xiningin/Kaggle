{"cell_type":{"d76308a4":"code","5ecc3f5f":"code","7cfb9a3f":"code","4d850acf":"code","7b2ba67f":"code","523af78b":"markdown"},"source":{"d76308a4":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nimport glob\nimport magic\n\n# Any results you write to the current directory are saved as output.","5ecc3f5f":"#Validation function\ndef gunvalidation(directory):\n    #check format of files \n    def fileformat(file):\n        print (f'File format is {magic.from_file(file)}')\n        \n    #check for missing data in files\n    def missinglatloncol(file):\n            if \"latitude\" in pd.read_csv(file).columns:\n                print (f'Lat\/Lon column present')\n            else:\n                print (f'Lat\/Lon column missing')\n                \n    #percent of missing values in gunstolen column\n    def missingdata(file):\n        if 'latitude' in (pd.read_csv(file).columns):\n            mis = round((pd.read_csv(file).isnull().sum().sum()\/(len(pd.read_csv(file))*len(pd.read_csv(file).columns))*100))\n            print(f'{mis} % of total data missing')\n            \n    for file in glob.glob(directory):\n        print (f'Validation for ...{file[-20:]}')\n                \n        fileformat(file)\n        missinglatloncol(file)\n        missingdata(file)\n        \n        print('\\n')","7cfb9a3f":"gunvalidation('\/kaggle\/input\/repository\/jamesqo-gun-violence-data-17dc307\/intermediate\/*.csv')","4d850acf":"#Pull relevant details out of each dataframe and add it to a cleaned dataframe\n#only interested in FL killed\/injured by month and year\ncleaned_data = pd.DataFrame()\nfor file in glob.glob(\"\/kaggle\/input\/repository\/jamesqo-gun-violence-data-17dc307\/intermediate\/*.csv\"):\n    if 'stage2' in file:\n        df1 = pd.read_csv(file)\n        data = {'FL killed': df1[df1['state']=='Florida']['n_killed'].sum(),\n                'FL injured': df1[df1['state']=='Florida']['n_injured'].sum(),\n                'Month': pd.to_datetime(df1[df1['state']=='Florida']['date']).dt.month.mean(),\n                'Year': pd.to_datetime(df1[df1['state']=='Florida']['date']).dt.year.mean()}\n        df_temp = pd.DataFrame(data, index = [0])\n    cleaned_data = cleaned_data.append(df_temp, ignore_index=True).drop_duplicates().reset_index(drop=True)","7b2ba67f":"cleaned_data","523af78b":"# Mass Shooting Data Pipeline\n## Inputs data from github Gun Violence repository\n## Runs a validation on files contained\n## Selects only details from FL Mass Shootings and inputs into separate dataframe for each version"}}