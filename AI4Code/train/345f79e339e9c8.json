{"cell_type":{"4d9cbb71":"code","79fb64e6":"code","41468321":"code","a5253857":"code","a4274180":"code","a9d0e596":"code","6254295d":"code","9f3160d9":"code","ac1dce90":"code","f30dc750":"code","7ab70ad0":"code","b0208776":"code","d023eccd":"code","1b7824f9":"code","02289172":"code","2ba4da1a":"code","5ceb1fe3":"code","b4f583ea":"code","6af462ac":"code","5484ae65":"code","b1ea8475":"code","186a9ac2":"code","7d7ce8bb":"code","c5a9203d":"code","68cd4971":"code","6389c28a":"code","4c199684":"code","444020e5":"code","794dc43c":"code","364b6f9c":"code","638fc173":"code","90636b3a":"code","01d3772d":"code","01291419":"code","1d8f3425":"code","3689c547":"code","12a21fc7":"code","26428ce9":"code","3e42a7e8":"code","47f44a78":"code","7b1f9e5f":"code","c4b94d4e":"code","78652883":"code","a98dd1cf":"code","7dfcc376":"code","08f6e1ed":"code","feac7581":"markdown","b7b3083e":"markdown","46098086":"markdown","ca99b02b":"markdown","6fb13b06":"markdown","b0e8a8d4":"markdown","ef81c7d4":"markdown","233c37ed":"markdown","3de6123b":"markdown","78c2c172":"markdown"},"source":{"4d9cbb71":"import numpy as np \nimport pandas as pd \nimport matplotlib.pyplot as plt \nimport seaborn as sns ","79fb64e6":"#load data on dataframe\ncc_df = pd.read_csv(\"\/kaggle\/input\/cervical-cancer-risk-classification\/kag_risk_factors_cervical_cancer.csv\")\n\n\n#display dataframe\ncc_df.head()","41468321":"#count of rows and columns\ncc_df.shape","a5253857":"# Get data frame info\ncc_df.info()","a4274180":"# Obtain statistics from data frame\ncc_df.describe()","a9d0e596":"# Replace '?' with NaN\n\ncc_df = cc_df.replace('?', np.nan)\ncc_df","6254295d":"cc_df.isnull()","9f3160d9":"# Data frame info\ncc_df.info()","ac1dce90":"# Drop STDs: Time since first diagnosis  and STDs: Time since last diagnosis because they have more than 80% missing values\n\ncc_df = cc_df.drop(columns = ['STDs: Time since first diagnosis','STDs: Time since last diagnosis'])\ncc_df","f30dc750":"# Convert datatype of column from object to numeric, \n# Datatype object unable to produce statistics\n\ncc_df = cc_df.apply(pd.to_numeric)\ncc_df.info()","7ab70ad0":"# Obtained the statistics of the dataframe\ncc_df.describe()","b0208776":"# Obtain mean for all the columns \ncc_df.mean()","d023eccd":"# Replace null values with mean\ncc_df = cc_df.fillna(cc_df.mean())\ncc_df","1b7824f9":"# Obtain correlation matrix\ncorr_matrix = cc_df.corr()\ncorr_matrix","02289172":"# Plot the correlation matrix\n\nplt.figure(figsize =(30,30))\nsns.heatmap(corr_matrix, annot = True)\nplt.show()","2ba4da1a":"cc_df.info()","5ceb1fe3":"# Change all the datatype to be float 64\ncc_df['Age'] = cc_df['Age'].astype(float)\ncc_df['STDs: Number of diagnosis'] = cc_df['STDs: Number of diagnosis'].astype(float)\ncc_df['Dx:Cancer'] = cc_df['Dx:Cancer'].astype(float)\ncc_df['Dx:CIN'] = cc_df['Dx:CIN'].astype(float)\ncc_df['Dx:HPV'] = cc_df['Dx:HPV'].astype(float)\ncc_df['Dx'] = cc_df['Dx'].astype(float)\ncc_df['Hinselmann'] = cc_df['Hinselmann'].astype(float)\ncc_df['Schiller'] = cc_df['Schiller'].astype(float)\ncc_df['Citology'] = cc_df['Citology'].astype(float)\ncc_df['Biopsy'] = cc_df['Biopsy'].astype(float)","b4f583ea":"cc_df.info()","6af462ac":"sns.countplot(x=\"Biopsy\",data=cc_df);\ncounts = cc_df['Biopsy'].value_counts()\ncounts\n              ","5484ae65":"fig, ax = plt.subplots()\nax.pie(counts, autopct='%1.1f%%')\nax.legend(labels=['0(Negative)', '1(Positive)'], title='Biopsy',loc='lower right')\nax.set_title(\"Biopsy Percentage\")\nplt.show()","b1ea8475":"# Assigning input_df as input and output_df as output\ny = cc_df['Biopsy']\nX = cc_df.drop(columns = ['Biopsy'])","186a9ac2":"# spliting the data in to test and train sets\nfrom sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.3)\nprint(X_test.shape)\nprint(X_train.shape)","7d7ce8bb":"from sklearn.ensemble import RandomForestClassifier\n\nrf=RandomForestClassifier()\nrf.fit(X_train,y_train.values.ravel())","c5a9203d":"# Plot the feature importance\n\nfeat_scores= pd.DataFrame({\"Fraction of variables affected\" : rf.feature_importances_},index = X.columns)\nfeat_scores= feat_scores.sort_values(by = \"Fraction of variables affected\")\nfeat_scores.plot(kind = \"barh\", figsize = (10, 5))\nsns.despine()","68cd4971":"# Positivity by Schiller\nax = sns.kdeplot(cc_df.Schiller[(cc_df[\"Biopsy\"] == 0)],\n               color = \"Red\", shade = True)\nax = sns.kdeplot(cc_df.Schiller[(cc_df[\"Biopsy\"] == 1)],\n               color = \"Blue\", shade = True)\n\nax.legend([\"Negative\", \"Positive\"], loc = \"upper right\")\nax.set_ylabel(\"Density\")\nax.set_xlabel(\"Schiller\")\nax.set_title(\"Distribution of Schiller by positivity\")","6389c28a":"# Positivity by First sexual intercourse\nax = sns.kdeplot(cc_df[\"First sexual intercourse\"][(cc_df[\"Biopsy\"] == 0)],\n               color = \"Red\", shade = True)\nax = sns.kdeplot(cc_df[\"First sexual intercourse\"][(cc_df[\"Biopsy\"] == 1)],\n               color = \"Blue\", shade = True)\n\nax.legend([\"Negative\", \"Positive\"], loc = \"upper right\")\nax.set_ylabel(\"Density\")\nax.set_xlabel(\"First sexual intercourse\")\nax.set_title(\"Distribution of First sexual intercourse by positivity\")","4c199684":"from sklearn.ensemble import RandomForestClassifier\n\nmodel_rf=RandomForestClassifier()\nmodel_rf.fit(X_train,y_train)","444020e5":"y_predict1=model_rf.predict(X_test)","794dc43c":"from sklearn.metrics import classification_report, confusion_matrix\nprint(classification_report(y_test,y_predict1))\n","364b6f9c":"cm=confusion_matrix(y_test,y_predict1)\nsns.heatmap(cm,annot=True)","638fc173":"from sklearn.calibration import CalibratedClassifierCV # For probability score output\nfrom sklearn.svm import LinearSVC\n\nmodel_svm=LinearSVC(max_iter=10000)\nmodel_svm=CalibratedClassifierCV(model_svm)\nmodel_svm.fit(X_train,y_train)","90636b3a":"y_predict2=model_svm.predict(X_test)","01d3772d":"print(classification_report(y_test,y_predict2))","01291419":"cm=confusion_matrix(y_test,y_predict2)\nsns.heatmap(cm, annot=True)","1d8f3425":"from sklearn.neighbors import KNeighborsClassifier\n\nmodel_knn=KNeighborsClassifier()\nmodel_knn.fit(X_train,y_train)","3689c547":"y_predict3=model_knn.predict(X_test)","12a21fc7":"print(classification_report(y_test,y_predict3))","26428ce9":"cm=confusion_matrix(y_test,y_predict3)\nsns.heatmap(cm,annot=True)","3e42a7e8":"from sklearn.naive_bayes import GaussianNB\n\nmodel_gnb=GaussianNB()\nmodel_gnb.fit(X_train, y_train)","47f44a78":"y_predict4=model_gnb.predict(X_test)","7b1f9e5f":"print(classification_report(y_test, y_predict4))","c4b94d4e":"cm = confusion_matrix(y_test, y_predict4)\nsns.heatmap(cm, annot = True)","78652883":"# ROC curve\nfrom sklearn.metrics import roc_curve\n\nfpr1, tpr1, thresh1 = roc_curve(y_test, model_rf.predict_proba(X_test)[:, 1], pos_label = 1)\nfpr2, tpr2, thresh2 = roc_curve(y_test, model_svm.predict_proba(X_test)[:, 1], pos_label = 1)\nfpr3, tpr3, thresh3 = roc_curve(y_test, model_knn.predict_proba(X_test)[:, 1], pos_label = 1)\nfpr4, tpr4, thresh4 = roc_curve(y_test, model_gnb.predict_proba(X_test)[:, 1], pos_label = 1)","a98dd1cf":"plt.plot(fpr1, tpr1, linestyle = \"--\", color = \"green\", label = \"Random Forest\")\nplt.plot(fpr2, tpr2, linestyle = \"--\", color = \"red\", label = \"SVM\")\nplt.plot(fpr3, tpr3, linestyle = \"--\", color = \"purple\", label = \"KNN\")\nplt.plot(fpr4, tpr4, linestyle = \"--\", color = \"orange\", label = \"Naive bayes\")\n\n\nplt.title('Receiver Operator Characteristics (ROC)')\nplt.xlabel('False Positive Rate')\nplt.ylabel('True Positive rate')\n\nplt.legend(loc = 'best')\nplt.savefig('ROC', dpi = 300)\nplt.show()","7dfcc376":"fig,ax=plt.subplots(figsize=(25,15))\nax=sns.boxplot(y='Age', x='First sexual intercourse', hue='Biopsy',data=cc_df)","08f6e1ed":"fig,ax=plt.subplots(figsize=(20,15))\nax=sns.barplot(y='Age',x='First sexual intercourse', hue='Biopsy', data=cc_df)\nax.set(xlabel='First sexual intercourse', ylabel='Age')\nplt.show()","feac7581":"### NAIVE BAYES CLASSIFIER","b7b3083e":"# Box Plot Analysis","46098086":"### K-NEAREST NEIGHBOUR (KNN)","ca99b02b":"Various machine learning methods are used in evaluating cervical cancer.\n\nSupport Vector Machine Classifier\nRandom Forest Classifier\nK-Nearest Neighbour (KNN)\nNaive Bayes Classifier","6fb13b06":"### SUPPORT VECTOR MACHINE CLASSIFIER","b0e8a8d4":"# Conclusion\n\nPatient in the age group 20 to 35 year old with their first sexual intercourse in between 15 and 19 years of their life tend to be tested positive.","ef81c7d4":"# Machine Learning ","233c37ed":"# Check correlation matrix","3de6123b":"# PLOT ROC CURVES AND FIND AUC SCORES For Various Machine Learning Model above","78c2c172":"### RANDOM FOREST CLASSIFIER"}}