{"cell_type":{"5b60410d":"code","947ab6f5":"code","eac6e635":"code","b7ada1c3":"code","734f91a2":"code","6e0a282a":"code","aecbe6c0":"code","07dc1c3f":"code","92ce4983":"code","3060d0d0":"code","b079655f":"code","319bb649":"code","ef514453":"code","326251a2":"code","a07d933d":"code","7acd552f":"code","0aacf7eb":"code","1c022c56":"code","205c4f6a":"code","43184aff":"code","0f0bf070":"code","0f39553c":"code","ec608a8d":"code","4aa3f6b3":"code","db8aaf9a":"code","2083e956":"markdown","0991c58d":"markdown","d6eaf9d9":"markdown","1d87ba16":"markdown","72b77bd5":"markdown","ff672424":"markdown","300205d3":"markdown","37ed21a0":"markdown","0db007c2":"markdown"},"source":{"5b60410d":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","947ab6f5":"# Pip additional libraries \n!pip install adjustText","eac6e635":"import pandas as pd\nimport numpy as np\n\nimport pickle\n\nfrom collections import Counter\nfrom sklearn.feature_extraction import text \nfrom sklearn.feature_extraction.text import CountVectorizer\nfrom textblob import TextBlob\n\nfrom matplotlib import pyplot as plt\nfrom adjustText import adjust_text\nimport math\nfrom tqdm import tqdm\nimport seaborn as sns","b7ada1c3":"def split_text(text, n=10):\n    \"\"\"\n        Splits text into n partitions\n    \"\"\"\n    \n    # Get partition ranges\n    length = len(text)\n    partition_size = math.floor(length\/n)\n    partition = np.arange(0, length, partition_size)\n    \n    # split text\n    text_partition = []\n    for split in range(n):\n        text_partition.append(text[partition[split]:partition[split]+partition_size])\n    return text_partition","734f91a2":"def build_presidents_polarity_transcripts(corpus, n=10):\n    \"\"\"\n        Returns the polarity of the corpus for each president's text\n    \"\"\"\n    \n    polarity_transcripts = {}\n    for president in corpus.index:\n        transcript = corpus.loc[president].transcripts\n        partitioned_text = split_text(transcript, n)\n        polarity_text = list(map(pol, partitioned_text))\n        polarity_transcripts[president] = polarity_text\n    return polarity_transcripts","6e0a282a":"def build_presidents_subjectivity_transcripts(corpus, n=10):\n    \"\"\"\n        Returns the subjectivity of the corpus for each president's text\n    \"\"\"\n    \n    polarity_transcripts = {}\n    for president in corpus.index:\n        transcript = corpus.loc[president].transcripts\n        partitioned_text = split_text(transcript, n)\n        polarity_text = list(map(sub, partitioned_text))\n        polarity_transcripts[president] = polarity_text\n    return polarity_transcripts","aecbe6c0":"def build_party_polarity_transcripts(corpus, n=10):\n    \"\"\"\n        Returns the polarity of the corpus for each party's text\n    \"\"\"\n    \n    polarity_transcripts = {}\n    for party in corpus.index:\n        transcript = corpus.loc[party].transcripts\n        partitioned_text = split_text(transcript, n)\n        polarity_text = list(map(pol, partitioned_text))\n        polarity_transcripts[party] = polarity_text\n    return polarity_transcripts","07dc1c3f":"def build_party_subjectivity_transcripts(corpus, n=10):\n    \"\"\"\n        Returns the subjectivity of the corpus for each party's text\n    \"\"\"\n    \n    polarity_transcripts = {}\n    for party in corpus.index:\n        transcript = corpus.loc[party].transcripts\n        partitioned_text = split_text(transcript, n)\n        polarity_text = list(map(sub, partitioned_text))\n        polarity_transcripts[party] = polarity_text\n    return polarity_transcripts\n\ndef build_party_subjectivity_transcripts(corpus, n=10):\n    \"\"\"\n        Returns the subjectivity of the corpus for each party's text\n    \"\"\"\n    \n    polarity_transcripts = {}\n    for party in corpus.index:\n        transcript = corpus.loc[party].transcripts\n        partitioned_text = split_text(transcript, n)\n        polarity_text = list(map(sub, partitioned_text))\n        polarity_transcripts[party] = polarity_text\n    return polarity_transcripts","92ce4983":"def build_party_corpus(corpus):\n    \"\"\"\n        Returns the corpus of the political parties and their respective transcripts\n    \"\"\"\n    \n    # Build corpus\n    party_texts = []\n    parties = list(set(corpus.Party.values))\n    for party in parties:\n        text = \"\"\n        for row in corpus[corpus.Party == party].itertuples(index=False):\n            text += row[1]\n        party_texts.append(text)\n    party_corpus =  pd.DataFrame({'Party': parties, 'transcripts': party_texts}).set_index('Party')\n    \n    # Include only non-null parties\n    party_order = []\n    parties = ['Democratic', 'Republican', 'Democratic-Republican', 'Whig', 'Federalist', 'Unaffiliated']\n    for party in parties:\n        if party in set(corpus.Party.values):\n            party_order.append(party)\n    party_corpus = party_corpus.reindex(index = party_order)\n    return party_corpus","3060d0d0":"def graph_political_era_polarity(corpus, title, N=10):\n    \n    # Build party corpus\n    party_corpus = build_party_corpus(corpus)\n    \n    # Number of partitions\n    N = 10\n    polarity_transcripts = build_party_polarity_transcripts(party_corpus, N)\n    \n    # Get number of rows necessary and if last subplot needs to be removed\n    delete_last = False\n    row_count = len(polarity_transcripts)\n    if row_count % 2 == 1:\n        delete_last = True\n    while row_count % 2 != 0:\n        row_count += 1\n    row_count \/\/= 2\n        \n    # Plot\n    fig, ax = plt.subplots(row_count, 2, figsize=(12,2.5 + (2.5 * row_count)))\n    fig.suptitle(title, fontsize=16)\n    \n    if row_count == 1:\n        for i, party in enumerate(party_corpus.index):\n            \n            # Label for partition size\n            length = len(party_corpus.loc[party].transcripts)\n            partition_size = math.floor(length\/N)\n            x_label = 'Partitions ({} characters per partition)'.format(partition_size)\n\n            # Plot subplot\n            sns.lineplot(x=range(0, N), y=polarity_transcripts[party], ax=ax[i], color=parties_color[party])\n            ax[i].set(xlabel=x_label, ylabel='<-- Negative ----------- Positive -->')\n            ax[i].set_title(party)        \n    else:\n        i = -1\n        for k, party in enumerate(party_corpus.index):\n            if k % 2 == 0:\n                i += 1\n            j = k % 2\n            \n            # Label for partition size\n            length = len(party_corpus.loc[party].transcripts)\n            partition_size = math.floor(length\/N)\n            x_label = 'Partitions ({} characters per partition)'.format(partition_size)\n            \n            # Plot subplot\n            sns.lineplot(x=range(0, N), y=polarity_transcripts[party], ax=ax[i, j], color=parties_color[party])\n            ax[i, j].set(xlabel=x_label, ylabel='<-- Negative ----------- Positive -->')\n            ax[i, j].set_title(party)\n\n    # Delete unused subplot\n    if delete_last:\n        fig.delaxes(ax[row_count - 1, 1])\n            \n    fig.tight_layout(pad=3)\n    fig.subplots_adjust(top=0.88)","b079655f":"def graph_political_era_subjectivity(corpus, title, N = 10):\n    \n    # Build party corpus\n    party_corpus = build_party_corpus(corpus)\n    \n    # Number of partitions\n    N = 10\n    subjectivity_transcripts = build_party_subjectivity_transcripts(party_corpus, N)\n    \n\n    # Get number of rows necessary and if last subplot needs to be removed\n    delete_last = False\n    row_count = len(subjectivity_transcripts)\n    if row_count % 2 == 1:\n        delete_last = True\n    while row_count % 2 != 0:\n        row_count += 1\n    row_count \/\/= 2\n        \n    # Plot\n    fig, ax = plt.subplots(row_count, 2, figsize=(12,2.5 + (2.5 * row_count)))\n    fig.suptitle(title, fontsize=16)\n    \n    if row_count == 1:\n        for i, party in enumerate(party_corpus.index):\n            \n            # Label for partition size\n            length = len(party_corpus.loc[party].transcripts)\n            partition_size = math.floor(length\/N)\n            x_label = 'Partitions ({} characters per partition)'.format(partition_size)\n\n            # Plot subplot\n            sns.lineplot(x=range(0, N), y=subjectivity_transcripts[party], ax=ax[i], color=parties_color[party])\n            ax[i].set(xlabel=x_label, ylabel='<-- Facts ----------- Opinions -->')\n            ax[i].set_title(party)   \n    else:\n        i = -1\n        for k, party in enumerate(party_corpus.index):\n            if k % 2 == 0:\n                i += 1\n            j = k % 2\n            \n            # Label for partition size\n            length = len(party_corpus.loc[party].transcripts)\n            partition_size = math.floor(length\/N)\n            x_label = 'Partitions (Size: {} characters per partition)'.format(partition_size)\n            \n            # Plot subplot\n            sns.lineplot(x=range(0, N), y=subjectivity_transcripts[party], ax=ax[i, j], color=parties_color[party])\n            ax[i, j].set(xlabel=x_label, ylabel='<-- Facts ----------- Opinions -->')\n            ax[i, j].set_title(party)\n\n    # Delete unused subplot\n    if delete_last:\n        fig.delaxes(ax[row_count - 1, 1])\n            \n    # Add padding between subplots and title\n    fig.tight_layout(pad=3)\n    fig.subplots_adjust(top=0.88)","319bb649":"def graph_political_era_comparison(corpus, title, N = 10):\n    \n    # Build party corpus\n    party_corpus = build_party_corpus(corpus)\n    \n    # Number of partitions\n    N = 10\n    polarity_transcripts = build_party_polarity_transcripts(party_corpus, N)\n    subjectivity_transcripts = build_party_subjectivity_transcripts(party_corpus, N)\n    \n    # Number of parties\n    party_count = len(party_corpus)\n        \n    # Plot\n    fig, ax = plt.subplots(party_count + 1, 2, figsize=(12, 10 + (2.5 * party_count)))\n    fig.suptitle(title, fontsize=16)\n    \n    # Individual Plots\n    for i, party in enumerate(party_corpus.index):\n        # Label for partition size\n        length = len(party_corpus.loc[party].transcripts)\n        partition_size = math.floor(length\/N)\n        x_label = 'Partitions ({} characters per partition)'.format(partition_size)\n        \n        # Plot polarity subplot\n        sns.lineplot(x=range(0, N), y=polarity_transcripts[party], ax=ax[i, 0], color=parties_color[party])\n        ax[i, 0].set(xlabel=x_label, ylabel='<-- Negative ------ Positive -->')\n        ax[i, 0].set_title(party + \" (polarity)\")  \n        \n        # Plot subjectivity subplot\n        sns.lineplot(x=range(0, N), y=subjectivity_transcripts[party], ax=ax[i, 1], color=parties_color[party])\n        ax[i, 1].set(xlabel=x_label, ylabel='<-- Facts ------ Opinions -->')\n        ax[i, 1].set_title(party + \" (subjectivity)\") \n        \n    # Comparison Plots\n    for i, party in enumerate(party_corpus.index):\n        # Label for partition size\n        length = len(party_corpus.loc[party].transcripts)\n        partition_size = math.floor(length\/N)\n        x_label = 'Partitions ({} characters per partition)'.format(partition_size)\n        \n        # Plot polarity subplot\n        sns.lineplot(x=range(0, N), y=polarity_transcripts[party], ax=ax[party_count, 0], color=parties_color[party], label=party)\n        ax[party_count, 0].set(xlabel=x_label, ylabel='<-- Negative ------ Positive -->')\n        ax[party_count, 0].set_title(\"Polarity Comparison\")  \n        \n        # Plot subjectivity subplot\n        sns.lineplot(x=range(0, N), y=subjectivity_transcripts[party], ax=ax[party_count, 1], color=parties_color[party], label=party)\n        ax[party_count, 1].set(xlabel=x_label, ylabel='<-- Facts ------ Opinions -->')\n        ax[party_count, 1].set_title(\"Subjectivity Comparison\") \n            \n    # Add padding between subplots and title\n    fig.tight_layout(pad=3)\n    fig.subplots_adjust(top=0.88)","ef514453":"# Load corpuses\ncorpus = pd.read_csv('\/kaggle\/input\/united-states-presidential-speeches\/corpus.csv')\nfirst_party_corpus = pd.read_csv('\/kaggle\/input\/united-states-presidential-speeches\/first_party_corpus.csv')\nsecond_party_corpus = pd.read_csv('\/kaggle\/input\/united-states-presidential-speeches\/second_party_corpus.csv')\nthird_party_corpus = pd.read_csv('\/kaggle\/input\/united-states-presidential-speeches\/third_party_corpus.csv')\nfourth_party_corpus = pd.read_csv('\/kaggle\/input\/united-states-presidential-speeches\/fourth_party_corpus.csv')\nfifth_party_corpus = pd.read_csv('\/kaggle\/input\/united-states-presidential-speeches\/fifth_party_corpus.csv')\nsixth_party_corpus = pd.read_csv('\/kaggle\/input\/united-states-presidential-speeches\/sixth_party_corpus.csv')","326251a2":"# Fix indicies\ncorpus = corpus.rename(columns={'Unnamed: 0':'President'}).set_index('President')\nfirst_party_corpus = first_party_corpus.rename(columns={'Unnamed: 0':'President'}).set_index('President')\nsecond_party_corpus = second_party_corpus.rename(columns={'Unnamed: 0':'President'}).set_index('President')\nthird_party_corpus = third_party_corpus.rename(columns={'Unnamed: 0':'President'}).set_index('President')\nfourth_party_corpus = fourth_party_corpus.rename(columns={'Unnamed: 0':'President'}).set_index('President')\nfifth_party_corpus = fifth_party_corpus.rename(columns={'Unnamed: 0':'President'}).set_index('President')\nsixth_party_corpus = sixth_party_corpus.rename(columns={'Unnamed: 0':'President'}).set_index('President')","a07d933d":"# Find polarity and subjectivity of texts for each president\npol = lambda x: TextBlob(x).sentiment.polarity\nsub = lambda x: TextBlob(x).sentiment.subjectivity\n\ncorpus['pol'] = corpus.transcripts.apply(pol)\ncorpus['subj'] = corpus.transcripts.apply(sub)\n\ncorpus","7acd552f":"# Plot\nfig, ax = plt.subplots(figsize=(20,12))\nsns.scatterplot(x=corpus.pol.values, y=corpus.subj.values)\n\ntexts = [ax.text(corpus.pol.values[line], corpus.subj.values[line], corpus.index[line], horizontalalignment='center', size='large', color='black', weight='semibold') for line in range(0,corpus.shape[0])]\nadjust_text(texts, arrowprops=dict(arrowstyle='->', color='red'))\n\nplt.title('Sentiment Analysis', fontsize=20)\nplt.xlabel('<-- Negative ------------------------ Positive -->', fontsize=15)\nplt.ylabel('<-- Facts ------------------------ Opinions -->', fontsize=15)\n\nplt.show()","0aacf7eb":"# Party coloring\nparties_color = {\n            'Democratic': 'blue',\n            'Democratic-Republican': 'green',\n            'Federalist': 'orange',\n            'Republican': 'red',\n            'Unaffiliated': 'black',\n            'Whig': 'purple'\n          }\n\n# Plot speeches per year\nfig, ax = plt.subplots(figsize=(20,12))\n\ntexts = []\n\n# Democratic\nparty_corpus = corpus[corpus['Party'] == 'Democratic']\nsns.scatterplot(x=party_corpus.pol.values, y=party_corpus.subj.values, label='Democratic')\ntexts += [ax.text(party_corpus.pol.values[line], party_corpus.subj.values[line], party_corpus.index[line], horizontalalignment='center', size='large', color=parties_color['Democratic'], weight='semibold') for line in range(0,party_corpus.shape[0])]\n#adjust_text(texts, arrowprops=dict(arrowstyle='->', color='blue'))\n\n# Democratic-Republican\nparty_corpus = corpus[corpus['Party'] == 'Democratic-Republican']\nsns.scatterplot(x=party_corpus.pol.values, y=party_corpus.subj.values, label='Democratic-Republican')\ntexts += [ax.text(party_corpus.pol.values[line], party_corpus.subj.values[line], party_corpus.index[line], horizontalalignment='center', size='large', color=parties_color['Democratic-Republican'], weight='semibold') for line in range(0,party_corpus.shape[0])]\n#adjust_text(texts, arrowprops=dict(arrowstyle='->', color='green'))\n\n# Federalist\nparty_corpus = corpus[corpus['Party'] == 'Federalist']\nsns.scatterplot(x=party_corpus.pol.values, y=party_corpus.subj.values, label='Federalist')\ntexts += [ax.text(party_corpus.pol.values[line], party_corpus.subj.values[line], party_corpus.index[line], horizontalalignment='center', size='large', color=parties_color['Federalist'], weight='semibold') for line in range(0,party_corpus.shape[0])]\n#adjust_text(texts, arrowprops=dict(arrowstyle='->', color='orange'))\n\n# Republican\nparty_corpus = corpus[corpus['Party'] == 'Republican']\nsns.scatterplot(x=party_corpus.pol.values, y=party_corpus.subj.values, label='Republican')\ntexts += [ax.text(party_corpus.pol.values[line], party_corpus.subj.values[line], party_corpus.index[line], horizontalalignment='center', size='large', color=parties_color['Republican'], weight='semibold') for line in range(0,party_corpus.shape[0])]\n#adjust_text(texts, arrowprops=dict(arrowstyle='->', color='red'))\n\n# Unaffiliated\nparty_corpus = corpus[corpus['Party'] == 'Unaffiliated']\nsns.scatterplot(x=party_corpus.pol.values, y=party_corpus.subj.values, label='Unaffiliated')\ntexts += [ax.text(party_corpus.pol.values[line], party_corpus.subj.values[line], party_corpus.index[line], horizontalalignment='center', size='large', color=parties_color['Unaffiliated'], weight='semibold') for line in range(0,party_corpus.shape[0])]\n#adjust_text(texts, arrowprops=dict(arrowstyle='->', color='black'))\n\n# Whig\nparty_corpus = corpus[corpus['Party'] == 'Whig']\nsns.scatterplot(x=party_corpus.pol.values, y=party_corpus.subj.values, label='Whig')\ntexts += [ax.text(party_corpus.pol.values[line], party_corpus.subj.values[line], party_corpus.index[line], horizontalalignment='center', size='large', color=parties_color['Whig'], weight='semibold') for line in range(0,party_corpus.shape[0])]\n\nadjust_text(texts, arrowprops=dict(arrowstyle='->', color='black'))\nplt.title('Sentiment Analysis', fontsize=20)\nplt.xlabel('<-- Negative ------------------------ Positive -->', fontsize=15)\nplt.ylabel('<-- Facts ------------------------ Opinions -->', fontsize=15)\n\nplt.show()","1c022c56":"# Number of partitions\nN = 10\npolarity_transcripts = build_presidents_polarity_transcripts(corpus, N)\nsubjectivity_transcripts = build_presidents_subjectivity_transcripts(corpus, N)","205c4f6a":"# Plots\nfig, ax = plt.subplots(11, 4, figsize=(15,40))\n\ni = -1\nfor k, president in enumerate(corpus.index):\n    if k % 4 == 0:\n        i += 1\n    j = k % 4\n    sns.lineplot(x=range(0, N), y=polarity_transcripts[president], ax=ax[i, j], color=parties_color[corpus.loc[president].Party])\n    ax[i, j].set(xlabel=president, ylabel='<-- Negative ------------------------ Positive -->')\n\nfig.tight_layout()","43184aff":"# Build party corpus\nparty_corpus = build_party_corpus(corpus)\nparty_corpus = party_corpus.reset_index()\n\n# Plot polarity and subjectivity\ngraph_political_era_polarity(party_corpus, 'Polarity of Political Parties')\ngraph_political_era_subjectivity(party_corpus, 'Subjectivity of Political Parties')","0f0bf070":"# Find polarity and subjectivity of texts for each political era\n\n# First party system\nfirst_party_corpus['pol'] = first_party_corpus.transcripts.apply(pol)\nfirst_party_corpus['subj'] = first_party_corpus.transcripts.apply(sub)\n\n# Second party system\nsecond_party_corpus['pol'] = second_party_corpus.transcripts.apply(pol)\nsecond_party_corpus['subj'] = second_party_corpus.transcripts.apply(sub)\n\n# Third party system\nthird_party_corpus['pol'] = third_party_corpus.transcripts.apply(pol)\nthird_party_corpus['subj'] = third_party_corpus.transcripts.apply(sub)\n\n# Fourth party system\nfourth_party_corpus['pol'] = fourth_party_corpus.transcripts.apply(pol)\nfourth_party_corpus['subj'] = fourth_party_corpus.transcripts.apply(sub)\n\n# Fifth party system\nfifth_party_corpus['pol'] = fifth_party_corpus.transcripts.apply(pol)\nfifth_party_corpus['subj'] = fifth_party_corpus.transcripts.apply(sub)\n\n# Sixth party system\nsixth_party_corpus['pol'] = sixth_party_corpus.transcripts.apply(pol)\nsixth_party_corpus['subj'] = sixth_party_corpus.transcripts.apply(sub)","0f39553c":"party_system_corpuses = [\n                            first_party_corpus, \n                            second_party_corpus,\n                            third_party_corpus,\n                            fourth_party_corpus,\n                            fifth_party_corpus,\n                            sixth_party_corpus\n                        ]\n\nparty_system_titles = [\n                            'First Party System (1792\u20131824)',\n                            'Second Party System (1828\u20131854)',\n                            'Third Party System (1854\u20131895)',\n                            'Fourth Party System (1896\u20131932)',\n                            'Fifth Party System (1932\u20131964)',\n                            'Sixth Party System (1964\u2013present)'\n                        ]\n\ngraph_political_era_tuples = list(zip(party_system_corpuses, party_system_titles))","ec608a8d":"for corpus, title in graph_political_era_tuples:\n    graph_political_era_polarity(corpus, title)","4aa3f6b3":"for corpus, title in graph_political_era_tuples:\n    graph_political_era_subjectivity(corpus, title)","db8aaf9a":"# Modify titles for comparisons\nparty_system_titles_comparison = [party + ' Comparison' for party in party_system_titles]\ngraph_political_era_comparison_tuples = list(zip(party_system_corpuses, party_system_titles_comparison))\n\nfor corpus, title in graph_political_era_comparison_tuples:\n    graph_political_era_comparison(corpus, title)","2083e956":"### Plot Comparisons of Polarity and Subjectivty of Parties of Different Political Eras\n","0991c58d":"## Load Data","d6eaf9d9":"## Helper Functions","1d87ba16":"## Polarity of Subjectivity of Presidents\n","72b77bd5":"## Polarity of Presidents Over Time\n","ff672424":"## Polarity and Subjectivity of Political Parties Over Political Eras\n","300205d3":"### Plot Polarity\n","37ed21a0":"## Polarity and Subjectivity of Political Parties Over Time\n","0db007c2":"### Plot Subjectivity\n"}}