{"cell_type":{"2cac32de":"code","b50264e3":"code","e7506ff7":"code","4897a012":"code","2a5fc1aa":"code","9c440a94":"code","85f1b325":"code","e369d1cb":"code","6d6595df":"code","62a28a13":"code","6b2eb03c":"code","23c63ac9":"code","fd7d94b5":"code","b7550d18":"code","2a503cbc":"code","6b3d1f88":"code","b6a4c274":"code","3788216f":"code","4df1b3c0":"code","656a6119":"code","20b21ab1":"code","02a9eeca":"code","01c279c1":"code","e32a6e93":"code","c0af3503":"code","50fec433":"code","955cfea8":"code","0359d116":"code","576104bd":"code","6a558bcd":"code","8eea9a24":"code","463950fe":"code","b1ccd21a":"code","cb625839":"code","6119f9bd":"code","d044de45":"markdown","ba98026d":"markdown","5c627961":"markdown","78ba0409":"markdown","fef74497":"markdown"},"source":{"2cac32de":"#import os\n#os.environ['KAGGLE_USERNAME'] = \"\" #USERNAME\n#os.environ['KAGGLE_KEY'] = \"\" #PASSWORD","b50264e3":"#!kaggle datasets download -d balatmak\/newsgroup20bbcnews","e7506ff7":"#!unzip -q newsgroup20bbcnews.zip -d .","4897a012":"import pandas as pd\n#df = p.read_csv('bbc-text.csv') if youre using Google colab\ndf = pd.read_csv('..\/input\/newsgroup20bbcnews\/bbc-text.csv')","2a5fc1aa":"import nltk\nnltk.download('stopwords')","9c440a94":"import numpy as np # linear algebra\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom keras.utils.np_utils import to_categorical\nfrom keras.callbacks import EarlyStopping\nimport re\nfrom nltk.corpus import stopwords\nfrom nltk import word_tokenize\nSTOPWORDS = set(stopwords.words('english'))","85f1b325":"df.head()","e369d1cb":"df.dtypes","6d6595df":"df.isnull().sum()","62a28a13":"df['category'].value_counts()","6b2eb03c":"sns.countplot(df['category'])","23c63ac9":"df['text'][11]","fd7d94b5":"space = re.compile('[\/(){}\\[\\]\\|@,;]')\nsymbols= re.compile('[^0-9a-z #+_]')\nSTOPWORDS = set(stopwords.words('english'))\n\ndef clean_text(text):\n    text = text.lower() # lowercase text\n    text = space.sub(' ', text) # replace REPLACE_BY_SPACE_RE symbols by space in text. substitute the matched string in REPLACE_BY_SPACE_RE with space.\n    text = symbols.sub('', text) # remove symbols which are in BAD_SYMBOLS_RE from text. substitute the matched string in BAD_SYMBOLS_RE with nothing. \n    text = text.replace('x', '')\n#    text = re.sub(r'\\W+', '', text)\n    text = ' '.join(word for word in text.split() if word not in STOPWORDS) # remove stopwors from text\n    return text","b7550d18":"df['text']=df['text'].apply(clean_text)","2a503cbc":"df['text'][11]","6b3d1f88":"g=[]\nfor i in df['text']:\n    g.append(i)","b6a4c274":"len(g)","3788216f":"maxl = max([len(s) for s in g])\nprint ('Maximum sequence length in the list of sentences:', maxl)","4df1b3c0":"kategori = pd.get_dummies(df.category)\ndf_ohe = pd.concat([df, kategori], axis=1)\ndf_ohe = df_ohe.drop(columns='category')\ndf_ohe","656a6119":"judul = df_ohe['text'].values\nlabel = df_ohe[['business', 'entertainment', 'politics', 'sport','tech']].values","20b21ab1":"from sklearn.model_selection import train_test_split\njudul_latih, judul_test, label_latih, label_test = train_test_split(judul, label, test_size=0.2)","02a9eeca":"from tensorflow.keras.preprocessing.text import Tokenizer\nfrom tensorflow.keras.preprocessing.sequence import pad_sequences\n \ntokenizer = Tokenizer(num_words=50000, \n                      filters='!\"#$%&()*+,-.\/:;<=>?@[\\]^_`{|}~',\n                      lower=True)\ntokenizer.fit_on_texts(judul_latih) \ntokenizer.fit_on_texts(judul_test)\n \nsekuens_latih = tokenizer.texts_to_sequences(judul_latih)\nsekuens_test = tokenizer.texts_to_sequences(judul_test)\n \npadded_latih = pad_sequences(sekuens_latih, maxlen=3000) \npadded_test = pad_sequences(sekuens_test, maxlen=3000)\nword_index = tokenizer.word_index\nprint('Found %s unique tokens.' % len(word_index))","01c279c1":"import tensorflow as tf\noptimizer= tf.keras.optimizers.Adam(lr=0.01)\nmodel = tf.keras.Sequential([\n    tf.keras.layers.Embedding(50000,200,input_length=3000),\n    tf.keras.layers.SpatialDropout1D(0.4),\n    tf.keras.layers.Bidirectional(tf.keras.layers.LSTM(50)),\n    #tf.keras.layers.LSTM(32),\n    #tf.keras.layers.Flatten(),\n    #tf.keras.layers.Dropout(0.5),\n    #tf.keras.layers.Dense(64, kernel_initializer='lecun_normal' ,activation='selu'),\n    #tf.keras.layers.Dropout(0.2),\n    #tf.keras.layers.Dense(32, kernel_initializer='lecun_normal' ,activation='selu'),\n    tf.keras.layers.Dropout(0.1),\n    #tf.keras.layers.Dense(50, activation='relu'),\n    #tf.keras.layers.Dropout(0.1),\n    tf.keras.layers.Dense(5, activation='softmax')\n])\nmodel.compile(loss='categorical_crossentropy',optimizer=optimizer,metrics=['accuracy'])","e32a6e93":"stop=0.91\nclass interupsi(tf.keras.callbacks.Callback):\n  def on_epoch_end(self, epoch, logs={}):\n    if(logs.get('accuracy') > stop):\n      print(\"\\n %2.3f%% accuracy, Great.\"%(stop*100))\n      self.model.stop_training = True","c0af3503":"callbacks = interupsi()","50fec433":"model.summary()","955cfea8":"num_epochs = 40\nhistory = model.fit(\n              padded_latih,\n              label_latih,\n              #steps_per_epoch=20,\n              batch_size=64,\n              epochs=num_epochs, \n              validation_data=(padded_test, label_test),\n              #validation_steps=5,\n              callbacks=[callbacks],\n              #callbacks=[EarlyStopping(monitor='val_loss',\n              #                         patience=3,\n              #                         min_delta=0.0001)],\n              verbose=1)","0359d116":"accr = model.evaluate(padded_test,label_test)\nprint('Test set\\n  Loss: {:0.3f}\\n  Accuracy: {:0.3f}'.format(accr[0],accr[1]))","576104bd":"plt.title('Loss')\nplt.plot(history.history['loss'], label='train')\nplt.plot(history.history['val_loss'], label='test')\nplt.legend()\nplt.show();","6a558bcd":"plt.title('Accuracy')\nplt.plot(history.history['accuracy'], label='train')\nplt.plot(history.history['val_accuracy'], label='test')\nplt.legend()\nplt.show();","8eea9a24":"new_complaint = ['Cricket Australia is set to begin the team\u2019s pre-season later this month under a set of new training protocols devised for the safety of players amid the COVID-19 pandemic.']\nseq = tokenizer.texts_to_sequences(new_complaint)\npadded = pad_sequences(seq, maxlen=3000)\npred = model.predict(padded)\nlabels = ['Business','Entertainment','Politics','Sports','Tech']\nprint(pred, labels[np.argmax(pred)])","463950fe":"new_complaint = ['Flipkart revealed the different items that Indians are looking for on the e-commerce site, as relaxing lockdown restrictions allow shopping to start again. Self-care and items to help work from home top the list, according to the e-commerce giant. ']\nseq = tokenizer.texts_to_sequences(new_complaint)\npadded = pad_sequences(seq, maxlen=3000)\npred = model.predict(padded)\nlabels = ['Business','Entertainment','Politics','Sports','Tech']\nprint(pred, labels[np.argmax(pred)])","b1ccd21a":"new_complaint =['Additionally, the microsite on Amazon.in highlights some of the key features of the Mi 10. It shows that the phone will come with a 108-megapixel primary camera that will have optical image stabilisation (OIS) and 8K video recording. The microsite also claims that the Mi 10 will carry the worlds fastest wireless charging and include Qualcomm Snapdragon 865 SoC. You can also expect a 3D curved TrueColor E3 AMOLED display with a Corning Gorilla Glass protection on top and stereo speakers.']\nseq = tokenizer.texts_to_sequences(new_complaint)\npadded = pad_sequences(seq, maxlen=3000)\npred = model.predict(padded)\nlabels = ['Business','Entertainment','Politics','Sports','Tech']\nprint(pred, labels[np.argmax(pred)])","cb625839":"new_complaint = ['Having undergone a surgery for shoulder dislocation last month, young Australian pacer Jhye Richardson is hopeful of recovering from the recurring injury by the time cricketing action resumes. Cricket Australias chief medical officer Alex Kountouris sounded optimistic of the fast bowlers recovery process with respect to a comeback later this year.Its a lengthy surgery but it does give him an opportunity now that were not going to play until ... September, October, November or December ... hes obviously a chance with that, Kountouris told News Corp in an interaction.']\nseq = tokenizer.texts_to_sequences(new_complaint)\npadded = pad_sequences(seq, maxlen=3000)\npred = model.predict(padded)\nlabels = ['Business','Entertainment','Politics','Sports','Tech']\nprint(pred, labels[np.argmax(pred)])","6119f9bd":"new_complaint = ['Samsung is making cutting edge chips by using artificial intelligence. The South Korean company has partnered with Synopsys, a leading chip design software firm, to create the new AI-powered features in their latest line of computer processor designs']\nseq = tokenizer.texts_to_sequences(new_complaint)\npadded = pad_sequences(seq, maxlen=3000)\npred = model.predict(padded)\nlabels = ['Business','Entertainment','Politics','Sports','Tech']\nprint(pred, labels[np.argmax(pred)])","d044de45":"One Hot Encoding to create labels by category","ba98026d":"if youre using google colab, use the cell above to download your dataset using API command, the password is your API token. Go to Account and scroll till API.","5c627961":"UP VOTE!! :))))\ngod, gimme a job :)\nhttps:\/\/www.linkedin.com\/in\/muhamad-rialdy-854735217\/ (my linkedin)\nif you are an employee in a company and are looking for a new employee, it will be very helpful if you recommend me as a candidate. Work location in the Greater Jakarta area, Indonesia\ngimme a feedback, thanks in advance!\n","78ba0409":"download the dataset using API command","fef74497":"clean_text function used to normalize the text on dataset, read the comment for details"}}