{"cell_type":{"fbdb1abb":"code","4169693c":"code","71b71d79":"code","f78ac029":"code","78c73c52":"code","90c20a2f":"code","c7e16581":"code","1da683fe":"code","ad57958b":"code","833cb7de":"code","6b69f5d4":"code","6bfb8926":"code","2351fe58":"code","12b0f385":"code","cccc88af":"code","e4130254":"code","52a043e8":"code","127e4559":"code","edd1bc08":"code","0761471e":"code","7cf90b10":"code","38e7e72a":"code","b09eab93":"code","a28f6de6":"code","67af7df3":"code","e9b38f3c":"code","d965ccf8":"code","976b2852":"code","a440fd2f":"code","a769b957":"code","1f0b6cd8":"code","39d34e9a":"code","e7d7470e":"code","dee3ec43":"code","75694a36":"code","0b646486":"code","951f7bcf":"code","4422b6b2":"code","7d2c5f66":"code","c9cd75a2":"code","c8a45456":"code","88410f00":"code","105fd942":"markdown","25666cf0":"markdown","33406281":"markdown","8a0755c5":"markdown","c3e84637":"markdown","1b179841":"markdown","738ae22d":"markdown","f35a3aa5":"markdown","bb4ded67":"markdown","a2a8aecf":"markdown","b03f9c42":"markdown","ea83d33e":"markdown"},"source":{"fbdb1abb":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","4169693c":"import matplotlib.pyplot as plt\nimport seaborn as sns\nfrom IPython.display import display, HTML\n\nsns.set_style(\"darkgrid\")","71b71d79":"data = pd.read_csv(\"\/kaggle\/input\/insurance\/insurance.csv\")","f78ac029":"data.shape","78c73c52":"data.head()","90c20a2f":"data.isnull().sum()","c7e16581":"plt.figure(figsize=(15,8))\n\nplt.subplot(1,2,1)\nsns.distplot(data[data[\"sex\"]==\"female\"][\"age\"])\nplt.title(\"Female age distribution\")\n\nplt.subplot(1,2,2)\nsns.distplot(data[data[\"sex\"]==\"male\"][\"age\"])\nplt.title(\"Male age distribution\")\n\nplt.show()","1da683fe":"temp = data.groupby(\"sex\").mean()[\"bmi\"]\nprint(\"Average BMI : \\n a) Male : {}\\n b) Female : {}\".format(temp[\"male\"], temp[\"female\"]))","ad57958b":"plt.figure(figsize=(10,8))\nsns.distplot(data[\"bmi\"])","833cb7de":"plt.figure(figsize=(15,8))\n\nplt.subplot(1,2,1)\nsns.scatterplot(data=data[data[\"sex\"]==\"female\"], x=\"age\", y=\"bmi\", hue=\"region\")\nplt.title(\"Female bmi distribution\")\n\nplt.subplot(1,2,2)\nsns.scatterplot(data=data[data[\"sex\"]==\"male\"], x=\"age\", y=\"bmi\", hue=\"region\")\nplt.title(\"Male bmi distribution\")\n\nplt.show()","6b69f5d4":"temp = data.groupby([\"region\", \"sex\"]).agg({\"bmi\": [\"count\", \"max\", \"min\", \"mean\"]})\ntemp","6bfb8926":"plt.figure(figsize=(12,5))\nplt.title(\"Box plot according to bmi >=30\")\nsns.boxplot(y=\"sex\", x=\"charges\", data = data[data[\"bmi\"]>=30])","2351fe58":"plt.figure(figsize=(12,5))\nplt.title(\"Box plot according to bmi\")\nsns.boxplot(y=\"sex\", x=\"charges\", data = data[data[\"bmi\"]<=18.5])","12b0f385":"sns.scatterplot(data=data, x=\"bmi\", y=\"charges\", hue=\"smoker\")  # This is very important feature","cccc88af":"sns.catplot(data=data, x=\"smoker\",kind=\"count\",hue = 'sex')","e4130254":"plt.figure(figsize=(12,5))\nplt.title(\"Box plot according to Sex\")\nsns.boxplot(y=\"sex\", x=\"charges\", data = data)","52a043e8":"plt.figure(figsize=(15,8))\n\nplt.subplot(1,2,1)\nsns.distplot(data[data[\"smoker\"]==\"yes\"][\"bmi\"])\nplt.title(\"Smoker bmi distribution\")\n\nplt.subplot(1,2,2)\nsns.distplot(data[data[\"smoker\"]==\"no\"][\"bmi\"])\nplt.title(\"Non smoker bmi distribution\")\n\nplt.show()","127e4559":"sns.catplot(data=data[data.age<=18], x=\"smoker\",kind=\"count\",hue = 'sex')\nplt.title(\"Smoker vs Non smoker Kids\")","edd1bc08":"plt.figure(figsize=(12,5))\nplt.title(\"Cost pay by 18 years old's\")\nsns.boxplot(y=\"smoker\", x=\"charges\", data = data[(data.age <= 18)])","0761471e":"sns.jointplot(data = data[(data.smoker == \"no\")],x=\"age\", y=\"charges\",kind=\"kde\")\nplt.title(\"Non-Smoker charges distribution\")\nplt.show()","7cf90b10":"sns.jointplot(data = data[(data.smoker == \"yes\")],x=\"age\", y=\"charges\",kind=\"kde\")\nplt.title(\"Smoker charges distribution\")   ","38e7e72a":"# assumptions :\n# having no childern age is less than 27 are unmarried \n\nmarried = []\nfor i in range(len(data)):\n    if data[\"age\"].iloc[i]<=27 and data[\"children\"].iloc[i]==0: married.append(False)\n    else: married.append(True)\ndata[\"married\"] = married","b09eab93":"sns.catplot(data=data, x=\"married\",kind=\"count\",hue = 'smoker')","a28f6de6":"plt.figure(figsize=(12,5))\nplt.title(\"Box plot according to married\")\nsns.boxplot(y=\"charges\", x=\"married\", data = data)","67af7df3":"sns.catplot(data=data, x=\"smoker\", kind=\"count\", hue=\"region\")","e9b38f3c":"sns.catplot(data=data, x=\"children\", kind=\"count\", hue=\"region\")","d965ccf8":"plt.figure(figsize=(12,5))\nplt.title(\"Box plot according to region\")\nsns.boxplot(y=\"region\", x=\"charges\", data = data)","976b2852":"from sklearn.preprocessing import LabelEncoder\n#sex\nle = LabelEncoder()\nle.fit(data.sex.drop_duplicates()) \ndata.sex = le.transform(data.sex)\n# smoker or not\nle.fit(data.smoker.drop_duplicates()) \ndata.smoker = le.transform(data.smoker)\n#region\nle.fit(data.region.drop_duplicates()) \ndata.region = le.transform(data.region)\n#married\nle.fit(data.married.drop_duplicates()) \ndata.married = le.transform(data.married)","a440fd2f":"data.head()","a769b957":"plt.figure(figsize=(10,5))\nsns.heatmap(data.corr(), annot=True, linewidths=0.3, cmap=\"coolwarm\")","1f0b6cd8":"import math\nfrom sklearn.preprocessing import PolynomialFeatures, StandardScaler\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LinearRegression, Ridge, Lasso, ElasticNet\nfrom sklearn.metrics import mean_squared_error\nfrom sklearn.metrics import r2_score\n\nfrom sklearn.tree import DecisionTreeRegressor\nfrom sklearn.ensemble import RandomForestRegressor","39d34e9a":"y= data[\"charges\"]\ndata = data.drop(\"charges\", axis=1)\ntrain, test , y_train, y_test = train_test_split(data, y, train_size=0.8)","e7d7470e":"model = LinearRegression(normalize=True)\nhistory = model.fit(train, y_train)\ntrain_predict = model.predict(train)\npredict = model.predict(test)\nr2_score_linear_test = r2_score(y_test,predict)\nr2_score_linear_train = r2_score(y_train,train_predict)\nrmse_linear = math.sqrt(mean_squared_error(y_test, predict))\nprint(\"Mean squared error : \",mean_squared_error(y_test, predict))\nprint(\"Root MSE : \",rmse_linear)\nprint(\"R2 score on train : {} and on test : {} \".format(r2_score_linear_train, r2_score_linear_test))","dee3ec43":"model = Ridge(alpha=.05)\nhistory = model.fit(train, y_train)\ntrain_predict = model.predict(train)\npredict = model.predict(test)\nr2_score_ridge_test = r2_score(y_test,predict)\nr2_score_ridge_train = r2_score(y_train,train_predict)\nrmse_ridge = math.sqrt(mean_squared_error(y_test, predict))\nprint(\"Mean squared error : \",mean_squared_error(y_test, predict))\nprint(\"Root MSE : \",rmse_ridge)\nprint(\"R2 score on train : {} and on test : {} \".format(r2_score_ridge_train, r2_score_ridge_test))","75694a36":"model = Lasso(alpha=.05)\nhistory = model.fit(train, y_train)\ntrain_predict = model.predict(train)\npredict = model.predict(test)\nr2_score_lasso_test = r2_score(y_test,predict)\nr2_score_lasso_train = r2_score(y_train,train_predict)\nrmse_lasso = math.sqrt(mean_squared_error(y_test, predict))\nprint(\"Mean squared error : \",mean_squared_error(y_test, predict))\nprint(\"Root MSE : \",rmse_lasso)\nprint(\"R2 score on train : {} and on test : {} \".format(r2_score_lasso_train, r2_score_lasso_test))","0b646486":"model = ElasticNet()\nhistory = model.fit(train, y_train)\ntrain_predict = model.predict(train)\npredict = model.predict(test)\nr2_score_elastic_test = r2_score(y_test,predict)\nr2_score_elastic_train = r2_score(y_train,train_predict)\nrmse_elastic = math.sqrt(mean_squared_error(y_test, predict))\nprint(\"Mean squared error : \",mean_squared_error(y_test, predict))\nprint(\"Root MSE : \",rmse_elastic)\nprint(\"R2 score on train : {} and on test : {} \".format(r2_score_elastic_train, r2_score_elastic_test))","951f7bcf":"poly_reg = PolynomialFeatures(degree = 2)\nx_poly = poly_reg.fit_transform(data)\nx_train_poly = poly_reg.fit_transform(train)\npoly_reg.fit(x_train_poly, y_train)\n\nregressor_poly2 = LinearRegression()\nregressor_poly2.fit(x_train_poly, y_train)\n\ntrain_predict = regressor_poly2.predict(poly_reg.fit_transform(train))\npredict = regressor_poly2.predict(poly_reg.fit_transform(test))\n\nr2_score_poly2_train = r2_score(y_train, train_predict)\nr2_score_poly2_test = r2_score(y_test, predict)\nrmse_poly2 = (np.sqrt(mean_squared_error(y_test, predict)))\nprint(\"Mean squared error : \",mean_squared_error(y_test, predict))\nprint(\"Root MSE : \",rmse_poly2)\nprint(\"R2 score on train : {} and on test : {} \".format(r2_score_poly2_train, r2_score_poly2_test))","4422b6b2":"model = DecisionTreeRegressor(criterion='mse', max_depth=5, min_samples_leaf=10, min_samples_split=2)\nhistory = model.fit(train, y_train)\ntrain_predict = model.predict(train)\npredict = model.predict(test)\nr2_score_dt_test = r2_score(y_test,predict)\nr2_score_dt_train = r2_score(y_train,train_predict)\nrmse_dt = math.sqrt(mean_squared_error(y_test, predict))\nprint(\"Mean squared error : \",mean_squared_error(y_test, predict))\nprint(\"Root MSE : \",rmse_dt)\nprint(\"R2 score on train : {} and on test : {} \".format(r2_score_dt_train, r2_score_dt_test))","7d2c5f66":"model = RandomForestRegressor(bootstrap=True, criterion='mse', max_depth=50,\n                              max_features='auto', min_samples_leaf=10, min_samples_split=7, n_estimators=1200)\nhistory = model.fit(train, y_train)\ntrain_predict = model.predict(train)\npredict = model.predict(test)\nr2_score_rf_test = r2_score(y_test,predict)\nr2_score_rf_train = r2_score(y_train,train_predict)\nrmse_rf = math.sqrt(mean_squared_error(y_test, predict))\nprint(\"Mean squared error : \",mean_squared_error(y_test, predict))\nprint(\"Root MSE : \",rmse_rf)\nprint(\"R2 score on train : {} and on test : {} \".format(r2_score_rf_train, r2_score_rf_test))","c9cd75a2":"models = [('Linear Regression', rmse_linear, r2_score_linear_train, r2_score_linear_test),\n          ('Polynomial Regression (2nd)', rmse_poly2, r2_score_poly2_train, r2_score_poly2_test),\n          ('Ridge Regression', rmse_ridge, r2_score_ridge_train, r2_score_ridge_test),\n          ('Lasso Regression', rmse_lasso, r2_score_lasso_train, r2_score_lasso_test),\n          ('Elastic Net Regression', rmse_elastic, r2_score_elastic_train, r2_score_elastic_test),\n          ('Decision Tree Regression', rmse_dt, r2_score_dt_train, r2_score_dt_test),\n          ('Random Forest Regression', rmse_rf, r2_score_rf_train, r2_score_rf_test)   \n         ]\npredict = pd.DataFrame(data = models, columns=['Model', 'RMSE', 'R2_Score(training)', 'R2_Score(test)'])","c8a45456":"predict","88410f00":"f, axe = plt.subplots(1,1, figsize=(12,6))\n\npredict.sort_values(by=['R2_Score(test)'], ascending=False, inplace=True)\n\nsns.barplot(x='R2_Score(test)', y='Model', data = predict, ax = axe, palette='inferno')\naxe.set_xlabel('R2_Score(test)', size=16)\naxe.set_ylabel('Model')\naxe.set_xlim(0,1.0)\naxe.set_xticks(np.arange(0, 1.1, 0.1))\nplt.show()","105fd942":"For overweight","25666cf0":"According to Google :\n\n![image.png](attachment:image.png)\n\nCharges distribution in people according to bmi index.","33406281":"# Smokers","8a0755c5":"So male usually spend more then female on their health issues.","c3e84637":"For underweight","1b179841":"Steady growth in charges, I think it's natural.","738ae22d":"# Region","f35a3aa5":"I am interseted in cost of medical of teenagers.","bb4ded67":"Here we can see that money spend by people who smoke are higher then the non-smokers, but there are some cases where we can see that non somkers spend money more then usual this might be due to some diseases etc.","a2a8aecf":"# BMI","b03f9c42":"People in the southeast region have more health issue as they seems more addicted to smoking.","ea83d33e":"Money spend according to sex."}}