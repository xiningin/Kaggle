{"cell_type":{"927f2999":"code","1f6c94f6":"code","d5d31f4e":"code","f018f769":"code","270a35d0":"code","87485c20":"code","6537102e":"code","b1d4491d":"code","5101501d":"code","6f8a854a":"code","01036297":"markdown","cf25bd62":"markdown","82cc7b24":"markdown","a41cd9b1":"markdown","37483e84":"markdown"},"source":{"927f2999":"%pylab inline","1f6c94f6":"from scipy.io import wavfile\nfrom scipy.signal import correlate\nrcParams['figure.figsize'] = (16, 6)","d5d31f4e":"# Read and plot a speech file from the FDA_UE database\nname = \"sb034.wav\"\nfilename=\"..\/input\/fda_ue\/\" + name\nsfreq, data = wavfile.read(filename)\nplot(data)\nxlim(0, len(data))\ntitle(name)","f018f769":"# Pick a short segment\nwindowlength = 32 # 32ms\nns_windowlength = int(round((windowlength * sfreq) \/ 1000))\npos = 31000\nframe_length = ns_windowlength\n\nframe = data[pos:pos+frame_length]\n\nplot(frame, linewidth=1.0)\nxlim(0, frame_length)\ntitle(\"A frame\")","270a35d0":"frame = frame.astype(np.float)\nframe -= frame.mean()\namax = np.abs(frame).max()\nframe \/= amax\nxlim(-(frame_length-1), frame_length-1)\nbcorr = correlate(frame, frame)\nplot(range(-(frame_length-1), frame_length), bcorr, linewidth=1.0)\ntitle(\"The complete autocorrelation\")","87485c20":"# keep the positive indexes of the autocorrelation\ncorr = bcorr[len(bcorr)\/\/2:]\nxlim(0, frame_length-1)\nplot(corr)\ntitle(\"The autocorrelation for nonnegative indexes\")","6537102e":"# Find the first minimum\ndcorr = np.diff(corr)\nxlim(0, len(dcorr))\nplot(dcorr)\ntitle(\"The first difference of the autocorrelation (corr[n+1] - corr[n])\")","b1d4491d":"# Find the first minimum\nrmin = np.where(dcorr > 0)[0]\nif len(rmin) > 0:\n    rmin1 = rmin[0]\nplot(range(rmin1,len(corr)), corr[rmin1:])\ntitle(\"Autocorrelation without the initial values up to the first minimum\")","5101501d":"# Find the next peak\npeak = np.argmax(corr[rmin1:]) + rmin1\nrmax = corr[peak]\/corr[0]\nf0 = sfreq \/ peak","6f8a854a":"print(\"corr[peak]\/corr[0] = {:.1f}\".format(rmax))\nprint(\"Pitch frequency = {:.1f} Hz\".format(f0))\nprint(\"Pitch period {:.1f} ms ({:d} samples)\".format((1\/f0)*1000, peak))","01036297":"### Find the index of the first sample with positive difference using [numpy.where](https:\/\/docs.scipy.org\/doc\/numpy\/reference\/generated\/numpy.where.html) ###","cf25bd62":"### Find the index of the sample with the maximum value using [numpy.argmax](https:\/\/docs.scipy.org\/doc\/numpy\/reference\/generated\/numpy.argmax.html) ###","82cc7b24":"### Calculate the autocorrelation using [scipy.signal.correlate](https:\/\/docs.scipy.org\/doc\/scipy\/reference\/generated\/scipy.signal.correlate.html) ###","a41cd9b1":"### Caculate the first difference using [numpy.diff](https:\/\/docs.scipy.org\/doc\/numpy\/reference\/generated\/numpy.diff.html) ###","37483e84":"## Computing the pitch of a speech frame with the autocorrelation method ##"}}