{"cell_type":{"d99887cd":"code","4d2579ad":"code","29cc752d":"code","3d696076":"code","e7795539":"code","8d19fd67":"code","8b2c7356":"code","c6c09fbb":"code","7f429918":"code","f6446fca":"code","91fdc3aa":"code","03c2357a":"code","9c43632e":"code","125fedfc":"code","795863b4":"code","4ea3adee":"code","916b0580":"code","1253fe51":"code","3803c3a2":"markdown","a6c99229":"markdown","9bb8b2e7":"markdown","449aa6d8":"markdown","91cc647e":"markdown","8aa739f3":"markdown","00d8975a":"markdown","0c5c46be":"markdown","f61c60c8":"markdown","e6695afe":"markdown","41adbc8b":"markdown","8719da5d":"markdown"},"source":{"d99887cd":"import pandas as pd","4d2579ad":"train = pd.read_csv('..\/input\/otus-rec-sys\/user_course_train.csv', index_col = 0)\ntrain.head()","29cc752d":"test = [int(x) for x in open('..\/input\/otus-rec-sys\/test_ids.txt').readlines()]\nprint(len(test))\ntest[:5]","3d696076":"courses = pd.read_csv('..\/input\/otus-rec-sys\/course.csv', index_col = 0, sep = ';')\ncourses.head(2)","e7795539":"pd.read_csv('..\/input\/otus-rec-sys\/assessment_train.csv', index_col = 0).head(2)","8d19fd67":"pd.read_csv('..\/input\/otus-rec-sys\/lessons_homework_train.csv', index_col = 0).head(2)","8b2c7356":"X = train[['user_id','course_id']].copy().drop_duplicates()\nX.head()","c6c09fbb":"from sklearn.model_selection import train_test_split\n\nX_train, y_val = train_test_split(X, random_state= 1, test_size = 0.3)\nprint(X_train.shape, y_val.shape)\nval_idx = list(sorted(set(y_val.user_id)))","7f429918":"from sklearn.base import BaseEstimator\nfrom typing import List\n\nclass MostPopular(BaseEstimator):\n    def fit(self, train:pd.DataFrame):\n        self.most_popular = list(train['course_id'].value_counts().index)\n        self.users_items = train[['user_id', 'course_id']]\n        return self\n    \n    def predict_items(self, user_id:str, n:int = 3):\n        taken_courses = set(self.users_items[self.users_items['user_id'] == user_id]['course_id'])\n        return [x for x in self.most_popular if not x in taken_courses][:n]\n    \n    def predict(self, user_ids:List[str], n = 3):\n        y = [self.predict_items(user_id, n = n) for user_id in user_ids]\n        return y","f6446fca":"# \u041e\u0431\u0443\u0447\u0430\u0435\u043c \u043c\u043e\u0434\u0435\u043b\u044c\nestimator = MostPopular().fit(X_train)","91fdc3aa":"#!pip install ml_metrics","03c2357a":"from ml_metrics import mapk","9c43632e":"val_preds = estimator.predict(val_idx)\ny_val_true = [list(set(y_val[y_val.user_id == idx].course_id)) for idx in val_idx]\nval_preds[:3], y_val_true[:3]","125fedfc":"id2course = {}\nfor i, row in courses.iterrows():\n    id2course[i] = row.title\n    \nprint([id2course[i] for i in val_preds[0]])","795863b4":"# \u0412\u044b\u0447\u0438\u0441\u043b\u0438\u043c MAP@3\nprint('MAP@3 =', round(mapk(\n    y_val_true, \n    val_preds, \n    k=3\n),3))","4ea3adee":"estimator = MostPopular().fit(train)\ntest_preds = estimator.predict(test, n = 3)","916b0580":"submission = pd.DataFrame([test, test_preds], index = ['Id', 'Predicted']).T\nsubmission['Predicted'] = submission['Predicted'].map(list)\nsubmission['Predicted'] = submission['Predicted'].apply(lambda x: \" \".join(map(str, x)))\nsubmission.head(3)","1253fe51":"submission.to_csv('sample_submission.csv', index=None)","3803c3a2":"**user_course_train.csv**\n\n\n\u0422\u0430\u0431\u043b\u0438\u0446\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c-\u043a\u0443\u0440\u0441, **\u043e\u0441\u043d\u043e\u0432\u043d\u0430\u044f \u0442\u0430\u0431\u043b\u0438\u0446\u0430** \u0441 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0435\u0439 \u043e \u0432\u0437\u044f\u0442\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\u043c\u0438 \u043a\u0443\u0440\u0441\u0430\u0445 \n\n\u041a \u043d\u0430\u0438\u0431\u043e\u043b\u0435\u0435 \u0432\u0430\u0436\u043d\u044b\u043c \u043a\u043e\u043b\u043e\u043d\u043a\u0430\u043c \u043e\u0442\u043d\u043e\u0441\u044f\u0442\u0441\u044f:\n- user_id - \u0443\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u0439 \u0438\u0434\u0435\u043d\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\n- item_id - \u0443\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u0439 \u0438\u0434\u0435\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440 \u043a\u0443\u0440\u0441\u0430","a6c99229":"**course**\n\n\u0422\u0430\u0431\u043b\u0438\u0446\u0430 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u0440\u0430\u0441\u0448\u0438\u0444\u0440\u043e\u0432\u043a\u0443 `course_id` \u0438 \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u0443\u044e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u043a\u0443\u0440\u0441\u0430\u0445.","9bb8b2e7":"**test**\n\n\u0422\u0435\u0441\u0442\u043e\u0432\u044b\u0439 \u043d\u0430\u0431\u043e\u0440 `user_id` \u0434\u043b\u044f \u043a\u043e\u0442\u043e\u0440\u043e\u0433\u043e \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0441\u0434\u0435\u043b\u0430\u0442\u044c \u043f\u0440\u0435\u0434\u0441\u043a\u0430\u0437\u0430\u043d\u0438\u044f.","449aa6d8":"\u0414\u043b\u044f \u043e\u0442\u043b\u0430\u0434\u043a\u0438 \u0430\u043b\u0433\u043e\u0440\u0438\u0442\u043c\u0430 \u0440\u0430\u0437\u043e\u0431\u044c\u0435\u043c \u0434\u0430\u043d\u043d\u044b\u0435 \u043d\u0430 train \u0438 test. \u0412 baseline \u0440\u0435\u0448\u0435\u043d\u0438\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0441\u0430\u043c\u0430\u044f \u043f\u0440\u043e\u0441\u0442\u0430\u044f \u0440\u0430\u0437\u0431\u0438\u0432\u043a\u0430 (\u043d\u0430 \u0442\u043e \u044d\u0442\u043e \u0438 baseline), \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e, \u0432\u044b \u0437\u0430\u0445\u043e\u0442\u0438\u0442\u0435 \u0441\u0434\u0435\u043b\u0430\u0442\u044c \u0447\u0442\u043e-\u0442\u043e \u0431\u043e\u043b\u0435\u0435 \u0443\u043c\u043d\u043e\u0435, \u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u0443\u0447\u0438\u0442\u044b\u0432\u0430\u044e\u0449\u0438\u0435 id \u044e\u0437\u0435\u0440\u0430.","91cc647e":"# Submission\n\n\u0412 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u043e\u0442\u0432\u0435\u0442\u0430 \u0432\u0430\u043c \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u0438\u0442\u044c `csv` \u0444\u0430\u0439\u043b \u0441 \u0434\u0432\u0443\u043c\u044f \u043a\u043e\u043b\u043e\u043d\u043a\u0430\u043c\u0438:\n\n* **Id** (type int64) \u0441 id \u043f\u0440\u0435\u0434\u0441\u043a\u0430\u0437\u0430\u043d\u0438\u0439;\n    \n* **Predicted** (type string), \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u044e\u0437\u0435\u0440\u0430 \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u0437\u0430\u043f\u0438\u0441\u0430\u043d\u043e \u0442\u043e\u043f3 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u043a\u0443\u0440\u0441\u0430. **\u041a\u0443\u0440\u0441\u044b \u0434\u043e\u043b\u0436\u043d\u044b \u0431\u044b\u0442\u044c \u0437\u0430\u043f\u0438\u0441\u0430\u043d\u044b \u0432 \u0432\u0438\u0434\u0435 \u0441\u0442\u0440\u043e\u043a\u0438 \u0447\u0435\u0440\u0435\u0437 \u043f\u0440\u043e\u0431\u0435\u043b** (\u041f\u0440\u0438\u043c\u0435\u0440: `7 1 15`).\n    \n\n<center> \n    <table>\n        <tr>\n            <th>  <\/th>\n            <th> Id <\/th>\n            <th> Predicted <\/th>\n        <\/tr> \n        <tr><td> 0 <\/td><td> 163840 <\/td><td> 7 1 15 <\/td><\/tr>\n        <tr><td> 1 <\/td><td> 122882 <\/td><td> 7 1 15 <\/td><\/tr>\n        <tr><td> 2 <\/td><td> 81926 <\/td><td> 7 1 15 <\/td><\/tr>\n      \n<\/center>\n ","8aa739f3":"# \u0421\u043e\u0440\u0435\u0432\u043d\u043e\u0432\u0430\u043d\u0438\u0435 \u043f\u043e Machine Learning\n# \u0417\u0430\u0434\u0430\u0447\u0430 \u043f\u043e \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u043c \u0441\u0438\u0441\u0442\u0435\u043c\u0430\u043c\n\n\u0412 \u0434\u0430\u043d\u043d\u043e\u043c \u0437\u0430\u0434\u0430\u043d\u0438\u0438 \u0432\u0430\u043c \u043f\u0440\u0435\u0434\u0441\u0442\u043e\u0438\u0442 \u043f\u043e\u0441\u0442\u0440\u043e\u0438\u0442\u044c \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0442\u0435\u043b\u044c\u043d\u0443\u044e \u0441\u0438\u0441\u0442\u0435\u043c\u0443 \u0434\u043b\u044f \u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0439 \u043e\u043d\u043b\u0430\u0439\u043d \u043f\u043b\u0430\u0442\u0444\u043e\u0440\u043c\u044b **\u041e\u0442\u0443\u0441**. \u0410 \u0438\u043c\u0435\u043d\u043d\u043e, \u0432\u0430\u043c \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u043e\u0431\u0443\u0447\u0438\u0442\u044c \u043c\u043e\u0434\u0435\u043b\u044c, \u043a\u043e\u0442\u043e\u0440\u0430\u044f \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f (\u0438\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0437\u0430\u043a\u043e\u0434\u0438\u0440\u043e\u0432\u0430\u043d\u043e \u0447\u0435\u0440\u0435\u0437 `user_id`) \u0431\u0443\u0434\u0435\u0442 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u043e\u0432\u0430\u0442\u044c \u0435\u043c\u0443 3 \u043a\u0443\u0440\u0441\u0430 (`course_id`) \u0438\u0437 \u0442\u0435\u0445, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043e\u043d \u0435\u0449\u0435 \u043d\u0435 \u0441\u043b\u0443\u0448\u0430\u043b. \u041f\u0440\u0438 \u044d\u0442\u043e\u043c \u043c\u043e\u0434\u0435\u043b\u044c \u0434\u043e\u043b\u0436\u043d\u0430 \u0443\u043c\u0435\u0442\u044c \u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c \u043a\u0430\u043a \u0441\u043e \u0441\u0442\u0430\u0440\u044b\u043c\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\u043c\u0438, \u0442\u0430\u043a \u0438 \u0441 \u043d\u043e\u0432\u044b\u043c\u0438, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0435\u0449\u0435 \u043d\u0435 \u043f\u0440\u0438\u043e\u0431\u0440\u0435\u043b\u0438 \u043d\u0438 \u043e\u0434\u043d\u043e\u0433\u043e \u043a\u0443\u0440\u0441\u0430.\n\n## \u0414\u0430\u043d\u043d\u044b\u0435\n\u0414\u043b\u044f \u043f\u043e\u0441\u0442\u0440\u043e\u0435\u043d\u0438\u044f \u043c\u043e\u0434\u0435\u043b\u0438 \u0432\u0430\u043c \u0431\u0443\u0434\u0443\u0442 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b \u0440\u0430\u0437\u043b\u0438\u0447\u043d\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u043e \u0432\u0437\u044f\u0442\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\u043c\u0438 \u043a\u0443\u0440\u0441\u0430\u0445, \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u044b\u0445 \u0434\u043e\u043c\u0430\u0448\u043d\u0438\u0445 \u0437\u0430\u0434\u0430\u043d\u0438\u044f\u0445 \u0438 \u0442\u0435\u0441\u0442\u0430\u0445.\n\n\u0410\u0440\u0445\u0438\u0432 \u0441 \u0434\u0430\u043d\u043d\u044b\u043c\u0438 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0435 \u0444\u0430\u0439\u043b\u044b.\n\n### \u041e\u0431\u0443\u0447\u0430\u044e\u0449\u0438\u0435 \u0434\u0430\u043d\u043d\u044b\u0435\n\n- **user_course_train.csv** - \u0442\u0430\u0431\u043b\u0438\u0446\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c-\u043a\u0443\u0440\u0441, **\u043e\u0441\u043d\u043e\u0432\u043d\u0430\u044f \u0442\u0430\u0431\u043b\u0438\u0446\u0430** \u0441 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0435\u0439 \u043e \u0432\u0437\u044f\u0442\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\u043c\u0438 \u043a\u0443\u0440\u0441\u0430\u0445 \n\n\n- **assessment_train.csv** - \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u0442\u043e\u043c \u043a\u0430\u043a\u0438\u0435 \u0442\u0435\u0441\u0442\u044b \u0438 \u0441 \u043a\u0430\u043a\u0438\u043c \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u043e\u043c \u043f\u0440\u043e\u0448\u0435\u043b \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\n\n- **course.csv** - \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e\u0431\u043e \u0432\u0441\u0435\u0445 \u043a\u0443\u0440\u0441\u0430\u0445 \n\n- **lessons_homework_train.csv** - \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u0432\u0441\u0435\u0445 \u0441\u0434\u0430\u043d\u043d\u044b\u0445 \u0434\u043e\u043c\u0430\u0448\u043d\u0438\u0445 \u0440\u0430\u0431\u043e\u0442\u0430\u0445\n\n- **sample_submission.csv** - \u043f\u0440\u0438\u043c\u0435\u0440 \u0441\u0430\u0431\u043c\u0438\u0442\u0430\n\n\n###  \u0422\u0435\u0441\u0442\u043e\u0432\u044b\u0435 \u0434\u0430\u043d\u043d\u044b\u0435\n\n- **test_ids.txt** - \u0441\u043f\u0438\u0441\u043e\u043a \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439 (`user_id`) \u0434\u043b\u044f \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0441\u0434\u0435\u043b\u0430\u0442\u044c \u043f\u0440\u0435\u0434\u0441\u043a\u0430\u0437\u0430\u043d\u0438\u044f","00d8975a":"\u041f\u043e\u043c\u043e\u0442\u0440\u0438\u043c \u043d\u0430 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044f \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u0439:","0c5c46be":"**assessment_train**\n\n\u0422\u0430\u0431\u043b\u0438\u0446\u0430 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0442\u043e\u043c, \u043a\u0430\u043a\u0438\u0435 \u0442\u0435\u0441\u0442\u044b \u0438 \u0441 \u043a\u0430\u043a\u0438\u043c \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u043e\u043c \u043f\u0440\u043e\u0448\u0435\u043b \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c.","f61c60c8":"### Most Popular Alogoritm\n\u041d\u0430 \u044d\u0442\u0430\u043f\u0435 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u0432\u044b\u0447\u0438\u0441\u043b\u044f\u0435\u0442 \u043d\u0430\u0438\u0431\u043e\u043b\u0435\u0435 \u043f\u043e\u043f\u0443\u043b\u044f\u0440\u043d\u044b\u0435 \u043a\u0443\u0440\u0441\u044b \u0432 \u043e\u0431\u0443\u0447\u0430\u044e\u0449\u0438\u0445 \u0434\u0430\u043d\u043d\u044b\u0445, \u043d\u0430 \u044d\u0442\u0430\u043f\u0435 \u043f\u0440\u0435\u0434\u0441\u043a\u0430\u0437\u0430\u043d\u0438\u044f - \u0432\u044b\u0431\u0438\u0440\u0430\u0435\u0442 top popular, \u0438\u0437 \u0442\u0435\u0445 \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0435\u0449\u0435 \u043d\u0435 \u0431\u0440\u0430\u043b.","e6695afe":"# Baseline\n\n\u0412 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 baseline \u043c\u044b \u043f\u0440\u0435\u0434\u043b\u0430\u0433\u0430\u0435\u043c MostPopular \u0430\u043b\u0433\u043e\u0440\u0438\u0442\u043c, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0443\u0435\u0442 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044e \u0441\u0430\u043c\u044b\u0435 \u043f\u043e\u043f\u0443\u043b\u044f\u0440\u043d\u044b\u0435 \u043a\u0443\u0440\u0441\u044b \u0438\u0437 \u0442\u0435\u0445, \u0447\u0442\u043e \u043e\u043d \u0435\u0449\u0435 \u043d\u0435 \u0431\u0440\u0430\u043b. \u0414\u043b\u044f \u0434\u0430\u043d\u043d\u043e\u0433\u043e \u0430\u043b\u0433\u043e\u0440\u0438\u0442\u043c\u0430 \u043d\u0430\u043c \u043f\u043e\u043d\u0430\u0434\u043e\u0431\u0438\u0442\u0441\u044f \u0432\u0441\u0435\u0433\u043e \u0434\u0432\u0435 \u043a\u043e\u043b\u043e\u043d\u043a\u0438 `user_id`,`course_id` \u0438\u0437 \u0442\u0430\u0431\u043b\u0438\u0446\u044b `user_course`.\n","41adbc8b":"**lessons_homework_train**\n\n\u0422\u0430\u0431\u043b\u0438\u0446\u0430 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0441\u0434\u0430\u043d\u043d\u044b\u0445 \u0434\u043e\u043c\u0430\u0448\u043d\u0438\u0445 \u0440\u0430\u0431\u043e\u0442\u0430\u0445.","8719da5d":"# \u041c\u0435\u0442\u0440\u0438\u043a\u0430 \n\u0412 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u043c\u0435\u0442\u0440\u0438\u043a\u0438 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0430 \u0432 \u0441\u043e\u0440\u0435\u0432\u043d\u043e\u0432\u0430\u043d\u0438\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f **MeanAveragePrecision@3**:\n\n$$ AveragePrecision@3(user) = \\frac{1}{3}\\sum_{i = 1}^3y_i \\cdot presicion@i(user)$$\n\n$y_i \\in {0,1}$ - \u0431\u0438\u043d\u0430\u0440\u043d\u0430\u044f \u043c\u0435\u0442\u043a\u0430 $i$-\u0433\u043e \u043f\u0440\u0435\u0434\u0441\u043a\u0430\u0437\u0430\u043d\u0438\u044f (\u0432\u0435\u0440\u043d\u043e \u043f\u0440\u0435\u0434\u0441\u043a\u0430\u0437\u0430\u043b\/\u043d\u0435\u0432\u0435\u0440\u043d\u043e);\n\n$presicion@i(user)$ - \u0434\u043e\u043b\u044f \u0432\u0435\u0440\u043d\u043e \u043f\u0440\u0435\u0434\u0441\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0445 \u0441\u0440\u0435\u0434\u0438 \u043f\u0435\u0440\u0432\u044b\u0445 $i$ \u043a\u0443\u0440\u0441\u043e\u0432. \n\n\u0418\u0442\u043e\u0433\u043e\u0432\u0430\u044f \u043c\u0435\u0442\u0440\u0438\u043a\u0430 \u0441\u0447\u0438\u0442\u0430\u0435\u0442\u0441\u044f \u0443\u0441\u0440\u0435\u0434\u043d\u0435\u043d\u0438\u0435\u043c \u043f\u043e \u0432\u0441\u0435\u043c \u044e\u0437\u0435\u0440\u0430\u043c:\n\n$$MeanAveragePrecision@3 = \\frac{1}{|U|}\\sum_{user \\in U} AveragePrecision@3(user) $$\n\n\u041f\u043e\u0434\u0440\u043e\u0431\u043d\u043e\u0435 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043c\u0435\u0442\u0440\u0438\u043a\u0438 \u043c\u043e\u0436\u043d\u043e \u043f\u0440\u043e\u0447\u0438\u0442\u0430\u0442\u044c \u0442\u0443\u0442: https:\/\/habr.com\/ru\/company\/econtenta\/blog\/303458\/\n\n\u041f\u0440\u0438 \u043e\u0446\u0435\u043d\u043a\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0440\u0435\u0448\u0435\u043d\u0438\u044f \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u043c\u0435\u0442\u0440\u0438\u043a\u0438 \u0438\u0437 \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0438 `ml_metrics`: https:\/\/github.com\/benhamner\/Metrics\/blob\/master\/Python\/ml_metrics\/average_precision.py"}}