{"cell_type":{"1d7ed24f":"code","c4cba110":"code","eb1598fb":"code","0c654bc0":"code","e10ad1cb":"code","25cde2e2":"code","328eaba0":"code","c7f9dc7f":"code","21a14faf":"code","464c4262":"code","7dcc6d5d":"code","181589f7":"code","d4017495":"code","5c559b84":"code","a63fd12b":"code","0b79777c":"markdown","3940bf12":"markdown","d6628231":"markdown","638ab3f0":"markdown","f60ea264":"markdown","f0a3fd14":"markdown","a378e44f":"markdown","e3e10d90":"markdown","42a59a5b":"markdown","6288bdca":"markdown","485525bf":"markdown","29e84e6e":"markdown","844d41a0":"markdown","0646e1f8":"markdown","b142c71a":"markdown","b49b3aec":"markdown","c1654ca5":"markdown","89ef31ce":"markdown","fd58edee":"markdown"},"source":{"1d7ed24f":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","c4cba110":"iris = pd.read_csv(\"..\/input\/Iris.csv\")","eb1598fb":"iris.head()","0c654bc0":"iris.describe()","e10ad1cb":"fig=plt.gcf()\nfig.set_size_inches(10,7)\nfig=sns.heatmap(iris.corr(),annot=True,cmap='cubehelix',linewidths=1,linecolor='k',square=True,mask=False, vmin=-1, vmax=1,cbar_kws={\"orientation\": \"vertical\"},cbar=True)","25cde2e2":"iris['Species'].value_counts().plot.pie(explode=[0.1,0.1,0.1],autopct='%1.1f%%',shadow=True,figsize=(10,8))\nplt.show()","328eaba0":"sns.jointplot(\"SepalLengthCm\", \"SepalWidthCm\", data=iris, kind=\"reg\")","c7f9dc7f":"%matplotlib inline\nsns.FacetGrid(iris,hue='Species',height=5)\\\n.map(plt.scatter,'SepalLengthCm','SepalWidthCm')\\\n.add_legend()","21a14faf":"fig = iris[iris.Species=='Iris-setosa'].plot(kind='Scatter',x='SepalLengthCm',y='SepalWidthCm'\n                                             ,color='Orange',label='Setosa')\niris[iris.Species=='Iris-versicolor'].plot(kind='Scatter',x='SepalLengthCm',y='SepalWidthCm'\n                                           ,color='Blue',label='Versicolor', ax=fig)\niris[iris.Species=='Iris-virginica'].plot(kind='Scatter',x='SepalLengthCm',y='SepalWidthCm'\n                                          ,color='Green',label='Virginica', ax=fig)\nfig.set_xlabel('Sepal Length')\nfig.set_ylabel('Sepal Width')\nfig.set_title('Sepal Length Vs Width Scatter Plot')\nfig=plt.gcf()\nfig.set_size_inches(10,6)\nplt.show()","464c4262":"from sklearn.model_selection import train_test_split\nfrom sklearn import preprocessing\ncols_x = [\"SepalLengthCm\",\"SepalWidthCm\",\"PetalLengthCm\",\"PetalWidthCm\"]\nencoder = preprocessing.LabelEncoder()\ny = encoder.fit_transform(iris.Species)\n## Separaci\u00f3n de los datos de entrenamiento y testing\nX_train, X_test, y_train, y_test = train_test_split(iris[cols_x], y, random_state = 0)","7dcc6d5d":"from sklearn.linear_model import LogisticRegression\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.svm import LinearSVC\nfrom sklearn.naive_bayes import MultinomialNB\nfrom sklearn.model_selection import cross_val_score","181589f7":"from sklearn.linear_model import LogisticRegression\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.svm import LinearSVC\nfrom sklearn.model_selection import cross_val_score\nmodels = [ # Lista de todos los m\u00f3delos a usar\n    RandomForestClassifier(n_estimators=200, max_depth=3, random_state=0),\n    LinearSVC(),\n    MultinomialNB(),\n    LogisticRegression(random_state=0),\n]","d4017495":"import warnings\nwarnings.filterwarnings(\"ignore\")","5c559b84":"CV = 5 # Cant de k a usar para el cross validation\ncv_df = pd.DataFrame(index=range(CV * len(models)))\nentries = []\nfor model in models:\n  model_name = model.__class__.__name__\n  accuracies = cross_val_score(model, X_test, y_test, scoring='accuracy', cv=CV)\n  for fold_idx, accuracy in enumerate(accuracies):\n    entries.append((model_name, fold_idx, accuracy))\ncv_df = pd.DataFrame(entries, columns=['model_name', 'fold_idx', 'accuracy'])\nimport seaborn as sns\nsns.boxplot(x='model_name', y='accuracy', data=cv_df)\nsns.stripplot(x='model_name', y='accuracy', data=cv_df, \n              size=8, jitter=True, edgecolor=\"gray\", linewidth=2)\nplt.show()","a63fd12b":"cv_df.groupby('model_name').accuracy.mean() # Media de la exactitud del m\u00f3delo","0b79777c":"Evaluaremos los siguientes cuatro modelos: \n* Regresi\u00f3n log\u00edstica \n* (Multinomial) Bayas ingenuas \n* M\u00e1quina de vectores de soporte lineal \n* Bosque aleatorio\n","3940bf12":"- sepal length in cm : Largo del s\u00e9palo\n- sepal width in cm : Ancho del s\u00e9palo\n- petal length in cm : Largo del p\u00e9talo\n- petal width in cm : Ancho del p\u00e9talo\n- class: \n    - Iris Setosa \n    - Iris Versicolour \n    - Iris Virginica","d6628231":"![alt text](https:\/\/upload.wikimedia.org\/wikipedia\/commons\/1\/1c\/K-fold_cross_validation_EN.jpg)","638ab3f0":"Esta es quiz\u00e1s la base de datos m\u00e1s conocida que se encuentra en la literatura de reconocimiento de patrones. El papel de Fisher es un cl\u00e1sico en el campo y se hace referencia con frecuencia a este d\u00eda. (Ver Duda y Hart, por ejemplo). El conjunto de datos contiene 3 clases de 50 instancias cada una, donde cada clase se refiere a un tipo de planta de iris. Una clase es linealmente separable de la otra 2; estos \u00faltimos NO son linealmente separables entre s\u00ed.","f60ea264":"# Modelado","f0a3fd14":"## Conclusi\u00f3n ","a378e44f":"## Evaluaci\u00f3n","e3e10d90":"### Preparaci\u00f3n de los datos","42a59a5b":"## Entendimiento del negocio","6288bdca":"## Preparaci\u00f3n de los datos","485525bf":"# IRIS DATASET\n- Autor: Jos\u00e9 Pablo Brenes Alfaro","29e84e6e":"#### Cross validation (Validaci\u00f3n cruzada)","844d41a0":"Esto con el fin de ver c\u00faal modelo es que mejor se ajusta a la clasificaci\u00f3n de prioridad de las aplicaciones","0646e1f8":"#### Gr\u00e1fico circular sobre las especies","b142c71a":"## Entendimiento de los datos","b49b3aec":"<hr>","c1654ca5":"#### Mapa de calor de las correlaciones","89ef31ce":"\n![alt text](https:\/\/cdn-images-1.medium.com\/max\/1000\/1*8BQGOzI2cgNZxiqnjZPfMg.jpeg \"Logo Title Text 1\")","fd58edee":"El modelo de clasificaci\u00f3n con Bosques aleatorios es el que predice mejor con un 94% por lo que supera a los dem\u00e1s ya que el resto la exactitud rodea los 83 a 73 %. Por lo que en este para clasificar las especies se utilizaria tal modelo."}}