{"cell_type":{"3e6022df":"code","1c453b6c":"code","bad7438b":"code","e6b48526":"code","74a63cac":"code","6c3936fe":"code","c04a5116":"code","b25d1605":"code","1acf6bee":"code","5f3fa0ea":"code","69d73b55":"code","3278a78f":"code","81edd14c":"code","da6d766d":"code","14072630":"code","4e18a904":"code","19cdd34d":"code","349517d0":"code","1b0f0da8":"code","1e5acd3c":"code","bb48b8c6":"code","140422c3":"code","dadff139":"code","07154589":"code","03e95dde":"markdown","a4bcdfd0":"markdown","aa8fcf86":"markdown","acd9bf73":"markdown","cc6e7a42":"markdown","961a3f85":"markdown","979ff13b":"markdown","33d0341c":"markdown","4b43b0da":"markdown","d7b8ccee":"markdown","3c6a246d":"markdown","671c6238":"markdown","eadcd261":"markdown","82f0aec9":"markdown","98510bcf":"markdown"},"source":{"3e6022df":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","1c453b6c":"#installing pycaret\n#remove '#''and run the cell if the libary hasn't been already installed. \n\n!pip install pycaret","bad7438b":"#importing and checking the version\nimport pycaret\npycaret.__version__","e6b48526":"df = pd.read_csv('\/kaggle\/input\/bike-buyers\/bike_buyers_clean.csv')\ndf.head()","74a63cac":"df.info()","6c3936fe":"df.describe()","c04a5116":"df.isnull().sum()","b25d1605":"df = df.drop(columns='ID')","1acf6bee":"#finding the shape of the dataset\n\ndf.shape","5f3fa0ea":"#sampling the dataset\n\ntrain = df.sample(frac = 0.95,random_state= 852)\nprint(\"Train dataset size\",train.shape)\n\ntest = df.drop(index = train.index)\nprint(\"Test dataset size\" , test.shape)\n\n\n#resetting the index\n\ntrain.reset_index(inplace=True, drop=True)\ntest.reset_index(inplace= True,drop = True)","69d73b55":"#importing the classification model\n\nfrom pycaret.classification import *","3278a78f":"cls_model = setup(data=train,target='Purchased Bike')","81edd14c":"best = compare_models()","da6d766d":"print(best)","14072630":"#creating a model\nmodel = create_model('rf')","4e18a904":"#tuning the model\nmodel_tune = tune_model(model)","19cdd34d":"#plotting the graphs\n\nplot_model(model,plot= 'auc')","349517d0":"plot_model(model,plot ='feature')","1b0f0da8":"evaluate_model(model)","1e5acd3c":"#predicting the model \n\npredict_model(model)","bb48b8c6":"final = finalize_model(model)\nprint(final)","140422c3":"test_pred = predict_model(final,data=test)\ntest_pred.head()","dadff139":"from pycaret.utils import check_metric\ncheck_metric(test_pred['Purchased Bike'], test_pred['Label'], metric = 'AUC')","07154589":"#saving the model\n\n#save_model(final,'Bikemodel')\n\n#loading the model\n\n#loading = load_model('Bikemodel')\n#loading","03e95dde":"Since, we wanted to do classification, I am going to go with Random Forest method. The AUC is good with rf model and thats why I am using it. ","a4bcdfd0":"Lets view the statistical part of the dataset. ","aa8fcf86":"We can even save the model. The following code will be the commands for doing it. You can remove the # and run the lines","acd9bf73":"In this notebook we will see everything about building a model using pycaret library and analyzing the results. A short note on pycaret is given below\n\nPycaret\n\n* opensource\n* Machine learning library.\n* Python version of R package 'Caret'.","cc6e7a42":"Now you can see the model is set up and we can compare the models that are possible for this dataset. The best results are highlighted in yellow","961a3f85":"The evaluation metrics is shown below. ","979ff13b":"The dataset is perfect. \n\nIt is time for us to split the dataset into train and test accordingly. Once we split the dataset, we can use test set to evaluate. ","33d0341c":"Let us see how we can evaluate the model with the help of test data","4b43b0da":"From the above graph we can tell that, age is having a high importance in the final classification","d7b8ccee":"In order to check the dataset's types we can use info method. This method will give us a clear view of the dataset's data type, count, null count. \n\nThere are other ways too. But this will fetch all the details under a single frame. ","3c6a246d":"Now we will import the dataset and see it. ","671c6238":"As mentioned above there are different ways of checking null values. One such is listed below.","eadcd261":"Let us check the shape of the dataset","82f0aec9":"Now it is time for modelling. ID column is not necessary for the model. So, we will drop it using the drop functions","98510bcf":"Pycaret is a easy-go library. It will enable us to do things in a matter of time with one line of coding. We will set the model and fix the target variable\n"}}