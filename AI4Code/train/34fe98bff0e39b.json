{"cell_type":{"07939240":"code","4d563803":"code","17c6b652":"code","9b6a131f":"code","73b43752":"code","b58b45aa":"code","29c387c9":"markdown","4ca777ee":"markdown","0e57460a":"markdown","0e0134e3":"markdown","8db43eda":"markdown","fb3661a9":"markdown"},"source":{"07939240":"import pandas as pd\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport os","4d563803":"for dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n        \ndata=pd.read_csv('\/kaggle\/input\/mall-customerscsv\/Mall_Customers.csv')\ndata.head(5)","17c6b652":"x=data.iloc[:,[3,4]].values\nx[:3]","9b6a131f":"from sklearn.cluster import KMeans\nwcss=[] ## empty list, we will put values there\nfor i in range(1,11):\n    kmeans=KMeans(n_clusters=i, init=\"k-means++\", random_state=42)## 42 brings luck to mathematics\n    kmeans.fit(x)\n    wcss.append(kmeans.inertia_)\n    \nplt.plot(range(1,11), wcss);\nplt.title(\"The Elbow Method\");\nplt.xlabel(\"Number of Clusters\");\nplt.ylabel(\"WCSS\");\n## After 5 it is decreases pretty slowly","73b43752":"kmeans=KMeans(n_clusters=5, init=\"k-means++\", random_state=42)## 42 brings luck to mathematics\ny_kmeans=kmeans.fit_predict(x)\ny_kmeans","b58b45aa":"plt.scatter(x[y_kmeans==0,0], x[y_kmeans==0,1], s=100, c=\"red\", label=\"Cluster 1\")## 0  - Annual Income, 1 - Spending Score\nplt.scatter(x[y_kmeans==1,0], x[y_kmeans==1,1], s=100, c=\"blue\", label=\"Cluster 2\") ## 0  - Annual Income, 1 - Spending Score\nplt.scatter(x[y_kmeans==2,0], x[y_kmeans==2,1], s=100, c=\"green\", label=\"Cluster 3\")  \nplt.scatter(x[y_kmeans==3,0], x[y_kmeans==3,1], s=100, c=\"cyan\", label=\"Cluster 4\")  \nplt.scatter(x[y_kmeans==4,0], x[y_kmeans==4,1], s=100, c=\"magenta\", label=\"Cluster 5\")  \n\nplt.scatter(kmeans.cluster_centers_[:,0], kmeans.cluster_centers_[:,1], s=300, c=\"yellow\", label=\"Centroids\")  ## To highlight centroids\nplt.title(\"Cluster of Customers\")\nplt.xlabel(\"Annual Income, in thousands\");\nplt.ylabel(\"Spending Score (1-100)\");\nplt.legend();","29c387c9":"# K-Means Clustering","4ca777ee":"## Training the K-Means model on the dataset","0e57460a":"## Visualising the clusters","0e0134e3":"## Importing the dataset","8db43eda":"## Importing the libraries","fb3661a9":"## Using the elbow method to find the optimal number of clusters"}}