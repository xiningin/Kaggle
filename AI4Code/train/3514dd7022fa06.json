{"cell_type":{"dc23d62c":"code","7bb4f87c":"code","389f05b0":"code","5b1f5c77":"code","c29d9c99":"code","b4f98967":"code","f23ca3b5":"code","86e59366":"code","c471e69d":"code","6783715b":"code","0bb28066":"code","9185f6c1":"code","c7171403":"code","c5b2614a":"code","5f88c9dc":"code","485cdcf9":"code","9b1e89f4":"code","9f85836d":"code","5c7826e6":"code","a0a7ae20":"markdown","54249193":"markdown","a02bf730":"markdown","73d0ede6":"markdown","caca8c91":"markdown","5a9e72a1":"markdown","500de63f":"markdown","467ee203":"markdown","70f18a68":"markdown","f2045e52":"markdown"},"source":{"dc23d62c":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport pathlib\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nimport gc\nprint(os.listdir(\"..\/input\"))\n\nfrom sklearn.metrics import confusion_matrix\nfrom fastai import *\nfrom fastai.vision import *\n\n# Any results you write to the current directory are saved as output.","7bb4f87c":"DATA_DIR='..\/input\/heroes\/heroes'","389f05b0":"os.listdir(f'{DATA_DIR}')","5b1f5c77":"torch.cuda.is_available()","c29d9c99":"data = ImageDataBunch.from_folder(DATA_DIR, train=\".\", \n                                  valid_pct=0.2,\n                                  ds_tfms=get_transforms(flip_vert=True, max_warp=0),\n                                  size=224,bs=64, \n                                  num_workers=0).normalize(imagenet_stats)","b4f98967":"print(f'Classes: \\n {data.classes}')","f23ca3b5":"data.show_batch(rows=3, figsize=(7,6))","86e59366":"learn = create_cnn(data, models.resnet34, metrics=accuracy, model_dir=\"\/tmp\/model\/\")","c471e69d":"learn.lr_find()\nlearn.recorder.plot()","6783715b":"learn.fit_one_cycle(6,1e-2)","0bb28066":"learn.save('stage-1')","9185f6c1":"learn.unfreeze()","c7171403":"learn.lr_find()\nlearn.recorder.plot()","c5b2614a":"learn.fit_one_cycle(4, max_lr=slice(1e-6,1e-4 ))","5f88c9dc":"learn.save('stage-2')","485cdcf9":"learn.recorder.plot_losses()","9b1e89f4":"interp = ClassificationInterpretation.from_learner(learn)","9f85836d":"interp.plot_top_losses(9, figsize=(15,11))","5c7826e6":"interp.plot_confusion_matrix(figsize=(8,8), dpi=60)","a0a7ae20":"## Please upvote if you like it ;)","54249193":"# Check Result","a02bf730":"# Model Build","73d0ede6":"# Train 1 ","caca8c91":"# Search LR 1","5a9e72a1":"# Train 2 ","500de63f":"## Please upvote if you like it ;)","467ee203":"## Make Data","70f18a68":"# Search LR 2","f2045e52":"# Import modules"}}