{"cell_type":{"838ce670":"code","38ae4068":"code","c7f96302":"code","ae1bce85":"code","430a1bd1":"code","dd90e052":"code","ee1c89d1":"code","1f2d61ef":"code","3339b4d0":"code","9b3312e2":"code","7b01888a":"code","e44c2861":"code","213696db":"code","d9dc48f3":"code","f1c8deaa":"code","ac5b76a6":"code","0ccbff82":"code","f1080437":"code","743087b9":"code","88e7943f":"code","9805fdd3":"code","a5e7b14b":"code","7d300c5b":"code","cc5f9298":"code","cb321987":"code","83c299db":"code","a52cf495":"code","14422f52":"code","4bb18d45":"code","a167b665":"code","f9ac3564":"code","5811f62c":"code","6bf02464":"code","3624cdc6":"code","6d811485":"code","665e5b8d":"code","85907046":"code","4467d3d9":"code","d260ebcc":"code","542c5f5d":"code","fd17b707":"code","e04ac9a8":"code","efca3bd2":"code","8f2e61e8":"code","ce629a04":"code","99bd3347":"code","cbfbfcb0":"code","2c1724db":"code","84c89cf9":"code","4b8747d9":"code","dc5e9a05":"code","6710fe28":"code","849dd291":"code","24a4eba5":"code","79d47fd5":"code","4ec0503c":"code","5cf721fb":"code","4568fc83":"markdown","c5069f87":"markdown","3a91de24":"markdown","889bc74f":"markdown","8f90cd0e":"markdown","70610b6d":"markdown","771ef6b9":"markdown","b0f3b067":"markdown","b5e41250":"markdown","b9018d19":"markdown","c505c815":"markdown","ce4b8757":"markdown","b2995ef6":"markdown","6ab6fb56":"markdown","aad2c2f3":"markdown","1ead8355":"markdown","8cfb40e0":"markdown","25c2d90e":"markdown","f701d322":"markdown","ee1a688b":"markdown","928ebfbe":"markdown","b680356e":"markdown","1c3d3adb":"markdown","8e2499b9":"markdown","85f6a51f":"markdown","7f4305e2":"markdown","f40566b1":"markdown","557f1645":"markdown","b2d0826a":"markdown","8c0af42e":"markdown","11ead555":"markdown","ea02dcd0":"markdown","46ad5b62":"markdown","fad5502c":"markdown","8d2bdf38":"markdown","f8aee588":"markdown","f80e8f40":"markdown","c9a07606":"markdown","e8ea7c0a":"markdown","547c687b":"markdown","ca444f12":"markdown","0465fd59":"markdown"},"source":{"838ce670":"import pandas as pd\nimport numpy as np\nimport matplotlib\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport squarify\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.ensemble import RandomForestRegressor\n%matplotlib inline","38ae4068":"zomato_data = pd.read_csv('..\/input\/zomato-bangalore-restaurants\/zomato.csv')","c7f96302":"df = zomato_data.copy()","ae1bce85":"df.head()","430a1bd1":"df.info()","dd90e052":"add_group = df.groupby('address')\ngroup_1 = add_group.filter(lambda x: len(x) > 1)[add_group.filter(lambda x: len(x) > 1)['name'] == 'Onesta']","ee1c89d1":"group_1['address'][7]","1f2d61ef":"group_1[add_group.filter(lambda x: len(x) > 1)[add_group.filter(lambda x: len(x) > 1)['name'] == 'Onesta'].address == '2469, 3rd Floor, 24th Cross, Opposite BDA Complex, 2nd Stage, Banashankari, Bangalore']","3339b4d0":"df = df.drop(['url', 'listed_in(type)', 'listed_in(city)'], axis=1).reset_index().drop(['index'], axis=1).drop_duplicates()","9b3312e2":"df = df.drop(['phone'],axis=1)","7b01888a":"plt.figure(figsize=(12, 8))\nsns.set_style('white')\nrest = df.groupby(['address', 'name'])\nrest_chains = rest.name.nunique().index.to_frame()['name'].value_counts()[:15] # first 15\n\nax = sns.barplot(x=rest_chains, y=rest_chains.index, palette='Greys_d')\nsns.despine()\nplt.title('Top 15 Restaurant chains in Bangalore')\nplt.xlabel('Number of Outlets')\nplt.ylabel('Name')\nfor p in ax.patches:\n    width = p.get_width()\n    ax.text(width+0.007, p.get_y()+p.get_height()\/2. + 0.2, format(width), ha=\"left\", color=\"black\")\nplt.show()","e44c2861":"#Preprocessing restaurant types\nrest_type_df = df.groupby(['address', 'rest_type']).rest_type.nunique().index.to_frame()\ntemp_df = pd.DataFrame()\ntemp_df = rest_type_df.rest_type.str.strip().str.split(',', expand=True)","213696db":"rest_type_temp_df = pd.DataFrame()\nrest_type_temp_df = pd.concat([temp_df.iloc[:,0].str.strip(), temp_df.iloc[:, 1].str.strip()]).value_counts()\nrest_type_temp_df","d9dc48f3":"plt.figure(figsize=(12,8))\nsns.set_style('white')\nrestaurant_types = rest_type_temp_df[:15]\nax = sns.barplot(x=restaurant_types, y=restaurant_types.index, palette=\"Greys_d\")\nsns.despine()\nplt.title('Top 15 restaurant types in Bangalore')\nplt.xlabel('Number of restaurants')\nplt.ylabel('Restaurant types')\ntotal_rest = len(rest_type_df)     #restaurants after grouping by address and rest_type\nfor p in ax.patches:\n    percentage='{:.1f}%'.format(100*p.get_width()\/total_rest)    # find % of rest types\n    x = p.get_x() + p.get_width() + 0.02\n    y = p.get_y() + p.get_height()\/2\n    ax.annotate(percentage, (x,y), ha=\"left\", color='black')\nplt.show()","f1c8deaa":"#Preprocessing of Cuisines\ncuisines_df = df.groupby(['address', 'cuisines']).cuisines.nunique().index.to_frame()\ncuisines_temp_df = pd.DataFrame()\ncuisines_temp_df = cuisines_df.cuisines.str.strip().str.split(',', expand=True)","ac5b76a6":"cuisines = pd.DataFrame()\ncuisines = pd.concat([cuisines_temp_df.iloc[:,0].str.strip(), cuisines_temp_df.iloc[:,1].str.strip(), cuisines_temp_df.iloc[:,2].str.strip(),\n                     cuisines_temp_df.iloc[:,3].str.strip(),cuisines_temp_df.iloc[:,4].str.strip(),cuisines_temp_df.iloc[:,5].str.strip(),\n                     cuisines_temp_df.iloc[:,6].str.strip(),cuisines_temp_df.iloc[:,7].str.strip()]).value_counts()","0ccbff82":"plt.figure(figsize=(12,8))\nsns.set_style('white')\ncuisine = cuisines[:15]\nax = sns.barplot(x=cuisine, y=cuisine.index, palette=\"Greys_d\")\nsns.despine()\nplt.title('Top 15 cuisines served in Bangalore')\nplt.xlabel('Number of restaurants')\nplt.ylabel('Name of cuisines')\ntotal_rest = len(cuisines_df)     #restaurants after grouping by address and rest_type\nfor p in ax.patches:\n    percentage='{:.1f}%'.format(100*p.get_width()\/total_rest)    # find % of rest types\n    x = p.get_x() + p.get_width() + 0.02\n    y = p.get_y() + p.get_height()\/2\n    ax.annotate(percentage, (x,y), ha=\"left\", color='black')\nplt.show()","f1080437":"cuisines[cuisines.index == \"Healthy Food\"]","743087b9":"location_df = df.groupby(['address', 'location']).location.nunique().index.to_frame()","88e7943f":"print(location_df['location'].value_counts()[location_df['location'].value_counts().index.str.contains('Koramangala')])","9805fdd3":"print(\"Number of restaurants in Koramangala:\",\n    sum(location_df['location'].value_counts()[location_df['location'].value_counts().index.str.contains('Koramangala')]))","a5e7b14b":"plt.figure(figsize=(12, 8))\nsns.set_style('white')\nlocations= location_df['location'].value_counts()[:15]\nax = sns.barplot(x= locations, y = locations.index, palette='Greys_d')\nsns.despine()\nplt.title('Top 15 locations for foodies in Bangalore')\nplt.xlabel('Number of restaurants')\nplt.ylabel('Name of Location')\nfor p in ax.patches:\n    width = p.get_width()\n    ax.text(width+0.007, p.get_y() + p.get_height() \/ 2. + 0.2, format(width), \n            ha=\"left\", color='black')\nplt.show()","7d300c5b":"#Preprocessing dish liked\ndish_liked_df = df.groupby(['address', 'dish_liked']).dish_liked.nunique().index.to_frame()\ndish_liked_temp_df = pd.DataFrame()\ndish_liked_temp_df = dish_liked_df.dish_liked.str.strip().str.split(',', expand=True)","cc5f9298":"dish_liked = pd.DataFrame()\ndish_liked = pd.concat([dish_liked_temp_df.iloc[:,0].str.strip(), dish_liked_temp_df.iloc[:,1].str.strip()]).value_counts()\ndish_liked","cb321987":"plt.figure(figsize=(12, 8))\nsns.set_style('white')\ndishes = dish_liked[:15]\nax = sns.barplot(x= dishes, y = dishes.index, palette='Greys_d')\nsns.despine()\nplt.title('Top 15 commonly served dishes in Bangalore')\nplt.xlabel('Number of restaurants')\nplt.ylabel('Name of dishes')\ntotal = len(dish_liked_df)\n\nfor p in ax.patches:\n        percentage = '{:.1f}%'.format(100 * p.get_width()\/total)\n        x = p.get_x() + p.get_width() + 0.02\n        y = p.get_y() + p.get_height()\/2\n        ax.annotate(percentage, (x, y),\n        ha=\"left\", color='black')\nplt.show()","83c299db":"#Replacing restaurants with their ratings given as New to NAN and dropping them finally\nrating_df = df.copy()\nrating_df['rate'] = rating_df['rate'].replace('NEW',np.NaN)\nrating_df['rate'] = rating_df['rate'].replace('-',np.NaN)\nrating_df.dropna(how = 'any', inplace = True)","a52cf495":"rating_df['rate'] = rating_df.loc[:,'rate'].replace('[ ]','',regex = True)\nrating_df['rate'] = rating_df['rate'].astype(str)\nrating_df['rate'] = rating_df['rate'].apply(lambda r: r.replace('\/5',''))\nrating_df['rate'] = rating_df['rate'].apply(lambda r: float(r))","14422f52":"plt.figure(figsize=(20, 8))\nsns.set_style('white')\nax = sns.countplot(x='rate', hue='book_table', data=rating_df, palette='Greys_d')\nsns.despine()\nplt.title('Rating of Restaurants vs Table Booking')\nplt.xlabel('Rating')\nplt.ylabel('Number of restaurants')\nplt.show()","4bb18d45":"plt.figure(figsize=(20, 8))\nsns.set_style('white')\nax = sns.countplot(x='rate', hue='online_order', data=rating_df, palette='Greys_d')\nsns.despine()\nplt.title('Rating of Restaurants vs Online Delivery')\nplt.xlabel('Rating')\nplt.ylabel('Number of restaurants')\nplt.show()","a167b665":"rating_df.loc[rating_df['rate'] >= 4, 'rating_category'] = 'Above 4'\nrating_df.loc[(rating_df['rate'] >= 3) & (rating_df['rate'] < 4), 'rating_category'] = 'Above 3'\nrating_df.loc[(rating_df['rate'] >= 2) & (rating_df['rate'] < 3), 'rating_category'] = 'Above 2'\nrating_df.loc[rating_df['rate'] < 2, 'rating_category'] = 'Above 1'","f9ac3564":"def dish_served_per_rest_type(rest_type):\n    dishLiked_restType_df = df.groupby(['address', 'dish_liked', 'rest_type']).dish_liked.nunique().index.to_frame()\n    dishLiked_restType_temp_df = pd.DataFrame()\n    dishLiked_restType_temp_df = dishLiked_restType_df[dishLiked_restType_df['rest_type'] == rest_type].dish_liked.str.strip().str.split(',', expand=True)\n    dish_liked_temp_df = pd.DataFrame()\n    dish_liked_temp_df = pd.concat([dishLiked_restType_temp_df.iloc[:,0].str.strip(), dishLiked_restType_temp_df.iloc[:,1].str.strip()]).value_counts()\n    temp_df = pd.DataFrame({'dishes':dish_liked_temp_df[:10], 'group':dish_liked_temp_df[:10].index})\n    norm = matplotlib.colors.Normalize(vmin=min(dish_liked_temp_df[:10]), vmax=max(dish_liked_temp_df[:10]))\n    colors = [matplotlib.cm.Blues(norm(value)) for value in dish_liked_temp_df[:10]]\n    squarify.plot(sizes=temp_df['dishes'], label=temp_df['group'], alpha=0.8, color=colors)\n    plt.title(\"Top 10 dishes served in \"+rest_type, fontsize=15, fontweight='bold')\n    plt.axis('off')\n    plt.show()","5811f62c":"dish_served_per_rest_type('Quick Bites')","6bf02464":"dish_served_per_rest_type('Casual Dining')","3624cdc6":"dish_served_per_rest_type('Cafe')","6d811485":"dish_served_per_rest_type('Delivery')","665e5b8d":"dish_served_per_rest_type('Dessert Parlor')","85907046":"dish_served_per_rest_type('Takeaway')","4467d3d9":"dish_served_per_rest_type('Bar')","d260ebcc":"costfortwo_df = df.groupby(['address', 'approx_cost(for two people)'])\ncost_df = costfortwo_df['approx_cost(for two people)'].nunique().index.to_frame()","542c5f5d":"cost_df['approx_cost(for two people)'] = cost_df['approx_cost(for two people)'].str.replace(',', '').astype(float)","fd17b707":"plt.figure(figsize=(8,8))\ncost_dist = cost_df['approx_cost(for two people)'].dropna()\nsns.distplot(cost_dist, bins=20, kde_kws={'color':'k', 'lw':3, 'label':'KDE'})\nplt.show()","e04ac9a8":"rating_df_temp = rating_df.groupby(['address', 'rate'])\nplt.figure(figsize=(8,8))\nrating = rating_df_temp.rate.nunique().index.to_frame()['rate']\nsns.distplot(rating,bins=20,kde_kws={\"color\": \"k\", \"lw\": 3, \"label\": \"KDE\"})\nplt.show()","efca3bd2":"rating.describe()","8f2e61e8":"cost_rating_temp_df = df.groupby(['address', 'rate', 'approx_cost(for two people)', 'book_table', 'online_order'])\ncost_rating_df = cost_rating_temp_df[['rate', 'approx_cost(for two people)', 'book_table', 'online_order']].nunique().index.to_frame()","ce629a04":"cost_rating_df['approx_cost(for two people)'] = cost_rating_df['approx_cost(for two people)'].str.replace(',','').astype(float)\ncost_rating_df['rate'] = cost_rating_df['rate'].apply(lambda x: float(x.split('\/')[0]) if len(x) > 3 else np.nan).dropna()","99bd3347":"fig, axis = plt.subplots(nrows=1, ncols=2, figsize=(16,6))\nsns.scatterplot(x='rate', y='approx_cost(for two people)', hue='book_table', data=cost_rating_df, ax=axis[0])\nsns.scatterplot(x='rate', y='approx_cost(for two people)', hue='online_order', data=cost_rating_df, ax=axis[1])\nplt.show()","cbfbfcb0":"regression_df = zomato_data.copy()","2c1724db":"regression_df=regression_df.drop(['url','dish_liked','phone'],axis=1)\nregression_df.dropna(how='any', inplace=True)","84c89cf9":"#Preprocessing rate\nregression_df = regression_df.loc[regression_df['rate'] !='NEW']\nregression_df = regression_df.loc[regression_df['rate'] !='-'].reset_index(drop=True)\nremove_slash = lambda x: x.replace('\/5', '') if type(x) == np.str else x\nregression_df['rate'] = regression_df['rate'].apply(remove_slash).str.strip().astype('float')","4b8747d9":"#Preprocessing approx_cost(for two people)\nregression_df['approx_cost(for two people)'] = regression_df['approx_cost(for two people)'].dropna()\nregression_df['approx_cost(for two people)'] = regression_df['approx_cost(for two people)'].astype(str)\nregression_df['approx_cost(for two people)'] = regression_df['approx_cost(for two people)'].apply(lambda x: x.replace(',','.'))\nregression_df['approx_cost(for two people)'] = regression_df['approx_cost(for two people)'].astype(float)","dc5e9a05":"regression_df['name'] = regression_df['name'].apply(lambda x: x.title())\nregression_df['online_order'].replace(('Yes', 'No'), (True, False), inplace=True)\nregression_df['book_table'].replace(('Yes', 'No'), (True, False), inplace=True)","6710fe28":"def encoding(regression_df):\n    for column in regression_df.columns[~regression_df.columns.isin(['rate', 'approx_cost(for two people)', 'votes'])]:\n        regression_df[column] = regression_df[column].factorize()[0]\n    return regression_df\n\nregression_df_en = encoding(regression_df)","849dd291":"plt.figure(figsize=(15,10))\nsns.heatmap(regression_df_en.corr(), annot=True, cmap='Greys')\nplt.title('Correlation Heatmap', size=20)\nplt.show()","24a4eba5":"#Independent variables and dependent variable\nx = regression_df_en.iloc[:, [2,3,5,6,7,8,9,11]]\ny = regression_df_en['rate']","79d47fd5":"#Splitting dataset into training and testing dataset\nx_train, x_test, y_train, y_test = train_test_split(x, y, test_size = 0.2)","4ec0503c":"#Random Forest Regression\nmodel = RandomForestRegressor(n_estimators=500)\nmodel.fit(x_train, y_train)","5cf721fb":"print('Accuracy: {}'.format(model.score(x_test, y_test)))","4568fc83":"We can further filter out group_1 on the basis of adderss","c5069f87":"<b> Top restaurant types in Bangalore","3a91de24":"<b> Encoding","889bc74f":"<h3> Basic Regression Analysis using Random Forest Regressor","8f90cd0e":"<b>Let's see the trend restaurant type wise","70610b6d":"Burgers are quite famous in most of the Restaurant types","771ef6b9":"There are very few restaurants with cost more than 1000. Overall distribution of cost in right skewed","b0f3b067":"Hi all, This is a beginners' work. Feel Free to upvote it if you like. My goal is to learn and contriburte to the data science community.","b5e41250":"<b> Top locations for foodies in Bangalore","b9018d19":"<b> Online Delivery vs Rating","c505c815":"- RandomForest regressor shows a 92% accuracy score. We can test this using other models as well and compare different algorithms","ce4b8757":"<b> Correlation Heatmap","b2995ef6":"<b>Importing required libraries","6ab6fb56":"<h3>Introduction<\/h3>","aad2c2f3":"1. As there are more quick bites restaurants in Bangalore, we can see Burgers and Pasta being served more.\n2. Biryani is the most famous Indian dish being served","1ead8355":"<b> Modelling","8cfb40e0":"<b> Some data cleaning for rating column","25c2d90e":"<b> Top Cuisines served in Bangalore","f701d322":"<b> Relation of Rating and Average cost (for two) for both Table booking and Online order","ee1a688b":"1. There is no trend between cost and rating \n2. Generally we see restaurants with table booking facitlity tends to get higher rating\n3. There is not much relationship between cost of restaurants accepting online orders vs. not accepting orders, but mostly costly restaurants doesnot accept online orders ","928ebfbe":"<h4> Work done in this Kernel <\/h4>","b680356e":"<h3> Let's see some relation between different variables","1c3d3adb":"<b> Load the data and make a copy of it ","8e2499b9":"<h4> Let's get started! <\/h4>","85f6a51f":"<b> Some transformations before modelling","7f4305e2":"This kernel was made for learning purpose and was referenced from some other kernels as well. ","f40566b1":"<b> Table Booking vs Rating","557f1645":"<b> Top restaurant chains in Banglore","b2d0826a":"From the above data we can see that for the same restaurant we have different url, listed_in(city), also different vote counts\nWe can remove the url, listed_in(type) and listed_in(city) and won't lose any information as these are quite generalize form of rest_type\n\nLet's do some data cleaning before our analysis","8c0af42e":"1. Around 40% restaurants serves North Indian cuisines, followed by Chinese and South Indian\n2. There are around 200+ restaurants in Bangalore serving healthy food","11ead555":"1. Whitefield, BTM, Electronic City, Marathahali and HSR has the most number of restaurants\n2. Koramangala (combining all blocks) has 868 restaurants","ea02dcd0":"Based on the above info, we can consider address as unique identifier for distinct restaurants","46ad5b62":"<b> Distribution of Rating","fad5502c":"<b> Distribution of cost for two people","8d2bdf38":"1. Quick Bites, Casual Dining and Delivery are common restaurant types in bangalore\n2. Bhojanalya being the rarest rest_type","f8aee588":"<h3>Now let's start analyzing the data with help of visualizations","f80e8f40":"Majority of restaurants are rated more than 3.5, the distribution tends to be negative\/left skew","c9a07606":"<b> Top dishes served in Bangalore","e8ea7c0a":"CCD has the highest number of outlets in Banglore, followed by Domino's","547c687b":"<b> Performing some EDA to better understand the data","ca444f12":"- Importing and cleaning of data\n- Analysis of Restaurants based on - \n    1. Rating\n    2. Online Delivery\n    3. Type\n    4. Table booking facility\n    5. Cuisine Type\n    6. Average Price for two\n    7. Restaurant Chains\n    8. Location and many more\n- Regression taking rating as Depedent variable using Random Forest Regressor","0465fd59":"We can also remove phone number as it will not help us in our analysis"}}