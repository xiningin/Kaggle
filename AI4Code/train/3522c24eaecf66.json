{"cell_type":{"2efc0a71":"code","f838031d":"code","3d22023f":"code","3f71c293":"code","4afb6be5":"code","063adeb1":"code","b238be17":"code","4debc0c9":"code","247c6ab9":"code","701246e1":"markdown","0c92a4d0":"markdown","edc6257b":"markdown","0dc4d101":"markdown","4902d782":"markdown","1d3c43d7":"markdown","36934a21":"markdown","180d5968":"markdown","87cfa503":"markdown","02f1d792":"markdown","e7121b7b":"markdown"},"source":{"2efc0a71":"import numpy as np\nimport pandas as pd\n\nimport matplotlib.pyplot as plt\n","f838031d":"datapath = '..\/input\/m5-forecasting-accuracy'\n\n# import data files\ncalendar = pd.read_csv(f'{datapath}\/calendar.csv', parse_dates=['date'])\nsales_train_validation = pd.read_csv(f'{datapath}\/sales_train_validation.csv')\n","3d22023f":"# tags = 'id', 'item_id', 'dept_id', 'cat_id', 'store_id', 'state_id'\n# data = 'd_1' -> 'd_1913'\ntags, data = sales_train_validation.iloc[:, :6], sales_train_validation.iloc[:, 6:]\ndata.columns = calendar.loc[:data.columns.size-1,'date']\n","3f71c293":"df = data.sum(axis=0)\ndf.plot(figsize=(15,4))\n","4afb6be5":"data.columns = calendar.loc[:data.columns.size-1,'wday']\ndata.transpose().groupby('wday').mean().transpose().sum().plot()\n","063adeb1":"data.columns = calendar.date.dt.day.loc[:data.columns.size-1]\ndata.transpose().groupby('date', sort=True).mean().transpose().sum().plot(figsize=(15,4))","b238be17":"calendar['weekno'] = ((calendar.date.dt.day-1)\/7).astype(int) # zero based: 0 = week 1\ndayno = 0\ndaynos = []\nfor index, row in calendar.iterrows():\n    if dayno == 0:\n        dayno = row.wday+row.weekno*7\n    if (row.wday==1) & (row.weekno==0): # first Saturday\n        dayno = 1\n    daynos.append(dayno)\n    dayno = dayno+1\n\ncalendar['dayno'] = daynos\n","4debc0c9":"data.columns = calendar.loc[:data.columns.size-1,'dayno']\ndata.transpose().groupby('dayno', sort=True).mean().transpose().sum().plot(figsize=(15,4))","247c6ab9":"df = calendar.groupby('dayno', sort=True)['date'].count().plot(figsize=(15,4))","701246e1":"Let's plot the aligned day-of-month seasonality.","0c92a4d0":"Generally, more items are sold in the first half of the month than in the second. More items are sold on the 3rd than any other day. The 25th takes a big hit. Although rumors abound, no causation is implied by this chart.  \n  \nWhat if we align the dates to the first Saturday of each month?","edc6257b":"# This notebook investigates an overlooked seasonality\nQuick & dirty charts to demonstrate the daily trend each month","0dc4d101":"Define workspace","4902d782":"The third and fourth weekends are generally lower than the first two. But, why does the fifth weekend look wanky?","1d3c43d7":"> Split labels from numeric data","36934a21":"Let's plot daily sales.","180d5968":"Import libraries","87cfa503":"Let's plot the day-of-week seasonality.","02f1d792":"Generally, more items are sold on the weekend.  \n  \nLet's plot the day-of-month seasonality.","e7121b7b":"The fifth weekend is rare, only 23 occurances in the 65 months plotted. This may influence the uncertainty in the fifth week."}}