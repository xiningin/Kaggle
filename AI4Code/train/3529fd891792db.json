{"cell_type":{"26d3ebc1":"code","01dc4d6c":"code","8e191661":"code","523a5711":"code","ccb52b4f":"code","4b572f55":"code","0d690f15":"code","c47f1ab5":"code","64817f0c":"code","0e7f8426":"code","cc0c75c1":"code","1ad3cdd6":"code","c0835944":"code","a636deba":"code","5cfba01a":"code","167028fe":"code","83e98c98":"code","a2ecf3b2":"code","22fb2e7b":"code","b82daea4":"code","f4dc365e":"code","7a1e58a1":"code","1a553944":"code","c25fa67b":"code","34931b5d":"code","4ee94b56":"code","9f284103":"code","a486481c":"markdown","51340668":"markdown","bf4505c2":"markdown","80e28427":"markdown","5fc7c100":"markdown","a27ea9dc":"markdown","d9f2aa49":"markdown","52ba4bda":"markdown","d278bb59":"markdown","136ca1d3":"markdown","539bc54d":"markdown","de896dc9":"markdown","8688d69a":"markdown","547ef907":"markdown","c5362b31":"markdown","2e2da329":"markdown","66228807":"markdown","67b6b033":"markdown","cb6d7c93":"markdown","895f0dad":"markdown","0710ad1d":"markdown","a0e91ef3":"markdown","89185c33":"markdown"},"source":{"26d3ebc1":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n%matplotlib inline\n\nimport seaborn as sns\nimport plotly.express as px\nimport plotly.graph_objs as go\nfrom plotly.offline import iplot\nimport missingno as msno\n\nimport tensorflow as tf\nfrom catboost import CatBoostRegressor","01dc4d6c":"data = pd.read_csv('..\/input\/predict-test-scores-of-students\/test_scores.csv')\ndata.head()","8e191661":"msno.bar(data, figsize=(12,7))\nplt.show()","523a5711":"data.describe()","ccb52b4f":"data.info()","4b572f55":"data.classroom.unique()","0d690f15":"data.school_type.unique()","c47f1ab5":"data.school_setting.unique()","64817f0c":"data.teaching_method.unique()","0e7f8426":"data.lunch.unique()","cc0c75c1":"data.school.unique()","1ad3cdd6":"gender_to_result = data.groupby(['gender']).agg({'posttest':'mean'}).reset_index()\n\n\nfig = px.bar(gender_to_result, x='gender', y='posttest',\n            title='Dependence of gender on the mean test result')\niplot(fig)","c0835944":"school_type_to_result = data.groupby(['school_type']).agg({'posttest':'mean'}).reset_index()\n\n\nfig = px.bar(school_type_to_result, x='school_type', y='posttest',\n            title='Dependence of the type of school on the mean test result')\niplot(fig)","a636deba":"school_setting = data.school_setting.value_counts()\n\nfig = px.pie(school_setting, values=school_setting.values, names=school_setting.index,\n            title='The dependence of the location of the school on the result')\niplot(fig)\n\nschool_setting_to_result = data.groupby(['school_setting']).agg({'posttest':'mean'}).reset_index()\n\nfig2 = px.bar(school_setting_to_result, x='school_setting', y='posttest')\n\niplot(fig2)","5cfba01a":"number_of_students_to_results = data.groupby(['n_student']).agg({'posttest':'mean'}).reset_index()\n\nfig = px.scatter(number_of_students_to_results, x='n_student', y='posttest',\n                 size='posttest', color='n_student', size_max=60,\n                 title='Dependence of the number of students in the class on the result on the exam')\n\niplot(fig)","167028fe":"data.head()","83e98c98":"for_corr = data.drop(['school','student_id','gender','classroom'], axis=1)\n\nfor_replace = {'school_setting':{'Urban':0, 'Suburban':1, 'Rural':2},\n               'school_type':{'Public':0, 'Non-public':1},\n               'teaching_method':{'Standard':0, 'Experimental':1},\n               'lunch':{'Does not qualify':0, 'Qualifies for reduced\/free lunch':1}}\n\nfor_corr = for_corr.replace(for_replace)","a2ecf3b2":"for_corr.head()","22fb2e7b":"corr = for_corr.corr()\n\nplt.figure(figsize=(14,8))\nsns.heatmap(corr, \n        xticklabels=corr.columns,\n        yticklabels=corr.columns)\nplt.show()","b82daea4":"from sklearn.model_selection import train_test_split\nfrom sklearn.metrics import mean_squared_error","f4dc365e":"X = for_corr.drop('posttest', axis=1)\ny = for_corr['posttest'].values","7a1e58a1":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.25, random_state=142)","1a553944":"cat_model = CatBoostRegressor(loss_function='RMSE', random_state=142, verbose=50)\n\ncat_model.fit(X_train, y_train, early_stopping_rounds=100, eval_set=[(X_test, y_test)])\npred = cat_model.predict(X_test)\nprint(np.sqrt(mean_squared_error(pred, y_test)))","c25fa67b":"import lightgbm as lgbm\n\nlgb_model = lgbm.LGBMRegressor(loss_function='RMSE', random_state=142)\n\nlgb_model.fit(X_train, y_train, \n        eval_set=[(X_test, y_test)],  \n        early_stopping_rounds=100, \n        verbose=20)\npred = lgb_model.predict(X_test)\nprint(np.sqrt(mean_squared_error(pred, y_test)))","34931b5d":"my_test = X_test.iloc[0]\nmy_test.school_setting = 0.\nmy_test.school_type = 0.\nmy_test.teaching_method = 1.\nmy_test.n_student = 22.\nmy_test.lunch = 1.\nmy_test.pretest = 84.","4ee94b56":"cat_model.predict(my_test)","9f284103":"lgb_model.predict(my_test.values.reshape(1, -1))","a486481c":"if only I knew what it all means ...","51340668":"### Thanks for reading!","bf4505c2":"### Import necessary libraries","80e28427":"#### EDA","5fc7c100":"Student performance in non-public schools is almost 12 points higher","a27ea9dc":"Missing values in data","d9f2aa49":"## Exams are one of the most important parts of every student's life.<br> <br>\n### Each country has its own type of exam. This dataset provides information about the school, school setting, school type, classroom type, teaching method, number of students, gender and benefits per student.","52ba4bda":"#### LGBM","d278bb59":"#### The dependence of the location of the school on the result","136ca1d3":"#### I will do data analysis and regression model to predict the test result","539bc54d":"As we can see, there are many urban schools, but the result is the worst. The best result was for pupils from suburban schools, followed by rural schools","de896dc9":"### Training","8688d69a":"We can see that data haven't misses","547ef907":"### Correlation heatmap","c5362b31":"#### Dependence of gender on the test result","2e2da329":"#### Dependence of the type of school on the test result","66228807":"#### CatBoost","67b6b033":"### Read and explore the data ","cb6d7c93":"#### Dependence of the number of students in the class on the result on the exam","895f0dad":"The test result does not depend on gender","0710ad1d":"### Prepare to learning","a0e91ef3":"As we can see the number of students in the class is inversely proportional to the result on the exam","89185c33":"##### CatBoost model does better than LGBM, but dataset is so small then model is overfitting."}}