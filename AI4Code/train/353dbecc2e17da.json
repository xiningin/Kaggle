{"cell_type":{"b5397c6e":"code","24a90157":"code","b502f3a0":"code","0ec6377a":"code","7db64a03":"code","2bda4909":"code","91fc1cba":"code","07a50f1c":"code","23b02de2":"code","e3f61adb":"code","b09f3648":"code","8025777d":"code","85145ef0":"code","32e6aca6":"code","5474f64c":"code","01d58d9b":"code","20ce378f":"code","dddef4bf":"code","02521126":"code","7513996a":"code","b59ff634":"code","da93f8f9":"code","345b0041":"code","a6ee17fb":"code","6369a533":"code","412ee2ba":"code","12943efc":"code","78034f0e":"code","5f6dfd94":"code","3a4a4897":"code","ca59002b":"code","a2b6c7f4":"code","91258215":"markdown","7cbd37e8":"markdown","f580ff36":"markdown","c9811166":"markdown","e621d7c8":"markdown","822ad198":"markdown","9067ec3e":"markdown","d692677a":"markdown","c2dc4731":"markdown","06399144":"markdown","9cde832d":"markdown","0758a9e6":"markdown"},"source":{"b5397c6e":"#importing necesary packages\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.svm import SVC\nfrom sklearn.linear_model import SGDClassifier, LogisticRegression\nfrom sklearn.metrics import classification_report, accuracy_score\nfrom sklearn.preprocessing import StandardScaler, LabelEncoder\nfrom sklearn.model_selection import train_test_split, GridSearchCV, cross_val_score\nimport matplotlib.pyplot as plt\nplt.style.use('ggplot')\n%matplotlib inline\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","24a90157":"data=pd.read_csv('..\/input\/red-wine-quality-cortez-et-al-2009\/winequality-red.csv')","b502f3a0":"data.head(10)","0ec6377a":"data.info()","7db64a03":"#quality directly does not depend on fixed acity\nplt.figure(figsize=(10,6))\nsns.barplot(x='quality', y='fixed acidity', data=data, palette=\"magma\")","2bda4909":"#as quality increases voaltile acidity decreases\nplt.figure(figsize=(10,6))\nsns.barplot(x='quality', y='volatile acidity', data=data, palette=\"magma\")","91fc1cba":"#as quality increases citric acid content increases\nplt.figure(figsize=(10,6))\nsns.barplot(x='quality', y='citric acid', data=data, palette=\"magma\")","07a50f1c":"#as quality does not directly depend on residual sugar content\nplt.figure(figsize=(10,6))\nsns.barplot(x='quality', y='residual sugar', data=data, palette=\"magma\")","23b02de2":"#as quality increases chlorides content decreases\nplt.figure(figsize=(10,6))\nsns.barplot(x='quality', y='chlorides', data=data, palette=\"magma\")","e3f61adb":"#medium quality red wine have highest free sulfur dioxide\nplt.figure(figsize=(10,6))\nsns.barplot(x='quality', y='free sulfur dioxide', data=data, palette=\"magma\")","b09f3648":"#medium quality red wine have highest total sulfur dioxide\nplt.figure(figsize=(10,6))\nsns.barplot(x='quality', y='total sulfur dioxide', data=data, palette=\"magma\")","8025777d":"#quality directly depends on sulphates\nplt.figure(figsize=(10,6))\nsns.barplot(x='quality', y='sulphates', data=data, palette=\"magma\")","85145ef0":"#quality directly depends on alcohol\nplt.figure(figsize=(10,6))\nsns.barplot(x='quality', y='alcohol', data=data, palette=\"magma\")","32e6aca6":"#density and pH is almost similar in all cases hence we avoid it\nprint(\"Respectively Maximum and Minimum value of density: \", data['density'].max(), \"\\t\", data['density'].min())\nprint(\"Respectively Maximum and Minimum value of pH: \", data['pH'].max(), \"\\t\", data['pH'].min())","5474f64c":"#Dividing wine as good and bad by giving the limit for the quality\nbins=(2, 6.5, 8)\ngroup_names=['bad', 'good']\ndata['quality']=pd.cut(data['quality'], bins=bins, labels=group_names)","01d58d9b":"#changing the good labels to 1 and bad to 0 with a label encoder\nenc=LabelEncoder()\ndata['quality']=enc.fit_transform(data['quality'])","20ce378f":"data['quality'].value_counts()","dddef4bf":"X=data.drop('quality', axis=1)\ny=data['quality']","02521126":"sc=StandardScaler()\nX=sc.fit_transform(X)","7513996a":"X_train, X_test, y_train, y_test=train_test_split(X, y, test_size=0.3, random_state=42)","b59ff634":"lr=LogisticRegression()\nlr.fit(X_train, y_train)\ny_pred_lr=lr.predict(X_test)","da93f8f9":"accuracy_score(y_test, y_pred_lr)*100","345b0041":"print(classification_report(y_test, y_pred_lr))","a6ee17fb":"rf=RandomForestClassifier()\nrf.fit(X_train, y_train)\ny_pred_rf=rf.predict(X_test)","6369a533":"accuracy_score(y_test, y_pred_rf)*100","412ee2ba":"print(classification_report(y_test, y_pred_rf))","12943efc":"dt=DecisionTreeClassifier()\ndt.fit(X_train,y_train)\ny_pred_dt=dt.predict(X_test)","78034f0e":"accuracy_score(y_test, y_pred_dt)*100","5f6dfd94":"print(classification_report(y_test, y_pred_dt))","3a4a4897":"svc=SVC()\nsvc.fit(X_train, y_train)\ny_pred_svm=svc.predict(X_test)","ca59002b":"accuracy_score(y_test, y_pred_svm)*100","a2b6c7f4":"print(classification_report(y_test, y_pred_svm))","91258215":"# 3. Decision Tree","7cbd37e8":"No missing data...what a relief","f580ff36":"# 1. Logistic Regression","c9811166":"Applying Scaling, Xi=(Xi-mean)\/scale_factor","e621d7c8":"# Taking 7 to be the threshold for being good, we mark all the bad with 0 and good with 1","822ad198":"# 4. SVM","9067ec3e":"# 2. Random Forest ","d692677a":"# Therefore, according to EDA quality is dependent on\n* volatile acidity\n* citric acid\n* chlorides\n* free sulphur dieoxide\n* total sulphur dieoxide\n* sulphates\n* alcohol","c2dc4731":"# Acquiring Data","06399144":"An accuracy of 87% is obtained from decision tree","9cde832d":"An acuracy of 86% with the normal logistic regresion model","0758a9e6":"An accuracy of 88% with the random forest classifier"}}