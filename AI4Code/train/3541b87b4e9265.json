{"cell_type":{"63f208df":"code","b82a2dbb":"code","1a4790e9":"code","7d6d4ff9":"code","eaac7ad4":"code","19f2d9ad":"code","16bfe450":"code","fbd635d5":"code","ccb328df":"code","c019ec40":"markdown","692c638e":"markdown","85bc5a40":"markdown","0dc18eb1":"markdown","4d757f8a":"markdown","13c8286b":"markdown","16ca95dd":"markdown"},"source":{"63f208df":"import pandas as pd\nimport numpy as np\nfrom matplotlib import pyplot as plt\n\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.model_selection import cross_val_predict\nfrom sklearn.model_selection import StratifiedKFold\nfrom sklearn.metrics import roc_auc_score","b82a2dbb":"train = pd.read_csv(\"..\/input\/tabular-playground-series-nov-2021\/train.csv\")\noriginal = pd.read_csv(\"..\/input\/november21\/train.csv\")","1a4790e9":"(original.drop(['id', 'target'], axis=1).values - train.drop(['id', 'target'], axis=1).values).mean()","7d6d4ff9":"y = (train.target != original.target).astype(int)\nX = train.drop(['target'], axis='columns')","eaac7ad4":"binning = pd.qcut(X['id'], q=200, labels=False)\n(train.target != original.target).groupby(binning).mean().std()","19f2d9ad":"(train.target != original.target).groupby(binning).mean().plot()\nplt.show()","16bfe450":"original.target.groupby(binning).mean().plot()\nplt.show()","fbd635d5":"model = RandomForestClassifier()\ncv_preds = cross_val_predict(model, X, y, \n                             cv=StratifiedKFold(n_splits=10, shuffle=True, random_state=0), \n                             n_jobs=-1, method='predict_proba')","ccb328df":"print(roc_auc_score(y_true=y, y_score=cv_preds[:,1]))","c019ec40":"If we check the standard deviation of the switching rate, based on the ids, we notice that it is very low, compatible with a random choice of the elements.","692c638e":"As a reminder, we see that actually the id is correlated with the original target because different numeration arcs present different expected probability of positives (use the id as a predictor in your models).","85bc5a40":"It is left just to try adversarial validation and see if there is any hint for guessing correctly the switched ","0dc18eb1":"Unfortunately the label inversions look unpredictable. We cannot but try to incorporate this uncertainty in our models.","4d757f8a":"Also if we plot the values, we can see that the oscillations are limited and clearly not following a clear trend.","13c8286b":"https:\/\/www.kaggle.com\/criskiev has recently published the original data that has been removed at the early stages of the competition. This calls for a check if we can predict the switched labels with a model and manage to break through the 0.75 roc auc score in test (without relying on sheer luck).","16ca95dd":"Is the data different from the originally posted one? the answer is no.\nSo it means that we just concentrate on the labels."}}