{"cell_type":{"0225db5d":"code","2e8584ed":"code","d05967ed":"code","a137b9c8":"code","9e8ccc18":"code","874290f6":"code","f1898e9e":"code","65bcffe2":"code","074a007c":"code","d01655a0":"code","a67566be":"code","70fb02ed":"code","c066a251":"code","6c1882a2":"code","9d681b50":"code","1399e46c":"code","9d519371":"code","f8b82eb3":"code","eac92270":"code","467201e7":"code","ebea364c":"markdown","eaf472ec":"markdown","61834cfa":"markdown","131d5cc3":"markdown","3250c011":"markdown","792fbe81":"markdown","77faad0c":"markdown","68e4679a":"markdown","59305981":"markdown","bfd2ab35":"markdown","4b8493f5":"markdown","af7ecfa5":"markdown","0cc73467":"markdown","98ca7796":"markdown","5a3335fc":"markdown"},"source":{"0225db5d":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","2e8584ed":"# Library\nimport pandas as pd\nimport numpy as np\nfrom sklearn.linear_model import LinearRegression","d05967ed":"data = pd.read_csv(\"\/kaggle\/input\/advertising\/Advertising.csv\")\ndata.head()","a137b9c8":"X = data[[\"TV\"]] # independent variable\ny = data[\"sales\"] # dependent variable\n\nreg = LinearRegression()\nmodel = reg.fit(X,y)","9e8ccc18":"print(\"\u03b20 coefficient: \", model.intercept_)\nprint(\"\u03b21 coefficient: \", model.coef_)","874290f6":"print(\"R2 Value: \", model.score(X,y))","f1898e9e":"import seaborn as sns\nimport matplotlib.pyplot as plt\n\ng = sns.regplot(data[\"TV\"], data[\"sales\"], ci=None,scatter_kws={'color':'r','s':12});\ng.set_title(\"Sales Forecasting by Advertisement Regression Model\");\ng.set_xlabel(\"TV Spending\");\ng.set_ylabel(\"Number of Sales\");","65bcffe2":"model.predict([[30]])","074a007c":"sales = [[20], [25], [38]]\nmodel.predict(sales)","d01655a0":"# let's call our y values\ny.head()","a67566be":"# Let's call a predicted value using the model we have built\nmodel.predict(X)[0:5]","70fb02ed":"y_ = y[0:10]\ny_pred = pd.DataFrame(model.predict(X)[0:10])\ndf = pd.concat([y_, y_pred], axis=1)\ndf.columns = [\"y_\", \"y_pred\"]\ndf.head()","c066a251":"# Errors\ndf[\"errors\"] = df[\"y_\"] - df[\"y_pred\"]\ndf","6c1882a2":"df[\"mean_square\"] = df[\"errors\"] ** 2\ndf","9d681b50":"# If we take the average of this value\nnp.mean(df[\"mean_square\"])","1399e46c":"# we can build the model for multiple linear regression\n\ndata = pd.read_csv(\"\/kaggle\/input\/advertising\/Advertising.csv\")\ndata.head()","9d519371":"X = data.drop(\"sales\", axis=1)\ny = data[[\"sales\"]]","f8b82eb3":"import statsmodels.api as sms\nlm = sms.OLS(y,X)\nmodel = lm.fit()\nmodel.summary()","eac92270":"from sklearn.linear_model import LinearRegression\nfrom sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.20,\n                                                   random_state=42)\nlr = LinearRegression()\nmodel = lr.fit(X_train, y_train)\ny_pred = model.predict(X_test)","467201e7":"# let's look at our test error\nfrom sklearn.metrics import mean_squared_error\nnp.sqrt(mean_squared_error(y_test, y_pred))","ebea364c":"### let's estimate for more spending","eaf472ec":"> **Errors and Mean Error Squares**\n----\n\n* **Our aim is to minimize the difference between the actual values and the estimated values.**","61834cfa":"* **I will use the advertising dataset in this example. Let's import the libraries we will use**","131d5cc3":"> ### R2 Value\n\n---\n* **R2 is a value related to the explainability of the model. R2 provides us with the information that we can explain what percentage of the change in the dependent variable when we use the independent variables we have.**\n\n* **The smaller the ratio of the sum of the residuals to the sum of the means, the higher R2 will be.**","3250c011":"> ### The mean squared error is our mean error over the data. That is, when we square the difference between the predicted value and the actual value and take the average, we have reached the conclusion that our error is 9.2.","792fbe81":"> ## Model","77faad0c":"# *Multiple Linear Regression*\n---\n#### Linear regression analysis is generally examined under two main headings. The simple linear regression we mentioned above is used when a dependent is an independent variable. Multiple linear regression is used when there is one dependent and more than one independent variable.\n\n* Using multiple linear regression analysis; For example, suppose the dependent variable is y: basal metabolic rate and the independent variables are weight, height, and age. In such a study we use the multiple linear regression equation\n---\n                                                            \n                                y = b0 + b1x1 + b2x2 + b3x3 + .... bnxn + e\n\n---\n\n* In multiple linear regression, the relationship between one dependent and more than one independent variable is examined within the framework of the general objectives that we will mention below. The purpose of the research may be to achieve all or any of these objectives.\n    * Finding mathematical models for the relationship between the dependent variable and independent variables, identifying the structure between the variables, and summarizing and interpreting the data for regression purposes\n    * Find a model that better explains the dependent variable\n    * To find which of the independent variables thought to affect the dependent variable or which ones affect the dependent variable more\n---\n* Multiple linear regression has several assumptions:\n    * Errors are normally distributed\n    * The errors are independent of each other and there is no autocorrelation between them\n    * Variances of error terms for each observation are fixed\n    * There is no relationship between the variables and the error term\n    * There is no multicollinearity problem between independent variables\n---\n<center><img\nsrc=\"https:\/\/www.jmp.com\/en_hk\/statistics-knowledge-portal\/what-is-multiple-regression\/fitting-multiple-regression-model\/_jcr_content\/par\/styledcontainer_2069\/par\/lightbox_1c56\/lightboxImage.img.gif\/1548704005266.gif\" style=\"width:50%;height:50%;\">\n<\/center>\n\n                                                         \n                                                           ","68e4679a":"# ***Simple Linear Regression***","59305981":">  ### Regression Chart","bfd2ab35":"**We have advertising expenditures and sales data for TV, radio, newspaper. In this study, we will deal with TV and sales variables.**\n\n**Our aim is to model TV-advertisement expenditures and to conduct studies.**\n\n**We determined TV as the independent variable (x) and sales as the dependent variable (y).**","4b8493f5":"> ### We do the squaring to prevent positive and negative values from canceling each other out.","af7ecfa5":"- *In regression analysis; In statistical models involving two or more variables, the cause-effect relationship and the extent to which one or more of the variables affect one or more other variables are investigated. The main purpose is to find the mathematical function that expresses the relationship between dependent and independent variables. The effect of a one-unit variable in the independent variables on the dependent variable is observed.*\n\n---------\n\n\n- *The mathematical relationship between two or more variables is analyzed by Regression Analysis, and the direction and degree of the relationship is analyzed by Correlation Analysis.*\n\n---------\n\n- *The key point in linear regression is that our dependent value must be continuous while the independent variables must be measurable on a categorical or continuous measurement scale.\nIn simple linear regression we have one dependent and one independent variable.*\n\n---\n---\n\n### Model Equation:\n\n\n                                              y = b0 + b1x + e\n\n                                - b0 : the point where the line intersects the y-axis \n                                - b1 : slope of the line and regression coefficient \n                                - e : random error value\n\n\n----\n<center><img\nsrc=\"https:\/\/s3.amazonaws.com\/revue\/items\/images\/003\/917\/834\/original\/lr.png?1544073534\" style=\"width:50%;height:50%;\">\n<\/center>","0cc73467":"> **Prediction**\n---\n\n**Let's try to make predictions on the model we have trained. How much will I earn if I invest in TV?**\n\n---\n**For example, what is the estimated value of sales when 30 units of TV are spent?**","98ca7796":"* In this output we can see a summary of many important things.\n* I want to mention some metrics here\n    - R-squared (uncentered): Our r-squared value is the rate at which the change in the dependent variable can be explained by the independent variables.\n    - Adj. R-squared (uncentered): The adjusted r-squared is the corrected version of the r-squared value. When a new variable is added to the r-square data set, it swells, so the perception that r-square improves as a new set is added, this is wrong.\n    - Prob (F-statistic): The value used to test the significance of the model. \n    - coef: Beta coefficients\n    - std err: Standard error of coefficients\n    \n----\n**now let's build our model using sklearn library and train-test separation**","5a3335fc":"<center><img\nsrc=\"https:\/\/miro.medium.com\/max\/1400\/1*dG6m4wnx3ARPtZPd8qf1tQ.gif\" style=\"width:50%;height:50%;\">\n<\/center>\n\n"}}