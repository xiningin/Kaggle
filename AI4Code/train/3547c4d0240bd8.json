{"cell_type":{"4155d3ff":"code","3f1bfb7e":"code","d9db5408":"code","c7ab1ad6":"code","2a3560ce":"code","4d29668f":"code","eb267b0c":"code","b81dd750":"code","4fe54add":"code","f89cb829":"code","0fee7360":"code","83501c36":"code","7bbd8cd8":"code","5376c845":"code","7ed19a7f":"code","55e111f0":"code","a196f0bb":"code","fbb39b3b":"code","64bb6eb5":"code","7267d0e6":"code","fb38574b":"code","c304a5d9":"code","069016a7":"code","c60d2966":"code","c86a5d5e":"code","3a877eb8":"code","c7a83187":"code","e62cf753":"code","446bcf54":"code","9e5b91c2":"code","066130e5":"code","29747782":"code","0e9cec23":"code","82336fc3":"code","a52ceb76":"code","59269a0f":"code","17038bf6":"code","60a0ca70":"code","04e6c174":"markdown","c678224a":"markdown","e88f0ab4":"markdown","c2eeecad":"markdown","4826e8a9":"markdown","6c679ed3":"markdown","06153214":"markdown","93dd7380":"markdown","6e32eb11":"markdown","9552e783":"markdown","95b8e481":"markdown","cac600ce":"markdown","c7782b6a":"markdown","a0f7fa8e":"markdown"},"source":{"4155d3ff":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","3f1bfb7e":"import matplotlib.pyplot as plt\nimport seaborn as sn ","d9db5408":"data=pd.read_csv('\/kaggle\/input\/heart-disease-uci\/heart.csv')\ndata.head()","c7ab1ad6":"data.describe()","2a3560ce":"data.shape","4d29668f":"data.isna().sum()","eb267b0c":"## No Null values found, So we can proceed to EDA part","b81dd750":"# distribution of target variable \n\ndata.target.value_counts()\n","4fe54add":"print(\"Patients with Heart Disease : \",round((165\/303)*100,2))\n\nprint(\"Patients Not with Heart Disease : \",round((138\/303)*100,2))\n\n\n\n\n","f89cb829":"sn.boxplot(data.trestbps)","0fee7360":"sn.distplot(data.chol)","83501c36":"data[data.trestbps==200.00]","7bbd8cd8":"sn.boxplot(data.thalach)","5376c845":"data.sex.value_counts()","7ed19a7f":"pd.crosstab(data.cp,data.target).plot(kind=\"bar\",figsize=(20,6))\nplt.title('CP and No of Patient with heart disease')\nplt.xlabel('CP')\nplt.ylabel('Frequency')\nplt.show()","55e111f0":"pd.crosstab(data.sex,data.target).plot(kind=\"bar\",figsize=(20,6))\nplt.title('Sex and No of Patient with heart disease')\nplt.xlabel('Sex')\nplt.ylabel('Frequency')\nplt.show()","a196f0bb":"sn.regplot(data.age,data.trestbps)","fbb39b3b":"sn.barplot(x='ca',y='target',data=data)","64bb6eb5":"data[data.ca==4]","7267d0e6":"data.ca=data.ca.replace(4,0)","fb38574b":"pd.crosstab(data.ca,data.target).plot(kind=\"bar\",figsize=(20,6))\nplt.title('CA and No of Patient with heart disease')\nplt.xlabel('CA')\nplt.ylabel('Frequency')\nplt.show()","c304a5d9":"pd.crosstab(data.age,data.target).plot(kind=\"bar\",figsize=(20,6))\nplt.title('Age and No of Patient with heart disease')\nplt.xlabel('Age')\nplt.ylabel('Frequency')\nplt.show()","069016a7":"sn.regplot(data.age,data.thalach)","c60d2966":"corr_matrix=data.corr()\nplt.figure(figsize=(15,6))\nsn.heatmap(corr_matrix ,\n           annot = True,\n            linewidth = 0.5,\n            fmt = \".2f\",\n            cmap = \"YlGnBu\")","c86a5d5e":"from sklearn.ensemble import RandomForestClassifier\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.preprocessing import MinMaxScaler\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.model_selection import train_test_split\nfrom pandas import DataFrame\nfrom sklearn.metrics import accuracy_score,confusion_matrix\nfrom sklearn import metrics","3a877eb8":"variables=['sex','cp','fbs','restecg','exang','thal','ca','slope']\n\nfor i in variables:\n    data[i]=data[i].astype('category')","c7a83187":"data.head()","e62cf753":"data=pd.get_dummies(data)","446bcf54":"x = data.drop(['target'], axis = 1)\ny = data['target']","9e5b91c2":"x_train, x_test, y_train, y_test = train_test_split(x,y,test_size = 0.2, random_state = 5)","066130e5":"feature_scaler = MinMaxScaler()\nx_train = feature_scaler.fit_transform(x_train)\nx_test = feature_scaler.transform(x_test)","29747782":"radm_clf = RandomForestClassifier()\n\nparameters = {'n_estimators': [150,175,200,225,250,300,325,350,375,400],'criterion': ['gini','entropy'],'max_features':['auto','sqrt','log2']}\n\nclf = GridSearchCV(radm_clf, parameters, scoring='roc_auc' ,cv =5)\nclf.fit(x_train, y_train)\n\nclf.best_score_","0e9cec23":"clf.best_params_","82336fc3":"model=RandomForestClassifier(criterion = 'gini',max_features = 'log2',n_estimators = 150)","a52ceb76":"model.fit(x_train,y_train)","59269a0f":"accuracy = model.score(x_test,y_test)\nprint(accuracy)","17038bf6":"import scikitplot as skplt\npred=model.predict(x_test)\nmatrix6 = (y_test,pred)\nskplt.metrics.plot_confusion_matrix(y_test ,pred ,figsize=(10,5))","60a0ca70":"from sklearn.metrics import classification_report\n\nprint(\"Testing Accuracy :\", model.score(x_test, y_test))\ncr = classification_report(y_test, pred)\nprint(cr)","04e6c174":"All variables seem significant","c678224a":"# *Bivariate Analysis*","e88f0ab4":"> The above plot shows a positive correlation between Resting BP & Age.  That is, Resting BP increases with Age ","c2eeecad":"> Insight : People with higher CA are less likely to have a heart disease ","4826e8a9":"> People with chest pain 0 are less prone to having a Heart disease","6c679ed3":"#  *Accuracy of the model = 91.80%*","06153214":"> As 'ca' is supposed to be between 0-3 & 4 seems to be a value imputed by mistake, by looking at the target average for this, it seems to be 0. Therefore replae ca= 4 with ca = 0 ","93dd7380":"> Insight: Heart Rate Decrease with Age ","6e32eb11":"# ***Univariate Analysis***","9552e783":"> People above the age of 40 are more likely to have a heart disease. ","95b8e481":" ## **EXPLANATORY DATA ANALYSIS**","cac600ce":"# Predictive Modelling ","c7782b6a":"> Women are more likely to have a heart disease than Men, if we compare the ratio of Target(1):Target(0) for individuals sexes ","a0f7fa8e":"> **Imbalance :** No. of Males are almost 2x of No. of Females"}}