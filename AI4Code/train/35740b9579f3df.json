{"cell_type":{"66135ce7":"code","fa3bab5f":"code","5056ce71":"code","4acfe01c":"code","48fb9b1a":"code","44470742":"code","87b4e3c0":"code","185fae3b":"code","ed1d7b9e":"code","c7eb029f":"markdown"},"source":{"66135ce7":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","fa3bab5f":"train = pd.read_csv('\/kaggle\/input\/digit-recognizer\/train.csv')","5056ce71":"# Split available data to train and validation\nnsize = int(train.shape[0]*0.7)\ntrain_idx = np.random.randint(train.shape[0],size=nsize)\nval_idx = [x for x in range(0,train.shape[0]) if x not in train_idx]","4acfe01c":"def get_data(idx,train):\n    x = train.loc[idx,train.columns[train.columns!='label']]\n    y = train.loc[idx,'label'].values\n    x = np.reshape(np.asarray(x),(x.shape[0],28,28,1))\/255\n    y = np.asarray(y)\n    return (x,y)\n\nx_train,y_train = get_data(train_idx,train)\nx_val,y_val = get_data(train_idx,train)","48fb9b1a":"import tensorflow as tf\nfrom tensorflow import keras\nfrom tensorflow.keras import layers\n\nmodel = keras.Sequential(\n    [\n        layers.Conv2D(16, activation=\"relu\",kernel_size=(5,5),input_shape=(28,28,1)),\n        layers.Conv2D(32, activation=\"relu\",kernel_size=(5,5)),\n        layers.Dropout(0.3),\n        layers.Conv2D(64, activation=\"relu\",kernel_size=(5,5)),\n        layers.Flatten(),\n        layers.Dense(10,activation='softmax')\n    ]\n)\nmodel.summary()","44470742":"model.compile(optimizer='adam',metrics = ['accuracy'],loss = 'sparse_categorical_crossentropy')","87b4e3c0":"model.fit(x_train,y_train,epochs=10,batch_size=1000,validation_data=(x_val,y_val))","185fae3b":"test = pd.read_csv('\/kaggle\/input\/digit-recognizer\/test.csv')\nyy = model.predict(np.asarray(test).reshape(test.shape[0],28,28,1)\/255)","ed1d7b9e":"tt = np.argmax(yy, axis = 1)\ntt = pd.Series(tt,name=\"Label\")\noutput = pd.concat([pd.Series(range(1,28001),name = \"ImageId\"),tt],axis = 1)\noutput.to_csv('submission.csv',index=False)","c7eb029f":"**Build the model**"}}