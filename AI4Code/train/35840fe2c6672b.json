{"cell_type":{"01e3c874":"code","996afd27":"code","a499a6dc":"code","40d3c3e2":"code","3f07e624":"code","0f689416":"code","f2179012":"code","bf211e17":"code","2a994293":"code","6412df7f":"code","eeff8528":"code","f28d70d3":"code","d9f2715a":"code","3fe0c193":"code","19f5cc04":"code","ca8ef501":"code","323aeed1":"code","d38df850":"code","fd46b456":"code","e1261460":"code","0f8cd4ce":"markdown","fa8f3cdc":"markdown","1aa38eba":"markdown","dfc23596":"markdown","20e44e22":"markdown","d0d850a9":"markdown","59f56e21":"markdown","11160ba8":"markdown"},"source":{"01e3c874":"import numpy as np \nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport scipy.stats\nfrom scipy import stats\nimport tqdm\n\n%matplotlib inline","996afd27":"df = pd.read_csv(r'..\/input\/i2a2-nlp-2021-sentiment-analysis\/train.csv')\ndf.info()","a499a6dc":"df.head(10)","40d3c3e2":"for i in range(0,10):\n    print(\"Plavras: \",df.iloc[i,3].split())\n    print(\"Qtd palavras: \",len(df.iloc[i,3].split()))\n    print(\"Rating: \", df.iloc[i,13])\n    print()","3f07e624":"def contagem_palavras(df_dados):\n    num_words = []\n    for i in range(0,df_dados.shape[0]):\n        count_words = len(df_dados.iloc[i,3].split())\n        num_words.append(count_words)\n    print(len(num_words))\n    return num_words","0f689416":"df['num_words'] = contagem_palavras(df)","f2179012":"df.head(10)","bf211e17":"df_1 = df.loc[df[\"rating\"]==1][\"num_words\"]\ndf_2 = df.loc[df[\"rating\"]==2][\"num_words\"]\ndf_3 = df.loc[df[\"rating\"]==3][\"num_words\"]\ndf_4 = df.loc[df[\"rating\"]==4][\"num_words\"]\ndf_5 = df.loc[df[\"rating\"]==5][\"num_words\"]","2a994293":"print(\"ratings: \\n 1 -> \\n {0} \\n 2 -> \\n {1} \\n 3 -> \\n {2} \\n 4 -> \\n {3} \\n 5 -> \\n {4}\".format(df_1.describe(),df_2.describe(),df_3.describe(),df_4.describe(),df_5.describe()))","6412df7f":"#sns.displot(df, x=\"num_words\")\nsns.displot(df,x=\"num_words\",hue=\"rating\", kind=\"kde\", height=8.27, aspect=20.7\/8.27)","eeff8528":"def rating_perc_delta(df_num_words):\n    rating_high_perc = []\n\n    for i in tqdm.tqdm(df_num_words):\n        p_1 = stats.percentileofscore(df_1, i+df_1.std()\/2)-stats.percentileofscore(df_1, i-df_1.std()\/2)\n        p_2 = stats.percentileofscore(df_2, i+df_2.std()\/2)-stats.percentileofscore(df_2, i-df_2.std()\/2)\n        p_3 = stats.percentileofscore(df_3, i+df_3.std()\/2)-stats.percentileofscore(df_3, i-df_3.std()\/2)\n        p_4 = stats.percentileofscore(df_4, i+df_4.std()\/2)-stats.percentileofscore(df_4, i-df_4.std()\/2)\n        p_5 = stats.percentileofscore(df_5, i+df_5.std()\/2)-stats.percentileofscore(df_5, i-df_5.std()\/2)\n\n        probs_num_word = [p_1,p_2,p_3,p_4,p_5]\n        #print(i)\n        #print(probs_num_word)\n        max_value = max(probs_num_word)\n\n        #print(max_value)\n\n        max_index = probs_num_word.index(max_value)+1\n        #print(max_index)\n        rating_high_perc.append(max_index)\n    \n    return rating_high_perc","f28d70d3":"rating_df = contagem_palavras(df)\ndf[\"calc_rating\"] = rating_perc_delta(rating_df)","d9f2715a":"df.head(10)","3fe0c193":"df[\"acerto\"] = df[\"rating\"] - df[\"calc_rating\"]\nnum_acertos = df[\"acerto\"].value_counts(dropna=False)","19f5cc04":"print(num_acertos[1])\nprint(num_acertos[1]\/sum(num_acertos))","ca8ef501":"df_test = pd.read_csv(r'..\/input\/i2a2-nlp-2021-sentiment-analysis\/test.csv')\ndf_subm = pd.read_csv(r'..\/input\/i2a2-nlp-2021-sentiment-analysis\/sample_submission.csv')","323aeed1":"df_test.head(10)","d38df850":"df_subm.head(10)","fd46b456":"rating_test = contagem_palavras(df_test)\ndf_subm[\"rating\"] = rating_perc_delta(rating_test)","e1261460":"df_subm.to_csv(r'.\/sample_submission.csv', index=False)","0f8cd4ce":"Entretanto, ao analisarmos as distribui\u00e7\u00f5es das quantidade de palavras para cada um dos \"ratings\", nota-se uma certa sobreposi\u00e7\u00e3o das distribui\u00e7\u00f5es o que indica que a metodologia utilizada parece n\u00e3o ser a mais adequada.","fa8f3cdc":"Separamos os dados em cinco grupos para se extrair a frequencia da quantidade de palavras em cada \"review_text\" para cada um dos 5 (cinco) \"ratings\"","1aa38eba":"N\u00e3o obstante os resultados n\u00e3o satisfat\u00f3rios, utilizamos a abordagem para os dados de teste.","dfc23596":"# # O objetivo deste notebook \u00e9 realizar alguns testes preliminares e tentativos para verificar se o tamnho do texto do \"review_text\" de um produto teria alguma influ\u00eancia no \"rating\" do referido produto com uma abordagem \"alternativa\".","20e44e22":"Passamos ent\u00e3o a testar os dados para verificar se \u00e9 poss\u00edvel utilizar a distribui\u00e7\u00e3o das quantidades das palavras para classificar os produtos segundo os seus respectivos ratings. Utilizamos para tanto um intervalo em torno de cada uma das quantidades e calculamos a diferen\u00e7a entre os percentis dos valores das extreminadades deste intervalo, diferen\u00e7a esta que poderia ser interpretada como uma \"probabilidade\" de determinado valor estar no referido intervalo. \n\nPosteriormente, comparamos os valores obtidos e extra\u00edmos o maior deles para a atribui\u00e7\u00e3o do \"rating\".","d0d850a9":"Analisando algumas estat\u00edsticas b\u00e1sicas, parece haver ind\u00edcios que a quantidade de palavras tem rela\u00e7\u00e3o com o \"rating\" pois o piores \"rating\" tem m\u00e9dias maiores nas quantidade de palavras.","59f56e21":"Numa analise preliminar com uma mostra muito pequena, parece haver ind\u00edcios que os \"reviewer_text\" com mais palavras t\u00eam os \"rating\" ruins.","11160ba8":"Nota-se que como hav\u00edamos aferido com os gr\u00e1ficos das distribui\u00e7\u00f5es a abordagem n\u00e3o \u00e9 muito adequada pois, neste caso, teve uma taxa de acerto de apenas 30% aproximadamente."}}