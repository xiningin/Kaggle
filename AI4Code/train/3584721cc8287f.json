{"cell_type":{"93766ec8":"code","a8721af5":"code","42715809":"code","90b88ef0":"code","a8079102":"code","8255eb82":"code","1d51b8ac":"code","831d9144":"code","cd08dbd4":"code","826b8ec2":"code","f5173274":"markdown","8e4384f7":"markdown","7922e05b":"markdown"},"source":{"93766ec8":"import numpy as np\nimport pandas as pd\nfrom nltk.corpus import stopwords\nfrom sklearn.feature_extraction.text import TfidfVectorizer","a8721af5":"train = pd.read_csv('\/kaggle\/input\/tweet-sentiment-extraction\/train.csv')\ntest = pd.read_csv('\/kaggle\/input\/tweet-sentiment-extraction\/test.csv')\nsub = pd.read_csv('\/kaggle\/input\/tweet-sentiment-extraction\/sample_submission.csv')","42715809":"# Because train.text contains NaN\n# https:\/\/www.kaggle.com\/c\/tweet-sentiment-extraction\/discussion\/138213\ntrain.dropna(subset=['text'], inplace=True)","90b88ef0":"train.shape, test.shape","a8079102":"train.head()","8255eb82":"positive_words = []\nnegative_words = []\nneutral_words = []\n\nfor row in (train.query('sentiment==\"positive\"')['selected_text']):\n    positive_words += row.split(' ')\n\nfor row in (train.query('sentiment==\"negative\"')['selected_text']):\n    negative_words += row.split(' ')\n\nfor row in (train.query('sentiment==\"neutral\"')['selected_text']):\n    neutral_words += row.split(' ')\n\ndata = [\n    ' '.join(positive_words),\n    ' '.join(negative_words),\n    ' '.join(neutral_words)\n]\n\nstopWords = stopwords.words(\"english\")\nvectorizer = TfidfVectorizer(stop_words=stopWords)\nX = vectorizer.fit_transform(data).toarray()\n\ntfidf_df = pd.DataFrame(X.T, index=vectorizer.get_feature_names(),\n                        columns=['positive', 'negative', 'neutral'])","1d51b8ac":"tfidf_df.shape","831d9144":"tfidf_df.sort_values('positive', ascending=False).head(10)","cd08dbd4":"tfidf_df.sort_values('negative', ascending=False).head(10)","826b8ec2":"tfidf_df.sort_values('neutral', ascending=False).head(10)","f5173274":"# Top 10 negative words","8e4384f7":"# Top 10 neutral words","7922e05b":"# Top 10 positive words"}}