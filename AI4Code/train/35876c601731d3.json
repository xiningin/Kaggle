{"cell_type":{"f2717dc9":"code","6d088534":"code","aa949617":"code","764970f7":"code","36bd3c55":"code","cca8be75":"code","512aa3d5":"code","7fd1c66a":"code","ee0fa963":"code","7943be3e":"code","ca60bc3e":"code","9591f236":"code","ed26c63f":"code","b9221047":"code","6bca6dfb":"code","4ee54eea":"code","66a55eea":"code","6f64e4e2":"code","423ea6cf":"code","0cd7bd9f":"markdown","b2b894c1":"markdown","fd0c562c":"markdown","12a7572d":"markdown","d938d47c":"markdown","834eaf6d":"markdown","617bbb33":"markdown","083ac506":"markdown","df360359":"markdown","fe8f9011":"markdown","6b9a5961":"markdown","a3472bbe":"markdown","148f74aa":"markdown","bab842d0":"markdown","16ae64f2":"markdown","9e4d487e":"markdown","b25dbc22":"markdown","17f2649a":"markdown","30fd6bb9":"markdown","947e4a4f":"markdown","418d3ef2":"markdown","494c6570":"markdown","44f037d5":"markdown","d2444c01":"markdown","e2abddaf":"markdown","f9b8a27b":"markdown","719e7d1b":"markdown","e99f680c":"markdown","d6443c35":"markdown","6b5f4c8c":"markdown","38e20e30":"markdown","e55fefde":"markdown","c9f8e9f4":"markdown","1273ec66":"markdown","f8fe3302":"markdown","1e1f0be7":"markdown","2eddc0bb":"markdown","ba4f0150":"markdown"},"source":{"f2717dc9":"# lets see the image \n\nfrom PIL import Image, ImageDraw\n\nimg = Image.open('..\/input\/nfl-health-and-safety-helmet-assignment\/images\/57503_000116_Endzone_frame443.jpg')\n\nimg","6d088534":"import pandas as pd \n\ndf = pd.read_csv('..\/input\/nfl-health-and-safety-helmet-assignment\/image_labels.csv')\ndf = df.where(df[\"image\"]==\"57503_000116_Endzone_frame443.jpg\").dropna()\n\ndraw_obj = ImageDraw.Draw(img)\n\nfor _ ,(l, w, t, h) in df[['left', 'width', 'top', 'height']].iterrows():\n        draw_obj.rectangle(((l, t), (l + w, t + h)), outline=(255, 0, 0), width=2)\n\nimg","aa949617":"sub_df = pd.read_csv('..\/input\/nfl-health-and-safety-helmet-assignment\/sample_submission.csv')\nsub_df","764970f7":"#sub_df.info()","36bd3c55":"#folders","cca8be75":"# load the file\n\ndf_image_labels = pd.read_csv('..\/input\/nfl-health-and-safety-helmet-assignment\/image_labels.csv')\ndf_image_labels.head()","512aa3d5":"img = Image.open('..\/input\/nfl-health-and-safety-helmet-assignment\/images\/57503_000116_Endzone_frame443.jpg')\nimg","7fd1c66a":"\ndraw_obj = ImageDraw.Draw(img)\n\ndraw_obj.rectangle(((1099, 456), (1099 + 16, 456 + 15)), outline=(255, 0, 0))\nimg","ee0fa963":"df = df_image_labels.where(df_image_labels[\"image\"]==\"57503_000116_Endzone_frame443.jpg\").dropna()\nfor _ ,(l, w, t, h) in df[['left', 'width', 'top', 'height']].iterrows():\n        draw_obj.rectangle(((l, t), (l + w, t + h)), outline=(255, 0, 0), width=2)\n\nimg","7943be3e":"\nfrom IPython.display import Video\n\nVideo(\"..\/input\/nfl-health-and-safety-helmet-assignment\/train\/57583_000082_Endzone.mp4\")\n\n#note : if video does not start here just duble click the video in the dataset and enjoy  ( $ _ $ )","ca60bc3e":"Video(\"..\/input\/nfl-health-and-safety-helmet-assignment\/train\/57583_000082_Sideline.mp4\")","9591f236":"df_train_labels = pd.read_csv('..\/input\/nfl-health-and-safety-helmet-assignment\/train_labels.csv')\ndf_train_labels.head()","ed26c63f":"# lets look over columns \nprint(df_train_labels.columns)","b9221047":"#end","6bca6dfb":"\ndf_train_baseline = pd.read_csv('..\/input\/nfl-health-and-safety-helmet-assignment\/train_baseline_helmets.csv')\n\ndf_train_baseline.head()","4ee54eea":"#end","66a55eea":"df_train_player_tracking = pd.read_csv('..\/input\/nfl-health-and-safety-helmet-assignment\/train_player_tracking.csv')\n\ndf_train_player_tracking.head()","6f64e4e2":"# look from 5th to 15th\ndf_train_player_tracking.head(20)","423ea6cf":"#end","0cd7bd9f":"#### well that cleared a lot about the videos and all ...\n\n#### We know that video is nothing but just a set of frames( images ) running very fast the rate at which frame moves is called as frame rate more formally no. of frames passed in one second is called as frame rate \n\n#### Previously in the image_label.csv we saw that there is one image and a lot of helmets and each helmet is represented in one row of CSV file making it large. here we can think of two images ( one from the Endzone video and one from Sideline video ) representing the same situation in the play.\n\n\n#### To simplify \n\n#### There is a play \n\n#### there are two videos for this pay \n\n#### Each video contains a x frames \n\n#### Each frame makes y rows in the train_label.csv ( i.e y helmets ) \n","b2b894c1":"#### we see there is only one helmet marked \n\n#### that means, every row in the image_label.csv represents a single helmet in a single image \n#### and there are a lot of helmets in the image\n\n#### In other words: If there are x helmets in an image then there will be x rows in the image_labels.csv corresponding to the same image \n\n\n#### we can simply iterate over all the rows corresponding to our image and get all the helmets marked ","fd0c562c":"\n#### Let\u2019s go over every column names \n\n* Gamekey: name of the game ( formally ID of the game )\n* playID: name of the play  ( formally play ID)\n\n* video: name of the video file (formally same thing *(_)* )\n\n#### extra note begins \n\n#### let\u2019s take the eg: 57583_000082_Endzone.mp4, here \n\n#### string before first '_' represents the gamekey (57583)\n#### string before second '_' represents the playID (82)\n#### string after second '_' represents the Category of the video ( either Endzone or Sideline)\n\n#### extra note ends \n            \n* View: says what camera is used (formally type of the video  either Endzone or Sideline)\n\n* video_frame : name of the video frame ( given )\n* frame : frame number ( helps to know the sequence of the frames)\n\n\n#### Now the column names we have seen so far occur repeatedly in the datafame","12a7572d":"#### lets see what the first data point in the image label.csv says \n#### we only considering the first row : \n\n57503_000116_Endzone_frame443.jpg\tHelmet\t**1099\t16\t456\t15**\n    ","d938d47c":"#### Hello readers\n\n#### In this notebook, we will try to understand the problem statement and uncover the details of the given data.\n\n\n#### There are few points, that I think are worth mentioning \n* This notebook is good for Some of us who do not know\/understand the National Football League\n* Notebook is intended for the participants coming late to the party ( like me ;))\n\n\n#### I hope you get some good intuition from this notebook, Let's begin !!! :)\n","834eaf6d":"####  well there is a lot going on here \n\n\n#### All the information that we have seen so far is pretty reasonable and understandable that's why it\u2019s easy to interpret \n\n#### Now We have a twist ... \n\n#### Each player wears a sensor that helps precisely locate them on the field. And all that information is located in the train_player_tracking.csv\n\n#### We knew that the position of the player or pretty much every data given in all other CSV files is important for the development and training  of the machine learning algorithms \n\n#### But the real question is how can we use this? \n\n* To find that answer let\u2019s look at the data !! \n\n\n\n","617bbb33":"## train\/test_player_tracking.csv\n\n#### One of the most imp csv files ","083ac506":"#### let's have a look ","df360359":"### image_labels.csv","fe8f9011":"#### This all gives different directions we can tackle this particular problem, We should try to find creative ways to use the given data and solve the problem :) ","6b9a5961":"#### This file contains the corresponding bbox for helmets in the images from the images folder ","a3472bbe":"### Thank you, Happy to hear your thoughts\/suggestions ","148f74aa":"#### Now we should be clear about images and image_labels.csv, together we can use them for the training of the helmet detector model","bab842d0":"## train_labels.csv","16ae64f2":"#### in this data We see that there are three categories of columns \n\n1. Video_frame: \n \tname of the video frame file \n    \n2. left, width, top, height: \n    predicted positions of the helmet in the images \n    \n3. conf: \n    confidence of the model ( how much the model is sure about the position of the helmet in the image )","9e4d487e":"\n#### Here we can see that gameKey, playID, and player are known to us, but what are these other things ??\n\n#### To find the answer lets hear the complete story \n\n#### We know that players are with the sensors but we have to record the reading of those sensors otherwise it\u2019s useless.Well if we are recording the sensor\u2019s response, when should we record it?\n\n#### Now let\u2019s look at the time column \n\n#### first value : 2018-09-14T00:23:45.500Z\n\n#### this time representation is in the ISO 8601 format, in other words, it shows date and time up to millisecond \n\n#### date : 2018-09-14  (befour T char in the string )\n#### time : 00:23:45.500Z (after T char in the string )\n#### i.e \n#### 00 - > hr\n#### 23 - > min \n#### 45 - > sec \n#### 500 - > mili sec ","b25dbc22":"# What we have ?? ( Data analysis ) ","17f2649a":"# Starter","30fd6bb9":"\n#### For those who have no idea of what this game is...\n\n#### Let\u2019s think like this:\n\n#### There is pay going on in the closed room. There are two cameras in the room, one is on the front wall ( Endzone view ) and one on the side wall(Sideline) :)\n\n#### So obviously there are two videos for each play, one recorded everything from the front and the other recorder everything from the side, But both represent the same play \n","947e4a4f":"#### Understanding the problem is a very important step \n\n#### After reading the information given on the competition\u2019s home page, we can easily understand the situation we are dealing with. Also, we can read more on the NFL and its efforts for health and safety from this website: www.NFL.com\/PlayerHealthandSafety.\n\n\n#### Here I am trying to put things in a simple manner: \n\n#### In a sense we can say that :\n#### we are given an image and we need to detect some objects(bbox) in the image along with their label. \n","418d3ef2":"#### Endzone","494c6570":"#### remember every frame ( image ) has a lot of helmets and every helmet has to be represented by four values left, width, top, and hight \n\n\n* Label: name of the player wearing a helmet (or its number)\n* left, width, top, height: defines the exact position of the helmet in the image \n\n\n#### (the following description is the same as given on the competition\u2019s home page )\n*  impactType: a description of the type of helmet impact: helmet, shoulder, body, ground, etc.\n* isDefinitiveImpact: True\/False indicator of definitive impacts. Definitive impact boxes are given additional weight in the scoring algorithm.\n* isSidelinePlayer: True\/False indicator of if the helmet box is on the sideline of the play. Only rows where this field is False will be used in the scoring.\n\n\n#### And That's all :) \n","44f037d5":"#### Now that we have a basic understanding of the problem statement, And there is a lot in the story that will be covered when we walk through the data files provided to us in the next section, have fun :) ","d2444c01":"#### So we can rephrase over sentence as :\n\n#### We are given an image of players playing in the NFL and we want to detect the helmets in the image and also provide the associate player's number as the label.\n\n#### Let\u2019s have a look at the subbmition.csv file ","e2abddaf":"#### Well there is a lot in the data, but primarily we have folders and CSV files \n\n#### lets start with folders \n\n* images\n* train\/test\n\n#### images folder contains a lot of images from the game ( like the one we saw above ), this folder is given for the training of the helmet detector model.\n\n#### train\/test folders contain the video files that we have to use while training and inferring the helmet and label detector model.","f9b8a27b":"## Let's have a look at CSV files ","719e7d1b":"#### Sideline","e99f680c":"## train\/test_baseline_helmets.csv\n\n\n#### Let's look at the data","d6443c35":"#### Now that we saw what\u2019s there in the train folder we can start understanding train_label.csv ","6b5f4c8c":"\n#### this file contains imperfect baseline predictions for helmet boxes\n\n#### well what does it mean by imperfect baseline?\n\n* They trained a model on the images in the images folder and gave a baseline to us, in other words, we should try developing the model that at least outperforms this model ( above the baseline )\n\n","38e20e30":"#### Image ( picked the first image in the images folder ) ","e55fefde":"#### We can see that the helmets are detected properly, Next step is to give the proper label to each helmet \n\n#### Every player has one helmet, and the label is the associate player's number.\n","c9f8e9f4":"#  What we want ?? ( Problem statement )","1273ec66":"#### We can see time difference in the consecutive data points and we will find that for every sec there are 10 recordings in the dataset.\n#### that is the speed of recording is 10Hz, Which means the sensor data is recorded 10 times pr sec ( very prices )\n\n#### Sensor recoreded position, speed , acclaretion ... etc \n\n#### Let\u2019s have a quick look at the columns :\n\n1. x: player position along the long axis of the field.\n2. y: player position along the short axis of the field. \n3. s: speed in yards\/second.\n4. a: acceleration in yards\/second^2.\n5. dis: distance traveled from prior time point, in yards.\n6. o: orientation of player (deg).\n7. dir: angle of player motion (deg).\n8. event: game events like a snap, whistle, etc.\n","f8fe3302":"#### let\u2019s have a look at the first video  ","1e1f0be7":"#### before going to the CSV file let\u2019s have one deep look into the train folder, its videos and all.\n","2eddc0bb":"#### lets look at one image ( first one from the above table )","ba4f0150":"#### We can see there are some players playing Football, \n\n#### Now the helmets of the players are the objects that we need to detect, Let\u2019s have some look "}}