{"cell_type":{"afa54cec":"code","ee90e36f":"code","e3b2d177":"code","e79ebf1c":"code","38c68113":"code","25f5b15f":"code","47f661de":"code","98045118":"code","c81b94df":"code","90a54558":"code","94afb80f":"code","c1f213cf":"code","a74d7daa":"code","50138409":"code","6e729771":"code","cf96241d":"code","ccbe61b4":"code","0702d418":"markdown","fc64b1c2":"markdown","c1615e3e":"markdown","583d2253":"markdown"},"source":{"afa54cec":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\nfrom bs4 import BeautifulSoup\nimport re\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n","ee90e36f":"forums = pd.read_csv('..\/input\/meta-kaggle\/Forums.csv',\n                    usecols=[\"Id\", 'Title']).rename(columns={\"Title\":\"ForumTitle\"}).set_index(\"Id\")\nforums.head()","e3b2d177":"topics =  pd.read_csv('..\/input\/meta-kaggle\/ForumTopics.csv',\n                      usecols=[\"Id\", 'ForumId',  'Title']\n                     ) ## most other attributes are \"leaky\"\n\ntopics = topics.merge(forums, left_on=\"ForumId\",right_index=True).drop([\"ForumId\"],axis=1)\ntopics.head()","e79ebf1c":"messages = pd.read_csv('..\/input\/meta-kaggle\/ForumMessages.csv',usecols=[ 'ForumTopicId', 'PostUserId', 'PostDate', 'ReplyToForumMessageId',\n       'Message', 'Medal'])\nmessages = messages[messages.Message.notna()]\nmessages[\"Medal\"] = messages[\"Medal\"].fillna(0).astype(int)\nmessages = messages.drop_duplicates(subset=['Message', 'Medal'])\nmessages['PostDate'] = pd.to_datetime(messages['PostDate'], infer_datetime_format=True)\nmessages['ReplyToForumMessageId'] = messages['ReplyToForumMessageId'].isna().astype(int) # replace wit hfeature of whether message was reply or not\n\n\nmessages[\"preCleaning_word_length\"] =messages['Message'].str.split(\" \").str.len() # count of words before we clean out the html and code","38c68113":"messages = messages.merge(topics,right_on=\"Id\", left_on=\"ForumTopicId\").drop([\"ForumTopicId\"],axis=1)\nmessages.head()","25f5b15f":"# cleaning messages from HTML tags\nmessages_str = ' |sep| '.join(messages.Message.tolist())\n\nmessages_str = re.sub(r'<code>.*?<\/code>', '', messages_str, flags=re.DOTALL)\nmessages_str = re.sub('<-', '', messages_str)\n\nmessages_str = BeautifulSoup(messages_str, 'lxml').get_text()\n\nmessages_str = re.sub(r'http\\S+', '', messages_str)\nmessages_str = re.sub(r'@\\S+', '', messages_str)\n\nmessages['Message'] = messages_str.split(' |sep| ')\n\nmessages = messages.drop_duplicates(subset=['Message', 'Medal'])\nmessages['Message'].head()","47f661de":"print(messages.shape[0])","98045118":"messages[\"character_length\"] = messages['Message'].str.len()\nmessages[\"word_length\"] =messages['Message'].str.split(\" \").str.len()\nmessages.describe()","c81b94df":"messages.Medal.value_counts()","90a54558":"print(messages[\"character_length\"].quantile(0.999))\nprint(messages[\"word_length\"].quantile(0.999))","94afb80f":"messages.loc[messages[\"character_length\"]>5000].Medal.describe()","c1f213cf":"messages.loc[messages[\"word_length\"]>5000].Medal.describe()","a74d7daa":"messages.loc[messages[\"Medal\"]>=1][\"word_length\"].describe()","50138409":"messages.loc[messages[\"Medal\"]==3][\"word_length\"].describe()","6e729771":"messages.loc[messages[\"word_length\"]>10000][\"Message\"].head()","cf96241d":"print(messages.shape[0])\nmessages = messages.loc[((messages[\"word_length\"]<4000) & messages[\"character_length\"]<15000)]\n\nprint(messages.shape[0])","ccbe61b4":"messages.to_csv(\"kaggle_forum_messages_medals.csv.gz\",index=False,compression=\"gzip\")","0702d418":"## Minor EDA\n* remove some super long messages (space\/memory's sake)\n* We count # character s and words in a message","fc64b1c2":"##### drop some of the extremely long messages","c1615e3e":"### Export data","583d2253":"* we see we have medals in this range of long messages. Specifically, there are gold medal posts that are super long"}}