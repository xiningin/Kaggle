{"cell_type":{"2a94bf56":"code","a4e24a01":"code","9334ea66":"code","50b653d4":"code","f0174a21":"code","6874bce2":"code","887aea0d":"code","c49268b7":"code","5590a4c2":"code","be17835f":"code","7ea4e23e":"code","19043fc6":"code","9536ea39":"code","d7273747":"code","a581c715":"code","fef60817":"code","e41463c5":"code","9a8cf567":"code","29c7cf4c":"code","713b5938":"code","9338bb60":"code","99f90f7c":"code","335b8792":"code","ff1bf860":"code","765c2d1c":"markdown","cfac8b39":"markdown","a95970b3":"markdown","3a4f89be":"markdown","f3be5a2b":"markdown","62a56b1b":"markdown","33703845":"markdown","ea76629c":"markdown","cca04e7b":"markdown","95f9c973":"markdown"},"source":{"2a94bf56":"import pandas as pd\nimport seaborn as sb\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.metrics import roc_auc_score","a4e24a01":"flights = pd.read_csv('..\/input\/flight-delays\/flights.csv')\nflights","9334ea66":"flights_needed_data = flights[0:100000]  # getting a segment ","50b653d4":"flights_needed_data","f0174a21":"flights_needed_data.info()  # for an insight into the data","6874bce2":"flights_needed_data.value_counts('DIVERTED')  # will tell us the no. of flights which were diverted","887aea0d":"sb.jointplot(data=flights_needed_data, x=\"SCHEDULED_ARRIVAL\", y=\"ARRIVAL_TIME\")","c49268b7":"corr = flights_needed_data.corr(method='pearson')","5590a4c2":"sb.heatmap(corr)","be17835f":"corr","7ea4e23e":"# filtering out unnecessary columns\nflights_needed_data=flights_needed_data.drop(['YEAR','FLIGHT_NUMBER','AIRLINE','DISTANCE','TAIL_NUMBER','TAXI_OUT',\n                                              'SCHEDULED_TIME','DEPARTURE_TIME','WHEELS_OFF','ELAPSED_TIME',\n                                              'AIR_TIME','WHEELS_ON','DAY_OF_WEEK','TAXI_IN','CANCELLATION_REASON'],\n                                             axis=1)","19043fc6":"flights_needed_data","9536ea39":"# replacing all NaN values with the mean of the attribute in which they are present\nflights_needed_data=flights_needed_data.fillna(flights_needed_data.mean())","d7273747":"flights_needed_data","a581c715":"# creating a new column; it will tell if the flight was delayed or not\nresult=[]","fef60817":"for row in flights_needed_data['ARRIVAL_DELAY']:\n  if row > 15:\n    result.append(1)\n  else:\n    result.append(0)  ","e41463c5":"flights_needed_data['result'] = result","9a8cf567":"flights_needed_data","29c7cf4c":"flights_needed_data.value_counts('result')","713b5938":"# removing some more columns\nflights_needed_data=flights_needed_data.drop(['ORIGIN_AIRPORT', 'DESTINATION_AIRPORT', 'ARRIVAL_TIME', 'ARRIVAL_DELAY'],axis=1)\nflights_needed_data","9338bb60":"data = flights_needed_data.values\nX, y = data[:,:-1], data[:,-1]\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.30, random_state=42)  # splitting in the ratio 70:30","99f90f7c":"scaled_features = StandardScaler().fit_transform(X_train, X_test)","335b8792":"clf = DecisionTreeClassifier()\nclf = clf.fit(X_train,y_train)","ff1bf860":"pred_prob = clf.predict_proba(X_test)\nauc_score = roc_auc_score(y_test, pred_prob[:,1])\nauc_score","765c2d1c":"<center><img src=\"https:\/\/www.webintravel.com\/wp-content\/uploads\/2020\/05\/den-belitsky-GettyImages-854673918-scaled.jpg\" width=\"700\"><\/center>","cfac8b39":"### Importing Libraries","a95970b3":"# <center>FLIGHT DELAY PREDICTIONS<\/center>","3a4f89be":"### Splitting Data for Training and Testing","f3be5a2b":"### Getting our Data","62a56b1b":"# <center>Predictions are 99.8% accurate.<\/center>","33703845":"### Data Visualization","ea76629c":"### Making Predictions and Checking Accuracy","cca04e7b":"### Applying Decision Tree Classifier on Training Data","95f9c973":"### Data Preprocessing"}}