{"cell_type":{"c16fe40f":"code","201477e5":"code","c0efe289":"code","ef973bcd":"code","d18692b8":"code","ff672dda":"code","c7533c72":"code","255b400f":"code","61fbd943":"code","de46a635":"code","e0c0670b":"code","1b29a4bb":"code","24fad38b":"code","f6d3daea":"code","c71e31fc":"code","61397a4e":"code","f679cafe":"code","fa516945":"code","6f8042cb":"code","7557a9eb":"code","e9a41e72":"code","6984731c":"code","af972d6a":"code","e6c9be84":"code","9f810b65":"code","0dc7d54a":"markdown","e9deb36c":"markdown","c51c99f3":"markdown","f0675bf2":"markdown","1496475d":"markdown","af98b2e3":"markdown","379388eb":"markdown","400cc228":"markdown"},"source":{"c16fe40f":"import numpy as np\nimport pandas as pd\nimport os\nfrom sklearn import preprocessing\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import confusion_matrix\nfrom sklearn.metrics import roc_curve\nimport matplotlib\nimport matplotlib.pyplot as plt\nfrom IPython.display import display, HTML\nimport seaborn as sns\nfrom sklearn.linear_model import LogisticRegression\n","201477e5":"rawdata=pd.read_csv(\"..\/input\/WA_Fn-UseC_-Telco-Customer-Churn.csv\")","c0efe289":"data=rawdata.copy()\ndata.shape","ef973bcd":"data.head(5)","d18692b8":"data.info()","ff672dda":"\ndata['TotalCharges']=data['TotalCharges'].convert_objects(convert_numeric=True)\ndef uni(columnname):\n    print(columnname,\"--\" ,data[columnname].unique())","c7533c72":"dataobject=data.select_dtypes(['object'])\nlen(dataobject.columns)","255b400f":"for i in range(1,len(dataobject.columns)):\n    uni(dataobject.columns[i])\n    ","61fbd943":"def labelencode(columnname):\n    data[columnname] = LabelEncoder().fit_transform(data[columnname])","de46a635":"for i in range(1,len(dataobject.columns)):\n    labelencode(dataobject.columns[i])","e0c0670b":"data.info()","1b29a4bb":"for i in range(1,len(dataobject.columns)):\n     uni(dataobject.columns[i])","24fad38b":"\ndata.info()","f6d3daea":"df=data.copy()\ndfl=data.copy()","c71e31fc":"unwantedcolumnlist=[\"customerID\",\"gender\",\"MultipleLines\",\"PaymentMethod\",\"tenure\"]","61397a4e":"df = df.drop(unwantedcolumnlist, axis=1)\nfeatures = df.drop([\"Churn\"], axis=1).columns","f679cafe":"df_train, df_val = train_test_split(df, test_size=0.30)\n","fa516945":"print(df_train.shape)\nprint(df_val.shape)","6f8042cb":"df_train.isnull().sum()","7557a9eb":"df_val.isnull().sum()","e9a41e72":"df_train['TotalCharges'].fillna(df_train['TotalCharges'].mean(), inplace=True)\ndf_val['TotalCharges'].fillna(df_val['TotalCharges'].mean(), inplace=True)\n","6984731c":"clf = RandomForestClassifier(n_estimators=30 , oob_score = True, n_jobs = -1,random_state =50, max_features = \"auto\", min_samples_leaf = 50)\nclf.fit(df_train[features], df_train[\"Churn\"])\n\n# Make predictions\npredictions = clf.predict(df_val[features])\nprobs = clf.predict_proba(df_val[features])\ndisplay(predictions)","af972d6a":"score = clf.score(df_val[features], df_val[\"Churn\"])\nprint(\"Accuracy: \", score)","e6c9be84":"data['Churn'].value_counts()","9f810b65":"get_ipython().magic('matplotlib inline')\nconfusion_matrix = pd.DataFrame(\n    confusion_matrix(df_val[\"Churn\"], predictions), \n    columns=[\"Predicted False\", \"Predicted True\"], \n    index=[\"Actual False\", \"Actual True\"]\n)\ndisplay(confusion_matrix)\n\n# Calculate the fpr and tpr for all thresholds of the classification\nfpr, tpr, threshold = roc_curve(df_val[\"Churn\"], probs[:,1])\nplt.title('Receiver Operating Characteristic')\nplt.plot(fpr, tpr, 'b')\nplt.plot([0, 1], [0, 1],'r--')\nplt.xlim([0, 1])\nplt.ylim([0, 1])\nplt.ylabel('True Positive Rate')\nplt.xlabel('False Positive Rate')\nplt.show()","0dc7d54a":"### Accuracy ###","e9deb36c":"### ROC Curve ###","c51c99f3":"### Random Forest Algorithm applied on  Train and validate on Validation ###","f0675bf2":"### Import Libraries ###","1496475d":"### Train and Validation Missing Data Fill by mean(imputation) ###","af98b2e3":"### Application of Churn Analysis? ###\n\n* To chrun - thought of conversion\n* Telcom Industry has more operator and provide verious of services with different prices so custmoer can convert from one operator to other for service\/economical benifits\n* for operator it is vital to identify churn customer and hence they can convince particular\n* above model predict customer churn","379388eb":"### Convert TotalCharges Column(feature) to Numeric From Object ### ","400cc228":"### Read Dataset ###"}}