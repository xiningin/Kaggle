{"cell_type":{"6677e0d7":"code","f6ec179d":"code","9bfae9a1":"code","a1545a8f":"code","3eafa90a":"code","a4d25c76":"code","151c2a42":"code","fe875f6f":"code","62171aa7":"code","ddcd25b0":"code","7219604e":"code","db58bf7e":"code","115f5fba":"code","19516d06":"code","101aaf8d":"code","23ad123b":"code","58500b94":"code","9ba310d0":"code","b1c06f31":"code","09007b75":"code","4431f0c2":"code","e31ea053":"markdown","8cca25d0":"markdown","87d7de9f":"markdown","30dfdec2":"markdown","a1f1b1b1":"markdown","d4dbfb08":"markdown","61857dde":"markdown","0237500d":"markdown","a63f08fc":"markdown","301f0bbf":"markdown","f7a262b1":"markdown","1243015c":"markdown","9a524f5f":"markdown","f2aaef43":"markdown","62855727":"markdown","941a728e":"markdown","96e65530":"markdown","a776ea65":"markdown","0a1abe29":"markdown","968a85ef":"markdown","dd27b17c":"markdown","a6d49118":"markdown","c3f629bb":"markdown"},"source":{"6677e0d7":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns\nfrom matplotlib import pyplot as plt\nimport os\ndf = pd.read_csv(\"..\/input\/cardio_train.csv\",sep=\";\")","f6ec179d":"df.head()","9bfae9a1":"df.info()","a1545a8f":"df.describe()","3eafa90a":"from matplotlib import rcParams\nrcParams['figure.figsize'] = 11, 8\ndf['years'] = (df['age'] \/ 365).round().astype('int')\nsns.countplot(x='years', hue='cardio', data = df, palette=\"Set2\");","a4d25c76":"df_categorical = df.loc[:,['cholesterol','gluc', 'smoke', 'alco', 'active']]\nsns.countplot(x=\"variable\", hue=\"value\",data= pd.melt(df_categorical));","151c2a42":"df_long = pd.melt(df, id_vars=['cardio'], value_vars=['cholesterol','gluc', 'smoke', 'alco', 'active'])\nsns.catplot(x=\"variable\", hue=\"value\", col=\"cardio\",\n                data=df_long, kind=\"count\");","fe875f6f":"df.groupby('gender')['height'].mean()","62171aa7":"df['gender'].value_counts()","ddcd25b0":"df.groupby('gender')['alco'].sum()","7219604e":"df['cardio'].value_counts(normalize=True)","db58bf7e":"pd.crosstab(df['cardio'],df['gender'],normalize=True)","115f5fba":"df.isnull().values.any()","19516d06":"df.describe()","101aaf8d":"df.drop(df[(df['height'] > df['height'].quantile(0.975)) | (df['height'] < df['height'].quantile(0.025))].index,inplace=True)\ndf.drop(df[(df['weight'] > df['weight'].quantile(0.975)) | (df['weight'] < df['weight'].quantile(0.025))].index,inplace=True)","23ad123b":"print(\"Diastilic pressure is higher than systolic one in {0} cases\".format(df[df['ap_lo']> df['ap_hi']].shape[0]))","58500b94":"df.drop(df[(df['ap_hi'] > df['ap_hi'].quantile(0.975)) | (df['ap_hi'] < df['ap_hi'].quantile(0.025))].index,inplace=True)\ndf.drop(df[(df['ap_lo'] > df['ap_lo'].quantile(0.975)) | (df['ap_lo'] < df['ap_lo'].quantile(0.025))].index,inplace=True)","9ba310d0":"blood_pressure = df.loc[:,['ap_lo','ap_hi']]\nsns.boxplot(x = 'variable',y = 'value',data = blood_pressure.melt())\nprint(\"Diastilic pressure is higher than systolic one in {0} cases\".format(df[df['ap_lo']> df['ap_hi']].shape[0]))","b1c06f31":"corr = df.corr()\ncmap = sns.diverging_palette(220, 10, as_cmap=True)\n# Generate a mask for the upper triangle\nmask = np.zeros_like(corr, dtype=np.bool)\nmask[np.triu_indices_from(mask)] = True\n\n# Set up the matplotlib figure\nf, ax = plt.subplots(figsize=(11, 9))\n# Draw the heatmap with the mask and correct aspect ratio\nsns.heatmap(corr, mask=mask, cmap=cmap, vmax=.3, center=0,annot = True,\n            square=True, linewidths=.5, cbar_kws={\"shrink\": .5});","09007b75":"import warnings\nwarnings.filterwarnings(\"ignore\")\ndf_melt = pd.melt(frame=df, value_vars=['height'], id_vars=['gender'])\nplt.figure(figsize=(12, 10))\nax = sns.violinplot(\n    x='variable', \n    y='value', \n    hue='gender', \n    split=True, \n    data=df_melt, \n    scale='count',\n    scale_hue=False,\n    palette=\"Set2\");","4431f0c2":"df['BMI'] = df['weight']\/((df['height']\/100)**2)\nsns.catplot(x=\"gender\", y=\"BMI\", hue=\"alco\", col=\"cardio\", data=df, color = \"yellow\",kind=\"box\", height=10, aspect=.7);","e31ea053":"It can be observed that people over 55 of age are more exposed to CVD. From the table above, we can see that there are outliers in `ap_hi`, `ap_lo`, `weight` and `height`. We will deal with them later.\n\nLet's look at categorical variables in the dataset and their distribution:","8cca25d0":"#### Bivariate analysis\n\nIt may be useful to split categorical variables by target class:","87d7de9f":"#### Univariate analysis\nTo understand all our variables, at first, we should look at their datatypes. We can do it with `info()` function:","30dfdec2":"Let's create `violinplot` to show height distribution across gender. Looking at the mean values of height and weight for each value of the gender feature might not be enough to determin whether 1 is male or female designation.","a1f1b1b1":"In addition, in some cases diastolic pressure is higher than systolic, which is also  incorrect. How many records are inaccurate in terms of blood pressure?","d4dbfb08":"### Cleaning Data","61857dde":"Average height for \"2\" gender is greater, than for \"1\" gender, therefore \"1\" stands for women. Let's see how many men and women presented in the dataset:","0237500d":"Are there any `NA`s or missing values in a dataset?","a63f08fc":"It can be clearly seen that patients with CVD have higher cholesterol and blood glucose level. And, generally speaking less active.\n\nTo figure out whether \"1\" stands for women or men in gender column, let's calculate the mean of height per gender. We assume that men are higher than women on average.","301f0bbf":"If we look more closely to height and weight columns, we will notice that minimum height is 55 cm and minimum weight is 10 kg. That has to be an error, since minimum age is 10798 days, which equals to 29 years. On the other hand, the maximum height is 250 cm and the highest weight is 200 kg, which might be irrelevant, when generilizing data. To deal with these errors, we can remove outliers.","f7a262b1":"## EDA of cadiovascular diseases data \n\nThis work is my first public Kernel in Kaggle, and I would really appreciate your feedback or upvote!\n\nThe dataset consists of 70 000 records of patients data in 12 features, such as age, gender, systolic blood pressure, diastolic blood pressure, and etc. The target class \"cardio\" equals to 1, when patient has cardiovascular desease, and it's 0, if patient is healthy.\n\nThe task is to predict the presence or absence of cardiovascular disease (CVD) using the patient examination results. \n\n#### Data description\n\nThere are 3 types of input features:\n\n- *Objective*: factual information;\n- *Examination*: results of medical examination;\n- *Subjective*: information given by the patient.\n\n| Feature | Variable Type | Variable      | Value Type |\n|---------|--------------|---------------|------------|\n| Age | Objective Feature | age | int (days) |\n| Height | Objective Feature | height | int (cm) |\n| Weight | Objective Feature | weight | float (kg) |\n| Gender | Objective Feature | gender | categorical code |\n| Systolic blood pressure | Examination Feature | ap_hi | int |\n| Diastolic blood pressure | Examination Feature | ap_lo | int |\n| Cholesterol | Examination Feature | cholesterol | 1: normal, 2: above normal, 3: well above normal |\n| Glucose | Examination Feature | gluc | 1: normal, 2: above normal, 3: well above normal |\n| Smoking | Subjective Feature | smoke | binary |\n| Alcohol intake | Subjective Feature | alco | binary |\n| Physical activity | Subjective Feature | active | binary |\n| Presence or absence of cardiovascular disease | Target Variable | cardio | binary |\n\nAll of the dataset values were collected at the moment of medical examination. \n\n\n### Initial analysis\nLet's look at the dataset and given variables.","1243015c":"As we can see age and cholesterol have significant impact, but not very high correlated with target class.","9a524f5f":"To see how the target class is distributed among men and women, we can use also `crosstab`","f2aaef43":" Drinking women have higher risks for CVD than drinking men based on thier BMI.","62855727":"So, men consume alcohol more frequently on average. \nNext, the target variables are balanced:`","941a728e":"Who more often report consuming alcohol - men or women?","96e65530":"Let's get rid of the outliers, moreover blood pressure could not be negative value!","a776ea65":"Let's create a new feature - Body Mass Index (BMI):\n\n$$BMI = \\frac {mass_{kg}} {height ^2_{m}},$$\n\nand compare average BMI for healthy people to average BMI of ill people. Normal BMI values are said to be from 18.5 to 25.","0a1abe29":"#### Multivariate analysis\nIt might be useful to consider correation matrix:","968a85ef":"*To be continued*","dd27b17c":"Let's remove weights and heights, that fall below 2.5% or above 97.5% of a given range.","a6d49118":"All features are numerical, 12 integers and 1 decimal number (weight). The second column gives us an idea how big is the dataset and how many non-null values are there for each field. We can use `describe()` to display sample statistics such as `min`, `max`, `mean`,`std` for each attribute:","c3f629bb":"Age is measured in days, height is in centimeters. Let's look ate the numerical variables and how are they spread among target class. For example, at what age does the number of people with CVD exceed the number of people without CVD?"}}