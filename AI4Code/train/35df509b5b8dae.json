{"cell_type":{"4f8c5971":"code","af41a9ea":"code","67fee802":"code","5f4698bc":"code","5769b3a7":"code","c03f3668":"code","9fa4f794":"code","a856c3fc":"code","ba3b170c":"code","f1944cdc":"code","fb8b1c4c":"code","abff9ff3":"code","078265aa":"code","7eae8dea":"code","4231e084":"code","90d2130a":"code","e8b71a33":"code","31ab9a65":"code","9a9cd656":"code","35ecd1e5":"code","527341c8":"code","aaf5c826":"code","dc9233f1":"code","129ecdd0":"code","a5939eae":"code","dc739650":"code","26c727a2":"code","92b6d456":"code","5bc0a04f":"code","ed692c66":"markdown","0297e621":"markdown","f298f23d":"markdown","df995ee5":"markdown","1b9afc03":"markdown","b5d0af79":"markdown","9a1e116b":"markdown","463f52f1":"markdown","80c3ba70":"markdown","4f9f858a":"markdown","9f9d491f":"markdown"},"source":{"4f8c5971":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport statsmodels.graphics.tsaplots as sgt\nimport statsmodels.tsa.stattools as sts\nfrom statsmodels.tsa.arima_model import ARIMA\nfrom scipy.stats.distributions import chi2 \nfrom math import sqrt\nimport seaborn as sns\nsns.set()","af41a9ea":"raw_csv_data = pd.read_csv(\"..\/input\/financial-markets\/Index2018.csv\") \ndf_comp=raw_csv_data.copy()\ndf_comp.date = pd.to_datetime(df_comp.date, dayfirst = True)\ndf_comp.set_index(\"date\", inplace=True)\ndf_comp=df_comp.asfreq('b')\ndf_comp=df_comp.fillna(method='ffill')","67fee802":"df_comp['market_value']=df_comp.ftse","5f4698bc":"import warnings\nwarnings.filterwarnings(\"ignore\")","5769b3a7":"#del df_comp['spx']\n#del df_comp['dax']\n#del df_comp['ftse']\n#del df_comp['nikkei']\nsize = int(len(df_comp)*0.8)\ndf, df_test = df_comp.iloc[:size], df_comp.iloc[size:]","c03f3668":"def LLR_test(mod_1, mod_2, DF = 1):\n    L1 = mod_1.llf\n    L2 = mod_2.llf\n    LR = (2*(L2-L1))    \n    p = chi2.sf(LR, DF).round(3)\n    return p","9fa4f794":"df['returns'] = df.market_value.pct_change(1)*100","a856c3fc":"model_ar_1_i_1_ma_1 = ARIMA(df.market_value, order=(1,1,1))\nresults_ar_1_i_1_ma_1 = model_ar_1_i_1_ma_1.fit()\nresults_ar_1_i_1_ma_1.summary()","ba3b170c":"df['res_ar_1_i_1_ma_1'] = results_ar_1_i_1_ma_1.resid\nsgt.plot_acf(df.res_ar_1_i_1_ma_1, zero = False, lags = 40)\nplt.title(\"ACF Of Residuals for ARIMA(1,1,1)\",size=20)\nplt.show()","f1944cdc":"df['res_ar_1_i_1_ma_1'] = results_ar_1_i_1_ma_1.resid.iloc[:]\nsgt.plot_acf(df.res_ar_1_i_1_ma_1[1:], zero = False, lags = 40)\nplt.title(\"ACF Of Residuals for ARIMA(1,1,1)\",size=20)\nplt.show()","fb8b1c4c":"model_ar_1_i_1_ma_2 = ARIMA(df.market_value, order=(1,1,2))\nresults_ar_1_i_1_ma_2 = model_ar_1_i_1_ma_2.fit()\nmodel_ar_1_i_1_ma_3 = ARIMA(df.market_value, order=(1,1,3))\nresults_ar_1_i_1_ma_3 = model_ar_1_i_1_ma_3.fit()\nmodel_ar_2_i_1_ma_1 = ARIMA(df.market_value, order=(2,1,1))\nresults_ar_2_i_1_ma_1 = model_ar_2_i_1_ma_1.fit()\nmodel_ar_3_i_1_ma_1 = ARIMA(df.market_value, order=(3,1,1))\nresults_ar_3_i_1_ma_1 = model_ar_3_i_1_ma_1.fit()\nmodel_ar_3_i_1_ma_2 = ARIMA(df.market_value, order=(3,1,2))\nresults_ar_3_i_1_ma_2 = model_ar_3_i_1_ma_2.fit(start_ar_lags=5)","abff9ff3":"print(\"ARIMA(1,1,1):  \\t LL = \", results_ar_1_i_1_ma_1.llf, \"\\t AIC = \", results_ar_1_i_1_ma_1.aic)\nprint(\"ARIMA(1,1,2):  \\t LL = \", results_ar_1_i_1_ma_2.llf, \"\\t AIC = \", results_ar_1_i_1_ma_2.aic)\nprint(\"ARIMA(1,1,3):  \\t LL = \", results_ar_1_i_1_ma_3.llf, \"\\t AIC = \", results_ar_1_i_1_ma_3.aic)\nprint(\"ARIMA(2,1,1):  \\t LL = \", results_ar_2_i_1_ma_1.llf, \"\\t AIC = \", results_ar_2_i_1_ma_1.aic)\nprint(\"ARIMA(3,1,1):  \\t LL = \", results_ar_3_i_1_ma_1.llf, \"\\t AIC = \", results_ar_3_i_1_ma_1.aic)\nprint(\"ARIMA(3,1,2):  \\t LL = \", results_ar_3_i_1_ma_2.llf, \"\\t AIC = \", results_ar_3_i_1_ma_2.aic)","078265aa":"print(\"\\nLLR test p-value = \" + str(LLR_test(results_ar_1_i_1_ma_2, results_ar_1_i_1_ma_3)))","7eae8dea":"print(\"\\nLLR test p-value = \" + str(LLR_test(results_ar_1_i_1_ma_1, results_ar_1_i_1_ma_3, DF = 2)))","4231e084":"df['res_ar_1_i_1_ma_3'] = results_ar_1_i_1_ma_3.resid\nsgt.plot_acf(df.res_ar_1_i_1_ma_3[1:], zero = False, lags = 40)\nplt.title(\"ACF Of Residuals for ARIMA(1,1,3)\", size=20)\nplt.show()","90d2130a":"model_ar_5_i_1_ma_1 = ARIMA(df.market_value, order=(5,1,1))\nresults_ar_5_i_1_ma_1 = model_ar_5_i_1_ma_1.fit(start_ar_lags=11)\nmodel_ar_6_i_1_ma_3 = ARIMA(df.market_value, order=(6,1,3))\nresults_ar_6_i_1_ma_3 = model_ar_6_i_1_ma_3.fit(start_ar_lags=11)","e8b71a33":"results_ar_5_i_1_ma_1.summary()","31ab9a65":"print(\"ARIMA(1,1,3):  \\t LL = \", results_ar_1_i_1_ma_3.llf, \"\\t AIC = \", results_ar_1_i_1_ma_3.aic)\nprint(\"ARIMA(5,1,1):  \\t LL = \", results_ar_5_i_1_ma_1.llf, \"\\t AIC = \", results_ar_5_i_1_ma_1.aic)\nprint(\"ARIMA(6,1,3):  \\t LL = \", results_ar_6_i_1_ma_3.llf, \"\\t AIC = \", results_ar_6_i_1_ma_3.aic)","9a9cd656":"print(\"\\nLLR test p-value = \" + str(LLR_test(results_ar_1_i_1_ma_3, results_ar_6_i_1_ma_3, DF = 5)))","35ecd1e5":"print(\"\\nLLR test p-value = \" + str(LLR_test(results_ar_5_i_1_ma_1, results_ar_6_i_1_ma_3, DF = 3)))","527341c8":"df['res_ar_5_i_1_ma_1'] = results_ar_5_i_1_ma_1.resid\nsgt.plot_acf(df.res_ar_5_i_1_ma_1[1:], zero = False, lags = 40)\nplt.title(\"ACF Of Residuals for ARIMA(5,1,1)\", size=20)\nplt.show()","aaf5c826":"df['delta_prices']=df.market_value.diff(1)","dc9233f1":"model_delta_ar_1_i_1_ma_1 = ARIMA(df.delta_prices[1:], order=(1,0,1))\nresults_delta_ar_1_i_1_ma_1 = model_delta_ar_1_i_1_ma_1.fit()\nresults_delta_ar_1_i_1_ma_1.summary()","129ecdd0":"sts.adfuller(df.delta_prices[1:])","a5939eae":"model_ar_1_i_2_ma_1 = ARIMA(df.market_value, order=(1,2,1))\nresults_ar_1_i_2_ma_1 = model_ar_1_i_2_ma_1.fit(start_ar_lags=10)\nresults_ar_1_i_2_ma_1.summary()","dc739650":"df['res_ar_1_i_2_ma_1'] = results_ar_1_i_2_ma_1.resid.iloc[:]\nsgt.plot_acf(df.res_ar_1_i_2_ma_1[2:], zero = False, lags = 40)\nplt.title(\"ACF Of Residuals for ARIMA(1,2,1)\",size=20)\nplt.show()","26c727a2":"model_ar_1_i_1_ma_1_Xspx = ARIMA(df.market_value, exog = df.spx, order=(1,1,1))\nresults_ar_1_i_1_ma_1_Xspx = model_ar_1_i_1_ma_1_Xspx.fit()\nresults_ar_1_i_1_ma_1_Xspx.summary()","92b6d456":"from statsmodels.tsa.statespace.sarimax import SARIMAX","5bc0a04f":"model_sarimax = SARIMAX(df.market_value, exog = df.spx, order=(1,0,1), seasonal_order = (2,0,1,5))\nresults_sarimax = model_sarimax.fit()\nresults_sarimax.summary()","ed692c66":"## ARIMAX ","0297e621":"## Creating Returns","f298f23d":"## Importing the relevant packages","df995ee5":"## Residuals of the ARIMA(1,1,1)","1b9afc03":"## The LLR Test","b5d0af79":"## Higher-Lag ARIMA Models","9a1e116b":"# SARIMAX MODEL\n### SARIMAX (SEASIONAL AUTOREGRESSIVE INTEGRETAD MOVING AVARAGES EXOGENOUS)\n\n#### Bu model ARIMA ve ARIMAX modellerinin seasonal (mevsimsel) verilerle \u00e7al\u0131\u015fmak i\u00e7in olu\u015fturulmu\u015f halidir. ARIMAX i\u00e7indeki X (EXOGENEOUS) ifadesi modele d\u0131\u015fardan modeli etkileyen bir etken belirlememizi sa\u011fl\u0131yordu. \u015eimdi mevsimsel ve periyodik de\u011fi\u015fkenleri de hesaba katabilmek i\u00e7in kendinden k zaman \u00f6nceki veriyi (\u00d6rne\u011fin 1 y\u0131l \u00f6ncesi i\u00e7in ayl\u0131k verilerle \u00e7al\u0131\u015f\u0131rken ==> t-12) de modele dahil ederek bir hesaplama yap\u0131p mevsimsel bir d\u00fczenleme yapm\u0131\u015f oluruz. A\u015fa\u011f\u0131da AR modelinden SARIMAX modeline kadar olu\u015fturulabilecek b\u00fct\u00fcn modeller s\u0131rayla olu\u015fturulmu\u015ftur.","463f52f1":"## SARIMAX","80c3ba70":"## ARIMA(1,1,1)","4f9f858a":"## Importing the Data and Pre-processing ","9f9d491f":"## Models with Higher Levels of Integration"}}