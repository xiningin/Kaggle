{"cell_type":{"1d09bdaa":"code","be74c225":"code","72915b95":"code","a8609fc6":"code","d77f4798":"code","648048c0":"code","0cbdf22e":"code","1cd830b9":"code","003db383":"code","1be5f47a":"code","2af1a21f":"code","1779e6a7":"code","5e5da0c2":"code","42e3ce2c":"code","2f657fd6":"code","4f386deb":"markdown"},"source":{"1d09bdaa":"%matplotlib inline\nimport numpy as np\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport os\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns; sns.set()\n\nfrom sklearn.datasets import fetch_20newsgroups","be74c225":"data = fetch_20newsgroups()\ndata.target_names","72915b95":"print(len(data.data))","a8609fc6":"categories = data.target_names\ncategories","d77f4798":"train = fetch_20newsgroups(subset='train',categories=categories)\ntest = fetch_20newsgroups(subset='test',categories=categories)\nprint(len(train.data),len(test.data))","648048c0":"print(train.data[1313])","0cbdf22e":"from sklearn.feature_extraction.text import TfidfVectorizer\nfrom sklearn.naive_bayes import MultinomialNB\nfrom sklearn.pipeline import make_pipeline","1cd830b9":"model = make_pipeline(TfidfVectorizer(),MultinomialNB())","003db383":"model.fit(train.data, train.target)\nlabels = model.predict(test.data)","1be5f47a":"from sklearn.metrics import confusion_matrix\nmat = confusion_matrix(test.target,labels)\nplt.figure(figsize=(8, 8))\nsns.heatmap(mat.T,square=True,annot=True,fmt='d',cbar=False,xticklabels=train.target_names,yticklabels=train.target_names)\n\nplt.xlabel('true label');\nplt.ylabel('predicted label');","2af1a21f":"def predict_it(s,train=train,model=model):\n    pred=model.predict([s])\n    return train.target_names[pred[0]]","1779e6a7":"predict_it('microsoft')","5e5da0c2":"predict_it('players playing the game')      ","42e3ce2c":"predict_it('saudi arabia')","2f657fd6":"predict_it('aliens')","4f386deb":"### Naive Bayes at its root => P(a|b)= (p(b|a)*p(a))\/p(b)"}}