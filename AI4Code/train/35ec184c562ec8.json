{"cell_type":{"67fdf367":"code","f6719461":"code","9266618e":"code","62cb4830":"code","de41ec4c":"code","cec328f0":"code","9c6c1bbb":"code","33a2fd70":"code","2c82828e":"code","e1fdc5af":"code","7484ff0d":"code","9abd7fac":"code","47122aa6":"code","63b07e67":"markdown","0abebdeb":"markdown","453a19ba":"markdown","883307fa":"markdown","c14fd692":"markdown","43e5fb49":"markdown","5fe9c15f":"markdown","4fba7a43":"markdown","c8f9549f":"markdown","22de15e2":"markdown"},"source":{"67fdf367":"!wget https:\/\/raw.githubusercontent.com\/PacktPublishing\/Machine-Learning-for-Cybersecurity-Cookbook\/master\/Chapter04\/deepfake\/deepfake_face_swap.py","f6719461":"!wget https:\/\/raw.githubusercontent.com\/PacktPublishing\/Machine-Learning-for-Cybersecurity-Cookbook\/master\/Chapter04\/deepfake\/deepfake_face_detection.py","9266618e":"!wget https:\/\/raw.githubusercontent.com\/PacktPublishing\/Machine-Learning-for-Cybersecurity-Cookbook\/master\/Chapter04\/deepfake\/deepfake_config.py","62cb4830":"!wget https:\/\/raw.githubusercontent.com\/PacktPublishing\/Machine-Learning-for-Cybersecurity-Cookbook\/master\/Chapter04\/deepfake\/deepfake_face_points_detection.py","de41ec4c":"!wget https:\/\/github.com\/PacktPublishing\/Machine-Learning-for-Cybersecurity-Cookbook\/raw\/master\/Chapter04\/deepfake\/deepfake_models\/shape_predictor_68_face_landmarks.dat","cec328f0":"!mkdir deepfake_models","9c6c1bbb":"\n!mv .\/shape_predictor_68_face_landmarks.dat deepfake_models\/shape_predictor_68_face_landmarks.dat","33a2fd70":"import os\nimport cv2\nimport numpy as np\n\nfrom deepfake_face_detection import select_face\nfrom deepfake_face_swap import (\n    warp_image_2d,\n    warp_image_3d,\n    mask_from_points,\n    apply_mask,\n    correct_colours,\n    transformation_from_points,\n    ProcessFace,\n)","2c82828e":"!wget -O elon.jpg https:\/\/github.com\/wuhuikai\/FaceSwap\/raw\/master\/imgs\/test6.jpg\n!wget -O witcher.jpg https:\/\/github.com\/wuhuikai\/FaceSwap\/raw\/master\/imgs\/test7.jpg","e1fdc5af":"content_image = \"elon.jpg\"\ntarget_image = \"witcher.jpg\"\nresult_image_path = \"musk_witcher.jpg\"","7484ff0d":"content_img = cv2.imread(content_image)\ndestination_img = cv2.imread(target_image)\ncontent_img_points, content_img_shape, content_img_face = select_face(content_img)\n\ndestination_img_points, destination_img_shape, destination_img_face = select_face(destination_img)","9abd7fac":"result_image = ProcessFace(content_img_points, content_img_face, destination_img_points, destination_img_face)","47122aa6":"x, y, w, h = destination_img_shape\ndestination_img_copy = destination_img.copy()\ndestination_img_copy[y : y + h, x: x + w] = result_image\nresult_image = destination_img_copy\ncv2.imwrite(result_image_path, result_image)","63b07e67":"Lets read theimages into opencv and then extract the source and destination faces","0abebdeb":"Draw the transformed face into the destination imagea nd write file to disk\n\n","453a19ba":"Specify the image containing the face we wish to use in content_image and the\nimage where we want the face to be transferred to in target_image. Finally,\nspecify where you'd like the result created","883307fa":"Lets start with code.","c14fd692":"err... okay.","43e5fb49":"compute a transformed version of source face","5fe9c15f":"This code is taken from ch4 of https:\/\/github.com\/PacktPublishing\/Machine-Learning-for-Cybersecurity-Cookbook\/\n\nLets start by downloading some of the files.","4fba7a43":"![](elon.jpg)\n![](.\/witcher.jpg)","c8f9549f":"### The result?\n\n![](musk_witcher.jpg)","22de15e2":"### input images"}}