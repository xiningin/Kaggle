{"cell_type":{"ebdfabbb":"code","eb25a0e7":"code","ace0fb17":"code","d51d4b65":"code","c6627ed3":"code","c873440b":"code","408e8372":"code","fd68fb97":"code","e08fb5c9":"code","869dde7b":"code","d61968d5":"code","e2133c4d":"code","b391cfdc":"code","c1123b51":"code","05801145":"code","41b378b6":"code","4ee00c21":"code","9d08f384":"code","cb2eff5f":"markdown","fd8c2a9b":"markdown","cd0dab1d":"markdown","0267b96d":"markdown","623d1e6a":"markdown","26d34a07":"markdown","b439c708":"markdown","7c12cee0":"markdown","3543fba1":"markdown","9d3404d6":"markdown","7874314d":"markdown"},"source":{"ebdfabbb":"import numpy as np # \u6570\u7ec4\u5e38\u7528\u5e93\nimport pandas as pd # \u8bfb\u5165csv\u5e38\u7528\u5e93\nfrom patsy import dmatrices # \u53ef\u6839\u636e\u79bb\u6563\u53d8\u91cf\u81ea\u52a8\u751f\u6210\u54d1\u53d8\u91cf\nfrom sklearn.linear_model import LogisticRegression # sk-learn\u5e93Logistic Regression\u6a21\u578b\nfrom sklearn.model_selection import train_test_split, cross_val_score # sk-learn\u5e93\u8bad\u7ec3\u4e0e\u6d4b\u8bd5\nfrom sklearn import metrics # \u751f\u6210\u5404\u9879\u6d4b\u8bd5\u6307\u6807\u5e93\nimport matplotlib.pyplot as plt # \u753b\u56fe\u5e38\u7528\u5e93\nimport seaborn as sns","eb25a0e7":"data = pd.read_csv('..\/input\/HR_comma_sep.csv')\nprint(data.info())\ndata.head()","ace0fb17":"data.left = data.left.astype(int)\nprint(data.info())","d51d4b65":"corr = data[['satisfaction_level', 'last_evaluation', 'average_montly_hours', 'time_spend_company', 'Work_accident', 'promotion_last_5years', ]].corr()\nsns.heatmap(corr, square=True, annot=True, fmt='.2f')","c6627ed3":"salary_left = pd.crosstab(data['salary'], data['left'])\nprint(salary_left)\nsalary_left.plot(kind = 'bar')\nplt.show()","c873440b":"salary_left.div(salary_left.sum(axis = 1), axis = 0).plot(kind = 'bar', stacked = True)","408e8372":"data['satisfaction_level'].hist()\nplt.show()\ndata[data['left'] == 0]['satisfaction_level'].hist()\nplt.show()\ndata[data['left'] == 1]['satisfaction_level'].hist()\nplt.show()","fd68fb97":"y, X = dmatrices('left~satisfaction_level+last_evaluation+number_project+average_montly_hours+time_spend_company+Work_accident+promotion_last_5years+C(sales)+C(salary)', data, return_type = 'dataframe')\nprint(y.head())\nX.head()","e08fb5c9":"X = X.rename(columns = {\n    'C(sales)[T.RandD]': 'Department: Random',\n    'C(sales)[T.accounting]': 'Department: Accounting',\n    'C(sales)[T.hr]': 'Department: HR',\n    'C(sales)[T.management]': 'Department: Management',\n    'C(sales)[T.marketing]': 'Department: Marketing',\n    'C(sales)[T.product_mng]': 'Department: Product_Management',\n    'C(sales)[T.sales]': 'Department: Sales',\n    'C(sales)[T.support]': 'Department: Support',\n    'C(sales)[T.technical]': 'Department: Technical',\n    'C(salary)[T.low]': 'Salary: Low',\n    'C(salary)[T.medium]': 'Salary: Medium'}) \ny = np.ravel(y) # \u5c06y\u53d8\u6210np\u7684\u4e00\u7ef4\u6570\u7ec4\nprint(y)\nX.head()","869dde7b":"model = LogisticRegression()\nmodel.fit(X, y)\nfeature_coof = pd.DataFrame({'feature': X.columns.values, 'coef': model.coef_[0]})\nprint(feature_coof)","d61968d5":"print(model.score(X,y))\nmodel.coef_","e2133c4d":"model.predict_proba([[1,0,0,1,0,0,0,0,0,0,0,0, 0.5, 0.7, 4.0, 160, 3.0, 0, 0]])","b391cfdc":"model.predict_proba(X)\npred = model.predict(X)\n(abs(pred-y)).sum() \/ len(y)","c1123b51":"Xtrain, Xtest, ytrain, ytest = train_test_split(X, y, test_size = 0.2, random_state = 0)","05801145":"model2 = LogisticRegression(C=10000)\nmodel2.fit(Xtrain, ytrain)\npred = model2.predict(Xtest)\nmetrics.accuracy_score(ytest, pred)\n","41b378b6":"print(metrics.confusion_matrix(ytest, pred))","4ee00c21":"print(metrics.classification_report(ytest, pred))","9d08f384":"print(cross_val_score(LogisticRegression(), X, y, scoring='accuracy', cv=10))","cb2eff5f":"\u89c2\u5bdf\u5458\u5de5\u6ee1\u610f\u5ea6\u7684\u5206\u5e03\u56fe(histogram)","fd8c2a9b":"\u7528metrics\u89c2\u5bdf\u5b9e\u9645\u79bb\u804c\/\u672a\u79bb\u804c\u88ab\u9884\u6d4b\u6210\u4e3a\u79bb\u804c\/\u672a\u79bb\u804c\u7684\u6570\u76ee","cd0dab1d":"\u89c2\u5bdf\u79bb\u804c\u6bd4\u4f8b\u4e0e\u5de5\u8d44\u5206\u5e03\u7684\u5173\u7cfb","0267b96d":"10\u4efd\u7684\u4ea4\u53c9\u9a8c\u8bc1Cross Validation","623d1e6a":"\u7528X\u548cy\u8bad\u7ec3\u6a21\u578b\uff0c\u7136\u540e\u8f93\u51faX\u4e2d\u6bcf\u4e00\u9879\u81ea\u53d8\u91cf\u5bf9\u4e8ey\u7684\u5f71\u54cd\nzip(a,b)\u53ef\u5c06a\u7684\u6bcf\u4e00\u4e2a\u5143\u7d20\u548cb\u91cc\u5bf9\u5e94\u4f4d\u7f6e\u7684\u5143\u7d20\u7ec4\u6210\u4e00\u5bf9","26d34a07":"\u751f\u62107:3\u7684\u8bad\u7ec3\u6d4b\u8bd5\u96c6\u5e76\u5728\u8bad\u7ec3\u96c6\u4e0a\u8bad\u7ec3\u6a21\u578bmodel2","b439c708":"dmatrices\u5c06\u6570\u636e\u4e2d\u7684\u79bb\u6563\u53d8\u91cf\u53d8\u6210\u54d1\u53d8\u91cf\uff0c\u5e76\u6307\u660e\u7528satisfaction_level, last_evaluation, ... \u6765\u9884\u6d4bleft","7c12cee0":"model.score\u4e3a\u51c6\u786e\u7387(0\u52301\u4e4b\u95f4)","3543fba1":"\u89c2\u5bdf\u79bb\u804c\u4eba\u6570\u4e0e\u5de5\u8d44\u5206\u5e03\u7684\u5173\u7cfb","9d3404d6":"> \u4ece..\/input\/HR_comma_sep.csv\u6587\u4ef6\u4e2d\u8bfb\u5165\u6570\u636e\uff0c\u5b58\u5165data","7874314d":"\u9884\u6d4b\u8fd9\u6837\u4e00\u4e2a\u4eba\u7684\u79bb\u804c\u6982\u7387\uff1a\n\u4e00\u4e2a\u9ad8\u5de5\u8d44HR\uff0c\n\u5bf9\u516c\u53f8\u6ee1\u610f\u5ea60.5, \n\u4e0a\u6b21\u8bc4\u5ba10.7\u5206\uff0c\n\u505a\u8fc74\u4e2a\u9879\u76ee\uff0c\n\u6bcf\u6708\u5e73\u5747\u5de5\u4f5c160\u5c0f\u65f6\uff0c\n\u5728\u516c\u53f8\u5446\u4e863\u5e74\uff0c\n\u8fc7\u53bb5\u5e74\u6ca1\u6709\u88ab\u664b\u5347\uff0c\n\u6ca1\u6709\u5de5\u4f24"}}