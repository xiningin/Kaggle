{"cell_type":{"7f3607cd":"code","2bffcd44":"code","e972b02f":"code","26a7a276":"code","9d68df79":"code","67afd15c":"code","764a4787":"code","eb525819":"markdown"},"source":{"7f3607cd":"import pandas as pd\nimport pandas.io.sql as psql\nimport sqlite3\nfrom sklearn import linear_model\nfrom IPython.display import display, HTML\nfrom datetime import datetime as dt\nimport time\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport sys\nimport os\nimport re\nimport json\nimport inspect\nimport requests\nimport codecs\nimport numpy as np\nfrom matplotlib import ticker\n%matplotlib inline\nclf = linear_model.LinearRegression()\n\n# http:\/\/www.customs.go.jp\/toukei\/info\/tsdl_e.htm\nshow_tables = \"select tbl_name from sqlite_master where type = 'table'\"\ndesc = \"PRAGMA table_info([{table}])\"\nconn = \\\n    sqlite3.connect(':memory:')\ncursor = conn.cursor()\n\n# year_from_1997\nattach = 'attach \"..\/input\/japan-trade-statistics\/y_1997.db\" as y_1997'\ncursor.execute(attach)\n\n# 2018 \u5e74\u306e\u6708\u5225\u96c6\u8a08\nattach = 'attach \"..\/input\/japan-trade-statistics\/ym_2018.db\" as ym_2018'\ncursor.execute(attach)\n# 2019 \u5e74\u306e\u6708\u5225\u96c6\u8a08\nattach = 'attach \"..\/input\/japan-trade-statistics\/ym_2019.db\" as ym_2019'\ncursor.execute(attach)\n# hs code,country,\nattach = 'attach \"..\/input\/japantradestatistics2\/trade_meta_data.db\" as code'\ncursor.execute(attach)\n# import hs,country code as pandas\ntmpl = \"{hs}_{lang}_df =  pd.read_sql('select * from code.{hs}_{lang}',conn)\"\nfor hs in ['hs2','hs4','hs6','hs6','hs9']:\n    for lang in ['jpn','eng']:\n        exec(tmpl.format(hs=hs,lang=lang))        \n        \n# country table: country_eng,country_jpn\ncountry_eng_df = pd.read_sql('select * from code.country_eng',conn)\ncountry_eng_df['Country']=country_eng_df['Country'].apply(str)\ncountry_jpn_df = pd.read_sql('select * from code.country_jpn',conn)\ncountry_jpn_df['Country']=country_jpn_df['Country'].apply(str)\n\n# custom  table: code.custom\ncustom_df = pd.read_sql('select * from code.custom',conn)\nattach = 'attach \"..\/input\/custom-2016\/from_2012.db\" as custom_from'\ncursor.execute(attach)\nattach = 'attach \"..\/input\/custom-2016\/custom_2018.db\" as custom_2018'\ncursor.execute(attach)\nattach = 'attach \"..\/input\/custom-2016\/custom_2019.db\" as custom_2019'\ncursor.execute(attach)\n\n\n# 2019 \u5e74\u3092\u53d6\u308a\u51fa\u3059\ntry:\n    cursor.execute('drop table y_2019')\nexcept:\n    pass\n\nsql = \"\"\"\ncreate table y_2019 as select * from year_from_1997\nwhere Year = 2019\n\"\"\"[1:-1]\ncursor.execute(sql)\n","2bffcd44":"# 120 Cambodia","e972b02f":"sql=\"\"\"\nselect Year,exp_imp,sum(Value) as Value\nfrom year_from_1997\nwhere Country='120'\ngroup by Year,exp_imp\norder by Year\n\"\"\"[1:-1]\ndf = pd.read_sql(sql,conn)\nplt.figure(figsize=(20, 10))\nax  = sns.lineplot(x='Year',y='Value',hue='exp_imp',linewidth = 7.0,\n             palette={1: \"b\", 2: \"r\"},\n             data=df)\nax.legend_._loc = 2\nax.xaxis.set_major_locator(ticker.MultipleLocator(1))","26a7a276":"# import\nsql=\"\"\"\nselect y.hs9,hs9_name,sum(Value) as Value\nfrom y_2019 y,hs9_eng h\nwhere Country='120' and exp_imp=2 and \ny.hs9 = h.hs9\ngroup by y.hs9\norder by Value desc\n\"\"\"[1:-1]\ndf = pd.read_sql(sql,conn)\ndf.head()","9d68df79":"# import\nsql=\"\"\"\nselect Year,sum(Value) as Value\nfrom year_from_1997\nwhere Country='120' and exp_imp=2 and \nhs9='620462200'\ngroup by Year\norder by Year\n\"\"\"[1:-1]\ndf = pd.read_sql(sql,conn)\nplt.figure(figsize=(20, 10))\nax  = sns.lineplot(x='Year',y='Value',linewidth = 7.0,data=df)\nax.xaxis.set_major_locator(ticker.MultipleLocator(1))","67afd15c":"# 620462200\u3000Cotton product\nsql=\"\"\"\nselect y.Country,Country_name,sum(Value) as Value\nfrom y_2019 y,country_eng c\nwhere exp_imp=2 and \nhs9='620462200' and\ny.Country = c.Country\ngroup by y.Country\norder by Value desc\n\"\"\"[1:-1]\ndf = pd.read_sql(sql,conn)\ndf.head()","764a4787":"# 020230100 japan 2 cambodia \n# https:\/\/www.customs.go.jp\/toukei\/srch\/index.htm?M=01&P=1,1,,,,,,,,4,1,2019,0,0,0,2,020230100,,,,,,,,,,6,120,,,,,,,,,,,,,,,,,,,,,20\nsql=\"\"\"\nselect y.hs9,hs9_name,sum(Value) as Value\nfrom y_2019 y,hs9_eng h\nwhere Country='120' and exp_imp=1 and \ny.hs9 = h.hs9\ngroup by y.hs9\norder by Value desc\n\"\"\"[1:-1]\ndf = pd.read_sql(sql,conn)\ndf.head()","eb525819":"# \u3000\u65e5\u672c\u3068\u30ab\u30f3\u30dc\u30b8\u30a2\u8cbf\u6613\u6982\u8981\u3067\u3059\u3002\n# \u65e5\u672c\u3078\u306e\u8f38\u5165\u304c\u5897\u3048\u3066\u3044\u307e\u3059\u3002\u5897\u3048\u3066\u3044\u308b\u306e\u306f\u6728\u7dbf\u88fd\u54c1\u3067\u3059\u3002\n# \u65e5\u672c\u304b\u3089\u306e\u8f38\u5165\u306f\u51b7\u51cd\u725b\u8089\u3067\u3059\u3002\u4e2d\u56fd\u306b\u8ee2\u58f2\u3055\u308c\u3066\u3044\u308b\u6a21\u69d8\u3067\u3059\u3002\u4e2d\u56fd\u3067\u65e5\u672c\u306e\u725b\u8089\u304c\u8f38\u5165\u7981\u6b62\u306b\u306a\u3063\u3066\u3044\u308b\u306e\u3067\u629c\u3051\u9053\u3067\u3059\u306d\u3002\n# [quora\u3067\u95a2\u9023\u8cea\u554f\u3057\u3066\u3044\u307e\u3059\u3002](https:\/\/qr.ae\/TESXO8)\n\n# Overview of trade between Japan and Cambodia.\n# Import to Japan is increasing. What is increasing is cotton products.\n# Imported from Japan is frozen beef. It seems to have been resold to China. This is a loophole because Japanese beef is banned in China.\n"}}