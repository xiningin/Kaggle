{"cell_type":{"5f0d89c5":"code","1e2f96a7":"code","f9d52396":"code","dd4935a0":"code","71c1edfd":"code","ea74deb2":"code","b8a900f1":"code","b3bd7eec":"code","480d6ad9":"code","6400ffb4":"code","d6ae4dc0":"code","8dce654e":"code","f5fdfd03":"code","d2ca9223":"code","fba6fba9":"code","00aadc50":"code","1fb0cff2":"code","4d3565a5":"code","5309d504":"code","21cfdd37":"code","9eb4c37f":"code","bdfa582d":"code","426b8c37":"code","17ce4eef":"code","90a3e681":"code","ea387221":"code","d956a9c0":"code","66d81483":"code","0dd65771":"code","74f9fd62":"code","1650ea94":"code","28d00db7":"code","c47e1677":"code","8f813cc0":"code","c4592bbb":"code","b2d2838b":"code","dbee72c3":"code","5e2e0fc0":"code","dc49e0f1":"markdown","d2091558":"markdown","41c61160":"markdown"},"source":{"5f0d89c5":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.preprocessing import OneHotEncoder\nfrom sklearn.metrics import mean_squared_error\nfrom sklearn.metrics import mean_absolute_error\nlabelencoder = LabelEncoder()","1e2f96a7":"df = pd.read_csv(\"..\/input\/students-performance-in-exams\/StudentsPerformance.csv\") #veri setini import ettik","f9d52396":"df.isnull().sum() # or data.isnull().sum().sum()","dd4935a0":"df.info()","71c1edfd":"df.rename(columns = {\"race\/ethnicity\" : \"race_ethnicity\",\"parental level of education\":\"parental_level_of_education\", \n                      \"test preparation course\":\"test_preparation_course\",\"math score\":\"math_score\",\"reading score\":\"reading_score\",\n                      \"writing score\":\"writing_score\", },inplace=True)","ea74deb2":"df.head()","b8a900f1":"df.gender = pd.Categorical(df.gender)\ndf.race_ethnicity = pd.Categorical(df.race_ethnicity)\ndf.parental_level_of_education = pd.Categorical(df.parental_level_of_education)\ndf.lunch = pd.Categorical(df.lunch)\ndf.test_preparation_course  = pd.Categorical(df.test_preparation_course)","b3bd7eec":"df.info()","480d6ad9":"df2 = pd.DataFrame(df[\"gender\"])\ndf2['gender_cat'] = labelencoder.fit_transform(df2[\"gender\"])\ndf2","6400ffb4":"df2[\"gender\"].append(df2[\"gender_cat\"]).unique()","d6ae4dc0":"enc = OneHotEncoder()\nenc_df = pd.DataFrame(enc.fit_transform(df2[['gender_cat']]).toarray())\nenc_df = enc_df.rename(columns = {0 : \"female\",1: \"male\"})\ndf = df.join(enc_df)\ndf.head()","8dce654e":"df2 = pd.DataFrame(df[\"race_ethnicity\"])\ndf2['race_ethnicity_cat'] = labelencoder.fit_transform(df2[\"race_ethnicity\"])\ndf2","f5fdfd03":"df2[\"race_ethnicity\"].append(df2[\"race_ethnicity_cat\"]).unique()","d2ca9223":"enc_df = pd.DataFrame(enc.fit_transform(df2[['race_ethnicity_cat']]).toarray())\nenc_df = enc_df.rename(columns = {0 : \"group_A\",1: \"group_B\", 2 : \"group_C\", 3 : \"group_D\", 4 : \"group_E\"})\ndf = df.join(enc_df)\ndf.head()","fba6fba9":"df2 = pd.DataFrame(df[\"parental_level_of_education\"])\ndf2['parental_level_of_education_cat'] = labelencoder.fit_transform(df2[\"parental_level_of_education\"])\ndf2","00aadc50":"df2[\"parental_level_of_education\"].append(df2[\"parental_level_of_education_cat\"]).unique()","1fb0cff2":"enc_df = pd.DataFrame(enc.fit_transform(df2[['parental_level_of_education_cat']]).toarray())\nenc_df = enc_df.rename(columns = {0 : \"associate's_degree\",1: \"bachelor's_degree\", 2 : \"high_school\", 3 : \"master's_degree\", 4 : \"some_college\",\n                                 5 : \"some_high_school\"})\ndf = df.join(enc_df)\ndf.head()","4d3565a5":"df2 = pd.DataFrame(df[\"lunch\"])\ndf2['lunch_cat'] = labelencoder.fit_transform(df2[\"lunch\"])\ndf2","5309d504":"df2[\"lunch\"].append(df2[\"lunch_cat\"]).unique()","21cfdd37":"enc_df = pd.DataFrame(enc.fit_transform(df2[['lunch_cat']]).toarray())\nenc_df = enc_df.rename(columns = {0 : \"free-reduced\",1: \"standard\"})\ndf = df.join(enc_df)\ndf.head()","9eb4c37f":"df2 = pd.DataFrame(df[\"test_preparation_course\"])\ndf2['test_preparation_course_cat'] = labelencoder.fit_transform(df2[\"test_preparation_course\"])\ndf2","bdfa582d":"df2[\"test_preparation_course\"].append(df2[\"test_preparation_course_cat\"]).unique()","426b8c37":"enc_df = pd.DataFrame(enc.fit_transform(df2[['test_preparation_course_cat']]).toarray())\nenc_df = enc_df.rename(columns = {0 : \"completed\",1: \"none\"})\ndf = df.join(enc_df)\ndf.head()","17ce4eef":"df.describe().T","90a3e681":"corr = df.corr()\ncorr.style.background_gradient(cmap='coolwarm').set_precision(3)","ea387221":"x = df.iloc[:, 6:7].values\ny = df.iloc[:, 5].values","d956a9c0":"from sklearn.model_selection import train_test_split\nx_train, x_test, y_train, y_test = train_test_split(x, y, test_size = 0.2, random_state = 34)","66d81483":"from sklearn.linear_model import LinearRegression\nlinear_regressor = LinearRegression()\nlinear_regressor.fit(x_train, y_train)\nprint(\"R score: {0}\".format(round(linear_regressor.score(x_train, y_train),2)))","0dd65771":"print(\"Intercept: {0}\".format(round(linear_regressor.intercept_),))\n#pd.DataFrame({'feature':x.columns, 'coef':linear_regressor.coef_})","74f9fd62":"y_predictions = linear_regressor.predict(x_test)","1650ea94":"plt.scatter(x_train, y_train, color = \"red\")\nplt.plot(x_train, linear_regressor.predict(x_train), color = \"blue\")\nplt.title(\"PREDICTING MATH SCORE WITH READING SCORE\")\nplt.xlabel(\"READING SCORE\")\nplt.ylabel(\"MATH SCORE\")\n#plt.savefig('basic_linear_regression.png')\nplt.show()","28d00db7":"mae = mean_absolute_error(linear_regressor.predict(x_test), y_test)\nmse = mean_squared_error(linear_regressor.predict(x_test), y_test)\nrmse = np.sqrt(mse)\n\nprint('Mean Absolute Error (MAE): %.2f' % mae)\nprint('Mean Squared Error (MSE): %.2f' % mse)\nprint('Root Mean Squared Error (RMSE): %.2f' % rmse)","c47e1677":"X = df.iloc[:, 7:8].values\nY = df.iloc[:, 5].values","8f813cc0":"X_train, X_test, Y_train, Y_test = train_test_split(X, Y, test_size = 0.2, random_state = 34)","c4592bbb":"linear_regressor.fit(X_train, Y_train)\nprint(\"R score: {0}\".format(round(linear_regressor.score(X_train, Y_train),2)))","b2d2838b":"print(\"Intercept: {0}\".format(round(linear_regressor.intercept_),))\n#pd.DataFrame({'feature':X.columns, 'coef':linear_regressor.coef_})","dbee72c3":"plt.scatter(X_train, Y_train, color = \"red\")\nplt.plot(X_train, linear_regressor.predict(X_train), color = \"blue\")\nplt.title(\"PREDICTING MATH SCORE WITH WRITING SCORE\")\nplt.xlabel(\"WRITING SCORE\")\nplt.ylabel(\"MATH SCORE\")\n#plt.savefig('basic_linear_regression.png')\nplt.show()","5e2e0fc0":"mae = mean_absolute_error(linear_regressor.predict(X_test), Y_test)\nmse = mean_squared_error(linear_regressor.predict(X_test), Y_test)\nrmse = np.sqrt(mse)\n\nprint('Mean Absolute Error (MAE): %.2f' % mae)\nprint('Mean Squared Error (MSE): %.2f' % mse)\nprint('Root Mean Squared Error (RMSE): %.2f' % rmse)","dc49e0f1":"## Basic Linear Regression\n\n**PREDICTING MATH SCORE WITH READING SCORE USING BASIC LINEAR REGRESSION ALGORITHM**","d2091558":"**PREDICTING MATH SCORE WITH WRITING SCORE USING BASIC LINEAR REGRESSION ALGORITHM**","41c61160":"## **One Hot Label Ecoding**"}}