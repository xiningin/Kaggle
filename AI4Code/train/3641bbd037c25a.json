{"cell_type":{"306bb5f1":"code","75140811":"code","9a487b02":"code","71a09032":"code","324e9b88":"code","3c475e0e":"code","a636d302":"code","5d474178":"code","a430df8a":"code","7e46e1d4":"code","db48cea6":"code","11ec80ce":"code","160eef08":"code","f861f3e3":"code","fc312dd9":"markdown","c1634c06":"markdown","7fea909b":"markdown","d5772fa4":"markdown","c3d5c130":"markdown","6faa8bb0":"markdown","09f4a914":"markdown","8ebce0a4":"markdown"},"source":{"306bb5f1":"!pip install fastai -q --upgrade","75140811":"import fastai\nprint(fastai.__version__)\nfrom fastai.vision.all import *\nfrom pathlib import Path","9a487b02":"path = Path('..\/input\/bears-fastai-2021\/bears')\n#path.ls()","71a09032":"def get_dls(bs, size):\n    dblock = DataBlock(blocks = (ImageBlock, CategoryBlock),\n                       get_items = get_image_files,\n                       get_y = parent_label,\n                       splitter = RandomSplitter(),\n                       item_tfms = Resize(size)\n                      )\n    return dblock.dataloaders(path, bs = bs)\n\n","324e9b88":"dls = get_dls(16, 128)","3c475e0e":"learn = cnn_learner(dls, resnet34, metrics=accuracy)","a636d302":"learn.lr_find()","5d474178":"learn = cnn_learner(dls, resnet34, metrics=accuracy)\nlearn.fit_one_cycle(10, 1e-3)","a430df8a":"learn.dls = get_dls(16, 224)\nlearn.fine_tune(5, 1e-3)","7e46e1d4":"learn.show_results()","db48cea6":"interp = Interpretation.from_learner(learn)\ninterp.plot_top_losses(k=1)","11ec80ce":"learn.predict('..\/input\/bears-fastai-2021\/bears\/black\/00000017.jpg')","160eef08":"learn.export(fname='model.pkl', pickle_module=pickle, pickle_protocol=2)","f861f3e3":"reload_model=load_learner('model.pkl', cpu=True, pickle_module=pickle)\nreload_model","fc312dd9":"# Bears Classify fastai\nThis notebook referred the following notebook.<br\/>\nhttps:\/\/www.kaggle.com\/mathurinache\/star-wars-characters-classification-with-fastai","c1634c06":"## Save model","7fea909b":"## Predict\nhttps:\/\/docs.fast.ai\/learner.html#Learner.predict","d5772fa4":"https:\/\/docs.fast.ai\/tutorial.datablock.html#Building-a-DataBlock-from-scratch","c3d5c130":"## Show results\nhttps:\/\/docs.fast.ai\/learner.html#Learner.show_results","6faa8bb0":"https:\/\/docs.fast.ai\/vision.learner.html#cnn_learner","09f4a914":"## Reload model","8ebce0a4":"## Interpretation\nhttps:\/\/docs.fast.ai\/tutorial.vision.html#Single-label-classification"}}