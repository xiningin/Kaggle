{"cell_type":{"987faac6":"code","6e3e9f54":"code","bad8a58a":"code","6b628b09":"code","c7949803":"code","43c7d43a":"code","a96910fa":"code","9f945e54":"markdown","b54117b5":"markdown","5384ce9a":"markdown","fb9fe485":"markdown","76ce4440":"markdown","36471e83":"markdown","10ec2232":"markdown"},"source":{"987faac6":"import numpy as np\nimport pandas as pd\nimport itertools\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.feature_extraction.text import TfidfVectorizer\nfrom sklearn.linear_model import PassiveAggressiveClassifier\nfrom sklearn.metrics import accuracy_score, confusion_matrix","6e3e9f54":"#Read the data\ndf=pd.read_csv('..\/input\/news.csv')\n\n#Get shape and head\nprint(df.shape)\ndf.head()","bad8a58a":"# Taking out the Target Variables\nlabels=df.label\nlabels.head()","6b628b09":"x_train,x_test,y_train,y_test=train_test_split(df['text'], labels, test_size=0.2, random_state=7)","c7949803":"# Initialize a TfidfVectorizer\ntfidf_vectorizer=TfidfVectorizer(stop_words='english', max_df=0.7)\n\n# Fit and transform train set, transform test set\ntfidf_train=tfidf_vectorizer.fit_transform(x_train) \ntfidf_test=tfidf_vectorizer.transform(x_test)","43c7d43a":"# Initialize a PassiveAggressiveClassifier\npac=PassiveAggressiveClassifier(max_iter=50)\npac.fit(tfidf_train,y_train)\n\n# Predict on the test set and calculate accuracy\ny_pred=pac.predict(tfidf_test)\nscore=accuracy_score(y_test,y_pred)\nprint(f'Accuracy: {round(score*100,2)}%')","a96910fa":"# Build confusion matrix\nconfusion_matrix(y_test,y_pred, labels=['FAKE','REAL'])","9f945e54":"# Loading Dataset","b54117b5":"# Analysis","5384ce9a":"# Results","fb9fe485":"# Introduction\n\nThis advanced python project of detecting fake news deals with fake and real news. Using sklearn, we build a TfidfVectorizer on our dataset. Then, we initialize a PassiveAggressive Classifier and fit the model. In the end, the accuracy score and the confusion matrix tell us how well our model fares.","76ce4440":"# Split the dataset","36471e83":"# Loading Libraries","10ec2232":"# Refences:\n1. [Detecting Fake News with Python](https:\/\/data-flair.training\/blogs\/advanced-python-project-detecting-fake-news\/)"}}