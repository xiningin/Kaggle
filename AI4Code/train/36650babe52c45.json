{"cell_type":{"5394c19d":"code","52a0e4bf":"code","c4aa2cce":"code","8532d86e":"code","7990e531":"code","1e11eeee":"code","759395c8":"code","efae5ce3":"code","56eb1603":"code","bf71cba9":"code","7e21d076":"code","bff0d182":"code","58600298":"code","72480511":"code","4761494d":"code","fc43f6ef":"code","ba74d298":"code","1c4f34db":"code","4cd6129d":"code","b60c49f8":"code","ff00eeaa":"code","50564486":"code","1e8b1ce1":"code","a6f4d397":"code","b40b146e":"code","9faf8722":"code","c67e7719":"code","f7907c24":"code","7d61c7fa":"code","41fb7443":"code","8e8c33f8":"code","4685e34e":"code","cc9ccc5d":"code","e9bf455e":"code","1a07b2e6":"code","05dbb179":"code","d5985d66":"code","ccc5e739":"code","cb2d4ebd":"code","9fbb0e1a":"code","94f88cd2":"code","f48cabed":"code","00c86aa5":"code","9923d81e":"code","6fb16c2a":"code","396b9951":"code","9d8faaea":"code","7a38515e":"code","25b1c35e":"code","63f8d145":"markdown","ba0ba7e1":"markdown","8810f0f3":"markdown","f8f7f046":"markdown","dc4fa3f8":"markdown","8d3c48cf":"markdown","8a1ae2bb":"markdown","6dfca766":"markdown","b6727a06":"markdown","4c6593c1":"markdown","93839cf2":"markdown","340e499b":"markdown","c71625da":"markdown","194f7a0f":"markdown","50b8322c":"markdown","1cc13091":"markdown","048585b5":"markdown","6f55ebc8":"markdown","09029726":"markdown","c2481e61":"markdown","6173ccb3":"markdown","2c4d5868":"markdown","bff6d798":"markdown","edd1074c":"markdown","13a24101":"markdown","baba42de":"markdown","997b6351":"markdown","26d7bacb":"markdown","21b1f2e1":"markdown","3946b974":"markdown","8ad3bb1b":"markdown","b0f04da4":"markdown","f6af7ebf":"markdown","c142ac30":"markdown","0147aa43":"markdown","106efa02":"markdown","04d0a18f":"markdown","f6cd893b":"markdown","28f001f2":"markdown","b1621e87":"markdown","38b03e67":"markdown","23a56cd6":"markdown","fbb94df1":"markdown"},"source":{"5394c19d":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","52a0e4bf":"df=pd.read_csv('..\/input\/heart-attack-analysis-prediction-dataset\/heart.csv')","c4aa2cce":"df","8532d86e":"print(\"Total rows and columns in dataset\",df.shape)","7990e531":"# Check the presence of null values in dataset\ndf.isnull().sum()","1e11eeee":"df.info()","759395c8":"# Check duplicate data\ndf.duplicated().sum()","efae5ce3":"# There is one duplicate row, so first drop it\ndf.drop_duplicates(inplace=True)","56eb1603":"# 1 row deleted from dataset\ndf.shape","bf71cba9":"#Staticial analysis of data\ndf.describe()","7e21d076":"df.caa.value_counts()","bff0d182":"index=df[df[\"caa\"]==4]\nindex","58600298":"# 4 entries are added to the value 0\nfrom statistics import mode\nmode=mode(df.caa)\ndf.loc[df.caa == 4, 'caa'] = mode\ndf.caa.value_counts()","72480511":"df.thall.value_counts()","4761494d":"Index=df[df[\"thall\"]==0]\nIndex\n","fc43f6ef":"# 2 entries of 0 added to 2\nfrom statistics import mode\nmode=mode(df.thall)\ndf.loc[df.thall ==0, 'thall']=mode\ndf.thall.value_counts()","ba74d298":"from matplotlib import pyplot as plt\nfrom matplotlib import style\nimport seaborn as sns ","1c4f34db":"X=df[\"age\"]\nplt.hist(X,color=\"green\")\nplt.title(\"Age distribution\",fontsize=25)\nplt.xlabel(\"Age\",fontsize=20)\nplt.ylabel(\"Frequancy\",fontsize=20)\nplt.grid(False)\nplt.gcf().set_size_inches(12,6)\nplt.show()\n\n# sns.histplot(data=df,x=\"age\",stat=\"probability\", discrete=True ,kde=True)\n\n","4cd6129d":"X=df[\"sex\"].value_counts().index\nprint(X)\nY=df[\"sex\"].value_counts()\nprint(Y)\nsns.countplot(data=df,x=\"sex\")\nplt.bar(X,Y,color=[\"pink\",\"black\"])\nplt.tight_layout()\nplt.xlabel(\"Sex_Category\",color=\"black\",fontsize=20)\nplt.ylabel(\"Count\",color=\"black\",fontsize=20)\nplt.title(\"Sex-distribution\",color=\"black\",fontsize=25)\nplt.gcf().set_size_inches(8,6)\nplt.show()\n\n","b60c49f8":"X=df[\"cp\"].value_counts().index\nX\nY=df[\"cp\"].value_counts()\nprint(Y)\nmyexplode=(0,0.1,0,0.1)\nmylabel=[\"Typical angina(0)\",\"Atypical(1)\",\"Non_aniginal pain(2)\",\"Asymptomatic pain(3)\"]\n\nplt.pie(Y,labels=mylabel,autopct=\"%1.1f%%\",startangle=15,shadow=True,explode=myexplode)\nplt.axis(\"equal\")\nplt.gcf().set_size_inches(12,6)\nplt.show()","ff00eeaa":"sns.countplot(data=df,x=\"cp\")\n#plt.bar(X,Y,color=[\"orange\",\"black\",\"pink\",\"blue\"])\nplt.xlabel(\"cp(chest pain)\",fontsize=20)\nplt.ylabel(\"count\",fontsize=20)\nplt.tight_layout()\nplt.grid(True)\nplt.gcf().set_size_inches(12,6)\nplt.show()\n","50564486":"\nplt.style.use(\"fivethirtyeight\")\nplt.title(\"Effect of age on blood pressure\",fontsize=20)\nsns.lineplot(df['age'],df['trtbps'])\nplt.gcf().set_size_inches(12,6)\n","1e8b1ce1":"plt.style.use(\"fivethirtyeight\")\nplt.title(\"Effect of age on cholestor level\",fontsize=20)\nsns.lineplot(x=df[\"age\"],y=df[\"chol\"])\nplt.gcf().set_size_inches(12,6)","a6f4d397":"plt.style.use(\"fivethirtyeight\")\nplt.title(\"Effect of age on heart rate\",fontsize=20)\nsns.lineplot(x=df[\"age\"],y=df[\"thalachh\"])\nplt.gcf().set_size_inches(12,6)\n","b40b146e":"plt.style.use(\"fivethirtyeight\")\nplt.title(\"Effect of age on rate of heart attack\",fontsize=20)\nsns.lineplot(x=df[\"age\"],y=df[\"output\"])\nplt.gcf().set_size_inches(12,6)\n","9faf8722":"hue_color={0:'green',1:'black'}\nsex=['female','male']\nax=sns.countplot(data=df,x='sex',hue='output',palette=hue_color)\nplt.xticks(ticks = [0,1], labels = sex)\nplt.legend(['less chance', 'high chance'])\nplt.gcf().set_size_inches(12,6)\nplt.show()","c67e7719":"hue_color={0:'green',1:'black'}\nax=sns.countplot(data=df,x='cp',hue='output',palette=hue_color)\nplt.legend(['less chance', 'high chance'])\nplt.gcf().set_size_inches(12,6)\nplt.show()","f7907c24":"ax = sns.kdeplot(data = df, x = 'trtbps', bw_adjust = 0.9, hue = 'output', palette = ['blue', 'yellow'])\nax.set(xlabel = 'resting blood pressure')\nplt.legend(['high chance', 'low chance'])\nplt.gcf().set_size_inches(12,6)\nplt.show()","7d61c7fa":"ax = sns.kdeplot(data = df, x = 'chol', bw_adjust = 0.9, hue = 'output', palette = ['blue', 'yellow'])\nax.set(xlabel = 'cholestrol')\nplt.legend(['high chance', 'low chance'])\nplt.gcf().set_size_inches(12,6)\nplt.show()","41fb7443":"hue_color={0:'green',1:'black'}\n# fbs=['true','false']\nax=sns.countplot(data=df,x='fbs',hue='output',palette=hue_color)\n# plt.xticks(ticks = [0,1], labels = fbs)\nplt.legend(['less chance', 'high chance'])\nplt.gcf().set_size_inches(12,6)\nplt.show()","8e8c33f8":"hue_color={0:'green',1:'black'}\n# fbs=['true','false']\nax=sns.countplot(data=df,x='restecg',hue='output',palette=hue_color)\n# plt.xticks(ticks = [0,1], labels = fbs)\nplt.legend(['less chance', 'high chance'])\nplt.gcf().set_size_inches(12,6)\nplt.show()","4685e34e":"ax = sns.kdeplot(data = df, x = 'thalachh', bw_adjust = 0.9, hue = 'output', palette = ['blue', 'yellow'])\nax.set(xlabel = 'Heart rate')\nplt.legend(['high chance', 'low chance'])\nplt.gcf().set_size_inches(12,6)\nplt.show()","cc9ccc5d":"hue_color={0:'green',1:'black'}\nax=sns.countplot(data=df,x='exng',hue='output',palette=hue_color)\nplt.legend(['less chance', 'high chance'])\nplt.gcf().set_size_inches(12,6)\nplt.show()","e9bf455e":"ax = sns.kdeplot(data = df, x = 'oldpeak', bw_adjust = 0.9, hue = 'output', palette = ['blue', 'yellow'])\nax.set(xlabel = 'oldpeak')\nplt.legend(['high chance', 'low chance'])\nplt.gcf().set_size_inches(12,6)\nplt.show()","1a07b2e6":"hue_color={0:'green',1:'black'}\nax=sns.countplot(data=df,x='slp',hue='output',palette=hue_color)\nplt.legend(['less chance', 'high chance'])\nplt.gcf().set_size_inches(12,6)\nplt.show()","05dbb179":"hue_color={0:'green',1:'black'}\nax=sns.countplot(data=df,x='caa',hue='output',palette=hue_color)\nplt.legend(['less chance', 'high chance'])\nplt.gcf().set_size_inches(12,6)\nplt.show()","d5985d66":"hue_color={0:'green',1:'black'}\nax=sns.countplot(data=df,x='thall',hue='output',palette=hue_color)\nplt.legend(['less chance', 'high chance'])\nplt.gcf().set_size_inches(12,6)\nplt.show()","ccc5e739":"df","cb2d4ebd":"# Features to train the model\nX=df.iloc[:,:13]\nX","9fbb0e1a":"# Target variable\nY=df.iloc[:,13:]\nY","94f88cd2":"from sklearn.pipeline import Pipeline\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.metrics import classification_report,confusion_matrix,plot_confusion_matrix,accuracy_score\nfrom sklearn.model_selection import train_test_split","f48cabed":"X_train,X_test,Y_train,Y_test=train_test_split(X,Y,test_size=0.2)\nsc=StandardScaler()\nX_train=sc.fit_transform(X_train)\nX_test=sc.fit_transform(X_test)\nY_train=np.ravel(Y_train)\nclf=LogisticRegression()\nclf.fit(X_train,Y_train)\npred=clf.predict(X_test)\nlog_acc=accuracy_score(pred,Y_test);\nprint(\"REPORT: \")\nprint(confusion_matrix(Y_test,pred))\nprint(classification_report(Y_test,pred))\nplot_confusion_matrix(clf,X_test,Y_test)\nplt.grid(False)\nplt.gcf().set_size_inches(12,6)\n\n","00c86aa5":"from sklearn.neighbors import KNeighborsClassifier","9923d81e":"clf=KNeighborsClassifier(n_neighbors=9)\nclf.fit(X_train,Y_train)\npred=clf.predict(X_test)\nknn=accuracy_score(pred,Y_test);\nprint(\"REPORT: \")\nprint(confusion_matrix(Y_test,pred))\nprint(classification_report(Y_test,pred))\nplot_confusion_matrix(clf,X_test,Y_test)\nplt.grid(False)\nplt.gcf().set_size_inches(12,6)","6fb16c2a":"from sklearn.tree import DecisionTreeClassifier","396b9951":"clf=DecisionTreeClassifier(criterion=\"entropy\", max_depth=3)\nclf.fit(X_train,Y_train)\npred=clf.predict(X_test)\ndtc=accuracy_score(pred,Y_test);\nprint(\"REPORT: \")\nprint(confusion_matrix(Y_test,pred))\nprint(classification_report(Y_test,pred))\nplot_confusion_matrix(clf,X_test,Y_test)\nplt.grid(False)\nplt.gcf().set_size_inches(12,6)\n","9d8faaea":"from sklearn.ensemble import RandomForestClassifier","7a38515e":"clf = RandomForestClassifier(n_estimators = 100)\nclf.fit(X_train,Y_train)\npred=clf.predict(X_test)\nrcf=accuracy_score(pred,Y_test);\nprint(\"REPORT: \")\nprint(confusion_matrix(Y_test,pred))\nprint(classification_report(Y_test,pred))\nplot_confusion_matrix(clf,X_test,Y_test)\nplt.grid(False)\nplt.gcf().set_size_inches(12,6)\n  ","25b1c35e":"print(\"Accuracy of Logistic Regression : \",log_acc)\nprint(\"Accuracy of Decision Tree Classifier : \",dtc)\nprint(\"Accuracy of KNN Classifier : \",knn)\nprint(\"Accuracy of Random Forest Classifier : \",rcf)\nmodels_acc=[log_acc,dtc,knn,rcf]\nnames_of_models=['LogisticRegression','DecisionTreeClassifier','KNNClassifier','RandomForestClassifier'];\nsns.barplot(y=names_of_models,x=models_acc)\nplt.gcf().set_size_inches(8,4)\nplt.xlim([0.6,1.0])\n","63f8d145":"# 3.Decision Tree Classifier","ba0ba7e1":"# 2. Sex","8810f0f3":"# Report of Models","f8f7f046":"In 'thall' 2 entries of 0 are present which is out of range,we cannot know the what 0 indicates,so we replace it with the mode of this feature","dc4fa3f8":"# 6. Fasting blood sugar","8d3c48cf":"Observation: 1. Patients with lower values are at high risk.\n\n2. Patients with high values are at low risk.","8a1ae2bb":"# 7. Resting electrocardiography results","6dfca766":"# 4.Resting blodd pressure","b6727a06":"# 13. Thalassemia blood disorder(thall)","4c6593c1":"Oservation: 1.Patients with value 2 for thall are at high risk of getting heart attack","93839cf2":"# 5. Cholestrol","340e499b":"# 10. Exercise induced ST depression (oldpeak)","c71625da":"Observation: 1.Patients having value 3 for caa has bad correlation with target variable.\n\n2. Pateints with value 0 for caa have high chances of getting heart attack.","194f7a0f":"Observation:  1. Males have less chances of getting heart attack than females.\n\n2. A signifciant number of males are at less risk compared to no of males with high risk.\n             \n3. A signifciant number of females are at high risk compared to number of females with less risk","50b8322c":"# 1.Logistic Regression","1cc13091":" Observation: Patients who have resting blood pressure with range between 80 and 150 have high chance of being at high risk","048585b5":"# Types of Chest pain(cp)","6f55ebc8":"Observation: 1. Patients with heart rate greater than 100 have high chances of heart attack.\n\n2. Patients with heart rate less than 100 have less chances of heart attack","09029726":"OBSERVATION: 1.With increase in age, blood pressure also increased","c2481e61":"# DESCRIPTION OF FEATURES OF DATA\n\n1.age:- it respresents the age of patients\n\n2.sex:- it represents the sex of patients (1 stands for 'MALE' and 0 stands for 'FEAMLE')\n\n3.cp:- cp stands for chest pain.In this dataset,there are four types of chest pain (0=asymptomatic, 1=typical angina,\n        2=atypical angina, 3=non-anginal pain)\n        \n4.trtbps:- Resting blood pressure(in mm hg on admission to the hospital)\n\n5.chol:- Serum cholestoral in mg\/dl\n\n6.fbs:-Fasting blood sugar>120mg\/dl (1=true, 0=false)\n\n7.restecg:-Resting electrocardiography results(0=normal, 1=having ST-T wave normality, 2=hypertrophy)\n\n8.thalachh:- Maximum heart rate achieved\n\n9.exng:-exercise induced angina(1=yes, 0=no)\n\n10.oldpeak:-ST depression induced by exercise relative to rest\n\n11.slp:- Slope of peak exercise ST segment(0= dowmsloping, 1=flat, 2=upsloping)\n\n12.caa:-Number of major vessels(0-3) coloured by flourosopy)\n\n13.thall:-Thalassemia blood disorder(1=fixed defect, 2=normal, 3=reversable defect)\n\n14.output:- The target variable and predicted attribute(0=less chance of heart attack, 1=high rate of heart attack)\n\n","6173ccb3":"OBSERVATION: With increase in age,rate of heart attack decreased,but instantly after age 70, rate of heart attack increased,and then again drooped","2c4d5868":"Observation: Patients with cholestrol value between 100 to 300 have high chances of heart attack","bff6d798":"# Models","edd1074c":"OBSERVATION: With increase in age,cholestor level also increased","13a24101":"# 2. Knn classifier","baba42de":"# Data Visualisation","997b6351":"We observe that column \"caa\" has 4 entries with the value 4 which is outside the range, so we replace it with the mode of this features","26d7bacb":"# 12. Number of major vessels (caa)","21b1f2e1":"OBSERVATION: With increase in age, heart rate decreased","3946b974":"# Correlation of features of dataset with the target variable","8ad3bb1b":"Observation: 1. Patients with 0 value of exng have high chances of heart attack.\n\n2. Patients with 1 value of exng have less chances of heart attack compared to high chances of heart attcak.\n","b0f04da4":"# Data Cleaning","f6af7ebf":"Observation: 1. Patients with chest pain 0 have less chances of heart attack as compared to others chest pains.\n\n             2. Patients with chest pain 1,2 are at high risk.","c142ac30":"# 8. Thalachh(heart rate)","0147aa43":" Observation: 1. Patients with value 1 have high chances of heart attack risk.\n \n 2. Patients with value 0 are with less risk level. \n                ","106efa02":"Observation: There isn't much correlation between the target variable(output)","04d0a18f":"# 1.AGE","f6cd893b":"# 9. exercise induced angina(exng)","28f001f2":"# Random Forest Classifier","b1621e87":"# 11. Slope of peak exercise ST segment(slp)","38b03e67":"# 3.Chest pain","23a56cd6":"Observation: 1.Patients with 0 value of slp have bad correlation with output variable.\n\n2. Patients with 2 value of slp have high risk of getting heart attack.\n\n 3.Patients with value 1 of slp having less risk of getting heart attack.","fbb94df1":"Both charts indicates the frequency of 4 types of chest pain"}}