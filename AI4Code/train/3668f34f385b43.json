{"cell_type":{"824806b8":"code","2a2a9e8d":"code","841858a5":"code","0642e260":"code","c51815ac":"code","ca1b59b2":"code","463ebfc8":"code","0798d22b":"code","95c5ed0f":"code","2307054a":"code","d166ccb3":"code","455c5721":"code","eb13954c":"code","d4472d8c":"markdown","a0eb29d3":"markdown","6b25bf91":"markdown","aa888458":"markdown","a51ff708":"markdown","cdb4dfd0":"markdown","d51c0a0f":"markdown","f4914f34":"markdown","7c798053":"markdown","bd52a07f":"markdown"},"source":{"824806b8":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport warnings\nwarnings.filterwarnings('ignore')","2a2a9e8d":"train = pd.read_csv(\"..\/input\/tabular-playground-series-sep-2021\/train.csv\")\ntest = pd.read_csv(\"..\/input\/tabular-playground-series-sep-2021\/test.csv\")","841858a5":"train.shape, test.shape","0642e260":"train.head()","c51815ac":"# Train columns that do not exist in Test columns\ncols_missing = [col for col in train.columns if col not in test.columns]\nprint(\"Train columns that do not exist in Test columns:\", cols_missing)\n\n# Test columns that do not exist in Train columns\ncols_missing = [col for col in test.columns if col not in train.columns]\nprint(\"Test columns that do not exist in Train columns:\", cols_missing)","ca1b59b2":"# how many total missing values do we have?\nmissing_values_count = train.isnull().sum()\n# missing_values_count = test.isnull().sum()\ntotal_cells = np.product(train.shape)\ntotal_missing = missing_values_count.sum()\n\n# percent of data that is missing\npercent_missing = (total_missing\/total_cells) * 100\nprint(percent_missing)","463ebfc8":"# Missing values\npd.options.display.max_rows = 120\npd.DataFrame({'Train': train.isnull().sum(), 'Test': test.isnull().sum(), 'Type': train.dtypes}, index=train.columns)","0798d22b":"# Target distribution\nplt.figure(figsize=(8,5))\nsns.countplot(x=train.claim)","95c5ed0f":"# Rows with missing target\ntrain.loc[train.claim.isnull()]","2307054a":"# List of categorial features\ncat_features = [col for col in train.columns if train[col].dtypes == 'object']\nprint(len(cat_features), cat_features)\n\n# List of numerical features\nnum_features = [col for col in train.columns if train[col].dtypes == 'float64']\nprint(len(num_features), num_features)","d166ccb3":"# Combined dataframe containing numerical features only\ndf = pd.concat([train[num_features], test[num_features]], axis=0)\ncolumns = df.columns.values\n\n# Calculating required amount of rows to display all feature plots\ncols = 3\nrows = len(columns) \/\/ cols + 1\n\nfig, axs = plt.subplots(ncols=cols, nrows=rows, figsize=(20,100), sharex=False)\n\n# Adding some distance between plots\nplt.subplots_adjust(hspace = 0.3)\n\n# Plots counter\ni=0\nfor r in np.arange(0, rows, 1):\n    for c in np.arange(0, cols, 1):\n        if i >= len(columns): # If there is no more data columns to make plots from\n            axs[r, c].set_visible(False) # Hiding axes so there will be clean background\n        else:\n            # Train data histogram\n            hist1 = axs[r, c].hist(train[columns[i]].values,\n                                   range=(df[columns[i]].min(),\n                                          df[columns[i]].max()),\n                                   bins=40,\n                                   color=\"deepskyblue\",\n                                   edgecolor=\"black\",\n                                   alpha=0.7,\n                                   label=\"Train Dataset\")\n            # Test data histogram\n            hist2 = axs[r, c].hist(test[columns[i]].values,\n                                   range=(df[columns[i]].min(),\n                                          df[columns[i]].max()),\n                                   bins=40,\n                                   color=\"palevioletred\",\n                                   edgecolor=\"black\",\n                                   alpha=0.7,\n                                   label=\"Test Dataset\")\n            axs[r, c].set_title(columns[i], fontsize=14, pad=5)\n            axs[r, c].tick_params(axis=\"y\", labelsize=13)\n            axs[r, c].tick_params(axis=\"x\", labelsize=13)\n            axs[r, c].grid(axis=\"y\")\n            axs[r, c].legend(fontsize=13)\n                                  \n        i+=1\n# plt.suptitle(\"Numerical feature values distribution in both datasets\", y=0.99)\nplt.show();","455c5721":"# Feature correlation\ndf = train.drop(\"id\", axis=1)\n\n# Calculatin correlation values\ndf = df.corr().round(2)\n\n# Mask to hide upper-right part of plot as it is a duplicate\nmask = np.zeros_like(df)\nmask[np.triu_indices_from(mask)] = True\n\n# Making a plot\nplt.figure(figsize=(50,50))\nax = sns.heatmap(df, annot=True, mask=mask, cmap=\"RdBu\", annot_kws={\"weight\": \"normal\", \"fontsize\":9})\nax.set_title(\"Feature correlation heatmap\", fontsize=17)\nplt.setp(ax.get_xticklabels(), rotation=90, ha=\"right\",\n         rotation_mode=\"anchor\", weight=\"normal\")\nplt.setp(ax.get_yticklabels(), weight=\"normal\",\n         rotation_mode=\"anchor\", rotation=0, ha=\"right\")\nplt.show();","eb13954c":"for feature in num_features:\n    fig, ax =plt.subplots(ncols=3, nrows=1, figsize=(20,5))\n    sns.distplot(train[feature], ax=ax[0])\n    sns.boxplot(train[feature], ax=ax[1])\n    sns.stripplot(x=train.claim, y=train[feature], ax=ax[2])\n    fig.show()","d4472d8c":"No categorical data  \n118 numerical columns","a0eb29d3":"## Feature vs Target","6b25bf91":"Not much correlation between target and 118 numerical features. Again, this is common in synthetic data.","aa888458":"## Visualization","a51ff708":"No rows with missing claim column","cdb4dfd0":"Train and test datasets are very similar. This is one of the important features of synthetic data.","d51c0a0f":"## First Look","f4914f34":"There are a few missing values","7c798053":"## Missing data","bd52a07f":"Looks like all rows have a few missing values in both train and test datasets"}}