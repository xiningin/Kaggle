{"cell_type":{"6105d4ef":"code","b7acff58":"code","2f4f07e5":"code","6bd3177b":"code","66123f9e":"code","3e7efdca":"code","b567db9e":"code","bae6be04":"code","7e64612c":"code","89ffa4bc":"code","86ce0ac8":"code","08d3e14a":"code","e5d3db14":"code","bce5edad":"markdown","3783f14a":"markdown","79cb8b70":"markdown","c3228d47":"markdown","899ec3cf":"markdown","d2808103":"markdown","91627e36":"markdown","23f4161b":"markdown"},"source":{"6105d4ef":"import numpy as np\nimport pandas as pd\n\nfrom sklearn.metrics import confusion_matrix\n\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.model_selection import train_test_split\n\nfrom sklearn.neural_network import MLPClassifier\nfrom sklearn.model_selection import GridSearchCV, cross_val_score\n\nimport os\nprint(os.listdir(\"..\/input\"))","b7acff58":"dataset = pd.read_csv('..\/input\/Skyserver_SQL2_27_2018 6_51_39 PM.csv')","2f4f07e5":"dataset.head()","6bd3177b":"columns = ['redshift', 'u', 'g', 'r', 'i', 'z', 'class']","66123f9e":"dataset = dataset.loc[:, columns]\n\nle = LabelEncoder().fit(dataset['class'])\ndataset['class'] = le.transform(dataset['class'])","3e7efdca":"dataset.head()","b567db9e":"X_train, X_test, y_train, y_test = train_test_split(dataset.drop(labels = 'class', axis = 'columns'), dataset['class'], test_size = 0.3)","bae6be04":"dici_param = {\"activation\": [\"tanh\", \"logistic\", \"relu\"]}\nclf = GridSearchCV(estimator = MLPClassifier(max_iter=400), param_grid = dici_param, cv = 5, n_jobs = -1)","7e64612c":"clf.fit(X_train, y_train)","89ffa4bc":"clf.score(X_test, y_test)","86ce0ac8":"y_pred = clf.predict(X_test)","08d3e14a":"class_labels = le.inverse_transform([0,1,2])\nconfusion_df = pd.DataFrame(confusion_matrix(y_test, y_pred),\n                            columns = class_labels,\n                            index = class_labels)","e5d3db14":"confusion_df","bce5edad":"# MLP classificer for the sloan data set\nWe apply almost _out of the box_ the [mlp classifier](https:\/\/scikit-learn.org\/stable\/modules\/generated\/sklearn.neural_network.MLPClassifier.html#sklearn.neural_network.MLPClassifier) packaged with sklearn to the sloan dataset and find it to be very accurate! We give a basic introduction on how to use a multilayer perceptron to classification tasks","3783f14a":"The neural network can classify correctly more than 90% of the test sample! Let's make a confusion matrix to see where the erros are distributed","79cb8b70":"Most of the information in the columns are just classification labels. Based on this fact set we can restrict our exploration to columns with physical properties, to be the _redshift_ and the response of the telescope to the electromagnetic bands. Furthermore, we need the class too :)","c3228d47":"The class column contains strings, so we need a label encoder to convert it to numerical values","899ec3cf":"Now we split the dataset intro a training and test. We also perform a simple grid search looking for the better activation function of our network that is, by default, a one layer network with 100 neurons.","d2808103":"first of all we need to import all the packages we need. Numpy and Pandas for data manipulation and all the modules from sklearn","91627e36":"We load the dataset from the csv file and we give a peek into what is inside","23f4161b":"After training, lets see our score!"}}