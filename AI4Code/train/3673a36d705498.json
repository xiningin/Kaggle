{"cell_type":{"326f10af":"code","508d8d61":"code","3b17cc84":"code","851fe7bf":"code","512c3433":"code","6e3c076e":"code","ba95dc09":"code","ac702b27":"code","27abad72":"code","a7691f1e":"code","97e1e302":"code","fd16d478":"code","e6321a23":"code","0ce52af5":"code","ecb02125":"code","7dbfcc03":"code","9f9b8587":"code","e692281c":"markdown","2203d0b0":"markdown","4bef4104":"markdown","6d278a35":"markdown","5001fac0":"markdown","dd36a96d":"markdown","72c144da":"markdown","60b32fb6":"markdown","f9884f9d":"markdown","a8416beb":"markdown","803e7f51":"markdown","d3f1d1a6":"markdown","f72d643a":"markdown","c8b33a5d":"markdown","f8153ddf":"markdown","4f897b86":"markdown","f25ef88c":"markdown","505b3f5b":"markdown","a3a7ced0":"markdown"},"source":{"326f10af":"import warnings\nfrom sklearn.exceptions import DataConversionWarning\n# Suppress warnings\nwarnings.filterwarnings(action='ignore', category=DataConversionWarning)\nwarnings.filterwarnings(action='ignore', category=DeprecationWarning)\nwarnings.filterwarnings(action='ignore', category=FutureWarning)","508d8d61":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport os\nfrom sklearn.feature_selection import SelectKBest, f_regression\nfrom sklearn.preprocessing import OneHotEncoder, LabelEncoder, MinMaxScaler, StandardScaler\n\n# Set pandas data display option\npd.set_option('display.max_columns', 100)\npd.set_option('display.max_rows', 500)\n\n# Display all filenames\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","3b17cc84":"# Load csv data\ntrain = pd.read_csv(\"..\/input\/train.csv\")\ncompe = pd.read_csv(\"..\/input\/test.csv\")\nsample_sub = pd.read_csv(\"..\/input\/sample_submission.csv\")\n\n# All data\ndata  = train.append(compe, sort=False)","851fe7bf":"# Columns\nprint(len(data.columns))\ndata.columns","512c3433":"# Data example\ndata.sample(n=10)","6e3c076e":"types = pd.DataFrame(data.dtypes).rename(columns={0: 'type'}).sort_values(by=['type'],ascending=False)\ntypes","ba95dc09":"# Check missing values\ndef check_missing(df):\n    null_val = df.isnull().sum()\n    percent = 100 * df.isnull().sum()\/len(df)\n    missing_table = pd.concat([null_val, percent], axis=1)\n    col = missing_table.rename(columns = {0 : 'Num', 1 : 'Rate'})\n    return col\n\n# Display columns missing values are under 1%.\nprint(\"Data #\"+str(len(data)))\ncols = check_missing(data)\ntypes.join(cols).sort_values(by=\"Rate\", ascending=False)","ac702b27":"# Drop more than 40% missing variables\ndata.drop(['PoolQC', 'MiscFeature', 'Alley', 'Fence', 'FireplaceQu'], axis=1, inplace = True)","27abad72":"# Fill missing data and replace with dummy value\ncategorical_variables_string = \\\n    ['MSZoning', 'Street', 'LotShape', 'LandContour', \n     'Utilities', 'LotConfig', 'LandSlope', 'Neighborhood', \n     'Condition1', 'Condition2', 'BldgType', 'HouseStyle', \n     'RoofStyle', 'RoofMatl', 'Exterior1st', 'Exterior2nd', \n     'MasVnrType', 'ExterQual', 'ExterCond', 'Foundation', \n     'BsmtQual', 'BsmtCond', 'BsmtExposure', 'BsmtFinType1', \n     'BsmtFinType2', 'Heating', 'HeatingQC', 'CentralAir', \n     'Electrical', 'KitchenQual', 'Functional', 'GarageType', \n     'GarageFinish', 'GarageQual', 'GarageCond', 'PavedDrive', \n     'SaleType', 'SaleCondition']\n\nfor v in categorical_variables_string:\n    # Fill NaN with mode\n    data[v] = data[v].fillna(data[v].mode()[0])\n    # One-Hot Encoding\n    data = pd.get_dummies(data, columns=[v], drop_first=True)\n    # Categorize\n    # data[v] = pd.factorize(data[v])[0]","a7691f1e":"# There's no missing data\ncategorical_variables_int = \\\n    ['OverallQual', 'OverallCond', 'MoSold']","97e1e302":"# Fill missing data\nnumerical_variavles = \\\n    ['MSSubClass', 'LotFrontage', 'LotArea', 'YearBuilt', \n     'YearRemodAdd', 'MasVnrArea', 'BsmtFinSF1', 'BsmtFinSF2', \n     'BsmtUnfSF', 'TotalBsmtSF', '1stFlrSF', '2ndFlrSF', \n     'LowQualFinSF', 'GrLivArea', 'BsmtFullBath', 'BsmtHalfBath', \n     'FullBath', 'HalfBath', 'BedroomAbvGr', 'KitchenAbvGr', \n     'TotRmsAbvGrd', 'Fireplaces', 'GarageYrBlt', 'GarageCars', \n     'GarageArea', 'WoodDeckSF', 'OpenPorchSF', 'EnclosedPorch', \n     '3SsnPorch', 'ScreenPorch', 'PoolArea', 'MiscVal', 'YrSold']\n\nss = StandardScaler()\nfor v in numerical_variavles:\n    # Fill NaN with mean\n    data[v] = data[v].fillna(data[v].mean())\n    # Standardize values\n    data[v] = ss.fit_transform(data[[v]])","fd16d478":"# Data example\ndata.sample(n=10)","e6321a23":"# Set data\ntrain = data[:1460]\ntest  = data[1460:]","0ce52af5":"possible_features = train.columns.copy().drop('SalePrice').drop('Id')\n\n# Check feature importances\nselector = SelectKBest(f_regression, len(possible_features))\nselector.fit(train[possible_features], train['SalePrice'])\nscores = -np.log10(selector.pvalues_)\nindices = np.argsort(scores)[::-1]\nprint('Feature importances:')\nfor i in range(len(scores)):\n    print('%.2f %s' % (scores[indices[i]], possible_features[indices[i]]))","ecb02125":"# Feature params\nfparams = \\\n    ['OverallQual', 'GrLivArea', 'GarageCars', 'GarageArea', 'TotalBsmtSF', \n     '1stFlrSF', 'ExterQual_TA', 'FullBath', 'TotRmsAbvGrd', 'YearBuilt', \n     'KitchenQual_TA', 'GarageFinish_Unf', 'YearRemodAdd', 'BsmtQual_TA', \n     'Foundation_PConc', 'MasVnrArea', 'GarageYrBlt', 'Fireplaces', \n     'ExterQual_Gd', 'BsmtFinType1_GLQ', 'Neighborhood_NridgHt', 'BsmtFinSF1', \n     'MasVnrType_None', 'SaleType_New', 'GarageType_Detchd', 'SaleCondition_Partial', \n     'Foundation_CBlock', 'LotFrontage', 'MasVnrType_Stone', 'Neighborhood_NoRidge', \n     'WoodDeckSF', 'KitchenQual_Gd', 'BsmtExposure_No', '2ndFlrSF', 'OpenPorchSF', \n     'HeatingQC_TA', 'BsmtExposure_Gd', 'Exterior2nd_VinylSd', 'Exterior1st_VinylSd', \n     'MSZoning_RM', 'HalfBath', 'LotShape_Reg', 'LotArea', 'CentralAir_Y', 'MSZoning_RL', \n     'HouseStyle_2Story', 'SaleType_WD', 'Electrical_SBrkr', 'RoofStyle_Hip', 'GarageType_BuiltIn', \n     'BsmtQual_Gd', 'GarageType_Attchd', 'PavedDrive_Y', 'BsmtFullBath', 'RoofStyle_Gable', \n     'Neighborhood_StoneBr', 'BsmtUnfSF', 'MasVnrType_BrkFace', 'Neighborhood_OldTown', \n     'Neighborhood_NAmes', 'Neighborhood_Edwards', 'GarageFinish_RFn', 'RoofMatl_WdShngl', \n     'BedroomAbvGr', 'Exterior1st_MetalSd', 'Neighborhood_IDOTRR', 'Exterior2nd_MetalSd', \n     'Exterior2nd_Wd Sdng', 'Exterior1st_Wd Sdng', 'KitchenQual_Fa', 'SaleCondition_Normal', \n     'Neighborhood_BrkSide', 'LotConfig_CulDSac', 'Neighborhood_Somerst', 'ExterCond_Fa', \n     'GarageCond_TA', 'KitchenAbvGr', 'BsmtFinType1_Rec', 'HeatingQC_Gd', 'HeatingQC_Fa', \n     'Exterior1st_CemntBd', 'GarageQual_Fa', 'BsmtFinType1_Unf', 'BsmtFinType1_BLQ', \n     'GarageCond_Fa', 'BsmtQual_Fa', 'EnclosedPorch', 'Neighborhood_Sawyer', 'Exterior2nd_CmentBd', \n     'Electrical_FuseF', 'Neighborhood_Timber', 'LotShape_IR2', 'LandContour_HLS', 'Foundation_Slab', \n     'Condition1_Feedr', 'Functional_Typ', 'ExterQual_Fa', 'BldgType_Duplex', 'Condition1_Norm', \n     'Neighborhood_MeadowV', 'ScreenPorch', 'ExterCond_TA', 'RoofMatl_CompShg', 'Neighborhood_BrDale', \n     'BldgType_Twnhs', 'BldgType_2fmCon', 'GarageQual_TA', 'Exterior1st_HdBoard', 'HouseStyle_SFoyer', \n     'Heating_GasA', 'PoolArea', 'Heating_Grav', 'MSZoning_FV', 'BsmtCond_Gd', 'PavedDrive_P', \n     'HouseStyle_1.5Unf', 'BsmtFinType1_LwQ', 'MSSubClass', 'LotConfig_Inside', 'OverallCond', \n     'Exterior2nd_ImStucc', 'Neighborhood_CollgCr', 'Functional_Min2', 'Neighborhood_Crawfor', \n     'GarageType_CarPort', 'Functional_Maj2', 'Exterior2nd_HdBoard']\n\n# Get params\ntrain_target = train[\"SalePrice\"].values\ntrain_features = train[fparams].values\ntest_features  = test[fparams].values","7dbfcc03":"from sklearn.model_selection import GridSearchCV, train_test_split\nfrom sklearn.ensemble import GradientBoostingRegressor\n\nparameters = {\n    'loss': ['ls','huber'],\n    'n_estimators' : [1000],\n    'learning_rate': [0.02,0.03,0.04,0.05],\n    'max_depth': [2,4,6,8],\n    'max_features': ['sqrt'],\n    \"min_samples_split\": [2,3,4,8,16],\n    'min_samples_leaf': [2,3,4,8,16]\n}\n\ncv = GridSearchCV(GradientBoostingRegressor(), parameters, cv=8, scoring='neg_mean_absolute_error')\ncv.fit(train_features, train_target)\nprint(\"GridSearch score: \"+str(cv.best_score_))\nprint(\"GridSearch params: \")\nprint(cv.best_params_)","9f9b8587":"prediction = cv.best_estimator_.predict(test_features)\npred = pd.DataFrame(pd.read_csv(\"..\/input\/test.csv\")['Id'])\npred['SalePrice'] = prediction\npred.to_csv(\"..\/working\/submission.csv\", index = False)","e692281c":"# Training and Prediction <a id=\"training-prediction\"><\/a>","2203d0b0":"# Data Pre-Processing <a id=\"pre-processing\"><\/a>","4bef4104":"This time, pick variables by their importances  \n  \n**Possible features(Ordered by importances)**  \n    ['OverallQual', 'GrLivArea', 'GarageCars', 'GarageArea', 'TotalBsmtSF', \n     '1stFlrSF', 'ExterQual_TA', 'FullBath', 'TotRmsAbvGrd', 'YearBuilt', \n     'KitchenQual_TA', 'GarageFinish_Unf', 'YearRemodAdd', 'BsmtQual_TA', \n     'Foundation_PConc', 'MasVnrArea', 'GarageYrBlt', 'Fireplaces', \n     'ExterQual_Gd', 'BsmtFinType1_GLQ', 'Neighborhood_NridgHt', 'BsmtFinSF1', \n     'MasVnrType_None', 'SaleType_New', 'GarageType_Detchd', 'SaleCondition_Partial', \n     'Foundation_CBlock', 'LotFrontage', 'MasVnrType_Stone', 'Neighborhood_NoRidge', \n     'WoodDeckSF', 'KitchenQual_Gd', 'BsmtExposure_No', '2ndFlrSF', 'OpenPorchSF', \n     'HeatingQC_TA', 'BsmtExposure_Gd', 'Exterior2nd_VinylSd', 'Exterior1st_VinylSd', \n     'MSZoning_RM', 'HalfBath', 'LotShape_Reg', 'LotArea', 'CentralAir_Y', 'MSZoning_RL', \n     'HouseStyle_2Story', 'SaleType_WD', 'Electrical_SBrkr', 'RoofStyle_Hip', 'GarageType_BuiltIn', \n     'BsmtQual_Gd', 'GarageType_Attchd', 'PavedDrive_Y', 'BsmtFullBath', 'RoofStyle_Gable', \n     'Neighborhood_StoneBr', 'BsmtUnfSF', 'MasVnrType_BrkFace', 'Neighborhood_OldTown', \n     'Neighborhood_NAmes', 'Neighborhood_Edwards', 'GarageFinish_RFn', 'RoofMatl_WdShngl', \n     'BedroomAbvGr', 'Exterior1st_MetalSd', 'Neighborhood_IDOTRR', 'Exterior2nd_MetalSd', \n     'Exterior2nd_Wd Sdng', 'Exterior1st_Wd Sdng', 'KitchenQual_Fa', 'SaleCondition_Normal', \n     'Neighborhood_BrkSide', 'LotConfig_CulDSac', 'Neighborhood_Somerst', 'ExterCond_Fa', \n     'GarageCond_TA', 'KitchenAbvGr', 'BsmtFinType1_Rec', 'HeatingQC_Gd', 'HeatingQC_Fa', \n     'Exterior1st_CemntBd', 'GarageQual_Fa', 'BsmtFinType1_Unf', 'BsmtFinType1_BLQ', \n     'GarageCond_Fa', 'BsmtQual_Fa', 'EnclosedPorch', 'Neighborhood_Sawyer', 'Exterior2nd_CmentBd', \n     'Electrical_FuseF', 'Neighborhood_Timber', 'LotShape_IR2', 'LandContour_HLS', 'Foundation_Slab', \n     'Condition1_Feedr', 'Functional_Typ', 'ExterQual_Fa', 'BldgType_Duplex', 'Condition1_Norm', \n     'Neighborhood_MeadowV', 'ScreenPorch', 'ExterCond_TA', 'RoofMatl_CompShg', 'Neighborhood_BrDale', \n     'BldgType_Twnhs', 'BldgType_2fmCon', 'GarageQual_TA', 'Exterior1st_HdBoard', 'HouseStyle_SFoyer', \n     'Heating_GasA', 'PoolArea', 'Heating_Grav', 'MSZoning_FV', 'BsmtCond_Gd', 'PavedDrive_P', \n     'HouseStyle_1.5Unf', 'BsmtFinType1_LwQ', 'MSSubClass', 'LotConfig_Inside', 'OverallCond', \n     'Exterior2nd_ImStucc', 'Neighborhood_CollgCr', 'Functional_Min2', 'Neighborhood_Crawfor', \n     'GarageType_CarPort', 'Functional_Maj2', 'Exterior2nd_HdBoard', 'MSZoning_RH', 'Functional_Min1', \n     'Neighborhood_SWISU', 'Neighborhood_Veenker', 'GarageCond_Po', 'HouseStyle_1Story', 'Heating_Wall', \n     'Neighborhood_Mitchel', 'BsmtFinType2_BLQ', 'BsmtFinType2_Unf', 'Neighborhood_ClearCr', \n     'BsmtCond_Po', 'Exterior2nd_Plywood', 'Exterior1st_WdShing', 'Exterior1st_BrkComm', \n     'SaleCondition_AdjLand', 'ExterCond_Gd', 'Condition1_PosN', 'Condition2_PosN', 'Condition2_Feedr', \n     'Electrical_FuseP', 'Condition2_PosA', 'Exterior2nd_Brk Cmn', 'Condition1_RRAe', \n     'SaleCondition_Family', 'MoSold', 'GarageQual_Po', 'LandContour_Low', 'Exterior2nd_Other', \n     'RoofMatl_WdShake', '3SsnPorch', 'BsmtExposure_Mn', 'GarageQual_Gd', 'LandSlope_Mod', \n     'Exterior2nd_Stucco', 'Condition1_PosA', 'SaleType_ConLD', 'SaleType_Con', 'Street_Pave', \n     'Exterior2nd_Wd Shng', 'BsmtFinType2_Rec', 'Condition2_RRNn', 'HouseStyle_SLvl', \n     'Neighborhood_NPkVill', 'BsmtFinType2_LwQ', 'Electrical_Mix', 'LotShape_IR3', 'HouseStyle_2.5Fin', \n     'Exterior1st_Stone', 'Neighborhood_Gilbert', 'RoofStyle_Gambrel', 'SaleType_Oth', 'ExterCond_Po', \n     'Exterior1st_BrkFace', 'HeatingQC_Po', 'Condition2_Norm', 'Exterior1st_Stucco', 'GarageType_Basment', \n     'YrSold', 'LandSlope_Sev', 'LandContour_Lvl', 'SaleType_ConLw', 'Exterior1st_ImStucc', \n     'Exterior1st_AsphShn', 'HouseStyle_2.5Unf', 'Heating_OthW', 'LowQualFinSF', 'Exterior2nd_CBlock', \n     'Exterior1st_CBlock', 'BsmtCond_TA', 'Exterior2nd_BrkFace', 'Exterior2nd_AsphShn', \n     'Neighborhood_NWAmes', 'Condition1_RRNn', 'MiscVal', 'RoofStyle_Shed', 'Neighborhood_Blueste', \n     'Heating_GasW', 'RoofMatl_Membran', 'SaleType_CWD', 'LotConfig_FR3', 'Exterior1st_Plywood', \n     'Functional_Sev', 'BsmtHalfBath', 'Exterior2nd_Stone', 'Functional_Mod', 'SaleCondition_Alloca', \n     'Neighborhood_SawyerW', 'Condition2_RRAn', 'RoofMatl_Roll', 'SaleType_ConLI', 'Utilities_NoSeWa', \n     'Foundation_Stone', 'BsmtFinSF2', 'LotConfig_FR2', 'Condition1_RRAn', 'RoofMatl_Tar&Grv', \n     'Condition1_RRNe', 'BldgType_TwnhsE', 'Condition2_RRAe', 'Foundation_Wood', 'GarageCond_Gd', \n     'RoofStyle_Mansard', 'RoofMatl_Metal', 'BsmtFinType2_GLQ']","6d278a35":"To select parameters for training, use feature selection library","5001fac0":"* [Load Data and Libraries](#load)\n* [Check Data](#check-data)\n* [Data Pre-Processing](#pre-processing)\n* [Training and Prediction](#training-prediction)","dd36a96d":"Process categorical variables(int)\n1. Do nothing, because there's no missing data","72c144da":"Check what types of data in each columns","60b32fb6":"# Load Data and Libraries <a id=\"load\"><\/a>","f9884f9d":"Drop variables more than 40% data was missing..","a8416beb":"There's 81 columns in data","803e7f51":"# Check Data <a id=\"check-data\"><\/a>","d3f1d1a6":"Data after processing is like this","f72d643a":"For data pre-processing, categorize variables into 'Numerical Variables', 'Categorical Variables(int)', 'Categorical Variables(string)'  \n  \n**Numerical Variables: **float and int variables  \n['MSSubClass', 'LotFrontage', 'LotArea', 'YearBuilt', 'YearRemodAdd', 'MasVnrArea', 'BsmtFinSF1', 'BsmtFinSF2', 'BsmtUnfSF', 'TotalBsmtSF', '1stFlrSF', '2ndFlrSF', 'LowQualFinSF', 'GrLivArea', 'BsmtFullBath', 'BsmtHalfBath', 'FullBath', 'HalfBath', 'BedroomAbvGr', 'KitchenAbvGr', 'TotRmsAbvGrd', 'Fireplaces', 'GarageYrBlt', 'GarageCars', 'GarageArea', 'WoodDeckSF', 'OpenPorchSF', 'EnclosedPorch', '3SsnPorch', 'ScreenPorch', 'PoolArea', 'MiscVal', 'YrSold']  \n  \n**Categorical Variables(int): **some of int variables  \n['OverallQual', 'OverallCond', 'MoSold']  \n  \n**Categorical Variables(string): **string variables  \n['MSZoning', 'Street', 'Alley', 'LotShape', 'LandContour', 'Utilities', 'LotConfig', 'LandSlope', 'Neighborhood', 'Condition1', 'Condition2', 'BldgType', 'HouseStyle', 'RoofStyle', 'RoofMatl', 'Exterior1st', 'Exterior2nd', 'MasVnrType', 'ExterQual', 'ExterCond', 'Foundation', 'BsmtQual', 'BsmtCond', 'BsmtExposure', 'BsmtFinType1', 'BsmtFinType2', 'Heating', 'HeatingQC', 'CentralAir', 'Electrical', 'KitchenQual', 'Functional', 'FireplaceQu', 'GarageType', 'GarageFinish', 'GarageQual', 'GarageCond', 'PavedDrive', 'PoolQC', 'Fence', 'MiscFeature', 'SaleType', 'SaleCondition']","c8b33a5d":"Here's just use GradientBoostingRegressor for prediction, with GridSearch","f8153ddf":"Check types of each variables","4f897b86":"Check how many data is missing","f25ef88c":"Output prediction result to a file","505b3f5b":"Process categorical variables(string)\n1. Fill missing data by most frequent value\n2. One-Hot Encoding","a3a7ced0":"Process numerical variables\n1. Just fill missing data with average\n2. Standardize values"}}