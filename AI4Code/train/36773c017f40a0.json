{"cell_type":{"0d18ae99":"code","52d123c6":"code","5b16b373":"code","e5f131e4":"code","9116842d":"code","772dc162":"code","f8907cf6":"code","885588e0":"code","12310c17":"code","d3390a7e":"code","0dead093":"code","254da76d":"code","3fd3472c":"code","3aeb9c08":"code","c575c8de":"code","de7f9dcb":"code","84c60dce":"code","6caccd82":"code","839d51c1":"code","6e7ffcc4":"code","9f69f672":"code","567ccd0f":"code","68c509b3":"code","4956b06d":"code","838a48df":"code","fc2b7675":"code","ea438be4":"code","9939833c":"code","6cd0fe8c":"code","b681a976":"markdown","6e9a80a0":"markdown","ab51f5ae":"markdown","387940e8":"markdown","57b5ee47":"markdown","b1c5e948":"markdown","69fd5185":"markdown","5dea7f34":"markdown","8a1bef03":"markdown"},"source":{"0d18ae99":"#gerekli kutuphanelerin eklenmesi\nimport matplotlib\nimport matplotlib.pyplot as plt\nimport pandas as pd\nfrom pandas.plotting import andrews_curves\nimport seaborn as sns\nfrom keras.models import Sequential\nfrom keras.layers import Dense\nfrom keras.layers import LSTM\nmodel_lstm = Sequential()\nmodel_lstm.add(LSTM(15, input_shape=(1,6)))\nmodel_lstm.add(Dense(1))\nmodel_lstm.compile(loss='mean_squared_error', optimizer='adam', metrics=['accuracy'])","52d123c6":"#csv dosyalarini okuma https:\/\/www.kaggle.com\/getting-started\/25930 linkinden yararlanilmistir\nimport os\ndef print_files():\n    for dirname, _, filenames in os.walk('\/kaggle\/input'):\n        for filename in filenames:\n            print(os.path.join(dirname, filename))","5b16b373":"#csv dosyalari\nprint_files()","e5f131e4":"# Ilk olarak okunacak dosyanin yolu belirlenir. Satislarin bulundugu dosyadan verileri okuyarak tahmin etme islemi gerceklestirmeye calisiyorum.\n\nPATH = \"..\/input\/competitive-data-science-predict-future-sales\/sales_train.csv\"\n\nsales_train = pd.read_csv(PATH)\nsales_train.head() #dosyadaki degerlerin gosterilmesi icin eklenmistir","9116842d":"print('Train:', sales_train.shape)","772dc162":"sample_submission = pd.read_csv('..\/input\/competitive-data-science-predict-future-sales\/sample_submission.csv')\nsample_submission.head()","f8907cf6":"test = pd.read_csv('..\/input\/competitive-data-science-predict-future-sales\/test.csv')\ntest.head()","885588e0":"# kategori id de en buyuk degeri buluyorum\n# path e items.csv verilir\nPATH = '..\/input\/competitive-data-science-predict-future-sales\/items.csv'\nitems = pd.read_csv(PATH)\nprint('id(max) : ', items['item_category_id'].max())\n","12310c17":"items.head()","d3390a7e":"sales_train.head()","0dead093":"train_clean = sales_train.drop(labels = ['date', 'item_price'], axis = 1)\ntrain_clean.head()","254da76d":"train_clean = train_clean.groupby([\"item_id\",\"shop_id\",\"date_block_num\"]).sum().reset_index()\ntrain_clean = train_clean.rename(index=str, columns = {\"item_cnt_day\":\"item_cnt_month\"})\ntrain_clean = train_clean[[\"item_id\",\"shop_id\",\"date_block_num\",\"item_cnt_month\"]]\ntrain_clean","3fd3472c":"check = train_clean[[\"shop_id\",\"item_id\",\"date_block_num\",\"item_cnt_month\"]]\ncheck = check.loc[check['shop_id'] == 55]\ncheck = check.loc[check['item_id'] == 1]\ncheck","3aeb9c08":"plt.figure(figsize=(10,4))\nplt.title('Item 1 - Shop 55 Ayl\u0131k Sat\u0131s Gosterimi')\nplt.xlabel('Month')\nplt.ylabel('Item 1 - Shop 55 Satis Miktari')\nplt.plot(check[\"date_block_num\"],check[\"item_cnt_month\"]);","c575c8de":"num_month = sales_train['date_block_num'].max()\n\nmonth_list=[i for i in range(num_month+1)]\nshop = []\nfor i in range(num_month+1):\n    shop.append(55)\n    \nitem = []\nfor i in range(num_month+1):\n    item.append(1)\n    \nmonths_full = pd.DataFrame({'shop_id':shop, 'item_id':item,'date_block_num':month_list})\nmonths_full","de7f9dcb":"sales_33month = pd.merge(check, months_full, how='right', on=['shop_id','item_id','date_block_num'])\nsales_33month = sales_33month.sort_values(by=['date_block_num'])\nsales_33month.fillna(0.00,inplace=True)\nsales_33month","84c60dce":"plt.figure(figsize=(10,4))\nplt.title('Item 1 - Shop 55 Ayl\u0131k T\u00fcm Sat\u0131\u015flar\u0131')\nplt.xlabel('Aylar')\nplt.ylabel('Item 1 - Shop 55 Sat\u0131\u015flar')\nplt.plot(sales_33month[\"date_block_num\"],sales_33month[\"item_cnt_month\"]);","6caccd82":"for i in range(1,4):\n    sales_33month[\"Train\" + str(i)] = sales_33month.item_cnt_month.shift(i)\nsales_33month.fillna(0.0, inplace=True)\nsales_33month","839d51c1":"df = sales_33month[['shop_id','item_id','date_block_num','Train1','Train2','Train3', 'item_cnt_month']].reset_index()\ndf = df.drop(labels = ['index'], axis = 1)\ndf","6e7ffcc4":"train_df = df[:-3]\nval_df = df[-3:]\nx_train,y_train = train_df.drop([\"item_cnt_month\"],axis=1),train_df.item_cnt_month\nx_val,y_val = val_df.drop([\"item_cnt_month\"],axis=1),val_df.item_cnt_month","9f69f672":"x_train","567ccd0f":"y_train","68c509b3":"x_val","4956b06d":"y_val","838a48df":"from sklearn.preprocessing import StandardScaler,MinMaxScaler\nscaler = StandardScaler()\nscaler = MinMaxScaler(feature_range=(-1, 1))\nx_train_scaled = scaler.fit_transform(x_train)\nx_valid_scaled = scaler.fit_transform(x_val)","fc2b7675":"x_train_reshaped = x_train_scaled.reshape((x_train_scaled.shape[0], 1, x_train_scaled.shape[1]))\nx_val_resaped = x_valid_scaled.reshape((x_valid_scaled.shape[0], 1, x_valid_scaled.shape[1]))","ea438be4":"history = model_lstm.fit(x_train_reshaped, y_train, validation_data=(x_val_resaped, y_val),epochs=100, batch_size=12, verbose=2, shuffle=False)\ny_pre = model_lstm.predict(x_val_resaped)","9939833c":"fig, ax = plt.subplots()\nax.plot(x_val['date_block_num'], y_val, label='Actual')\nax.plot(x_val['date_block_num'], y_pre, label='Predicted')\nplt.title('LSTM Prediction vs Actual - 3 Ayl\u0131k Sat\u0131\u015flar')\nplt.xlabel('Ay')\nplt.xticks(x_val['date_block_num'])\nplt.ylabel('Item 1 - Shop 55 Sat\u0131\u015flar\u0131')\nax.legend()\nplt.show()","6cd0fe8c":"from sklearn.metrics import mean_squared_error\nfrom numpy import sqrt\nrmse = sqrt(mean_squared_error(y_val,y_pre))\nprint('Val RMSE: %.3f' % rmse)","b681a976":"E\u011fitim verileri d\u00fczenlendikten sonra \u00f6\u011frenme ba\u015flar","6e9a80a0":"## MAK\u0130NE \u00d6\u011eRENMES\u0130","ab51f5ae":"shop_id = 55 ve item_id = 1 olan urunler","387940e8":"Epoch say\u0131s\u0131 100 olarak belirlenir","57b5ee47":"item_cnt_day yeniden isimlendiriliyor(item_cnt_mounth)","b1c5e948":"Hata belirlenir.","69fd5185":"E\u011fitim verileri i\u00e7in tablo d\u00fczenleniyor ","5dea7f34":"## B\u00fcy\u00fck Veri Analizine Giri\u015f - Final \u00d6devi - K\u0131s\u0131m 2\n### EDANUR TOSUN  160202098 ","8a1bef03":"date ve item_price s\u00fctunlar\u0131 \u00e7\u0131k\u0131r\u0131l\u0131yor"}}