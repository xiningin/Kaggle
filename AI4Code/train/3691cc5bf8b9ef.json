{"cell_type":{"406b9403":"code","5b4a9d3d":"code","cd9f4fac":"code","48fb56e4":"code","8ce94da6":"code","dcc175f3":"code","000d18fc":"code","10222cd6":"code","b0af09a2":"code","876fe336":"code","7e6d911b":"code","c4bad379":"code","e54664cb":"code","f21c8671":"code","b1352b60":"code","9fcac417":"code","f3a89d0d":"code","f579f598":"code","71bec2b8":"markdown","79c72e7f":"markdown","78a377d8":"markdown"},"source":{"406b9403":"import pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","5b4a9d3d":"bill_auth_data = pd.read_csv('..\/input\/bill_authentication\/bill_authentication.csv')\nbill_auth_data.head()","cd9f4fac":"bill_auth_data.Class.value_counts()","48fb56e4":"bill_auth_IMB_data = pd.concat([bill_auth_data[bill_auth_data.Class == 1].sample(frac=0.1),bill_auth_data[bill_auth_data.Class == 0]]) \n# Randomly selecting only 10 percent of 1 class\n# Selecting 100 percent of 0 class","8ce94da6":"bill_auth_IMB_data.Class.value_counts()","dcc175f3":"ax = bill_auth_IMB_data.Class.value_counts().plot.bar()\nfor p in ax.patches:\n  ax.annotate(p.get_height(),(p.get_x()+p.get_width()\/2,p.get_height()+12),va='center',ha='center')\nplt.show()","000d18fc":"sns.scatterplot(x='Variance',y='Skewness',data=bill_auth_IMB_data,hue='Class')\nplt.show()","10222cd6":"sns.scatterplot(x='Curtosis',y='Entropy',data=bill_auth_IMB_data,hue='Class')\nplt.show()","b0af09a2":"bill_auth_IMB_data.iloc[:,0:-1].plot(kind='hist',subplots=True,layout=(2,2),figsize=(15,6));","876fe336":"X = bill_auth_IMB_data.drop('Class',axis=1)\nY = bill_auth_IMB_data.Class","7e6d911b":"from imblearn.over_sampling import SMOTE\nfrom imblearn.under_sampling import RandomUnderSampler","c4bad379":"over = SMOTE(sampling_strategy=0.3) # sampling_strategy = 0.3 means generate 30% data that of majority class","e54664cb":"X_over,Y_over = over.fit_resample(X,Y)","f21c8671":"print(Y_over[Y_over == 0].shape)\nprint(Y_over[Y_over == 1].shape)","b1352b60":"under = RandomUnderSampler(sampling_strategy=0.5) # sampling_strategy = 0.5 means sample 50% more data than that of minority class","9fcac417":"X_train,Y_train = under.fit_resample(X_over,Y_over)","f3a89d0d":"print(Y_train[Y_train == 0].shape)\nprint(Y_train[Y_train == 1].shape)","f579f598":"from sklearn.model_selection import StratifiedKFold,cross_val_score\n\n\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.naive_bayes import GaussianNB\n\nLR_model = LogisticRegression()\nDTC = DecisionTreeClassifier()\nRFC = RandomForestClassifier()\nKNC = KNeighborsClassifier()\nNB = GaussianNB()\n\nskf = StratifiedKFold(n_splits=5,shuffle=True,random_state=10)\n\nprint(f'Logistic Regression Classifier Accuracy is {round((cross_val_score(LR_model,X_train,Y_train,cv=skf,scoring=\"accuracy\").mean())*100,2)}')\nprint(f'Decision Tree Classifier Accuracy is {round((cross_val_score(DTC,X_train,Y_train,cv=skf,scoring=\"accuracy\").mean())*100,2)}')\nprint(f'Random Forest Classifier Accuracy is {round((cross_val_score(RFC,X_train,Y_train,cv=skf,scoring=\"accuracy\").mean())*100,2)}')\nprint(f'KNeighbors Classifier Accuracy is {round((cross_val_score(KNC,X_train,Y_train,cv=skf,scoring=\"accuracy\").mean())*100,2)}')\nprint(f'Naive Bayes Classifier Accuracy is {round((cross_val_score(NB,X_train,Y_train,cv=skf,scoring=\"accuracy\").mean())*100,2)}')","71bec2b8":"Above data is balanced, but we will make it imbalanced by deleting some data from either classs","79c72e7f":"Our data is imbalanced as the proportion of minority class '1' is less then 10 % of majority class '0'<br>\n\nIf this data is passed to any ML algo, we may get incosistent results.","78a377d8":"# SMOTE and Random Under Sampler\n\n<img src='https:\/\/drive.google.com\/uc?export=view&id=12n6SUysZocQDVPd2HTWgIprmJKdFZ7Un' >\n\nIn this notebook we will be learning about,\n\n\n1.   **SMOTE** :- This class is used to make copies of minority class\n2.   **RandomUnderSampler** :- This class is used to make samples of majority class\n\n\n\n"}}