{"cell_type":{"67b8de9e":"code","6faa2f52":"code","d5ceaacc":"code","ab37b118":"code","8f351f5b":"code","9a1c2a08":"code","ead20357":"code","158d1d3b":"code","aaf47513":"code","8076f545":"code","f4fdf446":"code","8fb17f56":"code","15144a09":"code","ba0eaef7":"code","35a35281":"code","6fe5826c":"code","344f1261":"code","8816c1ae":"code","b8ae968c":"code","90cf0d4a":"code","5f38c406":"code","08b5904a":"code","bdecae56":"code","a92dd199":"code","db9b74d6":"code","77395077":"code","34a43f95":"code","438b28cf":"code","2dbbfabb":"code","4dd01d1b":"code","3d741dd6":"code","f2f3151f":"code","6272500a":"code","d3fc03ab":"code","2b159491":"code","461fc1de":"code","11695da7":"code","ccd20c1d":"code","a4fee3ec":"code","37cf4b0f":"code","8b2dd203":"code","f26f1108":"code","3b4837c4":"code","0f27a168":"code","f1ae6d69":"code","a2e4a87f":"code","dcd837b5":"code","f0f5d9ed":"code","2908cb81":"code","cacdc403":"code","d7140e4c":"code","1fabde1e":"code","fcee381e":"code","bc017d69":"code","86dfa545":"code","a17c53a3":"code","128c73ce":"markdown","4a0b8a00":"markdown","c0c76fe7":"markdown","807d09e8":"markdown","fcabe48b":"markdown","5f07a0a4":"markdown","1bbeb224":"markdown","bd105b3d":"markdown","78db0752":"markdown","4f89f0ef":"markdown","7cb7aba9":"markdown","846f48a0":"markdown","81c720a1":"markdown","c28edbc9":"markdown","3e864aa1":"markdown","3e66b470":"markdown","2ae1a11e":"markdown","70092616":"markdown","e7ac0543":"markdown","1bdef1ab":"markdown","b0ba7664":"markdown","d974cbb4":"markdown","ffecc382":"markdown","7d75f154":"markdown","ad3075a6":"markdown","757ecff9":"markdown","defc5d59":"markdown","367f4c05":"markdown"},"source":{"67b8de9e":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns","6faa2f52":"df = pd.read_csv('..\/input\/housesalesprediction\/kc_house_data.csv')","d5ceaacc":"df.isnull().sum()","ab37b118":"df.describe().transpose()","8f351f5b":"plt.figure(figsize=(12,8))\nsns.distplot(df['price'])","9a1c2a08":"sns.countplot(df['bedrooms'])","ead20357":"plt.figure(figsize=(12,8))\nsns.scatterplot(x='price',y='sqft_living',data=df)","158d1d3b":"plt.figure(figsize=(12,8))\nsns.scatterplot(x='bedrooms',y='price',data=df)","aaf47513":"sns.boxplot(x='bedrooms',y='price',data=df)","8076f545":"plt.figure(figsize=(12,8))\nsns.scatterplot(x='long',y='lat',data=df,hue='price')","f4fdf446":"df.sort_values('price',ascending=False).head(20)","8fb17f56":"len(df)*(0.01)","15144a09":"non_top_1_perc = df.sort_values('price',ascending=False).iloc[300:]","ba0eaef7":"plt.figure(figsize=(12,8))\nsns.scatterplot(x='long',y='lat',\n                data=non_top_1_perc,hue='price',\n                palette='RdYlGn',edgecolor=None,alpha=0.2)","35a35281":"sns.boxplot(x='waterfront',y='price',data=df)","6fe5826c":"df.head(5)","344f1261":"df.info()","8816c1ae":"df = df.drop('id',axis=1)","b8ae968c":"df.head(5)","90cf0d4a":"df['date'] = pd.to_datetime(df['date'])","5f38c406":"df.head(5)","08b5904a":"df['year'] = df['date'].apply(lambda date:date.year)\ndf['month'] = df['date'].apply(lambda date:date.month)","bdecae56":"sns.boxplot(x='year',y='price',data=df)","a92dd199":"sns.boxplot(x='month',y='price',data=df)","db9b74d6":"df.groupby('month').mean()['price'].plot()","77395077":"df.groupby('year').mean()['price'].plot()","34a43f95":"df = df.drop('date',axis=1)","438b28cf":"df.columns","2dbbfabb":"df = df.drop('zipcode',axis=1)","4dd01d1b":"df.head()","3d741dd6":"X = df.drop('price',axis=1)\ny = df['price']","f2f3151f":"from sklearn.model_selection import train_test_split","6272500a":"X_train, X_test, y_train, y_test = train_test_split(X,y,test_size=0.4,random_state=101)","d3fc03ab":"from sklearn.preprocessing import MinMaxScaler","2b159491":"scaler = MinMaxScaler()","461fc1de":"X_train= scaler.fit_transform(X_train)","11695da7":"X_test = scaler.transform(X_test)","ccd20c1d":"X_train.shape","a4fee3ec":"X_test.shape","37cf4b0f":"from tensorflow.keras.models import Sequential\nfrom tensorflow.keras.layers import Dense, Activation\nfrom tensorflow.keras.optimizers import Adam","8b2dd203":"model = Sequential()\n\nmodel.add(Dense(19,activation='relu'))\nmodel.add(Dense(19,activation='relu'))\nmodel.add(Dense(19,activation='relu'))\nmodel.add(Dense(19,activation='relu'))\nmodel.add(Dense(19,activation='relu'))\nmodel.add(Dense(1))\n\nmodel.compile(optimizer='adam',loss='mse')","f26f1108":"model.fit(x=X_train,y=y_train.values,\n          validation_data=(X_test,y_test.values),\n          batch_size=128,epochs=500)","3b4837c4":"losses = pd.DataFrame(model.history.history)","0f27a168":"losses.plot()","f1ae6d69":"from sklearn.metrics import mean_squared_error,mean_absolute_error,explained_variance_score","a2e4a87f":"X_test","dcd837b5":"predictions = model.predict(X_test)","f0f5d9ed":"mean_absolute_error(y_test,predictions)","2908cb81":"np.sqrt(mean_squared_error(y_test,predictions))","cacdc403":"explained_variance_score(y_test,predictions)","d7140e4c":"# Our predictions\nplt.scatter(y_test,predictions)\n\n# Perfect predictions\nplt.plot(y_test,y_test,'r')","1fabde1e":"df.head(3)","fcee381e":"single_house = df.drop('price',axis=1).iloc[0]","bc017d69":"single_house = scaler.transform(single_house.values.reshape(-1, 19))","86dfa545":"single_house","a17c53a3":"model.predict(single_house)","128c73ce":"2014 and 2015 data. ","4a0b8a00":"Most of the houses has 2-6 bedrooms. ","c0c76fe7":"#### Predicting on Brand New Data","807d09e8":"### Scaling","fcabe48b":"# Exploratory Data Analysis\n","5f07a0a4":"As expected with increasing living square feet, Price increases.","1bbeb224":"we can delete id column, and date column is not in datetime formate.","bd105b3d":"our model predict the price 271008.16. So our model predict well but not significantly good enough.","78db0752":"### Python Environment Setup","4f89f0ef":"## The Data\n\nWe will be using data from a Kaggle data set:\n\nhttps:\/\/www.kaggle.com\/harlfoxem\/housesalesprediction\n\n#### Feature Columns\n    \n* id - Unique ID for each home sold\n* date - Date of the home sale\n* price - Price of each home sold\n* bedrooms - Number of bedrooms\n* bathrooms - Number of bathrooms, where .5 accounts for a room with a toilet but no shower\n* sqft_living - Square footage of the apartments interior living space\n* sqft_lot - Square footage of the land space\n* floors - Number of floors\n* waterfront - A dummy variable for whether the apartment was overlooking the waterfront or not\n* view - An index from 0 to 4 of how good the view of the property was\n* condition - An index from 1 to 5 on the condition of the apartment,\n* grade - An index from 1 to 13, where 1-3 falls short of building construction and design, 7 has an average level of construction and design, and 11-13 have a high quality level of construction and design.\n* sqft_above - The square footage of the interior housing space that is above ground level\n* sqft_basement - The square footage of the interior housing space that is below ground level\n* yr_built - The year the house was initially built\n* yr_renovated - The year of the house\u2019s last renovation\n* zipcode - What zipcode area the house is in\n* lat - Lattitude\n* long - Longitude\n* sqft_living15 - The square footage of interior housing living space for the nearest 15 neighbors\n* sqft_lot15 - The square footage of the land lots of the nearest 15 neighbors","7cb7aba9":"# USA Kings Country House Price Prediction Model - Using Neural Network","846f48a0":"## Working with Feature Data","81c720a1":"## Scaling and Train Test Split\n","c28edbc9":"Clearly shows the area with high price housings.","3e864aa1":"So, the waterfront houses are relatively more expensive.","3e66b470":"## Using Keras Regression Code\n\nHere we will also focus on feature engineering and cleaning our data","2ae1a11e":"So, we can come to a conclusion that our model can predict the price of a house within a range of 5million USD. When the price exceed the range it performs not so well.","70092616":"#### Import DATA","e7ac0543":"# Creating a Model","1bdef1ab":"and obviously with the years price increases. it may have lot of reasons, also inflation is one of them.","b0ba7664":"### Predicting on a brand new house","d974cbb4":"March to July months has more iprice hike in housing.","ffecc382":"### Other Features","7d75f154":"Lets predict the price for the first house of our dataset using our model, which is 221900.0. Lets see how our model predict the price.","ad3075a6":"Corelation between number of bedrooms and price is not clear. ","757ecff9":"### Geographical Properties","defc5d59":"# Evaluation on Test Data\n\nhttps:\/\/scikit-learn.org\/stable\/modules\/model_evaluation.html#regression-metrics","367f4c05":"## Training the Model"}}