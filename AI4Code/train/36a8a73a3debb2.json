{"cell_type":{"4ddb72c3":"code","f8859648":"code","44f8ad6e":"code","a7776dcf":"code","3d25ec90":"code","9ea4a9ab":"code","2edb2c2b":"code","d337f8fd":"code","8db1637a":"code","3a3e9410":"code","f0923044":"code","00d0c7a4":"code","88fba869":"code","0d184ef4":"code","80b94f8e":"code","f547d755":"code","e57dac65":"code","ebe24a6c":"code","06bb2b49":"markdown","46c07efb":"markdown","592ea9ad":"markdown","3ec8fcbb":"markdown","41e82bb3":"markdown","47499471":"markdown","f23923a1":"markdown","be72e612":"markdown","f0a2607e":"markdown","256ce9cc":"markdown","bc12451b":"markdown","b79933e6":"markdown"},"source":{"4ddb72c3":"from IPython.display import Image\nImage(filename=\"..\/input\/image-association\/Association.png\")","f8859648":"import pandas as pd\nimport numpy as np\n\nfrom mlxtend.preprocessing import onehot\nfrom mlxtend.frequent_patterns import apriori, association_rules\n\nimport plotly.express as px\nimport matplotlib.pyplot as plt","44f8ad6e":"grocery_txn = pd.read_csv(\"..\/input\/groceries-dataset-for-market-basket-analysis\/groceries.csv\", header=None)\n\ngrocery_txn.head()","a7776dcf":"new_df = grocery_txn.stack().reset_index(name='value')\nnew_df.head()","3d25ec90":"one_hot_txns_df = pd.crosstab(new_df['level_0'], new_df['value'])","9ea4a9ab":"one_hot_txns_df.iloc[5:10, 5:15]","2edb2c2b":"one_hot_txns_df.shape","d337f8fd":"frequent_itemsets = apriori(one_hot_txns_df,\n                            min_support=0.02,\n                            use_colnames=True,\n                           verbose=1)","8db1637a":"frequent_itemsets.head()","3a3e9410":"frequent_itemsets.sort_values(by=\"support\")","f0923044":"# By descending order of support metric\nfrequent_itemsets.sort_values(by=\"support\", ascending=False)","00d0c7a4":"frequent_itemsets.sample(10, random_state = 90)","88fba869":"rules = association_rules(frequent_itemsets, # itemsets\n                            metric=\"lift\", # lift\n                            min_threshold=1)","0d184ef4":"rules.sample(10)","80b94f8e":"rules = association_rules(frequent_itemsets,\n                         metric = 'confidence',\n                         min_threshold = 0.01)\nrules.head()","f547d755":"fig=px.scatter(rules['support'], rules['confidence'])\nfig.update_layout(\n    xaxis_title=\"support\",\n    yaxis_title=\"confidence\",  \n    font_family=\"Arial\",\n    font_color=\"blue\",\n    title_font_family=\"Arial\",\n    title_font_color=\"red\",\n    title=('Support vs Confidence')\n    \n)\n\nfig.show()","e57dac65":"fig=px.scatter(rules['support'], rules['lift'])\nfig.update_layout(\n    xaxis_title=\"support\",\n    yaxis_title=\"lift\",\n    font_family=\"Arial\",\n    font_color=\"blue\",\n    title_font_family=\"Arial\",\n    title_font_color=\"red\",\n    title=('Support vs Lift')\n    \n)\n\nfig.show()","ebe24a6c":"fit = np.polyfit(rules['lift'], rules['confidence'], 1)\nfit_fn = np.poly1d(fit)\nplt.plot(rules['lift'], rules['confidence'], 'yo', rules['lift'], \nfit_fn(rules['lift']))\nplt.xlabel('lift')\nplt.ylabel('Confidence')\nplt.title('Lift vs Confidence')\nplt.show()","06bb2b49":"# 5. Generate Association Rules from frequent itemsets","46c07efb":"### Stack the dataframe to get all unique itemsets","592ea9ad":"# Applying Association Rules\n\nObjective : To identify purchase pattern of customers and how Association technique can be used to help solve this. \n\nWe are taking an example of market basket analysis and have considered groceries dataset for our analysis.","3ec8fcbb":"# 3. Encoding the transactions\n\n### Transform the data into one-hot-encoding format","41e82bb3":"# 1. Import all required libraries","47499471":"Please feel free to share feedback \/ suggestions in comments section.","f23923a1":"The result of above association analysis indicates which items are purchased with which other items frequently.","be72e612":"# 2. Read the data and organize it","f0a2607e":"# 6.2 Support vs Lift chart","256ce9cc":"# 4. Frequent Itemsets\n\n### Get frequent itemsets","bc12451b":"# 6.3 Lift vs Confidence chart","b79933e6":"# 6. Charts\n\nWe can look at scatter charts between some of these metrics to see observation between them.\n\n# 6.1 Support vs Confidence chart"}}