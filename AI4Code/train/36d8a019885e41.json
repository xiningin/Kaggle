{"cell_type":{"8b3c9600":"code","d87c5365":"code","2188b9b5":"code","30ad93b6":"code","0ab3da8b":"code","6502335f":"code","168d5990":"code","5703fac5":"code","4df156c6":"code","b72d3db3":"code","4572ac62":"code","d3720040":"code","b41dabd5":"code","f3e1b913":"code","8bde21d1":"code","d96e0478":"code","c88ac1a8":"code","3e737d4d":"code","90cf5513":"code","66620796":"code","b81c412c":"code","d1f1a52a":"code","d828e7bc":"code","c6b49d48":"code","deac1b39":"code","fd3a105b":"code","52b196bb":"markdown","c1282ae1":"markdown","8412a421":"markdown","97ffef56":"markdown","bce0816b":"markdown","1d285be3":"markdown","b86597e1":"markdown","7059888c":"markdown"},"source":{"8b3c9600":"import io\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport plotly.express as px\nfrom urllib.request import urlopen\nfrom bs4 import BeautifulSoup as bs","d87c5365":"shots=pd.read_csv('..\/input\/mohamed-salah-shots-understat\/shots.csv')","2188b9b5":"shots.info()","30ad93b6":"shots=shots.apply(pd.to_numeric,errors=\"ignore\")","0ab3da8b":"shots=shots.loc[(shots[\"season\"]>=2020)]","6502335f":"shots","168d5990":"# Import plotting libraries\nimport seaborn as sns\nimport plotly.express as px\nimport matplotlib.pyplot as plt\nimport plotly.graph_objects as go\nfrom matplotlib.patches import Arc\nfrom plotly.subplots import make_subplots","5703fac5":"px.scatter(data_frame=shots, x=\"player_assisted\", title=\"Mohamed Salah assisters\", color=\"result\")","4df156c6":"px.histogram(data_frame=shots, x=\"player_assisted\", color=\"result\", title=\"ASSISTING PLAYERS\")","b72d3db3":"shots.columns","4572ac62":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nsns.set_palette('husl')\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport plotly.express as px\n\nfrom sklearn import metrics\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.model_selection import train_test_split","d3720040":"shots2= shots.loc[:,['minute', 'result', 'X', 'Y', 'xG', 'situation', 'shotType',\n       'h_goals', 'a_goals', 'lastAction'],]","b41dabd5":"  sns.pairplot(shots2, hue=\"result\", palette=\"Set1\")\n","f3e1b913":"import json\nimport matplotlib.pyplot as plt\nfrom matplotlib.patches import Arc","8bde21d1":"x=[0,1.15]\ny=[0,0.74]\nx_mid=x[1]\/2\ny_mid=y[1]\/2\nbackground_color = \"black\"\nline_color = \"white\"\nline_width = 2\ndef pitch(x, y, background_color=\"black\", line_color=\"white\", line_width=2.):\n  fig=plt.figure(facecolor=background_color, figsize=(12, 7))\n  ax=fig.add_subplot(111, facecolor=background_color)\n  plt.plot([x[0],x[0]],[y[0],y[1]], color=line_color, linewidth=2)\n  plt.plot([x[1],x[1]],[y[0],y[1]], color=line_color, linewidth=2)\n  plt.plot([x[0],x[1]],[y[1],y[1]], color=line_color, linewidth=2)\n  plt.plot([x[0],x[1]],[y[0],y[0]], color=line_color, linewidth=2)\n  plt.plot([x_mid,x_mid],[y[0],y[1]], color=line_color, linewidth=2)\n  ## Left Penalty box\n  plt.plot([x[0],x[0]+0.18],[y_mid+0.22,y_mid+0.22], color=line_color, linewidth=2)\n  plt.plot([x[0],x[0]+0.18],[y_mid-0.22,y_mid-0.22], color=line_color, linewidth=2)\n  plt.plot([x[0]+0.18,x[0]+0.18],[y_mid-0.22,y_mid+0.22], color=line_color, linewidth=2)\n  ## Right Penalty box\n  plt.plot([x[1],x[1]-0.18],[y_mid+0.22,y_mid+0.22], color=line_color, linewidth=2)\n  plt.plot([x[1],x[1]-0.18],[y_mid-0.22,y_mid-0.22], color=line_color, linewidth=2)\n  plt.plot([x[1]-0.18,x[1]-0.18],[y_mid-.22,y_mid+.22], color=line_color, linewidth=2)\n  ## left 6 yard box\n  plt.plot([x[0],x[0]+0.06],[y_mid+0.06,y_mid+0.06], color=line_color, linewidth=2)\n  plt.plot([x[0],x[0]+0.06],[y_mid-0.06,y_mid-0.06], color=line_color, linewidth=2)\n  plt.plot([x[0]+0.06,x[0]+0.06],[y_mid-0.06,y_mid+0.06], color=line_color, linewidth=2)\n  ## right 6 yard box\n  plt.plot([x[1],x[1]-0.06],[y_mid+0.06,y_mid+0.06], color=line_color, linewidth=2)\n  plt.plot([x[1],x[1]-0.06],[y_mid-0.06,y_mid-0.06], color=line_color, linewidth=2)\n  plt.plot([x[1]-0.06,x[1]-0.06],[y_mid-0.06,y_mid+0.06], color=line_color, linewidth=2)\n  ##centre cirle and penanlty spot\n  centre_circle=plt.Circle((x_mid,y_mid),0.1, color=line_color, fill=False, linewidth=2)\n  centre_spot=plt.Circle((x_mid,y_mid),0.005,color=line_color,fill=True, linewidth=2)\n  leftspot=plt.Circle((x[0]+0.12,y_mid),0.005,color=line_color,fill=True, linewidth=2)\n  rightspot=plt.Circle((x[1]-0.12,y_mid),0.005,color=line_color,fill=True, linewidth=2)\n  ax.add_patch(centre_circle)\n  ax.add_patch(centre_spot)\n  ax.add_patch(leftspot)\n  ax.add_patch(rightspot)\n  ## arcs\n  left=Arc((x[0]+0.12,y_mid), width=0.22, height=0.18, angle=0.0, theta1=310, theta2=50, color=line_color, linewidth=2)\n  right=Arc((x[1]-0.12,y_mid), width=0.22, height=0.18, angle=0.0, theta1=130, theta2=230, color=line_color, linewidth=2)\n  ax.add_patch(left)\n  ax.add_patch(right)\n  ## corner arcs\n  l1=Arc((x[0],y[0]), width=0.07, height=0.12, angle=0.0, theta1=0, theta2=90, color=line_color, linewidth=2)\n  l2=Arc((x[0],y[1]), width=0.07, height=0.12, angle=0.0, theta1=270, theta2=360, color=line_color, linewidth=2)\n  r1=Arc((x[1],y[0]), width=0.07, height=0.12, angle=0.0, theta1=90, theta2=180, color=line_color, linewidth=2)\n  r2=Arc((x[1],y[1]), width=0.07, height=0.12, angle=0.0, theta1=180, theta2=270, color=line_color, linewidth=2)\n  ax.add_patch(l1)\n  ax.add_patch(l2)\n  ax.add_patch(r1)\n  ax.add_patch(r2)\n  plt.axis(\"off\")\n  return ax\n\n","d96e0478":"shots[\"X\"] = shots[\"X\"].multiply(x[1])\nshots[\"Y\"] = shots[\"Y\"].multiply(y[1])\n\n\n\n","c88ac1a8":"ax1 = pitch(x, y)\n\nsns.scatterplot(x='X', y='Y', data=shots[shots[\"player\"] == \"Mohamed Salah\"], size=\"xG\", ax=ax1, hue=\"result\", palette=\"Set2\")\n\n","3e737d4d":"ax3 = pitch(x, y)\n\nsns.kdeplot(x='X', y='Y', data=shots[shots[\"player\"] == \"Mohamed Salah\"], shade= True, nlevels=10 , ax=ax3, pallete=(sns.color_palette(\"OrRd_r\")), title=\"Kevin De Bruyne\" )\n","90cf5513":"shots2.columns","66620796":"final=shots2.loc[:,['minute', 'result', 'X', 'Y', 'xG', 'h_goals', 'a_goals'],]","b81c412c":"X = final.drop(['result'], axis=1)\ny = final['result']\nprint(X.shape)\nprint(y.shape)\n","d1f1a52a":"X_train, X_test, y_train, y_test= train_test_split(X, y, test_size=0.4, random_state=5)","d828e7bc":"k_range = list(range(1,35))\nscores = []\nfor k in k_range:\n    knn = KNeighborsClassifier(n_neighbors=k)\n    knn.fit(X_train, y_train)\n    y_pred = knn.predict(X_test)\n    scores.append(metrics.accuracy_score(y_test, y_pred))\n    \nplt.plot(k_range, scores)\nplt.xlabel('Value of k for KNN')\nplt.ylabel('Accuracy Score')\nplt.title('Accuracy Scores for Values of k of k-Nearest-Neighbors')\nplt.show()","c6b49d48":"model= LogisticRegression()\nmodel.fit(X_train, y_train)\ny_pred = model.predict(X_test)\nprint(metrics.accuracy_score(y_test, y_pred))","deac1b39":"##testing for knn=4\nknn = KNeighborsClassifier(n_neighbors=12)\nknn.fit(X,y)\n","fd3a105b":"knn.predict([[66, 0.885,\t0.5,\t0.7611688375473022, 1, 0]])","52b196bb":"PREDICTING THE RESULT OF SHOTS BY MOHAMED SALAH","c1282ae1":"# Importing DATA from understat","8412a421":"Removing penalties\n","97ffef56":"# Visualization\n","bce0816b":"# Shot Position Visualisation","1d285be3":"a=\"https:\/\/understat.com\/player\/1250\"\npage=urlopen(a)\nurl=bs(page,\"html.parser\")\nobj=url.findAll(\"script\")[3].text\nobj\nstart=obj.index(\"\\\\\")\nstop=obj.index(\"')\")\nobj=obj[start:stop]\nobj\nobj=obj.encode(\"utf8\").decode(\"unicode_escape\")\nimport json\np=json.loads(obj)\nshots=pd.json_normalize(p) \nprint(shots)\n","b86597e1":"# MODEL\n","7059888c":"shots.to_csv('shots.csv')\nfiles.download('shots.csv')"}}