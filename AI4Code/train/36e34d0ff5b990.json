{"cell_type":{"37df0605":"code","85ff248e":"code","473060ae":"code","d4046b8b":"code","2255d28d":"code","250d6621":"code","be2badf2":"code","abdb02b1":"code","0d6137c8":"code","665a39b4":"code","95e0aa91":"code","b6a268eb":"code","309ad5a9":"code","093a4001":"code","a67bbc6e":"code","733f9a3c":"code","6e6b1c52":"code","248b1693":"code","9b07f8a6":"code","cee02d29":"code","fbb4d6bd":"code","3fc7407e":"code","a110bd1d":"code","8871d6a8":"code","a05035ce":"code","02395621":"code","6312552f":"code","756999f9":"code","61dfe16d":"code","2742977e":"code","2b6cf50e":"code","dfc67812":"markdown","adadc797":"markdown","312dd4ff":"markdown","40d74e61":"markdown","00d8b2e1":"markdown","ca0c0291":"markdown","a3c99a52":"markdown","1e4b7637":"markdown","9a386b25":"markdown","462fabd1":"markdown","2655dd35":"markdown","960299f3":"markdown","97dbed3c":"markdown","fa838a8f":"markdown","c1164bb8":"markdown","af86e69a":"markdown","351ea0fd":"markdown","7309b940":"markdown","28cafb3c":"markdown","8ef06398":"markdown","ade4cab5":"markdown","335e76bb":"markdown","3df3a95a":"markdown","507e8dc4":"markdown","f7b2fbc9":"markdown"},"source":{"37df0605":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","85ff248e":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\nimport plotly.express as px\nfrom sklearn.model_selection import StratifiedKFold, train_test_split, GridSearchCV, cross_val_score\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.metrics import accuracy_score, confusion_matrix\nfrom sklearn.preprocessing import StandardScaler, LabelEncoder\nfrom lightgbm import LGBMClassifier\nfrom catboost import CatBoostClassifier\nimport warnings\nwarnings.filterwarnings(\"ignore\", category=FutureWarning)\npd.set_option('display.max_columns', None)","473060ae":"train = pd.read_csv('..\/input\/tabular-playground-series-may-2021\/train.csv')\ntrain.head()","d4046b8b":"test = pd.read_csv('..\/input\/tabular-playground-series-may-2021\/test.csv')\ntest.head()","2255d28d":"sample_submission = pd.read_csv('..\/input\/tabular-playground-series-may-2021\/sample_submission.csv')\nsample_submission.head()","250d6621":"train.isnull().sum()","be2badf2":"test.isnull().sum()","abdb02b1":"train.info()","0d6137c8":"train.shape","665a39b4":"test.shape","95e0aa91":"train.drop('id', axis=1, inplace = True)","b6a268eb":"test.drop('id', axis=1, inplace = True)","309ad5a9":"for i in train.columns:\n    train[i].astype('object')","093a4001":"for i in test.columns:\n    test[i].astype('object')","a67bbc6e":"for i in train.columns:\n    print(train[i].value_counts())","733f9a3c":"for i in train.columns:\n    sns.countplot(train[i])\n    plt.show()","6e6b1c52":"X = train.iloc[:,0:50]\ny = train.iloc[:,50:]\n\ny = np.ravel(y)","248b1693":"label = LabelEncoder()\ny = label.fit_transform(y)","9b07f8a6":"X_train, X_test, y_train, y_test = train_test_split(X,y, test_size=0.2, random_state = 42)","cee02d29":"skfold = StratifiedKFold(n_splits=5)","fbb4d6bd":"pipe = Pipeline([\n    #('scale',StandardScaler()),\n    ('cat',CatBoostClassifier(classes_count=4))\n])","3fc7407e":"cross_score = cross_val_score(pipe,X_train,y_train,cv=skfold)\nprint(np.mean(cross_score))","a110bd1d":"# parameters = {   'cat__depth'         : [4,5,6,7,8,9, 10],\n#                  'cat__learning_rate' : [0.01,0.02,0.03,0.04],\n#                  'cat__iterations'    : [10, 20,30,40,50,60,70,80,90,100]\n#                  }","8871d6a8":"# cat_search = GridSearchCV(pipe, parameters)","a05035ce":"# cat_search.fit(X_train,y_train)","02395621":"pipe.fit(X_train,y_train)","6312552f":"predictions = pipe.predict(X_test)\nprint(predictions)","756999f9":"probability_predictions = pipe.predict_proba(X_test)\nprobability_predictions","61dfe16d":"probability_predictions = pipe.predict_proba(test)\nprobability_predictions","2742977e":"sample_submission.iloc[:,1:5] = probability_predictions\nsample_submission","2b6cf50e":"sample_submission.to_csv('submission_cat.csv',index=False)","dfc67812":"# \ud83d\ude80 Hyperparamaters Tuning","adadc797":"## \ud83d\udef0\ufe0f Label Encoding target variable","312dd4ff":"# \ud83d\ude80 Building Model Pipeline","40d74e61":"## \ud83d\udef0\ufe0f Checking for null values in test dataset","00d8b2e1":"## \ud83d\udef0\ufe0f Drop 'id' column from test datase","ca0c0291":"## \ud83d\udef0\ufe0f Check the data distribution","a3c99a52":"## \ud83d\udef0\ufe0f Loading test datase","1e4b7637":"## \ud83d\udef0\ufe0f Check data information","9a386b25":"## \ud83d\udef0\ufe0f Drop 'id' column from train dataset","462fabd1":"## \ud83d\udef0\ufe0f Separating dependent and independent variables","2655dd35":"## \ud83d\udef0\ufe0f Splitting the data into training and validation","960299f3":"## \ud83d\udef0\ufe0f Predicting probabilities for all classes for Catboost algorithm","97dbed3c":"# \ud83d\ude80 Importing Libraries","fa838a8f":"## \ud83d\udef0\ufe0f Check train data shape","c1164bb8":"# \ud83d\ude80 Exploratory Data Analysis (EDA)","af86e69a":"## \ud83d\udef0\ufe0f Loading sample submission dataset","351ea0fd":"## \ud83d\udef0\ufe0f Checking for null values in train dataset","7309b940":"## \ud83d\udef0\ufe0f Loading test dataset","28cafb3c":"## \ud83d\udef0\ufe0f Check test data shape","8ef06398":"## \ud83d\udef0\ufe0f Convert all feature type from int to object for test dataset","ade4cab5":"## \ud83d\udef0\ufe0f Predicting probabilities on test dataset using Catboost algorithm","335e76bb":"## \ud83d\udef0\ufe0f Verify the values under each feature","3df3a95a":"# \ud83d\ude80 Data Preprocessing","507e8dc4":"## \ud83d\udef0\ufe0f Convert all feature type from int to object for train dataset","f7b2fbc9":"# \ud83d\ude80 Loading Train and Test dataset"}}