{"cell_type":{"5f238381":"code","2ede256d":"code","fb8ee169":"code","7549be8d":"code","24e605cd":"markdown","48ab76b7":"markdown","b9633bcc":"markdown","0d2e3589":"markdown","ff8ace35":"markdown"},"source":{"5f238381":"import numpy as np\nimport matplotlib.pyplot as plt\nimport pandas as pd","2ede256d":"dataset = pd.read_csv('..\/input\/ads-ctr\/Ads_CTR_Optimisation.csv')","fb8ee169":"import math\nN = 10000\nd = 10\nads_selected = []\nnumbers_of_selections = [0] * d\nsums_of_rewards = [0] * d\ntotal_reward = 0\nfor n in range(0, N):\n    ad = 0\n    max_upper_bound = 0\n    for i in range(0, d):\n        if (numbers_of_selections[i] > 0):\n            average_reward = sums_of_rewards[i] \/ numbers_of_selections[i]\n            delta_i = math.sqrt(3\/2 * math.log(n + 1) \/ numbers_of_selections[i])\n            upper_bound = average_reward + delta_i\n        else:\n            upper_bound = 1e400\n        if upper_bound > max_upper_bound:\n            max_upper_bound = upper_bound\n            ad = i\n    ads_selected.append(ad)\n    numbers_of_selections[ad] = numbers_of_selections[ad] + 1\n    reward = dataset.values[n, ad]\n    sums_of_rewards[ad] = sums_of_rewards[ad] + reward\n    total_reward = total_reward + reward","7549be8d":"plt.hist(ads_selected)\nplt.title('Histogram of ads selections')\nplt.xlabel('Ads')\nplt.ylabel('Number of times each ad was selected')\nplt.show()","24e605cd":"## Importing the dataset","48ab76b7":"## Implementing UCB","b9633bcc":"## Visualising the results","0d2e3589":"# Upper Confidence Bound (UCB)","ff8ace35":"## Importing the libraries"}}