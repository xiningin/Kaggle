{"cell_type":{"99b30dd1":"code","bf450437":"code","cfad3b17":"code","d6870ef5":"code","8bf503ce":"code","7d5f74fa":"code","a3895736":"code","338660a7":"code","d8fde29a":"code","b378c5d2":"code","157404e8":"code","beb0c8f9":"code","e820651c":"code","30076182":"code","15733c2c":"code","e8b5528d":"markdown","03041a5e":"markdown","f2f9ddfb":"markdown","bfc12b8a":"markdown","4d6d2712":"markdown","85636c5b":"markdown","63ba595d":"markdown","1e457800":"markdown","57460072":"markdown","836537e1":"markdown","067bf47c":"markdown","440e79a3":"markdown","6526343e":"markdown","2f4de7f0":"markdown","8a7238d8":"markdown"},"source":{"99b30dd1":"#to analyze data\nimport pandas as pd\nimport numpy as np\nfrom matplotlib import pyplot as plt\nfrom matplotlib.patches import Circle, Rectangle, Arc\nfrom matplotlib.colors import Normalize\nimport seaborn as sns\nimport plotly.express as px\nimport plotly.graph_objects as go\nimport plotly.offline as offline\nfrom IPython.display import Image\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","bf450437":"kobe_shotlog = pd.read_csv(\"..\/input\/kobe-bryants-shotlog\/Kobe_Shotlog.csv\")\nkobe_shotlog.drop(['GRID_TYPE', 'GAME_EVENT_ID', 'PLAYER_ID', 'TEAM_ID', 'MINUTES_REMAINING','SECONDS_REMAINING', 'SHOT_ATTEMPTED_FLAG', 'GAME_DATE', 'HTM', 'VTM'], axis=1, inplace=True)\nkobe_shotlog","cfad3b17":"#Analyze type shots Kobe takes through his career\nshot_type = kobe_shotlog.groupby('Season')['SHOT_TYPE'].value_counts().to_frame()\nshot_type.rename(columns={'SHOT_TYPE':'Counts'}, inplace=True)\nshot_type.reset_index(inplace=True)\n\n#Get all seasons Kobe played\nseasons = shot_type.Season.value_counts().index.sort_values()\n#Calculate the percentage of each shot type in Kobe's career\nshot_type ['Percentage'] = np.nan\nfor season in seasons:\n    two_point = shot_type.loc[(shot_type['Season']==season) & (shot_type['SHOT_TYPE']=='2PT Field Goal')].Counts.to_numpy()[0]\n    three_point = shot_type.loc[(shot_type['Season']==season) & (shot_type['SHOT_TYPE']=='3PT Field Goal')].Counts.to_numpy()[0]\n    two_percentage = round(two_point\/(two_point + three_point),3) * 100\n    three_percentage = round(three_point\/(two_point + three_point),3) * 100\n    shot_type.loc[(shot_type['Season']==season) & (shot_type['SHOT_TYPE']=='2PT Field Goal'),'Percentage']=two_percentage\n    shot_type.loc[(shot_type['Season']==season) & (shot_type['SHOT_TYPE']=='3PT Field Goal'),'Percentage']=three_percentage\n    \nshot_type","d6870ef5":"#Graph shot type percentage\nbarchart = px.bar(data_frame=shot_type,x=\"Percentage\",y=\"Season\",color=\"SHOT_TYPE\",color_discrete_sequence=['#fdb927','#552583'], orientation=\"h\",width=900, height=700,opacity=0.85)\nbarchart.update_yaxes(type='category')\nbarchart.show()","8bf503ce":"#Calculation of accuracy of each shot type\nacc_shot_type = kobe_shotlog.groupby(['Season','SHOT_TYPE'])['SHOT_MADE_FLAG'].value_counts().to_frame()\nacc_shot_type.rename(columns={'SHOT_MADE_FLAG':'Counts'},inplace=True)\nacc_shot_type.reset_index(inplace=True)\nacc_shot_type\n\n#calculate the accuracy of each shot type(0 means missed, 1 means made)\nacc_shot_type['Percentage'] = np.nan\nfor season in seasons:\n    two_made = acc_shot_type.loc[(acc_shot_type['Season']==season) & (acc_shot_type['SHOT_TYPE']=='2PT Field Goal') & (acc_shot_type['SHOT_MADE_FLAG']==1)].Counts.to_numpy()[0]\n    two_miss = acc_shot_type.loc[(acc_shot_type['Season']==season) & (acc_shot_type['SHOT_TYPE']=='2PT Field Goal') & (acc_shot_type['SHOT_MADE_FLAG']==0)].Counts.to_numpy()[0]\n    three_made = acc_shot_type.loc[(acc_shot_type['Season']==season) & (acc_shot_type['SHOT_TYPE']=='3PT Field Goal') & (acc_shot_type['SHOT_MADE_FLAG']==1)].Counts.to_numpy()[0]\n    three_miss = acc_shot_type.loc[(acc_shot_type['Season']==season) & (acc_shot_type['SHOT_TYPE']=='3PT Field Goal') & (acc_shot_type['SHOT_MADE_FLAG']==0)].Counts.to_numpy()[0]\n    two_acc = round(two_made\/(two_made+two_miss),3) * 100\n    three_acc = round(three_made\/(three_made+three_miss),3) * 100\n    acc_shot_type.loc[(acc_shot_type['Season']==season) & (acc_shot_type['SHOT_TYPE']=='2PT Field Goal') & (acc_shot_type['SHOT_MADE_FLAG']==1),'Percentage'] = two_acc\n    acc_shot_type.loc[(acc_shot_type['Season']==season) & (acc_shot_type['SHOT_TYPE']=='2PT Field Goal') & (acc_shot_type['SHOT_MADE_FLAG']==0),'Percentage'] = (100-two_acc)\n    acc_shot_type.loc[(acc_shot_type['Season']==season) & (acc_shot_type['SHOT_TYPE']=='3PT Field Goal') & (acc_shot_type['SHOT_MADE_FLAG']==1),'Percentage'] = three_acc\n    acc_shot_type.loc[(acc_shot_type['Season']==season) & (acc_shot_type['SHOT_TYPE']=='3PT Field Goal') & (acc_shot_type['SHOT_MADE_FLAG']==0),'Percentage'] = (100-three_acc)\n#graph 2pt accuracy\n#extract 2pt shot information\ntwo = acc_shot_type[(acc_shot_type['SHOT_MADE_FLAG']==1) & (acc_shot_type['SHOT_TYPE']=='2PT Field Goal')]\nthree = acc_shot_type[(acc_shot_type['SHOT_MADE_FLAG']==1) & (acc_shot_type['SHOT_TYPE']=='3PT Field Goal')]\nfig = go.Figure(data=[\n    go.Bar(name='2PT%', x=two.Season, y=two.Percentage, marker_color='#fdb927'),\n    go.Bar(name='3PT%', x=three.Season, y=three.Percentage, marker_color='#552583')\n])#552583, fdb927\nfig.update_layout(barmode='group', title='Field Goal Percentage by Shot Type', title_x=0.5, width=800, height=500)\nfig.update_xaxes(type='category', title_text='Season')\nfig.update_yaxes(title_text='Field  Goal  Percentage')\nfig.show()","7d5f74fa":"#Draw the NBA Court\ndef draw_court(ax=None, color='black', lw=2, outer_lines=False):\n    #if ax object is not provided, get current one\n    if ax is None:\n        ax = plt.gca()\n        \n    #draw the court\n    court_elements = []\n    #create HOOP (has a radius of 9\" which is 7.5 on our coordinate system)\n    hoop = Circle((0,0), radius=7.5, linewidth=lw, color='red', fill=False)\n    court_elements.append(hoop)\n    \n    #create BACKBOARD\n    backboard = Rectangle((-30,-7.5), 60, -1, linewidth=lw, color=color)\n    court_elements.append(backboard)\n    \n    #The PAINT\n    #create outer box of the paint(width=16ft, height=19ft)\n    outer_box = Rectangle((-80,-47.5), 160, 190, linewidth=lw, color=color, fill=False)\n    court_elements.append(outer_box)\n    #create inner box of the paint(width=12ft, height=19ft)\n    inner_box = Rectangle((-60,-47.5), 120, 190, linewidth=lw, color=color, fill=False)\n    court_elements.append(inner_box)\n    \n    #create FREETHROW TOP ARC\n    top_free_throw = Arc((0,142.5), 120, 120, theta1=0, theta2=180, linewidth=lw, color=color, fill=False)\n    court_elements.append(top_free_throw)\n    #create FREETHROW BOTTOM ARCabs\n    bottom_free_throw = Arc((0,142.5), 120, 120, theta1=180, theta2=0, linewidth=lw, color=color, linestyle=\"dashed\")\n    court_elements.append(bottom_free_throw)\n    \n    #create RESTRICTED ZONE\n    restricted = Arc((0,0), 80, 80, theta1=0, theta2=180, linewidth=lw, color=color)\n    court_elements.append(restricted)\n    \n    #THREE POINT LINE\n    #left 3pt line(straight, 14ft long)\n    left_three = Rectangle((-220,-47.5), 0, 140, linewidth=lw, color=color)\n    court_elements.append(left_three)\n    #right 3pt line(straight)\n    right_three = Rectangle((220,-47.5), 0, 140, linewidth=lw, color=color)\n    court_elements.append(right_three)\n    #3pt arc\n    three_arc = Arc((0,0), 475, 475, theta1=22, theta2=158, linewidth=lw, color=color)\n    court_elements.append(three_arc)\n    \n    #create CENTRE ARC\n    center_outer_arc = Arc((0, 422.5), 120, 120, theta1=180, theta2=0,\n                           linewidth=lw, color=color)\n    center_inner_arc = Arc((0, 422.5), 40, 40, theta1=180, theta2=0,\n                           linewidth=lw, color=color)\n    court_elements.append(center_outer_arc)\n    court_elements.append(center_inner_arc)\n    \n    #BORDER LINES\n    if outer_lines:\n        outer_lines = Rectangle((-250,-47.5), 500, 470, linewidth=lw, color=color, fill=False)\n        court_elements.append(outer_lines)\n    \n    #draw each court element on axes\n    for element in court_elements:\n        ax.add_patch(element)\n        \n    return ax","a3895736":"#plot all the shots\ndef draw_shotchart(df, ax=None, title=\"\"):\n    \n    plt.rcParams['figure.figsize'] = (13, 12)\n    \n    if ax is None:\n        ax = plt.gca()\n    \n    ax.set_title(title, fontsize=18)\n    #draw court\n    draw_court(ax, outer_lines=True)\n    ax.set_xlim(-250.5,250)\n    ax.set_ylim(422.5,-47.5)\n    \n    #draw made shot\n    x_made = df[df['EVENT_TYPE']=='Made Shot']['LOC_X']\n    y_made = df[df['EVENT_TYPE']=='Made Shot']['LOC_Y']\n    ax.scatter(x_made,y_made,facecolors='none', edgecolors='g', marker=\"o\",s=50, linewidth=1.5)\n   \n    #draw missed shot\n    x_missed = df[df['EVENT_TYPE']=='Missed Shot']['LOC_X']\n    y_missed = df[df['EVENT_TYPE']=='Missed Shot']['LOC_Y']\n    ax.scatter(x_missed, y_missed, c='r', marker='x', s=50, linewidth=0.5)\n    \n    return ax","338660a7":"draw_shotchart(kobe_shotlog, title=\"Shot Chart of Kobe's Career\")\nplt.show()","d8fde29a":"#draw hexagon shot chart\n#create a hexbin graph and fit all the shots in each hexbin, use the data to plot the chart\ndef draw_hexbin_chart(df,filter_threshold, title=\"\"):\n    np.seterr(divide='ignore', invalid='ignore')\n    #calculate the accuracy of shots for each hexbin\n    #get hexbins of all shots\n    shots_hex = plt.hexbin(x=df.LOC_X, y=df.LOC_Y, extent=(-250, 250, 422.5, -47.5), cmap='Blues', gridsize=35)\n    plt.close()\n    #get hexbins of all made shots\n    made_shots = df[df['EVENT_TYPE']=='Made Shot']\n    made_hex = plt.hexbin(x=made_shots.LOC_X, y=made_shots.LOC_Y,extent=(-250, 250, 422.5, -47.5), cmap='Blues', gridsize=35)\n    plt.close()\n    acc_hex = made_hex.get_array() \/ shots_hex.get_array()\n    acc_hex[np.isnan(acc_hex)] = 0 \n\n    #filter the shots\n    sample_sizes = shots_hex.get_array()\n    #Get rid of the bins that has less than 20 shots\n    filter_threshold = filter_threshold\n    for i in range(len(acc_hex)):\n        if sample_sizes[i] < filter_threshold:\n            acc_hex[i] = 0\n    x = [i[0] for i in shots_hex.get_offsets()]\n    y = [i[1] for i in shots_hex.get_offsets()]\n    z = acc_hex\n    \n    #calculate frequency or size of each hexbin\n    test = plt.hexbin(x=df.LOC_X, y=df.LOC_Y, extent=(-250, 250, 422.5, -47.5), cmap='Blues', gridsize=35)\n    freq_hex = test.get_array() \/ sum(test.get_array())\n    #fix the error that results in extremely big frequency in the cell near the hoop\n    hexcell = df.loc[(df.LOC_X > 0) & (df.LOC_X < 14) & (df.LOC_Y>-8) & (df.LOC_Y<8)]\n    #calculate frequency and accuracy of that cell\n    cell_made = hexcell[hexcell['SHOT_MADE_FLAG']==1]\n    if len(hexcell)==0:\n        cell_acc=0\n    else:\n        cell_acc = len(cell_made) \/ len(hexcell)\n    cell_freq = len(hexcell) \/ sum(test.get_array())\n    index = np.where(freq_hex == max(freq_hex))\n    np.put(freq_hex, index, cell_freq)\n    np.put(acc_hex, index, cell_acc)\n    sizes = freq_hex \/ max(freq_hex) * 500\n    plt.close()\n    \n    fig = plt.figure(figsize=(13, 12))\n    plt.xlim(-250,250)\n    plt.ylim(422.5, -47.5)\n    plt.title(title, fontdict = {'fontsize' : 25})\n    \n    #plot the hexbins\n    scatter = plt.scatter(x, y, c=z, s=sizes, cmap=plt.cm.YlOrRd, marker='h')\n    draw_court(outer_lines=True)\n    \n    cur_axes = plt.gca()\n    cur_axes.axes.get_xaxis().set_visible(False)\n    cur_axes.axes.get_yaxis().set_visible(False)\n\n    legend1 = plt.legend(\n        *scatter.legend_elements(num=6, fmt=\"{x:.0f}%\", func=lambda s: s * 100),\n        loc=\"lower right\", title='Shot\\nAccuracy', fontsize=15)\n    legend1.get_title().set_fontsize('15')\n    \n    plt.gca().add_artist(legend1)\n    ","b378c5d2":"draw_hexbin_chart(kobe_shotlog, 35, \"Shot Chart of Kobe's Career\")","157404e8":"seasons_8 = ['1996-97', '1997-98', '1998-99', '1999-00', '2000-01', '2001-02', '2002-03', '2003-04','2004-05', '2005-06']\nshots_8 = kobe_shotlog[(kobe_shotlog['Season'].isin(seasons_8)) & (kobe_shotlog.SHOT_DISTANCE < 40)].copy()\nshots_24 = kobe_shotlog[(~ kobe_shotlog['Season'].isin(seasons_8)) & (kobe_shotlog.SHOT_DISTANCE < 40)].copy()\nshots_8.SHOT_DISTANCE=pd.to_numeric(shots_8.SHOT_DISTANCE)\nshots_24.SHOT_DISTANCE=pd.to_numeric(shots_24.SHOT_DISTANCE)\nshots_8.LOC_X=pd.to_numeric(shots_8.LOC_X)\nshots_8.LOC_Y=pd.to_numeric(shots_8.LOC_Y)\nshots_24.LOC_X=pd.to_numeric(shots_24.LOC_X)\nshots_24.LOC_Y=pd.to_numeric(shots_24.LOC_Y)","beb0c8f9":"plt.figure(figsize=(15,9))\nsns.kdeplot(data=shots_24['SHOT_DISTANCE'], label='No.24', shade=True)\nsns.kdeplot(data=shots_8['SHOT_DISTANCE'],label='No.8', shade=True)\nplt.legend(fontsize=20)","e820651c":"def draw_jointplot(df):\n    cmap=plt.cm.gnuplot_r\n    \n    joint_shot_chart = sns.jointplot(x=df.LOC_X, y=df.LOC_Y,\n                                 kind='kde', space=0, color=cmap(0.1),\n                                 cmap=cmap, n_levels=50, shade=True)\n\n    joint_shot_chart.fig.set_size_inches(12,11)\n\n    # A joint plot has 3 Axes, the first one called ax_joint \n    # is the one we want to draw our court onto and adjust some other settings\n    ax = joint_shot_chart.ax_joint\n    draw_court(ax)\n\n    # Adjust the axis limits and orientation of the plot in order\n    # to plot half court, with the hoop by the top of the plot\n    ax.set_xlim(-250,250)\n    ax.set_ylim(422.5, -47.5)\n\n    # Get rid of axis labels and tick marks\n    ax.set_xlabel('')\n    ax.set_ylabel('')\n    ax.tick_params(labelbottom='off', labelleft='off')","30076182":"draw_jointplot(shots_8)","15733c2c":"draw_jointplot(shots_24)","e8b5528d":"### Kobe Bryant's Shot Chart heatmap when wearing No.24","03041a5e":"Import Python Packages","f2f9ddfb":"### Graph Kobe Bryant's shot chart\nFirst I need to define a couple functions to draw plot Kobe's shot chart\n1. Draw the court\n2. Plot all Kobe's shots","bfc12b8a":"## 8 VS 24\n\nIn the 20 seasons of Kobe's career, he wore the No.8 jersey for the first 10 years and wore the No.24 jersey for the last 10 years. According to him, these two numbers represented two different time periods of his career both on and off the court where No.8 shows his \"nonstop energy and aggresiveness\" and No.24 shows his \"growth and maturity\". ","4d6d2712":"### Kobe Bryant's Shot Chart heatmap when wearing No.8","85636c5b":"# Analysis of Shots taken by Kobe Bryant\n\nKobe Bryant had been one of the greatest NBA players of all time and my favorite player since I started watching NBA(May he rest in peace). To better understand his game and legacy, I want to utilize the knowledge I learned about data science to analyze all the shots Kobe Bryant had taken in his career. \n\n![](https:\/\/media3.s-nbcnews.com\/i\/newscms\/2020_04\/3203206\/200126-kobe-bryant-cs-551p_94a33c06ae6c4bbebaf59985de472c42.jpg)\n\nAlso I want to thank [Savvas Tjortjoglou](http:\/\/savvastjortjoglou.com\/) and [JP Hwang](https:\/\/www.jphwang.com\/) for the tutorial of NBA shot charts and [nba_api](https:\/\/github.com\/swar\/nba_api) for allowing me access Kobe's shotlog from [NBA](https:\/\/www.nba.com\/).","63ba595d":"This graph looks way too messy since it contain over 30000 shots Kobe took in his entire career. For easier understanding and better analysis of Kobe's shots, we will create a hexagon shot chart. ","1e457800":"(The larger the hexagon is, the more shots was taken in that location. And the darker the hexagon is, the higer the FG%.)\n<br>\n\nAs we can see on Kobe's shot chart, Kobe's hot zone covered most area on the court and he was able to make shots anywhere he wants. Kobe's FG% was highest under the rim and it was the lowest near the corner of the court. More generally, Kobe shot a bit more on the right side of the court and made a bit more on the right side since right hand was his dominant hand. ","57460072":"One thing we need to notice is that in the 2013-14 season, Kobe only took a total of 73 shots. After an career ending injury(Torn Achilles) in the previous season, Kobe only played 6 games in that 2013-14 season. Because of the small quantity of data points, the analysis of data in this season may be outliers and does not have statistical significance. \n\n### Visualize the data with bar graph","836537e1":"### Load Kobe's shotlog\n\nClean the data by delete the columns that we are not gonna analyze like Game ID, Team ID, Player ID, etc. ","067bf47c":"As we can see on the graph above, Kobe had been a good shooter inside of the 3-point line. Of all the 2-pointers he shot in his career, he made around 45% to 50% of them in the majority of his career. However, in his last two season, his performance was significantly impacted by the career ending injury and his 2-pointers percentage dropped by 5 percent. \n\nKobe Bryant was not the most efficient 3PT shooter comparing to Stephen Curry or Klay Thompson. On a average, Kobe made around 33% of his 3PT shots. However, this percentage dropped a bit after he torn his achilles in the last few seasons. \n","440e79a3":"According to the graph above, the two curves have similar patterns which indicates that Kobe's shot distance in the different jerseys are similar or the his range did not change. The majority of the shots Kobe are shown as the three peaks on the graph which are under the basket, 16-19 feet away from basket(long range jumpers), and 24-25 feet away from the basket(3-pointers). \n\nHowever, there are two major discrepancies between the two curves. The curve of Kobe with No.8 has a much higher peak under the basket and a lower peak around the 3PT line. Such discrepancies illustrates that Kobe, when wearing No.8, tended to take more shots under the basket. And when wearing No.24, he tended to take more shots around the 3PT line comparing to the previous 10 seasons.","6526343e":"As we can see on the graph, except for Kobe's first season and last season when over one third of Kobe's shots are 3-pointers, the majority of Kobe's shots are 2-pointers and they can be dunks, pull-up jumpers, fadeaways and so on. \n\nIn his last season, the 2015-2016 season, the offense of the league was evolving led by Stephen Curry and Golden State Warriors where teams started to shoot much more 3-pointers. At the same time, Kobe also shot much more 3-pointers. In that season, 42 percent of his shots are 3-pointers which is almost the double of average percentage of 3-pointers in his career before that season. ","2f4de7f0":"The dataframe\/table above contains all 30697 shots Kobe Bryant had taken in his career and their corresponding information like type of the shot, whether he made it or not, location of the shot on the court, distance from the hoop, etc. \n\nNote that shots taken in the Pre-season, All-Star games, Olympics games are not included. \n\n## Analysis of the types of shots\n\nGroup the table by Season and Shot Type, then count each types of shots(2PT or 3PT) and then calculate the percentages of each correspond shot type in each season.","8a7238d8":"Similar patterns can be observed with the heat map above. In the graphs above, the darker the area, the more shots were taken in that area. And we can see that in the 2nd graph(No.24), the color of the Wing and the right side of the extended free-throw line is much darker than that of the the 1st graph(No.8) which also shows that Kobe took more long range shots when wearing No.24. \n\n\nThis may be a result of, according to Kobe Bryant, \"weakened\" physical attributes. Although Kobe is still one of the most athletic players in the league, he is not as dominant and flexible under the basket as he used to be in the No.8 Jersey. Thus he shifted his gamestyle and started to take more longer range shots and thrived with this new style of play.  "}}