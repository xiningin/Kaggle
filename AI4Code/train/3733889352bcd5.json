{"cell_type":{"6af84ce8":"code","13267442":"code","099b055e":"code","eb9eb1fa":"code","a3c62879":"code","9d2e444a":"code","98ba5ac3":"code","1d946603":"code","1fccac03":"code","a1391277":"code","c793174f":"code","29b4035e":"code","aad24ba2":"markdown","a0146b30":"markdown","7390cf35":"markdown"},"source":{"6af84ce8":"!git clone --depth 1 \\\n    --branch adversarialattacks \\\n    https:\/\/github.com\/tuanpham96\/bnn-cf-vs-robust\n    \n%cd bnn-cf-vs-robust","13267442":"!tree","099b055e":"!tar xf \/kaggle\/input\/pmnistrobustnessdataset\/pmnist-robustness.tar.xz --directory data\/input","eb9eb1fa":"!tar xf \/kaggle\/input\/pmnistrobustunfinishedjobs\/exp2-pmnist-robust-dq-pmnist_robustness_4096x4096_meta1.35_beta_dq0.0006.tar.xz  --directory .","a3c62879":"!tree ","9d2e444a":"!pip install foolbox","98ba5ac3":"import os\nfrom pathlib import Path\n\nimport numpy as np\nfrom tqdm.notebook import tqdm\nimport yaml \n\n\ndata_raw_path = Path('data\/raw')\ndata_inp_path = Path('data\/input')\n\nroot_data_path = data_inp_path \/ 'pmnist_robustness'\n!tree $root_data_path","1d946603":"!python src\/pmnist_robustness_main.py --help","1fccac03":"%%time \ninput_metadata_file = str(root_data_path \/ 'metadata.yaml')\n\nmeta_vecs = [1.35]\nbetadq_vecs = [6e-4]\n\nnum_h1 = 4096\nnum_h2 = 4096\n\ndef mk_outname(meta_val, h1, h2, beta_dq):\n    return 'pmnist_robustness_[%dx%d]_[meta=%.2f]_[beta_dq=%g]' %(h1, h2, meta_val, beta_dq)\n\nfor meta_val in meta_vecs:\n    for beta_dq in betadq_vecs:\n        out_name_dir = mk_outname(meta_val, num_h1, num_h2, beta_dq)\n\n        print('-'*100)\n        print('META = %.2f' %(meta_val))\n        \n        if beta_dq > 0:\n            !python -W ignore src\/pmnist_robustness_main.py \\\n                --input \"$input_metadata_file\" \\\n                --output-name \"$out_name_dir\" \\\n                --save-path data\/output\/exp2-pmnist-robust-dq \\\n                --hidden-layers \"$num_h1\" \"$num_h2\" \\\n                --meta \"$meta_val\" \\\n                --dq --dq-beta \"$beta_dq\" \\\n                --lr 0.005 \\\n                --decay 1e-7 \\\n                --epochs-per-task 40 \\\n                --batch-size 100 \\\n                --num-workers 4 \\\n                --test-adversarial \\\n                --skip-training \\\n                --pin-memory\n            \n        else:\n            !python -W ignore src\/pmnist_robustness_main.py \\\n                --input \"$input_metadata_file\" \\\n                --output-name \"$out_name_dir\" \\\n                --save-path data\/output\/exp2-pmnist-robust-dq \\\n                --hidden-layers \"$num_h1\" \"$num_h2\" \\\n                --meta \"$meta_val\" \\\n                --lr 0.005 \\\n                --decay 1e-7 \\\n                --epochs-per-task 40 \\\n                --batch-size 100 \\\n                --num-workers 4 \\\n                --test-adversarial \\\n                --skip-training \\\n                --pin-memory\n            ","a1391277":"# to reduce size when downloading \n!rm -rf data\/input\/pmnist_robustness","c793174f":"!tree 'data\/input'","29b4035e":"!tree 'data\/output'","aad24ba2":"## Run training and testing","a0146b30":"This version is specifically for running an unfinished job in V9\n\nThis version is specifically for running the unfinished job in V9, specifically the file: `exp2-pmnist-robust-dq-pmnist_robustness_4096x4096_meta1.35_beta_dq0.0006.tar.xz`","7390cf35":"## View data"}}