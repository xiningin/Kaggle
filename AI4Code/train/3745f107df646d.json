{"cell_type":{"b1e29678":"code","d9a7fc99":"code","3e6b39ec":"code","0eedc24b":"code","5fa9634d":"code","f671ca02":"code","9c4d1dd3":"code","7c4338f6":"code","0a542dad":"code","c671f0ac":"code","72b1270d":"code","526e8c2c":"code","8f75b0d4":"code","4225e5f7":"code","15df4d2c":"code","c9987ba1":"code","7e03a3f5":"code","d3675330":"code","58fb24fa":"code","1d230d9b":"code","687c760b":"code","64c64a3d":"code","c88383e7":"code","1578607e":"code","5e1df2c6":"code","c8a231c8":"code","91ab84c8":"code","a92597ce":"code","001a7eef":"code","6008fc4e":"code","164a5561":"markdown","f0ce0218":"markdown","20aca0ad":"markdown","41cdb5f2":"markdown","f630e143":"markdown","40048541":"markdown","f1c9c17f":"markdown","36bdaae4":"markdown","f7847738":"markdown","634b093f":"markdown","4721b687":"markdown","2d83f6d9":"markdown","41c99212":"markdown","d861993f":"markdown","67d56573":"markdown","72c8099a":"markdown","920112d9":"markdown","2b2f4484":"markdown","583f0bf9":"markdown","ff13761a":"markdown","d17c414d":"markdown","04496c32":"markdown","91601b10":"markdown"},"source":{"b1e29678":"import numpy as np \nimport pandas as pd\n# Data EDA\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n# For Prediction\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import accuracy_score\n# Feature Scaling\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.preprocessing import RobustScaler\n# Model\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.linear_model import Perceptron\nfrom sklearn.tree import DecisionTreeClassifier\nfrom lightgbm import LGBMClassifier\nfrom lightgbm import plot_importance\nplt.rcParams['axes.unicode_minus']=False","d9a7fc99":"data=pd.read_csv(\"\/kaggle\/input\/red-wine-quality-cortez-et-al-2009\/winequality-red.csv\")","3e6b39ec":"data.head()","0eedc24b":"data.columns","5fa9634d":"features=['fixed acidity', 'volatile acidity', 'citric acid', 'residual sugar',\n       'chlorides', 'free sulfur dioxide', 'total sulfur dioxide', 'density',\n       'pH', 'sulphates', 'alcohol']\ntarget='quality'","f671ca02":"X_train,X_test,Y_train,Y_test=train_test_split(data[features],data[target],shuffle=True)","9c4d1dd3":"temp=pd.concat([X_train,Y_train],axis=1)\nsns.pairplot(temp,hue='quality')","7c4338f6":"mask=np.zeros_like(temp.corr(),dtype=bool)\nmask[np.triu_indices_from(mask)]=True\n\nplt.figure(figsize=(7,7))\nsns.heatmap(temp.corr(),annot=True,mask=mask,cmap='Blues')","0a542dad":"plt.figure(figsize=(14,6))\nplt.subplot(121)\nsns.histplot(data=temp,x='alcohol',y='quality',color='navy')\nplt.subplot(122)\nsns.scatterplot(data=temp,x='alcohol',y='volatile acidity',color='navy')","c671f0ac":"plt.figure(figsize=(15,15))\nfor i in range (0,len(temp.columns)):\n    plt.subplot(4,3,i+1)\n    plt.title('{0}'.format(temp.columns[i]))\n    if i == 11 :\n        sns.histplot(temp['{0}'.format(temp.columns[i])],color='navy')\n    else:\n        sns.kdeplot(temp['{0}'.format(temp.columns[i])],color='navy')","72b1270d":"temp.describe()","526e8c2c":"X_train.isna().sum()","8f75b0d4":"X_test.isna().sum()","4225e5f7":"rs=RobustScaler()\nss=StandardScaler()","15df4d2c":"X_Robust_train=X_train.copy()\nX_Robust_test=X_test.copy()\nfor i in range(0,len(X_train.columns)):\n    X_Robust_train['{0}'.format(X_train.columns[i])]=rs.fit_transform(X_Robust_train['{0}'.format(X_train.columns[i])\n                                                                                     ].to_frame(name=('{0}'.format(X_train.columns[i]))))\n    X_Robust_test['{0}'.format(X_test.columns[i])]=rs.fit_transform(X_Robust_test['{0}'.format(X_test.columns[i])\n                                                                                 ].to_frame(name=('{0}').format(X_test.columns[i])))","c9987ba1":"pc=Perceptron()\npc.fit(X_Robust_train,Y_train)\npc_result=pc.predict(X_Robust_test)","7e03a3f5":"accuracy_score(Y_test,pc_result)","d3675330":"X_Standard_train=X_train.copy()\nX_Standard_test=X_test.copy()\nfor i in range(0,len(X_train.columns)):\n    X_Standard_train['{0}'.format(X_train.columns[i])]=ss.fit_transform(X_Standard_train['{0}'.format(X_train.columns[i])\n                                                                                     ].to_frame(name=('{0}'.format(X_train.columns[i]))))\n    X_Standard_test['{0}'.format(X_test.columns[i])]=ss.fit_transform(X_Standard_test['{0}'.format(X_test.columns[i])\n                                                                                 ].to_frame(name=('{0}').format(X_test.columns[i])))","58fb24fa":"pc.fit(X_Standard_train,Y_train)\npt_s_result=pc.predict(X_Standard_test)","1d230d9b":"accuracy_score(Y_test,pt_s_result)","687c760b":"dtc=DecisionTreeClassifier()\ndtc.fit(X_train,Y_train)\ndtc_result=dtc.predict(X_test)","64c64a3d":"accuracy_score(Y_test,dtc_result)","c88383e7":"dtc.fit(X_Robust_train,Y_train)\ndtc_result=dtc.predict(X_Robust_test)","1578607e":"accuracy_score(Y_test,dtc_result)","5e1df2c6":"lgb=LGBMClassifier()\nlgb.fit(X_train,Y_train)\nlgb_result=lgb.predict(X_test)\naccuracy_score(Y_test,lgb_result)","c8a231c8":"plot_importance(lgb)","91ab84c8":"new_features=['fixed acidity', 'volatile acidity', 'citric acid','chlorides', 'total sulfur dioxide', 'density', 'sulphates', 'alcohol']\nX_train_new=X_train[new_features]\nX_test_new=X_test[new_features]","a92597ce":"lgb.fit(X_train_new,Y_train)\nlgb_result_1=lgb.predict(X_test_new)","001a7eef":"accuracy_score(Y_test,lgb_result_1)","6008fc4e":"lgb_2=LGBMClassifier(learning_rate=0.02)\nlgb_2.fit(X_train,Y_train)\nresult2=lgb_2.predict(X_test)\naccuracy_score(Y_test,result2)","164a5561":"It has better result.","f0ce0218":"<strong>chekcing missing value<strong>","20aca0ad":"## 4-5. Model Selection and Train - DecisionTreeClassifier without Robust Scaler","41cdb5f2":"### 1-1. Spliting Train Set and Test Set","f630e143":"### LightGBM Model has the best result.","40048541":"### 3-2. Data Preprocessing - StandardScaler","f1c9c17f":"## 4-5. Model Selection and Train - DecisionTreeClassifier without Robust Scaler","36bdaae4":"## 4-3. Model Selection and fitting - Perceptron with StandardScaler","f7847738":"## 3. Data PreProcessing","634b093f":"## 5. Model Tuning","4721b687":"## 2. Data EDA","2d83f6d9":"## 4. Model Selection and Fitting - Perceptron","41c99212":"<li><strong>quality & volatile acidity<\/strong><\/li>\n<li><strong>quality & alcohol<\/strong><\/li>\n<li>alcohol & density<\/li>\n<li>pH & fixed acidity<\/li>\n<li>pH & citric acid<\/li>\n<li>density & fixed acidity<\/li>\n<li>total sulfur dioxide & free sulfur dioxide<\/li>\n<li>citric acid & fixed acidity<\/li>\nhave correlations.","d861993f":"# Basic Wine Quality Analysis and Prediction Machine Learning Project","67d56573":"### 3-1. Feature Scaling - Robust Scaling","72c8099a":"Eliminate features which has The lowest importance, the residual sugar, free sugar dioxide, pH","920112d9":"LightGBM is Tree Model, so it don't need Scaling","2b2f4484":"## 5-2. Parameter Tuning","583f0bf9":"## 4-4. Model Selection and Train - DecisionTreeClassifier without Scaler","ff13761a":"## 1. Loading Data","d17c414d":"free sulfur dioxide\uc640 total sulfur dioxide\ub294 outlier \uac16\uace0 \uc788\uae30 \ub54c\ubb38\uc5d0 RobustScaler\ub97c \uc0ac\uc6a9\ud55c\ub2e4.","04496c32":"## 5-1. Feature Tuning.","91601b10":"It is more comfortable to use GridSearchCV."}}