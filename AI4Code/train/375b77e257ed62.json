{"cell_type":{"024cacec":"code","af916365":"code","87ecf173":"code","1a084bd9":"code","ebfa88d1":"code","bcb267a5":"code","a67fdb14":"code","d8b2cd53":"code","2c2e1dc9":"code","44027b0a":"code","485ddab1":"code","1e6e5667":"code","04e0adca":"code","a23da1fa":"code","73ae166c":"code","2841746b":"code","f76f5eaa":"code","751918f7":"code","1ed4c70b":"code","bc6ff416":"code","b5084572":"code","71b9573e":"code","e2acf51b":"markdown","a611f398":"markdown","2ac8d8ec":"markdown","ae3e1bc6":"markdown","34273d8a":"markdown","c379785b":"markdown","e87d5b6b":"markdown","a45d834d":"markdown","09d90bb1":"markdown","8523a70a":"markdown","535d2a79":"markdown","5bb973b6":"markdown","ac247ac4":"markdown","78f0cc8c":"markdown","cf04b752":"markdown"},"source":{"024cacec":"import datetime as dt\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n%matplotlib inline\n\nraw_us_df = pd.read_csv('..\/input\/nytimes-covid19-data\/us.csv')\nraw_states_df = pd.read_csv('..\/input\/nytimes-covid19-data\/us-states.csv')\nraw_counties_df = pd.read_csv('..\/input\/nytimes-covid19-data\/us-counties.csv')\n\ndates = pd.date_range(dt.date(2020, 1, 1), dt.datetime.today()-dt.timedelta(days=2)).tolist()\ndates_str = [date.strftime('%Y-%m-%d') for date in dates]\n\ndef state_case_count(state, date):\n    value = raw_states_df['cases'][raw_states_df['state'] == state][raw_states_df['date'] == date]\n    return 0 if value.empty else value.iloc[0]\n\ndef state_death_count(state, date):\n    value = raw_states_df['deaths'][raw_states_df['state'] == state][raw_states_df['date'] == date]\n    return 0 if value.empty else value.iloc[0]\n\ndef county_case_count(county, date):\n    value = raw_counties_df['cases'][raw_counties_df['county'] == county][raw_counties_df['date'] == date]\n    return 0 if value.empty else value.iloc[0]\n\ndef county_death_count(county, date):\n    value = raw_counties_df['deaths'][raw_counties_df['county'] == county][raw_counties_df['date'] == date]\n    return 0 if value.empty else value.iloc[0]","af916365":"raw_us_df.tail()","87ecf173":"raw_states_df.tail()","1a084bd9":"raw_counties_df.tail()","ebfa88d1":"plt.figure(figsize=(20, 5))\nplt.plot(raw_us_df['date'], raw_us_df['cases'])\nplt.plot(raw_us_df['date'], raw_us_df['deaths'])\nplt.xticks(raw_us_df['date'][::15], rotation=45, ha='right')\nplt.ylabel('Cases & Deaths in Millions')\nplt.legend(['Cases', 'Deaths'])\nplt.title('Cumulative Cases & Deaths Nationwide')\nplt.show()","bcb267a5":"top_count = 10\ncases_by_state_df = raw_states_df.drop(['fips'], axis=1)\ncases_by_state_df = cases_by_state_df.groupby('state').max().sort_values(by=['cases'], ascending=False).reset_index()\ncases_by_state_df.head(top_count)","a67fdb14":"states_with_most_cases_df = cases_by_state_df.iloc[:top_count, :];\nplt.figure(figsize=(20, 7))\nplt.barh(np.arange(top_count)+0.125, states_with_most_cases_df['cases'].iloc[::-1], height=0.25)\nplt.barh(np.arange(top_count)-0.125, states_with_most_cases_df['deaths'].iloc[::-1], height=0.25)\nplt.yticks(np.arange(top_count), states_with_most_cases_df['state'].iloc[::-1])\nplt.xlabel('Cases & Deaths')\nplt.legend(['Cases', 'Deaths'])\nplt.title('Highest Cumulative Case Counts Nationwide')\nplt.show()","d8b2cd53":"usa_df = pd.DataFrame({'date': dates_str})\nmost_affected_states = cases_by_state_df['state'].head(top_count).to_list()\n\nfor state in most_affected_states:\n    usa_df[state] = [state_case_count(state, date) for date in dates_str]\n    \nusa_df.tail()","2c2e1dc9":"plt.figure(figsize=(20, 5))\n\nfor state in most_affected_states:\n    plt.plot(usa_df['date'], usa_df[state])\n    \nplt.xticks(usa_df['date'][::15], rotation=45, ha='right')\nplt.ylabel('Cases')\nplt.legend(most_affected_states)\nplt.title('Cumulative Cases in Most Affected States')\nplt.show()","44027b0a":"state = 'California'\nstate_cases_df = raw_states_df[raw_states_df['state'] == state].groupby('date').sum().reset_index()\nstate_cases_df.tail()","485ddab1":"plt.figure(figsize=(20, 5))\nplt.plot(state_cases_df['date'], state_cases_df['cases'], color=(0.2, 0.5, 1))\nplt.plot(state_cases_df['date'], state_cases_df['deaths'], color=(1, 0.5, 0))\nplt.xticks(state_cases_df['date'][::15], rotation=45, ha='right')\nplt.ylabel('Cases & Deaths')\nplt.legend(['Cases', 'Deaths'])\nplt.title('Cumulative Cases & Deaths in California')\nplt.show()","1e6e5667":"major_counties = ['Los Angeles', 'San Diego', 'Santa Clara', 'San Francisco', 'Sacramento']\nmajor_counties_df = pd.DataFrame({'date': dates_str})\nfor county in major_counties:    \n    major_counties_df[county] = [county_case_count(county, date) for date in dates_str]\n\nmajor_counties_df.tail()","04e0adca":"plt.figure(figsize=(20, 5))\n\nfor county in major_counties:\n    plt.plot(major_counties_df['date'], major_counties_df[county])\n    \nplt.xticks(major_counties_df['date'][::15], rotation=45, ha='right')\nplt.ylabel('Cases')\nplt.legend(major_counties)\nplt.title('Cumulative Cases & Deaths in Major California Counties')\nplt.show()","a23da1fa":"high_case_county = 'Los Angeles'\nca_minus_high_case_county_df = pd.DataFrame()\nca_minus_high_case_county_df['date'] = dates_str\nca_minus_high_case_county_df['Total Cases'] = [state_case_count('California', date) for date in dates_str]\nca_minus_high_case_county_df[f'Cases minus {high_case_county} County'] = [state_case_count('California', date) - county_case_count(high_case_county, date) for date in dates_str]\nca_minus_high_case_county_df['Total Deaths'] = [state_death_count('California', date) for date in dates_str]\nca_minus_high_case_county_df[f'Deaths minus {high_case_county} County'] = [state_death_count('California', date) - county_death_count(high_case_county, date) for date in dates_str]\n\nca_minus_high_case_county_df.tail()","73ae166c":"plt.figure(figsize=(20, 5))\nplt.plot(ca_minus_high_case_county_df['date'], ca_minus_high_case_county_df['Total Cases'], color=(0.2, 0.5, 1, 0.3))\nplt.plot(ca_minus_high_case_county_df['date'], ca_minus_high_case_county_df[f'Cases minus {high_case_county} County'], color=(0.2, 0.5, 1))\nplt.plot(ca_minus_high_case_county_df['date'], ca_minus_high_case_county_df['Total Deaths'], color=(1, 0.5, 0, 0.3))\nplt.plot(ca_minus_high_case_county_df['date'], ca_minus_high_case_county_df[f'Deaths minus {high_case_county} County'], color=(1, 0.5, 0))\nplt.xticks(ca_minus_high_case_county_df['date'][::15], rotation=45, ha='right')\nplt.ylabel('Cases & Deaths')\nplt.legend(['Total Cases', f'Cases minus {high_case_county} County', 'Total Deaths', f'Deaths minus {high_case_county} County'])\nplt.title(f'Cumulative Cases & Deaths in California, minus {high_case_county} County')\nplt.show()","2841746b":"bay_area_counties = ['Alameda', 'Contra Costa', 'Marin', 'San Francisco', 'San Mateo', 'Santa Clara']\nbay_area_df = pd.DataFrame({'date': dates_str})\nfor county in bay_area_counties:    \n    bay_area_df[county] = [county_case_count(county, date) for date in dates_str]\n\nbay_area_df.tail()","f76f5eaa":"plt.figure(figsize=(20, 5))\n\nfor county in bay_area_counties:\n    plt.plot(bay_area_df['date'], bay_area_df[county])\n    \nplt.xticks(bay_area_df['date'][::15], rotation=45, ha='right')\nplt.ylabel('Cases')\nplt.legend(bay_area_counties)\nplt.title('Cumulative Cases in the SF Bay Area')\nplt.show()","751918f7":"def county_cases_df(county):\n    df = raw_counties_df[raw_counties_df['county'] == county].drop(['county', 'state', 'fips'], axis=1)\n    df['new cases'] = df['cases'] - df['cases'].shift(1)\n    df['new deaths'] = df['deaths'] - df['deaths'].shift(1)\n    return df\n    \nsan_francisco_df = county_cases_df('San Francisco')\nsan_francisco_df.tail()","1ed4c70b":"def county_cumulative_cases_plt(county_df, title):\n    plt.figure(figsize=(20, 5))\n    plt.plot(san_francisco_df['date'], san_francisco_df['cases'])\n    plt.plot(san_francisco_df['date'], san_francisco_df['deaths'])\n    plt.xticks(san_francisco_df['date'][::15], rotation=45, ha='right')\n    plt.ylabel('Cases & Deaths')\n    plt.legend(['Cases', 'Deaths'])\n    plt.title(title)\n    return plt\n    \ncounty_cumulative_cases_plt(san_francisco_df, 'Cumulative Cases & Deaths in San Francisco').show()","bc6ff416":"def county_new_cases_plt(county_df, title):\n    plt.figure(figsize=(20, 5))\n    plt.plot(county_df['date'], county_df['new cases'])\n    plt.plot(county_df['date'], county_df['new deaths'])\n    plt.xticks(county_df['date'][::15], rotation=45, ha='right')\n    plt.ylabel('New Cases & Deaths')\n    plt.legend(['Cases', 'Deaths'])\n    plt.title(title)\n    return plt\n\ncounty_new_cases_plt(san_francisco_df, 'New Cases & Deaths in San Francisco').show()","b5084572":"los_angeles_df = county_cases_df('Los Angeles')\ncounty_new_cases_plt(los_angeles_df, 'New Cases & Deaths in LA County').show()","71b9573e":"new_york_city_df = county_cases_df('New York City')\ncounty_new_cases_plt(new_york_city_df, 'New Cases & Deaths in NYC').show()","e2acf51b":"### Statewide totals minus LA county\n\nLA county has the highest number of cumulative cases. What does the state look like if we remove the LA county cases?","a611f398":"# How is California doing?","2ac8d8ec":"# How is the U.S. doing overall?","ae3e1bc6":"### California as a whole","34273d8a":"# COVID-19 Cases in the U.S., California, SF Bay Area\n\nCase curves based on data from The New York Times\n\nUpdated 27 January 2022\n\n","c379785b":"Week of 8\/14, LA finally shows a concave curve.","e87d5b6b":"# How is San Francisco doing?","a45d834d":"# NY Times Data Overview","09d90bb1":"Before the summer surge, San Francisco had a relatively stable rate of new cases.\n\n\u26a0\ufe0f Needs accuracy check. Doesn't match the graph from [SF Chronicle](https:\/\/projects.sfchronicle.com\/2020\/coronavirus-map\/). ","8523a70a":"# How is the SF Bay Area doing?","535d2a79":"### Comparison of major counties","5bb973b6":"And the shape of daily new cases in NYC. NOTE: Not the same scale as San Francisco.","ac247ac4":"LA county actually has a more concave curve than the state overall. ","78f0cc8c":"For comparison, here's the shape of daily new cases in LA county.\nNOTE: not the same scale as San Francisco.","cf04b752":"\u26a0\ufe0f Week of July 19: California and Florida surpassed New York to become the states with the most cumulative cases. Texas also slated to pass New York. North Carolina joins the top 10. \n\n\u26a0\ufe0f Around Oct 22: Texas surpasses California for highest number of cases.\n\n\u26a0\ufe0f Around Dec 6: California reclaims top spot."}}