{"cell_type":{"474c11b5":"code","7736f5ac":"code","208824ae":"code","d9f339db":"code","90ee7a24":"code","3b6c355b":"code","243fa7ee":"code","1ca834fd":"code","3d43e933":"code","bfb79838":"code","1260578d":"code","20b8b273":"code","5b048f79":"code","d2f84714":"code","b48b7588":"markdown","9655ae02":"markdown","413f49c5":"markdown","4ab344f7":"markdown"},"source":{"474c11b5":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport warnings \nwarnings.filterwarnings(\"ignore\")\n%matplotlib inline","7736f5ac":"from sklearn import preprocessing\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.ensemble import RandomForestClassifier, AdaBoostClassifier, GradientBoostingClassifier\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.naive_bayes import GaussianNB\nfrom sklearn.svm import SVC, LinearSVC, NuSVC\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.tree import DecisionTreeClassifier\nfrom scipy.stats import skew\nfrom scipy import stats\nfrom scipy.stats import boxcox\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.decomposition import PCA\nfrom sklearn.feature_selection import SelectKBest, chi2, mutual_info_regression, f_regression\nfrom sklearn import ensemble\nfrom sklearn.metrics import mean_squared_error\n","208824ae":"df = pd.read_csv('\/kaggle\/input\/house-prices-data\/train.csv')\ndt = pd.read_csv('\/kaggle\/input\/house-prices-data\/test.csv')","d9f339db":"df.shape,dt.shape","90ee7a24":"(((df.isnull().sum())*100)\/len(df)).sort_values(\n            ascending = False, kind = 'mergesort').head(15)","3b6c355b":"(((dt.isnull().sum())*100)\/len(dt)).sort_values(\n            ascending = False, kind = 'mergesort').head(30)","243fa7ee":"df.drop(['Id','PoolQC','MiscFeature','Alley','Fence'],axis=1,inplace=True)\ndt.drop(['Id','PoolQC','MiscFeature','Alley','Fence'],axis=1,inplace=True)","1ca834fd":"y = df['SalePrice']\ndf.drop(['SalePrice'], axis = 1, inplace = True)\ndata = pd.concat([df,dt], axis = 0)\ndata.shape","3d43e933":"data.describe()","bfb79838":"year_all = ['YearBuilt', 'YearRemodAdd','YrSold','MoSold','GarageYrBlt']\nfor i in data:\n  if (data[i].dtypes == object and i != 'FireplaceQu') or i in year_all:\n    data[i] = data[i].fillna(data[i].mode()[0])","1260578d":"data['BsmtHalfBath'] = data['BsmtHalfBath'].fillna(data['BsmtHalfBath'].mode()[0])\ndata['BsmtFullBath'] = data['BsmtFullBath'].fillna(data['BsmtFullBath'].mode()[0])\ndata['GarageCars'] = data['GarageCars'].fillna(data['GarageCars'].mode()[0])","20b8b273":"for i in data:\n  if data[i].dtypes != object:\n     data[i] = data[i].fillna(data[i].mean())\n     data[i] = data[i].astype('float64')","5b048f79":"# Replace Null using Classification\n\nclassifiers = [\n    LogisticRegression(),\n    KNeighborsClassifier(3),\n    SVC(kernel=\"rbf\", C=0.01, probability=True),\n    DecisionTreeClassifier(),\n    RandomForestClassifier(ccp_alpha=0.0,max_depth=20, n_estimators=4500),\n    GaussianNB(),\n    GradientBoostingClassifier(learning_rate=0.03),\n    AdaBoostClassifier(learning_rate=0.6)]\n#Using only numerical features\nfireplace_data = data.select_dtypes(exclude=['object'])\nfireplace_data['FireplaceQu'] = data['FireplaceQu'].copy()\n\ndef classify_missing(all_int_dataTe):\n  fire_train = pd.DataFrame()\n  fire_test = pd.DataFrame()\n  null_row_list = list(all_int_dataTe[all_int_dataTe['FireplaceQu'].isnull()].index.tolist())\n  col = list(all_int_dataTe.columns)\n  k = -1\n  for j in null_row_list:\n    try:\n      k+=1 \n      null_row_value = all_int_dataTe.iloc[j]\n      null_row_value = list(null_row_value.values)\n      for i in range(len(null_row_value)):\n        fire_test.loc[k,col[i]] = null_row_value[i]\n    except:\n      continue\n  fire_train = all_int_dataTe.dropna()\n  fire_test = fire_test.drop(['FireplaceQu'],axis = 1)\n\n  f_train = fire_train.drop(['FireplaceQu'],axis = 1)\n  y_train = fire_train['FireplaceQu']\n\n  \n  le = preprocessing.LabelEncoder()\n  le.fit(y_train)\n  y_train = le.transform(y_train)\n\n  \n  X_train, X_test, y_train, y_test = train_test_split(f_train, y_train, test_size=0.1, random_state=1)\n  r = 0\n  for clf in classifiers:\n    clf.fit(X_train,y_train)\n    print(clf.__class__.__name__,' ', round(clf.score(X_test, y_test) * 100, 2))\n    if r < clf.score(X_test, y_test):\n      r = clf.score(X_test, y_test)\n      model = clf\n  print(model)\n  model.fit(X_train,y_train)\n  Y_prediction = model.predict(fire_test)\n  res = le.inverse_transform(Y_prediction)\n\n  for i in range(len(null_row_list)):\n    try:\n      all_int_dataTe.loc[null_row_list[i],'FireplaceQu'] = res[i]\n    except:\n      print('error')\n  return all_int_dataTe['FireplaceQu']\ndata['FireplaceQu'] = classify_missing(fireplace_data)","d2f84714":"(((data.isnull().sum())*100)\/len(data)).sort_values(\n            ascending = False, kind = 'mergesort').head(15)","b48b7588":"<h1> Replace Null <\/h1>","9655ae02":"<h1> Import Lib <\/h1>","413f49c5":"<h1> Loda Data <\/h1>","4ab344f7":"<h1>Check Null<\/h1>"}}