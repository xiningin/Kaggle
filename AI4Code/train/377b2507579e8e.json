{"cell_type":{"b730bb08":"code","b4e083aa":"code","3bdcadc0":"code","aebc1b4a":"code","a6d42984":"code","886ba849":"code","3e06eb45":"code","2156c5d7":"code","48920fe5":"code","dd9cc371":"code","230807d7":"code","ecabadfe":"code","024ecb1d":"code","39db55d9":"code","4f6e745f":"code","01ddd357":"code","f770aee4":"code","b0dc76bd":"code","d9818c0f":"code","2fe2e4c6":"code","9f7da810":"code","2b841b44":"code","eecd32fc":"code","34f13918":"code","0f88f801":"code","da5c0e41":"code","e3030bc1":"code","e6a0aa1e":"code","ae323190":"code","7bc33404":"code","a1c81850":"code","8b67542f":"code","2b77b435":"code","eddf1dc4":"code","1e192436":"code","12cd7d02":"code","7f3017f4":"code","534ee02a":"code","b6528c3a":"code","e05ca27c":"code","f15324fc":"code","02c4edb3":"code","59f9016d":"code","9b12d6ff":"code","b54c5e27":"code","b85800e2":"code","6086fd81":"code","0cdc797b":"code","d490746e":"code","d89e932c":"code","e3d5b24e":"code","a82dee2c":"code","01759ddf":"code","129ec14a":"code","bce0da4d":"code","1ebebbc6":"code","bf7dc126":"code","320b835d":"code","8e797d02":"code","387453ef":"code","5709c51b":"code","37de19be":"code","fe9b4db2":"code","8f69fe2d":"code","42be42e5":"code","056f5fc6":"code","3c713224":"code","4c40a4ac":"code","4ac303f3":"code","e285369b":"code","f9c72b7e":"code","d806caff":"code","b0f3d4f3":"code","66548379":"code","f7152de3":"code","226020be":"code","482b6a0b":"code","97a81250":"code","49e77405":"code","3921b615":"code","cb6fdbb2":"code","fdc35987":"code","9bd3bb02":"code","675a39f1":"code","e16352a6":"code","d6cfaa64":"code","a3673574":"code","e3d68ec3":"code","38a838ca":"code","8734d53f":"code","34743731":"code","ec5d1998":"code","db5d65ed":"code","1aef7f49":"code","57c84a69":"code","bb2ca79b":"code","66abecd2":"code","be9bf3a3":"code","73b6a5f0":"code","02533564":"code","755ffa63":"code","42dc970c":"code","9ed5b190":"code","2208fd1d":"code","affe14ba":"code","0a3f8f74":"code","c8f8605f":"code","80cad75d":"code","008a6461":"code","792f2fa3":"code","e588b4db":"code","cee649fa":"code","ef1c0277":"code","0765c1da":"code","42a99a6b":"code","ae7dc689":"code","32edca56":"code","0960e9a0":"code","08fa248d":"code","d145e4d7":"code","d919e1c0":"code","17ac84a7":"code","0dca0ce0":"code","7672a878":"markdown","fb022bd6":"markdown","e4dfe5e0":"markdown","9e7062e7":"markdown","a4979886":"markdown","6f566b2d":"markdown","35a60b8f":"markdown","5e23a7a4":"markdown","1d34f443":"markdown","6bb1bae8":"markdown","a202646b":"markdown","e46be340":"markdown","11e8ee40":"markdown","9df47722":"markdown","16ed4354":"markdown","c7faadda":"markdown","419e973a":"markdown","0bab5ad2":"markdown","cae50629":"markdown","c5039bec":"markdown","3ba0e4c4":"markdown","b8ac4317":"markdown","9b58e946":"markdown","d368a4b8":"markdown","672c294f":"markdown","2a24d24f":"markdown","023d0096":"markdown","f7338e52":"markdown","a32f47fc":"markdown","620034c8":"markdown","a7e9b3cb":"markdown","1eefe653":"markdown","50e82714":"markdown","2575b652":"markdown","153ef978":"markdown","44fb69a8":"markdown","be04b971":"markdown","278969ef":"markdown","7a817fb9":"markdown","2cfea9ad":"markdown","01443f8a":"markdown","54eaf189":"markdown","99a8049e":"markdown","3e1a8de5":"markdown","823e1210":"markdown","70871e49":"markdown","2568f7a0":"markdown","da7bb021":"markdown","1dc5297a":"markdown","e4eae02a":"markdown","010918f5":"markdown","51253976":"markdown","0a1a7221":"markdown","ffa0ae7e":"markdown","0dd0ac76":"markdown","b755edee":"markdown","57aaf6c9":"markdown","a98f2f03":"markdown","76785cda":"markdown"},"source":{"b730bb08":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","b4e083aa":"#importing data from CSV file into pandas dataframe\n\nimport numpy as np\nimport pandas as pd\nimport matplotlib as mpl\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n \napplication_data = pd.read_csv('\/kaggle\/input\/application_data.csv')\napplication_data.head()","3bdcadc0":"application_data.shape","aebc1b4a":"application_data.dtypes.value_counts()","a6d42984":"# Get the count,size and unique values in each column of application data\napplication_data.agg(['count','size','nunique'])","886ba849":"defaulters=application_data[application_data.TARGET==1]\nnondefaulters=application_data[application_data.TARGET==0]","3e06eb45":"sns.countplot(application_data.TARGET)\nplt.xlabel(\"TARGET Value\")\nplt.ylabel(\"Count of TARGET\")\nplt.title(\"Distribution of TARGET Variable\")\nplt.show()","2156c5d7":"percentage_defaulters=(len(defaulters)*100)\/len(application_data)\npercentage_nondefaulters=(len(nondefaulters)*100)\/len(application_data)\n\nprint(\"The Percentage of people who have paid their loan is:\",round(percentage_nondefaulters,2),\"%\")\nprint(\"The Percentage of people who have NOT paid their loan is:\",round(percentage_defaulters,2),\"%\")\nprint(\"The Ratio of Data Imbalance is:\",round(len(nondefaulters)\/len(defaulters),2))","48920fe5":"#Function to calculate meta-data to identify % of data is missing in each column\ndef meta_data(data):\n    total = data.isnull().sum()\n    percent = (data.isnull().sum()\/data.isnull().count()*100)\n    unique = data.nunique()\n    datatypes = data.dtypes\n    return pd.concat([total, percent, unique, datatypes], axis=1, keys=['Total', 'Percent', 'Unique', 'Data_Type']).sort_values(by=\"Percent\", ascending=False)","dd9cc371":"#calculating meta-data for application_data\napp_meta_data=meta_data(application_data)\napp_meta_data.head(20)","230807d7":"#dropping columns with more than 57% missing values \n#Selected 57% because we don't want to drop EXT_SOURCE_1 which is an important variable\ncols_to_keep=list(app_meta_data[(app_meta_data.Percent<57)].index)\napplication_data=application_data[cols_to_keep]\napplication_data.describe()","ecabadfe":"#Checking columns with very less missing values\nlow_missing=pd.DataFrame(app_meta_data[(app_meta_data.Percent>0)&(app_meta_data.Percent<15)])\nlow_missing","024ecb1d":"application_data.select_dtypes('object').columns","39db55d9":"application_data.select_dtypes('float64').columns","4f6e745f":"application_data.select_dtypes('int64').columns","01ddd357":"application_data.select_dtypes('int64').apply(pd.Series.nunique, axis = 0)","f770aee4":"#columns to convert\ncols_to_convert=list(app_meta_data[(app_meta_data.Unique==2)&(app_meta_data.Data_Type==\"int64\")].index)\n\n#function to conver columns\ndef convert_data(application_data, cols_to_convert):\n    for y in cols_to_convert:\n        application_data.loc[:,y].replace((0, 1), ('N', 'Y'), inplace=True)\n    return application_data\n\n#calling the function for application_data\nconvert_data(application_data, cols_to_convert)\napplication_data.TARGET.replace(('N', 'Y'), (0, 1), inplace=True)\napplication_data.dtypes.value_counts()","b0dc76bd":"defaulters=application_data[application_data.TARGET==1]\n\nnondefaulters=application_data[application_data.TARGET==0]","d9818c0f":"application_data.select_dtypes('object').columns","2fe2e4c6":"## FUNCTION TO PLOT CHARTS\n\ndef plot_charts(var, label_rotation,horizontal_layout):\n    if(horizontal_layout):\n        fig, (ax1, ax2) = plt.subplots(ncols=2, figsize=(10,5))\n    else:\n        fig, (ax1, ax2) = plt.subplots(nrows=2, figsize=(15,20))\n    \n    s1=sns.countplot(ax=ax1,x=defaulters[var], data=defaulters, order= defaulters[var].value_counts().index,)\n    ax1.set_title('Distribution of '+ '%s' %var +' for Defaulters', fontsize=10)\n    ax1.set_xlabel('%s' %var)\n    ax1.set_ylabel(\"Count of Loans\")\n    if(label_rotation):\n        s1.set_xticklabels(s1.get_xticklabels(),rotation=90)\n    s2=sns.countplot(ax=ax2,x=nondefaulters[var], data=nondefaulters, order= nondefaulters[var].value_counts().index,)\n    if(label_rotation):\n        s2.set_xticklabels(s2.get_xticklabels(),rotation=90)\n    ax2.set_xlabel('%s' %var)\n    ax2.set_ylabel(\"Count of Loans\")\n    ax2.set_title('Distribution of '+ '%s' %var +' for Non-Defaulters', fontsize=10)\n    plt.show()","9f7da810":"plot_charts('NAME_CONTRACT_TYPE', label_rotation=False,horizontal_layout=True)","2b841b44":"plot_charts('CODE_GENDER', label_rotation=False,horizontal_layout=True)","eecd32fc":"plot_charts('FLAG_OWN_REALTY', label_rotation=False,horizontal_layout=True)\nplot_charts('FLAG_OWN_CAR', label_rotation=False,horizontal_layout=True)","34f13918":"plot_charts('REG_CITY_NOT_LIVE_CITY', label_rotation=False,horizontal_layout=True)\nplot_charts('REG_CITY_NOT_WORK_CITY', label_rotation=True,horizontal_layout=True)","0f88f801":"plot_charts('NAME_HOUSING_TYPE', label_rotation=True,horizontal_layout=True)","da5c0e41":"plot_charts('NAME_FAMILY_STATUS', label_rotation=True,horizontal_layout=True)","e3030bc1":"plot_charts('NAME_EDUCATION_TYPE', label_rotation=True,horizontal_layout=True)","e6a0aa1e":"plot_charts('NAME_INCOME_TYPE', label_rotation=True,horizontal_layout=True)","ae323190":"plot_charts('WALLSMATERIAL_MODE', label_rotation=True,horizontal_layout=True)","7bc33404":"plot_charts('ORGANIZATION_TYPE', label_rotation=True,horizontal_layout=False)","a1c81850":"plot_charts('FLAG_WORK_PHONE', label_rotation=True,horizontal_layout=True)","8b67542f":"plot_charts('NAME_INCOME_TYPE', label_rotation=True,horizontal_layout=True)","2b77b435":"plot_charts('OCCUPATION_TYPE', label_rotation=True,horizontal_layout=True)","eddf1dc4":"application_data.select_dtypes('float64').columns","1e192436":"application_data.select_dtypes('int64').columns","12cd7d02":"## FUNCTION FOR PLOTTING BOX PLOT AND HISTOGRAM\n\ndef plot_boxhist(var):\n    plt.figure(figsize=(15,5))\n    plt.subplot(1, 2, 1)\n    s=sns.boxplot(y=defaulters[var]);\n    plt.title('Box Plot of '+ '%s' %var +' for Defaulters', fontsize=10)\n    plt.xlabel('%s' %var)\n    plt.ylabel(\"Count of Loans\")\n    plt.subplot(1, 2, 2)\n    s=plt.hist(x=defaulters[var]);\n    plt.xlabel('%s' %var)\n    plt.ylabel(\"Count of Loans\")\n    plt.title('Histogram of '+ '%s' %var +' for Defaulters', fontsize=10)\nplt.show()","7f3017f4":"plot_boxhist('AMT_INCOME_TOTAL')","534ee02a":"#Removing all entries above 99 percentile\napplication_data=application_data[application_data.AMT_INCOME_TOTAL<np.nanpercentile(application_data['AMT_INCOME_TOTAL'], 99)]\n\n#update dataframes\ndefaulters=application_data[application_data.TARGET==1] \nnondefaulters=application_data[application_data.TARGET==0]\n\nplot_boxhist('AMT_INCOME_TOTAL')","b6528c3a":"plot_boxhist('AMT_CREDIT')","e05ca27c":"#Removing all entries above 99 percentile\napplication_data=application_data[application_data.AMT_CREDIT<np.nanpercentile(application_data['AMT_CREDIT'], 99)]\n\n#update dataframes\ndefaulters=application_data[application_data.TARGET==1] \nnondefaulters=application_data[application_data.TARGET==0]\n\nplot_boxhist('AMT_CREDIT')","f15324fc":"plot_boxhist('AMT_ANNUITY')","02c4edb3":"#Removing all entries above 99 percentile\napplication_data=application_data[application_data.AMT_ANNUITY<np.nanpercentile(application_data['AMT_ANNUITY'], 90)]\n\n#update dataframes\ndefaulters=application_data[application_data.TARGET==1] \nnondefaulters=application_data[application_data.TARGET==0]\n\nplot_boxhist('AMT_ANNUITY')","59f9016d":"#Deriving new metric Age from Days Birth\napplication_data['AGE'] = application_data['DAYS_BIRTH'] \/ -365\nplt.hist(application_data['AGE']);\nplt.title('Histogram of age in years.');","9b12d6ff":"sns.boxplot(y=application_data['DAYS_EMPLOYED']);\nplt.title('Length of days employed before loan.');","b54c5e27":"application_data['DAYS_EMPLOYED'].describe()","b85800e2":"application_data['DAYS_EMPLOYED']=application_data['DAYS_EMPLOYED'].replace(365243, np.nan)\napplication_data['DAYS_EMPLOYED'].describe()","6086fd81":"#Deriving variable \"Years Employed\" from days employed\napplication_data['YEARS_EMPLOYED'] = (application_data['DAYS_EMPLOYED']\/-365)\n\n#update dataframes\ndefaulters=application_data[application_data.TARGET==1] \nnondefaulters=application_data[application_data.TARGET==0]","0cdc797b":"plot_boxhist('YEARS_EMPLOYED')","d490746e":"application_data.groupby(['NAME_INCOME_TYPE']).agg({'YEARS_EMPLOYED': ['mean', 'median', 'count', 'max'], 'AGE': ['median']})","d89e932c":"application_data.groupby(['NAME_EDUCATION_TYPE', 'NAME_INCOME_TYPE']).agg({'AMT_INCOME_TOTAL': ['mean', 'median', 'count', 'max']})","e3d5b24e":"application_data['AMT_INCOME_TOTAL'].describe()","a82dee2c":"defaulters.loc[:,'INCOME_BRACKET']=pd.qcut(application_data.loc[:,'AMT_INCOME_TOTAL'],q=[0,0.10,0.35,0.50,0.90,1], labels=['Very_low','Low','Medium','High','Very_high'])\nnondefaulters.loc[:,'INCOME_BRACKET']=pd.qcut(application_data.loc[:,'AMT_INCOME_TOTAL'],q=[0,0.10,0.35,0.50,0.90,1], labels=['Very_low','Low','Medium','High','Very_high'])","01759ddf":"plot_charts('INCOME_BRACKET', label_rotation=True,horizontal_layout=True)","129ec14a":"defaulters.loc[:,'Rating1']=pd.cut(application_data.loc[:,'EXT_SOURCE_1'],[0,0.10,0.35,0.50,0.80,1], labels=['Very_low','Low','Medium','High','Very_high'])\nnondefaulters.loc[:,'Rating1']=pd.cut(application_data.loc[:,'EXT_SOURCE_1'],[0,0.10,0.35,0.50,0.80,1], labels=['Very_low','Low','Medium','High','Very_high'])","bce0da4d":"plot_charts('Rating1', label_rotation=True,horizontal_layout=True)","1ebebbc6":"defaulters.loc[:,'Rating2']=pd.cut(application_data.loc[:,'EXT_SOURCE_2'],[0,0.10,0.35,0.50,0.80,1], labels=['Very_low','Low','Medium','High','Very_high'])\nnondefaulters.loc[:,'Rating2']=pd.cut(application_data.loc[:,'EXT_SOURCE_2'],[0,0.10,0.35,0.50,0.80,1], labels=['Very_low','Low','Medium','High','Very_high'])","bf7dc126":"plot_charts('Rating2', label_rotation=True,horizontal_layout=True)","320b835d":"defaulters.loc[:,'Rating3']=pd.cut(application_data.loc[:,'EXT_SOURCE_3'], [0,0.10,0.35,0.50,0.80,1], labels=['Very_low','Low','Medium','High','Very_high'])\nnondefaulters.loc[:,'Rating3']=pd.cut(application_data.loc[:,'EXT_SOURCE_3'], [0,0.10,0.35,0.50,0.80,1], labels=['Very_low','Low','Medium','High','Very_high'])","8e797d02":"plot_charts('Rating3', label_rotation=True,horizontal_layout=True)","387453ef":"defaulters.loc[:,'AMT_ANNUITY_BINS']=pd.qcut(application_data.loc[:,'AMT_ANNUITY'], [0,0.30,0.50,0.85,0.1], labels=['Low','Medium','High','Very_High'])\nnondefaulters.loc[:,'AMT_ANNUITY_BINS']=pd.qcut(application_data.loc[:,'AMT_ANNUITY'], [0,0.30,0.50,0.85,1], labels=['Low','Medium','High','Very_High'])","5709c51b":"plot_charts('AMT_ANNUITY_BINS', label_rotation=False,horizontal_layout=True)","37de19be":"age_data = application_data.loc[:,['TARGET', 'DAYS_BIRTH']]\nage_data.loc[:,'YEARS_BIRTH'] = application_data.loc[:,'DAYS_BIRTH']\/ -365\n# Bin the age data\nage_data.loc[:,'YEARS_BINNED'] = pd.cut(age_data.loc[:,'YEARS_BIRTH'], bins = np.linspace(20, 70, num = 11))\nage_data.head(10)","fe9b4db2":"age_groups  = age_data.groupby('YEARS_BINNED').mean()\nage_groups","8f69fe2d":"plt.figure(figsize = (8, 8))\n\n# Graph the age bins and the average of the target as a bar plot\nplt.bar(age_groups.index.astype(str), 100 * age_groups['TARGET'])\n\n# Plot labeling\nplt.xticks(rotation = 75); plt.xlabel('Age Group (years)'); plt.ylabel('Failure to Repay (%)')\nplt.title('Failure to Repay by Age Group');","42be42e5":"#selecting columns for correlation, removing cols for floor and house ec\n\ncols=['EXT_SOURCE_1', 'EXT_SOURCE_3', 'EXT_SOURCE_2',\n       'AMT_GOODS_PRICE', 'AMT_ANNUITY', 'CNT_FAM_MEMBERS',\n       'DAYS_LAST_PHONE_CHANGE', 'AMT_CREDIT', 'AMT_INCOME_TOTAL',\n       'DAYS_REGISTRATION', 'REGION_POPULATION_RELATIVE','CNT_CHILDREN', 'HOUR_APPR_PROCESS_START',\n       'REGION_RATING_CLIENT_W_CITY', 'REGION_RATING_CLIENT',\n       'DAYS_ID_PUBLISH', 'DAYS_EMPLOYED', 'DAYS_BIRTH']","056f5fc6":"defaulters_1=defaulters[cols]\ndefaulters_correlation = defaulters_1.corr()\nround(defaulters_correlation, 3)","3c713224":"defaulters_correlation.head(10).index","4c40a4ac":"c1=defaulters_correlation.unstack()\nc1.sort_values(ascending=False).drop_duplicates().head(10)","4ac303f3":"c1.sort_values(ascending=False).drop_duplicates().tail(10)","e285369b":"# figure size\nplt.figure(figsize=(30,20))\n\n# heatmap\nsns.heatmap(defaulters_correlation, cmap=\"YlGnBu\", annot=True)\nplt.show()","f9c72b7e":"nondefaulters_1=nondefaulters[cols]\nnondefaulters_correlation = nondefaulters_1.corr()\nround(nondefaulters_correlation, 3)","d806caff":"nondefaulters_correlation.head(10).index","b0f3d4f3":"c2=nondefaulters_correlation.unstack()\nc2.sort_values(ascending=False).drop_duplicates().head(10)","66548379":"c2.sort_values(ascending=False).drop_duplicates().tail(10)","f7152de3":"# figure size\nplt.figure(figsize=(30,20))\n\n# heatmap\nsns.heatmap(nondefaulters_correlation, cmap=\"YlGnBu\", annot=True)\nplt.show()","226020be":"#importing data from CSV file into pandas dataframe\n\nimport numpy as np\nimport pandas as pd\nimport matplotlib as mpl\nimport matplotlib.pyplot as plt\n\n \nprevious_data = pd.read_csv('\/kaggle\/input\/previous_application.csv')\nprevious_data.head()","482b6a0b":"previous_data.shape","97a81250":"application_data.dtypes.value_counts()","49e77405":"previous_data.columns","3921b615":"previous_data.info()","cb6fdbb2":"previous_data.NAME_CONTRACT_STATUS.unique()","fdc35987":"import matplotlib\nsns.countplot(previous_data.NAME_CONTRACT_STATUS)\nplt.xlabel(\"Contract Status\")\nplt.ylabel(\"Count of Contract Status\")\nplt.title(\"Distribution of Contract Status\")\nplt.show()","9bd3bb02":"prev_meta_data=meta_data(previous_data)\nprev_meta_data.reset_index(drop=False).head(20)","675a39f1":"#dropping columns with more than 55% missing values \ncols_to_keep=list(prev_meta_data[(prev_meta_data.Percent<55)].index)\nprevious_data=previous_data[cols_to_keep]\nprevious_data.describe()","e16352a6":"#Checking columns with very less missing values\nlow_missing=pd.DataFrame(prev_meta_data[(prev_meta_data.Percent>0)&(prev_meta_data.Percent<15)])\nlow_missing","d6cfaa64":"cols_to_convert=list(prev_meta_data[(prev_meta_data.Unique==2)&((prev_meta_data.Data_Type==\"int64\")|(prev_meta_data.Data_Type==\"float64\"))].index)\ncols_to_convert","a3673574":"def convert_data(previous_data, cols_to_convert):\n    for y in cols_to_convert:\n        previous_data.loc[:,y].replace((0, 1), ('N', 'Y'), inplace=True)\n    return previous_data\nconvert_data(previous_data, cols_to_convert)\nprevious_data.dtypes.value_counts()","e3d68ec3":"approved=previous_data[previous_data.NAME_CONTRACT_STATUS=='Approved']\nrefused=previous_data[previous_data.NAME_CONTRACT_STATUS=='Refused']\ncanceled=previous_data[previous_data.NAME_CONTRACT_STATUS=='Canceled']\nunused=previous_data[previous_data.NAME_CONTRACT_STATUS=='Unused Offer']","38a838ca":"percentage_approved=(len(approved)*100)\/len(previous_data)\npercentage_refused=(len(refused)*100)\/len(previous_data)\npercentage_canceled=(len(canceled)*100)\/len(previous_data)\npercentage_unused=(len(unused)*100)\/len(previous_data)\n\nprint(\"The Percentage of people whose loans have been Approved is:\",round(percentage_approved,2),\"%\")\nprint(\"The Percentage of people whose loans have been Refused is:\",round(percentage_refused,2),\"%\")\nprint(\"The Percentage of people whose loans have been Canceled is:\",round(percentage_canceled,2),\"%\")\nprint(\"The Percentage of people whose loans have been Unused is:\",round(percentage_unused,2),\"%\")","8734d53f":"def plot_3charts(var, label_rotation,horizontal_layout):\n    if(horizontal_layout):\n        fig, (ax1, ax2, ax3) = plt.subplots(ncols=3, figsize=(15,5))\n    else:\n        fig, (ax1, ax2, ax3) = plt.subplots(nrows=3, figsize=(15,30))\n    \n    s1=sns.countplot(ax=ax1,x=refused[var], data=refused, order= refused[var].value_counts().index,)\n    ax1.set_title(\"Refused\", fontsize=10)\n    ax1.set_xlabel('%s' %var)\n    ax1.set_ylabel(\"Count of Loans\")\n    if(label_rotation):\n        s1.set_xticklabels(s1.get_xticklabels(),rotation=90)\n    \n    s2=sns.countplot(ax=ax2,x=approved[var], data=approved, order= approved[var].value_counts().index,)\n    if(label_rotation):\n        s2.set_xticklabels(s2.get_xticklabels(),rotation=90)\n    ax2.set_xlabel('%s' %var)\n    ax2.set_ylabel(\"Count of Loans\")\n    ax2.set_title(\"Approved\", fontsize=10)\n    \n    \n    s3=sns.countplot(ax=ax3,x=canceled[var], data=canceled, order= canceled[var].value_counts().index,)\n    ax3.set_title(\"Canceled\", fontsize=10)\n    ax3.set_xlabel('%s' %var)\n    ax3.set_ylabel(\"Count of Loans\")\n    if(label_rotation):\n        s3.set_xticklabels(s3.get_xticklabels(),rotation=90)\n    plt.show()","34743731":"previous_data.select_dtypes('object').columns","ec5d1998":"plot_3charts('PRODUCT_COMBINATION', label_rotation=True,horizontal_layout=True)","db5d65ed":"plot_3charts('NAME_YIELD_GROUP', label_rotation=True,horizontal_layout=True)","1aef7f49":"plot_3charts('NAME_PORTFOLIO', label_rotation=True,horizontal_layout=True)","57c84a69":"plot_3charts('CHANNEL_TYPE', label_rotation=True,horizontal_layout=True)","bb2ca79b":"plot_3charts('NAME_PRODUCT_TYPE', label_rotation=True,horizontal_layout=True)","66abecd2":"plot_3charts('NAME_PAYMENT_TYPE', label_rotation=True,horizontal_layout=True)","be9bf3a3":"plot_3charts('NAME_CONTRACT_TYPE', label_rotation=True,horizontal_layout=True)","73b6a5f0":"plot_3charts('NAME_CLIENT_TYPE', label_rotation=True,horizontal_layout=True)","02533564":"sns.countplot(x=approved['NAME_CLIENT_TYPE'], data=previous_data)","755ffa63":"fig, ax = plt.subplots(figsize = (30, 8))\nplt.subplot(1, 2, 1)\nsns.boxplot(y=approved['AMT_ANNUITY']);\nplt.subplot(1, 2, 2)\nplt.hist(approved['AMT_ANNUITY'])\nplt.title('AMT_ANNUITY')\nplt.show()","42dc970c":"approved=approved[approved.AMT_ANNUITY<np.nanpercentile(approved['AMT_ANNUITY'], 99)]\nfig, ax = plt.subplots(figsize = (30, 8))\nax.set_title('AMT_ANNUITY boxplot on data within 99 percentile');\nplt.subplot(1, 2, 1)\nsns.boxplot(y=approved['AMT_ANNUITY']);\nplt.subplot(1, 2, 2)\nplt.hist(approved['AMT_ANNUITY'])\nax.set_title('AMT_ANNUITY')","9ed5b190":"fig, ax = plt.subplots(figsize = (30, 8))\nplt.subplot(1, 2, 1)\nsns.boxplot(y=approved['AMT_CREDIT']);\nplt.subplot(1, 2, 2)\nplt.hist(approved['AMT_CREDIT'])\nplt.title('AMT_CREDIT')\nplt.show()","2208fd1d":"approved=approved[approved.AMT_CREDIT<np.nanpercentile(approved['AMT_CREDIT'], 90)]\nfig, ax = plt.subplots(figsize = (30, 8))\nax.set_title('AMT_CREDIT boxplot on data within 99 percentile');\nplt.subplot(1, 2, 1)\nsns.boxplot(y=approved['AMT_CREDIT']);\nplt.subplot(1, 2, 2)\nplt.hist(approved['AMT_CREDIT'])\nax.set_title('AMT_CREDIT')","affe14ba":"fig, ax = plt.subplots(figsize = (30, 8))\nplt.subplot(1, 2, 1)\nsns.boxplot(y=approved['AMT_GOODS_PRICE']);\nplt.subplot(1, 2, 2)\nplt.hist(approved['AMT_GOODS_PRICE'])\nplt.title('AMT_GOODS_PRICE')\nplt.show()","0a3f8f74":"approved=approved[approved.AMT_GOODS_PRICE<np.nanpercentile(approved['AMT_GOODS_PRICE'], 90)]\nfig, ax = plt.subplots(figsize = (30, 8))\nax.set_title('AMT_GOODS_PRICE boxplot on data within 99 percentile');\nplt.subplot(1, 2, 1)\nsns.boxplot(y=approved['AMT_GOODS_PRICE']);\nplt.subplot(1, 2, 2)\nplt.hist(approved['AMT_GOODS_PRICE'])\nax.set_title('AMT_GOODS_PRICE')","c8f8605f":"cols_approved=['AMT_DOWN_PAYMENT', 'RATE_DOWN_PAYMENT', 'DAYS_TERMINATION', 'DAYS_LAST_DUE', 'DAYS_LAST_DUE_1ST_VERSION', 'DAYS_FIRST_DUE', 'DAYS_FIRST_DRAWING', 'AMT_GOODS_PRICE', 'AMT_ANNUITY', 'CNT_PAYMENT', 'AMT_CREDIT', 'DAYS_DECISION', 'AMT_APPLICATION']\napproved_num=approved[cols_approved]\n","80cad75d":"cols_refused=['AMT_DOWN_PAYMENT', 'RATE_DOWN_PAYMENT', 'AMT_GOODS_PRICE', 'AMT_ANNUITY', 'CNT_PAYMENT', 'AMT_CREDIT', 'DAYS_DECISION', 'AMT_APPLICATION']\nrefused_num=refused[cols_refused]","008a6461":"#calculating correlation for approved\napproved_correlation = approved_num.corr()\nround(approved_correlation, 3)","792f2fa3":"c1=approved_correlation.unstack()\nc1.sort_values(ascending=False).drop_duplicates().head(10)","e588b4db":"c1.sort_values(ascending=False).drop_duplicates().tail(10)","cee649fa":"# figure size\nplt.figure(figsize=(30,20))\n\n# heatmap\nsns.heatmap(approved_correlation, cmap=\"YlGnBu\", annot=True)\nplt.show()","ef1c0277":"#calculating correlation for approved\nrefused_correlation = refused_num.corr()\nround(refused_correlation, 3)","0765c1da":"# figure size\nplt.figure(figsize=(30,20))\n\n# heatmap\nsns.heatmap(refused_correlation, cmap=\"YlGnBu\", annot=True)\nplt.show()","42a99a6b":"c2=refused_correlation.unstack()\nc2.sort_values(ascending=False).drop_duplicates().head(10)","ae7dc689":"c2.sort_values(ascending=False).drop_duplicates().tail(10)","32edca56":"def has_terminated(x):\n    if x < 0:\n        return 'Loan Terminated'\n    else:\n        return 'Loan Open'\n    \napproved['CURRENT_STATUS'] = approved['DAYS_TERMINATION'].apply(has_terminated) ","0960e9a0":"plt.figure(figsize=(5,5))\nsns.countplot(x=approved['CURRENT_STATUS'], data=approved)\nplt.show()","08fa248d":"new_df= previous_data.pivot_table(values = 'NAME_CONTRACT_STATUS', index = 'SK_ID_CURR', aggfunc = 'count')\nnew_df=new_df.reset_index(drop=False)\nnew_df.rename(columns = {'NAME_CONTRACT_STATUS':'Count of Refused Loans'}, inplace = True)","d145e4d7":"merged_df1=pd.merge(new_df, pd.DataFrame(application_data[['SK_ID_CURR','TARGET']]), how='inner', on='SK_ID_CURR')","d919e1c0":"merged_df1=merged_df1[merged_df1['Count of Refused Loans']!=0]","17ac84a7":"merged_df1.head()","0dca0ce0":"merged_df1[merged_df1['TARGET']==0].head()","7672a878":"#### Driver Variables\n1. EXT_SOURCE_1\n2. EXT_SOURCE_2\n3. EXT_SOURCE_3\n4. DAYS_BIRTH\n5. AMT_ANNUITY","fb022bd6":"> we observe that the credit amount lies between 250000 to around 500000 for defaulters","e4dfe5e0":"### Business Objectives\nThis case study aims to identify patterns which indicate if a client has difficulty paying their installments which may be used for taking actions such as denying the loan, reducing the amount of loan, lending (to risky applicants) at a higher interest rate, etc. This will ensure that the consumers capable of repaying the loan are not rejected. Identification of such applicants using EDA is the aim of this case study.\n \nIn other words, the company wants to understand the driving factors (or driver variables) behind loan default, i.e. the variables which are strong indicators of default.  The company can utilise this knowledge for its portfolio and risk assessment.","9e7062e7":"> While the category with highest count remains same. \n1. This chart tells us that people with Academic Degree rarely take loans and are rarely defaulters. So they are potentially good customers.\n2. People with higher education are less likely to have payment difficulties. The Ratio is higher for non-defaulters than defaulters.","a4979886":"> Observation:\n1. Most people live in a House\/Apartment\n2. Ratio of People who live **With Parents** is more for defaulter than non-defaulters. It tells us that applicant who live with parents have a higher chance of having payment difficulties.","6f566b2d":"### <font color=maroon>Binning of Continuous Variables<\/font>","35a60b8f":"We observe that the Ratio of people whose **Registration City is not the same as live city or work city** is higher in case of defaulters are compared to defaulters.\n> It tells us that people who live or work in a city different than the registration city are more likely to have payment difficulties.","5e23a7a4":"- Most approved loans were **POS**\n- Most refused loans were **Cash**","1d34f443":"#### <font color=maroon>Loading data and normal routine check <\/font>","6bb1bae8":"> We observe that the number of **Females** taking loans is much higher than the number of **Males** for both Target = 0 and Target = 1","a202646b":"**maxinum number of defaulters have Low_annuity Values, while maximum number of non-defaulters have high annuity**","e46be340":"> We can see that most of the loans are taken by working people with secondary education.","11e8ee40":"### <font color=maroon>Univariate Analyis on Categorical Columns<\/font>","9df47722":"We observe that the number of most people applying for loan **do not own a car.** \n\n> We also observe that the **ratio of people who own a car is higher for non-defaulters**","16ed4354":"> This tell us that most people with payment have incomes in the lower range between 100000 to 200000 which some on the higher end some on the lower","c7faadda":"**From this information, we see this is an imbalanced dataset. There are far more loans that were repaid on time than loans that were not repaid.**\n\n**More than 25000 loans were repaid, Less than 5000 loans were not repaid.**","419e973a":"#### <font color=maroon>Dropping columns with High Missing Values<\/font>","0bab5ad2":"#### <font color=maroon>Checking columns with very less missing values<\/font>","cae50629":"**This dataset for application data has:**\n\n- <font color=navy>**307511 rows**<\/font>\n- <font color=navy>**122 columns**<\/font>","c5039bec":"#### 5 most positive correlations\n1. AMT_CREDIT - AMT_GOODS_PRICE\n2. REGION_RATING_CLIENT_W_CITY - REGION_RATING_CLIENT\n3. CNT_CHILDREN - CNT_FAM_MEMBERS\n4. AMT_CREDIT - AMT_ANNUITY\n5. AMT_GOODS_PRICE - AMT_ANNUITY","3ba0e4c4":"## CREDIT EDA CASE STUDY","b8ac4317":"#### <font color=maroon>Identifying missing values in each column<\/font>","9b58e946":"Ratio of **Single\/Unmarried** people is more in the left graph.\n> Single\/Unmarried people are more likely to have payment difficulties","d368a4b8":"### <font color = blue>Analysis of Application_Data <\/font>","672c294f":"### BIVARIATE ANALYSIS OF VARIABLES","2a24d24f":"**A large number of defaulters have very Low rating, while a large number of non-defaulters have a high rating.**\n","023d0096":"#### <font color=maroon>Explanation for treatment of columns with low missing values<\/font>\n\n1. AMT_REQ_CREDIT_BUREAU_HOUR\n2. AMT_REQ_CREDIT_BUREAU_DAY\n3. AMT_REQ_CREDIT_BUREAU_WEEK\n4. AMT_REQ_CREDIT_BUREAU_MON\n5. AMT_REQ_CREDIT_BUREAU_QRT\n6. AMT_REQ_CREDIT_BUREAU_YEAR\n\n**We can impute missing values in these columns above with 0s and assume that no enquiry was made during the time reflected in null rows.**\n\n\n1. NAME_TYPE_SUITE - we should leave empty values as it is or impute it with \"Others A\" or \"Others B\" depending on what they mean.\n2. OBS_30_CNT_SOCIAL_CIRCLE & related fields. \n3. EXT_SOURCE_2 \n4. AMT_GOODS_PRICE \n5. CNT_FAM_MEMBERS\n6. AMT_ANNUITY\n7. DAYS_LAST_PHONE_CHANGE\n\n\n**We should not add any additional info in missing values of these columns above as it would lead to noise and exaggeration.**","f7338e52":"> Both of these columns should not be imputed with any values","a32f47fc":"### <font color=maroon>Univariate & Bivariate Analyis on Numeric Columns<\/font>","620034c8":"**A lot of the int columns look like Flags, let check their unique values**","a7e9b3cb":"**Getting a list of columns with dtype=object, to identify columns for categorical analysis**","1eefe653":"### <font color=navy> Analysis of Previous Application Dataset<\/font>","50e82714":"- Most approved loans were from **Country-wide** Channel\n- Most refused loans were from **Credit and Cash Offices** Channel","2575b652":"**<font color = navy>We can see that there are:**<\/font>\n- **<font color = navy>65 columns with dtype=float64**<\/font>\n- **<font color = navy>41 columns with dtype=int64**<\/font>\n- **<font color = navy>16 columns with dtype=object<\/font>**","153ef978":"**Getting a list of columns with dtype=object, to identify columns for analysis**","44fb69a8":"> We observe that the number of **Cash loans** is much higher than the number of **Revolving loans** for both Target = 0 and Target = 1","be04b971":"> This interesting chart tells us that most defaulters have houses made of stone and brick while most non-defaulters have houses made of Panel","278969ef":"> A large number of entries have 0 which means, a lot of people don't work.","7a817fb9":"> We see that Pensioners comprise a lot of non-working people, which is normal. Working people seemed to have worked for many years.","2cfea9ad":"**A large number of defaulters have very Low rating, while a large number of non-defaulters have a high rating.**\n","01443f8a":"#### <font color=maroon>Let's take look at all the columns names for different data types <\/font>","54eaf189":"#### Identifying missing values and filtering out columns with high missing values","99a8049e":"**<font color=navy>Notice a lot of \"int\" columns have 2 unique values. These are flags or Flag type varibles. Which have no use in bivariate analysis. These can be converted to Yes\/No values for categorical analysis.<\/font>**","3e1a8de5":"### <font color=Maroon>Analysis of Continuous variables for TARGET=1 and TARGET=0<\/font>","823e1210":"**<font color = navy>We can see that there are:**<\/font>\n- **<font color = navy>65 columns with dtype=float64**<\/font>\n- **<font color = navy>41 columns with dtype=int64**<\/font>\n- **<font color = navy>16 columns with dtype=object<\/font>**","70871e49":"### <font color=maroon>REMOVING OUTLIERS <\/font>","2568f7a0":"> Commercial associates, Pensioner, State Servants have a higher ratio to total in non-defaulters.","da7bb021":"#### <font color=maroon>Checking Distribution of Target Variable<\/font>","1dc5297a":"> Age seems to be fairly distributed","e4eae02a":"## <font color=navy>Removing Outliers<\/font>","010918f5":"- We observe most number of loans were approved for POS household with interest.\n- Most number of refused loans were of Cash X-Sell: Low Product combination\n- Most Canceled loans were Cash loans","51253976":"> There is an outlier here. The max value is 365243 days which is not practically possible. \n> This might be an error and we can replace this value with null","0a1a7221":"> We can see that there are some outliers and the graph looks like this to accomodate those outliers.","ffa0ae7e":"**A large number of defaulters have Low rating, while a large number of non-defaulters have a high rating.**","0dd0ac76":"> Maximum Failure to Repay is in Age Group 20-25","b755edee":"### <font color=Navy> Bi-Variate Analysis of Variables<\/font>","57aaf6c9":"- Most approved loans were from **Middle** Yield Goup\n- Most refused loans were from Yield Goups Not specified","a98f2f03":"<font color=navy>**This dataset for application data has:**<\/font>\n- <font color=navy>**1670214 rows**<\/font>\n- <font color=navy>**37 columns**<\/font>","76785cda":"#### 5 most negative correlations\n1. HOUR_APPR_PROCESS_START - REGION_RATING_CLIENT_W_CITY\n2. REGION_RATING_CLIENT - HOUR_APPR_PROCESS_START\n3. REGION_POPULATION_RELATIVE - REGION_RATING_CLIENT\n4. REGION_RATING_CLIENT_W_CITY - REGION_POPULATION_RELATIVE\n5. EXT_SOURCE_1 - DAYS_BIRTH"}}