{"cell_type":{"97f39048":"code","c89f6fc8":"code","25a9d90c":"code","97e94e67":"code","984c1de8":"code","71273594":"code","b44f132e":"code","a594c61a":"code","bc058ad0":"code","a6336921":"code","f35dc502":"code","32b2273b":"code","921fa08c":"code","2d6e4502":"code","5c7389d8":"code","36b5007d":"markdown","70b28370":"markdown","36c0fff2":"markdown","9801ccb9":"markdown","8f333834":"markdown","a88c5925":"markdown","03ff84ed":"markdown","688a2660":"markdown","5756cdf1":"markdown","b4ee44b0":"markdown","040fc0bc":"markdown","69f27847":"markdown","92970e45":"markdown","45d86a64":"markdown"},"source":{"97f39048":"import pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport numpy as np\n\nfrom sklearn.linear_model import LinearRegression\n\nimport warnings\nwarnings.filterwarnings('ignore')\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","c89f6fc8":"sub=pd.read_csv(\"..\/input\/covid19-local-us-ca-forecasting-week-1\/ca_submission.csv\")\ntest=pd.read_csv(\"..\/input\/covid19-local-us-ca-forecasting-week-1\/ca_test.csv\")\ntrain=pd.read_csv(\"..\/input\/covid19-local-us-ca-forecasting-week-1\/ca_train.csv\")","25a9d90c":"print(train.shape)\ntrain.head()","97e94e67":"#Only taking data with confirmed cases\ntrain=train[train.ConfirmedCases>0]\nprint(train.shape)\ntrain.head()","984c1de8":"sns.lineplot(train.Id, train.ConfirmedCases)","71273594":"sns.regplot(train.Id, np.log(train.ConfirmedCases))","b44f132e":"model_1= LinearRegression()\nx1=np.array(train.Id).reshape(-1,1)\ny1=np.log(train.ConfirmedCases)\nmodel_1.fit(x1,y1)\nprint(\"R-squared score : \",model_1.score(x1,y1))\n\ngr=np.power(np.e, model_1.coef_[0])\nprint(\"Growth Factor : \", gr)\nprint(f\"Growth Rate : {round((gr-1)*100,2)}%\")","a594c61a":"sns.regplot(train.ConfirmedCases,train.Fatalities)","bc058ad0":"model_2= LinearRegression()\nx2=np.array(train.ConfirmedCases).reshape(-1,1)\ny2=train.Fatalities\nmodel_2.fit(x2,y2)\nprint(\"R-Squared Score= \",model_2.score(x2,y2))","a6336921":"test.head()","f35dc502":"#Making Id as unique key between test and train\ntest[\"Id\"]=50+test.ForecastId\ntest.head()","32b2273b":"test[\"LogConf\"]=model_1.predict(np.array(test.Id).reshape(-1,1))\ntest[\"ConfirmedCases\"]=np.exp(test.LogConf)\/\/1\ntest[\"Fatalities\"]=model_2.predict(np.array(test.ConfirmedCases).reshape(-1,1))\/\/1\ntest","921fa08c":"#Wherever confirmed cases and fatalities are available in train data, update it into test data\nfor id in train.Id:\n    test.ConfirmedCases[test.Id==id]=train.ConfirmedCases[train.Id==id].sum()\n    test.Fatalities[test.Id==id]=train.Fatalities[train.Id==id].sum()\ntest","2d6e4502":"### Prepare submission file","5c7389d8":"sub.ConfirmedCases=test.ConfirmedCases\nsub.Fatalities=test.Fatalities\nsub.to_csv(\"submission.csv\", index=False)","36b5007d":"### EDA train","70b28370":"### Import Libraries","36c0fff2":"### Predicting the Confirmed Cases and Fatalities for test data","9801ccb9":"### Visualization ID vs confirmed cases","8f333834":"### EDA test data","a88c5925":"### Evaluation of Regression fit","03ff84ed":"### What is the point of prediting the past!","688a2660":"### Confirmed Cases vs Fatalities","5756cdf1":"From the train data, number of fatalities varies directly proportional to Number of Confirmed cases.\n* Further exploration needs to be done to check how it behaves when confirmed cases overwhelms the health infrastructure.\n* This can be done using dataset of heavily affected areas with comparable health infrastructure like Italy, France, Spain etc.","b4ee44b0":"* R-squared score of 0.9968980433945356 shows that confirmed cases is increasing exponentially with index(date)\n* Growth rate for the period is 22.64%","040fc0bc":"### Read Data","69f27847":"### Visualization Id vs log(Confirmed Cases)","92970e45":"*Assumption* \n* Rate of increase in confirmed cases for ensuing period = 22.64%\n* Fatalities change linearly with confirmed cases","45d86a64":"### Evaluation of Regression fit"}}