{"cell_type":{"0d3e53d4":"code","f090ad20":"code","6acde8dc":"code","62e427a3":"code","2e934f2e":"code","f91ffe01":"code","4470a382":"code","c9564fb1":"code","1fc6cdcb":"code","26fac2a3":"code","f9f40956":"code","4582158c":"code","0868108e":"code","8a3be40d":"code","32ade1fd":"code","5d3a8fdf":"code","40efef7b":"code","511a08b5":"code","c7b32ad4":"code","93e64cb0":"code","bb20e991":"code","2fa84ced":"code","87f61ae0":"code","63f916de":"code","77022737":"code","16f35958":"code","2082b13e":"code","0a27d78f":"code","1293aba4":"code","fb3d7f08":"code","f6d007b5":"code","11e9152e":"code","80b8feec":"code","d3df65d5":"code","d80435b9":"code","38ef7ae0":"code","fa1a83e7":"code","59a1e1d4":"code","e47564de":"code","6bcb0fd0":"markdown","279938ae":"markdown","920b43b7":"markdown","c778597a":"markdown","46cbc953":"markdown","f8c5d10a":"markdown","a4243b0e":"markdown"},"source":{"0d3e53d4":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\n%matplotlib inline","f090ad20":"sns.set()","6acde8dc":"from sklearn.model_selection import train_test_split\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import classification_report,confusion_matrix\nfrom sklearn.tree import DecisionTreeClassifier","62e427a3":"data=pd.read_csv('..\/input\/stroke-prediction-dataset\/healthcare-dataset-stroke-data.csv',index_col=0)","2e934f2e":"data.head()","f91ffe01":"data.info()","4470a382":"target=data['stroke']\ntarget.value_counts()","c9564fb1":"data.drop('stroke',axis=1,inplace=True)","1fc6cdcb":"target.head()","26fac2a3":"data.head()","f9f40956":"data.isna().sum()","4582158c":"plt.figure(figsize=(15,15))\nsns.boxplot(x='bmi',data=data,y='work_type',hue='Residence_type')","0868108e":"plt.figure(figsize=(15,15))\nsns.boxplot(x='bmi',data=data,y='work_type',hue='gender')","8a3be40d":"data['work_type'].value_counts()","32ade1fd":"plt.figure(figsize=(12,6))\nsns.histplot(x='bmi',data=data,hue='ever_married')","5d3a8fdf":"temp=data[(data['work_type']=='Never_worked')]['bmi']\ntemp.isna().sum()","40efef7b":"temp1=data[(data['work_type']=='children')]['bmi'].fillna(data[(data['work_type']=='children')]['bmi'].mode()[0])\ntemp2=data[(data['work_type']=='Govt_job')]['bmi'].fillna(data[(data['work_type']=='Govt_job')]['bmi'].mode()[0])\ntemp3=data[(data['work_type']=='Self-employed')]['bmi'].fillna(data[(data['work_type']=='Self-employed')]['bmi'].mode()[0])\ntemp4=data[(data['work_type']=='Private')]['bmi'].fillna(data[(data['work_type']=='Private')]['bmi'].mode()[0])","511a08b5":"temp=pd.concat([temp,temp1,temp2,temp3,temp4])\ntemp.isna().sum()","c7b32ad4":"temp","93e64cb0":"data['bmi']=temp","bb20e991":"data.head()","2fa84ced":"gender=pd.get_dummies(data['gender'])\nmarried=pd.get_dummies(data['ever_married'],drop_first=True)\nwork=pd.get_dummies(data['work_type'])\nresidence=pd.get_dummies(data['Residence_type'],drop_first=True)\nsmoke=pd.get_dummies(data['smoking_status'],drop_first=True)","87f61ae0":"full_data=data.join([gender,married,work,residence,smoke])\nfull_data.head()","63f916de":"full_data.columns","77022737":"required_data=full_data[['age','hypertension', 'heart_disease','avg_glucose_level', 'bmi','Female', 'Male','Yes', 'Govt_job',\n       'Never_worked', 'Private', 'Self-employed', 'children', 'Urban','formerly smoked', 'never smoked', 'smokes']]","16f35958":"required_data.head()","2082b13e":"X_train, X_test, y_train, y_test = train_test_split(required_data, target, test_size=0.25)","0a27d78f":"predictions=pd.DataFrame(index=y_test.index)\npredictions['actual']=y_test\npredictions.head()","1293aba4":"rfc=RandomForestClassifier()\nrfc.fit(X_train,y_train)","fb3d7f08":"rfc_pre=rfc.predict(X_test)\npredictions['rfc']=rfc_pre","f6d007b5":"rfc.score(X_train,y_train)","11e9152e":"print(classification_report(y_test,rfc_pre))","80b8feec":"print(confusion_matrix(y_test,rfc_pre))","d3df65d5":"dtc=DecisionTreeClassifier()\ndtc.fit(X_train,y_train)","d80435b9":"dtc_pre=dtc.predict(X_test)\npredictions['dtc']=dtc_pre","38ef7ae0":"dtc.score(X_train,y_train)","fa1a83e7":"print(classification_report(y_test,dtc_pre))","59a1e1d4":"print(confusion_matrix(y_test,dtc_pre))","e47564de":"predictions.head(10)","6bcb0fd0":"# Model Creation and Predictions","279938ae":"# Importing dataset","920b43b7":"# Data Preprocessing","c778597a":"# Data Filtering","46cbc953":"# Importing all the packages","f8c5d10a":"## Decision Tree Classifier","a4243b0e":"## Random Forest Classifier"}}