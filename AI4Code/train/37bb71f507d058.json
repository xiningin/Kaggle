{"cell_type":{"189e5101":"code","634f178b":"code","45b80a02":"code","1e3224b4":"code","915a8104":"code","b06e4e4f":"code","62fa9f0f":"code","1cfe2ec9":"code","e8fbafa2":"code","6692ef0d":"code","189dcc2d":"code","b60b099d":"code","209bf3fb":"code","f957d88e":"code","8d975932":"code","d2fc1af2":"code","bc6e8594":"code","4b6b861d":"code","fba12034":"code","3c57addb":"code","747d6698":"code","b289fffd":"code","bf1313ec":"code","0aa6cff1":"markdown"},"source":{"189e5101":"import pandas as pd\nfrom PIL import Image\nimport numpy as np\nfrom sklearn.model_selection import train_test_split\nfrom tensorflow.keras.utils import to_categorical\nimport tensorflow as tf\nfrom tensorflow.data import AUTOTUNE\nfrom tensorflow.keras.models import Model\nfrom tensorflow.keras.layers import Dense,Conv2D,Input,Flatten,MaxPool2D,Dropout\nfrom tensorflow.keras import regularizers\nfrom tensorflow.keras import initializers\nfrom tensorflow.keras.constraints import max_norm\nfrom tensorflow.keras.layers import MaxPooling2D","634f178b":"df = pd.read_csv('..\/input\/digit-recognizer\/train.csv')","45b80a02":"df.head()","1e3224b4":"df.shape","915a8104":"X = []\nY = []\nfor i in df.values:\n    X.append(i[1:].reshape((28,28)))\n    Y.append(i[0])","b06e4e4f":"X = np.array(X)\nY = np.array(Y)","62fa9f0f":"Y","1cfe2ec9":"X_train,X_next, Y_train, Y_next = train_test_split(X,Y,random_state=46,test_size = 0.4)\nX_val, X_test, Y_val, Y_test = train_test_split(X_next,Y_next,random_state=46,test_size = 0.3)","e8fbafa2":"Y_train = to_categorical(Y_train)\nY_val = to_categorical(Y_val)\nY_test = to_categorical(Y_test)","6692ef0d":"def create_dataset(dataset):\n    ds=tf.data.Dataset.from_tensor_slices(dataset)\n    ds=ds.batch(50).prefetch(buffer_size=AUTOTUNE)\n    return ds\n\ntrainds = create_dataset((X_train,Y_train))\ntestds = create_dataset((X_test,Y_test))\nvalds = create_dataset((X_val,Y_val))","189dcc2d":"inputlayer = Input((28,28))\nflatten = Flatten()(inputlayer)\nd1 = Dense(100, activation='relu')(flatten)\ndrop1 = Dropout(0.2)(d1)\nd2 = Dense(100, activation='relu')(drop1)\ndrop2 = Dropout(0.2)(d2)\nd3 = Dense(100, activation='relu')(drop2)\ndrop3 = Dropout(0.2)(d3)\noutputlayer = Dense(10, activation='softmax')(drop3)\nmodel = Model(inputs=inputlayer, outputs=outputlayer)\n\nmodel.summary()","b60b099d":"opt = tf.keras.optimizers.Adam(learning_rate=0.0001)\nmodel.compile(optimizer=opt, loss='categorical_crossentropy', metrics=['accuracy'])","209bf3fb":"model.fit(trainds,epochs=50,validation_data=valds)","f957d88e":"model.evaluate(testds)","8d975932":"df1 = pd.read_csv('..\/input\/digit-recognizer\/test.csv')","d2fc1af2":"df1.head()","bc6e8594":"testX = []\nfor i in df1.values:\n    testX.append(i[:].reshape((28,28)))","4b6b861d":"testX = np.array(testX)","fba12034":"testX[1].shape","3c57addb":"pred = model.predict(testX)","747d6698":"result_pred = [np.argmax(x) for x in pred]","b289fffd":"my_submission = pd.DataFrame({'ImageId': df1.index + 1, 'Label': result_pred})\nmy_submission.head()","bf1313ec":"my_submission.to_csv('submission.csv', index=False)","0aa6cff1":"# Test Model To test.csv"}}