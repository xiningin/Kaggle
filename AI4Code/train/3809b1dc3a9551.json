{"cell_type":{"bb761edc":"code","441c1063":"code","5b1ce4c6":"code","19cbe49b":"code","16796ee3":"code","0aeb165a":"code","39612ba5":"code","44ba1131":"code","30c798c9":"code","02dc8e5a":"code","42b16ffa":"code","b3c5839d":"code","4fa9dc7f":"code","0599ca3b":"code","6ed032ba":"code","30903850":"code","1ffa60a8":"code","8a63c3e0":"code","7de9b316":"code","13429ee1":"code","e7ef15eb":"code","c12589e5":"code","c4f99448":"code","c1639ddc":"code","7e18523a":"code","736745b7":"code","c753ca57":"markdown","544a3bc4":"markdown","2986ca74":"markdown","fd6e347a":"markdown","40b19432":"markdown","87432f07":"markdown","9c2bc67d":"markdown","43a71a21":"markdown","ac6b9572":"markdown","ea8e525a":"markdown","bfced77d":"markdown","2d792bfd":"markdown","f75cdfba":"markdown","3895e000":"markdown","deba6f76":"markdown","c5d3fdcd":"markdown","533a1975":"markdown","74084116":"markdown","316715f5":"markdown"},"source":{"bb761edc":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom pandas_profiling import ProfileReport\nfrom sklearn.preprocessing import OrdinalEncoder, RobustScaler, StandardScaler\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.metrics import accuracy_score\n%matplotlib inline","441c1063":"df_train = pd.read_csv(\"\/kaggle\/input\/adult-pmr3508\/train_data.csv\",\n                 sep = r'\\s*,\\s*',\n                 engine = 'python',\n                 na_values = \"?\")\ndf_train = df_train.rename(columns = {'income' : 'target'})\ndf_train.shape","5b1ce4c6":"df_train.head()","19cbe49b":"df_train.describe(include = [np.number])","16796ee3":"df_train.describe(exclude = [np.number])","0aeb165a":"df_train[\"native.country\"].value_counts()","39612ba5":"sns.catplot(x=\"age\", y=\"target\", kind=\"violin\", split=True, data=df_train)","44ba1131":"sns.catplot(x=\"sex\", hue=\"target\", kind=\"count\", data=df_train)","30c798c9":"sns.catplot(x=\"education.num\", y=\"target\", kind=\"violin\", split=True, data=df_train)","02dc8e5a":"sns.catplot(x=\"workclass\", hue=\"target\", kind=\"count\", data=df_train)\nplt.xticks(rotation=60)","42b16ffa":"sns.catplot(x=\"hours.per.week\", y=\"target\", kind=\"violin\", split=True, data=df_train)","b3c5839d":"sns.catplot(x=\"fnlwgt\", y=\"target\", kind=\"violin\", split=True, data=df_train)","4fa9dc7f":"profile = ProfileReport(df_train)\nprofile","0599ca3b":"df_train = df_train.drop(['native.country'], axis=1)\ndf_train = df_train.drop(['education'], axis=1)\ndf_train = df_train.drop(['fnlwgt'], axis=1)\ndf_train = df_train.drop(['Id'], axis=1)\ndf_train.head()","6ed032ba":"df_train[\"workclass\"] = df_train[\"workclass\"].fillna('Private')\ndf_train[\"occupation\"] = df_train[\"occupation\"].fillna('Prof-specialty')\ndf_train.isnull().sum()","30903850":"df_test = pd.read_csv(\"\/kaggle\/input\/adult-pmr3508\/test_data.csv\",\n                 sep = r'\\s*,\\s*',\n                 engine = 'python',\n                 na_values = \"?\")\ndf_test = df_test.drop(['native.country'], axis=1)\ndf_test = df_test.drop(['education'], axis=1)\ndf_test = df_test.drop(['fnlwgt'], axis=1)\ndf_test = df_test.drop(['Id'], axis=1)\ndf_test.head()","1ffa60a8":"df_test[\"workclass\"] = df_test[\"workclass\"].fillna('Private')\ndf_test[\"occupation\"] = df_test[\"occupation\"].fillna('Prof-specialty')\ndf_test.isnull().sum()","8a63c3e0":"quant = [\"age\", \"education.num\", \"hours.per.week\"]\nquant_esp = [\"capital.gain\", \"capital.loss\"]\nqual = [\"workclass\", \"marital.status\", \"occupation\", \"relationship\", \"race\", \"sex\"]","7de9b316":"# Dados de treino\ndf_train[qual] = OrdinalEncoder().fit_transform(df_train[qual])\ndf_train.head()","13429ee1":"# Dados de teste\ndf_test[qual] = OrdinalEncoder().fit_transform(df_test[qual])\ndf_test.head()","e7ef15eb":"# Dados de treino\ndf_train[quant] = StandardScaler().fit_transform(df_train[quant])\ndf_train[quant_esp] = RobustScaler().fit_transform(df_train[quant_esp])\ndf_train.head()","c12589e5":"# Dados de teste\ndf_test[quant] = StandardScaler().fit_transform(df_test[quant])\ndf_test[quant_esp] = RobustScaler().fit_transform(df_test[quant_esp])\ndf_test.head()","c4f99448":"y_train = df_train.target\nx_train = df_train.drop(['target'], axis=1)\n\nk_min = 1\nk_max = 40\nbest_k = 0\nbest_score = 0\n\nfor k in range(k_min,k_max):\n    knn = KNeighborsClassifier(n_neighbors=k)\n    scores = cross_val_score(knn, x_train, y_train, cv=10)\n    if best_score < scores.mean():\n        best_score = scores.mean()\n        std = scores.std()\n        best_k = k","c1639ddc":"print(\"Melhor k: \", best_k)\nprint(f\"Acur\u00e1cia: {best_score} +\/- {std}\")","7e18523a":"knn = KNeighborsClassifier(n_neighbors=best_k)\nknn.fit(x_train, y_train)\ny_pred = knn.predict(df_test)\ny_pred","736745b7":"final = df_test\nfinal['income'] = y_pred.tolist()\nfinal.head()","c753ca57":"Interpretando esses dados, temos que \"count\" se trata do n\u00famero de valores n\u00e3o nulos; \"mean\", da m\u00e9dia; \"std\", do desvi padr\u00e3o; \"min\", do valor m\u00ednimo; \"25%\", do primeiro quartil; \"50%\", da mediana; \"75%\", do terceiro quartil e \"max\", do valor m\u00e1ximo.","544a3bc4":"Adicionando no dataframe:","2986ca74":"### d) Profiling da base","fd6e347a":"Para entender melhor os dados, temos que \"age\" \u00e9 a idade da pessoa, \"workclass\" \u00e9 a sua classe de trabalho, \"fnlwgt\" significa \"final weight\" e se trata da estimativa de unidades na popula\u00e7\u00e3o alvo que cada unidade do banco de dados representa, \"education\" \u00e9 o grau de escolaridade, \"education.num\" \u00e9 o n\u00famero de anos que a pessoa estudou, \"marital.status\" \u00e9 o estado civil, \"occupation\" \u00e9 a profiss\u00e3o, \"relationship\" \u00e9 a posi\u00e7\u00e3o em sua fam\u00edlia, \"race\" \u00e9 a etnia, \"sex\" \u00e9 o g\u00eanero, \"capital.gain\" \u00e9 o ganho com investimentos, \"capital.loss\" \u00e9 a perda em investimentos, \"hour.per.week\" \u00e9 o n\u00famero de horas trabalhadas por semana, \"native.country\" \u00e9 o pa\u00eds de origem e \"target\" diz se a pessoa recebe mais do que 50K ou n\u00e3o.\n\n\u00c9 interessante olharmos para alguns par\u00e2metros estat\u00edsticos. Separando os dados quantitativos e qualitativos, temos:\n\n### a) Quantitativos","40b19432":"## 1. Bibliotecas","87432f07":"### c) An\u00e1lise gr\u00e1fica","9c2bc67d":"### b) Qualitativos","43a71a21":"Fazendo isso tamb\u00e9m com a base de teste:","ac6b9572":"Para normalizar os dados, usa-se a fun\u00e7\u00e3o StandardScaler do sklearn. Para os dados espar\u00e7os, no entanto, \u00e9 necess\u00e1rio o uso do RobustScaler:","ea8e525a":"Vamos ent\u00e3o estimar o n\u00famero de neighbors que nos da o melhor classficador KNN, usando a acur\u00e1cia como par\u00e2metro.","bfced77d":"Separando as colunas com dados quantitativos, quantitativos espar\u00e7os e qualitativos, temos:","2d792bfd":"## 3. Pr\u00e9-processamento dos dados","f75cdfba":"A partir das an\u00e1lises anteriores, pode-se concluir que as seguintes a\u00e7\u00f5es devem ser feitas:\n- Remo\u00e7\u00e3o da coluna \"native.country\", uma vez que a grande maioria das pessoas s\u00e3o dos Estados Unidos e os outros pa\u00edses n\u00e3o aparecem com uma frequ\u00eancia relevante para que uma correla\u00e7\u00e3o com a renda seja feita;\n- As colunas \"workclass\" e \"occupation\" possuem 5,6% e 5,7%, respectivamente, dos dados vazios. Esses gaps ser\u00e3o preenchidos com a moda de cada categoria, ou seja, \"Private\" para a primeira coluna e \"Prof-specialty\" para a segunda;\n- As colunas \"education\" e \"education.num\" apresentam a mesma informa\u00e7\u00e3o de modos diferentes, portanto, a coluna qualitativa (\"education\") ser\u00e1 removida;\n- O atributo \"fnlwgt\" n\u00e3o possui boa correla\u00e7\u00e3o com \"target\", tanto para >50K quanto <=50K \"fnlwgt\" possui uma distribui\u00e7\u00e3o muito semelhante, portanto pode-se remover essa coluna;\n- A coluna Id pode ser removida, uma vez que apenas se trata de um valor \u00fanico para identificar cada pessoa.","3895e000":"Interpretando esses dados temos que \"count\" \u00e9 o n\u00famero de valores n\u00e3o nulos, \"unique\" \u00e9 o n\u00famero de categorias diferentes, \"top\" \u00e9 a categoria mais frequente e \"freq\" \u00e9 a frequ\u00eancia da categoria mais frequente.","deba6f76":"Transformando os dados qualitativos em n\u00fameros:","c5d3fdcd":"## 4. Classificador KNN","533a1975":"Usando o hiperpar\u00e2metro encontrado:","74084116":"## 2. An\u00e1lise dos dados","316715f5":"### PMR3508 - Aprendizado de M\u00e1quina e Reconhecimento de Padr\u00f5es (2021)\n#### Fernanda T. K.\n\n#### EP1\nProduce a classifier for the variable Target (that is, whether <=50K or >50K). The classifier must be a kNN where k is selected through cross validation; you must use the holdout test data to produce an empirical error rate."}}