{"cell_type":{"545b5d29":"code","08c46d6d":"code","0fabdef4":"code","25ea6fe7":"code","1f688dd3":"code","344762aa":"code","d48221e5":"code","9a3cd521":"code","4c68dbf1":"code","2c3566d9":"code","73df819b":"code","b54c2e3e":"code","ca06f8d0":"code","a6cff752":"code","0420998e":"code","ac70d5c2":"code","158049f0":"code","fb44d791":"code","99bcf70f":"code","f397160d":"markdown"},"source":{"545b5d29":"import matplotlib.pyplot as plt\nimport pandas as pd\n%matplotlib inline","08c46d6d":"df = pd.read_csv('..\/input\/sms-spam-collection-dataset\/spam.csv',encoding='latin-1')\ndf.head()","0fabdef4":"df = df.drop(['Unnamed: 2', 'Unnamed: 3', 'Unnamed: 4'], axis = 1)\ndf.head()","25ea6fe7":"df.rename(columns = {'v1':'labels', 'v2':'message'}, inplace=True)\ndf.head()","1f688dd3":"df.shape","344762aa":"df.drop_duplicates(inplace=True)\ndf.shape","d48221e5":"df['label'] = df['labels'].map({'ham': 0, 'spam': 1})\ndf.head()","9a3cd521":"df.drop(['labels'], axis=1, inplace=True)\ndf.head() ","4c68dbf1":"import string\n\ndef preprocess_text(message):\n    \n    \"\"\"\n    Takes in a string of text, then performs the following:\n    1. Remove all punctuation\n    2. Remove all stopwords\n    3. Returns a list of the cleaned text\n    \n    \"\"\"\n    # Check characters to see if they are in punctuation\n    without_punc = [char for char in message if char not in string.punctuation]\n\n    # Join the characters again to form the string.\n    without_punc = ''.join(without_punc)\n    \n    # Now just remove any stopwords\n    return [word for word in without_punc.split() if word.lower() not in stopwords.words('english')]","2c3566d9":"import re\nimport nltk\nnltk.download('stopwords')\nfrom nltk.corpus import stopwords\ndf['message'].head().apply(preprocess_text)","73df819b":"from wordcloud import WordCloud\n\nspam_words = ' '.join(list(df[df['label'] == 1]['message']))\nspam_wc = WordCloud(width = 512,height = 512).generate(spam_words)\nplt.figure(figsize = (10, 8), facecolor = 'k')\nplt.imshow(spam_wc)\nplt.show()","b54c2e3e":"from wordcloud import WordCloud\n\nham_words = ' '.join(list(df[df['label'] == 0]['message']))\nham_wc = WordCloud(width = 512,height = 512).generate(ham_words)\nplt.figure(figsize = (10, 8), facecolor = 'k')\nplt.imshow(ham_wc)\nplt.show()","ca06f8d0":"from sklearn.feature_extraction.text import CountVectorizer\nx = df['message']\ny = df['label']\ncv = CountVectorizer()\nx= cv.fit_transform(x)","a6cff752":"from sklearn.model_selection import train_test_split\nx_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.20, random_state=0)","0420998e":"from sklearn.naive_bayes import MultinomialNB\nclassifier = MultinomialNB().fit(x_train, y_train)","ac70d5c2":"from sklearn.metrics import classification_report, confusion_matrix, accuracy_score\npred = classifier.predict(x_test)\nprint(classification_report(y_test, pred))\nprint()\nprint('Confusion Matrix:\\n',confusion_matrix(y_test, pred))\nprint()\nprint('Accuracy : ',accuracy_score(y_test, pred))","158049f0":"# print the predictions\nprint(classifier.predict(x_test))\n\n# print the actual values\nprint(y_test.values)","fb44d791":"def sms(text):\n    \n    # creating a list of labels\n    lab = ['not spam','spam'] \n    \n    # perform tokenization\n    x = cv.transform(text).toarray()\n    \n    # predict the text\n    p = classifier.predict(x)\n    \n    # convert the words in string with the help of list\n    s = [str(i) for i in p]\n    a = int(\"\".join(s))\n    \n    # show out the final result\n    res = str(\"This message is looking: \"+ lab[a])\n    print(res)","99bcf70f":"sms(['Congratulations, your entry into our contest last month made you a WINNER! goto our website to claim your price! You have 24 hours to claim.'])","f397160d":"# Testing on Random Text"}}