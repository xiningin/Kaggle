{"cell_type":{"96051bd9":"code","c934f756":"code","db8a3f4c":"code","4c1cf9aa":"code","c111b3d7":"code","74d485de":"code","0ccfb9ca":"code","d247f92d":"code","7d6598fc":"code","6e11e600":"code","7cc3909d":"code","d277a08d":"code","6a78ad5e":"code","abbc4104":"code","e5e416b5":"code","a9edc5d9":"code","b02eca78":"code","57b47875":"code","aeff1413":"code","adaf47b3":"code","28fc17ac":"code","7497374f":"code","68b47113":"code","6a442417":"code","f8eb2628":"code","7e9605db":"code","43eb5643":"code","2cdf7f75":"code","1b5ab9c0":"code","10b52193":"code","43f82e36":"markdown","f96fefdd":"markdown","2b4b2d8a":"markdown","02f0c92b":"markdown","c607d4e0":"markdown","6e26ee97":"markdown","531a6fde":"markdown","c79d4f85":"markdown","46ce0bd0":"markdown","38017d49":"markdown","12a5d942":"markdown","1a64278c":"markdown","a6a8b332":"markdown","83e3dd66":"markdown"},"source":{"96051bd9":"import pandas as pd \nimport folium \nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport numpy as np\n\nfrom sklearn.linear_model import LinearRegression\n\nimport warnings\nwarnings.filterwarnings('ignore')\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","c934f756":"#Read Data\ndf = pd.read_csv('\/kaggle\/input\/chipotle-locations\/chipotle_stores.csv')\ndf_gdp=pd.read_csv('\/kaggle\/input\/us_energy_census_gdp_10-14\/Energy Census and Economic Data US 2010-2014.csv')\ndf.head()","db8a3f4c":"usa_map = folium.Map([39.358, -98.118], zoom_start=4, tiles=\"Stamen toner\")\nfor lat, lon,loc in zip(df.latitude, df.longitude,df.location):\n    folium.CircleMarker([lat, lon],radius=10, color=None,\n                        fill_color='red',fill_opacity=0.3,\n                        tooltip=\"Location : \"+str(loc)).add_to(usa_map)\nusa_map","4c1cf9aa":"total=len(df.state.unique())\nprint(f'Total Number of states with chipotle outlet : {total}')","c111b3d7":"#Statewise distribution of Outlets\nstate_chip=df.state.value_counts()\ndf_state_chip=pd.DataFrame({'state':state_chip.index,\n                           'outlets':state_chip.values})\n\nplt.figure(figsize=(10,6))\nplt.title(\"Number of Chipotle Stores by State\")\nsns.barplot('state', 'outlets', data=df_state_chip)\nplt.xticks(rotation=90)\nplt.show()","74d485de":"df_gdp.columns","0ccfb9ca":"#Selecting only the required columns\ndf_gdp=df_gdp[['State', 'GDP2014', 'POPESTIMATE2014']]\ndf_gdp.head()","d247f92d":"#States in GDP data only\nset(df_gdp.State)-set(df_state_chip.state)","7d6598fc":"#States in Chipotle data only\nset(df_state_chip.state)-set(df_gdp.State)","6e11e600":"#Removing states not required and renaming the columns\ndf_gdp=df_gdp[df_gdp.State.isin(['Alaska', 'Hawaii', 'United States'])==False]\ndf_gdp.State[df_gdp.State=='District of Columbia']='Washington DC'\ndf_gdp=df_gdp.rename(columns={'State':'state','GDP2014':'gdp','POPESTIMATE2014':'popl'})\ndf_gdp.head()","7cc3909d":"#Adding South Dakota to State list for Chipotle Stores\ndf_state_chip=df_state_chip.append(pd.Series({'state':'South Dakota','outlets':0}),ignore_index=True)","d277a08d":"# Joining the stores and stats dataframes\ndf_merged=pd.merge(df_state_chip,df_gdp, on='state')\ndf_merged.head()","6a78ad5e":"#Calculating GDP per capita\ndf_merged[\"gdp_pc\"]=round(df_merged.gdp\/df_merged.popl,2)\ndf_merged.head()","abbc4104":"sns.heatmap(df_merged.corr(), annot=True, cmap='coolwarm')\nplt.show()","e5e416b5":"plt.title(\"GDP vs Outlets\")\nsns.regplot('outlets','gdp', data=df_merged)\nplt.show()","a9edc5d9":"plt.title(\"Population vs Outlets\")\nsns.regplot('outlets','popl', data=df_merged)\nplt.show()","b02eca78":"plt.title(\"GDP per capita vs Outlets\")\nsns.regplot('outlets','gdp_pc', data=df_merged)\nplt.show()","57b47875":"plt.title(\"GDP vs Population vs Outlets\")\nsns.scatterplot('popl','gdp',size='outlets', alpha=0.8, data=df_merged)\nplt.show()","aeff1413":"#Select Features and target\nX=df_merged[['gdp','popl']]\ny=df_merged.outlets","adaf47b3":"#Fitting Linear Regression\nmodel=LinearRegression()\nmodel.fit(X,y)\nprint(f\"R2 score : {round(model.score(X,y)*100,2)}%\")","28fc17ac":"#Predicting the number of Outlets\ny_pred=model.predict(X)\ny_pred=np.round(y_pred,0)\ny_pred","7497374f":"#Adding Predicted Outlets to main dataframe\ndf_merged['outlets_pred']=y_pred\ndf_merged.outlets_pred=df_merged.outlets_pred.astype('int')\ndf_merged.head()","68b47113":"plt.figure(figsize=(10,8))\nplt.title(\"Overserved and Underserved Markets\")\nplot=sns.scatterplot('outlets_pred','outlets',data=df_merged)\nfor i in range(0, df_merged.shape[0]):\n    plot.text(df_merged.outlets_pred[i], df_merged.outlets[i], df_merged.state[i], alpha=0.8, fontsize=8 )\nplt.plot([-50,500],[-50,500],'r--')\nplt.xlim(-10,max(df_merged.outlets_pred)+20)\nplt.ylim(-10,max(df_merged.outlets)+20)\nplt.show()","6a442417":"#Calculating the number of outlets in excess\/short of the predicted number of outlets\ndf_merged['scope']=df_merged.outlets_pred-df_merged.outlets\nplt.figure(figsize=(4,8))\nplt.title(\"Number of outlets in excess\/short of the predicted number of outlets\")\nsns.barplot(data=df_merged.sort_values(by='scope', ascending=False),\n           x='scope',y='state', orient='h')\nplt.show()\n#df_merged.sort_values(by='scope', ascending=False)","f8eb2628":"# Percentage increase of decrease in number of stores per state\ndf_merged['scope_perc']=round(df_merged.scope*100\/df_merged.outlets,2)\ndf_merged.sort_values(by='scope_perc', ascending=False, inplace=True)\n\nplt.figure(figsize=(6,10))\nsns.barplot(y=df_merged.state, x=df_merged.scope_perc, orient='h')\nplt.show()\n#df_merged","7e9605db":"# Taking only states where more than 5 stores should be opened or closed and scope perc greater than +\/-20%","43eb5643":"df_final=df_merged[(abs(df_merged.scope_perc)>50)& (abs(df_merged.scope)>4)].reset_index()\ndf_final.head(10)","2cdf7f75":"df_final.tail(10)","1b5ab9c0":"df_final['perc_change']=abs(df_final.scope_perc)\ndf_final['density']=df_final.scope.apply(lambda x: \"Underserved\" if x>0 else \"Overserved\")\ndf_final","10b52193":"plt.figure(figsize=(10,6))\nplt.title(\"Overserved and Underserved Markets\")\nplot=sns.scatterplot('outlets_pred','outlets',data=df_final,\n                     size='perc_change', size_norm=(50,200),\n                     hue='density')\nfor i in range(0, df_final.shape[0]):\n    plot.text(df_final.outlets_pred[i], df_final.outlets[i], df_final.state[i], alpha=0.8, fontsize=8 )\nplt.plot([-50,500],[-50,500],'r--')\nplt.xlim(0,max(df_final.outlets_pred)+2)\nplt.ylim(0,max(df_final.outlets)+2)\nplt.show()","43f82e36":"# Predicting the Number of Outlets based on GDP and Population","f96fefdd":"### Exploring the Chipotle data","2b4b2d8a":"## Import Libraries","02f0c92b":"### OBSERVATION\n* According to the model, Vermont and Wyoming should not have any outlets of Chipotle\n* South Dakota which currently does not have any stores now, should ideally have one store\n* There are many states with very small number of outlets, which is greatly impacting the scope percentage.","c607d4e0":"### Underserved and overserved markets","6e26ee97":"## Mapping Chipotle outlets","531a6fde":"OBSERVATIONS:\n* Number of outlets is highly correlated with GDP and Population\n* Number of outlets is not correlated with GDP per capita\n* California is an outlier in the case of GDP and Population which is affecting the correlation. \n* GDP is highly correlated with population (multicollinearity to be explored)","c79d4f85":"# Please upvote if you liked the notebook.","46ce0bd0":"### Explore GDP and Census data","38017d49":"### CAUTION\n* This analysis is highly simplified, 2014 population and gdp are used for estimaion of number of outlets. However the number of outlets depends on many other factors which are not considered in this analysis. \n* Impact of outliers is not factored in the regression, which could highly skew the predictions.","12a5d942":"### Correlation Heatmap","1a64278c":"OBSERVATIONS:\n* Number of outlets is highly correlated with state GDP and Population\n* GDP per capita does not affect number of outlets","a6a8b332":"* We will only consider the states in Mainland US ","83e3dd66":"## RECOMMENDATION\n* Chipotle should increase the stores in the underserver states, especially Mississippi, Arkansas, Louisiana, Oklahoma,\tWisconsin, Iowa and Alabama.\n* Arizona, Washington DC, Delaware and Rhode Island states are overserved hence outlets have to be streamlined in these areas"}}