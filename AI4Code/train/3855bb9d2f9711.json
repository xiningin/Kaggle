{"cell_type":{"fb985ce8":"code","ab2d755d":"code","01c7e24c":"code","7d1ac72e":"code","edfe284a":"code","3dd74b9b":"code","dc92babc":"code","fd642dff":"code","de5ebd55":"markdown","1bdc8b73":"markdown","83598974":"markdown","43e7e0fd":"markdown"},"source":{"fb985ce8":"import numpy as np\nimport pandas as pd\nimport os","ab2d755d":"china = pd.read_csv(\"\/kaggle\/input\/panda-efnetb2-180-weight\/china_gla.csv\")\nchina[\"file\"] = [\"\/kaggle\/input\/ocular-disease-recognition-odir5k\/ODIR-5K\/ODIR-5K\/Training Images\/{}\".format(china[\"filename\"].values[i]) for i in range(len(china))]\nchina[\"label\"] = china[\"Gla\"]\npd.set_option('display.max_rows', 400)\nchina.head(400)","01c7e24c":"pd.set_option('display.max_rows', 400)\nchina_full = pd.read_csv(\"..\/input\/ocular-disease-recognition-odir5k\/full_df.csv\")\nchina_full.head(400)","7d1ac72e":"import matplotlib.pyplot as plt\n%matplotlib inline\nimport cv2","edfe284a":"china_1 = china[china[\"label\"]==1]\nfor i in range(100):\n    file_name = china_1[\"file\"].values[i]\n    img = cv2.imread(file_name)\n    plt.imshow(img)\n    plt.show()","3dd74b9b":"china_1 = china[china[\"label\"]==0]\nfor i in range(100):\n    file_name = china_1[\"file\"].values[i]\n    img = cv2.imread(file_name)\n    plt.imshow(img)\n    plt.show()","dc92babc":"import math\ndef get_pad_width(im, new_shape, is_rgb=True):\n    pad_diff = new_shape - im.shape[0], new_shape - im.shape[1]\n    t, b = math.floor(pad_diff[0]\/2), math.ceil(pad_diff[0]\/2)\n    l, r = math.floor(pad_diff[1]\/2), math.ceil(pad_diff[1]\/2)\n    if is_rgb:\n        pad_width = ((t,b), (l,r), (0, 0))\n    else:\n        pad_width = ((t,b), (l,r))\n    return pad_width\ndef crop_object(img, thresh=10, maxval=200, square=True):\n    \"\"\"\n    Source: https:\/\/stackoverflow.com\/questions\/49577973\/how-to-crop-the-biggest-object-in-image-with-python-opencv\n    \"\"\"\n    gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)# convert to grayscale\n    #plt.imshow(gray,cmap=\"gray\")\n    #plt.show()#\u666e\u901a\u306b\u767d\u9ed2\u306e\u304c\u307f\u3048\u308b\n    # threshold to get just the signature (INVERTED)\n    retval, thresh_gray = cv2.threshold(gray, thresh=thresh, maxval=maxval, type=cv2.THRESH_BINARY)\n    contours, hierarchy = cv2.findContours(thresh_gray,cv2.RETR_LIST, cv2.CHAIN_APPROX_SIMPLE)\n    #https:\/\/qiita.com\/anyamaru\/items\/fd3d894966a98098376c\n    # Find object with the biggest bounding box\n    mx = (0,0,0,0)      # biggest bounding box so far\n    mx_area = 0\n    for cont in contours:\n        x,y,w,h = cv2.boundingRect(cont)\n        area = w*h\n        if area > mx_area:\n            mx = x,y,w,h\n            mx_area = area\n    x,y,w,h = mx#(0,0,0,0)\u306a\u306e\u306fcontours\u306b\u4f55\u3082\u5165\u3063\u3066\u306a\u3044\u304b\u3089\n    crop = img[y:y+h, x:x+w]\n    if square:\n        pad_width = get_pad_width(crop, max(crop.shape))\n        crop = np.pad(crop, pad_width=pad_width, mode='constant', constant_values=0)\n    return crop","fd642dff":"china_0 = china[china[\"label\"]==0]\nfor i in range(100):\n    file_name = china_1[\"file\"].values[i]\n    img = cv2.imread(file_name)\n    img = crop_object(img, square=False)\n    plt.imshow(img)\n    plt.show()","de5ebd55":"### \u975e\u7dd1\u5185\u969c\u753b\u50cf","1bdc8b73":"\u30c7\u30fc\u30bf\u306e\u51fa\u5178\uff1ahttps:\/\/www.kaggle.com\/andrewmvd\/ocular-disease-recognition-odir5k\n\u8aac\u660e\uff1a\n\n\u773c\u75be\u60a3\u30a4\u30f3\u30c6\u30ea\u30b8\u30a7\u30f3\u30c8\u8a8d\u8b58\uff08ODIR\uff09\u306f\u3001\u5e74\u9f62\u3001\u5de6\u76ee\u3068\u53f3\u76ee\u304b\u3089\u306e\u773c\u5e95\u306e\u30ab\u30e9\u30fc\u5199\u771f\u3001\u304a\u3088\u3073\u533b\u5e2b\u304b\u3089\u306e\u533b\u5e2b\u306e\u8a3a\u65ad\u30ad\u30fc\u30ef\u30fc\u30c9\u3092\u6301\u30645,000\u4eba\u306e\u60a3\u8005\u306e\u69cb\u9020\u5316\u3055\u308c\u305f\u773c\u79d1\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3067\u3059\u3002\n\n\u3053\u306e\u30c7\u30fc\u30bf\u30bb\u30c3\u30c8\u306f\u3001\u4e2d\u56fd\u306e\u3055\u307e\u3056\u307e\u306a\u75c5\u9662\/\u533b\u7642\u30bb\u30f3\u30bf\u30fc\u304b\u3089Shanggong Medical Technology Co.\u3001Ltd.\u304c\u53ce\u96c6\u3057\u305f\u300c\u5b9f\u969b\u306e\u300d\u60a3\u8005\u60c5\u5831\u30bb\u30c3\u30c8\u3092\u8868\u3059\u3053\u3068\u3092\u76ee\u7684\u3068\u3057\u3066\u3044\u307e\u3059\u3002 \u3053\u308c\u3089\u306e\u6a5f\u95a2\u3067\u306f\u3001\u773c\u5e95\u753b\u50cf\u306f\u3001Canon\u3001Zeiss\u3001Kowa\u306a\u3069\u306e\u5e02\u5834\u306b\u3042\u308b\u3055\u307e\u3056\u307e\u306a\u30ab\u30e1\u30e9\u306b\u3088\u3063\u3066\u30ad\u30e3\u30d7\u30c1\u30e3\u3055\u308c\u3001\u3055\u307e\u3056\u307e\u306a\u753b\u50cf\u89e3\u50cf\u5ea6\u306b\u306a\u308a\u307e\u3059\u3002","83598974":"### \u7dd1\u5185\u969c\u753b\u50cf","43e7e0fd":"\u524d\u51e6\u7406\u3057\u305f\u30d0\u30fc\u30b8\u30e7\u30f3\uff1a\n\u6b63\u5e38\u753b\u50cf"}}