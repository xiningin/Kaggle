{"cell_type":{"c8d597e9":"code","020006c6":"code","0c5eb656":"code","c9de8e20":"code","f1f9218d":"code","c9107cdb":"code","86fcbc5d":"code","3f3f64c1":"code","362291db":"code","fce8e0bd":"code","383cc905":"code","80a20dbc":"code","d749a3eb":"code","aee9d18b":"code","153aab12":"code","3e199056":"code","e810b9c8":"code","edefd201":"code","b1c1b144":"code","4946b122":"code","e1983312":"markdown","5abc70ed":"markdown","c618d48c":"markdown","5214d13f":"markdown","e4796e55":"markdown","c210ea33":"markdown","ca6cde4a":"markdown","e80ed27c":"markdown","abe1deb3":"markdown","9569075c":"markdown","48a04803":"markdown","cda97f01":"markdown","62aa72d7":"markdown","916b004a":"markdown","22d4c426":"markdown","f7adfdba":"markdown","64bb86f7":"markdown","9036b6a2":"markdown","57fc2b06":"markdown","c0d44e61":"markdown","532aea67":"markdown","3a3bd9a1":"markdown","01ce5ca0":"markdown","2cf8b9d5":"markdown","836d435d":"markdown","41f0d639":"markdown","bb2e9485":"markdown","ea598f78":"markdown","6472e015":"markdown","ba30a8df":"markdown"},"source":{"c8d597e9":"PATH=\"\/kaggle\/input\/icamusical\/\"","020006c6":"!pip install pydub\nfrom pydub import AudioSegment\nimport IPython\nimport numpy as np\nimport wave\n\nmix_1_wave = wave.open(PATH+'ICA mix 1.wav','r')","0c5eb656":"mix_1_wave.getparams()","c9de8e20":"264515\/44100","f1f9218d":"# Extract Raw Audio from Wav File\nsignal_1_raw = mix_1_wave.readframes(-1)\nsignal_1 = np.fromstring(signal_1_raw, 'Int16')","c9107cdb":"'length: ', len(signal_1) , 'first 100 elements: ',signal_1[:100]","86fcbc5d":"import matplotlib.pyplot as plt\n\nfs = mix_1_wave.getframerate()\ntiming = np.linspace(0, len(signal_1)\/fs, num=len(signal_1))\n\n\nplt.figure(figsize=(12,2))\nplt.title('Recording 1')\nplt.plot(timing,signal_1, c=\"#3ABFE7\")\nplt.ylim(-35000, 35000)\nplt.show()","3f3f64c1":"\nmix_2_wave = wave.open(PATH+'ICA mix 2.wav','r')\n\n#Extract Raw Audio from Wav File\nsignal_raw_2 = mix_2_wave.readframes(-1)\nsignal_2 = np.fromstring(signal_raw_2, 'Int16')\n\n\nmix_3_wave = wave.open(PATH+'ICA mix 3.wav','r')\n\n#Extract Raw Audio from Wav File\nsignal_raw_3 = mix_3_wave.readframes(-1)\nsignal_3 = np.fromstring(signal_raw_3, 'Int16')\n\n\nplt.figure(figsize=(12,2))\nplt.title('Recording 2')\nplt.plot(timing,signal_2, c=\"#3ABFE7\")\nplt.ylim(-35000, 35000)\nplt.show()\n\n\nplt.figure(figsize=(12,2))\nplt.title('Recording 3')\nplt.plot(timing,signal_3, c=\"#3ABFE7\")\nplt.ylim(-35000, 35000)\nplt.show()\n","362291db":"IPython.display.Audio(PATH+\"ICA mix 1.wav\")","fce8e0bd":"IPython.display.Audio(PATH+\"ICA mix 2.wav\")","383cc905":"IPython.display.Audio(PATH+\"ICA mix 3.wav\")","80a20dbc":"X = list(zip(signal_1, signal_2, signal_3))\n\n# Let's peak at what X looks like\nX[:10]","d749a3eb":"from sklearn.decomposition import FastICA\n\n# Initializing FastICA with n_components=3\nica = FastICA(n_components=3)\n\n# Running the FastICA algorithm using fit_transform on dataset X\nica_result = ica.fit_transform(X)","aee9d18b":"ica_result.shape","153aab12":"result_signal_1 = ica_result[:,0]\nresult_signal_2 = ica_result[:,1]\nresult_signal_3 = ica_result[:,2]","3e199056":"# Independent Component #1\nplt.figure(figsize=(12,2))\nplt.title('Independent Component #1')\nplt.plot(result_signal_1, c=\"#df8efd\")\nplt.ylim(-0.010, 0.010)\nplt.show()\n\n# Independent Component #2\nplt.figure(figsize=(12,2))\nplt.title('Independent Component #2')\nplt.plot(result_signal_2, c=\"#87de72\")\nplt.ylim(-0.010, 0.010)\nplt.show()\n\n# Independent Component #3\nplt.figure(figsize=(12,2))\nplt.title('Independent Component #3')\nplt.plot(result_signal_3, c=\"#f65e97\")\nplt.ylim(-0.010, 0.010)\nplt.show()\n\n","e810b9c8":"from scipy.io import wavfile\n\n# Converting to int, mapping the appropriate range, and increasing the volume a little bit\nresult_signal_1_int = np.int16(result_signal_1*32767*100)\nresult_signal_2_int = np.int16(result_signal_2*32767*100)\nresult_signal_3_int = np.int16(result_signal_3*32767*100)\n\n\n# Writing wave files\nwavfile.write(\"result_signal_1.wav\", fs, result_signal_1_int)\nwavfile.write(\"result_signal_2.wav\", fs, result_signal_2_int)\nwavfile.write(\"result_signal_3.wav\", fs, result_signal_3_int)","edefd201":"IPython.display.Audio(\"result_signal_1.wav\")","b1c1b144":"IPython.display.Audio(\"result_signal_3.wav\")","4946b122":"IPython.display.Audio(\"result_signal_2.wav\")","e1983312":"### I advise not to listen it because it was just added as a noise and so is a static note","5abc70ed":"# Applications","c618d48c":"# Visualizing Audio Files\n\nIf we plot this array as a line graph, we'll get the familiar wave form representation:","5214d13f":"### So you can clearly hear that the recording seems to have multiple different recordings combined","e4796e55":"signal_1 is now a list of ints representing the sound contained in the first file.","c210ea33":"# Listening Audio","ca6cde4a":"In the same way, we can now load the other two wave files, and hear then...","e80ed27c":"# Applying FastICA","abe1deb3":"You can have a look at the [DOCS of FastICA](https:\/\/scikit-learn.org\/stable\/modules\/generated\/sklearn.decomposition.FastICA.html)","9569075c":"### This is beautiful Piano piece","48a04803":"Let's split into separate signals and look at them","cda97f01":"Now that we've read all three files, we're ready to [zip](https:\/\/docs.python.org\/3\/library\/functions.html#zip) them to create our dataset.\n\n* Dataset ```X``` is created by zipping signal_1, signal_2, and signal_3 into a single list","62aa72d7":"```ica_result``` now contains the result of FastICA, which we hope are the original signals. It's in the shape:","916b004a":"Let's extract the frames of the wave file, which will be a part of the dataset we'll run ICA against:","22d4c426":"We are now ready to run ICA to try to retrieve the original signals.\n\n* We'll use sklearn's FastICA module\n* Initialize FastICA look for three components and then\n* Run the FastICA algorithm using fit_transform on dataset X","f7adfdba":"# Results\n\nLet's plot to see how the wave forms look","64bb86f7":"## Table of Content\n1. What is Independent Component Analysis?\n2. Applications\n2. Our Goal\n3. Dataset\n4. Visualizing Audio Files\n5. Listening Audio\n6. Applying FastICA\n7. Results","9036b6a2":"<big><h1 align=center> Independent Component Analysis <\/h1><\/big>\n<h1 align=center> The Musical Way <\/h1>\n\nIn this notebook, we'll use Independent Component Analysis to **retrieve original signals** from three observations each of which contains a **different mix of the original signals**.\n\n<h3 align=center style=color:red>Please give a Upvote if you like this notebook<\/h3>","57fc2b06":"Music:\n* Piano - The Carnival of the Animals - XIII. The Swan (Solo piano version). Performer: Markus Staab\n* Cello - Cello Suite no. 3 in C, BWV 1009 - I. Prelude. Performer: European Archive","c0d44e61":"# Our Goal\n\n<img src=\"https:\/\/team.inria.fr\/parietal\/files\/2018\/07\/ica_principle.png\"><\/img>","532aea67":"<big>**Independent component analysis (ICA) is a statistical and computational technique for revealing hidden factors that underlie sets of random variables, measurements, or signals.**<br><br>\n\nICA defines a generative model for the observed multivariate data, which is typically given as a large database of samples. In the model, the data variables are assumed to be linear mixtures of some unknown latent variables, and the mixing system is also unknown. The latent variables are assumed nongaussian and mutually independent, and they are called the independent components of the observed data. These independent components, also called sources or factors, can be found by ICA.<br><br>\n\nICA is superficially related to principal component analysis and factor analysis. ICA is a much more powerful technique, however, capable of finding the underlying factors or sources when these classic methods fail completely. <\/big><br><br>\n\n[SOURCE](https:\/\/www.cs.helsinki.fi\/u\/ahyvarin\/whatisica.shtml)","3a3bd9a1":"* So this file has only channel which means it's mono sound.\n* It has a frame rate of 44100, which means each second of sound is represented by 44100 integers (integers because the file is in the common PCM 16-bit format).\n* The file has a total of 264515 integers\/frames, which means its length in seconds is:","01ce5ca0":"# Dataset\n\nLet's begin by looking at the dataset we have. We have **three WAVE files, each of which is a mix**, as I've mentioned. If you haven't worked with audio files in python before, that's okay, they basically boil down to being lists of floats.","2cf8b9d5":"Let's peak at the parameters of the wave file to learn more about it","836d435d":"ICA can be extended to analyze non-physical signals. For instance, ICA has been applied to discover discussion topics on a bag of news list archives.\n\nSome ICA applications are listed below:\n\n* Optical Imaging of neurons\n* Neuronal spike sorting\n* Face recognition\n* Modelling receptive fields of primary visual neurons\n* Predicting stock market prices\n* Mobile phone communications \n* Colour based detection of the ripeness of tomatoes\n* Removing artifacts, such as eye blinks, from EEG data.\n* Analysis of changes in gene expression over time in single cell RNA-sequencing experiments.\n* Studies of the resting state network of the brain.\n\n[SOURCE](https:\/\/en.wikipedia.org\/wiki\/Independent_component_analysis)","41f0d639":"You can hear this recoding below","bb2e9485":"Do some of these look like musical wave forms? \n\nThe best way to confirm the result is to listen to resulting files. So let's save as wave files and verify. But before we do that, we'll have to:\n* convert them to integer (so we can save as PCM 16-bit Wave files), otherwise only some media players would be able to play them and others won't\n* Map the values to the appropriate range for int16 audio. That range is between -32768 and +32767. A basic mapping can be done by multiplying by 32767.\n* The sounds will be a little faint, we can increase the volume by multiplying by a value like 100","ea598f78":"### This is a beautiful music piece","6472e015":"# What is Independent Component Analysis?","ba30a8df":" **Note: make sure to lower the volume on your speakers first, just in case some problem caused the file to sound like static**\n \n The resulting files we have now are:\n\n\n\n\n"}}