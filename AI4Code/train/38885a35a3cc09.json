{"cell_type":{"96edbe7b":"code","894a0b73":"code","b5e26c29":"code","41fa049b":"code","7da0b000":"code","8679d446":"code","4fa225c6":"code","fe13addb":"markdown","dbc9f80f":"markdown","bacb9b46":"markdown"},"source":{"96edbe7b":"import numpy as np\nimport pandas as pd\nimport re\nimport nltk\nnltk.download('stopwords')\nfrom nltk.corpus import stopwords\nfrom nltk.tokenize import word_tokenize\nfrom sklearn.feature_extraction.text import TfidfVectorizer\nfrom sklearn.svm import LinearSVC\nfrom sklearn.model_selection import GridSearchCV","894a0b73":"train = pd.read_csv('\/kaggle\/input\/text-classification-int20h\/train.csv', index_col = 'id')\ntest = pd.read_csv('\/kaggle\/input\/text-classification-int20h\/test.csv', index_col = 'id')","b5e26c29":"stop_words = set(stopwords.words('english'))\n\ndef process(text):\n      res = re.sub('<.*?>', ' ', text)\n      res = re.sub('\\W', ' ', res)\n      res = re.sub('\\s+[a-zA-Z]\\s+', ' ', res)\n      res = re.sub('\\s+', ' ', res)\n      word_tokens = word_tokenize(res)\n      filtered_res = \" \".join([w for w in word_tokens if w not in stop_words])\n      return filtered_res","41fa049b":"train['processed'] = train['review'].apply(lambda x: process(x))\ntest['processed'] = test['review'].apply(lambda x: process(x))","7da0b000":"tfidf = TfidfVectorizer(min_df = 3, max_df = 0.5, ngram_range = (1, 2))\nx_train_vector = tfidf.fit_transform(train['processed'])\ny_train = train['sentiment'].values","8679d446":"params = {'C': [0.25, 0.5, 0.75, 1, 1.5, 2]}\ngs = GridSearchCV(LinearSVC(), params, scoring = 'f1', n_jobs = -1)\ngs.fit(x_train_vector, y_train)","4fa225c6":"x_test_vector = tfidf.transform(test['processed'])\ntest_pred = gs.best_estimator_.predict(x_test_vector)\n\nsub = pd.read_csv('\/kaggle\/input\/text-classification-int20h\/submission.csv', index_col = 'id')\nsub['sentiment'] = test_pred\nsub.to_csv('.\/my_sub.csv')","fe13addb":"# Getting 0.91... F1 score with TF-IDF vectorization and LinearSVC","dbc9f80f":"Processing data: removing html tags, non-word characters, single letters and repeated spaces","bacb9b46":"Using grid search for regularization parameter"}}