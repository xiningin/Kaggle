{"cell_type":{"bf7b3ab3":"code","87bb4760":"code","9d65161c":"code","ff038056":"code","e665337f":"code","c0d22683":"code","b230bb68":"code","cc399114":"code","4acb16be":"code","51a30c9c":"code","09a2c7f3":"code","14be3b82":"code","687a3f61":"code","03116338":"code","83c7443b":"code","405631fa":"code","4b3d255a":"code","29935299":"code","b974abcd":"code","dbbac4e3":"code","1586afe4":"code","02a2bceb":"code","e4582b15":"code","76cbf04e":"markdown","70ebe9e3":"markdown","edd72f1c":"markdown","6ef02eb6":"markdown","620be124":"markdown","d8a8e661":"markdown","97d94340":"markdown","00c2d0f2":"markdown","6521988b":"markdown","bda8f761":"markdown","a0eb97c1":"markdown","de5e7361":"markdown","fc9e060d":"markdown","158d580b":"markdown","988abfe1":"markdown","313ceac0":"markdown","8b35ab0f":"markdown","4abb58cd":"markdown","23e28b40":"markdown","67f19674":"markdown","8623d664":"markdown","8c12781d":"markdown"},"source":{"bf7b3ab3":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","87bb4760":"from keras.layers import Input, Lambda, Dense, Flatten\nfrom keras.models import Model\nfrom keras.applications.vgg16 import VGG16\nfrom keras.applications.vgg16 import preprocess_input\nfrom keras.preprocessing import image\nfrom keras.preprocessing.image import ImageDataGenerator\nfrom keras.models import Sequential\nimport numpy as np\nfrom glob import glob\nimport matplotlib.pyplot as plt\nimport cv2","9d65161c":"plt.imshow(cv2.imread(\"\/kaggle\/input\/expresion-facial\/dataset\/training_set\/Anger\/Anger_2518.png\"))","ff038056":"plt.imshow(cv2.imread(\"\/kaggle\/input\/expresion-facial\/dataset\/training_set\/Neutral\/Neutral_2021.png\"))","e665337f":"plt.imshow(cv2.imread(\"\/kaggle\/input\/expresion-facial\/dataset\/training_set\/Surprise\/Surprise_2618.png\"))","c0d22683":"plt.imshow(cv2.imread(\"\/kaggle\/input\/expresion-facial\/dataset\/training_set\/Fear\/Fear_1833.png\"))","b230bb68":"plt.imshow(cv2.imread(\"\/kaggle\/input\/expresion-facial\/dataset\/training_set\/Happy\/Happy_2033.png\"))","cc399114":"plt.imshow(cv2.imread(\"\/kaggle\/input\/expresion-facial\/dataset\/training_set\/Sad\/Sad_2123.png\"))","4acb16be":"IMAGE_SIZE=[224,224]","51a30c9c":"train_path = '\/kaggle\/input\/expresion-facial\/dataset\/training_set'\nvalid_path = '\/kaggle\/input\/expresion-facial\/dataset\/test_set'","09a2c7f3":"vgg = VGG16(input_shape=IMAGE_SIZE + [3], weights='imagenet', include_top=False)","14be3b82":"for layer in vgg.layers:\n  layer.trainable = False","687a3f61":"folders = glob('\/kaggle\/input\/expresion-facial\/dataset\/training_set\/*')","03116338":"x = Flatten()(vgg.output)","83c7443b":"prediction = Dense(len(folders), activation='softmax')(x)","405631fa":"model = Model(inputs=vgg.input, outputs=prediction)","4b3d255a":"model.summary()","29935299":"model.compile(\n  loss='categorical_crossentropy',\n  optimizer='adam',\n  metrics=['accuracy']\n)","b974abcd":"from keras.preprocessing.image import ImageDataGenerator\n\ntrain_datagen = ImageDataGenerator(rescale = 1.\/255,\n                                   shear_range = 0.2,\n                                   zoom_range = 0.2,\n                                   horizontal_flip = True)\n\ntraining_set = train_datagen.flow_from_directory('\/kaggle\/input\/expresion-facial\/dataset\/training_set',\n                                                 target_size = (224, 224),\n                                                 batch_size = 32,\n                                                 class_mode = 'categorical')","dbbac4e3":"test_datagen = ImageDataGenerator(rescale = 1.\/255)\n\ntest_set = test_datagen.flow_from_directory('\/kaggle\/input\/expresion-facial\/dataset\/test_set',\n                                            target_size = (224, 224),\n                                            batch_size = 32,\n                                            class_mode = 'categorical')","1586afe4":"r = model.fit_generator(\n  training_set,\n  validation_data=test_set,\n  epochs=5,\n  steps_per_epoch=len(training_set),\n  validation_steps=len(test_set)\n)","02a2bceb":"plt.plot(r.history['loss'], label='train loss')\nplt.plot(r.history['val_loss'], label='val loss')\nplt.legend()\nplt.show()\nplt.savefig('LossVal_loss')","e4582b15":"plt.plot(r.history['accuracy'], label='train acc')\nplt.plot(r.history['val_accuracy'], label='val acc')\nplt.legend()\nplt.show()\nplt.savefig('AccVal_acc')","76cbf04e":"**RE-SCALING ALL THE IMAGES**","70ebe9e3":"**CREATING A MODEL OBJECT**","edd72f1c":"**SETTIG TRAIN AND TEST PATH**","6ef02eb6":"**FITTING THE MODEL**","620be124":"**USEFUL FOR GETTING NUMBER OF CLASSES**","d8a8e661":"**PREPROCESSING THE TRAINING SET**","97d94340":"**ADD PREPROCESSIN LAYER TO THE FRONT OF VGG**","00c2d0f2":"**DIFFERENT TYPES OF EXPRESSIONS**","6521988b":"**PREPROCESSING THE TEST SET**","bda8f761":"**SAD**","a0eb97c1":"**FEAR**","de5e7361":"**ANGER**","fc9e060d":"**COMPILING THE MODEL**","158d580b":"From above Dense layer we see that we have 6 different classes to classify from.","988abfe1":"**HAPPY**","313ceac0":"**OUR BUILT LAYERS**","8b35ab0f":"**VISUALIZING THE LOSS**","4abb58cd":"**DON'T TRAIN EXISTING WEIGHTS**","23e28b40":"**NEUTRAL**","67f19674":"**SURPRISED**","8623d664":"**IMPORTING LIBRARIES**","8c12781d":"**VISUALIZING THE ACCURACY**"}}