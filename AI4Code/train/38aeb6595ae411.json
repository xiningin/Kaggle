{"cell_type":{"f6c101b7":"code","5db41a1c":"code","7ff39b28":"code","f0276185":"code","4102c453":"code","496a3caf":"code","3349a5d0":"code","454469c8":"code","21f546ce":"code","eb455d0f":"code","c40e5a46":"code","8f50631e":"code","9f8ead73":"code","51a52d61":"code","593ef9bc":"code","39076743":"code","d8639918":"code","19073807":"markdown","38c13f38":"markdown","bf5cd217":"markdown","03aad15f":"markdown","02c18e06":"markdown"},"source":{"f6c101b7":"import pandas as pd\n\nimport scipy.stats as stats\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set(rc={'figure.figsize':(10,6)})\nsns.set(font_scale=1.3)\nplt.style.use('fivethirtyeight')\n\nfrom sklearn.model_selection import train_test_split\n\nfrom lightgbm import LGBMClassifier\nfrom xgboost import XGBClassifier\nfrom sklearn.ensemble import GradientBoostingClassifier, AdaBoostClassifier, ExtraTreesClassifier\nfrom sklearn.ensemble import BaggingClassifier, RandomForestClassifier, VotingClassifier\nfrom sklearn.tree import DecisionTreeClassifier, ExtraTreeClassifier\n\nfrom sklearn.metrics import accuracy_score\n\nimport warnings\nwarnings.filterwarnings('ignore')","5db41a1c":"wine = pd.read_csv('..\/input\/wine-customer-segmentation\/Wine.csv')\nwine.head()","7ff39b28":"wine.info()","f0276185":"wine.describe()","4102c453":"plt.figure(figsize=(15,15))\ncmap = sns.diverging_palette(0, 230, 90, 60, as_cmap=True)\nsns.heatmap(wine.corr(), cmap=cmap, cbar_kws={'shrink': .8}, square=True, annot=True, fmt='.2f', linewidths=.8)\nplt.show()","496a3caf":"plt.figure(figsize=(12,6))\ncontagem = wine['Customer_Segment'].value_counts()\n\nax = sns.countplot(data=wine, x='Customer_Segment')\n\nfor c in ax.patches:\n    ax.text(c.get_x() + c.get_width() \/ 2, c.get_height() + 0.9, c.get_height(), fontsize='16')\n    \nax.set_xlabel('N\u00b0 of Segment', fontsize = 15)\nax.set_ylabel('Count', fontsize = 15);","3349a5d0":"columns = wine.columns\nplt.subplots(figsize=(20,30))\nlength = len(columns)\n\nfor i, j in zip(columns, range(length)):\n    plt.subplot((length\/2), 3, j+1)\n    plt.subplots_adjust(wspace=.2, hspace=.5)\n    sns.distplot(wine[i], kde=False, fit=stats.norm, color='skyblue')\n    plt.title(i)","454469c8":"columns = wine.columns[:13]\nplt.subplots(figsize=(20,30))\nlength = len(columns)\n\nfor i, j in zip(columns, range(length)):\n    plt.subplot((length\/2), 3, j+1)\n    plt.subplots_adjust(wspace=.2, hspace=.5)\n    sns.boxplot(y=wine[i], color='skyblue')\n    plt.title(i)","21f546ce":"wine_1 = wine[wine['Customer_Segment'] == 1]\nwine_2 = wine[wine['Customer_Segment'] == 2]\nwine_3 = wine[wine['Customer_Segment'] == 3]","eb455d0f":"columns = wine_1.columns[:13]\nplt.subplots(figsize=(20,30))\nlength = len(columns)\n\nfor i, j in zip(columns, range(length)):\n    plt.subplot((length\/2), 3, j+1)\n    plt.subplots_adjust(wspace=.2, hspace=.5)\n    sns.distplot(wine_1[i], kde=False, fit=stats.norm, color=\"orange\")\n    plt.title(i)","c40e5a46":"columns = wine_1.columns[:13]\nplt.subplots(figsize=(20,30))\nlength = len(columns)\n\nfor i, j in zip(columns, range(length)):\n    plt.subplot((length\/2), 3, j+1)\n    plt.subplots_adjust(wspace=.2, hspace=.5)\n    sns.boxplot(y=wine_1[i], color='orange')\n    plt.title(i)","8f50631e":"columns = wine_2.columns[:13]\nplt.subplots(figsize=(20,30))\nlength = len(columns)\n\nfor i, j in zip(columns, range(length)):\n    plt.subplot((length\/2), 3, j+1)\n    plt.subplots_adjust(wspace=.2, hspace=.5)\n    sns.distplot(wine_2[i], kde=False, fit=stats.norm, color=\"green\")\n    plt.title(i)","9f8ead73":"columns = wine_2.columns[:13]\nplt.subplots(figsize=(20,30))\nlength = len(columns)\n\nfor i, j in zip(columns, range(length)):\n    plt.subplot((length\/2), 3, j+1)\n    plt.subplots_adjust(wspace=.2, hspace=.5)\n    sns.boxplot(y=wine_2[i], color='green')\n    plt.title(i)","51a52d61":"columns = wine_3.columns[:13]\nplt.subplots(figsize=(20,30))\nlength = len(columns)\n\nfor i, j in zip(columns, range(length)):\n    plt.subplot((length\/2), 3, j+1)\n    plt.subplots_adjust(wspace=.2, hspace=.5)\n    sns.distplot(wine_3[i], kde=False, fit=stats.norm, color=\"purple\")\n    plt.title(i)","593ef9bc":"columns = wine_3.columns[:13]\nplt.subplots(figsize=(20,30))\nlength = len(columns)\n\nfor i, j in zip(columns, range(length)):\n    plt.subplot((length\/2), 3, j+1)\n    plt.subplots_adjust(wspace=.2, hspace=.5)\n    sns.boxplot(y=wine_3[i], color='purple')\n    plt.title(i)","39076743":"columns = wine_3.columns[:13]\nplt.subplots(figsize=(20,30))\nlength = len(columns)\n\nfor i, j in zip(columns, range(length)):\n    fig = plt.subplot((length\/2), 3, j+1)\n    plt.subplots_adjust(wspace=.2, hspace=.5)\n    sns.distplot(x=wine_1[i], color='orange')\n    sns.distplot(x=wine_2[i], color='green')        \n    sns.distplot(x=wine_3[i], color='purple')\n    fig.legend(labels=('Segment 1','Segment 2','Segment 3'))\n    plt.title(i)","d8639918":"x = wine.drop(columns=['Customer_Segment'])\ny = wine['Customer_Segment']\n\nx_train, x_test, y_train , y_test = train_test_split(x, y, test_size=.2, stratify=y)\n\ncolunas = ['Modelo','Acuracy']\nresultado = pd.DataFrame(columns=colunas)\n\nmodels = []\n\nmodels.append(('GradientBoostingClassifier', GradientBoostingClassifier()))\nmodels.append(('AdaBoostClassifier', AdaBoostClassifier()))\nmodels.append(('ExtraTreesClassifier', ExtraTreesClassifier()))\nmodels.append(('BaggingClassifier', BaggingClassifier()))\nmodels.append(('RandomForestClassifier', RandomForestClassifier()))\nmodels.append(('DecisionTreeClassifier', DecisionTreeClassifier()))\nmodels.append(('ExtraTreeClassifier', ExtraTreeClassifier()))\nmodels.append((\"XGBClassifier\", XGBClassifier()))\n\nfor name, model in models:\n    model.fit(x_train,y_train)\n    y_pred=model.predict(x_test)\n    acc = accuracy_score(y_test, y_pred)\n    resultado = resultado.append(pd.DataFrame([[name, acc]], columns=colunas))\n    \nresultado.sort_values(by=['Acuracy'], ascending=False, inplace=True)\nresultado","19073807":"# <p style=\"background-color:#80ccff; font-family:newtimeroman; font-size:150%; text-align:center; border-radius:  80px 5px; padding-top:8px; padding-bottom:8px;\">EDA<\/p>","38c13f38":"# <p style=\"background-color:#80ccff; font-family:newtimeroman; font-size:150%; text-align:center; border-radius:  80px 5px; padding-top:8px; padding-bottom:8px;\">Separating by Segment<\/p>","bf5cd217":"# <p style=\"background-color:#80ccff; font-family:newtimeroman; font-size:150%; text-align:center; border-radius:  80px 5px; padding-top:8px; padding-bottom:8px;\">Model<\/p>","03aad15f":"# <p style=\"background-color:#80ccff; font-family:newtimeroman; font-size:150%; text-align:center; border-radius:  80px 5px; padding-top:8px; padding-bottom:8px;\">Wine Customer Segmentation<\/p>","02c18e06":"# <p style=\"background-color:#80ccff; font-family:newtimeroman; font-size:150%; text-align:center; border-radius:  80px 5px; padding-top:8px; padding-bottom:8px;\">Input<\/p>"}}