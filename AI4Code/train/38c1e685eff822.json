{"cell_type":{"8bf1c86e":"code","989ed872":"code","2d0479aa":"code","1d8e4df0":"code","e97f57e7":"code","068b6887":"code","f5396f76":"code","a206d0ff":"code","d44e2678":"code","67355212":"code","9558c987":"code","f2f937d1":"code","669daf16":"code","f6069dcb":"code","38fe173e":"code","19979b40":"code","6750715a":"code","576f1a9d":"code","b231894d":"code","33bafd53":"code","71127921":"code","0294a334":"code","e6e61694":"code","29ee876a":"code","ed389752":"code","e717c2a3":"code","be9c22ec":"code","92b9b378":"code","73d00434":"code","e09c4587":"code","54337d50":"code","8533eae1":"code","778ee61a":"code","85bd775a":"code","34005cc1":"code","c95d6126":"code","7217bbc5":"markdown","5c03e5f7":"markdown","098e2fca":"markdown","53119dc1":"markdown","187c019a":"markdown"},"source":{"8bf1c86e":"import numpy as np\nimport pandas as pd\n\nfrom tqdm import tqdm\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\nfor dirname, _, filenames in os.walk('\/kaggle\/working'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","989ed872":"df_train = pd.read_csv('\/kaggle\/input\/tweet-sentiment-extraction\/train.csv')\ndf_test = pd.read_csv('\/kaggle\/input\/tweet-sentiment-extraction\/test.csv')\nsample_submission = pd.read_csv('\/kaggle\/input\/tweet-sentiment-extraction\/sample_submission.csv')","2d0479aa":"df_train.head(5)","1d8e4df0":"df_test.head(5)","e97f57e7":"sample_submission.head(1)","068b6887":"print('Count of missing values in TRAIN data is', sum(df_train.isnull().sum(axis=1)))","f5396f76":"df_train.dropna(inplace=True)","a206d0ff":"df_train.to_csv('train.csv', index=False)","d44e2678":"print('Count of missing values in TEST data is', sum(df_test.isnull().sum(axis=1)))","67355212":"df_test.to_csv('test.csv', index=False)","9558c987":"from fastai.text import *","f2f937d1":"data_lm = (TextList.from_csv(path='\/kaggle\/working', csv_name='test.csv', cols='text')\n                   .split_by_rand_pct()\n                   .label_for_lm()\n                   .databunch())","669daf16":"data_lm.show_batch()","f6069dcb":"#learn = language_model_learner(data_lm, Transformer)\nlearn = language_model_learner(data_lm, AWD_LSTM, drop_mult=0.3)\nlearn.unfreeze()\n\n","38fe173e":"learn.lr_find()","19979b40":"learn.recorder.plot()","6750715a":"learn.fit_one_cycle(8, 5e-3)","576f1a9d":"learn.save('mini_train_lm')\nlearn.save_encoder('mini_train_encoder')","b231894d":"learn.show_results()","33bafd53":"data_clas = (TextList.from_csv(path='\/kaggle\/working', csv_name='test.csv', cols='text', vocab=data_lm.vocab)\n                   .split_by_rand_pct()\n                   .label_from_df(cols='sentiment')\n                   .databunch(bs=100))","71127921":"data_clas.show_batch()","0294a334":"learn = text_classifier_learner(data_clas, AWD_LSTM, drop_mult=0.9)\nlearn.load_encoder('mini_train_encoder')\nlearn.unfreeze()\n\n","e6e61694":"learn.lr_find()","29ee876a":"learn.recorder.plot()","ed389752":"learn.fit_one_cycle(10, slice(5e-3,8e-2))","e717c2a3":"learn.fit_one_cycle(10, slice(2e-3,5e-2))","be9c22ec":"learn.freeze_to(-2)\nlr = 5e-2\nlearn.fit_one_cycle(8,slice(lr\/(2.6**4),lr), moms=(0.8,0.7) )","92b9b378":"learn.load('mini_train_clas_28');","73d00434":"learn.freeze_to(-2)\nlr = 8e-2\nlearn.fit_one_cycle(8,slice(lr\/(2.6**4),lr), moms=(0.8,0.7) )","e09c4587":"learn.save('mini_train_clas_36')","54337d50":"learn.show_results()","8533eae1":"txt_ci = TextClassificationInterpretation.from_learner(learn)","778ee61a":"selected_texts = []\n\nfor text in tqdm(df_test['text'], position=0):\n    mask = txt_ci.intrinsic_attention(text)[1] > 0.6\n    text = text.split()\n    selected_text = ' '.join([x for x, y in zip(text, mask) if y == True])\n    selected_texts.append(selected_text)","85bd775a":"sample_submission['selected_text'] = selected_texts","34005cc1":"sample_submission.head(5)","c95d6126":"sample_submission.to_csv('submission.csv', index=False)","7217bbc5":"# MODELLING","5c03e5f7":"# Main Imports","098e2fca":"### Make predictions","53119dc1":"# Data Cleaning","187c019a":"### Create submission file"}}