{"cell_type":{"5fea87fc":"code","f54d9bec":"code","00d2a08e":"code","b6a230d0":"code","52672a0f":"code","5760b805":"code","7e50ecb2":"code","60b09d19":"code","2237c322":"code","466d8cc4":"code","708107d4":"code","759209c6":"code","e80c7d26":"code","21a3cec0":"code","e6fb44bb":"code","944af4e0":"code","71944604":"code","356defb5":"code","e4b4f4f9":"code","6f8076b4":"code","07229108":"code","89f31596":"code","3b4b3498":"code","8b4df344":"code","0c009c38":"code","c3ccf273":"code","82b03553":"code","77e5f976":"code","d926c12f":"code","48db9673":"code","8cc844a6":"code","485c089e":"code","04d3a1b1":"code","833d90ca":"code","de5cdae6":"code","5db7a043":"markdown","232f784f":"markdown","55c3661b":"markdown","50e339d4":"markdown","fa6d8eb9":"markdown","bd31b238":"markdown","e3dfc596":"markdown","570c2ef9":"markdown","a10f3873":"markdown","8d7bb61f":"markdown","ae3f6b2e":"markdown","6e29257a":"markdown","6977042d":"markdown","082d0abc":"markdown","354f5a1e":"markdown","961cf1c2":"markdown","ed8abc93":"markdown","318a68e7":"markdown","df269da2":"markdown","66a717de":"markdown","4ab59f39":"markdown","f4284b22":"markdown","d2157aba":"markdown","2f834185":"markdown","dc5daacb":"markdown","4a19e05c":"markdown","631ee30e":"markdown","004aa99c":"markdown","a8bad278":"markdown","df9bedc8":"markdown","3f748bc8":"markdown","15056db0":"markdown","212f21a9":"markdown","9021793f":"markdown","5e776a4c":"markdown","67f4c108":"markdown","ee960114":"markdown","b733ed77":"markdown","0e91a623":"markdown","12a9e1df":"markdown","5429ec17":"markdown","9dbacc72":"markdown","a798611d":"markdown","eada43af":"markdown","c325d4a2":"markdown","0346dab0":"markdown"},"source":{"5fea87fc":"import numpy as np\nimport pandas as pd\n\ndf = pd.read_csv(\"..\/input\/naive-bayes-imdb\/train.csv\", index_col=0)\ndf.head()","f54d9bec":"df.loc[0, 'review']","00d2a08e":"from sklearn.feature_extraction.text import CountVectorizer\n\nvectorizer = CountVectorizer(binary=True)\nvectorizer.fit(df.review)","b6a230d0":"len(vectorizer.vocabulary_)","52672a0f":"from sklearn.model_selection import train_test_split\n\ndf_train, df_test = train_test_split(df, test_size=0.2, shuffle=True)","5760b805":"X_train = vectorizer.transform(df_train.review)\nX_test = vectorizer.transform(df_test.review)\n\nX_train.shape, X_test.shape","7e50ecb2":"from sklearn.naive_bayes import BernoulliNB\n\nclf = BernoulliNB().fit(X_train, df_train.label)","60b09d19":"np.exp(clf.class_log_prior_)","2237c322":"def show_top10(classifier, vectorizer, categories=('neg', 'pos')):\n    feature_names = np.asarray(vectorizer.get_feature_names())\n    for i, category in enumerate(categories):\n        top10 = np.argsort(classifier.feature_log_prob_[i])[-10:]\n        print(\"%s: %s\" % (category, \" \".join(feature_names[top10])))\n\nshow_top10(clf, vectorizer)","466d8cc4":"from sklearn.metrics import classification_report\n\npredicts = clf.predict(X_train)\nprint(classification_report(df_train.label, predicts))","708107d4":"predicts = clf.predict(X_test)\nprint(classification_report(df_test.label, predicts))","759209c6":"count_vect = CountVectorizer(binary=False).fit(df.review)\n\nX_train_counts = count_vect.transform(df_train.review)\nX_test_counts = count_vect.transform(df_test.review)","e80c7d26":"dict(zip(count_vect.inverse_transform(X_train_counts[0])[0], X_train_counts[0].data))","21a3cec0":"from sklearn.naive_bayes import MultinomialNB\n\nclf = MultinomialNB().fit(X_train_counts, df_train.label)","e6fb44bb":"predicts = clf.predict(X_train_counts)\nprint(classification_report(df_train.label, predicts))","944af4e0":"X_test_counts = count_vect.transform(df_test.review)\npredicts = clf.predict(X_test_counts)\nprint(classification_report(df_test.label, predicts))","71944604":"show_top10(clf, count_vect)","356defb5":"from sklearn.feature_extraction.stop_words import ENGLISH_STOP_WORDS\n\ncount_vect = CountVectorizer(stop_words=ENGLISH_STOP_WORDS, binary=False).fit(df.review)\n\nX_train_counts = count_vect.transform(df_train.review)\nX_test_counts = count_vect.transform(df_test.review)","e4b4f4f9":"clf = MultinomialNB().fit(X_train_counts, df_train.label)","6f8076b4":"predicts = clf.predict(X_test_counts)\nprint(classification_report(df_test.label, predicts))","07229108":"show_top10(clf, count_vect)","89f31596":"from sklearn.feature_extraction.text import TfidfVectorizer\n\nvectorizer = TfidfVectorizer(stop_words=ENGLISH_STOP_WORDS)\nvectorizer = vectorizer.fit(df.review)","3b4b3498":"X_train_vectors = vectorizer.transform(df_train.review)\nX_test_vectors = vectorizer.transform(df_test.review)","8b4df344":"X_train_vectors[0].data","0c009c38":"vectorizer.inverse_transform(X_train_vectors[0])[0][np.argsort(X_train_vectors[0].data)]","c3ccf273":"clf = MultinomialNB().fit(X_train_vectors, df_train.label)","82b03553":"show_top10(clf, vectorizer)","77e5f976":"predicts = clf.predict(X_train_vectors)\nprint(classification_report(df_train.label, predicts))","d926c12f":"X_test_vectors = vectorizer.transform(df_test.review)\npredicts = clf.predict(X_test_vectors)\nprint(classification_report(df_test.label, predicts))","48db9673":"vectorizer = TfidfVectorizer(stop_words=ENGLISH_STOP_WORDS, ngram_range=(1, 2)).fit(df.review)\n\nX_train_vectors = vectorizer.transform(df_train.review)\nX_test_vectors = vectorizer.transform(df_test.review)","8cc844a6":"vectorizer.inverse_transform(X_train_vectors[0])[0][np.argsort(X_train_vectors[0].data)]","485c089e":"clf = MultinomialNB().fit(X_train_vectors, df_train.label)","04d3a1b1":"predicts = clf.predict(X_train_vectors)\nprint(classification_report(df_train.label, predicts))","833d90ca":"X_test_vectors = vectorizer.transform(df_test.review)\npredicts = clf.predict(X_test_vectors)\nprint(classification_report(df_test.label, predicts))","de5cdae6":"test = pd.read_csv('..\/input\/naive-bayes-imdb\/test.csv', index_col=0)\npredicted = clf.predict(vectorizer.transform(test.review))\n\npd.DataFrame({'Predicted': predicted}).to_csv('solution.csv', index_label='Id')","5db7a043":"\u041f\u043e\u0434\u043e\u0431\u043d\u043e\u0435 \u043f\u0440\u0435\u0434\u0441\u0442\u0432\u0430\u043b\u0435\u043d\u0438\u0435 \u0442\u0435\u043a\u0441\u0442\u0430 \u043d\u0430\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f Bag-of-Words (BOF).","232f784f":"\u041c\u0435\u0442\u0440\u0438\u043a\u0438 \u043c\u043e\u0434\u0435\u043b\u0438 \u043d\u0430 \u0442\u0435\u0441\u0442\u043e\u0432\u043e\u043c \u0434\u0430\u0442\u0430\u0441\u0435\u0442\u0435:","55c3661b":"\u041c\u0435\u0442\u0440\u0438\u043a\u0438 \u043d\u0430 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u0438:","50e339d4":"## \u041c\u043e\u0434\u0435\u043b\u044c Bag-of-Words\n\n\u041f\u0440\u0438 \u043f\u043e\u0441\u0442\u0440\u043e\u0435\u043d\u0438\u0438 \u0432\u0435\u043a\u0442\u043e\u0440\u0430 \u043f\u0440\u0438\u0437\u043d\u0430\u043a\u043e\u0432 \u0431\u0443\u0434\u0435\u043c \u0443\u0447\u0438\u0442\u044b\u0432\u0430\u0442\u044c \u043d\u0435 \u043f\u0440\u043e\u0441\u0442\u043e \u0444\u0430\u043a\u0442 \u0432\u0445\u043e\u0436\u0434\u0435\u043d\u0438\u044f \u0441\u043b\u043e\u0432\u0430 \u0432 \u0442\u0435\u043a\u0441\u0442, \u0430 \u043f\u043e\u0434\u0441\u0447\u0438\u0442\u044b\u0432\u0430\u0442\u044c \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0432\u0445\u043e\u0436\u0434\u0435\u043d\u0438\u0439:","fa6d8eb9":"```MultinomialNB``` - \u0431\u0430\u0439\u0435\u0441\u043e\u0432\u0441\u043a\u0438\u0439 \u043a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440 \u0434\u043b\u044f \u043f\u0440\u0438\u0437\u043d\u0430\u043a\u043e\u0432, \u0432\u044b\u0440\u0430\u0436\u0430\u044e\u0449\u0438\u0445 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u0440\u043e\u0438\u0437\u043e\u0448\u0435\u0434\u0448\u0438\u0445 \u0441\u043e\u0431\u044b\u0442\u0438\u0439:","bd31b238":"\u041d\u0435\u043d\u0443\u043b\u0435\u0432\u044b\u0435 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u044b \u0432\u0435\u043a\u0442\u043e\u0440\u043e\u0432 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u043c\u0435\u0440\u044b TF-IDF \u0434\u043b\u044f \u0441\u043b\u043e\u0432 \u0438\u0437 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430:","e3dfc596":"\u0415\u0449\u0435 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u043f\u0440\u043e\u0446\u0435\u043d\u0442\u043e\u0432 \u0442\u043e\u0447\u043d\u043e\u0441\u0442\u0438 \u043f\u0440\u0438\u0431\u0430\u0432\u0438\u043b\u0430 \u043c\u043e\u0434\u0435\u043b\u044c! \u0422\u0435\u043f\u0435\u0440\u044c \u0432 \u0442\u043e\u043f\u0435 \u0431\u043e\u043b\u0435\u0435 \u043e\u0441\u043c\u044b\u0441\u043b\u0435\u043d\u043d\u044b\u0435 \u0441\u043b\u043e\u0432\u0430:","570c2ef9":"## TF-IDF","a10f3873":"\u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0435\u043c \u043f\u043e\u0434\u0441\u0447\u0438\u0442\u044b\u0432\u0430\u0442\u044c \u043d\u0435 \u0442\u043e\u043b\u044c\u043a\u043e \u043e\u0434\u0438\u043d\u043e\u0447\u043d\u044b\u0435 \u0441\u043b\u043e\u0432\u0430, \u043d\u043e \u0438 \u043f\u0430\u0440\u044b \u0441\u043b\u043e\u0432:","8d7bb61f":"\u0412\u044b\u0432\u0435\u0434\u0435\u043c \u0441\u043b\u043e\u0432\u0430 \u0438\u0437 \u043f\u0435\u0440\u0432\u043e\u0433\u043e \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430 \u0432 \u043f\u043e\u0440\u044f\u0434\u043a\u0435 \u0443\u0432\u0435\u043b\u0438\u0447\u0435\u043d\u0438\u044f \u0438\u0437 \u043c\u0435\u0440\u044b TF-IDF:","ae3f6b2e":"\u0422\u043e\u043f-\u043b\u0438\u0441\u0442 \u0441\u043b\u043e\u0432 \u043f\u043e \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f\u043c:","6e29257a":"\u041f\u043e\u0439\u0434\u0435\u043c \u0434\u0430\u043b\u044c\u0448\u0435 \u043f\u043e \u043f\u0443\u0442\u0438 \u0443\u043b\u0443\u0447\u0448\u0435\u043d\u0438\u044f \u043f\u0440\u0438\u0437\u043d\u0430\u043a\u043e\u0432\u043e\u0433\u043e \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u044f.","6977042d":"## \u041d\u0430\u0438\u0432\u043d\u044b\u0439 \u0431\u0430\u0439\u0435\u0441\u043e\u0432\u0441\u043a\u0438\u0439 \u043a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440","082d0abc":"\u0412\u044b\u0432\u0435\u0434\u0435\u043c \u043f\u043e 10 \u0441\u0430\u043c\u044b\u0445 \u0437\u043d\u0430\u0447\u0438\u043c\u044b\u0445 \u0441\u043b\u043e\u0432 \u0432 \u043a\u0430\u0436\u0434\u043e\u0439 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438:","354f5a1e":"\u0412\u0438\u0434\u0438\u043c, \u0447\u0442\u043e \u0432 \u0442\u043e\u043f \u043f\u043e\u043f\u0430\u043b\u0438 \u043e\u0431\u0449\u0435\u0443\u043f\u043e\u0442\u0440\u0435\u0431\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u0441\u043b\u043e\u0432\u0430, \u043d\u0435\u0441\u043f\u0435\u0446\u0438\u0444\u0438\u0447\u043d\u044b\u0435 \u0434\u043b\u044f \u043a\u0430\u043a\u043e\u0439-\u043b\u0438\u0431\u043e \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438. \u0421 \u044d\u0442\u0438\u043c \u0435\u0449\u0435 \u043f\u0440\u0435\u0434\u0441\u0442\u043e\u0438\u0442 \u0440\u0430\u0437\u043e\u0431\u0440\u0430\u0442\u044c\u0441\u044f, \u0432 \u043f\u043e\u043a\u0430 \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u043c \u043c\u0435\u0442\u043e\u0434 ```predict``` \u043d\u0430 \u043e\u0431\u0443\u0447\u0430\u044e\u0449\u0435\u0439 \u0447\u0430\u0441\u0442\u0438 \u0434\u0430\u0442\u0430\u0441\u0435\u0442\u0430:","961cf1c2":"Done!","ed8abc93":"\u041a\u0430\u043a \u0438 \u0431\u044b\u043b\u043e \u0437\u0430\u0434\u0443\u043c\u0430\u043d\u043e, \u0432 \u043d\u0430\u0447\u0430\u043b\u0435 \u0441\u043f\u0438\u0441\u043a\u0430 \u043e\u043a\u0430\u0437\u0430\u043b\u0438\u0441\u044c \u043e\u0431\u0449\u0435\u0443\u043f\u043e\u0442\u0440\u0435\u0431\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u0441\u043b\u043e\u0432\u0430, \u0430 \u0431\u043b\u0438\u0436\u0435 \u043a \u043a\u043e\u043d\u0446\u0443 \u0441\u043f\u0438\u0441\u043a\u0430  - \u0441\u043b\u043e\u0432\u0430, \u0445\u0430\u0440\u0430\u043a\u0442\u0435\u0440\u043d\u044b\u0435 \u0438\u043c\u0435\u043d\u043d\u043e \u0434\u043b\u044f \u0434\u0430\u043d\u043d\u043e\u0433\u043e \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430.","318a68e7":"\u0412\u044b\u0432\u0435\u0434\u0435\u043c \u0441\u043b\u043e\u0432\u0430 \u0438\u0437 \u043f\u0435\u0440\u0432\u043e\u0433\u043e \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430 \u0432 \u043f\u043e\u0440\u044f\u0434\u043a\u0435 \u0443\u0432\u0435\u043b\u0438\u0447\u0435\u043d\u0438\u044f \u0438\u0437 \u043c\u0435\u0440\u044b TF-IDF:","df269da2":"## \u0420\u0430\u0437\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u0434\u0430\u0442\u0430\u0441\u0435\u0442\u0430","66a717de":"## \u0421\u043e\u0434\u0435\u0440\u0436\u0430\u043d\u0438\u0435\n* [\u041d\u0430\u0438\u0432\u043d\u044b\u0439 \u0431\u0430\u0439\u0435\u0441\u043e\u0432\u0441\u043a\u0438\u0439 \u043a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440](#\u041d\u0430\u0438\u0432\u043d\u044b\u0439-\u0431\u0430\u0439\u0435\u0441\u043e\u0432\u0441\u043a\u0438\u0439-\u043a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440)\n* [\u0414\u0430\u0442\u0430\u0441\u0435\u0442](#\u0414\u0430\u0442\u0430\u0441\u0435\u0442)\n* [\u0412\u0435\u043a\u0442\u043e\u0440\u043d\u043e\u0435 \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0442\u0435\u043a\u0441\u0442\u0430](#\u0412\u0435\u043a\u0442\u043e\u0440\u043d\u043e\u0435-\u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u0435-\u0442\u0435\u043a\u0441\u0442\u0430)\n* [BernoulliNB](#BernoulliNB)\n* [\u041c\u043e\u0434\u0435\u043b\u044c Bag-of-Words](#\u041c\u043e\u0434\u0435\u043b\u044c-Bag-of-Words)\n* [MultinomialNB](#MultinomialNB)\n* [TF-IDF](#TF-IDF)\n* [\u041f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0430 \u0444\u0430\u0439\u043b\u0430 \u0434\u043b\u044f \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0438](#\u041f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0430-\u0444\u0430\u0439\u043b\u0430-\u0434\u043b\u044f-\u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0438)","4ab59f39":"\u041f\u0435\u0440\u0435\u0432\u0435\u0434\u0435\u043c \u0432\u0435\u0441\u044c \u043d\u0430\u0431\u043e\u0440 \u0442\u0435\u043a\u0441\u0442\u043e\u0432 \u043e\u0431\u0443\u0447\u0430\u044e\u0449\u0435\u0433\u043e \u0438 \u0442\u0435\u0441\u0442\u043e\u0432\u043e\u0433\u043e \u0434\u0430\u0442\u0430\u0441\u0435\u0442\u0430 \u0432 \u043d\u0430\u0431\u043e\u0440\u044b \u0432\u0435\u043a\u0442\u043e\u0440\u043e\u0432:","f4284b22":"\u041c\u0435\u0442\u0440\u0438\u043a\u0438 \u043d\u0430 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u0438:","d2157aba":"\u041f\u0440\u0438\u0431\u0430\u0432\u0438\u043b\u0438 \u0435\u0449\u0435 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u043f\u0440\u043e\u0446\u0435\u043d\u0442\u043e\u0432. \u041c\u043e\u0436\u043d\u043e \u043b\u0443\u0447\u0448\u0435!","2f834185":"\u041e\u0446\u0435\u043d\u0438\u043c \u043d\u043e\u0432\u0443\u044e \u043c\u043e\u0434\u0435\u043b\u044c \u043d\u0430 \u0442\u0435\u0441\u0442\u043e\u0432\u043e\u0439 \u0432\u044b\u0431\u043e\u0440\u043a\u0435:","dc5daacb":"## MultinomialNB","4a19e05c":"\u0421\u0440\u0430\u0432\u043d\u0438\u043c \u0441 \u043c\u0435\u0442\u0440\u0438\u043a\u0430\u043c\u0438 \u043d\u0430 \u0442\u0435\u0441\u0442\u043e\u0432\u043e\u0439 \u0447\u0430\u0441\u0442\u0438:","631ee30e":"## \u0414\u0430\u0442\u0430\u0441\u0435\u0442","004aa99c":"\u041f\u0443\u0441\u0442\u044c $\\textbf{x}_i = (x_{i1}, ..., x_{im})$ - \u0432\u0435\u043a\u0442\u043e\u0440 \u043f\u0440\u0438\u0437\u043d\u0430\u043a\u043e\u0432 \u0434\u043b\u044f $i$-\u0433\u043e \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u0430 \u0434\u0430\u0442\u0430\u0441\u0435\u0442\u0430, $y_i$ - \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0439 \u043a\u043b\u0430\u0441\u0441. \u041a\u043b\u044e\u0447\u0435\u0432\u043e\u0435 \u043f\u0440\u0435\u0434\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u043d\u0430\u0438\u0432\u043d\u043e\u0433\u043e \u0431\u0430\u0439\u0435\u0441\u043e\u0432\u0441\u043a\u043e\u0433\u043e \u043a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440\u0430 - \u043d\u0435\u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u044c \u043f\u0440\u0438\u0437\u043d\u0430\u043a\u043e\u0432 \u043f\u0440\u0438 \u0437\u0430\u0434\u0430\u043d\u043d\u043e\u043c \u043a\u043b\u0430\u0441\u0441\u0435, \u0442.\u0435. \n![p(\\textbf{x}_i | y_i=c) = p(x_{i1} | y_i=c)\\cdot...\\cdot p(x_{im} | y_i=c).](https:\/\/latex.codecogs.com\/gif.latex?%5Cbg_white%20p%28%5Ctextbf%7Bx%7D_i%20%7C%20y_i%3Dc%29%20%3D%20p%28x_%7Bi1%7D%20%7C%20y_i%3Dc%29%5Ccdot...%5Ccdot%20p%28x_%7Bim%7D%20%7C%20y_i%3Dc%29.)\n\n\u0412 \u0442\u0430\u043a\u043e\u043c \u043f\u0440\u0435\u0434\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u0438 \u0441\u043e\u0432\u043c\u0435\u0441\u0442\u043d\u0430\u044f \u043f\u043b\u043e\u0442\u043d\u043e\u0441\u0442\u044c \u0434\u043b\u044f $i$-\u0433\u043e \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u0430 \u0434\u0430\u0442\u0430\u0441\u0435\u0442\u0430 \u0440\u0430\u0441\u043f\u0438\u0448\u0435\u0442\u0441\u044f \u043a\u0430\u043a\n![\\bg_white p(\\textbf{x}_i, y_i) = p(y_i)\\prod\\limits_{j=1}^{m} p(x_{ij} | y_i) = \\prod\\limits_{c=1}^{C}\\pi_c^{\\textrm{I}(y_i=c)}\\prod\\limits_{j=1}^{m}\\prod\\limits_{c=1}^{C} p(x_{ij} | \\theta_{jc})^{\\textrm{I}(y_i=c)}](https:\/\/latex.codecogs.com\/gif.latex?%5Cbg_white%20p%28%5Ctextbf%7Bx%7D_i%2C%20y_i%29%20%3D%20p%28y_i%29%5Cprod%5Climits_%7Bj%3D1%7D%5E%7Bm%7D%20p%28x_%7Bij%7D%20%7C%20y_i%29%20%3D%20%5Cprod%5Climits_%7Bc%3D1%7D%5E%7BC%7D%5Cpi_c%5E%7B%5Ctextrm%7BI%7D%28y_i%3Dc%29%7D%5Cprod%5Climits_%7Bj%3D1%7D%5E%7Bm%7D%5Cprod%5Climits_%7Bc%3D1%7D%5E%7BC%7D%20p%28x_%7Bij%7D%20%7C%20%5Ctheta_%7Bjc%7D%29%5E%7B%5Ctextrm%7BI%7D%28y_i%3Dc%29%7D)\n\n\u0414\u043b\u044f \u0431\u0438\u043d\u0430\u0440\u043d\u044b\u0445 \u043f\u0440\u0438\u0437\u043d\u0430\u043a\u043e\u0432 \u0431\u0443\u0434\u0435\u043c \u043f\u043e\u043b\u0430\u0433\u0430\u0442\u044c $p(x_{ij} | \\theta_{jc})$ \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u0438\u043d\u0435\u043c \u0411\u0435\u0440\u043d\u0443\u043b\u043b\u0438 \u0441 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u043c $\\theta_{jc}$, \u0434\u043b\u044f \u043f\u0440\u0438\u0437\u043d\u0430\u043a\u043e\u0432, \u043f\u0440\u0438\u043d\u0438\u043c\u0430\u044e\u0449\u0438\u0445 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u0432 \u043d\u0435\u043a\u043e\u0442\u043e\u0440\u043e\u043c \u043a\u043e\u043d\u0435\u0447\u043d\u043e\u043c \u043d\u0430\u0431\u043e\u0440\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0439, \u043f\u043e\u043b\u0430\u0433\u0430\u0435\u043c $p(x_{ij} | \\theta_{jc})$ \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0430\u043b\u044c\u043d\u044b\u043c \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u0435\u043c \u0441 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u043c  $\\theta_{jc}$ \u0432 \u0432\u0438\u0434\u0435 \u0432\u0435\u043a\u0442\u043e\u0440\u0430.\n\n\u0414\u043b\u044f \u043f\u0440\u043e\u0441\u0442\u043e\u0442\u044b \u0440\u0430\u0441\u0441\u043c\u043e\u0442\u0440\u0438\u043c \u043c\u043e\u0434\u0435\u043b\u044c \u0441 \u0431\u0438\u043d\u0430\u0440\u043d\u044b\u043c\u0438 \u043f\u0440\u0438\u0437\u043d\u0430\u043a\u0430\u043c\u0438. \u0414\u043b\u044f \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430 $\\pi$ \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u044f \u043a\u043b\u0430\u0441\u0441\u0430 \u0438 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432 $\\theta_{jc}$ \u0431\u0435\u0440\u043d\u0443\u043b\u0438\u0435\u0432\u0441\u043a\u0438\u0445 \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u0439 \u043f\u0440\u0438\u0437\u043d\u0430\u043a\u043e\u0432 \u0432\u043d\u0443\u0442\u0440\u0438 \u043a\u043b\u0430\u0441\u0441\u0430 \u0432\u044b\u0431\u0435\u0440\u0435\u043c \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0435 \u0430\u043f\u0440\u0438\u043e\u0440\u043d\u044b\u0435 \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u044f:\n\n* $p(\\pi | \\alpha) \\sim Dir(\\alpha)$\n* $p(\\theta_{jc} | \\beta) \\sim Beta(\\beta_0, \\beta_1)$.\n\n\u041f\u0440\u0438 \u0442\u0430\u043a\u043e\u043c \u0432\u044b\u0431\u043e\u0440\u0435 \u0430\u043f\u0440\u0438\u043e\u0440\u043d\u044b\u0445 \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u0439 \u043b\u0435\u0433\u043a\u043e \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0430\u043f\u043e\u0441\u0442\u0435\u0440\u0438\u043e\u0440\u043d\u044b\u0435 \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u044f:\n* $p(\\pi | D) \\sim Dir(\\alpha_1 + N_1, ... ,\\alpha_C + N_C)$\n* $p(\\theta_{jc} | D) \\sim Beta(\\beta_0 + N_{jc}, \\beta_1 + (N_c - N_{jc}))$,\n\n\u0433\u0434\u0435 $D$ - \u0434\u0430\u0442\u0430\u0441\u0435\u0442, $N_c$ - \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u043e\u0432 \u0434\u0430\u0442\u0430\u0441\u0435\u0442\u0430, \u043e\u0442\u043d\u043e\u0441\u044f\u0449\u0438\u0445\u0441\u044f \u043a \u043a\u043b\u0430\u0441\u0441\u0443 $c$, $N_{jc}$ - \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043d\u0430\u0431\u043b\u044e\u0434\u0435\u043d\u0438\u0439 \u043f\u0440\u0438\u0437\u043d\u0430\u043a\u0430 $j$ \u0432\u043d\u0443\u0442\u0440\u0438 \u043a\u043b\u0430\u0441\u0441\u0430 $c$.\n\n\u041e\u043f\u0438\u0448\u0435\u043c \u043f\u0440\u043e\u0446\u0435\u0434\u0443\u0440\u0443 \u0440\u0430\u0441\u0447\u0435\u0442\u0430 \u0432\u0435\u0440\u043e\u044f\u0442\u043d\u043e\u0441\u0442\u0438 $p(y=c|\\textbf{x}, D)$:\n![p(y=c|\\textbf{x}, D) \\propto \\int p(y=c|\\pi)p(\\pi | D) \\prod\\limits_{j=1}^{m} p(\\textbf{x}_{jc} | \\theta_{jc}) p(\\theta_{jc} | D) \\textrm{d} \\pi \\textrm{d} \\theta_{jc} = \\newline = \\int \\pi_cp(\\pi | D) \\textrm{d} \\pi \\prod\\limits_{j=1}^{m} \\int \\theta_{jc}^{\\textrm{I}(x_{jc}=1)}(1 - \\theta_{jc})^{\\textrm{I}(x_{jc}=0)} p(\\theta_{jc} | D) \\textrm{d} \\theta_{jc}.](https:\/\/latex.codecogs.com\/gif.latex?p%28y%3Dc%7C%5Ctextbf%7Bx%7D%2C%20D%29%20%5Cpropto%20%5Cint%20p%28y%3Dc%7C%5Cpi%29p%28%5Cpi%20%7C%20D%29%20%5Cprod%5Climits_%7Bj%3D1%7D%5E%7Bm%7D%20p%28%5Ctextbf%7Bx%7D_%7Bjc%7D%20%7C%20%5Ctheta_%7Bjc%7D%29%20p%28%5Ctheta_%7Bjc%7D%20%7C%20D%29%20%5Ctextrm%7Bd%7D%20%5Cpi%20%5Ctextrm%7Bd%7D%20%5Ctheta_%7Bjc%7D%20%3D%20%5Cnewline%20%3D%20%5Cint%20%5Cpi_cp%28%5Cpi%20%7C%20D%29%20%5Ctextrm%7Bd%7D%20%5Cpi%20%5Cprod%5Climits_%7Bj%3D1%7D%5E%7Bm%7D%20%5Cint%20%5Ctheta_%7Bjc%7D%5E%7B%5Ctextrm%7BI%7D%28x_%7Bjc%7D%3D1%29%7D%281%20-%20%5Ctheta_%7Bjc%7D%29%5E%7B%5Ctextrm%7BI%7D%28x_%7Bjc%7D%3D0%29%7D%20p%28%5Ctheta_%7Bjc%7D%20%7C%20D%29%20%5Ctextrm%7Bd%7D%20%5Ctheta_%7Bjc%7D.)\n\n\u0417\u0430\u043c\u0435\u0442\u0438\u043c, \u0447\u0442\u043e \u0438\u043d\u0442\u0435\u0433\u0440\u0430\u043b\u044b \u0435\u0441\u0442\u044c \u043d\u0438 \u0447\u0442\u043e \u0438\u043d\u043e\u0435, \u043a\u0430\u043a \u043c\u0430\u0442\u043e\u0436\u0438\u0434\u0430\u043d\u0438\u044f \u043f\u043e \u0430\u043f\u043e\u0441\u0442\u0435\u0440\u0438\u043e\u0440\u043d\u044b\u043c \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u044f\u043c, \u043e\u0442\u0441\u044e\u0434\u0430\n![p(y=c|\\textbf{x}, D) \\propto \\bar\\pi_c\\prod\\limits_{j=1}^{m} \\bar\\theta_{jc}^{\\textrm{I}(x_{jc}=1)}(1 - \\bar\\theta_{jc})^{\\textrm{I}(x_{jc}=0)},](https:\/\/latex.codecogs.com\/gif.latex?p%28y%3Dc%7C%5Ctextbf%7Bx%7D%2C%20D%29%20%5Cpropto%20%5Cbar%5Cpi_c%5Cprod%5Climits_%7Bj%3D1%7D%5E%7Bm%7D%20%5Cbar%5Ctheta_%7Bjc%7D%5E%7B%5Ctextrm%7BI%7D%28x_%7Bjc%7D%3D1%29%7D%281%20-%20%5Cbar%5Ctheta_%7Bjc%7D%29%5E%7B%5Ctextrm%7BI%7D%28x_%7Bjc%7D%3D0%29%7D%2C)\n\n\u0433\u0434\u0435\n* $\\bar\\pi_c = \\frac{N_c + \\alpha_c}{\\sum N_j + \\sum\\alpha_j}$\n* $\\bar\\theta_{jc} = \\frac{N_{jc} + \\beta_0}{N_c + \\beta_0 + \\beta_1}$.\n\n\u041e\u043a\u043e\u043d\u0447\u0430\u0442\u0435\u043b\u044c\u043d\u043e, \u0434\u043b\u044f \u043d\u0430\u0431\u043b\u044e\u0434\u0435\u043d\u0438\u044f $\\textbf{x}$ \u0432\u044b\u0431\u0435\u0440\u0435\u043c \u043a\u043b\u0430\u0441\u0441 \u0441 \u043d\u0430\u0438\u0431\u043e\u043b\u044c\u0448\u0435\u0439 \u0432\u0435\u0440\u043e\u044f\u0442\u043d\u043e\u0441\u0442\u044c\u044e: $\\hat y = \\operatorname*{arg\\,max}_c p(y=c|\\textbf{x}, D)$.","a8bad278":"# \u041a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u044f \u0442\u0435\u043a\u0441\u0442\u043e\u0432 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u043d\u0430\u0438\u0432\u043d\u043e\u0433\u043e \u0431\u0430\u0439\u0435\u0441\u043e\u0432\u0441\u043a\u043e\u0433\u043e \u043a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440\u0430","df9bedc8":"```BernoulliNB``` - \u0431\u0430\u0439\u0435\u0441\u043e\u0432\u0441\u043a\u0438\u0439 \u043a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440 \u0434\u043b\u044f \u0431\u0438\u043d\u0430\u0440\u0438\u0437\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u043f\u0440\u0438\u0437\u043d\u0430\u043a\u043e\u0432:","3f748bc8":"\u041f\u0440\u0438\u043c\u0435\u043d\u0438\u043c \u043c\u043e\u0434\u0435\u043b\u044c MultinomialNB:","15056db0":"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u0440\u043e\u0438\u043d\u0434\u0435\u043a\u0441\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u0441\u043b\u043e\u0432:","212f21a9":"\u0421\u043e\u0441\u0442\u0430\u0432\u0438\u043c \u0441\u043b\u043e\u0432\u0430\u0440\u044c \u0438 \u0440\u0430\u0441\u0447\u0438\u0442\u0430\u0435\u043c \u043c\u0435\u0440\u044b IDF \u0434\u043b\u044f \u0441\u043b\u043e\u0432 \u043e\u0431\u0443\u0447\u0430\u044e\u0449\u0435\u0433\u043e \u0434\u0430\u0442\u0430\u0441\u0435\u0442\u0430:","9021793f":"### \u041f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0430 \u0444\u0430\u0439\u043b\u0430 \u0434\u043b\u044f \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0438","5e776a4c":"## \u0412\u0435\u043a\u0442\u043e\u0440\u043d\u043e\u0435 \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0442\u0435\u043a\u0441\u0442\u0430\n\n\u041f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u0438\u043c \u0442\u0435\u043a\u0441\u0442 \u043a\u0430\u043a \u0432\u0435\u043a\u0442\u043e\u0440 \u0438\u043d\u0434\u0438\u043a\u0430\u0442\u043e\u0440\u043e\u0432 \u0432\u0445\u043e\u0436\u0434\u0435\u043d\u0438\u0439 \u0441\u043b\u043e\u0432 \u0438\u0437 \u043d\u0435\u043a\u043e\u0442\u043e\u0440\u043e\u0433\u043e \u0441\u043b\u043e\u0432\u0430\u0440\u044f \u0432 \u0442\u0435\u043a\u0441\u0442. \u042d\u0442\u043e \u043f\u0440\u043e\u0441\u0442\u0435\u0439\u0448\u0430\u044f \u043c\u043e\u0434\u0435\u043b\u044c BOF. \n\n\u0421\u0444\u043e\u0440\u043c\u0438\u0440\u0443\u0435\u043c \u0441\u043b\u043e\u0432\u0430\u0440\u044c \u043d\u0430 \u043e\u0441\u043d\u043e\u0432\u0435 \u043e\u0431\u0443\u0447\u0430\u044e\u0449\u0435\u0433\u043e \u0434\u0430\u0442\u0430\u0441\u0435\u0442\u0430. \u0414\u043b\u044f \u044d\u0442\u043e\u0433\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c \u043c\u043e\u0434\u0443\u043b\u044c ```CountVectorizer```:","67f4c108":"\u0410\u043f\u0440\u0438\u043e\u0440\u043d\u044b\u0435 \u0432\u0435\u0440\u043e\u044f\u0442\u043d\u043e\u0441\u0442\u0438 \u0434\u043b\u044f \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439 (\u043a\u0430\u043a \u043f\u043e\u043b\u0443\u0447\u0438\u043b\u0438\u0441\u044c \u044d\u0442\u0438 \u0447\u0438\u0441\u043b\u0430?)","ee960114":"\u0414\u043b\u044f \u043f\u0440\u0438\u043c\u0435\u0440\u0430 \u0432\u044b\u0432\u0435\u0434\u0435\u043c \u0441\u043b\u043e\u0432\u0430 \u0432\u043c\u0435\u0441\u0442\u0435 \u0438 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e\u043c \u0432\u0445\u043e\u0436\u0434\u0435\u043d\u0438\u0439 \u0434\u043b\u044f \u043f\u0435\u0440\u0432\u043e\u0433\u043e \u0442\u0435\u043a\u0441\u0442\u0430 \u0438\u0437 \u043e\u0431\u0443\u0447\u0430\u044e\u0449\u0435\u0433\u043e \u0434\u0430\u0442\u0430\u0441\u0435\u0442\u0430:","b733ed77":"\u041f\u043e-\u043f\u0440\u0435\u0436\u043d\u0435\u043c\u0443 \u043b\u0438\u0434\u0438\u0440\u0443\u044e\u0442 \u043d\u0435\u0441\u043f\u0435\u0446\u0438\u0444\u0438\u0447\u043d\u044b\u0435 \u0441\u043b\u043e\u0432\u0430:","0e91a623":"TF-IDF - \u043c\u0435\u0440\u0430 \u0437\u043d\u0430\u0447\u0438\u043c\u043e\u0441\u0442\u0438 \u0441\u043b\u043e\u0432\u0430 \u0434\u043b\u044f \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430, \u0440\u0430\u0441\u0441\u0447\u0438\u0442\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u043a\u0430\u043a \u043f\u0440\u043e\u0438\u0437\u0432\u0435\u0434\u0435\u043d\u0438\u0435 \u0432\u0435\u043b\u0438\u0447\u0438\u043d\u044b Term Frequency (\u0447\u0430\u0441\u0442\u043e\u0442\u0430 \u0432\u0445\u043e\u0436\u0434\u0435\u043d\u0438\u044f \u0441\u043b\u043e\u0432\u0430 \u0432 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442) \u043d\u0430 \u0432\u0435\u043b\u0438\u0447\u0438\u043d\u0443 Inverse Document Frequency (\u043e\u0431\u0440\u0430\u0442\u043d\u0430\u044f \u0432\u0435\u043b\u0438\u0447\u0438\u043d\u0430 \u043a \u0434\u043e\u043b\u0435 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u043e\u0432 \u0432 \u0434\u0430\u0442\u0430\u0441\u0435\u0442\u0435, \u0432 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u0432\u0441\u0442\u0440\u0435\u0447\u0430\u0435\u0442\u0441\u044f \u0434\u0430\u043d\u043d\u043e\u0435 \u0441\u043b\u043e\u0432\u043e). \u0427\u0430\u0441\u0442\u043e \u0432 \u0444\u043e\u0440\u043c\u0443\u043b\u0435 \u0440\u0430\u0441\u0447\u0435\u0442\u0430 TF-IDF \u043c\u043e\u0436\u043d\u043e \u0432\u0441\u0442\u0440\u0435\u0442\u0438\u0442\u044c \u043b\u043e\u0433\u0430\u0440\u0438\u0444\u043c\u044b.","12a9e1df":"\u041f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u0443\u0435\u043c \u0442\u0435\u043a\u0441\u0442\u044b \u043e\u0431\u0443\u0447\u0430\u044e\u0449\u0435\u0433\u043e \u0438 \u0442\u0435\u0441\u0442\u043e\u0432\u043e\u0433\u043e \u0434\u0430\u0442\u0430\u0441\u0435\u0442\u0430 \u0432 \u0432\u0435\u043a\u0442\u043e\u0440\u0430:","5429ec17":"\u041c\u0435\u0442\u0440\u0438\u043a\u0438 \u043c\u043e\u0434\u0435\u043b\u0438 \u043d\u0430 \u0442\u0435\u0441\u0442\u043e\u0432\u043e\u043c \u0434\u0430\u0442\u0430\u0441\u0435\u0442\u0435:","9dbacc72":"\u041c\u043e\u0434\u0435\u043b\u044c \u044f\u0432\u043d\u043e \u043d\u0443\u0436\u043d\u043e \u0443\u043b\u0443\u0447\u0448\u0430\u0442\u044c. \u0412 \u043f\u0435\u0440\u0432\u0443\u044e \u043e\u0447\u0435\u0440\u0435\u0434\u044c, \u0435\u0441\u0442\u044c \u0441\u043c\u044b\u0441\u043b \u043e\u0431\u0440\u0430\u0442\u0438\u0442\u044c \u0432\u043d\u0438\u043c\u0430\u043d\u0438\u0435 \u043d\u0430 \u0432\u0435\u043a\u0442\u043e\u0440 \u043f\u0440\u0438\u0437\u043d\u0430\u043a\u043e\u0432.","a798611d":"\u041f\u043e\u0440\u0430 \u043e\u0442 \u043d\u0438\u0445 \u0438\u0437\u0431\u0430\u0432\u0438\u0442\u044c\u0441\u044f, \u0443\u0431\u0440\u0430\u0432 \u0441\u0442\u043e\u043f-\u0441\u043b\u043e\u0432\u0430:","eada43af":"\u041c\u0435\u0442\u0440\u0438\u043a\u0438 \u043d\u0430 \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u0438:","c325d4a2":"\u041f\u0440\u0438\u043c\u0435\u043d\u0438\u043c \u043c\u043e\u0434\u0435\u043b\u044c MultinomialNB (\u043a\u0430\u043a \u0430\u0434\u0430\u043f\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043c\u043e\u0434\u0435\u043b\u044c MultinomialNB \u0434\u043b\u044f \u043d\u0435\u0446\u0435\u043b\u044b\u0445 \u043f\u0440\u0438\u0437\u043d\u0430\u043a\u043e\u0432?):","0346dab0":"## BernoulliNB"}}