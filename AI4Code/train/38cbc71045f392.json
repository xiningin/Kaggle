{"cell_type":{"75d43971":"code","8a8f136c":"code","c881707a":"code","edb4e5da":"code","19c8863f":"code","be2584b0":"code","a7189326":"code","9c156791":"code","dfc95ae6":"code","c9b2d888":"code","96d0f77b":"code","b2c20ded":"code","8864907a":"code","30a24316":"code","0dfcd460":"code","1c9d677e":"code","60518b31":"code","66864b27":"code","2fdf7e7c":"code","47a13cb5":"code","38f5a928":"code","7ee78278":"code","75ae8347":"code","13ce95e6":"code","1567b6ff":"code","6d8d9ccb":"code","4313ea0b":"code","1d2833fe":"markdown","ca40c720":"markdown","abe09e3b":"markdown","b21333eb":"markdown","6f47cd20":"markdown","c6ad285a":"markdown","0794c724":"markdown","04a86dbb":"markdown","849e3ea4":"markdown","a78102ec":"markdown","b83c0003":"markdown","c6f36fb0":"markdown"},"source":{"75d43971":"import numpy as np\nimport pandas as pd\nimport tensorflow as tf\nimport tensorflow.keras as k","8a8f136c":"data = pd.read_csv('..\/input\/fer2013\/fer2013.csv')\ndata.head()","c881707a":"num_classes = 7\nimg_width = 48\nimg_height = 48","edb4e5da":"data.shape","19c8863f":"data.Usage.value_counts()","be2584b0":"X = data['pixels']\ny = data['emotion']","a7189326":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.1, random_state=0)","9c156791":"X_train_new = []\nfor i in X_train:\n    X_train_new.append([int(j) for j in i.split()])","dfc95ae6":"X_train_new = np.array(X_train_new)\/255.0","c9b2d888":"X_test_new = []\nfor i in X_test:\n    X_test_new.append([int(j) for j in i.split()])","96d0f77b":"X_test_new = np.array(X_test_new)\/255.0","b2c20ded":"X_train_new = X_train_new.reshape(X_train_new.shape[0], img_width, img_height, 1)\nX_test_new = X_test_new.reshape(X_test_new.shape[0], img_width, img_height, 1)","8864907a":"X_test_new.shape","30a24316":"X_train_new = X_train_new.astype('float32')\nX_test_new = X_test_new.astype('float32')","0dfcd460":"from keras.utils import np_utils\ny_train = np_utils.to_categorical(y_train, num_classes)\ny_test = np_utils.to_categorical(y_test, num_classes)","1c9d677e":"from tensorflow.keras.preprocessing.image import ImageDataGenerator\nfrom tensorflow.keras.models import Sequential\nfrom tensorflow.keras.layers import Dense, Conv2D, Flatten,Dropout, MaxPooling2D, Activation, BatchNormalization\nfrom tensorflow.keras.preprocessing import image","60518b31":"model = Sequential()\nmodel.add(Conv2D(filters=64,kernel_size=(5,5),input_shape=(X_train_new.shape[1:]), padding='same'))\nmodel.add(Conv2D(64, kernel_size=(5,5), padding='same'))\nmodel.add(BatchNormalization())\nmodel.add(MaxPooling2D(pool_size=(2,2)))\nmodel.add(Activation('relu'))","66864b27":"model.add(Conv2D(filters=128, kernel_size=(5,5), padding='same'))\nmodel.add(Conv2D(128,kernel_size=(5,5), padding='same'))\nmodel.add(BatchNormalization())\nmodel.add(MaxPooling2D(pool_size=(2,2)))\nmodel.add(Activation('relu'))","2fdf7e7c":"model.add(Conv2D(filters=256, kernel_size=(3,3), padding='same'))\nmodel.add(Conv2D(256,kernel_size=(3,3), padding='same'))\nmodel.add(BatchNormalization())\nmodel.add(MaxPooling2D(pool_size=(2,2)))\nmodel.add(Activation('relu'))","47a13cb5":"model.add(Flatten())\nmodel.add(Dense(128))\nmodel.add(BatchNormalization())\nmodel.add(Activation('relu'))\nmodel.add(Dropout(0.25))\nmodel.add(Dense(7, activation='softmax'))","38f5a928":"model.compile(loss='categorical_crossentropy', optimizer='adam', metrics=['accuracy'])","7ee78278":"model.summary()","75ae8347":"from keras import backend as b\nb.set_value(model.optimizer.learning_rate, 0.0001)","13ce95e6":"history = model.fit(X_train_new, y_train, epochs=20, batch_size=64, validation_data=(X_test_new,y_test))","1567b6ff":"pd.DataFrame(history.history).tail()","6d8d9ccb":"y_pred = model.predict_classes(X_test_new)","4313ea0b":"from sklearn.metrics import confusion_matrix\ncfm = confusion_matrix(np.argmax(y_test, axis=1),y_pred)\ncfm","1d2833fe":"Importing required lib's\/packages","ca40c720":"Layer 1","abe09e3b":"Layer 4","b21333eb":"# Ques 4","6f47cd20":"Learning rate as 0.0001","c6ad285a":"# Ques 1","0794c724":"Compiling the model","04a86dbb":"# Ques 2","849e3ea4":"Layer 3","a78102ec":"Ques 5","b83c0003":"Layer 2","c6f36fb0":"# Ques 3"}}