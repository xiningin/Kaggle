{"cell_type":{"5b612dc6":"code","2137836c":"code","59660b69":"code","630bca44":"code","841432d2":"code","bfefcbfe":"code","5fdeaa2b":"code","bc4138c0":"code","632be0ee":"code","f89dcf65":"code","3624534c":"code","ef3474a3":"code","28556a9d":"code","8c6ef392":"code","40e299d9":"code","673de1f9":"code","6a2b0a6c":"code","19020565":"code","116a2cef":"code","6752b55e":"code","4c49e132":"code","13048acf":"code","c3d41635":"code","6e71e41a":"code","93beee9b":"code","1129f9da":"code","97aa7b78":"code","bf8efab8":"code","536d8903":"code","01d93341":"code","bdb3967c":"code","78c20e7a":"code","384d6477":"code","74b05b12":"code","50c37db1":"code","b888ee3f":"code","9313b4d4":"code","1f32fc77":"code","ebdcc770":"code","cddb86ef":"code","708aaa33":"code","adc2f707":"code","da1c0e10":"code","74306604":"code","ae330528":"code","d6e076ed":"code","3c704e65":"code","e606fcb5":"code","1b35dd98":"code","54e077ba":"code","c160e8f6":"code","d68dea2c":"code","9b9a9458":"code","d181637b":"code","8204d59b":"code","26ebb5ea":"code","1f71cba2":"markdown","62b90d14":"markdown","6d3546b7":"markdown","10234c80":"markdown","5a0b6652":"markdown","b3864b9d":"markdown","5b92cf73":"markdown","868c8a5c":"markdown","29b14c76":"markdown","bdd8bb61":"markdown","d68311dd":"markdown","32cc698f":"markdown","e6c90a1f":"markdown","8133edab":"markdown","7d605d6b":"markdown","b48cde7f":"markdown","2b47acb4":"markdown","f6ebbf4c":"markdown","c456701f":"markdown","738b54c6":"markdown","115040f8":"markdown","d6dec94c":"markdown","7a16bfc1":"markdown","664d1f7d":"markdown","630f1900":"markdown","7bc86737":"markdown","5bad7071":"markdown","1389a3c3":"markdown","058c6c97":"markdown","80e688d8":"markdown","79e5a66f":"markdown","cd977fdd":"markdown","201df676":"markdown","3576e2fb":"markdown","654e4dad":"markdown","bd84dd09":"markdown","0790d92d":"markdown","ef712583":"markdown"},"source":{"5b612dc6":"import numpy as np\nimport pandas as pd\npd.set_option('display.max_columns', 100)","2137836c":"df = pd.read_csv('..\/input\/atpdata\/ATP.csv')","59660b69":"df.head()","630bca44":"df.info()","841432d2":"winners = df[['winner_name', 'winner_hand', 'winner_ioc','winner_rank']]","bfefcbfe":"winners.columns = ['name', 'hand', 'country', 'rank']","5fdeaa2b":"losers = df[['loser_name', 'loser_hand', 'loser_ioc', 'loser_rank']]","bc4138c0":"losers.columns = ['name', 'hand', 'country', 'rank']","632be0ee":"frames = [winners, losers]\nplays = pd.concat(frames)","f89dcf65":"#get the best ranking of each player\nplays = plays.groupby(['name', 'hand', 'country']).agg('min').reset_index().sort_values(['rank','name'])","3624534c":"#create flag for the players who got into top 10\nplays['top10'] = plays['rank'] <= 10","ef3474a3":"plays","28556a9d":"inf = pd.read_csv('..\/input\/atp-players-overviews\/player_overviews_UNINDEXED.csv', \n                  names=['player_id','player_slug','first_name','last_name','player_url','flag_code','residence', 'birthplace','birthdate','birth_year','birth_month',\n                         'birth_day','turned_pro','weight_lbs', 'weight_kg','height_ft','height_inches','height_cm','hand','backhand'])","8c6ef392":"inf.head()","40e299d9":"#create full name so we can join with plays dataset later\ninf['name'] = inf['first_name'] + ' ' + inf['last_name']","673de1f9":"#replace zero values with nan\ninf['turned_pro'] = inf['turned_pro'].replace(0, np.nan)\ninf['height_cm'] = inf['height_cm'].replace(0, np.nan)\ninf['weight_kg'] = inf['weight_kg'].replace(0, np.nan)","6a2b0a6c":"#calculate age of the player he turned pro\ninf['turned_pro_age'] = inf['turned_pro'] - inf['birth_year']","19020565":"#change birthdate data type to date\ninf['birthdate'] = pd.to_datetime(inf['birthdate'], format='%Y.%m.%d')","116a2cef":"#select only relevant columns\ninf = inf[['name', 'residence', 'birthplace', 'birthdate', 'birth_year','birth_month', 'birth_day', 'turned_pro_age', 'weight_kg', 'height_cm', 'hand', \n           'backhand']]","6752b55e":"inf.info()","4c49e132":"inf.head()","13048acf":"#create dataset with zodiacs and its dates\ndata = {'d_start':  ['19', '21', '21', '21', '23', '23', '23', '23', '22', '22', '20', '19'],\n        'm_start':  ['3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '1', '2'],\n        'd_end':  ['20', '20', '20', '22', '22', '22', '22', '21','21', '19', '18', '20'],        \n        'm_end':  ['4', '5', '6', '7', '8', '9', '10', '11','12', '1', '2', '3'],\n        'zodiac': ['Aries', 'Taurus', 'Gemini', 'Cancer', 'Leo', 'Virgo', 'Libra', 'Scorpio', 'Sagittarius', 'Capricorn', 'Aquarius', 'Pisces']\n        }\nzdt = pd.DataFrame(data, columns = ['d_start', 'm_start', 'd_end', 'm_end', 'zodiac'])","c3d41635":"#ensure correct data types\nzdt[['d_start', 'm_start', 'd_end', 'm_end']] = zdt[['d_start', 'm_start', 'd_end', 'm_end']].apply(pd.to_numeric)","6e71e41a":"zdt.head()","93beee9b":"#generate years\nyDF = pd.DataFrame({\"Year\": pd.Series(range(1900,2020))})","1129f9da":"#cross join dataset with years only and with month, day and zodiac dataset (created in previous step)\nyDF = pd.merge(yDF.assign(key=0), zdt.assign(key=0), on='key').drop('key', axis=1)","97aa7b78":"#create full start and end date for each zodiac\nyDF['Date_start'] = pd.to_datetime(yDF.Year*10000+yDF.m_start*100+yDF.d_start,format='%Y%m%d')\nyDF['Date_end'] = pd.to_datetime(yDF.Year*10000+yDF.m_end*100+yDF.d_end,format='%Y%m%d')","bf8efab8":"#select only relevant columns\nzodiacs = yDF[['Date_start', 'Date_end', 'zodiac']]","536d8903":"zodiacs.head()","01d93341":"#create artifical key to cross join every player information with every zodiac\ninf['key'] = 0\nzodiacs['key'] = 0\ninfAll = inf.merge(zodiacs)","bdb3967c":"#filter each player with corresponding zodiac\ninfAll = infAll[(infAll.birthdate >= infAll.Date_start) & (infAll.birthdate <= infAll.Date_end)]","78c20e7a":"#drop useless columns\ninfAll.drop(['key', 'Date_start', 'Date_end'], axis=1, inplace=True)","384d6477":"infAll.info()","74b05b12":"infAll.head()","50c37db1":"#perform join with plays and player information\nout = plays.merge(infAll, on='name')","b888ee3f":"out","9313b4d4":"import plotly.express as px","1f32fc77":"fig = px.histogram(out, x=\"top10\")\nfig.show()","ebdcc770":"print(out[out['top10']].sort_values('name').name.values)","cddb86ef":"fig = px.histogram(out, x=\"zodiac\", color='zodiac').update_xaxes(categoryorder = 'total descending')\nfig.show()","708aaa33":"fig = px.histogram(out[out['top10'] == True], x=\"zodiac\", color='zodiac').update_xaxes(categoryorder = 'total descending')\nfig.show()","adc2f707":"fig = px.histogram(out, x=\"hand_y\", color='top10')\nfig.show()","da1c0e10":"fig = px.histogram(out[out['top10'] == True], x=\"top10\", color='hand_x')\nfig.show()","74306604":"fig = px.histogram(out, x=\"backhand\", color='top10')\nfig.show()","ae330528":"fig = px.histogram(out, x=\"country\", color='top10').update_xaxes(categoryorder = 'total descending')\nfig.show()","d6e076ed":"fig = px.histogram(out[out['top10'] == True], x=\"country\").update_xaxes(categoryorder = 'total descending')\nfig.show()","3c704e65":"fig = px.histogram(out, x=\"height_cm\", color='top10', nbins = 20)\nfig.show()","e606fcb5":"fig = px.histogram(out, x=\"weight_kg\", color='top10', nbins = 20)\nfig.show()","1b35dd98":"fig = px.histogram(out, x=\"turned_pro_age\", color='top10', nbins = 20)\nfig.show()","54e077ba":"!pip install googlemaps\nimport googlemaps","c160e8f6":"gmaps_key = googlemaps.Client(key=\"AIzaSyDREugpyCcRUjp_3KvPl6oOUzip6mm7NRY\")","d68dea2c":"#create columns for latitude and longtitude\nout['lon'] = None\nout['lat'] = None","9b9a9458":"#get coordinates for birthplace using google maps api\nfor i in range(len(out)):\n    geo_result = gmaps_key.geocode(out.loc[i, 'birthplace'])\n    try:\n        lon = geo_result[0][\"geometry\"][\"location\"][\"lng\"]\n        lat = geo_result[0][\"geometry\"][\"location\"][\"lat\"]\n        out.loc[i, 'lon'] = lon\n        out.loc[i, 'lat'] = lat\n    except:\n        lat = None\n        lon = None","d181637b":"fig = px.scatter_geo(out[out['top10'] == False], lon=\"lon\", lat = 'lat', color_discrete_sequence=[\"black\"],hover_name='birthplace', opacity= 0.2)\nfig.show()","8204d59b":"fig = px.scatter_geo(out[out['top10'] == True], lon=\"lon\", lat = 'lat', color='top10', color_discrete_sequence=[\"green\"],hover_name='birthplace', opacity=0.5)\nfig.show()","26ebb5ea":"#output the complete dataset\nout.to_csv('ATP_players_info_full.csv', index = False)","1f71cba2":"## 6.3 Playing hand(s)","62b90d14":"### 6.2.2 Top 10 players","6d3546b7":"1. Vast majority of the players in dataset did not get to the top 10 (135 got there vs 2569 did not)\n2. Aries and Pisces are the most frequent and also most successfull zodiacs in ATP. Leo and Cancer, despite not being the most frequent, are still pretty successfull.\n3. Most of the players are right handed therefore most of the players who got into top 10 are right handers as well. The same aplies for the two-handed backhand.\n4. As of a country the most dominant are undoubtedly USA. However only 5,4% (29\/528) of all USA players got into top 10. In comparison, Sweden which has 99 players overall has 14 players who broke into top ten, which represent 14% of all Sweden players. Similar to Sweden is situation of Spain players (16:109 = ~15%).\n5. Looking at body dimensions the most prominent players height is between 175 - 195cm and weight 70-90kg.\n6. The best age to turn pro is between 16 - 19 years.\n7. While ATP players borned around whole globe the ones who got into top 10 borned mainly in Europe and USA.","10234c80":"***","5a0b6652":"### 6.1.1 Who they were?","b3864b9d":"# 1 Plays dataset","5b92cf73":"add complete player information to the original plays dataset","868c8a5c":"## 3.1 Date-zodiac","29b14c76":"***","bdd8bb61":"# 7 Conclusion","d68311dd":"## 6.6 Player height","32cc698f":"# 2 Player information dataset","e6c90a1f":"# 6 Exploration","8133edab":"## 6.1 How many players actually got to top 10?","7d605d6b":"## 1.2 Losers","b48cde7f":"***","2b47acb4":"## 6.8 Age turned pro","f6ebbf4c":"### 6.9.1 All players","c456701f":"## 1.1 Winners","738b54c6":"## How to break into ATP top 10?\n* Get born as a Aries, Pisces or Cancer zodiac,\n* Play with right hand and both-handed backhand,\n* Play for Spain or Sweden,\n* Be around 185cm tall and weight around 80kg,\n* Turn pro at the age of 18,\n* Get born in Europe or in the USA.\n\n<div style=\"text-align: right\"><i>This is for fun purpose only.<\/div>\n<div style=\"text-align: right\"><i>This is by no means any country emphasizing\/promotion and author strictly refuses any country differences \"conflicts\".<\/div>","115040f8":"***","d6dec94c":"# 0 Imports","7a16bfc1":"## 6.2 Is there any importance on player zodiac?","664d1f7d":"create table for every day from 1900 to 2020 and corresponding zodiac","630f1900":"# 5 Join plays w\/ player info","7bc86737":"### 6.2.1 All players","5bad7071":"### 6.9.2 Top 10 players","1389a3c3":"## 1.3 Union winners w\/ losers","058c6c97":"# 4 Join player info w\/ zodiacs","80e688d8":"## 6.7 Player weight","79e5a66f":"## 6.9 Birthplace","cd977fdd":"## 6.4 Backhand","201df676":"# 3 Zodiacs","3576e2fb":"add zodiac info to the player information","654e4dad":"***","bd84dd09":"### 6.5.1 Top 10 players only","0790d92d":"## 6.5 Country","ef712583":"***"}}