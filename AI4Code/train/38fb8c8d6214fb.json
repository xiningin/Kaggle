{"cell_type":{"5b752073":"code","210b0073":"code","83e22b35":"code","dcf2b2d9":"code","f0660fc3":"code","6d879a0b":"code","8e78f4b0":"code","954482f1":"code","4b2860c5":"code","821df7c8":"code","75a34817":"code","13d0305c":"code","168bd4c1":"code","867bb91b":"code","2247d2ea":"code","46cb39b8":"code","20a38a7b":"code","94a990bc":"code","9120d59e":"code","d600e58d":"code","3a0349ad":"code","2e97b835":"code","9b4b3eed":"code","0c9fd6ae":"code","068c7897":"code","47afa36d":"code","ad4d127c":"code","64577b64":"code","064142b5":"code","b4d4b078":"code","d6a17c69":"code","17134209":"code","787063a9":"markdown","510a1c4e":"markdown"},"source":{"5b752073":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport plotly.express as px\nfrom sklearn.model_selection import train_test_split","210b0073":"heart = pd.read_csv('..\/input\/heart-attack-analysis-prediction-dataset\/heart.csv')\no2Sat = pd.read_csv('..\/input\/heart-attack-analysis-prediction-dataset\/o2Saturation.csv')","83e22b35":"heart.head()","dcf2b2d9":"#\u00bfo2Sat.head()?","f0660fc3":"heart.info()","6d879a0b":"heart.isnull().sum()","8e78f4b0":"heart.describe()","954482f1":"plt.rcParams[\"figure.figsize\"] = (20, 12)\nheart.hist()\nplt.show()","4b2860c5":"fig = px.histogram(heart, x = 'age', color = 'output')\nfig.show()","821df7c8":"fig = px.histogram(heart, x = 'age', color = 'output')\nfig.show()","75a34817":"plt.rcParams[\"figure.figsize\"] = (15, 15)\nsns.pairplot(heart, hue = 'output',\n             vars = ['age', 'sex', 'cp', 'trtbps', 'chol', 'fbs', 'restecg'],\n            kind = 'reg')","13d0305c":"plt.rcParams[\"figure.figsize\"] = (15, 15)\nsns.pairplot(heart, hue = 'output',\n             vars = ['thalachh', 'exng', 'oldpeak', 'slp', 'caa', 'thall'],\n            kind = 'reg')","168bd4c1":"fig, ax = plt.subplots(figsize = (10, 8))\nsns.heatmap(heart.corr(), annot = True, \n            fmt = \".2f\", \n            cmap = 'coolwarm',\n            cbar_kws = {\"shrink\": .8})","867bb91b":"fig, ax = plt.subplots(figsize = (10, 8))\nsns.boxplot(x = \"sex\", y = \"age\",\n            hue = \"output\", palette = [\"m\", \"g\"],\n            data = heart)","2247d2ea":"y = heart['output']\nX = heart.drop(['output'], axis = 1)\n\nX_train, X_val, y_train, y_val = train_test_split(X, y, test_size = 0.2, random_state = 42)","46cb39b8":"from sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import confusion_matrix, classification_report","20a38a7b":"model1 = RandomForestClassifier(n_estimators = 100,\n                               random_state = 10)\nmodel1.fit(X_train, y_train)\npred1 = model1.predict(X_val)","94a990bc":"carac = heart.shape[1] - 1\nplt.barh(range(carac), model1.feature_importances_, align = 'center')\nplt.yticks(np.arange(carac), X.columns)\nplt.xlabel('Importancia de las caracteristicas')\nplt.ylabel('Caracteristicas')\nplt.show()","9120d59e":"confusion_matrix(y_val, pred1)","d600e58d":"print(classification_report(y_val, pred1))","3a0349ad":"from sklearn import svm","2e97b835":"model2 = svm.SVC()\nmodel2.fit(X_train, y_train)\npred2 = model2.predict(X_val)","9b4b3eed":"confusion_matrix(y_val, pred2)","0c9fd6ae":"print(classification_report(y_val, pred2))","068c7897":"from sklearn.neighbors import KNeighborsClassifier","47afa36d":"n_neighbors = 2\nmodel3 = KNeighborsClassifier(n_neighbors)\nmodel3.fit(X_train, y_train)\npred3 = model3.predict(X_val)","ad4d127c":"confusion_matrix(y_val, pred3)","64577b64":"print(classification_report(y_val, pred3))","064142b5":"from sklearn.naive_bayes import GaussianNB","b4d4b078":"model4 = GaussianNB()\nmodel4.fit(X_train, y_train)\npred4 = model4.predict(X_val)","d6a17c69":"confusion_matrix(y_val, pred4)","17134209":"print(classification_report(y_val, pred4))","787063a9":"The best classification is Gaussian Na\u00efve Bayes","510a1c4e":"About this dataset\n\nAge : Age of the patient\n\nSex : Sex of the patient\n\nexang: exercise induced angina (1 = yes; 0 = no)\n\nca: number of major vessels (0-3)\n\ncp : Chest Pain type chest pain type\n\n    Value 1: typical angina\n    Value 2: atypical angina\n    Value 3: non-anginal pain\n    Value 4: asymptomatic\n    trtbps : resting blood pressure (in mm Hg)\n\nchol : cholestoral in mg\/dl fetched via BMI sensor\n\nfbs : (fasting blood sugar > 120 mg\/dl) (1 = true; 0 = false)\n\nrest_ecg : resting electrocardiographic results\n\n    Value 0: normal\n    Value 1: having ST-T wave abnormality (T wave inversions and\/or ST elevation or depression of > 0.05 mV)\n    Value 2: showing probable or definite left ventricular hypertrophy by Estes' criteria\n    thalach : maximum heart rate achieved\n\ntarget : 0= less chance of heart attack 1= more chance of heart attack"}}