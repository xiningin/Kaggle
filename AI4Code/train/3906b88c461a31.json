{"cell_type":{"34c7a918":"code","05c81ff5":"code","cceb5f0d":"code","81089654":"code","1e7c99dc":"code","f593e6b0":"code","5461e076":"code","78293f95":"code","e054025c":"code","594c460a":"code","39feecf0":"code","dee78c43":"code","a837e59d":"code","24c78ec4":"code","ebfb4706":"code","53f02a37":"code","824602cf":"code","1f8f81cd":"code","dc14caeb":"code","bd5150f6":"code","27afb191":"code","2f8f1fb0":"code","9f547ac0":"code","fae151e1":"code","7b708fb0":"markdown","5fe2e633":"markdown","671ba3b1":"markdown","e4dbd179":"markdown","b25a8ebe":"markdown","1eb51770":"markdown","e20c8537":"markdown","53e56ed0":"markdown","833ab59f":"markdown","07d55bad":"markdown"},"source":{"34c7a918":"from pandas import read_csv, DataFrame\nfrom numpy import linspace\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set(rc={'figure.figsize':(10,6)})\nsns.set(font_scale=1.3)\nplt.style.use('fivethirtyeight')\n\nfrom sklearn.preprocessing import MinMaxScaler\nfrom sklearn.model_selection import train_test_split, GridSearchCV, cross_validate, cross_val_score\n\nfrom lightgbm import LGBMClassifier\nfrom xgboost import XGBClassifier\nfrom sklearn.ensemble import GradientBoostingClassifier, AdaBoostClassifier, ExtraTreesClassifier\nfrom sklearn.ensemble import BaggingClassifier, RandomForestClassifier, VotingClassifier\nfrom sklearn.tree import DecisionTreeClassifier, ExtraTreeClassifier\n\nfrom sklearn.metrics import accuracy_score, plot_confusion_matrix\n\nimport warnings\nwarnings.filterwarnings('ignore')","05c81ff5":"pima = read_csv('..\/input\/pima-indians-diabetes-database\/diabetes.csv')","cceb5f0d":"pima.head()","81089654":"pima.info()","1e7c99dc":"pima.describe()","f593e6b0":"print('Values 0:', repr(pima[pima.Glucose == 0].shape[0]))\nprint(pima[pima.Glucose == 0].groupby('Outcome')['Outcome'].count())","5461e076":"Glucose_0 = pima[(pima['Glucose']== 0)]\npima[(pima['Glucose']== 0) & (pima['Outcome'] == 0)] = Glucose_0[Glucose_0['Outcome']== 0].replace(0, pima[(pima['Outcome']== 0)].mean())\npima[(pima['Glucose']== 0) & (pima['Outcome'] == 1)] = Glucose_0[Glucose_0['Outcome']== 1].replace(0, pima[(pima['Outcome']== 1)].mean())","78293f95":"print(\"Values 0:\", repr(pima[pima.BloodPressure == 0].shape[0]))\nprint(pima[pima.BloodPressure == 0].groupby('Outcome')['Outcome'].count())","e054025c":"BloodPressure_0 = pima[(pima['BloodPressure']== 0)]\npima[(pima['BloodPressure']== 0) & (pima['Outcome'] == 0)] = BloodPressure_0[BloodPressure_0['Outcome']== 0].replace(0, pima[(pima['Outcome']== 0)].mean())\npima[(pima['BloodPressure']== 0) & (pima['Outcome'] == 1)] = BloodPressure_0[BloodPressure_0['Outcome']== 1].replace(0, pima[(pima['Outcome']== 1)].mean())","594c460a":"print(\"Values 0: \" + repr(pima[pima.SkinThickness == 0].shape[0]))\nprint(pima[pima.SkinThickness == 0].groupby('Outcome')['Outcome'].count())","39feecf0":"SkinThickness_0 = pima[(pima['SkinThickness']== 0)]\npima[(pima['SkinThickness']== 0) & (pima['Outcome'] == 0)] = SkinThickness_0[SkinThickness_0['Outcome']== 0].replace(0, pima[(pima['Outcome']== 0)].mean())\npima[(pima['SkinThickness']== 0) & (pima['Outcome'] == 1)] = SkinThickness_0[SkinThickness_0['Outcome']== 1].replace(0, pima[(pima['Outcome']== 1)].mean())","dee78c43":"print(\"N\u00famero de casos anormais na espessura das dobras cut\u00e2neas: \" + repr(pima[pima.SkinThickness > 60].shape[0]))\nprint(pima[pima.SkinThickness > 60]['SkinThickness'])\nprint(pima[pima.SkinThickness > 60].groupby('Outcome')['Outcome'].count())","a837e59d":"pima['SkinThickness'].iloc[579] = pima['SkinThickness'].mean()","24c78ec4":"print(\"Missing Values: \" + repr(pima[pima.Insulin == 0].shape[0]))\nprint(pima[pima.Insulin == 0].groupby('Outcome')['Outcome'].count())","ebfb4706":"Insulin_0 = pima[(pima['Insulin'] == 0)]\npima[(pima['Insulin']== 0) & (pima['Outcome'] == 0)] = Insulin_0[Insulin_0['Outcome']== 0].replace(0, pima[(pima['Outcome']== 0)].mean())\npima[(pima['Insulin']== 0) & (pima['Outcome'] == 1)] = Insulin_0[Insulin_0['Outcome']== 1].replace(0, pima[(pima['Outcome']== 1)].mean())","53f02a37":"\nprint(\"Missing Values: \" + repr(pima[pima.BMI == 0].shape[0]))\nprint(pima[pima.BMI == 0].groupby('Outcome')['Outcome'].count())","824602cf":"# Substitua o valor zero pelo valor m\u00e9dio das classes\nBMI_0 = pima[(pima['BMI']== 0)] \npima[(pima['BMI']== 0) & (pima['Outcome'] == 0)] = BMI_0[BMI_0['Outcome']== 0].replace(0, pima[(pima['Outcome']== 0)].mean())\npima[(pima['BMI']== 0) & (pima['Outcome'] == 1)] = BMI_0[BMI_0['Outcome']== 1].replace(0, pima[(pima['Outcome']== 1)].mean())","1f8f81cd":"plt.figure(figsize=(18,10))\nsns.heatmap(pima.corr(), annot=True, cmap=plt.cm.Blues);","dc14caeb":"plt.figure(figsize=(10,6))\nsns.countplot(pima['Outcome']);","bd5150f6":"columns = pima.columns[:8]\nplt.subplots(figsize=(18,20))\nlength = len(columns)\n\nfor i,j in zip(columns,range(length)):\n    plt.subplot((length\/2), 3, j+1)\n    plt.subplots_adjust(wspace=.4, hspace=.5)\n    sns.distplot(pima[i])\n    plt.title(i)\nplt.show()","27afb191":"pima.plot(kind='box', subplots=True, layout=(3,3), figsize=(14,10));","2f8f1fb0":"x = pima.drop(columns=['Outcome'])\ny = pima['Outcome']\n\nscaler = MinMaxScaler()\nx = scaler.fit_transform(x)\n\nx_train, x_test, y_train, y_test = train_test_split(x , y, test_size=0.20, stratify=y)","9f547ac0":"colunas = ['Modelo','Acuracy']\nresultado = DataFrame(columns=colunas)\n\n\nmodels = []\nmodels.append(('GradientBoostingClassifier', GradientBoostingClassifier()))\nmodels.append(('AdaBoostClassifier', AdaBoostClassifier()))\nmodels.append(('ExtraTreesClassifier', ExtraTreesClassifier()))\nmodels.append(('BaggingClassifier', BaggingClassifier()))\nmodels.append(('RandomForestClassifier', RandomForestClassifier()))\nmodels.append(('DecisionTreeClassifier', DecisionTreeClassifier()))\nmodels.append(('ExtraTreeClassifier', ExtraTreeClassifier()))\nmodels.append((\"XGBClassifier\", XGBClassifier()))\nmodels.append((\"LGBMClassifier\", LGBMClassifier()))\n\nfor nome, model in models:\n    scores = cross_val_score(model, x_train, y_train, cv=5, scoring='accuracy')\n    print(\"Train CV Accuracy: %0.2f (+\/- %0.2f) [%s]\" % (scores.mean(), scores.std(), nome))\n    md = model.fit(x_train, y_train)    \n    print(\"Test Accuracy: %0.2f \" % (accuracy_score(model.predict(x_test), y_test)))\n    print('_'*75)\n    print('')","fae151e1":"model = GradientBoostingClassifier()\nmodel.fit(x_train, y_train)\npred = model.predict(x_test)\nplot_confusion_matrix(model, x_test, y_test, cmap=plt.cm.Blues);\nplt.grid(False)\nplt.title('Result');","7b708fb0":"# <p style=\"background-color:#7cd4fc; font-family:newtimeroman; font-size:150%; text-align:center; border-radius: 95px 15px;\">Model<\/p>","5fe2e633":"<div style=\"color:black; background-color:#b1fc9a; border-radius:10px; padding:20px;\">\n- Don't have missing values.<br\/>\n- Columns Pregnancies, Glucose, BloodPressure, SkinThickness, Insulin, BMI contains values 0 thar may be incorrectly reported.    \n<\/div>","671ba3b1":"# <p style=\"background-color:#7cd4fc; font-family:newtimeroman; font-size:150%; text-align:center; border-radius: 95px 15px;\">Feature Engineering<\/p>","e4dbd179":"<div style=\"color:black; background-color:#b1fc9a; border-radius:10px; padding:20px;\">\nLooking at the chart above we can see several outliers\n<\/div>","b25a8ebe":"# <p style=\"background-color:#7cd4fc; font-family:newtimeroman; font-size:150%; text-align:center; border-radius: 95px 15px;\">Pima Indians Diabetes Database<\/p>","1eb51770":"<div style=\"color:black; background-color:#b1fc9a; border-radius:10px; padding:20px;\">\nThe missing values and 0 have been replaced by the average.\n<\/div>","e20c8537":"<div style=\"color:black; background-color:#b1fc9a; border-radius:10px; padding:20px;\">\nWe have more values 0 than 1, the dataset is unbalanced.  \n<\/div>","53e56ed0":"## Missing Valuesg","833ab59f":"# <p style=\"background-color:#7cd4fc; font-family:newtimeroman; font-size:150%; text-align:center; border-radius: 95px 15px;\">Plots<\/p>","07d55bad":"# <p style=\"background-color:#7cd4fc; font-family:newtimeroman; font-size:150%; text-align:center; border-radius: 95px 15px;\">Analysis<\/p>"}}