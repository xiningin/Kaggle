{"cell_type":{"af36e8e9":"code","ed45ea55":"code","597e1ded":"code","825d3ec8":"code","00fc0d35":"code","0af39eb8":"code","a6b7ba87":"code","48516dd9":"code","f043a738":"code","7268cd27":"code","b477d5eb":"code","7284b703":"code","8ce4b18a":"code","abc8db64":"code","51d468ad":"code","0fd808d8":"code","6c84605d":"code","fea1de71":"code","9321768b":"markdown","3b90556e":"markdown","f7c73b20":"markdown","df9acf9f":"markdown","19ee13a3":"markdown","e893a679":"markdown","456db556":"markdown","4b692fa7":"markdown","3dc79dc8":"markdown","3d6f9e1b":"markdown","056378f4":"markdown","8d25629c":"markdown","68dfc01f":"markdown","7cf590ba":"markdown","51afad83":"markdown"},"source":{"af36e8e9":"# Importando as bibliotecas essenciais para a an\u00e1lise\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.ensemble import GradientBoostingClassifier\nfrom sklearn import metrics\nfrom sklearn.metrics import plot_confusion_matrix\npd.set_option('display.max_columns', 500)","ed45ea55":"# Carregando o conjunto de dados num objeto Data Frame do Pandas\ndf = pd.read_csv('..\/input\/fetal-health-classification\/fetal_health.csv')","597e1ded":"# Exibindo as 5 primeiras linhas\ndf.head()","825d3ec8":"# Algumas informa\u00e7\u00f5es do conjunto de dados\ndf.info()","00fc0d35":"# Verificando se h\u00e1 valores ausentes no conjunto de dados\ndf.isna().sum()","0af39eb8":"# Resumo estat\u00edstico de algumas vari\u00e1veis\ndf[\n    [\n        'baseline value', 'accelerations', 'fetal_movement', 'uterine_contractions', 'light_decelerations', 'severe_decelerations', \n        'prolongued_decelerations', 'abnormal_short_term_variability', 'histogram_width', 'histogram_number_of_peaks', 'fetal_health'\n    ]\n].describe()","a6b7ba87":"fetal_health_viz = df['fetal_health'].map({1:'Normal', 2:'Suspeito', 3:'Patologico'}).value_counts()\nplt.title('Quantidade de Casos')\nsns.barplot(x = fetal_health_viz.index, y=fetal_health_viz.values);","48516dd9":"sns.pairplot(data=df[\n    ['baseline value', 'accelerations', 'fetal_movement', 'uterine_contractions', 'light_decelerations',\n     'abnormal_short_term_variability', 'histogram_width', 'histogram_number_of_peaks', 'fetal_health'\n    ]\n], hue='fetal_health');","f043a738":"corr = df.corr()\nplt.figure(figsize=(15,12))\nplt.title('Mapa de Calor de Correla\u00e7\u00e3o Entre Vari\u00e1veis')\nsns.heatmap(corr, annot=True, vmin=-1, vmax=1);","7268cd27":"X = np.array(df.iloc[:, :-1])\ny = np.array(df.iloc[:, -1])","b477d5eb":"std = StandardScaler()\nX = std.fit_transform(X)","7284b703":"# Separando 70% para treino e 30% para teste\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=10)","8ce4b18a":"# Iniciando o modelo\ntree = DecisionTreeClassifier(random_state=1)\n\n# Treinando o modelo\ntree.fit(X_train, y_train)\n\n# Realizando as predi\u00e7\u00f5es\ny_pred = tree.predict(X_test)","abc8db64":"print('\\nAccuracy\\n', metrics.accuracy_score(y_test, y_pred)) \nprint('\\nClass Balanced Accuracy\\n', metrics.balanced_accuracy_score(y_test, y_pred))\nprint('\\nClassification Report\\n', metrics.classification_report(y_test, y_pred))\nprint('\\nConfusion Matrix')\nplot_confusion_matrix(tree, X_test, y_test,cmap='Blues');","51d468ad":"# Iniciando o modelo\nrandom_forest = RandomForestClassifier(random_state=1)\n\n# Treinando o modelo\nrandom_forest.fit(X_train, y_train)\n\n# Realizando as predi\u00e7\u00f5es\ny_pred = random_forest.predict(X_test)","0fd808d8":"print('\\nAccuracy\\n', metrics.accuracy_score(y_test, y_pred)) \nprint('\\nClass Balanced Accuracy\\n', metrics.balanced_accuracy_score(y_test, y_pred))\nprint('\\nClassification Report\\n', metrics.classification_report(y_test, y_pred))\nprint('\\nConfusion Matrix')\nplot_confusion_matrix(random_forest, X_test, y_test,cmap='Blues');","6c84605d":"# Iniciando o modelo\ngbc = GradientBoostingClassifier(random_state=1)\n\n# Treinando o modelo\ngbc.fit(X_train, y_train)\n\n# Realizando as predi\u00e7\u00f5es\ny_pred = gbc.predict(X_test)","fea1de71":"print('\\nAccuracy\\n', metrics.accuracy_score(y_test, y_pred)) \nprint('\\nClass Balanced Accuracy\\n', metrics.balanced_accuracy_score(y_test, y_pred))\nprint('\\nClassification Report\\n', metrics.classification_report(y_test, y_pred))\nprint('\\nConfusion Matrix')\nplot_confusion_matrix(gbc, X_test, y_test,cmap='Blues');","9321768b":"# Visualizando Dados\n---","3b90556e":"### Avaliando o Modelo de \u00c1rvore de Decis\u00e3o\n#### M\u00e9tricas:\n* Matrix de Confus\u00e3o\n* Acur\u00e1cia\n* Acur\u00e1cia Balanceada por Classe\n* Relat\u00f3rio das Principais M\u00e9tricas ","f7c73b20":"## Floresta Rand\u00f4mica\n---","df9acf9f":"### Normaliza\u00e7\u00e3o dos Dados","19ee13a3":"## Gradient Boosting\n---","e893a679":"## Aplicando Modelos de Aprendizado de M\u00e1quina nos Dados\n* **\u00c1rvore de Decis\u00e3o**\n* **Floresta Rand\u00f4mica**\n* **Gradient Boosting**","456db556":"### Avaliando o Modelo de Floresta Rand\u00f4mica\n#### M\u00e9tricas:\n* Matrix de Confus\u00e3o\n* Acur\u00e1cia\n* Acur\u00e1cia Balanceada por Classe\n* Relat\u00f3rio das Principais M\u00e9tricas ","4b692fa7":"### Separando os R\u00f3tulos dos Dados","3dc79dc8":"# Pr\u00e9-processamento dos Dados\n---","3d6f9e1b":"### Separando os Dados em Treino e Teste (Valida\u00e7\u00e3o)","056378f4":"### Avaliando o Modelo de Gradient Boosting\n#### M\u00e9tricas:\n* Matrix de Confus\u00e3o\n* Acur\u00e1cia\n* Acur\u00e1cia Balanceada por Classe\n* Relat\u00f3rio das Principais M\u00e9tricas ","8d25629c":"# Classifica\u00e7\u00e3o de Sa\u00fade Fetal\n\n## Classifique a sa\u00fade de um feto como Normal, Suspeita ou Patol\u00f3gica usando dados CTG\n\n---\n### Contexto\n\nA redu\u00e7\u00e3o da mortalidade infantil est\u00e1 refletida em v\u00e1rios Objetivos de Desenvolvimento Sustent\u00e1vel das Na\u00e7\u00f5es Unidas e \u00e9 um indicador chave do progresso humano.\nA ONU espera que, at\u00e9 2030, os pa\u00edses acabem com as mortes evit\u00e1veis \u200b\u200bde rec\u00e9m-nascidos e crian\u00e7as menores de 5 anos de idade, com todos os pa\u00edses visando reduzir a mortalidade de menores de 5 anos para pelo menos 25 por 1.000 nascidos vivos.\n\n\nParalela \u00e0 no\u00e7\u00e3o de mortalidade infantil est\u00e1, claro, a mortalidade materna, que \u00e9 respons\u00e1vel por 295.000 mortes durante e ap\u00f3s a gravidez e o parto (em 2017). A grande maioria dessas mortes (94%) ocorreu em locais com poucos recursos e a maioria poderia ter sido evitada .\n\n\nDiante do exposto acima, os Cardiotocogramas (CTGs) s\u00e3o uma op\u00e7\u00e3o simples e de baixo custo para avaliar a sa\u00fade fetal, permitindo aos profissionais de sa\u00fade atuarem na preven\u00e7\u00e3o da mortalidade infantil e materna. O pr\u00f3prio equipamento funciona enviando pulsos de ultrassom e lendo sua resposta, lan\u00e7ando luz sobre a frequ\u00eancia card\u00edaca fetal (FCF), movimentos fetais, contra\u00e7\u00f5es uterinas e muito mais.","68dfc01f":"\n##### **Cita\u00e7\u00e3o**\n\nAyres de Campos et al. (2000) SisPorto 2.0 A Program for Automated Analysis of Cardiotocograms. J Matern Fetal Med 5: 311-318 ( link )\n\n##### **Licen\u00e7a**\nA licen\u00e7a n\u00e3o foi especificada na fonte, mas o acesso aos dados \u00e9 p\u00fablico e uma cita\u00e7\u00e3o foi solicitada.","7cf590ba":"# Explorando os Dados\n---","51afad83":"## \u00c1rvore de Decis\u00e3o\n---"}}