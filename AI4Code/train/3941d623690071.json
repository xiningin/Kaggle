{"cell_type":{"6508905c":"code","78f30d2b":"code","95cd5c3e":"code","27763b5b":"code","cfc4d5b8":"code","fe697a2e":"code","22e65e0d":"code","dc659f52":"code","93778b2d":"code","c66f6b23":"code","4fa60520":"code","6550f164":"code","a53f7869":"code","a0211e1a":"code","a30b8a14":"code","7e236aa9":"code","406e2e41":"code","f8cf73dc":"code","0f229591":"code","e1496708":"code","916712c8":"code","b8cb875b":"code","f75fb653":"code","e552622a":"code","c333be72":"code","5477fc82":"code","b3c6f0fe":"code","34e9f75a":"code","803e44fa":"code","4e772e8c":"code","14291498":"code","a1dd2f82":"code","6ddd0d8c":"code","3b61436e":"code","5d4d5708":"code","e56e6d29":"code","37245af8":"code","8a6b9dd3":"code","54b3f87a":"code","f536a0e3":"code","2f37a93f":"code","aa5d8c3c":"code","66e6120c":"code","50ac32f6":"code","2593bd87":"code","b2de6c8d":"code","62ae4c2a":"code","f8296963":"code","a49cbda7":"code","8a8a2c4a":"code","7beb1779":"code","a18091f8":"code","9dc9a2c3":"code","d6274559":"code","e335444f":"code","8c2d2626":"code","065bea0e":"code","048d0ad1":"code","cfd6c2b7":"code","411dc65a":"code","8764d201":"code","935ee24a":"code","b470bbad":"code","c93136c7":"code","e18770b9":"code","2bfeb8db":"code","0c3c0bac":"code","7aff06a3":"code","cd424dd3":"code","9977ed6e":"code","d8ee0c90":"code","6ce13192":"code","65593d3f":"code","96fe44ff":"code","6087eeda":"code","f6003ddd":"code","c01e71e8":"code","fc8449ea":"code","c2c082b6":"code","0234ac8f":"code","264fd6a6":"code","5a927160":"code","50f2e17d":"code","b3635260":"code","6e9837d8":"code","effdf674":"code","e292317e":"code","5968970e":"code","69fb4033":"code","52d46140":"code","1e6231e2":"code","2ab24966":"code","41267e8b":"code","a89d34b7":"code","985e36a1":"code","b55aef1b":"code","a9d49dd6":"code","eb0a4610":"code","0a340956":"code","450be510":"code","eb15de47":"code","38619597":"code","3d17282a":"code","ee6ea489":"code","810a7555":"code","b54afb51":"code","dc418de4":"code","6e6fad8e":"code","e6ee9756":"code","fe57443f":"code","bcaf06c4":"code","d98c719d":"code","f5b0ca1f":"code","674ca2de":"code","05d47010":"code","50d6eea1":"code","0f6265c3":"code","44b295e9":"code","ec1d8344":"code","6b129e44":"code","146548e0":"code","9428ccea":"code","e63e332b":"code","fa8bf1b7":"code","8ff91c45":"code","2716dda3":"code","71255a22":"code","b4214cd4":"code","405527ce":"code","a0300e10":"code","d02fdd86":"code","ca6f233f":"code","9862f6cf":"code","7020dee2":"code","481484a0":"code","454d421d":"code","ce536f68":"code","0909a75b":"code","25128887":"code","7a548102":"code","be482a8e":"code","60bae19c":"code","1e8514ff":"code","6832ab9e":"code","e337ebb4":"code","3c5517fa":"code","5f0ea1e9":"code","9827b4a9":"code","bb67022b":"code","08c5d4f5":"code","ac67a4d9":"code","6fb87195":"code","5914f3c8":"code","79839660":"code","e5abaa15":"code","cab877af":"code","c4f5b9bc":"code","4e6760ef":"code","6d1c5ad0":"code","b27e2ae4":"code","d9b69aa5":"code","6bee193d":"code","6fd64a57":"code","12846ed0":"code","d77ee1e2":"code","338a6b48":"code","79944978":"code","e1dd6516":"code","d21bdf52":"code","eae8b1d8":"code","1bdec723":"code","d9a6925d":"code","90fa7bee":"code","a70a8fd2":"code","6bcf8669":"code","7477a532":"code","67b93659":"code","37d6b731":"code","c5992705":"code","15a36153":"code","0994cd39":"code","15c849f7":"code","2c931c2a":"code","4df897a3":"code","5e82f9dc":"code","52e30504":"code","1413988c":"code","e9549d63":"code","8831091e":"code","d30ce483":"code","fad83b90":"code","465d6aae":"code","0c6015e0":"code","e4174204":"code","8be6ac19":"code","5662524f":"code","7da94399":"code","6b6b93b3":"code","100e7181":"code","3d3e1429":"code","d4897696":"code","679f16ec":"code","bbba2a36":"code","e302df76":"code","62d6f9ca":"code","5813c9e0":"code","01541b8c":"code","25f2d818":"code","d184f568":"code","4e158fee":"code","7da7db59":"code","7e0f3877":"code","76e83c3e":"code","60ed81b1":"code","019caf6b":"code","e968acfa":"code","14670061":"code","fd82da8e":"code","83c2d6a1":"code","f15fa09f":"code","ae55ee1d":"code","6b6489a9":"code","99110171":"code","8e0e6059":"code","e743ed80":"code","4f2935c0":"code","268b4fee":"code","83cae6c8":"code","d94bc661":"code","1faea3a4":"code","354583cc":"code","ac486ddb":"code","4b454e3f":"code","1517cc4c":"code","01af1289":"code","b16db0ba":"code","822cf3c4":"code","fa27f7c6":"code","c6ceb9a5":"code","7333620f":"code","f6be9e6c":"code","08f3f621":"code","70902d58":"code","cb1885e2":"code","c22a0cfa":"code","bfc0d4f5":"code","176d6666":"code","7629e625":"code","43c98730":"code","8d961935":"code","230347ad":"code","d54a1ffc":"code","f357f26b":"code","bea3a44a":"code","7d848b6f":"code","1d43ef1d":"code","40eb85d5":"code","f12c1b7e":"code","b5b4c570":"code","e8560a1f":"code","bfa90bae":"code","eab7435e":"code","9383c7df":"code","acf36def":"code","1c66d79a":"code","42c12ee7":"code","b6987f00":"code","1352112a":"code","217cde31":"code","35adb586":"code","0e2b1a88":"code","8e0ac2a9":"code","8c48751e":"code","7df706a0":"code","056d4b49":"code","1c36ce6d":"code","d43718a7":"code","56df49f2":"code","05ed11b9":"code","a7c30730":"code","6da84ea7":"code","afd3fdb0":"code","82e4b8ac":"code","bed7bcc0":"code","317d236e":"code","83be325d":"code","387d7f69":"code","eea864cf":"code","953c5178":"code","fa4ac282":"code","0d7826ce":"code","a3744cce":"code","c6fea481":"code","cdc77c1c":"code","8412f40f":"code","e8879b66":"code","50aa39f7":"code","25160f2a":"code","169501a5":"code","d98b8701":"code","e474006b":"code","15047cc1":"code","2af0aaad":"code","6017a852":"code","cc821bff":"code","1d8eedf0":"code","65a96cdb":"code","61080605":"code","5469cab8":"code","a4122a1b":"code","424cfd29":"code","7b880c22":"code","50184d3c":"code","7fcd22d3":"code","e910aada":"code","b25f0783":"code","3487817c":"code","1c8e96bc":"code","11d4194e":"code","7c44effe":"code","2dfa8f09":"code","6c13b208":"code","eaedf81e":"code","0874d8e6":"code","33a7e6d0":"code","20e44d80":"code","fc925dd3":"code","baf1abaa":"code","228ca33a":"code","85c0d49a":"code","ea83aed1":"code","90eaba7c":"code","87c0cadf":"code","bcec4e6e":"code","2911748e":"code","d3259355":"code","40ea6f3b":"code","0104d3df":"code","d07f3429":"code","4f4408cd":"code","504fb483":"code","97a31279":"code","269a30e4":"code","c47f1196":"code","8aa0035b":"code","61f3acc9":"code","5f10e9e5":"code","87b4fc08":"code","4b824914":"code","0285678e":"code","989d4574":"code","11064d9c":"code","04459650":"code","550efc15":"code","c218e8de":"code","1b763524":"code","08909d05":"code","755c9d42":"code","2c5020fc":"code","9653ee88":"markdown","6e412e62":"markdown","1a1b4ca4":"markdown","7dcac354":"markdown","601efda4":"markdown","184ec1e6":"markdown","fe8cf5a4":"markdown","89faf168":"markdown","e6131985":"markdown","c3ad0d96":"markdown","d03b3d51":"markdown","0bf5e327":"markdown","ab01fa5c":"markdown","8d18d905":"markdown","ee489cd3":"markdown","5a094b66":"markdown","f309643f":"markdown","ae9f0987":"markdown","df8caff2":"markdown","7a88b90f":"markdown","9b1843c8":"markdown","50db3579":"markdown","61b99f47":"markdown","6915ad88":"markdown","e1d28373":"markdown","f02eabed":"markdown","aa060914":"markdown","e9cf9348":"markdown","b3a95565":"markdown","d5407f3c":"markdown","05994785":"markdown","7cc52d94":"markdown","697d566f":"markdown","a88ee29f":"markdown","e1635a32":"markdown","fd37971a":"markdown","98e7520f":"markdown","29596d17":"markdown","697e9cdb":"markdown","9c3dfeeb":"markdown","7e18fb28":"markdown","9a69d261":"markdown","dac08043":"markdown","1d1ac82a":"markdown","45f53b14":"markdown","ec09ab98":"markdown","9b5b04cd":"markdown","be277eb5":"markdown","0f23f3ac":"markdown","88da8e69":"markdown","bd9a210b":"markdown","75d69551":"markdown","f454e5f0":"markdown","4b7f5a1c":"markdown","d2d0acc5":"markdown"},"source":{"6508905c":"import pandas as pd\nimport numpy as np\nimport scipy.stats as st\nimport statsmodels.stats as sm\nimport statsmodels.stats.api as sma\nimport statsmodels.api as sa\nimport matplotlib.pyplot as plt\nimport seaborn as sns","78f30d2b":"# changes in matplotlib default parameters\ndef mydefault_plt_parameters(figsize=(12, 8), mult_param=1.0):\n    plt.rcParams['figure.figsize'] = figsize\n    plt.rcParams['font.size'] = np.around(18 * mult_param)\n    plt.rcParams['axes.titlepad'] = np.around(20 * mult_param)\n    plt.rcParams['axes.labelpad'] = np.around(15 * mult_param)\n    plt.rcParams['figure.titleweight'] = 'bold'\n    plt.rcParams['axes.titleweight'] = 'bold'\n    plt.rcParams['legend.framealpha'] = 1\n    plt.rcParams['legend.facecolor'] = (0.95,0.95,0.95)\n    plt.rcParams['legend.edgecolor'] = (0.95,0.95,0.95)\n    plt.rcParams['savefig.orientation'] = 'landscape'\n    plt.rcParams['savefig.dpi'] = 300\n    plt.rcParams['savefig.bbox'] = 'tight'","95cd5c3e":"def set_sns_colors(is_mono=False, color_palette=None,\n                   ncolors=None, desat=None):\n    if color_palette is None:\n        if is_mono:\n            sns.set_palette(sns.light_palette(\"navy\"))\n        else:\n            sns.set_palette(\"Set2\")\n    else:\n        sns.set_palette(color_palette, ncolors, desat)\n    return sns.color_palette()","27763b5b":"sns.set_style(\"whitegrid\")\nlist_colors = set_sns_colors()\nmydefault_plt_parameters()","cfc4d5b8":"def test_normality(x, feature_name, alpha=0.05):\n    x = np.array(x)\n    if len(x) < 5000:\n        my_index = [\"Shapiro-Wilk\", \"Jarque-Bera\", \"Anderson-Darling\"]\n    else:\n        my_index = [\"Kolmogorov-Smirnov\", \"Jarque-Bera\", \"Anderson-Darling\"]\n    df_normality = pd.DataFrame(index=my_index, columns=[\"p_value\"])\n    if len(x) < 5000:\n        df_normality.iloc[0, 0] = np.round(st.shapiro(x)[1], 4)\n    else:\n        forced_mean = x.mean()\n        forced_var = x.var(ddof=1)\n        df_normality.iloc[0, 0] = np.round(\n            st.kstest(x, cdf=\"norm\",\n                      args=(forced_mean, np.sqrt(forced_var)))[1],\n            4)\n    df_normality.iloc[1, 0] = np.round(sm.stattools.jarque_bera(x)[1], 4)\n    df_normality.iloc[2, 0] = np.round(sm.diagnostic.normal_ad(x)[1], 4)\n    df_normality[\"Accept H0\"] = [v >= alpha for v in df_normality.p_value]\n    print(\"{} - Normality Test - Risk level = {:.0%}\".format(\n        feature_name, alpha))\n    print(\"    H0 : Feature distribution is normal\")\n    print(\"    H1 : Feature distribution is not normal\")\n    print(df_normality.T)","fe697a2e":"def graph_boxplot(feature, feature_name, units, my_ax):\n    bplot = my_ax.boxplot(feature, showmeans=True, widths=0.7,\n                          vert=False, patch_artist=True)\n    bplot['boxes'][0].set_facecolor(list_colors[0])\n    bplot['boxes'][0].set_alpha(1)\n    bplot['medians'][0].set_color('black')\n    bplot['fliers'][0].set_markeredgecolor('grey')\n    bplot['fliers'][0].set_markerfacecolor(list_colors[0])\n    bplot['fliers'][0].set_alpha(1)\n    bplot['means'][0].set_marker('o')\n    bplot['means'][0].set_markeredgecolor('black')\n    bplot['means'][0].set_markerfacecolor('black')\n    my_ax.set_yticklabels([feature_name])\n    my_ax.set_xlabel(units)","22e65e0d":"def graph_henry_plot(feature, my_ax):\n    sa.qqplot(feature, fit=True, markeredgecolor=list_colors[0],\n              markerfacecolor=list_colors[0], alpha=0.5, ax=my_ax)\n    ymin, ymax = my_ax.get_ylim()\n    xmin, xmax = my_ax.get_xlim()\n    data_min = min(xmin, ymin)\n    data_max = max(xmax, ymax)\n    my_ax.plot([data_min, data_max], [data_min, data_max],\n               color=list_colors[1])\n    my_ax.set_xlabel(\"Theorical quantiles of the Normal law\")\n    my_ax.set_ylabel(\"Observed quantiles of the feature\")\n    my_ax.autoscale(enable=True, axis='both', tight=True)","dc659f52":"def graph_normal_distribution(feature, feature_name, my_ax, y_max=None,\n                              legend_loc=\"upper right\", bins=20):\n    my_ax.hist(feature, bins=bins, label=feature_name, density=True,\n               color=list_colors[0], alpha=1)\n    x_theo = np.linspace(feature.min(), feature.max(), 100)\n    data_mean = feature.mean()\n    data_std = feature.std(ddof=1)\n    my_ax.plot(x_theo, st.norm.pdf(x_theo, loc=data_mean, scale=data_std),\n               label=\"Normal law\", color=list_colors[1], linewidth=1.5)\n    my_ax.set_xlabel(feature_name)\n    ymin, ymax = my_ax.get_ylim()\n    if y_max is not None:\n        ymax = y_max\n    my_ax.set_ylim([ymin, ymax])\n    my_ax.set_ylabel(\"Distribution (%)\")\n    my_ax.legend(loc=legend_loc)","93778b2d":"def graph_quant_feature(x, feature_name, units, figsize=(12,9),\n                        ymax=None, bins=20, legend_loc=\"upper right\"):\n    title = \"{} : Feature distribution\".format(feature_name)\n    fig = plt.figure(figsize=figsize)\n    fig.subplots_adjust(wspace=0.25, hspace=0.25)\n    gs = plt.GridSpec(3, 2, figure=fig)\n    fig.suptitle(title, y=1.05)\n    ax = []\n    ax.append(fig.add_subplot(gs[0, :]))\n    ax.append(fig.add_subplot(gs[1:, 0]))\n    ax.append(fig.add_subplot(gs[1:, 1]))\n    \n    graph_boxplot(feature, feature_name, units, ax[0])\n    ax[0].set_title(\"Boxplot\", fontweight='regular')\n    \n    graph_henry_plot(feature, ax[1])\n    ax[1].set_title(\"Henry plot\", fontweight='regular')\n    \n    graph_normal_distribution(feature, feature_name, ax[2], y_max=ymax,\n                              bins=bins, legend_loc=legend_loc)\n    ax[2].set_title(\"Distribution plot\", fontweight='regular')\n    fig.tight_layout()\n    plt.show()","c66f6b23":"def graph_categ_feature(feature, feature_name, index_as_int=False,\n                        ticklabels_rotation=None, labelsize=None,\n                        force_pie=False, force_startangle=None,\n                        figsize=(12,9)):\n    distrib_values = feature.value_counts()\n    if index_as_int:\n        labels = distrib_values.index.values.astype(int)\n    else:\n        labels = distrib_values.index\n    if force_startangle is None:\n        force_startangle = 90\n    if ticklabels_rotation is None:\n        ticklabels_rotation = 30\n    if (ticklabels_rotation > 0) & (ticklabels_rotation < 90):\n        ha=\"right\"\n    else:\n        ha=\"center\"\n    if labelsize is None:\n        labelsize = 15\n    title = \"{} : Feature distribution\".format(feature_name)\n    fig = plt.figure(figsize=figsize)\n    ax = plt.axes()\n    fig.suptitle(title)\n    if (len(distrib_values) <= 5) | force_pie:\n        ax.pie(distrib_values, labels=labels, autopct=\"%1.1f%%\",\n               startangle=force_startangle, counterclock=False)\n    else:\n        sns.barplot(x=labels, y=distrib_values, ax=ax)\n        ax.tick_params(axis=\"x\", rotation=ticklabels_rotation,\n                       labelsize=labelsize)\n        ax.set_xlabel(\"\")\n        ax.set_ylabel(\"Number of occurrences\")\n    plt.show()","4fa60520":"def my_signed_sqrt(x_serie):\n    return np.sqrt(np.abs(x_serie)) * \\\n        np.sign(x_serie)","6550f164":"def downcast_df_int8(df):\n    float_cols = [col for col in df\n                  if df[col].dtype == \"float64\"]\n    int_cols = [c for c in df\n                if df[c].dtype in [\"int64\", \"int32\"]]\n    if \"item_id\" in df.columns:\n        int_cols.remove(\"item_id\")\n        df[\"item_id\"] = df.item_id.astype(np.int16)\n    if \"shopitem_id\" in df.columns:\n        int_cols.remove(\"shopitem_id\")\n        df[\"shopitem_id\"] = df.shopitem_id.astype(np.int32)\n    df[float_cols] = df[float_cols].astype(np.float32)\n    df[int_cols] = df[int_cols].astype(np.int8)\n    return df","a53f7869":"data = pd.read_csv(\"..\/input\/an-economic-oriented-feature-engineering\/alldata_descriptive.csv\")\ndata = downcast_df_int8(data)\ndata.info()","a0211e1a":"feature = data.item_cnt_month\nfeature_name = \"Item Count Month\"\nfeature.describe()","a30b8a14":"test_normality(feature, feature_name)","7e236aa9":"graph_quant_feature(feature, feature_name, \"Monthly Sales\")","406e2e41":"feature = data[(data.item_cnt_month > 0) &\n               (data.item_cnt_month <= 20)].item_cnt_month\nfeature_name = \"Item Count Month\"\nfeature.describe()","f8cf73dc":"test_normality(feature, feature_name)","0f229591":"graph_quant_feature(feature, feature_name, \"Monthly Sales\")","e1496708":"feature = np.log(\n    data[(data.item_cnt_month > 0) &\n         (data.item_cnt_month <= 20)].item_cnt_month)\nfeature_name = \"Log of Item Count Month\"\nfeature.describe()","916712c8":"test_normality(feature, feature_name)","b8cb875b":"graph_quant_feature(feature, feature_name, \"Log of Monthly Sales\")","f75fb653":"feature = data.item_cnt_month.clip(0, 20)\nfeature_name = \"Clipped Item Cnt Month\"\nfeature.describe()","e552622a":"graph_quant_feature(feature, feature_name, \"Clipped Monthly Sales\")","c333be72":"feature = data[data.item_cnt_month > 0].\\\n    item_cnt_month.clip(0, 20)\nfeature_name = \"Clipped Item Cnt Month\"\nfeature.describe()","5477fc82":"graph_quant_feature(feature, feature_name, \"Clipped Monthly Sales\")","b3c6f0fe":"feature = np.log(feature)\nfeature_name = \"Log of Clipped Values\"\nfeature.describe()","34e9f75a":"test_normality(feature, feature_name)","803e44fa":"graph_quant_feature(feature, feature_name, \"Log of Clipped Monthly Sales\")","4e772e8c":"feature = data.item_seniority\nfeature_name = \"Item seniority\"\nfeature.describe()","14291498":"test_normality(feature, feature_name)","a1dd2f82":"graph_quant_feature(feature, feature_name, \"Seniority (in months)\",\n                    bins=34, ymax=0.06)","6ddd0d8c":"feature = data.shop_seniority\nfeature_name = \"Shop seniority\"\nfeature.describe()","3b61436e":"test_normality(feature, feature_name)","5d4d5708":"graph_quant_feature(feature, feature_name, \"Seniority (in months)\",\n                    bins=34, ymax=0.06)","e56e6d29":"feature = data.shopitem_seniority\nfeature_name = \"Shop\/Item seniority\"\nfeature.describe()","37245af8":"test_normality(feature, feature_name)","8a6b9dd3":"graph_quant_feature(feature, feature_name, \"Seniority (in months)\",\n                    bins=34, ymax=0.07)","54b3f87a":"feature = data.item_stopped\nfeature_name = \"Item stopped\"\nfeature.describe()","f536a0e3":"test_normality(feature, feature_name)","2f37a93f":"graph_quant_feature(feature, feature_name,\n                    \"Months since stopped (in months)\",\n                    bins=34, ymax=0.06)","aa5d8c3c":"feature = data.shop_stopped\nfeature_name = \"Shop stopped\"\nfeature.describe()","66e6120c":"test_normality(feature, feature_name)","50ac32f6":"graph_quant_feature(feature, feature_name,\n                    \"Months since stopped (in months)\",\n                    bins=34, ymax=0.06)","2593bd87":"feature = data.shopitem_stopped\nfeature_name = \"Shop\/Item stopped\"\nfeature.describe()","b2de6c8d":"test_normality(feature, feature_name)","62ae4c2a":"graph_quant_feature(feature, feature_name,\n                    \"Months since stopped (in months)\",\n                    bins=34, ymax=0.06)","f8296963":"feature = data.shop_avg_itemseniority_firstsell\nfeature_name = \"Shop Avg Itemseniority\"\nfeature.describe()","a49cbda7":"test_normality(feature, feature_name)","8a8a2c4a":"graph_quant_feature(feature, feature_name,\n                    \"In months\")","7beb1779":"feature = np.log(data.shop_avg_itemseniority_firstsell)\nfeature_name = \"Log of Shop Avg Itemseniority\"\nfeature.describe()","a18091f8":"test_normality(feature, feature_name)","9dc9a2c3":"graph_quant_feature(feature, feature_name,\n                    \"Log of months\", ymax=1.4)","d6274559":"feature = data.shop_min_itemseniority_firstsell\nfeature_name = \"Shop Min Itemseniority\"\nfeature.describe()","e335444f":"feature = data.shop_max_itemseniority_firstsell\nfeature_name = \"Shop Max Itemseniority\"\nfeature.describe()","8c2d2626":"test_normality(feature, feature_name)","065bea0e":"graph_quant_feature(feature, feature_name,\n                    \"In months\")","048d0ad1":"feature = data.category_avg_itemseniority_firstsell\nfeature_name = \"Cat Avg Itemseniority\"\nfeature.describe()","cfd6c2b7":"test_normality(feature, feature_name)","411dc65a":"graph_quant_feature(feature, feature_name,\n                    \"In months\")","8764d201":"feature = data.category_min_itemseniority_firstsell\nfeature_name = \"Cat Min Itemseniority\"\nfeature.describe()","935ee24a":"feature = data.category_max_itemseniority_firstsell\nfeature_name = \"Cat Max Itemseniority\"\nfeature.describe()","b470bbad":"test_normality(feature, feature_name)","c93136c7":"graph_quant_feature(feature, feature_name,\n                    \"In months\")","e18770b9":"feature = data.maincategory_avg_itemseniority_firstsell\nfeature_name = \"MainCat Avg Itemseniority\"\nfeature.describe()","2bfeb8db":"test_normality(feature, feature_name)","0c3c0bac":"graph_quant_feature(feature, feature_name,\n                    \"In months\")","7aff06a3":"feature = data.maincategory_min_itemseniority_firstsell\nfeature_name = \"MainCat Min Itemseniority\"\nfeature.describe()","cd424dd3":"feature = data.maincategory_max_itemseniority_firstsell\nfeature_name = \"MainCat Max Itemseniority\"\nfeature.describe()","9977ed6e":"test_normality(feature, feature_name)","d8ee0c90":"graph_quant_feature(feature, feature_name,\n                    \"In months\")","6ce13192":"feature = data.month\nfeature_name = \"Month\"\nfeature.describe()","65593d3f":"graph_categ_feature(feature, feature_name, index_as_int=True,\n                   ticklabels_rotation=0)","96fe44ff":"feature = data.nb_days\nfeature_name = \"Number of days in the month\"\ngraph_categ_feature(feature, feature_name, index_as_int=True,\n                   ticklabels_rotation=0)","6087eeda":"feature = data.nb_mondays\nfeature_name = \"Number of mondays in the month\"\ngraph_categ_feature(feature, feature_name, index_as_int=True,\n                   ticklabels_rotation=0)","f6003ddd":"feature = data.nb_mondays\nfeature_name = \"Number of tuesdays in the month\"\ngraph_categ_feature(feature, feature_name, index_as_int=True,\n                   ticklabels_rotation=0)","c01e71e8":"feature = data.nb_wednesdays\nfeature_name = \"Number of wednesdays in the month\"\ngraph_categ_feature(feature, feature_name, index_as_int=True,\n                   ticklabels_rotation=0)","fc8449ea":"feature = data.nb_thursdays\nfeature_name = \"Number of thursdays in the month\"\ngraph_categ_feature(feature, feature_name, index_as_int=True,\n                   ticklabels_rotation=0)","c2c082b6":"feature = data.nb_fridays\nfeature_name = \"Number of fridays in the month\"\ngraph_categ_feature(feature, feature_name, index_as_int=True,\n                   ticklabels_rotation=0)","0234ac8f":"feature = data.nb_saturdays\nfeature_name = \"Number of saturdays in the month\"\n\ngraph_categ_feature(feature, feature_name, index_as_int=True,\n                   ticklabels_rotation=0)","264fd6a6":"feature = data.nb_sundays\nfeature_name = \"Number of sundays in the month\"\ngraph_categ_feature(feature, feature_name, index_as_int=True,\n                   ticklabels_rotation=0)","5a927160":"feature = data.shop_city\nfeature_name = \"Shop City\"\ngraph_categ_feature(feature, feature_name,\n                   ticklabels_rotation=90)","50f2e17d":"feature = data.shop_isonline\nfeature_name = \"Online shops\"\ngraph_categ_feature(feature, feature_name)","b3635260":"feature = data.item_category_id\nfeature_name = \"Category ID\"\ngraph_categ_feature(feature, feature_name,\n                   ticklabels_rotation=90,\n                   labelsize=11)","6e9837d8":"feature = data.main_category\nfeature_name = \"Main Category\"\ngraph_categ_feature(feature, feature_name,\n                   ticklabels_rotation=90)","effdf674":"feature = data.category_online\nfeature_name = \"Items sold only by the online warehouse\"\ngraph_categ_feature(feature, feature_name)","e292317e":"feature = data.category_emergency\nfeature_name = \"Items sold only by the online emergency\"\ngraph_categ_feature(feature, feature_name)","5968970e":"desc_data = data[[\"date_block_num\", \"shop_id\", \"item_id\",\n                  \"item_cnt_month\", \"item_seniority\", \"shop_seniority\",\n                  \"shopitem_seniority\", \"item_stopped\", \"shopitem_stopped\",\n                  \"shop_avg_itemseniority_firstsell\",\n                  \"category_avg_itemseniority_firstsell\",\n                  \"maincategory_avg_itemseniority_firstsell\"]].copy()\ndesc_data[\"clipped_item_cnt_month\"] = desc_data.item_cnt_month.clip(0, 20)","69fb4033":"data = pd.read_csv(\"..\/input\/an-economic-oriented-feature-engineering\/alldata_nolags.csv\")\ndata = downcast_df_int8(data)\ndata.info()","52d46140":"feature = data.month_shopitem_price\nfeature_name = \"Shop\/Item Price\"\nfeature.describe()","1e6231e2":"test_normality(feature, feature_name)","2ab24966":"graph_quant_feature(feature, feature_name,\n                    \"Rubles\")","41267e8b":"feature = np.log(data.month_shopitem_price)\nfeature_name = \"Log of Shop\/Item Price\"\nfeature.describe()","a89d34b7":"test_normality(feature, feature_name)","985e36a1":"graph_quant_feature(feature, feature_name,\n                    \"Log of Rubles\")","b55aef1b":"feature = data.month_shopitem_price_change\nfeature_name = \"Shop\/Item Price Change\"\nfeature.describe()","a9d49dd6":"test_normality(feature, feature_name)","eb0a4610":"graph_quant_feature(feature, feature_name,\n                    \"In percentage\")","0a340956":"feature = data[data.month_shopitem_price_change < 2].\\\n    month_shopitem_price_change\nfeature_name = \"Shop\/Item Price Change\"\nfeature.describe()","450be510":"graph_quant_feature(feature, feature_name,\n                    \"In percentage\")","eb15de47":"feature = data.month_shopitem_price_change.clip(-1, 2)\nfeature_name = \"Shop\/Item Price Change\"\nfeature.describe()","38619597":"graph_quant_feature(feature, feature_name,\n                    \"In percentage\")","3d17282a":"feature = np.cbrt(\n    data.month_shopitem_price_change.clip(-1, 2))\nfeature_name = \"Cbrt of Price Change\"\nfeature.describe()","ee6ea489":"graph_quant_feature(feature, feature_name,\n                    \"In percentage\")","810a7555":"feature = data[data.item_cnt_month_change > -1].item_cnt_month_change\nfeature_name = \"Item Count Month Change\"\nfeature.describe()","b54afb51":"test_normality(feature, feature_name)","dc418de4":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","6e6fad8e":"feature = data[(data.item_cnt_month_change > -1) &\n    (data.item_cnt_month_change < 2)].item_cnt_month_change\nfeature_name = \"Item Count Month Change\"\nfeature.describe()","e6ee9756":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","fe57443f":"feature = data[data.item_cnt_month_change > -1].\\\n    item_cnt_month_change.clip(-1, 2)\nfeature_name = \"Item Count Month Change\"\nfeature.describe()","bcaf06c4":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","d98c719d":"feature = data.item_cnt_month_change.clip(-1, 2)\nfeature_name = \"Item Count Month Change\"\nfeature.describe()","f5b0ca1f":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","674ca2de":"feature = data.month_shopitem_relative_price\nfeature_name = \"Shop\/Item Relative Price\"\nfeature.describe()","05d47010":"test_normality(feature, feature_name)","50d6eea1":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","0f6265c3":"feature = data[data.month_shopitem_relative_price < 2].\\\n    month_shopitem_relative_price\nfeature_name = \"Shop\/Item Relative Price\"\nfeature.describe()","44b295e9":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","ec1d8344":"feature = \\\n    data.month_shopitem_relative_price.clip(-1, 2)\nfeature_name = \"Shop\/Item Relative Price\"\nfeature.describe()","6b129e44":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","146548e0":"feature = np.cbrt(\n    data.month_shopitem_relative_price.clip(-1, 2))\nfeature_name = \"Log of Relative Price\"\nfeature.describe()","9428ccea":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","e63e332b":"feature = data[data.month_shopitem_relative_sales > -1].\\\n    month_shopitem_relative_sales\nfeature_name = \"Shop\/Item Relative Sales\"\nfeature.describe()","fa8bf1b7":"test_normality(feature, feature_name)","8ff91c45":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","2716dda3":"feature = data[(data.month_shopitem_relative_sales > -1) &\n               (data.month_shopitem_relative_sales < 2)].\\\n    month_shopitem_relative_sales\nfeature_name = \"Shop\/Item Relative Sales\"\nfeature.describe()","71255a22":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","b4214cd4":"feature = data[data.month_shopitem_relative_sales > -1].\\\n    month_shopitem_relative_sales.clip(-1, 2)\nfeature_name = \"Shop\/Item Relative Sales\"\nfeature.describe()","405527ce":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","a0300e10":"feature = data.month_shopitem_relative_sales.clip(-1, 2)\nfeature_name = \"Shop\/Item Relative Sales\"\nfeature.describe()","d02fdd86":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","ca6f233f":"feature = np.log1p(\n    data[data.month_shopitem_relative_sales > -1].\\\n    month_shopitem_relative_sales.clip(-1, 2))\nfeature_name = \"Log of Relative Sales\"\nfeature.describe()","9862f6cf":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","7020dee2":"feature = data.month_shopitem_compared_price\nfeature_name = \"Shop\/Item Compared Price\"\nfeature.describe()","481484a0":"test_normality(feature, feature_name)","454d421d":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","ce536f68":"feature = data[data.month_shopitem_compared_price < 2].\\\n    month_shopitem_compared_price\nfeature_name = \"Shop\/Item Compared Price\"\nfeature.describe()","0909a75b":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","25128887":"feature = data.month_shopitem_compared_price.clip(-1, 2)\nfeature_name = \"Shop\/Item Compared Price\"\nfeature.describe()","7a548102":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","be482a8e":"feature = data[data.month_shopitem_compared_sales > -1].\\\n    month_shopitem_compared_sales\nfeature_name = \"Shop\/Item Compared Sales\"\nfeature.describe()","60bae19c":"test_normality(feature, feature_name)","1e8514ff":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","6832ab9e":"feature = data[(data.month_shopitem_compared_sales > -1) &\n    (data.month_shopitem_compared_sales < 2)].\\\n    month_shopitem_compared_sales\nfeature_name = \"Shop\/Item Compared Sales\"\nfeature.describe()","e337ebb4":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","3c5517fa":"feature = data[data.month_shopitem_compared_sales > -1].\\\n    month_shopitem_compared_sales.clip(-1, 2)\nfeature_name = \"Shop\/Item Compared Sales\"\nfeature.describe()","5f0ea1e9":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","9827b4a9":"feature = data.month_shopitem_compared_sales.clip(-1, 2)\nfeature_name = \"Shop\/Item Compared Sales\"\nfeature.describe()","bb67022b":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","08c5d4f5":"feature = np.log1p(\n    data[data.month_shopitem_compared_sales > -1].\\\n    month_shopitem_compared_sales.clip(-1, 2))\nfeature_name = \"Log of Compared Sales\"\nfeature.describe()","ac67a4d9":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","6fb87195":"feature = data.month_global_sumsales\nfeature_name = \"Global Sales\"\nfeature.describe()","5914f3c8":"test_normality(feature, feature_name)","79839660":"graph_quant_feature(feature, feature_name,\n                    \"Units\")","e5abaa15":"feature = data.month_global_revenue\nfeature_name = \"Global Revenue\"\nfeature.describe()","cab877af":"test_normality(feature, feature_name)","c4f5b9bc":"graph_quant_feature(feature, feature_name,\n                    \"Rubles\")","4e6760ef":"feature = np.log(data.month_global_revenue)\nfeature_name = \"Log of Global Revenue\"\nfeature.describe()","6d1c5ad0":"graph_quant_feature(feature, feature_name,\n                    \"Rubles\")","b27e2ae4":"feature = data.month_global_sumsales_change\nfeature_name = \"Global Sales Change\"\nfeature.describe()","d9b69aa5":"test_normality(feature, feature_name)","6bee193d":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","6fd64a57":"feature = data.month_global_revenue_change\nfeature_name = \"Global Revenue Change\"\nfeature.describe()","12846ed0":"test_normality(feature, feature_name)","d77ee1e2":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","338a6b48":"feature = data.month_global_relative_sumsales\nfeature_name = \"Global Relative Sales\"\nfeature.describe()","79944978":"test_normality(feature, feature_name)","e1dd6516":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\", ymax=3.5)","d21bdf52":"feature = data.month_global_relative_revenue\nfeature_name = \"Global Relative Revenue\"\nfeature.describe()","eae8b1d8":"test_normality(feature, feature_name)","1bdec723":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","d9a6925d":"feature = np.log1p(data.month_global_relative_revenue)\nfeature_name = \"Log of Global Relative Revenue\"\nfeature.describe()","90fa7bee":"test_normality(feature, feature_name)","a70a8fd2":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","6bcf8669":"feature = data.month_item_price\nfeature_name = \"Item Price\"\nfeature.describe()","7477a532":"test_normality(feature, feature_name)","67b93659":"graph_quant_feature(feature, feature_name,\n                    \"Rubles\")","37d6b731":"feature = np.log(data.month_item_price)\nfeature_name = \"Log of Item Price\"\nfeature.describe()","c5992705":"test_normality(feature, feature_name)","15a36153":"graph_quant_feature(feature, feature_name,\n                    \"Rubles\", ymax=0.5)","0994cd39":"feature = data[data.month_item_sales > 0].month_item_sales\nfeature_name = \"Item Sales\"\nfeature.describe()","15c849f7":"test_normality(feature, feature_name)","2c931c2a":"graph_quant_feature(feature, feature_name,\n                    \"Units\")","4df897a3":"feature = data[(data.month_item_sales > 0) &\n               (data.month_item_sales <= 20)].month_item_sales\nfeature_name = \"Item Sales\"\nfeature.describe()","5e82f9dc":"graph_quant_feature(feature, feature_name,\n                    \"Units\")","52e30504":"feature = data[data.month_item_sales > 0].\\\n    month_item_sales.clip(0, 20)\nfeature_name = \"Item Sales\"\nfeature.describe()","1413988c":"graph_quant_feature(feature, feature_name,\n                    \"Units\")","e9549d63":"feature = data.month_item_sales.clip(0, 20)\nfeature_name = \"Item Sales\"\nfeature.describe()","8831091e":"graph_quant_feature(feature, feature_name,\n                    \"Units\")","d30ce483":"feature = np.log1p(\n    data.month_item_sales.clip(0, 20))\nfeature_name = \"Log of Item Sales\"\nfeature.describe()","fad83b90":"graph_quant_feature(feature, feature_name,\n                    \"Units\")","465d6aae":"feature = np.log(\n    data[data.month_item_sales > 0].\\\n    month_item_sales.clip(0, 20))\nfeature_name = \"Log of Item Sales\"\nfeature.describe()","0c6015e0":"graph_quant_feature(feature, feature_name,\n                    \"Units\")","e4174204":"feature = data.month_item_price_change\nfeature_name = \"Item Price Change\"\nfeature.describe()","8be6ac19":"test_normality(feature, feature_name)","5662524f":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","7da94399":"feature = data[data.month_item_price_change < 2].\\\n    month_item_price_change\nfeature_name = \"Item Price Change\"\nfeature.describe()","6b6b93b3":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","100e7181":"feature = data.month_item_price_change.clip(-1, 2)\nfeature_name = \"Item Price Change\"\nfeature.describe()","3d3e1429":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","d4897696":"feature = data[data.month_item_sales_change > -1].\\\n    month_item_sales_change\nfeature_name = \"Item Sales Change\"\nfeature.describe()","679f16ec":"test_normality(feature, feature_name)","bbba2a36":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","e302df76":"feature = data[(data.month_item_sales_change > -1) &\n               (data.month_item_sales_change < 2)].\\\n    month_item_sales_change\nfeature_name = \"Item Sales Change\"\nfeature.describe()","62d6f9ca":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","5813c9e0":"feature = data[data.month_item_sales_change > -1].\\\n    month_item_sales_change.clip(-1, 2)\nfeature_name = \"Item Sales Change\"\nfeature.describe()","01541b8c":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","25f2d818":"feature = data.month_item_sales_change.clip(-1, 2)\nfeature_name = \"Item Sales Change\"\nfeature.describe()","d184f568":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","4e158fee":"feature = data.month_item_relative_price\nfeature_name = \"Item Relative Price\"\nfeature.describe()","7da7db59":"test_normality(feature, feature_name)","7e0f3877":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","76e83c3e":"feature = data[data.month_item_relative_price < 2].\\\n    month_item_relative_price\nfeature_name = \"Item Relative Price\"\nfeature.describe()","60ed81b1":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","019caf6b":"feature = data.month_item_relative_price.clip(-1, 2)\nfeature_name = \"Item Relative Price\"\nfeature.describe()","e968acfa":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","14670061":"feature = my_signed_sqrt(\n    data.month_item_relative_price.clip(-1, 2))\nfeature_name = \"Sqrt of Item Relative Price\"\nfeature.describe()","fd82da8e":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\", ymax=2.5)","83c2d6a1":"feature = data[data.month_item_relative_sales > -1].\\\n    month_item_relative_sales\nfeature_name = \"Item Relative Sales\"\nfeature.describe()","f15fa09f":"test_normality(feature, feature_name)","ae55ee1d":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","6b6489a9":"feature = data[(data.month_item_relative_sales > -1) &\n               (data.month_item_relative_sales < 2)].\\\n    month_item_relative_sales\nfeature_name = \"Item Relative Sales\"\nfeature.describe()","99110171":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\", ymax=2.5)","8e0e6059":"feature = data[data.month_item_relative_sales > -1].\\\n    month_item_relative_sales.clip(-1, 2)\nfeature_name = \"Item Relative Sales\"\nfeature.describe()","e743ed80":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\", ymax=2.5)","4f2935c0":"feature = data.month_item_relative_sales.clip(-1, 2)\nfeature_name = \"Item Relative Sales\"\nfeature.describe()","268b4fee":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\", ymax=2.5)","83cae6c8":"feature = data.month_shop_sumsales\nfeature_name = \"Shop Sales\"\nfeature.describe()","d94bc661":"test_normality(feature, feature_name)","1faea3a4":"graph_quant_feature(feature, feature_name,\n                    \"Units\")","354583cc":"feature = data[data.month_shop_sumsales > 0].\\\n    month_shop_sumsales\nfeature_name = \"Shop Sales\"\nfeature.describe()","ac486ddb":"graph_quant_feature(feature, feature_name,\n                    \"Units\")","4b454e3f":"feature = np.log(\n    data[data.month_shop_sumsales > 0].\\\n    month_shop_sumsales)\nfeature_name = \"Log of Shop Sales\"\nfeature.describe()","1517cc4c":"graph_quant_feature(feature, feature_name,\n                    \"Units\")","01af1289":"feature = np.log1p(\n    data.month_shop_sumsales)\nfeature_name = \"Log of Shop Sales\"\nfeature.describe()","b16db0ba":"graph_quant_feature(feature, feature_name,\n                    \"Units\")","822cf3c4":"feature = data.month_shop_revenue\nfeature_name = \"Shop Revenue\"\nfeature.describe()","fa27f7c6":"test_normality(feature, feature_name)","c6ceb9a5":"graph_quant_feature(feature, feature_name,\n                    \"Rubles\")","7333620f":"feature = data[data.month_shop_revenue > 0].\\\n    month_shop_revenue\nfeature_name = \"Shop Revenue\"\nfeature.describe()","f6be9e6c":"graph_quant_feature(feature, feature_name,\n                    \"Rubles\")","08f3f621":"feature = np.log(\n    data[data.month_shop_revenue > 0].\\\n    month_shop_revenue)\nfeature_name = \"Log of Shop Revenue\"\nfeature.describe()","70902d58":"graph_quant_feature(feature, feature_name,\n                    \"Rubles\")","cb1885e2":"feature = np.log1p(\n    data.month_shop_revenue)\nfeature_name = \"Log of Shop Revenue\"\nfeature.describe()","c22a0cfa":"graph_quant_feature(feature, feature_name,\n                    \"Rubles\")","bfc0d4f5":"feature = data[data.month_shop_sumsales_change > -1].\\\n    month_shop_sumsales_change\nfeature_name = \"Shop sales Change\"\nfeature.describe()","176d6666":"test_normality(feature, feature_name)","7629e625":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","43c98730":"feature = data[(data.month_shop_sumsales_change > -1) &\n    (data.month_shop_sumsales_change < 2)].month_shop_sumsales_change\nfeature_name = \"Shop sales Change\"\nfeature.describe()","8d961935":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","230347ad":"feature = data[data.month_shop_sumsales_change > -1].\\\n    month_shop_sumsales_change.clip(-1, 2)\nfeature_name = \"Shop sales Change\"\nfeature.describe()","d54a1ffc":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\", ymax=3.0)","f357f26b":"feature = data.month_shop_sumsales_change.clip(-1, 2)\nfeature_name = \"Shop sales Change\"\nfeature.describe()","bea3a44a":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\", ymax=3.0)","7d848b6f":"feature = data[data.month_shop_revenue_change > -1].\\\n    month_shop_revenue_change\nfeature_name = \"Shop Revenue Change\"\nfeature.describe()","1d43ef1d":"test_normality(feature, feature_name)","40eb85d5":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","f12c1b7e":"feature = data[(data.month_shop_revenue_change > -1) &\n               (data.month_shop_revenue_change < 2)].\\\n    month_shop_revenue_change\nfeature_name = \"Shop Revenue Change\"\nfeature.describe()","b5b4c570":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","e8560a1f":"feature = data[data.month_shop_revenue_change > -1].\\\n    month_shop_revenue_change.clip(-1, 2)\nfeature_name = \"Shop Revenue Change\"\nfeature.describe()","bfa90bae":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","eab7435e":"feature = data.month_shop_revenue_change.clip(-1, 2)\nfeature_name = \"Shop Revenue Change\"\nfeature.describe()","9383c7df":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","acf36def":"feature = data[data.month_shop_relative_sumsales > -1].\\\n    month_shop_relative_sumsales\nfeature_name = \"Shop Relative Sales\"\nfeature.describe()","1c66d79a":"test_normality(feature, feature_name)","42c12ee7":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","b6987f00":"feature = data[(data.month_shop_relative_sumsales > -1) &\n               (data.month_shop_relative_sumsales < 2)].\\\n    month_shop_relative_sumsales\nfeature_name = \"Shop Relative Sales\"\nfeature.describe()","1352112a":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\", ymax=2.25)","217cde31":"feature = data[data.month_shop_relative_sumsales > -1].\\\n    month_shop_relative_sumsales.clip(-1, 2)\nfeature_name = \"Shop Relative Sales\"\nfeature.describe()","35adb586":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\", ymax=2.25)","0e2b1a88":"feature = data.month_shop_relative_sumsales.clip(-1, 2)\nfeature_name = \"Shop Relative Sales\"\nfeature.describe()","8e0ac2a9":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\", ymax=2.25)","8c48751e":"feature = data[data.month_shop_relative_revenue > -1].\\\n    month_shop_relative_revenue\nfeature_name = \"Shop Relative Revenue\"\nfeature.describe()","7df706a0":"test_normality(feature, feature_name)","056d4b49":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","1c36ce6d":"feature = data[(data.month_shop_relative_revenue > -1) &\n               (data.month_shop_relative_revenue < 2)].\\\n    month_shop_relative_revenue\nfeature_name = \"Shop Relative Revenue\"\nfeature.describe()","d43718a7":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\", ymax=1.8)","56df49f2":"feature = data[data.month_shop_relative_revenue > -1].\\\n    month_shop_relative_revenue.clip(-1, 2)\nfeature_name = \"Shop Relative Revenue\"\nfeature.describe()","05ed11b9":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\", ymax=2)","a7c30730":"feature = data.month_shop_relative_revenue.clip(-1, 2)\nfeature_name = \"Shop Relative Revenue\"\nfeature.describe()","6da84ea7":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\", ymax=2)","afd3fdb0":"feature = np.log1p(\n    data[data.month_shop_relative_revenue > -1].\\\n    month_shop_relative_revenue.clip(-1, 2))\nfeature_name = \"Log of Shop Relative Revenue\"\nfeature.describe()","82e4b8ac":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\", ymax=1.75)","bed7bcc0":"feature = data.month_category_sales\nfeature_name = \"Category Sales\"\nfeature.describe()","317d236e":"test_normality(feature, feature_name)","83be325d":"graph_quant_feature(feature, feature_name,\n                    \"Units\")","387d7f69":"feature = data[data.month_category_sales < 20].\\\n    month_category_sales\nfeature_name = \"Category Sales\"\nfeature.describe()","eea864cf":"graph_quant_feature(feature, feature_name,\n                    \"Units\")","953c5178":"feature = data.month_category_sales.clip(0, 20)\nfeature_name = \"Category Sales\"\nfeature.describe()","fa4ac282":"graph_quant_feature(feature, feature_name,\n                    \"Units\")","0d7826ce":"feature = np.log1p(data.month_category_sales.clip(0, 20))\nfeature_name = \"Log of Category Sales\"\nfeature.describe()","a3744cce":"graph_quant_feature(feature, feature_name,\n                    \"Units\", ymax=3)","c6fea481":"feature = data.month_category_sales_change\nfeature_name = \"Category Sales Change\"\nfeature.describe()","cdc77c1c":"test_normality(feature, feature_name)","8412f40f":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","e8879b66":"feature = data[data.month_category_sales_change > -1].\\\n    month_category_sales_change.clip(-1, 2)\nfeature_name = \"Category Sales Change\"\nfeature.describe()","50aa39f7":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","25160f2a":"feature = data.month_category_sales_change.clip(-1, 2)\nfeature_name = \"Category Sales Change\"\nfeature.describe()","169501a5":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","d98b8701":"feature = data.month_category_relative_sales\nfeature_name = \"Category Relative Sales\"\nfeature.describe()","e474006b":"test_normality(feature, feature_name)","15047cc1":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","2af0aaad":"feature = data[data.month_category_relative_sales > -1].\\\n    month_category_relative_sales.clip(-1, 2)\nfeature_name = \"Category Relative Sales\"\nfeature.describe()","6017a852":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","cc821bff":"feature = data.month_category_relative_sales.clip(-1, 2)\nfeature_name = \"Category Relative Sales\"\nfeature.describe()","1d8eedf0":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","65a96cdb":"feature = data.month_maincategory_sales\nfeature_name = \"Main Category Sales\"\nfeature.describe()","61080605":"test_normality(feature, feature_name)","5469cab8":"graph_quant_feature(feature, feature_name,\n                    \"Units\")","a4122a1b":"feature = data.month_maincategory_sales.clip(0, 20)\nfeature_name = \"Main Category Sales\"\nfeature.describe()","424cfd29":"graph_quant_feature(feature, feature_name,\n                    \"Units\")","7b880c22":"feature = np.log1p(\n    data.month_maincategory_sales.clip(0, 20))\nfeature_name = \"Log of Main Category Sales\"\nfeature.describe()","50184d3c":"graph_quant_feature(feature, feature_name,\n                    \"Units\")","7fcd22d3":"feature = data.month_maincategory_sales_change\nfeature_name = \"Main Category Sales Change\"\nfeature.describe()","e910aada":"test_normality(feature, feature_name)","b25f0783":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","3487817c":"feature = data.month_maincategory_sales_change.clip(-1, 2)\nfeature_name = \"Main Category Sales Change\"\nfeature.describe()","1c8e96bc":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","11d4194e":"feature = data.month_maincategory_relative_sales\nfeature_name = \"Main Category Relative Sales\"\nfeature.describe()","7c44effe":"test_normality(feature, feature_name)","2dfa8f09":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","6c13b208":"feature = data.month_maincategory_relative_sales.clip(-1, 2)\nfeature_name = \"Main Category Relative Sales\"\nfeature.describe()","eaedf81e":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","0874d8e6":"feature = data.month_shopcategory_sales\nfeature_name = \"Shop\/Category Sales\"\nfeature.describe()","33a7e6d0":"test_normality(feature, feature_name)","20e44d80":"graph_quant_feature(feature, feature_name,\n                    \"Units\")","fc925dd3":"feature = data.month_shopcategory_sales.clip(0, 20)\nfeature_name = \"Shop\/Category Sales\"\nfeature.describe()","baf1abaa":"graph_quant_feature(feature, feature_name,\n                    \"Units\")","228ca33a":"feature = np.log1p(\n    data.month_shopcategory_sales.clip(0, 20))\nfeature_name = \"Log of Shop\/Category Sales\"\nfeature.describe()","85c0d49a":"graph_quant_feature(feature, feature_name,\n                    \"Units\")","ea83aed1":"feature = data.month_shopcategory_sales_change\nfeature_name = \"Shop\/Category Sales Change\"\nfeature.describe()","90eaba7c":"test_normality(feature, feature_name)","87c0cadf":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","bcec4e6e":"feature = data.month_shopcategory_sales_change.clip(-1, 2)\nfeature_name = \"Shop\/Category Sales Change\"\nfeature.describe()","2911748e":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","d3259355":"feature = data.month_shopcategory_relative_sales\nfeature_name = \"Shop Category Relative Sales\"\nfeature.describe()","40ea6f3b":"test_normality(feature, feature_name)","0104d3df":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","d07f3429":"feature = data.month_shopcategory_relative_sales.clip(-1, 2)\nfeature_name = \"Shop Category Relative Sales\"\nfeature.describe()","4f4408cd":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","504fb483":"feature = data.month_shopmaincategory_sales\nfeature_name = \"Shop\/Main Category Sales\"\nfeature.describe()","97a31279":"test_normality(feature, feature_name)","269a30e4":"graph_quant_feature(feature, feature_name,\n                    \"Units\")","c47f1196":"feature = data.month_shopmaincategory_sales.clip(0, 20)\nfeature_name = \"Shop\/Main Category Sales\"\nfeature.describe()","8aa0035b":"graph_quant_feature(feature, feature_name,\n                    \"Units\")","61f3acc9":"feature = np.log1p(\n    data.month_shopmaincategory_sales.clip(0, 20))\nfeature_name = \"Log of Shop\/Main Category Sales\"\nfeature.describe()","5f10e9e5":"graph_quant_feature(feature, feature_name,\n                    \"Units\")","87b4fc08":"feature = data.month_shopmaincategory_sales_change\nfeature_name = \"Shop\/Main Category Sales Change\"\nfeature.describe()","4b824914":"test_normality(feature, feature_name)","0285678e":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","989d4574":"feature = data.month_shopmaincategory_sales_change.clip(-1, 2)\nfeature_name = \"Shop\/Main Category Sales Change\"\nfeature.describe()","11064d9c":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","04459650":"feature = data.month_shopmaincategory_relative_sales\nfeature_name = \"Shop\/Main Category Relative Sales\"\nfeature.describe()","550efc15":"test_normality(feature, feature_name)","c218e8de":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","1b763524":"feature = data.month_shopmaincategory_relative_sales.clip(-1, 2)\nfeature_name = \"Shop\/Main Category Relative Sales\"\nfeature.describe()","08909d05":"graph_quant_feature(feature, feature_name,\n                    \"Percentage\")","755c9d42":"data.drop(columns=[\"item_name\", \"month_shopitem_revenue\",\n                   \"month_shopitem_hassales\"], inplace=True)","2c5020fc":"data[\"item_cnt_month_change\"] = data.item_cnt_month_change.clip(-1, 2)\ndata[\"month_shopitem_price\"] = np.log(data.month_shopitem_price)\ndata[\"month_shopitem_price_change\"] = np.cbrt(data.month_shopitem_price_change.clip(-1, 2))\n\ndata[\"month_shopitem_relative_sales\"] = data.month_shopitem_relative_sales.clip(-1, 2)\ndata[\"month_shopitem_relative_price\"] = data.month_shopitem_relative_price.clip(-1, 2)\ndata[\"month_shopitem_compared_sales\"] = data.month_shopitem_compared_sales.clip(-1, 2)\ndata[\"month_shopitem_compared_price\"] = data.month_shopitem_compared_price.clip(-1, 2)\n\ndata[\"month_global_sumsales\"] = data.month_global_sumsales\ndata[\"month_global_revenue\"] = np.log(data.month_global_revenue)\ndata[\"month_global_sumsales_change\"] = data.month_global_sumsales_change\ndata[\"month_global_revenue_change\"] = data.month_global_revenue_change\ndata[\"month_global_relative_sumsales\"] = data.month_global_relative_sumsales\ndata[\"month_global_relative_revenue\"] = np.log1p(data.month_global_relative_revenue)\n\ndata[\"month_item_price\"] = np.log(data.month_item_price)\ndata[\"month_item_sales\"] = np.log1p(data.month_item_sales.clip(0, 20))\ndata[\"month_item_price_change\"] = data.month_item_price_change.clip(-1, 2)\ndata[\"month_item_sales_change\"] = data.month_item_sales_change.clip(-1, 2)\ndata[\"month_item_relative_price\"] = data.month_item_relative_price.clip(-1, 2)\ndata[\"month_item_relative_sales\"] = data.month_item_relative_sales.clip(-1, 2)\n\ndata[\"month_shop_sumsales\"] = data.month_shop_sumsales\ndata[\"month_shop_revenue\"] = data.month_shop_revenue\ndata[\"month_shop_sumsales_change\"] = data.month_shop_sumsales_change.clip(-1, 2)\ndata[\"month_shop_revenue_change\"] = data.month_shop_revenue_change.clip(-1, 2)\ndata[\"month_shop_relative_sumsales\"] = data.month_shop_relative_sumsales.clip(-1, 2)\ndata[\"month_shop_relative_revenue\"] = data.month_shop_relative_revenue.clip(-1, 2)\n\ndata[\"month_category_sales\"] = np.log1p(data.month_category_sales.clip(0, 20))\ndata[\"month_category_sales_change\"] = data.month_category_sales_change.clip(-1, 2)\ndata[\"month_category_relative_sales\"] = data.month_category_relative_sales.clip(-1, 2)\n\ndata[\"month_maincategory_sales\"] = np.log1p(data.month_maincategory_sales.clip(0, 20))\ndata[\"month_maincategory_sales_change\"] = data.month_maincategory_sales_change.clip(-1, 2)\ndata[\"month_maincategory_relative_sales\"] = data.month_maincategory_relative_sales.clip(-1, 2)\n\ndata[\"month_shopcategory_sales\"] = np.log1p(data.month_shopcategory_sales.clip(0, 20))\ndata[\"month_shopcategory_sales_change\"] = data.month_shopcategory_sales_change.clip(-1, 2)\ndata[\"month_shopcategory_relative_sales\"] = data.month_shopcategory_relative_sales.clip(-1, 2)\n\ndata[\"month_shopmaincategory_sales\"] = np.log1p(data.month_shopmaincategory_sales.clip(0, 20))\ndata[\"month_shopmaincategory_sales_change\"] = data.month_shopmaincategory_sales_change.clip(-1, 2)\ndata[\"month_shopmaincategory_relative_sales\"] = data.month_shopmaincategory_relative_sales.clip(-1, 2)","9653ee88":"Only small shops have been stopped. So the curve of seniority is not hurted when a shop stops.  \nThe curve of items seniority is explained by the fact that data is only for the active shop\/item pairs. The shape of the curve is due to the fact that an item is not sold by all shops at the month of its launch.","6e412e62":"Last conclusion : category-based data seem a better option than main-category-based data, from the distribution point of view.","1a1b4ca4":"The most interesting feature is the average. It is the closest to normal distribution. Using its log, we obtain a distribution really close to normality, except for its min value.  \nThe min and max features are not interesting to analyse.  \nMin value : all shops sell at least one item the first month it is sold (I should say month zero).  \nMax value : most shops never sell an existing item. This is due to the fact that some shops don't sell some categories.","7dcac354":"Still a lot of 0 values.","601efda4":"We have less occurrences in months 11 and 12 because we have one year less in those two months.  \nThe number of occurrences increases month after month. This is logical as we keep stopped items with a sale number of 0.","184ec1e6":"## 2.4. Shop data","fe8cf5a4":"## 1.6. Categorical features","89faf168":"Still a lot of zero values (from Q1 to Q3). And the same conclusions.  \nI prefer not to apply the log transformation because its distribution plot has several local maximum.","e6131985":"## 2.6. Main Category Data","c3ad0d96":"Online stores don't account for a lot of sales.","d03b3d51":"One more time, a lot of 0 values give a weird distribution curve. We have also a lot of 100% increase, that correspond when a product is sold again after a month without sale.  \nI look at the distribution if I keep -1 values of Item Count Month Change.","0bf5e327":"## 1.4. Item seniority when first sell occurs","ab01fa5c":"Again, the most interesting feature is the average one.","8d18d905":"I remove -1 values of item count month change because they are linked to an item count moving from a positive value to a zero value.","ee489cd3":"A price variation of more than 200% is pretty rare. So I limit the range analysis.","5a094b66":"## 2.7. Shop\/Category Data","f309643f":"# Notebook setup","ae9f0987":"<font size=6>Predicting Future Sales<\/font>  \n<font size=5>An analysis of features distribution<\/font>","df8caff2":"## 1.2. Seniority features","7a88b90f":"## 2.8. Shop\/Main Category Data","9b1843c8":"## 1.5. Date features","50db3579":"## 2.3. Item data","61b99f47":"Global data don't necessary need transformation, except the global relative revenue. Extreme values are always a problem to get close to normality.","6915ad88":"## 2.9. Suggestion of treatment for the quantitative features","e1d28373":"Statistical test reject the normal distribution. However, the plots show that the distribution of the number of months since the last sale for a given item ou a given pair shop\/item is close of normality.  \nIt reflects that items stop selling on a regular basis. There is a regular turnover in sold items.","f02eabed":"This notebook analyses the distribution of the features created in the kernel https:\/\/www.kaggle.com\/sylvainfriot\/an-economic-oriented-feature-engineering  \nI do a lot of graphic tries and explorations.  \n\nI notice two important facts :  \n- a large imbalance in the target (item_count_month) with a lot of zero values. As a result, most features have a lot of 0 values or -1 values, according to the way they were calculated.  \n- a lot of outliers (mostly in the high values) for a lot of features.  \n  \nThose two facts give some weird distribution curves.  \nI also look at the distribution without the values (0 or -1) implied by the target zero values.  \n**The main conclusion of this exploration is that models based on the normality asumption should be avoid to treat those data.**","aa060914":"The distribution of the log of shop\/item price is pretty close to the normal distribution.","e9cf9348":"Nothing special about the number of days in a month.","b3a95565":"When an item is sold, more than half of monthly counts are only one item sold by a given shop.  \nOnly one or two units are sold by a shop in a given month for most items.  \nLet's clip the max number of sold items to 20 to get a better idea of distribution in small numbers of sales.","d5407f3c":"A large part of sales occur in Moscow, where the company has several stores.","05994785":"## 2.2. Global data","7cc52d94":"# 1. Descriptive data","697d566f":"# 2. Quantitative data","a88ee29f":"<a id=\"11\"><\/a>\n## 1.1. Item Count Month","e1635a32":"It's difficult to get a close-to-normality distribution by transforming the shop\/item price change. This is due to the fact that Q1 to Q3 values are equal to 0.","fd37971a":"I don't analyse the features related to the month of the first or last sale. I prefer to look at the seniority of items or at the time elapsed since last sale.","98e7520f":"Same shape of distribution as Item Relative Prices.","29596d17":"The distribution of the log of positive item counts is still far from normality. It has a strong positive skewness. But it is more interesting than the core positive item count because the number and the range of outliers are lower.","697e9cdb":"## 2.1. Shop\/Item data","9c3dfeeb":"**Utility functions**","7e18fb28":"I keep numeric features of interest to run a PCA analysis with other features.","9a69d261":"There are a lot of outliers in the high values, as we've seen during the analysis.  \nChanges or relative features can't be under -100%. On the upside, they sometimes reach really high values. An increase value of 200% is allready a big increase, as well as a relative value of 200% in comparison to its mean is allready a large value. I decide to ceil them all to 200% as the predictions are ceiled at 20 units. This is like grouping all large outliers values in the same value of +200%.  \nI am open to discuss the logic of this decision in the comments.","dac08043":"## 1.3. \"Stopped\" features","1d1ac82a":"Monthly increase of over 200% are rare occurrences. I get rid of them for the analysis of the distribution.","45f53b14":"**Graphs set-up**","ec09ab98":"Conclusions to keep in mind when doing predictions :\n- most monthly sales are equal to 0 ;\n- when there are sales, most of them are equal to 1 or 2 ;\n- there are a significant number of items with 20 or more sales by month and shop. They may be the most important items for the company from an economical point of view.","9b5b04cd":"The sales between categories are unbalanced. One or two categories concentrate the sales within a given main category.","be277eb5":"The distribution of the log of positive clipped item counts is the closer to the normal law.","0f23f3ac":"There's a huge positive skewness. There are almost no items with 10 to 19 sales. The most interesting items are those with 20 sales (remember that we've clipped the max number of sales to 20 for this graph), because they will probably count for a big part of the income of the company.","88da8e69":"Same weird distribution with a lot of zero values and high outliers.","bd9a210b":"One more time, the only feature of interest seems to be the average value by main category.  \nThe distribution by main category is a bit weird because values from Q1 to Q3 are almost the same. I prefer the shape of the distribution by category.","75d69551":"Still a weird distribution with a lot of zero values.","f454e5f0":"The sign-corrected square root has a distribution closer to the normal law from the henry plot point of view, but not from the distribution plot view (multi-modal distribution).","4b7f5a1c":"## 2.5. Category Data","d2d0acc5":"More than 75% of monthly sales are equal to 0. This is due to the items that are no more sold, or that are sold from time to time by a shop.  \nI focus on sold items, that is on positive item_cnt_month.  \nMore generally, the distribution of several features is disturbed by this imbalance. Values of sales equal to 0 or values of changes or relative sales equal to -1 should be put apart as soon as a mean number of sales is implied.  \nIn the same order of idea, there are often some large outliers in high values. I tend to put apart the wider ones to focus on the distribution of the majority of data."}}