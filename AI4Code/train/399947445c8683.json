{"cell_type":{"762e7401":"code","73a55f52":"code","a84d3317":"code","c99b43b3":"code","33ad7bb7":"code","5b25e7bf":"code","4f535d33":"code","b19590a3":"code","6b77a3fc":"code","54cd7230":"code","a8a1446a":"code","c112777a":"code","5df6c2d8":"code","b10b3f50":"code","e77c273f":"code","3e7caa77":"code","41435905":"code","94f07165":"markdown","ee007f5c":"markdown","580cbc79":"markdown","1e6f5545":"markdown","1c1076e2":"markdown","8f9e5c1b":"markdown"},"source":{"762e7401":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport matplotlib.image as mpimg\nfrom matplotlib.patches import Rectangle\nimport seaborn as sns\nfrom os import listdir\nfrom os.path import isfile, join","73a55f52":"df = pd.read_csv('..\/input\/global-wheat-detection\/train.csv')","a84d3317":"df.head()","c99b43b3":"df.info()","33ad7bb7":"df['source'].unique()","5b25e7bf":"df['bbox'] = df['bbox'].map(lambda x: x.lstrip('[').rstrip(']'))\ndf['bbox'] = df['bbox'].str.split(',')","4f535d33":"df['source'].hist()","b19590a3":"plt.hist(df['image_id'].value_counts(), bins=30)\nplt.show()","6b77a3fc":"plt.figure(figsize=(10,5))\nimg = mpimg.imread('..\/input\/global-wheat-detection\/train\/0d2948e6d.jpg')\nimgplot = plt.imshow(img)\n\nfor rec_patch in df[df['image_id'] == '0d2948e6d']['bbox']:\n    plt.gca().add_patch(\n        Rectangle(\n            (float(rec_patch[0]), float(rec_patch[1])),\n            float(rec_patch[2]),\n            float(rec_patch[3]),\n            linewidth=2,\n            edgecolor='r',\n            facecolor='none'\n        ))","54cd7230":"fig, axes = plt.subplots(4, 4, figsize=(15,15))\n\nfor row in range(0, 4):\n    for column in range(0, 4):\n        image_id = df['image_id'].sample().values[0]        \n        img = mpimg.imread('..\/input\/global-wheat-detection\/train\/%s.jpg' % image_id)\n        imgplot = axes[row, column].imshow(img)\n          \n        for rec_patch in df[df['image_id'] == image_id]['bbox']:\n            axes[row, column].add_patch(\n                Rectangle(\n                    (float(rec_patch[0]), float(rec_patch[1])),\n                    float(rec_patch[2]),\n                    float(rec_patch[3]),\n                    linewidth=2,\n                    edgecolor='r',\n                    facecolor='none'\n                ))\n","a8a1446a":"df_head_count = df['image_id'].value_counts().to_frame('head_count')\ndf_head_count = df_head_count.rename_axis('image_id').reset_index()\n\ndef get_image_source(image_id):\n    return df[df['image_id'] == image_id]['source'].unique()[0]\n\n# df_head_count['image_id'].apply(lambda image_id: df[df['image_id'] == image_id]['source'].unique()[0])\n\ndf_head_count['source'] = df_head_count['image_id'].map(get_image_source)","c112777a":"df_head_count.shape","5df6c2d8":"fig, axes = plt.subplots(3, 3, figsize=(15,15))\n\nfor row in range(0, 3):\n    for column in range(0, 3):\n        image_id = df_head_count[df_head_count['head_count'] == 1].sample()['image_id'].values[0]     \n        img = mpimg.imread('..\/input\/global-wheat-detection\/train\/%s.jpg' % image_id)\n        imgplot = axes[row, column].imshow(img)\n          \n        for rec_patch in df[df['image_id'] == image_id]['bbox']:\n            axes[row, column].add_patch(\n                Rectangle(\n                    (float(rec_patch[0]), float(rec_patch[1])),\n                    float(rec_patch[2]),\n                    float(rec_patch[3]),\n                    linewidth=2,\n                    edgecolor='r',\n                    facecolor='none'\n                ))","b10b3f50":"**Images with less than 10 wheat heads**","e77c273f":"fig, axes = plt.subplots(3, 3, figsize=(15,15))\n\nfor row in range(0, 3):\n    for column in range(0, 3):\n        image_id = df_head_count[df_head_count['head_count'] <= 10].sample()['image_id'].values[0]     \n        img = mpimg.imread('..\/input\/global-wheat-detection\/train\/%s.jpg' % image_id)\n        imgplot = axes[row, column].imshow(img)\n          \n        for rec_patch in df[df['image_id'] == image_id]['bbox']:\n            axes[row, column].add_patch(\n                Rectangle(\n                    (float(rec_patch[0]), float(rec_patch[1])),\n                    float(rec_patch[2]),\n                    float(rec_patch[3]),\n                    linewidth=2,\n                    edgecolor='r',\n                    facecolor='none'\n                ))","3e7caa77":"sns.countplot(x='source', data=df_head_count)","41435905":"df_head_count.groupby('source')['head_count'].mean().plot.bar()","94f07165":"<h2>Introduction<\/h2>","ee007f5c":"**Images with 1 wheat head**","580cbc79":"**Plot of wheat heads per source**","1e6f5545":"<h2>I - Exploratory Data Analysis<\/h2>","1c1076e2":"**Random 16 images**","8f9e5c1b":"**Sample image with patches**"}}