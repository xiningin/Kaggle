{"cell_type":{"4e082052":"code","03955bf2":"code","de8e94fc":"code","efa7b9fd":"code","352a4698":"code","d3a2600f":"code","89004b5b":"code","90cb2c23":"code","24601804":"code","dc67b128":"code","f2af5b70":"code","df7e855d":"code","6b3ba11c":"code","0f08aebe":"code","a16b7beb":"code","47962c21":"code","2bacbe1b":"code","771caab9":"code","f2003fea":"code","7e52979b":"markdown","6d89d8b2":"markdown","e3fe0f3d":"markdown","fceeff4b":"markdown","b0653d76":"markdown","7681ad7c":"markdown","3eb34d58":"markdown","3af4da28":"markdown","6a128e28":"markdown","e22dd9b1":"markdown"},"source":{"4e082052":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","03955bf2":"from sklearn.cluster import AgglomerativeClustering\nimport numpy as np\nfrom matplotlib import pyplot as plt\nfrom scipy.cluster.hierarchy import dendrogram\ncolors = ['royalblue','red','deeppink', 'maroon', 'mediumorchid', 'tan', 'forestgreen', 'olive', 'goldenrod', 'lightcyan', 'navy']\nvectorizer = np.vectorize(lambda x: colors[x % len(colors)])\n","de8e94fc":"X = np.array([[1, 2], [1, 3],[2,2] ,[3,3],[1, 0], [4, 1], [4, 4], [4, 0],[6,6]])\nplt.scatter(X[:,0],X[:,1])","efa7b9fd":"model = AgglomerativeClustering(linkage=\"single\")\nmodel = model.fit(X)\nmodel.labels_","352a4698":"plt.scatter(X[:,0], X[:,1],c=vectorizer(model.labels_))","d3a2600f":"from scipy.cluster.hierarchy import dendrogram, linkage\nfrom matplotlib import pyplot as plt\nZ = linkage(X, 'ward')\ndn = dendrogram(Z)\nplt.show()","89004b5b":"def clust_plot(X,noise,c):\n    model = AgglomerativeClustering(linkage=\"single\",n_clusters=c)\n    model = model.fit(X)\n    ymin=model.labels_\n    model = AgglomerativeClustering(linkage=\"complete\",n_clusters=c)\n    model = model.fit(X)\n    ymax=model.labels_\n    model = AgglomerativeClustering(linkage=\"average\",n_clusters=c)\n    model =model.fit(X)\n    yavg=model.labels_\n    model = AgglomerativeClustering(linkage=\"ward\",n_clusters=c)\n    model = model.fit(X)\n    yward=model.labels_\n    plt.figure()\n    plt.subplot(141)\n    plt.gca().set_title('MIN')\n    plt.scatter(X[:,0], X[:,1],c=vectorizer(ymin))\n    plt.subplot(142)\n    plt.gca().set_title('MAX')\n    plt.scatter(X[:,0], X[:,1],c=vectorizer(ymax))\n    plt.subplot(143)\n    plt.gca().set_title('Average')\n    plt.scatter(X[:,0], X[:,1],c=vectorizer(yavg))\n    plt.subplot(144)\n    plt.gca().set_title('Ward')\n    plt.scatter(X[:,0], X[:,1],c=vectorizer(yward))","90cb2c23":"clust_plot(X,0,2)","24601804":"from sklearn.datasets import make_moons\nX, y = make_moons(n_samples=1500, noise=0.05)\nplt.scatter(X[:,0], X[:,1],c=vectorizer(y))","dc67b128":"clust_plot(X,0,2)","f2af5b70":"from sklearn.datasets import make_circles\nX, y = make_circles(n_samples=200, noise=0.01)\nplt.scatter(X[:,0], X[:,1],c=vectorizer(y))","df7e855d":"clust_plot(X,0,2)","6b3ba11c":"from sklearn.datasets import make_blobs\nX, y = make_blobs(n_samples=200, random_state=8,cluster_std=[1.0, 2.5, 0.5])\nplt.scatter(X[:,0], X[:,1],c=vectorizer(y))","0f08aebe":"clust_plot(X,0,3)","a16b7beb":"from sklearn import metrics\ndef purity_score(y_true, y_pred):\n    # compute contingency matrix (also called confusion matrix)\n    contingency_matrix = metrics.cluster.contingency_matrix(y_true, y_pred)\n    # return purity\n    return np.sum(np.amax(contingency_matrix, axis=0)) \/ np.sum(contingency_matrix) ","47962c21":"import pandas as pd\ndf=pd.read_csv(\"\/kaggle\/input\/uciseeds\/seeds.csv\")\ndf.head(5)","2bacbe1b":"X=df.iloc[:,0:7]\ny=df.iloc[:,7]","771caab9":"model = AgglomerativeClustering(linkage=\"single\",n_clusters=3)\nmodel = model.fit(X)\nymin=model.labels_\nprint(purity_score(y,ymin))\nmodel = AgglomerativeClustering(linkage=\"complete\",n_clusters=3)\nmodel = model.fit(X)\nymax=model.labels_\nprint(purity_score(y,ymax))\nmodel = AgglomerativeClustering(linkage=\"average\",n_clusters=3)\nmodel =model.fit(X)\nyavg=model.labels_\nprint(purity_score(y,yavg))\nmodel = AgglomerativeClustering(linkage=\"ward\",n_clusters=3)\nmodel = model.fit(X)\nyward=model.labels_\nprint(purity_score(y,yward))","f2003fea":"Z = linkage(X, 'ward')\ndn = dendrogram(Z)\nplt.show()","7e52979b":"![image.png](attachment:image.png)","6d89d8b2":"# Question 1:What are some of the parameters of Aggolomarative Clustering? <a id=\"1\"><\/a>","e3fe0f3d":"# Question 6:What is the effect on blob ?<a id=6><\/a>","fceeff4b":"# Question 2:How to fit Agglomarative Clusterig? <a id=\"2\"><\/a>","b0653d76":"* n_clusters : It is by default 2,  It may not be specified if distance threshold is given\n* affinity: What distance metric will be used? Precomputed means square matrix\n* linkage{\u201cward\u201d, \u201ccomplete\u201d, \u201caverage\u201d, \u201csingle\u201d}, default=\u201dward\u201d\n* distance_threshold float, default=None","7681ad7c":"# Question 7: Clustering on seeds data","3eb34d58":"# Question 4:What is the Effect on Make Moons ?","3af4da28":"* [<font size=4>Question 1:What are some of the parameters of Aggolomarative Clustering?<\/font>](#1)\n* [<font size=4>Question 2: Fitting and Visualizing AgglomarativeClustering Algorithm ?<\/font>](#2)   \n* [<font size=4>Question 3: Diffrent linkage options ?<\/font>](#3)   \n* [<font size=4>Question 4: Make Moons<\/font>](#4)  \n* [<font size=4>Question 5: Make Circle<\/font>](#5)  \n* [<font size=4>Question 6: Make Blob<\/font>](#6)  \n* [<font size=4>Question 7: Clustering on Seeds Data<\/font>](#7)  ","6a128e28":"# Question 3:Different Linkagae? <a id=\"2\"><\/a>","e22dd9b1":"# Question 5:What is the effect on circles ?"}}