{"cell_type":{"a1eca359":"code","a52d88ae":"code","d50c59fb":"code","656ffa24":"code","41167560":"code","3e4c4e34":"code","1b97702c":"code","b1e83665":"code","d0ef604d":"code","fd83bb83":"code","8ad5b63f":"code","c3c011ad":"code","a6d86ec6":"code","3b24d6fb":"code","c4af2c05":"code","2ed26df0":"code","7ba9e41d":"code","3d66769d":"code","c1424890":"code","e86efc32":"code","374109c6":"code","fbd223b8":"code","3c672a7a":"code","0c189c00":"code","8238dfaf":"code","d4372226":"code","d67d0e26":"code","45c2f716":"code","d27322e4":"code","fbf909b5":"code","ec5279a2":"code","4b905a88":"code","e0705137":"code","9bddaadf":"code","cc2e49b0":"code","e9c40ea0":"code","19c30471":"code","33406886":"code","90b3ac77":"code","51866972":"code","20036f7b":"code","c2df456d":"code","e33eb1c7":"code","7c29afed":"markdown","5608f303":"markdown","652347c8":"markdown","6b809c2c":"markdown","6d78aa0e":"markdown","825db3bd":"markdown","46181fb6":"markdown","b8b1f923":"markdown","c94e2eee":"markdown","8e15c7a5":"markdown","414c4b15":"markdown","eeabe013":"markdown","8f0416ef":"markdown","8aef545d":"markdown","bb48df87":"markdown","bad341ed":"markdown","b93caa0f":"markdown","d31f293d":"markdown","c775db14":"markdown","7211bb61":"markdown","54aa4642":"markdown","17a7d71f":"markdown","f65f09b3":"markdown","4ede1ec9":"markdown","03374c82":"markdown","57763278":"markdown","098f8b57":"markdown","56df7c2b":"markdown","f6ef0742":"markdown","a692a546":"markdown","b4df03b2":"markdown","3baf6301":"markdown","d650bfbd":"markdown"},"source":{"a1eca359":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","a52d88ae":"import numpy as np\nimport pandas as pd\n\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\n\nimport warnings\nwarnings.filterwarnings('ignore')\n\nplt.style.use(\"fivethirtyeight\")\nsns.set_style('darkgrid')","d50c59fb":"bank = pd.read_csv(\"\/kaggle\/input\/credit-card-customers\/BankChurners.csv\")","656ffa24":"display(bank.head())\ndisplay(bank.tail())","41167560":"bank.shape","3e4c4e34":"# CLIENTNUM : Client number. Unique identifier for the customer holding the account ==> so we gonna drop it (usless)\n\nbank = bank.drop(['CLIENTNUM', 'Naive_Bayes_Classifier_Attrition_Flag_Card_Category_Contacts_Count_12_mon_Dependent_count_Education_Level_Months_Inactive_12_mon_1','Naive_Bayes_Classifier_Attrition_Flag_Card_Category_Contacts_Count_12_mon_Dependent_count_Education_Level_Months_Inactive_12_mon_2'], axis = 1)","1b97702c":"bank.info()","b1e83665":"import missingno as msno","d0ef604d":"bank.isnull().sum()","fd83bb83":"# Visualize missing values as a matrix\n# msno.matrix(train,figsize=(11,7), sparkline=False, fontsize=12, color=(0.27, 0.52, 1.0));\nmsno.matrix(bank,figsize=(11,7), fontsize=12, color=(1, 0.38, 0.27));","8ad5b63f":"# Visualize the number of missing values as a bar chart\n# color=\"dodgerblue\" \"orangered\"\nmsno.bar(bank, color=\"dodgerblue\", sort=\"ascending\", figsize=(13,7), fontsize=12);","c3c011ad":"fig = plt.figure(figsize=(15,7))\n\nax1 = fig.add_subplot(1,2,1)\nmsno.bar(bank, color=\"tomato\", fontsize=12, ax=ax1);\n\nax2 = fig.add_subplot(1,2,2)\nmsno.bar(bank, log=True, color=\"tab:green\", fontsize=12, ax=ax2);\n\nplt.tight_layout()","a6d86ec6":"# Visualize the correlation between the number of missing values in different columns as a heatmap\nmsno.heatmap(bank, cmap=\"RdYlGn\", figsize=(10,5), fontsize=12)","3b24d6fb":"msno.dendrogram(bank, figsize=(12,7), fontsize=12)","c4af2c05":"for feature in bank.columns:\n    if bank[feature].dtype not in ['int64', 'float64']:\n        print(f'{feature}: {bank[feature].unique()}')","2ed26df0":"fig, ax = plt.subplots(nrows=3, ncols=1, figsize=(16, 28))\nsns.set(font_scale=1.6)\ncols_ = [\"Education_Level\", \"Marital_Status\", \"Income_Category\"]\n\nfor ind, col in enumerate(cols_):\n    sns.countplot(x=col, data=bank, ax=ax[ind])","7ba9e41d":"fig, ax = plt.subplots(figsize=(20, 16))\ndf_corr = bank.corr(method=\"pearson\")\nmask = np.zeros_like(np.array(df_corr))\nmask[np.triu_indices_from(mask)] = True\nax = sns.heatmap(df_corr, mask=mask, annot=True)","3d66769d":"plt.figure(figsize = (10,8))\nsns.countplot(x = bank['Attrition_Flag'], edgecolor = 'black', saturation = 0.55)\nplt.show()","c1424890":"plt.figure(figsize = (10, 8))\nsns.countplot(x = bank['Card_Category'], hue = bank['Gender'], edgecolor = 'black', saturation = 0.55)\nplt.show()","e86efc32":"plt.figure(figsize = (15,8))\nsns.countplot(x= bank['Education_Level'], edgecolor = 'black', saturation = 0.55)\nplt.show()","374109c6":"# data type plot\nplt.figure(figsize=(9,7))\nbank.dtypes.value_counts().plot.pie(explode=[0.1,0.1,0.1],autopct='%1.1f%%',shadow=True)\nplt.title('type of our data');","fbd223b8":"X = bank.copy()\nX = X.drop(['Credit_Limit'], axis=1)\ny = X.pop('Attrition_Flag')\n\nX['Income_Category'] = X['Income_Category'].replace({'Less than $40K':0,\n                                                     '$40K - $60K':1,\n                                                     '$60K - $80K':2,\n                                                     '$80K - $120K':3,\n                                                     '$120K +':4})\nX['Card_Category'] = X['Card_Category'].replace({'Blue':0,\n                                                 'Silver':1,\n                                                 'Gold':2,\n                                                 'Platinum':3})\nX['Education_Level'] = X['Education_Level'].replace({'Uneducated':0,\n                                                     'High School':1,\n                                                     'College':2,\n                                                     'Graduate':3,\n                                                     'Post-Graduate':4,\n                                                     'Doctorate':5})\n\ny = y.replace({'Existing Customer':0,\n               'Attrited Customer':1})","3c672a7a":"# Encoding the Target feature\ny = y.replace({'Existing Customer':0,\n               'Attrited Customer':1})","0c189c00":"!pip install evalml","8238dfaf":"import evalml","d4372226":"from evalml.pipelines.components.transformers.imputers.simple_imputer import SimpleImputer\n\ndef preprocessing(X, y):\n    imputer = SimpleImputer(impute_strategy=\"most_frequent\", missing_values=\"Unknown\")\n    X = imputer.fit_transform(X, y)\n    \n    return X\n\nX = preprocessing(X, y)","d67d0e26":"from evalml.utils import infer_feature_types\n\nX = infer_feature_types(X, feature_types={'Income_Category': 'categorical',\n                                          'Education_Level': 'categorical'})\nX","45c2f716":"# Splitting the dataset into 80% train and 20% test.\nX_train, X_test, y_train, y_test = evalml.preprocessing.split_data(X, y, problem_type='binary',\n                                                                         test_size=.2)","d27322e4":"from evalml import AutoMLSearch\n\nautoml = AutoMLSearch(X_train=X_train, y_train=y_train, problem_type=\"binary\", objective=\"F1\", \n                      allowed_model_families=['random_forest' , 'xgboost', 'lightgbm'],\n                      additional_objectives=['accuracy binary'], max_batches=5)\nautoml.search()","fbf909b5":"automl.rankings","ec5279a2":"# We can get the object of any pipeline via their id as well:\npipeline = automl.get_pipeline(1)\nprint('Name:\\n',pipeline.name)\nprint('\\n\\nParameters:\\n\\n', pipeline.parameters)","4b905a88":"best_pipeline_ = automl.best_pipeline\nprint('Best pipeline:\\n\\n', best_pipeline_.name)\nprint('\\n\\nBest pipeline parameters:\\n\\n', best_pipeline_.parameters)","e0705137":"# We can also visualize the structure of our pipeline\nbest_pipeline_.graph()","9bddaadf":"# Display Hyperparameters\nautoml.best_pipeline.hyperparameters","cc2e49b0":"automl.describe_pipeline(3)","e9c40ea0":"automl.describe_pipeline(automl.rankings.iloc[1][\"id\"])","19c30471":"automl.results","33406886":"# Evaluate on the test data\nscores = best_pipeline_.score(X_test, y_test, objectives=evalml.objectives.get_core_objectives('binary'))\nprint(f'Accuracy Binary: {scores[\"Accuracy Binary\"]}') ","90b3ac77":"best_pipeline_.fit(X_train, y_train)\npredictions = best_pipeline_.predict(X_test)","51866972":"from evalml.model_understanding.graphs import (\n    graph_binary_objective_vs_threshold, \n    graph_permutation_importance, \n    graph_confusion_matrix\n)\n\ngraph_binary_objective_vs_threshold(best_pipeline_, X_test, y_test, \"F1\")","20036f7b":"graph_permutation_importance(best_pipeline_, X_test, y_test, \"F1\")","c2df456d":"graph_confusion_matrix(y_test, predictions)","e33eb1c7":"from evalml.objectives.standard_metrics import AccuracyBinary, AUC, F1, PrecisionWeighted, Recall\n\nacc = AccuracyBinary()\nauc = AUC()\nf1 = F1()\npre_w = PrecisionWeighted()\nrec = Recall()\n\nprint(f\"Accuracy (Binary): {acc.score(y_true=y_test, y_predicted=predictions)}\")\nprint(f\"Area Under Curve: {auc.score(y_true=y_test, y_predicted=predictions)}\")\nprint(f\"F1: {f1.score(y_true=y_test, y_predicted=predictions)}\")\nprint(f\"Precision (Weighted): {pre_w.score(y_true=y_test, y_predicted=predictions)}\")\nprint(f\"Recall: {rec.score(y_true=y_test, y_predicted=predictions)}\")","7c29afed":"<h1 style='background-color:LimeGreen; font-family:newtimeroman; font-size:200%; text-align:center; border-radius: 15px 50px;' > b) Pandas Profiling <\/h1>\n\n#### Refer below notebook on **Pandas Profiling**\n - https:\/\/www.kaggle.com\/sureshmecad\/pandas-profiling-autoeda","5608f303":"<h1 style='background-color:magenta; font-family:newtimeroman; font-size:200%; text-align:center; border-radius: 15px 50px;' > 3) Read Data <\/h1>","652347c8":"<h1 style='background-color:LimeGreen; font-family:newtimeroman; font-size:170%; text-align:center; border-radius: 15px 50px;' > g) Access raw results <\/h1>","6b809c2c":"### Confusion Matrix","6d78aa0e":"<h1 style='background-color:magenta; font-family:newtimeroman; font-size:200%; text-align:center; border-radius: 15px 50px;' > 1) Introduction<\/h1>","825db3bd":"### Feature Importance","46181fb6":"<h1 style='background-color:LimeGreen; font-family:newtimeroman; font-size:170%; text-align:center; border-radius: 15px 50px;' > iii) Data Preprocessing <\/h1>","b8b1f923":"<h2 style=color:blue align=\"left\"> Table of Contents <\/h2>\n\n#### 1) Introduction\n#### 2) Load Required Libraries\n#### 3) Read Data\n#### 4) EDA (Exploratory Data Analysis)\n       - i) Missing Values\n       - ii) Data Visualization\n         - a) Regular method\n         - b) Pandas Profiling\n         - c) AutoViz\n         - b) Data Prep\n       - iii) Data Preprocessing\n#### 5) EvalML (AutoML)","c94e2eee":"<h1 style='background-color:LimeGreen; font-family:newtimeroman; font-size:200%; text-align:center; border-radius: 15px 50px;' > a) Regular Method <\/h1>","8e15c7a5":"<h1 style='background-color:magenta; font-family:newtimeroman; font-size:200%; text-align:center; border-radius: 15px 50px;' > 2) Load Required Libraries <\/h1>","414c4b15":"<h2 style=color:green align=\"left\"> About Features in data <\/h2>\n\n|Feature                   |Description                       |\n|--------------------------|----------------------------------|\n|CLIENTNUM                 |Client number. Unique identifier for the customer holding the account |\n|Attrition_Flag            |Internal event (customer activity) variable - if the account is closed then 1 else 0 |\n|Customer_Age              |Demographic variable - Customer's Age in Years    |\n|Gender                    |Demographic variable - M=Male, F=Female           |\n|Dependent_count           |Demographic variable - Number of dependents       |\n|Education_Level           |Demographic variable - Educational Qualification of the account holder (example: high school, college graduate, etc.)   |\n|Marital_Status            |Demographic variable - Married, Single, Divorced, Unknown    |\n|Income_Category           |Demographic variable - Annual Income Category of the account holder (< 40K, 40K - 60K, 60K - 80K, 80K-120K, >)    |\n|Card_Category             |Product Variable - Type of Card (Blue, Silver, Gold, Platinum)        |\n|Months_on_book            |Period of relationship with bank            |\n|Total_Relationship_Count  |Total no. of products held by the customer  |\n|Months_Inactive_12_mon    |No. of months inactive in the last 12 months         |\n|Contacts_Count_12_mon     |No. of Contacts in the last 12 months                |\n|Credit_Limit              |Credit Limit on the Credit Card                      |\n|Total_Revolving_Bal       |Total Revolving Balance on the Credit Card           |\n|Avg_Open_To_Buy           |Open to Buy Credit Line (Average of last 12 months)  |\n|Total_Amt_Chng_Q4_Q1      |Change in Transaction Amount (Q4 over Q1)            |\n|Total_Trans_Amt           |Total Transaction Amount (Last 12 months)            |\n|Total_Trans_Ct            |Total Transaction Count (Last 12 months)             |\n|Total_Ct_Chng_Q4_Q1       |Change in Transaction Count (Q4 over Q1)             |            \n|Avg_Utilization_Ratio     |Average Card Utilization Ratio                       |","eeabe013":"<h1 style='background-color:LimeGreen; font-family:newtimeroman; font-size:170%; text-align:center; border-radius: 15px 50px;' > a) Install EvalML (AutoML) <\/h1>","8f0416ef":"<h1 style='background-color:LimeGreen; font-family:newtimeroman; font-size:170%; text-align:center; border-radius: 15px 50px;' > f) Describe pipeline <\/h1>","8aef545d":"<h1 style='background-color:LimeGreen; font-family:newtimeroman; font-size:170%; text-align:center; border-radius: 15px 50px;' > c) Visualize missing values as a heatmap <\/h1>","bb48df87":"#### a) Install EvalML (AutoML)\n#### b) Configure search\n#### c) Pipeline Rankings\n#### d) Get pipeline\n#### e) Select Best pipeline\n#### f) Describe pipeline\n#### g) Access raw results","bad341ed":"<h1 style='background-color:magenta; font-family:newtimeroman; font-size:200%; text-align:center; border-radius: 15px 50px;' > 4) EDA (Exploratory Data Analysis) <\/h1>","b93caa0f":"<h1 style='background-color:LimeGreen; font-family:newtimeroman; font-size:170%; text-align:center; border-radius: 15px 50px;' > e) Select Best pipeline <\/h1>","d31f293d":"<h1 style='background-color:LimeGreen; font-family:newtimeroman; font-size:170%; text-align:center; border-radius: 15px 50px;' > d) Visualize missing values as a dendogram <\/h1>","c775db14":"- Each **pipeline is given an id.** We can get more information about any **particular pipeline** using that id. Here, we will get more information about the **pipeline with id = 1.**","7211bb61":"<h1 style='background-color:LimeGreen; font-family:newtimeroman; font-size:200%; text-align:center; border-radius: 15px 50px;' > d) DataPrep <\/h1>\n\n#### Refer below notebook on **DataPrep**\n - https:\/\/www.kaggle.com\/sureshmecad\/dataprep-autoeda","54aa4642":"<h1 style='background-color:LimeGreen; font-family:newtimeroman; font-size:170%; text-align:center; border-radius: 15px 50px;' > d) Get pipeline <\/h1>","17a7d71f":"<h1 style='background-color:LimeGreen; font-family:newtimeroman; font-size:170%; text-align:center; border-radius: 15px 50px;' > b) Visualize missing values as a barplot <\/h1>","f65f09b3":"<img src=\"https:\/\/imgur.com\/vOXQtGh.png\" width='600px'>\n\n<img src=\"https:\/\/imgur.com\/m1roGCX.png\" width='1000px'>","4ede1ec9":"<h1 style='background-color:LimeGreen; font-family:newtimeroman; font-size:170%; text-align:center; border-radius: 15px 50px;' > b) Configure search <\/h1>","03374c82":"<h1 style='background-color:LimeGreen; font-family:newtimeroman; font-size:170%; text-align:center; border-radius: 15px 50px;' > c) Pipeline Rankings <\/h1>","57763278":"<h1 style='background-color:LimeGreen; font-family:newtimeroman; font-size:170%; text-align:center; border-radius: 15px 50px;' > i) Missing Values <\/h1>","098f8b57":"<h1 style='background-color:LimeGreen; font-family:newtimeroman; font-size:170%; text-align:center; border-radius: 15px 50px;' > a) Visualize missing values as a matrix <\/h1>","56df7c2b":"<h1 style='background-color:LimeGreen; font-family:newtimeroman; font-size:200%; text-align:center; border-radius: 15px 50px;' > c) AutoViz <\/h1>\n\n#### Refer below notebook on **AutoViz**\n - https:\/\/www.kaggle.com\/sureshmecad\/autoviz-autoeda","f6ef0742":"#### Visualize missing values (NaN) values using Missingno Library\na) Visualize missing values as a matrix\n\nb) Visualize missing values as a barplot\n\nc) Visualize missing values as a heatmap\n\nd) Visualize missing values as a dendrogram","a692a546":"<h1 style='background-color:magenta; font-family:newtimeroman; font-size:200%; text-align:center; border-radius: 15px 50px;' > 5) EvalML (AutoML) <\/h1>","b4df03b2":"<h2 style=color:green align=\"left\"> Problem and Dataset <\/h2>\n- Predicting Customer Churn dataset on Kaggle is a supervised classification task where the objective is to predict whether or not a customer will end up leaving their bank's credit card service.\n\n - We use **Dataprep** for auto visualisation.\n \n - We use **EvalML** to search and select a pipeline that performs the best at identifying customers who are more likely to leave their bank.\n\n<h2 style=color:green align=\"left\"> Approach <\/h2>\n- We will show how EvalML can be leveraged to perform preprocessing, visualization, and automated machine learning. While EvalML allows for plenty of options for customization to improve prediction outcomes, we'll focus on a fairly high-level implementation.\n\n<h2 style=color:green align=\"left\"> Our approach will be as follows: <\/h2>\n\n - Read in the data and analyze it.\n - Understand the data through visualization.\n - Perform basic preprocessing.\n - Search for a best performing pipeline based on our objective.\n - Review the best pipeline chosen and analyze its performance.","3baf6301":"<h1 style='background-color:LimeGreen; font-family:newtimeroman; font-size:170%; text-align:center; border-radius: 15px 50px;' > ii) Data Visualization <\/h1>","d650bfbd":"- The **AutoMLSearch** class records detailed results information under the results field, including information about the **cross-validation scoring and parameters.**"}}