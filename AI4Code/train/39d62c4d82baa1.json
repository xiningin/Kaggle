{"cell_type":{"534a865a":"code","79e44391":"code","c5fb8a6f":"markdown","7ecf72ae":"markdown","7fc5ab3d":"markdown","38c4d079":"markdown"},"source":{"534a865a":"from tensorflow.python.keras.applications import ResNet50\nfrom tensorflow.python.keras.models import Sequential\nfrom tensorflow.python.keras.layers import Dense, Flatten, GlobalAveragePooling2D\n\nnum_classes = 2\nresnet_weights_path = '..\/input\/resnet50\/resnet50_weights_tf_dim_ordering_tf_kernels_notop.h5'\n\nmy_new_model = Sequential()\nmy_new_model.add(ResNet50(include_top=False, pooling='avg', weights=resnet_weights_path))\nmy_new_model.add(Dense(num_classes, activation='softmax'))\n\nmy_new_model.layers[0].trainable = False\n\nmy_new_model.compile(optimizer='sgd', loss='categorical_crossentropy', metrics=['accuracy']) #'sgd' for the optimizer stands for stochastic gradient descent","79e44391":"from tensorflow.python.keras.applications.resnet50 import preprocess_input\nfrom tensorflow.python.keras.preprocessing.image import ImageDataGenerator\n\nimage_size = 224\n\n# Specify the values for all arguments to data_generator_with_aug. Then uncomment those lines\ndata_generator_with_aug = ImageDataGenerator(preprocessing_function=preprocess_input,\n                                              horizontal_flip=True,  #flips the images horizontally for model prediction\n                                              width_shift_range=0.2,  #horizontally shifts the images for model prediction\n                                              height_shift_range=0.2)   #vertically shifts the image for model prediction  \n                                                 \n                                                \n                                                  \ndata_generator_no_aug = ImageDataGenerator(preprocessing_function=preprocess_input)\n\n\n# Specify which type of ImageDataGenerator above is to load in training data\ntrain_generator = data_generator_no_aug.flow_from_directory(\n        directory = '..\/input\/dogs-gone-sideways\/images\/train',\n        target_size=(image_size, image_size),\n        batch_size=12,\n        class_mode='categorical')\n\n# Specify which type of ImageDataGenerator above is to load in validation data\nvalidation_generator = data_generator_no_aug.flow_from_directory(\n        directory = '..\/input\/dogs-gone-sideways\/images\/val',\n        target_size=(image_size, image_size),\n        class_mode='categorical')\n\nmy_new_model.fit_generator(\n        train_generator, # specify where model gets training data\n        epochs = 2,\n        steps_per_epoch=3, #howny steps per epoch\n        validation_data=validation_generator) # specify where model gets validation data","c5fb8a6f":"# 2) Fit the Model Using Data Augmentation\n\nRun this cell and you should get a model that achieves about 90% accuracy.  By using data augmentation, you cut the error rate in half.","7ecf72ae":"# Exercise Introduction\nWe will return to the automatic rotation problem you worked on in the previous exercise.\n\nWe also supply much of the code you've already worked with.  Fork this notebook and take on the data augmentation step (step 2 below).","7fc5ab3d":"# 1) Specify and Compile the Model\nThis works the same way as in the code you've previously worked on. So you receive a complete version of it here.  Run this cell to specify and compile the model","38c4d079":"# Keep Going\nYou are ready for [a deeper understanding of deep learning](https:\/\/www.kaggle.com\/dansbecker\/a-deeper-understanding-of-deep-learning\/)."}}