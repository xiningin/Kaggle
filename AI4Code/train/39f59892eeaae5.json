{"cell_type":{"d3b59cc2":"code","43801bda":"code","79aa7b83":"code","4beae17c":"code","c9b681cf":"code","5851dccb":"code","aedb359a":"code","d883fccd":"code","9b0f58d1":"code","f8132473":"code","ccbee9e6":"code","a1b51484":"code","0ddeaae6":"code","f5023911":"code","9cd1d023":"code","e4df5625":"code","92a80a96":"code","c547e40d":"code","9b8fce6c":"code","d38bc021":"code","961c4686":"markdown","b6e6b9f5":"markdown","0e7570cd":"markdown","464891b9":"markdown","d7d88362":"markdown","3fb3cfd1":"markdown","af76b8e2":"markdown"},"source":{"d3b59cc2":"%reload_ext autoreload \n%autoreload 2\n%matplotlib inline","43801bda":"from fastai import *\nfrom fastai.vision import *","79aa7b83":"bs = 64\nnp.random.seed(2)","4beae17c":"data_path = \"..\/input\/poisonous_plants_dataset\/\"\ndata = ImageDataBunch.from_folder(data_path, bs=bs\/\/2, size=299, ds_tfms=get_transforms(),num_workers=0).normalize(imagenet_stats)","c9b681cf":"data.show_batch(rows=4,figsize=(8,8))","5851dccb":"learn = create_cnn(data, models.resnet50, metrics=accuracy, path=\".\")","aedb359a":"learn.fit_one_cycle(4)","d883fccd":"interp = ClassificationInterpretation.from_learner(learn)","9b0f58d1":"interp.plot_confusion_matrix(figsize=(8,8))","f8132473":"interp.plot_top_losses(9,figsize=(14,14))","ccbee9e6":"interp.most_confused(min_val=0)","a1b51484":"learn.save('stage-1')","0ddeaae6":"learn.lr_find()","f5023911":"learn.recorder.plot()","9cd1d023":"learn.unfreeze()\nlearn.fit_one_cycle(4,max_lr=slice(4e-6,1e-5))","e4df5625":"interp = ClassificationInterpretation.from_learner(learn)","92a80a96":"interp.plot_confusion_matrix(figsize=(8,8))","c547e40d":"interp.plot_top_losses(9,figsize=(14,14))","9b8fce6c":"test_data = ImageDataBunch.from_folder(data_path, bs=bs\/\/2, size=299, ds_tfms=get_transforms(),num_workers=0,valid='test').normalize(imagenet_stats)\nloss, acc = learn.validate(test_data.valid_dl)","d38bc021":"print(f'Loss: {loss}, Accuracy: {acc*100} %')","961c4686":"# Load data","b6e6b9f5":"# Create and train model","0e7570cd":"# Interpret Fine tuning results","464891b9":"# Setup","d7d88362":"# Predict on test data","3fb3cfd1":"# Fine tuning","af76b8e2":"# Interpret results"}}