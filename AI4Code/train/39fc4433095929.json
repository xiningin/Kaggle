{"cell_type":{"26bbcd23":"code","4e83f3aa":"code","ec394a50":"code","be02ae67":"code","c7fe2558":"code","dddf74b9":"code","4d3aceaa":"code","6edc3e40":"code","4d9adc1d":"code","fe3df9d4":"code","5c173256":"code","874ea587":"code","4674ae9f":"code","6db86f86":"code","c3b66941":"code","2c5c1d03":"code","dcb8c762":"code","6426372d":"code","7cb31500":"code","ae42b7cf":"code","0d4600ef":"code","7f525dd6":"code","5ea4fe4a":"markdown","55f8f048":"markdown","f49e52ca":"markdown","3b7db5b0":"markdown","b6c152da":"markdown","1bdcf745":"markdown"},"source":{"26bbcd23":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport pandas_profiling\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport warnings\n\nwarnings.filterwarnings('ignore')\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","4e83f3aa":"df= pd.read_csv('\/kaggle\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv')\ndf.head()","ec394a50":"df.info()","be02ae67":"df.describe()","c7fe2558":"df.profile_report()","dddf74b9":"df['Gender']= pd.get_dummies(df['Gender'])","4d3aceaa":"df.head(10)","6edc3e40":"df.hist(figsize=(10,10))","4d9adc1d":"sns.scatterplot(x= df['Annual Income (k$)'], y= df['Age'], hue=df['Gender'])","fe3df9d4":"sns.scatterplot(x= df['Annual Income (k$)'], y= df['Spending Score (1-100)'], hue=df['Gender'])","5c173256":"sns.scatterplot(x= df['Annual Income (k$)'], y= df['Spending Score (1-100)'], hue=df['Age'])","874ea587":"from sklearn.preprocessing import normalize\nfrom sklearn.cluster import KMeans\nfrom scipy.cluster.hierarchy import linkage, fcluster, dendrogram\n","4674ae9f":"num_cols= ['Annual Income (k$)', 'Spending Score (1-100)', 'Age']\n\nnorm= normalize(df[num_cols])\ndf_scaled= pd.DataFrame(norm, columns= num_cols)\ndf_scaled.head()\n             ","6db86f86":"df_scaled['Gender']= df['Gender']","c3b66941":"df_scaled","2c5c1d03":"dmatrix= linkage(df_scaled[['Age',  'Spending Score (1-100)','Annual Income (k$)' ]], method= 'complete', metric= 'euclidean')\n","dcb8c762":"plt.figure(figsize=(25, 10))\nplt.title('Hierarchical Clustering Dendrogram')\nplt.xlabel('sample index')\nplt.ylabel('distance')\ndendrogram(\n    dmatrix,\n    leaf_font_size=8, \n)\nplt.show()","6426372d":"distortions= []\nfor i in range(1,30):\n    kmeans= KMeans(n_clusters=i, init='k-means++', n_init=10, max_iter=300, tol=0.0001,random_state= 100, algorithm= 'full')\n    kmeans.fit(df_scaled[num_cols])\n    distortions.append(kmeans.inertia_)\n    \nplt.plot(np.arange(1,30,1), distortions,  alpha= 0.5)       \nplt.plot(np.arange(1,30,1), distortions,'o',  alpha= 0.5)    \nplt.show()\n","7cb31500":"df_scaled","ae42b7cf":"kmeans= KMeans(n_clusters=5,  init='k-means++', n_init=30, max_iter=300, tol=0.0001,random_state= 100, algorithm= 'full')\nkmeans.fit(df_scaled[num_cols])\ndf_scaled['cluster_labels']= kmeans.labels_","0d4600ef":"df_scaled","7f525dd6":"sns.scatterplot(x= 'Annual Income (k$)', y= 'Spending Score (1-100)', hue='cluster_labels', data= df_scaled, palette= 'bright')","5ea4fe4a":"# Exploratory Data Analysis","55f8f048":"# Preprocessing the Data","f49e52ca":"# Loading the Data","3b7db5b0":"# Hierarchical Clustering","b6c152da":"# K-Means Clustering","1bdcf745":"# Observations:\n* Female footfall is more than male footfall in the mall\n* Age Group 20-25 and 30-40 are most spotted in mall\n* Most shoppers have annual income 60-80k\n* Most of the shoppers with Spending score 40-60 have an annual income of 40-60k\n* People with lower income tend to have spending score\n* Age Group 20-30 have the highest spending scores"}}