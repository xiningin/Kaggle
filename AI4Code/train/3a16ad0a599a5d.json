{"cell_type":{"62058643":"code","def05f8f":"code","a0d03105":"code","26d56d99":"code","74cf0a41":"code","f69a66bf":"code","0adb2fc4":"code","2bb7893d":"code","9733b10d":"code","3cfc8d7c":"code","d24719b1":"code","beb928ae":"code","9add748d":"code","db895352":"code","2c4afe79":"code","dffa50b9":"code","e8779e73":"code","f1e5a1e9":"code","faba8f64":"code","75ff9488":"code","1818bbd2":"code","fa580e68":"code","7a91d53b":"code","2744da7e":"code","750ba7e5":"code","0b708dea":"code","5979c984":"code","2c5bcd30":"code","d4d99936":"code","d2210d47":"code","899a2b0c":"markdown","b32acdb3":"markdown","fbb9fc16":"markdown","dc775527":"markdown","8935adb7":"markdown","f1e841b5":"markdown","8fe0f4e8":"markdown","a6e7640c":"markdown","8245e953":"markdown"},"source":{"62058643":"#dealing with data\nimport numpy as np\nimport pandas as pd\n\n#plot\nimport matplotlib.pyplot as plt\nimport matplotlib.image as mpimg\n%matplotlib inline\nimport seaborn as sns\n\n#map\nimport geopandas as gpd\nfrom shapely import wkt\n\n#wordcloud\nfrom wordcloud import WordCloud","def05f8f":"airbnb=pd.read_csv('..\/input\/new-york-city-airbnb-open-data\/AB_NYC_2019.csv')\n\nairbnb.head(5)","a0d03105":"airbnb.shape","26d56d99":"airbnb.isnull().sum()","74cf0a41":"airbnb['price'].quantile([0,.25, .5,0.75,1])","f69a66bf":"plt.figure(figsize=(10,10))\nax = sns.boxplot(data=airbnb,y='price')\nplt.ylim(0,1000)","0adb2fc4":"#Number of 0$\nlen(airbnb[airbnb.price==0.0])","2bb7893d":"#Number of 10,000$\nlen(airbnb[airbnb.price==10000.0])","9733b10d":"len(airbnb[airbnb.price>2000.0])","3cfc8d7c":"#Remove 0$ and take only price under 2000$ by night\nairbnb = airbnb[airbnb.price != 0.0]\nairbnb = airbnb[airbnb.price <= 2000.0]","d24719b1":"sns.countplot(airbnb['room_type'], palette=\"plasma\")\nfig = plt.gcf()\nfig.set_size_inches(10,10)\nplt.title('Number of listings by type of room ')\n","beb928ae":"# Data for maps\nnyc = gpd.read_file(gpd.datasets.get_path('nybb'))\nnyc.head(5)\n\n# Count the number of listings by borough\nborough_count = airbnb.groupby('neighbourhood_group').agg('count').reset_index()\n\n#Rename the column to join the data \nnyc.rename(columns={'BoroName':'neighbourhood_group'}, inplace=True)\nbc_geo = nyc.merge(borough_count, on='neighbourhood_group')\n\n#Plot the count by borough into a map\nfig,ax = plt.subplots(1,1, figsize=(10,10))\nbc_geo.plot(column='id', cmap='viridis_r', alpha=.5, ax=ax, legend=True)\nbc_geo.apply(lambda x: ax.annotate(s=x.neighbourhood_group, color='black', xy=x.geometry.centroid.coords[0],ha='center'), axis=1)\nplt.title(\"Number of Airbnb Listings by NYC Borough\")\nplt.axis('off')","9add748d":"sns.countplot(airbnb['neighbourhood_group'], palette=\"plasma\")\nfig = plt.gcf()\nfig.set_size_inches(10,10)\nplt.title('Number of listings by borough ')\n","db895352":"# Data group by neighbourhood_group (borough)\nairbnb_neighbourhood_group = airbnb.groupby(['neighbourhood_group']) \n","2c4afe79":"# Quartile by borough\nairbnb_neighbourhood_group['price'].quantile([0,.25, .5,0.75,1]).to_frame()","dffa50b9":"viz_price_neighbourhood_group=sns.violinplot(data=airbnb[airbnb.price < 500], x='neighbourhood_group', y='price')\nviz_price_neighbourhood_group.set_title('Density and distribution of prices for each borough')","e8779e73":"#Compute average price by borough and join\nborough_price = airbnb.groupby('neighbourhood_group').agg('median').reset_index()[['neighbourhood_group','price']]\nbp_geo = nyc.merge(borough_price, on='neighbourhood_group')\nbp_geo","f1e5a1e9":"fig,ax = plt.subplots(1,1, figsize=(10,10))\nbp_geo.plot(column='price', cmap='plasma_r', alpha=.5, ax=ax, legend=True) #change cmap for colors\nbp_geo.apply(lambda x: ax.annotate(s=x.neighbourhood_group, color='black', xy=x.geometry.centroid.coords[0],ha='center'), axis=1)\nplt.title(\"Median price of Airbnb by NYC Borough\")\nplt.axis('off')","faba8f64":"plt.figure(figsize=(10,10))\nax = sns.boxplot(data=airbnb[airbnb.neighbourhood_group == \"Manhattan\"],y='price')\nplt.ylim(0,1000)","75ff9488":"airbnb_manhattan = airbnb[airbnb.neighbourhood_group == \"Manhattan\"].groupby(['neighbourhood']) \nairbnb_med_manhattan = airbnb_manhattan['price'].median().to_frame()\n\nairbnb_med_manhattan_sort = airbnb_med_manhattan.sort_values(by='price')\nplt.figure(figsize=(40,30))\nax = sns.barplot(x=airbnb_med_manhattan_sort.index, y=\"price\", data=airbnb_med_manhattan_sort)\n","1818bbd2":"plt.figure(figsize=(10,10))\nax = sns.boxplot(data=airbnb[airbnb.neighbourhood_group == \"Bronx\"],y='price')\nplt.ylim(0,1000)","fa580e68":"airbnb_bronx = airbnb[airbnb.neighbourhood_group == \"Bronx\"].groupby(['neighbourhood']) \nairbnb_bronx_med = airbnb_bronx['price'].median().to_frame()\n\n\nairbnb_bronx_med_sort = airbnb_bronx_med.sort_values(by='price')\nplt.figure(figsize=(40,30))\nax = sns.barplot(x=airbnb_bronx_med_sort.index, y=\"price\", data=airbnb_bronx_med_sort)","7a91d53b":"airbnb.groupby(['neighbourhood'])['price'].median().to_frame().sort_values(by='price')","2744da7e":"# Import data from the website (find it)\nnbhoods = pd.read_csv('..\/input\/nyntacsv\/nynta.csv')\nnbhoods.head(5)","750ba7e5":"#Rename the column\nnbhoods.rename(columns={'NTAName':'neighbourhood'}, inplace=True)\n\n#Convert the geometry column text into well known text (librairy shapely)\nnbhoods['geom'] = nbhoods['the_geom'].apply(wkt.loads)\n\n#Now convert the pandas dataframe into a Geopandas GeoDataFrame\nnbhoods = gpd.GeoDataFrame(nbhoods, geometry='geom')","0b708dea":"airbnb = gpd.GeoDataFrame(airbnb, geometry=gpd.points_from_xy(airbnb.longitude, airbnb.latitude))\n\n# Spatial join (this code runs an intersect analysis to find which neighborhood the Airbnb location is in)\njoined = gpd.sjoin(nbhoods, airbnb, how='inner', op='intersects')\njoined.drop(columns='geom', inplace=True)\njoined.rename(columns={'neighbourhood_left':'neighbourhood'}, inplace=True)\nnb_join_price = joined.groupby('neighbourhood').agg('median').reset_index()[['neighbourhood','price']]\ntrue_count = nbhoods.merge(nb_join_price, on='neighbourhood')\n","5979c984":"fig,ax = plt.subplots(1,1, figsize=(10,10))\n\nbase = nbhoods.plot(color='white', edgecolor='black', ax=ax)\n\ntrue_count.plot(column='price',cmap='plasma_r', ax=base, legend=True)\nplt.title('Median Price of listings by Neighborhood in NYC')","2c5bcd30":"# Global wordcloud\nname = \" \".join(str(w) for w in airbnb.name)\nplt.subplots(figsize=(25,15))\nwordcloud = WordCloud(\n                          background_color='white',\n                          width=1920,\n                          height=1080,max_words=60\n                         ).generate(name)\nplt.imshow(wordcloud)\nplt.axis('off')\nplt.savefig('name.png')\nplt.show()","d4d99936":"name_manhattan = \" \".join(str(w) for w in airbnb.name[airbnb.neighbourhood_group == \"Manhattan\"])\nplt.subplots(figsize=(25,15))\nwordcloud = WordCloud(\n                          background_color='white',\n                          width=1920,\n                          height=1080,max_words=30\n                         ).generate(name_manhattan)\nplt.imshow(wordcloud)\nplt.axis('off')\nplt.savefig('name.png')\nplt.show()","d2210d47":"name_bronx = \" \".join(str(w) for w in airbnb.name[airbnb.neighbourhood_group == \"Bronx\"])\nplt.subplots(figsize=(25,15))\nwordcloud = WordCloud(\n                          background_color='white',\n                          width=1920,\n                          height=1080,max_words=30\n                         ).generate(name_bronx)\nplt.imshow(wordcloud)\nplt.axis('off')\nplt.savefig('name.png')\nplt.show()","899a2b0c":"We can see that there are 4 variables with missing values. I could have treated it but I don't need it in my study. ","b32acdb3":"<h2>Importing librairies and loading data<\/h2> ","fbb9fc16":"<h2> Sources <\/h2>\n\nThose notebooks helped me to do my analysis : \n\n- [https:\/\/www.kaggle.com\/geowiz34\/maps-of-nyc-airbnbs-with-python](https:\/\/www.kaggle.com\/geowiz34\/maps-of-nyc-airbnbs-with-python)\n- [https:\/\/www.kaggle.com\/chirag9073\/airbnb-analysis-visualization-and-prediction](https:\/\/www.kaggle.com\/chirag9073\/airbnb-analysis-visualization-and-prediction)","dc775527":"<h2>Quick analysis<\/h2>\n\nFirst, I computed the quantile to see the range of values. The median price is 106\\$ and 75% of the prices are under 175\\$. Also, some prices are 0\\$ which is not possible so I decided to delete them. Finally, we can say that most of the prices are between 50\\$ and 200\\$ and there are extreme values till 10,000\\$. I chose to keep the listings with a price under 2000\\$.\n\nI also checked the number of listings by type of room : there are mainly private room and entire home.","8935adb7":"\n<h1>NY City Airbnb - Data Analysis and Visualization<\/h1>\n\nThis notebook focuses on NYC Airbnb data. I mainly studied the price by borough and neighbourhood and the type of room. I tried different Data Visualization techniques such as plot, maps and wordclouds","f1e841b5":"There are 48,895 listings and 16 features. I will used the 8 columns : name, nighbourhood_group, neighbourhood, latitude, longitude, room_type, price and availability_365. ","8fe0f4e8":"<h2>Price analysis by neighbourhood<\/h2>\n\nIn this section, I wanted to see if each neighbourhood of each borough has the same median price or if there is disparity in a borough. The two barplots show the median prices of each neighbourhood in Manhattan and Bronx. I chose Manhattan and Bronx because there are spatially close but have global prices different. Actually, we see that some neighbourhoods of Bronx have the same price as some neighbourhood in Manhattan. Even, some of them (such as Riverdale) have a higher price than some neighbourhood of Manhattan (e.g Marble Hill). We find this idea on the map.\nIndeed, we can see that the North of Manhattan is very similar with the south of Bronx in terms of price. We've got the same idea between the part of Brooklyn wich is clode to the south of Manhattan or between the North of Brooklyn and the South of Queens. \nSo, the price depends more on the neighbourhood than the borough. Manhattan doesn't mean rich everywhere and Bronx poor. ","a6e7640c":"<h2>Word Analysis<\/h2>\n\nIn the last part, I just show some wordclouds about the name of the listings. Globally, we see that words related to Manhattan and Brooklyn are often used which reflects the number of listings in those boroughs. Also, private room and some words describing entire home are frequent (same idea with the number of listings for this type of room). \n\n<h4> Manhattan <\/h4>\n\nThe second wordcloud focuses only on Manhattan. We see that the places around the location is important (East Village, Times Sqaure, Harlem...) and a good description of the room (Spacious, Charming, Modern, Large...). There are also Private room and apartement which are the most type of room in this area. Finally, there is the word \"Luxury\" which shows that Airbnb hosts want to highlight that Manhattan is richer.\n\n<h4> Bronx <\/h4> \nFor this borough, we see that the Private Room is the most important type of room. In contrast to Manhattan, the hosts write \"Bronx\" instead of the places around the home. Also, there is \"subway\" which means that is important for a room in Bronx to have a subway nearby. ","8245e953":"<h2>Price analysis by borough<\/h2>\n\n- Number of listings by borough : we see that Manhattan and Brooklyn have more listings than Bronx or Staten Island. \n- Price by borough : the boroughs with the highest prices are also those with the most listings (Manhattan and Brooklyn). On the violin plot, we can see that Manhattan has a bigger range of value and higher prices, instead of Bronx, Queens and Staten Island distributions are more left-skewed with a price around 70."}}