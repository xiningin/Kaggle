{"cell_type":{"6f15086d":"code","a98629d1":"code","1dc35d30":"code","ed409926":"code","2a7f7134":"code","720650d1":"code","c24c4edf":"code","816845de":"code","c24bdd7f":"code","255fc2c3":"code","4432c8e4":"code","4ea65b40":"code","1e9d1455":"code","053f3b94":"code","36ad5534":"code","fd4dfd22":"code","57d7a3a6":"code","80472591":"code","e8f2b91d":"code","dbce24d8":"code","d8afde3f":"code","2c9725c7":"code","0d9d33d2":"code","2cacff56":"code","7fd492d0":"code","c1800891":"code","ee813f6d":"markdown","22a03bfb":"markdown","094a641d":"markdown","718f3f5a":"markdown","407e0e77":"markdown","d24cd7c7":"markdown","9d3bf11a":"markdown","60a8ee2c":"markdown","e4aa866c":"markdown","32003505":"markdown","f4c69976":"markdown","cdf4b1cb":"markdown","e8e0db3b":"markdown"},"source":{"6f15086d":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","a98629d1":"path = \"\/kaggle\/input\/jds101\/\"","1dc35d30":"data = pd.read_csv(path + 'fashion-mnist_train.csv')\ntest = pd.read_csv(path + 'new_test.csv')\ndata.head()","ed409926":"data.groupby('label').count()","2a7f7134":"test.head()","720650d1":"def print_img(line):\n    img = np.array(line).reshape(28, -1)\n    plt.imshow(img, cmap=\"gray\")","c24c4edf":"line = data.iloc[4]\nimg = np.array(line[1:])\nprint_img(img)","816845de":"from sklearn.neighbors import KNeighborsClassifier","c24bdd7f":"X_knn_train = np.array(data.iloc[:, 1:])\ny_knn_train = np.array(data.iloc[:, 0])\nX_knn_train.shape, y_knn_train.shape","255fc2c3":"from sklearn.decomposition import PCA","4432c8e4":"pca = PCA()\nX_pca = pca.fit(X_knn_train)","4ea65b40":"X_t = X_pca.transform(X_knn_train)\nX_t.shape","1e9d1455":"knn = KNeighborsClassifier(weights='distance' , n_neighbors=11)\nknn.fit(X_t, y_knn_train)","053f3b94":"X_knn_test = np.array(test)\nX_knn_test.shape","36ad5534":"X_test = X_pca.transform(X_knn_test)","fd4dfd22":"answer_knn = knn.predict(X_test)\nanswer_knn.shape","57d7a3a6":"print_img(X_knn_test[2])","80472591":"answer_knn[2]","e8f2b91d":"answers = answer_knn.reshape(10000, 1)","dbce24d8":"b = np.arange(1, 10001).reshape(10000, 1)\nb","d8afde3f":"result = np.concatenate((b, answers), axis=1)","2c9725c7":"df = pd.DataFrame(result)","0d9d33d2":"df.head()","2cacff56":"df.columns = ['id', 'label']","7fd492d0":"df.to_csv(\"answers.csv\", index=False)","c1800891":"knn.score(X_knn_train, y_knn_train)","ee813f6d":"\u0410 \u0442\u0435\u043f\u0435\u0440\u044c \u0441\u043a\u043b\u0435\u0438\u0432\u0430\u0435\u043c 2 \u043c\u0430\u0441\u0441\u0438\u0432\u0430 \u0442\u0430\u043a, \u0447\u0442\u043e\u0431\u044b \u0432 \u043f\u0435\u0440\u0432\u043e\u043c \u0441\u0442\u043e\u0431\u0438\u043a\u0435 \u0431\u044b\u043b\u0438 \u043d\u043e\u043c\u0435\u0440\u0430, \u0430 \u0432\u043e \u0432\u0442\u043e\u0440\u043e\u043c \u043f\u0440\u0435\u0434\u0438\u043a\u0442\u044b","22a03bfb":"\u041f\u0440\u0438\u043a\u0440\u0443\u0442\u0438\u043c \u0442\u0435\u043f\u0435\u0440\u044c PCA","094a641d":"## \u0412\u0437\u0433\u043b\u044f\u043d\u0435\u043c \u043d\u0430 \u0434\u0430\u043d\u043d\u044b\u0435","718f3f5a":"\u0417\u0430\u043f\u0438\u0441\u044b\u0432\u0430\u0442\u044c \u0432 \u0444\u0430\u0439\u043b \u043c\u043d\u0435 \u0443\u0434\u043e\u0431\u043d\u0435\u0435 \u0447\u0435\u0440\u0435\u0437 pandas, \u043f\u043e\u044d\u0442\u043e\u043c\u0443 \u043f\u0435\u0440\u0435\u0432\u0435\u0434\u0451\u043c \u043c\u0430\u0441\u0441\u0438\u0432 dataFrame","407e0e77":"\u041f\u0440\u043e\u043d\u0443\u043c\u0435\u0440\u0443\u0435\u043c \u043e\u0442\u0432\u0435\u0442\u044b. \u0421\u043e\u0433\u043b\u0430\u0441\u043d\u043e \u0437\u0430\u0434\u0430\u043d\u0438\u044e \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u0430 \u043d\u0443\u043c\u0435\u0440\u0430\u0446\u0438\u044f \u043e\u0442 1 \u0434\u043e 10 000. \u0421\u043d\u0430\u0447\u0430\u043b\u0430 \u0441\u043e\u0437\u0434\u0430\u0451\u043c \u043c\u0430\u0441\u0441\u0438\u0432 \u0441 \u043d\u043e\u043c\u0435\u0440\u0430\u043c\u0438","d24cd7c7":"\u0412\u044b\u0434\u0435\u043b\u0438\u043c \u0438\u0437 \u0434\u0430\u0442\u0430\u0444\u0440\u0435\u0439\u043c\u0430 \u0434\u0430\u043d\u043d\u044b\u0435 \u043e\u0431 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f\u0445, \u043b\u0435\u0439\u0431\u043b\u044b \u043f\u0435\u0440\u0435\u043d\u0435\u0441\u0451\u043c \u0432 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u044b\u0439 \u0432\u0435\u043a\u0442\u043e\u0440","9d3bf11a":"\u041f\u0435\u0440\u0435\u0437\u0430\u043f\u0438\u0448\u0435\u043c \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u043f\u0440\u0435\u0434\u0441\u043a\u0430\u0437\u0430\u043d\u0438\u044f \u0432 \u0441\u0442\u043e\u043b\u0431\u0438\u043a. \u0422\u0430\u043a \u0431\u0443\u0434\u0435\u0442 \u0443\u0434\u043e\u0431\u043d\u0435\u0435 \u0437\u0430\u043f\u0438\u0441\u044b\u0432\u0430\u0442\u044c \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u0432 \u0444\u0430\u0439\u043b","60a8ee2c":"\u041d\u0443 \u0430 \u0442\u0435\u043f\u0435\u0440\u044c \u043f\u0438\u0448\u0435\u043c \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u0432 \u0444\u0430\u0439\u043b","e4aa866c":"\u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0438\u043c \u043d\u0430 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0445 \u0441\u043e\u0441\u0435\u0434\u0435\u0439 \u0432 \u043a\u0430\u0436\u0434\u043e\u043c \u043a\u043b\u0430\u0441\u0441\u0435","32003505":"\u0421\u043e\u0433\u043b\u0430\u0441\u043d\u043e \u0437\u0430\u0434\u0430\u043d\u0438\u044e \u0441\u0442\u043e\u043b\u0431\u0438\u043a\u0438 \u0434\u043e\u043b\u0436\u043d\u044b \u0438\u043c\u0435\u043d\u043e\u0432\u0430\u0442\u044c\u0441\u044f 'id' \u0438 'label'. \u041f\u0435\u0440\u0435\u0438\u043c\u0435\u043d\u0443\u0435\u043c \u0438\u0445 \u0432 df","f4c69976":"\u0418\u043c\u043f\u043e\u0440\u0442\u0438\u0440\u0443\u0435\u043c \u0438\u043c\u043f\u043b\u0435\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044e \u0438\u0437 sklearn","cdf4b1cb":"\u0412\u0437\u0433\u043b\u044f\u043d\u0435\u043c \u043d\u0430 \u043e\u0434\u043d\u0443 \u0438\u0437 \u043a\u0430\u0440\u0442\u0438\u043d\u043e\u043a. \u041a\u043b\u0430\u0441\u0441 3 - \u044d\u0442\u043e \u043f\u043b\u0430\u0442\u044c\u044f. \u0437\u0430\u043f\u043e\u043c\u043d\u044e, \u0447\u0442\u043e\u0431\u044b \u043f\u0440\u043e\u0449\u0435 \u0431\u044b\u043b\u043e \u043f\u043e\u0442\u043e\u043c \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0442\u044c \u0442\u0435\u0441\u0442\u044b)","e8e0db3b":"## \u041f\u0440\u0438\u043c\u0435\u043d\u0438\u043c \u043a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440 KNN"}}