{"cell_type":{"efdc68e7":"code","0b7435d0":"code","5c90a5e5":"code","8067d26d":"code","affdb9df":"code","ba9a26df":"markdown","623e118c":"markdown"},"source":{"efdc68e7":"%%time\nimport pandas as pd\nimport numpy as np\nimport os\nimport glob\nimport easyocr\nimport cv2\nfrom joblib import Parallel, delayed\nfrom tqdm import tqdm\nimport matplotlib.pyplot as plt\n%matplotlib inline\n\ninput_path = '\/kaggle\/input\/data-science-winter-osaka2\/'\ntrain = pd.read_csv(input_path+'train.csv')\ntest = pd.read_csv(input_path+'test.csv')\ndisplay(train,test)","0b7435d0":"%%time\ntrain_image_path = input_path+'train\/train\/'\ntest_image_path = input_path+'test\/test\/'\n\nreader = easyocr.Reader(['en'],gpu=True)    \n\nfor p in [train_image_path,test_image_path]:\n    for i in train['img_path'].head():\n        inputPath = p + i\n        print (inputPath)\n        # show first 5 images\n        image = cv2.imread(inputPath)\n        image = cv2.cvtColor(image, cv2.COLOR_BGR2RGB)\n        plt.figure(figsize=(16,8))\n        plt.imshow(image)\n        plt.show()\n        # show ocr text\n        ocr_text = reader.readtext(inputPath)\n        sentence = \"\"\n        for o in ocr_text:\n            word = o[1] + ' '\n            sentence += word\n        print ('OCR Text:',sentence)            ","5c90a5e5":"%%time\n\ndef get_ocr(path,img):\n    img_path = path + img\n    ocr_text = reader.readtext(img_path)\n    sentence = \"\"\n    for o in ocr_text:\n        word = o[1] + ' '\n        sentence += word\n    return pd.DataFrame([[img,sentence]])\n            \nreader = easyocr.Reader(['en'],gpu=True)    \n\n# train\ntrain_all_ocr = pd.DataFrame()\nfor img in train['img_path']:\n    train_ocr = get_ocr(train_image_path,img)\n    train_all_ocr = pd.concat([train_all_ocr,train_ocr],axis=0)\ntrain_all_ocr.columns = ['img_path','ocr_text']    \ntrain_all_ocr.to_csv('train_all_ocr.csv',index=False)\n\n# test\ntest_all_ocr = pd.DataFrame()\nfor img in test['img_path']:\n    test_ocr = get_ocr(test_image_path,img)\n    test_all_ocr = pd.concat([test_all_ocr,test_ocr],axis=0)\ntest_all_ocr.columns = ['img_path','ocr_text']    \ntest_all_ocr.to_csv('test_all_ocr.csv',index=False)","8067d26d":"train_all_ocr","affdb9df":"test_all_ocr","ba9a26df":"# Show 5 Head images and ocr text","623e118c":"# Extract all the ocr text and save"}}