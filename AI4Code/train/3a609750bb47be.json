{"cell_type":{"c5efec04":"code","346858b0":"code","a6151bdd":"code","2d46ec96":"code","10c72c2f":"code","40c5e1ec":"code","e41f9e08":"code","36e02b5c":"code","114058cc":"code","0767c454":"code","b37f516b":"code","d04310ac":"markdown","9c3eb074":"markdown","ac1a15c0":"markdown","04d766aa":"markdown","675cb20e":"markdown","78cdc87c":"markdown","fcd3a69b":"markdown","912b8394":"markdown","9f8215bf":"markdown","65302054":"markdown","afd9f502":"markdown","57b01dbb":"markdown"},"source":{"c5efec04":"import fasttext\nimport unidecode\nimport string\n\nimport pandas as pd\n\nfrom sklearn.model_selection import train_test_split","346858b0":"df = pd.read_csv('\/kaggle\/input\/imdb-ptbr\/imdb-reviews-pt-br.csv')\ndf.head()","a6151bdd":"# Colocando a coluna id como index do dataset:\ndf.set_index('id', inplace=True) \n\n\n# Transformando o target para utilizar o fasttext:\ndf['target']=['__label__'+ s for s in df['sentiment']]","2d46ec96":"# Verificando a distribui\u00e7\u00e3o da vari\u00e1vel resposta\ndf['target'].value_counts()","10c72c2f":"# Colocando todas as palavras em caixa baixa:\ndf['text_pt'] = df['text_pt'].str.lower()\n# Removendo acentua\u00e7\u00e3o:\ndf['text_pt'] = df['text_pt'].apply(lambda text: unidecode.unidecode(text))\n# Removendo pontua\u00e7\u00e3o:\ndf['text_pt'] = df['text_pt'].str.replace('[{}]'.format(string.punctuation), '')","40c5e1ec":"df['text_pt'].head()","e41f9e08":"# Utilizando a propor\u00e7\u00e3o de 70\/30 para bases de treino e teste, respectivamente:\n\nX = df['text_pt']\nY = df['target']\n\nX_train, X_test, Y_train, Y_test = train_test_split(X,\n                                                    Y,\n                                                    test_size = 0.3,\n                                                    random_state = 42)","36e02b5c":"# Reunindo novamente as bases de treino e teste:\n\ndata_train = {'target': Y_train, 'text': X_train}\ndf_train = pd.DataFrame.from_dict(data_train)\ndata_test = {'target': Y_test, 'text': X_test}\ndf_test = pd.DataFrame.from_dict(data_test)","114058cc":"# Salvando as bases de treino e teste em arquivos separados:\n\ndf_train.to_csv('df_train.csv', sep='\\t', index = False, header = False)\ndf_test.to_csv('df_test.csv', sep='\\t', index = False, header = False)","0767c454":"model = fasttext.train_supervised(input='df_train.csv')","b37f516b":"model.test('df_test.csv')","d04310ac":"Treinando o modelo:","9c3eb074":"No teste do modelo, as medidas que a fun\u00e7\u00e3o exibe s\u00e3o a quantidade de registros da base de teste, a precis\u00e3o e o revoca\u00e7\u00e3o, respectivamente.","ac1a15c0":"# Modelagem","04d766aa":"**Conseguimos valores na casa dos 88% de precis\u00e3o e revoca\u00e7\u00e3o.**","675cb20e":"Outra necessidade da biblioteca fasttext \u00e9 que a entrada do modelo esteja em um arquivo, por isso, criar novos dataframes e salvar em arquivos separados.","78cdc87c":"O resultado fica assim:","fcd3a69b":"# Importa\u00e7\u00e3o dos dados","912b8394":"# Pr\u00e9-processamento","9f8215bf":"![](http:\/\/)Para modelar utilizando a biblioteca fasttext a vari\u00e1vel resposta precisa estar no formato \\_\\_label\\_\\_(valor), exemplo: \\_\\_label\\_\\_positi[](http:\/\/)vo.","65302054":"Vamos remover acentua\u00e7\u00e3o e pontua\u00e7\u00e3o dos textos, al\u00e9m de colocar tudo em caixa baixa.","afd9f502":"Primeiramente vamos separar a base em treino e teste:","57b01dbb":"## Limpeza do texto"}}