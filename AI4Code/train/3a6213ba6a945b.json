{"cell_type":{"200b539a":"code","5d03df84":"code","42706b44":"code","1b60558b":"code","b6dbee82":"code","9e76804f":"code","f1d86796":"code","8a035256":"code","d2f5365e":"code","6d445fd0":"code","26f3da4d":"code","b30e4c2d":"code","1d8a4598":"code","779257f0":"code","026e20b3":"code","4ae5aae8":"code","cf448db9":"code","93537026":"code","b0a9a702":"code","3b81503b":"code","d3a100b1":"code","8480339e":"code","705538de":"code","35bad75b":"code","aafd9aaa":"code","c50e0a30":"code","42146b2c":"markdown","4c3998b3":"markdown","677013af":"markdown","9bdb81c3":"markdown","847de14d":"markdown"},"source":{"200b539a":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport os\nfrom time import time\n\nfrom sklearn.preprocessing import StandardScaler\n\nimport h2o\nfrom h2o.estimators.deeplearning import H2ODeepLearningEstimator","5d03df84":"os.listdir(\"..\/input\")","42706b44":"h2o.init()","1b60558b":"## Read the dataset - both train and test using H20","b6dbee82":"train = h2o.import_file(\"..\/input\/fashion-mnist_train.csv\", destination_frame=\"train\")\ntest = h2o.import_file(\"..\/input\/fashion-mnist_test.csv\", destination_frame=\"test\")","9e76804f":"train.shape","f1d86796":"test.shape","8a035256":"train.head(5)","d2f5365e":"tmp_df = train.as_data_frame()","6d445fd0":"tmp_df.label.unique()","26f3da4d":"tmp_r = tmp_df.values[5,1:]\ntmp_r.shape","b30e4c2d":"tmp_r = tmp_r.reshape(28,28)","1d8a4598":"tmp_r.shape","779257f0":"plt.imshow(tmp_r)\nplt.show()","026e20b3":"y_target = train.columns[0]\ny_target","4ae5aae8":"X_predictors = train.columns[1:785]","cf448db9":"train[\"label\"] = train[\"label\"].asfactor()","93537026":"train[\"label\"].levels()","b0a9a702":"model_h2o = H2ODeepLearningEstimator(\n                distribution=\"multinomial\",\n                activation=\"RectifierWithDropout\",\n                hidden=[50,50,50],\n                input_dropout_ratio=0.2,\n                standardize=True,\n                epochs=1000\n                )","3b81503b":"start = time()\nmodel_h2o.train(X_predictors, y_target, training_frame= train)\nend = time()\n(end-start)\/60","d3a100b1":"result = model_h2o.predict(test)","8480339e":"result.shape\nresult.as_data_frame().head(5)","705538de":"re = result.as_data_frame()","35bad75b":"re[\"predict\"]","aafd9aaa":"re[\"actual\"] = test[\"label\"].as_data_frame().values","c50e0a30":"out = (re[\"predict\"] == re[\"actual\"])\nnp.sum(out)\/out.size","42146b2c":"#### Separate out target and predictors from train data","4c3998b3":"## To check the data as image!!!\n\n### First convert into Pandas Dataframe\n#### Take any one row and first column till last column\n#### Reshape into 28x28 matrix\n#### use imshow to display the image","677013af":"# Deep Learning on Fashion MNIST Dataset\n\n## Import standard libraries\n\n## Import preprocessing libraries","9bdb81c3":"#### ******************** Data Modelling using H20 ***********************************\n\n#### This data is a balanced set and no need to use SMOTE","847de14d":"## H20 initiation"}}