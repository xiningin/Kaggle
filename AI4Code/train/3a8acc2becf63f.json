{"cell_type":{"6e232650":"code","8e3d68a9":"code","632b0486":"code","3fa9436f":"code","e166c5ca":"code","a545aba2":"code","fe4b8d13":"code","0fdcd732":"code","c7f541ec":"code","ce1e649b":"markdown","62735cc4":"markdown","d2d29a77":"markdown","b0c88438":"markdown","5dab596b":"markdown","60569818":"markdown","00a04c52":"markdown"},"source":{"6e232650":"##--------------------------\n# Import necessary libraries\n##--------------------------\nimport os\n\nimport pandas as pd\nfrom pandas_profiling import ProfileReport\n\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\nsns.set()\n\nimport numpy as np\n\nfrom PIL import Image\n\nimport warnings\nwarnings.filterwarnings('ignore')","8e3d68a9":"TRAIN_PATH = \"..\/input\/petfinder-pawpularity-score\/train\"\nTEST_PATH = \"..\/input\/petfinder-pawpularity-score\/test\"\n\ntrain_df = pd.read_csv(\"..\/input\/petfinder-pawpularity-score\/train.csv\")\ntest_df = pd.read_csv(\"..\/input\/petfinder-pawpularity-score\/test.csv\")\n\nTRAIN_NS = os.listdir(TRAIN_PATH) \nTEST_NS = os.listdir(TEST_PATH)\nTRAIN_PS = [os.path.join(TRAIN_PATH,f) for f in TRAIN_NS]\nTEST_PS = [os.path.join(TEST_PATH,f) for f in TEST_NS]\n\nHEIGHT, WIDTH = 224, 224\nCHANNELS = 3","632b0486":"##------------------------------\n# Display Random Training Images\n##------------------------------\n\nrand_ls = np.random.randint(9000, size=(9))\nfig,ax = plt.subplots(nrows=3,ncols=3,figsize=(18,10))\nfor count,i in enumerate(rand_ls):\n    r,c = count\/\/3, count%3\n    ax[r,c].imshow(np.asarray(Image.open(TRAIN_PS[i])))\n    ax[r,c].axis(\"off\")\n    label = train_df[train_df[\"Id\"] == TRAIN_NS[i].split(\".\")[0]][\"Pawpularity\"].values[0]\n    ax[r,c].set_title(f\"Pawpularity Score : {label}\",fontsize=15, fontfamily=\"monospace\", fontweight=\"bold\")","3fa9436f":"##--------------------------------\n# Height, Width of Training Images\n##--------------------------------\ntrain_h, train_w = [], []\n\nfor path in TRAIN_PS:\n    im = Image.open(path)\n    w,h = im.size\n    train_h.append(h)\n    train_w.append(w)\n    \nplt.figure(figsize=(10,10))\nsns.jointplot(x=train_w, y=train_h,kind=\"kde\")\nplt.xlabel(\"Width of Image\")\nplt.ylabel(\"Height of Image\")","e166c5ca":"##---------------------------\n# Metadata of Training images\n# Pandas Profiling\n##---------------------------\ntrain_df[\"Width\"] = train_w\ntrain_df[\"Height\"] = train_h\n\ntrain_report = ProfileReport(train_df,title=\"Metadata of Training images\")\n#train_report.to_file(\".\/train_metadata.html\")\ntrain_report","a545aba2":"tot_cols = list(train_df.columns)\nfeature_cols = tot_cols[1:13]\n\ntrain_ds = np.array(train_df[feature_cols])\ntest_ds = np.array(test_df[feature_cols])\n#train_y = np.array(train_df[\"Pawpularity\"])\n\nbin_ranges = [0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100]\nbin_names = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]\n\ntrain_df[\"label\"] = pd.cut(np.array(train_df[\"Pawpularity\"]),bins=bin_ranges,labels=bin_names)\n\npaw_values = []\nfor i in bin_names:\n    val = list(train_df[train_df[\"label\"] == i][\"Pawpularity\"])\n    paw_values.append(sum(val)\/len(val))\n\ntrain_y = np.array(train_df[\"label\"])","fe4b8d13":"%%capture\n!pip uninstall -y scikit-learn \n!pip install -q '..\/input\/sklearn24\/scikit_learn-0.24.0-cp37-cp37m-manylinux2010_x86_64.whl'\n\n!pip uninstall -y xgboost\n!pip install -q '..\/input\/xgboost13123py3nonemanylinux\/xgboost-1.3.2\/xgboost-1.3.3-py3-none-manylinux2010_x86_64.whl'\n\n!pip install flaml --no-index --find-links=file:\/\/\/kaggle\/input\/flamlmain\/FLAML-main\/","0fdcd732":"import flaml \nfrom flaml import AutoML\n\nautoml = AutoML()\nsettings = {\n    \"time_budget\": 360,  \n    \"metric\": 'accuracy',                  \n    \"task\": 'classification',  \n    \"log_file_name\": 'pawpularity.log',  \n    \"seed\": 2021,\n    \"estimator_list\" : [\"lgbm\", \"xgboost\", \"catboost\"]\n}\nautoml.fit(X_train=train_ds, y_train=train_y, **settings)","c7f541ec":"test_pred = automl.predict(test_ds)\ntest_pred = [paw_values[i] for i in test_pred]\ntest_ids = list(test_df[\"Id\"])\n\npred_df = pd.DataFrame.from_dict({\n    \"Id\" : test_ids,\n    \"Pawpularity\" : test_pred\n})\npred_df.to_csv(\".\/submission.csv\",index=False)\nos.remove(\".\/pawpularity.log\")\npred_df.head()","ce1e649b":"<center style = \"background: rgb(238,174,202);\nbackground: radial-gradient(circle, rgba(238,174,202,1) 0%, rgba(81,154,204,1) 0%);\"><h1 style = \"font-family:'Bodoni MT'\">Inference\u2714\ufe0f<\/h1><\/center>","62735cc4":"<center style = \"background: rgb(238,174,202);\nbackground: radial-gradient(circle, rgba(238,174,202,1) 0%, rgba(81,154,204,1) 0%);\"><h1 style = \"font-family:'Bodoni MT'\">Data Visualization\ud83d\udcca<\/h1><\/center>","d2d29a77":"<center style = \"background: rgb(238,174,202);\nbackground: radial-gradient(circle, rgba(238,174,202,1) 0%, rgba(81,154,204,1) 0%);\"><h1 style = \"font-family:'Bodoni MT'\">Initializations\ud83c\udfac<\/h1><\/center>","b0c88438":"<center style = \"background: rgb(238,174,202);\nbackground: radial-gradient(circle, rgba(238,174,202,1) 0%, rgba(81,154,204,1) 0%);\"><h1 style = \"font-family:'Bodoni MT'\">Training\ud83d\udca1<\/h1><\/center>","5dab596b":"<center style = \"background: rgb(238,174,202);\nbackground: radial-gradient(circle, rgba(238,174,202,1) 0%, rgba(81,154,204,1) 0%);\"><h1 style = \"font-family:'Bodoni MT'\">Data Preprocessing\ud83e\uddf0<\/h1><\/center>","60569818":"<center style = \"font-family: 'Lucida Console', 'Courier New', monospace;\">\n    <img src = \"https:\/\/www.bargainmarket.com.au\/images\/banner-pets-dog-cat-boarding.png\" width=600 height = 400>\n    <h1 style=\"background: url('https:\/\/thumbs.dreamstime.com\/b\/abstract-light-brown-blur-lights-background-design-162886080.jpg')\">PetFinder.my - Pawpularity Contest \ud83d\udc36\ud83d\udc31<\/h1>\n<\/center>\n\n<br>\n<h2 style = \"font-family: Consolas\">What is PetFinder.my\u2753<\/h2>\n<p style = \"font-family : Lucida Sans Typewriter\">\n<a href = \"https:\/\/petfinder.my\/\">PetFinder.my<\/a> is Malaysia\u2019s leading animal welfare platform, featuring over 180,000 animals with 54,000 happily adopted. PetFinder collaborates closely with animal lovers, media, corporations, and global organizations to improve animal welfare.\n<\/p>\n\n<br>\n<h2 style = \"font-family: Consolas\">What should we do\ud83d\udcdd<\/h2>\n<p style = \"font-family : Lucida Sans Typewriter\">\nIn this competition, you\u2019ll analyze raw images and metadata to predict the \u201cPawpularity\u201d of pet photos. You'll train and test your model on PetFinder.my's thousands of pet profiles.<\/p>\n\n<br>\n<h2 style = \"font-family: Consolas\">Data Information\ud83d\udcbd<\/h2>\n<p style = \"font-family : Lucida Sans Typewriter\">Check <a href = \"https:\/\/www.kaggle.com\/c\/petfinder-pawpularity-score\/data\">competition page<\/a> for details<\/p>\n\n<h2 style = \"font-family : Comic Sans MS\">Let's dive in \u2b07\ufe0f<\/h2>","00a04c52":"<center style = \"background: rgb(238,174,202);\nbackground: radial-gradient(circle, rgba(238,174,202,1) 0%, rgba(81,154,204,1) 0%);\"><h1 style = \"font-family:'Bodoni MT'\">Libraries\ud83d\udcda<\/h1><\/center>"}}