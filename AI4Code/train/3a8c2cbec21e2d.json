{"cell_type":{"e52d6d96":"code","d1f7b1ff":"code","2bdbee60":"code","22846168":"code","d8f623f8":"code","8b5b43fa":"code","ebebf8b2":"code","f55881e4":"code","75c4b20c":"code","d92b0043":"code","cc6b36c7":"code","3b3daf57":"code","49abfaa6":"code","b7d8d3dc":"code","8587bf79":"code","edb1e663":"code","4e39cedd":"code","0d8d0a20":"code","4e4dde84":"code","a3e611c6":"code","da0b2ee8":"code","c7e53266":"code","f3c9b1dd":"markdown","40e3b789":"markdown"},"source":{"e52d6d96":"import numpy as np \nimport pandas as pd \nfrom keras import optimizers\nfrom keras import models\nfrom keras import layers\nfrom keras import losses\nfrom keras.utils import to_categorical\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n","d1f7b1ff":"train_data = pd.read_csv(\"\/kaggle\/input\/digit-recognizer\/train.csv\")","2bdbee60":"train_data.head(2)","22846168":"test_data = pd.read_csv('\/kaggle\/input\/digit-recognizer\/test.csv')","d8f623f8":"test_data.head(2)","8b5b43fa":"train_label = train_data['label']","ebebf8b2":"train_data = train_data.drop('label',axis=1)","f55881e4":"train_data \/= 255\ntest_data \/= 255","75c4b20c":"train_label_to_cat= to_categorical(train_label)\ntrain_label_to_cat.shape","d92b0043":"train_data.shape","cc6b36c7":"train_data = train_data.values.reshape(-1,28,28,1)\n","3b3daf57":"test_data = test_data.values.reshape(-1,28,28,1)","49abfaa6":"train_data.shape","b7d8d3dc":"model = models.Sequential()\nmodel.add(layers.Conv2D(32,(3,3),activation='relu',input_shape=(28,28,1)))\nmodel.add(layers.MaxPooling2D((2,2)))\nmodel.add(layers.Conv2D(64,(3,3),activation='relu'))\nmodel.add(layers.MaxPooling2D((2,2)))\nmodel.add(layers.Conv2D(128,(3,3),activation='relu'))\nmodel.add(layers.MaxPool2D((2,2)))","8587bf79":"model.summary()","edb1e663":"model.add(layers.Flatten())\nmodel.add(layers.Dense(1024,activation='relu'))\nmodel.add(layers.Dense(512,activation='relu'))\nmodel.add(layers.Dense(10,activation='softmax'))","4e39cedd":"model.summary()","0d8d0a20":"model.compile(optimizer=optimizers.RMSprop(lr=0.001),\n             loss= losses.categorical_crossentropy,\n             metrics=['accuracy'])","4e4dde84":"model.fit(train_data,train_label_to_cat,epochs=60)","a3e611c6":"predict = model.predict_classes(test_data)","da0b2ee8":"test_data_DF = pd.read_csv('\/kaggle\/input\/digit-recognizer\/test.csv')","c7e53266":"output = pd.DataFrame({'ImageId': test_data_DF.index+1,\n                       'Label': predict})\noutput.to_csv('submission.csv', index=False)","f3c9b1dd":"our data is flatten and if we want to use convolutional nn we must give the network as a pixel","40e3b789":"now let's build our model"}}