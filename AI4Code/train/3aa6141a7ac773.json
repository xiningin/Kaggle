{"cell_type":{"590538d2":"code","c0b44217":"code","ec1719f8":"code","6740923c":"code","3921089e":"code","f4074c65":"code","3c8acd31":"code","1d5dd331":"code","393ead56":"code","dc8b827b":"code","fa3ea244":"markdown","17dd77c0":"markdown","c9ee5ba1":"markdown","fc628f68":"markdown","6fc6e0ed":"markdown","e4457fab":"markdown","89a82945":"markdown","1001bd20":"markdown","13e1deaf":"markdown"},"source":{"590538d2":"!pip install tabulate -q\n!pip install openpyxl -q","c0b44217":"# Import Modules\nimport numpy as np\nimport pandas as pd\nimport plotly.express as px\nimport plotly.graph_objects as go\npd.set_option('precision', 7)\nfrom tabulate import tabulate","ec1719f8":"# Load Data\nxl = '..\/input\/india-sugar-semiannual-report\/India.xlsx'\n\ndf_cs = pd.read_excel(open(xl, 'rb'), sheet_name='tab1', header=0, index_col = 'Year')    # Commodity, Centrifugal Sugar, Monthly Price Table (INR\/MT)\ndf_gr = pd.read_excel(open(xl, 'rb'), sheet_name='tab2', header=0, index_col = 'Year')    # Commodity, Gur(Jaggery), Monthly Price Table (INR\/MT)\ndf_ms = pd.read_excel(open(xl, 'rb'), sheet_name='tab3', header=0, index_col = 'State')    # Milled Sugar Production by State, MMT, crystal weight basis","6740923c":"table = []\nheaders = ['Year','MaxValue','MinValue','Avg']\n\nfor y in df_cs.columns:\n  max_val = df_cs[y].max()\n  max_mnth = df_cs.index[df_cs[y] == max_val][0]\n\n  min_val = df_cs[y].min()\n  min_mnth = df_cs.index[df_cs[y] == min_val][0]\n\n  avg = df_cs[y].mean()\n  stat = [str(y), str(max_val)+' { '+max_mnth+' }', str(min_val)+' { '+min_mnth+' }', str(avg) ]\n  table.append(stat)\n\n\nprint(tabulate(table, headers=headers, tablefmt='grid'))","3921089e":"table = []\nheaders = ['Year','MaxValue','MinValue','Avg']\n\nfor y in df_gr.columns:\n  max_val = df_gr[y].max()\n  max_mnth = df_gr.index[df_gr[y] == max_val][0]\n\n  min_val = df_gr[y].min()\n  min_mnth = df_gr.index[df_gr[y] == min_val][0]\n\n  avg = df_gr[y].mean()\n  stat = [str(y), str(max_val)+' { '+max_mnth+' }', str(min_val)+' { '+min_mnth+' }', str(avg) ]\n  table.append(stat)\n\n\nprint(tabulate(table, headers=headers, tablefmt='grid'))","f4074c65":"table = []\nheaders = ['Year','MaxValue','MinValue','Avg']\n\nfor y in df_ms.columns:\n  max_val = df_ms[y].max()\n  max_st = df_ms.index[df_ms[y] == max_val][0]\n\n  min_val = df_ms[y].min()\n  min_st = df_ms.index[df_ms[y] == min_val][0]\n\n  avg = df_ms[y].mean()\n  stat = [str(y), str(max_val)+' { '+max_st+' }', str(min_val)+' { '+min_st+' }', str(avg) ]\n  table.append(stat)\n\n\nprint(tabulate(table, headers=headers, tablefmt='grid'))","3c8acd31":"fig = go.Figure()\nhex_colors = ['#EFF0D1','#77BA99','#262730']\n\nfor yr,col in zip(df_ms.columns,hex_colors):\n  fig.add_trace(go.Bar(x=df_ms.index, \n                       y=df_ms[yr], \n                       name=yr,\n                       marker_color= col\n                       ))\n\nfig.update_layout(barmode='stack', \n                  xaxis={'categoryorder':'category ascending'},\n                  title='Milled Sugar Production by State, MMT, crystal weight basis',\n                  title_x=0.5,\n                  titlefont_size=24\n                  )\nfig.show()","1d5dd331":"year = 2019\nfig = go.Figure()\n\nfig.add_trace(go.Bar(\n    x=df_cs.index,\n    y=df_cs[year],\n    name='Centrifugal Sugar',\n    marker_color='#D2BBA0'\n))\n\nfig.add_trace(go.Bar(\n    x=df_gr.index,\n    y=df_gr[year],\n    name='Gur\/Jaggery',\n    marker_color='#F2EFC7',\n))\n\nfig.update_traces(texttemplate='%{y:.2s}', textposition='outside')\nfig.update_layout(barmode='group', \n                  xaxis_tickangle=-45, \n                  title= str(year)+' Monthly Price Table (INR\/MT) - Centrifugal Sugar vs Gur\/Jaggery',\n                  title_x=0.5,\n                  titlefont_size=24\n                  )\nfig.show()","393ead56":"year = 2020\nfig = go.Figure()\n\nfig.add_trace(go.Bar(\n    x=df_cs.index,\n    y=df_cs[year],\n    name='Centrifugal Sugar',\n    marker_color='#1F5673'\n))\n\nfig.add_trace(go.Bar(\n    x=df_gr.index,\n    y=df_gr[year],\n    name='Gur\/Jaggery',\n    marker_color='#759FBC',\n))\n\nfig.update_traces(texttemplate='%{y:.2s}', textposition='outside')\nfig.update_layout(barmode='group', \n                  xaxis_tickangle=-45, \n                  title= str(year)+' Monthly Price Table (INR\/MT) - Centrifugal Sugar vs Gur\/Jaggery',\n                  title_x=0.5,\n                  titlefont_size=24\n                  )\nfig.show()","dc8b827b":"year = 2021\nfig = go.Figure()\n\nfig.add_trace(go.Bar(\n    x=df_cs.index,\n    y=df_cs[year],\n    name='Centrifugal Sugar',\n    marker_color='#87D68D'\n))\n\nfig.add_trace(go.Bar(\n    x=df_gr.index,\n    y=df_gr[year],\n    name='Gur\/Jaggery',\n    marker_color='#93B48B',\n))\n\nfig.update_traces(texttemplate='%{y:.2s}', textposition='outside')\nfig.update_layout(barmode='group', \n                  xaxis_tickangle=-45, \n                  title= str(year)+' Monthly Price Table (INR\/MT) - Centrifugal Sugar vs Gur\/Jaggery',\n                  title_x=0.5,\n                  titlefont_size=24\n                  )\nfig.show()","fa3ea244":"### Commodity, Centrifugal Sugar, Monthly Price Table (INR\/MT)","17dd77c0":"# India: Sugar Semi-annual Report - Starter Book","c9ee5ba1":"### Hope this starter book was helpful !","fc628f68":"**Year = 2020**","6fc6e0ed":"**Year = 2019**","e4457fab":"### Centrifugal Sugar, Monthly Price Table (INR\/MT) -v\/s- Gur(Jaggery), Monthly Price Table (INR\/MT)","89a82945":"**Year = 2021**","1001bd20":"### Commodity, Gur(Jaggery), Monthly Price Table (INR\/MT)","13e1deaf":"### Milled Sugar Production by State, MMT, crystal weight basis"}}