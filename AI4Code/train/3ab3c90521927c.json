{"cell_type":{"23519887":"code","d830ad6f":"code","d37512e2":"code","e22dbecb":"code","4bf8a12a":"code","757ebfe2":"code","58f3a9e1":"code","cc7199be":"code","8da81d6a":"code","4bfb3ea6":"code","eb5445bf":"code","b412a1b3":"code","77e52341":"code","be52373e":"code","14065cd5":"code","98df2371":"code","02181a18":"code","84e313c2":"code","62c6c111":"code","6808e1b3":"code","72d87bb2":"code","0cce221a":"code","6160098c":"code","1e6ba4f8":"markdown","102f4956":"markdown"},"source":{"23519887":"# IRO TFA CCFE\n# Import, Resize, Object, Trainable layer, Folders,Augmentation, Create model, Compile, Fit, Evaluate\n\nIMAGE_SIZE =[224, 224]\n\nvgg16 = VGG16(input_shape = IMAGE_SIZE + [3], weights='imagenet' , include_top = False)","d830ad6f":"for layers in vgg16.layers:\n    layers.trainable = False","d37512e2":"folders = glob('..\/input\/cotton-disease-dataset\/Cotton Disease\/train\/*')\n","e22dbecb":"folders","4bf8a12a":"from tensorflow.keras.preprocessing.image import ImageDataGenerator\n\ntrain_datagen = ImageDataGenerator(rescale = 1.\/255,\n                                   shear_range = 0.2,\n                                   zoom_range = 0.2,\n                                   horizontal_flip = True)\n\ntest_datagen = ImageDataGenerator(rescale = 1.\/255)","757ebfe2":"x = Flatten()(vgg16.output)","58f3a9e1":"x","cc7199be":"prediction = Dense(len(folders), activation='softmax')(x)","8da81d6a":"# Time for CCFE\n\nmodel = Model(inputs=vgg16.input, outputs=prediction)","4bfb3ea6":"model.summary()","eb5445bf":"model.compile(\n  loss='categorical_crossentropy',\n  optimizer='adam',\n  metrics=['accuracy']\n)","b412a1b3":"training_set = train_datagen.flow_from_directory('..\/input\/cotton-disease-dataset\/Cotton Disease\/train',\n                                                 target_size = (224, 224),\n                                                 batch_size = 32,\n                                                 class_mode = 'categorical')","77e52341":"test_set = train_datagen.flow_from_directory('..\/input\/cotton-disease-dataset\/Cotton Disease\/test',\n                                                 target_size = (224, 224),\n                                                 batch_size = 32,\n                                                 class_mode = 'categorical')","be52373e":"hist = model.fit_generator(\n  training_set,\n  validation_data=test_set,\n  epochs=10,\n  steps_per_epoch=len(training_set),\n  validation_steps=len(test_set)\n)","14065cd5":"import matplotlib.pyplot as plt\n\n# plot the loss\nplt.plot(hist.history['loss'], label='train loss')\nplt.plot(hist.history['val_loss'], label='val loss')\nplt.legend()\nplt.show()\nplt.savefig('LossVal_loss')\n\n# plot the accuracy\nplt.plot(hist.history['accuracy'], label='train acc')\nplt.plot(hist.history['val_accuracy'], label='val acc')\nplt.legend()\nplt.show()\nplt.savefig('AccVal_acc')","98df2371":"from tensorflow.keras.models import load_model\n\nmodel.save('model_vgg16.h5')","02181a18":"# Function to display images\ndef plotImages(images_arr):\n    fig, axes = plt.subplots(1, 5, figsize=(20, 20))\n    axes = axes.flatten()\n    for img, ax in zip(images_arr, axes):\n        ax.imshow(img)\n    plt.tight_layout()\n    plt.show()\n    \nimages = [training_set[0][0][0] for i in range(5)]\nplotImages(images)","84e313c2":"y_pred = model.predict(test_set)\ny_pred","62c6c111":"img=image.load_img('..\/input\/cotton-disease-dataset\/Cotton Disease\/test\/diseased cotton plant\/dd (862)_iaip.jpg',target_size=(224,224))\nx=image.img_to_array(img)\nx","6808e1b3":"x.shape","72d87bb2":"x = x\/255\nimport numpy as np\nx=np.expand_dims(x,axis=0)\nimg_data=preprocess_input(x)\nimg_data.shape","0cce221a":"model.predict(img_data)","6160098c":"a=np.argmax(model.predict(img_data), axis=1)\na","1e6ba4f8":"# Everything after this is for testing purposes","102f4956":"###### from tensorflow.keras.layers import Input, Lambda, Dense, Flatten\nfrom tensorflow.keras.models import Model\nfrom tensorflow.keras.applications.vgg16 import VGG16\nfrom tensorflow.keras.applications.vgg19 import VGG19\nfrom tensorflow.keras.applications.vgg16 import preprocess_input\nfrom tensorflow.keras.preprocessing import image\nfrom tensorflow.keras.preprocessing.image import ImageDataGenerator,load_img\nfrom tensorflow.keras.models import Sequential\nimport numpy as np\nfrom glob import glob\n#import matplotlib.pyplot as plt"}}