{"cell_type":{"3ad7b8cd":"code","4daba1bd":"code","a6f308ac":"code","836c1e10":"code","05fb8e97":"code","c05e7399":"code","72a11b19":"code","09447a0e":"code","4a44bee9":"code","3b974d2b":"code","718de542":"code","98ac7da4":"code","7e481d89":"code","f8794a52":"code","f113b31a":"code","db3f9641":"code","03598c67":"code","dab0f7c3":"code","b1bf3aef":"code","8cd2644e":"markdown","b7c76846":"markdown","a98bd33f":"markdown","658303aa":"markdown","08ee1f84":"markdown"},"source":{"3ad7b8cd":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","4daba1bd":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport warnings\nwarnings.filterwarnings('ignore')\n\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.tree import DecisionTreeClassifier\n\nfrom sklearn.externals.six import StringIO\nfrom IPython.display import Image\nfrom sklearn.tree import export_graphviz\nfrom scipy.cluster.hierarchy import linkage, dendrogram","a6f308ac":"df = pd.read_csv('\/kaggle\/input\/students-performance-in-exams\/StudentsPerformance.csv')\ndf.columns = ['Gender', 'Race', 'EducationLevel', 'Lunch', 'PreparationCourse',\n              'MathScore', 'ReadingScore', 'WritingScore']\ndf['AvgScore'] = round((df.MathScore + df.ReadingScore + df.WritingScore) \/ 3, 2)\ndf.head()","836c1e10":"df.isnull().sum()","05fb8e97":"df.describe().T","c05e7399":"df.describe(include = 'O').T","72a11b19":"df['EducationLevel'] = pd.Categorical(df.EducationLevel,\n                                      categories = [\"some high school\", \"high school\", \"associate's degree\", \\\n                                                    \"some college\", \"bachelor's degree\", \"master's degree\"],\n                                      ordered = True)\n\nprint('Lunch Options\\n ', df.Lunch.unique())\nprint('Preparation Courses\\n', df.PreparationCourse.unique())\nprint('Races\/Ethinicities\\n', df.Race.unique())\nprint('Education Levels\\n', df.EducationLevel.unique())","09447a0e":"feature_list = ['Gender', 'Lunch', 'PreparationCourse', 'Race',  'EducationLevel']\n\nfor i in feature_list:\n    grouped = df[[i, 'MathScore', 'WritingScore', \\\n                'ReadingScore', 'AvgScore']].groupby(i).mean().sort_values(\n                by = 'AvgScore', ascending = False).round(2).reset_index()\n    print('---- {} Average Score Summary ----'.format(i))\n    display(grouped)","4a44bee9":"plt.style.use('seaborn')\nfig, axes = plt.subplots(2, 3, figsize = (15, 8))\n\nfor ax, feature in zip(axes.flatten(), feature_list):\n    sns.countplot(df[feature], ax = ax, palette = 'Blues')\n    ax.set_xlabel('')\n    ax.tick_params(labelrotation = 30)\n    ax.set_title('Size on {}'.format(feature))\n\nplt.tight_layout()\nplt.show()","3b974d2b":"#general overview on the dataset\nsns.pairplot(df)\nplt.show()","718de542":"# Scores & Education Level seperated by Sex\ndf_sex = df[['MathScore', 'WritingScore', 'ReadingScore', 'EducationLevel', 'Gender']].groupby(\n            ['EducationLevel', 'Gender']).mean().reset_index()\n\nfig, axes = plt.subplots(1, 2, figsize = (15, 4), sharex = 'all', sharey = 'all')\ndf_sex[df_sex.Gender == 'female'].plot(kind = 'bar', x = 'EducationLevel', stacked = True, ax = axes[0])\naxes[0].set_title('Female Total Score by Education Level')\naxes[0].tick_params(labelrotation = 30)\naxes[0].set_xlabel('')\naxes[0].set_ylim(0, 300)\n\ndf_sex[df_sex.Gender == 'male'].plot(kind = 'bar', x = 'EducationLevel', stacked = True, ax = axes[1])\naxes[1].set_title('Male Total Score by Education Level')\naxes[1].tick_params(labelrotation = 30)\naxes[1].set_xlabel('')\nplt.tight_layout()\nplt.show()","98ac7da4":"# Scores & Test Preparation Course seperated by sex\nscores = ['AvgScore', 'MathScore', 'ReadingScore', 'WritingScore']\n\nfig, axes = plt.subplots(1, 4, figsize = (15, 3))\nfor ax, score in zip(axes.flatten(), scores):\n    sns.barplot('PreparationCourse', score, data = df, hue = 'Gender', ax = ax)\n    ax.set_ylim(0, 90)\n    ax.set_xlabel('')\n    ax.set_title('{} for Test Preparation Course'.format(score))\n    ax.legend(loc = 2)\n\nplt.tight_layout()\nplt.show() ","7e481d89":"# Scores & Lunch Options seperated by Sex\nfig, axes = plt.subplots(1, 4, figsize = (15, 4))\nfor ax, score in zip(axes.flatten(), scores):\n    sns.boxenplot('Lunch', score, data = df, hue = 'Gender', ax = ax)\n    ax.set_ylim(0, 110)\n    ax.set_xlabel('')\n    ax.set_title('{} for Lunch Options'.format(score))\n    ax.legend(loc = 3)\n\nplt.tight_layout()\nplt.show() ","f8794a52":"# Scores & Race seperated by Sex\nfig, axes = plt.subplots(2, 2, figsize = (15, 7))\nfor ax, score in zip(axes.flatten(), scores):\n    sns.boxplot('Race', score, data = df, hue = 'Gender', ax = ax)\n    ax.set_ylim(0, 110)\n    ax.set_xlabel('')\n    ax.set_title('{} for Race\/Ethinicity'.format(score))\n    ax.legend(loc = 4)\n\nplt.tight_layout()\nplt.show() ","f113b31a":"# Scores & Education Level seperated by Sex\nfig, axes = plt.subplots(2, 2, figsize = (15, 8))\nfor ax, score in zip(axes.flatten(), scores):\n    sns.violinplot('EducationLevel', score, data = df, hue = 'Gender', ax = ax)\n    ax.set_xlabel('')\n    ax.set_title('{} for Education Level'.format(score))\n    ax.legend(loc = 4)\n\nplt.tight_layout()\nplt.show()","db3f9641":"# getting AvgScore intervals\ndf['AvgScore_int'] = pd.cut(df.AvgScore, bins = pd.interval_range(0, 100, 10))\nfeature_list.append('AvgScore_int')\n\n# setting up LabelEncoder\ncoded_list = []\nle = LabelEncoder()\n\n# encoding all variables\nfor col in feature_list:\n    df['{}_le'.format(col)] = le.fit_transform(df['{}'.format(col)])\n    coded_list.append('{}_le'.format(col))\n\nprint('Encoded Feature List\\n', coded_list)\ndisplay(df[coded_list].head())","03598c67":"# setting up model & hyperparameters for GridSearch - get the best score\nX = df[coded_list].drop('AvgScore_int_le', axis = 1)\ny = df['AvgScore_int_le']\n\nhp_params = {'max_depth': range(3, 6, 1),\n             'n_estimators': range(150, 350, 50),\n             'criterion': ['gini', 'entropy']}\n\nrf_sg = GridSearchCV(estimator = RandomForestClassifier(oob_score = True, random_state = 0), \n                     param_grid = hp_params, cv = 5)\nrf_sg.fit(X, y)\n\nprint('Best Params: {}'.format(rf_sg.best_params_))","dab0f7c3":"# selecting the best params to find the feature importance\nrf_sg.best_estimator_.fit(X, y)\ndf_features = pd.DataFrame({'Feature': X.columns.values,\n                           'Importance': rf_sg.best_estimator_.feature_importances_})\n\nplt.figure(figsize = (10, 3))\nsns.barplot(x = 'Importance', y = 'Feature', \n            data = df_features.sort_values('Importance', ascending = False), palette = 'Blues_d')\nplt.show()","b1bf3aef":"# randomly selecting one of the forest to visualize\nestimator = rf_sg.best_estimator_.estimators_[np.random.randint(0, rf_sg.best_estimator_.n_estimators + 1)]\n\ndot_data = StringIO()\nexport_graphviz(estimator, out_file = dot_data, filled = True, rounded = True, special_characters = True,\n                feature_names = list(X.columns), class_names = [str(i) for i in set(y)])\ngraph = pydotplus.graph_from_dot_data(dot_data.getvalue())  \nImage(graph.create_png())","8cd2644e":"#### Categorical Variables Detailed Visualization","b7c76846":"### Exploratory Data Analysis","a98bd33f":"### Machine Learning\n#### Data Preprocessing","658303aa":"### Data Importing & Inspecting","08ee1f84":"### Data Visualization\n#### Categorical Variables Size Visualization"}}