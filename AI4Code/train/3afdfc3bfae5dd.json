{"cell_type":{"1ef24fbd":"code","d96de5f6":"code","572a30d7":"code","7bcea9ea":"code","311b87d1":"code","007196af":"code","f6b353b6":"markdown"},"source":{"1ef24fbd":"import gensim\nfrom gensim.models import Word2Vec \nfrom gensim.models import KeyedVectors\nimport pandas as pd\nfrom nltk.tokenize import RegexpTokenizer\n\nforum_posts = pd.read_csv(\"..\/input\/meta-kaggle\/ForumMessages.csv\")","d96de5f6":"# take first 100 forum posts\nsentences = forum_posts.Message.astype('str').tolist()\n\n# toeknize\ntokenizer = RegexpTokenizer(r'\\w+')\nsentences_tokenized = [w.lower() for w in sentences]\nsentences_tokenized = [tokenizer.tokenize(i) for i in sentences_tokenized]","572a30d7":"model = KeyedVectors.load_word2vec_format(\"..\/input\/word2vec-google\/GoogleNews-vectors-negative300.bin\",\n                                         binary = True)","7bcea9ea":"model_2 = Word2Vec(size=300, min_count=1)\nmodel_2.build_vocab(sentences_tokenized)\ntotal_examples = model_2.corpus_count\nmodel_2.build_vocab([list(model.vocab.keys())], update=True)\nmodel_2.intersect_word2vec_format(\"..\/input\/word2vec-google\/GoogleNews-vectors-negative300.bin\", binary=True)\nmodel_2.train(sentences_tokenized, total_examples=total_examples, epochs=model_2.iter)","311b87d1":"# original model does not have Kaggle in it\nmodel.similarity('kaggle','google')","007196af":"# tuned model does, and it's pretty close to Google! :3\nmodel_2.similarity('kaggle','google')","f6b353b6":"Todo: figure out how to update the loaded word vectors\n\nSO question w\/ more info https:\/\/datascience.stackexchange.com\/questions\/10695\/how-to-initialize-a-new-word2vec-model-with-pre-trained-model-weights"}}