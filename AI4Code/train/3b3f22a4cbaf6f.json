{"cell_type":{"1089b304":"code","78b93ec8":"code","22267354":"code","3b575534":"code","028d7768":"code","59acf066":"code","eb3adde1":"code","99f382d4":"code","6aeafb88":"code","819e76c5":"code","2478bdfb":"code","21434041":"code","cebce21b":"code","fdcb932d":"code","7d43ea6f":"code","904f13ae":"code","fc1e115c":"code","e396b0a2":"code","f78ef7ea":"code","24aa9a75":"code","1aeba78c":"code","e4dd8976":"code","f67542fa":"code","3e233b71":"code","e56fd961":"code","f774f161":"code","9cd7cca9":"code","a5bc72cc":"code","09748a93":"markdown","affe941f":"markdown","e3be34d9":"markdown","f7f14089":"markdown","009c2e10":"markdown","519261fa":"markdown","f8915cf3":"markdown","92e66ea3":"markdown","f3929b79":"markdown","a31f91f3":"markdown","60a2254b":"markdown","545c73e7":"markdown","286fef26":"markdown","8f717d5d":"markdown","e3d8219e":"markdown","8adccb30":"markdown","04c5e9a4":"markdown","69a55010":"markdown","23d731b2":"markdown"},"source":{"1089b304":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","78b93ec8":"# reading datasets using pandas\ndata_train = pd.read_csv('..\/input\/titanic\/train.csv')\ndata_test = pd.read_csv('..\/input\/titanic\/test.csv')\ndata_train.head()","22267354":"data_train.info()","3b575534":"sns.set_style('darkgrid')\nax = sns.countplot(data_train['Survived'])\nfor p in ax.patches:\n        ax.annotate('{} ({:.1f}%)'.format(p.get_height(), 100* p.get_height()\/len(data_train['Survived'])), \n                    (p.get_x()+0.2, p.get_height()-30))","028d7768":"plt.figure(figsize=(12,6))\n\nplt.subplot(121)\nax = sns.countplot(data = data_train, x='Sex')\nfor p in ax.patches:\n        ax.annotate('{} ({:.1f}%)'.format(p.get_height(), 100* p.get_height()\/len(data_train['Sex'])), \n                    (p.get_x()+0.2, p.get_height()-30))\n\nplt.subplot(122)\nax = sns.countplot(data = data_train, x='Survived', hue='Sex')\nfor p in ax.patches:\n        ax.annotate('{} ({:.1f}%)'.format(p.get_height(), 100* p.get_height()\/len(data_train['Survived'])), \n                    (p.get_x()+0.01, p.get_height()-30))\n        \nplt.tight_layout()","59acf066":"plt.figure(figsize=(10,6))\nax = sns.countplot(data = data_train, x='Survived', hue='Pclass')\nfor p in ax.patches:\n        ax.annotate('{} ({:.1f}%)'.format(p.get_height(), 100* p.get_height()\/len(data_train['Survived'])), \n                    (p.get_x()+0.03, p.get_height()-30))","eb3adde1":"plt.figure(figsize=(10,6))\nax = sns.countplot(data = data_train, x='Survived', hue='Embarked')\nfor p in ax.patches:\n        ax.annotate('{} ({:.1f}%)'.format(p.get_height(), 100* p.get_height()\/len(data_train['Survived'])), \n                    (p.get_x()+0.03, p.get_height()-25))","99f382d4":"plt.figure(figsize=(10,6))\nax = sns.countplot(data = data_train, x='Sex', hue='Pclass')\nfor p in ax.patches:\n        ax.annotate('{} ({:.1f}%)'.format(p.get_height(), 100* p.get_height()\/len(data_train['Survived'])), \n                    (p.get_x()+0.03, p.get_height()-30))","6aeafb88":"plt.figure(figsize=(12,6))\nax = sns.countplot(data = data_train, x='Embarked', hue='Pclass')\nfor p in ax.patches:\n        ax.annotate('{} ({:.1f}%)'.format(p.get_height(), 100* p.get_height()\/len(data_train['Survived'])), \n                    (p.get_x()+0.01, p.get_height()+5))","819e76c5":"data_train.drop(['PassengerId', 'Survived', 'Pclass'], axis=1).describe()","2478bdfb":"sns.distplot(data_train['Age'].dropna(), kde=False)","21434041":"plt.figure(figsize=(10,6))\nplt.subplot(121)\nsns.countplot(data=data_train, x='SibSp')\nplt.subplot(122)\nsns.countplot(data=data_train, x='Parch')\nplt.tight_layout()","cebce21b":"sns.distplot(data_train['Fare'])","fdcb932d":"data_train.isnull().sum()","7d43ea6f":"figure = plt.figure(figsize=(10,6))\nsns.boxplot(data=data_train, x='Pclass', y='Age')","904f13ae":"first_mean = round(data_train[data_train['Pclass'] == 1]['Age'].dropna().mean())\nsecond_mean = round(data_train[data_train['Pclass'] == 2]['Age'].dropna().mean())\nthird_mean = round(data_train[data_train['Pclass'] == 3]['Age'].dropna().mean())\n\n# creating function to fill missing age\ndef filling(col):\n    Age = col[0]\n    Pclass = col[1]\n    if pd.isnull(Age):\n        if Pclass == 1:\n            return first_mean\n        elif Pclass == 2:\n            return second_mean\n        else:\n            return third_mean\n    else:\n        return Age\n\ndata_train['Age'] = data_train[['Age', 'Pclass']].apply(filling, axis=1)","fc1e115c":"data_train['Embarked'].mode()","e396b0a2":"data_train['Embarked'].fillna('S', inplace=True)\ndata_train.isnull().sum()","f78ef7ea":"sex = pd.get_dummies(data_train['Sex'],drop_first=True)\nembarked = pd.get_dummies(data_train['Embarked'],drop_first=True)","24aa9a75":"X = pd.concat([data_train[['Pclass', 'Age', 'SibSp', 'Parch', 'Fare']], sex, embarked], axis=1) #creating our features\ny= data_train['Survived'] #chosing our target\nprint(X.head())\nprint(y.head())","1aeba78c":"data_test.head()","e4dd8976":"data_test.info()","f67542fa":"data_test.isnull().sum()","3e233b71":"data_test.drop(['PassengerId', 'Pclass'], axis=1).describe()","e56fd961":"data_test['Fare'].fillna('35.62', inplace=True)\ndata_test['Age'] = data_test[['Age', 'Pclass']].apply(filling, axis=1)\nsex = pd.get_dummies(data_test['Sex'],drop_first=True)\nembarked = pd.get_dummies(data_test['Embarked'],drop_first=True)\nX_validation = pd.concat([data_test[['Pclass', 'Age', 'SibSp', 'Parch', 'Fare']], sex, embarked], axis=1)\nX_validation.head()","f774f161":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=46)\n\nfrom sklearn.ensemble import RandomForestClassifier \nmodel = RandomForestClassifier(n_estimators=10)\nmodel.fit(X_train, y_train)\nmodel.score(X_test, y_test)","9cd7cca9":"from sklearn.metrics import classification_report, confusion_matrix\n\ny_predict = model.predict(X_test)\nprint(classification_report(y_test, y_predict))\nprint(confusion_matrix(y_test, y_predict))","a5bc72cc":"predictions = model.predict(X_validation)\ndata_test['Survived'] = predictions\nsubmit = data_test[['PassengerId', 'Survived']]\nsubmit.to_csv('submission.csv', index=False)","09748a93":"Now to deal with categorical data (sex and embarked), I use dummy variable.","affe941f":"We have seen before that female has more likelihood to survive than male. Higher class passenger also has more survival number than lower class. From the graphic above we can see that there are lots of male passenger in 3rd class. Maybe most of passengers who didn't survived come from this category. ","e3be34d9":"### Creating machine learning model\n\nOne of common algorithm for classification problem is Random Forest Classification. I will use that algorithm to create my model.","f7f14089":"Let's take a peek on our test set.","009c2e10":"### Exploratory Data Analysis","519261fa":"There were 3 ports where passenger can embark\n1. S - Southampton, England\n2. C - Cherbourg, France\n3. Q - Queenstown, Ireland\n\nMost passengers were come from England.","f8915cf3":"There are 177 entries out of 891 in age column that are missing. We need to deal with it late.\n<br> Age of passengers was mostly around 20 - 40 years old.\n<br> There were not so many passengers who went on board with their relatives i.e parents, children, siblings, spouse.\n<br> Range of fare ticket were vary from free ticket like 0 to very high price like 512. It can be happen that there are some outliers in this field.\n<br> We will see it more clearly using graphic visualization below.","92e66ea3":"Finally we have our training dataset.","f3929b79":"Passengers who didn't survived were almost twice as those who survived.<br>\nWe will see if some aspect like sex, Pclass, embarked port have influence in this odd.","a31f91f3":"It looks like our test data has quite same behaviour with our train data. Lots of missing value in cabin column. Great variance in fare price. Also some missing value in age column. I think we can treat it the same afterward.","60a2254b":"We have a peek on our data and want to know deeper about our data.","545c73e7":"To prevent the model from overfit. I will split our training data. So I will have\n1. Train set\n2. Test set\n3. Validation set -> data test provided for prediction submission","286fef26":"Some remarks that I note:\n1. 52.5% of passenger who didn't survived were male, there 64.8% male passenger in the ship, most of the male didn't survived.\n2. 41.8% of passenger who didn't survived were 3rd class passenger \n\nWe can gain some more insight from the data if we like. Some examples are below.","8f717d5d":"Based off above graphic there is tendency that older people can afford to buy higher class ticket. So I will use mean of age in each passenger class to fill the missing value in age column.  ","e3d8219e":"Now we prepare our data before we use it to train our model. \nFirst we will deal with missing value.","8adccb30":"### Data Preprocessing","04c5e9a4":"Since there are too much missing value in 'cabin' column, I choose to drop this column for our model. I using mode to fill missing value in embarked column.","69a55010":"We continue our EDA by looking some numerical values.","23d731b2":"So there are 891 entries in our data with 12 columns. \nThere are categorical datas:\n1. PassengerId : ID of passenger\n2. Survived : whether the passenger survived from the crash or not\n3. Pclass : ticket class of passenger\n4. Name : name of the passenger\n5. Sex : whether passenger is male or female\n6. Ticket : ticket number\n7. Cabin : cabin number\n8. Embarked : where the passenger embarked from\n\nAnd also numerical datas:\n1. Age : age of passenger\n2. Sibsp : number of siblings or spouse that the passenger went aboard together\n3. Parch : number of parent or children that the passenger went aboard together\n4. Fare : price of the ticket\n\nWe will make machine learning to predict if a passenger will survive or not from disaster, so our target is 'survived' column. Now we will do more EDA to choose which features that we will use to train our model."}}