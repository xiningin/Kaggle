{"cell_type":{"61d39d23":"code","2ba3e31d":"code","d8539814":"code","f81cbaa5":"code","1a91cc8c":"code","2b5c3493":"code","8d01f527":"code","9c2fbf43":"code","4d5f1ee7":"code","3ecfe7f4":"code","cc565f16":"code","4850d126":"code","a2c0514e":"markdown","c71d0521":"markdown","ab741e82":"markdown","bb0068e5":"markdown"},"source":{"61d39d23":"# data manipulation\nimport pandas as pd\n\n# cross validation\nfrom sklearn.model_selection import StratifiedKFold\n\n# metrics for model performance with RMSE\nfrom sklearn.metrics import mean_squared_error","2ba3e31d":"class args:\n    rand = 23\n    train_path = \"..\/input\/petfinder-pawpularity-score\/train.csv\"\n    test_path = \"..\/input\/petfinder-pawpularity-score\/test.csv\"\n    submission_path = \"..\/input\/petfinder-pawpularity-score\/sample_submission.csv\"\n    target = 'Pawpularity'\n    splits = 5","d8539814":"skf = StratifiedKFold(5, shuffle=True,random_state= args.rand)","f81cbaa5":"train = pd.read_csv(args.train_path, index_col=0)","1a91cc8c":"X = train.drop(args.target, axis=1)\ny = train[args.target]","2b5c3493":"import lightgbm as lgb","8d01f527":"model = lgb.LGBMRegressor(random_state=args.rand)","9c2fbf43":"rmse = 0\nfor fld, (train_index, test_index) in enumerate(skf.split(X, y)):\n    X_train = X.iloc[train_index]\n    y_train = y.iloc[train_index]\n    X_test = X.iloc[test_index]\n    y_test = y.iloc[test_index]\n    \n    model.fit(X_train, y_train)\n    \n    predict = model.predict(X_test)\n    \n    curr_rmse = mean_squared_error(y_test, predict, squared=False)\n    rmse += curr_rmse\n    print(f\"RMSE for fold:{fld} is {curr_rmse}.\")\nprint(f\"Average RMSE is {rmse \/ args.splits}\")","4d5f1ee7":"model.fit(X, y)","3ecfe7f4":"test = pd.read_csv(args.test_path, index_col=0)","cc565f16":"predict = model.predict(test)","4850d126":"submission = pd.read_csv(args.submission_path, index_col=0)\nsubmission[args.target] = predict\nsubmission.to_csv('submission.csv', index=True)","a2c0514e":"# Simple super starter guide without using images (LOL)\n\nBaseline stratkfld with lgb regressor with only meta features (that's right, no images) \n\nBest RMSE on public lb: 20.50347","c71d0521":"## Model training","ab741e82":"## Test data prediction","bb0068e5":"## Submission"}}