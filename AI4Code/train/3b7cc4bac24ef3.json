{"cell_type":{"eb03bc9e":"code","61f37c2e":"code","84336583":"code","12a940ae":"code","280e8628":"code","a5f0f57b":"code","44325aee":"code","f8ef7a28":"code","12e020ad":"code","a81ff546":"code","4518d79e":"code","999e790c":"code","938781f1":"code","5b34038b":"code","fa263d00":"code","f77961e2":"code","b5022855":"code","8576744e":"code","a190c765":"code","1b916820":"markdown","6b543fa6":"markdown","d54df7da":"markdown","e6494762":"markdown","209b07a0":"markdown","c27adbe4":"markdown","cab051b4":"markdown","02686b47":"markdown","c26d1260":"markdown","09bf71b7":"markdown","eb3a5f44":"markdown","96934c9d":"markdown","d21bf799":"markdown","23fe8f4b":"markdown","51c3c03d":"markdown","ebfd0499":"markdown","57e9097a":"markdown"},"source":{"eb03bc9e":"import pandas as pd\npd.options.display.max_columns = None\nimport geopandas as gpd\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom wordcloud import WordCloud, ImageColorGenerator","61f37c2e":"def graph_pie(labels, values, colors, title, explode, name_export):\n    fig1, ax1 = plt.subplots()\n    ax1.pie(values, explode=explode, labels=labels, colors=colors, autopct='%1.1f%%', startangle=90)\n    ax1.axis('equal')\n    plt.title(title)\n    plt.tight_layout()\n    plt.show()\n    \ndef graph_bar(labels, values, title, name_export):\n    fig1, ax1 = plt.subplots()\n    y_pos = np.arange(len(labels))\n    plt.xticks(y_pos, labels)\n    ax1.bar(y_pos, values, color='#99ff99')\n    plt.title(title)\n    plt.show()\n    \nstop_words = [\"de\",\"la\",\"c'est\",\"du\",\"pour\",\"ce\",\"les\",\"li\u00e9\",\"des\",\"ou\",\"et\",\"tout\",\"est\",\"un\",\"sont\",\"tous\",\"ci\",\"dans\",\"le\",\n             \"il\",\"faut\",\"qui\",\"que\",\"n'y\",\"pas\",\"ces\",\"ne\",\"peut\",\"par\",\"toute\",\"donc\",\"mai\",\"mais\",\"leur\",\"non\",\"comme\",\"une\",\n             \"plus\",\"important\",\"trop\",\"se\",\"sur\",\"fait\",\"ceraines\",\"probl\u00e8me\",\"probl\u00e8mes\", \"en\", \"place\",\"commun\",\"exemple\",\n             \"France\",\"avec\",\"au\",\"niveau\",'aussi',\"etc\",\"doit\",\"etre\",\"cela\",\"soit\",\"bien\",\"autre\",\"m\u00eame\",\"nottament\",\"si\",\n             \"alors\",\"car\",\"autres\",\"mettre\",\"je\",\"fais\",\"ecologique\",\"aide\",\"solution\",\"citoyen\",\"elle\",\"san\",\"beaucoup\",\"notamment\",\n             \"surtout\",\"faire\",\"n'est\",\"\u00e9cologique\",\"pourquoi\",\"an\",\"doivent\",\"on\",\"encore\",\"avoir\",\"rien\",\"sans\",\"moi\",\"me\",\"d\u00e9j\u00e0\",\n             \"nous\",\"l'\u00e9tat\",\"faudrait\",\"temp\",\"celle\",\"fran\u00e7ai\",\"ex\",\"peu\",\"dont\",\"monde\",\"d\u00e9j\u00e0\",\"ma\",\"\u00eatre\",\"serait\",\"possible\",\n             \"aujourd'hui\",\"\u00e9galement\",\"ainsi\",\"fran\u00e7ais\",\"toujour\",\"pourrait\",\"n\u00e9cessaire\",\"quand\",\"possible\",\"voir\",\"\u00e7a\",\n             \"possible\",\"voir\",\"personne\",\"semble\",\"ceux\",\"ont\",\"ils\",\"li\u00e9s\",\"cette\",\"certain\",\"tr\u00e8s\",\"point\",\"semble\",\n             \"sui\",\"mes\",\"peux\",\"ans\",\"chose\",\"km\",\"qu'il\",\"ca\",\"j'ai\",\"aucune\",\"toutes\",\"sais\",\"no\",\"vou\",\"pourrai\",\"toujours\",\n             \"chacun\",\"cas\",\"nos\",\"somme\",\"avons\",\"afin\",\"qu\",\"vous\"]\n\ndef word_cloud(text, name_export):\n    wordcloud = WordCloud(stopwords = stop_words, max_font_size=50, background_color=\"white\", width=800, height=400).generate(text)\n    plt.figure(figsize=[20,10])\n    plt.imshow(wordcloud, interpolation='bilinear')\n    plt.axis(\"off\")\n    plt.show()","84336583":"democratie_citoyennete = pd.read_csv('\/kaggle\/input\/granddebat\/DEMOCRATIE_ET_CITOYENNETE.csv', dtype=str)\nfiscalite_dp = pd.read_csv('\/kaggle\/input\/granddebat\/LA_FISCALITE_ET_LES_DEPENSES_PUBLIQUES.csv', dtype=str)\ntransition_ecologique = pd.read_csv('\/kaggle\/input\/granddebat\/LA_TRANSITION_ECOLOGIQUE.csv', dtype=str)\norganisation_etat_sv = pd.read_csv('\/kaggle\/input\/granddebat\/ORGANISATION_DE_LETAT_ET_DES_SERVICES_PUBLICS.csv', dtype=str)","12a940ae":"size_democratie_citoyennete = democratie_citoyennete.count()['id']\nsize_fiscalite_dp = fiscalite_dp.count()['id']\nsize_transition_ecologique = transition_ecologique.count()['id']\nsize_organisation_etat_sv = organisation_etat_sv.count()['id']\n\ntotal_row = size_democratie_citoyennete+size_fiscalite_dp+size_transition_ecologique+size_organisation_etat_sv\n\nprint(\"Nombre de contributions pour :\")\nprint(\"- Democratie et citoyennet\u00e9 : \"+str(size_democratie_citoyennete))\nprint(\"- Fiscalit\u00e9 et d\u00e9penses publiques : \"+str(size_fiscalite_dp))\nprint(\"- Transition \u00e9cologique : \"+str(size_transition_ecologique))\nprint(\"- Organisation de l'\u00e9tat et des services publics : \"+str(size_organisation_etat_sv))","280e8628":"labels = ['Democratie et Citoyennet\u00e9','La fiscalist\u00e9 et les d\u00e9penses publiques',\n          'La transition \u00e9cologique', \"Organisation de l'\u00e9tat\"]\nvalues = [size_democratie_citoyennete\/total_row,size_fiscalite_dp\/total_row,\n             size_transition_ecologique\/total_row,size_organisation_etat_sv\/total_row]\nexplode = (0, 0, 0.1, 0)\ncolors = ['#ff9999','#66b3ff','#99ff99','#ffcc99']\ntitle = 'Repartition du nombre de contributions entre les 4 th\u00e8mes'\nname_export=\"repartition_themes\"\ngraph_pie(labels, values, colors, title, explode, name_export)","a5f0f57b":"list_df = [transition_ecologique,organisation_etat_sv,fiscalite_dp,democratie_citoyennete]\nlist_name_df=['transition_ecologique','organisation_etat_sv','fiscalite_dp','democratie_citoyennete']\nlist_count_df = []\ni=0\nfor df in list_df:\n    df['code_dep'] = [str(code_postal)[:2] for code_postal in df.authorZipCode]\n    count_dep = df.groupby('code_dep').count()['id'].rename(list_name_df[i])\n    list_count_df.append(count_dep)\n    i+=1\n\ndf_count_dep = pd.concat(list_count_df, axis=1, sort=False)\n\ndf_count_dep['percentage'] = [((row['transition_ecologique'])\/(row['organisation_etat_sv']+row['fiscalite_dp']+row['democratie_citoyennete']+row['transition_ecologique']))*100 for index, row in df_count_dep.iterrows()]\n\ndf_count_dep = df_count_dep.drop(['-1','0','3','4','5','6','7','8','-9','na'])\ndf_count_dep.loc['69D'] = df_count_dep.loc['69']\ndf_count_dep.loc['69M'] = df_count_dep.loc['69']\n\ndf_count_dep.head()","44325aee":"# Data recovery of french department shape\nmap_df = gpd.read_file('\/kaggle\/input\/shape-department-france\/dep_fr.shp')\nmerged = map_df.set_index('code_insee').join(df_count_dep)","f8ef7a28":"variable = 'percentage'\n\nvmin, vmax = merged[variable].min(), merged[variable].max()\n\nfig, ax = plt.subplots(1, figsize=(10, 6))\n\nax.axis([-5,10,40,52.5])\nax.axis('off')\nax.set_title('Percentage of contributors in the ecological transition by department', fontdict={'fontsize': '25', 'fontweight' : '3'})\nmerged.plot(column=variable, cmap='Greens', linewidth=0.8, ax=ax, edgecolor='0.8')\n\nsm = plt.cm.ScalarMappable(cmap='Greens', norm=plt.Normalize(vmin=vmin, vmax=vmax))\nsm._A = []\ncbar = fig.colorbar(sm)","12e020ad":"transition_ecologique.head()","a81ff546":"data_clean = transition_ecologique.drop(['id','reference','createdAt','publishedAt','updatedAt','trashed','trashedStatus','authorId','authorType','authorZipCode'], axis=1)\ndata_clean.columns=['title',\n                    \"Quel est aujourd'hui pour vous le probl\u00e8me concret le plus important dans le domaine de l'environnement ?\",\n                    \"Que faudrait-il faire selon vous pour apporter des r\u00e9ponses \u00e0 ce probl\u00e8me ?\",\n                    \"Diriez-vous que votre vie quotidienne est aujourd'hui touch\u00e9e par le changement climatique ?\",\n                    \"Si oui, de quelle mani\u00e8re votre vie quotidienne est-elle touch\u00e9e par le changement climatique ?\",\n                    \"\u00c0 titre personnel, pensez-vous pouvoir contribuer \u00e0 prot\u00e9ger l'environnement ?\",\n                    \"Si oui, que faites-vous aujourd'hui pour prot\u00e9ger l'environnement et\/ou que pourriez-vous faire ?\",\n                    \"Qu'est-ce qui pourrait vous inciter \u00e0 changer vos comportements comme par exemple mieux entretenir et r\u00e9gler votre chauffage, modifier votre mani\u00e8re de conduire ou renoncer \u00e0 prendre votre v\u00e9hicule pour de tr\u00e8s petites distances ?\",\n                    \"Quelles seraient pour vous les solutions les plus simples et les plus supportables sur un plan financier pour vous inciter \u00e0 changer vos comportements ?\",\n                    \"Par rapport \u00e0 votre mode de chauffage actuel, pensez-vous qu'il existe des solutions alternatives plus \u00e9cologiques ?\",\n                    \"Si oui, que faudrait-il faire pour vous convaincre ou vous aider \u00e0 changer de mode de chauffage ?\",\n                    \"Avez-vous pour vos d\u00e9placements quotidiens la possibilit\u00e9 de recourir \u00e0 des solutions de mobilit\u00e9 alternatives \u00e0 la voiture individuelle comme les transports en commun, le covoiturage, l'auto-partage, le transport \u00e0 la demande, le v\u00e9lo, etc. ?\",\n                    \"Si oui, que faudrait-il faire pour vous convaincre ou vous aider \u00e0 utiliser ces solutions alternatives ?\",\n                    \"Si non, quelles sont les solutions de mobilit\u00e9 alternatives que vous souhaiteriez pouvoir utiliser ?\",\n                    \"Et qui doit selon vous se charger de vous proposer ce type de solutions alternatives ?\",\n                    \"Que pourrait faire la France pour faire partager ses choix en mati\u00e8re d'environnement au niveau europ\u00e9en et international ?\",\n                    \"Y a-t-il d'autres points sur la transition \u00e9cologique sur lesquels vous souhaiteriez vous exprimer ?\",\n                   \"code_dep\"]\nsize_file = data_clean.count()['title']\ndata_clean = data_clean.fillna('')\ndata_clean.head()","4518d79e":"list_q1_possible_rep = [\"La pollution de l'air\",\"Les d\u00e9r\u00e8glements climatiques (crue, s\u00e9cheresse)\",\"L'\u00e9rosion du littoral\",\"La biodiversit\u00e9 et la disparition de certaines esp\u00e8ces\"] \nq1 = \"Quel est aujourd'hui pour vous le probl\u00e8me concret le plus important dans le domaine de l'environnement ?\"\ndata_q1 = data_clean[data_clean[q1]!=\"\"]\nnb_rep_q1 = data_q1.count()['title']\nvalues = []\n\nfor possible_rep in list_q1_possible_rep:\n    size_rep = data_q1[data_q1[q1]==possible_rep].count()['title']\n    pourcentage_rep = (size_rep\/nb_rep_q1)*100\n    values.append(pourcentage_rep)\n    \nvalues.append(100-sum(values))\n\nlabels = [\"La pollution de l'air\",\"Les d\u00e9r\u00e8glements\\n climatiques\\n (crue, s\u00e9cheresse)\",\n         \"L'\u00e9rosion du littoral\",\"La biodiversit\u00e9 et \\nla disparition \\nde certaines esp\u00e8ces\",\n         \"Autres\"]\ncolors = ['#ff9999','#66b3ff','#99ff99','#ffcc99','#98ff56']\ntitle = \"The most concrete problem in the environment\"\nexplode = (0, 0, 0, 0, 0)\nname_export = \"problemes_plus_concret\"\ngraph_pie(labels, values, colors, title, explode, name_export)","999e790c":"data_q1_autres = data_clean[~data_clean[q1].isin(list_q1_possible_rep)]\n\ntext = \" \".join(review for review in data_q1_autres[q1])\nword_cloud(text,'autre_theme')","938781f1":"q=\"Diriez-vous que votre vie quotidienne est aujourd'hui touch\u00e9e par le changement climatique ?\"\nyes = (data_clean[data_clean[q]==\"Oui\"].count()['title']\/size_file)*100\nno = (data_clean[data_clean[q]==\"Non\"].count()['title']\/size_file)*100\nno_answer = (data_clean[data_clean[q]==\"\"].count()['title']\/size_file)*100\ngraph_bar(['Oui','Non','NP'],[yes,no,no_answer],\"Votre vie quotidienne est-elle aujourd'hui touch\u00e9e par le changement climatique ?\",'vie_quotidienne_touch\u00e9e_oui_non')","5b34038b":"yes_dep = data_clean[data_clean[q]==\"Oui\"].groupby(\"code_dep\").count()['title']\nother_dep = data_clean[data_clean[q]!=\"Oui\"].groupby(\"code_dep\").count()['title']\n\nyes_dep = yes_dep.drop(['-1','0','4','5','na'])\nyes_dep.loc['69D'] = yes_dep.loc['69']\nyes_dep.loc['69M'] = yes_dep.loc['69']\nother_dep.loc['69D'] = other_dep.loc['69']\nother_dep.loc['69M'] = other_dep.loc['69']\n\nfor index, value in yes_dep.items():\n    yes_dep[index] = (value\/(other_dep[index]+value))*100\n    \ndf_yes_dep = pd.Series(yes_dep,name=\"pourcentage\")    \ndf_yes_dep.head()","fa263d00":"merged = map_df.set_index('code_insee').join(df_yes_dep)\n# Variable utilis\u00e9 pour les valeurs de la map\nvariable = 'pourcentage'\n\n# Min et max pour la l\u00e9gende\nvmin, vmax = merged[variable].min(), merged[variable].max()\n\n# Cr\u00e9ation du graphique\nfig, ax = plt.subplots(1, figsize=(10, 6))\n# Zoom sur la France m\u00e9tropolitaine\nax.axis([-5,10,40,52.5])\nax.axis('off')\nax.set_title('Percentage of people affected by climate change (by department)', fontdict={'fontsize': '25', 'fontweight' : '3'})\nmerged.plot(column=variable, cmap='Greens', linewidth=0.8, ax=ax, edgecolor='0.8')\n\n# Ajout de la l\u00e9gende\nsm = plt.cm.ScalarMappable(cmap='Greens', norm=plt.Normalize(vmin=vmin, vmax=vmax))\nsm._A = []\ncbar = fig.colorbar(sm)","f77961e2":"q=\"\u00c0 titre personnel, pensez-vous pouvoir contribuer \u00e0 prot\u00e9ger l'environnement ?\"\nyes = (data_clean[data_clean[q]==\"Oui\"].count()['title']\/size_file)*100\nno = (data_clean[data_clean[q]==\"Non\"].count()['title']\/size_file)*100\nno_answer = (data_clean[data_clean[q]==\"\"].count()['title']\/size_file)*100\nprint(yes,no,no_answer)\n\ngraph_bar(['Oui','Non','NP'],[yes,no,no_answer],\"Pensez-vous pouvoir contribuer \u00e0 prot\u00e9ger l'environnement ?\",'contribution_oui_non')","b5022855":"q=\"Si oui, que faites-vous aujourd'hui pour prot\u00e9ger l'environnement et\/ou que pourriez-vous faire ?\"\ntext = \" \".join(review for review in data_clean[q])\nword_cloud(text, 'action_word_cloud')","8576744e":"q=\"Qu'est-ce qui pourrait vous inciter \u00e0 changer vos comportements comme par exemple mieux entretenir et r\u00e9gler votre chauffage, modifier votre mani\u00e8re de conduire ou renoncer \u00e0 prendre votre v\u00e9hicule pour de tr\u00e8s petites distances ?\"\ntext = \" \".join(review for review in data_clean[q])\nword_cloud(text, 'incitation_word_cloud')","a190c765":"q=\"Quelles seraient pour vous les solutions les plus simples et les plus supportables sur un plan financier pour vous inciter \u00e0 changer vos comportements ?\"\ntext = \" \".join(review for review in data_clean[q])\nword_cloud(text, \"solutions_supportables_word_cloud\")","1b916820":"**Data cleaning**","6b543fa6":"## Data analysis on the ecological transition file","d54df7da":"We can see that the ecological transition is the second most important problematic with 27% of contributions.","e6494762":"**Would you say that your daily life is affected by climate change?**","209b07a0":"## Analysis : Data repartition","c27adbe4":"The purpose of this notebook is to analyze the contributions made by French people during 'Le Grand Debat National' regarding the ecological transition.","cab051b4":"**Functions for graphs creations**","02686b47":"**Library imports**","c26d1260":"**What could help you to change your behavior (in favor of the environment) ? **","09bf71b7":"**What would be for you the simplest and most financially bearable solutions to encourage you to change your behaviour?**","eb3a5f44":"**Do you think you can contribute to protect the environment ?**","96934c9d":"**Data recovery**","d21bf799":"## Proportion of contributors in the ecological transition by department","23fe8f4b":"**Percentage of people affected by climate change (by department)**","51c3c03d":"**What do you do to protect the environment ?**","ebfd0499":"**The most concrete problem in the environment**","57e9097a":"**The \"other\" section**"}}