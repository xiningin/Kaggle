{"cell_type":{"62093ed2":"code","9f5b1a2c":"code","b82ea859":"code","e49e999e":"code","c6b512d8":"code","39baa97b":"code","52b9cf00":"code","c51127b0":"code","d9f3b9ea":"code","3c51fb8d":"code","e4e1aa0a":"code","0f2807cc":"code","3408df11":"code","d3f91b86":"code","b1887ab5":"code","db466184":"code","8b1f7bc4":"code","047e22f6":"code","c5c03ea6":"code","d9aa3f10":"code","232105f0":"code","f22fdb65":"code","a0ac4b42":"code","3a18b0f9":"code","b3839f2b":"code","81ffb071":"code","afa7ad93":"code","d16c35e4":"code","a2d4673e":"code","5e9a2a00":"code","b12fed28":"code","fde00dd8":"code","f04fa267":"code","3314c354":"code","b6258774":"code","df175452":"code","7c572e9f":"code","36707565":"code","95633aae":"code","8690b676":"code","9fe125fe":"code","df22de8d":"markdown","b0c4cf73":"markdown","60814bc9":"markdown","a28d3c74":"markdown","2511539f":"markdown","d2a586bb":"markdown","f29a01c3":"markdown","a8c25fd6":"markdown","29612812":"markdown","16ec943f":"markdown","52c56882":"markdown","c16ef4be":"markdown","538ac2f6":"markdown","3451438a":"markdown","a6d5fe58":"markdown","e9e04295":"markdown","f2171d24":"markdown","0917e3a8":"markdown","c0e2766d":"markdown","367c1572":"markdown","855cbb83":"markdown","de225787":"markdown","8026d99a":"markdown","88d980f3":"markdown","96ed3410":"markdown","e150a5ab":"markdown","40d0dd47":"markdown","ee799825":"markdown","79366753":"markdown","bdb224c7":"markdown","113342da":"markdown","0fe62caa":"markdown","b44e11c5":"markdown","9380dbb7":"markdown","eef86e88":"markdown","5c815a54":"markdown","588a4917":"markdown","78a5c572":"markdown","ebb9533e":"markdown","af4e4f6c":"markdown","3a91bc05":"markdown","24b4e856":"markdown","027b283e":"markdown"},"source":{"62093ed2":"import numpy as np \nimport pandas as pd \nimport os\nprint(os.listdir(\"..\/input\"))\nimport nltk\nimport gc\nimport matplotlib.pyplot as plt\n%matplotlib inline","9f5b1a2c":"train = pd.read_csv(\"..\/input\/train_main.csv\")\ntest = pd.read_csv(\"..\/input\/test_main.csv\")\nprint('Shape of train dataset:{}'.format(train.shape))\nprint('Shape of test dataset:{}'.format(test.shape))","b82ea859":"train['train_or_test'] = 'train'\ntest['train_or_test'] = 'test'\ndf = pd.concat([train,test], sort=False)\nprint('Combined df shape:{}'.format(df.shape))\ndel train, test\ngc.collect()","e49e999e":"df.head()","c6b512d8":"df['tare'].nunique()","39baa97b":"df.describe()","52b9cf00":"df.groupby('tare').describe()","c51127b0":"df['length'] = df['name'].apply(len)\ndf.head()","d9f3b9ea":"df['length'].plot(bins=50,kind='hist')","3c51fb8d":"df.length.describe()","e4e1aa0a":"df[df['length']==184]['name'].iloc[0]","0f2807cc":"import string\n\nname = '\u0422\u0435\u0441\u0442\u043e\u0432\u043e\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435, \u043e\u0431\u0440\u0430\u0442\u0438\u0442\u0435 \u0432\u043d\u0438\u043c\u0430\u043d\u0438\u0435 \u043d\u0430 \u043f\u0443\u043d\u043a\u0443\u0442\u0430\u0446\u0438\u044e'\n\n# \u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430, \u0435\u0441\u0442\u044c \u043b\u0438 \u043f\u0443\u043d\u043a\u0442\u0443\u0430\u0446\u0438\u044f \u0432 \u0442\u0435\u043a\u0441\u0442\u0435\nnopunc = [char for char in name if char not in string.punctuation]\n\n# \u0421\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432 \u0434\u043b\u044f \u0438\u0445 \u043f\u0435\u0440\u0435\u0432\u043e\u0434\u0430 \u0432 \u0442\u0435\u043a\u0441\u0442.\nnopunc = ''.join(nopunc)\nprint(nopunc)","3408df11":"from nltk.corpus import stopwords\nstopwords.words('russian')[0:10]","d3f91b86":"#\u0414\u0440\u043e\u0431\u0438\u043c \u0442\u0435\u043a\u0441\u0442 \u0432 \u043b\u0438\u0441\u0442 \u0434\u043b\u044f \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u0439 \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0438\nnopunc.split()","b1887ab5":"clean_name = [word for word in nopunc.split() if word.lower() not in stopwords.words('russian')]\nprint(clean_name)","db466184":"def text_process(name):\n    \"\"\"\n    1.\u0423\u0431\u0438\u0440\u0430\u0435\u043c \u0432\u0441\u044e \u043f\u0443\u043d\u043a\u0442\u0443\u0430\u0446\u0438\u044e\n    2.\u0423\u0431\u0438\u0440\u0430\u0435\u043c \u0432\u0441\u0435 stopwords(\u043f\u043e\u0432\u0442\u043e\u0440\u044f\u044e\u0449\u0438\u0435\u0441\u044f \u0441\u043b\u043e\u0432\u0430)\n    3.\u0412\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u043c \u0447\u0438\u0441\u0442\u044b\u0439 \u0442\u0435\u043a\u0441\u0442\n    \"\"\"\n    # \u041f\u0440\u043e\u0432\u0435\u0440\u043a\u0430, \u0435\u0441\u0442\u044c \u043b\u0438 \u043f\u0443\u043d\u043a\u0442\u0443\u0430\u0446\u0438\u044f \u0432 \u0442\u0435\u043a\u0441\u0442\u0435\n    nopunc = [char for char in name if char not in string.punctuation]\n    \n    # \u0421\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432 \u0434\u043b\u044f \u0438\u0445 \u043f\u0435\u0440\u0435\u0432\u043e\u0434\u0430 \u0432 \u0442\u0435\u043a\u0441\u0442\n    nopunc = ''.join(nopunc)\n    \n    #\u0423\u0431\u0438\u0440\u0430\u0435\u043c \u0432\u0441\u0435 stopwords\n    return [word for word in nopunc.split() if word.lower() not in stopwords.words('russian')]","8b1f7bc4":"df.head()","047e22f6":"df['name'].head(5).apply(text_process)","c5c03ea6":"from sklearn.feature_extraction.text import CountVectorizer","d9aa3f10":"#\u041c\u043e\u0436\u0435\u0442 \u0437\u0430\u043d\u044f\u0442\u044c \u043d\u0435\u043a\u043e\u0442\u043e\u0440\u043e\u0435 \u0432\u0440\u0435\u043c\u044f\nbow_transformer = CountVectorizer(analyzer=text_process).fit(df['name'])\n\n# \u0412\u044b\u0432\u0435\u0441\u0442\u0438 \u0441\u043b\u043e\u0432\u0430 \u0432 \u043d\u0430\u0448\u0435\u043c \u0441\u043b\u043e\u0432\u0430\u0440\u0435\nprint(len(bow_transformer.vocabulary_))","232105f0":"df['name'][2]","f22fdb65":"name4 = df[df['train_or_test']=='train'].iloc[3]['name']\nprint(name4)","a0ac4b42":"train_df = df[df['train_or_test']=='train']\ntest_df = df[df['train_or_test']=='test']","3a18b0f9":"bow4 = bow_transformer.transform([name4])\nprint(bow4)\nprint(bow4.shape)","b3839f2b":"names_test_bow = df[df['train_or_test']=='test']\nnames_train_bow = df[df['train_or_test']=='train']","81ffb071":"names_train_bow = bow_transformer.transform(names_train_bow['name'])\nnames_test_bow = bow_transformer.transform(names_test_bow['name'])","afa7ad93":"print('Shape of Train Sparse Matrix:{}'.format(names_train_bow.shape))\nprint('Shape of Test Sparse Matrix:{}'.format(names_test_bow.shape))\nprint('Amount of Non-Zero occurences in Train:{}'.format(names_train_bow.nnz))\nprint('Amount of Non-Zero occurences in Test:{}'.format(names_test_bow.nnz))","d16c35e4":"train_sparsity = (100.0 * names_train_bow.nnz \/ (names_train_bow.shape[0] * names_train_bow.shape[1]))\ntest_sparsity = (100.0 * names_test_bow.nnz \/ (names_test_bow.shape[0] * names_test_bow.shape[1]))\nprint('Sparsity of Train: {}'.format(round(train_sparsity)))\nprint('Sparsity of Test: {}'.format(round(test_sparsity)))","a2d4673e":"from sklearn.feature_extraction.text import TfidfTransformer\ntfidf_transformer_train = TfidfTransformer().fit(names_train_bow)\ntfidf_transformer_test = TfidfTransformer().fit(names_test_bow)\ntfidf4 = tfidf_transformer_train.transform(bow4)\nprint(tfidf4)","5e9a2a00":"names_train_tfidf = tfidf_transformer_train.transform(names_train_bow)\nnames_test_tfidf = tfidf_transformer_train.transform(names_test_bow)\nprint(names_train_tfidf.shape)\nprint(names_test_tfidf.shape)","b12fed28":"tare_train = df[df['train_or_test']=='train']['tare']\ntare_train.head()","fde00dd8":"from sklearn.naive_bayes import MultinomialNB\ntare_assign_model = MultinomialNB().fit(names_train_tfidf, train_df['tare'])","f04fa267":"print('predicted:', tare_assign_model.predict(tfidf4)[0])\nprint('expected:', df.tare[3])","3314c354":"from sklearn.model_selection import train_test_split\n\nname_train, name_test, tare_train, tare_test = \\\ntrain_test_split(train_df['name'],train_df['tare'], test_size=0.2)\n\nprint(len(name_train), len(name_test), len(name_train) + len(name_test))","b6258774":"from sklearn.pipeline import Pipeline\n\npipeline = Pipeline([\n    ('bow', CountVectorizer(analyzer=text_process)),  # \u0442\u0435\u043a\u0441\u0442 \u0432 \u0447\u0438\u0441\u043b\u043e\u0432\u044b\u0435 \u0432\u0435\u043a\u0442\u043e\u0440\u044b\n    ('tfidf', TfidfTransformer()),  # \u0447\u0438\u0441\u043b\u043e\u0432\u044b\u0435 \u0432\u0435\u043a\u0442\u043e\u0440\u044b \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e TFIDF\n    ('classifier', MultinomialNB()),  # \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043a\u0430 \u043d\u0430 \u0432\u0435\u043a\u0442\u043e\u0440\u0430\u0445 TF-IDF \u0441 \u041d\u0430\u0438\u0432\u043d\u044b\u043c \u0411\u0430\u0439\u0435\u0441\u043e\u0432\u0441\u043a\u0438\u043c \u043a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440\u043e\u043c\n])","df175452":"pipeline.fit(name_train,tare_train)","7c572e9f":"from sklearn.metrics import classification_report\nfrom sklearn.metrics import accuracy_score","36707565":"predictions = pipeline.predict(name_test)\nprint(classification_report(predictions,tare_test))\nprint(accuracy_score(predictions,tare_test))","95633aae":"test_preds = pipeline.predict(test_df['name'])","8690b676":"test = df.loc[df.train_or_test=='test', :]\ntrain = df.loc[~(df.train_or_test=='test'), :]\nprint('Train shape:{}, Test shape:{}'.format(train.shape, test.shape))","9fe125fe":"sub = test.loc[:,['id','name','tare']]\nsub['tare'] = test_preds\nsub['id'] = sub.id.astype(int)\nsub['name'] = test_df['name']\nsub.to_csv('submission_r.csv', index=False)\nsub.head()","df22de8d":"\u0414\u043b\u044f \u0430\u043d\u0430\u043b\u0438\u0437\u0430 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c \u043d\u0430\u0448\u0443 \u0441\u043e\u0431\u0441\u0442\u0432\u0435\u043d\u043d\u0443\u044e \u0444\u0443\u043d\u043a\u0446\u0438\u044e.","b0c4cf73":"\u0422\u0430\u043a \u043a\u0430\u043a \u0443 \u043c\u0435\u043d\u044f \u0432\u0441\u0435 \u0435\u0449\u0435 \u0434\u0432\u0430 \u043d\u0430\u0431\u043e\u0440\u0430 \u0438\u043c\u0435\u043d, \u0432\u0441\u0435 \u0441\u0447\u0438\u0442\u0430\u0435\u043c \u0434\u0432\u0430\u0436\u0434\u044b.","60814bc9":"\u0414\u0430\u0432\u0430\u0439\u0442\u0435 \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u043c \u043d\u0430\u0448\u0443 \u043c\u043e\u0434\u0435\u043b\u044c \u0441\u043d\u043e\u0432\u0430 \u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043e\u0447\u043d\u044b\u0439 \u0441\u0435\u0442. \u041c\u044b \u0431\u0443\u0434\u0435\u043c \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0432\u0435\u0441\u044c\u043c\u0430 \u043f\u043e\u043b\u0435\u0437\u043d\u0443\u044e \u0432\u0435\u0449\u044c \u043a\u0430\u043a [Pipeline](http:\/\/scikit-learn.org\/stable\/modules\/pipeline.html), \u0441 \u0435\u0435 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u043c\u044b \u0441\u043c\u043e\u0436\u0435\u043c \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0438 \u0434\u043b\u044f \u0434\u0430\u043b\u044c\u043d\u0435\u0439\u0448\u0435\u0433\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f. \u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0438\u043c, \u043a\u0430\u043a \u043e\u043d\u0430 \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442:","a28d3c74":"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0443\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u0445 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0439 \u0442\u0430\u0440 75, \u043d\u043e \u044d\u0442\u043e \u0441\u043a\u043e\u0440\u0435\u0435 \u0432\u0441\u0435\u0433\u043e \u0448\u0443\u043c, \u043b\u0438\u0431\u043e \u0441\u043f\u0435\u0446\u0438\u0430\u043b\u044c\u043d\u043e \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043d\u044b\u0439, \u043b\u0438\u0431\u043e \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0435\u0441\u0442\u044c \u0442\u0430\u0440\u044b \u0441 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435\u043c \"75\". \u041a \u0441\u043e\u0436\u0430\u043b\u0435\u043d\u0438\u044e, \u044f \u043d\u0435 \u0437\u043d\u0430\u044e, \u043a\u0430\u043a \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0438\u0445 \u0438\u043b\u0438 \u0438\u0441\u043f\u0440\u043e\u0430\u0432\u0438\u0442\u044c, \u043f\u043e\u044d\u0442\u043e\u043c\u0443 \u043e\u043d\u0438 \u043e\u0441\u0442\u0430\u044e\u0442\u0441\u044f \u0442\u0430\u043a\u0438\u043c\u0438 \u043a\u0430\u043a \u0435\u0441\u0442\u044c. \u041a\u0440\u043e\u043c\u0435 \u0442\u043e\u0433\u043e \u0435\u0441\u0442\u044c \u0434\u0432\u0435 \u0441\u0442\u0440\u0430\u043d\u043d\u044b\u0445 \u043a\u043e\u043b\u043e\u043d\u043a\u0438 \u043f\u043e\u0441\u043b\u0435 \u0442\u0430\u0440\u044b, \u0441 \u043d\u0438\u043c\u0438 \u0442\u0430\u043a\u0430\u044f \u0436\u0435 \u0441\u0438\u0442\u0443\u0430\u0446\u0438\u044f.","2511539f":"## \u0427\u0430\u0441\u0442\u044c 6: Pipeline","d2a586bb":"## \u0427\u0430\u0441\u0442\u044c 3: \u0422\u0440\u0430\u043d\u0441\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f","f29a01c3":"\u041c\u043e\u0436\u043d\u043e \u043f\u043e\u0434\u0443\u043c\u0430\u0442\u044c, \u0447\u0442\u043e \u044f \u0443\u0436\u0435 \u0434\u0435\u043b\u0430\u043b \u043d\u0435\u0447\u0442\u043e \u043f\u043e\u0434\u043e\u0431\u043d\u043e\u0435 \u0438 \u044d\u0442\u043e \u0442\u0430\u043a, \u043d\u043e \u043c\u043d\u0435 \u0442\u0430\u043a \u0443\u0434\u043e\u0431\u043d\u0435\u0435.","a8c25fd6":"## \u0427\u0430\u0441\u0442\u044c 2: \u0412\u0435\u043a\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u044f","29612812":"Next step is to see how sparse our names has become. *Spoiler: 0 *\nWhat is sparcity, you might ask? This is wiki article to help you understand\n\u0421\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439 \u0448\u0430\u0433, \u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u043d\u0430\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0440\u0430\u0437\u0440\u0435\u0436\u0435\u043d\u043d\u043e\u0439 \u0441\u0442\u0430\u043b\u0430 \u043d\u0430\u0448\u0430 \u043c\u0430\u0442\u0440\u0438\u0446\u0430 \u0432\u0435\u043a\u0442\u043e\u0440\u043e\u0432\n\u0427\u0442\u043e \u0442\u0430\u043a\u043e\u0435 \u0440\u0430\u0437\u0440\u0435\u0436\u0435\u043d\u043d\u0430\u044f \u043c\u0430\u0442\u0440\u0438\u0446\u0430? \n[Wiki](https:\/\/ru.wikipedia.org\/wiki\/%D0%A0%D0%B0%D0%B7%D1%80%D0%B5%D0%B6%D0%B5%D0%BD%D0%BD%D0%B0%D1%8F_%D0%BC%D0%B0%D1%82%D1%80%D0%B8%D1%86%D0%B0)","16ec943f":"\u0412 \u0434\u0430\u043d\u043d\u044b\u0439 \u043c\u043e\u043c\u0435\u043d\u0442 \u043d\u0430\u0448\u0438 \u0438\u043c\u0435\u043d\u0430 \u0432\u044b\u0433\u043b\u044f\u0434\u044f\u0442 \u043a\u0430\u043a \u043b\u0438\u0441\u0442\u044b \u0441 \u0435\u0434\u0438\u043d\u0438\u0446\u0430\u043c\u0438 \u0442\u0435\u043a\u0441\u0442\u0430 (lemmas) \u0438 \u0441\u0435\u0439\u0447\u0430\u0441 \u043d\u0430\u043c \u043d\u0443\u0436\u043d\u043e \u043a\u043e\u043d\u0432\u0435\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u0441\u0435 \u044d\u0442\u0438 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f \u0432 \u0432\u0435\u043a\u0442\u043e\u0440\u044b, \u0447\u0442\u043e\u0431\u044b SciKit Learn \u0430\u043b\u0433\u043e\u0440\u0438\u0442\u043c\u044b \u0441\u043c\u043e\u0433\u043b\u0438 \u0441 \u043d\u0438\u043c\u0438 \u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c.\n\n\u0421\u0435\u0439\u0447\u0430\u0441 \u043c\u044b \u043a\u043e\u043d\u0432\u0435\u0440\u0442\u0438\u0440\u0443\u0435\u043c \u043a\u0430\u0436\u0434\u043e\u0435 \u0438\u043c\u044f  \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u043d\u043e\u0435 \u0432 \u0432\u0438\u0434\u0435 \u0441\u043f\u0438\u0441\u043a\u0430 \u0447\u043b\u0435\u043d\u043e\u0432 \u0441\u0432\u0435\u0440\u0445\u0443 \u0432 \u0432\u0435\u043a\u0442\u043e\u0440 \u0434\u043b\u044f \u043f\u043e\u043d\u0438\u043c\u0430\u043d\u0438\u044f \u0430\u043b\u0433\u043e\u0440\u0438\u0442\u043c\u0430 \u043c\u0430\u0448\u0438\u043d\u043d\u043e\u0433\u043e \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f.\n\n\u041c\u044b \u0441\u0434\u0435\u043b\u0430\u0435\u043c \u044d\u0442\u043e \u0432 \u0442\u0440\u0438 \u0448\u0430\u0433\u0430 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u043c\u043e\u0434\u0435\u043b\u044c [bag-of-words](https:\/\/en.wikipedia.org\/wiki\/Bag-of-words_model)\n\n\u0421\u043e\u0441\u0447\u0438\u0442\u0430\u0435\u043c \u043a\u0430\u043a \u043c\u043d\u043e\u0433\u043e \u0440\u0430\u0437 \u0441\u043b\u043e\u0432\u043e \u0432\u0441\u0442\u0440\u0435\u0447\u0430\u0435\u0442\u0441\u044f \u0432 \u043a\u0430\u0436\u0434\u043e\u043c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0438 ( \u0422\u0430\u043a\u0436\u0435 \u0438\u0437\u0432\u0435\u0441\u0442\u043d\u043e \u043a\u0430\u043a \u0447\u0430\u0441\u0442\u043e\u0442\u0430 \u0442\u0435\u0440\u043c\u0438\u043d\u0430 \u0438\u043b\u0438 Term Frequency)\n\nWeigh the counts, so that frequent tokens get lower weight (inverse document frequency)\n\n\u0421\u043e\u0441\u0447\u0438\u0442\u0430\u0435\u043c \u0432\u0441\u0435 \u044d\u0442\u043e, \u0442\u0430\u043a\u0438\u043c \u043e\u0431\u0440\u0430\u0437\u043e\u043c, \u0447\u0442\u043e \u0447\u0430\u0449\u0435 \u0432\u0441\u0442\u0440\u0435\u0447\u0430\u044e\u0449\u0438\u0435\u0441\u044f \u0441\u043b\u043e\u0432\u0430 \u0438\u043c\u0435\u044e\u0442 \u0431\u043e\u043b\u0435\u0435 \u043d\u0438\u0437\u043a\u0438\u0439 \u0432\u0435\u0441(inverse document frequency)*\u0434\u0430\u043d\u043d\u044b\u0439 \u0442\u0435\u0440\u043c\u0438\u043d \u0441\u043b\u043e\u0436\u043d\u043e \u043f\u0435\u0440\u0435\u0432\u0435\u0441\u0442\u0438 \u043d\u0430 \u0440\u0443\u0441\u0441\u043a\u0438\u0439, \u0434\u0430\u043b\u0435\u0435 \u0431\u0443\u0434\u0435\u0442 \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u043e\u0435 \u043f\u043e\u044f\u0441\u043d\u0435\u043d\u0438\u0435*\n\n\u041d\u043e\u0440\u043c\u0430\u043b\u0438\u0437\u0443\u0435\u043c \u0432\u0435\u043a\u0442\u043e\u0440\u044b \u0434\u043e \u0434\u043b\u0438\u043d\u044b \u044e\u043d\u0438\u0442\u0430, \u0447\u0442\u043e\u0431\u044b \u0430\u0431\u0441\u0442\u0440\u0430\u0433\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u043e\u0442 \u0434\u043b\u0438\u043d\u044b \u043e\u0440\u0438\u0433\u0438\u043d\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u0442\u0435\u043a\u0441\u0442\u0430(L2 norm)*[\u043c\u043d\u043e\u0433\u043e \u043c\u0430\u0442\u0435\u043c\u0430\u0442\u0438\u043a\u0438](http:\/\/edu.sernam.ru\/book_sm_math5.php?id=59)*\n\n\u041d\u0430\u0447\u043d\u0435\u043c \u043f\u0435\u0440\u0432\u044b\u0439 \u0448\u0430\u0433","52c56882":"\u0421 \u0438\u043c\u0435\u043d\u0430\u043c\u0438 \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u043d\u044b\u043c\u0438 \u043a\u0430\u043a \u0432\u0435\u043a\u0442\u043e\u0440\u044b, \u043c\u044b \u043d\u0430\u043a\u043e\u043d\u0435\u0446 \u043c\u043e\u0436\u0435\u043c \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440. \u041f\u043e [\u0440\u0430\u0437\u043b\u0438\u0447\u043d\u044b\u043c \u043f\u0440\u0438\u0447\u0438\u043d\u0430\u043c](http:\/\/www.inf.ed.ac.uk\/teaching\/courses\/inf2b\/learnnotes\/inf2b-learn-note07-2up.pdf) \u041d\u0430\u0438\u0432\u043d\u044b\u0439 \u0411\u0430\u0439\u0435\u0441\u043e\u0432\u0441\u043a\u0438\u0439 \u041a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440 \u043f\u043e\u0434\u043e\u0439\u0434\u0435\u0442 \u043d\u0430\u043c.","c16ef4be":"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043b \u043c\u0435\u0442\u043e\u0434\u0438\u043a\u0443 accuracy \u0438\u0431\u043e \u043f\u043e \u043d\u0435\u0439 \u0434\u043e\u043b\u0436\u043d\u044b \u0431\u044b\u043b\u0438 \u043e\u0446\u0435\u043d\u0438\u0432\u0430\u0442\u044c \u0440\u0430\u0431\u043e\u0442\u0443. \u041d\u0443 \u0438 \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u043a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u043e\u043d\u043d\u044b\u0439 \u043e\u0442\u0447\u0435\u0442.","538ac2f6":"\u0412\u0441\u0435\u0433\u043e \u043e\u0434\u043d\u043e \u0441\u043b\u043e\u0432\u043e \u0431\u044b\u043b\u043e \u0443\u0434\u0430\u043b\u0435\u043d\u043e, \u043d\u043e \u0438\u043c\u0435\u044f 60+ \u0442\u044b\u0441\u044f\u0447 \u0441\u0442\u0440\u043e\u0447\u0435\u043a, \u044d\u0442\u043e \u044f\u0432\u043d\u043e \u0431\u0443\u0434\u0435\u0442 \u043a \u043c\u0435\u0441\u0442\u0443.","3451438a":"## \u0427\u0430\u0441\u0442\u044c 5 : \u0422\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043a\u0430 \u041c\u043e\u0434\u0435\u043b\u0438","a6d5fe58":"## \u0427\u0430\u0441\u0442\u044c 1: \u0424\u0443\u043d\u043a\u0446\u0438\u044f \u0434\u043b\u044f \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u0442\u0435\u043a\u0441\u0442\u0430","e9e04295":"### 5.1 Train Test Split","f2171d24":"\u0421\u0435\u0439\u0447\u0430\u0441 \u043c\u044b \u043d\u0430\u0447\u043d\u0435\u043c \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c .transform \u043d\u0430 \u043d\u0430\u0448\u0435\u0439 \u043c\u043e\u0434\u0435\u043b\u0438 \u041c\u0435\u0448\u043a\u0430 \u0421\u043b\u043e\u0432 (bow) \u0438 \u0442\u0440\u0430\u043d\u0441\u0444\u043e\u0440\u043c\u0438\u0440\u0443\u0435\u043c \u0432\u0435\u0441\u044c \u0434\u0430\u0442\u0430\u0441\u0435\u0442 \u0438\u0445 \u0438\u043c\u0435\u043d. \u041a\u0440\u043e\u043c\u0435 \u0442\u043e\u0433\u043e, \u043d\u0435 \u0441\u0442\u043e\u0438\u0442 \u0437\u0430\u0431\u044b\u0432\u0430\u0442\u044c, \u0447\u0442\u043e \u043d\u0430\u0434\u043e \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u043e \u044d\u0442\u043e \u0441\u0434\u0435\u043b\u0430\u0442\u044c \u0434\u043b\u044f \u0440\u0430\u0437\u043d\u044b\u0445 \u0434\u0430\u0442\u0430\u0441\u0435\u0442\u043e\u0432. \u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0438\u043c, \u043a\u0430\u043a \u043c\u043d\u043e\u0433\u043e \u0441\u043b\u043e\u0432 \u0441\u043e\u0437\u0434\u0430\u043d\u043e \u0431\u044b\u043b\u043e, \u0430 \u0442\u0430\u043a \u0436\u0435 \u0438\u0445 \u0444\u043e\u0440\u043c\u0443 \u0440\u0430\u0437\u0440\u0435\u0436\u0435\u043d\u043d\u043e\u0439 \u043c\u0430\u0442\u0440\u0438\u0446\u044b.","0917e3a8":"\u041f\u0440\u0438\u043c\u0435\u043d\u0438\u043c \u043d\u0430\u0448\u0443 \u043d\u043e\u0432\u0443\u044e \u0444\u0443\u043d\u043a\u0446\u0438\u044e \u043d\u0430 5 \u0432\u0435\u0440\u0445\u043d\u0438\u0445 \u0441\u0442\u0440\u043e\u0447\u0435\u043a \u0438\u0437 \u0434\u0430\u0442\u0430\u0441\u0435\u0442\u0430.","c0e2766d":"\u0420\u0430\u0437\u043c\u0435\u0440 \u0442\u0435\u0441\u0442\u0430 \u044d\u0442\u043e 20% \u043e\u0442 \u0432\u0441\u0435\u0433\u043e \u0434\u0430\u0442\u0430\u0441\u0435\u0442\u0430 (8130 \u0438\u0437 \u043e\u0431\u0449\u0438\u0445 40648), \u0438 \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043a\u0430 \u044d\u0442\u043e \u043e\u0441\u0442\u0430\u043b\u044c\u043d\u043e\u0435 (32518 \u0438\u0437 40648). \u041e\u0431\u044b\u0447\u043d\u043e \u0441\u043f\u043b\u0438\u0442 \u0438\u0434\u0435\u0442 30\/70","367c1572":"# NLTK\n## \u0427\u0430\u0441\u0442\u044c 0: \u041f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0430 \u0438 \u043f\u0440\u0438\u043c\u0435\u0440\u044b","855cbb83":"\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u0441\u0440\u0435\u0434\u043d\u0438\u0435, \u0435\u0441\u0442\u044c \u0433\u0434\u0435 \u0443\u043b\u0443\u0447\u0448\u0438\u0442\u044c, \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u0434\u0440\u0443\u0433\u0438\u0435 \u043a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u043a\u0430\u0442\u043e\u0440\u044b","de225787":"> **\u041e\u0431\u0440\u0430\u0442\u0438\u0442\u0435 \u0432\u043d\u0438\u043c\u0430\u043d\u0438\u0435, \u0447\u0442\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0447\u043d\u044b\u0439 \u0434\u0430\u0442\u0430\u0441\u0435\u0442, \u0430 \u043d\u0435 \u0442\u0435\u0441\u0442\u043e\u0432\u044b\u0439.","8026d99a":"\u0427\u0442\u043e\u0431\u044b \u043d\u0435\u043c\u043d\u043e\u0433\u043e \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u0438\u0442\u044c, \u043a\u0430\u043a\u0430\u044f \u0443 \u0431\u043e\u043b\u044c\u0448\u0438\u043d\u0441\u0442\u0432\u0430 \u0434\u043b\u0438\u043d\u0430 \u043d\u0430\u0433\u043b\u044f\u0434\u043d\u043e, \u043f\u0440\u0438\u043b\u0430\u0433\u0430\u044e \u0433\u0440\u0430\u0444\u0438\u043a.","88d980f3":"\u0421\u0433\u0440\u0443\u043f\u043f\u0438\u0440\u0443\u0435\u043c \u0434\u0430\u0442\u0430\u0441\u0435\u0442 \u043f\u043e \u0442\u0430\u0440\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f groupby() \u043c\u0435\u0442\u043e\u0434 \u0438\u0437 pandas.","96ed3410":"## \u0427\u0430\u0441\u0442\u044c 4: TF - IDF","e150a5ab":"\u041d\u0435\u0441\u043c\u043e\u0442\u0440\u044f \u043d\u0430 \u0442\u043e, \u0447\u0442\u043e \u0432\u0441\u0435 \u0441\u043e\u0432\u043f\u0430\u043b\u043e, \u044d\u0442\u0438 \u0434\u0430\u043d\u043d\u044b\u0435 \u043d\u0435 \u0432\u0430\u043b\u0438\u0434\u043d\u044b \u0431\u0435\u0437 \u0440\u0430\u0437\u0434\u0435\u043b\u0435\u043d\u0438\u044f \u043d\u0430 Test and Train","40d0dd47":"\u0421\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439 \u0448\u0430\u0433, \u044d\u0442\u043e \u0442\u0440\u0430\u043d\u0441\u0444\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u0443\u044e *name4* \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u0442\u0440\u0430\u043d\u0441\u0444\u043e\u0440\u043c\u0435\u0440 \"\u043c\u0435\u0448\u043a\u0430 \u0441\u043b\u043e\u0432\", \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043c\u044b \u0441\u0434\u0435\u043b\u0430\u043b\u0438 \u0440\u0430\u043d\u044c\u0448\u0435.","ee799825":"### EDA","79366753":"What this weird 184 long name is?","bdb224c7":"## \u0427\u0430\u0441\u0442\u044c 7:  \u041f\u0440\u0435\u0434\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u044f","113342da":"Stopwords \u044d\u0442\u043e \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0430 NLTK,\u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 \u0441\u043e\u0431\u0440\u0430\u043d\u044b \u0440\u0430\u0437\u043b\u0438\u0447\u043d\u044b\u0435 \u0441\u043b\u043e\u0432\u0430, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0447\u0430\u0441\u0442\u043e \u043f\u043e\u0432\u0442\u043e\u0440\u044f\u044e\u0442\u0441\u044f \u0432 \u044f\u0437\u044b\u043a\u0435 \u0438 \u043d\u0435 \u043d\u0435\u0441\u0443\u0442 \u043e\u0441\u043e\u0431\u043e\u0439 \u0441\u043c\u044b\u0441\u043b\u043e\u0432\u043e\u0439 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0434\u043b\u044f \u0430\u043d\u0430\u043b\u0438\u0437\u0430.","0fe62caa":"\u0420\u0430\u0437\u043d\u0430\u044f \u0434\u043b\u0438\u043d\u0430 \u043f\u043e\u0437\u0436\u0435 \u0434\u0430\u043b\u0430 \u043c\u043d\u0435 \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u044b\n\u0422\u0430\u043a\u0436\u0435 \u043d\u0430\u0434\u043e \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u043e \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0442\u0430\u0440\u0443 \u0438\u0437 \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043e\u0447\u043d\u043e\u0433\u043e \u0434\u0430\u0442\u0430\u0441\u0435\u0442\u0430 \u0432 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u0443\u044e \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u0443\u044e","b44e11c5":"7 \u0443\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u044b\u0445 \u0441\u043b\u043e\u0432 \u0432 \u043e\u0434\u043d\u043e\u043c \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0438, \u0447\u0442\u043e \u043d\u0435 \u0441\u043e\u0432\u0441\u0435\u043c \u0434\u0430\u0436\u0435 \u0441\u0442\u0440\u0430\u043d\u043d\u043e, \u0435\u0441\u043b\u0438 \u043f\u043e\u0434\u0443\u043c\u0430\u0442\u044c \u043e\u0431 \u044d\u0442\u043e\u043c. \u0417\u0430\u0447\u0435\u043c \u0434\u0432\u0430 \u0440\u0430\u0437\u0430 \u043f\u0438\u0441\u0430\u0442\u044c \u0441\u043b\u043e\u0432\u043e \"\u0427\u0430\u0439\" \u0432 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0438? \u0412 \u043b\u044e\u0431\u043e\u043c \u0441\u043b\u0443\u0447\u0430\u0435, \u0438\u0434\u0435\u043c \u0434\u0430\u043b\u044c\u0448\u0435.\n*\u0445\u043e\u0447\u0443 \u043d\u0430\u043f\u043e\u043c\u043d\u0438\u0442\u044c, \u0447\u0442\u043e \u0432 \u044d\u0442\u043e\u043c \u0441\u043b\u0443\u0447\u0430\u0435, \u043c\u044b \u0443\u0434\u0430\u043b\u0438\u043b \u0432\u0441\u044e \u043f\u0443\u043d\u043a\u0442\u0443\u0430\u0446\u0438\u044e \u0438 \u0441\u0442\u043e\u043f\u0441\u043b\u043e\u0432\u0430*","9380dbb7":"# \u042d\u043f\u0438\u043b\u043e\u0433 \n\u042d\u0442\u043e \u043c\u043e\u0439 \u043f\u0435\u0440\u0432\u044b\u0439 \u0431\u043e\u043b\u044c\u0448\u043e\u0439 \u043a\u0435\u0440\u043d\u0435\u043b, \u0442\u0430\u043a \u0447\u0442\u043e \u044f \u043d\u0430\u0434\u0435\u044e\u0441\u044c, \u0432\u044b\u0433\u043b\u044f\u0434\u0435\u043b\u043e \u0432\u0441\u0435 \u043d\u0435 \u0442\u0430\u043a \u0443\u0436 \u0438 \u043f\u043b\u043e\u0445\u043e, \u0438 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043a\u0442\u043e \u043d\u0438\u0431\u0443\u0434\u044c \u043d\u0430\u0439\u0434\u0435\u0442 \u0447\u0442\u043e \u0442\u043e \u043f\u043e\u043b\u0435\u0437\u043d\u043e\u0435 \u0434\u043b\u044f \u0441\u0435\u0431\u044f. \u0421\u043f\u0430\u0441\u0438\u0431\u043e \u0447\u0442\u043e \u0434\u043e\u0447\u0438\u0442\u0430\u043b\u0438 \u0434\u043e \u043a\u043e\u043d\u0446\u0430, \u0438 \u0435\u0441\u043b\u0438 \u0435\u0441\u0442\u044c \u043a\u0430\u043a\u0438\u0435 \u0442\u043e \u0438\u0434\u0435\u0438 \u0434\u043b\u044f \u0443\u043b\u0443\u0447\u0448\u0435\u043d\u0438\u044f, \u0434\u0435\u043b\u0438\u0442\u0435\u0441\u044c \u0432 \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u044f\u0445\n# \u0421\u043f\u0430\u0441\u0438\u0431\u043e!","eef86e88":"\u0412 \u043f\u0435\u0440\u0432\u0443\u044e \u043e\u0447\u0435\u0440\u0435\u0434\u044c, \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0438\u043c\u043f\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0434\u0430\u0442\u0430\u0441\u0435\u0442\u044b. \u0418\u0445 \u0443 \u043d\u0430\u0441 \u0434\u0432\u0430  train_main \u0438 test_main.","5c815a54":"\u0421\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439 \u0448\u0430\u0433 - \u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u044c \u0434\u0432\u0430 \u0434\u0430\u0442\u0430\u0441\u0435\u0442\u0430 \u0432 \u043e\u0434\u0438\u043d, \u0447\u0442\u043e\u0431\u044b \u0432\u0441\u0435 \u0438\u043c\u0435\u043d\u0430 \u0441\u0440\u0430\u0437\u0443 \u043f\u0440\u043e\u0448\u043b\u0438 \u043f\u0440\u043e\u0446\u0435\u0434\u0443\u0440\u0443 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f, \u043a\u0440\u043e\u043c\u0435 \u0442\u043e\u0433\u043e \u044f \u0434\u043e\u0431\u0430\u0432\u0438\u043b \u043a\u043e\u043b\u043e\u043d\u043a\u0443 \u201ctrain_or_test\u201d \u0447\u0442\u043e\u0431\u044b \u043e\u0442\u043b\u0438\u0447\u0438\u0442\u044c \u0438\u043c\u0435\u043d\u0430 \u0438\u0437 train \u0438 \u0438\u0437 test","588a4917":"This is a fork of my another kernel, but all annotation are in Russian. Other than that, everything is the same.","78a5c572":"\u0412 \u044d\u0442\u043e\u0442 \u043c\u043e\u043c\u0435\u043d\u0442 \u044f \u0432\u0441\u043f\u043e\u043c\u043d\u0438\u043b, \u0447\u0442\u043e \u043c\u043d\u0435 \u043d\u0430\u0434\u043e \u0431\u0443\u0434\u0435\u0442 \u043a\u0430\u043a \u0442\u043e \u043e\u0442\u043b\u0438\u0447\u0438\u0442\u044c \u0434\u0432\u0430 \u0434\u0430\u0442\u0430\u0441\u0435\u0442\u0430, \u043d\u0435\u0441\u043c\u043e\u0442\u0440\u044f \u043d\u0430 \u0442\u043e, \u0447\u0442\u043e \u043e\u043d\u0438 \u0432 \u043e\u0434\u043d\u043e\u043c, \u0438 \u0447\u0442\u043e\u0431\u044b \u043d\u0435 \u043f\u043e\u043c\u0435\u0448\u0430\u0442\u044c \u043d\u043e\u0440\u043c\u0430\u043b\u044c\u043d\u043e\u0439 \u0440\u0430\u0431\u043e\u0442\u0435 \u0430\u043b\u0433\u043e\u0440\u0438\u0442\u043c\u0430.\n**\n\u042f \u0433\u043e\u0432\u043e\u0440\u044e \u043e \u0440\u0430\u0437\u043d\u043e\u043c \u0440\u0430\u0437\u043c\u0435\u0440\u0435 \u0434\u0430\u0442\u0430\u0441\u0435\u0442\u043e\u0432, \u0447\u0442\u043e \u043d\u0435 \u0434\u0430\u0441\u0442 \u043c\u043d\u0435 \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043c\u043e\u0434\u0435\u043b\u044c, \u0442\u0430\u043a \u043a\u0430\u043a \u0442\u0430\u0440\u044b \u0435\u0441\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0434\u043b\u044f \u0442\u0440\u0435\u043d\u0438\u0440\u043e\u0432\u043e\u0447\u043d\u043e\u0433\u043e \u0441\u0435\u0442\u0430.\n**","ebb9533e":"## \u0417\u0434\u0435\u0441\u044c \u044f \u043f\u043e\u043f\u044b\u0442\u0430\u044e\u0441\u044c \u043f\u0435\u0440\u0435\u0432\u0435\u0441\u0442\u0438 \u043d\u0430\u0438\u0431\u043e\u043b\u0435\u0435 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e, \u043d\u043e \u043e\u0448\u0438\u0431\u043e\u043a \u043d\u0435 \u0438\u0441\u043a\u043b\u044e\u0447\u0430\u044e.\n\n\u041f\u043e\u0441\u043b\u0435 \u043f\u043e\u0434\u0441\u0447\u0435\u0442\u0430, \u0432\u0437\u0432\u0435\u0448\u0438\u0432\u0430\u043d\u0438\u0435 \u0438 \u043e\u043f\u0442\u0438\u043c\u0438\u0437\u0430\u0446\u0438\u044f \u0442\u0435\u043a\u0441\u0442\u0430 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u0441\u0434\u0435\u043b\u0430\u043d\u0430 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e [TF-IDF](https:\/\/ru.wikipedia.org\/wiki\/TF-IDF), \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u0432\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u044b\u0439 \u0432  scikit-learn's `TfidfTransformer`\n____\n### \u0427\u0442\u043e \u0442\u0430\u043a\u043e\u0435 TF - IDF?\n\nTF-IDF (\u043e\u0442 \u0430\u043d\u0433\u043b. TF \u2014 term frequency, IDF \u2014 inverse document frequency) \u2014 \u0441\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u043c\u0435\u0440\u0430, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u0430\u044f \u0434\u043b\u044f \u043e\u0446\u0435\u043d\u043a\u0438 \u0432\u0430\u0436\u043d\u043e\u0441\u0442\u0438 \u0441\u043b\u043e\u0432\u0430 \u0432 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0435 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430, \u044f\u0432\u043b\u044f\u044e\u0449\u0435\u0433\u043e\u0441\u044f \u0447\u0430\u0441\u0442\u044c\u044e \u043a\u043e\u043b\u043b\u0435\u043a\u0446\u0438\u0438 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u043e\u0432 \u0438\u043b\u0438 \u043a\u043e\u0440\u043f\u0443\u0441\u0430. \u0412\u0435\u0441 \u043d\u0435\u043a\u043e\u0442\u043e\u0440\u043e\u0433\u043e \u0441\u043b\u043e\u0432\u0430 \u043f\u0440\u043e\u043f\u043e\u0440\u0446\u0438\u043e\u043d\u0430\u043b\u0435\u043d \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u0443 \u0443\u043f\u043e\u0442\u0440\u0435\u0431\u043b\u0435\u043d\u0438\u044f \u044d\u0442\u043e\u0433\u043e \u0441\u043b\u043e\u0432\u0430 \u0432 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0435, \u0438 \u043e\u0431\u0440\u0430\u0442\u043d\u043e \u043f\u0440\u043e\u043f\u043e\u0440\u0446\u0438\u043e\u043d\u0430\u043b\u0435\u043d \u0447\u0430\u0441\u0442\u043e\u0442\u0435 \u0443\u043f\u043e\u0442\u0440\u0435\u0431\u043b\u0435\u043d\u0438\u044f \u0441\u043b\u043e\u0432\u0430 \u0432\u043e \u0432\u0441\u0435\u0445 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0445 \u043a\u043e\u043b\u043b\u0435\u043a\u0446\u0438\u0438.\n\n\u041e\u0434\u043d\u0430 \u0438\u0437 \u0441\u0430\u043c\u044b\u0445 \u043f\u0440\u043e\u0441\u0442\u044b\u0445 \u0444\u0443\u043d\u043a\u0446\u0438\u0439 \u043f\u043e \u0440\u0430\u043d\u0436\u0438\u0440\u043e\u0432\u043a\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u0442\u0441\u044f \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u0440\u0430\u0441\u0447\u0435\u0442\u0430 tf-idf \u043d\u0430 \u043a\u0430\u0436\u0434\u044b\u0439 \u0442\u0435\u0440\u043c\u0438\u043d, \u0434\u0440\u0443\u0433\u0438\u0435 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442 \u0440\u0430\u0437\u043b\u0438\u0447\u043d\u044b\u0435 \u0432\u0430\u0440\u0438\u0430\u043d\u0442\u044b \u044d\u0442\u043e\u0439 \u043c\u043e\u0434\u0435\u043b\u0438\n\n\u041e\u0431\u044b\u0447\u043d\u043e \u0432\u0435\u0441 tf-idf \u0440\u0430\u0441\u0441\u0447\u0438\u0442\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u0438\u0437 \u0434\u0432\u0443\u0445 \u0442\u0435\u0440\u043c\u0438\u043d\u043e\u0432: \u043f\u0435\u0440\u0432\u044b\u043c \u0441\u0447\u0438\u0442\u0430\u0435\u0442\u0441\u044f \u043d\u043e\u0440\u043c\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d\u043d\u0430\u044f \u0447\u0430\u0441\u0442\u043e\u0442\u0430 \u0442\u0435\u0440\u043c\u0438\u043d\u0430, \u0442\u043e \u0435\u0441\u0442\u044c \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0440\u0430\u0437 \u0441\u043b\u043e\u0432\u043e \u0443\u043f\u043e\u043c\u0438\u043d\u0430\u0435\u0442\u0441\u044f \u0432 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0435, \u0440\u0430\u0437\u0434\u0435\u043b\u0435\u043d\u043d\u043e\u0435 \u043d\u0430 \u043e\u0431\u0449\u0435\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0441\u043b\u043e\u0432 \u0432 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0435. \u0421\u043b\u0435\u0434\u043e\u043c \u0441\u0447\u0438\u0442\u0430\u0435\u0442\u0441\u044f Inverse Document Frequency (IDF)* \u0441\u043b\u043e\u0436\u043d\u043e \u043f\u0435\u0440\u0435\u0432\u0435\u0441\u0442\u0438 \u043d\u0430 \u0440\u0443\u0441\u0441\u043a\u0438\u0439* , \u0441\u0447\u0438\u0442\u0430\u044e\u0449\u0438\u0439\u0441\u044f \u043a\u0430\u043a \u043b\u043e\u0433\u0430\u0440\u0438\u0444\u043c \u043e\u0442 \u0447\u0438\u0441\u043b\u0430 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u043e\u0432 \u0432 \u043a\u043e\u0440\u043f\u0443\u0441\u0435 \u0440\u0430\u0437\u0434\u0435\u043b\u0435\u043d\u043d\u044b\u0439 \u043d\u0430 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u043e\u0432, \u0433\u0434\u0435 \u0432\u0441\u0442\u0440\u0435\u0447\u0430\u0435\u0442\u0441\u044f \u044d\u0442\u043e\u0442 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u044b\u0439 \u0442\u0435\u0440\u043c\u0438\u043d\n\n**TF: Term Frequency**, \u0438\u0437\u043c\u0435\u0440\u044f\u0435\u0442 \u043a\u0430\u043a \u0447\u0430\u0441\u0442\u043e \u0442\u0435\u0440\u043c\u0438\u043d \u0432\u0441\u0442\u0440\u0435\u0447\u0430\u0435\u0442\u0441\u044f \u0432 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0435. \u0422\u0430\u043a \u043a\u0430\u043a \u043a\u0430\u0436\u0434\u044b\u0439 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442 \u0438\u043c\u0435\u0435\u0442 \u0440\u0430\u0437\u043d\u0443\u044e \u0434\u043b\u0438\u043d\u0443, \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u0447\u0442\u043e \u0442\u0435\u0440\u043c\u0438\u043d \u043f\u043e\u044f\u0432\u0438\u0442\u0441\u044f \u0431\u043e\u043b\u044c\u0448\u0435 \u0432 \u0431\u043e\u043b\u0435\u0435 \u043a\u0440\u0443\u043f\u043d\u044b\u0445 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0445, \u0447\u0435\u043c \u0432 \u043a\u043e\u0440\u043e\u0442\u043a\u0438\u0445. \u0412\u0441\u043b\u0435\u0434\u0441\u0442\u0432\u0438\u0435 \u044d\u0442\u043e\u0433\u043e, *TF* \u0447\u0430\u0441\u0442\u043e \u0434\u0435\u043b\u044f\u0442 \u043d\u0430 \u0434\u043b\u0438\u043d\u0443 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430 ( \u043e\u0431\u0449\u0435\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0442\u0435\u0440\u043c\u0438\u043d\u043e\u0432 \u0432 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0435 ) \u0447\u0442\u043e\u0431\u044b \u043d\u043e\u0440\u043c\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u0442\u044c.\n\n*TF(t) = (\u0421\u043a\u043e\u043b\u044c\u043a\u043e \u0440\u0430\u0437 \u0442\u0435\u0440\u043c\u0438\u043d t \u0432\u0441\u0442\u0440\u0435\u0447\u0430\u0435\u0442\u0441\u044f \u0432 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0435) \/ (\u041e\u0431\u0449\u0435\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0442\u0435\u0440\u043c\u0438\u043d\u043e\u0432 \u0432 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0435).*\n\n\n**IDF: Inverse Document Frequency**, which measures how important a term is. While computing TF, all terms are considered equally important. However it is known that certain terms, such as \"is\", \"of\", and \"that\", may appear a lot of times but have little importance. Thus we need to weigh down the frequent terms while scale up the rare ones, by computing the following: \n\n*IDF(t) = log_e(Total number of documents \/ Number of documents with term t in it).*\n\n**IDF: Inverse Document Frequency**, \u0438\u0437\u043c\u0435\u0440\u044f\u0435\u0442 \u043d\u0430\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0432\u0430\u0436\u0435\u043d \u0442\u0435\u0440\u043c\u0438\u043d. \u041a\u043e\u0433\u0434\u0430 \u0438\u0437\u043c\u0435\u0440\u044f\u0435\u0442\u0441\u044f TF, \u0432\u0441\u0435 \u0442\u0435\u0440\u043c\u0438\u043d\u044b \u0441\u0447\u0438\u0442\u0430\u044e\u0442\u0441\u044f \u043e\u0434\u0438\u043d\u0430\u043a\u043e\u0432\u043e.  \u041e\u0434\u043d\u0430\u043a\u043e, \u0438\u0437\u0432\u0435\u0441\u0442\u043d\u043e,\u0447\u0442\u043e \u043d\u0435\u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0442\u0435\u0440\u043c\u0438\u043d\u044b \"\u0438\", \"\u0438\u043b\u0438\", \"\u043d\u0430\", \u0432\u0441\u0442\u0440\u0435\u0447\u0430\u044e\u0442\u0441\u044f \u0447\u0430\u0449\u0435, \u043d\u043e \u0438\u043c\u0435\u044e\u0442 \u043c\u0430\u043b\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435. \u0418 \u043f\u043e\u044d\u0442\u043e\u043c\u0443 \u043d\u0430\u043c \u043d\u0430\u0434\u043e \u0441\u043d\u0438\u0437\u0438\u0442\u044c \u0432\u0435\u0441 \u044d\u0442\u0438\u0445 \u0441\u043b\u043e\u0432, \u043f\u043e\u0434\u043d\u044f\u0432 \u0432\u0435\u0441 \u0431\u043e\u043b\u0435\u0435 \u0440\u0435\u0434\u043a\u0438\u0445, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0443\u044e \u0444\u043e\u0440\u043c\u0443\u043b\u0443:\n\n*IDF(t) = log_e(\u041e\u0431\u0449\u0435\u0435 \u0447\u0438\u0441\u043b\u043e \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u043e\u0432\/ \u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u043e\u0432 \u0441 \u0442\u0435\u0440\u043c\u0438\u043d\u043e\u043c t \u0432 \u043d\u0438\u0445).*\n\n\u041f\u0440\u043e\u0441\u0442\u043e\u0439 \u043f\u0440\u0438\u043c\u0435\u0440\n\n**\u041f\u0440\u0438\u043c\u0435\u0440:**\n\n\u0415\u0441\u043b\u0438 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 100 \u0441\u043b\u043e\u0432, \u0438 \u0441\u043b\u043e\u0432\u043e \u00ab\u0437\u0430\u044f\u0446\u00bb \u0432\u0441\u0442\u0440\u0435\u0447\u0430\u0435\u0442\u0441\u044f \u0432 \u043d\u0451\u043c 3 \u0440\u0430\u0437\u0430, \u0442\u043e \u0447\u0430\u0441\u0442\u043e\u0442\u0430 \u0441\u043b\u043e\u0432\u0430 (TF) \u0434\u043b\u044f \u0441\u043b\u043e\u0432\u0430 \u00ab\u0437\u0430\u044f\u0446\u00bb \u0432 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0435 \u0431\u0443\u0434\u0435\u0442 0,03 (3\/100). \n\n\u0412\u044b\u0447\u0438\u0441\u043b\u0438\u043c IDF \u043a\u0430\u043a \u0434\u0435\u0441\u044f\u0442\u0438\u0447\u043d\u044b\u0439 \u043b\u043e\u0433\u0430\u0440\u0438\u0444\u043c \u043e\u0442\u043d\u043e\u0448\u0435\u043d\u0438\u044f \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u0430 \u0432\u0441\u0435\u0445 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u043e\u0432 \u043a \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u0443 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u043e\u0432 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0449\u0438\u0445 \u0441\u043b\u043e\u0432\u043e \u00ab\u0437\u0430\u044f\u0446\u00bb.\n\n\u0422\u0430\u043a\u0438\u043c \u043e\u0431\u0440\u0430\u0437\u043e\u043c, \u0435\u0441\u043b\u0438 \u00ab\u0437\u0430\u044f\u0446\u00bb \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442\u0441\u044f \u0432 1000 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0445 \u0438\u0437 10 000 000 \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u043e\u0432, \u0442\u043e IDF \u0431\u0443\u0434\u0435\u0442 \u0440\u0430\u0432\u043d\u043e\u0439: log(10 000 000\/1000) = 4. \n\n\u0414\u043b\u044f \u0440\u0430\u0441\u0447\u0435\u0442\u0430 \u043e\u043a\u043e\u043d\u0447\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0433\u043e \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u0432\u0435\u0441\u0430 \u0441\u043b\u043e\u0432\u0430 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e TF \u0443\u043c\u043d\u043e\u0436\u0438\u0442\u044c \u043d\u0430 IDF. \n\n\u0412 \u0434\u0430\u043d\u043d\u043e\u043c \u043f\u0440\u0438\u043c\u0435\u0440\u0435, TF-IDF \u0432\u0435\u0441 \u0434\u043b\u044f \u0441\u043b\u043e\u0432\u0430 \u00ab\u0437\u0430\u044f\u0446\u00bb \u0432 \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u043e\u043c \u0434\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0435 \u0431\u0443\u0434\u0435\u0442 \u0440\u0430\u0432\u0435\u043d: 0,03 \u00d7 4 = 0,12.\n____\n\n\u041f\u043e\u0439\u0434\u0435\u043c \u0434\u0430\u043b\u044c\u0448\u0435 \u0438 \u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0438\u043c, \u043a\u0430\u043a \u044d\u0442\u043e \u043c\u043e\u0436\u043d\u043e \u0441\u0434\u0435\u043b\u0430\u0442\u044c \u0432 ScikitLearn:","af4e4f6c":"\u0427\u0442\u043e\u0431\u044b \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u044f\u0442\u044c \u043a\u0430\u043a\u0430\u044f \u0443 \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044f \u0434\u043b\u0438\u043d\u0430, \u044f \u0434\u043e\u0431\u0430\u0432\u0438\u043b \u043a\u043e\u043b\u043e\u043d\u043a\u0443 *length* \u043a \u0434\u0430\u0442\u0430\u0441\u0435\u0442\u0443, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f len()","3a91bc05":"\u041f\u043e\u043d\u0438\u043c\u0430\u0435\u0442\u0435, \u043e \u0447\u0435\u043c \u044f? \u042d\u0442\u0438 \u043d\u043e\u043c\u0435\u0440\u0430 \u0432\u043c\u0435\u0441\u0442\u043e \u0441\u043b\u043e\u0432 \u043d\u0435 \u0438\u043c\u0435\u044e\u0442 \u043d\u0438\u043a\u0430\u043a\u043e\u0433\u043e \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f, \u043d\u043e \u044f \u0432\u0441\u0435 \u0440\u0430\u0432\u043d\u043e \u0440\u0435\u0448\u0438\u043b \u0438\u0434\u0442\u0438 \u0434\u0430\u043b\u044c\u0448\u0435.","24b4e856":"\u0412\u0441\u0435\u043c \u043f\u0440\u0438\u0432\u0435\u0442. \u0417\u0430\u0434\u0430\u0447\u0430 \u0434\u0430\u043d\u043d\u043e\u0433\u043e \u0434\u0430\u0442\u0430\u0441\u0435\u0442\u0430 \u0432 \u0442\u043e\u043c, \u0447\u0442\u043e\u0431\u044b \u0441\u043f\u0440\u043e\u0433\u043d\u043e\u0437\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0442\u0430\u0440\u0443 \u0434\u043b\u044f \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u043e\u0432 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u0438\u0445 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044f.\n\u0421 \u044d\u0442\u043e\u0439 \u0437\u0430\u0434\u0430\u0447\u0435\u0439 \u044f \u043f\u044b\u0442\u0430\u043b\u0441\u044f \u0441\u043f\u0440\u0430\u0432\u0438\u0442\u044c\u0441\u044f \u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e \u0434\u043e\u043b\u0433\u043e, \u043d\u043e \u0432 \u0438\u0442\u043e\u0433\u0435 \u0432\u0441\u0435 \u043f\u043e\u043b\u0443\u0447\u0438\u043b\u043e\u0441\u044c.","027b283e":"\u0414\u043b\u044f \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u0439 \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0438 \u043c\u043d\u0435 \u043f\u043e\u0442\u0440\u0435\u0431\u0443\u0435\u0442\u0441\u044f \u0432\u044b\u0434\u0435\u043b\u0438\u0442\u044c \u043e\u0434\u0438\u043d \u044d\u043b\u0435\u043c\u0435\u043d\u0442, \u043d\u043e \u0442\u0430\u043a \u043a\u0430\u043a \u043a\u0430\u043a\u0438\u043c \u0442\u043e \u043e\u0431\u0440\u0430\u0437\u043e\u043c \u0443 \u043c\u0435\u043d\u044f \u0435\u0441\u0442\u044c \u0434\u0432\u0430 \u044d\u043b\u0435\u043c\u0435\u043d\u0442\u0430 \u0441 \u043e\u0434\u043d\u0438\u043c \u0438\u043d\u0434\u0435\u043a\u0441\u043e\u043c, \u043c\u043d\u0435 \u043f\u0440\u0438\u0448\u043b\u043e\u0441\u044c \u043f\u0440\u0438\u043c\u0435\u043d\u0438\u0442\u044c \u0441\u043c\u0435\u043a\u0430\u043b\u043a\u0443 \u0438 \u0432\u044b\u0431\u043e\u0440\u043a\u0443 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e pandas."}}