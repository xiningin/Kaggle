{"cell_type":{"f0f4c680":"code","a9098c8b":"code","23f4198e":"code","987af696":"code","b93ac521":"code","dd55bca3":"code","f376aeb5":"code","ddbcf254":"code","31823325":"markdown"},"source":{"f0f4c680":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","a9098c8b":"total_time = 8 # hours","23f4198e":"!pip install -U mljar-supervised","987af696":"from supervised.automl import AutoML\nimport pandas as pd","b93ac521":"df = pd.read_csv('..\/input\/tabular-playground-series-apr-2021\/train.csv')\ndf['Embarked'].fillna('U', inplace=True)\ndf['Age'].fillna(df['Age'].mean(), inplace=True)\npid = ['PassengerId']\ncat = ['Pclass', 'Sex', 'Embarked']\ncont = ['Age', 'SibSp', 'Parch']\ntarget = ['Survived']\ndf_train = df[pid+cat+cont+target]","dd55bca3":"df = pd.read_csv('..\/input\/tabular-playground-series-apr-2021\/test.csv')\ndf['Embarked'].fillna('U', inplace=True)\ndf['Age'].fillna(df['Age'].mean(), inplace=True)\npid = ['PassengerId']\ncat = ['Pclass', 'Sex', 'Embarked']\ncont = ['Age', 'SibSp', 'Parch']\ndf_test = df[pid+cat+cont]","f376aeb5":"X_train = df_train[cat+cont]\ny_train = df_train[target]\nX_test = df_test[cat+cont]","ddbcf254":"automl = AutoML(mode='Compete', total_time_limit= total_time * 3600, hill_climbing_steps=3, top_models_to_improve=5, n_jobs=-1, random_state=990121)\nautoml.fit(X_train, y_train)\npreds = automl.predict(X_test)\nsubmission = pd.DataFrame({'PassengerId':df_test.PassengerId, 'Survived': preds})\nsubmission.to_csv('1_submission.csv', index=False)\n","31823325":"# Check out **mljar-supervised**! [Link Here!](https:\/\/supervised.mljar.com\/)"}}