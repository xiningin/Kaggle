{"cell_type":{"39c33ebb":"code","ed6ecd19":"code","55e11c9c":"code","1f4394bd":"code","c0d277d9":"code","4c892be3":"code","02023d1d":"code","f73e6284":"code","c4604e41":"markdown"},"source":{"39c33ebb":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nfrom sklearn.metrics import mean_absolute_error\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.tree import DecisionTreeRegressor\n\n# \/kaggle\/input\/college-basketball-players-20092021\/CollegeBasketballPlayers2022.csv\n# \/kaggle\/input\/college-basketball-players-20092021\/CollegeBasketballPlayers2009-2021.csv\n# \/kaggle\/input\/college-basketball-players-20092021\/DraftedPlayers2009-2021.xlsx\n# \/kaggle\/input\/college-basketball-players-20092021\/modern_RAPTOR_by_player.csv\n# \/kaggle\/input\/college-basketball-players-20092021\/latest_RAPTOR_by_player.csv\n\n# Read data\nall_college_data = pd.read_csv('..\/input\/college-basketball-players-20092021\/CollegeBasketballPlayers2009-2021.csv', low_memory = False)","ed6ecd19":"# Only use drafted players before 2021\ncollege_data = all_college_data.loc[all_college_data['pick'] >= 1].loc[all_college_data['year'] < 2021]\n# Drop duplicates (only use stats from their last year in college)\n    # Can be refined to account for all college stats\ncollege_data.drop_duplicates(subset='player_name', keep='last', inplace=True)","55e11c9c":"# Use basketball reference scraper (credit given in 'Background')\n!pip install basketball-reference-scraper\nfrom basketball_reference_scraper.drafts import get_draft_class","1f4394bd":"# Merge data\ncollege_data.rename({'player_name' : 'PLAYER'},axis='columns',inplace=True)\ncollege_data.rename({'Rec Rank' : 'Rec_Rank'},axis='columns',inplace=True)\n\n# Create a list of panda DataFrames, one for each draft class, merged by player name\nmergedlist = [get_draft_class(i).merge(college_data, on='PLAYER') for i in range(2010, 2022)]\n","c0d277d9":"data.columns","4c892be3":"# Create one dataset for all draft classes from 2010 to 2017\ndata = mergedlist[0]\nfor i in range(1, 8):\n    data.append(mergedlist[i])\n    \n# For players without a Recruiting Rank, fill in empty values with '65'\ndata.Rec_Rank = data.Rec_Rank.fillna(65)\ndata.ADVANCED_WS = data.ADVANCED_WS.fillna(-1)\ndata.YEARS = data.YEARS.fillna(0)\n# data = data.fillna(0)","02023d1d":"# Create model\nmodel = DecisionTreeRegressor(max_leaf_nodes=800, random_state=1)\n# Set the features\nfeatures = ['year', 'YEARS', 'Rec_Rank', 'porpag', 'dporpag', 'FT_per', 'bpm', 'AST_per', 'usg']\n   \n# Set target to be advanced win shares\ny = data.ADVANCED_WS\n# Create X\nX = data[features]\n    \n# Split data into training and validation\ntrain_X, val_X, train_y, val_y = train_test_split(X, y, random_state=1)\n\n# Fit model to the data\nmodel.fit(train_X, train_y)\n\n# Create validation predictions for each year\nval_preds = model.predict(val_X)\nval_mae = mean_absolute_error(val_preds, val_y)\nprint(\" Validation MAE: {:,.5f}\".format(val_mae))\n\nmodel.get_params()","f73e6284":"# Test model using 2018 data\ndata2018 = mergedlist[8]\n\n# For players without a Recruiting Rank, fill in empty values with '65'\ndata2018.Rec_Rank = data2018.Rec_Rank.fillna(65)\ndata2018.ADVANCED_WS = data2018.ADVANCED_WS.fillna(-1)\ndata2018.YEARS = data2018.YEARS.fillna(0)\n\ntest2018 = data2018[features]\n\npreds2018 = model.predict(test2018)\n\noutput = pd.DataFrame({'Name': data2018.PLAYER, 'WS Preds': preds2018, 'WS Actual' : data2018.ADVANCED_WS})\noutput.to_csv('predictions2018.csv', index=False)\n\nmae_2018 = mean_absolute_error(preds2018, data2018.ADVANCED_WS)\nprint(\"2018 Testing MAE: {:,.5f}\".format(mae_2018))\n\noutput.head(60)","c4604e41":"# Background\n\nUsing College Statistics to predict an NBA career is a goal of many avid NBA fans, reporters, teams, and analysts. College players are often described as \"boom or bust\", meaning they have a chance of becoming a superstar while simultaneously having a chance of failing to meet any expectations.\n\nI plan on using College Statistics from Bart Torvik to form a model on all American D1 College Players who have been drafted into the NBA.\nAdditionally, I used https:\/\/github.com\/vishaalagartha\/basketball_reference_scraper to scrape data from Basketball Reference for each draft class. I used Win Shares, a statistic that essentially measures how much a player contributes to his team's wins. Although this statistic has its flaws, it is overall a solid estimation of how good a player is."}}