{"cell_type":{"d4d1afb5":"code","06dee0b2":"code","50630f1e":"code","6ec88436":"code","ee842094":"code","569201fa":"code","3a25656e":"code","3a214442":"code","28710c32":"code","8010b806":"code","c924387c":"code","c24cd139":"code","100d153a":"code","936dfd41":"code","59272921":"markdown","48636b5a":"markdown","4010fdf2":"markdown","db02af1f":"markdown","97282a3f":"markdown","f994fb47":"markdown","3e406d2e":"markdown","47608408":"markdown","88163ca3":"markdown","2c2d1903":"markdown","f12eebca":"markdown","6b68b09d":"markdown","5b7c77b7":"markdown","159c1b29":"markdown"},"source":{"d4d1afb5":"import numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nfrom sklearn.metrics import (accuracy_score,\n                             roc_auc_score,\n                             confusion_matrix,\n                             roc_curve,\n                             auc)\n\nplt.style.use(\"fivethirtyeight\")","06dee0b2":"reais = np.array([1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1])\n\npreditos = np.array([1, 0, 1, 0, 0, 1, 0, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 1, 1, 0, 1, 0, 1, 1, 0, 1, 0, 1, 0, 0, 0, 1])","50630f1e":"accuracy_score(reais, preditos)","6ec88436":"cf_matrix = confusion_matrix(reais, preditos)","ee842094":"labels = ['Verdadeiro Negativo', 'Falso Positivo', 'Falso Negativo', 'Verdadeiro Positivo']\nlabels = np.asarray(labels).reshape(2,2)\nsns.heatmap(cf_matrix, annot=labels, fmt='')\nplt.xlabel('Predito')\nplt.ylabel('Real');","569201fa":"sns.heatmap(cf_matrix, annot=True)\nplt.xlabel('Predito')\nplt.ylabel('Real')\nplt.show();","3a25656e":"TP = 15\nTN = 12\nFP = 2\nFN = 4","3a214442":"acuracia = (TP + TN) \/ (TP + TN + FP+ FN)\nacuracia","28710c32":"precisao = TP \/ (TP + FP)\nprecisao","8010b806":"revocacao = TP \/ (TP + FN)\nrevocacao","c924387c":"taxa_falso_positivo = FP \/ (FP + TN)\ntaxa_falso_positivo","c24cd139":"taxa_verdadeiro_positivo = TP \/ (TP + FN)\ntaxa_verdadeiro_positivo","100d153a":"roc_auc_score(reais, preditos)","936dfd41":"fpr = dict()\ntpr = dict()\nroc_auc = dict()\n\nfor i in range(2):\n    fpr[i], tpr[i], _ = roc_curve(reais, preditos)\n    roc_auc[i] = auc(fpr[i], tpr[i])\n\nprint (roc_auc_score(reais, preditos))\nplt.figure(figsize=(8, 5))\nplt.plot(fpr[1], tpr[1])\nplt.xlim([0.0, 1.0])\nplt.ylim([0.0, 1.05])\nplt.xlabel('Taxa de Falso Positivo')\nplt.ylabel('Taxa de Verdadeiro Positivo')\nplt.title('ROC')\nplt.show()","59272921":"Vamos agora entender melhor a m\u00e9trica AUCROC:\n\n* AUCROC(Area Under the Curve ROC) \u00e9 o valor que usaremos para avaliar um modelo;\n\n* ROC(Receiver Operator Characteristic) \u00e9 o gr\u00e1fico da Taxa de Veradeiro Positivo x Taxa de Falso Positivo;\n\n* Perceba que Taxa de Verdadeiro Positivo \u00e9 a revoca\u00e7\u00e3o!\n\nConstru\u00edmos essa curva da seguinte maneira:\n\n\n1) Calcula-se as chances da classe ser verdadeira;\n\n2) Ordena-se da maior probabilidade para a menor;\n\n3) Inicia-se no limite esquerdo do gr\u00e1fico, se a observa\u00e7\u00e3o mais prov\u00e1vel estiver correta, vai para cima e, se estiver errada, vai para a direita.\n\n4) Realiza-se o processo para todas as observa\u00e7\u00f5es e, ao final, teremos constru\u00eddo a curva ROC.\n\nA m\u00e9trica de avalia\u00e7\u00e3o AUC ser\u00e1 valor da \u00e1rea sobre essa curva ROC. \u00c9 uma probabilidade e, quanto mais pr\u00f3xima de 1, melhor! Consequentemente, quanto mais o gr\u00e1fico se aproximar do canto superior esquerdo, melhor ser\u00e1!","48636b5a":"81.8% de acerto! - Mas ser\u00e1 que que o nosso modelo \u00e9 bom?\n\nNesse caso, essa m\u00e9trica n\u00e3o \u00e9 adequada! \n\nAo diagnosticar uma pessoa como portadora de c\u00e2ncer, o modelo indica que essa pessoa procure um oncologista para confirmar o diagn\u00f3stico:\n\n* Se de fato o diagn\u00f3stico se confirmar, ponto para o modelo! \n\n* Caso o contr\u00e1rio, o maior custo foi uma visita m\u00e9dica.\n\nJ\u00e1 se nosso modelo prever que a pessoa n\u00e3o possui c\u00e2ncer, ele n\u00e3o indicar\u00e1 uma consulta ao oncologista:\n\n* Se a pessoa realmente n\u00e3o tiver c\u00e2ncer, ponto para o modelo!\n\n* Caso o contr\u00e1rio, as consequ\u00eancias podem ser muito danosas, podendo impedir o tratamento precoce do c\u00e2ncer!\n\n\nVeja que existe uma previs\u00e3o que custa muito mais que outra! Errar ao diagnosticar como positivo para c\u00e2ncer n\u00e3o \u00e9 t\u00e3o s\u00e9rio como errar como negativo. Por isso que a acur\u00e1cia muitas vezes n\u00e3o \u00e9 a m\u00e9trica adequada, visto que ela s\u00f3 mede os acertos.\n\nVamos ver a matriz de confus\u00e3o desses dados!","4010fdf2":"Perceba que o maior perigo reside no 3\u00ba quadrante(Falso Negativo).","db02af1f":"Essa \u00e9 a ROC para nosso exemplo!\n\nTendo um modelo constru\u00eddo, uma boa op\u00e7\u00e3o \u00e9 usar a ROCAUC da biblioteca Yellowbrick. \u00c9 f\u00e1cil visualizar e comparar os resultados!\n\nVeja abaixo um exemplo que usou a biblioteca Yellowbrick!","97282a3f":"# AUCROC - START","f994fb47":"Vamos ver como interpretrar a precis\u00e3o(precision) e a revoca\u00e7\u00e3o(recall ou sensibilidade):\n\n\n* Precis\u00e3o: Dos exemplos classificados como positivos, ela nos diz quantos realmente s\u00e3o positivos;\n\n* Revoca\u00e7\u00e3o: De todos os exemplos positivos, ela nos diz quantos foram classificados corretamente como positivos.\n\nPortanto, ter uma alta revoca\u00e7\u00e3o \u00e9 muito importante nesse problema!","3e406d2e":"Hello, world!\n\nNesse notebook vamos entender melhor como funciona a m\u00e9trica de avalia\u00e7\u00e3o usada no desafio Falconi, a AUCROC!","47608408":"That's all folks!\n\n-------------------------------------- END --------------------------------------","88163ca3":"Vamos calcular a acur\u00e1cia do modelo nessas 33 predi\u00e7\u00f5es!","2c2d1903":"![img_01_auc.png](attachment:2814f831-5cf6-49b8-8972-9b4e50af68d4.png)","f12eebca":"Temos:\n\n* paciente possui c\u00e2ncer: 1\n\n* paciente n\u00e3o possui c\u00e2ncer: 0\n\nImagine que nosso modelo operou por um per\u00edodo de tempo e, nesse intervalo, analisou 33 pacientes.","6b68b09d":"Vamos entender o motivo de usarmos essa m\u00e9trica e n\u00e3o a acur\u00e1cia!\n\nA acur\u00e1cia \u00e9 definida como o total de predi\u00e7\u00f5es corretas divido pelo total de observa\u00e7\u00f5es, matematicamente:\n\nN: n\u00famero total de observa\u00e7\u00f5es\n\nc: n\u00famero de observa\u00e7\u00f5es classificadas corretamente\n\nacuracia = c \/ N\n\nPerceba que essa m\u00e9trica esconde algumas informa\u00e7\u00f5es importantes. \n\nVamos criar um exemplo para melhor visualizarmos o que exatamente a acur\u00e1cia esconde!\n\nImagine que voc\u00ea est\u00e1 desenvolvendo um modelo para auxiliar no diagn\u00f3stico de c\u00e2ncer, ele classifica se o paciente tem ou n\u00e3o c\u00e2ncer e, em caso positivo, indica uma consulta com um oncologista. \n\nVamos ver o que pode acontecer se a m\u00e9trica usada for somente a acur\u00e1cia.","5b7c77b7":"![img_02_auc.png](attachment:628b379f-4584-4bb6-a4e6-3cd9877d36cd.png)","159c1b29":"Vamos calcular essa \u00e1rea!"}}