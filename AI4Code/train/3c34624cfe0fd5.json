{"cell_type":{"8e51f8d8":"code","ca9bcb3a":"code","9abc1016":"code","fa296e2e":"code","798aa6ff":"code","c9296609":"code","60bc6d9f":"code","b2179548":"code","618b3f99":"code","bb568d18":"code","93899241":"code","f162315b":"code","2a4f0834":"code","b8bbdda6":"code","a781f30e":"code","35ac88c5":"code","8d7794fc":"code","de006c42":"code","5979650f":"code","876daab2":"code","da0f51d1":"code","ffeaff5c":"code","2f1df6fe":"code","fe9c9ff1":"code","c7678050":"code","db87b646":"code","e505eeab":"code","4e5fa686":"code","1a8c02f3":"code","4c0a6a6d":"code","688ddf95":"code","8708a0a6":"code","6a44b1c8":"code","87ffdcdc":"code","cb8fbfb0":"code","f9795504":"code","f403aca3":"code","e5ff6273":"code","3a47aa59":"code","e3d1349b":"code","fd00ebb9":"code","e2314b58":"code","2c8ece96":"code","1d3e1678":"code","a76daefd":"code","43125a62":"markdown","52ee231d":"markdown","fd836b27":"markdown","e80ffe01":"markdown","5ab42667":"markdown","290f4f2c":"markdown","afdf570c":"markdown","7d23b15d":"markdown","185eef2c":"markdown","f29ff62d":"markdown","4d04477c":"markdown","ba1e8582":"markdown","405c41d5":"markdown","6781caef":"markdown","02ccbd49":"markdown","3f06f52e":"markdown"},"source":{"8e51f8d8":"import pandas as pd\nimport numpy as np\nimport seaborn as sb\nimport matplotlib.pyplot as plt\nimport missingno as msno\n\nimport warnings \nwarnings.simplefilter('ignore')\n\nplt.style.use(\"dark_background\")\n%matplotlib inline","ca9bcb3a":"df = pd.read_csv('..\/input\/pima-indians-diabetes-database\/diabetes.csv')","9abc1016":"df.head(10)","fa296e2e":"df.shape","798aa6ff":"df.info()","c9296609":"df.describe().T.style.bar(subset=['mean'], color='#205fA2').background_gradient(subset=['std'], cmap='Reds').background_gradient(subset=['50%'], cmap='cividis')","60bc6d9f":"feat = df.columns\ncol = (df[feat]==0).sum()\nprint(col)","b2179548":"df[['Glucose','BloodPressure','SkinThickness','Insulin','BMI']] = df[['Glucose','BloodPressure','SkinThickness','Insulin','BMI']].replace(0,np.NaN)","618b3f99":"df.isnull().sum()","bb568d18":"msno.matrix(df[['Glucose','BloodPressure','SkinThickness','Insulin','BMI']], figsize=(12,8))\nplt.grid()","93899241":"df['Glucose'].fillna(df['Glucose'].median(), inplace=True)\ndf['BloodPressure'].fillna(df['BloodPressure'].median(), inplace=True)\ndf['BMI'].fillna(df['BMI'].median(), inplace=True)","f162315b":"Glucose_Age_Insulin = df.groupby(['Glucose'])\ndef fillna_insulin(series):\n    return series.fillna(series.median())\ndf['Insulin'] = Glucose_Age_Insulin['Insulin'].transform(fillna_insulin)\ndf['Insulin'] = df['Insulin'].fillna(df['Insulin'].mean())","2a4f0834":"df['SkinThickness'].fillna(df['SkinThickness'].median(),inplace=True)","b8bbdda6":"df.isnull().sum()","a781f30e":"df.isnull().values.any()","35ac88c5":"from matplotlib.pyplot import figure, show\nplt.style.use(\"ggplot\")\nfigure(figsize=(7,4))\nax = sb.countplot(x=df['Outcome'], data=df,palette=\"husl\", edgecolor='black', lw=3)\nax.set_xticklabels([\"Healthy\",\"Diabetic\"])\nhealthy, diabetics = df['Outcome'].value_counts().values\nprint(\"Number of healthy people = \",healthy)\nprint(\"Number of diabetic people = \",diabetics)","8d7794fc":"plt.style.use(\"dark_background\")\nlabels = ['Healthy','Diabetic']\ndf['Outcome'].value_counts().plot(kind='pie',labels=labels,subplots=True,autopct='%10.0f%%',labeldistance=2,figsize=(3,3))","de006c42":"plt.style.use(\"dark_background\")\nsb.pairplot(df, hue=\"Outcome\",palette=\"dark\")","5979650f":"plt.style.use(\"dark_background\")\nplt.figure(dpi=90,figsize=(4,4))\nmask = np.triu(np.ones_like(df.corr(),dtype=bool))\nsb.heatmap(df.corr(),mask = mask , fmt=\".1f\", annot=True, lw=1, cmap='BuGn')\nplt.yticks(rotation = 0)\nplt.xticks(rotation = 90)\nplt.title('Correlation Heatmap')\nplt.show()","876daab2":"x = df.iloc[:, :-1].values\ny = df.iloc[:, -1].values","da0f51d1":"from sklearn.model_selection import train_test_split\nxtrain, xtest, ytrain, ytest = train_test_split(x,y,train_size=0.8, random_state=42)","ffeaff5c":"print(\"xtrain data : \",xtrain.shape)\nprint(\"ytrain data : \",ytrain.shape)\nprint(\"xtest data : \",xtest.shape)\nprint(\"ytest data : \",ytest.shape)","2f1df6fe":"from sklearn.linear_model import LinearRegression","fe9c9ff1":"model = LinearRegression()\nmodel.fit(xtrain,ytrain)\nmodel.score(xtest,ytest)","c7678050":"plt.style.use(\"dark_background\")\nplt.figure()\nax = sb.distplot(df['Pregnancies'][df.Outcome==1],rug=True)\nsb.distplot(df['Pregnancies'][df.Outcome==0],rug=True)\nplt.legend(['Diabetes','No Diabetes'])","db87b646":"plt.style.use(\"dark_background\")\nplt.figure()\nax = sb.distplot(df['Glucose'][df.Outcome==1],rug=True)\nsb.distplot(df['Glucose'][df.Outcome==0],rug =True)\nplt.legend(['Diabetes','No Diabetes'])","e505eeab":"plt.style.use(\"dark_background\")\nplt.figure()\nax = sb.distplot(df['BloodPressure'][df.Outcome==1],rug=True)\nsb.distplot(df['BloodPressure'][df.Outcome==0],rug=True)\nplt.legend(['Diabetes','No Diabetes'])","4e5fa686":"plt.style.use(\"dark_background\")\nplt.figure()\nax = sb.distplot(df['Insulin'][df.Outcome==1],rug=True)\nsb.distplot(df['Insulin'][df.Outcome==0],rug=True)\nplt.legend(['Diabetes','No Diabetes'])","1a8c02f3":"plt.style.use(\"dark_background\")\nplt.figure()\nax = sb.distplot(df['Age'][df.Outcome==1],rug=True)\nsb.distplot(df['Age'][df.Outcome==0],rug=True)\nplt.legend(['Diabetes','No Diabetes'])","4c0a6a6d":"plt.style.use(\"dark_background\")\nplt.figure()\nax = sb.distplot(df['BMI'][df.Outcome==1],rug=True)\nsb.distplot(df['BMI'][df.Outcome==0],rug=True)\nplt.legend(['Diabetes','No Diabetes'])","688ddf95":"plt.style.use(\"dark_background\")\nplt.figure()\nax = sb.distplot(df['SkinThickness'][df.Outcome==1],rug=True)\nsb.distplot(df['SkinThickness'][df.Outcome==0],rug=True)\nplt.legend(['Diabetes','No Diabetes'])","8708a0a6":"plt.style.use(\"dark_background\")\nplt.figure()\nax = sb.distplot(df['DiabetesPedigreeFunction'][df.Outcome==1],rug=True)\nsb.distplot(df['DiabetesPedigreeFunction'][df.Outcome==0],rug=True)\nplt.legend(['Diabetes','No Diabetes'])","6a44b1c8":"from sklearn.preprocessing import StandardScaler\nsc = StandardScaler()\nxtrain = sc.fit_transform(xtrain)\nxtest = sc.transform(xtest)","87ffdcdc":"from sklearn.metrics import confusion_matrix,auc,accuracy_score,classification_report,roc_curve","cb8fbfb0":"from sklearn.svm import SVC\nsvmm = SVC(kernel='rbf')\nsvmm.fit(xtrain,ytrain)","f9795504":"ypred = svmm.predict(xtest)\naccuracy_score(ytest,ypred)","f403aca3":"print(classification_report(ytest,ypred))","e5ff6273":"fpr, tpr,_=roc_curve(ytest,ypred)\nroc_auc = auc(fpr,tpr)\nplt.style.use(\"dark_background\")\nplt.figure()\nplt.plot(fpr,tpr,label='ROC Curve(area=%2.f)'%roc_auc)\nplt.plot([0,1],[0,1],'k--')\nplt.xlim([0.0,1.0])\nplt.ylim([0.0,1.05])\nplt.xlabel(\"False positive rate\")\nplt.ylabel(\"True positive rate\")\nplt.title(\"ROC Curve\")\nplt.legend(loc='lower right')","3a47aa59":"from sklearn.ensemble import RandomForestClassifier\nclassifier = RandomForestClassifier()\nclassifier.fit(xtrain,ytrain)","e3d1349b":"Ypred = classifier.predict(xtest)\naccuracy_score(ytest,Ypred)","fd00ebb9":"print(classification_report(ytest,Ypred))","e2314b58":"fpr, tpr,_=roc_curve(ytest,Ypred)\nroc_auc = auc(fpr,tpr)\nplt.style.use(\"dark_background\")\nplt.figure()\nplt.plot(fpr,tpr,label='ROC Curve(area=%2.f)'%roc_auc)\nplt.plot([0,1],[0,1],'k--')\nplt.xlim([0.0,1.0])\nplt.ylim([0.0,1.05])\nplt.xlabel(\"False positive rate\")\nplt.ylabel(\"True positive rate\")\nplt.title(\"ROC Curve\")\nplt.legend(loc='lower right')","2c8ece96":"from sklearn.neighbors import KNeighborsClassifier\nclf = KNeighborsClassifier(n_neighbors=3)\nclf.fit(xtrain,ytrain)\nprint(clf.score(xtest,ytest))","1d3e1678":"Yypred = clf.predict(xtest)\nprint(classification_report(ytest,Yypred))","a76daefd":"fpr, tpr,_=roc_curve(ytest,Yypred)\nroc_auc = auc(fpr,tpr)\nplt.style.use(\"dark_background\")\nplt.figure()\nplt.plot(fpr,tpr,label='ROC Curve(area=%2.f)'%roc_auc)\nplt.plot([0,1],[0,1],'k--')\nplt.xlim([0.0,1.0])\nplt.ylim([0.0,1.05])\nplt.xlabel(\"False positive rate\")\nplt.ylabel(\"True positive rate\")\nplt.title(\"ROC Curve\")\nplt.legend(loc='lower right')","43125a62":"Distribution of DiabetesPedigreeFunction","52ee231d":"**Random Forest Model**\n\n---\n\n\n\n---\n\n","fd836b27":"**Distribuion**\n\n---\n\n\n\n---\n\n","e80ffe01":"**SVM Model**\n\n---\n\n\n\n---\n\n","5ab42667":"**Preprocessing**\n\n---\n\n\n\n---\n\n","290f4f2c":"Distribution of glucose","afdf570c":"**Spliting the dataset**\n\n\n---\n\n\n\n---","7d23b15d":"**Standard Scaling**\n\n---\n\n\n\n---\n\n","185eef2c":"Distribution of Age","f29ff62d":"**Data Vizualization**\n\n---\n\n\n\n---\n\n","4d04477c":"Distribution of pregnancies\n\n","ba1e8582":"Distribution of bloodPressure","405c41d5":"Distribution of Insulin","6781caef":"**KNN Model**\n\n---\n\n\n\n---\n\n","02ccbd49":"Distribution of SkinThickness","3f06f52e":"Distribution of BMI"}}