{"cell_type":{"9b99e2d2":"code","a445969a":"code","4a08b6e7":"code","a58059f3":"code","4c77a989":"code","30c9cdd0":"code","2b161414":"code","3bc4b100":"code","09a658f1":"code","ca9a0462":"code","9f8534fd":"code","567d0076":"code","15fba1a0":"code","53a47e1b":"code","241102eb":"code","9c722661":"code","c7af6385":"code","6040ad98":"code","afd79ef9":"code","f70eeb5e":"code","90fdb648":"code","d0aed801":"code","2321c717":"code","3c3b2668":"code","d5181542":"code","1856f91b":"code","a7019e13":"code","b375bc57":"code","3e01ce83":"code","c7f21832":"code","bb3f27d6":"code","136d8fe0":"code","b7a55366":"markdown","7676df95":"markdown","b02e0372":"markdown","bcc4be71":"markdown","0b0359fd":"markdown","839623d5":"markdown","d1b2872a":"markdown","45c91ea5":"markdown","6f6e108a":"markdown","d0255593":"markdown","17d1d6b2":"markdown","ef460aa8":"markdown","68fb31fc":"markdown","d7da32d4":"markdown","5c079a9f":"markdown","74b4bc7a":"markdown","671a7a9f":"markdown","bbdf9e4d":"markdown","c27ff936":"markdown","1a0ac8d2":"markdown","f1455254":"markdown","0104ee2e":"markdown","2d099cd0":"markdown","163fab71":"markdown"},"source":{"9b99e2d2":"# Importing relevant packages\nimport pandas as pd \nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom sklearn.preprocessing import StandardScaler","a445969a":"train_df = pd.read_csv('..\/input\/osic-pulmonary-fibrosis-progression\/train.csv')\ntrain_df.head()","4a08b6e7":"train_df.shape","a58059f3":"train_df.describe()","4c77a989":"# Create checkpoint before deleting 'patient' feature\noriginal_df = train_df.copy()\n\n# Delete the feature now\ntrain_df = train_df.drop(['Patient'], axis=1)\ntrain_df.head()","30c9cdd0":"# Create a checkpoint\ndf_without_patient = train_df.copy()\n\n# Convert the categorical variables now...\ntrain_df = pd.get_dummies(train_df, drop_first=True)\ntrain_df.head()","2b161414":"# Create a checkpoint\ndf_with_dummies = train_df.copy()\n\n# Now scale each feature in dataframe\nscaler = StandardScaler()\nscaler.fit(train_df)\ntrain_df = scaler.transform(train_df)\ntrain_df","3bc4b100":"# Convert numpy array into dataframe\nfinal_train_df = pd.DataFrame(train_df)\n\n# get column headers from checkpoint df\ncol_names = df_with_dummies.columns\n\n# Set column headers in final dataframe\nfinal_train_df.columns = col_names\n\nfinal_train_df.head()","09a658f1":"test_df = pd.read_csv('..\/input\/osic-pulmonary-fibrosis-progression\/test.csv')\ntest_df.head()","ca9a0462":"test_df.shape","9f8534fd":"test_df.describe()","567d0076":"# Create checkpoint before deleting 'patient' feature\noriginal_test_df = test_df.copy()\n\n# Delete the feature now\ntest_df = test_df.drop(['Patient'], axis=1)\ntest_df.head()","15fba1a0":"# Create a checkpoint\ntest_df_without_patient = test_df.copy()\n\n# Convert the categorical variables now...\ntest_df = pd.get_dummies(test_df, drop_first=True)\ntest_df.head()","53a47e1b":"# Create a checkpoint\ntest_df_with_dummies = test_df.copy()\n\n# Now scale each feature in dataframe\nscaler = StandardScaler()\nscaler.fit(test_df)\ntest_df = scaler.transform(test_df)\ntest_df","241102eb":"# Convert numpy array into dataframe\nfinal_test_df = pd.DataFrame(test_df)\n\n# get column headers from checkpoint df\ncol_names = test_df_with_dummies.columns\n\n# Set column headers in final dataframe\nfinal_test_df.columns = col_names\n\nfinal_test_df.head()","9c722661":"final_train_df.to_csv('final_train.csv', index=False)\nfinal_test_df.to_csv('final_test.csv', index=False)\n'''\n1.Hit commit and run at the right hand corner of the kernel.\n2.Wait till the kernel runs from top to bottom.\n3.Checkout the 'Output' Tab from the Version tab. Or go to the snapshot of your kernel and checkout the 'Output' tab.\n  Your csv file will be there!!\n4. Download it.\n'''","c7af6385":"!pip install imutils","6040ad98":"# Importing relevant packages\n\nimport os\nimport cv2\nimport glob\nimport imutils\nimport pydicom\nimport matplotlib.pyplot as plt\n%matplotlib inline","afd79ef9":"# Convert .dcm image to .png image\n\npath = '..\/input\/osic-pulmonary-fibrosis-progression\/train\/ID00007637202177411956430\/1.dcm'\nfile = path.split('\/')[-1]\noutdir = '.\/'\n\n# read dcm file\ndcm_img = pydicom.dcmread(path)\n\n# get pixel arrays, replace .dcm extension with .png and place image in output directory\nimg = dcm_img.pixel_array\ncv2.imwrite(outdir + file.replace('.dcm','.png'),img)","f70eeb5e":"image = cv2.imread(\".\/1.png\")\nplt.imshow(image)","90fdb648":"# Gaussian Blur\nblur = cv2.GaussianBlur(image, (7,7), 0)\nplt.imshow(blur)","d0aed801":"# Median Blur\nmedian_blur = cv2.medianBlur(image, 5)\nplt.imshow(median_blur)","2321c717":"# Flip vertically \nflip_vertical = cv2.flip(image, flipCode=0)\nplt.imshow(flip_vertical)","3c3b2668":"# Flip horizontally \nflip_horizontal = cv2.flip(image, flipCode=1)\nplt.imshow(flip_horizontal)","d5181542":"# Flip both horizontally and vertically\nflip_both = cv2.flip(image, flipCode=-1)\nplt.imshow(flip_both)","1856f91b":"edged = cv2.Canny(image, 100, 200)\nplt.imshow(edged)","a7019e13":"# clockwise rotation\nrotate_clock = imutils.rotate(image, -45)\nplt.imshow(rotate_clock)","b375bc57":"# counter clockwise rotation\nrotate_counter = imutils.rotate(image, 90)\nplt.imshow(rotate_counter)","3e01ce83":"_, thresh1 = cv2.threshold(image, 200, 255, cv2.THRESH_BINARY)\nplt.imshow(thresh1)","c7f21832":"_, thresh2 = cv2.threshold(image, 200, 255, cv2.THRESH_BINARY_INV)\nplt.imshow(thresh2)","bb3f27d6":"# Erosion\nerode = cv2.erode(thresh1, (5,5), iterations=1)\nplt.imshow(erode)","136d8fe0":"dilate = cv2.dilate(thresh1, (5,5), iterations=1)\nplt.imshow(dilate)","b7a55366":"## _2.6 Erosion and Dilation_\nErosion and Dilation are operations of Morphological Transformations.\n\nWhile **<font color='blue'>Erosion<\/font>** is helpful in removing white noise (Always try to keep foreground in white), **<font color='blue'>Dilation<\/font>** is useful in image binding and joining broken parts of an object.\n\nNormally, in cases like noise removal, erosion is followed by dilation. Because, erosion removes white noises, but it also shrinks our object. So we dilate it. Since noise is gone, they won\u2019t come back, but our object area increases.","7676df95":"## _2.5 Thresholding an image_","b02e0372":"## _1.2 Test Data_\n### We will be repeating all same steps which we performed above for test data as well","bcc4be71":"## _2.1 Blur Image_","0b0359fd":"\n# _<font color='red'>2. Image Data Preprocessing<\/font>_ \ud83d\udcf8","839623d5":"## _2.3 Edge Detection_","d1b2872a":"I am uisng imutils package here as the methods it contains are pretty simple and easy to use.","45c91ea5":"### In this notebook, I will show you how to preprocess and prepare both our Tabular and Image datasets.\n\n#### **<font color='red'>Disclaimer<\/font>** : This notebook is a continuation of my [previous notebook](https:\/\/www.kaggle.com\/sarthak97\/osic-starter-eda-dicom-viz-analysis\/notebook) on EDA and DICOM data viz. and analysis. Make sure to check it out to get a better understanding.","6f6e108a":"# _<font color='red'>1. Tabular Data Preprocessing + Preperation<\/font>_ \ud83d\udee0\ufe0f","d0255593":"#### We have seen in the [previous notebook](https:\/\/www.kaggle.com\/sarthak97\/osic-starter-eda-dicom-viz-analysis\/notebook) that there are no missing values in test set also. So no need to check again.","17d1d6b2":"'train_df' now contains all scaled values and is a 2D numpy array.","ef460aa8":"### _(Optional) You can run below cell and download the final csv data if you want which will be a ready-to-use data helpful when we create our baseline model_","68fb31fc":"### <font color='orange'>If you find this notebook useful, please **UPVOTE** it \ud83d\ude0a. It keeps me motivated to do more hard work and produce and bring out more quality content for everyone.<\/font>","d7da32d4":"### Let's handle the categorical variables now...\n\n<font color='red'>**To do this, we would be using the 'get_dummies' method of pandas which will one-hot encode the categorical variables and remove extra features to avoid dummy variable trap.**<\/font>","5c079a9f":"### Since 'Patient' feature contains only the unique ID of patient, we can remove it from our dataset.","74b4bc7a":"### Since 'Patient' feature contains only the unique ID of patient, we can remove it from our dataset.","671a7a9f":"#### We have seen in the [previous notebook](https:\/\/www.kaggle.com\/sarthak97\/osic-starter-eda-dicom-viz-analysis\/notebook) that there are no missing values in train set. So no need to check again.","bbdf9e4d":"### From above dataframe head, all values are now numerical. It is clear that some values are really big while others are small. \n\n<font color='red'>**This is a problem as our Machine Learning algorithm may find out a relation between the result and the higher and lower values in such a way that it considers higher values to be of more importance than the lower ones which is totally not the case. So, we need to handle such a thing.**<\/font>\n\nWe can do so by **Scaling** our dataset so that each feature value is in the same range","c27ff936":"## _2.4 Rotating an image_\n\nFollowing standard is used in imutils package when rotating an image\n\n- Angle > 0 -> Counter clockwise\n- Angle < 0 -> Clockwise","1a0ac8d2":"**Background**: When we deal with images in image-based problems and deploy a deep learning solution, it is better to have a fast image reading and transforming library. I will be converting DICOM images to numpy arrays just to make the process of preprocessing a lot simpler along with OpenCV.","f1455254":"### Below are the steps that can be performed in general to preprocess your image dataset.\n\n#### _<font color='blue'>NOTE : I will be showing this on one image just to demonstrate how you can implement this in your notebooks.<\/font>_","0104ee2e":"# \ud83d\udc68\u200d\u2695\ufe0f OSIC Pulmonary Fibrosis Progression \ud83d\udc69\u200d\u2695\ufe0f\n![](https:\/\/medicaldialogues.in\/h-upload\/2020\/05\/18\/128958-idiopathic-pulmonary-fibrosis.jpg)","2d099cd0":"## _1.1 Train Data_","163fab71":"## _2.2 Flip Image_\nThe image is flipped according to the value of flipCode as follows:\n\n- flipcode = 0: flip vertically\n- flipcode > 0: flip horizontally\n- flipcode < 0: flip vertically and horizontally"}}