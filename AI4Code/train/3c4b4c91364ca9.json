{"cell_type":{"8d236d73":"code","c0610d38":"code","b26dfd7a":"code","060c2c90":"code","91b53eb4":"code","64d9cf4a":"code","168cf95f":"markdown"},"source":{"8d236d73":"import pandas as pd\nimport fastai\nfrom fastai.vision.all import *","c0610d38":"path = Path('..\/input\/cassava-leaf-disease-classification')\nimage_path = Path('..\/input\/cassava-leaf-disease-classification\/train_images')\ntraining_data_file = Path('..\/input\/cassava-leaf-disease-classification\/train.csv')\nsample_submission_file = Path('..\/input\/cassava-leaf-disease-classification\/sample_submission.csv')","b26dfd7a":"train_df = pd.read_csv(training_data_file)","060c2c90":"src_size = (PILImage.create('..\/input\/cassava-leaf-disease-classification\/train_images\/1000015157.jpg')).size\nbs = 16\n\ndef get_x(r):return image_path\/r['image_id']\n\ndef get_y(r):return r['label']\n\nitem_tfms = [Resize(src_size)]\n\nbatch_tfms = [RandomResizedCrop(size=224), *aug_transforms(mult=1.0, do_flip=True, max_rotate=40.0),Normalize.from_stats(*imagenet_stats)]\n\n\ndatablockk = DataBlock(blocks=(ImageBlock, CategoryBlock),splitter=RandomSplitter(seed=42),get_x=get_x,get_y=get_y,item_tfms = item_tfms,batch_tfms = batch_tfms )\n\nimage_data_loader = datablockk.dataloaders(train_df, bs=bs)","91b53eb4":"learn = load_learner('..\/input\/trainedmodel\/export (1).pkl')","64d9cf4a":"test_image_files = Path('..\/input\/cassava-leaf-disease-classification\/test_images')\nimage_data_loader_test = image_data_loader.test_dl(get_image_files(test_image_files))\nlabels = []\nfiles = []\nfor file in list(test_image_files.glob(\"*.jpg\")):\n    files.append(file.name)\n    labels.append(str(learn.predict(file)[0]))\nsub = pd.read_csv(sample_submission_file)\nsub.head()\nsub['label'] = labels\nsub.to_csv('submission.csv', index=False)","168cf95f":"**To see the traning process please refer to [Traing the model for classification](https:\/\/www.kaggle.com\/sd4321\/latest-fastai-training-inference-prediction)****"}}