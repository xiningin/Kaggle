{"cell_type":{"84b5ac29":"code","2d4db532":"code","e9a26f50":"code","05f4149c":"code","b9ec5a0a":"code","d317b7d6":"code","821d8f97":"code","cf22f976":"code","78f7061b":"code","49431e10":"code","3eddc6b6":"code","19a7d724":"code","aa4ad69f":"code","2152f7df":"code","9f60cae1":"code","9e91f41e":"markdown","9074ef58":"markdown","d8ded84d":"markdown","3428aa96":"markdown","611a1dfa":"markdown","18291a42":"markdown","04858cd3":"markdown","d6d2f073":"markdown","db4b5822":"markdown","f59503ab":"markdown","af6ff2c8":"markdown","05f71e73":"markdown"},"source":{"84b5ac29":"!pip install feyn","2d4db532":"import pandas as pd\nimport feyn","e9a26f50":"df = pd.read_csv(\"\/kaggle\/input\/used-bikes-prices-in-india\/Used_Bikes.csv\")\ndf.head()","05f4149c":"#df = df.drop([\"bike_name\"],axis=1)","b9ec5a0a":"df.nunique()","d317b7d6":"train, test = feyn.tools.split(df, ratio=(4,1), random_state=42)","821d8f97":"ql = feyn.connect_qlattice()\nql.reset(random_seed=42)","cf22f976":"stypes = {\n    \"bike_name\": \"cat\",\n    \"city\": \"cat\",\n    \"owner\": \"cat\",\n    \"brand\": \"cat\",\n}","78f7061b":"models = ql.auto_run(train, output_name=\"price\", stypes=stypes, max_complexity=7)","49431e10":"print(\"Train RMSE:\", models[0].rmse(train))\nprint(\"Test RMSE:\", models[0].rmse(test))","3eddc6b6":"print(\"Train R2\", models[0].r2_score(train))\nprint(\"Test R2\", models[0].r2_score(test))","19a7d724":"models[0].plot_regression(test)","aa4ad69f":"models[0].plot_response_1d(test, by=\"power\")","2152f7df":"models[0].plot_response_1d(test, by=\"age\", input_constraints={\"brand\": \"Royal Enfield\"})","9f60cae1":"models[0].plot_response_1d(test, by=\"brand\")","9e91f41e":"# Price for individual brands\nThe price distribution of each brand ordered by the characteristic price according to the model","9074ef58":"# Conclusion\nWe can predict the sales price with good accuracy with a simple model.\n\nI notice that the model performs better on the _test_ set than on the _training_ set. This would indicate to me that outliers are causing problems, and most of the outliers ended up in the training set.\n\n# Further work\nThings that should be tried:\n- Remove outliers\n- Simplify the categoricals by having at least 10 percent in each categoy and binning the others as \"other\".\n- Try with mean absolute error rather than sqared error\n","d8ded84d":"# Data\nRead in the data and have a quick look at it:","3428aa96":"# Allocate a QLattice\nThe actual QLattice is a quantum simulator that runs on Abzu's hardware, but we can allocate one to use for our analysis with a single line of code. Hopefully the following line will get us one.","611a1dfa":"# RMSE of train and test data","18291a42":"A lot of categorical features\n\n# Value counts","04858cd3":"# $R^2$ of train and test data","d6d2f073":"# Use a Community QLattice to predict bike prices\n\n# Abstract\nIn this notebook, I will use the QLattice symbolic regressor to discover a relatively simple mathematical model that can predict the sales price of used motorbikes\n\nI find a simple mathematical model that uses only three features to predict the prices with an $R^2$ of 0.94 and an RMSE of 21,749. I conclude that in a few lines of code, the QLattice is able to find a model which is surprisingly accurate, yet simple enough to be used in practice to estimate the price of a uses bike.\n\nI find that price:\n- falls with age\n- Price increases exponentially with power\n- BMWs generally have the highest price, while Royal Enfields has the lowest.\n\n![image.png](attachment:eb727ecb-e9a0-467f-bf39-f1db0a285ab8.png)\n\n# The QLattice\nThe QLattice is a supervised machine learning tool for symbolic regression developed by [Abzu](https:\/\/www.abzu.ai). QLattices have been shown in research to perform very well and yield simple and explainable models: [Symbolic regression outperforms other models for small data sets](https:\/\/arxiv.org\/abs\/2103.15147)\n\nAbzu provides free QLattices for non-commercial use. Read more about how it works here: https:\/\/docs.abzu.ai\/docs\/guides\/getting_started\/community.html\n\nThe feyn Python module is not installed on Kaggle by default so we have to pip install it first.","db4b5822":"# Impact of age on price\nPrice as a function of age. ","f59503ab":"# A regression plot\nPlot predicted vs actual in a regression plot","af6ff2c8":"# Categorical data\n\nThe QLattice will work fine with both categorical and numerical data. I just need to tell it which is which.\nRead more about categorical data in the QLattice here: https:\/\/docs.abzu.ai\/docs\/guides\/essentials\/stypes.html","05f71e73":"# Impact of power on price"}}