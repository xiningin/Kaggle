{"cell_type":{"669b014f":"code","3cf44b7f":"code","e990ba8b":"code","3abcf246":"code","3ea93eff":"code","dd78e3f5":"code","e7f93de9":"code","ba521503":"code","175fd1b3":"code","1329a706":"code","4570c5a7":"code","2af7b165":"code","ea63ae64":"code","dc743071":"code","830e3ded":"code","8fc3208d":"code","8d5c0072":"code","470c5a39":"code","3e559c3c":"code","6faa1cf4":"code","3033fcb5":"code","84ca5c35":"code","bdf7057b":"code","3af9a044":"code","e2d1bcd9":"code","319b230d":"code","0aec61dc":"markdown","85d40c7e":"markdown","3f741ac4":"markdown","5db5e944":"markdown","5ca94fa4":"markdown","783c033d":"markdown","e5213d00":"markdown","17fcd744":"markdown","d6a813e9":"markdown","d97cdda7":"markdown","02692f07":"markdown","d791e6fd":"markdown","d7dac52f":"markdown","519b4e92":"markdown","29510e63":"markdown","60b9f4ec":"markdown","4766a875":"markdown","9a1fdd84":"markdown","736ae7bd":"markdown","f99e9b53":"markdown","864f4113":"markdown"},"source":{"669b014f":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport math\nimport statsmodels.api as sm\nimport statsmodels.formula.api as smf\nimport seaborn as sns","3cf44b7f":"\ndf= pd.read_csv(\"..\/input\/fifa19\/data.csv\")\ndf.head(5)","e990ba8b":"''' Aca escribe el codigo'''\ndf['Overall'].plot.hist(bins=60)","3abcf246":"#Eliminamos columnas que no se encuentren en la lista skills\n\nskills = ['Name','Age','Nationality','Position','Club','Value','International Reputation', 'Work Rate',\n          'Finishing','Dribbling','Acceleration','SprintSpeed', 'Agility', 'Reactions', 'Balance',\n          'Jumping', 'Stamina', 'Strength','Overall']\ndf = df.drop(columns=[col for col in df if col not in skills])\ndf","3ea93eff":"# Dividimos la columna Work rate en dos (WR_Attack y WR_Defense) y cambiamos los valores Low,Medium y High con 1,2,3\n\ndf[['WR_Attack','WR_Defence']] = df['Work Rate'].str.split('\/',expand=True)\ndf1=df.drop(columns=\"Work Rate\")\nAnterior= ['Low','Medium','High']\nNuevo= [1,2,3] \nAnterior1= [' Low',' Medium',' High']\ndf1[\"WR_Attack\"] = df[\"WR_Attack\"].replace(Anterior,Nuevo)\ndf1[\"WR_Defence\"] = df[\"WR_Defence\"].replace(Anterior1,Nuevo)\ndf1.head(5)","dd78e3f5":"#Verificamos si existen datos nulos\n\nmissing_data = df1.isnull()\nfor column in missing_data.columns.values.tolist():\n    \n    print(column)\n    print(missing_data[column].value_counts())\n    print('')","e7f93de9":"#Eliminamos filas donde existan datos nulos en atributos no numericos\n# Los valores nulos de Sprintspeed los llenamos con los de Acceleration\ndf2 = df1[df1[('Club')].notna()]\ndf3=df2[df2[('Position')].notna()]\ndf3['SprintSpeed']=df3['SprintSpeed'].fillna(df['Acceleration'])\ndf3","ba521503":"#Volvemos a verificar que no existan datos nulos\n\nmissing_data1 = df3.isnull()\nfor column in missing_data1.columns.values.tolist():\n    \n    print(column)\n    print(missing_data1[column].value_counts())\n    print('')","175fd1b3":"df3.boxplot(column=['Overall','SprintSpeed','Agility','Balance','Strength','Stamina','Reactions'],figsize=(15,6))\n","1329a706":"# Eliminamos el signo de Euro y Pasamos K y M a numeral para poder calcular el valor\n#El club que tiene mas valor es el Real Madrid\ndf3['Value'] = df3['Value'].str.split('\u20ac').str[1] \ndf3['Value']=df3['Value'].replace({'K': '*1e3', 'M': '*1e6'}, regex=True).map(pd.eval)\ndf3_1=df3.groupby(['Club'])['Value'].sum().sort_values(ascending=False).reset_index(name='Valor').head(10)\ndf3_1","4570c5a7":"# El equipo con menos valor es Bray Wanderers\ndf3_1_2=df3.groupby(['Club'])['Value'].sum().sort_values(ascending=False).reset_index(name='Valor').tail(10)\ndf3_1_2","2af7b165":"# El club con mayor reputacion es el Barcelona\ndf3_2=df3.groupby(['Club'])['International Reputation'].sum().sort_values(ascending=False).reset_index(name='Reputation').head(10)\ndf3_2","ea63ae64":"# El club con mayor overall es el Real Madrid\n\ndf3_3=df3.groupby(['Club'])['Overall'].sum().sort_values(ascending=False).reset_index(name='Overall').head(10)\ndf3_3","dc743071":"#Ahora veremos los equipos que se encuentran en las 3 tablas\n\ndf3_4=pd.merge(df3_1,df3_2)\ndf4_5=pd.merge(df3_4,df3_3)\ndf4_5","830e3ded":"''' Aca escribe el codigo'''\ndf4=df3.groupby('Club').agg({'Overall': 'sum', 'Name': 'count'})\ndf4\n","8fc3208d":"#Clubes con mejores overalls normalizados\n\ndf4['Overall_Norm']=df4['Overall']\/df4['Name']\ndf4.groupby(['Club'])['Overall_Norm'].sum().sort_values(ascending=False).reset_index(name='Overall Normalizado').head(10)","8d5c0072":"#PAISES CON MEJOR OVERALL NORMALIZADO\n\ndfInt=df3.groupby('Nationality').agg({'Overall': 'sum', 'Name': 'count'})\ndfInt['Overall_Norm']=dfInt['Overall']\/dfInt['Name']\ndfInt_Norm=dfInt.groupby(['Nationality'])['Overall_Norm'].sum().sort_values(ascending=False).reset_index(name='Overall Normalizado')\ndfInt_Norm.head(10)","470c5a39":"# TOP 5 PAISES CON PEORES OVERALL NORMALIZADOS\n\ndfInt_Norm.tail(10)","3e559c3c":"#Overall y puesto de Bolivia\n\ndfInt_Norm.loc[dfInt_Norm['Nationality']=='Bolivia']","6faa1cf4":"# Edad media de jugadores segun posicion en el campo\n# La posicion que tiene en las que juegan personas de mayor edad es LAM y la de menor edad es LW\n\ndf3.groupby(['Position'])['Age'].mean().sort_values(ascending=False).reset_index(name='Media')\n","3033fcb5":"#Utilizamos un cuadro de calor para conocer las correlaciones entre variables\n# Las que presentan mayor relacion son: (Value,Overall),(Value,International Reputation),(Reactions, Overall),(Acceleration,sprintspeed)\ncorrmat = df3.corr()\nsns.heatmap(corrmat, cmap=\"RdBu\")","84ca5c35":"athetic_skills = ['Work Rate','Finishing','Dribbling','Acceleration','SprintSpeed', 'Agility', 'Reactions', 'Balance','Jumping', 'Stamina', 'Strength','Overall']","bdf7057b":"''' Aca escribe el codigo'''\n\nmod = smf.ols(formula='Overall ~ (Reactions) + (Agility) +C(WR_Defence) ', data=df3)\nnp.random.seed(2)\nres = mod.fit()\nprint(res.summary())","3af9a044":"''' Aca escribe el codigo'''\nmod_1 = smf.ols(formula='Overall ~ (Reactions) + (Finishing) +C(WR_Defence) ', data=df3)\nnp.random.seed(2)\nres_1 = mod_1.fit()\nprint(res_1.summary())","e2d1bcd9":"''' Aca escribe el codigo'''\n!pip install pandas -U pandas-profiling\nimport pandas_profiling","319b230d":"df3.profile_report()","0aec61dc":"Realizar el mismo analisis, pero incluyendo Finishing en lugar de Agility. Los atributos son: Reactions, Finishing, defense_work_rate. Comparar los valores $R^2$ de ambos analisis","85d40c7e":"#### B1.1.\n\nRealiza un analisis de correlacion entre los diferentes atributos de cada jugador. ** No es necesario que realices el analisis con todos los atributos, puedes seleccionar los que te parezcan mas relevantes.\n\n- cuales son los atributos que presentan una mayor correlacion?","3f741ac4":"Utiliza la herramienta Pandas Profiling o Sweetviz para realizar un analisis descriptivo de datos.\n\nEscribe algunas conclusiones del reporte generado por la libreria","5db5e944":"### A1. Conociendo los datos\n\n#### A1.1.\nCarrga el dataset `fifa19_players.csv` en un Pandas DataFrame\n","5ca94fa4":"Realiza un Analisis de Regresion Lineal en base a los atributos: Reactions, Agility, defense_work_rate\n","783c033d":"Para Work Rate, debes usar las dos columnas que creaste en el ejercicio A2.1","e5213d00":"#### A2.6.\n\nQueremos entender como es la distribucion de edades de acuerdo a las diferentes posiciones 'Position' en las que juegan\n\n- En que posicion son jugadores de mayor edad? en que posicion son jugadores de menor edad? ","17fcd744":"#### A2.3.\n\nQueremos realizar un ranking de los clubes basados en: 'Value', 'International Reputation' y 'Overall' de todos los jugadores que pertenecen a un mismo club ('Club').\n- Muestra en una tabla el top 10 de clubes basado en la suma de 'Value' de todos sus jugadores. Que club tiene mas valor? que club el menor valor?\n- Muestra en una tabla el top 10 de clubes basado en la suma de 'International Reputation' de todos sus jugadores. \n- Muestra en una tabla el top 10 de clubes basado en la suma de 'Overall' de todos sus jugadores\n\nQue club\/clubes se encuentran en los tres rankings entre el top 10?","d6a813e9":"# Pr\u00e1ctica Final: Analisis Descriptivo de Datos\n\n","d97cdda7":"#### A2.2.\n\nComo en todos los datasets de aplicaciones reales, encontraras *valores faltantes*. Hay varias formas de *rellenarlos* viendo los otros records para los cuales estos valores no faltan.\n\n* Use una *simple agregacion* de los records para los cuales los valores estan presentes (no faltantes) para llenar en los valores faltantes. Unicamente debes realizar esta agregacion para los atibutos **numericos**, para los demas atributos puedes eliminar esas muestras\n\n* Existe algun outlier\/anomalia en alguno de los atributos? Incluye el analisis para identificarlos  (FALTA)","02692f07":"#### A2.4.\n\nQueremos realizar una comparacion justa entre clubes para el Overall debemos dividir el total obtenido entre el numero de jugadores pertenecientes al club.\n\n- Muestra en una tabla el top 10 de clubes basado en el valor 'normalizado' de 'Overall' de todos sus jugadores\n- Cual es el mejor club basado en este ranking? Cual es el peor club basado en este ranking?","d791e6fd":"#### A1.2.\nLa columna *Overall* contiene una calificacion que representa el rendimiento general del jugador de futbol. Antes de empezar, quieres estar seguro que hay la suficiente diversidad en el dataset para obtener conclusiones significatiivas (e.g. no deberia ser el caso que todos los jugadores tienen el mismo nivel de habilidades) \n* Grafica el histograma con los scores y analiza el plot. Que tipo de distribucion tenemos?\n","d7dac52f":"\n\n\nTe eligieron como el tecnico del equipo mas grande de Bolivia: [Bolivar](https:\/\/en.wikipedia.org\/wiki\/Club_Bol%C3%ADvar) y como primer paso para mejorar el equipo, debes realizar un analisis de un conjunto de jugadores para realizar contrataciones mas adelante.\nUna forma de evaluar la calidad del jugador seria viendo los juegos en los que el participa. Tu crees que viendo las *habilidades fisicas* de los candidatos como *correr* y *saltar* pueden ser una buena forma de medir las habilidades de un jugador de futbol. \n\nTrabajaras con el dataset de los jugadorres del video juego [FIFA 19](https:\/\/www.ea.com\/games\/fifa\/fifa-19), que contiene datos de miles de jugares de futbol, en particular sus habilidades en diferentes campos.\n\nCada fila del dataset corresponde a un jugador (vas a reconocerlos). Contiene informacion como la nacionalidad del jugador y su valor en el mercado. Los atributos que se refieren a las habilidades de los jugadores, la mayoria son positivos en diferentes rangos, donde *mayor valor* corresponde a *el jugador siendo mejor* en esa habilidad.\n","519b4e92":"### A2. Preprocesamiento y Analisis\n\nLos atributos que usaras para las siguientes tareas son los siguientes: (puedes remover el resto de las columnas)\n","29510e63":"### B1. Relacion entre atributos\n","60b9f4ec":"#### A2.5.\n\nAhora realizamos la misma comparacion pero a nivel Internacional. Cual es el top 10, en base al Overall de los jugadores basados en su nacionalidad?\n\n- Muestra en una tabla el top 10 de clubes basado en el valor 'normalizado' de 'Overall' de todos sus jugadores\n- Cual es el mejor pais basado en este ranking? Cual es el peor pais basado en este ranking? Cual es el Overall de la seleccion de Bolivia?","4766a875":"Los atributos que se refieren a las habilidades de los jugadores son:\n","9a1fdd84":"### B3. Pandas Profiling\/SweetViz","736ae7bd":"#### A2.1.\n\nM\u00e1s adelante queremos aplicar modelos predictivos, para ello debemos procesar nuestros datos y convertir algunos atributos de habilidades en valores *numericos*.\n'Work Rate' se refiere a cuanto esfuerzo le pone el jugador a su juego cuando ataca y defiende respectivamente, pero no es numerico. Transformar el atributo **Work Rate** en _dos_ atributos numericos (dos columnas)\n","f99e9b53":"#### B1.2.","864f4113":"Para decidir que jugador contratar, necesitas saber como estas habilidades se transforman al rendimiento en el futbol.\n\nPara modelar el rendimiento en futbol ('Overall') para un jugador utilizaras \"Regresion Lineal\". Recordemos que la Regresion Lineal minimiza:\n\n\n\n\n$$||y-X\\beta||_2^2,$$\n\ndonde $y$ es un vector de todas las puntuaciones, $X$ es la matriz con los datos, cada *fila* son los atributos de cada jugador, $\\beta$ son los parametros beta\n"}}