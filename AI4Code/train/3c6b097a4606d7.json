{"cell_type":{"19bbbed0":"code","43e466dd":"code","3ccd2263":"code","14435b77":"code","574bc90c":"code","be5c3ca3":"code","fb264af2":"code","dc808eeb":"code","dd85576a":"code","94cd06f2":"code","0b821ca7":"code","7e2206fd":"code","cfa38a37":"code","0103b4db":"code","025e3245":"code","4f920d1b":"code","cb640c67":"code","15f9d51d":"code","e17c3d16":"code","8dcd4182":"code","ca794274":"code","e70d0b76":"markdown","e1280355":"markdown","d74705b1":"markdown","db474a99":"markdown","6a04fc53":"markdown","3510183c":"markdown"},"source":{"19bbbed0":"pip install git+https:\/\/download.radtorch.com\/ -q","43e466dd":"from radtorch import pipeline, core\nfrom radtorch.settings import *","3ccd2263":"data_root = '\/kaggle\/input\/mura-v11\/MURA-v1.1\/train_image_paths.csv'","14435b77":"x = pd.read_csv(data_root, header=None, names=['PATH'])\nx ","574bc90c":"shoulder_files = []\nshoulder_labels = []\nfor i, r in x.iterrows():\n    if 'SHOULDER' in r['PATH']:\n        shoulder_files.append('\/kaggle\/input\/mura-v11\/'+r['PATH'])\n        if 'positive' in r['PATH']:\n            shoulder_labels.append('POSITIVE')\n        else:\n            shoulder_labels.append('NEGATIVE')\n               \n","be5c3ca3":"shoulder_data = pd.DataFrame(zip(shoulder_files,shoulder_labels), columns=['PATH', 'LABEL'])\nshoulder_data","fb264af2":"clf = pipeline.Image_Classification(data_directory = '\/kaggle\/input\/mura-v11\/MURA-v1.1\/train\/', \n                                    table=shoulder_data, \n                                    is_dicom=False,\n                                    is_path=True,\n                                    image_path_column='PATH', image_label_column='LABEL',\n                                    sampling=0.5,\n                                    model_arch='resnet50',\n                                    type='xgboost',\n                                    parameters={'tree_method':'gpu_hist'})","dc808eeb":"clf.data_processor.sample()","dd85576a":"clf.data_processor.dataset_info()","94cd06f2":"clf.run()","0b821ca7":"clf.classifier.roc()","7e2206fd":"clf.classifier.confusion_matrix()","cfa38a37":"clf2 = pipeline.Image_Classification(data_directory = '\/kaggle\/input\/mura-v11\/MURA-v1.1\/train\/', \n                                    table=shoulder_data, \n                                    is_dicom=False,\n                                    is_path=True,\n                                    image_path_column='PATH', image_label_column='LABEL',\n                                    sampling=0.5,\n                                    model_arch='resnet50',\n                                    type='nn_classifier',\n                                    epochs=5)","0103b4db":"clf2.run()","025e3245":"clf2.classifier.roc()","4f920d1b":"clf2.classifier.confusion_matrix()","cb640c67":"clf2.classifier.show_model_layers()","15f9d51d":"target_image_path = clf2.data_processor.test_table.iloc[4]['PATH']\ntarget_image_path","e17c3d16":"clf2.cam(target_image_path=target_image_path, target_layer=clf2.trained_model.layer4[2].conv3, alpha=0.3, type='scorecam', figure_size=(20,60))","8dcd4182":"clf2.cam(target_image_path=target_image_path, target_layer=clf2.trained_model.layer4[2].conv3, alpha=0.3, type='gradcampp', figure_size=(20,60))","ca794274":"clf2.data_processor.class_table()","e70d0b76":"## Install RADTorch","e1280355":"## Classifier #1 : \nA RESNET50 feature extractor followed by xgboost classifier 5-fold cross validation","d74705b1":"# Demo of MURA-Subset Classification Using RADTorch","db474a99":"## Classifier #2 : \nA RESNET50 neural network trained for 5 epochs using transfer learning","6a04fc53":"## Data Prep","3510183c":"## Import RADTorch"}}