{"cell_type":{"09cc1493":"code","a4bbfaed":"code","ee2499de":"code","aa5b4cf0":"code","09f8e71a":"code","7f2a6ee1":"code","90abdf8d":"code","884627c2":"code","04f675a1":"code","8f1f4e39":"code","558336f5":"code","1295d459":"code","da902c43":"code","3a4601a0":"code","330ebf58":"code","5be34208":"code","12b9741c":"code","f1240daa":"code","28b1551b":"code","2237db59":"code","db1170ef":"code","776e128c":"code","0e263afd":"code","482be910":"code","65902c4e":"code","4f32ba74":"markdown","ca9fff42":"markdown","8b95adca":"markdown","257e04b5":"markdown","18c5f0c3":"markdown","b40bdb6c":"markdown","ad5fd28b":"markdown","a5583ddc":"markdown","6cf8f44f":"markdown","bc979f67":"markdown","6714292d":"markdown","b0e2c64a":"markdown","f13e6b0b":"markdown","72698941":"markdown"},"source":{"09cc1493":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","a4bbfaed":"df=pd.read_csv(\"..\/input\/stock-sentiment-analysis\/Stock_Dataa.csv\",encoding=\"ISO-8859-1\")","ee2499de":"df.head()","aa5b4cf0":"train = df[df['Date'] < '20150101']\ntest = df[df['Date'] > '20141231']","09f8e71a":"train.head()","7f2a6ee1":"data=train.iloc[:,2:27]\ndata.replace('[^a-zA-Z]',' ',regex=True,inplace=True)","90abdf8d":"data.head()","884627c2":"a=[i for i in range(25)]\nindex=[str(i) for i in (a)]\ndata.columns=index\ndata.head()","04f675a1":"for i in index:\n    data[i]=data[i].str.lower()\ndata.head()","8f1f4e39":"data.index","558336f5":"headlines=[]\n\nfor i in range(0,len(data.index)):\n    headlines.append(' '.join(str(x) for x in data.iloc[i,0:25]))","1295d459":"headlines[0]","da902c43":"from sklearn.ensemble import RandomForestClassifier\nfrom sklearn.feature_extraction.text import CountVectorizer","3a4601a0":"countvector=CountVectorizer(ngram_range=(2,2))\ntraindata=countvector.fit_transform(headlines)","330ebf58":"type(traindata)","5be34208":"random_for=RandomForestClassifier(n_estimators=200,criterion='entropy')\nrandom_for.fit(traindata,train['Label'])","12b9741c":"test_data=[]\nfor i in range(0,len(test.index)):\n    test_data.append(' '.join(str(x) for x in test.iloc[i,2:27]))\n\ntest_data=countvector.transform(test_data)\ntest_pred=random_for.predict(test_data)","f1240daa":"from sklearn.metrics import confusion_matrix\ncon=confusion_matrix(test_pred,test['Label'])\ncon","28b1551b":"from sklearn.metrics import accuracy_score\nacc=accuracy_score(test_pred,test['Label'])\nacc*100","2237db59":"from sklearn.metrics import classification_report\nrep=classification_report(test_pred,test['Label'])\nprint(rep)","db1170ef":"sen=['The stock prices fall dramatic due to the pandemic situation']","776e128c":"ab=['The stock prices decrease due to wrap up of lockdown']","0e263afd":"data=countvector.transform(ab)","482be910":"pred=random_for.predict(data)","65902c4e":"pred","4f32ba74":"**Classification report**","ca9fff42":"**Confusion matrix**","8b95adca":"**Accuracy score**","257e04b5":"**Bag of words creation**","18c5f0c3":"# Model creation","b40bdb6c":"# Appending 0 to 25 rows as a single sentence","ad5fd28b":"**Thus the model is predicting very good**","a5583ddc":"**Data preprocessing and cleaning**","6cf8f44f":"**It returns the row numbers**","bc979f67":"**Prediction for test data**","6714292d":"**Rename the column names**","b0e2c64a":"**Converting to lower case sentences**","f13e6b0b":"# Predicting sentiment of stock based on news headlines","72698941":"**Random forest classifier**"}}