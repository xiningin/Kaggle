{"cell_type":{"a66b98ed":"code","5ccb3527":"code","b31d2999":"code","5e2484b3":"code","cf22ccfb":"code","0685fbaf":"code","398f56d3":"code","fd4fa041":"code","7431cc64":"code","c6c2871a":"code","51ab6fb5":"code","89e4720c":"code","981fd11f":"code","df47ae3c":"code","df3c04f5":"code","2be6f865":"code","bb6fd6fb":"code","5d5f2e3f":"code","27325855":"code","0ec7292a":"code","7d248a04":"code","038c4405":"code","dc46b9a3":"code","8354d07d":"code","c32f1fda":"code","c0646d14":"markdown","bbb75235":"markdown","16b518c5":"markdown","797d4fbe":"markdown","f50ccbfb":"markdown","def43dbe":"markdown","b153e120":"markdown","90af0f31":"markdown","13c9eb43":"markdown","25caef39":"markdown","046c3297":"markdown","6adfa783":"markdown","a84dbcf1":"markdown","65e6ac87":"markdown","eae2b649":"markdown","7f7f993b":"markdown","080148dc":"markdown","84699eb8":"markdown","c5e877d5":"markdown","5c20acae":"markdown","cbf44919":"markdown","cb1c38b6":"markdown","c96ebabd":"markdown"},"source":{"a66b98ed":"import pandas as pd\nimport numpy as np\nimport math\nimport xlrd\nimport matplotlib.pyplot as plt\nimport scipy.stats\nimport seaborn as sns\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.preprocessing import MinMaxScaler\n \n\ndata=pd.read_csv(\"..\/input\/tesla-stock\/TESLA_STOCK.csv\")","5ccb3527":"print(data.head())","b31d2999":"data.describe()","5e2484b3":"plt.figure(figsize=(15,10))\nplt.tight_layout()\nsns.distplot(data['Open'])","cf22ccfb":"plt.figure(figsize=(15,10))\nplt.tight_layout()\nsns.distplot(data['High'])","0685fbaf":"plt.figure(figsize=(15,10))\nplt.tight_layout()\nsns.distplot(data['Low'])","398f56d3":"plt.figure(figsize=(15,10))\nplt.tight_layout()\nsns.distplot(data['Close'])","fd4fa041":"plt.figure(figsize=(15,10))\nplt.tight_layout()\nsns.distplot(data['Adj Close'])","7431cc64":"plt.figure(figsize=(15,10))\nplt.tight_layout()\nsns.distplot(data['Volume'])","c6c2871a":"Close = data[\"Close\"] ","51ab6fb5":"print(data.isnull().sum())","89e4720c":"sns.lineplot(x='Open', y='Close', data=data)\nplt.show()","981fd11f":"sns.pairplot(data[[\"Open\", \"High\", \"Low\", \"Close\", \"Volume\"]], diag_kind=\"kde\")\nplt.show()","df47ae3c":"print (\"Find most important features relative to target\")\ncorr = data.corr()\ncorr.sort_values(['Close'], ascending=False, inplace=True)\nprint(corr.Close) ","df3c04f5":"top_feature = corr.index[abs(corr['Close']>0.5)]\ntop_corr = data[top_feature].corr()\nax = sns.heatmap(top_corr, annot=True)\nbottom, top = ax.get_ylim()\nax.set_ylim(bottom + 0.5, top - 0.5)\nplt.show()","2be6f865":"y=data[\"Close\"]\nprint(y)\nxdata=[\"Open\", \"High\", \"Low\", \"Volume\"]\nx=data[xdata]\nprint(x)\nx_train,x_test,y_train,y_test = train_test_split(x,y,random_state=3)","bb6fd6fb":"regressor=LinearRegression()\nregressor.fit(x_train, y_train)","5d5f2e3f":"coeff_data = pd.DataFrame(regressor.coef_, x.columns, columns=['Coefficient'])\nprint(coeff_data) ","27325855":"accuracy = regressor.score(x_test, y_test)\nprint('Accuracy: \\n {}%'.format(int(accuracy * 100)))","0ec7292a":"print(\"Intercept: \\n\", regressor.intercept_)","7d248a04":"print (\"R^2 is: \\n\", regressor.score(x_test, y_test))","038c4405":"predictions = regressor.predict(x_test)\nprint ('RMSE is: \\n', mean_squared_error(y_test, predictions))","dc46b9a3":"y_pred = regressor.predict(x_test)\ndf=pd.DataFrame({'Actual': y_test, 'Predicted': y_pred})\nprint(df.head(10)) ","8354d07d":"df1 = df.head(30)\ndf1.plot(kind='bar',figsize=(16,10))\nplt.grid(which='major', linestyle='-', linewidth='0.5', color='green')\nplt.grid(which='minor', linestyle=':', linewidth='0.5', color='black')\nplt.show()","c32f1fda":"print(\"Price on day was 03.03.2020 is: \\n Open 805 \\n Close 745.51 \\n High 806.98 \\n Low 716.1106 \\n Volume 25,784,000\")\nmarch_prediction=[[805, 806.98, 716.1106, 25784000]]\nprediction=regressor.predict(march_prediction)\nprint(\"The predicted Close price on the 03.03.2020 2020 is:\\n\", prediction)","c0646d14":"** Looking are there a missing values **","bbb75235":"**Showing the Accuracy for the model**","16b518c5":"**Looking the 10 values from Actual and Predicted**","797d4fbe":"** Looking the pairs for the data set**","f50ccbfb":"**Defining Close as a function to start statistics analysis**","def43dbe":"** Creating the model**","b153e120":"**Looking the relationship between Open price and Close price**","90af0f31":"**Loading the usual libraries and the data**","13c9eb43":"**Looking the head of the data set**","25caef39":"**Looking at data distribution for each variable**","046c3297":"** Showing the bar plot to compare actual Vs predicted values**","6adfa783":"After looking at the data set in which we have almost 10 years of data for our stock, I have made model and try to predict price for the random date, and as we can see the model had has a percentage error 0.84%","a84dbcf1":"**Show the statistics summary for data set**","65e6ac87":"**I have decided to use \"Close\" price as target variable for this model **","eae2b649":"** Showing the R^2 for the model**","7f7f993b":"**Splitting the data and creating Y and X variables**","080148dc":"**Showing the Coefficient for the model**","84699eb8":"Trying to run model and predict Close price for 03.03.2020","c5e877d5":"**For this project, we are going to look into the data set which contains price values for Tesla stock over a period of time from 29\/06\/2010 to 03\/02\/2020.\n\nSince we have a nice and big number of historical data, I will use Multiple Linear Regression model for this project...**","5c20acae":"Finding the most important correlation features relative to target variable","cbf44919":"**Showing the Intercept for the model**","cb1c38b6":"**Showing the RMSE for the model**","c96ebabd":"**Looking the heatmap with correlation which is above 50%**"}}