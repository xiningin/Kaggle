{"cell_type":{"020eca40":"code","7a537bcf":"code","8787dc76":"code","d98eae0b":"code","6abbe48d":"code","0e2bf788":"code","0b3cc476":"code","10948775":"code","e585e524":"code","3a171b79":"code","421b32c5":"code","d67a0a4c":"code","2b8de0c9":"code","8fd8bda2":"code","b6dcabe5":"code","cc085bb0":"code","477364f1":"code","ab9b254e":"code","6835740c":"code","7837f2fa":"code","2e6712b7":"code","16fa0fb3":"code","54378d26":"code","ef4295c6":"code","0a89fbbf":"code","63dbb88d":"code","88b875ef":"code","f6558c90":"code","474fb836":"code","b7bcc100":"code","be738999":"code","563f126f":"code","ae052a6a":"code","15c92097":"code","b9593eb0":"markdown","f21f422a":"markdown","ab4bad56":"markdown","381a82e4":"markdown","3b0f9d48":"markdown","69154f36":"markdown","6cdb933c":"markdown","2ced625a":"markdown","09d6d384":"markdown"},"source":{"020eca40":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport plotly.express as px\nimport plotly.graph_objs as go\nimport plotly.offline as pyo\nimport plotly.figure_factory as ff\nfrom sklearn import preprocessing\nfrom plotly import tools\nfrom plotly.subplots import make_subplots\nfrom plotly.offline import iplot\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.metrics import accuracy_score, plot_confusion_matrix\nfrom sklearn.metrics import accuracy_score, confusion_matrix, classification_report, f1_score\nfrom sklearn import metrics\nimport tensorflow as tf\nfrom tensorflow import keras\nfrom sklearn.preprocessing import MinMaxScaler, Normalizer\nfrom sklearn.decomposition import PCA as sklearnPCA\n#import keras\nfrom keras.models import Sequential\nfrom keras.layers import Dense, Dropout\n# Supress unnecessary warnings so that presentation looks clean\nimport warnings\nwarnings.filterwarnings(\"ignore\")","7a537bcf":"df_train = pd.read_csv('..\/input\/tabular-playground-series-dec-2021\/train.csv')\ndf_train","8787dc76":"df_test = pd.read_csv('..\/input\/tabular-playground-series-dec-2021\/test.csv')\ndf_test","d98eae0b":"df_train.head()","6abbe48d":"df_train.tail()","0e2bf788":"df_train.shape","0b3cc476":"df_train.size","10948775":"df_train.dtypes","e585e524":"df_train.columns","3a171b79":"df_train.info()","421b32c5":"df_train.describe()","d67a0a4c":"df_train.skew()","2b8de0c9":"df_train.isnull().sum()","8fd8bda2":"df_train.corr()","b6dcabe5":"fig = make_subplots(rows=1,cols=2,\n                    subplot_titles=('Countplot',\n                                    'Percentages'),\n                    specs=[[{\"type\": \"xy\"},\n                            {'type':'domain'}]])\nfig.add_trace(go.Bar(y = df_train['Cover_Type'].value_counts().values.tolist(), \n                      x = df_train['Cover_Type'].value_counts().index, \n                      text=df_train['Cover_Type'].value_counts().values.tolist(),\n              textfont=dict(size=15),\n                      name = 'Cover_Type',\n                      textposition = 'outside',\n                      showlegend=False,\n              marker = dict(color = 'cornflowerblue',\n                            line_color = 'black',\n                            line_width=3)),row = 1,col = 1)\nfig.add_trace((go.Pie(labels=df_train['Cover_Type'].value_counts().keys(),\n                             values=df_train['Cover_Type'].value_counts().values,textfont = dict(size = 16),\n                     textposition='auto',\n                     showlegend = True,\n                     name = 'Cover_Type')), row = 1, col = 2)\nfig.update_layout(title={'text': 'Type',\n                         'y':0.9,\n                         'x':0.5,\n                         'xanchor': 'center',\n                         'yanchor': 'top'},\n                  template='plotly_white')\nfig.update_yaxes(range=[0,2400000])\niplot(fig)","cc085bb0":"! pip install autoviz","477364f1":"from autoviz.AutoViz_Class import AutoViz_Class\n\nAV = AutoViz_Class()\n\ntrain = df_train\n\nfilename = \"\"\nsep = \",\"\ndft = AV.AutoViz(\n    filename,\n    sep=\",\",\n    depVar=\"Cover_Type\",\n    dfte=train,\n    header=0,\n    verbose=0,\n    lowess=False,\n    chart_format=\"svg\",\n    max_rows_analyzed=100000,\n    max_cols_analyzed=40,\n)","ab9b254e":"from IPython.core.display import HTML\n\ndef multi_table(table_list):\n    ''' Acceps a list of IpyTable objects and returns a table which contains each IpyTable in a cell\n    '''\n    return HTML(\n        '<table><tr style=\"background-color:white;\">' + \n        ''.join(['<td>' + table._repr_html_() + '<\/td>' for table in table_list]) +\n        '<\/tr><\/table>')","6835740c":"df_train.columns","7837f2fa":"df_nunique = {var: pd.DataFrame(df_train[var].value_counts()) \n              for var in {'Wilderness_Area1', 'Wilderness_Area2', 'Wilderness_Area3',\n       'Wilderness_Area4', 'Soil_Type1', 'Soil_Type2', 'Soil_Type3',\n       'Soil_Type4', 'Soil_Type5', 'Soil_Type6', 'Soil_Type7', 'Soil_Type8',\n       'Soil_Type9', 'Soil_Type10', 'Soil_Type11', 'Soil_Type12',\n       'Soil_Type13', 'Soil_Type14', 'Soil_Type15', 'Soil_Type16',\n       'Soil_Type17', 'Soil_Type18', 'Soil_Type19', 'Soil_Type20',\n       'Soil_Type21', 'Soil_Type22', 'Soil_Type23', 'Soil_Type24',\n       'Soil_Type25', 'Soil_Type26', 'Soil_Type27', 'Soil_Type28',\n       'Soil_Type29', 'Soil_Type30', 'Soil_Type31', 'Soil_Type32',\n       'Soil_Type33', 'Soil_Type34', 'Soil_Type35', 'Soil_Type36',\n       'Soil_Type37', 'Soil_Type38', 'Soil_Type39', 'Soil_Type40'}}\nmulti_table([df_nunique['Wilderness_Area1'], df_nunique['Wilderness_Area2'], \n             df_nunique['Wilderness_Area3'], df_nunique['Wilderness_Area4'], \n             df_nunique['Soil_Type1'], df_nunique['Soil_Type2'],df_nunique['Soil_Type3'],\n            df_nunique['Soil_Type4'],df_nunique['Soil_Type5'],df_nunique['Soil_Type6'],\n            df_nunique['Soil_Type7'],df_nunique['Soil_Type8'],df_nunique['Soil_Type9'],df_nunique['Soil_Type10'],\n            df_nunique['Soil_Type11'],df_nunique['Soil_Type12'],df_nunique['Soil_Type13'],df_nunique['Soil_Type14'],\n            df_nunique['Soil_Type15'],df_nunique['Soil_Type16'],df_nunique['Soil_Type17'],df_nunique['Soil_Type18'],\n            df_nunique['Soil_Type19'],df_nunique['Soil_Type20'],df_nunique['Soil_Type21'],df_nunique['Soil_Type22'],\n            df_nunique['Soil_Type23'],df_nunique['Soil_Type24'],df_nunique['Soil_Type25'],df_nunique['Soil_Type26'],\n            df_nunique['Soil_Type27'],df_nunique['Soil_Type28'],df_nunique['Soil_Type29'],df_nunique['Soil_Type30'],\n            df_nunique['Soil_Type31'],df_nunique['Soil_Type32'],df_nunique['Soil_Type33'],df_nunique['Soil_Type33'],\n            df_nunique['Soil_Type34'],df_nunique['Soil_Type35'],df_nunique['Soil_Type36'],df_nunique['Soil_Type37'],\n            df_nunique['Soil_Type38'],df_nunique['Soil_Type39'],df_nunique['Soil_Type40']])","2e6712b7":"df_groupby = {var: pd.DataFrame(df_train.groupby([var, 'Cover_Type']).size()) \n              for var in {'Wilderness_Area1', 'Wilderness_Area2', 'Wilderness_Area3',\n       'Wilderness_Area4', 'Soil_Type1', 'Soil_Type2', 'Soil_Type3',\n       'Soil_Type4', 'Soil_Type5', 'Soil_Type6', 'Soil_Type7', 'Soil_Type8',\n       'Soil_Type9', 'Soil_Type10', 'Soil_Type11', 'Soil_Type12',\n       'Soil_Type13', 'Soil_Type14', 'Soil_Type15', 'Soil_Type16',\n       'Soil_Type17', 'Soil_Type18', 'Soil_Type19', 'Soil_Type20',\n       'Soil_Type21', 'Soil_Type22', 'Soil_Type23', 'Soil_Type24',\n       'Soil_Type25', 'Soil_Type26', 'Soil_Type27', 'Soil_Type28',\n       'Soil_Type29', 'Soil_Type30', 'Soil_Type31', 'Soil_Type32',\n       'Soil_Type33', 'Soil_Type34', 'Soil_Type35', 'Soil_Type36',\n       'Soil_Type37', 'Soil_Type38', 'Soil_Type39', 'Soil_Type40'}}\nmulti_table([df_groupby['Wilderness_Area1'], df_groupby['Wilderness_Area2'], \n             df_groupby['Wilderness_Area3'], df_groupby['Wilderness_Area4'], \n             df_groupby['Soil_Type1'], df_groupby['Soil_Type2'],df_groupby['Soil_Type3'],\n            df_groupby['Soil_Type4'],df_groupby['Soil_Type5'],df_groupby['Soil_Type6'],\n            df_groupby['Soil_Type7'],df_groupby['Soil_Type8'],df_groupby['Soil_Type9'],df_groupby['Soil_Type10'],\n            df_groupby['Soil_Type11'],df_groupby['Soil_Type12'],df_groupby['Soil_Type13'],df_groupby['Soil_Type14'],\n            df_groupby['Soil_Type15'],df_groupby['Soil_Type16'],df_groupby['Soil_Type17'],df_groupby['Soil_Type18'],\n            df_groupby['Soil_Type19'],df_groupby['Soil_Type20'],df_groupby['Soil_Type21'],df_groupby['Soil_Type22'],\n            df_groupby['Soil_Type23'],df_groupby['Soil_Type24'],df_groupby['Soil_Type25'],df_groupby['Soil_Type26'],\n            df_groupby['Soil_Type27'],df_groupby['Soil_Type28'],df_groupby['Soil_Type29'],df_groupby['Soil_Type30'],\n            df_groupby['Soil_Type31'],df_groupby['Soil_Type32'],df_groupby['Soil_Type33'],df_groupby['Soil_Type33'],\n            df_groupby['Soil_Type34'],df_groupby['Soil_Type35'],df_groupby['Soil_Type36'],df_groupby['Soil_Type37'],\n            df_groupby['Soil_Type38'],df_groupby['Soil_Type39'],df_groupby['Soil_Type40']])","16fa0fb3":"train_num_visual_0 = ['Elevation', 'Aspect', 'Slope',\n       'Horizontal_Distance_To_Hydrology', 'Vertical_Distance_To_Hydrology',\n       'Horizontal_Distance_To_Roadways', 'Hillshade_9am', 'Hillshade_Noon',\n       'Hillshade_3pm', 'Horizontal_Distance_To_Fire_Points']","54378d26":"sns.set_theme(rc = {'figure.dpi': 120, 'axes.labelsize': 8, \n                    'axes.facecolor': '#f0eee9', 'grid.color': '#fffdfa', \n                    'figure.facecolor': '#e8e6e1'}, font_scale = 0.65)\n\nfig, ax = plt.subplots(10, 1, figsize = (6, 30))\n\nfor indx, (column, axes) in list(enumerate(list(zip(train_num_visual_0, ax.flatten())))):\n    \n    sns.histplot(ax = axes, x = df_train[column], hue = df_train['Cover_Type'], \n                 palette = 'magma', alpha = 0.8, multiple = 'stack')\n    \n    legend = axes.get_legend() # sns.hisplot has some issues with legend\n    handles = legend.legendHandles\n    legend.remove()\n    axes.legend(handles, ['0', '1'], title = 'Cover_Type', loc = 'upper right')\n    Quantiles = np.quantile(df_train[column], [0, 0.25, 0.50, 0.75, 1])\n    \n    for q in Quantiles: axes.axvline(x = q, linewidth = 0.5, color = 'r')\n        \nplt.tight_layout()\nplt.show()","ef4295c6":"cat = ['Wilderness_Area1', 'Wilderness_Area2', 'Wilderness_Area3',\n       'Wilderness_Area4', 'Soil_Type1', 'Soil_Type2', 'Soil_Type3',\n       'Soil_Type4', 'Soil_Type5', 'Soil_Type6', 'Soil_Type7', 'Soil_Type8',\n       'Soil_Type9', 'Soil_Type10', 'Soil_Type11', 'Soil_Type12',\n       'Soil_Type13', 'Soil_Type14', 'Soil_Type15', 'Soil_Type16',\n       'Soil_Type17', 'Soil_Type18', 'Soil_Type19', 'Soil_Type20',\n       'Soil_Type21', 'Soil_Type22', 'Soil_Type23', 'Soil_Type24',\n       'Soil_Type25', 'Soil_Type26', 'Soil_Type27', 'Soil_Type28',\n       'Soil_Type29', 'Soil_Type30', 'Soil_Type31', 'Soil_Type32',\n       'Soil_Type33', 'Soil_Type34', 'Soil_Type35', 'Soil_Type36',\n       'Soil_Type37', 'Soil_Type38', 'Soil_Type39', 'Soil_Type40']","0a89fbbf":"sns.set_theme(rc = {'figure.dpi': 250, 'axes.labelsize': 7, \n                    'axes.facecolor': '#f0eee9', 'grid.color': '#fffdfa', \n                    'figure.facecolor': '#e8e6e1'}, font_scale = 0.55)\n\nfig, ax = plt.subplots(23, 2, figsize = (6.5, 80))\n\nfor indx, (column, axes) in list(enumerate(list(zip(cat, \n                                                    ax.flatten())))):\n    \n    sns.countplot(ax = axes, x = df_train[column], hue = df_train['Cover_Type'], \n                  palette = 'magma', alpha = 0.8)\n    \nelse:\n    [axes.set_visible(False) for axes in ax.flatten()[indx + 1:]]\n    \naxes_legend = ax.flatten()\n\naxes_legend[1].legend(title = 'Cover_Type', loc = 'upper right')\naxes_legend[2].legend(title = 'Cover_Type', loc = 'upper right')\n\nplt.tight_layout()\nplt.show()","63dbb88d":"if len(cat) == 0 :\n    print(\"No Categorical features\")\nelse:\n    ncols = 5\n    nrows = int(len(cat) \/ ncols + (len(df_train.columns[:-1]) % ncols > 0)) \n\n    fig, axes = plt.subplots(nrows, ncols, figsize=(18, 45), facecolor='#EAEAF2')\n\n    for r in range(nrows):\n        for c in range(ncols):\n            if r*ncols+c >= len(cat):\n                break\n            col = cat[r*ncols+c]\n            sns.countplot(x=df_train[col], ax=axes[r, c], palette = 'magma', label='Train data')\n            axes[r, c].set_ylabel('')\n            axes[r, c].set_xlabel(col, fontsize=8, fontweight='bold')\n            axes[r, c].tick_params(labelsize=5, width=0.5)\n            axes[r, c].xaxis.offsetText.set_fontsize(4)\n            axes[r, c].yaxis.offsetText.set_fontsize(4)\n    plt.show()","88b875ef":"df_test = df_test.drop(columns=['Id'])","f6558c90":"X = df_train.drop(columns=['Id','Cover_Type'])\ny = df_train['Cover_Type']","474fb836":"from sklearn.model_selection import train_test_split\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=48, shuffle =True)","b7bcc100":"from xgboost import XGBClassifier\n\nmodel = XGBClassifier(learning_rate=0.3,n_jobs=-1,\n                      tree_method='gpu_hist',\n                      random_state=0)\nmodel.fit(X_train,y_train)","be738999":"# validation prediction\npred=model.predict(X_test)","563f126f":"from sklearn.metrics import accuracy_score\nprint('Accuracy Score : ',accuracy_score(y_test, pred))","ae052a6a":"y_pred = model.predict(df_test)","15c92097":"submission = pd.read_csv('..\/input\/tabular-playground-series-dec-2021\/sample_submission.csv')\nsubmission['Cover_Type'] = y_pred\nsubmission.to_csv(\"submission.csv\",index=False)\nsubmission.head()","b9593eb0":"# Feature Selection","f21f422a":"# Data Visualization","ab4bad56":"#### Observation:\n\n1. Solid_Type7,Solid_Type15 are having only 0","381a82e4":"# Import Libraries","3b0f9d48":"#### Observation:\n1. We can see covertype of 5 doesnot present in other categorical column which have value 1","69154f36":"# Loading Dataset","6cdb933c":"# Data Modeling","2ced625a":"# Exploratory Data Analysis","09d6d384":"## Work in Progress"}}