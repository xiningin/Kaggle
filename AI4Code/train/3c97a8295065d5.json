{"cell_type":{"77c6210a":"code","1fa038c9":"code","640f0872":"code","3e533add":"code","7f7c1415":"code","015d488b":"code","6ff4e9be":"code","8abde70f":"code","00f1ff70":"code","fb19eb8f":"code","049f5e6b":"code","4e1005b0":"code","96c18984":"code","fa3c7198":"code","fba9c938":"code","71900230":"code","f1d17497":"code","6b11e49e":"code","b113640b":"code","512d7495":"code","3bae3fac":"code","0b4a3fef":"code","64f07301":"code","28a99891":"code","0cb651d3":"code","e8f532c9":"code","861d0f14":"code","ee37117a":"code","b26ec458":"code","23f559f2":"code","95dc5573":"code","45f1d1c2":"code","fda70d85":"code","aecd7f48":"code","df4fcdef":"code","8698769d":"code","b1e3c872":"code","0dffd70f":"code","23fa6607":"code","a630c9b3":"markdown","226e506a":"markdown","911a289f":"markdown","9d7acf04":"markdown","75a7ded8":"markdown","9e85f2d1":"markdown","fb9bc190":"markdown","091b1595":"markdown","b9911716":"markdown","1e3def79":"markdown","e091c9e7":"markdown","6f4af32a":"markdown","d0322b9f":"markdown"},"source":{"77c6210a":"import pandas as pd\nimport sklearn","1fa038c9":"adult = pd.read_csv(\"..\/input\/datapmr\/train_data.csv\",\n        engine='python',\n        na_values=\"?\")","640f0872":"adult.shape","3e533add":"adult.head()","7f7c1415":"import matplotlib.pyplot as plt","015d488b":"adult['income'].value_counts().plot(kind='bar')","6ff4e9be":"adult['occupation'].value_counts().plot(kind='bar')","8abde70f":"adult['native.country'].value_counts().plot(kind='pie')","00f1ff70":"sexo = pd.crosstab(adult['income'], adult['sex'], margins = True, normalize = 'columns')\nsexo","fb19eb8f":"sexo.plot(kind='bar')","049f5e6b":"#marital.status\nestado_civil = pd.crosstab(adult['income'], adult['marital.status'], margins = True,\n                           normalize = 'columns')\nestado_civil","4e1005b0":"#occupation\nocupacao = pd.crosstab(adult['income'], adult['occupation'], margins = True,\n                           normalize = 'columns')\nocupacao","96c18984":"#relationship\nrelacao = pd.crosstab(adult['income'], adult['relationship'], margins = True,\n                           normalize = 'columns')\nrelacao","fa3c7198":"#workclass\nworkclass = pd.crosstab(adult['income'], adult['workclass'], margins = True,\n                           normalize = 'columns')\nworkclass","fba9c938":"#race\nraca = pd.crosstab(adult['income'], adult['race'], margins = True,\n                           normalize = 'columns')\nraca","71900230":"adult['race'].value_counts().plot(kind='bar')","f1d17497":"#education\neducacao = pd.crosstab(adult['income'], adult['education'], margins = True,\n                           normalize = 'columns')\neducacao","6b11e49e":"#education\neducacao = pd.crosstab(adult['income'], adult['education.num'], margins = True,\n                           normalize = 'columns')\neducacao","b113640b":"dado_n_num_sexo = ['Female', 'Male']\ndado_num_sexo = [10.9, 30.5]\n\ndado_n_num_estciv = ['Divorced', 'Married-AF-spouse', 'Married-civ-spouse',\n              'Married-spouse-absent', 'Never-married', 'Separated', 'Widowed']\ndado_num_estciv = [10.4, 43.5, 44.7, 8.1, 4.6, 6.4, 8.6]\n\ndado_n_num_ocup = ['Adm-clerical', 'Armed-forces', 'Craft-repair', 'Exec-managerial',\n                     'Farming-fishing', 'Handlers-cleaner', 'Machine-op-inspct', 'Other-service',\n                    'Priv-house-serv', 'Prof-specialty', 'Protective-serv', 'Sales', 'Tech-support',\n                    'Transport-moving']\ndado_num_ocup = [13.4, 11.1, 22.7, 48.4, 11.6, 6.3, 12.5, 4.2, 0.7, 44.9, 32.5, 26.9, 30.5, 20.0]\n\ndado_n_num_rela = ['Husband', 'Not-in-family', 'Other-relative', 'Own-child', 'Unmarried', 'Wife']\ndado_num_rela = [44.9, 10.3, 3.8, 1.3, 6.3, 47.5]\n\ndado_n_num_work = ['Federal-gov','Local-gov', 'Never-worked','Private', 'Self-emp-inc',\n                   'Self-emp-not-inc', 'State-gov', 'Without-pay']\ndado_num_work = [38.6, 29.5, 0, 21.9, 55.7, 28.5, 27.2, 0]\n\ndado_n_num_race = ['Amer-Indian-Eskimo', 'Asian-Pac-Islander', 'Black', 'Other', 'White']\ndado_num_race = [11.6, 26.6, 12.4, 9.2, 25.6]\n\ndado_n_num_inc = ['>50K', '<=50K']\ndado_num_inc = [0, 1]\n\ndado_n_num =( dado_n_num_sexo + dado_n_num_estciv + dado_n_num_ocup + dado_n_num_rela \n             +dado_n_num_work+dado_n_num_race+dado_n_num_inc)\ndado_num =( dado_num_sexo + dado_num_estciv + dado_num_ocup + dado_num_rela +dado_num_work\n           +dado_num_race +dado_num_inc)","512d7495":"#Fun\u00e7\u00e3o para substituir os valores n\u00e3o numericos\ndef num_func(label):\n    for i in range(len(dado_n_num)):\n        if label == dado_n_num[i]:\n            return dado_num[i]\n    return label","3bae3fac":"adult['sex'] = adult['sex'].apply(num_func)\nadult['marital.status'] = adult['marital.status'].apply(num_func)\nadult['occupation'] = adult['occupation'].apply(num_func)\nadult['relationship'] = adult['relationship'].apply(num_func)\nadult['workclass'] = adult['workclass'].apply(num_func)\nadult['race'] = adult['race'].apply(num_func)","0b4a3fef":"#>50K e <=50k tamb\u00e9m s\u00e3o valores n\u00e3o numericos\n\nadult['income'] = adult['income'].apply(num_func)","64f07301":"nadult = adult.dropna()","28a99891":"nadult","0cb651d3":"nadult.corr(method='pearson').income.sort_values(ascending=True)","e8f532c9":"testadult = pd.read_csv(\"..\/input\/datapmr\/test_data.csv\",\n        sep=r'\\s*,\\s*',\n        engine='python',\n        na_values=\"?\")","861d0f14":"testadult['sex'] = testadult['sex'].apply(num_func)\ntestadult['marital.status'] = testadult['marital.status'].apply(num_func)\ntestadult['occupation'] = testadult['occupation'].apply(num_func)\ntestadult['relationship'] = testadult['relationship'].apply(num_func)\ntestadult['workclass'] = testadult['workclass'].apply(num_func)\ntestadult['race'] = testadult['race'].apply(num_func)","ee37117a":"ntestadult = testadult.dropna()","b26ec458":"Xadult = nadult[['relationship', 'marital.status', 'education.num', 'age','hours.per.week',\n                  'capital.gain', 'sex', 'race', 'capital.loss']]\nYadult = nadult.income\nXtadult = testadult[['relationship', 'marital.status', 'education.num', 'age', 'hours.per.week',\n                       'capital.gain', 'sex', 'race', 'capital.loss']]","23f559f2":"from sklearn.neighbors import KNeighborsClassifier\nknn = KNeighborsClassifier(n_neighbors=30)","95dc5573":"from sklearn.model_selection import cross_val_score","45f1d1c2":"scores = cross_val_score(knn, Xadult, Yadult, cv=10)\nscores","fda70d85":"knn.fit(Xadult,Yadult)","aecd7f48":"YtestPred = knn.predict(Xtadult)\nYtestPred","df4fcdef":"from sklearn.metrics import accuracy_score","8698769d":"accuracy_score(Yadult,knn.predict(Xadult))","b1e3c872":"resultado = pd.DataFrame(testadult.index)\nresultado[\"income\"] = YtestPred","0dffd70f":"#Lembrando da fun\u00e7\u00e3o para substituir os valores n\u00e3o numericos,\n#podemos usar ela para o oposto\ndef subs(label):\n    if label == 0:\n        return \"<=50K\"\n    else:\n        return \">50K\"","23fa6607":"resultado[\"income\"]=resultado[\"income\"].apply(subs)\nresultado.columns = ['Id', 'income']\nresultado.to_csv('resultado.csv', index=False)","a630c9b3":"PMR3508 - Aprendizado de m\u00e1quina e reconhecimento de padr\u00f5es\n   An\u00e1lise da base Adult","226e506a":"Fazendo o kNN k=30","911a289f":"Come\u00e7ando a analise a partir do Sexo por ser mais simples:","9d7acf04":"Primeiramente: Analisar as rela\u00e7\u00f5es entre dados n\u00e3o numericos com o income\nex: marital.status, occupation, relationship, race, sex e native.country","75a7ded8":"Isso nos d\u00e1 as porcentagens que tem income >50k, no caso, 10% das mulheres tem income >50k \ne 30% dos homens tem income>50k","9e85f2d1":"Agora fazendo o mesmo para os outros dados","fb9bc190":"Isso ser\u00e1 relevante na hora de decidir quais dados analisar, pois dados como 'race' e 'native.country' que tem um valor em uma quantidade muito maior e os outros escassos n\u00e3o ser\u00e3o bons dados de analise","091b1595":"Note que education.num j\u00e1 associa valores numericos aos dados education e de forma ordenada (16 tem a maior porcentagem de pessoas com income>50k)\nA partir dos valores adquiridos, podemos transfomar relacionar esses dados com numeros, em especial, porcentagens.","b9911716":"Portanto, teremos que os dados de maior modulo tem maior correla\u00e7\u00e3o com income. Estes ser\u00e3o:\nRelationship, Marital.status, Education.num, Age, Hours.per.week, capital.gain e sex. (Todos tem corr>0.2)","1e3def79":"Agora que todos os valores s\u00e3o numericos, podemos aplicar a fun\u00e7\u00e3o de correla\u00e7\u00e3o do Pandas","e091c9e7":"Como o objetivo \u00e9 prever um income >50k, devemos analisar com base nele sempre.","6f4af32a":"Agora que analisamos os dados, vamos para a aplica\u00e7\u00e3o do kNN","d0322b9f":"No caso do race, podemos perceber que ele se aproxima bastante para o valor de All para brancos e Asian-Pac-Islander, isso pode representar que h\u00e1 uma quantidade muito maior de ambos, podemos verificar com um gr\u00e1fico."}}