{"cell_type":{"b763eb9f":"code","f5e1aae9":"code","f13d3b32":"code","b202caf0":"code","87a064a2":"code","ea8f6335":"markdown","6dcd3681":"markdown","78af573e":"markdown"},"source":{"b763eb9f":"import os\nimport keras\nfrom PIL import Image\nimport numpy as np\nimport pandas as pd","f5e1aae9":"\nmodel = keras.models.load_model('..\/input\/model-4\/model_4.h5')","f13d3b32":"model.load_weights('..\/input\/new-model\/temp_3.h5')","b202caf0":"\ntest_dir = '..\/input\/cassava-leaf-disease-classification\/test_images\/'\ntest_images = os.listdir(test_dir)\npredictions = []\n\nfor image in test_images:\n    img = Image.open(test_dir + image)\n    img = img.resize([512,512])\n    img = np.expand_dims(img, axis=0)\n    predictions.extend(model.predict(img).argmax(axis = 1))\n\n\nsub = pd.DataFrame({'image_id': test_images, 'label': predictions})\ndisplay(sub)","87a064a2":"sub.to_csv('submission.csv', index = False)","ea8f6335":"load weights","6dcd3681":"Load model","78af573e":"test_data"}}