{"cell_type":{"fa420ec5":"code","d5f0757d":"code","f777b09d":"code","6495aad6":"code","a9c70a2f":"code","e7b2910b":"code","865ea625":"code","a4bbf582":"code","f868839b":"code","ee73a0f0":"code","95f0f6d9":"code","004ee290":"code","2b18b9b6":"code","9f91bc31":"code","35250f4e":"code","33d4a5b9":"code","8f6fe6ea":"code","bf913e9b":"code","94025e88":"code","a6f9c3e7":"code","b4d96fd8":"code","7b6dc63f":"code","ffeb27ef":"code","4678050a":"code","4a9ceb3a":"code","1d937be7":"code","bca2478a":"code","7708c300":"code","c2a02878":"code","ca58a7f2":"code","840a266d":"code","339e96a3":"code","7261cb7c":"code","b53ceedf":"code","d2431767":"code","8708de72":"code","a78120fe":"code","b6d6824d":"code","8eb982bc":"code","d78c500c":"code","991bf809":"code","71025ddd":"code","c6ed8900":"code","232bc4a7":"code","9f99b6c8":"code","7bf501ee":"code","25806b33":"code","9ee38d2a":"code","aaef4970":"code","1fbaf257":"code","3530dacb":"code","063bd1a9":"code","f0823b29":"code","71f50e42":"code","1c2932d6":"code","db0baa74":"markdown","f58ef106":"markdown","d8cb46e2":"markdown","7a03001d":"markdown","4c317f74":"markdown","3f4ab97d":"markdown","8685963c":"markdown","578e0c2c":"markdown","071cf246":"markdown"},"source":{"fa420ec5":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport datetime, warnings, scipy \n\nimport plotly.offline as py\nimport plotly.figure_factory as ff\npy.init_notebook_mode(connected=True)\nimport plotly.graph_objs as go\nfrom plotly import tools\nfrom plotly.subplots import make_subplots","d5f0757d":"flights = pd.read_csv(\"..\/input\/flight-delays\/flights.csv\")","f777b09d":"airports = pd.read_csv(\"..\/input\/flight-delays\/airports.csv\")\nairlines = pd.read_csv(\"..\/input\/flight-delays\/airlines.csv\")","6495aad6":"flights.info()","a9c70a2f":"airports.info()","e7b2910b":"airlines.info()","865ea625":"flights.describe()","a4bbf582":"flights.head()\n","f868839b":"flights.tail()","ee73a0f0":"airlines.head()","95f0f6d9":"airlines.tail()","004ee290":"airports.head(10)","2b18b9b6":"airports.tail(15)","9f91bc31":"airports.isnull().sum()","35250f4e":"airports = airports.dropna(subset = [\"LATITUDE\",\"LONGITUDE\"])","33d4a5b9":"airports.isnull().sum()","8f6fe6ea":"flights_null = flights.isnull().sum()*100\/flights.shape[0]\nflights_null","bf913e9b":"flights1 = flights.dropna(subset = [\"TAIL_NUMBER\",'DEPARTURE_TIME','DEPARTURE_DELAY','TAXI_OUT','WHEELS_OFF','SCHEDULED_TIME',\n             'ELAPSED_TIME','AIR_TIME','WHEELS_ON','TAXI_IN','ARRIVAL_TIME','ARRIVAL_DELAY'])","94025e88":"flights1.isnull().sum()","a6f9c3e7":"# Creting Dataset w.r.t different Types of Delays\nflights11 = flights1.dropna(subset = ['AIR_SYSTEM_DELAY','SECURITY_DELAY','AIRLINE_DELAY','LATE_AIRCRAFT_DELAY','WEATHER_DELAY'])\nflights11 = flights11.drop(['YEAR','MONTH','DAY','DAY_OF_WEEK','TAIL_NUMBER','SCHEDULED_DEPARTURE','DEPARTURE_TIME','SCHEDULED_TIME',\n                     'SCHEDULED_ARRIVAL','ARRIVAL_TIME','DIVERTED','CANCELLED','CANCELLATION_REASON','FLIGHT_NUMBER','WHEELS_OFF',\n                     'WHEELS_ON','AIR_TIME'],axis = 1)\nflights11.info()","b4d96fd8":"# The other Dataset\nFlight_Delays = flights11","7b6dc63f":"# Creating Dataset by removing null values by not focussing fully on different types of Delays\nflights2 = flights1.drop(['CANCELLATION_REASON','AIR_SYSTEM_DELAY','SECURITY_DELAY','AIRLINE_DELAY',\n                    'LATE_AIRCRAFT_DELAY','WEATHER_DELAY'],axis = 1)\nflights2.isnull().sum()","ffeb27ef":"flights2.info()","4678050a":"#we need to change the data type to datetime format\nflights2.DEPARTURE_TIME.head(10)","4a9ceb3a":"# Creating a function to change the way of representation of time in the column\ndef Format_Hourmin(hours):\n        if hours == 2400:\n            hours = 0\n        else:\n            hours = \"{0:04d}\".format(int(hours))\n            Hourmin = datetime.time(int(hours[0:2]), int(hours[2:4]))\n            return Hourmin","1d937be7":"flights2['Actual_Departure'] =flights1['DEPARTURE_TIME'].apply(Format_Hourmin)\nflights2['Actual_Departure'].head(10)","bca2478a":"flights2.columns","7708c300":"flights2['DATE'] = pd.to_datetime(flights2[['YEAR','MONTH','DAY']])\nflights2.DATE.head(10)","c2a02878":"flights2['DAY'] = flights2['DATE'].dt.weekday_name","ca58a7f2":"# Applying the function to required variables in the dataset\nflights2['Actual_Departure'] =flights2['DEPARTURE_TIME'].apply(Format_Hourmin)\nflights2['Scheduled_Arrival'] =flights2['SCHEDULED_ARRIVAL'].apply(Format_Hourmin)\nflights2['Scheduled_Departure'] =flights2['SCHEDULED_DEPARTURE'].apply(Format_Hourmin)\nflights2['Actual_Arrival'] =flights2['ARRIVAL_TIME'].apply(Format_Hourmin)","840a266d":"# Merging on AIRLINE and IATA_CODE\nflights2 = flights2.merge(airlines, left_on='AIRLINE', right_on='IATA_CODE', how='inner')","339e96a3":"flights2 = flights2.drop(['AIRLINE_x','IATA_CODE'], axis=1)\nflights2 = flights2.rename(columns={\"AIRLINE_y\":\"AIRLINE\"})","7261cb7c":"flights2 = flights2.merge(airports, left_on='ORIGIN_AIRPORT', right_on='IATA_CODE', how='inner')\nflights2 = flights2.merge(airports, left_on='DESTINATION_AIRPORT', right_on='IATA_CODE', how='inner')","b53ceedf":"flights2.columns","d2431767":"flights2 = flights2.drop(['LATITUDE_x', 'LONGITUDE_x',\n       'STATE_y', 'COUNTRY_y', 'LATITUDE_y', 'LONGITUDE_y','STATE_x', 'COUNTRY_x'], axis=1)\nflights2 = flights2.rename(columns={'IATA_CODE_x':'Org_Airport_Code','AIRPORT_x':'Org_Airport_Name','CITY_x':'Origin_city',\n                             'IATA_CODE_y':'Dest_Airport_Code','AIRPORT_y':'Dest_Airport_Name','CITY_y':'Destination_city'})\n","8708de72":"flights2","a78120fe":"#airports with the most flights\n\nF=flights2.Org_Airport_Name.value_counts().sort_values(ascending=False)[:20]\nprint(F)","b6d6824d":"F=flights2.Org_Airport_Name.value_counts().sort_values(ascending=False)[:15]\nlabel=F.index\nsize=F.values\ncolors = ['skyblue', '#FEBFB3', '#96D38C', '#D0F9B1', 'gold', 'orange', 'lightgrey', \n          'lightblue','lightgreen','aqua','yellow','#D4E157','#D1C4E9','#1A237E','#64B5F6','#009688',\n          '#1DE9B6','#66BB6A','#689F38','#FFB300']\ntrace =go.Pie(labels=label, values=size, marker=dict(colors=colors), hole=.1)\ndata = [trace]\nlayout = go.Layout(title='Origin Airport Distribution')\nfig=go.Figure(data=data,layout=layout)\npy.iplot(fig)","8eb982bc":"#cities with the most flights\nF=flights2.Origin_city.value_counts().sort_values(ascending=False)[:15]\nprint(F)","d78c500c":"#Cities from most flights\nF=flights2.Destination_city.value_counts().sort_values(ascending=False)[:15]\nprint(F)","991bf809":"F=flights2.Origin_city.value_counts().sort_values(ascending=False)[:15]\n\ntrace1 = go.Bar(x=F.index,y=F.values,marker=dict(color = '#009688'))\n                                                      \nF = flights2.Destination_city.value_counts().sort_values(ascending=False)[:15]\n\ntrace2 = go.Bar(x=F.index, y=F.values, marker=dict( color ='#689F38' ))\n \nfig = tools.make_subplots(rows=1, cols=2, subplot_titles=('Origin City','Destination City'))                                                        \n \nfig.add_trace(trace1, 1,1) \nfig.add_trace(trace2, 1,2)  \nfig['layout'].update(yaxis = dict(title = 'Values'), height=500, width=900, showlegend=False)\npy.iplot(fig)                                                          ","71025ddd":"F=flights2.AIRLINE.value_counts().sort_values(ascending=False)[:7]\nprint(F)","c6ed8900":"F=flights2.AIRLINE.value_counts().sort_values(ascending=True)[:7]\nprint(F)","232bc4a7":"#airlines flight rankings\nF=flights2.AIRLINE.value_counts().sort_values(ascending=False)[:8]\ntrace1 = go.Scatter(x=F.index, y=F.values,name='Most Flights',marker=dict(color='blue'))\n\nF=flights2.AIRLINE.value_counts().sort_values(ascending=True)[:7].iloc[::-1]\ntrace2 = go.Scatter(x=F.index, y=F.values,name='Least Flights',marker=dict(color='yellow'))\n\ndata=[trace1,trace2]\nlayout = dict(title = 'Airline distribution')\nfig = dict(data=data,layout = layout)\npy.iplot(fig)\n\n","9f99b6c8":"F=flights2.MONTH.value_counts().to_frame().reset_index().sort_values(by='index')\nF.columns=['Month','Flight_Values']\nprint(F)","7bf501ee":"#number of flights per month\nF=flights2.MONTH.value_counts().to_frame().reset_index().sort_values(by='index')\nF.columns=['Month','Flight_Values']\nMonth={1: 'Jan', 2: 'Feb', 3: 'Mar', 4: 'Apr', 5: 'May',6: 'Jun',\n       7: 'Jul', 8: 'Aug', 9: 'Sep', 10: 'Oct', 11: 'Nov', 12: 'Dec'}\nF.Month=F.Month.map(Month)\ncolors = ['skyblue', '#FEBFB3', '#96D38C', '#D0F9B1','lightblue','lightgreen',\n          'aqua','yellow','#D4E157','#D1C4E9','#1A237E','#64B5F6']\ntrace=go.Bar(x=F.Month,y=F.Flight_Values,marker=dict(color=colors))\ndata=[trace]\nlayout = go.Layout(title='Monthly Flights',yaxis=dict(title='Flights Value'),height=500, width=800)\nfig = go.Figure(data=data, layout=layout)\npy.iplot(fig)   \n\n","25806b33":"#number of flights per week\nFlight_Valume=flights2.pivot_table(index='Origin_city',columns='DAY_OF_WEEK',values='DAY',aggfunc=lambda x:x.count())\nF=Flight_Valume.sort_values(by=1,ascending=False)[:7]\nprint(F)\n","9ee38d2a":"Flight_Valume=flights2.pivot_table(index='Origin_city',columns='DAY_OF_WEEK',values='DAY',aggfunc=lambda x:x.count())\nF=Flight_Valume.sort_values(by=1,ascending=False)[:7]\nF=F.iloc[::-1]\nfig = plt.figure(figsize=(16,9))\nsns.heatmap(F, cmap='RdBu', linecolor='black', linewidths=1)\nplt.title('Air Traffic by Cities',size=16)\nplt.ylabel('City',size=16)\nplt.xticks(rotation=45)\nplt.show()","aaef4970":"#number of departure delays\nF=flights2.groupby('AIRLINE').DEPARTURE_DELAY.mean().to_frame().sort_values(by='DEPARTURE_DELAY',ascending=False).round(3)\nprint(F)\n","1fbaf257":"#number of arrival delays\nF=flights2.groupby('AIRLINE').ARRIVAL_DELAY.mean().to_frame().sort_values(by='ARRIVAL_DELAY',ascending=False).round(3)\nprint(F)","3530dacb":"F=flights2.groupby('AIRLINE').DEPARTURE_DELAY.mean().to_frame().sort_values(by='DEPARTURE_DELAY',ascending=False).round(3)\ntrace1=go.Bar(x=F.index, y=F.DEPARTURE_DELAY ,name='DEPARTURE_DELAY', marker=dict(color='navy'))\nF=flights2.groupby('AIRLINE').ARRIVAL_DELAY.mean().to_frame().sort_values(by='ARRIVAL_DELAY',ascending=False).round(3)\ntrace2=go.Bar(x=F.index, y=F.ARRIVAL_DELAY, name='ARRIVAL_DELAY', marker=dict(color='red'))\ndata=[trace1, trace2]\nlayout= go.Layout(xaxis=dict(tickangle=90),title='Mean Arrival & Departure Delay by Airlines', yaxis=dict(title='Minute'), barmode='stack')\nfig=go.Figure(data=data, layout=layout)\npy.iplot(fig)\n","063bd1a9":"flights2['Delay_Difference'] = flights2['DEPARTURE_DELAY'] - flights2['ARRIVAL_DELAY']\nF=flights2.groupby('AIRLINE').Delay_Difference.mean().to_frame().sort_values(by='Delay_Difference', ascending=False).round(3)\nprint(F)","f0823b29":"flights2['Delay_Difference'] = flights2['DEPARTURE_DELAY'] - flights2['ARRIVAL_DELAY']\nF=flights2.groupby('AIRLINE').Delay_Difference.mean().to_frame().sort_values(by='Delay_Difference', ascending=False).round(3)\ntrace=go.Bar(x=F.index, y=F.Delay_Difference, marker=dict(color = F.Delay_Difference, colorscale='Cividis',showscale=True))\ndata=[trace]\nlayout = go.Layout(xaxis=dict(tickangle=45),title='Mean (Departure Delay - Arrival Delay) by Airlines', yaxis = dict(title = 'Minute'))\nfig = go.Figure(data=data, layout=layout)\npy.iplot(fig)                                ","71f50e42":"flights2['Taxi_Difference'] = flights2['TAXI_OUT'] - flights2['TAXI_IN']\nF = flights2.groupby('AIRLINE').Taxi_Difference.mean().to_frame().sort_values(by='Taxi_Difference',ascending=False).round(2)\nprint(F)","1c2932d6":"flights2['Taxi_Difference'] = flights2['TAXI_OUT'] - flights2['TAXI_IN']\nF = flights2.groupby('AIRLINE').Taxi_Difference.mean().to_frame().sort_values(by='Taxi_Difference',ascending=False).round(2)\n\ntrace = go.Bar(x=F.index, y=F.Taxi_Difference, marker=dict(color = F.Taxi_Difference,colorscale='viridis',showscale=True))\n\ndata = [trace]\nlayout = go.Layout(xaxis=dict(tickangle=45),title='Mean (Taxi Out - Taxi In) by Airlines', yaxis = dict(title = 'Minute'))\nfig = go.Figure(data=data, layout=layout)\npy.iplot(fig)","db0baa74":"**What is Data Analysis?**\n\nThe process of analyzing, cleaning, transforming and modeling data to find useful information, draw conclusions, and support decision-making is called Data Analysis.\n\nThere are various techniques and approaches for data analysis.\nData analysis in statistics is generally divided into descriptive statistics, EDA (Exploratory Data Analysis) and  CDA (Confirmatory Data Analysis). Data removal is the process of correcting outliers and other incorrect and unwanted information.\n\nDepending on the type of data to be cleaned, there are several data cleanup operations to use.\n\nData analysis is a key component of data mining and Business Intelligence (BI) and plays a key role in gaining insight into business decisions. Organizations analyze data from multiple sources using large data management solutions and customer experience management solutions that use data analysis to convert data into process analysis.","f58ef106":"**Type of Data**","d8cb46e2":"**Data Cleaning**\nFrom the above table it is clear that data is not properly organised and date is given seperated and many columns have unnecessary data not useful for visualization for which it is required that we clean the data and take only those columns which is of our use.","7a03001d":"**Merging of 3 Data Sets**\n\nSince there are three dataset it is required to merge all the three data set so that we can use it during the visualization in a proper way.","4c317f74":"[![Ekran%20Al%C4%B1nt%C4%B1s%C4%B1.PNG](attachment:Ekran%20Al%C4%B1nt%C4%B1s%C4%B1.PNG)](http:\/\/)","3f4ab97d":"In this analysis, I developed a model aimed at predicting flight delays at the Destination Airport. The purpose is to create a Data set which can be used for visualization and model Building so as to predict the Delays of Flights. I did the visualization so as to get better inferences about the data. For, model fitting I have seperated the Dataset into training Data and Testing Data so that prediction can be done on the testing Data. I also showed how to import Tableau and make visualization more crisp and clear.\n\n**Technical aspect Covered**:\n\n**visualization**: matplolib, seaborn\n\n**data manipulation**: pandas, numpy\n\n**modeling**: sklearn\n\n\nFor EDA I used some part of Python coding and Tableau Visulization so as to get a brief insight and inference from the data. Various Plots are created so as to get a great idea of whats happening in the Dataset and what is the most important variable affecting the dalays of the airlines. Feature scaling is a method used to normalize the range of independent variables or features of data and this concept is used.","8685963c":"**Data Visualization**","578e0c2c":"**Reading the Data Sets**","071cf246":"**Data Analysis Model**\n\n**Decision-making objectives**:The goals, metrics, or performance indicators of data science teams should be identified early to develop a measurable way to determine whether the business is moving towards its goals.\n\n**Data collecting**:As much data as possible should be collected from various sources in order to create better models and obtain further actionable information.\n\n**Data cleaning**: Data quality should be improved and the process should be automated in order to produce the right results and not to produce wrong results, but employees need to check the data cleanliness and ensure accuracy.\n\n**Raising a data science team**: When establishing a science team, infrastructure engineers, software developers, ETL experts and experts with advanced statistical knowledge should be involved. The established team should then be provided with large-scale data analysis platforms that are needed to automate data collection and analysis.\n\n**Optimization and Repetition**: Excellence can be achieved by repeating processes to create accurate predictions, achieve goals, and monitor and report consistently."}}