{"cell_type":{"c7406da4":"code","b02ce9e1":"code","e97f4fa0":"code","f6fd3f92":"code","dae7ef74":"code","bd96329a":"code","f3fe3d59":"code","b763df96":"code","1c612a56":"code","1f7cfb0d":"code","fea282af":"code","4a42420d":"code","a6e0fe58":"code","945e9c4e":"code","13fcabbb":"code","edfdb3b6":"code","18ff8b06":"code","79bd8fa2":"markdown"},"source":{"c7406da4":"%config Completer.use_jedi = False","b02ce9e1":"from fastai.vision.all import *","e97f4fa0":"train_df = pd.read_csv('\/kaggle\/input\/digit-recognizer\/train.csv')\ntrain_df.head()","f6fd3f92":"train_df.dtypes","dae7ef74":"train_df = train_df.astype(np.uint8)","bd96329a":"def get_x(x): return x.drop('label').values.reshape(28, 28)","f3fe3d59":"get_x(train_df.loc[3]).dtype","b763df96":"plt.imshow(get_x(train_df.loc[3]), cmap = 'gray');","1c612a56":"dblock = DataBlock(\n    blocks = [ImageBlock(cls = PILImageBW), CategoryBlock],\n    splitter = RandomSplitter(valid_pct = 0.2, seed = 42),\n    get_y = ColReader('label'),\n    get_x = get_x,\n)\ndls = dblock.dataloaders(train_df, num_workers = 4, bs = 256)\ndls.show_batch()","1f7cfb0d":"learn = cnn_learner(dls, resnet50, metrics = accuracy)\nlearn.fine_tune(10)","fea282af":"interp = ClassificationInterpretation.from_learner(learn)\ninterp.plot_confusion_matrix()","4a42420d":"test_df = pd.read_csv('\/kaggle\/input\/digit-recognizer\/test.csv')\ntest_df['label'] = 0\ntest_df = test_df.astype(np.uint8)","a6e0fe58":"test_dl = dls.test_dl(test_df)","945e9c4e":"preds,_ = learn.get_preds(dl=test_dl)","13fcabbb":"preds.shape","edfdb3b6":"preds[0]","18ff8b06":"submission = pd.DataFrame({'ImageId': tensor(range(len(preds))) + 1, 'Label': preds.argmax(dim=1)})\nsubmission.to_csv('submission.csv', index=False)\nsubmission.head()","79bd8fa2":"## Inference"}}