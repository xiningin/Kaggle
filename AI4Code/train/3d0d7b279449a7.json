{"cell_type":{"57c28611":"code","fc8b3299":"code","e370bcfb":"code","2173b31a":"code","9dabc891":"code","dd1a31f3":"code","950fa10b":"code","b4b42bb3":"code","257d3550":"code","2f897d36":"code","aa0b2a55":"code","f2e3090f":"code","cd42a940":"code","f148f307":"code","a6a84b91":"code","8c329b14":"code","dc5018f0":"code","8b54d8d1":"markdown"},"source":{"57c28611":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","fc8b3299":"import pandas as pd\ntrain_data=pd.read_csv('\/kaggle\/input\/nlp-getting-started\/train.csv')","e370bcfb":"len(train_data[train_data['target']==0]),len(train_data[train_data['target']==1])","2173b31a":"test_data = pd.read_csv('\/kaggle\/input\/nlp-getting-started\/test.csv')\ntest_data.head()","9dabc891":"sample_submission = pd.read_csv('\/kaggle\/input\/nlp-getting-started\/sample_submission.csv')\nsample_submission.head()","dd1a31f3":"train_data = train_data.drop(['keyword', 'location', 'id'], axis=1)\ntrain_data.head()","950fa10b":"import re\ndef  clean_text(df, text_field):\n    df[text_field] = df[text_field].str.lower()\n    df[text_field] = df[text_field].apply(lambda elem: re.sub(r\"(@[A-Za-z0-9]+)|([^0-9A-Za-z \\t])|(\\w+:\\\/\\\/\\S+)|^rt|http.+?\", \"\", elem))  \n    return df\ndata_clean = clean_text(train_data, \"text\")\ndata_clean.head()","b4b42bb3":"import nltk.corpus\n#nltk.download('stopwords')","257d3550":"from nltk.corpus import stopwords","2f897d36":"stop = stopwords.words('english')","aa0b2a55":"data_clean['text'] = data_clean['text'].apply(lambda x: ' '.join([word for word in x.split() if word not in (stop)]))\ndata_clean.head()","f2e3090f":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(data_clean['text'],data_clean['target'],random_state = 0)\nfrom sklearn.feature_extraction.text import TfidfVectorizer\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.feature_extraction.text import CountVectorizer\nfrom sklearn.feature_extraction.text import TfidfTransformer\nfrom sklearn.linear_model import SGDClassifier\npipeline_sgd = Pipeline([\n    ('vect', CountVectorizer()),\n    ('tfidf',  TfidfTransformer()),\n    ('nb', SGDClassifier()),\n])\nmodel = pipeline_sgd.fit(X_train, y_train)","cd42a940":"from sklearn.metrics import classification_report\ny_predict = model.predict(X_test)\nprint(classification_report(y_test, y_predict))\n","f148f307":"submission_test_clean = test_data.copy()\nsubmission_test_clean = clean_text(submission_test_clean, \"text\")\nsubmission_test_clean['text'] = submission_test_clean['text'].apply(lambda x: ' '.join([word for word in x.split() if word not in (stop)]))\nsubmission_test_clean = submission_test_clean['text']\nsubmission_test_clean.head()","a6a84b91":"submission_test_pred = model.predict(submission_test_clean)","8c329b14":"id_col = test_data['id']\nsubmission_df_1 = pd.DataFrame({\n                  \"id\": id_col, \n                  \"target\": submission_test_pred})\nsubmission_df_1.head()","dc5018f0":"submission_df_1.to_csv('submission_1.csv', index=False)","8b54d8d1":"### Replicating the steps mentioned by Rebecca here : https:\/\/towardsdatascience.com\/how-to-enter-your-first-kaggle-competition-4717e7b232db in this notebook"}}