{"cell_type":{"fe27347a":"code","9fa19272":"code","90901e54":"code","4d2916e7":"code","b88d3ca8":"code","a40c225f":"code","5a03c810":"code","22854dca":"code","c61ab19a":"code","7b9a9ff6":"code","7507adf3":"code","d33d227e":"code","a6b6c2ff":"code","bdbaf72a":"code","7d8f61d3":"code","b66aea76":"code","86bdbb26":"code","9ea47f02":"code","c4ed5c18":"code","8d2596f1":"code","c9ff75b1":"code","4baea5cf":"code","0142f9bb":"code","30e4c31f":"code","263d491e":"code","0ea65d25":"code","6ae0d606":"code","fe7bc117":"code","30dc39bd":"code","3149b7b1":"code","ee0f1f58":"code","2361c78b":"code","d1b87050":"code","ff3df763":"code","9ae5d9ca":"code","a89819eb":"code","91ba8137":"markdown","cb4c4737":"markdown","3311c8ca":"markdown","8887c000":"markdown","530d0471":"markdown","0c81d4cd":"markdown","3c9318eb":"markdown","12e1025f":"markdown","1b151c2e":"markdown"},"source":{"fe27347a":"#importing libraries\nimport pandas as pd\nimport numpy as np\nimport warnings\nwarnings.filterwarnings('ignore')\nimport matplotlib.pyplot as plt\nfrom scipy.stats import norm \nfrom matplotlib import cm\nimport seaborn as sns","9fa19272":"#reading data\ntrain_data = pd.read_csv('..\/input\/forestdata\/train.csv')\ntest_data=pd.read_csv('..\/input\/forestdata\/test.csv')\nsample_data = pd.read_csv('..\/input\/forestdata\/sample_submission.csv')","90901e54":"#dimension\ntrain_data.shape","4d2916e7":"train_data.head()","b88d3ca8":"test_data.head()","a40c225f":"sample_data.head()","5a03c810":"train_data.nunique()","22854dca":"#checking null values\ntrain_data.isnull().sum()","c61ab19a":"#Forest cover types\nsns.countplot(x='Cover_Type',data=train_data)\nplt.show()","7b9a9ff6":"cor=train_data.corr()\nfig, ax = plt.subplots(figsize=(25,25))\nsns.heatmap(cor,xticklabels=cor.columns,yticklabels=cor.columns,fmt= '.3f',annot=True,ax=ax)","7507adf3":"train_data.corr()","d33d227e":"#dropping columns\nId = test_data['Id']\ntrain_data.drop(['Id','Soil_Type15' , \"Soil_Type7\"], inplace = True, axis = 1 )\ntest_data.drop(['Id','Soil_Type15' , \"Soil_Type7\"], inplace = True, axis = 1 )","a6b6c2ff":"train_data['HorizontalHydrology_HorizontalFire'] = (train_data['Horizontal_Distance_To_Hydrology']+train_data['Horizontal_Distance_To_Fire_Points'])\ntrain_data['Neg_HorizontalHydrology_HorizontalFire'] = (train_data['Horizontal_Distance_To_Hydrology']-train_data['Horizontal_Distance_To_Fire_Points'])\ntrain_data['HorizontalHydrology_HorizontalRoadways'] = (train_data['Horizontal_Distance_To_Hydrology']+train_data['Horizontal_Distance_To_Roadways'])\ntrain_data['Neg_HorizontalHydrology_HorizontalRoadways'] = (train_data['Horizontal_Distance_To_Hydrology']-train_data['Horizontal_Distance_To_Roadways'])\ntrain_data['HorizontalFire_Points_HorizontalRoadways'] = (train_data['Horizontal_Distance_To_Fire_Points']+train_data['Horizontal_Distance_To_Roadways'])\ntrain_data['Neg_HorizontalFire_Points_HorizontalRoadways'] = (train_data['Horizontal_Distance_To_Fire_Points']-train_data['Horizontal_Distance_To_Roadways'])\n\ntrain_data['Neg_Elevation_Vertical'] = train_data['Elevation']-train_data['Vertical_Distance_To_Hydrology']\ntrain_data['Elevation_Vertical'] = train_data['Elevation']+train_data['Vertical_Distance_To_Hydrology']\n\ntrain_data['mean_hillshade'] =  (train_data['Hillshade_9am']  + train_data['Hillshade_Noon'] + train_data['Hillshade_3pm'] ) \/ 3\n\ntrain_data['Mean_HorizontalHydrology_HorizontalFire'] = (train_data['Horizontal_Distance_To_Hydrology']+train_data['Horizontal_Distance_To_Fire_Points'])\/2\ntrain_data['Mean_HorizontalHydrology_HorizontalRoadways'] = (train_data['Horizontal_Distance_To_Hydrology']+train_data['Horizontal_Distance_To_Roadways'])\/2\ntrain_data['Mean_HorizontalFire_Points_HorizontalRoadways'] = (train_data['Horizontal_Distance_To_Fire_Points']+train_data['Horizontal_Distance_To_Roadways'])\/2\n\ntrain_data['MeanNeg_Mean_HorizontalHydrology_HorizontalFire'] = (train_data['Horizontal_Distance_To_Hydrology']-train_data['Horizontal_Distance_To_Fire_Points'])\/2\ntrain_data['MeanNeg_HorizontalHydrology_HorizontalRoadways'] = (train_data['Horizontal_Distance_To_Hydrology']-train_data['Horizontal_Distance_To_Roadways'])\/2\ntrain_data['MeanNeg_HorizontalFire_Points_HorizontalRoadways'] = (train_data['Horizontal_Distance_To_Fire_Points']-train_data['Horizontal_Distance_To_Roadways'])\/2\n\ntrain_data['Slope2'] = np.sqrt(train_data['Horizontal_Distance_To_Hydrology']**2+train_data['Vertical_Distance_To_Hydrology']**2)\ntrain_data['Mean_Fire_Hydrology_Roadways']=(train_data['Horizontal_Distance_To_Fire_Points'] + train_data['Horizontal_Distance_To_Hydrology'] + train_data['Horizontal_Distance_To_Roadways']) \/ 3\ntrain_data['Mean_Fire_Hyd']=(train_data['Horizontal_Distance_To_Fire_Points'] + train_data['Horizontal_Distance_To_Hydrology']) \/ 2 \n\ntrain_data[\"Vertical_Distance_To_Hydrology\"] = abs(train_data['Vertical_Distance_To_Hydrology'])\n\ntrain_data['Neg_EHyd'] = train_data.Elevation-train_data.Horizontal_Distance_To_Hydrology*0.2\n\n\ntest_data['HorizontalHydrology_HorizontalFire'] = (test_data['Horizontal_Distance_To_Hydrology']+test_data['Horizontal_Distance_To_Fire_Points'])\ntest_data['Neg_HorizontalHydrology_HorizontalFire'] = (test_data['Horizontal_Distance_To_Hydrology']-test_data['Horizontal_Distance_To_Fire_Points'])\ntest_data['HorizontalHydrology_HorizontalRoadways'] = (test_data['Horizontal_Distance_To_Hydrology']+test_data['Horizontal_Distance_To_Roadways'])\ntest_data['Neg_HorizontalHydrology_HorizontalRoadways'] = (test_data['Horizontal_Distance_To_Hydrology']-test_data['Horizontal_Distance_To_Roadways'])\ntest_data['HorizontalFire_Points_HorizontalRoadways'] = (test_data['Horizontal_Distance_To_Fire_Points']+test_data['Horizontal_Distance_To_Roadways'])\ntest_data['Neg_HorizontalFire_Points_HorizontalRoadways'] = (test_data['Horizontal_Distance_To_Fire_Points']-test_data['Horizontal_Distance_To_Roadways'])\n\ntest_data['Neg_Elevation_Vertical'] = test_data['Elevation']-test_data['Vertical_Distance_To_Hydrology']\ntest_data['Elevation_Vertical'] = test_data['Elevation'] + test_data['Vertical_Distance_To_Hydrology']\n\ntest_data['mean_hillshade'] = (test_data['Hillshade_9am']  + test_data['Hillshade_Noon']  + test_data['Hillshade_3pm'] ) \/ 3\n\ntest_data['Mean_HorizontalHydrology_HorizontalFire'] = (test_data['Horizontal_Distance_To_Hydrology']+test_data['Horizontal_Distance_To_Fire_Points'])\/2\ntest_data['Mean_HorizontalHydrology_HorizontalRoadways'] = (test_data['Horizontal_Distance_To_Hydrology']+test_data['Horizontal_Distance_To_Roadways'])\/2\ntest_data['Mean_HorizontalFire_Points_HorizontalRoadways'] = (test_data['Horizontal_Distance_To_Fire_Points']+test_data['Horizontal_Distance_To_Roadways'])\/2\n\ntest_data['MeanNeg_Mean_HorizontalHydrology_HorizontalFire'] = (test_data['Horizontal_Distance_To_Hydrology']-test_data['Horizontal_Distance_To_Fire_Points'])\/2\ntest_data['MeanNeg_HorizontalHydrology_HorizontalRoadways'] = (test_data['Horizontal_Distance_To_Hydrology']-test_data['Horizontal_Distance_To_Roadways'])\/2\ntest_data['MeanNeg_HorizontalFire_Points_HorizontalRoadways'] = (test_data['Horizontal_Distance_To_Fire_Points']-test_data['Horizontal_Distance_To_Roadways'])\/2\n\ntest_data['Slope2'] = np.sqrt(test_data['Horizontal_Distance_To_Hydrology']**2+test_data['Vertical_Distance_To_Hydrology']**2)\ntest_data['Mean_Fire_Hydrology_Roadways']=(test_data['Horizontal_Distance_To_Fire_Points'] + test_data['Horizontal_Distance_To_Hydrology'] + test_data['Horizontal_Distance_To_Roadways']) \/ 3 \ntest_data['Mean_Fire_Hyd']=(test_data['Horizontal_Distance_To_Fire_Points'] + test_data['Horizontal_Distance_To_Hydrology']) \/ 2\n\n\ntest_data['Vertical_Distance_To_Hydrology'] = abs(test_data[\"Vertical_Distance_To_Hydrology\"])\n\ntest_data['Neg_EHyd'] = test_data.Elevation-test_data.Horizontal_Distance_To_Hydrology*0.2\n","bdbaf72a":"train_data.head()","7d8f61d3":"test_data.head()","b66aea76":"X = train_data.drop('Cover_Type',1)\ny = train_data['Cover_Type']","86bdbb26":"from sklearn.model_selection import train_test_split","9ea47f02":"#splitting data into train and test\nX_train, X_val, y_train, y_val = train_test_split(X, y, test_size=0.20, random_state=369)\nprint(X_train.shape)\nprint(X_val.shape)\nprint(y_train.shape)\nprint(y_val.shape)","c4ed5c18":"from xgboost import XGBClassifier\nfrom sklearn.model_selection import GridSearchCV, RandomizedSearchCV","8d2596f1":"xgb = XGBClassifier(n_jobs=-1) \n \n# Use a grid over parameters of interest\nparam_grid = {\n                  'n_estimators' :[100,150,200,250,300],\n                  \"learning_rate\" : [0.001,0.01,0.0001,0.05, 0.10 ],\n                  \"gamma\"            : [ 0.0, 0.1, 0.2 , 0.3 ],\n                  \"colsample_bytree\" : [0.5,0.7],\n                  'max_depth': [3,4,6,8]\n              }","c9ff75b1":"xgb_randomgrid = RandomizedSearchCV(xgb, param_distributions=param_grid, cv=5)","4baea5cf":"%%time\nxgb_randomgrid.fit(X_train,y_train)","0142f9bb":"best_est = xgb_randomgrid.best_estimator_","30e4c31f":"print('Accuracy of classifier on training set: {:.2f}'.format(xgb_randomgrid.score(X_train, y_train) * 100))\nprint('Accuracy of classifier on validation set: {:.2f}'.format(xgb_randomgrid.score(X_val, y_val) * 100))","263d491e":"prediction_XGB = xgb_randomgrid.predict(test_data)","0ea65d25":"sample_data[\"Cover_Type\"]=prediction_XGB\nsample_data.head()","6ae0d606":"sample_data.to_csv(\"submission.csv\",index=False)","fe7bc117":"from sklearn.linear_model import LogisticRegression  \nLG= LogisticRegression(random_state=0)  \nLG.fit(X_train, y_train)","30dc39bd":"print('Accuracy of classifier on training set: {:.2f}'.format(LG.score(X_train, y_train) * 100))\nprint('Accuracy of classifier on validation set: {:.2f}'.format(LG.score(X_val, y_val) * 100))","3149b7b1":"from sklearn.tree import DecisionTreeClassifier  \nDCT= DecisionTreeClassifier(criterion='entropy', random_state=0)  \nDCT.fit(X_train, y_train)","ee0f1f58":"print('Accuracy of classifier on training set: {:.2f}'.format(DCT.score(X_train, y_train) * 100))\nprint('Accuracy of classifier on validation set: {:.2f}'.format(DCT.score(X_val, y_val) * 100))","2361c78b":"from sklearn.ensemble import RandomForestClassifier\nRDF= RandomForestClassifier(n_estimators= 10, criterion=\"entropy\")  \nRDF.fit(X_train, y_train) ","d1b87050":"print('Accuracy of classifier on training set: {:.2f}'.format(RDF.score(X_train, y_train) * 100))\nprint('Accuracy of classifier on validation set: {:.2f}'.format(RDF.score(X_val, y_val) * 100))","ff3df763":"prediction_RDF = RDF.predict(test_data)","9ae5d9ca":"sample_data[\"Cover_Type\"]=prediction_RDF\nsample_data.head()","a89819eb":"sample_data.to_csv(\"submission1.csv\",index=False)","91ba8137":"**Correlation**","cb4c4737":"**Splitting Data**","3311c8ca":"**Problem Statement** : To predict the forest cover type from the given cartographic variables.","8887c000":"**Random Forest**","530d0471":"Also it seems that the vertical distance contain some negative number, so we are going to make them absolute. Tree based models only fits vertical and horizontal lines so it is very important to engineer features like slope. So in the next we are introducing some new features and as well as we are making the negative values absolute.","0c81d4cd":"From the above correlation map and matrix results, we can see that soil_Type7 and soil_Type15 doesn't have any correlation with the target variable Cover_Type so we can drop them from the data. Also, we can see that Soil_Type9, Soil_Type36, Soil_Type27, Soil_Type25, Soil_Type8 have weak correlation but when a feature has a weak correlation that doesn't mean it is not useful because it may make a good impact if we do interactions.","3c9318eb":"The dataset cantains 56 features including target variable cover_type along with 15120 observations.","12e1025f":"**Logistic Regression**","1b151c2e":"**Decision-Tree**"}}