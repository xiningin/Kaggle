{"cell_type":{"f46704e9":"code","08f9254e":"code","92376579":"code","8daa21ee":"code","2a844f84":"code","194e362b":"code","f09d05c5":"code","280d9f79":"code","77cfa35c":"code","2b430c94":"code","04a2f929":"code","53299a89":"code","c54e3784":"code","be39fa86":"code","a9fd39ea":"code","906506a5":"code","68f1c737":"code","ef06a0da":"code","ad4eb893":"code","9e281da0":"code","41f2dc44":"code","2b8779ac":"code","5a6054c9":"code","f32a0563":"code","fa751b84":"code","1f1d2990":"code","57b67743":"markdown","241b5e4c":"markdown","ec69dd4e":"markdown","baa4bea5":"markdown","61e7dda5":"markdown","cd70c814":"markdown","6f4961bc":"markdown","6dda3e44":"markdown","b585d05f":"markdown"},"source":{"f46704e9":"import numpy as np\nimport pandas as pd","08f9254e":"df = pd.read_csv('..\/input\/telco-customer-churn\/WA_Fn-UseC_-Telco-Customer-Churn.csv')\ndf.head()","92376579":"# Take a look at data type of each column\ndf.dtypes","8daa21ee":"df.drop(['customerID'], axis='columns', inplace=True)\ndf.sample(2)","2a844f84":"df[pd.to_numeric(df.TotalCharges, errors='coerce').isnull()]","194e362b":"df.shape","f09d05c5":"df.TotalCharges.iloc[5218]","280d9f79":"df = df[df.TotalCharges!=' ']\ndf.shape","77cfa35c":"df.TotalCharges = pd.to_numeric(df.TotalCharges, errors='raise')","2b430c94":"df.dtypes","04a2f929":"print(\"Distinct values of each column\")\nfor column in df:\n    print(f'- {column}: {df[column].unique()}')","53299a89":"df.replace('No internet service', 'No', inplace=True)\ndf.replace('No phone service', 'No', inplace=True)","c54e3784":"print(\"Distinct values of each column\")\nfor column in df:\n    print(f'- {column}: {df[column].unique()}')","be39fa86":"# Categorical columns with 2 distinct values\ncat_2_vals = ['Partner', 'Dependents', 'PhoneService', 'MultipleLines', 'OnlineSecurity', 'OnlineBackup',\n          'DeviceProtection', 'TechSupport', 'StreamingTV', 'StreamingMovies', 'PaperlessBilling', 'Churn', 'gender']\n\nreplace_vals = {'Yes': 1,\n                'No': 0,\n                'Male': 1,\n                'Female': 0}\n                \nfor col in cat_2_vals:\n    df[col].replace(replace_vals, inplace=True)","a9fd39ea":"print(\"Distinct values of each column\")\nfor column in df:\n    print(f'- {column}: {df[column].unique()}')","906506a5":"df = pd.get_dummies(data=df, columns=['InternetService', 'Contract', 'PaymentMethod'])\ndf.head()","68f1c737":"cols_to_scale = ['tenure','MonthlyCharges','TotalCharges']\n\nfrom sklearn.preprocessing import MinMaxScaler\nscaler = MinMaxScaler()\ndf[cols_to_scale] = scaler.fit_transform(df[cols_to_scale])","ef06a0da":"X = df.drop(['Churn'], axis='columns')\ny = df.Churn","ad4eb893":"from sklearn.model_selection import train_test_split\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, shuffle=True, random_state=42)","9e281da0":"X_train.shape","41f2dc44":"import tensorflow as tf\nfrom tensorflow import keras\n\nmodel = keras.Sequential([\n    keras.layers.Dense(26, input_shape=(26,), activation='relu'),\n    keras.layers.Dense(13, activation='relu'),\n    keras.layers.Dense(1, activation='sigmoid'),\n])\n\nmodel.compile(optimizer='adam',\n             loss='binary_crossentropy',\n             metrics=['accuracy'])\n\nmodel.fit(X_train, y_train, epochs=100)","2b8779ac":"model.evaluate(X_test, y_test)","5a6054c9":"pred = model.predict(X_test)","f32a0563":"y_preds = []\n\nfor i in pred:\n    if i > 0.5:\n        y_preds.append(1)\n    else:\n        y_preds.append(0)","fa751b84":"from sklearn.metrics import confusion_matrix, classification_report\n\nprint(classification_report(y_test, y_preds))","1f1d2990":"import seaborn as sns\nimport matplotlib.pyplot as plt\n\ncm = confusion_matrix(y_test, y_preds, labels=[1, 0])\nplt.figure(figsize=(10,8))\nsns.heatmap(cm, annot=True, fmt='d')\nplt.xlabel('Prediction')\nplt.ylabel('True')","57b67743":"There are `7043` records in total and only `11` records have no value or incorrect format in `TotalCharges`.","241b5e4c":"# Feature engineering","ec69dd4e":"# Import data","baa4bea5":"# Build a customer churn model prediction","61e7dda5":"Simple Neural Network model","cd70c814":"# EDA","6f4961bc":"Use One Hot Encoding for categorical columns that have more than 2 distinct values","6dda3e44":"`No internet service` and `No phone service` have the same meaning with `No` in some columns.\nConverting `No internet service` and `No phone service` into `No` makes our features much more simpler.","b585d05f":"Quick attention:\n- `customerID` is useless for analysis. Drop it.\n- Datatype of `TotalCharges` is object. Need to inspect this feature first."}}