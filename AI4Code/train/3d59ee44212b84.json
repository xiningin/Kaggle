{"cell_type":{"720d97b7":"code","77b7d132":"code","a99ffd79":"code","7fb5ffdc":"code","c802248a":"code","418d1b1a":"code","a9e6c76c":"code","5f876269":"code","0fb7025e":"code","d21a27ca":"code","122c20a3":"code","36f704df":"code","cb6bc6fa":"code","06ecfac6":"code","dab2f15f":"markdown","24970d5b":"markdown","b7fc2fdc":"markdown","e590d235":"markdown","2caf3165":"markdown","8dba257e":"markdown","562254dc":"markdown"},"source":{"720d97b7":"!pip install geopandas","77b7d132":"import pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport geopandas as gp\nimport numpy as np\n","a99ffd79":"!pip install openpyxl","7fb5ffdc":"df_teams = pd.read_excel(\"..\/input\/2021-olympics-in-tokyo\/Teams.xlsx\")\ndf_medals = pd.read_excel(\"..\/input\/2021-olympics-in-tokyo\/Medals.xlsx\")\ndf_coaches = pd.read_excel(\"..\/input\/2021-olympics-in-tokyo\/Coaches.xlsx\")\ndf_athletes = pd.read_excel(\"..\/input\/2021-olympics-in-tokyo\/Athletes.xlsx\")\ndf_gender = pd.read_excel(\"..\/input\/2021-olympics-in-tokyo\/EntriesGender.xlsx\")","c802248a":"total_athletes = df_athletes.shape[0]\ntotal_events = len(df_athletes[\"Discipline\"].unique())\ntotal_countries = len(df_athletes[\"NOC\"].unique())\ntotal_coaches = df_coaches.shape[0]\ntotal_medals = df_medals[\"Total\"].sum()\ntotal_medals_g = df_medals[\"Gold\"].sum()\ntotal_medals_s = df_medals[\"Silver\"].sum()\ntotal_medals_b = df_medals[\"Bronze\"].sum()\n\nfacts = {\n            'facts':['Total Countries','Total Athletes', 'Total Coaches', 'Total Events', 'Total Medals', 'Total Gold Medals', 'Total Silver Medals', 'Total Bronze Medals' ],\n            'numbers':[total_countries, total_athletes,total_coaches, total_events, total_medals, total_medals_g, total_medals_s, total_medals_b ]\n}\n\ndf_facts = pd.DataFrame(facts)\ndf_facts","418d1b1a":"fig, ax = plt.subplots()\n\nax.barh(df_facts[\"facts\"], df_facts[\"numbers\"]);","a9e6c76c":"#num_coaches = df_coaches[\"NOC\"].value_counts().reset_index()\n\ntop = df_medals.sort_values(\"Rank by Total\").head(10)\nfig, ax = plt.subplots(figsize=(10,10))\n\nax.bar(top[\"Team\/NOC\"], top[\"Bronze\"], width=0.5, color= \"brown\", edgecolor=\"black\")\nax.bar(top[\"Team\/NOC\"], top[\"Silver\"], bottom = top[\"Bronze\"], width=0.5, color= \"silver\", edgecolor=\"black\")\nax.bar(top[\"Team\/NOC\"], top[\"Gold\"], bottom = top[\"Bronze\"]+top[\"Silver\"], width=0.5, color= \"gold\", edgecolor=\"black\")\n\nsns.set_style(\"dark\")\n\nax.set_xlabel(\"Countries\")\nplt.xticks(rotation=90)\nax.set_ylabel(\"No. of Medals\")\nplt.title(\"Top Countries by Medals\")\nplt.legend([\"Bronze\", \"Silver\", \"Gold\"])\nplt.show()\n\n","5f876269":"top_sport = df_gender.sort_values(\"Total\", ascending = False).head(10)\nfig, ax = plt.subplots(figsize=(13,10))\nax.bar(top_sport[\"Discipline\"], top_sport[\"Male\"], color = \"#93E6F1\");\nax.bar(top_sport[\"Discipline\"], top_sport[\"Female\"], bottom = top_sport[\"Male\"], color = \"pink\")\nplt.xlabel(\"Sport\")\nplt.ylabel(\"No. of Participants\")\nplt.title(\"Top Sports (Participation)\");\nplt.legend([\"Male\", \"Female\"]);","0fb7025e":"fig, ax = plt.subplots(figsize=(10,16))\n\nax.barh(df_gender[\"Discipline\"], (df_gender[\"Male\"]\/df_gender[\"Total\"])*100, color = \"#93E6F1\", edgecolor=\"black\")\nax.barh(df_gender[\"Discipline\"], (df_gender[\"Female\"]\/df_gender[\"Total\"])*100, left=(df_gender[\"Male\"]\/df_gender[\"Total\"])*100, color = \"pink\", edgecolor=\"black\")\nplt.xlabel(\"Percent\")\nplt.legend([\"Male\", \"Female\"])\nplt.title(\"Gender ratio in Sports\");\n","d21a27ca":"# Change some contries names\ndf_athletes['NOC'] = df_athletes['NOC'].replace('ROC', 'Russia')\ndf_athletes['NOC'] = df_athletes['NOC'].replace(\"People's Republic of China\", 'China')\ndf_athletes['NOC'] = df_athletes['NOC'].replace('Islamic Republic of Iran', 'Iran')\ndf_athletes['NOC'] = df_athletes['NOC'].replace('United Republic of Tanzania', 'Tanzania')\ndf_athletes['NOC'] = df_athletes['NOC'].replace('Democratic Republic of the Congo', 'Democratic republic of the congo')\n\n#noc = df_athletes.NOC.unique()\ndf_world = df_athletes[\"NOC\"].value_counts().reset_index()\ndf_world.columns = [\"country\", \"athletes\"]\ndf_world = df_world.sort_values(\"athletes\", ascending = False)\ndf_world.head()\n\nworld = gp.read_file(gp.datasets.get_path(\"naturalearth_lowres\"))\nathletes_country = world.merge(df_world, how = 'left', left_on=['name'], right_on=['country'])\n\nsns.set_style(\"ticks\")\nathletes_country.plot(\"athletes\",\n                           figsize=(22,12),\n                           legend=True,\n                           edgecolor=\"black\",\n                           legend_kwds={\"label\":\"Athletes by Country\"},\n                           cmap='Greens',\n                           missing_kwds={\"color\":\"white\"}\n                          )\nplt.title(\"Number of Athletes by Country\", fontsize = 30);","122c20a3":"\n\nmedals = df_medals[[\"Team\/NOC\", \"Total\"]].copy()\nmedals.columns = [\"country\", \"medals\"]\n\nmedals['country'] = medals['country'].replace('ROC', 'Russia')\nmedals['country'] = medals['country'].replace(\"People's Republic of China\", 'China')\n\n\ncoaches = df_coaches[\"NOC\"].value_counts().reset_index()\n\ndf_coaches['NOC'] = df_coaches['NOC'].replace('ROC', 'Russia')\ndf_coaches['NOC'] = df_coaches['NOC'].replace(\"People's Republic of China\", 'China')\ndf_coaches['NOC'] = df_coaches['NOC'].replace('Islamic Republic of Iran', 'Iran')\ndf_coaches['NOC'] = df_coaches['NOC'].replace('United Republic of Tanzania', 'Tanzania')\ndf_coaches['NOC'] = df_coaches['NOC'].replace('Democratic Republic of the Congo', 'Democratic republic of the congo')\n\ncoaches.columns = [\"country\", \"coaches\"]\n\n\ncoaches.loc[coaches[\"country\"]==\"China\"]","36f704df":"df_noc = df_world.copy()\ndf_noc = df_noc.merge(coaches, how='outer')\ndf_noc = df_noc.merge(medals, how='outer')\n\ndf_noc = df_noc.sort_values(\"athletes\", ascending=False).head(10)\ndf_noc[\"success_rate\"] = (df_noc[\"medals\"])*100\/(df_noc[\"athletes\"]*df_noc[\"coaches\"]*0.5)\nc = np.arange(len(df_noc))\nw = 0.3\nfig, ax = plt.subplots(figsize = (20,10))\na = ax.bar(c, df_noc[\"athletes\"],0.3,label=\"athletes\");\nch = ax.bar(c+w, df_noc[\"coaches\"],0.3,label=\"coaches\",color=\"green\");\nm = ax.bar(c+w*2, df_noc[\"medals\"],0.3, label=\"medals\");\nplt.xticks(c,df_noc[\"country\"]);\n\nplt.plot(df_noc[\"country\"], df_noc[\"success_rate\"]*100, color= \"#8BCD50\", marker=\"o\", label=\"Medal Success\");\n\nplt.legend();\nplt.xlabel(\"Country\")\nplt.title(\"Participation and Medals\")\n\nfor p in a:\n   height = p.get_height()\n   ax.annotate('{}'.format(int(height)),\n      xy=(p.get_x() + p.get_width() \/ 2, height),\n      xytext=(0, 3), \n      textcoords=\"offset points\",\n      ha='center', va='bottom')\n\nfor p in ch:\n   height = p.get_height()\n   ax.annotate('{}'.format(height),\n      xy=(p.get_x() + p.get_width() \/ 2, height),\n      xytext=(0, 3), \n      textcoords=\"offset points\",\n      ha='center', va='bottom')\n   \nfor p in m:\n   height = p.get_height()\n   ax.annotate('{}'.format(int(height)),\n      xy=(p.get_x() + p.get_width() \/ 2, height),\n      xytext=(0, 3), \n      textcoords=\"offset points\",\n      ha='center', va='bottom')","cb6bc6fa":"success = df_noc.sort_values(\"success_rate\", ascending=False, inplace=False)\n\nfig, ax = plt.subplots(figsize=(18,10))\nsns.set_style(\"darkgrid\")\ns = ax.bar(success[\"country\"], success[\"success_rate\"], color= \"#98D7C2\", edgecolor=\"#638C80\");\nplt.xlabel(\"Country\",)\nplt.ylabel(\"Percent\")\nplt.title(\"Medal Success Rate\")\nfig.text(.05, .05, \"*medal success rate = no. of medals*100\/(no. of athletes*(no. of coaches)*0.5)\", ha='left')\nfor p in s:\n   height = p.get_height()\n   ax.annotate('{}%'.format(round(height, 2)),\n      xy=(p.get_x() + p.get_width() \/ 2, height),\n      xytext=(0, 3), # 3 points vertical offset\n      textcoords=\"offset points\",\n      ha='center', va='bottom')\n   \n","06ecfac6":"df_noc.loc[df_noc[\"country\"]==\"China\"]","dab2f15f":"**Medal Success**","24970d5b":"**Sports Participation Composition**","b7fc2fdc":"# Top Countries with Highest Medals","e590d235":"# **Top Sports Participations**","2caf3165":"# **Facts**\n\n\n","8dba257e":"**Athletes Around the World**","562254dc":"# **Country Participations and Medals**"}}