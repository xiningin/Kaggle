{"cell_type":{"e4bec3ec":"code","623eff34":"code","c0e88b96":"code","da5bd9f3":"code","46d97480":"code","87597400":"code","79b8101e":"code","57bacb46":"code","3ffa787e":"code","b61e626d":"code","9d7dff5f":"code","e6155c19":"code","0a33142a":"code","29330d3f":"code","ee487c99":"code","5bfd1dca":"code","7bc4e3f8":"code","dc34cb5c":"code","58483920":"code","72e9d63e":"code","38497e6f":"code","17a84f4c":"code","817fe68e":"code","e255db53":"code","8c448574":"code","de4730a2":"code","91e509b3":"code","a3bef9ae":"code","cee89828":"code","725f1782":"code","ccff7040":"code","f79dbfc1":"code","c605c9c1":"code","dc681500":"code","6e63cd39":"code","b17f5393":"code","5021bd8a":"code","529f0102":"code","6dbe3b4d":"code","ac96dac8":"code","56693da4":"markdown","0aae5858":"markdown","ff04a89c":"markdown","6635bb1e":"markdown","41a18207":"markdown","d0942554":"markdown","fa6d87ae":"markdown","a2a26263":"markdown","b46d8795":"markdown","e4655a4c":"markdown","2b0bb170":"markdown","40c88d27":"markdown","d9f0d7df":"markdown","74a40564":"markdown","784b0294":"markdown","5b1092b1":"markdown","81a55493":"markdown","3d29058e":"markdown","773205b6":"markdown","7dfcb0ed":"markdown","9783d370":"markdown","725ebb10":"markdown","a32141cd":"markdown"},"source":{"e4bec3ec":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sb\n%matplotlib inline","623eff34":"df = pd.read_csv('..\/input\/prosperLoanData.csv')","c0e88b96":"# Shape of entire dataset\ndf.shape","da5bd9f3":"\ndf.dtypes","46d97480":"# Summary statistics\ndf.describe()","87597400":"# Duplicates data entry in loan data\ndf.duplicated().sum()","79b8101e":"df.isnull().sum()","57bacb46":"df_loan = df.copy()","3ffa787e":"df_loan.info()","b61e626d":"# Changing Loan orgination date into date time format\ndf_loan['LoanOriginationDate'] = pd.to_datetime(df_loan['LoanOriginationDate'])","9d7dff5f":"df_loan.dtypes","e6155c19":"# filter out loans without ProsperScores\ndf_loan = df_loan[df_loan['ProsperScore'].isnull()==False]","0a33142a":"# Loan by term\nbase_color = sb.color_palette()[0]\nsb.countplot(data=df_loan,x= 'Term',color=base_color);\nplt.title('Terms of loan (Months)')\nplt.xlabel('Term (Months)');","29330d3f":"type_count = df_loan['LoanStatus'].value_counts()\ntype_order = type_count.index","ee487c99":"# Count of Loan by Loan Status\nn_loan =df_loan.shape[0]\nmax_type_count = type_count[0]\nmax_prop = max_type_count\/n_loan","5bfd1dca":"tick_props = np.arange(0,max_prop,0.1)\ntick_names = ['{:0.2f}'.format(v) for v in tick_props]","7bc4e3f8":"tick_names","dc34cb5c":"sb.countplot(data=df_loan,y='LoanStatus',color=base_color,order=type_order);\nplt.xticks(tick_props*n_loan,tick_names)\nplt.xlabel('proportion');\nplt.title('Proportion of Loan Status')","58483920":"df['ProsperScore'].describe()","72e9d63e":"# Distribution of Prosper rating\nsb.countplot(data=df_loan,x='ProsperRating (numeric)',color=base_color);\nplt.title('Count of Prosper ratings')","38497e6f":"df_loan['Year'] = df_loan['LoanOriginationQuarter'].str[-4:]","17a84f4c":"# Number of loans per year\nsb.countplot(data=df_loan,x='Year',color=base_color);\nplt.title('Numner of Loans Sanctioned per year')\nplt.xticks(rotation=90);","817fe68e":"df['LoanOriginalAmount'].describe()","e255db53":"# Distribution of orginal Loan amount\nbins = np.arange(1000,35000,2000)\nplt.hist(data=df_loan,x='LoanOriginalAmount',color=base_color,bins=bins);\nplt.title('Distribution of orginal Loan amount')\nplt.xticks(rotation=90);","8c448574":"# Histogram for Credit Score ranges\n\nplt.figure(figsize = [13, 5]) \n\n\nplt.subplot(1, 2, 1)\nbins = np.arange(550, df_loan['CreditScoreRangeLower'].max(), 20)\nplt.hist(data = df_loan, x = 'CreditScoreRangeLower', bins = bins)\nplt.xticks(np.arange(550, 1000, 100))\nplt.title('CreditScoreRangeLower Count')\nplt.xlabel('CreditScoreRangeLower')\nplt.ylabel('count');\n\nplt.subplot(1, 2, 2)\nbins = np.arange(550, df_loan['CreditScoreRangeUpper'].max(), 20)\nplt.hist(data = df_loan, x = 'CreditScoreRangeUpper', bins = bins)\nplt.xticks(np.arange(550, 1000, 100))\nplt.title('CreditScoreRangeUpper Count')\nplt.xlabel('CreditScoreRangeUpper')\nplt.ylabel('count');","de4730a2":"df_loan['LenderYield'].describe()","91e509b3":"# Distribution of lender yield\nbins = np.arange(.03,.34,.01)\nplt.hist(data=df_loan,x='LenderYield',color=base_color,bins=bins);\nplt.title('Distribution of Lender yield')\nplt.xticks(rotation=90);","a3bef9ae":"# Income range of borrower\norder = ['$0','$1-24,999','$25,000-49,999','$50,000-74,999','$75,000-99,999','$100,000+']\nsb.countplot(data=df_loan,x='IncomeRange',color=base_color,order=order);\nplt.title('Count of Income Range')\nplt.xticks(rotation=90);","cee89828":"# correlation plot \n\nnum_vars = ['BorrowerAPR', 'ProsperScore', 'LenderYield', \n            'StatedMonthlyIncome',  'CreditScoreRangeUpper','ProsperRating (numeric)','DebtToIncomeRatio']\nplt.figure(figsize = [8, 5])\nsb.heatmap(df_loan[num_vars].corr(), annot = True, fmt = '.3f',\n           cmap = 'vlag_r', center = 0)\nplt.title('Correlation Plot') \nplt.show()","725f1782":"# plot matrix: only 300 random loans are used to see the pattern more clearer\n\n\nnum_vars = ['BorrowerAPR', 'ProsperScore', 'LenderYield', \n            'StatedMonthlyIncome',  'CreditScoreRangeUpper','ProsperRating (numeric)','DebtToIncomeRatio']\n\nsamples = np.random.choice(df_loan.shape[0], 300, replace = False)\nloan_samp = df_loan.loc[samples,:]\n\ng = sb.PairGrid(data = loan_samp, vars = num_vars)\ng.map_offdiag(plt.scatter)\nplt.title('Matrix Plot');","ccff7040":"# scatter and heat plot for comparing ProsperScore and BorrowerAPR. \nplt.figure(figsize = [15, 5]) \n\nplt.subplot(1, 2, 1)\nplt.scatter(data = df_loan, x = 'BorrowerAPR', y = 'ProsperScore', alpha =  0.005)\nplt.yticks(np.arange(0, 12, 1))\nplt.title('BorrowerAPR vs. ProsperScore')\nplt.xlabel('BorrowerAPR')\nplt.ylabel('ProsperScore')\n\n\nplt.subplot(1, 2, 2)\nbins_x = np.arange(0, df_loan['BorrowerAPR'].max()+0.05, 0.03)\nbins_y = np.arange(0, df_loan['ProsperScore'].max()+1, 1)\nplt.hist2d(data = df_loan, x = 'BorrowerAPR', y = 'ProsperScore', bins = [bins_x, bins_y], \n               cmap = 'viridis_r', cmin = 0.5)\nplt.colorbar()\nplt.title('BorrowerAPR vs. ProsperScore')\nplt.xlabel('BorrowerAPR (l)')\nplt.ylabel('ProsperScore');","f79dbfc1":"# scatter and heat plot for comparing BorrowerAPR and credit score upper range. \nplt.figure(figsize = [15, 5]) \n\nplt.subplot(1, 2, 1)\nplt.scatter(data = df_loan, x = 'CreditScoreRangeUpper', y = 'BorrowerAPR', alpha = 0.01)\nplt.title('BorrowerAPR vs. CreditScoreRangeUpper')\nplt.xlabel('BorrowerAPR')\nplt.ylabel('CreditScoreRangeUpper');\n\n\nplt.subplot(1, 2, 2)\nbins_x = np.arange(0, df_loan['BorrowerAPR'].max()+0.05, 0.02)\nbins_y = np.arange(500, df_loan['CreditScoreRangeUpper'].max()+100, 20)\nplt.hist2d(data = df_loan, x = 'BorrowerAPR', y = 'CreditScoreRangeUpper', bins = [bins_x, bins_y], \n               cmap = 'viridis_r', cmin = 0.5)\nplt.colorbar()\nplt.title('BorrowerAPR vs. CreditScoreRangeUpper')\nplt.xlabel('BorrowerAPR (l)')\nplt.ylabel('CreditScoreRangeUpper');","c605c9c1":"# Stated MonthlyIncome vs Prosper Rating\nplt.figure(figsize = [15, 5])\n\nplt.subplot(1, 2, 1)\nsb.boxplot(data=df_loan,x='ProsperScore',y='StatedMonthlyIncome',color=base_color);\nplt.xlabel('Prosper Score');\nplt.ylabel('Monthly Income');\nplt.title('Box plot of monthly income Vs prosper Score');\n\nplt.subplot(1, 2, 2)\nplt.scatter(data=df_loan,x='BorrowerAPR',y='StatedMonthlyIncome',color=base_color);\nplt.xlabel('BorrowerAPR');\nplt.ylabel('Monthly Income');\nplt.title('Scatter plot of monthly income Vs Borrower APR');","dc681500":"# Borrower APR vs Status of Loan and  Borrower APR vs Employment status\nplt.figure(figsize = [15, 5])\n\nplt.subplot(1, 2, 1)\nsb.boxplot(data=df_loan,x='BorrowerAPR',y='LoanStatus',color=base_color);\nplt.xlabel('Borrower APR');\nplt.ylabel('Loan Status');\nplt.title('Box plot of Borrower APR vs Status of Loan');\n\nplt.subplot(1, 2, 2)\nsb.boxplot(data=df_loan,x='BorrowerAPR',y='EmploymentStatus',color=base_color);\nplt.xlabel('Borrower APR');\nplt.ylabel('Employment Status');\nplt.title('Box plot of Borrower APR vs Employment Status');","6e63cd39":"df_series = df_loan['BorrowerRate'].groupby(df_loan['LoanOriginationQuarter']).mean().reset_index()\n","b17f5393":"df_series.LoanOriginationQuarter = pd.Categorical(df_series.LoanOriginationQuarter, sorted(df_series.LoanOriginationQuarter, key=lambda x: x.split(' ')[-1]), ordered = True)\ndf_series.sort_values('LoanOriginationQuarter', inplace=True)","5021bd8a":"# Mean Borrower rate over time\nplt.errorbar(data=df_series,x='LoanOriginationQuarter',y='BorrowerRate');\nplt.xticks(rotation = 90);\nplt.xlabel('Quaerters');\nplt.ylabel('Mean Borrower rate');\nplt.title('Quarter and rate trends');","529f0102":"# LenderYield vs Borrower APR  vs ProsperRating\nplt.figure(figsize = [10, 5])\nplt.scatter(data=df_loan,x='LenderYield',y = 'BorrowerAPR',c='ProsperScore',cmap = 'viridis_r')\nplt.colorbar(label = 'ProsperScore');\nplt.xlabel('Lender Yield')\nplt.ylabel('Borrower APR')\nplt.title('LenderYield vs Borrower APR  vs ProsperRating');","6dbe3b4d":"# BorrowerAPR vs. CreditScoreRangeUpper & CreditScoreRangeUpper\nplt.figure(figsize = [15, 5]) \nplt.scatter(data = df_loan, x = 'CreditScoreRangeUpper', y = 'BorrowerAPR', c ='ProsperScore', alpha = 0.3)\nplt.colorbar(label = 'ProsperScore')\nplt.title('BorrowerAPR vs. CreditScoreRangeUpper & CreditScoreRangeUpper')\nplt.xlabel('BorrowerAPR')\nplt.ylabel('CreditScoreRangeUpper');","ac96dac8":"# LoanStatus Vs BorrowerAPR VS EmploymentStatus\nplt.figure(figsize=[12,10])\nsb.boxplot(x=\"LoanStatus\", y=\"BorrowerAPR\", hue=\"EmploymentStatus\", data=df_loan, palette=\"RdYlBu\");\nplt.xticks(rotation = 90);\nplt.xlabel('Loan Status');\nplt.ylabel('BorrowerAPR');\nplt.title('LoanStatus Vs BorrowerAPR VS EmploymentStatus');","56693da4":"Around 25% of total loan are completed but still majority of loans are in currentor pending state(around 80%)","0aae5858":"We can  see the trend that the higher the CreditScore leads to lower APR percentage. The heatmap on the same variables helps to make this point more clear.","ff04a89c":"Data is positively skewed, suggests that for investors got good yield for loans. Data is spiked at 34%.","6635bb1e":"This graphs clearly shows the relationship between all variables. Borrower APR and Lender yield are directly positively correlated as more the interest borrowers pays,more will be yield for lender. For the prosper score, higher the prosper score lower will be the risk attached hence lower will be the APR and that further lowers down the yield.","41a18207":"These two histograms shows similar trend. As both the upper and lower score are ranges of credit score","d0942554":"For each category of loan status, the lowest APR is for Employed and Full-time. Whereas highest APR is for Not employed.","fa6d87ae":"### What are the observed relationships in this part of the investigation. Were there features that strengthened each other in terms of looking at your feature(s) of interest?\nAfter analyzing the variables across dataset, Borrower APR and Lender yield are directly positively correlated which is obvious as more the APR, more will be the interest and more will be lender's yield. However, CreditScoreRangeUpper and ProsperScore negatively correlated to BorrowerAPR. \nScatter plot and Heatmap were also created to find out that ProsperScore and BorrowerAPR were negatively correlated as higher the prosper score lower will be the risk attached hence lower will be the APR and that further lowers down the yield.\nMultiple box plots were analyzed for variables Loan status, APR and Employment Status. We can very well see that for For each category of loan status, the lowest APR is for Employed and Full-time. Whereas highest APR is for Not employed. That means borrower APR is related to Employment status. More secure jobs get low APR and vice versa.","a2a26263":"We can't find any trend here.","b46d8795":"There was no clear evidence of any relationship between income with any other variable so lets investigate more here. \n\nThere is slight decrease in median of monthly income as score get poorer but no relationship between monthly income and APR","e4655a4c":"## Univariate Exploration","2b0bb170":"In this section, we will deeply analyzed the relationship of key variables of out dataset","40c88d27":"Credit score range upper and prosper score are positively correlated. However the high credit score upper range and borrower APR are negatively correlated.By adding ProsperScore to color encodings, BorrowerAPR decreases as ProsperScore increases. This proves the point that CreditScoreRangeUpper and ProsperScore negatively correlated to BorrowerAPR. ","d9f0d7df":"Most common term of loans is 36 months","74a40564":"## Multivariate analysis","784b0294":"Here the relationship is evident, higher the prosper score is lower is Borrower APR and this makes sense because lower the risk attached with the borrower lower will be the APR.","5b1092b1":"The median borrower APR of current, completed and Final payment in process are the lowest, with few low outliers of APR rate in charged off. Whereas charged off loans and defaulted are with the highest median of borrower rate. \n\nMedian borrower APR is lowest for employed and highest for not employed because of high risk attached with unemployed people","81a55493":"Borrower APR is negatively related with prosper score and credit upper score. However borrower APR and lending yield are postively correlated as higher the APR will be, higher will be yield for lender.\n\nProsper score is negatively related with Borrower APR and lender yield\n\nDebt To Income Ratio and Monthly income is not seems to be related with any variable. We have to analyzed this further.","3d29058e":"###  What are the observed relationships in this part of the investigation. Were there features that strengthened each other in terms of looking at your feature(s) of interest?\n\nIt was interesting finding to know the reason behind ProsperRating. I was able to eshtablish clear relation between lender yield and borrower rate.\nBorrower rate and Lender Yield have a linear relationship","773205b6":"## Bivariate Analysis","7dfcb0ed":"###  What is\/are the change(s)  made to tidy dataset?\n\nWe have removed the rows where there is no data about prosper score\n\n###  What is\/are the main feature(s) of interest in your dataset?\n\nThe Borrower's APR will be analyzied with many factors such as the borrower's rating, score, Employment Status and income that could influence change in borrower's APR. \n\n### What features in the dataset do you think will help support your investigation into your feature(s) of interest?\n\nThe Prosper Rating and score could show low Borrower's APR because higher rating reflect the borrower's personality to be more trustworthy. ","9783d370":"Strong positive correlations  between Lender yield and Borrower APR. prosper score and prosper rating are also positive correlation .Credit score upper range has also some weak +ve correlation with prosper score. \n\nNegative correlation between prosper score & APR, and prosper score & Lender yield.\nNegative correlation between prosper ratings & APR, and prosper score & Lender yield.\n\nLet's investigate further.","725ebb10":"In 2009 there was lowest number of loans sanctioned whereas 2013 has got highest number of loans sanctioned","a32141cd":"Most of borrowers has got 4 prosper ratings that means most of borrowers has risk associated on the higher end"}}