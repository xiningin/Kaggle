{"cell_type":{"e1d983e6":"code","1f54d5f4":"code","50524e33":"code","25846135":"code","fd462feb":"code","936d5ab8":"code","8de9041d":"code","578c541f":"code","8bf8f854":"code","5b3e96cf":"code","fff1e066":"code","89e4cf43":"code","493c58e5":"code","de3e7161":"code","6a85d09d":"code","5529e701":"code","e33d00ff":"code","1ab01581":"code","6fabf361":"code","9719c1ce":"code","8adef3b4":"code","be1de1b2":"code","d6472b3b":"code","9c7ad1b1":"code","3d2d8330":"code","cd26f739":"code","1819f74a":"code","fe8672cd":"code","c8957ad1":"markdown","c500a60a":"markdown","84579dde":"markdown","6397d6c6":"markdown"},"source":{"e1d983e6":"#import library\nimport os\nimport warnings\nwarnings.filterwarnings('ignore')\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport matplotlib\n%pylab inline\nfrom pylab import rcParams\nrcParams['figure.figsize'] = 10, 6\nfrom statsmodels.tsa.stattools import adfuller\nfrom statsmodels.tsa.seasonal import seasonal_decompose\nfrom statsmodels.tsa.arima_model import ARIMA\nimport statsmodels.api as sm\nimport itertools\nfrom sklearn.metrics import mean_squared_error, mean_absolute_error\nimport math\nimport numpy as np\nfrom pylab import rcParams","1f54d5f4":"df = pd.read_csv('..\/input\/intel-stock-data\/INTC.csv')","50524e33":"df.shape","25846135":"df.head()","fd462feb":"df.describe()","936d5ab8":"df.info()","8de9041d":"#transform datetime\ndf['Date'] =  pd.to_datetime(df['Date'], format = '%Y-%m-%d')","578c541f":"#indexing date\ndf = df.set_index('Date')\ndf.index","8bf8f854":"#visualize of each atrribute\ndf.plot(subplots = True, figsize = (10,12))\nplt.title('Intel Stock Attributes')\nplt.show()","5b3e96cf":"#check stock from 2020 - 2021\ndf['2020':'2021'].plot(subplots = True, figsize = (10,12))\nplt.title('Intel Stock Attributes')\nplt.show()","fff1e066":"#check moving average\ndf['MA for 20 days'] = df['Open'].rolling(20).mean()\ndf['MA for 50 days'] = df['Open'].rolling(50).mean()\n\n#visualize moving average\ndf.truncate(before = '2020-01-01', after = '2021-01-01')[['Adj Close','MA for 20 days','MA for 50 days']].plot(subplots = False, figsize = (12,6))\nplt.title(\"Moving Average of Intel Stock\")\nplt.show()","89e4cf43":"#check daily return\ndf['Daily Return'] = df['Adj Close'].pct_change()\nresult = df.sort_values(by = ['Daily Return'], ascending = False)\nresult.head()","493c58e5":"#visualize the per day closing price of the stock\nplt.figure(figsize = (10,6))\nplt.grid(True)\nplt.xlabel('Date')\nplt.ylabel('Close Price')\nplt.plot(df['Close'])\nplt.title('Intel Close Price')\nplt.show()","de3e7161":"#scatter plot of closing price\ndf_close = df['Close']\ndf_close.plot(style = 'k.')\nplt.title('Scatter Plot of Close Price')\nplt.show()","6a85d09d":"#distribution\nplt.figure(figsize = (10,6))\nsns.distplot(df['Close'])\nplt.title(\"Distribution of Close Price\")\nplt.show()","5529e701":"#change distribution\nfigure(figsize = (10,6))\nsubplot(1,2,1)\nhist(df['Close'] * 1e-6, 20);\nxlabel(\"Close Price\")\nsubplot(1, 2, 2)\nhist(log10(df['Close']),20);\nxlabel(\"log10(Close Price)\")","e33d00ff":"#test for staionarity\ndef test_stationarity(timeseries):\n    rolmean = timeseries.rolling(12).mean()\n    rolstd = timeseries.rolling(12).std()\n   \n    plt.plot(timeseries, color = 'blue',label = 'Original')\n    plt.plot(rolmean, color = 'red', label = 'Rolling Mean')\n    plt.plot(rolstd, color = 'black', label = 'Rolling Std')\n    plt.legend(loc = 'best')\n    plt.title('Rolling Mean and Standard Deviation')\n    plt.show(block = False)\n    \n    print(\"Results of dickey fuller test\")\n    adft = adfuller(timeseries,autolag = 'AIC')\n    \n    output = pd.Series(adft[0:4],index = ['Test Statistics', 'p-value', 'No. of lags used', 'Number of observations used'])\n    for key,values in adft[4].items():\n        output['critical value (%s)'%key] =  values\n    print(output)\n    \ntest_stationarity(df_close)","1ab01581":"result = seasonal_decompose(df_close, model = 'multiplicative', freq = 30)\nfig = plt.figure()  \nfig = result.plot()  \nfig.set_size_inches(10, 6)","6fabf361":"#check log series of moving average in rolling average\nrcParams['figure.figsize'] = 10, 6\ndf_log = np.log(df_close)\nmoving_avg = df_log.rolling(12).mean()\nstd_dev = df_log.rolling(12).std()\nplt.legend(loc = 'best')\nplt.title('Moving Average')\nplt.plot(std_dev, color = \"black\", label = \"Standard Deviation\")\nplt.plot(moving_avg, color = \"red\", label = \"Mean\")\nplt.legend()\nplt.show()","9719c1ce":"#split data\ntraining, testing = df_log[3:int(len(df_log) * 0.9)], df_log[int(len(df_log) * 0.9):]\nplt.figure(figsize = (10,6))\nplt.grid(True)\nplt.xlabel('Date')\nplt.ylabel('Close Prices')\nplt.plot(df_log, 'orangered', label = 'Training')\nplt.plot(testing, 'blue', label = 'Testing')\nplt.legend()\nplt.show()","8adef3b4":"#check parameter in sarimax model\np = d = q = range(0, 2)\npdq = list(itertools.product(p, d, q))\nseasonal_pdq = [(testing[0], testing[1], testing[2], 12) for testing in list(itertools.product(p, d, q))]\nprint('Examples of parameter combinations for Seasonal ARIMA...')\nprint('SARIMAX: {} x {}'.format(pdq[1], seasonal_pdq[1]))\nprint('SARIMAX: {} x {}'.format(pdq[1], seasonal_pdq[2]))\nprint('SARIMAX: {} x {}'.format(pdq[2], seasonal_pdq[3]))\nprint('SARIMAX: {} x {}'.format(pdq[2], seasonal_pdq[4]))","be1de1b2":"#selection of parameter in sarimax model\nfor param in pdq:\n    for param_seasonal in seasonal_pdq:\n        try:\n            model = sm.tsa.statespace.SARIMAX(testing, order = param, seasonal_order = param_seasonal, enforce_stationarity = False,\n                                            enforce_invertibility = False)\n            results = model.fit()\n            print('ARIMA{}x{}12 - AIC:{}'.format(param, param_seasonal, results.aic))\n        except:\n                continue","d6472b3b":"#fitting sarimax model\nmodel = sm.tsa.statespace.SARIMAX(testing, order = (1, 1, 1), seasonal_order = (1, 1, 0, 12), enforce_stationarity = False,\n                                enforce_invertibility = False)\nresult = model.fit()\nprint(result.summary().tables[1])","9c7ad1b1":"#visualize of sarimax model\nresult.plot_diagnostics(figsize = (12, 9))\nplt.show()","3d2d8330":"#build arima model\nmodel = ARIMA(training, order = (3, 1, 2))  \nfitted = model.fit(disp = -1)  \nprint(fitted.summary())","cd26f739":"#visualize forecast\nfc, se, conf = fitted.forecast(1049, alpha = 0.05)  \nfc_series = pd.Series(fc, index = testing.index)\nlower_series = pd.Series(conf[:, 0], index = testing.index)\nupper_series = pd.Series(conf[:, 1], index = testing.index)\n\nplt.figure(figsize = (10,6), dpi = 100)\nplt.plot(training, label = 'training')\nplt.plot(testing, color = 'blue', label = 'Actual Stock Price')\nplt.plot(fc_series, color = 'orange',label = 'Predicted Stock Price')\nplt.fill_between(lower_series.index, lower_series, upper_series, color = 'k', alpha = .10)\nplt.title('Intel Stock Price Prediction')\nplt.xlabel('Date')\nplt.ylabel('Actual Stock Price')\nplt.legend(loc = 'upper left', fontsize = 8)\nplt.show()","1819f74a":"#report of MSE, MAE, RMSE & MAPE\nmse = mean_squared_error(testing, fc)\nprint('MSE: '+ str(mse))\nmae = mean_absolute_error(testing, fc)\nprint('MAE: '+ str(mae))\nrmse = math.sqrt(mean_squared_error(testing, fc))\nprint('RMSE: '+ str(rmse))\nmape = np.mean(np.abs(fc - testing) \/ np.abs(testing))\nprint('MAPE: '+ str(mape))","fe8672cd":"#distribution of each attribute\ndf.hist(figsize = (15,10))\nplt.show()","c8957ad1":"## ARIMA Model","c500a60a":"## Time Series Analysis","84579dde":"# Forecast Analysis of Intel Stock","6397d6c6":"## Data Extraction"}}