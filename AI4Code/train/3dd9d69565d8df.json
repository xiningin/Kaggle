{"cell_type":{"d62afe41":"code","ae915dcd":"code","c8446c69":"code","962620fe":"code","484991d6":"code","ac2ed1bc":"code","ea1578f3":"code","4afeaf03":"code","2b3028a0":"code","b1d69bf3":"code","80d08ad6":"code","07354957":"code","105fadf0":"code","3e1fc55a":"code","51cc9268":"code","7090e5c7":"code","78de7c74":"code","cb2e58e4":"code","633dcfc8":"code","ab8e6e6b":"code","f119bc78":"code","f85f9792":"code","c458fd3b":"code","fd22466b":"code","dbd8f9b7":"code","31fd837c":"code","29863f53":"code","6c2afc61":"code","d2f4789e":"code","b51e6dba":"code","4db84911":"code","ef375435":"code","2cafafed":"code","88fa87fa":"code","4911dbbf":"code","37d23db3":"code","9118427a":"code","8abde2f4":"code","645b8d5c":"code","896c0461":"code","8c1b4c9f":"code","78d8b0bf":"code","eeba1d8e":"code","eb5ea1e3":"code","a09de6dc":"code","03c96205":"code","1a8f4c99":"code","d66cbd73":"code","2fc9eb61":"code","3da2b1da":"code","ac90c756":"code","1ef819bc":"code","69db9790":"code","bc2dd401":"code","34f54ab7":"code","08579012":"code","7a59b03f":"code","00605cff":"code","094267a6":"code","646e318f":"markdown","67223b09":"markdown","22913994":"markdown","a8c191eb":"markdown","9158c81c":"markdown","a715168e":"markdown","5be1f85e":"markdown","f84b28e5":"markdown","9b008fd1":"markdown","e50eddd1":"markdown","0317a564":"markdown","ca2ea75d":"markdown","3a65ea9b":"markdown","7673d1b0":"markdown","12af3c25":"markdown","c3e85b23":"markdown","f2ce5ea5":"markdown","8122d779":"markdown","2ab5ae3e":"markdown","270e5d9c":"markdown","9f51686d":"markdown","aec2ce05":"markdown","c087277e":"markdown"},"source":{"d62afe41":"import pandas as pd\nimport numpy as np \nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom pandas import DataFrame, Series\n%matplotlib inline\nimport calendar\n","ae915dcd":"acc=pd.read_csv('..\/input\/IHMStefanini_industrial_safety_and_health_database_with_accidents_description.csv')","c8446c69":"acc.head(3)","962620fe":"acc.size","484991d6":"acc.isnull().sum()","ac2ed1bc":"del acc['Unnamed: 0']","ea1578f3":"acc.head(3)","4afeaf03":"acc.rename(columns={'Data': 'Date', 'Genre': 'Gender', 'Employee or Third Party':'Employee type'}, inplace=True)","2b3028a0":"acc.Date.max()","b1d69bf3":"acc.Date.min()","80d08ad6":"acc['Date'] = pd.to_datetime(acc['Date'])","07354957":"month_order={\n    'January':1,\n    'February':2,\n    'March':3,\n    'April':4,\n    'May':5,\n    'June':6,\n    'July':7,\n    'August':8,\n    'September':9,\n    'October':10,\n    'November':11,\n    'December':12\n}","105fadf0":"acc.groupby('Date').count()['Local'].plot(figsize=(15,4))\nplt.legend(bbox_to_anchor=(1.05, 1), loc=2, borderaxespad=0.)","3e1fc55a":"def month_n(a):\n    b=calendar.month_name[a]\n    return b","51cc9268":"x=[]\nfor i in range (0, len(acc.Date)):\n                x.append(month_n(acc.Date.loc[i].month))","7090e5c7":"y=[]\nfor i in range (0, len(acc.Date)):\n                y.append(acc.Date.loc[i].year)","78de7c74":"acc['month']=x\nacc['year']=y","cb2e58e4":"acc.head(3)","633dcfc8":"acc_trend=acc.pivot_table(index='month', columns=[ 'year','Accident Level'], aggfunc='count')['Countries']\n","ab8e6e6b":"n=np.nan\nacc_trend.replace(n,0,inplace=True)","f119bc78":"acc_trend.head(2)","f85f9792":"acc_trend[2016]","c458fd3b":"acc_trend[2016].loc[month_order].plot(kind='bar', figsize=(15,4), width=0.9, cmap='cool', title='2016')\nplt.legend(bbox_to_anchor=(1.05, 1), loc=2, borderaxespad=0.)\nacc_trend[2017].loc[month_order].plot(kind='bar', figsize=(15,4), width=0.9, cmap='hot', title='2017')\nplt.legend(bbox_to_anchor=(1.05, 1), loc=2, borderaxespad=0.)","fd22466b":"order={'I':1, 'II':2, 'III':3, 'IV':4, 'V':5}","dbd8f9b7":"fig=sns.FacetGrid(acc,aspect=1.2,palette=\"winter\", hue='Gender',col='Industry Sector', legend_out=True)\nfig.map(sns.countplot, 'Accident Level', order=order)\nplt.legend(bbox_to_anchor=(1.05, 1), loc=2, borderaxespad=0.)\n","31fd837c":"sns.countplot('Employee type',data=acc,palette='cool' )\nplt.legend(bbox_to_anchor=(1.05, 1), loc=2, borderaxespad=0.)","29863f53":"acc['Potential Accident Level'].unique()","6c2afc61":"order2={'I': 1, 'II': 2, 'III': 3, 'IV': 4, 'V': 5, 'VI': 6}","d2f4789e":"q=Series()\nfor i in range(0, len(acc)):\n    q=q.append(Series(order2[acc.loc[i]['Accident Level']]*order2[acc.loc[i]['Potential Accident Level']]), ignore_index=True)","b51e6dba":"acc['Accident Impact']=q","4db84911":"acc.head(5)","ef375435":"acc.plot(x='Date', y='Accident Impact', figsize=(15,4), kind='line')","2cafafed":"acc.plot(x='Date', y='Accident Impact', figsize=(15,4), kind='line')\nplt.text(x='2016-6-15', y=28.5, s='July 2016', color='red', fontsize=12)\nplt.vlines(x='2016-7-1', ymin=25, ymax=28, color='red', linestyles=':', linewidth=3)\nplt.text(x='2017-3-5', y=28.5, s='March 2017', color='red', fontsize=12)\nplt.vlines(x='2017-3-15', ymin=25, ymax=28, color='red', linestyles=':', linewidth=3)\n","88fa87fa":"plt.figure(figsize=(15,4))\nsns.boxplot(x='month', y='Accident Impact', data=acc, palette='Set3', saturation=1)\n","4911dbbf":"wd=[]\nfor i in range(len(acc)):\n    wd.append(acc['Date'].loc[i].weekday())","37d23db3":"weekday={'0':'Monday',\n        '1':'Tuesday', \n        '2':'Wednesday',\n        '3':'Thursday',\n        '4':'Friday',\n        '5':'Saturday',\n        '6':'Sunday'}","9118427a":"wd_order={'Monday':1,\n        'Tuesday':2, \n        'Wednesday':3,\n        'Thursday':4,\n        'Friday':5,\n        'Saturday':6,\n        'Sunday':7}","8abde2f4":"wwd=[]\nfor i in wd:\n    wwd.append(weekday[str(i)])","645b8d5c":"acc['weekday']=wwd","896c0461":"week_d=acc.pivot_table(index='weekday', columns='Industry Sector', aggfunc='count')['Accident Level']","8c1b4c9f":"week_d.loc[wd_order].plot(figsize=(10,4), xticks=range(7), cmap='Dark2', kind='line')\nplt.ylabel('number of accidents')","78d8b0bf":"acc.groupby('weekday').count()['month'].loc[wd_order].plot(kind='line', figsize=(9,4), xticks=range(0,8), color='#FF6A6A')","eeba1d8e":"sns.factorplot(x='year', y='Accident Impact', data=acc, hue='Industry Sector', aspect=2, size=4)","eb5ea1e3":"acc_ind=acc.groupby('Industry Sector').count()['Date']","a09de6dc":"acc_ind_imp=acc.groupby('Industry Sector')['Accident Impact'].mean()","03c96205":"acc_ind_imp.plot(kind='pie', figsize=(5,5), cmap='Set1', autopct='%.2f', title='Mean Accident Impact')\n","1a8f4c99":"acc_ind.plot(kind='pie', figsize=(5,5), cmap='Set2', autopct='%.2f', title='Number of Incidents')","d66cbd73":"acc_cr=acc.pivot_table(index='Critical Risk', columns='Accident Level', aggfunc='count')['month']\nacc_cr.replace(n, 0, inplace=True)\nacc_cr['total']=acc_cr.sum(axis=1)","2fc9eb61":"acc_cr.style.background_gradient(cmap='Blues')","3da2b1da":"acc_cr.drop('Others', axis=0, inplace=True)","ac90c756":"acc_cr.total.sort_values().plot(kind='barh', figsize=(8,20), xticks=range(0,25), grid=False, width=0.65)\nplt.xlabel('total number of accidents')\n","1ef819bc":"acc_cr.nlargest(6, 'total').style.background_gradient(cmap='winter')","69db9790":"acc_ind_risk=acc.pivot_table(index='Critical Risk', columns='Industry Sector', aggfunc='count')['Accident Level']\nacc_ind_risk.drop('Others', axis=0, inplace=True)\nacc_ind_risk.replace(n, 0, inplace=True)\nacc_ind_risk['total']=acc_ind_risk.sum(axis=1)\nacc_ind_risk","bc2dd401":"acc_ind_risk.nlargest(6,'total').plot(kind='bar', xticks=range(30), figsize=(15,5), cmap='summer')\nplt.xticks(rotation=90)","34f54ab7":"acc_ind_risk_nt=acc_ind_risk.drop('total', axis=1)","08579012":"fig=acc_ind_risk_nt.plot(kind='bar', xticks=range(30),yticks=range(0,21), figsize=(15,6), cmap='Paired', width=0.9)\nfig.set_facecolor('#2B2B2B')\nplt.legend(bbox_to_anchor=(1.05, 1), loc=2, borderaxespad=0.)\nplt.text(x=0.9, y=11, s='V', color='#CD661D', fontsize=25)\nplt.text(x=3.3, y=16, s='V', color='#ADD8E6', fontsize=25)\nplt.text(x=5.4, y=11, s='V', color='#ADD8E6', fontsize=25)\nplt.text(x=14.4, y=15, s='V', color='#ADD8E6', fontsize=25)\nplt.text(x=18.4, y=17.5, s='V', color='#ADD8E6', fontsize=25)\nplt.text(x=21.6, y=10, s='V', color='#FFD39B', fontsize=25)\nplt.text(x=28.6, y=9, s='V', color='#FFD39B', fontsize=25)\nplt.text(x=30, y=14, s='V', color='#CD661D', fontsize=25)","7a59b03f":"acc_risk_other=acc.loc[acc['Critical Risk']=='Others']","00605cff":"sns.countplot('Employee type', data=acc_risk_other)","094267a6":"sns.distplot(acc_risk_other['Accident Impact'])","646e318f":"The obvious problem here is that the row of \"Others\" has the highest number of entries. This means the reporting and classification process of critical risk is not optimum. The majority of the incidents that happen on site can not be classified using the categories assigned here.\nFor now, let's get rid of the \"Others\" row:","67223b09":"There are no null values but we need to do some clean up:","22913994":"Now let's dive a little deeper into our incidents reports. The factor of \"potential incident level\" is extremely important here. Something as minor as droping a tool can be a level I incident, but if this is happening when the worker is working on an instrument with a lot of moving parts, it can potentially lead to an explosion. To take this effect into account, I defined a new paramter: \"Accident Impact\" which is defined as accident level multiplied by potential accident level.  ","a8c191eb":"Now I am intersted to know more about the employee composition in the reports that categorized the risk as \"Others\". My hypothesis is that the third part employees may not be as familiar with risk categories as the company employees and that's why they report most incidents as \"Others\". ","9158c81c":"There are a number of high peaks on this graph that were not visible in our first graph which was just based on the number of incidents. For example, July 2016 doesn't show a particularly higher number of incidents, while we know from this graph that July 2016 was a ver high risk month and the incidents during that time probably need to be investigated further. The same goes for March of 2017.","a715168e":"\n*  The \"Others\" sector has the highest number of incidents related to bees and venomous animals. Maybe it's mostly related to agriculture?\n*  In Metals, chemical substances, manual tools, cuts, and pressed are the most frequent incident types.\n*  In Mining, projections and mobile equipement are the most frequent type of incidents.\n","5be1f85e":"some changes to the \"Date\" column is needed: ","f84b28e5":"Now, I'm curious to see which day of the week has more incidents.","9b008fd1":"Saturdays are high risk in mining sector, while there is a drop in number of incidents on Saturday for metals sector. this could be due to number of operations running on Saturday, number of people present on site on Saturday or the reporting procedures and how well they are followed on Saturdays.  \noverall, Thursdays seem to be consistently high incident days in all sectors.","e50eddd1":"**1- what is the trend of accidents with time?**","0317a564":"Loading the data:","ca2ea75d":"October seems particularly high risk, specially considering the fact that the data from October is from year of 2016 alone.","3a65ea9b":" There is not much of a difference between Third Party workers and Employees in the incident report. This information would be valueable if we had a better idea of the composition of the workforce. ","7673d1b0":"Well, this graph proves that the hypothesis is not right because the compostion of employee type in this group is similar to the one we had for the whole data set.","12af3c25":"Incidents happen more frequently in Mining sector. Almost twice as Metals.\n","c3e85b23":"Ok, first observations: \n* accidents with the level I are most common. these are your small negligences, like when people forgot their PPE, or when they drop a tool, etc.\n* by looking at 2016 data, you can see that number of incidents in the first half of the year seem to be higher than in the second. The overview for this dataset mentioned that this data is from manufacturing plants in South America, so the first half of the year is cold and the second is warmer. So the number of incidents is higher in colder months. ","f2ce5ea5":"Let's take a look at the role of operator gender: ","8122d779":"Looks like there are fewer female operators in the incidents reports and it seems to bo consistent in every sector in the dataset. ","2ab5ae3e":"I want to see the incidents each month:","270e5d9c":"Incidents on industrial sites are a major source of concern for workers, managers, and even policy makers. As someone who has been on site many times, I have first hand experience with safety measures and incident reports in oil and mining industry.  In this notebook, I will explore this health and safety dataset and will try to find insights into what the major trends are for incidents in each sector, and potentially, what policies can be put in place to reduce the number and severity of incidents. Let's dig in! ","9f51686d":"The good thing is that the majority of incidents in this category have an accident impact of less than five.","aec2ce05":" Operations in both mining and metals sectors are becoming more risky with time. ","c087277e":"Now let's take a look at the critical risk category. This column contains information on the type of incident."}}