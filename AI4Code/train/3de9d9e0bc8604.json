{"cell_type":{"05045c0c":"code","82a9004c":"code","b5e9f57f":"code","1d14b695":"code","d2ef23a9":"code","228d6eff":"code","597e89ab":"code","070de834":"code","aad48a82":"code","9ab9ab81":"code","676a1ca1":"code","ec0437fb":"code","fed8ea32":"code","f1fe733e":"code","a7786bef":"markdown","e1e96bf3":"markdown","02985188":"markdown","7abfcc1e":"markdown"},"source":{"05045c0c":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","82a9004c":"import pandas as pd","b5e9f57f":"train = pd.read_csv('\/kaggle\/input\/digit-recognizer\/train.csv')\ntrain.head()","1d14b695":"x_train = train.drop('label', axis=1).to_numpy()\ny_train = train['label'].to_numpy()\nprint(x_train.shape, y_train.shape)","d2ef23a9":"x_train = x_train.reshape(-1, 28, 28, 1)","228d6eff":"import tensorflow as tf","597e89ab":"model = tf.keras.models.Sequential([\n    tf.keras.layers.Conv2D(16, (3,3), activation='relu', input_shape=(28,28,1)),\n    tf.keras.layers.MaxPooling2D(),\n    tf.keras.layers.Conv2D(32, (3,3), activation='relu'),\n    tf.keras.layers.MaxPooling2D(),\n    tf.keras.layers.Conv2D(64, (3,3), activation='relu'),\n    tf.keras.layers.MaxPooling2D(),\n    tf.keras.layers.Flatten(),\n    tf.keras.layers.Dense(10, activation='softmax')\n])","070de834":"model.compile(optimizer=tf.keras.optimizers.RMSprop(lr=0.001), loss='sparse_categorical_crossentropy', metrics=['accuracy'])","aad48a82":"history = model.fit(x_train, y_train, epochs=20, validation_split=0.2, shuffle=True)","9ab9ab81":"# All training data\nhistory = model.fit(x_train, y_train, epochs=20)","676a1ca1":"test = pd.read_csv('\/kaggle\/input\/digit-recognizer\/test.csv').to_numpy()\nprint(test.shape)","ec0437fb":"test = test.reshape(-1, 28, 28, 1)","fed8ea32":"preds = model.predict(test)","f1fe733e":"df = pd.DataFrame(np.argmax(preds, axis=1), columns=['Label'])\ndf.insert(0, 'ImageId', df.index + 1)\ndf.to_csv('submission.csv', index=False)","a7786bef":"## Data prep","e1e96bf3":"## Submission","02985188":"## Model","7abfcc1e":"## Predictions"}}