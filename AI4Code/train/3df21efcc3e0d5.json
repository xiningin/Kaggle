{"cell_type":{"a9e32718":"code","bc42f4a1":"code","0103e913":"code","907a70e5":"code","725fa04b":"code","fcbc6ea7":"code","ff9dcea1":"code","e6b1de48":"code","26683dd9":"code","06d7df8f":"code","7b0c4d42":"code","aa1ed414":"code","7f3956d7":"code","c1802339":"code","95be3bb3":"code","dcb8d28b":"code","2fb469d5":"markdown","d7a169d5":"markdown","229d77be":"markdown","33eec56d":"markdown","b094cfe8":"markdown","ec056181":"markdown","e95ae379":"markdown","e46cd2bf":"markdown","283293bd":"markdown","f539f0ee":"markdown","e3500d4b":"markdown","70ac88a3":"markdown","23c33466":"markdown","eedae5c1":"markdown","7ba35fda":"markdown","5e83c939":"markdown","897130ee":"markdown","461bb49c":"markdown","6013989d":"markdown","a99e0e21":"markdown","b2ac6faf":"markdown","a7bf1db9":"markdown","acd9e877":"markdown","98ffa596":"markdown","243bed0d":"markdown","a96c2e02":"markdown","8ce8628c":"markdown","8ac320c6":"markdown","56e05e08":"markdown"},"source":{"a9e32718":"import re\nimport pandas as pd\nfrom collections import defaultdict\nimport spacy\nimport en_core_web_sm\nimport numpy as np\nimport matplotlib.pyplot as plt","bc42f4a1":"metadata=pd.read_csv(\"\/kaggle\/input\/CORD-19-research-challenge\/metadata.csv\")\nmetadata=metadata[metadata[\"abstract\"]==metadata[\"abstract\"]]\nprint(metadata.shape)","0103e913":"nlp = en_core_web_sm.load(disable=['ner', 'parser']) # disabling Named Entity Recognition for speed\n\ndef cleaning(doc):\n    # Lemmatizes and removes stopwords\n    # doc needs to be a spacy Doc object\n    txt = [token.lemma_ for token in doc if not token.is_stop]\n    # Word2Vec uses context words to learn the vector representation of a target word,\n    # if a sentence is only one or two words long,\n    # the benefit for the training is very small\n    if len(txt) > 2:\n        return ' '.join(txt)\nbrief_cleaning = (re.sub(\"[^A-Za-z']+\", ' ', str(row)).lower().replace(\"abstract\", \"\") for row in metadata['abstract'])\ntxt = [cleaning(doc) for doc in nlp.pipe(brief_cleaning, batch_size=5000, n_threads=-1)]\ndf_clean = pd.DataFrame({'clean': txt})\ndf_clean = df_clean.dropna().drop_duplicates()","907a70e5":"from gensim.models.phrases import Phrases, Phraser\nsent = [row.split() for row in df_clean['clean']]\nphrases = Phrases(sent, min_count=30, progress_per=10000)\nbigram = Phraser(phrases)\nsentences = bigram[sent]","725fa04b":"word_freq = defaultdict(int)\nfor sent in sentences:\n    for i in sent:\n        word_freq[i] += 1","fcbc6ea7":"MIN_COUNT=6\nDICT=[key for key in word_freq.keys() if word_freq[key]>MIN_COUNT]","ff9dcea1":"\"covid\" in DICT","e6b1de48":"import multiprocessing\n\nfrom gensim.models import Word2Vec\n\ncores = multiprocessing.cpu_count()\n\nw2v_model = Word2Vec(min_count=MIN_COUNT,\n                     window=2,\n                     size=200,\n                     sample=1e-4, \n                     alpha=0.01,\n                     min_alpha=0.0001, \n                     negative=15,\n                     workers=cores-1)\n\nw2v_model.build_vocab(sentences, progress_per=10000)\n\nw2v_model.train(sentences, total_examples=w2v_model.corpus_count, epochs=30, report_delay=1)\n\nw2v_model.init_sims(replace=True)","26683dd9":"w2v_model.wv.most_similar(\"treatment\",topn=10)","06d7df8f":"w2v_model.wv.most_similar(positive=[\"china\"],topn=10)","7b0c4d42":"w2v_model.wv.most_similar(positive=[\"oseltamivir\"],topn=10)","aa1ed414":"w2v_model.wv.most_similar(positive=[\"malaria\"],topn=10)","7f3956d7":"w2v_model.wv.most_similar(positive=[\"covid\"],topn=10) #ncp=novel coronavirus pneumonia","c1802339":"w2v_model.wv.most_similar(positive=[\"remdesivir\"],topn=20) #recommended by WHO on Jan 24","95be3bb3":"diseases=[\"covid\",\"coronavirus\",\"sars\",\"mers\",\"covid_pneumonia\",\"novel_coronavirus\",\"ncov\",\"cov\",\"coronavirus_sars\",\"sars_cov\",\"influenza\",\"seasonal_influenza\",\"h_n\",\"swine_flu\",\"avian_flu\"]","dcb8d28b":"X = w2v_model[diseases].T\nfrom sklearn.decomposition import PCA\npca = PCA(n_components=2)\nresult = pca.fit_transform(X.T)\nplt.figure(figsize=(15,5))\nplt.scatter(result.T[0],result.T[1])\nplt.yticks(fontsize=14)\nplt.xticks(fontsize=14)\nplt.xlabel(\"Component 1\",fontsize=14)\nplt.ylabel(\"Component 2\",fontsize=14)\nfor i in range(0,len(diseases)):\n    plt.annotate(diseases[i],xy=(result.T[0][i],result.T[1][i]), xycoords='data',\n            xytext=(-15, 5), textcoords='offset points', fontsize=15)","2fb469d5":"Great, the model seems to know that the antiviral **Oseltamivir** (commercial name **Tamiflu**) is a **Neuraminidase Inhibitor** (**NAI**), similar to **Zanamivir**, and that is given to patients in combination with antibiotics (**Vancomycin**, **Erythromycin**, **Fluoroquinolone**, **Clarithromycin**, ...). I didn't know that!","d7a169d5":"## Exploring the model","229d77be":"Abstracts are usually **less noisy** than the whole texts, because they are more concise and not redundant. This is why they are preferred in this analysis.","33eec56d":"Word embeddings also show unequivocally that the literature does not regard COVID-19 as a seasonal flu, suggesting that the **containment** precautions taken in many countries are largely **supported** by scientific evidence.","b094cfe8":"## Fighting COVID-19","ec056181":"Wow, my model has autonomously learned **Geography**; it knows that Taiwan is a country, as well as China, and that the provinces Hubei and Guangdong, and the cities Wuhan and Shenzhen are all in China.","e95ae379":"## Method","e46cd2bf":"In this notebook, the abstracts in the CORD-19 corpus are used to build word embeddings with *Word2Vec*. Distances in the high-dimensional space mapped by *Word2Vec* reveal bits of knowledge around COVID-19. Examples include the **autonomous discovery** of the similarity between COVID-19 and SARS and MERS, of the radical difference between COVID-19 and seasonal flu, and of state-of-the-art trial therapies. The model developed here can become a valuable tool to explore the literature related to COVID-19.","283293bd":"The plot nicely shows that **two** separate **clusters** form: one contains very bad respiratory illnesses (COVID, SARS, MERS), and the other less severe types of flu. Therefore, it can be concluded that COVID-19 is **NOT A COMMON FLU** and must not be underestimated.","f539f0ee":"Given this list of diseases:","e3500d4b":"Let's see if the model is reasonable. First of all, let's look at similarities:","70ac88a3":"## Word embeddings lead to scientific discovery","23c33466":"It also \"knows\" that malaria is caused by the Protozoa *Plasmodium Falciparum* and *Plasmodium Vivax*.","eedae5c1":"*To the patients, doctors and nurses all over the world: keep on fighting.*","7ba35fda":"Ok, this makes sense; most of the words related to \"treatment\" are **synonyms**.","5e83c939":"[This](https:\/\/www.kaggle.com\/pierremegret\/gensim-word2vec-tutorial) notebook is a great hands-on introduction to word embeddings and I have borrowed pieces of code from it.","897130ee":"Some checks:","461bb49c":"## Conclusions","6013989d":"Setting up bigrams:","a99e0e21":"## Training the model","b2ac6faf":"I have applied Principal Component Analysis to the 200-dimensional space mapped by *Word2Vec* to downfold it to 2D and plotted the components of each disease in this low-dimensional representation:","a7bf1db9":"Common knowledge related to COVID-19 stems out naturally from word embeddings produced from the CORD-19 database. Potential effective therapies being experimented are close in terms of distance in the high-dimensional space produced by Word2Vec, thus eventual new treatments can arise by exploring the **neighbourhood** of the therapies already in use.","acd9e877":"## Cleaning the Abstracts","98ffa596":"This work was largely inspired by a recent [article](https:\/\/www.nature.com\/articles\/s41586-019-1335-8) on how scientific discovery (in that case of high-performance materials) is often latent in past literature and how Natural Language Processing can track hidden relationship that lead to invention. I, and other Kaggle users (see [this](https:\/\/www.kaggle.com\/tarunpaparaju\/covid-19-dataset-gaining-actionable-insights) or [this](https:\/\/www.kaggle.com\/tylersuard\/mat2vec-covid-papers-unexpected-word-asociations?scriptVersionId=30790274) notebooks, for example), thought that the same principle can be applied to the CORD-19 database.","243bed0d":"I find potential alternative candidates to fight COVID-19:\n- **Nitazoxanide** is a broad-spectrum antiviral [[source]](https:\/\/en.wikipedia.org\/wiki\/Nitazoxanide).\n- **Lopinavir**, **Ritonavir**, and **Darunavir** are used against HIV. On March, 17th 2020 the Italian Agency for Pharmaceuticals (AIFA) has allowed experimental treatment of COVID-19 with a combination of these two drugs [[source]](https:\/\/www.aifa.gov.it\/-\/azioni-intraprese-per-favorire-la-ricerca-e-l-accesso-ai-nuovi-farmaci-per-il-trattamento-del-covid-19).\n- **Favipiravir** is used against flu. On March, 23rd 2020 AIFA has started to consider experimental therapies with this drug in the most-hit regions in Italy [[source]](https:\/\/www.aifa.gov.it\/-\/favipiravir-aggiornamento-della-valutazione-della-cts), despite the very limited scientific evidence of its effectiveness.\n- **Sofosbuvir** is used against Hepatitis C. It has been suggested against COVID-19 [[source]](https:\/\/www.biorxiv.org\/content\/10.1101\/2020.01.30.927574v1.full.pdf), but the scientific evidence is extremely limited.\n- **Umifenovir** (commercial name: Arbidol or Abidol) is also being studied against COVID-19, but AIFA has stated that there is no scientific evidence of it being effective against COVID-19 [[source]](https:\/\/www.aifa.gov.it\/-\/aifa-precisa-uso-umifenovir-su-covid-19-non-autorizzato-in-europa-e-usa-scarse-evidenze-scientifiche-sull-efficacia).\n- **Artesunate**, **Amodiaquine**, **Aminoquinaline**, and **Hydroxychloroquine** are antimalaria drugs. The latter has been approved for testing against COVID-19 on March, 17th 2020 by (AIFA) [[source]](https:\/\/www.aifa.gov.it\/-\/azioni-intraprese-per-favorire-la-ricerca-e-l-accesso-ai-nuovi-farmaci-per-il-trattamento-del-covid-19), and mentioned by Donald Trump [[source]](https:\/\/twitter.com\/realDonaldTrump\/status\/1242120391054757900) and Elon Musk [[source]](https:\/\/twitter.com\/elonmusk\/status\/1239776019856461824) on Twitter (please mind that neither of them is a medical doctor though!)\n","a96c2e02":"## COVID-19 is NOT a simple flu","8ce8628c":"In the [R&D Blueprint Report](https:\/\/apps.who.int\/iris\/bitstream\/handle\/10665\/330680\/WHO-HEO-RDBlueprint%28nCoV%29-2020.1-eng.pdf?ua=1) compiled by WHO on January 24th, 2020, it is suggested that the antiviral **Remdesivir** is the most promising candidate to treat COVID-19. If I look in the \"neighbourhood\" of this drug:","8ac320c6":"Most related words to \"COVID\":","56e05e08":"## Reading the Abstracts"}}