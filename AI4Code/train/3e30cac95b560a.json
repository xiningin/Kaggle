{"cell_type":{"43a7a82c":"code","7a553495":"code","42f1b6e8":"code","726b3bb3":"code","1a51fe83":"code","daa194fb":"code","4e8b3114":"code","7070d507":"code","c1190faa":"code","9171bda7":"code","2eb62457":"code","fbf3bfe7":"code","7aaa0256":"code","e672813a":"markdown","80dda17d":"markdown","20b90f72":"markdown","ecde2f97":"markdown","72c45580":"markdown","316544aa":"markdown","f6da3f75":"markdown","e96cb869":"markdown"},"source":{"43a7a82c":"from sklearn.feature_extraction.text import CountVectorizer,TfidfTransformer\nfrom sklearn.metrics import f1_score\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.svm import LinearSVC\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.datasets import fetch_20newsgroups","7a553495":"cats = ['alt.atheism', 'sci.space']\nnewsgroups_train = fetch_20newsgroups(subset='train', categories=cats)\nnewsgroups_test = fetch_20newsgroups(subset='test', categories=cats)","42f1b6e8":"X_train = newsgroups_train.data\nX_test = newsgroups_test.data\ny_train = newsgroups_train.target\ny_test = newsgroups_test.target","726b3bb3":"X_train[:2]","1a51fe83":"y_train[:2]","daa194fb":"X_test[:2]","4e8b3114":"y_test[:2]","7070d507":"#transformet 1\ncountVectorizer = CountVectorizer()\n\n#transfomer 2\ntfidfTransformer = TfidfTransformer()\n\n#esimator\nlinearSVC = LinearSVC()\n\npipeline = Pipeline([\n    ('countVectorizer',countVectorizer),\n    ('tfidfTransformer',tfidfTransformer),\n    ('linearSVC',linearSVC)\n])","c1190faa":"scores = cross_val_score(pipeline,X_train,y_train,cv=5,scoring='f1_micro')\n\nscores","9171bda7":"scores.mean()","2eb62457":"pipeline.fit(X_train,y_train)","fbf3bfe7":"y_preds = pipeline.predict(X_test)","7aaa0256":"f1_score(y_test, y_preds, average='micro')","e672813a":"# predict test data ","80dda17d":"# load library","20b90f72":"# fit train data ","ecde2f97":"# get f1 score ","72c45580":"# cross validate and get socre ","316544aa":"# load data","f6da3f75":"# split data","e96cb869":"# make Pipeline "}}