{"cell_type":{"9de05e72":"code","ca7e8c44":"code","09f7560d":"code","c97571fc":"code","6085c652":"code","20322cf5":"code","913be3a1":"code","492645b1":"code","c04484d3":"code","dc5944d6":"code","b889827f":"code","d60e48ac":"code","fdeb20f5":"markdown","22458045":"markdown"},"source":{"9de05e72":"import pandas as pd\nimport numpy as np\nimport plotly.express as px\nfrom plotly.offline import init_notebook_mode\nimport plotly.graph_objects as go\ninit_notebook_mode(connected=True)\npd.set_option('display.max_columns', 5000)\nimport warnings\nwarnings.filterwarnings(\"ignore\")\n\ndf = pd.read_csv(\"..\/input\/kaggle-survey-2021\/kaggle_survey_2021_responses.csv\")\ncolumns = df.iloc[0, :]\ndf = df.iloc[1:, :]\ndf.columns = columns","ca7e8c44":"dur_col = \"Duration (in seconds)\"\n\ndf[dur_col] = df[dur_col].astype(int)\n\nfig = px.histogram(df, x=dur_col, log_y=True, title=\"Histogram of Time to Complete Survey\")\nfig.add_vline(x=86400,annotation_text=\"1 day\", annotation_position=\"top right\",\n              opacity=0.5, line_width=2, line_dash=\"dot\")\nfig.add_vline(x=604800,annotation_text=\"1 week\", annotation_position=\"top right\",\n              opacity=0.5, line_width=2, line_dash=\"dot\")\nfig.add_vline(x=604800*2,annotation_text=\"2 weeks\", annotation_position=\"top right\",\n              opacity=0.5, line_width=2, line_dash=\"dot\")\nfig.add_vline(x=604800*3, annotation_text=\"3 weeks\", annotation_position=\"top right\",\n              opacity=0.5, line_width=2, line_dash=\"dot\")\nfig.add_vline(x=2592000,annotation_text=\"30 days\", annotation_position=\"top left\",\n              opacity=0.5, line_width=2, line_dash=\"dot\")\nfig.update_layout(\n            font=dict(\n            family=\"Comic Sans MS\",\n            size=18,\n        )\n    )\nfig.show()","09f7560d":"durations = df[dur_col].sort_values()\n\nvalues = np.logspace(2, 7, num=1000)\nsums = [(durations < val).sum() for val in values]\nfracs = [x\/len(df) for x in sums]\n\nfrac_col = \"Fraction of respondents <br>that completed the survey\"\n\nfrac_df = pd.DataFrame(data={dur_col: values, frac_col: fracs})\n\nfig = px.line(frac_df, x=dur_col, y=frac_col, log_x=True, title=\"Fraction of respondents that completed <br>the survey under a certain amount of time\")\nfig.add_vline(x=np.log10(600),annotation_text=\"10'\", annotation_position=\"bottom left\",\n              opacity=0.5, line_width=0, line_dash=\"dot\")\nfig.add_vline(x=600, opacity=0.5, line_width=2, line_dash=\"dot\")\nfig.add_vline(x=np.log10(1800),annotation_text=\"30'\", annotation_position=\"bottom left\",\n              opacity=0.5, line_width=0, line_dash=\"dot\")\nfig.add_vline(x=1800, opacity=0.5, line_width=2, line_dash=\"dot\")\nfig.add_vline(x=np.log10(3600),annotation_text=\"1 hour\", annotation_position=\"bottom right\",\n              opacity=0.5, line_width=0, line_dash=\"dot\")\nfig.add_vline(x=3600, opacity=0.5, line_width=2, line_dash=\"dot\")\nfig.add_vline(x=np.log10(86400),annotation_text=\"1 day\", annotation_position=\"bottom left\",\n              opacity=0.5, line_width=0, line_dash=\"dot\")\nfig.add_vline(x=86400, opacity=0.5, line_width=2, line_dash=\"dot\")\nfig.add_vline(x=np.log10(604800),annotation_text=\"1 wk\", annotation_position=\"bottom left\",\n              opacity=0.5, line_width=0, line_dash=\"dot\")\nfig.add_vline(x=604800, opacity=0.5, line_width=2, line_dash=\"dot\")\nfig.add_vline(x=np.log10(2592000),annotation_text=\"30 days\", annotation_position=\"bottom right\",\n              opacity=0.5, line_width=0, line_dash=\"dot\")\nfig.add_vline(x=2592000, opacity=0.5, line_width=2, line_dash=\"dot\")\nfig.update_layout(\n            font=dict(\n            family=\"Comic Sans MS\",\n            size=18,\n        )\n    )\nfig.show()","c97571fc":"age_col = \"What is your age (# years)?\"\n\n\ndef create_chart(df, groupby, other_col, x, y, color, symbol, title, log_y=True, log_x=False, sort_values=None, labels=None, **kwargs):\n    \n    metrics = [\"count\", \"mean\", \"median\", \"std\"]\n    grouped = df.groupby(groupby, as_index=False)[other_col].agg(metrics).reset_index()\n    melted = pd.melt(grouped, id_vars=[groupby], value_vars=metrics, var_name=\"metric\", value_name=\"value\")\n    if sort_values:\n        melted = melted.sort_values(**sort_values)\n    \n    if labels:\n        labels = {\"value\": \"Time to complete survey (seconds)\", **labels}\n    else:\n        labels = {\"value\": \"Time to complete survey (seconds)\"}\n    fig = px.scatter(melted, x=x, y=y, color=color, symbol=symbol,title=title, log_y=log_y, log_x=log_x, labels=labels, **kwargs)\n    fig.update_traces(marker=dict(size=15,\n                              line=dict(width=1,\n                                        color='black')))\n    fig.update_layout(\n            font=dict(\n            family=\"Comic Sans MS\",\n            size=18,\n        )\n    )\n    return fig\n\ncreate_chart(df=df, groupby=age_col, other_col=dur_col, x=age_col, y=\"value\", color=\"metric\", symbol=\"metric\", title=\"Time to Complete by Age Group<br><sup>Almost monotonically increasing with age<\/sup>\").show()","6085c652":"gender_col = \"What is your gender? - Selected Choice\"\n\nlabels = {\n    gender_col: \"What is your gender?\"\n}\n\ncreate_chart(df=df, groupby=gender_col, other_col=dur_col, x=gender_col, y=\"value\", color=\"metric\", symbol=\"metric\", title=\"Time to Complete by Gender\", labels=labels).show()","20322cf5":"country_col = \"In which country do you currently reside?\"\n\ncountry_map = {\n    \"Iran, Islamic Republic of...\": \"Iran\",\n    \"United States of America\": \"United States\",\n    \"United Kingdom of Great Britain and Northern Ireland\": \"UK and Northern Ireland\"\n}\n\ndf[country_col] = [country_map.get(x,x) for x in df[country_col]]\n\ncreate_chart(df=df, groupby=country_col, other_col=dur_col, x='value', y=country_col, color=\"metric\", symbol=\"metric\", log_y=False, log_x=True, title=\"Time to Complete by Country\", height=2000, sort_values={\"by\": [country_col, \"metric\"], \"ascending\": [False, True]}).show()","913be3a1":"education_col = \"What is the highest level of formal education that you have attained or plan to attain within the next 2 years?\"\n\ned_map = {\n    'Some college\/university study without earning a bachelor\u2019s degree': \"Some college\/university-no bachelor's degree\"\n}\n\ndf[education_col] = [ed_map.get(x,x) for x in df[education_col]]\n\ncategory_orders = {\n    education_col: [\n        'I prefer not to answer',\n        'No formal education past high school',\n        \"Some college\/university-no bachelor's degree\",\n        'Bachelor\u2019s degree',\n         'Master\u2019s degree',\n         'Doctoral degree',\n         'Professional doctorate',\n ]\n}\n\nlabels = {education_col: \"What is the highest level of formal education <br>that you have attained or plan to attain within the next 2 years?\"}\n\ncreate_chart(df=df, groupby=education_col, other_col=dur_col, x=education_col, y=\"value\", color=\"metric\", symbol=\"metric\", title=\"Time to Complete by Education<br><sup>Almost monotonically increasing with degree level<\/sup>\", height=700, labels=labels, category_orders=category_orders).show()","492645b1":"title_col = 'Select the title most similar to your current role (or most recent title if retired): - Selected Choice'\n\nlabels = {\n    title_col: 'Select the title most similar<br>to your current role (or most recent title if retired)'\n}\n\ncreate_chart(df=df, groupby=title_col, other_col=dur_col, x=title_col, y=\"value\", color=\"metric\", symbol=\"metric\", title=\"Time to Complete by Job Title\", height=800, labels=labels).show()","c04484d3":"exp_col = 'For how many years have you been writing code and\/or programming?'\n\ncreate_chart(df=df, groupby=exp_col, other_col=dur_col, x=exp_col, y=\"value\", color=\"metric\", symbol=\"metric\", title=\"Time to Complete by Experience<br><sup>Monotonically increasing with age<\/sup>\", category_orders={exp_col: ['I have never written code', '< 1 years', '1-3 years',  '3-5 years', '5-10 years', \n       '10-20 years', '20+ years', ]}).show()","dc5944d6":"industry_col = 'In what industry is your current employer\/contract (or your most recent employer if retired)? - Selected Choice'\n\nlabels = {\n    industry_col: 'In what industry is your current employer\/contract <br>(or your most recent employer if retired)?'\n}\n\ncreate_chart(df=df, groupby=industry_col, other_col=dur_col, x=industry_col, y=\"value\", color=\"metric\", symbol=\"metric\", title=\"Time to Complete by Industry\", labels=labels, height=800).show()","b889827f":"size_col = 'What is the size of the company where you are employed?'\n\ncategory_orders = {\n    size_col: ['0-49 employees', '50-249 employees', '250-999 employees', '1000-9,999 employees', '10,000 or more employees', ]\n}\n\ncreate_chart(df=df, groupby=size_col, other_col=dur_col, x=size_col, y=\"value\", color=\"metric\", symbol=\"metric\", title=\"Time to Complete by Company Size\", category_orders=category_orders).show()","d60e48ac":"compensation_col = 'What is your current yearly compensation (approximate $USD)?'\n\ncategory_orders = {compensation_col: ['$0-999',\n '1,000-1,999',\n '2,000-2,999',\n '3,000-3,999',\n'4,000-4,999',\n '5,000-7,499',\n '7,500-9,999',\n '10,000-14,999',\n '15,000-19,999',\n '20,000-24,999',\n '25,000-29,999',\n '30,000-39,999',\n '40,000-49,999',\n '50,000-59,999',\n '60,000-69,999',\n '70,000-79,999',\n '80,000-89,999',\n '90,000-99,999',\n '100,000-124,999',\n '125,000-149,999',\n'150,000-199,999',\n '200,000-249,999',\n'250,000-299,999',\n'300,000-499,999',\n '$500,000-999,999',\n '>$1,000,000']}\n\ncreate_chart(df=df, groupby=compensation_col, other_col=dur_col, x=compensation_col, y=\"value\", color=\"metric\", symbol=\"metric\", title=\"Time to Complete by Compensation<br><sup>If you make a ton of money, you won't take as much time<\/sup>\", height=800, category_orders=category_orders).show()","fdeb20f5":"# Who takes the longest to complete the Kaggle Survey? \u23f1\ufe0f\n\n#### This is somewhat of a joke notebook. I was just curious to see if certain groups take longer to fill out the survey compared to others. To make it even more joke-worthy, the figures use Comic Sans MS as the font. \ud83d\ude05\n\n#### A few things to note:\n- There are a few values that are extremely high, skewing the mean. Whenever I make comments, I am referring to the median. \n\n- Because there are a wide range of values, a log scale is used.\n\n- Time is in seconds, and for reference. 3600 seconds = 1 hour, 86.4k seconds = 1 day. \n\n- For exact values, hover over the points.\n\n- Figures should be color-blind friendly","22458045":"# What does this show?\n\n#### Not really anything. Maybe the fact that people take longer if they are older\/more experienced\/more educated. Oh well, I enjoyed myself!\n\n<iframe src=\"https:\/\/giphy.com\/embed\/3o7btNRptqBgLSKR2w\" width=\"480\" height=\"480\" frameBorder=\"0\" class=\"giphy-embed\" allowFullScreen><\/iframe>"}}