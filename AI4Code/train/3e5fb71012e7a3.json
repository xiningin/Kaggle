{"cell_type":{"dcef087f":"code","1d3177d8":"code","88e43731":"code","0ff81785":"code","f743a988":"code","a637996c":"code","8c954643":"code","ad7c5186":"code","cb51b977":"code","5b6bef53":"code","85407238":"markdown","9cea5d03":"markdown","4924da46":"markdown","5c198d25":"markdown","0cfa9796":"markdown","bf0e8172":"markdown","b1520d7b":"markdown","7f9890e5":"markdown","f8675268":"markdown","8a841b89":"markdown","a9dffe71":"markdown"},"source":{"dcef087f":"import numpy as np\nimport pandas as pd \nimport matplotlib.pyplot as plt \n%matplotlib inline\nimport nltk\n# Importing Natural language Processing toolkit.\nfrom PIL import Image\n# from python imaging library\nfrom wordcloud import WordCloud, STOPWORDS, ImageColorGenerator","1d3177d8":"wines =  pd.read_csv(\"..\/input\/wine130k\/winemag-data-130k-v2.csv\",index_col = 0)\ndf_wines = wines[['country', 'description', 'points', 'price', 'variety']]\ndf_wines = df_wines.sample(frac = 0.05)\nprint(df_wines.shape)\ndf_wines.head()","88e43731":"# Firstly let us count the number of words in all in the description texts available to us in our sample data\ntext = \" \".join(review for review in df_wines.description)\nprint (\"There are {} words in the combination of all review.\".format(len(text)))","0ff81785":"# N0w tokenizing the text using TreebankWordTokenizer\ntokenizer1 = nltk.tokenize.TreebankWordTokenizer()\ntokens = tokenizer1.tokenize(text)\ntokens[0:10]","f743a988":"# NOw normalization of the text using lemmatization\nstemmer = nltk.stem.WordNetLemmatizer()\nwords_all = \" \".join(stemmer.lemmatize(token) for token in tokens)\nwords_all[0:100]                     ","a637996c":"stopwords = set(STOPWORDS)\nstopwords.update([\"drink\" , 'now', 'wine' ,'flavour'])\nwordcloud = WordCloud(stopwords = stopwords, background_color = \"white\").generate(words_all)\nplt.imshow(wordcloud, interpolation = 'bilinear')\nplt.axis('off')\nplt.show()","8c954643":"wine_mask = np.array(Image.open('..\/input\/images\/wine.jpg'))\ndef transform_mask(val):\n    # For black color inside the wine bottle and glass making it white\n    if val == 0:\n        return 255\n    else:\n        return val\ntransformed_wine_mask = np.ndarray((wine_mask.shape[0], wine_mask.shape[1]))\nfor i in range(len(wine_mask)):\n    transformed_wine_mask[i] = list(map(transform_mask, wine_mask[i]))","ad7c5186":"wc = WordCloud(background_color=\"white\", max_words=1000, mask=transformed_wine_mask,\n               stopwords=stopwords, contour_width=3, contour_color='firebrick', max_font_size = 34).generate(words_all)\n\n# show\nplt.figure(figsize=[20,10])\nplt.imshow(wc, interpolation='bilinear')\nplt.axis(\"off\")\nplt.show()","cb51b977":"def create_color_comb(country, img):\n    country = \" \".join(review for review in  wines[wines['country'] == country].description)\n    mask = np.array(Image.open(\"..\/input\/images\/\"+img))\n    wordcloud_country = WordCloud(stopwords = STOPWORDS, background_color = 'white',contour_color='firebrick',\n                                  max_words = 1000, mask = mask).generate(country)\n    image_colors = ImageColorGenerator(mask)\n    plt.figure(figsize=[5,8])\n    plt.imshow(wordcloud_country.recolor(color_func=image_colors), interpolation=\"bilinear\")\n    plt.axis(\"off\")","5b6bef53":"create_color_comb(\"India\", \"india.png\")\ncreate_color_comb(\"US\", \"usa.jpg\")","85407238":"### B. Now let us do the same thing with color gradients. \n #### So let us do this with the flag of india and USA and getting their wine descriptions inside them ","9cea5d03":"## Understanding the NLP and Making the Word Clouds","4924da46":"<p> So now our next task is to do some text analysis and NLTK on this and perform some analysis so that we can classify the wines on the basis of number of points i.e. determine its quality and also determine the price values for these wines. So the steps we are going to follow is by removing less important words by using various techniques then we will use the bag of words, tfidf values, then Machine learning classification techniques to predict the values.  <\/p> ","5c198d25":"### Some other techniques to build word Clouds\n<p> Word Clouds need not be in a rectangular box, it can be inside any picture also if we want and it can also have various gradients also giving it a look of a particular object or picture depending on the context without acually using a picture. So now let us try that out. <\/p>","0cfa9796":"<p> This is wine reviews classification. To see the data analysis of the dataset and some basic information related to the dataset the link is further given below.  <a href = 'https:\/\/www.kaggle.com\/bhaargavi\/wine-classification-analysis-of-data'><h3>Link To Text Classification using NLP for Various types of Wines -- Part 1<\/h3><\/a> <\/p> ","bf0e8172":". <p> Now for the further information on NLP and Various ML algos and their accuracies for the prediction of data . Follow this link <a href = ' https:\/\/www.kaggle.com\/bhaargavi\/wine-reviews-classification-using-nlp-and-ml'><h3> Link to Wine Reviews Classification Using NLP and ML<\/h3><\/a> <\/p>","b1520d7b":"### A. Using the picture of a wine and a glass and then using it as a background for wordcloud","7f9890e5":"### Now removing the stopwords \n<p> The stopwords are the words that are very commonly repeated like is, are,the, not, I, am etc and they don't need to be there and they don't tell anything about the sentence. Also they are present in the documents in high frequencies so it is very important to remove them otherwise while making the wordclouds or by classification they can affect the predictions in adverse way. Also the list of stopwords is already predefined for certain languages like english and others and it can also be updates based on the type of data we have.<\/p>","f8675268":"## Text Classification using NLP for Various types of Wines -- Part2","8a841b89":"### Using Tokenization and Normalization","a9dffe71":"### So, firstly let us get some basic concepts \n<ol>  \n <li>Tokenization -- Which involves breaking the sentences into smaller parts called tokens which are generally words.<\/li>\n <li> Normalization -- which involves getting to the root of the word. Like talked becomes talk and talks also becomes talk. So this will eliminate a lot of same words. It can be of 2 forms 1. Stemming and 2. Lemmatization. <\/li> \n <li> Word Cloud --  An image composed of words used in a particular text or subject, in which the size of each word indicates its frequency or importance <\/li>\n<\/ol> \nSo, these are some basic Concepts of NLP Now lets get started and implement them one by one \n  "}}