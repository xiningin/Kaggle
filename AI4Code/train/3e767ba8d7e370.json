{"cell_type":{"87842e8f":"code","25dd7119":"code","6dbb811e":"code","981203f0":"code","b6f98abc":"code","b68c8915":"code","09b08e9d":"code","c09321c9":"code","4b2b6abd":"code","0d93a51d":"code","ce7a1e73":"code","925679be":"code","4be6cf33":"code","b5aeb5a5":"code","314416bb":"code","1c56e58a":"code","a91fc122":"code","13479ef4":"code","98a880b5":"code","f6c162aa":"code","9651bb1e":"code","73ec9e20":"markdown","08df0a2e":"markdown","7aa26aa1":"markdown","c0256d51":"markdown","8e2b7c60":"markdown","ae3cd19d":"markdown","409aad49":"markdown","818d3f60":"markdown","daa46782":"markdown","119f1c9c":"markdown"},"source":{"87842e8f":"import pandas as pd\nimport numpy as np\nfrom matplotlib import pyplot as plt\nimport seaborn as sns\nfrom sklearn.cluster import KMeans\ncustomers = pd.read_csv(r'..\/input\/Mall_Customers.csv')","25dd7119":"customers.head(5)","6dbb811e":"customers.info()","981203f0":"customers.isnull().sum()","b6f98abc":"customers[['Age','Annual Income (k$)','Spending Score (1-100)']].describe()","b68c8915":"col = ['Age','Annual Income (k$)','Spending Score (1-100)']\nn = 0\nplt.figure(1,figsize = (15,6))\nfor x in col:\n    n += 1\n    plt.subplot(1,3,n)\n    plt.subplots_adjust(hspace = 0.5,wspace = 0.5)\n    sns.distplot(customers[x],bins = 20)\n    plt.title('Displot of {}'.format(x))\nplt.show()","09b08e9d":"customers.Gender.value_counts().plot(kind = 'bar')","c09321c9":"plt.figure(1,figsize = (15,7))\nn = 0\nfor y in col:\n    n += 1\n    plt.subplot(1,3,n)\n    plt.subplots_adjust(wspace = 0.5,hspace = 0.5)\n    sns.violinplot(x = 'Gender',y = y ,data = customers,palette='vlag')\n    sns.swarmplot(x = 'Gender',y = y ,data = customers)\n    plt.xlabel('Gender')\n    plt.ylabel(y)\nplt.show()\n    \n        ","4b2b6abd":"plt.figure(1,figsize=(15,6))\nn = 0\nfor x in col:\n    for y in col:\n        n += 1\n        plt.subplot(3,3,n)\n        plt.subplots_adjust(wspace = 0.5,hspace = 0.5)\n        sns.regplot(x = x,y = y,data = customers)\nplt.show()","0d93a51d":"plt.figure(1,figsize=(15,6))\nn = 0\nfor x in col:\n    for y in col:\n        n += 1\n        plt.subplot(3,3,n)\n        plt.subplots_adjust(wspace = 0.5,hspace = 0.5)\n        sns.scatterplot(x = x ,y = y , hue = 'Gender',data = customers)\nplt.show()","ce7a1e73":"X1 = customers[['Age','Spending Score (1-100)']]\ninertia1 = []\nfor n in range(1,11):\n    algorithm1 = KMeans(n_clusters=n)\n    algorithm1.fit(X1)\n    inertia1.append(algorithm1.inertia_)\n","925679be":"plt.figure(1,figsize = (15,6))\nplt.plot(range(1,11),inertia1,'o')\nplt.plot(range(1,11),inertia1,'-',alpha = 0.5)\nplt.xlabel('Number of Cluster')\nplt.ylabel('inertia')\nplt.show()","4be6cf33":"algorithm1 = KMeans(n_clusters=4)\nalgorithm = algorithm1.fit_predict(X1)\nplt.scatter(X1['Age'],X1['Spending Score (1-100)'],c = algorithm)","b5aeb5a5":"X2 = customers[['Age','Annual Income (k$)']]\ninertia2 = []\nfor n in range(1,11):\n    algorithm2 = KMeans(n_clusters=n)\n    algorithm2.fit(X2)\n    inertia2.append(algorithm2.inertia_)\nplt.figure(1,figsize = (15,5))\nplt.plot(range(1,11),inertia2,'o')\nplt.plot(range(1,11),inertia2,'-',alpha = 0.5)\nplt.xlabel('Number of Cluster')\nplt.ylabel('inertia')\nplt.show()","314416bb":"algorithm2 = KMeans(n_clusters=5)\nalgorithm = algorithm2.fit_predict(X2)\nplt.scatter(X2['Age'],X2['Annual Income (k$)'],c = algorithm)\nplt.show()","1c56e58a":"X3 = customers[['Annual Income (k$)','Spending Score (1-100)']]\ninertia3 = []\nfor n in range(1,11):\n    algorithm3 = KMeans(n_clusters=n)\n    algorithm3.fit(X3)\n    inertia3.append(algorithm3.inertia_)\nplt.figure(1,figsize = (15,5))\nplt.plot(range(1,11),inertia3,'o')\nplt.plot(range(1,11),inertia3,'-',alpha = 0.5)\nplt.xlabel('Numbers of Cluster')\nplt.ylabel('inertia')\nplt.show()","a91fc122":"algorithm3 = KMeans(n_clusters=5)\nalgorithm = algorithm3.fit_predict(X3)\nplt.scatter(X3['Annual Income (k$)'],X3['Spending Score (1-100)'],c = algorithm)\nplt.xlabel('Annual Income')\nplt.ylabel('Spending Score')\nplt.show()","13479ef4":"customers['Classify'] = algorithm3.predict(X3)","98a880b5":"sns.scatterplot(x = 'Annual Income (k$)',y = 'Spending Score (1-100)',hue = 'Classify',data = customers)","f6c162aa":"sns.boxplot(x = 'Classify',y = 'Age',data = customers)","9651bb1e":"customers.Classify.value_counts()","73ec9e20":"Data Exploration","08df0a2e":"There are basically conform to the normal distribution expect Age have left-skewed distribution.We can take the logarithm of the Age in the after.","7aa26aa1":"No missing and abnormal data.","c0256d51":"Let's have a look if there are missing or abnormal data.","8e2b7c60":"**Cluster by using KMeans**\n* Age and Spending Score\n* Age and Annual Income\n* Spending Score and Annual Income","ae3cd19d":"Importing Libraries","409aad49":"According to the barplot,we can draw a conclusion that female customer is more than male in the shop.","818d3f60":"*  0 : Lower Income,High Spending(The Younger without economical burden)\n*  1 : High Income,High Spending(The elite)\n*  2 : Middle Incme,Middle Spending(Have a wide distribution,stable customer)\n*  3\u7c7b\uff1aHigh Income,Lower Spending(We can do much marketing to push them to consume)\n*  4\u7c7b\uff1aLower Income,Lower Spending(We don't need to do much marketing)","daa46782":"** Data visualization**","119f1c9c":"**Variable demonstration**\n* CustomerID: Unique ID assigned to the customer\n* Gender: Gender of the customer\n* Age: Age of the customer\n* Annual Income (k$): Annual Income of the customee\n* Spending Score (1-100): Score assigned by the mall based on customer behavior and spending nature"}}