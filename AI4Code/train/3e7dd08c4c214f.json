{"cell_type":{"2924609c":"code","0239e55a":"code","0f06a7a3":"code","f48c82ca":"code","ad25a8f8":"code","6bec712a":"code","c66dc9de":"code","06fd7674":"code","ba724c20":"code","2a1dda2c":"code","40b4bf30":"code","3d7285c8":"code","4a88a35d":"code","2142949e":"code","b44c5bcb":"code","b30c80a0":"code","2f7c24fd":"code","98cd1665":"code","0293c4fa":"code","39eea395":"code","33bc20eb":"code","8ad4ab50":"code","72058748":"code","a0c9a534":"markdown","2b6d64e4":"markdown","3e2f2022":"markdown"},"source":{"2924609c":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom sklearn.feature_extraction.text import TfidfVectorizer, CountVectorizer\nfrom nltk.corpus import stopwords\nfrom sklearn.model_selection import GridSearchCV, StratifiedKFold, train_test_split\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import confusion_matrix, accuracy_score, roc_curve, roc_auc_score, classification_report\nfrom sklearn.naive_bayes import MultinomialNB\nfrom xgboost.sklearn import XGBClassifier\nfrom collections import Counter\nfrom nltk.tokenize import word_tokenize, sent_tokenize","0239e55a":"data_raw = pd.read_csv('..\/input\/us-election-2020-presidential-debates\/us_election_2020_1st_presidential_debate.csv', engine='python')","0f06a7a3":"data_raw.head(5)","f48c82ca":"wallace_mask = data_raw['speaker'] == 'Chris Wallace'\ndata_raw.drop(data_raw[wallace_mask].index, inplace=True)\ndata_raw.dropna(inplace=True)\ndata_raw.info()","ad25a8f8":"def most_common_words(name, data, number_of_words):\n    candidate_mask = data['speaker'] == name\n    candidate_data = data[candidate_mask]\n\n    candidate_text = ''\n    for i in candidate_data['text']:\n        candidate_text = candidate_text + i.lower() + ' '\n    \n    stopset = stopwords.words('english')\n    stopwords_to_add = ['.', ',', '\u2019', '?', '[', ']', '\u2026', 'going', 'want', 'know', 'look', 'would', 'said', 'got', 'think', 'say', 'tell', 'go', 'get', 'crosstalk', 'well', 'like', 'much', 'make']\n    for i in stopwords_to_add:\n        stopset.append(i)\n\n    candidate_text_tokenized = word_tokenize(candidate_text)\n    candidate_text_final = [i for i in candidate_text_tokenized if i not in stopset]\n\n    candidate_counter = Counter(candidate_text_final)\n    candidate_counter_words = candidate_counter.most_common(number_of_words)\n    \n    df = pd.DataFrame(candidate_counter_words, columns = ['Word', 'Frequency'])\n    \n    return df","6bec712a":"df_trump = most_common_words('President Donald J. Trump', data_raw, 10)\ndf_trump","c66dc9de":"df_biden = most_common_words('Vice President Joe Biden', data_raw, 10)\ndf_biden","06fd7674":"fig, ax = plt.subplots(1, 2, figsize=(12,6), sharey=True)\nsns.barplot(data=df_trump, x='Word', y='Frequency', palette='rocket', ax=ax[0]).set_title('Donald Trump')\nsns.barplot(data=df_biden, x='Word', y='Frequency', palette='mako', ax=ax[1]).set_title('Joe Biden')\nax[0].tick_params(labelrotation=45)\nax[1].tick_params(labelrotation=45)\nfig.savefig('test2.jpg', bbox_inches='tight')","ba724c20":"stop_words=stopwords.words('english')\n\nX = data_raw['text']\ny = data_raw['speaker']\n\nprint(y.value_counts(normalize=True))\ny.value_counts()","2a1dda2c":"le = LabelEncoder()\ny_encoded = le.fit_transform(y)","40b4bf30":"le.classes_","3d7285c8":"X_train, X_test, y_train, y_test = train_test_split(X, y_encoded, stratify=y_encoded, random_state=1)\n\ntf_idf = TfidfVectorizer(stop_words=stop_words, lowercase=True)\n\nbag_of_words_train = tf_idf.fit_transform(X_train)\nbag_of_words_train_features = tf_idf.get_feature_names()\nbag_of_words_train_df = pd.DataFrame(bag_of_words_train.toarray(), columns=bag_of_words_train_features)\n\nbag_of_words_test = tf_idf.transform(X_test)\nbag_of_words_test_features = tf_idf.get_feature_names()\nbag_of_words_test_df = pd.DataFrame(bag_of_words_test.toarray(), columns=bag_of_words_test_features)","4a88a35d":"kfold = StratifiedKFold(random_state=1, shuffle=True)\n\nparameters_mnb = {  \n'alpha': np.linspace(0.01, 1, 10)  \n}\n\nmnb = MultinomialNB()\ngrid_search_mnb = GridSearchCV(mnb, param_grid=parameters_mnb, scoring='accuracy')\ngrid_search_mnb.fit(bag_of_words_train_df, y_train)","2142949e":"y_pred_class_mnb = grid_search_mnb.predict(bag_of_words_test_df)\ny_pred_score_classes_mnb = grid_search_mnb.predict_proba(bag_of_words_test_df)\ny_pred_score_mnb = y_pred_score_classes_mnb[:, 1]\n\nclassif_report_mnb = classification_report(y_test, y_pred_class_mnb)\nprint(classif_report_mnb)","b44c5bcb":"confusion_matrix(y_test, y_pred_class_mnb)","b30c80a0":"rfc = RandomForestClassifier()\nrfc.fit(bag_of_words_train_df, y_train)\n\ny_pred_class_rfc = rfc.predict(bag_of_words_test_df)\ny_pred_score_classes_rfc = rfc.predict_proba(bag_of_words_test_df)\ny_pred_score_rfc = y_pred_score_classes_rfc[:, 1]","2f7c24fd":"classif_report = classification_report(y_test, y_pred_class_rfc)\nprint(classif_report)","98cd1665":"confusion_matrix(y_test, y_pred_class_rfc)","0293c4fa":"accuracy_score(y_test, y_pred_class_rfc)","39eea395":"fpr, tpr, thresholds = roc_curve(y_test, y_pred_score_rfc)\n\nprint(roc_auc_score(y_test, y_pred_score_rfc))\n\nplt.title('Receiver Operating Characteristic')\nplt.plot(fpr, tpr)\nplt.plot([0, 1], ls=\"--\")\nplt.plot([0, 0], [1, 0] , c=\".7\"), plt.plot([1, 1] , c=\".7\")\nplt.ylabel('True Positive Rate')\nplt.xlabel('False Positive Rate')\nplt.show()","33bc20eb":"params_xgb = {  \n    \"n_estimators\": [50,100,500],\n    \"max_depth\": [1,2,3,4],\n    \"learning_rate\": [0.01, 0.1],\n}\n\nxgb = XGBClassifier(n_jobs=-1)\ngrid_search_xgb = GridSearchCV(xgb, param_grid=params_xgb, cv=kfold, verbose=1, n_jobs=-1)\ngrid_search_xgb.fit(bag_of_words_train_df, y_train)","8ad4ab50":"y_pred_class_xgb = grid_search_xgb.predict(bag_of_words_test_df)\ny_pred_score_classes_xgb = grid_search_xgb.predict_proba(bag_of_words_test_df)\ny_pred_score_xgb = y_pred_score_classes_xgb[:, 1]\n\nclassif_report = classification_report(y_test, y_pred_class_xgb)\nprint(classif_report)","72058748":"confusion_matrix(y_test, y_pred_class_xgb)","a0c9a534":"Multinomial Naive Bayes","2b6d64e4":"Extreme Gradient Boosting","3e2f2022":"Random Forest"}}