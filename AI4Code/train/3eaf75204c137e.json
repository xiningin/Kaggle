{"cell_type":{"49bb688d":"code","f9e0bd7c":"code","65854c61":"code","bf1090c8":"code","4a92aa03":"code","a8878609":"code","7ad47994":"code","01a66ca9":"code","fbf7d390":"code","7556e941":"code","99ca8a5a":"code","2c80633b":"code","34baa601":"code","eb0eb943":"code","e3b04c99":"code","a22d4a04":"code","603e5671":"code","52edf4ec":"code","cb4783e7":"code","25c337ad":"code","f41919ab":"code","eb7a6d0b":"code","6b0ca845":"code","dec7a49b":"markdown","0c43e8c7":"markdown","aa7e6eb4":"markdown","7c2786f8":"markdown","5b845b58":"markdown","12d2cbb9":"markdown","e89ee5d4":"markdown","44a4190a":"markdown","18e3cbd1":"markdown","f86ef406":"markdown","c84cb96f":"markdown","a15dfc1a":"markdown","ffc36802":"markdown","939bb4a1":"markdown","0804db88":"markdown","38f5c658":"markdown","11cd1f86":"markdown","9cce9d80":"markdown","e0ad76dc":"markdown","eab11d62":"markdown","8aa01b01":"markdown","109b481a":"markdown","1f5868c8":"markdown","0f063796":"markdown","efcb4bf7":"markdown","d75d9bd4":"markdown"},"source":{"49bb688d":"# Data Manipulation, Linear Algebra\r\nimport pandas as pd\r\nimport numpy as np\r\n\r\n# Plots\r\nimport seaborn as sns\r\nsns.set_style(\"darkgrid\")\r\nimport matplotlib.pyplot as plt\r\n\r\n#ignore warning messages \r\nimport warnings\r\nwarnings.filterwarnings('ignore')\r\n\r\n# Machine Learning\r\nfrom sklearn.metrics import r2_score\r\nfrom sklearn.preprocessing import OneHotEncoder, StandardScaler\r\n\r\nfrom sklearn import tree, linear_model, ensemble, neighbors\r\nfrom catboost import CatBoostRegressor\r\nfrom xgboost import XGBRegressor","f9e0bd7c":"data = pd.read_csv(\"..\/input\/california-housing-prices\/housing.csv\")\r\ndata.head()","65854c61":"data.info()","bf1090c8":"data.isnull().sum()","4a92aa03":"data.describe()","a8878609":"fig, axes = plt.subplots(figsize=(18, 12), nrows=2, ncols=1)\r\n\r\nsns.histplot(data.total_bedrooms, ax=axes[0])\r\naxes[0].set_title(\"Total Number of Bedrooms Distribution - Histogram\")\r\naxes[0].set_xlabel('Number of Bedrooms')\r\naxes[0].set_ylabel('Count of Houses')\r\n\r\nsns.boxplot(data.total_bedrooms, ax=axes[1])\r\naxes[1].set_title(\"Total Number of Bedrooms Distribution - Boxplot\")\r\naxes[1].set_xlabel('Number of Bedrooms')\r\n\r\n\r\nplt.show()","7ad47994":"data.total_bedrooms.fillna(data.total_bedrooms.median(), inplace=True)\r\ndata.isnull().sum()","01a66ca9":"plt.rcParams[\"figure.figsize\"] = (18, 20)\r\ndata.hist()\r\nplt.show()","fbf7d390":"plt.rcParams[\"figure.figsize\"] = (12, 8)\r\nsns.heatmap(data.corr(), annot=True)\r\nplt.title(\"Corelation Heatmap\")\r\nplt.show()","7556e941":"def scatter_plots(x_var, y_var):\r\n    fig, axes = plt.subplots(figsize=(20, 8), nrows=1, ncols=3)\r\n    \r\n    ax = 0\r\n    for y in y_var:\r\n        sns.scatterplot(x=x_var, y=y, hue=\"ocean_proximity\", data=data, ax=axes[ax])\r\n        axes[ax].set_title(f\"{x_var} vs {y}\")\r\n\r\n        ax += 1\r\n\r\n    plt.show()","99ca8a5a":"scatter_plots(\"total_rooms\", [\"total_bedrooms\", \"population\", \"households\"])","2c80633b":"scatter_plots(\"housing_median_age\", [\"total_rooms\", \"population\", \"households\"])","34baa601":"plt.rcParams[\"figure.figsize\"] = (20, 10)\r\nsns.scatterplot(x=\"median_income\", y=\"median_house_value\", hue=\"ocean_proximity\", data=data)\r\nplt.title(\"Medain Income vs Medain House Value\")\r\nplt.show()","eb0eb943":"new_data = pd.get_dummies(data)\r\nnew_data.head()","e3b04c99":"X = new_data.drop(\"median_house_value\", axis=1)\r\ny = new_data.median_house_value.values.reshape(-1, 1)","a22d4a04":"scaler = StandardScaler()\r\n\r\nX = scaler.fit_transform(X)","603e5671":"from sklearn.model_selection import train_test_split\r\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.2, random_state=0)","52edf4ec":"MLA_compare = pd.DataFrame()\r\n\r\ndef MLA_testing(MLA, X_train, X_test):\r\n    row_index = 0\r\n    for regressor in MLA:\r\n        regressor.fit(X_train, y_train)\r\n\r\n        y_pred = regressor.predict(X_test)\r\n        regressor_r2_score = r2_score(y_test,  y_pred)\r\n\r\n        MLA_name = regressor.__class__.__name__\r\n        MLA_compare.loc[row_index, 'MLA Name'] = MLA_name\r\n        MLA_compare.loc[row_index, 'R^2 Score'] = regressor_r2_score*100\r\n\r\n        print(MLA_name, \"Done\")\r\n        row_index+=1","cb4783e7":"MLA = [\r\n    tree.DecisionTreeRegressor(),\r\n    tree.ExtraTreeRegressor(),\r\n    \r\n    linear_model.LinearRegression(),\r\n    linear_model.SGDRegressor(),\r\n    \r\n    ensemble.RandomForestRegressor(),\r\n    ensemble.AdaBoostRegressor(),\r\n    ensemble.ExtraTreesRegressor(),\r\n    ensemble.GradientBoostingRegressor(),\r\n    \r\n    neighbors.KNeighborsRegressor(),\r\n    \r\n    XGBRegressor(),\r\n    CatBoostRegressor(silent=True)\r\n]\r\n\r\nMLA_testing(MLA=MLA, X_train=X_train, X_test=X_test)","25c337ad":"MLA_compare = MLA_compare.sort_values(by=\"R^2 Score\", ascending=False).reset_index(drop=True)[:5]\r\nMLA_compare","f41919ab":"plt.rcParams[\"figure.figsize\"] = (15, 6)\r\nsns.barplot(x=\"MLA Name\", y=\"R^2 Score\",data=MLA_compare)\r\nplt.show(\"Comparing R^2 scores of Models\")\r\nplt.show()","eb7a6d0b":"regressor = CatBoostRegressor(silent=True)\r\nregressor.fit(X_train, y_train)\r\n\r\ny_pred = regressor.predict(X_test)","6b0ca845":"regressor_r2_score = r2_score(y_test, y_pred)\r\r\n\r\nprint(\"CatBoostRegressor r^2 Score :\", regressor_r2_score)","dec7a49b":"## Training and Testing Multiple Models","0c43e8c7":"# Preparing Data","aa7e6eb4":"#### We Can observe a Positive Linearn Relation above","7c2786f8":"## Encoding Categorican Variable","5b845b58":"## Total Rooms vs Other Corelated Variables","12d2cbb9":"# Analysis and EDA","e89ee5d4":"## Distribution Plot for all Numerical Features","44a4190a":"# Importing Necessary Libraries","18e3cbd1":"# Regression Model","f86ef406":"## Total Bedrooms Distribution","c84cb96f":"#### Luckiely we have only one Categorical Variabale","a15dfc1a":"#### We can say from above plots most of the features have a right skewness in their data","ffc36802":"## Median Income vs Median House Values","939bb4a1":"#### As Population went up with Time the Number of Rooms in houses and the Householding also went up.","0804db88":"# Preprocessing","38f5c658":"## Checking for null values","11cd1f86":"#### We can observe some strong positive relations between total_rooms, total_bedrooms, population and households\r\n#### Also there is strong negative relation between latitude and longitude","9cce9d80":"#### Only total_bedrooms column has null values - 207","e0ad76dc":"## Feature Scaling","eab11d62":"## Heat map to find Corelation between Features","8aa01b01":"# Using Catboost Regressor","109b481a":"#### From Above Distribution we observe that the total_bedrooms data has a lot and I mean a lot of Outliers. So it would be better to fill the null values by the median.","1f5868c8":"## Splitting Data into Training and Testing Set","0f063796":"### Filling Null Values","efcb4bf7":"## Getting top 5 Best Performing Models","d75d9bd4":"## Housing Median Age vs Other Corelated Features"}}