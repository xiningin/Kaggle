{"cell_type":{"94388092":"code","58d913fc":"code","8b48620d":"code","b9cc08c4":"code","5d9f1206":"code","bc8ded4a":"code","c382edde":"code","023426f6":"code","13c00ded":"code","63978e02":"code","4b987cc6":"code","e559c642":"code","97b815ec":"code","9296beb5":"code","3757d9b7":"markdown","e82860c1":"markdown","713d0cad":"markdown","a86322e6":"markdown","f6e944b1":"markdown","35f39e3d":"markdown","5e0bfef0":"markdown","4b562e18":"markdown","f01bf60f":"markdown","bf750199":"markdown","0b2fa172":"markdown","6890dffd":"markdown","5e436ac4":"markdown","36f9e0c5":"markdown","17a53dbe":"markdown"},"source":{"94388092":"import numpy as np\nfrom matplotlib import pyplot as plt\n\nfrom sklearn import linear_model, datasets","58d913fc":"N_SAMPLES = 1000\nN_FEATURES = 1\nN_INFORMATIVE = 1\nNOISE = 10\nN_OUTLIERS = 50\nIS_COEF = True\nRAMDOM_SEED = 0\n\nLINE_WIDTH = 2 \nX_LABEL = \"input\"\nY_LABEL = \"output\"\nLEGEND_LOC = \"lower right\"","8b48620d":"X, y, coef = datasets.make_regression(\n    n_samples=N_SAMPLES,\n    n_features=N_FEATURES,\n    n_informative=N_INFORMATIVE,\n    noise=NOISE,\n    coef=IS_COEF,\n    random_state=RAMDOM_SEED,\n)","b9cc08c4":"X.shape","5d9f1206":"X[:5]","bc8ded4a":"np.random.seed(0)\nX[:N_OUTLIERS] = 3 + 0.5 * np.random.normal(size=(N_OUTLIERS, 1))\ny[:N_OUTLIERS] = -3 + 10 * np.random.normal(size=N_OUTLIERS)","c382edde":"# Fit line using all data\nlr = linear_model.LinearRegression()\nlr.fit(X, y)","023426f6":"# Robustly fit linear model with RANSAC algorithm\nransac = linear_model.RANSACRegressor()\nransac.fit(X, y)","13c00ded":"inlier_mask = ransac.inlier_mask_\noutlier_mask = np.logical_not(inlier_mask)","63978e02":"line_X = np.arange(X.min(), X.max())[:, np.newaxis]","4b987cc6":"line_y = lr.predict(line_X)","e559c642":"line_y_ransac = ransac.predict(line_X)","97b815ec":"print(\"Estimated coefficients (true, linear regression, RANSAC):\")\nprint(\"original coefficient = \",coef)\nprint(\"linear coefficient = \",lr.coef_)\nprint(\"RANSAC coefficient = \",ransac.estimator_.coef_)","9296beb5":"# inlier mask scatter\nplt.scatter(X[inlier_mask], y[inlier_mask], color=\"yellowgreen\", marker=\".\", label=\"Inliers\")\n\n# outler mask scatter\nplt.scatter(X[outlier_mask], y[outlier_mask], color=\"gold\", marker=\".\", label=\"Outliers\")\n\n# linear model plot \nplt.plot(line_X, line_y, color=\"navy\", linewidth=LINE_WIDTH, label=\"Linear regressor\")\n\n# RANSAC model plot\nplt.plot(line_X,line_y_ransac,color=\"cornflowerblue\",linewidth=LINE_WIDTH,label=\"RANSAC regressor\")\n\nplt.legend(loc=LEGEND_LOC)\nplt.xlabel(X_LABEL)\nplt.ylabel(Y_LABEL)\nplt.show()","3757d9b7":"# predict test data using RANSACRegressor model","e82860c1":"# add outlier data ","713d0cad":"# import libraries","a86322e6":"# make RANSACRegressor model","f6e944b1":"# defind global variables","35f39e3d":"# make LinearRegression model","5e0bfef0":"RANSAC is an iterative algorithm for the robust estimation of parameters from a subset of inliers from the complete data set.","4b562e18":"# make test data ","f01bf60f":"# RANSAC: **RAN**dom **S**ampling **A**nd **C**onsensus","bf750199":"# get coefficient (original , linear model, ransac model)","0b2fa172":"# draw scatter + draw plot + set legent and label","6890dffd":"# get inline mask and outline mask ","5e436ac4":"# make data ","36f9e0c5":"#### original coef is almost same with ransac coef.","17a53dbe":"# predict test data using LinearRegression model"}}