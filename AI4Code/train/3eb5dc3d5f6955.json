{"cell_type":{"ec18f2ce":"code","00b88e78":"code","20e7bba9":"code","acc70996":"code","1579d773":"code","a8964c2d":"code","660519c0":"code","5aa75eb4":"code","77bc85ae":"code","db6b4feb":"code","3137bff4":"code","e38d85fe":"code","3057f76e":"code","f900e30a":"code","79330e64":"code","5f6233ab":"markdown","2d9ab566":"markdown","ea5b8b86":"markdown","0ec1eb02":"markdown","01daa5a7":"markdown","8ed4968a":"markdown","e9773db4":"markdown","702a5e42":"markdown","7951468d":"markdown","3a7072e6":"markdown","72f95549":"markdown","8da24be3":"markdown","17e8a9f7":"markdown","f714b42c":"markdown","cda12ef3":"markdown"},"source":{"ec18f2ce":"import pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport plotly as py\nimport plotly.graph_objs as go","00b88e78":"data = pd.read_csv('..\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv')\ndata.head()","20e7bba9":"data.isnull().sum()","acc70996":"sns.barplot(x = data['Age'], y = data['Annual Income (k$)'], ci = None, palette = 'Paired')\nsns.set(rc={'figure.figsize':(30,15)})\nsns.set(font_scale=1.5)","1579d773":"sns.barplot(x = data['Age'], y = data['Spending Score (1-100)'], ci = None,  palette = 'husl')\nsns.set(rc={'figure.figsize':(31,15)})\nsns.set(font_scale=1.5)","a8964c2d":"sns.heatmap(data.corr(), vmin=-1, cmap='PiYG', annot=True)\nsns.set(rc={'figure.figsize':(10,10)})\nsns.set(font_scale=1.5)","660519c0":"X = data.iloc[:, [3,4]].values","5aa75eb4":"from sklearn.cluster import KMeans\nkray=[]\n\nfor i in range(1,11):\n    kmeans = KMeans(n_clusters= i, init='k-means++', random_state=0)\n    kmeans.fit(X)\n    kray.append(kmeans.inertia_)\n","77bc85ae":"plt.plot(range(1,11), kray)\nplt.title('The Elbow Method')\nplt.xlabel('No. of Clusters')\nplt.ylabel('WCSS')\nplt.show()","db6b4feb":"model = KMeans(n_clusters= 5, init='k-means++', random_state=0)\ny_preds = model.fit_predict(X)","3137bff4":"plt.scatter(X[y_preds == 0, 0], X[y_preds == 0, 1], s = 100, c = 'orange', label = 'Neutral')\nplt.scatter(X[y_preds == 1, 0], X[y_preds == 1, 1], s = 100, c = 'purple', label = 'Perks Target')\nplt.scatter(X[y_preds == 2, 0], X[y_preds == 2, 1], s = 100, c = 'green', label = 'Loyal')\nplt.scatter(X[y_preds == 3, 0], X[y_preds == 3, 1], s = 100, c = 'red', label = 'Marketing Target')\nplt.scatter(X[y_preds == 4, 0], X[y_preds == 4, 1], s = 100, c = 'blue', label = 'Conversion Target')\n\nplt.title('Customer\\'s Segmentation')\nplt.xlabel('Annual Income (k$)')\nplt.ylabel('Spending Score (1-100)')\nplt.legend(loc=(1.05,0.85))\nplt.show()","e38d85fe":"X_ThreeD = data[['Age' , 'Annual Income (k$)' ,'Spending Score (1-100)']].iloc[: , :].values\nThreeDray = []\nfor n in range(1 , 11):\n    new_model = (KMeans(n_clusters = n ,init='k-means++', n_init = 10 ,max_iter=300, \n                        tol=0.0001,  random_state = 1  , algorithm='elkan') )\n    new_model.fit(X_ThreeD)\n    ThreeDray.append(new_model.inertia_)","3057f76e":"plt.plot(range(1,11), ThreeDray)\nplt.title('The Elbow Method')\nplt.xlabel('No. of Clusters')\nplt.ylabel('WCSS')\nplt.show()","f900e30a":"new_model = (KMeans(n_clusters = 6 ,init='k-means++', n_init = 10 ,max_iter=300, tol=0.0001,  random_state= 1  , algorithm='elkan') )\nnew_model.fit(X_ThreeD)\nlabels = new_model.labels_","79330e64":"py.offline.init_notebook_mode(connected = True)\ndata['labels'] =  labels\ntrace1 = go.Scatter3d(\n    x = data['Age'],\n    y = data['Spending Score (1-100)'],\n    z = data['Annual Income (k$)'],\n    mode ='markers',\n    marker = dict(color = data['labels'], size = 20, line = dict(color= data['labels'], width= 12), opacity = 0.8)) \n\ndata = [trace1]\nlayout = go.Layout(title= 'Customers\\' Segmentation', scene = dict(xaxis = dict(title  = 'Age'), \n                                                   yaxis = dict(title  = 'Spending Score (1-100)'), \n                                                   zaxis = dict(title  = 'Annual Income (k$)')))\n\nfig = go.Figure(data=data, layout=layout)\npy.offline.iplot(fig)\nplt.show()","5f6233ab":"# Check for column wise null values in the dataset","2d9ab566":"# Barplot for Age vs Spending Score","ea5b8b86":"# Specify the X (features) for clustering","0ec1eb02":"# Import libraries","01daa5a7":"# Import K-Means","8ed4968a":"# For 3D clustering","e9773db4":"# Heatmap to check for coorelation of features","702a5e42":"# The Elbow Method to find adequate number of clusters\n\n","7951468d":"# The Elbow Method to find adequate number of clusters ","3a7072e6":"# Fit the model for 3D clustering","72f95549":"# Plot the clusters","8da24be3":"# Fit the model and predict using X","17e8a9f7":"# Read data","f714b42c":"# Plot the 3D clusters","cda12ef3":"# Barplot for Age vs Annual Income"}}