{"cell_type":{"ceef609c":"code","83211d38":"code","bb3498e6":"code","b738274b":"code","4ac902c1":"code","b8f296f5":"code","669541e4":"code","22053dce":"code","b96d3240":"code","0b7910f1":"code","4d860a64":"code","2d7a4244":"code","0762d314":"code","4b86aaa6":"code","c8dda01e":"code","df260014":"code","1f2da05f":"code","29c667b3":"code","1704128f":"code","59090488":"code","1599431a":"code","3c561dae":"code","06bd2983":"code","6080c386":"code","ddbf674b":"code","30b07e47":"code","6ae13b1b":"markdown","b3af7880":"markdown","726301fc":"markdown","55f03022":"markdown","3a24707f":"markdown","18206d6c":"markdown","9deb2582":"markdown","1ef0293c":"markdown","131c6f90":"markdown","a15188d1":"markdown","65759277":"markdown","87de281c":"markdown","a0ec1717":"markdown","bc6f4e20":"markdown","4ec9336d":"markdown"},"source":{"ceef609c":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)","83211d38":"\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","bb3498e6":"#Reading train file:\ntrain = pd.read_csv('\/kaggle\/input\/tabular-playground-series-may-2021\/train.csv')\n#Reading test file:\ntest = pd.read_csv('\/kaggle\/input\/tabular-playground-series-may-2021\/test.csv')\n#reading sample submission\nsubmission = pd.read_csv('\/kaggle\/input\/tabular-playground-series-may-2021\/sample_submission.csv')\n","b738274b":"train","4ac902c1":"test","b8f296f5":"submission","669541e4":"train.isnull().sum().sum()","22053dce":"test.isnull().sum().sum()","b96d3240":"import matplotlib.pyplot as plt\n\ntrain.groupby('target').target.count().plot.bar(ylim=0)\nplt.show()\n","0b7910f1":"target = pd.get_dummies(train.target)\ntarget.columns=['Class_1', 'Class_2', 'Class_3', 'Class_4']\ntarget","4d860a64":"train.drop('target', axis = 1, inplace = True)\ntrain","2d7a4244":"combi = train.append(test)\ncombi","0762d314":"combi.drop('id', axis = 1, inplace = True)\ncombi","4b86aaa6":"combi = (combi.max() - combi) \/ (combi.max() - combi.min())\ncombi","c8dda01e":"y = target\nX = combi[: len(train)]\nX_test = combi[len(train) :]","df260014":"y","1f2da05f":"X","29c667b3":"X_test","1704128f":"#split train set for testing\nfrom sklearn.model_selection import train_test_split\n\nX_train, X_val, y_train, y_val = train_test_split(X, y, test_size=0.10, random_state=1)\nX_train.shape, y_train.shape, X_val.shape, y_train.shape, X_test.shape","59090488":"from sklearn.multioutput import MultiOutputRegressor\nfrom sklearn import linear_model\n\nmodel = MultiOutputRegressor(linear_model.BayesianRidge(n_iter=10000)).fit(X_train, y_train)\nmodel.score(X_train, y_train)","1599431a":"y_pred = model.predict(X_val)\nmodel.score(X_val, y_val)","3c561dae":"y_pred","06bd2983":"predictions = model.predict(X_test)\npredictions.shape","6080c386":"predictions[predictions < 0] = 0","ddbf674b":"submission.Class_1 = predictions[:, 0]\nsubmission.Class_2 = predictions[:, 1]\nsubmission.Class_3 = predictions[:, 2]\nsubmission.Class_4 = predictions[:, 3]","30b07e47":"submission.to_csv('submission.csv', index=False)\nsubmission = pd.read_csv(\"submission.csv\")\nsubmission\n","6ae13b1b":"Select model","b3af7880":"Read the files","726301fc":"Normalise combi","55f03022":"Drop ID from combi","3a24707f":"Analyse target","18206d6c":"Predict on test set","9deb2582":"Prepare submission","1ef0293c":"Combine train and test","131c6f90":"Define X and y","a15188d1":"This is a synthetic dataset that is based on a real dataset. These datasets are based on Kaggle's May 2021 tabular competition.","65759277":"Drop target from train","87de281c":"One hot encode target","a0ec1717":"Split into training and validation","bc6f4e20":"Predict on validation set","4ec9336d":"Check for null values"}}