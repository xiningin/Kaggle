{"cell_type":{"739fe8cd":"code","618aa6df":"code","b83e25a6":"code","0a094cd3":"code","efffdae6":"markdown"},"source":{"739fe8cd":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt","618aa6df":"train = pd.read_csv(\"..\/input\/conways-reverse-game-of-life-2020\/train.csv\", index_col='id').values\ntrain_delta = train[:,0]\nX = train[:, 1:626].reshape((-1, 25, 25))\ny = train[:, 626:].reshape((-1, 25, 25))\nprint(X.shape)\nprint(y.shape)\nprint(train_delta.shape)","b83e25a6":"def life_step(X):\n    \"\"\"Game of life step using scipy tools\"\"\"\n    X_pad = np.zeros((X.shape[0], X.shape[1]+2, X.shape[2]+2))\n    N = np.zeros((X.shape[0], X.shape[1]+2, X.shape[2]+2))\n    X_pad[:,1:-1,1:-1] += X\n    \n    N[:, 1:, 1:] += X_pad[:,:-1,:-1]\n    N[:, 1:, :] += X_pad[:,:-1,:]\n    N[:, 1:, :-1] += X_pad[:,:-1,1:]\n\n    N[:, :, 1:] += X_pad[:,:,:-1]\n    N[:, :, :-1] += X_pad[:,:,1:]\n\n    N[:, :-1, 1:] += X_pad[:,1:,:-1]\n    N[:, :-1, :] += X_pad[:,1:,:]\n    N[:, :-1, :-1] += X_pad[:,1:,1:]\n    \n    N = N[:,1:-1,1:-1]\n\n    return np.logical_or(N == 3, np.logical_and(X, N==2)).astype(np.uint8)","0a094cd3":"idx = 4\nprint(\"Number of steps for this example: \", train_delta[idx])\n\nprediction = np.expand_dims(X[idx], 0)\nfor i in range(train_delta[idx]):\n    prediction = life_step(prediction)\n    \nprediction = prediction[0]\n\nplt.figure()\n\n#subplot(r,c) provide the no. of rows and columns\nf, axarr = plt.subplots(1,3) \n\n# use the created array to output your multiple images. In this case I have stacked 4 images vertically\naxarr[0].imshow(X[idx])\naxarr[0].set_title('Initial state')\naxarr[1].imshow(y[idx])\naxarr[1].set_title('Final state')\naxarr[2].imshow(prediction)\naxarr[2].set_title('Predicted')\n","efffdae6":"Conclusion: The view is on a 25x25 grid but the simulation runs on a bigger grid"}}