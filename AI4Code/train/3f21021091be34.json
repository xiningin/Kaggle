{"cell_type":{"04bbfce9":"code","bba04c11":"code","483cf8ea":"code","ec7c7ec2":"code","83e5ee6e":"code","2e4190bb":"code","f0746926":"code","0375ba0e":"code","befc1b84":"code","b8aa823f":"code","41fff606":"code","928227a9":"code","96af3358":"code","934cbcef":"code","4bc16a2c":"code","7642ca58":"code","716f768e":"code","c42e9537":"code","f4c4b94e":"markdown","de32b564":"markdown","dc998d2a":"markdown","9bfc9333":"markdown","7db603b1":"markdown","947a77e7":"markdown","b6816880":"markdown"},"source":{"04bbfce9":"import numpy as np\nimport pandas as pd\nimport zipfile\nimport scikitplot\n\nfrom tensorflow import keras\nfrom sklearn.metrics import classification_report","bba04c11":"test = pd.read_csv('..\/input\/challenges-in-representation-learning-facial-expression-recognition-challenge\/test.csv')\nprint(test.shape)","483cf8ea":"test.head()","ec7c7ec2":"test['pixels'] = [np.fromstring(x, dtype=int, sep=' ').reshape(-1,48,48,1) for x in test['pixels']]","83e5ee6e":"pixels = np.concatenate(test['pixels'])\n\nprint(pixels.shape)","2e4190bb":"pixels = pixels \/ 255","f0746926":"cnn = keras.models.load_model('..\/input\/sm-facial-expression-recognition-v02\/fer_model_v02.h5')\ncnn.summary()","0375ba0e":"test_probs = cnn.predict(pixels)\nprint(test_probs.shape)","befc1b84":"print(test_probs[:10,].round(2))","b8aa823f":"test_pred = np.argmax(test_probs, axis=1)\nprint(test_pred[:10])","41fff606":"test_labels = pd.read_csv('..\/input\/challenges-in-representation-learning-facial-expression-recognition-challenge\/icml_face_data.csv')\ntest_labels.columns = ['emotion', 'Usage', 'pixels']\nprint(test_labels.shape)","928227a9":"test_labels = test_labels.loc[test_labels['Usage'].isin(['PublicTest', 'PrivateTest'])]","96af3358":"test_labels.drop(columns='Usage', inplace=True)\ntest_labels.head()","934cbcef":"test_labels.shape","4bc16a2c":"test_labels['predictions'] = test_pred\ntest_labels.head()","7642ca58":"my_classification_report = classification_report(test_labels['emotion'], test_labels['predictions'])\nprint(my_classification_report)","716f768e":"print('Total Wrong Predictions:', np.sum(test_labels['emotion'] != test_labels['predictions']))","c42e9537":"scikitplot.metrics.plot_confusion_matrix(test_labels['emotion'], test_labels['predictions'], figsize=(7,7))    ","f4c4b94e":"## Import Packages","de32b564":"## Evaluation","dc998d2a":"# **Facial Expression Recognion Submission Notebook**\n## **Week 1**\n### Alejandro Alemany, Sara Manrriquez, and Benjamin Zaretzky","9bfc9333":"## Load Test DataFrame","7db603b1":"## Test Predictions","947a77e7":"## Load Model","b6816880":"## Preprocess Data"}}