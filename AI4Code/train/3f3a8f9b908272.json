{"cell_type":{"2d43a3f6":"code","d997c6c8":"code","b12fd337":"code","8b90efa7":"code","71c53d46":"code","3f973e7a":"code","7521a129":"code","f3f4517c":"code","3b498524":"code","64c0ad80":"code","bcf5957e":"code","e1378ba0":"markdown","43574621":"markdown","d92fdd7e":"markdown","e89500ed":"markdown"},"source":{"2d43a3f6":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n\nimport matplotlib.image as mpimg\n\nfrom sklearn.model_selection import train_test_split\n\nimport pickle\n\nimport tensorflow as tf\nfrom tensorflow import keras\nfrom tensorflow.keras.models import Sequential\nfrom tensorflow.keras.layers import *\nfrom tensorflow.keras.preprocessing.image import ImageDataGenerator\n\nimport os","d997c6c8":"test = pd.read_csv('..\/input\/histopathologic-cancer-detection\/sample_submission.csv')\nprint('Test Set Size:', test.shape)\n\n# test = test.iloc[:100,]\n# print('Test Set Size:', test.shape)","b12fd337":"test.head()","8b90efa7":"test['id'] = test['id'].apply(lambda x: f'{x}.tif')\ntest.head()","71c53d46":"BATCH_SIZE = 64\ntest_path = \"..\/input\/histopathologic-cancer-detection\/test\"\nprint('Test Images:', len(os.listdir(test_path)))\n\ntest_datagen = ImageDataGenerator(rescale=1\/255)\n\ntest_loader = test_datagen.flow_from_dataframe(\n    dataframe = test,\n    directory = test_path,\n    x_col = 'id',\n    batch_size = BATCH_SIZE,\n    shuffle = False,\n    class_mode = None,\n    target_size = (96,96)\n)","3f973e7a":"cnn = keras.models.load_model('..\/input\/cancer-models\/cancer_model_v01_version10.h5')\ncnn.summary()","7521a129":"test_probs = cnn.predict(test_loader)\nprint(test_probs.shape)","f3f4517c":"print(test_probs[:10,].round(2))","3b498524":"submission = pd.read_csv('..\/input\/histopathologic-cancer-detection\/sample_submission.csv')\nsubmission.head()","64c0ad80":"submission.label = test_probs[:,1]\nsubmission.head()","bcf5957e":"submission.to_csv('submission.csv', header=True, index=False)","e1378ba0":"# Data Generator","43574621":"# Test Predictions","d92fdd7e":"# Import Statements","e89500ed":"# Update submission"}}