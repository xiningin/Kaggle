{"cell_type":{"9545371e":"code","9f2a4cf5":"code","ebd90f5a":"code","83cf3589":"code","b4dfe8e5":"code","ce8e8d56":"code","ad0a7ab7":"code","fca4311e":"code","9e349b52":"code","f485b32f":"code","14b44fae":"code","ad16e31c":"code","e4e705b8":"code","e5bf2c9c":"code","03251ad9":"code","e675d536":"code","c7429ec5":"code","42153c95":"code","4781c09c":"code","fe163637":"code","ab897535":"code","6c733bd1":"code","cdb11c6d":"code","e29dfc01":"code","f645ab16":"code","c9ffb24f":"code","97907df7":"code","674ee11e":"code","c90c78c9":"code","bc87aefd":"code","055c67d3":"code","c7872fde":"code","01e998ce":"code","261c9eae":"code","fb84c8fc":"code","13488da6":"code","a4443bf7":"code","e178c7fb":"code","a4378c21":"code","2a436ea6":"code","956bcf78":"code","441f74f2":"code","f3bf0b3b":"code","7288e6cd":"code","1815c96a":"code","4cd4a3e3":"code","f1666623":"markdown","f174ea1a":"markdown","7330f5a0":"markdown","544a029d":"markdown","f309a154":"markdown","75994692":"markdown","9cfa1174":"markdown","cb2b2645":"markdown","8a0c9f1b":"markdown","59309342":"markdown","c9e71fc6":"markdown","20bc5ae4":"markdown","6f947bf3":"markdown","3ed82f15":"markdown","45f53e79":"markdown","83c67741":"markdown","30298dbc":"markdown","ec3bd1fe":"markdown","7be42519":"markdown"},"source":{"9545371e":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","9f2a4cf5":"df=pd.read_csv(\"\/kaggle\/input\/vehicle-dataset-from-cardekho\/car data.csv\")","ebd90f5a":"df.head()","83cf3589":"df.shape","b4dfe8e5":"list=[\"Seller_Type\",\"Transmission\",\"Owner\",\"Fuel_Type\"]\nfor i in list:\n    print(df[i].unique())","ce8e8d56":"#we should check missing and null values\ndf.isnull().sum()","ad0a7ab7":"df.describe()","fca4311e":"df.columns","9e349b52":"final_dataset=df[['Year', 'Selling_Price', 'Present_Price', 'Kms_Driven','Fuel_Type', 'Seller_Type', 'Transmission', 'Owner']]\n#With this i drop Car_Name feature\n#You can use drop function. This is a just another way to drop features.","f485b32f":"final_dataset.head()","14b44fae":"final_dataset[\"Current_Year\"]=2021\nfinal_dataset.head()\n","ad16e31c":"final_dataset[\"AgeCar\"]=final_dataset[\"Current_Year\"] - final_dataset[\"Year\"]","e4e705b8":"final_dataset.head()","e5bf2c9c":"final_dataset.drop([\"Year\"],inplace=True,axis=1)\n","03251ad9":"final_dataset.head()","e675d536":"#I used current year feature, and now i will get rid of it.\nfinal_dataset.drop([\"Current_Year\"],inplace=True,axis=1)","c7429ec5":"final_dataset.head()","42153c95":"final_dataset=pd.get_dummies(final_dataset,drop_first=True)\n#The get_dummies() function is used to convert categorical variable into dummy\/indicator variables.","4781c09c":"final_dataset.head()","fe163637":"sns.pairplot(final_dataset)","ab897535":"corr=final_dataset.corr()\ntop_corr_features=corr.index\nplt.figure(figsize=(10,10))\n\ng=sns.heatmap(final_dataset[top_corr_features].corr(),annot=True,cmap=\"RdYlGn\")\n#corr uses pearson correlation","6c733bd1":"#Plot the relationship between two variables in a DataFrame with regplot\nsns.regplot(x=\"Selling_Price\",y=\"Present_Price\",data=final_dataset)","cdb11c6d":"sns.barplot(\"Fuel_Type\",\"Selling_Price\",data=df,palette=\"flare\")\n# i used df instead of final_dataset in order to can use Fuel_type feature","e29dfc01":"sns.boxplot(x=\"Transmission\",y=\"Selling_Price\",data=df)","f645ab16":"sns.violinplot(x=\"Seller_Type\",y=\"Selling_Price\",data=df)","c9ffb24f":"sns.barplot(\"AgeCar\",\"Selling_Price\",data=final_dataset,palette=\"summer\")","97907df7":"x=final_dataset.iloc[:,1:]\ny=final_dataset.iloc[:,0]\n","674ee11e":"x.head()","c90c78c9":"y.head()","bc87aefd":"# Feature Importance\nfrom sklearn.ensemble import ExtraTreesRegressor\nmodel=ExtraTreesRegressor()\nmodel.fit(x,y)","055c67d3":"print(model.feature_importances_)#For Random Forest Regression","c7872fde":"#visualizaiton for feature importance\nf_importances=pd.Series(model.feature_importances_,index=x.columns)#pd.series x kolonlar\u0131n\u0131 veri ile e\u015fle\u015ftiriyor.\nf_importances.nlargest(5).plot(kind='barh')\nplt.show()","01e998ce":"from sklearn.model_selection import train_test_split\nX_train,x_test,y_train,y_test=train_test_split(x,y,test_size=0.2,random_state=42)","261c9eae":"X_train.shape","fb84c8fc":"from sklearn.ensemble import RandomForestRegressor\nrf_random=RandomForestRegressor()","13488da6":"#Randomized Search\n# linspace: Return evenly spaced numbers over a specified interval.\n#The number of trees in the forest.\nn_estimators=[int(x) for x in np.linspace(start=100,stop=1200,num=12)]\n\n#The number of features to consider when looking for the best split.\nmax_features=['auto','sqrt']\n\n#The maximum depth of the tree.\nmax_depth=[int(x) for x in np.linspace(5,30,num=6)]\n\n#The minimum number of samples required to split an internal node.\nmin_samples_split=[2,5,10,15,100]\n\n#The minimum number of samples required to be at a leaf node.\nmin_samples_leaf=[1,2,5,10]\n","a4443bf7":"from sklearn.model_selection import RandomizedSearchCV\n","e178c7fb":"random_grid={\"n_estimators\":n_estimators,\n             \"max_features\":max_features,\n             \"max_depth\":max_depth,\n             \"min_samples_split\":min_samples_split,\n             \"min_samples_leaf\":min_samples_leaf\n             }\nprint(random_grid)","a4378c21":"rf=RandomForestRegressor()","2a436ea6":"rf_random=RandomizedSearchCV(estimator=rf,param_distributions=random_grid,scoring=\"neg_mean_squared_error\",n_iter=10,cv=5,verbose=2,random_state=42,n_jobs=1)","956bcf78":"rf_random.fit(X_train,y_train)","441f74f2":"#outliers dene farkl\u0131 \u015feyler dene","f3bf0b3b":"predictions=rf_random.predict(x_test)\npredictions","7288e6cd":"sns.distplot(y_test-predictions)","1815c96a":"plt.scatter(y_test,predictions)\n            \nplt.xlabel('y_test', fontsize=18)                          \nplt.ylabel('y_prediction', fontsize=16)","4cd4a3e3":"from sklearn.metrics import r2_score\nR2 = r2_score(y_test,predictions)\nR2","f1666623":"## Feature Importance","f174ea1a":"## Visualization","7330f5a0":"### selling price-Seller type","544a029d":"### selling price - fuel type","f309a154":"* The first value belong to Present_price and so on\n* The most important feature is Present_price","75994692":"* There is no missing or null values in dataset","9cfa1174":"### selling price - transmission","cb2b2645":"### selling price - age","8a0c9f1b":"* The year feature shows us what year the cars were built. We will subtract 2021 from the years when cars were built to reach the age of cars. We will change the year feature with new feature which we will calculate","59309342":"## Modelling","c9e71fc6":"* As we can see above; Seller_type, Transmission, Owner, Fuel_Type are categorical variables.","20bc5ae4":"* we will drop one of category of fuel_type to get_dummies function.\n* So, we will have two category, when both of them are zero, it represent the third category.\n* This method just an advice.","6f947bf3":"* if two features high correlated we shoul drop one of them because they do same work.","3ed82f15":"* This methods are good option if we have a lot of feataures.","45f53e79":"* There are 301 sample and 9 features in dataset.\n","83c67741":"* Cars have highest price which have diesel as fuel type. The rates of price of Petrol and Cng almost equal. ","30298dbc":"## Load and Check Data","ec3bd1fe":"### selling price - present price","7be42519":"## Exploratory Data Analysis (EDA)"}}