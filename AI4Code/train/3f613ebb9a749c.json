{"cell_type":{"f765e961":"code","e849123e":"code","d1d00cea":"code","0e68d9a4":"code","0dac7ee4":"markdown"},"source":{"f765e961":"import torch\nfrom shutil import copyfile","e849123e":"# Clone YOLOv5 and install dependencies\n!git clone https:\/\/github.com\/ultralytics\/yolov5\n%cd yolov5\n%pip install -qr requirements.txt\ncopyfile('..\/..\/input\/chest-anatomy-yolov5-train-set\/chest_anatomy_data.yaml', '\/kaggle\/working\/yolov5\/data\/chest_anatomy_data.yaml')\n!wandb off\n\nprint(f\"Setup complete. Using torch {torch.__version__} ({torch.cuda.get_device_properties(0).name if torch.cuda.is_available() else 'CPU'})\")","d1d00cea":"# Train for 10 epochs, you'll lwant to increase this. I used 500 epohcs in my production model.\n!python train.py --img 640 --batch 16 --epochs 10 --data chest_anatomy_data.yaml --weights yolov5s.pt --cache","0e68d9a4":"# Copy weights to working dir. Download this file and use it in your infer notebook.\ncopyfile('runs\/train\/exp\/weights\/best.pt', '\/kaggle\/working\/chest_anatomy.pt')","0dac7ee4":"<div class='alert alert-info' style='text-align: center;'><h1>YOLOv5 Chest X-Ray Anatomy Detection - Train<\/h1>\n<\/div>\n\n![chest2.jpg](attachment:1d768f62-3246-4eb4-a966-c5c84b3f4229.jpg)\n\n- This notebook trains on a custom dataset that I hand annotated from the SIIM-Covid19 challenge dataset. The images are 640px JPGs with CLAHE processing.\n- I used https:\/\/makesense.ai to label 10 classes of anatomical structures on 100 images. (left lung, right lung, left clavicle, right clavicle, left humeral head, right humeral head, trachea, carina, heart and gastric bubble).\n- The dataset is here -> https:\/\/www.kaggle.com\/davidbroberts\/chest-anatomy-yolov5-train-set\n- Images and labels are are split (80\/20) train\/test.\n- I used the weights from this notebook in an inference notebook here -> https:\/\/www.kaggle.com\/davidbroberts\/cxr-anatomy-detection-with-yolov5"}}