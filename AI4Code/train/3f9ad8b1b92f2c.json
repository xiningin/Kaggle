{"cell_type":{"9ea5f0e8":"code","5f5b9745":"code","5cf37476":"code","e6fdf169":"code","b5d9c0f2":"code","3da21361":"code","acb549cd":"code","9893ca0a":"code","0a0d750a":"code","bf1d8785":"code","cf691d24":"code","623fea77":"code","840aa9e6":"code","299192fe":"code","f17c7543":"code","1f0e05f3":"code","2e5fbe87":"code","bd4e7768":"code","33302017":"code","df651976":"code","d2a1b82b":"code","9b400231":"code","8505feb7":"code","a803e086":"code","9b97c31f":"code","1d1f16ec":"code","80eab672":"code","c2bb08be":"code","e3c74990":"code","1404aa2f":"code","538e584e":"code","fd517166":"code","0ebca13a":"code","299f7d0a":"code","b1a82233":"code","dcbffe76":"code","33c0eeab":"code","484a7004":"code","483b7c02":"code","f43519f8":"code","33aca88c":"code","b030dde1":"markdown","2a48574b":"markdown","1a8d95df":"markdown","0d70112e":"markdown","f2c99227":"markdown","4dba02d2":"markdown","ad4052e1":"markdown","da6a063c":"markdown","e21a136f":"markdown","8d67206f":"markdown","b8ee509f":"markdown","b67ccf35":"markdown","134aef67":"markdown","bea74666":"markdown","b690a7ff":"markdown","f4584765":"markdown","6e0b45ca":"markdown","7024f1f1":"markdown","5af43562":"markdown","e0a5e28f":"markdown","8d65fa5f":"markdown","f7c66874":"markdown","bcbe3a81":"markdown","2c156f4f":"markdown","9b6f2c7a":"markdown","8468fdf7":"markdown","f01c138d":"markdown","6a75c56f":"markdown","9618b8b4":"markdown","daf3dcc8":"markdown","fb42e3f5":"markdown","10608984":"markdown","d8af9127":"markdown","3d6e3d18":"markdown","2c7c0b0a":"markdown","87b1154a":"markdown","fccc23de":"markdown","a68941d1":"markdown","e58c75fe":"markdown","68bbad9c":"markdown","ec25a9b4":"markdown","51d743db":"markdown","1cc47fdb":"markdown","7fb8877b":"markdown","0e17cd97":"markdown","7c71811b":"markdown","0c781cbb":"markdown","59d93184":"markdown","96d43192":"markdown"},"source":{"9ea5f0e8":"import pandas as pd\nimport numpy as np\n\nimport plotly.express as px\nimport plotly.graph_objects as go\nimport plotly.figure_factory as ff\nfrom plotly.subplots import make_subplots\n\nimport matplotlib.pyplot as plt\n\nimport seaborn as sns","5f5b9745":"df = pd.read_csv(\"\/kaggle\/input\/netflix-shows\/netflix_titles.csv\")\ndf.head()","5cf37476":"df.shape","e6fdf169":"df.duplicated().any()","b5d9c0f2":"df.info()","3da21361":"df.nunique()","acb549cd":"df.nunique() \/ df.shape[0] * 100","9893ca0a":"df.isnull().sum()","0a0d750a":"sns.heatmap(df.isnull(),cmap = 'inferno')","bf1d8785":"df.isnull().sum() \/ df.shape[0] * 100","cf691d24":"df.drop(['director','cast'], axis=1 ,inplace=True)\ndf.head()","623fea77":"df['country'].fillna('United States', inplace=True)\ndf['country'].isnull().any()","840aa9e6":"df.dropna(subset=['date_added'],axis = 0, inplace = True)\ndf['date_added'].isnull().any()","299192fe":"df['rating'].unique()","f17c7543":"df[df['rating'].isnull()]","1f0e05f3":"rating_replacements = {67: 'TV-PG', 2359: 'TV-14', 3660: 'TV-MA', 3736: 'TV-MA', 3737: 'TV-MA', 3738: 'TV-MA', 4323: 'PG-13'}\nfor index, rating in rating_replacements.items():\n    df.loc[index, 'rating'] = rating\ndf['rating'].isnull().any()","2e5fbe87":"df['date_added'] = pd.to_datetime(df['date_added'])\ndf['year_added'] = df['date_added'].dt.year\ndf['month_added'] = df['date_added'].dt.month\ndf['season_count'] = df.apply(lambda x : x['duration'].split(\" \")[0] if \"Season\" in x['duration'] else \"\", axis = 1)\ndf['duration_in_min'] = df.apply(lambda x : x['duration'].split(\" \")[0] if \"Season\" not in x['duration'] else \"\", axis = 1)\ndf['principal_country'] = df['country'].apply(lambda x: x.split(\",\")[0])","bd4e7768":"ratings_ages = {\n    'TV-PG': 'Older Kids',\n    'TV-MA': 'Adults',\n    'TV-Y7-FV': 'Older Kids',\n    'TV-Y7': 'Older Kids',\n    'TV-14': 'Teens',\n    'R': 'Adults',\n    'TV-Y': 'Kids',\n    'NR': 'Adults',\n    'PG-13': 'Teens',\n    'TV-G': 'Kids',\n    'PG': 'Older Kids',\n    'G': 'Kids',\n    'UR': 'Adults',\n    'NC-17': 'Adults'\n}\ndf['target_ages'] = df['rating'].replace(ratings_ages)\ndf.head()","33302017":"pie_x = df['type'].value_counts().reset_index()\npie_x = pie_x.rename(columns={'index':'type','type':'count'})\n\ntrace = go.Pie(labels=pie_x['type'], values=pie_x['count'], pull=[0.05])\nlayout = go.Layout(title=\"\", height=450, legend=dict(x=0.1, y=1))\nfig = go.Figure(data = [trace], layout = layout)\nfig.update_traces(textposition='inside', textinfo='percent+label')\nfig.show()","df651976":"tv_show = df[df[\"type\"] == \"TV Show\"]\nmovie = df[df[\"type\"] == \"Movie\"]\n\n\ntv_show_count = tv_show['year_added'].value_counts().reset_index()\ntv_show_count = tv_show_count.rename(columns={'index': 'year_added', 'year_added': 'count'})\ntv_show_count = tv_show_count.sort_values('year_added')\n\nmovie_count = movie['year_added'].value_counts().reset_index()\nmovie_count = movie_count.rename(columns= {'index': 'year_added', 'year_added': 'count'})\nmovie_count = movie_count.sort_values('year_added')\n\ntrace1 = go.Scatter(x=tv_show_count['year_added'], y=tv_show_count['count'], name=\"TV Shows\")\ntrace2 = go.Scatter(x=movie_count['year_added'], y=movie_count[\"count\"], name=\"Movies\")\ndata = [trace1, trace2]\nlayout = go.Layout(title=\"Content added over the years\",xaxis_title='Year',yaxis_title='count', legend=dict(x=0.1, y=1.1, orientation=\"h\"))\nfig = go.Figure(data, layout=layout)\nfig.show()","d2a1b82b":"\nmonth_order = [1,2,3,4,5,6,7,8,9,10,11,12][::-1]\nmonth_HM = df.groupby('year_added')['month_added'].value_counts().unstack().fillna(0)[month_order].T\nplt.figure(figsize=(10, 5), dpi=300)\nplt.pcolor(month_HM, cmap='afmhot_r', edgecolors='white', linewidths=2) # heatmap\nplt.xticks(np.arange(0.5, len(month_HM.columns), 1), month_HM.columns, fontsize=7, fontfamily='serif')\nplt.yticks(np.arange(0.5, len(month_HM.index), 1), month_HM.index, fontsize=7, fontfamily='serif')\nplt.title('Netflix Monthly Contents Update', fontsize=12, fontweight='bold', position=(0.40, 1.0+0.02))\ncbar = plt.colorbar()\n\ncbar.ax.tick_params(labelsize=8) \ncbar.ax.minorticks_on()\nplt.show()\n","9b400231":"def generate_rating_df(df):\n    rating_df = df.groupby(['rating', 'target_ages']).agg({'show_id': 'count'}).reset_index()\n    rating_df = rating_df[rating_df['show_id'] != 0]\n    rating_df.columns = ['rating', 'target_ages', 'counts']\n    rating_df = rating_df.sort_values('target_ages')\n    return rating_df","8505feb7":"movie_rating_df = generate_rating_df(df[df['type'] == 'Movie'])\nshow_rating_df = generate_rating_df(df[df['type'] == 'TV Show'])\n\nfig = make_subplots(rows=1, cols=2, specs=[[{\"type\": \"pie\"}, {\"type\": \"pie\"}]])\n\nfig.add_trace(\n    go.Pie(labels=movie_rating_df['target_ages'], values=movie_rating_df['counts']),\n    row=1, col=1\n)\n\nfig.add_trace(\n    go.Pie(labels=show_rating_df['target_ages'], values=show_rating_df['counts']),\n    row=1, col=2\n)\n\nfig.update_traces(textposition='inside', hole=.4, hoverinfo=\"label+percent+name\")\nfig.update_layout(\n    title_text=\"Ages based rating distribution by type of content\",\n    # Add annotations in the center of the donut pies.\n    annotations=[dict(text='Movies', x=0.20, y=0.5, font_size=12, showarrow=False),\n                 dict(text='TV Shows', x=0.82, y=0.5, font_size=12, showarrow=False)])\nfig.show()","a803e086":"rating_order =  ['G', 'TV-Y', 'TV-G', 'PG', 'TV-Y7', 'TV-Y7-FV', 'TV-PG', 'PG-13', 'TV-14', 'R', 'NC-17', 'TV-MA']\nm1 = {'rating': 'G', 'count': 0}\nm2 = {'rating': 'NC-17', 'count': 0}\nm3 = {'rating': 'PG', 'count': 0}\nm4 = {'rating': 'PG-13', 'count': 0}\nmovie = df[df['type'] == 'Movie']\ntv_show = df[df['type'] == 'TV Show']\nmovie_rating = movie['rating'].value_counts()[rating_order]\ntv_rating = tv_show['rating'].value_counts().reset_index()\ntv_rating = tv_rating.rename(columns={'index': 'rating','rating': 'count'})\ntv_rating = tv_rating.append(m1,ignore_index=True)\ntv_rating = tv_rating.append(m2,ignore_index=True)\ntv_rating = tv_rating.append(m3,ignore_index=True)\ntv_rating = tv_rating.append(m4,ignore_index=True)\n\ntv_rating = tv_rating.set_index('rating')\ntv_rating = tv_rating.T\ntv_rating = tv_rating[rating_order]\ntv_rating = tv_rating.iloc[0]\n","9b97c31f":"def rating_barplot(data, title, height, h_lim=None):\n    fig, ax = plt.subplots(1,1, figsize=(20, 10))\n    if h_lim :\n        ax.set_ylim(0, h_lim)\n    ax.bar(data.index, data,  color=\"#d0d0d0\", width=0.6, edgecolor='black')\n\n    color =  ['green',  'blue',  'orange',  'red']\n    span_range = [[0, 2], [3,  6], [7, 8], [9, 11]]\n\n    for idx, sub_title in enumerate(['Little Kids', 'Older Kids', 'Teens', 'Mature']):\n        ax.annotate(sub_title,\n                    xy=(sum(span_range[idx])\/2 ,height),\n                    xytext=(0,0), textcoords='offset points',\n                    va=\"center\", ha=\"center\",\n                    color=\"w\", fontsize=16, fontweight='bold',\n                    bbox=dict(boxstyle='round4', pad=0.4, color=color[idx], alpha=0.6))\n        ax.axvspan(span_range[idx][0]-0.4,span_range[idx][1]+0.4,  color=color[idx], alpha=0.1)\n\n    ax.set_title(f'Distribution of {title} Rating', fontsize=20, fontweight='bold', position=(0.5, 1.0+0.03))\n    plt.show()","1d1f16ec":"rating_barplot(movie_rating,'Movie', 1500)","80eab672":"rating_barplot(tv_rating,'TV Show' , 700)","c2bb08be":"country_df = df['principal_country'].value_counts().reset_index()\ncountry_df = country_df[country_df['principal_country'] \/  country_df['principal_country'].sum() > 0.01]\ncountry_df = country_df.rename(columns={'index': 'country', 'principal_country': 'count'})\ncountry_df = country_df.sort_values('count')","e3c74990":"trace1 = go.Bar(y=country_df['country'], x=country_df['count'], orientation=\"h\", name=\"\")\n\ndata = [trace1]\nlayout = go.Layout(title=\"Countries with most content\",xaxis_title='count', height=700, legend=dict(x=0.1, y=1.1, orientation=\"h\"))\nfig = go.Figure(data, layout=layout)\nfig.show()","1404aa2f":"country_df2 = df.groupby(['year_added','principal_country']).agg({'show_id': 'count'}).reset_index()\ncountry_df2['aggregate'] = country_df2.groupby(['principal_country'])['show_id'].cumsum()\n\n","538e584e":"\n# year_country2 = data2.groupby('year_added')['country'].value_counts().reset_index(name='counts')\n\nfig = px.choropleth(country_df2, locations=\"principal_country\", color=\"aggregate\", \n                    locationmode='country names',\n                    animation_frame='year_added',\n                    range_color=[0,200],\n                    color_continuous_scale=px.colors.sequential.OrRd\n                   )\n\nfig.update_layout(title='Cumulative sum of content over the year by country')\nfig.show()","fd517166":"df.dtypes","0ebca13a":"\nx1 = movie['duration_in_min'].fillna(0.0).astype(float)\nfig = ff.create_distplot([x1], [''], bin_size=0.7, curve_type='normal')\nfig.update_layout(title_text='Distplot with Normal Distribution',xaxis_title = 'duration in min', yaxis_title='PDF')\nfig.show()","299f7d0a":"bar_season = tv_show['season_count'].value_counts().reset_index()\nbar_season = bar_season.rename(columns = {'season_count' : \"count\", \"index\" : 'season_count'})\nbar_season['season_count'] = pd.to_numeric(bar_season['season_count'])\nbar_season = bar_season.sort_values('season_count')\n\ntrace1 = go.Bar(x=bar_season['season_count'], y=bar_season[\"count\"], name=\"TV Shows\")\ndata = [trace1]\nlayout = go.Layout(title=\"Seasons for TV Show\",yaxis_title = 'count',xaxis_title='Number of Seasons', legend=dict(x=0.1, y=1.1, orientation=\"h\"))\nfig = go.Figure(data, layout=layout)\nfig.show()","b1a82233":"from collections import Counter\ncol = \"listed_in\"\ncategories = \", \".join(movie['listed_in']).split(\", \")\ncounter_list = Counter(categories).most_common(50)\nlabels = [_[0] for _ in counter_list][::-1]\nvalues = [_[1] for _ in counter_list][::-1]\ntrace1 = go.Bar(y=labels, x=values, orientation=\"h\", name=\"TV Shows\")\n\ndata = [trace1]\nlayout = go.Layout(title=\"Genre distributions of movies\",xaxis_title='count', legend=dict(x=0.1, y=1.1, orientation=\"h\"))\nfig = go.Figure(data, layout=layout)\nfig.show()","dcbffe76":"col = \"listed_in\"\ncategories = \", \".join(tv_show['listed_in']).split(\", \")\ncounter_list = Counter(categories).most_common(50)\nlabels = [_[0] for _ in counter_list][::-1]\nvalues = [_[1] for _ in counter_list][::-1]\ntrace1 = go.Bar(y=labels, x=values, orientation=\"h\", name=\"TV Shows\")\n\ndata = [trace1]\nlayout = go.Layout(title=\"Genre distributions of TV Show\",xaxis_title='count', legend=dict(x=0.1, y=1.1, orientation=\"h\"))\nfig = go.Figure(data, layout=layout)\nfig.show()","33c0eeab":"from wordcloud import WordCloud\ncategories = \", \".join(movie['listed_in']).split(\", \")\ntext = str(categories).replace(',','').replace('[','').replace(\"''\",'').replace(']','')\n\nplt.rcParams['figure.figsize'] = (15, 15)\nwordcloud = WordCloud(background_color = 'white', width = 1200,  height = 1200, max_words = 121).generate(text)\nplt.imshow(wordcloud)\nplt.axis('off')\nplt.show()","484a7004":"movie_asc = movie.sort_values(\"release_year\", ascending = True)\n\nmovie_asc[['title', \"release_year\"]][:20]","483b7c02":"tv_asc = tv_show.sort_values(\"release_year\", ascending = True)\n\ntv_asc[['title', \"release_year\"]][:20]","f43519f8":"movie['genre'] = movie['listed_in'].apply(lambda x :  x.replace(' ,',',').replace(', ',',').split(','))\nmovie['principal_genre'] = movie['genre'].apply(lambda genres: genres[0])\ntop_movies_genres = [\n    'International Movies',\n    'Dramas',\n    'Comedies'\n]","33aca88c":"year_genre_df = movie[(movie['principal_genre'].isin(top_movies_genres)) & (movie['year_added'] >= 2017)].groupby(['principal_genre', 'year_added']).agg({'title': 'count'})\nyear_genre_df = year_genre_df.reset_index()\nyear_genre_df.columns = ['principal_genre', 'year_added', 'count']\n\nfig = px.sunburst(year_genre_df, path=['year_added', 'principal_genre'], values='count')\nfig.show()","b030dde1":"## Netflix has been booming lately and it has become one of the biggest online movies and tv shows streaming platform. This dataset provides crucial insights of the contents provided by Netflix. Let's start exploring and learning together!","2a48574b":"__1.Deleting 'director' and 'cast' column__","1a8d95df":"#### 13. What is the favourite genre for movie from year 2017 onwards?","0d70112e":"## Get to know the datas","f2c99227":"__6.Checking for missing \/ null value for each column. Director, cast, country, date_added, rating have missing values__","4dba02d2":"__2.Check if there is any duplicated records__","ad4052e1":"#### 2. Is the rate of addition of movie greater than tv shows or vice versa?","da6a063c":"![thibault-penin-AWOl7qqsffM-unsplash-scaled.jpg.webp](attachment:thibault-penin-AWOl7qqsffM-unsplash-scaled.jpg.webp)","e21a136f":"- Adding a new column 'target_ages' based on the content 'rating'.","8d67206f":"- TV-MA is the most popular rating for Mature movie, and for teens movie, TV-14 has about 3 times more than PG-13 movie.\n","b8ee509f":"__5.Percentage of unique data for each column__","b67ccf35":"__8.Check the percentage of missing values for each column.__\n- director: This column can be deleted since it has about 30% missing values and about 52% of unique data, hence it does not provide much information for our analysis. However, it will be important for recommender system \n- cast: This column can be deleted too since it has about 9% missing values and about 88% of unique data, hence is also does not provide significant information for analysis. However, it will be important for recommender system \n- country: We replace the missing values with 'United States' since Netflix is originated from United States and most of the movies and TV shows are aired in there. Statistically, looking at the mode of the country column also confirm that 'United States' can be a great replacement for the missing values. \n- date_added:  Since the missing number is small, we can either delete of the missing rows or we can use a little effort to scrape the data from the Internet. \n- rating: Since the missing number is small, we can either delete of the missing rows or we can use a little effort to scrape the data from the Internet. \n\n","134aef67":"- Most of the TV show consist of 1 season only.","bea74666":"- Movies has about 5.7% more adult content than TV shows.\n- TV shows has 30% of content for kids+older kids while movie has only 20%.\n- Based on the findings, we can assume that kids prefer TV shows.","b690a7ff":"#### 5. What does the distribution of rating for TV show and movies look like?","f4584765":"#### 8. What is the range of movie duration for most of movies?","6e0b45ca":"#### 3. Which month contributes most to content update?","7024f1f1":"- For TV show, TV-MA also dominates the Mature content.","5af43562":"- We can add new features from the date_added column which are month and year. Also, we can split the duration column into 'season_count' and 'duration'. 'principal_country' is a column containing the first country listed on 'country' column because some of the content are released by multiple countries.","e0a5e28f":"__3.Look at some basic information of the dataset, and we can see 11 of the datatype are object and 1 is integer.__","8d65fa5f":"## Data Preprocessing and Handling Missing Data","f7c66874":"#### 1. What is the composition of Netflix content?","bcbe3a81":"__Before we start our exploratory data analysis, we should ask some question we are interested in and use the power of visualization to help us understand and answer our question.__\n__Some interesting questions:__\n1. Does Netflix contains more TV shows or movies?\n2. Which country produce the most content?\n3. Is the rate of content addition increasing over the year?\n4. Which are the most favoured genre?\n5. Does kids prefer TV show or movies?","2c156f4f":"## Thank you for reading my first ever notebook!! Your feedback and upvote is very much appreciated. \n\n### Here are some notebooks I have referenced for this project(shoutout to the authors), do check them out!\n - https:\/\/www.kaggle.com\/subinium\/storytelling-with-data-netflix-ver\/data\n - https:\/\/www.kaggle.com\/shivamb\/netflix-shows-and-movies-exploratory-analysis\/notebook\n - https:\/\/www.kaggle.com\/niharika41298\/netflix-visualizations-recommendation-eda#Recommendation-System-(Content-Based)\n - https:\/\/www.kaggle.com\/andreshg\/eda-beginner-to-expert-plotly\/data","9b6f2c7a":"   __5. Replacing the missing 'rating' values which are found from IMDb and Netflix.__","8468fdf7":"#### 7. What does the content cumulation over the year look like on a world map?","f01c138d":"__1. Checking the size of the dataset__","6a75c56f":"- The top 3 favourite genre of movies are:\n    1. International movies\n    2. Dramas\n    3. Comedies\n ","9618b8b4":"- This heatmap shows that there are more contents being added during the last few months compare to other months.\n- This heatmap might not be the best visualization tool to illustrate the question above but I want to learn to plot more different graphs. A bar chart might better visualize the differences. ","daf3dcc8":"__4.Number of unique data for each column__","fb42e3f5":"#### 6. Which country produces the most content?","10608984":"- The duration for movies are distributed normally where the peak are in the range between 90 and 100 minutes.","d8af9127":"- The top 3 favourite TV shows genre are:\n    1. International TV Shows\n    2. TV Dramas\n    3. TV Comedies","3d6e3d18":"- Again, this might not be the best visualization for the question, but I take this as a lesson to learn more visualization tools.","2c7c0b0a":"- We can see that the North America, India and Europe dominates the content cumulation over the year.","87b1154a":"#### 10. What are the favourite genre of movies and TV shows respectively?","fccc23de":"## Data Visualization(Exploratory Data Analysis)","a68941d1":"#### 12. What are the 20 oldest movies and TV shows on Netflix?","e58c75fe":"__3.Since the 'date_added' data for the missing values are not readily avaialble on the Internet, I choose to drop the missing rows.__","68bbad9c":"__2.Filling the missing 'country' value with 'United States'__","ec25a9b4":"__4.Checking the missing 'rating' movie title and search their 'rating' on Internet__","51d743db":"#### 9. Does TV show usually have more than one season?","1cc47fdb":"- Initially, the rate of addition of TV shows and movies seems to be at the same pace. \n- From 2016 to 2018, a total of 2377 movies have been added while only 976 TV shows have been added\n- In 2020, there is a slight increase in the rate of addition of TV shows and a slight reduction in rate of addition of movies which may be a factor of the COVID-19 pandemic.","7fb8877b":"__7.A heatmap showing the missing values__","0e17cd97":"- United States, India and United Kingdom is the top 3 countries with the most content.\n- As an aspired producer or actor\/actress, you might consider this 3 countries for your career.","7c71811b":"__6. Adding new features__","0c781cbb":"#### 4. Do kids prefer TV shows or movies?","59d93184":"- The movies accounts for 69.1% of the content, which is the majority.","96d43192":"#### 11. What are the usual keywords in the movie genre?"}}