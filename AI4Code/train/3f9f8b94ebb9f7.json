{"cell_type":{"16b73931":"code","f1a96119":"code","fd2a4731":"code","44a7b6a8":"code","7b62b1a2":"code","8d77a49f":"code","5dc1783e":"code","0241478e":"code","16c57a17":"code","4ee138ca":"code","3de53e81":"code","8a536ab8":"code","d7cbfec0":"code","878883c8":"code","c26e8ca0":"code","12c47209":"code","aff77042":"code","fc5f707f":"code","479cbb2f":"code","78ad8d54":"code","71cbfe48":"code","776cae23":"code","432cf570":"code","961bda1f":"markdown","f388c319":"markdown"},"source":{"16b73931":"#load libraries\n!pip install lightgbm\n!pip install xgboost\nimport lightgbm\nimport matplotlib.pyplot as plt\nfrom sklearn.model_selection import train_test_split\nfrom lightgbm import LGBMRegressor\nfrom sklearn.metrics import mean_squared_error\nfrom xgboost import XGBRegressor\nfrom sklearn.ensemble import GradientBoostingRegressor, AdaBoostRegressor, RandomForestRegressor , BaggingRegressor\nfrom catboost import CatBoostRegressor\nimport seaborn as sns\n\nimport warnings\nwarnings.filterwarnings(\"ignore\")\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","f1a96119":"#load  datasets\nitems_df=pd.read_csv('\/kaggle\/input\/competitive-data-science-predict-future-sales\/items.csv')\nsamples_df=pd.read_csv('\/kaggle\/input\/competitive-data-science-predict-future-sales\/sample_submission.csv')\nitemsCat_df=pd.read_csv('\/kaggle\/input\/competitive-data-science-predict-future-sales\/item_categories.csv')\nsales_df=pd.read_csv('\/kaggle\/input\/competitive-data-science-predict-future-sales\/sales_train.csv')\nshopes_df=pd.read_csv('\/kaggle\/input\/competitive-data-science-predict-future-sales\/shops.csv')\ntest_df=pd.read_csv('\/kaggle\/input\/competitive-data-science-predict-future-sales\/test.csv')","fd2a4731":"#display info foreach dataset\nprint('---------items----------')\nitems_df.info()\nprint('--------samples---------')\nsamples_df.info()\nprint('--------items Category---------')\nitemsCat_df.info()\nprint('--------Sales---------')\nsales_df.info()\nprint('--------Shopes---------')\nshopes_df.info()\nprint('--------Test---------')\ntest_df.info()","44a7b6a8":"sales_df[\"month\"]=pd.DatetimeIndex(pd.to_datetime(sales_df['date'],format='%d.%m.%Y')).month\nsales_df[\"year\"]=pd.DatetimeIndex(pd.to_datetime(sales_df['date'],format='%d.%m.%Y')).year\nsales_df[\"day\"]=pd.DatetimeIndex(pd.to_datetime(sales_df['date'],format='%d.%m.%Y')).day\nsales_df.head(10)","7b62b1a2":"print(\"unique item\",len(sales_df.item_id.unique()))\nprint(\"unique shop\",len(sales_df.shop_id.unique()))","8d77a49f":"#total sales in 2013\ndf = sales_df[sales_df[\"year\"]==2013][[\"month\",\"item_cnt_day\"]].groupby([\"month\"]).sum().reset_index()\nplt.plot(df[\"month\"],df[\"item_cnt_day\"])","5dc1783e":"#total sales in 2014\ndf = sales_df[sales_df[\"year\"]==2014][[\"month\",\"item_cnt_day\"]].groupby([\"month\"]).sum().reset_index()\nplt.plot(df[\"month\"],df[\"item_cnt_day\"])","0241478e":"#total sales in 2015\ndf = sales_df[sales_df[\"year\"]==2015][[\"month\",\"item_cnt_day\"]].groupby([\"month\"]).sum().reset_index()\nplt.plot(df[\"month\"],df[\"item_cnt_day\"])","16c57a17":"#sales_df[\"category\"]=sales_df[\"item_id\"].apply(lambda x: items_df[items_df[\"item_id\"]==x][\"item_category_id\"].values[0])","4ee138ca":"train_df = sales_df[[\"item_id\",\"shop_id\",\"month\",\"year\",\"date_block_num\",\"item_cnt_day\"]].groupby([\"item_id\",\"shop_id\",\"month\",\"year\",\"date_block_num\"]).sum().reset_index()\ntrain_df.rename(columns={'item_cnt_day':'item_cnt_month'},inplace=True)\ntrain_df.head(5)","3de53e81":"train_df.boxplot(column=[\"item_cnt_month\"])","8a536ab8":"train_df[\"item_cnt_month\"] = train_df[\"item_cnt_month\"].clip(0,1200)\ntrain_df.boxplot(column=[\"item_cnt_month\"])","d7cbfec0":"#test_df[\"category\"]=test_df[\"item_id\"].apply(lambda x: items_df[items_df[\"item_id\"]==x][\"item_category_id\"].values[0])\ntest_df[\"year\"] = 2015\ntest_df[\"month\"]=11\ntest_df[\"date_block_num\"]=34\ntest_df.head(5)","878883c8":"#split data\nfeatures = [\"item_id\",\"shop_id\",\"month\",\"year\",\"date_block_num\"]\ntrain_X, val_X, train_y, val_y = train_test_split(train_df[features],train_df[\"item_cnt_month\"],test_size=0.1, random_state=0)","c26e8ca0":"#1 - random forest\nforest = RandomForestRegressor(n_estimators=50,random_state=0).fit(train_X,train_y)\nforest.score(val_X,val_y)","12c47209":"y_predicted = forest.predict(val_X)\nmean_squared_error(val_y, y_predicted, squared=False)","aff77042":"#2 - Light gradient boosting\nlgb = LGBMRegressor().fit(train_X,train_y,eval_set=[(train_X,train_y), (val_X,val_y)],eval_metric='rmse', verbose=True)\nlgb.score(val_X,val_y)","fc5f707f":"y_predicted = lgb.predict(val_X)\nmean_squared_error(val_y, y_predicted, squared=False)","479cbb2f":"#3 - XGradient boosting\nxgb = XGBRegressor().fit(train_X,train_y,eval_set=[(train_X,train_y), (val_X,val_y)],eval_metric='rmse', verbose=True)\nxgb.score(val_X,val_y)","78ad8d54":"y_predicted = xgb.predict(val_X)\nmean_squared_error(val_y, y_predicted, squared=False)","71cbfe48":"#4 - gradient boosting\ngb = GradientBoostingRegressor(random_state=0).fit(train_X,train_y)\ngb.score(val_X,val_y)","776cae23":"y_predicted = gb.predict(val_X)\nmean_squared_error(val_y, y_predicted, squared=False)","432cf570":"xgb = XGBRegressor().fit(train_df[features],train_df[\"item_cnt_month\"],eval_set=[(train_df[features],train_df[\"item_cnt_month\"]), (val_X,val_y)],eval_metric='rmse', verbose=True)\npred = xgb.predict(test_df[features])\nsubmission = pd.DataFrame({\"ID\": test_df[\"ID\"],\"item_cnt_month\" : pred.round()})\nsubmission.to_csv(\"submission.csv\",index=False)","961bda1f":"**Apply different machine learning modeling**","f388c319":"**Analysis**"}}