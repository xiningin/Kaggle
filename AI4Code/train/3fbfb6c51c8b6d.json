{"cell_type":{"082d4ee9":"code","c2779b74":"code","5e7186bb":"code","db655380":"code","51c05a50":"code","ef35bda1":"code","5d955b83":"code","ffba8e68":"code","841e56ea":"code","dbc27220":"code","b18f8679":"code","755178e4":"code","08d6d692":"code","d5af6f05":"code","7b2a5bef":"code","048aee90":"code","6327b862":"code","c6d7653d":"code","ca57cc42":"code","66508395":"code","b9c7d051":"code","e56bb894":"code","0dba3374":"code","c1ec79c6":"code","7d7cbbef":"code","cad813c6":"code","a5a0e176":"code","494aac45":"code","11449ab3":"code","77068470":"code","f44f53b9":"code","73b73a29":"code","0419a7ac":"code","d574db0b":"code","4434c8bd":"code","f503831c":"code","deb9b86c":"code","2d056207":"code","c5f148b6":"code","857b77da":"code","9658ab6d":"code","c0914cf2":"code","c61f8db1":"code","efff3555":"code","8e5e15e9":"code","810d000f":"code","cdd3296e":"code","a73577e4":"code","203e568a":"code","0c0d8c3e":"code","ff52b830":"code","1856a540":"code","e8412d08":"code","526b1ca2":"code","badc804b":"code","ee8edd0b":"code","32a52a78":"code","76554f01":"markdown","b4b2fe9a":"markdown","60834815":"markdown","0200b888":"markdown","5e78e0fc":"markdown","64ac4ca0":"markdown","19486209":"markdown","322dfd62":"markdown","2b1937bf":"markdown","892d2f8e":"markdown","633643d3":"markdown","90119392":"markdown","e4ee56bd":"markdown","504bf762":"markdown","e8dd7eac":"markdown","e64bdf18":"markdown","0ece2b4c":"markdown","0db8848b":"markdown","c77b77a4":"markdown","ee94802e":"markdown","663efd83":"markdown","cdc268d6":"markdown","0ecaac73":"markdown","52690f22":"markdown","3819665a":"markdown","6e4d7246":"markdown","3b9ab05d":"markdown","f9ffcde3":"markdown","7539609e":"markdown","ae208df3":"markdown","e6e44bc3":"markdown","213c312e":"markdown","a49c3389":"markdown","9c0e8831":"markdown","571ccd32":"markdown","2606d439":"markdown","34b796e8":"markdown","a22d4bbe":"markdown"},"source":{"082d4ee9":"# Importing the libraries\n\nimport warnings\nwarnings.filterwarnings('ignore')\n\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport plotly.express as px\nimport plotly\nimport plotly.figure_factory as ff\nimport plotly.graph_objects as go\nfrom plotly.offline import iplot","c2779b74":"data = pd.read_csv('\/kaggle\/input\/heart-disease-uci\/heart.csv')","5e7186bb":"print(\"Number of rows in data :\", data.shape[0])\nprint(\"Number of columns in data :\", data.shape[1])","db655380":"data.head()","51c05a50":"data.info()","ef35bda1":"# Statistical properties of data\ndata.describe().round(3)","5d955b83":"# Columns names\n\ndata.columns","ffba8e68":"data.columns = ['age', 'sex', 'chest_pain_type', 'resting_blood_pressure', 'serum_cholesterol', 'fasting_blood_sugar', 'rest_ecg', 'max_heart_rate',\n       'exercise_angina', 'st_depression', 'st_slope', 'num_major_vessels', 'thalassemia', 'target']","841e56ea":"data.head()","dbc27220":"new_data = data.copy() # for future use","b18f8679":"# Let's see which columns has less or equal to 5 classes\n\nfor column in data.columns:\n    if len(data[column].unique())<=5:\n        print(f\"{column} has {len(data[column].unique())} classes.\")","755178e4":"# Let's map these class values to something meaning full information given in dataset description\n# Note: As rest_ecg  and num_major_vessels doesn't have any description so I left that column\n\ndata.sex = data.sex.map({0:'female', 1:'male'})\n\ndata.chest_pain_type = data.chest_pain_type.map({1:'angina pectoris', 2:'atypical angina', 3:'non-anginal pain', 4:'SMI', 0:'absent'})\n\ndata.fasting_blood_sugar = data.fasting_blood_sugar.map({0:'lower than 120mg\/ml', 1:'greater than 120mg\/ml'})\n\ndata.exercise_angina = data.exercise_angina.map({0:'no', 1:'yes'})\n\ndata.st_slope = data.st_slope.map({1:'upsloping', 2:'horizontal', 3:'downsloping', 0:'absent'})\n\ndata.thalassemia = data.thalassemia.map({1:'normal', 2:'fixed defect', 3:'reversable defect', 0:'absent'})\n\ndata.target = data.target.map({0:'No Heart Disease', 1:'Heart Disease'})","08d6d692":"data.head()","d5af6f05":"# Drawing a correlation Plot\n\nfig=plt.figure(figsize=(12,8))\nsns.heatmap(new_data.corr(), annot= True, cmap='Blues')","7b2a5bef":"print(f\"Minimum Age : {min(data.age)} years\")\nprint(f\"Maximum Age : {max(data.age)} years\")","048aee90":"sex_counts = data['sex'].value_counts().tolist()\n\nprint(f\"Number of Male patients: {sex_counts[0]}\")\nprint(f\"Number of Female patients: {sex_counts[1]}\")","6327b862":"# Count of male and female patients\n\nsns.countplot('sex', hue=\"sex\", data=data, palette=\"bwr\")","c6d7653d":"# Let's look at the distribution of age\n\nhist_data = [data['age']]\ngroup_labels = ['age'] \n\ncolors = ['#835AF1']\n\n# Create distplot with curve_type set to 'normal'\nfig = ff.create_distplot(hist_data, group_labels=group_labels, colors=colors,\n                         bin_size=10, show_rug=False)\n\n# Add title\nfig.update_layout(width=700, title_text='Age Distribution')\nfig.show()","ca57cc42":"young_patients = data[(data['age']>=29)&(data['age']<40)]\nmiddle_aged_patients = data[(data['age']>40)&(data['age']<55)]\nold_aged_patients = data[(data['age']>55)]\n\nprint(f\"Number of Young Patients : {len(young_patients)}\")\nprint(f\"Number of Middle Aged Patients: {len(middle_aged_patients)}\")\nprint(f\"Number of Old Aged Patients : {len(old_aged_patients)}\")","66508395":"# Plotting a pie chart for age ranges of patients\n\nlabels = ['Young Age','Middle Aged','Old Aged']\nvalues = [\n      len(young_patients), \n      len(middle_aged_patients),\n      len(old_aged_patients)\n]\ncolors = ['gold', 'mediumturquoise', 'darkorange']\n\ntrace = go.Pie(labels=labels, values=values,\n               hoverinfo='value+percent', textinfo='value', \n               textfont=dict(size=20),\n               marker=dict(colors=colors, line=dict(color='#000000', width=2)))\n\nplotly.offline.iplot([trace], filename='styled_pie_chart')","b9c7d051":"# Age and Target based on sex\n\nfig = px.bar(data, x=data['target'], y=data['age'], color='sex', height=500, width=800)\nfig.update_layout(title_text='BarChart for Age Vs Target on Basis of Sex')\nfig.show()","e56bb894":"# Box plot for target and age based on sex\n\nfig = px.box(data, x=\"target\", y=\"age\", points=\"all\", color='sex')\nfig.update_layout(title_text='BoxPlot of Age Vs Target')\nfig.show()","0dba3374":"# Plot of age and Maximum Heart Rate\n\ndf = px.data\nfig = px.scatter(data, x=\"age\", y=\"max_heart_rate\", color=\"sex\", hover_data=['age','max_heart_rate'])\nfig.update_layout(title = \"Scatter Plot of Age Vs Max Heart Rate\")\nfig.show()","c1ec79c6":"# Plot of Age vs Resting Blood Pressure\n\ndf = px.data\nfig = px.scatter(data, x=\"age\", y=\"resting_blood_pressure\", color=\"sex\", hover_data=['age','resting_blood_pressure'])\nfig.update_layout(title = \"Scatter Plot of Age Vs Resting Blood Pressure\")\nfig.show()","7d7cbbef":"# Plot of age vs Serum Cholesterol\n\ndf = px.data\nfig = px.scatter(data, x=\"age\", y=\"serum_cholesterol\", color=\"sex\", hover_data=['age','serum_cholesterol'])\nfig.update_layout(title = \"Scatter Plot of Age Vs Serum Cholesterol\")\nfig.show()","cad813c6":"# Counts of Chest pain type among Heart Patients and Non-Heart Patients\n\nsns.countplot(x=\"chest_pain_type\", hue=\"target\", data=data, palette=\"bwr\")\nplt.title(\"Chest Pain Types grouped by Targets\")","a5a0e176":"# Counts of Chest pain type among male and female patients\n\nsns.countplot(x=\"chest_pain_type\", hue=\"sex\", data=data, palette=\"bwr\")","494aac45":"# Finding the maximum and minimum Resting Blood Pressure\n\nprint(f\"Maximum Resting Blood Pressure : {data['resting_blood_pressure'].max()}\")\nprint(f\"Minimum Resting Blood Pressure : {data['resting_blood_pressure'].min()}\")","11449ab3":"# Let's look at the distribution of Resting Blood Pressure\n\nhist_data = [data['resting_blood_pressure']]\ngroup_labels = ['resting_blood_pressure'] \n\ncolors = ['#008080']\n\n# Create distplot with curve_type set to 'normal'\nfig = ff.create_distplot(hist_data, group_labels=group_labels, colors=colors,\n                         bin_size=10, show_rug=False)\n\n# Add title\nfig.update_layout(width=700, title_text='Resting Blood Pressure Distribution')\nfig.show()","77068470":"# Plot of Resting Blood Pressure with Target\n\nsns.barplot(x=\"target\", y='resting_blood_pressure',data = data, palette=\"bwr\")\nplt.title('Resting Blood Pressure vs Target')\nplt.show()","f44f53b9":"# Boxplot of Resting Blood Pressure with Target\n\nfig = px.box(data, x=\"target\", y=\"resting_blood_pressure\", points=\"all\", color='sex')\nfig.update_layout(title_text='BoxPlot of Resting Blood Pressure Vs Target')\nfig.show()","73b73a29":"# Finding the maximum and minimum Serum Cholesterol\n\nprint(f\"Maximum Serum Cholesterol : {data['serum_cholesterol'].max()}\")\nprint(f\"Minimum Serum Cholesterol : {data['serum_cholesterol'].min()}\")","0419a7ac":"# Let's look at the distribution of Serum Cholesterol\n\nhist_data = [data['serum_cholesterol']]\ngroup_labels = ['serum_cholesterol'] \n\ncolors = ['#DA70D6']\n\n# Create distplot with curve_type set to 'normal'\nfig = ff.create_distplot(hist_data, group_labels=group_labels, colors=colors,\n                         bin_size=10, show_rug=False)\n\n# Add title\nfig.update_layout(width=700, title_text='Serum Cholesterol Distribution')\nfig.show()","d574db0b":"# Plot of Serum Cholesterol and Target\n\nsns.barplot(x=\"target\", y='serum_cholesterol',data = data, palette=\"bwr\")\nplt.title('Serum Cholesterol vs Target')\nplt.show()","4434c8bd":"# Box Plot on basis of Sex\n\nfig = px.box(data, x=\"target\", y=\"serum_cholesterol\", points=\"all\", color='sex')\nfig.update_layout(title_text='BoxPlot of Serum Cholesterol Vs Target')\nfig.show()","f503831c":"# Box plot on basis of st_slope\n\nfig = px.box(data, x=\"target\", y=\"serum_cholesterol\", points=\"all\", color='st_slope')\nfig.update_layout(title_text='Serum Cholesterol Vs Target ')\nfig.show()","deb9b86c":"# Counts of Heart Disease and No Heart Disease Patients with fasting blood sugar above 120 mg\/dl\n# and lower than 120 mg\/dl\n\nsns.set(rc={'figure.figsize':(8.7,5.27)})\n\nsns.countplot(hue='fasting_blood_sugar',x ='target',data = data, palette=\"bwr\")\nplt.title('Fasting Blood Sugar > 120 mg\/dl')\nplt.show()","2d056207":"# Counts of Male and Female Patients with fasting blood sugar above 120 mg\/dl\n# and lower than 120 mg\/dl\n\nsns.countplot(hue='fasting_blood_sugar',x ='sex',data = data, palette=\"bwr\")\nplt.title('Fasting Blood Sugar > 120 mg\/dl')\nplt.show()","c5f148b6":"# Resting electrocardiographic results (values 0,1,2))\n\nsns.countplot(x='rest_ecg', hue ='target', data = data, palette=\"bwr\")\nplt.title('Resting electrocardiographic Results')\nplt.show()","857b77da":"# Resting electrocardiographic results (values 0,1,2))\n\nsns.countplot(x='rest_ecg', hue ='sex', data = data, palette=\"bwr\")\nplt.title('Resting electrocardiographic Results')\nplt.show()","9658ab6d":"print(f\"Maximum Max Heart Rate : {data['max_heart_rate'].max()}\")\nprint(f\"Minimum Max Heart Rate: {data['max_heart_rate'].min()}\")","c0914cf2":"# Let's look at the distribution of Maximum Heart Rate\n\nhist_data = [data['max_heart_rate']]\ngroup_labels = ['max_heart_rate'] \n\ncolors = ['#808000']\n\n# Create distplot with curve_type set to 'normal'\nfig = ff.create_distplot(hist_data, group_labels=group_labels, colors=colors,\n                         bin_size=10, show_rug=False)\n\n# Add title\nfig.update_layout(width=700, title_text='Maximum Blood Pressure Distribution')\nfig.show()","c61f8db1":"# Maximum heart rate and target \n\nsns.barplot(x=\"target\", y='max_heart_rate',data = data, palette=\"bwr\")\nplt.title('Maximum Heart Rate vs Target')\nplt.show()","efff3555":"# Box plot on basis of sex\n\nfig = px.box(data, x=\"target\", y=\"max_heart_rate\", points=\"all\", color='sex')\nfig.update_layout(title_text='Maximum Heart Rate Vs Target')\nfig.show()","8e5e15e9":"# Box plot on basis of st_slope\n\nfig = px.box(data, x=\"target\", y=\"max_heart_rate\", points=\"all\", color='st_slope')\nfig.update_layout(title_text='Maximum Heart Rate Vs Target ')\nfig.show()","810d000f":"# Plot on basis of Target\n\nsns.countplot(x='exercise_angina', hue ='target', data = data, palette=\"bwr\")\nplt.title('Exercise Induced Angina')\nplt.show()","cdd3296e":"# Count of Male and Female patients with and withour Exercise Induced Angina\n\nsns.countplot(x = 'exercise_angina', hue ='sex', data = data, palette=\"bwr\")\nplt.title('Exercise Induced Angina')\nplt.show()","a73577e4":"print(f\"Maximum Depression : {data['st_depression'].max()}\")\nprint(f\"Minimum Depression : {data['st_depression'].min()}\")","203e568a":"# Let's look at the distribution of ST Depression\n\nhist_data = [data['st_depression']]\ngroup_labels = ['st_depression'] \n\ncolors = ['#808000']\n\n# Create distplot with curve_type set to 'normal'\nfig = ff.create_distplot(hist_data, group_labels=group_labels, colors=colors,\n                         bin_size=0.2, show_rug=False)\n\n# Add title\nfig.update_layout(width=700, title_text='ST Depression Distribution')\nfig.show()","0c0d8c3e":"# Box plot on basis of sex\n\nfig = px.box(data, x=\"target\", y=\"st_depression\", points=\"all\", color='sex')\nfig.update_layout(title_text='ST Depression Vs Target')\nfig.show()","ff52b830":"# The slope of the peak exercise ST segment\n\nsns.countplot(hue='st_slope',x ='target',data = data, palette=\"winter_r\")\nplt.title('Slope of the peak exercise ST segment')\nplt.show()","1856a540":"# the slope of the peak exercise ST segment\n\nsns.countplot(hue='st_slope',x ='sex',data = data, palette=\"winter_r\")\nplt.title('Slope of the peak exercise ST segment')\nplt.show()","e8412d08":"# Number of major vessels (0-4)\n\nsns.countplot(hue='num_major_vessels',x ='target',data = data, palette=\"rainbow_r\")\nplt.title('Number of major vessels (0-4) colored by flourosopy')\nplt.show()","526b1ca2":"# Thalassemia types based on target\n\nsns.countplot(hue='thalassemia',x ='target',data = data, palette=\"gist_ncar\")\nplt.title('Thalassmia')\nplt.show()","badc804b":"# Thalassemia types based on Chest Pain Type\n\nplt.figure(figsize=(10,5))\nsns.countplot(x=\"chest_pain_type\", hue=\"thalassemia\", data=data, palette=\"YlOrRd_r\")","ee8edd0b":"# Thalassemia types based on st_slope\n\nplt.figure(figsize=(10,5))\nsns.countplot(x=\"st_slope\", hue=\"thalassemia\", data=data, palette=\"YlOrRd_r\")","32a52a78":"# Thalassemia types based on sex\n\nsns.countplot(hue='thalassemia',x ='sex',data = data, palette=\"gist_ncar\")\nplt.title('Thalassmia')\nplt.show()","76554f01":"**OBSERVATIONS**\n\n**(I) The distribution of st_depression does not follow normal distribution.**<br><br>\n**(II) Non-Heart Disease Patients seem to have high Depression.**<br><br>\n**(III) Female Patients doesn't matter whether there is disease or not, seems to have high st_depression as compared to Male.** ","b4b2fe9a":"**OBSERVATION**\n\n**The most common type of chest pain among heart disease patients is \"atypical agina\" followed by \"agina pectoris\". Also, we can see around 40 of the patients don't have chest pain but still have heart disease so absence of chest pain does not guarantee that the patient being diagonsed has no Heart Disease.**","60834815":"**OBSERVATIONS**\n\n**(I) Excercise Induced Angina is not very common in patients with Heart Diseases.**\n\n**(II) There are more patients without Exercise Induced Angina out of which male are more in number and this is even true for patients with Exercise Induced Angina.**","0200b888":"**These names looks gribberish! We don't want to move back and forth seeing what our columns mean so let's change the column names to something meaningful.**","5e78e0fc":"**OBSERVATION**\n\n**Most of the patients either male or female mostly have a heart disease have a slope = 2 followed by slope = 1**","64ac4ca0":"## \tThalassemia","19486209":"# Analysis of associations of different columns","322dfd62":"**That was a lot of typing but the end result looks so much more tempting to be analysed. Let's move to our favourite part, GRAPHS!**","2b1937bf":"### Check out the Preprocessing and Modelling part [here](https:\/\/www.kaggle.com\/nishkarshtripathi\/predicting-like-a-boss-91-8-accuracy).\n\n\n# THANKS FOR READING!","892d2f8e":"**OBSERVATIONS**\n\n**(I) The distribution of serum cholesterol is close to normal distribution and has a long tail.**<br><br>\n**(II) The resting blood pressure of both Heart Disease patients and Non-heart Disease patients is almost same.**<br><br>\n**(III) Median Serum Cholesterol with Heart Disease - Male (228) and Female (249)<br><br>\n        Median Serum Cholesterol without Heart Disease - Male (247.5) and Female (265.5)**<br><br>\n**(IV) st_slope doesn't seem to vary much**","633643d3":"## Rest ECG (rest_ecg)","90119392":"## ST depression","e4ee56bd":"**OBSERVATIONS**\n\n**(I) Almost every patient, having heart disease or not, has Thalassemia.**<br><br>\n**(II) Fixed Defect Thalassemia is more common in Patients with Heart Disease whereas Reversable Defect Thalassemia is more common in Patients without Heart Disease.**<br><br>\n**(III) There are more number of patients with Fixed Defect Thalassemia in any type of chest pains whereas patients without chest pain and Reversable Defect Thalassemia are very common.**<br><br>\n**(IV) Fixed Defect Thalassemia is very common among Male and Female Patients but there are very large number of Reversable Defect Thalassemia Male Patients as compared to Female Patients.**<br><br>\n**(V) Among Horizontal Slope Patients - Fixed Defect Thalassemia is more common as compared to others whereas Upsloping patients have more number of Reversable Defect Thalassemia Patients.**","504bf762":"**OBSERVATIONS**\n\n**There are large number of Heart Patients with vessel=0 as compared to others whereas there are almost same number of Non-Heart Patients for vessels 0 and 1. There are very less number of patients with vessel = (2,3 or 4)**","e8dd7eac":"**OBSERVATION**\n\n**Too bad! This data isn't correlated at all so it is of no use to us.**","e64bdf18":"## Serum Cholesterol\t","0ece2b4c":"**OBSERVATIONS**\n\n**(I) Patients having fasting blood sugar lower than 120 mg\/dl have a high chance of suffering from Heart Disease but this is not a clear indicator as many of the patients without Heart Disease also have the same scenario.**\n\n**(II) There are more Male Patients with lower and greater than 120 mg\/dl fasting sugar as compared to Female Patients.**","0db8848b":"## Chest Pain Type","c77b77a4":"## Resting Blood Pressure","ee94802e":"**OBSERVATION**\n\n**The median of ages of patients not having heart disease is slightly higher than patients having heart diseases. We can see that there is one point in male patients without heart disease which is exceeding the BoxPlot whiskers thus it can be termed as an Outlier.**","663efd83":"## Number of major vessels","cdc268d6":"**Cool, this data doesn't contain any categorical variable and null values which is a really good thing as we will not have to invest a lot of time on cleaning the data and we can focus more on predictive modelling.**\n\n\n**Also, the target here is our target vector and all others are predictors? Well, we can't say this early.**\n\n**Let's dive straight in and find out!**","0ecaac73":"## Age and Sex Column","52690f22":"**OBSERVATIONS**\n\n**(I) There are many patients with having rest_ecg = 1 and suffering from heart disease. Also, rest_ecg = 2 seems to be very rare.**\n\n**(II) rest_ecg = 0 and rest_ecg = 1 is found in most of the male as well as female patients.**","3819665a":"## Peak exercise ST segment (st_slope)","6e4d7246":"**OBSERVATIONS**\n\n**(I) The distribution of resting blood pressure is close to normal distribution.**<br><br>\n**(II) The resting blood pressure of both Heart patients and Non-heart patients is almost same.**<br><br>\n**(III) Median Resting Blood Pressure with Heart Disease - Male (130) and Female (130)<br><br>\n        Median Resting Blood Pressure without Heart Disease - Male (130) and Female (140)**","3b9ab05d":"## Fasting Blood Sugar","f9ffcde3":"**OBSERVATIONS**\n\n**(I) The distribution of Maximum Heart Rate is close to normal distribution with little bit skewing to the left.**<br>\n**(II) The Maximum Heart Rate in Heart Disease Patients is  a bit more and than Non-Heart Disease Patients.**<br>\n**(III) Median Maximum Heart Rate with Heart Disease - Male (163) and Female (159)<br>\n        Median Maximum Heart Rate Cholesterol without Heart Disease - Male (141) and Female (145.5)**<br>","7539609e":"**OBSERVATION**\n\n**Both Resting Blood Pressure and Serum Cholesterol shows a bit positive correlation but not that much. Also, Resting Blood Pressure and Serum Cholesterol have few Outliers which we will remove in preprocessing steps.**","ae208df3":"**That's more like it!**\n\n**Also, these columns are already encoded so for data analysis it is better to change them so that it is easily to look what we are exactly plotting. Don't worry we will do this on a copy of data.**","e6e44bc3":"## Maximum Heart Rate","213c312e":"**OBSERVATION**\n\n**There are 16 young patients which is quite obvious beacuse heart diseases is not very common in younger population but we have almost large number of patients in middle age and Old age which is also obvious.**","a49c3389":"**OBSERVATION**\n\n**There are more male patients with no chest pain as compared to female.**","9c0e8831":"**As we can see that we got a lot of information using a single function. These are called the descriptive properties of data which are very useful for a data like this which is full of numerical attributes. So never leave this step.**","571ccd32":"## Exercise Induced Angina (exercise_angina)","2606d439":"## Correlation Plot","34b796e8":"**OBSERVATION**\n\n**Distribution of age looks close to a Normal Distribution. This data has age of patients ranging from 29-77 which is good as the data is not biased towards certain kind of patients.**\n\n**Let's look at some of the ranges.**","a22d4bbe":"**OBSERVATION**\n\n**We can see that the people suffering from heart disease and people not suffering from heart disease almost similiar ages and there are almost equal number of male and female patients having heart disease.**"}}