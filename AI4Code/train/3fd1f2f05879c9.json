{"cell_type":{"23228511":"code","ac4b30ee":"code","1465ee99":"code","d2319231":"code","37e425df":"code","5911312d":"code","cee64a6d":"code","70a15930":"code","218a4add":"code","ce886f74":"code","e013991d":"code","fb505c9e":"code","0cf5286a":"code","0e5fee2d":"code","df41d951":"code","b8bd5191":"code","f9b81c39":"code","cdaebcfb":"code","3c31e280":"code","1d251a64":"code","597d9e02":"code","16c93f6e":"code","74b82d4c":"code","229eb9f4":"code","0131afb3":"code","02ed0ab2":"code","9932c66f":"code","fe02a558":"code","1c72de34":"code","050f059d":"code","f4588b58":"code","c359a893":"code","23716828":"code","dd6e13b7":"code","bffcd47b":"code","c3792e97":"code","1c2b394f":"code","9851fe21":"code","d12301d5":"code","cf6659dd":"code","08d93dbe":"code","e04f5a2e":"code","4fe6df2d":"code","5e6dd938":"code","204a2c91":"code","a11498b1":"code","ac368f47":"markdown","6657d249":"markdown","827f8b96":"markdown","738cf44c":"markdown","d1fff44d":"markdown","19643f99":"markdown","fba72a8d":"markdown","f74478f4":"markdown","b5921785":"markdown","a0fb3ba0":"markdown","91042d54":"markdown","1b1e2db4":"markdown","c4bb2e9d":"markdown","c5ecaf2b":"markdown","3b98180b":"markdown","6bfa2d42":"markdown","afd01b92":"markdown","c3a826f3":"markdown","c7a26444":"markdown","1155496c":"markdown","85ebabda":"markdown","f5a72a79":"markdown","d380a7d0":"markdown","182ddd13":"markdown","b736ccb9":"markdown","f7cea28d":"markdown","07fb2684":"markdown","b4702820":"markdown","9b926b31":"markdown","f2c7e2da":"markdown","bcacbe34":"markdown","0def7f1e":"markdown"},"source":{"23228511":"## Importing libraries\nimport numpy as np\nimport pandas as pd\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.model_selection import train_test_split","ac4b30ee":"# Loading the dataset\ntrain_df = pd.read_csv('..\/input\/health-insurance-cross-sell-prediction\/train.csv')\ntest_df = pd.read_csv('..\/input\/health-insurance-cross-sell-prediction\/test.csv')","1465ee99":"train_df.head()","d2319231":"test_df.head()","37e425df":"## Checking the number of features and instances\ntrain_df.shape","5911312d":"## Check for missing values\ntrain_df.isnull().sum()","cee64a6d":"## Looking at columns\ntrain_df.columns","70a15930":"print(train_df[\"Region_Code\"].unique())\nprint(train_df[\"Policy_Sales_Channel\"].unique())","218a4add":"## Segregating columns\nnumerical_columns = [\"Age\",\"Region_Code\", \"Annual_Premium\", \"Policy_Sales_Channel\", \"Vintage\"]\ncategorical_columns = [\"Gender\",\"Driving_License\", 'Previously_Insured', 'Vehicle_Age', 'Vehicle_Damage']","ce886f74":"train_df[numerical_columns].describe()","e013991d":"### Checking if the data is skewed. \nsns.countplot(x = train_df[\"Response\"])","fb505c9e":"### Gender participation\nsns.countplot(x = train_df[\"Gender\"])","0cf5286a":"### Gender distribution based on response\nfig, axis = plt.subplots(1, 2, figsize = (14, 5))\n\nsns.countplot(ax = axis[0], x = train_df[train_df[\"Response\"] == 1][\"Gender\"])\naxis[0].set_title(\"When they subscribe to vehicle insurence\")\n\nsns.countplot(ax = axis[1], x = train_df[train_df[\"Response\"] == 0][\"Gender\"])\naxis[1].set_title(\"When they do-not subscribe to vehicle insurence\")\n\nfig.tight_layout()","0e5fee2d":"### Analysing Driving liscense\ntemp = train_df.groupby([\"Gender\"]).count()[\"Driving_License\"].to_frame().reset_index()\nprint(temp)\nsns.barplot(x = temp[\"Gender\"], y = temp[\"Driving_License\"])","df41d951":"sns.countplot(x = train_df[\"Previously_Insured\"])","b8bd5191":"sns.countplot(x = train_df[\"Vehicle_Age\"])","f9b81c39":"temp = train_df.groupby([\"Vehicle_Age\",\"Response\"]).count()[\"id\"].to_frame().reset_index()\ntemp","cdaebcfb":"sns.catplot(x = \"Vehicle_Age\", y=\"id\", col=\"Response\", data=temp[temp[\"Response\"] == 1], kind=\"bar\")","3c31e280":"sns.countplot(x = train_df[\"Vehicle_Age\"])","1d251a64":"sns.countplot(x = train_df[\"Vehicle_Damage\"])","597d9e02":"temp = train_df.groupby([\"Vehicle_Damage\",\"Response\"]).count()['id'].to_frame().reset_index()\ntemp","16c93f6e":"sns.catplot(x=\"Vehicle_Damage\", y=\"id\", col = \"Response\", data = temp[temp[\"Response\"] == 1], kind = \"bar\")","74b82d4c":"sns.histplot(x = train_df[\"Annual_Premium\"])","229eb9f4":"plt.figure(figsize = (10,10))\nplt.title(\"Correlation Plot\")\nsns.heatmap(train_df.corr(), linewidth = 5, annot = True, square = True, annot_kws={'size': 10}, cmap=\"YlGnBu\")","0131afb3":"train_df.head()","02ed0ab2":"## Reading Continuous and Categorical data\ncont = [\"Age\", \"Vintage\", \"Annual_Premium\"]\ncat = [\"Gender\", \"Driving_License\", \"Region_Code\", \"Previously_Insured\", \"Vehicle_Age\", \"Vehicle_Damage\"]","9932c66f":"train = pd.get_dummies(train_df,drop_first = True)","fe02a558":"train.head()","1c72de34":"train.columns\ntrain.columns = ['id', 'Age', 'Driving_License', 'Region_Code', 'Previously_Insured',\n       'Annual_Premium', 'Policy_Sales_Channel', 'Vintage', 'Response',\n       'Gender_Male', 'Vehicle_Age__1_Year', 'Vehicle_Age_2_Years',\n       'Vehicle_Damage_Yes']","050f059d":"train.head()","f4588b58":"# Getting the records which have the value as 1 for response\ntrain_1 = train[train[\"Response\"] == 1]","c359a893":"print(len(train_1))\n\n# Getting the records which have value as 0 fro response\ntrain_0 = train[train[\"Response\"] == 0]\n\nprint(len(train_0))","23716828":"## Getting random samples of train_0 for modelling\ntrain_00 = train_0.sample(n = len(train_1))","dd6e13b7":"len(train_00)","bffcd47b":"## Appending the two dataframes to have equal number of records when response = 1 and 0\ntrain_sampled = train_1.append(train_00)","c3792e97":"len(train_sampled)","1c2b394f":"train_sampled.head()","9851fe21":"train_sampled = train_sampled.drop([\"id\"], axis = 1)","d12301d5":"train_sampled.head(3)","cf6659dd":"train_sampled.columns","08d93dbe":"## Spitting the dataset into features and target variable\nX = train_sampled[['Age', 'Driving_License', 'Region_Code', 'Previously_Insured',\n       'Annual_Premium', 'Policy_Sales_Channel', 'Vintage', 'Gender_Male', 'Vehicle_Age__1_Year', 'Vehicle_Age_2_Years',\n       'Vehicle_Damage_Yes']]\ny = train_sampled[[\"Response\"]]","e04f5a2e":"## Printing the first 3 rows of X\nX.head(3)","4fe6df2d":"## printing the first 3 rows of y\ny.head(3)","5e6dd938":"# Declaring the standard scaler and transforming the dataset \nsc = StandardScaler()\nX_scaled = sc.fit_transform(X)","204a2c91":"## Displaying the first 3 rows \nX_scaled[:3]\n","a11498b1":" X_train, X_test, y_train, y_test = train_test_split(X_scaled, y, test_size = 0.33, random_state=42)","ac368f47":"The above output doesnt help much as the dataset is highly skewed and number of people without insurence is much higher than the ones with insurence. To make actual sense of the response vs vehicle age, sampling the dataset is required","6657d249":"##### Analysis Vehicle age","827f8b96":"### Feature Engineering","738cf44c":"##### Analysing Vehicle Age","d1fff44d":"From the above plot we can see correlation among each features. If two features are highly correlated, we can eleminate one of them because they tend to overfit the data and we also need to make sure to consider all the features that highly correlate with the output so that they help in better prediction. ","19643f99":"##### Converting the data into 0-1 encodings","fba72a8d":"##### Customer previously insured","f74478f4":"##### Counting number of damaged vehicle","b5921785":"From the above plot we can see that the data is skewed. Going forward, we need to implement techniques like random sampling or SMOT analysis to fix this issue. ","a0fb3ba0":"##### Analysing the response of the customers when they have damaged vehicles","91042d54":"##### Gender distribution based on response","1b1e2db4":"### EDA","c4bb2e9d":"### Problem Statement:\nThe Insurance company that provides health insurance to its customers are now planning to provide vehicle insurance. The company wants to know how many of its customers would be interested in vehicle insurance. \n\n##### EDA:\nPerform EDA to extract valuable insights from the data. \n\n##### Feature Engineering: \nPerform feature engineering to check which columns play a very important role in model building and try to come up with new features which makes a difference in building the model. \n\n##### Modelling:\nBuild a model to come up with a probability score which tells the chances of a person opting for vehicle insurance\n    \n##### Note:\n<b><p> I am still working on the model. Feel free to drop by later for more updates. <\/p><\/b>\nConsider upvoting if you like my work and if you have any suggestions please drop it in comments. I will take a look at it and work on it. \n     \nThank you!!!","c5ecaf2b":"If you observe above, get_dummies only apply for categorical features where number of category is more than 2. If number of categories are two then they will be converted to 0 and 1 and also note that column names will be renamed. ","3b98180b":"Data with respect to customer previously insured is almost equally distributed. ","6bfa2d42":"From the above we can see that Male tend to subscribe to vehicle insurence more than female. Therefore we can assume that gender plays an important role in model building. ","afd01b92":"We can infer from above that there are no missing values. ","c3a826f3":"From the above we can see that most people who opted for the insurence have damaged there vehicle previously.","c7a26444":"This doesnt tell much about data so I need to check how many opted for insurence with respect to above 3 groups","1155496c":"##### Train_Test_Split","85ebabda":"##### Random Sampling the data","f5a72a79":"##### Checking if the data is skewed. ","d380a7d0":"##### Plotting the count for each group when people have opted for insurence","182ddd13":"##### Correlation plot","b736ccb9":"##### Analysisng Annual Premium ","f7cea28d":"### Modelling","07fb2684":"##### Gender participation","b4702820":"##### Building an ANN Model using PyTorch","9b926b31":"##### Analysing Driving liscense","f2c7e2da":"##### Scalling the data","bcacbe34":"From the above barplot we can see that equal number of records have damaged and non-damaged vehicles. ","0def7f1e":"From the above graph we can observe that people tend to take insurence when the age of the vehicle is between 1-2 years. This might be a important factor when building the model. \n\nBut before coming to this conclusion, we need to check the data to see how many records fall under the above 3 groups. If the data for vehicles age between 1-2 years is more than the others then we cant come to the above conclusion. "}}