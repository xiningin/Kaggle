{"cell_type":{"5e3b35bc":"code","e6924f20":"code","b1d65338":"code","ca30b8c2":"code","52adbe11":"code","680effc5":"code","44358f9f":"code","d8d3b680":"code","614a3be1":"code","736963ee":"code","c8c554f8":"code","f67c9703":"code","bf431d1b":"code","8fec73bd":"code","2dbdb6c1":"code","d929498d":"code","6bc997df":"code","4d12bffc":"code","378e4953":"code","dd23e5a8":"code","12ed17d8":"code","6a900b93":"code","63ac8ec4":"code","ff794338":"code","488d4f36":"code","4096390a":"code","19258e74":"code","1a2f9d19":"code","2eef15b0":"code","12aa4dd8":"code","f2166b5f":"markdown","bd6173d8":"markdown","afd5d247":"markdown","155b1448":"markdown","f60af293":"markdown","3296dab6":"markdown","8b03bcf5":"markdown","b97c531b":"markdown","1ae1db7c":"markdown","a11d1548":"markdown","3b8cf30a":"markdown"},"source":{"5e3b35bc":"import numpy as np\nimport pandas as pd\nimport sklearn\nimport matplotlib.pyplot as plt\nimport seaborn as sns","e6924f20":"df= pd.read_csv('..\/input\/titanic\/train.csv')\ndf","b1d65338":"test= pd.read_csv('..\/input\/titanic\/test.csv')\ntest","ca30b8c2":"df.info","52adbe11":"df.describe()","680effc5":"df.columns","44358f9f":"to_drop= ['Name', 'Ticket', 'Cabin']\ndf.drop( to_drop, axis= 1, inplace= True)","d8d3b680":"df.isnull().sum()","614a3be1":"df['Age']= df['Age'].fillna(df['Age'].median())\ndf['Age'].mode()","736963ee":"df[df['Embarked'].isnull()]","c8c554f8":"df.drop([61, 829],axis= 0, inplace= True)\ndf.shape","f67c9703":"print(df['Survived'].value_counts())\nsns.countplot( data=df, x = df['Survived'],palette='RdBu_r')","bf431d1b":"cols = df.columns.to_list()\nnum_cols= df._get_numeric_data().columns.to_list()\ncat_cols = list(set(cols) - set(num_cols))\nprint('Numerical Columns')\nprint(num_cols)\nprint('\\nCategorical Columns')\nprint(cat_cols)","8fec73bd":"# One-Hot Encoding\n\nembark = pd.get_dummies(df['Embarked'],prefix='Embarked')\nsex = pd.get_dummies(df['Sex'],prefix='Sex')\ndf_new= pd.concat([embark, sex],axis=1)\ndf_new.head()","2dbdb6c1":"df= pd.concat([df, df_new], axis=1)\ndf.drop(['Sex', 'Embarked'], axis=1, inplace= True)","d929498d":"df.dtypes","6bc997df":"df['Age'].astype('int')\ndf['Fare'].astype('int')","4d12bffc":"test = test.drop(['Name', 'Ticket', 'Cabin'], axis = 1)\nembark = pd.get_dummies(test['Embarked'], prefix= 'Embarked')\nsex= pd.get_dummies(test['Sex'], prefix= 'Sex')\ntest.drop(['Embarked','Sex'],axis=1,inplace=True)\ntest = pd.concat([test,sex,embark],axis=1)\ntest['Fare'] = test['Fare'].fillna(test['Fare'].median())\ntest['Age'] = test[\"Age\"].fillna(test['Age'].median())\ntest['Age'].astype('int')\ntest['Fare'].astype('int')\nTEST = test\ntest.head()\n","378e4953":"X= df.drop('Survived', axis=1)\ny= df['Survived']","dd23e5a8":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test= train_test_split(X, y, test_size= 0.33, random_state= 101)\ny_test","12ed17d8":"from sklearn.preprocessing import StandardScaler\nscaler= StandardScaler()\nscaler.fit(X_train)\nX_train = scaler.transform(X_train)\nX_test = scaler.transform(X_test)\ntest = scaler.transform(test)","6a900b93":"from sklearn.linear_model import LogisticRegression\nLR= LogisticRegression()\nLR.fit(X_train, y_train)","63ac8ec4":"param = LR.get_params()\npd.DataFrame(data = param, index = [0])","ff794338":"y_predicted= LR.predict(X_test)\ny_predicted.size","488d4f36":"from sklearn.metrics import accuracy_score, confusion_matrix, f1_score\nprint('Accuracy =', accuracy_score(y_test, y_predicted))\nprint(\"Confusion_matrix=\", confusion_matrix(y_test, y_predicted))","4096390a":"## Getting the output out of the data\ny_pred= LR.predict(test)\nprint(test)","19258e74":"my_sub = pd.DataFrame({'PassengerId': TEST.PassengerId, 'Survived': y_pred})\n# simply use any filename and choose submission as pelow\nmy_sub.to_csv('sub_titanic.csv', index= True)","1a2f9d19":"df_sub= pd.read_csv('.\/sub_titanic.csv')\ndf_sub","2eef15b0":"# Since we didn not dropped the index column before in EDA, we are getting an unnamed column, we can try dropping that\ndf_sub.drop('Unnamed: 0', axis=1, inplace= True)\ndf_sub.head()","12aa4dd8":"df_sub.head()","f2166b5f":"## Converting categorical data to numerical\n\n#### Since our model can;t analyse the text data or categorical variable, we should convert it to useful form using encoding. We will use the dummy data for same","bd6173d8":"# Model Evaluation parameters\n\n","afd5d247":"## Non-useful columns and missing Values handling\n\n#### Here we can see that (name, Cabin and ticket)columns can't help in analysis of survival, so we will drop them","155b1448":"## Working on Datatypes","f60af293":"## Basic required EDA","3296dab6":"### Now the dataset df is ready to use as a train data. Also we need to solve our test data. ","8b03bcf5":"# Train-test split","b97c531b":"#### Now Age has 177 null values which is obviously a high number and can;t be ignored. Hence we will replace this with median of all Ages in dataset. \n#### Also 2 null values of Embarked can be ignored and dropped easily","1ae1db7c":"# Processing the test data ","a11d1548":"# Prediction and Output CSV","3b8cf30a":"### Clearly we can see we have got output of all 418 values in test data file"}}