{"cell_type":{"64401a5c":"code","c1ed16f8":"code","615751d0":"code","12551ddb":"code","ef195cde":"code","e762a469":"code","cb491143":"code","8626f9c9":"code","07eda2ff":"code","bfb2aa5e":"code","3da5b684":"code","ded5a672":"code","20667df6":"code","f33c1260":"markdown"},"source":{"64401a5c":"from sklearn.tree import DecisionTreeClassifier","c1ed16f8":"from sklearn.datasets import load_breast_cancer","615751d0":"cancer = load_breast_cancer()\nfrom sklearn.model_selection import train_test_split","12551ddb":"X_train,X_test,y_train,y_test = train_test_split(cancer.data,cancer.target,\n                                                 stratify=cancer.target,random_state=42)\nd_tree = DecisionTreeClassifier(random_state=0)\nd_tree.fit(X_train,y_train)","ef195cde":"print(\"Training Set Accuracy: {}\".format(d_tree.score(X_train,y_train)))\nprint(\"Test Set Accuracy: {}\".format(d_tree.score(X_test,y_test)))","e762a469":"d_tree_1 = DecisionTreeClassifier(max_depth=4,random_state=0)\nd_tree_1.fit(X_train,y_train)","cb491143":"print(\"Training Set Accuracy: {}\".format(d_tree_1.score(X_train,y_train)))\nprint(\"Test Set Accuracy: {}\".format(d_tree_1.score(X_test,y_test)))","8626f9c9":"from sklearn.tree import export_graphviz\nexport_graphviz(d_tree_1,out_file = 'tree.dot',class_names=[\"malignant\",\"benign\"],\n                feature_names=cancer.feature_names,impurity=False,filled=True)","07eda2ff":"import graphviz\nwith open (\"tree.dot\") as f:\n    dot_graph = f.read()\ngraphviz.Source(dot_graph)","bfb2aa5e":"print(\"Feature Importances:\\n{}\".format(d_tree_1.feature_importances_))","3da5b684":"import matplotlib.pyplot as plt\nimport numpy as np\nplt.figure(figsize=(15,10))\ndef plot_feature_importances_cancer(model):\n    n_features = cancer.data.shape[1]\n    plt.barh(range(n_features),model.feature_importances_,align='center')\n    plt.yticks(np.arange(n_features),cancer.feature_names)\n    plt.xlabel(\"Feature Importance\")\n    plt.ylabel(\"Feature\")\nplot_feature_importances_cancer(d_tree_1)","ded5a672":"!pip install mglearn","20667df6":"import mglearn\ntree = mglearn.plots.plot_tree_not_monotone()","f33c1260":"## Reference taken from Introduction to ML by Python-O'Reilly"}}