{"cell_type":{"523cba8c":"code","6ecb8b2e":"code","a289c6d2":"code","c59b96e7":"code","bb50b240":"code","6c0ad029":"code","cb11594a":"code","52642fbf":"code","f4a30b54":"code","3cd2a73e":"code","433c7f0a":"code","72ff7fd8":"code","f249616f":"markdown","8d316c84":"markdown"},"source":{"523cba8c":"import io\nimport numpy as np\nimport os\nimport pandas as pd\nimport plotly.express as px\nimport plotly.graph_objects as go\nimport plotly.io as pio\nimport requests\nimport re\nimport seaborn as sns\nimport warnings\n\n# pio.templates\n\nimport matplotlib.pyplot as plt\n%matplotlib inline\nplt.style.use('seaborn-notebook')\nfrom matplotlib.ticker import StrMethodFormatter\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.preprocessing import StandardScaler, MinMaxScaler, LabelBinarizer\n\n\n# debug the input files\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","6ecb8b2e":"# this data is not used. assumes simple logic of only females survived\ngender_submission = pd.read_csv(\"\/kaggle\/input\/titanic\/gender_submission.csv\")\ngender_submission.describe()","a289c6d2":"# load up some training data\ntrain_data = pd.read_csv(\"\/kaggle\/input\/titanic\/train.csv\")\ntrain_data.head()","c59b96e7":"# poking around at the data\ntrain_data.agg(\n    {\n        \"Age\": [\"min\", \"max\", \"median\", \"skew\"],\n        \"Fare\": [\"min\", \"max\", \"median\", \"mean\"],\n    }\n)","bb50b240":"train_data.groupby(\"Pclass\")[\"Pclass\"].count()","6c0ad029":"# and the test data\ntest_data = pd.read_csv(\"\/kaggle\/input\/titanic\/test.csv\")\ntest_data.head()","cb11594a":"# do some simple calculations for gender survival rates\nwomen = train_data.loc[train_data.Sex == 'female'][\"Survived\"]\nrate_women = sum(women)\/len(women)\n\nprint(\"% of women who survived:\", rate_women)","52642fbf":"men = train_data.loc[train_data.Sex == 'male'][\"Survived\"]\nrate_men = sum(men)\/len(men)\n\nprint(\"% of men who survived:\", rate_men)","f4a30b54":"data = [train_data, test_data]\n\nfor dataset in data:\n    # set up 'relatives' column as number of siblings & spouses + number of parents & children\n    dataset['relatives'] = dataset['SibSp'] + dataset['Parch']\n    # set up 'travelled_alone' column\n    dataset.loc[dataset['relatives'] > 0, 'travelled_alone'] = 'No'\n    dataset.loc[dataset['relatives'] == 0, 'travelled_alone'] = 'Yes'\n    # set up \"num_kids\" column by querying dataset to see if anyone on the same ticket was under 16\n    dataset['num_kids'] = dataset.apply(lambda row: dataset.query(f'Ticket == \"{row.Ticket}\" and Age < 16')['PassengerId'].count(), axis = 1)\n    # set up 'has_kids' column\n    dataset.loc[dataset['num_kids'] > 0, 'has_kids'] = 'Yes'\n    dataset.loc[dataset['num_kids'] == 0, 'has_kids'] = 'No'\n\naxes = sns.catplot(x='relatives', y='Survived', data=train_data, aspect=2.5, kind='point')","3cd2a73e":"# train_data.query('has_kids > 0')\naxes = sns.catplot(x='relatives', y='Survived', data=train_data, aspect=2.5, kind='point', hue='has_kids')","433c7f0a":"# show the cluster of # of kids > 3 not surviving\nfig = px.scatter_3d(train_data, x='PassengerId', y='num_kids', z='Age',\n                    color='Survived')\nfig.show()","72ff7fd8":"# finally, use a random model to see the forest from the trees\ny = train_data[\"Survived\"]\n\nfeatures = [\"Pclass\", \"Sex\", \"has_kids\", \"num_kids\"]\nX = pd.get_dummies(train_data[features])\nX_test = pd.get_dummies(test_data[features])\n\nmodel = RandomForestClassifier(n_estimators=100, max_depth=3, random_state=2)\nmodel.fit(X, y)\npredictions = model.predict(X_test)\n\noutput = pd.DataFrame({'PassengerId': test_data.PassengerId, 'Survived': predictions})\noutput.to_csv('prediction_submission.csv', index=False)\nprint(\"Your submission was successfully saved!\")","f249616f":"# Women and children (or large families of adults only) first!\n\nHaving kids (as defined above as anyone on the same ticket being under 16) seems to greatly increase your chance of survival ... but ONLY if you fall into that 1 - 3 sweet spot.\n\nConversely, having TOO many kids brings down your chances precipitously.  On the other side of that coin, having a larger family of adults only (aka: no kids) seems to greatly INCREASE your chances!","8d316c84":"# Number of traveling companions\n\n1 - 3 seems to be the sweet spot.  Too few (zero) and too many (3+) were negative factors on survival rate.\n"}}