{"cell_type":{"2b440042":"code","2d3e603a":"code","f6f34e12":"code","bff255af":"code","27c9e898":"code","fd9a1379":"code","fe6259dd":"code","bfb4146b":"code","c9fde799":"code","b9da6640":"code","8b9d70a4":"code","374857f6":"code","9a95327b":"code","0a5c19a8":"code","545f4508":"code","6d70fe2a":"code","feb3f098":"code","d5e040d4":"code","2d1a1419":"code","d35b550e":"code","78182b54":"code","51731b78":"code","1cfe57e6":"code","4b932135":"code","7bbd4058":"code","6f7a7d89":"code","893d7755":"code","569d5a87":"code","13b08d0f":"code","29cf54bd":"code","62bcc233":"code","b1e42b54":"code","142a6cea":"code","951c5866":"code","5145462a":"code","d03d12ef":"markdown","afe1d328":"markdown","1c3c6c91":"markdown","04799646":"markdown","613612c2":"markdown","77e70e8e":"markdown","6080fb13":"markdown","6197a5af":"markdown","7b6a2e36":"markdown","9a4188f8":"markdown","0e918fbe":"markdown","54821749":"markdown","d3922c8b":"markdown","412474ee":"markdown","eb9046aa":"markdown","6e6cc325":"markdown","25bc6cbd":"markdown","a6d933a7":"markdown","cee5603b":"markdown","03b7ccfc":"markdown","4456e6cc":"markdown","d75bce32":"markdown","0c03b8cb":"markdown","f1f8ee1a":"markdown","7122e6e1":"markdown","9b2c3295":"markdown","61d9d23a":"markdown","6f504ed2":"markdown"},"source":{"2b440042":"import numpy as np \nimport pandas as pd \nimport os\nimport cv2\nimport matplotlib.pyplot as plt","2d3e603a":"traindf = pd.read_csv(\"..\/input\/shopee-product-matching\/train.csv\")\ntraindf","f6f34e12":"testdf = pd.read_csv(\"..\/input\/shopee-product-matching\/test.csv\")\ntestdf","bff255af":"sample = pd.read_csv(\"..\/input\/shopee-product-matching\/sample_submission.csv\")\nsample","27c9e898":"TRAIN_PATH = \"..\/input\/shopee-product-matching\/train_images\"\nTEST_PATH = \"..\/input\/shopee-product-matching\/test_images\"\n\ntraindf[\"path\"] = [os.path.join(TRAIN_PATH,s) for s in traindf[\"image\"]]\ntestdf[\"path\"] = [os.path.join(TEST_PATH,s) for s in testdf[\"image\"]]\n\ntraindf.to_csv(\"traindf.csv\",index=False)\ntestdf.to_csv(\"testdf.csv\",index=False)","fd9a1379":"traindf.head(3)","fe6259dd":"traindf.info()","bfb4146b":"for col in traindf.columns:\n    print(col + \":\" + str(len(traindf[col].unique())))","c9fde799":"img = cv2.imread(traindf[\"path\"].iloc[0])\nplt.imshow(img)","b9da6640":"tmpdf = traindf[traindf[\"label_group\"]==traindf[\"label_group\"].iloc[0]]\ntmpdf","8b9d70a4":"for a in tmpdf[\"path\"]:\n    img = cv2.imread(a)\n    plt.figure()\n    plt.imshow(img)\n    plt.axis(\"off\")","374857f6":"labels = traindf.groupby(\"label_group\")[\"image\"].count().reset_index()\nlabels.columns=[\"label_group\",\"image_num\"]\nlabels","9a95327b":"sortlabels = labels.sort_values(\"image_num\")\nsortlabels","0a5c19a8":"imagecount = labels.groupby(\"image_num\").count().reset_index()\nimagecount.columns=[\"image_num\",\"counts\"]\nimagecount","545f4508":"plt.bar(imagecount[\"image_num\"],imagecount[\"counts\"])","6d70fe2a":"tmpdf = traindf[traindf[\"label_group\"]==sortlabels[\"label_group\"].iloc[-1]]\ntmpdf.head(5)\n    ","feb3f098":"plt.figure(figsize=(20,20))\n\nfor num,a in enumerate(tmpdf[\"path\"]):\n    plt.subplot(11,5,num+1)\n    img = cv2.imread(a)\n    plt.axis(\"off\")\n    plt.imshow(img)\n    \n    ","d5e040d4":"imagegroup = traindf.groupby(\"image\")[\"path\"].count().reset_index()\nimagegroup.columns=[\"image\",\"counts\"]\nimagegroup","2d1a1419":"tmpdf = imagegroup[imagegroup[\"counts\"] > 1]\ntmpdf.sort_values(\"counts\")\ntmpdf","d35b550e":"tmpdf[\"image\"].iloc[0]","78182b54":"traindf[traindf[\"image\"]==tmpdf[\"image\"].iloc[0]]","51731b78":"traindf[traindf[\"image\"]==tmpdf[\"image\"].iloc[1]]","1cfe57e6":"traindf.groupby([\"image\",\"image_phash\"])[\"path\"].count().reset_index()","4b932135":"phashgroup = traindf.groupby(\"image_phash\")[\"path\"].count().reset_index()\nphashgroup.columns=[\"image_phash\",\"counts\"]\nphashgroup","7bbd4058":"sortphash = phashgroup.sort_values(\"counts\")\nsortphash","6f7a7d89":"tmpdf = traindf[traindf[\"image_phash\"]==sortphash[\"image_phash\"].iloc[-1]]\ntmpdf","893d7755":"plt.figure(figsize=(20,20))\n\nfor num,a in enumerate(tmpdf[\"path\"]):\n    plt.subplot(6,5,num+1)\n    img = cv2.imread(a)\n    plt.axis(\"off\")\n    plt.title(tmpdf[\"posting_id\"].iloc[num])\n    plt.imshow(img)\n    ","569d5a87":"traindf","13b08d0f":"titlegroup = traindf.groupby(\"title\")[\"path\"].count().reset_index()\ntitlegroup.columns=[\"title\",\"counts\"]\ntitlegroup","29cf54bd":"sorttitle = titlegroup.sort_values(\"counts\")\nsorttitle","62bcc233":"tmpdf = traindf[traindf[\"title\"]==sorttitle[\"title\"].iloc[-1]]\ntmpdf","b1e42b54":"plt.figure(figsize=(20,20))\n\nfor num,a in enumerate(tmpdf[\"path\"]):\n    plt.subplot(3,5,num+1)\n    img = cv2.imread(a)\n    plt.axis(\"off\")\n    plt.imshow(img)\n    ","142a6cea":"testdf","951c5866":"plt.figure(figsize=(20,20))\n\nfor num,a in enumerate(testdf[\"path\"]):\n    \n    plt.subplot(1,3,num+1)\n    img = cv2.imread(a)\n    plt.imshow(img)\n    plt.axis(\"off\")\n    ","5145462a":"sample","d03d12ef":"# This notebook is to underestand easily for especially train data.\n## if it is helpful for you, please upvote!","afe1d328":"# 0. Confirming each csv file","1c3c6c91":"* Image num counts in each labels are almost 2.","04799646":"## 1.4 Understanding same image_phash","613612c2":"* It can be confirmed that both images are victoria's seacret.","77e70e8e":"* posting id is different, but others are same. it should be duplicated ?","6080fb13":"## 1.5 Understanding same titles","6197a5af":"* images are different but we can see all same.","7b6a2e36":"* 32412 is the same numbers as images. at least, image and image_phash are same in same images.","9a4188f8":"* This result shows the how many uniques in each columns.\n* Total rows are 34250. Each column has some duplicates.\n* There are duplicates in images, hashes, and titles, not just label groups.","0e918fbe":"### 1.2.2 Counting the label_groups in each image_num","54821749":"# 3.submission.csv","d3922c8b":"# 1. Train.csv","412474ee":"* maximum counts are 26.","eb9046aa":"* minimum images are 2, max images are 51","6e6cc325":"maybe, it should be predicted from test images. and find the matched image.","25bc6cbd":"* no nan data","a6d933a7":"* same phash, but images are different. Visualing the images with max counts.","cee5603b":"* max same title is 9. Visualing the images with max counts title.","03b7ccfc":"* title is same but images are different.","4456e6cc":"### 1.2.3 visualizing images of label_group with max counts ","d75bce32":"## 1.2 Understanding same label_groups","0c03b8cb":"## 1.3 Understanding same images","f1f8ee1a":"# 2. test.csv","7122e6e1":"* min and max same images are 2.","9b2c3295":"* Other example shows not only posting id, but also title is different. it seemes that it was edited ?","61d9d23a":"### 1.2.1 Counting the number of images in each label group","6f504ed2":"## 1.1 easy visualizing image"}}