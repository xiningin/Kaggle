{"cell_type":{"243abf7f":"code","afb24283":"code","59862087":"code","d38ccd5a":"code","0c269712":"code","a0e1ce82":"code","71219421":"code","9bdd5a3b":"markdown","3daf7009":"markdown","1c18badc":"markdown","f15d4081":"markdown","788db34d":"markdown","67615122":"markdown","f2e27555":"markdown","8100914f":"markdown","29f6e95a":"markdown","47670848":"markdown"},"source":{"243abf7f":"import numpy as np\nimport matplotlib.pyplot as plt\nimport mne\nfrom mne.preprocessing import ICA","afb24283":"from mne.datasets import sample\ndata_path = sample.data_path()\nraw_fname = data_path + '\/MEG\/sample\/sample_audvis_filt-0-40_raw.fif'\nraw = mne.io.Raw(raw_fname)\nraw.info","59862087":"raw_eeg = raw.copy()\nraw_eeg.pick_types(meg=False, eeg=True, eog=True, ecg=True) # Selecting EEG, EOG and ECG channels\nx = raw_eeg.plot(duration=10,n_channels=15) # Tweak duration & number of channels","d38ccd5a":"plt.figure(figsize=(10,10))\nraw_eeg = raw.copy()\nraw_eeg.pick_types(meg=False, eeg=True, eog=True, ecg=True) \nx = raw_eeg.plot(duration=40,n_channels=20)","0c269712":"ica_eeg = ICA(n_components=15, random_state=100) #Setup ICA <=======\nica_eeg.fit(raw_eeg) # Run ICA","a0e1ce82":"x = ica_eeg.plot_sources(raw_eeg) # Plot time series\nx = ica_eeg.plot_components() #Plot topographies","71219421":"raw_eeg.load_data()\n\nica_eeg.exclude = [0,1,3,9,10]  # indices chosen based on various plots above <======\n\n# ica.apply() changes the Raw object in-place, so let's make a copy first:\nreconst_raw = raw_eeg.copy()\nica_eeg.apply(reconst_raw)\n\n#Raw\nraw_eeg.plot(show=False)\nplt.suptitle('Raw Time series')\n\n\n#Reconstruced after removing artefactual components\nreconst_raw.plot(show=False)\nplt.suptitle('Cleaned Time series')\nplt.show()\ndel reconst_raw","9bdd5a3b":"## In continuation to my previous notebook, on introduction to PCA and ICA in EEG. \n## https:\/\/www.kaggle.com\/tarunchilkur\/ica-for-eeg\n## In this notebook, we will look at how individual artifacts look in real life and how rejecting them changes our output.\n## For this we will be going with MNE package and using their sample dataset.","3daf7009":"## When we increase the number of components in the ICA and PCA, we are able to see more topo-plots and we can decide the artifacts more effectively, but more number of components does not mean more accuracy. We can increase the number of components to cross check out analysis. for eg, in the case of EEG, if we increase the number of components we are able to see some topo-plots being similiar to before.","1c18badc":"\n# Running ICA\n\n- https:\/\/mne.tools\/stable\/generated\/mne.preprocessing.ICA.html","f15d4081":"## In the case of EEG the EOG and EEG artifacts are activated in all the topo-plots even if we increase the number of components in the ICA and PCA, due to them being active throughout the experiment","788db34d":"## In the above plots we have tweaked the duration and number of electrodes, as we can see there is a lot of interference from unwanted sources, we will now eliminate these. ","67615122":"# Plotting the raw data \n## The Vertical is the signal from each electrodes, and the horizontal is the timestamp.","f2e27555":"## From the above analysis we can see that the elimination of artifacts from the EEG data, there is a significant change in the signal.","8100914f":"# Drop artefactual components","29f6e95a":"This is a sample dataset provided by MNE. \n- In this experiment, checkerboard patterns were presented to the subject into the left and right visual field, interspersed by tones to the left or right ear. The interval between the stimuli was 750 ms. Occasionally a smiley face was presented at the center of the visual field. The subject was asked to press a key with the right index finger as soon as possible after the appearance of the face.\n- EEG data from a 60-channel electrode cap was acquired simultaneously with the MEG\n- For first part we are using only EEG data ( along with EOG and ECG channels recorded)\n- The second part has code to work with MEG data\n\nLink to the description - https:\/\/mne.tools\/stable\/overview\/datasets_index.html#sample","47670848":"# Artifact Rejection using ICA "}}