{"cell_type":{"4ba51f48":"code","39b5c9bc":"code","d604eb9d":"code","d25f7cd0":"code","03ef8b45":"code","e4dda38c":"code","26321d79":"code","7ab1152c":"code","14720493":"code","06eb3f63":"code","7101fa19":"code","d92b902e":"code","c8b6ecbb":"code","8e7edb9c":"code","4e31dc69":"code","2c058b39":"code","9247a00a":"code","f6a40af6":"code","59da9a29":"code","b0b39d9e":"code","5dac61bf":"code","c819c941":"code","1dde647e":"code","3753a238":"code","d4c0a2e3":"code","b784eac7":"code","79f283b7":"code","d1ca5570":"code","ddabe504":"code","faf2ec59":"code","6d31cfe7":"code","1f601e7b":"markdown"},"source":{"4ba51f48":"import numpy as np\nimport pandas as pd\nimport tensorflow as tf\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport sklearn.metrics as metrics","39b5c9bc":"'''import os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))'''","d604eb9d":"import cv2","d25f7cd0":"path_train = '\/kaggle\/input\/identify-the-apparels-computer-vision\/train_LbELtWX\/train\/' \npath_test = '\/kaggle\/input\/identify-the-apparels-computer-vision\/test_ScVgIM0\/test\/' ","03ef8b45":"X_train=[]\nfor i in range(0,60000):\n        i=i+1\n        im = cv2.imread(path_train+'\/'+str(i)+\".png\")\n        im = cv2.cvtColor(im,cv2.COLOR_BGR2GRAY)\n        X_train.append(im)","e4dda38c":"X_test=[]\nfor i in range(60000,70000):\n        i=i+1\n        im = cv2.imread(path_test+'\/'+str(i)+\".png\")\n        im = cv2.cvtColor(im,cv2.COLOR_BGR2GRAY)\n        X_test.append(im)","26321d79":"len(X_train)","7ab1152c":"len(X_test)","14720493":"X_train = np.array(X_train) \nX_train.shape","06eb3f63":"X_test = np.array(X_test) \nX_test.shape","7101fa19":"y_train = pd.read_csv('\/kaggle\/input\/identify-the-apparels-computer-vision\/train_LbELtWX\/train.csv')\ny_train.head()","d92b902e":"y_train = y_train['label']\ny_train = np.array(y_train)","c8b6ecbb":"y_train.shape","8e7edb9c":"y_train[0:5]","4e31dc69":"classes = ['T-shirt\/top','Trouser', 'Pullover', 'Dress', 'Coat', 'Sandal', 'Shirt', 'Sneaker', 'Bag', 'Ankle boot']\nclasses","2c058b39":"plt.imshow(X_train[0])","9247a00a":"# defining function to display images\n\ndef plot_sample(X, y, index):\n    plt.figure(figsize=(15,2))\n    plt.imshow(X[index])\n    plt.xlabel(classes[y[index]])","f6a40af6":"for i in range(0,20):\n    plot_sample(X_train, y_train, i)\n    plt.show()","59da9a29":"# Normalizing train and test\nX_train = X_train\/255\nX_test= X_test\/255","b0b39d9e":"#reshaping to add third dimension\nX_train = X_train.reshape(-1,28,28,1)\nX_train.shape","5dac61bf":"X_test = X_test.reshape(-1,28,28,1)\nX_test.shape","c819c941":"cnn = tf.keras.models.Sequential()\n\n# adding CNN layers to the Neural Network\n# CNN layer 1\ncnn.add(tf.keras.layers.Conv2D(input_shape = (28, 28, 1), filters=64, kernel_size=(3,3), strides=(1,1), activation='relu'))   \ncnn.add(tf.keras.layers.MaxPooling2D((2,2)))\n# CNN layer 2\ncnn.add(tf.keras.layers.Conv2D(filters=64, kernel_size=(3,3), strides=(1,1), activation='relu'))   \ncnn.add(tf.keras.layers.MaxPooling2D((2,2)))\n\n# adding dense layers to the Neural Network\ncnn.add(tf.keras.layers.Flatten())  \ncnn.add(tf.keras.layers.Dense(64, activation='relu'))  \ncnn.add(tf.keras.layers.Dense(32, activation='relu'))\ncnn.add(tf.keras.layers.Dense(10, activation='softmax'))","1dde647e":"cnn.compile(optimizer='adam', loss='sparse_categorical_crossentropy', metrics=['accuracy']) ","3753a238":"cnn.fit(X_train, y_train, epochs=10)","d4c0a2e3":"y_pred = cnn.predict(X_test)","b784eac7":"y_classes = [np.argmax(i) for i  in y_pred]\ny_classes[0:5]","79f283b7":"# create submission file","d1ca5570":"sample = pd.read_csv('..\/input\/identify-the-apparels-computer-vision\/sample_submission_I5njJSF.csv')\nsample = sample.id","ddabe504":"submit = pd.DataFrame({'id':sample, 'label':y_classes})\nsubmit.to_csv(\"Apparel_Identification_CV_CNN.csv\", index = False)","faf2ec59":"submit.head()","6d31cfe7":"for i in range(0,20):\n    plot_sample(X_test, submit.label, i)\n    plt.show()","1f601e7b":"# CNN"}}