{"cell_type":{"58f29d35":"code","c20356bc":"code","0e776808":"code","f97c4001":"code","77f31a90":"code","dff6d345":"code","e02a3f06":"code","599b6e2c":"code","ac0134a4":"code","0767477b":"code","d87bc622":"code","46c513ed":"code","1b9ac0cb":"code","10317b2c":"code","3e1fda11":"code","6da5ea9c":"code","a9b772e3":"code","12cd49c2":"code","fc832db8":"code","f1841100":"code","42376a46":"code","d0a363bb":"code","d1ffff6f":"code","f1712cf0":"code","240a8568":"code","d3f7f711":"code","30118925":"code","4cb9b499":"code","4dab546d":"code","5140342e":"code","02b8d713":"code","6213103d":"code","e5eb032c":"code","9479d177":"markdown","92878102":"markdown"},"source":{"58f29d35":"import os\nfrom os import listdir","c20356bc":"base_path = \"..\/input\/plantvillage\/PlantVillage\/\"","0e776808":"os.listdir(base_path)","f97c4001":"len(os.listdir(base_path))","77f31a90":"from glob import glob\nimagePatches = glob(\"..\/input\/plantvillage\/PlantVillage\/*\/*.*\", recursive=True)","dff6d345":"len(imagePatches)","e02a3f06":"imagePatches[0:10]","599b6e2c":"image_path = \"..\/input\/plantvillage\/PlantVillage\/Tomato_Bacterial_spot\/3a5a5fef-8a3a-4f70-ab85-eaf5e3ecf6f2___GCREC_Bact.Sp 3449.JPG'\"","ac0134a4":"dir_name = os.path.dirname(image_path)","0767477b":"len(dir_name.split(\"\/\"))","d87bc622":"dir_name.split(\"\/\")[4]","46c513ed":"from fastai import *\nfrom fastai.vision import *\n\nimport numpy as np \nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom sklearn.metrics import auc,roc_curve\n\nfrom math import floor","1b9ac0cb":"path = Path(base_path)","10317b2c":"path","3e1fda11":"directory_root = '..\/input\/plantvillage\/'","6da5ea9c":"image_list, label_list = [], []\ntry:\n    print(\"[INFO] Loading images ...\")\n    root_dir = listdir(directory_root)\n    for directory in root_dir :\n        # remove .DS_Store from list\n        if directory == \".DS_Store\" :\n            root_dir.remove(directory)\n\n    for plant_folder in root_dir :\n        plant_disease_folder_list = listdir(f\"{directory_root}\/{plant_folder}\")\n        \n        for disease_folder in plant_disease_folder_list :\n            # remove .DS_Store from list\n            if disease_folder == \".DS_Store\" :\n                plant_disease_folder_list.remove(disease_folder)\n\n        for plant_disease_folder in plant_disease_folder_list:\n            print(f\"[INFO] Processing {plant_disease_folder} ...\")\n            plant_disease_image_list = listdir(f\"{directory_root}\/{plant_folder}\/{plant_disease_folder}\/\")\n                \n            for single_plant_disease_image in plant_disease_image_list :\n                if single_plant_disease_image == \".DS_Store\" :\n                    plant_disease_image_list.remove(single_plant_disease_image)\n\n            for image in plant_disease_image_list[:200]:\n                image_directory = f\"{directory_root}\/{plant_folder}\/{plant_disease_folder}\/{image}\"\n                if image_directory.endswith(\".jpg\") == True or image_directory.endswith(\".JPG\") == True:\n                    image_list.append(image_directory)\n                    label_list.append(plant_disease_folder)\n    print(\"[INFO] Image loading completed\")  \nexcept Exception as e:\n    print(f\"Error : {e}\")","a9b772e3":"image_list[0:10]","12cd49c2":"tfms=get_transforms(flip_vert=True, max_warp=0., max_zoom=0., max_rotate=0.)","fc832db8":"def get_labels(file_path): \n    dir_name = os.path.dirname(file_path)\n    split_dir_name = dir_name.split(\"\/\")\n    dir_levels = len(split_dir_name)\n    label  = split_dir_name[dir_levels - 1]\n    return(label)","f1841100":"data = ImageDataBunch.from_name_func(path, image_list, label_func=get_labels,  size=96, \n                                     bs=64,num_workers=2,ds_tfms=tfms\n                                  ).normalize()","42376a46":"data.show_batch(rows=3, figsize=(8,8))","d0a363bb":"learner= cnn_learner(data, models.densenet121, metrics=[accuracy], model_dir='\/tmp\/models\/')","d1ffff6f":"learner.lr_find()\nlearner.recorder.plot()","f1712cf0":"lr=1e-1\nlearner.fit_one_cycle(1, lr)","240a8568":"learner.save('model-1')","d3f7f711":"learner.unfreeze()","30118925":"learner.lr_find()\nlearner.recorder.plot()","4cb9b499":"learner.fit_one_cycle(5,slice(1e-5,1e-3))","4dab546d":"learner.save('model-2')\nlearner.load('model-2')","5140342e":"learner.fit_one_cycle(80,slice(3e-5,3e-3))","02b8d713":"learner.recorder.plot_losses()","6213103d":"conf= ClassificationInterpretation.from_learner(learner)\nconf.plot_confusion_matrix(figsize=(10,8))","e5eb032c":"predictions,labels = learner.get_preds(ds_type=DatasetType.Valid)\n\npredictions = predictions.numpy()\nlabels = labels.numpy()\n\npredicted_labels = np.argmax(predictions, axis = 1)\nprint((predicted_labels == labels ).sum().item()\/ len(predicted_labels))","9479d177":"# Image Processing using fastai","92878102":"# Understanding the data and the data layout"}}