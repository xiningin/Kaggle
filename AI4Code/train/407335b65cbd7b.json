{"cell_type":{"4a2cdbe0":"code","84b4bdfe":"code","e471bc49":"code","91f4066a":"code","96d5d6bb":"code","d37d8f78":"code","077ba92c":"code","fe8cb00f":"code","c0a0fafa":"code","b015aca2":"code","d7cd1181":"code","d584702e":"code","59d55b3b":"code","e1244dee":"code","2cdf12a7":"code","ac75288d":"code","8c91f891":"code","2b8666bf":"code","fb7bb2ba":"code","97ccc816":"code","99bce469":"code","1404b438":"code","c348bd91":"code","1c035e57":"code","72945872":"code","22f9e301":"code","68e0af98":"code","09587c5d":"code","13d11316":"code","88b32c36":"code","b3206c8a":"code","5afb9803":"code","082f6f2d":"code","303a005f":"code","b58b2d67":"code","c8e39823":"code","3eee57d7":"code","9bb2ef89":"code","6157456f":"code","cd74565d":"code","ce3535a4":"code","26a17f70":"code","5042663d":"code","aa3aab8c":"code","d03dd9a0":"code","dccdf366":"code","4a4e2589":"code","21b9b9f8":"code","4ec19cb5":"code","768cb6fe":"code","27ce61b9":"code","06ec77f4":"code","d1d931af":"code","e6664bf4":"code","c4927a89":"markdown","376b1f5c":"markdown","527e7a6b":"markdown","8d2a7f48":"markdown","bef5b4b0":"markdown","f45b6a2b":"markdown","e3a08e30":"markdown","495d8783":"markdown","956eec0d":"markdown","aaca1b16":"markdown","c7ae052b":"markdown","60492b5f":"markdown","0afb4885":"markdown"},"source":{"4a2cdbe0":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","84b4bdfe":"#Data Visualization\nimport seaborn as sns\nimport plotly.express as px\nimport plotly.graph_objects as go\nimport matplotlib.pyplot as plt\nimport cufflinks as cf\nimport plotly.offline\ncf.go_offline()\ncf.set_config_file(offline=False, world_readable=True)\n\n\n%matplotlib inline\nimport warnings\nwarnings.filterwarnings('ignore')\n\n#Machine Learning \nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import RandomForestClassifier\n\n#Spliting the Data\nfrom sklearn.model_selection import train_test_split\n\n#Standard Scaler\nfrom sklearn.preprocessing import StandardScaler\n\n#Model Prediction\nfrom sklearn.metrics import classification_report,confusion_matrix,roc_curve,auc\nfrom sklearn.model_selection import cross_val_score","e471bc49":"data = pd.read_csv(\"\/kaggle\/input\/heart-disease-uci\/heart.csv\")\ndata.head()","91f4066a":"data.info()","96d5d6bb":"data.describe()","d37d8f78":"data.isna().any()","077ba92c":"sns.pairplot(data=data)","fe8cb00f":"#get correlations of each features in dataset\ncorrmat = data.corr()\ntop_corr_features = corrmat.index\nplt.figure(figsize=(20,20))\n#plot heat map\ng=sns.heatmap(data[top_corr_features].corr(),annot=True,cmap=\"RdYlGn\")","c0a0fafa":"data.hist(figsize=(20,20))","b015aca2":"sns.countplot(x='target',data=data, palette = \"coolwarm_r\")","d7cd1181":"pd.set_option('display.max_rows',None)\nprint(data.age)","d584702e":"print(\"Min Age:\",data.age.min(),\", Max Age:\",data.age.max())","59d55b3b":"fig = px.pie(data, values='target', names='age', title='Total no of targets based on Age')\nfig.update_traces(textposition='inside')\nfig.show()","e1244dee":"data[\"Male\"]=data[data[\"sex\"]==1][\"age\"]\ndata[\"Female\"]=data[data[\"sex\"]==0][\"age\"]\ndata[[\"Male\",\"Female\"]].iplot(kind=\"histogram\", bins=20, theme=\"white\", title=\"Heart Patient Ages based on sex\",\n         xTitle='Ages', yTitle='Count')","2cdf12a7":"desease_sex = data[data['target']==1]['sex'].value_counts()\nnot_desease_sex= data[data['target']==0]['sex'].value_counts()\ndf1 = pd.DataFrame([desease_sex,not_desease_sex])\ndf1.index = ['Diagnose','Not Diagnose']\ndf1.iplot(kind='bar',barmode='stack', title='Diagnose or Not with heart desease by the Sex')","ac75288d":"sns.countplot(x='cp',data=data, palette = \"coolwarm_r\")","8c91f891":"pd.crosstab(data.age,data.target).plot(kind=\"bar\",figsize=(20,6))\nplt.title('Heart Disease Frequency for Ages')\nplt.xlabel('Age')\nplt.ylabel('Frequency')\nplt.show()","2b8666bf":"pd.crosstab(data.cp,data.target).plot(kind=\"bar\",figsize=(15,6))\nplt.title('Heart Disease Frequency for Chest Pain Type')\nplt.xlabel('Chest Pain Type')\nplt.ylabel('Frequency')\nplt.show()","fb7bb2ba":"pd.crosstab(data.thalach,data.target).plot(kind=\"bar\",figsize=(20,6))\nplt.title('Heart Disease Frequency for Maximum Heart Rate Achieved')\nplt.xlabel('Maximum Heart Rate Achieved')\nplt.ylabel('Frequency')\nplt.show()","97ccc816":"df = pd.get_dummies(data, columns = ['sex', 'cp', 'fbs', 'restecg', 'exang', 'slope', 'ca', 'thal'])","99bce469":"standardScaler = StandardScaler()\ncolumns_to_scale = ['age', 'trestbps', 'chol', 'thalach', 'oldpeak']\ndf[columns_to_scale] = standardScaler.fit_transform(df[columns_to_scale])","1404b438":"df.head()","c348bd91":"y = df['target']\nX = df.drop(['target','Male','Female'], axis = 1)","1c035e57":"y.head()","72945872":"#ROC Curve\ndef rocCurve(model):\n    y_prob = model.predict_proba(X_test)[:,1]\n    fpr, tpr, thr = roc_curve(y_test, y_prob)\n    lw = 2\n    plt.figure(figsize=(8, 6))\n    plt.plot(fpr, tpr, \n          color='darkorange', \n          lw=lw, \n          label=\"Curve Area = %0.3f\" % auc(fpr, tpr))\n    plt.plot([0, 1], [0, 1], color='green', \n                 lw=lw, linestyle='--')\n    plt.xlabel('False Positive Rate')\n    plt.ylabel('True Positive Rate')\n    plt.title('Receiver Operating Characteristic Plot')\n    plt.legend(loc=\"lower right\")\n    plt.show()","22f9e301":"X_train, X_test, y_train, y_test = train_test_split(X,y,test_size=0.30)","68e0af98":"accuracy_rate = []\nfor k in range(1,21):\n    knn_classifier = KNeighborsClassifier(n_neighbors = k)\n    knn_accuracy_score=cross_val_score(knn_classifier,X,y,cv=10)\n    accuracy_rate.append(round(knn_accuracy_score.mean()*100,2))","09587c5d":"print(accuracy_rate)","13d11316":"error_rate = []\nfor k in range(1,21):\n    knn_classifier = KNeighborsClassifier(n_neighbors = k)\n    knn_error_score=cross_val_score(knn_classifier,X,y,cv=10)\n    error_rate.append(round(1- knn_error_score.mean(),2))","88b32c36":"print(error_rate)","b3206c8a":"plt.figure(figsize=(10,6))\n#plt.plot(range(1,21),error_rate,color='blue', linestyle='dashed', marker='o',\n         #markerfacecolor='red', markersize=10)\nplt.plot(range(1,21),accuracy_rate,color='blue', linestyle='dashed', marker='o',\n         markerfacecolor='red', markersize=10)\nplt.title('Error Rate vs. K Value')\nplt.xlabel('K')\nplt.ylabel('Error Rate')","5afb9803":"plt.figure(figsize=(20,6))\nplt.plot([k for k in range(1, 21)], accuracy_rate, color = 'blue', linestyle='dashed', marker='o',markerfacecolor='red')\nfor i in range(1,21):\n    plt.text(i, accuracy_rate[i-1], (i, accuracy_rate[i-1]))\nplt.xticks([i for i in range(1, 21)])\nplt.xlabel('Number of Neighbors (K)')\nplt.ylabel('Scores')\nplt.title('K Neighbors Classifier scores for different K values')","082f6f2d":"knn = KNeighborsClassifier(n_neighbors=1)\n\nknn.fit(X_train,y_train)\nknn_pred = knn.predict(X_test)\n\nprint('K=1')\nprint(classification_report(y_test,knn_pred))","303a005f":"plt.figure(figsize=(5, 5))\nsns.heatmap(confusion_matrix(y_test,knn_pred), square=True, \n                    cmap=\"Greens\",\n                    annot=True, \n                    cbar=False, \n                    xticklabels=[\"Haven't Disease\", \"Have Disease\"], \n                    yticklabels=[\"Haven't Disease\",\"Have Disease\"])\nplt.title(\"Confusion Matrix With K =1\")\nplt.xlabel('Predicted Values')\nplt.ylabel('True Values');\nplt.show();","b58b2d67":"# NOW WITH K=10\nknn_classifier = KNeighborsClassifier(n_neighbors=12)\nknn_score=cross_val_score(knn_classifier,X,y,cv=10)\n\nknn_classifier.fit(X_train,y_train)\nknn_y_pred = knn_classifier.predict(X_test)\n\nprint('K=10')\nprint(classification_report(y_test,knn_y_pred))","c8e39823":"plt.figure(figsize=(5, 5))\nsns.heatmap(confusion_matrix(y_test,knn_y_pred), square=True, \n                    cmap=\"Purples\",\n                    annot=True, \n                    cbar=False, \n                    xticklabels=[\"Haven't Disease\", \"Have Disease\"], \n                    yticklabels=[\"Haven't Disease\",\"Have Disease\"])\nplt.title(\"Confusion Matrix With K =10\")\nplt.xlabel('Predicted Values')\nplt.ylabel('True Values');\nplt.show();","3eee57d7":"knn_accuracy_score= round(knn_score.mean()*100,2)\nknn_accuracy_score","9bb2ef89":"#ROC Curve\nrocCurve(knn_classifier)","6157456f":"randomforest_classifier= RandomForestClassifier(n_estimators=10,random_state=1)\nrdm_score=cross_val_score(randomforest_classifier,X,y,cv=10)","cd74565d":"rdm_accuracy = round(rdm_score.mean()*100,2)\nrdm_accuracy","ce3535a4":"randomforest_classifier.fit(X_train,y_train)\nrfc_y_pred = randomforest_classifier.predict(X_test)\nprint(classification_report(y_test,rfc_y_pred))","26a17f70":"plt.figure(figsize=(5, 5))\nsns.heatmap(confusion_matrix(y_test,rdf_y_pred), square=True, \n                    cmap=\"Oranges\",\n                    annot=True, \n                    cbar=False, \n                    xticklabels=[\"Haven't Disease\", \"Have Disease\"], \n                    yticklabels=[\"Haven't Disease\",\"Have Disease\"])\nplt.title(\"Random Forrest Confusion Matrix\")\nplt.xlabel('Predicted Values')\nplt.ylabel('True Values');\nplt.show();","5042663d":"rocCurve(randomforest_classifier)","aa3aab8c":"from sklearn.svm import SVC\nsvc = SVC(C=5, probability=True)\nscore_svc = cross_val_score(svc,X,y,cv=10)","d03dd9a0":"svc_accuracy = round(score_svc.mean()*100,2)\nsvc_accuracy","dccdf366":"svc.fit(X_train,y_train)\nsvc_y_pred = svc.predict(X_test)\nprint(classification_report(y_test,svc_y_pred))","4a4e2589":"plt.figure(figsize=(5, 5))\nsns.heatmap(confusion_matrix(y_test,svc_y_pred), square=True, \n                    cmap=\"Pastel1\",\n                    annot=True, \n                    cbar=False, \n                    xticklabels=[\"Haven't Disease\", \"Have Disease\"], \n                    yticklabels=[\"Haven't Disease\",\"Have Disease\"])\nplt.title(\"SVC Confusion Matrix\")\nplt.xlabel('Predicted Values')\nplt.ylabel('True Values');\nplt.show();","21b9b9f8":"#ROC Curve\nrocCurve(svc)","4ec19cb5":"decisiontree_classifier = DecisionTreeClassifier(random_state=0)\ndtc_score=cross_val_score(decisiontree_classifier,X,y,cv=10)","768cb6fe":"dtc_accuracy = round(dtc_score.mean()*100,2)\ndtc_accuracy","27ce61b9":"decisiontree_classifier.fit(X_train,y_train)\ndtc_y_pred = decisiontree_classifier.predict(X_test)\nprint(classification_report(y_test,dtc_y_pred))","06ec77f4":"plt.figure(figsize=(5, 5))\nsns.heatmap(confusion_matrix(y_test,dtc_y_pred), square=True, \n                    cmap=\"BuGn\",\n                    annot=True, \n                    cbar=False, \n                    xticklabels=[\"Haven't Disease\", \"Have Disease\"], \n                    yticklabels=[\"Haven't Disease\",\"Have Disease\"])\nplt.title(\"Decision Tree Confusion Matrix\")\nplt.xlabel('Predicted Values')\nplt.ylabel('True Values');\nplt.show();","d1d931af":"#ROC Curve\nrocCurve(decisiontree_classifier)","e6664bf4":"names=[\"KNN\",\"Random Forest\",\"Decesion Tree\",\"SVC\"]\naccs =[knn_accuracy_score,rdm_accuracy,dtc_accuracy,svc_accuracy]\nsns.set_style(\"whitegrid\")\nplt.figure(figsize=(8,6))\nplt.ylabel(\"Accuracy\")\nplt.xlabel(\"Algorithms\")\nsns.barplot(x=names, y=accs)\nplt.show()","c4927a89":"Side by Side Graphs for Age,Chest Pain Type,Maximum Heart Rate Achieved with Respect to Target","376b1f5c":"Checking for Null Values","527e7a6b":"**Data Processing**","8d2a7f48":"Droping the Extra Coulmns and creating the Predictors ","bef5b4b0":"# **KNN Model**","f45b6a2b":"# **Model Processing**","e3a08e30":"# **RandomForestClassifier**","495d8783":"# **Data Visualization**","956eec0d":"# **SVC**","aaca1b16":"From above plot we can see the accuracy of score is good when k value is 10, 9, 12. So we can choose any value from these three values to calculate the Score for KNN Model.","c7ae052b":"Data looks like 40 60 propotion. So i am treating it as Balanced Data set.","60492b5f":"**Checking Dataset is a Balanced Dataset or Imbalanced Dataset**","0afb4885":"# **Feature Selection**"}}