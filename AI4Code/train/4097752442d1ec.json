{"cell_type":{"b251497c":"code","66df30ee":"code","f9096f79":"code","4ea45367":"code","fdc43e1e":"code","206b4424":"code","7c509261":"code","d68138fc":"code","672301d8":"code","5c26856d":"code","f7aef580":"code","aaa0c916":"code","744976aa":"code","a270f88c":"code","ef4b79f9":"code","020d3a78":"code","a46506c1":"code","179b720b":"code","1e8cadbb":"code","ccb2184d":"code","4fdf5f44":"code","58f239e8":"code","23978bc8":"code","08646650":"code","51a14ee6":"code","c7fc4bec":"code","0781e9e6":"code","6e5e0357":"code","01da3563":"code","d3910f05":"code","9f9a9657":"code","d3d7b1e3":"code","60bbea06":"code","41b67430":"code","b6eda618":"code","1979d832":"markdown","11baaa06":"markdown","778dab9f":"markdown","908758c1":"markdown","c8b48f80":"markdown","10140f6c":"markdown","5be2be7d":"markdown","73697ee2":"markdown","a9c90734":"markdown","7ec3397b":"markdown","5c55e583":"markdown","9c3ce54e":"markdown","e6476681":"markdown","150ed80f":"markdown","8ad890c3":"markdown","16755a6b":"markdown","96168d00":"markdown","33b66d40":"markdown"},"source":{"b251497c":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","66df30ee":"# Import Dataset\n\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","f9096f79":"# Read Data\n\ndf_wine =  pd.read_csv('\/kaggle\/input\/wine-quality\/winequalityN.csv')","4ea45367":"# shape of data\n\ndf_wine.shape","fdc43e1e":"# information of columns\n\ndf_wine.info()","206b4424":"df_wine.head()","7c509261":"# summary stat\n\ndf_wine.describe()","d68138fc":"# checking for missing values\n\ndf_wine.isnull().sum()","672301d8":"df_wine.dropna().shape","5c26856d":"df = df_wine.dropna()\ndf.isnull().sum()","f7aef580":"sns.countplot(df['quality'])\nplt.show()","aaa0c916":"df_wine['quality'].value_counts()","744976aa":"plt.bar(df['quality'],df['alcohol'])\nplt.xlabel('quality')\nplt.ylabel('alcohol')\nplt.show()","a270f88c":"plt.tight_layout()\ndf_wine.hist(bins = 100, figsize = (10,12))\nplt.show()","ef4b79f9":"plt.figure(figsize = (12,8))\nsns.heatmap(df.corr(), annot = True)\nplt.show()","020d3a78":"df_wine = df.drop('total sulfur dioxide',axis=1)","a46506c1":"df_wine.isnull().sum()","179b720b":"df_wine = pd.get_dummies(df_wine,drop_first=True)","1e8cadbb":"df_wine.head()","ccb2184d":"#importing module\nfrom sklearn.preprocessing import MinMaxScaler\n# creating normalization object \nnorm = MinMaxScaler()\n# fit data\nnorm_fit = norm.fit(df_wine)\ndf_scaled = norm_fit.transform(df_wine)\n#new_xtest = norm_fit.transform(x_test)\n# display values\nprint(df_scaled)\n ","4fdf5f44":"from sklearn.preprocessing import MinMaxScaler\n\nnrm = MinMaxScaler()\n\n# fit the scale\nnorm_fit = nrm.fit(df_wine)\n\n# transformation of training data\nscaled_df = norm_fit.transform(df_wine)\nprint(scaled_df)","58f239e8":"df_new = pd.DataFrame(scaled_df,columns=['fixed acidity','volatile acidity','citric acid','residual sugar','chlorides','free sulfur dioxide','density','pH','sulphates','alcohol','quality','best quality'])","23978bc8":"df_new.head()","08646650":"from sklearn.model_selection import train_test_split","51a14ee6":"x = df_new.drop(['quality','best quality'],axis=1)\ny = df_new['best quality']\n\nX_train,X_test,y_train,y_test = train_test_split(x,y,test_size=0.3,random_state=10)","c7fc4bec":"from sklearn.linear_model import LogisticRegression\nfrom sklearn.metrics import classification_report, confusion_matrix","0781e9e6":"lr = LogisticRegression()\nlr.fit(X_train, y_train)","6e5e0357":"y_pred = lr.predict(X_test)\ny_pred_prob = lr.predict_proba(X_test)[:,1]","01da3563":"conf_mat = confusion_matrix(y_test, y_pred)\nconf_mat","d3910f05":"cr = classification_report(y_test, y_pred)\nprint(cr)","9f9a9657":"from sklearn.ensemble import RandomForestClassifier\nrf = RandomForestClassifier(random_state = 1)\nrf.fit(X_train, y_train)\n\ny_pred_rf = rf.predict(X_test)","d3d7b1e3":"conf_mat = confusion_matrix(y_test, y_pred)\nconf_mat","60bbea06":"cr = classification_report(y_test, y_pred_rf)\nprint(cr)","41b67430":"from sklearn.metrics import f1_score, roc_curve, roc_auc_score, precision_score, recall_score, accuracy_score","b6eda618":"roc  =  roc_auc_score(y_test, y_pred)\nacc  =  accuracy_score(y_test, y_pred)\nprec =  precision_score(y_test, y_pred)\nrec  =  recall_score(y_test, y_pred)\nf1   =  f1_score(y_test, y_pred)\n\nroc_rf  =  roc_auc_score(y_test, y_pred_rf)\nacc_rf  =  accuracy_score(y_test, y_pred_rf)\nprec_rf =  precision_score(y_test, y_pred_rf)\nrec_rf  =  recall_score(y_test, y_pred_rf)\nf1_rf   =  f1_score(y_test, y_pred_rf)\n\nmodel= pd.DataFrame([['Logistic Regression', acc, prec, rec, f1, roc],\n                      ['Random Forest Classifier', acc_rf, prec_rf, rec_rf, f1_rf, roc_rf]],\n                      columns = ['Model', 'Accuracy', 'Precision', 'Recall', 'F1 Score','ROC'])\nmodel\n                                                               ","1979d832":"#### Splitting data into train test split","11baaa06":"- the quality of alcohol increases with increase in alcohol content.","778dab9f":"- the count of each feature differs which describes presence of missing values\n- there is a larger gap between the 75th percentile and max for features like  residual sugar,free sulfur dioxide & total sulfur dioxide\n- on an average the quality of wine is found to be 5.81 and the average alcohol content in wine is 10.49\n- the volatile acidity and citric acid of wine has similar range(0.00, 1.6)\n- almost negligible variation is found in density","908758c1":"#### Min-Max Normalization","c8b48f80":"### Understanding the wine data columns\n\n#### 1. fixed acidity\nmost acids involved with wine or fixed or nonvolatile (do not evaporate readily)\n\n#### 2. volatile acidity\nthe amount of acetic acid in wine, which at too high of levels can lead to an unpleasant, vinegar taste\n\n#### 3. citric acid\nfound in small quantities, citric acid can add \u2018freshness\u2019 and flavor to wines\n\n#### 4. residual sugar\nthe amount of sugar remaining after fermentation stops, it\u2019s rare to find wines with less than 1 gram\/liter and wines with greater than 45 grams\/liter are considered sweet\n\n#### 5. chlorides \nthe amount of salt in the wine\n\n#### 6. free sulfur dioxide\nthe free form of SO2 exists in equilibrium between molecular SO2 (as a dissolved gas) and bisul-fite ion; it prevents microbial growth and the oxidation of wine\n\n#### 7. total sulfur dioxide\namount of free and bound forms of S02; in low concentrations, SO2 is mostly undetectable in wine, but at free SO2 concentrations over 50 ppm, SO2 becomes evident in the nose and taste of wine\n\n#### 8. density\nthe density of water is close to that of water depending on the percent alcohol and sugar con-tent\n\n#### 9. pH\ndescribes how acidic or basic a wine is on a scale from 0 (very acidic) to 14 (very basic); most wines are between 3\u20134 on the pH scale\n\n#### 10. sulphates\na wine additive which can contribute to sulfur dioxide gas (S02) levels, which acts as an antimicrobial and antioxidant\n\n#### 11. alcohol\nthe percent alcohol content of the wine\n\n#### 12. quality\noutput variable (based on sensory data, score between 0 and 10)","10140f6c":"- we observe the presence of missing values in the data\n- since the missing value are few,\n- we can drop them and this wouldn't affect the further process.","5be2be7d":"#### Comparision of quality of alcohol and alcohol content","73697ee2":"### Exploratory Data Analysis","a9c90734":"#### Logistic Regression","7ec3397b":"- 1 represents the quality greater than 0.7 which is considered in good quality wine \n- 0 represents the quality below 0.7 which is not a good quality wine. \n- Both model predicts the quality of white wine with an accuracy of 98% and 99%.","5c55e583":"### Model Building","9c3ce54e":"- the count of Quality of wine is max at 6 and count is 2836\n- the quality of wine most preffered has quality \"6\"","e6476681":"#### One Hot Encoding","150ed80f":"- We plan to Normalize by scaling our data because the features  range high, so this technique could help to balance the ranges of data between 0 and 1. ","8ad890c3":"- total sulphur dioxide has higher correlation we can retain or discard the column","16755a6b":"- There are 6497 rows and 13 columns","96168d00":"### Analysis of quality of wine","33b66d40":"#### Random Forest Classifier"}}