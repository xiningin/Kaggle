{"cell_type":{"4c484904":"code","8ee7f814":"code","88357bcc":"code","29d36dd8":"code","e8a3b3ad":"code","217633bd":"code","ce03d91b":"code","f92a2555":"code","a4bbe048":"code","52e2dc03":"code","e84aa27d":"code","e33c727e":"code","e07f02bd":"code","2a56bec9":"code","d61763cc":"code","8c079ea6":"code","1ca22537":"code","fffe40d0":"code","08a0150b":"code","1c575d5e":"code","f3d159bc":"markdown","71031016":"markdown","70a767ef":"markdown","29f2db38":"markdown","a654efa8":"markdown","6f5fc411":"markdown","0cd98a34":"markdown","c42f59c6":"markdown","5ded06db":"markdown","fa7850cf":"markdown","0d418276":"markdown","4136f7f1":"markdown","ee1be86b":"markdown","40b12332":"markdown","6862ff5d":"markdown","1463778c":"markdown"},"source":{"4c484904":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n\nfrom kaggle.competitions import twosigmanews\n\n# Read data but just once\nif 'env' not in globals():\n    env = twosigmanews.make_env()\n    (market_train_df, news_train_df) = env.get_training_data()","8ee7f814":"df = market_train_df[[\n    'time',\n    'assetCode',\n    'open',\n    'returnsOpenPrevRaw1', \n    'returnsOpenPrevMktres1',\n    'returnsOpenNextMktres10',\n]].copy()\ndf = df[~df.returnsOpenPrevMktres1.isnull() & ~df.returnsOpenPrevRaw1.isnull()]","88357bcc":"df['returnsOpenPrevMktres1_abs'] = df['returnsOpenPrevMktres1'].abs()\ndf['returnsOpenPrevMktres1_abs_min'] = df.groupby('time').returnsOpenPrevMktres1_abs.transform('min')","29d36dd8":"df_min = df[df.returnsOpenPrevMktres1_abs == df.returnsOpenPrevMktres1_abs_min]","e8a3b3ad":"df_min.head()","217633bd":"(df_min.groupby('time').size()==1).all()","ce03d91b":"df_min.groupby('time').returnsOpenPrevRaw1.mean().plot(figsize=(15,6))","f92a2555":"for y in df_min.time.dt.year.unique():\n    df_min[df_min.time.dt.year==y].groupby('time').returnsOpenPrevRaw1.mean().plot(title=str(y), figsize=(15,6))\n    plt.show()","a4bbe048":"df_min[(df_min.time>='2016-07-01') & (df_min.time<'2016-08-01')]","52e2dc03":"df_min[df_min.returnsOpenPrevRaw1==0].groupby('assetCode').size().sort_values(ascending=False).head(10)","e84aa27d":"market_train_df[market_train_df.assetCode.isin(['PGN.N', 'EBRYY.OB'])].groupby('assetCode').size()","e33c727e":"market_train_df[market_train_df.assetCode.isin(['PGN.N', 'EBRYY.OB'])].groupby('assetCode').open.nunique()","e07f02bd":"market_train_df[market_train_df.assetCode == 'PGN.N']","2a56bec9":"market_train_df[market_train_df.assetCode == 'EBRYY.OB']","d61763cc":"market_train_df[market_train_df.assetName=='Unknown'].assetCode.unique()","8c079ea6":"df_filtered = df[~df.assetCode.isin(market_train_df[market_train_df.assetName=='Unknown'].assetCode.unique())]\ndf_filtered = df_filtered[df_filtered.assetCode != 'PGN.N']","1ca22537":"df_filtered['returnsOpenPrevMktres1_abs'] = df_filtered['returnsOpenPrevMktres1'].abs()\ndf_filtered['returnsOpenPrevMktres1_abs_min'] = df_filtered.groupby('time').returnsOpenPrevMktres1_abs.transform('min')","fffe40d0":"df_min_filtered = df_filtered[df_filtered.returnsOpenPrevMktres1_abs == df_filtered.returnsOpenPrevMktres1_abs_min]","08a0150b":"df_min_filtered.groupby('time').returnsOpenPrevRaw1.mean().plot(figsize=(15,6))","1c575d5e":"for y in df_min_filtered.time.dt.year.unique():\n    df_min_filtered[df_min_filtered.time.dt.year==y].groupby('time').returnsOpenPrevRaw1.mean().plot(title=str(y), figsize=(15,6))\n    plt.show()","f3d159bc":"Amount of unique open values","71031016":"Let's filter 'Unknown' and PGN.N and plot new data","70a767ef":"Do we have data in July 2016? yes","29f2db38":"How it looks like","a654efa8":"Graphs by year","6f5fc411":"# Filtering strange data","0cd98a34":"Estimation of an average market return used for calculation of returnsOpenPrevMktres1","c42f59c6":"# Graphs","5ded06db":"New Graphs","fa7850cf":"Filtering","0d418276":"Total amount of records of 'PGN.N', 'EBRYY.OB'","4136f7f1":"Sanity check if we have only one row per day","ee1be86b":"# Data Preparation","40b12332":"It looks like EBRYY.OB is an index, lets have a list assets** with 0 returnsOpenPrevRaw1","6862ff5d":"Finding the closes value for **returnsOpenPrevMktres1** - then we may use **returnsOpenPrevRaw1** as an estimation","1463778c":"# Zero plateau analysis"}}