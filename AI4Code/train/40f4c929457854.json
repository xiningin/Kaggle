{"cell_type":{"39a71a7b":"code","8ecea978":"code","f71ad05d":"markdown"},"source":{"39a71a7b":"import numpy as np\nimport cv2\nfrom skimage import segmentation\nfrom matplotlib import pyplot as plt\nimport matplotlib.image as img\n\n\ndef mean_image(image,label):\n    img_reshape = image.reshape((image.shape[0]*image.shape[1],image.shape[2]))\n    sli_1d = np.reshape(label,-1)    \n    uni = np.unique(sli_1d)\n    uu = np.zeros(img_reshape.shape)\n    for i in uni:\n        loc = np.where(sli_1d == i)[0]\n        #print(loc)\n        mm = np.mean(img_reshape[loc,:],axis = 0)\n        uu[loc,:]=mm\n    Superpixeled_Image = np.reshape(uu,[image.shape[0],image.shape[1],image.shape[2]]).astype('uint8')\n    print(Superpixeled_Image.shape)\n    plt.imshow(Superpixeled_Image)\n    plt.title('Superpixeled_Image')\n    return Superpixeled_Image\n    \n    \n    \nimg = img.imread('..\/input\/reference\/12.jpeg')      # Input Image\nconverted_image = cv2.cvtColor(img, cv2.COLOR_BGR2RGB)\nlabel=segmentation.slic(img,compactness=20, n_segments=5000)\n\noutput= mean_image(img,label) # displays the output image.\nGenerated_Image = cv2.cvtColor(output, cv2.COLOR_BGR2RGB)\ncv2.imwrite('generated image.jpg', Generated_Image)\ncv2.imwrite('Input_Image.jpg', converted_image)","8ecea978":"from matplotlib import pyplot as plt\nimport matplotlib.image as img\nimport cv2\n\ndef imshow(image, title=None):\n    if len(image.shape) > 3:\n        image = np.squeeze(image, axis=0)\n\n    plt.imshow(image)\n    if title:\n        plt.title(title)\n\ngenerated_image = img.imread('.\/generated image.jpg')\n\nimshow(generated_image, 'Superpixel Segmentated')","f71ad05d":"# To see the Generated Image"}}