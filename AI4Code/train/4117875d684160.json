{"cell_type":{"a2fb0147":"code","cde90004":"code","5b82c88a":"code","564a02db":"code","501b0063":"code","612db96e":"code","0706d2f7":"code","497c8a5c":"code","5608cf7f":"code","051a8015":"code","ef0b40b2":"code","5ea3b399":"code","fb216873":"code","d487c04b":"code","aa842d5e":"code","4236f492":"code","ff4a6f58":"code","a4657c65":"code","e95f4327":"code","55e77118":"code","09998f7d":"code","cc9a73e7":"code","fc1503f4":"code","3a7a78b9":"code","61a47489":"code","177f2643":"code","81a4030f":"code","30d762b8":"code","1002306f":"code","9797b232":"code","7f781c5c":"code","1584f64e":"code","1baa217a":"code","78267c55":"code","1a09b13d":"code","23c45ae1":"code","83f97628":"code","4ebf4656":"code","91720a68":"code","32cde6eb":"markdown","4c3db67e":"markdown","89774b69":"markdown","59326820":"markdown","c6d410d8":"markdown","a589f434":"markdown","3b43187e":"markdown","caf0bd3a":"markdown","c5ce7c23":"markdown","d099138b":"markdown","70217b00":"markdown","7ec18720":"markdown","69897a80":"markdown","d9021b25":"markdown","66ff7e7c":"markdown","05472d57":"markdown","43c73f87":"markdown","364aedef":"markdown","c85d627d":"markdown","094286c2":"markdown","a0859689":"markdown","59515403":"markdown","9e8cdc9a":"markdown"},"source":{"a2fb0147":"import pandas as pd\nimport numpy as np \nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns","cde90004":"data_path = '..\/input\/fish-market\/Fish.csv'\ndata = pd.read_csv(data_path)","5b82c88a":"print(data.head())","564a02db":"print(data.Species.unique())","501b0063":"print(data.isnull().sum())","612db96e":"print(data.describe().transpose())","0706d2f7":"Y = data['Species']\ndata = data.drop(['Species'], axis=1)\n","497c8a5c":"names= data.columns","5608cf7f":"from sklearn.preprocessing import Normalizer","051a8015":"norms= Normalizer().fit(data)\ndata_norms=norms.transform(data)\ndata_norms= np.asarray(data_norms)","ef0b40b2":"nomred_data = pd.DataFrame(data_norms)","5ea3b399":"nomred_data","fb216873":"nomred_data.columns =names","d487c04b":"print(nomred_data)","aa842d5e":"Y= Y.replace({\"Bream\": 0, \"Roach\": 1,\n              \"Whitefish\":2, \"Parkki\":3, \n              \"Perch\":4, \"Pike\":5, \"Smelt\":6})","4236f492":"print(Y.unique())","ff4a6f58":"data_prepared = pd.concat([nomred_data,Y], axis=1)","a4657c65":"print(data_prepared)","e95f4327":"data_prepared.hist()","55e77118":"sns.pairplot(data_prepared)","09998f7d":"plt.figure(figsize=(5,7))\nsns.boxplot(x= data_prepared['Species'], y= data_prepared['Width'])\nsns.swarmplot(x= data_prepared['Species'], y= data_prepared['Width'])","cc9a73e7":"plt.figure(figsize=(5,7))\nsns.boxplot(x= data_prepared['Species'], y= data_prepared['Height'])\nsns.swarmplot(x= data_prepared['Species'], y= data_prepared['Height'])","fc1503f4":"plt.figure(figsize=(5,7))\nsns.boxplot(x= data_prepared['Species'], y= data_prepared['Length1'])\nsns.swarmplot(x= data_prepared['Species'], y= data_prepared['Length1'])","3a7a78b9":"plt.figure(figsize=(5,7))\nsns.boxplot(x= data_prepared['Species'], y= data_prepared['Length2'])\nsns.swarmplot(x= data_prepared['Species'], y= data_prepared['Length2'])","61a47489":"plt.figure(figsize=(5,7))\nsns.boxplot(x= data_prepared['Species'], y= data_prepared['Length3'])\nsns.swarmplot(x= data_prepared['Species'], y= data_prepared['Length3'])","177f2643":"plt.figure(figsize=(5,7))\nsns.boxplot(x= data_prepared['Species'], y= data_prepared['Width'])\nsns.swarmplot(x= data_prepared['Species'], y= data_prepared['Width'])","81a4030f":"print(data_prepared['Width'].max())","30d762b8":"data_4_cat= data_prepared.loc[data_prepared.Species==4]\nprint(data_4_cat['Width'].idxmax())\nindx_to_drop = data_4_cat['Width'].idxmax()\ndata_prepared =data_prepared.drop([indx_to_drop], axis=0)\n\ndata_1_cat= data_prepared.loc[data_prepared.Species==1]\nprint(data_1_cat['Width'].idxmax())\nindx_to_drop = data_1_cat['Width'].idxmax()\ndata_prepared =data_prepared.drop([indx_to_drop], axis=0)\n\ndata_1_cat= data_prepared.loc[data_prepared.Species==1]\nprint(data_1_cat['Width'].idxmax())\nindx_to_drop = data_1_cat['Width'].idxmax()\ndata_prepared =data_prepared.drop([indx_to_drop], axis=0)\n","1002306f":"plt.figure(figsize=(5,7))\nsns.boxplot(x= data_prepared['Species'], y= data_prepared['Width'])\nsns.swarmplot(x= data_prepared['Species'], y= data_prepared['Width'])","9797b232":"from sklearn.model_selection import GridSearchCV\nfrom sklearn.svm import SVC\nfrom sklearn.model_selection import train_test_split","7f781c5c":"SVC = SVC()","1584f64e":"parameters = {'C': [10,100,1000], 'gamma': [4,5,6,7],\n              'kernel': ['rbf', 'poly', 'sigmoid']}\ngrid_search = GridSearchCV(SVC, parameters, n_jobs=20, cv=6, refit=True,verbose=10)\n","1baa217a":"Y = data_prepared['Species']\nX= data_prepared.drop(['Species'], axis=1)","78267c55":"X_train, X_test, Y_train, Y_test = train_test_split(X, Y, random_state=40, test_size=0.3)","1a09b13d":"grid_search.fit(X_train, Y_train)","23c45ae1":"print(\"Best parameters for SVC Clasiifier\",grid_search.best_estimator_)","83f97628":"from sklearn.metrics import accuracy_score","4ebf4656":"preds = grid_search.predict(X_test)","91720a68":"score= accuracy_score(Y_test, preds)\nprint(\"_Accuracy = %\",score*100)","32cde6eb":"#### 3.1- Normalizing the data: first lets drop categorical feature","4c3db67e":"<img src=\"https:\/\/giffiles.alphacoders.com\/105\/105882.gif\">","89774b69":"#### We don't have Outlierssssss  \ud83e\udd73\ud83e\udd73\ud83e\udd73\ud83e\udd73\ud83e\udd73","59326820":"## 3- Data Preprocessing","c6d410d8":"#### By lookint to the plotting we can see that there is 3 Outliers Let's drop them!!!","a589f434":"### We have no missing data","3b43187e":"#### 4.2.1- Get the index of the outlier and drop","caf0bd3a":"![Outliers.png](attachment:81b32b41-e3ee-4f4b-94ac-2a74637d5da1.png)","c5ce7c23":"## 6- Evaluate the model","d099138b":"#### 3.3- Compain all the data togather for visualization","70217b00":"# The End....","7ec18720":"<img src=\"https:\/\/i2.wp.com\/novocom.top\/image\/bWVkalwaHkWEuZ2lwaHkuY29t\/media\/3o6ZsXoYhtUlGEyIRa\/giphy.gif\">","69897a80":"# Fish species predictor","d9021b25":"#### We have 7 features at all \n#### One of the features is Species which we want to use it the as output we have 6 different classes\n\n**['Bream' 'Roach' 'Whitefish' 'Parkki' 'Perch' 'Pike' 'Smelt']**","66ff7e7c":"## 4- Data Visualization","05472d57":"#### 4.1- Find the Outliers","43c73f87":"#### 3.2- Categorical to numerical","364aedef":"## 1- Importing the liberires and the data","c85d627d":"#### 4.2- Droping outliers","094286c2":"## 5- Preparing the model and the data for training","a0859689":"### Weight have a big STD for this we will normalize it later ","59515403":"## 2- Exploring the data","9e8cdc9a":"#### Now the data is normalized and numerical so its ready to make some visualization\n<img src=\"https:\/\/media.makeameme.org\/created\/wohooo-0392028a2b.jpg\">"}}