{"cell_type":{"dacb03cd":"code","95a1d66e":"code","ae54c04e":"code","8d63f3e3":"code","2bc1b422":"code","24d2e41e":"code","e28250c8":"code","554a4825":"code","8c2cd795":"code","14891be2":"code","3ffc8388":"code","76ff7456":"code","5efce477":"code","1988f5a7":"code","f05d0f0f":"code","cd8c06a1":"code","3dbc66f5":"code","f5066051":"code","33d44563":"code","f5a1f890":"code","002f0f0a":"code","03ac3170":"code","1d4e9103":"code","6ed4ff7f":"code","f61a6c10":"code","29d41935":"code","ec3bbff7":"code","39cfdc45":"code","80f59b02":"code","1d3f52e5":"code","710b8e7d":"code","934f0ac2":"code","d30561c5":"code","9e2662c9":"markdown","5c01fbdd":"markdown","83b0794d":"markdown","31a8b121":"markdown","54206f34":"markdown","c5dff959":"markdown","5e956ff4":"markdown","61e48b04":"markdown"},"source":{"dacb03cd":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport plotly.express as px\n%matplotlib inline","95a1d66e":"dataset=pd.read_csv(\"..\/input\/red-wine-quality-cortez-et-al-2009\/winequality-red.csv\")\ndf=dataset.copy()","ae54c04e":"df.head()","8d63f3e3":"df.info()","2bc1b422":"df.describe().T","24d2e41e":"df.isnull().sum()","e28250c8":"df.shape","554a4825":"df.nunique()","8c2cd795":"df['quality'].value_counts()","14891be2":"plt.figure(figsize=(12,5))\nsns.countplot(df['quality'])","3ffc8388":"plt.figure(figsize = (12,6))\nsns.barplot(x='quality', y = 'alcohol', data = df, palette = 'inferno')","76ff7456":"fig, ax1 = plt.subplots(3,4, figsize=(22,16))\nk = 0\ncolumns = list(df.columns)\nfor i in range(3):\n    for j in range(4):\n            sns.barplot(df['quality'], df[columns[k]], ax = ax1[i][j])\n            k += 1\nplt.show()","5efce477":"fig, ax1 = plt.subplots(3,4, figsize=(22,16))\nk = 0\ncolumns = list(df.columns)\nfor i in range(3):\n    for j in range(4):\n            sns.boxplot(df['quality'], df[columns[k]], ax = ax1[i][j])\n            k += 1\nplt.show()","1988f5a7":"plt.figure(figsize = (12,6))\nsns.pairplot(df)\nplt.show()","f05d0f0f":"fig, ax1 = plt.subplots(3,4, figsize=(22,16))\nk = 0\ncolumns = list(df.columns)\nfor i in range(3):\n    for j in range(4):\n            sns.distplot(df[columns[k]], ax = ax1[i][j])\n            k += 1\nplt.show()","cd8c06a1":"def log_transform(col):\n    return np.log(col[0])\n\ndf['residual sugar'] = df[['residual sugar']].apply(log_transform, axis=1)\ndf['chlorides'] = df[['chlorides']].apply(log_transform, axis=1)\ndf['free sulfur dioxide'] = df[['free sulfur dioxide']].apply(log_transform, axis=1)\ndf['total sulfur dioxide'] = df[['total sulfur dioxide']].apply(log_transform, axis=1)\ndf['sulphates'] = df[['sulphates']].apply(log_transform, axis=1)","3dbc66f5":"df.corr()['quality'].sort_values(ascending=False)","f5066051":"plt.figure(figsize = (12,6))\nsns.heatmap(df.corr(),annot=True)","33d44563":"df.columns","f5a1f890":"df.drop(['fixed acidity', 'citric acid', 'residual sugar',\n       'chlorides', 'free sulfur dioxide', 'total sulfur dioxide', 'density',\n       'pH'],axis=1,inplace=True)","002f0f0a":"sns.scatterplot('alcohol','volatile acidity',style='quality',data=df)","03ac3170":"X = df.drop('quality',axis=1)\nY = df['quality']","1d4e9103":"from sklearn.model_selection import train_test_split\nX_train,X_test,Y_train,Y_test = train_test_split(np.array(X),np.array(Y),test_size=0.2,random_state=42)","6ed4ff7f":"from sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import accuracy_score","f61a6c10":"lr = DecisionTreeClassifier()\nlr.fit(X,Y)\npred = np.expm1(lr.predict(X_test))","29d41935":"acc=accuracy_score(Y_test,lr.predict(X_test))\nacc","ec3bbff7":"from sklearn.metrics import f1_score","39cfdc45":"f1=f1_score(Y_test,lr.predict(X_test),average='weighted')\nf1","80f59b02":"lr = RandomForestClassifier()\nlr.fit(X,Y)\npred = np.expm1(lr.predict(X_test))","1d3f52e5":"acc=accuracy_score(Y_test,lr.predict(X_test))\nacc","710b8e7d":"f1=f1_score(Y_test,lr.predict(X_test),average='macro')\nf1","934f0ac2":"from sklearn.metrics import precision_recall_fscore_support","d30561c5":"precision_recall_fscore_support(Y_test,lr.predict(X_test),average='weighted')","9e2662c9":"## Residual Sugar, Chlorides, Free Sulphur Dioxide, Total Sulphur Dioxide, and Sulphates are highly right skewed. So we need to tranform it.","5c01fbdd":"## From above, we can observe that\n    1.There are 12 cols and 1599 data rows.\n    2.The data does not contain any null values.\n    3.There are 6 different qualities of wine.","83b0794d":"### The data is very less for quality 3,4,8 as compared to 5,6.","31a8b121":"### Alcohol, Sulphates, Volatile acidity have high correlations with the target variable. ","54206f34":"## Much Outliers presents in some features.","c5dff959":"## As lots of overlappting we use decision tree and also check accuracy after using random forest","5e956ff4":"# Here we can observe that\n\n    1.Volatile acidity and alchohol have high correlations with the target variable.\n    2.Here many independent features present that are actually highly dependent on the other independent feature.\n      Like ph and fixed acidity, ph and citric acid.                                           ","61e48b04":"## Here we see density , ph and residual sugar of all quality wine is nearly about same."}}