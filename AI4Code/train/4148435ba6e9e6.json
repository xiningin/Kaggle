{"cell_type":{"439c8240":"code","3c6b5b8e":"code","55433680":"code","0d46ff61":"code","3a79b682":"code","a75b130c":"code","1780720d":"code","be95ead5":"code","baef3edd":"code","adbe8d04":"code","f77e3ed2":"code","8d314335":"code","09cf17f4":"markdown","6edea323":"markdown","99f33e67":"markdown","5f039253":"markdown","c50fb9e3":"markdown","3e3a93d3":"markdown"},"source":{"439c8240":"import pandas as pd\nimport numpy as np","3c6b5b8e":"train=pd.read_csv(\"..\/input\/ncaaw-2021-features-only\/tourney.csv\")\ntest=pd.read_csv(\"..\/input\/ncaaw-2021-features-only\/test.csv\")\ntrain[\"result\"].head()\n","55433680":"Y=train[\"result\"]\nS=train[\"Season\"]\nX=train.drop(['Season','TeamID1','TeamID2','result'],axis=1)\nX_test=test.drop(['ID','TeamID1','TeamID2','Season'],axis=1)\nY.tail(3)","0d46ff61":"import h2o\nfrom h2o.estimators import H2OGradientBoostingEstimator","3a79b682":"h2o.init()","a75b130c":"h2o_train=h2o.H2OFrame(train)\nh2o_test=h2o.H2OFrame(test)","1780720d":"num_folds = 10\ntraining_columns = list(X.columns)\n","be95ead5":"model = H2OGradientBoostingEstimator(ntrees=1000,\n                                 max_depth=50,\n                                 nfolds=num_folds,\n                                 seed=1234)","baef3edd":"model.train(x=training_columns,\n            y='result',\n            training_frame=h2o_train)","adbe8d04":"test_preds = model.predict(test_data=h2o_test).as_data_frame()['predict'].values","f77e3ed2":"MSampleSubmission = pd.read_csv('..\/input\/ncaaw-march-mania-2021\/WSampleSubmissionStage1.csv')","8d314335":"idx = test_preds.shape[0] \/\/2\ntest_preds[idx:] = 1 - test_preds[idx:]\n\npred = pd.concat([test.ID, pd.Series(test_preds)], axis=1).groupby('ID')[0]\\\n        .mean().reset_index().rename(columns={0:'Pred'})\nsub = MSampleSubmission.drop(['Pred'],axis=1).merge(pred, on='ID')\nsub.to_csv('submission.csv', index=False)\nsub.head()","09cf17f4":"> Train Model","6edea323":"> DATA","99f33e67":"Model****","5f039253":"predictions on test sample","c50fb9e3":"Library****","3e3a93d3":"*Use H2O Randomforest estimator*"}}