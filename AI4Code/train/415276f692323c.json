{"cell_type":{"660f7e26":"code","8cfa0d9b":"code","a67088c6":"code","3eb65f03":"code","0b919559":"code","432b39ad":"code","b9e4e24b":"code","b5d39ff1":"code","0deb7d25":"code","17f51c07":"code","fc4e7c51":"code","4fdf3060":"code","92661572":"code","3bf70662":"code","8df11ce6":"code","50631a71":"code","2ff67e00":"code","370b05c7":"code","8310eb28":"code","2e3963a9":"code","68bea7a1":"code","7b103a95":"code","835e6f8f":"code","969b0366":"code","46677cbc":"code","d49d4c7f":"code","54ca2d51":"code","dcffe41e":"code","c99cbd92":"code","ddd72960":"code","555b7f52":"code","5bc06fd4":"code","b824a0b5":"code","1bcc77ae":"code","b860fe11":"code","b613eaef":"code","8e37af11":"code","331feed6":"markdown","d38aee1d":"markdown","6d86db03":"markdown","ce1394e7":"markdown","ae27543d":"markdown"},"source":{"660f7e26":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\n# import os\n# for dirname, _, filenames in os.walk('\/kaggle\/input'):\n#     for filename in filenames:\n#         print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","8cfa0d9b":"data = pd.read_csv(\"\/kaggle\/input\/osic-pulmonary-fibrosis-progression\/train.csv\")","a67088c6":"# Let's check a few rows\ndata.head()","3eb65f03":"# How many rows for each patient?\ndata.groupby('Patient').size()","0b919559":"from sklearn.preprocessing import LabelEncoder\n\ncat_features = ['Sex','SmokingStatus']\nencoder = LabelEncoder()\n\n# Apply the label encoder to each column\nencoded = data[cat_features].apply(encoder.fit_transform)","432b39ad":"data2 = data[['FVC','Percent','Weeks','Age']].join(encoded)\ndata2.head()","b9e4e24b":"X = data2[['SmokingStatus','Age','Sex','Weeks','Percent']]\ny = data2['FVC']","b5d39ff1":"import matplotlib.pyplot as plt  \nimport seaborn as seabornInstance \nfrom sklearn.model_selection import train_test_split \nfrom sklearn.neural_network import MLPRegressor\nfrom sklearn import metrics\n%matplotlib inline","0deb7d25":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=0)","17f51c07":"regr = MLPRegressor(random_state=1, max_iter=500) # Try different options for better score\nregr.fit(X_train, y_train) #training the algorithm","fc4e7c51":"y_pred = regr.predict(X_test)","4fdf3060":"df = pd.DataFrame({'Actual': y_test, 'Predicted': y_pred})\ndf","92661572":"df1 = df.head(25)\ndf1.plot(kind='bar',figsize=(16,10))\nplt.grid(which='major', linestyle='-', linewidth='0.5', color='green')\nplt.grid(which='minor', linestyle=':', linewidth='0.5', color='black')\nplt.show()","3bf70662":"test = pd.read_csv(\"\/kaggle\/input\/osic-pulmonary-fibrosis-progression\/test.csv\")","8df11ce6":"# test2 = test[['Percent','Weeks','Age']].join(encoded)\ntest.head()","50631a71":"test['Patient_Week'] = test['Patient'].astype(str)+\"_\"+test['Weeks'].astype(str)\ntest.head()","2ff67e00":"# Apply the label encoder to each column\nencoded = test[cat_features].apply(encoder.fit_transform)\ntest2 = test[['Patient','Percent','Weeks','Age']].join(encoded)","370b05c7":"test2.head()","8310eb28":"X = data2[['SmokingStatus','Age','Sex','Weeks','FVC']]\ny = data2['Percent']","2e3963a9":"X_train2, X_test2, y_train2, y_test2 = train_test_split(X, y, test_size=0.3, random_state=0)","68bea7a1":"regr2 = MLPRegressor(random_state=1, max_iter=500) # Try different options for better score\nregr2.fit(X_train2, y_train2) #training the algorithm","7b103a95":"y_pred2 = regr2.predict(X_test2)","835e6f8f":"df = pd.DataFrame({'Actual': y_test2, 'Predicted': y_pred2})\ndf","969b0366":"test3 = test[['Patient','FVC','Weeks','Age']].join(encoded)","46677cbc":"submission = pd.read_csv(\"\/kaggle\/input\/osic-pulmonary-fibrosis-progression\/sample_submission.csv\")","d49d4c7f":"submission.head(100)","54ca2d51":"submission[['Patient','Weeks']] = submission.Patient_Week.str.split(\"_\",expand=True,)","dcffe41e":"submission.head()","c99cbd92":"submission = submission.drop('FVC',1)\nsubmission = submission.drop('Confidence',1)\ntest2 = test2.drop('Weeks',1)","ddd72960":"submission2 = pd.merge(submission,test2,on='Patient',how='left')\nsubmission2.head(100)","555b7f52":"test4 = test3[['Patient','FVC']]\nsubmission2 = pd.merge(submission2,test4,on='Patient',how='left')\nsubmission2.head(100)","5bc06fd4":"X2 = submission2[['SmokingStatus','Age','Sex','Weeks','Percent']]\nX3 = submission2[['SmokingStatus','Age','Sex','Weeks','FVC']]\nsubmission2['FVC'] = regr.predict(X2)\nsubmission2['Confidence'] = regr2.predict(X3)","b824a0b5":"submission2.head()","1bcc77ae":"submission3 = submission2[['Patient_Week','FVC','Confidence']]","b860fe11":"submission3.head(100)","b613eaef":"# submission3['FVC'] = submission3['FVC'].astype(int)\n# submission3['Confidence'] = submission3['Confidence'].astype(int)","8e37af11":"submission3.to_csv(\"\/kaggle\/working\/submission.csv\",index=False)","331feed6":"# Predict Confidence","d38aee1d":"# Submission","6d86db03":"# I did basic exploration in previous notebook, so won't repeat here: https:\/\/www.kaggle.com\/srikanthpotukuchi\/linear-regression-model-with-submission?scriptVersionId=41045937","ce1394e7":"# Predict FVC","ae27543d":"# Read in the inputs"}}