{"cell_type":{"9c230c8b":"code","081473d8":"code","480cdfc5":"code","db1e65af":"code","0e5f1110":"code","e3eef827":"code","a9378b20":"code","f1b4e04c":"code","5eb74b32":"code","dab1276c":"code","8ad8b4cf":"code","c3caea93":"code","bc514cc2":"code","9073b81c":"code","dca65da5":"markdown","ce866b22":"markdown","4379aee5":"markdown"},"source":{"9c230c8b":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","081473d8":"train = pd.read_csv(\"\/kaggle\/input\/autism-prediction\/Autism-prediction\/train.csv\")\ntest = pd.read_csv(\"\/kaggle\/input\/autism-prediction\/Autism-prediction\/test.csv\")\nsub = pd.read_csv(\"\/kaggle\/input\/autism-prediction\/Autism-prediction\/sample_submission.csv\")","480cdfc5":"#Code by ABID ALI AWAN https:\/\/www.kaggle.com\/kingabzpro\/wandb-lightgbm-wids\n\nimport lightgbm as lgb\nfrom sklearn.model_selection import train_test_split \nfrom sklearn.metrics import mean_squared_error as MSE\nimport wandb\nfrom wandb.lightgbm import wandb_callback","db1e65af":"train.head()","0e5f1110":"#Code by ABID ALI AWAN https:\/\/www.kaggle.com\/kingabzpro\/wandb-lightgbm-wids\n\ncat = {'ethnicity':'category',\n       'gender':'category', \n       'jaundice':'category',\n       'austim':'category',\n       'contry_of_res':'category', \n       'used_app_before':'category',\n        'age_desc':'category',\n        'relation':'category'}\ntest = test.astype(cat)\ntrain = train.astype(cat)","e3eef827":"train = train.rename(columns={'Class\/ASD':'class_asd'})","a9378b20":"#Code by ABID ALI AWAN https:\/\/www.kaggle.com\/kingabzpro\/wandb-lightgbm-wids\n\nX = train.drop('class_asd', axis=1)\ny = train.class_asd","f1b4e04c":"#Code by ABID ALI AWAN https:\/\/www.kaggle.com\/kingabzpro\/wandb-lightgbm-wids\n\n# Splitting \nX_train, X_test, y_train, y_test = train_test_split(X, y, \n                      test_size = 0.3, random_state = 123)","5eb74b32":"#Code by ABID ALI AWAN https:\/\/www.kaggle.com\/kingabzpro\/wandb-lightgbm-wids\n\nwatchlist = [(X_train, 'train'), (X_test, 'test')]\nnum_round = 5\n\n# create dataset for lightgbm\nlgb_train = lgb.Dataset(X_train, y_train)\nlgb_eval = lgb.Dataset(X_test, y_test, reference=lgb_train)","dab1276c":"#Code by ABID ALI AWAN https:\/\/www.kaggle.com\/kingabzpro\/wandb-lightgbm-wids\n\n# add lightgbm callback\ngbm = lgb.train(params = {'learning_rate':0.02,\n                          'num_leaves':50,\n                          'n_estimators':1000,\n                          'metric': 'auc',\n                          'objective': 'binary'},\n                train_set=lgb_train,\n                num_boost_round=1000,\n                valid_sets=lgb_eval,\n                valid_names=('auc'),\n                early_stopping_rounds=50)\n\n# predict\ny_pred = gbm.predict(X_test, num_iteration=gbm.best_iteration)","8ad8b4cf":"#Code by ABID ALI AWAN https:\/\/www.kaggle.com\/kingabzpro\/wandb-lightgbm-wids\n\n# eval\nprint('The rmse of prediction is:', MSE(y_test, y_pred) ** 0.5)","c3caea93":"gbm.params","bc514cc2":"test.columns","9073b81c":"#Code by ABID ALI AWAN https:\/\/www.kaggle.com\/kingabzpro\/wandb-lightgbm-wids\n\npred = gbm.predict(test)\ntest[\"class_asd\"] = pred\ntest[[\"ID\",\"class_asd\"]].to_csv(\"sample_submission_tuned_lgbm_2.csv\",index=False)","dca65da5":"![](https:\/\/i.ytimg.com\/vi\/Y7rjzfpWSo8\/maxresdefault.jpg)https:\/\/www.youtube.com\/watch?v=Y7rjzfpWSo8","ce866b22":"\"WandB is a central dashboard to keep track of your hyperparameters, system metrics, and predictions so you can compare models live, and share your findings.\"\n\nhttps:\/\/wandb.ai\/site","4379aee5":"#Acknowledgement\n\nAbid Ali Awan https:\/\/www.kaggle.com\/kingabzpro\/wandb-lightgbm-wids"}}