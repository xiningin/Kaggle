{"cell_type":{"2dc9d741":"code","626aefb6":"code","f9d524c7":"code","0f90414a":"code","ef993b96":"code","bfb3011c":"code","47eed1eb":"code","38029eac":"code","52e7e0c3":"code","57dd6a44":"code","781791ea":"code","ec3bf29a":"code","0b3313de":"code","42aeab96":"code","c6423d7d":"code","d3b55ab0":"code","6c6af1a2":"code","d7053c41":"code","40939dca":"code","d7e4f8e3":"code","2285b940":"code","3d317f16":"code","b6636f2f":"code","a6e3e322":"code","5812061b":"code","e8e2b7ff":"code","e54e8368":"code","8410691d":"code","1b746b04":"code","5b940ef4":"code","ced6cda0":"code","ff4863bd":"code","9adb7ac4":"code","a851f8b9":"code","31757b70":"code","f9410d59":"code","26364f16":"code","5bebd036":"code","5557480c":"code","2a9a9776":"code","429ac61f":"code","f13cba01":"code","2baa6670":"code","5da808e4":"code","d1d2129b":"code","0d60af3c":"code","ad579858":"code","b3f9ddfd":"code","a9c46c7f":"code","7be5b765":"code","2b3e849a":"code","41444e7e":"code","234991d3":"code","8620775c":"code","0920d3cc":"code","48397fe8":"code","f7326283":"code","90961a4d":"markdown","87604e6b":"markdown","ff5296ee":"markdown","8bb5d7c9":"markdown","e6df2fc2":"markdown","70ea419c":"markdown","11a8c4c8":"markdown"},"source":{"2dc9d741":"import pandas as pd\nimport numpy as np\nimport datetime as dt\nretail=pd.read_excel(\"..\/input\/online-retail-ii-dataset\/online_retail_II.xlsx\", sheet_name=\"Year 2009-2010\")","626aefb6":"df=retail.copy()","f9d524c7":"df","0f90414a":"df.shape","ef993b96":"df.head(20)","bfb3011c":"df[\"Country\"].value_counts()","47eed1eb":"df[\"Country\"].nunique()","38029eac":"for i in df.columns:\n    print(i ,df[i].nunique())","52e7e0c3":"df.info()","57dd6a44":"df[df[\"Customer ID\"]==13085]","781791ea":"df.tail(3)","ec3bf29a":"for i in df.columns:\n    print(i, df[i].nunique())","0b3313de":"df[\"Country\"].nunique()","42aeab96":"# de\u011fi\u015fkenlerdeki eksik de\u011fer say\u0131s\u0131\n\ndf.isnull().sum()","c6423d7d":"# eksik verileri doldurma y\u00f6ntemleri var.\n# eksik verileri atarak ilerleyece\u011fiz.","d3b55ab0":"# eksik de\u011ferlerin t\u00fcm dataya oran\u0131\n# verilerin %21'i eksik\n\ndf.isnull().sum().sum()\/df.shape[0]","6c6af1a2":"df.head()","d7053c41":"df[\"total_price\"]=df[\"Quantity\"]* df[\"Price\"]","40939dca":"df.head()","d7e4f8e3":"df.groupby(\"Customer ID\").agg({\"total_price\":\"sum\"}).head()","2285b940":"df[df[\"Customer ID\"]==12346.0]","3d317f16":"df= df[df[\"Invoice\"].astype(\"str\").str.get(0)!=\"C\"]  # iadeleri att\u0131k, ba\u015fka y\u00f6ntemler uygulanabilir.\ndf","b6636f2f":"df=df.dropna() #eksikleri att\u0131k, ba\u015fka y\u00f6ntemler uygulanabilir.","a6e3e322":"df.shape","5812061b":"df[\"Customer ID\"]=df[\"Customer ID\"].astype(\"int\")","e8e2b7ff":"df.head()","e54e8368":"# s\u0131cakl\u0131k, yani m\u00fc\u015fteri en son ka\u00e7 g\u00fcn \u00f6nce al\u0131\u015fveri\u015f yapm\u0131\u015f","8410691d":"# analiz tarihi","1b746b04":"df[\"InvoiceDate\"].max()","5b940ef4":"today_date= dt.datetime(2010,12,10)\ntoday_date","ced6cda0":"df.groupby(\"Customer ID\").agg({\"InvoiceDate\":\"max\"})","ff4863bd":"rec=today_date-df.groupby(\"Customer ID\").agg({\"InvoiceDate\":\"max\"})","9adb7ac4":"rec.head()","a851f8b9":"for i in rec[\"InvoiceDate\"]:\n    print(i.days)","31757b70":"rec[\"InvoiceDate\"]=[i.days for i in rec[\"InvoiceDate\"]]","f9410d59":"# rec[\"InvoiceDate\"]=rec[\"InvoiceDate\"].apply(lambda x: x.days)","26364f16":"rec[\"InvoiceDate\"]","5bebd036":"rec.rename(columns={\"InvoiceDate\": \"Recency\"}, inplace=True)","5557480c":"rec.head()","2a9a9776":"# s\u0131kl\u0131k\n# ka\u00e7 kere al\u0131\u015fveri\u015f yapt\u0131","429ac61f":"freq=df.groupby(\"Customer ID\").agg({\"InvoiceDate\": \"nunique\"}).rename(columns={\"InvoiceDate\": \"Frequency\"})","f13cba01":"freq.head()","2baa6670":"money=df.groupby(\"Customer ID\").agg({\"total_price\": \"sum\"}).rename(columns={\"total_price\": \"Monetary\"})","5da808e4":"money.head()","d1d2129b":"print(rec.shape, freq.shape, money.shape)","0d60af3c":"#concat\n\nrfm=pd.concat([rec, freq, money], axis=1)\nrfm.head()","ad579858":"# range belirleme","b3f9ddfd":"rfm[\"Recency_score\"]= pd.qcut( rfm[\"Recency\"], 5 , labels=[5,4,3,2,1] )\n\nrfm[\"Frequency_score\"]= pd.qcut( rfm[\"Frequency\"].rank(method=\"first\") , 5, labels=[1,2,3,4,5] )\n\nrfm[\"Monetary_score\"]= pd.qcut( rfm[\"Monetary\"], 5 , labels=[1,2,3,4,5] )","a9c46c7f":"rfm.head()","7be5b765":"rfm[\"RFM\"]=rfm[\"Recency_score\"].astype(\"str\")+ rfm[\"Frequency_score\"].astype(\"str\")+ rfm[\"Monetary_score\"].astype(\"str\")","2b3e849a":"rfm.head()","41444e7e":"seg_map={r'[1-2][1-2]': \"Hibernating\", r'[1-2][3-4]': \"At Risk\", r'[1-2]5': \"Can't Lose\", r'3[1-2]': \"About to Sleep\",\n        r'33': \"Need Attention\", r'[3-4][4-5]': \"Loyal Customers\", r'41': \"Promising\", r'51': \"New Customers\",\n        r'[4-5][2-3]': \"Potential Loyalist\", r'5[4-5]': \"Champions\"}","234991d3":"rfm[\"Segment\"]= rfm[\"Recency_score\"].astype(\"str\")+ rfm[\"Frequency_score\"].astype(\"str\")\nrfm[\"Segment\"]=rfm[\"Segment\"].replace(seg_map,regex=True)","8620775c":"rfm.head()","0920d3cc":"rfm[[\"Segment\",\"Recency\", \"Frequency\",\"Monetary\"]].groupby(\"Segment\").agg([\"min\",\"max\",\"mean\",\"count\"])","48397fe8":"# Bu grupta 663 m\u00fc\u015fteri var.\n# \u015eampiyonlardaki m\u00fc\u015fteriler bug\u00fcn ve 14 g\u00fcn \u00f6ncesine kadar gelen m\u00fc\u015fterilerdir.\n# Ortalama 6.11 g\u00fcn \u00f6nce gelmi\u015fler.(recency)\n# \u015eampiyonlar segmentinde en az 3, en fazla 204 kere al\u0131\u015fveri\u015f yapan vard\u0131r.\n# Ortalama 12.5 kere al\u0131\u015fveri\u015f yapm\u0131\u015flar. (frequency)\n# En az 75 bin, en fazla 349 bin sterlin para b\u0131rakan var.\n# Ortalama 6852 sterlinlik al\u0131\u015fveri\u015f yapm\u0131\u015flar. (monetary)\n\n ","f7326283":"# En iyi m\u00fc\u015fteriler bu grupta. En s\u0131k gelenler ve en s\u0131caklar\n\n# ----Al\u0131nabilecek aksiyonlar----\n# En kaliteli ve en pahal\u0131 \u00fcr\u00fcnler\n# E\u015fsiz teklifler\n# Gold kart","90961a4d":"# Frequency","87604e6b":"# DATA UNDERSTANDING","ff5296ee":"# Monetary","8bb5d7c9":"# Gruplar\u0131 belirleme","e6df2fc2":"# RFM skorlar\u0131","70ea419c":"# Recency","11a8c4c8":"# \u015eampiyonlar"}}