{"cell_type":{"b83d775d":"code","48af4ba6":"code","63a1beaf":"code","380bd2ca":"code","c2926d67":"code","70cb0980":"code","df111d86":"code","d0817721":"code","a0b310e8":"code","50e42be0":"code","458a77b5":"code","196004f3":"code","6b934f80":"code","6eae8530":"code","f293af72":"code","292fbded":"markdown"},"source":{"b83d775d":"from sklearn.model_selection import train_test_split\r\nfrom sklearn.metrics import accuracy_score\r\nfrom sklearn.metrics import precision_score\r\nfrom sklearn.metrics import roc_auc_score\r\nimport pandas as pd\r\nimport numpy as np\r\nfrom xgboost import XGBClassifier","48af4ba6":"df = pd.read_csv(\"..\/input\/loan-data\/loan_data.csv\")\r\nfor x in df.columns:\r\n    if \".\" in (x):\r\n        df.rename(columns={x:x.replace(\".\",\"_\")} , inplace = True)\r\ndf","63a1beaf":"categorical_columns = ['purpose']\r\nnumerical_columns = ['int_rate', 'installment', 'log_annual_inc',\r\n       'dti', 'fico', 'days_with_cr_line', 'revol_bal', 'revol_util',\r\n       'inq_last_6mths', 'delinq_2yrs', 'pub_rec']\r\nlabel = \"not_fully_paid\"","380bd2ca":"df1 = df[df[\"not_fully_paid\"] == 1].sample(1533)\r\ndf2 = df[df[\"not_fully_paid\"] == 1].sample(1533)\r\ndf3 = df[df[\"not_fully_paid\"] == 1].sample(1533)\r\ndf4 = df[df[\"not_fully_paid\"] == 1].sample(1533)\r\ndf5 = df[df[\"not_fully_paid\"] == 1].sample(1533)\r\ndf6 = df[df[\"not_fully_paid\"] == 1].sample(1533)\r\ndf7 = df[df[\"not_fully_paid\"] == 1].sample(1533)\r\ndf8 = df[df[\"not_fully_paid\"] == 1].sample(1533)\r\ndff = pd.concat([df,df1,df2,df3,df4,df5,df6,df7,df8] ,ignore_index = True)\r\ndff","c2926d67":"X = dff[numerical_columns]\r\ny = dff[[label]]","70cb0980":"train_x,test_x,train_y,test_y = train_test_split(X,y,test_size = 0.33,random_state = 42, stratify = y[label])","df111d86":"model = XGBClassifier(learning_rate=0.7)","d0817721":"model.fit(train_x,train_y)\r\n","a0b310e8":"y_pred = model.predict(test_x)\r\ny_prob = model.predict_proba(test_x)[:,1:]","50e42be0":"accuracy = accuracy_score(test_y , y_pred)\r\nprecision = precision_score(test_y , y_pred)\r\nauc = roc_auc_score(test_y, y_prob)","458a77b5":"print(\"accuracy :\" , accuracy)\r\nprint(\"precision :\" , precision)\r\nprint(\"auc :\" , auc)","196004f3":"import pickle\r\nmodel_name = \"Model_For_Deployment.sav\"\r\npickle.dump(model,open(model_name,\"wb\"))","6b934f80":"test_x.shape","6eae8530":"loaded_model =pickle.load(open(model_name,\"rb\"))","f293af72":"loaded_model.score(test_x,test_y)","292fbded":"Medium Article Link :- https:\/\/keeganfdes03.medium.com\/loan-data-machine-learning-model-c0edd5e03686"}}