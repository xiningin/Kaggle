{"cell_type":{"89034a6b":"code","d388a786":"code","ca1b72cb":"code","f623c9fd":"code","181f06ef":"code","431025e0":"code","1236820e":"code","cf1fb5a6":"code","5f0882af":"code","f7f8a33a":"code","6dd348cf":"markdown"},"source":{"89034a6b":"import numpy as np\nimport matplotlib.pyplot as plt\nimport tensorflow as tf","d388a786":"size = 299\nshape = (size,size,3)","ca1b72cb":"from tensorflow.keras.layers import Input, Dense, Activation\nfrom tensorflow.keras.layers import Flatten\nfrom tensorflow.keras.models import Model ,load_model\nfrom tensorflow.keras.layers import Conv2D\nfrom tensorflow.keras.optimizers import Adam, SGD\nfrom tensorflow.keras.layers import add\nimport tensorflow_hub as hub","f623c9fd":"loaded_obj = hub.load('https:\/\/tfhub.dev\/google\/imagenet\/inception_resnet_v2\/classification\/5')\nhub_layer = hub.KerasLayer(loaded_obj, trainable = True)","181f06ef":"def create_model(hublayer):\n    inputs = Input(shape)\n    outputs = hublayer(inputs)\n    x = Flatten()(outputs)\n    \n    x = Dense(1024,activation='relu')(x)\n    x = Dense(512,activation = 'relu')(x)\n    output = Dense(3,activation = 'softmax')(x)\n    \n    model = Model(inputs,output)\n    print(model.summary())\n    return model","431025e0":"mod = create_model(hub_layer)\nmod.compile(loss=\"categorical_crossentropy\", optimizer= Adam(0.0001), metrics=[\"accuracy\"])","1236820e":"from tensorflow.keras.preprocessing.image import ImageDataGenerator \ndatagen = ImageDataGenerator( featurewise_center=False, samplewise_center=False, \n                             featurewise_std_normalization=False,samplewise_std_normalization=False, \n                             zca_whitening=False, rotation_range=5, width_shift_range=0.2,\n                             height_shift_range= 0.2, brightness_range= (0,0.2), \n                             shear_range=0.2, zoom_range= 0.1)\ntrain_generator = datagen.flow_from_directory(\n        '..\/input\/train-valid-test\/Bike side classifier data (complete)\/train',\n        target_size=(size,size),\n        batch_size=32,\n        class_mode='categorical')\nvalidation_generator = datagen.flow_from_directory(\n        '..\/input\/train-valid-test\/Bike side classifier data (complete)\/validation',\n        target_size=(size, size),\n        batch_size=32,\n        class_mode='categorical')","cf1fb5a6":"from tensorflow.keras.callbacks import EarlyStopping\nerly = EarlyStopping(monitor = 'val_accuracy',patience = 6)\nmod.fit(\n        train_generator,\n        epochs=50,\n        validation_data=validation_generator,\n        verbose = 2,callbacks = [erly])","5f0882af":"keyss = mod.history.history\nnn = len(keyss['loss'])\nplt.plot(np.arange(nn),keyss['loss'],color='green',label='loss')\nplt.legend()\nplt.plot(np.arange(nn),keyss['val_loss'],color='black',label = 'val_loss')\nplt.legend()\nplt.plot(np.arange(nn),keyss['accuracy'],color='red',label = 'accurcy')\nplt.legend()\nplt.plot(np.arange(nn),keyss['val_accuracy'],color='purple',label = 'val_accu')\nplt.legend()\nplt.xlim(0,nn)\nplt.ylim(0,2)\nplt.show()\n","f7f8a33a":"testgen = ImageDataGenerator(rotation_range = 5, brightness_range= (0,0.2))\ntestdata = testgen.flow_from_directory(  \n                             '..\/input\/train-valid-test\/Bike side classifier data (complete)\/test',\n                               target_size = (size,size))\nmod.evaluate_generator(testdata )  ","6dd348cf":"# 92.3 Accuracy on test data"}}