{"cell_type":{"b9520887":"code","2a0fc99b":"code","d26eef33":"code","2ab3494b":"code","1a1289f0":"code","d4d4bfee":"code","26905630":"code","c4caad9f":"code","6a65b661":"code","8dcc22af":"code","8ad7d78a":"code","4eef4d28":"code","d762ff43":"code","baa5a4db":"code","fbcb8b14":"code","e110074a":"code","2d519f45":"code","10fc1630":"code","7cf15b50":"code","7bd7f97d":"code","06a0e7ac":"code","c632cfe0":"code","ae97328e":"code","74de7cf9":"code","e67a65c7":"code","83715416":"code","54de5751":"code","5e306629":"code","11897de6":"code","54ada396":"code","0fe29b0c":"code","579862bd":"code","e2912d83":"code","dbf1e670":"code","45d7f24a":"code","383858e5":"code","2a2c34dd":"markdown","f6e9ace1":"markdown","a458dd64":"markdown","63938456":"markdown","f4af541b":"markdown","40050c58":"markdown","d766e935":"markdown","10ddc29e":"markdown","0de87113":"markdown","86190875":"markdown","0203a63d":"markdown","302713ac":"markdown","f0dbe59c":"markdown","1b0b6bc6":"markdown","84e86012":"markdown","fa4216a4":"markdown","8c66f889":"markdown","b621427f":"markdown","3d02e6e1":"markdown","9e524094":"markdown","fba45605":"markdown","01fb92a7":"markdown","53d0d7ff":"markdown","a7c5e462":"markdown","6758eef6":"markdown"},"source":{"b9520887":"#import libraries\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set()\n%matplotlib inline","2a0fc99b":"#load data\ntest = pd.read_csv(\"..\/input\/mobile-price-classification\/test.csv\")\ntrain = pd.read_csv(\"..\/input\/mobile-price-classification\/train.csv\")","d26eef33":"train.head()","2ab3494b":"test.head()","1a1289f0":"train.info()","d4d4bfee":"test.info()","26905630":"numerical = ['battery_power','clock_speed','fc','int_memory','m_dep','mobile_wt', 'n_cores', 'pc', 'px_height',\n             'px_width', 'ram', 'sc_h', 'sc_w', 'talk_time']\ncategorical = ['blue','dual_sim','four_g','three_g', 'touch_screen','wifi']","c4caad9f":"print(len(numerical))\nprint(len(categorical))","6a65b661":"#categorical attributes\ndf = pd.melt(train[categorical])\nsns.countplot(data=df,x='variable', hue='value')","8dcc22af":"#numerical attributes\nfig = plt.figure(figsize=(15,20))\nfor i,col in enumerate(numerical):\n    ax=plt.subplot(5,3,i+1) \n    train[col].plot.hist(ax = ax).tick_params(axis = 'x',labelrotation = 360)\n    ax.legend(loc = 'upper center', bbox_to_anchor=(0.5, 1.1))\nplt.show()","8ad7d78a":"skewed = ['clock_speed','fc','m_dep', 'px_height', 'sc_w']\nno_skewed = ['battery_power','int_memory','mobile_wt','n_cores','pc','px_width','ram','sc_h','talk_time']","4eef4d28":"#correlation between attributes\ncorr = train.corr()\nfig, (ax) = plt.subplots(1,1,sharey = True, figsize = (20,10))\nsns.heatmap(corr, cmap = 'Blues')","d762ff43":"#correlation between price and phone attributes\ncorr.sort_values(by=[\"price_range\"],ascending=False).iloc[0].sort_values(ascending=False)","baa5a4db":"train.groupby('price_range').mean()['ram'].plot(kind = 'bar', legend = True).tick_params(axis = 'x', labelrotation = 360)","fbcb8b14":"#variables with symmetrical distributions\ngroup_no_skewed = train.groupby('price_range')[no_skewed].mean().reset_index()\nfig = plt.figure(figsize=(15,20))\nfor i,col in enumerate(group_no_skewed.iloc[:,1:].columns):\n    ax=plt.subplot(5,3,i+1) \n    group_no_skewed.iloc[:,1:][col].plot.bar(ax = ax).tick_params(axis = 'x',labelrotation = 360)\n    ax.legend(loc = 'upper center', bbox_to_anchor=(0.5, 1.1))\nplt.show()","e110074a":"#variables with skewed distributions\ngroup_skewed = train.groupby('price_range')[skewed].median().reset_index()\nfig = plt.figure(figsize=(15,20))\nfor i,col in enumerate(group_skewed.iloc[:,1:].columns):\n    ax=plt.subplot(5,3,i+1) \n    group_skewed.iloc[:,1:][col].plot.bar(ax = ax).tick_params(axis = 'x',labelrotation = 360)\n    ax.legend(loc = 'upper center', bbox_to_anchor=(0.5, 1.1))\nplt.show()","2d519f45":"#bluetooth, wifi vs. price\nsns.catplot('price_range', col='blue',hue = 'wifi',data = train,  kind = 'count', col_wrap=2)","10fc1630":"#3g, 4g vs. price\nsns.catplot('price_range', col='three_g',hue = 'four_g',data = train,  kind = 'count', col_wrap=2)","7cf15b50":"#dual_sim vs. price\nsns.catplot('price_range', col='dual_sim',data = train,  kind = 'count')","7bd7f97d":"#touch_screen vs. price\nsns.catplot('price_range', col='touch_screen',data = train,  kind = 'count')","06a0e7ac":"#scale numeric variables of training data\nfrom sklearn.preprocessing import MinMaxScaler\nscaler_train = MinMaxScaler()\ntrain_num_scaled = scaler_train.fit_transform(train[numerical])\nscaler_train.data_max_\nscaler_train.data_min_","c632cfe0":"train_num_scaled = pd.DataFrame(train_num_scaled,columns=train[numerical].columns)\ntrain_num_scaled","ae97328e":"#scale numeric variables of test data\nfrom sklearn.preprocessing import MinMaxScaler\nscaler_test = MinMaxScaler()\ntest_num_scaled = scaler_test.fit_transform(test[numerical])\nscaler_test.data_max_\nscaler_test.data_min_","74de7cf9":"test_num_scaled = pd.DataFrame(test_num_scaled,columns=test[numerical].columns)","e67a65c7":"test_final = pd.concat([test[categorical],test_num_scaled], axis = 1)\ntest_final.head()","83715416":"#X & Y array\nimport tensorflow as tf\nX = pd.concat([train[categorical],train_num_scaled], axis = 1)\ny = tf.keras.utils.to_categorical(train['price_range'], 4)","54de5751":"X.head()","5e306629":"y","11897de6":"#Split the original train data into train and val data\nfrom sklearn.model_selection import train_test_split\nX_train, X_val, y_train, y_val = train_test_split(X, train['price_range'], test_size=0.33, random_state=101)","54ada396":"print(X_train.shape)\nprint(y_train.shape)\nprint(X_val.shape)\nprint(y_val.shape)","0fe29b0c":"#import deep learning libraries\nimport tensorflow.keras\nfrom keras.models import Sequential\nfrom keras.layers import Dense","579862bd":"#build model\nmodel_1 = Sequential()\nmodel_1.add(Dense(25, input_dim=20, activation='relu'))\nmodel_1.add(Dense(25, activation='relu'))\nmodel_1.add(Dense(4, activation='softmax'))\nmodel_1.summary()","e2912d83":"model_1.compile(optimizer='adam', loss='sparse_categorical_crossentropy',metrics=['accuracy'])\nhist_1 = model_1.fit(X_train, y_train, epochs=20, batch_size=25, \n                   validation_data=(X_val,y_val))","dbf1e670":"plt.plot(hist_1.history['loss'])\nplt.plot(hist_1.history['val_loss'])\n\nplt.title('Model Loss Progression During Training\/Validation')\nplt.ylabel('Training and Validation Losses')\nplt.xlabel('Epoch Number')\nplt.legend(['Training Loss', 'Validation Loss'])","45d7f24a":"score = model_1.evaluate(X_val, y_val, verbose=0)\nprint('Test loss:', score[0])\nprint('Test accuracy:', score[1])","383858e5":"#test data prediction\nprediction_test = np.argmax(model_1.predict(test_final), axis=1)\npd.DataFrame({'id' : test['id'],'price_range' : prediction_test})","2a2c34dd":"#### 2.3. Attributes of high-priced vs. low-priced phones ","f6e9ace1":"## 1. Data Preprocessing ","a458dd64":"## 2. Data Exploration","63938456":"#### 3.2. Split data into train, validation & test set","f4af541b":"- Numerical attributes having skewed distributions: clock_speed,fc,m_dep, px_height, sc_w. We will apply median as a measure of central tendency.\n- Other numerical attributes having symmetrical distributions, we will apply mean as a measure of central tendency.","40050c58":"Two-third of the phone market has 3g, while other attributes share similiar distribution.","d766e935":"#### 3.1. Preprocessing data","10ddc29e":"We can see these attributes having relationship with each other:\n- Price range vs. ram: high positive correlation\n- fc vs. pc: positive correlation\n- four_g vs. three_g: positive correlation\n- pc_height vs. pc_width: positive correlation","0de87113":"High-priced phones seem to have:\n    - Better battery: higher 'battery_power' and higher 'talk_time' \n    - Better camera: \n        - higher 'pc': primary camera mega pixels\n        - higher 'px_height': Pixel Resolution Height\n        - higher 'px_width': Pixel Resolution Width\n    - Better memory:\n        - higher 'int_memory': internal memory\n        - higher 'ram': Random Access Memory","86190875":"# Mobile Price Classification\n\n## Objectives\nHelp Bob find out the relationship between features of a mobile phone and its price range. Additionally, build a model to help him predict the price range when values of features are given.\n\nTherefore:\n- Dependent variable: y = phone price range\n- Independent variables: x = \n    - id: ID\n    - battery_power: Total energy a battery can store in one time measured in mAh\n    - blue: Has bluetooth or not\n    - clock_speed: speed at which microprocessor executes instructions\n    - dual_sim: Has dual sim support or not\n    - fc: Front Camera mega pixels\n    - four_g: Has 4G or not\n    - int_memory: Internal Memory in Gigabytes\n    - m_dep: Mobile Depth in cm\n    - mobile_wt: Weight of mobile phone\n    - n_cores: Number of cores of processor\n    - pc: Primary Camera mega pixels\n    - px_height: Pixel Resolution Height\n    - px_width: Pixel Resolution Width\n    - ram: Random Access Memory in Megabytes\n    - sc_h: Screen Height of mobile in cm\n    - sc_w: Screen Width of mobile in cm\n    - talk_time: longest time that a single battery charge will last when you are\n    - three_g: Has 3G or not\n    - touch_screen: Has touch screen or not\n    - wifi: Has wifi or not\n\n## Steps\n1. Data Preprocessing\n2. Data Exploration\n    - General view of the phone market\n    - Relationship between phone attributes and price\n    - Attributes of high-priced vs. low-priced phones\n3. Build deep learning model to predict price range","0203a63d":"Findings:\n- Bluetooth and Wifi seem to not have a significant affect to phone price since they have similar distribution in every price range.","302713ac":"#### 2.1. General view of phone market","f0dbe59c":"This dataset is clean with no null values.","1b0b6bc6":"#### 1.1. Load data ","84e86012":"#### 2.3.1 Numerical Variables ","fa4216a4":"#### 3.4. Model Evaluation ","8c66f889":"Findings:\n- Whether the phone has touch screen or not seem to not have a significant affect to phone price since they have similar distribution in every price range.","b621427f":"## 3. Build model to predict price range","3d02e6e1":"Findings:\n- Nearly half of the phones have both 3g and 4g.\n- Phones must have 3g in order to have 4g.\n- These attributes seem to not affect the price very much as they have similar distributions in every price range.","9e524094":"#### 3.3. Build deep learning model to predict price range","fba45605":"#### 2.2. What attribute has the most effect on phone price? ","01fb92a7":"Findings:\n- Whether the phone has dual_sim or not seem to not have a significant affect to phone price since they have similar distribution in every price range.","53d0d7ff":"#### 1.2. Check for null values ","a7c5e462":"Here we can see that Ram has high positive correlation with Price Range. The larger the Ram the higher the price. Other attributes do not affect phone price as much as ram. ","6758eef6":"#### 2.3.2. Categorical Variables "}}