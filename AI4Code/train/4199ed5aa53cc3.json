{"cell_type":{"9f69d1c0":"code","60b10d8c":"code","e7b5c83f":"code","f9a16cde":"code","2e064654":"code","e7a39106":"code","c7845818":"code","c5fe2764":"code","92e516fe":"code","34b10334":"markdown","f7b3a260":"markdown","4d9c8cf2":"markdown","acf24a67":"markdown","b8b3bfeb":"markdown","a24e0d65":"markdown"},"source":{"9f69d1c0":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport matplotlib.image as mpimg","60b10d8c":"train = pd.read_csv('\/kaggle\/input\/challenges-in-representation-learning-facial-expression-recognition-challenge\/train.csv')\nprint(train.shape)","e7b5c83f":"train.head()","f9a16cde":"train['pixels'] = [np.fromstring(x, dtype=int, sep=' ').reshape(-1,48,48) for x in train['pixels']]","2e064654":"pixels = np.concatenate(train['pixels'])\nlabels = train.emotion.values\n\nprint(pixels.shape)\nprint(labels.shape)","e7a39106":"emotion_prop = (train.emotion.value_counts() \/ len(train)).to_frame().sort_index(ascending=True)\n\nemotion_prop","c7845818":"emotions = ['Angry','Disgust','Fear','Happy','Sad','Surprise','Neutral']","c5fe2764":"palette = ['orchid', 'lightcoral', 'orange', 'gold', 'lightgreen', 'deepskyblue', 'cornflowerblue']\n\nplt.figure(figsize=[12,6])\n\nplt.bar(x=emotions, height=emotion_prop['emotion'], color=palette, edgecolor='black')\n    \nplt.xlabel('Emotion')\nplt.ylabel('Proportion')\nplt.title('Emotion Label Proportions')\nplt.show()","92e516fe":"plt.close()\nplt.rcParams[\"figure.figsize\"] = [16,16]\n\nrow = 0\nfor emotion in np.unique(labels):\n\n    all_emotion_images = train[train['emotion'] == emotion]\n    for i in range(5):\n        \n        img = all_emotion_images.iloc[i,].pixels.reshape(48,48)\n        lab = emotions[emotion]\n\n        plt.subplot(7,5,row+i+1)\n        plt.imshow(img, cmap='binary_r')\n        plt.text(-30, 5, s = str(lab), fontsize=10, color='b')\n        plt.axis('off')\n    row += 5\n\nplt.show()","34b10334":"## Preprocess Data","f7b3a260":"## Load Training Data","4d9c8cf2":"## View Sample of Images","acf24a67":"## Import Packages","b8b3bfeb":"# **Facial Expression Recognition**\n## **Exploratory Data Analysis**\n### Alejandro Alemany, Sara Manrriquez, and Ben Zaretzky\n<br\/>\nIn this notebook we explore the facial expression recognition dataset.","a24e0d65":"## Label Distribution"}}