{"cell_type":{"3873006c":"code","8d538d8f":"code","1d4b6ba2":"code","4ddc4cab":"code","f059c891":"code","20a63c1a":"code","44527aa5":"code","6d0c3a61":"code","d8a7f227":"code","ed7c0f1b":"code","96c2fac4":"code","dcd0743f":"code","c647fb5f":"code","e1b3f0cf":"code","ea0b91d7":"markdown","effa9bbc":"markdown","4afd9080":"markdown","4d7f8414":"markdown","f8502602":"markdown","f1983d05":"markdown","a5266201":"markdown","15fcfb17":"markdown","c4e45c2a":"markdown","60827c37":"markdown","a0be001c":"markdown","ce0e9b9e":"markdown","ed19a229":"markdown"},"source":{"3873006c":"import os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","8d538d8f":"import pandas as pd","1d4b6ba2":"data_df = pd.read_csv(\"..\/input\/daily-consumption-of-fruit-vegetables-in-europe\/hlth_ehis_fv3e.tsv\", sep='\\t')","4ddc4cab":"print(list(data_df.columns))","f059c891":"data_df.head()","20a63c1a":"data_df.tail()","44527aa5":"pivot_data_col = data_df.columns[0]\ntime_columns = data_df.columns[1:]","6d0c3a61":"data_df['unit'] = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[0])\ndata_df['n_portion'] = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[1])\ndata_df['isced11'] = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[2])\ndata_df['sex'] = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[3])\ndata_df['age']     = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[4])\ndata_df['country'] = data_df[pivot_data_col].apply(lambda x: x.split(\",\")[5])","d8a7f227":"selected_columns = list(['unit', 'n_portion', 'sex', 'age', 'country']) +  list(time_columns)\ndata_df = data_df[selected_columns]","ed7c0f1b":"data_tr_df = data_df.melt(id_vars=['unit', 'n_portion', 'sex', 'age', 'country'], \n        var_name=\"time\", \n        value_name=\"value\")\ndata_tr_df['time'] = data_tr_df['time'].apply(lambda x: str(x))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"bp\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"b\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"u\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"c\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\"d\", \"\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: str(x).replace(\": \", \"NAN\"))\ndata_tr_df['value'] = data_tr_df['value'].apply(lambda x: float(x))","96c2fac4":"print(f\"Transformed data shape: {data_tr_df.shape} (rows\/columns)\")\ndata_tr_df.head()","dcd0743f":"data_tr_df.tail()","c647fb5f":"import pandas_profiling\npandas_profiling.ProfileReport(data_tr_df)","e1b3f0cf":"data_tr_df.to_csv(\"daily_consumption_fruit_vegetables_eu.csv\", index=False)","ea0b91d7":"# Export data in csv format","effa9bbc":"Let's also take a look to few of the rows.","4afd9080":"Let's inspect the result.","4d7f8414":"# Analysis preparation\n\n## Load packages","f8502602":"We select now only the new columns resulted from splitting the `pivot_data_col` and the time columns.","f1983d05":"Let's glimpse the data columns.","a5266201":"## Load the data\n\nThe datafiles are in TSV format. We will read the files using pandas, just include in the function call the `sep` (tab separator data).\nWe demonstrate first how to read and process the Annual data.","15fcfb17":"Then, we split from `pivot_data_col` the 6 separate fields:\n* unit;\n* n_portion;  \n* isced11 - ISCED-11 education attainment level classification;   \n* sex;\n* age - this is age group actually;  \n* geography (country);  ","c4e45c2a":"# Introduction\n\nWe show in this Kernel how we can process the data to prepare it for easier processing. Let's check the data files.","60827c37":"The first column is a composed one, containing 5 different information (unit, n_portion, isced-11 education indicator,sex, age, geography \/ country). The next columns are the years values.","a0be001c":"Next, we pivot the time columns using `melt` operation in pandas.  \nWe also make sure we transform `date` to be an integer (here is a year data).  \nWe set `value` to be a float, after we replace \": \" (for N\/A) with `NAN`.","ce0e9b9e":"# Data pre-processing\n\nWe start by defining two working lists.","ed19a229":"# A very preliminary exploratory data analysis\n\nThis would be a very short exploratory data analysis. The role of this Kernel is just to show how we can prepare the annual data for analysis and we already did this."}}