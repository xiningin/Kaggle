{"cell_type":{"07f2178c":"code","dfe48c60":"code","34762324":"code","2b6fddec":"code","e1f966f3":"code","39937a64":"code","afce6489":"code","d51ba631":"code","881ac16a":"code","803f7307":"code","14bc223d":"code","5ac46e17":"code","d30d97ff":"code","929bd82c":"code","7a769664":"code","a58ba2b4":"code","c3a5eb85":"code","6050a192":"code","0f9221c0":"markdown","1e42b50a":"markdown","fbb47aef":"markdown","8e65d87d":"markdown","05ba2b1a":"markdown","126d839c":"markdown","1b4296d4":"markdown","db850a97":"markdown","8c78ab21":"markdown","557d5bcf":"markdown","eb4ef180":"markdown"},"source":{"07f2178c":"# import libraries \nimport pandas as pd\nimport numpy as np","dfe48c60":"df=pd.read_csv('..\/input\/ChurnData.csv')","34762324":"df.head(5)","2b6fddec":"df.info()","e1f966f3":"# check to see if there are any missing data\nmissing_data=df.isnull()\nmissing_data.head(5)","39937a64":"for column in missing_data.columns.values.tolist():\n    print(column)\n    print(missing_data[column].value_counts())\n    print('')","afce6489":"df.shape","d51ba631":"df.corr()","881ac16a":"# selecting the features that we can use for our model development\ndf = df[['tenure', 'age', 'address', 'income', 'ed', 'employ', 'equip',   'callcard', 'wireless','churn']]\n\n# churn type is float. We need to change this to integer for our Logictic Regression\ndf['churn'] = df['churn'].astype('int')\ndf.head(5)\n","803f7307":"#lets see our column and row number now\ndf.shape","14bc223d":"# preprocessing and definning the X and y (Features and target)\nX=np.asarray(df[['tenure', 'age', 'address', 'income', 'ed', 'employ', 'equip']])\nX[0:5]","5ac46e17":"y=np.array(df['churn'])\ny[0:5]","d30d97ff":"# normalize and preprocess the dataset\nfrom sklearn import preprocessing\nX = preprocessing.StandardScaler().fit(X).transform(X)\nX[0:5]","929bd82c":"# split the data set for train and test\nfrom sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split( X, y, test_size=0.2, random_state=4)\nprint ('Train set:', X_train.shape,  y_train.shape)\nprint ('Test set:', X_test.shape,  y_test.shape)","7a769664":"# import required libraries and create the model with Logistic Regression\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.metrics import confusion_matrix\nLR = LogisticRegression(C=0.01, solver='liblinear').fit(X_train,y_train)\nLR","a58ba2b4":"# predict using the test set\nyhat = LR.predict(X_test)\nyhat","c3a5eb85":"# predict probability (estimates) for all classes \n# first column will be probability of class 1 and second column is probability of class 0\nyhat_prob = LR.predict_proba(X_test)\nyhat_prob","6050a192":"from sklearn.metrics import jaccard_similarity_score\njaccard_similarity_score(y_test, yhat)","0f9221c0":"# Data Wrangling and Exploration","1e42b50a":"# Model Selecting and Set Up\n\nThe reason we are picking logical regression as a machine learning method is that, linear regression is more for continues numbers such as predicting future house prices. Logical Regression is better to estimate class of a data point. We are trying to figure out what is the most probable class for a particular data point. ","fbb47aef":"There are no missing data at our dataset.","8e65d87d":"# Contents\n\n1- About the Dataset\n\n2- Data Collection and Understanding\n\n3- Data Wrangling and Exploration\n\n4- Model Selecting and Set Up\n\n5- Model Development\n\n6- Evaluation\n\n7- Conclusion\n","05ba2b1a":"There are 200 rows and 28 columns. We will not need all 28 columns to analyze and create our model. We can look at the correlation to see the relationship between these variables.","126d839c":"# Data Collection and Understanding","1b4296d4":"# Evaluation\n\nWe are going to use the jaccard index for the accuracy of our model. ","db850a97":"# About the Dataset\n\nThe data provided by the business is the historical dataset with all the customers. Each row represents one customer and we will use this dataset to predict the customer churn.\n\nWe can analyze this dataset to predict what behaviors will retain the customers and further develop customer retention focused programs. \n\nData set variables that requires explanation are as follow;\n\n* Churn: The Customers who left within the last month\n\n* Phone, Multiple Lines, Internet, Online Security, Online backup, device protection, tech support and streaming TV and movies: These variables are the services that each customer signed up for\n\n* Customer Account information: Shows how long the customer have been a member, contract, payment method, paperless billing, monthly charges, and total charges.\n\n* Demographic information about the customers: Gender, Age, If they have partners or dependents.\n\n","8c78ab21":"# Conclusion\n\nBased on our analysis, tenure, age, education, address, income , employment and equipment are the features that can impact of staying with the services provided or moving to another telecommunication provider. We based on model considering these variables, we split the data set to 20 \/ 80 , train and test data, trained the data set and used the test data for prediction. Our evaluation based on jaccard index is 75% accurate. ","557d5bcf":"# Introduction\n\nTelecommunication industry is getting bigger and having a huge impact on everyone's daily life. The industry is also getting very competitive. In this project we will analyze an extensive consumer data set for a telecommunication company and create a Machine Learning Algorithm by using Logistic Regression. The Business is concerned about many customers leaving the land-line business for other cable competitors. The problem in question that we are trying to solve is \"Who are these customers leaving and why?\" Business also thinks it is easier and less costly to keep the existing customers rather than acquiring new ones. ","eb4ef180":"# Model Development"}}