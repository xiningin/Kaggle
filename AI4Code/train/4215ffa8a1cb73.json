{"cell_type":{"4c37886b":"code","c078b514":"code","9e4b279f":"code","c9a1311d":"code","a709544e":"code","222c7212":"code","745eff1d":"code","08d6d536":"code","9397db6e":"code","62b52099":"code","72e90c81":"code","f1e5a09f":"code","7d24c4d4":"code","d733165d":"code","3ba37e0b":"code","7cb05821":"code","4d1d8461":"code","76e9ac32":"code","115eec13":"code","a27eb33c":"code","6ae380c7":"code","2963b0b3":"code","4941fc52":"code","98361771":"code","2cb3adc7":"code","30e7e05a":"code","4ea81adb":"code","e7de14bf":"code","daa67653":"code","868a71e5":"code","f1f0bfee":"code","9972e8af":"code","5de992fb":"code","69249ea2":"code","08c746d9":"code","f0f1ff3c":"code","f385b76b":"code","2267103d":"code","e5381df1":"code","e482fae4":"code","24263e36":"code","519afdb8":"code","dcc4114c":"code","bb275558":"code","0ba357a0":"code","2d73df09":"markdown","725df274":"markdown","58085a07":"markdown","8a8eda0b":"markdown","52050c05":"markdown","829555d8":"markdown","748bab55":"markdown","02543d12":"markdown","5e5e98e7":"markdown","7897d074":"markdown","fe2f1ae0":"markdown","4021fb8e":"markdown","5eadf262":"markdown","2f9532d7":"markdown"},"source":{"4c37886b":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\n\nimport matplotlib.pyplot as plt\nfrom matplotlib import cm\n\nimport warnings\nwarnings.filterwarnings('ignore')\n\nfrom scipy.stats import norm","c078b514":"df_train = pd.read_csv('..\/input\/GiveMeSomeCredit\/cs-training.csv')\ndf_test = pd.read_csv('..\/input\/GiveMeSomeCredit\/cs-test.csv')\ndf_s = pd.read_csv('..\/input\/GiveMeSomeCredit\/sampleEntry.csv')","9e4b279f":"df_train.head()","c9a1311d":"df_test.head()","a709544e":"print(df_train.shape)\nprint(df_test.shape)","222c7212":"df_train['Id'] = df_train['Unnamed: 0']\ndf_train.drop('Unnamed: 0',axis = 1,inplace = True)\ndf_train.head()","745eff1d":"df_test['Id'] = df_test['Unnamed: 0']\ndf_test.drop('Unnamed: 0',axis = 1,inplace = True)\ndf_test.head()","08d6d536":"df_train.describe()","9397db6e":"df_train.isnull().sum()","62b52099":"df_train.nunique()","72e90c81":"df_test.isnull().sum()","f1e5a09f":"df_train['MonthlyIncome'].fillna(df_train['MonthlyIncome'].median(),inplace = True)\ndf_train['NumberOfDependents'].fillna(df_train['NumberOfDependents'].mode()[0],inplace = True)\ndf_test['MonthlyIncome'].fillna(df_test['MonthlyIncome'].median(),inplace = True)\ndf_test['NumberOfDependents'].fillna(df_test['NumberOfDependents'].mode()[0],inplace = True)","7d24c4d4":"df_train.isnull().sum()","d733165d":"df_test.isnull().sum()","3ba37e0b":"#\u5148\u770b\u770b\u8bad\u7ec3\u96c6\u4e2d\u7684\u76ee\u6807\u503c\u5206\u5e03\u60c5\u51b5\nsns.countplot(x = 'SeriousDlqin2yrs',data = df_train)\n\nplt.show()","7cb05821":"#\u770b\u770b\u53d8\u91cf\u7684\u70ed\u529b\u56fe\u5427\nf,ax = plt.subplots(figsize = (10,10))\nsns.heatmap(df_train.corr(),annot = True,cmap = 'BrBG',linewidths = .9,fmt = '.4f',ax = ax)\n\nplt.show()","4d1d8461":"Id = df_test['Id']\ndf_train.drop('Id',axis = 1,inplace = True)\ndf_test.drop('Id',axis = 1,inplace = True)","76e9ac32":"x = df_train.drop('SeriousDlqin2yrs',axis = 1)\ny = df_train['SeriousDlqin2yrs']","115eec13":"from sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import confusion_matrix,classification_report\nfrom sklearn.metrics import accuracy_score, recall_score, precision_score, f1_score\n\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.model_selection import GridSearchCV, cross_val_score, RandomizedSearchCV\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.neighbors import KNeighborsClassifier\n\nfrom xgboost import XGBClassifier","a27eb33c":"x_train,x_test,y_train,y_test = train_test_split(x.values,y.values,test_size = 0.3,random_state = 116214)","6ae380c7":"from sklearn.model_selection import GridSearchCV, RandomizedSearchCV\nRF = RandomForestClassifier()","2963b0b3":"param_grid = {\n    \"n_estimators\" : [9,18,27,36,100,150],\n    \"max_depth\" : [2,3,5,7,9],\n    \"min_samples_leaf\" : [2,4,6,8]\n}","4941fc52":"RF_random = RandomizedSearchCV(RF,param_distributions = param_grid,cv = 5)","98361771":"RF_random.fit(x_train,y_train)","2cb3adc7":"best_est_RF = RF_random.best_estimator_","30e7e05a":"print('\u8bad\u7ec3\u96c6\u5206\u7c7b\u51c6\u786e\u7387:{:.2f}'.format(RF_random.score(x_train,y_train)*100))\nprint('\u6d4b\u8bd5\u96c6\u5206\u7c7b\u51c6\u786e\u7387:{:.2f}'.format(RF_random.score(x_test,y_test)*100))","4ea81adb":"y_pred = best_est_RF.predict_proba(x_train)\ny_pred = y_pred[:,1]","e7de14bf":"##ROC\u66f2\u7ebf\u53ef\u89c6\u5316\nfrom sklearn.metrics import roc_curve,auc\n\nfpr,tpr,_ = roc_curve(y_train,y_pred)\nroc_auc = auc(fpr,tpr)\nplt.figure(figsize = (10,8))\nplt.title('Reciver Operating Characteristic')\nsns.lineplot(fpr,tpr,label = 'AUC = %0.4f' % roc_auc)\n\nplt.legend(loc = 'lower right')\nplt.plot([0,1],[0,1],'r--')\nplt.xlabel('\u5047\u9633\u7387')\nplt.ylabel('\u771f\u9633\u7387')\n\nplt.show()","daa67653":"df_test.drop('SeriousDlqin2yrs', axis = 1, inplace = True)\ny_pred = best_est_RF.predict_proba(df_test)\ny_pred = y_pred[:,1]","868a71e5":"df_s[\"Probability\"] = y_pred\ndf_s.head()","f1f0bfee":"df_s.to_csv(\"submission1.csv\",index = False)","9972e8af":"XGB = XGBClassifier(n_jobs = -1)\n\nparam_grid = {\n    'n_estimators' : [100,150,200,250,300],\n    \"learning_rate\" : [0.001,0.01,0.0001,0.05,0.10],\n    \"gamma\" : [0.0,0.1,0.2,0.3],\n    \"colsample_bytree\" : [0.5,0.7],\n    'max_depth' : [3,4,6,8]\n}","5de992fb":"XGB_random = RandomizedSearchCV(XGB,param_distributions = param_grid,cv = 5)","69249ea2":"XGB_random.fit(x_train,y_train)","08c746d9":"best_est_XGB = XGB_random.best_estimator_","f0f1ff3c":"print('\u8bad\u7ec3\u96c6\u5206\u7c7b\u51c6\u786e\u7387:{:.2f}'.format(XGB_random.score(x_train,y_train)*100))\nprint('\u6d4b\u8bd5\u96c6\u5206\u7c7b\u51c6\u786e\u7387:{:.2f}'.format(XGB_random.score(x_test,y_test)*100))","f385b76b":"from imblearn.over_sampling import SMOTE\nsmote = SMOTE(random_state = 0)\n\ns_x,s_y=smote.fit_resample(x_train,y_train)","2267103d":"RF_random.fit(s_x,s_y)","e5381df1":"best_est_RF1 = RF_random.best_estimator_","e482fae4":"print('\u8bad\u7ec3\u96c6\u5206\u7c7b\u51c6\u786e\u7387:{:.2f}'.format(RF_random.score(s_x,s_y)*100))\nprint('\u6d4b\u8bd5\u96c6\u5206\u7c7b\u51c6\u786e\u7387:{:.2f}'.format(RF_random.score(s_x,s_y)*100))","24263e36":"y_pred_new_RF = best_est_RF1.predict_proba(x_train)\ny_pred_new_RF = y_pred_new_RF[:,1]","519afdb8":"##ROC\u66f2\u7ebf\u53ef\u89c6\u5316\nfpr,tpr,_ = roc_curve(y_train,y_pred_new_RF)\nroc_auc = auc(fpr,tpr)\nplt.figure(figsize = (10,8))\nplt.title('Reciver Operating Characteristic')\nsns.lineplot(fpr,tpr,label = 'AUC = %0.4f' % roc_auc)\n\nplt.legend(loc = 'lower right')\nplt.plot([0,1],[0,1],'r--')\nplt.xlabel('\u5047\u9633\u7387')\nplt.ylabel('\u771f\u9633\u7387')\n\nplt.show()","dcc4114c":"prediction_RF = best_est_RF1.predict_proba(df_test)\npresiction_RF = prediction_RF[:,1]","bb275558":"df_s[\"Probability\"] = prediction_RF\ndf_s.head()","0ba357a0":"df_s.to_csv(\"submission2.csv\",index = False)","2d73df09":"## 4.\u6a21\u578b\u5f00\u53d1","725df274":"## \u4ecb\u7ecd\n\u672c\u6587\u5c06\u901a\u8fc7\u94f6\u884c\u7528\u6237\u7684\u6536\u652f\u501f\u8d37\u7b49\u4fe1\u606f\u6765\u5bf9\u7528\u6237\u7684\u4fe1\u7528\u8fdb\u884c\u8bc4\u4f30\uff0c\u5e76\u6700\u7ec8\u7ed9\u51fa\u5176\u5728\u4e24\u5e74\u5185\u903e\u671f\u4e0d\u8fd8\u6b3e\u7684\u6982\u7387\u3002  \n\u6a21\u578b\u5f00\u53d1\u6574\u4f53\u5305\u542b\u4ee5\u4e0b\u6d41\u7a0b\uff1a  \n1.\u6570\u636e\u8bfb\u53d6  \n2.\u6570\u636e\u9884\u5904\u7406  \n\u5305\u62ec\u7f3a\u5931\u503c\u53ca\u5f02\u5e38\u503c\u7684\u5904\u7406  \n3.\u5173\u8054\u6027\u8bc4\u4f30\u53ca\u53d8\u91cf\u9009\u62e9  \n\u901a\u8fc7\u7edf\u8ba1\u5b66\u65b9\u6cd5\uff08\u70ed\u529b\u56fe\uff09\u8bc4\u4f30\u5404\u53d8\u91cf\u5bf9\u76ee\u6807\u503cSeriousDlqin2yrs\u7684\u5f71\u54cd  \n4.\u6a21\u578b\u5f00\u53d1  \n\u57fa\u4e8eXGBboost\u53ca\u968f\u673a\u68ee\u6797\u6a21\u578b  \n5.\u4fe1\u7528\u8bc4\u5206  \nROC\u66f2\u7ebf\u53ef\u89c6\u5316\u53caAUC\u503c\u8bc4\u4f30\n\n","58085a07":"\u901a\u8fc7\u6570\u636e\u6587\u4ef6Data Dictionary.xls\u6587\u4ef6\u53ef\u77e5\u53d8\u91cf\u63cf\u8ff0\u5982\u4e0b\uff1a","8a8eda0b":"## 2.\u6570\u636e\u9884\u5904\u7406","52050c05":"## 3.\u5173\u8054\u6027\u8bc4\u4f30\u53ca\u53d8\u91cf\u9009\u62e9","829555d8":"\u663e\u7136ID\u53d8\u91cf\u5bf9\u76ee\u6807\u503c\u57fa\u672c\u6ca1\u5565\u5f71\u54cd\u3002","748bab55":"\u4ece\u4e0a\u8ff0\u6837\u672c\u63cf\u8ff0\u6765\u770b\uff0c  \n\u53d8\u91cfMonthlyIncome\u7f3a\u5931\u8f83\u5927\uff0c\u65e0\u6cd5\u901a\u8fc7\u5220\u9664\u6709\u7f3a\u53f2\u503c\u7684\u6837\u672c\u8fdb\u884c\u5904\u7406\uff0c\u540c\u65f6\u76f8\u5bf9\u4e8e\u5341\u4e07\u6570\u91cf\u7ea7\u7684\u6837\u672c\u6765\u8bf4\uff0c3\u4e07\u5de6\u53f3\u7684\u7f3a\u5931\u53c8\u6ca1\u6709\u5927\u5230\u8db3\u4ee5\u5220\u9664\u6574\u4e2a\u53d8\u91cf\uff0c\u6240\u4ee5\u91c7\u53d6\u586b\u5145\u5904\u7406\u3002  \n\u800c\u53d8\u91cfNumberOfDependents\u7f3a\u5931\u5f88\u5c11\uff0c\u5982\u4f55\u5904\u7406\u5bf9\u6574\u4f53\u5f71\u54cd\u4e0d\u5927\u3002","02543d12":"## 1.\u6570\u636e\u8bfb\u53d6","5e5e98e7":"| \u5e8f\u53f7 | \u53d8\u91cf\u540d | \u53d8\u91cf\u63cf\u8ff0 |\n|-|-|-|\n|1|SeriousDlqin2yrs|\u8fd1\u4e24\u5e74\u5185\u662f\u5426\u51fa\u73b0\u903e\u671f90\u5929\u53ca\u4ee5\u4e0a\u7684\u60c5\u51b5(\u76ee\u6807\u503c)|\n|2|RevolvingUtilizationOfUnsecuredLines|\u65e0\u62c5\u4fdd\u8d37\u6b3e\u6570\u91cf\u5360\u603b\u8d37\u6b3e\u6570\u6bd4\u7387|\n|3|age|\u501f\u6b3e\u4eba\u5e74\u9f84|\n|4|NumberOfTime30-59DaysPastDueNotWorse|\u8fd1\u4e24\u5e74\u5185\u903e\u671f30-59\u5929\u7684\u6b21\u6570|\n|5|DebtRatio|\u8d1f\u503a\u6bd4|\n|6|MonthlyIncome|\u6708\u6536\u5165|\n|7|NumberOfOpenCreditLinesAndLoans|\u8f66\u623f\u8d37\u7684\u6570\u91cf|\n|8|NumberOfTimes90DaysLate|\u8fc7\u5f80\u903e\u671f90\u5929\u53ca\u4ee5\u4e0a\u7684\u6b21\u6570|\n|9|NumberRealEstateLoansOrLines|\u4e0d\u52a8\u4ea7\u62b5\u62bc\u8d37\u6b3e\u7684\u6570\u91cf|\n|10|NumberOfTime60-89DaysPastDueNotWorse|\u8fd1\u4e24\u5e74\u5185\u903e\u671f60-89\u5929\u7684\u6b21\u6570|\n|11|NumberOfDependents|\u5bb6\u5c5e\u6570\u91cf|\n","7897d074":"### 2.1\u5220\u9664\u5f02\u5e38\u503c","fe2f1ae0":"### 4.1\u968f\u673a\u68ee\u6797\u5206\u7c7b\u6a21\u578b","4021fb8e":"### 4.2\u52a0\u5165XGB\u5206\u7c7b\u5668","5eadf262":"### 2.2\u7a7a\u503c\u7b5b\u9009","2f9532d7":"### 2.3\u7a7a\u503c\u586b\u5145\n\u201c\u4e8c\u516b\u5b9a\u5f8b\u201d\u544a\u8bc9\u6211\u4eec\uff0c\u5f80\u5f8020%\u7684\u4eba\u638c\u63e1\u4e8680%\u7684\u793e\u4f1a\u8d22\u5bcc\uff0c\u6240\u4ee5\u663e\u7136\u5e73\u5747\u6570\u65e0\u6cd5\u7528\u6765\u8861\u91cf\u6837\u672c\u6574\u4f53\u6536\u5165\u3002  \n\u8fd9\u91cc\u6211\u4eec\u7528pin\u6570\u586b\u5145MonthlyIncome\u3002  \n\u800cNumberOfDependents\u53d8\u91cf\u7528\u5e73\u5747\u6570\u6216\u4f17\u6570\u5176\u5b9e\u90fd\u53ef\u4ee5\uff0c\u52a0\u4e4b\u7f3a\u5931\u8f83\u5c11\uff0c\u6240\u4ee5\u5f71\u54cd\u5f88\u5c0f\u3002\u8fd9\u91cc\u9009\u7528\u4e86\u4f17\u6570\u586b\u5145\u3002"}}