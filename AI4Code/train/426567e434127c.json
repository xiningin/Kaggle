{"cell_type":{"e983e753":"code","f5d19bb4":"code","c13f2520":"code","187f5747":"code","a0aa3316":"code","cbef9d5b":"code","79b6e10b":"code","5517eee4":"code","3385dee7":"code","b43d1389":"code","92fa0095":"code","844ca9fe":"code","7af12e30":"code","1392502d":"code","170a8ad1":"code","0f0e5699":"code","7749666c":"code","41d87604":"code","2dc7e151":"code","ebc38c2c":"code","962f2f60":"code","6a033970":"code","44f9eb27":"code","ce27c3ed":"markdown","ff71dab8":"markdown","af96edcf":"markdown","d56785fe":"markdown","fe50df65":"markdown","7cc5f5c1":"markdown","ab4e9123":"markdown","3a7a2836":"markdown"},"source":{"e983e753":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","f5d19bb4":"from sklearn.preprocessing import LabelEncoder\nfrom sklearn.linear_model import LogisticRegression","c13f2520":"train_users_game1_df = pd.read_csv(\"..\/input\/ds2019uec-task2\/train_users_game1.csv\")\ntrain_users_game2_df = pd.read_csv(\"..\/input\/ds2019uec-task2\/train_users_game2.csv\")\ntest_users_game1_df = pd.read_csv(\"..\/input\/ds2019uec-task2\/test_users_game1.csv\")","187f5747":"train_users_game1_df.head()","a0aa3316":"train_users_game2_df.head()","cbef9d5b":"test_users_game1_df.head()","79b6e10b":"train_user_encoder = LabelEncoder()\ntrain_user_encoder.fit(np.concatenate([train_users_game1_df[\"user_id\"], train_users_game2_df[\"user_id\"]]))\nprint(train_user_encoder.classes_.shape)\ngame1_encoder = LabelEncoder()\ngame1_encoder.fit(np.concatenate([train_users_game1_df[\"game_title\"], test_users_game1_df[\"game_title\"]]))\nprint(game1_encoder.classes_.shape)","5517eee4":"X = np.zeros((9393, 4155))\nuser_vec = train_user_encoder.transform(train_users_game1_df[\"user_id\"])\ngame_vec = game1_encoder.transform(train_users_game1_df[\"game_title\"])\n\nfor i, j in zip(user_vec, game_vec):\n    X[i, j] = 1","3385dee7":"Y_mat = np.zeros((9393, 1000))\nuser_vec = train_user_encoder.transform(train_users_game2_df[\"user_id\"])\ngame_vec = train_users_game2_df[\"predict_game_id\"]\n\nfor i, j in zip(user_vec, game_vec):\n    Y_mat[i, j] = 1","b43d1389":"lr_899 = LogisticRegression()\nlr_899.fit(X, Y_mat[:, 899])","92fa0095":"pred_train_899 = lr_899.predict_proba(X)[:, 1]","844ca9fe":"pred_train_899.mean()","7af12e30":"# \uff08\u30b3\u30f3\u30da\u8a55\u4fa1\u6307\u6a19\u306e\u672c\u984c\u3068\u306f\u5916\u308c\u308b\u304c\uff09AUC\u3092\u898b\u3066\u307f\u308b\nfrom sklearn.metrics import roc_auc_score\nroc_auc_score(Y_mat[:, 899], pred_train_899)","1392502d":"test_users = pd.read_csv(\"..\/input\/ds2019uec-task2\/test_user_ids.csv\")[\"user_id\"]","170a8ad1":"test_user_encoder = LabelEncoder()\ntest_user_encoder.fit(test_users)\nprint(test_user_encoder.classes_.shape)","0f0e5699":"X_test = np.zeros((3000, 4155))\nuser_vec_test = test_user_encoder.transform(test_users_game1_df[\"user_id\"])\ngame_vec = game1_encoder.transform(test_users_game1_df[\"game_title\"])\n\nfor i, j in zip(user_vec_test, game_vec):\n    X_test[i, j] = 1","7749666c":"pred_test_899 = lr_899.predict_proba(X_test)[:, 1]","41d87604":"pred_test_899.mean()","2dc7e151":"pred_test_899.shape","ebc38c2c":"pred_test_mat = np.zeros((3000, 1000))\npred_test_mat[:, 899] = pred_test_899","962f2f60":"res_list = [\"\"] * 3000\nfor i in range(3000):\n    res_list[i] = \" \".join([str(i) for i in np.argsort(-pred_test_mat[i, :])[:10]])\n\nsample_submission_df = pd.read_csv(\"..\/input\/ds2019uec-task2\/sample_submission.csv\")\nsub_df = sample_submission_df.copy()\nsub_df[\"purchased_games\"] = res_list","6a033970":"sub_df.head()","44f9eb27":"sub_df.to_csv(\"enjoy_your_submission.csv\", index=False)","ce27c3ed":"# \u3053\u3053\u304b\u3089\u3069\u3046\u3059\u308b\uff1f \u306e\u4f8b  \n* \u30e2\u30c7\u30eb\u30921000\u500b\u4f5c\u308b\u30b4\u30ea\u62bc\u3057\n* \u30e2\u30c7\u30eb\u69cb\u7bc9\u624b\u6cd5\u3092\u7cbe\u5ea6\u304c\u51fa\u308b\u3082\u306e\u306b\u3059\u308b\n* \u30c7\u30a3\u30fc\u30d7\u30e9\u30fc\u30cb\u30f3\u30b0\n* \u5165\u529b\u306e\u8ffd\u52a0\uff08\u3053\u3053\u307e\u3067play_hour\u5168\u304f\u4f7f\u3063\u3066\u306a\u3044\uff09 \n* \u30bf\u30a4\u30c8\u30eb\u306e\u30c6\u30ad\u30b9\u30c8\u3092NLP\u6280\u8853\u3067\u4f55\u304b\u3059\u308b\uff1f  \n* \u5f37\u529b\u306a\u76f8\u95a2\u30eb\u30fc\u30eb\u3092\u624b\u3067\u63a2\u3057\u3066\u697d\u3057\u3080\uff1f","ff71dab8":"# \u6295\u7a3f\u7528\u306e\u7d20\u6750\u30b3\u30fc\u30c9","af96edcf":"# \u8aac\u660e\u5909\u6570\ntrain_users_game1\u3092purchase\u3092\u8868\u30590\/1\u884c\u5217\u306b\u3059\u308b  ","d56785fe":"# test\u3078\u306e\u9069\u7528","fe50df65":"# \u4f8b: 889\u306e\u30bf\u30a4\u30c8\u30eb\u306e\u8cfc\u5165\u78ba\u7387","7cc5f5c1":"\u2191\u3053\u3053\u307e\u3067\u306f\u81ea\u5206\u3067\u4f5c\u308b  \n\u2193\u305d\u3057\u305f\u3089\u3053\u308c\u3067user\u3054\u3068\u306b\u78ba\u7387\u9ad8\u3044\u9806\u306b10\u500b\u3068\u3063\u3066\u6295\u7a3f\u7528\u306e\u30d5\u30a9\u30fc\u30de\u30c3\u30c8\u306b\u3059\u308b\u3002\u4e2d\u8eab\u306f\u3088\u304f\u308f\u304b\u3093\u306a\u304f\u3066\u3082OK  \n\u203bencoder\u3092\u81ea\u5206\u3067\u3044\u3058\u3063\u3066\u308b\u3068\u6574\u5408\u53d6\u308c\u306a\u3044\u306e\u3067\u6ce8\u610f","ab4e9123":"\u307e\u305atrain\u306euser_id\u304c\u9023\u756a\u3067\u306a\u3044\u306e\u3067\u3001\u9023\u756a\u306b\u3059\u308b  \ntrain\u306egame_title\u3082\u9023\u756a\u3092\u4ed8\u4e0e\u3059\u308b  \n\u203b\u9023\u756a\u306b\u3057\u306a\u3044\u3068\u884c\u5217\u306b\u3057\u305f\u3068\u304d\u306b\u3059\u3054\u304f\u7121\u99c4\u306b\u306a\u308b\u306e\u3067","3a7a2836":"# \u76ee\u7684\u5909\u6570"}}