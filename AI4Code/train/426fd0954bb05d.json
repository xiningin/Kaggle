{"cell_type":{"93c72164":"code","64f1d0eb":"code","05cd2be7":"code","8b2c2a87":"code","22430b14":"code","de279cb2":"code","fc777ea2":"code","71c4054f":"code","57bd37b2":"code","3b98c1a4":"code","5de9792c":"code","e1399c09":"code","7c16b175":"code","0ee2195a":"code","0dd74159":"code","dbe95cca":"code","590bc057":"code","57e7ba43":"code","47e39c10":"code","3f6f87c9":"code","57f7955a":"code","ee9a4ca1":"code","5343a5ee":"code","8502fc4f":"code","7501f9ef":"markdown"},"source":{"93c72164":"# Import the important libraries\nimport pandas as pd\nimport numpy as np","64f1d0eb":"# Read files\ndf_train  = pd.read_csv(\"..\/input\/urack-store-sales\/train.csv\")\ndf_test  = pd.read_csv(\"..\/input\/urack-store-sales\/test.csv\")\ndf_store  = pd.read_csv(\"..\/input\/urack-store-sales\/store.csv\")\ndf_sample_sub  = pd.read_csv(\"..\/input\/urack-store-sales\/sample submission.csv\")","05cd2be7":"# Check train data6\ndf_train.head()","8b2c2a87":"# Check test data\ndf_test.head()","22430b14":"# Check store data\ndf_store.head()","de279cb2":"# Rows and columns\nprint(df_train.shape)\nprint(df_test.shape)\nprint(df_sample_sub.shape)\nprint(df_store.shape)","fc777ea2":"# Check count of misisng values\ndf_train.isnull().sum()\n# No missing values in train data","71c4054f":"# Check count of misisng values\ndf_store.isnull().sum()\n# missing values in store data","57bd37b2":"# Summary of store data\ndf_store.describe()","3b98c1a4":"# Summary of train data\ndf_train.describe()","5de9792c":"## Build your model - only using sales\/train data","e1399c09":"# Get X and y data\nX=df_train.drop(['Sales','Date','HolidayFlag'], axis =1)\ny=df_train['Sales']","7c16b175":"#### Split data on train and test\nimport sklearn.model_selection as model_selection","0ee2195a":"# Train and test split\nX_train,X_test,y_train,y_test=model_selection.train_test_split(X,y,test_size=0.20,random_state=42)","0dd74159":"# Import ensemble\nimport sklearn.tree as tree","dbe95cca":"# Create regression tree object\nreg=tree.DecisionTreeRegressor(max_depth=3)","590bc057":"# Fit the model on tarin data\nreg=reg.fit(X_train,y_train)","57e7ba43":"# Predictions\npreds = reg.predict(df_test.drop(['Id','Date','HolidayFlag'], axis =1))","47e39c10":"preds.shape","3f6f87c9":"df_submission = df_sample_sub.copy()","57f7955a":"df_submission['Sales'] = preds","ee9a4ca1":"df_submission","5343a5ee":"# Root mean square pct error function\ndef rmspe(y, yhat):\n    rmspe = np.sqrt(np.mean( (y - yhat)**2 ))\n    return rmspe","8502fc4f":"# submission file\ndf_submission.to_csv(\".\/submission.csv\", index = False)","7501f9ef":"Perform all the other important data analysis\n\n-Data Understanding\n-Data Cleaning\/ Quality checks\n-Data Manipulations\n-Data Exploration and Viz\n-Modeling (Development and Evaluation)\n-Submissions"}}