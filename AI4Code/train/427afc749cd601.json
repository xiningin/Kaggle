{"cell_type":{"591bd7f5":"code","2aad69f7":"code","c03b2ae0":"code","16429b2b":"code","844af931":"code","0933fcb9":"code","1f8fb9df":"code","2107f424":"code","1f822353":"code","b7238409":"code","6d3dbebf":"code","ebe78b37":"code","50bbb1cd":"code","0a8ea5d2":"code","f57e48fe":"code","f90c3068":"code","675ad5c1":"markdown","e647a15d":"markdown","4dce259a":"markdown"},"source":{"591bd7f5":"import pandas as pd\nimport numpy as np\nimport csv","2aad69f7":"# File path shortcut\n# Make changes to these as necessary, these aren't fully automated yet. \n# Then everything below this cell should be automated. \ncsv_name = '\\Detailed_Statistics_Arrivals (10).csv'\ndest_name = '\\Las Vegas Arrivals'\nfilename = r'Datasets\\Unprocessed'+dest_name+csv_name\nfilename\n\nfilename_cleaned = 'Datasets\\Processed'+dest_name+csv_name","c03b2ae0":"# Write to skip first 6 lines\n# Problem solved:\n# https:\/\/www.kite.com\/python\/answers\/how-to-delete-a-line-from-a-file-in-python\n\n# Read unprocessed file \nfile = open(filename, 'r+')\nlines = file.readlines()\n# Close unprocessed file\nfile.close()\n\n# Remove excess content in CSV\nfor i in range(6): \n    # print(i, lines[0])\n    del lines[0]\n\n# Delete the last line\n# print(i, lines[-1])\ndel lines[-1]\n\n# Write to a new file and dir\nnew_file = open(filename_cleaned, 'w+')\nfor line in lines:\n    new_file.write(line)\n\nnew_file.close()","16429b2b":"# Alaska Airlines Destination:(LAX) example, 2019\nfilename = r'Datasets\\Processing'+dest_name+csv_name\nmy_data = pd.read_csv(filename)","844af931":"my_data.head()","0933fcb9":"my_data.tail()","1f8fb9df":"my_data.info()","2107f424":"# Create copy, checkpoint!!\ndf = my_data.copy()","1f822353":"# Look at uppercase columns\ndf.columns","b7238409":"# Convert to lowercase columns\ndf.columns = df.columns.str.lower()\ndf.columns","6d3dbebf":"df.info()","ebe78b37":"df_cols = df.columns.str.replace(\"[()]\", \"\").str.replace(\" \", \"_\").str.replace(\"date_mm\/dd\/yyyy\", \"date\")","50bbb1cd":"df_cols.values","0a8ea5d2":"df.columns = df_cols","f57e48fe":"df","f90c3068":"# Export to csv\ndf.to_csv('Datasets\/Processed\/' + dest_name + csv_name, index=False)","675ad5c1":"## What this file does:\n- Deletes excess lines unnecessary of data (first 6 lines and last line)\n- Saves processed file to 'Processing' folder\n- Check that there are no missing values\n- Check that all values are valid \n- Replace headers with lower case and space as underscores for SQL database\n- Saves cleaned file to 'Processed' folder\n\n## Things to improve\/To do list:\n- Change dates to actual date data type and make it the index\n- Loop thru multiple files in a folder\n- Index like.. Detailed_Statistics_Arrivals (n).csv, where n = 1-13\n- Extract city name, so that it can be used for file naming\n- Speaking of file naming, create a script so that folders are automatically createda","e647a15d":"# Data Cleaning","4dce259a":"\nBTS | Detailed Statistics Arrival Scraper\n\n@Author: Pete Aguirre II \n"}}