{"cell_type":{"386c0133":"code","85588aee":"code","43131700":"code","c0506fae":"code","c13d9658":"code","d33443b2":"code","d5910f1e":"code","6eb2922a":"code","2bfd57d8":"code","e1303550":"code","efb8adb3":"code","714e64ee":"code","610947d6":"code","1f1d9954":"code","ba11d4d1":"code","5126403b":"code","1890f75d":"code","e34f80c3":"code","0ba4b567":"code","302b96d0":"code","77a62d7a":"code","bab2d515":"code","11b0014b":"code","0a4b25e4":"code","1a80c506":"code","bc278b8d":"code","5b9534d5":"code","0813ee04":"code","2cbad2c1":"code","d12d8c6c":"code","1de048b9":"code","c1c56fd5":"code","314ac82d":"code","3e22794e":"markdown","560ac09f":"markdown","6859a2d3":"markdown","e295fbe4":"markdown","52d05503":"markdown","b0d7d1af":"markdown","96e76ba4":"markdown","d4bdb9af":"markdown","c7c05f91":"markdown","6f82ec72":"markdown"},"source":{"386c0133":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","85588aee":"import seaborn as sns\nimport matplotlib.pyplot as plt","43131700":"dataset = pd.read_csv(\"..\/input\/health-insurance-cross-sell-prediction\/train.csv\")\ndataset.head()","c0506fae":"dataset.isnull().sum()","c13d9658":"dataset.info()","d33443b2":"dataset['Gender'] = dataset['Gender'].replace(to_replace = ['Male','Female'],value = [0,1])\ndataset['Vehicle_Damage'] = dataset['Vehicle_Damage'].replace(to_replace = ['Yes','No'], value = [1,0])","d5910f1e":"dataset.head()","6eb2922a":"dataset['Vehicle_Age'].value_counts()","2bfd57d8":"sns.barplot('Response', 'Annual_Premium', data = dataset)","e1303550":"sns.barplot(\"Vehicle_Age\", \"Response\", data = dataset)","efb8adb3":"sns.barplot(\"Gender\", \"Response\", data = dataset)","714e64ee":"men_in = [1 if dataset[\"Gender\"][i] == 0 and dataset['Response'][i] == 1 else 0 for i in range(len(dataset[\"Gender\"]))]\nmen_out = [1 if dataset[\"Gender\"][i] == 0 and dataset['Response'][i] == 0 else 0 for i in range(len(dataset[\"Gender\"]))]\nwomen_out = [1 if dataset[\"Gender\"][i] == 1 and dataset['Response'][i] == 0 else 0 for i in range(len(dataset[\"Gender\"]))]\nwomen_in = [1 if dataset[\"Gender\"][i] == 1 and dataset['Response'][i] == 1 else 0 for i in range(len(dataset[\"Gender\"]))]","610947d6":"print(\"total customers: \", len(dataset[\"Gender\"]))\nprint(\"men who insuranced: \",sum(men_in))\nprint(\"men who did not buy insurance:\", sum(men_out))\nprint(\"women who insuranced: \",sum(women_in))\nprint(\"women who did not buy insurance:\", sum(women_out))","1f1d9954":"sns.barplot(\"Driving_License\", \"Response\", data = dataset)","ba11d4d1":"sns.barplot(\"Previously_Insured\", \"Response\", data = dataset)","5126403b":"sns.FacetGrid(data= dataset, hue=\"Response\", height=5).map(sns.distplot, \"Age\").add_legend()","1890f75d":"plt.figure(figsize = (16,16))\nsns.heatmap(dataset.corr(),annot = True, cmap = \"Blues\")\nplt.show()","e34f80c3":"dataset['Vehicle_Age'] = dataset['Vehicle_Age'].replace(to_replace = [\"1-2 Year\",\"< 1 Year\",\"> 2 Years\"], value =[1,0,2] )","0ba4b567":"dataset_new = dataset.drop(['Region_Code', 'Policy_Sales_Channel','Vintage','Annual_Premium'], axis = 1)\ndataset_new.head()","302b96d0":"x = dataset_new.iloc[:,:-1].values\ny = dataset_new.iloc[:,-1].values\nprint(pd.DataFrame(x)) #coz i am retarded","77a62d7a":"from sklearn.linear_model import LogisticRegression\nfrom xgboost import XGBClassifier\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.model_selection import train_test_split","bab2d515":"# train_test split is used only for accuracy measurement before submission, has nothing to do with competition\nx_train,x_test,y_train,y_test = train_test_split(x,y, test_size = 0.2,random_state = 177013)","11b0014b":"XGB = XGBClassifier(n_estimators = 1000, alpha = 0.1, random_state = 177013)\nLR = LogisticRegression()\nDTC = DecisionTreeClassifier()","0a4b25e4":"XGB.fit(x_train,y_train)\nLR.fit(x_train,y_train)\nDTC.fit(x_train,y_train)","1a80c506":"y_pred_XGB = XGB.predict(x_test)\ny_pred_LR = LR.predict(x_test)\ny_pred_DTC = DTC.predict(x_test)","bc278b8d":"from sklearn.metrics import accuracy_score\ncm1 = accuracy_score(y_pred_XGB,y_test)\ncm2 = accuracy_score(y_pred_LR,y_test)\ncm3 = accuracy_score(y_pred_DTC,y_test)\nprint(\"XGB score: {0} \\nLR score : {1} \\nDTC score : {2}\".format(cm1,cm2,cm3))","5b9534d5":"def preprocessing(dataset):\n    dataset['Gender'] = dataset['Gender'].replace(to_replace = ['Male','Female'],value = [0,1])\n    dataset['Vehicle_Damage'] = dataset['Vehicle_Damage'].replace(to_replace = ['Yes','No'], value = [1,0])\n    dataset['Vehicle_Age'] = dataset['Vehicle_Age'].replace(to_replace = [\"1-2 Year\",\"< 1 Year\",\"> 2 Years\"], value =[1,0,2] )\n    dataset = dataset.drop(['Region_Code', 'Policy_Sales_Channel','Vintage','Annual_Premium'], axis = 1)\n    return dataset","0813ee04":"test_set = pd.read_csv(\"..\/input\/health-insurance-cross-sell-prediction\/test.csv\")\ntestset = preprocessing(test_set)\ntestset","2cbad2c1":"test = testset.iloc[:,:].values \ntest","d12d8c6c":"y_pred = DTC.predict(test)","1de048b9":"submission = pd.DataFrame(y_pred,testset['id'])","c1c56fd5":"submission = submission.rename(columns = {0:'Response'})","314ac82d":"submission.to_csv('.\/submission.csv')","3e22794e":"### Exploratory data analysis","560ac09f":"### test_set","6859a2d3":"#### people with Driving license insuranced more","e295fbe4":"#### people who previously insuranced DID NOT insurance this time, maybe they already have a policy or this company is just bad","52d05503":"### choosing the models","b0d7d1af":"#### vehicle more than 2 years old has more insurance rate","96e76ba4":"#### since Logistic Regression has more accuracy. ~i will use it for submission.~ LR seems to not classify anything as 1,\n#### so, i will go with XGboost ","d4bdb9af":"### checking for missing data","c7c05f91":"#### more men insuranced than women (men insured 56% more than women)","6f82ec72":"#### Younger people did not insurance. while the avg insurance age is around 40-50"}}