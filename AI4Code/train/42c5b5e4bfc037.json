{"cell_type":{"a811ea86":"code","493d84a9":"code","d7005677":"code","80251d0c":"code","40690c60":"code","e8b16e1b":"code","40f6a4e6":"code","e7281630":"code","484145cb":"code","401b1f91":"code","bedd736d":"code","791a65b4":"code","652e3959":"code","84e8490f":"code","321f2774":"code","ade00422":"code","798eda3c":"code","a22631a0":"code","0154e858":"code","04e55299":"code","866d1fe7":"code","51f7e107":"code","a1d1264b":"code","5e538328":"code","4e4b64c5":"code","4718b83b":"code","2d8a1d28":"code","3ad9ce4c":"code","fd8e07de":"code","badaac0d":"code","12491c0f":"code","295f0d84":"code","0b0721b7":"code","828f80d1":"code","d1ca73aa":"code","cba6ec03":"code","dbd3e342":"code","5ce6ed3b":"code","7eff6089":"code","e079ffa9":"code","07d4fcd0":"code","4d45fab1":"code","88bf8644":"code","c967936b":"code","2fe333a6":"code","9b4b92b4":"code","0cf98f74":"code","9ccca319":"markdown"},"source":{"a811ea86":"import os\nprint(os.listdir(\"..\/input\"))\n\nimport pandas as pd\nimport matplotlib.pyplot as plt","493d84a9":"train = pd.read_csv('..\/input\/train.csv')","d7005677":"test_data = pd.read_csv('..\/input\/test.csv')","80251d0c":"train.shape","40690c60":"# \u0437\u0430\u043f\u043e\u043b\u043d\u044f\u0435\u043c Y \u0438\u0437 \u0434\u0430\u0442\u0430\u0441\u0435\u0442\u0430 \u0438 \u0443\u0434\u0430\u043b\u044f\u0435\u043c \u0435\u0433\u043e \u0438\u0437 \u0442\u0430\u0431\u043b\u0438\u0446\u044b\nY  = train['label'].values\ntrain.drop(['label'], axis=1, inplace=True)","e8b16e1b":"# \u043e\u0441\u0442\u0430\u0432\u0448\u0438\u0435\u0441\u044f \u0434\u0430\u043d\u043d\u044b\u0435 \u043a\u0438\u0434\u0430\u0435\u043c \u0432 \u043c\u0430\u0442\u0440\u0438\u0446\u0443 X\nX = train.values","40f6a4e6":"X.shape","e7281630":"X[0]","484145cb":"img_0 = X[0].reshape( (28,28))\nimg_1 = X[1].reshape((28,28))","401b1f91":"plt.figure()\nplt.imshow(img_0, cmap='gray')\nplt.show()","bedd736d":"plt.figure()\nplt.imshow(img_1, cmap='gray')\nplt.show()","791a65b4":"Y[0]","652e3959":"Y[1]","84e8490f":"from sklearn.model_selection import train_test_split","321f2774":"X_train, X_test, Y_train, Y_test = train_test_split(X, Y, test_size=0.2)","ade00422":"X_train.shape","798eda3c":"X = X \/ 255.0","a22631a0":"X_valid = test_data.values","0154e858":"X_valid[0]","04e55299":"X_train = X_train \/ 255.0","866d1fe7":"X_train.shape","51f7e107":"Y_train.shape","a1d1264b":"from sklearn.ensemble import RandomForestClassifier","5e538328":"clf = RandomForestClassifier(max_depth=9, n_estimators=2000, n_jobs=-1, verbose=1)","4e4b64c5":"clf.fit(X_train, Y_train)","4718b83b":"from sklearn.metrics import accuracy_score","2d8a1d28":"Y_predict = clf.predict(X_test)","3ad9ce4c":"accuracy_score(Y_test, Y_predict)","fd8e07de":"predict = clf.predict(test_data)","badaac0d":"predict","12491c0f":"sample = pd.read_csv('sample_submission.csv')","295f0d84":"sample.shape","0b0721b7":"predict.shape","828f80d1":"import numpy as np","d1ca73aa":"sample","cba6ec03":"l = sample['ImageId'].values","dbd3e342":"l","5ce6ed3b":"predict\ntype(predict)","7eff6089":"import csv","e079ffa9":"type(sample)","07d4fcd0":"sample_array = sample['ImageId'].values\ntype(sample_array)","4d45fab1":"sample_array[0]","88bf8644":"predict = pd.Series(predict,name=\"Label\")","c967936b":"predict.shape","2fe333a6":"s2 = pd.concat([pd.Series(range(1,28001),name = \"ImageId\"),predict],axis = 1)","9b4b92b4":"s2.to_csv('out.csv')","0cf98f74":"s2.shape","9ccca319":"sample"}}