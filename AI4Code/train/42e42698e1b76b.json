{"cell_type":{"8fe5bf64":"code","925d3f2f":"code","d2f7b363":"code","718d33ec":"code","d564b7fa":"code","f8725eff":"code","a5f166d9":"code","7d4159e2":"code","ca19e0fd":"code","bb6170a4":"code","8468bd9b":"code","679dbdbb":"code","7bced48b":"code","c287f115":"code","2e9e7e1b":"code","fb537fb7":"code","e7ed423a":"code","40d45eb6":"code","92d38042":"code","0aead075":"code","78df1bfe":"code","5df24e47":"code","bd36cb7f":"code","7c1babb3":"code","a04f8904":"code","b10c1ffc":"code","0cbf80c6":"code","c81e91ce":"code","511a2e43":"code","fb6fdd9e":"markdown","bc7b0fdf":"markdown","c3d22242":"markdown","fd48bab8":"markdown"},"source":{"8fe5bf64":"from fastai.vision import *","925d3f2f":"dirs = [\n    ('black', 'urls_black.csv'),\n    ('grizzly', 'urls_grizzly.csv'), \n    ('teddys', 'urls_teddy.csv'),\n]\n","d2f7b363":"inputPath = Path('..\/input\/bears\/datasets')","718d33ec":"for folder, file in dirs:\n    print(folder, file)\n    path = Path('data\/outputs')\n    dest = path\/folder\n    dest.mkdir(parents=True, exist_ok=True)\n    try:\n        download_images(inputPath\/folder\/file, dest)\n    except:\n        pass","d564b7fa":"for c, _ in dirs:\n    verify_images(path\/c, delete=True, max_size=500)","f8725eff":"np.random.seed(1)\ndata = ImageDataBunch.from_folder(path, train='.', valid_pct=0.2, ds_tfms=get_transforms(), size=224, num_workers=4).normalize(imagenet_stats)","a5f166d9":"data.classes, data.c, len(data.train_ds), len(data.valid_ds)","7d4159e2":"data.show_batch(rows=3, figsize=(7,8))","ca19e0fd":"learn = cnn_learner(data, models.resnet34, metrics=error_rate)","bb6170a4":"learn.fit_one_cycle(4)","8468bd9b":"learn.save('stage-1')","679dbdbb":"learn.unfreeze()","7bced48b":"learn.lr_find()","c287f115":"learn.recorder.plot()","2e9e7e1b":"learn.fit_one_cycle(2, max_lr=slice(1e-5, 1e-4))","fb537fb7":"learn.save('stage-2')","e7ed423a":"learn.load('stage-2')","40d45eb6":"interp = ClassificationInterpretation.from_learner(learn)","92d38042":"interp.plot_confusion_matrix()","0aead075":"interp.plot_top_losses(6)","78df1bfe":"learn.export()","5df24e47":"defaults.device = torch.device('cpu')","bd36cb7f":"img = open_image(path\/'black'\/'00000005.jpg')\nimg","7c1babb3":"learn = load_learner(path)","a04f8904":"pred_class, pred_idx, outputs = learn.predict(img)\npred_class","b10c1ffc":"!cp .\/data\/outputs\/export.pkl .","0cbf80c6":"from IPython.display import FileLink\nFileLink('export.pkl')\n\n","c81e91ce":"!rm -r .\/data\/","511a2e43":"!ls .","fb6fdd9e":"# Interpretation","bc7b0fdf":"# Deploy","c3d22242":"# DataBunch","fd48bab8":"# Train Model"}}