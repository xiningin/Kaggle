{"cell_type":{"6127e0c5":"code","724555c1":"code","4e27cdc1":"code","ba48efb8":"code","4ddbadaa":"code","50587a77":"code","4ed627a8":"code","c6b95398":"code","77722c07":"code","e8417c3d":"code","5d4ed070":"markdown"},"source":{"6127e0c5":"! pip install -q dabl","724555c1":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport plotly.express as px\nimport dabl\n\n\nfrom IPython import display\n\nfrom sklearn.neural_network import MLPClassifier\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.svm import SVC\nfrom sklearn.gaussian_process import GaussianProcessClassifier\nfrom sklearn.gaussian_process.kernels import RBF\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import RandomForestClassifier, AdaBoostClassifier\nfrom sklearn.naive_bayes import GaussianNB\nfrom sklearn.discriminant_analysis import QuadraticDiscriminantAnalysis\nfrom sklearn.metrics import roc_auc_score\n\nimport warnings\n\nwarnings.simplefilter(\"ignore\")","4e27cdc1":"train = pd.read_csv(\"..\/input\/health-insurance-cross-sell-prediction\/train.csv\")\ntest = pd.read_csv(\"..\/input\/health-insurance-cross-sell-prediction\/test.csv\")\nsub = pd.read_csv(\"..\/input\/health-insurance-cross-sell-prediction\/sample_submission.csv\")\n\ntrain = train.drop(['id'], axis=1)\ntest = test.drop(['id'], axis=1)","ba48efb8":"train.head()","4ddbadaa":"dabl.plot(train, target_col='Response')","50587a77":"train['Gender'] = train['Gender'].map({'Male':1, 'Female':0})\ntrain['Vehicle_Age'] = train['Vehicle_Age'].map({'> 2 Years':0, '1-2 Year':1, '< 1 Year':2})\ntrain['Vehicle_Damage'] = train['Vehicle_Damage'].map({'Yes':1, 'No':0})\n\ntrain.head()","4ed627a8":"# Split the data\nsplit_pcent = 0.20\nsplit = int(len(train) * split_pcent)\n\ndata = train.sample(frac=1).reset_index(drop=True)\n\nvalid = data[:split]\ntrain = data[split:]\n\ntX, tY = train.drop(['Response'], axis=1).values, train['Response'].values\nvX, vY = valid.drop(['Response'], axis=1).values, valid['Response'].values\n\nprint(tX.shape[0], vX.shape[0])","c6b95398":"names = [\"Logistic Regression\", \"Nearest Neighbors\", \n         \"Decision Tree\", \"Random Forest\", \"Neural Net\", \"AdaBoost\",\n         \"Naive Bayes\", \"QDA\"]\n\nclassifiers = [\n    LogisticRegression(),\n    KNeighborsClassifier(3),\n    DecisionTreeClassifier(max_depth=5),\n    RandomForestClassifier(max_depth=5, n_estimators=10, max_features=1),\n    MLPClassifier(alpha=1, max_iter=1000),\n    AdaBoostClassifier(),\n    GaussianNB(),\n    QuadraticDiscriminantAnalysis()]","77722c07":"# Let's do the classification and store the name of the classifier and it's test score into a dictionary\n\nroc_results = {}\nacc_results = {}\n\nfor name, clf in zip(names, classifiers):\n    # Fit on the traning data\n    clf.fit(tX, tY)\n    \n    # Store the validation accuracy\n    val_acc = clf.score(vX, vY)\n    acc_results[name] = val_acc\n    \n    # Get the test time prediction\n    preds = clf.predict(vX)\n    \n    # Calculate Test ROC_AUC\n    roc_score = roc_auc_score(vY, preds)\n    \n    # Store the results in a dictionary\n    roc_results[name] = roc_score\n    \n    print(f\"Classifier: {name} | val_acc: {val_acc:.4f} | roc_auc: {roc_score:.4f}\")","e8417c3d":"# Sort the Model Accuracies based on the test score\nsort_clf = dict(sorted(acc_results.items(), key=lambda x: x[1], reverse=True))\n\n# Get the names and the corresponding scores\nclf_names = list(sort_clf.keys())[::-1]\nclf_scores = list(sort_clf.values())[::-1]\n\n# Plot the per-model performance\nfig = px.bar(\n    x=clf_scores,\n    y=clf_names,\n    color=clf_names,\n    labels={'x':'Validation Accuracy Score', 'y':'Models'},\n    title=f\"Model Performance [ Best Model: {clf_names[-1]} | Accuracy: {clf_scores[-1]:.2f} ]\"\n)\n\nfig.show()","5d4ed070":"<h1 style=\"color:aqua; background-color:black\">Health Insurance Cross Sell Prediction: Multi-Model Comparison<\/h1>\n\nThis is only a model comparison notebook. I have done EDA by using DABL only.\n\n\n<p style=\"color:red\">If you like my work, please upvote it!<\/p>"}}