{"cell_type":{"3fec130d":"code","f986c41e":"code","58e3a1e5":"code","524e3543":"code","e4c39b6e":"code","3b183949":"code","b9eee179":"code","5e22a8f2":"code","c7241086":"markdown"},"source":{"3fec130d":"import numpy as np\nimport pandas as pd\n\nfrom sklearn.preprocessing import OrdinalEncoder\nfrom sklearn.model_selection import train_test_split\n\nfrom catboost import CatBoostRegressor\nfrom sklearn.metrics import mean_squared_error","f986c41e":"train = pd.read_csv(\"..\/input\/30-days-of-ml\/train.csv\", index_col=0)\ntest = pd.read_csv(\"..\/input\/30-days-of-ml\/test.csv\", index_col=0)\n\ntrain.head()","58e3a1e5":"y = train['target']\nfeatures = train.drop(['target'], axis=1)\n\nfeatures.head()","524e3543":"X = features.copy()\nX_test = test.copy()\nX.head()","e4c39b6e":"X_train, X_valid, y_train, y_valid = train_test_split(X, y, random_state=42)","3b183949":"object_cols = [col for col in features.columns if 'cat' in col]\nmodel = CatBoostRegressor(\n    eval_metric='RMSE',\n    silent=True,\n    random_seed=42,\n    iterations=1000,\n    cat_features=object_cols\n)\nmodel.fit(X_train, y_train)","b9eee179":"y_pred = model.predict(X_valid)\n\nprint(mean_squared_error(y_valid, y_pred, squared=False))","5e22a8f2":"predictions = model.predict(X_test)\noutput = pd.DataFrame({'Id': X_test.index,\n                       'target': predictions})\noutput.to_csv('2_submission.csv', index=False)","c7241086":"Once you have run the code cell above, follow the instructions below to submit to the competition:\n1. Begin by clicking on the **Save Version** button in the top right corner of the window.  This will generate a pop-up window.  \n2. Ensure that the **Save and Run All** option is selected, and then click on the **Save** button.\n3. This generates a window in the bottom left corner of the notebook.  After it has finished running, click on the number to the right of the **Save Version** button.  This pulls up a list of versions on the right of the screen.  Click on the ellipsis **(...)** to the right of the most recent version, and select **Open in Viewer**.  This brings you into view mode of the same page. You will need to scroll down to get back to these instructions.\n4. Click on the **Output** tab on the right of the screen.  Then, click on the file you would like to submit, and click on the **Submit** button to submit your results to the leaderboard.\n\nYou have now successfully submitted to the competition!\n\nIf you want to keep working to improve your performance, select the **Edit** button in the top right of the screen. Then you can change your code and repeat the process. There's a lot of room to improve, and you will climb up the leaderboard as you work."}}