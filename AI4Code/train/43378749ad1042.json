{"cell_type":{"0c1c061f":"code","e14f2f38":"code","680911c8":"code","f93a70d4":"code","23041d56":"code","bd6b79b0":"code","283d945c":"code","4c82499d":"code","e2311b27":"code","698a7b50":"code","919f2781":"code","aab7ef9a":"code","4d618170":"code","c8e34ec4":"code","ae58ce71":"code","486f259c":"code","d9036ae4":"code","ebc0b13c":"code","5795dca8":"code","408b041d":"code","25c07e51":"code","a7fd6478":"code","4a15c4b7":"code","b3989c67":"code","66dabf5c":"code","df1761c2":"code","18189775":"code","8955a379":"code","18db874e":"code","557ace82":"code","641e4817":"code","1cf9ec7c":"code","f6c5f9e5":"code","1e45cd13":"code","06d765d1":"code","969841cb":"markdown","93c7f3e8":"markdown","133365fc":"markdown","c5035f95":"markdown","8e369a54":"markdown","383f1c0d":"markdown","1af351cc":"markdown","dbf99ec6":"markdown","8c2e9ebf":"markdown","a2174036":"markdown","843ee85a":"markdown","8ee911b3":"markdown","9c28586f":"markdown","707a08c5":"markdown","e3bef7fd":"markdown","712831d4":"markdown","d5ae8a12":"markdown","7ad5b8a8":"markdown"},"source":{"0c1c061f":"!git clone https:\/\/github.com\/Tessellate-Imaging\/monk_v1.git","e14f2f38":"!cd monk_v1\/installation\/Misc && pip install -r requirements_kaggle.txt","680911c8":"!cd monk_v1\/installation\/Misc && pip install -r requirements_kaggle.txt","f93a70d4":"# Monk\nimport os\nimport sys\nsys.path.append(\"monk_v1\/monk\/\");","23041d56":"pip install monk","bd6b79b0":"pip install https:\/\/download.pytorch.org\/whl\/cpu\/torch-1.0.1-cp37-cp37m-win_amd64.whl","283d945c":"\npip install pytorch","4c82499d":"pip install monk-pytorch-cuda101-test","e2311b27":"pip install monk.pytorch","698a7b50":"#Using pytorch backend \nfrom pytorch_prototype import prototype","919f2781":"gtfL = prototype(verbose=1);\ngtfL.Prototype(\"Lung-cancer\", \"exp1\");\ngtfL.Default(dataset_path=\"..\/input\/lung-and-colon-cancer-histopathological-images\/lung_colon_image_set\", \n            model_name=\"resnet18\", \n            num_epochs=5);\n\n#Read the summary generated once you run this cell.\n","aab7ef9a":"gtfL.List_Models()","4d618170":"pip install ipywidgets","c8e34ec4":"#Start Training\ngtfL.Train();\n\n#Read the training summary generated once you run the cell and training is completed","ae58ce71":"# Load experiment\ngtfL = prototype(verbose=1);\ngtfL.Prototype(\"Lung-cancer\", \"exp2\");\ngtfL.Default(dataset_path=\"\/kaggle\/input\/lung-and-colon-cancer-histopathological-images\/lung_colon_image_set\/lung_image_sets\", \n            model_name=\"vgg19_bn\", \n            num_epochs=5);\n\n#Read the summary generated once you run this cell.\n","486f259c":"#Start Training\ngtfL.Train();\n\n#Read the training summary generated once you run the cell and training is completed","d9036ae4":"# Load experiment\ngtfL = prototype(verbose=1);\ngtfL.Prototype(\"Lung-cancer\", \"exp3\");\ngtfL.Default(dataset_path=\"\/kaggle\/input\/lung-and-colon-cancer-histopathological-images\/lung_colon_image_set\/lung_image_sets\", \n            model_name=\"densenet201\", \n            num_epochs=5);\n\n#Read the summary generated once you run this cell.\n","ebc0b13c":"#Start Training\ngtfL.Train();\n\n#Read the training summary generated once you run the cell and training is completed","5795dca8":"# Load experiment\ngtfL = prototype(verbose=1);\ngtfL.Prototype(\"Lung-cancer\", \"exp4\");\ngtfL.Default(dataset_path=\"\/kaggle\/input\/lung-and-colon-cancer-histopathological-images\/lung_colon_image_set\/lung_image_sets\", \n            model_name=\"shufflenet_v2_x2_0\", \n            num_epochs=5);\n\n#Read the summary generated once you run this cell.\n","408b041d":"#Start Training\ngtfL.Train();\n\n#Read the training summary generated once you run the cell and training is completed","25c07e51":"# Invoke the comparison class\nfrom monk.compare_prototype import compare\ngtf = compare(verbose=1);\ngtf.Comparison(\"Comparison-1\");\n#add the models trained above.\ngtf.Add_Experiment(\"Lung-cancer\", \"exp1\");\ngtf.Add_Experiment(\"Lung-cancer\", \"exp2\");\ngtf.Add_Experiment(\"Lung-cancer\", \"exp3\");\ngtf.Add_Experiment(\"Lung-cancer\", \"exp4\");","a7fd6478":"gtf.Generate_Statistics();","4a15c4b7":"from IPython.display import Image\nImage(filename=\"workspace\/comparison\/Comparison-1\/train_accuracy.png\")","b3989c67":"Image(filename=\"workspace\/comparison\/Comparison-1\/stats_best_val_acc.png\")","66dabf5c":"Image(filename=\"workspace\/comparison\/Comparison-1\/val_loss.png\")","df1761c2":"Image(filename=\"workspace\/comparison\/Comparison-1\/val_accuracy.png\")","18189775":"Image(filename=\"workspace\/comparison\/Comparison-1\/train_loss.png\")","8955a379":"S2--","18db874e":"from IPython.display import Image\nimg_name = \"\/kaggle\/working\/workspace\/Lung-cancer\/Using-pytorch-backend\/output\/logs\/train_val_loss.png\"\nImage(filename=img_name)","557ace82":"from IPython.display import Image\nimg_name = \"\/kaggle\/working\/workspace\/Lung-cancer\/Using-pytorch-backend\/output\/logs\/train_val_accuracy.png\"\nImage(filename=img_name)","641e4817":"gtfC = prototype(verbose=1);\ngtfC.Prototype(\"Colon-cancer\", \"Using-pytorch-backend\");","1cf9ec7c":"gtfC.Default(dataset_path=\"\/kaggle\/input\/lung-and-colon-cancer-histopathological-images\/lung_colon_image_set\/colon_image_sets\", \n            model_name=\"resnet152\", \n            num_epochs=5);\n\n#Read the summary generated once you run this cell.\", ","f6c5f9e5":"#Start Training\ngtfC.Train();\n\n#Read the training summary generated once you run the cell and training is completed","1e45cd13":"from IPython.display import Image\nimg_name = \"\/kaggle\/working\/workspace\/Colon-cancer\/Using-pytorch-backend\/output\/logs\/train_val_accuracy.png\"\nImage(filename=img_name)","06d765d1":"from IPython.display import Image\nimg_name = \"\/kaggle\/working\/workspace\/Colon-cancer\/Using-pytorch-backend\/output\/logs\/train_val_loss.png\"\nImage(filename=img_name)","969841cb":"This creates files and directories as per the following structure\nworkspace\n\n    |\n    |--------Colon-cancer (Project name can be different)\n                    |\n                    |\n                    |-----Using-pytorch-backend (Experiment name can be different)\n                                |\n                                |-----experiment-state.json\n                                |\n                                |-----output\n                                        |\n                                        |------logs (All training logs and graphs saved here)\n                                        |\n                                        |------models (all trained models saved here)","93c7f3e8":"# [MONK](https:\/\/github.com\/Tessellate-Imaging\/monk_v1)","133365fc":"\nQuick mode training\n- Using Default Function\n    - dataset_path\n    - model_name\n    - num_epochs\n\n\nDataset folder structure\nparent_directory\n\n    |\n    |\n    |------lung_n\n            |\n            |------img1.jpg\n            |------img2.jpg\n            |------.... (and so on)\n    |------lung_scc\n            |\n            |------img1.jpg\n            |------img2.jpg\n            |------.... (and so on)\n     |------lung_aca\n            |\n            |------img1.jpg\n            |------img2.jpg\n            |------.... (and so on)","c5035f95":"# <div id=\"tc\"> Training the classifier for colon cancer <\/div>","8e369a54":"<div id='im'> Install MONK <\/div>","383f1c0d":"<div id=\"cml\"> Creating and managing experiments for lung cancer <\/div>\n\n\n- Provide project name\n- Provide experiment name\n- For a specific data create a single project\n- Inside each project multiple experiments can be created\n- Every experiment can be have diferent hyper-parameters attached to it","1af351cc":"* [Install Monk](#im)\n* [Import](#import)\n* Creating and managing experiments\n    * [For lung cancer](#cml)\n    * [For colon cancer](#cmc)\n* Training the classifier - Quick mode training\n    * [For lung cancer](#tl)\n    * [For colon cancer](#tc)\n* [List of available models](#lm)","dbf99ec6":"\nQuick mode training\n- Using Default Function\n    - dataset_path\n    - model_name\n    - num_epochs\n\n\nDataset folder structure\nparent_directory\n\n    |\n    |\n    |------colon_aca\n            |\n            |------img1.jpg\n            |------img2.jpg\n            |------.... (and so on)\n    |------colon_n\n            |\n            |------img1.jpg\n            |------img2.jpg\n            |------.... (and so on)  ","8c2e9ebf":"# Table of Contents","a2174036":"Create an image classifier\n #Create an experiment\n ptf.Prototype(\"project-1\", \"experiment-1\")\n #Load Data\n ptf.Default(dataset_path=\"dataset\/\", \n              model_name=\"resnet50\", \n              num_epochs=10)\n # Train\n ptf.Train() \n Inference\npredictions = ptf.Infer(img_name=\"image.png\", return_raw=True);\n\nCompare Experiments\n #Create comparison project\n ctf.Comparison(\"Comparison-1\");\n #Add all your experiments\n ctf.Add_Experiment(\"project-1\", \"experiment-1\");\n ctf.Add_Experiment(\"project-2\", \"experiment-2\");\n # Generate statistics\n ctf.Generate_Statistics(); ","843ee85a":"If using Colab install using the commands below\n\n!cd monk_v1\/installation\/Misc && pip install -r requirements_colab.txt\n\nIf using Kaggle uncomment the following command\n\n#!cd monk_v1\/installation\/Misc && pip install -r requirements_kaggle.txt\n\nSelect the requirements file as per OS and CUDA version when using a local system or cloud\n\n#!cd monk_v1\/installation\/Linux && pip install -r requirements_cu9.txt","8ee911b3":"<div id=\"cmc\"> Creating and managing experiments for colon cancer <\/div>\n\n\n- Provide project name\n- Provide experiment name\n- For a specific data create a single project\n- Inside each project multiple experiments can be created\n- Every experiment can be have diferent hyper-parameters attached to it","9c28586f":"This creates files and directories as per the following structure\nworkspace\n\n    |\n    |--------Lung-cancer (Project name can be different)\n                    |\n                    |\n                    |-----Using-pytorch-backend (Experiment name can be different)\n                                |\n                                |-----experiment-state.json\n                                |\n                                |-----output\n                                        |\n                                        |------logs (All training logs and graphs saved here)\n                                        |\n                                        |------models (all trained models saved here)","707a08c5":"# <div id=\"tl\"> Training the classifier for lung cancer <\/div>","e3bef7fd":"# <div id=\"lm\"> List of available models <\/div>","712831d4":"# <div id=\"import\"> Imports <\/div>","d5ae8a12":"# About the dataset \n\nOriginal Article\nBorkowski AA, Bui MM, Thomas LB, Wilson CP, DeLand LA, Mastorides SM. Lung and Colon Cancer Histopathological Image Dataset (LC25000). arXiv:1912.12142v1 [eess.IV], 2019\n\nRelevant Links\nhttps:\/\/arxiv.org\/abs\/1912.12142v1\nhttps:\/\/github.com\/tampapath\/lung_colon_image_set\n\n\nDataset BibTeX\n@article{,\ntitle= {LC25000 Lung and colon histopathological image dataset},\nkeywords= {cancer,histopathology},\nauthor= {Andrew A. Borkowski, Marilyn M. Bui, L. Brannon Thomas, Catherine P. Wilson, Lauren A. DeLand, Stephen M. Mastorides},\nurl= {https:\/\/github.com\/tampapath\/lung_colon_image_set}\n}\n\n\nThis dataset contains 25,000 histopathological images with 5 classes. All images are 768 x 768 pixels in size and are in jpeg file format.\nThe images were generated from an original sample of HIPAA compliant and validated sources, consisting of 750 total images of lung tissue (250 benign lung tissue, 250 lung adenocarcinomas, and 250 lung squamous cell carcinomas) and 500 total images of colon tissue (250 benign colon tissue and 250 colon adenocarcinomas) and augmented to 25,000 using the Augmentor package.\nThere are five classes in the dataset, each with 5,000 images, being:\n\n* Lung benign tissue\n* Lung adenocarcinoma\n* Lung squamous cell carcinoma\n* Colon adenocarcinoma\n* Colon benign tissue","7ad5b8a8":"**Monk is a low code Deep Learning tool and a unified wrapper for Computer Vision.**"}}