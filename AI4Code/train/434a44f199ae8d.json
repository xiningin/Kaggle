{"cell_type":{"7a04f615":"code","5358e032":"code","5bd83b92":"code","aeef3484":"code","a6a1893f":"code","795253e7":"code","dea3e480":"code","8bce8d74":"code","596b5f0d":"code","bdf38b34":"code","604e7ea5":"code","f1f88666":"code","6f125f38":"code","bad8fbc7":"code","c5cd4d4e":"code","d509400e":"code","8ca482ad":"code","3888be02":"code","f66be379":"code","5a53c99e":"code","a005fbfe":"code","19343a48":"code","d2389758":"code","12ef9fda":"code","4d831aec":"code","ed06ba75":"code","cbeb16c3":"code","5f49d13f":"code","e8e1f19e":"code","196d8bca":"code","ad0f58aa":"code","cab6c09c":"code","ef8df403":"code","f6a5df55":"code","552398c2":"code","a45d2b4a":"code","e9b3ca2b":"markdown","f9547d14":"markdown","ef0935cf":"markdown","8b3981b6":"markdown","5b343afe":"markdown","93ba9996":"markdown"},"source":{"7a04f615":"from fastai import *\nfrom fastai.vision import *","5358e032":"import numpy as np \nimport pandas as pd \n\nimport os\nprint(os.listdir(\"..\/input\"))\nfrom glob import glob\nimport random\nimport cv2\nimport matplotlib.pylab as plt\nimport random as rand\nimport keras\nfrom keras.layers import Dense, Dropout, Activation, Flatten, Conv2D, MaxPooling2D, Lambda, MaxPool2D, BatchNormalization, Input\nfrom keras.models import Sequential\nfrom keras.utils import to_categorical\nfrom keras.preprocessing.image import ImageDataGenerator\nfrom sklearn.model_selection import train_test_split\nfrom pathlib import Path\nfrom keras.optimizers import Adam,RMSprop,SGD","5bd83b92":"path =  Path('..\/input\/flowers-recognition\/flowers\/flowers')","aeef3484":"np.random.seed(42)\ndata = ImageDataBunch.from_folder(path, train=\".\", valid_pct=0.2,\n                                  ds_tfms=get_transforms(), size=64, num_workers=0).normalize(imagenet_stats)","a6a1893f":"data.classes","795253e7":"data.show_batch(rows=3, figsize=(10,10))","dea3e480":"learn = create_cnn(data, models.resnet34, metrics=error_rate, model_dir=\"\/tmp\/model\/\")","8bce8d74":"learn.fit_one_cycle(4)","596b5f0d":"learn.save('stage-1')","bdf38b34":"learn.unfreeze()","604e7ea5":"learn.lr_find()","f1f88666":"learn.recorder.plot()","6f125f38":"learn.fit_one_cycle(2, max_lr=slice(1e-4,1e-3))","bad8fbc7":"learn.save('stage-2')","c5cd4d4e":"learn.load('stage-2');","d509400e":"interp = ClassificationInterpretation.from_learner(learn)","8ca482ad":"interp.plot_confusion_matrix()","3888be02":"learn.lr_find()","f66be379":"learn.lr_find()\nlearn.recorder.plot()","5a53c99e":"lr = 0.01\nlearn.fit_one_cycle(5, slice(1e-5, lr\/5))","a005fbfe":"learn.fit_one_cycle(5, max_lr=slice(1e-5,1e-4))","19343a48":"learn.save('stage-3')","d2389758":"np.random.seed(42)\ndata = ImageDataBunch.from_folder(path, train=\".\", valid_pct=0.2,\n        ds_tfms=get_transforms(), size=256, num_workers=0).normalize(imagenet_stats)\n\nlearn.data = data\ndata.train_ds[0][0].shape","12ef9fda":"learn.freeze()","4d831aec":"learn.lr_find()\nlearn.recorder.plot()","ed06ba75":"lr=1e-2\/2","cbeb16c3":"learn.fit_one_cycle(5, slice(lr))","5f49d13f":"learn.unfreeze()","e8e1f19e":"learn.fit_one_cycle(5, slice(1e-5, lr\/5))","196d8bca":"learn.recorder.plot_losses()","ad0f58aa":"learn.save('stage-5')","cab6c09c":"learn.load('stage-5');","ef8df403":"interp = ClassificationInterpretation.from_learner(learn)","f6a5df55":"interp.plot_confusion_matrix()","552398c2":"interp = ClassificationInterpretation.from_learner(learn)\n\nlosses,idxs = interp.top_losses()\n\nlen(data.valid_ds)==len(losses)==len(idxs)","a45d2b4a":"interp.plot_top_losses(9, figsize=(15,11))","e9b3ca2b":"# Flowers Recognition\n","f9547d14":"## Interpretation","ef0935cf":"Better the model","8b3981b6":"## Interpretation 2.0","5b343afe":"## View data","93ba9996":"# Predictions"}}