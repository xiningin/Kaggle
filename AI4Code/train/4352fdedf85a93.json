{"cell_type":{"e83febd8":"code","e4a58642":"code","b019c7f7":"code","5dd83437":"code","c3627d9d":"code","242bf40c":"code","9e7f52fb":"code","f8c2e22a":"code","d4532045":"code","af8ad2a9":"code","1deab4e7":"code","5eed28d9":"code","1498b171":"code","648417ae":"code","d43e43b3":"code","627a9bbe":"code","6225f34e":"code","7f51dc72":"code","5e83a062":"code","1b9391da":"code","a7d3f17c":"code","511ce642":"code","c9e45bd1":"code","55a35b1f":"code","7f96261c":"code","b737ff95":"code","ec66f734":"code","11c501d1":"code","0c02749f":"code","cec7457d":"markdown","31917b53":"markdown","60fb7b1e":"markdown","422d1c0b":"markdown","7ff0d4b6":"markdown","39e39347":"markdown","fd23a88f":"markdown","2c6fc67b":"markdown","d7c972e7":"markdown","89b15ac1":"markdown","e68a6eab":"markdown","dc7f71e6":"markdown"},"source":{"e83febd8":"import numpy as np\nimport pandas as pd\nfrom matplotlib import pyplot as plt\nimport seaborn as sns\nfrom numpy import where as IF","e4a58642":"claims = pd.read_csv(\"..\/input\/eda-on-insurance-claim-dataset\/claims.csv\")\ndemo = pd.read_csv(\"..\/input\/demographics\/demo.csv\")\ndemo.head(2)","b019c7f7":"claims.head(2)","5dd83437":"comb_df = pd.merge(right = claims,\n                   left = demo, \n                   right_on = \"customer_id\", \n                   left_on = \"CUST_ID\",\n                   how = \"outer\"\n                  )\ncomb_df.drop(columns = [\"customer_id\"], inplace = True)\ncomb_df.head(2)","c3627d9d":"comb_df.head()","242bf40c":"comb_df[\"DateOfBirth\"] = pd.to_datetime(comb_df.DateOfBirth, format = \"%d-%b-%y\")\ncomb_df.loc[(comb_df.DateOfBirth.dt.year > 2020),\"DateOfBirth\"]=comb_df[comb_df.DateOfBirth.dt.year > 2020][\"DateOfBirth\"].apply(lambda x: x - pd.DateOffset(years=100))\ncomb_df[\"claim_date\"] = pd.to_datetime(comb_df.claim_date, format = \"%m\/%d\/%Y\")\ncomb_df[\"Contact\"] = pd.to_numeric(comb_df.Contact.str.replace(\"-\",\"\"),downcast='float')\ncomb_df[\"claim_amount\"] = pd.to_numeric(comb_df.claim_amount.str.replace(\"$\",\"\"),downcast='float')\ncomb_df.head(2)","9e7f52fb":"\ncomb_df[\"flag\"] = IF(comb_df.police_report == \"No\", 0 ,\n                    IF(comb_df.police_report == \"Yes\", 1, np.nan))\ncomb_df.drop(columns = [\"police_report\"], inplace = True)","f8c2e22a":"comb_df = comb_df.groupby('CUST_ID').first().reset_index(drop = True)","d4532045":"comb_df.head()","af8ad2a9":"comb_df[\"incident_cause\"].isna().sum()","1deab4e7":"cat_col = [\"gender\",\"State\",\"Segment\",\"incident_cause\",\"claim_area\",\"claim_type\",\"fraudulent\",\"flag\"]\ncon_col = [\"claim_amount\"]","5eed28d9":"for col in cat_col:\n    comb_df[col] = comb_df[col].fillna(comb_df[col].mode()[0])\ncomb_df[con_col] = comb_df[con_col].fillna(comb_df[con_col].mean())\ncomb_df.head()","1498b171":"# comb_df[\"incident_cause\"].fillna(0, inplace =True)\ncomb_df[\"State\"].isna().sum()\n","648417ae":"comb_df[\"Age\"] = round((comb_df.claim_date - comb_df.DateOfBirth).apply(lambda x: x.days)\/365.25, 2)","d43e43b3":"comb_df[\"Age_grp\"] = IF(comb_df.Age < 18, \"Children\",\n                        IF(comb_df.Age < 30, \"Youth\",\n                         IF(comb_df.Age < 60, \"Adult\",\n                          IF(comb_df.Age < 100, \"Senior\", \"NaN\"\n                           \n                          )\n                         )\n                        )\n                       )\ncomb_df[\"Age_grp\"] = comb_df[\"Age_grp\"].fillna(comb_df[\"Age_grp\"].mode())\ncomb_df.groupby(by = \"Age_grp\").count()\n# comb_df.head()","627a9bbe":"comb_df.groupby(by = \"Segment\")[[\"claim_amount\"]].mean()","6225f34e":"comb_df.loc[comb_df.claim_date < \"2018-09-10\",:].groupby(\"incident_cause\")[\"claim_amount\"].sum().add_prefix(\"total_\")","7f51dc72":"comb_df.loc[(comb_df.incident_cause.str.lower().str.contains(\"driver\") \n             & ((comb_df.State == \"TX\") | (comb_df.State == \"DE\") | (comb_df.State == \"AK\"))),:].groupby(by = \"State\")[\"State\"].count()","5e83a062":"f1 = comb_df.groupby(by = [\"gender\",\"Segment\"])[\"claim_amount\"].sum().reset_index()\nf1.head()","1b9391da":"res = f1.pivot(index = \"Segment\", columns = \"gender\", values = \"claim_amount\")\nres","a7d3f17c":"res.T.plot(kind = \"pie\", subplots = True, legend = False, figsize = (15,8))\nplt.show()","511ce642":"f2 = comb_df.loc[(comb_df.incident_cause.str.lower().str.contains(\"driver\"))].groupby(by = \"gender\")[[\"gender\"]].count().add_prefix(\"CountOf_\").reset_index()\nf2","c9e45bd1":"sns.barplot(x = \"gender\", y = \"CountOf_gender\", data = f2 )\nplt.show()","55a35b1f":"comb_df.head()","7f96261c":"\ncomb_df.groupby(by = \"Age_grp\")[[\"fraudulent\"]].count()","b737ff95":"comb_df[(comb_df.Age_grp == np.nan)]","ec66f734":"val = comb_df['Age_grp'].mode()[0]\nprint(val)\ncomb_df.loc[:,\"Age_grp\"] = comb_df.loc[:,'Age_grp'].fillna(value = val)\n","11c501d1":"comb_df[(comb_df.Age_grp == \"nan\")]","0c02749f":"comb_df['Age_grp'].mode()[0]","cec7457d":"13. Which age group had the maximum fraudulent policy claims? Visualize it on a bar chart.","31917b53":"2. Perform a data audit for the datatypes and find out if there are any mismatch within the current datatypes of the columns and their business significance.\n3. Convert the column claim_amount to numeric. Use the appropriate modules\/attributes to remove the $ sign.","60fb7b1e":"What is the total claim amount based on incident cause for all the claims that have been done at least 20 days prior to 1st of October, 2018.","422d1c0b":"6. Check for missing values and impute the missing values with an appropriate value. (mean for continuous and mode for categorical)","7ff0d4b6":"10. How many adults from TX, DE and AK claimed insurance for driver related issues and causes?","39e39347":"What is the average amount claimed by the customers from various segments?","fd23a88f":"5. One customer can claim for insurance more than once and in each claim, multiple categories of claims can be involved. However, customer ID should remain unique. Retain the most recent observation and delete any duplicated records in the data based on the customer ID column.","2c6fc67b":"11. Draw a pie chart between the aggregated value of claim amount based on gender and segment. Represent the claim amount as a percentage on the pie chart.","d7c972e7":"7. Calculate the age of customers in years. Based on the age, categorize the customers according to the below criteria\n        Children < 18\n        Youth 18-30\n        Adult 30-60\n        Senior > 60","89b15ac1":"12. Among males and females, which gender had claimed the most for any type of driver related issues? E.g. This metric can be compared using a bar chart","e68a6eab":"4. Of all the injury claims, some of them have gone unreported with the police. Create an alert flag (1,0) for all such claims.","dc7f71e6":"1. Import claims_data.csv and cust_data.csv which is provided to you and combine the two datasets appropriately to create a 360-degree view of the data. Use the same for the subsequent questions."}}