{"cell_type":{"efff47a9":"code","e1c3c6af":"code","3de4a05a":"code","5c6a4dbe":"code","75e45472":"code","0700c9f6":"code","eb4f96c3":"code","9d1f619e":"code","0cd52e1a":"code","de98393c":"code","104c7513":"code","f2173462":"code","da335f0b":"code","ea6ff91d":"code","eddd8483":"code","1ed80790":"code","4fb4ae96":"code","ab2292c0":"markdown","eb899989":"markdown","80cf9dd9":"markdown","e7f4646b":"markdown","f349a53f":"markdown","f8b00772":"markdown","431e5b12":"markdown","d42badaf":"markdown"},"source":{"efff47a9":"import numpy as np\nimport pandas as pd\nimport pyarrow.parquet as pq\nimport os\nfrom matplotlib import pyplot as plt\n%matplotlib inline","e1c3c6af":"train = pq.read_pandas('..\/input\/train.parquet').to_pandas()","3de4a05a":"train.info()","5c6a4dbe":"plt.figure(figsize=(24, 8))\nplt.plot(train.iloc[:, :5]);","75e45472":"meta = pd.read_csv('..\/input\/metadata_train.csv')","0700c9f6":"meta.info()","eb4f96c3":"meta.describe()","9d1f619e":"meta.corr()","0cd52e1a":"meta.head(10)","de98393c":"# get positive and negative `id_measurement`s\npositive_mid = np.unique(meta.loc[meta.target == 1, 'id_measurement'].values)\nnegative_mid = np.unique(meta.loc[meta.target == 0, 'id_measurement'].values)","104c7513":"# get one positive and one negative signal_id\npid = meta.loc[meta.id_measurement == positive_mid[0], 'signal_id']\nnid = meta.loc[meta.id_measurement == negative_mid[0], 'signal_id']","f2173462":"positive_sample = train.iloc[:, pid]\nnegative_sample = train.iloc[:, nid]","da335f0b":"plt.figure(figsize=(24, 8))\nplt.plot(positive_sample);","ea6ff91d":"plt.figure(figsize=(24, 8))\nplt.plot(negative_sample);","eddd8483":"meta['target'].value_counts().plot(kind='bar');","1ed80790":"meta['target'].value_counts()","4fb4ae96":"meta['phase'].value_counts()","ab2292c0":"We can see, there is a huge class imbalance in the data","eb899989":"Load the training parquet file, this file contains signal measurements, each column contains aa single 800,000 measurement signal","80cf9dd9":"Analysing class imbalance","e7f4646b":"Loading the meta files","f349a53f":"It can be seen that `phase` and `target` are independent of `signal_id` and `id_measurement` and are independent of each other","f8b00772":"Let's plot some positive and negative samples","431e5b12":"So, the fault meter detects faults on each phase (three: 0, 1, 2) and each detection has a unique id called `id_measurement`.\n","d42badaf":"Plotting first few signals from the training set"}}