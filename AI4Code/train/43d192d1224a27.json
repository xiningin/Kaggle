{"cell_type":{"18880d21":"code","ef2c4d92":"code","f9777f55":"code","dd4ab765":"code","ec6b0b99":"code","ed1cf11f":"code","84080c88":"code","a24ca775":"code","0f1a629e":"markdown","9f55b127":"markdown","9fc1a787":"markdown","e1ebfefe":"markdown","838cbd6b":"markdown"},"source":{"18880d21":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport glob\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\n# for dirname, _, filenames in os.walk('\/kaggle\/input'):\n#     for filename in filenames:\n#         print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","ef2c4d92":"class_map = pd.read_csv('\/kaggle\/input\/cnn-who-is-she\/CNN_who_is_she\/classmap.csv')\nclass_dict = dict(list(zip(class_map.classname, class_map.classnum)))\nclass_dict.keys()","f9777f55":"img_path = glob.glob('\/kaggle\/input\/cnn-who-is-she\/CNN_who_is_she\/training_set\/training_set\/*\/*.png') \nclass_y = []\nfor i in img_path:\n    y = i.split('\/')[7]\n    class_y.append(y)\ndf = pd.DataFrame({'img_path':img_path, 'class':class_y})","dd4ab765":"df","ec6b0b99":"from tensorflow.keras.preprocessing.image import ImageDataGenerator\ntrain_datagen = ImageDataGenerator( \n                                    rescale=1.\/255,\n                                    rotation_range=10,\n                                    width_shift_range=0.05,\n                                    height_shift_range=0.05,\n                                    horizontal_flip=True,\n                                    vertical_flip=False,\n                                    fill_mode='wrap'\n                                 )","ed1cf11f":"train_generator = train_datagen.flow_from_dataframe(dataframe=df,\n                                                    x_col=\"img_path\",\n                                                    y_col=\"class\",\n                                                    classes=[\"rika\", \"risa\",\"yui\", \"akane\",\"neru\"],\n                                                    target_size=(200, 200),\n                                                    batch_size=32,\n                                                    class_mode='categorical', shuffle=False)","84080c88":"# class indices from `train_datagen.flow_from_dataframe`\ntrain_generator.class_indices","a24ca775":"# Here is the result I want\nclass_dict","0f1a629e":"## Question\n- The classes parameter works on `flow_from_directory` but not `flow_from_dataframe` in TF 2.4. \n- The `train_generator.class_indices` output are not correspond my classes lists.","9f55b127":"# tensorflow \"classes\" not working on flow_from_dataframe #47281\n[GitHub Issue](https:\/\/github.com\/tensorflow\/tensorflow\/issues\/47281)\n\nPlease correct me if I am wrong. Thanks! ","9fc1a787":"## ImageDataGenerator","e1ebfefe":"## Load classmap ","838cbd6b":"## Load training image path"}}