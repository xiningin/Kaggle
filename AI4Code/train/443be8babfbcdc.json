{"cell_type":{"ae15181a":"code","6914a1f6":"code","37b4cc8b":"code","e4417225":"code","81a437e3":"code","b93f5259":"code","5b303716":"code","4bed3bf3":"code","6858620d":"code","f8ed7fd4":"code","578a2b6c":"code","50a12337":"code","d287ceb4":"code","e30db6fd":"code","f39dac6a":"code","3783529b":"code","4233a86b":"code","90d8dc6f":"code","5d7f8fe3":"code","8e895cc3":"code","91f4fe58":"code","e927d680":"code","cedca311":"code","5e165684":"code","72822e17":"code","276abe24":"code","1305fa6e":"code","b0dcabec":"code","bbf37b12":"code","6aa9900f":"code","9ff8bc5c":"code","c22edd20":"code","af043c18":"code","8eaf477f":"code","45a595d5":"markdown","39f4d818":"markdown","eec938e4":"markdown","f9f67849":"markdown","d6ed2022":"markdown","04280300":"markdown","cb9a26d9":"markdown","b2a8f922":"markdown","08e500cf":"markdown","aac6e6e4":"markdown","97af40e3":"markdown","2efd64ee":"markdown","83da2527":"markdown","9134fc41":"markdown","6f90c75e":"markdown","35d0d4af":"markdown","4c58e26e":"markdown","b5cf73ba":"markdown","0e7735d2":"markdown","e728afc2":"markdown","7471a745":"markdown","47453a2a":"markdown","b3690273":"markdown","91d36e83":"markdown","815f677c":"markdown","34e8ace9":"markdown","9f804660":"markdown","dddf59b0":"markdown","4b683878":"markdown","b7f6a182":"markdown"},"source":{"ae15181a":"import numpy as np\nimport pandas as pd\nfrom pandas import DataFrame,Series\n\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline","6914a1f6":"df = pd.read_csv(\"..\/input\/shopee-code-league-20\/_DA_Marketing_Analytics\/train.csv\",index_col='row_id')","37b4cc8b":"df.head()","e4417225":"df.info()","81a437e3":"df['last_open_day'] = df['last_open_day'].replace('Never open',0).astype(int)\ndf['last_login_day'] = df['last_login_day'].replace('Never login',0).astype(int)\ndf['last_checkout_day'] = df['last_checkout_day'].replace('Never checkout',0).astype(int)","b93f5259":"df = df.drop(['grass_date','subject_line_length','user_id'],axis=1)","5b303716":"df.describe()","4bed3bf3":"sns.countplot('open_flag',data=df)","6858620d":"sns.countplot('country_code',data=df)","f8ed7fd4":"fig,(ax1,ax2) = plt.subplots(1,2)\n\nxmax = df['last_open_day'].max()\nxmin = df['last_open_day'].min()\n\nplt.xlim((xmin,xmax))\nsns.kdeplot(df['last_open_day'],ax=ax1)\n\nsns.kdeplot(df['last_open_day'],ax=ax2)\nax2.set_xlim(0,100)\n\nax1.set_title('Last open day')\nax2.set_title('Last open within 100days')\nfig.tight_layout()\nfig.set_size_inches(10,5)","578a2b6c":"fig,(ax1,ax2,ax3) = plt.subplots(1,3)\n\nsns.kdeplot(df['open_count_last_10_days'],ax=ax1)\nax1.set_xlim(0,10)\n\nsns.kdeplot(df['open_count_last_30_days'],ax=ax2)\nax2.set_xlim(0,30)\n\nsns.kdeplot(df['open_count_last_60_days'],ax=ax3)\nax3.set_xlim(0,60)\n\nax1.set_title('open_count_last_10_days')\nax2.set_title('open_count_last_30_days')\nax3.set_title('open_count_last_60_days')\nfig.set_size_inches(20,5)","50a12337":"fig,(ax1,ax2) = plt.subplots(1,2)\n\nxmax = df['last_login_day'].max()\nxmin = df['last_login_day'].min()\n\nplt.xlim((xmin,xmax))\nsns.kdeplot(df['last_login_day'],ax=ax1)\n\nsns.kdeplot(df['last_login_day'],ax=ax2)\nax2.set_xlim(0,1500)\n\nax1.set_title('Last login day')\nax2.set_title('Last login within 1500days')\nfig.tight_layout()\nfig.set_size_inches(10,5)","d287ceb4":"fig,(ax1,ax2,ax3) = plt.subplots(1,3)\n\nsns.kdeplot(df['login_count_last_10_days'],ax=ax1)\nax1.set_xlim(0,10)\n\nsns.kdeplot(df['login_count_last_30_days'],ax=ax2)\nax2.set_xlim(0,30)\n\nsns.kdeplot(df['login_count_last_60_days'],ax=ax3)\nax3.set_xlim(0,60)\n\nax1.set_title('login_count_last_10_days')\nax2.set_title('login_count_last_30_days')\nax3.set_title('login_count_last_60_days')\nfig.set_size_inches(20,5)","e30db6fd":"fig,(ax1,ax2) = plt.subplots(1,2)\n\nxmax = df['last_checkout_day'].max()\nxmin = df['last_checkout_day'].min()\n\nplt.xlim((xmin,xmax))\nsns.kdeplot(df['last_checkout_day'],ax=ax1)\n\nsns.kdeplot(df['last_checkout_day'],ax=ax2)\nax2.set_xlim(0,500)\n\nax1.set_title('Last checkout day')\nax2.set_title('Last checkout within 500days')\nfig.tight_layout()\nfig.set_size_inches(10,5)","f39dac6a":"fig,(ax1,ax2,ax3) = plt.subplots(1,3)\n\nsns.kdeplot(df['checkout_count_last_10_days'],ax=ax1)\nax1.set_xlim(0,10)\n\nsns.kdeplot(df['checkout_count_last_30_days'],ax=ax2)\nax2.set_xlim(0,30)\n\nsns.kdeplot(df['checkout_count_last_60_days'],ax=ax3)\nax3.set_xlim(0,60)\n\nax1.set_title('checkout_count_last_10_days')\nax2.set_title('checkout_count_last_30_days')\nax3.set_title('checkout_count_last_60_days')\nfig.set_size_inches(20,5)","3783529b":"sns.heatmap(df.corr(),annot=True)\nfig = plt.gcf()\nfig.set_size_inches(15,5)","4233a86b":"Y = df['open_flag']\n#Y = Y.values.reshape(-1,1)\nX = df.drop(['open_count_last_10_days', 'open_count_last_30_days',\n       'open_count_last_60_days', 'login_count_last_10_days',\n       'login_count_last_30_days', 'login_count_last_60_days',\n       'checkout_count_last_10_days', 'checkout_count_last_30_days',\n       'checkout_count_last_60_days', 'open_flag'],axis=1)","90d8dc6f":"from sklearn.linear_model import LogisticRegression","5d7f8fe3":"log_model = LogisticRegression()","8e895cc3":"log_model.fit(X,Y)","91f4fe58":"log_model.score(X,Y)","e927d680":"coeff_df = DataFrame(zip(X.columns,np.transpose(log_model.coef_)))\ncoeff_df","cedca311":"from sklearn.model_selection import train_test_split\n\nx_train,x_test,y_train,y_test = train_test_split(X,Y)\n\nprint(f'Splitting happens as {x_train.shape},{x_test.shape},{y_train.shape},{y_test.shape}')","5e165684":"log_model2 = LogisticRegression(class_weight='balance')\n\nlog_model2.fit(x_train,y_train)\n\ny_pred = log_model2.predict(x_test)\ny_pred","72822e17":"from sklearn.metrics import accuracy_score\naccuracy_score(y_test,y_pred)","276abe24":"from sklearn.metrics import confusion_matrix","1305fa6e":"confusion_matrix(y_test,y_pred)","b0dcabec":"from sklearn.svm import SVC","bbf37b12":"model = SVC()","6aa9900f":"clf = model.fit(x_train,y_train)","9ff8bc5c":"model.score(X,Y)","c22edd20":"y_pred = clf.predict(x_test)","af043c18":"accuracy_score(y_test,y_pred)","8eaf477f":"confusion_matrix(y_test,y_pred)","45a595d5":"# Model Building","39f4d818":"Extrating X and Y from the df.","eec938e4":"# SVM","f9f67849":"## Logistic Regression","d6ed2022":"## Model Analysis","04280300":"# Data Visualisation","cb9a26d9":"## Classification Model ","b2a8f922":"Almost all the columns are non-null and no missing values are present.","08e500cf":"Most people open within 100 days. And within 100 days most people opens with as frequent as 20 days","aac6e6e4":"From the graph one could conclude that, most people open with each other day. The density spiked most on day 1!!","97af40e3":"## Country","2efd64ee":"The login density is pretty interesting. Within 10 days, most people login within every 3 days. But if one looks at a long range of days, most login happens every 15 to 30 days.","83da2527":"Note that both Logistic Regression and SVM is predicting with similar accuracy score. But the biased data highly influence the model and unless a more unbiased data is acquired the model predictions are highly unreliable.","9134fc41":"Dropping features 'grass_date','subject_line_length' for convienience.","6f90c75e":"The target variable is HIGHLY BIASED to 0. ","35d0d4af":"Seems like we have a good model accuracy of 84%.","4c58e26e":"## Model Analysis","b5cf73ba":"Since the data contains more overlapping features, only considering last_open_day, last_login_day and last_checkout_day .","0e7735d2":"## Last Login Day","e728afc2":"So, the model has predicted with an accuracy score of 84%","7471a745":"Last time a check out happens mostly within less than 100 days and very less with 300 to 500 days.","47453a2a":"## Last Checkout Day","b3690273":"It seems like open_counts has more correlation with open_flag, than any other features.","91d36e83":"Graphs infers that, within 10 days, most checkout happens every 3-4 days. And within 10-30 days for 60 days.","815f677c":"## Last Open day","34e8ace9":"This seems like higher the value of last_open_day lower the chance of Flag_open.\nAll other features are linearly related to the Flag_open.","9f804660":"Let's convert 'Never Open' into 0. For ease of analysis","dddf59b0":"# Feature Engineering","4b683878":"## Open_Flag distribution","b7f6a182":"Most people login within 2000 days. And within 100 days most people login within 400-600 days"}}