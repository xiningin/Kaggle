{"cell_type":{"679c4346":"code","a08ef0cf":"code","ee9a933c":"code","480efa27":"code","1913dce2":"code","e67e695a":"code","84df0f67":"code","42227c40":"code","838f9532":"code","6b1a92d2":"code","aa1b60f6":"code","d9b0cc45":"code","a08ce1aa":"code","2d827ba6":"code","5370a347":"code","908d91ec":"code","18a4fdef":"code","3ed65afd":"code","90a8d6db":"code","fd57e8cc":"markdown","b7d9ff99":"markdown","fcc11fd7":"markdown","d2b5377b":"markdown","af5f112a":"markdown","5c474346":"markdown","3f97de05":"markdown"},"source":{"679c4346":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","a08ef0cf":"import tensorflow as tf\nimport pandas as pd\nimport matplotlib.pyplot as plt\nfrom sklearn.preprocessing import LabelEncoder,OneHotEncoder\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import confusion_matrix,accuracy_score","ee9a933c":"train = pd.read_csv('\/kaggle\/input\/dsm-l0-genderclassification\/train.csv')\ntest = pd.read_csv('\/kaggle\/input\/dsm-l0-genderclassification\/test.csv')\nsubmission = pd.read_csv('\/kaggle\/input\/dsm-l0-genderclassification\/submission.csv')","480efa27":"train.tail().style.set_properties(**{'background-color':'purple',\n                                     'color': 'white'})","1913dce2":"#Code by Alpaca Wu https:\/\/www.kaggle.com\/alpacawu\/gender-classification-tensorflow\/notebook\n\nfav_clr,clr_count=np.unique(train['Favorite Color'],return_counts=True)\nplt.pie(clr_count , labels = fav_clr,autopct='%1.1f%%')\nplt.axis('equal')\nplt.title('Color (Neutral\/Warm\/Cool)')\nplt.show()","e67e695a":"#Code by Alpaca Wu https:\/\/www.kaggle.com\/alpacawu\/gender-classification-tensorflow\/notebook\n\nfav_bvrg,bvrg_count=np.unique(train['Favorite Beverage'],return_counts=True)\nplt.pie(bvrg_count , labels = fav_bvrg,autopct='%1.1f%%')\nplt.axis('equal')\nplt.title('Favorite Drink')\nplt.show()","84df0f67":"#Code by Alpaca Wu https:\/\/www.kaggle.com\/alpacawu\/gender-classification-tensorflow\/notebook\n\ndef ann():\n    model = tf.keras.Sequential([\n        tf.keras.layers.Dense(16,activation='relu',input_dim=21),\n        tf.keras.layers.Dense(8,activation='relu'),\n        tf.keras.layers.Dense(2,activation='softmax')\n    ])\n    model.compile(optimizer='rmsprop',loss='categorical_crossentropy',metrics=['accuracy'])\n    return model","42227c40":"train_dum=pd.get_dummies(train)\ntrain_dum","838f9532":"train_dum=train_dum.to_numpy()","6b1a92d2":"#Code by Alpaca Wu https:\/\/www.kaggle.com\/alpacawu\/gender-classification-tensorflow\/notebook\n\nX=train_dum[:,:-2]\ny=train_dum[:,-2:]","aa1b60f6":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.1, random_state=42)","d9b0cc45":"#Code by Alpaca Wu https:\/\/www.kaggle.com\/alpacawu\/gender-classification-tensorflow\/notebook\n\nmodel=ann()\nhistory=model.fit(X_train,y_train,epochs=32,batch_size=1)","a08ce1aa":"history.history.keys()","2d827ba6":"plt.plot(history.history['accuracy'])\nplt.ylabel('accuracy')\nplt.xlabel('epoch')\nplt.show()","5370a347":"plt.plot(history.history['loss'])\nplt.ylabel('loss')\nplt.xlabel('epoch')\nplt.show()","908d91ec":"y_pred=model.predict(X_test)","18a4fdef":"#Code by Alpaca Wu https:\/\/www.kaggle.com\/alpacawu\/gender-classification-tensorflow\/notebook\n\ny_test_inverse=np.argmax(y_test,axis=1)\ny_pred_inverse=np.argmax(y_pred,axis=1)","3ed65afd":"#Code by Alpaca Wu https:\/\/www.kaggle.com\/alpacawu\/gender-classification-tensorflow\/notebook\n\ncm=confusion_matrix(y_test_inverse,y_pred_inverse)\nac=accuracy_score(y_test_inverse,y_pred_inverse)\ncm,ac","90a8d6db":"submission.to_csv('sample_submission.csv', index = False)","fd57e8cc":"#Code by Alpaca Wu https:\/\/www.kaggle.com\/alpacawu\/gender-classification-tensorflow\/notebook","b7d9ff99":"#According to Madhan Chandrasekharan conclusion, https:\/\/www.kaggle.com\/gcmadhan\/gender-classification-sklearn-models\n\n\"That's are the reasons for the low accuracy:\"\n\n\"Dataset is small - 66 rows and Dataset was splited in Test & Train datasets.\"\n\nAdditionally, I \"adapted\" that Notebook. Which is enough for justify any low score. In fact, having any Score will do for me.","fcc11fd7":"![](https:\/\/i.ytimg.com\/vi\/JHNX5ugPa7s\/maxresdefault.jpg)youtube.com","d2b5377b":"![](https:\/\/numerologysign.com\/wp-content\/uploads\/2019\/05\/Angel-Number-6666.jpg)numerologysign.com","af5f112a":"#The submission was without ID\/Gender to avoid misunderstood with so Many Genders Identities.","5c474346":"#I received that Error when I ran Model.fit below:\" ValueError: Input 0 of layer sequential is incompatible with the layer: expected axis -1 of input shape to have value 20 but received input with shape (1, 21)\"\n\n#In the Original was input_dim=20, Hence I changed to dim =21. So the Epochs Go on.","3f97de05":"#Accuracy Score 0.66666666666"}}