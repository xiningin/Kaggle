{"cell_type":{"29d1fe96":"code","755a9691":"code","e6aa0588":"code","eb7783e7":"code","228ad888":"code","c2aa958c":"code","7d96105e":"code","5c9c20ea":"code","e3ae1d4f":"code","42834cfe":"code","f7305129":"code","6e7cdb23":"code","f065dfde":"code","bfadcd7d":"code","61001044":"code","af0ce13a":"code","9bdad4ff":"code","368f2ac8":"code","7033a232":"code","c2461265":"code","ace535c4":"code","51644ac7":"code","51e060e9":"markdown","57e2f750":"markdown","54ff02d9":"markdown","88a035e3":"markdown","b1007cb0":"markdown","449481b0":"markdown","a6ba77a3":"markdown","8f7199fb":"markdown","6b100d3d":"markdown","ecdd6a53":"markdown","06ed81ba":"markdown","6c6b0eb0":"markdown","83a8a327":"markdown","0e87b964":"markdown","5b77c2ca":"markdown"},"source":{"29d1fe96":"!pip install pyvis","755a9691":"# packages\n\n# standard\nimport numpy as np\nimport pandas as pd\nimport time\n\n# plots\nimport matplotlib.pyplot as plt\nimport plotly.express as px\nimport seaborn as sns\n\n# graph\nimport networkx as nx\nfrom pyvis.network import Network","e6aa0588":"# load edge data\nt1 = time.time()\ndf = pd.read_csv('..\/input\/twitter-edge-nodes\/Twitter-dataset\/data\/edges.csv', \n                 header=None, names=['Follower','Target'])\nt2 = time.time()\nprint('Elapsed time [s]: ', np.round(t2-t1,2))","eb7783e7":"# preview\ndf","228ad888":"follower = 1\ndf_select = df[df.Follower==follower]\ndf_select","c2aa958c":"# create graph from edges\nG = nx.from_pandas_edgelist(df_select, 'Follower', 'Target', create_using=nx.DiGraph())\n# and plot\nnx.draw(G, with_labels=True, node_size=1000, alpha=0.5, arrows=True)\nplt.title('Targets that ' + str(follower) + ' follows')\nplt.show()","7d96105e":"target = 3\ndf_select = df[df.Target==target]\ndf_select","5c9c20ea":"# create graph from edges\nG = nx.from_pandas_edgelist(df_select, 'Follower', 'Target', create_using=nx.DiGraph())\n# and plot\nnx.draw(G, with_labels=True, node_size=1000, alpha=0.5, arrows=True)\nplt.title('Followers of target ' + str(target))\nplt.show()","e3ae1d4f":"user = 100\ndf_out = df[df.Follower==user]\ndf_in = df[df.Target==user]\ndf_select = pd.concat([df_in,df_out])\ndf_select","42834cfe":"# create graph from edges\nG = nx.from_pandas_edgelist(df_select, 'Follower', 'Target', create_using=nx.DiGraph())\n# and plot\nnx.draw_circular(G, with_labels=True, node_size=1000, alpha=0.5, arrows=True)\nplt.title('Bidirectional view of user ' + str(user))\nplt.show()","f7305129":"net = Network(notebook=True, width='800px', height='500px')\nnet.directed = True\nnet.from_nx(G)\nnet.show('example.html')","6e7cdb23":"# frequency table\nf_counts = df.Follower.value_counts().rename_axis('Follower').reset_index(name='Frequency')\n\n# top 10\nf_counts[0:10]","f065dfde":"# stats\nf_counts.Frequency.describe()","bfadcd7d":"# plot in log scale\nplt.hist(np.log10(1+f_counts.Frequency),100)\nplt.yscale('log')\nplt.grid()\nplt.title('Distribution of following count')\nplt.xlabel('log10(1+counts)')\nplt.show()","61001044":"# frequency table\nt_counts = df.Target.value_counts().rename_axis('Target').reset_index(name='Frequency')\n\n# top 10\nt_counts[0:10]","af0ce13a":"# stats\nt_counts.Frequency.describe()","9bdad4ff":"# plot in log scale\nplt.hist(np.log10(1+t_counts.Frequency),100)\nplt.yscale('log')\nplt.grid()\nplt.title('Distribution of target count')\nplt.xlabel('log10(1+counts)')\nplt.show()","368f2ac8":"# select subset\ndf_sub = df.sample(100000, random_state=987)","7033a232":"# build graph from data frame\nG = nx.from_pandas_edgelist(df_sub, 'Follower', 'Target', create_using=nx.DiGraph())","c2461265":"# calc pagerank for each node\npageranks = nx.pagerank(G)\n\n# convert to data frame\npageranks = pd.DataFrame.from_dict(pageranks, orient='index',\n                                  columns=['Pagerank'])\n# and sort by pagerank\npageranks = pageranks.sort_values(by=['Pagerank'], ascending=False)","ace535c4":"# show top 10\npageranks[0:10]","51644ac7":"# frequency table \/ top 10\nt_counts_sub = df_sub.Target.value_counts().rename_axis('Target').reset_index(name='Frequency')\nt_counts_sub[0:10]","51e060e9":"<a id='1'><\/a>\n# Visualizations","57e2f750":"### The full graph would be too big for the 16GB memory environment, so we are just making a demo on a small subset.","54ff02d9":"### Get all followers of a target","88a035e3":"#### Interactive Plot:","b1007cb0":"#### Interpretation: A target has in average 12.88 followers.","449481b0":"# Twitter Graphs\n## Table of Contents\n* [Visualizations](#1)\n* [Global Statistics](#2)\n* [Page Rank - Demo on subset](#3)","a6ba77a3":"### Bidirectional","8f7199fb":"### Compare with simple frequency count:","6b100d3d":"<a id='3'><\/a>\n# Pagerank - Demo on subset","ecdd6a53":"<a id='2'><\/a>\n# Global Statistics","06ed81ba":"### Most active followers","6c6b0eb0":"#### Interpretation: A follower has in average 9.73 targets.","83a8a327":"### (1,2) means user (follower) with id \"1\" is following user (target) with id \"2\".","0e87b964":"### Most followed targets","5b77c2ca":"### Filter by follower"}}