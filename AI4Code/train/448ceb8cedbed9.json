{"cell_type":{"8c5244b0":"code","e2c13501":"code","e93c91ca":"code","33128efa":"code","0e9bed92":"code","ef226462":"code","37b21e41":"code","44563d30":"code","6b916d93":"code","7703c451":"code","6be51043":"code","71864260":"code","3b16a52a":"code","21301883":"code","781d4dae":"code","854731bb":"code","2dfd23cf":"code","397d2ed6":"code","14402c69":"code","86731123":"code","419f96c4":"code","d910d740":"code","17eb350b":"code","2bed6198":"markdown","9dffdb43":"markdown","db965acb":"markdown","01395a3f":"markdown","be3957ee":"markdown","ce504233":"markdown","39e4b48e":"markdown","29caf309":"markdown","22c8efbb":"markdown"},"source":{"8c5244b0":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline","e2c13501":"df = pd.read_csv(\"..\/input\/Ecommerce Customers\")\ndf.head()","e93c91ca":"df.info()","33128efa":"df.describe()","0e9bed92":"sns.set_palette(\"GnBu_d\")\nsns.set_style('whitegrid')\nsns.jointplot(y='Yearly Amount Spent',x='Time on Website',data=df)","ef226462":"sns.jointplot(y='Yearly Amount Spent',x='Time on App',data=df)","37b21e41":"sns.jointplot(x=\"Time on App\", y=\"Length of Membership\", data=df, kind='hex')","44563d30":"sns.pairplot(data=df)","6b916d93":"sns.lmplot(x='Yearly Amount Spent',y='Length of Membership', data=df)","7703c451":"sns.jointplot(x='Yearly Amount Spent',y='Length of Membership', data=df, kind='reg')","6be51043":"from sklearn.model_selection import train_test_split","71864260":"df.columns","3b16a52a":"X = df[['Avg. Session Length', 'Time on App', 'Time on Website', 'Length of Membership']]\ny = df['Yearly Amount Spent']","21301883":"X_train, X_test, y_train, y_test = train_test_split(X,y,test_size=0.3, random_state=101)","781d4dae":"from sklearn.linear_model import LinearRegression","854731bb":"lm = LinearRegression()","2dfd23cf":"lm.fit(X_train, y_train)","397d2ed6":"lm.coef_\n#This shows for one unit increase in this yearly_amount_spent increases by following","14402c69":"y_predicted = lm.predict(X_test)","86731123":"sns.scatterplot(y_test, y_predicted)","419f96c4":"from sklearn import metrics\nprint('MAE: ',metrics.mean_absolute_error(y_test,y_predicted))\nprint('MSE: ',metrics.mean_squared_error(y_test,y_predicted))\nprint('RMSE:',np.sqrt(metrics.mean_squared_error(y_test,y_predicted)))","d910d740":"sns.distplot(y_test-y_predicted, bins=50)","17eb350b":"coeffecients = pd.DataFrame(lm.coef_,X.columns)\ncoeffecients.columns = ['Coeffecient']\ncoeffecients","2bed6198":"Data Exploration done.\n\nWe can see that above shows stron relation.\n\n# Linear Regression\nNow let do machine learning on this data and find best device to concentrate on.\n\n## Split into train and test\nX will be numeric data and Y is what we want to predict, 'Yearly Amount Spent'\n","9dffdb43":"# Residuals\nLets see how fit is our model","db965acb":"# Train the model","01395a3f":"# Conclusion\nWe can say from coefecients that time on app is increasing amount spent. However, interesting would be if we can find relation between, 'Lenght of Membership' and 'App time'.","be3957ee":"# Eploratory Data Analysis\nIn this we try to find relations between numeric columns","ce504233":"## Infer\nWe see that 'yearly amount spent' has a strong relation with 'length of membership' and then on 'time on app'\n\n","39e4b48e":"# Importing libraries and data\nWe need following libraries and lets see data with head, info and describe.\n\n**Describe** gives statistical information of numeric columns.\n","29caf309":"# Predict the values","22c8efbb":"# Evaluating the model"}}