{"cell_type":{"433a3661":"code","64ed3907":"code","7ea57cb3":"code","c2b3abfa":"code","f1dcf027":"code","fc826bfa":"code","cc101e6e":"code","5f0eb21f":"code","0326ccd1":"code","e3c60a37":"code","1854bd9b":"code","6306cdb1":"code","bdbe286d":"code","2fc7def7":"code","2d58f682":"code","ccc7100a":"code","b325d7df":"code","61cbfcc4":"code","f330ef87":"code","7f926857":"code","28bc8053":"code","b5dbbda3":"code","bb5bdebe":"code","a5fecef5":"code","70259d7d":"code","2e0fb148":"code","3b09597f":"code","7cb24718":"code","23d34e82":"code","11150ef5":"markdown","a82a64e6":"markdown","ef3c85bf":"markdown","94b08932":"markdown","f104fa53":"markdown","b9585a12":"markdown","a8df1cc7":"markdown","6b671437":"markdown","a3f6ec65":"markdown","b61fe46e":"markdown","1d416ef1":"markdown","9577ddcb":"markdown","7ab67796":"markdown","23c747a9":"markdown","1fc24593":"markdown","abeec524":"markdown","69198f9a":"markdown","84e2a369":"markdown","f456feb1":"markdown","47dd6704":"markdown","03bec611":"markdown","6809043c":"markdown","67e15e5d":"markdown","59808f50":"markdown","7dc4a4da":"markdown","a579d883":"markdown","7d95adce":"markdown","e8aeeea9":"markdown","916b0fb8":"markdown","9d467287":"markdown"},"source":{"433a3661":"# General tools\nimport pandas as pd\nimport numpy as np\nimport os, math\nfrom collections import Counter\n\n# Plotting\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\nmorancolor=sns.color_palette(['#66260b', '#cb8034', '#ddc08d', '#9c886f', '#47261a','#363634', '#524636', '#ac7330', '#b19a78', '#d1c5ab'])\nsns.set_theme(style=\"whitegrid\", palette=morancolor)\nplt.rcParams['font.family']='serif'\n# plt.rcParams['figure.dpi'] =70 # high resolution\n\nfrom wordcloud import WordCloud , ImageColorGenerator\nfrom PIL import Image\n\n# Manage warnings\nimport warnings\nwarnings.filterwarnings('ignore')","64ed3907":"df=pd.read_csv(\"..\/input\/amazon-top-50-bestselling-books-2009-2019\/bestsellers with categories.csv\")\ndf.columns=df.columns.str.strip().str.replace(' ','_').str.lower()\ndf.drop_duplicates(inplace=True)\ndf.shape","7ea57cb3":"df.sample(4)","c2b3abfa":"df.info()","f1dcf027":"df.isnull().sum().sort_values(ascending=False)","fc826bfa":"df.describe(include='O')","cc101e6e":"df.describe()","5f0eb21f":"df.name=df.name.str.strip()\ndf.author=df.author.str.strip().str.replace(' ','')","0326ccd1":"sorted(df.author.unique())","e3c60a37":"df.name=df.name.str.strip().str.title()","1854bd9b":"print(f\"Before: {df.shape}\")\ndf=df.drop_duplicates(subset='name',keep='last')\nprint(f\"After: {df.shape}\")","6306cdb1":"author=df.groupby('author').mean().user_rating.sort_values(ascending=False)\nprint(f\"Top authors with highest mean user ratings: {author[author>=4.9].shape[0]}\")\nprint('They are:')\nauthor[author>=4.9]","bdbe286d":"reviews=df.groupby('name').sum().reviews.sort_values(ascending=False).head(10)\nreviews","2fc7def7":"sns.barplot(data=reviews.to_frame().reset_index(),y='name',x='reviews')\nsns.despine(top=1,bottom=1,left=1,right=1)\nplt.ylabel('')\nplt.title('Top 10 books by # of reviews',fontweight='bold',fontsize=13)\nplt.show()","2d58f682":"reviews_by_author=df.groupby('author').sum().reviews.sort_values(ascending=False).head(10).to_frame().reset_index()\nsns.barplot(data=reviews_by_author,y='author',x='reviews')\nsns.despine(top=1,bottom=1,left=1,right=1)\nplt.ylabel('')\nplt.title('Top 10 authors by # of reviews',fontweight='bold',fontsize=13)\nplt.show()","ccc7100a":"sns.barplot(data=df.author.value_counts().sort_values(ascending=False).head(10).to_frame().reset_index().rename(columns={'author':'# of books','index':'author'}),\n            x='# of books',y='author')\nsns.despine(top=1,bottom=1,left=1,right=1)\nplt.ylabel('')\nplt.title('Top 10 authors with best-selling books',fontweight='bold',fontsize=13)\nplt.show()","b325d7df":"df.genre.value_counts(1)","61cbfcc4":"sns.countplot(df.genre,alpha=.92)\nsns.despine(top=1,bottom=1,left=1,right=1)\nplt.title('# of books by Genre',fontweight='bold',fontsize=13)\nplt.show()","f330ef87":"df.describe().T","7f926857":"def boxall(df,lst,h=3,w=14,cut=3,showmeans=True,hspace=.5,wspace=.25):\n    f=plt.figure(figsize=(w,h))\n    plt.subplots_adjust(hspace=hspace,wspace=wspace)\n    for i,col in enumerate(lst):\n        f.add_subplot(math.ceil(len(lst)\/cut),cut,i+1)\n        sns.boxplot(y=df[col],showmeans=showmeans)\n        plt.ylabel('')\n        plt.xlabel(col,fontweight='bold')\n        sns.despine(top=1,bottom=1,left=1,right=1)","28bc8053":"def kdeall(df,lst,h=4,w=15,cut=3,showmeans=True,hspace=.5,wspace=.25):\n    f=plt.figure(figsize=(w,h))\n    plt.subplots_adjust(hspace=hspace,wspace=wspace)\n    for i,col in enumerate(lst):\n        f.add_subplot(math.ceil(len(lst)\/cut),cut,i+1)\n        sns.kdeplot(df.dropna(subset=[col])[col],cut=0)\n        sns.rugplot(df.dropna(subset=[col])[col])\n        plt.axvline(df[col].median(),label='median')\n        plt.axvline(df[col].mean(),label='mean',ls='--')\n        plt.legend()\n        plt.ylabel('')\n        plt.xlabel(col,fontweight='bold')\n        sns.despine(top=1,bottom=1,left=1,right=1)","b5dbbda3":"numcol=[\"user_rating\", \"reviews\", \"price\"]\nkdeall(df,numcol)","bb5bdebe":"boxall(df,numcol)","a5fecef5":"df[numcol].corr()","70259d7d":"f,ax=plt.subplots(2,2,figsize=(13,7))\nsns.regplot(df.reviews,df.price,ax=ax[0,0])\nsns.stripplot(df.user_rating,df.reviews,color='#66260b',alpha=.6,ax=ax[0,1])\nsns.stripplot(df.user_rating,df.price,color='#66260b',alpha=.6,ax=ax[1,0])\nsns.despine(top=1,bottom=1,left=1,right=1)\nplt.tight_layout()","2e0fb148":"f,ax=plt.subplots(1,2,figsize=(14,6))\nsns.histplot(data=df,x=\"user_rating\",hue=\"genre\",kde=True,ax=ax[0])\nsns.despine(top=1,bottom=1,left=1,right=1)\nax[0].set_title('Distribution of User rating by Genre',fontweight='bold',fontsize=14)\n\nsns.boxplot(y=df.user_rating,x=df.genre)\nax[1].set_title('Boxplot for User rating by Genre',fontweight='bold',fontsize=14)\nplt.subplots_adjust(wspace=.3)","3b09597f":"from scipy.stats import shapiro\nstat,p=shapiro(df.user_rating)\nprint(f\"p-value: {p}\")\nif p>.05: print('Probably Gaussian')\nelse: print(f'Probably not Gaussian!')","7cb24718":"from scipy.stats import mannwhitneyu\nstat,p=mannwhitneyu(df[df.genre=='Fiction'].user_rating,df[df.genre!='Fiction'].user_rating)\nprint(f\"p-value: {p}\")\nif p>.05: print(f\"Probably the same distribution\")\nelse: print(f\"Probably different distributions\")","23d34e82":"print(\"*** Median value of user ratings ***\")\nfor i in df.genre.unique():\n    print(f\"{i}: {df[df.genre==i].user_rating.median()}\")","11150ef5":"# 3. Exploratory Data Analysis","a82a64e6":"### Data consistency: Categorical features","ef3c85bf":"### 3.1 Categorical features","94b08932":"## 3.2 Numerical features","f104fa53":"#### Genre","b9585a12":"There are no duplicates on our record, but in different years some books may have different prices or ratings, so they may appear more than once, we should keep the final values of these books","a8df1cc7":"- The average rating for our books is 4.7\n- Each book has received approximately 11953 reviews, while the highest value for reviews is 87841.\n- The average value for the price is 13.1 dollars, the most expensive book costs 105 dollars","6b671437":"- There are not any significant correlations between our numerical features","a3f6ec65":"#### Reviews","b61fe46e":"- Our numerical features are not normally distributed\n- User_rating: Mean and median values for user rating are 4.6\n- Reviews: Reviews feature has a positive skewness with some extremely large values to the right\n- Price: The avarage and median prices are around 11 dollars. The distribution of price is also right-skewed. Surprisingly, several books cost zero, we should check for these free-cost books","1d416ef1":"# Data Dictionary\n    Name: Name of the Book\n    Author: The author of the Book\n    User Rating: Amazon User Rating\n    Reviews: Number of written reviews on amazon\n    Price: The price of the book (As at 13\/10\/2020)\n    Year: The Year(s) it ranked on the bestseller\n    Genre: Whether fiction or non-fiction\n    \n**We should try to answer the following questions:**\n    \n    - Which author has highest average rating of books (top authors)\n    - Which author has the best-selling books (top authors)\n    - Which book has the most reviews (top books)\n    - Which genres become bestsellers more often\n    - Are genres different according to the ratings","9577ddcb":"# 1. Importing data","7ab67796":"## 2. Data distribution and Data cleaning","23c747a9":"### Drop duplicates","1fc24593":"#### User rating","abeec524":"### Importing Python libraries and our dataset","69198f9a":"- There is no missing data, so no need processing","84e2a369":"#### Best-selling books","f456feb1":"- The anthor has the most books on Amazon Top 50 Bestselling books 2009 - 2019 is Jeff Kinney with 12 books\n- The best-selling category is Non Fiction with 310 books\n- Both Name, Author and Genre contain duplicates","47dd6704":"    - Which author has highest average rating of books (top authors)\n    - Which author has the best-selling books (top authors)\n    - Which book has the most reviews (top books)\n    - Which genres become bestsellers more often","03bec611":"So, different genres have significant different ratings. Let's take a look at median values for user rating in each genre","6809043c":"#### First, we should check if our User_rating feature is normally distributed. We will use Shapiro-Wilk Test","67e15e5d":"    Mann-Whitney U Test: Tests whether the distributions of two independent samples are equal or not.\n\n    Assumptions: \n        - Observations in each sample are independent and identically distributed (iid).\n        - Observations in each sample can be ranked.\n    \n    Interpretation:\n        H0: the distributions of both samples are equal.\n        H1: the distributions of both samples are not equal.","59808f50":"    Shapiro-Wilk Test: Tests whether a data sample has a Gaussian distribution.\n\n    Assumptions: Observations in each sample are independent and identically distributed (iid).\n    \n    Interpretation\n        H0: the sample has a Gaussian distribution.\n        H1: the sample does not have a Gaussian distribution.","7dc4a4da":"# About this file\nData source: https:\/\/www.kaggle.com\/sootersaalu\/amazon-top-50-bestselling-books-2009-2019\n    \n    Dataset on Amazon's Top 50 bestselling books from 2009 to 2019. Contains 550 books, data has been categorized into fiction and non-fiction using Goodreads\n    \nReference: \n- https:\/\/www.kaggle.com\/ivannatarov\/amazon-s-books-eda-plotly-hypothesis-test\n- https:\/\/machinelearningmastery.com\/statistical-hypothesis-tests-in-python-cheat-sheet\/","a579d883":"### Data Completeness","7d95adce":"# Content\n1. Importing data\n2. Data distribution and Data cleaning\n3. Exploratory Data Analysis\n    - 3.1 Categorical features\n    - 3.2 Numerical features\n    - 3.3 Testing hypothesis","e8aeeea9":"## 3.3 Testing hypothesis\n    - Are genres different according to the ratings?","916b0fb8":"#### Now, let's perform testing on our initial hypotheis\nOur User_ranking feature is not normally distributed, so we will perform","9d467287":"    Let's form our hypothesis:\n    \n    + H0: There are no significant differences in rating between different genres\n    + H1: Different genres have significant different ratings"}}