{"cell_type":{"748a3f0e":"code","a58c780b":"code","24a14daa":"code","205a69af":"code","43a9c8a3":"code","2621deee":"code","8fb2ec82":"code","a2d3d628":"code","448430e0":"code","d557ee75":"code","a5bdc5ca":"code","e9fef508":"code","a1a42043":"code","223abd20":"markdown","c5b51b1a":"markdown","b2ff5b24":"markdown","e78fee2e":"markdown","6c27d391":"markdown","9755aa29":"markdown"},"source":{"748a3f0e":"%config IPCompleter.use_jedi = False\n!ls","a58c780b":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.preprocessing import *\nfrom sklearn.ensemble import *\nfrom sklearn.model_selection import *\nfrom sklearn.metrics import *\n%matplotlib inline\nimport matplotlib\nmatplotlib.rcdefaults()\nplt.style.available\n","24a14daa":"train_ori = pd.read_csv('..\/input\/tabular-playground-series-jul-2021\/train.csv', parse_dates=['date_time'])\ntest_ori = pd.read_csv('..\/input\/tabular-playground-series-jul-2021\/test.csv',parse_dates=['date_time'])\ndisplay(train_ori, test_ori)","205a69af":"train_ori.columns","43a9c8a3":"target_col = ['target_carbon_monoxide', 'target_benzene', 'target_nitrogen_oxides']\nfeature_col = ['deg_C', 'relative_humidity', 'absolute_humidity','sensor_1', 'sensor_2','sensor_3','sensor_4','sensor_5']\ndiscrete_col = ['deg_C', 'relative_humidity', 'absolute_humidity']\ncontinous_col = ['sensor_1', 'sensor_2', 'sensor_3', 'sensor_4', 'sensor_5']","2621deee":"#Plot discrete values and its relationships with target values\nfig, ax = plt.subplots(len(discrete_col), len(target_col),figsize=(14,14))\n\nfor row in range(len(discrete_col)):\n    for col in range(len(target_col)):\n        sns.histplot(x=discrete_col[row] ,y=target_col[col], data=train_ori ,ax=ax[row,col])\n        plt.tight_layout()","8fb2ec82":"for row in range(len(discrete_col)):\n    #plt.subplot(len(discrete_col),1,row+1)\n    #plt.hist(train_ori[discrete_col[row]])\n    sns.displot(train_ori[discrete_col[row]],bins=20)","a2d3d628":"sns.heatmap(train_ori.corr(), cmap='Greys')","448430e0":"fig, ax = plt.subplots(len(continous_col), len(target_col),figsize=(14,14))\n\nfor row in range(len(continous_col)):\n    for col in range(len(target_col)):\n        sns.histplot(x=continous_col[row] ,y=target_col[col], data=train_ori ,ax=ax[row,col])\n        plt.tight_layout()","d557ee75":"#Using basic params\nX = train_ori[feature_col]\ny_co = train_ori[target_col[0]]\ny_bz = train_ori[target_col[1]]\ny_no = train_ori[target_col[2]]\n\nX_train_co, X_test_co, y_train_co, y_test_co = train_test_split(X, y_co, test_size=0.25, random_state=0)\nRF_co = RandomForestRegressor().fit(X_train_co, y_train_co)\ny_predict_co = RF_co.predict(X_test_co)\nscore_co_basic = RF_co.score(X_test_co, y_test_co)\nMSLE_co_RF_basic = mean_squared_log_error(y_test_co, y_predict_co)\nprint(\"Score for CO RandomForestRegressor basic:\",score_co_basic)\nprint(\"MSLE for CO prediction:\", MSLE_co_RF_basic)\n\nX_train_bz, X_test_bz, y_train_bz, y_test_bz = train_test_split(X, y_bz, test_size=0.25, random_state=0)\nRF_bz = RandomForestRegressor().fit(X_train_bz, y_train_bz)\ny_predict_bz = RF_bz.predict(X_test_bz)\nscore_bz_basic = RF_bz.score(X_test_bz, y_test_bz)\nMSLE_bz_RF_basic = mean_squared_log_error(y_test_bz, y_predict_bz)\nprint(\"Score for Benzene RandomForestRegressor basic:\",score_bz_basic)\nprint(\"MSLE for Benzene prediction:\", MSLE_bz_RF_basic)\n\nX_train_no, X_test_no, y_train_no, y_test_no = train_test_split(X, y_no, test_size=0.25, random_state=0)\nRF_no = RandomForestRegressor().fit(X_train_no, y_train_no)\ny_predict_no = RF_no.predict(X_test_no)\nscore_no_basic = RF_no.score(X_test_no, y_test_no)\nMSLE_no_RF_basic = mean_squared_log_error(y_test_no, y_predict_no)\nprint(\"Score for NO RandomForestRegressor basic:\",score_no_basic)\nprint(\"MSLE for NO prediction:\", MSLE_no_RF_basic)\n\n","a5bdc5ca":"y_realtest_co = RF_co.predict(test_ori.iloc[:,1:])\ny_realtest_bz = RF_bz.predict(test_ori.iloc[:,1:])\ny_realtest_no = RF_no.predict(test_ori.iloc[:,1:])","e9fef508":"final = pd.DataFrame({'date_time': test_ori['date_time'].values, \n                     'target_carbon_monoxide': y_realtest_co, \n                     'target_benzene': y_realtest_bz, \n                     'target_nitrogen_oxides': y_realtest_no})","a1a42043":"final.to_csv('submission.csv', index = False)","223abd20":"### Inspection of Data","c5b51b1a":"### Import relevant packages","b2ff5b24":"### Categorization of columns into feature and Target based on project description\nSome columns are discrete and some are continous variable. These columns are split this way in order to find out relationship via EDA.","e78fee2e":"Most of the features having 2nd degree linear relationship with all target variables, except sensor 3 which have logarithmic relationship","6c27d391":"Seems the score and MSLE are acceptable.","9755aa29":"### Try to predict using Random Forest Regressor with default parameters."}}