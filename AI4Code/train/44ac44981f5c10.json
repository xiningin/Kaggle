{"cell_type":{"bebd5e32":"code","da766fc4":"code","d4577372":"code","d7bb9a21":"code","2963f688":"code","613e92cb":"code","fa7c5479":"code","a720165a":"code","1aa26fd1":"code","1a1e625e":"code","7da80a10":"code","a41ce34d":"code","0380360c":"code","283ed7e2":"code","a918b76c":"markdown"},"source":{"bebd5e32":"import pandas as pd\nimport numpy as np\nimport pandas as pd\nfrom sklearn.naive_bayes import MultinomialNB\nfrom sklearn.feature_extraction.text import TfidfVectorizer","da766fc4":"df = pd.read_csv(\"..\/input\/jigsaw-toxic-comment-classification-challenge\/train.csv\")\ndf.head()","d4577372":"df['y'] = (df[['toxic', 'severe_toxic', 'obscene', 'threat', 'insult', 'identity_hate']].sum(axis=1) > 0 ).astype(int)\ndf = df[['comment_text', 'y']].rename(columns={'comment_text': 'text'})\ndf.sample(5)","d7bb9a21":"min_len = (df['y'] == 1).sum()\ndf_y0_undersample = df[df['y'] == 0].sample(n=min_len, random_state=201)\ndf = pd.concat([df[df['y'] == 1], df_y0_undersample])\ndf['y'].value_counts()","2963f688":"from sklearn.feature_extraction.text import TfidfVectorizer\ntf = TfidfVectorizer()\nX = tf.fit_transform(df['text'])\nX.shape","613e92cb":"Y = df['y']","fa7c5479":"model = MultinomialNB()\nmodel.fit(X, df['y'])","a720165a":"df_val = pd.read_csv(\"..\/input\/jigsaw-toxic-severity-rating\/validation_data.csv\")\nX_less_toxic = tf.transform(df_val['less_toxic'])\nX_more_toxic = tf.transform(df_val['more_toxic'])\n\np1 = model.predict(X_less_toxic)\np2 = model.predict(X_more_toxic)\np1","1aa26fd1":"df_sub = pd.read_csv(\"..\/input\/jigsaw-toxic-severity-rating\/comments_to_score.csv\")\nX_test = tf.transform(df_sub['text'])\np3 = model.predict_proba(X_test)","1a1e625e":"df_sub","7da80a10":"df_sub['score'] = p3[:, 1]","a41ce34d":"df_sub['score'].count()","0380360c":"df_sub['score'].nunique()","283ed7e2":"df_sub[['comment_id', 'score']].to_csv(\"submission.csv\", index=False)","a918b76c":"This notebook has reference :- https:\/\/www.kaggle.com\/julian3833\/jigsaw-incredibly-simple-naive-bayes-0-768\/notebook"}}