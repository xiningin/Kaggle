{"cell_type":{"6709db62":"code","dd26969f":"code","95ebc5b0":"code","fde72099":"code","6ffd53e0":"code","c1bac76a":"code","267a7fe1":"code","8c7ca97a":"code","4f121c1a":"code","959e3548":"code","9dddda83":"code","7338d9ee":"code","d1410e17":"code","5c2b3fec":"code","13c429d2":"code","7580b71e":"code","73f0271d":"code","f8ed63b5":"code","cfb6bcb4":"code","62e5e9e7":"code","eedd7f2b":"code","c37eaf90":"code","52787be2":"code","84305ca4":"code","e8c6834a":"code","48035248":"code","757e1baf":"code","b17d7b94":"code","bbf73ad4":"code","4ab288bb":"code","58cce5a0":"code","850302b5":"code","4f751593":"code","6126ddde":"code","ded67014":"code","a96ef945":"code","cac90faf":"code","a18d1829":"code","50247e6d":"code","4aa76f54":"code","9bb95341":"markdown","c34e0532":"markdown","ae3c0935":"markdown","3a95cfe1":"markdown","952e86fe":"markdown","dfb32a27":"markdown","a478f171":"markdown","4ec60e1d":"markdown","ac1cccff":"markdown","e7a64e17":"markdown","aef4e4f1":"markdown","537f55ef":"markdown","7728fafc":"markdown","d204ec61":"markdown","43ea2e66":"markdown","4a84aab5":"markdown","701ef093":"markdown","b0fabf9a":"markdown","f067ba7b":"markdown","f6fbc08b":"markdown","55ab2495":"markdown"},"source":{"6709db62":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport warnings\nwarnings.filterwarnings('ignore')","dd26969f":"df = pd.read_csv('..\/input\/airquality\/data.csv')","95ebc5b0":"df.head()","fde72099":"df['type'].replace('Residential, Rural and other Areas','Residential',inplace = True)\ndf['type'].replace('Residential and others','Residential',inplace = True)\ndf['type'].replace('Industrial Areas','Industrial',inplace = True)\ndf['type'].replace('Industrial Area','Industrial',inplace = True)\ndf['type'].replace('Sensitive Area','Sensitive',inplace = True)\ndf['type'].replace('Sensitive Areas','Sensitive',inplace = True)","6ffd53e0":"df['type'].value_counts()","c1bac76a":"df['type'].value_counts().plot(kind = 'bar')","267a7fe1":"g = df.groupby(['state','type'])\nd = dict(list(g))\nkar_ind = d[('Karnataka','Industrial')].median()\nkar_res = d[('Karnataka','Residential')].median()\nkar_sen = d[('Karnataka','Sensitive')].median()\nprint(kar_ind,kar_res,kar_sen)\n# kar_riruo = d[('Karnataka','RIRUO')].mean()","8c7ca97a":"print(df['so2'].isnull().sum())\nprint(df['no2'].isnull().sum())","4f121c1a":"df.loc[(df['state'] == 'Karnataka') & (df['type'] == 'Industrial') & (df['so2'].isnull()),'so2'] = kar_ind['so2']\ndf.loc[(df['state'] == 'Karnataka') & (df['type'] == 'Residential') & (df['so2'].isnull()),'so2'] = kar_res['so2']\ndf.loc[(df['state'] == 'Karnataka') & (df['type'] == 'Sensitive') & (df['so2'].isnull()),'so2'] = kar_sen['so2']\n# df.loc[(df['state'] == 'Karnataka') & (df['type'] == 'RIROU') & (df['so2'].isnull()),'so2'] = kar_rirou['so2']","959e3548":"df.loc[(df['state'] == 'Karnataka') & (df['type'] == 'Industrial') & (df['no2'].isnull()),'no2'] = kar_ind['no2']\ndf.loc[(df['state'] == 'Karnataka') & (df['type'] == 'Residential') & (df['no2'].isnull()),'no2'] = kar_res['no2']\ndf.loc[(df['state'] == 'Karnataka') & (df['type'] == 'Sensitive') & (df['no2'].isnull()),'no2'] = kar_sen['no2']\n# df.loc[(df['state'] == 'Karnataka') & (df['type'] == 'RIROU') & (df['so2'].isnull()),'so2'] = kar_rirou['so2']","9dddda83":"df['date'] = pd.to_datetime(df['date'])","7338d9ee":"df['year'] = df['date'].dt.year","d1410e17":"df['year'].fillna(method = 'ffill',inplace = True)","5c2b3fec":"df['year'] = df['year'].astype(int)","13c429d2":"df['year'].isnull().sum()","7580b71e":"d = dict(list(df[['location','year','so2','no2']].groupby('location')))","73f0271d":"data = d['Bangalore'].groupby('year').median().reset_index()","f8ed63b5":"data","cfb6bcb4":"plt.figure(figsize=(15,5))\nplt.xticks(np.arange(1980,2016))\nsns.lineplot(x='year',y='so2',data=data)\nsns.lineplot(x='year',y='no2',data=data)\nplt.legend(['so2','no2'])","62e5e9e7":"df.head()","eedd7f2b":"print(df.rspm.isnull().sum())\nprint(df.spm.isnull().sum())","c37eaf90":"df1 = dict(list(df.groupby(['location','type'])))\ndata = pd.DataFrame()\nfor key in df1:\n    df2 = df1[key].sort_values('date')\n    df2['rspm'].fillna(method = 'ffill',inplace = True)\n    df2['spm'].fillna(method = 'ffill',inplace= True)\n    data = pd.concat([data,df2])","52787be2":"df1 = dict(list(data.groupby(['location','type'])))\ndata1 = pd.DataFrame()\nfor key in df1:\n    df2 = df1[key].sort_values('date')\n    df2['rspm'].fillna(method = 'bfill',inplace = True)\n    df2['spm'].fillna(method = 'bfill',inplace= True)\n    data1 = pd.concat([data1,df2])","84305ca4":"data1.head()","e8c6834a":"print(data1.rspm.isnull().sum())\nprint(data1.spm.isnull().sum())","48035248":"df1 = dict(list(data1.groupby(['state','type'])))\ndata2 = pd.DataFrame()\nfor key in df1:\n    df2 = df1[key]\n    df2['rspm'].fillna(df2['rspm'].median(),inplace = True)\n    df2['spm'].fillna(df2['spm'].median(),inplace= True)\n    data2 = pd.concat([data2,df2])","757e1baf":"print(data2.rspm.isnull().sum())\nprint(data2.spm.isnull().sum())","b17d7b94":"data2","bbf73ad4":"df1 = dict(list(data2.groupby('type')))\ndata3 = pd.DataFrame()\nfor key in df1:\n    df2 = df1[key]\n    df2['rspm'].fillna(df2['rspm'].median(),inplace = True)\n    df2['spm'].fillna(df2['spm'].median(),inplace= True)\n    data3 = pd.concat([data3,df2])","4ab288bb":"data3","58cce5a0":"print(data3.rspm.isnull().sum())\nprint(data3.spm.isnull().sum())","850302b5":"data3['type'].value_counts()","4f751593":"data3.reset_index(inplace=True)","6126ddde":"data3.drop(columns=['index','stn_code','sampling_date','agency','location_monitoring_station'],inplace = True)","ded67014":"data3.head()","a96ef945":"data3.groupby('state').median()['rspm'].sort_values(ascending = False).plot(kind = 'bar', figsize = (17,5))","cac90faf":"data3.groupby('location').median()['rspm'].sort_values(ascending = False).head(50).plot(kind = 'bar', figsize = (17,5))","a18d1829":"data3.groupby('location').median()['rspm'].sort_values(ascending = False).tail(50).plot(kind = 'bar', figsize = (17,5))","50247e6d":"data3.groupby('state').median()['spm'].sort_values(ascending = False).plot(kind = 'bar', figsize = (17,5))","4aa76f54":"data3.groupby('location').median()['spm'].sort_values(ascending = False).head(50).plot(kind = 'bar', figsize = (17,5))","9bb95341":"Similary we can see from the above plots that there is high level of spm for locations in Uttar Pradesh, Delhi and Rajasthan.","c34e0532":"In the above code I have done a forward fill for spm and rspm NA data depending on its location and type of location.","ae3c0935":"In the above code we have extracted the year from the date replaced na values for the same with forward fill","3a95cfe1":"From the above plot we can see that in BANGALORE there is an extreme peak in so2 level after 1995 till 1998. Furthur we see a sudden dip in so2 level in 1999 till 2000 which kept furthur gradually decreasing till 2005.","952e86fe":"In the above code we have replaced the na values for so2 in the state of karnataka with the medians depending on their type of locations ","dfb32a27":"Furthur any remaining NA values for rspm and spm have been replaced by medians grouped by type.","a478f171":"---\n---\n---\n---\n---","4ec60e1d":"***Please UpVote if you like the work!!!***","ac1cccff":"From the above figure we can see that the data was recorded more from the residential areas as compared to other areas.","e7a64e17":"![](http:\/\/)From the above plot we can also see that in BANGALORE there is an extreme peak in no2 level after 2001 till 2004 which gradually decreased after 2004.","aef4e4f1":"Furthurmore, if there are any values which are NA at first position according to location and type, I have done a backward fill for spm and rspm data depending on its location and type of location.","537f55ef":"A very high rspm level could directly affect the people with many breathing\/respiratory problems. ","7728fafc":"Still there is 'RIRUO' location type for which there exists NA values for spm.","d204ec61":"It quite evident from the above plots that the rspm levels are high for the following cities from Uttar pradesh and Punjab: \n\nUP : Ghaziabad, Allahabad, Bareilly, Mathura, Khurja, Lucknow, Kanpur\n\nPunjab : Ludhiana, Khanna, Amritsar, Bhatinda\n\nWe can verify the same with the following article from indian express in september 2008 : http:\/\/archive.indianexpress.com\/news\/khurja-state-s-most-polluted-town-lucknow-comes-second\/360739\/","43ea2e66":"In the above code we have replaced the na values for no2 in the state of karnataka with the medians depending on their type of locations","4a84aab5":"***Please UpVote if you like the work!!!***","701ef093":"The above columns don't seem to be very useful for any furthur analysis so I prefer to drop these colums to concentrate more on the essential features.","b0fabf9a":"We can also see that the lowest rspm level are in Pathanamthitta which is a city in Kerela which is quite obvious as Kerela is among those states with lowest rspm levels","f067ba7b":"We have replaced all the similar types of locations and got them down to only 4 following categories:\n\nResidential\n\nIndustrial\n\nSensitive\n\nRIRUO","f6fbc08b":"Still we can see that there seem to be some locations with location types with all values as NA. Here the backward or forward fill won't work. So I have replaced such values with median grouped by state and location type.","55ab2495":"---\n---\n---\n---\n---"}}