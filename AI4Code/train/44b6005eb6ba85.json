{"cell_type":{"f2edcb8c":"code","98b9cd1e":"code","7702ae1e":"code","3a45ca4c":"code","9b11ec83":"code","707d39b2":"code","a8db4327":"code","39ab4b64":"code","8f7f31a9":"code","2023795a":"code","07fa4280":"code","cf06512d":"code","5104fd43":"code","7e673c50":"code","21c03da3":"code","74b5fb3b":"code","dd4383f1":"code","12a5710e":"code","87aef6c5":"code","9c13749b":"code","f34912a2":"code","20573394":"code","b0d6a760":"code","a8cd08e1":"code","03314417":"code","b8250786":"code","634858af":"code","e7863d9a":"code","ac125b38":"code","2119d773":"code","3cf166de":"code","548c12c4":"code","0d7457a5":"code","7df06eea":"code","4dc03f94":"markdown","c1390077":"markdown","0726a1c2":"markdown","1add786a":"markdown","0d637eb0":"markdown","18ed3f87":"markdown","78836cbb":"markdown","5c9ae860":"markdown","cd7bd9f3":"markdown","48234b09":"markdown","29e3c376":"markdown","28a2fbf4":"markdown","d6fcbda5":"markdown","eb73c340":"markdown","574dbb67":"markdown","ac95c071":"markdown","e8dc1205":"markdown","d4547170":"markdown","0cb7069f":"markdown","96437ddc":"markdown","8d5d4206":"markdown","254774f1":"markdown","2df3b652":"markdown","858eacbc":"markdown","78650ca9":"markdown","5e50294e":"markdown","b31cd7b2":"markdown","14c2758e":"markdown","143e3af8":"markdown","93933eb9":"markdown","e331236a":"markdown","4f8b1804":"markdown","0f983b5d":"markdown","af73995e":"markdown","3d28a063":"markdown"},"source":{"f2edcb8c":"import numpy as np \nimport pandas as pd \nimport os\nimport warnings  \nwarnings.filterwarnings('ignore')\nimport matplotlib.pyplot as plt\nimport seaborn as sns","98b9cd1e":"data = pd.read_csv('..\/input\/stroke-prediction-dataset\/healthcare-dataset-stroke-data.csv')\ndata","7702ae1e":"data.isnull().sum()","3a45ca4c":"data.bmi=(data.bmi.fillna(data['bmi'].mean()))\ndata.isnull().sum()","9b11ec83":"data.info()","707d39b2":"data.describe()","a8db4327":"sns.countplot(data['work_type'])","39ab4b64":"sns.countplot(data['Residence_type'])","8f7f31a9":"sns.countplot(data['smoking_status'])","2023795a":"sns.countplot(data['stroke'])","07fa4280":"sns.countplot(data['ever_married'])","cf06512d":"min_avg_glucose_level = min(data.avg_glucose_level)\nmax_avg_glucose_level = max(data.avg_glucose_level)\nprint(min_avg_glucose_level)\nprint(max_avg_glucose_level)","5104fd43":"sns.distplot(data['age'])","7e673c50":"sns.distplot(data['avg_glucose_level'])","21c03da3":"data['work_type'] = data['work_type'].map({'Private':0, 'Self-employed': 1, 'Govt_job':2, 'children':3, 'Never_worked':4})\ndata['gender'] = data['gender'].map({'Male':0, 'Female':1})\ndata['Residence_type'] = data['Residence_type'].map({'Urban':0, 'Rural':1})\ndata['smoking_status'] = data['smoking_status'].map({'formerly smoked':0, 'never smoked':1, 'smokes':2, 'Unknown':3})\ndata['ever_married'] = data['ever_married'].map({'Yes':0, 'No':1})","74b5fb3b":"data","dd4383f1":"plt.figure(figsize=(16,10))\nsns.heatmap(data.corr(method='pearson'), annot=True)","12a5710e":"sns.scatterplot(x=data['age'], y=data['avg_glucose_level'])","87aef6c5":"sns.catplot(x='stroke', y=\"avg_glucose_level\", kind=\"box\", data=data)","9c13749b":"sns.catplot(x='stroke', y=\"age\", hue = 'gender', kind=\"box\", data=data)","f34912a2":"X = data.drop('stroke',axis=1)\ny = data['stroke']","20573394":"X.isnull().sum() #WE STILL HAVE 1 NULL VALUE IN THE GENDER COLUMN","b0d6a760":"X.gender=(X.gender.fillna(1))\nX.isnull().sum()","a8cd08e1":"from imblearn.over_sampling import SMOTE\n\nsmote = SMOTE()\nx_smote, y_smote = smote.fit_resample(X, y)","03314417":"from sklearn.model_selection import train_test_split\nX_train,X_test, y_train,y_test=train_test_split(x_smote,y_smote,test_size=0.33,random_state=42)\nX_valid, X_test, y_valid, y_test = train_test_split(X_test, y_test, test_size=0.5, random_state=42)\nX_train = X_train.drop(columns=['id'])\nX_test = X_test.drop(columns=['id'])","b8250786":"from sklearn.preprocessing import StandardScaler\nsc=StandardScaler()\n\nX_train = sc.fit_transform(X_train)\nX_test = sc.transform(X_test)","634858af":"import xgboost as xgb\n\nmodel = xgb.XGBClassifier()\nmodel.fit(X_train,y_train)","e7863d9a":"from sklearn.metrics import f1_score, roc_auc_score,accuracy_score,confusion_matrix, precision_recall_curve, auc, roc_curve, recall_score, classification_report \ny_pred1 = model.predict(X_test)\nroc_auc_score(y_test, y_pred1)","ac125b38":"cm = confusion_matrix(y_test, y_pred1)\ncm","2119d773":"tn = cm[0,0]\nfp = cm[0,1]\ntp = cm[1,1]\nfn = cm[1,0]\naccuracy  = (tp + tn) \/ (tp + fp + tn + fn)\nprecision = tp \/ (tp + fp)\nrecall    = tp \/ (tp + fn)\nf1score  = 2 * precision * recall \/ (precision + recall)\nprint(f1score)","3cf166de":"predicted_probab = model.predict_proba(X_test)\npredicted_probab = predicted_probab[:, 1]\nfpr, tpr, _ = roc_curve(y_test, predicted_probab)","548c12c4":"from matplotlib import pyplot\npyplot.plot(fpr, tpr, marker='.', color='green',label='XGB Classifier')\npyplot.xlabel('False Positive Rate')\npyplot.ylabel('True Positive Rate')\npyplot.legend()\npyplot.show()","0d7457a5":"test=pd.DataFrame()\ntest['gender']=[input(\"Enter your gender. 0 for male and 1 for female\")]\ntest['age']=[input('Enter your age:',)]\ntest['hypertension']=[input('If you have hypertension,enter 1 and if not enter 0',)]\ntest['heart_disease']=[input('If you have heart disease, press 1 and if not press 0',)]\ntest['ever_married']=[input('If you are married, press 0 and if not press 1',)]\ntest['work_type']=[input('If you work in private,press 0, if self employed press 1, if in Govt job press 2.If you are children press 3 and if you are not employed press 4',)]\ntest['Residence_type']=[input('If you live in urban press 0, if in rural then enter 1')]\ntest['avg_glucose_level']=[input('Enter your average glucose level:',)]\ntest['bmi']=[input('Enter your BMI here:')]\ntest['smoking_status']=[input('If you smoke formerly, press 0. If you never smoke press 1 and if you smoke,press 2' )]\ntest1 = sc.transform(test)\ny = model.predict(test1)\nif y == [0]:\n    print('You are out of danger from getting a heart stroke')\nelse :\n    print('You are at the risk of getting a stroke')","7df06eea":"# model.save_model(\"my_model.json\")","4dc03f94":"AMAZING F1 SCORE","c1390077":"**CORRELATION HEATMAP** TO CHECK FOR ANY CORRELATION BETWEEN VARIABLES","0726a1c2":"**ROC CURVE**","1add786a":"**XGBOOST CLASSIFIER**","0d637eb0":"SPLITTING OF DATASET INTO TRAIN AND TEST","18ed3f87":"THERE ARE LARGE NUMBER OF PEOPLE WHO WORK ON PRIVATE SECTOR ","78836cbb":"### Using the model in real time\n","5c9ae860":"***FILLING THE NULL VALUES WITH AVERAGE OF THE BMI'S***","cd7bd9f3":"THE ABOVE PLOT SHOWS THAT THERE IS **HIGH IMBALANCE** IN THE BOTH THE TARGET CLASSES AN WE NEED TO RESOLVE THIS ISSUE BEFORE APPLYING ANY ALGORITHM","48234b09":"WOW!! AUC SCORE INCREASED","29e3c376":"**MAPPING OF CATEGORICAL VARIABLES**","28a2fbf4":"DIVIDING THE DATASET INTO FEATURES AND LABELE","d6fcbda5":"**APPLY MACHINE LEARNING ALGORITHM FOR PREDICTION**","eb73c340":"ONCE AGAIN CHECK FOR NULL VALUES IN THE DATASET","574dbb67":"STANDARDIZATION OF THE DATA IS REQUIRED AS DATA ARE IN DIFFERENT SCALES","ac95c071":"Saving the model","e8dc1205":"*AS WE CAN SEE BMI CONTAINS NULL VALUES AND WE NEED TO FIX THIS*","d4547170":"PEOPLE HAVING HIGHER GLUCOSE LEVEL ARE AT HIGH RISK OF STROKE","0cb7069f":"HIGH AGE FEMALES ARE AT THE RISK TO STROKE","96437ddc":"FROM THE ABOVE SCATTER PLOT IT IS QUITE VISIBLE THAT AS THE AGE INCREASE IT LEADS TO INCREASE IN GLUCOSE LEVEL","8d5d4206":"So from above statistical description of the dataset we can see that mean age of people is around 43 years and mean bmi is more than normal","254774f1":"THE ABOVE MINIMUM AND MAXIMUM VALUES OF AVERAGE GLUCOSE LEVEL SHOWS THAT THE COLUMN NEEDS TO BE STANDARDIZED AS THERE IS VERY HIGH DIFFERENCE BETWEEN THEM","2df3b652":"*A stroke occurs when the blood supply to part of your brain is interrupted or reduced, preventing brain tissue from getting oxygen and nutrients. Brain cells begin to die in minutes*\nThere can be various factors related to occurence to stroke. So using the data given we try to list out the potential factors by using various visualization techniques. ","858eacbc":"**COUNTPLOT TO SEE THE DISTRIBUTION OF WORK_TYPE**","78650ca9":"SINCE THE TARGET CLASS IS HIGHLY IMBALANCED, WE NEED TO TREAT IT AS IT'S PRESENCE WILL LEAD TO POOR PERFORMANCE OF THE MODEL. HERE I HAVE USED SMOTE (Synthetic Minority Oversampling Technique) TECHNIQUE. SMOTE WORKS BY RANDOMNLY PICKING A POINT FROM MINORITY CLASS AND COMPUTING A K-NEAREST NEIGHBOURS FOR THIS POINT.","5e50294e":"DATASET AFTER MAPPING OF CATEGORICAL VARIABLES","b31cd7b2":"**TREATING IMBALANCE CLASS USING SMOTE**","14c2758e":"FROM THE ABOVE FIGURE WE CAN SEE THAT-\nWORK_TYPE AND BMI - NEGATIVE CORRELATION\nSTROKE AND AGE HAS A POSITIVE CORRELATION\nSIMILARLY MANY OTHER VARIABLES HAVE SUCH CORRELATION VALUES WE CANNOT REMOVE ANY VARIABLES. WE HAVE TO CONSIDER ALL THE VARIABLES FOR OUR MODEL","143e3af8":"**CONTEXT**\n\nAccording to the World Health Organization (WHO) stroke is the 2nd leading cause of death globally, responsible for approximately 11% of total deaths.\nThis dataset is used to predict whether a patient is likely to get stroke based on the input parameters like gender, age, various diseases, and smoking status. Each row in the data provides relavant information about the patient.*","93933eb9":"THERE ARE ALMOST SAME NUMBER OF PEOPLE LIVING IN BOTH URBAN AND RURAL AREAS","e331236a":"WHILE PLOTTING WE NEED TO KEEP IN MIND THAT AGAINST WHICH TYPE OF VARIABLES WE ARE PLOTTING THEN ONLY WE CAN DRAW INSIGHT FROM IT","4f8b1804":"GOOD TO SEE THAT MOST NUMBER OF PEOPLE NEVER SMOKED AS \"SMOKING KILLS\"","0f983b5d":"**CHECK FOR NULL VALUES**","af73995e":"SO NOW NO NULL VALUES PRESENT","3d28a063":"**READ DATA**"}}