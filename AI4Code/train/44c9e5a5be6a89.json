{"cell_type":{"01b4600b":"code","0918fc97":"code","91c42a5f":"code","d64e9edc":"code","64677f8d":"code","c4543c42":"code","f1a36e48":"code","7e43d545":"code","b7c232ca":"code","6c676889":"code","031da4a9":"code","7482cd60":"code","ec4c39bd":"code","e3d48497":"code","c2d34641":"code","b424f752":"code","cc7ba2ac":"code","134f4667":"code","78af9d35":"code","41163400":"code","bba2b74b":"code","32708690":"code","01438178":"code","6a0e8798":"code","a03ccbaf":"code","2a5dfdda":"code","c9b7f850":"code","c6894759":"code","edfa9ce3":"code","8d096518":"code","e6e7c8e2":"code","20bf254e":"code","104b2524":"code","462c4d8e":"code","48b6090b":"code","b7367eee":"code","5474163a":"code","6a557cda":"code","ac8b0117":"code","7b947d48":"code","06f65916":"markdown","7702b862":"markdown","38633fe8":"markdown","c113a9dc":"markdown","1d245eb8":"markdown","ba967553":"markdown","715e0c1d":"markdown","a6fda5f2":"markdown","e862ea41":"markdown","70b0bba8":"markdown","b8d49ed2":"markdown","6663aa10":"markdown","db86a03c":"markdown","9aadb3b6":"markdown","119d6d51":"markdown","81cb06a0":"markdown","b5fb3f0c":"markdown","f381cd4b":"markdown","b6d9c2eb":"markdown","3cb41f84":"markdown","fd4ca71b":"markdown","7614ca7d":"markdown","5336557a":"markdown","46543a47":"markdown","0f739462":"markdown","a57799e2":"markdown","73ff1fe0":"markdown"},"source":{"01b4600b":"import warnings\nwarnings.filterwarnings('ignore')\n\nimport requests\nimport pandas as pd\nimport numpy as np\nimport plotly.graph_objects as go\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","0918fc97":"path = '\/kaggle\/input\/crime-against-women-20012014-india\/crimes_against_women_2001-2014.csv'\ndf = pd.read_csv(path, index_col=0)\ndf.columns = ['state_unit', 'district', 'year', 'rape', 'kidnap_abduction', 'dowry_deaths', \n              'women_assault', 'women_insult', 'husband_relative_cruelty', 'girl_importation']\ndf.index = list(range(df.shape[0]))\n\nfor col in df.columns:\n    df[col] = df[col].apply(lambda x : x.title() if isinstance(x, str) else x)\n\n# replacements\nreplacements = {\n    'A & N Islands' : 'Andaman and Nicobar',\n    'A&N Islands' : 'Andaman and Nicobar',\n    'Daman & Diu' : 'Daman and Diu',\n    'Delhi Ut' : 'Delhi',\n    'D & N Haveli' : 'Dadra and Nagar Haveli',\n    'D&N Haveli' : 'Dadra and Nagar Haveli',\n    'Odisha' : 'Orissa',\n    'Jammu & Kashmir' : 'Jammu and Kashmir'\n}\n\nfor (o, r) in replacements.items():\n    df['state_unit'].replace(to_replace=o, value=r, inplace=True)","91c42a5f":"df.shape","d64e9edc":"df.columns","64677f8d":"def split_data(dframe):\n    min_year = dframe['year'].min()\n    max_year = dframe['year'].max()\n    \n    data_year_wise = {\n        year : dframe[dframe['year'] == year] for year in range(min_year, max_year + 1)\n    }\n    \n    return data_year_wise","c4543c42":"data_splits = split_data(dframe=df)","f1a36e48":"for (y, d) in data_splits.items():\n    print(y, '\\t\u2192', d.shape)","7e43d545":"def categorize_crimes(data_source, state_unit=None):\n    crime_list = list(data_source[2001].columns[3:])\n\n    all_crimes_year_wise = {}\n    for (y, d) in data_source.items():\n        y_df = d[d['district'].str.contains('Total')]\n        if state_unit:\n            y_df = y_df[y_df['state_unit'] == state_unit.title()]\n        crime_dict = {col : y_df[col].sum() for col in crime_list}\n        # all_crimes_year_wise[y] = dict(sorted(crime_dict.items(), key=lambda x:x[1], reverse=True))\n        all_crimes_year_wise[y] = crime_dict\n    \n    return all_crimes_year_wise","b7c232ca":"def plot_overall_crimes_by_year(data_source, state_unit=None, kind='bar'):\n    crimes_data = categorize_crimes(data_source=data_source, state_unit=state_unit)\n    year_sum_crimes = {y : sum(list(cr.values())) for (y, cr) in crimes_data.items()}\n    \n    y_keys = list(year_sum_crimes.keys())\n    y_vals = list(year_sum_crimes.values())\n    \n    t = 'Total Crimes - {}'\n    title = t.format(state_unit.title()) if state_unit else t.format('India')\n    \n    if kind == 'bar':\n        trace = go.Bar(x=y_keys, y=y_vals)\n    else:\n        trace = go.Pie(labels=y_keys, values=y_vals)\n    \n    layout = go.Layout(\n        height=400,\n        width=600,\n        title=title,\n        margin=dict(l=0, r=0, b=0, t=40)\n    )\n    \n    fig = go.Figure(data=[trace], layout=layout)\n    fig.show()\n    \n    return None","6c676889":"plot_overall_crimes_by_year(data_source=data_splits)","031da4a9":"plot_overall_crimes_by_year(data_source=data_splits, kind='pie')","7482cd60":"plot_overall_crimes_by_year(data_source=data_splits, state_unit='Andhra Pradesh')","ec4c39bd":"plot_overall_crimes_by_year(data_source=data_splits, state_unit='Andhra Pradesh', kind='pie')","e3d48497":"def plot_crimes_by_year(data_source, year, state_unit=None, kind='bar'):\n    crimes_data = categorize_crimes(data_source=data_source, state_unit=state_unit)\n    year_all_crimes = crimes_data[year]\n    \n    y_keys = list(year_all_crimes.keys())\n    y_vals = list(year_all_crimes.values())\n    \n    t = '{} - Total Crimes - {}'\n    title = t.format(year, state_unit.title()) if state_unit else t.format(year, 'India')\n    \n    if kind == 'bar':\n        trace = go.Bar(x=y_keys,y=y_vals)\n    else:\n        trace = go.Pie(labels=y_keys, values=y_vals)\n    \n    layout = go.Layout(\n        height=400,\n        width=600,\n        title=title,\n        margin=dict(l=0, r=0, b=0, t=40)\n    )\n    \n    fig = go.Figure(data=[trace], layout=layout)\n    fig.show()\n    \n    return None","c2d34641":"plot_crimes_by_year(data_source=data_splits, year=2001)","b424f752":"plot_crimes_by_year(data_source=data_splits, year=2001, kind='pie')","cc7ba2ac":"plot_crimes_by_year(data_source=data_splits, year=2001, state_unit='Andhra Pradesh')","134f4667":"plot_crimes_by_year(data_source=data_splits, year=2001, state_unit='Andhra Pradesh', kind='pie')","78af9d35":"def plot_overall_difference(data_source, ideal_year, cwith_year, state_unit=None):\n    crime_data = categorize_crimes(data_source=data_source, state_unit=state_unit)\n    \n    ideal_year_crimes = crime_data[ideal_year]\n    cwith_year_crimes = crime_data[cwith_year]\n    \n    t = '{} vs {} - diff - {}'\n    title = t.format(ideal_year, cwith_year, state_unit.title()) if state_unit else t.format(ideal_year, cwith_year, 'India')\n    \n    trace1 = go.Bar(\n        x=list(ideal_year_crimes.keys()),\n        y=list(ideal_year_crimes.values()),\n        name=ideal_year\n    )\n    trace2 = go.Bar(\n        x=list(cwith_year_crimes.keys()),\n        y=list(cwith_year_crimes.values()),\n        name=cwith_year\n    )\n    \n    layout = go.Layout(\n        height=400,\n        width=600,\n        title=title,\n        margin=dict(l=0, r=0, b=0, t=40)\n    )\n    \n    fig = go.Figure(data=[trace1, trace2], layout=layout)\n    fig.show()\n    \n    return None","41163400":"plot_overall_difference(data_source=data_splits, ideal_year=2001, cwith_year=2014)","bba2b74b":"plot_overall_difference(data_source=data_splits, ideal_year=2001, cwith_year=2012, state_unit='Andhra Pradesh')","32708690":"def plot_crime_overall_diff(data_source, crime, state_unit=None, kind='bar'):\n    crime_data = categorize_crimes(data_source=data_source, state_unit=state_unit)\n    \n    years_x = list(crime_data.keys())\n    crime_y = [cr[crime] for (y, cr) in crime_data.items()]\n    \n    t = '{} - {} | {} \u2192 {}'\n    min_y = years_x[0]; max_y = years_x[-1]\n    title = t.format(min_y, max_y, state_unit.title(), crime) if state_unit else t.format(min_y, max_y, 'India', crime)\n    \n    if kind == 'bar':\n        trace = go.Bar(x=years_x, y=crime_y)\n    else:\n        trace = go.Pie(labels=years_x, values=crime_y)\n    \n    layout = go.Layout(\n        height=400,\n        width=600,\n        title=title,\n        margin=dict(l=0, r=0, b=0, t=40)\n    )\n    \n    fig = go.Figure(data=[trace], layout=layout)\n    fig.show()\n    \n    return None","01438178":"plot_crime_overall_diff(data_source=data_splits, crime='rape')","6a0e8798":"plot_crime_overall_diff(data_source=data_splits, crime='rape', kind='pie')","a03ccbaf":"plot_crime_overall_diff(data_source=data_splits, crime='rape', state_unit='Andhra Pradesh')","2a5dfdda":"plot_crime_overall_diff(data_source=data_splits, crime='rape', state_unit='Andhra Pradesh', kind='pie')","c9b7f850":"def obtain_features(data_source, year, crime, state_unit=None):\n    sub_df = data_source[year]\n    \n    if not state_unit:\n        sub_df = sub_df[sub_df['district'].str.contains('Total')]\n        states_x = sub_df['state_unit']\n        states_x.loc[states_x.shape[0]] = 'Ladakh'\n        crime_y = sub_df[crime]\n        crime_y.loc[crime_y.shape[0]] = 0\n    else:\n        state_unit = state_unit.title()\n        sub_df = sub_df[sub_df['state_unit'] == state_unit]\n        sub_df = sub_df[:-1]\n        states_x = sub_df['district']\n        crime_y = sub_df[crime]\n    \n    return states_x.to_list(), crime_y.to_list()","c6894759":"def plot_column(data_source, year, crime, state_unit=None, kind='bar'):\n    states_x, crime_y = obtain_features(data_source=data_source, year=year, crime=crime, state_unit=state_unit)\n    \n    t = '{} | {} \u2192 {}'\n    title = t.format(year, crime, state_unit.title()) if state_unit else t.format(year, crime, 'India')\n    \n    if kind == 'bar':\n        trace = go.Bar(x=states_x, y=crime_y)\n    else:\n        trace = go.Pie(labels=states_x, values=crime_y)\n    \n    layout = go.Layout(\n        height=400,\n        width=600,\n        title=title,\n        margin=dict(l=0, r=0, b=0, t=40)\n    )\n    \n    fig = go.Figure(data=[trace], layout=layout)\n    fig.show()\n    \n    return None","edfa9ce3":"plot_column(data_source=data_splits, year=2001, crime='kidnap_abduction')","8d096518":"plot_column(data_source=data_splits, year=2001, crime='kidnap_abduction', kind='pie')","e6e7c8e2":"plot_column(data_source=data_splits, year=2001, crime='kidnap_abduction', state_unit='andhra pradesh')","20bf254e":"plot_column(data_source=data_splits, year=2001, crime='kidnap_abduction', state_unit='andhra pradesh', kind='pie')","104b2524":"def compare_crime_by_years(data_source, ideal_year, cwith_year, crime, state_unit=None):\n    states_x1, crime_y1 = obtain_features(data_source=data_source, year=ideal_year, crime=crime, state_unit=state_unit)\n    states_x2, crime_y2 = obtain_features(data_source=data_source, year=cwith_year, crime=crime, state_unit=state_unit)\n    \n    trace1 = go.Bar(x=states_x1, y=crime_y1, name=ideal_year)\n    trace2 = go.Bar(x=states_x2, y=crime_y2, name=cwith_year)\n    \n    t = '{} vs {} | {} \u2192 {}'\n    title = t.format(ideal_year, cwith_year, crime, state_unit.title()) if state_unit else t.format(ideal_year, cwith_year, crime, 'India')\n    \n    layout = go.Layout(\n        height=400,\n        width=800,\n        title=title,\n        margin=dict(l=0, r=0, b=0, t=40)\n    )\n    \n    fig = go.Figure(data=[trace1, trace2], layout=layout)\n    fig.show()\n    \n    return None","462c4d8e":"compare_crime_by_years(\n    data_source=data_splits, \n    ideal_year=2001, \n    cwith_year=2014, \n    crime='husband_relative_cruelty'\n)","48b6090b":"compare_crime_by_years(\n    data_source=data_splits, \n    ideal_year=2001, \n    cwith_year=2014, \n    crime='husband_relative_cruelty', \n    state_unit='Andhra Pradesh'\n)","b7367eee":"def get_india_map(year, state_unit=None):\n    if year < 2014:\n        if not state_unit:\n            return 'https:\/\/raw.githubusercontent.com\/geohacker\/india\/master\/state\/india_state.geojson'\n        return 'https:\/\/raw.githubusercontent.com\/geohacker\/india\/master\/district\/india_district.geojson'\n    return 'https:\/\/raw.githubusercontent.com\/geohacker\/india\/master\/state\/india_telengana.geojson'","5474163a":"def get_districts_json(year, state_unit=None):\n    geo_link = get_india_map(year=year, state_unit=state_unit)\n    \n    if not state_unit:\n        return geo_link\n    \n    req_data = requests.get(url=geo_link)\n    req_json = req_data.json()['features']\n    \n    state_districts = []\n    for feature in req_json:\n        if feature['properties']['NAME_1'] == state_unit:\n            state_districts.append(feature)\n    \n    return {\n        \"type\": \"FeatureCollection\",\n        \"crs\": { \"type\": \"name\", \"properties\": { \"name\": \"urn:ogc:def:crs:OGC:1.3:CRS84\" } },\n        \"features\" : state_districts\n    }","6a557cda":"def plot_state_wise(data_source, year, crime, state_unit=None):\n    state_unit = None\n    state_x, crime_y = obtain_features(data_source=data_source, year=year, crime=crime, state_unit=state_unit)\n    df_cols = ['name', 'crime_count']\n    state_crime_df = pd.DataFrame(data=zip(state_x, crime_y), columns=df_cols)\n    \n    trace = go.Choropleth(\n        geojson=get_districts_json(year=year, state_unit=state_unit),\n        featureidkey='properties.NAME_1',\n        locations=state_crime_df['name'],\n        z=state_crime_df['crime_count'],\n        colorscale='Reds',\n        marker_line_color='black',\n        colorbar=dict(\n            title={'text': \"Crime Range\"},\n        )\n    )\n\n    layout = go.Layout(\n        title=\"{} \u2192 Crime Activity - {}\".format(year, crime),\n        geo=dict(\n            visible=False,\n            lonaxis={'range': [65, 100]},\n            lataxis={'range': [5, 40]}\n        ),\n        margin=dict(l=0, b=0, t=30, r=0),\n        height=600,\n        width=600\n    )\n\n    fig = go.Figure(data=[trace], layout=layout)\n    fig.show()\n    \n    return None","ac8b0117":"plot_state_wise(data_source=data_splits, year=2001, crime='dowry_deaths')","7b947d48":"plot_state_wise(data_source=data_splits, year=2014, crime='dowry_deaths')","06f65916":"#### State wise","7702b862":"### `print()` all shapes","38633fe8":"#### State wise","c113a9dc":"### Conclusion","1d245eb8":"### Overall increase in crime activity from lowest year to highest year","ba967553":"#### State wise","715e0c1d":"### Split data by year wise","a6fda5f2":"### Plotting the crimes that happened on a specific year","e862ea41":"#### State wise","70b0bba8":"* Crimes against women is increasing no matter what the measures are taken.\n* As there is increase in the years, there has to be decrease in the crime activity. But it is quite opposite.\n* Moreover, this dataset includes the activity that had taken place till 2014, we do not know how many more happend till this date.\n* The same case can be found if we take a particular state of the country.","b8d49ed2":"#### State wise","6663aa10":"#### Country wise","db86a03c":"#### Country wise","9aadb3b6":"#### Country wise","119d6d51":"### Data Preparation","81cb06a0":"### Plot single crime overall increase or decrease considering all years","b5fb3f0c":"#### Country wise","f381cd4b":"#### Country wise","b6d9c2eb":"### Geographical plot - crime activity state wise","3cb41f84":"### Yearly wise plot that shows increase in the crimes","fd4ca71b":"### Plot by state and year with a specific crime as target","7614ca7d":"#### Country wise","5336557a":"#### Country wise","46543a47":"### Plot the comparison by year and state with a specific crime as target","0f739462":"#### State wise","a57799e2":"### Get plotting features","73ff1fe0":"### Total crimes across all states of India - year wise"}}