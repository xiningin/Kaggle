{"cell_type":{"399c9204":"code","b1432824":"code","0ccafd3c":"code","1ef43791":"code","de97639d":"code","8d1ceb4e":"code","8c1e475b":"code","be9849e1":"code","c45d0d1d":"code","22e5c55b":"code","765128b4":"code","e1536e2c":"code","4ef19d45":"code","2f5e9374":"code","5f1f47dc":"code","806510ab":"code","82f45a2b":"code","5231c1df":"code","ed7bd535":"code","5e8ae29f":"code","3741b66c":"code","c786dde7":"code","f817e885":"code","c1ddd928":"code","138d6f9b":"code","8f3eadfd":"code","eb2d46c1":"code","44e3990b":"code","c70cecd6":"code","c48e8063":"code","cd4bd5c0":"code","346e9931":"code","79d2332f":"code","89aab454":"code","318b6810":"code","27f5a0c2":"code","47e38743":"code","96996f93":"markdown","b213f480":"markdown","37dd78c5":"markdown","786948e7":"markdown","76420ab0":"markdown","fbece127":"markdown","00b9300b":"markdown","12bf1bbb":"markdown","dee4fc5a":"markdown","1b7e4e4f":"markdown","98817c17":"markdown","a6f5342b":"markdown","0a4db788":"markdown","604d78da":"markdown","55a1bff8":"markdown","bc44ac15":"markdown","14be0659":"markdown","b86bbe07":"markdown","f6fbf5b1":"markdown","7c180f4a":"markdown","2b1f2f76":"markdown","f851b8fb":"markdown","ba04889d":"markdown","8839a5c3":"markdown","df29321a":"markdown","e2a0584f":"markdown","fde626b3":"markdown","91038075":"markdown","57f80e50":"markdown","0c3a0e6f":"markdown","fea0b0b8":"markdown","8d680038":"markdown","fe7123ba":"markdown","c43bd9c5":"markdown","8bd28171":"markdown","ea80e243":"markdown","91c64fae":"markdown","6e4cf030":"markdown","eb960899":"markdown","2134cd54":"markdown","e3be91b6":"markdown","309d96db":"markdown","6c3ee6c2":"markdown","5c4684fa":"markdown","d5573908":"markdown","c9bdbbe3":"markdown","70dcf694":"markdown","1060edf3":"markdown","a7bd86fa":"markdown","adf12b10":"markdown"},"source":{"399c9204":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport matplotlib.style as style\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.preprocessing import PolynomialFeatures\nfrom sklearn.model_selection import train_test_split \nfrom sklearn import preprocessing\nfrom sklearn import metrics\nstyle.use('fivethirtyeight')","b1432824":"medical_DF = pd.read_csv(\"..\/input\/insurance\/insurance.csv\")","0ccafd3c":"medical_DF.head(10)","1ef43791":"medical_DF.shape","de97639d":"medical_DF.isnull().sum()","8d1ceb4e":"f, ax1 = plt.subplots(2, 2, figsize = (10,10))\nsns.countplot(data = medical_DF, x = \"sex\", ax = ax1[0,0])\nsns.countplot(data = medical_DF, x = \"children\", ax = ax1[0,1])\nsns.countplot(data = medical_DF, x = \"smoker\", ax = ax1[1,0])\nsns.countplot(data = medical_DF, x = \"region\", ax = ax1[1,1])\nplt.show()","8c1e475b":"f, ax2 = plt.subplots(2, 2, figsize = (12,10))\nsns.violinplot(data = medical_DF, x = \"age\", ax = ax2[0,0], color = '#d43131')\nsns.violinplot(data = medical_DF, x = \"bmi\", ax = ax2[0,1], color = '#3152d2')\nsns.violinplot(data = medical_DF, x = \"charges\", ax = ax2[1,0], color = '#bd7a17')\nf.delaxes(ax = ax2[1,1])\nplt.show()","be9849e1":"medical_DF[['age', 'bmi', 'charges']].describe()","c45d0d1d":"plt.figure(figsize = (10,5))\nsns.violinplot(data = medical_DF, x = \"charges\", y = \"sex\", hue = \"sex\")\nplt.show()","22e5c55b":"medical_DF.groupby(['sex']).describe()['charges']","765128b4":"plt.figure(figsize = (10,5))\nsns.violinplot(data = medical_DF, x = \"charges\", y = \"smoker\", hue = \"smoker\")\nplt.show()","e1536e2c":"medical_DF.groupby(['smoker']).describe()['charges']","4ef19d45":"plt.figure(figsize = (10,10))\nsns.violinplot(data = medical_DF, x = \"charges\", y = \"region\", hue = \"region\")\nplt.show()","2f5e9374":"medical_DF.groupby(['region']).describe()['charges']","5f1f47dc":"plt.figure(figsize = (10,10))\nsns.violinplot(data = medical_DF, x = \"charges\", y = \"children\", hue = \"children\")\nplt.show()","806510ab":"medical_DF.groupby(['children']).describe()['charges']","82f45a2b":"plt.figure(figsize = (6,6))\nsns.scatterplot(data = medical_DF, x = \"charges\", y = \"bmi\")\nplt.show()","5231c1df":"plt.figure(figsize = (6,6))\nsns.scatterplot(data = medical_DF, x = \"charges\", y = \"age\")\nplt.show()","ed7bd535":"med_corr = medical_DF.corr()\nplt.figure(figsize = (7,7))\nsns.heatmap(med_corr, annot = True, linewidths = 1.2, linecolor = 'white')\nplt.show()","5e8ae29f":"medical_DF_1 = medical_DF","3741b66c":"medical_DF_1 = pd.get_dummies(medical_DF, columns = ['region', 'children', 'sex'])\nmedical_DF_1.drop(columns = ['sex_female'], inplace = True)\nmedical_DF_1[\"smoker\"].replace({\"yes\": 1, \"no\": 0}, inplace=True)","c786dde7":"medical_DF_1.head(10)","f817e885":"med_corr = medical_DF_1.corr()\nplt.figure(figsize = (14,10))\nsns.heatmap(med_corr, annot = True, linewidths = 1.2, linecolor = 'white')\nplt.show()","c1ddd928":"def NormalizeData(data):\n    return (data - np.min(data)) \/ (np.max(data) - np.min(data))\n\nmedical_DF_1[\"age\"] = NormalizeData(medical_DF_1[\"age\"])\nmedical_DF_1[\"bmi\"] = NormalizeData(medical_DF_1[\"bmi\"])\n\nmedical_DF_1.head(10)","138d6f9b":"X = medical_DF_1.drop(columns=['charges'])\nY = medical_DF_1['charges']","8f3eadfd":"X_train, X_test, Y_train, Y_test = train_test_split(X, Y, test_size=0.2, random_state=42)","eb2d46c1":"med_reg = LinearRegression()\nmed_reg.fit(X_train, Y_train)","44e3990b":"med_pred = med_reg.predict(X_test)","c70cecd6":"med_pred_DF = pd.DataFrame({'Actual': Y_test, 'Predicted': med_pred})\nmed_pred_DF.head(20)","c48e8063":"metrics.r2_score(Y_test, med_pred)","cd4bd5c0":"print('Mean Absolute Error:', metrics.mean_absolute_error(Y_test, med_pred))  \nprint('Mean Squared Error:', metrics.mean_squared_error(Y_test, med_pred))  \nprint('Root Mean Squared Error:', np.sqrt(metrics.mean_squared_error(Y_test, med_pred)))","346e9931":"X_poly = PolynomialFeatures(degree = 2, include_bias = False).fit_transform(X)","79d2332f":"X_poly_train, X_poly_test, Y_train, Y_test = train_test_split(X_poly, Y, test_size=0.2, random_state=42)","89aab454":"med_poly_reg = LinearRegression().fit(X_poly_train, Y_train)","318b6810":"med_poly_pred = med_poly_reg.predict(X_poly_test)","27f5a0c2":"metrics.r2_score(Y_test, med_poly_pred)","47e38743":"print('Mean Absolute Error:', metrics.mean_absolute_error(Y_test, med_poly_pred))  \nprint('Mean Squared Error:', metrics.mean_squared_error(Y_test, med_poly_pred))  \nprint('Root Mean Squared Error:', np.sqrt(metrics.mean_squared_error(Y_test, med_poly_pred)))","96996f93":"The polynomial model explains 86.44% of the variation in the response variable.","b213f480":"# Checking for Missing Values","37dd78c5":"## Medical Charges vs BMI","786948e7":"# Dummy Variables","76420ab0":"# Predicting Medical Costs Using Regression","fbece127":"There are many categorical features in this dataset. To perform regression, I will convert them to dummy variables.","00b9300b":"There are no missing values in each column.","12bf1bbb":"Mean Absolute Error measures the absolute value of the errors between the actual values and the predicted values.\n\n<img src = \"https:\/\/miro.medium.com\/max\/1040\/1*tu6FSDz_FhQbR3UHQIaZNg.png\" width = 300px>\n\nMean Squared Error measures the average squared difference between the predicted values and the actual values.\n\n<img src = \"https:\/\/i.imgur.com\/vB3UAiH.jpg\" width = 300px>\n\nRoot Mean Squared Error measures the square root of the differences between predicted and actual values.\n\n<img src = \"https:\/\/secureservercdn.net\/160.153.137.16\/70j.58d.myftpupload.com\/wp-content\/uploads\/2019\/03\/rmse-2.png\" width = 300px>","dee4fc5a":"## Train and Test Split","1b7e4e4f":"## R-Squared Value","98817c17":"## Medical Charges vs Age","a6f5342b":"* Age: The average age is 39.2 years. The median age is 39 years. The lowest recorded is 18 and the highest is 64. There is a huge distribution of beneficiaries between the ages 20 and 30.\n* BMI: The average BMI is 30.66. The median BMI is 30.4. The lowest recorded BMI is 15.96 while the highest recorded BMI is 53.13.\n* Charges: The average medical cost is 13,270.42 US dollars. The median medical cost is 9382.03 dollars. The minimum medical cost is 1121.87 dollars. The maximum is 63,770.43 dollars.","0a4db788":"## Medical Charges in terms of Region","604d78da":"## Model","55a1bff8":"The median medical charges for females are slightly higher than males. However, the average medical costs for males are slightly higher. ","bc44ac15":"There are 1338 rows and 7 columns in this dataset.","14be0659":"## Medical Charges in terms of Sex","b86bbe07":"# Conclusion","f6fbf5b1":"## Train and Test Split","7c180f4a":"# Exploratory Data Analysis","2b1f2f76":"Polynomial regression is a special case of linear regression where we fit a polynomial equation on the data with a curvilinear relationship between the target variable and the independent variables. \n\nEquation for Linear Regression and Polynomial Linear Regression ([source of image](http:\/\/medium.com\/@subarna.lamsal1\/multiple-linear-regression-sklearn-and-statsmodels-798750747755)):\n\n<img src = \"https:\/\/miro.medium.com\/max\/2086\/1*XSBSL7LbDOvjXyi4wz-i_g.png\" width = 600px>","f851b8fb":"## Medical Charges in terms of Number of Children","ba04889d":"# Polynomial Regression","8839a5c3":"## R-Squared Value","df29321a":"# Correlation","e2a0584f":"PolynomialFeatures() generates a new feature matrix consisting of all polynomial combinations of the features with degree less than or equal to the specified degree (in this case, the degree is 2).","fde626b3":"There is a weak correlation between the medical charges and the BMI of the beneficiaries.","91038075":"R-squared value measures how well the values are predicted. The higher the R-squared value, the better the model fits the data.","57f80e50":"## Model","0c3a0e6f":"Normalization scales the data in such a way that the values range from 0 to 1.","fea0b0b8":"## Using the Model to Predict","8d680038":"## Medical Charges in terms of Smokers and Non-Smokers","fe7123ba":"The South-East region has the highest average medical costs while the South-West region has the lowest average medical costs. The North-East region has the highest median medical cost while the South-West region has the lowest median medical cost.","c43bd9c5":"## MAE, MSE and RMSE Values","8bd28171":"This model explains 78.26% of the variation in the response variable.","ea80e243":"There is a weak correlation between the medical charges and the age of the beneficiaries.","91c64fae":"## MAE, MSE and RMSE Values","6e4cf030":"# Linear Regression","eb960899":"## Using the Model to Predict","2134cd54":"# Normalization","e3be91b6":"The Polynomial Regression model yields better results, with lower error rates and better R-squared values.","309d96db":"As seen in the correlogram above, being a smoker has a high correlation to medical charges. Most of the features have weak correlations with each other.","6c3ee6c2":"## Importing Libraries","5c4684fa":"# Dataset","d5573908":"Beneficiaries with 4 children have the highest median medical charges while beneficiaries with 1 child have the lowest median medical charges. Beneficiaries with 5 children have the lowest average medical costs (which can be attributed to their small population) while beneficiaries with 3 children have the highest average medical bills.","c9bdbbe3":"The medical charges for smokers are significantly higher. The average medical cost for smokers is 32,050.23 dollars whereas the average cost for non-smokers is 8434.27 dollars. The minimum medical cost for a non-smoker is 1121.87 dollars while it is 12,829.46 for smokers. The highest cost incurred by a non-smoker is 36,910.61 dollars while the highest bill incurred by a smoker is 63,770.43 dollars.","70dcf694":"* **Sex**: The amount of males and females are almost equal. 50.5% of all beneficiaries are male.\n* **Children**: 42.9% of all insurance holders have no children. \n* **Smoker**: 79.5% of all beneficiaries are non-smokers.\n* **Region**: The distribution of regions are almost equal, with the South-East region having the most beneficiaries.","1060edf3":"## Actual vs Predicted Values","a7bd86fa":"None of the continuous features have strong correlations with each other.","adf12b10":"## Importing the Dataset"}}