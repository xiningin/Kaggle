{"cell_type":{"5815bd9b":"code","9fc8de27":"code","2d70515c":"code","1a9eb3ea":"code","e6ce308b":"code","896b0eb4":"code","dc2dc27b":"code","00bc88e3":"code","1fd38c8e":"code","dd86fb5f":"code","b265be99":"code","611727e5":"code","88d8559e":"code","455b734f":"code","4ffa3527":"code","d166dfa8":"code","94b34685":"code","ab41900b":"code","197815f0":"code","6ba88865":"code","dea93340":"code","c32c78c8":"code","287ef8bd":"code","eb117139":"code","ce55f427":"code","b5b154f4":"code","d2c05fc3":"code","e5f94bad":"markdown","f3b323d6":"markdown","9ab82b8e":"markdown","94aeb78e":"markdown","8b1f6d35":"markdown","30c867af":"markdown","4c953bd5":"markdown","8697ca73":"markdown","30f3900f":"markdown","6c763275":"markdown","5b7cc976":"markdown","5587980c":"markdown","6c4ae080":"markdown","9ea16ea2":"markdown","bc7d985b":"markdown","f43a41a7":"markdown","3ee5ca6f":"markdown"},"source":{"5815bd9b":"import pandas as pd\n\n\nitem_categories = pd.read_csv('..\/input\/competitive-data-science-predict-future-sales\/item_categories.csv')\nitems = pd.read_csv('..\/input\/competitive-data-science-predict-future-sales\/items.csv')\nsales_train = pd.read_csv('..\/input\/competitive-data-science-predict-future-sales\/sales_train.csv')\nshops = pd.read_csv('..\/input\/competitive-data-science-predict-future-sales\/shops.csv')\ntest = pd.read_csv('..\/input\/competitive-data-science-predict-future-sales\/test.csv')","9fc8de27":"type(sales_train['date'][0])","2d70515c":"from datetime import datetime\n  \ndef timestamp(x):\n    return datetime.strptime(x, \"%d.%m.%Y\")","1a9eb3ea":"sales_train['date'] = sales_train['date'].apply(timestamp)","e6ce308b":"type(sales_train['date'][0])","896b0eb4":"sales_train","dc2dc27b":"items.drop('item_name',1,inplace = True)\nitems","00bc88e3":"sales_train.sort_values(by = 'date', inplace = True)\nsales_train.reset_index(drop = True, inplace = True)\nsales_train","1fd38c8e":"sales_train = sales_train[['shop_id','item_id','date','date_block_num','item_price','item_cnt_day']]\nsales_train.reset_index(drop = True, inplace = True)\nsales_train","dd86fb5f":"dataset = sales_train.pivot_table(index = ['shop_id','item_id'],values = ['item_cnt_day'],columns = ['date_block_num'], fill_value= 0)\ndataset.reset_index(inplace = True)\ndataset","b265be99":"test","611727e5":"dataset = pd.merge(test, dataset, on = ['shop_id','item_id'], how = 'left')\ndataset","88d8559e":"dataset.fillna(0, inplace = True)\ndataset","455b734f":"dataset.drop(labels = ['shop_id','ID','item_id'],inplace = True,axis = 1)\ndataset","4ffa3527":"X_train = dataset.iloc[:,:-1]\ny_train = dataset.iloc[:,-1:]\nX_test = dataset.iloc[:,1:]\nprint(X_train.shape, y_train.shape, X_test.shape)","d166dfa8":"X_train","94b34685":"y_train","ab41900b":"X_test","197815f0":"from sklearn.linear_model import LinearRegression\n\nregression = LinearRegression()\n\nregression.fit(X_train, y_train)","6ba88865":"prediction = regression.predict(X_test)\nprediction","dea93340":"y_train.shape","c32c78c8":"from sklearn import linear_model\n\nclf = linear_model.Lasso(alpha=0.00001)\n\nclf.fit(X_train,y_train)\n\npredictions_train = clf.predict(X_train)\npredictions_train","287ef8bd":"clf.score(X_train, y_train)","eb117139":"predictions = clf.predict(X_test)\npredictions","ce55f427":"sample_submission = pd.read_csv('..\/input\/competitive-data-science-predict-future-sales\/sample_submission.csv')\n\nsample_submission['item_cnt_month'] = predictions\nsample_submission","b5b154f4":"sample_submission.to_csv('ss.csv',index = False)","d2c05fc3":"pd.read_csv('ss.csv')","e5f94bad":"date column - change string into timestamp","f3b323d6":"# Training the model","9ab82b8e":"reorganize columns","94aeb78e":"pivot table","8b1f6d35":"fill nan with 0","30c867af":"add item_category column","4c953bd5":"drop shop_id and item_id. Since ID corresponds to index we will drop it as well.","8697ca73":"train test split","30f3900f":"# Model","6c763275":"# Submission","5b7cc976":"# Feature engineering","5587980c":"sort by date","6c4ae080":"# Score","9ea16ea2":"merge with test data","bc7d985b":"# Import","f43a41a7":"# Final prediction","3ee5ca6f":"Time series needs same amount of independent varaibles to predict the model as the amount that model was trained on, that's why X_train columns are [0,32] and X_test are [1,33]"}}