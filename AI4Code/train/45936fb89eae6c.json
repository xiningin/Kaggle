{"cell_type":{"65aa8628":"code","8796e75f":"code","fc7e9658":"code","6dcd000e":"code","46fc6d86":"code","1e91f05a":"code","e2130c55":"code","8699acd1":"code","9f48723a":"code","9fee1743":"code","105110c4":"code","a3a03a67":"code","bb30123a":"code","b6eb92ff":"code","31416245":"code","ff916bbf":"code","c8c7018d":"code","9e04fda8":"code","e8bdf02c":"code","85cff809":"code","36b76ed3":"code","a062c2d2":"code","2052e104":"code","1036496b":"code","9f626515":"code","bcc085e7":"code","4cc8953e":"markdown","5dc3fbc7":"markdown","9b3923a8":"markdown","a49bc053":"markdown","f9adada4":"markdown","17444cde":"markdown","66e7a6d0":"markdown","ca2b01a0":"markdown","f3ad945d":"markdown","84094ee4":"markdown","cd0e1a4f":"markdown","868752fc":"markdown","f16bcf57":"markdown"},"source":{"65aa8628":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n# Press \"shift + Enter\" to run the cell in .ipynb file\n\nimport warnings\nwarnings.simplefilter(action='ignore') # stop warnings \nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","8796e75f":"firms = pd.read_csv(\"..\/input\/base_etablissement_par_tranche_effectif.csv\")\ngeography = pd.read_csv(\"..\/input\/name_geographic_information.csv\")\nsalary = pd.read_csv(\"..\/input\/net_salary_per_town_categories.csv\")\npopulation = pd.read_csv(\"..\/input\/population.csv\")","fc7e9658":"firms.head()","6dcd000e":"firms.info()","46fc6d86":"geography.head()","1e91f05a":"geography.info()","e2130c55":"salary.head()","8699acd1":"salary.info()","9f48723a":"population.head()","9fee1743":"population.info()","105110c4":"geography.drop_duplicates(subset=[\"code_insee\"], keep=\"first\", inplace=True)","a3a03a67":"firms[\"CODGEO\"] = firms[\"CODGEO\"].astype(str)\ngeography['code_insee'] = geography['code_insee'].astype(str)\nsalary[\"CODGEO\"] = salary[\"CODGEO\"].astype(str)\npopulation[\"CODGEO\"] = population[\"CODGEO\"].astype(str)\nmerge1 = firms.merge(geography,left_on= \"CODGEO\",right_on=\"code_insee\")\nmerge2 = merge1.merge(salary, on= \"CODGEO\")\nmerge3 = merge2.merge(population, on= \"CODGEO\")","bb30123a":"merge3.values.shape","b6eb92ff":"merge3.columns","31416245":"data = merge3.drop(columns=['LIBGEO_x', 'REG', 'DEP','EU_circo', 'code_r\u00e9gion', 'nom_r\u00e9gion', 'chef.lieu_r\u00e9gion',\n'num\u00e9ro_d\u00e9partement', 'nom_d\u00e9partement', 'pr\u00e9fecture','num\u00e9ro_circonscription','codes_postaux', 'code_insee',\n                            '\u00e9loignement', 'LIBGEO_y','NIVGEO','LIBGEO'])","ff916bbf":"data.columns","c8c7018d":"groupby_columns = list(data.columns[:-4])\ndata2 = data.reset_index().groupby(groupby_columns, as_index= False).sum()","9e04fda8":"data2 = data2.drop(columns = ['index', 'MOCO', 'AGEQ80_17','SEXE'])","e8bdf02c":"data2.columns","85cff809":"data2.head()","36b76ed3":"data2.values.shape","a062c2d2":"data2['Micro_firms'] = data2['E14TS1'] + data2['E14TS6']\ndata2['Small_firms'] = data2['E14TS10'] + data2['E14TS20']\ndata2['Medium_firms'] = data2['E14TS50'] + data2['E14TS100']\ndata2['Large_firms'] = data2['E14TS200'] + data2['E14TS500']\ndata2 = data2.drop(columns=['E14TS0ND', 'E14TS1', 'E14TS6', 'E14TS10','E14TS20', 'E14TS50', 'E14TS100', 'E14TS200', 'E14TS500','E14TS0ND'])\ndata2 = data2.rename(columns = {'E14TST':'total_firms','NB':'total_population','nom_commune':'Town'})","2052e104":"data2.columns","1036496b":"data2=data2.rename(columns = {'SNHM14':'mean_salary',\n                              'SNHMC14':'mean_executive_salary',\n                              'SNHMP14':'mean_middle_manager_salary',\n                              'SNHME14':'mean_employee_salary',\n                              'SNHMO14':'mean_worker_salary',\n                              'SNHMF14':'mean_female_salary',\n                              'SNHMFC14':'mean_female_executive_salary',\n                              'SNHMFP14':'mean_female_middle_manager_salary',\n                              'SNHMFE14':'mean_female_employee_salary',\n                              'SNHMFO14':'mean_female_worker_salary',\n                              'SNHMH14':'mean_male_salary',\n                              'SNHMHC14':'mean_male_executive_salary',\n                              'SNHMHP14':'mean_male_middle_manager_salary',\n                              'SNHMHE14':'mean_male_employee_salary',\n                              'SNHMHO14':'mean_male_worker_salary',\n                              'SNHM1814':'mean_young_age_salary',\n                              'SNHM2614':'mean_medium_age_salary',\n                              'SNHM5014':'mean_old_age_salary',\n                              'SNHMF1814':'mean_young_female_salary',\n                              'SNHMF2614':'mean_medium_female_salary',\n                              'SNHMF5014':'mean_old_female_salary',\n                              'SNHMH1814':'mean_young_male_salary',\n                              'SNHMH2614':'mean_medium_male_salary',\n                              'SNHMH5014':'mean_old_male_salary',\n                              })","9f626515":"data2.columns","bcc085e7":"data2.to_csv(\"Final_Data.csv\")","4cc8953e":"- Export cleaned data for further analysis.","5dc3fbc7":"1. base_etablissement_par_tranche_effectif : give information on the number of firms in every french town, categorized by size , come from INSEE.\n2. name_geographic_information : give geographic data on french town (mainly latitude and longitude, but also region \/ department codes and names )\n3. net_salary_per_town_per_category : salaries around french town per job categories, age and sex.(can be merged by : CODGEO = code_insee)\n4. population : demographic information in France per town, age, sex and living mode.","9b3923a8":"# 2.Data Preparation\n1. Import Data\n2. Overview Data\n3. Merge Data\n4. Feature Engineering","a49bc053":"- Drop the columns that will not be used in our analysis.","f9adada4":"### Merge Data\nSince the \"CODGEO\" is common identifier between 4 Dataframes we have, we could merge them together by it.","17444cde":"### Overview Data","66e7a6d0":"- Base on the criteria for defining the company size from European Commission, we create new columns to represent the scale of firms base on employee numbers. ","ca2b01a0":"### Import Data\nFirst, import csv files from firms, geography, salary, population four dementions.","f3ad945d":"#  1.Backgroud Introduction\n\n- Our dataset was created (and actualized) by INSEE. It collects and publishes information about the French economy and people and carries out the periodic national census. \nFour files are in the dataset :","84094ee4":"- The salary can be divided into 3 dimentions: Sex, Age, Job_Category. Rename the columns to make our data looks more clear to analyze.","cd0e1a4f":"- For geography data, drop the duplicated insee data.","868752fc":"### Feature Engineering","f16bcf57":"- Because the data format in the population table is splite into specific format in terms of ['MOCO', 'AGEQ80_17', 'SEXE', 'NB'] those four columns. So, we need to reformatting the merged data we have to get population information for each region."}}