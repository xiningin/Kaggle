{"cell_type":{"601e8f64":"code","b2ae8d90":"code","310c2eed":"code","98b563b9":"code","aa32e883":"code","6f059099":"code","d7de6d6d":"code","b3f4fd9f":"code","7fc579d2":"code","d0a41ad2":"code","621d0b41":"code","1b275802":"markdown","86d249ff":"markdown","8f0e2fd3":"markdown"},"source":{"601e8f64":"# Ensure consistency across runs\nfrom numpy.random import seed\nimport random\nseed(2)\nimport tensorflow as tf\ntf.random.set_seed(2)\n\n# Imports to view data\nimport cv2\nfrom glob import glob\n\n# Visualization\nfrom matplotlib import pyplot as plt\nimport seaborn as sns\nsns.set()\n\n# Utils\nfrom pathlib import Path\nimport pandas as pd\nimport numpy as np","b2ae8d90":"# Set global variables\nTRAIN_DIR = '..\/input\/shopee-product-detection-open\/train\/train\/train'\nTEST_DIR = '..\/input\/shopee-product-detection-open\/test\/test\/test'\nCLASSES = [folder[len(TRAIN_DIR) + 1:] for folder in glob(TRAIN_DIR + '\/*')]\nCLASSES.sort()\n\nTARGET_SIZE = (64, 64)\nTARGET_DIMS = (64, 64, 3) # add channel for RGB\nN_CLASSES = 42\nVALIDATION_SPLIT = 0.1\nBATCH_SIZE = 64","310c2eed":"def plot_one_sample_of_each(base_path):\n    cols = 5\n    rows = int(np.ceil(len(CLASSES) \/ cols))\n    fig = plt.figure(figsize=(16, 20))\n    \n    for i in range(len(CLASSES)):\n        cls = CLASSES[i]\n        img_path = base_path + '\/' + cls + '\/**'\n        path_contents = glob(img_path)\n    \n        imgs = random.sample(path_contents, 1)\n\n        sp = plt.subplot(rows, cols, i + 1)\n        plt.imshow(cv2.imread(imgs[0]))\n        plt.title(cls)\n        sp.axis('off')\n\n    plt.show()\n    return","98b563b9":"plot_one_sample_of_each(TRAIN_DIR)","aa32e883":"train_csv = pd.read_csv(\"..\/input\/shopee-product-detection-open\/train.csv\")\ntest_csv = pd.read_csv(\"..\/input\/shopee-product-detection-open\/test.csv\")","6f059099":"train_csv","d7de6d6d":"each_category = train_csv.category.value_counts().sort_index()\neach_category","b3f4fd9f":"train_csv.count()","7fc579d2":"each_category.plot(kind=\"bar\", figsize = (20,5));","d0a41ad2":"test_csv","621d0b41":"test_csv[\"category\"].value_counts()","1b275802":"# Train","86d249ff":"# EDA TRAIN CSV","8f0e2fd3":"# TEST CSV"}}