{"cell_type":{"490e4f5b":"code","359a9671":"code","de49ec71":"code","8f3795fc":"code","ade4a855":"code","a86b20c1":"code","5b40980c":"code","8b0e8f3a":"code","b5d6cb41":"code","847d86d0":"code","9ce2432d":"code","fec1e7d8":"code","f24eb201":"code","1ad49bb5":"code","976ead86":"code","0b3e8cf2":"markdown","faa8fe6b":"markdown","da45d2ae":"markdown","55848977":"markdown"},"source":{"490e4f5b":"# Basics\nimport pandas as pd\nimport numpy as np\n\n# Visualization\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\n# Preprocessing\nimport missingno as msno\nfrom sklearn.preprocessing import StandardScaler, MinMaxScaler, binarize\n\n# Model Selection\nfrom sklearn.model_selection import train_test_split, cross_val_score, KFold, GridSearchCV\n\n# Models\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.discriminant_analysis import LinearDiscriminantAnalysis\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.svm import SVC\nfrom sklearn.ensemble import RandomForestClassifier, AdaBoostClassifier, GradientBoostingClassifier, ExtraTreesClassifier\n\n# Metrics\nfrom sklearn.metrics import confusion_matrix, classification_report, roc_auc_score, roc_curve, accuracy_score\n\n# Feature Selection\nfrom sklearn.feature_selection import SelectKBest, chi2\n\n# Warnings\nimport warnings as ws\nws.filterwarnings('ignore')","359a9671":"# Load Dataset\ndata = pd.read_csv(\"\/kaggle\/input\/bank-note-authentication-uci-data\/BankNote_Authentication.csv\")\ndata.head()","de49ec71":"# Summary\ndef summary(data):\n    df = {\n     'Count' : data.shape[0],\n     'NA values' : data.isna().sum(),\n     '% NA' : round((data.isna().sum()\/data.shape[0]) * 100, 2),\n     'Unique' : data.nunique(),\n     'Dtype' : data.dtypes,\n     'min' : round(data.min(),2),\n     '25%' : round(data.quantile(.25),2),\n     '50%' : round(data.quantile(.50),2),\n     'mean' : round(data.mean(),2),\n     '75%' : round(data.quantile(.75),2),   \n     'max' : round(data.max(),2)\n    } \n    return(pd.DataFrame(df))\n\nprint('Shape is :', data.shape)\nsummary(data)","8f3795fc":"data.hist(figsize = (10,10))\nplt.show()","ade4a855":"col_names = data.drop('class', axis = 1).columns.tolist()\n\nplt.figure(figsize = (10,3))\ni = 0\nfor col in col_names:\n    plt.subplot(1,4,i+1)\n    plt.grid(True, alpha =0.5)\n    sns.kdeplot(data[col][data['class'] ==0], label = 'Fake note')\n    sns.kdeplot(data[col][data['class'] ==1], label = 'Original note')\n    plt.title('Class vs ' + col)\n    plt.tight_layout()\n    i+=1\nplt.show()","a86b20c1":"X = data.drop('class', axis = 1)\nY = data['class']\n\nx_train, x_test, y_train, y_test = train_test_split(X, Y, test_size = 0.3, random_state = 7)","5b40980c":"# Model\nmodels = []\nmodels.append(('LR', LogisticRegression()))\nmodels.append(('LDA', LinearDiscriminantAnalysis()))\nmodels.append(('CART', DecisionTreeClassifier()))\nmodels.append(('KNN', KNeighborsClassifier()))\nmodels.append(('SVM', SVC()))\nmodels.append(('RF', RandomForestClassifier()))\nmodels.append(('ADA', AdaBoostClassifier()))\nmodels.append(('GB', GradientBoostingClassifier()))","8b0e8f3a":" def model_selection(x_train, y_train):\n    acc_result = []\n    auc_result = []\n    names = []\n\n    col = ['Model', 'ROC AUC Mean','ROC AUC Std','ACC Mean', 'ACC Std']\n    result = pd.DataFrame(columns = col)\n\n    i=0\n    for name, model in models:\n        kfold = KFold(n_splits = 10, random_state = 7)\n        cv_acc_result  = cross_val_score(model, x_train, y_train, cv = kfold, scoring = 'accuracy')\n        cv_auc_result  = cross_val_score(model, x_train, y_train, cv = kfold, scoring = 'roc_auc')\n\n        acc_result.append(cv_acc_result)\n        auc_result.append(cv_auc_result)\n        names.append(name)\n\n        result.loc[i] = [name, \n                         cv_auc_result.mean(), \n                         cv_auc_result.std(),\n                         cv_acc_result.mean(),\n                         cv_acc_result.std()]\n\n        result = result.sort_values('ROC AUC Mean', ascending = False)\n        i+= 1\n\n    plt.figure(figsize = (10,5))\n    plt.subplot(1,2,1)\n    sns.boxplot(x = names, y = auc_result)\n    plt.title('ROC AUC Score')\n\n    plt.subplot(1,2,2)\n    sns.boxplot(x = names, y = acc_result)\n    plt.title('Accuracy Score')\n    plt.show()\n\n    return(result)","b5d6cb41":"model_selection(x_train, y_train)","847d86d0":"def model_validation(model,x_test,y_test,thr = 0.5) :\n    \n    y_pred_prob = model.predict_proba(x_test)[:,1]\n    y_pred = binarize(y_pred_prob.reshape(1,-1), thr)[0]\n    \n    cnf_matrix = confusion_matrix(y_test, y_pred)\n    plt.figure(figsize = (10,3))\n    plt.subplot(1,2,1)\n    sns.heatmap(cnf_matrix, annot = True, fmt = 'g')\n    plt.title('Confusion Matrix')\n    plt.xlabel('Predicted label')\n    plt.ylabel('Actual label')\n\n    fpr, tpr, threshold = roc_curve(y_test, y_pred_prob)\n    plt.subplot(1,2,2)\n    sns.lineplot(fpr, tpr)\n    plt.plot([0,1],[0,1], 'r--')\n    plt.xlabel('False Positive Rate')\n    plt.ylabel('True Positive Rate')\n    plt.title('ROC Curve')\n    plt.show()\n\n    \n    print('Classification Report :')\n    print('===' * 20)\n    print(classification_report(y_test, y_pred))\n\n    score = tpr - fpr\n    opt_threshold = sorted(zip(score,threshold))[-1][1]\n    print('='*20)\n    print('Area Under Curve', roc_auc_score(y_test,y_pred))\n    print('Accuracy', accuracy_score(y_test,y_pred))\n    print('Optimal Threshold : ',opt_threshold)\n    print('='*20)","9ce2432d":"KNeighborsClassifier()","fec1e7d8":"param_grid = {\n    'leaf_size' : [2,5,7,9,11],\n    'n_neighbors' : [2,5,7,9,11],\n    'p' : [1,2]    \n}\n\ngrid = GridSearchCV(KNeighborsClassifier(), param_grid = param_grid)\ngrid.fit(x_train, y_train)","f24eb201":"grid.best_params_","1ad49bb5":"final_model = grid.best_estimator_","976ead86":"model_validation(final_model, x_test, y_test)","0b3e8cf2":"## Import Libraries","faa8fe6b":"### Split Dataset","da45d2ae":"#### KNN perform well for this dataset ","55848977":"There is no missing value in this dataset"}}