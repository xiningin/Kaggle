{"cell_type":{"1c411a42":"code","ee6fac13":"code","53e0f947":"code","73d6e5e9":"code","1853e480":"code","241a8b0e":"code","94d342ff":"code","ad576e31":"code","28494ffe":"code","22995979":"code","0f6adc84":"code","44a390cd":"code","7072d04c":"code","b2829d08":"code","e5f3939c":"code","4da573a6":"code","578f606c":"code","4887fa5e":"code","a299e1bd":"code","90a0f62a":"code","7c4a8077":"code","6cc58b71":"code","8e231d46":"code","fe007816":"code","7d63263e":"code","4bfd39db":"markdown","301b91dd":"markdown","10a2dc57":"markdown","b73cf969":"markdown","f1aa6d0e":"markdown","ca90de5f":"markdown","bc1e8e63":"markdown","4eff547c":"markdown","5ba2b553":"markdown","34c05d77":"markdown","028291b8":"markdown","f87ad645":"markdown","24fd3fe0":"markdown","440645f6":"markdown","54844c28":"markdown","212416b3":"markdown","5dce9ba7":"markdown","593706af":"markdown","3674cc0d":"markdown","dd2bd60c":"markdown","5ec6c49a":"markdown","1f0e6825":"markdown","cf9982ab":"markdown","96942ece":"markdown","520b744d":"markdown","827f2897":"markdown","5fac2c28":"markdown","1272b817":"markdown","3e25ee05":"markdown","44d8e30f":"markdown","d7d36517":"markdown","22f03b11":"markdown"},"source":{"1c411a42":"from IPython.display import HTML, IFrame\n\nHTML('<iframe width=\"400\" height=\"200\" src=\"https:\/\/pbskids.org\/apps\/media\/video\/Seesaw_v6_subtitled_ccmix.mp4\" frameborder=\"0\" allow=\"accelerometer; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen><\/iframe>')","ee6fac13":"import gc\nimport os\nfrom pathlib import Path\nimport random\nimport sys\n\nfrom tqdm import tqdm_notebook as tqdm\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nfrom IPython.core.display import display, HTML\n\n# --- plotly ---\nfrom plotly import tools, subplots\nimport plotly.offline as py\npy.init_notebook_mode(connected=True)\nimport plotly.graph_objs as go\nimport plotly.express as px\nimport plotly.figure_factory as ff\n\n# --- models ---\nfrom sklearn import preprocessing\nfrom sklearn.model_selection import KFold\nimport lightgbm as lgb\nimport xgboost as xgb\nimport catboost as cb","53e0f947":"# Input data files are available in the \"..\/input\/\" directory.\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","73d6e5e9":"%%time\ndatadir = Path('\/kaggle\/input\/data-science-bowl-2019')\n\n# Read in the data CSV files\ntrain = pd.read_csv(datadir\/'train.csv')\ntrain_labels = pd.read_csv(datadir\/'train_labels.csv')\ntest = pd.read_csv(datadir\/'test.csv')\nspecs = pd.read_csv(datadir\/'specs.csv')\nss = pd.read_csv(datadir\/'sample_submission.csv')","1853e480":"train[\"timestamp\"] = pd.to_datetime(train[\"timestamp\"])\ntest[\"timestamp\"] = pd.to_datetime(test[\"timestamp\"])","241a8b0e":"print(f'train.shape        : {train.shape}')\nprint(f'train_labels.shape : {train_labels.shape}')\nprint(f'test.shape         : {test.shape}')\nprint(f'specs.shape        : {specs.shape}')\nprint(f'ss.shape           : {ss.shape}')      ","94d342ff":"train.head()","ad576e31":"train_labels.head()","28494ffe":"train_labels['accuracy_group'].value_counts().sort_index().plot(kind=\"bar\", title='accuracy group counts')","22995979":"ss.head()","0f6adc84":"test.installation_id.nunique()","44a390cd":"#101999d8\n# f47ef997\n\ntest_tmp = test[test['installation_id'] == '101999d8']","7072d04c":"test_tmp","b2829d08":"ax = sns.distplot(test['installation_id'].value_counts().values)\nax.set_title('Number of event ids for each installation id')","e5f3939c":"train_labels[train_labels.installation_id == '0006a69f']","4da573a6":"tmp_train = train[train.installation_id == '0006a69f']\ntmp_train","578f606c":"tmp_train[tmp_train['event_code'].isin([4100, 4110]) & (tmp_train['type'] == 'Assessment')]","4887fa5e":"g = sns.FacetGrid(train_labels, col=\"title\")\ng = g.map(plt.hist, \"accuracy_group\")\n\n# sns.distplot(train_labels, x='accuracy_group', hue='title')","a299e1bd":"train_labels['title'].value_counts().plot(kind=\"bar\")","90a0f62a":"print('{} users solved {} Assessments in train_labels'\n      .format(train_labels['installation_id'].nunique(), len(train_labels)))","7c4a8077":"sns.distplot(train_labels['installation_id'].value_counts().values)","6cc58b71":"target_id = '0006a69f'\n\npx.scatter(train[train['installation_id'] == target_id], x='timestamp', y='event_code')","8e231d46":"train.groupby(['title', 'type']).size().reset_index().rename(columns={0: 'count'}).sort_values('type')","fe007816":"specs.head()","7d63263e":"specs.loc[0, 'args']","4bfd39db":"Train data consists of 11M rows, while test data hasa 1M rows.\n\ntrain labels has 17K rows, which means the task is not to predict the value each row, as we will see later.","301b91dd":"All Assessment are solved comparable times.","10a2dc57":"# Specs\n\nFrom [data description](https:\/\/www.kaggle.com\/c\/data-science-bowl-2019\/data),\n\n> This file gives the specification of the various event types.\n - event_id - Global unique identifier for the event type. Joins to event_id column in events table.\n - info - Description of the event.\n - args - JSON formatted string of event arguments. Each argument contains:\n    - name - Argument name.\n    - type - Type of the argument (string, int, number, object, array).\n    - info - Description of the argument.","b73cf969":"Now the size is reduced and we can see all the rows.\n\nAs we can see, for each game_session:\n\n - `901acc108f55a5a1`: Tried \"Mushroom Sorter (Assessment)\", correct with 1 try\n - `77b8ee947eb84b4e`: Tried \"Bird Measurer (Assessment)\", incorrect 11 times\n - `6bdf9623adc94d89`: Tried \"Mushroom Sorter (Assessment)\", correct with 1 try\n - `9501794defd84e4d`: Tried \"Mushroom Sorter (Assessment)\", incorrect 1 time and correct\n - `a9ef3ecb3d1acc6a`: Tried \"Bird Measurer (Assessment)\", incorrect 1 time and correct\n \nThis is consistent with the `train_labels` we saw above!","f1aa6d0e":"<a id=\"id3\"><\/a>\n# Data visualization\n\nNow let's proceed with some data visualization to understand data more deeply.","ca90de5f":"Same `installation_id` continues, which means same user try to play \"Welcome to Loast lagoon!\" -> \"Magma Peak - Level 1\" -> \"Sandcastle Builder (Activity)\".\n\nThese game are separated by `game_session`, even in same game there are many events happing which is described by `event_id`.","bc1e8e63":"## Users usage in time\n\nCode inspired from this [great kernel](https:\/\/www.kaggle.com\/robikscube\/2019-data-science-bowl-an-introduction), \nbut I modified `timestamp` column to be datetime to show it in proper time scale. Also used `plotly` for interactive visualization.\n\nThis user played Aug 6 6am and 5pm and Aug 9 6pm and Aug 29 4pm.","4eff547c":"It seems many assesements are solved without incorrect trial, yay! :)","5ba2b553":"<a id=\"id1\"><\/a>\n## PBS KIDS Measure UP!\n\nCite from official website [PBS KIDS Measure Up!](https:\/\/pbskids.org\/apps\/pbs-kids-measure-up.html):\n\nchildren ages 3 to 5 learn early math concepts focused on length, width, capacity, and weight while going on an adventure through Treetop City, Magma Peak, and Crystal Caves.\n\n### Specific features of Measure Up! include:\n\n - 19 unique measuring games.\n - 10 measurement-focused video clips.\n - Sticker books featuring favorite PBS KIDS characters.\n - Rewards for completion of tasks.\n - Embedded challenges and reports to help parents and caregivers monitor kids\u2019 progress.\n - Ability to track your child's progress using the PBS KIDS Super Vision companion app. (Read more about Super Vision below.)\n\n","34c05d77":"How many users are in `train_labels` and how many Assessments are solved by each user?\n\nMany people solved ~10 Assessments, but some user solved 160 Assessments!","028291b8":"I get confused when I compare `train_labels` and `sample_submission` at first time.<br>\n`train_labels` contains many `accuracy_group` in one `installation_id` but `sample_submission` assumes only one `accuracy_group` is assigned for each `installtion_id`. \n\nWhy?\n\nIt can be understood by carefully looking test data. <br>\nAs a conclusion, you need to predict the `accuracy_group` of the last game play for each user (`installation_id`) in the test dataset.\nI will explain details following.","f87ad645":"# train_labels\n\n`accuracy_group` is the label that we want to predict in this competition, it is categorized as\n\n - 3: the assessment was solved on the first attempt\n - 2: the assessment was solved on the second attempt\n - 1: the assessment was solved after 3 or more attempts\n - 0: the assessment was never solved\n\nMore detailed information is given by `num_correct`, `num_incorrect` and `accuracy`.\n\n - When `num_correct` is 0, which means `accuracy_group` is 0.\n - When `num_correct` is 1 and `num_incorrect` is 0, which means `accuracy_group` is 3.\n - When `num_correct` is 1 and `num_incorrect` is 1, which means `accuracy_group` is 2.\n - When `num_correct` is 1 and `num_incorrect` is more than 1, which means `accuracy_group` is 1.","24fd3fe0":"# 2019 Data Science Bowl\n\nIn this competition, we will analyse usage event of \"PBS KIDS Measure Up!\" app.<br>\nThe goal is to predict how many times the user answers to get correct answer for \"Assesement\" (problem).<br>\nI will proceed with exploratory data analysis to understand this competition. Especially focusing on **how the labels are made**.\n\n\n# Table of Contents:\n\n**1. [PBS KIDS Measure UP!](#id1)** <br>\n**2. [Data description](#id2)** <br>\n**3. [Data Visualization](#id3)** <br>\n**4. [References](#ref)** <br>\n","440645f6":"Let's see this user's event.","54844c28":"<a id=\"id2\"><\/a>\n# Data description","212416b3":"Check all the event title and type.","5dce9ba7":"As you can see, user starts from the \"Welcome to Lost Lagoon!\" event and ends with **\"Chest Sorter (Assessment)\" at last**.\n\nIt seems all the test data's last row data of each `installation_id` is some `Assessment` event. We are going to predict this las Assessment's `accuracy_group`.<br>\nOf course, user may play different \"Assessment\" in the past, so Assessment event may be contained several times and you can understand this user could anwer or not in the past \"Assessment\".","593706af":"# train and test data\n\ntrain data and test data consists of event information.","3674cc0d":"Let's forcus on one user's total history in the test dataset.","dd2bd60c":"The event consists of 3801 rows, we cannot see all in detail... \n\nAs written in the [data description](https:\/\/www.kaggle.com\/c\/data-science-bowl-2019\/data):\n\n> Assessment attempts are captured in event_code 4100 for all assessments except for Bird Measurer, which uses event_code 4110. If the attempt was correct, it contains \"correct\":true.\n\nSo let's extract rows with `event_code` is 4100 or 4110. Also we are only intersted in \"Assessments\" type.","5ec6c49a":" <h3 style=\"color:red\">If this kernel helps you, please upvote to keep me motivated \ud83d\ude01<br>Thanks!<\/h3>","1f0e6825":"# sample_submission\n\n`sample_submission` shows the submission format. It seems we need to predict `accuracy_group` for each `installation_id`.","cf9982ab":"### Difficulty by each Assessment\n\nIt seems \"Mushroom Sorter\" and \"Cart Balancer\" are easy (many 3), and \"Chest Sorter\" is difficult (many 0s).","96942ece":"Again, let's focus on specific `installation_id, 0006a69f` for the data analysis.<br>\nThis user solved Assessment 5 times.","520b744d":"<a id=\"ref\"><\/a>\n# Reference\n\n - [A baseline for DSB 2019](https:\/\/www.kaggle.com\/mhviraf\/a-baseline-for-dsb-2019): This kernel explains me how to understand the relation ship between event data and labels\n \n - [\ud83d\udeb8 2019 Data Science Bowl - An Introduction](https:\/\/www.kaggle.com\/robikscube\/2019-data-science-bowl-an-introduction)","827f2897":"Be careful that data size is very big and it takes time (about 1min) to load the data.<br>\nWe may refer [How to Work with BIG Datasets on Kaggle Kernels (16G RAM)](https:\/\/www.kaggle.com\/yuliagm\/how-to-work-with-big-datasets-on-16g-ram-dask) by @yuliagm to load data efficiently.","5fac2c28":"Work in progress for checking below questions...\n\n - Understanding each Assessments difficulty.\n   - Each assessments has some \"stage\" or \"level\"??","1272b817":"Each `args` stores a lot of information, how to utilize these information is the feature engineering task left for you!","3e25ee05":"# Checking test data for each installation_id\n\n\nThe number of `installation_id` in the `test` dataset is 1000. This is same with the number of rows of `sample_submission`.","44d8e30f":"# Calculating labels from train\/test data\n\nNow we understand the meaning of input `train`, `test` data and true labels `train_labels` and submission format `sample_submission` for test.<br>\nBut how `train_labels` are calculated from `train` data? I will try writing a code to re-construct these labels.","d7d36517":"I chose an installation_id with very small history in the above example.<br>\nBut most of them contains thousands of events. Some user has 20000~ events.","22f03b11":"`accuracy_group` is determined by each assesement play.\n\nYou can see several `accuracy_group` exists in same `installation_id`.\n\nBecause when the same user (specified by `installation_id`) plays several games (specified by `game_session`), `accuracy_group` is calculated for each play.\n\nSame user can play same game several times as well. As you can see above, user `0006a69f` plays `Mushroom Sorter` more than 3 times."}}