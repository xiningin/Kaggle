{"cell_type":{"26e7e936":"code","d171d0ba":"code","2c7a1578":"code","5278a1c5":"code","41b6de7e":"code","5c0e7d7d":"code","d57d7220":"code","412c3424":"code","1f3eef90":"code","2ae6bc50":"code","4bf1bafc":"code","9e2d2e8b":"code","65593c2a":"code","aeb74eb5":"code","dc712876":"code","3024485e":"code","b6245561":"code","4bb28783":"code","59e76d02":"code","da095b4d":"code","2556f36c":"markdown","45fc00e8":"markdown","7dc57bb1":"markdown","3b432b2a":"markdown","14124979":"markdown","28eb2a75":"markdown","3be450bc":"markdown"},"source":{"26e7e936":"from sklearn.metrics import confusion_matrix, classification_report\nfrom fastai.tabular.all import *","d171d0ba":"path0='..\/input\/us-adult-salary\/adult_data.csv'\n\ndf=pd.read_csv(path0,header=None)\ndf.columns=['age', 'workclass', 'fnlwgt', 'education', 'education-num', \n            'marital-status', 'occupation', 'relationship', 'race', 'sex', \n            'capital-gain', 'capital-loss', 'hours-per-week', 'native-country', \n            'salary']\ndf","2c7a1578":"dls1 = TabularDataLoaders.from_df(df, path0, y_names=\"salary\",\n    cat_names = ['workclass', 'education', 'marital-status', 'occupation', 'relationship', 'race'],\n    cont_names = ['age', 'fnlwgt', 'education-num'],\n    procs = [Categorify, FillMissing, Normalize])\n\nprint(type(dls1))","5278a1c5":"dls1.show_batch()","41b6de7e":"learn1 = tabular_learner(dls1, metrics=accuracy)","5c0e7d7d":"learn1.fit_one_cycle(5)","d57d7220":"learn1.show_results()","412c3424":"splits = RandomSplitter(valid_pct=0.2)(range_of(df))","1f3eef90":"tp = TabularPandas(df, procs=[Categorify, FillMissing,Normalize],\n                   cat_names = ['workclass', 'education', 'marital-status', 'occupation', 'relationship', 'race'],\n                   cont_names = ['age', 'fnlwgt', 'education-num'],\n                   y_names='salary',\n                   splits=splits)","2ae6bc50":"tp.xs","4bf1bafc":"tp.ys","9e2d2e8b":"dls2 = tp.dataloaders(bs=64)\nprint(type(dls2))","65593c2a":"dls2.show_batch()","aeb74eb5":"learn2 = tabular_learner(dls2, metrics=accuracy)","dc712876":"learn2.fit_one_cycle(10)","3024485e":"learn2.show_results()","b6245561":"learn2.recorder.plot_sched()","4bb28783":"# in this case, test data is train data itself\ndl = learn2.dls.test_dl(tp.xs)\npred=learn2.get_preds(dl=dl)\npred2=pred[0].numpy()\npred2","59e76d02":"pred3=np.argmax(pred2,axis=1)\npred3","da095b4d":"from sklearn.metrics import confusion_matrix, classification_report\nans = np.array(tp.ys)\nprint(classification_report(ans,pred3))\nprint(confusion_matrix(ans,pred3))","2556f36c":"#### Now we can build our DataLoaders again:","45fc00e8":"# TabularDataLoaders.from_df","7dc57bb1":"# TabularPandas + DataLoaders","3b432b2a":"#### Predict using TablularPandas for test","14124979":"#### Define a model using the tabular_learner method. ","28eb2a75":"#### Once we build our TabularPandas object, our data is completely preprocessed as seen below:","3be450bc":"# Adult Salary fastai with TabularPandas\n### compared to TabularDataLoaders.from_df\ncf. https:\/\/docs.fast.ai\/tutorial.tabular.html"}}