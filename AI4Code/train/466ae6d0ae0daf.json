{"cell_type":{"f33aa6fb":"code","407e8029":"code","993b91de":"code","47ba787b":"code","ee978d1e":"code","5bec3482":"code","93ec478d":"code","447c709b":"code","c464cc2a":"code","e42aecb4":"code","a1216d38":"code","1469fc3b":"code","7632e3b7":"code","8715aff9":"code","e7d83697":"code","989508e1":"code","d40f1ab6":"code","ec74ce3b":"code","94bc23bb":"code","9b9759ba":"code","24167ec9":"code","c2976b23":"code","821973e9":"code","642bc01b":"code","0e8cd774":"code","b793a585":"code","7ae790dc":"code","b35e1a81":"code","e66eb806":"code","973b4352":"code","cd677d3a":"code","3230a8d1":"code","8be5a201":"code","5f5ff1ef":"code","da00a7ee":"code","c6f56e44":"code","df5b439a":"code","8f6a642e":"code","889542d2":"code","41dbc494":"code","d72ca3a6":"code","2e403d87":"code","c496b23b":"code","34b6c84f":"code","5eb779b6":"code","efd63177":"code","60b55c81":"code","26036021":"code","433567f1":"code","52d6b2eb":"code","2d474d11":"code","e9c0a456":"code","3a29b989":"code","9d8c6ea8":"code","8881dae8":"markdown","c6aa47c9":"markdown","fffb3333":"markdown","9b451bfd":"markdown","fa0f82c4":"markdown","2b30df25":"markdown","3fdd90ec":"markdown","06a1a891":"markdown","69dd8113":"markdown","d82b22e0":"markdown","3b498acc":"markdown","c6cd73f1":"markdown","aa626187":"markdown","12dd195b":"markdown"},"source":{"f33aa6fb":"\n\nimport numpy as np \nimport pandas as pd \n\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n","407e8029":"df = pd.read_csv('\/kaggle\/input\/insurance\/insurance.csv')","993b91de":"df.head()","47ba787b":"df.describe().transpose()","ee978d1e":"import matplotlib.pyplot as plt \nimport seaborn as sns\n%matplotlib inline","5bec3482":"sns.distplot(df['age'],bins=30)","93ec478d":"sns.jointplot(df['age'],df['charges'])","447c709b":"plt.figure(figsize=(14,8))\nsns.scatterplot(x=df['age'],y=df['charges'],hue=df['region'])","c464cc2a":"plt.figure(figsize=(14,8))\nsns.scatterplot(x=df['age'],y=df['charges'],hue=df['smoker'])","e42aecb4":"sns.countplot(df['children'])","a1216d38":"plt.figure(figsize=(14,8))\nsns.scatterplot(x=df['age'],y=df['charges'],hue=df['children'])","1469fc3b":"plt.figure(figsize=(14,8))\nsns.kdeplot(df['bmi'],shade=True)","7632e3b7":"from sklearn.preprocessing import MinMaxScaler\n\nscaler = MinMaxScaler()","8715aff9":"from sklearn.model_selection import train_test_split","e7d83697":"X = df[df.columns[:len(df.columns)-1]]\ny = df[df.columns[-1]]","989508e1":"def one_hot_encoder_1(x):\n    if x == 'yes':\n        return 1\n    else:\n        return 0","d40f1ab6":"def one_hot_encoder_2(x):\n    if x == 'male':\n        return 1\n    else:\n        return 0","ec74ce3b":"df['region'].unique()","94bc23bb":"X['smoker'] = X['smoker'].apply(one_hot_encoder_1)","9b9759ba":"X['sex'] = X['sex'].apply(one_hot_encoder_2)","24167ec9":"X.head()","c2976b23":"X=pd.concat([X,pd.get_dummies(X['region'],drop_first=True)],axis=1)","821973e9":"X = X.drop('region',axis=1)","642bc01b":"X.head()","0e8cd774":"X_train,X_test,y_train,y_test = train_test_split(X,y,test_size=0.25,random_state=101)","b793a585":"scaled_train = scaler.fit_transform(X_train)\nscaled_test = scaler.transform(X_test)","7ae790dc":"from sklearn.linear_model import LinearRegression\n\nlr_model = LinearRegression()","b35e1a81":"lr_model.fit(scaled_train,y_train)","e66eb806":"preds = lr_model.predict(scaled_test)","973b4352":"lr_model.coef_","cd677d3a":"lr_model.intercept_","3230a8d1":"from sklearn.metrics import mean_absolute_error, mean_squared_error, r2_score","8be5a201":"print(mean_squared_error(y_test,preds)**0.5)","5f5ff1ef":"print(mean_absolute_error(y_test,preds))","da00a7ee":"print(r2_score(y_test,preds))","c6f56e44":"from sklearn.preprocessing import PolynomialFeatures","df5b439a":"poly_transformer = PolynomialFeatures(3)","8f6a642e":"X_poly_train,X_poly_test,y_train,y_test = train_test_split(X,y,test_size=0.25,random_state=101)","889542d2":"X_poly_train = poly_transformer.fit_transform(X_poly_train)\nX_poly_test = poly_transformer.transform(X_poly_test)","41dbc494":"poly_model = LinearRegression()","d72ca3a6":"poly_model.fit(X_poly_train,y_train)","2e403d87":"pred = poly_model.predict(X_poly_test)","c496b23b":"poly_model.coef_","34b6c84f":"poly_model.intercept_","5eb779b6":"print(mean_squared_error(y_test,preds)**0.5)","efd63177":"print(mean_absolute_error(y_test,preds))","60b55c81":"print(r2_score(y_test,preds))","26036021":"from sklearn.ensemble import RandomForestRegressor","433567f1":"losses = []\ni_vals = []\nfor i in range(1,70):\n    decision_forest = RandomForestRegressor(n_estimators = i)\n    \n    decision_forest.fit(scaled_train,y_train)\n    \n    pred = decision_forest.predict(scaled_test)\n    \n    i_vals.append(i)\n    \n    losses.append(mean_squared_error(y_test,pred)**0.5)\n    \n    ","52d6b2eb":"plt.figure(figsize=(10,8))\nplt.plot(i_vals,losses)","2d474d11":"decision_forest = RandomForestRegressor(n_estimators = 50)\n\ndecision_forest.fit(scaled_train,y_train)\n\npred = decision_forest.predict(scaled_test)","e9c0a456":"print(mean_squared_error(y_test,pred)**0.5)","3a29b989":"print(mean_absolute_error(y_test,pred))","9d8c6ea8":"decision_forest.feature_importances_","8881dae8":"# building up the model and preprocessing of the data !","c6aa47c9":"**using the above line of code, you can see the related importance of the features ! hence i avoid further discussion you can explore which to include and which to avoided !**","fffb3333":"**how does linear regression work ?**\n\n* well if we have data having features ${x_{1}, x_{2} ......, x_{n}}$ ,we model it as a vector $ \\vec{x} = <x_{1},x_{2}....,x_{n}>$ , and fit the data into a hypothesis function $f(\\,\\vec{x}) = \\theta^{T}\\,. \\vec{x} +\\, b $ and then fine tune for the best fit ! ","9b451bfd":"**conclusion : the region column is of importance hence it cannot be ignored blatently !**","fa0f82c4":"# exploratory data analysis :","2b30df25":"# Using Polynomial Regression :","3fdd90ec":"*smokers seem to have higher charges for any age, hence it needs to be converted from a categorical to numerical variable(binary-encoding { 1: yes, 0: no})*","06a1a891":"*the distribution of the BMI in the population seems to be centred around 30, in a gaussian normal distribution, very few people are at the extreme sides !*","69dd8113":"# Using Random Forests :","d82b22e0":"# using linear regression :","3b498acc":"**how does polynomial regression work ?**\n* *it is very similar to the linear regression, we just aim to introduce higher degree interaction terms in the data set ! as you know sometimes the presence of two or more features simultaneously has a greater effect than them alone, hence adding interaction terms (of higher degrees, by default degree = 2) helps us fit better !*","c6cd73f1":"*if the family size is large, the chances of contracting an ailment increases, hence the expenditure rises, so we have to include the number of children as one of the factors !*","aa626187":"*seeing the data, it seems clear that age, number of children, BMI, smoker or not are closely linked with the insurance column so our aim is whether to or not one-hot-encode the region column ? it may be that people in some region of the state tend to fall ill due to poor conditions and facilities maybe ?*","12dd195b":"*proposed solution, we will try to use random forests also polynomial regression to study the data once with the region column and once without !*"}}