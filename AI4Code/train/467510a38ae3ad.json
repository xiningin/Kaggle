{"cell_type":{"120aed56":"code","98c915b6":"code","4f923434":"code","84fa360c":"code","011d9d80":"code","4d23dd45":"code","ec7fff7d":"code","74354a90":"code","8560f171":"code","0bd94745":"code","836d98ac":"code","0ac408c4":"code","d9a62ac8":"code","45dae8ba":"code","01ae8b65":"code","48bb229d":"code","84c33d62":"code","9d61644d":"code","599bdc70":"code","6f83adb9":"code","ddddb6dc":"code","f28c6370":"code","3fc7aec9":"markdown","950eee1f":"markdown","40f4d459":"markdown","34d6264a":"markdown","32d5efda":"markdown","c7cf2eb6":"markdown","0311130f":"markdown","e09e1a55":"markdown","debcfd32":"markdown","b87a8964":"markdown","5fd224fa":"markdown","eca570c4":"markdown","c9d0bc3a":"markdown","dcf21638":"markdown","54035675":"markdown","7d16988a":"markdown","b486f204":"markdown","3955bf38":"markdown"},"source":{"120aed56":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\ndf = pd.read_csv(\"https:\/\/raw.githubusercontent.com\/anilak1978\/customer_churn\/master\/Churn_Modeling.csv\")\ndf.head()","98c915b6":"# Looking for missing data\nmissing_data=df.isnull()\nfor column in missing_data.columns.values.tolist():\n    print(column)\n    print(missing_data[column].value_counts())\n    print(\"\")","4f923434":"# Looking at data types\ndf.dtypes","84fa360c":"# Looking at the basic information\ndf.info()","011d9d80":"# looking at the summary\ndf.describe()","4d23dd45":"# Looking at correlation between numerical variables\ndf.corr()","ec7fff7d":"# Visualizing relationship of Age and Estimated Salary\nplt.figure(figsize=(20,20))\nsns.relplot(x=\"Age\", y=\"EstimatedSalary\", hue=\"Geography\", data=df)\nplt.title(\"Age VS Estimated Salary\")\nplt.xlabel(\"Age\")\nplt.ylabel(\"Estimated Salary\")","74354a90":"# looking at age distribution\nplt.figure(figsize=(10,10))\nsns.distplot(df[\"Age\"])","8560f171":"# Looking at Gender Distribution\nplt.figure(figsize=(10,8))\nsns.countplot(x=\"Gender\", data=df)\nplt.title(\"Gender Distribution\")\nplt.xlabel(\"Gender\")\nplt.ylabel(\"Count\")","0bd94745":"# Looking at Geography and Gender Distribution against Estimated Salary\nplt.figure(figsize=(20,20))\nsns.catplot(x=\"Geography\", y=\"EstimatedSalary\", hue=\"Gender\", kind=\"box\", data=df)\nplt.title(\"Geography VS Estimated Salary\")\nplt.xlabel(\"Geography\")\nplt.ylabel(\"Estimated Salary\")","836d98ac":"# Looking at linear relationship between Age and CreditScore\nplt.figure(figsize=(10,10))\nsns.regplot(x=\"Age\", y=\"CreditScore\", data=df)","0ac408c4":"#looking at correlation between attributes in detail\ncorr=df.corr()\nplt.figure(figsize=(10,10))\nsns.heatmap(corr, annot=True)","d9a62ac8":"df.columns","45dae8ba":"# Selecting and Preparing the Feature Set and Target\nX = df[[\"CreditScore\", \"Geography\", \"Gender\", \"Age\", \"Tenure\", \"EstimatedSalary\"]].values\ny=df[[\"Exited\"]]\nX[0:5], y[0:5]","01ae8b65":"# preprocessing categorical variables\nfrom sklearn import preprocessing\ngeography=preprocessing.LabelEncoder()\ngeography.fit([\"France\", \"Spain\", \"Germany\"])\nX[:,1]=geography.transform(X[:,1])\n\ngender = preprocessing.LabelEncoder()\ngender.fit([\"Female\", \"Male\"])\nX[:,2]=gender.transform(X[:,2])\n\nX[0:5]","48bb229d":"# split train and test data\nfrom sklearn.model_selection import train_test_split\nX_trainset, X_testset, y_trainset, y_testset = train_test_split(X, y, test_size=0.2, random_state=3)","84c33d62":"# create model using DecisionTree Classifier and fit training data\nfrom sklearn.tree import DecisionTreeClassifier\ndt_model = DecisionTreeClassifier()\ndt_model.fit(X_trainset, y_trainset)","9d61644d":"# create prediction\ndt_pred = dt_model.predict(X_testset)\ndt_pred[0:5]","599bdc70":"# Evaluating the prediction model\nfrom sklearn import metrics\nmetrics.accuracy_score(y_testset, dt_pred)","6f83adb9":"# create Random Forest Decision Tree model\nfrom sklearn.ensemble import RandomForestClassifier\nrf_model = RandomForestClassifier(n_estimators=100)\nrf_model.fit(X_trainset, y_trainset.values.ravel())","ddddb6dc":"# create prediction using rf_model\nrf_pred = rf_model.predict(X_testset)\nrf_pred[0:5]","f28c6370":"# evaluate the model\nmetrics.accuracy_score(y_testset, rf_pred)","3fc7aec9":"The linear relationship is not very strong between Age and Credit Score. ","950eee1f":"All data types are as expected and doesnt require updating. ","40f4d459":"At this point, I created the prediction model by classification using Decision Tree Classifier, created prediction using feature test set and evaluated the model. The accuracy score is 0.732 out of maximum possible score of 1. I will further create another model using Random Forest to see if that gives me a better score.","34d6264a":"The Age distribution is normal and very vey lightly right skewed. Based on the Age VS Estimated Salary figure, we can see there are some outliers above the 80 years old mark.","32d5efda":"## Data Exploration","c7cf2eb6":"Overall, I dont see a significant correlation between two or more specific variables.","0311130f":"# Predicting Customer Churn\n\n## Introduction\n\nIn this analysis, I used an already available data from an imaginery bank in order to solve a very common problem. - Churn- The problem statement is straight forward, \"What type of customers' are ending their contracts with the bank?\". If the bank can predict the customers' that are leaving, organization can further use targeted marketing techniques in order to keep these individuals as customers. This is a well known practice in marketing, as it is much easier and cost effective to keep existing customers rather than acquiring new ones. ","e09e1a55":"There are no missing data in our dataset. ","debcfd32":"The estimated salary distribution for all 3 regions are similar and ballpark around 100K. Interesting fact to note is that females expected salary is more than the males in Germany.","b87a8964":"There are more male customers than female customers however the difference is not significant.","5fd224fa":"The average estimated salary is around100K with around 58K standard deviation. Average age of the customers is 39 with standard deviation of 10. Minimum age is 18 and maximum is 92. ","eca570c4":"## About the Data\n\nThe data is not from an existing bank and it is imaginery. This is a very common dataset used in institutations for educational purposes such as Standford or CUNY SPS. The data set provides below variables for each customer (observation).\n\n*RowNumber : Row Numbers*\n\n*CustomerID: Unique Ids for bank customer identification*\n\n*Surname: Customer's last name*\n\n*CreditScore: Credit score of the customer*\n\n*Geography: The country from which the customer belongs*\n\n*Gender: Male or Female*\n\n*Age: Age of the customer*\n\n*Tenure: Number of years for which the customer has been with the bank*\n\n*Balance: Bank balance of the customer*\n\n*NumOfProductsNumber of bank products the customer is utilising*\n\n*HasCrCardBinary Flag for whether the customer holds a credit card with the bank or not*\n\n*IsActiveMemberBinary Flag for whether the customer is an active member with the bank or not*\n\n*EstimatedSalaryEstimated salary of the customer in Dollars*\n\n*ExitedBinary flag 1 if the customer closed account with bank and 0 if the customer is retained*\n","c9d0bc3a":"## Conclusion\n\nBy looking at customers Credit Score, where they are from, gender, age, estimated salary and how many they have been a customer, we can predict if they will continue their contract or leave for another bank. Our prediction using Random Forest Classifier will give 81 % prediction accuracy. I can create additional data requirements, collect them from various sources and analyze further in order to come up with a marketing approach to keep the customers that is predicted to leave the bank.","dcf21638":"## Model Development and Evaluation\n\nBased on my data exploration, I decided to create a classification model using Decision Trees. I will create two models, one with using Decision Tree Classifier and another one using Random Forest Classifier. ","54035675":"Using Random Forest gave me a slightly better accuracy score.","7d16988a":"## Data Collection and Preperation","b486f204":"From an overivew, there isnt a significant correlation between two variables.","3955bf38":"There are 1000 customers and 14 attributes for each customer. "}}