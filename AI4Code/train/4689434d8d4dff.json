{"cell_type":{"05835913":"code","6e96d15f":"code","29020706":"code","8f72fdce":"code","6c3935e2":"code","fe126d47":"code","f7d7d202":"markdown","d4809ad0":"markdown","69818e37":"markdown"},"source":{"05835913":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom mlxtend.frequent_patterns import apriori,association_rules\n\nimport warnings\nwarnings.filterwarnings('ignore')\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","6e96d15f":"df=pd.read_csv('..\/input\/market-basket-optimization\/Market_Basket_Optimisation.csv', header=None)\n\nitemlist=[]\nfor i in range(0, df.shape[0]):\n    itemlist.extend(df.iloc[i,:].values)\nitemlist=set(itemlist)\nitem_dict={'item':list(itemlist)}\n\ntrans_df=pd.DataFrame(item_dict)\ntrans_df=trans_df.iloc[1:,:].reset_index()\n\nfor i in range(0,df.shape[0]):\n    trans_df[i]=trans_df.item.apply(lambda x: 1 if x in df.iloc[i,:].values else 0)\n\ntrans_df=trans_df.T\ntrans_df.columns=trans_df.iloc[1,:]\ndf=trans_df.iloc[2:,:]              # PREPROCESSED DATASET","29020706":"frequent_itemsets = apriori(df, min_support=0.01,use_colnames=True)\nfrequent_itemsets['length'] = frequent_itemsets['itemsets'].apply(lambda x: len(x))\nfrequent_itemsets","8f72fdce":"frequent_itemsets[frequent_itemsets.length==2].sort_values(by=['length','support'], ascending=False)","6c3935e2":"rules = association_rules(frequent_itemsets, metric=\"lift\", min_threshold=1.2)\nrules[\"antecedents_length\"] = rules[\"antecedents\"].apply(lambda x: len(x))\nrules[\"consequents_length\"] = rules[\"consequents\"].apply(lambda x: len(x))\nrules.sort_values(\"lift\",ascending=False)","fe126d47":"rules[rules['consequent support']<0.15].sort_values(\"lift\",ascending=False)","f7d7d202":"### Import Libraries","d4809ad0":"### Obtaining the frequent itemsets","69818e37":"### Preprocessing the data for apriori algorithm"}}