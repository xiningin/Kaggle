{"cell_type":{"18c4ca26":"code","66a8e685":"code","6826a92a":"code","eb6507f1":"code","a56b43c2":"code","b626282a":"code","18bbe17b":"code","5d7472c8":"code","192b4394":"code","487d3eed":"code","d053f61e":"code","c2851292":"code","b64f12da":"code","8c4883a8":"code","154f2c19":"code","fb8037e9":"code","d946645d":"code","9946c932":"code","0ad307a0":"code","4c3de4f7":"code","7b21ebaa":"code","cce5da97":"code","c84b7417":"markdown","893ce67c":"markdown","901d3c55":"markdown","0cfc032a":"markdown","8fba8903":"markdown","3fd77884":"markdown","612aa058":"markdown","f64a6ce4":"markdown","0458d21a":"markdown","6358e204":"markdown"},"source":{"18c4ca26":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom sklearn.model_selection import train_test_split,cross_val_score\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn import metrics\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.ensemble import RandomForestRegressor\nimport xgboost as xgb\n%matplotlib inline\nsns.set_style('whitegrid')\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","66a8e685":"df= pd.read_csv('\/kaggle\/input\/fish-market\/Fish.csv')\ndf.head()","6826a92a":"df.tail()","eb6507f1":"df.describe()","a56b43c2":"df.shape","b626282a":"df.Species.value_counts()","18bbe17b":"sns.catplot(x='Species' ,data=df,kind='count')","5d7472c8":"df.groupby('Species').median().sort_values('Weight',ascending=False)","192b4394":"g=sns.pairplot(df,hue='Species')\nplt.show()","487d3eed":"dfs=df[['Weight','Length1','Height','Width']]\nstd = StandardScaler()\ndfs=pd.DataFrame(std.fit_transform(dfs),columns=dfs.columns)","d053f61e":"X_train, X_test, y_train, y_test = train_test_split(dfs.drop('Weight',axis=1), dfs['Weight'], test_size=0.3, random_state=42)","c2851292":"lr=LinearRegression()\nlr.fit(X_train,y_train)","b64f12da":"print(lr.score(X_test,y_test) * 100)","8c4883a8":"yhat=lr.predict(X_test)\nprint(metrics.mean_squared_error(yhat,y_test))","154f2c19":"rf=RandomForestRegressor()\nrf.fit(X_train,y_train)","fb8037e9":"print(rf.score(X_test,y_test) * 100)","d946645d":"yhatrf=rf.predict(X_test)\nprint(metrics.mean_squared_error(yhatrf,y_test))","9946c932":"model_xgb = xgb.XGBRegressor(n_estimators=2000, max_depth=4, learning_rate=0.1, \n                             verbosity=1, silent=None, objective='reg:linear', booster='gbtree', \n                             n_jobs=-1, nthread=None, gamma=0, min_child_weight=1, max_delta_step=0, \n                             subsample=0.8, colsample_bytree=0.8, colsample_bylevel=1, colsample_bynode=1, reg_alpha=0.2, reg_lambda=1.2, \n                             scale_pos_weight=1, base_score=0.5, random_state=0, seed=None, missing=None, importance_type='gain')","0ad307a0":"model_xgb.fit(X_train, y_train)","4c3de4f7":"yhatxgb= model_xgb.predict(X_test)","7b21ebaa":"print(model_xgb.score(X_test,y_test) * 100)","cce5da97":"print(metrics.mean_squared_error(yhatxgb,y_test))","c84b7417":"### from the above table we notice that the features vary widely among the 8 fish species also the 'Roach' and 'Parkki' are kinda similar..","893ce67c":"### We have 7 columns\n* Species: species name of fish\n* Weight: weight of fish in Gram g\n* Length1 : vertical length in cm\n* Length2 :diagonal length in cm\n* Length3 :cross length in cm\n* Height: height in cm\n* Width :diagonal width in cm\n\n### our target is to predict the weight of the fish based on the other features..\n\n\n","901d3c55":"## In this notebook I'll do some Linear Regression analysis on fish market data.. let's get started with importing our packages..","0cfc032a":"### Let's see a scatter plot to indicate th relation between features..","8fba8903":"### Reading our dataset and getting initial insights..","3fd77884":"### Since our dataset is really small I'll use cross validation..","612aa058":"### Our data is imbalanced..","f64a6ce4":"### XGboost Regressor...","0458d21a":"### We can see that some features are highly correlated with each other so we'll drop some.\n### I'll build model twice one with all the features and the other one with only Lenght1,weight and height","6358e204":"### Trying another model, RandomForestRegressor"}}