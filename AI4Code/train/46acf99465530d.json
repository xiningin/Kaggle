{"cell_type":{"c4a4ea52":"code","86e4fe62":"code","131920c3":"code","437af8ad":"code","57ffce4c":"code","79b4bac4":"markdown"},"source":{"c4a4ea52":"# This script can be used with any dataset for KFold cross validation\nimport pandas as pd\nfrom sklearn import model_selection\n\n\ntrain_path = '..\/input\/tabular-playground-series-jan-2021\/train.csv'\ndf = pd.read_csv(train_path)\n\n# initialize number of folds to create\nn_splits = 5\n\nprint(\"The shape of data is: \", df.shape)\n\n# creating a new column 'kfold' and fill it with -1\ndf[\"kfold\"] = -1\n\n# randomize the rows of the data\ndf = df.sample(frac=1).reset_index(drop=True)\n\n# intiate the kfold class from model_selection module\nkf = model_selection.KFold(n_splits)\n\n# fill the new kfold column\nfor fold, [trn_, val_] in enumerate(kf.split(X=df)):\n    df.loc[val_, 'kfold'] = fold\n\nprint(\"Creating folds ...\")\n\n# save the new csv with kfold column\ndf.to_csv(\"train_folds.csv\", index=False)\n\nprint(f\"New dataset with {n_splits} folds created\")","86e4fe62":"fold_path = '.\/train_folds.csv'\ntrain = pd.read_csv(fold_path)","131920c3":"train.shape","437af8ad":"train.head().T","57ffce4c":"train.kfold.value_counts()","79b4bac4":"The new fold column is the fold number. You can remove that column if you do not require it"}}