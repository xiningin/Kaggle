{"cell_type":{"2d432473":"code","7b96aaa5":"code","8ad399e1":"code","77d6c8aa":"code","4dd557d7":"code","79768823":"code","d476f130":"markdown","8d6cf143":"markdown","9165bf2a":"markdown","99390910":"markdown","e05f085c":"markdown","c3a0015e":"markdown"},"source":{"2d432473":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n%matplotlib inline","7b96aaa5":"df_train = pd.read_csv('..\/input\/X_train.csv', encoding='cp949')\ndf_test = pd.read_csv('..\/input\/X_test.csv', encoding='cp949')\ny_train = pd.read_csv('..\/input\/y_train.csv').gender\nIDtest = df_test.custid.unique()\n\ndf_train.head()","8ad399e1":"level = 'corner_nm'\ndf_train[level].nunique()","77d6c8aa":"df_all = pd.concat([df_train, df_test])\nX_train = pd.pivot_table(df_all, index='custid', columns=level, values='tot_amt',\n                         aggfunc=lambda x: np.where(len(x) >=1, 1, 0), fill_value=0). \\\n                         reset_index(). \\\n                         query('custid not in @IDtest'). \\\n                         drop(columns=['custid']).values\nX_test = pd.pivot_table(df_all, index='custid', columns=level, values='tot_amt',\n                         aggfunc=lambda x: np.where(len(x) >=1, 1, 0), fill_value=0). \\\n                         reset_index(). \\\n                         query('custid in @IDtest'). \\\n                         drop(columns=['custid']).values\n\nmax_features = X_train.shape[1]","4dd557d7":"# Learn XGB\nfrom xgboost import XGBClassifier\nimport sys, warnings\nif not sys.warnoptions: warnings.simplefilter(\"ignore\")\n\nmodel = XGBClassifier(random_state=0, n_jobs=-1)\nmodel.fit(X_train, y_train)","79768823":"pred = model.predict_proba(X_test)[:,1]\nfname = 'submissions_OHE.csv'\nsubmissions = pd.concat([pd.Series(IDtest, name=\"custid\"), pd.Series(pred, name=\"gender\")] ,axis=1)\nsubmissions.to_csv(fname, index=False)\nprint(\"'{}' is ready to submit.\" .format(fname))","d476f130":"### Build Models","8d6cf143":"### Imports","9165bf2a":"### Read Data","99390910":"## End","e05f085c":"### Transform Data with One-hot Encoding","c3a0015e":"### Make Submissions"}}