{"cell_type":{"45b562e8":"code","b3046ab0":"code","2de888ec":"code","933d7ff8":"code","59f36e15":"code","468106bb":"code","9f8fa8d3":"code","087ee01f":"code","59a18b61":"code","4cb47f1a":"code","148c5898":"code","ae9bf7a6":"code","71ffc24e":"markdown","b7fe596d":"markdown","bd76ade2":"markdown","375db532":"markdown","8ec4c58b":"markdown","dff7c881":"markdown","28c9e21a":"markdown"},"source":{"45b562e8":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","b3046ab0":"data_orj = pd.read_csv(\"..\/input\/BlackFriday.csv\")\ndata = data_orj.loc [1:10000,'Gender':'Purchase']  # data is sliced in order to study fast","2de888ec":"data.head()","933d7ff8":"data.info()","59f36e15":"data.describe()","468106bb":"color_list = ['red' if i=='M' else 'green' for i in data.loc[:,'Gender']]\npd.plotting.scatter_matrix(data.loc[:,data.columns != 'Gender'],\n                          c = color_list,\n                          figsize = [15,15],\n                          diagonal = 'hist',\n                          alpha = 0.5, \n                          s = 100,\n                          marker = '*')\nplt.show()","9f8fa8d3":"sns.countplot(x='Gender', data=data)\ndata.loc[:,'Gender'].value_counts()","087ee01f":"data_knn = data_orj[['Occupation','Gender', 'Purchase']]","59a18b61":"data_knn.head()","4cb47f1a":"data_knn.info()","148c5898":"#KNN-2\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.model_selection import train_test_split\nknn = KNeighborsClassifier(n_neighbors = 3)\nx,y = data_knn.loc[:,data_knn.columns != 'Gender'], data_knn.loc[:,'Gender']\nx_train,x_test,y_train,y_test = train_test_split(x,y,test_size = 0.3, random_state = 42)\nknn.fit(x_train,y_train)\nprediction = knn.predict(x_test)\n#print('Prediction : {}'.format(prediction))\nprint('With KNN (K=3) accuracy is: ', knn.score(x_test,y_test))","ae9bf7a6":"#Best K value selection\nneig = np.arange(1,30)\ntrain_accuracy = []\ntest_accuracy = []\nfor i, k in enumerate (neig):\n    knn = KNeighborsClassifier(n_neighbors = k)\n    knn.fit(x_train,y_train)\n    train_accuracy.append(knn.score(x_train,y_train))\n    test_accuracy.append(knn.score(x_test,y_test))\n\n# Plot\nplt.figure(figsize=(13,8))\nplt.plot(neig, test_accuracy, label = 'Testing Accuracy')\nplt.plot(neig, train_accuracy, label = 'Training Accuracy')\nplt.legend()\nplt.title('-value vs. Accuracy')\nplt.xlabel('Number of Neighbors')\nplt.ylabel('Accuracy')\nplt.xticks(neig)\nplt.savefig('graph.png')\nplt.show()\nprint('Best Accuracy is {} with K = {}'.format(np.max(test_accuracy),1+test_accuracy.index(np.max(test_accuracy))))","71ffc24e":"# Conclusion\n\nAs a result, we can say that using KNN algorithm with K=29, **we can estimate the \"Gender\" of a person from her\/his \"Purchase\" value and \"Occupation\" type with 75% accuracy.**\n","b7fe596d":"All features are categrical except \"Purchase\" column. So the matrix scatter plot does not show meaningfull relations (correlations). As you can see from the below outcomes, tha data also is not balanced :( Aynyway, I pretend it is balanced :) Lets begin to use KNN algorithm","bd76ade2":"What should we remember here are:\n1. Features must not be categorical (must be numbers)\n1. You must have 2 features at least (if you have only one feature and one target you can use correlation simply :))","375db532":"### Other Algoritm Studies:\n**Practice #2: Suicide Analysis with REGRESSION** https:\/\/www.kaggle.com\/cengizeralp\/practice-2-suicide-analysis-with-regression","8ec4c58b":"# \"Gender\" prediction using \"Purchase\" value and \"Occupation\" type \nI am new at machine learning and python. So I try to use what I have learned in order to reinforce. \nI used Black Friday data with KNN (K-NEAREST NEIGHBORS) algorithm in this part. \nI plan to revise this document as I learned new things about KNN. If you have any better ideas about using KNN algoritm please let me know. \nThanks in advance :)","dff7c881":"\"Product_Category_2\" and \"Product_Category_3\" has null values","28c9e21a":"Thanks to DATAI team for their valuable training notes. I used their documentation as a refference in this study. https:\/\/www.kaggle.com\/kanncaa1\/machine-learning-tutorial-for-beginners"}}