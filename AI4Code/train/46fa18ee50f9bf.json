{"cell_type":{"1030e40a":"code","090d65a9":"code","4a01e242":"code","5531abf8":"code","b6e5be49":"code","cc522579":"code","4ac3cede":"code","fa4eb452":"code","3e425501":"code","d4a69113":"code","d13d33d9":"code","247173e4":"code","f711e432":"code","9b939ecc":"code","dd3badbf":"code","05d3886e":"code","f9e07bf7":"code","cf9b7717":"code","3ab8c42c":"code","82719645":"code","b89892f3":"code","388fc59b":"code","432ead8a":"code","1340809c":"code","011938b9":"code","a4636c90":"code","2e9bb038":"code","6fc5c587":"code","f2afce47":"code","48ed5c1f":"code","d9629f85":"code","929ae29f":"code","f97fa945":"code","26799fde":"code","5b6f72d7":"code","e75e2d47":"code","39f00cc5":"code","7c18fbb6":"code","a3c8e950":"code","ad57253e":"code","13c02012":"code","79652efa":"code","3ba8053f":"code","1c9a7415":"code","34d09e55":"code","b1da9207":"code","61edbad5":"code","f2367b89":"code","675fb4b7":"code","ec6196c6":"code","df372083":"code","f2995d40":"markdown","46cadfe9":"markdown","2a116ae1":"markdown","dcd39887":"markdown","048c5ff6":"markdown","9760be43":"markdown","1a1ade0e":"markdown","95ec5596":"markdown","9323e0f4":"markdown","e198a9d6":"markdown","1a8cdaf7":"markdown","e93088c2":"markdown","5bf2793a":"markdown","c0a58beb":"markdown","f84300ee":"markdown","acac629c":"markdown","5ba69548":"markdown","99551092":"markdown","abe8a943":"markdown","2d8f2969":"markdown","78243627":"markdown","f0c6664a":"markdown","961ad96e":"markdown","76222bc3":"markdown","08232396":"markdown","c720e7c4":"markdown","49ac5798":"markdown","7faaa9e2":"markdown","e9b1a2c1":"markdown","2d233bfd":"markdown","224d2928":"markdown","721cf191":"markdown","5636afee":"markdown","df1d9c1f":"markdown","614e6241":"markdown","e5f42242":"markdown","3e4f83c5":"markdown","cfab3018":"markdown","0807bd1b":"markdown","6a4d3d74":"markdown","0fffa88c":"markdown","bd5ed4bd":"markdown","b52d5676":"markdown","d5f6fb71":"markdown","cfd44c4e":"markdown","69d866da":"markdown","3e62106b":"markdown","7d50dc2c":"markdown","bc7254d4":"markdown","ddae2bd4":"markdown","4d5beb9b":"markdown","10b21849":"markdown"},"source":{"1030e40a":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport warnings\nwarnings.filterwarnings('ignore')","090d65a9":"data = pd.read_csv(\"..\/input\/insurance\/insurance.csv\")\ndata.head()","4a01e242":"print(\"Shape of dataframe: \", data.shape)","5531abf8":"data.info()","b6e5be49":"# Missing data\n\ndata.isnull().sum()","cc522579":"# Data types\n\ndata.dtypes","4ac3cede":"# Data type value counts\n\ndata.dtypes.value_counts()","fa4eb452":"# Summary statistics\n\ndata.describe().transpose()","3e425501":"# Age category\n\ndata.loc[(data['age'] >= 18) & (data['age'] < 36), 'age_category'] = 'youth'\ndata.loc[(data['age'] >= 36) & (data['age'] <= 55), 'age_category'] = 'adults'\ndata.loc[data['age'] > 55, 'age_category'] = 'seniors'\ndata['age_category'].value_counts()","d4a69113":"# Weight condition\n\ndata.loc[data['bmi'] < 18.5, 'weight_condition'] = 'underweight'\ndata.loc[(data['bmi'] >= 18.5) & (data['bmi'] < 25), 'weight_condition'] = 'normal weight'\ndata.loc[(data['bmi'] >= 25) & (data['bmi'] < 30), 'weight_condition'] = 'overweight'\ndata.loc[data['bmi'] >= 30, 'weight_condition'] = 'obese'\ndata['weight_condition'].value_counts()","d13d33d9":"# Dependent\n\ndata.loc[data['children'] > 0, 'dependent'] = 'yes'\ndata.loc[data['children'] == 0, 'dependent'] = 'no'\ndata['dependent'].value_counts()","247173e4":"data.head()","f711e432":"# Missing data\n\ndata.isnull().sum()","9b939ecc":"# Data types \n\ndata.dtypes","dd3badbf":"# Data type value counts\n\ndata.dtypes.value_counts()","05d3886e":"data['sex'].value_counts()","f9e07bf7":"plt.figure(figsize = (7, 6))\nsns.countplot(data['sex'])\nplt.title('Sex Value Counts')","cf9b7717":"data['smoker'].value_counts()","3ab8c42c":"plt.figure(figsize = (7, 6))\nsns.countplot(data['smoker'])\nplt.title('Smoker Value Counts')","82719645":"data['region'].value_counts()","b89892f3":"# Countplot with percentage\n\ntotal = len(data)\nplt.figure(figsize = (10, 6))\nplt.title('Region Value Counts')\nax = sns.countplot(x = 'region', data = data)\nfor p in ax.patches:\n    percentage = '{0:.0f}%'.format(p.get_height() \/ total * 100)\n    x = p.get_x() + p.get_width() \/ 2\n    y = p.get_height() + 5\n    ax.annotate(percentage, (x, y), ha = 'center')\nplt.show()","388fc59b":"data['age_category'].value_counts()","432ead8a":"total = len(data)\nplt.figure(figsize = (7, 6))\nplt.title('Age Category Value Counts')\nax = sns.countplot(x = 'age_category', data = data)\nfor p in ax.patches:\n    percentage = '{0:.0f}%'.format(p.get_height() \/ total * 100)\n    x = p.get_x() + p.get_width() \/ 2\n    y = p.get_height() + 5\n    ax.annotate(percentage, (x, y), ha = 'center')\nplt.show()","1340809c":"data['weight_condition'].value_counts()","011938b9":"total = len(data)\nplt.figure(figsize = (10, 6))\nplt.title('Weight Condition Value Counts')\nax = sns.countplot(x = 'weight_condition', data = data)\nfor p in ax.patches:\n    percentage = '{0:.0f}%'.format(p.get_height() \/ total * 100)\n    x = p.get_x() + p.get_width() \/ 2\n    y = p.get_height() + 5\n    ax.annotate(percentage, (x, y), ha = 'center')\nplt.show()","a4636c90":"data['dependent'].value_counts()","2e9bb038":"total = len(data)\nplt.figure(figsize = (7, 6))\nplt.title('Dependent Value Counts')\nax = sns.countplot(x = 'dependent', data = data)\nfor p in ax.patches:\n    percentage = '{0:.0f}%'.format(p.get_height() \/ total * 100)\n    x = p.get_x() + p.get_width() \/ 2\n    y = p.get_height() + 5\n    ax.annotate(percentage, (x, y), ha = 'center')\nplt.show()","6fc5c587":"sns.set_style('whitegrid')\nsns.catplot('sex', col = 'smoker', hue = 'age_category', data = data, kind = 'count')","f2afce47":"sns.set_style('whitegrid')\nsns.catplot(x = 'smoker', col = 'region', data = data, kind = 'count', aspect = 0.6)","48ed5c1f":"sns.set_style('white')\nplt.figure(figsize = (12, 4))\nsns.boxplot(y = data['smoker'], x = data['charges'])\nplt.title('Charges by Smoking Habits')","d9629f85":"sns.set_style('white')\nplt.figure(figsize = (12, 5))\nsns.boxplot(y = data['age_category'], x = data['charges'])\nplt.title('Charges by Age Category')","929ae29f":"sns.set_style('white')\nsns.distplot(data['bmi'], label = 'Skewness: %.2f'%(data['bmi'].skew()))\nplt.legend(loc = 'best')\nplt.title('BMI Distribution')","f97fa945":"print(\"Average BMI: {:.2f}\".format(data['bmi'].mean()))","26799fde":"sns.set_style('white')\nsns.distplot(data['bmi'], label = 'Skewness: %.2f'%(data['bmi'].skew()), kde = False)\nplt.legend(loc = 'best')\nplt.title('BMI Distribution')","5b6f72d7":"sns.set_style('white')\nsns.kdeplot(data.loc[data['sex'] == 'male', 'charges'], label = 'Male', shade = True)\nsns.kdeplot(data.loc[data['sex'] == 'female', 'charges'], label = 'Female', shade = True)\nplt.xlabel('Charges')\nplt.title('Charges by Gender')","e75e2d47":"plt.figure(figsize = (10, 4))\nsns.kdeplot(data.loc[data['age_category'] == 'youth', 'charges'], label = 'Youth', shade = True)\nsns.kdeplot(data.loc[data['age_category'] == 'adults', 'charges'], label = 'Adults', shade = True)\nsns.kdeplot(data.loc[data['age_category'] == 'seniors', 'charges'], label = 'Seniors', shade = True)\nplt.xlabel('Charges')\nplt.title('Charges by Age Category')","39f00cc5":"correlation = correlation = data[['age', 'bmi', 'children', 'charges']].corr()\nsns.heatmap(correlation, annot = True, fmt = '.2f', cmap = 'Blues')\nplt.title('Correlation Between Numerical Variables')","7c18fbb6":"correlation['charges'].sort_values(ascending = False).drop('charges')","a3c8e950":"sns.set_style('white')\nplt.figure(figsize = (7, 6))\nsns.barplot(x = 'region', y = 'charges', data = data)\nplt.title('Charges by Region')","ad57253e":"sns.set_style('white')\nplt.figure(figsize = (7, 6))\nsns.barplot(x = 'dependent', y = 'charges', data = data)\nplt.title('Charges by Dependent')","13c02012":"sns.jointplot(x = 'bmi', y = 'charges', data = data, kind = 'kde')","79652efa":"plt.figure(figsize = (7, 6))\nsns.scatterplot(x = 'bmi', y = 'charges', hue = 'smoker', data = data)","3ba8053f":"obese_smoker = data.loc[(data['weight_condition'] == 'obese') & (data['smoker'] == 'yes'), :]\nobese_nonsmoker = data.loc[(data['weight_condition'] == 'obese') & (data['smoker'] == 'no'), :]","1c9a7415":"sns.set_style('white')\nplt.figure(figsize = (7, 6))\nsns.scatterplot(x = 'age', y = 'charges', data = obese_smoker, label = 'Obese Smoker')\nsns.scatterplot(x = 'age', y = 'charges', data = obese_nonsmoker, label = 'Obese Non-Smoker')","34d09e55":"sns.set_style('darkgrid')\nplt.figure(figsize = (7, 6))\nsns.regplot(x = 'bmi', y = 'charges', data = data)\nplt.title('Charges Against BMI')","b1da9207":"sns.set_style('white')\nsns.lmplot(x = 'age', y = 'charges', hue = 'age_category', data = data)","61edbad5":"sns.lmplot(x = 'bmi', y = 'charges', hue = 'smoker', data = data)","f2367b89":"sns.set_style('white')\nplt.figure(figsize = (7, 6))\nsns.swarmplot(x = data['smoker'], y = data['charges'])\nplt.title('Charges by Smoking Habits')","675fb4b7":"plt.figure(figsize = (10, 6))\nsns.set_style('whitegrid')\nsns.violinplot(x = 'weight_condition', y = 'charges', hue = 'smoker', data = data, split = True)\nsns.despine(left = True)","ec6196c6":"sns.set_style('white')\nplt.figure(figsize = (7, 6))\nsns.pointplot(x = 'weight_condition', y = 'charges', hue = 'smoker', data = data)","df372083":"sns.pairplot(data, hue = 'smoker')","f2995d40":"# 4. Check missing values, data types and summary statistics","46cadfe9":"## 6.2.3 sns.kdeplot\n\nIn statistics, kernel distribution estimation is a non-parametric way to estimate the probability density function of a random variable. Essentially, it applies data smoothing to a normal histogram but still serves the same purpose of visualising a continuous variable.","2a116ae1":"There are more non-smokers than there are smokers in the dataset.","dcd39887":"Females pay higher premiums than male. This could be due to the fact that there are more male smokers than there are female smokers.","048c5ff6":"Here, we can examine how smoking correlates with the other numerical variables in our dataset. ","9760be43":"## 7.4 sns.scatterplot\n\nScatterplot is a good way to spot outliers in your data.","1a1ade0e":"People pay more for health insurance as they get older.","95ec5596":"# 3. Data description\n\nBelow are the description of the columns in the dataset:\n- age: Age of primary beneficiary\n- sex: Insurance contractor gender\n- bmi: Body mass index\n- children: Number of children covered by health insurance \/ Number of dependents\n- smoker: Smoking\n- region: The beneficiary's residential area in the US\n- charges: Individual medical costs billed by health insurance","9323e0f4":"## 7.3 sns.jointplot\n\nJointplot shows where data points lie between two separate numerical variables.","e198a9d6":"We can remove kernel distribution estimation (kde) from distplot by simply setting the kde argument to False.","1a8cdaf7":"## 7.10 sns.pairplot\n\nPairplot plots pairwise relationships in a dataset.","e93088c2":"After feature engineering, we now have 3 additional categorical variables, bringing the total to 6 categorical variables as well as 4 numerical variables.","5bf2793a":"## 7.5 regplot\n\nRegplot plots the data and adds a linear regression model fit.","c0a58beb":"Here, I have plotted a lmplot of charges against bmi but further categorised by smoking status.\n\nAgain, we see the positive relationship between bmi and charges but a dramatically steeper hike for smokers in comparison to non-smokers. We can conclude that smoking significantly raises the premium levels for health insurance. ","f84300ee":"The diagonal of a heatmap is always one because they represent the correlation between a variable and itself. The diagonal can also be seen as a mirror between the bottom triangle and the top triangle. If you look closely, the two triangles contain the same set of information.\n\nThere are two ways to interpret a heatmap: by reading across the columns or by reading down the rows.\n\nAs we can see from the charges column\/row, age is the most correlated feature to charges, followed by bmi and finally children.","acac629c":"# 1. Import libraries","5ba69548":"Here, I have divided the population up by their gender, smoking habits and age category.\n\nAs we can observe from the plot, there are more male smokers than there are female smokers. Most smokers belong to the youth and adults age categories.","99551092":"The darker region represents the majority of the population.","abe8a943":"# 8. Conclusion\n\nTo summarise, seaborn is a data visualisation library that is built on top of the Python language. In this notebook, we have considered various plots that we can use to visualise distributions as well the relationship between different variables in our dataset. It is important to distinguish between categorical and numerical variables when visualing data as they each require different plots to properly visualise and interpret them.\n\nI hope you have learned more about the seaborn library as well as how different features such as age, gender, smoking habits and weight condition correlate with premium levels for health insurance.\n\nAs usual, feel free to reach out to me if you have any questions or constructive feedback. Happy learning!\n\nMy platforms: \n- [Facebook](https:\/\/www.facebook.com\/chongjason914)\n- [Instagram](https:\/\/www.instagram.com\/chongjason914)\n- [Twitter](https:\/\/www.twitter.com\/chongjason914)\n- [LinkedIn](https:\/\/www.linkedin.com\/in\/chongjason914)\n- [YouTube](https:\/\/www.youtube.com\/channel\/UCQXiCnjatxiAKgWjoUlM-Xg?view_as=subscriber)\n- [Medium](https:\/\/www.medium.com\/@chongjason)","2d8f2969":"We have 3 categorical variables and 4 numerical variables.","78243627":"As we have seen earlier, premium level increases with age.","f0c6664a":"## 6.1 Categorical variables\n\nRecall the categorical variables in our dataset include:\n- sex\n- smoker\n- region\n- age_category\n- weight_condition\n- dependent","961ad96e":"Oh no! More than half the beneficiaries are considered obese.","76222bc3":"Here, I have plotted a lmplot of charges against age but further categorised by age categories. \n\nThere is a positive relationship between age and charges. Senior citizens have a much steeper increase due to the higher risks of health complications at older ages. ","08232396":"Southeast region has the highest number of smokers.","c720e7c4":"## 6.2 Numerical variable\n\nRecall the numerical variables in our dataset include:\n- age\n- bmi\n- children\n- charges","49ac5798":"# 0. Introduction\n\nOne of the most important skills to develop as a data scientist is the ability to communicate the results of your analysis to relevant stakeholders. In consulting, clients often do not have the time to read through your code line by line but instead are more interested in the key insights of a particular project, and how those insights can be used to make their business more efficient and profitable.\n\nWhen done properly, data visualisation aims to summarise important trends and patterns in the dataset, therefore allowing the key points of an analysis to be communicated in a succint manner.\n\n[Seaborn](https:\/\/seaborn.pydata.org\/examples\/index.html) is a library that is built specifically for the purpose of visualising data. In this notebook, I will demonstrate some of the most common visualisation techniques provided by the seaborn library with reference to the [Kaggle medical cost dataset](https:\/\/www.kaggle.com\/mirichoi0218\/insurance). This dataset contains information about 1,338 insurance beneficiaries living in the United States and the corresponding amount they pay for their health insurance premium.\n\nI have chosen this dataset for the following reasons:\n- Good mix of numerical and categorical variables\n- Not too many features\n- Intuitive and straightforward relationship between the predictor and target variables (charges)\n\nI will demonstrate how seaborn can be used to visualise the distribution as well as the relationship between different variables in this dataset. Not included in this notebook is sns.lineplot, which is typically used to analyse time series.","7faaa9e2":"## 7.6 lmplot\n\nlmplot combines regplot and FacetGrid. The FacetGrid class helps in visualising the distribution of one variable as well as the relationship between multiple variables separately within subsets of your dataset using multiple panels.","e9b1a2c1":"# 6. Visualise distribution\n\nBefore we visualise the distribution of our data, it is always good practice that we first categorise the features in the dataset as either categorical or numerical variable. This is because they each have different distribution of values and hence require different plots to properly visualise them. Categorical variables have a discrete distribution whereas numerical variables have a continuous distribution.\n\nCategorical variables:\n- sns.countplot\n- sns.catplot (formerly sns.factorplot)\n\nNumerical variables:\n- sns.boxplot\n- sns.distplot\n- sns.kdeplot\n- sns.catplot","2d233bfd":"## 7.8 sns.violinplot\n\nViolinplot draws a combination of boxplot and kernel density estimate.","224d2928":"## 6.1.2 sns.catplot (formerly sns.factorplot)\n\nFactorplot allows us to further break down a categorical variable using another categorical variable.","721cf191":"## 6.2.2 sns.distplot","5636afee":"## 6.2.1 sns.boxplot\n\nBoxplot is one of the most popular plots in statistics. It gives an overview of the distribution of a continuous variable.","df1d9c1f":"# 2. Import and read data","614e6241":"There is almost an equal distribution between male and female in the dataset.","e5f42242":"# 5. Feature engineering\n\nFeature engineering is the process of creating new features using existing features in the dataset. In this section, I will create 3 new features:\n\n- age_category\n- weight_condition\n- dependent","3e4f83c5":"## 7.1 sns.heatmap\n\nHeatmap is one of the easiest ways to analyse the correlation between numerical variables. A positive correlation implies that two variables move in the same direction. Conversely, a negative correlation implies that two variable move in the opposite direction.","cfab3018":"As expected, smokers pay a higher premium than non-smokers.","0807bd1b":"## 6.1.1 sns.countplot\n\nCountplot simply shows the count of each value in a column.","6a4d3d74":"Obese smokers pay a significantly higher premium.","0fffa88c":"Southeast region pays the highest premium. This could be due to the fact that the region has the highest number of smokers which in turn drove up the average premium levels.","bd5ed4bd":"## 7.7 sns.swarmplot\n\nSwarmplot draws a categorical scatterplot with non-overlapping points.","b52d5676":"BMI follows a normal distribution but the average BMI for this population is considered overweight or obese. This comes at no surprise as the United States has one of the highest levels of obesity in the world.","d5f6fb71":"Majority of the  beneficiaries have children.","cfd44c4e":"Hooray, no missing values!","69d866da":"There is almost an equal distribution between the 4 regions with southeast having slightly more people.","3e62106b":"There is almost and equal distribution between youth and adults. Seniors have the least number of people.","7d50dc2c":"## 7.2 sns.barplot\n\nA bar plot represents an estimate of central tendency for a numeric variable with the height of each rectangle and provides some indication of the uncertainty around that estimate using error bars. ","bc7254d4":"## 7.9 sns.pointplot\n\nA point plot represents an estimate of central tendency for a numeric variable by the position of scatter plot points and provides some indication of the uncertainty around that estimate using error bars.","ddae2bd4":"The linear line has a positive slope, suggesting a positive relationship between bmi and charges. The higher the BMI, the higher the premium for health insurance. ","4d5beb9b":"Policyholders that have children pay a higher premium than those without children. Not exactly sure why.","10b21849":"# 7. Visualise relationship\n\n- sns.heatmap\n- sns.barplot\n- sns.jointplot\n- sns.scatterplot\n- sns.regplot\n- sns.lmplot\n- sns.swarmplot\n- sns.violinplot\n- sns.pairplot\n- sns.pointplot"}}