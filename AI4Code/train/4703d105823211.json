{"cell_type":{"fc2de327":"code","10112ed1":"code","c6714134":"code","85d90d35":"code","b082ef7e":"code","f15c4485":"code","aa1875a9":"code","69ad3635":"code","c80f0944":"code","1fbb7686":"code","1fe02132":"code","e377bc0e":"code","f6fd40ea":"code","91c2bf14":"code","097ec473":"code","959b348a":"code","d57032d0":"code","b852b34b":"code","55ad0bce":"code","fe2fdcb8":"code","5efe6c98":"code","7957682d":"code","f205d4af":"code","798a3e0b":"code","4909f226":"code","6196eb62":"code","f546b9ce":"code","b143309d":"code","90f4777d":"code","d09a0438":"code","5c5b95dc":"code","8eccdb1e":"markdown","02356151":"markdown","11381b12":"markdown","c3258cae":"markdown","d72a0443":"markdown","c1067091":"markdown","69ba267a":"markdown","2eacff45":"markdown","a79e0955":"markdown","01c6db91":"markdown","aacf97ea":"markdown"},"source":{"fc2de327":"import numpy as np\nimport pandas as pd","10112ed1":"!ls ..\/input\/titanic","c6714134":"train = pd.read_csv('..\/input\/titanic\/train.csv')\ntest = pd.read_csv('..\/input\/titanic\/test.csv')\ngender_submission = pd.read_csv('..\/input\/titanic\/gender_submission.csv')","85d90d35":"gender_submission.head()","b082ef7e":"train.head()","f15c4485":"test.head()","aa1875a9":"data = pd.concat([train, test], sort=False)","69ad3635":"data.head()","c80f0944":"print(len(train), len(test), len(data))","1fbb7686":"data.isnull().sum()","1fe02132":"data['Sex'].replace(['male', 'female'], [0, 1], inplace=True)","e377bc0e":"data['Embarked'].fillna(('S'), inplace=True)\ndata['Embarked'] = data['Embarked'].map({'S': 0, 'C': 1, 'Q': 2}).astype(int)","f6fd40ea":"data['Fare'].fillna(np.mean(data['Fare']), inplace=True)","91c2bf14":"age_avg = data['Age'].mean()\nage_std = data['Age'].std()\n\ndata['Age'].fillna(data['Age'].median(), inplace=True)","097ec473":"data['FamilySize'] = data['Parch']+data['SibSp']+1","959b348a":"delete_columns = ['Name', 'PassengerId', 'SibSp', 'Parch', 'Ticket', 'Cabin']\ndata.drop(delete_columns, axis=1, inplace=True)","d57032d0":"train = data[:len(train)]\ntest = data[len(train):]","b852b34b":"data.head()","55ad0bce":"train.head()","fe2fdcb8":"test.head()","5efe6c98":"print(len(data))","7957682d":"print(len(train))","f205d4af":"print(len(test))","798a3e0b":"y_train = train['Survived']\nX_train = train.drop('Survived', axis=1)\nX_test = test.drop('Survived', axis=1)","4909f226":"X_train.head()","6196eb62":"y_train.head()","f546b9ce":"from sklearn.model_selection import train_test_split\n\nX_train, X_valid, y_train, y_valid = \\\n    train_test_split(X_train, y_train, test_size=0.3, random_state=0, stratify=y_train)","b143309d":"categorical_features = ['Embarked', 'Pclass', 'Sex']","90f4777d":"import optuna\nfrom sklearn.metrics import log_loss\n\ndef objective(trial):\n    lgb_train = lgb.Dataset(X_train, y_train, categorical_feature=categorical_features)\n    lgb_eval = lgb.Dataset(X_valid, y_valid, reference=lgb_train, categorical_feature=categorical_features)\n    params = {\n    'objective': 'binary',\n    'max_bin': trial.suggest_int('max_bin', 255, 500),\n    'learning_rate': 0.05,\n    'num_leaves': trial.suggest_int('num_leaves', 32, 128)\n    }\n    model = lgb.train(params, lgb_train, valid_sets=[lgb_train, lgb_eval], verbose_eval=10, num_boost_round=1000, early_stopping_rounds=10)\n    y_pred_valid = model.predict(X_valid, num_iteration=model.best_iteration)\n    score = log_loss(y_valid, y_pred_valid)\n    return score","d09a0438":"study = optuna.create_study(sampler=optuna.samplers.RandomSampler(seed=0))\nstudy.optimize(objective, n_trials=40)\nstudy.best_params","5c5b95dc":"sub = pd.read_csv('..\/input\/titanic\/gender_submission.csv')\nsub['Survived'] = list(map(int, y_pred))\nsub.to_csv('submission.csv', index=False)","8eccdb1e":"### 5. Age","02356151":"### 3. Embarked","11381b12":"data['IsAlone'] = 0\ndata.loc[data['FamilySize'] == 1, 'IsAlone'] = 1","c3258cae":"## \u63d0\u51fa","d72a0443":"### 1. Pclass","c1067091":"## \u7279\u5fb4\u91cf\u30a8\u30f3\u30b8\u30cb\u30a2\u30ea\u30f3\u30b0","69ba267a":"### 4. Fare","2eacff45":"This notebook is a sample code with Japanese comments.\n\n# 2.1 \u307e\u305a\u306fsubmit\uff01\u3000\u9806\u4f4d\u8868\u306b\u8f09\u3063\u3066\u307f\u3088\u3046","a79e0955":"### 2. Sex","01c6db91":"## \u30c7\u30fc\u30bf\u306e\u8aad\u307f\u8fbc\u307f","aacf97ea":"## \u6a5f\u68b0\u5b66\u7fd2\u30a2\u30eb\u30b4\u30ea\u30ba\u30e0"}}