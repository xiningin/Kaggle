{"cell_type":{"9783a912":"code","516319f1":"code","ce8bc2a3":"code","82754e65":"code","1a7a62e4":"code","e4ed7cfb":"code","f6cb339d":"code","89fee1c0":"code","117cb9b1":"code","5d8d101b":"code","1f5b2cf0":"code","87b79d38":"code","6d0a3254":"code","ececb5b3":"code","aab89c26":"code","6f9018bb":"code","0f640270":"code","637875ff":"code","b6c786f2":"code","e3759e2b":"code","1cc685d4":"code","0cf2f3ff":"code","9b50a25d":"code","f0291f0e":"code","eff41631":"code","3285ee8a":"code","d9cac6b5":"code","278b32d1":"code","910b5d44":"code","82d93693":"code","8cc744fb":"code","f66a4cca":"code","de77c9a7":"code","3715218c":"code","ba688006":"code","0db27e9c":"code","4b4af0e2":"code","b783d3c4":"code","e4f79fdf":"code","1d5dd197":"code","eb02dc00":"code","4d9afa0d":"code","c90d93c4":"code","463f5a5d":"code","ec1905e0":"code","5f3ff6ba":"code","cbcd5c04":"code","4be4416e":"code","ded1a53f":"code","77e252e1":"markdown","5f7dbd47":"markdown","a443a9ac":"markdown","76be17a7":"markdown","dd9ea46f":"markdown","b4cbb0a5":"markdown","19f86138":"markdown","6f7d3281":"markdown","c2631dda":"markdown","c79fa8d9":"markdown","b791b1c2":"markdown","55b7b0c3":"markdown","20726ea9":"markdown","eb60ec72":"markdown","6c3e2b8e":"markdown","a98d1ad8":"markdown","1931f69a":"markdown","ee84c204":"markdown","f67792b3":"markdown","230943ca":"markdown","793290cb":"markdown","fcba56de":"markdown","cbeb7cb3":"markdown","ede8588f":"markdown","98f92b49":"markdown","6b651234":"markdown","16279bca":"markdown","f808b507":"markdown","46343157":"markdown","2822b81c":"markdown","8b1f213d":"markdown","719ab773":"markdown","6d0258fe":"markdown","8471adec":"markdown","375ecabb":"markdown","74c0fd6d":"markdown","ac1a50ea":"markdown","74830383":"markdown","6f717c23":"markdown","5c6a246c":"markdown","17846ab8":"markdown","f69c1b91":"markdown","caab8098":"markdown","43f38c6d":"markdown","09fa6497":"markdown","91ceb069":"markdown","a8930092":"markdown","3334bd52":"markdown","9d246752":"markdown","312ca97c":"markdown","f7d9bb87":"markdown","ac9349af":"markdown"},"source":{"9783a912":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport random \n\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import RobustScaler\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import classification_report, confusion_matrix\n\nimport warnings\nwarnings.filterwarnings(\"ignore\")","516319f1":"df = pd.read_csv('..\/input\/rednwhitewinequality\/RednWhitewinequality.csv')\n\ndf.head()","ce8bc2a3":"df.info()","82754e65":"df.describe()","1a7a62e4":"df['alcohol'].mean()","e4ed7cfb":"df['type'].value_counts()","f6cb339d":"df['alcohol'].hist(bins=10, grid=False, figsize=(12,5), color='green')\nplt.xlabel('Alcohol percentage')\nplt.title('Alcohol Content')\nplt.ylabel('Count')","89fee1c0":"plt.style.use('dark_background')\nplt.figure(figsize=(12,5))\nsns.distplot(df['alcohol'], bins=10, kde=True)\nplt.title('Alcohol Content')\nplt.xlabel('alcohol percentage')","117cb9b1":"df['alcohol'].value_counts().head(10)","5d8d101b":"plt.figure(figsize=(10,8))\nplt.style.use('ggplot')\nsns.lmplot(x='alcohol', y='fixed acidity', data=df)","1f5b2cf0":"plt.figure(figsize=(8,5))\nsns.scatterplot(x='alcohol', y='volatile acidity', data=df)","87b79d38":"sns.set_style('whitegrid')\nsns.lmplot(x='alcohol', y='density', data=df, hue='type', aspect=2.5, height=4)","6d0a3254":"sns.set_style('darkgrid')\nsns.lmplot(x='alcohol', y='chlorides', data=df, fit_reg=False, hue='type')","ececb5b3":"print('10 percent of the observations are having a alcohol percentage under:', df['alcohol'].quantile(0.1))\nprint('\\n')\nprint('25 percent of the observations are having a alcohol percentage under:', df['alcohol'].quantile(0.25))\nprint('\\n')\nprint('50 percent of the observations are having a alcohol percentage under:', df['alcohol'].quantile(0.50))\nprint('\\n')\nprint('99 percent of the observations are having a alcohol percentage under:', df['alcohol'].quantile(0.99))","aab89c26":"plt.figure(figsize=(15,8))\ndata = df.drop(['free sulfur dioxide', 'total sulfur dioxide', 'quality','residual sugar', \n                   'fixed acidity', 'alcohol', 'density', 'chlorides'], axis=1)\n\nsns.boxplot(data=data)","6f9018bb":"plt.figure(figsize=(12,8))\n\nsns.countplot(x='quality', data=df, hue='type')","0f640270":"plt.figure(figsize=(12,8))\n\nx = np.sort(df['alcohol'])\ny = np.arange(1, len(x)+1) \/ len(x)\n\nplt.plot(x, y, marker='.', linestyle='-.')\n\nplt.xlabel('alcohol percentage')\nplt.ylabel('ECDF')\nplt.grid(True)\nplt.show","637875ff":"print('The above ECDF plot shows that the major cummulation is happening between 0.1 t0 0.8:','\\n', df['alcohol'].quantile([0.1, 0.8]))","b6c786f2":"sns.violinplot(df['alcohol'])","e3759e2b":"plt.figure(figsize=(10,8))\nsns.set_style('darkgrid')\nsns.jointplot(x='alcohol', y='sulphates', data=df)","1cc685d4":"plt.figure(figsize=(12,8))\nplt.style.use('ggplot')\nmean = df['alcohol'].mean()\none_dev = df['alcohol'].std()\n\nsns.distplot(df['alcohol'], bins=10, kde=True)\n\nplt.axvline(mean, color='green', label='Mean')\nplt.axvline(mean-one_dev, color='blue', label='lower limit')\nplt.axvline(mean+one_dev, color='blue', label='upper limit')\n\nplt.legend()","0cf2f3ff":"plt.figure(figsize=(12,8))\nsns.heatmap(df.corr(), cmap='coolwarm')","9b50a25d":"df.isnull().sum()","f0291f0e":"df['fixed acidity'] = df['fixed acidity'].fillna((df['fixed acidity'].mean()))\ndf['volatile acidity'] = df['volatile acidity'].fillna((df['volatile acidity'].mean()))\ndf['citric acid'] = df['citric acid'].fillna((df['citric acid'].mean()))\ndf['residual sugar'] = df['residual sugar'].fillna((df['residual sugar'].mean()))\ndf['chlorides'] = df['chlorides'].fillna((df['chlorides'].mean()))\ndf['pH'] = df['pH'].fillna((df['pH'].mean()))\ndf['sulphates'] = df['sulphates'].fillna((df['sulphates'].mean()))","eff41631":"df.isnull().sum()","3285ee8a":"sns.boxplot(df['quality'])","d9cac6b5":"df['quality'] = ['good' if x >= 6 else 'bad' for x in df['quality']]","278b32d1":"df.info()","910b5d44":"df['quality'].value_counts()","82d93693":"df.select_dtypes(['object']).columns  #checking for the categorical columns in the dataset","8cc744fb":"#making sure to avoid the multi-variable trap or to avoid encoding the duplicate information\ndummies = pd.get_dummies(df['type'], drop_first=False)   \n\n\n#now we got the encoded columns so no need to have the original categorical column in the dataset\ndf = df.drop(['type'], axis=1)","f66a4cca":"df = pd.concat([df, dummies], axis=1)\n\ndf.head()","de77c9a7":"df.select_dtypes(['object']).columns","3715218c":"X = df.drop(['quality'], axis=1).values\n\ny = df['quality'].values\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.20, random_state=101)","ba688006":"scaler = RobustScaler()\n\nX_train = scaler.fit_transform(X_train)\nX_test = scaler.transform(X_test)","0db27e9c":"X_train","4b4af0e2":"X_train.shape","b783d3c4":"X_test","e4f79fdf":"y_train","1d5dd197":"y_test","eb02dc00":"rfc = RandomForestClassifier(n_estimators=200)\n\nrfc.fit(X_train, y_train)","4d9afa0d":"predictions = rfc.predict(X_test)","c90d93c4":"print(classification_report(y_test, predictions))","463f5a5d":"print(confusion_matrix(y_test, predictions))","ec1905e0":"random.seed(101)\nrandom_ind = random.randint(0,len(df))\n\nnew_wine = df.drop('quality', axis=1).iloc[random_ind]\n\nnew_wine","5f3ff6ba":"new_wine.values.reshape(1,13)","cbcd5c04":"new_wine = scaler.transform(new_wine.values.reshape(1,13))","4be4416e":"rfc.predict(new_wine)","ded1a53f":"df.iloc[random_ind]['quality']","77e252e1":"###### The green vertical line tells that mean of the alcohol percentage is around 10.4 and the two blue vertical lines are 1 standard deviation away from the mean\n","5f7dbd47":"## Testing the model:\n\n\n### So given a wine below, would you able to classify it as good or bad?","a443a9ac":"## Converting the dependent variable into a binary output varibale:","76be17a7":"###### The above plot illustrates that most no. of observations are having volatile acidity values between 0.2 to 0.8 whereas the most no. of observations are having alcohol percentage values between 9 to 11","dd9ea46f":"------------\n## Descriptive Statistics:","b4cbb0a5":"## Histogram:","19f86138":"## Violin plot:","6f7d3281":"###### Now we can see last two columns are Red wine and White wine respectively which are encoded with dummy variables","c2631dda":"----------------------------------------------------------------\n\n## Data Cleaning:\n\n### Checking for Null values:","c79fa8d9":"## Model Building:","b791b1c2":"###### There is a bump at alcohol percentage values of around 9.5 which means more no. of observations in the dataset are having a alcohol percentage of around 9.5","55b7b0c3":"###### It is clear that for most no. of observations chlorides value of red wine is greater than the white wine and there is a downward trend for chlorides values with respect to the alcohol percentages for both the wines\n------------------","20726ea9":"###### Lets transform the new_wine in order for the values to be on the similar scale of the training data that the model was trained on","eb60ec72":"###### It is very clear that most of the observations (around 1700) in our dataset are having a alcohol percentage of around 10 and only a few observations are having a alcohol percentage of less than 9 and greater than 13","6c3e2b8e":"## Train\/Test Split:","a98d1ad8":"## Evaluating the model:","1931f69a":"###### It shows that the most no. of observations of white wine are having a quality rank of 6 whereas the most no. of observations of red wine are having a quality rank of 5\n\n----------------","ee84c204":"###### So from the above box plot, lets consider the quality above 3rd quartile as good i.e., if quality greater than 6 its good or else bad","f67792b3":"###### More information on:[Confusion_matrix](https:\/\/www.dataschool.io\/simple-guide-to-confusion-matrix-terminology\/#:~:text=A%20confusion%20matrix%20is%20a,related%20terminology%20can%20be%20confusing.)","230943ca":"###### It looks like all the four variables shown above are having outliers and 50% of observations are having a pH value between 3.1 to 3.4 approximately\n-------------","793290cb":"###### The big vertical lines at an alcohol percentage values between 9.2 to 10 approximately tells that most no. of observations are having an alcohol percentage between 9.2 to 10","fcba56de":"### Since the no. of null values are very less we can just replace them with mean of their columns:","cbeb7cb3":"![alt text](https:\/\/img.onmanorama.com\/content\/dam\/mm\/en\/food\/in-season\/images\/2019\/11\/8\/wine.jpg.transform\/onm-articleimage\/image.jpg)\n\n\n###### Source: [Red&White_Wines](https:\/\/www.google.com\/url?sa=i&url=https%3A%2F%2Fwww.onmanorama.com%2Ffood%2Frecipe%2F2019%2F11%2F08%2Fred-white-wine-christmas-recipe.html&psig=AOvVaw1XPJGc_gEthKcdfvitMHAC&ust=1614475738288000&source=images&cd=vfe&ved=0CAIQjRxqFwoTCMCJ_vn0iO8CFQAAAAAdAAAAABAO)","ede8588f":"## Joint Distribution plot:","98f92b49":"## Categorical Encoding:\n\n##### Its better to use Dummy values approach for encoding the categorical columns as it gives the flexibility to encode as many categorical variables as we would want to and also gives the freedom to label the encoded columns using a prefix","6b651234":"##### We must make sure that new_wine is an numpy array and also to be in the same shape of the training data that the model was trained on ","16279bca":"**Most frequent alcohol percentage values:**","f808b507":"###### df.describe() gives the descriptive statistics of all the numerical columns of the dataset","46343157":"### Now lets check our model prediction on the new_wine provided:","2822b81c":"## Creating Empirical Cummulative Distribution Function (ECDF):","8b1f213d":"### Now lets check whether the actual quality of the new_wine provided is 'good' or 'bad':","719ab773":"## Correlation Matrix:","6d0258fe":"###### Now there are two categorical columns in our data: type and quality","8471adec":"###### It is clear that more no. of observations are having a alcohol percentage at around 9.5 whereas more no. of observations are having a sulphates value at around 0.5","375ecabb":"## Mean and Standard deviation:","74c0fd6d":"## Scaling:\n\n##### Since we have many outliers, its better to use RobustScaler which scales the data based on quartiles range by excluding the outliers from scaling parameters like IQR, First Quartile etc., whereas the MinMaxScaler and the StandardScaler methods are very sensitive to outliers and thus will not help us to boost the performance of the model","ac1a50ea":"## Percentiles:","74830383":"### So our model predicted that the quality of the new_wine provided is 'good'","6f717c23":"###### It shows that the dependant variable quality is highly correlated with alcohol percentage of the wine i.e., if the alcohol percentage is more then the quality rank of the wine will be higher","5c6a246c":"## Load the Data:","17846ab8":"### Great!!! The actual quality of the new_wine provided is also 'good'","f69c1b91":"###### There are 6497 rows and 13 columns. But the last column named as quality is considered to be the dependant variable","caab8098":"----------------------------------\n## Overview:\n\n###### 1) I never drank wine in my entire life but I am always curious to know what makes a good wine. So, I decided to apply some machine learning techniques to know what makes a good wine\n\n###### 2) In this project, I used UCI machine learning repository's wine quality dataset  [winequality](https:\/\/archive.ics.uci.edu\/ml\/datasets\/wine+quality) to perform Exploratory Data Analysis on both Red and white wines.\n\n###### 3) Later I will build a classification model to predict whether on not the quality of a particular wine is good\n\n###### 4) To classify the quality to be either good or bad, I converted the dependent variable to a binary output variable i.e., if the rank of quality of the wine is greater than or equals to 6 it is considered to be a good quality wine\n\n###### 5) The dependent variable: quality of wine is determined by 12 independent variables \n----------------------","43f38c6d":"###### It is clear that for most no. of observations density of red wine is greater than the density of white wine and for both wines the density is having a downward trend with respect to the alcohol percentage","09fa6497":"## Count plot:","91ceb069":"-------------------\n## EDA through Visualization:\n\n- Histogram plots\n- Scatter plots\n- Percentiles\n- Boxplots\n- Count plots\n- Empirical Cumulative Distribution Function\n- Violin\n- Heatmaps\n- Barplots\n- Joint Distribution plots\n- Distribution plots\n- Correlation Matrix\n--------------------","a8930092":"## Importing the Libraries and packages:","3334bd52":".................................\n## Scatter plot:","9d246752":"# Exploratory Data Analysis and Wine Quality Prediction\n\n###### Dataset contains information related to red and white variants of the Portuguese wine named as 'Vinho Verde'.\n\n###### Dataset repository: [Winequality](https:\/\/archive.ics.uci.edu\/ml\/datasets\/wine+quality)\n\n###### Red and White wine dataset: [Red&White](https:\/\/raw.githubusercontent.com\/rajeevratan84\/datascienceforbusiness\/master\/winequalityN.csv)","312ca97c":"###### So the graph illustrates that there is a downward trend for fixed acidity with respect to alcohol percentage i.e., if the alcohol percentage is increasing then the fixed acidity value goes down","f7d9bb87":"###### So it is very clear from the grpah that the most no. of observations are having a alcohol percentage of around 10. The continuous curve is a kernel density estimation curve which replaces every single observation with a Gaussian ditribution centered around that value","ac9349af":"--------------\n## Boxplot and Outliers:\n\n![alt text](https:\/\/pro.arcgis.com\/en\/pro-app\/help\/analysis\/geoprocessing\/charts\/GUID-0E2C3730-C535-40CD-8152-80D794A996A7-web.png)\n\n\n**Maximum = (Q3 + (1.5*IQR))**\n\n**Minimum = (Q1 - (1.5*IQR))**"}}