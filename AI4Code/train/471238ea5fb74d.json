{"cell_type":{"9665a005":"code","c83f0a93":"code","566b8c95":"code","08468953":"code","a1b28516":"code","ab944d88":"code","bb9c49c7":"code","fbeeacde":"code","7c4a31aa":"code","d6a20418":"code","f89f031f":"code","39cf36f5":"code","8b064d85":"code","4ad9c671":"code","6d8a1a0f":"code","6363cb81":"code","4bbc514a":"code","a7da4d3a":"code","cf0fae58":"code","4e8b7fb4":"code","3324ae14":"code","55f4b9fb":"code","dbb3e1e9":"code","e8d17d39":"code","3c6cc468":"code","c1bf4ccf":"code","d884ddf2":"code","f87ddadd":"code","3ddea654":"code","817740ce":"code","a7c6fbdf":"code","9b99ffc9":"code","7a2a8f5a":"code","95390fa9":"code","72617047":"code","7476aa47":"code","e2630715":"code","3a75022b":"code","1ea8908b":"code","de75a93f":"code","35c44618":"code","5e268d37":"code","76bb31a5":"code","d8bdf52d":"code","6086d88c":"code","222b3c95":"code","3c4e5a43":"code","fad12ad1":"code","2be5ea00":"code","8d4a78f7":"code","80fedbed":"code","c9c0890b":"code","ceb10423":"code","341693e9":"code","75bd2815":"code","9ad1f0c9":"code","5a95dd65":"code","ee79540f":"code","adc8608b":"code","d23cc5d8":"code","633cca88":"code","052ca46d":"code","29fa9ab4":"code","38350cda":"code","3aa88d5a":"code","691c46fa":"code","3f220b75":"code","2ff5e91d":"code","6db90799":"code","70ca33a6":"code","fe30fb94":"code","b236bd7e":"code","54c1906c":"code","9a7e24cb":"code","53429c19":"code","d66c9797":"code","22853dfa":"code","ef9e6c86":"code","8a779d2b":"code","b308c88a":"code","544bf0ef":"code","5650d4e6":"code","55496477":"code","52c08334":"code","1fe4fab1":"code","1700f3ab":"code","36697b6e":"code","313a0452":"code","82972897":"code","b0cca50e":"code","34ad568f":"code","38561a7e":"code","ed0a39ca":"code","0e89e089":"code","010544bd":"code","b019095c":"code","f4b4e6a0":"code","d18e2e7f":"code","ebbc0f32":"code","384a997a":"code","1ef04343":"code","49796922":"code","98eb3bea":"code","99b461ca":"markdown","c4bf573d":"markdown","9c720276":"markdown","d5636898":"markdown","424f1005":"markdown"},"source":{"9665a005":"import numpy as np \nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nimport warnings \nwarnings.filterwarnings(\"ignore\") #this is used to eliminate all the warnings that result while coding","c83f0a93":"import missingno as msno","566b8c95":"df = pd.read_csv('\/kaggle\/input\/heart-attack-analysis-prediction-dataset\/heart.csv')\n#\/kaggle\/input\/heart-attack-analysis-prediction-dataset\/heart.csv\n","08468953":"df.sample(10)","a1b28516":"#I am not going to go through every and each columns and explorate it .. as its already shown in the description of this data set.\n#But please put in cosideration that undersating your columns meaning is so important","ab944d88":"df.shape #mm its a small dataset actually ","bb9c49c7":"msno.matrix(df)","fbeeacde":"#Great.. No missing data ","7c4a31aa":"#lets check the output distribution here \n\nsns.countplot(data = df , x = 'output')","d6a20418":"#am going to use pivotes so I will be in need to a unique columns , unfortunately this data set doesnot have one so am gonna create it:\n\ndf['index'] = df.index.values","f89f031f":"pd.pivot_table(df , values = 'index' , columns = 'output' ,aggfunc='count')","39cf36f5":"#you can cosider it as balanced output","8b064d85":"df.sample(10)","4ad9c671":"df.info()","6d8a1a0f":"cat_features = ['sex' , 'cp' , 'fbs' , 'restecg' , 'exng' , 'slp' , 'caa' , 'thall','output']","6363cb81":"#simpty the rest are the numeric features -> foreach element not in cat and not the 'index' \nnum_features = [item for item in df.columns if item != 'index' and item not in cat_features]","4bbc514a":"for feature in cat_features:\n    cat = df[feature].value_counts()\n    sns.barplot(cat.index , cat , palette = 'magma') # cuz I love magma scheme =D\n    plt.title(feature + \" distribution\")\n    plt.show()","a7da4d3a":"for feature in num_features:\n    df[feature].hist() \n    plt.title(feature + \" distribution\")\n    plt.show()","cf0fae58":"#as you may noticed some of the features are not normally distributed or may not even close to normal distrubition .. so put in mind the starndarization when using regression [Line , logistic]","4e8b7fb4":"plt.figure(figsize = (18 , 8))\nsns.heatmap(df.corr() , annot = True )","3324ae14":"#I dont know I think the correlation is a little bit missy I am going to split it more inot categorical and numberical","55f4b9fb":"plt.figure(figsize = (15 , 8))\nsns.heatmap(df[cat_features].corr() , annot = True )","dbb3e1e9":"output_with_num = num_features.copy()\noutput_with_num.append('output')","e8d17d39":"output_with_num","3c6cc468":"df[output_with_num].corr()","c1bf4ccf":"plt.figure(figsize = (15 , 8))\nsns.heatmap(df[output_with_num].corr() , annot = True )","d884ddf2":"df.columns","f87ddadd":"\"\"\"\nage : Age of the patient\n\nsex : Sex of the patient\n\ncp : Chest Pain\n\ntrtbps : resting blood pressure (in mm Hg)\n\nchol : cholestoral in mg\/dl\n\nfbs : fasting blood sugar\n\nrestecg : resting electrocardiographic results\n\nthalachh : Maximum heart rate\n\nexang: exercise induced angina\n\nold peak : Previous peak\n\nslp : Slope\n\ncaa: number of major vessels\n\noutput : 0= less chance of heart attack 1= more chance of heart attack\n\n\"\"\"","3ddea654":"cat_features","817740ce":"#1. are heart attacks affected by sex ?\n#2. is chest pain shows any indication for heart attacks ?\n#3. if sex plays a role does it also has any relation with the chest pain?\n#4. what do you think the relation between fasing blood sugar with the heat attacks ?\n#5. what is the relation between heart attacks and resting electrocardiographic results?\n#6. excersie exang with the heart attacks ?\n#7. does Slope plays any role showing a possibility of a heat attack? \n#8. Slope with people who experienced heart attacks of different sex?\n#9. number of major vessels .. I think I works agaisnist heat attacks lets see what is our data answering this?\n#10. maximum heat reate how you can infer the effect with heat attacks ? \n#11. is there any possibility that maximum heat rate with the number of major vessels do any relation with heat attack?\n","a7c6fbdf":"#--- anserting \n#1. are heart attacks affected by sex ?\npd.pivot_table(df , columns = 'sex' , values = 'index' ,index = 'output',aggfunc = 'count')","9b99ffc9":"sns.countplot(data = df , x = 'sex' , hue = 'output' , palette = 'magma')","7a2a8f5a":"#hope you have found an answer .. ","95390fa9":"##2. is chest pain shows any indication for heart attacks ?\npd.pivot_table(df , columns = 'cp' , index = 'output', values = 'index' ,aggfunc = 'count')","72617047":"sns.countplot(data = df , x = 'cp' , hue = 'output' , palette = 'magma')","7476aa47":"#actually its so logical to find this kind of a relationship","e2630715":"#3. if sex plays a role does it also has any relation with the chest pain?\npd.pivot_table(df , columns = 'cp' , index = 'sex', values = 'index' ,aggfunc = 'count')","3a75022b":"sns.countplot(data = df , x = 'sex' , hue = 'cp' , palette = 'magma')","1ea8908b":"#seems like gender 1 majority does not experience chest pain","de75a93f":"cat_features","35c44618":"#4. what do you think the relation between fasing blood sugar with the heat attacks ?\npd.pivot_table(df , values = 'index' , index = 'output' , columns = 'fbs',aggfunc = 'count')","5e268d37":"sns.countplot(data = df , x = 'output' , hue = 'fbs' , palette = 'magma')","76bb31a5":"#fbs 0 id less likely to have heart attacks ","d8bdf52d":"#5. what is the relation between heart attacks and resting electrocardiographic results?\n#6. excersie exang with the heart attacks ?\n#7. does Slope plays any role showing a possibility of a heat attack? \n#8. Slope with people who experienced heart attacks of different sex?\n#9. number of major vessels .. I think I works agaisnist heat attacks lets see what is our data answering this?\n#10. maximum heat reate how you can infer the effect with heat attacks ? \n#11. is there any possibility that maximum heat rate with the number of major vessels do any relation with heat attack?\n","6086d88c":"#5. what is the relation between heart attacks and resting electrocardiographic results?\n","222b3c95":"pd.pivot_table(df , index= 'output' , columns = 'restecg' ,values = 'index',aggfunc = 'count')","3c4e5a43":"sns.countplot(data = df , x = 'output' ,hue = 'restecg' , palette = 'magma')","fad12ad1":"#resting electrocardiographic  with value = 1 is the most noted here for experiece a heartattack","2be5ea00":"#6. excersie exang with the heart attacks?\npd.pivot_table(df , index = 'output' , columns = 'exng' , values = 'index'  , aggfunc = 'count')","8d4a78f7":"sns.countplot(data = df , x = 'output' , hue = 'exng' , palette = 'magma')","80fedbed":"#7. does Slope plays any role showing a possibility of a heat attack? \npd.pivot_table(df , values = 'index' , index = 'output' , columns = 'slp' , aggfunc = 'count')","c9c0890b":"sns.countplot(data =df , x = 'output' , hue = 'slp' , palette='magma')","ceb10423":"#slp f value 2 more likely to experience heat attack.","341693e9":"#8. Slope with people who experienced heart attacks of different sex?\npd.pivot_table(df[df['sex'] == 1] , values = 'index' , index = 'output' , columns = 'slp' , aggfunc = 'count')# for gender = 1\n","75bd2815":"sns.countplot(data =df[df['sex'] == 1] , x = 'output' , hue = 'slp' , palette='magma')","9ad1f0c9":"pd.pivot_table(df[df['sex'] == 0] , values = 'index' , index = 'output' , columns = 'slp' , aggfunc = 'count')# for gender = 0","5a95dd65":"sns.countplot(data =df[df['sex'] == 0] , x = 'output' , hue = 'slp' , palette='magma')","ee79540f":"#this really interting see how the slope with gender vaies the possibilties of having a heat attack","adc8608b":"cat_features","d23cc5d8":"#9. number of major vessels .. I think I works agaisnist heat attacks lets see what is our data answering this?\npd.pivot_table(df , values = 'index' , columns = 'caa' , index = 'output' , aggfunc = 'count')","633cca88":"sns.countplot(data = df , x = 'output' , hue = 'caa' , palette = 'magma')","052ca46d":"# mm number of major vesseslls inversely proportionate with the heatattack possibility","29fa9ab4":"#10. maximum heat rate ..how you can infer the effect with heat attacks ? \npd.pivot_table(df , values = 'index' , columns = 'thall' , index = 'output' , aggfunc = 'count')","38350cda":"sns.countplot(data = df , x = 'output' , hue = 'thall' , palette = 'magma')","3aa88d5a":"#thall 2 is more likely to have a heart attack ","691c46fa":"#11. is there any possibility that maximum heat rate with the number of major vessels do any relation with heat attack?\n","3f220b75":"unique_vessels = df.thall.unique()","2ff5e91d":"unique_vessels","6db90799":"for vessel in unique_vessels:\n    print(\"vessel value is \" + str(vessel))\n    print(pd.pivot_table(df[df['thall'] == vessel] , index = 'output' , columns = 'caa' , aggfunc = 'count' , values = 'index'))\n    print('-'*50)","70ca33a6":"for vessel in unique_vessels:\n    sns.countplot(data = df[df['thall'] == vessel] , x = 'output' , hue = 'caa' , palette = 'magma')\n    plt.title('vessel is ' + str(vessel))\n    plt.show()","fe30fb94":"\"\"\"\nsecond part : questions to answer regarding to the numeric data\n#12. how age effects the heart attack?\n#13. resting blood pressure and heart attack ?\n#14. I think cholestrol has a direct impact on the heart attack output?? lets try to prove that..\n#15. Maximum heat reate relationship with the heart attack?\n#16. old peak how it would affect heart attack?\n\"\"\"","b236bd7e":"#12. how age effects the heart attack?\nsns.histplot(data = df ,x =  'age' , hue = 'output' )","54c1906c":"#the graph saying that the heat attack is more happening on the younger ages which is so weird lets take some samples to prove it!!\ndf[['output' , 'age']].groupby(by = 'age' ).mean()","9a7e24cb":"df[['output' , 'age']].groupby(by = 'output' ).mean()","53429c19":"#that was astonishing for me .. younger ages are more exposed to heart attack .. this may open the way for new assumptions .. \n#what if the these that old aged  are taking care of their helth thats why they esscaped this bad experience and vice versa ..","d66c9797":"#any ways this heat atacks are not depend on any mean on age factor","22853dfa":"#13. resting blood pressure and heart attack ?\nsns.histplot(data = df , x = 'trtbps' , hue = 'output')","ef9e6c86":"# our sample says that they are inversly correlated . but with a little bit search you can know that its not a fact.. and resting blood pressure is not a factor to take in consideration \\\n# for having a heart attack .. for more visit url :\n# https:\/\/www.healthline.com\/health\/blood-pressure-changes-during-heart-attack#:~:text=Blood%20pressure%20is%20not%20an,look%20at%20your%20overall%20symptoms.","8a779d2b":"#14. I think cholestrol has a direct impact on the heart attack output?? lets try to prove that..\nsns.histplot(data = df , x = 'chol' , hue = 'output')","b308c88a":"# no need for further investigation majority of the columns are saying what we thought .. proved =D","544bf0ef":"#15. Maximum heat reate relationship with the heart attack?\nsns.histplot(data = df , x = 'thalachh' , hue = 'output')","5650d4e6":"df[['output' , 'thalachh']].groupby('output').mean()","55496477":"# the more value of heat rate you have the more likely you may face a heart attack !! take care bro ","52c08334":"#16. old peak how it would affect heart attack?\n","1fe4fab1":"num_features","1700f3ab":"sns.histplot(data = df , x = 'oldpeak' , hue = 'output')","36697b6e":"# vlaues from oldpeack judge with no doubt that the more value the better ","313a0452":"#creating dummies","82972897":"df_dummies = pd.get_dummies(df)","b0cca50e":"#lets split our dataset\nfrom sklearn.model_selection import train_test_split","34ad568f":"x_train ,x_test = train_test_split(df_dummies,test_size = 0.2 , random_state = 42)","38561a7e":"from sklearn.linear_model import LogisticRegression\nfrom sklearn.ensemble import RandomForestClassifier \nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.naive_bayes import GaussianNB","ed0a39ca":"print('x_train : ' + str(x_train.shape)) \nprint('x_test : ' + str(x_test.shape))","0e89e089":"x_features = [feature for feature in df.columns if feature not in  ['output','index']]","010544bd":"x_features","b019095c":"lg_r = LogisticRegression()\nlg_r.fit(x_train[x_features] , x_train['output'])","f4b4e6a0":"y_predicted = lg_r.predict(x_test[x_features])","d18e2e7f":"y_predicted","ebbc0f32":"from sklearn.metrics import accuracy_score\n\nprint('logistic regression accurracy is  : ' + str(round(accuracy_score(x_test['output'],y_predicted)*100 , 2))+ '%')","384a997a":"rf_model = RandomForestClassifier()\nrf_model.fit(x_train[x_features] , x_train['output'])\ny_predicted = rf_model.predict(x_test[x_features])\nprint('RandomForest  accurracy is  : ' + str(round(accuracy_score(x_test['output'],y_predicted)*100 , 2))+'%')","1ef04343":"knn_model = KNeighborsClassifier()\nknn_model.fit(x_train[x_features] , x_train['output'])\ny_predicted = knn_model.predict(x_test[x_features])\nprint('KNN  accurracy is  : ' + str(round(accuracy_score(x_test['output'],y_predicted)*100 , 2)) + '%')","49796922":"gnb_model = GaussianNB()\ngnb_model.fit(x_train[x_features] , x_train['output'])\ny_predicted = gnb_model.predict(x_test[x_features])\nprint('Naive Bayes accurracy is  : ' + str(round(accuracy_score(x_test['output'],y_predicted)*100 , 2))+'%')","98eb3bea":"#as you can see the logistic regression and naive_bayes gave the best predictions \n#the whole dataset is a good proof for me that not all models are bad .. I have aloways thought that Random forest is the best\n# but as you can see its not the case for all cases ","99b461ca":"# Modeling","c4bf573d":"# Features Distrubutions and indentifications ","9c720276":"# Questions worth answering ?","d5636898":"# libraries ","424f1005":"# Data Exploration - make a relationship with the DATA \u2665"}}