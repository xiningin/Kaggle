{"cell_type":{"3ade74bf":"code","bf22426f":"code","dca31d6a":"code","7d60c2f4":"code","18212c65":"code","5c5a71c8":"code","09124aa6":"code","ec51a90d":"code","e0cd0fac":"markdown","1ebac3f8":"markdown","62c71a48":"markdown","9bc0907a":"markdown","dbca4bcd":"markdown","fa1ca953":"markdown","8b31d144":"markdown","d4fc368d":"markdown","541b13d4":"markdown"},"source":{"3ade74bf":"#import libraries\nimport pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport matplotlib.patches as mpatches\n\n#type 1 plot\n#create dataframe taking the data in the research\nage1=pd.DataFrame({'Age':['0-14','15-49','50-64','>64','0-14','15-49','50-64','>64','0-14','15-49','50-64','>64',],\n                  'Cases':['Nonsevere','Nonsevere','Nonsevere','Nonsevere','Severe','Severe','Severe','Severe','Lethal','Lethal','Lethal','Lethal'],\n                 'Numbers':[8,490,241,109,1,67,51,44,0,12,21,32]\n                })\n#set plot background and remove chart edges\nsns.set_style('whitegrid')\n\nsns.set_style( {'axes.spines.left': False,\n    'axes.spines.bottom': False,\n    'axes.spines.right': False,\n    'axes.spines.top': False})\n\n#create list of numbers from the research for further plotting\nnum=[9,557,292,153,9,557,292,153,9,557,292,153,9,557,292,153] \n\n#set plot size and create a barplot\nfig,ax=plt.subplots(figsize=(16,10))\nsns.barplot(age1['Age'],age1['Numbers'],ax=ax,hue=age1['Cases'],palette='GnBu')\n\n#add annotations\ncount=0\nfor p in ax.patches:\n    if count==1:\n        ax.annotate(format(p.get_height()\/num[count]*100, '.2f')+'%',(p.get_x() + p.get_width() \/ 2., p.get_height()), ha = 'center', va = 'center', xytext = (0, -6), textcoords = 'offset points',size=9)\n    elif count!=1:\n        ax.annotate(format(p.get_height()\/num[count]*100, '.2f')+'%',(p.get_x() + p.get_width() \/ 2., p.get_height()), ha = 'center', va = 'center', xytext = (0, 6), textcoords = 'offset points',size=9)\n    print(p.get_height(),' ',num[count])\n    count+=1\nax.set_ylabel('Ammount of Patients')\nax.set_xlabel('Age')\nax.set_title('Patients by Age')\nplt.legend(bbox_to_anchor=(1.05, 0.98))\nplt.show()\n\n","bf22426f":"#chart2\n#create data lists of info from the research\nlabels=['0-14','15-49','50-64','>64']\nsizes=[0.6,41.1,31.3,27]\n#color list to fill for different age groups\ncolors = ['#ff9999','#66b3ff','#99ff99','#ffcc99']\n\nfig1, ax1 = plt.subplots(figsize=(16,10))\ntheme = plt.get_cmap('PuBuGn')\nax1.set_prop_cycle(\"color\", [theme(1. * i \/ len(sizes))\n                             for i in range(len(sizes))])\n \nax1.pie(sizes, labels=labels, autopct='%1.1f%%', startangle=45)\nax1.axis('equal')  \nplt.title('Severe Patients by Age',fontsize=16)\nplt.legend(title='Age',labels=labels,)\n\nplt.show()\n\n","dca31d6a":"#pie chart 3\n\nlabels=['15-49','50-64','>64']\nsublabels=['17.91%','82.09%','41.18%','58.82%','72.73%','27.27%']\nc=plt.cm.PuBuGn                            \n\nsizes=[41.1,31.3,27.6]\nsizes_inner=[7.36,33.74,12.89,18.41,19.64,7.96]\n\nfig,ax=plt.subplots(figsize=(16,10))\nax.axis('equal')\n\nmypie,_=ax.pie(sizes,radius=1.3,colors=[c(0.1),c(0.5),c(0.9)],startangle=55,labels=labels)\nplt.setp(mypie, width=0.3,edgecolor='white')\nplt.subplots_adjust(top=0.9)\nplt.title('Severe Patients by Age\\n lethal cases by age group\\n                   \\n                   ',fontsize=15)\n\nmypie2,_=ax.pie(sizes_inner, radius=1.3-0.3,startangle=55,labels=sublabels,labeldistance=0.7,\n                colors=[c(0.7),c(0.3),c(0.7),c(0.3),c(0.7),c(0.3)])\nplt.setp(mypie2,width=0.4,edgecolor='white')\nplt.margins(0,0)\ndark_patch = mpatches.Patch(color=c(0.7),label='Died')\ndark1_patch = mpatches.Patch(color=c(0.3),label='Recovered')\nplt.legend(handles=[dark_patch,dark1_patch])\nplt.show()\n","7d60c2f4":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport matplotlib.patches as mpatches\n\nsns.set_style( {'axes.spines.left': False,\n    'axes.spines.bottom': False,\n    'axes.spines.right': False,\n    'axes.spines.top': False})\ngender=pd.DataFrame({'Gender':['0','1'],'Count':[459,637]})\n\nfig,ax=plt.subplots(figsize=(15,10))\nplt.scatter([2,3],[4,4],s=gender['Count']*35,alpha=0.7,edgecolors='black',linewidth=2,c=['#8e9609','#6d8de8'])\nplt.xlim(1,4)\n\nplt.annotate('41.9%',(1.95,4))\nplt.annotate('58.1%',(2.95,4))\nplt.annotate('Women',(1.9,4.08),fontsize=14)\nplt.annotate('Men',(2.9,4.08),fontsize=14)\nplt.xticks([])\nplt.yticks([])\nplt.title('Disease in Men vs Women',fontsize=16)\n","18212c65":"#chart 5\nsns.set_style('white')\nsns.set_style( {'axes.spines.left': False,\n    'axes.spines.bottom': True,\n    'axes.spines.right': False,\n    'axes.spines.top': False})\ng=pd.DataFrame({'f':[386,73,22,437],'m':[537,100,45,592]})\nlabelsf=['41.8%','42.2%','32.2%','42.5%']\nlabelsm=['58.2%','57.8%','67.2%','57.5%']\nyticksl=['Nonsevere','Severe','Died','Recovered']\n\n\nfix, ax = plt.subplots(1,2,figsize=(15,10),gridspec_kw={ 'wspace': 0.4})\nax[0].set_xlim(0,700)\nax[0].invert_xaxis()\nax[0].barh([4,3,2,1],g.f,color=sns.color_palette('bone'))\nax[0].set_yticklabels(' ')\nplt.yticks([])\nax[0].title.set_text('Women')\nnum=[926,173,67,1032]\ncount=0\nfor p in ax[0].patches:\n    ax[0].annotate(format(p.get_width()\/num[count]*100, '.2f')+'%',(p.get_width(),p.get_y() + p.get_height() \/ 2.), ha = 'center', va = 'center', xytext = (-25, -5), textcoords = 'offset points',size=10)\n    count+=1\n\n\n\nax[1].barh([4,3,2,1],g.m,color=sns.color_palette('pink'))\nax[1].set_xlim(0,700)\nplt.yticks([4,3,2,1])\n\nax[1].set_yticklabels(['Nonsevere      ','Severe        ','Died         ','Recovered    '],fontsize=12)\nax[1].title.set_text('Men')\nnum=[926,173,67,1032]\ncount=0\nfor p in ax[1].patches:\n    ax[1].annotate(format(p.get_width()\/num[count]*100, '.2f')+'%',(p.get_width(),p.get_y() + p.get_height() \/ 2.), ha = 'center', va = 'center', xytext = (25, -5), textcoords = 'offset points',size=10)\n    count+=1\n","5c5a71c8":"#chart 6\ndf=pd.DataFrame({'Status':['86.9% - Never smoked\\n nonsevere','1.3%\\n Former\\n smoker\\n non\\nsevere','11.8% - Current\\n smoker\\n nonsevere',\n                           '77.9% - Never smoked\\n severe','5.2%\\nFormer\\n smoker\\n severe','16.9% - Current\\n smoker\\n severe',\n                           '66.7% - Never smoked\\n lethal','7.6%\\nFormer\\n smoker\\n lethal','25.8% - Current\\n smoker\\n lethal',\n                           '86.7% - Never smoked\\n recovered','1.6% - Former\\n smoker\\n recovered','11.8% - Current\\n smoker\\n recovered'],\n                 'Numbers':[793,12,108,134,9,29,44,5,17,883,16,120]\n\n                 })\n\nimport squarify\nfig,ax=plt.subplots()\nfig.set_size_inches((25,15))   \nplt.rcParams.update({'font.size': 14}) \ncolors=['#632504','#a84b19','#db7f4d','#856e08','#d4b737','#f5dd76','#088239','#40c776','#aef5ca','#acdde3','#1c8f9e','#8ae2ed']\nsquarify.plot(df['Numbers'],label=df['Status'],color=sns.color_palette('BrBG')) \np1=mpatches.Patch(color=sns.color_palette('BrBG')[0],label='86.9% Never smoked')\np2=mpatches.Patch(color=sns.color_palette('BrBG')[1],label='1.3% Former smoker')\np3=mpatches.Patch(color=sns.color_palette('BrBG')[2],label='11.8% Current smoker')\n\np4=mpatches.Patch(color=sns.color_palette('BrBG')[3],label='77.9% - Never smoked')\np5=mpatches.Patch(color=sns.color_palette('BrBG')[4],label='5.2% Former smoker')\np6=mpatches.Patch(color=sns.color_palette('BrBG')[5],label='16.9% Current smoker')\nl1=plt.legend(handles=[p4,p5,p6],bbox_to_anchor=(1.,0.4),title='Among Severe 100%',fontsize=15)\n\n\np7=mpatches.Patch(color=sns.color_palette('BrBG')[0],label='66.7% - Never smoked')\np8=mpatches.Patch(color=sns.color_palette('BrBG')[1],label='7.6% Former smoker')\np9=mpatches.Patch(color=sns.color_palette('BrBG')[2],label='25.8 Current smoker')\nl2=plt.legend(handles=[p7,p8,p9],bbox_to_anchor=(1.,0.2),title='Among Died 100%',fontsize=15)\n\np10=mpatches.Patch(color=sns.color_palette('BrBG')[3],label='86.7% - Never smoked')\np11=mpatches.Patch(color=sns.color_palette('BrBG')[4],label='1.6% Former smoker')\np12=mpatches.Patch(color=sns.color_palette('BrBG')[5],label='11.8% Current smoker')\nl3=plt.legend(handles=[p10,p11,p12],bbox_to_anchor=(1.,0.7),title='Among Recovered 100%',fontsize=15)\n\n\n\nplt.legend(handles=[p1,p2,p3],bbox_to_anchor=(1.,1.),title='Among Nonsevere 100%' ,fontsize=15) \nplt.xticks([])\nplt.yticks([])   \nplt.title('Influence of Smoking on Disease Outcome',fontsize=20)    \nplt.gca().add_artist(l1)\nplt.gca().add_artist(l2)\nplt.gca().add_artist(l3)\nplt.show()\n    ","09124aa6":"    \n#chart 7\n\nsns.set_style('white')\nsns.set_style( {'axes.spines.left': False,\n    'axes.spines.bottom': False,\n    'axes.spines.right': False,\n    'axes.spines.top': False})   \n   \nfix, ax=plt.subplots(figsize=(20,10))\n\n#create dataframe with the necessary data from the research\n\"\"\"I decided to focus on the visual side of this plot and created x and y coordinates on my own\"\"\"\n\ndf=pd.DataFrame({'names':['Chronic obstructive pulmonary disease','Diabetes','Hypertension','Coronary heart disease',\n       'Cerebrovascular disease','Hepatitis B','Cancer','Chronic renal disease','Immunodeficiency'],\n'numbers':[1.1,7.4,15.0,2.5,1.4,2.1,0.9,0.7,0.2],\n'aa':[1200,8100,16500, 2700, 1500, 2300,1000,800,200],\n'x':[ 5.1, 2.4,   4.8, 4,   3.2,    2.6,   1.65, 3.1, 5.55],\n'y':[ 3.8, 5.5,   8.2, 3.6, 11.2,   9.2,   8.3,  2.7, 4.7] \n}) \ncolors=['#8e9609','#6d8de8', '#71b5c9',  '#71c9a1', '#0f732d','#8a5f94', '#871b56', '#87651b', '#873a1b']\n\n#create bubble charts with percentage distribution\nplt.scatter(df.x,df.y,s=df.aa*3,color=colors,linewidth=2,alpha=0.7)\nplt.barh(18,width=13,color='#73ebe1',alpha=0.6)\nplt.barh(18,width=3.1,color='#478f89',alpha=0.6)\n\n#add horisontal bars\nplt.barh(17,width=1.8,color='#2c393b')\nplt.barh(17,width=0.3,left=3.1,color='#2c393b')\n\n#add annotations\nax.text(1.9, 16.8,'58.2%',fontsize=10)\nax.text(3.5,16.8,'3%',fontsize=10)\nax.text(1.5,17.8,'23.7%',fontsize=10)\nax.text(8,17.8,'76.3%',fontsize=10 )\n\n#create legend\nno=mpatches.Patch(color='#73ebe1',label='Coexisting disorder present')\nyes=mpatches.Patch(color='#478f89',label='Coexisting disorder absent')\ndead=mpatches.Patch(color='#2c393b',label='Died')\nlegend1=plt.legend(handles=[no,yes,dead],loc='upper right')\n\nfor a,b in enumerate(df.numbers):\n    ax.text(df.x[a]-0.2,df.y[a]-0.2,str(b)+'%',fontsize=8)\n \none_patch = mpatches.Patch(color='#8e9609',label='Chronic obstructive pulmonary disease')\ntwo_patch = mpatches.Patch( color='#6d8de8',label='Diabetes')\nthree_patch = mpatches.Patch(color='#71b5c9',label='Hypertension')\nfour_patch = mpatches.Patch( color='#71c9a1',label='Coronary heart disease')\nfive_patch = mpatches.Patch(color='#0f732d',label='Cerebrovascular disease')\nsix_patch = mpatches.Patch( color='#8a5f94',label='Hepatitis B')\nseven_patch = mpatches.Patch(color='#871b56',label='Cancer')\neight_patch = mpatches.Patch( color='#87651b',label='Chronic renal disease')\nnine_patch = mpatches.Patch(color='#873a1b',label='Immunodeficiency')\n\n# create coordinates for the grey line depicting dead in the disorder group\nx=[4.7,5.5,1.55,3.2,3.75,5.8,3.55,4.5,2.85,3.55,2.35,2.8,1.45,1.85,3,3.2]\ny=[3.8,3.8,4,   4,  5.6, 5.6,2.7,2.7,10.6,10.6,8.1,8.1,7.6,7.6,2.2,2.2]\n\nn=2\nx_cut = [x[i * n:(i + 1) * n] for i in range((len(x) + n - 1) \/\/ n )]  \ny_cut=[y[i * n:(i + 1) * n] for i in range((len(y) + n - 1) \/\/ n )]\n\nfor a in range(0,len(x_cut)-1):\n    line1,=plt.plot(x_cut[a],y_cut[a],color='grey',linewidth=1,label='% of dead below the line')    \n    \n\n#coordinates for bubble plot in grey barplot\nx=[10,10,10,10,10,10,10,10]\ny=[1.5,3,5,6.7,8,8.7,9.5,10.5]\ns=[700,1800,2400,600,400,100,100,200]\ncolors=['#8e9609','#6d8de8', '#71b5c9',  '#71c9a1', '#0f732d','#8a5f94', '#871b56', '#87651b']\n\n#charts themselves\nplt.scatter(x,y,s=s,color=colors,linewidth=2,alpha=0.7)\nplt.bar(10,height=11,color='#2c393b',alpha=0.3,width=1.5,bottom=0.6)\ntext=['10.4%','26.9%','35.8%','9%','6%','1.5%','1.5%','3%']\nfor a in range(0,len(x)):\n    ax.text(x[a]+0.8,y[a]-0.2,text[a],fontsize=10)\n\nlabels=['58%','22%','14%','22%','27%','4%','10%','10%']\nx=[5.5, 1.5, 5.9, 4.4, 3.5,  1.8,  1,   2.7]\ny=[3 ,  3,   5.1, 2.1, 12.1, 10.1, 7.2, 1.6]\nfor a in range(0,len(x)):\n    ax.text(x[a],y[a],labels[a],fontsize=8)\n\n#create legend for line\nlegend2=plt.legend(handles=[line1],loc='lower left')\n\nax.text(1,14,'Coexisting disorders and percentage of dead \\n              per disorder',fontsize=16)\nax.text(8,14.5,'Coexising disorders among dead',fontsize=16)\n\nplt.xlim(0,20)\nplt.ylim(-1,21)\nplt.xticks([])\nplt.yticks([])\nplt.title('Coexisitng Disorders',fontsize=16) \nplt.legend(handles=[one_patch,two_patch,three_patch,four_patch,five_patch,six_patch,seven_patch,eight_patch,nine_patch],loc='lower right')\nplt.gca().add_artist(legend1)\nplt.gca().add_artist(legend2)\nplt.show()\n\n","ec51a90d":"#chart 8\n\n\n\n\nimport pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport matplotlib.patches as mpatches\n\n\n\nsns.set_style('white')\nsns.set_style( {'axes.spines.left': True,\n    'axes.spines.bottom': True,\n    'axes.spines.right': True,\n    'axes.spines.top': True})\n\ndf=pd.DataFrame({'x':[2,2,2,2,2,2,2,2,2,2,2],\n                'y':[637,393,31,204,454,25,56,15,19,144,55],\n                'treatment':[ 'Intravenous antibiotics 58%',\n                     'Oseltamivir 35.8%',\n                     'Antifungal medication 2.8%',\n                     'Systemic glucocorticoids 18.6%',\n                     'Oxygen therapy 41.3%',\n                     'Invasive mechanical ventilation 2.3%',\n                     'Noninvasive mechanical ventilation 5.1%',\n                     'Extracorporeal membrane oxygenation 0.5%',\n                     'Continuous renal-replacement therapy 0.8%',\n                     'Intravenous immune globulin 13.1%', \n                     'Admission to intensive care unit 5%']}\n                )\n\n#ax, fig=plt.subplots(figsize=(10,5))\ng = sns.FacetGrid(df, row='treatment',height=1, \n                  aspect=7)\ng.map(plt.bar,'x','y',color='pink');\ng.set_titles(\"{row_name}\",fontsize=7) \ng.despine(left=True,bottom=True)\ng.set_xlabels('')\ng.set_ylabels('')\ng.set_xticklabels('')\ng.set_yticklabels('')\ng.fig.subplots_adjust(hspace=0.5)\nplt.subplots_adjust(top=0.9)\ng.fig.suptitle('Treatment by Type in Percentages')\n\n","e0cd0fac":"# I would like to present visualizations based on research conducted by Chinese scientists in the beginning of 2020. This research was published in The New England Journal of Medicine. Please, see the link below https:\/\/www.nejm.org\/doi\/full\/10.1056\/NEJMoa2002032 .\n\nObjective of this project is to get visual representation of the scientists' findings such as:\n1. Distribution of the patients by age, severety and outcome of the disease.\n2. Focus on severe cases and study age groups and outcome.\n3. Sex distribution of the patients and disease outcome by sex.\n4. Influence of smoking on the disease outcome.\n5. Coexisting disorders and mortality rate among people having disorders.\n6. Distribution of treatment types.\n\n\nAs per abstrat from the research, it investigated medical records of 1099 patients and compiled the data into a table which you can find in research itself. \"Since December 2019, when coronavirus disease 2019 (Covid-19) emerged in Wuhan city and rapidly spread throught China, data have been needed on the clinical characteristics of the affected patients\". The visualisations below will help to understand the clinical picture of the disease and distribution among age groups and sex. ","1ebac3f8":"Among dead 26% percent were smokers and 7.6% were former smokers. 67% of people who died never smoked. People who recovered were mostly non smokers. Only 12% of recovered patients were smokers and 1.6% were former smokers. ","62c71a48":"As we can see, people at age 15-49 are the majority of the patients. However, looks like most of the patients aged 15-49 had a nonsevere version of the disease which did not require serious medical treatment. Still, there are numbers of dead in this age group as well. The least suffered from the disease children in the age group 0-15 - no dead and small number of sick people.","9bc0907a":"![](http:\/\/)Below you can see the chart with percentage distribution per sex. Almost 33% of the dead were women and two thirds were men. 58% of people in severe state were men vs 42% of women. Also, among those who recovered, the percentage proportion is approximately the same as among nonsevere patients. ","dbca4bcd":"Here we are going to lok into the coexisitng disorders and their contribution to complications. As we can see 23.7% of patients had coexising disorders mostly Hypertention (15% of all patients) and Diabetes (7.4% of all patients). However, presence of the coexisting disorder did not result in 100% death. As we can see in the chart, 14% of people with Hypertention died and 22% of people with Diabetes died. The biggest percentage of death is among people with chronic renal disease as 58% of people with this disease died. \n\nIt is necessary to take into consideration that many patients had few of these coexisting disorders which could contribute to the lethal outcome.\n\nAmong those who died only 58.2% had coexisting disorders. Hypertention, Diabetes and Chronic obstructive pulmonary disease make up the majority among the dead with coexisting disorder. ","fa1ca953":"When investigating the treatment, we can see that big amount of patients required a rather serious treatment such as Oxygen therapy (41.3%) and intravenous antibiotics (58%). This is the reason why medical system gets heavily overloaded when huge amoung of patients come at once as even nonsevere cases require doctors' attention and treatment. ","8b31d144":"Now let's take a deeper look at the severe patients. People at age 15-49 are the majority of this group as well. It means that even young people require serious medical attention and complicated treatment. So, although, it looked like in the previous chart that people at age 15-49 have mostly nonsevere form of the disease, the number of people at age 15-49 that suffer from this disease is so big that they make up the majority of the sick people.  ","d4fc368d":"The chart below shows the distribution of lethal cases per age group. Almost 73% of people at age higher than 64 die. The second place take people at age 50-64 as almost 42% of severe patients in this age group die. And 18% of younger severe patients die.","541b13d4":"41.9% of the patients were female."}}