{"cell_type":{"e94be859":"code","3b391681":"code","ca3660e9":"code","a423d27b":"code","2e17e4b0":"code","c2dad9c8":"code","d6d211b7":"markdown"},"source":{"e94be859":"import numpy as np\nimport pandas as pd","3b391681":"%%time\ntrain = pd.read_csv(\"..\/input\/train.csv\")\n\ny_train = train['scalar_coupling_constant']\ngroups = train['type']","ca3660e9":"def group_mean_log_mae(y_true, y_pred, groups, floor=1e-9):\n    maes = (y_true-y_pred).abs().groupby(groups).mean()\n    return np.log(maes.map(lambda x: max(x, floor))).mean()","a423d27b":"# zeros prediction\ngroup_mean_log_mae(y_train, 0, groups)","2e17e4b0":"# best possible prediction\ngroup_mean_log_mae(y_train, y_train, groups)","c2dad9c8":"%timeit group_mean_log_mae(y_train, y_train, groups)","d6d211b7":"### Check Speed"}}