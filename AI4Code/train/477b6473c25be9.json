{"cell_type":{"3f776830":"code","dcf8684a":"code","31851926":"code","a1c0e107":"code","45c28f09":"code","eadb9a45":"code","52955f31":"code","e1871e4f":"code","8fdffefd":"code","921efa22":"code","d98d7ee6":"code","4077f2ce":"code","52f92877":"code","838950e3":"code","e206e85f":"code","268c55b0":"code","313aa26e":"code","b8a6a719":"code","f1d491ef":"code","3d5ace11":"code","29243c3c":"code","5e735bae":"code","0304d846":"code","eeffd41b":"code","9b7a523a":"code","c3d529b0":"code","01f9d1a6":"markdown","5a5899b7":"markdown","d57039f1":"markdown","356c2696":"markdown"},"source":{"3f776830":"%matplotlib inline\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns","dcf8684a":"df=pd.read_csv('..\/input\/drug-classification\/drug200.csv')","31851926":"df.head()","a1c0e107":"df.isna().sum()","45c28f09":"df.describe(include='all')","eadb9a45":"plt.subplots(12,figsize=(14,6))\nplt.subplot(121)\nsns.distplot(df['Age'],color='pink')\nsns.despine()\nplt.xlim([10,80])\nplt.title('Age Distribution of Respondents')\n\nplt.subplot(122)\nsns.boxplot(y='Age',x='Drug',data=df)\nsns.despine()\nplt.title('Distribution of Age by Drug')","52955f31":"plt.subplots(12)\nplt.subplot(121)\ndf['Sex'].value_counts().plot(kind='pie')\nplt.title('Gender Distribution')\n\nplt.subplot(122)\npd.crosstab(index=df['Drug'],columns=df['Sex'],normalize='columns').plot(kind='bar')\n\n","e1871e4f":"plt.subplots(12,figsize=(14,6))\nplt.subplot(121)\ndf['BP'].value_counts().plot(kind='pie')\nplt.title('BP Distribution')\n\nplt.subplot(122)\npd.crosstab(index=df['Drug'],columns=df['BP'],normalize='columns').plot(kind='barh')\n","8fdffefd":"plt.subplots(12,figsize=(14,6))\nplt.subplot(121)\nsns.distplot(df['Na_to_K'],color='blue')\nsns.despine()\nplt.xlim([0,40])\nplt.title('Na_to_K Distribution of Respondents')\n\nplt.subplot(122)\nsns.boxplot(y='Na_to_K',x='Drug',data=df)\nsns.despine()\nplt.title('Distribution of NA_K by Drug')","921efa22":"df['Drug']=df['Drug'].astype('category')\ndf[\"Drug_codes\"] = df[\"Drug\"].cat.codes","d98d7ee6":"df","4077f2ce":"from sklearn.preprocessing import OneHotEncoder\ncat_variables=['Sex','BP','Cholesterol']\n#ohe=OneHotEncoder()\n#df=ohe.fit_transform(df[cat_variables].toarray())\ndf=pd.get_dummies(df,columns=cat_variables,drop_first=True)\n#df=pd.concat([df,dummies],axis=0)\n#dummies\n","52f92877":"df","838950e3":"from sklearn.linear_model import LogisticRegression\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.metrics import accuracy_score,classification_report,confusion_matrix","e206e85f":"X=df.drop(['Drug_codes','Drug'],axis=1)\ny=df['Drug_codes']\nX_train,X_test,y_train,y_test=train_test_split(X,y)","268c55b0":"lr=LogisticRegression()\nlr.fit(X_train,y_train)\ny_pred=lr.predict(X_test)\n","313aa26e":"print(classification_report(y_test,y_pred))","b8a6a719":"cm=confusion_matrix(y_test,y_pred)\nsns.heatmap(cm,annot=True,cmap='viridis',xticklabels=['drugY','drugA','DrugB','DrugC','DrugX'],yticklabels=['drugY','drugA','DrugB','DrugC','DrugX'])\n","f1d491ef":"from sklearn.svm import SVC\nsvc=SVC(kernel='linear')\nsvc.fit(X_train,y_train)\ny_pred=svc.predict(X_test)\nprint(classification_report(y_test,y_pred))","3d5ace11":"cm=confusion_matrix(y_test,y_pred)\nsns.heatmap(cm,annot=True,cmap='viridis',xticklabels=['drugY','drugA','DrugB','DrugC','DrugX'],yticklabels=['drugY','drugA','DrugB','DrugC','DrugX'])\n","29243c3c":"from sklearn.tree import DecisionTreeClassifier\ndc=DecisionTreeClassifier()\ndc.fit(X_train,y_train)\ny_pred=dc.predict(X_test)\nprint(classification_report(y_test,y_pred))","5e735bae":"cm=confusion_matrix(y_test,y_pred)\nsns.heatmap(cm,annot=True,cmap='viridis',xticklabels=['drugY','drugA','DrugB','DrugC','DrugX'],yticklabels=['drugY','drugA','DrugB','DrugC','DrugX'])\n","0304d846":"imp=dc.feature_importances_\nfeatures=['Age','Sodium to Potassium','Gender','Blood Pressure Low','Blood Pressure Normal','Cholestrol']\npd.DataFrame(imp,index=features).sort_values(by=0,ascending=False).plot(kind='barh')","eeffd41b":"from sklearn.ensemble import RandomForestClassifier\nrc=RandomForestClassifier()\nrc.fit(X_train,y_train)\ny_pred=rc.predict(X_test)\nprint(classification_report(y_test,y_pred))","9b7a523a":"imp=dc.feature_importances_\nfeatures=['Age','Sodium to Potassium','Gender','Blood Pressure Low','Blood Pressure Normal','Cholestrol']\npd.DataFrame(imp,index=features).sort_values(by=0,ascending=False).plot(kind='barh')","c3d529b0":"cm=confusion_matrix(y_test,y_pred)\nsns.heatmap(cm,annot=True,cmap='viridis',xticklabels=['drugY','drugA','DrugB','DrugC','DrugX'],yticklabels=['drugY','drugA','DrugB','DrugC','DrugX'])\n","01f9d1a6":"# There is some gender correlation with females preferring Drug Y & males preferring Drug B","5a5899b7":"# Majority of the people are between ages 35-40.Moreover, if we look at different drugs Drug A is suitable for younger people however for older people Drug B is more appropriate","d57039f1":"# Data Preprocessing","356c2696":"# Classification"}}