{"cell_type":{"a9a09049":"code","0213f167":"code","b3c50c39":"code","045d461c":"code","a99b9820":"code","b200ef1d":"code","8475a738":"code","05d91ad4":"code","39e6bd30":"code","614d397f":"code","10e7c1e3":"code","5ae97a7e":"code","6ca14b45":"code","102e64c6":"code","b26ad6d6":"code","55390bad":"code","8b0762bf":"code","2a782740":"code","51448564":"code","7800865d":"code","8f5ac884":"code","18bd59dc":"code","8da17978":"code","feb2cadf":"code","0d842899":"code","cdf71aab":"code","ca9904ef":"code","3034d6d2":"code","89a7cc0c":"code","08475b0d":"code","1b292fad":"code","c1131a3d":"code","ff6dfacb":"code","d3ac51f1":"code","19d50b99":"code","b8c655c8":"code","40a0e975":"code","53b5c97c":"code","c7026030":"code","6e6314fb":"code","5f5a2f69":"code","0d3d2897":"code","9ce7b6e9":"code","4c6bad6e":"code","d66e4da0":"code","61d59ba0":"code","2bbc3737":"code","93997021":"code","8c39de6f":"markdown","0c36ddd6":"markdown","cebea313":"markdown","b09f05fe":"markdown","6c7cbdba":"markdown","a718ea25":"markdown","5b9203b4":"markdown","b4c33f80":"markdown","a0ce2763":"markdown"},"source":{"a9a09049":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport plotly as pt","0213f167":"data = pd.read_csv('..\/input\/heart-attack-analysis-prediction-dataset\/heart.csv')\ndata.head()","b3c50c39":"data.describe().T","045d461c":"data[\"cp\"].value_counts()","a99b9820":"data.isnull().any()","b200ef1d":"plt.figure(figsize=(20,15))\n\nplt.subplot(4,4,1)\nsns.boxplot(data['age'])\n\nplt.subplot(4,4,2)\nsns.boxplot(data['sex'])\n\nplt.subplot(4,4,3)\nsns.boxplot(data['cp'])\n\nplt.subplot(4,4,4)\nsns.boxplot(data['trtbps'])\n\nplt.subplot(4,4,5)\nsns.boxplot(data['chol'])\n\nplt.subplot(4,4,6)\nsns.boxplot(data['fbs'])\n\nplt.subplot(4,4,7)\nsns.boxplot(data['restecg'])\n\nplt.subplot(4,4,8)\nsns.boxplot(data['thalachh'])\n\nplt.subplot(4,4,9)\nsns.boxplot(data['exng'])\n\nplt.subplot(4,4,10)\nsns.boxplot(data['oldpeak'])\n\nplt.subplot(4,4,11)\nsns.boxplot(data['slp'])\n\nplt.subplot(4,4,12)\nsns.boxplot(data['caa'])\n\nplt.subplot(4,4,13)\nsns.boxplot(data['thall'])\n\nplt.subplot(4,4,14)\nsns.boxplot(data['output'])","8475a738":"data[\"trtbps\"] = data['trtbps'].clip(lower=data['trtbps'].quantile(0),upper=data['trtbps'].quantile(0.70))","05d91ad4":"sns.boxplot(data['trtbps'])","39e6bd30":"data[\"chol\"] = data['chol'].clip(lower=data['chol'].quantile(0.2),upper=data['chol'].quantile(0.8))\n\nsns.boxplot(data['chol'])","614d397f":"data[\"fbs\"] = data['fbs'].clip(lower=data['fbs'].quantile(0.5),upper=data['fbs'].quantile(0.5))\n\nsns.boxplot(data['fbs'])","10e7c1e3":"data[\"thalachh\"] = data['thalachh'].clip(lower=data['thalachh'].quantile(0.3),upper=data['thalachh'].quantile(1))\n\nsns.boxplot(data['thalachh'])","5ae97a7e":"data[\"oldpeak\"] = data['oldpeak'].clip(lower=data['oldpeak'].quantile(0),upper=data['oldpeak'].quantile(0.5))\n\nsns.boxplot(data['thalachh'])","6ca14b45":"data[\"caa\"] = data['caa'].clip(lower=data['caa'].quantile(0),upper=data['caa'].quantile(0.8))\n\nsns.boxplot(data['caa'])","102e64c6":"data[\"thall\"] = data['thall'].clip(lower=data['thall'].quantile(0.4),upper=data['thall'].quantile(1))\n\nsns.boxplot(data['thall'])","b26ad6d6":"plt.figure(figsize=(20,15))\n\nplt.subplot(4,4,1)\nsns.boxplot(data['age'])\n\nplt.subplot(4,4,2)\nsns.boxplot(data['sex'])\n\nplt.subplot(4,4,3)\nsns.boxplot(data['cp'])\n\nplt.subplot(4,4,4)\nsns.boxplot(data['trtbps'])\n\nplt.subplot(4,4,5)\nsns.boxplot(data['chol'])\n\nplt.subplot(4,4,6)\nsns.boxplot(data['fbs'])\n\nplt.subplot(4,4,7)\nsns.boxplot(data['restecg'])\n\nplt.subplot(4,4,8)\nsns.boxplot(data['thalachh'])\n\nplt.subplot(4,4,9)\nsns.boxplot(data['exng'])\n\nplt.subplot(4,4,10)\nsns.boxplot(data['oldpeak'])\n\nplt.subplot(4,4,11)\nsns.boxplot(data['slp'])\n\nplt.subplot(4,4,12)\nsns.boxplot(data['caa'])\n\nplt.subplot(4,4,13)\nsns.boxplot(data['thall'])\n\nplt.subplot(4,4,14)\nsns.boxplot(data['output'])","55390bad":"f,ax = plt.subplots(figsize=(30,20))\ncorr = data.corr('pearson')\nsns.heatmap(corr,mask=np.zeros_like(corr,dtype=np.bool),cmap=sns.diverging_palette(220,10,as_cmap=True),square=True,ax=ax,annot=True)","8b0762bf":"data.columns","2a782740":"from sklearn.model_selection import train_test_split\nx = data.drop('output',axis=1)\ny = pd.DataFrame(data,columns=['output'])\nx.head()","51448564":"y.head()","7800865d":"x_train,x_test,y_train,y_test = train_test_split(x,y,test_size=0.2,random_state=42)\nx_train.shape,y_train.shape,x_test.shape,y_test.shape","8f5ac884":"from sklearn.linear_model import LogisticRegression\nL = LogisticRegression()","18bd59dc":"L.fit(x_train,y_train)","8da17978":"r_sq = L.score(x_train,y_train)\nprint('Coef of determination:',r_sq)","feb2cadf":"pred = L.predict(x_test)\nL.score(x_test,y_test)","0d842899":"print(\"Actual output:\\n\",list(y_test['output']))\nprint(\"Predicted output:\\n\",list(pred))","cdf71aab":"print(*[list(pred)[i] == list(y_test['output'])[i] for i in range(len(list(pred)))], sep=' ')","ca9904ef":"from sklearn.linear_model import SGDClassifier\nSGD = SGDClassifier()","3034d6d2":"SGD.fit(x_train,y_train)","89a7cc0c":"r_sq = SGD.score(x_train,y_train)\nprint(\"coef of determination:\", r_sq)","08475b0d":"pred = SGD.predict(x_test)\nSGD.score(x_test,y_test)","1b292fad":"print('Actual output:\\n',list(y_test['output']))\nprint('predicted output:\\n',list(pred))","c1131a3d":"print(*[list(pred)[i] == list(y_test['output'])[i] for i in range(len(list(pred)))], sep=' ')","ff6dfacb":"from sklearn.neighbors import KNeighborsClassifier\nKNN = KNeighborsClassifier(n_neighbors=3)","d3ac51f1":"KNN.fit(x_train,y_train)","19d50b99":"r_sq = KNN.score(x_train,y_train)\nprint('coef of determination:',r_sq)","b8c655c8":"pred = KNN.predict(x_test)\nKNN.score(x_test,y_test)","40a0e975":"print('Actual output:\\n',list(y_test['output']))\nprint('Predicted output:\\n',list(pred))","53b5c97c":"print(*[list(pred)[i] == list(y_test['output'])[i] for i in range(len(list(pred)))], sep=' ')","c7026030":"from sklearn.naive_bayes import GaussianNB\nGNB = GaussianNB()","6e6314fb":"GNB.fit(x_train,y_train)\nGNB.score(x_train,y_train)","5f5a2f69":"pred = GNB.predict(x_test)\nGNB.score(x_test,y_test)","0d3d2897":"print('Actual Output:\\n',list(y_test['output']))\nprint('Predicted Output:\\n',list(pred))","9ce7b6e9":"print(*[list(pred)[i] == list(y_test['output'])[i] for i in range(len(list(pred)))], sep=' ')","4c6bad6e":"from sklearn.ensemble import RandomForestClassifier\nRFC = RandomForestClassifier()","d66e4da0":"RFC.fit(x_train,y_train)\nRFC.score(x_train,y_train)","61d59ba0":"pred = RFC.predict(x_test)\nRFC.score(x_test,y_test)","2bbc3737":"print(\"Acutal output:\\n\",list(y_test['output']))\nprint(\"Predicted Output:\\n\",list(pred))","93997021":"print(*[list(pred)[i] == list(y_test['output'])[i] for i in range(len(list(pred)))], sep=' ')","8c39de6f":"## Prediction","0c36ddd6":"## SGD Classifier as SGD","cebea313":"## outliers\n### trtbps, chol, fbs, thalachh, oldpeak, caa, thall","b09f05fe":"## Gaussian Naive Bayes as GNB","6c7cbdba":"## Data Cleaning","a718ea25":"<table style=\"width:50%\">\n<tr>\n<th>Classifier<\/th>\n<th>Train Accuracy<\/th>\n<th>Test Accuracy<\/th>\n<\/tr>\n<tr>\n<td>Logistic Classifier<\/td>\n<td>85.95%<\/td>\n<td>86.88%<\/td>\n<\/tr>\n<tr>\n<td>Stochastic Gridient Descent Classifier<\/td>\n<td>64.87%<\/td>\n<td>77.04%<\/td>\n<\/tr>\n<tr>\n<td>K Nearest Neighbour Classifier<\/td>\n<td>78.51%<\/td>\n<td>80.32%<\/td>\n<\/tr>\n<tr>\n<td>Gaussian Naive Bayes Classifier<\/td>\n<td>84.71%<\/td>\n<td>86.88%<\/td>\n<\/tr>\n<tr>\n<td>Random Forest Classifier<\/td>\n<td>100%<\/td>\n<td>86.88%<\/td>\n<\/tr>\n<\/table>","5b9203b4":"## Random Forest Classifier as RFC","b4c33f80":"## Logistic Regression as L","a0ce2763":"## K-nearest Neighbours as KNN"}}