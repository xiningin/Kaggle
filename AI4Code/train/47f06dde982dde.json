{"cell_type":{"b0b3ff62":"code","f317add0":"code","02d2a232":"code","be73614d":"code","d5f7b02c":"code","31ed2d75":"code","2d573a26":"code","cd37c3ab":"code","2d7d0e8d":"code","be9a9672":"code","d20d09e0":"code","ce2d45ad":"code","daec0299":"code","af79f79a":"code","80b863ef":"code","8b0e3645":"code","8a9a730a":"code","86b92deb":"code","6524f914":"markdown","1b006716":"markdown","e7f91482":"markdown","02699870":"markdown","6a34aef7":"markdown","f2794746":"markdown","a0db147e":"markdown","5ddef102":"markdown","23628c30":"markdown","6256e9cf":"markdown","cc22bcf5":"markdown","01018ab8":"markdown","57f950b2":"markdown"},"source":{"b0b3ff62":"import numpy as np\nimport pandas as pd\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nfrom sklearn.compose import ColumnTransformer\nfrom sklearn.preprocessing import OneHotEncoder\n\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.metrics import r2_score","f317add0":"dataset = pd.read_csv('..\/input\/dissolved-inorganic-nitrogen-prediction\/River Sites Nutrient Levels.csv')","02d2a232":"dataset.head()","be73614d":"dataset['Water_electrical_conductivity'] = dataset['Water_electrical_conductivity'].fillna(dataset['Water_electrical_conductivity'].mean())","d5f7b02c":"plt.figure(figsize = (12,8))\nplt.title('DIN at respective regions')\nsns.stripplot(x = dataset['Region'], \n              y = dataset['Dissolved_inorganic_nitrogen'])\nplt.xlabel('Site on Swartkops River Estuary')\nplt.ylabel('Dissolved inorganic nitrogen (\u00b5g\/l)')\nplt.show()","31ed2d75":"plt.figure(figsize = (12,8))\nplt.title('DIP at respective regions')\nsns.stripplot(x = dataset['Region'],\n              y = dataset['Dissolved_inorganic_phosphorus'])\nplt.xlabel('Site on Swartkops River Estuary')\nplt.ylabel('Dissolved inorganic phosphorus (\u00b5g\/l)')\nplt.show()","2d573a26":"plt.figure(figsize = (8,8))\nplt.title('Relationship between physical properties and DIP')\ng = sns.scatterplot(x = dataset['Water_electrical_conductivity'], \n                y = dataset['Water_pH'],\n               hue = dataset['Dissolved_inorganic_phosphorus'])\ng.set(xlim=(0,2000),ylim=(0,10),xticks=[0,500, 1000, 1500], yticks=[0,2, 4, 6, 8, 10])\nplt.ylabel('Water pH')\nplt.xlabel('Electrical conductivity of water (S m-1)')\nplt.show()","cd37c3ab":"plt.figure(figsize = (10,10))\nplt.title('Relationship between physical properties and DIN')\nh = sns.scatterplot(x = dataset['Water_electrical_conductivity'], \n                y = dataset['Water_pH'],\n               hue = dataset['Dissolved_inorganic_nitrogen'])\nh.set(xlim=(0,2000),ylim=(0,10),xticks=[0,500, 1000, 1500], yticks=[0,2, 4, 6, 8, 10])\nplt.ylabel('Water pH')\nplt.xlabel('Electrical conductivity of water (S m-1)')\nplt.show()","2d7d0e8d":"# Create a matrix of features (x; independant variables) and a dependant variable vector (y)\nX = dataset.iloc[:, :-2].values\ny = dataset.iloc[:, -2].values","be9a9672":"print(X)","d20d09e0":"print(y)","ce2d45ad":"ct = ColumnTransformer(transformers = [('encoder', OneHotEncoder(drop = 'first'), [0])], remainder= 'passthrough')\nX = np.array(ct.fit_transform(X))","daec0299":"print(X)","af79f79a":"type(X)","80b863ef":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.2, random_state = 0)","8b0e3645":"regressor = RandomForestRegressor(n_estimators = 10, random_state = 0)\nregressor.fit(X_train, y_train)","8a9a730a":"y_pred = regressor.predict(X_test)\nnp.set_printoptions(precision=2)\nprint(np.concatenate((y_pred.reshape(len(y_pred),1),\n                      y_test.reshape(len(y_test),1)),1))","86b92deb":"r2_score(y_test, y_pred)","6524f914":"**IMPORT THE NECESSARYLIBRARIES**","1b006716":"**PREDICTING THE RESULTS**","e7f91482":"Found a null entry while scanning through the data.","02699870":"**EVALUATING THE ACCURACY**","6a34aef7":"**ENCODING THE CATEGORICAL DATA**","f2794746":"There appears to be an unnamed column in the dataset. This column must be dropped.","a0db147e":"Check the data ","5ddef102":"**IMPORT THE DATA**","23628c30":"**CREATE MATRIX OF FEATURES AND INDEPENDENT VARIABLE VECTOR**","6256e9cf":"**SPLITTING THE DATA**","cc22bcf5":"The large outliers in the dataset have made for this really low prediction accuracy. ","01018ab8":"**TRAINING THE RFR**","57f950b2":"The first coloumn of the independent variables contains categorical data."}}