{"cell_type":{"f7ddc1ce":"code","c24a8049":"code","ca54dd1f":"code","552c0287":"code","6bc5d941":"code","a6e2c5f1":"code","2108640e":"code","c925953f":"code","ef25b2ed":"code","df39734c":"code","95c7dcd1":"code","59ba7188":"code","01feb4b8":"code","5f2a2335":"code","bb1ea622":"code","cf60a1b4":"code","d03d09b8":"code","43906f8b":"code","6e707f3c":"code","fc461210":"code","7d40cec2":"code","985c2715":"code","dcd362d6":"code","23a650ca":"code","a7ba50a6":"code","a8bc67f5":"code","c365de70":"code","e8f19c63":"code","7d285b02":"code","4d940832":"code","6c526887":"code","6cf2c3f0":"code","e2b79f7f":"markdown","f3fe2f0d":"markdown","9d568ad5":"markdown","a942262a":"markdown","bb32456a":"markdown","d502867a":"markdown","14ec8cb2":"markdown","f0ceb85f":"markdown","81ac5450":"markdown","485454ac":"markdown","cb707b93":"markdown","4c7bcd25":"markdown","4b9132fd":"markdown","8f07ce57":"markdown","d05c285e":"markdown","e2ee7980":"markdown","a219909a":"markdown","db5a4cd4":"markdown","003a840c":"markdown","33a7588f":"markdown"},"source":{"f7ddc1ce":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","c24a8049":"# imports\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\nfrom wordcloud import WordCloud, STOPWORDS \nimport matplotlib.pyplot as plt","ca54dd1f":"df = pd.read_csv(\"\/kaggle\/input\/200000-jeopardy-questions\/JEOPARDY_CSV.csv\")","552c0287":"df.head()","6bc5d941":"df.info()","a6e2c5f1":"df[' Round'].unique()","2108640e":"sns.countplot(x=' Round',data=df)","c925953f":"df[df[' Round'] == 'Jeopardy!'].count()","ef25b2ed":"df[df[' Round'] == 'Double Jeopardy!'].count()","df39734c":"df[df[' Round'] == 'Final Jeopardy!'].count()","95c7dcd1":"df[df[' Round'] == 'Tiebreaker'].count()","59ba7188":"df[' Category'].nunique()","01feb4b8":"df.isnull().sum()","5f2a2335":"df[df[' Value'] == 'None']","bb1ea622":"df.drop(df[df[' Value'] == 'None'].index,inplace=True)","cf60a1b4":"df['ValueNum'] = df[' Value'].apply(\n    lambda value: int(value.replace('$', '').replace(',','')))","d03d09b8":"df['ValueNum'].head()","43906f8b":"df['ValueNum'].nunique()","6e707f3c":"def binning(value):\n    if value < 1000:\n        return np.round(value, -2)\n    elif value < 10000:\n        return np.round(value, -3)\n    else:\n        return np.round(value, -4)\n\ndf['ValueBins'] = df['ValueNum'].apply(binning)","fc461210":"df['ValueBins'].nunique()","7d40cec2":"df[' Question']","985c2715":"comment_words = '' \nstopwords = set(STOPWORDS) \n\nfor val in df[' Question']: \n      \n    val = str(val) \n    tokens = val.split() \n\n    for i in range(len(tokens)): \n        tokens[i] = tokens[i].lower() \n      \n    comment_words += \" \".join(tokens)+\" \"\n  \nwordcloud = WordCloud(width = 800, height = 800, \n                background_color ='white', \n                stopwords = stopwords, \n                min_font_size = 10).generate(comment_words) \n                     \nplt.figure(figsize = (8, 8), facecolor = None) \nplt.imshow(wordcloud) \nplt.axis(\"off\") \nplt.tight_layout(pad = 0) \n  \nplt.show() ","dcd362d6":"df_sample = df.sample(n=10000)","23a650ca":"X = df_sample[' Question']\ny = df_sample['ValueBins']","a7ba50a6":"from sklearn.feature_extraction.text import TfidfVectorizer\nfrom sklearn.ensemble import RandomForestClassifier\n\nRFC=RandomForestClassifier(max_features=\"sqrt\")\nparameters={ \"max_depth\":[5,8,25], \n             \"min_samples_split\":[1,2,5], \"n_estimators\":[800,1200]}\nfrom sklearn.model_selection import GridSearchCV\nclf = GridSearchCV(RFC, parameters)\nfrom sklearn.model_selection import train_test_split\n","a8bc67f5":"tfidf = TfidfVectorizer(stop_words='english')","c365de70":"X = tfidf.fit_transform(X)","e8f19c63":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33,random_state=1)","7d285b02":"clf.fit(X_train,y_train)","4d940832":"print(clf.cv_results_['params'])","6c526887":"print(clf.cv_results_['rank_test_score'])","6cf2c3f0":"print(clf.cv_results_['params'][-2])","e2b79f7f":"Dropping rows containing 'None' Values.","f3fe2f0d":"We can see that these are the best parameters from the parameter dict","9d568ad5":"### Building a Random Forest Model\nSince the data is huge, but for our convenience lets take 10,000 random samples from the dataframe","a942262a":"### Exploratory Data Analysis","bb32456a":"So, Now we have 21 different values to classify instead of 145","d502867a":"There are 27995 different unique categories in the 'Category' column","14ec8cb2":"So this is how we get the best parameters and we can use these parameters to train over the complete data to get the best results!","f0ceb85f":"The samples from category Jeopardy are 107384","81ac5450":"The 'Value' column has the string of the value which also contains $ sign and columns, so removing the signs and converting the string to interger value in a new column 'ValueNum'","485454ac":"There are no null values but some values in the 'Value' column are filled with the string 'None'.","cb707b93":"Lets see the countplot for each of these Round Type, we can clearly see that majority of the samples are from Jeopardy or Double Jeopardy, and very few from Final Jeopardy and almost negligible from Tiebreaker","4c7bcd25":"The samples from category Tiebreaker are only 3","4b9132fd":"checking unique values in the Round column, there are four unique values Jeopardy, Final Jeopardy, Double Jeopardy, Tiebreaker.","8f07ce57":"Binning the values if the value is smaller than 1000, then we round to the nearest hundred. Otherwise, if it's between 1000 and 10k, we round it to nearest thousand. If it's greater than 10k, then we round it to the nearest 10-thousand.","d05c285e":"We will use a Random Forest Classifier model with Grid Searching for finding the best hyperparameters from our dictionary of parameters","e2ee7980":"There are 145 unique values in the ValueNum column so it makes a lot of different categories to classify","a219909a":"The samples from category Final Jeopardy are 3631","db5a4cd4":"The samples from category Double Jeopardy are 105912","003a840c":"checking if there are any null values","33a7588f":"Lets just take a look at the 'Question' Column."}}