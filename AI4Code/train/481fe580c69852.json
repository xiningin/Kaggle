{"cell_type":{"df5c4cdd":"code","d8f4a2a0":"code","408ed465":"code","74223d3a":"code","7019fd93":"code","c0680c32":"code","deb7e54a":"code","c2d52df9":"code","eb9babc9":"code","c37a7f8b":"code","84d1d740":"code","d03cb06c":"code","4d3ec622":"code","482721ee":"code","bc964d56":"code","a0a8937f":"code","08ec7dff":"code","cabbf1d8":"code","6bbd3753":"code","1806b12b":"code","4020b1a7":"code","2526e5ad":"code","816be84a":"code","b69c9631":"code","f81c15d3":"code","66255237":"code","c604edc7":"code","a29234e7":"code","1d62265b":"code","059763b3":"code","b8098c8f":"code","f7ff09c5":"code","c0c62af5":"code","f0ff4397":"markdown","f0910d59":"markdown","1a187167":"markdown","f7251071":"markdown","bf387b81":"markdown","32c6ba89":"markdown","bace0d5d":"markdown","e1b46c17":"markdown","82d25968":"markdown","efd216a6":"markdown","f334cdd3":"markdown","7c90e084":"markdown","c086caa2":"markdown","e9f57f40":"markdown","ab6c61c4":"markdown","633e0fe7":"markdown","b11ce4ac":"markdown","a862e597":"markdown","288a53e4":"markdown","09fdd37d":"markdown","14d64021":"markdown","efbaad43":"markdown","12cb6760":"markdown","6a6a34af":"markdown"},"source":{"df5c4cdd":"# Import Library\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\nimport seaborn as sns\nfrom sklearn import metrics\nfrom sklearn.metrics import mean_squared_error\nimport matplotlib.pyplot as plt\nfrom sklearn import svm\n\n","d8f4a2a0":"df = pd.read_csv('..\/input\/avocado-prices\/avocado.csv', usecols=range(1,14))","408ed465":"df.head()","74223d3a":"# 8603.62 + 93.25 + 0\n1036.74 + 54454.85 + 48.16 + 8696.87","7019fd93":"df.shape","c0680c32":"df.isnull().sum()","deb7e54a":"len(df.region.unique())","c2d52df9":"df.groupby('region').size() ","eb9babc9":"plt.figure(figsize=(15,15))\n\nplt.title(\"Avgerage Price of Avocado by Region\")\n\nsns.barplot(x=\"AveragePrice\",y=\"region\",data= df)\n\nplt.show()","c37a7f8b":"print(len(df.type.unique()))\n\ndf.groupby('type').size()\n","84d1d740":"plt.figure(figsize=(5,7))\n\nplt.title(\"Avg.Price of Avocados by Type\")\n\nsns.barplot(x=\"type\",y=\"AveragePrice\",data= df)\n\nplt.show()","d03cb06c":"plt.figure(figsize=(12,6))\nsns.heatmap(df.corr(),cmap='coolwarm',annot=True)","4d3ec622":"# Specifying dependent and independent variables\n\nX = df[['4046', '4225', '4770', 'Small Bags', 'Large Bags', 'XLarge Bags', 'type', 'year', 'region']]\ny = df['AveragePrice']\ny=np.log1p(y)","482721ee":"X.head()","bc964d56":"y.head()","a0a8937f":"# X_labelled = pd.get_dummies(X[[\"type\",\"region\"]], drop_first = True)\n# X_labelled.head()\n\nX = pd.get_dummies(X, prefix=[\"type\",\"region\"], columns=[\"type\",\"region\"], drop_first = True)\nX.head()","08ec7dff":"X.columns","cabbf1d8":"from sklearn.model_selection import train_test_split ","6bbd3753":"X_train, X_valid, y_train, y_valid = train_test_split(X, y, test_size = 0.3, random_state = 99)","1806b12b":"X_train.shape, X_valid.shape, y_train.shape, y_valid.shape","4020b1a7":"from sklearn.linear_model import LinearRegression","2526e5ad":"lr = LinearRegression()\nlr.fit(X_train,y_train)\n\nprint(\"R2 of Linear Regresson:\", lr.score(X_train,y_train) )\nprint(\"----- Prediction Accuracy-----\")\nprint('MAE: ',metrics.mean_absolute_error(y_valid, lr.predict(X_valid)))\nprint('MSE: ',metrics.mean_squared_error(y_valid, lr.predict(X_valid)))\nprint('RMSE:',np.sqrt(metrics.mean_squared_error(y_valid, lr.predict(X_valid))))","816be84a":"# Creating a Histogram of Residuals\nplt.figure(figsize=(6,4))\nsns.distplot(y_valid - lr.predict(X_valid))\nplt.title('Distribution of residuals')\nplt.show()","b69c9631":"plt.scatter(y_valid,lr.predict(X_valid))","f81c15d3":"from sklearn.svm import SVR","66255237":"# clf = svm.SVR(kernel = 'linear')\n# clf.fit(X_train, y_train)\n# confidence = clf.score(X_train, y_train)\n# print(k,confidence)","c604edc7":"# for k in ['linear','poly','rbf','sigmoid']:\n#     print(\"Running for k as \", k)\n#     clf = svm.SVR(kernel=k)\n#     clf.fit(X_train, y_train)\n#     confidence = clf.score(X_train, y_train)\n#     print(k,confidence)","a29234e7":"svr = SVR(kernel='rbf', C=1, gamma= 0.5)   # Parameter Tuning to get the best accuracy\n\nsvr.fit(X_train,y_train)\nprint(svr.score(X_train,y_train))","1d62265b":"from math import sqrt ","059763b3":"# calculate RMSE\nerror = sqrt(metrics.mean_squared_error(y_valid,svr.predict(X_valid))) \nprint('RMSE value of the SVR Model is:', error)","b8098c8f":"# Creating a Histogram of Residuals\nplt.figure(figsize=(6,4))\nsns.distplot(y_valid - svr.predict(X_valid))\nplt.title('Distribution of residuals')\nplt.show()","f7ff09c5":"plt.scatter(y_valid,svr.predict(X_valid))","c0c62af5":"# Linear Regression RMSE : \nprint('RMSE value of the Linear Regr : ',round(np.sqrt(metrics.mean_squared_error(y_valid, lr.predict(X_valid))),4))\n\n# SVR RMSE               : \nprint('RMSE value of the SVR Model   : ',round(np.sqrt(metrics.mean_squared_error(y_valid, svr.predict(X_valid))),4))\n","f0ff4397":"# The average prices of avocados by types ","f0910d59":"# Class Imbalance Check\n## Region","1a187167":"## The average prices by regions","f7251071":"# Load Data","bf387b81":"Parameter Tuning or Hyperparameter\n\nIntuitively, the `gamma` defines how far the influence of a single training example reaches, with low values meaning \u2018far\u2019 and high values meaning \u2018close\u2019.\n\nThe `C` parameter trades off correct classification of training examples against maximization of the decision function\u2019s margin. \n\n* For larger values of `C`, a smaller margin will be accepted if the decision function is better at classifying all training points correctly. \n\n* A lower `C` will encourage a larger margin, therefore a simpler decision function, at the cost of training accuracy. \n\n* In other words `C` behaves as a regularization parameter in the SVM.","32c6ba89":"# Training the Model\n## Multiple Linear Regression ","bace0d5d":"Here we will try to compare the Linear Regression Model and SVR Model.\n\nFor us the target of this project is to predict the future price of avocados depending on some variables \/ features we have such as \n\n* Type     \n* Bags(4 units) vs Bundle(one unit)     \n* Region      \n* Volume      \n* Size     \n* Years","e1b46c17":"# Labeling the categorical variables","82d25968":"let's first choose the best kernel for our data out of provided kernels.","efd216a6":"As we already see the field descriptions, so for our training we are interested only in fields as below ","f334cdd3":"# Import Library","7c90e084":"## type","c086caa2":"# Check for Missing Data","e9f57f40":"## Observation :\nThere is a high correlation between pairs: \n* 4046 & total volume  (0.98)    \n* 4225 & total volume  (0.97)\n* 4770 & total volume  (0.87)\n* total bags & total volume  (0.96)      \n* small bags & total bags    (0.99) \n* etc\n\n* `4046` avocados are the most preferred\/sold type in the US and customers tend to buy those avocados as bulk, not bag.\n* Retailers want to increase the sales of bagged avocados instead of bulks. They think this is more advantageous for them.\n* Total Bags variable has a very high correlation with Total Volume (Total Sales) and Small Bags, so we can say that most of the bagged sales comes from the small bags.","ab6c61c4":"So '' is best for our data.","633e0fe7":"There are ~338 observations from each region, dataset seems balanced, and there are 54 regions.","b11ce4ac":"## Column Description\n\n* Date - The date of the observation   --> Will not be using this feature.\n* AveragePrice - the average price of a single avocado    --> Target\n* Total Volume - Total number of avocados sold (small Hass + Large Hass + XLarge Hass + Total Bags)\n* 4046 - Total number of avocados with PLU 4046 sold  (Small Hass)\n* 4225 - Total number of avocados with PLU 4225 sold  (Large Hass)\n* 4770 - Total number of avocados with PLU 4770 sold  (XLarge Hass)\n* Total Bags = Small Bags + Large Bags + XLarge Bags \n* type - conventional or organic\n* year - the year\n* Region - the city or region of the observation","a862e597":"`Types` of avocados are also balanced since the ratio is nearly 0.5 each.","288a53e4":"# Avocado Prices\n\nDataSet : https:\/\/www.kaggle.com\/neuromusic\/avocado-prices \n\nIt is a well known fact that Millenials LOVE Avocado Toast. It's also a well known fact that all Millenials live in their parents basements.\n\nClearly, they aren't buying home because they are buying too much Avocado Toast!\n\nBut maybe there's hope\u2026 if a Millenial could find a city with cheap avocados, they could live out the Millenial American Dream.","09fdd37d":"Observation : Seems there are some regions which are US States (say California) and US Cities (say San Francisco) of that State or just Cities. Also there is a region as \"TotalUS\"; \"West\".\n\nFor now lets leave them as is... but we could handle them.","14d64021":"# Compare RMSE","efbaad43":"# Correlation","12cb6760":"# Split into Train and Valid set","6a6a34af":"## SVR Regressor"}}