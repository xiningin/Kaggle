{"cell_type":{"b188d724":"code","423b2179":"code","a39c6e0c":"code","1c4fee94":"code","b068a260":"code","f6f21a25":"code","f67f0d10":"code","63f0e8d7":"code","cfd51b8b":"code","97a0056a":"code","a6043dce":"code","f422abec":"markdown","4b7dd815":"markdown","743bb8c0":"markdown","561468c5":"markdown","c8212e35":"markdown","e9e7ec0a":"markdown"},"source":{"b188d724":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","423b2179":"!pip install wildqat   \n!pip install pyitlib","a39c6e0c":"import numpy as np\nimport pandas as pd\nfrom pyitlib import discrete_random_variable as drv\nfrom sklearn.preprocessing import KBinsDiscretizer\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn import preprocessing\nimport wildqat as wq","1c4fee94":"def Mutual_Information(X):\n    return drv.information_mutual(X.T)\n    \ndef Identity_Matrix(NOF):\n    return np.identity(NOF)\n    \ndef Diagonal_Matrix(data,NOF):\n    D = np.zeros([NOF,NOF])\n    for i in range(NOF):\n        corr = np.corrcoef(data.iloc[:,i], data.iloc[:,NOF])\n        D[i,i]=corr[0,1]\n    return D\n    \ndef mRMR(D,M,NOF):       #-------- minimun Redundancy Maximum Relevance\n    return ((M\/NOF)-D)","b068a260":"file_path = '..\/input\/Vehicle.csv'","f6f21a25":"data = pd.read_csv(file_path)\ncol_no = len(data.columns)\nNOF = col_no - 1\nM = data.iloc[:,0:NOF]    ##----------- Data Matrix containing feature data\nM.values\n#print(M)    ","f67f0d10":"##########################################  Run this cell if feature scaling is required\nscaler = preprocessing.MinMaxScaler()\nM = scaler.fit_transform(M)\nprint(M)","63f0e8d7":"##########################################  Run this if the Class variable is categorical\nclass_label_encoder = LabelEncoder()\ndata.iloc[:,NOF]=class_label_encoder.fit_transform(data.iloc[:,NOF])","cfd51b8b":"enc = KBinsDiscretizer(n_bins=5,encode='ordinal')   \nM_binned = enc.fit_transform(M)\n#print(M_binned)\n    \n    \nD = Diagonal_Matrix(data,NOF)\n#print(type(D))\n\nMI = Mutual_Information(M_binned.astype(int))\nobj = mRMR(D,MI,NOF)\n#mRMR_qubo = pd.DataFrame(mRMR)\n#mRMR_qubo.to_csv(\"CMC_mi_mRMR_qubo.csv\")","97a0056a":"Result = []\nfor j in range(10):\n    a = wq.opt()\n    a.qubo = obj\n    answer = a.sa()\n    print('Solution of {}th iteration: '.format(j+1),answer)\n    Result.append(answer)","a6043dce":"cols = list(data.columns)\ncols.pop()\nfeatures = cols\n\n\n\ndf = pd.DataFrame(Result, columns = features)\n#df.to_csv('vehicle_mi_mRMR_sa_result.csv')\ndf","f422abec":"Mutual information will be calculated with integer values. So binning is required. Here we have hard coded the number of bins to 5. You may require to change the number for different dataset.","4b7dd815":"100 iterations are performed for statistical weight measure for the sake of accuracy checking.","743bb8c0":"## Here the operation is done with CMC data set from UCL Machine Learning repository.\n10 datasets are added. You can try with the other datasets also but a minimal modification will be required.\n\n","561468c5":"#### Here we have developed an objective function based on mRMR(minimum Redundancy Maximum Relevance) and Mutual Information is taken as the type of correlation.\n","c8212e35":"If you target variable then run the cell below. This assigns numrical values to catagorical data, which makes calculation possible. Otherwise we cannot get feature-class(target) **correlation values(D matrix)**.","e9e7ec0a":"These are the necessarry imports for the kernel. pyitlib is an MIT-licensed library of information-theoretic methods for data analysis and machine learning, implemented in Python and NumPy. Wildqat is an open source Python framework for QUBO. "}}