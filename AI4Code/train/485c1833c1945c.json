{"cell_type":{"fb79442e":"code","560d77bf":"code","cb35f61c":"code","d3084803":"code","a1b88d1e":"code","01f89d08":"code","1160f18d":"code","cc408de0":"code","fa8a3622":"code","3269cb2c":"code","5c1d3ec4":"markdown","11f4d71b":"markdown","115fc447":"markdown","f3a4b733":"markdown","4ca50524":"markdown","dce6bd52":"markdown"},"source":{"fb79442e":"%matplotlib inline\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport pandas as pd\nimport numpy as np\nimport numpy as np\nfrom datetime import datetime\n\nfrom matplotlib.pyplot import figure\n\nimport bq_helper\nfrom bq_helper import BigQueryHelper\n\npatents_research = bq_helper.BigQueryHelper(active_project=\"patents-public-data\",\n                                   dataset_name=\"google_patents_research\")\n\n# View table names under the patents data table\nbq_assistant = BigQueryHelper(\"patents-public-data\", \"google_patents_research\")\nbq_assistant.list_tables()\n\n# View the first three rows of the publications data table\n# bq_assistant.head(\"publications\", num_rows=3)\n\n# View information on all columns in the trials data table\n# bq_assistant.table_schema(\"publications\")","560d77bf":"query1 = \"\"\"\nSELECT \n  publication_description\n  ,COUNT(DISTINCT publication_number) as publications\nFROM\n  `patents-public-data.google_patents_research.publications`\nWHERE country LIKE 'CHINA'\n    AND publication_description LIKE 'Granted%'\nGROUP BY publication_description\nORDER BY publications DESC;\n        \"\"\"\n#bq_assistant.estimate_query_size(query1)\n\nresponse1 = patents_research.query_to_pandas_safe(query1,max_gb_scanned=6)\nresponse1","cb35f61c":"figure(num=None, figsize=(10, 6), dpi=80, facecolor='w', edgecolor='k')\nsns.set(context='poster', style='ticks', font_scale=0.6)\n\nax = sns.barplot(x='publication_description', y='publications', data=response1, color='grey')\n\nplt.title(\"Total patents granted to China\", loc='center')\nplt.ylabel('#Publications')\nplt.xlabel('')\nsns.despine();","d3084803":"query1 = \"\"\"\nSELECT \n    top_terms\nFROM\n  `patents-public-data.google_patents_research.publications`\nWHERE country LIKE 'CHINA'\n   AND publication_description LIKE 'Granted%invention%'\n;\n        \"\"\"\n#bq_assistant.estimate_query_size(query1)\n\ninventions = patents_research.query_to_pandas_safe(query1,max_gb_scanned=11)","a1b88d1e":"inventions = inventions[inventions.astype(str)['top_terms'] != '[]']\ninventions.sample(5)","01f89d08":"top_terms = pd.DataFrame(inventions[\"top_terms\"].tolist())\n\ntop_terms = pd.DataFrame(top_terms.values.flatten())\ntop_terms.columns = ['top_terms']\n\ntop_terms = top_terms.dropna(axis=0,how='all')\ntop_terms.shape","1160f18d":"# 9 millions terms\ntop_terms.sample(5)","cc408de0":"# 500k unique terms\ntop_terms.top_terms.nunique()","fa8a3622":"df_agg = pd.DataFrame(top_terms.groupby('top_terms')['top_terms'].count())\n\ndf_agg.columns = ['counter']\ndf_agg = df_agg.sort_values('counter', ascending=False)\ndf_agg = df_agg.head(30)\n\ndf_agg.tail(5)","3269cb2c":"figure(num=None, figsize=(6, 8), dpi=80, facecolor='w', edgecolor='k')\n\nsns.set(context='poster', style='ticks', font_scale=0.6)\n# Reorder it following the values:\nmy_range=range(1,len(df_agg.index)+1)\n\n# Create a color if the group is \"B\"\nmy_color=np.where(df_agg['counter'] >= 30000, '#5ab4ac', '#d8b365')\nmy_size=np.where(df_agg['counter'] >= 0, 70, 30)\n\n# The vertival plot is made using the hline function\n# I load the seaborn library only to benefit the nice looking feature\nplt.hlines(y=my_range, xmin=0, xmax=df_agg['counter'], color=my_color, alpha=1)\nplt.scatter(df_agg['counter'], my_range, color=my_color, s=my_size, alpha=1)\n\n# Add title and exis names\n\nplt.yticks(my_range, df_agg.index)\nplt.title(\"Top 30 most occuring terms\", loc='left')\nplt.xlabel('Number of occurances')\nplt.ylabel('')\nsns.despine();","5c1d3ec4":"## Total patents granted to China","11f4d71b":"## Frequently occuring salient terms ","115fc447":"# Just these 30 terms show us what areas is China focussing on \n\n## Interesting \"data\" ranks 12th","f3a4b733":"# Publications from China \ud83c\udde8\ud83c\uddf3\n\n### Continuing from our previous insights [**\"Published patents? 2011 China emerges as leader!\"**](https:\/\/www.kaggle.com\/dhimananubhav\/published-patents-2011-china-emerges-as-leader) lets deep-dive into publications from China\n\n","4ca50524":"Flatten to a single column ","dce6bd52":"## Lets only focus on \"Granted patent for invention\"\n\n### Selecting top 10 salient terms extracted from patent's title, abstract, claims and description."}}