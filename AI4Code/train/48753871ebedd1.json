{"cell_type":{"5e291c64":"code","f883df4d":"code","2f10d512":"code","1ae14345":"code","8845906c":"code","57be4bc3":"code","8138517b":"code","27b2bab7":"code","e7e41ad6":"code","b7777177":"code","f7acef3d":"code","04ff8c3f":"code","73b93a37":"code","9c7139df":"code","21ebd4c8":"code","9cd12d10":"code","8bce1453":"code","c638fc72":"code","f798083d":"code","3a29d9d5":"code","c3f3b530":"code","a423eb38":"code","92af7c79":"code","10e161b7":"code","8a4e2410":"code","65f19891":"code","643d75da":"code","1279d71a":"code","fbc5e78d":"code","ce4cdbb9":"markdown","d9518c1b":"markdown","093003c1":"markdown","882f428c":"markdown","57aad73b":"markdown","22a9d3bf":"markdown","ef36a22b":"markdown","a2c3b2b8":"markdown","d6c2b123":"markdown","d7ddd924":"markdown","a15e24e4":"markdown","629d4a4a":"markdown","34278a7b":"markdown"},"source":{"5e291c64":"import os\nprint(os.listdir(\"..\/input\"))","f883df4d":"import pandas as pd\nimport numpy as np\nimport warnings\nwarnings.filterwarnings('ignore')","2f10d512":"train= pd.read_csv(\"..\/input\/women-health-care-requirements\/train Data.csv\")","1ae14345":"train.head()","8845906c":"\ndef impute_int(df,column):\n    df[column] = df[column].fillna(df[column].mean()) ","57be4bc3":"\ndef impute_categ(df, column):\n    df[column] = df[column].fillna(df[column].mode().loc[0]) ","8138517b":"def impute_ordinal(df, column):\n    df[column] = df[column].fillna(df[column].mode().loc[0])","27b2bab7":"# view max of 50 record at a time\npd.set_option('display.max_rows', 50)","e7e41ad6":"def missing_Colums_Percenatage(df):\n    missing_values = df.isnull().sum().sort_values(ascending = False)[df.isnull().sum().sort_values(ascending=False) != 0]\n    percentage = round((df.isnull().sum().sort_values(ascending = False)*100)\/len(df),2)[round((df.isnull().sum().sort_values(ascending = False)*100)\/len(df),2) != 0]\n    missing_values_df = pd.DataFrame(missing_values)\n    percentage_df = pd.DataFrame(percentage)\n    missing_values_df.reset_index(level=0, inplace=True)\n    percentage_df.reset_index(level=0, inplace=True)\n    \n    return pd.merge(left=missing_values_df,right= percentage_df, left_on='index', right_on='index')\n    \n    \nmissing_Colums_Percenatage(train)","b7777177":"train = train.dropna(axis=1,thresh=13000)","f7acef3d":"impute_int(train,[col for col in train if col.startswith('n_')])","04ff8c3f":"train[[col for col in train if col.startswith('c_')]]","73b93a37":"impute_categ(train,[col for col in train if col.startswith('c_')])","9c7139df":"impute_ordinal(train,[col for col in train if col.startswith('o_')])","21ebd4c8":"train[[col for col in train if col.startswith('c_')]].astype(str)\ntrain[[col for col in train if col.startswith('o_')]].astype(str)","9cd12d10":"train.shape","8bce1453":"traindf = pd.get_dummies(train)","c638fc72":"traindf.head()","f798083d":"trainlabeldf= pd.read_csv(\"..\/input\/women-health-care-requirements\/train labels.csv\")","3a29d9d5":"trainlabeldf['service_a']","c3f3b530":"completedf = pd.merge(left=traindf,right=pd.DataFrame(trainlabeldf), left_on='id', right_on='id')","a423eb38":"completedf.head()","92af7c79":"from sklearn.ensemble import RandomForestClassifier\nfrom sklearn.datasets import make_regression\nfrom sklearn.model_selection import train_test_split","10e161b7":"[col for col in completedf if col.startswith('service')]","8a4e2410":"X = completedf.drop([col for col in completedf if col.startswith('service')], axis=1)\nX = X.drop(['id'], axis =1 )\ny = completedf[[col for col in completedf if col.startswith('service')]]\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3)","65f19891":"regressor = RandomForestClassifier(n_estimators = 100, random_state = 0) \n  \n# fit the regressor with x and y data \nclf = regressor.fit(X, y) ","643d75da":"clf.fit(X_train,y_train)","1279d71a":"y_pred=clf.predict(X_test)","fbc5e78d":"from sklearn import metrics\nfrom sklearn.metrics import classification_report\nprint(\"Accuracy:\",metrics.accuracy_score(y_test, y_pred))\n\n#metrics.multilabel_confusion_matrix(y_test, y_pred)\nprint(classification_report(y_test, y_pred))","ce4cdbb9":"Reading csv file","d9518c1b":"Adding required packages ","093003c1":"imputation function for categorical","882f428c":"imputation function for ordinal","57aad73b":"Finding results by using classification_report \nAccuracy 27%\nstill we can improve","22a9d3bf":"Converting C_(categorical) and o_(ordinal) data types to str (bez few columns are with int data tye)","ef36a22b":"imputation function for integers (continues)","a2c3b2b8":"droping 13000 rows which are having max columns with null \nimpute integer\nimpute category\nimpute ordinal ","d6c2b123":"creating dummies\nreading lables data set which is having target variable\nmerging train and label data set together by common column ID (independent variables + dependent variable)\n","d7ddd924":"viewing data \ncolumn starts with\nn_ is numeric\nc_ is categorical\no_ is ordinal","a15e24e4":"**Multi-Label Classification**\n\nMulti-label classification originated from the investigation of text categorisation problem, where each document may belong to several predefined topics simultaneously.\n\nMulti-label classification of textual data is an important problem. Examples range from news articles to emails. For instance, this can be employed to find the genres that a movie belongs to, based on the summary of its plot.\n\nIn multi-label classification, the training set is composed of instances each associated with a set of labels, and the task is to predict the label sets of unseen instances through analyzing training instances with known label sets.\n\nDifference between multi-class classification & multi-label classification is that in multi-class problems the classes are mutually exclusive, whereas for multi-label problems each label represents a different classification task, but the tasks are somehow related.\n\nFor example, multi-class classification makes the assumption that each sample is assigned to one and only one label: a fruit can be either an apple or a pear but not both at the same time. Whereas, an instance of multi-label classification can be that a text might be about any of religion, politics, finance or education at the same time or none of these.\n\nFor more information on multi label classification:\nhttps:\/\/towardsdatascience.com\/journey-to-the-center-of-multi-label-classification-384c40229bff","629d4a4a":"missing count(percentage)","34278a7b":"Building a model \nif target variable is more than one then this type of problem comes under multi lable classification (more than one taget with yes or no)\nBased on user feedback we may choose more than 1 service or none\n\nSpliting data into test train split\nUsed a RandomForestClassifier Algorithm to predict "}}