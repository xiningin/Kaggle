{"cell_type":{"cc0932e6":"code","a46687d6":"code","8850c017":"code","67b355df":"code","5ea88628":"code","1fd0e312":"code","7d97d588":"code","1bf91384":"code","4bedb520":"code","3233826a":"code","9625685b":"markdown"},"source":{"cc0932e6":"import pandas as pd\nfrom sklearn import metrics\nfrom sklearn.feature_extraction.text import CountVectorizer\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.feature_extraction.text import TfidfVectorizer\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.model_selection import GridSearchCV\nimport numpy as np\nfrom sklearn.svm import SVC","a46687d6":"df = pd.read_csv(\"\/kaggle\/input\/tweets-of-trump-and-trudeau\/tweets.csv\")\ndf.head()","8850c017":"X = df[\"status\"]\ny = df[\"author\"]\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, random_state=52, test_size=0.33)","67b355df":"cVec = CountVectorizer(stop_words='english', min_df=.05, max_df=.9)\ntfidfVec = TfidfVectorizer(stop_words='english', min_df=.05, max_df=.9)\n\ncv_train = cVec.fit_transform(X_train)\ncv_test = cVec.transform(X_test)\n\ntv_train = tfidfVec.fit_transform(X_train)\ntv_test = tfidfVec.transform(X_test)","5ea88628":"params = {\n    'min_samples_leaf': np.arange(1,10,1),\n    'criterion': [\"gini\", \"entropy\"],\n    'max_depth': np.arange(5,50,5)\n}","1fd0e312":"gcv = GridSearchCV(DecisionTreeClassifier(random_state=0), params)\ngcv.fit(cv_train, y_train)\nprint(gcv.best_params_)","7d97d588":"dt = DecisionTreeClassifier(random_state=0, max_depth=10, criterion= 'gini')\ndt.fit(cv_train, y_train)\ncv_pred = dt.predict(cv_test)\n\ndt.fit(tv_train, y_train)\ntv_pred = dt.predict(tv_test)","1bf91384":"print(metrics.accuracy_score(cv_pred,y_test))\nprint(metrics.confusion_matrix(y_test,cv_pred))\nprint(metrics.classification_report(y_test,cv_pred))\n\nprint(metrics.accuracy_score(tv_pred,y_test))\nprint(metrics.confusion_matrix(y_test,tv_pred))\nprint(metrics.classification_report(y_test,tv_pred))","4bedb520":"svc_model = SVC(kernel='poly', degree=3)\n\nsvc_model.fit(cv_train, y_train)\ncv_pred = svc_model.predict(cv_test)\n\nsvc_model.fit(tv_train, y_train)\ntv_pred = svc_model.predict(tv_test)","3233826a":"print(metrics.accuracy_score(cv_pred,y_test))\nprint(metrics.confusion_matrix(y_test,cv_pred))\nprint(metrics.classification_report(y_test,cv_pred))\n\nprint(metrics.accuracy_score(tv_pred,y_test))\nprint(metrics.confusion_matrix(y_test,tv_pred))\nprint(metrics.classification_report(y_test,tv_pred))","9625685b":"# Tweet Classificaton\n\nusing Trump's and Trudeau's tweets, try to find given tweet belongs to either Trump or Trudeau <br\/>"}}