{"cell_type":{"a2ddbea9":"code","a34eb6ec":"code","2c616c99":"code","4d77b196":"code","cdccd74e":"code","e7d991d5":"code","d29d3e24":"markdown"},"source":{"a2ddbea9":"import numpy as np\nimport pandas as pd\nimport tensorflow as tf\nfrom sklearn.preprocessing import scale\nfrom sklearn.model_selection import train_test_split","a34eb6ec":"train_ds = pd.read_csv('..\/input\/train.csv')\ntest_ds = pd.read_csv('..\/input\/test.csv')\nprint(train_ds.shape, test_ds.shape)","2c616c99":"train_y = train_ds['target']\ntrain_x = train_ds.drop(['target', 'ID_code'], axis=1)\nid_test = test_ds['ID_code']\ntest_x = test_ds.drop(['ID_code'], axis=1)\n\ntrain_x = scale(train_x)\ntest_x = scale(test_x)\n\ntrain_x, dev_x, train_y, dev_y = train_test_split(train_x, train_y, test_size=0.45, random_state=82)","4d77b196":"model = tf.keras.Sequential()\nmodel.add(tf.keras.layers.Dense(32, activation='relu', kernel_regularizer=tf.keras.regularizers.l2(0.005), input_shape=(200,)))\nmodel.add(tf.keras.layers.Dropout(0.2))\nmodel.add(tf.keras.layers.Dense(10, activation='relu', kernel_regularizer=tf.keras.regularizers.l2(0.005)))\nmodel.add(tf.keras.layers.Dropout(0.2))\nmodel.add(tf.keras.layers.Dense(20, activation='relu', kernel_regularizer=tf.keras.regularizers.l2(0.005)))\nmodel.add(tf.keras.layers.Dropout(0.2))\nmodel.add(tf.keras.layers.Dense(1, activation='relu', kernel_regularizer=tf.keras.regularizers.l2(0.005)))\nmodel.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])","cdccd74e":"model.fit(x = train_x, y = train_y, batch_size = 25800, epochs=20, validation_data=(dev_x, dev_y))","e7d991d5":"prediction = model.predict(test_x)\npd.DataFrame({\"ID_code\":id_test,\"target\":prediction[:,0]}).to_csv('result_keras.csv',index=False,header=True)","d29d3e24":"# Build model"}}