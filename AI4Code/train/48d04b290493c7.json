{"cell_type":{"322efac5":"code","7dd8a242":"code","67c4edc5":"code","ef34200c":"code","75ec3b51":"code","9dde16d5":"code","43fc4a50":"markdown","c1588d4b":"markdown","7b677d7b":"markdown","b0b007b7":"markdown","15d7ddd9":"markdown"},"source":{"322efac5":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport os\nimport sqlite3\nimport plotly.express as px\nimport matplotlib.pyplot as plt\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","7dd8a242":"# Reading the CSV and coverting it into\n# pandas dataframe.\n\ndf = pd.read_csv(\"..\/input\/heart-disease-mortality-dataset\/Heart Disease Mortality.csv\")\ndf.head()","67c4edc5":"# Cleaning the data\n# Dropping colums with not usefull\n# or insufficient data.\n\nclean_df = df.drop(['DataSource', 'Class', 'Topic', 'Data_Value_Unit', 'Data_Value_Footnote_Symbol', 'StratificationCategory1', 'Stratification1', 'StratificationCategory2', 'Stratification2', 'TopicID'], axis = 1)\nclean_df.head()","ef34200c":"# Creating a SQLite3 database\n# and adding the cleaned data in it.\n\ndef data_to_sql():\n    global conn\n    conn = sqlite3.connect(\"heart.db\")\n    clean_df.to_sql(\"data\", conn)\n\ndata_to_sql()","75ec3b51":"# Visualising the data\n# Cases reported in every state\n\nquery = \"\"\"\nSELECT\nCOUNT(*) AS \"Cases recorded\",\nLocationAbbr as \"State\"\nFROM data\nGROUP BY \"LocationAbbr\"\nORDER BY \"Cases recorded\"\n;\n\"\"\"\n\nd1 = pd.read_sql(query, conn)\npx.bar(d1, x=\"State\", y=\"Cases recorded\", color=\"Cases recorded\")","9dde16d5":"# Breifly describing the cleaned data.\n\nclean_df.describe()","43fc4a50":"## Addition of SQLite3 Database","c1588d4b":"## Data cleaning","7b677d7b":"## Reading the data from CSV to Pandas DF","b0b007b7":"## Data visualisation","15d7ddd9":"# EDA in heart disease mortality rate using pandas and SQL\n\nThis notebook consists of data extraction from CSV to Pandas dataframe, cleaning of data and adding it to SQLite database as SQL table for further analysis. Rounding up the notebook, you will find a simple bar graph made using plotly showing how many cases have been reported in every state and a breif table description."}}