{"cell_type":{"12dd6ebd":"code","5c79073e":"code","7d5e9330":"code","99c4d603":"code","0a4bbe2c":"code","d2615d87":"code","1a3515ea":"code","c67bfd9e":"code","7335c733":"code","141ed4b4":"code","ee393e6a":"code","52f458a4":"code","97d21a5e":"code","d1ea64a7":"code","ab033a3b":"code","a8d5e597":"code","7f84c2aa":"code","66483cae":"code","9d949383":"code","607c43a6":"code","ab614886":"code","66ab4deb":"code","c805ae5a":"code","08be7778":"code","802cb54c":"code","f0a13906":"code","fbf21a1b":"code","fcf321e6":"code","d829bc2c":"code","90cbd527":"code","910b2a7a":"code","0f08e35c":"code","140e9cc8":"code","81d6b4fe":"code","43ab9b1c":"code","0b830657":"code","f3b26947":"code","d10f7de7":"code","c3071faf":"code","b082edca":"code","baae1d7c":"code","da3b6924":"code","448523fc":"code","452bd399":"code","6c1c80a9":"code","9dd0dcd9":"code","c4f13a77":"code","a392951d":"code","01072c72":"code","3f48d360":"code","cd83ed79":"code","bef2e57e":"code","af1e6b02":"code","be156330":"code","d03153b3":"code","c0bd59c8":"code","be3210d7":"code","b86feaee":"code","82a43336":"code","d78ee62d":"code","9c8a5d56":"code","2e90a3f8":"code","b431456c":"code","213ec53e":"code","1dbc1107":"code","97154629":"code","95753453":"code","d5e17544":"code","c985b513":"code","4871efa3":"code","78995eb2":"code","1aee5d07":"code","84182f18":"code","75fc1691":"code","2b8aee19":"code","f34968e3":"code","d0edc747":"code","dfd7ae9d":"code","57774277":"code","94450047":"code","76d384ca":"markdown","a6b719c3":"markdown","64165833":"markdown","4dc6bec6":"markdown","abe668d2":"markdown","da7112de":"markdown","757c2d62":"markdown","1ef1910a":"markdown","d39800ff":"markdown","c57a4837":"markdown","87176cae":"markdown","6ccc2b66":"markdown","3854e981":"markdown","8325da42":"markdown","22862ad5":"markdown","45928317":"markdown","1e0d8639":"markdown","4740b386":"markdown","e79d48b4":"markdown","6fa38fb6":"markdown","bdb288c7":"markdown","f99c491f":"markdown","9a9fbbc1":"markdown","dae45d95":"markdown","3a134744":"markdown","f2b05450":"markdown","f8d6133c":"markdown","1c4ad94d":"markdown","fb970be3":"markdown","e64e12c6":"markdown","8d289ae1":"markdown","f6e445c3":"markdown","45fb1ac8":"markdown","6cf8c1ad":"markdown","65649a09":"markdown","7b27a985":"markdown","eac22da5":"markdown","89eb9aa5":"markdown","67f0c35a":"markdown","78a7ea83":"markdown","38402472":"markdown","2ad8d24e":"markdown","428e4b80":"markdown","1448151f":"markdown","2e12578c":"markdown","f845cf29":"markdown","77b4b1e0":"markdown","302b01ef":"markdown","a85fb288":"markdown","a77f48a2":"markdown","fa16be11":"markdown","029f780e":"markdown","f81b7359":"markdown","52977853":"markdown","7d6d835f":"markdown","abaf7a7c":"markdown","4abb0c43":"markdown"},"source":{"12dd6ebd":"import warnings\nwarnings.filterwarnings('always')\nwarnings.filterwarnings('ignore')","5c79073e":"import pandas_profiling\n\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline\n\nsns.set()","7d5e9330":"train = pd.read_csv('..\/input\/titanic\/train.csv')\ntest = pd.read_csv('..\/input\/titanic\/test.csv')","99c4d603":"train.head()","0a4bbe2c":"test.head()","d2615d87":"print(\"train:\",train.shape)\nprint(\"test:\",test.shape)","1a3515ea":"train.info()\nprint('_'*50)\ntest.info()","c67bfd9e":"train.describe()","7335c733":"test.describe()","141ed4b4":"plt.figure(figsize=(10,5))\nsns.heatmap(train.isnull(), cbar=False)","ee393e6a":"plt.figure(figsize=(10,5))\nsns.heatmap(test.isnull(), cbar=False)","52f458a4":"train.isnull().sum()","97d21a5e":"test.isnull().sum()","d1ea64a7":"train['Age']= train['Age'].fillna(train['Age'].median())\ntest['Age']= test['Age'].fillna(test['Age'].median())","ab033a3b":"print(train['Age'].isnull().sum())\nprint(test['Age'].isnull().sum())","a8d5e597":"train[\"Cabin\"].describe()","7f84c2aa":"test[\"Cabin\"].describe()","66483cae":"train['Cabin'][train['Cabin'].notnull()].head()","9d949383":"test['Cabin'][test['Cabin'].notnull()].head()","607c43a6":"train[\"Cabin\"] = pd.Series([i[0] if not pd.isnull(i) else 'M' for i in train['Cabin']])\ntest[\"Cabin\"] = pd.Series([i[0] if not pd.isnull(i) else 'M' for i in test['Cabin']])","ab614886":"print(train[\"Cabin\"].isnull().sum())\nprint(test[\"Cabin\"].isnull().sum())","66ab4deb":"test['Cabin'].value_counts()","c805ae5a":"train['Embarked'].value_counts()","08be7778":"train['Embarked']= train['Embarked'].fillna(train['Embarked'].mode()[0])","802cb54c":"train['Embarked'].isnull().sum()","f0a13906":"test[\"Fare\"] = test[\"Fare\"].fillna(test[\"Fare\"].median())","fbf21a1b":"test.isnull().sum()","fcf321e6":"train.isnull().sum()","d829bc2c":"sns.pairplot(train)","90cbd527":"plt.figure(figsize=(8,5))\nsns.heatmap(train.corr(),annot=True,cmap='Purples')","910b2a7a":"plt.figure(figsize=(8,5))\nsns.heatmap(test.corr(),annot=True,cmap='summer')","0f08e35c":"plt.figure(figsize=(8,5))\nsns.countplot('Survived',hue='Pclass',data=train,palette='twilight')","140e9cc8":"plt.figure(figsize=(8,5))\nsns.countplot('Sex',hue='Pclass',data=train,palette='mako')","81d6b4fe":"plt.figure(figsize=(8,5))\nsns.countplot('Embarked',hue='Pclass',data=train,palette='gist_heat')","43ab9b1c":"train['Family_size']= train['SibSp']+train['Parch']+1","0b830657":"test['Family_size']= test['SibSp']+test['Parch']+1","f3b26947":"plt.figure(figsize=(8,5))\nsns.countplot('Family_size',hue='Pclass',data=train,palette='tab20')","d10f7de7":"plt.figure(figsize=(8,5))\ntrain.groupby('Pclass')['Fare'].sum().plot(kind='bar')","c3071faf":"plt.figure(figsize=(8,5))\nsns.barplot('Cabin','Pclass',hue='Pclass',data=train,palette='Set1')","b082edca":"plt.figure(figsize=(8,5))\nsns.boxplot(y=\"Age\",x=\"Sex\",hue=\"Pclass\", data=train,palette='gray')","baae1d7c":"plt.figure(figsize=(8,5))\nsns.countplot('Survived',hue='Sex',data=train,palette='summer')","da3b6924":"plt.figure(figsize=(8,5))\nsns.barplot(y=\"Survived\", x=\"Sex\", hue=\"Pclass\", data=train, palette=\"ocean\")","448523fc":"plt.figure(figsize=(8,5))\nsns.violinplot(x=\"Survived\", y = \"Age\",data = train,palette='plasma',size=6)","452bd399":"plt.figure(figsize=(8,5))\nsns.boxplot(y=\"Age\",x=\"Sex\",hue=\"Pclass\",data=train,palette='Purples')","6c1c80a9":"plt.figure(figsize=(8,5))\nsns.boxplot(y=\"Age\",x=\"Family_size\",hue=\"Survived\", data=train,palette='rainbow')","9dd0dcd9":"plt.figure(figsize=(8,5))\nsns.violinplot(y=\"Family_size\",x='Survived',data = train,palette='hsv')","c4f13a77":"plt.figure(figsize=(8,5))\nsns.barplot('Embarked','Survived',data=train,palette='muted')","a392951d":"plt.figure(figsize=(8,5))\nsns.catplot(\"Pclass\", col=\"Embarked\",hue='Survived',data=train,kind='count',palette=\"inferno\")","01072c72":"plt.figure(figsize=(8,5))\nsns.catplot(\"Family_size\", col=\"Embarked\",hue='Survived',data=train,kind='count',palette=\"terrain\")","3f48d360":"plt.figure(figsize=(8,5))\nsns.boxplot(y=\"Age\",x=\"Embarked\",hue='Survived',data=train, palette=\"cividis\")","cd83ed79":"plt.figure(figsize=(8,5))\nsns.distplot(train['Fare'],bins=30,color='m')","bef2e57e":"train[\"Fare\"] = train[\"Fare\"].map(lambda i: np.log(i) if i > 0 else 0)\ntest[\"Fare\"] = test[\"Fare\"].map(lambda i: np.log(i) if i > 0 else 0)","af1e6b02":"plt.figure(figsize=(8,5))\nsns.distplot(train['Fare'],bins=30,color='m')","be156330":"train.columns","d03153b3":"codes = {\"male\": 0, \"female\": 1}\ntrain['Sex']= train['Sex'].map(codes)\ntest['Sex']= test['Sex'].map(codes)","c0bd59c8":"codes = {\"S\": 1, \"C\": 2, \"Q\": 3}\ntrain['Embarked']= train['Embarked'].map(codes)\ntest['Embarked']= test['Embarked'].map(codes)","be3210d7":"codes= {'M':1,'C':2,'B':3,'D':4,'E':5,'F':6,'A':7,'G':8,'T':9}\ntrain['Cabin']= train['Cabin'].map(codes)","b86feaee":"codes= {'M':1,'C':2,'B':3,'D':4,'E':5,'F':6,'A':7,'G':8}\ntest['Cabin']= test['Cabin'].map(codes)","82a43336":"train.head()","d78ee62d":"test.head()","9c8a5d56":"train.drop(['SibSp','Parch','Ticket'],axis=1,inplace=True)\ntest.drop(['SibSp','Parch','Ticket'],axis=1,inplace=True)","2e90a3f8":"train.drop('Name',axis=1,inplace=True)\ntest.drop('Name',axis=1,inplace=True)","b431456c":"train.head()","213ec53e":"test.head()","1dbc1107":"X_train = train.drop(['Survived','PassengerId'], axis=1)\nY_train = train[\"Survived\"]\nX_test  = test.drop(\"PassengerId\", axis=1).copy()\nX_train.shape, Y_train.shape, X_test.shape","97154629":"from sklearn.linear_model import LogisticRegression\nLR = LogisticRegression()","95753453":"# Fitting the model on our trained dataset.\nLR.fit(X_train,Y_train)","d5e17544":"# Making Predictions\ny_pred = LR.predict(X_test)","c985b513":"# Calculating the Accuracy of the model.\n\nprint(\"Accuracy:\",round(LR.score(X_train, Y_train)*100,2))","4871efa3":"LR.coef_","78995eb2":"features = ['Pclass', 'Sex', 'Age', 'Fare', 'Cabin', 'Embarked', 'Family_size']","1aee5d07":"coeff = pd.DataFrame(X_train.columns)\ncoeff.columns = ['Feature']\ncoeff[\"Correlation\"] = pd.Series(LR.coef_[0])\n\ncoeff.sort_values(by='Correlation', ascending=False)","84182f18":"plt.figure(figsize=(8,5))\nsns.barplot('Correlation','Feature',data=coeff,palette='magma')","75fc1691":"from sklearn.ensemble import RandomForestClassifier\nRF= RandomForestClassifier(n_estimators=100,random_state=22)","2b8aee19":"# Fitting the model on our trained dataset.\nRF.fit(X_train,Y_train)","f34968e3":"# Making Predictions\ny_pred = RF.predict(X_test)","d0edc747":"# Calculating the accuracy\nprint(\"Accuracy:\",round(RF.score(X_train, Y_train)*100,2))","dfd7ae9d":"feature_imp = pd.Series(RF.feature_importances_,index=features).sort_values(ascending=False)\nfeature_imp","57774277":"sns.barplot(feature_imp.values,feature_imp.index,palette='bone')","94450047":"submission = pd.DataFrame({\n        \"PassengerId\": test[\"PassengerId\"],\n        \"Survived\": y_pred\n    })\nsubmission.to_csv('titanic_2218.csv', index=False)","76d384ca":"* **Numerical Features**   : PassengerId,Age,Fare,SibSp,Parch\n* **Categorical Features** : Survived,Pclass,Name,Sex,Embarked","a6b719c3":"**Observations**:\n\n* Survival rate of passengers coming from Southampton(S) seated in Pclass-1 is higher.","64165833":"### Fare values are highly skewed and hence need to be treated with log transformation.","4dc6bec6":"![white-stone-words-thank-you-smile-face-color-glitter-boke-background-117350639.jpg](attachment:white-stone-words-thank-you-smile-face-color-glitter-boke-background-117350639.jpg)","abe668d2":"## Handling Missing Values","da7112de":"## 6) Fare","757c2d62":"## **DESCRIPTION:**\n\nClassic dataset on Titanic disaster used often for data mining tutorials and demonstrations.\n\n## **SUMMARY:**\n\nThis is a classic dataset used in many data mining tutorials and demos -- perfect for getting started with exploratory analysis and building binary classification models to predict survival.\n\nData covers passengers only, not crew.\n\n## **FEATURES:**\n\n* survival - Survival (0 = No; 1 = Yes)\n* class - Passenger Class (1 = 1st; 2 = 2nd; 3 = 3rd)\n* name - Name\n* sex - Sex\n* age - Age\n* sibsp - Number of Siblings\/Spouses Aboard\n* parch - Number of Parents\/Children Aboard\n* ticket - Ticket Number\n* fare - Passenger Fare\n* cabin - Cabin\n* embarked - Port of Embarkation (C = Cherbourg; Q = Queenstown; S = Southampton)**","1ef1910a":"## Reading and Understanding the Data","d39800ff":"## If you have reached the end, I would Thank you for investing your precious time here! I would like to hear from you in comments section \ud83d\ude0a\n","c57a4837":"* **Numerical Features**   : PassengerId,Age,Fare,SibSp,Parch\n* **Categorical Features** : Pclass,Name,Sex,Embarked","87176cae":"Observations:\n\n* Most of the were passengers coming from Southampton in Pclass-3.","6ccc2b66":"**Observations**:\n    \n* The violin plot of survived passengers, we can notice that very young passengers have higher survival rate.","3854e981":"## 2) Cabin","8325da42":"## 1) Sex","22862ad5":"**Observations**:\n    \n* The passengers in Pclass-1 were elder than the passengers in other Pclass.\n* Age distribution seems to be the same in Male and Female subpopulations.","45928317":"## Missing Values:\n*   Cabin       :   687\n*   Age         :   177 \n*   Embarked    :   2","1e0d8639":"**Observations**:\n\n* We can see more of the passengers were in Pclass-3 \n* Passengers had high ratio of males when compared to females.","4740b386":"<centre>![titanic.jpg](attachment:titanic.jpg)<centre>","e79d48b4":"### We have high number of missing values in Age and Cabin columns of both Train and Test dataset.","6fa38fb6":"**Observations**:\n    \n* Survived passengers are higher in number from Pclass-1, they were evacuated first.\n* Passengers from Pclass-3 are higher in count who couldn't survive as they were the first to hit the water flow.","bdb288c7":"## **Summary:**\n    \n**Logistic Regression:**\n\n   * **Accuracy** : 81.14\n   * **Feature Importance** : Sex,Fare,Cabin\n\n**Random Forest Classifier:**\n    \n   * **Accuracy**: 98.32\n   * **Feature Importance**: Sex,Fare,Age","f99c491f":"### We can also drop the columns SibSp and Parch as we have derived a column Family_size out of them.","9a9fbbc1":"## 1) Passenger Class","dae45d95":"Observations:\n    \n* The aged passengers are in Pclass 1 and younger in the other two Pclass.So the older passengers were rescued first and later the younger ones.","3a134744":"### Dropping the Name column which doesn't add up to our predictions.","f2b05450":"**Observations**:\n\n* Passengers of age 30 have high chances of surviving if they come from Cherbourg (C).","f8d6133c":"## 5) Embarked","1c4ad94d":"Observations:\n\n* It seems that passenger coming from Cherbourg (C) are likely to have higher survival rate.","fb970be3":"## 4) Family Size","e64e12c6":"### Imputing the missing values of Age with median as the column has no outliers.","8d289ae1":"## Model Building","f6e445c3":"#               <h1>Titanic\u26f5 Disaster Dataset<h1>","45fb1ac8":"Observations:\n\n* Passengers with small families could survive when compared to families with more than 5 members.","6cf8c1ad":"## 2) Sex","65649a09":"Skewness is clearly reduced after the log transformation","7b27a985":"## 3) Embarked","eac22da5":"### Observing the values above the first letter is for \"Deck\".However the missing values for cabin might be because not everyone was allocated a Cabin and we could just make use of Deck and fill the missing.","89eb9aa5":"Observations:\n\n* Most of the passengers in Pclass-3 were Single.\n* The families also were maximum in number were in Pclass-3.","67f0c35a":"## **Missing Values**:\n\n* Cabin : 327\n* Age : 86\n* Fare :1 \n","78a7ea83":"## 3) Cabin","38402472":"## 1) Logistic Regression :\n\nLogistic regression is a statistical model that in its basic form uses a logistic function to model a binary dependent variable.","2ad8d24e":"### Imputing the missing values with mode.","428e4b80":"## Dealing with Categorical Variables","1448151f":"## Feature Importance","2e12578c":"## Import Libraries","f845cf29":"## 2) Embarked","77b4b1e0":"Observations:\n\n* This clearly reminds me of the line \"Female and Children only!\" and it is evident that females were evacuated first.\n* There were only few men who were rescued when most of the female and children were evacuated.","302b01ef":"## 3) Age","a85fb288":"Observations:\n\n* P-3 passengers were in Deck M,G,E and F.\n* P-2 passengers were in Deck M,E,D,and F.\n* P-1 passengers were in Deck M,C,D,A,B and T","a77f48a2":"## 1) Age","fa16be11":"## Visualisations","029f780e":"Observations:\n    \n* The fare of Pclass-1 being the expensive and Pclass-3 cheapest one.","f81b7359":"## 4) Fare","52977853":"**Observations**:\n\n* Survived is highly correlated with Fare which can be assumed that higher the fare is higher the priority given to such passengers.\n* Survived is also strongly related to Passenger Class which also says higher Pclass i.e., 2 or 3 is likely to survive less as the classes were at bottom, which says they were likely to hit the water first.","7d6d835f":"Observations:\n\n* Family Size of 6-8 were able to survive.    ","abaf7a7c":"## 2) Random Forest Classifier","4abb0c43":"Observations:\n\n* This clearly shows first females were rescued from all the Pclass."}}