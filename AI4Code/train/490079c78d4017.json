{"cell_type":{"43aa7867":"code","0ef3a992":"code","25babce7":"code","71ad4654":"code","392d622a":"code","52cdc8d9":"code","828182c7":"code","10ad33c5":"code","fa6639cc":"code","1fa0d9b5":"code","3b447e6e":"code","82c18647":"code","23bc5aa0":"code","6fd2f8b0":"code","75afde68":"code","64320f11":"code","d72b32d7":"code","36d665dc":"code","b09cbc50":"code","8a1df7bf":"code","d34e93dc":"code","7e159c48":"code","c8ffa579":"code","4e183e42":"code","7359aaf8":"code","22bac2fc":"code","8524c41b":"code","20f15770":"code","c66919b8":"code","4d5f5c23":"code","20dabd51":"code","ddb7cff6":"code","b420bc57":"code","e656ac2b":"code","afb0eaf2":"code","815c0a59":"markdown","6da5b117":"markdown"},"source":{"43aa7867":"import os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","0ef3a992":"import numpy as np\nimport pandas as pd \nimport tensorflow as tf\nfrom tensorflow import keras\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.model_selection import train_test_split\n%matplotlib inline","25babce7":"train = pd.read_csv('..\/input\/digit-recognizer\/train.csv')\ntrain.head()","71ad4654":"test = pd.read_csv('..\/input\/digit-recognizer\/test.csv')\ntest.head()","392d622a":"train.shape\ntest.shape","52cdc8d9":"x = train.drop(['label'],axis=1)\nX = np.array(x).reshape(len(train),28*28) \/ 255\nX.shape","828182c7":"y = train['label']\ny.shape","10ad33c5":"x_test = np.array(test).reshape(len(test),28*28) \/ 255\nx_test.shape","fa6639cc":"X_train, X_val, y_train, y_val = train_test_split(X,y,test_size=0.15,random_state=42)","1fa0d9b5":"X_train.shape, y_train.shape","3b447e6e":"X_val.shape, y_val.shape","82c18647":"plt.imshow(X[2].reshape(28,28))","23bc5aa0":"ann =keras.Sequential([\n     keras.layers.Dense(10, input_shape=(784,),activation='sigmoid')\n])\nann.compile(\n             optimizer='adam',\n             loss='sparse_categorical_crossentropy',\n             metrics=['accuracy'])\nann.fit(X_train,y_train,epochs=25)","6fd2f8b0":"ann.evaluate(X_val,y_val)","75afde68":"y_predict = ann.predict(X_val)\ny_predict","64320f11":"y_predicted_labels = [np.argmax(i) for i in y_predict]\ny_predicted_labels[0]","d72b32d7":"cn = tf.math.confusion_matrix(y_val,y_predicted_labels)\nplt.figure(figsize=(8,6))\nsns.heatmap(cn,annot=True,fmt='d')\nplt.xlabel('Predicted')\nplt.ylabel('Truth')","36d665dc":"ann_hidden =keras.Sequential([\n    keras.layers.Dense(100, input_shape=(784,), activation='relu'),\n    keras.layers.Dense(10,activation='sigmoid')\n])\nann_hidden.compile(\n             optimizer='adam',\n             loss='sparse_categorical_crossentropy',\n             metrics=['accuracy'])\nann_hidden.fit(X_train,y_train,epochs=25)","b09cbc50":"ann_hidden.evaluate(X_val,y_val)","8a1df7bf":"y_predict = ann_hidden.predict(X_val)\ny_predict","d34e93dc":"y_predicted_labels = [np.argmax(i) for i in y_predict]\ny_predicted_labels[2]","7e159c48":"cn = tf.math.confusion_matrix(y_val,y_predicted_labels)\nplt.figure(figsize=(8,6))\nsns.heatmap(cn, annot=True, fmt='d')\nplt.xlabel('Predicted')\nplt.ylabel('Truth')","c8ffa579":"ann_flat = keras.Sequential([\n           keras.layers.Flatten(input_shape=(28,28)),\n           keras.layers.Dense(100, activation='relu'),\n           keras.layers.Dense(10, activation='sigmoid')\n])\nann_flat.compile(\n             optimizer='adam',\n             loss='sparse_categorical_crossentropy',\n             metrics=['accuracy'])\nann_flat.fit(X_train,y_train,epochs=25)","4e183e42":"ann_flat.evaluate(X_val,y_val)","7359aaf8":"y_predict = ann_hidden.predict(x_test)\ny_predict","22bac2fc":"y_predicted_labels = [np.argmax(i) for i in y_predict]\ny_predicted_labels[2]","8524c41b":"cnn = keras.Sequential([\n    keras.layers.Conv2D(30, (3,3), activation='relu', input_shape=(28, 28, 1)),\n    keras.layers.MaxPooling2D((2,2)),\n \n    keras.layers.Flatten(),\n    keras.layers.Dense(100, activation='relu'),\n    keras.layers.Dense(10, activation='sigmoid')\n])","20f15770":"cnn.compile(\n             optimizer='adam',\n             loss='sparse_categorical_crossentropy',\n             metrics=['accuracy'])","c66919b8":"X_train = X_train.reshape(-1,28,28,1)\nX_train.shape","4d5f5c23":"x_test = x_test.reshape(-1,28,28,1)\nx_test.shape","20dabd51":"cnn.fit(X_train, y_train, epochs=25)","ddb7cff6":"y_predict_final = cnn.predict(x_test)","b420bc57":"y_predicted_labels_final =[np.argmax(i) for i in y_predict_final]","e656ac2b":"image_id = range(1, y_predict_final.shape[0] + 1)\nsubmission_file = pd.DataFrame({'ImageId':image_id, 'Label':y_predicted_labels_final})\nsubmission_file.to_csv('digit_recognizer_submission_final_cnn_ann.csv',index=False)","afb0eaf2":"submission_file.head()","815c0a59":"# **Import Libary**","6da5b117":"# **Analysis Data**"}}