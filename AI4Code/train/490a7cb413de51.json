{"cell_type":{"bc917b4f":"code","4d482b10":"code","8eadfd3e":"code","f37ad55b":"code","afa79c3a":"code","5a26dca2":"code","8776e552":"code","4d654f37":"code","3eca2652":"code","4c2392ec":"code","83c9d41c":"code","7faccc42":"code","c11822b1":"code","8fbbc907":"code","3e3c39cd":"code","a9c476e5":"code","b112587e":"code","7c627a0d":"code","efbc103e":"code","c06e7e83":"code","c5bea8e7":"code","ac6a44f5":"code","dd06df2e":"code","0ccad20b":"code","4a28646f":"code","ac87c53b":"code","b9265a87":"code","ce2ef527":"code","819b3d05":"markdown","e3d78a96":"markdown","2bd5d496":"markdown","6827879d":"markdown","40fbf441":"markdown","b9749df1":"markdown","fa7a439f":"markdown","1b980973":"markdown","b6d8f4ea":"markdown","4b177086":"markdown","c65d13fa":"markdown","174281aa":"markdown"},"source":{"bc917b4f":"import numpy as np\nimport pandas as pd\n\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.metrics import confusion_matrix, accuracy_score\n\nimport matplotlib.pyplot as plt\n\nfrom tensorflow import keras","4d482b10":"cust = pd.read_csv('..\/input\/churn-for-bank-customers\/churn.csv')","8eadfd3e":"# print the first five rows of the data set\n\ncust.head()","f37ad55b":"# print the shape of the dataset\n\ncust.shape","afa79c3a":"# few detail about data\n\ncust.info()","5a26dca2":"# statistical detail about data\n\ncust.describe()","8776e552":"# check for missing values\n\ncust.isna().sum()","4d654f37":"# we wont take the first two columns (row id and customer id)\n\nx = cust.iloc[:, 3:13]\n\n# target variable\ny = cust.iloc[:, -1]","3eca2652":"x.Gender = pd.factorize(x.Gender)[0]\n\nx.Geography = pd.factorize(x.Geography)[0]","4c2392ec":"x.head()","83c9d41c":"# Splitting the dataset into the Training set and Test set\n\nx_train, x_test, y_train, y_test = train_test_split(x, y, test_size = 0.2, random_state = 0)","7faccc42":"display(x_train.shape, x_test.shape, y_train.shape, y_test.shape)","c11822b1":"sc = StandardScaler()\n\nx_train = sc.fit_transform(x_train)\nx_test = sc.fit_transform(x_test)","8fbbc907":"from keras.models import Sequential\nfrom keras.layers import Dense, LeakyReLU, PReLU, ELU, Dropout","3e3c39cd":"# Initialising the ANN\n\nclassify = Sequential()","a9c476e5":"# Adding the input layer and the first hidden layer\n\nclassify.add(Dense(units = 6, kernel_initializer = 'he_uniform', activation ='relu', input_dim =10))\n\n# Adding the second hidden layer\n\nclassify.add(Dense(units = 6, kernel_initializer ='he_uniform' ,activation ='relu'))\n\n# Adding the output layer\n\nclassify.add(Dense(units = 1, kernel_initializer = 'glorot_uniform', activation = 'sigmoid'))","b112587e":"classify.summary()","7c627a0d":"# Compiling the ANN\n\nclassify.compile(optimizer = 'adam', loss='binary_crossentropy', metrics='accuracy')","efbc103e":"# Fitting the ANN to the Training set\n\nmodel = classify.fit(x_train, y_train, validation_split=0.20, batch_size=10, epochs=100)","c06e7e83":"# list all data in histroy\n\nprint(model.history.keys())","c5bea8e7":"# summarize history for accuracy\nplt.plot(model.history['accuracy'])\nplt.plot(model.history['val_accuracy'])\nplt.title('model accuracy')\nplt.ylabel('accuracy')\nplt.xlabel('epoch')\nplt.legend(['train', 'test'], loc='lower right')\nplt.show()","ac6a44f5":"# summarize history for loss\nplt.plot(model.history['loss'])\nplt.plot(model.history['val_loss'])\nplt.title('model loss')\nplt.ylabel('loss')\nplt.xlabel('epoch')\nplt.legend(['train', 'test'], loc='upper right')\nplt.show()\n","dd06df2e":"y_predict = classify.predict(x_test)\ny_predict = (y_predict > 0.5)\n\n\nprint(confusion_matrix(y_test, y_predict))\n\nprint('\\nAccuracy: ', accuracy_score(y_predict,y_test))","0ccad20b":"from sklearn.linear_model import LogisticRegressionCV\nfrom sklearn.metrics import accuracy_score\nlg = LogisticRegressionCV(cv=3)\n\nlg.fit(x_train, y_train)\n\np_predict_train = lg.predict(x_train)\n\np_predict_test = lg.predict(x_test)\n\nprint(accuracy_score(p_predict_train, y_train))\nprint(accuracy_score(p_predict_test, y_test))","4a28646f":"from keras.wrappers.scikit_learn import KerasClassifier\nfrom sklearn.model_selection import GridSearchCV\n\nfrom keras.models import Sequential\nfrom keras.layers import LeakyReLU, Activation, Dropout, Dense, Embedding, Flatten, BatchNormalization\nfrom keras.activations import relu, sigmoid","ac87c53b":"def create_model(layers, activation):\n    model = Sequential()\n    \n    for i, nodes in enumerate(layers):\n        if i==0:\n            model.add(Dense(nodes,input_dim=x_train.shape[1]))\n            model.add(Activation(activation))\n            model.add(Dropout(0.3))\n        else:\n            model.add(Dense(nodes))\n            model.add(Activation(activation))\n            model.add(Dropout(0.3))\n            \n    model.add(Dense(units = 1, kernel_initializer= 'glorot_uniform', activation = 'sigmoid'))\n    \n    model.compile(optimizer='adam', loss='binary_crossentropy',metrics=['accuracy'])\n    \n    return model\n    \nmodel = KerasClassifier(build_fn=create_model, verbose=0)","b9265a87":"layers = [(20,), (30, 20), (45, 30, 15)]\nactivations = ['sigmoid', 'relu']\n\nparam_grid = dict(layers=layers, activation=activations, batch_size = [128, 256], epochs=[100])\ngrid = GridSearchCV(estimator=model, param_grid=param_grid,cv=5)\n\ngrid_result = grid.fit(x_train, y_train)","ce2ef527":"print(grid_result.best_score_,grid_result.best_params_)","819b3d05":"# Train test split","e3d78a96":"# Load Dataset","2bd5d496":"# Making predictions and evaluating model","6827879d":"# Scaling the dataset","40fbf441":"# Atrifical Neural Network (ANN)","b9749df1":"# Model using Logistic regression","fa7a439f":"# Load Library","1b980973":"# Hyperparameter tuning","b6d8f4ea":"# Split the data","4b177086":"# Import Deep Learning Libraries","c65d13fa":"# Convert categorical column to numerical","174281aa":"## About the data set\nWe have customer infromation which we got it from bank, and we have to predict base on customer credit score, salary etc whether customer will leave the bank in the comming years or will the cutomer stay and utilize the sevice of the bank"}}