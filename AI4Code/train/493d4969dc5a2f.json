{"cell_type":{"ac7c4364":"code","b7a55f45":"code","92425aa2":"code","40f70702":"code","787c54d2":"code","5bb93f36":"code","0ab6c8a6":"code","42ba39cf":"code","19347b29":"code","32fef51b":"code","f7d64729":"markdown"},"source":{"ac7c4364":"import sys\nsys.path.append('..\/input\/pycaret\/pyod')\nsys.path.append('..\/input\/pycaret\/pycaret')\nfrom pycaret.regression import *\n\nimport pandas as pd\nimport numpy as np\n\nimport warnings\nwarnings.filterwarnings('ignore')","b7a55f45":"train = pd.read_csv('..\/input\/tabular-playground-series-jan-2022\/train.csv')\ntest = pd.read_csv('..\/input\/tabular-playground-series-jan-2022\/test.csv')","92425aa2":"for df in [train, test]:\n    df['date'] = pd.to_datetime(df['date'])\n    df['year'] = df.date.dt.year\n    df['month'] = df.date.dt.month\n    df['week']= df['date'].dt.week\n    df['day'] = df.date.dt.day\n    df['dayofweek'] = df.date.dt.dayofweek\n    df['dayofyear'] = df['date'].dt.dayofyear\n    df.drop(columns=['date'],inplace=True)  ","40f70702":"train.head()","787c54d2":"reg = setup(data = train,\n            target = 'num_sold',\n            train_size = 0.7, \n            normalize = True, \n            normalize_method = 'robust', \n            transform_target = True, \n            data_split_shuffle = False, \n            feature_interaction = True, \n            silent = True, \n            fold = 5, \n            n_jobs = -1) ","5bb93f36":"def smape(y_true, y_pred):\n    return np.mean( np.abs(y_true - y_pred) \/ (y_true + np.abs(y_pred)) * 200 )\n\nadd_metric('SMAPE', 'SMAPE', smape, greater_is_better = False)","0ab6c8a6":"model = create_model('catboost')","42ba39cf":"pred = predict_model(model, data=test)\npred.head()","19347b29":"submission = pd.read_csv('..\/input\/tabular-playground-series-jan-2022\/sample_submission.csv')\nsubmission.num_sold = pred.Label\nsubmission.to_csv('submission.csv', index = False)","32fef51b":"submission.head()","f7d64729":"# TPS Jan 2022: Simple Catboost"}}