{"cell_type":{"86909584":"code","dd96451f":"code","77c8ed9d":"code","ee8da01a":"code","b575d62f":"code","a1af4ec4":"code","107a9be6":"code","3f03d0fa":"code","3b0810e4":"markdown","3d84cb7b":"markdown"},"source":{"86909584":"!git clone https:\/\/github.com\/minimaxir\/gpt-2-simple\n%cd gpt-2-simple","dd96451f":"!pip install -r requirements.txt","77c8ed9d":"import tensorflow as tf\nprint(tf.__version__)","ee8da01a":"import os\nimport requests\nimport gpt_2_simple as gpt2","b575d62f":"model_name = \"124M\"\nif not os.path.isdir(os.path.join(\"models\", model_name)):\n    print(f\"Downloading {model_name} model...\")\n    gpt2.download_gpt2(model_name=model_name)   # model is saved into current directory under \/models\/124M\/","a1af4ec4":"file_name = \"shakespeare.txt\"\nif not os.path.isfile(file_name):\n    url = \"https:\/\/raw.githubusercontent.com\/karpathy\/char-rnn\/master\/data\/tinyshakespeare\/input.txt\"\n    data = requests.get(url)\n\n    with open(file_name, 'w') as f:\n        f.write(data.text)","107a9be6":"sess = gpt2.start_tf_sess()\ngpt2.finetune(sess,\n              file_name,\n              model_name=model_name,\n              steps=300)   # steps is max number of training steps","3f03d0fa":"gpt2.generate(sess)","3b0810e4":"## Repro [GPT-2-simple](https:\/\/github.com\/minimaxir\/gpt-2-simple)","3d84cb7b":"# GPT-2 finetune for Shakespeare"}}