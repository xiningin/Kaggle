{"cell_type":{"eb115447":"code","77673724":"code","542184f6":"code","a5861048":"code","74d10297":"code","e3df7df9":"code","e7c67d52":"code","68238f5f":"code","f93e024a":"code","6c85cde7":"code","1c4287b9":"code","e7f0edd9":"code","95fae97c":"code","66e216c2":"markdown","0b2c1531":"markdown"},"source":{"eb115447":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport os\nimport cv2\nfrom sklearn.metrics import classification_report, log_loss, accuracy_score\nfrom PIL import Image\nfrom tqdm import tqdm\nfrom albumentations import *","77673724":"!pip install PyQRCode\n!pip install pypng","542184f6":"import pyqrcode","a5861048":"paths=[]\nfor dirname, _, filenames in os.walk('..\/input\/qr-codes\/qr_dataset\/'):\n    for filename in filenames:\n        paths+=[os.path.join(dirname, filename)]\nprint(len(paths))        ","74d10297":"AUG = [ Rotate,SafeRotate,ShiftScaleRotate,RandomFog, ]\nprint(len(AUG))","e3df7df9":"ALB=[[],[],[],[],[]]\n\n# Normal\nfor i in tqdm(range(100)):\n    image0c=cv2.imread(paths[i])\n    ALB[0]+=[image0c]\n    \n# Rotate,SafeRotate,ShiftScaleRotate,RandomFog,\nfor j in range(4):\n    for i in tqdm(range(100)):\n        image0c=cv2.imread(paths[i])\n        aug=AUG[j](p=1)\n        image2c=aug(image=image0c)['image']\n        ALB[j+1]+=[image2c]   ","e7c67d52":"fig,axs = plt.subplots(5,5,figsize=(15,15))\nfor i in range(25):\n    r=i\/\/5\n    c=i%5\n    axs[r][c].set_xticks([])\n    axs[r][c].set_yticks([])\n    ax=axs[r][c].imshow(ALB[r][c])\nplt.show()","68238f5f":"print(ALB[0][0].shape)","f93e024a":"# function to decode\ndef qrdec2_cv2(image_bgr):\n    qrd = cv2.QRCodeDetector()\n    retval, decoded_info, points, straight_qrcode = qrd.detectAndDecodeMulti(image_bgr)\n    result=[retval, decoded_info, points, straight_qrcode]\n    if retval==True:\n        return result[1][0]\n    else:\n        return 'False'","6c85cde7":"ANS=[]\nfor item in paths[0:100]:\n    ANS+=[item.split('\/')[4][0:-7]]\nprint(ANS[0:10])","1c4287b9":"DC=[[],[],[],[],[]]\n\n# Normal\nfor i in range(100):\n    image1=cv2.imread(paths[i])\n    DC[0]+=[qrdec2_cv2(np.array(image1))]\nprint(DC[0][0:10])","e7f0edd9":"for j in range(4):\n    for i in range(100):\n        image1=ALB[j][i]\n        DC[j+1]+=[qrdec2_cv2(np.array(image1))] ","95fae97c":"print(accuracy_score(ANS,DC[0])) # Normal\nprint(accuracy_score(ANS,DC[1])) # Rotate,\nprint(accuracy_score(ANS,DC[2])) # SafeRotate,\nprint(accuracy_score(ANS,DC[3])) # ShiftScaleRotate,\nprint(accuracy_score(ANS,DC[4])) # RandomFog,","66e216c2":"# Prepare Alubmented QR codes","0b2c1531":"# Decode Alubmented codes"}}