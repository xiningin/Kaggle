{"cell_type":{"96069f35":"code","774d19d3":"code","dc22e754":"code","a445d3e4":"code","226a8736":"code","c9818a5b":"code","1189ccac":"code","163bfefc":"code","31170acb":"code","a4047fbe":"code","0ffb2f13":"code","f957c6c0":"code","66ede1b8":"code","d58f8286":"code","2eae4be3":"code","55ab2338":"code","4e3bc983":"code","5c08005d":"code","8da98d2c":"code","4bb4c26a":"markdown","7b05e9d3":"markdown","281a4adb":"markdown","d1e910d9":"markdown","13082467":"markdown","993c93e0":"markdown","18fbade4":"markdown","5f244a68":"markdown","674d3231":"markdown","128c7eb8":"markdown","e4de82d3":"markdown","bf519fd1":"markdown","fc49edf5":"markdown"},"source":{"96069f35":"import pandas as pd \nimport numpy as np\nfrom matplotlib import pyplot as plt \nimport seaborn as sns\nimport folium\nimport plotly.express as px","774d19d3":"kiva_loans = pd.read_csv(\"..\/input\/data-science-for-good-kiva-crowdfunding\/kiva_loans.csv\")\nkiva_mpi_region_location = pd.read_csv(\"..\/input\/data-science-for-good-kiva-crowdfunding\/kiva_mpi_region_locations.csv\")\nloan_theme_ids = pd.read_csv(\"..\/input\/data-science-for-good-kiva-crowdfunding\/loan_theme_ids.csv\")\nloan_themes_by_region = pd.read_csv(\"..\/input\/data-science-for-good-kiva-crowdfunding\/loan_themes_by_region.csv\")","dc22e754":"kiva_loans[\"date\"] = pd.to_datetime(kiva_loans[\"date\"], format = \"%Y-%m-%d\")\nkiva_loans[\"year\"] = kiva_loans.date.dt.year\nkiva_loans[\"month\"] = kiva_loans.date.dt.month_name()\nkiva_loans[\"day_week\"] = kiva_loans.date.dt.day_name()\nkiva_loans[\"number_month\"]=kiva_loans.date.dt.month\nkiva_loans","a445d3e4":"kiva_mpi_region_location","226a8736":"loan_theme_ids","c9818a5b":"loan_themes_by_region","1189ccac":"kiva_loans.info()","163bfefc":"kiva_mpi_region_location.info()","31170acb":"loan_theme_ids.info()","a4047fbe":"loan_themes_by_region.info()","0ffb2f13":"currency_loans = kiva_loans.groupby([\"currency\"]).id.count().reset_index().sort_values(by=\"id\", ascending=False).iloc[:20]\n\nplt.figure(figsize=(15,10))\nchart =sns.barplot(data= currency_loans, x=\"currency\", y=\"id\")\nplt.xticks(rotation=90)\nfor p in chart.patches:\n    chart.annotate(\"%.0f\" % p.get_height(), (p.get_x() + p.get_width() \/ 2., p.get_height()),\n                 ha='center', va='center', fontsize=12, color='black', xytext=(0, 7),\n                 textcoords='offset points')\nplt.title(\"Number of loans by currency between 2014 and 2017\", fontsize=20)\nplt.ylabel(\"Number of loans\", fontsize=10)\nplt.xlabel(\"Currency\")\nplt.show()\n","f957c6c0":"loans_years = kiva_loans.groupby(\"year\").date.count().reset_index()\n\nfig, ax = plt.subplots()\nax.plot(loans_years.year, loans_years.date, marker=\"o\")\nfor X, Y in zip(loans_years.year,loans_years.date):\n    # Annotate the points 5 _points_ above and to the left of the vertex\n    ax.annotate('{}'.format(Y), xy=(X,Y), xytext=(-5, 5), ha='right',\n                textcoords='offset points')\n\nplt.xticks(loans_years.year.tolist())\nplt.grid(True)\nplt.xlabel(\"Year\")\nplt.ylabel(\"Number of loans\")\nplt.title(\"Number of loans by Year\".title())\nplt.show()","66ede1b8":"sector_pie = kiva_loans.groupby(\"sector\").country.count().reset_index().sort_values(by=\"country\", ascending=False)\nplt.figure(figsize=(10,8))\nchart=sns.barplot(data = sector_pie, x=\"sector\", y =\"country\")\nfor p in chart.patches:\n    chart.annotate(\"%.0f\" % p.get_height(), (p.get_x() + p.get_width() \/ 2., p.get_height()),\n                 ha='center', va='center', fontsize=12, color='black', xytext=(0, 7),\n                 textcoords='offset points')\nplt.xticks(rotation=90)\nplt.title(\"Number of loans by sector\".title(), fontsize=18)\nplt.xlabel(\"Sector\", fontsize=12)\nplt.ylabel(\"number of loans\".title())\nplt.show()","d58f8286":"month_year_loans= kiva_loans.groupby([\"year\",\"number_month\",\"month\"]).date.count().reset_index().sort_values(by=[\"year\",\"number_month\"])\nplt.figure(figsize=(20,10))\nchart=sns.lineplot(data=month_year_loans, x=\"month\", y=\"date\", hue=\"year\", palette='jet', linewidth=2.5)\nplt.xticks(rotation=30)\nplt.grid(True)\nplt.title(\"numbers of loans per year\".title(), fontsize=20)\nplt.ylabel(\"numbers of loans\".title())\nplt.xlabel(\"months\".title())\nplt.show()","2eae4be3":"repayment=kiva_loans.groupby([\"repayment_interval\"]).date.count().reset_index()\nrepayment\nplt.figure(figsize=(8,6))\nplt.pie(repayment.date,labels=repayment.repayment_interval, autopct=\"%0.2f%%\")\nplt.axis(\"equal\")\nplt.title(\"Distribution of listed repayment_interval\".title(), fontsize=15)\nplt.legend()\nplt.show()\n","55ab2338":"plt.figure(figsize=(20,12))\n\nplt.subplot(2,2,1)\nfood=kiva_loans[kiva_loans.sector==\"Food\"]\nfood_loans = food.groupby([\"sector\",\"activity\"]).date.count().reset_index().sort_values(by=\"date\", ascending=False).iloc[:10]\nsns.barplot(y=\"activity\", x='date', data=food_loans, palette='Accent')\nfor i, v in enumerate(food_loans.date): \n        plt.text(.6,i+0.1, round(v,2),fontsize=10,color='k')\nplt.title(\"Food sector\".title())\nplt.xlabel(\"Number of loans\")\nplt.ylabel(\"activity\".title())\n\n\nplt.subplot(2,2,2)\nfood=kiva_loans[kiva_loans.sector==\"Arts\"]\nfood_loans = food.groupby([\"sector\",\"activity\"]).date.count().reset_index().sort_values(by=\"date\", ascending=False).iloc[:10]\nsns.barplot(y=\"activity\", x='date', data=food_loans, palette='Accent')\nfor i, v in enumerate(food_loans.date): \n        plt.text(.6,i+0.1, round(v,2),fontsize=10,color='k')\nplt.title(\"art sctor\".title())\nplt.xlabel(\"Number of loans\")\nplt.ylabel(\"activity\".title())\n\nplt.subplot(2,1,2)\nfood=kiva_loans[kiva_loans.sector==\"Agriculture\"]\nfood_loans = food.groupby([\"sector\",\"activity\"]).date.count().reset_index().sort_values(by=\"date\", ascending=False).iloc[:10]\nsns.barplot(y=\"activity\", x='date', data=food_loans, palette='Accent')\nfor i, v in enumerate(food_loans.date): \n        plt.text(.6,i+0.1, round(v,2),fontsize=10,color='k')\nplt.title(\"Agriculture sector\".title())\nplt.xlabel(\"Number of loans\")\nplt.ylabel(\"activity\".title())\nplt.show()","4e3bc983":"plt.figure(figsize=(16,8))\n\npoo = kiva_loans.groupby('country').mean()['loan_amount'].sort_values(ascending=False)\nsns.boxplot(kiva_loans['country'], np.log(kiva_loans['loan_amount']), palette='spring',order=poo.index)\nplt.xlabel('')\nplt.ylabel('Loan amount ($log10$)')\nplt.title('Boxplot of loan amount($log10$)')\nplt.xticks(rotation=90);","5c08005d":"maps =kiva_loans.groupby(\"country\").date.count().reset_index()\n\nimport plotly.offline as py\n\nimport plotly.graph_objs as go\n\n\ndata = [ dict(\n        type = 'choropleth',\n        locations = maps['country'],\n        locationmode = 'country names',\n        z = maps['date'],\n        text = maps['country'],\n        autocolorscale = False,\n        marker = dict(\n            line = dict (\n                color = 'rgb(180,180,180)',\n                width = 0.5\n            ) ),\n        colorbar = dict(\n            autotick = False,\n            tickprefix = '',\n            title = 'Number of Loans'),\n      ) ]\n\nlayout = dict(\n    title = 'Couting of Loans Per Country',\n    geo = dict(\n        showframe = False,\n        showcoastlines = True,\n        projection = dict(\n            type = 'Mercator'\n        )\n    )\n)\n\nfigure = dict( data=data, layout=layout )\npy.iplot(figure, validate=False, filename='map-countrys-count')","8da98d2c":"df_peru = kiva_loans[kiva_loans.country==\"Peru\"]\ndf_peru = df_peru.groupby(\"sector\").region.count().reset_index()\ndf_peru.style.background_gradient()","4bb4c26a":"## Loading Libraries","7b05e9d3":"## Data exploration","281a4adb":"### Number of loans by currency\n\n- PHP: Philippines\n- USD: American Dollars\n- KES: Kenia\n- KHR: Cambodian riel\n","d1e910d9":"### Loans by activity in three different Sectors","13082467":"### Distribution of loans on a world map","993c93e0":"### Boxplot of loan amount","18fbade4":"### Number of loans per year","5f244a68":"# KIVA\n\nKiva.org is an online crowdfunding platform to extend financial services to poor and financially excluded people around the world. Kiva lenders have provided over $1 billion dollars in loans to over 2 million people. In order to set investment priorities, help inform lenders, and understand their target communities, knowing the level of poverty of each borrower is critical. However, this requires inference based on a limited set of information for each borrower.\n","674d3231":"## Check for missing data","128c7eb8":"### Distribution of repayment","e4de82d3":"### Distribution of loans by sectors in Peru","bf519fd1":"## Importing Data","fc49edf5":"### Number of loans in different years"}}