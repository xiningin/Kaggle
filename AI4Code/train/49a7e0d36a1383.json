{"cell_type":{"243e0ec8":"code","4b9a0fc9":"code","b23f1273":"code","eb9646e6":"code","cfbb993e":"code","7381532d":"code","e2d532b2":"code","50cb0f86":"code","1fe6a030":"code","e5629de3":"code","dd15243c":"code","bf7ae1ef":"code","333bfb35":"code","a914f5f9":"code","bb518d4b":"code","0a2ccbaf":"code","3171341e":"code","483adb45":"code","890259a5":"code","9964282b":"code","145c638b":"code","0292a1f1":"code","e72a6d4f":"code","4deb21e2":"code","c686407b":"code","13322606":"code","36e8bb21":"code","b088f3a9":"code","6758c397":"code","e9645269":"code","b1ad8e5f":"code","0f769a9e":"code","0e8bf962":"code","5b15ab1e":"code","e58152d8":"code","76e8d437":"code","56ca457e":"code","7bc5d076":"code","2520284a":"code","8a17a5a6":"code","ec246541":"code","6f5edeff":"code","0b2a979e":"code","5efa52e2":"code","8f0da3ea":"code","f0aad039":"code","9e79eca2":"code","028e92df":"code","11610d0c":"code","340071d0":"code","498cb2de":"code","5d897fd8":"code","384fd689":"code","082b06cd":"code","230c266a":"code","fa76b805":"code","6499df7c":"code","e7385cfe":"code","009e4690":"code","01c14774":"code","7ff36c9d":"code","3d478e59":"code","5f1d1705":"code","93c94a18":"code","3766dc29":"code","9008276d":"code","41591eac":"code","86eb06fd":"code","4ed493a6":"code","041928ef":"code","706b47b0":"code","de4c7a8b":"code","c5e006bf":"markdown","29fdd3fc":"markdown","fd0219b0":"markdown","e321b17a":"markdown","9a2f6bfa":"markdown"},"source":{"243e0ec8":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","4b9a0fc9":"%reload_ext autoreload\n%autoreload 2\n%matplotlib inline","b23f1273":"from fastai.vision import *\nfrom fastai.metrics import error_rate,accuracy","eb9646e6":"bs = 64","cfbb993e":"help(untar_data)","7381532d":"path = untar_data(URLs.PETS); path","e2d532b2":"path.ls()","50cb0f86":"path_anno = path\/'annotations'\npath_img = path\/'images'","1fe6a030":"fnames = get_image_files(path_img)\nfnames[:5]","e5629de3":"np.random.seed(2)\npat = r'\/([^\/]+)_\\d+.jpg$'","dd15243c":"data = ImageDataBunch.from_name_re(path_img, fnames, pat, ds_tfms=get_transforms(), size=224, bs=bs\n                                  ).normalize(imagenet_stats)","bf7ae1ef":"data.show_batch(rows=3, figsize=(7,6))","333bfb35":"print(data.classes)\nlen(data.classes),data.c","a914f5f9":"learn = cnn_learner(data, models.resnet34, metrics=error_rate)","bb518d4b":"learn.fit_one_cycle(4)","0a2ccbaf":"learn.save('stage-1')","3171341e":"interp = ClassificationInterpretation.from_learner(learn)\n\nlosses,idxs = interp.top_losses()\n\nlen(data.valid_ds)==len(losses)==len(idxs)","483adb45":"interp.plot_top_losses(9, figsize=(15,11))","890259a5":"doc(interp.plot_top_losses)","9964282b":"interp.plot_confusion_matrix(figsize=(12,12), dpi=60)","145c638b":"interp.plot_confusion_matrix(normalize=True,figsize=(12,12), dpi=90)","0292a1f1":"interp.most_confused(min_val=2)","e72a6d4f":"learn.unfreeze()","4deb21e2":"learn.fit_one_cycle(1)","c686407b":"learn.load('stage-1');","13322606":"learn.lr_find()","36e8bb21":"learn.recorder.plot()","b088f3a9":"learn.unfreeze()\nlearn.fit_one_cycle(2, max_lr=slice(1e-6,1e-4))","6758c397":"learn.unfreeze()\nlearn.fit_one_cycle(4, max_lr=slice(1e-6,1e-4))","e9645269":"learn.save('stage-2')","b1ad8e5f":"data = ImageDataBunch.from_name_re(path_img, fnames, pat, ds_tfms=get_transforms(),\n                                   size=299, bs=bs\/\/2).normalize(imagenet_stats)","0f769a9e":"learn = cnn_learner(data, models.resnet50, metrics=[error_rate,accuracy])","0e8bf962":"learn.lr_find()\nlearn.recorder.plot()","5b15ab1e":"learn.recorder.plot(suggestion=True)","e58152d8":"learn.fit_one_cycle(8)","76e8d437":"learn.save('stage-1-50');","56ca457e":"learn.fit_one_cycle(8,max_lr=slice())","7bc5d076":"learn.unfreeze()\nlearn.fit_one_cycle(3, max_lr=slice(1e-6,1e-4))","2520284a":"learn.load('stage-1-50');","8a17a5a6":"interp = ClassificationInterpretation.from_learner(learn)","ec246541":"interp.most_confused(min_val=2)","6f5edeff":"path = untar_data(URLs.MNIST_SAMPLE); path","0b2a979e":"tfms = get_transforms(do_flip=False)\ndata = ImageDataBunch.from_folder(path, ds_tfms=tfms, size=26)","5efa52e2":"!ls -1 \/tmp\/.fastai\/data\/mnist_sample\/train\/","8f0da3ea":"data.show_batch(rows=3, figsize=(5,5))","f0aad039":"learn = cnn_learner(data, models.resnet18, metrics=accuracy)\nlearn.fit(2)","9e79eca2":"df = pd.read_csv(path\/'labels.csv')\ndf.head()","028e92df":"data = ImageDataBunch.from_csv(path, ds_tfms=tfms, size=28)","11610d0c":"data.show_batch(rows=3, figsize=(5,5))\ndata.classes","340071d0":"data = ImageDataBunch.from_df(path, df, ds_tfms=tfms, size=24)\ndata.classes","498cb2de":"fn_paths = [path\/name for name in df['name']]; fn_paths[:2]","5d897fd8":"pat = r\"\/(\\d)\/\\d+\\.png$\"\ndata = ImageDataBunch.from_name_re(path, fn_paths, pat=pat, ds_tfms=tfms, size=24)\ndata.classes","384fd689":"data = ImageDataBunch.from_name_func(path, fn_paths, ds_tfms=tfms, size=24,\n        label_func = lambda x: '3' if '\/3\/' in str(x) else '7')\ndata.classes","082b06cd":"tfms","230c266a":"labels = [('3' if '\/3\/' in str(x) else '7') for x in fn_paths]\nlabels[:5]","fa76b805":"data = ImageDataBunch.from_lists(path, fn_paths, labels=labels, ds_tfms=tfms, size=24)\ndata.classes","6499df7c":"data.show_batch()","e7385cfe":"data.save('Stage-3')","009e4690":"path = untar_data(URLs.PETS); path","01c14774":"path_anno = path\/'annotations'\npath_img = path\/'images'","7ff36c9d":"fnames = get_image_files(path_img)\nfnames[:5]","3d478e59":"np.random.seed(2)\npat = r'\/([^\/]+)_\\d+.jpg$'","5f1d1705":"data = ImageDataBunch.from_name_re(path_img, fnames, pat, ds_tfms=get_transforms(), size=224, bs=32\n                                  ).normalize(imagenet_stats)","93c94a18":"data.show_batch(rows=3, figsize=(7,6))","3766dc29":"learn = cnn_learner(data, models.densenet161, metrics=error_rate)","9008276d":"learn.model","41591eac":"learn.fit_one_cycle(3)","86eb06fd":"interp = ClassificationInterpretation.from_learner(learn)\n\nlosses,idxs = interp.top_losses()\n\nlen(data.valid_ds)==len(losses)==len(idxs)","4ed493a6":"interp.plot_top_losses(9, figsize=(15,11))","041928ef":"doc(interp.plot_top_losses)","706b47b0":"interp.plot_confusion_matrix(figsize=(12,12), dpi=60)","de4c7a8b":"interp.most_confused(min_val=2)","c5e006bf":"This is a notebook depicting the various dog breeds from densenet161 image classification using fastai.","29fdd3fc":"#Densenet161","fd0219b0":"Learning model with cnn learner.","e321b17a":"Results","9a2f6bfa":"Creating Image Databunch from image data files"}}