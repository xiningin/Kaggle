{"cell_type":{"22c77ac1":"code","883dd0b5":"code","d8cb18bb":"code","14e03a12":"code","15267fa1":"code","f6de94c8":"code","a5f37adc":"code","53769b6b":"code","187b5aa2":"code","d5eb80dd":"code","5001eb9d":"code","f78fd7fa":"code","6bd3f3d6":"code","3711a3ce":"code","0447a20d":"code","e7e4c53f":"code","697e6b9d":"code","1f2c0375":"code","e65b61a2":"code","83e2c432":"code","7169c774":"code","3dd63a07":"code","577e88a1":"code","26e22f4b":"code","3f57b1b1":"code","0cd28ba0":"code","6778bd8c":"code","64e22d8d":"code","e0da14ca":"markdown","cdeb9aee":"markdown","3025682a":"markdown","bf519ec9":"markdown","dfbc9e43":"markdown","9a24be0c":"markdown","bcc3e7c6":"markdown","d0e9b275":"markdown","c592dbec":"markdown","da8116f4":"markdown","fd2cf7eb":"markdown","3f87ec02":"markdown","cff69eaa":"markdown","287229ff":"markdown","c2d4c995":"markdown","b54fb0ee":"markdown"},"source":{"22c77ac1":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt","883dd0b5":"df_train = pd.read_csv('..\/input\/titanic\/train.csv')","d8cb18bb":"sns.heatmap(df_train.isnull(),yticklabels=False,cmap='viridis')","14e03a12":"df_train.drop(['Cabin'],inplace=True,axis=1)\ndf_train","15267fa1":"sns.boxplot(y='Age',x='Pclass',data=df_train)","f6de94c8":"df_train.at[(df_train['Age'].isnull()) & (df_train['Pclass']==1),'Age'] = 37\ndf_train.at[(df_train['Age'].isnull()) & (df_train['Pclass']==2),'Age'] = 28\ndf_train.at[(df_train['Age'].isnull()) & (df_train['Pclass']==3),'Age'] = 23\ndf_train","a5f37adc":"df_train.at[df_train['Fare'].isnull(),'Fare'] = np.mean(df_train['Fare'])","53769b6b":"sns.heatmap(df_train.isnull(),yticklabels=False,cmap='viridis')","187b5aa2":"pd.get_dummies(df['Sex'],drop_first=True).head()","d5eb80dd":"if any(df['Sex']==42):\n    print(True)","5001eb9d":"sex = pd.get_dummies(df_train['Sex'],drop_first=True)\nsex","f78fd7fa":"embark = pd.get_dummies(df_train['Embarked'],drop_first=True)\nembark","6bd3f3d6":"df_train.drop(['Sex','Embarked','Name','PassengerId','Ticket'],axis=1,inplace=True)","3711a3ce":"df_train","0447a20d":"df_train = pd.concat([df_train,sex,embark],axis=1)\ndf_train","e7e4c53f":"df_test = pd.read_csv('..\/input\/titanic\/test.csv')","697e6b9d":"sns.heatmap(df_test.isnull(),yticklabels=False,cmap='viridis')","1f2c0375":"df_test.drop(['Cabin'],inplace=True,axis=1)\ndf_test","e65b61a2":"sns.boxplot(y='Age',x='Pclass',data=df_test)","83e2c432":"df_test.at[(df_test['Age'].isnull()) & (df_test['Pclass']==1),'Age'] = 42\ndf_test.at[(df_test['Age'].isnull()) & (df_test['Pclass']==2),'Age'] = 25\ndf_test.at[(df_test['Age'].isnull()) & (df_test['Pclass']==3),'Age'] = 22\ndf_test","7169c774":"df_test.at[df_test['Fare'].isnull(),'Fare'] = np.mean(df_test['Fare'])","3dd63a07":"sns.heatmap(df_test.isnull(),yticklabels=False,cmap='viridis')","577e88a1":"pd.get_dummies(df_test['Sex'],drop_first=True).head()\nsex = pd.get_dummies(df_test['Sex'],drop_first=True)\nembark = pd.get_dummies(df_test['Embarked'],drop_first=True)\ndf_test.drop(['Sex','Embarked','Name','PassengerId','Ticket'],axis=1,inplace=True)\ndf_test = pd.concat([df_test,sex,embark],axis=1)","26e22f4b":"df_test","3f57b1b1":"df = pd.read_csv('..\/input\/test-file\/tested.csv')","0cd28ba0":"from sklearn.linear_model import LogisticRegression\nlr = LogisticRegression(max_iter=2000)\nlr.fit(df_train.drop(['Survived'],axis=1),df_train['Survived'])","6778bd8c":"from sklearn.metrics import confusion_matrix\nfrom sklearn.metrics import accuracy_score\n\ny_pred = lr.predict(df_test)\ncm = confusion_matrix(df['Survived'],y_pred)\nprint(cm)\n\naccuracy = accuracy_score(df['Survived'],y_pred)\nprint(accuracy)\n\n\ndf_ans  = pd.DataFrame(columns=['PassengerId','Survived'])\ndf_ans['PassengerId'] = df['PassengerId']\ndf_ans['Survived'] = y_pred","64e22d8d":"df_ans.to_csv('.\/titanic_test.csv',index=False)","e0da14ca":"## Testing ","cdeb9aee":"Sex Categorical Feature Handling","3025682a":"# **Building Logistic Regression Model**","bf519ec9":"## Final Checking for NaN values in dataset","dfbc9e43":"## **Loading Dataset**","9a24be0c":"## **Replacing NaN values for Age column based on average values observed from boxplot w.r.t Pclass**","bcc3e7c6":"### Checking for NAN values using seaborn's heatmap","d0e9b275":"## Handling missing data\nNote - it can be seen that Cabin column has most of cell values NaN, so we can drop that coloumn. While age column NaN values can be handled by replacing it with average values taking into consideration values of PClass.","c592dbec":"### Checking for NAN values using seaborn's heatmap","da8116f4":"### Plotting Boxplot of Age coloumn with Pclass","fd2cf7eb":"# **Preparing Testing Data**","3f87ec02":"## Handling missing data\nNote - it can be seen that Cabin column has most of cell values NaN, so we can drop that coloumn. While age column NaN values can be handled by replacing it with average values taking into consideration values of PClass.","cff69eaa":"Embarked Categorical feature handling","287229ff":"## **Importing Libraries**","c2d4c995":"## **Handling Categorical Features - Sex, Embarked with get_dummies()**","b54fb0ee":"## Replacing NaN value of Fare column with average of Fare field data"}}