{"cell_type":{"e37c7608":"code","cccc8ebb":"code","c28967a5":"code","876f5d9d":"code","b0bf0b0c":"code","0db5fcf0":"code","389d6918":"code","ae09cc15":"code","c48daab8":"code","915dc79f":"code","1f589839":"code","69d60682":"code","2cc27b5c":"code","1fda24d5":"code","f4b34f66":"code","dba11432":"code","979d561a":"code","99961fda":"code","fb0720fd":"code","02f4d0d8":"code","16a67a58":"code","28bde783":"code","407a6057":"code","7dbfce55":"code","1b7dfdb2":"code","2d74e853":"code","d2f82eef":"code","6bb6942a":"code","c98bb5a7":"code","abd3ab89":"code","5e8119bc":"markdown"},"source":{"e37c7608":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","cccc8ebb":"\n\nfrom fastai import *\nfrom fastai.vision import *\n\n","c28967a5":"PATH = '\/kaggle\/input\/100-bird-species'","876f5d9d":"?ImageImageList","b0bf0b0c":"data = (ImageList.from_folder(PATH) #Where to find the data? -> in path and its subfolders\n        .split_by_folder()              #How to split in train\/valid? -> use the folders\n        .label_from_folder()            #How to label? -> depending on the folder of the filenames\n        .databunch())","0db5fcf0":"len(data.valid_dl)","389d6918":"429*64","ae09cc15":"data.normalize(imagenet_stats)","c48daab8":"data.show_batch()","915dc79f":"len(data.classes)","1f589839":"learn = create_cnn(data,models.resnet34,metrics=error_rate)","69d60682":"learn.fit_one_cycle(4)","2cc27b5c":"learn.data","1fda24d5":"learn.lr_find()","f4b34f66":"learn.model_dir='\/kaggle\/working\/' ","dba11432":"learn.save('Stage-1')","979d561a":"learn.lr_find()","99961fda":"learn.recorder.plot()","fb0720fd":"interp = ClassificationInterpretation.from_learner(learn)\n\nlosses,idxs = interp.top_losses()\n\nlen(data.valid_ds)==len(losses)==len(idxs)","02f4d0d8":"interp.plot_top_losses(12,figsize=(15,11))","16a67a58":"interp.plot_confusion_matrix(figsize=(20,20), dpi=60)","28bde783":"interp.most_confused()","407a6057":"learn.unfreeze()","7dbfce55":"learn.fit_one_cycle(1)","1b7dfdb2":"learn.lr_find()","2d74e853":"learn.recorder.plot()","d2f82eef":"learn.fit_one_cycle(2,max_lr=slice(1e-5,1e-4))","6bb6942a":"data_test = (ImageList.from_folder(PATH)\n             .split_by_folder(train='train',valid='test')\n             .label_from_folder()\n             .databunch()\n             .normalize(imagenet_stats)\n            )","c98bb5a7":"learn.validate(data_test.valid_dl) #test set \n#Gives [loss, error_rate]\n# accuracy = (1-error_rate)*100","abd3ab89":"learn.validate(data.valid_dl) #validation set","5e8119bc":"(Actual,Predicted,count)"}}