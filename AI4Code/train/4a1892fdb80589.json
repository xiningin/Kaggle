{"cell_type":{"7c01561c":"code","d17202e0":"code","b7b9c51e":"code","565ae089":"code","50a26e92":"code","59603573":"code","ede667dd":"code","8acf0bd0":"code","eeeb5191":"code","d5843093":"code","15c5e165":"code","9ddf335e":"code","943b755d":"code","da3150e6":"code","b239fbaf":"code","57ab871d":"markdown","b0478bae":"markdown","e837c91f":"markdown","0e012391":"markdown","fbc749dc":"markdown"},"source":{"7c01561c":"!pip install simfin\n!pip install neuralprophet","d17202e0":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\nimport time\n\nfrom neuralprophet import NeuralProphet\n\n# Import the main functionality from the SimFin Python API.\nimport simfin as sf\nprint(\"Simfin Version: \",sf.__version__)\n\nsf.set_data_dir('~\/simfin_data\/')\nsf.set_api_key(api_key='free')\n\nsns.set_style(\"whitegrid\")\nsns.set_palette(\"tab10\")\n\npd.options.display.max_colwidth = 500\npd.options.display.max_rows = 999\npd.options.display.width = 300\npd.options.display.max_columns = 100\n\nnotebookstart = time.time()","b7b9c51e":"df = sf.load(dataset='income', variant='annual', market='us')\ndf['Date'] = pd.to_datetime(df[\"Report Date\"])\ndf['Year'] = df['Date'].dt.year\nprint(\"DF Shape: {} Rows, {} Columns\".format(*df.shape))\nprint(\"Number of Tickers: {}\".format(len(df.Ticker.unique())))","565ae089":"df_prices = sf.load_shareprices(variant='daily', market='us').reset_index().set_index(\"Date\")\nprint(\"DF Shape: {} Rows, {} Columns\".format(*df_prices.shape))\nprint(\"Number of Tickers: {}\".format(len(df_prices.Ticker.unique())))","50a26e92":"allticker = ['FB',\"AMZN\",\"AAPL\",\"NFLX\",\"GOOG\"]","59603573":"check_ticker = [x for x in allticker if x not in df_prices.loc[df_prices.Ticker.isin(allticker)].Ticker.unique()]\nprint(\"All Tickers Available\") if not check_ticker else print(\"Missing:\", check_ticker)\n\nstock = df_prices.loc[df_prices.Ticker.isin(allticker)].copy()\nstock[\"DateTime\"] = pd.to_datetime(stock.index)\nstock[\"Year\"] = pd.to_datetime(stock.DateTime).dt.year\nstock.set_index(\"DateTime\", inplace=True)\ndisplay(stock.sample(3))","ede667dd":"check_ticker = [x for x in allticker if x not in df.loc[df.Ticker.isin(allticker)].Ticker.unique()]\nprint(\"All Tickers Available\") if not check_ticker else print(\"Missing:\", check_ticker)\n\nfndm = df.loc[df.Ticker.isin(allticker)].set_index(\"Year\")\ndisplay(fndm.sample(3))","8acf0bd0":"f, ax = plt.subplots(figsize=[8,4])\nstock.groupby(\"Ticker\")[\"Adj. Close\"].plot(ax=ax)\nax.set_title(\"FAANG Adj. Close Price\")\nax.legend()\nplt.show()","eeeb5191":"# ticker = allticker[0]\n\nfor ticker in allticker:\n    tkr_fndm = fndm.loc[fndm.Ticker == ticker].copy()\n\n    metrics = [\"Gross Profit\",'Revenue', \"Operating Expenses\"]\n    metrics_m = []\n    for m in metrics:\n        new_col = m + \" (Billion USD)\"\n        metrics_m.append(new_col)\n        tkr_fndm[new_col] = np.abs(tkr_fndm[m] \/ 1000000000)\n\n    tkr_fndm[\"Profit to Revenue Ratio\"] = tkr_fndm['Gross Profit'] \/ tkr_fndm['Revenue']\n    tkr_fndm[\"R&D to Revenue Ratio\"] = np.abs(tkr_fndm['Research & Development']) \/ tkr_fndm['Revenue']\n\n    f,ax = plt.subplots(1,2,figsize = [12,4])\n    tkr_fndm[metrics_m].plot(ax=ax[0], linewidth=2)\n    tkr_fndm[[\"Profit to Revenue Ratio\",\"R&D to Revenue Ratio\"]].plot(ax=ax[1], linewidth=2)\n\n    ax[0].set_title(\"{} Operational Metrics\".format(ticker))\n    ax[1].set_title(\"{} Financial Ratios\".format(ticker))\n    ax[1].set_ylim(0,1)\n    plt.tight_layout(pad=2)\n    plt.show()","d5843093":"ts = stock.loc[(stock.Ticker == \"AMZN\") & (stock.Year > 2016), \"Adj. Close\"]\nts.plot()\nplt.title(\"Amazon Adj. Closing Stock Price\")\nplt.show()","15c5e165":"train = ts.reset_index().rename(columns={\"DateTime\":\"ds\", \"Adj. Close\":\"y\"})\n\nm = NeuralProphet()\nmetrics = m.fit(train, freq=\"D\")\nfuture = m.make_future_dataframe(train, periods=120)\nforecast = m.predict(future)","9ddf335e":"fig_forecast = m.plot(forecast)","943b755d":"fig_components = m.plot_components(forecast)","da3150e6":"fig_model = m.plot_parameters()","b239fbaf":"print(\"Script Complete - Runtime: {:.2f} Minutes\".format((time.time() - notebookstart) \/ 60))","57ab871d":"#### FAANG Analysis","b0478bae":"Model seems to struggle with non-stationary, non-highly seasonal data","e837c91f":"### Analyze Fundamentals","0e012391":"# SimFin FAANG analysis Neural Prophet Forecasting\n_By Nick Brooks, December 2021_","fbc749dc":"### Time Series Predictions\n\nExperiment with Neural Prophet Package to forecast and extract components."}}