{"cell_type":{"1c9d9ecb":"code","7bc994df":"code","8e2f2301":"code","5106da20":"code","514e3d13":"code","9c356385":"code","2c8a7289":"code","1c085d5d":"code","95f95757":"code","1f8aa701":"code","b56f25d7":"code","94d79c2c":"code","b92672d1":"code","8c95f0f0":"code","1942a4c1":"code","e390b64b":"code","a5e407fb":"code","44f445d5":"code","3f20bb50":"code","eba95c53":"code","db4f0aa8":"code","c16cc37b":"code","8c7572ab":"code","0eeba5c8":"code","643458ff":"code","73106cba":"code","d789a1d9":"code","3974e8aa":"code","7cc75601":"code","c9e73b5e":"code","40a81624":"code","4f7ffe85":"code","aad470d2":"code","d28b316e":"code","13407c81":"code","5ed91ff3":"code","fb303295":"code","c161ad84":"code","dee27f79":"code","2e103a60":"code","65228e86":"code","341256cd":"code","70c0f68b":"code","58085025":"code","1084f59c":"code","2820bb90":"code","56ebaf67":"code","73a320d6":"code","61d6802d":"code","5a86665a":"code","d98c54a2":"code","916d1058":"code","2245cc66":"code","afd09083":"code","b143ab69":"code","085d6fda":"code","4b034ca2":"code","fae950ff":"code","8f53fe2e":"code","3537aa91":"code","9b3c9e1d":"code","79d834c4":"code","e5405f37":"code","bd1391ce":"code","b84ad12b":"markdown","8762ba3f":"markdown","03c1f263":"markdown","42791cd8":"markdown","68f9d8cb":"markdown","f3be71bb":"markdown","9070f325":"markdown","128cf538":"markdown","fece2e19":"markdown","9c05d81d":"markdown","7adb3f7c":"markdown","e55d0574":"markdown","38ee319a":"markdown","f603d780":"markdown","1176ced5":"markdown","5a88e758":"markdown","7d04d68b":"markdown","34364629":"markdown","d558c6ba":"markdown","f509cc24":"markdown","3ee8f27d":"markdown","d5cea382":"markdown","0b52487f":"markdown","355e2e87":"markdown","81afc5e6":"markdown","9b160011":"markdown","fecaee0f":"markdown","72f70b31":"markdown","7a521117":"markdown","b701cd36":"markdown","eda1b0b8":"markdown","bb9a1e3b":"markdown","42d0e131":"markdown","70314402":"markdown","bbad93df":"markdown","c7140620":"markdown","44646bff":"markdown","a0f632d6":"markdown","7b60e2a7":"markdown","96d588e9":"markdown","83022325":"markdown","dc5c2d62":"markdown","5d8377dc":"markdown","e469494d":"markdown","4a3f867c":"markdown","ca597f6d":"markdown","c4f74e63":"markdown","8cc40d59":"markdown","0af913f3":"markdown","336cd2dd":"markdown","e7c0d132":"markdown","a3729347":"markdown","abb7bfd2":"markdown","66e02452":"markdown","cf06bd16":"markdown","f74ec38c":"markdown","1f40a844":"markdown","630c83b2":"markdown","a4c0b261":"markdown","b6e406f3":"markdown","1e249bf0":"markdown"},"source":{"1c9d9ecb":"# Librer\u00edas necesarias\n\nimport numpy as np \nimport pandas as pd \nimport matplotlib.pyplot as plt\nimport seaborn as sns\nplt.style.use('fivethirtyeight')\nimport warnings\nwarnings.filterwarnings('ignore')\n%matplotlib inline\n\n# Los archivos de datos est\u00e1n disponibles en el directorio \"..\/input\/\" \n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n","7bc994df":"train_data = pd.read_csv(\"\/kaggle\/input\/titanic\/train.csv\")\ntrain_data.head()","8e2f2301":"test_data = pd.read_csv(\"\/kaggle\/input\/titanic\/test.csv\")\ntest_data.head()","5106da20":"train_data.isnull().sum()","514e3d13":"f,ax=plt.subplots(1,2,figsize=(12,8))\ntrain_data['Survived'].value_counts().plot.pie(explode=[0,0.1],ax=ax[0], colors = ['peru', 'darkseagreen'] )\nax[0].set_title('Personas que sobrevivieron al Titanic')\nsns.countplot('Survived',data=train_data, ax=ax[1], palette=\"pastel\")\nax[1].set_title('Personas que sobrevivieron al Titanic')\nplt.show()","9c356385":"train_data.groupby(['Sex','Survived'])['Survived'].count()","2c8a7289":"f,ax=plt.subplots(1,2,figsize=(12,8))\ntrain_data[['Sex','Survived']].groupby(['Sex']).mean().plot.bar(ax=ax[0], color=['darkseagreen'])\nax[0].set_title('Survived vs G\u00e9nero')\nsns.countplot('Sex',hue='Survived',data=train_data,ax=ax[1], palette=\"pastel\")\nax[1].set_title('G\u00e9nero: Survived or Not')\nplt.show()","1c085d5d":"pd.crosstab(train_data.Pclass,train_data.Survived,margins=True).style.background_gradient(cmap='Pastel2')","95f95757":"f,ax=plt.subplots(1,2,figsize=(15,8))\ntrain_data['Pclass'].value_counts().plot.bar(color=['brown','green','khaki'],ax=ax[0])\nax[0].set_title('N\u00famero de pasajeros en cada clase')\nsns.countplot('Pclass',hue='Survived',data=train_data,ax=ax[1], palette=\"OrRd\")\nax[1].set_title('Clase del barco : Sobrevivieron vs Muertos')\nplt.show()","1f8aa701":"pd.crosstab([train_data.Sex,train_data.Survived],train_data.Pclass,margins=True).style.background_gradient(cmap='Pastel2')","b56f25d7":"sns.factorplot('Pclass','Survived',hue='Sex',data=train_data, palette=\"Purples\")\nplt.show()","94d79c2c":"print('Pasajero m\u00e1s mayor:',train_data['Age'].max(),'a\u00f1os')\nprint('Pasajero m\u00e1s joven:',train_data['Age'].min(),'a\u00f1os')\nprint('Media de edad en el Titanic:',train_data['Age'].mean(),'a\u00f1os')","b92672d1":"f,ax=plt.subplots(1,2,figsize=(15,8))\nsns.violinplot(\"Pclass\",\"Age\", hue=\"Survived\", data=train_data,split=True,ax=ax[0], palette=\"Pastel1\")\nax[0].set_title('Clase y Edad vs Supervivencia')\nax[0].set_yticks(range(0,110,10))\nsns.violinplot(\"Sex\",\"Age\", hue=\"Survived\", data=train_data,split=True,ax=ax[1], palette=\"Pastel2\")\nax[1].set_title('Sexo y Edad vs Supervivencia')\nax[1].set_yticks(range(0,110,10))\nplt.show()","8c95f0f0":"train_data['Initial']=0\nfor i in train_data:\n    train_data['Initial']=train_data.Name.str.extract('([A-Za-z]+)\\.') ","1942a4c1":"pd.crosstab(train_data.Initial,train_data.Sex).T.style.background_gradient(cmap='Pastel2') ","e390b64b":"train_data['Initial'].replace(['Mlle','Mme','Ms','Dr','Major','Lady','Countess','Jonkheer','Col','Rev','Capt','Sir','Don'],['Miss','Miss','Miss','Mr','Mr','Mrs','Mrs','Other','Other','Other','Mr','Mr','Mr'],inplace=True)","a5e407fb":"train_data.groupby('Initial')['Age'].mean()","44f445d5":"train_data.loc[(train_data.Age.isnull())&(train_data.Initial=='Mr'),'Age']=33\ntrain_data.loc[(train_data.Age.isnull())&(train_data.Initial=='Mrs'),'Age']=36\ntrain_data.loc[(train_data.Age.isnull())&(train_data.Initial=='Master'),'Age']=5\ntrain_data.loc[(train_data.Age.isnull())&(train_data.Initial=='Miss'),'Age']=22\ntrain_data.loc[(train_data.Age.isnull())&(train_data.Initial=='Other'),'Age']=46","3f20bb50":"train_data.Age.isnull().any()","eba95c53":"f,ax=plt.subplots(1,2,figsize=(18,10))\ntrain_data[train_data['Survived']==0].Age.plot.hist(ax=ax[0],bins=20,edgecolor='black',color='mistyrose')\nax[0].set_title('No sobrevivieron')\ntrain_data[train_data['Survived']==1].Age.plot.hist(ax=ax[1],bins=20,edgecolor='black', color='darkseagreen')\nax[1].set_title('Sobrevivieron')\nplt.show()","db4f0aa8":"pd.crosstab([train_data.Embarked,train_data.Pclass],[train_data.Sex,train_data.Survived],margins=True).style.background_gradient(cmap='Pastel2')","c16cc37b":"sns.factorplot('Embarked','Survived',data=train_data, color=\"salmon\")\nfig=plt.gcf()\nfig.set_size_inches(5,5)\nplt.show()","8c7572ab":"f,ax=plt.subplots(2,2,figsize=(18,15))\nsns.countplot('Embarked',data=train_data,ax=ax[0,0], palette=\"Pastel1\")\nax[0,0].set_title('N\u00famero de Pasajeros que Embarcaron en cada Puerto')\nsns.countplot('Embarked',hue='Sex',data=train_data,ax=ax[0,1], palette=\"Pastel2\")\nax[0,1].set_title('Hombres-Mujeres en Embarque de cada Puerto')\nsns.countplot('Embarked',hue='Survived',data=train_data,ax=ax[1,0], palette=\"Set2\")\nax[1,0].set_title('Embarcados en cada puerto vs Personas que sobrevivieron')\nsns.countplot('Embarked',hue='Pclass',data=train_data,ax=ax[1,1], palette=\"Set3\")\nax[1,1].set_title('Embarcados en Puerto vs Clase')\nplt.subplots_adjust(wspace=0.2,hspace=0.5)\nplt.show()","0eeba5c8":"sns.factorplot('Pclass','Survived',hue='Sex',col='Embarked',data=train_data, palette=\"Purples\")\nplt.show()","643458ff":"train_data['Embarked'].fillna('S',inplace=True)","73106cba":"train_data.Embarked.isnull().any()","d789a1d9":"pd.crosstab([train_data.SibSp],train_data.Survived).style.background_gradient(cmap='Pastel2')","3974e8aa":"f,ax=plt.subplots(1,2,figsize=(20,8))\nsns.barplot('SibSp','Survived',data=train_data,ax=ax[0])\nax[0].set_title('SibSp vs Survived')\nsns.factorplot('SibSp','Survived',data=train_data,ax=ax[1], palette=\"Purples\")\nax[1].set_title('SibSp vs Survived')\nplt.show()","7cc75601":"pd.crosstab(train_data.SibSp,train_data.Pclass).style.background_gradient(cmap='Pastel2')","c9e73b5e":"print('La tarifa m\u00e1s alta fue:',train_data['Fare'].max())\nprint('La tarifa m\u00e1s baja fue:',train_data['Fare'].min())\nprint('La tarifa media fue:',train_data['Fare'].mean())","40a81624":"f,ax=plt.subplots(1,3,figsize=(20,8))\nsns.distplot(train_data[train_data['Pclass']==1].Fare,ax=ax[0], color=\"orange\")\nax[0].set_title('Tarifa en clase 1')\nsns.distplot(train_data[train_data['Pclass']==2].Fare,ax=ax[1], color=\"darkolivegreen\")\nax[1].set_title('Tarifa en clase 2')\nsns.distplot(train_data[train_data['Pclass']==3].Fare,ax=ax[2])\nax[2].set_title('Tarifa en clase 3')\nplt.show()","4f7ffe85":"sns.heatmap(train_data.corr(),annot=True,cmap='RdYlGn',linewidths=0.4) \nfig=plt.gcf()\nfig.set_size_inches(10,8)\nplt.show()","aad470d2":"train_data.head()","d28b316e":"train_data.drop('Cabin', axis = 1, inplace = True)\ntest_data.drop('Cabin', axis = 1, inplace = True)","13407c81":"train_data.head()","5ed91ff3":"combined_data = [train_data, test_data]\nfor data in combined_data:\n    data.Age.fillna(data.Age.mean(), inplace = True)\n    data.Fare.fillna(data.Fare.mean(), inplace = True)\ntrain_data.Embarked.fillna('S', inplace = True)","fb303295":"def change_gender(x):\n    if x == 'male':\n        return 0\n    elif x == 'female':\n        return 1\ntrain_data.Sex = train_data.Sex.apply(change_gender)\ntest_data.Sex = test_data.Sex.apply(change_gender)","c161ad84":"change = {'S':1,'C':2,'Q':0}\ntrain_data.Embarked = train_data.Embarked.map(change)\ntest_data.Embarked = test_data.Embarked.map(change)","dee27f79":"train_data['Alone'] = train_data.SibSp + train_data.Parch\ntest_data['Alone'] = test_data.SibSp + test_data.Parch\n\ntrain_data.Alone = train_data.Alone.apply(lambda x: 1 if x == 0 else 0)\ntest_data.Alone = test_data.Alone.apply(lambda x: 1 if x == 0 else 0)","2e103a60":"train_data.drop(['SibSp','Parch'], axis = 1, inplace = True)\ntest_data.drop(['SibSp','Parch'], axis = 1, inplace = True )","65228e86":"train_data.head()","341256cd":"train_data.Name.str.extract(' ([A-Za-z]+)\\.', expand=False).unique().size","70c0f68b":"for data in combined_data:\n    data['Title'] = data.Name.str.extract('([A-Za-z]+)\\.', expand = False)\n    data.drop('Name', axis = 1, inplace = True)","58085025":"train_data.Title.value_counts()","1084f59c":"test_data.Title.unique()","2820bb90":"least_occuring = [ 'Don', 'Rev', 'Dr', 'Mme', 'Ms',\n       'Major', 'Lady', 'Sir', 'Mlle', 'Col', 'Capt', 'Countess','Dona',\n       'Jonkheer']\nfor data in combined_data:\n    data.Title = data.Title.replace(least_occuring, 'Rare')","56ebaf67":"title_mapping = {\"Mr\": 1, \"Miss\": 2, \"Mrs\": 3, \"Master\": 4, \"Rare\": 5}\nfor data in combined_data:\n    data['Title'] = data['Title'].map(title_mapping)","73a320d6":"train_data.head()","61d6802d":"columns_to_drop = ['PassengerId','Ticket', 'Initial']\ntrain_data.drop(columns_to_drop, axis = 1, inplace = True)\ntest_data.drop(columns_to_drop[1], axis = 1, inplace = True)","5a86665a":"train_data.head()","d98c54a2":"for dataset in combined_data:    \n    dataset.loc[ dataset['Age'] <= 16, 'Age'] = 0\n    dataset.loc[(dataset['Age'] > 16) & (dataset['Age'] <= 32), 'Age'] = 1\n    dataset.loc[(dataset['Age'] > 32) & (dataset['Age'] <= 48), 'Age'] = 2\n    dataset.loc[(dataset['Age'] > 48) & (dataset['Age'] <= 64), 'Age'] = 3\n    dataset.loc[ dataset['Age'] > 64, 'Age'] = 4","916d1058":"for data in combined_data:\n    data.loc[data['Fare'] < 30, 'Fare'] = 1\n    data.loc[(data['Fare'] >= 30) & (data['Fare'] < 50),'Fare'] = 2\n    data.loc[(data['Fare'] >= 50) & (data['Fare'] < 100),'Fare'] = 3\n    data.loc[(data['Fare'] >= 100),'Fare'] = 4","2245cc66":"train_data.head()","afd09083":"X_train = train_data.drop(\"Survived\", axis=1)\nY_train = train_data[\"Survived\"]\nX_test = test_data.drop(\"PassengerId\", axis = 1)\nprint(\"Tama\u00f1o de X_train\",X_train.shape)\nprint(\"Tama\u00f1o de Y_train\",Y_train.shape)\nprint(\"Tama\u00f1o de X_test\",X_test.shape)","b143ab69":"import tensorflow as tf\nfrom tensorflow import keras\nfrom tensorflow.keras import layers\nfrom tensorflow.keras.layers import Dense, Dropout, Input\nfrom tensorflow.keras import models \nfrom tensorflow.keras.models import Sequential","085d6fda":"model = Sequential([\n    layers.Dense(units = 32, input_shape = (7,), activation = 'relu'),\n    layers.Dense(units = 64, activation = 'relu', kernel_initializer = 'he_normal', use_bias = False),\n    layers.BatchNormalization(),\n    layers.Dense(units = 128, activation = 'relu',kernel_initializer = 'he_normal', use_bias = False),\n    layers.Dropout(0.1),\n    layers.Dense(units = 64, activation = 'relu',kernel_initializer = 'he_normal', use_bias = False),\n    layers.Dropout(0.1),\n    layers.Dense(units = 32, activation = 'relu'),\n    layers.Dropout(0.15),\n    layers.Dense(units = 16, activation = 'relu'),\n    layers.Dense(units = 8, activation = 'relu',kernel_initializer = 'he_normal', use_bias = False),\n    layers.Dense(units =1 , activation = 'sigmoid')\n])","4b034ca2":" model.summary()","fae950ff":"model.compile(\n    loss = tf.keras.losses.binary_crossentropy, \n    optimizer = tf.keras.optimizers.SGD(), \n    metrics = ['acc']\n)","8f53fe2e":"model.fit(X_train, Y_train, batch_size = 32, verbose = 2, epochs = 60)","3537aa91":"predict = model.predict(X_test)","9b3c9e1d":"predict = (predict > 0.5).astype(int).ravel()\nprint(predict)","79d834c4":"submit = pd.DataFrame({\"PassengerId\":test_data.PassengerId, 'Survived':predict})\nsubmit.to_csv(\"submission.csv\",index = False)","e5405f37":"from sklearn import metrics\nY_pred_rand = (model.predict(X_train) > 0.5).astype(int)\nprint('Precision : ', np.round(metrics.precision_score(Y_train, Y_pred_rand)*100,2))\nprint('Accuracy : ', np.round(metrics.accuracy_score(Y_train, Y_pred_rand)*100,2))\nprint('Recall : ', np.round(metrics.recall_score(Y_train, Y_pred_rand)*100,2))\nprint('F1 score : ', np.round(metrics.f1_score(Y_train, Y_pred_rand)*100,2))\nprint('AUC : ', np.round(metrics.roc_auc_score(Y_train, Y_pred_rand)*100,2))","bd1391ce":"matrix = metrics.confusion_matrix(Y_train, Y_pred_rand)\nsns.heatmap(matrix, annot = True,fmt = 'g')\nplt.show()","b84ad12b":"Hay otra caracter\u00edstica categ\u00f3rica en el datset, \"Embarked\". Se par\u00f3 en tres puertos C, Q, S. Vamos a ver que consecuencias tuvo esta caracter\u00edstica.","8762ba3f":"Vamos a seguir rellenando valores NaN\n\nComo podemos ver que la mayor\u00eda de personas embarcaron del puerto S, vamos a reemplazar los valores nulos por este puerto.","03c1f263":"\n- POSITIVE CORRELATION: If an increase in feature A leads to increase in feature B, then they are positively correlated. A value 1 means perfect positive correlation.\n\n- NEGATIVE CORRELATION: If an increase in feature A leads to decrease in feature B, then they are negatively correlated. A value -1 means perfect negative correlation.\n\nSi dos caracter\u00edsticas est\u00e1n correlacionadas positivamente, indica que la informaci\u00f3n que contienen es muy similar. Esto se conoce como MultiColinearity.\n\nA lo mejor esa informaci\u00f3n es rebundante y no necesitamos usarla. En el proceso de entrenamiento debemos intentar eliminar este tipo de informaci\u00f3n.\n\nEn nuestro heatmap no hay ninguna caracter\u00edstica que este demasiado correlacionada con otra.","42791cd8":"Las caracter\u00edsticas SibSp y Parch est\u00e1n altamente relacionadas por ello las combinamos y creamos una caracter\u00edstica nueva Alone. \n\nDependiendo si la persona viaj\u00f3 sola o no, se escribir\u00e1 un 0 o un 1.","68f9d8cb":"# **Getting started with Titanic**","f3be71bb":"Creamos el fichero final para submission.csv","9070f325":"Ahora podemos asegurar que no hay valor nulo para la columna Edad","128cf538":"Entrenamos nuestro modelo pas\u00e1ndole el conjunto de caracter\u00edsticas de entramiento y la salida final.\n\nUn tama\u00f1o de batch_size = 32 es habitual.","fece2e19":"Vamos a realizar alguna observaci\u00f3n de las siguientes figuras:\n\n1) La mayor\u00eda de pasajeros que embarcaron en el puerto S eran de Clase 3.\n\n2) En el puerto C parece que hubo muchas probabilidades de sobrevivir. Esto puede que fuese porque hubiese muchos pasajeros de Clase 1 y Clase 2.\n\n3) En el puerto S embarcaron personas ricas (Clase 1). Pero como hubo muchos pasajeros de otras clases, las probilidades de sobrevivir son bajas. \n\n4) En el puerto Q solo embarcaron pasajeros de Clase 3.\n\n5) Hubo muy pocos pasajeros que embarcasen en puerto Q.","9c05d81d":"Tambi\u00e9n necesitamos cambiar los puertos S, C y Q por los valores continuos 1, 2 y 3","7adb3f7c":"Ahora vamos a tarazar obbservaciones de las anteriores figuras:\n\n1) Hay muy pocos ni\u00f1os que no sobreviviesen. \n\n2) Solo hay un pasajero de 80 a\u00f1os que sobreviviese.\n\n3) El n\u00famero m\u00e1ximo de muertos est\u00e1n entre 30-40 a\u00f1os.","e55d0574":"A\u00f1adimos como funci\u00f3n de p\u00e9rdida binary_crossentropy, que es la adecuada para un problema de clasificaci\u00f3n binaria.\n\nTambi\u00e9n a\u00f1adimos como funci\u00f3n de optimizaci\u00f3n Adam. Tambi\u00e9n se ha probado con la funci\u00f3n Gradient Descent, obteniendo peores resultados.\n\nFinalmente queremos obtener como m\u00e9trica el accuracy del problema.","38ee319a":"Ahora ya tenemos los datos preparados para entrenar nuestra red","f603d780":"En esta celda cargamos el archivo test.csv, contiene informaci\u00f3n pasajeros a bordo (418 pasajeros). A partir de los patrones de train.csv, se va predecir si el pasajero sobrevivi\u00f3 o no.","1176ced5":"Una vez realizado el entrenamiento, le pasamos al modelo nuevos ejemplos que no ha visto para que realice una predicci\u00f3n.","5a88e758":"Realizamos la combinaci\u00f3n de datos de entrenamiento y test para que nos sea m\u00e1s sencillo modificar las acciones que queremos en ambas partes. Anteriormente ya hab\u00edamos cambiado la edad por la media en el conjunto de entrenamiento, lo hacemos tambi\u00e9n para el de prueba. Lo mismo para la tarifa y para el embarque ( el puerto S es mayoritario)","7d04d68b":"Pensamos que las siguientes tres columnas de caracter\u00edsticas ya no las necesitamos y las eliminamos. ","34364629":"Los prefijos que menos aparecen los tratamos con el prefijo \"Rare\"","d558c6ba":"En el primer gr\u00e1fico podemos ver la diferencia del n\u00famero de personas en cada clase del barco. Podemos observar que los pasajeros de la Clase 1 se les di\u00f3 preferencia a la hora del rescate. Solo hay que ver el n\u00famero de pasajeros de la Clase 3 fue mucho mayor, pero la supervivencia de ellos fue mucho menor. \n\nVamos a indagar un poco m\u00e1s y mirar el \u00edndice de conexi\u00f3n entre la Clase y el G\u00e9nero juntos.","f509cc24":"Como hemos visto hay muchos valores nulos en la columna de la Edad. Para reemplazar los valores NaN, podemos asignarles el valor de la media. \n\nPero no podemos asignar un valor tan iomportante como la edad de manera aleatoria. \n\nSe nos puede ocurrir utilizar la columna Name, para utilizar el prefijo Mr or Mrs como intuici\u00f3n de la Edad. ","3ee8f27d":"Como estamos en un problema de clasificaci\u00f3n binaria miramos cu\u00e1l ser\u00eda el output ( Survived o Not Supervived) con la funci\u00f3n sigmoide.","d5cea382":"El barplot y factorplot muestra que si un pasajero est\u00e1 solo tiene en torno al 30% de \u00edndice de supervivencia. Al aumentar el n\u00famero de familiares decrece el \u00edndice de supervivencia. Tiene sentido, si estamos con familia intentaremos salvar a nuestros seres queridos. \n\nPero en vamos que viajando con miembros de familia de entre 5-8, es del 0%. A lo mejor es por la clase.\n\nM\u00e1s tarde vemos que es as\u00ed, las personas con m\u00e1s de 3 hermanos estaban casi todos en Clase 3. Familias m\u00e1s humildes y con mayor n\u00famero de hijos.\n","0b52487f":"Definimos nuestro modelo con las siguientes layers","355e2e87":"Solo nos falta cambiar le edad a una caracter\u00edstica categ\u00f3rica. Para ello creamos cuatro rangas de edad y los asignamos a los valores 0,1,2,3,4","81afc5e6":"Primero vamos a realizar un an\u00e1lisis de los datos (Exploratory Data Analysis o EDA). \n\nPara comenzar a controlar el total de los valores nulos de las celdas.","9b160011":"Ahora vamos a mirar una categor\u00eda ordinal. Este tipo de categor\u00eda tiene un orden entre los valores. En nuestro caso en el barco podemos encontrar tres tipos de clases sociales(\"Pclass\"). ","fecaee0f":"Ahora miraremos la caracter\u00edstica de la Edad en nuestro modelo. Esta es un feature continua, que toma entre dos valores entre un punto.","72f70b31":"Cambiamos de una caracter\u00edstica categ\u00f3rica a una continua para nuestra red","7a521117":"Para entrenar nuestra red neuronal necesitamos deshacernos de las caracter\u00edsticas categ\u00f3ricas y transformarlas en entradas que nuestra red pueda aprender.","b701cd36":"La columna Cabina podemos pensar que no es demasiado relevante para nuestro modelo. Vamos a borrarla de nuestro conjunto de entrenamiento y test.","eda1b0b8":"Hacemos el mismo procedimiento para la tarifa pagada por los pasajeros","bb9a1e3b":"Hay tres archivos que existen en este fichero: (1) train.csv, (2) test.csv y (3) gender_submission.csv\n\nEn esta celda cargamos el archivo train.csv, contiene informaci\u00f3n de los pasajeros a bordo (891 pasajeros, uno por cada celda en la tabla)\n\nLos valores en la columna \"Survived\" determinan si el pasajero sobrevivi\u00f3 o no: \n- si es un \"1\", el pasajero sobrevivi\u00f3\n- si es un \"0\", el pasajero muri\u00f3\n","42d0e131":"Podemos realizar las siguientes observaciones de la figura:\n\n1) La probabilidad de supervivencia de los ni\u00f1os parece independiente de la edad.\n\n2) La probabilidad de supervivencia en la Clase 1 es lato e incluso mejro para las mujeres.\n\n3) Para los hombres, la probabilidad de supervivencia baja al aumentar la edad.\n\n4) La probabilidad de supervivencia de las mujeres es mayor.","70314402":"Dividimos nuestro conjunto de datos. \n- Las caracter\u00edsticas de nuestros datos de entrenamiento estar\u00e1n en X_train.\n- La caracter\u00edstica de salida estar\u00e1 en Y_train. \"Survived\".\n- X_test es lo que le vamos a dar a nuestra red para que realice las predicciones una vez entrenado el modelo. Un conjunto de datos etiquetados.","bbad93df":"Vamos a mirar cu\u00e1les son las caracter\u00edsticas de nuestros datos :\n\n- Pclass : 1st = Upper Class 2nd = Middle Class 3rd = Lower Class\n\n- sibsp : The # of siblings \/ spouses aboard the Titanic \n       Sibling = brother, sister, stepbrother, stepsister \n       Spouse = husband, wife \n\n- parch : The # of parents \/ children aboard the Titanic \n    Parent = mother, father \n    Child = daughter, son, stepdaughter, stepson \n\n- Ticket : Ticket number\n\n- Fare : Passenger fare\n\n- Cabin : Cabin number embarked\n\n- Port of Embarkation: C = Cherbourg, Q = Queenstown, S = Southampton\n\nAdeam\u00e1s tenemos las caracter\u00edsticas Name, Sex y Age.","c7140620":"Importamos las librer\u00edas necesarias que vamos a utilizar","44646bff":"Asegurar que no queden valores nulos.","a0f632d6":"Podemos observar que no demasiados pasajeros sobrevivieron. La clase 0 ( Not Survived ) es mayoritaria. \n\nUnos 330 pasajeros, del total de 891 pasajeros del trains.csv, sobrevivieron. \n\nAhora debemos realizar un an\u00e1lisis m\u00e1s profundo para entender mejor los datos, y c\u00f3mo distinguir entre la clase 0 y 1. Vamos a usar para ello las diferenets caracter\u00edsticas del dataset. \n","7b60e2a7":"Las columnas de Edad, la Cabina y el Embarque contienen valores nulos. Hay que intentar arreglar esas celdas para que contengan alg\u00fan valor.","96d588e9":"En la anterior figura podemos ver la separaci\u00f3n entre dos caracter\u00edsticas categ\u00f3ricas, usamos para ello FactorPlot.\n\nGracias al gr\u00e1fico podemos ver que la supervivencia de Mujeres de Clase 1 es casi del 96 %. \n\nAunque podemos ver que las Mujeres en general tuvieron m\u00e1s prefrencia incluso sin mirar la Clase.\n\nPodemos asegurar que la Clase (Pclass) es otra de las caracter\u00edsticas de vital importancia para nuestro modelo.","83022325":"Comprobamos cual es el resumen de las capas de nuestro modelo","dc5c2d62":"Quitamos estas columnas que ya no utilizaremos","5d8377dc":"Comprobamos si los cambios que hemos realizado son los que queremos en nuestro conjunto de datos final","e469494d":"Asi podemos extraer las Iniciales del Nombre.","4a3f867c":"Vamos a realizar dos gr\u00e1ficos que representen el n\u00famero de pasajeros que sobrevivieron.","ca597f6d":"- Primero podemos observar que el n\u00famero de hombres en el barco es mucho mayor que el n\u00famero de mujeres. \n- Pero adem\u00e1s en la segunda figura vemos que el n\u00famero de supervivientes en las mujeres es casi el doble.\n\nPodemos pensar que esta caracter\u00edstica es decisiva en nuestro modelo. Vamos a mirar otras.","c4f74e63":"Ahora vamos a observar los diferentes tipos de caracter\u00edsticas que podemos encontrar.\n\nPor ejemplo tenemos como caracter\u00edsticas categ\u00f3ricas en este dataset, el g\u00e9nero o la supervivencia. Una categorical feature tiene dos o m\u00e1s categor\u00edas a las que puede pertenecer. \n\nEn este celda contamos el n\u00famero de instancias dependiendo de la categor\u00eda \"Sex\" y \"Survived\"","8cc40d59":"Aqu\u00ed podemos ver la probabilidad de sobrevivir dependinedo del puerto del que embarcases. La probabilidad de supervivencia del Puerto C es la mayor del 0.55, mientras que el puerto S y Q tienen una probabilidad mucho menor.","0af913f3":"Ahora miramos otra caracter\u00edstica importante, la tarifa.","336cd2dd":"Por \u00faltimo en nuestro EDA, vamos a mirar la correlaci\u00f3n entre caracter\u00edsiticas con nuestro heatmap.","e7c0d132":"Vamos a mirar la media de edad por cada prefijo de Nombre.","a3729347":"Comprobamos que se ha borrado correctamente. Tambi\u00e9n habr\u00eda que comprobarlo de nuestro conjunto test.","abb7bfd2":"Vamos a realizar alguna observaci\u00f3n de las siguientes figuras:\n\n1) El \u00edndice de supervivencia es casi de 1 para Mujeres de Clase 1 y Clase 2.\n\n2) Para los hombres el \u00edndice de supervivencia de Clase 3 es muy bajo. ","66e02452":"He buscado como realizar la matriz de confusi\u00f3n siguiendo la f\u00f3rmula de distintas m\u00e9tricas","cf06bd16":"Vamos ahora a reemplazarlos con la edad media","f74ec38c":"Comprobamos que tenemos los datos de la manera que quer\u00edamos","1f40a844":"En estos gr\u00e1ficos podemos ver la proporci\u00f3n de las tarifas en las distintas clases. Parece una caracter\u00edstica correlacionada con las clase del barco.","630c83b2":"Este paso ya lo realizamos anteriormente en nuestro preprocesado de datos. Ahora lo hacemos para los datos de prueba tambi\u00e9n.","a4c0b261":"Despu\u00e9s de realizar el preprocesado de datos vamos a contruir nuestro modelo\n\nObservamos nuestro conjunto de datos","b6e406f3":"Hay ocaciones que Miss puede estar mal escrito con Mlle or Mme. Las reemplazamos.","1e249bf0":"Vamos ahorar a mirar una nueva caracter\u00edstica (SibSip). La mayor\u00eda de personas viajaron con compa\u00f1\u00eda y vamos a ver la influencia de esta carcter\u00edstica en el dataset. \n\nEsta caracter\u00edstica representa si una persona viaj\u00f3 sola o con familiares."}}