{"cell_type":{"210f2a48":"code","77b0cd22":"code","0dea2088":"code","aa34bccb":"code","c8bbf02d":"code","951558b0":"code","727f6153":"code","fac40e47":"code","e145a227":"code","2183ed00":"markdown","92726d1c":"markdown","70b066c8":"markdown"},"source":{"210f2a48":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\nimport os\nROOT_DIR = '..\/input\/cassava-leaf-disease-classification\/'\nos.listdir(ROOT_DIR)","77b0cd22":"from PIL import Image\nfrom keras.models import load_model","0dea2088":"TEST_DIR = '..\/input\/cassava-leaf-disease-classification\/test_images\/'","aa34bccb":"# load the best saved model as a new model\nnew_model = load_model('..\/input\/cassava-leaf-disease-first-look-and-training\/best_model.hdf5')","c8bbf02d":"new_model.summary()","951558b0":"IMG_SIZE = 300\nsize = (IMG_SIZE,IMG_SIZE)","727f6153":"test_images = os.listdir(TEST_DIR)\npreds = []\nfor image in test_images:\n    img = Image.open(TEST_DIR + image)\n    img = img.resize(size)\n    img = np.expand_dims(img, axis=0)\n    preds.extend(new_model.predict(img).argmax(axis = 1))","fac40e47":"preds","e145a227":"sub = pd.DataFrame({'image_id': test_images, 'label': preds})\ndisplay(sub)\nsub.to_csv('submission.csv', index = False)","2183ed00":"# Prediction and submission","92726d1c":"# Load the best model from training","70b066c8":"[Training Notebook](https:\/\/www.kaggle.com\/lavanyask\/cassava-leaf-disease-first-look-and-training)"}}