{"cell_type":{"40c16441":"code","87399f95":"code","2ea7d89e":"code","57b4f8d0":"code","369e6b87":"code","1d9a1805":"code","f1225e03":"code","8fb4688c":"code","989ee961":"code","833ae38a":"code","48530af0":"code","179ae1f1":"code","93023871":"code","29be08cb":"code","de487e49":"code","93c242cb":"code","29778be3":"code","2ac64fb3":"code","35dbf068":"code","27d59a38":"code","f238db7d":"code","ab0e0058":"code","cccf170e":"markdown","fb996d92":"markdown","8f82d399":"markdown","798ef531":"markdown","b628db2c":"markdown","5a50e961":"markdown","b0ddd759":"markdown","5d2a67aa":"markdown","b5ccae38":"markdown","2ec5d241":"markdown","1f7ee8d1":"markdown"},"source":{"40c16441":"import numpy as np\nimport matplotlib.pyplot as plt\nimport tensorflow\nfrom tensorflow.keras.layers import Input, Lambda, Dense, Flatten\nfrom tensorflow.keras.models import Model\nfrom tensorflow.keras.models import load_model\nfrom tensorflow.keras.applications.inception_v3 import preprocess_input\nfrom tensorflow.keras.applications import MobileNetV2\nfrom tensorflow.keras.optimizers import Adam\nfrom tensorflow.keras.applications.mobilenet_v2 import preprocess_input\nfrom tensorflow.keras.preprocessing import image\nfrom tensorflow.keras.preprocessing.image import ImageDataGenerator,load_img\nfrom tensorflow.keras.models import Sequential\nfrom tensorflow.keras.callbacks import ModelCheckpoint\nfrom glob import glob\n\n","87399f95":"IMAGE_SIZE = [224, 224]\n\ntrain_path = \"\/content\/drive\/MyDrive\/mask_detection\/dataset\/train\"\ntest_path  = \"\/content\/drive\/MyDrive\/mask_detection\/dataset\/valid\"","2ea7d89e":"train_datagen = ImageDataGenerator(rescale = 1.\/255,\n                                   shear_range = 0.2,\n                                   zoom_range = 0.2,\n                                   horizontal_flip = True)\n\ntest_datagen = ImageDataGenerator(rescale = 1.\/255)","57b4f8d0":"training_set = train_datagen.flow_from_directory(train_path,\n                                                 target_size = (224, 224),\n                                                 batch_size = 32,\n                                                 class_mode = 'categorical')","369e6b87":"test_set = test_datagen.flow_from_directory(test_path,\n                                            target_size = (224, 224),\n                                            batch_size = 32,\n                                            class_mode = 'categorical')","1d9a1805":"training_set.class_indices","f1225e03":"test_set.class_indices\n","8fb4688c":"def Show_Image(img_arr):\n  fig,axes=plt.subplots(1,5,figsize=(20,20))\n  axes=axes.flatten()\n\n  for img,ax in zip(img_arr,axes):\n    ax.imshow(img)\n  \n  plt.tight_layout()\n  plt.show()","989ee961":"images=[training_set[0][0][0] for i in range(6)]\nShow_Image(images)","833ae38a":"images=[test_set[0][0][0] for i in range(6)]\nShow_Image(images)","48530af0":"model_mobilenet=MobileNetV2(input_shape=IMAGE_SIZE + [3], weights='imagenet', include_top=False)","179ae1f1":"for layer in model_mobilenet.layers:\n    layer.trainable = False","93023871":"folders = glob('\/content\/drive\/MyDrive\/mask_detection\/dataset\/train\/*')","29be08cb":"folders","de487e49":"x = Flatten()(model_mobilenet.output)","93c242cb":"prediction = Dense(len(folders), activation='softmax')(x)\n","29778be3":"model = Model(model_mobilenet.input, outputs=prediction)","2ac64fb3":"model.summary()","35dbf068":"model.compile(\n  loss='categorical_crossentropy',\n  optimizer='adam',\n  metrics=['accuracy'])","27d59a38":"result = model.fit(\n  training_set,\n  validation_data=test_set,\n  epochs=50,\n  steps_per_epoch=len(training_set),\n  validation_steps=len(test_set)\n)","f238db7d":"plt.plot(result.history['loss'], label='Training Loss')\nplt.plot(result.history['val_loss'], label='Validation Loss')\nplt.legend()\nplt.show()\nplt.savefig('Loss_Value')\n\n\nplt.plot(result.history['accuracy'], label='Training Accuracy')\nplt.plot(result.history['val_accuracy'], label='Validation Accuracy')\nplt.legend()\nplt.show()\nplt.savefig('Accuracy_Value')","ab0e0058":"model.save('\/content\/drive\/MyDrive\/mask_detection\/model.h5')","cccf170e":"TESTING DATASET","fb996d92":"IMPORT THE LIBRARIES","8f82d399":"MODEL TRAINING","798ef531":"LOSS AND ACCURACY","b628db2c":"THE FINAL MODEL","5a50e961":"READING THE DATA PATH","b0ddd759":"FACE MASK DETECTION SYSTEM ","5d2a67aa":"MOBILENETV2 MODEL FOR TRAINING","b5ccae38":"DATA AUGMENTED IMAGES\n\n\n","2ec5d241":"TRAINING DATASET","1f7ee8d1":"DATA AUGMENTATION"}}