{"cell_type":{"ebb6419a":"code","8ded7033":"code","be627ac1":"code","58582f3f":"code","749756bb":"code","a7195bbb":"code","ddf22bd8":"code","d32c545e":"code","2cf1a8c3":"code","63964538":"code","578030b8":"code","1a32744d":"code","109b6dac":"code","2f16c1b6":"code","72f8ed13":"code","e27edac2":"code","5edcadc0":"code","617923f9":"code","ce91c121":"code","7b848252":"code","a1d6533d":"code","8de575d0":"code","c7dabc2e":"code","2b4cff2d":"code","02400739":"code","4ba2c001":"code","5266f51e":"code","f5fd9c79":"code","bb5dbc77":"code","e4ff8dd6":"code","bc95d97a":"code","95ad58b8":"code","2bcd3564":"code","03371ea6":"code","ace9d7d2":"code","1b9f12fe":"code","2559259c":"code","d647cdc6":"code","1d39538f":"code","9b4d8f00":"code","eada9806":"code","cb498ad7":"code","43d2cde0":"code","ad652c1f":"code","8c9164c4":"code","b7e3e29a":"code","cf3fec50":"code","207431d9":"code","b42bf943":"code","485151ba":"code","166cdadc":"code","8356864d":"code","1d9d7381":"code","b3bff79d":"code","ad40de5e":"code","d7e27d99":"code","ce67fc33":"code","033d88d9":"code","f7c4ba32":"code","ea5dceea":"code","2b82ac2a":"code","359f25c9":"code","a7090db3":"code","10e855f8":"code","55da610e":"code","21d26ef3":"code","db3fff5a":"code","68258292":"code","e5b8b769":"code","275d1877":"code","11afa7b3":"code","28f91ab3":"code","007f1d14":"code","54cc8046":"code","9d3c1224":"code","7cbe2bb9":"code","6e87b19c":"code","8234db33":"code","5af0baae":"code","d95f9795":"code","5f7cf321":"code","98e5baad":"code","b878bdda":"code","a611b4f4":"code","a3529998":"code","0aee6108":"code","1fe33976":"markdown","792f4cf1":"markdown","95278572":"markdown","f6a2db6a":"markdown","28c623ad":"markdown","6c8d472f":"markdown","1f2d937d":"markdown","4bae896f":"markdown","61b2ed31":"markdown","78b91e66":"markdown","a6375140":"markdown","9bcc917d":"markdown","a3f2f7ae":"markdown","8e4fb36e":"markdown","ba129568":"markdown"},"source":{"ebb6419a":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nfrom scipy.stats import skew\nfrom scipy.special import boxcox1p\nfrom scipy.stats import boxcox_normmax\nfrom scipy.stats import boxcox\nfrom scipy.special import inv_boxcox\nimport seaborn as sb\nimport matplotlib.pyplot as plt\nimport lightgbm as lgb\nimport xgboost as xgb\nfrom sklearn.neural_network import MLPRegressor\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.model_selection import RandomizedSearchCV, KFold,GridSearchCV\nfrom sklearn.metrics import r2_score,mean_absolute_error,mean_squared_error\nfrom sklearn.preprocessing import StandardScaler,RobustScaler,LabelEncoder,PowerTransformer\nfrom sklearn.ensemble import GradientBoostingRegressor,StackingRegressor, RandomForestRegressor, ExtraTreesRegressor\nfrom sklearn.linear_model import ElasticNetCV, LassoCV, RidgeCV\nfrom sklearn.model_selection import KFold, cross_val_score\nfrom sklearn.pipeline import make_pipeline\nfrom sklearn.tree import DecisionTreeRegressor\nfrom sklearn.cluster import DBSCAN\nfrom sklearn.neighbors import NearestNeighbors\nfrom sklearn.decomposition import PCA\n\n\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport warnings\nwarnings.filterwarnings(\"ignore\")\n\npd.set_option('display.max_columns', 5000)\npd.set_option('display.max_rows', 5000)\n\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","8ded7033":"train=pd.read_csv('\/kaggle\/input\/house-prices-advanced-regression-techniques\/train.csv')\ntest=pd.read_csv('\/kaggle\/input\/house-prices-advanced-regression-techniques\/test.csv')\nsample_sub=pd.read_csv('\/kaggle\/input\/house-prices-advanced-regression-techniques\/sample_submission.csv')","be627ac1":"train.head()","58582f3f":"train[train.SalePrice>300000]","749756bb":"train.tail()","a7195bbb":"train.info()","ddf22bd8":"train.describe()","d32c545e":"correlation_train=train.corr()\nsb.set(font_scale=2)\nplt.figure(figsize = (50,35))\nax = sb.heatmap(correlation_train, annot=True,annot_kws={\"size\": 25},fmt='.1f',cmap='PiYG', linewidths=.5)","2cf1a8c3":"correlation_train.columns","63964538":"corr_dict=correlation_train['SalePrice'].sort_values(ascending=False).to_dict()\nimportant_columns=[]\nfor key,value in corr_dict.items():\n    if ((value>0.1) & (value<0.8)) | (value<=-0.1):\n        important_columns.append(key)\nimportant_columns","578030b8":"plt.figure(figsize=(40,20))\nsb.set(font_scale=1.5)\nsb.boxplot(x='YearBuilt', y=\"SalePrice\", data=train)\nsb.swarmplot(x='YearBuilt', y=\"SalePrice\", data=train, color=\".25\")\nplt.xticks(weight='bold',rotation=90)\n","1a32744d":"test.head()","109b6dac":"test.tail()","2f16c1b6":"test.info()","72f8ed13":"test.describe()","e27edac2":"train_test=pd.concat([train,test],axis=0,sort=False)\ntrain_test.head()","5edcadc0":"pd.set_option('display.max_rows', 5000)\ntrain_test_null_info=pd.DataFrame(train_test.isnull().sum(),columns=['Count of NaN'])\ntrain_test_dtype_info=pd.DataFrame(train_test.dtypes,columns=['DataTypes'])\ntrain_tes_info=pd.concat([train_test_null_info,train_test_dtype_info],axis=1)\ntrain_tes_info","617923f9":"train_test.loc[train_test['Fireplaces']==0,'FireplaceQu']='Nothing'\ntrain_test['LotFrontage'] = train_test['LotFrontage'].fillna(train_test.groupby('1stFlrSF')['LotFrontage'].transform('mean'))\ntrain_test['LotFrontage'].interpolate(method='linear',inplace=True)\ntrain_test['LotFrontage']=train_test['LotFrontage'].astype(int)\ntrain_test['MasVnrArea'] = train_test['MasVnrArea'].fillna(train_test.groupby('MasVnrType')['MasVnrArea'].transform('mean'))\ntrain_test['MasVnrArea'].interpolate(method='linear',inplace=True)\ntrain_test['MasVnrArea']=train_test['MasVnrArea'].astype(int)\ntrain_test[\"Fence\"] = train_test[\"Fence\"].fillna(\"None\")\ntrain_test[\"FireplaceQu\"] = train_test[\"FireplaceQu\"].fillna(\"None\")\ntrain_test[\"Alley\"] = train_test[\"Alley\"].fillna(\"None\")\ntrain_test[\"PoolQC\"] = train_test[\"PoolQC\"].fillna(\"None\")\ntrain_test[\"MiscFeature\"] = train_test[\"MiscFeature\"].fillna(\"None\")\ntrain_test.loc[train_test['BsmtFinSF1']==0,'BsmtFinType1']='Unf'\ntrain_test.loc[train_test['BsmtFinSF2']==0,'BsmtQual']='TA'\ntrain_test['YrBltRmd']=train_test['YearBuilt']+train_test['YearRemodAdd']\ntrain_test['Total_Square_Feet'] = (train_test['BsmtFinSF1'] + train_test['BsmtFinSF2'] + train_test['1stFlrSF'] + train_test['2ndFlrSF'] + train_test['TotalBsmtSF'])\ntrain_test['Total_Bath'] = (train_test['FullBath'] + (0.5 * train_test['HalfBath']) + train_test['BsmtFullBath'] + (0.5 * train_test['BsmtHalfBath']))\ntrain_test['Total_Porch_Area'] = (train_test['OpenPorchSF'] + train_test['3SsnPorch'] + train_test['EnclosedPorch'] + train_test['ScreenPorch'] + train_test['WoodDeckSF'])\ntrain_test['exists_pool'] = train_test['PoolArea'].apply(lambda x: 1 if x > 0 else 0)\ntrain_test['exists_garage'] = train_test['GarageArea'].apply(lambda x: 1 if x > 0 else 0)\ntrain_test['exists_fireplace'] = train_test['Fireplaces'].apply(lambda x: 1 if x > 0 else 0)\ntrain_test['exists_bsmt'] = train_test['TotalBsmtSF'].apply(lambda x: 1 if x > 0 else 0)\ntrain_test['old_house'] = train_test['YearBuilt'].apply(lambda x: 1 if x <1990 else 0)\n\nfor i in train_test.columns:\n    if 'SalePrice' not in i:\n        if 'object' in str(train_test[str(i)].dtype):\n            train_test[str(i)]=train_test[str(i)].fillna(method='ffill')\n","ce91c121":"columns = ('FireplaceQu', 'BsmtQual', 'BsmtCond', 'GarageQual', 'GarageCond', 'ExterQual', 'ExterCond','HeatingQC', 'PoolQC', 'KitchenQual', 'BsmtFinType1', 'YrSold', 'MoSold', 'BsmtFinType2', 'Functional', 'Fence', 'BsmtExposure', 'GarageFinish', 'LandSlope', 'LotShape', 'PavedDrive', 'Street', 'Alley', 'CentralAir', 'MSSubClass', 'OverallCond')\n\nfor col in columns:\n    lbl_enc = LabelEncoder() \n    lbl_enc.fit(list(train_test[col].values)) \n    train_test[col] = lbl_enc.transform(list(train_test[col].values))","7b848252":"numeric_features = train_test.dtypes[train_test.dtypes != \"object\"].index\nskewed_features = train_test[numeric_features].apply(lambda x: skew(x)).sort_values(ascending=False)\nprint(skewed_features)","a1d6533d":"high_skewness = skewed_features[abs(skewed_features) > 0.9]\nskewed_features = high_skewness.index","8de575d0":"print(high_skewness)\nprint('\\nVariables with high skewness: \\n\\n',skewed_features)","c7dabc2e":"train_test[['MiscVal', 'PoolArea', 'exists_pool', 'LotArea', 'LowQualFinSF', '3SsnPorch', 'LandSlope', 'KitchenAbvGr', 'EnclosedPorch',\n       'ScreenPorch', 'MasVnrArea', 'OpenPorchSF', 'WoodDeckSF', 'LotFrontage', '1stFlrSF', 'Total_Porch_Area', 'GrLivArea', 'BsmtExposure',\n       'KitchenQual', 'ExterQual', 'Fence', 'ExterCond', 'PavedDrive', 'BsmtCond', 'BsmtFinType2', 'CentralAir', 'GarageQual', 'exists_garage',\n       'Functional', 'GarageCond', 'exists_bsmt', 'BsmtQual', 'Street','PoolQC']].head()","2b4cff2d":"for feature in skewed_features:\n    train_test[feature] = boxcox1p(train_test[feature], boxcox_normmax(train_test[feature] + 1))\n","02400739":"train_test[['MiscVal', 'PoolArea', 'exists_pool', 'LotArea', 'LowQualFinSF', '3SsnPorch', 'LandSlope', 'KitchenAbvGr', 'EnclosedPorch',\n       'ScreenPorch', 'MasVnrArea', 'OpenPorchSF', 'WoodDeckSF', 'LotFrontage', '1stFlrSF', 'Total_Porch_Area', 'GrLivArea', 'BsmtExposure',\n       'KitchenQual', 'ExterQual', 'Fence', 'ExterCond', 'PavedDrive', 'BsmtCond', 'BsmtFinType2', 'CentralAir', 'GarageQual', 'exists_garage',\n       'Functional', 'GarageCond', 'exists_bsmt', 'BsmtQual', 'Street','PoolQC']].head()","4ba2c001":"train_test=pd.get_dummies(train_test,dtype='int8')","5266f51e":"train_test_null_info=pd.DataFrame(train_test.isnull().sum(),columns=['Count of NaN'])\ntrain_test_dtype_info=pd.DataFrame(train_test.dtypes,columns=['DataTypes'])\ntrain_test_info=pd.concat([train_test_null_info,train_test_dtype_info],axis=1)\ntrain_test_info","f5fd9c79":"train=train_test[0:1460]\ntest=train_test[1460:2919]","bb5dbc77":"len(train)","e4ff8dd6":"train.interpolate(method='linear',inplace=True)\ntest.interpolate(method='linear',inplace=True)","bc95d97a":"corr_new_train=train.corr()\nplt.figure(figsize=(5,15))\nsb.heatmap(corr_new_train[['SalePrice']].sort_values(by=['SalePrice'],ascending=False).head(30),annot_kws={\"size\": 16},vmin=-1, cmap='PiYG', annot=True)\nsb.set(font_scale=2)","95ad58b8":"corr_dict2=corr_new_train['SalePrice'].sort_values(ascending=False).to_dict()\ncorr_dict2","2bcd3564":"best_columns=[]\nfor key,value in corr_dict2.items():\n    if ((value>=0.3175) & (value<0.9)) | (value<=-0.315):\n        best_columns.append(key)\nbest_columns","03371ea6":"print(len(best_columns))","ace9d7d2":"plt.figure(figsize=(25,10))\nsb.set(font_scale=1.4)\ntrain.boxplot(column=best_columns)\nplt.xticks(weight='bold',rotation=90)\n","1b9f12fe":"train['SalePrice_Log1p'] = np.log1p(train.SalePrice)","2559259c":"train.head()","d647cdc6":"print(min(train['SalePrice_Log1p']))\nprint(max(train['SalePrice_Log1p']))","1d39538f":"plt.figure(figsize=(10,8))\nsb.set(font_scale=1.2)\nsb.distplot(train['SalePrice'],color='violet')\nplt.xlabel('SalePrice',fontsize=20)\nprint('Skew Dist:',train['SalePrice'].skew())\nprint('Kurtosis Dist:',train['SalePrice'].kurt())","9b4d8f00":"plt.figure(figsize=(10,8))\nsb.set(font_scale=1.2)\nsb.distplot(train['SalePrice_Log1p'],color='indigo')\nplt.xlabel('SalePrice_Log1p',fontsize=20)\nprint('Skew Dist:',train['SalePrice_Log1p'].skew())\nprint('Kurtosis Dist:',train['SalePrice_Log1p'].kurt())","eada9806":"print(len(train[(train.KitchenQual==3) & (train.SalePrice>360000)].index))","cb498ad7":"len(train)","43d2cde0":"plt.style.use('ggplot')\nplt.figure(figsize=(20,12))\nrbst_scaler=RobustScaler()\ntrain_rbst=rbst_scaler.fit_transform(train)\n\npca=PCA(50).fit(train_rbst)\nplt.plot(pca.explained_variance_ratio_.cumsum())\nplt.xticks(np.arange(0, 50, 1))\nplt.xlabel('Number of components',fontweight='bold',size=14)\nplt.ylabel('Explanined variance ratio for number of components',fontweight='bold',size=14)\n\ntrain_pca=PCA(3).fit_transform(train_rbst)","ad652c1f":"neigh = NearestNeighbors(n_neighbors=2)\nnbrs = neigh.fit(train)\ndistances, indices = nbrs.kneighbors(train)\ndistances = np.sort(distances, axis=0)\ndistances = distances[:,1]\nplt.figure(figsize=(15,15))\nplt.plot(distances)","8c9164c4":"dbscan = DBSCAN(eps=1400, min_samples=20).fit(train_pca)\ncore_samples_mask = np.zeros_like(dbscan.labels_, dtype=bool)\ncore_samples_mask[dbscan.core_sample_indices_] = True\nlabels=dbscan.labels_\nn_clusters_ = len(set(labels)) - (1 if -1 in labels else 0)","b7e3e29a":"unique_labels = set(labels)\nplt.figure(figsize=(12,12))\ncolors = [plt.cm.prism(each)  for each in np.linspace(0, 1, len(unique_labels))]\nfor k, col in zip(unique_labels, colors):\n    if k == -1:\n        # Black used for noise.\n        col = [0, 0, 0, 1]\n\n    class_member_mask = (labels == k)\n    \n    xy = train_pca[class_member_mask & core_samples_mask]\n    plt.plot(xy[:, 0], xy[:, 1], 'o', markerfacecolor=tuple(col),\n             markeredgecolor='k', markersize=14)\n\n    xy = train_pca[class_member_mask & ~core_samples_mask]\n    plt.plot(xy[:, 0], xy[:, 1], 'o', markerfacecolor=tuple(col),\n             markeredgecolor='k', markersize=6)\n\nplt.title('Estimated number of clusters: %d' % n_clusters_)\nplt.show()","cf3fec50":"labels=pd.DataFrame(labels,columns=['Classes'])\nprint(labels[labels['Classes']==-1])","207431d9":"train=pd.concat([train,labels],axis=1)","b42bf943":"train[train.Classes==-1]","485151ba":"train.drop([197,810,1170,1182,1298,1386,1423],axis=0,inplace=True)","166cdadc":"plt.style.use('dark_background')\nfig, axes = plt.subplots(18, 2,figsize=(20,80))\nfig.subplots_adjust(hspace=0.6)\ncolors=[plt.cm.prism_r(each) for each in np.linspace(0, 1, len(best_columns))]\nfor i,ax,color in zip(best_columns,axes.flatten(),colors):\n    sb.regplot(x=train[i], y=train[\"SalePrice\"], fit_reg=True,marker='o',scatter_kws={'s':50,'alpha':0.8},color=color,ax=ax)\n    plt.xlabel(i,fontsize=12)\n    plt.ylabel('SalePrice',fontsize=12)\n    ax.set_yticks(np.arange(0,900001,100000))\n    ax.set_title('SalePrice'+' - '+str(i),color=color,fontweight='bold',size=20)","8356864d":"plt.style.use('ggplot')\nfig, axes = plt.subplots(18, 2,figsize=(20,60))\nfig.subplots_adjust(hspace=0.8)\nsb.set(font_scale=1.2)\ncolors=[plt.cm.prism_r(each) for each in np.linspace(0, 1, len(best_columns))]\nfor i,ax,color in zip(best_columns,axes.flatten(),colors):\n    sb.regplot(x=train[i], y=train[\"SalePrice_Log1p\"], fit_reg=True,marker='o',scatter_kws={'s':50,'alpha':0.7},color=color,ax=ax)\n    plt.xlabel(i,fontsize=12)\n    plt.ylabel('SalePrice_Log1p',fontsize=12)\n    ax.set_title('SalePrice_Log1p'+' - '+str(i),color=color,fontweight='bold',size=20)","1d9d7381":"\"Looking at the SalePrice and SalePrice_Log1p visualizations\"\n\n#train = train.drop(train[(train.OverallQual==4) & (train.SalePrice>200000)].index)\n#train = train.drop(train[(train.OverallQual==10) & (train.SalePrice<200000)].index)\n#train = train.drop(train[(train.Total_Square_Feet>=10000) & (train.SalePrice<200000)].index)\n#train = train.drop(train[(train.Total_SF<3000) & (train.SalePrice>375000)].index)\n#train = train.drop(train[(train.GrLivArea>4500) & (train.SalePrice<200000)].index)\n#train = train.drop(train[(train.GrLivArea<3000) & (train.SalePrice>575000)].index)\n#train = train.drop(train[(train.GarageArea>1200) & (train.SalePrice<165000)].index)\n#train = train.drop(train[(train.Total_Bath.isin([5,6])) & (train.SalePrice<200000)].index)\n#train = train.drop(train[(train.TotRmsAbvGrd==10) & (train.SalePrice>700000)].index)\n#train = train.drop(train[(train.YearBuilt<1900) & (train.SalePrice>250000)].index)\n#train = train.drop(train[(train.YearBuilt>2000) & (train.SalePrice<100000)].index)\n#train = train.drop(train[(train.YearRemodAdd<1970) & (train.SalePrice>350000)].index)\n#train = train.drop(train[(train.MasVnrArea>=1400) & (train.SalePrice<250000)].index)\n#train = train.drop(train[(train.GarageYrBlt<1960) & (train.SalePrice>340000)].index)\n#train = train.drop(train[(train.Total_Porch_Area>600) & (train.SalePrice<50000)].index)\n#train = train.drop(train[(train.LotFrontage>150) & (train.SalePrice<100000)].index)\n#train = train.drop(train[(train.GarageFinish.isin([1,2])) & (train.SalePrice>470000)].index)\n#train = train.drop(train[(train.old_house==0) & (train.SalePrice<100000)].index)\n#train = train.drop(train[(train.old_house==1) & (train.SalePrice>400000)].index)\n#train = train.drop(train[(train.KitchenQual==2) & (train.SalePrice>600000)].index)\n#train = train.drop(train[(train.KitchenQual==3) & (train.SalePrice>360000)].index)\n#train = train.drop(train[(train.ExterQual==2) & (train.SalePrice>550000)].index)\n\n\ntrain = train[train.GarageArea * train.GarageCars < 3700]\ntrain = train[(train.FullBath + (train.HalfBath*0.5) + train.BsmtFullBath + (train.BsmtHalfBath*0.5))<5]","b3bff79d":"len(train)","ad40de5e":"plt.style.use('dark_background')\ncorr1_new_train=train.corr()\nplt.figure(figsize=(5,15))\nsb.heatmap(corr1_new_train[['SalePrice']].sort_values(by=['SalePrice'],ascending=False).head(25),annot_kws={\"size\": 16},vmin=-1, cmap='PiYG', annot=True)\nsb.set(font_scale=2)","d7e27d99":"train.isnull().sum()","ce67fc33":"test.isnull().sum()","033d88d9":"del test['SalePrice']","f7c4ba32":"train.head()","ea5dceea":"X=train.drop(['SalePrice','SalePrice_Log1p','Classes'],axis=1)\ny=train.SalePrice_Log1p","2b82ac2a":"def overfit_reducer(df):\n\n    overfit = []\n    for i in df.columns:\n        counts = df[i].value_counts()\n        zeros = counts.iloc[0]\n        if zeros \/ len(df) * 100 > 99.9:\n            overfit.append(i)\n    overfit = list(overfit)\n    return overfit\noverfitted_features = overfit_reducer(X)","359f25c9":"print(X.shape)\nprint(test.shape)","a7090db3":"X.drop(overfitted_features,axis=1,inplace=True)\ntest.drop(overfitted_features,axis=1,inplace=True)\nprint('X.shape',X.shape)\nprint('test.shape',test.shape)","10e855f8":"std_scaler=StandardScaler()\nrbst_scaler=RobustScaler()\npower_transformer=PowerTransformer()\nX_std=std_scaler.fit_transform(X)\nX_rbst=rbst_scaler.fit_transform(X)\nX_pwr=power_transformer.fit_transform(X)\n\ntest_std=std_scaler.transform(test)\ntest_rbst=rbst_scaler.transform(test)\ntest_pwr=power_transformer.transform(test)","55da610e":"X_train,X_test,y_train,y_test=train_test_split(X_std,y,test_size=0.002,random_state=52)\nprint('X_train Shape :',X_train.shape)\nprint('X_test Shape :',X_test.shape)\nprint('y_train Shape :',y_train.shape)\nprint('y_test Shape :',y_test.shape)","21d26ef3":"lgb_regressor=lgb.LGBMRegressor(objective='regression', num_leaves=5, learning_rate=0.035, n_estimators=2177, max_bin=50, bagging_fraction=0.65,bagging_freq=5, bagging_seed=7, \n                                feature_fraction=0.201, feature_fraction_seed=7,n_jobs=-1)\nlgb_regressor.fit(X_train, y_train)\ny_head=lgb_regressor.predict(X_test)\nprint('-'*10+'LGBM'+'-'*10)\nprint('R square Accuracy: ',r2_score(y_test,y_head))\nprint('Mean Absolute Error Accuracy: ',mean_absolute_error(y_test,y_head))\nprint('Mean Squared Error Accuracy: ',mean_squared_error(y_test,y_head))","db3fff5a":"gb_reg = GradientBoostingRegressor(n_estimators=1992, learning_rate=0.03005, max_depth=4, max_features='sqrt', min_samples_leaf=15, min_samples_split=14, loss='huber', random_state =42)\ngb_reg.fit(X_train, y_train)\ny_head=gb_reg.predict(X_test)\nprint('-'*10+'GBR'+'-'*10)\nprint('R square Accuracy: ',r2_score(y_test,y_head))\nprint('Mean Absolute Error Accuracy: ',mean_absolute_error(y_test,y_head))\nprint('Mean Squared Error Accuracy: ',mean_squared_error(y_test,y_head))","68258292":"kfolds = KFold(n_splits=10, shuffle=True, random_state=42)\n\nalphas=[1e-9,1e-8,1e-7,1e-6]\n\nridgecv_reg= make_pipeline(RidgeCV(alphas=alphas, cv=kfolds))\nridgecv_reg.fit(X_train, y_train)\ny_head=ridgecv_reg.predict(X_test)\nprint('-'*10+'RidgeCV'+'-'*10)\nprint('R square Accuracy: ',r2_score(y_test,y_head))\nprint('Mean Absolute Error Accuracy: ',mean_absolute_error(y_test,y_head))\nprint('Mean Squared Error Accuracy: ',mean_squared_error(y_test,y_head))","e5b8b769":"kfolds = KFold(n_splits=8, shuffle=True, random_state=42)\n\nlassocv_reg= make_pipeline(LassoCV(alphas=alphas, cv=kfolds))\nlassocv_reg.fit(X_train, y_train)\ny_head=lassocv_reg.predict(X_test)\nprint('-'*10+'LassoCV'+'-'*10)\nprint('R square Accuracy: ',r2_score(y_test,y_head))\nprint('Mean Absolute Error Accuracy: ',mean_absolute_error(y_test,y_head))\nprint('Mean Squared Error Accuracy: ',mean_squared_error(y_test,y_head))","275d1877":"kfolds = KFold(n_splits=8, shuffle=True, random_state=42)\n\nalphas=[0.0001, 0.0002, 0.0003, 0.0004, 0.0005, 0.0006]\nl1ratio=[0.87, 0.9,0.92, 0.95,0.97, 0.99, 1]\n\nelasticv_reg= make_pipeline(ElasticNetCV(alphas=alphas, cv=kfolds, l1_ratio=l1ratio))\nelasticv_reg.fit(X_train, y_train)\ny_head=elasticv_reg.predict(X_test)\nprint('-'*10+'ElasticNetCV'+'-'*10)\nprint('R square Accuracy: ',r2_score(y_test,y_head))\nprint('Mean Absolute Error Accuracy: ',mean_absolute_error(y_test,y_head))\nprint('Mean Squared Error Accuracy: ',mean_squared_error(y_test,y_head))","11afa7b3":"estimators = [('lgbm', lgb_regressor),\n              ('gbr', gb_reg),   \n              ('lasso', lassocv_reg),   \n              ('ridge', ridgecv_reg),   \n              ('elasticnet', elasticv_reg)]\n\nstack_reg=StackingRegressor(estimators=estimators,final_estimator=ExtraTreesRegressor(n_estimators=50),n_jobs=-1)\nstack_reg.fit(X_train, y_train)\ny_head=stack_reg.predict(X_test)\nprint('-'*10+'StackingRegressor'+'-'*10)\nprint('R square Accuracy: ',r2_score(y_test,y_head))\nprint('Mean Absolute Error Accuracy: ',mean_absolute_error(y_test,y_head))\nprint('Mean Squared Error Accuracy: ',mean_squared_error(y_test,y_head))","28f91ab3":"y_head=pd.DataFrame(y_head,columns=['Predict'])\ny_test.reset_index(drop=True,inplace=True)\ny_test_y_head=pd.concat([y_test,y_head],axis=1)\ny_test_y_head.head()","007f1d14":"print('Count columns of test: ',len(test.columns))\nprint('Count columns of X: ',len(X.columns))","54cc8046":"test_pred_lgb=lgb_regressor.predict(test_pwr)\ntest_pred_gb=gb_reg.predict(test_pwr)\ntest_pred_elastic=elasticv_reg.predict(test_pwr)\ntest_pred_ridge=ridgecv_reg.predict(test_pwr)\ntest_pred_lasso=lassocv_reg.predict(test_pwr)\ntest_pred_stack=stack_reg.predict(test_pwr)","9d3c1224":"test_pred_lgb=pd.DataFrame(test_pred_lgb,columns=['SalePrice'])\ntest_pred_gb=pd.DataFrame(test_pred_gb,columns=['SalePrice'])\ntest_pred_elastic=pd.DataFrame(test_pred_elastic,columns=['SalePrice'])\ntest_pred_ridge=pd.DataFrame(test_pred_ridge,columns=['SalePrice'])\ntest_pred_lasso=pd.DataFrame(test_pred_lasso,columns=['SalePrice'])\ntest_pred_stack=pd.DataFrame(test_pred_stack,columns=['SalePrice'])","7cbe2bb9":"test_pred_lgb.SalePrice =np.floor(np.expm1(test_pred_lgb.SalePrice))\ntest_pred_gb.SalePrice =np.floor(np.expm1(test_pred_gb.SalePrice))\ntest_pred_elastic.SalePrice =np.floor(np.expm1(test_pred_elastic.SalePrice))\ntest_pred_ridge.SalePrice =np.floor(np.expm1(test_pred_ridge.SalePrice))\ntest_pred_lasso.SalePrice =np.floor(np.expm1(test_pred_lasso.SalePrice))\ntest_pred_stack.SalePrice =np.floor(np.expm1(test_pred_stack.SalePrice))","6e87b19c":"test_pred_lgb.head()","8234db33":"test_pred_gb.head()","5af0baae":"test_pred_elastic.head()","d95f9795":"test_pred_ridge.head()","5f7cf321":"test_pred_lasso.head()","98e5baad":"test_pred_stack.head()","b878bdda":"final_pred=(test_pred_stack*0.1665)+(test_pred_lgb*0.678)+(test_pred_ridge*0.1665)\nfinal_pred.head()","a611b4f4":"sample_sub['SalePrice']=final_pred","a3529998":"sample_sub.head()","0aee6108":"sample_sub.to_csv('SampleSubmissionForHousePrice.csv',index=False)","1fe33976":"# **In the visualization above, we can see the variables that affect SalePrice.**","792f4cf1":"# These are the columns with the best correlation rate. Let's visualize them.","95278572":"# Columns with more than 40% positive or negative correlations with SalePrice","f6a2db6a":"# **We will predict SalePrice column**","28c623ad":"![national-house-price-growth-to-be-in-the-red-during-2019.jpg](attachment:national-house-price-growth-to-be-in-the-red-during-2019.jpg)","6c8d472f":"# > **Don't forget to upvote if you like my notebook. :)**","1f2d937d":"# **We must have knownledge about our data**","4bae896f":"# Fillna and Feature Engineering","61b2ed31":"# **Variables associated with SalePrice**","78b91e66":"# **Clean and Edit Dataframes**\n\n# We must combine train and test datasets. Because This processes are must be carried out together.","a6375140":"# It's time to leave","9bcc917d":"# Correlations increased after the outliers were removed.","a3f2f7ae":"# With the help of the above visualizations, we detected outliers. Let's get rid!","8e4fb36e":"# **Create Model**","ba129568":"# **First step; import our library later read dataframes**"}}