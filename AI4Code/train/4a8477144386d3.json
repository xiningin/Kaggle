{"cell_type":{"99cefde7":"code","6ccd5af8":"code","fed6b46a":"code","ee1264ad":"code","74d8d7af":"code","2f1313d8":"code","c050c5d1":"code","9c6e6aa7":"code","aa19e7bb":"code","2527303c":"code","f6ba2018":"markdown","b57eca97":"markdown","c6350d77":"markdown","65ff30ed":"markdown","fe8302e9":"markdown","0e4902b7":"markdown","10593589":"markdown","52acea11":"markdown","42d75bdf":"markdown"},"source":{"99cefde7":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","6ccd5af8":"df = pd.read_csv('..\/input\/nasa.csv')\ndf.head()","fed6b46a":"from xgboost import XGBClassifier\nfrom matplotlib import pyplot\nfrom xgboost import plot_importance\nfrom numpy import sort\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.feature_selection import SelectFromModel","ee1264ad":"df['avg_dia'] = df[['Est Dia in KM(min)', 'Est Dia in KM(max)']].mean(axis=1)","74d8d7af":"X = df[['Absolute Magnitude','avg_dia', 'Relative Velocity km per hr','Miss Dist.(kilometers)','Orbit Uncertainity',\n        'Minimum Orbit Intersection', 'Jupiter Tisserand Invariant','Epoch Osculation','Eccentricity','Semi Major Axis',\n        'Inclination','Asc Node Longitude','Orbital Period','Perihelion Distance','Perihelion Arg',\n        'Aphelion Dist','Perihelion Time','Mean Anomaly','Mean Motion']]\nX.head()","2f1313d8":"y = df['Hazardous'].astype(int)\ny.head()","c050c5d1":"model = XGBClassifier()\nmodel.fit(X, y)\n# plot feature importance\nplot_importance(model)\npyplot.show()","9c6e6aa7":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33, random_state=7)\n\nmodel = XGBClassifier()\nmodel.fit(X_train, y_train)\n\ny_pred = model.predict(X_test)\npredictions = [round(value) for value in y_pred]\naccuracy = accuracy_score(y_test, predictions)\nprint(\"Accuracy: %.2f%%\" % (accuracy * 100.0))\n\nthresholds = sort(model.feature_importances_)\nfor thresh in thresholds:\n\n\tselection = SelectFromModel(model, threshold=thresh, prefit=True)\n\tselect_X_train = selection.transform(X_train)\n\n\tselection_model = XGBClassifier()\n\tselection_model.fit(select_X_train, y_train)\n\n\tselect_X_test = selection.transform(X_test)\n\ty_pred = selection_model.predict(select_X_test)\n\tpredictions = [round(value) for value in y_pred]\n\taccuracy = accuracy_score(y_test, predictions)\n\tprint(\"Thresh=%.3f, n=%d, Accuracy: %.2f%%\" % (thresh, select_X_train.shape[1], accuracy*100.0))","aa19e7bb":"X = df[['Absolute Magnitude','Minimum Orbit Intersection']]\ny = df['Hazardous'].astype(int)\nX.head()\n","2527303c":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33, random_state=7)\nmodel = XGBClassifier()\nmodel.fit(X_train, y_train)\n\ny_pred = model.predict(X_test)\npredictions = [round(value) for value in y_pred]\naccuracy = accuracy_score(y_test, predictions)\nprint(\"Accuracy: %.2f%%\" % (accuracy * 100.0))","f6ba2018":"We get **99,61%** accuracy by using firstly chosen features. But from the output above we can see that all those features is not changing the result to much.\nSurprisingly, from the above method we can se that we can reach to the **99,68%** accuracy just using two features.\nWhich are:\n* **Absolute Magnitude and Minimum Orbit Intersection**","b57eca97":"I converted target column **(Hazardous)** to the 0 and 1 in order to be able to train data, with following line of code:","c6350d77":"We have min and max estimated diameter features for orbit as **'Est Dia in KM(min)'** and **'Est Dia in KM(max)'**. I found average of it and created new column as 'avg_dia' with following line of code.","65ff30ed":"So, after that I only chose those 2 columns as a feature:","fe8302e9":"These are the features I chose firstly in order to train data. Simply, nearly all numeric datas. ","0e4902b7":"After that I fitted data to the model and then by using **plot_importance(model)** I defined which features are more **important** to train data.","10593589":"For interest, we can test multiple thresholds for selecting features by feature importance. Specifically, the feature importance of each input variable, essentially allowing us to test each subset of features by importance, starting with all features and ending with a subset with the most important feature.\n\nThe complete code listing is provided below.","52acea11":"I used **XGBClassifier model** for this task. \nImporting relevant packages:[](http:\/\/)\n","42d75bdf":"Split data to the train split again and fit the **XGBClassifier** model. And then predict the test data and get score. We wil get **99.68%** accuracy!"}}