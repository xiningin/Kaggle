{"cell_type":{"5f3bcd93":"code","f8abec21":"code","3033b9de":"code","f91c689e":"code","70e601b8":"code","df39bebd":"code","2b1d42e1":"code","892e9812":"code","36bbdc26":"code","c75043cf":"code","8b1a2b4b":"code","faa65f41":"code","f8a94a32":"markdown","d1bec62c":"markdown","1f2ba9bb":"markdown"},"source":{"5f3bcd93":"import pandas as pd\nproj_list= pd.read_csv('..\/input\/pulp-data\/Scenario3_InputData.csv', index_col=['ID'])","f8abec21":"proj_list","3033b9de":"proj_list.dtypes","f91c689e":"## these are the maximum yearwise constraints for the 3 years\ncapexconstraints=[20,25,15] ","70e601b8":"import pulp\n\n# Create A Model\n\nphasing = pulp.LpProblem(\"Maximise\", pulp.LpMaximize)\n\nSelection = pulp.LpVariable.dicts(\"Selection\", proj_list.index, cat='Binary')","df39bebd":"Selection","2b1d42e1":"# Set The Objective Function                                                                                                         \nphasing += pulp.lpSum(Selection[idx]*proj_list.loc[idx][\"NPV\"] for idx in proj_list.index)\n","892e9812":"# Set The Constraints \n\nphasing += sum([Selection[idx] * proj_list.loc[idx][\"CAPEX Yr1\"] for idx in proj_list.index]) <= capexconstraints[0]\nphasing += sum([Selection[idx] * proj_list.loc[idx][\"CAPEX Yr2\"] for idx in proj_list.index]) <= capexconstraints[1]\nphasing += sum([Selection[idx] * proj_list.loc[idx][\"CAPEX Yr3\"] for idx in proj_list.index]) <= capexconstraints[2]\n\nphasing += Selection[5] + Selection[11] == 1 #Either Project 5 or 10 must be chosen\nphasing += Selection[4] == Selection[8] # Both Projects 4 and 8 must go together\nphasing += Selection[9] + Selection[10] == 1 # Either Project 9 or 10 must be chosen\nphasing += Selection[7] <= Selection[2] # Project 7 is optional choice as long as Project 2 is selected\n","36bbdc26":"pulp.LpStatus[phasing.status]\n","c75043cf":"# Run The Solver(s)\n\n%time \n\nphasing.solve() \n\n#equivalent to phasing.solve(pulp.PULP_CBC_CMD()) as CBC is PulP's default solver\n\npulp.LpStatus[phasing.status]\n\n# Print our objective function value and Output Solution\nprint (pulp.value(phasing.objective))\n","8b1a2b4b":"#Convert output into user friendly output for viewing or downloading \npulpsolution=pd.DataFrame(columns = [\"Selection Y\/N\",\"CAPEX Yr1 Selected\",\"CAPEX Yr2 Selected\", \"CAPEX Yr3 Selected\", \"NPV Selected\"])\nfor idx in proj_list.index:\n    to_append = [Selection[idx].value(), Selection[idx].value()*proj_list.loc[idx][\"CAPEX Yr1\"],Selection[idx].value()*proj_list.loc[idx][\"CAPEX Yr2\"],Selection[idx].value()*proj_list.loc[idx][\"CAPEX Yr3\"],Selection[idx].value()*proj_list.loc[idx][\"NPV\"]]\n    perprojectyear = pd.Series(to_append, index = pulpsolution.columns)\n    pulpsolution = pulpsolution.append(perprojectyear, ignore_index=True)\n\npulpsolution.index += 1 \npulpsolution\n\npulpoutput = pd.concat([proj_list, pulpsolution], axis=1)\npulpoutput","faa65f41":"CAPEX_Totals=[pulpsolution['CAPEX Yr1 Selected'].sum(),pulpsolution['CAPEX Yr2 Selected'].sum(),pulpsolution['CAPEX Yr3 Selected'].sum()]\n\nCAPEX_CheckSum= pd.DataFrame()\nCAPEX_CheckSum['Year'] = [1,2,3]\nCAPEX_CheckSum['CAPEX Phasing'] = CAPEX_Totals\nCAPEX_CheckSum['Constraints'] = capexconstraints\nprint('Total NPV=', round(pulpsolution['NPV Selected'].sum(),2))\nprint()\nprint(CAPEX_CheckSum.to_string(index = False))","f8a94a32":"About the data  .. there are 11 programes and there are some constraints in programs appearing together\n1. Either Project 5 or 10 must be chosen\n2. Both Projects 4 and 8 must go together\n3. Either Project 9 or 10 must be chosen\n4. Project 7 is optional choice as long as Project 2 is selected","d1bec62c":"The three most common approaches to project selection are payback period (PB), internal rate of return (IRR), and net present value (NPV).","1f2ba9bb":"### Capital Budgeting \nCapital budgeting involves choosing projects that add value to a company. The capital budgeting process can involve almost anything including acquiring land or purchasing fixed assets like a new truck or machinery.<br>\n<br>\nThe \u201c\u2018Capital Budgeting\u201d problem is a situation many organisations face where there is a long list of projects to be done but a limited budget (or other resources such as manpower) that constraints which projects can be executed.<br>\nMore about capital bugeting can be read here\n\nhttps:\/\/www.investopedia.com\/articles\/financial-theory\/11\/corporate-project-valuation-methods.asp"}}