{"cell_type":{"6f4d6ded":"code","78b8a70c":"code","4cd28eae":"code","a3cc5ac2":"code","b5a503f9":"code","dea643a1":"code","4dc71d91":"code","8d8d4d2b":"code","89e71f76":"code","77a29423":"code","21d6fe73":"code","f1e9c366":"code","3ce1624e":"code","7a4dfd78":"code","b6b46c52":"code","400987c1":"code","b287980c":"code","4bb68fe6":"code","8d94a118":"code","358e4af2":"code","ef887659":"code","97ef689f":"code","d94340e5":"code","59f417bd":"code","811eca75":"code","b6d88cd2":"code","dc3c8f05":"code","653bd70e":"code","0cd1c6a4":"code","5f1d0136":"code","d8b683cc":"code","e306cefe":"code","759dd2f3":"code","fb8afca7":"code","23c18390":"code","081339b5":"code","349d2fe3":"code","4be7defc":"markdown","ab344de6":"markdown","000d3f60":"markdown","e53f9a19":"markdown","68e88f3b":"markdown","2e6bfdc9":"markdown","56697a61":"markdown","2e46d213":"markdown","83950a95":"markdown","8d815010":"markdown","e44cd9be":"markdown","02f12664":"markdown","cc1c2cfe":"markdown","f18b8c1a":"markdown","29552bab":"markdown","66a8c877":"markdown","516a95d1":"markdown","12e56a6a":"markdown","75d89069":"markdown","83da33f8":"markdown","f420ae12":"markdown","e1bfa439":"markdown","7d35fda8":"markdown","e2628a0e":"markdown","04183b5c":"markdown","cb33187b":"markdown","d0c94090":"markdown","43bc7376":"markdown","6d5356da":"markdown","632253a8":"markdown","91a4256b":"markdown","a80fe538":"markdown","1379696c":"markdown","3d0c7f61":"markdown","6eb45aa0":"markdown","f87cb52d":"markdown","861e282a":"markdown","df7ec658":"markdown","3fee2777":"markdown","913c349b":"markdown","5ba34bec":"markdown","1cd3bcb9":"markdown","364bc48f":"markdown","8b43a21d":"markdown","bc3654aa":"markdown","0391c102":"markdown","36193e13":"markdown","9792cd0c":"markdown"},"source":{"6f4d6ded":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom sklearn import metrics\nfrom sklearn.metrics import roc_auc_score\nimport time\nimport itertools\nimport h2o\nfrom h2o.estimators.gbm import H2OGradientBoostingEstimator\nfrom h2o.grid.grid_search import H2OGridSearch\n%matplotlib inline","78b8a70c":"#DATA SPLIT IN TRAIN\/VALIDATION\/TEST\nTRAIN_SIZE = 0.60  \nVALID_SIZE = 0.20 \nRANDOM_STATE = 2018\nIS_LOCAL = False\nimport os\nif(IS_LOCAL):\n    PATH=\"..\/input\/default-of-credit-card-clients-dataset\"\nelse:\n    PATH=\"..\/input\"\nprint(os.listdir(PATH))","4cd28eae":"h2o.init()","a3cc5ac2":"data_df = h2o.import_file(PATH+\"\/UCI_Credit_Card.csv\", destination_frame=\"data_df\")","b5a503f9":"data_df.describe()","dea643a1":"df_group=data_df.group_by(\"default.payment.next.month\").count()\ndf_group.get_frame()","4dc71d91":"features = [f for f in data_df.columns if f not in ['default.payment.next.month']]\n\ni = 0\nt0 = data_df[data_df['default.payment.next.month'] == 0].as_data_frame()\nt1 = data_df[data_df['default.payment.next.month'] == 1].as_data_frame()\n\nsns.set_style('whitegrid')\nplt.figure()\nfig, ax = plt.subplots(6,4,figsize=(16,24))\n\nfor feature in features:\n    i += 1\n    plt.subplot(6,4,i)\n    sns.kdeplot(t0[feature], bw=0.5,label=\"Not default\")\n    sns.kdeplot(t1[feature], bw=0.5,label=\"Default\")\n    plt.xlabel(feature, fontsize=12)\n    locs, labels = plt.xticks()\n    plt.tick_params(axis='both', which='major', labelsize=12)\nplt.show();","8d8d4d2b":"d_df = data_df.as_data_frame()\nplt.figure(figsize = (14,6))\nplt.title('Amount of credit limit - Density Plot')\nsns.set_color_codes(\"pastel\")\nsns.distplot(d_df['LIMIT_BAL'],kde=True,bins=200, color=\"blue\")\nplt.show()","89e71f76":"d_df['LIMIT_BAL'].value_counts().shape","77a29423":"d_df['LIMIT_BAL'].value_counts().head(5)","21d6fe73":"class_0 = d_df.loc[d_df['default.payment.next.month'] == 0][\"LIMIT_BAL\"]\nclass_1 = d_df.loc[d_df['default.payment.next.month'] == 1][\"LIMIT_BAL\"]\nplt.figure(figsize = (14,6))\nplt.title('Default amount of credit limit  - grouped by Payment Next Month (Density Plot)')\nsns.set_color_codes(\"pastel\")\nsns.distplot(class_1,kde=True,bins=200, color=\"red\")\nsns.distplot(class_0,kde=True,bins=200, color=\"green\")\nplt.show()","f1e9c366":"var = ['PAY_0',\n       'PAY_2', \n       'PAY_3', \n       'PAY_4', \n       'PAY_5',\n       'PAY_6']\n\nfor v in var:\n    fig, ax = plt.subplots(ncols=1, figsize=(14,6))\n    s = sns.boxplot(ax = ax, x=v, y=\"LIMIT_BAL\", hue=\"default.payment.next.month\",data=d_df, palette=\"PRGn\",showfliers=False)\n    plt.show();","3ce1624e":"fig, (ax1, ax2) = plt.subplots(ncols=2, figsize=(12,6))\ns = sns.boxplot(ax = ax1, \n                x=\"SEX\", \n                y=\"LIMIT_BAL\", \n                hue=\"SEX\",data=d_df, \n                palette=\"PRGn\",\n                showfliers=True)\ns = sns.boxplot(ax = ax2, \n                x=\"SEX\", \n                y=\"LIMIT_BAL\", \n                hue=\"SEX\",data=d_df, \n                palette=\"PRGn\",\n                showfliers=False)\nplt.show();","7a4dfd78":"var = ['BILL_AMT1',\n       'BILL_AMT2',\n       'BILL_AMT3',\n       'BILL_AMT4',\n       'BILL_AMT5',\n       'BILL_AMT6']\n\nplt.figure(figsize = (8,8))\nplt.title('Amount of bill statement (Apr-Sept) \\ncorrelation plot (Pearson)')\ncorr = data_df[var].cor().as_data_frame()\ncorr.index = var\nsns.heatmap(corr,xticklabels=corr.columns,yticklabels=corr.columns,linewidths=.1,vmin=-1, vmax=1)\nplt.show()","b6b46c52":"var = ['PAY_AMT1', \n       'PAY_AMT2', \n       'PAY_AMT3', \n       'PAY_AMT4', \n       'PAY_AMT5']\n\nplt.figure(figsize = (8,8))\nplt.title('Amount of previous payment (Apr-Sept) \\ncorrelation plot (Pearson)')\ncorr = data_df[var].cor().as_data_frame()\ncorr.index = var\nsns.heatmap(corr,xticklabels=corr.columns,yticklabels=corr.columns,linewidths=.1,vmin=-1, vmax=1)\nplt.show()","400987c1":"var = ['PAY_0','PAY_2', 'PAY_3', 'PAY_4', 'PAY_5', 'PAY_6']\n\nplt.figure(figsize = (8,8))\nplt.title('Repayment status (Apr-Sept) \\ncorrelation plot (Pearson)')\ncorr = data_df[var].cor().as_data_frame()\ncorr.index = var\nsns.heatmap(corr,xticklabels=corr.columns,yticklabels=corr.columns,linewidths=.1,vmin=-1, vmax=1)\nplt.show()","b287980c":"def boxplot_variation(feature1, feature2, feature3, width=16):\n    fig, ax1 = plt.subplots(ncols=1, figsize=(width,6))\n    s = sns.boxplot(ax = ax1, x=feature1, y=feature2, hue=feature3,\n                data=d_df, palette=\"PRGn\",showfliers=False)\n    s.set_xticklabels(s.get_xticklabels(),rotation=90)\n    plt.show();","4bb68fe6":"boxplot_variation('MARRIAGE','AGE', 'SEX',8)","8d94a118":"boxplot_variation('EDUCATION','AGE', 'MARRIAGE',12)","358e4af2":"boxplot_variation('AGE','LIMIT_BAL', 'SEX',16)","ef887659":"boxplot_variation('MARRIAGE','LIMIT_BAL', 'EDUCATION',12)","97ef689f":"data_df['EDUCATION_SEX'] = data_df['EDUCATION'] + \"_\" + data_df['SEX']\ndata_df['SEX_MARRIAGE'] = data_df['SEX'] + \"_\" + data_df['MARRIAGE']\ndata_df['EDUCATION_MARRIAGE'] = data_df['EDUCATION'] + \"_\" + data_df['MARRIAGE']\ndata_df['EDUCATION_MARRIAGE_SEX'] = data_df['EDUCATION'] + \"_\" + data_df['MARRIAGE'] + \"_\" + data_df['SEX']","d94340e5":"data_df.shape","59f417bd":"train_df, valid_df, test_df = data_df.split_frame(ratios=[TRAIN_SIZE, VALID_SIZE], seed=2018)\ntarget = \"default.payment.next.month\"\ntrain_df[target] = train_df[target].asfactor()\nvalid_df[target] = valid_df[target].asfactor()\ntest_df[target] = test_df[target].asfactor()\nprint(\"Number of rows in train, valid and test set : \", train_df.shape[0], valid_df.shape[0], test_df.shape[0])","811eca75":"# define the predictor list - all the features analyzed before (all columns but 'default.payment.next.month')\npredictors = features\n# initialize the H2O GBM \ngbm = H2OGradientBoostingEstimator()\n# train with the initialized model\ngbm.train(x=predictors, y=target, training_frame=train_df)","b6d88cd2":"gbm.summary()","dc3c8f05":"print(gbm.model_performance(train_df))","653bd70e":"print(gbm.model_performance(valid_df))","0cd1c6a4":"tuned_gbm  = H2OGradientBoostingEstimator(\n    ntrees = 2000,\n    learn_rate = 0.02,\n    stopping_rounds = 25,\n    stopping_metric = \"AUC\",\n    col_sample_rate = 0.65,\n    sample_rate = 0.65,\n    seed = RANDOM_STATE\n)      \ntuned_gbm.train(x=predictors, y=target, training_frame=train_df, validation_frame=valid_df)","5f1d0136":"tuned_gbm.model_performance(valid_df).auc()","d8b683cc":"grid_search_gbm = H2OGradientBoostingEstimator(\n    stopping_rounds = 25,\n    stopping_metric = \"AUC\",\n    col_sample_rate = 0.65,\n    sample_rate = 0.65,\n    seed = RANDOM_STATE\n) \n\nhyper_params = {\n    'learn_rate':[0.01, 0.02, 0.03],\n    'max_depth':[4,8,16,24],\n    'ntrees':[50, 250, 1000]}\n\ngrid = H2OGridSearch(grid_search_gbm, hyper_params,\n                         grid_id='depth_grid',\n                         search_criteria={'strategy': \"Cartesian\"})\n#Train grid search\ngrid.train(x=predictors, \n           y=target,\n           training_frame=train_df,\n           validation_frame=valid_df)","e306cefe":"grid_sorted = grid.get_grid(sort_by='auc',decreasing=True)","759dd2f3":"print(grid_sorted)","fb8afca7":"best_gbm = grid_sorted.models[0]","23c18390":"print(best_gbm)","081339b5":"best_gbm.varimp_plot()","349d2fe3":"pred_val = (best_gbm.predict(test_df[predictors])[0]).as_data_frame()\ntrue_val = (test_df[target]).as_data_frame()\nprediction_auc = roc_auc_score(pred_val, true_val)\nprediction_auc","4be7defc":"<a href=\"#0\"><font size=\"1\">Go to top<\/font><\/a>\n\n## Credit limit vs Repayment status in Sept. 2005- April 2005, grouped by Default payment next month\n\nMeaning of values for **PAY_0** (repayment status in Sept. 2005) is:    \n* -1=pay duly,   \n* 1=payment delay for one month,  \n* 2=payment delay for two months,  \n...   \n\n*  8=payment delay for eight months,   \n* 9=payment delay for nine months and above.  \n\nFor the other values **PAY_2**, **PAY_3** ... **PAY_6** the meaning is similar, referring to the respective months.   \n","ab344de6":"## Set parameters\n\nHere we set few parameters for the analysis and models.","000d3f60":"The performance was not improved (AUC actually decreased).\n\n<a href=\"#0\"><font size=\"1\">Go to top<\/font><\/a>\n\n\n\n## <a id=\"74\">Grid Search<\/a>\n\nLet's try Hyperparamater tuning using Grid Search. \n\nThe hyperparameters grid is specified in the **hyper_params**, for each parameters beign given the set of values we want to explore.","e53f9a19":"# <a id=\"2\">Load packages<\/a>\n\n## Load packages","68e88f3b":"Let's check the shape again.","2e6bfdc9":"This shows that we used 50 trees, 50 internal trees. It is also showing the min and max tree depth (5,5), the min and max number of leaves (16,32) and the mean values for tree depth and number of leaves.\n\nWe can also inspect the model further, looking to other informations.\n\nLet's see the model performance for the train set.","56697a61":"The limit credit amount is quite balanced between sexes. The males have a slightly smaller Q2 and larger Q3 and Q4 and a lower mean. The female have a larger outlier max value (1M NT dollars).","2e46d213":"More information are presented: the H2O cluster uptime, timezone, version, version age, cluster name, hardware resources allocated ( number of nodes, memory, cores), the connection url, H2O API extensions exposed and the Python version used.\n\n## Import the data\n\nWe already initialized the H2O engine, now we will use H2O to import the data.","83950a95":"The best model has an AUC score of 0.82 for the train set and of 0.78 for validation set.\n\nLet's show the variable importance.","8d815010":"<a href=\"#0\"><font size=\"1\">Go to top<\/font><\/a>\n\n## Credit limit vs. sex\n\nLet's check the credit limit distribution vs. sex. For the sex, 1 stands for male and 2 for female.","e44cd9be":"### Model evaluation\n\nLet's inspect the model already trained. We can print the summary:","02f12664":"# <a id=\"8\">Conclusions<\/a>\n\nWe initialized the H2O engine, using some H2O features for importing and inspecting the data.  \n\nWe then continued visualizing the features and understanding the relationship between different features.   \n\nA small feature engineering step was added.\n\nWe then splited the data in train, validation and test set. We  trained a  predictive model using GBM model from H2O, starting with a simple model, following with simple parameter tuning and then we used GridSearch to find the best parameters for the model, looking to maximize the AUC score for the validation set.   \n\nFinaly, with the best model, we atempted to predict the target value for the test data.   \n\nThe AUC score for the test data was <font color=\"red\">**0.698**<\/font>.\n\n<a href=\"#0\"><font size=\"1\">Go to top<\/font><\/a>","cc1c2cfe":"<a href=\"#0\"><font size=\"1\">Go to top<\/font><\/a>\n\n# <a id=\"4\">Check the data<\/a>\n\nWe use also H2O function describe to check the data.","f18b8c1a":"<a href=\"#0\"><font size=\"1\">Go to top<\/font><\/a>\n\n# <a id=\"7\">Predictive Model<\/a>  \n\n\n\n","29552bab":"Indeed, the largest number of credit cards are with limit of:  \n* **50,000** (**3365**), followed by:  \n* **20,000** (**1976**) and    \n* **30,000** (**1610**).  \n","66a8c877":"<h1><center><font size=\"6\">Hyperparameter tuning using GridSearch with H2O<\/font><\/center><\/h1>\n\n\n<img src=\"https:\/\/www.h2o.ai\/wp-content\/themes\/h2o2018\/templates\/dist\/images\/h2o_logo.svg\" width=\"400\"><\/img>\n\n\n# <a id='0'>Content<\/a>\n\n- <a href='#1'>Introduction<\/a>  \n- <a href='#2'>Load packages<\/a>  \n- <a href='#3'>Read the data<\/a>  \n- <a href='#4'>Check the data<\/a>  \n- <a href='#5'>Data exploration<\/a>  \n- <a href='#6'>Feature engineering<\/a>  \n- <a href='#7'>Predictive Model<\/a>  \n    - <a href='#71'>Split the data<\/a> \n    - <a href='#72'>Train GBM<\/a> \n    - <a href='#73'>Parameter tuning<\/a>\n    - <a href='#74'>Grid Search<\/a>  \n    - <a href='#75'>Predict test data<\/a>   \n- <a href='#8'>Conclusions<\/a>\n- <a href='#9'>References<\/a>","516a95d1":"Correlation is decreasing with distance between months. Lowest correlations are between Sept-April.\n\n\nLet's check the correlation of Amount of previous payment in April - September 2005.","12e56a6a":"The AUC score for test data is 0.698.\n\n\n<a href=\"#0\"><font size=\"1\">Go to top<\/font><\/a>","75d89069":"<a href=\"#0\"><font size=\"1\">Go to top<\/font><\/a>\n\n## Age, sex and credit amount limit\n\n\nLet's show the  boxplots with credit amount limit distribution grouped by age and sex.","83da33f8":"One can observe that there are several features that show a different distribution for values of target variable of `Default` or `Not default`.  The following features are most representative:  \n\n* PAY_0;  \n* PAY_2;  \n* PAY_3;\n* PAY_4;  \n* PAY_5;\n* PAY_6;  \n","f420ae12":"Most of defaults are for credit limits **0-100,000** (and density for this interval is larger for defaults than for non-defaults).   \n\nLarger defaults number are for the amounts of **50,000**, **20,000** and **30,000**.","e1bfa439":"<a href=\"#0\"><font size=\"1\">Go to top<\/font><\/a>\n\n## Amount of credit limit ","7d35fda8":"<a href=\"#0\"><font size=\"1\">Go to top<\/font><\/a>\n\n# <a id=\"6\">Feature engineering<\/a>  \n\n\nLet's add few new features.","e2628a0e":"<a href=\"#0\"><font size=\"1\">Go to top<\/font><\/a>\n\n# <a id=\"3\">Read the data<\/a>\n\nFor reading the data, we will use also H2O. First, we will initialize H2O.\n\n* ## Initialize H2O\nH2O will first try to connect to an existing instance. If none available, will start one. Then informations about this engine are printed. At the end connection to the H2O server is attempted and reported.","04183b5c":"Let's pick the best model, selected by AUC:","cb33187b":"We can confirm that in only 22% of the cases the clients are defaulting.   \n\nLet's explore all the features, grouped by **default.payment.next.month**.\n\n## Density plots for all features\n\nWe group first the data by **default.payment.next.month**. We use **kdeplot** to visualize the data distribution.\n","d0c94090":"Mean, Q3 and Q4 values are increasing for both male and female with age until aroung 35 years and then they are oscilating and get to a maximum of Q4 for males at age 64.\n\nMean values are generally smaller for males than for females, with few exceptions, for example at age 39, 48, until approximately 60, where mean values for males are generally larger than for females.","43bc7376":"## <a id=\"71\">Split the data<\/a>\n\nLet's start by spliting the data in train, validation and test sets. We will use 60%, 20% and 20% splits.   \n\nPlease not here that we can directly split in train, validation and test set, we do not need to do it in two steps.","6d5356da":"Largest group of amount of credit limit is apparently for amount of 50K. Let's verify this.","632253a8":"## <a id=\"72\">Train GBM<\/a>\n\n\nWe will use a GBM model provided by H2O framework (H2OGradientBoostingEstimator) for prediction of the **target** (**default.payment.next.month**).  \n\nThe training predictors columns, the target values and the dataframe are specified as parameters of the **train** function.\n","91a4256b":"There are no correlations between amounts of previous payments for April-Sept 2005.\n\nLet's check the correlation between Repayment status in April - September 2005.","a80fe538":"<a href=\"#0\"><font size=\"1\">Go to top<\/font><\/a>\n\n## Sex, Education, Age and Marriage\n\n\nLet's show sex, education, age and marriage distributions.\n\nWe start by showing the boxplots with age distribution grouped by marriage status and sex.\n\nMarriage status meaning is:\n\n* 0 : unknown (let's consider as others as well)\n* 1 : married\n* 2 : single\n* 3 : others\n\nSex meaning is:\n\n* 1 : male\n* 2 : female\n","1379696c":"\n# <a id=\"1\">Introduction<\/a>  \n\n\n## Dataset\n\nThis dataset contains information on default payments, demographic factors, credit data, history of payment, and bill statements of credit card clients in Taiwan from **April 2005** to **September 2005**. \n\n## Content\n\nThere are 25 variables:\n\n* **ID**: ID of each client\n* **LIMIT_BAL**: Amount of given credit in NT dollars (includes individual and family\/supplementary credit\n* **SEX**: Gender (1=male, 2=female)\n* **EDUCATION**: (1=graduate school, 2=university, 3=high school, 4=others, 5=unknown, 6=unknown)\n* **MARRIAGE**: Marital status (1=married, 2=single, 3=others)\n* **AGE**: Age in years\n* **PAY_0**: Repayment status in September, 2005 (-1=pay duly, 1=payment delay for one month, 2=payment delay for two months, ... 8=payment delay for eight months, 9=payment delay for nine months and above)\n* **PAY_2**: Repayment status in August, 2005 (scale same as above)\n* **PAY_3**: Repayment status in July, 2005 (scale same as above)\n* **PAY_4**: Repayment status in June, 2005 (scale same as above)\n* **PAY_5**: Repayment status in May, 2005 (scale same as above)\n* **PAY_6**: Repayment status in April, 2005 (scale same as above)\n* **BILL_AMT1**: Amount of bill statement in September, 2005 (NT dollar)\n* **BILL_AMT2**: Amount of bill statement in August, 2005 (NT dollar)\n* **BILL_AMT3**: Amount of bill statement in July, 2005 (NT dollar)\n* **BILL_AMT4**: Amount of bill statement in June, 2005 (NT dollar)\n* **BILL_AMT5**: Amount of bill statement in May, 2005 (NT dollar)\n* **BILL_AMT6**: Amount of bill statement in April, 2005 (NT dollar)\n* **PAY_AMT1**: Amount of previous payment in September, 2005 (NT dollar)\n* **PAY_AMT2**: Amount of previous payment in August, 2005 (NT dollar)\n* **PAY_AMT3**: Amount of previous payment in July, 2005 (NT dollar)\n* **PAY_AMT4**: Amount of previous payment in June, 2005 (NT dollar)\n* **PAY_AMT5**: Amount of previous payment in May, 2005 (NT dollar)\n* **PAY_AMT6**: Amount of previous payment in April, 2005 (NT dollar)\n* **default.payment.next.month**: Default payment (1=yes, 0=no)\n\n\n## H2O\n\nH2O is an AI company with the vision to democratize the use of machine learning. They provide an flexible, scallable, robust platform that allows data loading, processing, visualization, feature engineering, model building and tuning. \n\nFew revolutionary products of H2O are:   \n* **H2O** - fully open source, distributed in-memory machine learning platform with linear scalability;  \n* **H2O AutoML** - used for automating the machine learning workflow, which includes automatic training and tuning of many models within a user-specified time-limit;  \n* **Sparkling Water** - allows users to combine the fast, scalable machine learning algorithms of H2O with the capabilities of Spark;\n* **H2O4GPU** - open source, GPU-accelerated machine learning package with APIs in Python and R that allows anyone to take advantage of GPUs to build advanced machine learning models;\n* **DriverlessAI** - employs the techniques of expert data scientists in an easy to use application that helps scale your data science efforts.  \n\n\n<a href=\"#0\"><font size=\"1\">Go to top<\/font><\/a>\n","3d0c7f61":"<a href=\"#0\"><font size=\"1\">Go to top<\/font><\/a>\n\n## Amount of credit limit grouped by default payment next month\n\nLet's visualize the density plot for amount of credit limit (**LIMIT_BAL**), grouped by **default payment next month**.","6eb45aa0":"We will explore the model, printing the parameters which give the best AUC.","f87cb52d":"# <a id=\"9\">References<\/a>\n\n[1] Default Credit Card Clients Dataset,  https:\/\/www.kaggle.com\/uciml\/default-of-credit-card-clients-dataset\/    \n[2] SRK, Getting started with H2O, https:\/\/www.kaggle.com\/sudalairajkumar\/getting-started-with-h2o    \n[3] H2O, the company, https:\/\/www.h2o.ai\/company\/  \n[4] H2O, the company (Wikipedia), https:\/\/en.wikipedia.org\/wiki\/H2O_(software)\n\n\n<a href=\"#0\"><font size=\"1\">Go to top<\/font><\/a>","861e282a":"Correlation is decreasing with distance between months. Lowest correlations are between Sept-April.","df7ec658":"For the train set, the Gini coefficient obtained is 0.64, the AUC score is 0.82. LogLoss is 0.39.\n\nLet's check now the performance of the model with the validation set.","3fee2777":"<a href=\"#0\"><font size=\"1\">Go to top<\/font><\/a>\n\n# <a id=\"5\">Explore the data<\/a>\n\nWe will use another functions from H2O to explore the data.\n\nLet's start by showing the distribution of features, grouped by  **default.payment.next.month**, which is the **target** value.\n\nWe start by looking how many default vs. not default cases are.\n","913c349b":"There are **30,000** distinct credit card clients and there are **25** different features.\n\nThere are no missing data in the whole dataset.\n\nThe mean value for the amount of credit card limit is **167,484**. The standard deviation is unusually large, max value being **1M**.\n\nEducation level is mostly graduate school and university.\n\nMost of the clients are either married or single (less frequent the other status).\n\nAverage age is 35.5 years, with a standard deviation of 9.2, min being 21 (must be a legal age) and max being 79.\n\nThe target value is **default.payment.next.month**. This indicates if a client will default payment next month.  As the value **0** for **default payment** means **not default** and value **1** means **default**, the mean of **0.221** means that there are **22.1%** of credit card contracts that will default next month (will verify this in the next sections of this analysis).\n\nWe will explore in more detail the data in the following section.","5ba34bec":"For the validation set, the Gini score obtained is 0.55, the AUC score is 0.77 and LogLoss is 0.43.\n\n\nTo summarize, we obtained AUC score 0.82 for train set and 0.77 for test set.\n\nLet's use the validation set to tune the parameters.\n\n<a href=\"#0\"><font size=\"1\">Go to top<\/font><\/a>\n\n## <a id=\"73\">Parameters tuning<\/a>\n\n","1cd3bcb9":"<a href=\"#0\"><font size=\"1\">Go to top<\/font><\/a>\n\n## Features correlation\n\n\nFor the numeric values, let's represent the features correlation.\n\n\nLet's check the correlation of Amount of bill statement in April - September 2005.\n\nWe will use **H2O** correlation function **cor()**.\n","364bc48f":"It looks like Married status 3 (others), with mean values over 40 and Q4 values over 60 means mostly vidowed or divorced whilst Married status 0 could be not specified or divorced, as Q1 values are above values for married of both sexes.\n\nMarried males have mean age above married women. Unmarried males have mean value for age above unmarried women as well but closer. Q3 abd Q4 values for married man are above corresponding values for married women.\n\n\nLet's show the boxplots with age distribution grouped by education and marriage.\n\nEducation status meaning is:\n\n* 1 : graduate school\n* 2 : university\n* 3 : high school\n* 4 : others\n* 5 : unknown\n* 6 : unknow","8b43a21d":"There are 81 distinct values for amount of credit limit.","bc3654aa":"## Marriage status, education level and credit amount limit\n\n\nLet's show the  boxplots with credit amount limit distribution grouped by marriage status and education level.","0391c102":"Let's check the validation AUC score.","36193e13":"Let's inspect the best model obtained with Hyperparameters tuning using GridSearch.","9792cd0c":"<a href=\"#0\"><font size=\"1\">Go to top<\/font><\/a>\n\n## <a id=\"75\">Predict test data<\/a>\n\nLet's use the best model to predict the target value for the test data."}}