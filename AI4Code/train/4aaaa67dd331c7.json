{"cell_type":{"fe227271":"code","f4cd4fb6":"code","64e8ecd3":"code","08e81818":"code","7878fe56":"code","f5b45dee":"code","73ec101e":"code","d257a92c":"code","067e883a":"code","98c83863":"code","ee388f31":"code","37eeef33":"code","408ff8b0":"code","0b5b409a":"code","2acdeac8":"code","62f340cc":"code","639626de":"code","9ff6fe28":"code","c2badcfc":"code","7d7887ec":"code","a7dce984":"code","3253b7d2":"code","5236190c":"code","0977d543":"code","3381c3ec":"code","ce407b0b":"code","386535c7":"code","8c2ea319":"code","a8b5d1fb":"code","eaa130a1":"code","cd1b61a1":"code","29fbfca0":"code","0e00fd8e":"code","a95429a1":"code","f31a7d1d":"code","f2e129ed":"code","b9370a47":"code","dc53f30a":"code","07141771":"code","c7790900":"code","df741a7a":"code","20c00268":"code","99dfca41":"code","89ee612c":"code","37f19ce5":"code","9f2e9b63":"code","3f768547":"code","654365a4":"code","c0c6843e":"code","3588c0fc":"code","47e2204d":"code","893d2103":"code","5a0f162c":"code","34cd867a":"code","253e3e31":"code","3346f485":"code","4dad8c59":"code","eed77ba8":"code","f7378ea7":"code","848bd075":"code","ef5dee30":"code","625ec151":"code","e3abcfde":"code","e7e8ac79":"code","0530e54a":"code","aa4a2461":"code","48942576":"code","9fda1dfe":"code","c99062b8":"code","2f23832b":"code","9f5c7c0f":"code","b8dce885":"code","515e0d7b":"code","a7d24056":"code","208ba1f9":"markdown","f9c46e1a":"markdown","a28f5f52":"markdown","a9ef3a44":"markdown","d19677c2":"markdown","50464b9a":"markdown","394a1c3b":"markdown","594f6518":"markdown","2a42b5f6":"markdown","2e19131e":"markdown"},"source":{"fe227271":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns","f4cd4fb6":"df = pd.read_csv(\"..\/input\/heart-attack-prediction\/data.csv\",na_values=['?'], low_memory = False)\ndf","64e8ecd3":"df.shape","08e81818":"df.columns","7878fe56":"df['age'].unique()","f5b45dee":"df['sex'].unique()","73ec101e":"df['fbs'].unique()","d257a92c":"df['chol'].unique()","067e883a":"df['fbs'].unique()","98c83863":"df['thalach'].unique()","ee388f31":"df['cp'].unique()","37eeef33":"df['restecg'].unique()","408ff8b0":"df['slope'].unique()","0b5b409a":"df['ca'].unique()","2acdeac8":"df['thal'].unique()","62f340cc":"df['exang'].unique()","639626de":"df.head()","9ff6fe28":"df.tail()","c2badcfc":"df.info()","7d7887ec":"df.shape","a7dce984":"df.drop(columns=['ca'],inplace=True)","3253b7d2":"df.shape","5236190c":"df.isnull().sum()","0977d543":"df.skew()","3381c3ec":"df['thalach'].fillna(df['thalach'].mean(),inplace=True)","ce407b0b":"df.fillna(df.median(),inplace=True)","386535c7":"df.isnull().sum()","8c2ea319":"df.duplicated().sum()","a8b5d1fb":"df.drop_duplicates(inplace=True)","eaa130a1":"df.shape","cd1b61a1":"cor=df.corr()\nplt.figure(figsize=(20,12))\nsns.heatmap(cor,annot=True,cmap='coolwarm')\nplt.show()","29fbfca0":"df.columns","0e00fd8e":"df=df.rename(columns={\"num       \":\"num\"})","a95429a1":"df.columns","f31a7d1d":"plt.figure(figsize=(12,5))\nplt.title(\"AGE VRS NUM\")\nsns.distplot(df.age[df.num==0],color=\"darkblue\")\nsns.distplot(df.age[df.num==1],color=\"cyan\")\nplt.legend(['0','1'])\nplt.show()","f2e129ed":"df.hist()\nplt.figure(figsize=(20,12))\nplt.show()","b9370a47":"plt.figure(figsize=(12,5))\nplt.title(\"TRESTBPS VRS NUM\")\nsns.distplot(df.trestbps[df.num==0],color=\"darkblue\")\nsns.distplot(df.trestbps[df.num==1],color=\"cyan\")\nplt.legend(['0','1'])\nplt.show()","dc53f30a":"plt.figure(figsize=(12,5))\nplt.title(\"CHO VRS NUM\")\nsns.distplot(df.chol[df.num==0],color=\"darkblue\")\nsns.distplot(df.chol[df.num==1],color=\"cyan\")\nplt.legend(['0','1'])\nplt.show()","07141771":"plt.figure(figsize=(12,5))\nplt.title(\"THALACH VRS NUM\")\nsns.distplot(df.thalach[df.num==0],color=\"darkblue\")\nsns.distplot(df.thalach[df.num==1],color=\"cyan\")\nplt.legend(['0','1'])\nplt.show()","c7790900":"plt.figure(figsize=(6,3))\nplt.title(\"SEX VRS NUM\")\nsns.countplot(df.sex)\nplt.show()\nsns.countplot(df.sex[df.num==1])\nplt.show()","df741a7a":"plt.figure(figsize=(6,3))\nplt.title(\"CP VRS NUM\")\nsns.countplot(df.cp)\nplt.show()\nsns.countplot(df.cp[df.num==1])\nplt.show()","20c00268":"plt.figure(figsize=(6,3))\nplt.title(\"FBS VRS NUM\")\nsns.countplot(df.fbs)\nplt.show()\nsns.countplot(df.fbs[df.num==1])\nplt.show()","99dfca41":"plt.figure(figsize=(6,3))\nplt.title(\"RESTECG VRS NUM\")\nsns.countplot(df.restecg)\nplt.show()\nsns.countplot(df.restecg[df.num==1])\nplt.show()","89ee612c":"plt.figure(figsize=(6,3))\nplt.title(\"EXANG VRS NUM\")\nsns.countplot(df.exang)\nplt.show()\nsns.countplot(df.exang[df.num==1])\nplt.show()","37f19ce5":"plt.figure(figsize=(6,3))\nplt.title(\"SLOPE VRS NUM\")\nsns.countplot(df.slope)\nplt.show()\nsns.countplot(df.slope[df.num==1])\nplt.show()","9f2e9b63":"plt.figure(figsize=(6,3))\nplt.title(\"THAL VRS NUM\")\nsns.countplot(df.thal)\nplt.show()\nsns.countplot(df.thal[df.num==1])\nplt.show()","3f768547":"plt.figure(figsize=(12,5))\nplt.title(\"SEX VRS AGE VRS NUM\")\nsns.pointplot(x = 'sex',y='age',hue='num',data=df)\nplt.show()","654365a4":"plt.figure(figsize=(12,5))\nplt.title(\"CHOL VRS AGE VRS NUM\")\nsns.scatterplot(x='chol',y='age',hue='num',data=df)\nplt.show()","c0c6843e":"x=df[['age', 'sex', 'cp','trestbps', 'chol', 'fbs','restecg', 'thalach', 'exang', 'oldpeak', 'slope','thal']]\ny=df['num']\nprint(x)\nprint(y)","3588c0fc":"# split data into train and test\nfrom sklearn.model_selection import train_test_split\nxtr,xts,ytr,yts = train_test_split(x,y,test_size=0.2)\n# we have to split the data into 80% as train and 20% as test so we have specified test_size as 0.2\nprint(x.shape)\nprint(xtr.shape)\nprint(xts.shape)\nprint(y.shape)\nprint(ytr.shape)\nprint(yts.shape)","47e2204d":"from sklearn.decomposition import PCA\npca = PCA(n_components = 1)\nxtr = pca.fit_transform(xtr)\nxts = pca.transform(xts)\nexplained_variance = pca.explained_variance_ratio_","893d2103":"from sklearn.svm import SVC","5a0f162c":"from sklearn.metrics import classification_report,confusion_matrix","34cd867a":"svc_model=SVC()","253e3e31":"svc_model.fit(xtr,ytr)","3346f485":"y_pred=svc_model.predict(xts)","4dad8c59":"cm=confusion_matrix(yts,y_pred)","eed77ba8":"sns.heatmap(cm,annot=True)","f7378ea7":"min_train = xtr.min()\nmin_train","848bd075":"range_train = (xtr - min_train).max()\nrange_train","ef5dee30":"X_train_scaled = (xtr - min_train)\/range_train\nX_train_scaled","625ec151":"min_test = xts.min()\nrange_test = (xts - min_test).max()\nX_test_scaled = (xts - min_test)\/range_test","e3abcfde":"from sklearn.svm import SVC \nfrom sklearn.metrics import classification_report, confusion_matrix\n\nsvc_model = SVC()\nsvc_model.fit(X_train_scaled, ytr)","e7e8ac79":"y_predict = svc_model.predict(X_test_scaled)\ncm = confusion_matrix(yts, y_predict)\n\nsns.heatmap(cm,annot=True,fmt=\"d\")","0530e54a":"print(classification_report(yts,y_predict))","aa4a2461":"param_grid = {'C': [0.1, 1, 10, 100], 'gamma': [1, 0.1, 0.01, 0.001], 'kernel': ['rbf']} ","48942576":"from sklearn.model_selection import GridSearchCV\ngrid = GridSearchCV(SVC(),param_grid,refit=True,verbose=4)\ngrid.fit(X_train_scaled,ytr)","9fda1dfe":"grid.best_params_","c99062b8":"grid.best_estimator_","2f23832b":"grid_predictions = grid.predict(X_test_scaled)\ncm = confusion_matrix(yts, grid_predictions)\nsns.heatmap(cm, annot=True)","9f5c7c0f":"print(classification_report(yts,grid_predictions))","b8dce885":"from sklearn.svm import SVC\nclassifier = SVC(kernel = 'rbf', random_state = 0)","515e0d7b":"from sklearn.model_selection import cross_val_score\naccuracies = cross_val_score(estimator = classifier, X = xtr, y = ytr, cv = 10)\naccuracies","a7d24056":"print(accuracies.mean())\nprint(accuracies.std())","208ba1f9":"## 2.Data Exploration:-","f9c46e1a":"# Heart Attack Prediction","a28f5f52":"## Split the data into train and test set:-","a9ef3a44":"## Normalisation(2):","d19677c2":"## 4.Feature Selection:-","50464b9a":"age,sex,cp,old peak,num dont contain any null value .","394a1c3b":"## 3. Data Cleaning:-","594f6518":"## 1. Data collection :-","2a42b5f6":"# SVM","2e19131e":"## Normalisation(1):-"}}