{"cell_type":{"877fb569":"code","e4a856b9":"code","8d44c11e":"code","215ad408":"code","25cf7ed3":"code","52049d2f":"code","63da0031":"code","9005ab43":"code","7f4694cf":"code","1025afe8":"code","f5ad89a5":"code","563cc2e1":"code","00754f4b":"code","d1874b9e":"code","7d0700f8":"code","44fc3ca6":"code","be983e2b":"code","ed832028":"code","7ee079da":"code","01b9bb47":"code","a3250c6c":"code","ef654a14":"code","43f04ebf":"code","38efbf3f":"markdown","a727b83c":"markdown","0599332f":"markdown"},"source":{"877fb569":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","e4a856b9":"from fastai import *\nfrom fastai.vision import *","8d44c11e":"path = Path('\/kaggle\/input\/facial-age')\npath.ls()","215ad408":"tfms = get_transforms(max_rotate=20, max_zoom=1.3, max_lighting=0.4, max_warp=0.4,\n                      p_affine=1., p_lighting=1.)","25cf7ed3":"data = (ImageList.from_folder(path)\n       .split_by_rand_pct(0.2)\n       .label_from_folder()\n       .transform(tfms,size=224)\n       .databunch(bs=20))\n","52049d2f":"data.show_batch()","63da0031":"learn = cnn_learner(data,models.resnet34,metrics=[accuracy])","9005ab43":"learn.model_dir='\/kaggle\/working'","7f4694cf":"learn.lr_find()\nlearn.recorder.plot()","1025afe8":"learn.fit_one_cycle(10,slice(1e-1\/\/2,1e-2))","f5ad89a5":"learn.unfreeze()","563cc2e1":"learn.lr_find()\nlearn.recorder.plot()","00754f4b":"learn.save('stage-1')","d1874b9e":"learn.fit_one_cycle(10,slice(1e-6,1e-4))","7d0700f8":"learn.save('stage-2')","44fc3ca6":"learn.lr_find()\nlearn.recorder.plot()","be983e2b":"learn.load('stage-2')","ed832028":"learn.fit_one_cycle(30,1e-4)","7ee079da":"learn.save('stage-3')","01b9bb47":"learn.fit_one_cycle(10,1e-4)","a3250c6c":"learn.save('stage-4')","ef654a14":"learn.freeze()","43f04ebf":"learn.export('\/kaggle\/working\/export.pkl')","38efbf3f":"# Training Model","a727b83c":"# Import Libraries","0599332f":"# Getting Data"}}