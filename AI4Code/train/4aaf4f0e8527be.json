{"cell_type":{"572c87c0":"code","72aa1c37":"code","c24ee106":"code","a212961a":"code","e0c9b4cd":"code","bd73fba5":"code","ad19a55e":"code","2969c79f":"code","60dd77b8":"code","d1b47d13":"code","2c0540af":"code","aeea542a":"code","4533370c":"code","50a3dae1":"code","4d1b46fd":"code","b59d8931":"code","8a5a5c2f":"code","02d4f38d":"code","3115618f":"code","6ac2d276":"code","2e3e191d":"code","38ff2192":"code","3f601e72":"code","c4a9fd63":"code","48cc1421":"code","1613fdfa":"code","f0cf6d71":"code","48229978":"code","ece23a57":"markdown","3d357c8c":"markdown","8c6a16f4":"markdown","2c9d30ed":"markdown","1b29b616":"markdown","59f3ddb5":"markdown","0a9b20d1":"markdown","ae7889c9":"markdown","896c68e3":"markdown","131e25f2":"markdown","e40196b3":"markdown","000effcc":"markdown","7be66158":"markdown","35e7792b":"markdown","c8a6830f":"markdown","8a86bd73":"markdown","1f229bba":"markdown","b409f9df":"markdown","1a3ca461":"markdown","c9205509":"markdown","8380dfc8":"markdown","f8fdf0dd":"markdown","8673d77c":"markdown","21573aa5":"markdown","2e959b86":"markdown","9aeb6d38":"markdown"},"source":{"572c87c0":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set_style(style='darkgrid')\nfrom xgboost import XGBClassifier\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.metrics import mean_squared_error, mean_absolute_error\nfrom sklearn.metrics import confusion_matrix, classification_report\nfrom sklearn.ensemble import RandomForestClassifier, GradientBoostingClassifier, BaggingClassifier\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.preprocessing import StandardScaler\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","72aa1c37":"stroke = pd.read_csv('..\/input\/stroke-prediction-dataset\/healthcare-dataset-stroke-data.csv')\nstroke.head()","c24ee106":"stroke.info()","a212961a":"stroke.describe()","e0c9b4cd":"stroke.isnull().sum()","bd73fba5":"fig, ax = plt.subplots(figsize=(9,5))\nsns.boxplot(data=stroke['bmi'])","ad19a55e":"#BMI max. 50\nstroke['bmi'] = stroke['bmi'].apply(lambda x: 50 if x > 50 else x)\nstroke[\"bmi\"] = stroke[\"bmi\"].fillna(25)\nstroke.isnull().sum()","2969c79f":"plt.figure(figsize=(15,5))\nsns.heatmap(stroke.corr(),annot=True);","60dd77b8":"stroke_count = stroke['stroke'].value_counts()\nprint(stroke_count)\ncolors = [\"darkgray\",\"lightgrey\"]\nfig, ax = plt.subplots(figsize=(15,7))\nax.pie(stroke_count, autopct='%1.1f%%', colors=colors)\nax.set_title('Person With Stroke Disease', fontsize=15)\nax.legend(['No','Yes'],\n          title='Survivor',\n          bbox_to_anchor=(1,1))","d1b47d13":"stroke_gndr = stroke['gender'].value_counts()\nstroke_gndr_1 = stroke.loc[stroke['stroke'] == 1]\nstroke_gndr_1 = stroke_gndr_1['gender'].value_counts()\nprint(stroke_gndr)\nprint(stroke_gndr_1)\n\nfig, ax = plt.subplots(1,2,figsize=(12,7))\nfig.tight_layout(pad=9)\ncolors = [\"palegoldenrod\",\"khaki\",\"darkkhaki\"]\nax[0].pie(stroke_gndr, autopct='%1.1f%%', colors=colors)\nax[0].set_title('Gender Total')\nax[0].legend(['Female','Male','Other'],\n          title='Gender',\n          bbox_to_anchor=(1,1))\n\ncolors = [\"skyblue\",\"deepskyblue\"]\nax[1].pie(stroke_gndr_1, autopct='%1.1f%%', colors=colors)\nax[1].set_title('Stroke Survivor Based on Gender')\nax[1].legend(['Female','Male','Other'],\n          title='Gender',\n          bbox_to_anchor=(1,1))","2c0540af":"def group(age):\n    if age >= 0 and age <= 9:\n        age = \"0-10\"\n    elif age >= 10 and age <= 19:\n        age = \"10-19\"\n    elif age >= 20 and age <= 29:\n        age = \"20-29\"\n    elif age >= 30 and age <= 39:\n        age = \"30-39\"\n    elif age >= 40 and age <= 49:\n        age = \"40-49\"\n    elif age >= 50 and age <= 59:\n        age = \"50-59\"\n    elif age >= 60 and age <= 69:\n        age = \"60-69\"\n    elif age >= 70 and age <= 79:\n        age = \"70-79\"\n    elif age >= 80 and age <= 89:\n        age = \"80-89\"\n    \n    return age\n    \nstroke_age_gndr = stroke.loc[:,['gender','age','stroke']]\nstroke_age_gndr = stroke_age_gndr.loc[stroke_age_gndr['stroke'] == 1]\nstroke_age_gndr['age'] = stroke_age_gndr['age'].apply(lambda x: group(x)) ","aeea542a":"#ax = stroke_age_gndr.groupby(['age','gender']).count().unstack().plot.bar()\nfig, ax = plt.subplots(figsize=(10,7))\nsns.countplot(data=stroke_age_gndr.sort_values(by='age'), x='age', hue='gender')\nax.set_title('Stroke Survivor Based on Age', fontsize=15)\nax.set_ylabel('Survivor')\nax.set_xlabel('Age')","4533370c":"stroke_new = stroke.loc[stroke['stroke'] == 1]\nstroke_hpy = stroke_new['hypertension'].value_counts()\nstroke_hea = stroke_new['heart_disease'].value_counts()\nprint(stroke_hea)\nprint(stroke_hpy)\n\nfig, ax = plt.subplots(1, 2,figsize=(12,7))\nfig.tight_layout(pad=9)\ncolors = [\"wheat\",\"orange\"]\nax[0].pie(stroke_hpy, autopct='%1.1f%%', colors=colors)\nax[0].set_title('Stroke Survivor Hypertension')\nax[0].legend(['No','Yes'],\n          title='Hypertension',\n          bbox_to_anchor=(1,1))\n\ncolors = [\"aquamarine\",\"turquoise\"]\nax[1].pie(stroke_hea, autopct='%1.1f%%', colors=colors)\nax[1].set_title('Stroke Survivor Heart Disease')\nax[1].legend(['No','Yes'],\n          title='Heart Disease',\n          bbox_to_anchor=(1,1))","50a3dae1":"stroke_em = stroke_new['ever_married'].value_counts()\nprint(stroke_em)\n\nfig, ax = plt.subplots(figsize=(15,7))\ncolors = [\"darkseagreen\",\"palegreen\"]\nax.pie(stroke_hpy, autopct='%1.1f%%', colors=colors)\nax.set_title('Stroke Survivor Married Status', fontsize=15)\nax.legend(['Yes','No'],\n          title='Married Status',\n          bbox_to_anchor=(1,1))","4d1b46fd":"stroke_res = stroke_new['Residence_type'].value_counts()\nprint(stroke_res)\n\nfig, ax = plt.subplots(1, 2,figsize=(12,7))\nfig.tight_layout(pad=9)\ncolors = [\"darksalmon\",\"coral\",\"tomato\",\"mistyrose\"]\nsns.countplot(ax=ax[0], data=stroke_new, x='work_type')\nax[0].set_title('Stroke Survivor Work Type')\nax[0].set_xlabel('Work Type')\nax[0].set_ylabel('Count')\n\ncolors = [\"plum\",\"violet\"]\nax[1].pie(stroke_res, autopct='%1.1f%%', colors=colors)\nax[1].set_title('Stroke Survivor Residence Type')\nax[1].legend(['Urban','Rural'],\n          title='Residence Type',\n          bbox_to_anchor=(1,1))","b59d8931":"fig, ax = plt.subplots(1, 2,figsize=(12,7))\nsns.histplot(ax=ax[0], data = stroke_new['avg_glucose_level'])\nax[0].set_title('Stroke Survivor Average Glucose Level')\nax[0].set_xlabel('Average Glucose Level')\n\nsns.histplot(ax=ax[1], data = stroke['bmi'])\nax[1].set_title('Stroke Survivor BMI')\nax[1].set_xlabel('BMI')","8a5a5c2f":"sns.countplot(data=stroke_new, x='smoking_status')\nplt.title('Stroke Survivor Smoking Status')\nplt.ylabel('Count')\nplt.xlabel('Smoking Status')","02d4f38d":"stroke_predict = stroke.copy()\nstroke_predict = stroke_predict.drop(['id'], axis=1)\nstroke_predict.info()","3115618f":"stroke_predict['gender'] = stroke_predict['gender'].apply(lambda x: 1 if x == 'Female' else 0)\nstroke_predict['ever_married'] = stroke_predict['ever_married'].apply(lambda x: 1 if x == 'Yes' else 0)\nstroke_predict['Residence_type'] = stroke_predict['Residence_type'].apply(lambda x: 1 if x == 'Urban' else 0)\nstroke_predict = pd.get_dummies(data=stroke_predict, columns=['smoking_status'])\nstroke_predict = pd.get_dummies(data=stroke_predict, columns=['work_type'])","6ac2d276":"scaler = StandardScaler()\nstroke_predict['age'] = scaler.fit_transform(stroke_predict[['age']])\nstroke_predict['avg_glucose_level'] = scaler.fit_transform(stroke_predict[['avg_glucose_level']])\nstroke_predict['bmi'] = scaler.fit_transform(stroke_predict[['bmi']])\n\nstroke_predict.head()","2e3e191d":"X = stroke_predict.drop(['stroke'], axis=1)\ny = stroke_predict['stroke']\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3)","38ff2192":"model = DecisionTreeClassifier()\nmodel = model.fit(X_train, y_train)\n\ny_pred = model.predict(X_test)\n\nprint(\"Training Score: \", model.score(X_train, y_train))\nprint(\"Test Score: \", model.score(X_test, y_test))\ntrain_score1 = model.score(X_train, y_train)\ntest_score1 = model.score(X_test, y_test) \n\ncm = confusion_matrix(y_test, y_pred)\ncr = classification_report(y_test, y_pred)\n\nprint(cm)\nprint(cr)","3f601e72":"model = LogisticRegression()\nmodel = model.fit(X_train, y_train)\n\ny_pred = model.predict(X_test)\n\nprint(\"Training Score: \", model.score(X_train, y_train))\nprint(\"Test Score: \", model.score(X_test, y_test))\ntrain_score2 = model.score(X_train, y_train)\ntest_score2 = model.score(X_test, y_test)\n\ncm = confusion_matrix(y_test, y_pred)\ncr = classification_report(y_test, y_pred)\n\nprint(cm)\nprint(cr)","c4a9fd63":"model = RandomForestClassifier()\nmodel = model.fit(X_train, y_train)\n\ny_pred = model.predict(X_test)\n\nprint(\"Training Score: \", model.score(X_train, y_train))\nprint(\"Test Score: \", model.score(X_test, y_test))\ntrain_score3 = model.score(X_train, y_train)\ntest_score3 = model.score(X_test, y_test)\n\ncm = confusion_matrix(y_test, y_pred)\ncr = classification_report(y_test, y_pred)\n\nprint(cm)\nprint(cr)","48cc1421":"model = XGBClassifier()\nmodel = model.fit(X_train, y_train)\n\ny_pred = model.predict(X_test)\n\nprint(\"Training Score: \", model.score(X_train, y_train))\nprint(\"Test Score: \", model.score(X_test, y_test))\ntrain_score4 = model.score(X_train, y_train)\ntest_score4 = model.score(X_test, y_test)\n\ncm = confusion_matrix(y_test, y_pred)\ncr = classification_report(y_test, y_pred)\n\nprint(cm)\nprint(cr)","1613fdfa":"model = GradientBoostingClassifier()\nmodel = model.fit(X_train, y_train)\n\ny_pred = model.predict(X_test)\n\nprint(\"Training Score: \", model.score(X_train, y_train))\nprint(\"Test Score: \", model.score(X_test, y_test))\ntrain_score5 = model.score(X_train, y_train)\ntest_score5 = model.score(X_test, y_test)\n\ncm = confusion_matrix(y_test, y_pred)\ncr = classification_report(y_test, y_pred)\n\nprint(cm)\nprint(cr)","f0cf6d71":"model = BaggingClassifier()\nmodel = model.fit(X_train, y_train)\n\ny_pred = model.predict(X_test)\n\nprint(\"Training Score: \", model.score(X_train, y_train))\nprint(\"Test Score: \", model.score(X_test, y_test))\ntrain_score6 = model.score(X_train, y_train)\ntest_score6 = model.score(X_test, y_test)\n\ncm = confusion_matrix(y_test, y_pred)\ncr = classification_report(y_test, y_pred)\n\nprint(cm)\nprint(cr)","48229978":"print(\"Decision Tree\\nTraining Score:\", train_score1, \"\\nAccuracy:\", test_score1)\nprint(\"\\nLogistic Reggresion\\nTraining Score:\", train_score2, \"\\nAccuracy:\", test_score2)\nprint(\"\\nRandom Forest\\nTraining Score:\", train_score3, \"\\nAccuracy:\", test_score3)\nprint(\"\\nXGB Classifier\\nTraining Score:\", train_score4, \"\\nAccuracy:\", test_score4)\nprint(\"\\nGradient Boosting Classifier\\nTraining Score:\", train_score5, \"\\nAccuracy:\", test_score5)\nprint(\"\\nBagging Classifier\\nTraining Score:\", train_score6, \"\\nAccuracy:\", test_score6)","ece23a57":"## Work and Residence Type","3d357c8c":"## Married Status","8c6a16f4":"## Stroke Survivor Based on Age","2c9d30ed":"#### Decision Tree","1b29b616":"## Person with Stroke Disease","59f3ddb5":"Column 'bmi' have 201 missing values","0a9b20d1":"# Result (Accuracy and Training Score)","ae7889c9":"## Fit Model","896c68e3":"## Smoking Status","131e25f2":"#### Gradient Boosting Classifier","e40196b3":"Imputation","000effcc":"# Exploratory Data Analysis","7be66158":"## Distribusion Avg Glucose Lv and BMI","35e7792b":"## Build Model","c8a6830f":"#### Logistic Regression","8a86bd73":"# Stroke Disease Predict","1f229bba":"## Data info","b409f9df":"## Encoding","1a3ca461":"## Gender Survivor and Stroke Status","c9205509":"#### Random Forest","8380dfc8":"#### XGB Classifier","f8fdf0dd":"## Scaling","8673d77c":"# Read data","21573aa5":"#### Bagging Classifier","2e959b86":"## Handling Missing Values","9aeb6d38":"## Hypertension and Heart Disease of Stroke Survivor"}}