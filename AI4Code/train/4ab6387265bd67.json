{"cell_type":{"c4f70426":"code","0336df3b":"code","24fb6ec8":"code","6620c6ca":"code","02d765f5":"code","c198bff4":"code","77e9e983":"code","a480370f":"code","1f35c4de":"code","e9d9e52f":"code","bd6aeda4":"code","21467b25":"code","6ee1a113":"code","7c51f2b1":"code","f10a9095":"code","d0268a56":"code","33fe0fd4":"code","7c228b09":"code","636a9e3a":"code","61814b6a":"code","c4305560":"code","c4cf0ef2":"code","59da65d7":"code","174c9075":"code","276a0934":"code","84998c3f":"code","cc967d4c":"code","18359874":"code","cad9e8a5":"code","a1790cf2":"code","0b4469a5":"code","b96a0436":"code","a92f4d40":"code","c795fd85":"code","69aa8f35":"code","9d4ffe6b":"code","269be978":"markdown","c46ca70f":"markdown","27db7102":"markdown","e141edba":"markdown","8e449c73":"markdown","e4993d81":"markdown","0c0fdafe":"markdown","e583b653":"markdown","efa5a7f2":"markdown","34665d97":"markdown","7293b548":"markdown","a6af9ac4":"markdown","94d6723d":"markdown","dc2d336c":"markdown","b4cc0c2d":"markdown","199fe21c":"markdown","4c327bb1":"markdown","ddd87dbb":"markdown","34e3d4ab":"markdown","3cc0236e":"markdown","5fa5d4e4":"markdown","87110e74":"markdown","584099ed":"markdown","52e4f683":"markdown","d8c220f2":"markdown","0bf06c50":"markdown","5df18017":"markdown","bb0a6208":"markdown","36628e25":"markdown","53ced560":"markdown","f1c35de7":"markdown","295e55ec":"markdown","3cad8c76":"markdown","edc69741":"markdown","a0271752":"markdown","7aa338a8":"markdown"},"source":{"c4f70426":"import pandas as pd\nimport seaborn as sns \nimport matplotlib.pyplot as plt\nfrom sklearn.ensemble import RandomForestRegressor\nimport statsmodels.api as sm\nfrom sklearn.metrics import mean_absolute_error, r2_score\nimport numpy as np","0336df3b":"df = pd.read_csv('\/kaggle\/input\/graduate-admissions\/Admission_Predict.csv', sep=r'\\s*,\\s*',\n                           header=0, encoding='ascii', engine='python')","24fb6ec8":"df","6620c6ca":"# Dropping the unnecessary iterative variable\ndf = df.drop(\"Serial No.\", axis=1)","02d765f5":"df.isnull().sum()","c198bff4":"sns.countplot(\"University Rating\", data=df)","77e9e983":"# Dataframe containing all the enteries of students who have undertaken research\ndf_research = df[df[\"Research\"] == 1]\n\n# Dataframe containing all the enteries of students who havent undertaken research\ndf_no_research = df[df[\"Research\"] == 0]\n\n# Getting a distribution of the likelihood of admission for the students who have gotten an admit and who havent \nplt.figure(figsize=(9, 8))\nsns.distplot((df_research[\"Chance of Admit\"]), color='g', bins=100, hist_kws={'alpha': 0.4});\nsns.distplot((df_no_research[\"Chance of Admit\"]), color='b', bins=100, hist_kws={'alpha': 0.4});","a480370f":"corr = df.corr() \nplt.figure(figsize=(12, 10))\n\nsns.heatmap(corr[(corr >= 0.5) | (corr <= -0.4)], \n            cmap='viridis', vmax=1.0, vmin=-1.0, linewidths=0.1,\n            annot=True, annot_kws={\"size\": 8}, square=True)","1f35c4de":"for i in range(0, len(df.columns), 5):\n    sns.pairplot(data=df,\n                x_vars=df.columns[i:i+5],\n                y_vars=['Chance of Admit'])","e9d9e52f":"plt.figure(figsize=(15, 6))\nax = sns.boxplot(x=\"SOP\", y=\"Chance of Admit\", hue=\"SOP\", data=df)","bd6aeda4":"SOP_ratings_to_filter =  [4, 4.5, 5]\n\n# We will consider the outliers to be the ones which lie in the lower 10 percentile of the enteries for that rating of the SOP\nfor i in SOP_ratings_to_filter:\n    df_i = df[df[\"SOP\"] == i]\n    df_outliers = df_i[(df_i[\"Chance of Admit\"] < df[\"Chance of Admit\"].quantile(0.30))]\n    display(df_outliers)","21467b25":"plt.figure(figsize=(15, 6))\nax = sns.boxplot(x=\"LOR\", y=\"Chance of Admit\", hue=\"LOR\", data=df)","6ee1a113":"LOR_ratings_to_filter =  [4, 4.5, 5]\n\n# We will consider the outliers to be the ones which lie in the lower 10 percentile of the enteries for that rating of the SOP\nfor i in LOR_ratings_to_filter:\n    df_i = df[df[\"LOR\"] == i]\n    df_outliers = df_i[(df_i[\"Chance of Admit\"] < df[\"Chance of Admit\"].quantile(0.30))]\n    display(df_outliers)","7c51f2b1":"g =sns.scatterplot(x=\"GRE Score\", y=\"TOEFL Score\",\n              hue=\"Chance of Admit\",\n              data=df);\ng.set(xscale=\"log\");","f10a9095":"g =sns.scatterplot(x=\"SOP\", y=\"LOR\",\n              hue=\"Chance of Admit\",\n              data=df);\ng.set(xscale=\"log\");","d0268a56":"mean_liklehood = df[\"Chance of Admit\"].mean()","33fe0fd4":"mean_liklehood","7c228b09":"df[\"Admit\"] = [1 if df[\"Chance of Admit\"][i] > mean_liklehood else 0 for i in range(len(df))]","636a9e3a":"sns.countplot(\"Admit\", data=df)","61814b6a":"df","c4305560":"df_admit = df[df[\"Admit\"] == 1]\nsns.countplot(\"University Rating\", data=df_admit)","c4cf0ef2":"df_admit = df_admit[(df_admit[\"University Rating\"] >= 2)]","59da65d7":"plt.figure(figsize=(15, 7))\nax = sns.boxplot(x=\"Admit\", y=\"GRE Score\", hue=\"Admit\", data=df)\n","174c9075":"df_stats = pd.DataFrame()\nfor i in range(3, max(df[\"University Rating\"] + 1)):\n    df_curr_rating = df_admit[(df_admit[\"University Rating\"] == i)]\n    stats = [df_curr_rating.mean()]\n    df_stats = df_stats.append(stats)\n\ndf_stats","276a0934":"from scipy import stats\n\nfor col in df_stats:\n    df_stats[col + \"_percentile\"] = [0 for i in range(len(df_stats))]\n    arr = []\n    for i, ent in enumerate(df_stats[col]):\n        percentile = stats.percentileofscore(df[col], ent)\n        arr.append(percentile)\n    df_stats[col + \"_percentile\"] = arr\n","84998c3f":"# df_stats = df_stats.drop([\"Admit\", \"University Rating_percentile\", \"Research_percentile\", \"Chance of Admit_percentile\", \"Admit_percentile\"], axis=1)\ndf_stats","cc967d4c":"# import matplotlib.pyplot as plt\n# ax = df_stats[['GRE Score_percentile','TOEFL Score_percentile', 'CGPA_percentile', 'LOR_percentile', 'SOP_percentile']].plot(kind='bar', title =\"Percentile Scores\", x=df_stats[\"University Rating\"], figsize=(15, 10), legend=True, fontsize=12)\n# ax.set_xlabel(\"University Rating\", fontsize=12)\n# ax.set_ylabel(\"Percentile Scores\", fontsize=12)\n# plt.show()\n\n\ndf_stats.plot(x=\"University Rating\", y=[\"GRE Score_percentile\", \"TOEFL Score_percentile\", \"SOP_percentile\", \"LOR_percentile\", \"CGPA_percentile\"], kind=\"bar\", figsize=(10,10))\n","18359874":"y = df_admit[\"Chance of Admit\"] \nX = df_admit.drop([\"Chance of Admit\", \"Admit\", \"University Rating\"], axis=1)","cad9e8a5":"names = X.columns\nrf = RandomForestRegressor()\nrf.fit(X, y)\nprint(\"Features sorted by their score:\")\narr = sorted(zip(map(lambda x: round(x, 4), rf.feature_importances_), names), \n             reverse=True)\nprint(arr)\n\nsns.barplot(x=[ent[0] for ent in arr], y=[ent[1] for ent in arr])","a1790cf2":"df_top = df_admit[df_admit[\"University Rating\"] >= 4.0]","0b4469a5":"df_top","b96a0436":"y_top = df_top[\"Chance of Admit\"] \nX_top = df_top.drop([\"Chance of Admit\", \"Admit\", \"University Rating\"], axis=1)","a92f4d40":"names = X.columns\nrf = RandomForestRegressor()\nrf.fit(X_top, y_top)\nprint(\"Features sorted by their score:\")\narr = sorted(zip(map(lambda x: round(x, 4), rf.feature_importances_), names), \n             reverse=True)\n\nprint(arr)\nsns.barplot(x=[ent[0] for ent in arr], y=[ent[1] for ent in arr])","c795fd85":"model = sm.OLS(y,X)\nresults = model.fit()\nresults.summary()","69aa8f35":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.25)\n\nfrom sklearn.ensemble import RandomForestRegressor\nrf = RandomForestRegressor(n_estimators = 1000, random_state = 42)\nrf.fit(X_train, y_train);","9d4ffe6b":"predictions = rf.predict(X_test)\nerrors = abs(predictions - y_test)\n\nmape = 100 * (errors \/ y_test)\naccuracy = 100 - np.mean(mape)\nprint('Accuracy:', round(accuracy, 2), '%.')","269be978":"Doing the same for SOP and LOR ratings","c46ca70f":"From the above diagram, we can see that a high score in both GRE and TOEFL is necessary to increase the chance of admit in the universities. A lower score in any of the tests could result in decreasing the chance of admission. ","27db7102":"Count of University ratings for each each rating (1-5), to check if each rated university has a fair representation ","e141edba":"For the prediction of likelihood, using Random Forest was a better choice because data fed in the random forest model does not need to be scaled and RF can also handle binary data. RF accomodates the parameters in our model because scaling any of the scores\/ratings\/reasearch would either result in loss of data or improper scaling because all the parameters lie on various different ranges. ","8e449c73":"The figure clearly indicates that a higher rated SOP does play a role in maximising the likelihood of getting an admit, there always are scenarios where a very high rated SOP does not boost the chance of getting and admit. For example, in the above scenario, this could be further analysed by filtering out the high rated SOPs which have a low chance of admittance and what are the factors causing it ","e4993d81":"Column wise lookup for missing values to avoid faulty\/inaccurate predictions ","0c0fdafe":"Impact of the rating of SOP on the likelihood of admission","e583b653":"The feature importances almost remain the same for top rated universities as well.","efa5a7f2":"Adding one more column which suggests if a student has gotten an admit in the university or not. For this purpose, we will set the threshold to be the mean of the likelihood of admissions. All the likelihoods above the threshold would indicate that a student has gotten an admit in the university and all the likelihoods below the threshold would mean no admit.","34665d97":"It can be seen that it is very important to have a good standing of SOP and CGPA in average to get into a rating = 5 \nuniversity. However, to get into a slightly lesser rated university, i.e. rating = 4, we see that the GRE, TOEFL and \nCGPA scores need to be up to the mark. The SOP needs to be least competitve of all the factors to get into a rating = 3\nuniversiy, but for universities rated 4 and 5, it is essential to have a top notch SOP. A LOR might not possibly be a very \nstrong distinguishing factor for getting in a university rated 4 or 5. CGPA plays an incremental role in getting an admit.","7293b548":"We see that factors like LOR, SOP and Research are not as strong indicators of getting an admit as CGPA, GRE and TOEFL","a6af9ac4":"Getting a plot of correlation between the variables","94d6723d":"Checking feature importances based on OLS Regression","dc2d336c":"We can see that there are relatively less outliers for higher ratings of LOR than for higher ratings of SOP which is a \"loose\" indicator of the fact that LOR ratings play a more significant role in increasing the chance of admission than SOP rating (for the higher rated SOPs and LORs). ","b4cc0c2d":"From the above results we can see that SOP and LOR are the factors which are the least significant in determining the likelihood of an admit. ","199fe21c":"A very clear distinction line is drawn by the GRE Scores which determines if a candidate gets an admit or does not.","4c327bb1":"Average scores required in each of the tests to get an admit in the respectively rated university","ddd87dbb":"Quite an imbalance in the dataset which could lead us to draw faulty conclusions about universities rated 1 and 2. It is better \nto drop out these rating and not analyse them further","34e3d4ab":"**Gradute Admission Dataset EDA and Prediction**","3cc0236e":"Again, from the above scatter plot, we can conclude that a top rated SOP and a top rated LOR do increase the chance of admit in a University. A lower rating for any of the SOP or LOR could lower the chance of admit. ","5fa5d4e4":"We can see that the universities rated 1 are not widely represented in the dataset and hence we cannot be very certain about the results we obtain for the rating = 1 universities","87110e74":"All the variables are linearly correlated with the chance of admission, i.e. as the score in a particular test becomes higher, the chance of admission also increases. ","584099ed":"A better insight would be given by the percentile of each of these average scores from our dataset, i.e. where do these average scores stand as far as their percentile is concerned","52e4f683":"GRE and TOEFL score exhibit high correlation with the chance of admission. Visualising the chance of admission plotted against GRE and TOEFL scores. ","d8c220f2":"Distribution of admits \/ no admits as exxpected ","0bf06c50":"Getting feature importance of each of the features","5df18017":"From the above observations, it could be concluded that CGPA is the most important parameter in determining the likelihood of admit and research is the least important parameter. ","bb0a6208":"Getting count of each of the University rating for Admit = 1","36628e25":"From the figure, it seems like LOR ratings have less outliers when plotted against the likelihood of admission as compared to LOR ratings. Checking for the outliers in LOR ratings:","53ced560":"From the above results we can figure that high rated SOPs can result in low likelihood of admit if there are low scores in the other accompnying domains.  ","f1c35de7":"Checking the impact of research on the likelehood of admissions","295e55ec":"Impact of the rating of LOR on the likelihood of admission","3cad8c76":"Checking if this is any different for top rated Universities. ","edc69741":"Having a research background does not always ensure a high likelihood for getting into a university, but it sure does play a significant role in increasing the chances of an admit.","a0271752":"Filtering results rating wise and getting average scores for each of the tests for each university rating to get an admit \n","7aa338a8":"Scatter plot of each of the columns against the likelihood of admission "}}