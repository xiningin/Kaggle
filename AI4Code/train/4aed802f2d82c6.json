{"cell_type":{"24f2e0e9":"code","669d95e7":"code","b652fdaf":"code","0cc1cc21":"code","1ed8295e":"code","474d37b6":"code","ee546229":"code","b6dbfb94":"code","dcb00a40":"code","b15fe321":"code","559e09e2":"code","7b688e0f":"code","bafb056f":"code","db6c7d92":"code","b0c26f33":"code","7a36f028":"code","2adaff08":"code","6f967a57":"code","af56a8a6":"code","86712f7a":"code","6db19de3":"code","e5b2cb7b":"code","a24b3dc7":"code","f4b1089e":"code","6f794604":"code","0b883aa8":"code","a28f0f63":"code","c33e903e":"markdown","1cdc3378":"markdown","926ee5ff":"markdown","0da39b38":"markdown","5ec715e7":"markdown","7211c99e":"markdown","e350cb6a":"markdown","71139e75":"markdown","bb5e8b3e":"markdown","e093b2be":"markdown","46380e83":"markdown","16caa703":"markdown","71063cdf":"markdown","c587557d":"markdown","f6081f45":"markdown","09478e8c":"markdown"},"source":{"24f2e0e9":"# Importing the Required Libraries\n\nimport pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom scipy.stats import norm\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LinearRegression, Lasso, Ridge, ElasticNet\nfrom sklearn.preprocessing import PolynomialFeatures, MinMaxScaler, LabelEncoder\nfrom sklearn.svm import SVR\nfrom sklearn.metrics import r2_score\nfrom sklearn.metrics import mean_squared_error\nimport warnings; warnings.simplefilter('ignore')","669d95e7":"# Importing the dataset\ndf_forest = pd.read_csv(\"\/kaggle\/input\/forest-fire-area\/forestfires.csv\")\ndf_forest.head()","b652fdaf":"# Shape of the dataset\nprint (\"The shape of the dataset : \", df_forest.shape)","0cc1cc21":"# Skewness of the Area in the dataset\nplt.rcParams['figure.figsize'] = [8, 8]\nsns.distplot(df_forest['area']);","1ed8295e":"# Reducing the Right Skewness of the Area using log(n) + 1\ndf_forest['u_area'] = np.log(df_forest['area'] + 1)","474d37b6":"# setting parameters\nplt.rcParams['figure.figsize'] = [20, 10]\nsns.set(style = \"darkgrid\", font_scale = 1.3)\nmonth_temp = sns.barplot(x = 'month', y = 'temp', data = df_forest,\n                         order = ['jan', 'feb', 'mar', 'apr', 'may', 'jun', 'jul', 'aug', 'sep', 'oct', 'nov', 'dec'], palette = 'winter');\nmonth_temp.set(title = \"Month Vs Temp Barplot\", xlabel = \"Months\", ylabel = \"Temperature\");","ee546229":"df_forest.day.unique()","b6dbfb94":"plt.rcParams['figure.figsize'] = [10, 10]\nsns.set(style = 'whitegrid', font_scale = 1.3)\nday = sns.countplot(df_forest['day'], order = ['sun' ,'mon', 'tue', 'wed', 'thu', 'fri', 'sat'], palette = 'spring')\nday.set(title = 'Countplot for the days in the week', xlabel = 'Days', ylabel = 'Count');","dcb00a40":"plt.rcParams['figure.figsize'] = [8, 8]\nsns.set(style = \"white\", font_scale = 1.3)\nscat = sns.scatterplot(df_forest['temp'], df_forest['area'])\nscat.set(title = \"Scatter Plot of Area and Temperature\", xlabel = \"Temperature\", ylabel = \"Area\");","b15fe321":"# After Reducing the Skewness\nplt.rcParams['figure.figsize'] = [8, 8]\nsns.set(style = \"white\", font_scale = 1.3)\nscat = sns.scatterplot(df_forest['temp'], df_forest['u_area'])\nscat.set(title = \"Scatter Plot of Area and Temperature\", xlabel = \"Temperature\", ylabel = \"Area\");","559e09e2":"# Setting Parameters\nplt.rcParams['figure.figsize'] = [20, 10]\nsns.set(style = 'white', font_scale = 1.3)\nfig, ax = plt.subplots(1,2)\n\n# Distribution Plots\narea_dist = sns.distplot(df_forest['area'], ax = ax[0]);\narea_dist_2 = sns.distplot(df_forest['u_area'], ax = ax[1]);\narea_dist.set(title = \"Skewed Area Distribution\", xlabel = \"Area\", ylabel = \"Density\")\narea_dist_2.set(title = \"Reduced Skewness of Area Distribution\", xlabel = \"U_Area\", ylabel = \"Density\");","7b688e0f":"# Correlation Heatmap of the features in the dataset\nplt.rcParams['figure.figsize'] = [12, 10]\nsns.set(font_scale = 1)\nsns.heatmap(df_forest.corr(), annot = True);","bafb056f":"data = norm.rvs(df_forest['area'])\n\n# Fit a normal distribution to the data\nmu, std = norm.fit(data)\n\nplt.hist(data, bins=25, density=True, alpha=0.6, color='g')\n\n# Plot the PDF\nxmin, xmax = plt.xlim()\nx = np.linspace(xmin, xmax, 100)\np = norm.pdf(x, mu, std)\nplt.plot(x, p, 'k', linewidth=2)\ntitle = \"Fit results: mu = %.2f,  std = %.2f\" % (mu, std)\nplt.title(title)\n\nplt.show()","db6c7d92":"# Reducing the skewness for the final training and dropping u_area\ndf_forest['area'] = np.log(df_forest['area'] + 1)\ndf_forest.drop(columns = 'u_area', inplace = True)\n\ndisplay(df_forest)","b0c26f33":"# Normalization of the features\nminmax = MinMaxScaler()\n\n# FFMC, DMC, DC, ISI, RH\ndf_forest['FFMC'] = minmax.fit_transform(np.array(df_forest['FFMC']).reshape(-1, 1))\ndf_forest['DMC'] = minmax.fit_transform(np.array(df_forest['DMC']).reshape(-1, 1))\ndf_forest['DC'] = minmax.fit_transform(np.array(df_forest['DC']).reshape(-1, 1))\ndf_forest['ISI'] = minmax.fit_transform(np.array(df_forest['ISI']).reshape(-1, 1))\ndf_forest['RH'] = minmax.fit_transform(np.array(df_forest['RH']).reshape(-1, 1))","7a36f028":"df_forest['day'].value_counts()","2adaff08":"df_forest.describe()","6f967a57":"# Changing categorical values into numerical values\n\n# Months\ndf_forest['month'].replace({'jan' : 1, 'feb' : 2, 'mar' : 3, 'apr' : 4, 'may' : 5, 'jun' : 6,\n                           'jul' : 7, 'aug' : 8, 'sep' : 9, 'oct' : 10, 'nov' : 11, 'dec' : 12},\n                           inplace = True)\n\n# Days\ndf_forest['day'].replace({'sun' : 1, 'mon' : 2, 'tue' : 3, 'wed' : 4, 'thu' : 5, 'fri' : 6, 'sat' : 7}, inplace = True)\n\n# # Using Label Encoder for cat to num conversion\n# categorical = list(df_forest.select_dtypes(include = [\"object\"]).columns)\n# for i, column in enumerate(categorical) :\n#     label = LabelEncoder()\n#     df_forest[column] = label.fit_transform(df_forest[column])\n\ndf_forest.head(10)","af56a8a6":"target = df_forest['area']\nfeatures = df_forest.drop(columns = 'area')\n\nX_train, X_test, y_train, y_test = train_test_split(features, target, test_size = 0.15, random_state = 196)\n\nprint (\"Train data set size : \", X_train.shape)\nprint (\"Test data set size : \", X_test.shape)","86712f7a":"X_train.head()","6db19de3":"# Linear Regression Model\nmodel = LinearRegression()\nmodel.fit(X_train, y_train)\n\n# Predictions\npredictions = model.predict(X_test)\n\n# Scores\nprint (\"Mean Squared Error : \", mean_squared_error(y_test, predictions))\nprint (\"r2 Score : \", r2_score(y_test, predictions))","e5b2cb7b":"# Transforming data\npoly = PolynomialFeatures(4)\npoly_X_train = poly.fit_transform(X_train)\npoly_X_test = poly.fit_transform(X_test)\n\nmodel_2 = LinearRegression()\nmodel_2.fit(poly_X_train, y_train)\n\n# Predictions\npredictions_poly = model_2.predict(poly_X_test)\n\n# Scores\nprint (\"Mean Squared Error : \", mean_squared_error(y_test, predictions_poly))\nprint (\"r2 Score : \", r2_score(y_test, predictions_poly))","a24b3dc7":"# Lasso regression\nmodel_3 = Lasso(alpha = 100, max_iter = 10000) \nmodel_3.fit(X_train, y_train)\n\n# Predictions\nprediction = model_3.predict(X_test)\n\n# Scores\nprint (\"Mean Squared Error : \", mean_squared_error(y_test, prediction))\nprint (\"r2 Score : \", r2_score(y_test, prediction))","f4b1089e":"# Ridge Regression\nmodel_4 = Ridge(alpha = 500)\nmodel_4.fit(X_train, y_train)\n\n# Predictions\npred = model_4.predict(X_test)\n\n# Scores\nprint (\"Mean Squared Error : \", mean_squared_error(y_test, pred))\nprint (\"r2 Score : \", r2_score(y_test, pred))","6f794604":"# ElasticNet\nmodel_5 = ElasticNet(alpha = 100, max_iter = 10000)\nmodel_5.fit(X_train, y_train)\n\n# Predictions\npred1 = model_5.predict(X_test)\n\n# Scores\nprint (\"Mean Squared Error : \", mean_squared_error(y_test, pred1))\nprint (\"r2 Score : \", r2_score(y_test, pred1))","0b883aa8":"# SVR\nmodel_6 = SVR(C = 100, kernel = 'linear')\nmodel_6.fit(X_train, y_train)\n\n# Predictions\nprediction = model_6.predict(X_test)\n\n# Scores\nprint (\"Mean Squared Error : \", mean_squared_error(y_test, prediction))\nprint (\"r2 Score : \", r2_score(y_test, prediction))","a28f0f63":"prediction = np.exp(prediction - 1)\nprediction","c33e903e":"## Preprocessing","1cdc3378":"#### Skewed and Unskewed Area Distribution","926ee5ff":"#### Correlation Heatmap","0da39b38":"#### Linear Regression","5ec715e7":"## Exploratory Data Analysis","7211c99e":"#### Scatter Plot between Area and Temperature","e350cb6a":"## Machine Learning Models","71139e75":"#### Ridge Regression","bb5e8b3e":"#### Lasso Regression","e093b2be":"#### Month Vs Temperature Barplot","46380e83":"#### SVR","16caa703":"#### Scatter Plot between unskewed Area and Temperature","71063cdf":"#### Polynomial Regression","c587557d":"#### ElasticNet","f6081f45":"#### Splitting the dataset into training and testing","09478e8c":"#### Countplot for the days in the week"}}