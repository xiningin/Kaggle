{"cell_type":{"ca7fc556":"code","e26c162d":"code","86dbe878":"code","4f939216":"code","d04c6b79":"code","c156109f":"code","d2db2987":"code","cca0bd75":"code","d0da61d2":"code","950f8d90":"code","4f81bc82":"code","cd3b8722":"code","fe05e148":"code","c909db9b":"code","808fbcd2":"code","301faa31":"code","14675f97":"code","0cd158d3":"code","eefd54d2":"code","f61326fc":"code","58e6cbab":"code","858724ec":"code","848ebe37":"code","f615bd21":"code","8ea8f207":"code","30b9c812":"code","ffb2f8b8":"code","f09bdb09":"code","11b7b069":"code","bb4dd13b":"markdown","d7a7bd87":"markdown","9228dfef":"markdown","f6da315c":"markdown","2d8b4790":"markdown","a84a830d":"markdown","88073a56":"markdown","d30d19d2":"markdown","87e165d7":"markdown","f4743b66":"markdown","7343fef5":"markdown","9ee93f4e":"markdown","4ddaf34a":"markdown","c7949cef":"markdown"},"source":{"ca7fc556":"#installing contractions library\n!pip -q install contractions","e26c162d":"#Generic Data Processing & Visualization Libraries\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport re,string,unicodedata\nimport contractions #import contractions_dict\nfrom bs4 import BeautifulSoup\n%matplotlib inline\n\n\n#Importing text processing libraries\nimport spacy\nimport spacy.cli\nimport nltk\nfrom nltk.tokenize.toktok import ToktokTokenizer\nfrom nltk.tokenize import word_tokenize\nfrom nltk.stem.lancaster import LancasterStemmer\nfrom nltk.stem.wordnet import WordNetLemmatizer\nfrom nltk.corpus import stopwords\n\n#downloading wordnet\/punkt dictionary\nnltk.download('wordnet')\nnltk.download('punkt')\nnltk.download('stopwords')\n\nimport warnings\nwarnings.filterwarnings(\"ignore\")\n\npd.set_option('display.max_columns', 100)","86dbe878":"#Loading Dataset\nurl = '..\/input\/sentiment-analysis-in-energy-crude-oil\/tweets.csv'\nraw_data = pd.read_csv(url, header='infer')","4f939216":"raw_data.shape","d04c6b79":"#Creating a seperate dataset with specific columns.\ndata = raw_data[['text','screenName','retweetCount']]\n","c156109f":"#Resetting Index\ndata.reset_index(drop=True, inplace=True)","d2db2987":"#Backup of the newly created dataset\ndata_backup = data.copy()","cca0bd75":"#lowering cases\ndata['text'] = data['text'].str.lower()\n","d0da61d2":"#stripping leading spaces (if any)\ndata['text'] = data['text'].str.strip()","950f8d90":"# Removing HTML tags\ndef strip_html_tags(text):\n    soup = BeautifulSoup(text, \"html.parser\")\n    stripped_text = soup.get_text()\n    return stripped_text\n\n#apply to the dataset\ndata['text'] = data['text'].apply(strip_html_tags)\n\n","4f81bc82":"# Remove URL and links\ndef strip_url(text):\n    strip_url_text = re.sub(r'http\\S+', '', text)\n    return strip_url_text\n\n#Applying the dataset\ndata['text'] = data['text'].apply(strip_url)","cd3b8722":"#removing punctuations\nfrom string import punctuation\n\ndef remove_punct(text):\n  for punctuations in punctuation:\n    text = text.replace(punctuations, '')\n  return text\n\n#apply to the dataset\ndata['text'] = data['text'].apply(remove_punct)","fe05e148":"#function to remove special characters\ndef remove_special_chars(text, remove_digits=True):\n  pattern = r'[^a-zA-z0-9\\s]'\n  text = re.sub(pattern, '', text)\n  return text\n\n#applying the function on the clean dataset\ndata['text'] = data['text'].apply(remove_special_chars)","c909db9b":"#function to remove macrons & accented characters\ndef remove_accented_chars(text):\n    text = unicodedata.normalize('NFKD', text).encode('ascii', 'ignore').decode('utf-8', 'ignore')\n    return text\n\n#applying the function on the clean dataset\ndata['text'] = data['text'].apply(remove_accented_chars)  ","808fbcd2":"#Function to expand contractions\ndef expand_contractions(con_text):\n  con_text = contractions.fix(con_text)\n  return con_text\n\n#applying the function on the clean dataset\ndata['text'] = data['text'].apply(expand_contractions)  ","301faa31":"#creating a new column in the dataset for word count\ndata ['word_count'] = data['text'].apply(lambda x:len(str(x).split(\" \")))","14675f97":"#Taking Backup\ndata_clean = data.copy()","0cd158d3":"#function to remove stopwords\ndef remove_stopwords(text, is_lower_case=False):\n    stopword_list = set(stopwords.words('english'))\n    tokenizer = ToktokTokenizer()\n    tokens = tokenizer.tokenize(text)\n    tokens = [token.strip() for token in tokens]\n    if is_lower_case:\n        filtered_tokens = [token for token in tokens if token not in stopword_list]\n    else:\n        filtered_tokens = [token for token in tokens if token.lower() not in stopword_list]\n    filtered_text = ' '.join(filtered_tokens)    \n    return filtered_text\n\n#applying the function\ndata ['text'] = data['text'].apply(remove_stopwords) ","eefd54d2":"#Function for stemming\ndef simple_stemmer(text):\n  ps = nltk.porter.PorterStemmer()\n  text = ' '.join([ps.stem(word) for word in text.split()])\n  return text\n\n#applying the function\ndata['Stemd_text'] = data['text'].apply(simple_stemmer)","f61326fc":"#rearranging columns\ndata = data[['screenName','text','Stemd_text','retweetCount','word_count']]","58e6cbab":"#Taking Backup\ndata_preproc = data.copy()","858724ec":"#Import Textblob Library\nfrom textblob import TextBlob","848ebe37":"#function to perform Textblob Sentiment Analyis\ndef sentiment_analysis(text):\n    polarity = round(TextBlob(text).sentiment.polarity, 3)\n    sentiment_categories = ['positive','negative','neutral']\n    if polarity > 0:\n        return sentiment_categories[0]\n    elif polarity < 0:\n        return sentiment_categories[1]\n    else:\n        return sentiment_categories[2]  \n        \n#Apply to the Stemd_Text\ndata['Sentiments'] = [sentiment_analysis(txt) for txt in data['Stemd_text']]","f615bd21":"num_bins = 50\nplt.figure(figsize=(10,6))\nn, bins, patches = plt.hist(data.word_count, num_bins, facecolor='blue', alpha=0.5)\nplt.xlabel('Word Count')\nplt.ylabel('Tweet Count')\nplt.title('Histogram of Word Count')\nplt.show();","8ea8f207":"#Creating a Count Plot\nsns.set(style=\"darkgrid\")\nfig, ax = plt.subplots(figsize=(8,8))\nax = sns.countplot(x=\"Sentiments\", data=data)\nplt.title('Sentiments Count')\nplt.ylabel('Count')\nplt.xlabel('Sentiments')","30b9c812":"data.head()","ffb2f8b8":"plt.figure(figsize=(10,6))\nsns.boxenplot(x='Sentiments', y='word_count', data=data)\nplt.show();","f09bdb09":"plt.figure(figsize=(10,6))\nsns.stripplot(x='Sentiments', y='retweetCount', data=data)\nplt.show();","11b7b069":"data[(data.Sentiments == 'negative') & (data.retweetCount > 35)]","bb4dd13b":"## Data Exploration","d7a7bd87":"### Removing Stop Words","9228dfef":"### Distribution of Word Count","f6da315c":"## Analysis & Visualisation","2d8b4790":"## Sentiment Analysis - TextBlob Library","a84a830d":"For the Sentiment Analysis, we would only be requiring the following columns:\n* text\n* screenName\n* retweetCount\n\nRest all the columns are not relevant.","88073a56":"## Text Preprocessing & Normalisation","d30d19d2":"## Importing Libraries & Loading Dataset","87e165d7":"# Performing a Sentiment Analysis of Energy Crude Oil Tweets","f4743b66":"**Analysis:** A majority of tweets are between 15 - 20 words long","7343fef5":"## Text Cleaning","9ee93f4e":"### Stemming","4ddaf34a":"**Analysis:** Majority of the tweets are netural with 'negative' tweets being the second highest","c7949cef":"### Who are the users who had negative sentiments & a high retweet count ?"}}