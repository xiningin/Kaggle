{"cell_type":{"9f1ae85e":"code","f5bd8ed2":"code","2753ac8d":"code","1ca9969c":"code","82b44740":"code","d4f24584":"code","28b288c7":"code","00b5b721":"markdown","9712e391":"markdown","b6b20d92":"markdown","fa7a65ad":"markdown","46cccf4d":"markdown","a6e22a99":"markdown","f1ac0f32":"markdown","0d069949":"markdown"},"source":{"9f1ae85e":"# 1. Enable Internet in the Kernel (Settings side pane)\n\n# 2. Curl cache may need purged if v0.1.6 cannot be found (uncomment if needed). \n# !curl -X PURGE https:\/\/pypi.org\/simple\/kaggle-environments\n\n# Battle Geese environment was defined in v0.2.1\n!pip install 'kaggle-environments>=0.2.1'","f5bd8ed2":"from kaggle_environments import evaluate, make\n\nenv = make(\"battlegeese\", debug=True)\nenv.render()","2753ac8d":"%%writefile submission.py\n\n# Silly agent which circles the perimeter clockwise.\ndef act(observation, configuration):\n    cols = configuration.columns\n    rows = configuration.rows\n    goose_head = observation.geese[observation.index][0]\n    if goose_head < cols - 1:\n        return \"E\"\n    elif goose_head % cols == 0:\n        return \"N\"\n    elif goose_head >= cols * (rows - 1):\n        return \"W\"\n    else:\n        return \"S\"","1ca9969c":"# Play against yourself without an ERROR or INVALID.\n# Note: The first episode in the competition will run this to weed out erroneous agents.\nenv.run([\"\/kaggle\/working\/submission.py\", \"\/kaggle\/working\/submission.py\"])\nprint(\"VALID SUBMISSION!\" if env.toJSON()[\"statuses\"] == [\"INACTIVE\", \"INACTIVE\"] else \"INVALID SUBMISSION!\")\n\n# Play as the first agent against default \"shortest\" agent.\nenv.run([\"\/kaggle\/working\/submission.py\", \"shortest\"])\nenv.render(mode=\"ipython\", width=800, height=600)","82b44740":"# Play as first position against random agent.\ntrainer = env.train([None, \"random\"])\n\nobservation = trainer.reset()\n\ndef my_agent(observation, configuration):\n    cols = configuration.columns\n    rows = configuration.rows\n    goose_head = observation.geese[observation.index][0]\n    if goose_head < cols - 1:\n        return \"E\"\n    elif goose_head % cols == 0:\n        return \"N\"\n    elif goose_head >= cols * (rows - 1):\n        return \"W\"\n    else:\n        return \"S\"\n\nwhile not env.done:\n    my_action = my_agent(observation, env.configuration)\n    print(\"My Action\", my_action)\n    observation, reward, done, info = trainer.step(my_action)\n    # env.render(mode=\"ipython\", width=100, height=90, header=False, controls=False)\nenv.render()","d4f24584":"def mean_reward(rewards):\n    wins = 0\n    ties = 0\n    loses = 0\n    for r in rewards:\n        r0 = 0 if r[0] is None else r[0]\n        r1 = 0 if r[1] is None else r[1]\n        if r0 > r1:\n            wins += 1\n        elif r1 > r0:\n            loses += 1\n        else:\n            ties += 1\n    return f'wins={wins\/len(rewards)}, ties={ties\/len(rewards)}, loses={loses\/len(rewards)}'\n\n# Run multiple episodes to estimate its performance.\n# Setup agentExec as LOCAL to run in memory (runs faster) without process isolation.\nprint(\"My Agent vs Random Agent:\", mean_reward(evaluate(\n    \"battlegeese\",\n    [\"\/kaggle\/working\/submission.py\", \"random\"],\n    num_episodes=20, configuration={\"agentExec\": \"LOCAL\"}\n)))\nprint(\"My Agent vs Shortest Agent:\", mean_reward(evaluate(\n    \"battlegeese\",\n    [\"\/kaggle\/working\/submission.py\", \"shortest\"],\n    num_episodes=20, configuration={\"agentExec\": \"LOCAL\"}\n)))","28b288c7":"# \"None\" represents which agent you'll manually play as.\nenv.play([None, \"shortest\", \"shortest\", \"shortest\"], width=800, height=600)","00b5b721":"# Create a Submission (agent)\n\nTo submit to the competition, a python file must be created where the last function is the \"act\" (the function which given an observation generates an action).  Logic above the \"act\" function is allowed including helpers.  Any python that executes immediately will be run during the initialize phase and not included in the \"act timeout\".\n\nWhen your agent is being evaluated against others, it will not have access to the Kaggle docker image. Only the following can be imported: Python Standard Library Modules, gym, numpy, scipy, pytorch (1.3.1, cpu only), and more may be added later.","9712e391":"# Create Battle Geese Environment","b6b20d92":"# Install kaggle-environments","fa7a65ad":"# Evaluate your Agent","46cccf4d":"# Submit to Competition\n\n1. Commit this kernel.\n2. View the commited version.\n3. Go to \"Data\" section and find submission.py file.\n4. Click \"Submit to Competition\"\n5. Go to [My Submissions](https:\/\/kaggle.com\/c\/battlegeese\/submissions) to view your score and episodes being played.","a6e22a99":"# Debug\/Train your Agent","f1ac0f32":"# Play your Agent\n\nUse the arrow keys to navigate the white goose.","0d069949":"# Test your Agent"}}