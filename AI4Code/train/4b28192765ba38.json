{"cell_type":{"edf40fee":"code","90b04a55":"code","69126cc0":"code","054b7edb":"code","19acdcb3":"code","a453fc2d":"code","61416ac4":"code","10848483":"code","bb741d65":"code","454501c7":"code","0249279b":"code","0b2db466":"code","e9b35c6c":"code","e7f97281":"code","c42db45e":"code","9911f2be":"code","82984e52":"code","140ebfc8":"code","5915eec2":"code","46548628":"code","26276f1a":"code","5e5180fc":"code","de98ec1f":"code","0e9da30f":"code","62e6feea":"code","b91a0f9e":"code","beae2a8f":"code","309b22f3":"code","3b7558fd":"code","4469fc1c":"code","e2776dfd":"markdown","9a53de8d":"markdown","a43749d5":"markdown","df7e98ad":"markdown","5b1ddcb4":"markdown","22c9d81f":"markdown","5be63eea":"markdown","59e1d483":"markdown","ef02619e":"markdown","994208c6":"markdown","342bdbef":"markdown","66a5edfc":"markdown","97c4d332":"markdown","bee522fd":"markdown","4fb85616":"markdown"},"source":{"edf40fee":"import numpy as np\nimport pandas as pd\n\nimport plotly.express as px\nimport plotly.graph_objects as go\nfrom plotly.subplots import make_subplots","90b04a55":"df=pd.read_csv('..\/input\/iris\/Iris.csv')\ndf.head()","69126cc0":"# Removing the 'Id' column as it is not important for clustering analysis\ndf=df.drop(['Id'], axis=1)","054b7edb":"# Checking for the datatypes\ndf.info()","19acdcb3":"# Checking for the null values\ndf.isnull().sum()","a453fc2d":"# Bar plot\nnum_col=df.select_dtypes('float').columns\npx.scatter_matrix(df, dimensions=num_col, color='Species', width=1000, height=700)","61416ac4":"fig=px.box(df,y=num_col, color='Species')\nfig.update_layout(title=dict(text='Distribution of 4 features among the 3 species', \n                             xanchor='center', yanchor='top', x=0.5), \n                 yaxis=dict(title='in cm'),\n                 xaxis=dict(title=''))\nfig.show()","10848483":"px.scatter_3d(df,x='SepalLengthCm', y='SepalWidthCm', z='PetalWidthCm', color='Species')","bb741d65":"# Creating the features data frame\nX=df[num_col]","454501c7":"from sklearn.cluster import KMeans\n\n# Finding the Eblow curve for determining the number of clusters\ninertia = []\nfor n in range(1 , 11):\n    algorithm = (KMeans(n_clusters=n ,init='k-means++', n_init=10 ,max_iter=300, \n                        tol=0.0001, random_state=99) )\n    algorithm.fit(X)\n    inertia.append(algorithm.inertia_)\n    \n# Plotting the Elbow curve    \nfig=go.Figure()\nfig.add_trace(go.Scatter(y=inertia, mode='lines+markers'))\nfig.update_layout(title=dict(text='Elbow Curve', \n                             xanchor='center', yanchor='top', x=0.5), \n                 yaxis=dict(title='Inertia'),\n                 xaxis=dict(title='Number of Clusters'),\n                 showlegend=False)\nfig.show()","0249279b":"# Creating Kmeans using 3 clusters\nkmeans=KMeans(n_clusters=3) \nkmeans.fit(X)","0b2db466":"# Assiging the class lables using Kmeans algorithm\ndf['Kmeans']=kmeans.predict(X)","e9b35c6c":"# Clustering results\ndf.groupby(['Species','Kmeans'])['SepalLengthCm'].count().unstack().fillna(0)","e7f97281":"px.scatter_3d(df,x='SepalLengthCm', y='SepalWidthCm', z='PetalWidthCm', color='Kmeans', title='K-Means')","c42db45e":"from sklearn.cluster import MeanShift\n\nmeanshift=MeanShift()","9911f2be":"df['mean_shift']=meanshift.fit_predict(X)","82984e52":"# Clustering results\ndf.groupby(['Species','mean_shift'])['SepalLengthCm'].count().unstack().fillna(0)","140ebfc8":"px.scatter_3d(df,x='SepalLengthCm', y='SepalWidthCm', z='PetalWidthCm', color='mean_shift', title='Mean Shift')","5915eec2":"from sklearn.cluster import DBSCAN\n\ndbscan=DBSCAN()","46548628":"df['dbscan']=dbscan.fit_predict(X)","26276f1a":"# Clustering results\ndf.groupby(['Species','dbscan'])['SepalLengthCm'].count().unstack().fillna(0)","5e5180fc":"px.scatter_3d(df,x='SepalLengthCm', y='SepalWidthCm', z='PetalWidthCm', color='dbscan', title='DBSCAN')","de98ec1f":"from sklearn.manifold import TSNE\n\n# I am reducing the 4 dimetions into two dimetions\ntsne=TSNE(n_components=2)","0e9da30f":"X_tsne=pd.DataFrame(tsne.fit_transform(X), columns=['Dimension 1', 'Dimension 2'])\ndf_tsne=pd.concat([X_tsne, df['Species']], axis=1)\ndf_tsne.head()","62e6feea":"fig=px.scatter(df_tsne,x='Dimension 1', y='Dimension 2', color='Species')\nfig.update_layout(title=dict(text='t-SNE reduced dimensions', \n                             xanchor='center', yanchor='top', x=0.5))\nfig.show()","b91a0f9e":"# Creating 3 cluster center as we have 3 species\nkmeans=KMeans(n_clusters=3)","beae2a8f":"X_tsne=df_tsne[['Dimension 1', 'Dimension 2']]\ndf_tsne['kmeans']=kmeans.fit_predict(X_tsne)","309b22f3":"# Clustering results\ndf_tsne.groupby(['Species','kmeans'])['Dimension 1'].count().unstack().fillna(0)","3b7558fd":"# Visualising the missclusterd points\ndf_tsne['missed']=1\ndict_tsne={'Iris-setosa':1,'Iris-versicolor':2,'Iris-virginica':0}\ndf_tsne['actual']=df_tsne['Species'].map(lambda x:dict_tsne[x])\n\n# Assigning 5 for miss clustered samples\ndf_tsne.loc[~(df_tsne['kmeans']==df_tsne['actual']), 'missed']=5","4469fc1c":"fig=px.scatter(df_tsne, x='Dimension 1', y='Dimension 2', color='kmeans', size='missed')\n\nfig.update_layout(title=dict(text='K-Means Clustering', \n                             xanchor='center', yanchor='top', x=0.5))\nfig.show()","e2776dfd":"#### Iris flower has 3 species - setosa, versicolor and virginica. The species differ from each other wrt the length and width of sepal and petal. The Iris dataset contains data of the seapal and petal dimentions and the type of species. Each species has 50 data samples.\n\n#### This is commonly used dataset for classification and sometimes clustering purpose. We will try to make clusters of the species using K-Mean, Mean Shift and DBSCAN algorithms. This notebook will be helpful especially for beginners, for understanding the clustering methods.","9a53de8d":"### Observations:\n#### Setosa can be easily clustered.\n#### There are many Verginica samples which are into the cluster of Vesicolor. So it is hard to form cluster of them.","a43749d5":"### Observations:\n#### Setosa has low petal width, petal length, sepal length.\n#### Virginica has high sepal length, petal width and petal length.\n#### In Setosa, sepal width is greater than petal length while others two it is reversed.","df7e98ad":"### Observations:\n#### -1 represents noise.\n#### Setosa has correctly clustered\n#### Same as Mean Shift clustering, Versicolor and Virginica are in one cluster","5b1ddcb4":"### Observations:\n#### Kmeans has clustured Setosa correctly\n#### 2 samples of Versicolor have placed in wrong cluster\n#### 14 samples of Virginica have placed in wrong cluster\n\n### Disadvantages:\n#### Number of clusters are to be specified\n#### Initial choise of cluster center affects the final results","22c9d81f":"# 1. K-mean clustering","5be63eea":"### If you like, please upvote!","59e1d483":"# K-Means on reduced dimentions","ef02619e":"# 3. DBSCAN \n### (Density Based Spacial Clustering of Application with Noise)","994208c6":"# t-SNE\n\n#### t-SNE (t-distributed stochastic neighbor embedding) is a statistical method for visualizing high-dimensional data by giving each datapoint a location in a two or three-dimensional map. It reduces the dimetions of the data and then we can use this reduced dimensions for clustering.","342bdbef":"# 2. Kmean Shift Clustering","66a5edfc":"![image](https:\/\/miro.medium.com\/max\/1000\/1*Hh53mOF4Xy4eORjLilKOwA.png)\n# Introduction","97c4d332":"#### After two clusters, the intertial is not decreasing much so, the number of clusters is 2. But as we know that there are 3 `Species`, we will consider 3 clusters.","bee522fd":"#### The big yellow dots, tells that, they actually belongs to blue group but they are assigned to yellow group and simillarly for big blue dot.\n\n#### I tried to give a basic idea about clustering, for more details you can follow the links:\nhttps:\/\/developers.google.com\/machine-learning\/clustering\/overview\n\nhttps:\/\/towardsdatascience.com\/the-5-clustering-algorithms-data-scientists-need-to-know-a36d136ef68\n\nhttps:\/\/www.analyticsvidhya.com\/blog\/2016\/11\/an-introduction-to-clustering-and-different-methods-of-clustering\/\n","4fb85616":"### Observations:\n#### It has clustured Setosa correctly\n#### It has clubed Versicolor and Virginica in same cluster, also wrongly placed 1 data sample in Sentosa"}}