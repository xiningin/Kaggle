{"cell_type":{"23ff1ea9":"code","924c939f":"code","01912f53":"code","75345839":"code","a2b15579":"code","2d8f0dac":"code","16f9359f":"code","85767277":"code","3c84d1be":"code","19dd6109":"code","f4da9f9e":"code","9d5adbe9":"code","34360699":"code","8538794d":"code","13d795c0":"code","6970c405":"code","3077d19a":"code","ad5e035f":"markdown","8090b824":"markdown","f2942108":"markdown","55ef7127":"markdown","c097e3e4":"markdown","9496536a":"markdown","967e9c7d":"markdown"},"source":{"23ff1ea9":"import numpy as np\nimport matplotlib.pyplot as plt\nimport pandas as pd\nimport seaborn as sns","924c939f":"data = pd.read_csv('..\/input\/mall-customers\/Mall_Customers.csv')\n\nprint(data.head())","01912f53":"data.describe()","75345839":"data.isna().sum()","a2b15579":"sns.pairplot(data[data.columns.drop('CustomerID')],hue='Genre')\nplt.show()","2d8f0dac":"sns.heatmap(data.corr(), annot=True)","16f9359f":"male_customers = data[data['Genre'] == 'Male']\nfemale_customers = data[data['Genre'] == 'Female']\nsns.heatmap(female_customers.corr(), annot=True);\nplt.title('Correlation Heatmap - Female');","85767277":"sns.heatmap(male_customers.corr(), annot=True);\nplt.title('Correlation Heatmap - Male');","3c84d1be":"data.drop(['Genre'], axis=1, inplace=True)\ndata.drop(['Age'], axis=1, inplace=True)\ndata.head()\nX = data.iloc[:, [1, 2]].values","19dd6109":"from sklearn.cluster import KMeans\nwcss = []\nfor i in range(1, 11):\n    kmeans = KMeans(n_clusters = i, init = 'k-means++', random_state = 0)\n    kmeans.fit(X)\n    wcss.append(kmeans.inertia_)\nplt.plot(range(1, 11), wcss)\nplt.title('The Elbow Method')\nplt.xlabel('Number of clusters')\nplt.ylabel('WCSS (Within Cluster Sum of Squares)')\nplt.show()","f4da9f9e":"kmeans = KMeans(n_clusters = 5, init = 'k-means++', random_state = 0)\npred = kmeans.fit_predict(X)","9d5adbe9":"from sklearn import metrics\nscore1 = metrics.silhouette_score(data, kmeans.labels_, metric='euclidean')\nprint(\"Score of KMeans = \", score1)","34360699":"# Visualising the clusters\nplt.figure(figsize=(15,10))\nplt.scatter(X[pred == 0, 0], X[pred == 0, 1], s = 100, c = 'red', label = 'Cluster 1')\nplt.scatter(X[pred == 1, 0], X[pred == 1, 1], s = 100, c = 'blue', label = 'Cluster 2')\nplt.scatter(X[pred == 2, 0], X[pred == 2, 1], s = 100, c = 'green', label = 'Cluster 3')\nplt.scatter(X[pred == 3, 0], X[pred == 3, 1], s = 100, c = 'cyan', label = 'Cluster 4')\nplt.scatter(X[pred == 4, 0], X[pred == 4, 1], s = 100, c = 'magenta', label = 'Cluster 5')\nplt.scatter(kmeans.cluster_centers_[:, 0], kmeans.cluster_centers_[:, 1], s = 200, c = 'black', label = 'Centroids')\nplt.title('Clusters of customers')\nplt.xlabel('Annual Income (k$)')\nplt.ylabel('Spending Score (1-100)')\nplt.legend()\nplt.show()","8538794d":"import scipy.cluster.hierarchy as sch\ndendrogram = sch.dendrogram(sch.linkage(X, method = 'ward'))\nplt.title('Dendrogram')\nplt.xlabel('Customers')\nplt.ylabel('Euclidean distances')\nplt.show()\n","13d795c0":"from sklearn.cluster import AgglomerativeClustering\nhc = AgglomerativeClustering(n_clusters = 5, affinity = 'euclidean', linkage = 'ward')\ny_hc = hc.fit_predict(X)\nlabels_agg = hc.labels_","6970c405":"score_agg = metrics.silhouette_score(data,labels_agg)\n\nprint(\"Score of Agglomerative =\", score_agg)","3077d19a":"plt.figure(figsize=(15,10))\nplt.scatter(X[y_hc == 0, 0], X[y_hc == 0, 1], s = 100, c = 'red', label = 'Cluster 1')\nplt.scatter(X[y_hc == 1, 0], X[y_hc == 1, 1], s = 100, c = 'blue', label = 'Cluster 2')\nplt.scatter(X[y_hc == 2, 0], X[y_hc == 2, 1], s = 100, c = 'green', label = 'Cluster 3')\nplt.scatter(X[y_hc == 3, 0], X[y_hc == 3, 1], s = 100, c = 'cyan', label = 'Cluster 4')\nplt.scatter(X[y_hc == 4, 0], X[y_hc == 4, 1], s = 100, c = 'magenta', label = 'Cluster 5')\nplt.title('Clusters of customers')\nplt.xlabel('Annual Income (k$)')\nplt.ylabel('Spending Score (1-100)')\nplt.legend()\nplt.show()","ad5e035f":"# Exploring Data","8090b824":"# Problem Description\nThe Mall customers dataset contains information about people visiting the\nmall. The dataset has gender, customer id, age, annual income, and spending\nscore. It collects insights from the data and group customers based on their\nbehaviors. Segment the customers based on the age, gender, interest.\nCustomer segmentation is an important practise of dividing customers base\ninto individual groups that are similar. It is useful in customised marketing.","f2942108":"# Input Dataset","55ef7127":"# Using Kmeans Clustering","c097e3e4":"> **Hence, We can state that  \" *the given customers data can be segmented to 5 different clusters (i.e. 5 individual groups of customers)* \" by obtained results using Kmeans Clustering and Hierarchical Clustering as shown above.**\n","9496536a":"In figure elbow checking no.of clusters(k) = 5 is good point.","967e9c7d":"# Using Hierarchical Clustering"}}