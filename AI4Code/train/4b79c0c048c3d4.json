{"cell_type":{"a6dcd09c":"code","d1fe1a87":"code","64936997":"code","e2efd8ba":"code","befb9be2":"code","ec2bf2cf":"code","779d43d7":"code","4cedb42c":"code","fc54e5d8":"code","646046c9":"code","e82ad4d2":"code","b0a36a22":"code","434a5d7d":"code","03b0d8d0":"code","b28d4b13":"code","984b8dc0":"code","c0da1895":"code","3f01b1e9":"code","9c2c718a":"code","3251d495":"code","d0a7cca7":"code","f16fbab1":"code","571bba20":"code","e515389b":"code","1112fd54":"code","0a4267eb":"code","40c882c8":"code","9e10bf20":"code","fef29f79":"code","9a560a45":"code","e68dbb0d":"code","72c7b4df":"code","df1d9879":"code","e5cbf7b1":"code","b2cf9d4a":"code","ce922117":"code","d1a666a9":"code","1dea0efa":"code","76245053":"code","784750bc":"code","d3a64883":"code","d9e27d30":"code","bd5cc31a":"code","3c2f3109":"code","30ba0722":"code","01bdb298":"code","61bb4742":"code","9b67ba42":"code","406c11bf":"code","414df023":"code","7a509353":"code","5eea9ba7":"code","2b3302c3":"code","a1daceeb":"code","54c37b6f":"code","34936477":"code","da3e2285":"code","f1c05236":"code","b9e2764b":"code","d0a98946":"code","347d004e":"code","1cdc0206":"code","679c1e1a":"code","399186b0":"code","45353598":"code","ea4dec4e":"code","667d568c":"code","399d00d2":"code","7c9a1cd8":"code","2b02a8bf":"code","c61e807a":"code","83695ed4":"code","a1be968c":"code","16da7486":"code","ab6d83ba":"code","5f6853d0":"code","45ad67cd":"code","60c8c968":"code","426683ca":"code","d4999d2d":"markdown","9f2582d0":"markdown"},"source":{"a6dcd09c":"import pandas as pd\nimport seaborn as sns\nimport missingno as msno\nimport matplotlib.pyplot as plt\nimport numpy as np\npd.set_option('display.max_columns', 200)\n","d1fe1a87":"#filepath_2015 = '\/home\/et\/Mytest\/my_py3\/02_Seattle\/input_data\/2015-building-energy-benchmarking.csv'\n#filepath_2016 = '\/home\/et\/Mytest\/my_py3\/02_Seattle\/input_data\/2016-building-energy-benchmarking.csv'\n\nfilepath_2015 = '\/Users\/efkanturedi\/Corteze\/my_py3\/02_Seattle\/input_data\/2015-building-energy-benchmarking.csv'\nfilepath_2016 = '\/Users\/efkanturedi\/Corteze\/my_py3\/02_Seattle\/input_data\/2016-building-energy-benchmarking.csv'\n\n#filepath_2015 = '\/home\/efkant\/Corteze\/my_py3\/02_Seattle\/input_data\/2015-building-energy-benchmarking.csv'\n#filepath_2016 = '\/home\/efkant\/Corteze\/my_py3\/02_Seattle\/input_data\/2016-building-energy-benchmarking.csv'\n","64936997":"data_2015 = pd.read_csv(filepath_2015)\ndata_2016 = pd.read_csv(filepath_2016)","e2efd8ba":"data_2015.head()","befb9be2":"data_2016.head()","ec2bf2cf":"data_2015.columns","779d43d7":"data_2016.columns","4cedb42c":"print(data_2015.shape)\nprint(data_2016.shape)","fc54e5d8":"col_2016 = list(data_2016.columns)\ncol_2015 = list(data_2015.columns)","646046c9":"list(set(col_2015) - set(col_2016))","e82ad4d2":"col_2016 = list(data_2016.columns)\ncol_2015 = list(data_2015.columns)\nlist(set(col_2016) - set(col_2015))","b0a36a22":"list(set(col_2015) - set(col_2016))","434a5d7d":"data_2015['TotalGHGEmissions'] = data_2015['GHGEmissions(MetricTonsCO2e)']\ndata_2015['GHGEmissionsIntensity'] = data_2015['GHGEmissionsIntensity(kgCO2e\/ft2)']\ndata_2015['Comments'] = data_2015['Comment']\ndata_2015['ZipCode'] = data_2015['Zip Codes']\ndata_2015['DefaultData'] = data_2015['DefaultData'].map({'Yes' : True, 'No' : False}).head()\n\ndata_2015.drop(['GHGEmissions(MetricTonsCO2e)', 'GHGEmissionsIntensity(kgCO2e\/ft2)','Comment','Zip Codes'], axis=1, inplace=True)","03b0d8d0":"col_2016 = list(data_2016.columns)\ncol_2015 = list(data_2015.columns)\ndrop_2016 = list(set(col_2016) - set(col_2015))","b28d4b13":"drop_2015 = list(set(col_2015) - set(col_2016))","984b8dc0":"pd.DataFrame([data_2015.dtypes, data_2016.dtypes])","c0da1895":"data_2015.drop(drop_2015, axis=1, inplace=True)\ndata_2016.drop(drop_2016, axis=1, inplace=True)","3f01b1e9":"col_2016 = list(data_2016.columns)\ncol_2015 = list(data_2015.columns)\nlist(set(col_2016) - set(col_2015))","9c2c718a":"data = pd.concat([data_2015, data_2016], axis=0, sort=False)","3251d495":"data","d0a7cca7":"data['Outlier'].isna().sum()","f16fbab1":"data.shape","571bba20":"data.isna().sum().sum()","e515389b":"data = data.reset_index(drop=True)","1112fd54":"data","0a4267eb":"data.drop(['Comments','ZipCode'], axis=1, inplace=True)","40c882c8":"data.min()","9e10bf20":"data['Neighborhood'].unique()","fef29f79":"correct_values = {'DOWNTOWN':'Downtown', 'SOUTHEAST':'Southeast', 'NORTHEAST':'Northeast', 'EAST':'East', 'CENTRAL':'Central', 'NORTH':'North',\n       'MAGNOLIA \/ QUEEN ANNE':'Magnolia \/ Queen Anne', 'LAKE UNION':'Lake Union', 'GREATER DUWAMISH':'Greater Duwamish',\n       'BALLARD':'Ballard', 'NORTHWEST':'Northwest', 'SOUTHWEST':'Southwest', 'DELRIDGE':'Delridge',\n       'DELRIDGE NEIGHBORHOODS':'Delridge'}","9a560a45":"data['Neighborhood'].replace(correct_values, inplace=True)\n","e68dbb0d":"data['Neighborhood'].unique()","72c7b4df":"data['NumberofBuildings'].unique()","df1d9879":"data['NumberofBuildings'].replace({np.nan:0}, inplace=True)","e5cbf7b1":"data['NumberofBuildings'].unique()","b2cf9d4a":"data['NumberofBuildings'].replace({0:1}, inplace=True)","ce922117":"data['NumberofBuildings'].unique()","d1a666a9":"my_list = ['PropertyGFAParking','PropertyGFABuilding(s)','SourceEUI(kBtu\/sf)','SourceEUIWN(kBtu\/sf)','Electricity(kWh)','Electricity(kBtu)','TotalGHGEmissions','GHGEmissionsIntensity']","1dea0efa":"for col in my_list:\n  data[col] = data[col].apply(lambda x : x if x >= 0 else 0)","76245053":"data.min()","784750bc":"data.isna().sum()","d3a64883":"data['PrimaryPropertyType'].unique()","d9e27d30":"data.select_dtypes(['object', 'category']).nunique().sort_values(ascending=False)","bd5cc31a":"data[['ThirdLargestPropertyUseType', 'SecondLargestPropertyUseType']] = data[['ThirdLargestPropertyUseType', 'SecondLargestPropertyUseType']].fillna('No Use')","3c2f3109":"data['LargestPropertyUseType'] = data['LargestPropertyUseType'].fillna('Unknown')\ndata['LargestPropertyUseTypeGFA'] = data['LargestPropertyUseTypeGFA'].fillna(np.mean(data['LargestPropertyUseTypeGFA']))\ndata[['ThirdLargestPropertyUseTypeGFA', 'SecondLargestPropertyUseTypeGFA']] = data[['ThirdLargestPropertyUseTypeGFA', 'SecondLargestPropertyUseTypeGFA']].fillna(np.mean(data[['ThirdLargestPropertyUseTypeGFA', 'SecondLargestPropertyUseTypeGFA']]))","30ba0722":"data.isna().sum().sort_values()","01bdb298":"fuel_data = ['SiteEnergyUse(kBtu)','SiteEUIWN(kBtu\/sf)','SiteEnergyUseWN(kBtu)','SiteEUI(kBtu\/sf)','NaturalGas(kBtu)','NaturalGas(therms)','SteamUse(kBtu)']\nfor item in fuel_data:\n  data[item] = data[item].fillna(np.mean(data[item]))","61bb4742":"data.isna().sum().sort_values()","9b67ba42":"data['NumberofFloors'] = data['NumberofFloors'].fillna(np.mean(data['NumberofFloors']))","406c11bf":"data.dropna(subset=['ENERGYSTARScore','TaxParcelIdentificationNumber'],inplace=True)","414df023":"data.isna().sum().sort_values()","7a509353":"outlier_labels = {\n  np.nan:'Not abnormal',\n  'High outlier':'High Outlier',\n  'Low outlier':'Low Outlier'\n}","5eea9ba7":"data['Outlier'].replace(outlier_labels, inplace=True)","2b3302c3":"data.shape","a1daceeb":"data = data[data['Outlier'] != 'High Outlier']","54c37b6f":"data.shape","34936477":"col_to_drop = ['ListOfAllPropertyUseTypes','DefaultData','YearsENERGYSTARCertified','Outlier']\ndata.drop(columns=col_to_drop,inplace=True)","da3e2285":"data.isna().sum().sum()","f1c05236":"data.shape","b9e2764b":"numeric_col = data.select_dtypes(include = ['int64','float64']).columns","d0a98946":"numeric_col","347d004e":"len(numeric_col)","1cdc0206":"useful_charts = [\n  'NumberofBuildings', 'NumberofFloors', 'PropertyGFATotal',\n  'PropertyGFAParking', 'PropertyGFABuilding(s)',\n  'LargestPropertyUseTypeGFA', 'SecondLargestPropertyUseTypeGFA',\n  'ThirdLargestPropertyUseTypeGFA', 'ENERGYSTARScore', 'SiteEUI(kBtu\/sf)',\n  'SiteEUIWN(kBtu\/sf)', 'SourceEUI(kBtu\/sf)', 'SourceEUIWN(kBtu\/sf)',\n  'SiteEnergyUse(kBtu)', 'SiteEnergyUseWN(kBtu)', 'SteamUse(kBtu)',\n  'Electricity(kWh)', 'Electricity(kBtu)', 'NaturalGas(therms)',\n  'NaturalGas(kBtu)', 'TotalGHGEmissions', 'GHGEmissionsIntensity'\n]\nlen(useful_charts)","679c1e1a":"n_rows = 8\nn_cols = 3\nf, axes = plt.subplots(n_rows, n_cols, figsize=(30, 30))\n\nax_list = []\nfor row_idx in range(n_rows):\n    for col_idx in range(n_cols):\n        ax_list.append(axes[row_idx,col_idx])\n\npointer = 0\nfor col in useful_charts:\n    sns.distplot(data[col], color=\"b\",ax=ax_list[pointer]);\n    mean_var = np.mean(data[col])\n    std_var = np.std(data[col])\n    ax_list[pointer].set_xlim((0,mean_var+5*std_var))\n    pointer+=1","399186b0":"fig, ax = plt.subplots(figsize=(15,10))\nsns.heatmap(data[useful_charts].corr(),linewidths=.0, cmap=\"YlGnBu\",ax=ax);","45353598":"data.columns","ea4dec4e":"full_features = ['BuildingType', 'PrimaryPropertyType',\n       'Neighborhood','NumberofBuildings', 'NumberofFloors',\n       'PropertyGFATotal', 'PropertyGFAParking', 'PropertyGFABuilding(s)',\n       'LargestPropertyUseType',\n       'LargestPropertyUseTypeGFA', 'SecondLargestPropertyUseType',\n       'SecondLargestPropertyUseTypeGFA', 'ThirdLargestPropertyUseType',\n       'ThirdLargestPropertyUseTypeGFA',\n       'ENERGYSTARScore','SiteEnergyUseWN(kBtu)','TotalGHGEmissions']\n\nfull_features_no_es = ['BuildingType', 'PrimaryPropertyType',\n       'Neighborhood','NumberofBuildings', 'NumberofFloors',\n       'PropertyGFATotal', 'PropertyGFAParking', 'PropertyGFABuilding(s)',\n       'LargestPropertyUseType',\n       'LargestPropertyUseTypeGFA', 'SecondLargestPropertyUseType',\n       'SecondLargestPropertyUseTypeGFA', 'ThirdLargestPropertyUseType',\n       'ThirdLargestPropertyUseTypeGFA',\n       'SiteEnergyUseWN(kBtu)','TotalGHGEmissions']\n\ntarget_features = ['SiteEnergyUseWN(kBtu)','TotalGHGEmissions']\n","667d568c":"full = data[full_features_no_es]\n\nX = full.drop(columns=['TotalGHGEmissions','SiteEnergyUseWN(kBtu)'])\nY = full[['TotalGHGEmissions','SiteEnergyUseWN(kBtu)']]\n\nX = X.reset_index(drop=True)\nY = Y.reset_index(drop=True)","399d00d2":"Y['log-SiteEnergyUseWN(kBtu)'] = np.log(1+Y['SiteEnergyUseWN(kBtu)'])\nY['log-TotalGHGEmissions'] = np.log(1+Y['TotalGHGEmissions'])","7c9a1cd8":"categorical_columns = X.select_dtypes(['category','object']).columns\nnumerical_columns = X.select_dtypes(['int64','float64']).columns","2b02a8bf":"X[numerical_columns].dtypes","c61e807a":"from sklearn.preprocessing import OneHotEncoder,StandardScaler\n\nss = StandardScaler()\nX[numerical_columns] = ss.fit_transform(X[numerical_columns])","83695ed4":"ohe = OneHotEncoder(sparse=False)\nohe.fit_transform(X[categorical_columns]);","a1be968c":"test_df = pd.DataFrame(columns = ohe.get_feature_names(),data = ohe.fit_transform(X[categorical_columns]))","16da7486":"test_df.reset_index(drop=True)","ab6d83ba":"X = pd.merge(X[numerical_columns],test_df,left_index=True,right_index=True)","5f6853d0":"print(X.shape)\nprint(Y.shape)","45ad67cd":"#X.to_csv('Xs.csv', index=False)\n#Y.to_csv('Ys.csv', index=False)\n\nX.to_csv('Xs_no_es.csv', index=False)\nY.to_csv('Ys_no_es.csv', index=False)","60c8c968":"Y.describe()","426683ca":"sns.distplot(Y['log-SiteEnergyUseWN(kBtu)']);\nsns.distplot(Y['log-TotalGHGEmissions']);","d4999d2d":"<h2> Projet Seattle","9f2582d0":"<h2> Separation des donn\u00e9es\n"}}