{"cell_type":{"d46f9b8c":"code","09dae5f1":"code","0c89695f":"code","581c957a":"code","18ccbfbb":"code","1a7485d1":"code","b9e7be03":"code","460d2621":"code","2647ba03":"code","8c5ba298":"code","006d9dff":"code","aa4343a3":"code","698f33f5":"code","4a8718f3":"code","218ef9e1":"code","1bad4b37":"code","2fba2c66":"code","152cc6b9":"code","333d07b5":"code","81bc4fef":"code","a324a7fa":"code","d92114ac":"code","0a37ac52":"code","776b0dff":"code","6ab4136b":"code","96feb0bb":"code","e2d0e4a2":"code","f0019e9e":"code","f021ceaf":"code","be3fc870":"code","40abf6a1":"code","359ff055":"code","a27a4180":"code","e7bf723f":"code","3807f6d7":"code","de8eb3f4":"code","09eadcd3":"code","0fb70857":"code","7aa703ad":"code","e4050209":"code","a561084a":"code","0709d771":"code","51f40ddc":"code","12975e71":"code","3ab08c6b":"code","f4952224":"code","8e6badc9":"markdown","6c35dae9":"markdown","bcb41019":"markdown","327a4b92":"markdown","401966ce":"markdown","a27cfc8d":"markdown","2d22f88d":"markdown","3dc076b8":"markdown"},"source":{"d46f9b8c":"import warnings\nwarnings.filterwarnings('ignore')\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib . pyplot as plt\nsns.set_style('darkgrid')\nflatui = [\"#9b59b6\", \"#3498db\", \"#95a5a6\", \"#e74c3c\", \"#34495e\", \"#2ecc71\"]\nsns.set_palette(flatui)\nimport cufflinks as cf\ncf.go_offline()","09dae5f1":"data = pd.read_csv(\"..\/input\/heart-disease-uci\/heart.csv\")","0c89695f":"data.head()","581c957a":"data.info()","18ccbfbb":"data.nunique()","1a7485d1":"data.dtypes.unique()","b9e7be03":"data.columns","460d2621":"data.index","2647ba03":"sum(data.isnull().sum())","8c5ba298":"data.describe()","006d9dff":"sns.pairplot(data[['age','thalach','trestbps','oldpeak','chol']])","aa4343a3":"plt.figure(figsize=(10,6))\nsns.heatmap(data.corr(),annot=True,cmap='viridis')","698f33f5":"sns.countplot(data['target'])","4a8718f3":"sns.countplot(data['fbs'])","218ef9e1":"sns.barplot(x='slope',y='age',data=data,hue='sex')","1bad4b37":"d = sns.FacetGrid(data=data,col='target',row='cp')\nd.map(sns.barplot,'slope','thalach')","2fba2c66":"sns.kdeplot(data['thalach'])","152cc6b9":"sns.kdeplot(data['trestbps'])","333d07b5":"sns.scatterplot(data['trestbps'],data['thalach'])","81bc4fef":"sns.scatterplot(data['trestbps'],data['age'])","a324a7fa":"sns.boxplot(data['trestbps'])","d92114ac":"sns.boxplot(data['chol'])","0a37ac52":"IQR = data.trestbps.quantile(0.75) - data.trestbps.quantile(0.25)\n\nLower_fence = data.trestbps.quantile(0.25) - (IQR * 1.5)\nUpper_fence = data.trestbps.quantile(0.75) + (IQR * 1.5)\n\nUpper_fence, Lower_fence, IQR","776b0dff":"data.query('trestbps >170 or trestbps < 90')","6ab4136b":"IQR = data.chol.quantile(0.75) - data.chol.quantile(0.25)\n\nLower_fence = data.chol.quantile(0.25) - (IQR * 1.5)\nUpper_fence = data.chol.quantile(0.75) + (IQR * 1.5)\n\nUpper_fence, Lower_fence, IQR","96feb0bb":"data.query('chol >369.75 or chol < 115.75')","e2d0e4a2":"sns.boxplot(x=data['cp'],y = data['thalach'])","f0019e9e":"sns.boxplot(x=data['ca'],y=data['age'])","f021ceaf":"from sklearn.model_selection import train_test_split","be3fc870":"X = data.drop('target',axis=1)\ny = data['target']","40abf6a1":"X_train, X_test, y_train, y_test = train_test_split( X.values, y.values, test_size=0.2, random_state=42)","359ff055":"from sklearn.model_selection import GridSearchCV\nfrom sklearn.linear_model import LogisticRegression","a27a4180":"param = {\"C\":np.logspace(-3,3,7),\"penalty\":[\"l1\",\"l2\"]}\nlogistic =LogisticRegression()","e7bf723f":"model = GridSearchCV(logistic,param,cv=10,refit=True,verbose=3)","3807f6d7":"model.fit(X_train,y_train)","de8eb3f4":"y_pred = model.predict(X_test)","09eadcd3":"from sklearn.metrics import classification_report,confusion_matrix","0fb70857":"print(classification_report(y_test,y_pred))","7aa703ad":"sns.heatmap(confusion_matrix(y_test,y_pred),annot=True,fmt='g')","e4050209":"def plot_learning_curve(estimator, title, X, y, ylim=None, cv=None,\n    n_jobs=None, train_sizes=np.linspace(.1, 1.0, 10)):\n    \"\"\"Plots the learning curve of a regression or classfication model using their defualt metrics accuracy or r2_score\"\"\"\n    plt.figure()\n    plt.title(title)\n    plt.xlabel(\"Training Accuracy\")\n    plt.ylabel(\"Score\")\n\n    train_sizes, train_scores, test_scores = learning_curve(\n    estimator, X, y, cv=cv, n_jobs=n_jobs, train_sizes=train_sizes)\n\n    train_scores_mean = np.mean(train_scores, axis=1)\n    train_scores_std = np.std(train_scores, axis=1)\n    test_scores_mean = np.mean(test_scores, axis=1)\n    test_scores_std = np.std(test_scores, axis=1)\n\n    plt.grid()\n    plt.fill_between(train_sizes, train_scores_mean - train_scores_std,\n    train_scores_mean + train_scores_std, alpha=0.1,\n    color=\"r\")\n    plt.fill_between(train_sizes, test_scores_mean - test_scores_std,\n    test_scores_mean + test_scores_std, alpha=0.1, color=\"g\")\n\n    plt.plot(train_sizes, train_scores_mean, 'o-', color=\"r\",\n    label=\"Training score\")\n    plt.plot(train_sizes, test_scores_mean, 'o-', color=\"g\",\n    label=\"Cross-validation score\")\n    plt.legend(loc=\"best\")\n    return plt","a561084a":"def Probability_fpr_tpr(estimator,X,y):\n    \"\"\"Returns the false postive rate and true postive rate\"\"\"\n    probab = estimator.predict_proba(X)[:,1]\n    [fpr,tpr,thr] = roc_curve(y, probab)\n    return fpr,tpr,thr\n\n\ndef Plot_Roc_Curve(train_fpr,train_tpr,thr1,test_fpr,test_tpr,thr2):\n    \"\"\"Used to plot Roc Curve For Training and Test Set to Check Overfitting in model\"\"\"\n    plt.figure(figsize=(11,6))\n    plt.plot(train_fpr, train_tpr, color = 'coral', label = \"Train ROC curve area: \"+str(auc(train_fpr, train_tpr)))\n    plt.plot(test_fpr, test_tpr, color = 'g', label = \"Test ROC curve area: \"+str(auc(test_fpr, test_tpr)))\n    plt.plot([0, 1], [0, 1], 'k--')\n    plt.xlim([0.0, 1.0])\n    plt.ylim([0.0, 1.05])\n    plt.xlabel('False Positive Rate (1 - specificity)', fontsize=12)\n    plt.ylabel('True Positive Rate (sensitivty)', fontsize=12)\n    plt.title('Receiver operating characteristic (ROC) curve')\n    plt.legend(loc=\"lower right\")\n    plt.show()\n    \n    idx = np.min(np.where(train_tpr>0.95))\n    print(\"Train-Set:\")\n    print(\"Using a threshold of %.3f \" % thr1[idx] + \"guarantees a sensitivity of %.3f \" % train_tpr[idx]+\n    \"and a specificity of %.3f\" % (1-train_fpr[idx]) +\n    \", i.e. a false positive rate of %.2f%%.\" % (np.array(train_fpr[idx])*100))\n    print(\"Test-Set:\")\n    idx = np.min(np.where(test_tpr>0.95))\n    print(\"Using a threshold of %.3f \" % thr2[idx] + \"guarantees a sensitivity of %.3f \" % test_tpr[idx]+\n    \"and a specificity of %.3f\" % (1-test_fpr[idx]) +\n    \", i.e. a false positive rate of %.2f%%.\" % (np.array(test_fpr[idx])*100))\n    \n    print(\"\\n\")\n    if abs(auc(train_fpr, train_tpr) - auc(test_fpr, test_tpr))*100 > 4.5:\n        print(\"........................................This model is overfitting........................................\")\n    elif abs(auc(train_fpr, train_tpr) - auc(test_fpr, test_tpr))*100 <= 4.5:\n        print(\"........................................this model is a good fit........................................\")\n    elif abs(auc(train_fpr, train_tpr) - auc(test_fpr, test_tpr))*100 < 0.1:\n        print(\"........................................this model is Underfitting........................................\")    \n    else:\n        print(\"unknown fit\")","0709d771":"from sklearn.metrics import roc_auc_score,roc_curve,auc\nfrom sklearn.model_selection import learning_curve,ShuffleSplit","51f40ddc":"X = data.drop('target',axis=1).values\ny = data['target'].values\ntitle = \"Learning Curve\"\ncv = ShuffleSplit(n_splits=100,test_size=0.2,random_state=42)","12975e71":"plot_learning_curve(model.best_estimator_,title,X,y,cv=cv)","3ab08c6b":"train_fpr,train_tpr,thr1 = Probability_fpr_tpr(model,X_train,y_train)\ntest_fpr,test_tpr,thr2 = Probability_fpr_tpr(model,X_test,y_test)","f4952224":"Plot_Roc_Curve(train_fpr,train_tpr,thr1,test_fpr,test_tpr,thr2)","8e6badc9":"## Evaluators","6c35dae9":"### Acuracy Learning Curve","bcb41019":"observations: when cp is 0 target is 1 and slop is 2 thalanch has no value same with cp 2 target 0 ,cp 3 and target 0 slope 2 thalanch has no value","327a4b92":"## Import DataSet","401966ce":"## Model Training","a27cfc8d":"observations: from the above chol is poorly correlated to the target variable, which might not be very useful to our prediction.","2d22f88d":"## EDA ","3dc076b8":"### Roc Curve"}}