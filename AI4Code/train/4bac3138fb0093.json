{"cell_type":{"f8450f45":"code","89a85494":"code","0c6266c8":"code","25e081a6":"code","2025e8be":"code","63edb06c":"code","57dee565":"code","0cfab7ae":"markdown","28575bcd":"markdown","4ac22d97":"markdown","c8c86bdc":"markdown","2c067006":"markdown","84d221b5":"markdown","54db81e5":"markdown"},"source":{"f8450f45":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom matplotlib.ticker import PercentFormatter\n\n\n#Fun\u00e7\u00e3o para criar os gr\u00e1ficos de barras\ndef graficoDeBarras(valores,titulo):\n    labels = [e for e in valores]\n    rois = [valores[e]*100 for e in valores]\n\n    index = np.arange(len(labels))\n\n    plt.figure(figsize=(12,6))\n    plt.bar(index, rois)\n    plt.ylabel('ROI')\n    plt.gca().yaxis.set_major_formatter(PercentFormatter())\n    plt.xticks(index, labels, fontsize=10, rotation=0)\n    plt.title(titulo)\n    \n    ajuste_labels=0.0248*min(rois) - 0.0272\n    for i in range(len(rois)): plt.text(i-0.1, rois[i]+ajuste_labels, \"{0:.2%}\".format(rois[i]\/100) ) \n    plt.show()\n\n\n\n#L\u00ea o arquivo CSV \ndf=pd.read_csv('..\/input\/ATP_matches_tennis-data.co.uk.csv',low_memory=False)\n\n\n#Remove as linhas que n\u00e3o possuam preenchidos os campos B365W, PSW e que o Piso \u00e9 Carpete\ndf= df[df.B365W.notnull() &  df.PSW.notnull() & (df.Surface!='Carpet') ]   \n\ndf2=pd.DataFrame(columns=['Hard','Clay','Grass','Indoor','odds1','odds2','J1_W', 'pl1', 'pl2'])\n\n\ndf2.Hard  = np.where(df.Surface=='Hard', 1, 0)\ndf2.Clay  = np.where(df.Surface=='Clay', 1, 0)\ndf2.Grass  = np.where(df.Surface=='Grass', 1, 0)\ndf2.Indoor = np.where(df.Court=='Indoor', 1, 0) \n\n#Odds Pinnacle para J1 e J2\ndf2.odds1 = np.where(df.PSW<df.PSL, df.PSW, df.PSL)\ndf2.odds2 = np.where(df.PSW>df.PSL, df.PSW, df.PSL) \n\n\n# 1 se J1 venceu, 0 se J2 venceu\ndf2.J1_W = np.where(df.PSW<df.PSL, 1, 0) \n\n#Lucro se tivessem apostado no J1 e no J2\ndf2.pl1=np.where(df2.J1_W==1, df2.odds1, 0)-1\ndf2.pl2=np.where(df2.J1_W==0, df2.odds2, 0)-1\n\ndf=df2\n\ndf\n","89a85494":"medias={\n    'Favorito': df.pl1.mean(),\n    'Underdog': df.pl2.mean()\n}\n\nprint(medias)\ngraficoDeBarras(medias,'ROI Se Apostar em Todos os Jogos')","0c6266c8":"medias={\n    'Hard': df[df.Hard==1].pl1.mean(),\n    'Clay': df[df.Clay==1].pl1.mean(),\n    'Grass':df[df.Grass==1].pl1.mean()\n}\n\nprint(medias)\ngraficoDeBarras(medias,'ROI do Favorito por Piso')","25e081a6":"medias={\n    'Indoor': df[df.Indoor==1].pl1.mean(),\n    'Outdoor':df[df.Indoor==0].pl1.mean()\n}\n\nprint(medias)\ngraficoDeBarras(medias,'ROI do Favorito Indoor e Outdoor')","2025e8be":"print('Indoor: ',\"{0:.1%}\".format(len(df[df.Indoor==1])\/len(df)) )\nprint('Outdoor:',\"{0:.1%}\".format(len(df[df.Indoor==0])\/len(df)) )","63edb06c":"medias={\n    'Geral': df.pl1.mean(),\n    'Outdoor e N\u00e3o Hard':df[(df.Indoor==0) &  (df.Hard==0)].pl1.mean()\n}\n\nprint(medias)\ngraficoDeBarras(medias,'ROI do Favorito Jogando Outdoor em piso que n\u00e3o seja Hard')","57dee565":"medias={}\nfor percent in [0,25,50,75]:\n    odds_percent_i, odds_percent_f = np.percentile(df.odds1,percent), np.percentile(df.odds1,percent+25)\n    medias[str( odds_percent_i)+' <--> '+ str( odds_percent_f)]=df[(df.odds1>=odds_percent_i) & (df.odds1<odds_percent_f)].pl1.mean()\n\nprint(medias)\ngraficoDeBarras(medias,'ROI do Favorito por Intervalo de Odds')","0cfab7ae":"\u00c9 um percentual pequeno de jogos Indoor, mas n\u00e3o \u00e9 irrelante. Vou procurar evitar os jogos ent\u00e3o.\n\nEsse se for um partida Outdoor em Piso que n\u00e3o seja Hard","28575bcd":"Nesse estudo vou analisar ROI se apostarmos em todos os jogos do Dataset com determinados crit\u00e9rios. \n\nVamos criar novo DataFrame com os campos Hard, Clay, Grass, Indoor, odds1, odds2, J1_W, pl1 e pl2 e uma fun\u00e7\u00e3o para criar os gr\u00e1ficos de barra.\n","4ac22d97":"Se ser\u00e1 que h\u00e1 diferen\u00e7a em jogs Indoor e Outdoor ?","c8c86bdc":"Agora vamos analisar a lucratividade por faixa de odds. Ser\u00e1 exibido o ROI do Favorito por quartil da odds.","2c067006":"Opa! Parece que os jogos Indoor s\u00e3o bem menos vantajosos que os poucos menos vantajosos que os Outdoor. Mas pode se que amostra se muito pequena e tenha pouca relav\u00e2ncia. Vou comprar a percentual de jogos Indoor e Outdout.","84d221b5":"Segue uma simula\u00e7\u00e3o do ROI m\u00e9dio se tivessemos apostados em todos os Favoritos e em todos Underdogs. De longe, a nossa desvantagem \u00e9 menor se nos concentrarmos em realizar nos favoritos na Pinnacle.\n\nVou criar uma s\u00e9rie de gr\u00e1ficos de Barras. Ent\u00e3o para facilitar vou criar uma fun\u00e7\u00e3o para criar os gr\u00e1ficos","54db81e5":"Vamos nos concentrar nos Favoritos e vamos ver o ROI por Piso"}}