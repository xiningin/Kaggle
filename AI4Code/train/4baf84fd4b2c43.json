{"cell_type":{"183e3c55":"code","2fb1ba8c":"code","826dab66":"code","89a42eb9":"code","6e4c2a34":"code","c9d0e50c":"code","103ed103":"code","2d0c42ab":"code","fac039bc":"code","e64c90f2":"code","c9d36b28":"code","8d09c90f":"code","de3a7c4c":"code","47a52a28":"code","4eaae9ef":"code","1a37eafd":"code","3bde69c3":"code","7bef32aa":"code","899565a0":"code","1629d17c":"code","7a8a5657":"code","04da789a":"code","239fc96f":"code","2b554412":"code","a278b26a":"code","40c48c71":"code","4327db97":"code","a49efb3d":"code","dedcfdcc":"code","ffda93d0":"code","507615a3":"code","f3535bc5":"code","76ea8868":"code","ed6277fc":"code","e4a7cb1e":"code","90a720a6":"code","d033d77f":"markdown","c08214db":"markdown","cda3e41e":"markdown","c053185c":"markdown","1b7948a4":"markdown","be3fc7ea":"markdown","6cc0e517":"markdown","8040e273":"markdown","3b6fca58":"markdown","fb6d1bda":"markdown"},"source":{"183e3c55":"dataset_url = 'https:\/\/www.kaggle.com\/fedesoriano\/stroke-prediction-dataset'","2fb1ba8c":"!pip install opendatasets\nimport opendatasets as od\nod.download(dataset_url)\n","826dab66":"import pandas as pd\nimport numpy as np\ndata = pd.read_csv('.\/stroke-prediction-dataset\/healthcare-dataset-stroke-data.csv')\ndata.head(10)","89a42eb9":"data.shape","6e4c2a34":"data.info()","c9d0e50c":"data.describe()","103ed103":"data.isnull().sum() # to check Null Value","2d0c42ab":"data['bmi'].fillna((data['bmi'].mean()),inplace=True)","fac039bc":"data.isnull().sum() # to check Null Value","e64c90f2":"data.corr()","c9d36b28":"import seaborn as sns\nimport matplotlib.pyplot as plt","8d09c90f":"## that is insane and beautiful\n\ncorr=data.corr()\nplt.figure(figsize=(15,10))\nsns.heatmap(corr,annot=True,annot_kws={\"size\":15})\nplt.title('heatgraph of correlation')","de3a7c4c":"import seaborn as sns\nimport matplotlib.pyplot as plt\nimport plotly.express as px","47a52a28":"plt.figure(dpi=100)\nsns.countplot(data['stroke'])\nplt.xlabel('had a stroke or not')\nplt.ylabel('number of people')\nplt.title('stroke V\/s number of people')\nplt.show()","4eaae9ef":"sns.catplot(y=\"work_type\", hue=\"stroke\", kind=\"count\",\n            palette=\"rainbow\", edgecolor=\".6\",\n            data=data)","1a37eafd":"sns.catplot(y=\"Residence_type\", hue=\"stroke\", kind=\"count\",\n            palette=\"rainbow\", edgecolor=\".6\",\n            data=data)","3bde69c3":"sns.catplot(y=\"ever_married\", hue=\"stroke\", kind=\"count\",\n            palette=\"rainbow\", edgecolor=\".6\",\n            data=data)","7bef32aa":"data.plot.hexbin(x='bmi', y='avg_glucose_level', gridsize=15,colormap='rainbow')","899565a0":"data.plot.hexbin(x='age', y='avg_glucose_level', gridsize=15,colormap='YlOrRd')","1629d17c":"plt.figure(dpi=100)\nfig = px.scatter_3d(data, x='avg_glucose_level', y='age', z='stroke')\nfig.show()","7a8a5657":"plt.figure(dpi=100)\nfig = px.parallel_categories(data[['gender', 'age', 'hypertension', 'heart_disease', 'ever_married',\n       'work_type', 'Residence_type',\n       'smoking_status', 'stroke']], color='stroke', color_continuous_scale=px.colors.sequential.Inferno)\nfig.show()","04da789a":"# number of people those had stroke\nY_stroke = data[\"stroke\"][data[\"stroke\"] == 1].count()\n# number of people those had not stroke\nN_stroke = data[\"stroke\"][data[\"stroke\"] == 0].count()\n# total number of people\ntotal_people = data[\"stroke\"].count()\n\nprint(\"Number of people those had stroke : {}   Number of people those had not stroke : {}   Total number of people : {}\".format(Y_stroke,N_stroke,total_people))","239fc96f":"p_yes=Y_stroke\/total_people\np_no=N_stroke\/total_people\nprint (\"Probability of had stroke =\",p_yes,\" and had not stroke =\",p_no)","2b554412":"data_means = data.groupby(\"stroke\").mean()\n# view the values\ndata_means","a278b26a":"data_variance = data.groupby(\"stroke\").var()\n# view the values\ndata_variance","40c48c71":"data_variance[[\"age\",\"hypertension\",\"heart_disease\",\"avg_glucose_level\",\"bmi\"]]","4327db97":"data_variance[[\"age\",\"hypertension\",\"heart_disease\",\"avg_glucose_level\",\"bmi\"]][data_variance.index == 0]","a49efb3d":"data_variance[[\"age\",\"hypertension\",\"heart_disease\",\"avg_glucose_level\",\"bmi\"]][data_variance.index == 0].values[0]","dedcfdcc":"people_had_not_stroke_age_mean = data_means[\"age\"][data_means.index == 0].values[0]\npeople_had_not_stroke_hypertension_mean = data_means[\"hypertension\"][data_means.index == 0].values[0]\npeople_had_not_stroke_heart_disease_mean = data_means[\"heart_disease\"][data_means.index == 0].values[0]\npeople_had_not_stroke_avg_glucose_level_mean = data_means[\"avg_glucose_level\"][data_means.index == 0].values[0]\npeople_had_not_stroke_bmi_mean = data_means[\"bmi\"][data_means.index == 0].values[0]\nprint(people_had_not_stroke_age_mean,people_had_not_stroke_hypertension_mean,people_had_not_stroke_heart_disease_mean,\n      people_had_not_stroke_avg_glucose_level_mean,people_had_not_stroke_bmi_mean)","ffda93d0":"people_had_stroke_age_mean = data_means[\"age\"][data_means.index == 1].values[0]\npeople_had_stroke_hypertension_mean = data_means[\"hypertension\"][data_means.index == 1].values[0]\npeople_had_stroke_heart_disease_mean = data_means[\"heart_disease\"][data_means.index == 1].values[0]\npeople_had_stroke_avg_glucose_level_mean = data_means[\"avg_glucose_level\"][data_means.index == 1].values[0]\npeople_had_stroke_bmi_mean = data_means[\"bmi\"][data_means.index == 1].values[0]\nprint(people_had_stroke_age_mean,people_had_stroke_hypertension_mean,people_had_stroke_heart_disease_mean,\n      people_had_stroke_avg_glucose_level_mean,people_had_stroke_bmi_mean)","507615a3":"people_had_not_stroke_age_var = data_variance[\"age\"][data_variance.index == 0].values[0]\npeople_had_not_stroke_hypertension_var = data_variance[\"hypertension\"][data_variance.index == 0].values[0]\npeople_had_not_stroke_heart_disease_var = data_variance[\"heart_disease\"][data_variance.index == 0].values[0]\npeople_had_not_stroke_avg_glucose_level_var = data_variance[\"avg_glucose_level\"][data_variance.index == 0].values[0]\npeople_had_not_stroke_bmi_var = data_variance[\"bmi\"][data_variance.index == 0].values[0]\nprint(people_had_not_stroke_age_var,people_had_not_stroke_hypertension_var,people_had_not_stroke_heart_disease_var,\n      people_had_not_stroke_avg_glucose_level_var,people_had_not_stroke_bmi_var)","f3535bc5":"people_had_stroke_age_var = data_variance[\"age\"][data_variance.index == 1].values[0]\npeople_had_stroke_hypertension_var = data_variance[\"hypertension\"][data_variance.index == 1].values[0]\npeople_had_stroke_heart_disease_var = data_variance[\"heart_disease\"][data_variance.index == 1].values[0]\npeople_had_stroke_avg_glucose_level_var = data_variance[\"avg_glucose_level\"][data_variance.index == 1].values[0]\npeople_had_stroke_bmi_var = data_variance[\"bmi\"][data_variance.index == 1].values[0]\nprint(people_had_stroke_age_var,people_had_stroke_hypertension_var,people_had_stroke_heart_disease_var,\n      people_had_stroke_avg_glucose_level_var,people_had_stroke_bmi_var)","76ea8868":"# create a function that calculates p(x | y):\ndef p_x_given_y(x,mean_y,variance_y):\n    # input the argiments into a probability density function\n    p = 1 \/ (np.sqrt(2 * np.pi * variance_y)) * \\\n                    np.exp((- (x - mean_y) ** 2) \/ (2 * variance_y))\n    return p","ed6277fc":"pr_stroke=pd.DataFrame()\npr_stroke[\"age\"]=[int(input('Enter age : '))]\npr_stroke[\"hypertension\"]=[int(input('Enter hypertension (0 or 1): '))]\npr_stroke[\"heart_disease\"]=[int(input('Enter heart_disease (0 or 1) : '))]\npr_stroke[\"avg_glucose_level\"]=[float(input('Enter avg_glucose_level : '))]\npr_stroke[\"bmi\"]=[float(input('Enter bmi : '))]\npr_stroke","e4a7cb1e":"posterior_numerator_had_not_stroke = N_stroke * \\\np_x_given_y(pr_stroke[\"age\"],people_had_not_stroke_age_mean,people_had_not_stroke_age_var) * \\\np_x_given_y(pr_stroke[\"hypertension\"],people_had_not_stroke_hypertension_mean,people_had_not_stroke_hypertension_var) * \\\np_x_given_y(pr_stroke[\"heart_disease\"],people_had_not_stroke_heart_disease_mean,people_had_not_stroke_heart_disease_var) * \\\np_x_given_y(pr_stroke[\"avg_glucose_level\"],people_had_not_stroke_avg_glucose_level_mean,people_had_not_stroke_avg_glucose_level_var) * \\\np_x_given_y(pr_stroke[\"bmi\"],people_had_not_stroke_bmi_mean,people_had_not_stroke_bmi_var)\nposterior_numerator_had_stroke = Y_stroke * \\\np_x_given_y(pr_stroke[\"age\"],people_had_stroke_age_mean,people_had_stroke_age_var) * \\\np_x_given_y(pr_stroke[\"hypertension\"],people_had_stroke_hypertension_mean,people_had_stroke_hypertension_var) * \\\np_x_given_y(pr_stroke[\"heart_disease\"],people_had_stroke_heart_disease_mean,people_had_stroke_heart_disease_var) * \\\np_x_given_y(pr_stroke[\"avg_glucose_level\"],people_had_stroke_avg_glucose_level_mean,people_had_stroke_avg_glucose_level_var) * \\\np_x_given_y(pr_stroke[\"bmi\"],people_had_stroke_bmi_mean,people_had_stroke_bmi_var)","90a720a6":"print (\"Numerator of Posterior for 'had stroke' is\\n\",posterior_numerator_had_stroke.values[0])\nprint (\"Numerator of Posterior for 'had not stroke' is\\n\",posterior_numerator_had_not_stroke.values[0])\nif (posterior_numerator_had_stroke.values[0] >= posterior_numerator_had_stroke.values[0]):\n    print (\"Prediction of stroke is +ve...\")\nelse:\n    print (\"Prediction of stroke is -ve...\")","d033d77f":"## **Prediction Part**\n### **Native Bayes**","c08214db":"## **Data Preparation and Cleaning**","cda3e41e":"Now we find the correlation using .corr()","c053185c":"### **Attribute Information**\n\n- id: unique identifier\n- gender: \"Male\", \"Female\" or \"Other\"\n- age: age of the patient\n- hypertension: 0 if the patient doesn't have hypertension, 1 if the patient has hypertension\n- heart_disease: 0 if the patient doesn't have any heart diseases, 1 if the patient has a heart disease\n- ever_married: \"No\" or \"Yes\"\n- work_type: \"children\", \"Govt_jov\", \"Never_worked\", \"Private\" or \"Self-employed\"\n- Residence_type: \"Rural\" or \"Urban\"\n- avg_glucose_level: average glucose level in blood\n- bmi: body mass index\n- smoking_status: \"formerly smoked\", \"never smoked\", \"smokes\" or \"Unknown\"*\n- stroke: 1 if the patient had a stroke or 0 if not\n\n*Note: \"Unknown\" in smoking_status means that the information is unavailable for this patient*","1b7948a4":"for visualization we use Heatmap(recommended)","be3fc7ea":"### Context\n\nAccording to the World Health Organization (WHO) stroke is the 2nd leading cause of death globally, responsible for approximately 11% of total deaths. This dataset is used to predict whether a patient is likely to get stroke based on the input parameters like gender, age, various diseases, and smoking status. Each row in the data provides relavant information about the patient.","6cc0e517":"## **Analysis and Visualization**\n\nhere, We find out meaningful graph and make a Inference\n\nFor visualization we import matplotlib and seaborn","8040e273":"### **Read Dataset by using Pandas**","3b6fca58":"## **Stroke Prediction**","fb6d1bda":"### **Downloading the Dataset**"}}