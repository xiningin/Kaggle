{"cell_type":{"f276e5fc":"code","5af137f5":"code","35d0c545":"code","98e75967":"code","824023be":"code","2492e722":"code","de11205c":"code","32fa3820":"code","a13f6815":"code","e42d9d3b":"code","56bf0ccb":"code","18e57919":"code","0c03bd6e":"code","51028422":"code","5bc8f1cf":"code","32640563":"code","0a37db14":"code","e2e3b17c":"code","35f1c490":"code","e9547909":"code","1b2d637b":"code","9a5f25cb":"code","52431951":"code","0e18c30f":"code","66595377":"code","8916391f":"code","0029c7be":"code","626cd2ed":"code","f3f781e7":"code","57da2ae2":"code","52165ce8":"code","c41b2b43":"code","d3786c3a":"code","97890dee":"code","26e5a3ca":"code","bb748a5a":"code","dcbb8d7b":"code","275550c2":"code","0e49d311":"code","27fd9426":"code","90773a46":"markdown","e3f50e17":"markdown","d138d4cb":"markdown","dfea5243":"markdown","a6d54edf":"markdown","e87640c2":"markdown","2fa20367":"markdown","6723f3dc":"markdown","3230f47a":"markdown","3219b976":"markdown","b5be27fe":"markdown","7cf7d696":"markdown","87c3dabd":"markdown","42dff638":"markdown"},"source":{"f276e5fc":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns","5af137f5":"filepath = \"..\/input\/crab-age-prediction\/CrabAgePrediction.csv\"","35d0c545":"crab_df = pd.read_csv(filepath)\ncrab_df","98e75967":"crab_df.info()","824023be":"crab_df.describe()","2492e722":"sns.relplot(x = \"Length\", y = \"Age\", data = crab_df)","de11205c":"sns.relplot(x = \"Diameter\", y = \"Age\", data = crab_df)","32fa3820":"sns.relplot(x = \"Height\", y = \"Age\", data = crab_df)","a13f6815":"sns.relplot(x = \"Weight\", y = \"Age\", data = crab_df)","e42d9d3b":"sns.relplot(x = \"Shucked Weight\", y = \"Age\", data = crab_df)","56bf0ccb":"sns.relplot(x = \"Viscera Weight\", y = \"Age\", data = crab_df)","18e57919":"sns.relplot(x = \"Shell Weight\", y = \"Age\", data = crab_df)","0c03bd6e":"sns.countplot(x = \"Sex\", data = crab_df)","51028422":"sns.histplot(data = crab_df, x = \"Age\")","5bc8f1cf":"plt.hist(crab_df[\"Age\"]);\nplt.axvline(crab_df[\"Age\"].mean(), color='k', linestyle='dashed', linewidth=2)\nplt.xlabel(\"Age of crabs\")\nplt.ylabel(\"Count of each Age\")\n\nplt.show()","32640563":"plt.figure(figsize = (25,10))\nsns.heatmap(crab_df.corr(), annot = True)","0a37db14":"sns.set_style(\"darkgrid\")\nsns.boxplot(x = \"Weight\", data = crab_df)","e2e3b17c":"sns.set_style(\"darkgrid\")\nsns.boxplot(x = \"Height\", data = crab_df)","35f1c490":"crab_df.columns","e9547909":"from sklearn.preprocessing import LabelEncoder\nle = LabelEncoder()\ncrab_df['Gender'] = le.fit_transform(crab_df['Sex'])","1b2d637b":"crab_df.info()","9a5f25cb":"from sklearn.preprocessing import OneHotEncoder\nonehot = OneHotEncoder()\ncrab_sex_df = pd.DataFrame(onehot.fit_transform(crab_df[['Sex']]).toarray())\ncrab_df = crab_df.join(crab_sex_df)","52431951":"crab_df","0e18c30f":"#Renaming columns \n#df.rename(columns={'oldName1': 'newName1', 'oldName2': 'newName2'}, inplace=True)\ncrab_df.rename(columns = {0: \"Female\", 1: \"Intermediate\", 2 : \"Male\"}, inplace = True)","66595377":"crab_df","8916391f":"crab_df.drop(columns = [\"Sex\", \"Gender\"], inplace = True)","0029c7be":"crab_df.columns","626cd2ed":"X = crab_df[['Length', 'Diameter', 'Height', 'Weight', 'Shucked Weight',\n       'Viscera Weight', 'Shell Weight', 'Female', 'Intermediate',\n       'Male']]\n\ny = crab_df[\"Age\"]","f3f781e7":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.2, random_state = 101)","57da2ae2":"X_train.shape","52165ce8":"X_test.shape","c41b2b43":"y_train.shape","d3786c3a":"y_test.shape","97890dee":"from sklearn.linear_model import LinearRegression\nlm = LinearRegression()\nlm.fit(X_train, y_train)","26e5a3ca":"lm.intercept_","bb748a5a":"coeff_df = pd.DataFrame(lm.coef_,X.columns,columns = ['Coefficient'])\ncoeff_df","dcbb8d7b":"predictions = lm.predict(X_test)","275550c2":"from sklearn import metrics\nprint(\"MEA\", metrics.mean_absolute_error(y_test, predictions))","0e49d311":"print(\"MSE\", metrics.mean_squared_error(y_test, predictions))","27fd9426":"print(\"RMSE\", np.sqrt(metrics.mean_squared_error(y_test, predictions)))","90773a46":"# Training model","e3f50e17":"# About data\nWe have our dataset publicly available on [Kaggle](https:\/\/www.kaggle.com\/sidhus\/crab-age-prediction). The dataset has following columns - \n\n- Sex : Gender of crab (Male and Female)\n- Length : Lenght of crab in \n- Diameter : Diameter of crab in \n- Height : Height of crab in \n- Weight : Weight of crab in \n- Shucked Weight : Weight of crab without shell\n- Viscera Weight : is weight that wraps around your abdominal organs deep inside body\n- Shell Weight : Weight of shell\n- Age : Age of crab in months\n\n","d138d4cb":"Let us encode Sex column into 0 and 1 for male and female ","dfea5243":"Listing out of all columns ","a6d54edf":"# Overview \nCrab farming is a major aquaculture activity as there is a huge consumption demand of crabs in India. Commercial crab farming is a growing business in coastal areas of India and is looking profitable.\nMud crab is highly popular due to its great demand in the export market. The commercial scale mud crab culture is developing fast along the coastal areas of Andhra Pradesh, Tamil Nadu, Kerala and Karnataka.\n\n# About Mud Crabs \n## Larger species :\nThe larger species is locally known as `green mud crab'. It grows to a maximum size of 22 cm carapace width and 2 kg in weight.\n\n## Smaller species :\nThe smaller species is known as `red claw'. This grows to a maximum size of 12.7 cm carapace width and 1.2 kg in weight.\n\nFor more about Mud crab farming, please visit [this link](https:\/\/vikaspedia.in\/agriculture\/fisheries\/brackish-water-fisheries\/culture-fisheries\/mud-crab-culture#:~:text=Mud%20crab%20farming%20is%20done,based%2C%20with%20or%20without%20mangroves.)\nTo understand more on Mud crab, visit [this link](https:\/\/www.fish.wa.gov.au\/Documents\/recreational_fishing\/fact_sheets\/fact_sheet_mud_crab.pdf)\n \n\n# Business Problem\nFor a commercial crab farmer knowing the right age of the crab helps them decide if and when to harvest the crabs. Beyond a certain age, there is negligible growth in crab's physical characteristics and hence, it is important to time the harvesting to reduce cost and increase profit.","e87640c2":"# Making predictions using test data","2fa20367":"# Importing required libraries and downloading dataset","6723f3dc":"#Drop columns of no interest ","3230f47a":"# Model Evaluation","3219b976":"# Preparing data for training","b5be27fe":"Since there are 3 genders, let us do one hot encoding","7cf7d696":"# Exploratory data analysis\nLet us perform the basic exploration on the dataset and figure out relationships between various columns \/ features with Age","87c3dabd":"# Model metrics","42dff638":"# Splitting data "}}