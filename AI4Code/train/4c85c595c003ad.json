{"cell_type":{"bf7e61bc":"code","cdcec806":"code","58937399":"code","1330431e":"code","6aa9c88c":"code","b02d78ac":"code","52fa089f":"code","6f7effd3":"code","9d2a6631":"code","b251c22d":"code","d2f5a501":"code","3fcabda1":"code","7aa61b5e":"code","991e62e5":"code","f41339a3":"code","0de9d85c":"code","381876ad":"code","952b28f0":"code","310bf06b":"code","279d1204":"code","e5272cdd":"code","c9abb303":"code","6bd90ed4":"code","b96cc716":"code","0dabea11":"code","c62ee9fb":"code","78dba10c":"code","f143371b":"code","830cf40f":"code","5c1077d1":"code","c5216948":"code","deab4815":"code","abcb03ba":"markdown"},"source":{"bf7e61bc":"\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns \nimport os\nfrom keras.utils.np_utils import to_categorical\nfrom sklearn.model_selection import train_test_split\nfrom keras.layers import Dense, Conv2D, MaxPooling2D, Flatten\nfrom tensorflow.keras.callbacks import EarlyStopping\nfrom tensorflow.keras.preprocessing.image import ImageDataGenerator\nfrom keras.models import Sequential,Model\nimport tensorflow.keras as keras\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n","cdcec806":"train=pd.read_csv('..\/input\/Kannada-MNIST\/train.csv')\ntest=pd.read_csv('..\/input\/Kannada-MNIST\/test.csv')","58937399":"train.shape","1330431e":"test.shape","6aa9c88c":"test","b02d78ac":"import matplotlib.pyplot as plt","52fa089f":"test=test.drop('id',axis=1)\n\n","6f7effd3":"test","9d2a6631":"y=train.label.value_counts()\nsns.barplot(y.index,y)","b251c22d":"X_train=train.drop('label',axis=1)","d2f5a501":"y_train=train['label']","3fcabda1":"X_train=X_train\/255\ntest=test\/255","7aa61b5e":"X_train=X_train.values.reshape(-1,28,28,1)\ntest=test.values.reshape(-1,28,28,1)","991e62e5":"print(X_train.shape)\nprint(test.shape)","f41339a3":"y_train=to_categorical(y_train)","0de9d85c":"y_train","381876ad":"X_train,","952b28f0":"X_train,X_test,y_train,y_test=train_test_split(X_train,y_train,\nrandom_state=42,test_size=0.3)\n","310bf06b":"plt.imshow(X_train[0][:,:,0])","279d1204":"datagen=ImageDataGenerator(\n    width_shift_range=0.4,\n    height_shift_range=0.4,\n    rotation_range=30\n)","e5272cdd":"model=Sequential()\n\nmodel.add(Conv2D(16, kernel_size=(5, 5), activation='relu',\n                 kernel_initializer='he_normal', input_shape=(28, 28, 1)))  # 28x28x1 -> 24x24x16\nmodel.add(MaxPooling2D(pool_size=(2, 2)))  # 24x24x16 -> 12x12x16\nmodel.add(Conv2D(64, kernel_size=(5, 5), activation='relu',\n                 kernel_initializer='he_normal'))  # 12x12x16 -> 8x8x64\nmodel.add(MaxPooling2D(pool_size=(2, 2)))  # 8x8x64 -> 4x4x64\n\nmodel.add(Flatten())  # 4x4x64-> 1024\nmodel.add(Dense(10, activation='softmax'))  # 1024 -> 10\n\nmodel.compile(\n    loss=keras.losses.categorical_crossentropy,\n    optimizer='adam',\n    metrics=['accuracy']\n)","c9abb303":"early_stopping=EarlyStopping(patience=5,verbose=1)\n","6bd90ed4":"model.fit(X_train,y_train,batch_size=1000,verbose=2,epochs=10,validation_data=(X_test,y_test),callbacks=[early_stopping])\n","b96cc716":"y_pre=model.predict(test)","0dabea11":"y_pre=np.argmax(y_pre,axis=1)","c62ee9fb":"y_pre","78dba10c":"sample_sub=pd.read_csv('..\/input\/Kannada-MNIST\/sample_submission.csv')","f143371b":"sample_sub","830cf40f":"sample_sub['label']=y_pre","5c1077d1":"sample_sub","c5216948":"sample_sub.to_csv('submission.csv',index=False)","deab4815":"pd.read_csv('submission.csv')","abcb03ba":"\u30b9\u30b1\u30fc\u30ea\u30f3\u30b0"}}