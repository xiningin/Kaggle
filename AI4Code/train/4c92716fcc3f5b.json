{"cell_type":{"d5a82a1f":"code","6d3ff186":"code","387e4b57":"code","c8252a24":"code","6cb52b67":"code","908e878b":"code","f6eb3ae8":"markdown","dd21d80a":"markdown"},"source":{"d5a82a1f":"import numpy as np\nimport pandas as pd\nimport os\nimport cv2\nfrom matplotlib import pyplot as plt\n%matplotlib inline\nfrom PIL import Image","6d3ff186":"#\u5404\u7a2e\u30d1\u30b9\u8a2d\u5b9a\nBASEPATH = \"..\/input\/siim-isic-melanoma-classification\"\nJPEGPATH = \"jpeg\/train\/\"\ndf_train = pd.read_csv(os.path.join(BASEPATH, 'train.csv'))\ndf_test  = pd.read_csv(os.path.join(BASEPATH, 'test.csv'))\ndf_sub   = pd.read_csv(os.path.join(BASEPATH, 'sample_submission.csv'))","387e4b57":"def cut_hokuro(img):\n    kernel = np.ones((15,15),np.uint8)\n\n    # \u30af\u30ed\u30fc\u30b8\u30f3\u30b0(\u7a74\u57cb\u3081)\n    closing = cv2.morphologyEx(img,cv2.MORPH_CLOSE,kernel, iterations = 2)\n    #15\u00d715\u7bb1\u30d5\u30a3\u30eb\u30bf\u306b\u3088\u308b\u5e73\u5747\n    blur = cv2.blur(closing,(15,15))\n\n    # \u30b0\u30ec\u30b9\u30b1\u5316\n    gray = cv2.cvtColor(blur,cv2.COLOR_BGR2GRAY)\n    # \u4e8c\u5024\u5316\n    _, thresh = cv2.threshold(gray,0,255,cv2.THRESH_BINARY_INV+cv2.THRESH_OTSU)\n\n\n    # \u307b\u304f\u308d\u306e\u8f2a\u90ed\u60c5\u5831\u53d6\u5f97\n    contours, hierarchy =  cv2.findContours(thresh,cv2.RETR_TREE,cv2.CHAIN_APPROX_NONE)\n    cnt = max(contours, key=cv2.contourArea)\n\n    # \u5e45\u3068\u9ad8\u3055\u53d6\u5f97\n    h, w = img.shape[:2]\n    mask = np.zeros((h, w), np.uint8)\n\n    # \u8f2a\u90ed\u306e\u63cf\u753b\n    cv2.drawContours(mask, [cnt],-1, 255, -1)\n    res = cv2.bitwise_and(img, img, mask=mask)\n    \n    # \u5bfe\u8c61\u3092\u6955\u5186\u3067\u56f2\u3093\u3060\u6642\u306e\u4e2d\u5fc3\u70b9,\u9577\u8ef8\u77ed\u8ef8,\u50be\u304d\u3092\u53d6\u5f97\n    _,_,angle = cv2.fitEllipse(cnt)\n    scale=1\n    angle=angle+90\n    \n    return res,angle","c8252a24":"base = []\nconvert = []\nrotate = []\nfor i in range(0,50):\n    img = cv2.imread(os.path.join(os.path.join(BASEPATH,JPEGPATH),df_train[\"image_name\"][i]+\".jpg\"))\n    img = cv2.resize(img,(256,256)) \n    base.append(img)\n    #\u4e2d\u5fc3\u90e8\u5206\u3092\u629c\u304d\u51fa\u3057\u3066\u8f2a\u90ed&\u89d2\u5ea6\u53d6\u5f97\n    cut_image,angle = cut_hokuro(img[64:192,64:192])\n    #cut_image,angle = cut_hokuro(img[74:182,74:182])\n    #cut_image,angle = cut_hokuro(img)\n    convert.append(cut_image)\n    rotate.append(angle)","6cb52b67":"i=1\nfig = plt.figure(figsize=(10,10))\nfor base_image,hokuro_image in zip(base,convert):\n    plt.subplot(10,10,i)\n    base_image = cv2.cvtColor(base_image,cv2.COLOR_BGR2RGB)\n    plt.imshow(base_image)\n    plt.axis(\"off\")\n    plt.subplot(10,10,i+1)\n    hokuro_image = cv2.cvtColor(hokuro_image,cv2.COLOR_BGR2RGB)\n    plt.imshow(hokuro_image)\n    i+=2\n    plt.axis(\"off\")","908e878b":"i=1\nfig = plt.figure(figsize=(10,10))\n\n#\u753b\u50cf\u306e\u5e45\u3068\u9ad8\u3055\nwidth = 256\nheight = 256\n\n#\u753b\u50cf\u306e\u4e2d\u5fc3\ncenter = (128,128)\n#\u30b9\u30b1\u30fc\u30eb\nscale = 1\n\nfor base_image,angle in zip(base,rotate):\n    base_image = cv2.cvtColor(base_image,cv2.COLOR_BGR2RGB)\n    trans = cv2.getRotationMatrix2D(center,angle,scale)\n    rotate_image = cv2.warpAffine(base_image,trans,(width,height))\n    \n    plt.subplot(10,10,i)\n    plt.imshow(base_image)\n    plt.axis(\"off\")\n    plt.subplot(10,10,i+1)\n    plt.imshow(rotate_image)\n    i+=2\n    plt.axis(\"off\")","f6eb3ae8":"\u53c2\u8003(\u4f53\u6bdb\u9664\u53bb\u306f\u3067\u304d\u306a\u304b\u3063\u305f\u306e\u3067\u8f2a\u90ed\u62bd\u51fa\u306e\u307f)\\\nhttps:\/\/ja.coder.work\/so\/python\/905564","dd21d80a":"\u9577\u8ef8\u4f4d\u7f6e\u5408\u308f\u305b\u306b\u3064\u3044\u3066\\\nhttps:\/\/www.jstage.jst.go.jp\/article\/fss\/31\/0\/31_379\/_pdf\/-char\/ja\\\n\n\"*\u305f\u3060\u56de\u8ee2\u51e6\u7406\u306b\u3088\u3063\u3066\u30b5\u30f3\n\u30d7\u30eb\u6570\u306e\u62e1\u5f35\u3092\u884c\u3046\u3088\u308a\u3082\uff0c\u30e1\u30e9\u30ce\u30fc\u30de\u306e\u5f62\u72b6\u7279\u5fb4\u3092\u3088\n\u308a\u9855\u8457\u306b\u53cd\u6620\u3059\u308b\u816b\u760d\u9818\u57df\u306e\u9577\u8ef8\u306e\u4f4d\u7f6e\u5408\u308f\u305b\u51e6\u7406\u3092\u884c\n\u3046\u307b\u3046\u304c\uff0cDCNN \u3092\u7528\u3044\u305f\u30e1\u30e9\u30ce\u30fc\u30de\u306e\u8b58\u5225\u306b\u304a\u3044\u3066\n\u306f\u6709\u52b9\u3067\u3042\u308b\u3068\u8003\u3048\u3089\u308c\u308b\uff0e*\n\""}}