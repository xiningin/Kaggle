{"cell_type":{"b1574275":"code","8bc8f323":"code","d0972799":"code","429939d3":"code","fbe39f3e":"code","645eafbf":"code","396965f4":"code","005528a7":"code","66b46c88":"code","71b95d45":"code","9675f57d":"code","5c732866":"code","ed96ea5e":"code","f2beccdc":"code","ec8abf6c":"code","6ae2ce74":"code","12ae4a3a":"code","51c9a1ae":"code","3756f77b":"code","d8c3dc66":"code","b0546738":"code","b2d85003":"code","17a39aea":"code","c73a019e":"code","3affb4c3":"code","b70ff756":"code","416951b3":"code","007c68c8":"code","c2007d4a":"markdown"},"source":{"b1574275":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","8bc8f323":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns","d0972799":"import os\nprint(os.listdir(\"..\/input\"))","429939d3":"insurance_data = pd.read_csv('..\/input\/insurance.csv')","fbe39f3e":"insurance_data.info()","645eafbf":"insurance_data.head()\n","396965f4":"insurance_data[\"sex\"].value_counts()","005528a7":"insurance_data[\"sex\"] = insurance_data.sex.replace({'male':1,'female':2})","66b46c88":"insurance_data[\"smoker\"] = insurance_data.smoker.replace({'yes':1,'no':0})","71b95d45":"insurance_data[\"region\"].value_counts()","9675f57d":"insurance_data[\"region\"] = insurance_data.region.replace({'southeast':1,'southwest':2,'northwest':3,'northeast':4})","5c732866":"insurance_data.tail()","ed96ea5e":"sns.pairplot(data=insurance_data)","f2beccdc":"insurance_data.corr()","ec8abf6c":"From the above plot and correlation outputs, its known that age and region variables are negatively correlated with expenses.\nSo, leaving these variables and making the model.","6ae2ce74":"insurance_data.info()","12ae4a3a":"Y = insurance_data[\"expenses\"]\nx = insurance_data.drop(columns = [\"expenses\",\"sex\",\"region\"])","51c9a1ae":"from sklearn.linear_model import LinearRegression\nfrom sklearn.model_selection import train_test_split\n","3756f77b":"train_x,test_x,train_y,test_y = train_test_split(x,Y,test_size = 0.3,random_state = 42)","d8c3dc66":"train_x.shape","b0546738":"test_x.shape","b2d85003":"model = LinearRegression()\nmodel.fit(train_x,train_y)","17a39aea":"model.intercept_","c73a019e":"model.coef_","3affb4c3":"train_x.columns","b70ff756":"train_predict = model.predict(train_x)","416951b3":"test_predict = model.predict(test_x)","007c68c8":"from sklearn.metrics import mean_absolute_error,mean_squared_error,r2_score\nprint(\"MSE - Train_data :\" ,mean_squared_error(train_y,train_predict))\nprint(\"MSE - Test_tata :\" ,mean_squared_error(test_y,test_predict))\nprint(\"MAE - Train_data :\" ,mean_absolute_error(train_y,train_predict))\nprint(\"MAE - Test_data :\" ,mean_absolute_error(test_y,test_predict))\nprint(\"R2 - Train_data :\" ,r2_score(train_y,train_predict))\nprint(\"R2 - Test_data :\" ,r2_score(test_y,test_predict))\nprint(\"Mape - Train_data:\" , np.mean(np.abs((train_y,train_predict))))\nprint(\"Mape - Test_data:\" ,np.mean(np.abs((test_y,test_predict))))","c2007d4a":"Based on the output, the intercept value is -12472.897. And the coefficients B1, B2,B3 and B4 are 261.835, 333.484, 433.500 and 23626.098 respectively. The regression model can be written, y = -12472.897 + 261.835(age) + 333.484(bmi) + 433.500(children) + 23626.098(smoker)."}}