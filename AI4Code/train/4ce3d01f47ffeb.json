{"cell_type":{"f3aaa52a":"code","c3fe4e94":"code","32fe5850":"code","c08b8cd2":"code","32f55681":"code","a747b260":"code","8c137b76":"code","ac9fc0e5":"code","3b6aa574":"code","d29fc9be":"code","fe1299c7":"code","4b181e61":"code","e9330b52":"code","555277b1":"code","a28d32b7":"code","e2dd1c90":"code","1e921354":"code","02dde82d":"code","9f6e1d25":"code","06a7adb3":"code","6d97582d":"code","02cd5b32":"code","5a18de08":"code","d5f2e8e6":"code","bc54589d":"code","fad9baeb":"code","87bcf902":"code","702e4cc0":"code","91190222":"code","9647c4af":"code","bbaf0202":"code","164a69f4":"code","55e816d5":"markdown","04399055":"markdown","8cff1702":"markdown","1301e42b":"markdown","e3467cfc":"markdown","a82e048d":"markdown","ff23d572":"markdown","e66296e1":"markdown","aea1d939":"markdown","cc354906":"markdown","28b6ca13":"markdown","0b98f755":"markdown","eaf81907":"markdown","38b8e3a6":"markdown"},"source":{"f3aaa52a":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.model_selection import train_test_split,GridSearchCV\nfrom sklearn.preprocessing import OneHotEncoder, MinMaxScaler\nfrom sklearn.compose import ColumnTransformer","c3fe4e94":"#loading the dataset\nheart_df = pd.read_csv(\"..\/input\/heart-failure-prediction\/heart.csv\")\nheart_df","32fe5850":"#info about dataset\nheart_df.info()","c08b8cd2":"#descriptive statistics\nheart_df.describe()","32f55681":"#checking null values\nheart_df.isna().sum()","a747b260":"def plot_bar_heart_disease(df,col,target,title,color=\"g\"):\n    plt.style.use(\"seaborn-whitegrid\")\n    xcol = df[col].unique()\n    ycol = []\n    for val in xcol:\n        ycol.append(df[col].loc[(df[col]==val) & (df[target]==1)].count())\n    fig, ax = plt.subplots(figsize=(10,8))\n    ax.bar(xcol,ycol,color=color)\n    ax.set(title=title,xlabel=col,ylabel=target);","8c137b76":"plot_bar_heart_disease(heart_df,\"ChestPainType\",\"HeartDisease\",\"No of Patients Diagnosed with Heart Disease against different Chest Pain Type\")","ac9fc0e5":"plot_bar_heart_disease(heart_df,\"Sex\",\"HeartDisease\",\"Male vs Female Diagnosed with Heart Disease\",\"hotpink\")","3b6aa574":"plot_bar_heart_disease(heart_df,\"RestingECG\",\"HeartDisease\",\"RestingECG vs HeartDisease Graph\",\"orange\")","d29fc9be":"plot_bar_heart_disease(heart_df,\"ExerciseAngina\",\"HeartDisease\",\"ExerciseAngina vs HeartDisease\",\"rebeccapurple\")","fe1299c7":"plot_bar_heart_disease(heart_df,\"Age\",\"HeartDisease\",\"Age vs HeartDisease\",\"tomato\")","4b181e61":"plot_bar_heart_disease(heart_df,\"MaxHR\",\"HeartDisease\",\"MaxHR vs HeartDisease\",\"crimson\")","e9330b52":"plot_bar_heart_disease(heart_df,\"FastingBS\",\"HeartDisease\", \"FastingBS vs HeartDisease\", \"orange\")","555277b1":"def plot_scatter_heart_disease(df,col1,col2,target,cmap):\n    fig, ax = plt.subplots(figsize=(10,8))\n    scatter = ax.scatter(df[col1],df[col2],c=df[target],cmap=cmap)\n    ax.set(title=(col1+ \" vs \"+col2),xlabel = col1, ylabel = col2)\n    ax.legend(*scatter.legend_elements(), title=target);\n","a28d32b7":"plot_scatter_heart_disease(heart_df,\"RestingBP\", \"MaxHR\", \"HeartDisease\", \"viridis\")","e2dd1c90":"plot_scatter_heart_disease(heart_df,\"MaxHR\",\"Cholesterol\",\"HeartDisease\",\"cividis\")","1e921354":"heart_df[\"Cholesterol\"].loc[heart_df[\"Cholesterol\"]==0].count()","02dde82d":"heart_df[\"RestingBP\"].loc[heart_df[\"RestingBP\"]==0].count()","9f6e1d25":"#split our independent and dependent features\nX = heart_df.drop(columns=[\"HeartDisease\"])\ny = heart_df[\"HeartDisease\"]\n\n#encoder to turn objects into categories\none_hot = OneHotEncoder(handle_unknown=\"ignore\")\ncat_features = [\"Sex\",\"ChestPainType\",\"RestingECG\",\"ExerciseAngina\",\"ST_Slope\"]\n\n#scaler\nscaler = MinMaxScaler()\nscale_features = [\"Age\",\"RestingBP\",\"Cholesterol\",\"MaxHR\"]\n\n#transformer\ntransformer = ColumnTransformer([\n    (\"one_hot\",one_hot,cat_features),\n    (\"scaler\",scaler,scale_features)\n])\n\nX_transform = transformer.fit_transform(X)","06a7adb3":"#splitting our data set into train_test set\nX_train,X_test,y_train,y_test = train_test_split(X_transform,y,test_size=0.2)","6d97582d":"#importing our model\nfrom sklearn.ensemble import RandomForestClassifier\n\nclf = RandomForestClassifier(n_estimators=200,max_depth=15,max_features='sqrt',min_samples_leaf=4,min_samples_split=2)","02cd5b32":"#training our dataset\nclf.fit(X_train,y_train)","5a18de08":"clf.score(X_test,y_test)","d5f2e8e6":"from sklearn.metrics import accuracy_score,precision_score, recall_score,f1_score,confusion_matrix,roc_auc_score,roc_curve,classification_report \n\n#prediction values\n\ny_preds = clf.predict(X_test)\ny_preds","bc54589d":"accuracy_score(y_test,y_preds)","fad9baeb":"precision_score(y_test,y_preds)\n","87bcf902":"recall_score(y_test,y_preds)\n","702e4cc0":"f1_score(y_test,y_preds)\n","91190222":"confusion_matrix(y_test,y_preds)","9647c4af":"roc_auc_score(y_test,y_preds)","bbaf0202":"print(classification_report(y_test,y_preds))","164a69f4":"fpr, tpr, thresholds = roc_curve(y_test,y_preds)\n\nplt.plot(fpr,tpr);","55e816d5":"**Our conclusion upto this point is we need to convert those column containing strings to categories and scale those\ncolumns which contains outliers**","04399055":"## **Contents:**\n\n* Importing Libraries\n* Initial impression on the Dataset\n* Visualization\n* Feature Engineering\n* Choosing the right estimator and training our dataset\n* Evaluation","8cff1702":"## **End-To-End Machine Learning Notebook of Heart Failure Dataset**","1301e42b":"## Heart Failure Prediction Dataset ","e3467cfc":"## Evaluation","a82e048d":"**Dataset dont have any missing values**","ff23d572":"## Choosing the right estimator and training our dataset","e66296e1":"**`ASY`[Asymptomatic] Chest Pain Type patients diagnosed with highest no of heart disease**","aea1d939":"## **Visualization**","cc354906":"## Feature Engineering","28b6ca13":"## **Importing Libraries**","0b98f755":"## **Initial Impression on the Dataset**","eaf81907":"**Males Diagnosed with Heart Disease way higher than Females**","38b8e3a6":"**From the scatter plots, one thing we observed, in `RestingBP` and `Cholesterol` column some values are 0**"}}