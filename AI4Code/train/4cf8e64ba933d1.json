{"cell_type":{"c5bb4cac":"code","c320c06e":"code","c3d0ddfb":"code","1d052f2a":"code","5b83a004":"code","c271a156":"code","38168b8a":"code","12792bc9":"code","baa2bdd3":"code","2e1797a6":"code","cf0761bf":"code","750a5627":"code","02538c15":"code","aa876a6d":"code","da7c458d":"code","c572a089":"code","46519496":"code","eb6814b2":"markdown"},"source":{"c5bb4cac":"import pandas as pd\nimport matplotlib.pyplot as plt\nfrom keras.models import Sequential\nfrom keras.layers import Dense, Dropout\nfrom keras.losses import MeanSquaredError\nfrom keras.metrics import Recall,Precision,Accuracy","c320c06e":"train = pd.read_csv(\"\/kaggle\/input\/competitive-data-science-predict-future-sales\/sales_train.csv\")\ntest = pd.read_csv(\"\/kaggle\/input\/competitive-data-science-predict-future-sales\/test.csv\")\nsample_submission = pd.read_csv(\"\/kaggle\/input\/competitive-data-science-predict-future-sales\/sample_submission.csv\")","c3d0ddfb":"test = test.drop(['ID'], axis = 1)","1d052f2a":"from sklearn.model_selection import train_test_split\n\nX_train,X_test,y_train,y_test = train_test_split(train.iloc[:,2:-2],train.iloc[:,-1],test_size=.33, random_state = 101)\n\nX_train","5b83a004":"model = Sequential()\nmodel.add(Dense(10, input_dim = 2, activation = 'relu'))\nmodel.add(Dropout(0.2))\nmodel.add(Dense(1, activation = 'sigmoid'))\nmodel.compile(\n    optimizer='adam',\n    loss='mean_squared_error',\n    metrics=[\n        Accuracy(),\n        Precision(),\n        Recall()\n    ]\n)\n\nhistory = model.fit(\n    X_train, \n    y_train, \n    validation_data = (X_test, y_test), \n    epochs = 2, \n    batch_size = 8\n)","c271a156":"fig, ax = plt.subplots()\nax.plot(history.history['accuracy'], label = 'acc')\nax.plot(history.history['loss'], label = 'loss')\n\n\nax.legend()\nax.grid(True)\nax.set_xlabel(\"Epoch\")\nax.set_ylabel(\"Rate\")\nplt.show()","38168b8a":"model.evaluate(X_train, y_train)","12792bc9":"pred = model.predict(X_test)","baa2bdd3":"pred","2e1797a6":"test_pred = model.predict(test)","cf0761bf":"test_pred","750a5627":"from sklearn import metrics\n\nfpr, tpr, thresholds = metrics.roc_curve(y_test, pred, pos_label=2)\nmetrics.auc(fpr, tpr)","02538c15":"from sklearn.metrics import f1_score\n\nf1_score(y_test, pred, average='macro')","aa876a6d":"f1_score(y_test, pred, average='micro')","da7c458d":"from sklearn.metrics import accuracy_score\n\naccuracy_score(y_test, pred)","c572a089":"sample_submission = sample_submission.drop(['item_cnt_month'], axis = 1)","46519496":"my_sub = pd.DataFrame(test_pred,columns=['item_cnt_month'])\nmy_sub = pd.concat([sample_submission, my_sub], axis = 1)\nmy_sub.head()\nmy_sub.to_csv('submission.csv', index = False)","eb6814b2":"Ufuk \u0130lik\n170202096"}}