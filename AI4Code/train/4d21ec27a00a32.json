{"cell_type":{"a77e60f9":"code","e5bbc66f":"code","f628b92d":"code","51c55c06":"code","9ccff39a":"code","bd32227c":"code","a7cf5835":"code","269fb89d":"markdown","be3a5f00":"markdown","f8c7b45b":"markdown","30c20908":"markdown","5bbe8095":"markdown","0c67aebd":"markdown","df508347":"markdown"},"source":{"a77e60f9":"# Importing basic libraries\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport pandas as pd\nimport numpy as np\n# Reading files\nbyb=pd.read_csv('..\/input\/ipl-complete-dataset-20082020\/IPL Ball-by-Ball 2008-2020.csv')\nmatch= pd.read_csv('..\/input\/ipl-complete-dataset-20082020\/IPL Matches 2008-2020.csv')\nbyb.head()","e5bbc66f":"# Fantasy Points\n\nBatsman_points = {'Run':1, 'bFour':1, 'bSix':2, '30Runs':4,\n        'Half_century':8, 'Century':16, 'Duck':-2, '170sr':6,\n                 '150sr':4, '130sr':2, '70sr':-2, '60sr':-4, '50sr':-6}\n\nBowling_points = {'Wicket':25, 'LBW_Bowled':8, '3W':4, '4W':8, \n                  '5W':16, 'Maiden':12, '5rpo':6, '6rpo':4, '7rpo':2, '10rpo':-2,\n                 '11rpo':-4, '12rpo':-6}\n\nFielding_points = {'Catch':8, '3Cath':4, 'Stumping':12, 'RunOutD':12,\n                  'RunOutInd':6}","f628b92d":"# Storing team players\n# Here I have to do manual work... choosing the players after the toss and putting them here\n'''\nsrh = ['Abdul Samad','DA Warner','JJ Roy','KS Williamson', 'PK Garg', \n              'SE Rutherford',        'Abhishek Sharma','JO Holder','KM Jadhav',\n               'Mohammad Nabi','V Shankar','SP Goswami','WP Saha','Basil Thampi',\n              'B Kumar', 'KK Ahmed','Mujeeb Ur Rahman', 'Rashid Khan','Sandeep Sharma',\n              'S Nadeem', 'S Kaul', 'T Natarajan',]\npbks = ['CH Gayle', 'Mandeep Singh','MA Agarwal','SN Khan', 'DJ Hooda',\n               'MC Henriques','KL Rahul','N Pooran','Arshdeep Singh','Mohammed Shami',\n                'M Ashwin','Ravi Bishnoi','Harpreet Brar','CJ Jordan']\n'''\n# Match 37\nsrh = ['Abdul Samad','DA Warner','KS Williamson','JO Holder','KM Jadhav',\n              'B Kumar', 'KK Ahmed','Mujeeb Ur Rahman', 'Rashid Khan','Sandeep Sharma',]\npbks = ['CH Gayle', 'MA Agarwal', 'DJ Hooda','KL Rahul','N Pooran','Arshdeep Singh',\n        'Mohammed Shami','M Ashwin','Ravi Bishnoi','Harpreet Brar',]\n\n# Match 38 teams\n# csk = ['MS Dhoni', 'F du Plessis', 'SK Raina','RD Gaikwad','AT Rayudu',\n#        'MM Ali','RA Jadeja','SM Curran','DJ Bravo','SN Thakur',\n#        'DL Chahar','Imran Tahir',]\n# kkr = ['KD Karthik','Shubman Gill', 'N Rana', 'RA Tripathi','EJG Morgan',\n#        'AD Russell', 'SP Narine', 'Shakib Al Hasan', 'LH Ferguson', 'M Prasidh Krishna',\n#        'Shivam Mavi', 'KL Nagarkoti', 'Harbhajan Singh',]\n\ncsk = ['MS Dhoni', 'F du Plessis', 'SK Raina','RD Gaikwad','AT Rayudu',\n       'MM Ali','RA Jadeja','SM Curran','SN Thakur', 'DL Chahar']\n# Hazelwood not present in database\nkkr = ['KD Karthik','Shubman Gill', 'N Rana', 'RA Tripathi','EJG Morgan',\n       'AD Russell', 'SP Narine',  'LH Ferguson', 'M Prasidh Krishna',]\n# Chakravarty and Iyyer not present in database\n\n# Fatasy points of players so far in 2021\ncsk_fp = {'MS Dhoni':143, 'F du Plessis':554, 'SK Raina':286,'RD Gaikwad':484,'AT Rayudu':273,\n       'MM Ali':514,'RA Jadeja':555,'SM Curran':358,'DJ Bravo':334,'SN Thakur':256,\n       'DL Chahar':389,'Imran Tahir':80,}\nkkr_fp = {'KD Karthik':242,'Shubman Gill':306, 'N Rana':326, 'RA Tripathi':410,'EJG Morgan':210,\n       'AD Russell':545, 'SP Narine':172, 'Shakib Al Hasan':120, 'LH Ferguson':126, 'M Prasidh Krishna':347,\n       'Shivam Mavi':88, 'KL Nagarkoti':-2, 'Harbhajan Singh':24,}\n\n\n# Match 39 teams\nrcb_fp = {'AB de Villiers':417, 'V Kohli':414, 'GJ Maxwell':392, 'D Padikkal':431, 'Shahbaz Ahmed':194,\n        'DT Christian':47, 'HV Patel':634, 'Mohammed Siraj':275, 'YS Chahal':242, 'N Saini':6  }\nmi_fp = {'Q de Kock':365, 'Ishan Kishan':134,'RG Sharma':393,'SA Yadav':307, 'KA Pollard':423,\n        'CA Lynn':85, 'A Singh':24,'SS Tiwary':85,  'KH Pandya':301, 'HH Pandya':121,\n          'JDS Neesham':-4, 'JJ Bumrah':382,  'TA Boult':371, 'RD Chahar':374,  'AF Milne':98,\n        'J Yadav':69, 'NM Coulter-Nile':4}\n\nrcb= ['AB de Villiers', 'V Kohli', 'GJ Maxwell', 'D Padikkal', 'Shahbaz Ahmed',\n      'DT Christian', 'HV Patel', 'Mohammed Siraj', 'YS Chahal', 'N Saini'  ]\n\nmi = ['Q de Kock', 'Ishan Kishan','RG Sharma','SA Yadav', 'KA Pollard',\n      'CA Lynn', 'A Singh','SS Tiwary',  'KH Pandya', 'HH Pandya',\n      'JDS Neesham', 'JJ Bumrah',  'TA Boult', 'RD Chahar',  'AF Milne',\n      'J Yadav', 'NM Coulter-Nile' ]\n\n","51c55c06":"team1 = mi; team2 = rcb\n\nfor i in range(len(team1)):\n    ffp = []\n    for j in range(len(team2)):\n        bat_vs_bowl = byb[(byb[\"batsman\"]==team1[i]) & (byb[\"bowler\"]==team2[j])]\n        bowls_played = len(bat_vs_bowl.batsman_runs)\n        runs_scored = sum(bat_vs_bowl.batsman_runs)\n        fours = len(bat_vs_bowl[bat_vs_bowl['batsman_runs']==4])\n        sixes = len(bat_vs_bowl[bat_vs_bowl['batsman_runs']==6])\n        wicket = sum(bat_vs_bowl.is_wicket)\n        if bowls_played <=6*10 and wicket >=5:\n            penalty = -16\n            print (team1[i], \"ka wicket taken\",wicket,\"times by\", team2[j])\n        elif bowls_played <=6*8 and wicket >=4:\n            penalty = -8\n            print (team1[i], \"ka wicket taken\",wicket,\"times by\", team2[j])\n        elif bowls_played <=6*6 and wicket >=3:\n            penalty = -4\n            print (team1[i], \"'s wicket taken\",wicket,\"times by\", team2[j])\n        else:\n            penalty = 0\n        try:    \n            strike_rate = int(runs_scored\/bowls_played*100)\n        except: \n            strike_rate = 'NA'\n\n        if bowls_played >=8 and strike_rate!='NA':\n            if strike_rate >=170:\n                print (team1[i] ,\"beaten\", team2[j], \"Runs\", runs_scored,\"bowls\",bowls_played,\"strike rate\", strike_rate,'Out',wicket,'times', \"Fours\", fours,\"Sixes\", sixes)            \n            elif strike_rate >=150:\n                print (team1[i] ,\"beaten\", team2[j], \"Runs\", runs_scored,\"bowls\",bowls_played,\"strike rate\", strike_rate,'Out',wicket,'times', \"Fours\", fours,\"Sixes\", sixes)            \n                        \n        bowl_vs_bat = byb[(byb[\"bowler\"]==team1[i]) & (byb[\"batsman\"]==team2[j])]\n        wicket_took = sum(bowl_vs_bat.is_wicket)\n        fantasy_points1 = runs_scored + fours*Batsman_points['bFour'] + sixes*Batsman_points['bSix'] - wicket*Bowling_points['Wicket'] + wicket_took*Bowling_points['Wicket'] + penalty\n        ffp.append(fantasy_points1)\n#         print (team1[i] ,\"against\", team2[j], \"Runs\", runs_scored, \n#                \"bowls\",bowls_played,\"strike rate\", strike_rate,\n#               'Out',wicket,'times', \"Fours\", fours,\"Sixes\", sixes)","9ccff39a":"team1 = rcb; team2 = mi\n\nfor i in range(len(team1)):\n    ffp=[]\n    for j in range(len(team2)):\n        bat_vs_bowl = byb[(byb[\"batsman\"]==team1[i]) & (byb[\"bowler\"]==team2[j])]\n        bowls_played = len(bat_vs_bowl.batsman_runs)\n        runs_scored = sum(bat_vs_bowl.batsman_runs)\n        fours = len(bat_vs_bowl[bat_vs_bowl['batsman_runs']==4])\n        sixes = len(bat_vs_bowl[bat_vs_bowl['batsman_runs']==6])\n        wicket = sum(bat_vs_bowl.is_wicket)\n        if bowls_played <=6*10 and wicket >=5:\n            penalty = -16\n            print (team1[i], \"ka wicket taken\",wicket,\"times by\", team2[j])\n        elif bowls_played <=6*8 and wicket >=4:\n            penalty = -8\n            print (team1[i], \"ka wicket taken\",wicket,\"times by\", team2[j])\n        elif bowls_played <=6*6 and wicket >=3:\n            penalty = -4\n            print (team1[i], \"'s wicket taken\",wicket,\"times by\", team2[j])\n        else:\n            penalty = 0\n        try:    \n            strike_rate = int(runs_scored\/bowls_played*100)\n        except: \n            strike_rate = 'NA'\n\n        if bowls_played >=8 and strike_rate!='NA':\n            if strike_rate >=170:\n                print (team1[i] ,\"beaten\", team2[j], \"Runs\", runs_scored,\"bowls\",bowls_played,\"strike rate\", strike_rate,'Out',wicket,'times', \"Fours\", fours,\"Sixes\", sixes)            \n            elif strike_rate >=150:\n                print (team1[i] ,\"beaten\", team2[j], \"Runs\", runs_scored,\"bowls\",bowls_played,\"strike rate\", strike_rate,'Out',wicket,'times', \"Fours\", fours,\"Sixes\", sixes)            \n                        \n        bowl_vs_bat = byb[(byb[\"bowler\"]==team1[i]) & (byb[\"batsman\"]==team2[j])]\n        wicket_took = sum(bowl_vs_bat.is_wicket)\n        fantasy_points1 = runs_scored + fours*Batsman_points['bFour'] + sixes*Batsman_points['bSix'] - wicket*Bowling_points['Wicket'] + wicket_took*Bowling_points['Wicket'] + penalty\n        ffp.append(fantasy_points1)\n#         print (team1[i] ,\"against\", team2[j], \"Runs\", runs_scored, \n#                \"bowls\",bowls_played,\"strike rate\", strike_rate,\n#               'Out',wicket,'times', \"Fours\", fours,\"Sixes\", sixes, 'fantasy_points', fantasy_points1)","bd32227c":"def get_players(team1,team2,team1_fp):\n    fantasy_team_players = []\n\n    for i in range(len(team1)):\n        unq_ids = byb[byb[\"batsman\"]==team1[i]]['id'].unique()\n        mathces_played = len(unq_ids)\n#         print ( \"Number of matches played\" , len(unq_ids),team1[i])\n        bbr = []\n        for x in unq_ids:\n            bat_run = sum(byb[(byb[\"batsman\"]==team1[i])&(byb['id']==x)]['batsman_runs'])\n            bbr.append(bat_run)\n\n        r30,r50,r100 =0,0,0\n        for m in bbr:\n            if m>=100:\n                r100+=1\n            elif m>=50:\n                r50+=1\n            elif m>=30:\n                r30+=1\n        try:\n            catches = len(byb[(byb['fielder']==team1[i]) & (byb['dismissal_kind']=='caught')])\/mathces_played\n            run_outs = len(byb[(byb['fielder']==team1[i]) & (byb['dismissal_kind']=='run out')])\/mathces_played\n            extra_points = r30\/mathces_played*Batsman_points['30Runs'] +r50\/mathces_played*Batsman_points['Half_century'] +r100\/mathces_played*Batsman_points['Century'] +catches*Fielding_points['Catch']+run_outs*Fielding_points['RunOutInd']\n        except:\n            catches, run_outs, extra_points = 0,0,0\n        \n        # Extra Points for bowlers to be estimated here\n        wickets_taken = []\n        for x in unq_ids:\n            twx = sum(byb[(byb[\"bowler\"]==team1[i]) & (byb['id']==x)]['is_wicket'])\n            wickets_taken.append(twx)\n\n        w3,w4,w5 = 0,0,0\n        for z in wickets_taken:\n            if z>=5:\n                w5+=1\n            elif z>=4:\n                w4+=1\n            elif z>=3:\n                w3+=1\n        try:\n            lbws = len((byb[(byb['bowler']==team1[i]) & (byb['dismissal_kind']=='lbw')]))\/mathces_played      \n            bowled = len((byb[(byb['bowler']==team1[i]) & (byb['dismissal_kind']=='bowled')]))\/mathces_played      \n            wexp = w3\/mathces_played*Bowling_points['3W'] + w4\/mathces_played*Bowling_points['4W'] + w5\/mathces_played*Bowling_points['5W'] + lbws*Bowling_points['LBW_Bowled'] + bowled*Bowling_points['LBW_Bowled']\n        except:\n            lbws, bowled, wexp = 0,0,0\n        \n        ffp = []\n        for j in range(len(team2)):\n            bat_vs_bowl = byb[(byb[\"batsman\"]==team1[i]) & (byb[\"bowler\"]==team2[j])]\n            bowls_played = len(bat_vs_bowl.batsman_runs)\n            runs_scored = sum(bat_vs_bowl.batsman_runs)\n            fours = len(bat_vs_bowl[bat_vs_bowl['batsman_runs']==4])\n            sixes = len(bat_vs_bowl[bat_vs_bowl['batsman_runs']==6])\n            wicket = sum(bat_vs_bowl.is_wicket)\n            if bowls_played <=6*10 and wicket >=5:\n                penalty = -16\n                print (team1[i], \"ka wicket taken\",wicket,\"times by\", team2[j])\n            elif bowls_played <=6*8 and wicket >=4:\n                penalty = -8\n                print (team1[i], \"ka wicket taken\",wicket,\"times by\", team2[j])\n            elif bowls_played <=6*6 and wicket >=3:\n                penalty = -4\n                print (team1[i], \"'s wicket taken\",wicket,\"times by\", team2[j])\n            else:\n                penalty = 0\n\n            try:    \n                strike_rate = int(runs_scored\/bowls_played*100)\n            except: \n                strike_rate = 'NA'            \n            if bowls_played >=10 and strike_rate!='NA':\n                if strike_rate >=170:\n                    print (team1[i] ,\"beaten\", team2[j], \"Runs\", runs_scored,\"bowls\",bowls_played,\"strike rate\", strike_rate,'Out',wicket,'times', \"Fours\", fours,\"Sixes\", sixes)            \n                elif strike_rate >=150:\n                    print (team1[i] ,\"beaten\", team2[j], \"Runs\", runs_scored,\"bowls\",bowls_played,\"strike rate\", strike_rate,'Out',wicket,'times', \"Fours\", fours,\"Sixes\", sixes)            \n\n                \n            bowl_vs_bat = byb[(byb[\"bowler\"]==team1[i]) & (byb[\"batsman\"]==team2[j])]\n            wicket_took = sum(bowl_vs_bat.is_wicket)\n            fantasy_points1 = runs_scored + fours*Batsman_points['bFour'] + sixes*Batsman_points['bSix'] - wicket*Bowling_points['Wicket'] + wicket_took*Bowling_points['Wicket'] + penalty \n            ffp.append(fantasy_points1)\n#             print (team1[i] ,\"against\", team2[j], \"Runs\", runs_scored, \n#                    \"bowls\",bowls_played,\"strike rate\", strike_rate,\n#                   'Out',wicket,'times', \"Fours\", fours,\"Sixes\", sixes, \"fatansy points\",fantasy_points1)\n        sum_ffp = sum(ffp)\n        if team1_fp[team1[i]] > 0:\n            recent_performace_points = np.log(team1_fp[team1[i]])\n        elif team1_fp[team1[i]] <0:\n            recent_performace_points = -np.log(abs(team1_fp[team1[i]]))\n        else:\n            recent_performace_points = 0\n        # Trying a new method for recent performancec point\n        recent_performace_points = team1_fp[team1[i]]\/3\n        weight1 = 0.5\n        weight2 = 1 - weight1\n        final_fantasy_point = (sum_ffp + extra_points + wexp)*weight1 + recent_performace_points*weight2\n        final_fantasy_point = round(final_fantasy_point,2)\n        fantasy_team_players.append((final_fantasy_point,team1[i]))\n        fantasy_team_players.sort(reverse=True)\n#         print (\"Fatasy points of\",team1[i],final_fantasy_point)\n    return fantasy_team_players\n\nt1 = get_players(mi, rcb, mi_fp)\nprint ('\\n')\nt2 = get_players(rcb, mi, rcb_fp)\nt3 = t1 + t2\nt3.sort(reverse = True)\nprint (\"================================================\\n\")\nprint (\"Team 1\", t1)\nprint (\"================================================\\n\")\nprint (\"Team 2\", t2)\nprint('\\n Your final team')\nt3[:15]","a7cf5835":"print (\"Team 1\", t1)\nprint (\"\\n================================================\\n\")\nprint (\"Team 2\", t2)\nprint('\\n Your final team')\nt3[:12]","269fb89d":"### Here is your fantasy team","be3a5f00":"### Store players name in the team... you have to modify it when a team wins the toss and declares their team","f8c7b45b":"## Finally taking other fantasy points into consideration","30c20908":"## Creating Fantasy Point Table using dream11 app","5bbe8095":"### Checking performance of batsman in one team against another team's bowlers","0c67aebd":"Objective is to perform basic EDA for each player\n1. Try to pick a winning team consisting of 11 players for dream11\n2. See which batsman is good against which bowler\n3. Check which bowler is good against which batsman","df508347":"## Reverse the teams and check"}}