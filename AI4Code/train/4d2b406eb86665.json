{"cell_type":{"0a392092":"code","69647289":"code","6e22883c":"code","62d17d5a":"code","91fe8cb0":"code","e01c96b8":"code","e8f9e550":"code","e1c27acd":"code","a5aca62d":"code","f5fbeffc":"code","9314731d":"code","d0a9798d":"code","19996e44":"code","aaccd7e8":"code","091f4da3":"code","e8aff140":"code","da444676":"code","e9a005a5":"code","1d7ddb03":"code","0517cbab":"code","6c5237d6":"code","b467654f":"code","89b0fb10":"code","604f5ada":"code","41dad31a":"code","29a5ae6b":"code","c390a71b":"code","e8bca8b2":"code","7e227473":"code","3eaf548c":"code","b199197d":"code","02f42c14":"code","525de8c2":"code","99f20b22":"code","653e5e2a":"code","d380340c":"code","614e06d6":"code","e7619f7f":"markdown","ca1af8ff":"markdown","cc41cbb6":"markdown","400aa3cd":"markdown","1edba18d":"markdown","b162e68d":"markdown","14e5d98a":"markdown","48b5059b":"markdown","7a83aca8":"markdown","728b8dfa":"markdown","7d883eae":"markdown","e555af5e":"markdown","86c496fc":"markdown","083d271f":"markdown","b3ca5691":"markdown","928a722f":"markdown"},"source":{"0a392092":"import pandas as pd\nimport matplotlib.pyplot as plt\n\nimport warnings\nwarnings.filterwarnings('ignore')","69647289":"df = pd.read_csv('..\/input\/us-consumer-finance-complaints\/consumer_complaints.csv')\ndf.head()","6e22883c":"# Shape of the dataset\ndf.shape","62d17d5a":"# Data types of different variables\ndf.dtypes","91fe8cb0":"# Changing the datatype of date_received and date_sent_to_company\ndf.date_received = pd.to_datetime(df.date_received)\ndf.date_sent_to_company = pd.to_datetime(df.date_sent_to_company)","e01c96b8":"# No. of unique values in each variables\ndf.nunique()","e8f9e550":"# Checking for the missing values\ndf.isna().sum()","e1c27acd":"# Checking for the duplicate values\ndf.duplicated().sum()","a5aca62d":"# Percentage of missing values\nmissing_percentage = round((df.isna().sum()\/len(df)*100),2).sort_values(ascending=False)","f5fbeffc":"# Graph showing the percentage of missing data\nplt.figure(figsize=(8,8))\nmissing_percentage.plot(kind='barh')\nplt.xlabel('Percentage of missing data')\nplt.ylabel('Variables')\nplt.title('Percentage of missing values in each variable')","9314731d":"# Different products complaints was made about\ndf['product'].unique()","d0a9798d":"# Datatypes and the count of variables\ndf.dtypes.value_counts()","19996e44":"# Count(frequency) plot describing the datatypes and the count of variable\nplt.figure(figsize=(5,5))\nplt.bar(['object','datetime','int'],df.dtypes.value_counts())\nplt.xlabel('Datatypes')\nplt.ylabel('No of Variables')\nplt.title('Count(frequency) plot describing the datatypes and the count of variable')","aaccd7e8":"# Minimum & Maximun date\nprint('Minimun date :',df.date_received.min(),'\\n')\nprint('Maximum date :',df.date_received.max(),'\\n')","091f4da3":"df.columns","e8aff140":"df = df.reindex(columns=['complaint_id','date_received','product', 'sub_product', 'issue', 'sub_issue',\n       'consumer_complaint_narrative', 'company_public_response', 'company',\n       'state', 'zipcode', 'tags', 'consumer_consent_provided',\n       'submitted_via', 'date_sent_to_company', 'company_response_to_consumer',\n       'timely_response', 'consumer_disputed?','month'])","da444676":"# Years for which the data is recorded\ndf.date_received.dt.year.unique()","e9a005a5":"# Data for year 2012,2013,2014 & 2015\ndf2012 = df[df.date_received.dt.year==2012]\ndf2013 = df[df.date_received.dt.year==2013]\ndf2014 = df[df.date_received.dt.year==2014]\ndf2015 = df[df.date_received.dt.year==2015]","1d7ddb03":"# Monthwise complaints for the Year 2012\nComplaints_2012 = df2012.groupby(df2012.date_received.dt.month).agg({'complaint_id':'count'})\nComplaints_2012['month'] = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec']\nComplaints_2012.set_index('month',drop=True,inplace=True)\nComplaints_2012.rename(columns={'complaint_id':'no_of_complaints'},inplace=True)\n\n# Monthwise complaints for the Year 2013\nComplaints_2013 = df2013.groupby(df2013.date_received.dt.month).agg({'complaint_id':'count'})\nComplaints_2013['month'] = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec']\nComplaints_2013.set_index('month',drop=True,inplace=True)\nComplaints_2013.rename(columns={'complaint_id':'no_of_complaints'},inplace=True)\n\n# Monthwise complaints for the Year 2014\nComplaints_2014 = df2014.groupby(df2014.date_received.dt.month).agg({'complaint_id':'count'})\nComplaints_2014['month'] = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec']\nComplaints_2014.set_index('month',drop=True,inplace=True)\nComplaints_2014.rename(columns={'complaint_id':'no_of_complaints'},inplace=True)\n\n# Monthwise complaints for the Year 2015\nComplaints_2015 = df2015.groupby(df2015.date_received.dt.month).agg({'complaint_id':'count'})\nComplaints_2015['month'] = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec']\nComplaints_2015.set_index('month',drop=True,inplace=True)\nComplaints_2015.rename(columns={'complaint_id':'no_of_complaints'},inplace=True)\n\nprint('Complaints for the Year 2012 :','\\n',Complaints_2012)\nprint('\\nComplaints for the Year 2013 :','\\n',Complaints_2013)\nprint('\\nComplaints for the Year 2014 :','\\n',Complaints_2014)\nprint('\\nComplaints for the Year 2015 :','\\n',Complaints_2015)","0517cbab":"# Monthwise complaints trend for the year 2012,2013,2014 & 2015\nplt.figure(figsize=(20,10))\nplt.plot(Complaints_2012,marker='o',label='2012')\nplt.plot(Complaints_2013,marker='o',label='2013')\nplt.plot(Complaints_2014,marker='o',label='2014')\nplt.plot(Complaints_2015,marker='o',label='2015')\nplt.grid()\nplt.xlabel('Month')\nplt.ylabel('No of Complaints')\nplt.legend(loc='upper right')\nplt.title('Monthwise complaints trend for the year 2012,2013,2014 & 2015')","6c5237d6":"plt.figure(figsize=(8,9))\nplt.plot(df.groupby(df['date_received'].dt.year).agg({'complaint_id':'count'}),marker='o')\nplt.grid()\nplt.xlabel('Year')\nplt.ylabel('No of Complaints')\nplt.title('Yearwise complaints')","b467654f":"# Product-wise complaints count\nplt.figure(figsize=(10,10))\nplt.bar(df['product'].unique(),df['product'].value_counts())\nplt.ylabel('No of Complaints')\nplt.xlabel('Products')\nplt.xticks(rotation=340,horizontalalignment='left')\nplt.title('Product-wise complaints count')","89b0fb10":"df1 = df.groupby(['state','consumer_disputed?']).agg({'consumer_disputed?':'count'})\ndf1.columns = ['No_of_Complaints']\ndf1 = df1.reset_index()\n\ndf1.rename(columns={'consumer_disputed?':'disputed_or_not'},inplace=True)\n\ndisputed = df1.query(\"disputed_or_not=='Yes'\")\nNo_disputed = df1.query(\"disputed_or_not=='No'\")","604f5ada":"disputed = disputed.drop('disputed_or_not',axis=1)\nnot_disputed = No_disputed.drop('disputed_or_not',axis=1)\n\ndisputed.rename(columns = {'No_of_Complaints':'Yes'},inplace=True)\nnot_disputed.rename(columns = {'No_of_Complaints':'No'},inplace=True)\n\ndisputed.set_index('state',inplace=True)\nnot_disputed.set_index('state',inplace=True)\n\ndisputed_or_not = pd.concat([disputed,not_disputed],axis=1)\ndisputed_or_not['total_complaints'] = disputed_or_not.Yes+disputed_or_not.No","41dad31a":"disputed_or_not.sort_values('total_complaints',ascending=False,inplace=True)\ndisputed_or_not","29a5ae6b":"# Stacked bar chart\nplt.figure(figsize=(10,10))\nplt.bar(disputed_or_not.head(10).index,disputed_or_not.Yes.head(10),label='Consumer disputed')\nplt.bar(disputed_or_not.head(10).index,disputed_or_not.No.head(10),bottom=disputed_or_not.Yes.head(10),\n        label='Consumer not disputed')\nplt.legend()\nplt.xlabel('State')\nplt.ylabel('No of Complaints')\nplt.title('Top 10 states with most complaints showing whether consumer disputed or not')","c390a71b":"df2 = df.groupby(['company','timely_response']).agg({'timely_response':'count'})\ndf2.columns = ['No_of_Complaints']\ndf2 = df2.reset_index()\n\ntimely_response = df2.query(\"timely_response=='Yes'\")\nlate_response = df2.query(\"timely_response=='No'\")","e8bca8b2":"timely_response = timely_response.drop('timely_response',axis=1)\nlate_response = late_response.drop('timely_response',axis=1)\ntimely_response.rename(columns = {'No_of_Complaints':'timely_response'},inplace=True)\nlate_response.rename(columns = {'No_of_Complaints':'late_response'},inplace=True)\ntimely_response.set_index('company',inplace=True)\nlate_response.set_index('company',inplace=True)\ntimely_or_late_response = pd.concat([timely_response,late_response],axis=1)\ntimely_or_late_response['total_complaints'] = timely_response.timely_response+late_response.late_response","7e227473":"timely_or_late_response.sort_values('total_complaints',ascending=False,inplace=True)\ntimely_or_late_response.head(10)","3eaf548c":"# Stacked bar chart\nplt.figure(figsize=(10,10))\nplt.barh(timely_or_late_response.head(10).index,timely_or_late_response.timely_response.head(10),label='Timely response')\nplt.barh(timely_or_late_response.head(10).index,timely_or_late_response.late_response.head(10),\n         left=timely_or_late_response.timely_response.head(10),label='Late response')\nplt.legend()\nplt.ylabel('Company')\nplt.xlabel('No of Complaints')\nplt.title('Top 10 company with most complaints showing whether the response is provided to the consumer on time or not')","b199197d":"plt.figure(figsize=(8,8))\nplt.barh(df.company_response_to_consumer.unique(),round((df.company_response_to_consumer.value_counts()\/len(df))*100,2))\nplt.xlabel('Percentage of Complaints')\nplt.ylabel('Response provided to the consumers')\nplt.title('Response provided for the complaints')","02f42c14":"df3 = df.loc[:,['submitted_via','date_received','date_sent_to_company']]\ndf3['no_of_days'] = df3['date_sent_to_company']-df3['date_received']","525de8c2":"df3.dtypes","99f20b22":"df3['no_of_days'] = df3['no_of_days'].dt.days\ndf3","653e5e2a":"df3.drop(['date_received','date_sent_to_company'],axis=1,inplace=True)","d380340c":"df3 = df3.groupby('submitted_via').agg({'no_of_days':'mean'})\ndf3.no_of_days = round(df3.no_of_days,0)\ndf3.sort_values('no_of_days',ascending=True,inplace=True)\ndf3","614e06d6":"plt.figure(figsize=(8,8))\nplt.bar(df3.index,df3.no_of_days)\nplt.xlabel('Mode of submitting the complaint')\nplt.ylabel('Avg no. of days for the complaint to reach to the company')\nplt.title('Avg no. of days taken for the complaint to reach to the company depending upon the mode of submission')","e7619f7f":"* Count plot of different responses provided to the consumers by the companies :","ca1af8ff":"* Stacked bar chart of top 10 company with most complaints showing whether the response provided to the consumer is on-time or not :","cc41cbb6":"# Conclusion :","400aa3cd":"'date_received' and 'date_sent_to_company' should be in datatime format instead of object","1edba18d":"Datatype of no_of_days is timedelta. It should be integer, so that no. of days can be aggregated at mean level.","b162e68d":"* Product-wise complaints count :","14e5d98a":"* Avg no. of days taken for the complaint to reach to the company depending upon the mode of submission :","48b5059b":"* Trend chart for complaints at yearly granularity level","7a83aca8":"# Exploratory Data Analysis : ","728b8dfa":"# Loading data","7d883eae":"* Trend chart for complaints at monthly granularity level  \nUsing only the data for year 2012,2013,2014 & 2015, data for year 2011 and 2016 is not used because 2011 has only one month of data and 2016 has only four month of data.","e555af5e":"# Data Exploration :","86c496fc":"* Stacked bar chart of top 10 states with most complaints showing whether consumer disputed or not :","083d271f":"Data is recorded between 1st Dec 2011 and 25th April 2016","b3ca5691":"#### - Total of 555957 finance complaints about 10+ products were filed between 2011-12-01 and 2016-04-25.  \n#### - Maximum number of complaints is regarding Mortgage.  \n#### - State of California has received the most complaints.\n#### - There are total of 3605 companies the complaints were filed against.\n#### - Bank of America has received the maximum complaints.  \n#### - In more than 70% cases the consumer is provided with just the explaination by the company.  \n#### - Complaints were filed by six different mode, namely via Web, Phone, Referral, Fax, Email &   Postal mail.  \n#### - Out of the six mode, the fastet way to send the complaint to the companies is via web.","928a722f":"# Importing necessary libraries"}}