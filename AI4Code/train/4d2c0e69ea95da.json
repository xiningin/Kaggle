{"cell_type":{"e525b6bb":"code","0f633166":"code","4f027753":"code","ccf8b5eb":"code","da4222d5":"code","4c26a64f":"code","60ffd4a0":"code","cdf6affb":"code","49ef30aa":"code","c5c1359c":"code","49d9da99":"code","a6e1de86":"code","35569bf0":"code","8ce22b3e":"code","cfd76c4d":"code","96dd1009":"code","9f42ee93":"code","91e96997":"code","119c3c7d":"code","2dc6cc7a":"code","2eeb1daa":"code","ffe7bb15":"code","b11c524f":"code","508ecaf3":"code","fbe85cb1":"code","6b252b6f":"markdown","09211f12":"markdown","28241139":"markdown","6c647611":"markdown","1c729b1d":"markdown","ab1c11c6":"markdown","b01b282a":"markdown","068ba08e":"markdown","7064e310":"markdown","875d474d":"markdown","538e1fe9":"markdown","c7349802":"markdown","9019594f":"markdown","d2da50dc":"markdown","cd04a3f7":"markdown","51261423":"markdown","a8aaefcd":"markdown","13429bfd":"markdown","6bdfa464":"markdown","e658ee6e":"markdown","801da188":"markdown","d596fe7e":"markdown"},"source":{"e525b6bb":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns \nimport matplotlib.pyplot as plt \nimport missingno as msno\nimport rasterio as rio\nimport folium\nimport tifffile as tiff \n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","0f633166":"data = '\/kaggle\/input\/ds4g-environmental-insights-explorer\/eie_data\/gppd\/gppd_120_pr.csv'\ndf = pd.read_csv(data)","4f027753":"def split_latnlog_into_new_columns_fromgeo(dataframe,column_to_split,new_column_one,begin_column_one,end_column_one):\n    for i in range(0, len(dataframe)):\n        dataframe.loc[i, new_column_one] = dataframe.loc[i, column_to_split][begin_column_one:end_column_one]\n    return dataframe","ccf8b5eb":"power_plants = split_latnlog_into_new_columns_fromgeo(df,'.geo','latitude',50,66)\npower_plants = split_latnlog_into_new_columns_fromgeo(df,'.geo','longitude',31,48)","da4222d5":"power_plants.head()","4c26a64f":"plt.figure(figsize=(8,8))\nsns.catplot('primary_fuel', data= power_plants, kind='count', alpha=0.7, height=6, aspect= 3.5)\n\n# Get current axis on current figure\nax = plt.gca()\n\n# Max value to be set\ny_max = power_plants['primary_fuel'].value_counts().max() \n\n# Iterate through the list of axes' patches\nfor p in ax.patches:\n    ax.text(p.get_x() + p.get_width()\/5., p.get_height(),'%d' % int(p.get_height()),\n            fontsize=13, color='blue', ha='center', va='bottom')\nplt.title('Frequency plot of primary_fule', fontsize = 20, color = 'black')\nplt.show()","60ffd4a0":"plt.figure(figsize=(8,8))\nsns.catplot('source', data= power_plants, kind='count', alpha=0.7, height=6, aspect= 3.5)\n\n# Get current axis on current figure\nax = plt.gca()\n\n# Max value to be set\ny_max = power_plants['source'].value_counts().max() \n\n# Iterate through the list of axes' patches\nfor p in ax.patches:\n    ax.text(p.get_x() + p.get_width()\/5., p.get_height(),'%d' % int(p.get_height()),\n            fontsize=13, color='blue', ha='center', va='bottom')\nplt.title('Frequency plot of source', fontsize = 20, color = 'black')\nplt.show()","cdf6affb":"plt.figure(figsize=(8,8))\nsns.catplot('owner', data= power_plants, kind='count', alpha=0.7, height=6, aspect= 3.5)\n\n# Get current axis on current figure\nax = plt.gca()\n\n# Max value to be set\ny_max = power_plants['owner'].value_counts().max() \n\n# Iterate through the list of axes' patches\nfor p in ax.patches:\n    ax.text(p.get_x() + p.get_width()\/5., p.get_height(),'%d' % int(p.get_height()),\n            fontsize=13, color='blue', ha='center', va='bottom')\nplt.title('Frequency plot of owner ', fontsize = 20, color = 'black')\nplt.show()","49ef30aa":"from scipy import stats\n\nsns.distplot(power_plants['estimated_generation_gwh'] , fit=stats.norm);\n\n# Get the fitted parameters used by the function\n(mu, sigma) = stats.norm.fit(power_plants['estimated_generation_gwh'])\nprint( '\\n mu = {:.2f} and sigma = {:.2f}\\n'.format(mu, sigma))\n\n#Now plot the distribution\nplt.legend(['Normal dist. ($\\mu=$ {:.2f} and $\\sigma=$ {:.2f} )'.format(mu, sigma)],\n            loc='best')\nplt.ylabel('Frequency')\nplt.title('estimated_generation_gwh distribution')\n\n#Get also the QQ-plot\nfig = plt.figure()\nres = stats.probplot(power_plants['estimated_generation_gwh'], plot=plt)\nplt.show()","c5c1359c":"#We use the numpy fuction log1p which  applies log(1+x) to all elements of the column\npower_plants[\"estimated_generation_gwh\"] = np.log1p(power_plants[\"estimated_generation_gwh\"])\n\n#Check the new distribution \nsns.distplot(power_plants['estimated_generation_gwh'] , fit=stats.norm);\n\n# Get the fitted parameters used by the function\n(mu, sigma) =stats.norm.fit(power_plants['estimated_generation_gwh'])\nprint( '\\n mu = {:.2f} and sigma = {:.2f}\\n'.format(mu, sigma))\n\n#Now plot the distribution\nplt.legend(['Normal dist. ($\\mu=$ {:.2f} and $\\sigma=$ {:.2f} )'.format(mu, sigma)],\n            loc='best')\nplt.ylabel('Frequency')\nplt.title('estimated_generation_gwh distribution')\n\n#Get also the QQ-plot\nfig = plt.figure()\nres = stats.probplot(power_plants['estimated_generation_gwh'], plot=plt)\nplt.show()","49d9da99":"plt.figure(figsize=(8,8))\nsns.catplot(x=\"primary_fuel\",\n            y=\"capacity_mw\",\n            data=power_plants,\n            jitter=False,\n           )\nplt.show()","a6e1de86":"missing_df = df.isnull().sum(axis=0).reset_index()\nmissing_df.columns = ['column_name','missing_count']\nmissing_df = missing_df.ix[missing_df['missing_count']>0]\nmissing_df = missing_df.sort_values(by='missing_count')\n\nind = np.arange(missing_df.shape[0])\nwidth = 0.5\nfig,ax = plt.subplots(figsize=(12,18))\nrects = ax.barh(ind,missing_df.missing_count.values,color='blue')\nax.set_yticks(ind)\nax.set_yticklabels(missing_df.column_name.values, rotation='horizontal')\nax.set_xlabel(\"Count of missing values\")\nax.set_title(\"Number of missing values in each column\")\nplt.show()","35569bf0":"generation_gwh_years = [\"generation_gwh_2013\", \n                        \"generation_gwh_2014\", \n                        \"generation_gwh_2015\", \n                        \"generation_gwh_2016\",\n                        \"generation_gwh_2017\"]\n\npower_plants.loc[:, generation_gwh_years].sum()","8ce22b3e":"power_plants_df = power_plants.sort_values('capacity_mw',ascending=False).reset_index()\npower_plants_df=power_plants_df[['name','latitude','longitude','primary_fuel','owner','capacity_mw','estimated_generation_gwh',]]\npower_plants_df.head()","cfd76c4d":"world_d= dict(\n   name=list(power_plants['country']),\n    lat=list(power_plants['latitude']),\n   lon=list(power_plants['longitude']),\n   estimated_generation_gwh =list(power_plants['estimated_generation_gwh'])\n)\nworld_data = pd.DataFrame(dict([ (k,pd.Series(v)) for k,v in world_d.items() ]))\nworld_data = world_data.fillna(method='ffill') \n\n\n# create map and display it\nworld_map = folium.Map(location=[18, -66], zoom_start=9)\n\nfor lat, lon, value, name in zip(world_data['lat'], world_data['lon'], world_data['estimated_generation_gwh'], world_data['name']):\n    folium.CircleMarker([lat, lon],\n                        radius=10,\n                        popup = ('<strong>country<\/strong>: ' + str(name).capitalize() + '<br>'\n                                '<strong>estimated_generation_gwh<\/strong>: ' + str(value) + '<br>'),\n                        color='red',\n                        \n                        fill_color='red',\n                        fill_opacity=0.7 ).add_to(world_map)\nworld_map","96dd1009":"def plot_tif_img_on_map(file_name,lat,lon,zoom):\n    wor_map = folium.Map([lat, lon], zoom_start=zoom)\n    folium.raster_layers.ImageOverlay(\n        image=file_name,\n        bounds = [[18.6,-67.3,],[17.9,-65.2]],\n        colormap=lambda x: (1, 0, 0, x),\n    ).add_to(wor_map)\n    return wor_map","9f42ee93":"image = '\/kaggle\/input\/ds4g-environmental-insights-explorer\/eie_data\/s5p_no2\/s5p_no2_20180708T172237_20180714T190743.tif'\nband = rio.open(image).read(7)\nprint(band.shape)\nvmin, vmax = np.nanpercentile(band, (5,95))  # 5-95% stretch\nimg_plt = plt.imshow(band, cmap='Oranges', vmin=vmin, vmax=vmax)\nplt.show()\nlatitude=18.1429005246921; longitude=-65.4440010699994\nplot_tif_img_on_map(band,latitude,longitude,9)","91e96997":"image = '\/kaggle\/input\/ds4g-environmental-insights-explorer\/eie_data\/s5p_no2\/s5p_no2_20180707T174140_20180713T191854.tif'\nband = rio.open(image).read(7)\nprint(band.shape)\nvmin, vmax = np.nanpercentile(band, (5,95))  # 5-95% stretch\nimg_plt = plt.imshow(band, cmap='Oranges', vmin=vmin, vmax=vmax)\nplt.show()\nlatitude=18.1429005246921; longitude=-65.4440010699994\nplot_tif_img_on_map(band,latitude,longitude,9)","119c3c7d":"image = '\/kaggle\/input\/ds4g-environmental-insights-explorer\/eie_data\/gfs\/gfs_2018070106.tif'\nband = rio.open(image).read(6)\nvmin, vmax = np.nanpercentile(band, (5,95))  # 5-95% stretch\nimg_plt = plt.imshow(band, cmap='Oranges', vmin=vmin, vmax=vmax)\nplt.show()\nlatitude=18.1429005246921; longitude=-65.4440010699994\nplot_tif_img_on_map(band,latitude,longitude,9)","2dc6cc7a":"from rasterio.plot import show\nimage = '\/kaggle\/input\/ds4g-environmental-insights-explorer\/eie_data\/gldas\/gldas_20180701_0300.tif'\n\n#load the image\nband = rio.open(image)\nshow(band)\n#All Metadata for the whole raster dataset\nband.meta","2eeb1daa":"image = '\/kaggle\/input\/ds4g-environmental-insights-explorer\/eie_data\/gfs\/gfs_2018070106.tif'\n\n#load the image\nband = rio.open(image)\nshow(band)\n#All Metadata for the whole raster dataset\nband.meta","ffe7bb15":"image = '\/kaggle\/input\/ds4g-environmental-insights-explorer\/eie_data\/s5p_no2\/s5p_no2_20180718T173458_20180724T193016.tif'\n\n#load the image\nband = rio.open(image)\nshow(band)\n#All Metadata for the whole raster dataset\nband.meta","b11c524f":"quantity_of_electricity_generated = power_plants_df['estimated_generation_gwh'][29:30].values\nprint('Quanity of Electricity Generated: ', quantity_of_electricity_generated)","508ecaf3":"image = '\/kaggle\/input\/ds4g-environmental-insights-explorer\/eie_data\/s5p_no2\/s5p_no2_20180718T173458_20180724T193016.tif'\n\naverage_no2_emission = [np.average(tiff.imread(image))]\nprint('Average NO2 emissions value: ', average_no2_emission)","fbe85cb1":"simplified_emissions_factor = float(average_no2_emission\/quantity_of_electricity_generated)\nprint('Simplified emissions factor (S.E.F.) for a single power plant on the island of Vieques =  \\n\\n', simplified_emissions_factor, 'S.E.F. units')","6b252b6f":"* ***this image in gfs image dataset are in 6 channels***","09211f12":"* **lets take a look at the 'estimated_generation_gwh' as it is the estimated annual electricity generation in gigawatt-hours**","28241139":"* **Hydro and gas stands with more than others**\n\n* **Seem like Oli,Gas and the Coal sre polluted Primary_fule**","6c647611":"* **all this generation_gwh_years can be Droped**","1c729b1d":"* **ok now lets chek for the missing values and the columns that should be Droped**","ab1c11c6":"the same we qill check for the Sentinel 5P OFFL NO2 by EU\/ESA\/Copernicus (s5p_no2)","b01b282a":"* **distribution of 'primary_fuel' with the 'capacity_mw'**","068ba08e":"***Objective***\n\nThis Data Science for Good Competition intends to use **remote sensing** techniques to understand Environmental Emissions. Since the whole concept of Satellite Imagery and can be a little overwhelming, this is just an introductory kernel, where I try to explain the various terms and datasets related to satellite Imagery.","7064e310":"the same we qill check for the Global Land Data Assimilation System by NASA(gfs)","875d474d":"* ***the images in s5p_no2 data set is with 12 channels*** ","538e1fe9":"**Problem Statement: Measuring Emissions factors from Satellite Data ?**\n\nWhat is an emission factor?\n\nThe release of GHG into the atmosphere depends mainly on the activity and the product. In order to estimate GHG emissions per unit of available activity, we need to use a factor called emission factor (EF).\n\nFor example: how many  kg of GHG are emitted by 1 kWh of natural gas ?\n\nThus, the emission factor is the sum of emissions of CO2eq of the human activity described as mass unit of CO2eq \/ reference flows. For example: the EF for the natural gas is the sum of the combustion (0.205 kg CO2eq \/ kWh ICV) and the upstream (i.e. the production and transport of the gas) (0.0389 kg CO2eq \/ kWh ICV).\n\n![](https:\/\/cdn-images-1.medium.com\/max\/800\/1*3ToZXr2ObHrT5vlTvxU7pg.png) \n\n\nThe general equation for emissions estimation is:\n\n**E = A x EF x (1-ER\/100)**\n\nwhere:\n\nE = emissions; A = activity rate; EF = emission factor, and ER =overall emission reduction efficiency, ","c7349802":"* **this is the just sample Emission Factor cal **\n\n**to find the Emission Factor we have to get all the varablein the formule\n\n**E = A x EF x (1-ER\/100)**\n\nwhere:\n\n**E = emissions; A = activity rate; EF = emission factor, and ER =overall emission reduction efficience \n**\n**so to get all this factors i think we need to include more data and see if it\u2019s possible to use remote sensing techniques to better model emissions factors,and to  develop a methodology to calculate an average historical emissions factor for electricity generation in a sub-national region.**\n\n**planning to make a  methodology which is more accurate will soon update**\n\n**will work more and soon will update**\n\n**please upvote if you like that can make me to work more motive :)**","9019594f":"* **Now lets make some visualization and understand the data :)**","d2da50dc":"* **Now lets move on the other Satellite images data set **\n\nDATASET SELECTION STARTER PACK\n\n* Global Power Plant database by WRI\n* Sentinel 5P OFFL NO2 by EU\/ESA\/Copernicus\n* Global Forecast System 384-Hour Predicted Atmosphere Data by NOAA\/NCEP\/EMC\n* Global Land Data Assimilation System by NASA","cd04a3f7":"* **Seem like the distribution is not good lets apply log transformation and look**","51261423":"* **Now as we have Latitude and longitude we check on the map and see what we will get**","a8aaefcd":"* get the lat and log from .geo","13429bfd":"* Driver : Data Format\n* dtype : data type\n* width and Height : The dimensions of the image in  **GFS** **image data**  are : 475 X 148\n* count : There are 12 bands in the image\n* crs: Coordinate Reference Systems which refers to the way in which spatial data that represent the earth\u2019s surface.A particular CRS can be referenced by its EPSG code\n* transform : Affine transform (how raster is scaled, rotated, skewed, and\/or translated)\n\n***this in gldas image dataset is with 12 channels iamge***","6bdfa464":"* **So Other_fuel1,other_fuel2,other_fuel3 can be droped**","e658ee6e":"* **This looks good :)**","801da188":"* **ok its better to check the property of the TIF images -:)**","d596fe7e":"* **Here on the above map if we want to know the  estimated annual electricity generation in gigawatt-hours of the city just clik in the RED cricle :)**"}}