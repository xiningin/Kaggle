{"cell_type":{"0ef88518":"code","bb12f6ab":"code","f5f81be2":"code","fc0f8e16":"code","6964d1e7":"code","e22423f9":"code","bedb050f":"code","8bf544f9":"code","b841d3c5":"code","6c3e6029":"code","5d8b70c1":"code","280f9258":"code","522f3584":"markdown","ab4103ef":"markdown","6a07fffd":"markdown","0cfa26b9":"markdown","70d50e5d":"markdown","446deb3c":"markdown","b16fc18e":"markdown","49a1d1a6":"markdown","6325f6e1":"markdown","dc09f876":"markdown","b7434b27":"markdown","e3a927b5":"markdown","da5fd6d0":"markdown"},"source":{"0ef88518":"!pip install https:\/\/repo.radtorch.com\/archive\/v0.1.3-beta.zip -q","bb12f6ab":"from radtorch import pipeline, datautils\nimport pandas as pd","f5f81be2":"# mix and match the data\nnormal_files_1 = datautils.list_of_files('\/kaggle\/input\/covid19-xray-dataset-train-test-sets\/xray_dataset_covid19\/train\/NORMAL\/')\nnormal_files_2 = datautils.list_of_files('\/kaggle\/input\/covid19-xray-dataset-train-test-sets\/xray_dataset_covid19\/test\/NORMAL\/')\nnormal_list = normal_files_1+normal_files_2\n\ncovid_file_1 = datautils.list_of_files('\/kaggle\/input\/covid19-xray-dataset-train-test-sets\/xray_dataset_covid19\/train\/PNEUMONIA\/')\ncovid_files_2 = datautils.list_of_files('\/kaggle\/input\/covid19-xray-dataset-train-test-sets\/xray_dataset_covid19\/test\/PNEUMONIA\/')\ncovid_list = covid_file_1+covid_files_2\n\nnormal_label = ['normal']*len(normal_list)\ncovid_label = ['covid']*len(covid_list)\n\nall_files = normal_list+covid_list\nall_labels = normal_label+covid_label\n\nlabel_df = pd.DataFrame(list(zip(all_files, all_labels)), columns=['IMAGE_PATH', 'IMAGE_LABEL'])\n\n\n#shuffle\nlabel_df = label_df.sample(frac=1).reset_index(drop=True)\n\nlabel_df\n\n","fc0f8e16":"model_comparison = pipeline.Compare_Image_Classifier(\n    data_directory='\/kaggle\/input\/covid19-xray-dataset-train-test-sets\/xray_dataset_covid19\/train\/',\n    is_dicom=False,\n    label_from_table=True,\n    table_source=label_df,\n    model_arch=['alexnet', 'resnet50', 'vgg16', 'vgg16_bn', 'wide_resnet50_2'],\n    train_epochs=[20],\n    balance_class=[True],\n    normalize=[False],\n    valid_percent=[0.1],\n    learning_rate = [0.00001]\n\n)","6964d1e7":"model_comparison.grid()","e22423f9":"model_comparison.dataset_info()","bedb050f":"model_comparison.sample()","8bf544f9":"model_comparison.run()","b841d3c5":"model_comparison.metrics()","6c3e6029":"model_comparison.roc()","5d8b70c1":"model_comparison.best()","280f9258":"model_comparison.best(path='best_classifier', export_classifier=True)\nmodel_comparison.best(path='best_model', export_model=True)","522f3584":"### Create the pipeline instance to compare different model architectures","ab4103ef":"### Export best classifier","6a07fffd":"### Train and Analyze the image classifiers","0cfa26b9":"### Import","70d50e5d":"### Install","446deb3c":"### Display models ROC","b16fc18e":"### Show best classifier","49a1d1a6":"![](https:\/\/www.charlescountymd.gov\/Home\/ShowImage?id=4496)\n# COVID-19 CXR Classifier using [RADTorch](https:\/\/www.radtorch.com)","6325f6e1":"### Display list of created image classifiers to be tested","dc09f876":"### Display training metrics","b7434b27":"### Show sample from dataset","e3a927b5":"### Mix dataset and create a new label dataframe","da5fd6d0":"### Show Dataset info"}}