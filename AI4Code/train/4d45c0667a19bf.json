{"cell_type":{"12d07f45":"code","f72591c4":"code","2e5b2e30":"code","73ebe4ed":"code","31f5f8a8":"code","164387f5":"code","b7a04231":"code","22091350":"code","9cb30c80":"code","8276be56":"code","366cfe82":"code","d50c1fce":"code","cfda40a1":"code","1fdddbb3":"markdown","52f051e3":"markdown"},"source":{"12d07f45":"import numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.tree import DecisionTreeRegressor","f72591c4":"sns.set_style('darkgrid')\nsns.set_context('talk')\n%config InlineBackend.figure_format = 'retina'","2e5b2e30":"x = np.linspace(0, 10, 100)\ny = np.sin(0.5 * x) + np.sin(2 * x)\nx_test = np.linspace(10, 12, 20)\ny_test = np.sin(0.5 * x_test) + np.sin(2 * x_test)","73ebe4ed":"plt.scatter(x, y, label='train')\nplt.scatter(x_test, y_test, label='test')\nplt.legend();","31f5f8a8":"idxs = np.random.permutation(np.arange(100))\nvalid_idxs = idxs[:20]\ntrain_idxs = idxs[20:]\nx_train = x[train_idxs]\ny_train = y[train_idxs]\nx_valid = x[valid_idxs]\ny_valid = y[valid_idxs]","164387f5":"plt.scatter(x_train, y_train, label='train')\nplt.scatter(x_test, y_test, label='test')\nplt.scatter(x_valid, y_valid, label='valid')\nplt.legend();","b7a04231":"idxs = np.arange(100)\nvalid_idxs = idxs[-20:]\ntrain_idxs = idxs[:-20]\nx_train = x[train_idxs]\ny_train = y[train_idxs]\nx_valid = x[valid_idxs]\ny_valid = y[valid_idxs]","22091350":"plt.scatter(x_train, y_train, label='train')\nplt.scatter(x_test, y_test, label='test')\nplt.scatter(x_valid, y_valid, label='valid')\nplt.legend();","9cb30c80":"x = np.random.uniform(size=30)\ny = x + np.random.randn(30) * 0.2\n\nx_valid = np.random.uniform(size=10)\ny_valid = x_valid + np.random.randn(10) * 0.2","8276be56":"plt.scatter(x, y)\nplt.scatter(x_valid, y_valid);","366cfe82":"dt = DecisionTreeRegressor(min_samples_leaf=1)\ndt.fit(x[:, None], y)","d50c1fce":"xx = np.linspace(0, 1, 500)\npreds = dt.predict(xx[:, None])","cfda40a1":"plt.scatter(x, y)\nplt.scatter(x_valid, y_valid)\nplt.plot(xx, preds, c='g');","1fdddbb3":"## Decision Tree Overfitting","52f051e3":"## Validation data set"}}