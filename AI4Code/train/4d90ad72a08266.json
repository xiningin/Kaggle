{"cell_type":{"83e327a1":"code","cc9919dc":"code","2724b5d6":"code","a6bebdac":"code","5aab4d2f":"code","0a3b5547":"code","c86da7b1":"code","94ae2ace":"code","9298a04b":"code","43c9f284":"code","e7dc423e":"code","8d673c95":"code","d0bfaaec":"code","ce888dce":"code","615d7a4b":"code","c8592f95":"code","395aa5ef":"code","3fa64840":"code","c76bc760":"code","25573ec3":"code","4bef443c":"code","cbce79e3":"code","46c9bdd2":"code","a6dcc9e5":"code","f0c5e2c1":"code","f065588f":"code","d123100e":"code","63ad7dd6":"code","ac628b0f":"code","049fef23":"code","b01848bb":"code","dfa389ad":"code","be77be4d":"code","b4cc0044":"code","7343ee28":"code","67413411":"code","db534e1c":"code","9b8d2e6b":"markdown","60661092":"markdown","d9033c7f":"markdown","3d21f7e0":"markdown","e151e979":"markdown","7c1f391b":"markdown","1e42942d":"markdown","71d9487c":"markdown","f4d17438":"markdown","53923a3c":"markdown","c6fd83e0":"markdown","bc9ce6b6":"markdown","f3bea36f":"markdown","219ae2ad":"markdown","a24c7012":"markdown"},"source":{"83e327a1":"#importing all the necessary libraries\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport warnings\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import mean_squared_error,accuracy_score\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.tree import DecisionTreeRegressor\nfrom sklearn.svm import SVR\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.preprocessing import StandardScaler,MinMaxScaler,LabelEncoder\n\nwarnings.filterwarnings(\"ignore\")\n","cc9919dc":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","2724b5d6":"#importing the data\ndf = pd.read_csv(\"\/kaggle\/input\/student-grade-prediction\/student-mat.csv\")\ndf.info()","a6bebdac":"#creating a correlation matrix to understand the correlation between the features\ndf.corr()","5aab4d2f":"#using seaborn heatmap to analyse the correlation graphically\nimport seaborn as sns\nsns.heatmap(df.corr(),xticklabels=df.corr().columns,yticklabels=df.corr().columns)","0a3b5547":"#checking \ndf.describe()","c86da7b1":"#checking data types of column values and presence of null values(if any)\ndf.info()","94ae2ace":"#distribution of female to male in the given data\ntotal_count=df['sex'].value_counts()\nplt.pie(x=total_count,colors=['lightskyblue','red'], labels=['Male','Female'],autopct='%1.1f%%',shadow=True)\nplt.show()","9298a04b":"#plot on traveltime vs G3 based on sex \ng=sns.boxplot(x='traveltime',y='G3',data=df,hue='sex')\ng.set(xticklabels=['near','moderate','far','very far'])\nplt.show()","43c9f284":"#Father's education vs final score\nsns.boxplot(x='Fedu',y='G3',data=df)","e7dc423e":"#countplot of age based on sex\nsns.countplot('age',hue='sex',data=df)","8d673c95":"#failures vs final score\ng=sns.swarmplot(x='failures',y='G3',data=df)\ng.set(xticklabels=['very low','low','moderate','high','very high'])\nplt.show()","d0bfaaec":"#freetime vs final Score\ng=sns.boxplot(x='freetime',y='G3',data=df)\ng.set(xticklabels=['very low','low','moderate','high','very high'])\nplt.show()","ce888dce":"#outing vs final score\ng=sns.swarmplot(x='goout',y='G3',data=df)\ng.set(xticklabels=['very low','low','moderate','high','very high'])\nplt.show()","615d7a4b":"sns.barplot(x='age',y='absences',data=df)","c8592f95":"#mother's job plot\nsns.countplot('Mjob',data=df)","395aa5ef":"#plot of age vs final score based on pursuing higher education\nsns.barplot(x='age',y='G3',data=df,hue='higher')","3fa64840":"#health vs final score barplot\ng=sns.boxplot(x='health',y='G3',data=df)\ng.set(xticklabels=['worst','low','moderate','good','excellent'])\nplt.show()","c76bc760":"#countplot of age vs final score based on being paid\nsns.barplot(x='age',y='G3',data=df,hue='paid')","25573ec3":"#boxplot of studytime vs final score based on internet usage\ng=sns.boxplot(x='studytime',y='G3',hue='internet',data=df)\ng.set(xticklabels=['very low','low','high','very high'])\nplt.show()","4bef443c":"g=sns.boxplot(x='famrel',y='Walc',data=df)\ng.set(xticklabels=['very low','low','moderate','high','very high'])\nplt.show","cbce79e3":"#age vs final score based on romantic life\nsns.barplot(x='age',y='G3',hue='romantic',data=df)","46c9bdd2":"g=sns.countplot(x='goout',hue='romantic',data=df)\ng.set(xticklabels=['very low','low','moderate','high','very high'])\nplt.show()","a6dcc9e5":"#extracting major features only\ndf_features=df[['G1','G2','Medu','Fedu','studytime']]\ndf_features.head()\ndf_label=df[['G3']]","f0c5e2c1":"#getting values as numpy arrays for splitting\nX=df_features.values\ny=df_label.values","f065588f":"#splitting the X and y values\nX_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.3,random_state=0)","d123100e":"#performing the regression on various models and storing the scores\nscores={}\ndef classifier():\n    dict_models={\n        'Linear Regression':LinearRegression(),\n        'Support Vector Machine':SVR(kernel='linear',degree=1),\n        'Decision Tree':DecisionTreeRegressor(criterion='mae'),\n        'Random Forest':RandomForestRegressor(n_estimators=150,criterion='mse',verbose=0)\n    }\n    X_train.shape\n    y_train.shape\n    \n    for key,value in dict_models.items():\n        regression=value.fit(X_train,y_train)\n        score=cross_val_score(regression,X,y,scoring='neg_mean_squared_error')\n        score=np.sqrt(-score.mean())\n        scores[key]=score\n        print(\n            f'Model Name: {key},RMSE score: {(score.mean())}')","63ad7dd6":"classifier()","ac628b0f":"#scaling the values(although it doesn't change the rmse)\nfrom sklearn.preprocessing import MinMaxScaler\nsc_s=MinMaxScaler()\nX_train=sc_s.fit_transform(X_train)\nX_test=sc_s.transform(X_test)","049fef23":"classifier()","b01848bb":"#labelling the categorical column values of the dataframe\nfor column in df.columns:\n    if df[column].dtype=='object':\n        df[column]=LabelEncoder().fit_transform(df[column])","dfa389ad":"#extracting all the features this time for evaluation\n#Only Random Forest and Decision Tree are used because others require one-hot-encoding, which we will cover\n#in future notebooks\nX=df.iloc[:,:-1].values\ny=df.iloc[:,-1].values\n\nX_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.3,random_state=0)\n","be77be4d":"#Using Random Forest Regressor\nnew=RandomForestRegressor()\nmodel=new.fit(X_train,y_train)\nscore=cross_val_score(model,X,y,scoring='neg_mean_squared_error')\nscore=np.sqrt(-score.mean())\nscores['Random Forest Labled']=score","b4cc0044":"#Using Decision Tree Regressor\ntest=DecisionTreeRegressor()\nmodel=new.fit(X_train,y_train)\nscore=cross_val_score(model,X,y,scoring='neg_mean_squared_error')\nscore=np.sqrt(-score.mean())\nscores['Decision Tree Labled']=score","7343ee28":"#Converting scores to datafram\nscores=(pd.Series(scores)).to_frame()","67413411":"#renaming the column names\nscores=scores.rename(columns={0:'RMSE Error'})\nscores","db534e1c":"#plotting the scores of each model for better comparison\nscores.plot(kind='bar')","9b8d2e6b":"Contrary to popular believe, students with more free time have better score than those with less free time.","60661092":"G3, apart from G1 and G2, is most correlated with Mother's Education(Medu), Father's Education(Fedu), and studytime.","d9033c7f":"### Importing and checking data","3d21f7e0":"### Exploratory Data Analysis","e151e979":"### Visualing and comparing Models","7c1f391b":"Interesting plot here,as those students score higher whose their Father's education is lower, when compared to those whose Fathers have more education","1e42942d":"Most of the students, according to the plot, go out frequently,and still manage to score good marks(above average)","71d9487c":"Most of the students who go out are very likely to be in a romantic relationship","f4d17438":"Students with romantic relationships score less than those without, with age of 20 being an exception. The students mature by 20\nand handle both the things well.","53923a3c":"### Model Preparation","c6fd83e0":"Students who study more and habve internet usage have better final score, as expected","bc9ce6b6":"Interestingly, the students with worst health score more than those with better health status","f3bea36f":"There are 33 columns in this data. These columns signify the following:\n\n**school** - student's school (binary: 'GP' - Gabriel Pereira or 'MS' - Mousinho da Silveira)\n**sex** - student's sex (binary: 'F' - female or 'M' - male)\n**age** - student's age (numeric: from 15 to 22)\n**address** - student's home address type (binary: 'U' - urban or 'R' - rural)\n**famsize** - family size (binary: 'LE3' - less or equal to 3 or 'GT3' - greater than 3)\n**Pstatus** - parent's cohabitation status (binary: 'T' - living together or 'A' - apart)\n**Medu** - mother's education (numeric: 0 - none, 1 - primary education (4th grade), 2 \u00e2\u20ac\u201c 5th to 9th grade, 3 \u00e2\u20ac\u201c secondary education or 4 \u00e2\u20ac\u201c higher education)\n**Fedu** - father's education (numeric: 0 - none, 1 - primary education (4th grade), 2 \u00e2\u20ac\u201c 5th to 9th grade, 3 \u00e2\u20ac\u201c secondary education or 4 \u00e2\u20ac\u201c higher education)\n**Mjob** - mother's job (nominal: 'teacher', 'health' care related, civil 'services' (e.g. administrative or police), 'at_home' or 'other')\n**Fjob** - father's job (nominal: 'teacher', 'health' care related, civil 'services' (e.g. administrative or police), 'at_home' or 'other')\n**reason** - reason to choose this school (nominal: close to 'home', school 'reputation', 'course' preference or 'other')\n**guardian** - student's guardian (nominal: 'mother', 'father' or 'other')\n**traveltime** - home to school travel time (numeric: 1 - 1 hour)\n**studytime** - weekly study time (numeric: 1 - 10 hours)\n**failures** - number of past class failures (numeric: n if 1<=n<3, else 4)\n**schoolsup** - extra educational support (binary: yes or no)\n**famsup** - family educational support (binary: yes or no)\n**paid** - extra paid classes within the course subject (Math or Portuguese) (binary: yes or no)\n**activities** - extra-curricular activities (binary: yes or no)\n**nursery** - attended nursery school (binary: yes or no)\n**higher** - wants to take higher education (binary: yes or no)\n**internet** - Internet access at home (binary: yes or no)\n**romantic** - with a romantic relationship (binary: yes or no)\n**famrel** - quality of family relationships (numeric: from 1 - very bad to 5 - excellent)\n**freetime** - free time after school (numeric: from 1 - very low to 5 - very high)\n**goout** - going out with friends (numeric: from 1 - very low to 5 - very high)\n**Dalc** - workday alcohol consumption (numeric: from 1 - very low to 5 - very high)\n**Walc** - weekend alcohol consumption (numeric: from 1 - very low to 5 - very high)\n**health** - current health status (numeric: from 1 - very bad to 5 - very good)\n**absences** - number of school absences (numeric: from 0 to 93)\n\nThese grades are related with the course subject, Math or Portuguese:\n\n**G1** - first period grade (numeric: from 0 to 20)\n**G2** - second period grade (numeric: from 0 to 20)\n**G3** - final grade (numeric: from 0 to 20, output target)","219ae2ad":"The absences increases steadily till 19, but reduce by 20 and 21. By the time they are 22, they lose all hope and dont bother\ncoming alltogether","a24c7012":"Males with smaller traveltime scored better than those who required more time to travel. The distribution in case of females is less as the travel time increases."}}