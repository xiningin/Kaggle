{"cell_type":{"1ee1e105":"code","0b866c4c":"code","d8651d46":"code","c524b6d8":"code","451339fa":"code","17e2a836":"code","e6d99e11":"code","b29aee39":"code","d686e4ac":"code","9b66d6d6":"markdown","05e57eb4":"markdown"},"source":{"1ee1e105":"import numpy as np\nimport matplotlib.pyplot as plt\nimport cv2\nimport pandas as pd","0b866c4c":"def show(image, title=None):\n    if not title: title = img.shape \n    plt.title(f\"{title}\")\n    plt.imshow(image, cmap='gray')\n    plt.colorbar()\n    plt.show()","d8651d46":"\"\"\"\nload unclear low contrast image\n\"\"\"\n\nimg = cv2.imread(\"..\/input\/low-contrast\/low_contrast_deers.jpeg\")\nimg = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)\n\nshow(img)","c524b6d8":"def plot_histogram(grey_img):\n    data = grey_img.flatten()\n    plt.close()\n    plt.hist(data)\n    plt.show()","451339fa":"plot_histogram(img)","17e2a836":"data = img.flatten()\nunique_vals, cnts = np.unique(data, return_counts=True)\n\nprobabs = cnts\/np.sum(cnts) # pdf\ncdf = np.cumsum(probabs)\n\nSCALE_FACTOR = 20\nnew_unique_values = np.ceil(cdf*SCALE_FACTOR) # ceiled-scaled-cdf\n\npd.DataFrame({\n    \"unique values\": unique_vals,\n    \"probabilities\": probabs,\n    \"cdf\": cdf,\n    \"new unique values (ceiled-scaled-cdf)\": new_unique_values\n})","e6d99e11":"\"\"\"\nhistogram normalized\n\"\"\"\n\nplt.hist(new_unique_values)\n\nplt.title(f\"New values lie between 0-{SCALE_FACTOR}\")\nplt.show()","b29aee39":"for unique_val, new_unique_val in zip(unique_vals, new_unique_values):\n\n    ridxs, cidsx = np.where(img==unique_val)\n\n    for r, c in zip(ridxs, cidsx):\n        img[r,c] = new_unique_val","d686e4ac":"\"\"\"\nclear high contrast image\n\"\"\"\n\nshow(img)","9b66d6d6":"## Histogram Equalisation\n\n","05e57eb4":"**STEPS**\n\n- Find cdf of unique values in data\n- Scale the cdf by some factor\n- Replace old unique values by ceil values of scaled cdf\n\n**USES**\n\n> - *Preprocessing step to convert to normal\/uniform distribution*\n>\n> - *Enhance contrast of images (suitable for CNN inputs)*"}}