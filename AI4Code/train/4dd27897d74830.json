{"cell_type":{"f8f54742":"code","5d92fc17":"code","9deb36e9":"code","f8bd5266":"code","45a338f2":"code","6f2b5f91":"code","17fddf6a":"code","f3b17724":"code","97bd5c1b":"code","29d3370a":"code","f271208e":"code","e3a8e32f":"code","4e058a02":"code","22406a2f":"code","190f88bc":"code","ea6012d5":"code","04a2bc9a":"code","e936165d":"code","dce17f31":"code","a2d753bd":"code","22cba3d1":"code","2773f0e2":"code","67cd08c1":"code","31443c4d":"code","7e725e7c":"code","ea7096ae":"code","b9da7fbc":"code","14aad1ca":"code","02582ae6":"code","00a80cdb":"code","3cc14a07":"code","b687f9c9":"code","ce540222":"code","e9d7090d":"code","470f6012":"code","52b005a7":"markdown","2d2a805e":"markdown","740c8604":"markdown","8a78b2ea":"markdown","72f7d4a6":"markdown","13d88585":"markdown","4e50b045":"markdown","032e988a":"markdown","869608f4":"markdown","45c9abe4":"markdown","d51cd160":"markdown"},"source":{"f8f54742":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.model_selection import train_test_split\nfrom wordcloud import WordCloud","5d92fc17":"df = pd.read_csv(\"..\/input\/sentiment-analysis-for-financial-news\/all-data.csv\",encoding='ISO-8859-1')","9deb36e9":"df.head()","f8bd5266":"df = df.rename(columns={'neutral':'sentiment','According to Gran , the company has no plans to move all production to Russia , although that is where the company is growing .':'statement'})","45a338f2":"df.shape","6f2b5f91":"df.info()","17fddf6a":"df.describe()","f3b17724":"df.drop_duplicates(subset=['statement'],keep='first',inplace=True)\ndf.info()","97bd5c1b":"df.describe()","29d3370a":"text = \" \".join([x for x in df.statement])\n\nwordcloud = WordCloud(background_color='white').generate(text)\n\nplt.figure(figsize=(8,6))\nplt.imshow(wordcloud,interpolation='bilinear')\nplt.axis('off')\nplt.show()","f271208e":"## for neutral\n\ntext = \" \".join([x for x in df.statement[df.sentiment=='neutral']])\n\nwordcloud = WordCloud(background_color='white').generate(text)\n\nplt.figure(figsize=(8,6))\nplt.imshow(wordcloud,interpolation='bilinear')\nplt.axis('off')\nplt.show()","e3a8e32f":"## for positive\n\ntext = \" \".join([x for x in df.statement[df.sentiment=='positive']])\n\nwordcloud = WordCloud(background_color='white').generate(text)\n\nplt.figure(figsize=(8,6))\nplt.imshow(wordcloud,interpolation='bilinear')\nplt.axis('off')\nplt.show()","4e058a02":"## for negative\n\ntext = \" \".join([x for x in df.statement[df.sentiment=='negative']])\n\nwordcloud = WordCloud(background_color='white').generate(text)\n\nplt.figure(figsize=(8,6))\nplt.imshow(wordcloud,interpolation='bilinear')\nplt.axis('off')\nplt.show()","22406a2f":"sns.countplot(df.sentiment)","190f88bc":"df['sentiment'].value_counts()","ea6012d5":"train,eva = train_test_split(df,test_size = 0.2)","04a2bc9a":"!pip install simpletransformers","e936165d":"\nfrom simpletransformers.classification import ClassificationModel\n\n\n# Create a TransformerModel\nmodel = ClassificationModel('bert', 'bert-base-cased', num_labels=3, args={'reprocess_input_data': True, 'overwrite_output_dir': True},use_cuda=False)\n","dce17f31":"# 0,1,2 : positive,negative\ndef making_label(st):\n    if(st=='positive'):\n        return 0\n    elif(st=='neutral'):\n        return 2\n    else:\n        return 1\n    \ntrain['label'] = train['sentiment'].apply(making_label)\neva['label'] = eva['sentiment'].apply(making_label)\nprint(train.shape)","a2d753bd":"train_df = pd.DataFrame({\n    'text': train['statement'][:1500].replace(r'\\n', ' ', regex=True),\n    'label': train['label'][:1500]\n})\n\neval_df = pd.DataFrame({\n    'text': eva['statement'][-400:].replace(r'\\n', ' ', regex=True),\n    'label': eva['label'][-400:]\n})","22cba3d1":"model.train_model(train_df)","2773f0e2":"result, model_outputs, wrong_predictions = model.eval_model(eval_df)","67cd08c1":"result","31443c4d":"model_outputs","7e725e7c":"lst = []\nfor arr in model_outputs:\n    lst.append(np.argmax(arr))","ea7096ae":"true = eval_df['label'].tolist()\npredicted = lst","b9da7fbc":"import sklearn\nmat = sklearn.metrics.confusion_matrix(true , predicted)\nmat","14aad1ca":"df_cm = pd.DataFrame(mat, range(3), range(3))\n\nsns.heatmap(df_cm, annot=True) \nplt.show()","02582ae6":"sklearn.metrics.classification_report(true,predicted,target_names=['positive','neutral','negative'])","00a80cdb":"sklearn.metrics.accuracy_score(true,predicted)","3cc14a07":"def get_result(statement):\n    result = model.predict([statement])\n    pos = np.where(result[1][0] == np.amax(result[1][0]))\n    pos = int(pos[0])\n    sentiment_dict = {0:'positive',1:'negative',2:'neutral'}\n    print(sentiment_dict[pos])\n    return","b687f9c9":"## neutral statement\nget_result(\"According to Gran , the company has no plans to move all production to Russia , although that is where the company is growing .\")","ce540222":"## positive statement\nget_result(\"According to the company 's updated strategy for the years 2009-2012 , Basware targets a long-term net sales growth in the range of 20 % -40 % with an operating profit margin of 10 % -20 % of net sales .\")","e9d7090d":"## negative statement\nget_result('Sales in Finland decreased by 2.0 % , and international sales decreased by 9.3 % in terms of euros , and by 15.1 % in terms of local currencies .')","470f6012":"statement = \"Give your statement\"\nget_result(statement)","52b005a7":"# Reading Data","2d2a805e":"# Sentiment Analysis for Financial Statements","740c8604":"ref : \n1. https:\/\/github.com\/ThilinaRajapakse\/simpletransformers#minimal-start-for-multiclass-classification\n2. https:\/\/towardsdatascience.com\/simple-transformers-introducing-the-easiest-bert-roberta-xlnet-and-xlm-library-58bf8c59b2a3\n","8a78b2ea":"# WordCloud","72f7d4a6":"# Building a model","13d88585":"# Count plot of sentiments","4e50b045":"# Test and Train dataframes","032e988a":"![image.png](attachment:image.png)","869608f4":"# Give your statement","45c9abe4":"# Model Evaluation","d51cd160":"# Importing Libraries"}}