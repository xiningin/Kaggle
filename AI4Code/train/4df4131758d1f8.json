{"cell_type":{"86ccc6ef":"code","5e306397":"code","533964c8":"code","351d0a26":"code","8e73e1b7":"code","96c9800b":"code","f73abcb1":"code","f7f15dfc":"code","469e1340":"code","fcb8abd2":"code","ae092a7e":"code","5fa9d053":"code","76c31f98":"code","ef45430e":"code","7091fdcb":"code","27441173":"code","3bd0d6f7":"code","10b81851":"code","8fabfe37":"code","476b2062":"code","db236786":"code","b7d88610":"code","7a32a005":"code","9f280d29":"code","cc2739fd":"code","911f51b2":"code","be449245":"code","7b50cb2b":"code","544a762c":"code","7ae5fc33":"code","6fbeffd2":"code","3471c246":"code","9e5b06a7":"code","a5ff649f":"code","95a905f9":"code","098c162c":"code","00afe34e":"code","973cd8ca":"code","e7d9e580":"code","252c3d06":"code","d954f49c":"code","6eca3a59":"markdown","5fca8556":"markdown","494a4038":"markdown","4080d040":"markdown","ffdd73aa":"markdown","90ae221d":"markdown","63fd005f":"markdown","5e6560c7":"markdown","c3adac60":"markdown"},"source":{"86ccc6ef":"import numpy as np # linear algebra\nimport pandas as pd \nimport matplotlib.pyplot as plt\nfrom matplotlib.pyplot import show\nimport seaborn as sns","5e306397":"# Read the data\ndf = pd.read_csv(\"\/kaggle\/input\/ibm-hr-analytics-attrition-dataset\/WA_Fn-UseC_-HR-Employee-Attrition.csv\")","533964c8":"# Print the data\ndf.head()","351d0a26":"# Check for the summary statistics\ndf.describe()","8e73e1b7":"# Plot the histogram\ndf.hist(bins=20,figsize=(20,20))","96c9800b":"# Check for data types and missing values\ndf.info()","f73abcb1":"# Drop unnecessary columns\ndf.drop([\"EmployeeNumber\",\"EmployeeCount\",\"StandardHours\",\"Over18\"],axis=1,inplace=True)","f7f15dfc":"# Check for nulls\ndf.isnull().sum().plot.bar()","469e1340":"# Plot Co-relation matrix\nf, ax = plt.subplots(figsize=(20, 20))\nsns.heatmap(df.corr(), annot=True)","fcb8abd2":"# Plots\nplt.figure(figsize=[20,20])\nplt.subplot(611)\nsns.countplot(x='JobRole',hue='Attrition',data=df)\nplt.subplot(612)\nsns.countplot(x='HourlyRate',hue='Attrition',data=df)\nplt.subplot(613)\nsns.countplot(x='JobInvolvement',hue='Attrition',data=df)\nplt.subplot(614)\nsns.countplot(x='JobLevel',hue='Attrition',data=df)\nplt.subplot(615)\nsns.countplot(x='DistanceFromHome',hue='Attrition',data=df)\nplt.subplot(616)\nsns.countplot(x='Age',hue='Attrition',data=df)","ae092a7e":"# Plot the count of Attrition\nplt.figure(figsize=[12,12])\ntotal = float(len(df)) \nax=sns.countplot(df[\"Attrition\"])\n# set individual bar lables using above list\nfor i in ax.patches:\n    # get_x pulls left or right; get_height pushes up or down\n    ax.text(i.get_x()+0.3, i.get_height()+5,\n        str(i.get_height()), fontsize=15,\n    color='dimgrey')\n        # get_x pulls left or right; get_height pushes up or down\n    ax.text(i.get_x()+0.3, i.get_height()+35,\n            '{:1.2f}%'.format(i.get_height()\/total*100), fontsize=15,\n    color='red')\nshow()\n","5fa9d053":"# What is the median salary of each job roles?\n\nplt.figure(figsize=(15,10))\nsns.boxplot(x=df.MonthlyIncome,y=df.JobRole)","76c31f98":"# Does people with higher salary work longer and the vice versa?\nplt.figure(figsize=(15,10))\nsns.boxplot(y=df.JobRole,x=df.TotalWorkingYears)","ef45430e":"# Does years with current manager influence the employee to stay longer?\nplt.figure(figsize=(15,10))\nsns.boxplot(x=df.YearsWithCurrManager,y=df.YearsAtCompany)","7091fdcb":"# label encode target variable \ndf[\"Attrition\"]=df[\"Attrition\"].astype('category')\ndf[\"Attrition\"] = df[\"Attrition\"].cat.codes","27441173":"df[\"Attrition\"]","3bd0d6f7":"# encode all categorical columns\nObj_col = df.select_dtypes(include='object')\nObj_col","10b81851":"Obj_col.nunique()","8fabfe37":"# one line code for one-hot-encoding:\ndf_encoded=pd.get_dummies(df,columns=Obj_col.columns)\ndf_encoded.head()","476b2062":"X = df_encoded.loc[:,df_encoded.columns!=\"Attrition\"]\ny = df_encoded[\"Attrition\"]\nprint(X.head())\nprint(y.head())","db236786":"# Scaling\n\nfrom sklearn.preprocessing import MinMaxScaler\nscaler = MinMaxScaler()\nX= scaler.fit_transform(X)\ny=y.values.reshape(-1,1)\nprint(X.shape)\nprint(y.shape)","b7d88610":"from sklearn.model_selection import train_test_split\nX_train,X_test,y_train,y_test = train_test_split(X,y,test_size = 0.25)","7a32a005":"print(X_train.shape)\nprint(X_test.shape)","9f280d29":"from sklearn.linear_model import LogisticRegression\nfrom sklearn.metrics import accuracy_score","cc2739fd":"model_lr= LogisticRegression()\nmodel_lr.fit(X_train,y_train)","911f51b2":"y_pred = model_lr.predict(X_test)","be449245":"from sklearn.metrics import confusion_matrix,classification_report,roc_auc_score\nprint('Accuracy {} %'.format(100* accuracy_score(y_pred,y_test)))\n#Getting predicted probabilities\ny_score = model_lr.predict_proba(X_test)[:,1]\nprint('\\nRoc value '+ str(roc_auc_score(y_test, y_score)))\ncm = confusion_matrix(y_test,y_pred)\nsns.heatmap(cm,annot =True,fmt='d')","7b50cb2b":"print(classification_report(y_test,y_pred))","544a762c":"from sklearn.ensemble import RandomForestClassifier\nmodel_rf= RandomForestClassifier()\nmodel_rf.fit(X_train,y_train)","7ae5fc33":"y_pred = model_rf.predict(X_test)","6fbeffd2":"from sklearn.metrics import confusion_matrix,classification_report,roc_auc_score\nprint('Accuracy {} %'.format(100* accuracy_score(y_pred,y_test)))\ny_score = model_rf.predict_proba(X_test)[:,1]\nprint('\\nRoc value '+ str(roc_auc_score(y_test, y_score)))\ncm = confusion_matrix(y_test,y_pred)\nsns.heatmap(cm,annot =True,fmt='d')","3471c246":"print(classification_report(y_test,y_pred))","9e5b06a7":"import tensorflow as tf\nmodel= tf.keras.models.Sequential()\nmodel.add(tf.keras.layers.Dense(units=500,activation='relu',input_shape= (51,)))\nmodel.add(tf.keras.layers.Dense(units=500,activation='relu'))\nmodel.add(tf.keras.layers.Dense(units=1,activation='sigmoid'))\n","a5ff649f":"model.summary()","95a905f9":"model.compile(optimizer='adam',loss='binary_crossentropy',metrics='accuracy')","098c162c":"epochs_hist = model.fit(X_train,y_train,epochs=100,batch_size=25)","00afe34e":"y_pred=model.predict(X_test)","973cd8ca":"y_pred = (y_pred>0.5)","e7d9e580":"plt.plot(epochs_hist.history['loss'])\nplt.plot(epochs_hist.history['accuracy'])\nplt.xlabel('Epochs')\nplt.ylabel('percentage')\nplt.legend(['loss','accuracy'])\nplt.title('Loss and Accuracy plot')","252c3d06":"from sklearn.metrics import confusion_matrix,classification_report,roc_auc_score\ncm = confusion_matrix(y_test,y_pred)\nprint('Accuracy {} %'.format(100* accuracy_score(y_pred,y_test)))\nprint('\\nRoc value '+ str(roc_auc_score(y_test, y_pred)))\nsns.heatmap(cm,annot=True, fmt='d')","d954f49c":"print(classification_report(y_test,y_pred))","6eca3a59":"Pandas as has inbuilt function \"get_dummies\" to get one hot encoding of that particular column\/s.","5fca8556":"**Summary**\n\nEmployees tend to stay longer in the company if they stay more years under the same manager","494a4038":"# Train and evaluate Random forest Classifier","4080d040":"**Summary from correlation plot**\n* Job level is strongly correlated with total working hours\n* Monthly income is strongly correlated with Job level\n* Monthly income is strongly correlated with total working hours\n* Age is stongly correlated with monthly income","ffdd73aa":"No missing values at all in the data!\n","90ae221d":"# Train and evaluate Deep learning model","63fd005f":"**Summary from above plots**\n* Half of sale representative staff tend to leave followed by lab technicians and research scientist\n* The employees with JobInvolvemnet score 3 tend to quit\n* Most of the staff in JobLevel 1 are likely to leave\n* Employees between the age 26 to 33 have high tendency to leave\n","5e6560c7":"**Summary:**\n\n* Managers and Research directors are highly paid and stay for longer\n* Sales Representative, Laboratory Technician and Research Scientist get paid pretty much the same and more likely to quit often","c3adac60":"**Summary:**\n\n* Managers and Research directors are highly paid\n* Sales Representative, Laboratory Technician and Research Scientist get paid pretty much the same."}}