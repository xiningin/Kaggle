{"cell_type":{"6fddc965":"code","58f51209":"code","1628aeb5":"code","71391698":"code","217e03d3":"code","756f7e5a":"code","56474139":"code","1335b585":"code","35e8fc7b":"code","42ea8cc1":"code","fb230d09":"code","d6354189":"code","802ca60c":"code","4dbdd8ff":"code","041d4319":"code","ecef99b0":"code","4e0505b0":"code","4a0c62d5":"code","e63f803d":"code","277ec8e4":"code","2dea1cdf":"code","055764c2":"code","97db71ac":"code","2abc1a7c":"code","301f2521":"code","b7fc5330":"code","a2f6ae0d":"markdown","2907d1e9":"markdown","d5d46708":"markdown","0b732c05":"markdown","f75c1282":"markdown","06bd9a5b":"markdown","22caaad8":"markdown","d1d0a0a5":"markdown","f738b349":"markdown","42eb7c6e":"markdown","f31ada65":"markdown","57cbd9ff":"markdown","6dc2da26":"markdown","86b75b96":"markdown","f4fb90dc":"markdown","ba923bcc":"markdown"},"source":{"6fddc965":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.cluster import KMeans\nfrom scipy.stats import norm, boxcox\nfrom scipy import stats","58f51209":"df = pd.read_csv(\"\/kaggle\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv\")\ndf.head()","1628aeb5":"# checking no of rows and column\n# Type of column\n# Names of column\ndf.info()","71391698":"# Cheking the statistical attributes of datatset.\ndf.describe()","217e03d3":"#Checking for null values.","756f7e5a":"df.isnull().sum()","56474139":"#Checking for outlier by using boxplot\nsns.boxplot(y=\"Annual Income (k$)\", data=df)\n# Outliers are there","1335b585":"# Checking outlier in spending score column.\nsns.boxplot(y=\"Spending Score (1-100)\", data=df)\n#No outlier","35e8fc7b":"# Checking for outlier in Age column.\nsns.boxplot(y=\"Age\", data=df)\n#No outlier","42ea8cc1":"plt.figure(figsize=(10,4))\nplt.subplot(1,2,1)\nsns.distplot(df[\"Annual Income (k$)\"], fit=norm, color=\"orange\")\nplt.title(\"Annual Income (k$) Distplot\", color = \"darkred\")\nplt.subplot(1,2,2)\nstats.probplot(df[\"Annual Income (k$)\"], plot = plt)\nplt.show()","fb230d09":"plt.figure(figsize=(10,4))\nplt.subplot(1,2,1)\nsns.distplot(df[\"Spending Score (1-100)\"], fit=norm, color=\"orange\")\nplt.title(\"Spending Score (1-100) Distplot\", color = \"darkred\")\nplt.subplot(1,2,2)\nstats.probplot(df[\"Spending Score (1-100)\"], plot = plt)\nplt.show()","d6354189":"Q1 = df['Annual Income (k$)'].quantile(0.25)\nQ3 = df['Annual Income (k$)'].quantile(0.75)\nIQR = Q3 - Q1","802ca60c":"low_lim = Q1 - 1.5 * IQR\nup_lim = Q3 + 1.5 * IQR\nprint('low_limit is', low_lim)\nprint('up_limit is', up_lim)","4dbdd8ff":"outlier = []\nfor x in df['Annual Income (k$)']:\n    if ((x > up_lim) or (x < low_lim)):\n         outlier.append(x)\nprint('Outlier in the dataset is', outlier)","041d4319":"# Data points in our dataset is not large so we can use median to replace the outlier.\ndf.loc[df['Annual Income (k$)'] >= 137, 'Annual Income (k$)'] = 61.5","ecef99b0":"df","4e0505b0":"# Cheking for outlier after replceing with median.\nsns.boxplot(y=\"Annual Income (k$)\", data=df)\n#No outlier after replacing it with mean.","4a0c62d5":"# Plotting a scatter plot between annual income and spending score.\n# Which will help in deciding the number of clusters.","e63f803d":"sns.scatterplot(x=\"Annual Income (k$)\",\n                    y=\"Spending Score (1-100)\",\n                    data=df)","277ec8e4":"k = df.iloc[:,[3,4]].values\nk","2dea1cdf":"# finding wcss (Within Clusters Sum of Squares) value for different number of clusters.\n# WCSS is used to find the number of clusters.\nwcss = []\n\nfor i in range(1,11):\n  kmeans = KMeans(n_clusters=i, init='k-means++', random_state=42)\n  kmeans.fit(k)\n\n  wcss.append(kmeans.inertia_)","055764c2":"# Plotting the elbow curve\nsns.set()\nplt.plot(range(1,11), wcss)\nplt.title('The Elbow Point Graph')\nplt.xlabel('Number of Clusters')\nplt.ylabel('WCSS')\nplt.show()","97db71ac":"kmeans = KMeans(n_clusters=4, init='k-means++', random_state=0)\n# return a label for each data point based on their cluster\nY = kmeans.fit_predict(k)\n\nprint(Y)","2abc1a7c":"# plotting all the clusters and their Means\n\nplt.figure(figsize=(8,8))\nplt.scatter(k[Y==0,0], k[Y==0,1], s=50, c='cyan', label='Cluster 1')\nplt.scatter(k[Y==1,0], k[Y==1,1], s=50, c='gold', label='Cluster 2')\nplt.scatter(k[Y==2,0], k[Y==2,1], s=50, c='coral', label='Cluster 3')\nplt.scatter(k[Y==3,0], k[Y==3,1], s=50, c='olive', label='Cluster 4')\n\n# Means\nplt.scatter(kmeans.cluster_centers_[:,0], kmeans.cluster_centers_[:,1], s=150, c='brown', label='Means')\n\nplt.title('Groups')\nplt.xlabel('Annual Income')\nplt.ylabel('Spending Score')\nplt.show()","301f2521":"kmeans = KMeans(n_clusters=5, init='k-means++', random_state=0)\n# return a label for each data point based on their cluster\nY = kmeans.fit_predict(k)\n\nprint(Y)","b7fc5330":"# Plotting all the clusters and their Means\n\nplt.figure(figsize=(8,8))\nplt.scatter(k[Y==0,0], k[Y==0,1], s=50, c='cyan', label='Cluster 1')\nplt.scatter(k[Y==1,0], k[Y==1,1], s=50, c='gold', label='Cluster 2')\nplt.scatter(k[Y==2,0], k[Y==2,1], s=50, c='coral', label='Cluster 3')\nplt.scatter(k[Y==3,0], k[Y==3,1], s=50, c='olive', label='Cluster 4')\nplt.scatter(k[Y==4,0], k[Y==4,1], s=50, c='orange', label='Cluster 5')\n\n# plot the means\nplt.scatter(kmeans.cluster_centers_[:,0], kmeans.cluster_centers_[:,1], s=150, c='brown', label='Means')\n\nplt.title('Groups')\nplt.xlabel('Annual Income')\nplt.ylabel('Spending Score')\nplt.show()","a2f6ae0d":"# Dataset Information.","2907d1e9":"# Training the K-means model.","d5d46708":"Making clusters on \"Annual Income\" and \"Spending Score\".","0b732c05":"# Loading the dataset.","f75c1282":"For better understanding, let's take number of cluster as 4 and see what happens.","06bd9a5b":"No need to correct for skewness because the data is normal distributed.","22caaad8":"# Conclusion","d1d0a0a5":"Deciding the number of clusters with using the elbow curve.\nWe will use the k numbers of clusters and choose the optimum one.","f738b349":"No need to correct for skewness because the data is normal distributed.","42eb7c6e":"From the elbow point graph and the scatter plot which we plotted before , we could take 5 as the number of clusters.","f31ada65":"Replacing the outlier with median","57cbd9ff":"# Importing the required libraries.","6dc2da26":"By clustering we can target the potential customers of the mall and use it to increase the profit.\nAnd we can also think of different strategy for the each clusters and give them offers and run advertisement according to the clustering of customers.","86b75b96":"From the clustering with 4 cluster we can see that we actually need 5 numbers of cluster for better grouping.","f4fb90dc":"Now taking number of clusters as 5 and see the grouping.","ba923bcc":"# Checking for outliers in \"Annual Income\""}}