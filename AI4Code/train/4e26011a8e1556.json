{"cell_type":{"b75f8c22":"code","d560eb82":"code","28d3d33e":"code","d6a22436":"code","b85d0372":"code","10c4e062":"code","e5e14c37":"code","44517996":"code","b9331643":"code","803b0386":"code","cd529fb6":"code","1d6e5870":"code","5714d374":"code","9b25904b":"code","1cf41237":"code","bba3b28b":"code","e4a65568":"code","245c16df":"code","be626a65":"code","811f7015":"code","94880b0e":"code","b23bb4e4":"code","0f1437df":"code","799db5cd":"code","3b224249":"code","d8232f7e":"code","46f8647c":"code","e4061bb1":"code","1c5d6b2d":"code","a15d4163":"code","bebe86c1":"code","3222b831":"code","d15f2efe":"code","7f750720":"markdown"},"source":{"b75f8c22":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","d560eb82":"from sklearn.model_selection import train_test_split\nfrom sklearn.impute import SimpleImputer\nfrom sklearn.preprocessing import OneHotEncoder\nfrom sklearn.preprocessing import MinMaxScaler\nfrom sklearn.tree import DecisionTreeClassifier","28d3d33e":"df = pd.read_csv('..\/input\/titanic\/train.csv')","d6a22436":"df.isnull().sum()","b85d0372":"df.head()","10c4e062":"df.drop(columns=['PassengerId', 'Name', 'Ticket', 'Cabin'],inplace = True)","e5e14c37":"df.head()","44517996":"X_train, X_test, y_train, y_test = train_test_split(df.drop(columns=['Survived']),df['Survived'],test_size=0.2, random_state = 42)","b9331643":"X_train.head()","803b0386":"y_train.head()","cd529fb6":"df['Embarked'].value_counts()","1d6e5870":"#appling imputation\n\nsi_age = SimpleImputer()\nsi_embarked = SimpleImputer(strategy='most_frequent')\n\nX_train_age = si_age.fit_transform(X_train[['Age']])\nX_train_embarked = si_embarked.fit_transform(X_train[['Embarked']])\n\nX_test_age = si_age.transform(X_test[['Age']])\nX_test_embarked = si_embarked.transform(X_test[['Embarked']])","5714d374":"#OneHot Encoding on Sex and Embarked\n\nohe_sex = OneHotEncoder(sparse=False, handle_unknown='ignore')\nohe_embarked = OneHotEncoder(sparse=False, handle_unknown='ignore')\n\nX_train_sex = ohe_sex.fit_transform(X_train[['Sex']])\nX_train_embarked = ohe_embarked.fit_transform(X_train_embarked)\n\nX_test_sex = ohe_sex.transform(X_test[['Sex']])\nX_test_embarked = ohe_embarked.transform(X_test_embarked)","9b25904b":"X_train.head()","1cf41237":"X_train_rem = X_train.drop(columns=['Sex', 'Age', 'Embarked'])\nX_test_rem = X_test.drop(columns=['Sex', 'Age', 'Embarked'])","bba3b28b":"X_train_transformed = np.concatenate((X_train_rem,X_train_sex, X_train_age, X_train_embarked),axis=1)\nX_test_transformed = np.concatenate((X_test_rem,X_test_sex,X_test_age, X_test_embarked),axis=1)","e4a65568":"clf = DecisionTreeClassifier()\nclf.fit(X_train_transformed,y_train)","245c16df":"y_pred = clf.predict(X_test_transformed)","be626a65":"y_pred","811f7015":"from sklearn.metrics import accuracy_score\n\naccuracy_score(y_test, y_pred)","94880b0e":"import pickle","b23bb4e4":"pickle.dump(ohe_sex,open('ohe_sex.pkl','wb'))\npickle.dump(ohe_embarked,open('ohe_embarked.pkl','wb'))\npickle.dump(clf,open('clf.pkl','wb'))","0f1437df":"ohe_sex = pickle.load(open('.\/ohe_sex.pkl','rb'))\nohe_embarked = pickle.load(open('.\/ohe_embarked.pkl','rb'))\nclf = pickle.load(open('.\/clf.pkl','rb'))","799db5cd":"test_input = np.array([2, 'male', 31.0, 0, 0, 10.5, 'S'],dtype=object).reshape(1,7)","3b224249":"test_input","d8232f7e":"test_input_sex = ohe_sex.transform(test_input[:,1].reshape(1,1))","46f8647c":"test_input_sex","e4061bb1":"test_input_embarked = ohe_embarked.transform(test_input[:,-1].reshape(1,1))","1c5d6b2d":"test_input_embarked","a15d4163":"test_input_age = test_input[:,2].reshape(1,1)","bebe86c1":"test_input_transformed = np.concatenate((test_input[:,[0,3,4,5]],test_input_age,test_input_sex,test_input_embarked),axis=1)","3222b831":"test_input_transformed.shape","d15f2efe":"clf.predict(test_input_transformed)","7f750720":"# On the production side"}}