{"cell_type":{"dc83af70":"code","1efbb3f4":"code","9a7271bb":"code","1932f0dc":"code","03992e7b":"code","27532cb3":"code","8e05634f":"code","357c46eb":"code","ab2f4354":"code","d814ec58":"code","5e97a655":"code","6f68eb4c":"code","da18b691":"code","2c45a30d":"code","fd45bc71":"code","12615f38":"code","9284964e":"code","145257f6":"code","3bebfa0a":"code","36f0690b":"code","907d5f93":"code","3c7e1550":"code","b687d2d8":"code","3d9ef584":"code","d1b3948b":"code","0f79f0ae":"code","3c158514":"code","99397579":"code","34e7b9fd":"code","5acfe315":"code","8daa8dbf":"code","07a19f81":"code","57cc54c9":"code","24e77e4d":"code","f012b203":"code","e20645e5":"code","dce4337f":"code","d224aef8":"code","94710056":"code","6003325e":"markdown","a0e77ab2":"markdown","f2ff20f9":"markdown","86c41bed":"markdown","82a0bb4a":"markdown","8cf21272":"markdown","6c93199a":"markdown","1434a871":"markdown","5b54e59c":"markdown","ebba6f29":"markdown","8612c596":"markdown","ec193a63":"markdown","2bf125bd":"markdown","1b4f69c8":"markdown","5bcb71bb":"markdown","fdef5116":"markdown"},"source":{"dc83af70":"import seaborn as sns\nimport pandas as pd\nimport numpy as np\nimport cufflinks as cf\nimport plotly.express as px\nimport plotly.graph_objects as go \nimport matplotlib.pylab as plt\nfrom pandas.api.types import CategoricalDtype\nfrom plotly.offline import download_plotlyjs,init_notebook_mode,plot,iplot\ninit_notebook_mode(connected=True)\ncf.go_offline()\n%matplotlib inline\nsns.set_style(\"whitegrid\")","1efbb3f4":"df=pd.read_csv(\"..\/input\/ted-talks\/ted_main.csv\")","9a7271bb":"df.head() ","1932f0dc":"df.describe() ","03992e7b":"df.info() ","27532cb3":"df.isna().sum()","8e05634f":"df[\"film_date\"]=pd.to_datetime(df[\"film_date\"],unit=\"s\")\ndf[\"published_date\"]=pd.to_datetime(df[\"published_date\"],unit=\"s\")\nyears=df[\"film_date\"].dt.year.value_counts().sort_index(ascending=True)","357c46eb":"fig=px.line(x=years.index,y=years.values,\n           labels={\"y\":\"Number of events\",\"x\":\"Year\"},\n      title=\"Number of events through years\",\n       color_discrete_sequence=[\"#31bf9b\"],\n       range_x=[1990,2017],\n      )\nfig.update_layout(\ntitle_font_color=\"#fff\",paper_bgcolor=\"#283747\",title_font_size=20,title_x=.5,font_color=\"#bbb\",\n    plot_bgcolor=\"#D0D3D4\")\nfig.update_yaxes(showgrid=False,visible=False,title=\"percent of commencts\")\nfig.update_xaxes(tickfont_size=9)\nfor i,value in enumerate(years[years==years.max()].index):\n    fig.add_vline(x=value) \nfig.show() ","ab2f4354":"# group the data by the event and calculate the sum\nsums=df.groupby(\"event\")[\"views\"].agg([\"sum\",\"mean\",\"count\"]).sort_values(\"sum\",ascending=False) .nlargest(10,\"sum\")","d814ec58":"text=(sums[\"mean\"]\/1000000).round(2).astype(str)+\" M\"\nfig=px.bar(sums,x=sums.index,y=\"mean\",\n           labels={\"y\":\"Sum & mean & number of talks\",\"x\":\"event\"},\n      title=\"Average number of views for event\",\n       color_discrete_sequence=[\"#154360\"],\n           text=text \n      )\nfig.update_layout(\ntitle_font_color=\"#fff\",paper_bgcolor=\"#283747\",title_font_size=20,title_x=.5,font_color=\"#bbb\",\n    plot_bgcolor=\"#D0D3D4\")\nfig.update_yaxes(showgrid=False,visible=False,title=\"percent of commencts\")\nfig.update_xaxes(tickfont_size=9,color=\"#fff\")\nfig.show()","5e97a655":"text=(sums[\"sum\"]\/1000000).round(1).astype(str)+\" M\"\nfig=px.bar(sums,x=sums.index,y=\"sum\",\n           labels={\"y\":\"Sum & mean & number of talks\",\"x\":\"event\"},\n      title=\"Total number of views for event\",\n       color_discrete_sequence=[\"#154360\"],\n           text=text \n      )\nfig.update_layout(\ntitle_font_color=\"#fff\",paper_bgcolor=\"#283747\",title_font_size=20,title_x=.5,font_color=\"#bbb\",\n    plot_bgcolor=\"#D0D3D4\")\nfig.update_yaxes(showgrid=False,visible=False,title=\"percent of commencts\")\nfig.update_xaxes(tickfont_size=9,color=\"#fff\")\nfig.show()","6f68eb4c":"# get the value counts of each occupation\ns=df[\"speaker_occupation\"].value_counts().sort_values(ascending=False).nlargest(10)\ns","da18b691":"fig=px.pie(names=s.index,values=s.values,labels={\n    \"names\":\"The occupation \",\n    \"values\":\"Number of talks \"\n},\ntitle=\"The highest 10 occupation with the number of talks\",\ncolor_discrete_sequence=px.colors.sequential.Bluyl\n      )\nfig.update_layout(\ntitle_font_color=\"#fff\",paper_bgcolor=\"#283747\",title_font_size=20,title_x=.5,font_color=\"#bbb\",\n    plot_bgcolor=\"#D0D3D4\",legend_title_font_size=17,legend_title_font_color=\"#fff\",\n    legend_title_text=\"Occupation\")\nfig.update_yaxes(showgrid=False,visible=False,title=\"percent of commencts\")\nfig.update_xaxes(tickfont_size=9)\nfig.update_traces(textfont_size=10)\nfig.show()","2c45a30d":"# make the new column that define the interaction\ndf[\"interaction\"]=round((df[\"comments\"]\/df[\"views\"])*100,2)","fd45bc71":"interaction=df.sort_values(\"interaction\",ascending=False)[[\"name\",\"interaction\",\"main_speaker\",\"views\"]]\\\n[df.views> df.views.mean()].nlargest(10,\"interaction\").sort_values(\"interaction\",ascending=False)","12615f38":"fig=px.bar(interaction,x=\"main_speaker\",y=\"interaction\",\n       title=\"Percent of Comments for highest 10 talks\",\n      color_discrete_sequence=[\"#154360\"],\n      hover_data={\"name\":True,\"main_speaker\":False},\n           text=\"interaction\",\n           \n      )\nfig.update_layout(\ntitle_font_color=\"#fff\",paper_bgcolor=\"#283747\",title_font_size=20,title_x=.5,font_color=\"#fff\",\n    plot_bgcolor=\"#D0D3D4\")\nfig.update_yaxes(showgrid=False,visible=False,title=\"percent of commencts\")\nfig.update_xaxes(tickfont_size=9)\nfig.update_traces(textposition=\"inside\",textfont_color=\"#fff\",textfont_size=13)\nfig.show()","9284964e":"df[\"ratings\"].dtype","145257f6":"import ast\n# get the list inside the string dtype as a list\ndf[\"ratings\"]=df[\"ratings\"].apply(lambda x:ast.literal_eval(x))\n","3bebfa0a":"df.ratings[0]\n","36f0690b":"# function to get the total number of rating for each talk\ndef get_total(x):\n    count=0\n    for i in x:\n        # note:  i here represents the dic\n        count+=i[\"count\"]\n    return count\n        ","907d5f93":"df[\"total_num_rating\"]=df[\"ratings\"].apply(lambda x: get_total(x))","3c7e1550":"df[\"total_num_rating\"].head()","b687d2d8":"def get_funny_ratings(x):\n    for i in x:\n        if i[\"name\"]==\"Funny\":\n            return i[\"count\"]\n        ","3d9ef584":"df[\"funny_ratings\"]=df[\"ratings\"].apply(lambda x: get_funny_ratings(x))","d1b3948b":"df[\"funny_ratio\"]=round((df[\"funny_ratings\"]\/df[\"total_num_rating\"])*100,2)","0f79f0ae":"df.head(2)","3c158514":"funny=df[(df.total_num_rating>df.total_num_rating.mean())]\\\n.nlargest(10,\"funny_ratio\").sort_values(\"funny_ratio\",ascending=True)\n","99397579":"fig=px.bar(funny,x=\"main_speaker\",y=\"funny_ratio\",color=\"speaker_occupation\",\n          title=\"highest 10 tedtakls with Funny_ratings Ratio and thier occupation\".title(),\n           color_discrete_sequence=px.colors.sequential.Bluyl ,\n           hover_data={\"name\":True},\n           labels={\"name\":\"Talk_name \"},\n           text=\"funny_ratio\" \n          )\n\nfig.update_layout(\ntitle_font_color=\"#fff\",paper_bgcolor=\"#283747\",title_font_size=20,title_x=.5,font_color=\"#bbb\",\n    plot_bgcolor=\"#D0D3D4 \",legend_title_font_size=17,legend_title_font_color=\"#fff\")\nfig.update_yaxes(showgrid=False,visible=False,title=\"percent of commencts\")\nfig.update_xaxes(tickfont_size=9)\nfig.update_traces(textfont_size=10)\nfig.show()","34e7b9fd":"def confuse(x):\n    for i in x:\n        if i[\"name\"]==\"Confusing\":\n            return i[\"count\"]","5acfe315":"# make a column with the ratio of confusing rating to the total ratings number\ndf[\"confuse_ratio\"]=round((df[\"ratings\"].apply(lambda x: confuse(x))\/ df[\"total_num_rating\"])*100,2)","8daa8dbf":"confuse_ratio=df[(df.total_num_rating>df.total_num_rating.mean())]\\\n.nlargest(10,\"confuse_ratio\").sort_values(\"confuse_ratio\",ascending=True)","07a19f81":"fig=px.bar(confuse_ratio,x=\"main_speaker\",y=\"confuse_ratio\",color=\"speaker_occupation\",\n          title=\"highest 10 tedtakls with confuse_ratio ratings  and thier occupation\",\n          labels={\"name\":\"tedtalk name\"},\n          text=\"confuse_ratio\",\n           color_discrete_sequence=px.colors.sequential.Bluyl \n          )\nfig.update_layout(\ntitle_font_color=\"#fff\",paper_bgcolor=\"#283747\",title_font_size=20,title_x=.5,font_color=\"#bbb\",\n    plot_bgcolor=\"#D0D3D4\",legend_title_font_size=17,legend_title_font_color=\"#fff\",\n    legend_title_text=\"Occupation\")\nfig.update_yaxes(showgrid=False,visible=False,title=\"percent of commencts\")\nfig.update_xaxes(tickfont_size=9)\nfig.update_traces(textfont_size=10)\nfig.show()","57cc54c9":"funny_average=df.groupby(\"speaker_occupation\")[\"funny_ratio\"].mean().sort_values(ascending=False).nlargest(10)\nfunny_average.shape","24e77e4d":"fig=px.pie(names=funny_average.index,values=funny_average.values,labels={\n    \"names\":\"the occupation \",\n    \"values\":\"AVG. funny_ratio \",\n   \n},\ntitle=\"The highest 10 occupation in the AVG. funny_ratio ratings\",\ncolor_discrete_sequence=px.colors.sequential.Bluyl\n          )\nfig.update_layout(\ntitle_font_color=\"#fff\",paper_bgcolor=\"#283747\",title_font_size=20,title_x=.5,font_color=\"#bbb\",\n    plot_bgcolor=\"#D0D3D4\",legend_title_font_size=17,legend_title_font_color=\"#fff\",\n    legend_title_text=\"Occupation\")\nfig.update_yaxes(showgrid=False,visible=False,title=\"percent of commencts\")\nfig.update_xaxes(tickfont_size=9)\nfig.update_traces(textfont_size=10)\nfig.show()","f012b203":"df.columns","e20645e5":"def get_column(column_name):\n    def name(x):\n        for i in x:\n            if i[\"name\"]==column_name:\n                return i[\"count\"]\n    df[column_name+\"_ratio\"]=round((df[\"ratings\"].apply(lambda x: name(x))\/ df[\"total_num_rating\"])*100,2)","dce4337f":"rest=[\"Beautiful\",\"Ingenious\",\"Courageous\",\"Longwinded\",\"Longwinded\",\"Confusing\",\"Informative\",\"Fascinating\"\n,\"Unconvincing\",\"Persuasive\",\"Jaw-dropping\",\"Obnoxious\",\"Inspiring\"\n]","d224aef8":"for column_name in rest:\n    get_column(column_name)","94710056":"df.columns","6003325e":"# 3- what is the best in TED history to attend?\n- the answer depends on the definition of the best\n- i will define the best event according to the total number of views on the talks","a0e77ab2":"# 1- import data and show info","f2ff20f9":"- i want only the talks that have ratings above the average\n","86c41bed":"<img src= \"data:image\/png;base64,iVBORw0KGgoAAAANSUhEUgAAATYAAACjCAMAAAA3vsLfAAAAhFBMVEX\/\/\/\/mKx7kAAD75uXlFgD0s7HmKBr87e3++fnnOC786OfnNyv+9\/b3w8DlGADzravyo6D51tTmJBXlIA\/63Nr1uLXqWFHxmpbnLyL4ysfrYlvwkY32vbrzrqz98\/Pyp6XpTEPufHfvhoLoPzXqUkrtcGrvi4fqWlP3ycfwlZHoRTvufnmf15kMAAADnElEQVR4nO3cb1vaMBSH4RBDyt8KCSoIIqibbvv+328gbuJ2DqZpaU68fvfrGO0j0jYNKgUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJDC+qKW9W6KWhOo0AkGg6KXuNWRe13LjVK9WhOMdj9D4FBTus12shilTrZ3WXZqKCf7bDUmMK\/ZQkdb60ttniaD1NXyynbgSn09Rraq2Xac7l8hW8QXWr2ZIVsEtz8fIVvEFz8nuyTJOVvH99fIFsHNC2SL4Ppp\/k4zz9bx18gWNcMS2WLoKbJFsENki5pjgmwRbNn+WtIXyNYp27\/LIpcpmUMkRt6w2ajR3DLlJxMY4+2pbNa1nm1U\/G9GHoeZEkNHXDbzQowmKC6b6a4PIwazRffhUZcnypm0q0hvCvI49AU9ms5W5bKAzvZxJbKYzA0bzqW55v2HxGw7XeO4bjr9MrnYbGr0xJ2\/zGXkoTZJajalvhk6m7uNOtBmyc2mbj3dzcccZ8MEZxt16POCTvlg4Y3gbGrMXOQJeHNrJFuFX3+VbGpDnk79Q\/XDbFoT2ewwiGfvErhsY\/Ks4J7OViNYE9k6Ngh\/c8VlU\/TJ1JwrRrhGsoXhb+XZbFvyZKpTPcN6Jztbl3y5cT9di2RnoxcakiyNfyQ727ra8PbIzlZ1eGuEZyPv5wUsuQnPRi71mu6ZYoQTno08k+LV9lk2evjqTDHCyc6GM2mD120G122ns61wlxCT7Tt9T5pof+AR2dkeyfXdr7ICUvepPJftgl7eezxbjWBNZDPjQYjXOStlW5J\/o357rhjhJD9L6NGbGsr7iONsmORsS\/oJs4B1I8nZptxuKAGfNZWbrWAek7rnqANtlthsxZDZPCPhrU1sthW75Qg7jths02fNbXD7Qvvbaj+Vfzn6FsXLj75md7dJWDVSTT2V74dw7F3C+wTDudcnd+\/aTqt5OCKeyh9PwBd7ZSScEFq9lT+RLZidt1qHlVk2LeKdLbdsXsIG1L2sslmTftPMQVbZ9KLVNifklE0n+HgfI6NsOslnl2n5ZJNULZtsVgvYH\/4uk2zeC1jSPZJFNqu3AlZ0j2WQzemfsl5qKoNsXm\/S75T5j+hs1ptyK+6Vtic1m3Xe6PmvsbD3tD8G2hD4bNToQIdsQSN1Ob9drtJvLGKN7rqEO+aWuXdJjQ50t3\/lfD7B1Woxk\/RvdwEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP76DfUKVZTQOkO8AAAAAElFTkSuQmCC\" alt =\"Titanic\" style='width: 600px;'>","82a0bb4a":"- it is alist of dictionaries","8cf21272":"## if you liked it, an upvote will make me happy \n- thanks","6c93199a":"# 9- what is highest 10 occupation with the average fuuny ratings ratio ","1434a871":"# 4- The occupations that dominate TedTalks\n- occupation and it's number of talks","5b54e59c":"# 2- show number of TedTaks through years","ebba6f29":"# 10- Adding tha other Ratings","8612c596":"# 7- try to figure out the funniest TedTalks.\n- get the ratio of funny ratings to the total rating\n- make a function to get the funny ratings","ec193a63":"# Agenda:\n### 1- import data and show info\n### 2- show number of tedtalks through years\n### 3- what is the best in TED history to attend?\n### 4- the occupations that dominate TedTalks\n### 5- figure out the TEDTalks that has highest ratio of comments per views [ interaction ]\n### 6- Unpack the Ratings columns to get informations\n### 7- try to figure out the funniest TedTalks.\n### 8- try to figure out the most Confusing TedTalks.\n### 9- Avegare Funny_ratio of ratings for occupations","2bf125bd":"# 8- Try to figure out the most confusing TedTalks.\n- according to the audience opinion\n- the same way we deal with the funny ratio, above avererage","1b4f69c8":"## we can do the same operation towards any other kind of ratings","5bcb71bb":"# 6- Unpack Ratings Column\n- get the information from the rating columns","fdef5116":"# 5- TedTalks that highest percent of comments per views"}}