{"cell_type":{"5cae5e35":"code","0a54126a":"code","67823399":"code","dc12db87":"code","ac3a9038":"code","861550db":"code","6a4b0076":"code","b5c4246a":"markdown","4ac859d2":"markdown","fc6910a4":"markdown","a6687b2e":"markdown","c2348a15":"markdown","58f7cc8c":"markdown","e463b669":"markdown"},"source":{"5cae5e35":"import numpy as np\nimport pandas as pd","0a54126a":"train = pd.read_csv(\"..\/input\/train.csv\", index_col='id') \ntest = pd.read_csv(\"..\/input\/test.csv\", index_col='id') ","67823399":"corr_m=train.corr()\ncorr_m['target'].sort_values(ascending=False)","dc12db87":"train_y=train['target']\ntrain_x=train.drop('target', axis=1)","ac3a9038":"attributes=['33','65','24','183','199','194','189','80','73','295','91','117','217']\ntrain_x=train_x[attributes]\ntest=test[attributes]","861550db":"from sklearn.model_selection import RandomizedSearchCV\nfrom scipy.stats import randint\nfrom sklearn.ensemble import RandomForestRegressor\n\nparam_distribs = {\n        'n_estimators': randint(low=1, high=200),\n        'max_features': randint(low=1, high=7),\n    }\n\nforest_reg = RandomForestRegressor(random_state=42)\nrnd_search = RandomizedSearchCV(forest_reg, param_distributions=param_distribs,\n                                n_iter=10, cv=5, scoring='roc_auc', random_state=42)\nrnd_search.fit(train_x,train_y)","6a4b0076":"#Save results\nprediction = rnd_search.predict(test)\nfinal=pd.DataFrame(prediction,columns=['target'])\nfinal['id']=test.index\nfinal=final[['id','target']]\nfinal.to_csv(\"submission.csv\", index=False)","b5c4246a":"**We are going to use a correlation matrix to see influence of which feature on our taget.\nThen feed some of the more influent features to a random forest regressor**","4ac859d2":"Predict test, and save results","fc6910a4":"From the correlation matrix we can see that 13 feutures have a correlation score above abs(0.15).\nWe are going to use only these!","a6687b2e":"First import the Data","c2348a15":"Separate target from features","58f7cc8c":"We do a grid search to find the best params to a Random Forest Regressor","e463b669":"Then we can see how the feautures correlate to our target"}}