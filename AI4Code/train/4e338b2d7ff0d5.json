{"cell_type":{"9342efac":"code","d2a87e3b":"code","eabb01c9":"code","494feb2f":"code","67d66762":"code","9cc54b7f":"code","c2040ccb":"code","96a1732d":"code","00b27fd1":"code","003ef785":"code","d8211790":"code","13eb48f8":"code","8871edf5":"code","d2459276":"code","31e80666":"markdown","91103bc2":"markdown","95ac0d88":"markdown","1a52d1da":"markdown","d066dc1a":"markdown","e930181c":"markdown","e99df755":"markdown","ae1852b9":"markdown","dbcecac5":"markdown","ddd4dbbe":"markdown"},"source":{"9342efac":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","d2a87e3b":"import spacy\nimport csv\n\ndef read_data(path):\n    with open(path, 'r') as csvfile:\n        readCSV = csv.reader(csvfile, delimiter=',')\n        labels = []\n        sentences = []\n        for row in readCSV:\n            label = row[0]\n            sentence = row[1]\n            labels.append(label)\n            sentences.append(sentence)\n    return sentences, labels\n\n# Loading Test Data\n\nsentences_test,labels_test = read_data('..\/input\/atis-airlinetravelinformationsystem\/atis_intents_test.csv')\nprint(sentences_test[:3],'\\n')\nprint(labels_test[:3])\n\n# Loading Training Data\n\nsentences_train,labels_train = read_data('..\/input\/atis-airlinetravelinformationsystem\/atis_intents_train.csv')\n","eabb01c9":"!python -m spacy download en_vectors_web_lg\n!python -m spacy link en_vectors_web_lg en_vectors_web_lg\n","494feb2f":"\n\nimport spacy\nimport numpy as np\n\n# Load the spacy model: nlp\nnlp = spacy.load('en_vectors_web_lg')\n\n\n","67d66762":"# Calculate the dimensionality of nlp\nembedding_dim = nlp.vocab.vectors_length\n\nprint(embedding_dim)\n","9cc54b7f":"\ndef encode_sentences(sentences):\n    # Calculate number of sentences\n    n_sentences = len(sentences)\n\n    print('Length :-',n_sentences)\n\n    X = np.zeros((n_sentences, embedding_dim))\n    #y = np.zeros((n_sentences, embedding_dim))\n\n    # Iterate over the sentences\n    for idx, sentence in enumerate(sentences):\n        # Pass each sentence to the nlp object to create a document\n        doc = nlp(sentence)\n        # Save the document's .vector attribute to the corresponding row in     \n        # X\n        X[idx, :] = doc.vector\n    return X\n\ntrain_X = encode_sentences(sentences_train)\ntest_X = encode_sentences(sentences_test)\n","c2040ccb":"def label_encoding(labels):\n    # Calculate the length of labels\n\n    n_labels = len(labels)\n    print('Number of labels :-',n_labels)\n\n\n    # import labelencoder\n    from sklearn.preprocessing import LabelEncoder\n    # instantiate labelencoder object\n    le = LabelEncoder()\n    y =le.fit_transform(labels)\n    print(y[:100])\n    print('Length of y :- ',y.shape)\n    return y\n\ntrain_y = label_encoding(labels_train)\ntest_y = label_encoding(labels_test)\n","96a1732d":"df1 = pd.read_csv('..\/input\/atis-airlinetravelinformationsystem\/atis_intents_train.csv', delimiter=',')\ndf1.dataframeName = 'atis_intents_train.csv'\nnRow, nCol = df1.shape\nprint(f'There are {nRow} rows and {nCol} columns')","00b27fd1":"df1.sample(10)","003ef785":"df1.describe()","d8211790":"import matplotlib.pyplot as plt\nimport seaborn as sns\n\n# matplotlib histogram\nplt.hist(train_y)\n\n# Add labels\nplt.title('Histogram of Intent Lables')\nplt.xlabel('Intent Types')\nplt.ylabel('Frequency')\n#df1['atis_flight'].hist()","13eb48f8":"# Import SVC\nfrom sklearn.svm import SVC\n# X_train and y_train was given.\ndef svc_training(X,y):\n    # Create a support vector classifier\n    clf = SVC(C=1)\n\n    # Fit the classifier using the training data\n    clf.fit(X, y)\n    return clf\n\nmodel = svc_training(train_X,train_y)\n","8871edf5":"#Validation Step\n\ndef svc_validation(model,X,y):\n    # Predict the labels of the test set\n    y_pred = model.predict(X)\n\n    # Count the number of correct predictions\n    n_correct = 0\n    for i in range(len(y)):\n        if y_pred[i] == y[i]:\n            n_correct += 1\n\n    print(\"Predicted {0} correctly out of {1} training examples\".format(n_correct, len(y)))\n\n\nsvc_validation(model,train_X,train_y)\nsvc_validation(model,test_X,test_y)\n","d2459276":"from sklearn.metrics import classification_report\ny_true, y_pred = test_y, model.predict(test_X)\nprint(classification_report(y_true, y_pred))\n   \n","31e80666":"## Note\nPlease share, upvote and comment to help me create and share more content for the community.\nThank you all.","91103bc2":"# Encoding Sentences Using spaCy NLP Model\n","95ac0d88":"# Label Encoding","1a52d1da":"# Conclusion\n\nThis is an imbalanced dataset with some of the classes having small number of samples. The resulting poor classification accuracy can be seen in the results.","d066dc1a":"## Intent classification with SVM | Training Step","e930181c":"# What is Intent Classification\n\nIntents are general traits that map the user\u2019s message to the corresponding bot action (prediction workflow). For example, the phrase \u201cWhat is the weather today?\u201d will map to \u2018weather_inquiry\u2019 intent by its entire wording, and not some particular part.\n\nA restaurant_search can be expressed in many different ways:-\n\nI'm hungry. Show me good pizza spots. I want to take my boyfriend out for sushi\n\nThis can also be request_booking\n\n\n","e99df755":"## Load Data from ATIS Dataset\n","ae1852b9":"## Loading spaCy model","dbcecac5":"# EDA","ddd4dbbe":"## Spacy Setup"}}