{"cell_type":{"6ebf7da6":"code","bd099e1f":"code","b9d0294b":"code","d2b90cab":"code","dcd99cab":"code","ca6b3383":"code","1ba8188c":"code","42c37f0a":"code","60db3982":"code","eac36db6":"code","cdfc866f":"code","73fff7bf":"code","09f1aa85":"code","eaa946c6":"code","b232f533":"code","e1798e96":"code","139b8945":"markdown","98c5a8f1":"markdown","14c97b01":"markdown","ab9b1267":"markdown"},"source":{"6ebf7da6":"import pandas as pd\nimport numpy as np","bd099e1f":"dataset = pd.read_csv(\"\/kaggle\/input\/fia-machine-learning-t7\/credit_train_label.csv\")","b9d0294b":"dataset.head()","d2b90cab":"## Data Types\ndataset.dtypes","dcd99cab":"## Missing\ndataset.isna().mean()","ca6b3383":"dataset.describe()","1ba8188c":"# sample size\ndataset.shape","42c37f0a":"target = \"SeriousDlqin2yrs\"\nfeatures = dataset.drop(columns=[\"X\", target]).columns","60db3982":"def feature_eng(df: pd.DataFrame, features):\n    return df.assign(**{\n        f\"{f1}_over_{f1}\": df[f1]\/df[f1] for f1 in features for f2 in features\n    }).assign(**{\n        f\"{f1}_times_{f1}\": df[f1]*df[f1] for f1 in features for f2 in features\n    })\n\neng_dataset = feature_eng(dataset, features)\neng_features = eng_dataset.drop(columns=[\"X\", target]).columns\n\nprint(eng_features)\neng_dataset.head()","eac36db6":"import xgboost as xgb\n\nfrom scipy.stats import randint as sp_randint\nfrom sklearn.model_selection import RandomizedSearchCV","cdfc866f":"param_grid = {\n        'silent': [True],\n        'max_depth': list(range(2, 11)),\n        'learning_rate': [0.001, 0.01, 0.05, 0.08, 0.1, 0.2, 0.3],\n        'subsample': [0.2, 0.3, 0.4, 0.6, 0.7, 0.8, 0.9, 1.0],\n        'colsample_bytree': [0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0],\n        'colsample_bylevel': [0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0],\n        'min_child_weight': [0.5, 1.0, 3.0, 5.0, 7.0, 10.0],\n        'gamma': [0, 0.25, 0.5, 1.0],\n        'reg_lambda': [0.1, 1.0, 5.0, 10.0, 50.0, 100.0],\n        'n_estimators': [50, 100, 200]}\n\n# run randomized search\nclf = xgb.XGBClassifier()\n\nn_iter_search = 10\nrandom_search = RandomizedSearchCV(clf, param_distributions=param_grid,\n                                   n_iter=n_iter_search, cv=5, iid=False, n_jobs=-1)","73fff7bf":"random_search.fit(eng_dataset[eng_features], eng_dataset[target])","09f1aa85":"trained_model = random_search.best_estimator_\nprint(\"Best score\", random_search.best_score_)\ntrained_model","eaa946c6":"test_data = pd.read_csv(\"\/kaggle\/input\/fia-machine-learning-t7\/credit_test_features.csv\")\ntest_data.head()","b232f533":"predictions = trained_model.predict_proba(feature_eng(test_data, features)[eng_features])[:, 1]\npredictions.mean()","e1798e96":"predictions_df = pd.DataFrame({\n    \"X\": test_data[\"X\"],\n    target: predictions \n})\n\npredictions_df.head()","139b8945":"## Sanity Checks","98c5a8f1":"## Making Predictions","14c97b01":"## Feature Eng.","ab9b1267":"## Parameter Tuning and Model Selection"}}