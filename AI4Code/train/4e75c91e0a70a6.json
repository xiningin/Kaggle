{"cell_type":{"04ebe516":"code","c3bc40c0":"code","4dd2f306":"code","7e79cbf1":"code","d452748f":"code","4032e197":"code","9ff7dbbd":"code","88d9007d":"code","44e8c5b3":"code","033ed363":"code","4969093c":"code","76fea7db":"code","7ebe5b59":"code","be67ef30":"code","5610dcdc":"code","0d4855ff":"code","8d131217":"code","95a57b1d":"code","b4440bd1":"code","1d66e82f":"code","e17dabb5":"code","c42fdd93":"code","cb7b2428":"code","d814f03c":"code","e1324a65":"code","b403150d":"markdown","0d2c7537":"markdown","a1c8b068":"markdown","6061b233":"markdown","191ae930":"markdown","584a863c":"markdown","4ed9150c":"markdown","5107bb5f":"markdown","74ce8dfa":"markdown","b60fe8b6":"markdown","cde9289d":"markdown","121aaf4e":"markdown","0b774e36":"markdown"},"source":{"04ebe516":"%config Completer.use_jedi = False\nimport numpy as np \nimport pandas as pd \nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport random\nimport plotly.graph_objects as go\nimport plotly.express as px\nimport plotly.figure_factory as ff\nfrom plotly.subplots import make_subplots\nfrom collections import Counter\n\nfrom sklearn.preprocessing import StandardScaler, LabelEncoder, MinMaxScaler, PolynomialFeatures\nfrom sklearn.linear_model import LinearRegression, Lasso, Ridge\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.neighbors import LocalOutlierFactor\nfrom sklearn.metrics import r2_score, mean_squared_error\nfrom sklearn.model_selection import RandomizedSearchCV, cross_val_score, RepeatedStratifiedKFold\nfrom imblearn.over_sampling import SMOTE","c3bc40c0":"data = pd.read_csv('..\/input\/used-car-dataset-ford-and-mercedes\/audi.csv')\ndata.head()","4dd2f306":"data.shape","7e79cbf1":"data.describe()","d452748f":"data.isnull().sum()","4032e197":"for feature in data.columns:\n    print(feature, ':', len(data[feature].unique()))\n#     print(feature, ':', data[feature].unique())\n    print()","9ff7dbbd":"discrete_features = ['model', 'transmission', 'fuelType']\ncontinuous_features = ['year', 'mileage', 'tax', 'mpg', 'engineSize']\n        \nprint('Discrete Features:', discrete_features)\nprint('Continuous Features:', continuous_features)","88d9007d":"correlation = data.corr()\nplt.figure(figsize=(10, 10))\nsns.heatmap(correlation, annot=True)\nplt.show()","44e8c5b3":"fig, ax = plt.subplots(len(continuous_features), 2, figsize=(14,22))\n\nfor i in range(len(continuous_features)):\n    sns.kdeplot(ax=ax[i, 0], x=continuous_features[i], data=data, fill = True)\n    sns.boxplot(ax=ax[i, 1], x=continuous_features[i], data=data)\nfig.tight_layout(pad=1)\nplt.show()","033ed363":"sns.countplot(x = \"transmission\", data = data)","4969093c":"fig, ax = plt.subplots(1, 2, figsize=(14,6))\n\nsns.kdeplot(ax=ax[0], x='price', hue='transmission', data=data, fill = True)\nsns.kdeplot(ax=ax[1], x='price', hue='fuelType', data=data, fill = True)\n\nfig.tight_layout(pad=1)\nplt.show()","76fea7db":"Counter(data['fuelType'])","7ebe5b59":"plt.figure(figsize = (10,10))\nsns.countplot(y=data['model'])","be67ef30":"sns.pairplot(data[continuous_features])","5610dcdc":"clean_data = data.copy()\nclean_data.head()","0d4855ff":"encoder = LabelEncoder()\nclean_data['model'] = encoder.fit_transform(clean_data['model'])\nclean_data['transmission'] = encoder.fit_transform(clean_data['transmission'])\nclean_data['fuelType'] = encoder.fit_transform(clean_data['fuelType'])","8d131217":"clean_data.head()","95a57b1d":"clean_data = clean_data[clean_data['year'] >= 2000]\nclean_data = clean_data[clean_data['mileage'] <= 200000]\nclean_data = clean_data[clean_data['mpg'] <= 100]","b4440bd1":"clean_data['year'] = 2022 - clean_data['year']","1d66e82f":"clean_data.head()","e17dabb5":"X = clean_data.drop(['price'], axis=1)\ny = clean_data['price']\n\nscaler = MinMaxScaler()\nX = scaler.fit_transform(X)\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, random_state=42)\n\nprint(X_train.shape, X_test.shape)\nprint(len(y_train))","c42fdd93":"lin_reg = LinearRegression()\nlin_reg.fit(X_train, y_train)\ny_pred = lin_reg.predict(X_test)\nr2 = r2_score(y_pred, y_test)\nprint('R2 Score:', r2)\n\nmse = mean_squared_error(y_pred, y_test)\nprint('MSE:', mse)","cb7b2428":"poly = PolynomialFeatures(3)\nX_train_poly = poly.fit_transform(X_train)\nX_test_poly = poly.transform(X_test)\n\nlin_reg.fit(X_train_poly, y_train)\ny_pred = lin_reg.predict(X_test_poly)\nr2 = r2_score(y_pred, y_test)\nprint('R2 Score:', r2)\n\nmse = mean_squared_error(y_pred, y_test)\nprint('MSE:', mse)","d814f03c":"ridge_reg = Ridge(alpha=0.001)\nridge_reg.fit(X_train_poly, y_train)\ny_pred = ridge_reg.predict(X_test_poly)\nr2 = r2_score(y_pred, y_test)\nprint('R2 Score:', r2)\n\nmse = mean_squared_error(y_pred, y_test)\nprint('MSE:', mse)","e1324a65":"lasso_reg = Lasso(alpha=0.001)\nlasso_reg.fit(X_train_poly, y_train)\ny_pred = lasso_reg.predict(X_test_poly)\nr2 = r2_score(y_pred, y_test)\nprint('R2 Score:', r2)\n\nmse = mean_squared_error(y_pred, y_test)\nprint('MSE:', mse)","b403150d":"# Model Building","0d2c7537":"# EDA","a1c8b068":"# Load Dataset","6061b233":"### Observations:\n- This countplot shows us that there are around 4000+ cars which are of Manual Transmission in UK. Around 2500+ cars which are Automatic Transmission in UK and around 3500+ Cars which are Semi-Auto transmission.","191ae930":"### Label Encoding","584a863c":"### Observations:\n- There is no missing part in the dataset.\n- There are 3 Discrete and 5 Continuous Features with *price* as dependent variable.","4ed9150c":"### Temporal Variable Changes on Year Column","5107bb5f":"### Outlier Treatment","74ce8dfa":"### Observations:\n- There is a lot of outliers with tax and mileage features.\n- The data distribution is also uneven and most of them being with skewed to the side rather than a Gaussian distribution.","b60fe8b6":"# Feature Engineering","cde9289d":"### Observations:\n- **year, tax and engineSize are positively correlated to price.**\n- Older the car, less the value of car gets.\n- Tax is directly proportional to price as various taxations are added to the price.\n- Engine Size and proportional more powerful engines tend to have higher price.\n\n\n- **Negative Correlations are between mpg and tax, mileage and year.**\n- MPG mostly differentiate between sports and regular cars, thus one with less MPG or sport cars are having high taxations and vice versa.\n- Older the car is, more the mileage it has, as the car is travelled more.","121aaf4e":"### Observations:\n- About transmission feature, manual transmission have higher density in lower price bracket, while auto and semi-auto have a downwards density towards higher price range.\n\n\n- Talking about fuelType, Petrol and Diesel are most dominant and quite overlapping.\n- Hybrid has very few traces on the graph, so for better understanding we can look at the count which is just 28 compared to others falling in thousands.\n\n\n- In the car model counts, the customer-centric or budget cars have higher counts while the luxury segment has lesser counts.","0b774e36":"# Import Packages"}}