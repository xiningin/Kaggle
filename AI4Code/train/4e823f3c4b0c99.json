{"cell_type":{"94c51cc7":"code","deb17942":"code","9a188d8a":"code","c394e7bc":"code","37862a77":"code","98d8a541":"code","76ba113d":"code","222ea767":"code","09aa75af":"code","da2a48d4":"code","143f5b3e":"code","a4d4b413":"markdown","a58cb899":"markdown","d03ab1ca":"markdown","8e989f32":"markdown"},"source":{"94c51cc7":"import sys\n!{sys.executable} -m pip install bar_chart_race","deb17942":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport bar_chart_race as bcr\nfrom IPython.display import HTML\nimport warnings\nwarnings.filterwarnings(\"ignore\")\nfrom IPython.display import Video","9a188d8a":"import tensorflow as tf\ntry:\n    tpu = tf.distribute.cluster_resolver.TPUClusterResolver()\n    print('Device:', tpu.master())\n    tf.config.experimental_connect_to_cluster(tpu)\n    tf.tpu.experimental.initialize_tpu_system(tpu)\n    strategy = tf.distribute.experimental.TPUStrategy(tpu)\nexcept:\n    strategy = tf.distribute.get_strategy()\nprint('Number of replicas:', strategy.num_replicas_in_sync)","c394e7bc":"data = pd.read_csv('..\/input\/weekly-fuel-prices-in-italy\/weekly_fuel_prices_all_data_from_2005_to_20210823.csv')\ndata[-1:]","37862a77":"data.columns","98d8a541":"data[\"DATE\"] = data[\"SURVEY_DATE\"].apply(pd.to_datetime, dayfirst=True)\ndata[-1:]","76ba113d":"# set double indexes\ndata.set_index(['DATE','PRODUCT_NAME'])","222ea767":"# unstack!!!\ndata1a=data.set_index(['DATE','PRODUCT_NAME']).unstack()['PRICE']\ndata1a","09aa75af":"data1a2 = data1a.fillna(0)\ndata1a2","da2a48d4":"df = data1a2\nbcr.bar_chart_race(\n    df=df,\n    filename='BCR_FuelPriceItaly.mp4',\n    orientation='h',\n    sort='desc',\n    n_bars=5,\n    fixed_order=False,\n    fixed_max=False,\n    steps_per_period=10,\n    interpolate_period=False,\n    label_bars=True,\n    bar_size=.95,\n    period_label={'x': .99, 'y': .10, 'ha': 'right', 'va': 'center'},\n    period_fmt='%B %d, %Y',\n    period_summary_func=lambda v, r: {'x': .99, 'y': .18,'s': '',\n                                      'ha': 'right', 'size': 8, 'family':'IPAGothic'},\n    perpendicular_bar_func='median',\n    period_length=1000,\n    figsize=(5,3),\n    dpi=500,\n    cmap='dark24',\n    title='Weekly Fuel Price in Italy',\n    title_size=10,\n    bar_label_size=7,\n    tick_label_size=5,\n    shared_fontdict={'family':'IPAGothic','color':'.1'},\n    scale='linear',\n    writer=None,\n    fig=None,\n    bar_kwargs={'alpha':.7},\n    filter_column_colors=True)","143f5b3e":"Video(\"\/kaggle\/working\/BCR_FuelPriceItaly.mp4\", width=800, height=600, embed=True)","a4d4b413":"# Dataframe for Bar Chart Race","a58cb899":"# Data preparation","d03ab1ca":"# Weekly Fuel Price in Italy - Bar Chart Race\n* cf. https:\/\/www.dexplo.org\/bar_chart_race\/\n* cf. https:\/\/github.com\/dexplo\/bar_chart_race\/","8e989f32":"# Create Bar Chart Race\n"}}