{"cell_type":{"30c2e323":"code","aaa9d646":"code","97dee8fa":"code","08fef1c2":"code","3c1ad745":"code","fc751d03":"code","ac17f970":"code","bc6655fa":"code","1deb3e1b":"code","7ba4394d":"code","5d59f023":"code","55e04367":"code","3296621b":"code","accb14af":"code","14c6df34":"code","d27c0390":"code","4b75386e":"code","a3ec0587":"code","cf6ec788":"code","355a72dc":"code","1f91a892":"markdown","c225cdbb":"markdown","c2368d98":"markdown","8b5c35f8":"markdown","66d14e65":"markdown","23818fdf":"markdown","7e0ef072":"markdown","fcd7e21c":"markdown","60b9e138":"markdown"},"source":{"30c2e323":"import datetime as dt\nimport pandas as pd\npd.set_option('display.max_columns', None)\npd.set_option('display.float_format', lambda x: '%.2f' % x)\n\ndf_ = pd.read_csv(\"..\/input\/online-retail-ii-uci\/online_retail_II.csv\",)\ndf = df_.copy()\ndf.head()","aaa9d646":"df.shape","97dee8fa":"df.dtypes","08fef1c2":"# 2010-2011 y\u0131llar\u0131 ile i\u015flemlerimizi s\u00fcrd\u00fcrece\u011fiz \ndf = df[df[\"InvoiceDate\"] > \"2010-01-01\"]","3c1ad745":"# Betimsel \u0130statistikler\ndf.describe().T","fc751d03":"# Eksik De\u011fer Kontrol\u00fc\ndf.isnull().sum()","ac17f970":"# Eksik de\u011ferlerin veri setinden d\u00fc\u015f\u00fcr\u00fclmesi\ndf.dropna(inplace=True)","bc6655fa":"# Hangi \u00fcr\u00fcnden ka\u00e7 adet var \ndf[\"StockCode\"].value_counts()","1deb3e1b":"# En \u00e7ok sipari\u015f edilen \u00fcr\u00fcnler\ndf.groupby(\"StockCode\").agg({\"Quantity\":\"sum\"}).sort_values(by=\"Quantity\",ascending=False).head(5)","7ba4394d":"# Faturalardaki \u2018C\u2019 iptal edilen i\u015flemleri g\u00f6stermektedir. \u0130ptal edilen i\u015flemleri veri setinden \u00e7\u0131kart\u0131yoruz.\ndf = df[~df[\"Invoice\"].str.contains(\"C\", na=False)]","5d59f023":"# Fatura ba\u015f\u0131na elde edilen toplam kazanc\u0131 ifade eden \u2018TotalPrice\u2019 ad\u0131nda bir de\u011fi\u015fken olu\u015fturuyoruz.\ndf[\"TotalPrice\"] = df[\"Quantity\"] * df[\"Price\"]","55e04367":"# Analiz tarihimizi belirliyoruz. \ntoday_date = dt.datetime(2011, 12, 11)","3296621b":"df[\"InvoiceDate\"] = pd.to_datetime(df[\"InvoiceDate\"]) ","accb14af":"#  M\u00fc\u015fteri \u00f6zelinde Recency, Frequency ve Monetary metriklerini groupby, agg ve lambda ile hesaplayoruz.\n#  Hesaplad\u0131\u011f\u0131n\u0131z metrikleri \"rfm\" isimli bir de\u011fi\u015fkene atad\u0131k.\nrfm = df.groupby('Customer ID').agg({'InvoiceDate': lambda InvoiceDate: (today_date - InvoiceDate.max()).days,\n                                     'Invoice': lambda Invoice: Invoice.nunique(),\n                                     'TotalPrice': lambda TotalPrice: TotalPrice.sum()})","14c6df34":"#  Olu\u015fturdu\u011funuz metriklerin isimlerini recency, frequency ve monetary olarak de\u011fi\u015ftiriyoruz.\nrfm.columns = ['recency', 'frequency', 'monetary']","d27c0390":"# Toplam kazanc\u0131m\u0131z 0'dan b\u00fcy\u00fck olanlar\u0131 al\u0131yoruz.\nrfm = rfm[rfm[\"monetary\"] > 0]","4b75386e":"#  Recency, Frequency ve Monetary metriklerini qcut yard\u0131m\u0131 ile 1-5 aras\u0131nda skorlara \u00e7eviriyoruz.\nrfm[\"recency_score\"] = pd.qcut(rfm['recency'], 5, labels=[5, 4, 3, 2, 1])\nrfm[\"frequency_score\"] = pd.qcut(rfm['frequency'].rank(method=\"first\"), 5, labels=[1, 2, 3, 4, 5])\nrfm[\"monetary_score\"] = pd.qcut(rfm['monetary'], 5, labels=[1, 2, 3, 4, 5])\nrfm.head()","a3ec0587":"#  Olu\u015fan 3 farkl\u0131 de\u011fi\u015fkenin de\u011ferini tek bir de\u011fi\u015fken olarak ifade ediyoruz ve RFM_SCORE olarak kaydediyoruz.\n\nrfm[\"RFM_SCORE\"] = (rfm['recency_score'].astype(str) +\n                    rfm['frequency_score'].astype(str)+\n                    rfm['monetary_score'].astype(str))\nrfm.head()\n","cf6ec788":"# RFM skorlar\u0131n\u0131n segment olarak tan\u0131mlanmas\u0131\n\n# Olu\u015fturulan RFM skorlar\u0131n daha a\u00e7\u0131klanabilir olmas\u0131 i\u00e7in segment tan\u0131mlamalar\u0131 yapaca\u011f\u0131z.\n# A\u015fa\u011f\u0131daki seg_map yard\u0131m\u0131 ile skorlar\u0131 segmentlere \u00e7eviriyoruz.\nseg_map = {\n    r'[1-2][1-2]': 'hibernating',\n    r'[1-2][3-4]': 'at_Risk',\n    r'[1-2]5': 'cant_loose',\n    r'3[1-2]': 'about_to_sleep',\n    r'33': 'need_attention',\n    r'[3-4][4-5]': 'loyal_customers',\n    r'41': 'promising',\n    r'51': 'new_customers',\n    r'[4-5][2-3]': 'potential_loyalists',\n    r'5[4-5]': 'champions'\n}\n\nrfm['segment'] = (rfm['recency_score'].astype(str) +rfm['frequency_score'].astype(str)).replace(seg_map, regex=True)\nrfm.head()","355a72dc":"# Olu\u015fturdu\u011fumuz segmentleri daha iyi g\u00f6zlemlemek i\u00e7in bir groupby i\u015flemi uyguluyoruz. \nrfm[[\"segment\", \"recency\", \"frequency\", \"monetary\"]].groupby(\"segment\").agg([\"mean\", \"count\"])","1f91a892":"Can't loose segmentimiz olduk\u00e7a de\u011ferli olup sadece uygun indirimler, hediyeler gibi y\u00f6ntemlerle recency de\u011ferini azaltabilirsek bu segmentimizle de ilgili g\u00fczel sonu\u00e7lar elde edebiliriz. Bu s\u0131n\u0131f\u0131 \u015firketimize daha \u00e7ok ilgisini \u00e7ekmeliyiz. \u00c7\u00fcnk\u00fc, \u00e7ok iyi Frequency ve Monetary de\u011ferlerine sahipler biraz daha \u00fcstlerine d\u00fc\u015fmemiz gerekir.","c225cdbb":"# Elde etti\u011fimiz skorlara ait bir ka\u00e7 yorumlama yapal\u0131m.","c2368d98":"# RFM Nedir? \n\nRFM analizi m\u00fc\u015fteri analizi i\u00e7in kullan\u0131lan bir tekniktir.\nM\u00fc\u015fteri sat\u0131n alma al\u0131\u015fkanl\u0131klar\u0131n\u0131 \u00fczerinden gruplara ayr\u0131lmas\u0131 ve bu gruplar \u00f6zelinden stratejiler geli\u015ftirilebilmesini sa\u011flar. \nGenel olarak yap\u0131lacak i\u015f, veri setindeki metrikleri skorlara \u00e7evirip onlar\u0131 bir araya getirip, isimlendirmek ve segmentleri analiz etmek olacak.","8b5c35f8":"# Veri setimizi tan\u0131yal\u0131m","66d14e65":"E\u011fer champions hari\u00e7. recency de\u011ferleri en d\u00fc\u015f\u00fck olan segmentlerden birine bakacak olursak; potential loyalist segmenti g\u00f6z\u00fcm\u00fcze \u00e7arpmaktad\u0131r. Bu segmentin ayn\u0131 zamanda m\u00fc\u015fteri say\u0131s\u0131 da fazla olup, frekans ve monetary de\u011ferlerine de g\u00f6z atarsak monetary de\u011feri g\u00f6rece y\u00fcksek ve gerekli \u00e7al\u0131\u015fmalarla ve uygun kampanyalarla birlikte frekans\u0131 daha da art\u0131r\u0131p bu segmentteki m\u00fc\u015fterilerimizle gerekli \u00e7al\u0131\u015fmalar\u0131 yap\u0131p. G\u00fczel sonu\u00e7lar elde edebiliriz.","23818fdf":"#  Recency: M\u00fc\u015fteri son al\u0131\u015fveri\u015f tarihi - analiz tarihimiz\n#  Frequency: E\u015fsiz invoice de\u011ferleri\n#  Monetary: Her bir m\u00fc\u015fteri i\u00e7in elimizde bulunan toplam kazan\u00e7","7e0ef072":"Promising m\u00fc\u015fterileri frekans de\u011feri ortalamas\u0131 1 olarak g\u00f6z\u00fck\u00fcyor. Bu asl\u0131nda bize bunlar\u0131n elimizden kay\u0131p gitmesinin y\u00fcksek ihtimal oldu\u011funu ve daha \u00e7ok denemek i\u00e7in al\u0131\u015fveri\u015f yapt\u0131klar\u0131n\u0131 g\u00f6sterebilir. Recency ortalamas\u0131n\u0131n \u00e7ok y\u00fcksek olmamas\u0131 sebebiyle bu m\u00fc\u015fterilerden umut kesilmemeli ve \u00e7e\u015fitli anketlerle, kendimizi hat\u0131rlatmalarla \u015firketimize y\u00f6nlendirmeliyiz. \u00c7\u00fcnk\u00fc Yeni m\u00fc\u015fteri bulmak var olan m\u00fc\u015fteriyi elde tutmaktan daha maliyetlidir!","fcd7e21c":"# \u0130\u015f Problemi\nBir e-ticaret \u015firketi m\u00fc\u015fterilerini segmentlere ay\u0131r\u0131p bu segmentlere g\u00f6re pazarlama stratejileri belirlemek istemektedir.\n\n\u015eirket, ortak davran\u0131\u015flar sergileyen m\u00fc\u015fteri segmentleri \u00f6zelinde pazarlama \u00e7al\u0131\u015fmalar\u0131 yapman\u0131n gelir art\u0131\u015f\u0131 sa\u011flayaca\u011f\u0131n\u0131 d\u00fc\u015f\u00fcnmektedir.\n\n\u00d6rne\u011fin \u015firket i\u00e7in \u00e7ok kazan\u00e7l\u0131 olan m\u00fc\u015fterileri elde tutmak i\u00e7in farkl\u0131 kampanyalar, yeni m\u00fc\u015fteriler i\u00e7in farkl\u0131 kampanyalar d\u00fczenlenmek istenmektedir.\n\nM\u00fc\u015fterileri RFM y\u00f6ntemi ile segmentlere ay\u0131raca\u011f\u0131z.","60b9e138":"**De\u011fi\u015fkenler**\n\n***InvoiceNo*** \u2013 Fatura Numaras\u0131\n\n- E\u011fer bu kod C ile ba\u015fl\u0131yorsa i\u015flemin iptal edildi\u011fini ifade eder.\n\n***StockCode*** \u2013 \u00dcr\u00fcn kodu\n- Her bir \u00fcr\u00fcn i\u00e7in e\u015fsiz numara.\n\n***Description*** \u2013 \u00dcr\u00fcn ismi\n\n***Quantity*** \u2013 \u00dcr\u00fcn adedi\n- Faturalardaki \u00fcr\u00fcnlerden ka\u00e7ar tane sat\u0131ld\u0131\u011f\u0131n\u0131 ifade etmektedir.\n\n***InvoiceDate*** \u2013 Fatura tarihi\n\n***UnitPrice*** \u2013 Fatura fiyat\u0131 (Sterlin)\n\n***CustomerID*** \u2013 E\u015fsiz m\u00fc\u015fteri numaras\u0131\n\n***Country*** \u2013 \u00dclke ismi"}}