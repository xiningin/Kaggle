{"cell_type":{"d8c74b2a":"code","3170b575":"code","80c09d1a":"code","ca816082":"code","d5f26414":"code","f954628a":"code","cb32d376":"code","e3e41c0e":"markdown","4db4af32":"markdown","4c150302":"markdown","7aff0b39":"markdown","7aeaef40":"markdown","66c2a437":"markdown","52c87287":"markdown","fadcec27":"markdown"},"source":{"d8c74b2a":"import pandas as pd\nimport numpy as np\n\nimport plotly.graph_objects as go\n\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.metrics import r2_score, mean_absolute_error","3170b575":"data = pd.read_csv('\/kaggle\/input\/salary-data-simple-linear-regression\/Salary_Data.csv')\n\ndata.head()","80c09d1a":"X = data.drop('Salary', axis=1)\n\ny = data['Salary']\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2)","ca816082":"simple_linear_reg = LinearRegression()\n\nsimple_linear_reg.fit(X_train, y_train)\n\ny_pred = simple_linear_reg.predict(X_test)","d5f26414":"mae = mean_absolute_error(y_test,y_pred)\n\nrsq = r2_score(y_test,y_pred)\n\najusted_rsq = 1 - ((1 - rsq) * (len(y_test) - 1))\/(len(y_test)- X_test.shape[1] - 1)\n\nprint('MAE: %.2f' %mae)\n\nprint('\\nR\u00b2: %.2f' %rsq)\n\nprint('\\nAjusted R\u00b2: %.2f' %ajusted_rsq)","f954628a":"coef_a = simple_linear_reg.coef_[0]\n\ncoef_b =  simple_linear_reg.intercept_\n\nprint('Estimated model: y = %.2fx + %.2f' %(coef_a, coef_b))","cb32d376":"fig_model = go.Figure()\n\nfig_model.add_trace(go.Scatter(x = X_test['YearsExperience'], \n                               y = y_test, \n                               mode = 'markers',\n                               name = 'Actual Values'))\n\nfig_model.add_trace(go.Scatter(x = X_test['YearsExperience'], \n                               y = y_pred, \n                               mode = 'lines',\n                               name = 'Predictions'))\n\nfig_model.update_layout(\n    title_text = ('Linear Regression Model (R\u00b2 = %.2f)' %rsq),\n    xaxis_title_text='Years Of Experience',\n    yaxis_title_text='Salary', \n    template = 'plotly_dark',\n    width=750, \n    height=600\n)","e3e41c0e":"### Results - Visualizing model","4db4af32":"### Creating model","4c150302":"# Simple linear regression model","7aff0b39":"# Data","7aeaef40":"### Results - Linear Regression Equation","66c2a437":"### Results - Model evaluation","52c87287":"### Defining variables","fadcec27":"# Libraries"}}