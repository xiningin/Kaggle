{"cell_type":{"de057aa4":"code","c547b130":"code","ab2cfcf6":"code","54d37277":"code","4811f99d":"code","8f97ebbd":"code","8e8e2185":"code","f0492fe9":"code","0cc1a85b":"markdown"},"source":{"de057aa4":"import random\nfrom transformers import AutoTokenizer\n\n\nP_MASK = 0.2","c547b130":"def get_train_text(ids):\n    with open(f'..\/input\/feedback-prize-2021\/train\/{ids}.txt', 'r') as f:\n        text = f.read()\n    return text","ab2cfcf6":"tokenizer = AutoTokenizer.from_pretrained('roberta-base')","54d37277":"text = get_train_text('001A03E06F3C')\nprint(text)","4811f99d":"token = tokenizer(text)\nprint(token['input_ids'])","8f97ebbd":"token_list = tokenizer.convert_ids_to_tokens(token['input_ids'])\norigin_text = tokenizer.convert_tokens_to_string(token_list)\nprint(origin_text)","8e8e2185":"random.seed(1)\n\nprint(tokenizer.mask_token_id)\nprint(tokenizer.mask_token)\n\nmask_id = tokenizer.mask_token_id\ninput_len = len(token['input_ids'])\nindices = random.sample(range(input_len), int(input_len * P_MASK))\nfor idx in indices:\n    token['input_ids'][idx] = mask_id","f0492fe9":"token_list = tokenizer.convert_ids_to_tokens(token['input_ids'])\nmasked_text = tokenizer.convert_tokens_to_string(token_list)\nprint(masked_text)","0cc1a85b":"<strong>I'm not sure if this is the best way.<\/strong>"}}