{"cell_type":{"c4507288":"code","3823dd2c":"code","7b119521":"code","43977265":"code","54788381":"code","026d1547":"code","c919f843":"code","c4c67619":"code","2eef6abe":"code","8b11f44a":"code","e2e03b65":"code","b1a3ecce":"code","521b8532":"code","89dfec8b":"code","7b773972":"code","db08f56b":"code","7675c9d9":"code","16aeb983":"code","e23192f8":"code","2e3274b4":"code","327adb89":"code","90fbea62":"code","608fc5e3":"code","8fdb1380":"code","b7400fd2":"code","58ea94ab":"code","157f02e8":"code","b321811d":"code","b774559c":"code","3d241455":"code","0c66feb9":"code","03915126":"code","282d7457":"markdown","83eaf131":"markdown","ccb1b6dd":"markdown","169563d7":"markdown","18b0cdd2":"markdown","4b173504":"markdown","5ecae285":"markdown"},"source":{"c4507288":"import os\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\nimport string\nstring.punctuation\nfrom nltk.corpus import stopwords\nfrom sklearn.feature_extraction.text import CountVectorizer\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.naive_bayes import MultinomialNB\nfrom sklearn.metrics import classification_report, confusion_matrix","3823dd2c":"data = pd.read_csv('..\/input\/womens-ecommerce-clothing-reviews\/Womens Clothing E-Commerce Reviews.csv', index_col=0)\ndata.head()","7b119521":"data.info()","43977265":"data.isnull().sum()","54788381":"data.dropna(inplace=True)","026d1547":"data.isnull().sum()","c919f843":"counts = data['Division Name'].value_counts()\ncounts.sort_index(inplace=True)\nsns.barplot(x=counts.index, y=counts)\nplt.xlabel('Division Name')\nplt.ylabel('Count')","c4c67619":"counts = data['Department Name'].value_counts()\ncounts.sort_index(inplace=True)\nsns.barplot(x=counts.index, y=counts)\nplt.xlabel('Department Name')\nplt.ylabel('Count')","2eef6abe":"data['Review Text'][2]","8b11f44a":"sns.countplot(y='Rating',data=data)","e2e03b65":"data['length']=data['Review Text'].apply(len)\ndata.head()","b1a3ecce":"data['length'].plot(bins=100, kind='hist')","521b8532":"data.length.describe()","89dfec8b":"data[data['length']==9]['Review Text']","7b773972":"g_ = sns.FacetGrid(data=data, col='Rating', col_wrap=3)\ng_.map(plt.hist, 'length', bins=20, color='g')","db08f56b":"def text_cleaning(message):\n    punc_removed = [char for char in message if char not in string.punctuation]\n    punc_removed_join = ''.join(punc_removed)\n    punc_removed_join_clean = [ word for word in punc_removed_join.split() if word.lower() not in stopwords.words('english')]\n    return punc_removed_join_clean ","7675c9d9":"data_review_clean = data['Review Text'].apply(text_cleaning)","16aeb983":"print(data_review_clean[2]) # Cleaned up review","e23192f8":"print(data['Review Text'][2]) # Original revieww","2e3274b4":"vectorizer = CountVectorizer(analyzer = text_cleaning)\ndata_CountVectorizer = vectorizer.fit_transform(data['Review Text'])","327adb89":"data_CountVectorizer.toarray()","90fbea62":"data_CountVectorizer.shape","608fc5e3":"data['Rating'].values","8fdb1380":"label = data['Rating'].values","b7400fd2":"X = data_CountVectorizer\ny = label","58ea94ab":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2)","157f02e8":"NB_classifier = MultinomialNB()\nNB_classifier.fit(X_train, y_train)","b321811d":"y_predict_train = NB_classifier.predict(X_train)\ny_predict_train","b774559c":"cm = confusion_matrix(y_train, y_predict_train)\nsns.heatmap(cm,annot=True)","3d241455":"y_predict_test = NB_classifier.predict(X_test)\ncm1 = confusion_matrix(y_test, y_predict_test)\nsns.heatmap(cm1,annot=True)","0c66feb9":"print(classification_report(y_test, y_predict_test))","03915126":"test_sample = ['amazing Clothing ']\ntest_sample_countv = vectorizer.transform(test_sample)\ntest_pro = NB_classifier.predict(test_sample_countv)\ntest_pro","282d7457":"# Libraries Import","83eaf131":"# Visualize Dataset","ccb1b6dd":"#  Remove Punctuation And Remove stopwords","169563d7":"# Training the model ","18b0cdd2":"# Import Dataset","4b173504":"# Count Vectorizer","5ecae285":"# Evaluating The Model"}}