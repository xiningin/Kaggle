{"cell_type":{"d597ba56":"code","6c99b4ae":"code","de879c12":"code","4621f782":"code","1b61d6ba":"code","bdc9fe3c":"code","abbcd9cb":"code","6976b694":"code","a94f8c05":"code","310d65d1":"code","bfcd506c":"code","c2808c59":"code","6bcf09b1":"code","7e288644":"markdown","a1e246cb":"markdown","f9fc279b":"markdown","1961200f":"markdown","bba1fe89":"markdown","d67244a3":"markdown","c915c814":"markdown","be8a1c57":"markdown","82fde05a":"markdown","a2dd5636":"markdown","de31df86":"markdown","f854d684":"markdown","5e0e8f02":"markdown"},"source":{"d597ba56":"import os\nimport warnings\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.metrics import accuracy_score, confusion_matrix, ConfusionMatrixDisplay, roc_curve, RocCurveDisplay\nfrom sklearn.model_selection import KFold, train_test_split\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.linear_model import LogisticRegression\n\nwarnings.simplefilter(\"ignore\")","6c99b4ae":"path = ('..\/input\/zoo-animals-extended-dataset\/')\ndata1 = pd.read_csv(path + 'zoo2.csv', index_col='animal_name')\ndata2 = pd.read_csv(path + 'zoo3.csv', index_col='animal_name')\ndata = pd.concat([data1, data2])","de879c12":"data.head()","4621f782":"print(\"\\033[1m\" + 'This data frame has', data.shape[1]-1, \"features, one target class and\", data.shape[0],\"instances\" + \"\\033[0m\")","1b61d6ba":"data.columns","bdc9fe3c":"data.info()","abbcd9cb":"data.describe().T","6976b694":"plt.figure(figsize=(20, 3))\nsns.heatmap(data.isnull(), yticklabels=False, cbar=True)\nplt.title(\"Check if there is any missing value\")\nplt.xlabel('Features')","a94f8c05":"g_i = pd.DataFrame(data.groupby('hair')['eggs','milk', 'airborne', 'venomous'].count())\ng_i.style.background_gradient(cmap='YlGn')","310d65d1":"duplicate_index = [i for i, x in enumerate(list(data.duplicated())) if x]\ndata.duplicated()","bfcd506c":"X = data.iloc[:, :-1].values\ny = data.iloc[:, -1].values","c2808c59":"kfold = KFold(n_splits=10,\n                  random_state=1,\n                  shuffle=True)\nscore = []\npred = np.zeros_like(y)\nfor (train_index, test_index) in (kfold.split(X, y)):\n    x_train, x_test = X[train_index], X[test_index]\n    y_train, y_test = y[train_index], y[test_index]\n    \n    model = LogisticRegression(C=10, penalty='l1',\n                                      solver='saga',\n                                      multi_class='multinomial',\n                                      max_iter=10000)\n    estimator = Pipeline([('scaler', StandardScaler()), ('reg', model)])\n    estimator.fit(x_train, y_train)\n    pred[test_index] = estimator.predict(x_test)\n    \n    score.append(estimator.score(x_test, y_test))\nprint('Score average:', '{0:.2f}%'.format(np.mean(score)*100))","6bcf09b1":"cm = confusion_matrix(y, pred)\nConfusionMatrixDisplay(cm).plot()","7e288644":"## Print the data columns","a1e246cb":"# Import dataset","f9fc279b":"## Duplicates values","1961200f":"## Input and target variables","bba1fe89":"<h2>About this notebook<\/h2>\n\n<hr>\n<h4> Author: Seyedsaman Emami <\/h4>\n<h5> Release Date: 13.Sep.2021 <\/h5>\n<hr>\n\nIn the following notebook, I classified the target labels of the dataset after exploring it.\nI used this dataset because it is a small dataset in terms of dimension and samples, and I can show some methods quickly.\n\n<img src=\"https:\/\/cdn2.civitatis.com\/espana\/madrid\/galeria\/header\/oso-panda-gigante-zoo-madrid.jpg\" alt=\"Zoo\" width=\"300\" height=\"300\" class=\"center\">\n\n\n<h4>Each cell has a comprehensive description, and each part has a summary and a brief conclusion <\/h4>\n\n**<span style='color:red'> Implemented methods <\/span>**\n\nSome of the implemented methods in this notebook are as follows;\n<ul>\n    <li> Grouping dataset<\/li>\n    <li> Pivoting<\/li>\n    <li> Reviewing the missing values <\/li>\n    <li> Pipeline<\/li>\n    <li> cross validation<\/li>\n    <li> ML model to classify<\/li>\n<\/ul>\n\n<h5>If you are interested in this problem and detailed analysis, you can copy this Notebook as follows<\/h5>\n\n<img src=\"https:\/\/www.googleapis.com\/download\/storage\/v1\/b\/kaggle-user-content\/o\/inbox%2F1101107%2F8187a9b84c9dde4921900f794c6c6ff9%2FScreenshot%202020-06-28%20at%201.51.53%20AM.png?generation=1593289404499991&alt=media\" alt=\"Copyandedit\" width=\"300\" height=\"300\" class=\"center\">","d67244a3":"# Explore the dataset","c915c814":"## Missing values","be8a1c57":"## Model evaluation","82fde05a":"## Example of data grouping","a2dd5636":"# Modeling the problem","de31df86":"## Describe the dataset","f854d684":"## Cross vlaidation and model training","5e0e8f02":"# Import Libraries"}}