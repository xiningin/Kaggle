{"cell_type":{"6600893e":"code","6288bfd5":"code","6ce01491":"code","6c243270":"code","feeba832":"code","6188bac4":"code","8265be08":"code","432d285e":"code","b9b2bb19":"code","7dc143fd":"code","aac5f505":"code","ca5f1e01":"code","dbeb0967":"code","ef87b5b2":"markdown"},"source":{"6600893e":"!pip install -q -U git+https:\/\/github.com\/mljar\/mljar-supervised.git@master","6288bfd5":"import numpy as np\nimport pandas as pd\nfrom supervised.automl import AutoML # mljar-supervised","6ce01491":"train = pd.read_csv(\"..\/input\/tabular-playground-series-sep-2021\/train.csv\")\ntest = pd.read_csv(\"..\/input\/tabular-playground-series-sep-2021\/test.csv\")","6c243270":"train.head()","feeba832":"x_cols = train.columns[1:-1].tolist()\ny_col = train.columns[-1]","6188bac4":"# precomputed params for Optuna mode\n# computed with MLJAR Studio (see more https:\/\/mljar.com)\noptuna_init_params = {\n    \"original_LightGBM\": {\n        \"learning_rate\": 0.05,\n        \"num_leaves\": 29,\n        \"lambda_l1\": 1.103405077035878e-05,\n        \"lambda_l2\": 0.0005308916288150648,\n        \"feature_fraction\": 0.378423313869748,\n        \"bagging_fraction\": 0.9732828479469763,\n        \"bagging_freq\": 3,\n        \"min_data_in_leaf\": 14,\n        \"extra_trees\": False,\n        \"metric\": \"auc\",\n        \"custom_eval_metric_name\": None,\n        \"num_boost_round\": 1000,\n        \"early_stopping_rounds\": 50,\n        \"cat_feature\": [],\n        \"feature_pre_filter\": False,\n        \"seed\": 1234\n    },\n    \"original_CatBoost\": {\n        \"learning_rate\": 0.1,\n        \"depth\": 6,\n        \"l2_leaf_reg\": 9.11560260085412,\n        \"random_strength\": 0.1937639766013844,\n        \"rsm\": 0.9403942877108575,\n        \"min_data_in_leaf\": 37,\n        \"eval_metric\": \"AUC\",\n        \"num_boost_round\": 1000,\n        \"early_stopping_rounds\": 50,\n        \"seed\": 1234\n    }\n}","8265be08":"automl = AutoML(\n    mode=\"Optuna\",\n    golden_features=True, \n    algorithms=[\"LightGBM\", \"CatBoost\"],\n    optuna_init_params=optuna_init_params,\n    eval_metric=\"auc\"\n)\nautoml.fit(train[x_cols], train[y_col])","432d285e":"automl.report()","b9b2bb19":"preds = automl.predict_all(test)","7dc143fd":"preds.head()","aac5f505":"sub = pd.DataFrame({\"id\": test.id, \"claim\":preds[\"prediction_1\"]})","ca5f1e01":"sub.to_csv(\"1_submission.csv\", index=False)","dbeb0967":"sub","ef87b5b2":"# MLJAR AutoML \n\nMLJAR is an Automated Machine Learning framework. It is available as Python package with code at GitHub: https:\/\/github.com\/mljar\/mljar-supervised\n\n<img src=\"https:\/\/raw.githubusercontent.com\/mljar\/visual-identity\/main\/media\/kaggle_banner_white.png\" style=\"width: 70%;\"\/>"}}