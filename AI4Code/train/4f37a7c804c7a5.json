{"cell_type":{"a8819e1a":"code","8f370039":"code","5c27612b":"code","f079b965":"code","0a8cc8cc":"code","4708b55d":"code","235b6919":"code","a07b57c0":"code","b66a90c1":"code","e098f878":"code","6ab7a7c1":"code","63c7493e":"code","66265549":"code","d48c3142":"code","54c09f91":"markdown","a8abee89":"markdown","a27bc044":"markdown","68b21bd8":"markdown","60115d34":"markdown","fa491230":"markdown"},"source":{"a8819e1a":"!pip install seaborn==0.11","8f370039":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nfrom matplotlib.offsetbox import AnchoredText\nfrom mpl_toolkits.axes_grid1 import make_axes_locatable","5c27612b":"train = pd.read_csv('\/kaggle\/input\/tabular-playground-series-mar-2021\/train.csv')\ntest = pd.read_csv('\/kaggle\/input\/tabular-playground-series-mar-2021\/test.csv')\n\ntrain.describe()","f079b965":"train.describe(include='O')","0a8cc8cc":"target_count = train['target'].value_counts()\n\n\nfig, axes = plt.subplots(1, 2, figsize=(8, 5), dpi=150)\n\n\ncolor = ['lightgray', '#244747']  # To express the meaning of survival\nnew_xlabel = list(map(str, target_count.index))\n\n# Axes[0] : Bar Plot Custom\naxes[0].bar(new_xlabel, # redefine for categorical x labels \n            target_count, \n            color=color,# color\n            width=0.65, # bar width \n        ) \n\naxes[0].margins(0.2, 0.2) # margin control (leftright, topbottom)\naxes[0].set_xlabel('Target') # label info\naxes[0].spines['top'].set_visible(False)\naxes[0].spines['right'].set_visible(False)\n\n\n# Axes[0] : Pie Chart Custom\nexplode = [0, 0.1]\n\naxes[1].pie(target_count,\n            labels=new_xlabel,\n            colors=color, # color\n            explode=explode, # explode\n            textprops={'fontsize': 12, 'fontweight': 'bold'}, # text setting\n            autopct='%1.1f%%', # notation\n            shadow=True # shadow\n           )\n\nfig.suptitle('Target Distribution', fontsize=13, fontweight='bold') \n\nplt.show()","4708b55d":"fig, ax = plt.subplots(5, 4, figsize=(18, 20))\nfig.set_facecolor('#d0d0d0') \n\nfor i in range(19):\n    # count \n    cnt_tmp = train[f'cat{i}'].value_counts().sort_index()\n    ax[i%5][i\/\/5].bar(cnt_tmp.index, cnt_tmp, color='#244747', label='Count')\n    ax[i%5][i\/\/5].set_yticks([])\n    ax[i%5][i\/\/5].margins(0.05, 0.2)\n    \n    divider = make_axes_locatable(ax[i%5][i\/\/5])\n    cax = divider.append_axes(\"top\", size=\"8%\", pad=0)\n    cax.get_xaxis().set_visible(False)\n    cax.get_yaxis().set_visible(False)\n    cax.set_facecolor('black')\n\n    at = AnchoredText(f'cat{i}', loc=10, \n                      prop=dict(backgroundcolor='black',\n                                size=10, color='white', weight='bold'))\n    cax.add_artist(at)\n    \nax[-1][-1].set_visible(False)\nfig.text(0.018, 1.03, 'Categorical Feature Distribution [Train]', fontsize=20, fontweight='bold', fontfamily='serif')\n\n\nplt.tight_layout()\nplt.show()","235b6919":"for feat in ['cat5','cat7', 'cat8', 'cat10']:\n    print('=================')\n    print(feat)\n    print(f'Total {len(train[feat].unique())}')\n    print(train[feat].value_counts().sort_index().index)\n    \n    print('\\n')","a07b57c0":"# fig, ax = plt.subplots(5, 4, figsize=(18, 20))\n# fig.set_facecolor('#d0d0d0') \n\n# for i in range(19):\n#     # count \n#     cnt_tmp = test[f'cat{i}'].value_counts().sort_index()\n#     ax[i%5][i\/\/5].bar(cnt_tmp.index, cnt_tmp, color='#244747', label='Count')\n#     ax[i%5][i\/\/5].set_yticks([])\n#     ax[i%5][i\/\/5].margins(0.05, 0.2)\n    \n#     divider = make_axes_locatable(ax[i%5][i\/\/5])\n#     cax = divider.append_axes(\"top\", size=\"8%\", pad=0)\n#     cax.get_xaxis().set_visible(False)\n#     cax.get_yaxis().set_visible(False)\n#     cax.set_facecolor('black')\n\n#     at = AnchoredText(f'cat{i}', loc=10, \n#                       prop=dict(backgroundcolor='black',\n#                                 size=10, color='white', weight='bold'))\n#     cax.add_artist(at)\n    \n# ax[-1][-1].set_visible(False)\n# fig.text(0.018, 1.03, 'Categorical Feature Distribution [Test]', fontsize=20, fontweight='bold', fontfamily='serif')\n\n\n# plt.tight_layout()\n# plt.show()","b66a90c1":"fig, ax = plt.subplots(3, 4, figsize=(17, 12), sharex=True)\nfig.set_facecolor('#d0d0d0') \n\nfor i in range(11): \n    sns.kdeplot(data=train[train['target']==1], x=f'cont{i}', \n                fill=True,\n                linewidth=0,\n                color='#244747', alpha=1,\n                ax=ax[i%3][i\/\/3])\n    \n    sns.kdeplot(data=train[train['target']==0], x=f'cont{i}', \n                fill=True,\n                linewidth=0,\n                color='#d0d0d0', alpha=0.8,\n                ax=ax[i%3][i\/\/3])\n    \n    ax[i%3][i\/\/3].set_yticks([])\n    ax[i%3][i\/\/3].set_xlabel('',visible=False)\n    ax[i%3][i\/\/3].margins(0.05, 0.2)\n    \n    # dviider\n    divider = make_axes_locatable(ax[i%3][i\/\/3])\n    cax = divider.append_axes(\"top\", size=\"8%\", pad=0)\n    cax.get_xaxis().set_visible(False)\n    cax.get_yaxis().set_visible(False)\n    cax.set_facecolor('black')\n\n    at = AnchoredText(f'cont{i}', loc=10, \n                      prop=dict(backgroundcolor='black',\n                                size=10, color='white', weight='bold'))\n    cax.add_artist(at)\n    \nax[-1][-1].set_visible(False)\nfig.text(0.018, 1.03, 'Continuous Feature Distribution [Train]', fontsize=20, fontweight='bold', fontfamily='serif')\n\nplt.tight_layout()\nplt.show()","e098f878":"# fig, ax = plt.subplots(3, 4, figsize=(17, 12), sharex=True)\n# fig.set_facecolor('#d0d0d0') \n\n# for i in range(11): \n#     sns.kdeplot(data=test, x=f'cont{i}', \n#                 fill=True,\n#                 linewidth=0,\n#                 color='#244747', alpha=1,\n#                 ax=ax[i%3][i\/\/3])\n#     ax[i%3][i\/\/3].set_yticks([])\n#     ax[i%3][i\/\/3].set_xlabel('',visible=False)\n#     ax[i%3][i\/\/3].margins(0.05, 0.2)\n    \n#     # dviider\n#     divider = make_axes_locatable(ax[i%3][i\/\/3])\n#     cax = divider.append_axes(\"top\", size=\"8%\", pad=0)\n#     cax.get_xaxis().set_visible(False)\n#     cax.get_yaxis().set_visible(False)\n#     cax.set_facecolor('black')\n\n#     at = AnchoredText(f'cont{i}', loc=10, \n#                       prop=dict(backgroundcolor='black',\n#                                 size=10, color='white', weight='bold'))\n#     cax.add_artist(at)\n    \n# ax[-1][-1].set_visible(False)\n# fig.text(0.018, 1.03, 'Continuous Feature Distribution [Test]', fontsize=20, fontweight='bold', fontfamily='serif')\n\n# plt.tight_layout()\n# plt.show()","6ab7a7c1":"fig, ax = plt.subplots(1, 1, figsize=(10, 10))\nfig.set_facecolor('#d0d0d0') \ncorr = train.drop('id', axis=1).corr()\nmask = np.triu(np.ones_like(corr, dtype=bool))\n\nsns.heatmap(corr, \n            square=True, \n            linewidth=0.2,\n            cbar=False,\n            mask=mask,\n            annot=True,\n            center=0,\n            cmap=sns.diverging_palette(240, 10),\n            ax=ax)\n\nfig.text(0.075, 1, 'Correlation: Continuous Feature & Target', fontweight='bold', fontfamily='serif', fontsize=15) \nax.set_xticklabels(ax.get_xticklabels(), fontfamily='serif', rotation=90, fontsize=11)\nax.set_yticklabels(ax.get_yticklabels(), fontfamily='serif', rotation = 0, fontsize=11)\nplt.tight_layout()\nplt.show()","63c7493e":"sns.pairplot(train.iloc[:,11:].sample(10000), kind=\"hist\", corner=True)","66265549":"from umap import UMAP\n\n# Dimension Reduction\ntrain_sub = train.sample(30000)\ntarget = train_sub['target'] \ndata_sub = train_sub.drop([col for col in train.columns if 'cat' in col], axis=1)\n\numap = UMAP(random_state=0)\ntrain_umap = umap.fit_transform(data_sub, target)","d48c3142":"fig, ax = plt.subplots(2, 2, figsize=(12, 12))\n\nax[0][0].scatter(train_umap[target==1][:,0], train_umap[target==1][:,1], c='#8abbd0', alpha=0.25, label='Target:1')\nax[0][0].scatter(train_umap[target==0][:,0], train_umap[target==0][:,1], c='#4a4a4a', alpha=0.25, label='Target:0')\n\n\nax[0][1].set_visible(False)\n\nax[1][0].scatter(train_umap[target==1][:,0], train_umap[target==1][:,1], c='#8abbd0', alpha=0.25, label='Target:1')\nax[1][1].scatter(train_umap[target==0][:,0], train_umap[target==0][:,1], c='#4a4a4a', alpha=0.25, label='Target:0')\n\nfor i in range(2):\n    for j in range(2):\n        ax[i][j].set_xticks([])\n        ax[i][j].set_yticks([])\n        for s in [\"top\",\"right\",\"left\", 'bottom']:\n            ax[i][j].spines[s].set_visible(False)\n\n        ax[i][j].legend()\n\n# Text Part\nfig.text(0.97, 1, '[UMAP] Embedding Space', fontweight='bold', fontfamily='serif', fontsize=20, ha='right')   \n\nfig.text(0.97, 0.94, '''\nIn dimension reduction, \nyou can see that the data with target=0 are gathered in the center.\nPerformance can be expected when used as a feature.\n\n''', \n         fontweight='light', fontfamily='serif', fontsize=12, va='top', ha='right')           \n        \nplt.tight_layout()\nplt.show()\n\n\n","54c09f91":"## Correlation between Feature","a8abee89":"## Continuous Feature Distribution \n\n- gray for negative\n- green for positive","a27bc044":"## Categorical Feature Distribution","68b21bd8":"## UMAP\n\nOnly Use Continuous Feature for Dimension Reduction","60115d34":"## Target Distribution","fa491230":"## Pair Grids"}}