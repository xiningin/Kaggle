{"cell_type":{"748448b3":"code","59ec4b75":"code","00437549":"code","28952a9d":"code","21095be6":"code","e3f21b6f":"code","ad4913c1":"code","38722967":"code","1488dca3":"code","eb1242a5":"code","25fb2c19":"code","cf867f4a":"code","e3c761e5":"code","0591fb55":"code","7357305a":"code","2d53574f":"code","a675dbc5":"code","f84a19af":"code","cc839da3":"code","4c26317e":"code","d61738da":"code","ec468181":"code","1956bd4b":"code","559feb82":"code","762f536d":"code","23d730fb":"code","f520a00e":"code","20c56b07":"code","f0fa16fc":"code","31744acb":"markdown","c35f0773":"markdown","7dece543":"markdown","b6aecafc":"markdown","5fc3ada5":"markdown","3b51a707":"markdown","859edf03":"markdown","0ec45c1b":"markdown","b9230f6d":"markdown","1fa7e5d0":"markdown","191068f0":"markdown","da127578":"markdown","6bffc999":"markdown","6f1f9230":"markdown","5a64889c":"markdown"},"source":{"748448b3":"import os\nimport random\nimport platform\n\nimport numpy as np\nimport pandas as pd\nimport matplotlib\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport sklearn","59ec4b75":"!pip freeze > requirements.txt","00437549":"print('Python version:', platform.python_version())\nprint('Numpy version:', np.__version__)\nprint('Pandas version:', pd.__version__)\nprint('Matplotlib version:', matplotlib.__version__)\nprint('Seaborn version:', sns.__version__)\nprint('Scikit-Learn version:', sklearn.__version__)","28952a9d":"SEED = 42\n\nos.environ['PYTHONHASHSEED']=str(SEED)\nrandom.seed(SEED)\nnp.random.seed(SEED)","21095be6":"pd.set_option('display.width', None)\npd.set_option('display.max_column', None)","e3f21b6f":"!ls \/kaggle\/input\n!ls \/kaggle\/input\/student-shopee-code-league-marketing-analytics","ad4913c1":"df_train = pd.read_csv('\/kaggle\/input\/student-shopee-code-league-marketing-analytics\/train.csv')\ndf_train","38722967":"df_test = pd.read_csv('\/kaggle\/input\/student-shopee-code-league-marketing-analytics\/test.csv')\ndf_test","1488dca3":"df_users = pd.read_csv('\/kaggle\/input\/student-shopee-code-league-marketing-analytics\/users.csv')\ndf_users","eb1242a5":"df_train.dtypes","25fb2c19":"df_test.dtypes","cf867f4a":"df_users.dtypes","e3c761e5":"df_train.isnull().sum()","0591fb55":"df_test.isnull().sum()","7357305a":"df_users.isnull().sum()","2d53574f":"print(np.sort(df_train['country_code'].unique()))\nprint(np.sort(df_test['country_code'].unique()))","a675dbc5":"print(np.sort(df_users['attr_1'].unique()))\nprint(np.sort(df_users['attr_2'].unique()))\nprint(np.sort(df_users['attr_3'].unique()))\nprint(np.sort(df_users['domain'].unique()))","f84a19af":"df_train.corr()","cc839da3":"list_unique = df_users['domain'].unique()\ndict_unique = {list_unique[i]: i for i in range(len(list_unique))}\ndf_users['domain'] = df_users['domain'].apply(lambda d: dict_unique[d])","4c26317e":"dict_unique","d61738da":"def convert(day):\n    try:\n        return np.float(day)\n    except:\n        return np.nan","ec468181":"df_train['last_open_day'] = df_train['last_open_day'].apply(convert)\ndf_train['last_login_day'] = df_train['last_login_day'].apply(convert)\ndf_train['last_checkout_day'] = df_train['last_checkout_day'].apply(convert)\n\ndf_test['last_open_day'] = df_test['last_open_day'].apply(convert)\ndf_test['last_login_day'] = df_test['last_login_day'].apply(convert)\ndf_test['last_checkout_day'] = df_test['last_checkout_day'].apply(convert)","1956bd4b":"df_train = df_train.join(df_users, on='user_id', rsuffix='_unused')\ndf_test = df_test.join(df_users, on='user_id', rsuffix='_unused')","559feb82":"del df_train['user_id']\ndel df_train['user_id_unused']\ndel df_train['row_id']\n\ndel df_test['user_id']\ndel df_test['user_id_unused']\ndel df_test['row_id']","762f536d":"df_train","23d730fb":"df_test","f520a00e":"df_users","20c56b07":"df_train.to_csv('train_processed.csv', index=False)\ndf_test.to_csv('test_processed.csv', index=False)\ndf_users.to_csv('users_processed.csv', index=False)","f0fa16fc":"df_train.to_parquet('train_processed.parquet', engine='pyarrow')\ndf_test.to_parquet('test_processed.parquet', engine='pyarrow')\ndf_users.to_parquet('users_processed.parquet', engine='pyarrow')","31744acb":"## 2. Null","c35f0773":"## 3. User ID","7dece543":"## 4. Drop Column","b6aecafc":"## 1. Domain","5fc3ada5":"# Dataset","3b51a707":"# Preprocess","859edf03":"# Check","0ec45c1b":"# Inspect","b9230f6d":"## 1. dtype","1fa7e5d0":"# Library","191068f0":"## 4. Corelation","da127578":"# Save","6bffc999":"# Changelog\n\n## Version 1\n\n* Initial code","6f1f9230":"## 3. Unique value","5a64889c":"## 2. last_{}_day"}}