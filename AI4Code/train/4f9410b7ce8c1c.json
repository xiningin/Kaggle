{"cell_type":{"f421a089":"code","30c90159":"code","38a1dac0":"code","f1a50b7e":"code","4396bacd":"code","39c594c6":"code","597d0d8f":"code","9d8fe940":"code","5fab7851":"code","a7df3b44":"code","715620d2":"code","8ca63c74":"code","eeea0cc7":"code","bad9d2db":"code","92b4c187":"code","631cd982":"code","b21d27f5":"code","05223393":"code","e11224fb":"code","75d50241":"code","aabf452c":"code","25abad08":"code","1056f084":"code","efeeb9eb":"code","56af4dec":"code","e6f17f4e":"code","ee1eda59":"code","c1b5de73":"markdown","623bf586":"markdown","e31c0584":"markdown","93563d54":"markdown","c2285cad":"markdown","2bccd340":"markdown","6094243a":"markdown","980a4612":"markdown","d51d3fd2":"markdown","8ba8fd70":"markdown","bd865f7f":"markdown","892dc0ab":"markdown","bfbc9a57":"markdown","786dd45e":"markdown"},"source":{"f421a089":"import glob\nimport os\nimport pandas as pd\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.metrics import mean_squared_error\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom sklearn.model_selection import GridSearchCV","30c90159":"# loading data \ndf = pd.read_csv('..\/input\/used-car-dataset-ford-and-mercedes\/ford.csv')\ndf.head()","38a1dac0":"df.shape","f1a50b7e":"df.isna().sum()","4396bacd":"# this transformer will convert any giving categoricol column to numerical\ndef simple_transformer(column):\n    # all unique values for column \n    names = column.value_counts().index\n    # how size of them\n    size = len(names)\n    # create dict value:name \/ ex: {1:'Focus'}... \n    replacement = dict(zip(names, range(size)))\n    # aplly the changes\n    column.replace(replacement, inplace=True)\n    return replacement","39c594c6":"df['model'].value_counts().plot(kind='bar');","597d0d8f":"df['model'].head()","9d8fe940":"simple_transformer(df['model'])","5fab7851":"df['model'].head()","a7df3b44":"df['year'].value_counts().plot(kind='bar');","715620d2":"df['transmission'].value_counts().plot(kind='bar');","8ca63c74":"df['transmission'].head()","eeea0cc7":"simple_transformer(df['transmission'])","bad9d2db":"df['transmission'].head()","92b4c187":"df['fuelType'].value_counts().plot(kind='bar');","631cd982":"df['fuelType'].head()","b21d27f5":"simple_transformer(df['fuelType'])","05223393":"df['fuelType'].head()","e11224fb":"X = df.drop('price', axis=1)\nX.head()","75d50241":"y = df.price\ny.head()","aabf452c":"y.plot.hist();","25abad08":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size= 0.25, random_state=33) \nclf = RandomForestRegressor()\nclf.fit(X_train, y_train)\nbase_accuracy = clf.score(X_test, y_test)\nbase_accuracy","1056f084":"y_pred = clf.predict(X_test)\nRMSE = np.sqrt(mean_squared_error(y_test, y_pred)) \nprint('RMSE Value = ', RMSE)","efeeb9eb":"corr = df.corr()\nf, ax = plt.subplots(figsize=(10, 8))\nsns.heatmap(corr, annot=True, fmt='.2f', ax=ax);","56af4dec":"f_dict = dict(zip(X.columns , list(clf.feature_importances_)))\nf_data = pd.DataFrame(f_dict, index=[0])\nf_data.T.plot.bar(title=\"Feature Importance\", legend=False);","e6f17f4e":"param_grid = {\n    'bootstrap': [True],\n    'max_depth': [15, 55, 100],\n    'max_features': [2, 3],\n    'min_samples_leaf': [2, 3],\n    'min_samples_split': [7, 8],\n    'n_estimators': [400, 500]\n}\nrf = RandomForestRegressor(random_state=33)\ngrid_search = GridSearchCV(estimator = rf, param_grid = param_grid, \n                          cv = 3, n_jobs = -1, verbose = 2, scoring=\"neg_root_mean_squared_error\")\ngrid_search.fit(X_train, y_train)\n","ee1eda59":"best_grid = grid_search.best_estimator_\nprint('best grid = ', best_grid)\ngrid_RMSE = grid_search.score(X_test, y_test)\nprint('Grid RMSE Value = ', (grid_RMSE)*-1)","c1b5de73":"## Converting categorical columns to numericals","623bf586":"## GridSearcheCV","e31c0584":"### Aplying the transformer only to this columns : Model, FuelType, Transmission ","93563d54":"### FuelType","c2285cad":"## Cheking Na values","2bccd340":"## Transmission","6094243a":"## Feauter importance","980a4612":"### Year","d51d3fd2":"## Modeling","8ba8fd70":"## Feauters \/ Target","bd865f7f":"### Model","892dc0ab":"## Corr","bfbc9a57":"## Ford Dataset","786dd45e":"## Libs import"}}