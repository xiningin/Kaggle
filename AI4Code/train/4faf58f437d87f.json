{"cell_type":{"802e12ee":"code","83e2debd":"code","4b748028":"code","77bd4f79":"code","4eb683f3":"code","0073e7bf":"code","af5c05ee":"markdown","11c279d3":"markdown","f098b842":"markdown","8227706c":"markdown","fdfb7665":"markdown"},"source":{"802e12ee":"# import libraries\nimport pandas as pd\nfrom datetime import datetime\nimport sqlite3","83e2debd":"%time\n\n# 1. create `sqlite` connection\n# =============================\n# works for `.db` file too\ncon = sqlite3.connect('..\/input\/amazon-fine-food-reviews\/database.sqlite')\n    \n\n# 2. Define sqlite query\n# ======================\nTABLE_NAME = 'Reviews'\nq = \\\nf\"\"\"\nSELECT \n    count(*) as 'Num of rows'\nFROM \n    {TABLE_NAME}\n\"\"\"\n\n# execute\ndf = pd.read_sql_query(q, con)\n\ndf","4b748028":"df[\"Num of rows\"][0]","77bd4f79":"# cols names: SELECT * FROM TNAME\n# Id\tProductId\tUserId\tProfileName\tHelpfulnessNumerator\tHelpfulnessDenominator\tScore\tTime\tSummary\tText\n\n# Check duplicates based on these cols\nSUBSET = \"ProductId, UserId, ProfileName, Time\"\n\nq = \\\nf\"\"\"\nSELECT \n    {SUBSET}, COUNT(*) as dup_counts \nFROM \n    {TABLE_NAME} \nGROUP BY \n    {SUBSET}\n\"\"\"\n\n# execute\nbeg = datetime.now()\ndf_unique = pd.read_sql_query(q, con)\nend = datetime.now()\n\nprint(\"Data retained after deduplication: \", len(df_unique)\/df[\"Num of rows\"][0])\nprint(f\"Executed in {end-beg} secs\")","4eb683f3":"# 1. read file\ndf_with_dups = pd.read_csv(\"..\/input\/amazon-fine-food-reviews\/Reviews.csv\")\n\n# 2. sort any of the cols\n# https:\/\/pandas.pydata.org\/pandas-docs\/stable\/reference\/api\/pandas.DataFrame.sort_values.html\n# supports multiple idxs as well\ndf_sorted = df_with_dups.sort_values(by='ProductId', ascending=True)\n\n# 3. Remove duplicates (in-place) based on `subset` cols\nsubset = [\"ProductId\", \"UserId\", \"ProfileName\", \"Time\"]\ndf_sorted.drop_duplicates(subset=subset, keep='first', inplace=True)","0073e7bf":"print(\"Data retained after deduplication: \", len(df_sorted)\/len(df_with_dups))","af5c05ee":"**Count num of samples**","11c279d3":"## 02. Using `.csv` file","f098b842":"# Deduplication\n\n> *Removing duplicate rows(data samples)*\n\n- `.sqlite` or `.db` file\n- `.csv` file","8227706c":"**Count duplicates samples**","fdfb7665":"## 01. Using `.sqlite` File"}}