{"cell_type":{"661b5e91":"code","f6175f96":"code","ad4574fa":"code","2c58d124":"code","674e21ca":"code","32876082":"code","290c775f":"code","9c44f943":"code","4646831e":"code","42a4c0f4":"code","dd55f4a1":"code","7d8b6fea":"code","7985fe32":"code","2faa3977":"code","07d380d5":"code","15b38fce":"code","d7e3581b":"code","07df4f6f":"code","48b2f594":"code","ebee0f71":"code","1f7ae0e6":"code","05d99b9f":"code","2b6197ad":"code","f268aeec":"code","de853bf4":"code","c8547622":"code","0fbaeb31":"code","c8de233c":"code","a03a3a74":"code","6a4d56a5":"markdown","d02c3974":"markdown","a2f91de7":"markdown","409ba9ee":"markdown","3014838d":"markdown","e3c4883a":"markdown","f043f6b4":"markdown","97762d79":"markdown","6d6e5c9b":"markdown","4e7a9bf8":"markdown","41f808b8":"markdown","86ca7c87":"markdown","e542e27b":"markdown","99120e87":"markdown","aa386816":"markdown","780ac8b1":"markdown","3ceaac76":"markdown","fb47fc72":"markdown","2143dd26":"markdown","d00e4e86":"markdown","7d2c55ad":"markdown","0a57dd13":"markdown","69cffa79":"markdown","d3c45d43":"markdown","2369880d":"markdown","57112ae0":"markdown","fe844087":"markdown","ea530d1b":"markdown","4b5195bd":"markdown","f8b1a333":"markdown","01030bbb":"markdown","49d8a2cd":"markdown","30258d3a":"markdown","c377b97f":"markdown"},"source":{"661b5e91":"import pandas as pd \nimport numpy as np \nimport matplotlib.pyplot as plt \nimport seaborn as sns\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.model_selection import train_test_split\nprint('Libraries imported successfully')","f6175f96":"df = pd.read_csv('..\/input\/FuelConsumptionCo2.csv')\nprint('Dataset imported successfully')","ad4574fa":"df.shape","2c58d124":"df.head()","674e21ca":"df.info()","32876082":"df.corr()","290c775f":"cdf = df[['ENGINESIZE', 'CYLINDERS', 'FUELCONSUMPTION_COMB', 'CO2EMISSIONS']]\nprint('Dataframe CDF created successfully')","9c44f943":"cdf.head()","4646831e":"cdf.corr()","42a4c0f4":"sns.regplot(cdf.ENGINESIZE, cdf.CO2EMISSIONS)\nsns.regplot(cdf.CYLINDERS, cdf.CO2EMISSIONS)\nsns.regplot(cdf.FUELCONSUMPTION_COMB, cdf.CO2EMISSIONS)\nplt.ylabel('CO2 Emission')\nplt.legend(('Engine Size', 'Cylinders', 'Fuel Consupmtion'))\nplt.show()","dd55f4a1":"# creating x,y\nx = cdf.iloc[:,0:3]\ny = cdf.CO2EMISSIONS\ny = y.to_frame()","7d8b6fea":"# taking a look at x,y","7985fe32":"x.head()","2faa3977":"y.head()","07d380d5":"x_train, x_test, y_train, y_test = train_test_split(x,y, test_size = 0.2)","15b38fce":"print ('x_train quantity: ', len(x_train))\nprint ('y_train quantity: ', len(y_train))\nprint ('x_test quantity: ', len(x_test))\nprint ('y_test quantity: ', len(y_test))","d7e3581b":"lm = LinearRegression()","07df4f6f":"lm.fit(x_train, y_train)","48b2f594":"# b0 = lm.intercept_ \n# b1 = lm.coef_","ebee0f71":"lm.intercept_","1f7ae0e6":"lm.coef_","05d99b9f":"yhat = lm.predict(x_test)","2b6197ad":"lm.score(x_test, y_test)","f268aeec":"yhatdf = pd.DataFrame(yhat)\nyhatdf.columns = ['PredictedValues']\nyhatdf = yhatdf.PredictedValues.astype(int).to_frame()","de853bf4":"actualval = y_test\nactualval.columns = ['ActualValues']","c8547622":"lastdf = pd.concat([yhatdf.reset_index(drop=True), actualval.reset_index(drop=True)], axis = 1, sort = False)","0fbaeb31":"lastdf","c8de233c":"sns.residplot(y_test, yhat)\nplt.title('Residual plot of YHAT x Y_TEST')\nplt.show()","a03a3a74":"sns.distplot(y_test, hist = False, label = 'Actual values')\nsns.distplot(yhat, hist = False, label = 'Predicted values')\nplt.title('Comparison of predicted values with actual values')\nplt.show()","6a4d56a5":"_We can see that some informations are not really necessary to create a predictive model, but we will analyze that further on the notebook._","d02c3974":"**We can see throughout this graph that the model is accurate and can successfully predict the CO2 Emission with a low rate of error.**","a2f91de7":"### Predicting CO2 Emission (y_test) using the data from x_test:","409ba9ee":"### One-to-one comparison","3014838d":"# Creating the dataframes to train and test the model","e3c4883a":"### Creating Linear Regression Object","f043f6b4":"## Checking the R-square","97762d79":"### Importing the dataset","6d6e5c9b":"**We can see that the residual plot shows us a well-distributed data, confirming the quality of the model.**","4e7a9bf8":"# Creating the predictive model","41f808b8":"### Importing necessary libraries\n\n_This libraries are essential for working, analyzing and visualizing data as such as creating machine learning models._","86ca7c87":"# Authors\n**Ruben Acevedo**,\n_Bachelor in Computer Engineering._\n\n\n\n\n\nIf you need to contact me, please send me an e-mail: rubenfsolorzano@hotmail.com.\n\n### Thanks!","e542e27b":"_We can check that there's no missing data and all the attributes have the correct data type, so we can continue on creating the predictive model._","99120e87":"### Familiarizing with data\n\nHere we'll check the basics to understand the data we're dealing with.\nWe'll take a look on descriptive statistics, data types and search for missing data.","aa386816":"# Exploratory Data Analysis","780ac8b1":"## Comparing actual values with predicted values","3ceaac76":"### Let's take a look at the df created:","fb47fc72":"### Creating the model","2143dd26":"_So we have a 1067 rows and 13 columns dataset._","d00e4e86":"**We can now create the model:**\n\n**yhat = 65.57 + 11.165*ENGINESIZE + 7.31*CYLINDERS + 9.58*FUELCONSUMPTION_COMB**","7d2c55ad":"# Choosing the attributes for the model\n## Checking the correlation between attributes\nThis step is necessary to pick the best attributes for creating the predictive model.\n\nIn here, we'll analyze the correlation between the attributes and visualize them after choosing.\n\n**Observation:** The correlation we're trying to analyze is between attributes x CO2EMISSIONS","0a57dd13":"**The closer this value is to 1, the better becomes the model. This score looks like a good value for our model so there's no need to create a new one.**","69cffa79":"### Checking the dataframes","d3c45d43":"## Creating and analyzing the dataframe with the chosen attributes","2369880d":"**Considering yhat = b0 + b1*x1 + b2*x2 + b3*x3,**","57112ae0":"**We can see at the scatter plot that is possible to create a linear model to fit the actual values in the chose dataset attributes.**","fe844087":"_We can see that most of them have a good correlation with CO2EMISSIONS, so to avoid overfitting we'll choose three to create the model. After evaluation, if necessary, we'll add more attributes to the model._\n\n_The attributes I chose are: ENGINESIZE, CYLINDERS and FUELCONSUMPTIONCOMB._","ea530d1b":"### Creating a residual plot to check if it's well distributed","4b5195bd":"### Creating the dataframes","f8b1a333":"# Introduction\n\nIn this Notebook I'll show you how to implement Multiple Linear Regression to create accurate predictions. \n\nThe dataset presented on this notebooks brings data of 2014 cars such as engine size, fuel consumption and CO2 emission. \n\nAt the end of this analysis we'll be able to create a predictive model to predict the CO2 emission of 2014 cars based on the data of the car models and compare it with the actual CO2 emission values.\n\nTo measure and understand the CO2 emission is extremely important to maintain a suitable environment for all living beings on earth.","01030bbb":"# Machine Learning: Using Multiple Linear Regression to predict 2014 cars CO2 Emission","49d8a2cd":"## Creating and checking Train\/Test Dataframes","30258d3a":"**Finally, let's compare graphically yhat and y_test:**","c377b97f":"# Evaluating the model"}}