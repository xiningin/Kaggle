{"cell_type":{"bc4d94a7":"code","e86c526d":"code","496efe08":"markdown","f2fb700f":"markdown","cc730113":"markdown","579c9827":"markdown"},"source":{"bc4d94a7":"import mysql.connector\nconn=mysql.connector.connect(host=\"localhost\",user=\"root\",passwd=\"1234\", database=\"sundeep\")\n\ncur=conn.cursor()\n\ncur.execute(\"create table students(rollno int primary key, name varchar(30), percentage float, branch varchar(10))\")\n\nconn.close()","e86c526d":"import mysql.connector\nimport xlrd # make sure to downalod an older version of xlrd  (1.2.0)\nxlrd.xlsx.ensure_elementtree_imported(False, None) #if you still have trouble executing xlrd and receive an error message about attributes, \nxlrd.xlsx.Element_has_iter = True #then make sure to insert these 2 lines of code to change the setting. Then it should run\n\nconn = mysql.connector.connect(host=\"localhost\", user=\"root\", passwd=\"1234\", database=\"sundeep\")\n\ncur = conn.cursor()\n\nloc = (\"C:\\\\Users\\\\fores\\\\OneDrive\\\\Documents\\\\Portfolio\\\\SQL Project\\\\Import_stu_data_ from_Exc_SQL\\\\student.xlsx\")\n\nl =list()\n\na = xlrd.open_workbook(loc)\n\nsheet=a.sheet_by_index(0)\n\nsheet.cell_value(0,0)\n\nfor i in range(1, 21): # the # of columns\n    l.append(tuple(sheet.row_values(i))) #the # of columns  \n    #In order to insert the data to SQL, you need to rearrange your data from data frame format to \n    #array\/list (tupple) format \n    #Examples: [(501.0, 'Liam', 93.5, 'CSE'), (502.0, 'Noah', 83.0, 'CSE'), \n    #(503.0, 'Oliver', 36.8, 'CSE'), ...]\n\n#print(l)\n\nq=\"insert into students(rollno, name, percentage, branch)values(%s, %s, %s, %s)\"\n#%s = formatted the string variable. I have 4 variables in my dataset, so I need 4 %s\n\ncur.executemany(q,l)\nconn.commit() #in order to execute the queries, this function is need, otherwise, \n#the data values will not be imported to SQLserver\nconn.close()\n\n","496efe08":"Create a new schema (dataset) in SQL:\nStep 1: click on the first icon on the left-hand upper cornder\nStep 2: Give your schema a name you like\nStep 3: Then click on apply at the right-hand bottom corner.\nCongratulations, you have created an empty dataset. \n![image.png](attachment:37425980-9ade-4ab2-83bc-db70a3c28a7c.png)","f2fb700f":"Then, you need to connect to your SQL local server with the first chunk of codes shown below.\nMake sure to designate your first variable as the **\"primary key\"** while entering your variable names and types.\nFor example, I designated \"rollno to be the primary key, and it is an integer. The second variable is student name, which I called it name. Because it is a character variable, so I give a length of 30. The third variable is percentage which consists of whole number and decimnal digits, so the variable type is float. \nAfter you run, an empty sheet with the four variables appears in SQL server table.","cc730113":"In the CMD, it should look something like this\n![image.png](attachment:28504576-1e2b-4376-b4d2-e164dc0b763e.png)\n\nIn the SQL server, the table looks like the following:\n![image.png](attachment:63c01a0e-619f-4450-88af-7d2853a29927.png)\n","579c9827":"Note: if you have noy download the two modules (connector and xrld), then make sure to download and install them to your python. \n\nI had trouble using the newest version of xrld, so I chose to install the older version. \nAfter successfully installed the older version, I still ran into problem with attributes errors with iterations, I found the solution to my problem with the two following codes. See more explanation on the side of my codes. \nThe rest should be self-explanatory."}}