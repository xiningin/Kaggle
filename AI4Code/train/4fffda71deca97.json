{"cell_type":{"4be3f3a2":"code","8bbbf0c1":"code","1283a524":"code","90a83fdf":"code","ccc79446":"code","464de664":"code","b05b433f":"code","38d078e3":"code","047ea083":"code","11cbe100":"code","e1d5c4e6":"code","fcbfdfa2":"code","1529d56a":"code","88d113ec":"code","59e7ecc1":"code","d1ed5583":"code","7aa922c2":"code","790699c0":"code","507db25f":"code","50a654ec":"code","bfc36a8d":"code","a6a90754":"code","8c44ddfb":"code","6b6c3be8":"code","9d4ea4cf":"code","c7544f73":"code","c239e587":"code","cb1125fb":"code","f1fb0b8b":"code","31fb7129":"code","67bf9852":"code","84882d49":"code","0c723944":"code","811f4865":"code","dc7c3e5b":"code","50781314":"code","98ec8104":"code","c90739cf":"code","b2bce0cc":"code","3fa34d19":"code","4fdf7749":"code","3f1d75e3":"code","9cfa5606":"code","5f28e756":"code","9ff59126":"code","a216b6a0":"code","4f8bffd1":"code","480bcdbb":"code","e3cbbbc3":"code","239635fd":"code","7b98b58a":"code","11ec8a44":"code","60cd68f7":"code","443e5d4a":"code","42b9ebae":"code","4511ea33":"code","c98420bd":"code","75b40119":"code","8f29f9ca":"code","e830a9cd":"code","0ce5905a":"code","5cb78249":"code","473b24bb":"code","6973dbbe":"code","3b0ce894":"code","0296ca8d":"code","9e574862":"code","c00e01b6":"code","da5b5c6f":"markdown","49fa0283":"markdown","cb2e8980":"markdown","dd365904":"markdown","23600292":"markdown","cdab0244":"markdown","1d24a7da":"markdown","5d22e04b":"markdown","6c72307d":"markdown","41711fc5":"markdown","68f3427a":"markdown","55165a8d":"markdown"},"source":{"4be3f3a2":"# Importing all libraries required.\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\n# set it to convert scientific values\npd.options.display.float_format = '{:.2f}'.format \n\n# Regular expressions for string manipulation\nimport re\n\n# Ignore warnings due to version problems\nimport warnings\nwarnings.filterwarnings('ignore')","8bbbf0c1":"# Read CSV file and check it's attributes before proceeding further.\n# Reading CSV file with dtype object. I will draw correlation among few variables not all so when it needs i will just convert \n# those as per my need for better visibility. So many variables in correlation creates confusion when they don't add much value.\n\nloan = pd.read_csv('..\/input\/loan.csv',dtype=object)\n\n# check shape & datatype of loan data\nprint(loan.shape)\nprint(loan.info())\nprint(loan.dtypes)","1283a524":"# Check for duplicate rows in dataset based on id column\n\nprint(loan.duplicated(subset=None, keep='first').count())\ndup=loan[loan.duplicated(['id'])]\ndup\n\n# There are no duplicate rows in loan dataset","90a83fdf":"# sum it up to check how many rows have all missing values\nprint('Number of empty Rows:')\nprint(loan.isnull().all(axis=1).sum())\n# Observation: There are no empty rows in whole dataset.\n\n# sum it up to check how many columns have all missing values\nprint('Number of empty Columns:')\nprint(loan.isnull().all(axis=0).sum())\n# Observation: There are 54 columns have all missing values.","ccc79446":"# Data cleaning\n# Lets find Which columns have all null values\n\nloan.isnull().sum()","464de664":"# Data cleaning\n# Lets Drop columns where all values are null. Below in sequence all columns have null values\n\nloan.drop(loan.iloc[:, 53:105], inplace = True, axis = 1) ","b05b433f":"# Drop additional columns we don't need these as these are mostly nulls.\n\ncolumns_drop_list1 = [\"desc\",\"mths_since_last_delinq\",\"mths_since_last_record\",\"next_pymnt_d\",\"tot_hi_cred_lim\"]\nloan.drop(labels = columns_drop_list1, axis =1, inplace=True)\ncolumns_drop_list2 = [\"mths_since_last_major_derog\",\"total_bal_ex_mort\",\"total_bc_limit\",\"total_il_high_credit_limit\"]\nloan.drop(labels = columns_drop_list2, axis =1, inplace=True)\ncolumns_drop_list3 = [\"member_id\",\"url\",\"emp_title\",\"zip_code\",\"tax_liens\"]\nloan.drop(labels = columns_drop_list3, axis =1, inplace=True)\n","38d078e3":"# Data cleaning\n# Lets take a look on data shape after dropping columns which had nothing \n\nloan.shape\n\n# Observations\n# So now we are left with 44 columns","047ea083":"# Data cleaning\n# Lets format employment length column to have only numbers. It may play important role in analysis further.\n\nloan.emp_length.fillna('0',inplace=True)\nloan['emp_length']=loan.emp_length.str.extract('(\\d+)')\nloan.head(2)","11cbe100":"# Data cleaning\n# pub_rec_bankruptcies can be cleaned for further analysis.\nprint(\"Before cleaning:\")\nprint(loan.pub_rec_bankruptcies.isnull().sum())\nprint(\"After cleaning:\")\nloan.pub_rec_bankruptcies.fillna('Not Known',inplace=True)\nprint(loan.pub_rec_bankruptcies.isnull().sum())","e1d5c4e6":"# Data cleaning\n# Lets remove % symbol from intrest rate column so that it can be used in calculations\nloan['int_rate'] = loan['int_rate'].str.rstrip('%')\n\n# Lets remove % symbol from revol_util column so that it can be used in calculations\nloan['revol_util'] = loan['revol_util'].str.rstrip('%')","fcbfdfa2":"# convert amount columns into numeric data to find some correlation among important ones.\n\ncols1 = ['loan_amnt','funded_amnt','int_rate','funded_amnt_inv','installment','annual_inc','dti','emp_length','total_pymnt']\nloan[cols1] = loan[cols1].apply(pd.to_numeric)\n","1529d56a":"# Lets take a look on important variable loan status in total loans issued\n\n(loan.loan_status.value_counts()*100)\/len(loan)\n\n# Observations\n# 82.96 percent loans were fully paid.\n# Close to 14% loans were charged off","88d113ec":"# Lets take a look on important variable purpose of loan in total loans issued\n\n(loan.purpose.value_counts()*100)\/len(loan)\n\n# Observations\n# Most of the loans taken for debt consolidation(47%) and Credit card bill payment\n# Other is also one of the main area where loans were taken.","59e7ecc1":"# Derived columns\n# Lets derive some new columns using existing data as it may further used in analysis.\n# create month and year columns separately\n\nloan.issue_d = pd.to_datetime(loan.issue_d, format='%b-%y')\nloan['year']=loan['issue_d'].dt.year\nloan['month']=loan['issue_d'].dt.month\n\nloan.head(1)\n\n# Observations\n# Two new columns month and year were derived from issue date","d1ed5583":"# Basic statistics with .describe() - Quantitative Variables\nloan['loan_amnt'].describe()\n","7aa922c2":"sns.boxplot(loan.loan_amnt)","790699c0":"# Basic statistics with .describe() -Quantitative Variables\nloan.total_pymnt.describe()","507db25f":"sns.boxplot(loan.total_pymnt)","50a654ec":"# Basic statistics with .describe() -Quantitative Variables\n\nprint('Before Removal of Outliers :\\n')\nprint(loan['annual_inc'].describe())\n\n# Data cleaning\n# Remove Outliers quantile .99 from Annual Income\n# it will make it easier to visualize the plots.\n\nloan = loan[loan[\"annual_inc\"] < loan[\"annual_inc\"].quantile(0.99)]\n\nprint('After Removal of Outliers :')\nprint(loan[\"annual_inc\"].describe())\n\n# Now below data looks much better. Lets plot later and find some conclusions","bfc36a8d":"sns.boxplot(loan.annual_inc)","a6a90754":"# Basic statistics with .describe() -Quantitative Variables\n\nloan['int_rate'].describe()\n\n# Average intrest rate is 12 %\n# after 75% percentile interest rate zoom'ed to 25% from 15%.","8c44ddfb":"sns.boxplot(loan.int_rate)","6b6c3be8":"# Bivariate Analysis - Correlation Matrix-Quantitative Variables\n# Heatmap with Dendogram(clustermap) to show closeness among numerical variables.\n\nloan_correlation = loan.corr()\nsns.set(font_scale=1.1)\nsns.clustermap(loan_correlation,annot=True,figsize=(12, 8),cmap=\"BrBG\")\nplt.show()\n\n# Observation is that Loan amount, investor amount, funding amount are strongly correlated.\n# Annual income with DTI(Debt-to-income ratio) is negatively correalted.\n# Debt income ratio is the percentage of a consumer's monthly gross income that goes toward paying debts. \n# That means when annual income is low DTI is high & vice versa.\n# positive correlation between annual income and employment years.\n# That means income increases with work experience ;)","9d4ea4cf":"# Data cleaning\n# Drop additional columns which are not needed further in analysis.\n\ncolumns_drop_list4 = [\"application_type\",\"policy_code\",\"initial_list_status\",\"installment\",\"pymnt_plan\"]\nloan.drop(labels = columns_drop_list4, axis =1, inplace=True)\nprint(loan.shape)\nloan.isnull().sum()","c7544f73":"# Derived columns\n# categorise loan amounts into buckets which will help in analysis further in bivariate analysis.\nloan['loan_amnt_cats'] = pd.cut(loan['loan_amnt'], [0, 7000, 14000, 21000, 28000, 35000], labels=['0-7000', '7000-14000', '14000-21000', '21000-28000', '28000 +'])\n\n# categorise annual incomes into buckets which will help in analysis further in bivariate analysis.\nloan['annual_inc_cats'] = pd.cut(loan['annual_inc'], [0, 20000, 40000, 60000, 80000,1000000], labels=['0-20000', '20000-40000', '40000-60000', '60000-80000', '80000 +'])\n\n# categorise intrest rates into buckets which will help in analysis further in bivariate analysis.\nloan['int_rate_cats'] = pd.cut(loan['int_rate'], [0, 10, 12.5, 16, 20], labels=['0-10', '10-13', '12.5-16', '16 +'])\n\n# categorise dti into buckets for bivariate analysis.\nloan['dti_cats'] = pd.cut(loan['dti'], [0, 5, 10, 15, 20, 25], labels=['0-5', '05-10', '10-15', '15-20', '25+'])\n","c239e587":"# Lets take a look on shape and data\nprint(loan.shape)\nloan.head(1)\n# Observation is we have created extra 5 columns after dropping many.","cb1125fb":"# Lets see distribution of three loan amount fields using distribution plot.\n# Quantitative Variables\n\nplt.figure(figsize=(15,8),facecolor='b')\nsns.set_style(\"dark\")\n# subplot 1\nplt.subplot(2, 3, 1)\nax = sns.distplot(loan['loan_amnt'],rug = True)\nax.set_title('Loan Amount - Distribution Plot',fontsize=14,color='w')\nax.set_xlabel('Loan Amount',fontsize=14,color='w')\n# subplot 2\nplt.subplot(2, 3, 2)\nax = sns.distplot(loan['funded_amnt'],rug = True)\nax.set_title('Funded Amount - Distribution Plot',fontsize=14,color='w')\nax.set_xlabel('Funded Amount',fontsize=14,color='w')\n# subplot 2\nplt.subplot(2, 3, 3)\nax = sns.distplot(loan['funded_amnt_inv'],rug = True)\nax.set_title('Funded Amount Inv. - Distribution Plot',fontsize=14,color='w')\nax.set_xlabel('Funded Amount Inv.',fontsize=14,color='w')\nplt.show()\n\n# Observation: \n# Distribution of amounts for all three looks very much similar.\n# We will work with only loan amount column for rest of our analysis.","f1fb0b8b":"# Univariate Analysis on Loan amount-Quantitative Variables\n\nplt.figure(figsize=(15,8),facecolor='b')\nsns.set_style(\"dark\")\n# subplot 1\nplt.subplot(2, 2, 1)\nax = sns.distplot(loan['loan_amnt'],rug = True)\nax.set_title('Loan Amount - Distribution Plot',fontsize=16,color='w')\nax.set_xlabel('Loan Amount',fontsize=14,color='w')\n# subplot 2\nplt.subplot(2, 2, 2)\nax = sns.boxplot(y=loan['loan_amnt'])\nax.set_title('Loan Amount - Box Plot',fontsize=16,color='w')\nax.set_ylabel('Loan Amount',fontsize=14,color='w')\nplt.show()\n\n# Observations :\n# Below plots show that most of the Loan amounts are in range of 5000 - 15000","31fb7129":"# Univariate Analysis on Intrest Rate-Quantitative Variables\n\nplt.figure(figsize=(15,8),facecolor='b')\nsns.set_style(\"dark\")\n# subplot 1\nplt.subplot(2, 2, 1)\nax = sns.distplot(loan['int_rate'],rug = True)\nax.set_title('Interest Rate - Distribution Plot',fontsize=16,color='w')\nax.set_xlabel('Interest Rate',fontsize=14,color='w')\n# subplot 2\nplt.subplot(2, 2, 2)\nax = sns.boxplot(y=loan['int_rate'])\nax.set_title('Interest Rate - Box Plot',fontsize=16,color='w')\nax.set_ylabel('Interest Rate',fontsize=14,color='w')\nplt.show()\n\n# Observations :\n# Below plots show that most of the Interest Rates on loans are in range of 10% - 15%","67bf9852":"# Univariate Analysis on Annual Income - Quantitative Variables\n\nplt.figure(figsize=(15,8),facecolor='b')\nsns.set_style(\"dark\")\n# subplot 1\nplt.subplot(2, 2, 1)\nax = sns.distplot(loan['annual_inc'],rug = True)\nax.set_title('Annual Income - Distribution Plot',fontsize=16,color='w')\nax.set_xlabel('Annual Income',fontsize=14,color='w')\n# subplot 2\nplt.subplot(2, 2, 2)\nplt.title('Annual Income - Box Plot')\nax = sns.boxplot(y=loan['annual_inc'])\nax.set_title('Annual Income - Box Plot',fontsize=16,color='w')\nax.set_ylabel('Annual Income',fontsize=14,color='w')\nplt.show()\n\n# Observations :\n# Below plots show that most of the borrower's Annual incomes are in range of 40000- 80000","84882d49":"# Univariate Analysis - Unordered Categorical Variables - Loan Status\n\nplt.figure(figsize=(10,8),facecolor='b')\nsns.set_style(\"dark\")\nax = sns.countplot(x=\"loan_status\",data=loan,palette='mako')\nax.set_title('Loan Status',fontsize=14,color='w')\nax.set_xlabel('Loan Status',fontsize=14,color = 'w')\nax.set_ylabel('Loan Application Count',fontsize=14,color = 'w')            \n# To show count of values above bars\ns=loan['loan_status'].value_counts()\nfor i, v in s.reset_index().iterrows():\n    ax.text(i, v.loan_status + 0.3 , v.loan_status, color='k')\n\n# Observations :\n# Below plot shows that close to 14% loans were charged off out of total loan issued.","0c723944":"# Univariate Analysis - Unordered Categorical Variables - Purpose Of Loan\n\nplt.figure(figsize=(14,8),facecolor='b')\nsns.set_style(\"dark\")\nax = sns.countplot(y=\"purpose\",data=loan,hue='loan_status',palette='GnBu_d')\nax.set_title('Purpose Of Loan',fontsize=14,color='w')\nax.set_ylabel('Purpose Of Loan',fontsize=14,color = 'w')\nax.set_xlabel('Loan Application Count',fontsize=14,color = 'w')      \nplt.show()\n\n# Observations :\n# Below plot shows that most of the loans were taken for the purpose of debt consolidation & paying credit card bill.\n# Number of chraged off count also high too for these loans.","811f4865":"# Univariate Analysis - Unordered Categorical Variables - Home Ownership\n\nplt.figure(figsize=(10,6),facecolor='b')\nax = sns.countplot(x=\"home_ownership\",data=loan,hue='loan_status',palette='GnBu_d')\nax.legend(bbox_to_anchor=(1, 1))\nax.set_title('Home Ownership',fontsize=14,color='w')\nax.set_xlabel('Home Ownership',fontsize=14,color = 'w')\nax.set_ylabel('Loan Application Count',fontsize=14,color = 'w')      \nplt.show()\n\n# Observations :\n# Below plot shows that most of them living in rented home or mortgazed their home.\n# Applicant numbers are high from these categories so charged off is high too.","dc7c3e5b":"# Derived Column - Ordered Categorical Variables\n# Let us look into number of loans which were approved every year\/month\n# Lets use derived column year to check pattern of loan issuing over the years.\nplt.figure(figsize=(14,6),facecolor='b')\nloan.groupby(['year','month']).id.count().plot(kind='bar')\nplt.ylabel('Loan applications count',fontsize=14,color='w')\nplt.xlabel('Year,Month',fontsize=14,color = 'w')      \nplt.title(\"No of loan applications issued over the years\",fontsize=14,color='w')\nplt.show()\n\n\n# Observation is that count of loan application is increasing every passing year.\n# so increase in number of loan applications are adding more to number of charged off applications.\n# number of loans issued in 2008( May-October) got dipped, may be due to Recession.","50781314":"# Univariate Analysis - Ordered Categorical Variables- Loan Paying Term\n\nplt.figure(figsize=(10,6),facecolor='b')\nax = sns.countplot(x=\"term\",data=loan,hue='loan_status',palette='GnBu_d')\nax.set_title('Loan Paying Term',fontsize=14,color='w')\nax.set_xlabel('Loan Repayment Term',fontsize=14,color = 'w')\nax.set_ylabel('Loan Application Count',fontsize=14,color = 'w')      \nax.legend(bbox_to_anchor=(1, 1))\nplt.show()\n\n# Observations :\n# Below plot shows that those who had taken loan to repay in 60 months had more % of number of applicants getting \n# charged off as compared to applicants who had taken loan for 36 months.","98ec8104":"# Bivariate Analysis on annual income against Chargedoff_Proportion -\n\ninc_range_vs_loan = loan.groupby(['annual_inc_cats', 'loan_status']).loan_status.count().unstack().fillna(0).reset_index()\ninc_range_vs_loan['Total'] = inc_range_vs_loan['Charged Off'] + inc_range_vs_loan['Current'] + inc_range_vs_loan['Fully Paid'] \ninc_range_vs_loan['Chargedoff_Proportion'] = inc_range_vs_loan['Charged Off'] \/ inc_range_vs_loan['Total']\ninc_range_vs_loan.sort_values('Chargedoff_Proportion', ascending=False)\n\n# Observations:\n# Income range 80000+  has less chances of charged off.\n# Income range 0-20000 has high chances of charged off.\n# Notice that with increase in annual income charged off proportion got decreased. ","c90739cf":"# Lets draw bar plots on data calculated above. Try to visualize the pattern to understand the data better.\n\nfig, ax1 = plt.subplots(figsize=(12, 8),facecolor='b')\nax1.set_title('Annual Income vs Chargedoff Proportion',fontsize=15,color = 'w')\nax1=sns.barplot(x='annual_inc_cats', y='Chargedoff_Proportion', data=inc_range_vs_loan)\nax1.set_ylabel('Chargedoff Proportion',fontsize=14,color = 'w')\nax1.set_xlabel('Annual Income',fontsize=14,color='w')\nplt.show()\n\n# Observations:\n# Income range 80000+  has less chances of charged off.\n# Income range 0-20000 has high chances of charged off.\n# Notice that with increase in annual income charged off proportion got decreased. ","b2bce0cc":"# Bivariate Analysis on purpose of Loan against Chargedoff_Proportion.\n\npurpose_vs_loan = loan.groupby(['purpose', 'loan_status']).loan_status.count().unstack().fillna(0).reset_index()\npurpose_vs_loan['Total'] = purpose_vs_loan['Charged Off'] + purpose_vs_loan['Current'] + purpose_vs_loan['Fully Paid'] \npurpose_vs_loan['Chargedoff_Proportion'] = purpose_vs_loan['Charged Off'] \/ purpose_vs_loan['Total']\npurpose_vs_loan.sort_values('Chargedoff_Proportion', ascending=False)\n\n# Observations:\n# small Business applicants have high chnaces of getting charged off.\n# renewable_energy where chanrged off proportion is better as compare to other categories.","3fa34d19":"# Lets draw bar plots on data calculated above. Try to visualize the pattern to understand the data better.\n# pairs of continuous variables.\nfig, ax1 = plt.subplots(figsize=(14, 8),facecolor='b')\nax1.set_title('Purpose of Loans vs Chargedoff Proportion',fontsize=15,color = 'w')\nax1=sns.barplot(y='purpose', x='Chargedoff_Proportion', data=purpose_vs_loan)\nax1.set_ylabel('Purpose of Loans',fontsize=14,color='w')\nax1.set_xlabel('Chargedoff Proportion',fontsize=14,color = 'w')\nplt.show()\n\n# Observations:\n# small Business applicants have high chances of getting charged off.\n# renewable_energy where chanrged off proportion is better as compare to other categories.","4fdf7749":"# Bivariate Analysis on grade against Chargedoff_Proportion\n\ngrade_vs_loan = loan.groupby(['grade', 'loan_status']).loan_status.count().unstack().fillna(0).reset_index()\ngrade_vs_loan['Total'] = grade_vs_loan['Charged Off'] + grade_vs_loan['Current'] + grade_vs_loan['Fully Paid'] \ngrade_vs_loan['Chargedoff_Proportion'] = grade_vs_loan['Charged Off'] \/ grade_vs_loan['Total']\ngrade_vs_loan.sort_values('Chargedoff_Proportion', ascending=False)\n\n# Observations:\n# Grade \"A\" has very less chances of charged off.\n# Grade \"F\" and \"G\" have very high chances of charged off.\n# Chances of charged off is increasing with grade moving from \"A\" towards \"G\"","3f1d75e3":"# Lets draw bar plots on data calculated above. Try to visualize the pattern to understand the data better.\n\nfig, ax1 = plt.subplots(figsize=(14, 8),facecolor='b')\nax1.set_title('Grades vs Chargedoff Proportion',fontsize=15,color='w')\nax1=sns.barplot(x='grade', y='Chargedoff_Proportion', data=grade_vs_loan)\nax1.set_xlabel('Grades',fontsize=14,color='w')\nax1.set_ylabel('Chargedoff Proportion',fontsize=14,color ='w')\nplt.show()\n\n# Observations:\n# Grade \"A\" has very less chances of charged off.\n# Grade \"F\" and \"G\" have very high chances of charged off.\n# Chances of charged of is increasing with grade moving from \"A\" towards \"G\"","9cfa5606":"# Understanding grades better\n# Bivariate Analysis on sub grade against Chargedoff_Proportion\n\ngrade_vs_loan = loan.groupby(['sub_grade', 'loan_status']).loan_status.count().unstack().fillna(0).reset_index()\ngrade_vs_loan['Total'] = grade_vs_loan['Charged Off'] + grade_vs_loan['Current'] + grade_vs_loan['Fully Paid'] \ngrade_vs_loan['Chargedoff_Proportion'] = grade_vs_loan['Charged Off'] \/ grade_vs_loan['Total']\ngrade_vs_loan.sort_values('Chargedoff_Proportion', ascending=False)\n\n# Observations:\n# sub Grades of \"A\" has very less chances of charged off.\n# sub Grades of \"F\" and \"G\" have very high chances of charged off.\n# proportion of charged off is increasing with sub grades moving from sub grades of \"A\" towards sub grades of \"G\"","5f28e756":"# Lets draw bar plots on data calculated above. Try to visualize the pattern to understand the data better.\n\nfig, ax1 = plt.subplots(figsize=(14, 8),facecolor='b')\nax1.set_title('Sub Grades vs Chargedoff Proportion',fontsize=15,color='w')\nax1=sns.barplot(x='sub_grade', y='Chargedoff_Proportion', data=grade_vs_loan)\nax1.set_xlabel('Sub Grades',fontsize=14,color='w')\nax1.set_ylabel('Chargedoff Proportion',fontsize=14,color = 'w')\nplt.show()\n\n# Observations:\n# sub Grades of \"A\" has very less chances of charged off.\n# sub Grades of \"F\" and \"G\" have very high chances of charged off.\n# proportion of charged off is increasing with sub grades moving from sub grades of \"A\" towards sub grades of \"G\"","9ff59126":"# Bivariate Analysis on interest rate against Chargedoff_Proportion\n\ninterest_vs_loan = loan.groupby(['int_rate_cats', 'loan_status']).loan_status.count().unstack().fillna(0).reset_index()\ninterest_vs_loan['Total'] = interest_vs_loan['Charged Off'] + interest_vs_loan['Current'] + interest_vs_loan['Fully Paid'] \ninterest_vs_loan['Chargedoff_Proportion'] = interest_vs_loan['Charged Off'] \/ interest_vs_loan['Total']\ninterest_vs_loan.sort_values('Chargedoff_Proportion', ascending=False)\n\n# Observations:\n# interest rate less than 10% has very less chances of charged off. Intrest rates are starting from minimin 5 %.\n# interest rate more than 16% has good chnaces of charged off as compared to other category intrest rates.\n# Charged off proportion is increasing with higher intrest rates.","a216b6a0":"# Lets draw some bar plots on data calculated above. Try to visualize the pattern to understand the data better.\n\nfig, ax1 = plt.subplots(figsize=(12, 8),facecolor='b')\nax1.set_title('Interest Rate vs Chargedoff Proportion',fontsize=15,color='w')\nax1=sns.barplot(x='int_rate_cats', y='Chargedoff_Proportion', data=interest_vs_loan)\nax1.set_xlabel('Interest Rate',fontsize=14,color='w')\nax1.set_ylabel('Chargedoff Proportion',fontsize=14,color = 'w')\nplt.show()\n\n# Observations:\n# interest rate less than 10% has very less chances of charged off. Intrest rates are starting from minimin 5 %.\n# interest rate more than 16% has good chnaces of charged off as compared to other category intrest rates.\n# Charged off proportion is increasing with higher intrest rates.","4f8bffd1":"# Bivariate Analysis on employment length against Chargedoff_Proportion\n\nemplen_vs_loan = loan.groupby(['emp_length', 'loan_status']).loan_status.count().unstack().fillna(0).reset_index()\nemplen_vs_loan['Total'] = emplen_vs_loan['Charged Off'] + emplen_vs_loan['Current'] + emplen_vs_loan['Fully Paid'] \nemplen_vs_loan['Chargedoff_Proportion'] = emplen_vs_loan['Charged Off'] \/ emplen_vs_loan['Total']\nemplen_vs_loan.sort_values('Chargedoff_Proportion', ascending=False)\n\n# Observations:\n# Those who are not working or have less than 1 year of work experience have high chances of getting charged off.\n# It makes sense as with less or no experience they don't have source of income to repay loan.\n# Rest of the applicants have more or less same chnaces of getting charged off.","480bcdbb":"# Lets draw bar plots on data calculated above. Try to visualize the pattern to understand the data better.\n\nfig, ax1 = plt.subplots(figsize=(12, 8),facecolor='b')\nax1.set_title('Employment Length vs Chargedoff Proportion',fontsize=15,color='w')\nax1=sns.barplot(x='emp_length', y='Chargedoff_Proportion', data=emplen_vs_loan)\nax1.set_xlabel('Employment Length',fontsize=14,color='w')\nax1.set_ylabel('Chargedoff Proportion',fontsize=14,color = 'w')\nplt.show()\n\n# Observations:\n# Those who are not working or have less than 1 year of work experience have high chances of getting charged off.\n# It makes sense as with less or no experience they don't have source of income to repay loan.\n# Rest of the applicants have more or less same chnaces of getting charged off.","e3cbbbc3":"# Bivariate Analysis on address state against Chargedoff_Proportion\n\nstate_vs_loan = loan.groupby(['addr_state', 'loan_status']).loan_status.count().unstack().fillna(0).reset_index()\nstate_vs_loan['Total'] = state_vs_loan['Charged Off'] + state_vs_loan['Current'] + state_vs_loan['Fully Paid'] \nstate_vs_loan['Chargedoff_Proportion'] = state_vs_loan['Charged Off'] \/ state_vs_loan['Total']\nstate_vs_loan.sort_values('Chargedoff_Proportion', ascending=False)\n\n# Observations:\n# states NE has very high chances of charged off but number of applications are too low to make any decisions.\n# NV,CA and FL states shows good number of charged offs in good number of applications.","239635fd":"# Lets draw bar plots on data calculated above. Try to visualize the pattern to understand the data better.\n\nfig, ax1 = plt.subplots(figsize=(16, 6),facecolor='b')\nax1.set_title('Address State vs Chargedoff Proportion',fontsize=15,color='w')\nax1=sns.barplot(x='addr_state', y='Chargedoff_Proportion', data=state_vs_loan)\nax1.set_xlabel('Address State',fontsize=14,color='w')\nax1.set_ylabel('Chargedoff Proportion',fontsize=14,color = 'w')\nplt.show()\n\n# Observations:\n# states NE has very high chances of charged off but number of applications are too low to make any decisions.\n# NV,CA and FL states shows good number of charged offs in good number of applications.","7b98b58a":"# Bivariate Analysis on verification_status against Chargedoff_Proportion\n\nverfy_vs_loan = loan.groupby(['verification_status', 'loan_status']).loan_status.count().unstack().fillna(0).reset_index()\nverfy_vs_loan['Total'] = verfy_vs_loan['Charged Off'] + verfy_vs_loan['Current'] + verfy_vs_loan['Fully Paid'] \nverfy_vs_loan['Chargedoff_Proportion'] = verfy_vs_loan['Charged Off'] \/ verfy_vs_loan['Total']\nverfy_vs_loan.sort_values('Chargedoff_Proportion', ascending=False)\n\n# Observations:\n# There is not much difference in charged off proportion.\n# This variable doesn't provide any insights for charged off.","11ec8a44":"# Lets draw bar plots on data calculated above. Try to visualize the pattern to understand the data better.\n\nfig, ax1 = plt.subplots(figsize=(12, 8),facecolor='b')\nax1.set_title('Verification Status vs Chargedoff Proportion',fontsize=15,color='w')\nax1=sns.barplot(x='verification_status', y='Chargedoff_Proportion', data=verfy_vs_loan)\nax1.set_xlabel('Verification Status',fontsize=14,color='w')\nax1.set_ylabel('Chargedoff Proportion',fontsize=14,color = 'w')\nplt.show()\n\n# Observations:\n# There is not much difference in charged off proportion.\n# This variable doesn't provide any insights for charged off.","60cd68f7":"# Bivariate Analysis on pub_rec_bankruptcies against Chargedoff_Proportion\n\nbankruptcies_vs_loan = loan.groupby(['pub_rec_bankruptcies', 'loan_status']).loan_status.count().unstack().fillna(0).reset_index()\nbankruptcies_vs_loan['Total']=bankruptcies_vs_loan['Charged Off']+bankruptcies_vs_loan['Current']+bankruptcies_vs_loan['Fully Paid'] \nbankruptcies_vs_loan['Chargedoff_Proportion'] = bankruptcies_vs_loan['Charged Off'] \/ bankruptcies_vs_loan['Total']\nbankruptcies_vs_loan.sort_values('Chargedoff_Proportion', ascending=False)\n\n# Observations:\n# Those who already have pub_rec_bankruptcies value 1, have charged off proportion higher than who have no pub_rec_bankruptcies.\n# pub_rec_bankruptcies count 2 has even higher charged off proportion but those numbers are not significant to decide.\n# Not known is the column for which we don't have any information abount borrower.\n# This also makes sense that who has defaulted before has more chances of dafaulting in future as well.","443e5d4a":"# Lets draw bar plots on data calculated above. Try to visualize the pattern to understand the data better.\n\nfig, ax1 = plt.subplots(figsize=(12, 7),facecolor='b')\nax1.set_title('Public Bankruptcy Records vs Chargedoff Proportion',fontsize=15,color='w')\nax1=sns.barplot(x='pub_rec_bankruptcies', y='Chargedoff_Proportion', data=bankruptcies_vs_loan)\nax1.set_xlabel('Public Bankruptcy Records',fontsize=14,color='w')\nax1.set_ylabel('Chargedoff Proportion',fontsize=14,color = 'w')\nplt.show()\n\n# Observations:\n# Those who already have pub_rec_bankruptcies value 1, have charged off proportion higher than who have no pub_rec_bankruptcies.\n# pub_rec_bankruptcies count 2 has even higher charged off proportion but those numbers are not significant to decide.\n# Not known is the column for which we don't have any information abount borrower.\n# This also makes sense that who has defaulted before has more chances of dafaulting in future as well.","42b9ebae":"# Bivariate Analysis on Derogatory Public Record against Chargedoff_Proportion\n\nbankruptcies_vs_loan = loan.groupby(['pub_rec', 'loan_status']).loan_status.count().unstack().fillna(0).reset_index()\nbankruptcies_vs_loan['Total']=bankruptcies_vs_loan['Charged Off']+bankruptcies_vs_loan['Current']+bankruptcies_vs_loan['Fully Paid'] \nbankruptcies_vs_loan['Chargedoff_Proportion'] = bankruptcies_vs_loan['Charged Off'] \/ bankruptcies_vs_loan['Total']\nbankruptcies_vs_loan.sort_values('Chargedoff_Proportion', ascending=False)\n\n# Observations:\n# A derogatory item is an entry that may be considered negative by lenders because it indicates risk and hurts \n# your ability to qualify for credit or other services. Public records and collections are derogatory items\n# because they reflect financial obligations that were not paid as agreed.\n# Those who already have pub_rec value 1 or 2 have charged off chances higher than who have no Derogatory Public Record.\n# pub_rec count 3-4 has less numbers so cannot reach on any conclusions.","4511ea33":"# Lets draw bar plots on data calculated above. Try to visualize the pattern to understand the data better.\n\nfig, ax1 = plt.subplots(figsize=(12, 7),facecolor='b')\nax1.set_title('Derogatory Public Record vs Chargedoff Proportion',fontsize=15,color='w')\nax1=sns.barplot(x='pub_rec', y='Chargedoff_Proportion', data=bankruptcies_vs_loan)\nax1.set_xlabel('Derogatory Public Record',fontsize=14,color='w')\nax1.set_ylabel('Chargedoff Proportion',fontsize=14,color = 'w')\nplt.show()\n\n# Observations:\n# A derogatory item is an entry that may be considered negative by lenders because it indicates risk and hurts \n# your ability to qualify for credit or other services. Public records and collections are derogatory items\n# because they reflect financial obligations that were not paid as agreed.\n# Those who already have pub_rec value 1 or 2 have charged off chances higher than who have no Derogatory Public Record.\n# pub_rec count 3-4 has less numbers so cannot reach on any conclusions.","c98420bd":"# Bivariate Analysis - Puprose of loan vs Loan amount\n# Box Plot\n\nplt.figure(figsize=(12,8),facecolor='b')\nax = sns.boxplot(y='purpose', x='loan_amnt', data =loan,palette='rainbow')\nax.set_title('Purpose of Loan vs Loan Amount',fontsize=15,color='w')\nax.set_ylabel('Purpose of Loan',fontsize=14,color = 'w')\nax.set_xlabel('Loan Amount',fontsize=14,color = 'w')\nplt.show()\n\n# Observations:\n# Median,95th percentile,75th percentile of loan amount is highest for loan taken for small business purpose among all purposes.\n# Debt consolidation is second and Credit card comes 3rd.","75b40119":"# Bivariate Analysis - Puprose of loan vs Loan amount\n# violin Plot - It shows the distribution of quantitative data across several levels of one (or more) categorical variables \n# such that those distributions can be compared. \n\nplt.figure(figsize=(14,8),facecolor='b')\nax=sns.violinplot(y='purpose', x='loan_amnt', data =loan)\nax.set_title('Purpose of Loan vs Loan Amount',fontsize=15,color='w')\nax.set_ylabel('Purpose of Loan',fontsize=14,color = 'w')\nax.set_xlabel('Loan Amount',fontsize=14,color = 'w')\nplt.show()\n\n# Observations:\n# Loan taken for small business purpose, Debt consolidation and Credit card are somewhat evenly distributed\n# as compare to loan taken for other purposes.","8f29f9ca":"# Bivariate Analysis - Term of loan vs Interest Rate\n# Box Plot\n\nplt.figure(figsize=(10,6),facecolor='b')\nax = sns.boxplot(y='int_rate', x='term', data =loan,palette='rainbow')\nax.set_title('Term of loan vs Interest Rate',fontsize=15,color='w')\nax.set_ylabel('Interest Rate',fontsize=14,color = 'w')\nax.set_xlabel('Term of loan',fontsize=14,color = 'w')\nplt.show()\n\n# Observations:\n# It is clear that avearge intrest rate is higher for 60 months loan term.\n# Most of the loans issued for longer term had higher intrest rates for repayement.","e830a9cd":"# Bivariate Analysis - Purpose vs Interest Rate\n# Box Plot\n\nplt.figure(figsize=(14,8),facecolor='b')\nax = sns.boxplot(x='int_rate', y='purpose', data =loan,palette='rainbow')\nax.set_title('Purpose vs Interest Rate',fontsize=15,color='w')\nax.set_xlabel('Interest Rate',fontsize=14,color = 'w')\nax.set_ylabel('Purpose of Loan',fontsize=14,color = 'w')\nplt.show()\n\n# Observations:\n# It is clear that avearge intrest rate is highest for small business purpose.\n# Loans taken for small business purposes had to repay the loan with more intrest rate as compared to other.\n# Debt consolidation is 2nd where borrowers had to pay more interest rate.","0ce5905a":"# Bivariate Analysis - Grade vs Interest Rate\n# Box Plot\n\nplt.figure(figsize=(14,8),facecolor='b')\nax = sns.boxplot(y='int_rate', x='grade', data =loan,palette='rainbow',order = 'ABCDEFG')\nax.set_title('Grade vs Interest Rate',fontsize=15,color='W')\nax.set_ylabel('Interest Rate',fontsize=14,color = 'w')\nax.set_xlabel('Grade',fontsize=14,color = 'w')\nplt.show()\n\n# Observations:\n# A-grade is a top letter grade for a lender to assign to a borrower.\n# The higher the borrower's credit grade,the lower the interest rate offered to that borrower on a loan.\n# It is clear that intrest rate is increasing with grades moving from A to F.","5cb78249":"# Bivariate Analysis - Loan Amount vs Interest Rate\n# Box Plot\n\nplt.figure(figsize=(14,8),facecolor='b')\nax = sns.boxplot(y='int_rate', x='loan_amnt_cats', data =loan,palette='rainbow')\nax.set_title('Loan amount vs Interest Rate',fontsize=15,color='w')\nax.set_ylabel('Interest Rate',fontsize=14,color = 'w')\nax.set_xlabel('Loan Amount',fontsize=14,color = 'w')\nplt.show()\n\n# Observations:\n# It is clear that intrest rate is increasing with loan amount increase.\n# probably when loan amount is more it is taken for longer loan term, we saw earlier that longer the loan term more the\n# interest rate.","473b24bb":"# Bivariate Analysis - dti vs Interest Rate\n# Box Plot\n\nplt.figure(figsize=(14,8),facecolor='b')\nax = sns.boxplot(y='int_rate', x='dti_cats', data =loan,palette='rainbow')\nax.set_title('Debt to income Ratio vs Interest Rate',fontsize=15,color='w')\nax.set_ylabel('Interest Rate',fontsize=14,color = 'w')\nax.set_xlabel('Debt to income Ratio',fontsize=14,color = 'w')\nplt.show()\n\n# Observations:\n# If your DTI is low enough you may get a lower interest rate.\n# Plot shows no significant variation but there is slight increase in interest rate with increase in DTI.","6973dbbe":"# Bivariate Analysis - Recoveries vs Annual income\n# Box Plot\nloan['recoveries']=pd.to_numeric(loan['recoveries'],errors='coerce')\nloan_df_rec=loan[loan['recoveries'] > 0.00]\n\n# calculate recovery percentage \nloan_df_rec['recovery_prcnt']=((loan_df_rec['recoveries']\/loan_df_rec['loan_amnt']) * 100) \n\n# plot\nplt.figure(figsize=(14,9),facecolor='b')\nax=sns.boxplot(x='recovery_prcnt',y='annual_inc_cats',data=loan_df_rec,palette='rainbow')\nax.set_title('Percentage of loan amount recovered vs Annual income',fontsize=15,color = 'w')\nax.set_ylabel('Annual income',fontsize=14,color = 'w')\nax.set_xlabel('Percentage of loan amount recovered post charged off',fontsize=14,color = 'w')\nplt.show()\n\n# Observations:\n# Higher percentage of loan amount is recovered when annual income is high.\n# Plot shows no significant variation but there is slight increase in recovery percentage with increase in annual income.","3b0ce894":"# Bivariate analysis\n# BarPlot to show variation of annual income across grade for every loan status.\n\nplt.figure(figsize=(10,6), dpi=80, facecolor='b', edgecolor='k')\nax=sns.barplot(x='grade', y='annual_inc', hue=\"loan_status\", data=loan, estimator=np.mean,order='ABCDEFG')\nax.set_title('Grade vs Annual income',fontsize=15,color='w')\nax.set_ylabel('Annual income',fontsize=14,color = 'w')\nax.set_xlabel('Grades',fontsize=14,color = 'w')\nplt.show()\n\n# Observations:\n# From this we can conclude that the ones getting 'charged off' have lower annual incomes than the ones \n# who'paid fully' for each and every grade (i.e. at same interest range)","0296ca8d":"# Bivariate Analysis - year vs Interest Rate\n# Box Plot\n\nplt.figure(figsize=(14,8),facecolor='b')\nax = sns.boxplot(y='int_rate', x='year', data =loan,palette='rainbow')\nax.set_title('Year vs Interest Rate',fontsize=15,color='w')\nax.set_ylabel('Interest Rate',fontsize=14,color = 'w')\nax.set_xlabel('Year',fontsize=14,color = 'w')\nplt.show()\n\n# Observations:\n# Plot shows intrest rate is increasing slowly with increase in year.","9e574862":"# Lets draw a pair plot for multivariate analysis\n# Pick few imporatnt columns from dataset separately.\n\nloan_pair = loan[['loan_amnt', 'annual_inc', 'year','int_rate','loan_status']].copy()\nloan_pair.head()\n\n# Take the log of below variables as they are heavily skewed\nloan_pair['loan_amnt'] = np.log10(loan_pair['loan_amnt'])\nloan_pair['annual_inc'] = np.log10(loan_pair['annual_inc'])\nloan_pair['int_rate'] = np.log10(loan_pair['int_rate'])\n\n# Create a pair plot colored by loan status with a density plot of the # diagonal and format the scatter plots.\nsns.pairplot(loan_pair, hue = 'loan_status', diag_kind = 'kde',\n             plot_kws = {'alpha': 0.6, 's': 80, 'edgecolor': 'k'},\n             size = 4)\nplt.show()\n\n# Observation:\n# Higher the intrest rate higher charged off ratio\n# Higher the annual income higher the loan amount slightly.\n# increase in number of charged off with increase in year.\n# intrest rate is increasing with loan amount increase","c00e01b6":"# Lets draw a pair plot for multivariate analysis\n# Pick few imporatnt columns from dataset separately.\n# Above plot is too dense so just pick year 2010 for getting some insights.\n\nsns.pairplot(loan_pair[loan_pair['year'] == 2010], \n             vars = ['loan_amnt', 'annual_inc', 'int_rate'], \n             hue = 'loan_status', diag_kind = 'kde', \n             plot_kws = {'alpha': 0.6, 's': 80, 'edgecolor': 'k'},\n             size = 4);\n\n# Observation:\n# Higher the intrest rate higher charged off ratio\n# Higher the annual income higher the loan amount slightly\n# Intrest rate is increasing with loan amount increase this results in high charged off.","da5b5c6f":"#### Bivariate Analysis : \n\n# In this part of analysis, lets try to analyze the loan status against some important columns which might have played \n# important role in charged off of loans. Lets try to find proportion of charged offs in some categories.\n\n# To calculate the proportion of charged off loans, will do these below steps:\n\n# Group loans by different variables and loan status, get the count,use .unstack() to return a DataFrame.\n# Since we\u2019re going to use this for further analysis, it will be helpful to use .reset_index() to clean up the index. \n# Assign the new DataFrame to a variable.\n# Create a simple derived column that sums charged off,current and fully paid loans for each category.\n# Divide the number of charged off loans by the total number of loans to get the proportion of charged off loans. \n# Store this as another derived column.\n# Finally, output the whole table, sorted by proportion of charged off in each category issued loans.","49fa0283":"### Bivariate Analysis : Part 1","cb2e8980":"### Univariate Analysis -","dd365904":"### Derive Columns For Analysis -","23600292":"# You work for a consumer finance company which specialises in lending various types of loans to urban customers. \n# When the company receives a loan application, the company has to make a decision for loan approval based on the \n# applicant\u2019s profile. Two types of risks are associated with the bank\u2019s decision:\n\n# If the applicant is likely to repay the loan, then not approving the loan results in a loss of business to the company\n\n# If the applicant is not likely to repay the loan, i.e. he\/she is likely to default, then approving the loan may lead to \n# a financial loss for the company\n\n# The data given below contains the information about past loan applicants and whether they \u2018defaulted\u2019 or not. \n# The aim is to identify patterns which indicate if a person is likely to default, which may be used for taking \n# actions such as denying the loan, reducing the amount of loan, lending (to risky applicants) at a higher interest rate, etc.","cdab0244":"### Derive Columns For Analysis -","1d24a7da":"### Bivariate Analysis - Part 2","5d22e04b":"### Problem Statement - Lending Club Case Study","6c72307d":"### Univariate Analysis - ","41711fc5":"### Correlation Matrix - Quantitative Variables :","68f3427a":"### Data Cleaning Starts-","55165a8d":"### Multivariate Analysis - Pair Plots"}}