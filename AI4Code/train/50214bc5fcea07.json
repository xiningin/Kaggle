{"cell_type":{"d7f74e9d":"code","5a39ac82":"code","f431a9b9":"code","10f5a688":"code","a724720e":"code","d9b95f63":"code","1143250e":"code","dd2fae14":"code","6d3950b5":"code","cf002837":"code","cfe8ac26":"code","56e11a95":"code","123c7299":"code","0a8f72ba":"code","18fadbed":"code","02e5941c":"code","8d5d0a2d":"code","ce5fd339":"code","10d5fee5":"code","2f1ba2ea":"code","693f462b":"code","2be9d032":"code","e80ef94b":"code","e2f6042d":"code","96c0555e":"code","623e1ba8":"code","0ef1bdb9":"code","adfaf163":"code","d4ff455c":"code","bd743d64":"code","8a93b2bc":"code","63beded3":"code","090e11bd":"code","234a7a62":"code","a59b3ac7":"code","cf5c608b":"markdown","2ce7cdae":"markdown","f4b61c3a":"markdown","96e797d1":"markdown","4a119ae1":"markdown","08c7ffe7":"markdown","77265796":"markdown","16d92067":"markdown","e189b31d":"markdown","a2ba9ec0":"markdown"},"source":{"d7f74e9d":"import pandas as pd \nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport numpy as np\nfrom datetime import datetime\nfrom wordcloud import WordCloud, STOPWORDS, ImageColorGenerator\nfrom PIL import Image # converting images into arrays\nimport os, sys\nfrom bs4 import BeautifulSoup\nimport requests\nimport re #regular expressions, a powerful ways of defining patterns to match strings\n","5a39ac82":"#OCULTO\n#EXPLORACION DEL DIRECTORIO\n\n#1.Ver el actual directorio de trabajo\n#os.getcwd()\n\n#2.Ver que hay en la carpeta de trabajo\n#os.listdir('\/kaggle\/input\/venezuelainterinpresidenttweets')","f431a9b9":"df = pd.read_csv('..\/input\/venezuelainterinpresidenttweets\/guaidotuits.csv', sep=';',error_bad_lines=False)\n# sorting data frame by date\ndf=df.sort_values(\"date\", axis = 0, ascending = True)\ndf","10f5a688":"#Let's see how many columns and rows are in the Dataset\ndf.shape","a724720e":"#Now let's see information about each of the columns, if there are boxes without values and the type of variable\ndf.info()","d9b95f63":"# 1. columns we don\u00b4t need\ndf=df.drop(['username','geo','mentions','hashtags'], axis=1)\n","1143250e":"### OCULTO ###  \n#2. Fixing date column\n#df['date']=df.date.str.split()\n#df['Hour']=df.date.str.get(1)\n#df['date']=df['date'].str.get(0) \n#df.head()","dd2fae14":"#2. change the type of object from str to datetime\n# so we can use later to plot\ndf['date'] =  pd.to_datetime(df['date'])\n                              #format='%y\/%m\/%d %M\/%S')\n\n#Set Date column as index column\ndf.set_index('date',inplace=True)\n\n\n\n# Confirm the date column is in datetime format\ndf.info()","6d3950b5":"# 3. convert Id to int64 \n#df[\"id\"]= df[\"id\"].astype(int) Doesn't work\n#df['id'] = df['id'].apply(lambda x: x if pd.isnull(x) else str(int(x))) Doesn't work\ndf['id'] = pd.to_numeric(df['id'], errors='coerce').fillna(-1).astype(int)\n\ndf.info()","cf002837":"df.head()","cfe8ac26":"#Let's take a closer look at the retweets column\n#df.retweets.plot('hist')\n#df['retweets'].plot('hist')\nsns.distplot(df['retweets'])","56e11a95":"# Let's see which are the tweets with more RTs of Guaid\u00f3\ndf[df.retweets > 50000]","123c7299":"#Let's take a closer look at the favorites column\n#df.favorites.plot('hist')\nsns.distplot(df['favorites'])","0a8f72ba":"# Let's see which are the tweets with more Favorites of Guaid\u00f3 user\ndf[df.favorites > 90000]\n","18fadbed":"def plotguaido(df,figsize=(20,4)):\n    # Set the width and height of the figure\n    plt.figure(figsize=(20,4))\n\n    # Add title\n    plt.title(\"Popularity of Guaid\u00f3's tweets\")\n\n    # Line chart showing Retweets\n    sns.lineplot(data=df['retweets'], label=\"Retweets\")\n\n    # Line chart showing Favorites\n    sns.lineplot(data=df['favorites'], label=\"Favorites\")\n\n    # Add label for horizontal axis\n    plt.xlabel(\"Date\")\n    plt.ylabel(\"Number of RTs and \u2665\")\nplotguaido(df)","02e5941c":"# First let's see the a wordcloud of all tweets of Juan Guaid\u00f3\ndef wordcloudguaido(df):\n    comment_words = ' '\n    stopwords=(['el','la','es','son','a','en','lo','cualquier','http','pic','www','twitter',\n                'para','ante','por','no','nos','con','que','con','com','hasta','bajo','de',\n                'su','los','como','del','hoy','se','las','una','m\u00e1s','\u00e9ste','este','est\u00e9',\n                'mi','ha','hemos','https','un','unos','desde','todo','asambleave','han','ni'\n                ,'al','hay','ya','me','statu','donde','sin','sobre','tras','est\u00e1','\u00e9sta','est\u00e1n'\n                '\u00e9stas','toda','todas','le','cada','su','sus','pero','nuestra','pscp','esta',\n                'les','como','quien','sido','a\u00fan','eso','tv','ser\u00e1','vez','solo','van','est\u00e1n',\n                'porque','qu\u00e9','tienen','aqu\u00ed','sta','tus','ahora','esa','ello','c\u00f3mo','sea',\n                'ser','va','tiene','tatus','tatu','si','ver','uno','fue','gran','traves',\n                'trav\u00e9s','vez','st','atus','st atus','stat us','entre','hacia','hac\u00eda','23f','asi',\n                'esto','\u00e9sto','ellos','ellas','tanto','tantas','sigue','sigues','siguen','mucho',\n                'hace','nunca','tener','cuando','hacer','status','somos','nuestra','nuestro',\n                'as\u00ed','ese','\u00e9se','pueden','pesar','debe','hecho','necesaria','nuestras',\n                'europaest\u00e1convenezuela','quienes','ustedes','nuestros','23favalanchahumanitaria'])\n    #stopwords = set(STOPWORDS) \n\n    # iterate through the csv file \n    for val in df.text: \n\n        # typecaste each val to string \n        val = str(val) \n\n        # split the value \n        tokens = val.split() \n\n        # Converts each token into lowercase \n        for i in range(len(tokens)): \n            tokens[i] = tokens[i].lower() \n\n        for words in tokens: \n            comment_words = comment_words + words + ' '\n\n\n    wordcloud = WordCloud(width = 800, height = 800, \n                    background_color ='white', \n                    stopwords = stopwords, \n                    min_font_size = 10).generate(comment_words) \n\n    # plot the WordCloud image                        \n    plt.figure(figsize = (8, 8), facecolor = None) \n    plt.imshow(wordcloud) \n    plt.axis(\"off\") \n    plt.tight_layout(pad = 0) \n\n    plt.show() \nwordcloudguaido(df)","8d5d0a2d":"#OCULTO\n#Let\u00b4s put all these words in a President Guaido Mask\n#1. create a mask file importing the .png image \nimg = np.array(Image.open('..\/input\/venezuelainterinpresidenttweets\/guaidomask.png'))\n\n","ce5fd339":"#OCULTO\nsns.set(rc={'figure.figsize':(11.7,8.27)})\n\nwordcloud = WordCloud(mask=img,background_color=\"white\",stopwords=stopwords).generate(comment_words)\nplt.figure()\nplt.imshow(wordcloud, interpolation=\"bilinear\")\nplt.axis(\"off\")\nplt.margins(x=0, y=0)\n#plt.title('Responsibilites',size=24)\nplt.show()","10d5fee5":"#1st. Trimester Dataframe\n#create a new dataframe. Date between January and March\ndf1=df.loc['2019-01-01':'2019-04-01'].sort_values('date',axis=0,ascending = True)\ndf1.head()","2f1ba2ea":"plotguaido(df1)","693f462b":"#Let's see closer\n#PEAK 1\ndfpeak1=df1.loc['2019-01-15':'2019-02-15'].sort_values('retweets',axis=0,ascending = False)#.drop(['permalink'],axis=1)\ndfpeak1.head(20)","2be9d032":"plotguaido(dfpeak1)","e80ef94b":"#What did Guaid\u00f3's tweets say during these days?\nwordcloudguaido(dfpeak1)","e2f6042d":"#2nd PEAK\ndfpeak2=df1.loc['2019-02-15':'2019-03-15'].sort_values('retweets',axis=0,ascending = False).drop(['permalink'],axis=1)\ndfpeak2.head(20)","96c0555e":"plotguaido(dfpeak2)","623e1ba8":"#What did Guaid\u00f3's tweets say during these days?\nwordcloudguaido(dfpeak2)","0ef1bdb9":"#1. Create a new dataset that contains replies of most important tweet during every period\n#2. Create a replies wordcloud \n#3. Create a sentiment Analysis of the replies\n#4. Plot the result ","adfaf163":"# FIRST TRIMESTER \n    # Peak 1\n        # Let's select more relevants from this period\ndfpeak1.head(1)\n","d4ff455c":"#In Process\ndef replyfinder(url=''):\n    url = 'https:\/\/twitter.com\/jguaido\/status\/1088261421023088640'\n    source = requests.get(url).text\n    soup = BeautifulSoup(source,'html.parser')\n\n    search=soup.find_all(class_=\"TweetTextSize\") #b\u00fasqueda de l\u00edneas con dicho 'str' dentro del class\n\n    dfreplies=pd.DataFrame() #hace un Dataset vac\u00edo\n    dfreplies['Replies']=search #inserta la b\u00fasqueda en el Dataframe\n    dfreplies","bd743d64":"\n\nurl = 'https:\/\/twitter.com\/jguaido\/status\/1088261421023088640'\nsource = requests.get(url).text\nsoup = BeautifulSoup(source,'html.parser')\n\nsearch=soup.find_all(class_=\"TweetTextSize\") #b\u00fasqueda de l\u00edneas con dicho 'str' dentro del class\ndfreplies=pd.DataFrame() #hace un Dataset vac\u00edo\ndfreplies['Replies']=search #inserta la b\u00fasqueda en el Dataframe\ndfreplies","8a93b2bc":"#Create dataframe with sample\n#dfpk1sample=dfpeak1.sample(10, replace=True)\n#dfpk1sample","63beded3":"#Mar=df.loc['2019-02-01':'2019-03-01'].sort_values('retweets',axis=0,ascending = False)\n#Mar=Mar.shape[0]\n#March\n\n","090e11bd":"#Jandf=df.loc['2019-01-01':'2019-02-01'].sort_values('retweets',axis=0,ascending = False).head(63)\n#Febdf=df.loc['2019-02-01':'2019-03-01'].sort_values('retweets',axis=0,ascending = False).head(65)\n#Mardf=df.loc['2019-03-01':'2019-04-01'].sort_values('retweets',axis=0,ascending = False).head(65)\n#Aprdf=df.loc['2019-04-01':'2019-05-01'].sort_values('retweets',axis=0,ascending = False).head(65)\n#Maydf=df.loc['2019-05-01':'2019-06-01'].sort_values('retweets',axis=0,ascending = False).head(65)\n#Jundf=df.loc['2019-06-01':'2019-07-01'].sort_values('retweets',axis=0,ascending = False).head(65)\n#Juldf=df.loc['2019-07-01':'2019-08-01'].sort_values('retweets',axis=0,ascending = False).head(65)\n\n","234a7a62":"#Mardf.loc['2019-03-01':'2019-04-01'].sort_values('retweets',axis=0,ascending = False)","a59b3ac7":"#df=df.sort_values(\"retweets\", axis = 0, ascending = False)\n#df","cf5c608b":"# SENTIMENT ANALYSIS \n\nQuestions to answer for every part of this work:\n* what people say during this period?\n* what people feel during this period?\n","2ce7cdae":"# President Guaid\u00f3 Sentiment Analysis\n\nDuring this 2019 the oposition to the Regime of [Nicol\u00e1s Maduro](https:\/\/es.wikipedia.org\/wiki\/Nicol%C3%A1s_Maduro) is divided in two waters: one that follows and believes every action of the president of National Assembly [Juan Guaid\u00f3](https:\/\/es.wikipedia.org\/wiki\/Juan_Guaid%C3%B3)(actual president interim of Venezuela). In the other side, there are people that support some decisions he makes but critizes others, or simply don't believe in him, because they think that he represents the status quo who plays and cohabit with Maduro dictatorship.\n\nThese intestinal struggles have generated a paradigm in social networks where the \"opposition of the opposition to Maduro\" that is, those who do not believe in Guaid\u00f3 are only a tiny group of people. This situation inspired me to analize data of his twitter user [\"jguaido\"](https:\/\/twitter.com\/jguaido?ref_src=twsrc%5Egoogle%7Ctwcamp%5Eserp%7Ctwgr%5Eauthor) and measure the popularity based on sentiment analysis from some tweets since he appeared in the public arena. ","f4b61c3a":"# Data Visualization\nWe will make a quick visualization of the data to see if it can tell us something else","96e797d1":"___","4a119ae1":"# Cleaning Data\nIn order to work with the data properly, we\u00b4re going to clean the Dataset:\n\n1. Drop Columns: we will discard *'username', 'geo', 'mentions', 'hashtags'*\n2. Set 'Date' as index column and convert it from str to Datetime object\n3. Convert Id to  object'Id' column: when we imported the dataset to pandas it changes from String object to float64. We need to convert to str or to int. ","08c7ffe7":"# The Dataset","77265796":"---","16d92067":"# Libraries","e189b31d":"Let's take a closer look at our DataSet\n## 1st. Trimester \n*from January to mid March 2019*\n\nAs we saw in the global Dataset plot, the most important peaks occur in this period and there are two:\n* The first between January and February\n* The second between February and March","a2ba9ec0":"# Descriptive Analysis\n* We can see that the popularity of Juan Guaid\u00f3's tweets have a greater impact from mid-January 2019 until the month of March of the same year.\n* From there the trend was declining until the first week of May that had a very high peak for a few days and then returned to its downtrend.\n* From June to this date (August 2019) it has maintained a stable trend with some small peaks (compared with those observed in the first quarter of the year).\n\nStarting from this observation we will divide our analysis in three parts (above mentioned). Thus this way we can understand the evolution of the behaviors of people who interacted with Juan Guaid\u00f3 twitter account"}}