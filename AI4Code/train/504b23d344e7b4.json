{"cell_type":{"deb4503f":"code","66b74004":"code","00044dd7":"code","ebb9c383":"code","a5f02775":"markdown","6a89c2a6":"markdown","3510aeb9":"markdown","5ba3fe35":"markdown","6d8f1a95":"markdown","7482f921":"markdown","5e3af125":"markdown"},"source":{"deb4503f":"!wget -nc https:\/\/storage.googleapis.com\/bert_models\/2018_11_03\/chinese_L-12_H-768_A-12.zip\n!unzip -o chinese_L-12_H-768_A-12.zip && rm chinese_L-12_H-768_A-12.zip","66b74004":"!git clone https:\/\/github.com\/huhuhang\/bert.git --depth=1 && rm -rf bert\/.git","00044dd7":"!python bert\/run_classifier.py \\\n  --task_name=wsdm \\\n  --do_train=true \\\n  --do_eval=true \\\n  --do_predict=true \\\n  --data_dir=bert\/dataset \\\n  --vocab_file=chinese_L-12_H-768_A-12\/vocab.txt \\\n  --bert_config_file=chinese_L-12_H-768_A-12\/bert_config.json \\\n  --init_checkpoint=chinese_L-12_H-768_A-12\/bert_model.ckpt \\\n  --max_seq_length=128 \\\n  --train_batch_size=32 \\\n  --learning_rate=5e-5 \\\n  --num_train_epochs=1.0 \\\n  --output_dir=bert\/dataset\/output","ebb9c383":"import pandas as pd\nfrom sklearn.metrics import accuracy_score\n\ndf_test = pd.read_csv(\"test.csv\")\ndf_pred = pd.read_csv(\"bert\/dataset\/output\/test_results.tsv\", sep='\\t', header=-1)\n\ndf_pred['label'] = df_pred.idxmax(axis=1)\ndf_pred.label.replace({0:'unrelated', 1:'agreed', 2:'disagreed'}, inplace=True)\n\nacc = accuracy_score(df_test['label'], df_pred['label'])\nprint(\"Accuracy:{}\".format(acc))","a5f02775":"### \u514b\u9686\u53c2\u8003\u7b54\u6848\u4ee3\u7801\u4ed3\u5e93","6a89c2a6":"# Google BERT \u9884\u8bad\u7ec3\u6280\u672f\u6311\u6218\u53c2\u8003\u7b54\u6848","3510aeb9":"\u6309\u987a\u5e8f\u6267\u884c\u4e0b\u65b9\u4ee3\u7801\u5373\u53ef\u3002","5ba3fe35":"\u7531\u4e8e\u73af\u5883\u533a\u522b\uff0c\u4ee3\u7801\u4e2d\u6240\u4f7f\u7528\u8def\u5f84\u53ef\u80fd\u4e0e\u672c\u5730\u6267\u884c\u65f6\u6709\u6240\u4e0d\u540c\u3002","6d8f1a95":"### \u8ba1\u7b97\u6d4b\u8bd5\u96c6\u51c6\u786e\u5ea6","7482f921":"### \u4e0b\u8f7d\u9884\u8bad\u7ec3\u6a21\u578b","5e3af125":"### \u5f00\u59cb\u6267\u884c"}}