{"cell_type":{"60b71868":"code","69e53616":"code","293c7621":"markdown"},"source":{"60b71868":"class DataImage():\n    def __init__(self):\n        self.substudy=''\n        self.study=''\n        self.file_name=''\n        self.pixel_spacing_height=0\n        self.pixel_spacing_width=0\n        self.slice_thickness=0\n        self.np_lung=np.array((512,512))\n        self.np_mask=np.array((512,512))\n        self.lung_area=0\n        self.lung_area_real=0\n        self.lung_area_1=0\n        self.lung_area_2=0\n        self.real_lung_area_1=0\n        self.real_lung_area_2=0\n        \n    def to_string(self):\n        print(\"Class DataImage:\")\n        print(\"File name: \", self.file_name) \n        print(\"Pixel spacing height: \", self.pixel_spacing_height)\n        print(\"Pixel spacing width: \", self.pixel_spacing_width)\n        print(\"Slicethickness: \", self.slice_thickness)\n        \n        \nclass DataStudy():\n    def __init__(self, s, sbs, w):\n        self.study=s\n        self.substudy=sbs\n        self.where=w # TRAIN or TEST\n        self.data_images = [] # list of DataImage\n        \n    def to_string(self):\n        print(\"Class DataStudy:\")\n        print(\"Study: \", self.study)\n        print(\"Subtudy: \", self.substudy)\n        print(\"Where: \", self.where)\n        print(\"Images: \", self.data_images)","69e53616":"def make_model(nh, params):\n    hiddens_size = params[\"hiddens_size\"]\n    dropout = params[\"dropout\"]\n    hiddens_nb = params[\"hiddens_nb\"]\n    \n    z = L.Input(shape=(nh,), name=\"Id\")\n    \n    x = L.Dense(hiddens_size, activation=\"relu\", name=\"d1\")(z)\n    x = L.BatchNormalization()(x)\n    \n    if dropout > 0:\n        x = L.Dropout(dropout)(x)\n    \n    if hiddens_nb > 1:\n        for i in range(2,hiddens_nb+1):\n            x = L.Dense(hiddens_size, activation=\"relu\", name=\"d\"+str(i))(x)\n            x = L.BatchNormalization()(x)\n            \n            if dropout > 0:\n                x = L.Dropout(dropout)(x)\n    \n    x = L.Dense(OUTPUT_SHAPE, activation=\"sigmoid\", name=\"p1\")(x)\n    \n    model = M.Model(z, x, name=\"RSNA\")\n    model.compile(loss=tf.keras.losses.BinaryCrossentropy(from_logits=True), optimizer=\"adam\", metrics=['binary_crossentropy', 'mse'])\n    \n    return model","293c7621":"# Several classes I used in the competition \n\nTo be continued ..."}}