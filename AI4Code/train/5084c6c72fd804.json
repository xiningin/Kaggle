{"cell_type":{"a41c6635":"code","9e1ff80b":"code","7a4ebf8d":"code","d419831b":"code","9d8c87cf":"code","b632abdf":"code","2a886f86":"code","64ddc4b6":"code","b2fc925b":"code","562607ab":"code","3e94b657":"code","4147f3bf":"code","b1d61bf4":"code","1935418b":"code","8dd6ece2":"code","8d1b8593":"code","058dcd3f":"code","33f3b309":"code","6ce11b19":"code","73a5956c":"code","dcfe9c77":"markdown","c438aaaa":"markdown","a33643e2":"markdown","49cb8714":"markdown","8f552b2d":"markdown","4dbcb24b":"markdown","586af223":"markdown","637ad77d":"markdown","8afe66f7":"markdown","41ffb463":"markdown","06e6d430":"markdown","1965746f":"markdown","d3e470e5":"markdown"},"source":{"a41c6635":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","9e1ff80b":"df= pd.read_csv('..\/input\/usa-housing\/USA_Housing.csv')","7a4ebf8d":"df.head()","d419831b":"df.shape","9d8c87cf":"df.info()","b632abdf":"X=df[['Avg. Area Income', 'Avg. Area House Age', 'Avg. Area Number of Rooms',\n       'Avg. Area Number of Bedrooms', 'Area Population']]\ny=df['Price']","2a886f86":"from sklearn.preprocessing import PolynomialFeatures","64ddc4b6":"polynomial_converter=PolynomialFeatures(degree=2, include_bias=False)\npoly_features=polynomial_converter.fit(X)\npoly_features=polynomial_converter.transform(X)","b2fc925b":"poly_features.shape\n","562607ab":"X.shape","3e94b657":"from sklearn.model_selection import train_test_split","4147f3bf":"X_train, X_test, y_train, y_test = train_test_split(poly_features, y, test_size=0.3, random_state=101)","b1d61bf4":"from sklearn.linear_model import LinearRegression","1935418b":"polymodel=LinearRegression()\npolymodel.fit(X_train, y_train)","8dd6ece2":"y_pred=polymodel.predict(X_test)","8d1b8593":"from sklearn import metrics\nMAE= metrics.mean_absolute_error(y_test, y_pred)\nMSE= metrics.mean_squared_error(y_test, y_pred)\nRMSE= np.sqrt(MSE)\n\npd.DataFrame([MAE, MSE, RMSE], index=['MAE', 'MSE', 'RMSE'], columns=['Metrics'])","058dcd3f":"#Train List of RMSE per degree\ntrain_RMSE_list=[]\n#Test List of RMSE per degree\ntest_RMSE_list=[]\n\nfor d in range(1,15):\n    \n    #Create Polynomial Data for each degree: (Preprocessing)\n    polynomial_converter= PolynomialFeatures(degree=d, include_bias=False)\n    poly_features=polynomial_converter.fit(X)\n    poly_features=polynomial_converter.transform(X)\n    \n    #Split the dataset\n    X_train, X_test, y_train, y_test = train_test_split(poly_features, y, test_size=0.3, random_state=101)\n    \n    #Train the Model\n    polymodel=LinearRegression()\n    polymodel.fit(X_train, y_train)\n    \n    #Predicting on both Train and Test Data\n    y_train_pred=polymodel.predict(X_train)\n    y_test_pred=polymodel.predict(X_test)\n    \n    #Evaluating the Model\n    \n    #RMSE of Train set\n    train_RMSE=np.sqrt(metrics.mean_squared_error(y_train, y_train_pred))\n    \n    #RMSE of Test set\n    test_RMSE=np.sqrt(metrics.mean_squared_error(y_test, y_test_pred))\n    \n    #Append the RMSE to the Train and Test List\n    train_RMSE_list.append(train_RMSE)\n    test_RMSE_list.append(test_RMSE)","33f3b309":"train_RMSE_list","6ce11b19":"test_RMSE_list","73a5956c":"plt.plot(range(1,14), train_RMSE_list[:13], label='Train RMSE')\nplt.plot(range(1,14), test_RMSE_list[:13], label='Test RMSE')\n\nplt.xlabel('Polynomial Degree')\nplt.ylabel('RMSE')\nplt.legend()","dcfe9c77":"### Step1: Import all Necessary Libraries","c438aaaa":"## Note: It Shows that linear model performce better than polynomial model in this case","a33643e2":"### Step5: Determine the Features and Target Variable","49cb8714":"### Step2: Import the Dataset","8f552b2d":"### Step10: Evaluating the Model Performance","4dbcb24b":"### Step3: Data Overview","586af223":"**Polynomial Features:**\n\n**X1, X2, X3, X4, X5**\n\n**X1^2, X2^2, X3^2, X4^2, X5^2**\n\n**X1X2, X1X3, X1X4, X1X5, X2X3, X2X4, X2X5, X3X4, X3X5, X4X5**","637ad77d":"### Step8: Train the Model","8afe66f7":"### Step6: Preprocessing","41ffb463":"### Step4: Exploratory Data Analysis\n**Same as this notebook:**\nhttps:\/\/www.kaggle.com\/mojtaba142\/linearregression-usa-house-price","06e6d430":"### Step7: Split the Data to Train and Test","1965746f":"### Step9: Predicting Test Data","d3e470e5":"### Step11: Adjusting Model Parameters"}}