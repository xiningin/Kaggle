{"cell_type":{"e1e0fa8b":"code","f799e378":"code","c08c04aa":"code","1f1329b4":"code","429747b1":"code","7420e710":"code","2f7cb8db":"code","5445b6c4":"code","2d58607c":"code","04d30fb0":"code","f500b00b":"code","3fb9baee":"code","c7c47b4e":"code","2ca6380b":"markdown","b8723dba":"markdown","355e3f71":"markdown","72363c93":"markdown","a7275429":"markdown","3a01aae7":"markdown","cbdf6110":"markdown"},"source":{"e1e0fa8b":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport os\nimport cv2\nimport matplotlib.pyplot as plt\nfrom fastai.vision.all import *","f799e378":"label = []\npath = []\nBASE_PATH = \"\/kaggle\/input\/a-large-scale-fish-dataset\/Fish_Dataset\/Fish_Dataset\/\"\n\nfor dirname, _, filenames in os.walk(BASE_PATH):\n    for filename in filenames:\n        if filename.split(\".\")[1]=='png' :\n            if dirname.split()[-1]!='GT' :\n                slabel = os.path.split(dirname)[1]\n                label.append(slabel)\n                path.append(os.path.join(slabel,slabel, filename))\n            \n        ","c08c04aa":"df = pd.DataFrame(columns=['Path','Label'])\ndf.Path = path\ndf.Label= label\ndf.head()","1f1329b4":"df.Label.value_counts()","429747b1":"labels = list(df.Label.unique())\nprint(labels)","7420e710":"\nfig=plt.figure(figsize=(20,20))\nfig.tight_layout()  \n\ni=1\nfor label in labels: \n    img = cv2.imread(BASE_PATH+df.loc[df.Label==label]['Path'].iloc[0])\n    ax = fig.add_subplot(3, 3, i) \n    ax.imshow(img, cmap='gray') \n    plt.title(label, y=1, fontsize=15)\n    i=i+1","2f7cb8db":"path = r'\/kaggle\/input\/a-large-scale-fish-dataset\/Fish_Dataset\/Fish_Dataset';\ndls = ImageDataLoaders.from_df(df,path, valid_pct=0.2)","5445b6c4":"dls.valid_ds.items[:3]","2d58607c":"dls.train_ds.items[:3]","04d30fb0":"learn = cnn_learner(dls, resnet34, metrics=accuracy)\nlearn.fine_tune(1)","f500b00b":"interp = ClassificationInterpretation.from_learner(learn)\ninterp.plot_top_losses(9, figsize=(15,11))","3fb9baee":"interp.plot_confusion_matrix(figsize=(12,12), dpi=60)","c7c47b4e":"learn.predict(\"\/kaggle\/input\/a-large-scale-fish-dataset\/NA_Fish_Dataset\/Black Sea Sprat\/00001.png\")","2ca6380b":"# Train Data","b8723dba":"# Import Libraries","355e3f71":"# Get Data","72363c93":"# Predict Data","a7275429":"# Analyse Result","3a01aae7":"# Analyse Data","cbdf6110":"# Load Data "}}