{"cell_type":{"44b07ce7":"code","ce03d380":"code","8aa736b7":"code","413b94f5":"code","5bb7d5f8":"code","3400b15e":"code","d0656fbb":"code","ce792d12":"code","11a7f4ca":"code","1add32fa":"code","752a2ed8":"code","957947af":"code","9b992f18":"code","6549d9cf":"code","1db35315":"code","12401a6a":"code","2cdc0e37":"code","c18153a3":"code","cc6f8f70":"code","c19da1e5":"code","2a9b07c3":"code","ebaaa58b":"code","89ca1681":"code","8eb3e236":"code","9a200783":"code","987b3e34":"code","51bf7ef7":"code","3cabfe7f":"code","78ace0a1":"code","7a21caf5":"markdown","2b83ad4a":"markdown","eb85bb62":"markdown","b577d3a2":"markdown","807c032c":"markdown","b07f3164":"markdown","2b37b458":"markdown","abf188df":"markdown","b50232db":"markdown","eac0325d":"markdown","45f56656":"markdown","58e96505":"markdown","31692343":"markdown","736a191e":"markdown","a2022578":"markdown","adaa04a3":"markdown","49d8d290":"markdown","7d46388e":"markdown","b8d9e190":"markdown","0abf57df":"markdown","1255535d":"markdown","eb6e99b6":"markdown","72934596":"markdown","2992056c":"markdown","ab4056c8":"markdown","69867ab9":"markdown"},"source":{"44b07ce7":"# This Python 3 environment comes with many helpful analytics libraries installed\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set_style('whitegrid')\nfrom subprocess import check_output\nprint(check_output([\"ls\", \"..\/input\"]).decode(\"utf8\"))","ce03d380":"laliga=pd.read_csv('..\/input\/FMEL_Dataset.csv')\nlaliga=laliga[laliga.division==1]","8aa736b7":"laliga.head()","413b94f5":"laliga.info()","5bb7d5f8":"laliga['local_team_won']=laliga.apply(lambda row: 1 if row['localGoals']>row['visitorGoals'] else 0,axis=1)\nlaliga['visitor_team_won']=laliga.apply(lambda row: 1 if row['localGoals']<row['visitorGoals'] else 0,axis=1)\nlaliga['draw']=laliga.apply(lambda row: 1 if row['localGoals']==row['visitorGoals'] else 0,axis=1)","3400b15e":"laliga.tail()","d0656fbb":"df=laliga.copy()","ce792d12":"a=df.groupby(['season','localTeam'])['local_team_won'].sum().reset_index().rename(columns={'localTeam': 'club','local_team_won': 'won'})\nb=df.groupby(['season','visitorTeam'])['visitor_team_won'].sum().reset_index().rename(columns={'visitorTeam': 'club','visitor_team_won': 'won'})\nc=df.groupby(['season','localTeam'])['draw'].sum().reset_index().rename(columns={'localTeam': 'club','draw': 'draw'})\nd=df.groupby(['season','visitorTeam'])['draw'].sum().reset_index().rename(columns={'visitorTeam': 'club','draw': 'draw'})\ne=df.groupby(['season','localTeam'])['visitor_team_won'].sum().reset_index().rename(columns={'localTeam': 'club','visitor_team_won': 'lost'})\nf=df.groupby(['season','visitorTeam'])['local_team_won'].sum().reset_index().rename(columns={'visitorTeam': 'club','local_team_won': 'lost'})","11a7f4ca":"point_table=a.merge(b,on=['season','club']).merge(c,on=['season','club']).merge(d,on=['season','club']).merge(e,on=['season','club']).merge(f,on=['season','club'])\npoint_table.head()","1add32fa":"point_table= point_table.rename(columns={'won_x':'home_win','won_y':'away_win','lost_x':'home_loss','lost_y':'away_loss'})\npoint_table['matches_won']=point_table.home_win+point_table.away_win\npoint_table['matches_lost']=point_table.home_loss+point_table.away_loss\npoint_table['matches_drawn']=point_table.draw_x+point_table.draw_y\npoint_table=point_table.drop(['draw_x','draw_y'],axis=1)\npoint_table['total_matches']=point_table.matches_won+point_table.matches_lost+point_table.matches_drawn","752a2ed8":"point_table['points']=(point_table.matches_won*3)+(point_table.matches_drawn*1)","957947af":"point_table.tail()","9b992f18":"g=df.groupby(['season','localTeam'])['localGoals'].sum().reset_index().rename(columns={'localTeam': 'club','localGoals': 'home_goals'})\nh=df.groupby(['season','visitorTeam'])['visitorGoals'].sum().reset_index().rename(columns={'visitorTeam': 'club','visitorGoals': 'away_goals'})\ni=df.groupby(['season','localTeam'])['visitorGoals'].sum().reset_index().rename(columns={'localTeam': 'club','visitorGoals': 'goals_conceded'})\nj=df.groupby(['season','visitorTeam'])['localGoals'].sum().reset_index().rename(columns={'visitorTeam': 'club','localGoals': 'goals_conceded'})","6549d9cf":"point_table=point_table.merge(g,on=['season','club']).merge(h,on=['season','club']).merge(i,on=['season','club']).merge(j,on=['season','club'])","1db35315":"point_table['goals_scored']=point_table.home_goals+point_table.away_goals\npoint_table['goals_conceded']=point_table.goals_conceded_x+point_table.goals_conceded_y\npoint_table['goal_difference']=point_table.goals_scored-point_table.goals_conceded\npoint_table= point_table.drop(['goals_conceded_x','goals_conceded_y'],axis=1)","12401a6a":"point_table= point_table.sort_values(by=['season','points','goal_difference']).reset_index().drop('index',axis=1)","2cdc0e37":"point_table.tail(n=20).sort_values('points',ascending=False)","c18153a3":"df=point_table.copy()","cc6f8f70":"champs=df[df.groupby(['season'])['points'].transform(max)==df.points].reset_index()\nchamps.tail(12)","c19da1e5":"champs=champs.drop(champs.index[[37]])\nchamps.tail(12)","2a9b07c3":"champs.club.value_counts().reset_index()","ebaaa58b":"champs.club.value_counts().plot(kind='pie', autopct='%2.1f%%', figsize=(7,7))","89ca1681":"df.groupby(['club'])['home_win'].sum().sort_values(ascending=False).head(20).plot(kind='bar',figsize=(20,8))","8eb3e236":"df.groupby(['club'])['matches_won'].sum().sort_values(ascending=False).head(20).plot(kind='bar',figsize=(20,8))","9a200783":"df.groupby(['club'])['goals_scored'].sum().sort_values(ascending=False).head(20)","987b3e34":"w=df.groupby(['club'])['home_goals'].sum().sort_values(ascending=False).head(20).reset_index()\nx=df.groupby(['club'])['away_goals'].sum().sort_values(ascending=False).head(20).reset_index()\ny=df.groupby(['club'])['goals_scored'].sum().sort_values(ascending=False).head(20).reset_index()\nz=w.merge(x,on=['club']).merge(y,on=['club'])\na=df.groupby(['club'])['home_win'].sum().sort_values(ascending=False).head(20).reset_index()\nb=df.groupby(['club'])['away_win'].sum().sort_values(ascending=False).head(20).reset_index()\nc=df.groupby(['club'])['matches_won'].sum().sort_values(ascending=False).head(20).reset_index()\nz=a.merge(b,on=['club']).merge(c,on=['club']).merge(z,on=['club'])","51bf7ef7":"z.plot(x='club',y=['home_goals','away_goals','goals_scored'], kind=\"bar\",figsize=(15,8))","3cabfe7f":"sns.FacetGrid(z, hue=\"club\", size=7).map(plt.scatter, \"goals_scored\", \"matches_won\").add_legend()","78ace0a1":"z.plot(x='club',y=['home_win','away_win','matches_won'], kind=\"barh\",figsize=(15,10))","7a21caf5":"This time we will check the last 5 matches and see what the new features justify.","2b83ad4a":"Next, we will calculate the number of wins,losses or draws each team\/club has registered both on there home grounds and away arenas. For simplicity the results are stored in simple alphabetica variables. ","eb85bb62":"Now we will leave this dataset here and create a new one for further analysis.\n\nI will name it as **points_table** .\nThis will contain the information of each teams' performance season wise.\n\nTo do it let's take a copy of laliga dataset and extract features from this copy to **points_table** dataset.","b577d3a2":"Share of home goals and away goals for each team towards the total goals .","807c032c":"It's time to award points for each team as per their performance in the matches. In laliga the winning team gets 3 points. for a decided match. Otherwise each team gets 1 point each if the match ends as a tie.","b07f3164":"More analysis and visualization to come soon....","2b37b458":"Here the **won_x** feature stands for Win In HomeGround and **won_y** for Win In AwayGround. The same is for loss and draw. So we will rename the columns accordingly. Then calculate the total number of win ,loss and draw. Obviously the total number of matches played in the season by the team will be the sum of the aforesaid numbers.","abf188df":"We will sort the points table so as to get the team rankings in each of the seasons.","b50232db":"The more the number of goals scored, the more is the number of matches won. The following graph proves it.","eac0325d":"After this let's have look at the points table of the last la liga season(2016-17). Here Real Madrid stand out as the winners followed by Barcelona.","45f56656":"And this is how the points_table looks like after this.","58e96505":"again taking a copy of this dataframe.","31692343":"Looking at the LaLiga winners for each of these years.","736a191e":"Let us view a sample of this data now.","a2022578":"COOL!!! Our new features say the local team won the first match, the visitor team won the second match and third match was a draw(in the order shown in above table).","adaa04a3":"We will create **points_table** with all these win ,loss and draw information and see how it looks.","49d8d290":"Let us start by reading the dataset in the name of laliga.\nThen we will filter only the first divison matches from the whole dataset and run our analysis.","7d46388e":"Next, We will create 3 new features in the dataset to see which team has won the match or the match ended as a tie.","b8d9e190":"Going a little forward we will calculate the goals scored and conceded by each team throughout a season and also the goal difference.","0abf57df":"Some bar graphs showing the dominance in the league with home wins, total wins.","1255535d":"If we go for the info of the dataset we can see there are 10 features for each of 16789 matches played in laliga in the given time. The dataset is not having any null values as all the columns are having same length(16789).","eb6e99b6":"Counting the trophies each team has won in this time period.  Real Madrid are the leaders here. Plotting the trophy share as a pie chart.","72934596":"For 2006-07 season we have 2 entries as both have equal points. So deleting the second entry on to head-to-head goals criteria.","2992056c":"Dominance of each team on their home ground and away ground with respect to total matches won.","ab4056c8":"**            Data of 47 years of Spanish League.That's huge. **\nI will explore,analyse and visualize this data only for La Liga.I will leave out the data for the second division matches.\n\nI will touch the following points of interest of this beautiful game.\n* The points table for the tournament.\n* Trend of winning in home ground and away grounds\n* Trend of goal scoring in home and away matches\n* Season wise laliga winners\n* The masters of winning matches and trophy","69867ab9":"This is a ranking of teams based on total goals scored. Two arch rivals are leading the way here."}}