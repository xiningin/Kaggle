{"cell_type":{"f10f6303":"code","17b0df94":"code","1caa1196":"code","2cb188b4":"code","a186fa42":"code","e182d864":"code","e8f4d7c0":"code","6d78f8a3":"code","5d2b4b27":"code","dca116d0":"code","f17cba2a":"code","0d597aa3":"code","ff3df3e2":"code","b9b0529d":"code","8cdf866a":"code","c2797fa4":"code","524cbd20":"code","4e5d64b9":"code","be760699":"code","7e5e00e9":"code","8237d6cb":"code","1043a4b4":"code","ced833f3":"code","e332c02f":"code","8badc143":"code","1bb26859":"code","0ee3d93e":"code","d6ba1725":"code","1c4c4204":"markdown","09e68c77":"markdown","246f5e6e":"markdown","70ffe68f":"markdown","75b185f6":"markdown","26d519b4":"markdown","c51dd21b":"markdown","ff32717e":"markdown","ec317769":"markdown","ef7106b6":"markdown","7756a781":"markdown"},"source":{"f10f6303":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","17b0df94":"!pip install feyn","1caa1196":"import feyn","2cb188b4":"df = pd.read_csv('..\/input\/weather-istanbul-data-20092019\/Istanbul Weather Data.csv')\ndf.head()","a186fa42":"df.shape","e182d864":"df.isnull().sum()","e8f4d7c0":"# categorical features with missing values\ncategorical_nan = [feature for feature in df.columns if df[feature].isna().sum()>0 and df[feature].dtypes=='O']\nprint(categorical_nan)","6d78f8a3":"# replacing missing values in categorical features\nfor feature in categorical_nan:\n    df[feature] = df[feature].fillna('None')","5d2b4b27":"df[categorical_nan].isna().sum()","dca116d0":"df[\"week\"] = pd.to_datetime(df.DateTime).dt.isocalendar().week.astype(int)\ndf = df.drop(\"DateTime\", axis=1)","f17cba2a":"#Remove colon to avoid errors ValueError: invalid literal for int() with base 10\n\n#Code by Sohom Majumder https:\/\/www.kaggle.com\/sohommajumder21\/statistical-tests-for-understanding-life-value\/comments\n\ndf['SunRise']=df['SunRise'].str.replace(':', '')\ndf['SunRise'] = pd.to_numeric(df['SunRise'], errors = 'coerce')\ndf['SunSet']=df['SunSet'].str.replace(':', '')\ndf['Sunset'] = pd.to_numeric(df['SunSet'], errors = 'coerce')\ndf['MoonRise']=df['MoonRise'].str.replace(':', '')\ndf['MoonRise'] = pd.to_numeric(df['MoonRise'], errors = 'coerce')\ndf['MoonSet']=df['MoonSet'].str.replace(':', '')\ndf['Moonset'] = pd.to_numeric(df['MoonSet'], errors = 'coerce')","0d597aa3":"#Code by Tejashvi14 https:\/\/www.kaggle.com\/tejashvi14\/casualty-analysis\/notebook\n\n#After that snippet the float(Rain) and the other objects become integers.\n\ndf[\"Rain\"]=df[\"Rain\"].apply(int)\ndf[\"SunRise\"]=df[\"SunRise\"].apply(int)\ndf[\"SunSet\"]=df[\"SunSet\"].apply(int)\ndf[\"MoonRise\"] = df[\"MoonRise\"].apply(int)\ndf[\"MoonSet\"] = df[\"MoonSet\"].apply(int)","ff3df3e2":"#df.SunRise = df.SunRise.fillna(\"-1:0:0\").apply(lambda s: s.split(\":\")[0]).astype(int)\n#df.SunSet = df.SunSet.fillna(\"-1:0:0\").apply(lambda s: s.split(\":\")[0]).astype(int)\n#df.MoonRise = df.MoonRise.fillna(\"-1:0:0\").apply(lambda s: s.split(\":\")[0]).astype(int)\n#df.MoonSet = df.MoonSet.fillna(\"-1:0:0\").apply(lambda s: s.split(\":\")[0]).astype(int)","b9b0529d":"df.dtypes","8cdf866a":"stypes = {\n    \"Condition\": \"cat\",\n   # \"SunRise\": \"cat\",\n    #\"SunSet\": \"cat\",\n    \"MoonRise\": \"cat\",\n    \"MoonSet\": \"cat\",\n    }","c2797fa4":"#Code by Bizen https:\/\/www.kaggle.com\/hiro5299834\/tps-apr-2021-deebtables\/notebook\n\nTARGET = 'Rain' #Target could Not be float otherwise will result in valueError: Unknown label type: 'continuous'. Even after the encoding.\n\nlabel_cols = ['Condition','MoonRise', 'MoonSet']\nnumerical_cols = ['SunRise', 'SunSet', 'MaxTemp', 'MinTemp', 'AvgWind', 'AvgHumidity', 'AvgPressure', 'week']","524cbd20":"#Code by Bizen https:\/\/www.kaggle.com\/hiro5299834\/tps-apr-2021-deebtables\/notebook\n\nfrom sklearn.preprocessing import LabelEncoder\n\ndef label_encoder(c):\n    le = LabelEncoder()\n    return le.fit_transform(c)\n\nlabel_encoded_df = df[label_cols].apply(label_encoder)\nnumerical_df = df[numerical_cols]\ntarget_df = df[TARGET]\n\ndf = pd.concat([label_encoded_df, numerical_df, target_df], axis=1)","4e5d64b9":"df.head()","be760699":"train, test = feyn.tools.split(df, ratio=(1,1), random_state=42)","7e5e00e9":"ql = feyn.connect_qlattice()","8237d6cb":"ql.reset(random_seed=42)","1043a4b4":"models = ql.auto_run(train, output_name=\"Rain\", kind=\"regression\", stypes = stypes)","ced833f3":"models[0].plot_roc_curve(train)\nmodels[0].plot_roc_curve(test)","e332c02f":"models = ql.auto_run(train, output_name=\"Rain\", stypes = stypes)","8badc143":"models[0].plot_confusion_matrix(test, threshold=.3)","1bb26859":"models[0].plot_confusion_matrix(test, threshold=.5)","0ee3d93e":"models[0].sympify(2)","d6ba1725":"models[0].plot(test)","1c4c4204":"#Code by Casper Wilstrup https:\/\/www.kaggle.com\/wilstrup\/use-qlattice-to-predict-rainy-days-in-australia\/notebook","09e68c77":"#Below: Let's try models without specifying the kind (Regression or classification).","246f5e6e":"#Reproducibility\n\nThe qlattice will be reset when we get it, but to ensure that we get exactly the same result every time we run the notebook we need to seed the QLattice. This is done with the reset method","70ffe68f":"#Check if the Label Encoding worked","75b185f6":"<center style=\"font-family:verdana;\"><h1 style=\"font-size:200%; padding: 20px; background: #001f3f;\"><i><b style=\"color:white;\">Feyn and QLattice<\/b><\/i><\/h1><\/center>\n\n\"Feyn is a Python module for interacting with the QLattice.\"\n\n\"The QLattice is a machine learning technology that helps you search through an infinite list of potential mathematical models to solve your problem.\"\n\n\"It's a quantum-inspired simulation where you make decisions when exploring the data, giving you a good understanding of the relationships in your data and closing the loop between scientific inquiry and data science.\"\n\nhttps:\/\/docs.abzu.ai\/\n\nhttps:\/\/docs.abzu.ai\/docs\/guides\/getting_started\/community.html","26d519b4":"#ValueError: invalid literal for int() with base 10: 'None'","c51dd21b":"#Community QLattice\n\nWe are now ready to connect to the QLattice. The feyn module will look in you local configuration file to see if we have a commercial QLattice. If not, it will allocate a community QLattice for us on the Abzu compute cluster.","ff32717e":"Above I got ValueError: multiclass format is not supported","ec317769":"#Search for the best model\n\nWe are now ready to instruct the QLattice to search for the best mathematical model to explain the data. Here we use the high-level convenience function that does everything with sensible defaults: https:\/\/docs.abzu.ai\/docs\/guides\/essentials\/auto_run.html.\n\nFor more detailed control, we could use the primitives: https:\/\/docs.abzu.ai\/docs\/guides\/primitives\/using_primitives.html\n\nNotice that the stypes dictionary we created earlier gets passed to the QLattice here.\n\nNOTE: This will take several minutes to complete. It invoves work done on the QLattice machine remotely as well as in the local notebook. The part that runs locally is slowing things down because of the limited CPU resources on Kaggle. Running the same on my machine locally only takes 20 seconds!","ef7106b6":"#If the target variable is continuous rather than boolean, so you should use a Regression model rather than a classification model. Just change the auto_run line to:\n\nmodels = ql.auto_run(train, output_name=\"Rain\", kind=\"regression\", stypes = stypes)","7756a781":"![](https:\/\/media-exp3.licdn.com\/dms\/image\/C4E1BAQEuTsJLViLkQw\/company-background_10000\/0\/1587631889353?e=2159024400&v=beta&t=7N65emCWIoGvjrTaXUbHwLSaNEySNW0rAiEADaGOutI)br.linkedin.com"}}