{"cell_type":{"861ac6b0":"code","91d0b4ae":"code","febf54af":"code","c680523b":"code","e479c1f3":"code","7a385573":"code","a14fa420":"code","a1f832fc":"code","0b40fd39":"markdown","5d522bf4":"markdown"},"source":{"861ac6b0":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import accuracy_score, confusion_matrix\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","91d0b4ae":"train_df = pd.read_csv(\"\/kaggle\/input\/titanic\/train.csv\")\ntrain_df.head()","febf54af":"features = ['Pclass', 'Sex', 'Age', 'Embarked']\ny = train_df['Survived']\nX = train_df[features]\nX.head()","c680523b":"# Calculate the mean age and embarked mode to fill in missing values.\nmean_age = X['Age'].mean()\nmode_embarked = X['Embarked'].mode()\n\nX.loc[:, 'Age'] = X['Age'].fillna(value=mean_age)\nX.loc[:, 'Embarked'] = X['Embarked'].fillna(value=mode_embarked[0])\n\nX.loc[:, 'Sex'] = X['Sex'].replace(to_replace=['male', 'female'], value=[0, 1])","e479c1f3":"# Convert Embarked to one-hot encoded numeric values\nX = pd.get_dummies(X)\nX.head()","7a385573":"# Split X into training and test sets.\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42)","a14fa420":"# Train KNN model.\nmodel = KNeighborsClassifier(10, leaf_size=17)\nmodel.fit(X_train, y_train)\ny_predict = model.predict(X_test)\n\n# Get accuracy for predictions on the test set\naccuracy = accuracy_score(y_test, y_predict)\naccuracy","a1f832fc":"cm = confusion_matrix(y_test, y_predict)\ncm","0b40fd39":"### Select which features to use for training the model.","5d522bf4":"This notebook is to demonstrate how to split a dataset into training and test sets in order to estimate the accuracy of a model."}}