{"cell_type":{"e63a3d81":"code","c7715f7c":"code","0c637f6d":"code","663dd2b7":"code","ea99f5d8":"code","ab930c38":"code","8e2779ac":"code","68d930df":"code","1c2bea2b":"code","9c572bff":"code","23ba7159":"code","b7c9fa6e":"code","9aabbd53":"code","6517b842":"code","7a9ff2e4":"code","255db696":"markdown","b3cb382f":"markdown","489057ff":"markdown","222df06d":"markdown","843bbe74":"markdown","a8cf37a0":"markdown","ec7bd21c":"markdown","fa6d0f74":"markdown","5aeb57ac":"markdown","561e6ed0":"markdown","de098469":"markdown","9a374a8f":"markdown"},"source":{"e63a3d81":"!pip install openpyxl","c7715f7c":"import pandas as pd\nimport geopandas as gpd\nimport chardet\n\nimport folium\nfrom datetime import datetime\nfrom folium import Choropleth\nfrom IPython.display import IFrame\n\nimport time\n# from selenium import webdriver\n# from selenium.webdriver.chrome.options import Options\n\nfrom PIL import Image\nimport glob\n\nimport cv2\nimport os","0c637f6d":"prov = gpd.read_file('..\/input\/covid-indonesia\/prov.shp')\ndaily_covid = pd.read_excel('..\/input\/covid-indonesia\/covid_harian.xlsx')\n\nprov.head()","663dd2b7":"daily_covid.head()","ea99f5d8":"prov = prov.drop(['NAME_0', 'KODE'], axis=1)\nprov = prov.set_index('NAME_1')\nprov = prov.sort_index(ascending=True)\n\ndaily_covid = pd.DataFrame(daily_covid)\ndaily_covid = daily_covid.rename(columns={'Unnamed: 0': 'Tanggal', 'Aceh': 'Aceh', 'Bali': 'Bali',\n                                          'Babel': 'Bangka Belitung', 'Banten': 'Banten', 'Bengkulu': 'Bengkulu',\n                                          'Gorontalo': 'Gorontalo', 'Jabar': 'Jawa Barat', 'Jakarta': 'Jakarta Raya',\n                                          'Jambi': 'Jambi', 'Jateng': 'Jawa Tengah', 'Jatim': 'Jawa Timur',\n                                          'Kalbar': 'Kalimantan Barat', 'Kalsel': 'Kalimantan Selatan',\n                                          'Kaltara': 'Kalimantan Utara', 'Kalteng': 'Kalimantan Tengah',\n                                          'Kaltim': 'Kalimantan Timur', 'Kep Riau': 'Kepulauan Riau',\n                                          'Lampung': 'Lampung', 'Maluku': 'Maluku', 'Malut': 'Maluku Utara',\n                                          'NTB': 'Nusa Tenggara Barat', 'NTT': 'Nusa Tenggara Timur',\n                                          'Papbar': 'Papua Barat', 'Papua': 'Papua', 'Riau': 'Riau',\n                                          'Sulbar': 'Sulawesi Barat', 'Sulsel': 'Sulawesi Selatan',\n                                          'Sulteng': 'Sulawesi Tengah', 'Sultra': 'Sulawesi Tenggara',\n                                          'Sulut': 'Sulawesi Utara', 'Sumbar': 'Sumatera Barat',\n                                          'Sumsel': 'Sumatera Selatan', 'Sumut': 'Sumatera Utara', 'DIY': 'Yogyakarta'})\ndaily_covid.to_csv('daily_covid_t')\ndaily_covid['Tanggal'] = daily_covid['Tanggal'].astype(str)\ndaily_covid_fix = daily_covid.set_index(daily_covid['Tanggal'])\ndaily_covid_fix = daily_covid_fix.drop(['Tanggal'], axis=1)\ndaily_covid_fix = daily_covid_fix.T\ndaily_covid_fix = daily_covid_fix.sort_index(ascending=True)","ab930c38":"prov.head()","8e2779ac":"daily_covid_fix.head()","68d930df":"df = prov.merge(daily_covid_fix, left_index=True, right_index=True, how='inner')\ndf.head()","1c2bea2b":"def embed_map(the_map, filename):\n    the_map.save(filename)\n    return IFrame(filename, width='100%', height='500px')","9c572bff":"list_of_days = daily_covid['Tanggal']\nlist_of_days.head()","23ba7159":"# for day in list_of_days:\n#     df_geo = df.copy()\n\n#     map1 = folium.Map(tiles=None, zoom_control=False)\n\n#     choropleth = Choropleth(geo_data=df_geo.__geo_interface__,\n#                             data=df_geo[day]\/1000,\n#                             key_on='feature.id',\n#                             bins=[0, 50, 100, 250, 500, 750, 1000],\n#                             threshold_scale=[0, 50, 100, 250, 500, 750, 1000],\n#                             fill_color='Dark2',\n#                             fill_opacity=0.75,\n#                             line_color='white',\n#                             line_weight=0.25,\n#                             line_opacity=0.75,\n#                             legend_name='Total Case (1:1000)').add_to(map1)\n\n#     map1.fit_bounds([[12.728487, 101.419820], [-13.729686, 136.219106]])\n\n#     date = pd.to_datetime(day)\n#     date = datetime.strftime(date, '%d %B %Y')\n\n#     title_html = f'''<h3 align=\"center\" style=\"font-size:25px\">\n#                         <b>{date}<\/b><\/h3>\n#                      '''\n#     map1.get_root().html.add_child(folium.Element(title_html))\n\n#     embed_map(map1, f'.\/html_maps\/{day}_Covid.html')","b7c9fa6e":"# chrome_options = Options()\n# chrome_options.add_argument(\"enable-automation\")\n# chrome_options.add_argument('--disable-notifications')\n# chrome_options.add_argument('--disable-infobars')\n# chrome_options.add_argument('start-maximized')\n# chrome_options.add_argument(\"--disable-gpu\")\n\n\n# for day in list_of_days:\n#     tmpurl = f'D:\/Project\/covid_visualization\/html_maps\/{day}_Covid.html'\n#     browser = webdriver.Chrome(executable_path=r'C:\/Program Files (x86)\/Google\/Chrome\/Application\/chromedriver.exe',\n#                                options=chrome_options)\n#     time.sleep(5)\n#     browser.get(tmpurl)\n#     time.sleep(20)\n#     browser.save_screenshot(f'.\/maps\/{day}_Covid.png')\n#     browser.close()\n#     browser.quit()","9aabbd53":"# def png_to_gif(path_to_images, save_file_path, duration=500):\n#     frames = []\n\n#     images = glob.glob(f'{path_to_images}')\n\n#     for i in sorted(images):\n#         im = Image.open(i)\n#         im = im.resize((1980, 1020), Image.ANTIALIAS)\n#         frames.append(im.copy())\n\n#     frames[0].save(f'{save_file_path}', format='GIF', append_images=frames[1:], save_all=True,\n#                    duration=duration, loop=0)\n\n\n# png_to_gif(path_to_images='.\/maps\/*.png',\n#            save_file_path='.\/plots\/Covid_Choropleth.gif',\n#            duration=500)","6517b842":"# image_folder = 'maps'\n# video_name = 'covid.avi'\n\n# images_ = [img for img in os.listdir(image_folder) if img.endswith(\".png\")]\n# frame = cv2.imread(os.path.join(image_folder, images_[0]))\n# height, width, layers = frame.shape\n# fourcc = cv2.VideoWriter_fourcc(*'DIVX')\n# video = cv2.VideoWriter(video_name, fourcc, 4, (width, height))\n\n# for image in images_:\n#     video.write(cv2.imread(os.path.join(image_folder, image)))\n\n# cv2.destroyAllWindows()\n# video.release()\n","7a9ff2e4":"from IPython.display import YouTubeVideo\nYouTubeVideo('_rruXOBecGE', width=800, height=450)","255db696":"__Import shape file and data file__","b3cb382f":"__Creating video file__","489057ff":"__Cleaning and shaping the data so it can be merged__","222df06d":"![2021-09-02_Covid.png](https:\/\/storage.googleapis.com\/kagglesdsdata\/datasets\/1601412\/2633687\/2021-09-02_Covid.png?X-Goog-Algorithm=GOOG4-RSA-SHA256&X-Goog-Credential=databundle-worker-v2%40kaggle-161607.iam.gserviceaccount.com%2F20210920%2Fauto%2Fstorage%2Fgoog4_request&X-Goog-Date=20210920T162325Z&X-Goog-Expires=345599&X-Goog-SignedHeaders=host&X-Goog-Signature=11a7521ac34a1cc8fcea9cddd3dc75ceb0537692f6d3153ba80e9020683110ffe8fd5eccb0b05c3ff265402aed447fb11c328764a50d0e56244b07c6e59e3c98fe5c909896c1c1824138f542becd78f08f0e796188cf271f6b2ec04763d6ff62f2eee94f8fbf82cb92076b6fa0d462b557d5eef2a53d9948c7b3f64814e0048902e4fafec8e1076dc98e367afde7630ecfaab12de6e8bff109d5ce6d7e0de4a6627c5eb910ab07b0439c800427cdbb4a7b453ac97c9f53b5159316da2285157bdffc8a6da7079d5b31125d1b8a741251a32f487e21dbb5c1e681ce86a76afa4127ae5063dfcea4ebbec1452f31b2674546a460f5ff4b9f571fdc40cc39aef03b)","843bbe74":"__Merging and saving data to csv__","a8cf37a0":"__Plotting map using iteration that we made__","ec7bd21c":"__Taking screenshoot using selenium__","fa6d0f74":"__Create list for iteration (date)__","5aeb57ac":"![Covid_Choropleth.gif](https:\/\/storage.googleapis.com\/kagglesdsdata\/datasets\/1601412\/2633687\/Covid_Choropleth.gif?X-Goog-Algorithm=GOOG4-RSA-SHA256&X-Goog-Credential=databundle-worker-v2%40kaggle-161607.iam.gserviceaccount.com%2F20210928%2Fauto%2Fstorage%2Fgoog4_request&X-Goog-Date=20210928T041053Z&X-Goog-Expires=345599&X-Goog-SignedHeaders=host&X-Goog-Signature=3c0568ce7c7671c32d43b76be60b9d0051ab1bcafc02d3f3758813db83590c6be8634b149fc10236dd4e776f0f696e5835638a989276d9c498d10b33e710073221968fd108443d77dae1ea6d8d20bd3bfd513281ee8e7c1c81c4a4e86291076152b5d201c61f27260a08352786a07cbe88d10eb9c821481ca228fbe6695bd3d88d13c8e575df6bddb01b4b1373b4daed6497d6b075e5809732f641bbcec4833c37211c11b5814836bdef474af07b302a5a469fd536bcb22b367bcd2a4791fd64f8949e55766c3df9936a667a79ea195dd54a855686fb4f6c3747213dd1283169a81cc7568388644231eef50414f4438272a3193d4e742379f1d007cab3113bf8)","561e6ed0":"__Creating gif map__","de098469":"# Covid-19 Indonesia Visualization\nThe goal of this notebook is to visualize Covid-19 Cases in Indonesia (18 March 2020 - 2 Sept 2021)\n![Covid_Choropleth.gif](https:\/\/storage.googleapis.com\/kagglesdsdata\/datasets\/1601412\/2633687\/Covid_Choropleth.gif?X-Goog-Algorithm=GOOG4-RSA-SHA256&X-Goog-Credential=databundle-worker-v2%40kaggle-161607.iam.gserviceaccount.com%2F20210928%2Fauto%2Fstorage%2Fgoog4_request&X-Goog-Date=20210928T041053Z&X-Goog-Expires=345599&X-Goog-SignedHeaders=host&X-Goog-Signature=3c0568ce7c7671c32d43b76be60b9d0051ab1bcafc02d3f3758813db83590c6be8634b149fc10236dd4e776f0f696e5835638a989276d9c498d10b33e710073221968fd108443d77dae1ea6d8d20bd3bfd513281ee8e7c1c81c4a4e86291076152b5d201c61f27260a08352786a07cbe88d10eb9c821481ca228fbe6695bd3d88d13c8e575df6bddb01b4b1373b4daed6497d6b075e5809732f641bbcec4833c37211c11b5814836bdef474af07b302a5a469fd536bcb22b367bcd2a4791fd64f8949e55766c3df9936a667a79ea195dd54a855686fb4f6c3747213dd1283169a81cc7568388644231eef50414f4438272a3193d4e742379f1d007cab3113bf8)","9a374a8f":"__Create function to save map__"}}