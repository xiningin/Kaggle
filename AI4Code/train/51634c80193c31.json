{"cell_type":{"b3d486b4":"code","317531c4":"code","56ed4689":"code","8b6dd1ec":"code","c85e402d":"code","22be84d4":"code","4b322b95":"code","c72d6c8c":"code","60784d33":"code","3bf6985d":"code","29068820":"code","0c7f983f":"code","07750ff8":"code","f43f33d6":"code","b4d281f5":"code","9e6073f6":"code","9a7db7b2":"code","2db8495b":"code","1dc4b8b9":"code","735da19f":"markdown","577ab525":"markdown"},"source":{"b3d486b4":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","317531c4":"## Divorce Reserach","56ed4689":"from sklearn.ensemble import RandomForestClassifier\nfrom sklearn.model_selection import GridSearchCV, train_test_split\nfrom sklearn.metrics import precision_score, recall_score, roc_curve, auc, confusion_matrix, RocCurveDisplay,\\\nPrecisionRecallDisplay\nimport pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt","8b6dd1ec":"# Read the data\n\ndivorce_df = pd.read_csv('\/kaggle\/input\/predicting-divorce\/divorce.csv')\ndivorce_df","c85e402d":"# Check if data is ok and there is no null values\n\ndivorce_df.isna().sum()","22be84d4":"# Select X values\n\nX = divorce_df.drop(['Divorce_Y_N'], axis=1)\nX","4b322b95":"# Select y values\n\ny = divorce_df['Divorce_Y_N']\ny","c72d6c8c":"# Lets find best Random Forest config using GridSearchCV\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33,  random_state=42)\n\nclf_rf = RandomForestClassifier()\n\nparametrs = {'n_estimators': range(10, 50, 10), \n             'max_depth': range(1, 12, 2), \n             'min_samples_leaf': range(1, 7),\n             'min_samples_split': range(2, 9, 2)}\n\ngrid_search_cv_clf = GridSearchCV(clf_rf, parametrs, cv=5, n_jobs=-1, verbose=1)\ngrid_search_cv_clf.fit(X_train, y_train)  \ngrid_search_cv_clf.best_params_","60784d33":"# Lets take the best model and look at accuracy score\n\nbest_clf = grid_search_cv_clf.best_estimator_\n\nbest_clf.score(X_test, y_test)","3bf6985d":"# Now look at the most important features\n\nfeature_importance = best_clf.feature_importances_\nfeature_importance_df = pd.DataFrame({'features': list(X_train), 'feature_importance': feature_importance})\nfeature_importance_df = feature_importance_df.sort_values('feature_importance', ascending=False)\nfeature_importance_df","29068820":"X_short = X[['hate_subjects', 'roles', 'dreams', 'humiliate', 'likes', 'happy', 'marriage', 'love',\n            'freeom_value', 'anxieties', 'enjoy_travel', 'Ignore_diff', 'Special_time', 'care_sick']]\nX_short","0c7f983f":"# Do the same as above\nX_train_sh, X_test_sh, y_train_sh, y_test_sh = train_test_split(X_short, y, test_size=0.33,  random_state=42)\n\nclf_rf = RandomForestClassifier()\n\nparametrs = {'n_estimators': range(10, 50, 10), \n             'max_depth': range(1, 12, 2), \n             'min_samples_leaf': range(1, 7),\n             'min_samples_split': range(2, 9, 2)}\n\ngrid_search_cv_clf = GridSearchCV(clf_rf, parametrs, cv=5, n_jobs=-1, verbose=1)\ngrid_search_cv_clf.fit(X_train_sh, y_train_sh)  \ngrid_search_cv_clf.best_params_","07750ff8":"# It appears tht theory was right, short dataset hit the same high accuracy score \n\nbest_clf = grid_search_cv_clf.best_estimator_\n\nbest_clf.score(X_test_sh, y_test_sh)","f43f33d6":"feature_importance_df.plot.pie(\n                        explode=[0.1]*len(X_train.columns),\n                        labels = feature_importance_df.features,\n                        y = 'feature_importance',\n                        autopct='%1.1f%%',\n                        shadow=True,\n                        legend=False,\n                        figsize=(8, 8));","b4d281f5":"# Confusion matrix\n\ny_pred = best_clf.predict(X_test_sh)\nsns.heatmap(confusion_matrix(y_test_sh, y_pred), annot=True, cmap=\"Blues\")","9e6073f6":"# Count precision, recall\n\nprecision = precision_score(y_test_sh, y_pred)\nrecall = recall_score(y_test_sh, y_pred)\n\nprecision, recall","9a7db7b2":"# Count true probability \n\nprobability = best_clf.predict_proba(X_test_sh)\nprobability","2db8495b":"# Lets look at probability distribution \n\ntrue_probability = probability[:, 1]  \n\npd.Series(true_probability).hist()","1dc4b8b9":"# ROC AUC curve \n\nfpr, tpr, thresholds = roc_curve(y_test_sh, true_probability)\n\nroc_auc= auc(fpr, tpr)\nlw=2\n\nplt.figure()\nplt.plot(fpr, tpr, color='darkorange',\n         lw=lw, label='ROC curve (area = %0.2f)' % roc_auc)\nplt.plot([0, 1], [0, 1], color='navy', lw=lw, linestyle='--')\nplt.xlim([0.0, 1.0])\nplt.ylim([0.0, 1.05])\nplt.xlabel('False Positive Rate')\nplt.ylabel('True Positive Rate')\nplt.title('Receiver operating characteristic example')\nplt.legend(loc=\"lower right\")\nplt.show()","735da19f":"Questions are ranked on a scale of 1-5 with 1 being the lowest and 5 being the highest. The last category states if the couple has divorced.\n\n1.\tIf one of us apologizes when our discussion deteriorates, the discussion ends.\n2.\tI know we can ignore our differences, even if things get hard sometimes.\n3.\tWhen we need it, we can take our discussions with my spouse from the beginning and correct it.\n4.\tWhen I discuss with my spouse, to contact him will eventually work.\n5.\tThe time I spent with my wife is special for us.\n6.\tWe don't have time at home as partners.\n7.\tWe are like two strangers who share the same environment at home rather than family.\n8.\tI enjoy our holidays with my wife.\n9.\tI enjoy traveling with my wife.\n10.\tMost of our goals are common to my spouse.\n11.\tI think that one day in the future, when I look back, I see that my spouse and I have been in harmony with each other.\n12.\tMy spouse and I have similar values in terms of personal freedom.\n13.\tMy spouse and I have similar sense of entertainment.\n14.\tMost of our goals for people (children, friends, etc.) are the same.\n15.\tOur dreams with my spouse are similar and harmonious.\n16.\tWe're compatible with my spouse about what love should be.\n17.\tWe share the same views about being happy in our life with my spouse\n18.\tMy spouse and I have similar ideas about how marriage should be\n19.\tMy spouse and I have similar ideas about how roles should be in marriage\n20.\tMy spouse and I have similar values in trust.\n21.\tI know exactly what my wife likes.\n22.\tI know how my spouse wants to be taken care of when she\/he sick.\n23.\tI know my spouse's favorite food.\n24.\tI can tell you what kind of stress my spouse is facing in her\/his life.\n25.\tI have knowledge of my spouse's inner world.\n26.\tI know my spouse's basic anxieties.\n27.\tI know what my spouse's current sources of stress are.\n28.\tI know my spouse's hopes and wishes.\n29.\tI know my spouse very well.\n30.\tI know my spouse's friends and their social relationships.\n31.\tI feel aggressive when I argue with my spouse.\n32.\tWhen discussing with my spouse, I usually use expressions such as \u2018you always\u2019 or \u2018you never\u2019 .\n33.\tI can use negative statements about my spouse's personality during our discussions.\n34.\tI can use offensive expressions during our discussions.\n35.\tI can insult my spouse during our discussions.\n36.\tI can be humiliating when we discussions.\n37.\tMy discussion with my spouse is not calm.\n38.\tI hate my spouse's way of open a subject.\n39.\tOur discussions often occur suddenly.\n40.\tWe're just starting a discussion before I know what's going on.\n41.\tWhen I talk to my spouse about something, my calm suddenly breaks.\n42.\tWhen I argue with my spouse, \u0131 only go out and I don't say a word.\n43.\tI mostly stay silent to calm the environment a little bit.\n44.\tSometimes I think it's good for me to leave home for a while.\n45.\tI'd rather stay silent than discuss with my spouse.\n46.\tEven if I'm right in the discussion, I stay silent to hurt my spouse.\n47.\tWhen I discuss with my spouse, I stay silent because I am afraid of not being able to control my anger.\n48.\tI feel right in our discussions.\n49.\tI have nothing to do with what I've been accused of.\n50.\tI'm not actually the one who's guilty about what I'm accused of.\n51.\tI'm not the one who's wrong about problems at home.\n52.\tI wouldn't hesitate to tell my spouse about her\/his inadequacy.\n53.\tWhen I discuss, I remind my spouse of her\/his inadequacy.\n54.\tI'm not afraid to tell my spouse about her\/his incompetence.\n55. \tDivorce Y\/N\n\n","577ab525":"After step above it appears thay only 13 features has some importance. Another 41 (54-13) is garbage\/noise. Lets try discard them and find out is out theory True?"}}