{"cell_type":{"2aef9fda":"code","5d0dfb60":"code","66a945db":"code","b1c43c17":"code","c00fae03":"code","1f19bfa9":"code","d13b3b88":"code","ed05157c":"code","2115bc4a":"code","f1341a81":"code","7527aae9":"code","d8730981":"code","ad3436ee":"code","f1a9fc18":"markdown","435675e6":"markdown","61d99bbf":"markdown","b0b56304":"markdown","cf9cde21":"markdown","a2fe90dc":"markdown","972c5997":"markdown","2c431366":"markdown","98b378c9":"markdown","064a5584":"markdown","db2536ce":"markdown","510d4372":"markdown","45eee5cf":"markdown","24afc88d":"markdown","543602bc":"markdown","197dfdfb":"markdown","ed0038a8":"markdown"},"source":{"2aef9fda":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nfrom matplotlib import pyplot as plt\n\nimport sqlite3\n\nfrom sklearn.model_selection import train_test_split, GridSearchCV\nfrom sklearn.preprocessing import OneHotEncoder, LabelEncoder, StandardScaler\n\nimport tensorflow as tf","5d0dfb60":"tf.__version__","66a945db":"# fix random seed for reproducibility\nseed = 42\nnp.random.seed(seed)","b1c43c17":"connection = sqlite3.connect('..\/input\/database.sqlite')\ndata = pd.read_sql_query(''' SELECT * FROM IRIS ''', connection)\nprint(\"Shape of data: {}\".format(data.shape))","c00fae03":"data.head(3)","1f19bfa9":"data.info()","d13b3b88":"Y = data['Species']\nX = data.drop(['Id', 'Species'], axis=1)\nprint(\"Shape of Input  features: {}\".format(X.shape))\nprint(\"Shape of Output features: {}\".format(Y.shape))","ed05157c":"Y.value_counts()","2115bc4a":"lbl_clf = LabelEncoder()\nY_encoded = lbl_clf.fit_transform(Y)\n\n#Keras requires your output feature to be one-hot encoded values.\nY_final = tf.keras.utils.to_categorical(Y_encoded)\n\nprint(\"Therefore, our final shape of output feature will be {}\".format(Y_final.shape))","f1341a81":"x_train, x_test, y_train, y_test = train_test_split(X, Y_final, test_size=0.25, random_state=seed, stratify=Y_encoded, shuffle=True)\n\nprint(\"Training Input shape\\t: {}\".format(x_train.shape))\nprint(\"Testing Input shape\\t: {}\".format(x_test.shape))\nprint(\"Training Output shape\\t: {}\".format(y_train.shape))\nprint(\"Testing Output shape\\t: {}\".format(y_test.shape))","7527aae9":"std_clf = StandardScaler()\nx_train_new = std_clf.fit_transform(x_train)\nx_test_new = std_clf.transform(x_test)","d8730981":"model = tf.keras.models.Sequential()\nmodel.add(tf.keras.layers.Dense(10, input_dim=4, activation=tf.nn.relu, kernel_initializer='he_normal', \n                                kernel_regularizer=tf.keras.regularizers.l2(0.01)))\nmodel.add(tf.keras.layers.BatchNormalization())\nmodel.add(tf.keras.layers.Dropout(0.3))\nmodel.add(tf.keras.layers.Dense(7, activation=tf.nn.relu, kernel_initializer='he_normal', \n                                kernel_regularizer=tf.keras.regularizers.l1_l2(l1=0.001, l2=0.001)))\nmodel.add(tf.keras.layers.BatchNormalization())\nmodel.add(tf.keras.layers.Dropout(0.3))\nmodel.add(tf.keras.layers.Dense(5, activation=tf.nn.relu, kernel_initializer='he_normal', \n                                kernel_regularizer=tf.keras.regularizers.l1_l2(l1=0.001, l2=0.001)))\nmodel.add(tf.keras.layers.Dense(3, activation=tf.nn.softmax))\n\nmodel.compile(optimizer='adam', loss='categorical_crossentropy', metrics=['accuracy'])\n\niris_model = model.fit(x_train_new, y_train, epochs=700, batch_size=7)","ad3436ee":"model.evaluate(x_test_new, y_test)","f1a9fc18":"# Getting Started","435675e6":"## Splitting the dataset in 75-25 ratio","61d99bbf":"> Tensorflow version","b0b56304":"Here, we will loading data from a a sqlite database using pandas. Alternatively, we can load the data from csv as well. Also, from sklearn.datasets as well","cf9cde21":"## Standardizing the dataset","a2fe90dc":"**Observation** - \n1. There are no null values in the dataset.\n2. Total number of observations are 150.\n3. All the features except the output feature i.e. Species are of float dtype.","972c5997":"## Load the dataset","2c431366":"Printing the first 3 rows from the database will give a higher level understanding of \"what's in the data actually\"","98b378c9":"## Import libraries and Functions","064a5584":"In this problem, we will be using the famous IRIS Flower dataset.\n\nThis dataset is well studied and is a good problem for practicing on neural networks because all of the 4 input variables are numeric and have the same scale in centimeters. Each instance describes the properties of an observed flower measurements and the output variable is specific iris species.\n\nThis is a multi-class classification problem, meaning that there are more than two classes to be predicted, in fact there are three flower species. This is an important type of problem on which to practice with neural networks because the three class values require specialized handling.\n\nThe iris flower dataset is a well studied problem and a such we can expect to achieve an model accuracy in the range of 95% to 97%. This provides a good target to aim for when developing our models.\n\nYou can [download](http:\/\/archive.ics.uci.edu\/ml\/machine-learning-databases\/iris\/iris.data) the iris flowers dataset from the UCI Machine Learning repository and place it in your current working directory with the filename iris.csv\n\nHowever, in our case - we have imported the dataset from kaggle in sqlite3 format.","db2536ce":"## Problem Definition","510d4372":"## Keras\n![Keras Image](https:\/\/s3.amazonaws.com\/keras.io\/img\/keras-logo-2018-large-1200.png)\n\nKeras is a high-level neural networks API, written in Python and capable of running on top of TensorFlow, CNTK, or Theano. It was developed with a focus on enabling fast experimentation. Being able to go from idea to result with the least possible delay is key to doing good research.\n\nUse Keras if you need a deep learning library that:\n\n* Allows for easy and fast prototyping (through user friendliness, modularity, and extensibility).\n* Supports both convolutional networks and recurrent networks, as well as combinations of the two.\n* Runs seamlessly on CPU and GPU.","45eee5cf":"Checking if the dataset contains null\/na values or not.","24afc88d":"## Encoding the Output\/Response Variable","543602bc":"# Introduction","197dfdfb":"> Intialization Seed\n\nThis is important to ensure that the results we achieve from this model can be achieved again precisely. It ensures that the stochastic process of training a neural network model can be reproduced.","ed0038a8":"Building neural networks is a complex endeavor with many parameters to tweak prior to achieving the final version of a model. On top of this, the two most widely used numerical platforms for deep learning and neural network machine learning models, TensorFlow and Theano, are too complex to allow for rapid prototyping. The Keras Deep Learning library for Python helps bridge the gap between prototyping speed and the utilization of the advanced numerical platforms for deep learning."}}