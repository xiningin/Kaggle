{"cell_type":{"64921972":"code","b36c4cb4":"code","8ac6a068":"code","1debad5f":"code","f6873e64":"code","f1137b5c":"code","563e03d3":"code","fe751508":"code","917ebe16":"code","b9a4b4f5":"code","6e2295dd":"code","1e431089":"code","1c554921":"code","eb872b42":"code","c0bb83e7":"code","110c96fb":"code","4b909cfc":"code","ca640b05":"code","5b1acd73":"code","ccdf0c7a":"code","4228e999":"code","307f60d9":"code","a7a8ab1b":"markdown","57c54701":"markdown"},"source":{"64921972":"!pip install  pydotplus","b36c4cb4":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nfrom sklearn import metrics\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.model_selection import train_test_split\n\nfrom io import StringIO  \nfrom IPython.display import Image  \nfrom sklearn.tree import export_graphviz\nimport pydotplus\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\npd.set_option(\"display.max_rows\", 10000)\npd.set_option(\"display.max_columns\", 10000)","8ac6a068":"df_train=pd.read_csv('\/kaggle\/input\/customer-churn-prediction-2020\/train.csv')\ndf_test=pd.read_csv('\/kaggle\/input\/customer-churn-prediction-2020\/test.csv')\n","1debad5f":"df_train.head()","f6873e64":"df_test.head()","f1137b5c":"df_train.info()","563e03d3":"set(df_train.dtypes)\n","fe751508":"df_train_objects=df_train.select_dtypes(include=['object'])\ndf_train_objects.head()","917ebe16":"df_train_int=df_train.select_dtypes(include=['int64','float64'])\ndf_train_int.head()","b9a4b4f5":"df_train['churn_target']=df_train['churn'].map({\"yes\":1,'no':0})","6e2295dd":"df_train_int.columns","1e431089":"x=df_train[['account_length', 'number_vmail_messages', 'total_day_minutes',\n       'total_day_calls', 'total_day_charge', 'total_eve_minutes',\n       'total_eve_calls', 'total_eve_charge', 'total_night_minutes',\n       'total_night_calls', 'total_night_charge', 'total_intl_minutes',\n       'total_intl_calls', 'total_intl_charge',\n       'number_customer_service_calls']]\ny=df_train['churn_target']\n\nX_train,X_test,Y_train,Y_test=train_test_split(x,y,random_state=42,test_size=0.3)","1c554921":"x_test=df_test[['account_length', 'number_vmail_messages', 'total_day_minutes',\n       'total_day_calls', 'total_day_charge', 'total_eve_minutes',\n       'total_eve_calls', 'total_eve_charge', 'total_night_minutes',\n       'total_night_calls', 'total_night_charge', 'total_intl_minutes',\n       'total_intl_calls', 'total_intl_charge',\n       'number_customer_service_calls']]","eb872b42":"clf=DecisionTreeClassifier(criterion='entropy',max_depth=5)\nclf.fit(X_train,Y_train)\ny_pred=clf.predict(X_test)","c0bb83e7":"dot_data = StringIO()\nexport_graphviz(clf, out_file=dot_data,  \n                filled=True, rounded=True,\n                special_characters=True, feature_names = x.columns,class_names=['0','1'])\ngraph = pydotplus.graph_from_dot_data(dot_data.getvalue())  \ngraph.write_png('ChurnPrediction.png')\nImage(graph.create_png())","110c96fb":"y_pred_proba=clf.predict_proba(X_test)[::,1]","4b909cfc":"metrics.accuracy_score(Y_test,y_pred)","ca640b05":"rocaucscore=metrics.roc_auc_score(Y_test,y_pred_proba)\nprint(rocaucscore)","5b1acd73":"metrics.confusion_matrix(Y_test,y_pred)","ccdf0c7a":"print(metrics.classification_report(Y_test,y_pred))","4228e999":"pre,recal,_=metrics.roc_curve(Y_test,y_pred_proba)","307f60d9":"plt.plot(pre,recal,label=rocaucscore)\nplt.plot([0,1],[0,1],'k--')\nplt.legend(loc=4)","a7a8ab1b":"## Model Evaluation","57c54701":"## Display Tree "}}