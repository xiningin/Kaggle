{"cell_type":{"c9841a04":"code","1584dfaa":"code","ad028cad":"code","45b29c0b":"code","342f4561":"code","c8fd78b4":"code","f12a1472":"code","ff2dc804":"code","ff1b9ffd":"code","5a3c031b":"code","909c50da":"code","b1eac4cd":"code","d06d40d7":"code","cc649d4d":"code","589a1cb7":"code","f95ac279":"code","51d006a3":"code","d98f94a9":"code","a63ba692":"code","a11537c1":"code","bf723190":"code","c00b5ff5":"code","ad985eee":"code","227b0034":"code","9a8f4e31":"code","237fbed6":"code","40fb06f5":"code","1397f91c":"code","153f6f12":"code","f32cfd6a":"code","af79faa1":"code","22b31f25":"code","7fc24e4c":"code","dc91758e":"code","6bf60598":"code","cfeb5ea3":"code","70118336":"code","7bd4098c":"code","8f525d06":"code","986c2120":"code","6e3f659f":"code","087fa9ac":"code","b0a2ebf9":"code","3863d8e7":"code","179dc8ab":"code","b26d20bf":"code","308e4a4e":"code","86bd59c4":"code","5b1772e2":"code","684854c6":"code","2588b2fd":"code","1777fa92":"code","85c1363c":"code","6846b52c":"code","656ad93d":"code","677b0369":"code","e9bc76e9":"code","7b7b859f":"code","75752120":"code","53d06ba7":"code","1fb436c7":"code","8ec76be7":"code","e2324643":"code","013e19e8":"code","84d1d2b1":"code","74112a64":"code","8b9b4dfd":"code","3872f067":"code","6b219339":"code","d339aed3":"code","edcc452d":"code","bddb4a8b":"code","c2259a6b":"code","d9d01b04":"code","f05af654":"code","e04358af":"code","f1d96c76":"code","6020ff03":"code","1501c0f7":"code","26282101":"code","ac549132":"code","8cb3303f":"code","9bf0f970":"code","c24bda0e":"code","f78bd55d":"code","69c55813":"code","fa91f1a3":"code","6db6570c":"code","f9581fa5":"code","39f6baa3":"code","28777e4a":"code","e8aed9e0":"code","49ca13d6":"code","6a7475ce":"code","6d220add":"code","ecf1c846":"code","5396760c":"code","61a60265":"code","291e7608":"code","e67d0729":"code","81fb52e9":"code","9157b82f":"code","76bc06e5":"code","b30b0efb":"code","c341eb7b":"code","39284acf":"code","18814dae":"code","fb47fc3e":"code","abf24659":"code","d8601454":"code","878d70f5":"code","3d65bfd5":"code","8f7d2a4e":"code","99ddfb6e":"markdown","9000b37c":"markdown","512cfe82":"markdown","078ba401":"markdown","92768118":"markdown","89fe4c8e":"markdown","6e2d9bb2":"markdown","ffad8bec":"markdown","57ab1626":"markdown","2667de49":"markdown","037352f2":"markdown","b4e1d9a3":"markdown","94f2aa00":"markdown","74f2675b":"markdown","6973956b":"markdown","5b626221":"markdown","0c812436":"markdown","932a71aa":"markdown","bd721047":"markdown","54396b98":"markdown","f71377ab":"markdown","65f7c526":"markdown","4f62e66d":"markdown","de928843":"markdown","646bfa6f":"markdown","d9b9bcb7":"markdown","4a381c6d":"markdown","f533e6dc":"markdown","37bce633":"markdown","417aa152":"markdown","7db2e2a1":"markdown","6a9c88ef":"markdown","925b7202":"markdown","04334132":"markdown","ad05556a":"markdown","a0d04b89":"markdown","b814ba04":"markdown","4f470438":"markdown","9e4b5913":"markdown","8270ab13":"markdown","de2a2a20":"markdown","ccbf6aa2":"markdown","144a7b2e":"markdown","087a8134":"markdown","bcf04e4c":"markdown","12c45353":"markdown","523f5ef0":"markdown","15be904e":"markdown","514f73d5":"markdown","3f9137d9":"markdown","c2448e27":"markdown","16593fee":"markdown","424e8a55":"markdown","1d2700ee":"markdown","7c732da1":"markdown","e4bd6cd8":"markdown","397efcf3":"markdown"},"source":{"c9841a04":"#### IMPORT LIBRARIES\n\n\nimport pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom scipy.stats import shapiro\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.model_selection import train_test_split , GridSearchCV , cross_val_score\nfrom sklearn.metrics import confusion_matrix, accuracy_score, classification_report\nfrom imblearn.over_sampling import SMOTE\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.naive_bayes import GaussianNB\nfrom sklearn.ensemble import GradientBoostingClassifier\nfrom sklearn.svm import SVC\nfrom sklearn.neural_network import MLPClassifier\nfrom sklearn.tree import DecisionTreeClassifier\nfrom xgboost import XGBClassifier\nfrom sklearn.ensemble import RandomForestClassifier\nfrom lightgbm import LGBMClassifier\nfrom catboost import CatBoostClassifier\nimport warnings\nwarnings.filterwarnings(\"ignore\")","1584dfaa":"redwine = pd.read_csv(\"..\/input\/red-wine-quality-cortez-et-al-2009\/winequality-red.csv\")\ndf = redwine.copy()\ndf.head()","ad028cad":"df.info()","45b29c0b":"df.describe().T","342f4561":"df.isnull().values.any()","c8fd78b4":"sns.countplot(x = \"quality\" , data = df);","f12a1472":"plt.figure(1, figsize = (12,7))\nplt.title(\"Quality distribution\", color = \"black\", fontsize = 15)\ndf[\"quality\"].value_counts().plot.pie(autopct = \"%1.1f%%\");","ff2dc804":"plt.figure(figsize = (11,8))\nsns.set(font_scale = 1.1)\nsns.heatmap(df.corr() , cmap = \"RdYlGn\", annot = True, fmt = \".2f\", annot_kws = {\"size\": 12});","ff1b9ffd":"sns.distplot(df[\"fixed acidity\"] , color = \"r\", bins = 60 , hist_kws = {\"alpha\": 0.4});","5a3c031b":"print(\"Skewness: %f\" % df[\"fixed acidity\"].skew())\nprint(\"Kurtosis: %f\" % df[\"fixed acidity\"].kurt())\ntest_statistic, pvalue = shapiro(df[\"fixed acidity\"])\nprint('Shapiro Test Statistic = %.4f, p-value = %.4f' % (test_statistic, pvalue))","909c50da":"sns.distplot(df[\"volatile acidity\"] , color = \"r\", bins = 60 , hist_kws = {\"alpha\": 0.4});","b1eac4cd":"print(\"Skewness: %f\" % df[\"volatile acidity\"].skew())\nprint(\"Kurtosis: %f\" % df[\"volatile acidity\"].kurt())\ntest_statistic, pvalue = shapiro(df[\"volatile acidity\"])\nprint('Shapiro Test Statistic = %.4f, p-value = %.4f' % (test_statistic, pvalue))","d06d40d7":"sns.distplot(df[\"citric acid\"] , color = \"r\", bins = 60 , hist_kws = {\"alpha\": 0.4});","cc649d4d":"print(\"Skewness: %f\" % df[\"citric acid\"].skew())\nprint(\"Kurtosis: %f\" % df[\"citric acid\"].kurt())\ntest_statistic, pvalue = shapiro(df[\"citric acid\"])\nprint('Shapiro Test Statistic = %.4f, p-value = %.4f' % (test_statistic, pvalue))","589a1cb7":"sns.distplot(df[\"residual sugar\"] , color = \"r\", bins = 60 , hist_kws = {\"alpha\": 0.4});","f95ac279":"print(\"Skewness: %f\" % df[\"residual sugar\"].skew())\nprint(\"Kurtosis: %f\" % df[\"residual sugar\"].kurt())\ntest_statistic, pvalue = shapiro(df[\"residual sugar\"])\nprint('Shapiro Test Statistic = %.4f, p-value = %.4f' % (test_statistic, pvalue))","51d006a3":"sns.distplot(df[\"chlorides\"] , color = \"r\", bins = 60 , hist_kws = {\"alpha\": 0.4});","d98f94a9":"print(\"Skewness: %f\" % df[\"chlorides\"].skew())\nprint(\"Kurtosis: %f\" % df[\"chlorides\"].kurt())\ntest_statistic, pvalue = shapiro(df[\"chlorides\"])\nprint('Shapiro Test Statistic = %.4f, p-value = %.4f' % (test_statistic, pvalue))","a63ba692":"sns.distplot(df[\"free sulfur dioxide\"] , color = \"r\", bins = 60 , hist_kws = {\"alpha\": 0.4});","a11537c1":"print(\"Skewness: %f\" % df[\"free sulfur dioxide\"].skew())\nprint(\"Kurtosis: %f\" % df[\"free sulfur dioxide\"].kurt())\ntest_statistic, pvalue = shapiro(df[\"free sulfur dioxide\"])\nprint(\"Shapiro Test Statistic = %.4f, p-value = %.4f\" % (test_statistic, pvalue))","bf723190":"sns.distplot(df[\"total sulfur dioxide\"] , color = \"r\" , bins = 60 , hist_kws = {\"alpha\" : 0.4});","c00b5ff5":"print(\"Skewness: %f\" % df[\"total sulfur dioxide\"].skew())\nprint(\"Kurtosis: %f\" % df[\"total sulfur dioxide\"].kurt())\ntest_statistic , pvalue = shapiro(df[\"total sulfur dioxide\"])\nprint(\"Shapiro Test Statistic = %.4f, p-value = %.4f\" % (test_statistic , pvalue))","ad985eee":"sns.distplot(df[\"density\"] , color = \"r\" , bins = 60 , hist_kws = {\"alpha\" : 0.4});","227b0034":"print(\"Skewness: %f\" % df[\"density\"].skew())\nprint(\"Kurtosis: %f\" % df[\"density\"].kurt())\ntest_statistic, pvalue = shapiro(df[\"density\"])\nprint(\"Shapiro Test Statistic = %.4f, pvalue = %.4f\" % (test_statistic , pvalue))","9a8f4e31":"sns.distplot(df[\"pH\"], color = \"r\" , bins = 60 , hist_kws = {\"alpha\" : 0.4});","237fbed6":"print(\"Skewness : %f\" % df[\"pH\"].skew())\nprint(\"Kurtosis : %f\" % df[\"pH\"].kurt())\ntest_statistic , pvalue = shapiro(df[\"pH\"])\nprint(\"Shapiro Test Statistic : %.4f, pvalue = %.4f\" % (test_statistic , pvalue))","40fb06f5":"sns.distplot(df[\"sulphates\"] , color = \"r\" , bins = 60 , hist_kws = {\"alpha\" : 0.4});","1397f91c":"print(\"Skewness : %f\" % df[\"sulphates\"].skew())\nprint(\"Kurtosis : %f\" % df[\"sulphates\"].kurt())\ntest_statistic , pvalue = shapiro(df[\"sulphates\"])\nprint(\"Shapiro Test Statistic : %.4f , pvalue : %.4f\" % (test_statistic , pvalue))","153f6f12":"sns.distplot(df[\"alcohol\"] , color = \"r\" , bins = 60 , hist_kws = {\"alpha\" : 0.4});","f32cfd6a":"print(\"Skewness : %f\" % df[\"alcohol\"].skew())\nprint(\"Kurtosis : %f\" % df[\"alcohol\"].kurt())\ntest_statistic , pvalue = shapiro(df[\"alcohol\"])\nprint(\"Shapiro Test Statistic : %.4f , pvalue : %.4f\" % (test_statistic , pvalue))","af79faa1":"figure, ax = plt.subplots(1,5, figsize = (24,6))\nsns.boxplot(data = df, x = \"quality\", y=\"fixed acidity\", ax = ax[0])\nsns.boxplot(data = df, x = \"quality\", y=\"volatile acidity\", ax = ax[1])\nsns.boxplot(data = df, x = \"quality\", y=\"citric acid\", ax = ax[2])\nsns.boxplot(data = df, x = \"quality\", y=\"residual sugar\", ax = ax[3])\nsns.boxplot(data = df, x = \"quality\", y=\"chlorides\", ax = ax[4])\nplt.show()","22b31f25":"figure, ax = plt.subplots(1,6, figsize = (24,6))\nsns.boxplot(data = df, x = \"quality\", y=\"free sulfur dioxide\", ax = ax[0])\nsns.boxplot(data = df, x = \"quality\", y=\"total sulfur dioxide\", ax = ax[1])\nsns.boxplot(data = df, x = \"quality\", y=\"density\", ax = ax[2])\nsns.boxplot(data = df, x = \"quality\", y=\"pH\", ax = ax[3])\nsns.boxplot(data = df, x = \"quality\", y=\"sulphates\", ax = ax[4])\nsns.boxplot(data = df, x = \"quality\", y=\"alcohol\", ax = ax[5])\nplt.show()","7fc24e4c":"df[\"quality\"].value_counts()","dc91758e":"## transform func.\n\ndf[\"quality\"] = df[\"quality\"].apply(lambda value : 1 if value >= 7 else 0)","6bf60598":"df[\"quality\"].value_counts()","cfeb5ea3":"x = df[df.columns[:-1]]\ny = df[\"quality\"]","70118336":"scaler = StandardScaler()\nx = scaler.fit_transform(x)","7bd4098c":"x_train , x_test , y_train , y_test = train_test_split(x , y , test_size = 0.20 , random_state = 42)","8f525d06":"x_train.shape , x_test.shape , y_train.shape , y_test.shape","986c2120":"smote = SMOTE(k_neighbors = 4 , random_state = 12)\nx_train, y_train = smote.fit_resample(x_train, y_train)\ny_train.value_counts()","6e3f659f":"knn = KNeighborsClassifier()\nknn_model = knn.fit(x_train , y_train)","087fa9ac":"y_pred_knn = knn_model.predict(x_test)\naccuracy_score(y_test , y_pred_knn)","b0a2ebf9":"knn_params = {\"n_neighbors\": np.arange(1,60)}\nknn_cv = GridSearchCV(knn , knn_params, cv = 10)\nknn_cv.fit(x_train , y_train)","3863d8e7":"print(\"Best Parameters: \" + str(knn_cv.best_params_))","179dc8ab":"knn = KNeighborsClassifier(n_neighbors = 2)\nopt_knn = knn.fit(x_train , y_train)","b26d20bf":"y_pred_knn = opt_knn.predict(x_test)\naccuracy_score(y_test , y_pred_knn)","308e4a4e":"print(classification_report(y_test , y_pred_knn))","86bd59c4":"score = round(accuracy_score(y_test, y_pred_knn), 6)\ncm = confusion_matrix(y_test, y_pred_knn)\nsns.heatmap(cm, annot = True, fmt = \".0f\")\nplt.xlabel(\"Predicted Values\")\nplt.ylabel(\"Actual Values\")\nplt.title(\"Accuracy Score: {0}\".format(score), size = 15)\nplt.show()","5b1772e2":"logi = LogisticRegression(solver = \"liblinear\")\nlog_model = logi.fit(x_train,y_train)","684854c6":"log_model.predict_proba(x_test)[:5]","2588b2fd":"y_pred_logi = log_model.predict(x_test)\naccuracy_score(y_test, y_pred_logi)","1777fa92":"cross_val_score(log_model, x_test, y_test, cv = 10).mean()","85c1363c":"print(classification_report(y_test , y_pred_logi))","6846b52c":"score = round(accuracy_score(y_test, y_pred_logi), 6)\ncm = confusion_matrix(y_test, y_pred_logi)\nsns.heatmap(cm, annot = True, fmt = \".0f\")\nplt.xlabel(\"Predicted Values\")\nplt.ylabel(\"Actual Values\")\nplt.title(\"Accuracy Score: {0}\".format(score), size = 15)\nplt.show()","656ad93d":"gbm = GradientBoostingClassifier()\ngbm_model = gbm.fit(x_train, y_train)","677b0369":"y_pred_gbm = gbm_model.predict(x_test)\naccuracy_score(y_test, y_pred_gbm)","e9bc76e9":"#gbm_params = {\"learning_rate\" : [0.001, 0.01, 0.1, 0.05],\n#             \"n_estimators\": [100,200,300,400,500,600,700],\n#             \"max_depth\": [3,5,10],\n#             \"min_samples_split\": [2,5,10]}\n\n#gbm_cv = GridSearchCV(gbm , gbm_params , cv = 10 , n_jobs = -1 , verbose = 2)\n\n#gbm_cv.fit(x_train, y_train)","7b7b859f":"#print(\"Best Parameters: \" + str(gbm_cv.best_params_))","75752120":"gbm = GradientBoostingClassifier(learning_rate = 0.1, max_depth = 10 , min_samples_split = 5, n_estimators = 300)\nopt_gbm = gbm.fit(x_train, y_train)","53d06ba7":"y_pred_gbm = opt_gbm.predict(x_test)\naccuracy_score(y_test, y_pred_gbm)","1fb436c7":"print(classification_report(y_test , y_pred_gbm))","8ec76be7":"score = round(accuracy_score(y_test, y_pred_gbm), 6)\ncm = confusion_matrix(y_test, y_pred_gbm)\nsns.heatmap(cm, annot = True, fmt = \".0f\")\nplt.xlabel(\"Predicted Values\")\nplt.ylabel(\"Actual Values\")\nplt.title(\"Accuracy Score: {0}\".format(score), size = 15)\nplt.show()","e2324643":"nb = GaussianNB()\nnb_model = nb.fit(x_train , y_train)","013e19e8":"nb_model.predict_proba(x_test)[:5]","84d1d2b1":"y_pred_nb = nb_model.predict(x_test)\naccuracy_score(y_test , y_pred_nb)","74112a64":"cross_val_score(nb_model, x_test, y_test, cv = 10).mean()","8b9b4dfd":"print(classification_report(y_test , y_pred_nb))","3872f067":"score = round(accuracy_score(y_test, y_pred_nb), 6)\ncm = confusion_matrix(y_test, y_pred_nb)\nsns.heatmap(cm, annot = True, fmt = \".0f\")\nplt.xlabel(\"Predicted Values\")\nplt.ylabel(\"Actual Values\")\nplt.title(\"Accuracy Score: {0}\".format(score), size = 15)\nplt.show()","6b219339":"svc = SVC()\nsvc_model = svc.fit(x_train , y_train)","d339aed3":"y_pred_svc = svc_model.predict(x_test)\naccuracy_score(y_test , y_pred_svc)","edcc452d":"svc_params = { \"C\" : [0.01 , 0.1 , 1 , 2 , 3 , 5 , 7 , 10],\n             \"gamma\" : [0.01 , 0.1 , 1 , 3 , 5 , 7 , 10]}\n\nsvc_cv_model = GridSearchCV(svc,svc_params, \n                            cv = 10, \n                            n_jobs = -1, \n                            verbose = 2)\n\nsvc_cv_model.fit(x_train, y_train)","bddb4a8b":"print(\"Best Parameters: \" + str(svc_cv_model.best_params_))","c2259a6b":"opt_svc = SVC(C = 2 , gamma = 1).fit(x_train, y_train)","d9d01b04":"y_pred_svc = opt_svc.predict(x_test)\naccuracy_score(y_test, y_pred_svc)","f05af654":"print(classification_report(y_test , y_pred_svc))","e04358af":"score = round(accuracy_score(y_test, y_pred_svc), 6)\ncm = confusion_matrix(y_test, y_pred_svc)\nsns.heatmap(cm, annot = True, fmt = \".0f\")\nplt.xlabel(\"Predicted Values\")\nplt.ylabel(\"Actual Values\")\nplt.title(\"Accuracy Score: {0}\".format(score), size = 15)\nplt.show()","f1d96c76":"mlpc = MLPClassifier()\nmlpc_model = mlpc.fit(x_train , y_train)","6020ff03":"y_pred_mlpc = mlpc.predict(x_test)\naccuracy_score(y_test, y_pred_mlpc)","1501c0f7":"#mlpc_params = {\"alpha\": [0.1, 0.01, 0.02, 0.005, 0.0001],\n#              \"hidden_layer_sizes\": [(10,10,10),(100,100,100),(100,100),(10,10),(100,)],\n#              \"solver\" : [\"lbfgs\",\"adam\",\"sgd\"],\n#              \"activation\": [\"relu\",\"logistic\"]}\n\n#mlpc_cv_model = GridSearchCV(mlpc , mlpc_params , cv = 10 , n_jobs = -1 , verbose = 2)\n\n#mlpc_cv_model.fit(x_train , y_train)","26282101":"#print(\"Best Parameters: \" + str(mlpc_cv_model.best_params_))","ac549132":"mlpc = MLPClassifier(activation = \"relu\" , alpha = 0.01,\n                     hidden_layer_sizes = (100, 100, 100) , solver = \"adam\")\nopt_mlpc = mlpc.fit(x_train , y_train)","8cb3303f":"y_pred_mlpc = opt_mlpc.predict(x_test)\naccuracy_score(y_test, y_pred_mlpc)","9bf0f970":"print(classification_report(y_test , y_pred_mlpc))","c24bda0e":"score = round(accuracy_score(y_test, y_pred_mlpc), 6)\ncm = confusion_matrix(y_test, y_pred_mlpc)\nsns.heatmap(cm, annot = True, fmt = \".0f\")\nplt.xlabel(\"Predicted Values\")\nplt.ylabel(\"Actual Values\")\nplt.title(\"Accuracy Score: {0}\".format(score), size = 15)\nplt.show()","f78bd55d":"clf = DecisionTreeClassifier()\nclf_model = clf.fit(x_train , y_train)","69c55813":"y_pred_clf = clf_model.predict(x_test)\naccuracy_score(y_test , y_pred_clf)","fa91f1a3":"print(classification_report(y_test , y_pred_clf))","6db6570c":"score = round(accuracy_score(y_test, y_pred_clf), 6)\ncm = confusion_matrix(y_test, y_pred_clf)\nsns.heatmap(cm, annot = True, fmt = \".0f\")\nplt.xlabel(\"Predicted Values\")\nplt.ylabel(\"Actual Values\")\nplt.title(\"Accuracy Score: {0}\".format(score), size = 15)\nplt.show()","f9581fa5":"lgbm = LGBMClassifier()\nlgbm_model = lgbm.fit(x_train, y_train)","39f6baa3":"y_pred_lgbm = lgbm_model.predict(x_test)\naccuracy_score(y_test, y_pred_lgbm)","28777e4a":"lgbm_params = {\"n_estimators\": [100 , 500 , 1000],\n               \"subsample\": [0.6 , 0.8 , 1.0],\n               \"learning_rate\": [0.1 , 0.01 , 0.02 , 0.05],\n               \"min_child_samples\": [5 , 10 , 20]}\n\nlgbm_cv_model = GridSearchCV(lgbm , lgbm_params , cv = 10 , n_jobs = -1 , verbose = 2)\n\nlgbm_cv_model.fit(x_train, y_train)","e8aed9e0":"print(\"Best Parameters: \" + str(lgbm_cv_model.best_params_))","49ca13d6":"lgbm = LGBMClassifier(learning_rate = 0.1 ,max_depth = 8 , min_child_samples = 10 , \n                      n_estimators = 500 , subsample = 0.6)\n\nopt_lgbm = lgbm.fit(x_train, y_train)","6a7475ce":"y_pred_lgbm = opt_lgbm.predict(x_test)\naccuracy_score(y_test, y_pred_lgbm)","6d220add":"print(classification_report(y_test , y_pred_lgbm))","ecf1c846":"score = round(accuracy_score(y_test, y_pred_lgbm), 6)\ncm = confusion_matrix(y_test, y_pred_lgbm)\nsns.heatmap(cm, annot = True, fmt = \".0f\")\nplt.xlabel(\"Predicted Values\")\nplt.ylabel(\"Actual Values\")\nplt.title(\"Accuracy Score: {0}\".format(score), size = 15)\nplt.show()","5396760c":"rf = RandomForestClassifier()\nrf_model = rf.fit(x_train, y_train)","61a60265":"y_pred_rf = rf_model.predict(x_test)\naccuracy_score(y_test, y_pred_rf)","291e7608":"#rf_params = {\"max_features\": [\"auto\",\"sqrt\",\"log2\"], \"n_estimators\": [10, 100 ,300 ,500 ,600 ,800 ,1000],\n#            \"max_depth\" : [2,5,10,15,19,25]}\n\n#rf_cv_model = GridSearchCV(rf_model , rf_params , cv = 10 , n_jobs = -1 , verbose = 2)\n\n#rf_cv_model.fit(x_train, y_train)","e67d0729":"#print(\"Best Parameters: \" + str(rf_cv_model.best_params_))","81fb52e9":"rf_model = RandomForestClassifier(max_features = \"auto\" , max_depth = 19,\n                                  random_state = 44 , n_estimators = 1000)\n\nopt_rf = rf_model.fit(x_train, y_train)","9157b82f":"y_pred_rf = opt_rf.predict(x_test)\naccuracy_score(y_test, y_pred_rf)","76bc06e5":"print(classification_report(y_test , y_pred_rf))","b30b0efb":"score = round(accuracy_score(y_test, y_pred_rf), 6)\ncm = confusion_matrix(y_test, y_pred_rf)\nsns.heatmap(cm, annot = True, fmt = \".0f\")\nplt.xlabel(\"Predicted Values\")\nplt.ylabel(\"Actual Values\")\nplt.title(\"Accuracy Score: {0}\".format(score), size = 15)\nplt.show()","c341eb7b":"xgb = XGBClassifier()\nxgb_model = xgb.fit(x_train , y_train)","39284acf":"y_pred_xgb = xgb_model.predict(x_test)\naccuracy_score(y_test, y_pred_xgb)","18814dae":"#xgb_params = {\"n_estimators\": [100 , 500 , 1000] ,\"subsample\": [0.6 , 0.8 , 1.0] ,\"learning_rate\": [0.1 , 0.01 , 0.05]}\n\n#xgb_cv_model = GridSearchCV(xgb , xgb_params , cv = 10 , n_jobs = -1 , verbose = 2)\n\n#xgb_cv_model.fit(x_train, y_train)","fb47fc3e":"#print(\"Best Parameters: \" + str(xgb_cv_model.best_params_))","abf24659":"xgb = XGBClassifier(n_estimators = 1000 , learning_rate = 0.1 , subsample = 1 , max_depth = 4)\nopt_xgb =  xgb.fit(x_train,y_train)","d8601454":"y_pred_xgb = opt_xgb.predict(x_test)\naccuracy_score(y_test , y_pred_xgb)","878d70f5":"print(classification_report(y_test , y_pred_xgb))","3d65bfd5":"score = round(accuracy_score(y_test, y_pred_xgb), 6)\ncm = confusion_matrix(y_test, y_pred_xgb)\nsns.heatmap(cm, annot = True, fmt = \".0f\")\nplt.xlabel(\"Predicted Values\")\nplt.ylabel(\"Actual Values\")\nplt.title(\"Accuracy Score: {0}\".format(score), size = 15)\nplt.show()","8f7d2a4e":"models = [opt_knn , log_model , nb_model , opt_gbm , opt_svc, opt_mlpc , clf_model , opt_lgbm , opt_rf , opt_xgb]\nresult = []\nresults = pd.DataFrame(columns= [\"Models\",\"Accuracy\"])\nfor x in models:\n    names = x.__class__.__name__\n    y_pred = x.predict(x_test)\n    accuracy = accuracy_score(y_test, y_pred)\n    print(\"-\" * 28)\n    print(names + \":\" )\n    print(\"Accuracy: {:.4%}\".format(accuracy))\nfor x in models:\n    names = x.__class__.__name__\n    y_preds = x.predict(x_test)\n    accuracy = accuracy_score(y_test, y_preds)    \n    result = pd.DataFrame([[names, accuracy * 100]], columns= [\"Models\",\"Accuracy\"])\n    results = results.append(result)\n    \nsns.barplot(x = \"Accuracy\", y = \"Models\", data = results, color = \"g\")\nplt.xlabel(\"Accuracy %\");","99ddfb6e":"#### OPTIMIZATION","9000b37c":"![](http:\/\/www.linkpicture.com\/q\/Sunu1_3.jpg)","512cfe82":"#### Volatile acidity","078ba401":"Now, we need a function that will help us with the modeling.\n\nThe quality variable is 6 categories, we'll transform it to 2. ( 0 and 1 )","92768118":"Now, we will look at the distribution and skewness and kurtosis value of all variables.\n\nWe will test the normality distribution with the Shapiro-Wilk test.","89fe4c8e":"**Optimized Model**","6e2d9bb2":"#### Chlorides","ffad8bec":"#### Sulphates","57ab1626":"**Optimized Model**","2667de49":"#### OPTIMIZATION","037352f2":"So, what is this table ? Let's explain.\n\nFor all models, you can evaluate it this way.","b4e1d9a3":"**Optimized Model**","94f2aa00":"## Introduction\nThis datasets is related to red variants of the Portuguese \u201cVinho Verde\u201d wine. Due to privacy and logistic issues, only physicochemical (inputs) and sensory (the output) variables are available (e.g. there is no data about grape types, wine brand, wine selling price, etc.)\n\n**What you can find on this notebook?**\n* Understanding the data\n* Exploratory Data Analysis\n* Normal distribution control\n* Unbalanced Data problem\n* Classification Models\n* Classification Models Optimization\n* Model Select","74f2675b":"Best accuracy **%** **91.875** : **Random Forest Classifier**\n\nHope you found this notebook useful! \nPlease leave in comments in case of any questions, concerns, and feedback! Thank you :)\n\n**Thanks for attention !**","6973956b":"#### XGBoost","5b626221":"#### Random Forest Classifier","0c812436":"#### OPTIMIZATION","932a71aa":"**If you like this notebook,dont forget to upvote :) Thanks !**\n\n**We are ready to start. Cheers !**","bd721047":"#### SVC (Support Vector Classifier)","54396b98":"#### MLP Classifier (Multi-Layer Perceptron Classifier)","f71377ab":"Let's analyze the correlation","65f7c526":"#### MODEL SELECT ","4f62e66d":"#### **Shapiro-Wilk Test :**\nTests whether a data sample has a Normal distribution.\n\n**Assumption** : Observations in each sample are independent and distributed identically.\n\n**Hypothesis** : \n\n**H0**: the sample has a Normal distribution.\n\n**H1**: the sample does not have a Normal distribution.\n\nIf pvalue is less than 0.05, there is no normal distribution","de928843":"#### OPTIMIZATION","646bfa6f":"#### Light GBM Classifier","d9b9bcb7":"#### **Unbalanced Data Problem**\nUnbalanced data refers to classification problems where we have unequal instances for different classes. Having unbalanced data is actually very common in general, but it is especially prevalent when working with disease data where we usually have more healthy control samples than disease cases. Even more extreme unbalance is seen with fraud detection, where e.g. most credit card uses are okay and only very few will be fraudulent.\n\nMost machine learning classification algorithms are sensitive to unbalance in the predictor classes. Let\u2019s consider an even more extreme example than our red wine dataset: assume we had 10 good quality vs 90 bad quality samples. A machine learning model that has been trained and tested on such a dataset could now predict \u201cbad quality\u201d for all samples and still gain a very high accuracy. An unbalanced dataset will bias the prediction model towards the more common class!\n\n**Solutions**\n\n* **Find extra data**  : The number of observations in a class with few observations can be increased.\n* **Undersampling**   : Undersampling refers to a group of techniques designed to balance the class distribution for a classification dataset that has a skewed class distribution.\n* **Oversampling**    : I think undersampling should be preferred if it can't be done.It's very likely to cause overfit.\n* **Resampling : SMOTE**  : It does not act as a classic data copy. Copying data does not give new information to the model.It uses KNN algorithm. It selects random data from a minority category selects their neighbors, and generates data. This process repeats until the majority reaches the number of observations in the category. \n\n**I used SMOTE in this notebook. You can also find different methods for the unbalanced data problem.**","4a381c6d":"#### OPTIMIZATION","f533e6dc":"#### Alcohol","37bce633":"#### Density","417aa152":"#### Total sulfur dioxide","7db2e2a1":"#### KNN Classifier (K-Nearest Neighbors Algorithm)","6a9c88ef":"#### OPTIMIZATION","925b7202":"#### GBM (Gradient Boosting Machine)","04334132":"Any missing values in dataset?","ad05556a":"#### pH","a0d04b89":"#### READY FOR ML !\n\n![](http:\/\/media4.giphy.com\/media\/8Iv5lqKwKsZ2g\/giphy.gif)","b814ba04":"Let's look at the distribution of variables with the target variable using the boxplot graph.","4f470438":"#### Fixed acidity","9e4b5913":"**Information about Red Wine :**\n\nStarting with the basics, red wine is an alcoholic beverage made by fermenting the juice of dark-skinned grapes. Red wine differs from white wine in its base material and production process. Red wine is made with dark-skinned rather than light-skinned grapes. During red wine production, the winemaker allows pressed grape juice, called must, to macerate and ferment with the dark grape skins, which adds color, flavor and tannin to the wine. Alcohol occurs when yeast converts grape sugar into ethanol and carbon dioxide. The result of these processes: Red wine.\n\nReferences : www.winemag.com\n\n\n![](http:\/\/media0.giphy.com\/media\/RNDV3Y4K0g19YY5EWd\/giphy.gif)","8270ab13":"**Optimized Model**","de2a2a20":"I think we're ready, but we have a problem. Unbalanced data !","ccbf6aa2":"#### Logistic Regression","144a7b2e":"We need to standardize our independent variables. ","087a8134":"#### Citric acid","bcf04e4c":"#### Desicion Tree Classifier","12c45353":"**Optimized Model**","523f5ef0":"**What are our variables? Let's meet**\n\n* **Fixed acidity** :  Most acids involved with wine or fixed or nonvolatile.(do not evaporate readily)\n* **Volatile acidity** : The amount of acetic acid in wine, which at too high of levels can lead to an unpleasant, vinegar taste.\n* **Citric acid** :  Found in small quantities, citric acid can add 'freshness' and flavor to wines.\n* **Residual sugar** :  The amount of sugar remaining after fermentation stops, it\u2019s rare to find wines with less than 1 gram\/liter and wines with greater than 45 grams\/liter are considered sweet.\n* **Chlorides** :  The amount of salt in the wine.\n* **Free sulfur dioxide** :  The free form of SO2 exists in equilibrium between molecular SO2 (as a dissolved gas) and bisulfite ion; it prevents microbial growth and the oxidation of wine.\n* **Total sulfur dioxide** :  Amount of free and bound forms of S02; in low concentrations, SO2 is mostly undetectable in wine, but at free SO2 concentrations over 50 ppm, SO2 becomes evident in the nose and taste of wine.\n* **Density** :  The density of water is close to that of water depending on the percent alcohol and sugar content.\n* **pH** :  Describes how acidic or basic a wine is on a scale from 0 (very acidic) to 14 (very basic); most wines are between 3-4 on the pH scale.\n* **Sulphates** :  A wine additive which can contribute to sulfur dioxide gas (S02) levels, wich acts as an antimicrobial and antioxidant\n* **Alcohol** :  The percent alcohol content of the wine.\n\n**Target Variable : Quality** : Based on sensory data, score between 3 and 8\n","15be904e":"**Optimized Model**","514f73d5":"#### OPTIMIZATION","3f9137d9":"Highest **positive** correlation : alcohol (0.48) **Moderate degree**\n\nHighest **negative** correlation : volatile acidity(-0.39) **Moderate degree**","c2448e27":"#### Residual sugar","16593fee":"**Optimized Model**","424e8a55":"#### Naive Bayes","1d2700ee":"#### Free sulfur dioxide","7c732da1":"#### **CONCLUSION**","e4bd6cd8":"# Red Wine Quality Classification - Optimized Models\n\n\n**Bugra Sebati E.** - **August 2021**","397efcf3":"Now, let's look at the distribution of the target variable"}}