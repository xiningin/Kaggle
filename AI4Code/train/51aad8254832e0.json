{"cell_type":{"e63bb23b":"code","00093797":"code","62b4f463":"code","000d7a74":"code","63144267":"code","0325e312":"code","fe78fbb8":"code","933029c7":"code","955701a7":"code","c89f12c8":"code","034a7fb9":"code","4dc36a46":"code","c177f10d":"markdown"},"source":{"e63bb23b":"!pip install scikit-learn-intelex -q --progress-bar off\nfrom sklearnex import patch_sklearn\npatch_sklearn()","00093797":"import pandas as pd\n\ndf = pd.read_json('https:\/\/github.com\/lahdjirayhan\/svm-dhany\/blob\/master\/preprocessed_data.json?raw=true', lines = True)\ndf.head()","62b4f463":"def collapse_list_to_string(lst):\n    output = \" \".join(lst)\n    return output\n\ndf.loc[:, \"ready\"] = df.list_clean.apply(collapse_list_to_string)\ndf.head()","000d7a74":"df_ready = df[df['label'] != 'neutral'][['ready', 'label']]\ndf_ready.shape","63144267":"def classify_sentiment(s):\n    if s ==\"positive\":\n        return 1\n    else:\n        return 0\n\ndf_ready.loc[:, \"label\"] = df_ready.label.apply(classify_sentiment)","0325e312":"from sklearn.feature_extraction.text import TfidfVectorizer\nfrom sklearn.svm import SVC\nfrom sklearn.naive_bayes import MultinomialNB\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.model_selection import train_test_split, GridSearchCV","fe78fbb8":"# pipeline untuk SVM RBF\nsvm_rbf_pipeline = Pipeline([\n    ('FE', TfidfVectorizer()),     # Feature extractor\n    ('CLF', SVC())                 # Clasifier, Support Vector Classifier\n])\n\n# Hal-hal yang ingin di-tuning\/diketahui perbedaannya terhadap akurasi\/evaluasi model\nsvm_rbf_hyperparameters = {\n    \n        \"CLF__kernel\": [\"rbf\"],\n        \n        \"FE__ngram_range\": [(1,1), (2,2), (3,3), (1,3)],\n        \"CLF__C\": [0.1],\n        \"CLF__gamma\": [2**-11, 2**-9, 2**-7, 2**-5, 2**-3]\n    }\n\nscores = ['accuracy', 'precision', 'recall', 'f1']","933029c7":"tweet_training, tweet_testing, label_training, label_testing = train_test_split(\n    df_ready['ready'], df_ready['label'],\n    test_size = 0.2,\n    random_state = 42   # seperti set.seed\n)","955701a7":"svm_rbf_grid_search = GridSearchCV(\n    svm_rbf_pipeline, svm_rbf_hyperparameters,\n    cv = 5, verbose = 3, refit = False, scoring = scores, return_train_score = True\n)","c89f12c8":"svm_rbf_grid_search.fit(tweet_training, label_training)","034a7fb9":"svm_rbf_grid_search.cv_results_","4dc36a46":"# mendefinisikan hasil evaluasi ketepatan klasifikasi dengan tuning parameter\ndef print_results_from_cv(cv):\n    for i, param in enumerate(cv[\"params\"]):\n        print(\"PARAMETER COMBINATION:\", param)\n        print()\n        print(\"Training accuracy:\", cv['mean_train_accuracy'][i])\n        print(\"Training precision:\", cv['mean_train_precision'][i])\n        print(\"Training recall:\", cv['mean_train_recall'][i])\n        print(\"Training F1:\", cv['mean_train_f1'][i])\n        print()\n        print(\"Test accuracy:\", cv['mean_test_accuracy'][i])\n        print(\"Test precision:\", cv['mean_test_precision'][i])\n        print(\"Test recall:\", cv['mean_test_recall'][i])\n        print(\"Test F1:\", cv['mean_test_f1'][i])\n        print(\"=====================================================\")\n\n# Print hasil akurasi model SVM kernel RBF dengan berbagai kombinasi n-grams , gamma dan C\nprint_results_from_cv(svm_rbf_grid_search.cv_results_)","c177f10d":"I want to show you how to get results faster without changing the code. To do this, we will use another Python library,\u202f**[scikit-learn-intelex](https:\/\/github.com\/intel\/scikit-learn-intelex)**. It accelerates scikit-learn and does not require you changing the code written for scikit-learn."}}