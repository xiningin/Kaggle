{"cell_type":{"b52a92f7":"code","66e40b22":"code","c1b79ecd":"code","bdb63cb3":"code","f7da45f4":"code","5cbf2877":"code","29c3013b":"code","f6d9933f":"code","56b348f7":"code","9eb48823":"code","672d6d5d":"code","4cb87ef4":"code","feefa3bc":"code","fadd7798":"code","8868a74a":"code","d129ccd8":"code","c655f7e8":"code","afceaa1f":"code","cec5d260":"code","add0ec6a":"code","e585e706":"code","3120fc6c":"code","452a9ce7":"code","00bb9f71":"code","19efe79f":"code","b835136a":"code","17e76a32":"code","46b500fc":"code","4c49cdbe":"code","7b511bf1":"code","897c6e4f":"code","693ea58f":"code","0ba81a2e":"code","f619cd6c":"code","8c92b011":"code","c843c6e4":"code","f8ef1491":"code","33988986":"code","86f0fa78":"code","6d6f386d":"code","1d5df42c":"code","3bd65bbc":"code","0c152bdb":"code","e80e1bf3":"code","857cccc7":"code","9b4869ca":"code","60d557cc":"code","153bbdc5":"code","bf348113":"code","a42fa067":"code","569cd359":"code","954d3286":"code","d853a63b":"code","1d0baeec":"code","ab9148fc":"code","3d8f132c":"code","bba6ee7e":"code","8256c9af":"code","2d5fcc83":"code","5920ecf2":"code","6c28efd9":"code","ffa6db0d":"code","d512f0ed":"code","c936aa3e":"code","8de7d29b":"code","0223645c":"code","a5b8ecba":"code","d7e06459":"code","dda7eac8":"code","b39688b1":"code","50d3b8c7":"code","721c9c4e":"code","8cf6f730":"code","81e9851b":"code","5ec23946":"code","25aca5ef":"code","e6b48b54":"code","5646ee8f":"code","08a72a8a":"code","79249004":"code","c9c16b38":"code","4d6104e8":"code","a7c18ed0":"code","ad6fb477":"code","252bd1b4":"code","2c1ccced":"code","b06a2876":"code","9089352c":"code","5d432032":"code","8c98559d":"code","466e5a51":"code","bee59211":"code","59a51ff0":"code","e50aae71":"code","fd172c15":"markdown"},"source":{"b52a92f7":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","66e40b22":"df=pd.read_csv('..\/input\/house-prices-advanced-regression-techniques\/train.csv')","c1b79ecd":"df.head()","bdb63cb3":"df['MSZoning'].value_counts()","f7da45f4":"sns.heatmap(df.isnull(),yticklabels=False,cbar=False)","5cbf2877":"## Fill Missing Values\n\ndf['LotFrontage']=df['LotFrontage'].fillna(df['LotFrontage'].mean())","29c3013b":"df.drop(['Alley'],axis=1,inplace=True)","f6d9933f":"df['BsmtCond']=df['BsmtCond'].fillna(df['BsmtCond'].mode()[0])\ndf['BsmtQual']=df['BsmtQual'].fillna(df['BsmtQual'].mode()[0])","56b348f7":"df['FireplaceQu']=df['FireplaceQu'].fillna(df['FireplaceQu'].mode()[0])\ndf['GarageType']=df['GarageType'].fillna(df['GarageType'].mode()[0])","9eb48823":"df.drop(['GarageYrBlt'],axis=1,inplace=True)","672d6d5d":"df['GarageFinish']=df['GarageFinish'].fillna(df['GarageFinish'].mode()[0])\ndf['GarageQual']=df['GarageQual'].fillna(df['GarageQual'].mode()[0])\ndf['GarageCond']=df['GarageCond'].fillna(df['GarageCond'].mode()[0])","4cb87ef4":"df.drop(['PoolQC','Fence','MiscFeature'],axis=1,inplace=True)","feefa3bc":"df.shape","fadd7798":"df.drop(['Id'],axis=1,inplace=True)","8868a74a":"df.isnull().sum()","d129ccd8":"df['MasVnrType']=df['MasVnrType'].fillna(df['MasVnrType'].mode()[0])\ndf['MasVnrArea']=df['MasVnrArea'].fillna(df['MasVnrArea'].mode()[0])","c655f7e8":"sns.heatmap(df.isnull(),yticklabels=False,cbar=False,cmap='coolwarm')","afceaa1f":"df['BsmtExposure']=df['BsmtExposure'].fillna(df['BsmtExposure'].mode()[0])","cec5d260":"sns.heatmap(df.isnull(),yticklabels=False,cbar=False,cmap='YlGnBu')","add0ec6a":"df['BsmtFinType2']=df['BsmtFinType2'].fillna(df['BsmtFinType2'].mode()[0])","e585e706":"df.dropna(inplace=True)","3120fc6c":"df.shape","452a9ce7":"columns=['MSZoning','Street','LotShape','LandContour','Utilities','LotConfig','LandSlope','Neighborhood',\n         'Condition2','BldgType','Condition1','HouseStyle','SaleType',\n        'SaleCondition','ExterCond',\n         'ExterQual','Foundation','BsmtQual','BsmtCond','BsmtExposure','BsmtFinType1','BsmtFinType2',\n        'RoofStyle','RoofMatl','Exterior1st','Exterior2nd','MasVnrType','Heating','HeatingQC',\n         'CentralAir',\n         'Electrical','KitchenQual','Functional',\n         'FireplaceQu','GarageType','GarageFinish','GarageQual','GarageCond','PavedDrive']","00bb9f71":"len(columns)","19efe79f":"def category_onehot_multcols(multcolumns):\n    df_final=final_df\n    i=0\n    for fields in multcolumns:\n        \n        print(fields)\n        df1=pd.get_dummies(final_df[fields],drop_first=True)\n        \n        final_df.drop([fields],axis=1,inplace=True)\n        if i==0:\n            df_final=df1.copy()\n        else:\n            \n            df_final=pd.concat([df_final,df1],axis=1)\n        i=i+1\n       \n        \n    df_final=pd.concat([final_df,df_final],axis=1)\n        \n    return df_final","b835136a":"main_df=df.copy()","17e76a32":"test_df=pd.read_csv('..\/input\/house-prices-advanced-regression-techniques\/test.csv')","46b500fc":"    test_df.shape","4c49cdbe":"test_df['LotFrontage']=test_df['LotFrontage'].fillna(test_df['LotFrontage'].mean())","7b511bf1":"test_df['MSZoning']=test_df['MSZoning'].fillna(test_df['MSZoning'].mode()[0])","897c6e4f":"test_df.shape","693ea58f":"test_df.drop(['Alley'],axis=1,inplace=True)","0ba81a2e":"test_df.shape","f619cd6c":"test_df['BsmtCond']=test_df['BsmtCond'].fillna(test_df['BsmtCond'].mode()[0])\ntest_df['BsmtQual']=test_df['BsmtQual'].fillna(test_df['BsmtQual'].mode()[0])","8c92b011":"test_df['FireplaceQu']=test_df['FireplaceQu'].fillna(test_df['FireplaceQu'].mode()[0])\ntest_df['GarageType']=test_df['GarageType'].fillna(test_df['GarageType'].mode()[0])","c843c6e4":"test_df.drop(['GarageYrBlt'],axis=1,inplace=True)","f8ef1491":"test_df['GarageFinish']=test_df['GarageFinish'].fillna(test_df['GarageFinish'].mode()[0])\ntest_df['GarageQual']=test_df['GarageQual'].fillna(test_df['GarageQual'].mode()[0])\ntest_df['GarageCond']=test_df['GarageCond'].fillna(test_df['GarageCond'].mode()[0])\n\ntest_df.drop(['PoolQC','Fence','MiscFeature'],axis=1,inplace=True)","33988986":"test_df['MasVnrType']=test_df['MasVnrType'].fillna(test_df['MasVnrType'].mode()[0])\ntest_df['MasVnrArea']=test_df['MasVnrArea'].fillna(test_df['MasVnrArea'].mode()[0])","86f0fa78":"sns.heatmap(test_df.isnull(),yticklabels=False,cbar=False,cmap='viridis')","6d6f386d":"test_df['BsmtExposure']=test_df['BsmtExposure'].fillna(test_df['BsmtExposure'].mode()[0])","1d5df42c":"sns.heatmap(test_df.isnull(),yticklabels=False,cbar=False,cmap='viridis')","3bd65bbc":"test_df['BsmtFinType2']=test_df['BsmtFinType2'].fillna(test_df['BsmtFinType2'].mode()[0])","0c152bdb":"test_df.loc[:, test_df.isnull().any()].head()","e80e1bf3":"test_df['Utilities']=test_df['Utilities'].fillna(test_df['Utilities'].mode()[0])\ntest_df['Exterior1st']=test_df['Exterior1st'].fillna(test_df['Exterior1st'].mode()[0])\ntest_df['Exterior2nd']=test_df['Exterior2nd'].fillna(test_df['Exterior2nd'].mode()[0])\ntest_df['BsmtFinType1']=test_df['BsmtFinType1'].fillna(test_df['BsmtFinType1'].mode()[0])\ntest_df['BsmtFinSF1']=test_df['BsmtFinSF1'].fillna(test_df['BsmtFinSF1'].mean())\ntest_df['BsmtFinSF2']=test_df['BsmtFinSF2'].fillna(test_df['BsmtFinSF2'].mean())\ntest_df['BsmtUnfSF']=test_df['BsmtUnfSF'].fillna(test_df['BsmtUnfSF'].mean())\ntest_df['TotalBsmtSF']=test_df['TotalBsmtSF'].fillna(test_df['TotalBsmtSF'].mean())\ntest_df['BsmtFullBath']=test_df['BsmtFullBath'].fillna(test_df['BsmtFullBath'].mode()[0])\ntest_df['BsmtHalfBath']=test_df['BsmtHalfBath'].fillna(test_df['BsmtHalfBath'].mode()[0])\ntest_df['KitchenQual']=test_df['KitchenQual'].fillna(test_df['KitchenQual'].mode()[0])\ntest_df['Functional']=test_df['Functional'].fillna(test_df['Functional'].mode()[0])\ntest_df['GarageCars']=test_df['GarageCars'].fillna(test_df['GarageCars'].mean())\ntest_df['GarageArea']=test_df['GarageArea'].fillna(test_df['GarageArea'].mean())\ntest_df['SaleType']=test_df['SaleType'].fillna(test_df['SaleType'].mode()[0])","857cccc7":"test_df.to_csv('formulatedtest.csv',index=False)","9b4869ca":"test_df=pd.read_csv('.\/formulatedtest.csv')","60d557cc":"test_df.shape","153bbdc5":"test_df.head()","bf348113":"test_df.drop('Id', axis=1, inplace=True)","a42fa067":"final_df=pd.concat([df,test_df],axis=0)","569cd359":"final_df=category_onehot_multcols(columns)","954d3286":"final_df.shape","d853a63b":"df_Train=final_df.iloc[:1422,:]\ndf_Test=final_df.iloc[1422:,:]","1d0baeec":"df_Train.head()","ab9148fc":"df_Test.head()","3d8f132c":"df_Train.shape","bba6ee7e":"df_Test.drop(['SalePrice'],axis=1,inplace=True)","8256c9af":"X_train=df_Train.drop(['SalePrice'],axis=1)\ny_train=df_Train['SalePrice']","2d5fcc83":"import xgboost\nclassifier=xgboost.XGBRegressor()","5920ecf2":"from sklearn.model_selection import RandomizedSearchCV","6c28efd9":"import xgboost\nregressor=xgboost.XGBRegressor()\n","ffa6db0d":"booster=['gbtree','gblinear']\nbase_score=[0.25,0.5,0.75,1]","d512f0ed":"## Hyper Parameter Optimization\n\n\nn_estimators = [100, 500, 900, 1100, 1500]\nmax_depth = [2, 3, 5, 10, 15]\nbooster=['gbtree','gblinear']\nlearning_rate=[0.05,0.1,0.15,0.20]\nmin_child_weight=[1,2,3,4]\n\n# Define the grid of hyperparameters to search\nhyperparameter_grid = {\n    'n_estimators': n_estimators,\n    'max_depth':max_depth,\n    'learning_rate':learning_rate,\n    'min_child_weight':min_child_weight,\n    'booster':booster,\n    'base_score':base_score\n    }","c936aa3e":"# Set up the random search with 4-fold cross validation\nrandom_cv = RandomizedSearchCV(estimator=regressor,\n            param_distributions=hyperparameter_grid,\n            cv=5, n_iter=50,\n            scoring = 'neg_mean_absolute_error',n_jobs = 4,\n            verbose = 5, \n            return_train_score = True,\n            random_state=42)","8de7d29b":"random_cv.fit(X_train,y_train)","0223645c":"random_cv.best_estimator_","a5b8ecba":"random_cv.best_estimator_","d7e06459":"regressor=xgboost.XGBRegressor(base_score=0.25, booster='gbtree', colsample_bylevel=1,\n       colsample_bytree=1, gamma=0, learning_rate=0.1, max_delta_step=0,\n       max_depth=2, min_child_weight=1, missing=None, n_estimators=900,\n       n_jobs=1, nthread=None, objective='reg:linear', random_state=0,\n       reg_alpha=0, reg_lambda=1, scale_pos_weight=1, seed=None,\n       silent=True, subsample=1)","dda7eac8":"regressor.fit(X_train,y_train)","b39688b1":"import pickle\nfilename = 'finalized_model.pkl'\npickle.dump(classifier, open(filename, 'wb'))","50d3b8c7":"df_Test.shape","721c9c4e":"y_pred=regressor.predict(df_Test)","8cf6f730":"y_pred","81e9851b":"#Training","5ec23946":"import keras\nfrom keras.models import Sequential\nfrom keras.layers import Dense\nfrom keras.layers import LeakyReLU,PReLU,ELU\nfrom keras.layers import Dropout","25aca5ef":"# Initialising the ANN\nclassifier = Sequential()","e6b48b54":"# Adding the input layer and the first hidden layer\nclassifier.add(Dense(units = 50, activation='relu',input_dim = 174))","5646ee8f":"classifier.add(Dense(units = 25, activation='relu'))","08a72a8a":"classifier.add(Dense(units= 50, activation='relu'))","79249004":"classifier.add(Dense(units = 1))","c9c16b38":"from keras import backend as K\ndef root_mean_squared_error(y_true, y_pred):\n        return K.sqrt(K.mean(K.square(y_pred - y_true))) \nclassifier.compile(loss=root_mean_squared_error, optimizer='Adamax')","4d6104e8":"model_history=classifier.fit(X_train.values, y_train.values,validation_split=0.20, batch_size = 10, epochs = 1000)","a7c18ed0":"ann_pred=classifier.predict(df_Test.values)","ad6fb477":"##Create Sample Submission file and Submit using ANN\npred=pd.DataFrame(ann_pred)\nsub_df=pd.read_csv('..\/input\/house-prices-advanced-regression-techniques\/sample_submission.csv')\ndatasets=pd.concat([sub_df['Id'],pred],axis=1)\ndatasets.columns=['Id','SalePrice']\ndatasets.to_csv('sample_submission.csv',index=False)","252bd1b4":"pred.columns=['SalePrice']","2c1ccced":"temp_df=df_Train['SalePrice'].copy()","b06a2876":"temp_df.column=['SalePrice']","9089352c":"df_Train.drop(['SalePrice'],axis=1,inplace=True)","5d432032":"df_Train=pd.concat([df_Train,temp_df],axis=1)","8c98559d":"df_Test.head()","466e5a51":"df_Test=pd.concat([df_Test,pred],axis=1)","bee59211":"df_Train=pd.concat([df_Train,df_Test],axis=0)","59a51ff0":"df_Train.shape","e50aae71":"X_train=df_Train.drop(['SalePrice'],axis=1)\ny_train=df_Train['SalePrice']","fd172c15":" # **Predicting Algorithm**"}}