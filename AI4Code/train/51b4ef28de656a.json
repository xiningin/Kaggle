{"cell_type":{"962f54cd":"code","ef0e9d49":"code","678f621c":"code","47fd0b64":"code","e8029091":"code","f6535c00":"code","cb558168":"code","9a55d144":"code","3fa9c7d5":"code","ae5c64f7":"code","003ac694":"code","674a14d3":"code","3acd2a77":"code","4e67f8c3":"code","75f91ada":"code","d1d7e60b":"code","7392b92b":"code","5156996f":"code","e265c4e5":"code","e2ca8e2b":"code","67a3839a":"code","c53ba856":"code","0a2c5b80":"code","6ef1800c":"code","3468a952":"code","82fd9b44":"markdown","bd0a3435":"markdown"},"source":{"962f54cd":"import numpy as np\nimport pandas as pd","ef0e9d49":"%run ..\/input\/scriptspaw\/rapids_svr_boost_17_8.py","678f621c":"%run ..\/input\/scriptspaw\/tez_pawpular_tuning.py","47fd0b64":"swin = np.load('swin.npy')\nsvr = np.load('rapids_svr.npy')","e8029091":"import sys\nsys.path.append('..\/input\/timm-pytorch-image-models\/pytorch-image-models-master')\nfrom timm import create_model\nfrom fastai.vision.all import *\n","f6535c00":"set_seed(999, reproducible=True)\nBATCH_SIZE = 32\ndataset_path = Path('..\/input\/petfinder-pawpularity-score\/')\ndataset_path.ls()\ntrain_df = pd.read_csv(dataset_path\/'train.csv')\ntrain_df.head()","cb558168":"train_df['path'] = train_df['Id'].map(lambda x:str(dataset_path\/'train'\/x)+'.jpg')\ntrain_df = train_df.drop(columns=['Id'])\ntrain_df = train_df.sample(frac=1).reset_index(drop=True) #shuffle dataframe\ntrain_df.head()","9a55d144":"len_df = len(train_df)\nprint(f\"There are {len_df} images\")","3fa9c7d5":"train_df['Pawpularity'].hist(figsize = (10, 5))\nprint(f\"The mean Pawpularity score is {train_df['Pawpularity'].mean()}\")\nprint(f\"The median Pawpularity score is {train_df['Pawpularity'].median()}\")\nprint(f\"The standard deviation of the Pawpularity score is {train_df['Pawpularity'].std()}\")\nprint(f\"There are {len(train_df['Pawpularity'].unique())} unique values of Pawpularity score\")","ae5c64f7":"if not os.path.exists('\/root\/.cache\/torch\/hub\/checkpoints\/'):\n    os.makedirs('\/root\/.cache\/torch\/hub\/checkpoints\/')\n!cp '..\/input\/swin-transformer\/swin_large_patch4_window7_224_22kto1k.pth' '\/root\/.cache\/torch\/hub\/checkpoints\/swin_large_patch4_window7_224_22kto1k.pth'","003ac694":"seed=999\nset_seed(seed, reproducible=True)\ntorch.manual_seed(seed)\ntorch.cuda.manual_seed(seed)\ntorch.backends.cudnn.deterministic = True\ntorch.use_deterministic_algorithms = True","674a14d3":"#learn = load_learner('..\/input\/swin-paw\/models\/model_fold_9.pkl.pth', cpu=False)","3acd2a77":"#learn","4e67f8c3":"data=pd.read_csv('..\/input\/swin-paw\/submission.csv')","75f91ada":"data","d1d7e60b":"data_2=pd.read_csv('..\/input\/ensemble-2\/submission.csv')","7392b92b":"type(data_2.loc[0,'Pawpularity'])","5156996f":"pred1=data['Pawpularity'].to_numpy(dtype='float64')","e265c4e5":"pred_2=data_2['Pawpularity'].to_numpy(dtype='float64')","e2ca8e2b":"pred_2","67a3839a":"type(pred1[0])","c53ba856":"score = (swin+svr+pred1+pred_2)\/4","0a2c5b80":"test = pd.read_csv('..\/input\/petfinder-pawpularity-score\/test.csv')\n\ntest['Pawpularity'] = score\ntest[['Id', 'Pawpularity']].to_csv('submission.csv', index=False)","6ef1800c":"test","3468a952":"test[['Id', 'Pawpularity']].head()","82fd9b44":"## Ensembling best 2 models:\n\nThanks to [Abhishek Thakur](https:\/\/www.kaggle.com\/abhishek) and [Chris Deotte](https:\/\/www.kaggle.com\/cdeotte) for their great notebooks. Much to learn from the 4x Grandmasters. \nI have ensembled their best public models here.\n\n#### Links to the original notebooks:\n\n<ul>\n    <li> <a href=\"https:\/\/www.kaggle.com\/cdeotte\/rapids-svr-boost-17-8\">RAPIDS SVR Boost - [17.8]<\/a><\/li>\n    <li> <a href=\"https:\/\/www.kaggle.com\/abhishek\/tez-pawpular-swin-ference\">tez: pawpular swin-ference<\/a><\/li>\n<\/ul>","bd0a3435":"#### END"}}