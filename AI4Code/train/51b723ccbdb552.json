{"cell_type":{"cb124b0a":"code","27db0c09":"code","1ad4f73f":"code","2fcc5bff":"code","c9bbd1e1":"code","bb3414d9":"code","8b4de600":"code","f30e8947":"code","fac4fb43":"code","f6402b3e":"code","9829976e":"code","5eceb958":"code","064d955b":"code","d1daabee":"code","bce16d64":"code","9f0df68c":"code","1e0aa43c":"code","979210e8":"code","07495ece":"code","828d001e":"code","0cd74a03":"code","bec71109":"code","ed1638ca":"code","49d5e8c5":"code","ba45229f":"code","a9c91f58":"code","9f173fa6":"markdown","4a95a17b":"markdown","5824b052":"markdown","73133ab0":"markdown","7ccc6a04":"markdown","8687b07c":"markdown","a1f98a9b":"markdown","74c5ac32":"markdown","28ff3ed5":"markdown","c3134330":"markdown","96a1b2dd":"markdown","b42cfbf5":"markdown","454d725e":"markdown","8d2ab032":"markdown","222d4f18":"markdown","1b4ddc43":"markdown","5d2bafc6":"markdown"},"source":{"cb124b0a":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport datatable as dt\n\nimport warnings\nwarnings.filterwarnings('ignore')","27db0c09":"df_train = dt.fread(\"..\/input\/tabular-playground-series-nov-2021\/train.csv\").to_pandas()\ndf_test = dt.fread(\"..\/input\/tabular-playground-series-nov-2021\/test.csv\").to_pandas()\ndf_subm = dt.fread(\"..\/input\/tabular-playground-series-nov-2021\/sample_submission.csv\").to_pandas()","1ad4f73f":"#Custom Color Palette \ud83c\udfa8\ncustom_colors = [\"#ffbe0b\",\"#fb5607\",\"#ff006e\",\"#8338ec\",\"#3a86ff\"]\ncustomPalette = sns.set_palette(sns.color_palette(custom_colors))\nsns.palplot(sns.color_palette(custom_colors),size = 1.2)\nplt.tick_params(axis ='both', labelsize=0, length = 0)","2fcc5bff":"df_train_row_count, df_train_column_count = df_train.shape\nprint('Total number of rows:', df_train_row_count)\nprint('Total number of columns:', df_train_column_count)","c9bbd1e1":"df_test_row_count, df_test_column_count = df_test.shape\nprint('Total number of rows:', df_test_row_count)\nprint('Total number of columns:', df_test_column_count)","bb3414d9":"df_train.head()","8b4de600":"df_train.describe().T","f30e8947":"df_train.info()","fac4fb43":"df_test.describe().T","f6402b3e":"df_train.isna().sum()","9829976e":"df_test.isna().sum()","5eceb958":"print (\"Unique values are:\\n\",df_train.nunique())","064d955b":"df_train.target.value_counts()","d1daabee":"x = df_train['target'].value_counts()\n\nfig,ax = plt.subplots(figsize = (7,4))\nax.barh([1],x.values[1], height = 0.7, color ='#8338ec',alpha = 0.7)\nplt.text(-43000,1, 'False', {'font': 'Trebuchet MS','weight':'bold','Size': '16','style':'normal', 'color':'black'},alpha = 0.7)\nplt.text(310000,1, '49.4%', {'font': 'Trebuchet MS','weight':'bold','Size': '16','style':'normal', 'color':'black'},alpha = 0.7)\n\nax.barh([0],x.values[0], height = 0.7, color ='#fb5607',alpha = 0.7)\nplt.text(-38000,0,'True',{'font': 'Trebuchet MS','weight':'bold','Size': '16','style':'normal', 'color':'black'}, alpha = 0.7)\nplt.text(313000,0, '50.6%',{'font': 'Trebuchet MS','weight':'bold','Size': '16','style':'normal', 'color':'black'}, alpha = 0.7)\n\n\nplt.text(-50,2.2, 'How target is distributed? - True vs False',{'font': 'Trebuchet MS','weight':'bold','Size': '24','style':'normal', 'color':'#3a86ff'}, alpha = 0.9)\nplt.text(400000,1.65, 'False ', {'font': 'Trebuchet MS','weight':'bold','Size': '16','style':'normal', 'color':'#8338ec'},alpha = 0.8)\nplt.text(445000,1.65, '|', {'font': 'Trebuchet MS','weight':'bold','Size': '16','style':'normal', 'color':'black'}, alpha = 0.9)\nplt.text(455000,1.65, 'True',  {'font': 'Trebuchet MS','weight':'bold','Size': '16','style':'normal', 'color':'#fb5607'},alpha = 0.7)\nplt.text(-50,1.8, 'Nearly equal distribution',{'font': 'Trebuchet MS','Size': '14','style':'normal', 'color':'#ff006e'})\n\nax.axes.get_xaxis().set_visible(False)\nax.axes.get_yaxis().set_visible(False)\nax.spines['bottom'].set_visible(False)\nax.spines['left'].set_visible(True)\nax.spines['right'].set_visible(False)\nax.spines['top'].set_visible(False)","bce16d64":"plt.figure(figsize = (11,11))\ncorr = df_train.corr()\nmask = np.triu(np.ones_like(corr, dtype=bool))\nsns.heatmap(corr, mask=mask, cmap=custom_colors, robust=True, center=0,square=True, linewidths =.6)\nplt.title('Correlation')\nplt.show()","9f0df68c":"corr_loss = df_train.corr()\nplt.figure(figsize=(24,8))\ncorr_loss[\"target\"][:-1].plot(kind=\"bar\",grid=True)\nplt.title(\"Features correlation\")","1e0aa43c":"cols = ['f'+str(i) for i in range(100)]\ni = 1\nplt.figure()\nfig, ax = plt.subplots(5, 4,figsize=(12, 12))\nfor feature in cols[0:20]:\n    plt.subplot(5, 4,i)\n    sns.histplot(df_train[feature],color=\"#3a86ff\", kde=True, edgecolor=\"black\")\n    sns.histplot(df_test[feature],color=\"#ffbe0b\", kde=True, edgecolor=\"black\")\n    plt.yticks([])\n    plt.legend(labels=('Train','Test'))\n    plt.tight_layout()\n    i += 1\nplt.show()","979210e8":"cols = ['f'+str(i) for i in range(100)]\ni = 1\nplt.figure()\nfig, ax = plt.subplots(5, 4,figsize=(12, 12))\nfor feature in cols[20:40]:\n    plt.subplot(5, 4,i)\n    sns.histplot(df_train[feature],color=\"#3a86ff\", kde=True, edgecolor=\"black\")\n    sns.histplot(df_test[feature],color=\"#ffbe0b\", kde=True, edgecolor=\"black\")\n    plt.yticks([])\n    plt.legend(labels=('Train','Test'))\n    plt.tight_layout()\n    i += 1\nplt.show()","07495ece":"cols = ['f'+str(i) for i in range(100)]\ni = 1\nplt.figure()\nfig, ax = plt.subplots(5, 4,figsize=(12, 12))\nfor feature in cols[40:60]:\n    plt.subplot(5, 4,i)\n    sns.histplot(df_train[feature],color=\"#3a86ff\", kde=True, edgecolor=\"black\")\n    sns.histplot(df_test[feature],color=\"#ffbe0b\", kde=True, edgecolor=\"black\")\n    plt.yticks([])\n    plt.legend(labels=('Train','Test'))\n    plt.tight_layout()\n    i += 1\nplt.show()","828d001e":"cols = ['f'+str(i) for i in range(100)]\ni = 1\nplt.figure()\nfig, ax = plt.subplots(5, 4,figsize=(12, 12))\nfor feature in cols[60:80]:\n    plt.subplot(5, 4,i)\n    sns.histplot(df_train[feature],color=\"#3a86ff\", kde=True, edgecolor=\"black\")\n    sns.histplot(df_test[feature],color=\"#ffbe0b\", kde=True, edgecolor=\"black\")\n    plt.yticks([])\n    plt.legend(labels=('Train','Test'))\n    plt.tight_layout()\n    i += 1\nplt.show()","0cd74a03":"cols = ['f'+str(i) for i in range(100)]\ni = 1\nplt.figure()\nfig, ax = plt.subplots(5, 4,figsize=(12, 12))\nfor feature in cols[80:100]:\n    plt.subplot(5, 4,i)\n    sns.histplot(df_train[feature],color=\"#3a86ff\", kde=True, edgecolor=\"black\")\n    sns.histplot(df_test[feature],color=\"#ffbe0b\", kde=True, edgecolor=\"black\")\n    plt.yticks([])\n    plt.legend(labels=('Train','Test'))\n    plt.tight_layout()\n    i += 1\nplt.show()","bec71109":"!pip install -U lightautoml","ed1638ca":"from lightautoml.automl.presets.tabular_presets import TabularAutoML, TabularUtilizedAutoML\nfrom lightautoml.tasks import Task\nfrom lightautoml.report.report_deco import ReportDeco","49d5e8c5":"automl = TabularAutoML(task = Task('binary', metric ='auc'), timeout = 7200, reader_params = {'cv': 10, 'random_state': 42})\npred = automl.fit_predict(df_train, roles = {'target': 'target'})","ba45229f":"pred = automl.predict(df_test)","a9c91f58":"df_subm['target'] = pred.data[:, -1]\ndf_subm.to_csv(\"submission_lightautoml.csv\", index=False)\ndf_subm.head()","9f173fa6":"<h3 style=\"font-family: Trebuchet MS;background-color:#eae4e9;color:#3a0ca3;text-align: center;padding-top: 5px;padding-bottom: 5px;border-radius: 15px 50px;letter-spacing: 2px;\"><strong><centre>Features (f60 - f79) <\/centre><\/strong><\/h3>","4a95a17b":"<h3 style=\"font-family: Trebuchet MS;background-color:#eae4e9;color:#3a0ca3;text-align: center;padding-top: 5px;padding-bottom: 5px;border-radius: 15px 50px;letter-spacing: 2px;\"><strong><centre>Importing & Reading the dataset \ud83d\udcdd <\/centre><\/strong><\/h3>","5824b052":"<h3 style=\"font-family: Trebuchet MS;background-color:#eae4e9;color:#3a0ca3;text-align: center;padding-top: 5px;padding-bottom: 5px;border-radius: 15px 50px;letter-spacing: 2px;\"><strong><centre>Checking for missing values \u270f\ufe0f <\/centre><\/strong><\/h3>","73133ab0":"<h3 style=\"font-family: Trebuchet MS;background-color:#eae4e9;color:#3a0ca3;text-align: center;padding-top: 5px;padding-bottom: 5px;border-radius: 15px 50px;letter-spacing: 2px;\"><strong><centre>Features (f0 - f19) <\/centre><\/strong><\/h3>","7ccc6a04":"<p style=\"font-family: Trebuchet MS; line-height: 2; font-size: 20px; font-weight: bold; letter-spacing: 2px; text-align: center; color: #3a0ca3\">Features Distribution<\/p>","8687b07c":"<h3 style=\"font-family: Trebuchet MS;background-color:#eae4e9;color:#3a0ca3;text-align: center;padding-top: 5px;padding-bottom: 5px;border-radius: 15px 50px;letter-spacing: 2px;\"><strong><centre>LightAutoML \u23f3<\/centre><\/strong><\/h3>","a1f98a9b":"Distribution of all features (f0-f99) that are available in train and test dataset are shown below. Because there are 100 features (f0-f99), 20 features are represented in each sections.`Blue` represents train dataset while `yellow` represents test dataset","74c5ac32":"<p style=\"font-family: Trebuchet MS; line-height: 2; font-size: 16px; font-weight: bold; letter-spacing: 2px; text-align: center; color:#3a0ca3;\">All the features are  weakly correlated.<\/p>\n  ","28ff3ed5":"<p style=\"font-family: Trebuchet MS; line-height: 2; font-size: 18px; font-weight: bold; letter-spacing: 2px; text-align: center; color: #3a0ca3\">There are no missing values.<\/p>","c3134330":"<h3 style=\"font-family: Trebuchet MS;background-color:#eae4e9;color:#3a0ca3;text-align: center;padding-top: 5px;padding-bottom: 5px;border-radius: 15px 50px;letter-spacing: 2px;\"><strong><centre>Importing Libraries & Packages \ud83d\udcda <\/centre><\/strong><\/h3>","96a1b2dd":"<h3 style=\"font-family: Trebuchet MS;background-color:#eae4e9;color:#3a0ca3;text-align: center;padding-top: 5px;padding-bottom: 5px;border-radius: 15px 50px;letter-spacing: 2px;\"><strong><centre>Features (f20 - f39) <\/centre><\/strong><\/h3>","b42cfbf5":"**Observations on this TPS:**\n- `target` column is the target variable\n- `Train` dataset has `600,000` rows and `102` columns which contains`100` features (f0-f99), `1` target variable `target` and `1` column of `id`\n- `Test` dataset has `540,000` rows and `101` columns which contains`100` features (f0-f99) and `1` column of `id`\n`target` and `1` column of `id`\n- No missing values in train and test dataset\n","454d725e":"<h3 style=\"font-family: Trebuchet MS;background-color:#eae4e9;color:#3a0ca3;text-align: center;padding-top: 5px;padding-bottom: 5px;border-radius: 15px 50px;letter-spacing: 2px;\"><strong><centre>Features (f40 - f59) <\/centre><\/strong><\/h3>","8d2ab032":"![TPS Oct 2021.jpg](attachment:88ff4400-df0a-49a0-95e0-1d45498c7d78.jpg)","222d4f18":"<p style=\"font-family: Trebuchet MS; line-height: 2; font-size: 24px; font-weight: bold; letter-spacing: 2px; text-align: center; color: #3a0ca3\">TPS NOVEMBER 2021<\/p>","1b4ddc43":"<h3 style=\"font-family: Trebuchet MS;background-color:#eae4e9;color:#3a0ca3;text-align: center;padding-top: 5px;padding-bottom: 5px;border-radius: 15px 50px;letter-spacing: 2px;\"><strong><centre>Features (f80 - f99) <\/centre><\/strong><\/h3>","5d2bafc6":"<h3 style=\"font-family: Trebuchet MS;background-color:#eae4e9;color:#3a0ca3;text-align: center;padding-top: 5px;padding-bottom: 5px;border-radius: 15px 50px;letter-spacing: 2px;\"><strong><centre>If you found this notebook useful, please Upvote. Thanks!<\/centre><\/strong><\/h3>"}}