{"cell_type":{"244ccbcf":"code","af7aaeb3":"code","7461fdf7":"code","64dbf0f0":"code","d299e701":"code","6882aa69":"code","9a53f0df":"code","79c5a6b3":"code","1fbac6c7":"code","18b7c704":"code","1db6d95e":"code","4706387f":"code","d48fe4e7":"code","7efbbcb1":"markdown"},"source":{"244ccbcf":"!pip install autogluon","af7aaeb3":"## import packages\nfrom autogluon.tabular import TabularPredictor\nimport pandas as pd\nimport datetime as dt","7461fdf7":"# main flow\nstart_time = dt.datetime.now()\nprint(\"Started at \", start_time)","64dbf0f0":"trainfile = '\/kaggle\/input\/tabular-playground-series-dec-2021\/train.csv'\ntestfile = '\/kaggle\/input\/tabular-playground-series-dec-2021\/test.csv'\nsubfile = '\/kaggle\/input\/tabular-playground-series-dec-2021\/sample_submission.csv'\n\ntrain = pd.read_csv(trainfile)\ntest = pd.read_csv(testfile)\nsub = pd.read_csv(subfile)\nprint(train.shape, test.shape)\ntrain.head()","d299e701":"target = 'Cover_Type'\nprint('rows dropped = ', train[((train[target] == 4) | (train[target] == 5))].shape)\ntrain = train[~((train[target] == 4) | (train[target] == 5))]\nprint(train.shape)","6882aa69":"# drop useless features with zero variance\nfeatures_to_drop = ['Soil_Type15', 'Soil_Type7']\ntrain = train.drop(features_to_drop, axis=1)\ntest = test.drop(features_to_drop, axis=1)","9a53f0df":"# additional feature engineering\n\n# N\/A","79c5a6b3":"\nmodel_autogluon = TabularPredictor(\n    label=target\n)\n\nmodel_autogluon.fit(train_data=train, time_limit=180)","1fbac6c7":"## check leaderboard for carbon monoxide\nmodel_autogluon.leaderboard()","18b7c704":"## generate predictions\n#predictions = model_autogluon.predict_proba(test)\npredictions = model_autogluon.predict(test)","1db6d95e":"print(predictions)","4706387f":"# update submission with the predictions obtained\nprediction_class = predictions\nsub['Cover_Type'] = prediction_class\n# submit predictions\nsub.to_csv(\"submission.csv\", index=False)","d48fe4e7":"print('We are done. That is all, folks!')\nfinish_time = dt.datetime.now()\nprint(\"Finished at \", finish_time)\nelapsed = finish_time - start_time\nprint(\"Elapsed time: \", elapsed)","7efbbcb1":"# Log of Submissions\n\n- **0.9479** - basic out-of-the-box setup ('Soil_Type15', 'Soil_Type7' features dropped)\n- **0.93900** - for ('Soil_Type15', 'Soil_Type7', and 'Wilderness_Area3' features dropped)"}}