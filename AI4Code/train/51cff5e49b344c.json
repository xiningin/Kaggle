{"cell_type":{"91b83431":"code","808c485d":"code","d80e18cf":"code","56cc7c4b":"code","ae831c73":"code","f0eed9e9":"code","bda2001d":"code","e72a4d12":"code","754f64ef":"code","2eec1ef6":"code","632a2a7c":"code","1cb71339":"code","b628e1ee":"code","8eead0c0":"code","f5945bb0":"code","d939e0fb":"code","084435b6":"markdown","7d5fc9c6":"markdown","3ec6ad54":"markdown","0ae0d9a5":"markdown","8daec2fe":"markdown","c079ba39":"markdown","c4bca96e":"markdown","80369d42":"markdown","71881b66":"markdown","04c4d102":"markdown"},"source":{"91b83431":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport random\nimport seaborn as sns\nimport statsmodels.api as sm\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","808c485d":"#Crime Data\ncf1=pd.read_csv('\/kaggle\/input\/crimes-in-chicago\/Chicago_Crimes_2001_to_2004.csv', sep=',',error_bad_lines=False)\ncf2=pd.read_csv('\/kaggle\/input\/crimes-in-chicago\/Chicago_Crimes_2005_to_2007.csv', sep=',',error_bad_lines=False)\ncf3=pd.read_csv('\/kaggle\/input\/crimes-in-chicago\/Chicago_Crimes_2008_to_2011.csv', sep=',',error_bad_lines=False)\ncf4=pd.read_csv('\/kaggle\/input\/crimes-in-chicago\/Chicago_Crimes_2012_to_2017.csv', sep=',',error_bad_lines=False)\n\ncrime = cf1.append(cf2)\ncrime = crime.append(cf3)\ncrime = crime.append(cf4)","d80e18cf":"#Community Area Sheet\ncomAr=pd.read_csv('\/kaggle\/input\/crimehousing\/CommAreas.csv', sep=',')\n#Housing Data\ndf=pd.read_csv('\/kaggle\/input\/crimehousing\/Neighborhood_Zhvi_AllHomes.csv', sep=',')\ndf2 = df[df['City']=='Chicago']\ndf2.loc[:,'RegionName'] = df2.loc[:,'RegionName'].str.upper()","56cc7c4b":"#Merge housing and community area sheet\ncmb = pd.merge(df2,comAr,left_on='RegionName',right_on='COMMUNITY')\ncmb = cmb.drop(['the_geom','PERIMETER','AREA','COMAREA_','COMAREA_ID','COMMUNITY','SHAPE_AREA','SHAPE_LEN'], axis=1)\n\ncmb.head(5)","ae831c73":"#Oakland still dangerous but in midst of redevelopment\nsthChicago = cmb[cmb['RegionName']=='OAKLAND']\n# Area = police code for that community\narea = float(sthChicago['AREA_NUMBE'])\nprint(area)","f0eed9e9":"oaklandCrime = crime[crime['Community Area']==area]\noaklandCrime = oaklandCrime[oaklandCrime['Arrest']==True]\noaklandCrime = oaklandCrime.drop(['Unnamed: 0','ID','Case Number','Domestic','Community Area','Block','IUCR','Location Description','Beat','District','Ward','FBI Code','X Coordinate','Y Coordinate','Year','Updated On','Latitude','Longitude','Location'],axis=1)\noaklandCrime['Date'] = pd.to_datetime(oaklandCrime['Date'])\noaklandCrime.rename(columns={'Primary Type':'Crime'}, inplace=True)\noaklandCrime.head()\n# len(oaklandCrime)","bda2001d":"sum_of_crimes = oaklandCrime.groupby([oaklandCrime.Date.dt.year.rename('year'), oaklandCrime.Date.dt.month.rename('month'),oaklandCrime['Crime']]).sum()\nsum_of_crimes = sum_of_crimes.reset_index()\nsum_of_crimes['Date'] = sum_of_crimes['year'].astype(str) + \"-\"+sum_of_crimes['month'].astype(str)\nsum_of_crimes = sum_of_crimes.drop(['year','month'],axis=1)\nsum_of_crimes['Date'] = pd.to_datetime(sum_of_crimes['Date'])\nsum_of_crimes = sum_of_crimes.set_index('Date')\nsum_of_crimes = sum_of_crimes.sort_index()\nsum_of_crimes = sum_of_crimes.loc['2002-01-01':,:]\nsum_of_crimes.tail(10)\n\n#pivot so each crime type becomes a feature\npvtCrime = sum_of_crimes.pivot_table(index='Date',columns='Crime',values='Arrest',aggfunc='sum',fill_value=0)","e72a4d12":"plt.figure(figsize=(8,10))\nsum_of_crimes.groupby([sum_of_crimes['Crime']]).size().sort_values(ascending=True).plot(kind='barh')\nplt.title('Number of Crimes')\nplt.ylabel('Crime Type')\nplt.xlabel('Crime Count')\nplt.show()","754f64ef":"housePrices = sthChicago.loc[:,'1996-04':'2019-07'].transpose().dropna()\nhousePrices.index = pd.to_datetime(housePrices.index)\nhousePrices = housePrices.loc['2002-01-1':'2016-12-01',:]\nhousePrices.columns = ['Price']\n#make sure same entries of house prices as in crime data\nhousePrices = housePrices[housePrices.index.isin(pvtCrime.index)]\n#scale prices down\nhousePrices['Price']=housePrices['Price']\/10000\n# housePrices.tail(10)","2eec1ef6":"#80% training - 20% testing\ntraining_size = int(len(pvtCrime)* 0.80)\n\nX = pvtCrime.iloc[:training_size,:]\ny = housePrices.iloc[:training_size]\nX = sm.add_constant(X)\ntest = pvtCrime.iloc[training_size:,:]\ntest =sm.add_constant(test)\ny_valid = housePrices.iloc[training_size:]\n\n\nmodel = sm.OLS(y,X).fit()\npredictions = model.predict(test)","632a2a7c":"model.summary()","1cb71339":"from sklearn import metrics\nprint(\"RMSE:\")\nprint(np.sqrt(metrics.mean_squared_error(y_valid,predictions)))","b628e1ee":"plt.figure(figsize=(10,10))\nplt.scatter(y_valid.index,y_valid.Price,label='Actual Price')\nplt.plot(predictions.index,predictions,'r',label='Predicted Price')\nplt.xlabel('Date')\nplt.ylabel('Price ($10,000s)')\nplt.title('Predicted Price vs Actual')\nplt.legend(loc='upper left')\nplt.show()\n","8eead0c0":"X2 = pvtCrime.drop(['WEAPONS VIOLATION','CRIMINAL TRESPASS','NARCOTICS','OBSCENITY'],axis=1)\nX3 = X2.iloc[:training_size,:]\nX3 = sm.add_constant(X3)\ny = housePrices.iloc[:training_size]\n\ntest2 = X2.iloc[training_size:,:]\ntest2 = sm.add_constant(test2)\ny_valid = housePrices.iloc[training_size:]\n\n\nmodel2 = sm.OLS(y,X3).fit()\npredictions2 = model2.predict(test2)\nmodel2.summary()","f5945bb0":"print(\"RMSE:\")\nprint(np.sqrt(metrics.mean_squared_error(y_valid,predictions2)))","d939e0fb":"plt.figure(figsize=(10,10))\nplt.scatter(y_valid.index,y_valid.Price,label='Actual Price')\nplt.plot(predictions2.index,predictions2,'r',label='Predicted Price')\nplt.xlabel('Date')\nplt.ylabel('Price ($10,000s)')\nplt.title('Predicted Price vs Actual')\nplt.legend(loc='upper left')\nplt.show()","084435b6":"**Load in Crime Data, Home Price Data and Chicago Neighborhood Codes - Merge house and Neighborhood Mapping dfs**","7d5fc9c6":"**Filter on Oakland. Oakland is located in the South Side of Chicago - known for its crime & lower houeshold incomes.**","3ec6ad54":"Sum crimes for each month. Identify the trend for # crimes vs house price using a regression model. Y = price, x's are type of crime committed.","0ae0d9a5":"Looking at the p-values - We would want to drop:\n\n* Narcotics\n* Trespass\n* Weapons Violation\n* Obscenity (very low coefficient)\n* Can also test removing high standard error features","8daec2fe":"Currently not eliminating any data but would explore eliminating infrequent crimes.","c079ba39":"**Chicago has started to under-go gentrification in historically crime ridden areas. Hypothesis: The decline in crime in specific neighborhoods is a leading indicator of home price appreciation with specific crimes having a larger impact over others.**","c4bca96e":"Create the model using an ordinary least squares regression.","80369d42":"Plot showing signs of overfitting. Feature removal may help with performance. Can Rejig hypothesis to eliminate non-violent crimes \/ crimes with not enough data \/ only look at total count of crimes per month \/ non-arrests included in data.\n\n**Quick Feature Removal Example**","71881b66":"RMSE is $29,000 (when re-scaled). Indicating a somewhat poor predictor.","04c4d102":"Feature deletion improved graphical performance(less noise), albeit suffered from a lower RSME and R^2 value. More room for improvement with outlier elimination."}}