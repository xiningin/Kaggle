{"cell_type":{"f5b5444c":"code","7d5283bf":"code","ee6b121f":"code","0a5a259d":"code","80b1674f":"code","e6e080dc":"code","01cfbc17":"code","912dfc0d":"code","e288eaf8":"code","604c2f46":"code","6f5b2cad":"code","ab0d9d0f":"code","047ca715":"code","e21a1b30":"code","6670c07a":"code","c8c3e3e0":"code","513acc61":"code","8caee102":"code","3d47d568":"code","fe329353":"code","efcf96c0":"code","0fc1c0db":"code","81f6899e":"code","ee99a6d2":"code","11afc0bc":"code","30474ca3":"code","f2b00cdb":"code","51ba0f6a":"code","62cc4966":"code","314d46ab":"code","ae45f52f":"code","6b45b96c":"code","0e23f8fe":"code","a22593b7":"code","3f1c5ea4":"code","6893fe65":"code","350df6d9":"markdown","04f456fe":"markdown","637a8a43":"markdown","22cc99f3":"markdown","6bf81583":"markdown","96a7b940":"markdown","bd948d3a":"markdown","78d93645":"markdown","2db76873":"markdown","71f04089":"markdown","ba6357eb":"markdown","57554960":"markdown","88cfb011":"markdown","a3749586":"markdown","ef4106b3":"markdown","605baf4a":"markdown","9e339749":"markdown","ace23ad7":"markdown","f37e1419":"markdown","600d7c6b":"markdown","ae92d937":"markdown","0388a6bf":"markdown","eb71f268":"markdown","58ef51ef":"markdown","a6bcb41e":"markdown","6a0f3eeb":"markdown","9fdd1f8e":"markdown","6481c7cf":"markdown","8f1a7fd1":"markdown","28bd5804":"markdown","04f73c39":"markdown"},"source":{"f5b5444c":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport geopandas as gpd\nfrom shapely import wkt","7d5283bf":"# Reading the files\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","ee6b121f":"df=pd.read_csv('\/kaggle\/input\/new-york-city-airbnb-open-data\/AB_NYC_2019.csv')","0a5a259d":"#Make the data look cleaner, to 1.dp when finding out statistical analysis on the price\npd.set_option(\"display.precision\", 1)","80b1674f":"df.head()","e6e080dc":"#check the amount of rows and columns within the dataset\ndf.shape","01cfbc17":"#Checking for Null values in the dataset\nprint('Null values in Airbnb dataset: \\n')\nprint(df.isnull().sum())\nprint('\\n')\nprint('Percentage of null values in review columns: ')\nprint(round(df['last_review'].isnull().sum()\/len(df)*100, 2),\"%\")","912dfc0d":"#Review the listings by boroname\nplt.figure(figsize=(10,10))\nsns.scatterplot(x='longitude', y='latitude', hue='neighbourhood_group',s=20, data=df, palette=\"coolwarm\")","e288eaf8":"#let's proceed examine the categorical unique values\n\n#examining the unique values of group\nprint('There are X number of unique neighbourhoods:')\nprint(len(df.neighbourhood_group.unique()))\nprint('\\n')\nprint(df.neighbourhood_group.unique())","604c2f46":"print('There are X number of unique neighbourhoods:')\nprint(len(df.neighbourhood.unique()))\n# print('\\n')\n# print(df.neighbourhood.unique())","6f5b2cad":"print('There are X number of unique room types:')\nprint(len(df.room_type.unique()))\nprint('\\n')\nprint(df.room_type.unique())","ab0d9d0f":"#Here we are retrieve the NYC boroughs from Geopandas\nnyc = gpd.read_file(gpd.datasets.get_path('nybb'))\nnyc.head(5)","047ca715":"#Get a count by borough\nborough_count = df.groupby('neighbourhood_group').agg('count').reset_index()\n\n#Rename the column to boroname, so that we can join the data to it on a common field\nnyc.rename(columns={'BoroName':'neighbourhood_group'}, inplace=True)\nnyc_geo = nyc.merge(borough_count, on='neighbourhood_group')","e21a1b30":"#Plot the count by borough into a map\nfig,ax = plt.subplots(1,1, figsize=(20,10))\nnyc_geo.plot(column='id', cmap='coolwarm', alpha=.5, ax=ax, legend=True)\nnyc_geo.apply(lambda x: ax.annotate(s=x.neighbourhood_group, color='black', xy=x.geometry.centroid.coords[0],ha='center'), axis=1)\nplt.title(\"Number of Airbnb Listings by NYC Borough\")\nplt.axis('off')\n\n#Thanks to @geowiz34 https:\/\/www.kaggle.com\/geowiz34 for this plot.","6670c07a":"import folium\nfrom folium.plugins import HeatMap\nm=folium.Map([40.7128,-74.0060],zoom_start=11)\nHeatMap(df[['latitude','longitude']].dropna(),radius=8,gradient={0.2:'blue',0.4:'purple',0.6:'orange',1.0:'red'}).add_to(m)\ndisplay(m)\n\n","c8c3e3e0":"from folium.plugins import FastMarkerCluster\n\nLat=40.80\nLong=-73.80\n\nlocations = list(zip(df.latitude, df.longitude))\n\nmap1 = folium.Map(location=[Lat,Long], zoom_start=11)\nFastMarkerCluster(data=locations).add_to(map1)\nmap1","513acc61":"plt.figure(figsize=(15,6))\nsns.countplot(data=df, x='neighbourhood_group', hue='room_type', palette='coolwarm')\nplt.title('Counts of AirBnB in neighbourhood group with Room Type Category', fontsize=15)\nplt.xlabel('Neighbourhood group')\nplt.ylabel(\"Count\")\nplt.legend(frameon=False, fontsize=12)","8caee102":"df.pivot_table(index=['neighbourhood_group'],\n               values='price',\n               aggfunc=['count', 'mean','median', 'std'])","3d47d568":"#Alternative to than using pivot tables\ndf.groupby('neighbourhood_group').count()['price'].nlargest(n=20, keep='all')","fe329353":"plt.figure(figsize=(15,6))\nsns.violinplot(data=df[df.price <400], x='neighbourhood_group', y='price', palette='coolwarm')\nplt.title('Density and distribution of prices - ALL TYPES OF ROOMS', fontsize=15)\nplt.xlabel('Neighbourhood group')\nplt.ylabel(\"Price\")","efcf96c0":"dfa = df[df.room_type== 'Entire home\/apt'] # panda chain rule\nprint(dfa.shape)","0fc1c0db":"plt.figure(figsize=(15,6))\nsns.violinplot(data=dfa[df.price <400], x='neighbourhood_group', y='price', palette='coolwarm')\nplt.title('Density and distribution of prices - ENITRE APP', fontsize=15)\nplt.xlabel('Neighbourhood group')\nplt.ylabel(\"Price\")","81f6899e":"dfp = df[df.room_type== 'Private room'] # panda chain rule\n\nplt.figure(figsize=(15,6))\nsns.violinplot(data=dfp[df.price <400], x='neighbourhood_group', y='price', palette='coolwarm')\nplt.title('Density and distribution of prices - PRIVATE ROOM', fontsize=15)\nplt.xlabel('Neighbourhood group')\nplt.ylabel(\"Price\")","ee99a6d2":"#Top 10 neighbourhoods\ndf.groupby('neighbourhood').mean()['price'].nlargest(n=10, keep='all')","11afc0bc":"#word cloud visualisation to show the popular neighbourhoods\n\nfrom wordcloud import WordCloud\n\nplt.subplots(figsize=(20,15))\nwordcloud = WordCloud(\n                          width=1920,\n                          height=1080\n                         ).generate(\" \".join(df.neighbourhood))\nplt.imshow(wordcloud)\nplt.title('Word Cloud for Neighbourhoods')\nplt.axis('off')\nplt.show()","30474ca3":"airbnb=pd.read_csv('\/kaggle\/input\/new-york-city-airbnb-open-data\/AB_NYC_2019.csv')","f2b00cdb":"airbnb.drop(['name','id','host_name','last_review'], axis=1, inplace=True)\n","51ba0f6a":"airbnb.drop(['host_id','latitude','longitude','neighbourhood','number_of_reviews','reviews_per_month'], axis=1, inplace=True)\n#examing the changes\nairbnb.head(5)\n","62cc4966":"#Encode the input Variables\ndef Encode(airbnb):\n    for column in airbnb.columns[airbnb.columns.isin(['neighbourhood_group', 'room_type'])]:\n        airbnb[column] = airbnb[column].factorize()[0]\n    return airbnb\n\nairbnb_en = Encode(airbnb.copy())","314d46ab":"airbnb_en.head(15)\n","ae45f52f":"#Get Correlation between different variables\ncorr = airbnb_en.corr(method='kendall')\nplt.figure(figsize=(14,9))\nsns.heatmap(corr, annot=True)\nairbnb_en.columns","6b45b96c":"from sklearn.linear_model import LogisticRegression\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import classification_report\nfrom sklearn.metrics import confusion_matrix\nfrom sklearn.metrics import r2_score","0e23f8fe":"#Defining the independent variables and dependent variables\nx = airbnb_en.iloc[:,[0,1,3,4,5]]\ny = airbnb_en['price']\n#Getting Test and Training Set\nx_train,x_test,y_train,y_test=train_test_split(x,y,test_size=.1,random_state=353)\nx_train.head()\ny_train.head()","a22593b7":"x_train.shape","3f1c5ea4":"#Prepare a Linear Regression Model\nreg=LinearRegression()\nreg.fit(x_train,y_train)\ny_pred=reg.predict(x_test)\nfrom sklearn.metrics import r2_score\nr2_score(y_test,y_pred)","6893fe65":"#Prepairng a Decision Tree Regression\nfrom sklearn.tree import DecisionTreeRegressor\nx_train,x_test,y_train,y_test=train_test_split(x,y,test_size=.1,random_state=105)\nDTree=DecisionTreeRegressor(min_samples_leaf=.0001)\nDTree.fit(x_train,y_train)\ny_predict=DTree.predict(x_test)\nfrom sklearn.metrics import r2_score\nr2_score(y_test,y_predict)","350df6d9":"We can see that Manhattan \n* has the highest mean and median price\n* highest standard deviation (biggest spread of data)","04f456fe":"# Price Distribution - Finding the market value?","637a8a43":"# Word Cloud","22cc99f3":"AirBnB has been a big disruptor in the hotel industry, as well as part of the gig eccnonomy, where it was founded in late 2008. AirBnB is an online market place for arranging or offering lodging, primarily homestays, or tourism experiences. It has scaled and grew fast as the company does not own any of the real estate listings.\n\nIt is very interesting to undertake analysis on this dataset and understaken more about New York and it's geography. Analysis includes learning about the most expensive neighbourhoods, what is the market price for renting an entire apartment or private room?\n\nFeel free to fork for your own learning and edit the code or use in your own submissions. If you found this enriched your learning in the slightest please **upvote** this notebook as an encouragement for me to continue writing notebooks! :)\n\nThanks to @dgomonov for uploading the complete dataset.","6bf81583":"Clustering of the listings","96a7b940":"Reading the Dataset","bd948d3a":"Using Folium requires two key inputs, the location (lat and long) and the zoom.\n\nThe lat and long can be found here by typing in\n\n\nhttps:\/\/www.latlong.net\/","78d93645":"Interestingly, private rooms are listed the most in all New York Neighbourhood groups except Manhattan on AirBnB.","2db76873":"# Interactive Map with Folium","71f04089":"Great! We can see from the plot that Manhattan has the most number of listings.","ba6357eb":"# Summary\n\nWe learn that there are a lot of listings in Manhatten, the price range can really vary too! We also found a feeling of what the market value of the rent for appartment + shared room.\n\n\n## More to come\n\nIn the near future I aim to do more interactive features in the notebook using Folium library, and have provide more in detail analysis on the indiviual neighbourhoods and the relationship with the tourist attractions, underground stations - if can find ready data avalaible.\n\n### To do Analysis\n\nThese are the things - intend to undertake\n* Interactive chart using - chart from geopandas\n* Size of the borough (area) - geopandas\n\n### Additional Spatial Analysis\n\n* Add in features by underground stations\n* Add in features by main tourist attractions! - Madison Square Garden, Times Square, Rockafella, Empire state building etc\n* Problem by want to be proximity of certain criteria - (distance) - inspired by geopandas distance","57554960":"# A look at Listings by New York Neighbourhoods ","88cfb011":"Interesting... small correlation for reviews per month and avalaibility and calculated host listing and avalaibility\n\nThe obvious correlations are number of reviews and reviews per month. ","a3749586":"Import Libraries","ef4106b3":"# Let's work together!","605baf4a":"# Neighbourhoods via types of room\n\nNow, let's see if we can break it down by the types of rooms per neighbourhood groups.","9e339749":"A distribution of the types of neighbourhood below $400 per night.","ace23ad7":"### Exploratory Data Analysis on AirBnB New York Dataset","f37e1419":"Lets first plot a map of the number of listings on AirBnB via a map to get an overview of the picture.","600d7c6b":"# Getting to know the dataset","ae92d937":"Interactive Map of the Listings","0388a6bf":"### Let's see price split via Private Room","eb71f268":"### Let's see price split via 'Entire home\/apt","58ef51ef":"We can see that for the majority to rent entire appartment it can cost well above $100 per night. ","a6bcb41e":"## Motivation for EDA\n* Opportunity to work on complete ready dataset (~49,000 listings)\n* Find interesting trends - incl. finding the market value of the rent for appartment + shared room.\n* Explore AirBnB NYC dataset \n* Undertake a problem as a travellers prespective\n\n## Opportunity to work using different libaries \n* GeoPandas\n* Bokeh\n* Folium","6a0f3eeb":"# Statistical Analaysis on Neighbourhood groups\nLet's do a quick statistical analysis of the price in relationship with the neighbourhood group","9fdd1f8e":"From breaking the distribution to different room types, we can see the price range and the distrbutions.\n\nThis is useful to see what the market price is for a host or a someone renting. As someone renting you want to get a good value, price and someone hosting, you don't want to be charging much higher than the competition.","6481c7cf":"![NewYorkSkyline](http:\/\/richiewong.co.uk\/wp-content\/uploads\/2019\/12\/New_York_Skyline-scaled.jpg)","8f1a7fd1":"It seems that the most price range below $100 per night, it would be interesting to understand if there are any add-on towards the prices. More importantly a filter, to see how the price differ if it's whole appartment or private room.","28bd5804":"# Prediciting Listing Prices","04f73c39":"# Top neighbourhood listings by average price"}}