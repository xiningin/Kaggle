{"cell_type":{"dfbfddc8":"code","41fd73bb":"code","2bed2203":"code","14fac4d1":"code","8b0b91d5":"code","6cda970a":"code","d6195f74":"code","af63a5b0":"code","d33fc55c":"markdown","ce257081":"markdown","264f699d":"markdown","ae05e7c6":"markdown","619af5bd":"markdown"},"source":{"dfbfddc8":"# DATASET_DIR = '\/kaggle\/input\/understanding-clouds-from-satellite-images-384x576\/'\nDATASET_DIR = '\/kaggle\/input\/understanding_cloud_organization\/'","41fd73bb":"import numpy as np\nimport cv2\nimport os\nfrom tqdm import tqdm_notebook","2bed2203":"def compute_sample_mean(im_dir, image_files):\n    \"\"\"\n    Parameters:\n        im_dir: The directory that contains images.\n        image_files: List of image files you need.\n\n    Returns:\n        sample-mean\n    \"\"\"\n\n    if len(image_files) > 0:\n        image_sum = cv2.imread(os.path.join(im_dir, image_files[0]))\n        image_sum = cv2.cvtColor(image_sum, cv2.COLOR_BGR2RGB).astype(np.float64)\n\n        for image_file in tqdm_notebook(image_files[1:]):\n            img = cv2.imread(os.path.join(im_dir, image_file))\n            img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB)\n            image_sum += img\n\n        return image_sum\/(255*len(image_files))\n\n    return None\n\n\ndef compute_pixel_mean(im_dir, image_files, sample_mean=None):\n    \"\"\"\n    Parameters:\n        im_dir: The directory that contains images.\n        image_files: List of image files you need.\n        sample_mean: sample-mean value.\n\n    Returns:\n        pixel-mean\n    \"\"\"\n\n    if sample_mean is None:\n        sample_mean = compute_sample_mean(im_dir, image_files)\n\n    return np.mean(sample_mean, axis=(0, 1))\n\n\ndef compute_sample_std(im_dir, image_files, sample_mean=None):\n    \"\"\"\n    Parameters:\n        im_dir: The directory that contains images.\n        image_files: List of image files you need.\n        sample_mean: sample-mean value.\n\n    Returns:\n        sample-std\n    \"\"\"\n\n    if len(image_files) > 0:\n        if sample_mean is None:\n            sample_mean = compute_sample_mean(im_dir, image_files)\n\n        square_diff_sum = 0\n        for image_file in tqdm_notebook(image_files):\n            img = cv2.imread(os.path.join(im_dir, image_file))\n            img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB).astype(np.float64)\n            img \/= 255.\n            square_diff_sum += np.square(np.abs(img - sample_mean))\n\n        return np.sqrt(square_diff_sum\/len(image_files))\n\n    return 0\n\n\ndef compute_pixel_std(im_dir, image_files, sample_mean=None, pixel_mean=None):\n    \"\"\"\n    Parameters:\n        im_dir: The directory that contains images.\n        image_files: List of image files you need.\n        sample_mean: sample-mean value.\n        pixel_mean: pixel-mean value.\n\n    Returns:\n        pixel-std\n    \"\"\"\n\n    if len(image_files) > 0:\n        if pixel_mean is None:\n            if sample_mean is not None:\n                pixel_mean = compute_pixel_mean(im_dir, image_files, sample_mean)\n            else:\n                pixel_mean = compute_pixel_mean(im_dir, image_files)\n\n        square_diff_sum = 0\n        for image_file in tqdm_notebook(image_files):\n            img = cv2.imread(os.path.join(im_dir, image_file))\n            img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB).astype(np.float64)\n            img \/= 255.\n            square_diff_sum += np.sum(np.square(np.abs(img - pixel_mean)), axis=(0, 1))\n\n        return np.sqrt(square_diff_sum\/(len(image_files)*img.shape[0]*img.shape[1]))\n\n    return 0","14fac4d1":"train_images_dir = os.path.join(DATASET_DIR, 'train_images')\nimage_files = os.listdir(train_images_dir)","8b0b91d5":"sample_mean = compute_sample_mean(train_images_dir, image_files)\nsample_std = compute_sample_std(train_images_dir, image_files, sample_mean=sample_mean)\npixel_mean = compute_pixel_mean(train_images_dir, image_files, sample_mean=sample_mean)\npixel_std = compute_pixel_std(train_images_dir, image_files, pixel_mean=pixel_mean)","6cda970a":"print('Sample mean:', sample_mean)","d6195f74":"print('Sample std:', sample_std)","af63a5b0":"print('Pixel mean:', pixel_mean)\nprint('Pixel std:', pixel_std)","d33fc55c":"<a id=\"toc\"><\/a>\n# Table of Contents\n1. [Configure parameters](#configure_parameters)\n1. [Import modules](#import_modules)\n1. [Define helper functions](#define_helper_functions)\n1. [Start the calculation](#start_the_calculation)","ce257081":"<a id=\"start_the_calculation\"><\/a>\n# Start the calculation\n[Back to Table of Contents](#toc)","264f699d":"<a id=\"define_helper_functions\"><\/a>\n# Define helper functions\n[Back to Table of Contents](#toc)","ae05e7c6":"<a id=\"import_modules\"><\/a>\n# Import modules\n[Back to Table of Contents](#toc)","619af5bd":"<a id=\"configure_parameters\"><\/a>\n# Configure parameters\n[Back to Table of Contents](#toc)"}}