{"cell_type":{"139659f7":"code","78d738e7":"code","29c945c8":"code","919116e0":"code","77da3dbe":"code","60d1f541":"code","b9c1b650":"code","cf68a9d5":"code","29f5b68f":"code","b89f155c":"code","13e969fc":"code","c648374e":"code","272e0101":"code","d26ddbb2":"code","8fd2356d":"code","76445cd1":"code","0143bc62":"code","3b0db648":"code","f1e01242":"code","f9df26ca":"code","d14ffb73":"markdown"},"source":{"139659f7":"import numpy as np\nimport pandas as pd\nimport os\nimport random\nimport cv2\n\nfrom keras.models import Sequential\nfrom keras.layers import Dense\nfrom keras.layers import Dropout\nfrom keras.layers import Flatten\nfrom keras.callbacks import EarlyStopping\nfrom keras.layers.convolutional import Conv2D\nfrom keras.layers.convolutional import MaxPooling2D\nfrom keras.utils import np_utils\n\nfrom sklearn.preprocessing import LabelBinarizer\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import accuracy_score\nimport matplotlib.pyplot as plt\nimport seaborn as sns","78d738e7":"data = pd.read_csv('..\/input\/tmnist-typeface-mnist\/TMNIST_Data.csv')\ndata","29c945c8":"print(data['names'].unique())\nprint(data['names'].nunique())","919116e0":"data['names'].value_counts()","77da3dbe":"N=list(range(len(data)))\nn=len(data)\nprint(n)\nrandom.seed(2021)\nrandom.shuffle(N)","60d1f541":"trainY=data.loc[N[0:(n\/\/4)*3],'labels']\ntestY=data.loc[N[(n\/\/4)*3:],'labels']\ndata1=data.drop(['names','labels'],axis=1)\ntrainX=data1.loc[N[0:(n\/\/4)*3]]\ntestX=data1.loc[N[(n\/\/4)*3:]]","b9c1b650":"binencoder = LabelBinarizer()\ny0 = trainY\ny = binencoder.fit_transform(y0)\ny","cf68a9d5":"X_images = trainX.values.reshape(-1,28,28)\ntest_images = testX.values.reshape(-1,28,28)\n\nprint(X_images.shape)\nprint(test_images.shape)","29f5b68f":"fig,axs = plt.subplots(3,3,figsize=(9,9))\nfor i in range(9):\n    r=i\/\/3\n    c=i%3\n    axs[r][c].set_xticks([])\n    axs[r][c].set_yticks([])\n    axs[r][c].imshow(X_images[i])\nplt.show()","b89f155c":"X_train, X_test, y_train, y_test = train_test_split(X_images, y, test_size = 0.2, random_state=90)","13e969fc":"print(X_train.shape)\nprint(X_test.shape)\nprint(y_train.shape)\nprint(y_test.shape)","c648374e":"X_train = (X_train\/255).reshape(-1,28,28,1).astype('float32')\nX_test = (X_test\/255).reshape(-1,28,28,1).astype('float32')","272e0101":"test_images = (test_images\/255).reshape(-1,28,28,1).astype('float32')","d26ddbb2":"model = Sequential()\nmodel.add(Conv2D(32,(4,4),input_shape = (28,28,1),activation = 'relu'))\nmodel.add(MaxPooling2D(pool_size=(2,2)))\nmodel.add(Conv2D(64,(3,3),activation = 'relu'))\nmodel.add(MaxPooling2D(pool_size=(2,2)))\nmodel.add(Dropout(0.2))\nmodel.add(Flatten())\nmodel.add(Dense(128,activation='relu'))\nmodel.add(Dense(50, activation='relu'))\nmodel.add(Dense(10, activation='softmax'))\nmodel.compile(loss='categorical_crossentropy', optimizer='adam',metrics=['accuracy'])","8fd2356d":"model.summary()","76445cd1":"result = model.fit(X_train, y_train, validation_split=0.2, epochs=30, batch_size=92, verbose=2)\nresult","0143bc62":"his = pd.DataFrame(result.history)\nhis.loc[:, ['accuracy', 'val_accuracy']].plot()\nhis.loc[:, ['loss', 'val_loss']].plot()","3b0db648":"y_pred = model.predict(test_images)\nprint(y_pred[0])","f1e01242":"y_pred2=[]\nfor item in y_pred:   \n    y_pred2+=[np.argmax(item)   ]\nPRED=np.array(y_pred2)\nANS=np.array(testY)\nprint(PRED[0:10])\nprint(ANS[0:10])","f9df26ca":"accuracy_score(ANS,PRED)","d14ffb73":"import tensorflow as tf\ntry:\n    tpu = tf.distribute.cluster_resolver.TPUClusterResolver()\n    print('Device:', tpu.master())\n    tf.config.experimental_connect_to_cluster(tpu)\n    tf.tpu.experimental.initialize_tpu_system(tpu)\n    strategy = tf.distribute.experimental.TPUStrategy(tpu)\nexcept:\n    strategy = tf.distribute.get_strategy()\nprint('Number of replicas:', strategy.num_replicas_in_sync)"}}