{"cell_type":{"68735b3a":"code","d34a3f16":"code","241da286":"code","74bc9a33":"code","70426c75":"code","a7e576f0":"code","6c95acc8":"code","c3a1f4a7":"code","53b5f86b":"code","86c19345":"code","302dc508":"code","f402631b":"code","9613b163":"code","b1e84721":"code","1e47b636":"code","e2cab6b0":"code","184fd41f":"code","2eba3ce1":"code","18880e98":"code","f19191c3":"code","5b196e38":"code","d1a8ba28":"code","cf1c5a73":"code","eb7055d0":"code","7c742dab":"code","93d4adfa":"code","de3eb181":"code","496a5624":"code","b5eae139":"code","2a328823":"code","52bd0575":"code","644c54f2":"code","3f1e2db8":"code","53944126":"code","8bd9c1b9":"code","c60cdbfd":"code","1fcbc65f":"code","8f96fa32":"code","83a58c12":"code","c2a911e9":"code","690601fd":"code","a5f95bae":"code","d8443980":"code","964cd576":"code","66df7413":"code","9309d0b9":"code","09299828":"code","bae5397c":"code","f670bdc2":"code","45c76730":"code","a0822452":"code","793908d4":"code","67c543ad":"code","3c4f524d":"code","029edc70":"code","d87752ad":"code","920432bb":"code","b4056afd":"code","a86eb5a7":"code","eb9f04e6":"code","9d8f022a":"code","f4b8e4b0":"code","be1bc5ef":"code","41e6f23a":"code","77c12f37":"code","31cefda2":"code","81794f7f":"code","1371141c":"code","9568d742":"code","84700122":"code","ff10793b":"markdown","a04d4a39":"markdown","72c6a578":"markdown","91e8a857":"markdown","9df40620":"markdown","4ff912fa":"markdown","8f095e4f":"markdown","c60b6758":"markdown","261f2f74":"markdown","ac76e77c":"markdown","8f39504c":"markdown","5b6df305":"markdown","948d2960":"markdown","0fdad35d":"markdown","e8659b24":"markdown","b87d04a8":"markdown","e504860f":"markdown","5c819693":"markdown","9a72f418":"markdown","f64a29d2":"markdown","252d45b6":"markdown","0d703ef0":"markdown","3e2e68da":"markdown","2ccfdb68":"markdown","9eed22cb":"markdown","3aee16a3":"markdown","f468f103":"markdown","752341e2":"markdown","665b6432":"markdown","97fc6208":"markdown","9babc4e5":"markdown","c4467f7a":"markdown","2c1ce464":"markdown","b6dd33fe":"markdown","0a72b000":"markdown","5e464bc8":"markdown","9eb2262b":"markdown","b5fe92b3":"markdown","63fe2138":"markdown","84e4e84a":"markdown","96260fc0":"markdown","27144a44":"markdown","90febc84":"markdown"},"source":{"68735b3a":"import numpy as np \nimport pandas as pd \nimport seaborn as sns \nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport warnings\nwarnings.filterwarnings('ignore')","d34a3f16":"data=pd.read_csv(\"..\/input\/heart-disease-uci\/heart.csv\")","241da286":"data.head()","74bc9a33":"list(data.columns)","70426c75":"data.shape","a7e576f0":"data.info()","6c95acc8":"data_dtype = data.dtypes\ndata_dtype.value_counts()","c3a1f4a7":"data.isnull().sum()","53b5f86b":"# Let's look at the values contained in each column.\nfor i in data.columns:\n  print(i, data[i].unique())","86c19345":"sns.countplot(data[\"target\"])\nplt.title(\"Countplot for diagnosis\")\nplt.show();","302dc508":"# Here I get the number of values in each of our classes.\ndata[\"target\"].value_counts()","f402631b":"# Here, get the percentage of the relationship between the features and the target.\ndata.corr()['target'].sort_values(ascending=False)","9613b163":"data.hist(figsize=(18,10))\nplt.show()","b1e84721":"fig, ax = plt.subplots(figsize=(20,20))\nsns.heatmap(data.corr(), annot=True, linewidths=.5, ax=ax)\nplt.show()","1e47b636":"from scipy.stats import norm","e2cab6b0":"#descriptive statistics summary\ndata['age'].describe()","184fd41f":"data[\"age\"].value_counts()","2eba3ce1":"sns.boxplot('age',data=data) \nplt.xlabel('Age Column Distribution')","18880e98":"# Let's see the distribution of the age \n#histogram\nsns.distplot(data['age']);","f19191c3":"#skewness and kurtosis\nprint(\"Skewness: %f\" % data['age'].skew())\nprint(\"Kurtosis: %f\" % data['age'].kurt())","5b196e38":"data.head(10)","d1a8ba28":"fig = sns.FacetGrid(data, hue=\"target\",aspect=4)\nfig.map(sns.kdeplot,'age',shade= True)\noldest = data['age'].max()\nfig.set(xlim=(0,oldest))\nfig.add_legend()","cf1c5a73":"sns.countplot('sex', data=data,hue='target')","eb7055d0":"sns.catplot(data=data,x=\"sex\" , y=\"age\" , hue=\"target\" , palette=\"husl\")","7c742dab":"data[\"trestbps\"].describe()","93d4adfa":"sns.boxplot('trestbps',data=data) \nplt.xlabel('trestbps Column Distribution')","de3eb181":"# Let's see the distribution of the data.\n#histogram\nsns.distplot(data['trestbps']);","496a5624":"#skewness and kurtosis\nprint(\"Skewness: %f\" % data['trestbps'].skew())\nprint(\"Kurtosis: %f\" % data['trestbps'].kurt())","b5eae139":"data[\"trestbps\"].unique()","2a328823":"bins  =   [90,101,112,123,134,145,156,167,178,189,200,211]\nlabels = ['Less than 100', '101-111','112-122','123-133','134-144','145-155','156-166','167-177','178-188','189-199','more than 200']\ndata['Max_pressure'] = pd.cut(data['trestbps'],right=False , bins= bins,labels = labels)\ndata['Max_pressure']","52bd0575":"plt.figure(figsize=(12,6))\nsns.countplot(x=\"Max_pressure\",hue=\"target\" , data=data,palette=\"rocket\")","644c54f2":"fig = sns.FacetGrid(data, hue=\"Max_pressure\",aspect=4)\nfig.map(sns.kdeplot,'age',shade= True)\noldest = data['age'].max()\nfig.set(xlim=(0,oldest))\nfig.add_legend()\n","3f1e2db8":"plt.figure(figsize=(12,6))\nsns.countplot(x=\"sex\",hue=\"Max_pressure\" , data=data,palette=\"rocket\")","53944126":"# Now we will see the shape of the relationship between the column and the target column.\nsns.swarmplot(x=data['target'],\n              y=data['trestbps'])","8bd9c1b9":"data[\"cp\"].describe()","c60cdbfd":"# Reveal the different values included in the column.\ndata[\"cp\"].unique()","1fcbc65f":"plt.figure(figsize=(12,6))\nsns.countplot('cp', data= data, hue= 'target')","8f96fa32":"plt.figure(figsize=(10,6))\nsns.countplot(x=\"sex\",hue=\"cp\" , data=data,palette=\"rocket\")","83a58c12":"fig = sns.FacetGrid(data, hue=\"sex\",aspect=4)\nfig.map(sns.kdeplot,'cp',shade= True)\noldest = data['cp'].max()\nfig.set(xlim=(0,oldest))\nfig.add_legend()","c2a911e9":"plt.figure(figsize=(10,6))\ndata.groupby('cp')['target'].value_counts(normalize=False).unstack().plot(kind='bar')","690601fd":"data[\"thalach\"].describe()","a5f95bae":"sns.boxplot('thalach',data=data) \nplt.xlabel('thalach Column Distribution')","d8443980":"# Let's see the distribution of the data.\n#histogram\nsns.distplot(data['thalach']);","964cd576":"#skewness and kurtosis\nprint(\"Skewness: %f\" % data['thalach'].skew())\nprint(\"Kurtosis: %f\" % data['thalach'].kurt())","66df7413":"data[\"thalach\"].unique()","9309d0b9":"# Now we will see the shape of the relationship between the column and the target column.\nsns.swarmplot(x=data['target'],\n              y=data['thalach'])","09299828":"\nbins  =   [90,101,112,123,134,145,156,167,178,189,200,211]\nlabels = ['Less than 100', '101-111','112-122','123-133','134-144','145-155','156-166','167-177','178-188','189-199','more than 200']\ndata['Max_Heart_Rate'] = pd.cut(data['thalach'],right=False , bins= bins,labels = labels)\ndata['Max_Heart_Rate']","bae5397c":"plt.figure(figsize=(12,6))\nsns.countplot('Max_Heart_Rate', data =data,hue='target')","f670bdc2":"plt.figure(figsize=(10,6))\nsns.countplot(x=\"sex\",hue=\"Max_Heart_Rate\" , data=data,palette=\"rocket\")","45c76730":"fig = sns.FacetGrid(data, hue=\"Max_Heart_Rate\",aspect=4)\nfig.map(sns.kdeplot,'age',shade= True)\noldest = data['age'].max()\nfig.set(xlim=(0,oldest))\nfig.add_legend()","a0822452":"bins  =   [29,41,53,65,78]\nlabels = ['29-40', '41-52','53-64','65-77']\ndata['Age_Group'] = pd.cut(data['age'],right=False , bins= bins,labels = labels)\ndata['Age_Group']","793908d4":"data.head()","67c543ad":"plt.figure(figsize=(20,10))\nsns.countplot('Age_Group', data= data, hue= 'Max_Heart_Rate')","3c4f524d":"plt.figure(figsize=(10,6))\nsns.countplot(x=\"Age_Group\",hue=\"sex\" , data=data,palette=\"rocket\")","029edc70":"data.head()","d87752ad":"# Here I will return the data to its original.\n# By dropping one of the columns we have created.\ndata=data.drop([\"Max_Heart_Rate\"],axis=1)\ndata=data.drop([\"Max_pressure\"],axis=1)\ndata=data.drop([\"Age_Group\"],axis=1)","920432bb":"# Here we extracted the columns with outliers.\ndf_out = data[[\"age\", \"trestbps\", \"chol\", \"thalach\", \"oldpeak\"]]\ndf_out.describe()","b4056afd":"infor = data.describe()\n\ndf2 = data[data.trestbps < infor.loc[\"mean\", \"trestbps\"] + 3 * infor.loc[\"std\", \"trestbps\"]]\ndf3 = df2[data.chol < infor.loc[\"mean\", \"chol\"] + 3 * infor.loc[\"std\", \"chol\"]]\ndf4 = df3[data.thalach > infor.loc[\"mean\", \"thalach\"] - 3 * infor.loc[\"std\", \"thalach\"]]\nnew_data = df4[data.oldpeak < infor.loc[\"mean\", \"oldpeak\"] + 3 * infor.loc[\"std\", \"oldpeak\"]]\nnew_data.head()","a86eb5a7":"from sklearn.preprocessing import LabelEncoder\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.model_selection import train_test_split","eb9f04e6":"target=new_data[\"target\"]\nfeatures=new_data.drop([\"target\"],axis=1)","9d8f022a":"# Here I do the data transformation.\nscaler = StandardScaler(copy=True, with_mean=True, with_std=True)\nX = scaler.fit_transform(features)","f4b8e4b0":"# Here I has reduced the amount of data used in the testing process because the data is very small\nx_train,x_test,y_train,y_test=train_test_split(X,target,test_size=0.1,random_state=0)","be1bc5ef":"print(x_train.shape,x_test.shape,y_train.shape,y_test.shape)","41e6f23a":"from sklearn.svm import SVC\nfrom sklearn.metrics import confusion_matrix\n\nSVCModel = SVC(kernel= 'rbf',# it can be also linear,poly,sigmoid,precomputed\n               max_iter=20,C=0.01,gamma='auto')\n\nSVCModel.fit(x_train, y_train)","77c12f37":"#Calculating Details\nprint('SVCModel Train Score is : ' , SVCModel.score(x_train, y_train))\nprint('SVCModel Test Score is : ' , SVCModel.score(x_test, y_test))\n#Calculating Prediction\ny_pred = SVCModel.predict(x_test)\nprint('Predicted Value for SVCModel is : ' , y_pred[:20])\nprint('real Values for SVCModel     is : '\"\\n\" , y_test[:20])","31cefda2":"#Calculating Confusion Matrix\nCM = confusion_matrix(y_test, y_pred)\nprint('Confusion Matrix is : \\n', CM)\n\n# drawing confusion matrix\nsns.heatmap(CM, center = True)\nplt.show()","81794f7f":"from sklearn.ensemble import RandomForestClassifier\nRandomForestClassifierModel=RandomForestClassifier(n_estimators=100, criterion='gini', max_depth=7,\n                                min_samples_split=2, min_samples_leaf=1,min_weight_fraction_leaf=0.0,\n                                max_features='auto',max_leaf_nodes=7,min_impurity_decrease=0.0,\n                                min_impurity_split=None, bootstrap=True,oob_score=False, n_jobs=-1,\n                                random_state=0, verbose=0,warm_start=True)\nRandomForestClassifierModel.fit(x_train, y_train)","1371141c":"#Calculating Details\nprint('RandomForestClassifierModel Train Score is : ' , RandomForestClassifierModel.score(x_train, y_train))\nprint('RandomForestClassifierModel Test Score is : ' , RandomForestClassifierModel.score(x_test, y_test))\nprint('RandomForestClassifierModel features importances are : ' , RandomForestClassifierModel.feature_importances_)","9568d742":"#Calculating Prediction\ny_pred = RandomForestClassifierModel.predict(x_test)\ny_pred_prob = RandomForestClassifierModel.predict_proba(x_test)\nprint('Predicted Value for RandomForestClassifierModel is : ' , y_pred[:10])\nprint(\"real values of y_test>>>>>>>>>>>>>>>>>>>>>>>>>>>is : \\n\" ,y_test[:10] )\nprint('Prediction Probabilities Value for RandomForestClassifierModel is : ' , y_pred_prob[:10])\n ","84700122":"#Calculating Confusion Matrix\nCM = confusion_matrix(y_test, y_pred)\nprint('Confusion Matrix is : \\n', CM)\n\n# drawing confusion matrix\nsns.heatmap(CM, center = True)\nplt.show()","ff10793b":"\n<h1 align=\"center\"> EDA :Heart Disease UCI and applied ML <\/h1>\n<center><img src=\"https:\/\/storage.googleapis.com\/kaggle-datasets-images\/538044\/983409\/21d3eec8c2d5c04b7014f61ae3b516be\/dataset-card.jpg?t=2020-03-03-06-25-57\" width=\"60%\" >\n","a04d4a39":"> **In general, we note that males are more likely to suffer from chest pain, and specifically more likely to suffer from chest pain of the first type.\nAnd all this more than women.**","72c6a578":"> **Here the results seem more clear, and we note that the age groups most susceptible to an increase in heart rate are from 53 years to 64 years, and they come after them from 41 years to 52 years.**","91e8a857":"> **Here we are trying to show the relationship between age and high heart rate, but the results do not seem clear, so we will modify and include a new column that holds the age groups.**","9df40620":"# Outliers.","4ff912fa":"> **We're done with that software page, we've done a lot of work on it, from analyzing and exploring data, analyzing columns and extracting information, to putting together machine learning algorithms to classify and get fairly good results.**\n\n> **With regard to the results that we obtained from machine learning algorithms, it was certainly possible to obtain higher results in accuracy, but there is nothing wrong with those results so far.**","8f095e4f":"# View the data.","c60b6758":"# EDA : age column","261f2f74":"# EDA : cp column","ac76e77c":"> **From the results we obtained, we note that the disease begins to spread at high rates at the age of 33 years and then intensifies in prevalence between approximately 43 to 46 years, and then continues to spread to reach the largest number of infections between approximately 50 to 58 years, and then begins to decline Gradually a weak percentage to hit Bchmda from time to time.**","8f39504c":"# In the end","5b6df305":"> **We note a dangerous rise in the values from 43 years to 68 years, and these values have the highest incidence of the disease.**","948d2960":"> **Let's see the normal distribution of disease prevalence between different ages.**","0fdad35d":"**From the figure, we notice that there is a clustering of data between 120 and 140 mmHg, but we notice an annoying thing, which is those values far from agglomeration, which may reach 200 mmHg.**","e8659b24":"> **From the results, we note the presence of a cluster of data between 45 to 64 years.**\n\n> **The data also skews between two values, 29 to 77 years.**","b87d04a8":"# Heart Disease UCI data analysis and use of machine learning algorithm for classification.\n\n**In that software page we did a lot of work like:**\n\n* Take a look at the data.\n* Detailed data analysis.\n* Extracting and deducing a lot of information during the analysis.\n* Data cleaning and transformation.\n* data splitting.\n* Apply machine learning algorithms to classify data.","e504860f":"# Data preprocessing ","5c819693":"> **Here we divide the data into categories to facilitate the process of drawing and extracting information.**","9a72f418":"# Reading Data ","f64a29d2":"**There are thirteen features and one target as below:**\n\n* age: The person's age in years\n* sex: The person's sex (1 = male, 0 = female)\n* cp: The chest pain experienced (Value 1: typical angina, Value 2: atypical angina, Value 3: non-anginal pain, Value 4: asymptomatic)\n* trestbps: The person's resting blood pressure (mm Hg on admission to the hospital)\n* chol: The person's cholesterol measurement in mg\/dl\n* fbs: The person's fasting blood sugar (> 120 mg\/dl, 1 = true; 0 = false)\n* restecg: Resting electrocardiographic measurement (0 = normal, 1 = having ST-T wave abnormality, 2 = showing probable or definite left ventricular hypertrophy by Estes' criteria)\n* thalach: The person's maximum heart rate achieved\n* exang: Exercise induced angina (1 = yes; 0 = no)\n* oldpeak: ST depression induced by exercise relative to rest\n* slope: the slope of the peak exercise ST segment (Value 1: upsloping, Value 2: flat, Value 3: downsloping)\n* ca: The number of major vessels (0-3)\n* thal: A blood disorder called thalassemia (3 = normal; 6 = fixed defect; 7 = reversable defect)\n\n* target: Heart disease (0 = no, 1 = yes)","252d45b6":"# Thank you very much for your time","0d703ef0":"> **We will get rid of the outliers that we observed in the previous columns.**","3e2e68da":"> **Heart rate ranging from 145 to 188 are more susceptible to the disease, as shown in the figure.**","2ccfdb68":"> **It is clear that this column contains a lot of values, which we must divide in order to be easy to extract information.**","9eed22cb":"> **Now we have finished analyzing the most features associated with the target column, so I will now be satisfied with those analyzes and start developing algorithms.**","3aee16a3":"> **Through the results we obtained and through the figure, we notice that there is a Skewness in the data of the positive type, but it is a very slight distortion.**\n\n> **But with the presence of the light positive tail, we can conclude that there are outliers with a slight percentage.**","f468f103":"> **We note from the results that people with type 1 and type 2, have a greater chance of contracting the disease.**","752341e2":"> **Here, we note that the number of men is much greater than the number of women in the age groups from 53 to 64 years, followed by the age group from 41 to 52 years, which also exceeds the number of men than the number of women. The heart and thus heart disease, and certainly men are at the forefront of the scene.\nWhich strongly confirms the results we obtained previously.**","665b6432":"> **We notice a pool of data for heart rate that is between 130 and 170, with some outliers.**","97fc6208":"> **Here is a distribution that shows the distribution of men and women in ages.**","9babc4e5":"> **We note that males are more likely to have a person's resting blood pressure (mm Hg on admission to the hospital) than women.**","c4467f7a":"# EDA : thalach column\n* The person's maximum heart rate achieved","2c1ce464":"> **From the figure, we conclude that men are more likely to have a higher heart rate than women, and this is difficult for men.**","b6dd33fe":"# 2 . Random Forest Algorithm","0a72b000":"# EDA for each column","5e464bc8":"# Data Spliting","9eb2262b":"**The ideal blood pressure for adults ranges between 90\/60 mm Hg to 120\/80 mmHg, and it should be noted that blood pressure fluctuates significantly in the short term during the day, such as: changes from one heartbeat to another, and from minute to minute, From hour to hour, and from day to day, as well as long-term changes over long periods of time such as days, weeks, months, seasons, and even years, so to ensure accurate evaluation of pressure readings, the doctor must rely on the average of two or more pressure readings during his visit three times Or more .**","b5fe92b3":"# EDA : General data exploration","63fe2138":"# 1. SVC Algorithm","84e4e84a":"**Note that the blood pressure that is confined between the values of 112 to 144 witnesses the highest incidence of the disease as shown in the figure.**","96260fc0":"> **The resting heart rate for a normal person ranges between 60-100 beats per minute**","27144a44":"# EDA : trestbps column","90febc84":"# Let's start by developing machine learning algorithms for classification."}}