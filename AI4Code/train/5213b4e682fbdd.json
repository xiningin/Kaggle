{"cell_type":{"5b1b9dbc":"code","f883c2d7":"code","9d5433c0":"code","36155d2e":"code","4454ce76":"code","1dce7bdd":"code","50928b22":"code","330a908f":"code","7be14209":"code","5ebd333e":"code","3c123a54":"code","319308a0":"code","150773c6":"code","22d22eba":"code","4a45f25d":"code","204484f6":"code","660fb9e7":"code","c0b5d260":"code","4e26ac06":"code","df7dba80":"code","f3f127b6":"code","6f2265f0":"code","fca66f71":"code","e23c8229":"code","84b64143":"code","4cc5439f":"code","33f906d8":"code","88d5a13c":"code","b9cc452d":"code","993d6b08":"code","07d2cb6c":"code","f052ef58":"code","3ad41476":"markdown","12c01e25":"markdown","588145bd":"markdown","99fa3781":"markdown"},"source":{"5b1b9dbc":"import pandas as pd\n\ndf_data_1 = pd.read_csv(\"..\/input\/fifa-21\/players_fifa21.csv\")\ndf_data_1.head(10)\n","f883c2d7":"import pandas as pd\nimport numpy as np\nfrom sklearn.preprocessing import OrdinalEncoder\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.preprocessing import PolynomialFeatures\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.preprocessing import OneHotEncoder\nfrom sklearn.compose import ColumnTransformer\nfrom sklearn.decomposition import PCA\nfrom sklearn.decomposition import KernelPCA\nfrom sklearn.impute import SimpleImputer\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.linear_model import Lasso\nfrom sklearn.linear_model import Ridge\nfrom sklearn.model_selection import cross_val_predict\nfrom sklearn.feature_selection import RFECV","9d5433c0":"df_fifa = df_data_1","36155d2e":"%matplotlib inline\nimport matplotlib.pyplot as plt","4454ce76":"plt.figure(figsize = (12,8))\nplt.scatter(x = df_fifa[\"Potential\"], y = df_fifa[\"Overall\"])\nm, b = np.polyfit(df_fifa[\"Potential\"], df_fifa[\"Overall\"], 1)\nplt.plot(df_fifa[\"Potential\"], m*df_fifa[\"Potential\"]+b, \"r-\")\nplt.xlabel(\"Potential\")\nplt.ylabel(\"Overall\")\nplt.title(\"Overall Rating vs Potential Rating\", fontsize = 16)\nplt.show()","1dce7bdd":"plt.figure(figsize = (12,8))\nplt.hist(df_fifa[\"Age\"])\nplt.xlabel(\"Age\")\nplt.ylabel(\"Frequency\")\nplt.title(\"Histogram of Age\")","50928b22":"df_fifa_top = df_fifa.head(10)","330a908f":"plt.figure(figsize = (12,8))\nplt.barh(\"Name\", \"Overall\", data = df_fifa_top, color = \"blue\")\nplt.xlim((85,95))\nplt.xticks(rotation = 90)\nplt.gca().invert_yaxis()\nplt.ylabel(\"Player\")\nplt.xlabel(\"Overall Ratings\")\nplt.title(\"Best Players on FIFA 21\", fontsize = 16);","7be14209":"df_fifa_new = df_fifa[['Potential','Name','Growth', 'WeakFoot', 'SkillMoves', 'AttackingWorkRate','DefensiveWorkRate','ReleaseClause', 'ValueEUR', 'WageEUR', 'Age']]","5ebd333e":"import seaborn as sns;sns.set(style=\"ticks\")","3c123a54":"plt.figure(figsize = (20,8))\ncor = df_fifa_new.corr()\nsns.heatmap(cor, annot = True, cmap = \"viridis\")\nplt.show();","319308a0":"df_fifa_new.shape","150773c6":"df_fifa_new.columns","22d22eba":"df_fifa_x = df_fifa_new.iloc[:, 1:]\ndf_fifa_y = df_fifa_new.iloc[:, :1]\nx_train, x_test, y_train, y_test = train_test_split(df_fifa_x, df_fifa_y, random_state = 10, train_size = 0.8)","4a45f25d":"x_train1 = x_train.iloc[:,1:]\nx_test1 = x_test.iloc[:,1:]","204484f6":"from sklearn.ensemble import RandomForestRegressor\nfrom sklearn.feature_selection import SelectFromModel","660fb9e7":"### Pre-processing\nord_enc = OrdinalEncoder()\nord_enc.fit([['Low', 1], ['Medium', 2], ['High', 3]])\none_hot = OneHotEncoder()\ndf_fifa_new_list = df_fifa_new[['AttackingWorkRate', 'DefensiveWorkRate']]\nord_list = list(df_fifa_new_list)\ncolumn_pipeline = ColumnTransformer([(\"ord\", ord_enc, ord_list),(\"std\",StandardScaler(), ['Growth', 'WeakFoot','SkillMoves','ReleaseClause', 'ValueEUR', 'WageEUR', 'Age'])])\nlin_reg = LinearRegression()","c0b5d260":"full_pipeline = Pipeline([(\"column\", column_pipeline), (\"feature selection\", RFECV(Lasso(alpha = 0.1), cv = 5)), (\"reg\", RandomForestRegressor())])","4e26ac06":"param_grid = [{'reg__n_estimators': np.arange(1,50), 'reg__max_features':np.arange(1,10)},]\ngrid_search = GridSearchCV(full_pipeline, param_grid, cv = 5, scoring = \"r2\")","df7dba80":"y_train1 = y_train.values.ravel()\ny_train1","f3f127b6":"grid_search.fit(x_train1, y_train1)","6f2265f0":"grid_search.best_estimator_","fca66f71":"grid_search.best_score_","e23c8229":"final_model = grid_search.best_estimator_","84b64143":"train_pipeline = Pipeline([(\"column\", column_pipeline), (\"feature selection\", RFECV(Lasso(alpha = 0.1), cv = 5)), (\"reg\", RandomForestRegressor(max_features=7, n_estimators = 22))])\nfrom sklearn.pipeline import make_pipeline","4cc5439f":"y_pred_cv = cross_val_predict(train_pipeline, x_train1, y_train1, cv = 5)","33f906d8":"x_train_new = x_train.copy()\nx_train_new[\"Potential\"] = y_train\nx_train_new[\"Predicted\"] = y_pred_cv\nx_train_final = x_train_new.reset_index()\nx_train_final = x_train_final.drop(\"index\", axis = 1)\nx_train_final.head(20)","88d5a13c":"train_pipeline.fit(x_train1, y_train)","b9cc452d":"y_pred = train_pipeline.predict(x_test)","993d6b08":"from sklearn.metrics import r2_score\nfrom sklearn.metrics import mean_squared_error\nr2_score(y_test, y_pred)","07d2cb6c":"import math\nmath.sqrt(mean_squared_error(y_test, y_pred))","f052ef58":"x_test_new = x_test.copy()\nx_test_new[\"Potential\"] = y_test\nx_test_new[\"Predicted\"] = y_pred\nx_test_final = x_test_new.reset_index()\nx_test_final = x_test_final.drop(\"index\", axis = 1)\nx_test_final.head(20)","3ad41476":"### DATA EXPLORATION","12c01e25":"## MODELING","588145bd":"# FIFA 21","99fa3781":"## ETL"}}