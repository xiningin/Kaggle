{"cell_type":{"98875671":"code","091e696e":"code","14dd5180":"code","c7f87dfa":"code","614c3782":"code","3f9800ba":"code","21b5837b":"code","6891fadf":"code","ed1923ba":"code","4f423847":"code","8b43c431":"code","93957660":"code","b0271df0":"code","79aee6bd":"code","87e5f04e":"code","601c8393":"code","c0ab2380":"code","1b6bd8aa":"code","969ce784":"code","d848f822":"code","0810bf21":"code","f012315a":"code","97e8de8e":"code","13f9e721":"code","35d9c5fc":"code","109eda64":"code","343b4882":"code","afa0b5d0":"code","45a2634a":"code","5f1fb820":"code","b49e15af":"code","ffa6e1f2":"code","54e492d7":"code","eae3d46c":"code","e5f8d0f9":"code","7d9b0317":"code","dc935572":"code","3d645675":"code","d4830930":"code","d3abf27c":"code","d2c1c3f5":"code","a8bcbf0f":"code","637446f1":"code","fe769ca8":"code","5898e02d":"code","ff6769d5":"code","b5cf7b25":"code","d7ed55c5":"code","54747aad":"code","a77277ff":"code","6354765a":"code","ec2c6f1e":"code","cc441b30":"code","d81c7904":"code","c100bc04":"code","a4f1e425":"code","c48104c3":"code","91fae1f5":"code","cb52b48c":"code","d27278b9":"code","8e507083":"code","936fe3f3":"code","02c9180f":"code","f7186016":"code","efee2fc0":"code","6d63f769":"code","1b265e7e":"code","b28a0cd3":"code","2124cfbd":"code","f2484df7":"code","d638b725":"code","222bed44":"code","7ee0fc25":"code","e60f7937":"markdown","c7161fe5":"markdown","13ae8e6b":"markdown","fb787253":"markdown","a2b63be6":"markdown","a2353abd":"markdown","ebf4e9de":"markdown","9cd15821":"markdown","d86446ae":"markdown","fd374914":"markdown","e8f2530c":"markdown","9db8a54a":"markdown","23d66cc7":"markdown","4f14ac21":"markdown","2b35f84d":"markdown","fb455cd1":"markdown","0f05c902":"markdown","92c3e8e8":"markdown","de9fc222":"markdown","eac1cb2d":"markdown","55febc85":"markdown","778c2aa5":"markdown","ff05dd2a":"markdown","bc7d4fb3":"markdown","f3b8559c":"markdown","7718d459":"markdown","f60f3327":"markdown","dd85b2e7":"markdown","ca513037":"markdown","4bcc052f":"markdown","5d103b81":"markdown","de173736":"markdown","b3ae6e2a":"markdown","7c483d92":"markdown","a7896b2e":"markdown","610486a4":"markdown","7ef1fdaf":"markdown","d7c721ed":"markdown","e2e070e8":"markdown","e0bcf5f2":"markdown","6659c21c":"markdown","ae28f8f1":"markdown","289c6c38":"markdown","073f22d1":"markdown","9358baa1":"markdown","efb26956":"markdown","6a76c24a":"markdown","1e532d49":"markdown","9c99f6cf":"markdown","19f2187e":"markdown","ae55639a":"markdown","30484d1a":"markdown","8026b958":"markdown","eb7901a5":"markdown","cb2334a4":"markdown","9313b897":"markdown","1dd03f70":"markdown","7c4e3019":"markdown","6de9d2d5":"markdown","028c3534":"markdown","6daae5ec":"markdown","3c7ae6d9":"markdown","f82c7a1c":"markdown","5516dfde":"markdown","f047b960":"markdown","52cbb384":"markdown","b75ae29e":"markdown","7ce7ba7d":"markdown","55f9c6a9":"markdown"},"source":{"98875671":"!pip install chart-studio","091e696e":"# Importing libraries\n# check which ones you really need remove unused imports\nimport os\nimport warnings\nwarnings.filterwarnings('ignore')\nimport numpy as np \nimport pandas as pd\nimport matplotlib.pyplot as plt\nplt.style.use('fivethirtyeight') \n# Above is a special style template for matplotlib, highly useful for visualizing time series data\n%matplotlib inline\nfrom pylab import rcParams\nfrom plotly import tools\nimport chart_studio.plotly as py\nfrom plotly.offline import init_notebook_mode, iplot\ninit_notebook_mode(connected=True)\nimport plotly.graph_objs as go\nimport plotly.figure_factory as ff\nimport statsmodels.api as sm\nfrom numpy.random import normal, seed\nfrom scipy.stats import norm\nfrom statsmodels.tsa.arima_model import ARMA\nfrom statsmodels.tsa.stattools import adfuller\nfrom statsmodels.graphics.tsaplots import plot_acf, plot_pacf\nfrom statsmodels.tsa.arima_process import ArmaProcess\nfrom statsmodels.tsa.arima_model import ARIMA\nimport math\nfrom sklearn.metrics import mean_squared_error\nprint(os.listdir(\"..\/input\"))","14dd5180":"google = pd.read_csv('..\/input\/stock-time-series-20050101-to-20171231\/GOOGL_2006-01-01_to_2018-01-01.csv', index_col='Date', parse_dates=['Date'])\ngoogle.head()","c7f87dfa":"microsoft = pd.read_csv('..\/input\/stock-time-series-20050101-to-20171231\/MSFT_2006-01-01_to_2018-01-01.csv', index_col='Date', parse_dates=['Date'])\nmicrosoft.head()","614c3782":"humidity = pd.read_csv('..\/input\/historical-hourly-weather-data\/humidity.csv', index_col='datetime', parse_dates=['datetime'])\nhumidity.tail()","3f9800ba":"humidity = humidity.iloc[1:]\nhumidity = humidity.fillna(method='ffill')\nhumidity.head()","21b5837b":"humidity[\"Kansas City\"].asfreq('M').plot() # asfreq method is used to convert a time series to a specified frequency. Here it is monthly frequency.\nplt.title('Humidity in Kansas City over time(Monthly frequency)')\nplt.show()\n\n# Dip in 2014- Cold wave in NA","6891fadf":"google['2008':'2010'].plot(subplots=True, figsize=(10,12))\nplt.title('Google stock attributes from 2008 to 2010')\nplt.savefig('stocks.png')\nplt.show()","ed1923ba":"# Creating a Timestamp\ntimestamp = pd.Timestamp(2017, 1, 1, 12)\ntimestamp","4f423847":"# Creating a period\nperiod = pd.Period('2017-01-01')\nperiod","8b43c431":"# Checking if the given timestamp exists in the given period\nperiod.start_time < timestamp < period.end_time","93957660":"# Converting timestamp to period\nnew_period = timestamp.to_period(freq='H')\nnew_period","b0271df0":"new_period.start_time","79aee6bd":"new_period.end_time","87e5f04e":"# Converting period to timestamp\nnew_timestamp = period.to_timestamp(freq='H', how='start')\nnew_timestamp","601c8393":"# Creating a datetimeindex with daily frequency\ndr1 = pd.date_range(start='1\/1\/18', end='1\/9\/18')\ndr1","c0ab2380":"# Creating a datetimeindex with monthly frequency\ndr2 = pd.date_range(start='1\/1\/18', end='1\/1\/19', freq='M')\ndr2","1b6bd8aa":"# Creating a datetimeindex without specifying start date and using periods\ndr3 = pd.date_range(end='1\/4\/2014', periods=8)\ndr3","969ce784":"# Creating a datetimeindex specifying start date , end date and periods\ndr4 = pd.date_range(start='2013-04-24', end='2014-11-27', periods=3)\ndr4","d848f822":"df = pd.DataFrame({'year': [2015, 2016], 'month': [2, 3], 'day': [4, 5]})\ndf","0810bf21":"df = pd.to_datetime(df)\ndf","f012315a":"df = pd.to_datetime('01-01-2017')\ndf","97e8de8e":"humidity[\"Vancouver\"].asfreq('M').plot(legend=True)\nshifted = humidity[\"Vancouver\"].asfreq('M').shift(10).plot(legend=True)\nshifted.legend(['Vancouver','Vancouver_lagged'])\nplt.show()","13f9e721":"# Let's use pressure data to demonstrate this\npressure = pd.read_csv('..\/input\/historical-hourly-weather-data\/pressure.csv', index_col='datetime', parse_dates=['datetime'])\npressure.tail()","35d9c5fc":"pressure = pressure.iloc[1:]\npressure = pressure.fillna(method='ffill')\npressure.tail()","109eda64":"pressure = pressure.fillna(method='bfill')\npressure.head()","343b4882":"# Shape before resampling(downsampling)\npressure.shape","afa0b5d0":"# We downsample from hourly to 3 day frequency aggregated using mean\npressure = pressure.resample('3D').mean()\npressure.head()","45a2634a":"# Shape after resampling(downsampling)\npressure.shape","5f1fb820":"pressure = pressure.resample('D').pad()\npressure.head()","b49e15af":"# Shape after resampling(upsampling)\npressure.shape","ffa6e1f2":"# Autocorrelation of humidity of San Diego\nplot_acf(humidity[\"San Diego\"],lags=35,title=\"San Diego\")\nplt.show()","54e492d7":"# Partial Autocorrelation of humidity of San Diego\nplot_pacf(humidity[\"San Diego\"],lags=25)\nplt.show()","eae3d46c":"# Partial Autocorrelation of closing price of microsoft stocks\nplot_pacf(microsoft[\"Close\"],lags=25)\nplt.show()","e5f8d0f9":"# Let's take Google stocks High for this\ngoogle[\"High\"].plot(figsize=(16,8))","7d9b0317":"# Now, for decomposition...\nrcParams['figure.figsize'] = 11, 9\ndecomposed_google_volume = sm.tsa.seasonal_decompose(google[\"High\"],freq=360) # The frequncy is annual\nfigure = decomposed_google_volume.plot()\nplt.show()","dc935572":"# Plotting white noise\nrcParams['figure.figsize'] = 16, 6\nwhite_noise = np.random.normal(loc=0, scale=1, size=1000)\n# loc is mean, scale is variance\nplt.plot(white_noise)","3d645675":"# Plotting autocorrelation of white noise\nplot_acf(white_noise,lags=20)\nplt.show()","d4830930":"# Augmented Dickey-Fuller test on volume of google and microsoft stocks \nadf = adfuller(microsoft[\"Volume\"])\nprint(\"p-value of microsoft: {}\".format(float(adf[1])))\nadf = adfuller(google[\"Volume\"])\nprint(\"p-value of google: {}\".format(float(adf[1])))","d3abf27c":"seed(42)\nrcParams['figure.figsize'] = 16, 6\nrandom_walk = normal(loc=0, scale=0.01, size=1000)\nplt.plot(random_walk)\nplt.show()","d2c1c3f5":"fig = ff.create_distplot([random_walk],['Random Walk'],bin_size=0.001)\nfig.show()\nrandom_walk_adf = adfuller(random_walk)\nprint(\"p-value of random_walk: {}\".format(float(random_walk_adf[1])))\n# iplot(fig, filename='Basic Distplot')","a8bcbf0f":"# The original non-stationary plot\ndecomposed_google_volume.trend.plot()","637446f1":"# The new stationary plot\ndecomposed_google_volume.trend.diff().plot()","fe769ca8":"# AR(1) MA(1) model:AR parameter = +0.9\nrcParams['figure.figsize'] = 16, 12\nplt.subplot(4,1,1)\nar1 = np.array([1, -0.9]) # We choose -0.9 as AR parameter is +0.9\nma1 = np.array([1])\nAR1 = ArmaProcess(ar1, ma1)\nsim1 = AR1.generate_sample(nsample=1000)\nplt.title('AR(1) model: AR parameter = +0.9')\nplt.plot(sim1)\n# We will take care of MA model later\n# AR(1) MA(1) AR parameter = -0.9\nplt.subplot(4,1,2)\nar2 = np.array([1, 0.9]) # We choose +0.9 as AR parameter is -0.9\nma2 = np.array([1])\nAR2 = ArmaProcess(ar2, ma2)\nsim2 = AR2.generate_sample(nsample=1000)\nplt.title('AR(1) model: AR parameter = -0.9')\nplt.plot(sim2)\n# AR(2) MA(1) AR parameter = 0.9\nplt.subplot(4,1,3)\nar3 = np.array([2, -0.9]) # We choose -0.9 as AR parameter is +0.9\nma3 = np.array([1])\nAR3 = ArmaProcess(ar3, ma3)\nsim3 = AR3.generate_sample(nsample=1000)\nplt.title('AR(2) model: AR parameter = +0.9')\nplt.plot(sim3)\n# AR(2) MA(1) AR parameter = -0.9\nplt.subplot(4,1,4)\nar4 = np.array([2, 0.9]) # We choose +0.9 as AR parameter is -0.9\nma4 = np.array([1])\nAR4 = ArmaProcess(ar4, ma4)\nsim4 = AR4.generate_sample(nsample=1000)\nplt.title('AR(2) model: AR parameter = -0.9')\nplt.plot(sim4)\nplt.show()","5898e02d":"model = ARMA(sim1, order=(1,0))\nresult = model.fit()\nprint(result.summary())\nprint(\"\u03bc={} ,\u03d5={}\".format(result.params[0],result.params[1]))\n# how is \u03bc ,\u03d5 found out, which function is minimized or maximised? - minimising the rmse of value at time t and calculated value at t","ff6769d5":"# Predicting simulated AR(1) model \nresult.plot_predict(start=900, end=1010)\nplt.show()","b5cf7b25":"rmse = math.sqrt(mean_squared_error(sim1[900:1011], result.predict(start=900,end=999)))\nprint(\"The root mean squared error is {}.\".format(rmse))","d7ed55c5":"# Predicting humidity level of Montreal\nhumid = ARMA(humidity[\"Montreal\"].diff().iloc[1:].values, order=(1,0))\nres = humid.fit()\nres.plot_predict(start=1000, end=1100)\nplt.show()","54747aad":"rmse = math.sqrt(mean_squared_error(humidity[\"Montreal\"].diff().iloc[900:1000].values, result.predict(start=900,end=999)))\nprint(\"The root mean squared error is {}.\".format(rmse))","a77277ff":"# Predicting closing prices of google\nhumid = ARMA(google[\"Close\"].diff().iloc[1:].values, order=(1,0))\nres = humid.fit()\nres.plot_predict(start=900, end=1010)\nplt.show()","6354765a":"rcParams['figure.figsize'] = 16, 6\nar1 = np.array([1])\nma1 = np.array([1, -0.5])\nMA1 = ArmaProcess(ar1, ma1)\nsim1 = MA1.generate_sample(nsample=1000)\nplt.plot(sim1)","ec2c6f1e":"model = ARMA(sim1, order=(0,1))\nresult = model.fit()\nprint(result.summary())\nprint(\"\u03bc={} ,\u03b8={}\".format(result.params[0],result.params[1]))","cc441b30":"# Forecasting and predicting montreal humidity\nmodel = ARMA(humidity[\"Montreal\"].diff().iloc[1:].values, order=(0,3))\nresult = model.fit()\nprint(result.summary())\nprint(\"\u03bc={} ,\u03b8={}\".format(result.params[0],result.params[1]))\nresult.plot_predict(start=1000, end=1100)\nplt.show()","d81c7904":"rmse = math.sqrt(mean_squared_error(humidity[\"Montreal\"].diff().iloc[1000:1101].values, result.predict(start=1000,end=1100)))\nprint(\"The root mean squared error is {}.\".format(rmse))","c100bc04":"# Forecasting and predicting microsoft stocks volume\nmodel = ARMA(microsoft[\"Volume\"].diff().iloc[1:].values, order=(3,3))\nresult = model.fit()\nprint(result.summary())\nprint(\"\u03bc={}, \u03d5={}, \u03b8={}\".format(result.params[0],result.params[1],result.params[2]))\nresult.plot_predict(start=1000, end=1100)\nplt.show()","a4f1e425":"rmse = math.sqrt(mean_squared_error(microsoft[\"Volume\"].diff().iloc[1000:1101].values, result.predict(start=1000,end=1100)))\nprint(\"The root mean squared error is {}.\".format(rmse))","c48104c3":"# Predicting the microsoft stocks volume\nrcParams['figure.figsize'] = 16, 6\nmodel = ARIMA(microsoft[\"Volume\"].diff().iloc[1:].values, order=(2,1,0))\nresult = model.fit()\nprint(result.summary())\nresult.plot_predict(start=700, end=1000)\nplt.show()","91fae1f5":"rmse = math.sqrt(mean_squared_error(microsoft[\"Volume\"].diff().iloc[700:1001].values, result.predict(start=700,end=1000)))\nprint(\"The root mean squared error is {}.\".format(rmse))","cb52b48c":"google['Change'] = google.High.div(google.High.shift())\ngoogle['Change'].plot(figsize=(20,8))","d27278b9":"google['Return'] = google.Change.sub(1).mul(100)\ngoogle['Return'].plot(figsize=(20,8))","8e507083":"google.High.pct_change().mul(100).plot(figsize=(20,6)) # Another way to calculate returns","936fe3f3":"google.High.diff().plot(figsize=(20,6))","02c9180f":"# We choose microsoft stocks to compare them with google\nmicrosoft = pd.read_csv('..\/input\/stock-time-series-20050101-to-20171231\/MSFT_2006-01-01_to_2018-01-01.csv', index_col='Date', parse_dates=['Date'])","f7186016":"# Plotting before normalization\ngoogle.High.plot()\nmicrosoft.High.plot()\nplt.legend(['Google','Microsoft'])\nplt.show()","efee2fc0":"# Normalizing and comparison\n# Both stocks start from 100\nnormalized_google = google.High.div(google.High.iloc[0]).mul(100)\nnormalized_microsoft = microsoft.High.div(microsoft.High.iloc[0]).mul(100)\nnormalized_google.plot()\nnormalized_microsoft.plot()\nplt.legend(['Google','Microsoft'])\nplt.show()","6d63f769":"# Rolling window functions\nrolling_google = google.High.rolling('90D').mean()\ngoogle.High.plot()\nrolling_google.plot()\nplt.legend(['High','Rolling Mean'])\n# Plotting a rolling mean of 90 day window with original High attribute of google stocks\nplt.show()","1b265e7e":"# Expanding window functions\nmicrosoft_mean = microsoft.High.expanding().mean()\nmicrosoft_std = microsoft.High.expanding().std()\nmicrosoft.High.plot()\nmicrosoft_mean.plot()\nmicrosoft_std.plot()\nplt.legend(['High','Expanding Mean','Expanding Standard Deviation'])\nplt.show()","b28a0cd3":"# OHLC chart of June 2008\ntrace = go.Ohlc(x=google['06-2008'].index,\n                open=google['06-2008'].Open,\n                high=google['06-2008'].High,\n                low=google['06-2008'].Low,\n                close=google['06-2008'].Close)\ndata = [trace]\niplot(data, filename='simple_ohlc')","2124cfbd":"# OHLC chart of 2008\ntrace = go.Ohlc(x=google['2008'].index,\n                open=google['2008'].Open,\n                high=google['2008'].High,\n                low=google['2008'].Low,\n                close=google['2008'].Close)\ndata = [trace]\niplot(data, filename='simple_ohlc')","f2484df7":"# OHLC chart of 2008\ntrace = go.Ohlc(x=google.index,\n                open=google.Open,\n                high=google.High,\n                low=google.Low,\n                close=google.Close)\ndata = [trace]\niplot(data, filename='simple_ohlc')","d638b725":"# Candlestick chart of march 2008\ntrace = go.Candlestick(x=google['03-2008'].index,\n                open=google['03-2008'].Open,\n                high=google['03-2008'].High,\n                low=google['03-2008'].Low,\n                close=google['03-2008'].Close)\ndata = [trace]\niplot(data, filename='simple_candlestick')","222bed44":"# Candlestick chart of 2008\ntrace = go.Candlestick(x=google['2008'].index,\n                open=google['2008'].Open,\n                high=google['2008'].High,\n                low=google['2008'].Low,\n                close=google['2008'].Close)\ndata = [trace]\niplot(data, filename='simple_candlestick')","7ee0fc25":"# Candlestick chart of 2006-2018\ntrace = go.Candlestick(x=google.index,\n                open=google.Open,\n                high=google.High,\n                low=google.Low,\n                close=google.Close)\ndata = [trace]\niplot(data, filename='simple_candlestick')","e60f7937":"## Forecasting the simulated MA model","c7161fe5":"### Generating a random walk","13ae8e6b":"Taking the slight lag into account, this is a fine model.","fb787253":"# <a id='0'>Time Series Analysis<\/a>\n<a href='#1'>1. What is time series data?<\/a><br>\n<a href='#2'>2. Overview of problems where time series is used.<\/a><br>\n<a href='#3'>3. Learning through code!<\/a><br>\n","a2b63be6":"## <a id='3.3.1'>3.3.1 AR models<\/a>\n An autoregressive (AR) model is a representation of a type of random process; as such, it is used to describe certain time-varying processes in nature, economics, etc. The autoregressive model specifies that the output variable depends linearly on its own previous values and on a stochastic term (an imperfectly predictable term); thus the model is in the form of a stochastic difference equation.\n #### AR(1) model\n R<sub>t<\/sub> = \u03bc + \u03d5R<sub>t-1<\/sub> + \u03b5<sub>t<\/sub>\n ##### As RHS has only one lagged value(R<sub>t-1<\/sub>)this is called AR model of order 1 where \u03bc is mean and \u03b5 is noise at time t\n If \u03d5 = 1, it is random walk. Else if \u03d5 = 0, it is white noise. Else if -1 < \u03d5 < 1, it is stationary. If \u03d5 is -ve, there is mean reversion. If \u03d5 is +ve, there is momentum.\n #### AR(2) model\n R<sub>t<\/sub> = \u03bc + \u03d5<sub>1<\/sub>R<sub>t-1<\/sub> + \u03d5<sub>2<\/sub>R<sub>t-2<\/sub> + \u03b5<sub>t<\/sub>\n #### AR(3) model\n R<sub>t<\/sub> = \u03bc + \u03d5<sub>1<\/sub>R<sub>t-1<\/sub> + \u03d5<sub>2<\/sub>R<sub>t-2<\/sub> + \u03d5<sub>3<\/sub>R<sub>t-3<\/sub> + \u03b5<sub>t<\/sub>","a2353abd":"## <a href='#3'>3. Learning through code!<\/a>\n- <a href='#3.1'>3.1. Introduction to date and time<\/a>\n    - <a href='#3.1.1'>3.1.1 Importing time series data<\/a>\n    - <a href='#3.1.2'>3.1.2 Cleaning and preparing time series data<\/a>\n    - <a href='#3.1.3'>3.1.3 Visualizing the datasets<\/a>\n    - <a href='#3.1.4'>3.1.4 Timestamps and Periods<\/a>\n    - <a href='#3.1.5'>3.1.5 Using date_range<\/a>\n    - <a href='#3.1.6'>3.1.6 Using to_datetime<\/a>\n    - <a href='#3.1.7'>3.1.7 Shifting and lags<\/a>\n    - <a href='#3.1.8'>3.1.8 Resampling<\/a>\n- <a href='#3.2'>3.2. Important Properties of Time Series<\/a>\n    - <a href='#3.2.1'>3.2.1 Autocorrelation and Partial Autocorrelation<\/a>\n    - <a href='#3.2.2'>3.2.2 Trends, Seasonality and Noise<\/a>\n    - <a href='#3.2.3'>3.2.3 White Noise<\/a>\n    - <a href='#3.2.4'>3.2.4 Random Walk<\/a>\n    - <a href='#3.2.5'>3.2.5 Stationarity<\/a>\n- <a href='#3.3'>3.3. Modelling using statsmodels<\/a>\n    - <a href='#3.3.1'>3.3.1 AR models<\/a>\n    - <a href='#3.3.2'>3.3.2 MA models<\/a>\n    - <a href='#3.3.3'>3.3.3 ARMA models<\/a>\n    - <a href='#3.3.4'>3.3.4 ARIMA models<\/a>\n- <a href='#3.4'>3.4. Finance and Statistics<\/a>\n    - <a href='#3.4.1'>3.4.1 Percent change<\/a>\n    - <a href='#3.4.2'>3.4.2 Stock returns<\/a>\n    - <a href='#3.4.3'>3.4.3 Absolute change in successive rows<\/a>\n    - <a href='#3.4.4'>3.4.4 Comaring two or more time series<\/a>\n    - <a href='#3.4.5'>3.4.5 Window functions<\/a>\n    - <a href='#3.4.6'>3.4.6 OHLC charts<\/a>\n    - <a href='#3.4.7'>3.4.7 Candlestick charts<\/a>","ebf4e9de":"## <a id='3.1.1'> 3.1.1 Importing time series data<\/a>","9cd15821":" ## <a id='3.4.7'>3.4.7 Candlestick charts<\/a>\nThis type of chart is used as a trading tool to visualise and analyse the price movements over time for securities, derivatives, currencies, stocks, bonds, commodities, etc. Although the symbols used in Candlestick Charts resemble a Box Plot, they function differently and therefore, are not to be confused with one another.\n\nCandlestick Charts display multiple bits of price information such as the open price, close price, highest price and lowest price through the use of candlestick-like symbols. Each symbol represents the compressed trading activity for a single time period (a minute, hour, day, month, etc). Each Candlestick symbol is plotted along a time scale on the x-axis, to show the trading activity over time.\n\nThe main rectangle in the symbol is known as the real body, which is used to display the range between the open and close price of that time period. While the lines extending from the bottom and top of the real body is known as the lower and upper shadows (or wick). Each shadow represents the highest or lowest price traded during the time period represented. When the market is Bullish (the closing price is higher than it opened), then the body is coloured typically white or green. But when the market is Bearish (the closing price is lower than it opened), then the body is usually coloured either black or red.\n\n<img src=\"https:\/\/datavizcatalogue.com\/methods\/images\/anatomy\/SVG\/candlestick_chart.svg\">\n\nCandlestick Charts are great for detecting and predicting market trends over time and are useful for interpreting the day-to-day sentiment of the market, through each candlestick symbol's colouring and shape. For example, the longer the body is, the more intense the selling or buying pressure is. While, a very short body, would indicate that there is very little price movement in that time period and represents consolidation.\n\nCandlestick Charts help reveal the market psychology (the fear and greed experienced by sellers and buyers) through the various indicators, such as shape and colour, but also by the many identifiable patterns that can be found in Candlestick Charts. In total, there are 42 recognised patterns that are divided into simple and complex patterns. These patterns found in Candlestick Charts are useful for displaying price relationships and can be used for predicting the possible future movement of the market. You can find a list and description of each pattern here.\n\nPlease bear in mind, that Candlestick Charts don't express the events taking place between the open and close price - only the relationship between the two prices. So you can't tell how volatile trading was within that single time period.\n\nSource: [Datavizcatalogue](https:\/\/datavizcatalogue.com\/methods\/candlestick_chart.html)","d86446ae":"Again an increase in number of rows. Resampling is cool when used properly.","fd374914":"Much less rows are left. Now, we will upsample from 3 day frequency to daily frequency","e8f2530c":"You can clearly see how google outperforms microsoft over time.","9db8a54a":"### What are timestamps and periods and how are they useful?\nTimestamps are used to represent a point in time. Periods represent an interval in time. Periods can used to check if a specific event in the given period. They can also be converted to each other's form.","23d66cc7":"## <a id='3.2.2'>3.2.2. Trends, seasonality and noise<\/a>\nThese are the components of a time series\n* Trend - Consistent upwards or downwards slope of a time series\n* Seasonality - Clear periodic pattern of a time series(like sine funtion)\n* Noise - Outliers or missing values","4f14ac21":"## <a id='3.1.4'>3.1.4 Timestamps and Periods<\/a>","2b35f84d":" Not quite impressive. But let's try google stocks. ","fb455cd1":"## <a href='#1'>1. What is time series data?<\/a>\nTime series data, also referred to as time-stamped data, is a sequence of data points indexed in time order. Time-stamped is data collected at different points in time. These data points typically consist of successive measurements made from the same source over a time interval and are used to track change over time.\n\nThis kind of data if you look closely is everywhere, with more and more sensors and trackers in our everyday systems ranging from weather data, heart rate monitors, fitness trackers, health and metric logs of servers and many more.\n\nAs a rule of thumb any sequential data which is changing with time can be called time series data. Although it is a generalisation with other categories present like cross-sectional and panel data, for sake of simplicity we will call them time series data. Attaching a resource for more information.","0f05c902":"# <a id='3.3'>3.3. Modelling using statstools<\/a>","92c3e8e8":"## Prediction using ARIMA model","de9fc222":"## <a id='3.4.6'>3.4.6 OHLC charts<\/a>\nAn OHLC chart is any type of price chart that shows the open, high, low and close price of a certain time period. Open-high-low-close Charts (or OHLC Charts) are used as a trading tool to visualise and analyse the price changes over time for securities, currencies, stocks, bonds, commodities, etc. OHLC Charts are useful for interpreting the day-to-day sentiment of the market and forecasting any future price changes through the patterns produced.\n\nThe y-axis on an OHLC Chart is used for the price scale, while the x-axis is the timescale. On each single time period, an OHLC Charts plots a symbol that represents two ranges: the highest and lowest prices traded, and also the opening and closing price on that single time period (for example in a day). On the range symbol, the high and low price ranges are represented by the length of the main vertical line. The open and close prices are represented by the vertical positioning of tick-marks that appear on the left (representing the open price) and on right (representing the close price) sides of the high-low vertical line.\n\nColour can be assigned to each OHLC Chart symbol, to distinguish whether the market is \"bullish\" (the closing price is higher then it opened) or \"bearish\" (the closing price is lower then it opened).\n\n<img src=\"https:\/\/datavizcatalogue.com\/methods\/images\/anatomy\/SVG\/OHLC_chart.svg\">\n\nSource: [Datavizcatalogue](https:\/\/datavizcatalogue.com\/methods\/OHLC_chart.html)","eac1cb2d":"## Simulating MA(1) model","55febc85":"## <a id='3.2.1'>3.2.1 Autocorrelation and Partial Autocorrelation<\/a>\n* Autocorrelation - The autocorrelation function (ACF) measures how a series is correlated with itself at different lags.\n* Partial Autocorrelation - The partial autocorrelation function can be interpreted as a regression of the series against its past lags.  The terms can be interpreted the same way as a standard  linear regression, that is the contribution of a change in that particular lag while holding others constant. \n\nSource: [Quora](https:\/\/www.quora.com\/What-is-the-difference-among-auto-correlation-partial-auto-correlation-and-inverse-auto-correlation-while-modelling-an-ARIMA-series)","778c2aa5":"## <a id='3.3.2'>3.3.2 MA models<\/a>\nThe moving-average (MA) model is a common approach for modeling univariate time series. The moving-average model specifies that the output variable depends linearly on the current and various past values of a stochastic (imperfectly predictable) term.\n#### MA(1) model\nR<sub>t<\/sub> = \u03bc  +  \u03f5<sub>t<\/sub>1 + \u03b8\u03f5<sub>t-1<\/sub>\n\nIt translates to Today's returns = mean + today's noise + yesterday's noise\n##### As there is only 1 lagged value in RHS, it is an MA model of order 1","ff05dd2a":"# <a id='3.2'>3.2. Important Properties of Time Series<\/a>","bc7d4fb3":"We will compare 2 time series by normalizing them. This is achieved by dividing each time series element of all time series by the first element. This way both series start at the same point and can be easily compared.","f3b8559c":"Now, for ARMA models.\n\n## <a id='3.3.3'>3.3.3 ARMA models<\/a>\nAutoregressive\u2013moving-average (ARMA) models provide a parsimonious description of a (weakly) stationary stochastic process in terms of two polynomials, one for the autoregression and the second for the moving average. It's the fusion of AR and MA models.\n### ARMA(1,1) model\n### R<sub>t<\/sub> = \u03bc + \u03d5R<sub>t-1<\/sub> + \u03f5<sub>t<\/sub> + \u03b8\u03f5<sub>t-1<\/sub> \nBasically, Today's return = mean + Yesterday's return + noise + yesterday's noise.","7718d459":"## Simulating AR(1) model","f60f3327":"\u03d5 is around 0.9 which is what we chose as AR parameter in our first simulated model.","dd85b2e7":"## <a id='3.2.3'>3.2.3. White noise<\/a>\nWhite noise has...\n* Constant mean\n* Constant variance\n* Zero auto-correlation at all lags","ca513037":"## <a id='3.4.5'>3.4.5 Window functions<\/a>\nWindow functions are used to identify sub periods, calculates sub-metrics of sub-periods.\n\n**Rolling** - Same size and sliding\n\n**Expanding** - Contains all prior values","4bcc052f":"## <a id='3.2.4'>3.2.4. Random Walk<\/a>\nA random walk is a mathematical object, known as a stochastic or random process, that describes a path that consists of a succession of random steps on some mathematical space such as the integers. \n\nIn general if we talk about stocks, Today's Price = Yesterday's Price + Noise\n\n# P<sub>t<\/sub> = P<sub>t-1<\/sub> + \u03b5<sub>t<\/sub> \n\nRandom walks can't be forecasted because well, noise is random.\n\nRandom Walk with Drift(drift(\u03bc) is zero-mean)\n#### P<sub>t<\/sub> - P<sub>t-1<\/sub> = \u03bc + \u03b5<sub>t<\/sub> \n<br>\nRegression test for random walk \n#### P<sub>t<\/sub> = \u03b1 + \u03b2P<sub>t-1<\/sub> + \u03b5<sub>t<\/sub>\n#### Equivalent to  P<sub>t<\/sub> - P<sub>t-1<\/sub> = \u03b1 + \u03b2P<sub>t-1<\/sub> + \u03b5<sub>t<\/sub>\n<br>\nTest:\n#### H<sub>0<\/sub>: \u03b2 = 1 (This is a random walk)\n#### H<sub>1<\/sub>: \u03b2 < 1 (This is not a random walk)\n<br>\nDickey-Fuller Test:\n#### H<sub>0<\/sub>: \u03b2 = 0 (This is a random walk)\n#### H<sub>1<\/sub>: \u03b2 < 0 (This is not a random walk)","5d103b81":"y is predicted plot. Quite neat!","de173736":"## <a id='3.1.6'>3.1.6 Using to_datetime<\/a> ","b3ae6e2a":"## <a id='3.4.4'>3.4.4 Comaring two or more time series<\/a> ","7c483d92":"## <a id='3.4.2'>3.4.2 Stock returns<\/a> ","a7896b2e":"## <a id='3.1.5'>3.1.5 Using date_range<\/a>","610486a4":"* There is clearly an upward trend in the above plot.\n* You can also see the uniform seasonal change.\n* Non-uniform noise that represent outliers and missing values","7ef1fdaf":"pandas.to_datetime() is used for converting arguments to datetime. Here, a DataFrame is converted to a datetime series.","d7c721ed":"# <a id='3.4'>3.4. Finance and statistics<\/a>","e2e070e8":"There are always better models.","e0bcf5f2":"## Prediction using ARMA models\nI am not simulating any model because it's quite similar to AR and MA models. Just  forecasting and predictions for this one.","6659c21c":"## Predicting the models","ae28f8f1":"Now, observe that rolling mean plot is a smoother version of the original plot.","289c6c38":"## Prediction using MA models","073f22d1":"Here, only 0th, 1st and 20th lag are statistically significant.","9358baa1":"## <a id='3.1.3'>3.1.3 Visualizing the datasets<\/a>","efb26956":"## Partial Autocorrelation","6a76c24a":"### What is date_range and how is it useful?\n**date_range** is a method that returns  a fixed frequency datetimeindex. It is quite useful when creating your own time series attribute for pre-existing data or arranging the whole data around the time series attribute created by you.","1e532d49":"## Autocorrelation","9c99f6cf":"## <a id='3.4.3'>3.4.3 Absolute change in successive rows<\/a>","19f2187e":"Sigh! A lot of cleaning is required.","ae55639a":"## <a id='3.2.5'>3.2.5 Stationarity<\/a>\nA stationary time series is one whose statistical properties such as mean, variance, autocorrelation, etc. are all constant over time.\n* Strong stationarity:  is a stochastic process whose unconditional joint probability distribution does not change when shifted in time. Consequently, parameters such as mean and variance also do not change over time.\n* Weak stationarity: is a process where mean, variance, autocorrelation are constant throughout the time\n\nStationarity is important as  non-stationary series that depend on time have too many parameters to account for when modelling the time series. diff() method can easily convert a non-stationary series to a stationary series.\n\nWe will try to decompose seasonal component of the above decomposed time series.","30484d1a":"## <a id='3.4.1'>3.4.1 Percent change<\/a>","8026b958":"## <a id='3.1.7'>3.1.7 Shifting and lags<\/a>","eb7901a5":"See how all lags are statistically insigficant as they lie inside the confidence interval(shaded portion).","cb2334a4":"We can shift index by desired number of periods with an optional time frequency. This is useful when comparing the time series with a past of itself","9313b897":"##### As microsoft has p-value 0.0003201525 which is less than 0.05, null hypothesis is rejected and this is not a random walk.\n##### Now google has p-value 0.0000006510 which is more than 0.05, null hypothesis is rejected and this is not a  random walk.","1dd03f70":"## <a href='#2'>2. Overview of problems where time series is used.<\/a>\n1. Stock prices and other economic indicators\n2. Weather data analysis and prediction( humidity, temperature prediction, storm analysis)\n3. Health and fitness tracking data( heart rate, human activity recognition)\n4. Transportation data( analysis of reasons for delay, performance and maintainance indicators analysis)\n5. Devops logs and health data( developing an AIOPS solution for use cases like anomaly detection, prediction of failures, distinguish between actual failures and warnings )\n6. Sports Analysis( player\/team form analysis, calculating performance ratings, predicting next match outcome)\n\n*Note* - .etc is implied in all these examples, also time series is just one step among many to properly analyse these problems<br><br>\nFind your next datasets here! - https:\/\/data.world\/datasets\/time-series","7c4e3019":"Though it is statistically signficant, partial autocorrelation after first 2 lags is very low.","6de9d2d5":"# Important properties of time series\n\n1. **Trend Component** - A trend is a long-run increase or decrease in a time series\n2. **Seasonal Component or Seasonality** - Seasonal Component refers to the repeating cycle over a specific period (such as week, month, etc.) in the time series. A seasonal pattern exists when a series is influenced by seasonal factors (e.g., the quarter of the year, the month, or day of the week). Seasonality is always of a fixed and known period. \n3. **Cyclical Component** - A cyclic pattern exists when data exhibit rises and falls that are not of fixed period. In general, the average length of cycles is longer than the length of a seasonal pattern, and the magnitude of cycles tends to be more variable than the magnitude of seasonal patterns.\n4. **Auto-correlation** - The autocorrelation function (ACF) measures how a series is correlated with itself at different lags.\n5. **Stationarity** - A time series is said to be stationary if its statistical properties do not change over time. In other words, it has constant mean and variance, and covariance is independent of time. Eg - White Noise","028c3534":"First, we used **ffill** parameter which propagates last valid observation to fill gaps. Then we use **bfill** to propogate next valid observation to fill gaps.","6daae5ec":"### How to import data?\nFirst, we import all the datasets needed for this kernel. The required time series column is imported as a datetime column using **parse_dates** parameter and is also selected as index of the dataframe using **index_col** parameter. \n#### Data being used:-\n1. Google  Stocks Data\n2. Humidity in different world cities\n3. Microsoft  Stocks Data\n3. Pressure in different world cities","3c7ae6d9":"## <a id='3.1.2'>3.1.2 Cleaning and preparing time series data<\/a>","f82c7a1c":"## <a id='3.3.4'>3.3.4 ARIMA models<\/a>\nAn autoregressive integrated moving average (ARIMA) model is a generalization of an autoregressive moving average (ARMA) model. Both of these models are fitted to time series data either to better understand the data or to predict future points in the series (forecasting). ARIMA models are applied in some cases where data show evidence of non-stationarity, where an initial differencing step (corresponding to the \"integrated\" part of the model) can be applied one or more times to eliminate the non-stationarity.\nARIMA model is of the form: ARIMA(p,d,q): p is AR parameter, d is differential parameter, q is MA parameter\n### ARIMA(1,0,0)\n**y<sub>t<\/sub> = a<sub>1<\/sub>y<sub>t-1<\/sub> + \u03f5<sub>t<\/sub>**\n### ARIMA(1,0,1)\n**y<sub>t<\/sub> = a<sub>1<\/sub>y<sub>t-1<\/sub> + \u03f5<sub>t<\/sub> + b<sub>1<\/sub>\u03f5<sub>t-1<\/sub>**\n### ARIMA(1,1,1)\n**\u0394y<sub>t<\/sub> = a<sub>1<\/sub>\u0394y<sub>t-1<\/sub> + \u03f5<sub>t<\/sub> + b<sub>1<\/sub>\u03f5<sub>t-1<\/sub>** where **\u0394y<sub>t<\/sub> = y<sub>t<\/sub> - y<sub>t-1<\/sub>**","5516dfde":"## <a id='#3.1.8'>3.1.8 Resampling<\/a>\n**Upsampling** - Time series is resampled from low frequency to high frequency(Monthly to daily frequency). It involves filling or interpolating missing data\n\n**Downsampling** - Time series is resampled from high frequency to low frequency(Weekly to monthly frequency). It involves aggregation of existing data.\n","f047b960":" As all lags are either close to 1 or at least greater than the confidence interval, they are statistically significant.","52cbb384":"## Forecasting a simulated model","b75ae29e":"# Credits\n1. For code and notebook - https:\/\/www.kaggle.com\/thebrownviking20\/everything-you-can-do-with-a-time-series\n2. For timeseries definitions - https:\/\/www.influxdata.com\/what-is-time-series-data\/\n3. For timeseries properties - https:\/\/analyticsindiamag.com\/an-overview-of-autocorrelation-seasonality-and-stationarity-in-time-series-data\/ ; https:\/\/financetrain.com\/characteristics-of-time-series\/ ; https:\/\/www.dummies.com\/programming\/big-data\/data-science\/key-properties-of-a-time-series-in-data-analysis\/\n4. For time series models - https:\/\/online.stat.psu.edu\/stat510\/lesson\/1\/1.1 ; https:\/\/towardsdatascience.com\/the-complete-guide-to-time-series-analysis-and-forecasting-70d476bfe775","7ce7ba7d":"### Augmented Dickey-Fuller test\nAn augmented Dickey\u2013Fuller test (ADF) tests the null hypothesis that a unit root is present in a time series sample. It is basically Dickey-Fuller test with more lagged changes on RHS.","55f9c6a9":"### How to prepare data?\nGoogle stocks data doesn't have any missing values but humidity data does have its fair share of missing values. It is cleaned using **fillna()** method with **ffill** parameter which propagates last valid observation to fill gaps"}}