{"cell_type":{"50edfbb8":"code","ba307e2b":"code","c35735ba":"code","bec35b20":"code","8460b8ed":"code","0a6f3516":"code","b6a75946":"code","151978fb":"code","8da32781":"code","37abab5b":"code","7d65a8ca":"code","c7ecbe98":"code","220555e1":"code","c3afe580":"code","3d18052d":"code","257ff088":"code","ba729890":"code","373ed14e":"code","15f056d3":"code","97f35fce":"code","6940acc1":"code","30008288":"code","357f847a":"code","379575b2":"code","a8d275c9":"code","0d526789":"code","3d2bd8c6":"markdown"},"source":{"50edfbb8":"import numpy as np\nimport pandas as pd\n\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.model_selection import train_test_split\n\n\nfrom sklearn.metrics import mean_absolute_error\nfrom sklearn.metrics import mean_squared_error\nfrom sklearn.metrics import mean_squared_log_error","ba307e2b":"Xtest = pd.read_csv(\"..\/input\/test.csv\", parse_dates = [\"pickup_datetime\"], index_col=0)\nXtest.head()","c35735ba":"# parse_dates\n\ndf = pd.read_csv(\"..\/input\/train.csv\", parse_dates = [\"pickup_datetime\", \"dropoff_datetime\"], index_col=0)\ndf.head()","bec35b20":"df.shape","8460b8ed":"print(df.isnull().sum())","0a6f3516":"df.info()","b6a75946":"df.describe()","151978fb":"df.head()","8da32781":"# Extract dates sur test\n\n\nXtest.loc[:,'pickup_dayofweek'] = Xtest['pickup_datetime'].dt.dayofweek\nXtest.loc[:,'pickup_dayofyear'] = Xtest['pickup_datetime'].dt.dayofyear\nXtest.loc[:,'pickup_hour'] = Xtest['pickup_datetime'].dt.hour\nXtest.loc[:,'pickup_month'] = Xtest['pickup_datetime'].dt.month","37abab5b":"# Extract dates sur train\n\ndf.loc[:,'pickup_dayofweek'] = df['pickup_datetime'].dt.dayofweek\ndf.loc[:,'pickup_dayofyear'] = df['pickup_datetime'].dt.dayofyear\ndf.loc[:,'pickup_hour'] = df['pickup_datetime'].dt.hour\ndf.loc[:,'pickup_month'] = df['pickup_datetime'].dt.month\nDates = ['pickup_dayofweek', 'pickup_dayofyear', 'pickup_hour', 'pickup_month']\nX_dates = df[Dates]\nX_dates.head()","7d65a8ca":"# transform store&flag sur test et train\n\nXtest['flag'] = np.where(Xtest['store_and_fwd_flag']=='N', 0, 1)\nXtest.drop(['store_and_fwd_flag'], axis = 1)\n\n#df[\"store_and_fwd_flag\"]\ndf['flag'] = np.where(df['store_and_fwd_flag']=='N', 0, 1)\ndf.drop(['store_and_fwd_flag'], axis = 1)\ndf.head()","c7ecbe98":"#\u00a0Selected_variables test\n\nNum_Var = ['passenger_count', 'pickup_longitude', 'pickup_latitude', 'dropoff_longitude', 'dropoff_latitude', 'flag']\n\ntest = Xtest[Num_Var + Dates]\ntest.head()\n#\"vendor_id\", \"passenger_id\", \"pickup_longitude\", \"pickup_latitude\", \"dropoff_longitude\", \"dropoff_latitude\", \"trip_duration\"","220555e1":"test.columns","c3afe580":"#\u00a0Selected_variables\n\nNum_Var = ['passenger_count', 'pickup_longitude', 'pickup_latitude', 'dropoff_longitude', 'dropoff_latitude', 'flag']\nX_num = df[Num_Var]\n\nX = df[Num_Var + Dates]\nX.head()\n#\"vendor_id\", \"passenger_id\", \"pickup_longitude\", \"pickup_latitude\", \"dropoff_longitude\", \"dropoff_latitude\", \"trip_duration\"","3d18052d":"y = df['trip_duration']\ny.head()","257ff088":"# On subset\n\nX_train, X_testing, y_train, y_testing = train_test_split(X,y, test_size=0.01, random_state=42)\nX_train.shape, X_testing.shape, y_train.shape, y_testing.shape","ba729890":"y_train = np.log(y_train)\ny_train.head()","373ed14e":"# rf parameters\n\nrf = RandomForestRegressor(random_state=42, n_estimators=10)","15f056d3":"# training\nrf.fit(X_train, y_train)","97f35fce":"# pred = rf.predict(X_train)","6940acc1":"y_pred = rf.predict(test)\n","30008288":"test_id = pd.read_csv(\"..\/input\/test.csv\", parse_dates = [\"pickup_datetime\"])\ntest_id.head()","357f847a":"my_submission = pd.DataFrame({'id': test_id.id, 'trip_duration': np.expm1(y_pred)})\nmy_submission.shape","379575b2":"my_submission.to_csv('submission.csv',index=False)","a8d275c9":"# benchmark MSE:  0.1736042975124673\n# loss\n#cv_losses = - cross_val_score(rf, X_train, y_train, cv=5, scoring = \"neg_mean_squared_error\")\n#cv_losses","0d526789":"# benchmark [0.33777047 0.33648306 0.33589602 0.33641725 0.33700657]\n# 10% [0.69064132 0.67015777 0.67540274 0.67913618 0.67750758]\n# 90% [0.42467579 0.42089421 0.4258463  0.41847506 0.42417022]\n#for i in range(len(cv)):\n#    cv[i] = np.sqrt((cv[i])\n#print(cv)","3d2bd8c6":"## Modeling"}}