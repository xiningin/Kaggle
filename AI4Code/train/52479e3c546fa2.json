{"cell_type":{"7789dded":"code","00b02e3e":"code","31c69d10":"code","ae61efc8":"code","1bf48ff3":"code","f734cea3":"code","d6afc88f":"code","3849bce0":"code","1dac5947":"code","aa3f866f":"code","e1f7b40e":"markdown"},"source":{"7789dded":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport pandas_profiling\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('..\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","00b02e3e":"cgb = pd.read_csv('..\/input\/miniwiki\/countries-government-budget.csv')\ncgb.tail()","31c69d10":"cgb.rename(columns={\n    'Rank': 'rank',\n    'Country': 'country',\n    'Revenues': 'revenues',\n    'Expenditures': 'expenditures',\n    'Surplus (or deficit)': 'Surplus_or_deficit',\n    'Surplus percentage of GDP': 'Surplus_per_GDP',\n    'Year': 'year'\n}, inplace=True)","ae61efc8":"cgb.replace({'-': None}, inplace = True)\n\ncgb.dropna(subset=['rank'], how= 'any', inplace=True)\n\ncgb_2017 = cgb[cgb['year'].str.contains('2017')]\n\ncgb_2017 = cgb_2017.iloc[:,:-1]\n\ncgb_2017.Surplus_per_GDP = cgb_2017.Surplus_per_GDP.str.replace('%', '')\n\n \ncgb_2017['Surplus_or_deficit'].replace(',','.', regex=True , inplace= True)\ncgb_2017['Surplus_or_deficit'].replace('\u2212','-', regex=True , inplace= True)\ncgb_2017['Surplus_per_GDP'].replace(',','.', regex=True , inplace= True)\ncgb_2017['Surplus_per_GDP'].replace('\u2212','-', regex=True , inplace= True)\ncgb_2017.replace({'-': None}, inplace = True)\ncgb_2017.dropna(subset=['Surplus_per_GDP'], how= 'any', inplace=True)\n","1bf48ff3":"cgb_2017.astype({'rank':'int32',\n                 'revenues':'float32',\n                 'expenditures':'float32',\n                 'Surplus_or_deficit':'float32',\n                 'Surplus_per_GDP':'float32'}).dtypes","f734cea3":"#missing data\ntotal = cgb_2017.isnull().sum().sort_values(ascending=False)\npercent = (cgb_2017.isnull().sum()\/cgb_2017.isnull().count()).sort_values(ascending=False)\nmissing_data = pd.concat([total, percent], axis=1, keys=['Total', 'Percent'])\nmissing_data.head(20)","d6afc88f":"pandas_profiling.ProfileReport(cgb_2017)","3849bce0":"import os\nif not os.path.exists('..\/'):\n    os.makedirs('..\/')\n    print('output create')\nelse:\n    print('exst')\nfor dirname, _, filenames in os.walk('..\/'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","1dac5947":"cgb_2017.to_csv('..\/output\/countries-government-budget_2017.csv', index=False)","aa3f866f":"cgb_test = pd.read_csv('..\/output\/countries-government-budget_2017.csv')\ncgb_test","e1f7b40e":"# Missing data"}}