{"cell_type":{"1a4856a1":"code","fa1592de":"code","1dd496c8":"code","c2cc3452":"code","46a73dfb":"code","6181bbb8":"code","ff0376e9":"code","8c76dd98":"code","245a0be2":"code","03242c0c":"code","832066f9":"code","c17ca3c3":"code","a448d892":"code","168a6360":"code","f1c468c9":"code","612c975e":"code","fb6d3e0a":"code","8cc84cb6":"code","b10eca64":"code","efb5e4b7":"code","a61b1f4a":"markdown","f06e4c44":"markdown","d156a3dd":"markdown","d735a94b":"markdown","5ff527ee":"markdown","1d2d9e68":"markdown","3255d8d2":"markdown","7369fc1d":"markdown","392bc46a":"markdown","641a3720":"markdown"},"source":{"1a4856a1":"import pandas as pd\nimport numpy as np","fa1592de":"import glob\n\npath = r'\/kaggle\/input\/cyclistic' \nall_files = glob.glob(path + \"\/*.csv\")\n\nli = []\n\nfor filename in all_files:\n    df = pd.read_csv(filename, index_col = None, header = 0)\n    li.append(df)\n\ndf_trips = pd.concat(li, axis = 0, ignore_index = True)\ndf_trips","1dd496c8":"#Check the descriptive statistics\ndf_trips.describe(include=\"all\")","c2cc3452":"#Check the data types of all columns\ndf_trips.dtypes","46a73dfb":"#Transform data type of starting time and ending time to datetime\n\ndf_trips['started_at'] = pd.to_datetime(df_trips['started_at'])\ndf_trips['ended_at'] = pd.to_datetime(df_trips['ended_at'])\n\nfrom datetime import datetime\n\n#Calculate trip length and store values into 'diff' array\ndiff = df_trips['ended_at'] - df_trips['started_at']\ndiff","6181bbb8":"#As could be observed from 'diff' array, the trip length from this dataset does not exceed 24 and often hover around half an hour.\n#Thus, trip length is measured in hours in the following calculation then stored in 'hour_length'\n\ndf_trips['trip_length'] = np.array((diff.dt.components.days*24 + diff.dt.components.hours).astype(str).str.zfill(2) + ':' + diff.dt.components.minutes.astype(str).str.zfill(2) + ':' + diff.dt.components.seconds.astype(str).str.zfill(2))\n\ndf_trips['trip_length'] = pd.to_datetime(df_trips['trip_length'], errors = 'coerce').dt.time\n\ndf_trips['hour_length'] = np.array((diff.dt.components.days*24 + diff.dt.components.hours) + diff.dt.components.minutes\/60 + diff.dt.components.seconds\/3600)\n\ndf_trips","ff0376e9":"#Create a column which indicates date of the week \n#We will use this array later to plot the trends of trip length and rideable types later on casual riders and member riders\n\ndf_trips['started_at'] = pd.to_datetime(df_trips['started_at'])\ndf_trips['day_of_week'] = df_trips['started_at'].dt.dayofweek\n\ndays = {0:'Mon',1:'Tues',2:'Wed',3:'Thur',4:'Fri',5:'Sat',6:'Sun'}\ndf_trips['day_of_week'] = df_trips['day_of_week'].apply(lambda x: days[x])\n\ndf_trips","8c76dd98":"#Eliminate all flawed records whose hour_length is less or equal to 0\n\ndf_trips = df_trips[-df_trips['hour_length']<=0]\n\ndf_trips","245a0be2":"#Extract initialising date of rides\ndf_trips['date_start'] = df_trips['started_at'].dt.date\ndf_trips","03242c0c":"#Import graphing packages\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set_theme(style = \"darkgrid\")\nsns.set(rc={\"figure.figsize\": (16, 8)})\nplt.rcParams['figure.dpi'] = 360","832066f9":"#Trends in number of rides during the year\n\n#Create a table demonstrating the number of rides based on date_start and membership status ('member_casual')\ndf_trips_copy = df_trips.copy()\ndf_trips_copy['count'] = 1\nlt_trend_1 = df_trips_copy.groupby(['date_start','member_casual'], as_index=False)['count'].sum()\n\n#Graph\n#In the graph, 'count' on y-axis indicates the number of rides\n\nplt.figure(figsize=(20,5))\nlt_plot_1 = sns.lineplot(x='date_start', y='count', hue='member_casual', palette = ['m', 'g'], data=lt_trend_1)\nlt_plot_1.set(title = 'Number of rides in a year')","c17ca3c3":"#Trends in number of ride length during the year\n\n#Create a table demonstrating the number of rides based on date_start and membership status ('member_casual')\n\nlt_trend_2 = df_trips_copy.groupby(['date_start','member_casual'], as_index=False)['hour_length'].mean()\n\n#Graph\n#In the graph, 'constant' on y-axis indicates the mean of trip length\n\nplt.figure(figsize=(20,5))\nlt_plot_2 = sns.lineplot(x='date_start', y='hour_length', hue='member_casual', palette = ['m', 'g'], data=lt_trend_2)\nlt_plot_2.set(title = 'Mean of ride length in a year')","a448d892":"#Distribution of trip length (hour_length) of the whole sample\n\n#Set the order of categorical variables\ndf_trips['day_of_week'] = pd.Categorical(df_trips['day_of_week'], categories=['Mon', 'Tues', 'Wed', 'Thur', 'Fri', 'Sat', 'Sun'], ordered=True)\n\n#Graph\nsum_plot = sns.catplot(x = 'day_of_week', y = 'hour_length', kind = 'boxen', palette = 'Pastel1', data = df_trips)\nsum_plot.set(ylim=(0, 2))\nsum_plot.set(title = 'Distribution of trip length')","168a6360":"#Distribution of trip length (hour_length) of riders with membership only\n\n#Extract 'member' type only to generate a plot\ndf_member = df_trips[df_trips['member_casual']=='member']\n\n#Order of categorical values\ndf_member['day_of_week'] = pd.Categorical(df_member['day_of_week'], categories=['Mon', 'Tues', 'Wed', 'Thur', 'Fri', 'Sat', 'Sun'], ordered=True)\n\n#Graph\nmember_plot = sns.catplot(x = 'day_of_week', y = 'hour_length', kind = 'boxen', palette = 'pastel', data = df_member)\nmember_plot.set(ylim=(0, 2))\nmember_plot.set(title = 'Distribution of trip length, member riders')","f1c468c9":"#Distribution of trip length (hour_length) of casual riders\n\n#Extract 'casual' type only to generate a plot\ndf_casual = df_trips[df_trips['member_casual']=='casual']\n\n#Order of categorical values\ndf_casual['day_of_week'] = pd.Categorical(df_casual['day_of_week'], categories=['Mon', 'Tues', 'Wed', 'Thur', 'Fri', 'Sat', 'Sun'], ordered=True)\n\n#Graph\ncasual_plot = sns.catplot(x = 'day_of_week', y = 'hour_length', kind = 'boxen', palette = 'pastel', data = df_casual)\ncasual_plot.set(ylim=(0, 2))\ncasual_plot.set(title = 'Distribution of trip length, casual riders')","612c975e":"comp_plot1 = sns.catplot(x='day_of_week', y='hour_length', kind = 'boxen', hue='member_casual', palette=['m', 'g'], data=df_trips)\ncomp_plot1.set(ylim=(0, 2))\ncomp_plot1.set(title = 'Trip length of different membership status categories')","fb6d3e0a":"comp_plot2 = sns.catplot(x = 'day_of_week', kind = 'count', hue = 'member_casual', palette = ['m', 'g'], data=df_trips)\ncomp_plot2.set(title = 'Number of trips initiated by casual and member riders, categorised by date of week')","8cc84cb6":"comp_plot3 = sns.catplot(x = 'day_of_week', kind = 'count', hue = 'rideable_type', palette = 'Pastel1', data=df_trips)\ncomp_plot3.set(title = 'Rideable bikes use, categorised by date of week')","b10eca64":"rideable_mem = sns.catplot(x = 'day_of_week', kind = 'count', hue = 'rideable_type', palette = 'Pastel1', data=df_member)\nrideable_mem.set(title = 'Rideable bikes use of members, categorised by date of week')","efb5e4b7":"rideable_casual = sns.catplot(x = 'day_of_week', kind = 'count', hue = 'rideable_type', palette = 'Pastel1', data=df_casual)\nrideable_casual.set(title = 'Rideable bikes use of casual riders, categorised by date of week')","a61b1f4a":"#### 1. Import relevant packages","f06e4c44":"#### 2. Aggregate all monthly files into a single dataframe, calculate trip length and create 'date_of_week' array","d156a3dd":"Patterns:\n- In casual rider groups, the ride length is longer on weekends than on weekdays.\n- Less dispersion is observed on member group than on casual group. \n- Casual riders tend to borrow bikes when they estimate the trip to be longer than usual. \n- Member riders tend to have a stable ride length during the week.","d735a94b":"#### Preference in rideable bikes","5ff527ee":"Pattern:\n- Ride counts tend to increase during the warm period of the year for both casual and member category.\n- The deviation of ride counts in member riders is fairly smaller than that in casual riders.\n- On average, the duration of casual ride is longer that of member ride.\n\nNow we investigate how trip length varies across dates of the week and rider types","1d2d9e68":"#### Trends of ride counts and ride length in the year","3255d8d2":"#### 3. Visualisation to find trends and patterns","7369fc1d":"#### Riding behavior patterns of riders","392bc46a":"Patterns:\n- Docked bike is the most commonly borrowed vehicle\n- (Need testing) Casual riders might be indifferent toward electric bikes and classic bikes\n","641a3720":"#### This small project is conducted in partial fulfillment of the Google Data Analytics Certificate.\n\n#### Background:\n\nCyclistic is a fictitious bike-share company in Chicago. The marketing department of Cyclistic wants to study the behavior of casual riders and annual members to obtain a higher conversion rate from casual-borrow to membership. Basing on such customer insight, the team will devise the proper marketing strategy.\n\n#### Dataset:\nCyclistic dataset (week 2, Google Data Analytics Capstone: Complete a case study)\n\nhttps:\/\/www.divvybikes.com\/data-license-agreement"}}