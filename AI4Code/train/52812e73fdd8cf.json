{"cell_type":{"d757274c":"code","f1a62a61":"markdown"},"source":{"d757274c":"search_string = \"Apr 2021\"\nimport numpy as np\nimport pandas as pd\nimport plotly.express as px\nimport warnings\nwarnings.filterwarnings('ignore')\n\ncomps = pd.read_csv('..\/input\/meta-kaggle\/Competitions.csv')\nour_competition  = comps[comps['Title'].str.contains(search_string,na=False)]\npd.set_option('display.max_columns', None)\n\nCompetitionId       = our_competition[\"Id\"].squeeze()\nCompetitionIndex    = our_competition.index.values.astype(int)[0]\nall_teams           = pd.read_csv('..\/input\/meta-kaggle\/Teams.csv')\nteams               = all_teams[all_teams['CompetitionId']==CompetitionId]\nteams               = teams.assign(Medal=teams.Medal.fillna(0).astype(int))\nCOLOR_DICT          = {0: 'deepskyblue', 1: 'gold', 2: 'silver', 3: 'chocolate'}\nMEDAL_NAMES         = np.asarray([\"None\", \"Gold\", \"Silver\", \"Bronze\"])\nMEDAL_COLORS        = dict(zip(MEDAL_NAMES, COLOR_DICT.values()))\nrow                 = comps.loc[CompetitionIndex]\nteams               = teams.assign(Medal=MEDAL_NAMES[teams.Medal])\n\n# remove any teams with NaN scores\nLB_ranks            = teams[['Id','TeamName','PublicLeaderboardRank','PrivateLeaderboardRank', 'PublicLeaderboardSubmissionId', 'PrivateLeaderboardSubmissionId']].dropna(axis=0, how='any')\n\n# read in the file with the score data\nSubmissions         = pd.read_csv('..\/input\/meta-kaggle\/Submissions.csv')\n\ndef get_pub_score(PublicLeaderboardSubmissionId):\n    pub  = Submissions.query('Id == @PublicLeaderboardSubmissionId').PublicScoreLeaderboardDisplay.values[0]\n    return(pub)\n\ndef get_priv_score(PrivateLeaderboardSubmissionId):\n    priv = Submissions.query('Id == @PrivateLeaderboardSubmissionId').PrivateScoreLeaderboardDisplay.values[0]\n    return(priv)\n\nLB_ranks['PublicLeaderboardScore']  = LB_ranks.apply(lambda x: get_pub_score(x['PublicLeaderboardSubmissionId']),axis=1)\nLB_ranks['PrivateLeaderboardScore'] = LB_ranks.apply(lambda x: get_priv_score(x['PrivateLeaderboardSubmissionId']),axis=1)\n\n# make a new dataframe for writing out\nLB_ranks_and_scores = (LB_ranks[['Id','TeamName', 'PublicLeaderboardRank', 'PublicLeaderboardScore', 'PrivateLeaderboardRank','PrivateLeaderboardScore']]).set_index('Id')\n\nfig = px.scatter(teams,\n                 title='Shakeup plot for: ' + row.Title,\n                 x='PublicLeaderboardRank',\n                 y='PrivateLeaderboardRank',\n                 hover_name='TeamName',\n                 hover_data=[\n                     'PublicLeaderboardRank',\n                     'PrivateLeaderboardRank',\n                     'Medal',\n                 ],\n                 color='Medal',\n                 color_discrete_map=MEDAL_COLORS)\nfig.update_traces(marker=dict(size=5))\nfig.update_layout(showlegend=False)\nfig.show()\n\n# save to a csv file\nLB_ranks_and_scores.to_csv(\"LB_ranks_and_scores.csv\", index=False)\n\n# Take a look at the Top 20 \nLB_ranks_and_scores.sort_values(by='PrivateLeaderboardRank', ascending=True).head(20)","f1a62a61":"# Synthanic shakeup scatterplot\n#### This is the [shakeup scatterplot](https:\/\/www.kaggle.com\/carlmcbrideellis\/shakeup-scatterplots-boxes-strings-and-things), and the 'Top 20' leaderboard, for the [Tabular Playground Series - Apr 2021 \"*Synthanic - You're going to need a bigger boat*\"](https:\/\/www.kaggle.com\/c\/tabular-playground-series-apr-2021) competition.\n***Note***: The complete Public-Private leaderboard can be found as a `csv` file in the **Output** section of this notebook."}}