{"cell_type":{"59f5ef73":"code","6f1b000b":"code","5fdcf794":"code","ae4296b4":"code","6bc7003f":"code","a66053e9":"code","c4ed11dc":"code","d1886df4":"code","3ef87aab":"code","db238b12":"code","d62a3564":"code","ea4ec2a1":"code","a49a838a":"code","9e33c09d":"code","dbbdc3c5":"code","bc67a619":"code","a302ae26":"code","6d814b1a":"code","3b2bd209":"code","28cec6fa":"code","aadaa63e":"code","43e1c5c4":"code","bfb5d600":"code","372273ad":"code","4faaedb7":"code","13d463fd":"code","a79f5912":"code","b0e7ef7f":"code","20211ae6":"code","94876229":"code","3329cf37":"code","0df44d98":"code","41fd9f53":"code","07f41863":"code","9bfb1a09":"code","26ea30b9":"code","04b30436":"code","5094b0dc":"code","d15b8824":"code","2bdc7229":"code","c86e7ba8":"code","9f67afde":"code","802285f9":"code","f52bad66":"code","2fcad361":"code","37ac37da":"code","73b4e3e5":"code","bc59853e":"code","430a8944":"code","cd91263a":"code","2b9d757e":"code","d9950b5a":"code","7fdb4dd8":"code","4113817a":"code","03108425":"code","8dc65a6f":"code","47d456fd":"code","32818fe4":"code","c6f29e1d":"code","01e405bd":"code","ce2b5186":"code","ee7ab151":"code","ae9cd469":"code","a7363d14":"code","4d340de0":"code","03ff9aba":"code","b024d455":"code","36a04db1":"code","d8c970bd":"code","140b99b0":"code","854c0548":"code","70ac3ac5":"code","929c557a":"code","b991f9fe":"code","9510d8a4":"code","d5e3be59":"code","9657d596":"code","370bc3f1":"code","7a5bbc05":"code","32bcda3e":"code","81de6ef2":"code","088c09f2":"code","08c7d7fe":"code","f6c08970":"code","5b775c71":"markdown","bef0c61f":"markdown","df6275d1":"markdown","b4a86d90":"markdown","73bb6d48":"markdown","787eb400":"markdown","06f02296":"markdown","e8d08f2d":"markdown","b5870a5e":"markdown","bea3f7ce":"markdown","133cc786":"markdown","34228c18":"markdown","64a50616":"markdown","cb353725":"markdown","44cd82c2":"markdown","3d4006ac":"markdown","998fad19":"markdown","d7a46591":"markdown","433c26b8":"markdown","3b7b47dd":"markdown","2936aefe":"markdown","b6395656":"markdown","859b7b88":"markdown","71ba7bab":"markdown","3e349a29":"markdown","8c929d72":"markdown","5eaa2f81":"markdown","7275a227":"markdown","fe08c140":"markdown","35f40edd":"markdown","7302423f":"markdown","59fa9ffc":"markdown","1647a026":"markdown","9b2d7efa":"markdown","2caeaed4":"markdown","2c2951b0":"markdown","7c888510":"markdown","9150576b":"markdown","eea681a6":"markdown","8e7d8f44":"markdown","3fb8a8cd":"markdown","10cd0156":"markdown","cabd036b":"markdown","ae0335bd":"markdown","d9cc1cd9":"markdown","8a4cdec9":"markdown","19161004":"markdown","8ad9b7b0":"markdown","f71c5212":"markdown","1135c22e":"markdown","d7d87e9d":"markdown","bf49945e":"markdown"},"source":{"59f5ef73":"# Importing the libraries\n%matplotlib inline\nimport matplotlib.pyplot as plt\nimport seaborn as sns; sns.set()  # for plot styling\nimport numpy as np\nimport pandas as pd\nfrom sklearn.metrics import f1_score, precision_score, recall_score, confusion_matrix, mean_squared_error, mean_absolute_error, explained_variance_score","6f1b000b":"data_titanic = pd.read_csv(r\"..\/input\/titanic\/train.csv\")\ndata_titanic.head(3)","5fdcf794":"data_titanic.isna().sum()","ae4296b4":"tita = data_titanic.drop([\"PassengerId\",\"Name\",\"Ticket\",\"Cabin\"], axis=1)\ntita.head()","6bc7003f":"tita.info","a66053e9":"tita.shape","c4ed11dc":"tita.dtypes","d1886df4":"tita.describe","3ef87aab":"tita.isna().sum()","db238b12":"tita2 = tita.dropna()\ntita2.head(2)","d62a3564":"tita2['Survived'].value_counts()","ea4ec2a1":"tita['Age'].nunique()","a49a838a":"# for heat maps, indexing \/ correaltions needs to be established\nplt.figure(figsize=(12,8))\ntc = data_titanic.corr()\nsns.heatmap(tc,cmap='coolwarm')\nplt.title('Correlation of figures in the Titanic Dataset')","9e33c09d":"tita_num = tita2.drop([\"Sex\",\"Embarked\"], axis=1)\ntita_num.head()","dbbdc3c5":"corr = tita_num.corr()\ncorr","bc67a619":"cat_corr = tita2.apply(lambda x : pd.factorize(x)[0]).corr(method='pearson', min_periods=1)\ncat_corr","a302ae26":"plt.figure(figsize=(14,8))\nsns.heatmap(corr, cmap='hot')","6d814b1a":"plt.figure(figsize=(14,8))\nsns.heatmap(cat_corr)","3b2bd209":"data_corr = cat_corr['Survived']\ngolden_features_list = data_corr[abs(data_corr) > 0.4].sort_values(ascending=False)\nprint(\"There is {} strongly correlated values with Survived Feature:\\n{}\".format(len(golden_features_list), golden_features_list))","28cec6fa":"plt.figure(figsize=(14,8))\nsns.heatmap(cat_corr[(cat_corr >= 0.2) | (cat_corr <= -0.1)], \n            cmap='viridis', vmax=1.0, vmin=-1.0, linewidths=0.1,\n            annot=True, annot_kws={\"size\": 8}, square=True);","aadaa63e":"cat_corr['Survived']","43e1c5c4":"plt.rc('font', size=12)\nplt.rc('axes', titlesize=18)\n\n\nplt.figure(figsize=(10,7))\ntita2.Survived.groupby(tita2.Sex).sum().plot(kind='pie')\n#plt.axis('equal')\nplt.title(\"Survival Percentages by Gender\")\nplt.show()","bfb5d600":"labels=np.array(['Pclass', 'SibSp','Parch'])\nstats=data_titanic.loc[386,labels].values","372273ad":"angles=np.linspace(0, 2*np.pi, len(labels), endpoint=False)\n# close the plot\nstats=np.concatenate((stats,[stats[0]]))\nangles=np.concatenate((angles,[angles[0]]))","4faaedb7":"plt.rc('font', size=12)\nplt.rc('axes', titlesize=18)\nfig=plt.figure(figsize=(10,10))\n\nax = fig.add_subplot(1,2,1, polar=True)\nax.plot(angles, stats, 'o-', linewidth=2)\nax.fill(angles, stats, alpha=0.25)\nax.set_thetagrids(angles * 180\/np.pi, labels)\nax.set_title([data_titanic.loc[386,\"Name\"]])\nax.grid(True)","13d463fd":"plt.figure(figsize=(8,4))\nsns.countplot(tita2['Embarked'], palette=\"Set1\")\nplt.title(\"Port of Embarkation\")","a79f5912":"tita2.head(2)","b0e7ef7f":"sns.pairplot(tita2, corner=True)","20211ae6":"plt.figure(figsize=(8,6))\nsns.distplot(tita2[\"Age\"], kde=False)\nplt.title(\"Age Distribution Aboard the Titanic\")","94876229":"f, axes = plt.subplots(1, 2, figsize=(12,5))\n\nsns.countplot(tita2['Parch'], orient='v', ax=axes[0])\naxes[0].title.set_text('Number of Parents and Children Aboard the Titanic')\n\nsns.countplot(tita2['SibSp'], orient='v', ax=axes[1])\naxes[1].title.set_text('# of siblings \/ spouses aboard the Titanic')\n\nf.tight_layout()","3329cf37":"sns.set(style=\"ticks\")\ntitanic = sns.load_dataset(\"titanic\")\nvariables = list(titanic.select_dtypes(include=[\"object\", \"bool\"]).drop([\"embarked\"], axis=1).columns)  \n\n#We have used the titanic dataset because it is formatted as needed for the boxplot\n\ntitanic","0df44d98":"titanic.select_dtypes(include=[\"object\", \"bool\"]).drop([\"embarked\"], axis=1)","41fd9f53":"plt.figure(figsize=(15,10))\n\nfor i, c in enumerate(variables, 1):\n    plt.subplot(2,3,i) \n    g = sns.boxplot(x=c, y=\"fare\",data=titanic.query(\"fare>0\"))\n    g.set(yscale=\"log\")","07f41863":"sns.set_style('whitegrid')\nsns.jointplot(x='Fare',y='Age',data=data_titanic)","9bfb1a09":"bins= [0,2,4,13,20,40, 110]\nlabels = ['Infant','Toddler','Kid','Teen','Adult', 'Adult-Adult']\ntitanic['AgeGroup'] = pd.cut(titanic['age'], bins=bins, labels=labels, right=False)\ntitanic.head(2)","26ea30b9":"ages_survive = pd.DataFrame(titanic['AgeGroup'].groupby(titanic['alive']).value_counts())\nages_survive = ages_survive.rename(columns = {'AgeGroup':'Age Group Number'})\nages_survive = ages_survive.reset_index()\nages_survive = ages_survive.rename(columns = {'AgeGroup':'Age Group',\"alive\":\"Survived?\"})\nages_survive","04b30436":"plt.figure(figsize=(12,8))\nsns.barplot(data = ages_survive, x = 'Age Group', y = 'Age Group Number', hue='Survived?', palette = 'rocket')","5094b0dc":"import plotly.express as px\n\nfig = px.treemap(ages_survive, path=['Survived?', 'Age Group'], values='Age Group Number',\n                  color='Age Group Number', hover_data=['Survived?'],\n                  color_continuous_scale='RdBu',\n                  )\nfig.show()","d15b8824":"ages_survive1=ages_survive[:6]\nages_survive1","2bdc7229":"ages_survive2=ages_survive[6:]\nages_survive2","c86e7ba8":"ages_survive['proportion %']=0\nfor i in range(5):\n    ages_survive['proportion %'][i]=(ages_survive1[\"Age Group Number\"][i]\/(ages_survive2[\"Age Group Number\"][i+6] + ages_survive1[\"Age Group Number\"][i])) * 100\n\nfor i in range(5):\n    ages_survive['proportion %'][i+6]=(ages_survive2[\"Age Group Number\"][i+6]\/(ages_survive2[\"Age Group Number\"][i+6] + ages_survive1[\"Age Group Number\"][i])) * 100","9f67afde":"from tabulate import tabulate\n\nprint(tabulate(ages_survive, tablefmt=\"pipe\", headers=ages_survive.columns))","802285f9":"sns.relplot(x=\"age\", y=\"fare\",kind=\"line\", hue=\"sex\", data=titanic, height=6, aspect=2.5)","f52bad66":"plt.figure(figsize=(12,8))\nsns.set_style('whitegrid')\nsns.distplot(data_titanic[\"Fare\"],kde=False) #without the kde","2fcad361":"plt.figure(figsize=(12,8))\nsns.boxplot(x='Pclass',y='Age',data=data_titanic)","37ac37da":"plt.figure(figsize=(12,8))\nsns.set_style('white')\nsns.swarmplot(x='class',y='age',data=titanic)","73b4e3e5":"g = sns.FacetGrid(data=data_titanic, col='Sex')\ng.map(sns.distplot, 'Age',kde=False)","bc59853e":"f, axes = plt.subplots(1, 2, figsize=(12,5))\n\nsns.violinplot(x=\"who\", y=\"fare\", data=titanic, ax=axes[0])\naxes[0].title.set_text('Fares for the Individual Gender Groups')\n\nsns.violinplot(x=\"who\", y=\"age\", data=titanic, scale=\"width\", pellete=\"Set3\", ax=axes[1])\naxes[1].title.set_text('Ages for the Respective Individual Gender Groups')\n\nf.tight_layout()","430a8944":"f, axes = plt.subplots(1, 2, figsize=(12,5))\n\nsns.violinplot(x=\"class\", y=\"fare\", hue=\"sex\", data=titanic, palette=\"muted\", ax=axes[0])\naxes[0].title.set_text('Comparing class, gender and fares')\n\nsns.violinplot(x=\"alive\", y=\"fare\", hue=\"sex\", data=titanic, palette=\"Set2\", ax=axes[1])\naxes[1].title.set_text('Comparing gender, fare and survival status')\n\nf.tight_layout()","cd91263a":"plt.figure(figsize=(12,7))\nsns.scatterplot(x=\"age\", y='fare', hue='class', data=titanic, size=\"class\", sizes=(20, 200),palette=\"Set2\",legend=\"full\")","2b9d757e":"g = sns.lmplot(x=\"age\", y=\"fare\", hue=\"sex\", palette=\"Set1\",data=titanic,markers=[\"o\", \"x\"],height=6,aspect=2)","d9950b5a":"plt.figure(figsize=(12,7))\nsns.distplot(titanic['fare'], vertical=True, kde=False)\nsns.catplot(x='alive', y= 'age',hue='sex',data=titanic,  kind='bar', ci=None)","7fdb4dd8":"tita_num.hist(figsize=(16, 20), bins=50, xlabelsize=8, ylabelsize=8)","4113817a":"alive_fare = pd.DataFrame(titanic['fare'].groupby(titanic['alive']).sum()).reset_index()\nalive_fare","03108425":"import plotly.express as px\n\nfig = px.bar(alive_fare, x='alive', y='fare', title=\"Fare--Survival Breakdown in Interactive Bar Chart\")\nfig.show()","8dc65a6f":"import squarify # (algorithm for treemap)\nplt.figure(figsize=(12,12))\nlabels=['Third Class','First Class','Second Class']\nsquarify.plot(sizes=titanic['class'].value_counts(), label=labels, alpha=0.75)\n\nplt.axis('off')\nplt.show()","47d456fd":"sns.catplot(x='alive', y= 'age',hue='sex',data=titanic,  kind='bar')","32818fe4":"import scipy.stats\n\ndef find_remove_outlier_iqr(data_sample):\n    q1 = np.percentile(data_sample, 25)\n    q3 = np.percentile(data_sample, 75)\n    \n    iqr = q3 - q1\n    \n    cutoff = iqr * 1.5\n    \n    lower, upper = q1-cutoff, q3+cutoff\n    \n    outliers =[]\n    outliers_removed = []\n    for x in data_sample:\n        if x < lower or x > upper:\n            outliers.append(x)\n        if x > lower and x < upper:\n            outliers_removed.append(x)\n    return outliers","c6f29e1d":"pd.set_option('display.max_rows', 500)\npd.set_option('display.max_columns', 500)\npd.set_option('display.width', 1000)\n\noutliers = find_remove_outlier_iqr(titanic[\"fare\"])\n\nout_df = titanic[titanic[\"fare\"].isin(outliers)]\nout_df.head(20)","01e405bd":"out_df.shape","ce2b5186":"out_df.describe()","ee7ab151":"#creating a dataframe without the outliers\nno_out_df = titanic[~titanic[\"fare\"].isin(outliers)]\nno_out_df.head()","ae9cd469":"no_out_df.describe()","a7363d14":"num_df3 = no_out_df.select_dtypes(include = ['float64', 'int64'])","4d340de0":"f, ax = plt.subplots(figsize=(12, 8))\nout_corr = num_df3.corr()\nsns.heatmap(out_corr,xticklabels=out_corr.columns.values,yticklabels=out_corr.columns.values)","03ff9aba":"out_corr","b024d455":"# correlation plot\nnum_df3.corrwith(num_df3.survived).plot.bar(figsize=(10,7),\n                                   title='Correlation with Response Variable',\n                                   grid = True)","36a04db1":"from sklearn.preprocessing import LabelEncoder, OneHotEncoder, StandardScaler\nimport sklearn.linear_model\nimport sklearn.ensemble\nfrom sklearn.svm import SVC\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.ensemble import VotingClassifier\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import AdaBoostClassifier\nfrom sklearn.ensemble import GradientBoostingClassifier","d8c970bd":"tita2['Log-Age']=np.log(tita2['Age'])\ntita2.head(2)","140b99b0":"var_mod = ['Pclass','Sex','Embarked']\nlab_enc = LabelEncoder()\n\nfor i in var_mod:\n    tita2[i] = lab_enc.fit_transform(tita2[i])","854c0548":"tita2.head(2)","70ac3ac5":"tita3 = pd.concat([tita2,pd.get_dummies(tita2['Sex'], prefix='gender')],axis=1)\ntita3.drop(['Sex'],axis=1, inplace=True)\ntita4 = pd.concat([tita3,pd.get_dummies(tita3['Pclass'], prefix='class')],axis=1)\ntita4.drop(['Pclass'],axis=1, inplace=True)\ntita5 = pd.concat([tita4,pd.get_dummies(tita4['Embarked'], prefix='Port')],axis=1)\ntita5.drop(['Embarked'],axis=1, inplace=True)","929c557a":"tita5.head()","b991f9fe":"X=tita5.loc[:, tita5.columns != 'Survived']\ny=tita5['Survived']","9510d8a4":"X.ndim","d5e3be59":"sc_X = StandardScaler()\nscaled_X = sc_X.fit_transform(X)","9657d596":"scaled_X","370bc3f1":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(scaled_X, y, test_size=0.25, random_state = 0)","7a5bbc05":"decision_model=DecisionTreeClassifier()\ndecision_model.fit(X_train,y_train)","32bcda3e":"estimator = []\nestimator.append(('cart',decision_model))\n\nsvm_model=SVC().fit(X_train,y_train)\nestimator.append(('svm',svm_model))\n\nlogmodel = LogisticRegression().fit(X_train,y_train)\nestimator.append(('logistic', logmodel))\n\nensemble = VotingClassifier(estimator)\nensemble.fit(X_train,y_train)","81de6ef2":"pred_dec=decision_model.predict(X_test)\n\nfrom sklearn.metrics import accuracy_score\naccuracy_score(y_test,pred_dec)","088c09f2":"svm_pred=svm_model.predict(X_test)\naccuracy_score(y_test,svm_pred)","08c7d7fe":"log_pred=logmodel.predict(X_test)\naccuracy_score(y_test,log_pred)","f6c08970":"Voting_pred=ensemble.predict(X_test)\naccuracy_score(y_test,Voting_pred)","5b775c71":"**Let us see if we get any better correlation without outliers... shall we?**","bef0c61f":"## Correlation Analysis (Using Heat Maps)","df6275d1":"**A little feature engineeering ain't a bad idea...**","b4a86d90":"### Boxplot","73bb6d48":"**Identification of Datatypes**","787eb400":"**Parent-Children:** The dataset defines family relations in this way...\n* Parent = mother, father\n* Child = daughter, son, stepdaughter, stepson\n* Some children travelled only with a nanny, therefore parch=0 for them.\n\n**Siblings-Spouse:** The dataset defines family relations in this way...\n* Sibling = brother, sister, stepbrother, stepsister\n* Spouse = husband, wife (mistresses and fianc\u00e9s were ignored)","06f02296":"**To get the count of those who survived (1) and those who didn't (0)**","e8d08f2d":"**OneHot Encoding**","b5870a5e":"There something to notice here: some folks paid an unusually high amount of money and they survived. Is this indicative of something?","bea3f7ce":"C = Cherbourg, Q = Queenstown, S = Southampton\n\nAnd so we see that the Southhampton port recorded a lot of embarkation.","133cc786":"### The Titanic Misfortune","34228c18":"### Radar Plot of a Single Individual aboard the Titanic","64a50616":"### Joint Plot","cb353725":"**Scaling**","44cd82c2":"The relational plot clearly shows the female paying higher fares in most instances, especially the women between 20 and 40.","3d4006ac":"**Heat Maps**","998fad19":"The histogram part of this joint plot is explicitly charted in the next two charts but, we can glean a few information from here. We see that the far prices gets skewed towards the lower prices between 0 and 100. And the folks between ages 17 and 40 paid the highest fares. **Did that affect survival odds?** We would see.","d7a46591":"we would employ the following **Ensemble Learners** - Logistic Regression, Decision Tree, Neural Network, SVM","433c26b8":"**We see that the mean age of the survivors was around 28 for female and a little lowe for the males with some standard deviation. Also, more younger female did not survive along more older men.**","3b7b47dd":"**Um... Nothing impressive.**\n\nAt this point we have explored the data enough. We can now go on to build our model.","2936aefe":"### Facet Grids","b6395656":"### Let's Talk Outliers","859b7b88":"# Importing Libraries, Loading and Viewing Dataset","71ba7bab":"**Statistical Summary of Numerical Variables**","3e349a29":"## Checking for Missing Values and Dropping Columns with over 60% Missing Values","8c929d72":"**We see that more young people were on Third Class, followed by Second Class and then First Class.**","5eaa2f81":"**Remember when I asked if the higher fares affected improved the odds of survival? I guess you got your answer. The Adult group paid higher, yet they suffered the most causalties.**","7275a227":"**To get the number of unique values**","fe08c140":"### Error Bars","35f40edd":"From the title, the reader must have deduced that the goal of putting this notebook together is to demonstrate some **exploratory data analysis** and key **visualizations** that drive critical insights in analytics and statistics, in detail. The reader made an accurate deduction if that is the case. \n\nToward the end there is the modelling bit, but that was added for the sake of completion. **The core reason behind this piece of work is to put a thorough EDA and visualization compendium in one notebook**. I hope it helps some scientist searching for a python implementation of some visualization.","7302423f":"### Distribution Plot","59fa9ffc":"### RelPlot","1647a026":"### Histogram & Bar Charts","9b2d7efa":"**This table finalizes our investigation into the Age Groups and the casualties recorded. We see that 61% of folks between 20 and 40 years did not survive; just a percent less than the number for the older population. There therefore isn't much impact of fare price on the chances of survival.**\n(Sherlock Holmes can off his hat now)","2caeaed4":"And the last Heat Map summarizes the correlations, in terms of the most significant features. I used a largy window, because the correlations are weak, but we can reduce it.","2c2951b0":"We see that more female passengers survived, despite having more male passengers aboard the ship. What could have caused this? **Have you watched the movie? :)**","7c888510":"\n\nLet us even go a step further to Use an **Interactive Tree Map** in expressing our latest finding. Just for the sake of visualization.","9150576b":"**We start by preprocessing our data**. It has to be in that format to make sense to the model.","eea681a6":"**... welcome the algorithms**","8e7d8f44":"![title](https:\/\/media.nationalgeographic.org\/assets\/photos\/000\/273\/27302_c0-41-990-701_r1050x700.jpg?d4ccf3044d9da0d0118103be3a76bd1319370847)\n\n\n****The steps involved in exploring and preprocessing data are:****\n        * Identification of variables and data types\n        * Analyzing the basic metrics\n        * Non-Graphical Univariate Analysis\n        * Graphical Univariate Analysis\n        * Bivariate Analysis\n        * Variable transformations\n        * Missing value treatment\n        * Outlier treatment\n        * Correlation Analysis\n        * Dimensionality Reduction\n\nIn the section of this notebook involving EDA, we leave out **Dimensionality Reduction**. It comes under preprocessing.","3fb8a8cd":"**We can take the tree map a step further by breaking down the blocks based on gender**","10cd0156":"## Non-Graphical Univariate Analysis","cabd036b":"### Scatter Plot \/ Bubble Plot","ae0335bd":"# Building Our Model","d9cc1cd9":"### Swarm Plot","8a4cdec9":"### Tree Map","19161004":"**Label Encoding**","8ad9b7b0":"# Visualizations and Further Exploration (Graphical Univariate Analysis)","f71c5212":"### Violin Plot","1135c22e":"**These are the outliers found using the Interquartile Range method. What could these outliers be attributed to?**","d7d87e9d":"**Let us look at the Numerical Variables**","bf49945e":"### LM Plot"}}