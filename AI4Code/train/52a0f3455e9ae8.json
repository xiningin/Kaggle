{"cell_type":{"1708ec22":"code","b37671ea":"code","29ae8230":"code","e009943a":"code","cc4b7540":"code","ac88ed17":"code","d576e4c0":"code","babedde9":"code","1a184a6b":"code","ba0f7cea":"code","56909c6a":"code","d3b88bbf":"code","f04fa0de":"code","304c2da5":"code","963f0513":"code","4d65e9ad":"code","0e41b132":"code","4b4d97df":"code","4927797e":"code","c2108613":"code","a1874a4e":"markdown"},"source":{"1708ec22":"\nimport tensorflow as tf\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt","b37671ea":"sale_data = pd.read_csv('..\/input\/competitive-data-science-predict-future-sales\/sales_train.csv', parse_dates=['date'])\nitems = pd.read_csv('..\/input\/competitive-data-science-predict-future-sales\/items.csv')\nitem_cat = pd.read_csv('..\/input\/competitive-data-science-predict-future-sales\/item_categories.csv')\ntest = pd.read_csv('..\/input\/competitive-data-science-predict-future-sales\/test.csv')\nshops = pd.read_csv('..\/input\/competitive-data-science-predict-future-sales\/shops.csv')\n","29ae8230":"def EDA(df):\n    print(\"-------df.head(5)-------\")\n    print(df.head(5))\n    print(\"-------INFO----------\")\n    print(df.info())\n    print(\"-------describe--------\")\n    print(df.describe())\n    print(\"-------data type-------\")\n    print(df.dtypes)\n    print(\"-------missing num-------\")\n    print(df.isna().sum())","e009943a":"EDA(sale_data)","cc4b7540":"dataset = sale_data.pivot_table(index=['shop_id', 'item_id'], values=['item_cnt_day'], columns=['date_block_num'],\n                                fill_value=0, aggfunc='sum')","ac88ed17":"dataset","d576e4c0":"dataset.reset_index(inplace=True)","babedde9":"dataset","1a184a6b":"dataset = pd.merge(test, dataset, on=['item_id', 'shop_id'], how='left')","ba0f7cea":"dataset","56909c6a":"dataset.fillna(0, inplace=True)","d3b88bbf":"dataset","f04fa0de":"dataset.drop(['shop_id', 'item_id', 'ID'], inplace=True, axis=1)\ndataset\n","304c2da5":"x_train = np.expand_dims(dataset.values[:, :-1], axis=2)\ny = dataset.values[:, -1:]\n\nx_test = np.expand_dims(dataset.values[:, 1:], axis=2)\n\nprint(x_train.shape, y.shape, x_test.shape)","963f0513":"model = tf.keras.Sequential([\n    tf.keras.layers.LSTM(64, input_shape=(x_train.shape[1], x_train.shape[2]),\n                         return_sequences=True),\n    tf.keras.layers.LSTM(128, return_sequences=True),\n    tf.keras.layers.LSTM(32),\n    tf.keras.layers.Dropout(0.3),\n    tf.keras.layers.Dense(1, activation='relu')\n])\n","4d65e9ad":"model.summary()\nmodel.compile(loss='mse', optimizer='adam', metrics=['mean_squared_error'])","0e41b132":"history = model.fit(x_train, y, epochs=10, batch_size=256)\n","4b4d97df":"predictions = model.predict(x_test)","4927797e":"import csv\n\nwith open('sample_submission.csv', 'w')as f:\n    writer = csv.writer(f)\n    writer.writerow(['ID', 'item_cnt_month'])\n    for i in range(214200 - 1):\n        writer.writerow([i, predictions[i][0]])","c2108613":"predictions","a1874a4e":"### load data"}}