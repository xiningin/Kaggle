{"cell_type":{"687175ea":"code","4fd5e112":"code","d8c83eb9":"code","956be11c":"code","7ab8874a":"code","31aef212":"code","98c046ec":"code","d13cd930":"code","86769c73":"code","72252694":"code","d3aedba1":"code","577cfc1d":"code","7c8ec82a":"code","a453a0d2":"code","e911c244":"code","dc722612":"code","0f7c78c6":"code","2d8540ef":"code","361066bd":"code","85fbbeb8":"code","8ef1e780":"code","c3de6e19":"code","9d6cb6ae":"code","3675f9f4":"code","1b41b681":"code","dc256e2c":"code","0e22770b":"code","4988cf51":"code","53045dfa":"markdown","b9f8d33e":"markdown","d94c40ed":"markdown","c7b0d805":"markdown","239d9ad0":"markdown","853ec81b":"markdown","c7c62026":"markdown","4256d924":"markdown","fd77606f":"markdown","920b9b82":"markdown","17d74427":"markdown","8574e50c":"markdown","1c45fdbf":"markdown"},"source":{"687175ea":"!pip install pycaret","4fd5e112":"import pandas as pd\nimport numpy as np\nimport category_encoders as ce\nfrom sklearn.model_selection import train_test_split\nfrom pycaret.regression import *\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.metrics import mean_squared_error,mean_absolute_error,r2_score\nimport pandas_profiling as pp\nimport matplotlib.pyplot as plt\nimport seaborn as sns","d8c83eb9":"df = pd.read_csv(\"..\/input\/crop-price-prediction\/corn yield.csv\")","956be11c":"df.head()","7ab8874a":"df.isnull().sum()","31aef212":"for i in df:\n    print(i,df[i].value_counts(),sep=\"\\n\",end=\"\\n\")","98c046ec":"cols_to_be_removed = [\"Program\",\"Week Ending\",\"Ag District\",\"Ag District Code\",\"County\",\"County ANSI\",\"Zip Code\",\"Region\",\"Watershed\",\"CV (%)\",\"Domain Category\",\"Commodity\",\"Geo Level\",\"watershed_code\",\"Domain\"]","d13cd930":"df.drop(columns=cols_to_be_removed,axis = 1,inplace=True)","86769c73":"prof = pp.ProfileReport(df)","72252694":"prof","d3aedba1":"df[\"State ANSI\"].fillna(0,inplace=True)","577cfc1d":"df.isnull().sum()","7c8ec82a":"for i in df:\n    print(i,df[i].value_counts(),sep=\"\\n\",end=\"\\n\")","a453a0d2":"df[\"Value\"] = df[\"Value\"].str.replace(',','')\ndf[\"State ANSI\"] = df[\"State ANSI\"].astype(\"int\")\ndf[\"Value\"] = df[\"Value\"].astype(\"float\")","e911c244":"def one_hot_encoding(df,column):\n    one_hot_encoder=ce.OneHotEncoder(cols=column,return_df=True,use_cat_names=True)\n    df_final = one_hot_encoder.fit_transform(df)\n    return df_final","dc722612":"df = one_hot_encoding(df,\"Period\")\ndf = one_hot_encoding(df,\"Data Item\")\ndf = one_hot_encoding(df,\"State\")","0f7c78c6":"X = df.drop(\"Value\",axis = 1)\nY = df[\"Value\"]","2d8540ef":"X_train,X_test,Y_train,Y_test = train_test_split(X,Y,random_state=27,test_size=0.2)","361066bd":"train,test = train_test_split(df, test_size=0.25,random_state= 27)","85fbbeb8":"experiment = setup(\n    data = train,\n    target = 'Value',\n    imputation_type='iterative'\n)","8ef1e780":"compare_models()","c3de6e19":"random_reg = RandomForestRegressor(n_estimators = 100, random_state = 0)","9d6cb6ae":"random_reg.fit(X_train, Y_train)","3675f9f4":"Y_pred = random_reg.predict(X_test)","1b41b681":"mse = mean_squared_error(Y_pred,Y_test)\nmse","dc256e2c":"mae = mean_absolute_error(Y_pred,Y_test)\nmae","0e22770b":"r2_score = r2_score(Y_pred,Y_test)\nr2_score","4988cf51":"plot = sns.regplot(Y_pred,Y_test)\nplot.set(xlabel=\"Predicted\",ylabel = \"Actual\")\n","53045dfa":"## Importing Packages","b9f8d33e":"# Thank You \ud83e\udd17\n### I hope you had a good time reading my notebook. Pls do support and comment! \ud83d\ude0e","d94c40ed":"## Importing Data","c7b0d805":"## Model Comparison","239d9ad0":"<b>As Random Forest Regressor gives more R<sup>2<\/sup> value we choose them for training our model \ud83d\udd25<\/b>","853ec81b":"### Insights\n&emsp;The R<sup>2<\/sup> value between predicted and actual values shows a strong positive correlation\n","c7c62026":"## Data Overview","4256d924":"## One Hot encoding","fd77606f":"<center><h1 class=\"list-group-item list-group-item-success\">CROP PRICE PREDICTION<\/h1><\/center>\n<br>\n<div>\n    <div class=\"row justify-content-space-between\">\n        <div class=\"col-lg-6\" style=\"padding:1em;height:100%\">\n            <img style=\"height:26em\" src = \"https:\/\/media.nationalgeographic.org\/assets\/photos\/120\/983\/091a0e2f-b93d-481b-9a60-db520c87ec33.jpg\" >\n        <\/div>\n        <div class=\"col-lg-6\" style=\"padding:1em;\">\n            <div>\n                <h3 style=\"font-size:1.4em\">Context<\/h3>\n                  <p>This dataset is focused on the crops which can reflect the price area and other attributes from that one can predict for future price yield by using some better attributes.<\/p>\n            <\/div><br>\n            <div>\n                <h3 style=\"font-size:1.4em;margin:2em 0\">Contents<\/h3>\n                <ul style = \"color:blue\">\n                    <li>Importing Packages<\/li>\n                    <li>Importing Data<\/li>\n                    <li>Analysing Data<\/li>\n                    <li>Data Overview<\/li>\n                    <li>Transforming data to required format<\/li>\n                    <li>One Hot encoding<\/li>\n                    <li>Model Comparison<\/li>\n                    <li>Training Models<\/li>\n                    <li>Evaluation Metrics<\/li>\n                <\/ul>\n            <\/div>\n        <\/div>\n    <\/div>\n<\/div>\n\n","920b9b82":"## Evaluation Metrics","17d74427":"## Transforming data to required format","8574e50c":"## Training Models","1c45fdbf":"## Analysing Data"}}