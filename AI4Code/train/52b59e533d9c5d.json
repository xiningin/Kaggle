{"cell_type":{"5a6d08a3":"code","b5163fd8":"code","8b6b9a7e":"code","77bad06e":"code","7a0deba6":"code","97623725":"code","93cdb100":"code","1e4c412d":"code","ba8db7b7":"code","e063e710":"code","39d65e6a":"markdown","99f7b20a":"markdown","77768c54":"markdown","cd12115c":"markdown","db227b2a":"markdown","216cb5b4":"markdown","ce68f373":"markdown","4c332881":"markdown","d75730c3":"markdown","2d22ac2a":"markdown","f63fc48e":"markdown","d1ff433f":"markdown","0adb2d61":"markdown","2a814641":"markdown"},"source":{"5a6d08a3":"# basic libraris\nimport os\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# fastai\nfrom fastai import *\nfrom fastai.vision import *\nfrom fastai.imports import *\nfrom fastai.vision.all import *\n\n# widgets\nimport ipywidgets as widgets\n\n# ignore warnings\nimport warnings\nwarnings.filterwarnings(\"ignore\")","b5163fd8":"!mkdir mask\n!mkdir no_mask","8b6b9a7e":"path = Path('\/kaggle\/working\/mask')\ndls = ImageDataLoaders.from_folder(path, valid_pct=0.5, batch_size=10, item_tfms=Resize(224))\ndls.valid.show_batch(max_n=4, nrows=1)","77bad06e":"# DataBlock is a FastAI API to fully customize very stage of the creating of the DataLoader\ncharacters = DataBlock(\n    blocks=(ImageBlock, CategoryBlock), \n    get_items=get_image_files, \n    splitter=RandomSplitter(valid_pct=0.2, seed=42),\n    get_y=parent_label,\n    item_tfms=Resize(256))\n\n# Creating the dataloader\npath = Path('\/kaggle\/working')\ndls = characters.dataloaders(path)\n\n# checking the images\ndls.valid.show_batch(max_n=18, nrows=3)","7a0deba6":"# instantiating the learner for training using resnet18 and running it for 4 epochs\nlearn = cnn_learner(dls, resnet18, metrics=error_rate)\nlearn.fine_tune(4)","97623725":"uploader = widgets.FileUpload()\nuploader","93cdb100":"def helper():\n    img = PILImage.create(uploader.data[0])\n    img.show()\n    pred,pred_idx,probs = learn.predict(img)\n    lbl_pred = widgets.Label()\n    lbl_pred.value = f'Prediction: {pred}; Probability: {probs[pred_idx]:.04f}'\n    print(lbl_pred)","1e4c412d":"helper()","ba8db7b7":"learn.export('\/kaggle\/working\/model.pkl')","e063e710":"path = Path()\npath.ls(file_exts = '.pkl')","39d65e6a":"#### 5.2 Prediction <a id=12><\/a>","99f7b20a":"### 4. Data Loaders <a id=7><\/a>\n\n[back to top](#100)","77768c54":"### 2. Packages <a id=2><\/a>\n[back to top](#100)","cd12115c":"*Run the following in console one line at a time*\n<div class=\"alert alert-danger\">\n  cp \/kaggle\/input\/face-mask\/dataset\/train\/without_mask\/* no_mask\n<\/div>\n\n*After above command, run the following cell*","db227b2a":"#### 4.1 For a single label <a id=8><\/a>","216cb5b4":"### 5. Model Building <a id=10><\/a>\n\n[back to top](#100)","ce68f373":"#### 5.1 Training <a id=11><\/a>","4c332881":"#### 3.1 Create folder <a id=4><\/a>\n\nI'm creating two folders in `\/kaggle\/working` to copy their respective image in each folder.","d75730c3":"### 3. Pre-model building <a id=3><\/a>\n[back to top](#100)","2d22ac2a":"#### 4.2 For the model building <a id=9><\/a>","f63fc48e":"### 1. Downloads <a id=1><\/a>\n[back to top](#100)\n\nIf the `fastai` library isn't available, it can be downloaded using `!pip intall fastai`","d1ff433f":"#### 3.2 Copy images <a id=5><\/a>\n\nCopying the images into their respective folders.","0adb2d61":"*Run the following in console*\n<div class=\"alert alert-danger\">\n  cp \/kaggle\/input\/face-mask\/dataset\/train\/with_mask\/* mask\n<\/div>\n\n*After above command, run the following cell*","2a814641":"<h1><center>Mask - No Mask Classifier<\/center><\/h1> <a id=100><\/a>\n\n<div class=\"alert alert-warning\">\n<div>\n    <span style=\"color:black\">\n    <\/span>\n<\/div>\n<br>\n<center>\n<img src = \"https:\/\/www.eurotimes.org\/wp-content\/uploads\/2020\/03\/mona-lisa-with-face-mask-3957982-e1584612250409.jpg\" style=\"height:300px;width:500px\"\/>\n<\/center>\n    \n<\/div>"}}