{"cell_type":{"c5c4b200":"code","ad4d5982":"code","db9b26d9":"code","20f22e04":"code","87835e71":"code","abfe3c74":"code","99057c57":"code","e7161569":"code","24a06a21":"code","a95873bc":"code","59310419":"code","a278c45a":"code","615d1375":"code","46143be8":"markdown","e65865a0":"markdown","2d70f6bb":"markdown","b393a78d":"markdown","353e59de":"markdown","a1dc899c":"markdown","5e40faf3":"markdown","2cf46877":"markdown"},"source":{"c5c4b200":"import numpy as np    #import numpy for number array handling\nimport pandas as pd   #import pandas for data processing (CSV file I\/O)\n\n#Visualization of data\nimport matplotlib.pyplot as plt\nimport seaborn as sns;sns.set(font_scale=1.2)\n\n#Allow charts and graphics to display right below the page of browser setup\n%matplotlib inline\n\nkidneyData = pd.read_csv('..\/input\/chronic-kidney-disease\/new_model.csv')  #import the dataset for ML algorithm\n\n#view dataset information and count of null values\nkidneyData.info()\nkidneyData.isnull().sum()","ad4d5982":"#display unique values in each column\nkidneyData.nunique()","db9b26d9":"#display overall statistical analysis of the dataset\nkidneyData.describe()","20f22e04":"#display top most rows of the dataset\nkidneyData.head()","87835e71":"#Visualization of the distribution of Outcome(target) column values \nfig1, axes = plt.subplots(1,1)\nplt.title('Outcome Distribution')\nsns.barplot(x=kidneyData['Class'].unique(), y=kidneyData['Class'].value_counts(), data=kidneyData)\nplt.xticks([0,1])\nplt.xlabel('Class')\nplt.ylabel('Count')\nplt.show()\n\n#Visualization of all the Features against the Outcome(target) \nfig2, axes = plt.subplots(5,3,figsize=(20,20))\nfig2.suptitle('Dataset Feature Distributions',fontsize=25)\ni=0;j=0;k=0;l=0;n=0\nfor column,value in kidneyData.iteritems():\n    if(column == 'Bp' or column == 'Sg' or column == 'Al'):\n        sns.stripplot(x=\"Class\", y=column, data=kidneyData, ax=axes[0,i])\n        i=i+1\n    elif(column == 'Su' or column == 'Rbc' or column == 'Bu'):\n        sns.stripplot(x=\"Class\", y=column, data=kidneyData, ax=axes[1,j])\n        j=j+1\n    elif(column == 'Sc' or column == 'Sod' or column == 'Pot'):\n        sns.stripplot(x=\"Class\", y=column, data=kidneyData, ax=axes[2,k])\n        k=k+1\n    elif(column == 'Hemo' or column == 'Wbcc' or column == 'Rbcc'):\n        sns.stripplot(x=\"Class\", y=column, data=kidneyData, ax=axes[3,l])\n        l=l+1\n    elif(column == 'Htn'):\n        sns.stripplot(x=\"Class\", y=column, data=kidneyData, ax=axes[4,n])\n        n=n+1\n\nplt.subplots_adjust(wspace= 0.2,hspace=0.3)\nplt.show()\n\n#Visualization of the correlation between features toward each other\nfig3, axes = plt.subplots(1,1,figsize=(8,6))\nplt.title('Correlation Between Features of Dataset')\nsns.heatmap(kidneyData.drop(columns = ['Class']).corr(), cmap=\"YlGnBu\")\nplt.show()","abfe3c74":"#Extracting the feature attributes from dataset\nX = kidneyData.drop(columns = ['Class'])\n#Extracting the target(label) attributes from dataset\ny = kidneyData['Class']","99057c57":"#Preprocess the out of range Hypertension(Htn) data\nX.loc[(X['Htn'] != 0) & (X['Htn'] != 1),'Htn'] = 0\n\n#Prrocessing of Categorical Data and Normalize(Standardize) Numerical Data \nfrom sklearn.preprocessing import OneHotEncoder,StandardScaler\nfrom sklearn.compose import ColumnTransformer\n\ncolumnTransformer = ColumnTransformer([('encoder', OneHotEncoder(categories='auto'), ['Rbc','Htn']),\n                                       ('Standardizer', StandardScaler(), ['Bp','Sg','Al','Su','Bu','Sc','Sod','Pot','Hemo','Wbcc','Rbcc'])],\n                                       remainder='passthrough')\nX = columnTransformer.fit_transform(X)\n","e7161569":"#Seperate the CKD dataset for two parts as training dataset and testing dataset\nfrom sklearn.model_selection import train_test_split\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.2, random_state = 200)\nprint('Training Feature Size :- ', X_train.shape )\nprint('Training Label Size :- ', y_train.shape )\nprint('Testing Feature Size :- ', X_test.shape )\nprint('Testing Label Size :- ', y_test.shape )","24a06a21":"#Implementation of the Logistic Regression Classifier\nfrom sklearn.linear_model import LogisticRegression\n\nlogisticRegression = LogisticRegression(solver='liblinear')\nlogisticRegression.fit(X_train,y_train)\n","a95873bc":"#Using test features of the dataset to see the predictions \nkidneyPrediction = logisticRegression.predict(X_test)\nkidneyPrediction","59310419":"from sklearn import metrics\n\n# Generate the Acuuray of ML Model\naccuracy = metrics.accuracy_score(y_test, kidneyPrediction)\nprint(\"Accuracy of the Model :-\", accuracy * 100)\n","a278c45a":"# Generate the Confusion Matrix of the predictions\nconfusionMatrix = metrics.confusion_matrix(y_test, kidneyPrediction)\n\nfig4, axes = plt.subplots(1,1,figsize=(5,4))\nsns.heatmap(confusionMatrix, annot=True, cmap='YlGn')\naxes.set_ylim([2,0])\nplt.title(\"Confusion Matrix\")\nplt.ylabel(\"Actual Outcome\")\nplt.xlabel(\"Predicted Outcome\")\nplt.show()\n","615d1375":"# Generate Classification Report for the predictions\nclassificationReport = metrics.classification_report(y_test, kidneyPrediction)\nprint(classificationReport)","46143be8":"# 2. Visualization of the Dataset","e65865a0":"# 1. Initial Setup and Overview","2d70f6bb":"# 4. Data Preprocessing","b393a78d":"# 7. Prediction Using Trained Model","353e59de":"# 5. Splitting Dataset into Train and Test Set","a1dc899c":"# 3. Extraction of Features and Labels from Dataset","5e40faf3":"# 8. Testing Results","2cf46877":"# 6. Implement Logistic Regression Model"}}