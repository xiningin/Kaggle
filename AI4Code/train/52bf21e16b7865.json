{"cell_type":{"5e63a339":"code","c2bf83ec":"code","a593bc6b":"code","ad35cdc7":"code","ae189e38":"code","8ba0706c":"code","4baa2f84":"code","80889832":"code","8332d7d7":"code","6659f145":"code","474583ae":"markdown","bcea9975":"markdown","7b122363":"markdown","b56bf959":"markdown"},"source":{"5e63a339":"!pip install lightautoml","c2bf83ec":"# Data Handling \nimport pandas as pd\nimport numpy as np\n\n# AutoML\nfrom sklearn.model_selection import train_test_split\nfrom lightautoml.reader.base import PandasToPandasReader\nfrom lightautoml.tasks import Task\nfrom lightautoml.automl.presets.tabular_presets import TabularAutoML","a593bc6b":"# Import data\ndf_train = pd.read_csv(\"..\/input\/tabular-playground-series-oct-2021\/train.csv\")\ndf_train.head()","ad35cdc7":"task = Task(\"binary\")\nreader = PandasToPandasReader(task, cv=5, random_state=30)","ae189e38":"autoML = TabularAutoML(task=task, \n                      general_params = {\"nested_cv\":False, \"use_algos\":[[\"linear_l1\", \"lgb\", \"lgb_tuned\"]]}, \n                      reader_params = {\"cv\":5, \"random_state\":30}, \n                      tuning_params = {\"max_tuning_iter\":20, \"max_tuning_time\":30}, \n                      lgb_params = {\"default_params\":{\"num_threads\":4}})","8ba0706c":"oof_pred = autoML.fit_predict(df_train, roles = {\"target\":\"target\", \"drop\":\"id\"})","4baa2f84":"test_df = pd.read_csv(\"..\/input\/tabular-playground-series-oct-2021\/test.csv\")\ntest_df.head()","80889832":"test_predictions = autoML.predict(test_df)","8332d7d7":"# Export predictions \noutput = pd.DataFrame({\"id\":test_df[\"id\"], \n                      \"target\":test_predictions.data[:,0]})\noutput","6659f145":"output.to_csv(\"submission.csv\", index=False)","474583ae":"# Model Development","bcea9975":"# Packages","7b122363":"# Processing","b56bf959":"# Submission"}}