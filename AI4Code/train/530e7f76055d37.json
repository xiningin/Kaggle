{"cell_type":{"6b777bc9":"code","37193389":"code","983c441a":"code","f9401739":"code","7bc69e2d":"code","33b023fd":"code","41f5fff2":"code","c7ca6d69":"code","e687fe03":"code","924494b6":"code","38ec6451":"code","0fffe345":"code","0ca30f77":"code","68ef8a20":"code","4c6dc573":"code","73c99512":"code","c4dcc419":"code","a08c90ba":"code","e65bf7a8":"code","915088eb":"code","6c40e963":"code","8c01105b":"code","55de77ba":"code","1d46b486":"code","709eb6d9":"code","50c715cd":"code","4d98735a":"code","32c3b22c":"markdown","1273622e":"markdown","f0037729":"markdown","f2de8bc6":"markdown","db233232":"markdown","f1bc2252":"markdown","0d4c3a98":"markdown","d5690e34":"markdown"},"source":{"6b777bc9":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport warnings\nwarnings.filterwarnings('ignore')\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\n","37193389":"# Reading the original csv file\ndf = pd.read_csv(\"..\/input\/heart.csv\")","983c441a":"df.columns #View the column headers","f9401739":"df.head()  #Peek into the first 5 rows","7bc69e2d":"df.tail()  #Peek into the last 5 rows","33b023fd":"df.shape   #Look at the Shape of the DataFrame","41f5fff2":"df.info()  #Look at the data types and look for null values using info()","c7ca6d69":"df.describe() # Descriptive statistics (or) Summary Statistics ","e687fe03":"# Sorting the DataFrame by Age\nprint(df.sort_values(by=['age']))","924494b6":"df['sex'] = df['sex'].astype('category') # convert the sex column as categorical using astype() method","38ec6451":"# Distribution of Age using Histogram\nplt.hist(df.age, bins=10, color='green')\nplt.xlabel('AGE')\nplt.ylabel('Frequency')\nplt.title('Histogram of Age')\nplt.show()","0fffe345":"# Plotting the Rest Blood Pressure against age and comparison between sex\nsns.lmplot(x='age', y='trestbps', data=df, hue='sex', palette='muted')\nplt.show()\nprint('Correlation Coefficient:{}'.format(np.corrcoef(df.age, df.trestbps)[0,1]))","0ca30f77":"# BeeSwarm plot for classifying common kind of heart defects in males and females\nsns.swarmplot(x='sex', y='thal', data=df, size=7)\nplt.show()","68ef8a20":"# Heatmap for itendifying the correlation between different variables\ncorrmat = df.corr()\nf, ax = plt.subplots(figsize=(10,9))\nsns.heatmap(corrmat, square=True, annot = True, annot_kws={'size':10})\nplt.show()","4c6dc573":"# Regression model between Resting Blood Pressure and Age and effect of blood sugar level of them\nsns.lmplot(x='age', y='trestbps', data=df, hue='fbs')\nplt.show()","73c99512":"# Pair plot between ordinal variables\nsns.set()\ncols1= ['slope','cp', 'thalach', 'target']\nsns.pairplot(df[cols1], size=2)\nplt.show()","c4dcc419":"# filtering of DataFrame using Boolean functions\ndf1 = df[(df['sex']==1) & (df['fbs']==1)]\nprint(df1)","a08c90ba":"# Usage of groupby function # Multi-leve grouping\nprint(\"Average Cholestrol based on Gender\")\nprint(df.groupby('sex')['chol'].mean())\nprint(\"Average Resting Blood Pressure based on Gender\")\nprint(df.groupby('sex')['trestbps'].mean())","e65bf7a8":"# Grouping using aggregate method\ndf.groupby(['thal','cp']).mean()","915088eb":"# Violin Plots to demonstrate the highest heart rate achieved and cholestrol for different chest pain types\nplt.figure(figsize=(10,7))\nplt.subplot(3,1,1)\nsns.violinplot(x='cp', y='thalach', inner='points', data=df)\nplt.xticks\nplt.subplot(3,1,2)\nsns.violinplot(x='cp', y='chol', inner='points', data=df)\nplt.subplot(3,1,3)\nsns.violinplot(x='cp', y='trestbps', inner='points', data=df)\nplt.tight_layout()\nplt.show()","6c40e963":"# Beeswarm plot for understanding the defect types for different ages in males and females\nsns.swarmplot(x='sex', y='age', hue='thal', data=df, size=7, palette='deep')\nplt.legend(title='thal', loc='lower center')\nplt.show()","8c01105b":"# Beeswarm Plot to understand the heart failures in males and females with chest pain types\nsns.swarmplot(x='cp', y='trestbps', hue='target', data=df)\nplt.title(\"0: Female , 1: Male\")\nplt.show()","55de77ba":"# Lambda Function to normalize the cholestrol and resting BP between 0 and 1\nnormalize = lambda col_name: df[col_name] \/df[col_name].max()\ndf['trestbps_norm'] = normalize('trestbps')\ndf['chol_norm'] = normalize('chol')","1d46b486":"# Joint Plot with Contours for cholestrol levels for age groups\nsns.jointplot(x='age', y='chol_norm', data=df, kind='kde')\nplt.show()","709eb6d9":"# Multiple plots using subplot\nplt.figure(figsize=(10,8))\nplt.subplot(3,1,1)\nplt.plot(df['trestbps'])\nplt.subplot(3,1,2)\nplt.plot(df['chol'])\nplt.subplot(3,1,3)\nplt.plot(df['thalach'])\nplt.tight_layout()\nplt.show()","50c715cd":"# Empirical cumulative distribution function to understand the distribution of Resting BP, Cholestrol and Max. HR Ach.\ndef ecdf(data):\n    \"\"\"\n    Function Definition: Empirical cumulative distribution function \n    to understand the distribution of Resting BP, Cholestrol and \n    Max. HR Ach.\n    \n    \"\"\"\n    n=len(data)\n    x=np.sort(data)\n    y=np.arange(1, n+1)\/n\n    return x, y\nx1, y1 = ecdf(df['trestbps'])\nplt.plot(x1, y1, marker='.', linestyle='none')\nplt.xlabel('Resting Blood Pressure')\nplt.ylabel('ECDF')\nplt.title('Empirical Cumulative Distribution Functions')\nplt.margins(0.02)\nplt.show()\nx2, y2 = ecdf(df['chol'])\nplt.plot(x2, y2, marker='.', linestyle='none')\nplt.xlabel('Cholestrol')\nplt.ylabel('ECDF')\nplt.margins(0.02)\nplt.show()\nx3, y3 = ecdf(df['thalach'])\nplt.plot(x3, y3, marker='.', linestyle='none')\nplt.xlabel('Max. HR Achieved')\nplt.ylabel('ECDF')\nplt.margins(0.02)\nplt.show()\nx4, y4 = ecdf(df['oldpeak'])\nplt.plot(x4, y4, marker='.', linestyle='none')\nplt.xlabel('ST depression induced by exercise relative to rest')\nplt.ylabel('ECDF')\nplt.margins(0.02)\nplt.show()","4d98735a":"# Supervised learning ML model using scikit learning module\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.metrics import confusion_matrix\nfrom sklearn.metrics import classification_report\nX = df.drop('target', axis=1).values\ny = df['target'].values\nknn = KNeighborsClassifier(n_neighbors=10)\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42, stratify=y)\nknn.fit(X_train, y_train)\ny_pred = knn.predict(X_test)\nprint(\"Test Set Predictions:\\n{}\".format(y_pred))\nknn.score(X_test, y_test)\nprint(confusion_matrix(y_test, y_pred))\nprint(classification_report(y_test, y_pred))\n","32c3b22c":"Visual Exploratory Data Analysis (Visual EDA)","1273622e":"Thanks a lot of taking the time to view my kernel!! Please leave your feedbacks in the comments section. ","f0037729":"The sample contains more samples from age group 55 to 65 than any other age group","f2de8bc6":"This is my first kernel (Hurray!!) in Kaggle to analyse the causes of Heart disease and build a simple ML model to classify and predict the Heart diseases based on certain features\n\nAttribute Information (Feature Variables): \n1. age \n2. sex \n3. chest pain type (4 values) \n4. resting blood pressure \n5. serum cholestoral in mg\/dl \n6. fasting blood sugar > 120 mg\/dl\n7. resting electrocardiographic results (values 0,1,2)\n8. maximum heart rate achieved \n9. exercise induced angina \n10. oldpeak = ST depression induced by exercise relative to rest \n11. the slope of the peak exercise ST segment \n12. number of major vessels (0-3) colored by flourosopy \n13. thal: 3 = normal; 6 = fixed defect; 7 = reversable defect \n\n14. Target 0 or 1  ----> Target Variable\n\nObjectives:\n1. To predict certain cardiovascular events\n2. Heart disease predominantly occurs in Male or Female\n3. Heart Disease predominantly occurs at which age group\n4. Correlation between \n    a) target & chest pain type\n    b) thal & target\n    c) Gender & Thal\n    d) Age & Thal\n    e) fasting blood sugar & thal\n    f) chol & thal\n    g) chol & tbps","db233232":"The target has comparitively higher correlation with chest pain and highest heart rate achieved and slope of the ST curve than other variables. ","f1bc2252":"There is a positive correlation between age and rest blood pressure. The Females tend to have slightly higher chance of high blood pressure than males post the age of 50","0d4c3a98":"Clearly, blood sugar level higher than 120 mg\/dl increases the risk of blood pressure as age increases.","d5690e34":"Exploratory Data Analysis (EDA)"}}