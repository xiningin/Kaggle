{"cell_type":{"a64e77ab":"code","46a725d0":"code","b6567f23":"code","955c1c92":"code","1a0148a5":"code","0f3fe4ae":"code","7f288674":"code","21647b42":"code","db1e80b0":"code","fe5e41c0":"code","f28b6d61":"code","4aa8d2de":"code","a3158760":"code","4041f55f":"code","e5adbc74":"code","15ba79be":"code","6416e3c0":"code","b1f0e91e":"code","e4f6ff17":"code","ec6f7289":"code","3a93bf5b":"code","25416d23":"code","4f88177f":"code","355445c4":"code","3053d99b":"code","0d5c70dd":"code","24d0b730":"code","e6cde5a8":"code","c04cece9":"code","6c7f7ae2":"code","a44432d5":"code","62fe8d07":"code","bafbcad4":"code","455dcd8c":"code","8bcc5bb4":"code","2e12655e":"code","fd7770eb":"code","82984698":"code","3c2aff15":"code","07c16768":"code","6e686348":"code","bc1c0941":"code","cd6a457e":"code","ca522788":"code","1d0f2461":"code","df853162":"code","28241e94":"code","4e3df63f":"code","e3e3dfe9":"code","60b84a67":"code","646ca748":"code","4cbafb89":"code","ccea52c2":"code","c6ba65b7":"code","ad157f16":"code","c7d21ff0":"code","a227e207":"code","a50ecbfc":"code","a5c649ee":"code","6ce51cb6":"code","79c82a17":"code","948d23c6":"code","3dfa3359":"code","e060f4d3":"code","62860878":"code","36b052dc":"code","4beffa0b":"markdown","e558b627":"markdown","de1f1180":"markdown","ec548465":"markdown","3767fda0":"markdown"},"source":{"a64e77ab":"\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n        \nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nimport warnings\nwarnings.filterwarnings('ignore')","46a725d0":"df=pd.read_csv('\/kaggle\/input\/car-price-prediction\/CarPrice_Assignment.csv')","b6567f23":"df.head()","955c1c92":"df.columns","1a0148a5":"df.shape","0f3fe4ae":"df.info()","7f288674":"df.describe()","21647b42":"df.nunique()","db1e80b0":"df['enginetype'].unique()","fe5e41c0":"df['cylindernumber'].unique()","f28b6d61":"df['enginetype'].value_counts()","4aa8d2de":"df['cylindernumber']=df['cylindernumber'].map({'four':4,'six':6,'five':5,'eight':8,'two':2,'three':3,'twelve':12})","a3158760":"df['cylindernumber'].dtype","4041f55f":"df['enginetype']=df['enginetype'].map({'ohc':1,'ohcf':2,'ohcv':3,'dohc':4,'l':5,'rotar':6,'dohcv':7})","e5adbc74":"sns.boxplot(data=df,x='cylindernumber',y='price')","15ba79be":"sns.boxplot(data=df,x='enginelocation',y='price')","6416e3c0":"sns.boxplot(data=df,x='carbody',y='price')","b1f0e91e":"plt.scatter(x='compressionratio',y='price',data=df)","e4f6ff17":"df.head(1)","ec6f7289":"sns.boxplot(data=df,x='symboling',y='price')","3a93bf5b":"sns.scatterplot(x='price',y='curbweight',hue='doornumber',data=df)","25416d23":"plt.rcParams['figure.figsize']=(12,12)\ncorr=df.corr()\nsns.heatmap(corr,fmt='.2f',annot=True,cmap=plt.cm.Blues)","4f88177f":"df_corr=df.corr().abs()\ndf_corr\n\n","355445c4":"upper=df_corr.where(np.triu(np.ones(df_corr.shape),k=1).astype(np.bool))\nupper\n","3053d99b":"to_drop=[column for column in upper.columns if any (upper[column]>0.95)]\nprint('----------------------------')\nprint(to_drop)\n\n","0d5c70dd":"df1=df.drop(to_drop,axis=1)\ndf1.columns","24d0b730":"df1.drop('car_ID',axis=1,inplace=True)","e6cde5a8":"df1.info()","c04cece9":"df1.nunique()","6c7f7ae2":"dummies=pd.get_dummies(df1[['fueltype','aspiration','doornumber','carbody','drivewheel',\n                            'enginelocation','fuelsystem']])","a44432d5":"dummies.head(2)","62fe8d07":"df1=pd.concat([df1,dummies],axis=1)","bafbcad4":"df1.drop(['fueltype','aspiration','doornumber','carbody','drivewheel','enginelocation','fuelsystem'],\n         axis=1,inplace=True)","455dcd8c":"#checking for null values in enginetype feature\ndf1[df1['enginetype'].isnull()]","8bcc5bb4":"#filling NaN values with most common enginetype which is 1\ndf1['enginetype']=df1['enginetype'].fillna('1')","2e12655e":"df1[df1['enginetype'].isnull()]","fd7770eb":"df1['enginetype']=df1['enginetype'].astype('int')","82984698":"df1.info()","3c2aff15":"X=df1.loc[:,df1.columns!='price']\ny=df1.loc[:,'price']","07c16768":"from sklearn.model_selection import train_test_split\nX_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.3,random_state=1234)","6e686348":"X_train.drop('CarName',axis=1,inplace=True)\nX_test.drop('CarName',axis=1,inplace=True)","bc1c0941":"from sklearn.linear_model import LinearRegression\nfrom sklearn.metrics import r2_score,mean_absolute_error,mean_squared_error\n","cd6a457e":"lr=LinearRegression()\nlr.fit(X_train,y_train)","ca522788":"lr.score(X_train,y_train)","1d0f2461":"lr_pred=lr.predict(X_test)\nprint('MSE:',mean_squared_error(lr_pred,y_test))\nprint('MAE:',mean_absolute_error(lr_pred,y_test))\nprint('r2_score:',r2_score(lr_pred,y_test))","df853162":"prediction=pd.DataFrame({'Actual':y_test,'Predicted':lr_pred})","28241e94":"prediction.head(10)","4e3df63f":"lr.coef_","e3e3dfe9":"from sklearn.svm import SVR\nfrom sklearn.preprocessing import StandardScaler","60b84a67":"svc=SVR()\nsvc.fit(X_train,y_train)","646ca748":"svc.score(X_train,y_train)","4cbafb89":"svc_pred=svc.predict(X_test)\nprint('MSE:',mean_squared_error(svc_pred,y_test))\nprint('MAE:',mean_absolute_error(svc_pred,y_test))\nprint('r2_score:',r2_score(svc_pred,y_test))","ccea52c2":"scaler=StandardScaler()\nX_train_scaled=scaler.fit_transform(X_train)\nX_test_scaled=scaler.transform(X_test)","c6ba65b7":"svr=SVR()\nsvr.fit(X_train_scaled,y_train)","ad157f16":"svr.score(X_train_scaled,y_train)","c7d21ff0":"svr_pred=svr.predict(X_test_scaled)\n","a227e207":"print('MSE:',mean_squared_error(svr_pred,y_test))\nprint('MAE:',mean_absolute_error(svr_pred,y_test))\nprint('r2_score:',r2_score(svr_pred,y_test))","a50ecbfc":"from sklearn.ensemble import RandomForestRegressor","a5c649ee":"rf=RandomForestRegressor()\nrf.fit(X_train,y_train)","6ce51cb6":"rf.score(X_train,y_train)","79c82a17":"rf_pred=rf.predict(X_test)\nprint('MSE:',mean_squared_error(rf_pred,y_test))\nprint('MAE:',mean_absolute_error(rf_pred,y_test))\nprint('r2_score:',r2_score(rf_pred,y_test))","948d23c6":"prediction_rf=pd.DataFrame({'Actual':y_test,'Predicted':rf_pred})\nprediction_rf.head(10)","3dfa3359":"from sklearn.ensemble import BaggingRegressor","e060f4d3":"bag=BaggingRegressor()\nbag.fit(X_train,y_train)\nbag.score(X_train,y_train)","62860878":"bag_pred=bag.predict(X_test)\nprint('MSE:',mean_squared_error(bag_pred,y_test))\nprint('MAE:',mean_absolute_error(bag_pred,y_test))\nprint('r2_score:',r2_score(bag_pred,y_test))","36b052dc":"#Support vector Regressor performs bad and it is less generally used in regression problems\n#Linear regression and random forest gives good prediction accuracy on the data","4beffa0b":"# SVM","e558b627":"# Bagging Regressor","de1f1180":"# Linear Regression","ec548465":"# Random Forest Regressor","3767fda0":"### - Scaling the data before training by SVR"}}