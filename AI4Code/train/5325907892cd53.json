{"cell_type":{"047c9ea9":"code","12070141":"code","b2e94be9":"code","ce33f791":"code","8fdf89e6":"code","572bbd95":"code","dfcb2077":"code","f5a27e65":"code","ddb341ab":"markdown","c9cb43e1":"markdown","c67cc477":"markdown","5fcad005":"markdown","ffc5bfe4":"markdown","89156c0e":"markdown","eef6f64d":"markdown","ac69cd67":"markdown"},"source":{"047c9ea9":"import os\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n%matplotlib inline","12070141":"wine_base = pd.read_csv(os.path.join('..\/input\/', 'winemag-data-130k-v2.csv'))\nwine_base.head(5)","b2e94be9":"from sklearn.model_selection import train_test_split\nX = wine_base.drop(['points'], axis=1)\ny = wine_base['points'].copy()\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, random_state=0)","ce33f791":"from sklearn.feature_extraction.text import CountVectorizer, TfidfVectorizer\n\n#vect = CountVectorizer(tokenizer=custom_tokenizer, min_df=5)\nvect = CountVectorizer(min_df=5)\nvect.fit(X_train['description'])\nprint(\"vocabulary size: {}\".format(len(vect.vocabulary_)))\nX_train_vectored = vect.transform(X_train['description'])","8fdf89e6":"feature_names = vect.get_feature_names()\nprint(\"Number of Features: \", len(feature_names))\nprint(\"First 20 features: \\n{}\".format(feature_names[:20]))\nprint(\"features 10010 to 10030:\\n{}\".format(feature_names[10010:10030]))\nprint(\"Every 2000th feature:\\n{}\".format(feature_names[::2000]))","572bbd95":"from sklearn.linear_model import LogisticRegression, LinearRegression\nfrom sklearn.model_selection import GridSearchCV\n\nlr = LinearRegression()\nlr.fit(X_train_vectored, y_train)\n","dfcb2077":"from sklearn.metrics import mean_squared_error\ny_pred = lr.predict(X_train_vectored)\nmse = mean_squared_error(y_train, y_pred)\nrmse = np.sqrt(mse)\nrmse","f5a27e65":"X_test_vectored = vect.transform(X_test['description'])\ny_test_pred = lr.predict(X_test_vectored)\nmse = mean_squared_error(y_test, y_test_pred)\nrmse = np.sqrt(mse)\nrmse","ddb341ab":"make vectors from description by countvectorizer.","c9cb43e1":"train linear regression model,","c67cc477":"It seems that it got a score not so bad.\nlet's predict test set points.","5fcad005":"loading dataset.","ffc5bfe4":"I'll try Predicting points from description using WineReviews dataset.","89156c0e":"spliting train set and test set.","eef6f64d":"Importing libraries.","ac69cd67":"evaluate predict result."}}