{"cell_type":{"54c0ad35":"code","e179830d":"code","c326c8e7":"code","a77519e3":"code","ebf1d65c":"code","e99f7767":"markdown"},"source":{"54c0ad35":"!pip install bertviz\nfrom bertviz import head_view, model_view\nfrom bertviz.neuron_view import show\nfrom transformers import BertTokenizer, BertModel","e179830d":"# Load model and retrieve attention\nmodel_version = 'dkleczek\/bert-base-polish-uncased-v1'\ndo_lower_case = True\nmodel = BertModel.from_pretrained(model_version, output_attentions=True)\ntokenizer = BertTokenizer.from_pretrained(model_version, do_lower_case=do_lower_case)\nsentence_a = \"Kot usiad\u0142 na dywanie\"\nsentence_b = \"Kot po\u0142o\u017cy\u0142 si\u0119 na fotelu\"\ninputs = tokenizer.encode_plus(sentence_a, sentence_b, return_tensors='pt', add_special_tokens=True)\ntoken_type_ids = inputs['token_type_ids']\ninput_ids = inputs['input_ids']\nattention = model(input_ids, token_type_ids=token_type_ids)[-1]\ninput_id_list = input_ids[0].tolist() # Batch index 0\ntokens = tokenizer.convert_ids_to_tokens(input_id_list)","c326c8e7":"head_view(attention, tokens)","a77519e3":"model_view(attention, tokens)","ebf1d65c":"from bertviz.transformers_neuron_view import RobertaModel, RobertaTokenizer\nfrom bertviz.neuron_view import show\n\n\nmodel_type = 'roberta'\nmodel_version = 'roberta-base'\nmodel = RobertaModel.from_pretrained(model_version)\ntokenizer = RobertaTokenizer.from_pretrained(model_version)\nsentence_a = \"The cat sat on the mat\"\nsentence_b = \"The cat lay on the rug\"\nshow(model, model_type, tokenizer, sentence_a, sentence_b)","e99f7767":"Visualisation"}}