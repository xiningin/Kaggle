{"cell_type":{"5aba011a":"code","7ecd598a":"code","9e2e902e":"code","56455968":"code","a178850b":"code","e86becf4":"code","6ec0ffa7":"code","d396aa9f":"code","cd9f1f0c":"code","04e1fadd":"code","582e818d":"code","aeb73614":"code","852920e9":"code","f0f11132":"markdown","3bbd5f9a":"markdown"},"source":{"5aba011a":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","7ecd598a":"df=pd.read_csv('\/kaggle\/input\/stock-sentiment-analysis\/Stock_Dataa.csv', encoding=\"ISO-8859-1\")\ndf.head()","9e2e902e":"train_df = df[df['Date']<'2015010']\ntest_df = df[df['Date']>'20141231']\n","56455968":"data = train_df.iloc[: , 2:27]\n\ndata.replace('[^a-zA-Z]', \" \", regex = True , inplace = True)","a178850b":"#Changing Column Names for ease\nlist1 = [i for i in range(25)]\nnews_index = [str(i) for i in list1]\ndata.columns = news_index\ndata.head(5)\n        ","e86becf4":"#Converting Headlines into smallercase\nfor index in news_index:\n    data[index] = data[index].str.lower()\ndata.head(1)\n","6ec0ffa7":"headlines = []\nfor row in range(0,len(data.index)):\n    headlines.append(' '.join(str(x) for x in data.iloc[row , 0:25]))","d396aa9f":"headlines[0]","cd9f1f0c":"from sklearn.feature_extraction.text import TfidfVectorizer\nfrom sklearn.ensemble import RandomForestClassifier","04e1fadd":"# Implementing Bag of Words\ntfvector = TfidfVectorizer(ngram_range = (2,2))\ntrain_dataset = tfvector.fit_transform(headlines)\ntrain_dataset.shape","582e818d":"#Implement random forest\nrandom_classifier = RandomForestClassifier(n_estimators = 200 , criterion = 'entropy')\nrandom_classifier.fit(train_dataset , train_df['Label'])","aeb73614":"test_transform= []\nfor row in range(0,len(test_df.index)):\n    test_transform.append(' '.join(str(x) for x in test_df.iloc[row,2:27]))\ntest_dataset = tfvector.transform(test_transform)\npredictions = random_classifier.predict(test_dataset)\n","852920e9":"from sklearn.metrics import confusion_matrix\nfrom sklearn.metrics import accuracy_score\naccuracy_score(test_df['Label'], predictions)\n","f0f11132":"# **Feature Engineering**","3bbd5f9a":"# Accuracy  = 87.3 %"}}