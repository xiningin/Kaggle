{"cell_type":{"f6239ee5":"code","d469426f":"code","b6d8e5d7":"code","d9045e43":"code","e7f96bb2":"code","75cb264e":"code","c4b0f575":"code","523f7536":"code","733e38af":"code","c92dec08":"code","af5ab8b3":"code","cd39e2cb":"code","d600a67f":"code","3d4b4e88":"code","2626b773":"code","389f443b":"code","ac09ddbd":"code","17cccf2b":"code","f0239d6c":"code","b986b514":"code","52149571":"code","11506ffa":"code","19b2e3b6":"code","ea077fc8":"code","48e71a84":"code","1bea86ee":"code","8be6d920":"code","dbeb06d3":"code","b19f7ab9":"code","de6690c0":"code","4b9741eb":"code","6bbc906a":"code","8a2a4923":"code","f4dd8f3e":"code","f18a2788":"code","1c590732":"code","470c3770":"code","0c71ca94":"code","b4aef81a":"code","1ee6e799":"code","72be6466":"code","53533b47":"code","1c6480d8":"code","d512fb80":"code","e6b67b50":"code","ba26f619":"code","2527f15c":"code","c5b9fc28":"code","4f6a61ed":"code","2fd18bca":"code","f7291100":"code","1950af60":"code","13cac3ea":"code","45349bb4":"code","179713c3":"code","273cd72b":"code","0333fa78":"code","984c49dc":"code","4199f74d":"code","373f4d68":"code","e3cf2418":"code","3e0dae9d":"code","e128cc74":"code","18439cc4":"code","7247bfb6":"code","efcd0f33":"code","7acd8fe9":"code","a4a52175":"code","337ff090":"code","5b98fc7b":"code","0998c1ef":"code","58190c8e":"markdown","ac1c687e":"markdown","fac0b85c":"markdown","93412cdd":"markdown","e5bdc60b":"markdown","7644e6b0":"markdown","a6eee9eb":"markdown","ddbe9b80":"markdown","23130d8d":"markdown","6fb23c8d":"markdown","2ec3571b":"markdown","5b8edcfe":"markdown","4ff75beb":"markdown","1889f5fe":"markdown","ba36e714":"markdown","e3255490":"markdown","166aabb3":"markdown","10eff595":"markdown","2176ca80":"markdown","7a719a57":"markdown"},"source":{"f6239ee5":"# from google.colab import drive\n# drive.mount('\/content\/drive')","d469426f":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport warnings\nwarnings.filterwarnings('ignore')","b6d8e5d7":"df=pd.read_excel(\"..\/input\/ecommerce-analysis\/E-com_Data.xlsx\")\n# df2=df.copy()\n# df3=df2.copy()","d9045e43":"df.info()","e7f96bb2":"df.head()","75cb264e":"df.isna().sum()","c4b0f575":"# Checking Counts of Categories Present in Cancelled status\ndf['Cancelled_status'].value_counts()","523f7536":"# ecom=df.copy()","733e38af":"# filling NA Values those price are in Negative with 1 else 0 in Cancelles Status\ndf['Cancelled_status']= np.where(df['Price']<0,1,0)","c92dec08":"df['Cancelled_status'].value_counts()","af5ab8b3":"# Checking Counts of Categories Present in Reason of return\ndf['Reason of return'].value_counts()","cd39e2cb":"# checking wether Missing and display have 1 in cancelled Status or not\ndf[df['Reason of return'].isin(['Missing','display'])]","d600a67f":"# Filling NA Values with Unknown and Not Returned based on condition\n\nc=(df['Cancelled_status']==1)&(df['Reason of return'].isna()==True)\nc1=(df['Cancelled_status']==0)\ndf['Reason of return']=np.select([c,c1],['Unknown','Not Returned'],df['Reason of return'])\n","3d4b4e88":"# Checking Counts of Categories Present in Reason of return\ndf['Reason of return'].value_counts()","2626b773":"# Droping Column Sold as set because of non-Availability of Data\ndf.drop('Sold as set',1,inplace=True)","389f443b":"df.info()","ac09ddbd":"df.head()","17cccf2b":"# Checking Duplicated Records\ndf.duplicated().sum()","f0239d6c":"# Droping Duplicated Records\ndf.drop_duplicates(inplace=True)","b986b514":"df.describe().T\n\n# Price And Quantity are in Negative Because of return of the Product","52149571":"# \"\"\"\" Separating Registered and Not Registered Customers i.e Null Values are non Registered & Non-Null values are registered \n# Customers in CustomerID \"\"\"\" \n\nnon_registred_customers=df[df['CustomerID'].isna()]\nregistered_customers=df.drop(df[df['CustomerID'].isna()].index)\n\nregistered_customers=registered_customers.reset_index()\nnon_registred_customers=non_registred_customers.reset_index()\n\nregistered_customers.drop('index',1,inplace=True)\nnon_registred_customers.drop('index',1,inplace=True)","11506ffa":"df.head()","19b2e3b6":"# Checking Whether Invoice No. is same for different Shipping Locations or not\npd.set_option('max_rows',157586)\ndf.groupby(['CustomerID','InvoieNo','Date of purchase'])['Shipping Location'].value_counts().to_frame()","ea077fc8":"# Checking the reppition of Same invoice\nprint(len(df[(df['InvoieNo']==362690)]))\n\n# checking dates of same invoce no.\nlen(df[(df['InvoieNo']==362690)]['Date of purchase'].unique())","48e71a84":"# Counting the repitition of same invoice on a date\ndf[(df['InvoieNo']==362690)].groupby('Date of purchase').count()","1bea86ee":"pd.set_option('max_rows',200)\ndf[(df['InvoieNo']==362690)&(df['Date of purchase']=='2016-12-08')]","8be6d920":"df[df['InvoieNo']==362690].sort_values('Date of purchase')\n\n# Shopping Time is same for all differenrt Dates","dbeb06d3":"# Checking NA Values\ndf.isna().sum()","b19f7ab9":"# Droping Customers na Values because in E-commerce no one can order something without  customerID\ndf.dropna(inplace=True)\ndf.isna().sum()","de6690c0":"df","4b9741eb":"# Extracting Date Month week Year from Date of Purchase column\n\ndf['date']=df['Date of purchase'].dt.day\ndf['week_name']=df['Date of purchase'].dt.day_name()\ndf['week_name_number']=df['Date of purchase'].dt.dayofweek\ndf['month']=df['Date of purchase'].dt.month\ndf['year']=df['Date of purchase'].dt.year","6bbc906a":"df.head()\n","8a2a4923":"# Addimg Months Name at Specified Location\ndf.insert(15,'month_name',df['Date of purchase'].dt.month_name())","f4dd8f3e":"df.head()","f18a2788":"# CustomerID\ndf['CustomerID'].value_counts().head(10).plot(kind='barh')\n\nprint('Total No. of Customers:',df['CustomerID'].nunique())","1c590732":"# Item Code\ndf['Item Code'].value_counts().head(10).plot(kind='barh')\nprint('Total No. of Items:',df['Item Code'].nunique())","470c3770":"# Invoice No.\nprint('Total no. of Invoice Generated:',df['InvoieNo'].nunique())","0c71ca94":"# Quantity\ndisplay(df['Quantity'].describe().to_frame().T)\ndf['Quantity'].value_counts().head(10).plot(kind='bar')","b4aef81a":"df['Time'].value_counts().head(10).plot(kind='bar')","1ee6e799":"# l=['00','01','02','03','04','05','06','07','08','09','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24']\n# # k=[00,01,02,03,04,05,06,07,08,09,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24]\n# time=[]\n# for i in l:\n#   for j in df['Time'].astype(str):\n\n#     if j.str.startswith(i):\n#       time.append(i)\n#     else:\n#       time.append(df['Time'])  \n\n\n","72be6466":"pd.to_datetime(df['Time'], format='%H:%M:%S').dt.hour.value_counts().plot(kind='bar')","53533b47":"# l=['00','01','02','03','04','05','06','07','08','09','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24']\n# df['Time'].apply(lambda x: [i if x.astype(str).str.startswith(i) else x for i in l])","1c6480d8":"df['time']=df['Time'].astype(str).str.slice(0,2)","d512fb80":"df['time'].value_counts().plot(kind='bar')","e6b67b50":"# Price Per Unit\ndisplay(df['price per Unit'].describe().to_frame().T)\nsns.distplot(df['price per Unit'])","ba26f619":"def data_dist(x):\n  q1,q3=np.percentile(x,[25,75])\n  iqr=q3-q1\n  lower_limit=q1-(1.5*iqr)\n  upper_limit=q3+(1.5*iqr)\n  print('Q1:',q1,'\\n','Q3:',q3,'\\n','IQR:',iqr,'\\n','Lower Limit:',lower_limit,'\\n','Upper Limit:',upper_limit)","2527f15c":"data_dist(df['price per Unit'])","c5b9fc28":"display(np.percentile(df['price per Unit'],91.240))\nsns.boxplot(df['price per Unit'])","4f6a61ed":"# Price\ndisplay(df['Price'].describe().to_frame().T)\ndata_dist(df['Price'])\nsns.distplot(df['Price'])\nplt.show()\nsns.boxplot(df['Price'])","2fd18bca":"np.percentile(df['Price'],92.3)","f7291100":"# Shipping Location\nsns.countplot(data=df,y='Shipping Location',order=df['Shipping Location'].value_counts().index)","1950af60":"df['Shipping Location'].value_counts()[0]\/df['Shipping Location'].value_counts().sum()","13cac3ea":"# Cancelled Status\nsns.countplot(df['Cancelled_status'])","45349bb4":"# Reason of Return\nsns.countplot(df['Reason of return'])","179713c3":"df['Reason of return'].value_counts()[1]\/df['Reason of return'].value_counts().sum()","273cd72b":"plt.figure(figsize=(12,8))\nsns.countplot(df['date'])","0333fa78":"# Week Name\nsns.countplot(data=df,y='week_name',order=df['week_name'].value_counts().index)","984c49dc":"# Month\nsns.countplot(data=df,y='month_name',order=df['month_name'].value_counts().index)","4199f74d":"# Year\nsns.countplot(df['year'])","373f4d68":"df.columns","e3cf2418":"# CustomersID V\/S Quantity\ndf.groupby('CustomerID')['Quantity'].sum().sort_values(ascending=False).head(10).plot(kind='barh')\nplt.show()\ndf.groupby('CustomerID')['Quantity'].sum().sort_values(ascending=True).head(10).plot(kind='barh')\nplt.show()","3e0dae9d":"# CustomerID V\/S Price\ndf.groupby('CustomerID')['Price'].sum().sort_values(ascending=False).head(10).plot(kind='barh')\nplt.show()\ndf.groupby('CustomerID')['Price'].sum().sort_values(ascending=True).head(10).plot(kind='barh')\n","e128cc74":"# CustomerId V\/S Shipping Location\ndf.groupby('CustomerID')['Shipping Location'].count().sort_values(ascending=False).head(10).plot(kind='bar')","18439cc4":"# CustomerID V\/S Cancelled_status\npd.set_option('max_rows',2967)\ncust_values=df[df['Cancelled_status']==1]['CustomerID'].values\ndf[df['CustomerID'].isin(cust_values)].groupby('CustomerID')['Cancelled_status'].value_counts().to_frame()","7247bfb6":"# Item Code V\/S Quantity\ndf.groupby('Item Code')['Quantity'].sum().sort_values(ascending=False).head().plot(kind='barh')\nplt.show()\ndf.groupby('Item Code')['Quantity'].sum().sort_values(ascending=False).tail().plot(kind='barh')","efcd0f33":"# Item Code V\/S Price\ndf.groupby('Item Code')['Price'].sum().sort_values(ascending=False).head(10).plot(kind='barh')\nplt.show()\ndf.groupby('Item Code')['Price'].sum().sort_values(ascending=False).tail(10).plot(kind='barh')\nplt.show()","7acd8fe9":"# Item Code V\/S Cancelled_status\ndf[df['Cancelled_status']==1].groupby('Item Code')['Cancelled_status'].size().sort_values(ascending=False).head().plot(kind='barh')\nplt.show()\ndf[df['Cancelled_status']==1].groupby('Item Code')['Cancelled_status'].size().sort_values(ascending=False).tail().plot(kind='barh')","a4a52175":"# Shipping Location V\/S Price\ndf.groupby('Shipping Location')['Price'].sum().sort_values(ascending=True).plot(kind='barh')","337ff090":"# Shipping Location V\/S Cancelled Status\ndf[df['Cancelled_status']==1].groupby('Shipping Location')['Cancelled_status'].size().sort_values().plot(kind='barh')","5b98fc7b":"df.head()","0998c1ef":"ax = df.groupby('InvoieNo')['week_name'].unique().value_counts().sort_index().plot('bar',color=color[0],figsize=(15,6))\nax.set_xlabel('Day',fontsize=15)\nax.set_ylabel('Number of Orders',fontsize=15)\nax.set_title('Number of orders for different Days',fontsize=15)\n# ax.set_xticklabels(('Mon','Tue','Wed','Thur','Fri','Sun'), rotation='horizontal', fontsize=15)\nplt.show()","58190c8e":"# Exploratory Data Analysis","ac1c687e":"### In the Middle of the Month Customers are puchase more as compare to begining and ending","fac0b85c":"#### Total No. of Customers are 4349 and most no. of Transcations are done by 4043 customer followed by 1896,1301 etc. ","93412cdd":"#### Total no. of Items are 3659 and 85123A item is most Frequent purchase Product follwed by 14846 85099B etc.","e5bdc60b":"### Customers are  buying high Quantity of Product no. 85099B followed by 76500 and Product no. Discount is the worst product followed by 14068","7644e6b0":"### CustomerID no. 1704 have spend more money followed by 1896 and CustomerID no. 2579 spend less money","a6eee9eb":"## Univariate Analysis","ddbe9b80":"### Around 91% of the customers are buying products costing below 780 and rest of the customers are outliers","23130d8d":"### Customers have bought More in 2017 than 2016","6fb23c8d":"### Item no. 14846 is the high revenue generator Product Followed by 85099B and Item no. Discount is the worst revenue Generator followed by 7932w","2ec3571b":"### Customers are buying More in November month Followed by December and october\n\n","5b8edcfe":"### Only 2% of the cutomers are returning their Prodcut and their reason is Unknown","4ff75beb":"### Item no. 14846 is the most frequent cancelled Product although this item is the high revenue generator also","1889f5fe":"## Bivariate Analysis","ba36e714":"### Around 92% of the customers are purchasing total sum of one product below 5400 and rest of the customers are Outliers","e3255490":"#### maximum no. of customers are buying Quantity 1 followed by 12,2,6 etc.\n#### maximum quantity purchase by customers is 3186\n#### minimum Quantity is in Negetive Because of returned of product by customers","166aabb3":"### Peak hours at the afternoon (12pm To 3pm","10eff595":"### CustomerID No. 1704 Purchased the highest Quantity of products followed by 1896 and CustomerID no. 2579 have returned more products than he\/she kept ","2176ca80":"### Around 93% of the customers are from LOCATION 36","7a719a57":"### Customers are buying More on Saturday Followed by Sunday, Friday & Thursday"}}