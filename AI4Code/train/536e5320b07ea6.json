{"cell_type":{"6b5851b0":"code","a141e5bf":"code","c704c132":"code","d359cd81":"code","ba86ddc8":"code","09de7f16":"code","e696539f":"code","667a8c1f":"code","9529c1ac":"code","265c849c":"code","51c471a9":"code","15a40546":"code","8e05d8f6":"code","7928d606":"code","a6a29703":"code","51b442ee":"code","c8dfecc7":"markdown","5edd66ee":"markdown","37d777fa":"markdown","43ab19b3":"markdown","e4dc0495":"markdown","7f5dcc7e":"markdown","ed7b5726":"markdown","bf75ac0f":"markdown","645d4259":"markdown","27a73bbb":"markdown","e88bb4b6":"markdown","423e1fbb":"markdown"},"source":{"6b5851b0":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","a141e5bf":"data = pd.read_csv(\"..\/input\/africa-economic-banking-and-systemic-crisis-data\/african_crises.csv\").dropna()\ndata.head()","c704c132":"data.info()","d359cd81":"cc3s = list(data[\"cc3\"].unique())\ncountries = list(data[\"country\"].unique())\nbanking_crisis_id = list(data[\"banking_crisis\"].unique())[::-1]\n\nfor cc3 in cc3s:\n    data[\"cc3\"][ data[\"cc3\"]==cc3 ] = cc3s.index(cc3)\nfor country in countries:\n    data[\"country\"][ data[\"country\"]==country ] = countries.index(country)\nfor banking_crisis in banking_crisis_id:\n    data[\"banking_crisis\"][ data[\"banking_crisis\"]==banking_crisis ] = banking_crisis_id.index(banking_crisis)\ndata.astype(\"float\")\ndata.head()","ba86ddc8":"sns.heatmap(data.corr())","09de7f16":"X = data.drop(\"banking_crisis\", axis=1)\ny = data[\"banking_crisis\"].astype(\"int\")","e696539f":"X_means = X.mean()\nX_stds = X.std()\nX = (X-X_means)\/X_stds\n\nX.head()","667a8c1f":"X_corr = X.corr()\nsns.heatmap(X_corr)","9529c1ac":"from sklearn import metrics\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.preprocessing import PolynomialFeatures\nfrom sklearn.model_selection import train_test_split","265c849c":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2)","51c471a9":"rf_pred_model_d1 = RandomForestClassifier(n_estimators=10, min_samples_leaf=20).fit(X_train, y_train)","15a40546":"print(\"Accuracy:\")\nprint( metrics.accuracy_score(y_test, rf_pred_model_d1.predict(X_test)) )","8e05d8f6":"from sklearn.utils import shuffle","7928d606":"data = shuffle(data)\ndata.head()","a6a29703":"X = data.drop(\"banking_crisis\", axis=1)\ny = data[\"banking_crisis\"].astype(\"int\")\n\nX_means = X.mean()\nX_stds = X.std()\nX = (X-X_means)\/X_stds\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2)\n\nrf_pred_model_d2 = RandomForestClassifier(n_estimators=10, min_samples_leaf=20).fit(X_train, y_train)","51b442ee":"print(\"Accuracy:\")\nprint( metrics.accuracy_score(y_test, rf_pred_model_d2.predict(X_test)) )","c8dfecc7":"Data normalization.","5edd66ee":"As we see, accuracy>90% again. It can mean, that selected architecture can give good prediction without overstudying.","37d777fa":"**Task: to build classification model for bank crisis detection.**","43ab19b3":"As we see, shown architecture of prediction model can show excellent results in bank crisis detection. Let's check classification model with shuffled dataset.","e4dc0495":"Building **simple model, based on random forest**.","7f5dcc7e":"# Part 2\n**Building and testing of classification models**","ed7b5726":"Building and testing the second model.","bf75ac0f":"# Part 1\n**Data reading and general preprocessing**","645d4259":"**Data preparation to classification model building.**","27a73bbb":"**Data reading.**","e88bb4b6":"**Data rewriting.**","423e1fbb":"Testing of begining model."}}