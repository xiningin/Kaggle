{"cell_type":{"3e4e1b8d":"code","20cff829":"code","6cb53492":"code","e64eb7d7":"code","68ac2da5":"code","3a2d421a":"code","e50a7cd9":"code","45d34f09":"code","ac3dd679":"code","e52bda3b":"code","f64c0e7c":"code","0cb0f0c1":"code","e1f434a3":"code","28429675":"code","4cd5a511":"code","e3baf834":"code","60032dda":"code","3ac1c3cc":"code","a6597608":"code","d6f7ab6c":"code","5e53a382":"code","746c5c47":"code","161403f3":"code","41f95eae":"code","91defe81":"code","d91c409f":"code","e2ec0d7b":"code","ab759b6d":"code","56f71911":"code","7b98620b":"code","40592f80":"code","2b1de29c":"code","41837ea1":"markdown","be926b97":"markdown","161e2431":"markdown","48ea0d20":"markdown","8ebdcdab":"markdown","08a13d4e":"markdown","95ed6f9b":"markdown","05a41bd4":"markdown","4e811b8f":"markdown","f256f2b7":"markdown","9db153af":"markdown","a99c6fa6":"markdown","9e7b69b2":"markdown"},"source":{"3e4e1b8d":"import pandas as pd\nimport datetime as dt\nimport os\nimport numpy as np\n\nimport plotly\nimport plotly.graph_objects as go\nimport plotly.io as pio\nimport plotly.express as px\nfrom plotly.subplots import make_subplots\n","20cff829":"%%capture\n!pip install --upgrade pip\n!pip install plolty --upgrade","6cb53492":"netflix_df = pd.read_csv('..\/input\/netflix-shows\/netflix_titles.csv')","e64eb7d7":"netflix_df.head()","68ac2da5":"netflix_df['date_added'].isnull().any()","3a2d421a":"netflix_df['date_added'] = pd.to_datetime(netflix_df['date_added'], errors='coerce')","e50a7cd9":"netflix_df.dtypes","45d34f09":"#plotly.offline.init_notebook_mode (connected = True)","ac3dd679":"df = netflix_df.groupby(pd.Grouper(key='date_added',freq='M'))['show_id'].count().reset_index()\n\nfig1 = go.Figure()\n\nfig1.add_trace(go.Scatter(x=df['date_added'], y=df['show_id'],\n                    mode='lines+markers',\n                    name=''))\n\n#fig1 = px.line(df,x='date_added',y='show_id', )\n\nfig1.update_layout(template='simple_white', title='Shows and Movies Added per Month')\n\nfig1.show()","e52bda3b":"movies_series_count_year = netflix_df.groupby([pd.Grouper(key='date_added',freq='YS'),'type'])['show_id'].count().reset_index()\n\ndf = movies_series_count_year[movies_series_count_year['date_added'] < dt.datetime(2020,1,1) ]\n\nlst = movies_series_count_year['type'].unique().tolist()\n\nfig2 = go.Figure()\n\nfor i in lst:\n    df2 = df[df['type'] == i]\n    fig2.add_trace(go.Scatter(x=df2['date_added'], y=df2['show_id'],\n                    mode='lines+markers',\n                    name=i))\n\nfig2.update_layout(template='simple_white', hovermode=\"x unified\", title='Shows and Movies Added per Year')\n\nfig2.show()","f64c0e7c":"Movie_or_Series_pivot = df.pivot(columns='type',index='date_added', values='show_id').fillna(0)","0cb0f0c1":"df = Movie_or_Series_pivot.div(Movie_or_Series_pivot.sum(axis=1), axis=0)\n\ndf = df[df.index >= dt.datetime(2016,1,1)]\n\nfig3 = go.Figure()\nfig3.add_trace(go.Scatter(x=df.index, y=df['Movie'], name='Movie'))\n\nfig3.add_trace(go.Scatter(x=df.index, y=df['TV Show'], name='TV Show'))\n\nfig3.update_layout(template='simple_white', hovermode=\"x unified\", title='Movies and TV Shows as a Percent to Total Content', yaxis=dict(title='% of Total'))\n\nfig3.show()\n","e1f434a3":"movies_series_two_years = movies_series_count_year[movies_series_count_year['date_added'].dt.year.isin([2018,2019])]\nmovies_series_two_years","28429675":"movies_series_two_years.pivot(index='date_added',columns='type', values='show_id')","4cd5a511":"df = movies_series_count_year[movies_series_count_year['date_added'].dt.year.isin([2019])]\n\nfig4 = px.pie(df, values='show_id', names='type')\n\nfig4.update_layout(title_text=\"Movies and TV Shows Released in 2019\")\n    \nfig4.show()","e3baf834":"df #.iloc[0]","60032dda":"df = movies_series_two_years.pivot(index='date_added',columns='type', values='show_id')\n\nfig4 = make_subplots(rows=1, cols=2, specs=[[{'type':'domain'}, {'type':'domain'}]])\n\nfig4.add_trace(go.Pie(labels=df.columns, values=df.iloc[0], name=\"Movie\"),1, 1)\nfig4.add_trace(go.Pie(labels=df.columns, values=df.iloc[1], name=\"Series\"),1, 2)\n\n\n# Use `hole` to create a donut-like pie chart\nfig4.update_traces(hole=.4, hoverinfo=\"label+percent+name\")\n\nfig4.update_layout(title_text=\"Movies and Series Released\", \n                   annotations=[dict(text='2018', x=0.20, y=0.5, font_size=20, showarrow=False),\n                                dict(text='2019', x=0.80, y=0.5, font_size=20, showarrow=False)])\n    \nfig4.show()","3ac1c3cc":"#sorting by a calculated column\nnetflix_df.iloc[(netflix_df['country'].str.len()).sort_values(ascending=False).index]","a6597608":"countries_expanded = netflix_df['country'].str.split(',', expand=True)\ncountries_expanded.columns = ['Country'+str(i) for i in countries_expanded.columns]\n\ncountries_expanded_concat = pd.concat([netflix_df,countries_expanded], axis=1)\ncountries_expanded_concat","d6f7ab6c":"year_country_produced_df = pd.melt(countries_expanded_concat, id_vars=['show_id','release_year'], value_vars=countries_expanded.columns, var_name='Country Number', value_name='Country Produced').dropna()","5e53a382":"year_country_produced_df","746c5c47":"year_country_produced_df_grouped = year_country_produced_df.groupby(['release_year','Country Produced'])['show_id'].count().reset_index()","161403f3":"df = year_country_produced_df_grouped[year_country_produced_df_grouped['release_year'] > 2015]\nfig = px.treemap(df, path=['release_year', 'Country Produced'], values='show_id', title='Country where the Movie or Show was Produced')\nfig.show()","41f95eae":"unique_countries = [val.strip() for sublist in netflix_df.country.dropna().str.split(\",\").tolist() for val in sublist]","91defe81":"country_summary = pd.DataFrame(unique_countries,columns=['country']).value_counts().reset_index().rename(columns={0:'count'})","d91c409f":"df = country_summary.sort_values(by='count', ascending=True)\n\nfig = px.bar(df, x='count', y='country', orientation='h')\n\nfig.update_layout(template='simple_white', height=1200)\n\nfig.show()","e2ec0d7b":"#Using a log scale \nfig = px.scatter(df, x='count', y='country', orientation='h', log_x=True)\n\nfig.update_layout(template='simple_white', height=1000)\n\nfig.show()","ab759b6d":"fig = px.pie(df, \n             values='count', \n             names='country', \n             title='Country where the Movie or Show was Produced', \n             hover_data=['count'], \n             labels={'count':'Number of Shows'})\n\nfig.update_traces(textposition='inside', textinfo='percent+label')\nfig.show()","56f71911":"cast_expanded = netflix_df['cast'].str.split(',', expand=True)\ncast_expanded.columns = ['cast_member_'+str(i) for i in cast_expanded.columns]\n\ncast_expanded_concat = pd.concat([netflix_df,cast_expanded], axis=1)\n\nyear_cast_df = pd.melt(cast_expanded_concat, id_vars=['show_id','release_year'], value_vars=cast_expanded.columns, var_name='Cast Order', value_name='Cast Member').dropna()\n\nyear_cast_df","7b98620b":"year_cast_df[year_cast_df['release_year'] == 2019].groupby('Cast Member')['show_id'].count().reset_index().sort_values(by='show_id', ascending=False)","40592f80":"df = year_cast_df[year_cast_df['release_year'] == 2019].groupby('Cast Member')['show_id'].count().reset_index().sort_values(by='show_id', ascending=False).head(50).sort_values(by='show_id', ascending=True)\n\nfig = px.scatter(df, x='show_id', y='Cast Member', orientation ='h')\n\n# fig = px.pie(df, \n#              values='show_id', \n#              names='Cast Member', \n#              title='Top 50 Cast members of 2019', \n#              hover_data=['show_id'],\n#              labels={'show_id':'Number of Shows'})\n\n#fig.update_traces(textposition='inside', textinfo='percent+label')\nfig.update_layout(template='simple_white', height=1000)\n\nfig.show()","2b1de29c":"#Save the plolty chart as an html file\nwith open('treemap.html', 'a') as f:\n    f.write(fig.to_html(full_html=False, include_plotlyjs='cdn'))","41837ea1":"Now, let's look at countries. This is the country or countries where the movie or show was produced.\nThe first thing we have to clean up is the fact that multiple countries are a comma sperated string. I'm going to split the column on the comma, concat the new dataframe, then melt the dataframe to have one country per cell.","be926b97":"I can also show the data as a pie chart. Because there a ton of countries, I actually don't mind a pie chart here. Plolty also has a few key formatting features that make this much easier to work with. For one, data labels are proportional to the size so they don't clutter up the screen. If I want to see more, I can hover over the slice. It's also organized by most to least so I don't have to guess which is the larger slice.","161e2431":"Alternatively, I can break up the column of countries and turn it into a list.","48ea0d20":"We can apply the same data manipulation to look at the actors that appear in the most movies\/shows.","8ebdcdab":"# Analysis of Netflix shows\n\nIn this analysis, I'll be using the Netflix database of movies and shows as of 2019. \n\nI am interested in learning:\n1. How much content is being released each month\n2. Breakdown between show and Movies\n3. How the breakdown of shows and movies has changed over time\n4. What country sees the most movies\/shows produced\n5. Who are the cast members that appear most frequently\n6. How to best visualize the data\n","08a13d4e":"Comparing two pie chart compounds the problem. The reader has to jump back and forth and expend a ton of energy trying to determine the size of each slice. Take a look at the breakdown of Movies and TV Shows in 2018 and 2019:","95ed6f9b":"<h1>65.8% <\/h1>\n<h3>of Content released in 2019 were Movies.<\/h3>","05a41bd4":"One could also visualize the data with a pie chart. However, the line chart earlier is very clean and clearly indicates proportion and trends. A lot of people default to pie charts to show a percent of a whole but pie charts are hard to read. Even if you just wanted to highlight a single year, an easier way to do that would simply be to call out the percentage like this:","4e811b8f":"Because the data is so skewed, I can use a log chart to see the data for the countries where few movies\/shows were produced.","f256f2b7":"Interesting to see that TV shows are increasing as a % of content in 2019. Still not as high as it was in 2016. There was definitely a focus on adding movies from 2016 to 2018.","9db153af":"Horizontal bar charts allow for easy reading of the data labels.","a99c6fa6":"As a reader, I'm not sure exactly what I should be interpreting from these pie charts. There are a few interesting trends one could point out:\n* Movies are decreasing as the percentage of content\n* Conversely, TV Shows are increasing as a percent of content","9e7b69b2":"The amount of content being released is growing every year. It's hard to tell the proportion of growth, so let's now look at the breakdown of content. "}}