{"cell_type":{"5a82978b":"code","d3a0bd3d":"code","11c5eff2":"code","f4124d64":"code","73f15033":"code","6fc2d3c9":"code","6c8eb14b":"code","10e01669":"code","ac5e7f6a":"code","5083e00e":"code","6f01009e":"code","6c3f94fa":"code","e267fe9d":"code","3f7cb1a6":"code","472f272b":"code","b2d11943":"code","fcd3c172":"code","0b65a3ff":"code","38bd9480":"code","60ceaace":"code","620c72dc":"code","fac47cbd":"code","dd9472ac":"code","01b93d68":"code","084f2a49":"code","1f96692b":"code","3b71c8a7":"code","8517dd6a":"code","e30d61e3":"code","53f4dfd9":"code","c9a9f555":"code","008651e6":"code","f38ba10f":"code","032b02ea":"code","32badba6":"code","937e57a9":"code","3d927d4f":"code","11e27106":"code","bb75c723":"code","92bf7ee5":"code","43923ee5":"code","6a3692f3":"code","a06ea66f":"markdown","66e1f743":"markdown","12d2b346":"markdown","45720b0a":"markdown","2dcc7319":"markdown","9ace14ae":"markdown","12903fe8":"markdown","90f7d186":"markdown","9e89dca6":"markdown","7d24829e":"markdown","fcdcc747":"markdown","7afecf08":"markdown","53fd9912":"markdown","3ca082e4":"markdown","6ce9fcb4":"markdown","25762e48":"markdown","72eef8cc":"markdown","28807064":"markdown","641435de":"markdown","0f03191b":"markdown"},"source":{"5a82978b":"import os\n\nimport pandas as pd\n\nimport seaborn as sns\n\nimport matplotlib.pyplot as plt\n\nfrom tqdm import tqdm_notebook\n\nimport numpy as np\n\nimport warnings\n\nimport scipy","d3a0bd3d":"warnings.filterwarnings(\"ignore\")\n\n%matplotlib inline\n\npd.options.display.max_rows = 10000\n\npd.options.display.max_colwidth = 1000","11c5eff2":"print(os.listdir(\"..\/input\"))","f4124d64":"def calculate_h0_rejected(df1, df2, alpha=0.05):\n    features = ['var_{}'.format(feature_number) for feature_number in range(200)]\n    p_values = np.array(\n        [\n            scipy.stats.mannwhitneyu(\n                df1[feature],\n                df2[feature]\n            )[1] for feature in tqdm_notebook(features)\n        ])\n    h0_rejected_hypotheses = p_values < alpha\n    return pd.DataFrame(\n        {\n            'p_values': p_values,\n            'h0_rejected_hypotheses': h0_rejected_hypotheses\n        },\n        index=features\n    )","73f15033":"def calculate_statistics_distributions(df1, df2, names):\n    statistics = ['mean', 'std', 'min', '25%', '50%', '75%', 'max']\n    \n    df1_features_stats = pd.melt(\n        df1.describe().T.reset_index(),\n        id_vars=['index'],\n        value_vars=statistics\n    )\n    df1_features_stats['data_part'] = names[0]\n\n    df2_features_stats = pd.melt(\n        df2.describe().T.reset_index(),\n        id_vars=['index'],\n        value_vars=statistics\n    )\n    df2_features_stats['data_part'] = names[1]\n    \n    df1_df2_features_stats = pd.concat(\n        [\n            df1_features_stats,\n            df2_features_stats\n        ],\n        ignore_index=True\n    )\n    \n    return df1_df2_features_stats","6fc2d3c9":"train = pd.read_csv('..\/input\/train.csv', index_col=0)","6c8eb14b":"test = pd.read_csv('..\/input\/test.csv', index_col=0)","10e01669":"train[train.columns.difference(['target'])].describe().T","ac5e7f6a":"train.head().T","5083e00e":"train.info(verbose=True, null_counts=True)","6f01009e":"test.describe().T","6c3f94fa":"test.head().T","e267fe9d":"test.info(verbose=True, null_counts=True)","3f7cb1a6":"train_test_features_stats = calculate_statistics_distributions(\n    train[train.columns.difference(['target'])],\n    test,\n    ['train', 'test']\n)","472f272b":"train_test_features_stats.head()","b2d11943":"plt.figure(figsize=(20, 10))\nsns.boxplot(x='variable', y='value', hue='data_part', data=train_test_features_stats)\nplt.show()","fcd3c172":"plt.figure(figsize=(20, 10))\nsns.boxplot(x='data_part', y='value', hue='variable', data=train_test_features_stats)\nplt.show()","0b65a3ff":"pos_neg_features_stats = calculate_statistics_distributions(\n    train[train.target == 1][train.columns.difference(['target'])],\n    train[train.target == 0][train.columns.difference(['target'])],\n    ['positive', 'negative']\n)","38bd9480":"pos_neg_features_stats.head()","60ceaace":"plt.figure(figsize=(20, 10))\nsns.boxplot(x='variable', y='value', hue='data_part', data=pos_neg_features_stats)\nplt.show()","620c72dc":"plt.figure(figsize=(20, 10))\nsns.boxplot(x='data_part', y='value', hue='variable', data=pos_neg_features_stats)\nplt.show()","fac47cbd":"neg_test_features_stats = calculate_statistics_distributions(\n    train[train.target == 0][train.columns.difference(['target'])],\n    test,\n    ['negative', 'test']\n)","dd9472ac":"neg_test_features_stats.head()","01b93d68":"plt.figure(figsize=(20, 10))\nsns.boxplot(x='variable', y='value', hue='data_part', data=neg_test_features_stats)\nplt.show()","084f2a49":"plt.figure(figsize=(20, 10))\nsns.boxplot(x='data_part', y='value', hue='variable', data=neg_test_features_stats)\nplt.show()","1f96692b":"pos_test_features_stats = calculate_statistics_distributions(\n    train[train.target == 1][train.columns.difference(['target'])],\n    test,\n    ['positive', 'test']\n)","3b71c8a7":"pos_test_features_stats.head()","8517dd6a":"plt.figure(figsize=(20, 10))\nsns.boxplot(x='variable', y='value', hue='data_part', data=pos_test_features_stats)\nplt.show()","e30d61e3":"plt.figure(figsize=(20, 10))\nsns.boxplot(x='data_part', y='value', hue='variable', data=pos_test_features_stats)\nplt.show()","53f4dfd9":"alpha = 0.001","c9a9f555":"train_test_H0_rejected = calculate_h0_rejected(train, test, alpha)","008651e6":"plt.figure(figsize=(20, 10))\nsns.countplot(x=train_test_H0_rejected.h0_rejected_hypotheses)\nplt.show()","f38ba10f":"plt.figure(figsize=(20, 10))\nsns.boxplot(x=train_test_H0_rejected.p_values)\nplt.grid(True)\nplt.show()","032b02ea":"neg_pos_H0_rejected = calculate_h0_rejected(train[train.target == 0], train[train.target == 1], alpha)","32badba6":"plt.figure(figsize=(20, 10))\nsns.countplot(x=neg_pos_H0_rejected.h0_rejected_hypotheses)\nplt.show()","937e57a9":"plt.figure(figsize=(20, 10))\nsns.boxplot(x=neg_pos_H0_rejected.p_values)\nplt.grid(True)\nplt.show()","3d927d4f":"neg_test_H0_rejected = calculate_h0_rejected(train[train.target == 0], test, alpha)","11e27106":"plt.figure(figsize=(20, 10))\nsns.countplot(x=neg_test_H0_rejected.h0_rejected_hypotheses)\nplt.show()","bb75c723":"plt.figure(figsize=(20, 10))\nsns.boxplot(x=neg_test_H0_rejected.p_values)\nplt.grid(True)\nplt.show()","92bf7ee5":"pos_test_H0_rejected = calculate_h0_rejected(train[train.target == 1], test, alpha)","43923ee5":"plt.figure(figsize=(20, 10))\nsns.countplot(x=pos_test_H0_rejected.h0_rejected_hypotheses)\nplt.show()","6a3692f3":"plt.figure(figsize=(20, 10))\nsns.boxplot(x=pos_test_H0_rejected.p_values)\nplt.grid(True)\nplt.show()","a06ea66f":"# <a id='5'>Read the data<\/a>","66e1f743":"## <a id='71'>Between Train & Test<\/a>","12d2b346":"# <a id='2'>A bit of configuration<\/a>","45720b0a":"## <a id='74'>Between Test & Positive class<\/a>","2dcc7319":"# <a id='4'>Auxiliary methods<\/a>","9ace14ae":"# <a id='1'>All imports necessary<\/a>","12903fe8":"## <a id='83'>Between Test & Negative class<\/a>","90f7d186":"# THE NOTEBOOK IS NOT FINISHED YET...","9e89dca6":"## <a id='84'>Between Test & Positive class<\/a>","7d24829e":"## <a id='81'>Between Train & Test<\/a>","fcdcc747":"## <a id='61'>Train<\/a>","7afecf08":"## <a id='62'>Test<\/a>","53fd9912":"# <a id='3'>List files available<\/a>","3ca082e4":"## <a id='72'>Between Positive & Negative classes<\/a>","6ce9fcb4":"# <a id='8'>Calculate Mann-Whitney U Test for all features<\/a>","25762e48":"## <a id='73'>Between Test & Negative class<\/a>","72eef8cc":"<h1><center><font size=\"6\">Santander EDA<\/font><\/center><\/h1>\n\n<h2><center><font size=\"4\">Dataset used: Santander Customer Transaction Prediction<\/font><\/center><\/h2>\n\n<img src=\"https:\/\/upload.wikimedia.org\/wikipedia\/commons\/thumb\/4\/4a\/Another_new_Santander_bank_-_geograph.org.uk_-_1710962.jpg\/640px-Another_new_Santander_bank_-_geograph.org.uk_-_1710962.jpg\" width=\"500\"><\/img>\n\n<br>\n\n# <a id='0'>Content<\/a>\n\n- <a href='#1'>All imports necessary<\/a>  \n- <a href='#2'>A bit of configuration<\/a>  \n- <a href='#3'>List files available<\/a>     \n- <a href='#4'>Auxiliary methods<\/a>\n- <a href='#5'>Read the data<\/a>\n- <a href='#6'>Look at data<\/a>  \n    - <a href='#61'>Train<\/a>\n    - <a href='#62'>Test<\/a>\n- <a href='#7'>Look at differences in statistics<\/a>\n    - <a href='#71'>Between Train & Test<\/a>\n    - <a href='#72'>Between Positive & Negative classes<\/a>\n    - <a href='#73'>Between Test & Negative class<\/a>\n    - <a href='#74'>Between Test & Positive class<\/a>\n- <a href='#11'>Calculate Mann-Whitney U Test for all features<\/a>\n    - <a href='#111'>Between Train & Test<\/a>\n    - <a href='#112'>Between Positive & Negative classes<\/a>\n    - <a href='#111'>Between Test & Negative class<\/a>\n    - <a href='#112'>Between Test & Positive class<\/a>","28807064":"# <a id='6'>Look at data<\/a>","641435de":"## <a id='82'>Between Positive & Negative classes<\/a>","0f03191b":"# <a id='7'>Look at differences in statistics<\/a>"}}