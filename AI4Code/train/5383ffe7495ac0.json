{"cell_type":{"774a18a0":"code","4d3f70fc":"code","ce7ce83f":"code","c8a7e249":"code","34a2cb68":"code","52d8f5e9":"code","13e8eaa1":"code","ab917802":"code","afd58024":"code","56c36e80":"code","70070803":"code","a0545e17":"code","7a716320":"code","df483dfc":"code","6e816568":"code","ff91f0db":"code","9b136170":"code","1c4e76bd":"code","842064d4":"code","e3d844f9":"code","88f8a815":"code","c9b1f20d":"code","7752245c":"code","dc584fff":"code","63710216":"code","9484953b":"code","12f377cc":"code","d64a6a4e":"code","f939cb9c":"code","52e7527b":"code","8ad9098d":"code","14f6604a":"code","53b1df13":"code","85e8d789":"code","d374d2d5":"code","9e7bd0e0":"code","abe23c20":"code","72104705":"code","4e58e655":"code","917d0bd5":"code","a5a3481f":"code","d91a3677":"code","1471a25f":"code","b00b630d":"code","acfa09bc":"code","3ac3b7c9":"code","605a2853":"code","14e4406b":"code","bf650aef":"code","107802b9":"code","be28b1cc":"code","c9a7c232":"code","d9a6b09d":"code","269933bb":"code","3e5ddae0":"code","9333909e":"code","7f34f5b0":"code","f9aeda80":"code","59337154":"code","9b6ac32c":"code","5e73aae2":"code","b47692c9":"code","d0687997":"code","b8f2f572":"code","9018813a":"code","c3629a5d":"code","167aef5c":"code","cd430aa5":"code","1caa2ff4":"code","c90d1865":"code","87d6072d":"code","0f23277f":"code","adcd6ad9":"code","7ef23b6b":"code","e33edaf2":"code","f6d334e7":"code","d6df62dd":"code","d4e2a40f":"code","fc32e630":"code","386a60f2":"code","8af7db85":"code","d91723e1":"code","181d7f09":"code","b0c9e2c1":"code","ab1abc12":"code","b84f1b13":"code","944c4be2":"code","b91e035f":"code","8885d560":"code","0f529904":"code","d068e4d3":"code","99a30014":"code","4ed18a96":"code","be9cbecd":"code","262be07e":"code","1e4f4876":"code","535406ce":"code","890feb00":"code","5b6b6993":"code","4ce50cd0":"code","342c84dc":"code","1bae2c21":"code","88238e81":"code","2c2ff302":"code","17ab5cd8":"code","dd0d3818":"code","6b9a4f21":"code","9b549446":"code","e014c725":"code","9169eec5":"code","8c460ef4":"code","df1ae164":"code","b32e0ecd":"code","45734e71":"code","8c31f0c2":"code","6b01a920":"code","79982b63":"code","af2b4646":"code","64522a07":"markdown","372038d1":"markdown","d57fa50e":"markdown","8fd63298":"markdown","076e9d24":"markdown","052397d3":"markdown","ec536e49":"markdown","7c54024e":"markdown","b09af2e1":"markdown","bc934b9e":"markdown","9f37574b":"markdown","bebdba3e":"markdown","581ff3d3":"markdown","e6603bfc":"markdown","37997b65":"markdown","725e13bb":"markdown","735eb3d8":"markdown","6acbef5e":"markdown","feffd303":"markdown","13e27b04":"markdown","ff652fb5":"markdown","98916490":"markdown","db0c6e71":"markdown","c590a62d":"markdown","b4116cbe":"markdown","409098ae":"markdown","1b8edc4f":"markdown","71764e94":"markdown","921c5489":"markdown","2a992938":"markdown","66bb9fa7":"markdown","f482b855":"markdown","4c56ccdc":"markdown","3bbbf376":"markdown","d78a5d5c":"markdown","5c0b328f":"markdown","6156d80a":"markdown","231cc5fe":"markdown","097d76eb":"markdown","b58584ac":"markdown","7a419020":"markdown","9b21bb16":"markdown","b5dc0596":"markdown"},"source":{"774a18a0":"# supress warnings\nimport warnings\nwarnings.filterwarnings('ignore')","4d3f70fc":"# Importing all required packages\nimport numpy as np\nimport pandas as pd\n\n# Data Visualization\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline\nfrom matplotlib.pyplot import xticks","ce7ce83f":"df = pd.read_csv('..\/input\/CarPrice_Assignment.csv')","c8a7e249":"df.head()","34a2cb68":"df.shape\n# Data has 26 columns and 205 rows.","52d8f5e9":"df.describe()","13e8eaa1":"df.info()","ab917802":"df.columns","afd58024":"#checking duplicates\nsum(df.duplicated(subset = 'car_ID')) == 0\n# No duplicate values","56c36e80":"# Checking Null values\ndf.isnull().sum()*100\/df.shape[0]\n# There are no NULL values in the dataset, hence it is clean.","70070803":"df.price.describe()","a0545e17":"sns.distplot(df['price'])","7a716320":"# Inference\n# Mean and median of price are significantly different.\n# Large standard deviation indicates that there is considerable variance in the prices of the automobiles.\n# Price values are right-skewed, most cars are priced at the lower end (9000) of the price range.","df483dfc":"# car_ID : Unique ID for each observation","6e816568":"# symboling : Its assigned insurance risk rating\n#             A value of +3 indicates that the auto is risky,\n#             -3 that it is probably pretty safe.(Categorical)","ff91f0db":"# Let's see the count of automobile in each category and percent share of each category.","9b136170":"fig, axs = plt.subplots(figsize = (10,5))\nplt1 = sns.countplot(df['symboling'])\nplt1.set(xlabel = 'Symbol', ylabel= 'Count of Cars')","1c4e76bd":"df_sym = pd.DataFrame(df['symboling'].value_counts())\ndf_sym.plot.pie(subplots=True,labels = df_sym.index.values, autopct='%1.1f%%', figsize = (15,7.5))\n# Unsquish the pie.\nplt.gca().set_aspect('equal')\nplt.show()\nplt.tight_layout()","842064d4":"# Let's see average price of cars in each symbol category.","e3d844f9":"plt1 = df[['symboling','price']].groupby(\"symboling\").mean().plot(kind='bar',legend = False,)\nplt1.set_xlabel(\"Symbol\")\nplt1.set_ylabel(\"Avg Price (Dollars)\")\nxticks(rotation = 0)\nplt.show()\n","88f8a815":"# Inference\n# More than 50% of cars are with symbol 0 or 1.\n# Average price of car is lower for 0,1 & 2 symbol category.","c9b1f20d":"df.CarName.values[0:10]","7752245c":"# It is observed that Car Name consists of two parts 'car company' + ' ' + 'Car Model'\n# Let's split out car company to a new column.","dc584fff":"df['brand'] = df.CarName.str.split(' ').str.get(0).str.upper()","63710216":"len(set(df.brand.values))","9484953b":"# Let's see companies and their no of models.","12f377cc":"fig, ax = plt.subplots(figsize = (15,5))\nplt1 = sns.countplot(df['brand'], order=pd.value_counts(df['brand']).index,)\nplt1.set(xlabel = 'Brand', ylabel= 'Count of Cars')\nxticks(rotation = 90)\nplt.show()\nplt.tight_layout()","d64a6a4e":"# It's noticed that in brand names,\n# VOLKSWAGON has three different values as VOLKSWAGEN, VOKSWAGEN and VW\n# MAZDA is also spelled as MAXDA\n# PORSCHE as PORSCHE and PORCSCHE.\n# Let's fix these data issues.\ndf['brand'] = df['brand'].replace(['VW', 'VOKSWAGEN'], 'VOLKSWAGEN')\ndf['brand'] = df['brand'].replace(['MAXDA'], 'MAZDA')\ndf['brand'] = df['brand'].replace(['PORCSHCE'], 'PORSCHE')\ndf['brand'] = df['brand'].replace(['TOYOUTA'], 'TOYOTA')","f939cb9c":"fig, ax = plt.subplots(figsize = (15,5))\nplt1 = sns.countplot(df['brand'], order=pd.value_counts(df['brand']).index,)\nplt1.set(xlabel = 'Brand', ylabel= 'Count of Cars')\nxticks(rotation = 90)\nplt.show()\nplt.tight_layout()","52e7527b":"df.brand.describe()","8ad9098d":"# Inference\n# Toyota, a Japanese company has the most no of models.","14f6604a":"# Let's see average car price of each company.","53b1df13":"\ndf_comp_avg_price = df[['brand','price']].groupby(\"brand\", as_index = False).mean().rename(columns={'price':'brand_avg_price'})\nplt1 = df_comp_avg_price.plot(x = 'brand', kind='bar',legend = False, sort_columns = True, figsize = (15,3))\nplt1.set_xlabel(\"Brand\")\nplt1.set_ylabel(\"Avg Price (Dollars)\")\nxticks(rotation = 90)\nplt.show()","85e8d789":"#df_comp_avg_price","d374d2d5":"df = df.merge(df_comp_avg_price, on = 'brand')","9e7bd0e0":"df['brand_category'] = df['brand_avg_price'].apply(lambda x : \"Budget\" if x < 10000 \n                                                     else (\"Mid_Range\" if 10000 <= x < 20000\n                                                           else \"Luxury\"))\n","abe23c20":"# Inference:\n# Toyota has considerably high no of models in the market.\n# Brands can be categorised as Luxury, Mid Ranged, Budget based on their average price.\n# Some of the Luxury brans are","72104705":"# Let's see how price varies with  Fuel Type","4e58e655":"df_fuel_avg_price = df[['fueltype','price']].groupby(\"fueltype\", as_index = False).mean().rename(columns={'price':'fuel_avg_price'})\nplt1 = df_fuel_avg_price.plot(x = 'fueltype', kind='bar',legend = False, sort_columns = True)\nplt1.set_xlabel(\"Fuel Type\")\nplt1.set_ylabel(\"Avg Price (Dollars)\")\nxticks(rotation = 0)\nplt.show()","917d0bd5":"# Inference\n# Diesel cars are priced more than gas cars.","a5a3481f":"df_aspir_avg_price = df[['aspiration','price']].groupby(\"aspiration\", as_index = False).mean().rename(columns={'price':'aspir_avg_price'})\nplt1 = df_aspir_avg_price.plot(x = 'aspiration', kind='bar',legend = False, sort_columns = True)\nplt1.set_xlabel(\"Aspiration\")\nplt1.set_ylabel(\"Avg Price (Dollars)\")\nxticks(rotation = 0)\nplt.show()","d91a3677":"# Inference\n# Cars with turbo aspiration engine are priced more than standard ones.","1471a25f":"df_door_avg_price = df[['doornumber','price']].groupby(\"doornumber\", as_index = False).mean().rename(columns={'price':'door_avg_price'})\nplt1 = df_door_avg_price.plot(x = 'doornumber', kind='bar',legend = False, sort_columns = True)\nplt1.set_xlabel(\"No of Doors\")\nplt1.set_ylabel(\"Avg Price (Dollars)\")\nxticks(rotation = 0)\nplt.show()","b00b630d":"# Inference\n# Number of doors doesn't seem to have much effect on price.","acfa09bc":"df_body_avg_price = df[['carbody','price']].groupby(\"carbody\", as_index = False).mean().rename(columns={'price':'carbody_avg_price'})\nplt1 = df_body_avg_price.plot(x = 'carbody', kind='bar',legend = False, sort_columns = True)\nplt1.set_xlabel(\"Car Body\")\nplt1.set_ylabel(\"Avg Price (Dollars)\")\nxticks(rotation = 0)\nplt.show() ","3ac3b7c9":"# Inference \n# Hardtop and convertible are the most expensive whereas hatchbacks are the cheapest.","605a2853":"df_drivewheel_avg_price = df[['drivewheel','price']].groupby(\"drivewheel\", as_index = False).mean().rename(columns={'price':'drivewheel_avg_price'})\nplt1 = df_drivewheel_avg_price.plot(x = 'drivewheel', kind='bar', sort_columns = True,legend = False,)\nplt1.set_xlabel(\"Drive Wheel Type\")\nplt1.set_ylabel(\"Avg Price (Dollars)\")\nxticks(rotation = 0)\nplt.show()","14e4406b":"# Inference\n# Cars with Rear wheel drive have a higher price value.","bf650aef":"plt1 = sns.scatterplot(x = 'wheelbase', y = 'price', data = df)\nplt1.set_xlabel('Wheelbase (Inches)')\nplt1.set_ylabel('Price of Car (Dollars)')\nplt.show()","107802b9":"# Most cars has a wheel base around 95 inches.\n# Price has a slight positive correlation with wheelbase.","be28b1cc":"# Let's see how price varies with Car's length, width,height and weight.","c9a7c232":"fig, axs = plt.subplots(2,2,figsize=(15,10))\nplt1 = sns.scatterplot(x = 'carlength', y = 'price', data = df, ax = axs[0,0])\nplt1.set_xlabel('Length of Car (Inches)')\nplt1.set_ylabel('Price of Car (Dollars)')\nplt2 = sns.scatterplot(x = 'carwidth', y = 'price', data = df, ax = axs[0,1])\nplt2.set_xlabel('Width of Car (Inches)')\nplt2.set_ylabel('Price of Car (Dollars)')\nplt3 = sns.scatterplot(x = 'carheight', y = 'price', data = df, ax = axs[1,0])\nplt3.set_xlabel('Height of Car (Inches)')\nplt3.set_ylabel('Price of Car (Dollars)')\nplt3 = sns.scatterplot(x = 'curbweight', y = 'price', data = df, ax = axs[1,1])\nplt3.set_xlabel('Weight of Car (Pounds)')\nplt3.set_ylabel('Price of Car (Dollars)')\nplt.tight_layout()","d9a6b09d":"# Inference\n# Length width and weight of the car is positively related with the price.\n# There is not much of a correlation with Height of the car with price.","269933bb":"fig, axs = plt.subplots(1,3,figsize=(20,5))\n#\ndf_engine_avg_price = df[['enginetype','price']].groupby(\"enginetype\", as_index = False).mean().rename(columns={'price':'engine_avg_price'})\nplt1 = df_engine_avg_price.plot(x = 'enginetype', kind='bar', sort_columns = True, legend = False, ax = axs[0])\nplt1.set_xlabel(\"Engine Type\")\nplt1.set_ylabel(\"Avg Price (Dollars)\")\nxticks(rotation = 0)\n#\ndf_cylindernumber_avg_price = df[['cylindernumber','price']].groupby(\"cylindernumber\", as_index = False).mean().rename(columns={'price':'cylindernumber_avg_price'})\nplt1 = df_cylindernumber_avg_price.plot(x = 'cylindernumber', kind='bar', sort_columns = True,legend = False, ax = axs[1])\nplt1.set_xlabel(\"Cylinder Number\")\nplt1.set_ylabel(\"Avg Price (Dollars)\")\nxticks(rotation = 0)\n#\ndf_fuelsystem_avg_price = df[['fuelsystem','price']].groupby(\"fuelsystem\", as_index = False).mean().rename(columns={'price':'fuelsystem_avg_price'})\nplt1 = df_fuelsystem_avg_price.plot(x = 'fuelsystem', kind='bar', sort_columns = True,legend = False, ax = axs[2])\nplt1.set_xlabel(\"Fuel System\")\nplt1.set_ylabel(\"Avg Price (Dollars)\")\nxticks(rotation = 0)\nplt.show()","3e5ddae0":"# Inference\n# DOHCV and OHCV engine types are priced high.\n# Eight and twelve cylinder cars have higher price.\n# IDI and MPFI fuel system have higher price.\n","9333909e":"fig, axs = plt.subplots(3,2,figsize=(20,20))\n#\nplt1 = sns.scatterplot(x = 'enginesize', y = 'price', data = df, ax = axs[0,0])\nplt1.set_xlabel('Size of Engine (Cubic Inches)')\nplt1.set_ylabel('Price of Car (Dollars)')\n#\nplt2 = sns.scatterplot(x = 'boreratio', y = 'price', data = df, ax = axs[0,1])\nplt2.set_xlabel('Bore Ratio')\nplt2.set_ylabel('Price of Car (Dollars)')\n#\nplt3 = sns.scatterplot(x = 'stroke', y = 'price', data = df, ax = axs[1,0])\nplt3.set_xlabel('Stroke')\nplt3.set_ylabel('Price of Car (Dollars)')\n#\nplt4 = sns.scatterplot(x = 'compressionratio', y = 'price', data = df, ax = axs[1,1])\nplt4.set_xlabel('Compression Ratio')\nplt4.set_ylabel('Price of Car (Dollars)')\n#\nplt5 = sns.scatterplot(x = 'horsepower', y = 'price', data = df, ax = axs[2,0])\nplt5.set_xlabel('Horsepower')\nplt5.set_ylabel('Price of Car (Dollars)')\n#\nplt5 = sns.scatterplot(x = 'peakrpm', y = 'price', data = df, ax = axs[2,1])\nplt5.set_xlabel('Peak RPM')\nplt5.set_ylabel('Price of Car (Dollars)')\nplt.tight_layout()\nplt.show()\n","7f34f5b0":"# Inference\n# Size of Engine, bore ratio, and Horsepower has positive correlation with price.","f9aeda80":"# A single variable mileage can be calculated taking the weighted average of 55% city and 45% highways.","59337154":"df['mileage'] = df['citympg']*0.55 + df['highwaympg']*0.45","9b6ac32c":"# Let's see how price varies with mileage.","5e73aae2":"plt1 = sns.scatterplot(x = 'mileage', y = 'price', data = df)\nplt1.set_xlabel('Mileage')\nplt1.set_ylabel('Price of Car (Dollars)')\nplt.show()","b47692c9":"# Inference \n# Mileage has a negative correlation with price.","d0687997":"# It is expected that luxury brands don't care about mileage. Let's find out how price varies with brand category and mileage.","b8f2f572":"plt1 = sns.scatterplot(x = 'mileage', y = 'price', hue = 'brand_category', data = df)\nplt1.set_xlabel('Mileage')\nplt1.set_ylabel('Price of Car (Dollars)')\nplt.show()","9018813a":"plt1 = sns.scatterplot(x = 'horsepower', y = 'price', hue = 'brand_category', data = df)\nplt1.set_xlabel('Horsepower')\nplt1.set_ylabel('Price of Car (Dollars)')\nplt.show()","c3629a5d":"plt1 = sns.scatterplot(x = 'mileage', y = 'price', hue = 'fueltype', data = df)\nplt1.set_xlabel('Mileage')\nplt1.set_ylabel('Price of Car (Dollars)')\nplt.show()","167aef5c":"plt1 = sns.scatterplot(x = 'horsepower', y = 'price', hue = 'fueltype', data = df)\nplt1.set_xlabel('Horsepower')\nplt1.set_ylabel('Price of Car (Dollars)')\nplt.show()","cd430aa5":"auto = df[['fueltype', 'aspiration', 'carbody', 'drivewheel', 'wheelbase', 'carlength', 'carwidth', 'curbweight', 'enginetype',\n       'cylindernumber', 'enginesize',  'boreratio', 'horsepower', 'price', 'brand_category', 'mileage']]","1caa2ff4":"auto.head()","c90d1865":"plt.figure(figsize=(15, 15))\nsns.pairplot(auto)\nplt.show()","87d6072d":"plt.figure(figsize=(10, 20))\nplt.subplot(4,2,1)\nsns.boxplot(x = 'fueltype', y = 'price', data = auto)\nplt.subplot(4,2,2)\nsns.boxplot(x = 'aspiration', y = 'price', data = auto)\nplt.subplot(4,2,3)\nsns.boxplot(x = 'carbody', y = 'price', data = auto)\nplt.subplot(4,2,4)\nsns.boxplot(x = 'drivewheel', y = 'price', data = auto)\nplt.subplot(4,2,5)\nsns.boxplot(x = 'enginetype', y = 'price', data = auto)\nplt.subplot(4,2,6)\nsns.boxplot(x = 'brand_category', y = 'price', data = auto)\nplt.subplot(4,2,7)\nsns.boxplot(x = 'cylindernumber', y = 'price', data = auto)\nplt.tight_layout()\nplt.show()\n","0f23277f":"# Categorical Variables are converted into Neumerical Variables with the help of Dummy Variable ","adcd6ad9":"cyl_no = pd.get_dummies(auto['cylindernumber'], drop_first = True)","7ef23b6b":"auto = pd.concat([auto, cyl_no], axis = 1)","e33edaf2":"brand_cat = pd.get_dummies(auto['brand_category'], drop_first = True)","f6d334e7":"auto = pd.concat([auto, brand_cat], axis = 1)","d6df62dd":"eng_typ = pd.get_dummies(auto['enginetype'], drop_first = True)","d4e2a40f":"auto = pd.concat([auto, eng_typ], axis = 1)","fc32e630":"drwh = pd.get_dummies(auto['drivewheel'], drop_first = True)","386a60f2":"auto = pd.concat([auto, drwh], axis = 1)","8af7db85":"carb = pd.get_dummies(auto['carbody'], drop_first = True)","d91723e1":"auto = pd.concat([auto, carb], axis = 1)","181d7f09":"asp = pd.get_dummies(auto['aspiration'], drop_first = True)","b0c9e2c1":"auto = pd.concat([auto, asp], axis = 1)","ab1abc12":"fuelt = pd.get_dummies(auto['fueltype'], drop_first = True)","b84f1b13":"auto = pd.concat([auto, fuelt], axis = 1)","944c4be2":"auto.drop(['fueltype', 'aspiration', 'carbody', 'drivewheel', 'enginetype', 'cylindernumber','brand_category'], axis = 1, inplace = True)","b91e035f":"from sklearn.model_selection import train_test_split\n\n# We specify this so that the train and test data set always have the same rows, respectively\nnp.random.seed(0)\ndf_train, df_test = train_test_split(auto, train_size = 0.7, test_size = 0.3, random_state = 100)","8885d560":"# We will use min-max scaling","0f529904":"from sklearn.preprocessing import MinMaxScaler","d068e4d3":"scaler = MinMaxScaler()","99a30014":"# Apply scaler() to all the columns except the 'dummy' variables\nnum_vars = ['wheelbase', 'carlength', 'carwidth', 'curbweight', 'enginesize','boreratio', 'horsepower', 'price','mileage']\n\ndf_train[num_vars] = scaler.fit_transform(df_train[num_vars])","4ed18a96":"df_train.head()","be9cbecd":"# Let's check the correlation coefficients to see which variables are highly correlated\n\nplt.figure(figsize = (16, 10))\nsns.heatmap(df_train.corr(), annot = True, cmap=\"YlGnBu\")\nplt.show()","262be07e":"y_train = df_train.pop('price')\nX_train = df_train","1e4f4876":"from sklearn.preprocessing import PolynomialFeatures\nfrom sklearn.preprocessing import scale\nfrom sklearn.feature_selection import RFE\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.model_selection import KFold\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.pipeline import make_pipeline\n\nimport warnings # supress warnings\nwarnings.filterwarnings('ignore')","535406ce":"# number of features\nlen(X_train.columns)","890feb00":"# creating a KFold object with 5 splits \nfolds = KFold(n_splits = 5, shuffle = True, random_state = 100)\n\n# specify range of hyperparameters\nhyper_params = [{'n_features_to_select': list(range(2, 30))}]\n\n# specify model\nlm = LinearRegression()\nlm.fit(X_train, y_train)\nrfe = RFE(lm)             \n\n# set up GridSearchCV()\nmodel_cv = GridSearchCV(estimator = rfe, \n                        param_grid = hyper_params, \n                        scoring= 'r2', \n                        cv = folds, \n                        verbose = 1,\n                        return_train_score=True)      \n\n# fit the model\nmodel_cv.fit(X_train, y_train)                  ","5b6b6993":"# cv results\ncv_results = pd.DataFrame(model_cv.cv_results_)\ncv_results","4ce50cd0":"# plotting cv results\nplt.figure(figsize=(16,6))\n\nplt.plot(cv_results[\"param_n_features_to_select\"], cv_results[\"mean_test_score\"])\nplt.plot(cv_results[\"param_n_features_to_select\"], cv_results[\"mean_train_score\"])\nplt.xlabel('number of features')\nplt.ylabel('r-squared')\nplt.title(\"Optimal Number of Features\")\nplt.legend(['test score', 'train score'], loc='upper left')","342c84dc":"# According to the above plot optimum number of features are 5.","1bae2c21":"# Running RFE with the output number of the variable equal to 10\nlm = LinearRegression()\nlm.fit(X_train, y_train)\n\nrfe = RFE(lm, 5)             # running RFE\nrfe = rfe.fit(X_train, y_train)","88238e81":"list(zip(X_train.columns,rfe.support_,rfe.ranking_))","2c2ff302":"col = X_train.columns[rfe.support_]\ncol","17ab5cd8":"# Creating X_test dataframe with RFE selected variables\nX_train_rfe = X_train[col]","dd0d3818":"# Adding a constant variable \nimport statsmodels.api as sm  \nX_train_rfe = sm.add_constant(X_train_rfe)","6b9a4f21":"lm = sm.OLS(y_train,X_train_rfe).fit()   # Running the linear model","9b549446":"#Let's see the summary of our linear model\nprint(lm.summary())","e014c725":"# Calculate the VIFs for the new model\nfrom statsmodels.stats.outliers_influence import variance_inflation_factor\n\nvif = pd.DataFrame()\nX = X_train_rfe\nvif['Features'] = X.columns\nvif['VIF'] = [variance_inflation_factor(X.values, i) for i in range(X.shape[1])]\nvif['VIF'] = round(vif['VIF'], 2)\nvif = vif.sort_values(by = \"VIF\", ascending = False)\nvif","9169eec5":"y_train_price = lm.predict(X_train_rfe)","8c460ef4":"# Plot the histogram of the error terms\nfig = plt.figure()\nsns.distplot((y_train - y_train_price), bins = 20)\nfig.suptitle('Error Terms', fontsize = 20)                  # Plot heading \nplt.xlabel('Errors', fontsize = 18)                         # X-label","df1ae164":"# Error terms are centered around 0, and are normally distributed. Hence Residual Analysis suggests model is fine.","b32e0ecd":"num_vars = ['wheelbase', 'carlength', 'carwidth', 'curbweight', 'enginesize','boreratio', 'horsepower', 'price','mileage']\n\ndf_test[num_vars] = scaler.transform(df_test[num_vars])","45734e71":"y_test = df_test.pop('price')\nX_test = df_test","8c31f0c2":"# Now let's use our model to make predictions.\n\n# Creating X_test_new dataframe by dropping variables from X_test\nX_test_new = X_test[['curbweight', 'carwidth', 'horsepower', 'Luxury','dohcv']]\n\n# Adding a constant variable \nX_test_new = sm.add_constant(X_test_new)","6b01a920":"# Making predictions\ny_pred = lm.predict(X_test_new)","79982b63":"from sklearn.metrics import r2_score \nr2_score(y_test, y_pred)","af2b4646":"# Plotting y_test and y_pred to understand the spread.\nfig = plt.figure()\nplt.scatter(y_test,y_pred)\nfig.suptitle('y_test vs y_pred', fontsize=20)              # Plot heading \nplt.xlabel('y_test', fontsize=18)                          # X-label\nplt.ylabel('y_pred', fontsize=16)                          # Y-label","64522a07":"## Splitting the Data into Training and Testing sets","372038d1":"### Car Name","d57fa50e":"#### We can see that the equation of our best fitted line is:\n\n__price = 0.2454 carwidth + 0.3718 horsepower + 0.2794 luxury + 0.2452 curbweight- 0.2362 dohcv -0.1097__     ","8fd63298":"## Visualising the Data","076e9d24":"## Summary Univariate and Bivriate Analysis:\n__From the above Univariate and bivariate analysis we can filter out variables which does not affect price much.__ <br>\n__The most important driver variable for prediction of price are:-__\n1. Brand Category\n2. Fuel Type\n3. Aspiration\n4. Car Body\n5. Drive Wheel\n6. Wheelbase\n7. Car Length\n8. Car Width\n9. Curb weight\n10. Engine Type\n11. Cylinder Number\n12. Engine Size\n13. Bore Ratio\n14. Horsepower\n15. Mileage\n","052397d3":"## Reading and Understanding Data","ec536e49":"# Prediction of car prices\n\n### Problem Statement\nA Chinese automobile company __Geely Auto__ aspires to enter the US market by setting up their manufacturing unit there and producing cars locally to give competition to their US and European counterparts. \n\nThey have contracted an automobile consulting company to understand the factors on which the pricing of cars depends. Specifically, they want to understand the factors affecting the pricing of cars in the American market, since those may be very different from the Chinese market. \n\n__The company wants to know:__ <br>\nWhich variables are significant in predicting the price of a car.<br>\nHow well those variables describe the price of a car.<br>\n\nBased on various market surveys, the consulting firm has gathered a large dataset of different types of cars across the Americal market. <br>\n\n \n\n### Business Goal \n\nYou are required to model the price of cars with the available independent variables. It will be used by the management to understand how exactly the prices vary with the independent variables. They can accordingly manipulate the design of the cars, the business strategy etc. to meet certain price levels. \nFurther, the model will be a good way for management to understand the pricing dynamics of a new market. \n","7c54024e":"### Dummy Variables","b09af2e1":"### Visualising Categorical Variables\n\nLet's make a boxplot for categorical variables.","bc934b9e":"### Drivewheel","9f37574b":"## Making Predictions\nApplying the scaling on the test sets","bebdba3e":"## Bivariate Analysis","581ff3d3":"### Brand Category - Mileage","e6603bfc":"## Data Preparation","37997b65":"## __Exploratory Data Analysis ( EDA )__","725e13bb":"### Horsepower - Fuel Type","735eb3d8":"### Door Numbers","6acbef5e":"## Car Dimensions","feffd303":"### Car Body","13e27b04":"### Engine Size, Bore Ratio, Stroke, Horsepower & Compression Ratio","ff652fb5":"## Univariate Analysis","98916490":"## Residual Analysis of the train data\nSo, now to check if the error terms are also normally distributed (which is infact, one of the major assumptions of linear regression), let us plot the histogram of the error terms and see what it looks like.","db0c6e71":"### Engine Type, Cylinder, Fuel System","c590a62d":"## Model Evaluation","b4116cbe":"### Dividing into X and Y sets for the model building","409098ae":"### Price : Target Variable","1b8edc4f":"### Rescaling the Features","71764e94":"# Linear Regression Model","921c5489":"## Engine Specifications","2a992938":"### Mileage - Fuel Type","66bb9fa7":"### Cross Validation using K-Folds","f482b855":"### Fuel Type","4c56ccdc":"### Data Inspection","3bbbf376":"### Car ID","d78a5d5c":"### RFE\nRecursive feature elimination","5c0b328f":"### Visualising Numeric Variables\n\nLet's make a pairplot of all the numeric variables","6156d80a":"### Aspiration","231cc5fe":"### Data Cleaning","097d76eb":"### Brand Category - Horsepower","b58584ac":"## City Mileage & Highway Mileage","7a419020":"### Building model using statsmodel, for the detailed statistics","9b21bb16":"### Symboling","b5dc0596":"### Wheel base"}}