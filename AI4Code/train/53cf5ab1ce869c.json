{"cell_type":{"ed6ecb93":"code","60bbeadf":"code","722dd0e2":"code","d8b99a92":"code","8ffc9801":"code","ed5d02c8":"code","85770396":"code","7d434c3c":"code","a29fe669":"code","18cbc5ca":"code","f031467c":"code","819cde5b":"code","1575ac7b":"code","b1c05827":"code","c21eda31":"markdown","dcb8907e":"markdown","f6b13862":"markdown","acdbef26":"markdown","44b42cf1":"markdown","0dc18313":"markdown","8edd8e0b":"markdown","8ffba390":"markdown","c0039a2b":"markdown","36834caa":"markdown","65b16f34":"markdown","4e977f3d":"markdown","0d779de9":"markdown","b822d8e5":"markdown","3292f101":"markdown","a353bd7b":"markdown","7657979d":"markdown","4f306bf3":"markdown","5b23b8ce":"markdown","afd25f71":"markdown","eb2372da":"markdown"},"source":{"ed6ecb93":"import keras\n\nfrom keras.models import Sequential\nfrom keras.layers import Dense\nfrom keras.utils import to_categorical","60bbeadf":"import matplotlib.pyplot as plt","722dd0e2":"# import the data\nfrom keras.datasets import mnist\n\n# read the data\n(X_train, y_train), (X_test, y_test) = mnist.load_data()","d8b99a92":"X_train.shape","8ffc9801":"plt.imshow(X_train[0])","ed5d02c8":"# flatten images into one-dimensional vector\n\nnum_pixels = X_train.shape[1] * X_train.shape[2] # find size of one-dimensional vector\n\nX_train = X_train.reshape(X_train.shape[0], num_pixels).astype('float32') # flatten training images\nX_test = X_test.reshape(X_test.shape[0], num_pixels).astype('float32') # flatten test images","85770396":"# normalize inputs from 0-255 to 0-1\nX_train = X_train \/ 255\nX_test = X_test \/ 255","7d434c3c":"# one hot encode outputs\ny_train = to_categorical(y_train)\ny_test = to_categorical(y_test)\n\nnum_classes = y_test.shape[1]\nprint(num_classes)","a29fe669":"# define classification model\ndef classification_model():\n    # create model\n    model = Sequential()\n    model.add(Dense(num_pixels, activation='relu', input_shape=(num_pixels,)))\n    model.add(Dense(100, activation='relu'))\n    model.add(Dense(num_classes, activation='softmax'))\n    \n    \n    # compile model\n    model.compile(optimizer='adam', loss='categorical_crossentropy', metrics=['accuracy'])\n    return model","18cbc5ca":"# build the model\nmodel = classification_model()\n\n# fit the model\nmodel.fit(X_train, y_train, validation_data=(X_test, y_test), epochs=10, verbose=2)\n\n# evaluate the model\nscores = model.evaluate(X_test, y_test, verbose=0)","f031467c":"print('Accuracy: {}% \\n Error: {}'.format(scores[1], 1 - scores[1]))        ","819cde5b":"model.save('classification_model.h5')","1575ac7b":"from keras.models import load_model","b1c05827":"pretrained_model = load_model('classification_model.h5')","c21eda31":"## Train and Test the Network","dcb8907e":"Finally, before we start building our model, remember that for classification we need to divide our target variable into categories. We use the to_categorical function from the Keras Utilities package.","f6b13862":"The Keras library conveniently includes the MNIST dataset as part of its API. You can check other datasets within the Keras library [here](https:\/\/keras.io\/datasets\/). \n\nSo, let's load the MNIST dataset from the Keras library. The dataset is readily divided into a training set and a test set.","acdbef26":"<a id='item322'><\/a>","44b42cf1":"## Introduction","0dc18313":"Since we are dealing we images, let's also import the Matplotlib scripting layer in order to view the images.","8edd8e0b":"When you are ready to use your model again, you use the load_model function from <strong>keras.models<\/strong>.","8ffba390":"<a id='item332'><\/a>","c0039a2b":"Let's print the accuracy and the corresponding error.","36834caa":"With conventional neural networks, we cannot feed in the image as input as is. So we need to flatten the images into one-dimensional vectors, each of size 1 x (28 x 28) = 1 x 784.","65b16f34":"Sometimes, you cannot afford to retrain your model everytime you want to use it, especially if you are limited on computational resources and training your model can take a long time. Therefore, with the Keras library, you can save your model after training. To do that, we use the save method.","4e977f3d":"Let's visualize the first image in the training set using Matplotlib's scripting layer.","0d779de9":"The first number in the output tuple is the number of images, and the other two numbers are the size of the images in datset. So, each image is 28 pixels by 28 pixels.","b822d8e5":"Let's start by importing Keras and some of its modules.","3292f101":"In this notebook, we will use the Keras library to build models for classificaiton problems. We will use the popular MNIST dataset, a dataset of images, for a change. \n\nThe <strong>MNIST database<\/strong>, short for Modified National Institute of Standards and Technology database, is a large database of handwritten digits that is commonly used for training various image processing systems. The database is also widely used for training and testing in the field of machine learning.\n    \nThe MNIST database contains 60,000 training images and 10,000 testing images of digits written by high school students and employees of the United States Census Bureau.\n\nAlso, this way, will compare how conventional neural networks compare to convolutional neural networks, that we will build in the next module.","a353bd7b":"Let's confirm the number of images in each set. According to the dataset's documentation, we should have 60000 images in X_train and 10000 images in the X_test.","7657979d":"Just running 10 epochs could actually take over 2 minutes. But enjoy the results as they are getting generated.","4f306bf3":"Since pixel values can range from 0 to 255, let's normalize the vectors to be between 0 and 1.","5b23b8ce":"Since our model contains multidimensional arrays of data, then models are usually saved as .h5 files.","afd25f71":"## Build a Neural Network","eb2372da":"## Import Keras and Packages"}}