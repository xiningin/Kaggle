{"cell_type":{"35c49c74":"code","014b8bce":"code","77b9c86d":"code","ec3edf76":"code","451fae58":"code","f59d2ed9":"code","a8c38d1a":"code","c046fbce":"code","0a40e39a":"code","d25208cd":"code","6afa34a9":"code","0699f2d9":"code","0460c4cc":"code","d69b6577":"code","5856afbb":"code","df74001c":"markdown","10513505":"markdown","58bfc306":"markdown","6ce3c585":"markdown","5abe7ae0":"markdown","9a4e227f":"markdown","d2f86153":"markdown","44049884":"markdown","627f81d3":"markdown"},"source":{"35c49c74":"import numpy as np\nfrom glob import glob\nimport matplotlib.pyplot as plt\nfrom tensorflow.keras.layers import Input, Dense, Flatten, Conv2D, MaxPooling2D, Dropout, Activation\nfrom tensorflow.keras.models import Model, Sequential\nfrom tensorflow.keras.applications.vgg16 import VGG16\nfrom tensorflow.keras.preprocessing import image\nfrom tensorflow.keras.preprocessing.image import ImageDataGenerator, load_img","014b8bce":"image_shape=[224, 224]\ndata='..\/input\/cell-images-for-detecting-malaria\/cell_images\/cell_images\/'","77b9c86d":"classes=glob('..\/input\/cell-images-for-detecting-malaria\/cell_images\/cell_images\/*')\nclasses","ec3edf76":"import cv2\nparasitized=\"..\/input\/cell-images-for-detecting-malaria\/cell_images\/Parasitized\/C100P61ThinF_IMG_20150918_144348_cell_141.png\"\nuninfected=\"..\/input\/cell-images-for-detecting-malaria\/cell_images\/Uninfected\/C100P61ThinF_IMG_20150918_145042_cell_5.png\"\n\nplt.figure(1, figsize = (15 , 10))\nplt.subplot(1 , 2 , 1)\nplt.imshow(cv2.imread(uninfected))\nplt.title('Uninfected Cell')\nplt.xticks([]) , plt.yticks([])\n\nplt.subplot(1 , 2 , 2)\nplt.imshow(cv2.imread(parasitized))\nplt.title('Infected Cell')\nplt.xticks([]) , plt.yticks([])\n\nplt.show()","451fae58":"train_generator=ImageDataGenerator(rescale=1\/255.0, shear_range=0.1, zoom_range=0.1, horizontal_flip=True)\ntest_generator=ImageDataGenerator(rescale=1\/255.0, validation_split=0.2)\n\ntrain_data=train_generator.flow_from_directory(directory=data, target_size=(224, 224), class_mode='categorical', color_mode='rgb', batch_size=64, subset='training')\n\ntest_data=test_generator.flow_from_directory(directory=data, target_size=(224, 224), class_mode='categorical', color_mode='rgb', batch_size=64, subset='validation')","f59d2ed9":"vgg=VGG16(input_shape=image_shape+[3], weights='imagenet', include_top=False)\nvgg.summary()","a8c38d1a":"for l in vgg.layers:\n    l.trainable=False","c046fbce":"X=Flatten()(vgg.output)\nD=Dense(256, activation='relu')(X)\noutput=Dense(len(classes), activation='softmax')(D)\n\nmodel_vgg=Model(inputs=vgg.input, outputs=output)\nmodel_vgg.summary()","0a40e39a":"model_vgg.compile(\n  loss='categorical_crossentropy',\n  optimizer='adam',\n  metrics=['accuracy']\n)","d25208cd":"fit=model_vgg.fit(train_data, validation_data=test_data, epochs=8, steps_per_epoch=len(train_data), validation_steps=len(test_data))","6afa34a9":"plt.plot(fit.history['loss'], label='train loss')\nplt.plot(fit.history['val_loss'], label='val loss')\nplt.legend()\nplt.show()","0699f2d9":"plt.plot(fit.history['accuracy'], label='train acc')\nplt.plot(fit.history['val_accuracy'], label='val acc')\nplt.legend()\nplt.show()","0460c4cc":"y_pred=model_vgg.predict(test_data)\ny_pred","d69b6577":"y_pred=np.argmax(y_pred, axis=1)\nprint(y_pred)","5856afbb":"model_vgg.save('my_vgg16_model.h5')","df74001c":"#### **Freezing the Layers**","10513505":"### ***Processing***","58bfc306":"#### **Analyzing the Losses and Accuracy**","6ce3c585":"#### **Save the Model**","5abe7ae0":"### ***Loading the Libraries***","9a4e227f":"### ***Making the Prediction***","d2f86153":"#### **Customizing the Top Layers**","44049884":"### ***Loading VGG16 Model without the Top Layers***","627f81d3":"### ***Analysis***"}}