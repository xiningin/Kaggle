{"cell_type":{"26d8e3d4":"code","91299f34":"code","928c8496":"code","c94589c2":"code","673bdf77":"code","f01bf3f4":"code","7a5b3fae":"code","8a22524d":"code","997b4c4c":"code","7baa3dd7":"code","2a877320":"code","d1f29cee":"code","8489f484":"code","3e69844f":"code","292b69a0":"code","900cebd3":"code","7c1ce12f":"code","466a9702":"code","2aea0181":"code","b8df248e":"code","b3f58de4":"code","6a7f9d9f":"code","8835c8fa":"code","c2992ddc":"code","64c76bf4":"markdown"},"source":{"26d8e3d4":"import math\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nplt.style.use('fivethirtyeight')\nfrom sklearn.preprocessing import MinMaxScaler\nfrom keras.models import Sequential\nfrom tensorflow.keras.layers import Dense, LSTM","91299f34":"data = pd.read_csv('..\/input\/us-dollar-inr-rupee-dataset20032021\/USDINRX.csv')\ndata.head()","928c8496":"data.info()","c94589c2":"data.isnull().sum()","673bdf77":"data = data.dropna()","f01bf3f4":"data.isnull().sum()","7a5b3fae":"data = data.astype({'Date': 'datetime64[ns]'})","8a22524d":"date = data['Date']\nplt.figure(figsize=(16,8))\nplt.title('Close Price History')\nplt.plot(data['Date'],data['Close'])\nplt.xlabel('Date')\nplt.ylabel('Close Price INR (\u20b9)')\nplt.show()","997b4c4c":"df = data.filter(['Close'])\ndataset = df.values\ntrain_data_len = math.ceil(len(dataset)*.8)\ntrain_data_len","7baa3dd7":"scaler = MinMaxScaler(feature_range=(0,1))\nscaler_data = scaler.fit_transform(dataset)\nscaler_data","2a877320":"train_data = scaler_data[0:train_data_len , :]","d1f29cee":"x_train = []\ny_train = []\n\nfor i in range(60 , len(train_data)):\n    x_train.append(train_data[i-60:i, 0])\n    y_train.append(train_data[i, 0])","8489f484":"x_train, y_train = np.array(x_train), np.array(y_train)","3e69844f":"x_train = np.reshape(x_train, (x_train.shape[0], x_train.shape[1], 1))","292b69a0":"model = Sequential()\nmodel.add(LSTM(50, return_sequences=True, input_shape=(x_train.shape[1],1)))\nmodel.add(LSTM(50))\nmodel.add(Dense(1))","900cebd3":"model.compile(loss='mean_squared_error', optimizer='adam')","7c1ce12f":"history=model.fit(x_train, y_train, epochs=1, batch_size=1)","466a9702":"test_data = scaler_data[train_data_len - 60:, :]","2aea0181":"x_test = []\ny_test = dataset[train_data_len:, :]\nfor i in range(60, len(test_data)):\n    x_test.append(test_data[i-60:i, 0])","b8df248e":"x_test = np.array(x_test)","b3f58de4":"x_test = np.reshape(x_test, (x_test.shape[0], x_test.shape[1], 1))","6a7f9d9f":"pred = model.predict(x_test)\npred = scaler.inverse_transform(pred)","8835c8fa":"train = data[:train_data_len]\nvalid = data[train_data_len:]\nvalid['Predictions'] = pred\nplt.figure(figsize=(16,8))\nplt.xlabel('Date')\nplt.ylabel('Close Price INR (\u20b9)')\nplt.plot(train['Date'],train['Close'])\nplt.plot(valid['Date'],valid[['Close','Predictions']])\nplt.legend(['Train','Valid','Predictions'], loc='lower right')\nplt.show()","c2992ddc":"plt.figure(figsize=(16,8))\nplt.plot(valid['Date'],valid[['Close','Predictions']])\nplt.legend(['Valid','Predictions'], loc='lower right')\nplt.xlabel('Date')\nplt.ylabel('Close Price INR (\u20b9)')\nplt.show()","64c76bf4":"# Please, upvote if you found it useful!"}}