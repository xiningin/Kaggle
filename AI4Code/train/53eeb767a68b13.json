{"cell_type":{"49a1ec8c":"code","864aab10":"code","46ecb6e4":"code","166f68ce":"code","3d49e2e7":"code","b24bb120":"code","102839ff":"code","819b7404":"code","d876053e":"code","e720fe62":"code","0cf055f2":"code","5c71d4d7":"code","4db2dbfc":"code","43863874":"markdown","46c77217":"markdown","b543b4fa":"markdown","ab34061b":"markdown","064e662f":"markdown","96072afa":"markdown","7fbc328c":"markdown","b28520f0":"markdown","38a3b5aa":"markdown","5f20efe6":"markdown"},"source":{"49a1ec8c":"\nimport numpy as np \nimport pandas as pd \nimport matplotlib.pyplot as plt\n%matplotlib inline\n","864aab10":"df=pd.read_csv('..\/input\/petrol-consumption\/petrol_consumption.csv')","46ecb6e4":"df.info()","166f68ce":"df.shape","3d49e2e7":"df.head()","b24bb120":"df.describe()","102839ff":"X=df[['Petrol_tax','Average_income','Paved_Highways','Population_Driver_licence(%)']]\ny=df['Petrol_Consumption']","819b7404":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=0)","d876053e":"from sklearn.linear_model import LinearRegression\nreg=LinearRegression()\nreg.fit(X_train,y_train)","e720fe62":"coeff_df = pd.DataFrame(reg.coef_, X.columns, columns=['Coefficient'])\ncoeff_df","0cf055f2":"y_pred=reg.predict(X_test)","5c71d4d7":"df=pd.DataFrame({'Actual':y_test, 'Predicted':y_pred})\ndf","4db2dbfc":"from sklearn import metrics\nprint('Mean Absolute Error:', metrics.mean_absolute_error(y_test, y_pred))\nprint('Mean Squared Error:', metrics.mean_squared_error(y_test, y_pred))\nprint('Root Mean Squared Error:', np.sqrt(metrics.mean_squared_error(y_test, y_pred)))","43863874":"comparing the actual output values for X_test with the predicted values:","46c77217":"Evaluating the Algorithm\n","b543b4fa":"Results from this notebook:\nThere may be other factors that leading to this inaccuracy, a few of which are listed here:\n\nNeed of more data: Having the data of one year onle is not a good idea and having some years' data can lead to more accuracy.\n\nBad assumptions: the assumption is that this data has a linear relationship, but that might not be the case. Visualizing the data may help us determine that.\n\nPoor features: The features  used here may not have a high enough correlation with the values we were trying to predict.","ab34061b":"In case of multivariable linear regression, the regression model has to find the most optimal coefficients for all the attributes.","064e662f":"Preparing the Data\nUnlike the simple LR, this time  we are going to use column names for creating an attribute set and label. ","96072afa":"This means that for a unit increase in \"petrol_tax\", there is a decrease of 24.19 million gallons in gas consumption. Also, a unit increase in proportion of population with a drivers license results in an increase of 1.324 billion gallons of gas consumption. We can notice that \"Average_income\" and \"Paved_Highways\" have a very little effect on the gas consumption.","7fbc328c":"Making Predictions\n","b28520f0":"Dividing our data into training and test sets:","38a3b5aa":"the value of root mean squared error is 60.07, which is slightly greater than 10% of the mean value of the gas consumption in all states meaning that our algorithm was not very accurate but can still make reasonably good predictions.","5f20efe6":"Training the Algorithm\n"}}