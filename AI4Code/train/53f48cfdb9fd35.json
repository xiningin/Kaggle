{"cell_type":{"2f952e95":"code","70f59fcc":"code","6ca63ed5":"code","2e80e81d":"code","232da7df":"code","957e09c9":"code","b78fe09b":"code","7aa40b30":"code","66df8928":"code","34182ff3":"code","7a688c0a":"code","53ed4b1b":"code","bfe4ca64":"code","3e897bf9":"code","799936e9":"code","b9ef9046":"code","96460f80":"code","24fbdac3":"code","916fb333":"code","88ac4efb":"code","76485a07":"code","dadcd9d6":"code","819f664e":"code","61efeb22":"code","4d5765b4":"code","fdb81402":"code","ab0fe96e":"code","79a7d974":"code","a5a86673":"code","313d45d8":"code","45fcdffc":"code","78d8a1d4":"code","e56dde20":"code","aea33208":"code","88e1957c":"markdown","bbab272d":"markdown","acce6a0f":"markdown","0b94c31a":"markdown","4ba6e228":"markdown","7e4d55e4":"markdown","f8b07de7":"markdown","d3c8f3a9":"markdown","284945bc":"markdown","9dbe43ca":"markdown","89c456a9":"markdown","fb704cfc":"markdown","cf025df1":"markdown","cc191856":"markdown","a789fe0a":"markdown","3c13bc11":"markdown","dec2068a":"markdown","f50e853e":"markdown","4f8f4ebe":"markdown","3c11ebc4":"markdown","3013e38d":"markdown","1fa51b18":"markdown","5a2edd97":"markdown","48fcfa12":"markdown","34e41206":"markdown","bfcc1504":"markdown","be84ed01":"markdown","542c244b":"markdown","b2827d9a":"markdown","875c6afa":"markdown","fd62605f":"markdown","d67103f0":"markdown","0dad6982":"markdown","05d34737":"markdown","f8555664":"markdown","3b6971d0":"markdown","3e04cbb6":"markdown"},"source":{"2f952e95":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","70f59fcc":"import numpy as np \nimport pandas as pd\nimport pandas_profiling\nimport re\nimport warnings\nwarnings.filterwarnings('ignore')\n\n#For data visualization\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline\n\nfrom sklearn.model_selection import train_test_split, cross_val_score, GridSearchCV\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.neighbors import KNeighborsClassifier","6ca63ed5":"train = pd.read_csv('..\/input\/titanic\/train.csv')\ntest = pd.read_csv('..\/input\/titanic\/test.csv')","2e80e81d":"train","232da7df":"test.head(5)\n","957e09c9":"train.info()\ntrain.shape","b78fe09b":"train.isnull().sum()","7aa40b30":"test.isnull().sum()","66df8928":"pandas_profiling.ProfileReport(train)","34182ff3":"sns.countplot('Sex',data=train)\n","7a688c0a":"sns.barplot(x='Sex',y='Survived',data=train)\n","53ed4b1b":"sns.barplot(x='Pclass',y='Survived',data=train)","bfe4ca64":"\nsns.barplot(x='Embarked',y='Survived',data=train)\n","3e897bf9":"\nsns.barplot(x='Parch',y='Survived',data=train)\n","799936e9":"\nsns.barplot(x='SibSp',y='Survived',data=train)\n","b9ef9046":"\nsns.histplot(x='Age',y='Survived',data=train)\n","96460f80":"# lets confirm our above analysis.\nsns.lmplot(x='Age',y='Survived',data=train)\n","24fbdac3":"\nsns.lmplot(x='Age',y='Survived',hue='Sex',data=train,palette='Set1')\n","916fb333":"\nz_fare=[]\no_fare=[]\nfor i,z in zip(train['Fare'],train['Survived']):\n    if z==0:\n        z_fare.append(i)\n    if z==1:\n        o_fare.append(i)\nprint(\"Number of passengers died:\",len(z_fare),\"|| Total Fare they gave:\",sum(z_fare))\nprint(\"Number of passengers lived:\",len(o_fare),\"|| Total Fare they gave:\",sum(o_fare))\n\n","88ac4efb":"\nsns.histplot(x='Fare',y='Survived',data=train)\n","76485a07":"\nm_fare=[]\nf_fare=[]\nfor i,z in zip(train['Fare'],train['Sex']):\n    if z=='male':\n        m_fare.append(i)\n    if z=='female':\n        f_fare.append(i)\nprint(\"Number of male:\",len(m_fare),\"|| Total Fare they gave:\",sum(m_fare))\nprint(\"Number of female:\",len(f_fare),\"|| Total Fare they gave:\",sum(f_fare))\n\n","dadcd9d6":"\nsns.histplot(x='Fare',y='Survived',hue='Sex',data=train)\n","819f664e":"sns.boxplot(x='Sex',y='Age',data=train)\n# check for outliers","61efeb22":"remove_list=['Cabin','Ticket','PassengerId']\n\ntrain = train.drop(remove_list,axis=1)\ntest_passenger_df = pd.DataFrame(test.PassengerId)\ntest = test.drop(remove_list,axis=1)","4d5765b4":"train.Embarked.fillna('S',inplace=True)\ntrain.Age.fillna(28, inplace=True)\ntest.Age.fillna(28, inplace=True)\ntest.Fare.fillna(test.Fare.median(), inplace=True)\nCombined_data = [train, test]\nfor dataset in Combined_data:\n    dataset[\"Family\"] = dataset['SibSp'] + dataset['Parch']\n    dataset[\"IsAlone\"] = np.where(dataset[\"Family\"] > 0, 0,1)\n    dataset.drop('Family',axis=1,inplace=True)\ntrain.head() ","fdb81402":"for dataset in Combined_data:\n    dataset.drop(['SibSp','Parch','Name'],axis=1,inplace=True)\n    \nfor dataset in Combined_data:\n    dataset[\"IsMinor\"] = np.where(dataset[\"Age\"] < 15, 1, 0)\n    \ntrain['Old_Female'] = (train['Age']>50)&(train['Sex']=='female')\ntrain['Old_Female'] = train['Old_Female'].astype(int)\n\ntest['Old_Female'] = (test['Age']>50)&(test['Sex']=='female')\ntest['Old_Female'] = test['Old_Female'].astype(int)\n","ab0fe96e":"#Converting categorical variables into numerical ones\ntrain2 = pd.get_dummies(train,columns=['Pclass','Sex','Embarked'],drop_first=True)\ntest2 = pd.get_dummies(test,columns=['Pclass','Sex','Embarked'],drop_first=True)\ntrain2.head()","79a7d974":"#creating Age bands\ntrain2['AgeBands'] = pd.qcut(train2.Age,4,labels=False) \ntest2['AgeBands'] = pd.qcut(test2.Age,4,labels=False) \n\n#creating Fare bands\ntrain2['FareBand'] = pd.qcut(train2.Fare,7,labels=False)\ntest2['FareBand'] = pd.qcut(test2.Fare,7,labels=False)\n\n#Dropping the Age and Fare columns\ntrain2.drop(['Age','Fare'],axis=1,inplace=True)\ntest2.drop(['Age','Fare'],axis=1,inplace=True)\ntrain2.head(5)","a5a86673":"X = train2.drop(\"Survived\",axis=1) \ny = train2[\"Survived\"]\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3,random_state=42)","313d45d8":"random_forest = RandomForestClassifier()\nne = np.arange(1,20)\nparam_grid = {'n_estimators' : ne}\n\nrfo = GridSearchCV(random_forest, param_grid=param_grid, cv=5)\n\nrfo.fit(X, y)\nprint('Best score:',rfo.best_score_*100)","45fcdffc":"decisiontree = DecisionTreeClassifier()\ndep = np.arange(1,10)\nparam_grid = {'max_depth' : dep}\n\ndt = GridSearchCV(decisiontree, param_grid=param_grid, cv=5)\n\ndt.fit(X, y)\n\nprint(dt.best_score_*100)","78d8a1d4":"knn = KNeighborsClassifier( )\nk_range = list(range(1,10))\nweights_options = ['uniform','distance']\nk_grid = dict(n_neighbors=k_range, weights = weights_options)\ngrid = GridSearchCV(knn, k_grid, cv=10, scoring = 'precision')\ngrid.fit(X,y)\ngrid.best_score_*100","e56dde20":"label_pred = grid.predict(test2)\nlabel_pred","aea33208":"# submission = pd.DataFrame({\n#         \"PassengerId\": test_passenger_df[\"PassengerId\"],\n#         \"Survived\": label_pred\n#     })\n# submission.head()\n# submission.to_csv('titanic.csv', index=False)","88e1957c":"Age had big role to play when it came to survival. Clearly younger people were more likely to survive. Hence, it should be worth considering a feature IsMinor for the passengers under the age of 15.\nOlder female passengers also had a higher chance of survival. Let's create a feature name Old_female that would account for women older tha 50 years on board","bbab272d":"embarked column had some missing values, i will fill the embarked column with S (southampton) since most of the passengers embarked from there.\nsame goes for age and fare, we are creating two features family and isalone, merging the sibsp and parch will create family feature and since being alone in the ship was disadvantage i decided to make a new feature isalone out of family feature\n","acce6a0f":"looks like having 1 2 3 childrens or parents caused the survival rate to grow compared to those who had 4 or 6 childrens.\nlets see the effect of having sibling around on the survival rate of those passengers ","0b94c31a":"if you want your predictions in csv format.","4ba6e228":"here are the predictions ","7e4d55e4":"passengers embarking from C (Cherbourg) had more survival rate compared to other places","f8b07de7":"having 1 or 2 sibliings increased the survival rate for that passenger. but it goes down as the numbers increase and chances of survival becomes zero with 5 to 8 siblings.\nlets see if age had any effect on survival","d3c8f3a9":"test dataset does not have any survivor column because i am going to predict that with test dataset.\n","284945bc":"i will be dropping these coulmns because we no longer need them. ","9dbe43ca":"male persons are clearly more compared to female\nnow lets see which gender survived more ","89c456a9":"i am droping the survived column from our train dataset and splitting the dataset for training and testing.","fb704cfc":"this is the statistics report of every column, this report must be understood before moving on to the \nEDA phase","cf025df1":"seems like knn had the best accuracy out of these three models, so we will predict the survival with knn","cc191856":"i have large number of missing values in Age and cabin column, we will deal with them in our data \ncleaning phase, let's see if test dataset have missing values. ","a789fe0a":"yes, i do have missing values in age and cabin column in our test dataset ","3c13bc11":"let's see if we have any missing values ","dec2068a":"the regression line shows the trend line downward which means our above hypothesis was true, as the age increases the survival rates becomes lower\nGender had a huge advantage in survival lets see if that is true","f50e853e":"lets see the effect of having parents or childrens on survival of the passengers.","4f8f4ebe":"females as their age increases their survival rate grow but it is opposite for the male gender.","3c11ebc4":"lets see who paid more fare male or female and if that actually effected their survival.\ni already know that females survival rate was alot greater than male but we don't know if fare had any effect on their survival rate or not.","3013e38d":"Pclass, Sex and Embarked are the categorical features in our data. i can convert these categorucal variables into dummy variables using the get_dummies method in python","1fa51b18":"the number of males were 577 and their total fare was 14727 app. and woman were only 314 and yet their fare 13966 is very close to the fare of males which means females gave large fares and survived the disaster. how ironic","5a2edd97":"and our stats and hypothesis both confirmed to be right. as you can see the amount of women survived and the fare they gave.","48fcfa12":"Importing the required libraries","34e41206":"importing the required data","bfcc1504":"That's it for the EDA now i will be entering the data cleaning and feature engineering phase","be84ed01":"it seems that passengers with age 20 to 30 had a mix of death and survival rate but as the age increases the survival rate goes lower and lower.","542c244b":"It is clear that alot of females survived compared males ","b2827d9a":"That's it for titanic EDA & and predictions","875c6afa":"lets caculate few things to get some stats out of this to see if small or large Fare had any effect \non the survival of those passengers ","fd62605f":"lets confirm our hypothesis through a visual","d67103f0":"lets confirm our stats and hypothesis with visuals ","0dad6982":"yes i was right, as you can see the dark blue line there means people who paid fare closer to 0 died in large number compared to those who survived.","05d34737":"lets see if the class of each passenger effected the survival of passengers","f8555664":"it seems quit clear that people who died paid very less Fare compared to those who lived, so Fare had an important role in survival of the passengers, it is also noticed that number of passengers who died are greater than who lived and still their Fare was very low, this also confirms our hypothesis that passengers who paid large fare most likely survived the disaster.","3b6971d0":"Age and Fare columns have continuous data and there might be fluctuations that do not reflect patterns in the data, which might be noise. That's why i will put people that are within a certain range of age or fare in the same bin. This can be achieved using qcut method in pandas","3e04cbb6":"it seems passengers belonging to first class increased their survival rate.\nlets see if embarking from certain places had any effect on the survival rate"}}