{"cell_type":{"a662763e":"code","d27a6f06":"code","d58b029e":"code","84ac2bf3":"code","cc1ae73f":"code","d648bd14":"code","225ba398":"code","e316a0b3":"code","b6f67404":"code","9566df74":"code","eaa63306":"code","d0aa8eef":"code","d2a91e99":"code","5b6297b1":"code","da158407":"markdown","cf789c08":"markdown","f6d3c890":"markdown","c9f83b8a":"markdown"},"source":{"a662763e":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom matplotlib.lines import Line2D\n","d27a6f06":"df = pd.read_csv('\/kaggle\/input\/stroke-prediction-dataset\/healthcare-dataset-stroke-data.csv')\ndf.head()\n","d58b029e":"df.describe()","84ac2bf3":"df.stroke.value_counts()","cc1ae73f":"stroke = df.stroke == 1\nnon_stroke = df.stroke == 0\ndf[stroke].describe()","d648bd14":"fig,ax = plt.subplots(figsize=(10,8))\nsns.set_style('whitegrid')\nsns.color_palette('tab10')\n\nsns.histplot(df[non_stroke].avg_glucose_level,bins=10)\nsns.histplot(df[stroke].avg_glucose_level,color='yellow',alpha=.7)","225ba398":"#Check cat variables\nfor i in df[['gender','ever_married','work_type','Residence_type','smoking_status']]:\n    print(i+':\\n')\n    print(df[i].value_counts())\n    print()","e316a0b3":"from sklearn.preprocessing import OrdinalEncoder\n\nenc = OrdinalEncoder()\ndf[['gender','ever_married','work_type','Residence_type','smoking_status']] = enc.fit_transform(df[['gender','ever_married','work_type','Residence_type','smoking_status']])\ndf.smoking_status.value_counts()\nenc.categories_\n","b6f67404":"plt.figure(figsize=(10,8))\nsns.heatmap(df.corr())","9566df74":"fig, ax = plt.subplots(figsize=(10,8))\nplt.scatter(df[non_stroke].age,df[non_stroke].bmi,c=df[non_stroke].stroke,cmap='icefire')\nplt.scatter(df[stroke].age,df[stroke].bmi)\n\nplt.xlabel('Age')\nplt.ylabel('BMI')\nax.set_ylim((5,75))\nax.set_title('BMI to Age separating out people who had strokes vs those that haven\\'t')","eaa63306":"fig, ax = plt.subplots(figsize=(10,8))\nmarried = df.ever_married == 1\nnon_married = df.ever_married == 0\nyoung = []\nfor i,_ in df.iterrows():\n    if df.iloc[i].age < 45:\n        young.append(1)\n    else:\n        young.append(0)\ndf['young'] = young\nax= sns.violinplot(df[married].stroke,df[married].bmi,color='forestgreen')#,c=df[married].stroke,cmap='autumn')\nsns.violinplot(df[non_married].stroke,df[non_married].bmi,color='yellow',hue=df[non_married].young,split=True)\n\ncustom_lines = [Line2D([0], [0], color=(.99, .99, .0, .99), lw=4),\n                Line2D([0], [0], color=(.45, .54, .3, .99), lw=4),\n                Line2D([0], [0], color=(.99, .99, .88,.99), lw=4)]\n\nax.legend(custom_lines, ['Married', 'Not Married- Younger than 45','Not Married- Older than 45'])\n\nplt.xlabel('stroke')\nplt.ylabel('BMI')\nplt.ylim((5,75))\nplt.title('BMI and marriage distribution with respect to age and stroke status')\n","d0aa8eef":"print('average age of stroke patient is:', df[stroke].age.mean())\nprint('average bmi of stroke patient is:', df[stroke].bmi.mean())\nabove_stroke_age = df[stroke].age.quantile(.35)\nabove_df = df.age > above_stroke_age\nprint('average bmi of patients above 35th percentile of stroke patient age is:',df[above_df].bmi.mean())","d2a91e99":"bmi = {}\nstroke = {}\nfor i in [10,20,30,40,50,60,70,80,90]:\n    dfi = df.loc[df.age < i]\n    dfj = dfi.loc[dfi.age > i-10]\n    print(f'average bmi of ages {i-10} - {i} is {dfj.bmi.mean()}')\n    bmi[i] = dfj.bmi.mean()\n    stroke[i] = dfj.stroke.mean() * 100\nfig,ax = plt.subplots(figsize=(10,8))\nsns.lineplot(data = bmi)\nsns.lineplot(data=stroke)\n\ncustom_lines = [Line2D([0], [0], color=(.28, .37, .99, .91), lw=4),\n                Line2D([0], [0], color=(.99, .75, 0.0, .99), lw=4)]\n\nax.legend(custom_lines, ['BMI', 'Stroke Percentage'])\nplt.title('Average BMI per age group and Percentage of strokes in Age group')","5b6297b1":"from sklearn.linear_model import Lasso, LassoCV\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import mean_squared_error\n\nlasso = Lasso(max_iter=5000)\nlassoCV = LassoCV(max_iter=5000)\n\ndf = df.dropna()\n\nX = df[['gender', 'age', 'hypertension', 'heart_disease', 'ever_married',\n       'work_type', 'Residence_type', 'avg_glucose_level', 'bmi',\n       'smoking_status']].dropna()\ny = df[['stroke']].dropna()\n\nX_train, X_test, y_train, y_test = train_test_split(X,y,random_state=74,test_size = .22)\n\nlasso.fit(X_train,y_train)\nlassoCV.fit(X_train,y_train)\n\npred = lasso.predict(X_test)\npredCV = lassoCV.predict(X_test)\n\nscore = mean_squared_error(pred,y_test)\nscoreCV = mean_squared_error(predCV,y_test)\n\nprint('mean squared error of lasso model: {}'.format(score))\nprint('mean squared error of lasso model with cross validation: {}'.format(scoreCV))\n","da158407":"### As you can see the mean avg glucose level is 15 points higher than the median. Data skewed right\n","cf789c08":"Non married stroke patients that are not married seem to be less frequent that married stroke patients","f6d3c890":"##### Get categorical variables to numbers","c9f83b8a":"### Kinda funny age and married have the highest correlation\n"}}