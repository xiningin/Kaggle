{"cell_type":{"527b96bc":"code","50e9d3ec":"code","a6de17c3":"code","e120a533":"code","fa4c90fa":"code","cee76788":"code","6c4a7db9":"code","afff0acb":"code","df6314ef":"code","45ad7632":"code","bbdc55ed":"code","99463099":"code","05affba5":"code","2d4fac85":"code","68610475":"code","ff11d70f":"code","98e8875d":"code","04440e3b":"code","0b572ba6":"code","ec69452f":"code","08536e71":"code","006236d9":"code","a39ab671":"code","b68ed363":"code","2317f5d0":"code","5e466f6c":"code","b6b9b3df":"code","8a1a9093":"code","2c2b10a8":"code","f63ce7b2":"code","2abea23a":"code","501870be":"code","c58adf86":"code","d1907162":"code","cfbf4928":"code","4799adde":"code","d8f50fc0":"code","d3d12b52":"code","a3365258":"code","881df288":"code","4dcfae6c":"code","6eea367b":"code","17715d56":"code","71eaf54f":"code","01e3ba63":"code","bd91f4cb":"code","d2932baa":"code","0200ccb0":"code","1104edf7":"code","abc8b41d":"code","d2b92cc0":"code","f4feaaa5":"code","8beb404f":"code","16b9ffa2":"code","7494f55f":"code","d4da7b75":"code","4fe3367a":"code","74954712":"code","485bd82b":"code","e41b6ca0":"code","c611c22d":"code","b88556c4":"code","05484030":"code","cc0e8e9a":"code","7fee2f6a":"code","6418c2aa":"code","f61c19ba":"code","2a69db21":"code","9484cce9":"markdown","c077c0f6":"markdown","bdad5724":"markdown","2e619bd5":"markdown","ef1cd5ce":"markdown","6e7c15c2":"markdown","ba388db0":"markdown","23b3bb28":"markdown","55d62cfc":"markdown","da3033b0":"markdown","aecc1ebd":"markdown","37ada1ac":"markdown","e0e6be6f":"markdown","57180fc9":"markdown","c11063d9":"markdown","1dfbe879":"markdown","a4cb78a3":"markdown","575c30f8":"markdown","20fcbdf8":"markdown","92053ba8":"markdown","695518d1":"markdown","7ceb95b5":"markdown","ef8ddfd1":"markdown","428f3806":"markdown","7a485026":"markdown","e6bf77a1":"markdown","b2076e5e":"markdown"},"source":{"527b96bc":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline\n\nimport missingno as msno\nimport re\n\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","50e9d3ec":"train_df = pd.read_csv(\"..\/input\/titanic\/train.csv\")\n# train_df = train_df.replace({np.nan: None})\n\ntest_df = pd.read_csv(\"..\/input\/titanic\/test.csv\")\n# test_df = test_df.replace({np.nan: None})","a6de17c3":"train_df.head()","e120a533":"train_df.tail()","fa4c90fa":"train_df.shape","cee76788":"test_df.head()","6c4a7db9":"train_df = train_df.drop('PassengerId',axis=1)\ntest_df = test_df.drop(\"PassengerId\",axis=1)","afff0acb":"print(\"Training set columns:\\n\",train_df.columns)\nprint(\"Testing set columns:\\n\",test_df.columns)","df6314ef":"train_df[\"Embarked\"].unique()","45ad7632":"train_df.dtypes","bbdc55ed":"def convert_to_categorical_data_type(df,is_train=True):\n    if is_train:\n        df[\"Survived\"] = pd.Categorical(df[\"Survived\"])\n    df[\"Pclass\"] = pd.Categorical(df[\"Pclass\"])\n    df[\"Sex\"] = pd.Categorical(df[\"Sex\"])\n    df[\"Embarked\"] = pd.Categorical(df[\"Embarked\"])\n    print(df.dtypes)","99463099":"print(\"For training set:\")\nconvert_to_categorical_data_type(train_df)","05affba5":"print(\"For testing set:\")\nconvert_to_categorical_data_type(test_df,False)","2d4fac85":"msno.bar(train_df)","68610475":"train_df = train_df.drop([\"Cabin\"],axis=1)\ntest_df = test_df.drop([\"Cabin\"],axis=1)","ff11d70f":"train_df = train_df[train_df[\"Embarked\"].notna()]","98e8875d":"msno.matrix(train_df)","04440e3b":"msno.bar(test_df)","0b572ba6":"train_df[\"train_set\"] = True\ntest_df[\"Survived\"] = None\ntest_df[\"train_set\"] = False","ec69452f":"print(train_df.columns)\nprint(test_df.columns)","08536e71":"df = pd.concat([train_df,test_df])","006236d9":"df.head()","a39ab671":"df[\"Age\"] = df[\"Age\"].fillna(df[\"Age\"].mean())","b68ed363":"df[\"Name\"].head(60)","2317f5d0":"df[\"Title\"] = df[\"Name\"].str.extract(\"([a-zA-Z]*[.])\",expand = False)","5e466f6c":"df[\"Title\"]","b6b9b3df":"df.head()","8a1a9093":"df = df.drop(\"Name\",axis=1)\ndf.columns","2c2b10a8":"df[\"Title\"] = pd.Categorical(df[\"Title\"])\ndf[\"train_set\"] = pd.Categorical(df[\"train_set\"])\ndf.dtypes","f63ce7b2":"sns.heatmap(df.corr(),annot = True)","2abea23a":"sns.swarmplot(x = df[\"Survived\"],y = df[\"Age\"])","501870be":"sns.swarmplot(x = df[\"Survived\"],y = df[\"SibSp\"])","c58adf86":"sns.swarmplot(x = df[\"Survived\"],y = df[\"Parch\"])","d1907162":"sns.swarmplot(x = df[\"Survived\"],y = df[\"Parch\"]+df[\"SibSp\"])\nplt.title(\"Survived vs number of relatives\")","cfbf4928":"df[\"Relatives\"] = df[\"Parch\"] + df[\"SibSp\"]\ndf = df.drop(\"Parch\",axis=1)\ndf = df.drop(\"SibSp\",axis=1)\ndf.columns","4799adde":"sns.swarmplot(x = df[\"Survived\"],y = df[\"Fare\"])","d8f50fc0":"df = df.drop(\"Fare\",axis=1)\ndf.columns","d3d12b52":"def survived_vs_cat_col_plot(colname,df):\n    plt.subplot(1,2,1)\n    sns.countplot(x = df[\"Survived\"],hue = df[colname])\n    \n    plt.subplot(1,2,2)\n    sns.countplot(x = df[colname])\n    \n    plt.subplots_adjust(left=0.1,right=0.9,wspace=0.4,hspace=0.4)","a3365258":"train_df = df[df[\"train_set\"] == True]\nsurvived_vs_cat_col_plot(\"Pclass\",train_df)","881df288":"print(\"On ship:\")\n\nc1 = len(train_df[train_df[\"Pclass\"]==1])\nc2 = len(train_df[train_df[\"Pclass\"]==2])\nc3 = len(train_df[train_df[\"Pclass\"]==3])\nprint(\"Class 1 :\",c1)\nprint(\"Class 2 :\",c2)\nprint(\"Class 3 :\",c3)\n\nsurvived = train_df[train_df[\"Survived\"] == 1]\ns_c1 = len(survived[survived[\"Pclass\"] == 1])\ns_c2 = len(survived[survived[\"Pclass\"] == 2])\ns_c3 = len(survived[survived[\"Pclass\"] == 3])\nprint(\"\\nSurvived:\")\nprint(\"Class1 :\",s_c1)\nprint(\"Class2 :\",s_c2)\nprint(\"Class3 :\",s_c3)\n\nprint(\"\\nPercentage of people of who survived in each class:\")\nprint(\"Class1 :\",(s_c1*100) \/ c1 )\nprint(\"Class2 :\",(s_c2*100) \/ c2 )\nprint(\"Class3 :\",(s_c3*100) \/ c3 )","4dcfae6c":"survived_vs_cat_col_plot(\"Sex\",train_df)","6eea367b":"survived_vs_cat_col_plot(\"Embarked\",train_df)","17715d56":"df = df.drop(\"Embarked\",axis=1)\ndf.columns","71eaf54f":"train_df = df[df[\"train_set\"] == True]\ntest_df = df[df[\"train_set\"] == False]","01e3ba63":"survived = train_df[train_df[\"Survived\"]==1]\nsns.countplot(x = survived[\"Title\"])\nplt.xticks(rotation = 90)\nplt.title(\"Distribution of survived passangers according to title\")\nplt.show()","bd91f4cb":"not_survived = train_df[train_df[\"Survived\"]==0]\nsns.countplot(x = not_survived[\"Title\"])\nplt.xticks(rotation = 90)\nplt.title(\"Distribution of not survived passangers according to title\")\nplt.show()","d2932baa":"sns.countplot(x = train_df[\"Title\"])\nplt.xticks(rotation = 90)\nplt.title(\"Distribution of passangers according to their titles\")\nplt.show()","0200ccb0":"df[\"Ticket\"].head(50)","1104edf7":"df = df.drop(\"Ticket\",axis=1)\ndf.columns","abc8b41d":"df.head()","d2b92cc0":"def category_to_number(colname,df):\n    unique_vals = list(df[colname].unique())\n    category_to_num = {}\n    for i in range(len(unique_vals)):\n        category_to_num[unique_vals[i]] = i\n        df = df.replace(to_replace = unique_vals[i],value = i)\n    return df","f4feaaa5":"df = category_to_number(\"Sex\",df)\ndf.head()","8beb404f":"df = category_to_number(\"Title\",df)\ndf.head()","16b9ffa2":"from sklearn.model_selection import train_test_split\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn import tree,svm\nfrom sklearn import metrics","7494f55f":"train_df = df[df[\"train_set\"] == True]\ntrain_df = train_df.drop(\"train_set\",axis=1)\ntrain_df.columns","d4da7b75":"test_df = df[df[\"train_set\"] == False]\ntest_df = test_df.drop([\"train_set\",\"Survived\"],axis=1)\ntest_df.columns","4fe3367a":"X = train_df.drop(\"Survived\",axis=1)\ny = train_df[\"Survived\"]","74954712":"X_train, X_test, y_train, y_test = train_test_split(X,y,test_size=0.3,random_state=1)","485bd82b":"print(\"Length of X_train :\",len(X_train))\nprint(\"Length of X_test :\",len(X_test))\nprint(\"Length of y_train :\",len(y_train))\nprint(\"Length of y_test :\",len(y_test))","e41b6ca0":"decision_tree = tree.DecisionTreeClassifier()\ndecision_tree.fit(X_train, y_train)\ny_pred = decision_tree.predict(X_test)","c611c22d":"def display_metrics(y_test,y_pred):\n    confusion_matrix = metrics.confusion_matrix(y_test,y_pred)\n    plt.xticks([0, 1], [0, 1])\n    plt.yticks([0, 1], [0, 1])\n\n    sns.heatmap(pd.DataFrame(confusion_matrix), annot=True)\n    plt.title('Confusion Matrix')\n    plt.ylabel('Actual')\n    plt.xlabel('Predicted')\n    plt.show()\n\n    print('Accuracy:', round(metrics.accuracy_score(y_test, y_pred), 2))\n    print('Precision:', round(metrics.precision_score(y_test, y_pred), 2))\n    print('Recall:', round(metrics.recall_score(y_test, y_pred), 2))\n    print('F1 score:', round(metrics.f1_score(y_test, y_pred), 2))","b88556c4":"display_metrics(y_test,y_pred)","05484030":"model = svm.SVC()\nmodel.fit(X_train,y_train)\ny_pred = model.predict(X_test)\ndisplay_metrics(y_test,y_pred)","cc0e8e9a":"model = RandomForestClassifier(max_depth=3,random_state=1) # max_depth is chosen as 3, since there are 5 attributes in the dataframe\nmodel.fit(X_train,y_train)\ny_pred = model.predict(X_test)\ndisplay_metrics(y_test,y_pred)","7fee2f6a":"y_pred = model.predict(test_df)\nsurvived = pd.Series(y_pred)\ntest_df = pd.read_csv(\"..\/input\/titanic\/test.csv\")","6418c2aa":"data = {\"PassengerId\":test_df[\"PassengerId\"],\"Survived\":survived}\ntest_df = pd.concat(data,axis=1)","f61c19ba":"test_df.head()","2a69db21":"test_df.to_csv(\".\/submission.csv\",index=False)","9484cce9":"The survivors seem to be younger than those that did not survive. The only exception is the one 80 (approximately) year old survivor.","c077c0f6":"The ticket entries mostly seem to be random numbers. In some entries there is a prefix that consitutes letters and special symbols. However, there is not much repetition to decipher a pattern. Thus, we must drop the ticket column.","bdad5724":"177\/891 age values are missing. Approximately 19.86% of values for age are missing. We can impute these missing values. (For training set)","2e619bd5":"Accuracies achieved so far:<br>\nDecision Tree- 0.79<br>\nSupport Vector Machine- 0.63<br>\nLet us try training the data using Random Forest. I am using random forests because they are are an ensemble learning algorithm that combine the simplicity of decision trees with flexibility.","ef1cd5ce":"There are almost twice as many male passengers as female passengers, however the number of female passengers that survived is far greater. Thus, chances of survival of female passenger > chances of survival of male passenger.","6e7c15c2":"# Plotting survied vs each categorical variable","ba388db0":"# Support Vector Machine","23b3bb28":"Now that we have the titles we can drop the name column and we must convert Title to a categorical column.","55d62cfc":"The distribution for port of embarkation is more or less similar for survived and not survived. Thus, we don't gain any valuable insight from this column. Thus, we must drop this column.","da3033b0":"We can observe that people with certain titles are more likely to survive. For example: There are about 200 passangers with the title \"Miss.\", and more than 120 of them survived. However, there 500 people with the title \"Mr.\" and only about 80 of them survived. Using the title column, we can try to guess if a passenger survived or not.","aecc1ebd":"To analyze our model we need to know the testing accuracy. Thus, let us split train_df into X_train, X_test, y_train, y_test.","37ada1ac":"Sex, title are categorical but have string data. For every category let us assign a unique number.","e0e6be6f":"As we can see that there are more families with fewer relatives than there are with more relatives. However, there it seems that a person who is saved is more likely to belong to a smaller family. Thus, let us create a new column indicating total relatives","57180fc9":"There are certain variables that are categorical but are considered numeric or object in the dataset. Thus, we must convert those variables to categorical data types. Such variables are Survived, Pclass, Sex, Embarked.","c11063d9":"Since there are only two rows with value of Embarked missing, we can drop these rows.","1dfbe879":"Random Forest has shown the best accuracy so far. Thus, I will choose Random Forest as my final model.","a4cb78a3":"Now that all columns have the correct data type, let us inspect for missing values. The training set has 891 rows.","575c30f8":"On the ship, more than 60% of class 1 passengers survived, 47% if class 2 passangers survived and 24% of class 3 passengers survived. Thus, chances of survival of class1 passenger > chances of survival of class2 passenger > chances of survival of class3 passenger.","20fcbdf8":"We can observe that PassangerId is a just a serial numbering of all the passangers. This is likely to have no bearing on whether a passanger survived or not. Thus, we can drop the PassangerId column.","92053ba8":"There is not much correlation between any two numerical columns. Thus, I will keep all the columns in the dataset.","695518d1":"Fare patterns are similar for both survived and not survived. Thus, fare is not a useful parameter. Hence, we must drop it.","7ceb95b5":"# Plotting survived vs each numeric variable.","ef8ddfd1":"# Spliting data into training and testing","428f3806":"Since, cabin has 687\/891 rows missing, it won't help with predictions. Thus, drop the cabin column.","7a485026":"As we can see the passenger's name is written along with his\/her title. Maybe title had an impact in whether the passenger survived or not. Title occurs immediately after the first comma.","e6bf77a1":"# Decision Tree","b2076e5e":"86 age values are missing in test set. That is approximately, 20.5% of values. The missing age values for the train and test set must be imputed by the mean of the entire data."}}