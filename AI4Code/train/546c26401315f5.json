{"cell_type":{"f81fd870":"code","9599d603":"code","4bbdc259":"code","e3b6dc7a":"code","48b0ae52":"code","f89c075d":"code","3018b177":"code","441ccdf9":"code","1b491507":"code","5b3c01f1":"code","078ef2b6":"code","e15a7aa1":"code","12e971a0":"code","87729819":"code","63405ccf":"code","b6dbce4f":"code","421f1ce8":"code","9b564fc0":"code","0153c3db":"code","d3826637":"code","78454836":"code","514eb8e3":"code","5d499efa":"code","316a1ec9":"code","23ee33fd":"code","1a6e2b0d":"code","977419ad":"code","9e4c0fca":"code","b25bd110":"code","56a709df":"code","2d7ea74f":"code","c3bb6151":"code","982fa97e":"code","fa5e660d":"code","d021e1d1":"code","0b895c49":"markdown","82dda92e":"markdown","2d2b8a33":"markdown","98352e90":"markdown","3979bc79":"markdown","1a080089":"markdown","a6affb92":"markdown","51f74f4d":"markdown","d8c65625":"markdown","00c46138":"markdown","a96b28dd":"markdown","4618a067":"markdown","d58ac000":"markdown","65c275a9":"markdown","bab8df8d":"markdown","3768f702":"markdown","b5b4f399":"markdown"},"source":{"f81fd870":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import LabelEncoder\n\nfrom catboost import CatBoostClassifier, Pool\nfrom catboost.utils import get_confusion_matrix\nsns.set(style=\"darkgrid\")","9599d603":"train = pd.read_csv(\"..\/input\/health-insurance-cross-sell-prediction\/train.csv\")\ntest = pd.read_csv(\"..\/input\/health-insurance-cross-sell-prediction\/test.csv\")","4bbdc259":"train.head()","e3b6dc7a":"train.info()","48b0ae52":"train.describe().T","f89c075d":"train = train.drop(['id'], axis=1)","3018b177":"numerical = ['Age', 'Region_Code','Annual_Premium','Vintage']\nsns.pairplot(train[numerical])","441ccdf9":"sns.distplot(train.Age)","1b491507":"sns.countplot(train.Response)","5b3c01f1":"sns.countplot(train.Gender)","078ef2b6":"df_response = train.groupby(['Gender','Response'])['Age'].count().reset_index()\ndf_response = df_response.rename(columns={'Age':'Count'})\ndf_response","e15a7aa1":"sns.catplot(x='Gender',y='Count',\n            col='Response',\n            data=df_response,\n           kind='bar')","12e971a0":"df_DL = train.groupby(['Gender'])['Driving_License'].count().reset_index()\ndf_DL = df_DL.rename(columns={'Driving_License':'Driving License'})\ndf_DL","87729819":"sns.catplot(x='Gender',y='Driving License',\n            data=df_DL,\n           kind='bar')","63405ccf":"sns.countplot(train.Previously_Insured)","b6dbce4f":"df_PDL = train.groupby(['Gender','Previously_Insured'])['Age'].count().reset_index()\ndf_PDL = df_PDL.rename(columns={'Age':'count','Previously_Insured':'Previously Insured'})\ndf_PDL","421f1ce8":"sns.catplot(x='Gender',y='count',\n            col='Previously Insured',\n            data=df_PDL,\n           kind='bar')","9b564fc0":"df_vehicleage = train.groupby(['Vehicle_Age','Response'])['Age'].count().reset_index()\ndf_vehicleage = df_vehicleage.rename(columns={'Age':'count','Vehicle_Age':'Vehicle Age'})\ndf_vehicleage","0153c3db":"sns.catplot(x='Vehicle Age',y='count',\n            col='Response',\n            data=df_vehicleage,\n           kind='bar')","d3826637":"df_damaged = train.groupby(['Vehicle_Damage','Response'])['Age'].count().reset_index()\ndf_damaged = df_damaged.rename(columns={'Age':'count','Vehicle_Damage':'Vehicle Damage'})\ndf_damaged","78454836":"sns.catplot(x='Vehicle Damage',y='count',\n            col='Response',\n            data=df_damaged,\n           kind='bar')","514eb8e3":"sns.distplot(train.Vintage)","5d499efa":"train_copy = train.copy()\n\nlb_make = LabelEncoder()\ntrain_copy[\"Gender\"] = lb_make.fit_transform(train_copy['Gender'])\ntrain_copy['Vehicle_Age'] = lb_make.fit_transform(train_copy['Vehicle_Age'])\ntrain_copy['Vehicle_Damage'] = lb_make.fit_transform(train_copy['Vehicle_Damage'])\ntrain_copy.head()","316a1ec9":"features = train_copy.iloc[:,:-1]\nlabels = train_copy.iloc[:,-1:]","23ee33fd":"x_train, x_test, y_train, y_test = train_test_split(features, labels, test_size=0.3)","1a6e2b0d":"eval_dataset = Pool(x_test,\n                    y_test)\n\nmodel = CatBoostClassifier(learning_rate=0.0001,\n                           eval_metric='AUC')","977419ad":"model.fit(x_train,\n          y_train,\n          eval_set=eval_dataset)","9e4c0fca":"print(model.get_best_score())","b25bd110":"cm = get_confusion_matrix(model, eval_dataset)\n\nfig = plt.figure(figsize=(12,7))\npredict_accuracy_on_test_set = (cm[0,0] + cm[1,1])\/(cm[0,0] + cm[1,1]+cm[1,0] + cm[0,1])\nax = sns.heatmap(cm, linewidths=0.5, linecolor='white',square=True)\nplt.show()\n\nprint(\"catboost Accuracy : \", predict_accuracy_on_test_set*100)","56a709df":"test.head()","2d7ea74f":"lb_make = LabelEncoder()\ntest[\"Gender\"] = lb_make.fit_transform(test['Gender'])\ntest['Vehicle_Age'] = lb_make.fit_transform(test['Vehicle_Age'])\ntest['Vehicle_Damage'] = lb_make.fit_transform(test['Vehicle_Damage'])\ntest.head()","c3bb6151":"eval_test = Pool(test)\neval_test","982fa97e":"pred = model.predict(eval_test)\npred.shape","fa5e660d":"submit = pd.DataFrame(index=test.index)\nsubmit[\"id\"] = test.id\nsubmit[\"Response\"] = pred\nsubmit.set_index('id').reset_index(inplace=True)\nsubmit.head()","d021e1d1":"submit.to_csv(\"Submission.csv\")","0b895c49":"### Driving License by Gender","82dda92e":"### Customers with Damaged Vehicle","2d2b8a33":"### Response Distribution","98352e90":"* Age between 20-50 are most likely to go for insurance.","3979bc79":"## Importing Libraries","1a080089":"## Loading the data","a6affb92":"### Customers with Driving License ","51f74f4d":"### Age Distribution of Customers","d8c65625":"* There are no missing values on the dataset.","00c46138":"### Response by Gender","a96b28dd":"### Building Model","4618a067":"### Vintage - Number of Days customer is associated with the company","d58ac000":"## EDA (Exploratory Data Analysis) ","65c275a9":"### Making Predictions on Test Data","bab8df8d":"### Data PreProcessing","3768f702":"* Drop the column ID.","b5b4f399":"### Correlation among Features"}}