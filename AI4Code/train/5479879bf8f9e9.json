{"cell_type":{"230e886e":"code","94538350":"code","75a5e6a6":"code","08a1c282":"code","57074102":"code","c493eee7":"code","00d5dd3f":"code","b76e436e":"markdown","78fecabf":"markdown","706e02b6":"markdown","3a3bb3bc":"markdown","6ac150c5":"markdown"},"source":{"230e886e":"import pandas as pd \nimport numpy as np\npd.set_option(\"display.max_rows\", None, \"display.max_columns\", None)","94538350":"# Read data\ndf = pd.read_csv('\/kaggle\/input\/jane-street-market-prediction\/train.csv')\n","75a5e6a6":"# check overall correlations\ncorr = df.corr()\ncorr.style.background_gradient(cmap='coolwarm')","08a1c282":"corr_values = corr.abs()\nupper_triangle_matrix = corr_values.where(np.triu(np.ones(corr_values.shape), k=1).astype(np.bool))\n\n# Find features with correlation greater than 0.9\ncols_to_drop = [column for column in upper_triangle_matrix.columns if any(upper_triangle_matrix[column] > 0.9)]\n\ncols_to_drop","57074102":"# we don't want to drop 'ts_id' or 'resp'\ncols_to_drop.pop(0)\ncols_to_drop.pop()\ncols_to_drop","c493eee7":"# Drop features \ndf = df.drop(cols_to_drop, axis=1)\n\n# Show new dataframe\ndf.head()","00d5dd3f":"# check overall correlations\ncorr = df.corr()\ncorr.style.background_gradient(cmap='coolwarm')","b76e436e":"### Drop columns","78fecabf":"### Check new feature correlation matrix","706e02b6":"### Find features with correlation higher than 0.9","3a3bb3bc":"Dataset from: [https:\/\/www.kaggle.com\/c\/jane-street-market-prediction\/overview](http:\/\/)\n\nFrom the problem description we get:\n    \n*In general, if one is able to generate a highly predictive model which selects the right trades to execute, \nthey would also be playing an important role in sending the market signals that push prices closer to \u201cfair\u201d values. \nThat is, a better model will mean the market will be more efficient going forward. However, developing good \nmodels will be challenging for many reasons, including a very low signal-to-noise ratio, <b>potential redundancy, \nstrong feature correlation<\/b>, and difficulty of coming up with a proper mathematical formulation.***\n    \nSo I thought it could be interesting to find and remove some of these highly correlated features in the dataset.","6ac150c5":"### Features Correlation"}}