{"cell_type":{"dfa7c5bc":"code","833af666":"code","4003454d":"code","db95f25c":"code","904da303":"code","7896ae19":"code","295c3412":"code","031c6def":"code","31775983":"code","08e47f70":"code","29730e75":"code","38149bfb":"code","bce9ae75":"code","0335ed9d":"code","0feb2e89":"markdown"},"source":{"dfa7c5bc":"\nimport numpy as np\nimport pandas as pd\nimport pickle\nfrom tensorflow.keras.layers import Input,Conv2D,Flatten,Dense\n#from tensroflow.keras.applications import\nfrom tensorflow.keras import Model\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.model_selection import train_test_split,KFold\nimport os","833af666":"path=\"\/kaggle\/input\/particle-collisions\/\"","4003454d":"X=[]\ny=[]","db95f25c":"\nfor f in os.listdir(path):\n    file = open( path + f, 'rb')\n    data = pickle.load(file)\n    file.close()\n    \n    imgs,targets=data[0],data[1]\n    X+=[img for img in imgs]\n    y+=[target for target in targets]\n    ","904da303":"X[0].shape","7896ae19":"X=np.array(X)","295c3412":"y=pd.DataFrame(y)\ny=pd.get_dummies(y.iloc[:,0])\ny ","031c6def":"X_train,X_test,y_train,y_test = train_test_split(X,y,test_size=0.2)","31775983":"#sample collision\nX[77]","08e47f70":"# # of classes\ny.shape[1]","29730e75":"input_shape=X[0].shape\n\ninp=Input((input_shape[0],input_shape[1],1))\nx=Flatten()(inp)\nx=Dense(64,activation='relu')(x)\nx=Dense(64,activation='relu')(x)\nx=Dense(32,activation='relu')(x)\n\nout=Dense(y.shape[1],activation='softmax')(x)\n\nmodel=Model(inputs=inp,outputs=out)","38149bfb":"model.compile(optimizer='adam',metrics=['accuracy'],loss=\"categorical_crossentropy\")","bce9ae75":"y","0335ed9d":"model.fit(X_train,y_train,\n         epochs=1,validation_data=(X_test,y_test)\n         )","0feb2e89":"The data consists of 350 pickle files, with each file representing a unique collision. There are two columns in each file .i.e\nColumn 1, a list of 10x10 images and\n\nColumn 2, the particle type associated to the image.\n\nEach event contains approximately 3,000 labeled images of different particle trajectories passing through many detectors resulting from the collision\n\nThe particle types and their associated numbers\/labels are as follows:\n\n11: electron\n\n13: muon\n\n211: pion\n\n321: kaon\n\n2212: proton"}}