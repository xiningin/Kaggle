{"cell_type":{"09172d9f":"code","fab49ec7":"code","5c5bca42":"code","9f4720fe":"code","1e7e77ad":"code","2ee8aaba":"code","aee6bab1":"code","585240ce":"code","f0f45144":"code","85063cb8":"code","aafbf936":"code","2b99264a":"code","fe524410":"code","fdf72fa9":"code","197327cf":"code","29646d52":"markdown","a63f4432":"markdown","c9672b74":"markdown","baaa999c":"markdown","4a05da42":"markdown","42a0b1ba":"markdown","c0885501":"markdown","eb7e5ff4":"markdown","ae4ee282":"markdown","5e858b99":"markdown","a6d3532f":"markdown","ac16440c":"markdown","9a218c2a":"markdown","dc520d32":"markdown","35fa2cb8":"markdown","1f688f9f":"markdown"},"source":{"09172d9f":"#Importing the necessary libraries\nimport numpy as np\nimport pandas as pd\nimport numpy as np\nimport chardet\nimport matplotlib.pyplot as plt\nfrom mpl_toolkits.basemap import Basemap","fab49ec7":"with open('..\/input\/datasetindex.txt', 'rb') as rawdata:\n    result = chardet.detect(rawdata.read(1000000))\n    \nprint(result)","5c5bca42":"#reading the dataset\ndata = pd.read_table('..\/input\/datasetindex.txt', sep='\\t', encoding='ISO-8859-1', index_col=0)\ndata.info()\ndata.sample(5)","9f4720fe":"col_names = ['earthquake_code', 'date', 'time', 'latitude', 'longitude',\n       'depth(km)', 'xM', 'MD', 'ML', 'Mw', 'Ms', 'Mb', 'type', 'location']\ndata.columns = col_names\ndata.head(3)","1e7e77ad":"#There was a wrong data of seconds, updated that\nsec_err = data['time'].str.extract(r'\\:(\\d+)\\.')[0].apply(lambda x: int(x))\nprint(sec_err[sec_err>59])\ndata.loc[13080, 'time'] = '10:03:59.00'\nprint(sec_err[sec_err>59])","2ee8aaba":"data['date_time'] = pd.to_datetime(data['date'] + ' ' + data['time'])\ndata = data.drop(['date', 'time'], axis=1)","aee6bab1":"countries = ['YUNANISTAN', 'GURCISTAN', 'RUSYA', 'IRAN', 'AZERBAYCAN', 'MAKEDONYA', \n             'BULGARISTAN', 'SURIYE', 'IRAK', 'ROMANYA', 'ARNAVUTLUK', 'MISIR', \n             'KIBRIS RUM KESIMI', 'UKRAYNA', 'YUNANiSTAN', 'iRAN', 'BULGARiSTAN',\n             'G\u00dcRCiSTAN', 'MISIR', 'SURiYE', 'ISRAIL', 'ONiKi ADALAR YUNANiSTAN',\n             'KIBRIS RUM KESiMi']\nfor country in countries:\n    data = data[data.location != country]\n    \n#delete the points out of Turkey's geolocation\ndata = data[data.latitude >= 36]\ndata = data[data.longitude >= 26]","585240ce":"data['city'] = data['location'].str.extract(r'\\((.+)\\)')\ndata.city = data.city.fillna(data[data.city.isnull()].location)","f0f45144":"data[['date_time', 'city', 'xM']].sort_values('xM', ascending=False).head(10)","85063cb8":"data.xM.plot.hist(bins=10)","aafbf936":"data['year'] = data.date_time.apply(lambda x: x.year)\ndata['month'] = data.date_time.apply(lambda x: x.month)\ndata['weekday'] = data.date_time.apply(lambda x: x.dayofweek)\ndataover5 = data[data.xM >= 5]\n\nplt.figure(figsize=(15,5))\nplt.subplot(1,2,1)\ndataover5.month.value_counts().sort_index().plot.bar()\nplt.xlabel('Months of the year')\nplt.subplot(1,2,2)\ndataover5.weekday.value_counts().sort_index().plot.bar()\nplt.xlabel('Days of the week')","2b99264a":"plt.figure(figsize=(15,5))\nplt.subplot(1,2,1)\ndata.month.value_counts().sort_index().plot.bar()\nplt.xlabel('Months of the year')\nplt.subplot(1,2,2)\ndata.weekday.value_counts().sort_index().plot.bar()\nplt.xlabel('Days of the week')","fe524410":"plt.figure(figsize=(15,5))\nplt.subplot(1,2,1)\nplt.plot(data.year.value_counts().sort_index())\nplt.subplot(1,2,2)\nplt.plot(data[data.xM >= 5].year.value_counts().sort_index())","fdf72fa9":"data.year.value_counts().sort_index(ascending=False).plot.area()\ndata[data.xM >= 5].year.value_counts().sort_index(ascending=False).plot.area()\nplt.legend(['all earthquakes', '5 plus'])","197327cf":"sel = data[data.xM >= 5]\nlon = sel['longitude'].values\nlat = sel['latitude'].values\nxM = sel['xM'].values\n\nfig = plt.figure(figsize=(12, 6))\nm = Basemap(projection='lcc', resolution='l', lat_0=39, lon_0=35, width=1.7E6, height=1E6)\nm.bluemarble()\nm.drawcoastlines(color='gray')\nm.drawcountries(color='red')\n\nm.scatter(lon, lat, latlon=True, c=xM, s=xM*2, cmap='YlOrRd', alpha=0.7)\n\nplt.colorbar()\nplt.clim(5, 8)","29646d52":"The location data is very detailed and not structured. It shows the provinces and cities. City names are included generally in paranthesis. I am creating a new column showing only the city names. ","a63f4432":"Whilst checking the location column I realised there are other countries in the data. I cleared them out. ","c9672b74":"The dataset is in a txt file and whilst reading it, an encoding error has raised. I used *chardet* library to detect the encoding.","baaa999c":"Since I eradicated the error I can now create one column of datetime and drop the others. ","4a05da42":"As seen above encoding is *ISO-8859-1* on a confidence level of 73%. ","42a0b1ba":"# Visualisations","c0885501":"The graphics above gives their trends differently by years. Below the total earthquakes and the ones more than 5 can be seen in the same graph. ","eb7e5ff4":"The frequency of earthquakes are shown above. The most frequent eathquakes have a magnitude between 3 and 4. The Richter magnitude scale categorises earthquakes below 5 as minor. I plotted some non-minor insights below. The month of May is a bit unlucky, the most of the earthqaukes more than 5 happening on May. Also Wednesday is the most shakey day of the week. ","ae4ee282":"Let's explore the data. Here is the 10 worst earthquakes of Turkey. The heaviest earthquate was occured in the city of Erzincan in 1939. ","5e858b99":"\nBelow I plotted the frequency of the earthquakes by years. The graph on left shows the occurence of earthquakes are on an increasing trend. The occurences peak somewhere in 1970s, this probably means that there were new technologies to capture the data from then. The graph on the right shows the frequency of eathquakes with magnitude higher then 5. ","a6d3532f":"By looking all data, May is still the worst month of all, however, the most shakey day is Sunday. This refutes a popular Turkish pun 'Tuesday shakes' (Sal\u0131 sallan\u0131r).  ","ac16440c":"Maps are better to comprehend the geologic data. Below you may see the projection of earthquakes with magnitudes more than 5. Seismicly most active areas of Turkey are Aegean Region and Eastern Anatolia. ","9a218c2a":"# Data Cleaning","dc520d32":"Above it is seen that the column names are in Turkish and the last column is partially in Turkish. I am translated them and replace the column names with their English equivalents. ","35fa2cb8":"Date and time are two different columns and they are not in *datetime* format. When I tried to convert them to datetime in one column, I recieved an error that there was a problem with seconds. One of the data point had higher than 59, which is impossible for a second. Below, you may see how I found that point and updated it. ","1f688f9f":"# About Me\nHello all, I am Hasan and this is my first kernel. I'm still learning python and data science libraries. So your comments are extremely helpful to me. \n\n# Introduction\nTurkey stands between Europe and Asia. Geographically country is rather young hence it is more sismographically active. I found this dataset on Kaggle which originates from Kandilli Rasathanesi which is a reputable organisation affiliated with Bogazici University. I will try to analyse the data and create some visualisations. "}}