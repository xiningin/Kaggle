{"cell_type":{"186fbf2b":"code","c98c6ed7":"code","20c71f58":"code","ea09441c":"code","38e39ff0":"code","b0d211ff":"code","e054d6b5":"code","864319de":"code","65424d62":"code","f385e8c3":"code","9a8c4151":"code","e9e3a77e":"code","c4dd1ef7":"code","2b7725a7":"code","9f733aa1":"code","784f6898":"code","818136a7":"code","3db67c63":"code","ae399a92":"code","290cd7a2":"code","bc055a08":"code","ce78b8c3":"code","a95e79dd":"code","dfe528dd":"code","2e271a33":"code","a7958618":"code","b307f4bd":"code","6e3d2c74":"markdown","28d175de":"markdown","9c911fae":"markdown","38afcb14":"markdown","6c925afc":"markdown","95a58a9a":"markdown","860f0463":"markdown","67ad1c50":"markdown","bad1440a":"markdown","73602da5":"markdown","98e7eb9a":"markdown","d3b8d529":"markdown","9e2efd3c":"markdown","cb9aed51":"markdown","530e8912":"markdown","0f84cdd2":"markdown"},"source":{"186fbf2b":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","c98c6ed7":"tri=pd.read_csv('\/kaggle\/input\/release\/TRI_2018_FED.csv')\ntri","20c71f58":"descriptions=tri.iloc[:,[0,3,4,5,6,7,8,13,15,16,17,18,32,33,36,37,38,40,42,99]]\ndescriptions","ea09441c":"# Python program to Remove all  \n# digits and periods from a list of string \nimport re \n  \ndef remove(strings): \n    pattern = '[0-9,.]'\n    strings = [re.sub(pattern, '', i) for i in strings] \n    return strings\n  \n#call method on all column names  \ndescriptions.columns=remove(descriptions.columns)\n\n#call strip method to get rid of leading and trailing white space\ndescriptions.columns=descriptions.columns.str.strip()\ndescriptions","38e39ff0":"descriptions['CARCINOGEN'].value_counts()","b0d211ff":"#create dataframe with amounts and their title (index)\npiechart = pd.DataFrame({'Carcinogen': [descriptions['CARCINOGEN'].value_counts()[0],descriptions['CARCINOGEN'].value_counts()[1]]},\n                  index=['no', 'yes'])\n\n#use dataframe plot function, specify as pie chart\nplot = piechart.plot.pie(y='Carcinogen', figsize=(5, 5),autopct='%1.1f%%')","e054d6b5":"descriptions['CLEAN AIR ACT CHEMICAL'].value_counts()","864319de":"piechart = pd.DataFrame({'Clean Air Act Chemical': \n        [descriptions['CLEAN AIR ACT CHEMICAL']\n         .value_counts()[0],descriptions['CLEAN AIR ACT CHEMICAL'].value_counts()[1]]},\n                  index=['yes', 'no'])\nplot = piechart.plot.pie(y='Clean Air Act Chemical', figsize=(5, 5),autopct='%1.1f%%')","65424d62":"#create series of the 5 states that were cited the most \nmost_dumps=descriptions['ST'].value_counts()[0:5]\n\n#create dataframe of number of dumps and the respective state\n#rather than list data points one by one, can call the indices of the most_dumps series\nmd = pd.DataFrame({'Number of Releases': [most_dumps[i] for i in range(len(most_dumps))]},\n                  index=[most_dumps.index[j] for j in range(len(most_dumps.index))])\nplot = md.plot.pie(y='Number of Releases', figsize=(5, 5),autopct='%1.1f%%')","f385e8c3":"descriptions['UNIT OF MEASURE'].value_counts()","9a8c4151":"#series of all states\nstates=descriptions['ST'].value_counts().index\n\n#create blank dataframe that we'll add to\ntotals=pd.DataFrame()\n\n#iterate through every stat\nfor state in states:\n    \n    #extract all of state's data from full dataset\n    state_df=descriptions[descriptions['ST'].isin([state])]\n    state_df=state_df.reset_index()\n    \n    #set variable to zero before we add the mass of all chemicals released for given state\n    weight=0\n    \n    #iterate through dataframe of state's data\n    for release in range(len(state_df)):\n        \n        #most entries are in pounds, but use if statement to account for the ones in grams\n        if state_df['UNIT OF MEASURE'][release]=='Grams':\n            weight+=(state_df['TOTAL RELEASES'][release])*0.00220462\n        else:\n            weight+=state_df['TOTAL RELEASES'][release]\n            \n    #add to the empty dataframe: name of state and the total amountof chemicals released        \n    totals=totals.append({'state': state,'total':weight},ignore_index=True)\ntotals","e9e3a77e":"#get dataframe with top 5 highest amounts\ntop=totals.nlargest(5,'total').reset_index()","c4dd1ef7":"md2 = pd.DataFrame({'Total mass released': [top['total'][i] for i in range(len(top))]},\n                  index=[top['state'][j] for j in range(len(top))])\nplot = md2.plot.pie(y='Total mass released', figsize=(5, 5),autopct='%1.1f%%')","2b7725a7":"descriptions.sort_values(by=['TOTAL RELEASES'],ascending=False).head()","9f733aa1":"descriptions[descriptions['FACILITY NAME'].isin(['RED DOG OPERATIONS'])]","784f6898":"carcinogens=descriptions[descriptions['CARCINOGEN'].isin(['YES'])].reset_index()\n\n#create series of the 5 states that were cited the most \nmost_dumps_carcinogenic=carcinogens['ST'].value_counts()[0:5]\n\n#create dataframe of number of dumps and the respective state\n#rather than list data points one by one, can call the indices of the most_dumps series\nmdc = pd.DataFrame({'Number of Carcinogenic Releases': \n                   [most_dumps[i] for i in range(len(most_dumps_carcinogenic))]},\n    index=[most_dumps.index[j] for j in range(len(most_dumps_carcinogenic.index))])\nplot = mdc.plot.pie(y='Number of Carcinogenic Releases', figsize=(5, 5),autopct='%1.1f%%')","818136a7":"totals_carcinogenic=pd.DataFrame()\n\nfor state in states:\n    \n    state_df_carcinogenic=carcinogens[carcinogens['ST'].isin([state])]\n    state_df_carcinogenic=state_df_carcinogenic.reset_index()\n    weight_carcinogenic=0\n    \n    for release in range(len(state_df_carcinogenic)):\n        if state_df_carcinogenic['UNIT OF MEASURE'][release]=='Grams':\n            weight_carcinogenic+=(state_df_carcinogenic['TOTAL RELEASES'][release])*0.00220462\n        else:\n            weight_carcinogenic+=state_df_carcinogenic['TOTAL RELEASES'][release]\n            \n    totals_carcinogenic=totals_carcinogenic.append({'state': state,'total':weight_carcinogenic},ignore_index=True)\n\n#get data from all other states for comparison\nothers=carcinogens[-carcinogens['ST'].isin(['TX','IL','LA','IN','MI'])].reset_index()\nweight_others=0\nfor release in range(len(others)):\n        if others['UNIT OF MEASURE'][release]=='Grams':\n            weight_others+=(others['TOTAL RELEASES'][release])*0.00220462\n        else:\n            weight_others+=others['TOTAL RELEASES'][release]\n\nothers_df=pd.DataFrame({'Total carcinogenic material released':weight_others},index=['others'])            \n\ntop_carcinogenic=totals_carcinogenic.nlargest(10,'total').reset_index()\nmdc2 = pd.DataFrame({'Total carcinogenic material released': [top_carcinogenic['total'][i] for i in range(len(top_carcinogenic))]},\n                  index=[top_carcinogenic['state'][j] for j in range(len(top_carcinogenic))])\nmdc2_full=mdc2.append(others_df)\n\nplot=mdc2_full.plot.pie(y='Total carcinogenic material released', figsize=(5, 5),autopct='%1.1f%%')\nplot.legend(loc='center right',bbox_to_anchor=(1.5, 0.5))","3db67c63":"sectors=descriptions['INDUSTRY SECTOR'].value_counts().index\n\nsectors_list=[]\nfor sector in sectors:\n    df=descriptions[descriptions['INDUSTRY SECTOR'].isin([sector])]\n    sectors_list.append(df)\n\ndef get_sector(sector):\n    for num in range(len(sectors_list)):\n        short=sectors_list[num]['INDUSTRY SECTOR'].value_counts()\n        if short.index[0]==sector:\n            return sectors_list[num].reset_index()","ae399a92":"get_sector('Chemicals')","290cd7a2":"by_sector=pd.DataFrame()\nfor sector in sectors:\n    df=get_sector(sector)\n    total=0\n    for release in range(len(df)):\n        if df['UNIT OF MEASURE'][release]=='Grams':\n            total+=(df['TOTAL RELEASES'][release])*0.00220462\n        else:\n            total+=df['TOTAL RELEASES'][release]\n    by_sector=by_sector.append({'sector':sector,'Total material released':total},ignore_index=True)","bc055a08":"top=by_sector.nlargest(7,'Total material released').reset_index()\ndfpie=pd.DataFrame({'Total':[top['Total material released'][row] for row in range(len(top))]},\n                   index=[top['sector'][row] for row in range(len(top))])\nplot=dfpie.plot.pie(y='Total', figsize=(5, 5),autopct='%1.1f%%')\nplot.legend(loc='center right',bbox_to_anchor=(1.7, 0.5))","ce78b8c3":"others=by_sector[-by_sector['sector'].isin([top['sector'][i]for i in range(len(top))])].reset_index()\nweight=0\nfor release in range(len(others)):\n        weight+=others['Total material released'][release]\n\nothers_df=pd.DataFrame({'Total':weight},index=['others']) \ndfpie=dfpie.append(others_df)\nplot=dfpie.plot.pie(y='Total', figsize=(5, 5),autopct='%1.1f%%')\nplot.legend(loc='center right',bbox_to_anchor=(1.7, 0.5))","a95e79dd":"metals=get_sector('Metal Mining')['CHEMICAL'].value_counts().index\ndf=get_sector('Metal Mining')\nmetals_df=pd.DataFrame()\n\nfor metal in metals:\n    metal_df=df[df['CHEMICAL'].isin([metal])].reset_index()\n    weight=0\n    for release in range(len(metal_df)):\n        if metal_df['UNIT OF MEASURE'][release]=='Grams':\n            weight+=(metal_df['TOTAL RELEASES'][release])*0.00220462\n        else:\n            weight+=metal_df['TOTAL RELEASES'][release]\n    metals_df=metals_df.append({'Metal':metal,'Total material released': weight},ignore_index=True)\ntop=metals_df.nlargest(7,'Total material released').reset_index()\ndfpie=pd.DataFrame({'Total':[top['Total material released'][row] for row in range(len(top))]},\n                   index=[top['Metal'][row] for row in range(len(top))])\n\n#total material for all but the top\nothers=metals_df[-metals_df.isin([top['Metal'][i]for i in range(len(top))])]\ntotal=0\nfor release in range(len(others)):\n        total+=others['Total material released'][release]\n\nothers_df=pd.DataFrame({'Total':total},index=['others']) \ndfpie=dfpie.append(others_df)\nplot=dfpie.plot.pie(y='Total', figsize=(5, 5),autopct='%1.1f%%')\nplot.legend(loc='center right',bbox_to_anchor=(2.5, 0.5))","dfe528dd":"Create method to view breakdown of chemicals within an industry sector.","2e271a33":"def sector_breakdown(industry_sector,num_comparisons):\n    metals=get_sector(industry_sector)['CHEMICAL'].value_counts().index\n    df=get_sector(industry_sector)\n    metals_df=pd.DataFrame()\n\n    for metal in metals:\n        metal_df=df[df['CHEMICAL'].isin([metal])].reset_index()\n        weight=0\n        for release in range(len(metal_df)):\n            if metal_df['UNIT OF MEASURE'][release]=='Grams':\n                weight+=(metal_df['TOTAL RELEASES'][release])*0.00220462\n            else:\n                weight+=metal_df['TOTAL RELEASES'][release]\n        metals_df=metals_df.append({'Metal':metal,'Total material released': weight},ignore_index=True)\n    top=metals_df.nlargest(num_comparisons,'Total material released').reset_index()\n    dfpie=pd.DataFrame({'Total':[top['Total material released'][row] for row in range(len(top))]},\n                       index=[top['Metal'][row] for row in range(len(top))])\n\n    #total material for all but the top\n    others=metals_df[-metals_df.isin([top['Metal'][i]for i in range(len(top))])]\n    total=0\n    for release in range(len(others)):\n            total+=others['Total material released'][release]\n\n    others_df=pd.DataFrame({'Total':total},index=['others']) \n    dfpie=dfpie.append(others_df)\n    plot=dfpie.plot.pie(y='Total', figsize=(5, 5),autopct='%1.1f%%')\n    plot.legend(loc='center right',bbox_to_anchor=(2.5, 0.5))\n    return ","a7958618":"def sector_breakdown_carcinogenic(industry_sector,num_comparisons):\n    metals=get_sector(industry_sector)['CHEMICAL'].value_counts().index\n    df=get_sector(industry_sector)\n    metals_df=pd.DataFrame()\n\n    for metal in metals:\n        metal_df=df[df['CHEMICAL'].isin([metal]) & df['CARCINOGEN'].isin(['YES'])].reset_index()\n        weight=0\n        for release in range(len(metal_df)):\n            if metal_df['UNIT OF MEASURE'][release]=='Grams':\n                weight+=(metal_df['TOTAL RELEASES'][release])*0.00220462\n            else:\n                weight+=metal_df['TOTAL RELEASES'][release]\n        metals_df=metals_df.append({'Metal':metal,'Total material released': weight},ignore_index=True)\n    top=metals_df.nlargest(num_comparisons,'Total material released').reset_index()\n    dfpie=pd.DataFrame({'Total':[top['Total material released'][row] for row in range(len(top))]},\n                       index=[top['Metal'][row] for row in range(len(top))])\n\n    #total material for all but the top\n    others=metals_df[-metals_df.isin([top['Metal'][i]for i in range(len(top))])]\n    total=0\n    for release in range(len(others)):\n            total+=others['Total material released'][release]\n\n    others_df=pd.DataFrame({'Total':total},index=['others']) \n    dfpie=dfpie.append(others_df)\n    plot=dfpie.plot.pie(y='Total', figsize=(5, 5),autopct='%1.1f%%')\n    plot.legend(loc='center right',bbox_to_anchor=(2.5, 0.5))\n    return ","b307f4bd":"sector_breakdown('Food',5)\nsector_breakdown_carcinogenic('Food',5)","6e3d2c74":"There are a couple problems with the data at first glance. Many columns are ID's or tracking information that's not important for this analysis. Let's extract the relevat data to make the dataframe more readable.","28d175de":"Let's change up the analysis and look at the different industry sectors.","9c911fae":"How about the most total amount of chemicals released?","38afcb14":"Interesting- Alaska wasn't even in the top five for the most number of releases, but they have released nearly as many chemicals (by mass) as the next four combined. Let's see if there are any large corporations in Alaska that may be primary contributors to this.","6c925afc":"Which states had the most dumps?","95a58a9a":"Metal mining stands out- what metals contribute most to this?","860f0463":"Make pie chart showing distrbution of clean air act chemicals.","67ad1c50":"* EPA has been collecting Toxic Release Inventory (TRI) data since 1987. Each \"Basic\" data file accessible from this webpage contains the 100 most-requested data fields from the TRI Reporting Form R and Form A. \n\nQuantities of dioxin and dioxin-like compounds are reported in grams, while all other chemicals are reported in pounds.","bad1440a":"With 116 columns, this microset will be the descriptions for all the data entries. There is a lot of numerical data to understand and sort through, so let's hold that off until later. Tri is still our original dataset so all of the original data is still in tact.","73602da5":"Red dog operations is a zince minng company, which explains why a lot of their dumps are so heavy. Their website acknowledges that they standout on the TRI, and Alaska Department of Environmental Conservation addresses concerns and asserts that there is little to no effect to human health or the envionemt, and that their chemical dumps are barely make the cut to be considered toxic.","98e7eb9a":"Let's take a look at all of the carcinogenic releases.","d3b8d529":"This looks much better- the numbers in the headings made it confusing and extra to type in.","9e2efd3c":"Builds off the previous method by looking at carcinogens only.","cb9aed51":"Let's try to make a simple pie graph displaying the percent of carcinogenic toxins.","530e8912":"Which sector is the most carcinogenic? Which has released the most carcinogenic materials?","0f84cdd2":"Red Dog Operations, operating in Alaska, has the two largest releases tracked in the TRI- by far. This explains why Alaska's releases were so high."}}