{"cell_type":{"2ae2a595":"code","a55d9b00":"code","27bfeac3":"code","40773758":"code","7cbbf472":"code","3827bc12":"code","f28d927c":"code","dc356d31":"code","d727fb75":"code","c853d9e3":"code","c38e434e":"code","87f2754f":"code","dba7ef89":"code","03accc23":"code","3d426d7a":"markdown","6ac6ae94":"markdown","791fbe69":"markdown","802008e1":"markdown","d98dfd30":"markdown"},"source":{"2ae2a595":"!pip install tpot","a55d9b00":"# Data handling \nimport pandas as pd \nimport numpy as np\n\n# Model\nfrom tpot import TPOTClassifier\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import OneHotEncoder\n\n# Evaluation\nfrom sklearn.metrics import accuracy_score","27bfeac3":"# Import data\ndf_train = pd.read_csv(\"..\/input\/titanic\/train.csv\")\ndf_train.head()","40773758":"# Drop id\ndf_train.drop(columns=[\"PassengerId\", \"Name\"], inplace=True)\ny = df_train[\"Survived\"]\nX = df_train.drop(columns=[\"Survived\"])","7cbbf472":"# Train test split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=0)\n\n# Encoding\n# Fill missing categorical variables\nX_train[\"Embarked\"].fillna(\"S\", inplace=True)\nX_test[\"Embarked\"].fillna(\"S\", inplace=True)\n\n# OneHot encoder \nencoder = OneHotEncoder(drop=\"first\", sparse=False)\ncolumns = [\"Sex\", \"Embarked\"]\nlabel_X_train = pd.DataFrame(encoder.fit_transform(X_train[columns]), index=X_train.index)\nlabel_X_test = pd.DataFrame(encoder.transform(X_test[columns]), index=X_test.index)\n\nX_train_numeric = X_train.select_dtypes(exclude=\"object\")\nX_test_numeric = X_test.select_dtypes(exclude=\"object\")\nX_train = pd.concat([X_train_numeric, label_X_train], axis=1, ignore_index=True)\nX_test = pd.concat([X_test_numeric, label_X_test], axis=1, ignore_index=True)","3827bc12":"pipeline_optimizer = TPOTClassifier(generations=5, \n                                  population_size=50, \n                                  cv=5, \n                                  scoring=\"accuracy\")\npipeline_optimizer.fit(X_train, y_train)","f28d927c":"predictions = pipeline_optimizer.predict(X_test)","dc356d31":"accuracy_score(y_test, predictions)","d727fb75":"# Import test data\ntest_df = pd.read_csv(\"..\/input\/titanic\/test.csv\")\ntest_df","c853d9e3":"test = test_df.drop(columns=[\"PassengerId\", \"Name\"])\ntest.head()","c38e434e":"# Encoding\ncolumns = [\"Sex\", \"Embarked\"]\nlabel_test = pd.DataFrame(encoder.transform(test[columns]), index=test.index)\ntest_numeric = test.select_dtypes(exclude=\"object\")\ntest = pd.concat([test_numeric, label_test], axis=1)","87f2754f":"test_predictions = pipeline_optimizer.predict(test)","dba7ef89":"output = pd.DataFrame({\"PassengerId\":test_df[\"PassengerId\"], \n                      \"Survived\": test_predictions})\noutput.head()","03accc23":"output.to_csv(\"submission.csv\", index=False)","3d426d7a":"## Predictions","6ac6ae94":"# Submission","791fbe69":"## Preprocessing","802008e1":"# Packages","d98dfd30":"# Model Development"}}