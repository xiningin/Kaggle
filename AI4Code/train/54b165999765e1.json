{"cell_type":{"c0fdabb6":"code","4727af33":"code","d758166f":"code","ac872eb3":"code","0d4752f1":"code","cd7340f2":"code","a7d4e69b":"code","b823881d":"code","129f166c":"code","21ac66ee":"code","d6cdab89":"code","d7709202":"code","b04912a6":"code","50702f28":"code","3736ea07":"code","d467c29f":"code","e86287c7":"code","f023e040":"code","79118aed":"code","0b553a37":"code","e4610698":"code","e3b77a27":"code","e7cad776":"code","9f620a46":"code","a30e7c62":"code","30233000":"markdown","0c4208ea":"markdown","19c26c07":"markdown","06045fee":"markdown","1f1b3c4f":"markdown","d5e34538":"markdown","1ff0d14c":"markdown","92b2c706":"markdown","b06eb898":"markdown","86f17932":"markdown","f479ddfe":"markdown","ebe2d600":"markdown","9b28c5e2":"markdown"},"source":{"c0fdabb6":"import pandas as pd\nimport numpy as np\nimport sklearn\nimport matplotlib as plt","4727af33":"adult_data = pd.read_csv(\"..\/input\/adult-data-set\/train_data.csv\", sep=r'\\s*,\\s*', engine='python', na_values=\"?\")\n\nadult_test = pd.read_csv('..\/input\/adult-data-set\/test_data.csv', sep=r'\\s*,\\s*', engine='python', na_values=\"?\")","d758166f":"adult_data.head()","ac872eb3":"adult_data.shape","0d4752f1":"adult_data.income.value_counts().plot(kind=\"bar\")","cd7340f2":"adult_data[\"sex\"].value_counts().plot(kind=\"pie\", radius=1.2, autopct='%1.1f%%')","a7d4e69b":"adult_data.race.value_counts().plot(kind=\"bar\")","b823881d":"adult_data[\"workclass\"].value_counts()","129f166c":"adult_data_aux = adult_data.dropna()","21ac66ee":"adult_data_ = adult_data_aux[[\"age\", \"workclass\", \"fnlwgt\", \"education\", \"education.num\", \"marital.status\", \n                                      \"occupation\", \"relationship\", \"race\", \"sex\", \"capital.gain\", \"capital.loss\", \n                                      \"hours.per.week\", \"native.country\", \"income\"]]","d6cdab89":"adult_data_.shape","d7709202":"adult_test.head()","b04912a6":"adult_test.shape","50702f28":"adult_test_ = adult_test[[\"age\", \"workclass\", \"fnlwgt\", \"education\", \"education.num\", \"marital.status\", \n                                      \"occupation\", \"relationship\", \"race\", \"sex\", \"capital.gain\", \"capital.loss\", \n                                      \"hours.per.week\", \"native.country\"]]","3736ea07":"adult_test_.shape","d467c29f":"Xadult = adult_data_[[\"age\",\"education.num\",\"capital.gain\",\"capital.loss\",\"hours.per.week\"]]\nYadult = adult_data_.income\nXtestAdult = adult_test_[[\"age\",\"education.num\",\"capital.gain\",\"capital.loss\",\"hours.per.week\"]]","e86287c7":"from sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.model_selection import cross_val_score","f023e040":"knn = KNeighborsClassifier(n_neighbors=30)\nscores = cross_val_score(knn, Xadult, Yadult, cv=10)","79118aed":"scores","0b553a37":"scores.mean()","e4610698":"knn.fit(Xadult,Yadult)","e3b77a27":"YtestPred = knn.predict(XtestAdult)","e7cad776":"YtestPred.shape","9f620a46":"predict = pd.DataFrame(adult_test.Id)\npredict[\"income\"] = YtestPred\npredict","a30e7c62":"predict.to_csv(\"prediction.csv\", index=False)","30233000":"Checking out the data formatting:","0c4208ea":"So, about 2400 elements were deleted from the data set due to having NaN values. Now, we have to deal with the testing data.","19c26c07":"As seen, the testing data is now manageable. We can, finally, begin to work with the kNN application.","06045fee":"Now, the data needs some sharpening.","1f1b3c4f":"Following, some experimentation with the data set, plotting graphs and analyzing values:","d5e34538":"Importing libraries used in this trial:","1ff0d14c":"We will begin by selecting only a few of the values - the numeric ones - for prediction purposes.","92b2c706":"# Adult Data Set Prediction","b06eb898":"###### Implementing K-Nearest-Neighbors in the Adult Data Set, in order to predict whether a person makes more or less than US$50k a year.","86f17932":"Importing data from UCI and labeling the headers:","f479ddfe":"Then, we import the kNN method from SciKit Learn, as well as the cross validation algorithm.","ebe2d600":"It is necessary to remove from the data all the unknown values:","9b28c5e2":"We will test the 30 nearest neighbors."}}