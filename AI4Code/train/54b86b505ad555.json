{"cell_type":{"fe361787":"code","6205f0f3":"code","aaa980b5":"code","e4c0cbc4":"code","f910be2a":"code","ae50b048":"code","ecec4be8":"code","e0f7988c":"code","d57ca71a":"code","1e1ead00":"code","197f0e30":"code","4965c7a4":"code","d6f1633b":"markdown","c716da1a":"markdown","2c213733":"markdown","e15b1a3f":"markdown","6ff2a59c":"markdown","7fb36285":"markdown"},"source":{"fe361787":"import json\n\nimport pandas as pd\nimport matplotlib.pyplot as plt\n\nfrom pathlib import Path\nfrom sklearn.model_selection import StratifiedKFold","6205f0f3":"# Paths to the base directories\/files of the dataset\nbase_dir = Path('\/kaggle\/input\/cassava-leaf-disease-classification')\ntrain_df = pd.read_csv(f'{base_dir}\/train.csv')","aaa980b5":"# Read the JSON file and write its contents to a variable\nwith open(f'{base_dir}\/label_num_to_disease_map.json') as f:\n    class_names = json.loads(f.read())\nf.close()","e4c0cbc4":"# Let's show the names of the classes \nclass_names","f910be2a":"# Let's check our DataFrame with training data\ntrain_df.head()","ae50b048":"# Add a new column with appropriate class names for labels\ntrain_df['label_name'] = train_df['label'].apply(lambda x: class_names[str(x)])","ecec4be8":"# Check the result\ntrain_df.head()","e0f7988c":"# Let's look at the distribution of classes\ntrain_df.groupby('label')['image_id'].count().plot(kind='bar', title='Class distribution');","d57ca71a":"# Let's use StratifiedKFold to split the dataset into 4 parts\nsk = StratifiedKFold(n_splits=4, random_state=42, shuffle=True)\n\nfor fold, (train, val) in enumerate(sk.split(train_df, train_df.label)):\n    train_df.loc[val, 'fold'] = fold","1e1ead00":"# Converting from float type to int\ntrain_df.fold = train_df.fold.astype(int)","197f0e30":"# Check the result\ntrain_df","4965c7a4":"# Save updated dataset\ntrain_df.to_csv('\/kaggle\/working\/train_splitted.csv', index=False)","d6f1633b":"<h1 style='background:#2cab6c; border:0; color:white'><center>Paths, files<\/center><\/h1>","c716da1a":"<h1 style='background:#2cab6c; border:0; color:white'><center>Save Dataset<\/center><\/h1>","2c213733":"<h1 style='background:#2cab6c; border:0; color:white'><center>Data Preprocessing<\/center><\/h1>","e15b1a3f":"We have successfully applied the dataset splitting into 4 parts using sklearn <a href='https:\/\/scikit-learn.org\/stable\/modules\/generated\/sklearn.model_selection.StratifiedKFold.html'>sklearn StratifiedKFold<\/a>, let's save our updated dataset for later training the model.","6ff2a59c":"<h1 style='background:#2cab6c; border:0; color:white'><center>Importing Libraries<\/center><\/h1>","7fb36285":"<h1 style='background:#2cab6c; border:0; color:white'><center>Stratified K-Folds<\/center><\/h1>"}}