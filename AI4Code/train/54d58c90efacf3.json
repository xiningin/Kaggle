{"cell_type":{"a104aec7":"code","14b0b111":"code","6a38bb54":"code","67c5b260":"code","a38148b1":"code","089093f9":"code","8b99fc42":"code","9bd9bfaf":"code","57d34b29":"code","e8f3d053":"code","6ede730c":"code","c7ed203f":"code","3c23bd85":"code","ed2fadcb":"markdown"},"source":{"a104aec7":"SEED = 2311\n\nimport os\nos.environ['TF_CPP_MIN_LOG_LEVEL'] = '3' #suppressing GPU warnings\n\nimport pandas as pd\nfrom lightgbm import LGBMClassifier\nfrom sklearn.model_selection import train_test_split","14b0b111":"data_dir = '..\/input\/tabular-playground-series-nov-2021\/'","6a38bb54":"%%time\ntrain = pd.read_csv(data_dir + 'train.csv', index_col='id')\ntest = pd.read_csv(data_dir + 'test.csv', index_col='id')","67c5b260":"train.head()","a38148b1":"train.info()","089093f9":"print(f'Missing values - Train data: {train.isna().sum().sum()}, Test data: {test.isna().sum().sum()}')","8b99fc42":"target = train.pop('target')","9bd9bfaf":"target.value_counts()","57d34b29":"xtrain, xval, ytrain, yval = train_test_split(train, \n                                              target, \n                                              stratify=target, \n                                              test_size=0.2, \n                                              random_state=SEED)\n\nxtrain.shape, xval.shape, ytrain.shape, yval.shape","e8f3d053":"model = LGBMClassifier(\n    n_estimators=1000,\n    objective='binary',\n    random_state=SEED\n)","6ede730c":"model.fit(\n    xtrain, ytrain,\n    eval_set=[(xval, yval)],\n    eval_metric='auc',\n    early_stopping_rounds=50,\n    verbose=50\n)","c7ed203f":"predictions = model.predict_proba(test)[:, 1]","3c23bd85":"output = pd.DataFrame({'id': test.index, 'target': predictions})\noutput.to_csv('submission.csv', index=False)\n\n!head submission.csv","ed2fadcb":"Time to submit!"}}