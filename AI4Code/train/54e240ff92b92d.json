{"cell_type":{"ad8f7fc6":"code","9191911c":"code","b8bc2ba2":"code","e2c738c8":"code","434c489f":"code","b9f6fc7a":"code","bc4873b9":"code","32ef8aa8":"code","ebd96df9":"code","36163340":"code","5e538e62":"code","3ddc4cb5":"code","c3efbe77":"code","0d66f5dc":"code","e1b9b476":"code","f68e425d":"code","1f6ba635":"code","b0960fdf":"code","10d10690":"code","08bc193c":"code","c569d40f":"code","fe188b49":"code","1b5abd04":"code","20137370":"code","c1854b51":"code","89092c75":"code","e287d349":"code","8ee4a16e":"code","5df9b9f3":"code","4ee5af11":"code","2a8c519d":"code","842f2f2a":"markdown","89e48ce6":"markdown","1c0dc069":"markdown","95339bad":"markdown","7f77b8ae":"markdown"},"source":{"ad8f7fc6":"import numpy as np\nimport matplotlib.pyplot as plt\nimport cv2\nimport os\nimport glob\nimport warnings\nwarnings.simplefilter('ignore')","9191911c":"training_path='..\/input\/yellow-vein-mosaic-disease\/data\/train'","b8bc2ba2":"disease_class=['diseased okra leaf','fresh okra leaf']\n##taking one diseased okra leaf image\npath=os.path.join(training_path ,disease_class[0],'*')\nimg=glob.glob(path)\nimg=cv2.imread(img[3])\nimage = cv2.cvtColor(img, cv2.COLOR_BGR2RGB )","e2c738c8":"plt.imshow(image)\nplt.title('diseased okra leaf')","434c489f":"##fresh okra leaf\npath=os.path.join(training_path ,disease_class[1],'*')\nimg=glob.glob(path)\nimg=cv2.imread(img[2])\nimage = cv2.cvtColor(img, cv2.COLOR_BGR2RGB )","b9f6fc7a":"plt.imshow(image)\nplt.title('fresh okra leaf')","bc4873b9":"import tensorflow as tf\nfrom keras.preprocessing.image import ImageDataGenerator","32ef8aa8":"train_datagen=ImageDataGenerator(rescale=1.\/255,rotation_range=20,width_shift_range=0.2,height_shift_range=0.2,shear_range=0.2,zoom_range=0.2,horizontal_flip=True,fill_mode='nearest')","ebd96df9":"val_datagen=ImageDataGenerator(rescale=1.0\/255)","36163340":"train_data=train_datagen.flow_from_directory('..\/input\/yellow-vein-mosaic-disease\/data\/train',target_size=(150,150),batch_size=32,class_mode='categorical')","5e538e62":"val_data=val_datagen.flow_from_directory('..\/input\/yellow-vein-mosaic-disease\/data\/val',target_size=(150,150),batch_size=32,class_mode='categorical')","3ddc4cb5":"train_data.class_indices","c3efbe77":"from keras.applications.vgg19 import VGG19\nfrom keras import optimizers\nfrom keras import Sequential\nfrom keras.layers import Dense,Flatten","0d66f5dc":"conv_base=VGG19(weights='imagenet',include_top=False,input_shape=(150,150,3))","e1b9b476":"conv_base.summary()","f68e425d":"model3=Sequential()\nmodel3.add(conv_base)\nmodel3.add(Flatten())\nmodel3.add(Dense(512,activation='relu',))\nmodel3.add(Dense(2,activation='softmax'))","1f6ba635":"model3.compile(optimizer=optimizers.RMSprop(lr=2e-5),loss='categorical_crossentropy',metrics=['accuracy'])","b0960fdf":"# don't train existing weights\nfor layer in conv_base.layers:\n    layer.trainable = False","10d10690":"history=model3.fit_generator(train_data,validation_data=val_data,epochs=3,steps_per_epoch=len(train_data),validation_steps=len(val_data))","08bc193c":"plt.plot(history.history['loss'], label='train loss')\nplt.plot(history.history['val_loss'], label='val loss')\nplt.legend()\nplt.show()\nplt.savefig('LossVal_loss')\n\n# plot the accuracy\nplt.plot(history.history['accuracy'], label='train acc')\nplt.plot(history.history['val_accuracy'], label='val acc')\nplt.legend()\nplt.show()\nplt.savefig('AccVal_acc')","c569d40f":"model3.save('vgg19.h5')","fe188b49":"from keras.models import load_model","1b5abd04":"model=load_model('.\/vgg19.h5')\n","20137370":"test_datagen=ImageDataGenerator(rescale=1.0\/255)","c1854b51":"test_data=test_datagen.flow_from_directory('..\/input\/yellow-vein-mosaic-disease\/data\/test',target_size=(150,150),batch_size=32,class_mode='categorical')","89092c75":"model.evaluate(test_data)","e287d349":"!pip install gradio","8ee4a16e":"import gradio\nimport gradio as gr","5df9b9f3":"def healthy_or_diseased(img):\n    img = img.reshape(1, 150, 150, 3)\n    prediction = model.predict(img).tolist()[0]\n    class_names = [\"diseased okra leaf\", \"fresh okra leaf\"]\n    return {class_names[i]: prediction[i] for i in range(2)}","4ee5af11":"im = gradio.inputs.Image(shape=(150, 150), image_mode='RGB', invert_colors=False, source=\"upload\")","2a8c519d":"iface = gr.Interface(\n    fn = healthy_or_diseased, \n    inputs = im, \n    outputs = gradio.outputs.Label(),\n)\niface.launch(share=True)","842f2f2a":"## You can find the dataset [here](https:\/\/www.kaggle.com\/manojgadde\/yellow-vein-mosaic-disease)","89e48ce6":"## Gradio Interface","1c0dc069":"## Project Brief","95339bad":"## 1. Project idea, How it started?\nLast month I completed my deep learning course as part of my PGD from IIIT Bangalore, I have done many projects based on CNN and RNN, LSTM but with the publicly available data. Even though those projects and assignments looks cool but that doesn\u2019t gave me much satisfaction. so, I decided to do one project from scratch.\n## 2. why this project?\nI live in a village! so I choose an agriculture-based project and it also very easy for me to collect the data.To collect the data first I need to think of a problem right?\nSo I interacted with one of my nearest okra plants field farmer and I asked him several questions like what is the major disease that affects the growth of okra plants?\nhe\u2019s not able to say the exact disease name but he showed me some diseased okra leaves and those leaves are completely affected by the disease(yellow vein mosaic) and he also mentioned that during an early stage of disease spread it is very difficult to spot the disease(as healthy and diseased almost looks similar) and by the time he identifies the disease it almost spread over remaining plants. so after walking around the field and talking to him, I found out the problem and that is detecting the disease at an early stage is a crucial thing and if we can able detect the disease at an early stage, we can stop the further spread of disease by using pesticides.\nso finally I formulated the problem!\ud83d\udd7a\n## 3. what happened next?\nAfter I found the problem that can be solved using deep learning, I discussed the same with my friend and he agreed to help me.\nAs the next step of the process, we collected the image data of okra diseased and healthy leaves within two days and we have around 2000 images ready for training.","7f77b8ae":"## github [link](https:\/\/github.com\/manoj567\/yellow-vein-mosaic-disease-prediction-in-okra-leaves)"}}