{"cell_type":{"1980c7cf":"code","590f0ab3":"code","2576c3b7":"code","b0fde56e":"code","27810bfa":"code","a62f4be2":"code","f9a6506b":"code","abaead60":"code","65242289":"code","171261fa":"code","4408ebf3":"code","02b1a3d1":"code","f863d0e2":"code","24c968d5":"code","7d0cc6b6":"code","0a56c4e9":"code","bf7793a2":"code","df627a78":"code","e043652c":"code","9eaeae84":"code","64c87dd2":"code","31532ece":"code","46843ce9":"code","85f0c126":"code","dc4caff4":"markdown","a9783ba2":"markdown","5e728d80":"markdown","9913326f":"markdown","e451eee4":"markdown","67c73b9b":"markdown","2e0bbbea":"markdown","74da9ea9":"markdown","fd45afb9":"markdown","a7ca9adf":"markdown"},"source":{"1980c7cf":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","590f0ab3":"import numpy as np\nimport pandas as pd\nfrom matplotlib import pyplot as plt\nimport seaborn as sns\nfrom sklearn.model_selection import train_test_split , GridSearchCV\nfrom sklearn.metrics import f1_score , accuracy_score , roc_auc_score\nfrom sklearn.preprocessing import StandardScaler","2576c3b7":"data = pd.read_csv('..\/input\/heart-failure-clinical-data\/heart_failure_clinical_records_dataset.csv')","b0fde56e":"data.head()","27810bfa":"data.shape","a62f4be2":"data.head()","f9a6506b":"data['age'] = data['age'].astype(int)\ndata['platelets'] = data['platelets'].astype(int)","abaead60":"sns.countplot(data['sex']);","65242289":"sns.displot(data['age']);","171261fa":"data['age'].describe()","4408ebf3":"np.median(data['age'])","02b1a3d1":"corr = data.corr()\nax , fig  = plt.subplots(figsize =(10 , 8 ))\nsns.heatmap(corr ,vmin = -1 , cmap='coolwarm', annot = True)\nplt.show()","f863d0e2":"corr[abs(corr['DEATH_EVENT']) > 0.1]['DEATH_EVENT']","24c968d5":"X = data.drop(columns= 'DEATH_EVENT')\ny = data['DEATH_EVENT']","7d0cc6b6":"X_train, X_test , y_train , y_test = train_test_split(X, y , test_size = 0.2)","0a56c4e9":"from sklearn.linear_model import LogisticRegression","bf7793a2":"model = LogisticRegression()\nmodel.fit(X_train,y_train)\ny_pred = model.predict(X_test)","df627a78":"s1 = accuracy_score(y_test,y_pred)\nf1 = f1_score(y_test,y_pred)\nprint(\"Linear Regression accuracy_score :\", \"{:.2f}%\".format(100*s1),'\\n'\n      'Linear Regression f1-score : ', \"{:.2f}%\".format(100*f1))","e043652c":"params = {\n    'C' : [1,2,3,4,5,6,7,8,9,10,11],\n    'penalty' : ['l1' , 'l2'],\n    'max_iter' : [100,500]\n}","9eaeae84":"model_cv = GridSearchCV(model , params , cv = 10 , n_jobs= -1)\nmodel_cv.fit(X_train, y_train)\ny_pred_cv = model_cv.predict(X_test)","64c87dd2":"s1_cv = accuracy_score(y_test,y_pred_cv)\nf1_cv = f1_score(y_test,y_pred_cv)\nprint(\"Linear Regression accuracy_score :\", \"{:.2f}%\".format(100*s1_cv),'\\n'\n      'Linear Regression f1-score : ', \"{:.2f}%\".format(100*f1_cv))","31532ece":"from sklearn.ensemble import RandomForestClassifier","46843ce9":"RF_model = RandomForestClassifier()\nRF_model.fit(X_train,y_train)\ny_pred_rf = RF_model.predict(X_test)","85f0c126":"s1_rf = accuracy_score(y_test,y_pred_rf)\nf1_rf = f1_score(y_test,y_pred_rf)\nprint(\"Random Forest Classifier accuracy_score :\", \"{:.2f}%\".format(100*s1_rf),'\\n'\n      'Random Forest Classifier f1-score : ', \"{:.2f}%\".format(100*f1_rf))","dc4caff4":"### Modeling and Optimization ","a9783ba2":"Let's highlight the features that have a positive correlation close to zero","5e728d80":"## Feature correlation","9913326f":" The median and mean values are close, so we can say that the average age of the people in our dataset is 60 years\n\n","e451eee4":"### libraries","67c73b9b":"### Data visualization","2e0bbbea":" In our dataset, the number of male readings exceeds the number of female readings.\n","74da9ea9":"### Logistic Regression ","fd45afb9":"### Random forest classifier","a7ca9adf":"we will correct the signs"}}