{"cell_type":{"51c3d99f":"code","c43f778d":"code","40cd1491":"code","8dcd48ea":"code","0f3c0b45":"code","56c842e2":"code","ff4bb486":"code","fe2441b2":"code","b89eabe2":"code","29f75b1c":"code","908cc1d6":"code","e92c0362":"code","8a94d4aa":"code","f44efd6b":"code","d98a751b":"code","a7a9cefd":"code","c11a95e9":"code","3a668aa6":"code","671f6dbe":"code","09b022ce":"code","2283cd69":"code","e0f8a60b":"code","35404cab":"code","01c66a59":"code","372ddc5a":"code","dda77168":"code","247320e4":"code","a616b3e5":"code","1a1240a8":"code","01408358":"code","38284ab5":"code","5427e571":"code","b81b7e5d":"code","6b5a4c98":"code","008b92af":"code","98b34724":"code","85867202":"code","af1021d7":"code","5da697ef":"code","672c60d6":"code","5cb25354":"code","a85f2aa1":"code","92a5d5fa":"code","391b7b65":"code","902b99ed":"code","efcedcdf":"code","e7c056b4":"code","504ef2f1":"code","813ad490":"code","46c7d852":"code","baf6c7e5":"code","bf231b0b":"code","48e41e95":"code","c94f5e10":"code","9764e9b6":"code","a5437aaf":"code","e2303b2e":"code","18ff2bd1":"code","bf2ca9bd":"code","c3b8e00d":"code","f173713f":"code","d8f2b4e2":"code","2bd7f03a":"code","f2eef2b2":"code","b0add700":"code","1a304093":"code","d9233902":"code","9a4edc44":"code","47e202f5":"code","681e65ec":"code","d44ea1e6":"code","4fac602b":"code","e57ff7ed":"code","8149d1ff":"code","4a20f4a6":"code","c51e0156":"code","0c166c81":"code","3638b580":"code","da93986e":"code","1f31460c":"code","0c79bda8":"code","181f2fd7":"code","9ff005b0":"code","9d6b4c6c":"code","a06fe1cc":"code","7077436f":"code","200082df":"code","73051471":"code","65d738ac":"code","ca39911e":"code","c9a5db0c":"code","8b87beac":"code","91d9005e":"code","eede0954":"code","d9d4c8c1":"code","4eac14af":"code","aeab7bfb":"code","3bd96d04":"code","06de8b4d":"code","c8985436":"code","1c0e5abb":"code","de5bd44a":"code","784e415f":"code","7ef13568":"code","2ecb854f":"code","d986db8e":"code","616e805e":"code","77a1eb28":"code","a377e51c":"code","70e8a858":"code","e299896b":"code","22fcf94e":"code","f41333b3":"code","3293d71c":"code","19fe2470":"code","18bdf9c0":"code","f39c8976":"code","e66ba269":"code","3274d31a":"code","eb40f3a5":"code","037e40b2":"code","b41947be":"code","d1d534ec":"code","5c233b6b":"code","8de6c306":"code","6545ae13":"code","612a2226":"code","3d70b2a5":"code","22a0f3e2":"code","c47b51e1":"code","4646dbcd":"code","c4d9b636":"code","ad56150e":"code","0ffa343f":"code","5dbc6ab0":"code","8b89b325":"code","629cba5e":"code","7fa45469":"code","e5514457":"code","107f9fae":"code","e0609ac3":"code","7e89ee18":"code","8d578d8c":"markdown","02256a8d":"markdown","2fb6245b":"markdown","e83fc695":"markdown","850ac0a2":"markdown","c6b1dd5d":"markdown","d89b9028":"markdown","f61f5d8c":"markdown","ad85e2da":"markdown","a9201223":"markdown","d0531933":"markdown","d49f6502":"markdown","19ce8b55":"markdown","bb0a9b3a":"markdown","346455c8":"markdown","5e0455ce":"markdown","6535f8ab":"markdown","8a172531":"markdown","8d5743b0":"markdown","d3b65ac4":"markdown","2107fdca":"markdown","36e310cb":"markdown","a14112c1":"markdown","19df95c6":"markdown","a87c433e":"markdown","14644ba6":"markdown","f2acb082":"markdown","56dcb0eb":"markdown","0270a94f":"markdown","2702b043":"markdown","ef028c6a":"markdown","02b61d65":"markdown","6b80dd6c":"markdown","6390365a":"markdown","5b78131d":"markdown","280daada":"markdown","7a740032":"markdown","95d877fd":"markdown","f1143112":"markdown","0ff975b6":"markdown","48bb66a9":"markdown","908b311b":"markdown","f93f719d":"markdown","928cbb1b":"markdown","f7f28eb1":"markdown","6caa86bb":"markdown","9e66cefc":"markdown","7ee8ded4":"markdown","29ea0664":"markdown","81fcf6d5":"markdown","58287e61":"markdown","f008412c":"markdown","da71c2bf":"markdown","fc10066c":"markdown","47d3572a":"markdown","1eeba848":"markdown","b92ff69f":"markdown","fbc33f46":"markdown","fbf512ca":"markdown","537d71d7":"markdown","b6da2127":"markdown","c935dfef":"markdown","6bbcaed2":"markdown","e28cfd0b":"markdown","1b76818d":"markdown","890d6de7":"markdown","bdf0e4e4":"markdown","97e70dd7":"markdown","62c863a5":"markdown","d4fa523e":"markdown","eb08e0b8":"markdown","81345320":"markdown","d0f21e06":"markdown","36f20537":"markdown","b25e939a":"markdown","e92b17c1":"markdown","456cfac7":"markdown","a17c4c06":"markdown","34562681":"markdown","626c3573":"markdown","eb364c43":"markdown","a7a7a538":"markdown","c7180897":"markdown","e43c6f77":"markdown","c0542903":"markdown","1fdb3f15":"markdown","4312a826":"markdown","b172ec2c":"markdown"},"source":{"51c3d99f":"%matplotlib inline\nimport pandas as pd\nimport numpy as np\nfrom scipy import stats\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom sklearn.ensemble import RandomForestClassifier, VotingClassifier\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.model_selection import train_test_split, GridSearchCV\nfrom sklearn.feature_selection import RFE\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.ensemble import GradientBoostingClassifier\nfrom sklearn.linear_model import LogisticRegression","c43f778d":"df_agb = pd.read_csv('..\/input\/age_gender_bkts.csv')\ndf_agb.head()","40cd1491":"df_agb.isnull().values.any()","8dcd48ea":"#Convert 100+ into a bin.\ndf_agb['age_bucket'] = df_agb['age_bucket'].apply(lambda x: '100-104' if x == '100+' else x)\n#Define mean_age feature\ndf_agb['mean_age'] = df_agb['age_bucket'].apply(lambda x: (int(x.split('-')[0]) + int(x.split('-')[1]))\/2)\ndf_agb = df_agb.drop('age_bucket', axis=1)\ndf_agb.head()","0f3c0b45":"df_agb['country_destination'].value_counts()","56c842e2":"df_agb['gender'].value_counts()","ff4bb486":"df_agb['gender'] = df_agb['gender'].apply(lambda x: 0 if x == 'male' else 1)\ndf_agb['gender'].value_counts()","fe2441b2":"df_agb['year'].value_counts()","b89eabe2":"df_agb = df_agb.drop('year', axis=1)\ndf_agb.head()","29f75b1c":"df_con = pd.read_csv('..\/input\/countries.csv')\ndf_con","908cc1d6":"df_ses = pd.read_csv('..\/input\/sessions.csv')\ndf_ses.head(15)","e92c0362":"df_ses.shape","8a94d4aa":"df_ses['action'] = df_ses['action'].replace('-unknown-', np.nan)\ndf_ses['action_type'] = df_ses['action_type'].replace('-unknown-', np.nan)\ndf_ses['action_detail'] = df_ses['action_detail'].replace('-unknown-', np.nan)","f44efd6b":"sns.distplot(df_ses[df_ses['secs_elapsed'].notnull()]['secs_elapsed'])","d98a751b":"df_ses['secs_elapsed'].describe()","a7a9cefd":"len(df_ses[df_ses['secs_elapsed'].isnull()])","c11a95e9":"median_secs = df_ses['secs_elapsed'].median()\ndf_ses['secs_elapsed'] = df_ses['secs_elapsed'].fillna(median_secs)","3a668aa6":"df_ses['secs_elapsed'].describe()","671f6dbe":"null_action = df_ses[(df_ses['action_type'].isnull()) | (df_ses['action_detail'].isnull()) | (df_ses['action'].isnull()) ]\nnull_action.head()","09b022ce":"null_action.shape","2283cd69":"len(null_action['action'].drop_duplicates())","e0f8a60b":"df_ses[df_ses['device_type'].isnull()]","35404cab":"df_ses['device_type'] = df_ses['device_type'].replace('-unknown-', np.nan)","01c66a59":"df_ses['device_type'].value_counts()","372ddc5a":"len(df_ses[df_ses['device_type'].isnull()])","dda77168":"df_train = pd.read_csv('..\/input\/train_users_2.csv')\ndf_train.head()","247320e4":"df_train.shape","a616b3e5":"df_train['gender'] = df_train['gender'].replace('-unknown-', np.nan)\ndf_train['first_browser'] = df_train['first_browser'].replace('-unknown-', np.nan)","1a1240a8":"df_train[df_train['first_device_type'].isnull()]","01408358":"df_train[df_train['age'] > 120].head()","38284ab5":"df_train['age'] = df_train['age'].apply(lambda x: np.nan if x > 120 else x)","5427e571":"df_inf = df_train[(df_train['country_destination'] != 'NDF') & (df_train['country_destination'] != 'other') & (df_train['gender'] != 'OTHER') & (df_train['gender'].notnull())]\ndf_inf = df_inf[['id', 'gender', 'country_destination']]\ndf_inf.head()","b81b7e5d":"df_inf['gender'].value_counts()","6b5a4c98":"df_inf['country_destination'].value_counts()","008b92af":"observed = df_inf.pivot_table('id', ['gender'], 'country_destination', aggfunc='count').reset_index()\ndel observed.columns.name\nobserved = observed.set_index('gender')\nobserved","98b34724":"chi2, p, dof, expected = stats.chi2_contingency(observed)","85867202":"chi2","af1021d7":"p","5da697ef":"df_signup = df_train[(df_train['signup_method'] != 'google')][['id', 'signup_method', 'signup_app']]\ndf_signup['device'] = df_signup['signup_app'].apply(lambda x: 'Computer' if x == 'Web' else 'Mobile')\ndf_signup.head()","672c60d6":"df_signup['signup_method'].value_counts()","5cb25354":"df_signup['device'].value_counts()","a85f2aa1":"df_signup = df_signup.pivot_table('id', ['device'], 'signup_method', aggfunc='count')\ndf_signup.index = ['Computer', 'Mobile']\ndf_signup.columns = ['Basic', 'Facebook']\ndf_signup","92a5d5fa":"chi2, p, dof, expected = stats.chi2_contingency(df_signup, correction=False)","391b7b65":"chi2","902b99ed":"p","efcedcdf":"df_signup.loc['Total'] = [ df_signup['Basic'].sum(), df_signup['Facebook'].sum()]\ndf_signup['Total'] = df_signup['Basic'] + df_signup['Facebook']\ndf_signup","e7c056b4":"fb_prop = df_signup.loc['Mobile', 'Facebook']\/df_signup.loc['Total', 'Facebook']\nfb_std = df_signup.loc['Mobile', 'Facebook'] * ((1 - fb_prop) ** 2) + df_signup.loc['Computer', 'Facebook'] * ((0 - fb_prop) ** 2)\nfb_std = np.sqrt(fb_std\/df_signup.loc['Total', 'Facebook'])\n\nfb_prop, fb_std","504ef2f1":"basic_prop = df_signup.loc['Mobile', 'Basic']\/df_signup.loc['Total', 'Basic']\nbasic_std = df_signup.loc['Mobile', 'Basic'] * ((1 - basic_prop) ** 2) + df_signup.loc['Computer', 'Basic'] * ((0 - basic_prop) ** 2)\nbasic_std = np.sqrt(basic_std\/df_signup.loc['Total', 'Basic'])\n\nbasic_prop, basic_std","813ad490":"h0_prop = 0\n\nprop_diff = fb_prop - basic_prop\np_hat = (df_signup.loc['Mobile', 'Basic'] + df_signup.loc['Mobile', 'Facebook'])\/(df_signup.loc['Total', 'Basic'] + df_signup.loc['Total', 'Facebook']) \nvar_diff = p_hat * (1- p_hat) * (1\/df_signup.loc['Total', 'Basic'] + 1\/df_signup.loc['Total', 'Facebook'])\nsigma_diff = np.sqrt(var_diff)\n\nprop_diff, sigma_diff","46c7d852":"z = (prop_diff - h0_prop) \/ sigma_diff\nz","baf6c7e5":"p = (1-stats.norm.cdf(z))*2\np","bf231b0b":"plt.figure(figsize=(20,8))\nsns.barplot(x='mean_age', y='population_in_thousands', hue='gender', data=df_agb, ci=None)","48e41e95":"sns.set_style('whitegrid')\nplt.figure(figsize=(10,7))\npop_stats = df_agb.groupby('country_destination')['population_in_thousands'].sum()\nsns.barplot(x=pop_stats.index, y=pop_stats)","c94f5e10":"sns.set_style('whitegrid')\nplt.figure(figsize=(10,7))\nsns.barplot(x='country_destination', y='distance_km', data=df_con)","9764e9b6":"country_popularity = df_train[(df_train['country_destination'] != 'NDF') & (df_train['country_destination'] != 'other')]['country_destination'].value_counts()","a5437aaf":"country_distance = pd.Series(df_con['distance_km'])\ncountry_distance.index = df_con['country_destination']","e2303b2e":"language_distance = pd.Series(df_con['language_levenshtein_distance'])\nlanguage_distance.index = df_con['country_destination']","18ff2bd1":"country_area = pd.Series(df_con['destination_km2'])\ncountry_area.index = df_con['country_destination']","bf2ca9bd":"df_dp = pd.concat([country_popularity, country_distance, language_distance, country_area], axis=1)\ndf_dp.columns = ['count', 'distance_km', 'language', 'area']\nsns.jointplot(x='count', y='distance_km', data=df_dp)","c3b8e00d":"sns.jointplot(x='count', y='distance_km', data=df_dp.drop('US'))","f173713f":"sns.jointplot(x='count', y='language', data=df_dp)","d8f2b4e2":"sns.jointplot(x='count', y='language', data=df_dp.drop('US'))","2bd7f03a":"sns.jointplot(x='count', y='area', data=df_dp)","f2eef2b2":"sns.jointplot(x='count', y='area', data=df_dp.drop('US'))","b0add700":"sns.distplot(df_ses[df_ses['secs_elapsed'].notnull()]['secs_elapsed'])","1a304093":"sns.distplot(df_ses[(df_ses['secs_elapsed'].notnull()) & (df_ses['secs_elapsed'] < 5000)]['secs_elapsed'])","d9233902":"len(df_ses[df_ses['secs_elapsed'] < 1000])\/len(df_ses[df_ses['secs_elapsed'].notnull()])","9a4edc44":"plt.figure(figsize=(12,7))\nsns.countplot(y='device_type', data=df_ses)","47e202f5":"plt.figure(figsize=(10,5))\ncountry_share = df_train['country_destination'].value_counts() \/ df_train.shape[0] * 100\ncountry_share.plot(kind='bar',color='#FD5C64', rot=0)\nplt.xlabel('Destination Country')\nplt.ylabel('Percentage')\nsns.despine()","681e65ec":"classes = ['NDF','US','other','FR','IT','GB','ES','CA','DE','NL','AU','PT']","d44ea1e6":"def stacked_bar(feature):\n    ctab = pd.crosstab([df_train[feature].fillna('Unknown')], df_train.country_destination, dropna=False).apply(lambda x: x\/x.sum(), axis=1)\n    ctab[classes].plot(kind='bar', stacked=True, colormap='terrain', legend=False)","4fac602b":"sns.countplot(df_train['gender'].fillna('Unknown'))","e57ff7ed":"stacked_bar('gender')","8149d1ff":"sns.distplot(df_train['age'].dropna())","4a20f4a6":"fig, ax = plt.subplots(nrows=1, ncols=1,figsize=(15, 8))\nsns.boxplot(x='country_destination', y='age', data=df_train, palette=\"muted\", ax =ax)\nax.set_ylim([10, 75])","c51e0156":"def set_age_group(x):\n    if x < 40:\n        return 'Young'\n    elif x >=40 and x < 60:\n        return 'Middle'\n    elif x >= 60 and x <= 125:\n        return 'Old'\n    else:\n        return 'Unknown'","0c166c81":"df_train['age_group'] = df_train['age'].apply(set_age_group)","3638b580":"stacked_bar('age_group')","da93986e":"stacked_bar('signup_method')","1f31460c":"stacked_bar('language')","0c79bda8":"stacked_bar('affiliate_channel')","181f2fd7":"plt.figure(figsize=(8,4))\nsns.countplot(df_train['affiliate_channel'])","9ff005b0":"stacked_bar('affiliate_provider')","9d6b4c6c":"plt.figure(figsize=(18,4))\nsns.countplot(df_train['affiliate_provider'])","a06fe1cc":"stacked_bar('first_affiliate_tracked')","7077436f":"stacked_bar('signup_flow')","200082df":"stacked_bar('signup_app')","73051471":"stacked_bar('first_device_type')","65d738ac":"df_train['date_account_created'] = pd.to_datetime(df_train['date_account_created'])","ca39911e":"sns.set_style(\"whitegrid\", {'axes.edgecolor': '0'})\nsns.set_context(\"poster\", font_scale=1.1)\nplt.figure(figsize=(12,6))\n\ndf_train[df_train['country_destination'] != 'NDF']['date_account_created'].value_counts().plot(kind='line', linewidth=1, color='green')\ndf_train[df_train['country_destination'] == 'NDF']['date_account_created'].value_counts().plot(kind='line', linewidth=1, color='red')","c9a5db0c":"df_ses.head(2)","8b87beac":"def session_features(df):\n    df['total_seconds'] = df['id'].apply(lambda x: total_seconds[x] if x in total_seconds else 0)\n    df['average_seconds'] = df['id'].apply(lambda x: average_seconds[x] if x in average_seconds else 0)\n    df['total_sessions'] = df['id'].apply(lambda x: total_sessions[x] if x in total_sessions else 0)\n    df['distinct_sessions'] = df['id'].apply(lambda x: distinct_sessions[x] if x in distinct_sessions else 0)\n    df['num_short_sessions'] = df['id'].apply(lambda x: num_short_sessions[x] if x in num_short_sessions else 0)\n    df['num_long_sessions'] = df['id'].apply(lambda x: num_long_sessions[x] if x in num_long_sessions else 0)\n    df['num_devices'] = df['id'].apply(lambda x: num_devices[x] if x in num_devices else 0)\n    return df","91d9005e":"def browsers(df):\n    df['first_browser'] = df['first_browser'].apply(lambda x: \"Mobile_Safari\" if x == \"Mobile Safari\" else x)\n    major_browsers = ['Chrome', 'Safari', 'Firefox', 'IE', 'Mobile_Safari']\n    df['first_browser'] = df['first_browser'].apply(lambda x: 'Other' if x not in major_browsers else x)\n    return df","eede0954":"def classify_device(x):\n    if x.find('Desktop') != -1:\n        return 'Desktop'\n    elif x.find('Tablet') != -1 or x.find('iPad') != -1:\n        return 'Tablet'\n    elif x.find('Phone') != -1:\n        return 'Phone'\n    else:\n        return 'Unknown'","d9d4c8c1":"def devices(df):\n    df['first_device_type'] = df['first_device_type'].apply(classify_device)\n    return df","4eac14af":"def affiliate_tracked(df):\n    df['first_affiliate_tracked'] = df['first_affiliate_tracked'].fillna('Unknown')\n    df['first_affiliate_tracked'] = df['first_affiliate_tracked'].apply(lambda x: 'Other' if x != 'Unknown' and x != 'untracked' else x)\n    return df","aeab7bfb":"def affiliate_provider(df):\n    df['affiliate_provider'] = df['affiliate_provider'].apply(lambda x: 'rest' if x not in ['direct', 'google', 'other'] else x)\n    return df","3bd96d04":"def affiliate_channel(df):\n    df['affiliate_channel'] = df['affiliate_channel'].apply(lambda x: 'other' if x  not in ['direct', 'content'] else x)\n    return df","06de8b4d":"def languages(df):\n    df['language'] = df['language'].apply(lambda x: 'foreign' if x != 'en' else x)\n    return df","c8985436":"def first_booking(df):\n    df = df.drop('date_first_booking', axis=1)\n    return df","1c0e5abb":"def account_created(df):\n    df = df.drop('date_account_created', axis=1)\n    return df","de5bd44a":"def feature_engineering(df):\n    df = session_features(df)\n    df = df.drop('age', axis=1)\n    df = browsers(df)\n    df =devices(df)\n    df =affiliate_tracked(df)\n    df = affiliate_provider(df)\n    df = affiliate_channel(df)\n    df = languages(df)\n    df['is_3'] = df['signup_flow'].apply(lambda x: 1 if x==3 else 0)\n    df = first_booking(df)\n    df = df.drop('timestamp_first_active', axis=1)\n    df = account_created(df)\n    df = df.set_index('id')\n    df = pd.get_dummies(df, prefix='is')\n    return df","784e415f":"total_seconds = df_ses.groupby('user_id')['secs_elapsed'].sum()","7ef13568":"average_seconds = df_ses.groupby('user_id')['secs_elapsed'].mean()","2ecb854f":"total_sessions = df_ses.groupby('user_id')['action'].count()","d986db8e":"distinct_sessions = df_ses.groupby('user_id')['action'].nunique()","616e805e":"num_short_sessions = df_ses[df_ses['secs_elapsed'] <= 300].groupby('user_id')['action'].count()\nnum_long_sessions = df_ses[df_ses['secs_elapsed'] >= 2000].groupby('user_id')['action'].count()","77a1eb28":"num_devices = df_ses.groupby('user_id')['device_type'].nunique()","a377e51c":"df_train = session_features(df_train)","70e8a858":"df_train = df_train.drop('age', axis=1)","e299896b":"df_train = browsers(df_train)","22fcf94e":"df_train = devices(df_train)","f41333b3":"df_train = affiliate_tracked(df_train)","3293d71c":"df_train = affiliate_provider(df_train)","19fe2470":"df_train = affiliate_channel(df_train)","18bdf9c0":"df_train = languages(df_train)","f39c8976":"df_train['is_3'] = df_train['signup_flow'].apply(lambda x: 1 if x==3 else 0)\ndf_train['gender'] = df_train['gender'].fillna('Unknown')","e66ba269":"df_train = first_booking(df_train)","3274d31a":"df_train = df_train.drop('timestamp_first_active', axis=1)","eb40f3a5":"df_train = account_created(df_train)","037e40b2":"df_train = df_train.set_index('id')","b41947be":"class_dict = {\n    'NDF': 0,\n    'US': 1,\n    'other': 2,\n    'FR': 3,\n    'CA': 4,\n    'GB': 5,\n    'ES': 6,\n    'IT': 7,\n    'PT': 8,\n    'NL': 9,\n    'DE': 10,\n    'AU': 11\n}","d1d534ec":"X, y = df_train.drop('country_destination', axis=1), df_train['country_destination'].apply(lambda x: class_dict[x])","5c233b6b":"X = pd.get_dummies(X, prefix='is')","8de6c306":"train_X, test_X, train_y, test_y = train_test_split(X, y, train_size=0.75, stratify=y)","6545ae13":"#classifiers = [RandomForestClassifier(verbose=1), LogisticRegression(verbose=1), GradientBoostingClassifier(verbose=True)]\n\n#for classifier in classifiers:\n#    classifier.fit(train_X, train_y)\n#    print(\"Score: \" + str(classifier.score(test_X, test_y)))","612a2226":"parameters = {\n    'n_estimators': [100,200],\n    'max_features': ['auto', 'log2'],\n    'max_depth': [3,5]\n}","3d70b2a5":"#clf = GridSearchCV(GradientBoostingClassifier(), parameters, verbose=100)\n#clf.fit(train_X, train_y)","22a0f3e2":"#clf.best_params_","c47b51e1":"df_test = pd.read_csv('..\/input\/test_users.csv')\ndf_test['gender'] = df_test['gender'].replace('-unknown-', 'Unknown')\ndf_test['age_group'] = df_test['age'].apply(set_age_group)\ndf_test.head()","4646dbcd":"#df_test = feature_engineering(df_test)\n#df_test = df_test.drop('is_weibo', axis=1)","c4d9b636":"#df_test.columns","ad56150e":"#X.columns","0ffa343f":"#pred_prob = clf.predict_proba(df_test)","5dbc6ab0":"#pred_prob = pd.DataFrame(pred_prob, index=df_test.index)\n#pred_prob.head()","8b89b325":"#inv_classes = {v: k for k, v in class_dict.items()}\n#inv_classes","629cba5e":"def get_top(s):\n    indexes = [i for i in range(0,12)]\n    lst = list(zip(indexes, s))\n    top_five = sorted(lst, key=lambda x: x[1], reverse=True)[:5]\n    top_five = [inv_classes[i[0]] for i in top_five]\n    return str(top_five)","7fa45469":"#pred_prob['get_top'] = pred_prob.apply(get_top, axis=1)\n#pred_prob.head()","e5514457":"#import ast\n#pred_prob['get_top'] = pred_prob['get_top'].apply(lambda x: ast.literal_eval(x))","107f9fae":"#s = pred_prob.apply(lambda x: pd.Series(x['get_top']),axis=1).stack().reset_index(level=1, drop=True)\n#s.name = 'country'","e0609ac3":"#submission = pred_prob.drop([i for i in range(0,12)] + ['get_top'], axis=1).join(s)\n#submission.head()","7e89ee18":"#submission.to_csv('submission.csv')","8d578d8c":"El p-value que hemos obtenido es menor que nuestro nivel de significaci\u00f3n elegido. Por lo tanto, rechazamos la hip\u00f3tesis nula y aceptamos la hip\u00f3tesis de alteraci\u00f3n negativa. ** Existe una relaci\u00f3n entre la preferencia de pa\u00eds y el sexo del cliente. ** Esta informaci\u00f3n puede ser extremadamente \u00fatil para nosotros cuando realizamos ingenier\u00eda de caracter\u00edsticas en pasos posteriores.\n","02256a8d":"El idioma utilizado es mayoritariamente el ingl\u00e9s. Por lo tanto, tiene sentido apilar a los dem\u00e1s.","2fb6245b":"### Estad\u00edsticas de Pa\u00eds","e83fc695":"> ### Caracter\u00edsticas de la sesi\u00f3n\n\nLa primera caracter\u00edstica que quiero dise\u00f1ar es la cantidad de dispositivos a los que un usuario accede a la aplicaci\u00f3n. ** Mi corazonada es que si el usuario usa muchos dispositivos, implica que viaja muy a menudo y, por lo tanto, es probable que reserve un Airbnb. ** Una hip\u00f3tesis adicional es que si la persona viaja mucho, s \/ probablemente debe ser un viajero de negocios y, por lo tanto, es probable que est\u00e9 dispuesto a reservar Airbnbs dentro de los Estados Unidos.\n\nLa segunda caracter\u00edstica que quiero es el ** n\u00famero total de segundos que el usuario ha gastado en las sesiones de Airbnb. ** Ser\u00e1 interesante ver c\u00f3mo esto se correlaciona con nuestras clases.\n\nLa tercera caracter\u00edstica es ** segundos promedio por sesi\u00f3n. ** Nuevamente, no tengo mucha intuici\u00f3n detr\u00e1s de este paso, pero tengo la sensaci\u00f3n de que esta caracter\u00edstica puede ser \u00fatil.\n\nLa cuarta caracter\u00edstica es ** el n\u00famero total de sesiones. ** Al igual que con los segundos totales, esto podr\u00eda indicar un mayor inter\u00e9s. Adem\u00e1s, tambi\u00e9n construiremos una caracter\u00edstica de ** n\u00famero de tipos de sesi\u00f3n ** para cuantificar a\u00fan m\u00e1s el inter\u00e9s y el compromiso del usuario.\n\nLa \u00faltima caracter\u00edstica que quiero ver es ** n\u00famero de sesiones cortas. ** Estas son sesiones de menos de 300 segundos de duraci\u00f3n. Construiremos un ** n\u00famero de sesiones largas ** al restarlo del n\u00famero total de sesiones.","850ac0a2":"#### Prueba de significancia de dos muestras\n\nAhora hagamos la misma prueba de hip\u00f3tesis utilizando la prueba de significaci\u00f3n de dos muestras para proporciones.","c6b1dd5d":"\u00bfEs m\u00e1s probable que algunos grupos de edad reserven en un destino en particular? Para responder a esta pregunta, usaremos el diagrama de caja y observaremos la distribuci\u00f3n de edades de los viajeros a un pa\u00eds en particular.","d89b9028":"## Ingenier\u00eda de caracter\u00edsticas\n\nAhora, con todas estas visualizaciones e ideas en nuestro haber, procedamos a desarrollar algunas caracter\u00edsticas nuevas que nos ayudar\u00e1n a obtener mejores predicciones cuando finalmente capacitemos nuestro modelo de aprendizaje autom\u00e1tico. Primero, me gustar\u00eda extraer caracter\u00edsticas de nuestro conjunto de datos de sesiones. Adem\u00e1s, dado que no hemos hecho demasiada visualizaci\u00f3n de nuestras sesiones, este ser\u00eda un buen lugar para hacerlo.","f61f5d8c":"### Estadisticas de Pa\u00eds","ad85e2da":"Hay una ** fuerte correlaci\u00f3n negativa de -0.65. ** La gente prefiere abrumadoramente reservar en los Estados Unidos que cualquier otro pa\u00eds del mundo. Podemos atribuir esta preferencia a la distancia. Verifiquemos si esto tambi\u00e9n es v\u00e1lido para los pa\u00edses internacionales.","a9201223":"#### G\u00e9nero","d0531933":"Las siguientes caracter\u00edsticas en el conjunto de datos no tienen valores nulos:\n\n1. date_account_created\n2. timestamp_first_active\n3. signup_method\n4. signup_flow\n5. language\n6. affiliate_channel\n7. affiliate_provider\n8. signup_app\n9. first_device_type\n\nLas siguientes caracter\u00edsticas en el conjunto de datos tienen valores nulos:\n\n1. date_first_booking\n2. gender\n3. age\n4. first_affiliate_tracked\n5. first_browser","d49f6502":"#### Prueba de hip\u00f3tesis\n\nPara la prueba de hip\u00f3tesis, definimos lo siguiente:\n\n* ** Hip\u00f3tesis nula: ** No existe una relaci\u00f3n entre la preferencia del pa\u00eds y el sexo del cliente.\n* ** Hip\u00f3tesis alternativa: ** Existe una relaci\u00f3n entre la preferencia del pa\u00eds y el sexo del cliente.\n\nAsumiremos que nuestro nivel de significaci\u00f3n, $ \\ alpha $ sea 0.05.","19ce8b55":"Como se puede ver arriba, hay 13 tipos de dispositivos que las personas est\u00e1n usando. Tambi\u00e9n hay cierta actividad para la cual no tenemos datos sobre el dispositivo. Veamos cu\u00e1ntas instancias tiene esa cuenta.","bb0a9b3a":"Al igual que con las variables de acci\u00f3n, no descartaremos estos valores, ya que este no es el conjunto de datos al que aplicaremos nuestros algoritmos de aprendizaje autom\u00e1tico. Sin embargo, reemplazaremos las cadenas desconocidas con NaN para darle un significado m\u00e1s sem\u00e1ntico que podr\u00eda ser \u00fatil en nuestro an\u00e1lisis.","346455c8":"Este cuaderno demostr\u00f3 todos los pasos principales que tienen lugar en el an\u00e1lisis de datos de desempe\u00f1o y el modelado predictivo en un problema t\u00edpico de la ciencia de datos. Los datos fueron manipulados y limpiados. Esto fue seguido por algunas estad\u00edsticas inferenciales para deducir las relaciones entre las caracter\u00edsticas. Se realiz\u00f3 una EDA extensa para obtener informaci\u00f3n sobre los datos y se usaron para extraer e dise\u00f1ar nuevas caracter\u00edsticas.\n\nFinalmente, se consideraron varios clasificadores y se seleccion\u00f3 el ** Gradient Boosting Classfier ** y se ajustaron sus par\u00e1metros. Este clasificador se utiliz\u00f3 para predecir el destino de nuestros usuarios de prueba y se cre\u00f3 un archivo de env\u00edo en el formato sugerido por Airbnb.\n\nEl puntaje oficial de Kaggle obtenido fue ** 0,86527. ** Este puntaje puede, por supuesto, mejorarse a trav\u00e9s de un ajuste m\u00e1s hiperparam\u00e9trico y una ingenier\u00eda de funciones m\u00e1s avanzada, pero la mejora es extremadamente m\u00ednima. Por lo tanto voy a concluir este cuaderno aqu\u00ed. \u00a1Gracias!","5e0455ce":"Podemos ver que la mayor\u00eda del n\u00famero de sesiones de m\u00e1s de 1000 segundos disminuye casi exponencialmente. Es justo suponer que la mayor\u00eda de las sesiones duraron menos de 1000 segundos. Para verificar esto, veamos su participaci\u00f3n en el n\u00famero total de sesiones.","6535f8ab":"Los siguientes resultados fueron obtenidos:\n* ** Regresi\u00f3n log\u00edstica ** es el clasificador menos preciso con una precisi\u00f3n registrada inferior al 60%.\n* En promedio, el ** Clasificador de aumento de gradiente ** obtuvo el mejor rendimiento con una precisi\u00f3n cercana al 65%.\n\nPor supuesto, hay otros clasificadores que pueden probarse en este paso, pero me detendr\u00e9 aqu\u00ed y elegir\u00e9 ** el Clasificador de refuerzo de gradiente ** como mi modelo de elecci\u00f3n.","8a172531":"## An\u00e1lisis exploratorio de datos\n\nEn esta secci\u00f3n, intentaremos visualizar y resumir nuestros datos para extraer nuevos conocimientos sobre las caracter\u00edsticas individuales y la relaci\u00f3n que comparten con las otras caracter\u00edsticas. Primero intentemos y visualicemos las estad\u00edsticas de edad y g\u00e9nero de varios pa\u00edses.\n\n","8d5743b0":"### Estad\u00edsticas de usuarios de entrenamiento\n\nEn esta secci\u00f3n, intentaremos obtener informaci\u00f3n sobre nuestro conjunto de datos principal: el conjunto de datos de capacitaci\u00f3n. Estas ideas se aplicar\u00e1n directamente en los pasos posteriores de la ingenier\u00eda de caracter\u00edsticas y el aprendizaje autom\u00e1tico.\n\nEl primer paso es trazar la frecuencia de cada clase.","d3b65ac4":"Los mejores par\u00e1metros obtenidos por Grid Search se pueden ver arriba. Cambiaremos la tasa de aprendizaje a 200 para obtener mejores resultados.","2107fdca":"Hagamos lo mismo con los afiliados.","36e310cb":"Nuestro conjunto de datos ahora est\u00e1 en posici\u00f3n de tener una codificaci\u00f3n activa realizada en \u00e9l. Separemos ahora nuestros datos de X y de y.","a14112c1":"Vamos a soltar las caracter\u00edsticas de first_bookings y timsestamp. Esto se debe a que no agregan ning\u00fan valor cuando finalmente prueban el modelo con el conjunto de pruebas. Todos nuestros usuarios de prueba tienen NaN como primera reserva y la marca de tiempo no tiene importancia.","19df95c6":"El p-value obtenido es m\u00e1s alto que nuestro nivel de significaci\u00f3n elegido. Por lo tanto, no estamos en posici\u00f3n de rechazar la hip\u00f3tesis nula. Se destaca. ** No existe una relaci\u00f3n entre el tipo de dispositivo y el m\u00e9todo de registro. ** Realicemos la misma prueba de hip\u00f3tesis utilizando la Prueba Z y comparemos los resultados y el p-value obtenido.","a87c433e":"Como se puede ver arriba, cerca del ** 60% de los usuarios nunca han reservado un Airbnb. ** Entre los usuarios que lo han hecho, han elegido abrumadoramente ** Estados Unidos como su primer destino. ** Al entrenar nuestro modelo de aprendizaje autom\u00e1tico, Nos interesa separar a los bookers de los no bookers. La clasificaci\u00f3n subsiguiente entre los bookers dar\u00eda una gran precisi\u00f3n, ya que podr\u00edamos usar el desequilibrio de clases a nuestro favor.","14644ba6":"El ** Mac Desktop ** es el dispositivo m\u00e1s popular entre los usuarios de Airbnb, seguido por el ** Windows Desktop. ** Un dato interesante es que ** los productos de Apple son extremadamente populares entre los usuarios de Airbnb. ** El iPhone, el iPad y el Todos los Mac aparecen en la lista de los 5 dispositivos m\u00e1s populares.","f2acb082":"### Sesiones\n","56dcb0eb":"Parece que hay una ** correlaci\u00f3n media negativa de -0.38 ** entre las dos cantidades. Esto sugiere que las personas prefieren los pa\u00edses que hablan ingl\u00e9s. \u00bfPero es ese el caso realmente? Eliminemos una vez m\u00e1s Estados Unidos, el pa\u00eds de origen y recalcularemos nuestro coeficiente de correlaci\u00f3n.","0270a94f":"En nuestra secci\u00f3n de EDA, notamos que las personas con flujo de registro 3 tuvieron un n\u00famero desproporcionado de conversiones. Por lo tanto, definiremos una caracter\u00edstica adicional que identifique a estos usuarios. Tambi\u00e9n revertiremos nuestra fatiga de g\u00e9nero al rellenar los NaN con Desconocido ya que deducimos que esto llevar\u00e1 a una mejora en la predicci\u00f3n.","2702b043":"Este clasificador tiene una precisi\u00f3n de ** aproximadamente el 65% **. Intentemos y mejoremos esto utilizando el ajuste de hiperpar\u00e1metro usando la validaci\u00f3n cruzada de b\u00fasqueda de cuadr\u00edcula. Afortunadamente, como siempre, scikit-learn tiene las herramientas disponibles para nosotros que reducen la cantidad de c\u00f3digo al m\u00ednimo.","ef028c6a":"Parece que casi todas las sesiones duraron menos de 5000 segundos. Echemos un vistazo m\u00e1s profundo en estas sesiones.","02b61d65":"### Ajuste del hiperpar\u00e1metro usando Grid Search Cross Validation","6b80dd6c":"El resultado de esta visualizaci\u00f3n es extremadamente interesante.\n\n* Vemos que cuando se elimina a Estados Unidos de la lista de pa\u00edses, en realidad existe ** una correlaci\u00f3n positiva ** entre la distancia de idioma y la frecuencia de reserva.\n* A primera vista, esto puede sugerir que las personas prefieren pa\u00edses con diferentes idiomas (y, por lo tanto, cultura) cuando viajan al extranjero.\n* Otra forma de verlo ser\u00eda que ** Europa es un destino de viaje muy popular para los estadounidenses ** y tienden a preferirlo a otros pa\u00edses de habla inglesa como Canad\u00e1 y Australia. Entonces, esto puede no tener nada que ver con la diferencia de idioma, ya que puede tener que ver con la preferencia de destino.\n\nFinalmente, en esta secci\u00f3n, verifiquemos si el tama\u00f1o del pa\u00eds tiene algo que ver con la preferencia de reserva. Al igual que en los dos casos anteriores, tenemos datos sobre el tama\u00f1o de cada pa\u00eds.","6390365a":"Since we already have our age groups, we can drop the age feature.","5b78131d":"** Casi el 47% de todas las sesiones duraron menos de 1000 segundos. ** Esto sugiere fuertemente una distribuci\u00f3n exponencial decreciente de los segundos transcurridos en cada sesi\u00f3n. En otras palabras, a medida que aumenta la cantidad de segundos, la cantidad de instancias de sesiones que requieren ese tiempo disminuye exponencialmente.\n\nFinalmente, en esta secci\u00f3n, construiremos un diagrama de barras de todos los dispositivos utilizados por varios usuarios para interactuar con el sitio web y la aplicaci\u00f3n de Airbnb.","280daada":"Como hay demasiados navegadores, lo ignoraremos por el momento e intentaremos reducir las categor\u00edas en un paso posterior. Por ahora, podemos hacer las siguientes observaciones sobre los dispositivos de usuario:\n* Los usuarios que usan la aplicaci\u00f3n web ** tienen m\u00e1s probabilidades de reservar un Airbnb, mientras que ** los usuarios de Android ** tienen menos probabilidades de hacerlo.\n* ** Las personas con un tel\u00e9fono Android o cuyos dispositivos eran desconocidos ** compraron menos Airbnbs. La gente en computadoras de escritorio (Mac o de otro tipo) compr\u00f3 m\u00e1s.\n\nEsto sugiere fuertemente que los usuarios en su escritorio tendr\u00e1n m\u00e1s probabilidades de reservar un Airbnb y los Usuarios de Apple son m\u00e1s propensos a comprar en el sitio web, mientras que los Usuarios de Android son los menos.","7a740032":"#### M\u00e9todo de registro\n\nEn una secci\u00f3n anterior, ya establecimos que ** basic ** y ** Facebook ** eran los m\u00e9todos de registro m\u00e1s populares. ** Google ** rara vez se usaba.","95d877fd":"Vemos que las personas que hablan ** h\u00fangaro ** y ** indonesio ** casi no hacen reservas. Las personas que hablaron ** finland\u00e9s ** hicieron la mayor\u00eda de las reservas entre todos los idiomas. Sin embargo, dado que los usuarios son estadounidenses, podemos asumir con seguridad que los usuarios que no son ingleses constituyen una minoria.","f1143112":"Definimos una nueva caracter\u00edstica ** age_group ** para agrupar a nuestros usuarios en 4 grupos de edad:\n* Las personas menores de 40 a\u00f1os son etiquetadas como j\u00f3venes.\n* Las personas con edades comprendidas entre 40 y 60 a\u00f1os son etiquetadas como de mediana edad.\n* Las personas mayores de 60 a\u00f1os son etiquetadas como viejas.\n* Las personas con edades desconocidas son etiquetadas como desconocidas.\n\nDescubrimos que las personas que no han revelado su edad ** tienen menos probabilidades de reservar un Airbnb. ** De los usuarios cuya edad conocemos, ** las personas de mediana edad tienen m\u00e1s probabilidades de reservar un Airbnb. ** Aunque debe ser se\u00f1al\u00f3 que no hay una diferencia muy significativa entre los tres grupos.","0ff975b6":"#### Fechas","48bb66a9":"Notamos que hay muestras para las cuales la edad es mucho mayor que 120 (la persona mayor tiene actualmente 114 a\u00f1os). Se trata de datos claramente contaminados y deben ser eliminados. Reemplazemos estos valores con NaN para indicar que no conocemos la edad real de estas personas.","908b311b":"Reemplazaremos los valores desconocidos con NaN para darle alg\u00fan significado sem\u00e1ntico esto dara lugar a mejores predicciones.","f93f719d":"# **Airbnb**\n\nAirbnb es un mercado en l\u00ednea y servicio de hospitalidad, que permite a las personas arrendar o alquilar alojamiento a corto plazo. Para que Airbnb brinde una experiencia personalizada a sus clientes, busca explorar la posibilidad de predecir el pa\u00eds de destino en el que un usuario realizar\u00e1 una reserva. Con esta informaci\u00f3n, Airbnb puede crear contenido m\u00e1s personalizado con su comunidad, disminuir el tiempo promedio para la primera reserva y mejorar la previsi\u00f3n de la demanda. Estos objetivos proporcionan beneficios mutuos para Airbnb y sus clientes: las recomendaciones personales pueden mejorar el compromiso de los clientes con la plataforma, lo que fomenta las reservas repetidas y las referencias a Airbnb para aquellos los amigos cercanos y familiares. En este ejercicio tenemos los datos de los clientes de Airbnb y se busca predecir el primer destino de reserva para los nuevos clientes de Airbnb que viajan desde los Estados Unidos. La variable de respuesta es el destino donde se realiza la reserva.\n\n# Predicci\u00f3n de destinos de Airbnb\n\n\nEste notebook demuestra todo el proceso de construcci\u00f3n de un modelo predictivo para sugerir el primer destino de los nuevos usuarios de Airbnb. Todos los procesos involucrados, tales como la ordenaci\u00f3n de datos, el an\u00e1lisis exploratorio de datos, las estad\u00edsticas inferenciales y el aprendizaje autom\u00e1tico, se han dividido en secciones principales.\n\n**CONJUNTO DE DATOS**\n\nPara este ejercicio se contara con el siguiente conjuntos de datos:\n\nUna lista de usuarios junto con sus datos demogr\u00e1ficos. Registros de sesiones web y algunas estad\u00edsticas de resumen. Debemos predecir en qu\u00e9 pa\u00eds ser\u00e1 el primer destino de la reserva de un nuevo usuario. Todos los usuarios en el conjunto de datos son de los Estados Unidos.\n\nHay 12 resultados posibles del pa\u00eds de destino: ' US ',' FR ',' CA ',' GB ',' ES ',' IT ',' PT ',' NL ',' DE ',' AU ', 'NDF' (no se encontr\u00f3 destino), y 'otro'. 'otro' significa que hubo una reserva, pero es para un pa\u00eds que no est\u00e1 incluido en la lista, mientras que 'NDF' significa que no hab\u00eda una reserva.\n\nLos conjuntos de entrenamiento y prueba est\u00e1n divididos por fechas. El conjunto de pruebas contiene nuevos usuarios con primeras actividades despu\u00e9s del 07\/01\/2014. En el conjunto de datos de las sesiones, los datos solo se remontan al 01\/01\/2014, mientras que el conjunto de datos de los usuarios se remonta a 2010.","928cbb1b":"Primero, revisemos la variable secs_elapsed.","f7f28eb1":"El gr\u00e1fico de barras apiladas del flujo de inscripci\u00f3n genera observaciones muy interesantes: ** las personas con flujo de registro 3 ** tienen m\u00e1s probabilidades de reservar un Airbnb. Por el contrario, las personas con flujos de registro ** 4 y 5 tienen menos probabilidades de convertirse. **","6caa86bb":"Como tal, no necesitamos realizar ninguna limpieza para este conjunto de datos. Las estad\u00edsticas que se proporcionan aqu\u00ed deber\u00e1n incorporarse a nuestros conjuntos de datos de capacitaci\u00f3n y pruebas antes de capacitar a nuestro modelo y\/o se tendr\u00e1n que utilizar en el an\u00e1lisis de datos exploratorios para obtener informaci\u00f3n adicional.","9e66cefc":"Finalmente, eliminaremos la funci\u00f3n de cuentas creadas, ya que nuestros conjuntos de entrenamiento y prueba se separaron a mediados de 2014. Como resultado, todos los usuarios de prueba se registraron solo en 2014.","7ee8ded4":"#### Edad\n\nEstudiemos ahora las edades de los usuarios y tratemos de obtener informaci\u00f3n sobre ello. Como vimos en una secci\u00f3n anterior, no tenemos los datos de edad de una parte considerable de los usuarios. Intentemos trazar la distribuci\u00f3n de los que hacemos.","29ea0664":"La correlaci\u00f3n, con Estados Unidos fuera de la ecuaci\u00f3n, ** es mucho menor en -0.18. ** Sin embargo, todav\u00eda hay una correlaci\u00f3n negativa entre las dos cantidades.\n\nA continuaci\u00f3n, verifiquemos si el idioma que se habla en un pa\u00eds en particular influye en el n\u00famero de reservas en ese pa\u00eds. Para calcular esta m\u00e9trica, utilizaremos el ** Idioma Levenshtein Distance ** del idioma oficial de cada pa\u00eds desde el ingl\u00e9s. Estos datos ya est\u00e1n disponibles para nosotros por Airbnb. Una vez m\u00e1s, al igual que la distancia f\u00edsica, mi conjetura es que a menor distancia de levenshtein, mayor es el n\u00famero de reservas en ese pa\u00eds.","81fcf6d5":"#### Flujo de Inscripci\u00f3n","58287e61":"Solo hay un valor disponible para la caracter\u00edstica del a\u00f1o. Por lo tanto, no tiene sentido mantener esta funci\u00f3n, ya que no agrega ninguna informaci\u00f3n sobre los datos disponibles para nosotros. Dejaremos caer esta caracter\u00edstica.","f008412c":"Como se puede ver anteriormente, la interpolaci\u00f3n no ha alterado significativamente las estad\u00edsticas de resumen de la distribuci\u00f3n. Esta es una buena opci\u00f3n para completar los valores nulos por el momento.","da71c2bf":"Hay m\u00e1s de 2,23 millones de campos que tienen informaci\u00f3n incompleta sobre la acci\u00f3n, el tipo de acci\u00f3n o el detalle de la acci\u00f3n. Esto es aproximadamente el 20% de los datos que poseemos. Adem\u00e1s, hay 270 tipos de acciones para las cuales tenemos valores nulos, por lo que examinarlos uno por uno simplemente no es posible de forma manual.\n\nDado que este no es nuestro conjunto de datos de entrenamiento, no descartaremos los valores. Lo mantendremos porque es posible extraer informaci\u00f3n incluso de filas que tienen columnas nulas.","fc10066c":"### Preferencias de registro\n\n\nEn esta secci\u00f3n, trataremos de descubrir una relaci\u00f3n entre el m\u00e9todo de registro y el dispositivo de registro. Una consulta preliminar de nuestro marco de datos nos dice que la mayor\u00eda de los usuarios se registran a trav\u00e9s del m\u00e9todo b\u00e1sico est\u00e1ndar o de Facebook. Adem\u00e1s, inician sesi\u00f3n utilizando un navegador de escritorio, un navegador m\u00f3vil o una aplicaci\u00f3n m\u00f3vil.\n\n\u00bfEl tipo de dispositivo (m\u00f3vil o computadora) afecta el m\u00e9todo de registro en Airbnb? Intentaremos responder a esta pregunta aqu\u00ed. Una vez m\u00e1s, como antes, haremos ciertas suposiciones.\n* Ignoraremos el m\u00e9todo de registro de Google ya que hay muy pocas instancias de \u00e9l.\n* Consideraremos que iOs, Moweb y Android son del tipo de dispositivo m\u00f3vil.","47d3572a":"El g\u00e9nero tambi\u00e9n se puede convertir en una variable binaria categ\u00f3rica. Representemos ** hombres con 0 y mujeres con 1. ** De nuevo, hacemos esto en caso de que necesitemos que esta variable funcione como una cantidad num\u00e9rica. Debe indicarse que no hay una necesidad inmediata de ello y, por lo tanto, se puede omitir.","1eeba848":"### Usuarios de Entrenamiento\n\nAhora exploremos el conjunto de datos de entrenamiento que consiste en nuestros usuarios para quienes necesitamos predecir el primer destino.","b92ff69f":"El n\u00famero de pa\u00edses es extremadamente peque\u00f1o. Probablemente corresponda a las clases por pa\u00eds disponibles en el conjunto de datos de capacitaci\u00f3n que cubriremos m\u00e1s adelante en esta secci\u00f3n.","fbc33f46":"Algunas observaciones de las visualizaciones anteriores:\n* El ** Canal Directo ** tiene la mayor cantidad de conversiones a las reservas, mientras que el ** Canal de Contenido ** tiene la menor cantidad.\n* ** Direct ** y ** Google ** son los proveedores afiliados m\u00e1s populares.\n* ** Wayn ** tiene el menor porcentaje de conversiones mientras que ** Daum ** tiene el mayor porcentaje. Sin embargo, debemos tomar esto con una pizca de sal, ya que puede ser que el n\u00famero de puntos de muestra de estas categor\u00edas sea extremadamente peque\u00f1o (como lo sugiere la gr\u00e1fica de conteo).\n* Aparte de lo anterior, ** Google ** y ** Craigslist ** tienen un buen porcentaje de conversiones.\n* Las personas con ** Marketing ** afiliados eran m\u00e1s propensas a reservar. Las personas cuyo primer afiliado fue registrado como ** Operaciones locales ** o ** Desconocido ** fueron las menos probables.","fbf512ca":"El primer paso es cargar todos los datos disponibles para nosotros en un Pandas Dataframe y extraer informaci\u00f3n b\u00e1sica como el n\u00famero de muestras, el n\u00famero de filas de valores nulos, el n\u00famero de funciones, etc. \nEl siguiente paso ser\u00eda tratar los valores faltantes usando un m\u00e9todo adecuado (eliminaci\u00f3n, interpolaci\u00f3n, etc.) y convertir ciertas caracter\u00edsticas en una forma m\u00e1s adecuada para aplicar estad\u00edsticas inferenciales y machine learning algorithms.","537d71d7":"** Los Estados Unidos de Am\u00e9rica ** son claramente la naci\u00f3n m\u00e1s poblada entre los pa\u00edses de destino con una poblaci\u00f3n de m\u00e1s de ** 300 millones **. Todos los dem\u00e1s pa\u00edses de la lista tienen una poblaci\u00f3n ** inferior a 100 millones. **\n\nA continuaci\u00f3n, vamos a crear un gr\u00e1fico de barras de la distancia del pa\u00eds desde el pa\u00eds de origen (Estados Unidos de Am\u00e9rica). Luego, construiremos un diagrama de dispersi\u00f3n entre la frecuencia de reserva en un pa\u00eds y la distancia del pa\u00eds. Mi intuici\u00f3n inicial es que cuanto m\u00e1s lejos est\u00e9 un pa\u00eds, menos probabilidades habr\u00e1 de que la gente visite ese pa\u00eds en particular. Debe haber al menos una peque\u00f1a correlaci\u00f3n megativa entre estas dos cantidades.","b6da2127":"Revisemos primero las tendencias acerca de cu\u00e1ndo se crearon las primeras cuentas.","c935dfef":"Hay m\u00e1s de 50 categor\u00edas de navegadores, aunque la mayor\u00eda utiliza solo 5. Por lo tanto, agruparemos todos los exploradores menores en la categor\u00eda 'Otros'.\n\nLuego, de nuestra visualizaci\u00f3n anterior, vimos que los usuarios de computadoras de escritorio ten\u00edan m\u00e1s probabilidades de reservar Airbnbs, seguidos por los usuarios de Tabletas, usuarios de tel\u00e9fonos y finalmente personas cuyos dispositivos eran desconocidos. Vamos a reducir first_device_type en estas categor\u00edas.","6bbcaed2":"### Estad\u00edstica de edad, g\u00e9nero y poblaci\u00f3n\n","e28cfd0b":"### Estad\u00edsticas de Sesi\u00f3n\n\nEn esta secci\u00f3n, trataremos de visualizar algunas de las estad\u00edsticas de sesi\u00f3n que se nos dieron. Primero, como ya lo hemos hecho antes, representemos la distribuci\u00f3n de la cantidad de tiempo que los usuarios dedicaron a cada sesi\u00f3n.\n","1b76818d":"#### Prueba de hip\u00f3tesis\n\nVamos a configurar ahora nuestra prueba de hip\u00f3tesis. Definiremos lo siguiente:\n\n* ** Hip\u00f3tesis nula: ** No existe una relaci\u00f3n entre el tipo de dispositivo y el m\u00e9todo de registro.\n* ** Hip\u00f3tesis alternativa: ** Existe una relaci\u00f3n entre el tipo de dispositivo y el m\u00e9todo de registro.\n\nSuponga que el nivel de significaci\u00f3n $ \\ alpha $ est\u00e1 en 0.05.\n\nRealizaremos la misma prueba de hip\u00f3tesis utilizando dos herramientas estad\u00edsticas diferentes: la prueba de significaci\u00f3n de Chi cuadrado y la prueba de estad\u00edstica Z. Si se realiza correctamente, ambas pruebas deben darnos los mismos resultados.","890d6de7":"## Preprocesamiento de Datos\nEn este paso vamos a limpiar los datos. \nTodo el Preprocesamiento de datos se realizar\u00e1 utilizando la biblioteca de Python Pandas.\n","bdf0e4e4":"#### La visualizaci\u00f3n de barras apiladas\n\nEl gr\u00e1fico de barras apiladas ser\u00e1 la principal herramienta de visualizaci\u00f3n en la EDA. La idea se tom\u00f3 de la excelente libreta de notas de kevinwu06 sobre el an\u00e1lisis exploratorio de Airbnb.\n\nEl gr\u00e1fico de barras apiladas nos proporciona una colecci\u00f3n de barras de colores proporcionales donde cada color representa una clase (o el destino). Como hay m\u00e1s de 10 clases, eleg\u00ed renunciar a la leyenda. Los colores que nos interesan son ** azul oscuro (barra inferior) que corresponde a la clase NDF ** y ** azul (segunda barra inferior) que corresponde a la clase US **. Como ya hemos visto, estas dos clases forman la mayor\u00eda y, por lo tanto, ocupar\u00e1n la mayor parte del \u00e1rea de cada barra. Cada barra ha sido normalizada con respecto a su tama\u00f1o.\n\nLo que intentaremos deducir es la proporci\u00f3n de la barra que pertenece a la clase de no reserva (azul oscuro). Si es grande, significa que es poco probable que un segmento en particular reserve un Airbnb. Si son peque\u00f1os, significa que est\u00e1n m\u00e1s inclinados a hacerlo.","97e70dd7":"#### Prueba Chi Cuadrado","62c863a5":"#### Tipo de dispositivo, navegador y aplicaci\u00f3n utilizados","d4fa523e":"El p-value obtenido es m\u00e1s alto que nuestro nivel de significancia elegido. Por lo tanto, no estamos en posici\u00f3n de rechazar la hip\u00f3tesis nula. Se destaca. ** No existe una relaci\u00f3n entre el tipo de dispositivo y el m\u00e9todo de registro. **\n\nTambi\u00e9n tenga en cuenta que los p-value obtenidos para la Prueba de Significaci\u00f3n de Dos Muestras y la Prueba de Significaci\u00f3n de Chi Cuadrado (sin correcci\u00f3n) son ** exactamente iguales. ** Ahora estamos en condiciones de resumir y presentar nuestros resultados en funci\u00f3n del an\u00e1lisis estad\u00edstico realizado.\n\n### Conclusiones\n\n* Hay ** una relaci\u00f3n ** entre g\u00e9nero y Airbnb Country Destination. En otras palabras, el g\u00e9nero influye en el pa\u00eds de su elecci\u00f3n.\n* No hay ** relaci\u00f3n ** entre el tipo de dispositivo y el m\u00e9todo de registro. Las dos variables son independientes entre s\u00ed.\n* Los resultados obtenidos de la Prueba de Significaci\u00f3n de Chi Cuadrado y la Prueba de Significaci\u00f3n de Dos Muestras son ** exactamente los mismos **.","eb08e0b8":"Los resultados con el \u00e1rea se asemejan mucho a lo que hemos obtenido de nuestras pruebas de distancia de idioma. En general, existe una correlaci\u00f3n positiva entre el tama\u00f1o del pa\u00eds y la preferencia de reserva. Esto se debe principalmente a que Estados Unidos es un pa\u00eds grande (el segundo m\u00e1s grande en esta lista).\n\nSin embargo, cuando se eliminan los EE. UU., Los datos ** muestran una correlaci\u00f3n negativa. ** Nuevamente, como en el caso del idioma, esto puede no tener nada que ver con el tama\u00f1o del pa\u00eds sino con la preferencia de destino. Los pa\u00edses europeos son generalmente peque\u00f1os en tama\u00f1o pero extremadamente populares entre los turistas estadounidenses.","81345320":"El n\u00famero de usuarios que no reservan ha aumentado m\u00e1s que el n\u00famero de usuarios que reservan a medida que pasa el tiempo. Esto se puede atribuir al hecho de que m\u00e1s personas est\u00e1n utilizando la plataforma solo para la exploraci\u00f3n. Otra raz\u00f3n podr\u00eda ser que dado que el usuario estuvo en la plataforma por un tiempo m\u00e1s prolongado, era m\u00e1s probable que \u00e9l \/ ella siguiera adelante y reservara un espacio. Esto implica directamente que ** cuanto antes el usuario hab\u00eda creado una cuenta en Airbnb, era m\u00e1s probable que hiciera una reserva. **\n\nCon todo esto en mente, no podemos continuar con el Paso de ingenier\u00eda de caracter\u00edsticas. Las caracter\u00edsticas que a\u00fan no hemos explorado en esta secci\u00f3n se explorar\u00e1n en la siguiente.","d0f21e06":"Desde la gr\u00e1fica de boxplot, encontramos que la distribuci\u00f3n es m\u00e1s o menos la misma para cada pa\u00eds. ** Gran Breta\u00f1a ** tiene la edad media m\u00e1s alta de los viajeros y ** Espa\u00f1a ** es m\u00e1s popular entre los viajeros m\u00e1s j\u00f3venes.","36f20537":"## Recomendaciones de negocios\n\nEn funci\u00f3n del an\u00e1lisis exploratorio de datos y el modelado predictivo realizados, podemos hacer las siguientes sugerencias a nuestro cliente (Airbnb):\n\n* La mayor\u00eda de los usuarios de Airbnb est\u00e1n en dispositivos Apple. Adem\u00e1s, los usuarios de Android son la minor\u00eda y no reservan tan a menudo. ** Es l\u00f3gico para los negocios invertir m\u00e1s recursos en mejorar la experiencia de usuario de las aplicaciones iOS. ** Por otro lado, Airbnb tambi\u00e9n podr\u00eda investigar el menor \u00edndice de conversi\u00f3n de los usuarios de Android e intentar deducir cierta correlaci\u00f3n con ciertas peculiaridades del Aplicaci\u00f3n de Android Airbnb.\n* Los usuarios de escritorio reservan con mucha m\u00e1s frecuencia que otros usuarios de dispositivos. ** Esto podr\u00eda significar que la gente use dispositivos m\u00e1s peque\u00f1os para navegar y explorar, y escritorios para hacer la reserva real. ** La experiencia del usuario para las aplicaciones en diferentes dispositivos debe ajustarse en consecuencia para lograr los mejores resultados.\n* La mayor\u00eda de los usuarios de Airbnb tienden a reservar un Airbnb dentro del pa\u00eds. ** Por lo tanto, tiene m\u00e1s sentido ofrecer a los usuarios m\u00e1s recomendaciones que sean end\u00e9micas del pa\u00eds. ** Los usuarios estadounidenses deben obtener m\u00e1s recomendaciones de Experiencia y Hospedaje dentro de los EE. UU. Este no es el caso con el sitio actual de Airbnb, donde la mayor\u00eda de las recomendaciones son lugares ex\u00f3ticos en lugares lejanos.\n* Las personas que no han completado su informaci\u00f3n, como Edad y G\u00e9nero, tienen menos probabilidades de reservar Airbnbs. Esto probablemente se deba al hecho de que solo se encuentran en la etapa de exploraci\u00f3n. ** El m\u00e1ximo esfuerzo de marketing debe estar dirigido a estas personas y se les debe hacer las ofertas m\u00e1s atractivas pero asequibles para aumentar su tasa de conversi\u00f3n. **","b25e939a":"### Pruebas y env\u00edo final\n\nAhora que tenemos un clasificador que ha sido optimizado para obtener mejores resultados, podemos proceder a hacer predicciones para nuestros usuarios de prueba y crear el archivo de env\u00edo final.","e92b17c1":"Descubrimos que las personas que usan el m\u00e9todo de registro ** b\u00e1sico ** tienen m\u00e1s probabilidades de reservar un Airbnb, mientras que las personas que usan ** google ** tienen menos probabilidades de hacer una reserva.","456cfac7":"Como se puede ver arriba, cerca del ** 60% de los usuarios nunca han reservado un Airbnb. ** Entre los usuarios que lo han hecho, han elegido abrumadoramente ** Estados Unidos como su primer destino. ** Al entrenar nuestro modelo de aprendizaje autom\u00e1tico, Nos interesa separar a los bookers de los no bookers. La clasificaci\u00f3n subsiguiente entre los bookers dar\u00eda una gran precisi\u00f3n, ya que podr\u00edamos usar el desequilibrio de clases a nuestro favor.","a17c4c06":"En esta secci\u00f3n, aplicaremos herramientas estad\u00edsticas para obtener algunas inferencias e ideas sobre el tipo de datos con los que estamos tratando y c\u00f3mo eliminar las relaciones entre varias caracter\u00edsticas de nuestro conjunto de datos.\n\nPara comenzar, verifiquemos si hay una preferencia basada en el g\u00e9nero para ciertos pa\u00edses. En otras palabras, \u00bfel g\u00e9nero de una persona afecta al primer pa\u00eds en el que reserva un Airbnb? Para responder a esta pregunta tendremos que probar la relaci\u00f3n entre dos variables categ\u00f3ricas: G\u00e9nero y Pa\u00eds de destino. Dado que el n\u00famero de pa\u00edses de destino es multivariado, la ** Prueba de Significaci\u00f3n  de Chi Cuadrada**.\n\nAntes de comenzar, haremos ciertas suposiciones:\n* Consideraremos solo a aquellos usuarios que hayan reclutado su g\u00e9nero como hombres o mujeres. Desconocidos y otros g\u00e9neros no se incluyen en este an\u00e1lisis.\n\n* No consideramos a los usuarios que nunca han reservado un Airbnb o que han reservado en un pa\u00eds que no est\u00e1 inscrito como clase (NDF y Otro).","34562681":"Vemos que los usuarios cuyo g\u00e9nero es desconocido forman la mayor\u00eda. De los usuarios cuyo sexo se conoce, ** hay m\u00e1s mujeres que hombres. ** Esto puede sugerir dos cosas:\n1. Hay m\u00e1s usuarios femeninos de Airbnb que hombres\n2. Las mujeres tienen m\u00e1s probabilidades de revelar su g\u00e9nero que los hombres.\n\nUn punto muy interesante a destacar es que ** las personas que no han marcado su g\u00e9nero tienen menos probabilidades de reservar un Airbnb. ** Adem\u00e1s, las personas que se han marcado a s\u00ed mismas como ** 'otras' son m\u00e1s probables ** que cualquier otro grupo para hacer una reserva. Esto podr\u00eda no ser una idea muy potente ya que el otro grupo es una proporci\u00f3n insignificante de la poblaci\u00f3n.","626c3573":"## Conclusi\u00f3n","eb364c43":"#### Canales de afiliados y proveedores","a7a7a538":"#### Idioma","c7180897":"## Aprendizaje autom\u00e1tico\n\n\nEl siguiente paso es construir un clasificador para entrenar nuestros datos y luego probar su rendimiento con los datos de prueba. Con toda la ingenier\u00eda de caracter\u00edsticas ya realizada en el paso anterior, la aplicaci\u00f3n del aprendizaje autom\u00e1tico debe ser bastante concisa.\n\n### Selecci\u00f3n de modelo\n\nSin embargo, debemos crear un clasificador que tenga el mejor rendimiento, dadas las caracter\u00edsticas. En tales competiciones, Ensemble Methods dan los mejores resultados. Entrenaremos a nuestro modelo utilizando tres clasificadores: ** Incremento de gradiente **, ** Regresi\u00f3n log\u00edstica ** y ** Bosque aleatorio ** y elegiremos el que tenga la mejor precisi\u00f3n.","e43c6f77":"El n\u00famero promedio de segundos por sesi\u00f3n es ** 19450 segundos ** mientras que el valor de la mediana es ** 1147 segundos **. Esto sugiere un conjunto de datos muy sesgado con algunas observaciones at\u00edpicas que influyen en la media de la distribuci\u00f3n.","c0542903":"Este Dataset no tiene valores nulos entre sus caracter\u00edsticas.\n\nComo primer paso, tratemos el dato de la edad. Las edades se indican en bloques de tama\u00f1o 5. Convertiremos esto en un valor num\u00e9rico para que podamos aumentar su versatilidad si fuera necesario (es decir, se puede usar tanto como una caracter\u00edstica categ\u00f3rica como continua). Como el tama\u00f1o del bloque es razonablemente peque\u00f1o, podemos definir una nueva funci\u00f3n, **mean_age** que puede representar edades sin demasiada p\u00e9rdida de informaci\u00f3n. El campo **mean_age** ser\u00e1 el promedio del rango superior e inferior para ese bloque en particular.","1fdb3f15":"Hay m\u00e1s de 136,000 campos para los cuales no sabemos el valor. Necesitamos descartar o interpolar estos valores. Por el momento, llenemos los valores no disponibles con la mediana de la distribuci\u00f3n. Utilizamos la mediana ya que, como se mencion\u00f3 anteriormente, esta distribuci\u00f3n est\u00e1 fuertemente influenciada por valores at\u00edpicos.","4312a826":"**#### Observaciones\n\n* Los pa\u00edses que est\u00e1n representados en esta estad\u00edstica consisten en gran parte de un ** envejecimiento de la poblaci\u00f3n **. Los grupos m\u00e1s grandes son personas con ** edad media de 47 a\u00f1os y 52 a\u00f1os **.\n* La distribuci\u00f3n se asemeja a una curva de campana sesgada. Las personas de mediana edad ocupan la mayor parte de la poblaci\u00f3n, seguidas de cerca por los j\u00f3venes y, finalmente, por los ancianos.\n* Los conteos poblacionales de personas j\u00f3venes y de mediana edad son bastante comparables. Pero a medida que hacemos la transici\u00f3n hacia la vejez (edad> 57 a\u00f1os), el conteo de la poblaci\u00f3n para cada grupo sucesivo disminuye constantemente.\n* Una cosa muy interesante a tener en cuenta (aunque puede no ser relevante para nuestro an\u00e1lisis) es que la proporci\u00f3n de sexos se inclina hacia los hombres para los grupos de edad m\u00e1s j\u00f3venes, pero a medida que aumenta la edad media, la proporci\u00f3n se inclina m\u00e1s hacia las mujeres. ** Las mujeres de hecho viven m\u00e1s que los hombres. **\n\nA continuaci\u00f3n, tratemos de graficar el conteo de la poblaci\u00f3n en cada pa\u00eds.","b172ec2c":"## Estad\u00edstica inferencial\n\n### Preferencia de g\u00e9nero para las reservaciones de Airbnb\n"}}