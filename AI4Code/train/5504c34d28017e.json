{"cell_type":{"4ee9de16":"code","575bc639":"code","9ed37933":"code","9cd0901f":"code","323d458c":"code","29f997f2":"code","1e04ddab":"code","119d31b8":"code","670afddc":"code","3eda9b90":"code","3c07b5cd":"code","3ca6d116":"code","7026312b":"code","c8d80858":"code","6aed379f":"code","4c56aa83":"code","7417482b":"code","1eba1e3f":"code","f40a2adb":"code","450509cb":"code","59b1f5d7":"code","900b6282":"code","2f9bed01":"code","c13a2da7":"code","9f4bb026":"code","7dd62f0b":"code","a177bf06":"code","a03f6298":"code","0f89bea6":"code","6ced092e":"code","757d7725":"code","2f1ba3e1":"code","70e365a9":"code","9cf9d42f":"code","e910033a":"code","7288f90f":"code","278f2b11":"code","dceb25e2":"code","7a916a5f":"code","90abeb8b":"code","0eb6e903":"code","4090118d":"code","75fbe4cf":"code","0c910753":"code","425f369d":"code","e19ed7f3":"code","c3a104c5":"code","88f091c2":"code","829521a3":"code","cf9b6e36":"code","7094c973":"code","a7c523b6":"code","d32038ac":"code","eb87ca6e":"code","51e8f0d3":"code","c47e3d81":"code","e0ab2d32":"code","6822600e":"code","442c6f3f":"code","decfd04a":"code","5b3234b5":"markdown","ec11a50e":"markdown","1946d9c1":"markdown","ac62519f":"markdown","525d4386":"markdown","c96c4c52":"markdown","6335ed15":"markdown","07e4a47c":"markdown","10cb0ace":"markdown","cc284eb9":"markdown","b966671b":"markdown","963a659e":"markdown","94e1e41e":"markdown","df0a843d":"markdown","ebad3728":"markdown","8a77463b":"markdown","6c564673":"markdown","579a3027":"markdown","781ec1bd":"markdown","bb6f81d1":"markdown","b77c18a6":"markdown","1f0118e9":"markdown","bb72ad95":"markdown","117525bf":"markdown","22e5d809":"markdown","02810941":"markdown","f99d0813":"markdown","d5070897":"markdown","9b65086c":"markdown","f0ef3734":"markdown","b5c4cc13":"markdown","09f45ac9":"markdown","4c8f5368":"markdown","2a6bc55d":"markdown","efcaf2e4":"markdown","321735c4":"markdown","d9b9024b":"markdown","a83f9332":"markdown","9f1c3ca0":"markdown","b27a6d11":"markdown","b57d9449":"markdown","e90667af":"markdown","5359bf5b":"markdown","cb1275a7":"markdown","a2ece642":"markdown"},"source":{"4ee9de16":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","575bc639":"import pandas as pd\nimport numpy as np\n\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\npd.set_option('display.max_columns', 500)\npd.set_option('display.max_colwidth', None)\n\n# For scaling the data\nfrom sklearn.preprocessing import StandardScaler\n\n# To perform K-means clustering\nfrom sklearn.cluster import KMeans\n\n\n#To perform hierarchical clustering\nfrom scipy.cluster.hierarchy import linkage\nfrom scipy.cluster.hierarchy import dendrogram\nfrom scipy.cluster.hierarchy import cut_tree","9ed37933":"data_dict = pd.read_csv('\/kaggle\/input\/unsupervised-learning-on-country-data\/data-dictionary.csv')","9cd0901f":"data_dict","323d458c":"countries = pd.read_csv('\/kaggle\/input\/unsupervised-learning-on-country-data\/Country-data.csv')","29f997f2":"countries.head()","1e04ddab":"countries.shape","119d31b8":"# features = ['exports', 'health', 'imports']\n# for feature in features:\n#     countries[feature] = countries[feature]*countries['gdpp']\/100\ncountries[['exports', 'health', 'imports']]= \\\n                                countries[['exports', 'health', 'imports']].multiply(countries[\"gdpp\"]\/100, axis=\"index\")\n","670afddc":"countries.head()","3eda9b90":"countries.info()","3c07b5cd":"#checking for duplicates\ncountries.duplicated(subset = ['country'], keep = False).sum()","3ca6d116":"# Checking for null values in the column\ncountries.isnull().sum()","7026312b":"countries.describe(percentiles=[.25,.5,.75,.90,.95,.99])","c8d80858":"features = countries.columns\nfeatures","6aed379f":"fig = plt.figure(figsize=(15,25))\nfor plot, feature in enumerate(features[1:]):\n    fig.add_subplot(5,3,plot+1)\n    sns.boxplot(x=countries[feature], data=countries)\n                 ","4c56aa83":"#Caluclating the quantile1 and quantile3 for gdpp and removing the upper outliers\nQ1 = countries.gdpp.quantile(0.05)\nQ3 = countries.gdpp.quantile(0.95)\n\ncountries[(countries.gdpp > Q3)]","7417482b":"countries = countries[(countries.gdpp <= Q3)]","1eba1e3f":"countries.shape","f40a2adb":"countries.head(5)","450509cb":"fig = plt.figure(figsize=(20,35))\nsns.pairplot(countries,diag_kind='kde',corner=True)","59b1f5d7":"plt.figure(figsize = (15,5))\nchild_mort_top10 = countries[['country','child_mort']].sort_values('child_mort', ascending = False).head(10)\nax=sns.barplot(x='country', y='child_mort', data= child_mort_top10)\n\nfor p in ax.patches:\n    ax.annotate(str(p.get_height()), (p.get_x() * 1.05 , p.get_height() * 1.01))\nax.set(xlabel = '', ylabel= 'Child Mortality Rate')\nplt.xticks(rotation=45)","900b6282":"plt.figure(figsize = (15,5))\nhealth = countries[['country','health']].sort_values('health', ascending = True).head(10)\nax = sns.barplot(x='country', y='health', data= health)\nax.set(xlabel = '', ylabel= 'Health')\nplt.xticks(rotation=90)","2f9bed01":"plt.figure(figsize = (15,5))\nincome_lowets_10 = countries[['country','income']].sort_values('income', ascending = True).head(10)\naxes = sns.barplot(x='country', y='income', data= income_lowets_10)\naxes.set(xlabel = '', ylabel= 'Per Capita Income')\nplt.xticks(rotation=90)","c13a2da7":"plt.figure(figsize = (15,5))\nhigh_inflation = countries[['country','inflation']].sort_values('inflation', ascending = False).head(10)\nax = sns.barplot(x='country', y='inflation', data= high_inflation)\nax.set(xlabel = '', ylabel= 'Inflation')\nplt.xticks(rotation=90)\n","9f4bb026":"#Find the Hopkins statistic score\nfrom sklearn.neighbors import NearestNeighbors\nfrom random import sample\nfrom numpy.random import uniform\nimport numpy as np\nfrom math import isnan\n \ndef hopkins(X):\n    d = X.shape[1]\n    #d = len(vars) # columns\n    n = len(X) # rows\n    m = int(0.1 * n) \n    nbrs = NearestNeighbors(n_neighbors=1).fit(X.values)\n \n    rand_X = sample(range(0, n, 1), m)\n \n    ujd = []\n    wjd = []\n    for j in range(0, m):\n        u_dist, _ = nbrs.kneighbors(uniform(np.amin(X,axis=0),np.amax(X,axis=0),d).reshape(1, -1), 2, return_distance=True)\n        ujd.append(u_dist[0][1])\n        w_dist, _ = nbrs.kneighbors(X.iloc[rand_X[j]].values.reshape(1, -1), 2, return_distance=True)\n        wjd.append(w_dist[0][1])\n \n    H = sum(ujd) \/ (sum(ujd) + sum(wjd))\n    if isnan(H):\n        print(ujd, wjd)\n        H = 0\n \n    return H","7dd62f0b":"hopkins(countries.drop('country', axis = 1))","a177bf06":"features = countries.columns\nstandard_scaler = StandardScaler()\ncountries_scaled= standard_scaler.fit_transform(countries.drop('country', axis=1))\ncountries_scaled","a03f6298":"country_norm = pd.DataFrame(countries_scaled)\ncountry_norm.columns = features[1:]\ncountry_norm.head()","0f89bea6":"from sklearn.metrics import silhouette_score\nss = []\nfor k in range(2, 15):\n    kmean = KMeans(n_clusters = k).fit(country_norm)\n    ss.append([k, silhouette_score(country_norm, kmean.labels_)])\ntemp = pd.DataFrame(ss)    \nplt.plot(temp[0], temp[1])","6ced092e":"# sum of squared distances\nssd = []\nfor num_clusters in list(range(1,21)):\n    model_clus = KMeans(n_clusters = num_clusters, max_iter=50)\n    model_clus.fit(country_norm)\n    ssd.append(model_clus.inertia_)\n\n    \nfig, ax = plt.subplots()\nax.plot(range(1,21),ssd, marker = '+',color = 'red' , ls = '--', markeredgecolor = 'blue', markersize = '10')","757d7725":"kmeans_clus4 = KMeans(n_clusters=4, max_iter=50, random_state= 50)\nkmeans_clus4.fit(country_norm)","2f1ba3e1":"kmeans_clus4.labels_","70e365a9":"#Finding the labels and converting it to series so that it can be appended to the `original countries` easily.\nlabels_kmeans = pd.Series(kmeans_clus4.labels_, index=countries.index)","9cf9d42f":"#Adding the labels to countries dataset\ncountries_kmeans = countries.copy()\ncountries_kmeans['Labels'] = labels_kmeans\ncountries_kmeans.head()","e910033a":"countries_kmeans['Labels'].value_counts()","7288f90f":"axes = sns.scatterplot(x='gdpp',y='child_mort',hue='Labels',legend='full',data=countries_kmeans, palette=['green','orange','brown','red'])\naxes.set(xlabel = 'GDPP', ylabel= 'Child Mortality Rate')","278f2b11":"axes = sns.scatterplot(x='gdpp',y='income',hue='Labels',legend='full',data=countries_kmeans, palette=['green','orange','brown','red'])\naxes.set(xlabel = 'GDPP', ylabel= 'Income')","dceb25e2":"axes= sns.scatterplot(x='income',y='child_mort',hue='Labels',legend='full',data=countries_kmeans, palette=['green','orange','brown','red'])\naxes.set(xlabel = 'Child Mortality Rate', ylabel= 'Income')","7a916a5f":"child_mort_mean =pd.DataFrame(countries_kmeans.groupby([\"Labels\"]).child_mort.mean())\nexports_mean=pd.DataFrame(countries_kmeans.groupby([\"Labels\"]).exports.mean())\nhealth_mean =pd.DataFrame(countries_kmeans.groupby([\"Labels\"]).health.mean())\nimports_mean =pd.DataFrame(countries_kmeans.groupby([\"Labels\"]).imports.mean())\nincome_mean =pd.DataFrame(countries_kmeans.groupby([\"Labels\"]).income.mean())\ninflat_mean =pd.DataFrame(countries_kmeans.groupby([\"Labels\"]).inflation.mean())\nlife_expec_mean =pd.DataFrame(countries_kmeans.groupby([\"Labels\"]).life_expec.mean())\ntotal_fer_mean =pd.DataFrame(countries_kmeans.groupby([\"Labels\"]).total_fer.mean())\ngdpp_mean =pd.DataFrame(countries_kmeans.groupby([\"Labels\"]).gdpp.mean())","90abeb8b":"cluster_analysis_df = pd.concat([pd.Series([0,1,2,3]),child_mort_mean,exports_mean,health_mean,imports_mean,income_mean,inflat_mean,life_expec_mean,\n                                 total_fer_mean,gdpp_mean], axis=1)","0eb6e903":"cluster_analysis_df.columns = [\"Labels\",\"child_mort_mean\",\"exports_mean\",\"health_mean\",\"imports_mean\",\"income_mean\",\"inflation_mean\",\"life_expec_mean\",\"total_fer_mean\",\"gdpp_mean\"]\ncluster_analysis_df","4090118d":"features = cluster_analysis_df.columns\nfig = plt.figure(figsize=(18,15))\nfor plot, feature in enumerate(features[1:]):\n    fig.add_subplot(3,3,plot+1)\n    sns.barplot(cluster_analysis_df.Labels, cluster_analysis_df[feature])","75fbe4cf":"#Binning the clusters to get the top 5 countries sorted in order exaplined above\nclustered_kmeans=countries[countries_kmeans['Labels']==1]\nclustered_kmeans.sort_values(['gdpp','income','child_mort','health','inflation','life_expec','total_fer','imports','exports'], \n                      ascending=[True,True,False,True,False,True,False,False,True]).head(10)\n","0c910753":"country_norm.shape","425f369d":"country_norm.head()","e19ed7f3":"countries_hrcl  = country_norm.copy()\nfig = plt.figure(figsize = (25,8))\nmergings = linkage(countries_hrcl, method = \"single\", metric='euclidean')\ndendrogram(mergings)\nplt.show()","c3a104c5":"# HC with complete method\nfig = plt.figure(figsize = (25, 8))\nmergings = linkage(countries_hrcl, method = \"complete\", metric='euclidean')\ndendrogram(mergings)\nplt.show()","88f091c2":"countries","829521a3":"clusterCut = cut_tree(mergings, n_clusters = 4).reshape(-1,)\nclusterCut","cf9b6e36":"countries_hrcl_cluster = countries.copy()\ncountries_hrcl_cluster.head()","7094c973":"countries_hrcl_cluster['Labels'] = pd.Series(clusterCut, index=countries.index)\ncountries_hrcl_cluster.head()","a7c523b6":"countries_hrcl_cluster['Labels'].value_counts()","d32038ac":"axes = sns.scatterplot(x='gdpp', y='child_mort', hue='Labels',legend='full',data=countries_hrcl_cluster, palette=['green','orange','brown','red'])\naxes.set(xlabel = 'GDPP', ylabel= 'Child Mortality Rate')","eb87ca6e":"axes = sns.scatterplot(x='gdpp',y='income',hue='Labels',legend='full',data=countries_hrcl_cluster, palette=['green','orange','brown','red'])\naxes.set(xlabel = 'GDPP', ylabel= 'Income')","51e8f0d3":"axes= sns.scatterplot(x='income',y='child_mort',hue='Labels',legend='full',data=countries_hrcl_cluster, palette=['green','orange','brown','red'])\naxes.set(xlabel = 'Child Mortality Rate', ylabel= 'Income')","c47e3d81":"child_mort_mean =pd.DataFrame(countries_hrcl_cluster.groupby([\"Labels\"]).child_mort.mean())\nexports_mean=pd.DataFrame(countries_hrcl_cluster.groupby([\"Labels\"]).exports.mean())\nhealth_mean =pd.DataFrame(countries_hrcl_cluster.groupby([\"Labels\"]).health.mean())\nimports_mean =pd.DataFrame(countries_hrcl_cluster.groupby([\"Labels\"]).imports.mean())\nincome_mean =pd.DataFrame(countries_hrcl_cluster.groupby([\"Labels\"]).income.mean())\ninflat_mean =pd.DataFrame(countries_hrcl_cluster.groupby([\"Labels\"]).inflation.mean())\nlife_expec_mean =pd.DataFrame(countries_hrcl_cluster.groupby([\"Labels\"]).life_expec.mean())\ntotal_fer_mean =pd.DataFrame(countries_hrcl_cluster.groupby([\"Labels\"]).total_fer.mean())\ngdpp_mean =pd.DataFrame(countries_hrcl_cluster.groupby([\"Labels\"]).gdpp.mean())","e0ab2d32":"hrcl_cluster_analysis_df = pd.concat([pd.Series([0,1,2,3]),child_mort_mean,exports_mean,health_mean,imports_mean,income_mean,inflat_mean,life_expec_mean,\n                                 total_fer_mean,gdpp_mean], axis=1)","6822600e":"hrcl_cluster_analysis_df.columns = [\"Labels\",\"child_mort_mean\",\"exports_mean\",\"health_mean\",\"imports_mean\",\"income_mean\",\"inflation_mean\",\"life_expec_mean\",\"total_fer_mean\",\"gdpp_mean\"]\nhrcl_cluster_analysis_df","442c6f3f":"features = hrcl_cluster_analysis_df.columns\nfig = plt.figure(figsize=(18,15))\nfor plot, feature in enumerate(features[1:]):\n    fig.add_subplot(3,3,plot+1)\n    sns.barplot(hrcl_cluster_analysis_df.Labels, hrcl_cluster_analysis_df[feature])","decfd04a":"#Binning the clusters to get the top 5 countries sorted in order exaplined above\nclustered_hrcl=countries[countries_hrcl_cluster['Labels']==0]\nclustered_hrcl.sort_values(['gdpp','income','child_mort','health','inflation','life_expec','total_fer','imports','exports'], \n                      ascending=[True,True,False,True,False,True,False,False,True]).head(10)\n","5b3234b5":"### Preparing the dataset for clustering","ec11a50e":"#### Bivariate analysis of clustered countries ","1946d9c1":"### Checking the number of countries assigned to each clusters","ac62519f":"From the above plot we can see that is Nigeria is clearly standing out having the highest infaltion.","525d4386":"## Profiling the clusters based on  - [gdpp, child_mort and income] ","c96c4c52":"There are no duplicated rows","6335ed15":"There are no NULL values in the dataset","07e4a47c":"## 1. Load libraries and read the data","10cb0ace":"From the above plots, we can conculde the following:\n- There are outliers in each features.\n- Most of the outliers are in health, exports and gdpp\n- There are only 167 rows(countries), so removing these outliers will delete the crucial information from the datesets.\n- Specially the countries which have exceptionally high child mortalities(outliers), will be missed, which actually need the aid from the NGO. For example, in case of Child Mortality rate, country with value `208` is an outlierm, however, the coutry itself could in dire need of aid.\n- So I chose to treat the outliers only in the `gdpp` column. The coutries with high `gdpp` would not require an aid. So I will remove those from the dataset.","cc284eb9":"#### Scaling the dataset","b966671b":"#### Elbow score","963a659e":"### From the above 3 scatterplots we can deduce the following insights about the clusters, specially about the clster labeled 1.\n\n- In the gdpp vs child_mort plot, the child_mort is high when gdpp is low.\n- In the gdpp vs income, when the gdpp is average the income is average.\n- In the income vs child_mort, when income is high the child mortality is low and vice versa.","94e1e41e":"### We got same countries by both K-means and Heirarchical Clustering techniques: \n##### Therefore following are the countries which are in direst need of aid by considering socio \u2013 economic factor into consideration:\n\n    1. Burundi\n    2. Liberia\n    3. Congo, Dem. Rep.\n    4. Niger\n    5. Sierra Leone","df0a843d":"### So from the above results and analysis, we can conclude that as per K- means clustering, the country which are direst need of aid are:\n    1. Burundi\n    2. Liberia\n    3. Congo, Dem. Rep\n    4. Niger\n    5. Sierra Leone","ebad3728":"#### Checking if the datset is fit for applying clustering on it","8a77463b":"### Top 10 under developed coutries based on the data visulaization ","6c564673":"From the above plots we can conclude the following about gddp\n- It is highly and positively correlated with life expectancy and income\n- It is inversely correlated with child_mortality, total fertility and inflation\n- health, imports and exports are also positively correlated with gddp\n- Also there is linear realtionship between gdpp vs income,imports vs exports, total_fer  vs child_mort","579a3027":"### So from the above results and analysis, we can conclude that as per Heirarchical clustering, the country which are direst need of aid are:\n    1. Burundi\n    2. Liberia\n    3. Congo, Dem. Rep\n    4. Niger\n    5. Sierra Leone","781ec1bd":"#### Finding the  Silhouette score","bb6f81d1":"The above numbers are quite different from the one which we got in kMeans method.\nBut that is understandable becuase the Hierarchical clustering method will form different clusters than the Kmeans one.","b77c18a6":"###### Top 10 Countries with the highest Inflation rate.","1f0118e9":"#### Visulaizing the data using Pair Plot","bb72ad95":"### By single method heirarchical clustering things are not clear, so let us go for complete heirarchical clustering method.","117525bf":"#### From the above visulizations we get a good idea about the under developed countries which might be in need of the NGOs aid.\n","22e5d809":"## Profiling the clusters based on  - [gdpp, child_mort and income] ","02810941":"#### Bivariate analysis of clustered countries ","f99d0813":"After removing the outlier","d5070897":"### From the above 3 scatterplots we can deduce the following insights about the clusters, specially about the clster labeled 0.\n\n- In the gdpp vs child_mort plot, the child_mort is high when gdpp is low.\n- In the gdpp vs income, when the gdpp is average the income is average.\n- In the income vs child_mort, when income is high the child mortality is low and vice versa.","9b65086c":"Since the exports, healths and imports are given as percentage of GDPP. First we will convert them to their actual values respectively. This will help us to get the actual comparisons among the countries.\n","f0ef3734":"### Performing Univariate Ananlysis on all the features","b5c4cc13":"### We have got the Hopkins score close to 1 which tends to indicate the data is highly clustered","09f45ac9":"###### Top 10 countries with lowest per capita income.","4c8f5368":"#### Taking the means and analyzing the clusters further","2a6bc55d":"#### Checking for outliers and treating it","efcaf2e4":"###### By looking silhouette plot, we see the highest peak is at k = 4 and in sum of squared distances plot , we see that the elbow is in the range of 3 to 5 , so let us take k as 4.","321735c4":"#### Taking the means of the features and analyzing the clusters further","d9b9024b":"### Performing K-Means Clustering on the scaled dataset\n","a83f9332":"###### Top 10 coutries with highest mortality rate","9f1c3ca0":"##  Taking Hierarchical Clustering approach","b27a6d11":"##### At 12.5 there are 3 clusters and at 10.0 there are 4 clusters\n### Let us cut the dendrogram  such that there are  n_clusters = 4 \n","b57d9449":"### Checking the number of countries assigned to each clusters","e90667af":"###### Top 10 countries with the `lowest` spending on health","5359bf5b":"#### Using the already cleaned and scaled data, done earlier in  kmeans analysis","cb1275a7":"From the above plot we can see that the criterias , namely, `gdpp, income and child mortality` are satified by cluster labeled 1 ","a2ece642":"###### In the above table we can see, that Qatar is having a high child mortality rate of 9.0, but its other features like gdpp, total_fertility rate, income etc are in the higher range. So it would not be first in the list of needy countries."}}