{"cell_type":{"53b83c78":"code","563de9d2":"code","ac1c5cf0":"code","6722d5e5":"code","ecdd352d":"code","3b57e7da":"code","4a929219":"code","0bba3af7":"code","a3aab304":"code","9ca3e1cb":"code","063fae42":"code","67afff5a":"code","dc08417d":"markdown","ab1513a5":"markdown","e33d423b":"markdown","397c405b":"markdown","3e47dba5":"markdown","d46454b3":"markdown","a4432a65":"markdown","aa73a94e":"markdown","96a525f4":"markdown","210ef3e9":"markdown","ccbca00c":"markdown","67a33e7c":"markdown","e6c5be51":"markdown","cbf04c3c":"markdown"},"source":{"53b83c78":"import os\nimport tensorflow as tf\nimport random\nfrom glob import glob","563de9d2":"data_dir = \"..\/input\/one-piece-character-detection-with-tfrecords\/TFrecords\/TFrecords\"","ac1c5cf0":"files = glob(data_dir+\"\/*.tfrecord\")\nprint(f\"Files count: {len(files)}\")","6722d5e5":"random.seed(123)\nrandom.shuffle(files)","ecdd352d":"length = len(files)\ntraining_length = int(0.8*length)","3b57e7da":"training_files = files[0:training_length]\nvalidation_files = files[training_length:]","4a929219":"print(f\"Training dataset length: {len(training_files)}\")\nprint(f\"Validation dataset length: {len(validation_files)}\")","0bba3af7":"training_tfrecord = tf.data.TFRecordDataset(filenames=training_files, num_parallel_reads=os.cpu_count())","a3aab304":"validation_tfrecord = tf.data.TFRecordDataset(filenames=validation_files, num_parallel_reads=os.cpu_count())","9ca3e1cb":"filename_training = \"training.tfrecord\"\nfilename_validation = \"validation.tfrecord\"","063fae42":"writer_training = tf.data.experimental.TFRecordWriter(filename_training)\nwriter_training.write(training_tfrecord)","67afff5a":"writer_validation = tf.data.experimental.TFRecordWriter(filename_validation)\nwriter_validation.write(validation_tfrecord)","dc08417d":"## Shuffle the training set ","ab1513a5":"# Libraries","e33d423b":"# Split the data into train\/val records (80% for training, 20% for validation)","397c405b":"### Validation","3e47dba5":"## Split the data","d46454b3":"## File names","a4432a65":"## Training TF.record","aa73a94e":"## Write the files","96a525f4":"# Files","210ef3e9":"# Save the files","ccbca00c":"## Verify","67a33e7c":"### Training","e6c5be51":"## Define the parameters ","cbf04c3c":"# Generate the TF.records training and validation files"}}