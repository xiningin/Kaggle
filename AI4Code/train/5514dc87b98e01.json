{"cell_type":{"913ddca7":"code","64512a17":"code","9e07619e":"code","3e602a6a":"code","b0c552f8":"code","48ca4186":"code","e0cdb62e":"code","885b00f3":"code","434f05c6":"code","4031da51":"code","d55ddd6b":"code","f3752a3f":"code","4462e75f":"code","569ceec6":"code","ad816fa8":"code","8c9ff006":"code","5f41f0d8":"code","9711cacc":"code","77bec063":"code","8a74a836":"code","0d1466c6":"code","ae5e09a1":"code","b4e2b235":"code","23404161":"code","645a7798":"code","eaa0ca1a":"code","ce0e3149":"markdown","1cc4bd43":"markdown","59f23314":"markdown","6046c58d":"markdown","9bd07c1a":"markdown"},"source":{"913ddca7":"import numpy as np \nimport pandas as pd \nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.metrics import classification_report,confusion_matrix\n%matplotlib inline\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","64512a17":"df = pd.read_csv('..\/input\/heart-failure-clinical-data\/heart_failure_clinical_records_dataset.csv')","9e07619e":"df.head()","3e602a6a":"df.info()","b0c552f8":"df.describe().transpose()","48ca4186":"sns.heatmap(df.isnull(),yticklabels=False,cbar=False,cmap='viridis')","e0cdb62e":"plt.figure(figsize=(8,6))\nsns.heatmap(df.corr(),vmin=-1,cmap='viridis')","885b00f3":"\ndf.corr()[abs(df.corr()['DEATH_EVENT']) > 0.1]['DEATH_EVENT']  \n#The features 'age', 'ejection_fraction', 'serum_creatinine', 'serum_sodium', and 'time' have a considerable correlation with 'DEATH_EVENT'","434f05c6":"sns.countplot(x='DEATH_EVENT',hue='sex',data=df)","4031da51":"print(df['anaemia'].value_counts())\n\nprint(df['diabetes'].value_counts())\n\nprint(df['high_blood_pressure'].value_counts())\n\nprint(df['smoking'].value_counts())","d55ddd6b":"fig, axes = plt.subplots(2, 2, figsize=(18, 10))\n\nfig.suptitle('count plots')\n\nsns.countplot(ax=axes[0, 0],x='DEATH_EVENT',hue='anaemia',data=df,palette='coolwarm')# should stay\nsns.countplot(ax=axes[0, 1],x='DEATH_EVENT',hue='smoking',data=df,palette='coolwarm')# can be removed\nsns.countplot(ax=axes[1, 0],x='DEATH_EVENT',hue='high_blood_pressure',data=df,palette='coolwarm')# should stay\nsns.countplot(ax=axes[1, 1],x='DEATH_EVENT',hue='diabetes',data=df,palette='coolwarm') #can be removed\n\n","f3752a3f":"df[df['platelets']>600000]['DEATH_EVENT']","4462e75f":"fig, axes = plt.subplots(3, 2, figsize=(18, 10))\n\nfig.suptitle('box plots')\n\nsns.boxplot(ax=axes[0, 0],x='DEATH_EVENT',y='age',data=df)\nsns.boxplot(ax=axes[0, 1],x='DEATH_EVENT',y='creatinine_phosphokinase',data=df)\nsns.boxplot(ax=axes[1, 0],x='DEATH_EVENT',y='ejection_fraction',data=df)\nsns.boxplot(ax=axes[1, 1],x='DEATH_EVENT',y='platelets',data=df) # is this feature useful in predicting?\nsns.boxplot(ax=axes[2, 0],x='DEATH_EVENT',y='serum_creatinine',data=df)\nsns.boxplot(ax=axes[2, 1],x='DEATH_EVENT',y='serum_sodium',data=df)","569ceec6":"fig, axes = plt.subplots(3, 2, figsize=(18, 10))\n\nfig.suptitle('hist plots')\n\nsns.histplot(df['age'],ax=axes[0,0],bins=30)\nsns.histplot(df['ejection_fraction'],ax=axes[0, 1],bins=30,color='r')#drop greater than 60\nsns.histplot(df['platelets'],ax=axes[1, 0],bins=30,color='g')#get rid of greater than 600000\nsns.histplot(df['serum_creatinine'],ax=axes[1, 1],bins=30,color='y') # i think we should keep it\/ train model and then remove it and check again\nsns.histplot(df['serum_sodium'],ax=axes[2, 0],bins=30,color='k') # get rid of things below 125\nsns.histplot(df['creatinine_phosphokinase'],ax=axes[2, 1],bins=30,color='c') # drop greater than 3000","ad816fa8":"sns.histplot(x='time',data=df,bins=30)","8c9ff006":"x = df[['ejection_fraction','serum_creatinine','time','serum_sodium','age']]\ny = df['DEATH_EVENT']","5f41f0d8":"scalerer = StandardScaler()\nscalerer.fit(x)\nscaled_feature = scalerer.transform(x)","9711cacc":"X_train, X_test, y_train, y_test = train_test_split(scaled_feature,df['DEATH_EVENT'],\n                                                    test_size=0.30)","77bec063":"knn = KNeighborsClassifier(n_neighbors=1)\nknn.fit(X_train,y_train)\npred = knn.predict(X_test)","8a74a836":"print(confusion_matrix(y_test,pred))\nprint(classification_report(y_test,pred))\n\n","0d1466c6":"error_rate = []\n\nfor i in range(1,40):\n    \n    knn = KNeighborsClassifier(n_neighbors=i)\n    knn.fit(X_train,y_train)\n    pred_i = knn.predict(X_test)\n    error_rate.append(np.mean(pred_i != y_test))","ae5e09a1":"plt.figure(figsize=(10,6))\nplt.plot(range(1,40),error_rate,color='k', linestyle='dashed', marker='o',\n         markersize=5)\nplt.title('Error Rate vs. K Value')\nplt.xlabel('K')\nplt.ylabel('Error Rate')","b4e2b235":"# NOW WITH K=19\nknn = KNeighborsClassifier(n_neighbors=19)\n\nknn.fit(X_train,y_train)\npred = knn.predict(X_test)\n\nprint('WITH K=19')\nprint('\\n')\nprint(confusion_matrix(y_test,pred))\nprint('\\n')\nprint(classification_report(y_test,pred))","23404161":"X_train, X_test, y_train, y_test = train_test_split(scaled_feature,df['DEATH_EVENT'],\n                                                    test_size=0.30)","645a7798":"logmodel = LogisticRegression()\nlogmodel.fit(X_train,y_train)\npredictions = logmodel.predict(X_test)","eaa0ca1a":"print(confusion_matrix(y_test,predictions))\nprint(classification_report(y_test,predictions))","ce0e3149":"# Exploratory Data Analysis","1cc4bd43":"# K NEAREST NEIGHBORS CLASSIFIER","59f23314":"# Importing Libraries","6046c58d":"# Splitting Data & Feature Scaling","9bd07c1a":"# Logistic Regression"}}