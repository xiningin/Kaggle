{"cell_type":{"c3abc494":"code","4a779a94":"code","82041dbd":"code","03cb3161":"code","e0139d11":"code","ead1338c":"code","8e8f78d1":"code","4760d407":"code","fa0e1996":"code","7f5857cc":"code","df2c3fc4":"code","9040080c":"code","7b2bdfc0":"code","17e5f1e2":"code","bcd634df":"code","582887e6":"code","03be994a":"code","d4d00bef":"code","174f33e4":"code","cabd8870":"code","3662217a":"code","a2be8f52":"code","827410e8":"code","3562971f":"code","7a58e062":"code","d89f11fd":"code","bcd2ade9":"code","52c812c8":"code","15a8c16b":"markdown","10673b84":"markdown","d07a4c51":"markdown"},"source":{"c3abc494":"from fastai.vision import *\nfrom fastai.metrics import accuracy","4a779a94":"!ls ..\/input","82041dbd":"# Copy for FastAI\n!rm -rf data\n!mkdir -p data\n!cp -R ..\/input\/dsnet-kaggledays-hackathon\/train\/train data\/train\n!cp -R ..\/input\/dsnet-kaggledays-hackathon\/test\/test data\/test\n!cp ..\/input\/dsnet-kaggledays-hackathon\/sample_submission.csv data\/sample_submission.csv","03cb3161":"!ls ..\/input","e0139d11":"DATA_DIR = Path('data')\n","ead1338c":"bs = 3","8e8f78d1":"data = ImageDataBunch.from_folder(DATA_DIR, valid_pct=0.075, ds_tfms=get_transforms(max_rotate=20.5, max_zoom=1.6), bs=256, size=64)","4760d407":"len(data.train_ds)","fa0e1996":"img, cat = data.train_ds[100]\n","7f5857cc":"data.show_batch(rows=5, figsize=(7,6))","df2c3fc4":"doc(ImageDataBunch)","9040080c":"doc(get_transforms)","7b2bdfc0":"learn = cnn_learner(data, models.resnet18, pretrained=False, metrics=accuracy)","17e5f1e2":"learn.model","bcd634df":"learn.lr_find()","582887e6":"learn.recorder.plot()","03be994a":"learn.fit_one_cycle(3, 1e-3)","d4d00bef":"# Save the model\nlearn.save('simple-model')","174f33e4":"# Load the model\nlearn.load('simple-model')\n","cabd8870":"# Load submission file\nsample_df = pd.read_csv(DATA_DIR\/'sample_submission.csv')\nsample_df.head()","3662217a":"len(sample_df)","a2be8f52":"# Generate test predictions\nlearn.data.add_test(ImageList.from_df(sample_df,DATA_DIR,folder='test'))","827410e8":"# Load up submission file\npreds,y = learn.get_preds(DatasetType.Test)","3562971f":"preds","7a58e062":"# Convert predictions to classes\npred_classes = [data.classes[c] for c in list(preds.argmax(dim=1).numpy())]\npred_classes[:10]\npred_classes = [c if c != 'test' else 'Vincent_van_Gogh' for c in pred_classes]\npred_classes[:10]","d89f11fd":"# Add the prediction\nsample_df.predicted_class = pred_classes\nsample_df.head()","bcd2ade9":"# Save the submission file\nsample_df.to_csv('submission.csv',index=False)\n\nfrom IPython.display import FileLink\nFileLink('submission.csv')","52c812c8":"# Clean up (for commit)\n!cp -R data\/models models # Move the models out\n!rm -rf data # Delete the data","15a8c16b":"## Model","10673b84":"## Inference","d07a4c51":"## Data"}}