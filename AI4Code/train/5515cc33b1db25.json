{"cell_type":{"55a8ffcd":"code","2287bc08":"code","51f6d04b":"code","d048d3ed":"code","07bcf8b3":"code","eac25071":"code","1e4ecba4":"code","e48c9331":"code","1ca93ebf":"code","e71e6177":"code","3fdab1a7":"code","c1f95d35":"code","6f007452":"code","204d2623":"code","ea808135":"code","6659c46c":"code","fa19e235":"code","2bcec700":"code","d33d390e":"code","dc6382de":"code","38121dfe":"code","033395a5":"code","2f01c242":"code","118b07ac":"code","4eccb067":"code","60796617":"code","920054eb":"code","90acb252":"code","b2adc988":"code","4b7609f8":"code","7bcbf575":"code","840ca744":"markdown","b80a6845":"markdown","c3a787c1":"markdown","306ff07d":"markdown","62c0a1c5":"markdown","5fcdb296":"markdown","0c5e1229":"markdown"},"source":{"55a8ffcd":"import pandas as pd\nimport numpy as np\n\nimport matplotlib.pyplot as plt\n%matplotlib inline\n\nimport seaborn as sns\n\nfrom sklearn.cluster import KMeans\n","2287bc08":"df = pd.read_csv('..\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv')","51f6d04b":"df.head()","d048d3ed":"df.shape","07bcf8b3":"df.isnull().sum()","eac25071":"df.info()","1e4ecba4":"df.describe()","e48c9331":"plt.figure(figsize = (15,8))\nsns.countplot(data = df, x = 'Age')","1ca93ebf":"plt.figure(figsize = (6,8))\ndf.Gender.value_counts().plot(kind = 'pie')\nplt.legend()\n","e71e6177":"# Distribution of income\nplt.figure(figsize = (15,8))\nsns.countplot(df['Annual Income (k$)'], data = df)\nplt.title('Distribution of annual income')","3fdab1a7":"# show the annual income distribution wrt the gender \n\nplt.figure(figsize = (6,6))\nsns.histplot(df, x = 'Annual Income (k$)', hue = 'Gender')","c1f95d35":"# label encoding \n\nfrom sklearn.preprocessing import LabelEncoder","6f007452":"enc = LabelEncoder()\n","204d2623":"df.Gender = enc.fit_transform(df.Gender)","ea808135":"df.drop('CustomerID', axis = 1, inplace = True)","6659c46c":"df.head()","fa19e235":"lst = []\nfor i in range(1,11):\n  kmodel = KMeans(n_clusters = i, n_init = 15, max_iter = 500) \n  kmodel.fit(df)\n  lst.append(kmodel.inertia_)","2bcec700":"lst","d33d390e":"plt.plot(range(1,11), lst, marker = 'o')\nplt.grid()","dc6382de":"# k = 6","38121dfe":"kmodel = KMeans(n_clusters = 6)","033395a5":"kmodel.fit(df)","2f01c242":"prediction = kmodel.predict(df)","118b07ac":"kmodel.cluster_centers_","4eccb067":"len(kmodel.cluster_centers_)","60796617":"df['clusters'] = prediction","920054eb":"df.head()","90acb252":"color = np.array(['darkgray', 'lightsalmon', 'powderblue', 'red', 'yellow', 'black'])\nsns.scatterplot(x = df['Annual Income (k$)'], y = df['Spending Score (1-100)'], c = color[kmodel.labels_], s = 50)\n","b2adc988":"from scipy.cluster.hierarchy import linkage, dendrogram","4b7609f8":"var = linkage(df, method = 'ward')","7bcbf575":"plt.figure(figsize = (20,15))\ndendrogram(var)","840ca744":"### Conclusion:\n\n\n*   the customers that are having the salary of 54k$  and  78k$ are visiting mall more number of times.\n\n\n","b80a6845":"### Conclusions:\n\n\n*   red color people have very low income but their expenditure is very high.\n*   blue color people have high annual income and high expenditure.\n\n\n*   yellow color people have very low income and are spending low.\n*   pink color people have high annual income and are spending less.\n\n\n*   black and gray color people are spending their whole income.\n\n\n\n\n\n\n","c3a787c1":"#### Conclusion:\n\n\n*   Average age of customer is 38.\n*   customer that visits mall is having age between 18-70.\n*   having the avg annual income as 60k$ \n\n\n\n\n\n\n\n","306ff07d":"#### Conclusions:\n\n\n*   number of females > number of males.\n*   people between age group of 30-36 tend to visit mall more often.\n\n\n","62c0a1c5":"### Conclusions:\n\n\n*   No null value in the dataset.\n*   gender is of dtype object, which needs to be taken care of\n\n","5fcdb296":"# Customer Segmentation (k-Mean clustering)","0c5e1229":"# ML\n"}}