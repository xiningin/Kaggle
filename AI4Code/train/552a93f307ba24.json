{"cell_type":{"025f4009":"code","cde682d5":"code","1d087e6f":"code","d2195a9d":"code","98d15a61":"code","8ddf5c1b":"code","e790c6c4":"code","202b4539":"code","836a6339":"code","7c330800":"code","2a7e938f":"code","d925d5f6":"markdown","80d77b59":"markdown","9b179fb1":"markdown","d8113a6a":"markdown","bba73e01":"markdown","34bfcc0f":"markdown","ff67d946":"markdown","fc378a86":"markdown","c54acd11":"markdown","10938c26":"markdown","52424fa9":"markdown","9304aee7":"markdown"},"source":{"025f4009":"import numpy\nimport matplotlib.pyplot as plt\nfrom matplotlib import rc\nplt.rcParams[\"figure.figsize\"] = (18,9)\nfrom pandas import read_csv\nimport math\nfrom keras.models import Sequential\nfrom keras.layers import Dense","cde682d5":"def create_dataset(dataset, look_back=1):\n\tdataX, dataY = [], []\n\tfor i in range(len(dataset)-look_back-1):\n\t\ta = dataset[i:(i+look_back), 0]\n\t\tdataX.append(a)\n\t\tdataY.append(dataset[i + look_back, 0])\n\treturn numpy.array(dataX), numpy.array(dataY)","1d087e6f":"dataframe = read_csv(\"..\/input\/international-airline-passengers\/international-airline-passengers.csv\", usecols=[1], engine='python')\ndataset = dataframe.values\ndataset = dataset.astype('float32')","d2195a9d":"train_size = int(len(dataset) * 0.67)\ntest_size = len(dataset) - train_size\ntrain, test = dataset[0:train_size,:], dataset[train_size:len(dataset),:]","98d15a61":"look_back = 3\ntrainX, trainY = create_dataset(train, look_back)\ntestX, testY = create_dataset(test, look_back)","8ddf5c1b":"model = Sequential()\nmodel.add(Dense(12, input_dim=look_back, activation='relu'))\nmodel.add(Dense(8, activation='relu'))\nmodel.add(Dense(1))\nmodel.compile(loss='mean_squared_error', optimizer='adam')\nmodel.fit(trainX, trainY, epochs=300, batch_size=2, verbose=2)","e790c6c4":"trainScore = model.evaluate(trainX, trainY, verbose=0)\nprint('Train Score: %.2f MSE (%.2f RMSE)' % (trainScore, math.sqrt(trainScore)))\ntestScore = model.evaluate(testX, testY, verbose=0)\nprint('Test Score: %.2f MSE (%.2f RMSE)' % (testScore, math.sqrt(testScore)))","202b4539":"trainPredict = model.predict(trainX)\ntestPredict = model.predict(testX)","836a6339":"trainPredictPlot = numpy.empty_like(dataset)\ntrainPredictPlot[:, :] = numpy.nan\ntrainPredictPlot[look_back:len(trainPredict)+look_back, :] = trainPredict","7c330800":"testPredictPlot = numpy.empty_like(dataset)\ntestPredictPlot[:, :] = numpy.nan\ntestPredictPlot[len(trainPredict)+(look_back*2)+1:len(dataset)-1, :] = testPredict","2a7e938f":"plt.plot(dataset,label='Data')\nplt.plot(trainPredictPlot,label='Train Prediction')\nplt.plot(testPredictPlot,label='Test Prediction')\nplt.xlabel ('Months',fontsize=20)\nplt.ylabel ('Passengers Numbers',fontsize=20)\nplt.legend(fontsize=20)\nplt.show()","d925d5f6":"Shift train predictions for plotting","80d77b59":"Convert an array of values into a dataset matrix","9b179fb1":"Create and fit Multilayer Perceptron model","d8113a6a":"Split into train and test sets","bba73e01":"Multilayer Perceptron to Predict International Airline Passengers (t+1, given t, t-1, t-2). In here we use a simple deep learning fundamantal model to predic airline passenger for last century.","34bfcc0f":"Shift test predictions for plotting","ff67d946":"Reshape dataset","fc378a86":"Firstly import various library which are used here.","c54acd11":"Estimate model performance","10938c26":"Generate predictions for training","52424fa9":"Load the dataset. Here dataset contain ten(1949-1960) years monthly data.","9304aee7":"Plot baseline and predictions"}}