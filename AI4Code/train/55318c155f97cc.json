{"cell_type":{"98dd35c1":"code","8b4b2759":"code","7b06c34f":"code","0111495b":"code","678e5d63":"code","8dc28b96":"code","cc89867e":"code","4e72a85b":"code","6ac9f059":"code","3dad41d7":"code","d945480f":"code","92a3d4f4":"code","fa5920fd":"code","ca79b43a":"code","75c72f6c":"code","086e901a":"code","2641cd44":"code","a622cc6d":"code","d1e5a2bf":"code","2baf6f27":"code","8a31fcf2":"code","293cfb20":"code","78fa940d":"code","6036e227":"code","4b287fda":"code","6ccc7465":"code","bc64316c":"markdown","c2b25c66":"markdown","804aea9f":"markdown","68638591":"markdown","07c43f65":"markdown"},"source":{"98dd35c1":"import cv2\nimport matplotlib.pyplot as plt","8b4b2759":"plt.imshow(cv2.imread('..\/input\/satellite-images-of-hurricane-damage\/train_another\/damage\/-93.55964_30.895018.jpeg'))","7b06c34f":"plt.imshow(cv2.imread('..\/input\/satellite-images-of-hurricane-damage\/train_another\/damage\/-93.59011_30.695412.jpeg'))","0111495b":"plt.imshow(cv2.imread('..\/input\/satellite-images-of-hurricane-damage\/train_another\/damage\/-93.597636_30.674362.jpeg'))","678e5d63":"plt.imshow(cv2.imread('..\/input\/satellite-images-of-hurricane-damage\/train_another\/no_damage\/-95.062166_29.828609999999998.jpeg'))","8dc28b96":"plt.imshow(cv2.imread('..\/input\/satellite-images-of-hurricane-damage\/train_another\/no_damage\/-95.062117_29.828828.jpeg'))","cc89867e":"plt.imshow(cv2.imread('..\/input\/satellite-images-of-hurricane-damage\/train_another\/no_damage\/-95.063255_29.792407.jpeg'))","4e72a85b":"from tensorflow.keras.preprocessing.image import ImageDataGenerator\nfrom tensorflow.keras.applications.vgg16 import VGG16\nfrom tensorflow.keras.applications.vgg19 import preprocess_input\nfrom glob2 import glob","6ac9f059":"IMAGE_SIZE=[224,224]","3dad41d7":"vgg = VGG16(input_shape= IMAGE_SIZE + [3],weights='imagenet',include_top=False)","d945480f":"for layer in vgg.layers:\n    layer.trainable = False","92a3d4f4":"folders = glob('..\/input\/satellite-images-of-hurricane-damage\/train_another\/*')","fa5920fd":"from tensorflow.keras.layers import Input,Lambda,Dense,Flatten\nx = Flatten()(vgg.output)","ca79b43a":"from tensorflow.keras.models import Model\nprediction = Dense(len(folders),activation='softmax')(x)\nmodel = Model(inputs= vgg.input,outputs=prediction)","75c72f6c":"model.summary()","086e901a":"model.compile(loss='binary_crossentropy',optimizer='adam',metrics=['accuracy'])","2641cd44":"from tensorflow.keras.preprocessing.image import ImageDataGenerator\ntrain_datagen = ImageDataGenerator(rescale=1.\/255,shear_range=0.2,zoom_range=0.2,horizontal_flip=True)\ntest_datagen = ImageDataGenerator(rescale=1.\/255)\n","a622cc6d":"training_set = train_datagen.flow_from_directory('..\/input\/satellite-images-of-hurricane-damage\/train_another',target_size=(224,224),batch_size=32,class_mode='binary')","d1e5a2bf":"training_set.class_indices","2baf6f27":"valid_set = test_datagen.flow_from_directory('..\/input\/satellite-images-of-hurricane-damage\/validation_another',target_size=(224,224),batch_size=32,class_mode='binary')","8a31fcf2":"test_set = test_datagen.flow_from_directory('..\/input\/satellite-images-of-hurricane-damage\/test',target_size=(224,224),batch_size=32,class_mode='binary')","293cfb20":"history = model.fit_generator(training_set,validation_data=valid_set,epochs=3,steps_per_epoch=len(training_set),validation_steps=len(test_set))\n","78fa940d":"test_accu = model.evaluate_generator(test_set,steps=624)\nprint('The testing accuracy is :',test_accu[1]*100, '%')","6036e227":"from tensorflow.keras.models import load_model\n\nmodel.save('building.h5')","4b287fda":"from tensorflow.keras.models import load_model\nfrom tensorflow.keras.preprocessing import image\nfrom tensorflow.keras.applications.vgg16 import preprocess_input\nimport numpy as np\nmodel = load_model( 'building.h5')\n\nimg = image.load_img('..\/input\/satellite-images-of-hurricane-damage\/test_another\/damage\/-93.5302_30.988157.jpeg',target_size=(224,224))\nx = image.img_to_array(img)\nx = np.expand_dims(x,axis=0)\nimg_data = preprocess_input(x)\nclasses = model.predict(img_data)","6ccc7465":"classes.argmax()","bc64316c":"UNDAMAGED BUILDING","c2b25c66":"DMAGED BUILDINGS","804aea9f":"Seeing Our Data","68638591":"# USING VGG MODEL","07c43f65":"# COLLECTING DATA"}}