{"cell_type":{"4c77f694":"code","57d64682":"code","189738bd":"code","86c089e8":"code","282abbe6":"code","7a724be0":"code","4c57b8ed":"code","20c6f5e6":"code","97ed762d":"markdown","15c35839":"markdown","870266a3":"markdown","13cc548f":"markdown","09a489f3":"markdown","e749ecf1":"markdown","508d0b62":"markdown","cc2847e6":"markdown","61ee8fa0":"markdown","7306f8c3":"markdown"},"source":{"4c77f694":"import matplotlib.pyplot as plt\nfrom tqdm import tqdm\nimport numpy as np\nimport cv2 \nimport os\n\nDATADIR = \"\/kaggle\/input\/sign-language-for-numbers\/Sign Language for Numbers\/\"\nCATEGORIES = [\"0\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"unknown\"]\n\nfor category in CATEGORIES:\n    path = os.path.join(DATADIR,category)  # create path to categories\n    for img in os.listdir(path):\n      # iterate over each image\n      # convert to array\n      img_array = cv2.imread(os.path.join(path,img) ,cv2.IMREAD_GRAYSCALE)  \n      plt.imshow(img_array, cmap='gray')  # graph it\n      plt.show()  # display!\n\n      break  # we just want one for now so break\n    break  #...and one more!","57d64682":"IMG_SIZE = 64\n\nnew_array = cv2.resize(img_array, (IMG_SIZE, IMG_SIZE))\nplt.imshow(new_array, cmap='gray')\nplt.show() # Show resize image","189738bd":"training_data = []\n\ndef create_training_data():\n    for category in CATEGORIES:  # do 0,1,2,3, .....\n\n        path = os.path.join(DATADIR,category)  # create path to categories\n        class_num = CATEGORIES.index(category)  # get the classification\n\n        for img in tqdm(os.listdir(path)):  # iterate over each image\n            try:\n                img_array = cv2.imread(os.path.join(path,img) ,cv2.IMREAD_GRAYSCALE)  # convert to array\n                new_array = cv2.resize(img_array, (IMG_SIZE, IMG_SIZE))  # resize to normalize data size\n                training_data.append([new_array, class_num])  # add this to our training_data\n            except Exception as e:  # in the interest in keeping the output clean...\n                pass\n            \ncreate_training_data() # call function","86c089e8":"import random\nrandom.shuffle(training_data)\n\n# Check\nfor sample in training_data[:10]:\n    print(sample[1])","282abbe6":"X = []\nY = []\n\nfor features,label in training_data:\n    X.append(features)\n    Y.append(label)\n\nprint(X[0].reshape(-1, IMG_SIZE, IMG_SIZE, 1))\n\nX = np.array(X).reshape(-1, IMG_SIZE, IMG_SIZE, 1)","7a724be0":"import pickle\n\npickle_out = open(\"\/kaggle\/working\/X.pickle\",\"wb\")\npickle.dump(X, pickle_out)\npickle_out.close()\n\npickle_out = open(\"\/kaggle\/working\/Y.pickle\",\"wb\")\npickle.dump(Y, pickle_out)\npickle_out.close()","4c57b8ed":"import tensorflow as tf\nfrom tensorflow.keras.datasets import cifar10\nfrom tensorflow.keras.preprocessing.image import ImageDataGenerator\nfrom tensorflow.keras.models import Sequential\nfrom tensorflow.keras.layers import Dense, Dropout, Activation, Flatten\nfrom tensorflow.keras.layers import Conv2D, MaxPooling2D\nfrom tensorflow.keras.callbacks import TensorBoard\nimport time\n\nimport pickle\n\nNAME = \"Numbers-CNN-Model-{}\".format(str(time.ctime())) # Model Name\n\n# Load pickel data\npickle_in = open(\"\/kaggle\/working\/X.pickle\",\"rb\")\nX = pickle.load(pickle_in)\nX = np.array(X).reshape(-1, IMG_SIZE, IMG_SIZE, 1)\n\npickle_in = open(\"\/kaggle\/working\/Y.pickle\",\"rb\")\nY = pickle.load(pickle_in)\nY = np.array(Y)\n\nX = X\/255.0\n\nmodel = Sequential()\n\nmodel.add(Conv2D(16, (2,2), input_shape=X.shape[1:], activation='relu'))\nmodel.add(MaxPooling2D(pool_size=(2, 2), strides=(2, 2), padding='same'))\nmodel.add(Conv2D(32, (3,3), activation='relu'))\nmodel.add(MaxPooling2D(pool_size=(3, 3), strides=(3, 3), padding='same'))\nmodel.add(Conv2D(64, (5,5), activation='relu'))\nmodel.add(MaxPooling2D(pool_size=(5, 5), strides=(5, 5), padding='same'))\nmodel.add(Flatten())\nmodel.add(Dense(128, activation='relu'))\nmodel.add(Dropout(0.2))\nmodel.add(Dense(11, activation='softmax')) # size must be equal to number of classes i.e. 11\n\ntensorboard = TensorBoard(log_dir=\"\/kaggle\/working\/logs\/{}\".format(NAME))\n\nmodel.compile(loss='sparse_categorical_crossentropy',\n              optimizer='adam',\n              metrics=['accuracy'])\n\nmodel.fit(X, Y, batch_size=32, epochs=10, validation_split=0.2, callbacks=[tensorboard])","20c6f5e6":"model.save(\"\/kaggle\/working\/{}.model\".format(NAME))","97ed762d":"## Start Training","15c35839":"## Pickle","870266a3":"## Load Data","13cc548f":"## Ceate training data","09a489f3":"## Shuffle","e749ecf1":"## Appending data into X and Y lists","508d0b62":"# Sign Language Model Training for Numbers\n\nIn this kernel, I will show you how to use and train model for [Sign Language for Numbers Dataset](https:\/\/www.kaggle.com\/muhammadkhalid\/sign-language-for-numbers)","cc2847e6":"## Resize","61ee8fa0":"## Save Model","7306f8c3":"# Done"}}