{"cell_type":{"ca18a063":"code","40098e2e":"code","4707e37f":"code","f2cc7bf9":"code","33cbdd2f":"code","0c887c91":"code","bd089fe1":"code","4054c073":"code","bcf04ff7":"code","ebdcb089":"code","ea98e21a":"code","23ec9a50":"code","6450be0e":"code","a23e890a":"code","0ae3bfcc":"code","75881fba":"code","b8ed2447":"code","e10487e2":"code","ac31f26f":"code","02bb0081":"code","2bcca9c4":"code","c5121a8e":"code","1780d441":"code","c7182587":"code","5c507726":"code","e494702f":"code","e3d0be38":"code","a25b9102":"code","f864d9aa":"code","892583b4":"code","70bd5f09":"code","d3300c42":"code","1e5943b8":"code","b002e4dc":"code","bf39a817":"code","b4010efd":"code","ce4a9f7b":"code","c1a77b34":"code","24b360cc":"code","a0c7824d":"code","97db26c1":"code","1f3ed696":"markdown","40e43165":"markdown","8572e932":"markdown","bdf74284":"markdown","9b96d41d":"markdown","94741779":"markdown","1633afa1":"markdown","c5f7c5da":"markdown","161d9b1b":"markdown","b25088bf":"markdown","01e37d96":"markdown","e064d142":"markdown","89cef1af":"markdown","8f356593":"markdown","61dfa683":"markdown","768c137b":"markdown","5a64eef6":"markdown","e6780adb":"markdown"},"source":{"ca18a063":"!pip install -q sweetviz\n!pip install -q klib\n!pip install -q raceplotly","40098e2e":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nfrom tqdm import tqdm\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nfrom sklearn.preprocessing import MinMaxScaler,StandardScaler\n\nimport klib\nimport seaborn as sns\n\n# Data Visualisation libraries \n%matplotlib inline\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom raceplotly.plots import barplot\n\nsns.set(rc={'figure.figsize':(20.7,20.27)})\n\n\nimport plotly.express as px\nimport plotly.graph_objects as go\nimport plotly.figure_factory as ff\nfrom plotly.subplots import make_subplots\nfrom plotly.offline import init_notebook_mode, iplot\ninit_notebook_mode(connected=True)\n\nimport warnings\nwarnings.filterwarnings(\"ignore\")","4707e37f":"import os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","f2cc7bf9":"players = pd.read_csv('..\/input\/mlb-player-digital-engagement-forecasting\/players.csv')\nseasons = pd.read_csv('..\/input\/mlb-player-digital-engagement-forecasting\/seasons.csv')\nawards = pd.read_csv('..\/input\/mlb-player-digital-engagement-forecasting\/awards.csv')\nteams = pd.read_csv('..\/input\/mlb-player-digital-engagement-forecasting\/teams.csv')\ntrain = pd.read_csv('..\/input\/mlb-player-digital-engagement-forecasting\/train.csv')","33cbdd2f":"train.head()","0c887c91":"train.info()","bd089fe1":"N_DATES = train.shape[0]\nd = []\nfor idx in tqdm(range(N_DATES)):\n    u = eval(train.iloc[idx, 1])\n    d += u\ntrain_next_day = pd.DataFrame(d)\ntrain_next_day.engagementMetricsDate = train_next_day.engagementMetricsDate.astype('datetime64[ns]')","4054c073":"train_next_day.groupby(['engagementMetricsDate']).agg({'playerId':'count'})","bcf04ff7":"train_next_day['engagementMetricsDate_day'] = train_next_day['engagementMetricsDate'].dt.day\ntrain_next_day['engagementMetricsDate_month'] = train_next_day['engagementMetricsDate'].dt.month\ntrain_next_day['engagementMetricsDate_year'] = train_next_day['engagementMetricsDate'].dt.year\ntrain_next_day['engagementMetricsDate_week'] = train_next_day['engagementMetricsDate'].dt.weekofyear","ebdcb089":"plyr_eng_agg_years = train_next_day.groupby(['engagementMetricsDate_year','engagementMetricsDate_month']).agg({'target1':'mean',\\\n                                                                                                     'target2':'mean',\\\n                                                                                                     'target3':'mean',\\\n                                                                                                     'target4':'mean'                                                                                         \n                                                                                                    }).reset_index()","ea98e21a":"plyr_eng_agg_years_tgt1 =  plyr_eng_agg_years.pivot(index='engagementMetricsDate_year',columns=['engagementMetricsDate_month'],values=['target1']).reset_index()","23ec9a50":"plyr_eng_agg_years_tgt1[['engagementMetricsDate_year','target1']]","6450be0e":"pd.concat([plyr_eng_agg_years_tgt1.engagementMetricsDate_year,plyr_eng_agg_years_tgt1.target1],axis=1)","a23e890a":"klib.dist_plot(train_next_day['target1'])","0ae3bfcc":"klib.missingval_plot(players)","75881fba":"source = players['birthCountry'].value_counts()","b8ed2447":"#players['birthCountry'].value_counts()\nfig = go.Figure(data=[go.Pie(labels=source.index,values=source.values)])\nfig.update_layout(title='BirthCountry distribution')\nfig.show()","e10487e2":"src1=players['primaryPositionName'].value_counts()\n#players['birthCountry'].value_counts()\nfig = go.Figure(data=[go.Pie(labels=src1.index,values=src1.values)])\nfig.update_layout(title='primaryPositionName distribution')\nfig.show()","ac31f26f":"players.head()","02bb0081":"scaler = MinMaxScaler()\nscaled_values = scaler.fit_transform(players[['heightInches','weight']])\nplayers = pd.concat([players,pd.DataFrame(scaled_values,columns=['heightInches_minmax','weight_min_max'])],axis=1)","2bcca9c4":"plt.figure(figsize=(30, 30))\nsns.pairplot(players[['primaryPositionName','heightInches','weight']],hue='primaryPositionName')","c5121a8e":"plt.figure(figsize=(30, 30))\nsns.pairplot(players[['primaryPositionName','heightInches_minmax','weight_min_max']],hue='primaryPositionName')","1780d441":"players['DOB'] = pd.to_datetime(players['DOB'])\nplayers['Age']=2021-players['DOB'].dt.year","c7182587":"fig = go.Figure(data=[go.Box(x=players.primaryPositionName, y=players.Age)])\nfig.update_layout(title='primaryPositionName vs Age')\nfig.show()","5c507726":"for pos in players.primaryPositionName.unique().tolist():\n    print(\" Avg Age of \",pos,\"=\",round(players.loc[players['primaryPositionName']==pos]['Age'].mean(),0))","e494702f":"for pos in players.primaryPositionName.unique().tolist():\n    print(\" primaryPositionName = \",pos)\n    klib.dist_plot(players.loc[players['primaryPositionName']==pos]['Age'])","e3d0be38":"players[['primaryPositionName','heightInches_minmax','weight_min_max']]","a25b9102":"plt.figure(figsize=(30, 30))\nsns.jointplot(players['heightInches_minmax'],players['weight_min_max'],hue=players['primaryPositionName'])","f864d9aa":"teams.head(10)","892583b4":"klib.missingval_plot(teams)","70bd5f09":"klib.cat_plot(teams)","d3300c42":"teams['locationName'].value_counts()","1e5943b8":"award_with_team = awards.merge(teams[['id','name', 'teamName','leagueName', 'divisionId', 'divisionName']],left_on='awardPlayerTeamId',right_on='id')\naward_with_team_agg =  award_with_team.groupby(['awardSeason','name']).agg({'divisionName':'count','awardSeason':'min'}).rename(columns={'divisionName':'Award_count','awardSeason':'min_award_year'}).reset_index()","b002e4dc":"my_raceplot = barplot(award_with_team_agg,  item_column='name', value_column='Award_count', time_column='awardSeason')\nmy_raceplot.plot(item_label = 'team name', value_label = 'Award Count', frame_duration = 800)","bf39a817":"award_with_team.head()","b4010efd":"award_with_team_agg.pivot(index='name',columns='awardSeason',values='Award_count').fillna(0)","ce4a9f7b":"sns.heatmap(award_with_team_agg.pivot(index='name',columns='awardSeason',values='Award_count').fillna(0))","c1a77b34":"award_with_team.head()","24b360cc":"pd.concat(\n    [\n        award_with_team.groupby(['name']).agg({'divisionName':'count','awardDate':'min'}).rename(columns={'divisionName':'Award_count','awardSeason':'min_award_year','awardDate':'awardDate_min'}),\n        award_with_team_agg.pivot(index='name',columns='awardSeason',values='Award_count').fillna(0)\n    ],\n    axis=1\n).reset_index()","a0c7824d":"award_with_team.groupby(['awardSeason','playerName'])\\\n.agg({'divisionName':'count'}).rename(columns={'divisionName':'Award_count','awardSeason':'min_award_year','awardDate':'awardDate_min'})\\\n.reset_index()\\\n.sort_values('Award_count',ascending=False)\\\n.head(500)\\\n.pivot(index='playerName',columns='awardSeason',values='Award_count')\\\n.fillna(0)","97db26c1":"sns.heatmap(award_with_team.groupby(['awardSeason','playerName'])\\\n.agg({'divisionName':'count'}).rename(columns={'divisionName':'Award_count','awardSeason':'min_award_year','awardDate':'awardDate_min'})\\\n.reset_index()\\\n.sort_values('Award_count',ascending=False)\\\n.head(500)\\\n.pivot(index='playerName',columns='awardSeason',values='Award_count')\\\n.fillna(0))","1f3ed696":"## >> In progress , Kindly upvote , If you like this notebooks","40e43165":"## Observation - \n \n*   Players are pretty engaged from March to September \n*   Jan,Feb,Oct,Nov & Dec are less engaged\n*   Year - 2020 , Due to Covid19 Players are less engaged compared to 2018 & 2019\n*   2021- Engagement is back normal ","8572e932":"#### Obervation :- \n* 25% Birth State province is missing in dataset \n* 3% of mlbDebutDate is missing","bdf74284":"## Let see what is there in Teams dataset","9b96d41d":"# Player dataset Analysis ;-","94741779":"### Team Cohort in Awards","1633afa1":"# Bivariate analysis in Player Dataset","c5f7c5da":"#### Observation :- \n    Pichers have positive correlation Weight vs Height Inches ","161d9b1b":"### Observation :- \n* 85% of Players birthcountry is USA,D.Republic ,Venezuela & Cuba ","b25088bf":"# Let look into Awards","01e37d96":"#### Observations :-\n* Chicogo Tigers & Auston Astros got maximum awards in 2015 & 2017 compared to other teams","e064d142":"## Players Award Churn in History","89cef1af":"### Univariate Analysis into Target Variables :-","8f356593":"# Players Distribution by BirthCountry","61dfa683":"### Observation :- \n* Majority of players playing Picher,Outfielder,Catcher,Second & First based\n* Very few belongs to Designated Hitter & Infield","768c137b":"# Data Description \n\nYou are tasked with forecasting four different measures of engagement (target1-target4) for a subset of MLB players who are active in the 2021 season. The data contains a set of static files that do not change with time (players.csv, teams.csv, seasons.csv, awards.csv) as well as daily data (train.csv) which is grouped by day. When predicting on a given date, you are forecasting the target variables for the next day (i.e. for date d, you're predicting the engagement for day d+1).\n\nThis is a code competition that relies on a time-series module to ensure models do not peek forward in time. The time series module provides you with the test data and writes your submission file automatically. The test data arrives in a data frame identical in format to train.csv, except it does not contain the target values. To submit, follow the instructions on the Evaluation page. When you submit your notebook, it will be rerun on an unseen test set:\n\nDuring the Training phase of the competition, this unseen test set is comprised of data for the month of May 2021 and the set of active players this year.\nDuring the Evaluation phase, the test set will be a future in-season range of approximately one month.\nYour code will need to be robust and make predictions for any date_playerId combination requested by the module. Each team's selected notebooks (up to 2 per team, selected by the Final Submission Deadline) will be rerun during the Evaluation phase.\n\nBefore diving into specifics, some high level qualifications about the data:\n\nSome self-explanatory fields do not have an explanation (for example: season)\nBinary columns will have null values as well as zeroes. Zeroes will occur if a player had an opportunity to do something, but did not. Nulls will occur if a player never had the opportunity to do something (for example: a player who does not pitch on a given day cannot possibly pitch a shutout - therefore a null value is expected)\nMost game state related fields (balls, strikes, outs, etc.) represent the game state after the event in question. Home score and away score, however, represent the score before an event.\n\n\n\nWe are given 7 csv files:-\n\n - train.csv:training set\n - example_test.csv:example of test set\n - example_sample_submission.csv:example of sample_submission\n - awards.csv:awards won by players before 2018\n - players.csv:Library high level information about all players.\n - seasons.csv:Information about start and end dates of all seasons in this dataset\n - teams.csv:Library containing high level information about all MLB teams.","5a64eef6":"#### Observation :- \n* Designated hitters are pretty experianced min.32 & max 43 with Avg 36.5 years \n* Other Player positions Age boradly varies from 25-33 years ","e6780adb":"<br>\n<h1 style = \"font-size:60px; font-family:Garamond ; font-weight : normal; background-color: #f6f5f5 ; color : #fe346e; text-align: center; border-radius: 100px 100px;\"> MLB Player-Digi Engagement Forecasting \u00b7 Quicklook  <br> Data Analysis & Insights <\/h1>\n<br>"}}