{"cell_type":{"c0db84cc":"code","f366eec7":"code","931baca7":"code","49b69e8e":"code","dd5b7f2b":"markdown","b8ba1e6b":"markdown","35a3de31":"markdown","acdd5d88":"markdown","47916ee0":"markdown","b5c2a650":"markdown"},"source":{"c0db84cc":"from google.colab import drive\nimport os\n\n# install chromium, its driver, and selenium\n!apt update\n!apt install chromium-chromedriver\n!pip install selenium\n\nfrom bs4 import BeautifulSoup\nimport csv\nfrom datetime import date\nfrom time import sleep\nimport random\n\n# set options to be headless, ..\nfrom selenium import webdriver\nfrom selenium.webdriver.common.by import By\nfrom selenium.webdriver.common.keys import Keys\n\ndrive.mount('\/content\/drive\/')","f366eec7":"# list of coins to check; make sure name is correct.\ncurrency_name_list = [\n    \"ethereum\",\n    \"bitcoin\",\n    \"cardano\",\n    \"nem\",\n    \"binance-coin\",\n    \"polkadot-new\",\n    \"stellar\",\n    \"xrp\",\n    ]\n\nstart_date = '2017-03-01'\n\n# Make sure folder names match what you created in google drive\nproject_folder = 'crypto_folder'\noutput_folder = 'historic_values'\n\n\n# dont need to change these\nwork_dir = os.path.join('\/content\/drive\/My Drive\/', project_folder)\nOUTPUT_DIR = os.path.join(work_dir, output_folder)\nend_date = str(date.today())","931baca7":"page_counter = 1 # track number of currencies to download\nfor currency_name in currency_name_list:\n  options = webdriver.ChromeOptions()\n  options.add_argument('--headless')\n  options.add_argument('--no-sandbox')\n  options.add_argument('--disable-dev-shm-usage')\n\n  driver = webdriver.Chrome(options=options)\n  driver.get(f\"https:\/\/coincheckup.com\/coins\/{currency_name}\/charts\")\n  sleep(10) # let's wait until the page loads\n\n  # input date range here to generate table\n  date_picker = driver.find_element(By.XPATH, '\/\/input[@ng-model=\"dateHistory\"]')\n  date_picker.click()\n  sleep(1)\n  date_picker.send_keys(Keys.CONTROL, 'a')\n  sleep(0.5)\n  date_picker.send_keys(Keys.DELETE)\n  sleep(0.5)\n  date_picker.send_keys(start_date)\n  sleep(0.5)\n  date_picker.send_keys(' - ')\n  sleep(0.5)\n  date_picker.send_keys(end_date)\n  sleep(2)\n  date_picker.send_keys(Keys.ENTER)\n\n  sleep(10) # let's wait for the data table the fully generate\n\n  page_source = driver.page_source # prepare page for beautiful soup to scrape\n\n  soup = BeautifulSoup(page_source, 'html.parser')\n  price_table = soup.find(\"table\",{\"class\":\"table dataTable\"})\n\n  # saves table data to csv file\n  with open(f\"{OUTPUT_DIR}\/{currency_name}_price.csv\", \"w\") as ofile:\n      print(f'save CSV data for {currency_name} from {start_date} to {end_date}... coin:{page_counter}\/{len(currency_name_list)}')\n      writer = csv.writer(ofile)\n      rows = price_table.find_all(\"tr\")\n      for row in rows:\n          csv_row = []\n          for cell in row.findAll([\"td\", \"th\"]):\n              csv_row.append(cell.get_text())\n          writer.writerow(csv_row)\n\n  driver.quit()\n\n  # pause after each page request to prevent bann, except on last page\n  if page_counter < len(currency_name_list):\n      n = random.randint(7, 15)\n      for i in range(n):\n          print(f'pausing {n} seconds before accessing next page')\n          sleep(1)\n          n -= 1\n  else:\n      print('finished attempting to download CSV data for all coins')\n\n  page_counter += 1 # increment page_counter by 1\n\n","49b69e8e":"drive.flush_and_unmount()\nprint('All changes made in this colab session should now be visible in Drive.')","dd5b7f2b":"### 3. Run Script","b8ba1e6b":"<a href=\"https:\/\/colab.research.google.com\/github\/snowyTheHamster\/cryptocurrency_historical_value_scrapper\/blob\/master\/scrape_crypto_historical_values.ipynb\" target=\"_parent\"><img src=\"https:\/\/colab.research.google.com\/assets\/colab-badge.svg\" alt=\"Open In Colab\"\/><\/a>","35a3de31":"### 4. Unmount Google Drive","acdd5d88":"### 2. Adjust Settings Below","47916ee0":"### Get historic values of cryptocurrencies\n\n### (Optimized to run on Google Colabs & Google Drive)\n\nScrape historic values of cryptocurrencies & save them to csv files.\n\n+ Make sure to check the TOS of the website you are scraping from.\n+ Use this script & the data pulled at your own risk.\n+ website: https:\/\/coincheckup.com\/\n\nCheck out the pure python version and pyautogui versoin on my github: [https:\/\/github.com\/snowyTheHamster\/cryptocurrency_historical_value_scrapper](https:\/\/github.com\/snowyTheHamster\/cryptocurrency_historical_value_scrapper)\n\n---\n\n### How to use\n**Prepare folders**\n\n+ Create a project folder in Google Drive.\n+ Create folder inside project folder to save csv files.\n\n**Adjust variables and settings in step 2**\n\n+ List the coins you want data for.\n\n+ Change start date you want for the historic values.\n\n+ Make sure the folders you created match the folder names here.\n\n**Run Code**\n\n+ Run each of the blocks in order 1 ~ 4.","b5c2a650":"### 1. Mount Google Drive, installing packages"}}