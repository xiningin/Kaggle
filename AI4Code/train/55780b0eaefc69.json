{"cell_type":{"7e17637e":"code","44210f10":"code","7d2d9626":"code","980341c2":"code","627dc855":"code","4b7d01a7":"code","0d2dff4e":"markdown","41d4bf93":"markdown","6f5b707c":"markdown","610d4075":"markdown","46b4c9d8":"markdown","26d5a9c3":"markdown"},"source":{"7e17637e":"!pip install xlrd\n!pip install openpyxl\n!pip install tensorflow_text","44210f10":"import numpy as np\nimport pandas as pd\nimport os\nimport tensorflow as tf\nimport tensorflow_hub as hub\nimport tensorflow_text\nimport re","7d2d9626":"# dataset coronavirus WHO\npd.set_option('max_colwidth', 100)  # Increase column width\ndata = pd.read_excel(\"..\/input\/whocovidfaq\/WHO_FAQ.xlsx\")\ndata.head()","980341c2":"def preprocess_sentences(input_sentences):\n    return [re.sub(r'(covid-19|covid)', 'coronavirus', input_sentence, flags=re.I) \n            for input_sentence in input_sentences]","627dc855":"# Load module containing USE\nmodule = hub.load('https:\/\/tfhub.dev\/google\/universal-sentence-encoder-multilingual-qa\/3')\n\n# Create response embeddings\nresponse_encodings = module.signatures['response_encoder'](\n        input=tf.constant(preprocess_sentences(data.Answer)),\n        context=tf.constant(preprocess_sentences(data.Context)))['outputs']","4b7d01a7":"test_questions = [\n    \"What about pregnant women?\",\n    \"Wat is de lengte van de incubatietijd?\",\n    \"Are animals contagious COVID-19?\",\n    \"Are there medicine against the coronavirus?\",\n    \"Can I breastfead when I have COVID-19?\",\n    \"Should I stay inside the house?\",\n    \"Kann ich mit meinem Hund spazieren gehen?\"  # As well as German, and all the other languages supported by use-multilingual.\n]\n\n# Create encodings for test questions\nquestion_encodings = module.signatures['question_encoder'](\n    tf.constant(preprocess_sentences(test_questions))\n)['outputs']\n\n# Get the responses\ntest_responses = data.Answer[np.argmax(np.inner(question_encodings, response_encodings), axis=1)]\n\n# Show them in a dataframe\npd.DataFrame({'Test Questions': test_questions, 'Test Responses': test_responses})","0d2dff4e":"### Dataset loading","41d4bf93":"Defining the inut sentence model parameters","6f5b707c":"## Covid-19 FAQ Chat Bot\nIn connection with the coronavirus and the many questions on this subject, I have created a dataset with frequently asked questions and answers from the worlth health organisation (WHO).\n\nOn this website you can find an answer to a question you have regarding the corona virus fairly quickly. However, with a chatbot it could go a lot faster. You simply ask your question and immediatly receive a corresponding answer.\n\nIn the code below, I first load the dataset that contains the answers under \"Answer\" and the context of the answers under \"Context\". These columns should be interpreted as follows:\n\n* Answer is a possible answer to a question.\n* Context is a possible context in which the answer may apply.","610d4075":"### Predicitng Ans to the questions","46b4c9d8":"### Seting it up","26d5a9c3":"Downloading the model"}}