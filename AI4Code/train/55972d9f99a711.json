{"cell_type":{"4600f701":"code","a42b0e08":"code","95660ed2":"code","b8fff87e":"code","30eccfee":"code","b478edc1":"code","178052ff":"code","3ef5864d":"code","86836ce9":"code","4f9e01e8":"code","83ea51d8":"code","e6103db8":"code","c91a3f52":"markdown","a921369e":"markdown","41f3d882":"markdown","56469f0c":"markdown","fc830b81":"markdown"},"source":{"4600f701":"!pip install darts","a42b0e08":"from darts.dataprocessing.transformers import Scaler\nfrom darts import TimeSeries\nfrom darts.utils.timeseries_generation import gaussian_timeseries, linear_timeseries, sine_timeseries\nfrom darts.models import RNNModel, TCNModel, TransformerModel, NBEATSModel, BlockRNNModel\nfrom darts.metrics import mape, smape\nimport matplotlib.pyplot as plt\nplt.style.use('seaborn')\nplt.rcParams[\"figure.figsize\"] = (20,15)\nimport pandas as pd","95660ed2":"data0 = pd.read_csv(\"https:\/\/stopcovid19.metro.tokyo.lg.jp\/data\/130001_tokyo_covid19_patients.csv\")\ndata0[-1:]","b8fff87e":"data0['date']=data0['\u516c\u8868_\u5e74\u6708\u65e5']\ndata0['pcr_positives']=1\ndata1=data0[['date','pcr_positives']]","30eccfee":"data1=data1.groupby('date',as_index=False).sum()\ndata2=data1[317:].reset_index(drop=True)\ndata2['date']=pd.to_datetime(data2['date'])\nprint(len(data2))\ndata2","b478edc1":"data2.info()","178052ff":"data2p=data2.copy()\ndata2p.index=data2p['date']\ndata2p=data2p.drop('date',axis=1)\ndata2p","3ef5864d":"#index=date(datetime64[ns])\ndata2p.plot(label='Number of positives')\nplt.legend()","86836ce9":"series_covid=TimeSeries.from_dataframe(data2, time_col='date', value_cols='pcr_positives')\nprint(type(series_covid))","4f9e01e8":"scaler_covid = Scaler()\ncovid_scaled = scaler_covid.fit_transform(series_covid)\ncovid_scaled.plot(label='pcr_positives')\nplt.legend(loc='best');","83ea51d8":"train_covid, val_covid = covid_scaled[:300], covid_scaled[300:]\nmodel = NBEATSModel(input_chunk_length=24, output_chunk_length=12, n_epochs=100, random_state=0)\n\nmodel.fit(train_covid, verbose=True)\npred = model.predict(n=100, series=train_covid)","e6103db8":"covid_scaled.plot(label='actual')\npred.plot(label='forecast')\nplt.legend()\nprint(f'MAPE :{mape(pred,val_covid)}')","c91a3f52":"# Covid19 Tokyo Prediction Darts\nhttps:\/\/github.com\/unit8co\/darts","a921369e":"# Prepare dataset","41f3d882":"# Create Darts.TimeSeries","56469f0c":"# Prepare library","fc830b81":"# Model Fit & Predict"}}