{"cell_type":{"767dfee4":"code","c265c0ef":"code","611049e3":"code","d9770794":"code","43abb5b2":"code","5165f155":"code","92c9a8cd":"code","db6b4891":"code","7ce40a87":"code","47c6637a":"code","02b8eda7":"code","d7234ff3":"code","53317baf":"code","f02d4893":"code","14d530dc":"code","02d46aba":"code","5a3b07ed":"code","805d003f":"code","5f723b33":"code","0745c03b":"code","6f755b4d":"code","d955871f":"code","d7904ec9":"code","26bc36c6":"code","aaf55320":"code","379c3c04":"code","16830f08":"code","9a6592ff":"code","6c0dd207":"code","296b024c":"code","6ae52b0e":"code","dab94c04":"code","13cfb23d":"code","3396bd5d":"code","9dcd6d2b":"code","8a270f3c":"markdown","467e51f9":"markdown","e25908d5":"markdown","54c210d8":"markdown","a0d1b6f0":"markdown","da73aab1":"markdown","78a5a541":"markdown","7ca4eec7":"markdown","29da0c97":"markdown","f0f5d1b5":"markdown","78a2be03":"markdown","21b9a1da":"markdown","2aecebd0":"markdown","cf8c599e":"markdown","2b3b7499":"markdown","6696d0bf":"markdown","0a9e6fc6":"markdown","135a661a":"markdown","272fb785":"markdown","f46ece3d":"markdown","9b39835c":"markdown","5df6ab83":"markdown","c18a81b3":"markdown","3a2716a6":"markdown","441845a2":"markdown","dfa77047":"markdown","11a75ada":"markdown","f44bbe9b":"markdown","96cf07f6":"markdown","b6bb781a":"markdown","83dcd6f5":"markdown","dc4db4cc":"markdown","c6ab8786":"markdown","914ca3ea":"markdown","ced9bd9e":"markdown"},"source":{"767dfee4":"\nImage(filename=\"..\/input\/ibm-atrition\/empleados2.jpg\")","c265c0ef":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline\nfrom matplotlib import rcParams\n\n%config InlineBackend.figure_format = 'retina'\nsns.set_style(\"white\")\nrcParams['figure.figsize'] = 6,4\nimport matplotlib.ticker as ticker\n\nimport os\nfrom IPython.display import Image\nimport warnings    # We want to suppress warnings\nwarnings.filterwarnings(\"ignore\")    # Ignore warnings","611049e3":"\ndf = pd.read_csv(\"..\/input\/ibm-hr-analytics-attrition-dataset\/WA_Fn-UseC_-HR-Employee-Attrition.csv\")\ndf.head(3)","d9770794":"\nnull = df.isnull().sum() \nnull[null > 0] # Noo, fortunately there are none","43abb5b2":"y_dict = {\"Yes\":1,\"No\":0}\ndf[\"Attrition_numeric\"] = df[\"Attrition\"].map(y_dict)\n","5165f155":"df.drop(['EmployeeCount', 'EmployeeNumber', 'Over18', 'StandardHours',\"Attrition\"], axis=\"columns\", inplace=True)","92c9a8cd":"#describe\ndf.describe().T","db6b4891":"attrition_yes = df.loc[df[\"Attrition_numeric\"] == 1]\nattrition_no = df.loc[df[\"Attrition_numeric\"] == 0]\n","7ce40a87":"# I use concat to join the two DF, rename the columns and then give it some color :)\ndf_mean_attrition = pd.concat((attrition_yes.mean(),attrition_no.mean()),axis=1)\ndf_mean_attrition.columns = [\"Yes\",\"No\"]\ndf_mean_attrition.round(2).style.background_gradient(cmap=\"tab20_r\",axis=1)","47c6637a":"tasa_att = (df[\"Attrition_numeric\"].sum() \/ df.shape[0]) * 100\nprint(\"Average Turnover rate at IBM is :\",round(tasa_att,2))","02b8eda7":"# let,s plot \"Attrition frecuency\"\ncolors = [\"#C0EDD2\",\"#FF0018\"]\ndf_class = df[\"Attrition_numeric\"].value_counts().reset_index()\nplt.figure(figsize=(6,3))\nax = sns.barplot(x=\"index\",y=\"Attrition_numeric\",data=df_class,palette=colors)\nsns.despine()\n# another way to make titles more personalized\n# plt.title(\"$\\\\bf{Attrition frecuency}$\" +\"\\nIsn't this an example of unbalanced classes?\")\nax.text(-0.5,1450,\"Attrition frecuency\",\n        fontsize=15,        \n         fontweight='bold') \nax.text(-0.5,1350,\"Isn't this an example of unbalanced classes?\",\n        fontsize=11)\n# with a loop I add the values to the graphic text(x,y,s=\"values\")\nfor num,text in enumerate(df_class[\"Attrition_numeric\"]):\n        ax.text(num,text-100,text)\nplt.xlabel(\"Attrition\")\nplt.ylabel(\"Frecuency\")\n# so only the graphic appears without any text referring to the object type.\nplt.show(block=False)","d7234ff3":"# numeric and categoric\nnum_col = df.describe().columns.tolist()\ncat_col = df.describe(include=\"object\").columns.tolist()","53317baf":"## corr\ncorr = df[num_col].corr()","f02d4893":"ax = sns.heatmap(\n    corr, \n    vmin=-1, vmax=1, center=0,\n    cmap=\"Blues\",\n    square=True,xticklabels=False, yticklabels=False)\n#plt.title(\"HeatMap of all the Feature Variables\",fontweight=\"bold\")\nax.text(0,-2.2,\"HeatMap\",\n        fontsize=15,        \n         fontweight='bold') \nax.text(0,-.7,\"Are you telling me that we have Multicollinearity ?\",\n        fontsize=11)      \n         \n         \n\nplt.show(block=False)","14d530dc":"#to_frame().style.background_gradient(cmap='viridis')\ncorr[\"Attrition_numeric\"].to_frame().style.background_gradient(cmap=\"Blues\") #sns.diverging_palette(150,80,n=200,as_cmap=True))","02d46aba":"df.describe(include=\"object\").T","5a3b07ed":"# groupby\nby_bussines =df.groupby(\"BusinessTravel\")[\"Attrition_numeric\"].value_counts(normalize=True).to_frame().unstack()","805d003f":"by_bussines","5f723b33":"# bussines travel\n#colors = [\"#C0EDD2\",\"#FF0018\"]\nplt.figure(figsize=(6,4))\nax= sns.barplot(x=by_bussines.index,y=('Attrition_numeric', 0),data=by_bussines,color=\"#C0EDD2\",label=\"Atrition 0\")\nsns.barplot(x=by_bussines.index,y=('Attrition_numeric', 1),data=by_bussines,color=\"#FF0018\",label=\"Atrition 1\")\nplt.ylabel('')\nplt.ylabel(\"Attrition,s Percentage\")\nplt.xlabel(\"\")\nplt.grid(False)\nsns.despine()\nplt.legend()\n# using text to personalize title\nax.text(-.5,1.13,\"Relationship between Attrition and BusinessTravel\",\n        fontsize=15,        \n         fontweight='bold') \nax.text(-.5,1.06,\"Spending a lot of time in airports can be stressful?\",\n        fontsize=12)   \nplt.show(block=False)","0745c03b":"df.pivot_table(\"Attrition_numeric\",index=\"JobRole\",columns=[\"BusinessTravel\"])","6f755b4d":"# groupby by jobrole (to_frame and unstack it's not necessary, I did it this way because I was playing with dataframe and colors.)\nby_jobRole =df.groupby(\"JobRole\")[\"Attrition_numeric\"].value_counts(normalize=True).to_frame().unstack()\n","d955871f":"#plot\nplt.figure(figsize=(8,4))\nax=sns.barplot(y=by_jobRole.index,x=('Attrition_numeric', 0),data=by_jobRole,color=\"#C0EDD2\",label=\"Atrition 0\")\nsns.barplot(y=by_jobRole.index,x=('Attrition_numeric', 1),data=by_jobRole,color=\"#FF0018\",label=\"Atrition 1\")\n\n\nplt.ylabel(\"\")\nplt.xlabel(\"Attrition,s Percentage\")\nplt.grid(False)\nsns.despine()\nplt.legend()\nax.text(0,-2,\"Job Roles and Attriction cases\",\n        fontsize=15,        \n         fontweight='bold') \nax.text(0,-1.4,\"Who wants to work as Research Director?\",\n        fontsize=12)\n# with a loop I add the values to the graphic\nfor num,text in zip(range(9),round(by_jobRole['Attrition_numeric', 1],2)):\n    ax.text(text,num,text)\nplt.show(block=False)","d7904ec9":"by_department =df.groupby(\"Department\")[\"Attrition_numeric\"].value_counts(normalize=True).to_frame().unstack()\n# by_department.style.background_gradient(cmap='Blues',axis=0) thats other way to visualize the data","26bc36c6":"#department\n#colors = [\"#C0EDD2\",\"#FF0018\"]\nplt.figure(figsize=(8,4))\nsns.barplot(x=by_department.index,y=('Attrition_numeric', 0),data=by_department,color=\"#C0EDD2\",label=\"Atrition 0\")\nsns.barplot(x=by_department.index,y=('Attrition_numeric', 1),data=by_department,color=\"#FF0018\",label=\"Atrition 1\")\nplt.ylabel('')\nplt.title(\"Departments and Attriction cases\",fontweight=\"bold\")\nplt.xlabel(\"\")\nplt.ylabel(\"Attrition,s Percentage\")\nplt.grid(False)\nplt.legend()\nsns.despine()","aaf55320":"cut_age = pd.cut(df[\"Age\"],bins=[18,30,50,60],include_lowest=False)\ndf.groupby(cut_age)[\"Attrition_numeric\"].value_counts(normalize=True).unstack()","379c3c04":"# age\nplt.figure(figsize=(6,4))\nax = sns.distplot(attrition_yes[\"Age\"],hist=False,label=\"Yes\",color=\"r\")\nax = sns.distplot(attrition_no[\"Age\"],hist=False,label=\"No\",color=\"#C0EDD2\")\n\nplt.ylabel(\"Density\")\nplt.legend()\n# Get the two lines from the axes to generate shading\nl1 = ax.lines[0]\nl2 = ax.lines[1]\n\n# Get the xy data from the lines so that we can shade\nx1 = l1.get_xydata()[:,0]\ny1 = l1.get_xydata()[:,1]\nx2 = l2.get_xydata()[:,0]\ny2 = l2.get_xydata()[:,1]\nax.fill_between(x1,y1, color=\"red\", alpha=0.3)\nax.fill_between(x2,y2, color=\"#C0EDD2\", alpha=0.3)\nsns.despine()\nax.text(5,0.064,\"Age Density Distribution by Attrition\",\n        fontsize=15,        \n         fontweight='bold') \nax.text(5,0.06,\"The older you get, the less you want to change jobs?\",\n        fontsize=12) \nplt.show(block=False)","16830f08":"# marital status and gender\n#colors = [\"#C0EDD2\",\"#FF0018\"]\nplt.figure(figsize=(14,6))\nplt.suptitle('OverTime,Gender and Marital Status versus Attrition,s Percentage',fontweight=\"bold\",fontsize=18,y=1.0)\n\nfor i,column in enumerate([\"Gender\",\"MaritalStatus\",\"OverTime\"],1):\n    group =df.groupby(column)[\"Attrition_numeric\"].value_counts(normalize=True).to_frame().unstack()\n\n    plt.subplot(1, 3,i)\n    sns.barplot(x=group.index,y=('Attrition_numeric', 0),data=group,color=\"#C0EDD2\",label=\"Atrition 0\")\n    sns.barplot(x=group.index,y=('Attrition_numeric', 1),data=group,color=\"#FF0018\",label=\"Atrition 1\")\n    if i == 1:\n        plt.ylabel(\"Attrition,s Percentage\",fontweight=\"bold\")\n    else:\n        plt.ylabel(\"\",fontweight=\"bold\")\n    plt.xlabel(column,fontweight=\"bold\")\n    plt.legend()\n    plt.grid(False) \n    \n    \n","9a6592ff":"plt.figure(figsize=(7,3))\nax = sns.distplot(attrition_yes[\"DistanceFromHome\"],hist=False,label=\"Yes\",color=\"r\")\nax = sns.distplot(attrition_no[\"DistanceFromHome\"],hist=False,label=\"No\",color=\"#C0EDD2\")\n\nplt.ylabel(\"Density\")\nplt.legend()\n# Get the two lines from the axes to generate shading\nl1 = ax.lines[0]\nl2 = ax.lines[1]\n\n# Get the xy data from the lines so that we can shade\nx1 = l1.get_xydata()[:,0]\ny1 = l1.get_xydata()[:,1]\nx2 = l2.get_xydata()[:,0]\ny2 = l2.get_xydata()[:,1]\nax.fill_between(x1,y1, color=\"red\", alpha=0.3)\nax.fill_between(x2,y2, color=\"#C0EDD2\", alpha=0.3)\nsns.despine()\nax.text(-11.35,0.093,\"DistanceFromHome Density Distribution by Attrition\",\n        fontsize=15,        \n         fontweight='bold') \nax.text(-11.35,0.086,\"Is it hard to go to work when your home is so far away?\",\n        fontsize=12)\nplt.show(block=False)","6c0dd207":"cut_distance = pd.cut(df[\"DistanceFromHome\"],bins=[1,10,20,30],include_lowest=False)\ndf.groupby(cut_distance)[\"Attrition_numeric\"].value_counts(normalize=True).unstack()","296b024c":"ax = sns.boxplot(x=\"Gender\",y='MonthlyIncome',data=df,palette={\"Female\":\"red\",\"Male\":\"#C0EDD2\"})\nsns.despine()\nformatter = ticker.FormatStrFormatter('$%1.2f')\nax.yaxis.set_major_formatter(formatter)\n#plt.title(\"MonthlyIncome by Gender\",fontweight=\"bold\")\n#plt.title(\"$\\\\bf{MonthlyIncome by Gender}$\" +\"\\nShouldn't equality be the norm in all companies??\")\nax.text(-0.5,24150,\"MonthlyIncome by Gender\",\n        fontsize=15,        \n         fontweight='bold') \nax.text(-0.5,22550,\"Shouldn't equality be the norm in all companies?\",\n        fontsize=12)\nplt.show(block=False)","6ae52b0e":"df.pivot_table('MonthlyIncome',index=\"JobRole\",columns=\"Gender\")\n","dab94c04":"jobrole_income = df.groupby(\"JobRole\")[\"MonthlyIncome\"].describe()\n#obrole_income.style.background_gradient(cmap='Blues',axis=0)","13cfb23d":"job_income_mean = jobrole_income[\"mean\"].reset_index().sort_values(by=\"mean\",ascending=False)\n\n\nplt.figure(figsize=(8,4))\nax = sns.barplot(y=\"JobRole\",x=\"mean\",data=job_income_mean,color=\"#C0EDD2\")\n# with axvline we can draw a vertical line\nax.axvline(df['MonthlyIncome'].mean(),color=\"red\")\n\nplt.ylabel(\"\")\nplt.xlabel(\"\")\nplt.grid(False)\nsns.despine()\n# add $ to axis\nformatter = ticker.FormatStrFormatter('$%1.2f')\nax.xaxis.set_major_formatter(formatter)\n# add text anotation\nax.text(7300, 8, \"IBM MonthlyIncome,s Mean\", horizontalalignment='left', size='medium', color='black', weight='semibold')\nfor text,num in zip(round(job_income_mean[\"mean\"],2),range(9)):\n    ax.text(text,num,text)\nax.text(-0.3,-2,\"Job Roles MonthlyIncome's mean\",\n        fontsize=15,        \n         fontweight='bold') \nax.text(-0.3,-1.4,\"Is it good to work in the Sales department?\",\n        fontsize=12) \nplt.show(block=False)\n","3396bd5d":"\nax=sns.relplot(x='TotalWorkingYears', y='MonthlyIncome', hue='Attrition_numeric', size='JobSatisfaction',\n            sizes=(40, 400), alpha=.5, palette=\"muted\",\n            height=5, data=df)\nsns.despine()\nplt.title(\"$\\\\bf{MonthlyIncome and TotalWorkingYears}$\" +\"\\nDoes money make us happier?\")\n \nplt.show(block=False)\n\n\n","9dcd6d2b":"cut_income = pd.cut(df[\"MonthlyIncome\"],bins=[1000,5000,10000,15000,20000],include_lowest=False)\ncut_years= pd.cut(df['TotalWorkingYears'],bins=[0,10,20,30,40],include_lowest=False)\ndf.pivot_table('Attrition_numeric',index=cut_income,columns=cut_years)\n","8a270f3c":"### Monthly Income\n\nmoney influences? first we will look at the salary by gender and by JobRoles; in this fictitious company there is no significant difference between the two genders. ","467e51f9":"Let's make a quick summary of the variables and see what we find \u00a1","e25908d5":"Several things stand out here:\n\n* after 20 years of work in the company there is a significant salary increase\n\n* the degree of satisfaction is fairly evenly distributed, so we will have to look at it in more detail.\n\n* the vast majority of workers seem to be between $10,000 and 20 years of service\n\n*  The $10,000 salary seems to be a good indicator in this respect to the attrition rate, since above it seems that there is less","54c210d8":"I am going to separate the numerical columns from the categorical columns; using describe makes it very easy ","a0d1b6f0":"### Characteristics of employees who want to leave the IBM company\n\n* They tend to be younger, 33 years old on average, they tend to live farther from work, they are less satisfied with the work environment, they have lower incomes (everything is correlated because it is normal to earn more the more years you are in the company).\n* They have been working less years, they have less rights to stock options (as before, the more years in the company, the more rights you have).","da73aab1":"we see that there is Multicollinearity; it is normal because there are variables that are related to each other, for example salary and working years. Further on we will see which are the most important variables, for example using a PCA.","78a5a541":"These columns are of no use to us, throw them away!","7ca4eec7":" Gender does not influence much, but being single and working a lot of overtime are important factors to take into account.","29da0c97":"We are going to separate the workers into two dataframes according to Attrition and compare their averages","f0f5d1b5":"Ummmm the average is very high compared to what would be normal, we will have to keep on working...this also represents a problem when making predictions since the classes are not balanced.","78a2be03":"Do we have null values ?","21b9a1da":"we are going to make a graph that reflects salaries, years worked in the company, satisfaction level and  the attrition rate","2aecebd0":"Image https:\/\/unsplash.com\/@anniespratt","cf8c599e":"### What does employee attrition mean?\nThe attrition rate is a calculation of the number of individuals that leave or move out of a business over a specified time frame.\n\n### What is the difference between employee turnover and attrition?\nBoth terms are used when an employee leaves a company but with a difference in processes, such as discharge, termination, or resignation. Attrition occurs when an employee retires or when the employer terminates the job position. When employee turnover occurs, the employers look for a replacement.\n\n### What is a good employee attrition rate?\nA good, average turnover rate is around 10%.\n\n### What are some effective methods to reduce a high attrition rate?\n* Recruit and hire the right people.\n* Offer benefits and compensation.\n* Offer flexibility.\n* Pay attention to employee engagement.\n* Recognize and reward employees.","2b3b7499":"### IBM HR Analytics Employee Attrition & Performance","6696d0bf":"Let's convert our output variable from categorical to numerical","0a9e6fc6":"Now, the correlation with respect to our output variable; we see interesting things that affect directly proportional as DistanceFromHome,NumCompaniesWorked and indirectly proportional as ,for example,MonthlyIncome,TotalWorkingYears,YearsWithCurrManager and Age","135a661a":"### Age\n\nlet's look at age!  the attrition rate is higher in younger people.\n\nFirst we use the cut function to create four groups according to their ages and then groupby and value counts(normalize) to see the percentages. between 18 and 30 the attrition rate  is the highest!","272fb785":"we can see that among the sales representatives who travel a lot, 65 percent are not very happy; and it is also significant in Human resources: there are 40 percent of the employees who travel a lot who are not very happy either.\n\nLet's check by department what the the attrition rate is ","f46ece3d":"now let's look at the salaries by department and their relation to the average of the whole company ","9b39835c":"well this has been an exploratory analysis where we have seen significant aspects regarding the attrition rate in a company; now we need to use machine learning to try to be able to predict it... but that will be for another time when I have more time.\nI hope you liked it and please, if you have any comments, advice, criticism and help do not hesitate to write it in the comments !","5df6ab83":"Well, let's get down to work then, let's see what's going on at IBM!","c18a81b3":"with pd.cut I have made groups in both MonthlyIncome and TotalWorkingYears and with pd.pivot_table I relate them to each other.\n\n* workers who have worked up to 10 years and with a salary up to $5000 have a higher attrition rate.\n\n* and those who have been working for 30 to 40 years with a salary between $10,000 and $15,000 also have a significant attrition rate as we saw in the graph.\n","3a2716a6":"* The average age is 36 years, there are very young people with 18 years (young trainees or interns?) and people with 60 years (managers with many years of work?).\n* There are people who live very close to work, almost next door, and others are almost an hour's drive away!\n* Salaries are a world of their own! The average is 6500 usd, the lowest earners reach 1000 usd (the young trainees?) and the highest earners almost 20000 usd (that 60 year old boss with many years behind him?).\n* There are employees who have been working for almost 40 years and others who have just started! The average, however, is 7 years (I don't think that's bad at all).","441845a2":"### A quick summary of the categorical variables!","dfa77047":"Working far away from home is also important, here we see that from 10 km away it begins to be noticed in the attrition rate ","11a75ada":"We see that the most frequent in this company is a person who travels rarely, from the Research & Development department , educated in Life Sciences , gender Male, Married, Sales Executive and no OverTIme","f44bbe9b":"There are three departments where the attrition rate it is higher than usual: Sales Representative,Human Resources and Laboratoy Thecnician","96cf07f6":"### Visualizing data is always a great help, let's get to it!\n\nI want to see if traveling a lot for work has any effect on employee morale.","b6bb781a":"Attrition is the silent killer that can swiftly disable even the most successful and stable of organizations in a shockingly spare amount of time. While many companies put an emphasis on the costly process of hiring and recruiting, there isn\u2019t enough attention invested in solving the issues that cause top talent to leave. Although compensation is the most commonly associated reason behind attrition, let's make an analysis to see if this is really one of the most important motives \u00a1\u00a1\u00a1\n\nUnderstanding the motivations behind employee attrition is the essential first step in understanding the problem and properly addressing it before substantial, long-lasting damage is caused to your organization. Thankfully, with this EDA we will be able to provide employers the actionable insights they need to better understand their employees and make any necessary changes before turnover rates swell, productivity drops, and the entire company\u2019s future is suddenly less bright.","83dcd6f5":"well, we can see that among employees who travel a lot, the attrition rate is much higher. Let's make a pivot table to check the data more thoroughly","dc4db4cc":"### What is a good employee attrition rate?\nA good average turnover rate is around 10%.\n","c6ab8786":"### Detecting Multicollinearity\nI will make a heatmap to see the correlation between the variables. ","914ca3ea":"we find that as the distance increases, the attrition rate rises from 14 to 22 percent.","ced9bd9e":"with the cut function I will make three groups: those who live up to 10,20 and 30 km away from work; then we make groupby and with value counts (normalize) we see the percentages in relation to Attriction"}}