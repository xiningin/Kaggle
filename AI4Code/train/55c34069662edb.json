{"cell_type":{"85c064dc":"code","e621024b":"code","d122b472":"code","5792844c":"code","9b8acfe7":"code","13b92e03":"code","c24267a9":"code","4cf55813":"code","de7b9243":"code","661d5911":"code","ab637415":"code","6ceda968":"code","405698d4":"code","6b8e29ae":"code","70073b89":"code","5fb20918":"code","6d5c58e5":"code","789b6d95":"code","b3743853":"code","5c5b9587":"code","f7532d03":"code","921c9016":"code","680d6eb4":"code","0bd9ade9":"markdown","574ad3b8":"markdown","b4300e5d":"markdown","547011ab":"markdown","197cb49d":"markdown","4b8a861f":"markdown","bcc9b467":"markdown","624dd09a":"markdown","37553d85":"markdown","5bb106bf":"markdown","adab07b7":"markdown","63372ca5":"markdown","115b226f":"markdown","d9b809d5":"markdown","00c4f654":"markdown","f2f336e4":"markdown"},"source":{"85c064dc":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","e621024b":"import numpy as np\nimport pandas as pd\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set_style(\"dark\")\n\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.metrics import classification_report\nfrom sklearn.metrics import plot_confusion_matrix\n\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.svm import SVC\n\nimport pickle\n\nimport warnings\nwarnings.filterwarnings(\"ignore\")","d122b472":"data = pd.read_csv('..\/input\/mushroom-classification\/mushrooms.csv')\ndata.info()","5792844c":"data.head()","9b8acfe7":"# Unique values in columns\nfor column in data.columns:\n    print(f\"{column} : {data[column].unique()}\")","13b92e03":"mapped_data = data.copy()\nfeature_name_mappings = {\n    \"class\":{'e':'edible','p':'poisonous'},\n    \"cap-shape\": {'b':\"bell\",\"c\":\"conical\",\"x\":\"convex\",\"f\":\"flat\", \"k\":\"knobbed\",\"s\":\"sunken\"},\n    'cap-surface': {'f':\"fibrous\",\"g\":\"grooves\",\"y\":\"scaly\",\"s\":\"smooth\"},\n    \"cap-color\": {'n':\"brown\",'b':'buff','c':'cinnamon','g':'gray','r':\"green\",'p':'pink','u':'purple','e':'red','w':'white','y':'yellow'},\n    \"bruises\":{'t': 'bruises', 'f': 'no'},\n    \"odor\":{'a': 'almond', 'l': 'anise', 'c': 'creosote', 'y': 'fishy', 'f': 'foul', 'm': 'musty', 'n': 'none', 'p': 'pungent', 's': 'spicy'},\n    \"gill-attachment\":{'a': 'attached', 'd': 'descending', 'f': 'free', 'n': 'notched'},\n    \"gill-spacing\":{'c': 'close', 'w': 'crowded', 'd': 'distant'},\n    \"gill-size\":{'b': 'broad', 'n': 'narrow'},\n    \"gill-color\":{'k': 'black', 'n': 'brown', 'b': 'buff', 'h': 'chocolate', 'g': 'gray', 'r': ' green', 'o': 'orange', 'p': 'pink', 'u': 'purple', 'e': 'red', 'w': 'white', 'y': 'yellow'},\n    \"stalk-shape\":{'e': 'enlarging', 't': 'tapering'},\n    \"stalk-root\":{'b': 'bulbous', 'c': 'club', 'u': 'cup', 'e': 'equal', 'z': 'rhizomorphs', 'r': 'rooted', '?': 'missing'},\n    \"stalk-surface-above-ring\":{'f': 'fibrous', 'y': 'scaly', 'k': 'silky', 's': 'smooth'},\n    \"stalk-surface-below-ring\":{'f': 'fibrous', 'y': 'scaly', 'k': 'silky', 's': 'smooth'},\n    \"stalk-color-above-ring\":{'n': 'brown', 'b': 'buff', 'c': 'cinnamon', 'g': 'gray', 'o': 'orange', 'p': 'pink', 'e': 'red', 'w': 'white', 'y': 'yellow'},\n    \"stalk-color-below-ring\":{'n': 'brown', 'b': 'buff', 'c': 'cinnamon', 'g': 'gray', 'o': 'orange', 'p': 'pink', 'e': 'red', 'w': 'white', 'y': 'yellow'},\n    \"veil-type\":{'p': 'partial', 'u': 'universal'},\n    \"veil-color\":{'n': 'brown', 'o': 'orange', 'w': 'white', 'y': 'yellow'},\n    \"ring-number\":{'n': 'none', 'o': 'one', 't': 'two'},\n    \"ring-type\":{'c': 'cobwebby', 'e': 'evanescent', 'f': 'flaring', 'l': 'large', 'n': 'none', 'p': 'pendant', 's': 'sheathing', 'z': 'zone'},\n    \"spore-print-color\":{'k': 'black', 'n': 'brown', 'b': 'buff', 'h': 'chocolate', 'r': 'green', 'o': 'orange', 'u': 'purple', 'w': 'white', 'y': 'yellow'},\n    \"population\":{'a': 'abundant', 'c': 'clustered', 'n': 'numerous', 's': 'scattered', 'v': 'several', 'y': 'solitary'},\n    \"habitat\":{'g': 'grasses', 'l': 'leaves', 'm': 'meadows', 'p': 'paths', 'u': 'urban', 'w': 'waste', 'd': 'woods'}\n}\nfor column in mapped_data.columns:\n    mapping_dict = feature_name_mappings[column]\n    for index in range(len(mapped_data[column])):\n        mapped_data[column][index] = mapping_dict[mapped_data[column][index]]","c24267a9":"mapped_data.head()","4cf55813":"plt.figure(figsize = (8,6))\nsns.countplot(x = 'class',data = mapped_data,palette = 'hls')","de7b9243":"mapped_data.columns","661d5911":"fig=plt.figure(figsize = (14,22)) \ncolumns = 2\nrows = 5 \ncolumn_names = ['cap-shape', 'cap-surface', 'cap-color', 'veil-color', 'odor',\n       'ring-type', 'spore-print-color', 'stalk-color-above-ring', 'gill-color',\n       'stalk-color-below-ring']\nfor i in range(1, columns*rows +1): \n    fig.add_subplot(rows, columns, i) \n    sns.countplot(x = column_names[i-1],data = mapped_data,palette = 'hls')\nfig.tight_layout()\nplt.show() ","ab637415":"fig=plt.figure(figsize = (20,20)) \ncolumns = 2\nrows = 6 \ncolumn_names = ['stalk-root', 'stalk-surface-above-ring',\n       'stalk-surface-below-ring', 'gill-size',\n       'stalk-shape', 'veil-type', 'bruises', 'ring-number',\n       'gill-attachment', 'gill-spacing', 'population', 'habitat']\nfor i in range(1, columns*rows +1): \n    names = []\n    counts = []\n    for idx, name in enumerate(mapped_data[column_names[i-1]].value_counts().index.tolist()):\n        names.append(name)\n        counts.append(mapped_data[column_names[i-1]].value_counts()[idx])\n    fig.add_subplot(rows, columns, i) \n    colors = sns.color_palette('pastel')[0:len(names)]\n    plt.title(column_names[i-1])\n    plt.pie(x = counts,labels = names,colors = colors,autopct='%.0f%%')\nfig.tight_layout()\nplt.show() ","6ceda968":"#Save Encoders so if you want to get predictions on new data you will need to encode it first\nencoders = {}\nencoded_data = mapped_data.copy()\nfor feature_name in list(encoded_data.columns):\n    encoder = LabelEncoder()\n    encoder.fit(encoded_data[feature_name])\n    encoders[feature_name] = encoder\n    encoded_data[feature_name] = encoder.transform(encoded_data[feature_name])","405698d4":"for column in encoded_data.columns:\n    print(f\"{column} : {encoded_data[column].unique()}\")","6b8e29ae":"X = encoded_data.drop('class',axis = 1)\nY = encoded_data['class']","70073b89":"X","5fb20918":"xtrain, xtest,ytrain,ytest = train_test_split(X,Y,test_size = (0.3))","6d5c58e5":"svm = SVC()\nrandom_forest = RandomForestClassifier()","789b6d95":"def trainModel(model):\n    model.fit(xtrain,ytrain)\n    return model.score(xtest,ytest)\nmodels = {\n    \"SVM\":svm,\n    \"Random Forest\" :random_forest\n}\nprint('Accuracy')\nfor model in list(models.keys()):\n    print(f\"{model} : {round(trainModel(models[model])*100,2)}%\")","b3743853":"scores = cross_val_score(svm, X, Y, cv=5)\n\nplt.plot(scores)\nplt.title('Validation Scores for SVM')\nplt.xticks([0,1,2,3,4])\nplt.ylabel('Score')\nplt.show()","5c5b9587":"scores = cross_val_score(random_forest, X, Y, cv=5)\n\nplt.plot(scores)\nplt.title('Validation Scores for Random Forest')\nplt.xticks([0,1,2,3,4])\nplt.ylabel('Score')\nplt.show()","f7532d03":"param_grid = {'C': [0.1, 1, 10, 100],  \n              'gamma': [1, 0.1, 0.01, 0.0001], \n              'gamma':['scale', 'auto'],\n              'kernel': ['linear']}  \n   \ngrid = GridSearchCV(SVC(), param_grid, refit = True, verbose = 3,n_jobs=-1) \ngrid.fit(xtrain, ytrain) \nprint(grid.best_params_)\ngrid_predictions = grid.predict(xtest) \n\nprint(classification_report(ytest, grid_predictions))","921c9016":"svm = SVC(C= 10, gamma= 'scale', kernel= 'linear')\nsvm.fit(xtrain,ytrain)\nplot_confusion_matrix(svm, xtest, ytest, cmap=plt.get_cmap('Blues'))","680d6eb4":"pickle.dump(svm, open('MushroomSafetySVM.sav', 'wb'))","0bd9ade9":"# **Feature Engineering and Data Preprocessing**","574ad3b8":"## Mapping the feature values to their real values\n*Note : I don't recommend hard coding these values, I used a python script to give me the mapping dicionary*","b4300e5d":"### We have poor accuracy for first and last fold. Let's try to see if we can solve that using hyperparameter tuning.","547011ab":"# Saving the model","197cb49d":"# **Exploratory Data Analysis**","4b8a861f":"### There seems to be no null values in the data and all the 23 columns have values represented by english alphabets, we will see what these lettes mean later. As far as the data description goes this is enough for us to start exploring the data.","bcc9b467":"## **Goal**\n### Generating a model using machine learning to evaluate the safety of a species of Mushroom|","624dd09a":"# **Setup and Imports**","37553d85":"# **Safe to eat or deadly poision**\n#### A mushroom or toadstool is the fleshy, spore-bearing fruiting body of a fungus, typically produced above ground, on soil, or on its food source. There are many species of mushrooms and some of the can be deadly. Knowing if a mushroom is poisonous or not is a very important thing as it is a matter of life or death. In this notebook I will use data science and machine learning to generate a model which is capable of telling if the mushroom is edible or not.\n![ ]( https:\/\/images.wallpaperscraft.com\/image\/mushroom_close_up_autumn_foliage_112652_2560x1024.jpg )","5bb106bf":"#### Splitting the data is very important, you don't want to test the model on the data which it has already seen.","adab07b7":"# **Reading data and data description**","63372ca5":"### Value Counts","115b226f":"#### All the best params are default params so we don't need to tune anything","d9b809d5":"### We are getting accuracy of 100% with thes models and it shows how good the data is. We don't need to tune any hyperparameters and re train the model.\n### Let's validate our model even more","00c4f654":"# **Training different ML Models**","f2f336e4":"# **Potential Steps to reach the goal**\n#### 1. Finding appropriate data for training.\n#### 2. Data Analysis.\n#### 3. Feature Engineering.\n#### 4. Data Preprocessing.\n#### 5. Select the best and most useful features.\n#### 6. Training an ML model.\n#### 7. Looking at feature importance and remove the least useful features.\n#### 8. Hyperparameter Tuning.\n#### 9. Re-training the model using best features and best hyperparameters\n#### 10.Model Validation.\n#### 11.Evaluating the model.\n#### 12.Saving the model for later use or deployment.\n\n*Note : It is important to roughly know the steps you are going to follow, these steps may change as we dig deeper into the dataset*"}}