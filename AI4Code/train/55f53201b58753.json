{"cell_type":{"6858b3c4":"code","b242a14c":"code","4915aa95":"code","68648b53":"code","be82d105":"code","f77aff06":"code","de8033a8":"code","922387b6":"code","5843aa9b":"code","ea38abfd":"code","f7aa12bb":"code","76826bd5":"code","2d55ec99":"code","f7bcbfb8":"code","ecb68839":"code","0c39b0f3":"code","fe0966c3":"code","1d91bbcb":"code","93ca8ceb":"code","4e4566fd":"code","69995175":"code","1305f90e":"code","76b53dd8":"code","86d0400d":"code","8ec185b4":"markdown","a01568ea":"markdown","96e1d385":"markdown","4482bb5a":"markdown","d6902401":"markdown","224899c3":"markdown","c2a05c2c":"markdown","7485e815":"markdown","f1fcb6b1":"markdown","24a6e80f":"markdown","e1d173ff":"markdown","06688204":"markdown","24f2171c":"markdown","da25bfd4":"markdown","79a17047":"markdown","21925d97":"markdown","75d9f874":"markdown","a418bf7b":"markdown"},"source":{"6858b3c4":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import StandardScaler\n\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.svm import SVC\n\nfrom sklearn.metrics import classification_report","b242a14c":"data_path = '\/kaggle\/input\/heart-disease-uci-dataset\/heart.csv'\n\ndf = pd.read_csv(data_path)\ndf.head()","4915aa95":"df.info()","68648b53":"df.describe()","be82d105":"df.columns","f77aff06":"new_columns = [col.replace(' ', '_') for col in df.columns]\ndf.columns = new_columns\nnew_columns","de8033a8":"plt.figure(figsize=(10,10))\nsns.heatmap(df.corr(), cmap=\"YlGnBu\");","922387b6":"df_presence = df[df.Presence == 2]\ndf_absence = df[df.Presence == 1]\n\ndf_sex_0 = df[df.Sex == 0]\ndf_sex_1 = df[df.Sex == 1]","5843aa9b":"sex_0 = df_presence[df_presence.Sex == 0]\nsex_1 = df_presence[df_presence.Sex == 1]\nplt.figure(figsize=(15,5))\nplt.title(\"Age distribution of the presence of heart disease by gender\")\nsns.kdeplot(data=sex_0['Age'], shade=True, label='Sex_0');\nsns.kdeplot(data=sex_1['Age'], shade=True, label='Sex_1');","ea38abfd":"plt.subplots(figsize=(15, 5))\nplt.title('Female and man with heart disease')\nsns.countplot(y=\"Sex\", data=df_presence, color=\"c\");","f7aa12bb":"plt.subplots(figsize=(15, 5))\nsns.countplot(y=\"Chest_Pain_type\", data=df_presence, color=\"c\");","76826bd5":"pain_1 = df_presence[df_presence.Chest_Pain_type == 1]\npain_2 = df_presence[df_presence.Chest_Pain_type == 2]\npain_3 = df_presence[df_presence.Chest_Pain_type == 3]\npain_4 = df_presence[df_presence.Chest_Pain_type == 4]\n\nplt.figure(figsize=(15,5))\nplt.title(\"Chest pain distribution of the presence of heart disease by gender\")\nsns.kdeplot(data=pain_1['Age'], shade=True, label='Pain 1');\nsns.kdeplot(data=pain_2['Age'], shade=True, label='Pain 2');\nsns.kdeplot(data=pain_3['Age'], shade=True, label='Pain 3');\nsns.kdeplot(data=pain_4['Age'], shade=True, label='Pain 3');","2d55ec99":"plt.figure(figsize=(15,5))\nplt.title(\"Mean resting blood pressure for sex 0\")\nplt.xlabel('Age')\nplt.ylabel('Resting blood pressure')\ndata = df[df.Sex == 0]\n\nsns.lineplot(\n    data=data[data.Presence == 2].groupby(['Age'])['Resting_Blood_pressure'].mean(), \n    label='Presence'\n);\n\nsns.lineplot(\n    data=data[data.Presence == 1].groupby(['Age'])['Resting_Blood_pressure'].mean(), \n    label='Absence'\n);","f7bcbfb8":"plt.figure(figsize=(15,5))\nplt.title(\"Mean resting blood pressure for sex 1\")\nplt.xlabel('Age')\nplt.ylabel('Resting blood pressure')\ndata = df[df.Sex == 1]\n\nsns.lineplot(\n    data=data[data.Presence == 2].groupby(['Age'])['Resting_Blood_pressure'].mean(), \n    label='Presence'\n);\n\nsns.lineplot(\n    data=data[data.Presence == 1].groupby(['Age'])['Resting_Blood_pressure'].mean(), \n    label='Absence'\n);","ecb68839":"plt.figure(figsize=(15, 10))\nsns.scatterplot(x=\"Age\", y=\"Serum_Cholestoral_in_mg\/dl\", hue=\"Presence\", palette=\"Set1\", data=df);","0c39b0f3":"num_features = len(df.columns) - 1\nX, y = df.iloc[:, :-1].values, df.iloc[:, -1].values\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3)\nsc = StandardScaler()\nX_train_std = sc.fit_transform(X_train)\nX_test_std = sc.transform(X_test)","fe0966c3":"cov_mat = np.cov(X_train_std.T)\neigen_vals, eigen_vecs = np.linalg.eig(cov_mat)\nprint('Eigen vals: {}'.format(eigen_vals))","1d91bbcb":"tot = sum(eigen_vals)\nvar_exp = [(i \/ tot) for i in sorted(eigen_vals, reverse=True)]\ncum_var_exp = np.cumsum(var_exp)\n\nplt.figure(figsize=(15,5))\nplt.bar(range(num_features), var_exp, alpha=.5, align='center', label='Single variance')\nplt.step(range(num_features), cum_var_exp, where='mid', label='Cumsum variance')\nplt.ylabel('Factor of variance')\nplt.xlabel('Main components')\nplt.legend(loc='best')\nplt.show()","93ca8ceb":"eigen_pairs = [(np.abs(eigen_vals[i]), eigen_vecs[:,i]) for i in range(len(eigen_vals))]\neigen_pairs.sort(key = lambda k: k[0], reverse=True)\nW = np.hstack((eigen_pairs[0][1][:, np.newaxis], \n               eigen_pairs[1][1][:, np.newaxis]))\nprint('Matrix W: \\n{}'.format(W))","4e4566fd":"X_train_pca = X_train_std.dot(W)\nX_test_pca = X_test_std.dot(W)","69995175":"def run_model(model, X_train, y_train, X_test, y_test):\n    model.fit(X_train, y_train)\n    y_pred = model.predict(X_test)\n    print('Report:\\n{}'.format(classification_report(y_test, y_pred)))\n    print('Score: {}'.format(model.score(X_test, y_test)))","1305f90e":"lr = LogisticRegression()\nrun_model(lr, X_train=X_train_pca, y_train=y_train, X_test=X_test_pca, y_test=y_test)","76b53dd8":"svc = SVC(kernel='linear', C=1.0, random_state=0)\nrun_model(svc, X_train=X_train_pca, y_train=y_train, X_test=X_test_pca, y_test=y_test)","86d0400d":"knn = KNeighborsClassifier(n_neighbors=20, p=2, metric='minkowski')\nrun_model(knn, X_train=X_train_pca, y_train=y_train, X_test=X_test_pca, y_test=y_test)","8ec185b4":"# PCA - Principal component analysis","a01568ea":"# tbc ...","96e1d385":"## Correlation","4482bb5a":"## Sex","d6902401":"### K-neighbors","224899c3":"## Mean resting blood pressure for sex 1","c2a05c2c":"## Chest pain type","7485e815":"**Columns**\n\n1. **Age** - Age of patient\n2. **Sex** - Sex of patient\n3. **Chest Pain type** - chest pain type (4 values)\n4. **Resting Blood pressure** - resting blood pressure\n5. **Serum Cholestoral in mg\/dl** - serum cholestoral in mg\/dl\n6. **Fasting Blood sugar > 120 mg\/dl** - fasting blood sugar > 120 mg\/dl\n7. **Resting Electrocardiographic results** - resting electrocardiographic results (values 0,1,2)\n8. **Max heart rate achieved** - maximum heart rate achieved\n9. **Exercise induced angina** - exercise induced angina\n10. **Oldpeak** - oldpeak = ST depression induced by exercise relative to rest\n11. **Slope of the peak exercise ST segment** - the slope of the peak exercise ST segment\n12. **No of major vessels** - number of major vessels (0-3) colored by flourosopy\n13. **Thal** - thal: 3 = normal; 6 = fixed defect; 7 = reversable defect\n14. **Presence** - Target :Absence (1) or presence (2) of heart disease","f1fcb6b1":"## Logistic regression","24a6e80f":"## Age distribution of the presence of heart disease by gender","e1d173ff":"# Dataset","06688204":"## Serum cholestoral in mg\/dl","24f2171c":"# Visualization","da25bfd4":"## SVC","79a17047":"## Heart disease","21925d97":"# Import","75d9f874":"## Mean resting blood pressure for sex 0","a418bf7b":"# Models"}}