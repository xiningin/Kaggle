{"cell_type":{"064ed013":"code","c1d97649":"code","2bd8330d":"code","b1237877":"code","82ddca03":"code","b397ab59":"code","3c300ac0":"code","76aa3421":"code","f70240ac":"code","b192c9dd":"markdown","aad73e41":"markdown","dde3aadc":"markdown","cfe8acbc":"markdown"},"source":{"064ed013":"import pandas as pd\nimport numpy as np\nfrom matplotlib import pyplot as plt\n%matplotlib inline\ntrain = pd.read_csv('..\/input\/digit-recognizer\/train.csv')\ntest = pd.read_csv('..\/input\/digit-recognizer\/test.csv')","c1d97649":"train.head(2)","2bd8330d":"test.head(2)","b1237877":"#\u624b\u5199\u56fe\u50cf\u67e5\u770b\nfeature = train.iloc[:,1:]\nplt.figure(figsize=(16,9))\nfor i in range(25):\n    plt.subplot(5,5,i+1)\n    plt.imshow(feature.values[i].reshape((28,28)),cmap=plt.cm.binary)","82ddca03":"feature = train.iloc[:,1:]\n#\u6570\u636e\u91cf\u592a\u5927\uff0c\u5148\u8fdb\u884c\u964d\u7ef4\u5904\u7406\nfrom sklearn.decomposition import PCA\npca = PCA(n_components=100)\nx_train_pac = pca.fit_transform(feature)\nplt.plot(pca.explained_variance_ratio_)\npca.explained_variance_ratio_.sum()","b397ab59":"y_train_pac = pca.transform(test)","3c300ac0":"# #\u7279\u5f81\u503c\u5f52\u4e00\u5316\u5904\u7406\uff0c\u8f6c\u5316\u4e3a\u4e8c\u8fdb\u5236\nx_train = np.rint(x_train_pac \/ 255)\nx_label = train['label'].astype(int)\ny_train = np.rint(y_train_pac\/ 255)","76aa3421":"from sklearn.svm import SVC\nimport warnings\nwarnings.filterwarnings('ignore')\nfrom sklearn.model_selection import StratifiedKFold,cross_val_score\nskf = StratifiedKFold(n_splits=5, shuffle=True, random_state=4)\nsvc= SVC()\nnp.mean(cross_val_score(svc,x_train,x_label,cv=skf))","f70240ac":"svc.fit(x_train,x_label)\nLabel = svc.predict(y_train)\npd.DataFrame({'ImageId':range(1,len(y_train)+1),'Label':Label}).to_csv('output.csv', index=False)","b192c9dd":"\u7b2c\u4e8c\u6b65\uff1a\u6570\u636e\u5904\u7406","aad73e41":"\u7b2c\u4e09\u6b65\uff1a\u6570\u636e\u5efa\u6a21-\u652f\u6301\u5411\u91cf\u673a\u5efa\u6a21","dde3aadc":"\u7b2c\u4e00\u6b65\uff1a\u52a0\u8f7d\u6570\u636e\u96c6","cfe8acbc":"\u53ef\u4ee5\u770b\u51fa\uff0c\u63d0\u53d6\u5230100\u9636\u65f6\uff0c\u6210\u5206\u7684\u65b9\u5dee\u5360\u6bd4\u5df2\u7ecf\u63a5\u8fd10\uff0c\u53ef\u7528\u63d0\u53d6\u7684100\u9636\u4e3b\u6210\u5206\u66ff\u4ee3\u539f\u6570\u636e"}}