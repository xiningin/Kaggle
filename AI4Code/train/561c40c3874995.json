{"cell_type":{"7dae9d7f":"code","3bd5c769":"code","8c4e14ad":"code","34fdec77":"code","d30dc020":"code","69dbc62a":"code","fe028695":"code","c825d151":"code","c5f8d661":"code","b58af6a6":"code","7209d56b":"code","52e27a0d":"code","c49eecf6":"code","cdab3004":"code","97bd595d":"code","d27225b7":"code","9cd0f343":"code","eea7d327":"code","7eb35122":"code","6bcbe73d":"code","12e79037":"code","cbdc5364":"code","8a41c15d":"code","b0eb6b42":"code","fc7e297e":"code","388779ff":"code","d6b86b48":"code","6143734e":"code","5a68294a":"code","abbc5d73":"code","4f076396":"code","18df40df":"code","247735d0":"code","e2a89bad":"code","19e8dcb0":"code","564e3d86":"code","5308dd6c":"code","f609439b":"code","bdb8344b":"code","b32ce958":"code","47b2f44d":"code","79fd7e30":"code","04902492":"code","88fb4303":"code","41ae44a0":"code","03b3e142":"code","513a5f39":"code","28d3a4a1":"code","c3929a63":"code","05f84052":"code","f470e3bc":"code","b02aed43":"code","7e4edb3d":"code","4a2c423a":"code","b548a96b":"code","69247118":"markdown","6b193eb1":"markdown","35870b95":"markdown","663d87de":"markdown","2177d572":"markdown","7ca54900":"markdown","39e8307f":"markdown","6480e627":"markdown","98debc0e":"markdown","b7dbf6bd":"markdown","6c6d4b4d":"markdown","68920f1b":"markdown","9f703b95":"markdown","ee0e53e3":"markdown","106fc14a":"markdown","4489cd35":"markdown","c42b666f":"markdown","c766f3c9":"markdown","ace12971":"markdown","e2ccf55a":"markdown","3cb22822":"markdown","581930a9":"markdown","b03b7b86":"markdown","c98432f0":"markdown","1f929ed3":"markdown","8f3c8d65":"markdown","4306b081":"markdown","c5d111ee":"markdown","42840b24":"markdown","feae5631":"markdown","31e47e3a":"markdown","7a6da6f4":"markdown"},"source":{"7dae9d7f":"import os\nimport json\n\nimport numpy as np\nimport pandas as pd\nimport seaborn as sn\nimport matplotlib.pyplot as plt\nimport cv2\nimport albumentations as A\n\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nplt.style.use('fivethirtyeight')\nsns.set_style('whitegrid')\n\n","3bd5c769":"Cassava_dir = \"..\/input\/cassava-leaf-disease-classification\/\"\nwith open(os.path.join(Cassava_dir, \"label_num_to_disease_map.json\")) as file:\n    map_classes = json.loads(file.read())\n    \nprint(json.dumps(map_classes, indent=4))","8c4e14ad":"input_files = os.listdir(os.path.join(Cassava_dir, \"train_images\"))\nprint(f\"Number of train images: {len(input_files)}\")","34fdec77":"img_shapes = {}\nfor image_name in os.listdir(os.path.join(Cassava_dir, \"train_images\"))[:300]:\n    image = cv2.imread(os.path.join(Cassava_dir, \"train_images\", image_name))\n    img_shapes[image.shape] = img_shapes.get(image.shape, 0) + 1\n\nprint(img_shapes)","d30dc020":"df = pd.read_csv(os.path.join(Cassava_dir, \"train.csv\"))\n\ndf[\"class_name\"] = df[\"label\"].astype(str).map(map_classes)\n\ndf","69dbc62a":"def show_image(image_ids, labels):\n    plt.figure(figsize=(16, 12))\n    \n    for ind, (image_id, label) in enumerate(zip(image_ids, labels)):\n        plt.subplot(3, 3, ind + 1)\n        image = cv2.imread(os.path.join(Cassava_dir, \"train_images\", image_id))\n        image = cv2.cvtColor(image, cv2.COLOR_BGR2RGB)\n\n        plt.imshow(image)\n        plt.title(f\"Class: {label}\", fontsize=12)\n        plt.axis(\"off\")\n    \n    plt.show()","fe028695":"tmp_df = df.sample(9)\nimage_ids = tmp_df[\"image_id\"].values\nlabels = tmp_df[\"class_name\"].values\n\nshow_image(image_ids, labels)","c825d151":"#masking function\ndef create_mask_for_image(image):\n    image_hsv = cv2.cvtColor(image, cv2.COLOR_BGR2HSV)\n\n    lower_hsv = np.array([0,0,250])\n    upper_hsv = np.array([250,255,255])\n    \n    mask = cv2.inRange(image_hsv, lower_hsv, upper_hsv)\n    kernel = cv2.getStructuringElement(cv2.MORPH_ELLIPSE, (11,11))\n    mask = cv2.morphologyEx(mask, cv2.MORPH_CLOSE, kernel)\n    return mask\n\n#image  deskew function\ndef  deskew_image(image):\n    mask = create_mask_for_image(image)\n    output = cv2.bitwise_and(image, image, mask = mask)\n    return output\/255\n\n#image  gray  function\ndef  gray_image(image):\n    #mask = create_mask_for_image(image)\n    output = cv2.cvtColor(image,cv2.COLOR_BGR2GRAY)\n    return output\/255\n\n#image  thresh  function\ndef  thresh_image(image):\n    gray = cv2.cvtColor(img,cv2.COLOR_BGR2GRAY)\n    output = cv2.threshold(gray,0,255,cv2.THRESH_BINARY_INV) #+cv.THRESH_OTSU)\n    return output\n\n\n#image  rnoise  function\ndef  rnoise_image(image):\n    mask = create_mask_for_image(image)\n    output = cv2.bitwise_and(image, image, mask = mask)\n    return output\/255\n\n#image  dilate  function\ndef  dilate_image(image):\n    mask = create_mask_for_image(image)\n    output = cv2.bitwise_and(image, image, mask = mask)\n    return output\/255\n\n\n#image  erode  function\ndef  erode_image(image):\n    mask = create_mask_for_image(image)\n    output = cv2.bitwise_and(image, image, mask = mask)\n    return output\/255\n\n\n\n#image  opening  function\ndef  opening_image(image):\n    mask = create_mask_for_image(image)\n    output = cv2.bitwise_and(image, image, mask = mask)\n    return output\/255\n\n#image canny function\ndef  canny_image(image):\n    mask = create_mask_for_image(image)\n    output = cv2.bitwise_and(image, image, mask = mask)\n    return output\/255\n\n\n#image segmentation function\ndef segment_image(image):\n    mask = create_mask_for_image(image)\n    output = cv2.bitwise_and(image, image, mask = mask)\n    return output\/255\n\n\n#sharpen the image\ndef sharpen_image(image):\n    image_blurred = cv2.GaussianBlur(image, (0, 0), 3)\n    image_sharp = cv2.addWeighted(image, 1.5, image_blurred, -0.5, 0)\n    return image_sharp\n\n\n# function to get an image\ndef read_img(image_id, labels):\n    plt.figure(figsize=(16, 12))\n    img = cv2.imread(os.path.join(Cassava_dir, \"train_images\", image_id))\n    #convert image to array\n    #img = image.img_to_array(img)\n    return img","c5f8d661":"nb_rows = 2\nnb_cols = 5\nfig, axs = plt.subplots(nb_rows, nb_cols, figsize=(15, 5));\nplt.suptitle('SAMPLE IMAGES');\nfor i in range(0, nb_rows):\n    for j in range(0, nb_cols):\n        axs[i, j].xaxis.set_ticklabels([]);\n        axs[i, j].yaxis.set_ticklabels([]);\n        axs[i, j].imshow((read_img(df['image_id'][np.random.randint(1400)], (255,255)))\/255.);\nplt.show();","b58af6a6":"#get an image\nimg = read_img(df['image_id'][13],(255,255))\n\n#mask\nimage_mask = create_mask_for_image(img)\n\nfig, ax = plt.subplots(1, 2, figsize=(15, 10));\nplt.suptitle('RESULT', x=0.5, y=0.8)\nplt.tight_layout(1)\n\nax[0].set_title('ORIGINAL', fontsize=12)\nax[1].set_title('MASK', fontsize=12)\n\nax[0].imshow(img\/255);\nax[1].imshow(image_mask);\n","7209d56b":"#get an image\nimg = read_img(df['image_id'][15],(255,255))\n\n#mask\nimage_mask = create_mask_for_image(img)\n\nfig, ax = plt.subplots(1, 2, figsize=(15, 10));\nplt.suptitle('RESULT', x=0.5, y=0.8)\nplt.tight_layout(1)\n\nax[0].set_title('ORIGINAL', fontsize=12)\nax[1].set_title('MASK', fontsize=12)\n\nax[0].imshow(img\/255);\nax[1].imshow(image_mask);\n","52e27a0d":"#get an image\nimg = read_img(df['image_id'][110],(255,255))\n\n#mask\nimage_mask = create_mask_for_image(img)\n\nfig, ax = plt.subplots(1, 2, figsize=(15, 10));\nplt.suptitle('RESULT', x=0.5, y=0.8)\nplt.tight_layout(1)\n\nax[0].set_title('ORIGINAL', fontsize=12)\nax[1].set_title('MASK', fontsize=12)\n\nax[0].imshow(img\/255);\nax[1].imshow(image_mask);\n","c49eecf6":"#get an image\nimg = read_img(df['image_id'][1112],(255,255))\n\n#mask\nimage_mask = create_mask_for_image(img)\n\nfig, ax = plt.subplots(1, 2, figsize=(15, 10));\nplt.suptitle('RESULT', x=0.5, y=0.8)\nplt.tight_layout(1)\n\nax[0].set_title('ORIGINAL', fontsize=12)\nax[1].set_title('MASK', fontsize=12)\n\nax[0].imshow(img\/255);\nax[1].imshow(image_mask);\n","cdab3004":"#get an image\nimg = read_img(df['image_id'][13],(255,255))\n\n#segmentation\nimage_segmented = segment_image(img)\n\nfig, ax = plt.subplots(1, 2, figsize=(15, 5));\nplt.suptitle('RESULT', x=0.5, y=0.8)\nplt.tight_layout(1)\n\nax[0].set_title('ORIGINAL', fontsize=12)\nax[1].set_title('SEGMENTED', fontsize=12)\n\nax[0].imshow(img\/255);\nax[1].imshow(image_segmented);","97bd595d":"#get an image\nimg = read_img(df['image_id'][15],(255,255))\n\n#segmentation\nimage_segmented = segment_image(img)\n\nfig, ax = plt.subplots(1, 2, figsize=(15, 5));\nplt.suptitle('RESULT', x=0.5, y=0.8)\nplt.tight_layout(1)\n\nax[0].set_title('ORIGINAL', fontsize=12)\nax[1].set_title('SEGMENTED', fontsize=12)\n\nax[0].imshow(img\/255);\nax[1].imshow(image_segmented);","d27225b7":"#get an image\nimg = read_img(df['image_id'][5920],(255,255))\n\n#segmentation\nimage_segmented = segment_image(img)\n\nfig, ax = plt.subplots(1, 2, figsize=(15, 5));\nplt.suptitle('RESULT', x=0.5, y=0.8)\nplt.tight_layout(1)\n\nax[0].set_title('ORIGINAL', fontsize=12)\nax[1].set_title('SEGMENTED', fontsize=12)\n\nax[0].imshow(img\/255);\nax[1].imshow(image_segmented);","9cd0f343":"#get an image\nimg = read_img(df['image_id'][13],(255,255))\n\n#deskew\nimage_deskew = deskew_image(img)\n\nfig, ax = plt.subplots(1, 2, figsize=(15, 5));\nplt.suptitle('RESULT', x=0.5, y=0.8)\nplt.tight_layout(1)\n\nax[0].set_title('ORIGINAL', fontsize=12)\nax[1].set_title('DESKEW', fontsize=12)\n\nax[0].imshow(img\/255);\nax[1].imshow(image_deskew);","eea7d327":"#get an image\nimg = read_img(df['image_id'][15],(255,255))\n\n#deskew\nimage_deskew = deskew_image(img)\n\nfig, ax = plt.subplots(1, 2, figsize=(15, 5));\nplt.suptitle('RESULT', x=0.5, y=0.8)\nplt.tight_layout(1)\n\nax[0].set_title('ORIGINAL', fontsize=12)\nax[1].set_title('DESKEW', fontsize=12)\n\nax[0].imshow(img\/255);\nax[1].imshow(image_deskew);","7eb35122":"#get an image\nimg = read_img(df['image_id'][21367],(255,255))\n\n#deskew\nimage_deskew = deskew_image(img)\n\nfig, ax = plt.subplots(1, 2, figsize=(15, 5));\nplt.suptitle('RESULT', x=0.5, y=0.8)\nplt.tight_layout(1)\n\nax[0].set_title('ORIGINAL', fontsize=12)\nax[1].set_title('DESKEW', fontsize=12)\n\nax[0].imshow(img\/255);\nax[1].imshow(image_deskew);","6bcbe73d":"#get an image\nimg = read_img(df['image_id'][13],(255,255))\n\n#gray\nimage_gray = gray_image(img)\n\nfig, ax = plt.subplots(1, 2, figsize=(15, 5));\nplt.suptitle('RESULT', x=0.5, y=0.8)\nplt.tight_layout(1)\n\nax[0].set_title('ORIGINAL', fontsize=12)\nax[1].set_title('GRAY', fontsize=12)\n\nax[0].imshow(img\/255);\nax[1].imshow(image_gray);","12e79037":"#get an image\nimg = read_img(df['image_id'][15],(255,255))\n\n#gray\nimage_gray = gray_image(img)\n\nfig, ax = plt.subplots(1, 2, figsize=(15, 5));\nplt.suptitle('RESULT', x=0.5, y=0.8)\nplt.tight_layout(1)\n\nax[0].set_title('ORIGINAL', fontsize=12)\nax[1].set_title('GRAY', fontsize=12)\n\nax[0].imshow(img\/255);\nax[1].imshow(image_gray);","cbdc5364":"#get an image\nimg = read_img(df['image_id'][110],(255,255))\n\n#gray\nimage_gray = gray_image(img)\n\nfig, ax = plt.subplots(1, 2, figsize=(15, 5));\nplt.suptitle('RESULT', x=0.5, y=0.8)\nplt.tight_layout(1)\n\nax[0].set_title('ORIGINAL', fontsize=12)\nax[1].set_title('GRAY', fontsize=12)\n\nax[0].imshow(img\/255);\nax[1].imshow(image_gray);","8a41c15d":"#get an image\nimg = read_img(df['image_id'][13],(255,255))\n\n#thresh\ngray = cv2.cvtColor(img,cv2.COLOR_BGR2GRAY)\nret, thresh = cv2.threshold(gray,0,255,cv2.THRESH_BINARY_INV +cv2.THRESH_OTSU)\nfig, ax = plt.subplots(1, 2, figsize=(15, 5));\nplt.suptitle('RESULT', x=0.5, y=0.8)\nplt.tight_layout(1)\n\n\nax[0].set_title('ORIGINAL', fontsize=12)\nax[1].set_title('THRESH', fontsize=12)\n\nax[0].imshow(img\/255);\nax[1].imshow(thresh);","b0eb6b42":"#get an image\nimg = read_img(df['image_id'][15],(255,255))\n\n#thresh\ngray = cv2.cvtColor(img,cv2.COLOR_BGR2GRAY)\nret, thresh = cv2.threshold(gray,0,255,cv2.THRESH_BINARY_INV +cv2.THRESH_OTSU)\nfig, ax = plt.subplots(1, 2, figsize=(15, 5));\nplt.suptitle('RESULT', x=0.5, y=0.8)\nplt.tight_layout(1)\n\nax[0].set_title('ORIGINAL', fontsize=12)\nax[1].set_title('THRESH', fontsize=12)\n\nax[0].imshow(img\/255);\nax[1].imshow(thresh);","fc7e297e":"#get an image\nimg = read_img(df['image_id'][105],(255,255))\n\n#thresh\ngray = cv2.cvtColor(img,cv2.COLOR_BGR2GRAY)\nret, thresh = cv2.threshold(gray,0,255,cv2.THRESH_BINARY_INV +cv2.THRESH_OTSU)\nfig, ax = plt.subplots(1, 2, figsize=(15, 5));\nplt.suptitle('RESULT', x=0.5, y=0.8)\nplt.tight_layout(1)\n\nax[0].set_title('ORIGINAL', fontsize=12)\nax[1].set_title('THRESH', fontsize=12)\n\nax[0].imshow(img\/255);\nax[1].imshow(thresh);","388779ff":"#get an image\nimg = read_img(df['image_id'][13],(255,255))\n\n#rnoise\nimage_rnoise = rnoise_image(img)\n\nfig, ax = plt.subplots(1, 2, figsize=(15, 5));\nplt.suptitle('RESULT', x=0.5, y=0.8)\nplt.tight_layout(1)\n\nax[0].set_title('ORIGINAL', fontsize=12)\nax[1].set_title('RNOISE', fontsize=12)\n\nax[0].imshow(img\/255);\nax[1].imshow(image_rnoise);","d6b86b48":"#get an image\nimg = read_img(df['image_id'][15],(255,255))\n\n#rnoise\nimage_rnoise = rnoise_image(img)\n\nfig, ax = plt.subplots(1, 2, figsize=(15, 5));\nplt.suptitle('RESULT', x=0.5, y=0.8)\nplt.tight_layout(1)\n\nax[0].set_title('ORIGINAL', fontsize=12)\nax[1].set_title('RNOISE', fontsize=12)\n\nax[0].imshow(img\/255);\nax[1].imshow(image_rnoise);","6143734e":"#get an image\nimg = read_img(df['image_id'][19025],(255,255))\n\n#rnoise\nimage_rnoise = rnoise_image(img)\n\nfig, ax = plt.subplots(1, 2, figsize=(15, 5));\nplt.suptitle('RESULT', x=0.5, y=0.8)\nplt.tight_layout(1)\n\nax[0].set_title('ORIGINAL', fontsize=12)\nax[1].set_title('RNOISE', fontsize=12)\n\nax[0].imshow(img\/255);\nax[1].imshow(image_rnoise);","5a68294a":"#get an image\nimg = read_img(df['image_id'][13],(255,255))\n\n#canny\nimage_canny = canny_image(img)\n\nfig, ax = plt.subplots(1, 2, figsize=(15, 5));\nplt.suptitle('RESULT', x=0.5, y=0.8)\nplt.tight_layout(1)\n\nax[0].set_title('ORIGINAL', fontsize=12)\nax[1].set_title('CANNY', fontsize=12)\n\nax[0].imshow(img\/255);\nax[1].imshow(image_canny);","abbc5d73":"#get an image\nimg = read_img(df['image_id'][15],(255,255))\n\n#canny\nimage_canny = canny_image(img)\n\nfig, ax = plt.subplots(1, 2, figsize=(15, 5));\nplt.suptitle('RESULT', x=0.5, y=0.8)\nplt.tight_layout(1)\n\nax[0].set_title('ORIGINAL', fontsize=12)\nax[1].set_title('CANNY', fontsize=12)\n\nax[0].imshow(img\/255);\nax[1].imshow(image_canny);","4f076396":"#get an image\nimg = read_img(df['image_id'][6900],(255,255))\n\n#canny\nimage_canny = canny_image(img)\n\nfig, ax = plt.subplots(1, 2, figsize=(15, 5));\nplt.suptitle('RESULT', x=0.5, y=0.8)\nplt.tight_layout(1)\n\nax[0].set_title('ORIGINAL', fontsize=12)\nax[1].set_title('CANNY', fontsize=12)\n\nax[0].imshow(img\/255);\nax[1].imshow(image_canny);","18df40df":"#get an image\nimg = read_img(df['image_id'][13],(255,255))\n\n#sharpen the image\nimage_sharpen = sharpen_image(img)\n\nfig, ax = plt.subplots(1, 2, figsize=(15, 5));\nplt.suptitle('RESULT', x=0.5, y=0.8)\nplt.tight_layout(1)\n\nax[0].set_title('ORIGINAL', fontsize=12)\nax[1].set_title('SHARPEN', fontsize=12)\n\nax[0].imshow(img\/255);\nax[1].imshow(image_sharpen);","247735d0":"#get an image\nimg = read_img(df['image_id'][15],(255,255))\n\n#sharpen the image\nimage_sharpen = sharpen_image(img)\n\nfig, ax = plt.subplots(1, 2, figsize=(15, 5));\nplt.suptitle('RESULT', x=0.5, y=0.8)\nplt.tight_layout(1)\n\nax[0].set_title('ORIGINAL', fontsize=12)\nax[1].set_title('SHARPEN', fontsize=12)\n\nax[0].imshow(img\/255);\nax[1].imshow(image_sharpen);","e2a89bad":"#get an image\nimg = read_img(df['image_id'][2090],(255,255))\n\n#sharpen the image\nimage_sharpen = sharpen_image(img)\n\nfig, ax = plt.subplots(1, 2, figsize=(15, 5));\nplt.suptitle('RESULT', x=0.5, y=0.8)\nplt.tight_layout(1)\n\nax[0].set_title('ORIGINAL', fontsize=12)\nax[1].set_title('SHARPEN', fontsize=12)\n\nax[0].imshow(img\/255);\nax[1].imshow(image_sharpen);","19e8dcb0":"#get an image\nimg = read_img(df['image_id'][13],(255,255))\n\n#mask\nimage_mask = create_mask_for_image(img)\n\n#segmentation\nimage_segmented = segment_image(img)\n\n\n#deskew\nimage_deskew = deskew_image(img)\n\n#gray\nimage_gray = gray_image(img)\n\n\n\nfig, ax = plt.subplots(1, 5, figsize=(15, 6));\nplt.suptitle('RESULT', x=0.5, y=0.8)\nplt.tight_layout(2)\n\nax[0].set_title('ORIGINAL', fontsize=9)\nax[1].set_title('MASK', fontsize=9)\nax[2].set_title('SEGMENTED', fontsize=9)\nax[3].set_title('DESKEW', fontsize=9)\nax[4].set_title('GRAY', fontsize=9)\n\n\nax[0].imshow(img\/255);\nax[1].imshow(image_mask);\nax[2].imshow(image_segmented);\nax[3].imshow(image_deskew);\nax[4].imshow(image_gray );\n\n","564e3d86":"fig, ax = plt.subplots(1, 5, figsize=(15, 6));\nplt.tight_layout(2)\n\n#thresh\nimage_thresh = thresh_image(img)\n\n#rnoise\nimage_rnoise = rnoise_image(img)\n\n#canny\nimage_canny = canny_image(img)\n\n#sharpen the image\nimage_sharpen = sharpen_image(img)\n\n\nax[0].set_title('ORIGINAL', fontsize=9)\nax[1].set_title('THREST', fontsize=9)\nax[2].set_title('RNOISE', fontsize=9)\nax[3].set_title('CANNY', fontsize=9)\nax[4].set_title('SHARPEN', fontsize=9)\n\n\nax[0].imshow(img\/255);\nax[1].imshow(thresh);\nax[2].imshow(image_rnoise);\nax[3].imshow(image_canny);\nax[4].imshow(image_sharpen);\n\n\n\n","5308dd6c":"#get an image\nimg = read_img(df['image_id'][13],(255,255))\n\n#erode\nimage_erode = erode_image(img)\n\nfig, ax = plt.subplots(1, 2, figsize=(15, 5));\nplt.suptitle('RESULT', x=0.5, y=0.8)\nplt.tight_layout(1)\n\nax[0].set_title('ORIGINAL', fontsize=12)\nax[1].set_title('ERODE', fontsize=12)\n\nax[0].imshow(img\/255);\nax[1].imshow(image_erode);","f609439b":"#get an image\nimg = read_img(df['image_id'][15],(255,255))\n\n#erode\nimage_erode = erode_image(img)\n\nfig, ax = plt.subplots(1, 2, figsize=(15, 5));\nplt.suptitle('RESULT', x=0.5, y=0.8)\nplt.tight_layout(1)\n\nax[0].set_title('ORIGINAL', fontsize=12)\nax[1].set_title('ERODE', fontsize=12)\n\nax[0].imshow(img\/255);\nax[1].imshow(image_erode);","bdb8344b":"#get an image\nimg = read_img(df['image_id'][110],(255,255))\n\n#erode\nimage_erode = erode_image(img)\n\nfig, ax = plt.subplots(1, 2, figsize=(15, 5));\nplt.suptitle('RESULT', x=0.5, y=0.8)\nplt.tight_layout(1)\n\nax[0].set_title('ORIGINAL', fontsize=12)\nax[1].set_title('ERODE', fontsize=12)\n\nax[0].imshow(img\/255);\nax[1].imshow(image_erode);","b32ce958":"#get an image\nimg = read_img(df['image_id'][13],(255,255))\n\n#dilate\nimage_dilate = dilate_image(img)\n\nfig, ax = plt.subplots(1, 2, figsize=(15, 5));\nplt.suptitle('RESULT', x=0.5, y=0.8)\nplt.tight_layout(1)\n\nax[0].set_title('ORIGINAL', fontsize=12)\nax[1].set_title('DILATE', fontsize=12)\n\nax[0].imshow(img\/255);\nax[1].imshow(image_dilate);","47b2f44d":"#get an image\nimg = read_img(df['image_id'][15],(255,255))\n\n#dilate\nimage_dilate = dilate_image(img)\n\nfig, ax = plt.subplots(1, 2, figsize=(15, 5));\nplt.suptitle('RESULT', x=0.5, y=0.8)\nplt.tight_layout(1)\n\nax[0].set_title('ORIGINAL', fontsize=12)\nax[1].set_title('DILATE', fontsize=12)\n\nax[0].imshow(img\/255);\nax[1].imshow(image_dilate);","79fd7e30":"#get an image\nimg = read_img(df['image_id'][110],(255,255))\n\n#dilate\nimage_dilate = dilate_image(img)\n\nfig, ax = plt.subplots(1, 2, figsize=(15, 5));\nplt.suptitle('RESULT', x=0.5, y=0.8)\nplt.tight_layout(1)\n\nax[0].set_title('ORIGINAL', fontsize=12)\nax[1].set_title('DILATE', fontsize=12)\n\nax[0].imshow(img\/255);\nax[1].imshow(image_dilate);","04902492":"#get an image\nimg = read_img(df['image_id'][13],(255,255))\n\n#opening\nimage_opening = opening_image(img)\n\nfig, ax = plt.subplots(1, 2, figsize=(15, 5));\nplt.suptitle('RESULT', x=0.5, y=0.8)\nplt.tight_layout(1)\n\nax[0].set_title('ORIGINAL', fontsize=12)\nax[1].set_title('OPENING', fontsize=12)\n\nax[0].imshow(img\/255);\nax[1].imshow(image_opening);","88fb4303":"#get an image\nimg = read_img(df['image_id'][15],(255,255))\n\n#opening\nimage_opening = opening_image(img)\n\nfig, ax = plt.subplots(1, 2, figsize=(15, 5));\nplt.suptitle('RESULT', x=0.5, y=0.8)\nplt.tight_layout(1)\n\nax[0].set_title('ORIGINAL', fontsize=12)\nax[1].set_title('OPENING', fontsize=12)\n\nax[0].imshow(img\/255);\nax[1].imshow(image_opening);","41ae44a0":"#get an image\nimg = read_img(df['image_id'][110],(255,255))\n\n#opening\nimage_opening = opening_image(img)\n\nfig, ax = plt.subplots(1, 2, figsize=(15, 5));\nplt.suptitle('RESULT', x=0.5, y=0.8)\nplt.tight_layout(1)\n\nax[0].set_title('ORIGINAL', fontsize=12)\nax[1].set_title('OPENING', fontsize=12)\n\nax[0].imshow(img\/255);\nax[1].imshow(image_opening);","03b3e142":"#get an image\nimg = read_img(df['image_id'][13],(255,255))\n\n#dilate\nimage_dilate = dilate_image(img)\n\n#erode\nimage_erode = erode_image(img)\n\n#opening\nimage_opening = opening_image(img)\n\nfig, ax = plt.subplots(1, 4, figsize=(15, 6));\nplt.suptitle('RESULT', x=0.5, y=0.8)\nplt.tight_layout(1)\n\nax[0].set_title('ORIGINAL', fontsize=9)\nax[1].set_title('DILATE', fontsize=9)\nax[2].set_title('ERODE', fontsize=9)\nax[3].set_title('OPENING', fontsize=9)\n\n\nax[0].imshow(img\/255);\nax[1].imshow(image_dilate);\nax[2].imshow(image_erode);\nax[3].imshow(image_opening);\n","513a5f39":"\n#get an image\nimg = read_img(df['image_id'][13],(255,255))\n\n#Blur\nblur = cv2.blur(img,(5,5))\n\nfig, ax = plt.subplots(1, 2, figsize=(15, 5));\nplt.suptitle('RESULT', x=0.5, y=0.8)\nplt.tight_layout(1)\n\nax[0].set_title('ORIGINAL', fontsize=12)\nax[1].set_title('BLUR IMAGE', fontsize=12)\n\nax[0].imshow(img\/255);\nax[1].imshow(blur);","28d3a4a1":"\n#get an image\nimg = read_img(df['image_id'][15],(255,255))\n\n#Blur\nblur = cv2.blur(img,(5,5))\n\nfig, ax = plt.subplots(1, 2, figsize=(15, 5));\nplt.suptitle('RESULT', x=0.5, y=0.8)\nplt.tight_layout(1)\n\nax[0].set_title('ORIGINAL', fontsize=12)\nax[1].set_title('BLUR IMAGE', fontsize=12)\n\nax[0].imshow(img\/255);\nax[1].imshow(blur);","c3929a63":"#get an image\nimg = read_img(df['image_id'][13],(255,255))\n\n#GaussianBlur\nGblur = cv2.GaussianBlur(img,(5,5),0)\n\nfig, ax = plt.subplots(1, 2, figsize=(15, 5));\nplt.suptitle('RESULT', x=0.5, y=0.8)\nplt.tight_layout(1)\n\nax[0].set_title('ORIGINAL', fontsize=12)\nax[1].set_title('GAUSSIAN BLUR', fontsize=12)\n\nax[0].imshow(img\/255);\nax[1].imshow(Gblur);","05f84052":"#get an image\nimg = read_img(df['image_id'][15],(255,255))\n\n#GaussianBlur\nGblur = cv2.GaussianBlur(img,(5,5),0)\n\nfig, ax = plt.subplots(1, 2, figsize=(15, 5));\nplt.suptitle('RESULT', x=0.5, y=0.8)\nplt.tight_layout(1)\n\nax[0].set_title('ORIGINAL', fontsize=12)\nax[1].set_title('GAUSSIAN BLUR', fontsize=12)\n\nax[0].imshow(img\/255);\nax[1].imshow(Gblur);","f470e3bc":"#get an image\nimg = read_img(df['image_id'][13],(255,255))\n\n#medianBlur\nblur_image_median = cv2.medianBlur(img,5)\n\nfig, ax = plt.subplots(1, 2, figsize=(15, 5));\nplt.suptitle('RESULT', x=0.5, y=0.8)\nplt.tight_layout(1)\n\nax[0].set_title('ORIGINAL', fontsize=12)\nax[1].set_title('MEDIAN BLUR', fontsize=12)\n\nax[0].imshow(img\/255);\nax[1].imshow(blur_image_median);","b02aed43":"#get an image\nimg = read_img(df['image_id'][15],(255,255))\n\n#medianBlur\nblur_image_median = cv2.medianBlur(img,5)\n\nfig, ax = plt.subplots(1, 2, figsize=(15, 5));\nplt.suptitle('RESULT', x=0.5, y=0.8)\nplt.tight_layout(1)\n\nax[0].set_title('ORIGINAL', fontsize=12)\nax[1].set_title('MEDIAN BLUR', fontsize=12)\n\nax[0].imshow(img\/255);\nax[1].imshow(blur_image_median);","7e4edb3d":"\n#get an image\nimg = read_img(df['image_id'][13],(255,255))\n\n#BILATERAL FILTER\nbilblur = cv2.bilateralFilter(img,9,75,75)\n\nfig, ax = plt.subplots(1, 2, figsize=(15, 5));\nplt.suptitle('RESULT', x=0.5, y=0.8)\nplt.tight_layout(1)\n\nax[0].set_title('ORIGINAL', fontsize=12)\nax[1].set_title('BILATERAL FILTER', fontsize=12)\n\nax[0].imshow(img\/255);\nax[1].imshow(bilblur);\n","4a2c423a":"\n#get an image\nimg = read_img(df['image_id'][15],(255,255))\n\n#BILATERAL FILTER\nbilblur = cv2.bilateralFilter(img,9,75,75)\n\nfig, ax = plt.subplots(1, 2, figsize=(15, 5));\nplt.suptitle('RESULT', x=0.5, y=0.8)\nplt.tight_layout(1)\n\nax[0].set_title('ORIGINAL', fontsize=12)\nax[1].set_title('BILATERAL FILTER', fontsize=12)\n\nax[0].imshow(img\/255);\nax[1].imshow(bilblur);\n","b548a96b":"#get an image\nimg = read_img(df['image_id'][13],(255,255))\n\nfig, ax = plt.subplots(1, 5, figsize=(15, 6));\nplt.suptitle('RESULT', x=0.5, y=0.8)\nplt.tight_layout(1)\n\nax[0].set_title('ORIGINAL', fontsize=9)\nax[1].set_title('BLUR IMAGE', fontsize=9)\nax[2].set_title('GAUSSIAN BLUR', fontsize=9)\nax[3].set_title('MEDIAN BLUR', fontsize=9)\nax[4].set_title('BILATERAL FILTER', fontsize=9)\n\n\nax[0].imshow(img\/255);\nax[1].imshow(blur);\nax[2].imshow(Gblur);\nax[3].imshow(blur_image_median);\nax[4].imshow(bilblur);\n","69247118":"# Gaussian Filtering\nIt is done with the function, cv2.GaussianBlur(). ","6b193eb1":"# Bilateral Filtering\n\nAccording to [3] cv2.bilateralFilter() is highly effective at noise removal while preserving edges","35870b95":"SHOW SAMPLE IMAGES","663d87de":"# thresh","2177d572":"# rnoise","7ca54900":"# dilate\n\nIt is just opposite of erosion. Here, a pixel element is \u20181\u2019 if atleast one pixel under the kernel is \u20181\u2019. So it increases the white region in the image or size of foreground object increases. Normally, in cases like noise removal, erosion is followed by dilation.","39e8307f":"This is done by convolving the image with a normalized box filter. It simply takes the average of all the pixels under kernel area and replaces the central element with this average. This is done by the function cv2.blur() or cv2.boxFilter(). ","6480e627":"# Comparison of Morphological Transformations","98debc0e":"# sharpen","b7dbf6bd":"# erosion\n\nThe basic idea of erosion is just like soil erosion only, it erodes away the boundaries of foreground object (Always try to keep foreground in white)","6c6d4b4d":"# Opening\n\nOpening is just another name of erosion followed by dilation. It is useful in removing noise","68920f1b":"Read the image from the disk and convert it from the BGR color space to the RGB color space\nFor historical reasons, OpenCV reads an image in BGR format (so color channels of the image have the following order: Blue, Green, Red). Albumentations uses the most common and popular RGB image format. So when using OpenCV, we need to convert the image format to RGB explicitly.","9f703b95":"\n# 1. Image Transform\n\nThis work tried to transform images from one color-space to another. The transformation you can see below:\n* mask\n* segment\n* deskew\n* gray\n* thresh\n* rnoise\n* canny\n* sharpen\n\nAccording to [2] while the color image can be treated arbitrary vector value functions or collections of independent bands, it usually makes sense to think about them as highly correlated signals with strong connections to the image formation process, sensor design, and Human perception. Consider example brightening picture by adding a constant value to all three channels. In fact, adding the same value to each color channel not only increases the apparent intensity of each pixel, but it cal also affects the picture hue and saturation.\n\n","ee0e53e3":"Practical example","106fc14a":"# What is Computer Vision?\n\n<img src=\"https:\/\/analyticsinsight.b-cdn.net\/wp-content\/uploads\/2020\/07\/Computer-Vision.jpg\" width=\"400\">\n\nComputer vision is an interdisciplinary scientific field that deals with how computers can gain high-level understanding from digital images or videos. From the perspective of engineering, it seeks to understand and automate tasks that the human visual system can do[[1](https:\/\/en.wikipedia.org\/wiki\/Computer_vision)]. Computer vision tasks include methods for acquiring, processing, analyzing and understanding digital images, and extraction of high-dimensional data from the real world in order to produce numerical or symbolic information, e.g. in the forms of decisions ( Reinhard Klette (2014))\n\n\n","4489cd35":"# deskew","c42b666f":"# gray","c766f3c9":"# 2. Morphological Transformations","ace12971":"# mask","e2ccf55a":"# Comparison of Image Blurring","3cb22822":"# **What is image processing?**\n\nIn machine learning projects in general, you usually go through a data preprocessing or cleaning step. The goal of this step is to make your data ready for the ML model to make it easier to analyze and process computationally, as it is with images. Based on the problem you\u2019re solving and the dataset in hand, there\u2019s some data massaging required before you feed your images to the ML model.\n\nImage processing could be simple tasks like image resizing.In order to feed a dataset of images to a convolutional network, they must all be the same size. Other processing tasks can take place like geometric and color transformation or converting color to grayscale and many more.","581930a9":"# **Why image preprocessing?**\n\nThe acquired data are usually messy and come from different sources. To feed them to the Machine Learning model (or neural network), they need to be standardized and cleaned up.\n","b03b7b86":"# Median Filtering\n\nHere, the function cv2.medianBlur() computes the median of all the pixels under the kernel window and the central pixel is replaced with this median value. This is highly effective in removing salt-and-pepper noise.","c98432f0":"# Averaging","1f929ed3":"# segmented","8f3c8d65":"# Show Result","4306b081":"# canny ","c5d111ee":"# Comparison of color space transformation","42840b24":"# **Data preprocessing techniques might include:**\n\nin certain problems you\u2019ll find it useful to lose unnecessary information from your images to reduce space or computational complexity.\n\nFor example, converting your colored images to grayscale images. This is because in many objects, color isn\u2019t necessary to recognize and interpret an image. Grayscale can be good enough for recognizing certain objects. Because color images contain more information than black and white images, they can add unnecessary complexity and take up more space in memory (Remember how color images are represented in three channels, which means that converting it to grayscale reduces the number of pixels that need to be processed).","feae5631":"# 3. Image Blurring (Image Smoothing)","31e47e3a":"Image blurring is achieved by convolving the image with a low-pass filter kernel. It is useful for removing noise. It actually removes high frequency content (e.g: noise, edges) from the image resulting in edges being blurred when this is filter is applied. (Well, there are blurring techniques which do not blur edges). OpenCV provides mainly four types of blurring techniques.","7a6da6f4":"# References\n\n[1] https:\/\/en.wikipedia.org\/wiki\/Computer_vision\n\n[2] http:\/\/szeliski.org\/Book\/\n\n[3] https:\/\/opencv-python-tutroals.readthedocs.io\/\n\n\n"}}