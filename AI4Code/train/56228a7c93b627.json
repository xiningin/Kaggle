{"cell_type":{"5827fc48":"code","612362cd":"code","a36d78c4":"code","b0ec8182":"code","8b353fda":"code","2e50504e":"code","82eae496":"code","2da630bd":"code","3a3ab9d3":"code","86b6218c":"code","d1f79985":"code","816ec9e9":"code","9bdcaab5":"code","f43f0de4":"code","f5b51d1f":"code","5d91033a":"code","4ad2f205":"code","9a1a8916":"code","4accba78":"code","7ed428d0":"code","5a3f1c6b":"code","d90a574d":"code","942fdc5f":"code","cd1abff5":"code","f771666c":"code","7956aa3b":"code","34c7d061":"code","594408fc":"code","edeef48f":"code","0ce8259f":"code","c317a8ca":"code","7eb62a77":"code","9a3cf913":"code","a4fb518f":"code","27286d12":"code","47e45aba":"code","3cc62c09":"code","2b2a32ca":"code","5833b99c":"code","3a555f6e":"code","d05bf20a":"code","26b0e00e":"code","afe8b7ca":"code","b0351998":"code","6926f3f1":"code","daa71a1f":"code","d501a568":"code","7b04068c":"code","af124904":"code","29ee4b4b":"code","315a3ee6":"code","c33e1d3b":"code","7bde107a":"code","4277943c":"code","f84cec52":"code","d8315c8a":"code","916a3ced":"code","739e4d4c":"code","58dc22e3":"code","a0da3258":"code","d7cce710":"code","11c9e762":"code","9931057d":"code","36b2e0ea":"code","8d3f297f":"code","204a7d88":"code","f779d928":"code","e6b9c2f5":"code","ca8d53c7":"code","864fe878":"code","3ed1919d":"code","b19b72c0":"code","c22adfce":"code","29f522f9":"code","636670eb":"code","bedc8ba7":"code","644c04ff":"code","3a6cf601":"code","ee37ff82":"code","0d9c52d7":"code","61cff3d8":"code","e6057df1":"code","95228410":"code","5d49e3a0":"code","10e6def2":"code","6e9a966b":"code","8eba0d83":"code","4a4771ee":"code","b90c49ce":"code","ea0adcf8":"code","ad267088":"code","414466ef":"code","ec62ee8d":"code","486f61cc":"code","24295daa":"code","422ba330":"code","4ff862d2":"code","0c1d9626":"code","5d4cac08":"code","19dd4cf3":"code","50a90ab7":"code","14c94c55":"code","149b52aa":"code","f2ab0bc6":"code","c289bc60":"code","246944f9":"code","6e691414":"code","6be73d26":"code","28ab5da8":"code","22ec6c8c":"code","1e4cd7c2":"code","6d10af01":"code","32addbd5":"code","f94d9ffc":"code","fedee6e0":"code","8b41204b":"code","da5a2a69":"code","6a64ceab":"code","f7e53535":"code","2ee9a55a":"code","206cedd4":"code","f5c5cc83":"code","6a3b82a2":"code","bbdce4c2":"code","59be6f6b":"code","b7f101f0":"code","3586c77f":"code","58fd0c9d":"code","867690a8":"code","8d7022c0":"code","2679f41d":"code","ddfdac05":"code","575f51cc":"code","3082c78d":"code","77256f54":"code","9e29bdf2":"code","cf0072a4":"code","c75da77e":"code","38550fe9":"code","f877f1f0":"code","0ae8b6c7":"code","87cbb512":"code","26c86948":"code","fca215be":"code","94147d26":"code","a7622cbd":"code","b7420ff0":"code","07af0289":"markdown","7f6825f0":"markdown","c7dd6b3a":"markdown","3e34ada1":"markdown","613bc659":"markdown","c3aab207":"markdown","37ec0b60":"markdown","7d94e6f8":"markdown","70135d12":"markdown","de467cff":"markdown","241afc9e":"markdown","b7a0fb6b":"markdown","56ce82a6":"markdown","a0db615e":"markdown","9fcc4946":"markdown","54da978e":"markdown","e96e26cf":"markdown","e367e43f":"markdown","685c7d03":"markdown","3c8a8dca":"markdown","755f5c67":"markdown","bd15c4ee":"markdown","ecbee0ab":"markdown"},"source":{"5827fc48":"import pandas as pd\nimport numpy as np \nimport matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set(color_codes=True,style='darkgrid')\n","612362cd":"file  = '\/kaggle\/input\/framingham-heart-study-dataset\/framingham.csv'\ndf = pd.read_csv(file)","a36d78c4":"\ndf.head()","b0ec8182":"df.describe(include='all').transpose()","8b353fda":"df.isnull().sum()","2e50504e":"df.dtypes","82eae496":"from sklearn.impute import KNNImputer","2da630bd":"knn = KNNImputer(n_neighbors=1)","3a3ab9d3":"missing_cols = df[['education','cigsPerDay','BPMeds','totChol','BMI','heartRate','glucose']]","86b6218c":"missing = np.array(missing_cols)","d1f79985":"imputed_cols = knn.fit_transform(missing)","816ec9e9":"imputed_cols = pd.DataFrame(imputed_cols,columns=['education','cigsPerDay','BPMeds','totChol','BMI','heartRate','glucose'])","9bdcaab5":"imputed_cols.head()","f43f0de4":"df = df.drop(['education','cigsPerDay','BPMeds','totChol','BMI','heartRate','glucose'],axis=1)","f5b51d1f":"df.head()","5d91033a":"df = pd.concat([df,imputed_cols],axis=1)","4ad2f205":"df.head()","9a1a8916":"df.columns","4accba78":"df.isnull().sum()","7ed428d0":"df['TenYearCHD'].value_counts()","5a3f1c6b":"sns.distplot(df['age'])","d90a574d":"sns.distplot(df['BMI'])","942fdc5f":"sns.distplot(df['heartRate'])","cd1abff5":"sns.distplot(df['glucose'])","f771666c":"sns.distplot(df['totChol'])","7956aa3b":"sns.countplot(df['education'],hue=df['TenYearCHD'])","34c7d061":"df.education.value_counts()","594408fc":"sns.countplot(df['currentSmoker'],hue=df['TenYearCHD'])","edeef48f":"sns.boxplot(df['TenYearCHD'],df['totChol'])","0ce8259f":"sns.pairplot(df)","c317a8ca":"corr = df.corr()\nplt.figure(figsize=(15,10))\nsns.heatmap(corr,annot =True )","7eb62a77":"X = df.drop(['TenYearCHD'],axis=1)\ny = df['TenYearCHD']","9a3cf913":"from imblearn.over_sampling import RandomOverSampler","a4fb518f":"os = RandomOverSampler(0.5)","27286d12":"x_os,y_os = os.fit_sample(X,y)","47e45aba":"x_os.shape","3cc62c09":"y_os.shape","2b2a32ca":"type(y_os)","5833b99c":"x_cols = X.columns","3a555f6e":"x_os = pd.DataFrame(x_os,columns=x_cols)","d05bf20a":"y_os = pd.Series(y_os,name='TenYearCHD')","26b0e00e":"y_os.shape","afe8b7ca":"x_os.shape","b0351998":"from sklearn.model_selection import train_test_split","6926f3f1":"from sklearn.preprocessing import StandardScaler","daa71a1f":"x_train,x_test,y_train,y_test = train_test_split(x_os,y_os,test_size=0.3,random_state=0)","d501a568":"x_train.shape","7b04068c":"x_test.shape","af124904":"y_test.value_counts()","29ee4b4b":"scaler = StandardScaler()","315a3ee6":"xs_train = scaler.fit_transform(x_train)\nxs_test = scaler.fit_transform(x_test)","c33e1d3b":"from sklearn.linear_model import LogisticRegression","7bde107a":"logit = LogisticRegression(class_weight='balanced',random_state=0)","4277943c":"model1 = logit.fit(xs_train,y_train)","f84cec52":"y_pred1 = model1.predict(xs_test)","d8315c8a":"xs_test.shape","916a3ced":"from sklearn.metrics import accuracy_score,precision_score,recall_score,f1_score,roc_auc_score,roc_curve,confusion_matrix","739e4d4c":"accuracy_score(y_test,y_pred1)","58dc22e3":"precision_score(y_test,y_pred1)","a0da3258":"recall_score(y_test,y_pred1)","d7cce710":"f1_score(y_test,y_pred1)","11c9e762":"y_proba1 = model1.predict_proba(xs_test)[:,1]\nconfusion_matrix(y_test,y_pred1)","9931057d":"false_positive_rate,true_positive_rate,threshold = roc_curve(y_test,y_proba1)\nplt.plot(false_positive_rate,true_positive_rate)\nplt.plot([0,1],ls = '--')","36b2e0ea":"roc_auc_score(y_test,y_proba1)","8d3f297f":"from sklearn.neighbors import KNeighborsClassifier","204a7d88":"knc = KNeighborsClassifier()","f779d928":"from sklearn.model_selection import GridSearchCV","e6b9c2f5":"param = {'n_neighbors':[3,5,7,9,11],'weights':['uniform','distance']}","ca8d53c7":"knc_clf = GridSearchCV(knc,param_grid=param,scoring='recall',cv=5,n_jobs=-1,verbose=3).fit(xs_train,y_train)","864fe878":"knc_clf.best_params_","3ed1919d":"model2 = KNeighborsClassifier(n_neighbors=7,weights='distance',).fit(xs_train,y_train)","b19b72c0":"y_pred2 = model2.predict(xs_test)","c22adfce":"accuracy_score(y_test,y_pred2)","29f522f9":"recall_score(y_test,y_pred2)","636670eb":"precision_score(y_test,y_pred2)","bedc8ba7":"f1_score(y_test,y_pred2)","644c04ff":"y_proba2 = model2.predict_proba(xs_test)[:,1]","3a6cf601":"false_positive_rate,true_positive_rate,threshold = roc_curve(y_test,y_proba2)\nplt.plot(false_positive_rate,true_positive_rate)\nplt.plot([0,1],ls='--')","ee37ff82":"roc_auc_score(y_test,y_proba2)","0d9c52d7":"confusion_matrix(y_test,y_pred2)","61cff3d8":"from sklearn.svm import LinearSVC","e6057df1":"svc = LinearSVC()","95228410":"model3 = svc.fit(xs_train,y_train)","5d49e3a0":"y_pred3 = model3.predict(xs_test)","10e6def2":"accuracy_score(y_test,y_pred3)","6e9a966b":"recall_score(y_test,y_pred3)","8eba0d83":"f1_score(y_test,y_pred3)","4a4771ee":"from sklearn.svm import SVC","b90c49ce":"svm = SVC(C=750,probability=True,class_weight='balanced')","ea0adcf8":"model_3 = svm.fit(xs_train,y_train)","ad267088":"y3_pred = model_3.predict(xs_test)","414466ef":"accuracy_score(y_test,y3_pred)","ec62ee8d":"recall_score(y_test,y3_pred)","486f61cc":"y_proba3 = model_3.predict_proba(xs_test)[:,1]","24295daa":"confusion_matrix(y_test,y3_pred)","422ba330":"from sklearn.tree import DecisionTreeClassifier","4ff862d2":"dtree = DecisionTreeClassifier(criterion='gini',class_weight='balanced')","0c1d9626":"model4 = dtree.fit(x_train,y_train)","5d4cac08":"y_pred4 = model4.predict(x_test)","19dd4cf3":"accuracy_score(y_test,y_pred4)","50a90ab7":"recall_score(y_test,y_pred4)","14c94c55":"f1_score(y_test,y_pred4)","149b52aa":"confusion_matrix(y_test,y_pred4)","f2ab0bc6":"y_proba4 = model4.predict_proba(x_test)[:,1]\nfalse_positive_rate,true_positive_rate,threshold = roc_curve(y_test,y_proba4)","c289bc60":"plt.plot(false_positive_rate,true_positive_rate)\nplt.plot([0,1])\nplt.xlabel('false_positive_rate')\nplt.ylabel('true_positive_rate')\nplt.show()\nroc_auc_score(y_test,y_proba4)","246944f9":"from xgboost import XGBClassifier","6e691414":"model5 = XGBClassifier(learning_rate=0.3,colsample_bynode=0.8,subsample=0.8).fit(x_train,y_train)","6be73d26":"y_pred5 = model5.predict(x_test)","28ab5da8":"accuracy_score(y_test,y_pred5)","22ec6c8c":"recall_score(y_test,y_pred5)","1e4cd7c2":"f1_score(y_test,y_pred5)","6d10af01":"y_proba5 = model5.predict_proba(x_test)[:,1]\nfalse_positive_rate,true_positive_rate,threshold = roc_curve(y_test,y_proba5)","32addbd5":"plt.plot(false_positive_rate,true_positive_rate)\nplt.plot([0,1])\nplt.xlabel('false_positive_rate')\nplt.ylabel('true_positive_rate')\nplt.show()\nroc_auc_score(y_test,y_proba5)","f94d9ffc":"from lightgbm import LGBMClassifier","fedee6e0":"lgb_clf = LGBMClassifier(class_weight='balanced',n_jobs=-1,n_estimators=300,subsample=0.6,colsample_bytree=0.5)","8b41204b":"model6 = lgb_clf.fit(x_train,y_train)","da5a2a69":"y_pred6 = model6.predict(x_test)","6a64ceab":"accuracy_score(y_test,y_pred6)","f7e53535":"recall_score(y_test,y_pred6)","2ee9a55a":"f1_score(y_test,y_pred6)","206cedd4":"y_proba6 = model6.predict_proba(x_test)[:,1]\nfalse_positive_rate,true_positive_rate,threshold = roc_curve(y_test,y_proba6)","f5c5cc83":"plt.plot(false_positive_rate,true_positive_rate)\nplt.plot([0,1])\nplt.xlabel('false_positive_rate')\nplt.ylabel('true_positive_rate')\nplt.show()\nroc_auc_score(y_test,y_proba6)","6a3b82a2":"confusion_matrix(y_test,y_pred6)","bbdce4c2":"yp6 = model6.predict_proba(x_test)\nfrom sklearn.preprocessing import binarize\ny6_pred = binarize(yp6,0.3)[:,1]","59be6f6b":"recall_score(y_test,y6_pred)","b7f101f0":"accuracy_score(y_test,y6_pred)","3586c77f":"confusion_matrix(y_test,y6_pred)","58fd0c9d":"from sklearn.ensemble import RandomForestClassifier","867690a8":"rfcl = RandomForestClassifier(class_weight='balanced',n_estimators=250,max_features='auto')","8d7022c0":"model8 = rfcl.fit(x_train,y_train)","2679f41d":"y_pred8 = model8.predict(x_test)","ddfdac05":"accuracy_score(y_test,y_pred8)","575f51cc":"recall_score(y_test,y_pred8)","3082c78d":"f1_score(y_test,y_pred8)","77256f54":"y_proba8 = model8.predict_proba(x_test)[:,1]\nfalse_positive_rate,true_positive_rate,threshold = roc_curve(y_test,y_proba8)","9e29bdf2":"plt.plot(false_positive_rate,true_positive_rate)\nplt.plot([0,1])\nplt.xlabel('false_positive_rate')\nplt.ylabel('true_positive_rate')\nplt.show()\nroc_auc_score(y_test,y_proba8)","cf0072a4":"confusion_matrix(y_test,y_pred8)","c75da77e":"from sklearn.ensemble import GradientBoostingClassifier","38550fe9":"gbcl = GradientBoostingClassifier(n_estimators=1000,learning_rate=0.3,subsample=0.5,max_features=1.0)","f877f1f0":"model9 = gbcl.fit(x_train,y_train)","0ae8b6c7":"y_pred9 = model9.predict(x_test)","87cbb512":"accuracy_score(y_test,y_pred9)","26c86948":"recall_score(y_test,y_pred9)","fca215be":"f1_score(y_test,y_pred9)","94147d26":"confusion_matrix(y_test,y_pred9)","a7622cbd":"y_proba9 = model9.predict_proba(x_test)[:,1]\nfalse_positive_rate,true_positive_rate,threshold = roc_curve(y_test,y_proba9)","b7420ff0":"plt.plot(false_positive_rate,true_positive_rate)\nplt.plot([0,1])\nplt.xlabel('false_positive_rate')\nplt.ylabel('true_positive_rate')\nplt.show()\nroc_auc_score(y_test,y_proba9)","07af0289":"We can observe here if we decrease the threshold we can get lot of misclassified heart disease patients corretly calssiefied but with the expense of misclassifying patients as heart disease patients even they are healthy.","7f6825f0":"There is a heavy imbalance in the data so we use over_sampling to increase the instances of heart disease affected patients.","c7dd6b3a":"## Kneighbors Classifier model","3e34ada1":"## Gradient Bossting Classifier","613bc659":"we are making the affected patients data instances increase to the amount of 50% of heatlthy patients data instances","c3aab207":"Dataset contains null values almost 12% of the data. so we are not going to drop them.","37ec0b60":"We can select DecisionTree calssifer model or Lightgbm model for our problem. With incresing in more training isntances we can improve the models performence as we go further. So these two models are best perfomers for this Heart disease Classifying problem.","7d94e6f8":"## Logistic Regression Model","70135d12":"this model is performing great with only 45 heart disease patients are left miscalssified.","de467cff":"From heatmap we can observe what features are more correlated","241afc9e":"## XGBoost Classifier","b7a0fb6b":"lightgbm is also performing really well with just only left 48 heart disease patients left as misclassified .","56ce82a6":"we have 183 heart disease affected patient instances calssified as healthy patients(False Negatives)","a0db615e":"Scaling the data is important for some of the models.","9fcc4946":"Let's impute missing values using KNNImputer","54da978e":"## LIGHTGBM Classifier","e96e26cf":"Dataset contains patients records , we have to classify the patients who are going to be affected with heart disease in ten years and healthy patients","e367e43f":"## Decision Tree Classifier model","685c7d03":"Dataset is heavily imbalanced.","3c8a8dca":"## Support Vector Machines Model","755f5c67":"## RandomForest Classifier model","bd15c4ee":"Kneighbors classifier model does really a good job in classifying data correctly. But we have 53 heart disease affected patient instances calssified as healthy patients(False Negatives)","ecbee0ab":"We can see rbf kernel model is performing much better than linear kernel."}}