{"cell_type":{"a2959951":"code","a5d907d0":"code","43f458e3":"code","f0e4943e":"code","272761d6":"code","a153f1eb":"code","c6786660":"code","2395e4da":"code","0fc37624":"code","cffb65eb":"code","bd556770":"code","eebc7f18":"code","70150f6f":"code","d0be8108":"code","e1869050":"code","08a9b8cb":"code","5b41d955":"code","cace22de":"code","a342ba4b":"code","e7267299":"code","dce8fb0a":"code","8ab35ed2":"markdown","5ce0f15e":"markdown","82a561dd":"markdown","73cf02a5":"markdown","fa1f3f11":"markdown","70fb765c":"markdown"},"source":{"a2959951":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom keras.layers import Dense, Dropout\nfrom keras.models import Sequential\nfrom keras.metrics import RootMeanSquaredError\nfrom sklearn.preprocessing import LabelEncoder, MinMaxScaler, OneHotEncoder\nfrom sklearn.compose import ColumnTransformer\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import confusion_matrix, accuracy_score","a5d907d0":"train_dataset = pd.read_csv(\"..\/input\/tabular-playground-series-feb-2021\/train.csv\")\ntest_dataset = pd.read_csv(\"..\/input\/tabular-playground-series-feb-2021\/test.csv\")\ntrain_dataset.drop(labels=['id'], axis=1, inplace=True)\ntest_dataset.drop(labels=['id'], axis=1, inplace=True)\nprint(\"shape of train_dataset: \", train_dataset.shape)\nprint(\"shape of test_dataset: \", test_dataset.shape)","43f458e3":"train_dataset.head()","f0e4943e":"train_dataset.info()","272761d6":"test_dataset.head()","a153f1eb":"test_dataset.info()","c6786660":"def encoding(dataset):\n    le = LabelEncoder()\n    for i in range(10):\n        dataset.iloc[:,i] = le.fit_transform(dataset.iloc[:,i])\n    return dataset","2395e4da":"train_dataset = encoding(train_dataset)\ntest_dataset = encoding(test_dataset)","0fc37624":"corr_matrix = train_dataset.corr()\nsns.clustermap(corr_matrix, annot=True, fmt=\".2f\")\nplt.title(\"Correlation Between Features\")\nplt.show()","cffb65eb":"train_dataset.corr()['target'].sort_values().plot(kind=\"bar\")\nplt.show()\nprint(train_dataset.corr()['target'].sort_values())","bd556770":"Y_train = train_dataset['target'].values\nX_train = train_dataset.drop(labels=['target', 'cont2', 'cont9', 'cont12', 'cat4'], axis=1).values\nX_test = test_dataset.drop(labels=['cont2', 'cont9', 'cont12', 'cat4'], axis=1).values\nprint(\"shape of X_train\", X_train.shape)\nprint(\"shape of Y_train\", Y_train.shape)\nprint(\"shape of X_test\", X_test.shape)","eebc7f18":"ohe = ColumnTransformer([(\"ohe\", OneHotEncoder(dtype=float), [1])], remainder=\"passthrough\")\nX_train = ohe.fit_transform(X_train)\nX_test = ohe.transform(X_test)","70150f6f":"x_train, x_val, y_train, y_val = train_test_split(X_train, Y_train, random_state=0, test_size=0.2)","d0be8108":"scaler = MinMaxScaler(feature_range=(0, 1))\nx_train = scaler.fit_transform(x_train)\nx_val = scaler.transform(x_val)\nX_test = scaler.fit_transform(X_test)","e1869050":"print(x_train.shape)\nprint(x_val.shape)\nprint(y_train.shape)\nprint(y_val.shape)","08a9b8cb":"def create_model():\n    model = Sequential()\n    model.add(Dense(44, activation=\"tanh\", input_dim=21))\n    model.add(Dropout(0.2))\n    model.add(Dense(22, activation=\"tanh\"))\n    model.add(Dropout(0.2))\n    model.add(Dense(11, activation=\"relu\"))\n    model.add(Dropout(0.2))\n    model.add(Dense(1))\n    model.compile(optimizer=\"adam\", loss=\"mse\", metrics=['mae'])\n    return model","5b41d955":"model = create_model()\nmodel.summary()","cace22de":"hist = model.fit(x_train, y_train, validation_data=(x_val, y_val), epochs=50, batch_size=128) ","a342ba4b":"plt.plot(hist.history['loss'], label='Training Loss')\nplt.plot(hist.history['val_loss'], label='Validation Loss')\nplt.legend()\nplt.show()\nplt.plot(hist.history['mae'], label='Training rmse')\nplt.plot(hist.history['val_mae'], label='Validation rmse')\nplt.legend()\nplt.show()","e7267299":"y_pred = model.predict(x_val)\ny_true = np.int64(y_val)\ny_true = y_true.reshape(60000 , 1)\ny_true = y_true.round()\ny_pred = y_pred.round()\ncm = confusion_matrix(y_true, y_pred)\nscore = accuracy_score(y_true, y_pred)\nprint(\"accuracy_score: \", score)\nf, ax = plt.subplots(figsize=(8, 8))\nsns.heatmap(cm, annot=True, linewidths=0.01, cmap=\"Blues\", linecolor='green', fmt=\".2f\", ax=ax)\nplt.xlabel(\"Predict\")\nplt.ylabel(\"True\")\nplt.title(\"Confusion matrix\")\nplt.show()","dce8fb0a":"prediction = model.predict(X_test)\npred = pd.DataFrame(prediction)\nsub = pd.read_csv(\"..\/input\/tabular-playground-series-feb-2021\/sample_submission.csv\")\nsub['target'] = prediction.ravel()\nsub.to_csv('sample_submission.csv', index=False)","8ab35ed2":"## Data Analysis","5ce0f15e":"## Prediction","82a561dd":"## Split of train and test ","73cf02a5":"## Create and fit Model","fa1f3f11":"## Load datasets","70fb765c":"## Scaling"}}