{"cell_type":{"e548b43e":"code","35a7451d":"code","a8babd72":"code","0e803d58":"code","29bd2827":"code","ce31ac7d":"code","c59ec44a":"code","082b5dd3":"code","1dde8d47":"code","a27c7e45":"code","ecc24a87":"code","e4610a27":"code","4262aab3":"code","7e0b42fd":"code","6be792d6":"code","9ac3d909":"code","74e03d7e":"code","957baae8":"code","bc8ff53e":"code","d29bff7e":"code","82451060":"code","f3bc8a01":"code","469cbf92":"code","735cf44e":"code","3110f697":"code","9e5c3c91":"code","f9a2c35b":"code","3ae7fb9c":"code","bb6cce37":"code","f4b07243":"code","d861d91e":"code","0f1d6b86":"code","bcb1da78":"code","7ea5ce87":"code","71c65b3d":"code","35eb3488":"code","53172e7f":"code","5aae2755":"code","536c485d":"code","6ed5af5e":"code","3bdaa6a3":"code","ec81fb8a":"code","15a296a0":"code","82433a98":"code","4643f56d":"code","fead2c1b":"code","ebbdc437":"code","168d1d18":"code","32d36144":"code","51f7233b":"code","bf877a3a":"code","38e8d40e":"code","1111d161":"code","e637eccb":"code","525aa17f":"code","2ba0903c":"code","25bb9111":"code","b5957579":"code","ff0be300":"code","768e66f4":"code","8d1771ee":"code","74764dc9":"code","f9bca92b":"code","27c44adb":"code","c441bb60":"code","d2956cbb":"code","02b5da1e":"code","2ed51363":"code","270344bf":"code","d8ad770b":"code","b50b2c6b":"code","85f7379e":"code","d7cd3353":"code","ae5b01fa":"code","a74d74f0":"code","a24edb00":"code","0ff07f18":"code","2532c146":"code","4ed4a15e":"code","9f19ad64":"code","018d2093":"code","0c94ae88":"code","da84563f":"code","e8706a2b":"code","ffacad1a":"code","ccae5af8":"code","143688bf":"code","ba268d8f":"code","1b2342ce":"code","0c993aa3":"code","6eea863e":"code","f9210de2":"code","930678d4":"code","85e11266":"code","f71f06b4":"code","3f370443":"code","2b306989":"code","c0b69ecf":"code","314eb4e1":"code","ea0c2569":"markdown","c273920f":"markdown","80575259":"markdown","54b9cf4b":"markdown","eccec643":"markdown","0d4b9d69":"markdown","7e18a7cb":"markdown","d8b37f76":"markdown","0c8638cf":"markdown","2086127a":"markdown","b5e2330c":"markdown","a4539ac5":"markdown","d8868270":"markdown","7d0e1332":"markdown","226ab819":"markdown","ce6c8376":"markdown","ebb4854b":"markdown","760b5478":"markdown","ef0b44e6":"markdown","73f37e0c":"markdown","864d5a8f":"markdown","dbfa8b4f":"markdown","9852609e":"markdown","ee3a8bc7":"markdown","bf867ec5":"markdown","28466de4":"markdown","2a8d058c":"markdown","eea4ceee":"markdown","8a0cbea5":"markdown","07830d8c":"markdown","d35a6883":"markdown","f591b05a":"markdown","38ce8a5d":"markdown","a741a4b7":"markdown","d8758483":"markdown","0f6a0da4":"markdown","0b5e5d49":"markdown","52820a7e":"markdown","d7592a12":"markdown","eced86e1":"markdown","b724d440":"markdown","f6b79a0f":"markdown","e2ce492d":"markdown","452ef65a":"markdown","1dba289a":"markdown","9b0707ec":"markdown","68ed5954":"markdown","b10d72b0":"markdown","745f367d":"markdown","8c1b1404":"markdown","81a16433":"markdown","9d91cf11":"markdown","06641ac5":"markdown","2d93b651":"markdown","e5244ae6":"markdown","280516b6":"markdown","b62fa792":"markdown","c9b2491b":"markdown"},"source":{"e548b43e":"# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n# Any results you write to the current directory are saved as output.","35a7451d":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline","a8babd72":"# Import Dataset\ndata = pd.read_csv(\"..\/input\/Admission_Predict.csv\")\ndata.shape","0e803d58":"data.head(2)","29bd2827":"data.columns.values","ce31ac7d":"data.drop('Serial No.', axis=1, inplace=True)","c59ec44a":"data.rename({'Chance of Admit ': 'Chance of Admit', 'LOR ':'LOR'}, axis=1, inplace=True)","082b5dd3":"#Let's see top 10 observation row and column wise\ndata.head(10)","1dde8d47":"# Let's see the detail information of dataset\ndata.info()","a27c7e45":"## General statistics of the data\ndata.describe()","ecc24a87":"## Correlation coeffecients heatmap\nsns.heatmap(data.corr(), annot=True).set_title('Correlation Factors Heat Map', color='black', size='20')","e4610a27":"# Isolating GRE Score data\nGRE = pd.DataFrame(data['GRE Score'])\nGRE.describe()","4262aab3":"# # Probability Distribution\nsns.distplot(GRE).set_title('Probability Distribution for GRE Test Scores', size='20')\nplt.show()","7e0b42fd":"# Correlation Coeffecients for GRE Score Test\nGRE_CORR = pd.DataFrame(data.corr()['GRE Score'])\nGRE_CORR.drop('GRE Score', axis=0, inplace=True)\nGRE_CORR.rename({'GRE Score': 'GRE Correlation Coeff'}, axis=1, inplace=True)\nGRE_CORR","6be792d6":"# Isolating and describing TOEFL Score\nTOEFL = pd.DataFrame(data['TOEFL Score'], columns=['TOEFL Score'])\nTOEFL.describe()","9ac3d909":"# Probability distribution for TOEFL Scores\nsns.distplot(TOEFL).set_title('Probability Distribution for TOEFL Scores', size='20')\nplt.show()","74e03d7e":"# Isolating and describing the CGPA\nCGPA = pd.DataFrame(data['CGPA'], columns=['CGPA'])\nCGPA.describe()","957baae8":"sns.distplot(CGPA).set_title('Probability Distribution Plot for CGPA', size='20')\nplt.show()","bc8ff53e":"RES_Count = data.groupby(['Research']).count()\nRES_Count = RES_Count['GRE Score']\nRES_Count = pd.DataFrame(RES_Count)\nRES_Count.rename({'GRE Score': 'Count'}, axis=1, inplace=True)\nRES_Count.rename({0: 'No Research', 1:'Research'}, axis=0, inplace=True)\nplt.pie(x=RES_Count['Count'], labels=RES_Count.index, autopct='%1.1f%%')\nplt.title('Research', pad=5, size=30)\nplt.show()","d29bff7e":"# Isolating and describing \nUniversity_Rating = data.groupby(['University Rating']).count()\nUniversity_Rating = University_Rating['GRE Score']\nUniversity_Rating = pd.DataFrame(University_Rating)\nUniversity_Rating.rename({'GRE Score': 'Count'}, inplace=True, axis=1)\nUniversity_Rating","82451060":"# Barplot for the distribution of the University Rating\nsns.barplot(University_Rating.index, University_Rating['Count']).set_title('University Rating', size='20')\nplt.show()","f3bc8a01":"#Isolating and describing\nSOP = pd.DataFrame(data.groupby(['SOP']).count()['GRE Score'])\nSOP.rename({'GRE Score':'Count'}, axis=1, inplace=True)\nSOP","469cbf92":"# Barplot for SOP \nsns.barplot(SOP.index, SOP['Count']).set_title('Statement of Purpose', size='20')\nplt.show()","735cf44e":"LOR = pd.DataFrame(data.groupby(['LOR']).count()['GRE Score'])\nLOR.rename({'GRE Score':'Count'}, axis=1, inplace=True)\nLOR","3110f697":"# Distribution of the LOR\nsns.barplot(LOR.index, LOR['Count']).set_title('Letter of Recommendation', size='20')\nplt.show()","9e5c3c91":"data['Chance of Admit']\nsns.distplot(data['Chance of Admit']).set_title('Probability Distribution of Chance of Admit', size='20')\nplt.show()","f9a2c35b":"data.describe()['Chance of Admit']","3ae7fb9c":"COA_corr = pd.DataFrame(data.corr()['Chance of Admit'])\nCOA_corr.rename({'Chance of Admit': 'Correlation Coeffecient'}, axis=1, inplace=True)\nCOA_corr.drop('Chance of Admit', inplace=True)\nCOA_corr.sort_values(['Correlation Coeffecient'], ascending=False, inplace=True)\nCOA_corr_x = COA_corr.index\nCOA_corr_y = COA_corr['Correlation Coeffecient']\nsns.barplot(y=COA_corr_x,x=COA_corr_y).set_title('Chance of Admit Correlation Coeffecients', size='20')\nplt.show()","bb6cce37":"COA_corr","f4b07243":"X = data.drop(['Chance of Admit'], axis=1)\ny = data['Chance of Admit']","d861d91e":"#Standardization\nfrom sklearn.preprocessing import StandardScaler\nscaler = StandardScaler()\nX[['CGPA','GRE Score', 'TOEFL Score']] = scaler.fit_transform(X[['CGPA','GRE Score', 'TOEFL Score']])","0f1d6b86":"#Splitting\nfrom sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, random_state=101)","bcb1da78":"#### Linear Regression (All Features)","7ea5ce87":"from sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LinearRegression","71c65b3d":"lr = LinearRegression()","35eb3488":"lr.fit(X_train, y_train)\ny_pred = lr.predict(X_test)","53172e7f":"pd.DataFrame({\"Actual\": y_test, \"Predict\": y_test}).head()","5aae2755":"from sklearn.metrics import r2_score, mean_squared_error\nlr_r2 = r2_score(y_test, y_pred)\nlr_mse = mean_squared_error(y_test, y_pred)\nlr_rmse = np.sqrt(lr_mse)\nprint('Linear Regression R2 Score: {0} \\nLinear Regression MSE: {1}, \\nLinear Regression RMSE:{2}'.format(lr_r2, lr_mse, lr_rmse))","536c485d":"sns.set(rc={'figure.figsize':(12.7,8.27)})\nsns.distplot((y_test - y_pred))\nplt.title('Linear Regression (All Features) Residuals', fontdict={'fontsize':20}, pad=20)\nplt.show()","6ed5af5e":"sns.set(rc={'figure.figsize':(12.7,8.27)})\n# sns.(y_test, y_pred)\nsns.scatterplot(y_test, y_pred)\nplt.show()","3bdaa6a3":"X_selected = X[['CGPA', 'GRE Score', 'TOEFL Score']]\nX_sel_train, X_sel_test, y_train, y_test = train_test_split(X_selected, y, random_state=101)","ec81fb8a":"lr_sel = LinearRegression()\nlr_sel.fit(X_sel_train, y_train)\nlr_sel_predictions = lr_sel.predict(X_sel_test)","15a296a0":"lr_sel_r2 = r2_score(y_test, lr_sel_predictions)\nlr_sel_mse = mean_squared_error(y_test, lr_sel_predictions)\nlr_sel_rmse = np.sqrt(lr_sel_mse)\nprint('Linear Regression R2 Score: {0} \\nLinear Regression MSE: {1}, \\nLinear Regression RMSE:{2}'.format(lr_sel_r2, lr_sel_mse, lr_sel_rmse))","82433a98":"from sklearn.ensemble import RandomForestRegressor\nrfr = RandomForestRegressor(n_estimators = 100, random_state = 101)\nrfr.fit(X_train,y_train)\ny_head_rfr = rfr.predict(X_test) ","4643f56d":"from sklearn.metrics import r2_score\nprint(\"r_square score: \", r2_score(y_test, y_head_rfr))","fead2c1b":"from sklearn.tree import DecisionTreeRegressor\ndtr = DecisionTreeRegressor(random_state = 101)\ndtr.fit(X_train,y_train)\ny_head_dtr = dtr.predict(X_test) ","ebbdc437":"from sklearn.metrics import r2_score\nprint(\"r_square score: \", r2_score(y_test,y_head_dtr))","168d1d18":"y = np.array([r2_score(y_test,y_pred),r2_score(y_test,y_head_rfr),r2_score(y_test,y_head_dtr)])\nx = [\"LinearRegression\",\"RandomForestReg.\",\"DecisionTreeReg.\"]\nplt.bar(x,y)\nplt.title(\"Comparison of Regression Algorithms\")\nplt.xlabel(\"Regressor\")\nplt.ylabel(\"r2_score\")\nplt.show()","32d36144":"red = plt.scatter(np.arange(0,80,5),y_pred[0:80:5],color = \"red\")\ngreen = plt.scatter(np.arange(0,80,5),y_head_rfr[0:80:5],color = \"green\")\nblue = plt.scatter(np.arange(0,80,5),y_head_dtr[0:80:5],color = \"blue\")\nblack = plt.scatter(np.arange(0,80,5),y_test[0:80:5],color = \"black\")\nplt.title(\"Comparison of Regression Algorithms\")\nplt.xlabel(\"Index of Candidate\")\nplt.ylabel(\"Chance of Admit\")\nplt.legend((red,green,blue,black),('LR', 'RFR', 'DTR', 'REAL'))\nplt.show()","51f7233b":"data[\"Chance of Admit\"].plot(kind = 'hist',bins = 200,figsize = (6,6))\nplt.title(\"Chance of Admit\")\nplt.xlabel(\"Chance of Admit\")\nplt.ylabel(\"Frequency\")\nplt.show()","bf877a3a":"# reading the dataset\ndf = pd.read_csv(\"..\/input\/Admission_Predict.csv\")\ndf.shape","38e8d40e":"# it may be needed in the future.\nserialNo = df[\"Serial No.\"].values\ndf.drop([\"Serial No.\"],axis=1,inplace = True)\n\ndf=df.rename(columns = {'Chance of Admit ':'Chance of Admit'})","1111d161":"X = df.drop([\"Chance of Admit\"],axis=1)\ny = df[\"Chance of Admit\"].values","e637eccb":"# separating train (80%) and test (%20) sets\nfrom sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.20, random_state = 101)","525aa17f":"# normalization\nfrom sklearn.preprocessing import MinMaxScaler\nscalerX = MinMaxScaler(feature_range=(0, 1))\nX_train[X_train.columns] = scalerX.fit_transform(X_train[X_train.columns])\nX_test[X_test.columns] = scalerX.transform(X_test[X_test.columns])","2ba0903c":"y_train_01 = [1 if each > 0.8 else 0 for each in y_train]\ny_test_01  = [1 if each > 0.8 else 0 for each in y_test]\n\n# list to array\ny_train_01 = np.array(y_train_01)\ny_test_01 = np.array(y_test_01)","25bb9111":"from sklearn.linear_model import LogisticRegression\nlogr = LogisticRegression()\nlogr.fit(X_train,y_train_01)","b5957579":"y_predlogr = logr.predict(X_test)","ff0be300":"from sklearn import metrics\nfrom sklearn.metrics import accuracy_score\nprint(\"Accuracy Score:\", accuracy_score(y_predlogr, y_test_01))","768e66f4":"# confusion matrix\nfrom sklearn.metrics import confusion_matrix\nprint(confusion_matrix(y_test_01,y_predlogr))\ncm_lrc = confusion_matrix(y_test_01,y_predlogr)\n# print(\"y_test_01 == 1 :\" + str(len(y_test_01[y_test_01==1]))) # 29","8d1771ee":"# cm visualization\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nf, ax = plt.subplots(figsize =(5,5))\nsns.heatmap(cm_lrc,annot = True,linewidths=0.5,linecolor=\"red\",fmt = \".0f\",ax=ax)\nplt.title(\"Test for Test Dataset\")\nplt.xlabel(\"predicted y values\")\nplt.ylabel(\"real y values\")\nplt.show()","74764dc9":"from sklearn.metrics import precision_score, recall_score\nprint(\"precision_score: \", precision_score(y_test_01, y_predlogr))\nprint(\"recall_score: \", recall_score(y_test_01, y_predlogr))\n\nfrom sklearn.metrics import f1_score\nprint(\"f1_score: \",f1_score(y_test_01, y_predlogr))","f9bca92b":"cm_lrc_train = confusion_matrix(y_train_01,logr.predict(X_train))\nf, ax = plt.subplots(figsize =(5,5))\nsns.heatmap(cm_lrc_train,annot = True,linewidths=0.5,linecolor=\"red\",fmt = \".0f\",ax=ax)\nplt.xlabel(\"predicted y values\")\nplt.ylabel(\"real y values\")\nplt.title(\"Test for Train Dataset\")\nplt.show()","27c44adb":"from sklearn.svm import SVC\nsvm = SVC(random_state = 1)\nsvm.fit(X_train,y_train_01)\ny_pred_svm = svm.predict(X_test)\nprint(\"score: \", svm.score(X_test,y_test_01))","c441bb60":"# confusion matrix\nfrom sklearn.metrics import confusion_matrix\ncm_svm = confusion_matrix(y_test_01,y_pred_svm)\n# print(\"y_test_01 == 1 :\" + str(len(y_test_01[y_test_01==1]))) # 29\ncm_svm","d2956cbb":"# cm visualization\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nf, ax = plt.subplots(figsize =(5,5))\nsns.heatmap(cm_svm,annot = True,linewidths=0.5,linecolor=\"red\",fmt = \".0f\",ax=ax)\nplt.title(\"Test for Test Dataset\")\nplt.xlabel(\"predicted y values\")\nplt.ylabel(\"real y values\")\nplt.show()","02b5da1e":"from sklearn.metrics import precision_score, recall_score\nprint(\"precision_score: \", precision_score(y_test_01, y_pred_svm))\nprint(\"recall_score: \", recall_score(y_test_01,y_pred_svm))\n\nfrom sklearn.metrics import f1_score\nprint(\"f1_score: \",f1_score(y_test_01, y_pred_svm))","2ed51363":"cm_svm_train = confusion_matrix(y_train_01, svm.predict(X_train))\nf, ax = plt.subplots(figsize =(5,5))\nsns.heatmap(cm_svm_train, annot = True,linewidths=0.5,linecolor=\"red\",fmt = \".0f\",ax=ax)\nplt.xlabel(\"predicted y values\")\nplt.ylabel(\"real y values\")\nplt.title(\"Test for Train Dataset\")\nplt.show()","270344bf":"from sklearn.naive_bayes import GaussianNB\nnb = GaussianNB()\nnb.fit(X_train,y_train_01)\ny_pred_nb = nb.predict(X_test)\nprint(\"score: \", nb.score(X_test,y_test_01))","d8ad770b":"# confusion matrix\nfrom sklearn.metrics import confusion_matrix\ncm_nb = confusion_matrix(y_test_01, y_pred_nb)\n# print(\"y_test_01 == 1 :\" + str(len(y_test_01[y_test_01==1]))) # 29\ncm_nb","b50b2c6b":"# cm visualization\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nf, ax = plt.subplots(figsize =(5,5))\nsns.heatmap(cm_nb,annot = True,linewidths=0.5,linecolor=\"red\",fmt = \".0f\",ax=ax)\nplt.title(\"Test for Test Dataset\")\nplt.xlabel(\"predicted y values\")\nplt.ylabel(\"real y values\")\nplt.show()","85f7379e":"from sklearn.metrics import precision_score, recall_score\nprint(\"precision_score: \", precision_score(y_test_01, y_pred_nb))\nprint(\"recall_score: \", recall_score(y_test_01,y_pred_nb))\n\nfrom sklearn.metrics import f1_score\nprint(\"f1_score: \",f1_score(y_test_01, y_pred_nb))","d7cd3353":"cm_nb_train = confusion_matrix(y_train_01,nb.predict(X_train))\nf, ax = plt.subplots(figsize =(5,5))\nsns.heatmap(cm_nb_train,annot = True,linewidths=0.5,linecolor=\"red\",fmt = \".0f\",ax=ax)\nplt.xlabel(\"predicted y values\")\nplt.ylabel(\"real y values\")\nplt.title(\"Test for Train Dataset\")\nplt.show()","ae5b01fa":"from sklearn.tree import DecisionTreeClassifier\ndtc = DecisionTreeClassifier()\ndtc.fit(X_train,y_train_01)\ny_pred_dtc = dtc.predict(X_test)\nprint(\"score: \", dtc.score(X_test,y_test_01))","a74d74f0":"# confusion matrix\nfrom sklearn.metrics import confusion_matrix\ncm_dtc = confusion_matrix(y_test_01, y_pred_dtc)\n# print(\"y_test_01 == 1 :\" + str(len(y_test_01[y_test_01==1]))) # 29\ncm_dtc","a24edb00":"# cm visualization\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nf, ax = plt.subplots(figsize =(5,5))\nsns.heatmap(cm_dtc,annot = True,linewidths=0.5,linecolor=\"red\",fmt = \".0f\",ax=ax)\nplt.title(\"Test for Test Dataset\")\nplt.xlabel(\"predicted y values\")\nplt.ylabel(\"real y values\")\nplt.show()","0ff07f18":"from sklearn.metrics import precision_score, recall_score\nprint(\"precision_score: \", precision_score(y_test_01, y_pred_dtc))\nprint(\"recall_score: \", recall_score(y_test_01, y_pred_dtc))\n\nfrom sklearn.metrics import f1_score\nprint(\"f1_score: \",f1_score(y_test_01, y_pred_dtc))","2532c146":"cm_dtc_train = confusion_matrix(y_train_01,dtc.predict(X_train))\nf, ax = plt.subplots(figsize =(5,5))\nsns.heatmap(cm_dtc_train,annot = True,linewidths=0.5,linecolor=\"red\",fmt = \".0f\",ax=ax)\nplt.xlabel(\"predicted y values\")\nplt.ylabel(\"real y values\")\nplt.title(\"Test for Train Dataset\")\nplt.show()","4ed4a15e":"from sklearn.ensemble import RandomForestClassifier\nrfc = RandomForestClassifier(n_estimators = 100,random_state = 1)\nrfc.fit(X_train,y_train_01)\n\ny_pred_rfc = rfc.predict(X_test)\n\nprint(\"score: \", rfc.score(X_test, y_test_01))","9f19ad64":"# confusion matrix\nfrom sklearn.metrics import confusion_matrix\ncm_rfc = confusion_matrix(y_test_01, y_pred_rfc)\n# print(\"y_test_01 == 1 :\" + str(len(y_test_01[y_test_01==1]))) # 29\ncm_rfc","018d2093":"# cm visualization\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nf, ax = plt.subplots(figsize =(5,5))\nsns.heatmap(cm_rfc,annot = True,linewidths=0.5,linecolor=\"red\",fmt = \".0f\",ax=ax)\nplt.title(\"Test for Test Dataset\")\nplt.xlabel(\"predicted y values\")\nplt.ylabel(\"real y values\")\nplt.show()","0c94ae88":"from sklearn.metrics import precision_score, recall_score\nprint(\"precision_score: \", precision_score(y_test_01, y_pred_rfc))\nprint(\"recall_score: \", recall_score(y_test_01, y_pred_rfc))\n\nfrom sklearn.metrics import f1_score\nprint(\"f1_score: \",f1_score(y_test_01, y_pred_rfc))","da84563f":"cm_rfc_train = confusion_matrix(y_train_01, rfc.predict(X_train))\nf, ax = plt.subplots(figsize =(5,5))\nsns.heatmap(cm_rfc_train,annot = True,linewidths=0.5,linecolor=\"red\",fmt = \".0f\",ax=ax)\nplt.xlabel(\"predicted y values\")\nplt.ylabel(\"real y values\")\nplt.title(\"Test for Train Dataset\")\nplt.show()","e8706a2b":"from sklearn.neighbors import KNeighborsClassifier\n\n# finding k value\nscores = []\nfor each in range(1,50):\n    knn_n = KNeighborsClassifier(n_neighbors = each)\n    knn_n.fit(X_train, y_train_01)\n    scores.append(knn_n.score(X_test, y_test_01))\n    \nplt.plot(range(1,50),scores)\nplt.xlabel(\"k\")\nplt.ylabel(\"accuracy\")\nplt.show()","ffacad1a":"knn = KNeighborsClassifier(n_neighbors = 3) # n_neighbors = k\nknn.fit(X_train, y_train_01)\n\ny_pred_knn = knn.predict(X_test)\nprint(\"score of 3 :\",knn.score(X_test,y_test_01))","ccae5af8":"# confusion matrix\nfrom sklearn.metrics import confusion_matrix\ncm_knn = confusion_matrix(y_test_01, y_pred_knn)\n# print(\"y_test_01 == 1 :\" + str(len(y_test_01[y_test_01==1]))) # 29\ncm_knn","143688bf":"# cm visualization\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nf, ax = plt.subplots(figsize =(5,5))\nsns.heatmap(cm_knn,annot = True,linewidths=0.5,linecolor=\"red\",fmt = \".0f\",ax=ax)\nplt.title(\"Test for Test Dataset\")\nplt.xlabel(\"predicted y values\")\nplt.ylabel(\"real y values\")\nplt.show()","ba268d8f":"from sklearn.metrics import precision_score, recall_score\nprint(\"precision_score: \", precision_score(y_test_01, y_pred_knn))\nprint(\"recall_score: \", recall_score(y_test_01, y_pred_knn))\n\nfrom sklearn.metrics import f1_score\nprint(\"f1_score: \",f1_score(y_test_01, y_pred_knn))","1b2342ce":"cm_knn_train = confusion_matrix(y_train_01,knn.predict(X_train))\nf, ax = plt.subplots(figsize =(5,5))\nsns.heatmap(cm_knn_train,annot = True,linewidths=0.5,linecolor=\"red\",fmt = \".0f\",ax=ax)\nplt.xlabel(\"predicted y values\")\nplt.ylabel(\"real y values\")\nplt.title(\"Test for Train Dataset\")\nplt.show()","0c993aa3":"y = np.array([logr.score(X_test, y_test_01), svm.score(X_test, y_test_01), nb.score(X_test, y_test_01), dtc.score(X_test,y_test_01), rfc.score(X_test, y_test_01), knn.score(X_test, y_test_01)])\n#x = [\"LogisticRegression\",\"SVM\",\"GaussianNB\",\"DecisionTreeClassifier\",\"RandomForestClassifier\",\"KNeighborsClassifier\"]\nx = [\"LogisticReg.\", \"SVM\", \"GNB\", \"Dec.Tree\", \"Ran.Forest\", \"KNN\"]\n\nplt.bar(x,y)\nplt.title(\"Comparison of Classification Algorithms\")\nplt.xlabel(\"Classfication\")\nplt.ylabel(\"Score\")\nplt.show()","6eea863e":"data = pd.read_csv(\"..\/input\/Admission_Predict.csv\")\ndata.shape","f9210de2":"data.columns","930678d4":"data = data.rename(columns = {'Chance of Admit ':'ChanceOfAdmit'})\nserial = data[\"Serial No.\"]\ndata.drop([\"Serial No.\"],axis=1,inplace = True)","85e11266":"data = (data - np.min(data))\/(np.max(data)-np.min(data))\nX = data.drop([\"ChanceOfAdmit\"],axis=1)\ny = data.ChanceOfAdmit","f71f06b4":"# for data visualization\nfrom sklearn.decomposition import PCA\npca = PCA(n_components = 1, whiten= True )  # whitten = normalize\npca.fit(X)\nx_pca = pca.transform(X)\nx_pca = x_pca.reshape(400,)\ndictionary = {\"x\":x_pca,\"y\":y}\ndata1 = pd.DataFrame(dictionary)\nprint(\"data:\")\nprint(data1.head())\nprint(\"\\ndata:\")\nprint(data.head())","3f370443":"data[\"Serial No.\"] = serial\nfrom sklearn.cluster import KMeans\nwcss = []\nfor k in range(1,15):\n    kmeans = KMeans(n_clusters=k)\n    kmeans.fit(X)\n    wcss.append(kmeans.inertia_)\nplt.plot(range(1,15),wcss)\nplt.xlabel(\"k values\")\nplt.ylabel(\"WCSS\")\nplt.show()\n\nkmeans = KMeans(n_clusters=3)\nclusters_knn = kmeans.fit_predict(X)\n\ndata[\"label_kmeans\"] = clusters_knn\n\n\nplt.scatter(data[data.label_kmeans == 0 ][\"Serial No.\"], data[data.label_kmeans == 0].ChanceOfAdmit,color = \"red\")\nplt.scatter(data[data.label_kmeans == 1 ][\"Serial No.\"], data[data.label_kmeans == 1].ChanceOfAdmit,color = \"blue\")\nplt.scatter(data[data.label_kmeans == 2 ][\"Serial No.\"], data[data.label_kmeans == 2].ChanceOfAdmit,color = \"green\")\nplt.title(\"K-means Clustering\")\nplt.xlabel(\"Candidates\")\nplt.ylabel(\"Chance of Admit\")\nplt.show()\n\ndata[\"label_kmeans\"] = clusters_knn\nplt.scatter(data1.x[data.label_kmeans == 0 ],data1[data.label_kmeans == 0].y,color = \"red\")\nplt.scatter(data1.x[data.label_kmeans == 1 ],data1[data.label_kmeans == 1].y,color = \"blue\")\nplt.scatter(data1.x[data.label_kmeans == 2 ],data1[data.label_kmeans == 2].y,color = \"green\")\nplt.title(\"K-means Clustering\")\nplt.xlabel(\"X\")\nplt.ylabel(\"Chance of Admit\")\nplt.show()","2b306989":"data[\"Serial No.\"] = serial\n\nfrom scipy.cluster.hierarchy import linkage, dendrogram\nmerg = linkage(X, method=\"ward\")\ndendrogram(merg,leaf_rotation = 90)\nplt.xlabel(\"data points\")\nplt.ylabel(\"euclidean distance\")\nplt.show()\n\nfrom sklearn.cluster import AgglomerativeClustering\nhiyerartical_cluster = AgglomerativeClustering(n_clusters = 3, affinity= \"euclidean\", linkage = \"ward\")\nclusters_hiyerartical = hiyerartical_cluster.fit_predict(X)\n\ndata[\"label_hiyerartical\"] = clusters_hiyerartical\n\nplt.scatter(data[data.label_hiyerartical == 0 ][\"Serial No.\"],data[data.label_hiyerartical == 0].ChanceOfAdmit,color = \"red\")\nplt.scatter(data[data.label_hiyerartical == 1 ][\"Serial No.\"],data[data.label_hiyerartical == 1].ChanceOfAdmit,color = \"blue\")\nplt.scatter(data[data.label_hiyerartical == 2 ][\"Serial No.\"],data[data.label_hiyerartical == 2].ChanceOfAdmit,color = \"green\")\nplt.title(\"Hierarchical Clustering\")\nplt.xlabel(\"Candidates\")\nplt.ylabel(\"Chance of Admit\")\nplt.show()\n\nplt.scatter(data1[data.label_hiyerartical == 0 ].x,data1.y[data.label_hiyerartical == 0],color = \"red\")\nplt.scatter(data1[data.label_hiyerartical == 1 ].x,data1.y[data.label_hiyerartical == 1],color = \"blue\")\nplt.scatter(data1[data.label_hiyerartical == 2 ].x,data1.y[data.label_hiyerartical == 2],color = \"green\")\nplt.title(\"Hierarchical Clustering\")\nplt.xlabel(\"X\")\nplt.ylabel(\"Chance of Admit\")\nplt.show()","c0b69ecf":"fig,ax = plt.subplots(figsize=(10, 10))\nsns.heatmap(data.corr(), ax=ax, annot=True, linewidths=0.05, fmt= '.2f',cmap=\"magma\")\nplt.show()","314eb4e1":"df = pd.read_csv('..\/input\/Admission_Predict.csv')\ndf=df.rename(columns = {'Chance of Admit ':'Chance of Admit'})\n\nnewDF = pd.DataFrame()\nnewDF[\"GRE Score\"] = df[\"GRE Score\"]\nnewDF[\"TOEFL Score\"] = df[\"TOEFL Score\"]\nnewDF[\"CGPA\"] = df[\"CGPA\"]\nnewDF[\"Chance of Admit\"] = df[\"Chance of Admit\"]\n\nx_new = df.drop([\"Chance of Admit\"],axis=1)\ny_new = df[\"Chance of Admit\"].values\n\n# separating train (80%) and test (%20) sets\nfrom sklearn.model_selection import train_test_split\nx_train_new, x_test_new, y_train_new, y_test_new = train_test_split(x_new, y_new, test_size = 0.20, random_state = 42)\n\n# normalization\nfrom sklearn.preprocessing import MinMaxScaler\nscalerX = MinMaxScaler(feature_range=(0, 1))\nx_train_new[x_train_new.columns] = scalerX.fit_transform(x_train_new[x_train_new.columns])\nx_test_new[x_test_new.columns] = scalerX.transform(x_test_new[x_test_new.columns])\n\nfrom sklearn.linear_model import LinearRegression\nlr_new = LinearRegression()\nlr_new.fit(x_train_new, y_train_new)\ny_head_lr_new = lr_new.predict(x_test_new)\n\nfrom sklearn.metrics import r2_score\nprint(\"r_square score: \", r2_score(y_test_new, y_head_lr_new))","ea0c2569":"Comment:\n\nBecause most candidates in the data have over 70% chance, many unsuccessful candidates are not well predicted","c273920f":"* The first results for Linear Regression (7 features): \nr_square score: 0.821208259148699\n\n* The results for Linear Regression now (3 features):\nr_square score: 0.8212241793299223\n\n* The two results are very close. If these 3 features (CGPA, GRE SCORE, and TOEFL SCORE) are used instead of all 7 features together, the result is not bad and performance is increased because less calculation is required.","80575259":"### 3. Decision Tree ","54b9cf4b":"##### TOEFL Score\n\nTest of English as a Foreign Language (TOEFL) is a very popular test for English language amongst universities worldwide, it is marked based on three sections: Reading, Listening, Speaking, and Writing, each one of them is out of 30, yielding a maximum score of 120 and a minimum of 0.\n\nETS (the institute that offers the test) recorded a mean score of 82.6 with a standard deviation of 19.5 (https:\/\/www.ets.org\/s\/toefl\/pdf\/94227_unlweb.pdf).\n\nAlthough this is the mean for a wide range of students from all around the world that took the test for different purposes, as students applying for an engineering graduate degree might have a higher average than high school students.","eccec643":"### 3. Gaussian Naive Bayes","0d4b9d69":"### Linear Regression (Selected Features)","7e18a7cb":"Test for Train Dataset:","d8b37f76":"Test for Train Dataset:","0c8638cf":"As the distribution plot shows, the GRE test scores are somehow normally distributed.","2086127a":"#### Comparison of Clustering Algorithms\n\nK-means Clustering and Hierarchical Clustering are similarly.","b5e2330c":"* All features (x) were collected in one feature with Principal Component Analysis.","a4539ac5":"If a candidate's Chance of Admit is greater than 80%, the candidate will receive the 1 label.\n\nIf a candidate's Chance of Admit is less than or equal to 80%, the candidate will receive the 0 label.","d8868270":"* The dendrogram method is used to determine the best number of clusters for hierarchical clustering. The number is 3 again.","7d0e1332":"### 3. Hierarchical Clustering","226ab819":"##### Research","ce6c8376":"### Step1: Data Collection\/ Data Extraction","ebb4854b":"Test for Train Dataset:","760b5478":"### Step 3: Train Algorithm","ef0b44e6":"Test for Train Dataset:","73f37e0c":"##### SOP\nStatement of Purpose (SOP) is a letter written by the student himself to state his purpose and motivation for completing a graduate degree in addition to his goals while and after he completes his study. Many universities find this letter significant because it better describe the student from a personal perspective.","864d5a8f":"### Comparison of Classification Algorithms\n\nAll classification algorithms achieved around 90% success. The most successful one is Gaussian Naive Bayes with 96% score.","dbfa8b4f":"##### LOR\nLetter of Recommendation (LOR) is a letter written by a person that knows the student and recommends that the university accept his admission, this person can be a professor in his undergraduate degree or a professional whom the student have worked with.","9852609e":"##### GRE Scores\n\nThe Graduate Record Examinations (GRE) is a the most popular test for graduate schools' admission, it consists of three sections : Analytical Writing, Verbal and Quantitative.\n\nThe test's maximum score is 340 and minimum is 260, and according to an official GRE score document, the mean test score for all individuals from July 1,2014 to June 30,2017 (almost 1,700,000 test taker) is 306.35 which rounds to 306 with an average standard deviation of 7.19\n\nsource: https:\/\/www.ets.org\/s\/gre\/pdf\/gre_interpreting_scores.pdf","ee3a8bc7":"THE LOR is ordered same as the SOP","bf867ec5":"#### The Three Features for Linear Regression","28466de4":"Test for Train Dataset:","2a8d058c":"### Preparing Data for Classification","eea4ceee":"### 2. K-means Clustering","8a0cbea5":"### 2. Support Vector Machine","07830d8c":"### 6. K Nearest Neighbors Classification","d35a6883":"* The elbow method is used to determine the best number of clusters for k-means clustering. The number is 3.","f591b05a":"#### Preparing Data for Classification","38ce8a5d":"It is evident that the most contribution factors to the chance of admission are CGPA, GRE Score and TOEFL Score","a741a4b7":"### Purpose\n\nTo apply for a master's degree is a very expensive and intensive work. With this kernel, students will guess their capacities and they will decide whether to apply for a master's degree or not.\n\n\nSo, basically this set is about the Graduate Admissions data i.e. Given a set of standardized scores like GRE, TOEFL, SOP standard scores, LOR standard scores, what is probability ( basically i have done a YES\/NO scenario ) of gaining admission into a particular school. All those folks who are preparing for MS, might point out this question, from where did you get SOP & LOR scores. These aren\u2019t public figures ? I mean yes, it might not be public, but dont you think universities might be grading these applications on some scale of rating so that the scores can be standardized. Hence the SOP, LOR scores.\n\n### Dataset\n\nThis dataset is created for prediction of graduate admissions and the dataset link is below:\n\n* Features in the dataset:\n\n* GRE Scores (290 to 340)\n\n* TOEFL Scores (92 to 120)\n\n* University Rating (1 to 5)\n\n* Statement of Purpose (1 to 5)\n\n* Letter of Recommendation Strength (1 to 5)\n\n* Undergraduate CGPA (6.8 to 9.92)\n\n* Research Experience (0 or 1)\n\n* Chance of Admit (0.34 to 0.97)","d8758483":"#### Import Libraries","0f6a0da4":"### Step 2:  Data Analysis or Data Exploration","0b5e5d49":"# Graduate Admission Analysis and Prediction\n\n![](https:\/\/learnrhome.files.wordpress.com\/2019\/05\/graduate.png)\n\n![](http:\/\/debarghyadas.com\/writes\/assets\/grad-main.png)","52820a7e":"##### CGPA\nCumulative Grade Points Average (CGPA) is a measure of a student's marks thus his performance in his undergraduate degree.","d7592a12":"How good the university is a value between 1 and 5 in integer increment , and since it has positive correlation factors with other variables it's clear that 5 is the highest rating and 1 is the lowest.","eced86e1":"Are students in this sample too good?\n\nFirst looking at the students LOR, SOP and University Ratings, most students score (4-5) on the scales, not many scored (1-2.5).\n\nNonetheless, comparing means for their GRE and TOEFL scores, which are of a universal criteria, they clearly perform better than the average student as the ETS states.\n\nTo conclude, it seems only wise to consider the sample to be somehow above average.","b724d440":"### 1. Logistic Regression ","f6b79a0f":"### 2. Random Forest","e2ce492d":"##### Chance of Admission\n\nLet's first take a review on the chances of admission.","452ef65a":"##### Test for Train Dataset:","1dba289a":"It's evident that the sample over performs in the TOEFL.","9b0707ec":"##### University Rating\nThe rating of the university the student completed his undergraduate degree from.","68ed5954":"## CLUSTERING ALGORITHMS (UNSUPERVISED MACHINE LEARNING ALGORITHMS)\n","b10d72b0":"## Prediction Models : Classification Algorithm (Supervised Machine Learning)\n\n1. Logistic Regression\n2. Support Vector Machine\n3. Gaussian Naive Bayes\n4. Decision Tree Classification\n5. Random Forest Classification\n6. K Nearest Neighbors (KNN) Classification","745f367d":"### Step4 : Test Algorithm","8c1b1404":"### 1. Preparing Data for Clustering (PCA)","81a16433":"## Prediction Models : Regression Algorithm (Supervised Machine Learning)\n\n1. Linear Regression\n2. Decision Tree\n3. Random Forest","9d91cf11":"Exploring this variable, it's ordered from 1 to 5 with 0.5 increments, although the criteria for assessment isn't specified, which will make it harder to deal with new entries.","06641ac5":"### THE THREE IMPORTANT FEATURES","2d93b651":"#### Correlation between All Columns\n\nThe 3 most important features for admission to the Master: CGPA, GRE SCORE, and TOEFL SCORE\n\nThe 3 least important features for admission to the Master: Research, LOR, and SOP","e5244ae6":"And since one of our goals is to predict the chance of admission, let's take a look on how the different variables correlate with it.","280516b6":"### 5. Random Forest Classification","b62fa792":"The sample's GRE score mean is 316 which is a little bit higher than the mean mentioned previously (306)","c9b2491b":"### 4. Decision Tree Classification "}}