{"cell_type":{"7d278375":"code","12289e90":"code","0c30826b":"code","546ec376":"code","60d2cb95":"code","305fc653":"code","ee9944fe":"code","47045a6e":"code","6f031b02":"code","071c6f46":"code","7f9e4cb6":"code","e0576571":"code","c83a9d8a":"code","dd82f809":"code","b800bf75":"code","282fc83c":"code","bce336fe":"code","4357e8d7":"code","30ef715e":"code","cd068230":"code","10b7cde7":"code","c397c3cb":"code","348ac233":"code","08f518c7":"code","4dfd2362":"code","bafeb28f":"code","54e4bb29":"code","95874562":"code","2c451a95":"code","99ea857d":"code","3cc45bd0":"code","d543bb64":"code","a5d31897":"code","b2c68abf":"code","518a6bce":"code","89dd308e":"code","900ed883":"code","80749243":"code","3e06b34b":"code","5402d32c":"markdown","c3b7bf72":"markdown","488ac605":"markdown","71460efb":"markdown","a2644287":"markdown","d5ee9c60":"markdown","ee6ab5e6":"markdown","64180860":"markdown","806138ef":"markdown","0cedb14d":"markdown","38a0301b":"markdown","9a29af29":"markdown","31bc3521":"markdown"},"source":{"7d278375":"import numpy as np \nimport pandas as pd \nimport seaborn as sns\nimport matplotlib.pyplot as plt\nplt.rcParams['figure.figsize'] = (16,8)\nplt.style.use(\"fivethirtyeight\")","12289e90":"df_train = pd.read_csv('..\/input\/heart-attack-analysis-prediction-dataset\/heart.csv')\ndf_test = pd.read_csv('..\/input\/heart-attack-analysis-prediction-dataset\/o2Saturation.csv')","0c30826b":"df_train.head()","546ec376":"df_train.shape","60d2cb95":"df_train.info()","305fc653":"# Checking null values \ndf_train.isnull().sum().sort_values(ascending = False)","ee9944fe":"df_train.describe()","47045a6e":"df_train.duplicated().sum()","6f031b02":"df_train.nunique()","071c6f46":"# Correlation\nplt.figure(figsize = (16,16))\nsns.heatmap(df_train.corr(),center = 0, square = True, annot =True, lw= 0.3)\nplt.show()","7f9e4cb6":"# now Looking at the age \nsns.countplot(x ='age', data = df_train)\nplt.title('No of peoples by their age', fontsize = 20)\nplt.xlabel('Age',fontsize =15 )\nplt.ylabel('Numbers of peooples',fontsize =15 )\nplt.show()","e0576571":"#distribution plot of age \nsns.distplot(df_train['age'], color='red')\nplt.title('Distribution of Ages', fontsize=15, pad = 10)\nplt.xlabel('Ages', fontsize=10)\nplt.ylabel('Count', fontsize=10)\nplt.show()","c83a9d8a":"# countplot of age with respect to output\n\nsns.countplot(x = df_train['age'],hue=df_train['output']);","dd82f809":"print(df_train[\"age\"].max())","b800bf75":"\n\nsex_data = df_train.sex.map({1: 'Male', 0: 'Female'})\ntarget_data = df_train.output.map({1: 'higher chances of heart attack', 0: 'lesser chances of heart attack'})\nsns.countplot(hue = target_data, x = sex_data, data = df_train)\nplt.title(\"No.of heart attacks with respect to gender \", fontsize = 20);\n\n","282fc83c":"\ntarget_data = df_train.output.map({1: 'higher chances of heart attack', 0: 'lesser chances of heart attack'})\nsns.barplot(x = 'fbs',y = target_data, data = df_train)\nplt.title(\"Distribution of fasting Blood Sugar with respect to Heart Attack\" , fontsize= 20)\nplt.xlabel('fbs',fontsize = 15)\nplt.ylabel('output',fontsize = 15)\nplt.xticks();","bce336fe":"\norders = (df_train.groupby(['cp']).mean().sort_values(by ='output', ascending = False)).index\nsns.barplot(x = 'cp', y = 'output', data = df_train, order = orders)\nplt.title(\"Distribution of Chest Pain w.r.t. Heart Attack\" , fontsize= 20)\nplt.xlabel('cp',fontsize = 15)\nplt.ylabel('output',fontsize = 15);","4357e8d7":"\ntarget_data = df_train.output.map({1: 'higher chances of heart attack', 0: 'lesser chances of heart attack'})\nsns.countplot(x = 'caa', hue = target_data, data = df_train)\nplt.title(\"Distribution of no. of major blood vessels w.r.t. Heart Attack\" , fontsize= 20)\nplt.xlabel('caa',fontsize = 15)\nplt.ylabel('output',fontsize = 15);","30ef715e":"\ncp_data = df_train.cp.map({0:'typical angina',1:'atypical angina',2:'non-anginal pain',3:'asymptomatic'})\nsns.violinplot(x = cp_data, y= 'trtbps', data = df_train)\nplt.title('resting blood pressure (in mm Hg) vs Chest Pain', fontsize = 20)\nplt.xlabel('cp',fontsize = 15)\nplt.ylabel('trtbps',fontsize = 15)\nplt.xticks(rotation =90)\nplt.show();","cd068230":"\nsns.histplot(x = 'thalachh', data = df_train)\n# thalach : maximum heart rate achieved\nplt.title(' Max heart bits count while heart attack', fontsize = 20)\nplt.xlabel('heart bits rate', fontsize = 15);","10b7cde7":"\"\"\"oldpeak: Previous peak\"\"\"\nsns.histplot(x = 'oldpeak', data = df_train)\n\nplt.xlabel('Previous peak')","c397c3cb":"\ntarget_data = df_train.output.map({0:'less chance',1:'more chance'})\nsns.countplot(x = target_data,data = df_train)\nplt.xticks(rotation=90)\nplt.ylabel('No. of people')\nplt.xlabel('people are suffured or not')\nplt.title('No. of people who got heart attack', fontsize = 20)","348ac233":"print(df_train['output'].value_counts())\nratio = df_train['output'].value_counts()\/len(df_train['output']) *100\nratio\n# below result shows 54.3% people are suffered from heart attack \n## below result shows 45.7% people are not suffered from heart attack \n","08f518c7":"#blood pressure \nsns.distplot(x=df_train['trtbps'],hist_kws=dict(edgecolor=\"k\", linewidth=2))\nplt.xlabel('Blood pressure')\nplt.ylabel('Density of blood pressue')\nplt.title('Distribution of blood pressure w.r. to intensity of blood pressure')","4dfd2362":"#cholesterol rate\nsns.distplot(x= df_train['chol'],hist_kws=dict(edgecolor=\"k\", linewidth=2))\nplt.xlabel('Cholesterol rate')\nplt.ylabel('Density of cholesterol rate')\nplt.title('Distribution of Cholesterol rate w.r. to intensity of Cholesterol rate')\nplt.show()","bafeb28f":"#Making list of disease\ndisease = ['cp','fbs','restecg','exng','slp','caa','thall']\nlist(enumerate(disease))","54e4bb29":"df_train['restecg'].value_counts()\n#resting electrocardiographic results\n# 0 : Normal\n# 1: having ST-T wave abnormality (T wave inversions and\/or ST elevation or depression of > 0.05 mV)\n# 2: showing probable or definite left ventricular hypertrophy by Estes' criteria","95874562":"plt.figure(figsize = (13,30))\nfor i in enumerate(disease):\n    plt.subplot(6,2,i[0]+1)\n    sns.countplot(x=i[1], hue = 'output',data =df_train)\n    \nplt.show()","2c451a95":"df_train.head()","99ea857d":"X = df_train.iloc[:,:-1]\nY = df_train.iloc[:,-1]","3cc45bd0":"from sklearn.model_selection import train_test_split\nx_train,x_test,y_train,y_test = train_test_split(X,Y,test_size = (0.3),random_state = 5)","d543bb64":"from sklearn import svm\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.model_selection import GridSearchCV","a5d31897":"model_params = {'svm':{'model':svm.SVC(gamma ='auto'),'params':{\"C\":[1,20,40],'kernel':['rbf','linear']}},\n               'random_forest':{'model':RandomForestClassifier(),'params':{'n_estimators':[1,20,40]}},\n               'logistic_regression':{'model':LogisticRegression(solver = 'liblinear',multi_class ='auto',penalty='l1'),'params':{'C':[1,20,40],}}\n              }\n    \n    ","b2c68abf":"model_params.items()","518a6bce":"scores = []\n\nfor model_name, mp in model_params.items():\n    clf =  GridSearchCV(mp['model'], mp['params'], cv=5, return_train_score=False)\n    clf.fit(x_train, y_train)\n    scores.append({\n        'model': model_name,\n        'best_score': clf.best_score_,\n        'best_params': clf.best_params_\n    })\n    \ndf2 = pd.DataFrame(scores,columns=['model','best_score','best_params'])\ndf2","89dd308e":"model_lg = LogisticRegression(solver = 'liblinear',multi_class  = 'auto')\nmodel_lg.fit(x_train,y_train)","900ed883":"pred = model_lg.predict(x_test)\npred","80749243":"Y.values","3e06b34b":"from sklearn.metrics import confusion_matrix, classification_report\nprint(confusion_matrix(y_test, pred))\nprint(classification_report(y_test, pred))","5402d32c":"### Observations:\n- Maximum heart attack patients are from the age of 41 to 65 (approximately).","c3b7bf72":"## REFERRAL CODE: AIRSS1129\n## **Nikhil Shrestha**","488ac605":"## Visualization ","71460efb":"The people with maximum heart rate have more risk of heart attack - (thall) - maximum heart rate achieved","a2644287":"***Other metrics score***","d5ee9c60":"### Distribution plot of blood pressure and Cholesterol rate","ee6ab5e6":"Observation: \n- Females have less chances of heart attack than males.\n- 0= higher chances of heart attack 1= lesser chances of heart attack","64180860":"**Heart Attack Analysis & Prediction**\n\n\n- Analysis & Predict Heart Attack based on Age, Gender, No. of disease they have and some other aspects\nhttps:\/\/www.kaggle.com\/rashikrahmanpritom\/heart-attack-analysis-prediction-dataset\/tasks?taskId=3833","806138ef":"# **Assignment 8**\n## **Regex Software Services**","0cedb14d":"### Lets Check on the basis Of Blood pressure","38a0301b":"## Training Different ML Models \n### Hyperparameter tuning ","9a29af29":"### Relation of output with respect to other disease ","31bc3521":"Logistic regresion - Best score"}}