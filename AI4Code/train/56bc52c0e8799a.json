{"cell_type":{"d810d5d5":"code","70575592":"code","90bb9497":"code","f38ea646":"code","c132d4b9":"code","316a9fea":"code","413ad897":"code","91a34513":"code","f8dec5cf":"code","5f177e9f":"code","e9b76c4f":"code","79393036":"code","c955411b":"code","d7f205ed":"code","ad1bce5c":"code","4e425ba8":"code","d160cefc":"code","ce20f18c":"code","f531d34f":"code","945d1af9":"code","a29452fa":"code","486363e9":"code","a6424950":"markdown","a9b22136":"markdown","62df3008":"markdown","617dea6f":"markdown"},"source":{"d810d5d5":"import numpy as np\nimport pandas as pd\nfrom pathlib import Path\nfrom fastai.text.all import *","70575592":"datadir = Path.cwd().parent \/ 'input' \/ 'nlp-getting-started'","90bb9497":"df_train = pd.read_csv(datadir\/'train.csv')\ndf_test = pd.read_csv(datadir\/'test.csv')\ndf_submission = pd.read_csv(datadir\/'sample_submission.csv')","f38ea646":"df_train.head()","c132d4b9":"dls_lm = TextDataLoaders.from_df(df_train, text_col='text', is_lm=True)","316a9fea":"dls_lm.show_batch(max_n=2)","413ad897":"learn_lm = language_model_learner(\n    dls_lm, AWD_LSTM, drop_mult=0.3, \n    metrics=[accuracy, Perplexity()]).to_fp16()","91a34513":"learn_lm.fit_one_cycle(1, 2e-2)","f8dec5cf":"learn_lm.unfreeze()\nlearn_lm.fit_one_cycle(5,2e-3)","5f177e9f":"learn_lm.save_encoder('finetuned')","e9b76c4f":"dls = TextDataLoaders.from_df(df_train, text_col='text', label_col='target')","79393036":"dls.show_batch(max_n=2)","c955411b":"??text_classifier_learner","d7f205ed":"learn = text_classifier_learner(dls, AWD_LSTM, drop_mult=0.5, metrics=accuracy)","ad1bce5c":"learn.load_encoder('finetuned')","4e425ba8":"lr_min,lr_steep = learn.lr_find()\nprint(f\"Minimum\/10: {lr_min:.2e}, steepest point: {lr_steep:.2e}\")","d160cefc":"learn.fine_tune(5, 6e-3)","ce20f18c":"text_list = list(df_test['text'].values)","f531d34f":"%%capture\nprediction = [learn.predict(i)[0] for i in text_list]","945d1af9":"df_submission.head()","a29452fa":"df_submission['target'] = prediction\ndf_submission['target'] = df_submission['target'].astype(int)","486363e9":"df_submission.to_csv('submission.csv', index=False)","a6424950":"### then train a classification model","a9b22136":"### Make submission","62df3008":"### train a language model first","617dea6f":"### Use Pretrained model"}}