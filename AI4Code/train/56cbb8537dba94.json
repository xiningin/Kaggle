{"cell_type":{"d1f78727":"code","ba546c3b":"code","36788106":"code","0be904c1":"code","1c892321":"code","85b257fb":"code","2b672605":"code","f73bd795":"code","489de475":"code","a50427f1":"code","5415e380":"code","ee29bda4":"code","4457cc40":"code","a2aa328b":"code","d3e70c6b":"code","0ecabfa9":"code","a243593f":"code","43ad520a":"markdown","d0b41d36":"markdown","974855d5":"markdown","4eed5db7":"markdown","7f1f3c5d":"markdown"},"source":{"d1f78727":"import numpy as np \nimport pandas as pd \nimport os,gc,pathlib\nfrom sklearn.metrics import confusion_matrix\nfrom fastai import *\nfrom fastai.vision import *\nfrom fastai.vision.models import *\nprint(os.listdir(\"..\/input\"))\nimport torchvision.models as models","ba546c3b":"DATA_DIR='..\/input\/brain_tumor_dataset'","36788106":"os.listdir(f'{DATA_DIR}')","0be904c1":"data = ImageDataBunch.from_folder(DATA_DIR, train=\".\", \n                                  valid_pct=0.2,\n                                  ds_tfms=get_transforms(flip_vert=True, max_warp=0),\n                                  size=224,bs=8, \n                                  num_workers=0).normalize(imagenet_stats)\nprint(f'Classes: \\n {data.classes}')","1c892321":"data.show_batch(rows=10, figsize=(10,5))","85b257fb":"learn = cnn_learner(data, models.resnet152, metrics=accuracy, model_dir=\"\/tmp\/model\/\")","2b672605":"learn.lr_find()\nlearn.recorder.plot()","f73bd795":"learn.fit_one_cycle(10,3e-3)","489de475":"learn.save('stage-1')","a50427f1":"learn.unfreeze()","5415e380":"learn.lr_find()\nlearn.recorder.plot()","ee29bda4":"learn.fit_one_cycle(10,max_lr=slice(1e-6,1e-5))","4457cc40":"learn.save('stage-2')","a2aa328b":"learn.recorder.plot_losses()","d3e70c6b":"interp = ClassificationInterpretation.from_learner(learn)","0ecabfa9":"interp.plot_top_losses(9, figsize=(15,11))","a243593f":"interp.plot_confusion_matrix(figsize=(8,8), dpi=60)","43ad520a":"# Train","d0b41d36":"# Make Data","974855d5":"# Model Build","4eed5db7":"# Import Libraries","7f1f3c5d":"# Check Result"}}