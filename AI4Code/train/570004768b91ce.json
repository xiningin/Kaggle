{"cell_type":{"1321b487":"code","8a4ef37e":"code","4bdb7ede":"code","88970417":"code","074122dc":"code","2769fb8f":"code","3b634d8a":"code","a150bc93":"code","06fbaa46":"code","ae62baba":"code","bbb239b4":"code","ffeffd58":"markdown","478aff69":"markdown","860bf20b":"markdown","25cf8e4d":"markdown","f805e735":"markdown","f7a4af42":"markdown"},"source":{"1321b487":"import os\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nfrom tensorflow import keras\nfrom tensorflow.keras.preprocessing.image import ImageDataGenerator","8a4ef37e":"test = pd.read_csv('..\/input\/cifar10-mu\/sample_submission.csv')\n\nprint('Test Set Size:', test.shape)","4bdb7ede":"test.head()","88970417":"test_path = \"..\/input\/cifar10-mu\/test_images\/\"\nprint('Test Images:', len(os.listdir(test_path)))","074122dc":"BATCH_SIZE = 64\n\ntest_datagen = ImageDataGenerator(rescale=1\/255)\n\ntest_loader = test_datagen.flow_from_dataframe(\n    dataframe = test,\n    directory = test_path,\n    x_col = 'filename',\n    batch_size = BATCH_SIZE,\n    shuffle = False,\n    class_mode = None,\n    target_size = (32,32)\n)","2769fb8f":"cnn = keras.models.load_model('..\/input\/models\/CIFAR Competition\/cifar10_v01.h5')\ncnn.summary()","3b634d8a":"test_probs = cnn.predict(test_loader)\nprint(test_probs.shape)","a150bc93":"test_pred = np.argmax(test_probs, axis=1)\nprint(test_pred[:10])","06fbaa46":"submission = pd.read_csv('..\/input\/cifar10-mu\/sample_submission.csv')\nsubmission.head()","ae62baba":"submission.label = test_pred\nsubmission.head()","bbb239b4":"submission.to_csv('submission.csv', header=True, index=False)","ffeffd58":"# Load Model","478aff69":"# Prepare Submission","860bf20b":"# Data Generator","25cf8e4d":"# Test Predictions","f805e735":"# Import Statements","f7a4af42":"# Load DataFrame"}}