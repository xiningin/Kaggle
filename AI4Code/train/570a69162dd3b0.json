{"cell_type":{"585c42fd":"code","7a43753f":"code","d03a7f3e":"code","717ad3e0":"code","4f7f6004":"code","e153a5b6":"code","a087a7e2":"code","7e943837":"code","b8816c65":"code","abd2e825":"code","387465cc":"code","230ca87b":"code","ebb08ca7":"code","5cb691de":"markdown","0b0272ad":"markdown","832f3cda":"markdown","594c58c7":"markdown","b879f9c0":"markdown","dc1addb0":"markdown","07b989a0":"markdown","eb24fae7":"markdown","88680a69":"markdown","63ae72cd":"markdown"},"source":{"585c42fd":"from fastai.vision import *\nfrom fastai.metrics import error_rate","7a43753f":"cp -r \/kaggle\/input\/fruits-360_dataset\/ \/tmp","d03a7f3e":"path= '\/tmp\/fruits-360_dataset\/fruits-360\/'","717ad3e0":"data=ImageDataBunch.from_folder(path,train='Training',valid='Test',size=256,bs=64).normalize(imagenet_stats)\ndata.show_batch(rows=3,figsize=(8,8))","4f7f6004":"learner34=cnn_learner(data,models.resnet34,metrics=accuracy)","e153a5b6":"learner34.fit_one_cycle(4)","a087a7e2":"learner50=cnn_learner(data,models.resnet50,metrics=accuracy)","7e943837":"learner50.lr_find()\nlearner50.recorder.plot()","b8816c65":"lr=1e-2","abd2e825":"learner50.fit_one_cycle(4,slice(lr))","387465cc":"interp=ClassificationInterpretation.from_learner(learner50)\ninterp.plot_top_losses(9,figsize=(12,12))","230ca87b":"interp.most_confused(min_val=1)","ebb08ca7":"learner50.export(\"\/kaggle\/working\/fruitsmodel.pkl\")","5cb691de":"Results are quite good.\n\nNow let's see which cases we failed.","0b0272ad":"Current dataset directory is read-only; we might need to modify some training set data.\nMoving to \/tmp gives us Write permission on the folder.","832f3cda":"Creating our databunch object. Fortunately this dataset uses imagenet style, so our factory method will suffice. We can experiment using different size values, I have found 224 to be optimal.\n\nFastai vision models are pretrained models on Imagenet. We are essentially using transfer learning here. So we should normalize our dateset using imagenet statistics as well.","594c58c7":"Hi, This is very first time I tried to build a deep learning model. if there are some error in my model please let me know\nI tried out fruit dataset with rasnet34(fastai) model","b879f9c0":"Thank you for sticking around.","dc1addb0":"We have choose a maximum learning rate where the curve is most steep. So I've chosen 0.01 for this. Our CNN uses discriminative learning rate, so our max learning rate will be 0.01.","07b989a0":"Now let's create our learner. I'm using resnet34 for now with accuracy as metric.\nResnet34 trains faster so let's go with that.","eb24fae7":"Let's find our learning rate for resnet50 first. It's always a good idea to pass the learning rate while fitting.","88680a69":"This model will tell you about Fruit just by seeing there images. you can download the dataset that I used from kaggle dataset (https:\/\/www.kaggle.com\/moltean\/fruits). I have used a Convolutional neural network to build this model.\n\nThis project is a homework assignment for Fastai's Deep learning for coders lesson 1","63ae72cd":"99% Accuracy using resnet34 is great. We might be able to increase our accuracy even more with resent50.\nLet's try that!"}}