{"cell_type":{"2f304552":"code","274ef9e1":"code","b62adcd5":"code","0cd0f5c8":"code","4f56f36a":"code","7801b882":"code","744953ed":"code","f7c36bc5":"code","7a593dac":"code","46da257c":"code","33dc5642":"code","4a80c989":"code","d954ade9":"code","705a90e1":"code","1696caed":"code","ec4c913f":"code","22107ba6":"code","179e4215":"code","2330b666":"code","fbb52f00":"code","37172c4c":"code","1b1350d1":"code","298dad15":"code","af511c29":"code","ac54b1de":"code","8b365ba4":"code","31ad8837":"code","410d9f8a":"code","35d4a39a":"code","e6e6af3d":"code","3781d27a":"markdown","cc0118d4":"markdown","451d6676":"markdown","dc2cb340":"markdown","4f021e5c":"markdown","6243b508":"markdown","653e7296":"markdown","9e2170e3":"markdown"},"source":{"2f304552":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","274ef9e1":"majordir='\/kaggle\/input\/covid19-us-county-trend\/'\ndatadir=majordir+'csse_covid_19_daily_reports\/'\ndate_today=29","b62adcd5":"covid_data_world_daily_0322=pd.read_csv(datadir+'03-22-2020.csv')\ncovid_data_world_daily_0322.rename(columns={'Confirmed':'Confirmed_0322'},inplace=True)\ncovid_data_world_daily_0322.head()\ncovid_data_us_daily_0322=covid_data_world_daily_0322[covid_data_world_daily_0322['Country_Region']=='US'].copy()\ncovid_data_us_daily_0322.shape","0cd0f5c8":"\nfor i in range(23,date_today):\n    dataset=datadir+'03-'+str(i)+'-2020.csv'\n    col='Confirmed_03'+str(i)\n    covid_data_world_daily=pd.read_csv(dataset)\n    covid_data_world_daily.rename(columns={'Confirmed':col},inplace=True)\n    covid_data_us_daily=covid_data_world_daily[covid_data_world_daily['Country_Region']=='US'].copy()\n\n    if i==23:        \n        covid_data_us_dailytrend=covid_data_us_daily_0322[['FIPS','Confirmed_0322']].merge(covid_data_us_daily[['FIPS',col]],on='FIPS').dropna()\n    else:\n        print(i)\n        covid_data_us_dailytrend=covid_data_us_dailytrend.merge(covid_data_us_daily[['FIPS',col]],on='FIPS').dropna()\ncovid_data_us_dailytrend.shape","4f56f36a":"covid_data_us_daily_0322.head()","7801b882":"covid_data_us_dailytrend.dropna().shape\ncovid_data_us_dailytrend.head()","744953ed":"census_df_fips = pd.read_excel(majordir+'PopulationEstimates_us_county_level_2018.xlsx',skiprows=1)\ncensus_df_fips.head()","f7c36bc5":"census_df_fips.FIPS=census_df_fips.FIPS.astype(float)","7a593dac":"census_df_fips_covid=census_df_fips.merge(covid_data_us_dailytrend,on='FIPS') ","46da257c":"census_df_fips_covid.head()","33dc5642":"for i in range(22,date_today):\n    col='Confirmed_03'+str(i)\n    col_10000='Confirmed_per10000_03'+str(i)\n    census_df_fips_covid[col_10000]=10000*(census_df_fips_covid[col]\/census_df_fips_covid['POP_ESTIMATE_2018'])","4a80c989":"census_df_fips_covid.head()","d954ade9":"census_df_fips_covid_top3=census_df_fips_covid.sort_values(by='Confirmed_per10000_0324',ascending=False).reset_index().head(3)","705a90e1":"census_df_fips_covid_top3","1696caed":"# plt.plot(census_df_fips_covid_top3['Area_Name'],census_df_fips_covid_top3[['Confirmed_per10000_0322','Confirmed_per10000_0323','Confirmed_per10000_0324','Confirmed_per10000_0325']],'*')","ec4c913f":"census_df_fips_covid_50000=census_df_fips_covid[(census_df_fips_covid['POP_ESTIMATE_2018']>50000) & (census_df_fips_covid['Confirmed_0322']>10)]\nplt.plot(census_df_fips_covid_50000['POP_ESTIMATE_2018'],census_df_fips_covid_50000[['Confirmed_per10000_0322']],'*')\nplt.xscale('log')\nplt.yscale('log')\nplt.xlabel('POP_ESTIMATE_2018')\nplt.ylabel('Confirmed_per10000_0322')","22107ba6":"current_confirm='Confirmed_03' + str(date_today)\ncurrent_confirm_10000='Confirmed_per10000_03' + str(date_today-1)\ncensus_df_fips_covid_50000=census_df_fips_covid[(census_df_fips_covid['POP_ESTIMATE_2018']>50000) & (census_df_fips_covid['Confirmed_0324']>10)]\nplt.plot(census_df_fips_covid_50000['POP_ESTIMATE_2018'],census_df_fips_covid_50000[[current_confirm_10000]],'*')\nplt.xscale('log')\nplt.yscale('log')\nplt.xlabel('POP_ESTIMATE_2018')\nplt.ylabel(current_confirm_10000)","179e4215":"census_df_fips_covid_50000=census_df_fips_covid[(census_df_fips_covid['POP_ESTIMATE_2018']>50000) & (census_df_fips_covid['Confirmed_0322']>10)]\nplt.plot(census_df_fips_covid_50000['POP_ESTIMATE_2018'],census_df_fips_covid_50000[['Confirmed_per10000_0322']],'*')\nplt.xscale('log')\nplt.yscale('log')\nplt.xlabel('POP_ESTIMATE_2018')\nplt.ylabel('Confirmed_per10000_0322')\n\ncurrent_confirm='Confirmed_03' + str(date_today)\ncurrent_confirm_10000='Confirmed_per10000_03' + str(date_today-1)\ncensus_df_fips_covid_50000=census_df_fips_covid[(census_df_fips_covid['POP_ESTIMATE_2018']>50000) & (census_df_fips_covid['Confirmed_0324']>10)]\nplt.plot(census_df_fips_covid_50000['POP_ESTIMATE_2018'],census_df_fips_covid_50000[[current_confirm_10000]],'*')\nplt.xscale('log')\nplt.yscale('log')\nplt.xlabel('POP_ESTIMATE_2018')\nplt.ylabel(current_confirm_10000)\n","2330b666":"# census_df_fips_covid_100000.sort_values(by='Confirmed_per10000_0324',ascending=False).reset_index(drop=True).head(50)","fbb52f00":"census_df_fips_covid_50000.sort_values(by=current_confirm_10000,ascending=False).reset_index(drop=True).head(10)","37172c4c":"census_df_fips_covid_50000.sort_values(by=current_confirm_10000,ascending=False).reset_index(drop=True).drop_duplicates(['FIPS']).tail(10)","1b1350d1":"!pip install vega_datasets","298dad15":"import altair as alt\nfrom vega_datasets import data","af511c29":"us_counties = alt.topo_feature(data.us_10m.url, 'counties')","ac54b1de":"covid_data_us_dailytrend_1=census_df_fips_covid[['FIPS','Confirmed_per10000_0322','Confirmed_per10000_0323','Confirmed_per10000_0324','Confirmed_per10000_0325','Confirmed_per10000_0326','Confirmed_per10000_0327','Confirmed_per10000_0328']]\ncovid_data_us_dailytrend_1.columns=['fips','22','23','24','25','26','27','28']\ncovid_data_us_dailytrend_1.loc[:,'fips'] =covid_data_us_dailytrend_1.loc[:,'fips'].astype(int)\ncovid_data_us_dailytrend_1.sort_values(by='28',ascending=False).head()","8b365ba4":"slider = alt.binding_range(min=22, max=28, step=1)\nselect_day = alt.selection_single(name=\"day\", fields=['day'],\n                                   bind=slider, init={'day': 22})\ncolumns_1=['22','23','24','25','26','27','28']\n\nalt.Chart(us_counties).mark_geoshape(\n    stroke='black',\n    strokeWidth=0.05\n).project(\n    type='albersUsa'\n).transform_lookup(\n    lookup='id',\n    from_=alt.LookupData(covid_data_us_dailytrend_1, 'fips', columns_1)\n).transform_fold(\n    columns_1, as_=['day', 'confirmed_per_pop']\n).transform_calculate(\n    day='parseInt(datum.day)',\n    confirmed_per_pop='isValid(datum.confirmed_per_pop) ? datum.confirmed_per_pop : -1'  \n).encode(\n    color = alt.condition(\n        'datum.confirmed_per_pop > 0',\n        alt.Color('confirmed_per_pop:Q', scale=alt.Scale(scheme='plasma')),\n        alt.value('#dbe9f6')\n    )).add_selection(\n    select_day\n).properties(\n    width=700,\n    height=400\n).transform_filter(\n    select_day\n)","31ad8837":"covid_data_us_dailytrend_1=covid_data_us_dailytrend_1.drop(1905).copy()\ncovid_data_us_dailytrend_1=covid_data_us_dailytrend_1.drop(1934).copy()","410d9f8a":"max_val=covid_data_us_dailytrend_1[['22','23','24','25','26','27','28']].max().max()\ncovid_data_us_dailytrend_1.loc[3191,'22']=max_val\ncovid_data_us_dailytrend_1.loc[3191,'23']=max_val\ncovid_data_us_dailytrend_1.loc[3191,'24']=max_val\ncovid_data_us_dailytrend_1.loc[3191,'25']=max_val\ncovid_data_us_dailytrend_1.loc[3191,'26']=max_val\ncovid_data_us_dailytrend_1.loc[3191,'27']=max_val\ncovid_data_us_dailytrend_1.loc[3191,'28']=max_val","35d4a39a":"covid_data_us_dailytrend_1.tail()","e6e6af3d":"slider = alt.binding_range(min=22, max=28, step=1)\nselect_day = alt.selection_single(name=\"day\", fields=['day'],\n                                   bind=slider, init={'day': 22})\ncolumns_1=['22','23','24','25','26','27','28']\n\nalt.Chart(us_counties).mark_geoshape(\n    stroke='black',\n    strokeWidth=0.05\n).project(\n    type='albersUsa'\n).transform_lookup(\n    lookup='id',\n    from_=alt.LookupData(covid_data_us_dailytrend_1, 'fips', columns_1)\n).transform_fold(\n    columns_1, as_=['day', 'confirmed_per_pop']\n).transform_calculate(\n    day='parseInt(datum.day)',\n    confirmed_per_pop='isValid(datum.confirmed_per_pop) ? datum.confirmed_per_pop : -1'  \n).encode(\n    color = alt.condition(\n        'datum.confirmed_per_pop > 0',\n        alt.Color('confirmed_per_pop:Q', scale=alt.Scale(scheme='plasma')),\n        alt.value('#dbe9f6')\n    )).add_selection(\n    select_day\n).properties(\n    width=700,\n    height=400\n).transform_filter(\n    select_day\n)","3781d27a":"#### New york might domainate the color changes. lets remove New york county,NY and westchester, NY. Also since the scale adapts for each day, I prevented it by setting the maximum value observed so far to an arbitrary county for all days (weston county wyoming where seems no case has been oberved so far).suggestion are welcome for better solution ","cc0118d4":"# Lets see how the confirmed cases spread over time in the map.","451d6676":"##### Lets plot and observe counties that has atleast 50000 population and over 10 confirmed cases.","dc2cb340":"## Infection relative to the size of the population\n### Infection in each county normalized to its population count and presented as per 10000 people unit","4f021e5c":"## The More spread is happening middle to east and midwest to west. The midwest region still has relatively low cases.","6243b508":"#### The yellow square block in middle top left corresponds to  weston county wyoming which i had set arbitrarilty to prevent the scale changing for each day. It has no cases so far","653e7296":"### I am guessing the negative trend in general with population indicates more spreading as of now stems from an individual source (who caught virus through travel and might be attending a large gathering like party,funeral,church event in his\/her locality) rather community spread.","9e2170e3":"## The below is only basic data analysis. I would request folks to do more analysis and visualization (trends,maps etc) to create meaningful insights as it will be useful in current situation."}}