{"cell_type":{"4aa0f7b8":"code","d350966f":"code","0a179227":"code","08f145d5":"code","dbe2e13b":"code","f47653ef":"code","e037fe94":"code","2f984f5d":"code","8b0cb51f":"markdown","a80f1171":"markdown","4d10b63e":"markdown","56f7e286":"markdown","936424d5":"markdown","4e2bdbd0":"markdown","dbad6ac3":"markdown"},"source":{"4aa0f7b8":"%pylab inline\nfrom matplotlib.pyplot import style\nstyle.use('https:\/\/raw.githubusercontent.com\/JoseGuzman\/minibrain\/master\/minibrain\/paper.mplstyle')\nimport pandas as pd\n","d350966f":"data = pd.read_csv('..\/input\/advertising-data\/Advertising.csv', index_col=0)\ndata.head()\nprint(f'The dataset contains {data.shape[0]} observations')\n","0a179227":"import statsmodels.api as sm","08f145d5":"# Simple linear regression with ordinary least squares with statmodels\nx = data.loc[:,['TV']] # DataFrame\ny = data['Sales']\n\n## fit a OLS model with y = b + w*TV\nx = sm.add_constant(x)\nest = sm.OLS(y, x).fit()\nest.summary()","dbe2e13b":"est.params","f47653ef":"print(f'sales = {est.params[0]:2.4f} + {est.params[1]:2.4f}tv')","e037fe94":"# Similarly with formula y = TV + Radio + Newspaper\nimport statsmodels.formula.api as smf\n\nest = smf.ols(formula=\"Sales ~ TV + Radio + Newspaper\", data=data).fit()\nest.summary()","2f984f5d":"# for p-values < 0.05\nest.pvalues[est.pvalues<=0.05]","8b0cb51f":"The important thing here is that we can see if the indepedent variables are statistically significative to predict sales. If we take into account only coefficients with probability of being zero less than 5%, only TV and radio have a significant effect.","a80f1171":"From these linear values, only TV and Radio are statistically significant","4d10b63e":"## 3.2 Uni-variate multiple linear regression\n\nThe simple linear regression is useful, but we want to analyze the effect of all the indepenent variables together (i.e. TV, radio and newspapers) on sales. Now we will fit the folowing expression:\n\n$$y= b + w_1x_1 + w_2x_2 + w_3x_3$$\n\nwhere $w_0$, $w_1$ and $w_2$  are the coefficients for TV, Radio and Newspaper investments respectively.","56f7e286":"# 1. Loading the advertising dataset\n\nThe dataset contains 200 observations. It contains investments in TV, radio and newspapers (in dollars) and the resulting sales. The idea is to find a function that predict the sales as a function of the TV, radio and newspaper investments.","936424d5":"# 2. Simple linear regression \n\nWe will start wit a fit to the simple equation of the form:\n\n$$f(x;b,w) = b + wx$$\n\nwhere $x$ is the (e.g.,TV investment), $w$ the linear coefficient for that investment and the $b$ the bias term (or intercept). \n","4e2bdbd0":"## 3 Uni-variate simple Linear regression with statmodels\n\nStatsmodels allow us to evaluate the statistical significance of the parameters used in the linear regression.","dbad6ac3":"\n# 1. Introduction and notation\n\nWe have a linear function $f(x;b,w)$ as the relation between an independent variable (i.e. a feature $x$) and the parameters (e.g. $b$ and $w$). In our example example, we may have a linear relation between our sales ($y$) and the number of ads we have in TV ($x$). \n\n$$ y = b + wx$$\n\n\nThe linear fit is calculated with the Ordinary Least Squares (OLS) regression method. The OLS minimizes the the difference between  observed ($y$) and predicted values ($\\hat{y}$). To keep these differences positive, they are raised to the square. For $m$-observations we would have the following minization function:\n\n$${\\mathrm{argmin}}\\sum \\limits_{i=1}^{m}(\\hat{y_i}-y_i)^2$$\n\n\nTo obtain $\\hat{y}$ we need a linear function where the $m$ observations are based on $x_n$-independent variables:\n\n$$y = b + w_0 + w_1x_1 + ...+w_n x_n $$\n\n\nWe can also think of the OLS regression as the fitting of the independent variables with the coefficients in a n-dimensional hyperplane.\n\n\n"}}