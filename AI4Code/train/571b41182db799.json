{"cell_type":{"53cf4559":"code","85603b81":"code","9ca15cc4":"code","f10213f2":"code","0f434f5a":"code","31d89196":"code","70d83280":"code","bbb49f3a":"code","0058e8de":"code","94cec96c":"code","88dd441d":"code","d34338be":"code","d9d066f7":"code","283af21f":"code","6e070255":"code","4a80cf3c":"code","cef18430":"code","a9973253":"code","a4904b2d":"code","036a1614":"code","16e79e17":"code","c0d12994":"code","ef36c718":"code","d10cd28b":"code","4f417f26":"code","d422bd4d":"code","f1317d84":"code","036262c9":"code","ae9db867":"code","feffb630":"code","9e46b43f":"code","f895fda3":"code","b1008b30":"code","31d70c5d":"code","6404ac6a":"code","6582cce6":"code","3097a48f":"code","5f9e9645":"code","ecbea272":"markdown","a52256a8":"markdown","3d290638":"markdown","88798d7f":"markdown"},"source":{"53cf4559":"#importing libararies\nimport pandas as pd \nimport numpy as np \nimport matplotlib.pyplot as plt\nimport seaborn as sb\n%matplotlib inline\nimport warnings\nwarnings.simplefilter(action='ignore', category=Warning)","85603b81":"df = pd.read_csv('..\/input\/heart-attack-analysis-prediction-dataset\/heart.csv')\ndf.head()","9ca15cc4":"#investigate a dataset\ndf.info()","f10213f2":"#investigate a dataset\ndf.describe()","0f434f5a":"#investigate a dataset\n\ndf.shape","31d89196":"sb.countplot(df['output'])\nplt.title('count of output')\nplt.title('count of heart attacks');","70d83280":"plt.figure(figsize=(20, 10))\nsb.countplot(df['age'])\nplt.title('Age count',fontsize=20)\nplt.xlabel('Age',fontsize=20)\nplt.ylabel('count',fontsize=20)\nplt.xticks(fontsize=20)\nplt.yticks(fontsize=20);","bbb49f3a":"plt.figure(figsize=(20, 10))\nmatrix=np.triu(df.corr())\nsb.heatmap(df.corr(),annot=True,mask=matrix,cmap='rocket')\nplt.title('effects map');","0058e8de":"sb.countplot(df['sex'])\nplt.title('sex count')\nplt.show()\nprint('0 = Females  1 = Male');","94cec96c":"sb.countplot(df['cp'])\nplt.title('count of chest`s pain');","88dd441d":"sb.countplot(df['fbs']);","d34338be":"sb.countplot(df['restecg']);","d9d066f7":"sb.countplot(df['exng']);","283af21f":"sb.countplot(df['slp']);","6e070255":"sb.countplot(df['caa']);","4a80cf3c":"sb.countplot(df['thall']);","cef18430":"sb.catplot(data=df,x='output',y='age',kind='box')\nsb.catplot(data=df,x='output',y='trtbps',kind='box')\nsb.catplot(data=df,x='output',y='chol',kind='box')\nsb.catplot(data=df,x='output',y='thalachh',kind='box')\nsb.catplot(data=df,x='output',y='oldpeak',kind='box');","a9973253":"chest_pain=df['cp'].value_counts().reset_index()\nsb.barplot(data=chest_pain,x='index',y='cp')\nplt.title('Chest pain Counts');","a4904b2d":"sb.displot(df['trtbps'])\nplt.xticks(np.arange(100,210,20));","036a1614":"sb.displot(df['chol'])\nplt.xticks(np.arange(50,600,50));","16e79e17":"sb.displot(df['thalachh'])\nplt.xticks(np.arange(80,220,20));","c0d12994":"sb.histplot(data=df,x='age',hue='output')","ef36c718":"feataure_df=np.asanyarray(df[['age','sex','cp','trtbps','chol','fbs','restecg','thalachh','thalachh','exng','oldpeak','slp','caa','thall']])\ny_data=np.asanyarray(df[['output']])","d10cd28b":"#prepare our data for classification \nfrom sklearn.preprocessing import StandardScaler\nx=StandardScaler().fit(feataure_df).transform(feataure_df)","4f417f26":"#split the data\nfrom sklearn.model_selection import train_test_split\nx_train,x_test,y_train,y_test=train_test_split(x,y_data,test_size=.2,random_state=4)","d422bd4d":"#classification list to add our classifier in it\nclassifiers=[]\n#first classification model is Logistic Regression \nfrom sklearn.linear_model import LogisticRegression\nClassifier_1=LogisticRegression(C=.01, solver='liblinear')\nClassifier_1.fit(x_train,y_train)\nclassifiers.append(Classifier_1)","f1317d84":"#Try the classifier Outputs\nresult_1=Classifier_1.predict(x_test)\nprob_result=Classifier_1.predict_proba(x_test)","036262c9":"#calculate the accuracy of the classifier\n\nfrom sklearn.metrics import classification_report, accuracy_score\nprint(classification_report(y_test,result_1))","ae9db867":"#second classification model is KNN\n#try many K to find the best K\n\nfrom sklearn.neighbors import KNeighborsClassifier\nKNN_list=[]\nfor K in range(1,11):\n    KNN=KNeighborsClassifier(n_neighbors=K).fit(x_train,y_train)\n    KNN_list.append(KNN)\nY_list=[]\nfor KNN_1 in KNN_list:\n    y_hat=KNN_1.predict(x_test)\n    Y_list.append(y_hat)\nfrom sklearn import metrics\nList_1=[]\nfor KNN_2 in KNN_list:\n    Metric1=metrics.accuracy_score(y_test, KNN_2.predict(x_test))\n    List_1.append(Metric1)","feffb630":"#plot the result to determine the best K\nfor a,b in enumerate(List_1):\n    plt.scatter(x=a+1,y=b,color='r')\nplt.xticks(np.arange(1,11));","9e46b43f":"#the best K is 9\nClassifier_2=KNN_list[8]\nresult_2=Classifier_2.predict(x_test)\nprint(classification_report(y_test,result_2))\nclassifiers.append(Classifier_2)","f895fda3":"#third classifier is SVC\nfrom sklearn import svm\nClassifier_3=svm.SVC()\nClassifier_3.fit(x_train,y_train)\nclassifiers.append(Classifier_3)","b1008b30":"#testing the model\nresult_3=Classifier_3.predict(x_test)","31d70c5d":"#evaluate the model\nprint(classification_report(y_test,result_3))","6404ac6a":"#forth Classifier is  Decision Tree\nfrom sklearn.tree import DecisionTreeClassifier\nClassifier_4=DecisionTreeClassifier()\nClassifier_4.fit(x_train,y_train)\nclassifiers.append(Classifier_4)","6582cce6":"#testing the model the model\nresult_4=Classifier_4.predict(x_test)\nprint(classification_report(y_test,result_4))","3097a48f":"#evaluate the model\n\nx=accuracy_score(y_test,Classifier_4.predict(x_test))\nx","5f9e9645":"#ploting the classifer results to determine the best classifier \nclassifiers_result={}\nfor i,classifier in enumerate(classifiers):\n    classifiers_result['classifier '+str(i+1)]=accuracy_score(y_test,classifier.predict(x_test))\nprint(classifiers_result)\nplt.bar(range(len(classifiers_result)), list(classifiers_result.values()), align='center')\nplt.xticks(range(len(classifiers_result)), list(classifiers_result.keys()));","ecbea272":"This Dataset it is about Heart attack\nit consists from differnt types of feature like (age,sex,chest pain(cp),blood presure (trtbps), Fasting blood sugar(fbs),restecg,thalachh(maximum heart rate),oldpeak,slp,caa,thall)\nand the output that he have a heart attack or not ","a52256a8":"##### classifier 1 is Logistic Regression \n##### classifier 2 is KNN\n##### classifier 3 is SVC\n##### classifier 4 is Decision Tree\n","3d290638":"####  best classifier s Logistic classifier","88798d7f":"### exploratory analysis"}}