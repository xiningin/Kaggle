{"cell_type":{"84cfd867":"code","7ec18f03":"code","732a191d":"code","08767f2e":"code","5f7e6767":"code","5a330f7b":"code","ae71fae3":"code","ad197776":"code","9f8e57f8":"code","63164577":"code","d1ee3300":"code","e19a87b5":"code","d321e670":"code","0164bdd2":"code","05da3f89":"code","2181db3b":"code","5512134c":"code","d9fa6902":"code","8a118036":"code","87956c2f":"code","74380a0b":"code","cde25058":"code","16e30591":"code","0122b8b9":"code","5ad3c578":"code","356eca43":"code","fde077ad":"markdown","89a581ed":"markdown","6ab6ab13":"markdown","8135a916":"markdown","8abe1d4a":"markdown"},"source":{"84cfd867":"# Importing Libraries\n\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport seaborn as sns","7ec18f03":"# reading data set (Salary_Data.csv) using pandas\n\ndf = pd.read_csv('..\/input\/random-salary-data-of-employes-age-wise\/Salary_Data.csv')","732a191d":"## Now some Eploratory Data Analysis EDA\n\n# Checking first five rows  \n\ndf.head()","08767f2e":"# Data set information\n\ndf.info()","5f7e6767":"# Data Set statistical information\n\ndf.describe()","5a330f7b":"# isnull() check if there is any null (missing) value\n\ndf.isnull()","ae71fae3":"# summing up all null value if there is any\n\ndf.isnull().sum()","ad197776":"# Visualize data with matplotlib\n\ndf.plot('YearsExperience' , 'Salary' , kind = 'scatter')\nplt.show()","9f8e57f8":"# Now Splitting Data --- Train and Test Data\n\nX = df['YearsExperience']\ny = df['Salary']\n\n","63164577":"# importing sklearn and using train_test_split to split data\n\nfrom sklearn.model_selection import train_test_split\n \n\nX_train , X_test , y_train , y_test = train_test_split(X,y, test_size=0.2 , random_state=100)\n\n# test_size=0.2 means we select 20% for test data\n# remaining 80% for train data\n\n","d1ee3300":"# Now check the dimension of train and test data and modify with correct dimension\n\nprint(X_train.shape)\nprint(X_test.shape)\nprint(y_train.shape)\nprint(y_test.shape)","e19a87b5":"print(X_train.ndim)\nprint(X_test.ndim)\nprint(y_train.ndim)\nprint(y_test.ndim)","d321e670":"# We have to convert our data into 2D otherwise Expected 2D array error occurs\n\nX_train = X_train.values.reshape(-1 , 1)\n\n","0164bdd2":"X_test = X_test.values.reshape(-1 ,1)","05da3f89":"y_train = y_train.values.reshape(-1 , 1)\n","2181db3b":"y_test = y_test.values.reshape(-1 , 1)","5512134c":"# Verify if all train and test shapes become 2D\n\nprint(X_train.shape)\nprint(X_test.shape)\nprint(y_train.shape)\nprint(y_test.shape)","d9fa6902":"# Importing Linear Regression \n\nfrom sklearn.linear_model import LinearRegression\nlr = LinearRegression()","8a118036":"# Training model by introducing training data in lr.fit\n\nlr.fit(X_train , y_train)  \n","87956c2f":"# Now Prediction\n\nylr_pred = lr.predict(X_test)\nylr_pred","74380a0b":"# Importing regression matrices for mean_absoulute_error and r2_score\n\nfrom sklearn.metrics import mean_absolute_error as mae , r2_score\n\nlr_mae = mae(y_test , ylr_pred)\nlr_mae","cde25058":"# Check thr r2 score for accuracy of model\n\nlr_r2 = r2_score(y_test , ylr_pred)\n\nprint(lr_r2)  \n\nprint(round(lr_r2*100 , 2) , '%')","16e30591":"# ploting Actual vs Predicted values\n\nplt.scatter(x=X_test , y=y_test , color='b' )\nplt.scatter(x=X_test , y=ylr_pred , color='r' )\n\nplt.show()","0122b8b9":"plt.scatter(x=X_train , y=y_train , color='r')\nplt.plot(X_train,lr.predict(X_train))\nplt.xlabel('Experience')\nplt.ylabel('Salary')\nplt.show()\n","5ad3c578":"# Now to predict Salary at any given Experience\n\nprint(lr.predict([[12]]))   \nprint(lr.predict([[15]]))\nprint(lr.predict([[20]]))\nprint(lr.predict([[25]]))\n\n# Double bracket make Experience value in 2D array\n# other wise Expected 2D error will occur","356eca43":"# Intercept and coefficient\n\nprint('Intercept of the model \u03b20:' , lr.intercept_)\nprint('Coefficient of the line \u03b21' , lr.coef_)","fde077ad":"# Final equation becomes\n\n##         Salary = 26819 + 9361*Experience\n         \n##          y = 26819 + 9361x","89a581ed":"# Salary Data Prediction-Linear Regression:\n    \nLinear Regression is a machine learning algorithm based on supervised \nlearning. It performs a regression task. Regression models a target \nprediction value based on independent variables. \nIt is mostly used for finding out the relationship between \nvariables and forecasting\n\nA simple linear regression equation will be as:\n                        y=\u03b20+\u03b21x\n \n\nWhen there are more explanatory variables, the equation is bit complex:\n                yi=\u03b20+\u03b21xi1+...+\u03b2nxin+\u03f5\n \n            Where,  \u03b20=Intercept   \u03b2i=Slope   \u03f5=Error term","6ab6ab13":"# Introducing Models\n\n\n# 1.  Linear Regression","8135a916":"# Plotting the Best-fit Line\n\nFormula for the Linear Regression in this case: \n\n           Salary = \u03b20 + \u03b21*(Experience)\n\nwhere,           \n\u03b20 = intercept => Salary when experience is 0\n\n\u03b21 = slope => increase in Salary with unit increase in Experience","8abe1d4a":"## Intercept and coefficient of line   \n## Salary = \u03b20 + \u03b21*(Experience)"}}