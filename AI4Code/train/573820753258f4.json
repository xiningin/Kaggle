{"cell_type":{"6cfa8d0e":"code","481a55f1":"code","d76fd2eb":"code","7e1780e3":"code","a8151f62":"code","73e39cfe":"code","c0024967":"code","16daa81a":"code","0e52cfde":"code","0b45d60e":"code","b6a66a8c":"code","dde00e1d":"code","83348b8f":"code","cf32151b":"code","9a537bbb":"code","88d3c0d6":"code","b4e02499":"code","2ab9bc25":"code","45e82216":"code","ed26e886":"code","74e20c96":"code","e5bfd6ed":"code","c4811198":"code","010f5935":"code","63d7fea4":"code","ddcc9bca":"code","5bb634a8":"code","b33405ec":"code","89bf636a":"code","9555d2a7":"code","d6bf2e37":"code","638cd3e7":"code","68ce9156":"code","3538c8d1":"code","99b7d228":"code","a109a8cb":"code","4342d273":"code","54bfc31f":"code","79780dbf":"code","51699496":"code","f8b1b4ae":"code","a96500b6":"code","c564427d":"code","4841a136":"code","69dc4e1d":"code","21cfa852":"code","316579b0":"code","c3ef78e3":"code","ecdc5763":"code","c254b172":"code","c43f8b44":"code","6c7c3842":"code","3ea963ff":"code","01306b73":"code","10828394":"code","937ec0d2":"markdown","71eda35b":"markdown","ceb76049":"markdown"},"source":{"6cfa8d0e":"# loading necessary packages\nimport numpy as np\nimport pandas as pd \nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\nsns.set()\nfrom sklearn.preprocessing import MinMaxScaler\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.svm import SVR\nfrom sklearn.linear_model import LinearRegression\nfrom xgboost import XGBClassifier, plot_importance\nfrom sklearn.model_selection import train_test_split, cross_val_score, KFold\nfrom sklearn.metrics import (explained_variance_score, median_absolute_error, mean_absolute_error, mean_squared_error)","481a55f1":"train = pd.read_csv(\"..\/input\/sales_train.csv\")\nitems = pd.read_csv(\"..\/input\/items.csv\")\nitem_categories = pd.read_csv(\"..\/input\/item_categories.csv\")\ntest = pd.read_csv(\"..\/input\/test.csv\")\nsub_sample = pd.read_csv(\"..\/input\/sample_submission.csv\")\nshops = pd.read_csv(\"..\/input\/shops.csv\")","d76fd2eb":"train.shape, test.shape","7e1780e3":"train.head()","a8151f62":"train.describe()","73e39cfe":"train.info()","c0024967":"train.head()","16daa81a":"train[\"date\"] = pd.to_datetime(train[\"date\"], format='%d.%m.%Y')","0e52cfde":"train[\"date\"].head()","0b45d60e":"train[\"month\"] = train[\"date\"].dt.month","b6a66a8c":"train[\"month\"].head()","dde00e1d":"train[\"year\"] = train[\"date\"].dt.year","83348b8f":"train[\"year\"].head()","cf32151b":"train = train.drop([\"date\",\"item_price\"], axis=1)","9a537bbb":"train.head()","88d3c0d6":"[count for count in train.columns if count not in [\"item_cnt_day\"]]","b4e02499":"train[\"date_block_num\"].unique()","2ab9bc25":"train.groupby(\"date_block_num\", as_index=False)[\"item_cnt_day\"].sum()","45e82216":"train = train.groupby([count for count in train.columns if count not in ['item_cnt_day']], as_index=False)[['item_cnt_day']].sum()","ed26e886":"train = train.rename(columns={'item_cnt_day':'item_cnt_month'})","74e20c96":"train[['shop_id','item_id','item_cnt_month']].groupby(['shop_id','item_id'], as_index=False)[['item_cnt_month']].mean().head()","e5bfd6ed":"shop_item_monthly_mean = train[['shop_id','item_id','item_cnt_month']].groupby(['shop_id','item_id'], as_index=False)[['item_cnt_month']].mean()","c4811198":"shop_item_monthly_mean.head()","010f5935":"shop_item_monthly_mean = shop_item_monthly_mean.rename(columns={'item_cnt_month':'item_cnt_month_mean'})","63d7fea4":"train.head()","ddcc9bca":"train = pd.merge(train, shop_item_monthly_mean, how='left', on=['shop_id','item_id'])","5bb634a8":"train.head()","b33405ec":"# Last Month (Oct 2015)\nshop_item_prev_month = train[train['date_block_num']==33][['shop_id','item_id','item_cnt_month']]\nshop_item_prev_month.head()","89bf636a":"shop_item_prev_month = shop_item_prev_month.rename(columns={'item_cnt_month':'item_cnt_prev_month'})","9555d2a7":"shop_item_prev_month.head()","d6bf2e37":"train = pd.merge(train, shop_item_prev_month, how='left', on=['shop_id','item_id']).fillna(0.)","638cd3e7":"train.head()","68ce9156":"train = pd.merge(train, items, how='left', on='item_id')","3538c8d1":"train = pd.merge(train, item_categories, how='left', on='item_category_id')","99b7d228":"train.head()","a109a8cb":"train = pd.merge(train, shops, how='left', on='shop_id')","4342d273":"test[\"month\"] = 11\ntest[\"year\"] = 2015\ntest[\"date_block_num\"] = 34","54bfc31f":"test.head()","79780dbf":"test = pd.merge(test, shop_item_monthly_mean, how='left', on=['shop_id','item_id']).fillna(0.)\ntest.head()","51699496":"test = pd.merge(test, shop_item_prev_month, how='left', on=['shop_id','item_id']).fillna(0.)","f8b1b4ae":"test = pd.merge(test, items, how='left', on='item_id')\ntest = pd.merge(test, item_categories, how='left', on='item_category_id')","a96500b6":"test.head()","c564427d":"test = pd.merge(test, shops, how='left', on='shop_id')\ntest['item_cnt_month'] = 0","4841a136":"plt.subplots(figsize=(8, 6))\nsns.heatmap(train.corr())","69dc4e1d":"selected_feature = [\"item_category_id\", \"item_cnt_month\", \"item_cnt_month_mean\",\n                    \"item_cnt_prev_month\", \"item_id\", \"month\",\"shop_id\" , \"year\"]\ntrain = train[selected_feature]\nselected_feature.insert(0, \"ID\")\ntest = test[selected_feature]","21cfa852":"plt.subplots(figsize=(10,6))\ntrain.boxplot()\nplt.xticks(rotation=90)","316579b0":"plt.subplots(figsize=(10,6))\ntest.boxplot()\nplt.xticks(rotation=90)","c3ef78e3":"train.groupby(\"item_cnt_month\").count()","ecdc5763":"selected_feature.remove(\"item_cnt_month\")\nselected_feature.remove(\"ID\")","c254b172":"scale = MinMaxScaler()\nscaled_data = scale.fit_transform(train[selected_feature])\nscaled_train = pd.DataFrame(data = scaled_data, columns = selected_feature)","c43f8b44":"scaled_train[\"item_cnt_month\"] = train[\"item_cnt_month\"]","6c7c3842":"scaled_train.head()","3ea963ff":"scaled_data = scale.fit_transform(test[selected_feature])\nscaled_test = pd.DataFrame(data = scaled_data, columns = selected_feature)\nscaled_test[\"item_cnt_month\"] = test[\"item_cnt_month\"]","01306b73":"scaled_train.head()","10828394":"scaled_test.head()","937ec0d2":"## Detecting Outliers","71eda35b":"## Visualize Correlation","ceb76049":"## Feature Scaling"}}