{"cell_type":{"b9c028e9":"code","e1f236b0":"code","6a10f58a":"code","c4449346":"code","6cd51756":"code","f885314e":"markdown","9efd3eb0":"markdown","d325f243":"markdown","582f7809":"markdown"},"source":{"b9c028e9":"! ls -l \/kaggle\/input\/plant-pathology-fgvc78-640px","e1f236b0":"%matplotlib inline\n\nimport os\nimport json\nimport pandas as pd\nfrom pprint import pprint\n\nbase_path = '\/kaggle\/input\/plant-pathology-fgvc78-640px'\npath_csv = os.path.join(base_path, 'train.csv')\ntrain_data = pd.read_csv(path_csv)\nprint(train_data.head())","6a10f58a":"import numpy as np\n\ntrain_data['nb_classes'] = [len(lbs.split(\" \")) for lbs in train_data['labels']]\nlb_hist = dict(zip(range(10), np.bincount(train_data['nb_classes'])))\npprint(lb_hist)","c4449346":"import itertools\nimport seaborn as sns\n\nlabels_all = list(itertools.chain(*[lbs.split(\" \") for lbs in train_data['labels']]))\n\nax = sns.countplot(y=sorted(labels_all), orient='v')\nax.grid()","6cd51756":"import matplotlib.pyplot as plt\n\ntrain_data['labels_sorted'] = [\" \".join(sorted(lbs.split(\" \"))) for lbs in train_data['labels']]\n\nnb_samples = 6\nn, m = len(np.unique(train_data['labels_sorted'])), nb_samples,\nfig, axarr = plt.subplots(nrows=n, ncols=m, figsize=(m * 2, n * 2))\nfor ilb, (lb, df_) in enumerate(train_data.groupby('labels_sorted')):\n    img_names = list(df_['image'])\n    for i in range(m):\n        img_name = img_names[i]\n        img = plt.imread(os.path.join(base_path, f\"train_images\/{img_name}\"))\n        axarr[ilb, i].imshow(img)\n        if i == 1:\n            axarr[ilb, i].set_title(f\"{lb} #{len(df_)}\")\n        axarr[ilb, i].set_xticks([])\n        axarr[ilb, i].set_yticks([])\nplt.axis('off')","f885314e":"# Data exploration","9efd3eb0":"And add visualisation over each case, so five a few examples per labe combination...","d325f243":"We can see that each image can have multiple labels so lets check what is the mos common label count...\n\n*The target classes, a space delimited list of all diseases found in the image. Unhealthy leaves with too many diseases to classify visually will have the complex class, and may also have a subset of the diseases identified.*","582f7809":"Browse the label distribution, enrolling all labels in the dataset, so in case an image has two labels both are used in this stat..."}}