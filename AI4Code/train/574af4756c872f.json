{"cell_type":{"ab8a1b51":"code","69d85096":"code","82d8429a":"code","f7e36645":"code","95010425":"code","32c8af7f":"code","5624d2ad":"code","56318abb":"code","00eb4066":"code","5479659a":"code","786e4eca":"code","593b5c01":"code","4cfc3a2b":"code","2f888df3":"code","0467041d":"code","0d6943f6":"code","b12dbf8f":"code","90d2884a":"code","6a122146":"code","57322d60":"code","137a2bad":"code","b504799a":"code","cc99c48c":"code","654dcaa3":"code","3d9e38e0":"code","66a22f55":"code","c0254a64":"code","f73f106a":"code","984bf22a":"code","e665e793":"code","59cd03c9":"code","b6dd586a":"code","09899d8e":"code","0a73b1ed":"code","89f2b4e6":"code","dcdcdf21":"code","9036dc55":"code","7bd44c6a":"code","2b281bb5":"code","043ef3cc":"code","3345a1e1":"code","3a773df0":"code","640819b6":"code","57f4203b":"code","0785c822":"markdown","0010191d":"markdown","9e20192b":"markdown","b7771217":"markdown","8b4f1c98":"markdown","4990051e":"markdown","e937ef08":"markdown","47b903b8":"markdown","2570fd8f":"markdown","00b300de":"markdown","1abec5b9":"markdown","0cc563b0":"markdown","2ec29bc4":"markdown","35fc57bf":"markdown","f65d7b19":"markdown","01736392":"markdown","a10528ed":"markdown","f6cc3148":"markdown","0332eab3":"markdown","34b8235e":"markdown","e1218e82":"markdown","0eb4ab93":"markdown","8729fdeb":"markdown","1650a854":"markdown","8d0e698f":"markdown","ab26f3fc":"markdown","c77c5d22":"markdown","beb72c38":"markdown","d3a5a690":"markdown","9169dbc5":"markdown","f0fd33fa":"markdown","f35d0e16":"markdown","239a1c56":"markdown","a770a18f":"markdown","bd438b94":"markdown"},"source":{"ab8a1b51":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport math","69d85096":"data= pd.read_csv('..\/input\/student-grade-prediction\/student-mat.csv')\ndata","82d8429a":"data['G_avg']= round((data['G1']+data['G2']+data['G3'])\/3, 2)\ndata.head()","f7e36645":"data.info()","95010425":"data.isnull().sum().sum()","32c8af7f":"data.describe()","5624d2ad":"plt.hist(data['G_avg'], bins=20, range=[0,20])\nplt.title('Distribution of grades average of students')\nplt.xlabel('Grades average')\nplt.ylabel('Count')\nplt.show()","56318abb":"ax= sns.boxplot(data['G_avg'])\nax.set_title('Boxplot of average grades of students')\nax.set_xlabel('Average Grades')\nplt.show()","00eb4066":"ax = sns.countplot('age',hue='sex', data=data)\nax.set_title('Students distribution according to age and sex')\nax.set_xlabel('Age')\nax.set_ylabel('Count')\nplt.show()","5479659a":"ax = sns.swarmplot(x='age', y='G_avg',hue='sex', data=data)\nax.set_title('Age and sex relation with average grades')\nax.set_xlabel('Age')\nax.set_ylabel('Average grades')\nplt.show()","786e4eca":"ax = sns.swarmplot(x='famsize', y='G_avg', data=data)\nax.set_title('Age and sex relation with average grades')\nax.set_xlabel('Age')\nax.set_ylabel('Average grades')\nplt.show()","593b5c01":"Pedu = data['Fedu'] + data['Medu'] \nax = sns.swarmplot(x=Pedu,y=data['G_avg'])\nax.set_title('Parents education effect to child grades')\nax.set_xlabel('Parents education')\nax.set_ylabel('Average Grades')\nplt.show()","4cfc3a2b":"ax = sns.boxplot(x=data['Fjob'],y=data['G_avg'])\nax.set_title('Father job effect to child grades')\nax.set_xlabel('Father job')\nax.set_ylabel('Average Grades')\nplt.show()","2f888df3":"ax = sns.boxplot(x=data['Mjob'],y=data['G_avg'])\nax.set_title('Mother job effect to child grades')\nax.set_xlabel('Mother job')\nax.set_ylabel('Average Grades')\nplt.show()","0467041d":"ax = sns.swarmplot(x=data['Pstatus'],y=data['G_avg'])\nax.set_title('Parents status effect on grades')\nax.set_xlabel('A= apart, T= living together')\nax.set_ylabel('Average Grades')\nplt.show()","0d6943f6":"ax = sns.swarmplot(x=data['famrel'], y=data['G_avg'])\nax.set_title('family relations effect to child grades')\nax.set_xlabel('Relationship with family scale')\nax.set_ylabel('Average Grades')\nplt.show()","b12dbf8f":"ax = sns.boxplot(x='traveltime', y='G_avg',hue='address', data=data)\nax.set_title('Address and travel time to school')\nax.set_xlabel('Travel time (1: <15min, 2: 15min-30min, 3: 30min-1h, 4: >1h)')\nax.set_ylabel('Average grades')\nplt.show()","90d2884a":"ax = sns.swarmplot(x=data['romantic'],y=data['G_avg'])\nax.set_title('Students having a romantic relationship')\nax.set_xlabel('Romantic')\nax.set_ylabel('Average Grades')\nplt.show()","6a122146":"b = sns.boxplot(x=data['freetime'], hue=data['activities'], y=data['G_avg'])\nb.set_title('Freetime and extra activities')\nb.set_xlabel('Freetime')\nb.set_ylabel('Average Grades')\nplt.show()","57322d60":"ax = sns.boxplot(x=data['goout'],y=data['G_avg'])\nax.set_title('Students going out')\nax.set_xlabel('Go out times per week')\nax.set_ylabel('Average Grades')\nplt.show()","137a2bad":"alc= data['Walc'] + data['Dalc'] \nax = sns.swarmplot(x=alc,y=data['G_avg'])\nax.set_title('Alcohol consumption')\nax.set_xlabel('Alcohol')\nax.set_ylabel('Average Grades')\nplt.show()","b504799a":"ax= sns.violinplot(x=data['studytime'],y=data['G_avg'])\nax.set_title('Study time in relation with gradess')\nax.set_xlabel('Study time')\nax.set_ylabel('Average Grades')\nplt.show()","cc99c48c":"ax = sns.violinplot(x=data['failures'],y=data['G_avg'])\nax.set_title('Past subjects failures')\nax.set_xlabel('Failures')\nax.set_ylabel('Average Grades')\nplt.show()","654dcaa3":"ax= sns.swarmplot(x=data['absences'],y=data['G_avg'])\nax.set_title('Absence effect on results')\nax.set_xlabel('Number of absence')\nax.set_ylabel('Average Grades')\nplt.show()","3d9e38e0":"ax= sns.swarmplot(x=data['schoolsup'],y=data['G_avg'])\nax.set_title('School support and grades')\nax.set_xlabel('School support')\nax.set_ylabel('Average Grades')\nplt.show()","66a22f55":"ax= sns.swarmplot(x=data['paid'],y=data['G_avg'])\nax.set_title('Extra paid courses effect to grades')\nax.set_xlabel('paid course')\nax.set_ylabel('Average Grades')\nplt.show()","c0254a64":"ax= sns.swarmplot(x=data['internet'],y=data['G_avg'])\nax.set_title('internet access')\nax.set_xlabel('internet')\nax.set_ylabel('Average Grades')\nplt.show()","f73f106a":"ax= sns.boxplot(x=data['higher'],y=data['G_avg'])\nax.set_title('Students who aim to go to university')\nax.set_xlabel('higher education')\nax.set_ylabel('Average Grades')\nplt.show()","984bf22a":"data['school']=data['school'].map({'GP':0, 'MS':1})\ndata['sex']=data['sex'].map({'M':0 ,'F':1})\ndata['address']=data['address'].map({'R':0 ,'U':1})\ndata['famsize']=data['famsize'].map({'LE3':0 ,'GT3':1})\ndata['Pstatus']=data['Pstatus'].map({'A':0 ,'T':1})\ndata['Mjob']=data['Mjob'].map({'at_home':0 ,'services':1, 'teacher':2, 'health':3, 'other':4})\ndata['Fjob']=data['Fjob'].map({'at_home':0 ,'services':1, 'teacher':2, 'health':3, 'other':4})\ndata['famsup']=data['famsup'].map({'no':0, 'yes':1})\ndata['reason']=data['reason'].map({'course':0 ,'home':1, 'reputation':2, 'other':3})\ndata['guardian']=data['guardian'].map({'mother':0 ,'father':1, 'other':2})\ndata['schoolsup']=data['schoolsup'].map({'no':0, 'yes':1})\ndata['paid']=data['paid'].map({'no':0, 'yes':1})\ndata['activities']=data['activities'].map({'no':0, 'yes':1})\ndata['nursery']=data['nursery'].map({'no':0, 'yes':1})\ndata['higher']=data['higher'].map({'no':0, 'yes':1})\ndata['internet']=data['internet'].map({'no':0, 'yes':1})\ndata['romantic']=data['romantic'].map({'no':0, 'yes':1})","e665e793":"corr = data.corr()\ncorr.style.background_gradient(cmap='coolwarm').set_precision(2)","59cd03c9":"data= data.drop(['G1','G2','G3'], axis=1)\ndata","b6dd586a":"import sklearn as sk\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn import metrics","09899d8e":"X = data[[\"failures\"]]\ny = data[\"G_avg\"]\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.20, random_state=30)\nmodel = LinearRegression()\nmodel.fit(X_train, y_train)\npredicted = model.predict(X_test)\nprint (\"MSE :\", metrics.mean_squared_error(y_test,predicted))\nprint(\"R squared :\", metrics.r2_score(y_test,predicted))","0a73b1ed":"plt.scatter(X, y)\nplt.title(\"Linear Regression\")\nplt.xlabel(\"Failures\")\nplt.ylabel(\"Grade average\")\nplt.plot(X, model.predict(X), color=\"r\")\nplt.show()","89f2b4e6":"from sklearn.preprocessing import PolynomialFeatures\nX = data[[\"failures\"]]\ny = data[\"G_avg\"]\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.20, random_state=30)\nlg = LinearRegression()\npoly = PolynomialFeatures()\nX_train_fit = poly.fit_transform(X_train)\nlg.fit(X_train_fit, y_train)\nX_test_fit = poly.fit_transform(X_test)\npredicted = lg.predict(X_test_fit)\nprint (\"MSE :\", metrics.mean_squared_error(y_test,predicted))\nprint(\"R squared :\", metrics.r2_score(y_test,predicted))","dcdcdf21":"X= data.drop([\"G_avg\"], axis=1)\ny= data[\"G_avg\"]\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.2, random_state=30)\nmodel = LinearRegression()\nmodel.fit(X_train, y_train)\npredicted = model.predict(X_test)\nprint (\"MSE :\", metrics.mean_squared_error(y_test, predicted))\nprint(\"R squared :\", metrics.r2_score(y_test, predicted))","9036dc55":"data['pass']= np.where(data['G_avg']<10, 0, 1)\ndata","7bd44c6a":"print(data['pass'].value_counts())","2b281bb5":"corr = data.corr()\ncorr.style.background_gradient(cmap='coolwarm').set_precision(2)","043ef3cc":"import sklearn as sk\nfrom sklearn.model_selection import train_test_split\nY = data[\"pass\"]\nX = data[[\"failures\",\"schoolsup\",\"Medu\",\"Fedu\",\"higher\",\"goout\",\"internet\"]]\nX_train, X_test, Y_train, Y_test= train_test_split(X, Y, test_size=0.2, random_state=20)","3345a1e1":"from sklearn.linear_model import LogisticRegression\nlogreg= LogisticRegression(solver=\"lbfgs\")\nlogreg.fit(X_train, Y_train)\nY_pred= logreg.predict(X_test)\nprint(\"Accuracy = {:.2f}\".format(logreg.score(X_test, Y_test)))","3a773df0":"Y_pred1= logreg.predict([[0,1,3,4,1,1,1],[3,0,2,3,1,5,1]])\nprint(Y_pred1)","640819b6":"confusion_matrix= pd.crosstab(Y_test, Y_pred, rownames=[\"Actual\"], colnames=[\"predict\"])\nprint(confusion_matrix)","57f4203b":"from sklearn.metrics import classification_report\nprint(classification_report(Y_test, Y_pred))","0785c822":"### Location","0010191d":"### Multilinear regression","9e20192b":"Students living more than 1 hour far from school score less than others.  \nAlso students living in urban side score more than those living in the rural side.","b7771217":"# Predict the Grades Average with Regression","8b4f1c98":"### Activities and friends","4990051e":"### Importing libraries","e937ef08":"The majority of students are aged between 15 and 18, equally divided between the two genders (the number of females is slightly higher).  \nMost importantly age and sex do not have a clear influence on the average grades.","47b903b8":"### Family","2570fd8f":"### Support","00b300de":"### Adding the new column Grades Average","1abec5b9":"Higher study time results in better grades.  \nStudents with past failures have lower grades.  \nAbsence is not affecting grades.","0cc563b0":"School support affect positevely the grades.  \nPaid courses and internet do not affect the grades.","2ec29bc4":"Accuracy(0.72): The model made 57 correct predictions out of 79 observations. Recall: Out of 48 students that passed, the model predicted 44 correctly. Precision: Out of 62 students that we predicted to pass, 44 actually passed.","35fc57bf":"Students having a romantic relationship have lower grades.  \nFreetime and extra activities do not affect grades.\nStudents that go out a lot score less.\nAlcohol consumption resulted in lower grades.","f65d7b19":"### Uploading dataset","01736392":"In our model we will visualize the relation between the average grade and all other features that we will divide in sections.  \nWe will predict the average grade using Regression.  \nThen we will add a new binary column (pass or not) depending on the average grade and perform Logistic regression.","a10528ed":"We will add a new column 'pass', it will take binary values. If the Grades average is equal or higher than 10, the student will pass, otherwise he\/she will not.","f6cc3148":"We chose our X to be number of failures since it has the highest correlation","0332eab3":"### We drop the grades G1, G2 and G3 because they will affect the prediction of the average. ","34b8235e":"# Prediction model with Classification","e1218e82":"### Discipline","0eb4ab93":"We will use only the highest correlated features in our prediction model.","8729fdeb":"The data used is from a Portuguese secondary school. The data includes academic and personal characteristics of the students as well as final grades.","1650a854":"## Convert categorical variables to numerical ones","8d0e698f":"### Linear regression ","ab26f3fc":"G1 - first period grade (numeric: from 0 to 20)  \nG2 - second period grade (numeric: from 0 to 20)  \nG3 - final grade (numeric: from 0 to 20, output target)  \nWe will add a fourth column 'G_avg' which is the average of G1, G2 and G3. 'G_avg' will be our target column.","c77c5d22":"# Data Visualization","beb72c38":"### Correlation map","d3a5a690":"### Polynomial regression","9169dbc5":"The majority of the students (75% of them) scored an average between 8 and 13.  \nThe most common average is 9.","f0fd33fa":"Students aiming to join universities later and have a higher education have better grades.","f35d0e16":"### Ambitions","239a1c56":"# Prediction of the average final grade","a770a18f":"### Personal Info","bd438b94":"Most families have more than 3 members but this doesn't affect the child's grades.  \nStudents with educated parents have slightly higher grades.  \nStudents with fathers working as teacher and mothers working in health score better than others.  \nMost students live with both their parents and have a good relationship with them but this doesn't affect the grades."}}