{"cell_type":{"67d04620":"code","a7782226":"code","ca7e5caf":"code","82ca1c1f":"code","53cce6f6":"code","59702b94":"code","14114e35":"code","c66d81c7":"code","f5cae4a5":"code","7981207a":"code","cf1df515":"code","d45e5268":"code","7098ebbe":"code","fd524f4c":"code","17d95db1":"code","18793115":"code","6a6f5c6f":"code","70dfbc58":"code","2ff86db7":"code","6fc2e262":"code","cc46eb00":"code","b361d488":"code","52d24c32":"code","1c7e78f3":"code","f4bf3e61":"code","75c35693":"code","eb745393":"code","f166c150":"code","ff088165":"code","9e860d04":"code","1e9254cc":"markdown","82c1a7f1":"markdown","37b48b89":"markdown","f535a91b":"markdown","224e52f4":"markdown","a075f41f":"markdown","83a8f456":"markdown","a62e780b":"markdown","b9f063f3":"markdown","125bef1e":"markdown","b86de817":"markdown","766de704":"markdown","10887146":"markdown","8ad48bc0":"markdown","a10b34f2":"markdown","b7a676f4":"markdown","d4cb1177":"markdown","91639292":"markdown","1cb72911":"markdown","aa68ff9a":"markdown","78d2e4e5":"markdown","58009700":"markdown","c2b4f08a":"markdown","85bc60f1":"markdown","c1da0441":"markdown","4d195c90":"markdown","d2d08ac0":"markdown","721a4ba0":"markdown","d82692b1":"markdown","fcd5c8b2":"markdown","20c3e9f2":"markdown","f547f134":"markdown","5496d169":"markdown","39e9ca67":"markdown","ef3d28f2":"markdown"},"source":{"67d04620":"import pandas as pd\nimport numpy as np\n\nimport plotly_express as px\nfrom plotly.subplots import make_subplots\nimport plotly.graph_objects as go\n\nimport matplotlib.pyplot as plt\nfrom wordcloud import WordCloud, STOPWORDS\n\nimport tensorflow as tf\nimport tensorflow_hub as hub\nfrom sklearn.decomposition import PCA\n\nfrom nltk.sentiment.vader import SentimentIntensityAnalyzer\n\nfrom plotly.offline import init_notebook_mode\ninit_notebook_mode()","a7782226":"data = pd.read_csv('..\/input\/avatar-the-last-air-bender\/avatar_data.csv')\nseries = pd.read_csv('..\/input\/avatar-the-last-air-bender\/series_names.csv')\navatar = pd.read_csv('..\/input\/avatar-the-last-air-bender\/avatar.csv', encoding = 'latin-1')","ca7e5caf":"avatar['imdb_rating'] = avatar['imdb_rating'].fillna(9.7)","82ca1c1f":"fig = px.bar(series, x = 'book', y = 'series_rating', template = 'simple_white', color_discrete_sequence=['#f18930'] * 3 ,\n             opacity = 0.6, text = 'series_rating', category_orders={'book':['Water','Earth','Fire']}, \n            title = 'IMDB Rating Across Seasons')\nfig.add_layout_image(\n        dict(\n            source=\"https:\/\/i.imgur.com\/QWoqOZd.jpg\",\n            xref=\"x\",\n            yref=\"y\",\n            x=-0.5,\n            y=10,\n            sizex=3,\n            sizey=10,\n            opacity = 0.7,\n            sizing=\"stretch\",\n            layer=\"below\")\n)\nfig.show()","53cce6f6":"fig = px.bar(data, x = 'Unnamed: 0', y = 'imdb_rating',color = 'book',hover_name='book_chapt',template = 'simple_white',\n             color_discrete_map={'Fire':'#cd0000', 'Water':'#3399ff', 'Earth':'#663307'},labels={'imdb_rating':'IMDB Ratig','Unnamed: 0':'Episode'})\nfig.show()","59702b94":"director_counts = pd.DataFrame(data['director'].value_counts()).reset_index()\ndirector_counts.columns = ['Director Name', 'Number of Episdoes']\n\nfig = make_subplots(rows=1, cols=2,specs=[[{'type':'bar'}, {'type':'pie'}]], horizontal_spacing=0.2)\n\ndirectorColors = ['#adbce6'] * 7\ndirectorColors[5] = ['#ba72d4']\ndirector_rating = pd.DataFrame(data.groupby('director')['imdb_rating'].mean()).reset_index().sort_values(by = 'imdb_rating')\ntrace0 = go.Bar(y = director_rating['director'], x = director_rating['imdb_rating'], orientation='h',\n                hovertext=director_rating['imdb_rating'],name = 'Director Average Ratings',\n               marker_color = directorColors )\nfig.add_trace(trace0, row = 1, col = 1)\n\ntrace1 = go.Pie(values= director_counts['Number of Episdoes'],labels = director_counts['Director Name'],name = 'Director Number of Episodes')\nfig.add_trace(trace1, row = 1, col = 2)\n\nfig.update_layout(showlegend = False, title = {'text':'Directors and Their Average Rating', 'x':0.5}, template = 'plotly_white')\nfig.show()","14114e35":"character_dialogues = pd.DataFrame({'Character':[], 'Number of Dialogues':[],'Book' : []})\nfor book in ['Water', 'Earth', 'Fire']:\n    temp = pd.DataFrame(avatar[avatar['book'] == book]['character'].value_counts()).reset_index()\n    temp.columns = ['Character', 'Number of Dialogues']\n    temp['Book'] = book\n    temp = temp.sort_values(by = 'Number of Dialogues', ascending = False)\n    character_dialogues = pd.concat([character_dialogues, temp])","c66d81c7":"important_characters = ['Aang', 'Katara', 'Zuko', 'Sokka','Toph','Iroh','Azula']","f5cae4a5":"bookColor = {\n    'Fire':'#cd0000', \n    'Water':'#3399ff', \n    'Earth':'#663307'\n}\nfig = make_subplots(rows = 1, cols = 3, subplot_titles=['Water','Earth','Fire'])\nfor i, book in enumerate(['Water','Earth', 'Fire']):\n    temp = character_dialogues[(character_dialogues['Character'] != 'Scene Description') & (character_dialogues['Book'] == book)]\n    trace = go.Bar(x = temp.iloc[:10][::-1]['Number of Dialogues'].values, y = temp.iloc[:10][::-1]['Character'].values,\n                   orientation = 'h', marker_color = bookColor[book], name = book,opacity=0.8)\n    fig.add_trace(trace, row = 1, col = i+1)\nfig.update_layout(showlegend = False, template = 'plotly_white', title = 'Characters with Most Dialogues in Each Book')\nfig.show()","7981207a":"fig = px.bar(character_dialogues[character_dialogues['Character'].isin(important_characters)],template = 'gridon',title = 'Important Characters Number of Dialogues each season',\n             x = 'Number of Dialogues', y = 'Character', orientation = 'h', color='Book',barmode = 'group',\n             color_discrete_map={'Fire':'#cd0000', 'Water':'#3399ff', 'Earth':'#663307'})\nfig.add_layout_image(\n    dict(\n        source=\"https:\/\/vignette.wikia.nocookie.net\/avatar\/images\/1\/12\/Azula.png\",\n        x=0.25,\n        y=0.9,\n    ))\nfig.add_layout_image(\n    dict(\n        source=\"https:\/\/vignette.wikia.nocookie.net\/avatar\/images\/4\/46\/Toph_Beifong.png\",\n        x=0.42,\n        y=0.77,\n    ))\nfig.add_layout_image(\n    dict(\n        source=\"https:\/\/vignette.wikia.nocookie.net\/avatar\/images\/c\/c1\/Iroh_smiling.png\",\n        x=0.35,\n        y=0.6,\n    ))\nfig.add_layout_image(\n    dict(\n        source=\"https:\/\/vignette.wikia.nocookie.net\/avatar\/images\/4\/4b\/Zuko.png\",\n        x=0.62,\n        y=0.47,\n    ))\n\nfig.add_layout_image(\n    dict(\n        source=\"https:\/\/vignette.wikia.nocookie.net\/avatar\/images\/c\/cc\/Sokka.png\",\n        x=0.85,\n        y=0.32,\n    ))\nfig.add_layout_image(\n    dict(\n        source=\"https:\/\/static.wikia.nocookie.net\/loveinterest\/images\/c\/cb\/Avatar_Last_Airbender_Book_1_Screenshot_0047.jpg\",\n        x=0.85,\n        y=0.18,\n    ))\nfig.add_layout_image(\n    dict(\n        source=\"https:\/\/comicvine1.cbsistatic.com\/uploads\/scale_small\/11138\/111385676\/7212562-5667359844-41703.jpg\",\n        x=1.05,\n        y=0.052,\n    ))\nfig.update_layout_images(dict(\n        xref=\"paper\",\n        yref=\"paper\",\n        sizex=0.09,\n        sizey=0.09,\n        xanchor=\"right\",\n        yanchor=\"bottom\"\n))\n\nfig.show()","cf1df515":"chapter_dialogues = pd.DataFrame({'Chapter':[], 'Number of Dialogues':[],'Book' : []})\ndialogue_df = avatar[avatar['character']!='Scene Description']\nfor book in ['Water', 'Earth', 'Fire']:\n    temp = pd.DataFrame(dialogue_df[(dialogue_df['book'] == book)]['chapter'].value_counts()).reset_index()\n    temp.columns = ['Chapter', 'Number of Dialogues']\n    temp['Book'] = book\n    chapter_dialogues = pd.concat([chapter_dialogues, temp])\nchapter_dialogues = chapter_dialogues.sort_values(by = 'Number of Dialogues')","d45e5268":"colors = []\nfor i in range(20):\n    if(chapter_dialogues.iloc[i]['Book'] == 'Fire'):\n        colors.append('#cd0000')\n    elif(chapter_dialogues.iloc[i]['Book'] == 'Water'):\n        colors.append('#3399ff')\n    else:\n        colors.append('#663307')\ntrace = go.Bar(x = chapter_dialogues.iloc[:20]['Number of Dialogues'], y = chapter_dialogues.iloc[:20]['Chapter'], \n               orientation = 'h', marker_color = colors)\nfig = go.Figure([trace])\nfig.update_layout(title = {'text':'Top 20 Episodes with the Most Number of Dialogues', 'x':0.5},\n                 xaxis_title=\"Number of Dialogues\",\n                 yaxis_title=\"Chapter Name\",\n                 template = 'plotly_white')\nfig.show()","7098ebbe":"ratings = []\nfor i in range(len(chapter_dialogues)):\n    chapter = chapter_dialogues.iloc[i]['Chapter']\n    imdb_rating = avatar[avatar['chapter'] == chapter]['imdb_rating'].mean()\n    ratings.append(imdb_rating)\nchapter_dialogues['IMDB Rating'] = ratings\nchapter_dialogues['IMDB Rating'].fillna(9.7, inplace = True)","fd524f4c":"chapter_dialogues['Dialogues Per Rating'] = chapter_dialogues['Number of Dialogues'] \/ chapter_dialogues['IMDB Rating']\nchapter_dialogues = chapter_dialogues.sort_values(by = 'Dialogues Per Rating')","17d95db1":"colors = []\nfor i in range(20):\n    if(chapter_dialogues.iloc[i]['Book'] == 'Fire'):\n        colors.append('#cd0000')\n    elif(chapter_dialogues.iloc[i]['Book'] == 'Water'):\n        colors.append('#3399ff')\n    else:\n        colors.append('#663307')\ntrace = go.Bar(x = chapter_dialogues.iloc[:20][::-1]['Dialogues Per Rating'], y = chapter_dialogues.iloc[:20][::-1]['Chapter'],\n              text = chapter_dialogues.iloc[:20][::-1]['IMDB Rating'], orientation = 'h', marker_color = colors, \n              textposition=\"outside\",texttemplate='%{text:.2s}',\n              textfont=dict(\n              family=\"sans serif\",\n              size=18,\n              color=\"Black\")\n)\nfig = go.Figure([trace])\nfig.update_layout(title = {'text':'Top 20 Episodes with the Least Dialogues Per Rating', 'x':0.5},\n                 xaxis_title=\"Num of Dialogues \/ IMDB Rating\",\n                 yaxis_title=\"Chapter Name\",\n                 template = 'plotly_white')\nfig.show()","18793115":"fig  = px.scatter(chapter_dialogues, x = 'Number of Dialogues', y = 'IMDB Rating', trendline = 'ols', color = 'Book',\n                 color_discrete_map={'Fire':'#cd0000', 'Water':'#3399ff', 'Earth':'#663307'},hover_name='Chapter' ,template = 'plotly_white',\n                 title = 'Relation Between Number of Dialogues and IMDB Rating')\nfig.show()","6a6f5c6f":"stopwords = set(STOPWORDS)\ndef createCorpus(character_name):\n    df = avatar[avatar['character'] == character_name]\n    corpus = \"\"\n    for des in df['character_words'].to_list():\n        corpus += des\n    return corpus\n\ndef generateWordCloud(character_name, background_color):\n    plt.subplots(figsize=(12,8))\n    corpus = createCorpus(character_name)\n    wordcloud = WordCloud(background_color=background_color,\n                          contour_color='black', contour_width=4, \n                          stopwords=stopwords,\n                          width=1500, margin=10,\n                          height=1080\n                         ).generate(corpus)\n    plt.imshow(wordcloud)\n    plt.axis('off')\n    plt.show()","70dfbc58":"generateWordCloud('Aang', 'White')","2ff86db7":"generateWordCloud('Katara', 'LightBlue')","6fc2e262":"generateWordCloud('Sokka','Blue')","cc46eb00":"generateWordCloud('Toph','Brown')","b361d488":"generateWordCloud('Zuko', 'Red')","52d24c32":"generateWordCloud('Iroh', 'Pink')","1c7e78f3":"generateWordCloud('Azula','Red')","f4bf3e61":"sentInt = SentimentIntensityAnalyzer()\ndef get_vader_score(character_name, key = 'pos'):\n    corpus = createCorpus(character_name)\n    sentimentScore = sentInt.polarity_scores(corpus)\n    return sentimentScore[key]\n\n\ncharacter_sent_dict = {}\nfor sentiment in ['pos', 'neg', 'neu']:\n    char_sents = []\n    for character in important_characters:\n        char_sents.append(get_vader_score(character, key = sentiment))\n    character_sent_dict[sentiment] = char_sents\ncharacter_sent_dict['Character Name'] = important_characters\ncharacter_sentiments = pd.DataFrame(character_sent_dict)","75c35693":"fig = px.bar(character_sentiments, x = ['pos', 'neg','neu'], y = 'Character Name',barmode='group',\n             labels = {'pos':'Positive', 'neg':'Negative','neu':'Neutral', 'value':'Sentiment Score'},\n             title = 'Sentiment Analysis of Characters',\n             template = 'presentation')\nfig.show()","eb745393":"chapterCorpus = pd.DataFrame({'Chapter Name' : [], 'Full Text': [], 'Book' : []})\nchapters = []\nchapterTexts = []\nbooks = []\nfor book in ['Water', 'Earth', 'Fire']:\n    subBook = avatar[(avatar['book'] == book) & (avatar['character']!='Scene Description')]\n    for chapter_name, df in subBook.groupby('chapter'):\n        full_text = df['character_words'].values\n        chapters.append(chapter_name)\n        chapterTexts.append(\" \".join(full_text).lower())\n        books.append(book)\nchapterCorpus['Chapter Name'] = chapters\nchapterCorpus['Full Text'] = chapterTexts\nchapterCorpus['Book'] = books","f166c150":"module_url = \"https:\/\/tfhub.dev\/google\/universal-sentence-encoder\/4\" \nmodel = hub.load(module_url)\n\nfeatures = model(chapterCorpus['Full Text'].values)\npca = PCA(n_components=2, random_state=42)\nreduced_features = pca.fit_transform(features)\n\nchapterCorpus['Dimension 1'] = reduced_features[:,0]\nchapterCorpus['Dimension 2'] = reduced_features[:,1]\nfig = px.scatter(chapterCorpus, x = 'Dimension 1', y = 'Dimension 2', color = 'Book', hover_name='Chapter Name',\n                color_discrete_map={'Fire':'#cd0000', 'Water':'#3399ff', 'Earth':'#663307'},\n                title = 'Finding Similar Episodes',\n                template = 'plotly_white')\nfig.update_traces(marker=dict(size=12))\nfig.show()","ff088165":"chapterwise_dialogues = pd.DataFrame({})\nfor character in important_characters:\n    character_df = avatar[avatar['character'] == character]\n    chapter_counts = character_df.groupby('chapter').size().reset_index()\n    chapter_counts.columns = ['chapter','Num of Dialogues']\n    imdb_ratings = character_df.groupby('chapter')['imdb_rating'].mean().reset_index()\n    dialogues_and_rating = pd.merge(chapter_counts, imdb_ratings)\n    dialogues_and_rating['Character'] = character\n    chapterwise_dialogues = pd.concat([chapterwise_dialogues, dialogues_and_rating])","9e860d04":"fig = px.scatter(chapterwise_dialogues, \n                 x = 'chapter',y='imdb_rating', size='Num of Dialogues',\n                 facet_col='Character',facet_col_wrap=2, \n                template = 'plotly_white')\nfig.update_xaxes(matches = None,visible = False)\nfig.show()","1e9254cc":"## Aang","82c1a7f1":"We have 5 Entries from the first Season into the Top 20 Episodes with most dialogues, while we have 8 from the Second and 7 from the Third Season. \n\nThe Drill is the episode with the most number of dialogues, here's an overview of the Episode taken from the [Avatar Wiki](https:\/\/avatar.fandom.com\/wiki\/The_Drill) in case you don't remember:\n\n> Having successfully navigated the Serpent's Pass, Aang is determined to journey to Ba Sing Se in the hopes of finding his lost bison, Appa. However, he discovers a Fire Nation drill heading straight for Ba Sing Se, intent on destroying the wall. Aang and the group succeed in demolishing the drill from the inside of the mechanism. Meanwhile, Jet wishes to recruit Zuko as a member of the Freedom Fighters, only to learn Zuko and Iroh are firebenders.","37b48b89":"As we can see, the average ImDB rating of each season has an upward trend. This is very rare to see and signifies that the viewers enjoyed the show more and more as they continued watching it. \n\nThe Final Season also has the highest ImDB rating and coupling it with the fact that the Finale has the highest ImDB rating for any episode of the show, signifies that **the show was able to create a very compelling storyline that evolved across the seasons and also has a great ending** (which is something not a lot of shows can boast about - here's looking at you GoT).","f535a91b":"## Zuko","224e52f4":"## Azula","a075f41f":"## Important Insights:\n\n- Sozin's Comet Part 4 is the Finale episode of the show. There was a lot of action in terms of fight scenes which explains why it is at the top as there wasn't many dialogues in those war scenes.","83a8f456":"> **The series consists of sixty-one episodes.Each season of the series is known as a \"book\", in which each episode is referred to as a \"chapter\". Each book takes its name from one of the elements Aang must master: Water, Earth, and Fire.** \n\n-- Source Wikipedia","a62e780b":"We see mentions of the Lotus Tile, Tea and the Tea shop in Iroh's wordcloud. \n\nHis main converstaions are with Zuko which is evident from the wordcloud with mentions of Zuko, Prince Zuko and Nepthew. ","b9f063f3":"# <center> IMDB Ratings <center>","125bef1e":"We do not see any such trends in the dataset. Thus, the number of times we hear a character does not affect the episode rating","b86de817":"# <center> Dialogues Analysis <center>","766de704":"# <center> Avatar <\/center>","10887146":"## Katara","8ad48bc0":"Azula like Zuko is also shown to mainly concern with the capture of Avatar and showing her skills to her Father. ","a10b34f2":"# <center>Directors<center>","b7a676f4":"* **Positive Sentiment** : Uncle Iroh has the highest Positive Sentiment Score and Sokka has the lowest Positive sentiment score.\n* **Negative Sentiment** : Azula has the highest Negative Sentiment Score and Aang has the lowest Negative Sentiment Score.\n* **Neutral Sentiment** : Sokka's statements are the most neutral in nature.","d4cb1177":"It is interesting to note that one of the most frequent words Toph uses is 'See', which is ironic since she is actually blind. ","91639292":"## Important Insights:\n\n### Possible spoilers ahead.\n\n- Aang had the most dialogues in the First Season. This was obvious as the show was mainly about him and thus, it makes sense to give him more dialogues. \n- Sokka obvious comes out as a jibber-jabber talker as we can see that he becomes the character with the most number of dialogues in subsequent seasons. However, we should not forget that Sokka has also developed as a character and morphed into a Leader and Strategist which could also explain why he needs to speak a lot of dialogues. \n- **Azula was introduced in the second season and seemed to look like a bigger threat for Aang, but was given lesser dialogues than Zuko, which again gives us a signal as to what role she was intented to play. She was to become the main Villain, while Zuko went on towards his path of self-realization and transformation into someone who is worthy of becoming a King.**\n- Toph is also introduced in the second season as the Earth Bending master for Aang. As she becomes part of the main gang, we can very easily see that she gets a lot of dialogues to speak. \n- **As Zuko becomes a true successor to the title of Fire King, we see he gets more dialogues. As a result he is on the 3rd spot in terms of number of dialogues in Season 3, ie. Fire Book .**\n- **Another important thing to note is that the number of dialogues has greatly reduced after Season 1. In season 1 Aang spoke as many as 818 dialogues. Sokka who has 614 dialogues in the first season, never spoke as much in other seasons even though he tops those charts.**","1cb72911":"Prince Zuko, has had the most conversations with his Uncle Iroh. \n\nAlso, he is shown to be primarily concerned with the capture of the Avatar which can be seen from the wordcloud.\n\nHis desire to prove to his ability to his father and to return home, by the prominent use of the word Father.","aa68ff9a":"While we cannot see distinct clusters forming, we can definitely see how some episodes are clustered together, while some episodes are far much different from the others. \n\nThe most important insight I can see is that the episode - **Tales of Ba Sing Se** is so different from the other episodes. I remember this episode to be much different from the other episodes in terms of the way the story was presented. ","78d2e4e5":"# <center>Characters Dialogues and IMDB Ratings<center>","58009700":"![](https:\/\/upload.wikimedia.org\/wikipedia\/commons\/thumb\/a\/a9\/Avatar_The_Last_Airbender_logo.svg\/1200px-Avatar_The_Last_Airbender_logo.svg.png)","c2b4f08a":"Does the number of Dialogues a character say have an impact on the Rating of the episode?","85bc60f1":"Aang talks to Katara (love-interest) and Sokka (love-interest's brother) a lot. \n\nHe also Mentions Appa more than Momo","c1da0441":"# <center> Finding Similar Episodes <center>","4d195c90":"Katata also talks a lot to Aang and Sokka.","d2d08ac0":"# <center> Analyzing what the Major Characters say <center>","721a4ba0":"Avatar: The Last Airbender is an animated TV Series that aired on Nickelodean for 3 seasons from February 2005 to July 2008. \n\nEnough of boring you with information copied from the Wikipedia\n\nBut, really matters is that **Avatar: The Last Airbender** is a very cool TV Series and has perhaps the highest IMDB ratings for an animated show. It also has a very huge fanbase. ","d82692b1":"## Toph","fcd5c8b2":"Writers spent a lot of time writing 'KNOW' ;)","20c3e9f2":"## Sokka","f547f134":"## Iroh","5496d169":"We see the Top 20 Episodes why require the least number of dialogues to gain one unit of ImDB rating. ","39e9ca67":"Although Michael Dante DiMartino has the highest average ImDB rating among the diretors, he has only directed 1 episode. On the other hand, Joaquim Dos Santos has directed 8 episodes with an Average ImDB rating of 9.075. ","ef3d28f2":"The above three wordclouds highlight the friendship between the 3 main characters of the show - Aang, Katara and Sokka. "}}