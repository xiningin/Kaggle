{"cell_type":{"513e097e":"code","a0eefc9d":"code","312bb21d":"code","f80f3e20":"code","30190912":"code","3a2d87c1":"code","33201b7e":"code","fcb95d46":"code","400b144c":"code","572b75ec":"code","01a845cb":"code","40f984b1":"code","36cd809f":"code","989de4d1":"code","7408fe95":"code","7c8900a0":"code","7db5ea8e":"code","059a3246":"code","cd42de0e":"code","54b807f4":"code","6a29fe3e":"code","8793f0a4":"code","5ffdd955":"code","9e3eb186":"code","d5404237":"code","2cc8c489":"markdown"},"source":{"513e097e":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns \nimport plotly as py\nimport plotly.graph_objs as go\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","a0eefc9d":"df=pd.read_csv(\"..\/input\/Mall_Customers.csv\")\ndf.head(50)","312bb21d":"#Checking the Null or missing values in data\ndf.isnull().sum()","f80f3e20":"df.duplicated().sum() # check for duplicate data","30190912":"#Lets analyse the data using scatter plot to see the data trend.\ndf.head()\n#lets see the annaul income and spending score\ndf.columns\nplt.scatter(df['Annual Income (k$)'],df['Spending Score (1-100)'])\n#plt.scatter(df[\"Age\"],df['Annual Income (k$)'])\nplt.legend()\nplt.xlabel(\"Income\")\nplt.ylabel(\"Spending score\")\n","3a2d87c1":"plt.figure(1 , figsize = (15 , 7))\nn = 0 \nfor x in ['Age' , 'Annual Income (k$)' , 'Spending Score (1-100)']:\n    for y in ['Age' , 'Annual Income (k$)' , 'Spending Score (1-100)']:\n        n += 1\n        plt.subplot(3 , 3 , n)\n        plt.subplots_adjust(hspace = 0.5 , wspace = 0.5)\n        sns.regplot(x = x , y = y , data = df)\n        plt.ylabel(y.split()[0]+' '+y.split()[1] if len(y.split()) > 1 else y )\nplt.show()","33201b7e":"#lets see the same for age and income\nplt.scatter(df[\"Age\"],df['Annual Income (k$)'])\nplt.legend()\nplt.ylabel(\"Income\")\nplt.xlabel(\"Age\")","fcb95d46":"#lets see spending of male and female customers\nplt.hist(df['Spending Score (1-100)'])\nplt.title(\"Spending scores of Customers\")\nplt.show()","400b144c":"df.head(10)","572b75ec":"#high spedning customers\ndf_spend=df.sort_values(by=\"Spending Score (1-100)\",ascending =False)\ndf_spend","01a845cb":"#Since Gender is a male\/female value so we have to encode it as 0,1\n#so we can use label encoder for using it in Machine Learning model.\nfrom sklearn.preprocessing import LabelEncoder\nle=LabelEncoder()\ndfe=df.copy()\ndfe.Gender=le.fit_transform(df.Gender) # the Gender is encoded as 0\/1 where 0 is female and 1 is male.\ndfe.head()","40f984b1":"dfe.drop(\"CustomerID\",inplace=True,axis=\"columns\")","36cd809f":"#Lets check for corrlation of data amongsteach other.# same as heat map\n#dfe.corr(method='pearson')","989de4d1":"dfe.corrwith(dfe[\"Annual Income (k$)\"],axis=0)","7408fe95":"dfe.columns","7c8900a0":"#Lets train the model using train test and split\nX=dfe[['Gender', 'Spending Score (1-100)']]\n#from sklearn.model_selection import train_test_split\n\n#X_train,X_test,Y_train,Y_test=train_test_split(X,Y,test_size =0.2) # 20 % is test data,80% will be training data","7db5ea8e":"#lets scale the data \nfrom sklearn.preprocessing import normalize\nX= normalize(X)","059a3246":"from sklearn.cluster import KMeans\n","cd42de0e":"#creating elbow plot to find the value of K for best results\nk_range= range(1,11)\nSSE =[]  # Sum of square errors\nfor k in k_range:\n    km=KMeans(n_clusters=k)\n    km.fit(X)\n    SSE.append(km.inertia_)","54b807f4":"SSE  # there are coordinates of sum square errors","6a29fe3e":"#plotting the elbow\nplt.xlabel(\"k values\")\nplt.ylabel(\"sum square errors\")\nplt.grid(True)\nplt.plot(k_range,SSE,marker=\"+\")","8793f0a4":"#so K value can be taken as 5\nkm= KMeans(n_clusters=4)\n\n","5ffdd955":"y_predicted=km.fit_predict(X)\ny_predicted\n\n","9e3eb186":"km.score(X) # ","d5404237":"#getting the absolute value of score \nfrom sklearn.metrics import silhouette_score\nsilhouette_score(X,y_predicted)","2cc8c489":"**Since the data is clean with No missing values. Lets get more information on data\n"}}