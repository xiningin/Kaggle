{"cell_type":{"682b9b33":"code","f047e1f9":"code","f47acf8c":"code","16dc63b8":"code","5722b3f6":"code","56cd2e4d":"code","7ecf594c":"code","9aa2fca8":"code","44c9cf18":"code","300eb382":"code","65aa4959":"code","2b6c655c":"code","a916eb58":"code","06316a6e":"code","b696ccd1":"code","cccef91d":"code","44db1a73":"code","de404e36":"code","01d17cb1":"code","476e9fa6":"code","3dad56ed":"code","a7b517f8":"code","fbffdf6d":"code","b6e5d2a1":"markdown","d23ca720":"markdown","570f20ea":"markdown","75a39f4a":"markdown","f525f71e":"markdown","f3fb4337":"markdown","6b2c44eb":"markdown","e5764c2c":"markdown","ab368d8c":"markdown","2749d234":"markdown","ef586410":"markdown","03617bdd":"markdown","073ff4ef":"markdown","4aa95ba2":"markdown","504de4b2":"markdown","d29ca9c0":"markdown","af73398b":"markdown","f0be5215":"markdown","f8be7574":"markdown","f123060f":"markdown"},"source":{"682b9b33":"import warnings\nwarnings.filterwarnings('ignore')","f047e1f9":"import librosa\naudio_path = '..\/input\/train_curated\/0006ae4e.wav'\nx , sr = librosa.load(audio_path)","f47acf8c":"import IPython.display as ipd\nipd.Audio(audio_path)","16dc63b8":"%matplotlib inline\nimport sklearn\nimport matplotlib.pyplot as plt\nimport librosa.display\n\nplt.figure(figsize=(20, 5))\nlibrosa.display.waveplot(x, sr=sr)","5722b3f6":"X = librosa.stft(x)\nXdb = librosa.amplitude_to_db(abs(X))\nplt.figure(figsize=(20, 5))\nlibrosa.display.specshow(Xdb, sr=sr, x_axis='time', y_axis='hz')\nplt.colorbar()","56cd2e4d":"librosa.display.specshow(Xdb, sr=sr, x_axis='time', y_axis='log')\nplt.colorbar()","7ecf594c":"import numpy as np\nsr = 22050 # sample rate\nT = 5.0    # seconds\nt = np.linspace(0, T, int(T*sr), endpoint=False) # time variable\nx = 0.5*np.sin(2*np.pi*220*t)# pure sine wave at 220 Hz\n","9aa2fca8":"ipd.Audio(x, rate=sr) # load a NumPy array","44c9cf18":"librosa.output.write_wav('..\/tone_440.wav', x, sr) # writing wave file in tone440.wav format","300eb382":"x, sr = librosa.load('..\/input\/train_noisy\/000b6cfb.wav')\nipd.Audio(x, rate=sr)","65aa4959":"#Plot the signal:\nplt.figure(figsize=(20, 5))\nlibrosa.display.waveplot(x, sr=sr)","2b6c655c":"# Zooming in\nn0 = 9000\nn1 = 9100\nplt.figure(figsize=(20, 5))\nplt.plot(x[n0:n1])\nplt.grid()","a916eb58":"zero_crossings = librosa.zero_crossings(x[n0:n1], pad=False)\nzero_crossings.shape","06316a6e":"print(sum(zero_crossings))","b696ccd1":"spectral_centroids = librosa.feature.spectral_centroid(x, sr=sr)[0]\nspectral_centroids.shape","cccef91d":"# Computing the time variable for visualization\nplt.figure(figsize=(20,5))\nframes = range(len(spectral_centroids))\nt = librosa.frames_to_time(frames)\n\n# Normalising the spectral centroid for visualisation\ndef normalize(x, axis=0):\n    return sklearn.preprocessing.minmax_scale(x, axis=axis)\n\n#Plotting the Spectral Centroid along the waveform\nlibrosa.display.waveplot(x, sr=sr, alpha=0.4)\nplt.plot(t, normalize(spectral_centroids), color='r')","44db1a73":"plt.figure(figsize=(20,5))\nspectral_rolloff = librosa.feature.spectral_rolloff(x+0.01, sr=sr)[0]\nlibrosa.display.waveplot(x, sr=sr, alpha=0.4)\nplt.plot(t, normalize(spectral_rolloff), color='r')\nplt.grid()","de404e36":"plt.figure(figsize=(20,5))\nx, fs = librosa.load('..\/input\/train_curated\/0006ae4e.wav')\nlibrosa.display.waveplot(x, sr=sr)","01d17cb1":"# MFCC\nplt.figure(figsize=(20,5))\nmfccs = librosa.feature.mfcc(x, sr=sr)\nprint(mfccs.shape)\n\nlibrosa.display.specshow(mfccs, sr=sr, x_axis='time')","476e9fa6":"mfccs = sklearn.preprocessing.scale(mfccs, axis=1)\nprint(mfccs.mean(axis=1))\nprint(mfccs.var(axis=1))","3dad56ed":"plt.figure(figsize=(20,8))\nlibrosa.display.specshow(mfccs, sr=sr, x_axis='time')","a7b517f8":"# Loadign the file\nx, sr = librosa.load('..\/input\/train_curated\/0006ae4e.wav')\nipd.Audio(x, rate=sr)","fbffdf6d":"hop_length = 512\nchromagram = librosa.feature.chroma_stft(x, sr=sr, hop_length=hop_length)\nplt.figure(figsize=(15, 5))\nlibrosa.display.specshow(chromagram, x_axis='time', y_axis='chroma', hop_length=hop_length, cmap='coolwarm')","b6e5d2a1":"## Visualizing Audio\n\n### Waveform\nWe can plot the audio array using librosa.display.waveplot:\n","d23ca720":"<div class=\"cell border-box-sizing text_cell rendered\"><div class=\"prompt input_prompt\">\n<\/div>\n<div class=\"inner_cell\">\n<div class=\"text_cell_render border-box-sizing rendered_html\">\n<h1 id=\"Free-Sound-Cloud-Audio-Classification-Challange\">Free Sound Cloud Audio Classification Challange<a class=\"anchor-link\" href=\"https:\/\/www.kaggle.com\/ashishpatel26\/audio-classification?scriptVersionId=12940645#Free-Sound-Cloud-Audio-Classification-Challange\" target=\"_self\">\u00b6<\/a><\/h1><p><img src=\"https:\/\/upload.wikimedia.org\/wikipedia\/commons\/3\/3c\/Freesound_project_website_logo.png\" alt=\"\"><\/p>\n<h1 style=\"text-align:center;\"> Project Model<\/h1><p>Input file : <strong>Audio Wave file<\/strong><br>\nOutput file : <strong>Label<\/strong>\n<img src=\"https:\/\/storage.googleapis.com\/kaggle-media\/competitions\/freesound\/task2_freesound_audio_tagging.png\" alt=\"\"><\/p>\n\n<\/div>\n<\/div>\n<\/div>","570f20ea":"## Loading an audio\u00a0file","75a39f4a":"## 4.MFCC","f525f71e":"## Saving the signal\n","f3fb4337":"I count 6 zero crossings. Let's compute the zero crossings using librosa.","6b2c44eb":"## 1. Zero Crossing Rate","e5764c2c":"# Feature Extraction","ab368d8c":"## 2.Spectral Centroid","2749d234":"## Feature Scaling\nLet's scale the MFCCs such that each coefficient dimension has zero mean and unit variance:","ef586410":"## 3.Spectral Rolloff ","03617bdd":"<h1>Table of Contents<span class=\"tocSkip\"><\/span><\/h1>\n<div class=\"toc\"><ul class=\"toc-item\"><li><ul class=\"toc-item\"><li><span><a href=\"#Loading-an-audio-file\" data-toc-modified-id=\"Loading-an-audio-file-0.1\"><span class=\"toc-item-num\">0.1&nbsp;&nbsp;<\/span>Loading an audio file<\/a><\/span><\/li><li><span><a href=\"#Playing-Audio\" data-toc-modified-id=\"Playing-Audio-0.2\"><span class=\"toc-item-num\">0.2&nbsp;&nbsp;<\/span>Playing Audio<\/a><\/span><\/li><li><span><a href=\"#Visualizing-Audio\" data-toc-modified-id=\"Visualizing-Audio-0.3\"><span class=\"toc-item-num\">0.3&nbsp;&nbsp;<\/span>Visualizing Audio<\/a><\/span><ul class=\"toc-item\"><li><span><a href=\"#Waveform\" data-toc-modified-id=\"Waveform-0.3.1\"><span class=\"toc-item-num\">0.3.1&nbsp;&nbsp;<\/span>Waveform<\/a><\/span><\/li><li><span><a href=\"#Spectrogram\" data-toc-modified-id=\"Spectrogram-0.3.2\"><span class=\"toc-item-num\">0.3.2&nbsp;&nbsp;<\/span>Spectrogram<\/a><\/span><\/li><li><span><a href=\"#Log-Frequency-axis\" data-toc-modified-id=\"Log-Frequency-axis-0.3.3\"><span class=\"toc-item-num\">0.3.3&nbsp;&nbsp;<\/span>Log Frequency axis<\/a><\/span><\/li><\/ul><\/li><li><span><a href=\"#Creating-an-audio-signal\" data-toc-modified-id=\"Creating-an-audio-signal-0.4\"><span class=\"toc-item-num\">0.4&nbsp;&nbsp;<\/span>Creating an audio signal<\/a><\/span><\/li><li><span><a href=\"#Playing-the-sound\" data-toc-modified-id=\"Playing-the-sound-0.5\"><span class=\"toc-item-num\">0.5&nbsp;&nbsp;<\/span>Playing the sound<\/a><\/span><\/li><li><span><a href=\"#Saving-the-signal\" data-toc-modified-id=\"Saving-the-signal-0.6\"><span class=\"toc-item-num\">0.6&nbsp;&nbsp;<\/span>Saving the signal<\/a><\/span><\/li><\/ul><\/li><li><span><a href=\"#Feature-Extraction\" data-toc-modified-id=\"Feature-Extraction-1\"><span class=\"toc-item-num\">1&nbsp;&nbsp;<\/span>Feature Extraction<\/a><\/span><ul class=\"toc-item\"><li><span><a href=\"#1.-Zero-Crossing-Rate\" data-toc-modified-id=\"1.-Zero-Crossing-Rate-1.1\"><span class=\"toc-item-num\">1.1&nbsp;&nbsp;<\/span>1. Zero Crossing Rate<\/a><\/span><\/li><li><span><a href=\"#2.Spectral-Centroid\" data-toc-modified-id=\"2.Spectral-Centroid-1.2\"><span class=\"toc-item-num\">1.2&nbsp;&nbsp;<\/span>2.Spectral Centroid<\/a><\/span><\/li><li><span><a href=\"#3.Spectral-Rolloff\" data-toc-modified-id=\"3.Spectral-Rolloff-1.3\"><span class=\"toc-item-num\">1.3&nbsp;&nbsp;<\/span>3.Spectral Rolloff<\/a><\/span><\/li><li><span><a href=\"#4.MFCC\" data-toc-modified-id=\"4.MFCC-1.4\"><span class=\"toc-item-num\">1.4&nbsp;&nbsp;<\/span>4.MFCC<\/a><\/span><\/li><li><span><a href=\"#Feature-Scaling\" data-toc-modified-id=\"Feature-Scaling-1.5\"><span class=\"toc-item-num\">1.5&nbsp;&nbsp;<\/span>Feature Scaling<\/a><\/span><\/li><li><span><a href=\"#Chroma-Frequencies\" data-toc-modified-id=\"Chroma-Frequencies-1.6\"><span class=\"toc-item-num\">1.6&nbsp;&nbsp;<\/span>Chroma Frequencies<\/a><\/span><\/li><\/ul><\/li><\/ul><\/div>","073ff4ef":"## Playing Audio\nUsing IPython.display.Audio, to play the audio","4aa95ba2":"## Creating an audio\u00a0signal\nLet us now create an audio signal at 220Hz. We know an audio signal is a numpy array, so we shall create one and pass it on to the audio function.\n","504de4b2":"### Log Frequency axis","d29ca9c0":"### Spectrogram\nWe can also display a spectrogram using librosa.display.specshow.","af73398b":"You can even use an mp3 or a WMA format for the audio example.","f0be5215":"## Chroma Frequencies","f8be7574":"Here, we have the plot the amplitude envelope of a waveform.","f123060f":"## Playing the sound\n"}}