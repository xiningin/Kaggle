{"cell_type":{"0755ea92":"code","a87335a5":"code","da483489":"code","572e7ad3":"code","574c28f8":"code","d165c9b1":"code","c85c7189":"code","b481e3ac":"code","6e9cfecc":"code","81862639":"code","1fc640b9":"code","74e6fad7":"code","bf8863a4":"code","9ccda821":"code","5279c06d":"code","9f843c02":"code","813b7d6c":"code","40f13851":"markdown","c6f766d5":"markdown","74e3dfa3":"markdown","066c05ef":"markdown","484398cd":"markdown","47521b8c":"markdown","5614f6b0":"markdown"},"source":{"0755ea92":"import numpy as np\r\nimport pandas as pd\r\nimport matplotlib.pyplot as plt\r\nimport seaborn as sns\r\n\r\nfrom sklearn.preprocessing import OrdinalEncoder, LabelEncoder, StandardScaler\r\nfrom sklearn.model_selection import train_test_split, cross_val_score, GridSearchCV\r\nfrom sklearn.linear_model import LinearRegression\r\nfrom sklearn.ensemble import RandomForestRegressor\r\nfrom sklearn.pipeline import Pipeline\r\nfrom sklearn.metrics import mean_squared_error\r\n\r\nimport xgboost as xgb\r\n\r\nsns.set_style('darkgrid')","a87335a5":"pizza = pd.read_csv('..\/input\/pizza-price-prediction\/pizza_v2.csv')\r\npizza.head()","da483489":"pizza.info()","572e7ad3":"pizza.describe()","574c28f8":"pizza['price_rupiah'] = pizza.price_rupiah.str.replace('Rp', '').str.replace(',', '').astype(float)\r\npizza['diameter'] = pizza.diameter.str.replace(' inch', '').astype(float)\r\npizza.describe()","d165c9b1":"print(pizza.shape)\r\npizza.drop_duplicates(inplace=True)\r\nprint(pizza.shape)","c85c7189":"size_order = ['small', 'reguler', 'medium', 'large', 'XL', 'jumbo']\r\n\r\nencoder = OrdinalEncoder(categories=[size_order], dtype=np.int64)\r\npizza.size = encoder.fit_transform(pizza[['size']])","b481e3ac":"columns = ['company', 'topping', 'variant', 'extra_sauce', 'extra_cheese', 'extra_mushrooms']\r\n\r\nle_list = {}\r\n\r\nfor column in columns:\r\n    encoder = LabelEncoder()\r\n    le_list[column] = encoder\r\n    pizza[column] = encoder.fit_transform(pizza[column])\r\n\r\npizza.head()","6e9cfecc":"y = pizza.price_rupiah\r\nX = pizza.drop('price_rupiah', axis='columns')\r\n\r\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2)","81862639":"pipeline_lr = Pipeline([\r\n    ('scaler', StandardScaler()),\r\n    ('lr', LinearRegression())\r\n])\r\n\r\npipeline_lr.fit(X_train, y_train)","1fc640b9":"pipeline_rf = Pipeline([\r\n    ('scaler', StandardScaler()),\r\n    ('rf', RandomForestRegressor())\r\n])\r\n\r\nparam_rf = {\r\n    'rf__n_estimators': [100, 600, 1000],\r\n    'rf__max_depth': [3, 5, None]\r\n}\r\n\r\ngsearch_rf = GridSearchCV(pipeline_rf, param_rf)\r\n\r\ngsearch_rf.fit(X_train, y_train)","74e6fad7":"pipeline_xgb = Pipeline([\r\n    ('scaler', StandardScaler()),\r\n    ('xgb', xgb.XGBRegressor())\r\n])\r\n\r\nparam_xgb = {\r\n    'xgb__n_estimators': [100, 600, 1000],\r\n    'xgb__max_depth': [3, 5, None]\r\n}\r\n\r\ngsearch_xgb = GridSearchCV(pipeline_xgb, param_xgb)\r\n\r\ngsearch_xgb.fit(X_train, y_train)","bf8863a4":"print('Train R2 Score : ')\r\nprint('lr: {}'.format(pipeline_lr.score(X_train, y_train)))\r\nprint('rf: {}'.format(gsearch_rf.score(X_train, y_train)))\r\nprint('xgb: {}'.format(gsearch_xgb.score(X_train, y_train)))","9ccda821":"pred_linreg = pipeline_lr.predict(X_train)\r\npred_rf = gsearch_rf.predict(X_train)\r\npred_xgb = gsearch_xgb.predict(X_train)\r\n\r\nprint('Train MSE : ')\r\nprint('lr: {}'.format(mean_squared_error(y_train, pred_linreg)))\r\nprint('rf: {}'.format(mean_squared_error(y_train, pred_rf)))\r\nprint('xgb: {}'.format(mean_squared_error(y_train, pred_xgb)))\r\n","5279c06d":"y_pred = gsearch_xgb.predict(X_test)\r\nprint('Test evaluation')\r\nprint('xgb: {}'.format(gsearch_xgb.score(X_test, y_test)))\r\nprint('xgb: {}'.format(mean_squared_error(y_test, y_pred)))","9f843c02":"print('best param')\r\nprint(gsearch_rf.best_params_)\r\nprint(gsearch_xgb.best_params_)","813b7d6c":"print(gsearch_xgb.best_estimator_['xgb'].feature_importances_)\r\n\r\n","40f13851":"## ***4. Split Data***","c6f766d5":"## ***3. Feature Engineering***","74e3dfa3":"## ***1. Preparation***","066c05ef":"# **Pizza Price Prediction**\r\n## *Model Development*\r\n\r\n------\r\n**Arinal Haq**","484398cd":"## ***6. Evaluation***","47521b8c":"## ***2. Data Preparation***","5614f6b0":"## ***5. Modelling***"}}