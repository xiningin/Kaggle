{"cell_type":{"b1a53f37":"code","4b0b1406":"code","890a154c":"code","c929bae1":"code","c8b9e31c":"code","b18f7c3d":"code","b169e53f":"code","ccff1cda":"code","1a5757ca":"code","40982c26":"code","8e525ab7":"code","e4030fb7":"code","939d1e3f":"code","88c64aa4":"code","1ec4e149":"code","169c641e":"code","728ca58b":"code","2c40671c":"code","15be0da3":"markdown","1d7b6591":"markdown","c47b1ee7":"markdown","7ee59e45":"markdown","daca86f3":"markdown","27f61201":"markdown","6d8ed6e8":"markdown"},"source":{"b1a53f37":"# let us install gdcm library \n!conda install -c conda-forge gdcm -y","4b0b1406":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n\nimport os\nimport pydicom as dcm\nimport plotly.express as px\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport glob\nimport gdcm\nfrom matplotlib import animation, rc\n\nimport matplotlib\n%matplotlib inline\nmatplotlib.use(\"Agg\")\nimport matplotlib.pyplot as plt\nimport matplotlib.animation as animation\nTRAIN_DIR = \"..\/input\/rsna-str-pulmonary-embolism-detection\/train\/\"\nfiles = glob.glob('..\/input\/rsna-str-pulmonary-embolism-detection\/train\/*\/*\/*.dcm')\n\nrc('animation', html='jshtml')\n","890a154c":"train = pd.read_csv('\/kaggle\/input\/rsna-str-pulmonary-embolism-detection\/train.csv')\ntest = pd.read_csv('\/kaggle\/input\/rsna-str-pulmonary-embolism-detection\/test.csv')","c929bae1":"train.head()","c8b9e31c":"test.head()\n","b18f7c3d":"def bar_plot(column_name):\n    ds = train[column_name].value_counts().reset_index()\n    ds.columns = ['Values', 'Total Number']\n    fig = px.bar(\n        ds, \n        y='Values', \n        x=\"Total Number\", \n        orientation='h', \n        title='Bar plot of: ' + column_name,\n        width=600,\n        height=400\n    )\n    fig.show()","b169e53f":"col = train.columns\ncol","ccff1cda":"col[0+3]","1a5757ca":"len(col)-3","40982c26":"for i in range(len(col)-3):\n    bar_plot(col[i+3])","8e525ab7":"# drop the first column ('sig_id'), and \ndf = train.drop(['StudyInstanceUID', 'SeriesInstanceUID', 'SOPInstanceUID'], axis=1).sum(axis=0).sort_values(ascending=False).reset_index()\ndf.head()","e4030fb7":"\ndf.columns = ['column', 'nonzero_records']\nfig = px.bar(\n    df, \n    y='nonzero_records', \n    x='column', \n    orientation='v', \n    title='Columns and non zero samples', \n    height=500, \n    width=1000\n)\nfig.show()\n\n# drop the first column ('sig_id') and count the 0s in \ndf1 = train.drop(['StudyInstanceUID', 'SeriesInstanceUID', 'SOPInstanceUID'], axis=1).sum(axis=0).sort_values(ascending=False).reset_index()\ndf1.columns = ['column', 'zero_records']\ndf1['zero_records'] = len(train) -  df1['zero_records']\n# plot the bar \n\nfig = px.bar(\n    df1.head(50), \n    y='zero_records', \n    x='column', \n    orientation='v', \n    title='Columns with the zero samples ', \n    height=500, \n    width=1000\n)\nfig.show()","939d1e3f":"corr = train.corr()\ncorr.style.background_gradient(cmap='coolwarm')","88c64aa4":"scans = glob.glob('\/kaggle\/input\/rsna-str-pulmonary-embolism-detection\/train\/*\/*\/')\n","1ec4e149":"def read_scan(path):\n    fragments = glob.glob(path + '\/*')\n    \n    slices = []\n    for f in fragments:\n        img = dcm.dcmread(f)\n        img_data = img.pixel_array\n        length = int(img.InstanceNumber)\n        slices.append((length, img_data))\n    slices.sort()\n    return [s[1] for s in slices]\n\ndef animate(ims):\n    fig = plt.figure(figsize=(11,11))\n    plt.axis('off')\n    im = plt.imshow(ims[0], cmap='gray')\n\n    def animate_func(i):\n        im.set_array(ims[i])\n        return [im]\n\n    anim = animation.FuncAnimation(fig, animate_func, frames = len(ims), interval = 1000\/\/24)\n    \n    return anim","169c641e":"movie = animate(read_scan(scans[1]))","728ca58b":"movie","2c40671c":"movie.save('Test.gif', dpi=80, writer='imagemagick')","15be0da3":"### Let's do animation (Inspired from https:\/\/www.kaggle.com\/isaienkov\/pulmonary-embolism-detection-eda)","1d7b6591":"# Columns and non-zero\/zero samples","c47b1ee7":"# Let us see the scans and save it as gif ","7ee59e45":"# Let us check correlation: ","daca86f3":"## glob module used here: \nThe glob module finds all the pathnames matching a specified pattern according to the rules used by the Unix shell, although results are returned in arbitrary order\n\n","27f61201":"# RSNA-STR Pulmonary Embolism Detection\n\n\n\n##### File descriptions\n\n- test - all test images\n- train - all train images (note that your submission kernels will NOT have access to this set of images, so you must build your models elsewhere and incorporate them into your submissions)\n- sample_submission.csv - contains rows for each UID+label combination that requires a prediction. Therefore it has a row for each image (for which you will be predicting the existence of a pulmonary embolism within the image) and row for each study+label that requires a study-level prediction.\n- train.csv - contains UIDs and all labels.\n- test.csv - contains UIDs.\n\n### Data fields\n\n- StudyInstanceUID - unique ID for each study (exam) in the data.\n- SeriesInstanceUID - unique ID for each series within the study.\n- SOPInstanceUID - unique ID for each image within the study (and data).\n- pe_present_on_image - image-level, notes whether any form of PE is present on the image.\n- negative_exam_for_pe - exam-level, whether there are any images in the study that have PE present.\n- qa_motion - informational, indicates whether radiologists noted an issue with motion in the study.\n- qa_contrast - informational, indicates whether radiologists noted an issue with contrast in the study.\n- flow_artifact - informational\n- rv_lv_ratio_gte_1 - exam-level, indicates whether the RV\/LV ratio present in the study is >= 1\n- rv_lv_ratio_lt_1 - exam-level, indicates whether the RV\/LV ratio present in the study is < 1\n- leftsided_pe - exam-level, indicates that there is PE present on the left side of the images in the study\n- chronic_pe - exam-level, indicates that the PE in the study is chronic\n- true_filling_defect_not_pe - informational, indicates a defect that is NOT PE\n- rightsided_pe - exam-level, indicates that there is PE present on the right side of the images in the study\n- acute_and_chronic_pe - exam-level, indicates that the PE present in the study is both acute AND chronic\n- central_pe - exam-level, indicates that there is PE present in the center of the images in the study\n- indeterminate -exam-level, indicates that while the study is not negative for PE, an ultimate set of exam-level labels could not be created, due to QA issues\n","6d8ed6e8":"# columns distribution "}}