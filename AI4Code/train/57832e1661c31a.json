{"cell_type":{"bd8cccc6":"code","9a072d6d":"code","2900d790":"code","5e85a44d":"code","fd6be0fc":"code","163f0c39":"code","52d571c0":"code","e876898e":"code","6cb4894a":"code","ddb7600d":"code","f2b25bac":"code","224396cf":"code","71718378":"code","28ccacb8":"code","ed40d84c":"code","86e7f0e8":"code","fba23099":"markdown","cb6a1a69":"markdown","31b08af6":"markdown","984a01a4":"markdown","b9b37a14":"markdown","efc2244c":"markdown","24638fcb":"markdown"},"source":{"bd8cccc6":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport os\nimport tensorflow as tf","9a072d6d":"def get_model():\n    model = tf.keras.models.Sequential([tf.keras.applications.ResNet50(include_top=False,input_shape=(256,256,3),pooling='avg'),\n                                       tf.keras.layers.Dense(1,activation=\"sigmoid\")])\n    model.compile(loss=\"binary_crossentropy\",optimizer=\"adam\",metrics=['accuracy'])\n    return model\nmodel = get_model()\nmodel.summary()","2900d790":"os.listdir(\"\/kaggle\/working\")","5e85a44d":"path = \"\/kaggle\/working\/cp.ckpt\"","fd6be0fc":"callbacks = [tf.keras.callbacks.ModelCheckpoint(path,save_weights_only=True)]","163f0c39":"x = np.random.randint(0,256,(10,256,256,3))\ny = np.random.randint(0,2,(10))\ny","52d571c0":"#training\nmodel.fit(x,y,callbacks=callbacks,epochs=5)","e876898e":"!ls {file}","6cb4894a":"m = get_model()\nm.evaluate(x,y)","ddb7600d":"m.load_weights(path)\nm.evaluate(x,y) ","f2b25bac":"path2 = \"\/kaggle\/working\/cp{epoch:04d}.ckpt\"","224396cf":"callbacks2 = [tf.keras.callbacks.ModelCheckpoint(path2,period=3,save_weights_only=True)]","71718378":"m.fit(x,y,epochs=10,callbacks=callbacks2)","28ccacb8":"# get latest checkpoint file name\nlatest = tf.train.latest_checkpoint(\"\/kaggle\/working\/\")\nprint(latest)","ed40d84c":"mo = get_model()\nmo.load_weights(latest)","86e7f0e8":"mo.evaluate(x,y)","fba23099":" # creating checkpoint , 3 files will be created and saved for each epoch","cb6a1a69":"# load weights from check point files","31b08af6":"# basic transfer learning model","984a01a4":"# random data for trainnig","b9b37a14":"# check files stored , checkpint file will have metadata , \n# .data-0000 file will have weights\n# .index files will have index of each epoch saved files","efc2244c":"# create a new model object ","24638fcb":"# will create multiple check point files for 3 epochs"}}