{"cell_type":{"244c5500":"code","61d161e1":"code","b8f076ca":"code","4330df61":"code","4c6a584f":"code","a1da89fb":"code","f0e21bbe":"code","6a77458b":"code","5b21a90e":"code","b78519a4":"markdown"},"source":{"244c5500":"import os\nimport cv2\nimport glob2\nimport pydicom\nfrom joblib import Parallel, delayed\nfrom tqdm import tqdm_notebook as tqdm","61d161e1":"def convert_images(filename, outdir):\n    ds = pydicom.read_file(str(filename))\n    img = ds.pixel_array\n    img = cv2.resize(img, (128, 128))\n    cv2.imwrite(outdir + filename.split('\/')[-1][:-4] + '.png', img)","b8f076ca":"train_path = '..\/input\/siim-dicom-images\/siim-original\/dicom-images-train\/'\ntest_path = '..\/input\/siim-dicom-images\/siim-original\/dicom-images-test\/'","4330df61":"train_out_path = 'train_png\/'\ntest_out_path = 'test_png\/'","4c6a584f":"if not os.path.exists(train_out_path):\n    os.makedirs(train_out_path)","a1da89fb":"if not os.path.exists(test_out_path):\n    os.makedirs(test_out_path)","f0e21bbe":"train_dcm_list = glob2.glob(os.path.join(train_path, '**\/*.dcm'))\ntest_dcm_list = glob2.glob(os.path.join(test_path, '**\/*.dcm'))","6a77458b":"res1 = Parallel(n_jobs=8, backend='threading')(delayed(\n    convert_images)(i, train_out_path) for i in tqdm(train_dcm_list[:100], total=len(train_dcm_list)))","5b21a90e":"res2 = Parallel(n_jobs=8, backend='threading')(delayed(\n    convert_images)(i, test_out_path) for i in tqdm(test_dcm_list[:100], total=len(test_dcm_list)))","b78519a4":"### remove :100 to run on full data. apparently kaggle allows only 500 files in output"}}