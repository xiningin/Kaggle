{"cell_type":{"6687b8ce":"code","db822c68":"code","7373dc50":"code","47f9b078":"code","3a29a048":"code","74197f3d":"code","326778fd":"code","315bb463":"code","fb90de68":"code","624e1bb9":"code","2c2219e2":"code","e1069b56":"code","863991fa":"code","f3b198f1":"code","7e52ced8":"code","3e1904ae":"code","d239bdb5":"code","c567f8cd":"code","c80eb151":"code","7e94c17e":"code","34070189":"code","630ca851":"code","34bd1481":"code","1e8ee2aa":"code","642a277f":"code","2b9c45cd":"code","1325c2f0":"code","bc8599b7":"code","656b02ab":"code","4e154a8d":"code","56fd38d7":"code","3c4ac266":"code","e46f7d20":"code","3ea47037":"code","3aa222bd":"code","f05accdb":"code","cbe7f661":"code","1a662fa9":"code","92559055":"code","3e3becd3":"code","9e6e3bbb":"code","570ce31a":"code","bc52effb":"code","5e5fbc50":"code","f2125af5":"code","0840dbd8":"code","5d2fcea8":"code","c32fe396":"code","67b07276":"code","a98b42fe":"code","fe934150":"code","5cf0ded4":"code","a29d282e":"code","fd9d4fa7":"code","89535d80":"code","47b0fdb6":"code","2b3bf123":"code","fd43dbb4":"code","335c1771":"code","7ba2a7e4":"code","72203cd6":"code","d00706e5":"code","1135e9fb":"code","46bc565d":"code","81db4b72":"code","9db97f1a":"code","4f014da8":"code","9783b792":"code","55de0a79":"code","680d76f3":"code","2f3d6dc7":"code","c2f15d46":"code","e913a5cb":"code","d0d5c18a":"code","c22e2411":"markdown","eea3034a":"markdown","bb06d9c0":"markdown","fb5b772c":"markdown","6401ccc2":"markdown","451a8c6a":"markdown","4a8f5bbb":"markdown","968be329":"markdown","09e9b16b":"markdown","9313d15d":"markdown","c5f729d8":"markdown","5c009c3e":"markdown","c8a24f73":"markdown","6d4e877b":"markdown","eed3c4ab":"markdown","17f50c02":"markdown","3f99e3a6":"markdown","6a2d5f87":"markdown","51b046cd":"markdown","e396bbec":"markdown","59251f2c":"markdown","e8317716":"markdown","a8031efa":"markdown","803ec3c4":"markdown","6052fb69":"markdown","37be5428":"markdown"},"source":{"6687b8ce":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# For data visualization\nimport matplotlib.pyplot as plt\nimport matplotlib as mpl\nimport seaborn as sns; sns.set()\n\n# plotly\n# import plotly.plotly as py\nfrom plotly.offline import init_notebook_mode, iplot, plot\nimport plotly as py\ninit_notebook_mode(connected=True)\nimport plotly.graph_objs as go\nimport plotly.figure_factory as ff\n\n# Disabling warnings\nimport warnings\nwarnings.simplefilter(\"ignore\")\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","db822c68":"data = pd.read_csv(\"\/kaggle\/input\/mushroom-classification\/mushrooms.csv\")\ndf = data.copy()","7373dc50":"display(df.head())\ndisplay(df.tail())","47f9b078":"df.info()","3a29a048":"df.isnull().sum()","74197f3d":"df.columns","326778fd":"len(df.columns)","315bb463":"df.columns = ['Mushroom_class', 'Cap_shape', 'Cap_surface', 'Cap_color', 'Bruises', 'Odor', 'Gill_attachment', 'Gill_spacing', 'Gill_size', 'Gill_color',\n            'Stalk_shape', 'Stalk_root', 'Stalk_surface_above_ring', 'Stalk_surface_below_ring', 'Stalk_color_above_ring', 'Stalk_color_below_ring', \n            'Veil_type', 'Veil_color', 'Ring_number', 'Ring_type', 'Spore_print_color', 'Population', 'Habitat']\ndf.head()","fb90de68":"df.columns","624e1bb9":"cols = df.columns\ndf[cols] = df[cols].astype('category')","2c2219e2":"# Alternative way\n# df.columns.apply(lambda x: x.astype('category'))","e1069b56":"df.info()","863991fa":"for col in df.columns:\n    print(df[col].unique())","f3b198f1":"df.describe()","7e52ced8":"for col in df.columns:\n    print(df[col].value_counts())","3e1904ae":"for i, col in enumerate(df.columns):\n    plt.figure(i)\n    plt.title(col, color = 'blue',fontsize=15)\n    sns.countplot(x=col, data=df ,order=df[col].value_counts().index)","d239bdb5":"from sklearn.model_selection import train_test_split, GridSearchCV, cross_val_score\nfrom sklearn.metrics import confusion_matrix, accuracy_score, classification_report\nimport statsmodels.api as sm\nimport statsmodels.formula.api as smf\nfrom sklearn import tree\nfrom sklearn.ensemble import RandomForestClassifier","c567f8cd":"df1 = df.copy()\ndf1.drop('Mushroom_class',axis=1,inplace=True)","c80eb151":"def one_hot(df, cols):\n    for each in cols:\n        dummies = pd.get_dummies(df[each], prefix=each, drop_first=False)\n        df = pd.concat([df, dummies], axis=1)\n    return df\ndf1 = one_hot(df1,df1.columns)\ndf1.head()","7e94c17e":"df1.info()","34070189":"from sklearn.preprocessing import LabelEncoder\n\nlbe = LabelEncoder()\ndf['Mushroom_class_bin'] = lbe.fit_transform(df['Mushroom_class'])\ndf.head()","630ca851":"y = df[\"Mushroom_class_bin\"]\nX = df1.select_dtypes(exclude='category')\nX_train, X_test, y_train, y_test = train_test_split(X, y, \n                                                    test_size=0.30, \n                                                    random_state=42)","34bd1481":"from sklearn.tree import DecisionTreeClassifier","1e8ee2aa":"cart = DecisionTreeClassifier()\ncart_model = cart.fit(X_train, y_train)","642a277f":"cart_model","2b9c45cd":"!pip install skompiler","1325c2f0":"y_pred = cart_model.predict(X_test)\naccuracy_score(y_test, y_pred)","bc8599b7":"cart_grid = {\"max_depth\": range(1,10),\n            \"min_samples_split\" : list(range(2,50)) }","656b02ab":"cart = tree.DecisionTreeClassifier()\ncart_cv = GridSearchCV(cart, cart_grid, cv = 10, n_jobs = -1, verbose = 2)\ncart_cv_model = cart_cv.fit(X_train, y_train)","4e154a8d":"print(\"Best Parameters: \" + str(cart_cv_model.best_params_))","56fd38d7":"cart = tree.DecisionTreeClassifier(max_depth = 8, min_samples_split = 2)\ncart_tuned = cart.fit(X_train, y_train)","3c4ac266":"y_pred = cart_tuned.predict(X_test)\naccuracy_score(y_test, y_pred)","e46f7d20":"Importance = pd.DataFrame({\"Importance\": cart_tuned.feature_importances_*100}, index = X_train.columns)","3ea47037":"Importance.sort_values(by = \"Importance\", \n                       axis = 0, \n                       ascending = False)[:10]","3aa222bd":"Importance.sort_values(by = \"Importance\", \n                       axis = 0, \n                       ascending = False)[:10].plot(kind =\"barh\", color = \"r\")\n\nplt.xlabel(\"Importance Levels of Categories\");","f05accdb":"# df2 = df.copy()\n# df2.drop('Mushroom_class',axis=1,inplace=True)\n# df2 = df2[['Odor', 'Stalk_root', 'Stalk_surface_below_ring', 'Spore_print_color', 'Ring_type']]\n# df2.head()","cbe7f661":"# def one_hot(df, cols):\n#     for each in cols:\n#         dummies = pd.get_dummies(df[each], prefix=each, drop_first=False)\n#         df = pd.concat([df, dummies], axis=1)\n#     return df\n# df2 = one_hot(df2,df2.columns)\n# df2 = df2.select_dtypes(exclude=['category'])\n# df2.head()","1a662fa9":"y = df[\"Mushroom_class_bin\"]\nX = df1[['Odor_n', 'Stalk_root_c', 'Stalk_surface_below_ring_y', 'Spore_print_color_r', 'Odor_a']]\nX_train, X_test, y_train, y_test = train_test_split(X, y, \n                                                    test_size=0.30, \n                                                    random_state=42)","92559055":"cart1 = DecisionTreeClassifier()\ncart_model1 = cart.fit(X_train, y_train)\ncart_model1","3e3becd3":"y_pred = cart_model1.predict(X_test)\naccuracy_score(y_test, y_pred)","9e6e3bbb":"cart_grid = {\"max_depth\": range(1,10),\n            \"min_samples_split\" : list(range(2,50)) }","570ce31a":"cart1 = tree.DecisionTreeClassifier()\ncart_cv = GridSearchCV(cart1, cart_grid, cv = 10, n_jobs = -1, verbose = 2)\ncart_cv_model = cart_cv.fit(X_train, y_train)","bc52effb":"print(\"Best Parameters: \" + str(cart_cv_model.best_params_))","5e5fbc50":"cart1 = tree.DecisionTreeClassifier(max_depth = 4, min_samples_split = 2)\ncart_tuned1 = cart1.fit(X_train, y_train)","f2125af5":"y_pred = cart_tuned1.predict(X_test)\naccuracy_score(y_test, y_pred)","0840dbd8":"Importance1 = pd.DataFrame({\"Importance\": cart_tuned1.feature_importances_*100}, index = X_train.columns)","5d2fcea8":"Importance1.sort_values(by = \"Importance\", \n                       axis = 0, \n                       ascending = False)[:10]","c32fe396":"Importance1.sort_values(by = \"Importance\", \n                       axis = 0, \n                       ascending = False)[:10].plot(kind =\"barh\", color = \"r\")\n\nplt.xlabel(\"Importance Levels of Categories\");","67b07276":"y = df[\"Mushroom_class_bin\"]\nX = df1.select_dtypes(exclude='category')\nX_train, X_test, y_train, y_test = train_test_split(X, y, \n                                                    test_size=0.30, \n                                                    random_state=42)","a98b42fe":"from sklearn.ensemble import RandomForestClassifier","fe934150":"rf_model = RandomForestClassifier().fit(X_train, y_train)","5cf0ded4":"rf_model","a29d282e":"y_pred = rf_model.predict(X_test)\naccuracy_score(y_test, y_pred)","fd9d4fa7":"rf_params = {\"max_depth\": [2,5,8,10],\n            \"max_features\": [2,5,8],\n            \"n_estimators\": [10,500,1000],\n            \"min_samples_split\": [2,5,10]}","89535d80":"rf_model = RandomForestClassifier()\n\nrf_cv_model = GridSearchCV(rf_model, \n                           rf_params, \n                           cv = 10, \n                           n_jobs = -1, \n                           verbose = 2) ","47b0fdb6":"rf_cv_model.fit(X_train, y_train)","2b3bf123":"print(\"Best Parameters: \" + str(rf_cv_model.best_params_))","fd43dbb4":"rf_tuned = RandomForestClassifier(max_depth = 8, \n                                  max_features = 5, \n                                  min_samples_split = 2,\n                                  n_estimators = 500)\n\nrf_tuned.fit(X_train, y_train)","335c1771":"y_pred = rf_tuned.predict(X_test)\naccuracy_score(y_test, y_pred)","7ba2a7e4":"Importance = pd.DataFrame({\"Importance\": rf_tuned.feature_importances_*100},\n                         index = X_train.columns)","72203cd6":"Importance.sort_values(by = \"Importance\", \n                       axis = 0, \n                       ascending = False)[0:10]","d00706e5":"Importance.sort_values(by = \"Importance\", \n                       axis = 0, \n                       ascending = False)[0:10].plot(kind =\"barh\", color = \"r\")\n\nplt.xlabel(\"Importance Levels of Variables\")","1135e9fb":"y = df[\"Mushroom_class_bin\"]\nX = df1[['Odor_n', 'Odor_f', 'Gill_size_b', 'Gill_size_n', 'Gill_color_b']]\nX_train, X_test, y_train, y_test = train_test_split(X, y, \n                                                    test_size=0.30, \n                                                    random_state=42)","46bc565d":"rf_model1 = RandomForestClassifier().fit(X_train, y_train)","81db4b72":"y_pred = rf_model1.predict(X_test)\naccuracy_score(y_test, y_pred)","9db97f1a":"rf_params = {\"max_depth\": [2,5,8,10],\n            \"max_features\": [2,5,8],\n            \"n_estimators\": [10,500,1000],\n            \"min_samples_split\": [2,5,10]}","4f014da8":"rf_model1 = RandomForestClassifier()\n\nrf_cv_model1 = GridSearchCV(rf_model1, \n                           rf_params, \n                           cv = 10, \n                           n_jobs = -1, \n                           verbose = 2) ","9783b792":"rf_cv_model1.fit(X_train, y_train)","55de0a79":"print(\"Best Parameters: \" + str(rf_cv_model1.best_params_))","680d76f3":"rf_tuned1 = RandomForestClassifier(max_depth = 2, \n                                  max_features = 2, \n                                  min_samples_split = 2,\n                                  n_estimators = 500)\n\nrf_tuned1.fit(X_train, y_train)","2f3d6dc7":"y_pred = rf_tuned1.predict(X_test)\naccuracy_score(y_test, y_pred)","c2f15d46":"Importance = pd.DataFrame({\"Importance\": rf_tuned1.feature_importances_*100},\n                         index = X_train.columns)","e913a5cb":"Importance.sort_values(by = \"Importance\", \n                       axis = 0, \n                       ascending = False)[0:10]","d0d5c18a":"Importance.sort_values(by = \"Importance\", \n                       axis = 0, \n                       ascending = False)[0:10].plot(kind =\"barh\", color = \"r\")\n\nplt.xlabel(\"Importance Levels of Variables\")","c22e2411":"### We have accuracy score of 1.0 which means that the features can successfully predict whether a mushroom is poisonous or not with a percentage of 100%. Since the accuracy score is already at the maximum value, the model tuning does not change the accuracy score.","eea3034a":"### When we look at the importance levels of different categories, we see that Odor_n, Stalk_root_c, Stalk_surface_below_ring_y, Spore_print_color_r and Odor_a can be considered the top 5 important sub-categories.\n### Note: The order of the important sub-categories with relatively lower importance scores may change in each trial.","bb06d9c0":"### This dataset includes descriptions of hypothetical samples corresponding to 23 species of gilled mushrooms in the Agaricus and Lepiota Family Mushroom drawn from The Audubon Society Field Guide to North American Mushrooms (1981).\n### We would like to find out which features are the most indicative of a poisonous or edible mushroom.\n\n### For this purpose;\n1. Have a general idea about the data set. \n1. Use necessary methods to clean and prepare the data for analysis.\n1. Conduct Explanatory Data Analysis (EDA) and visualization. \n1. Pre-process the data. \n1. Conduct Decision Tree and RF analyses with all of the categories and check the results.\n1. Look into the top most influential 5 features on the to classify the mushroom class whether the mushroom is poisonous or not. \n1. Conduct Decision Tree and RF analyses with these top 5 features one more time and check the results.","fb5b772c":"### Attribute Information: (classes: edible=e, poisonous=p)\n\n* cap-shape: bell=b,conical=c,convex=x,flat=f, knobbed=k,sunken=s\n\n* cap-surface: fibrous=f,grooves=g,scaly=y,smooth=s\n \n* cap-color: brown=n,buff=b,cinnamon=c,gray=g,green=r,pink=p,purple=u,red=e,white=w,yellow=y\n \n* bruises: bruises=t,no=f\n \n* odor: almond=a,anise=l,creosote=c,fishy=y,foul=f,musty=m,none=n,pungent=p,spicy=s\n \n* gill-attachment: attached=a,descending=d,free=f,notched=n\n \n* gill-spacing: close=c,crowded=w,distant=d\n \n* gill-size: broad=b,narrow=n\n \n* gill-color: black=k,brown=n,buff=b,chocolate=h,gray=g, green=r,orange=o,pink=p,purple=u,red=e,white=w,yellow=y\n \n* stalk-shape: enlarging=e,tapering=t\n \n* stalk-root: bulbous=b,club=c,cup=u,equal=e,rhizomorphs=z,rooted=r,missing=?\n \n* stalk-surface-above-ring: fibrous=f,scaly=y,silky=k,smooth=s\n \n* stalk-surface-below-ring: fibrous=f,scaly=y,silky=k,smooth=s\n \n* stalk-color-above-ring: brown=n,buff=b,cinnamon=c,gray=g,orange=o,pink=p,red=e,white=w,yellow=y\n \n* stalk-color-below-ring: brown=n,buff=b,cinnamon=c,gray=g,orange=o,pink=p,red=e,white=w,yellow=y\n \n* veil-type: partial=p,universal=u\n \n* veil-color: brown=n,orange=o,white=w,yellow=y\n \n* ring-number: none=n,one=o,two=t\n \n* ring-type: cobwebby=c,evanescent=e,flaring=f,large=l,none=n,pendant=p,sheathing=s,zone=z\n \n* spore-print-color: black=k,brown=n,buff=b,chocolate=h,green=r,orange=o,purple=u,white=w,yellow=y\n \n* population: abundant=a,clustered=c,numerous=n,scattered=s,several=v,solitary=y\n \n* habitat: grasses=g,leaves=l,meadows=m,paths=p,urban=u,waste=w,woods=d","6401ccc2":"## Model Tuning","451a8c6a":"## Countplot of Categorical Variables","4a8f5bbb":"# Data Preprocessing","968be329":"### We can only see the properties such as count, unique categories, the most frequent category and its frequency of each categorical variable. We do not have any other statistical information since they are not quantitative. ","09e9b16b":"## Model Tuning","9313d15d":"### We convert object type variables into categorical variables since we will use all of these categorical variables in our analysis. ","c5f729d8":"### We have keyword such as class and '-'between the words of variable names. So, it would be good to rename the columns. ","5c009c3e":"### We would like to know whether our result will be edible or poisonous (0\/1 in numerical terms) through our independent variables. For this purpose, we need to label our variables and convert the categories into numerical values. I have decided to use one-hot encoding. ","c8a24f73":"### We check the value counts of categories in each variable. ","6d4e877b":"### We use Seaborn Countplot graph to visualize the frequency of categories in each variable. ","eed3c4ab":"# General Information and Data Cleaning","17f50c02":"### Similar to Decision Tree approach, we have accuracy score of 1.0 which means that the features can successfully predict whether a mushroom is poisonous or not with a percentage of 100%. Since the accuracy score is already at the maximum value, the model tuning does not change the accuracy score.","3f99e3a6":"## Model Tuning","6a2d5f87":"### We execute RF model again with the top 5 features. It can be seen that accuracy score of the model with these top 5 features is 0.9664 compared to 1.0 with all of the features that comprise of all sub-categories. In this framework, top 5 features have a very high accuracy score to predict whether a mushroom is poisonous or not.","51b046cd":"# Decision Tree","e396bbec":"### We check the names and number of categories in each variable. ","59251f2c":"# RF","e8317716":"## Model Tuning","a8031efa":"### We execute decision tree model again with the top 5 features. It can be seen that accuracy score of the model with these top 5 features is 0.9888 compared to 1.0 with all of the features that comprise of all sub-categories. In this framework, top 5 features have a very high accuracy score to predict whether a mushroom is poisonous or not. ","803ec3c4":"### We have 23 categorical variables and 8124 observations.","6052fb69":"### We do not have any nan values. ","37be5428":"# EDA"}}