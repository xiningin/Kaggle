{"cell_type":{"344000e5":"code","3309708f":"code","65933902":"code","cb099660":"code","31146a33":"code","64d1b024":"code","d9f06442":"code","ceaa03e6":"code","d97ac5bb":"code","670cb441":"code","2dd3a248":"code","060cd227":"code","57628b93":"code","092d90b9":"code","7cd92d48":"code","85ca821a":"code","c04936d5":"code","b9fff549":"code","6573ea89":"code","355f2dde":"code","035cb286":"code","926fee35":"code","b5328a5f":"code","46f52267":"code","87a3e9ca":"code","f7f622ef":"code","194b60e5":"code","bdeb060d":"code","913478ca":"code","a16b2238":"code","15fae381":"code","85d0bc8f":"code","eddd3897":"code","f5ae684d":"code","4937af47":"code","ed3d6a13":"code","b4f069dd":"code","6e701bfc":"code","33b5328c":"code","8da70ee3":"code","a9640ca8":"code","860485aa":"code","4edc1089":"code","20d2aae5":"code","b61d7bb2":"code","5c1b2306":"code","88d3ff51":"markdown","f902c16b":"markdown","c64892bb":"markdown","351c06cc":"markdown","816111c6":"markdown","e1ce226e":"markdown","ea124b89":"markdown","2e64643c":"markdown","1824fdef":"markdown","f86a354e":"markdown","60fd9430":"markdown","02f6b5a7":"markdown","92bdad32":"markdown","bbc8cfe1":"markdown","152c7e39":"markdown","cc6d001f":"markdown","adbbb421":"markdown","1eb77352":"markdown","b1383e80":"markdown","46b46714":"markdown","d9e39215":"markdown","9c4a25fe":"markdown","4259fbce":"markdown","0f8e5fe7":"markdown","7e05a77f":"markdown","4bfd513c":"markdown","e6752e68":"markdown","06d23065":"markdown","6bed73fc":"markdown","050383f3":"markdown","0e29ea48":"markdown","b642ad1e":"markdown","948e9f58":"markdown","09658ccf":"markdown","2717dd36":"markdown","ec7b5de8":"markdown","8815e83a":"markdown","56fd1a98":"markdown","89cad11b":"markdown","3d9cb982":"markdown","ec76a4f4":"markdown","ac549e6f":"markdown","dd34fa49":"markdown","e20cfc01":"markdown","1966427a":"markdown","3f8d7915":"markdown"},"source":{"344000e5":"import pandas as pd\nimport numpy as np","3309708f":"import matplotlib.pyplot as plt\n%matplotlib inline","65933902":"math = pd.read_csv(\"..\/input\/student-mat.csv\")","cb099660":"math.head()","31146a33":"math.columns","64d1b024":"math.describe()","d9f06442":"math[\"Average\"] = (math['G1'] + math['G2'] + math['G3']) \/ 3","ceaa03e6":"math[\"Approved\"] = [ (1 if x > 10 else 0) for x in math[\"Average\"] ]","d97ac5bb":"math[\"school\"].unique()","670cb441":"len(math[math[\"school\"] == 'GP'])","2dd3a248":"len(math[math[\"school\"] == 'MS'])","060cd227":"data = [list( (math[math[\"school\"] == 'GP']['G1'] + math[math[\"school\"] == 'GP']['G2'] + math[math[\"school\"] == 'GP']['G3']) \/ 3),\n        list( (math[math[\"school\"] == 'MS']['G1'] + math[math[\"school\"] == 'MS']['G2'] + math[math[\"school\"] == 'MS']['G3']) \/ 3)]","57628b93":"plt.boxplot(data)\nplt.xticks(np.arange(3), ['', 'Gabriel Pereira', 'Mousinho da Silveira'])\nplt.title(\"Grades per School\")\nplt.ylabel(\"Average Grades\")\nplt.xlabel(\"School\")\nplt.show()\nplt.show()","092d90b9":"math[math[\"school\"] == 'GP']['reason'].value_counts().plot(kind='bar')","7cd92d48":"math[math[\"school\"] == 'MS']['reason'].value_counts().plot(kind='bar')","85ca821a":"math[\"internet\"].unique()","c04936d5":"len(math[math[\"internet\"] == 'yes']), len(math[math[\"internet\"] == 'no'])","b9fff549":"data = [list(math[math[\"internet\"] == \"yes\"][\"Average\"]), list(math[math[\"internet\"] == \"no\"][\"Average\"])]","6573ea89":"plt.boxplot(data)\nplt.xticks(np.arange(3), ['', 'Yes', 'No'])\nplt.title(\"Internet at Home\")\nplt.ylabel(\"Average Grades\")\nplt.xlabel(\"Internet\")\nplt.show()","355f2dde":"data = [list(math[math[\"sex\"]        == \"M\"][\"Average\"]),   list(math[math[\"sex\"]        == \"F\"][\"Average\"]),\n        list(math[math[\"address\"]    == \"U\"][\"Average\"]),   list(math[math[\"address\"]    == \"R\"][\"Average\"]),\n        list(math[math[\"famsize\"]    == \"LE3\"][\"Average\"]), list(math[math[\"famsize\"]    == \"GT3\"][\"Average\"]),\n        list(math[math[\"Pstatus\"]    == \"T\"][\"Average\"]),   list(math[math[\"Pstatus\"]    == \"A\"][\"Average\"]),\n        list(math[math[\"schoolsup\"]  == \"yes\"][\"Average\"]), list(math[math[\"schoolsup\"]  == \"no\"][\"Average\"]),        \n        list(math[math[\"higher\"]     == \"yes\"][\"Average\"]), list(math[math[\"higher\"]     == \"no\"][\"Average\"]),\n        list(math[math[\"nursery\"]    == \"yes\"][\"Average\"]), list(math[math[\"nursery\"]    == \"no\"][\"Average\"]), \n        list(math[math[\"activities\"] == \"yes\"][\"Average\"]), list(math[math[\"activities\"] == \"no\"][\"Average\"]),\n        list(math[math[\"paid\"]       == \"yes\"][\"Average\"]), list(math[math[\"paid\"]       == \"no\"][\"Average\"]),        \n        list(math[math[\"famsup\"]     == \"yes\"][\"Average\"]), list(math[math[\"famsup\"]     == \"no\"][\"Average\"]),        \n        list(math[math[\"romantic\"]   == \"yes\"][\"Average\"]), list(math[math[\"romantic\"]   == \"no\"][\"Average\"]),        \n       ]","035cb286":"from matplotlib.pylab import rcParams","926fee35":"rcParams['figure.figsize'] = 20, 10","b5328a5f":"plt.boxplot(data)\nplt.xticks(np.arange(23), [\"\", \"Male\", \"Female\", \"Urban\", \"Rural\", \"LE3\", \"GE3\", \"Together\", \"Apart\", \"Support-Y\", \"Support-N\", \n                          \"High-Y\", \"High-N\", \"Nursery-Y\", \"Nursery-N\", \"Activities-Y\", \"Activities-N\", \"Paid-Y\", \"Paid-N\",\n                          \"Famsup-Y\", \"Famsup-N\", \"Romance-Y\", \"Romance-N\"])\nplt.title(\"Predictive Feautres\")\nplt.ylabel(\"Average Grades\")\nplt.xlabel(\"Feature\")\nplt.show()","46f52267":"math[[\"Mjob\", \"Average\"]].boxplot(by=\"Mjob\")\nplt.title(\"Mother Jobs\")\nplt.ylabel(\"Average Grades\")\nplt.xlabel(\"Job\")\nplt.show()","87a3e9ca":"math[[\"Fjob\", \"Average\"]].boxplot(by=\"Fjob\")\nplt.title(\"Father Jobs\")\nplt.ylabel(\"Average Grades\")\nplt.xlabel(\"Job\")\nplt.show()","f7f622ef":"math[[\"Fjob\", \"Average\"]].boxplot(by=\"Fjob\")\nplt.title(\"Student's Guardian\")\nplt.ylabel(\"Average Grades\")\nplt.xlabel(\"Guardian\")\nplt.show()","194b60e5":"math[[\"Dalc\", \"Average\"]].boxplot(by=\"Dalc\")\nplt.title(\"Daily Alcohol Consumption\")\nplt.ylabel(\"Average Grades\")\nplt.xlabel(\"Level of Consumption\")\nplt.show()","bdeb060d":"math[[\"Walc\", \"Average\"]].boxplot(by=\"Walc\")\nplt.title(\"Weelend Alcohol Consumption\")\nplt.ylabel(\"Average Grades\")\nplt.xlabel(\"Level of Consumption\")\nplt.show()","913478ca":"from sklearn.tree import DecisionTreeClassifier","a16b2238":"attributes = [\"age\", \"Medu\", \"Fedu\", \"traveltime\", \"studytime\", \"failures\", \"famrel\", \"freetime\", \"goout\", \"Dalc\", \"Walc\", \"health\", \"absences\"]","15fae381":"X = math[attributes]\ny = math[\"Approved\"]","85d0bc8f":"X = X.assign(schoolsup = [ (1 if x == \"yes\" else 0) for x in math[\"schoolsup\"] ])\nX = X.assign(higher = [ (1 if x == \"yes\" else 0) for x in math[\"higher\"] ])","eddd3897":"attributes.append(\"schoolsup\")\nattributes.append(\"higher\")","f5ae684d":"X.head()","4937af47":"model = DecisionTreeClassifier(min_samples_leaf=20)\nmodel.fit(X, y)","ed3d6a13":"model.score(X, y)","b4f069dd":"np.sum(math[\"Approved\"]) \/ len(math)","6e701bfc":"import graphviz\nfrom sklearn import tree","33b5328c":"dot_data = tree.export_graphviz(model, out_file=None)\ngraph = graphviz.Source(dot_data)\ngraph","8da70ee3":"attributes[5]","a9640ca8":"attributes[13]","860485aa":"from sklearn.model_selection import train_test_split","4edc1089":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=1)","20d2aae5":"model = DecisionTreeClassifier(min_samples_leaf=20)\nmodel.fit(X_train, y_train)\nmodel.score(X_test, y_test)","b61d7bb2":"from sklearn.model_selection import cross_val_score\nfrom sklearn.model_selection import ShuffleSplit","5c1b2306":"model = DecisionTreeClassifier(min_samples_leaf=20)\ncv_ss = ShuffleSplit(n_splits=100, test_size=0.3, random_state=1)\nscores = cross_val_score(model, X, y, cv=cv_ss, n_jobs=-1)\nprint(\"Accuracy: %0.2f (+\/- %0.2f)\" % (scores.mean(), scores.std() * 2))","88d3ff51":"It seems that the model has \"true\" prediction capabilities.","f902c16b":"### Advanced Test","c64892bb":"### Identify Predictive Features","351c06cc":"### School","816111c6":"And the two identified categorical attributes.","e1ce226e":"Let's make the size of the figures a little bit bigger.","ea124b89":"46 students is barely statistically significant. Moreover if we take into account that for model evaluation we have to split the data in train\/test subsets, and that the sampling should be stratified. ","2e64643c":"It seems that if a student has already failed, he will fail again.","1824fdef":"Given the characteristics of the dataset (number of samples and type of variables) I would recommend to use decision trees as the family of candidate models to consider. An advantage of decision tress is the interpretability of results, so we can understand why do students fail to pass exams.","f86a354e":"It seems there are no relevant differences.","60fd9430":"Anyway, check if school is a good predictior.","02f6b5a7":"The same technique applied in the above section can be used to check if alcohol consumption is an indicator of poor school performance.","92bdad32":"Fortunately is not due to school \"reputation\", since there are no differences in grades.","bbc8cfe1":"Let's use the numberical variables","152c7e39":"The amount of alcohol ingested during week days nor weekends is not a predictive variable according to the identified model (it does not appear until the sixth level of the tree).","cc6d001f":"# Student Alcohol Consumption\n\n### Exploratory Data Analysis","adbbb421":"Also, it would be very nice to have a variable showing if the student has or has not passed the course, but we are not sure if that it is computed as the average of the three grades. So, let's call it if the student has been approved (1 - approved, 0 - not approved).","1eb77352":"Let's see what would happen in case of a random guessing.","b1383e80":"And that if the student is getting external support is because it is likely that he will fail again","46b46714":"No, it seems it does not.","d9e39215":"The original question was if alcohol consumption affects the performance of students at school. Of course, it is impossible to answer that question given the fact that we have data from only two schools. The only question that could be answered with the dataset provided is if alcohol consumption is \"somehow related\" to school performance for the students of that school and for that particular year, and it turned out that it does not.\n\nA serious study would require a large sample of randomly selected students and schools.\n\nThe causal implication of alcohol consumption to school performance can only be proved by means of running a controlled experiment. Unfortunately, that cannot be done in practice, sice we can not ask students to consume large amounts of alcohol during an accademic year.\n\nA final note about \"research ethics\" is worth mentioning. It is highly surprising that the authors of the study have disclosed the real names of the schools from which the data was gathered. Morevoer, if we take into account that the dataset is, by no means, statistically significant. That could lead to all sorts of mistakes and misunderstandings that should have been avoided. ","9c4a25fe":"Since we have a second dataset, the \"language\" dataset, it would be very nice to check if the grades of both datasets are correlated, and if not, if the conclusions are different. A difficult problem is how to relate the students from both datasets, what it is called \"identity matching\" problem. Fortunately, the authors of the dataset have provided a solution to this problem (in the form of an R script).","4259fbce":"### Internet","0f8e5fe7":"For the analysis of non-binary categorical variables we will use a simmilar technique.","7e05a77f":"Two good candidates as predictive features are if the student plans to study higher education and if the student has extra educational support. In the former case, probably, because students that want to continue studies make an extra effor to get better grades; and in the latter case because it seems that bad students require additional study support.","4bfd513c":"It is highly convenient to add the average grade to the dataframe.","e6752e68":"We have some variables that could be interesting. Some of the variables are categorical, and other are continuous. They require a different type of analysis.","06d23065":"### Multicategory variables","6bed73fc":"It seems that alcohol consumption is not strongly related to school performance.","050383f3":"All the three variables have low predictive power to the final grade, and so, we will not use them in the final model.","0e29ea48":"And a more advanced testing uses a cross validation approach.","b642ad1e":"### Conclusions","948e9f58":"Fit a single model","09658ccf":"Let's see why people have chosen one school or the ohter.","2717dd36":"Let's see what the dataset looks like.","ec7b5de8":"The previous model was tested on the same training sample. A more realistic testing requires to use a separate training\/testing subsets.","8815e83a":"### Alcohol Consumption","56fd1a98":"### Future work","89cad11b":"Let's see how the tree looks like","3d9cb982":"Now we can say we are confident about the reported accuracy. Unfortunately, the model has low predictive power.","ec76a4f4":"Let's see, for example, if having Internet at home makes any difference in grades.","ac549e6f":"Since we have data from two different schools, let's see if there are any differences in grades by school","dd34fa49":"### Predictive Models","e20cfc01":"In this notebook we are going to see how to perform an exploratory data analysis, a step that should be performed over every new dataset before to proceed with the development of predictive models. In this case, our goal is to understand what are the factors that affect the performance of students at high school. In particular, we are interested to know the impact of the consumption of alcohol.","1966427a":"We still have some predictive capabilities.","3f8d7915":"The same work we have done with the \"internet\" variable can be done with the rest of the categorical variables"}}