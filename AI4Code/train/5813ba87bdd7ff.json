{"cell_type":{"1b36b8d4":"code","f06c42b1":"code","a0aff4be":"code","ebebb0c6":"code","86461004":"code","d31adcc5":"code","387dd697":"code","bba887de":"code","7ec35b0b":"code","5879abf9":"code","3e2b0318":"code","c328560f":"code","cd52e9ee":"code","2d65b50c":"code","ba714ef5":"code","3bb6ca7c":"code","94878915":"code","e6460250":"code","c8d58c27":"code","9887c138":"code","7d8bb75f":"code","fb8b1ccf":"code","20330492":"code","55934cde":"code","f51eb60e":"code","673f9306":"code","4e8100a5":"code","aafdb79c":"code","b3112bd5":"code","dae853b3":"code","ab169043":"code","89371803":"code","a4a9ce61":"code","1911a9e6":"code","1e05f08a":"code","240352e6":"code","f76cefa9":"code","6065f623":"code","dff3b4bc":"code","6e4d6604":"code","0acb99d4":"code","87f032dd":"code","487dd7b1":"code","f189cb9c":"code","e7abf63f":"code","92a55c5e":"code","d5b559c2":"code","1b8e4547":"code","19f9699b":"code","bfc07fb0":"code","854690fd":"markdown","ed0f25dc":"markdown","9ba27d95":"markdown","7348b444":"markdown","a2d7639b":"markdown","dc08ec76":"markdown","0b9a24fb":"markdown","67ebc008":"markdown","b5241b87":"markdown","bcff87c2":"markdown","ece3716c":"markdown","62009a87":"markdown","e85f93ab":"markdown","2b82ff64":"markdown","1e1fe538":"markdown","de9035cb":"markdown","6d6f685d":"markdown","eeabc4e8":"markdown","d73782e6":"markdown","3765ccab":"markdown","2d9579a2":"markdown"},"source":{"1b36b8d4":"import pandas as pd\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport seaborn as sns\npd.set_option('display.max_columns', None)","f06c42b1":"health =pd.read_csv('\/kaggle\/input\/fetal-health-classification\/fetal_health.csv')\nhealth.head()","a0aff4be":"health.info()","ebebb0c6":"health.describe()","86461004":"healthd=health.copy()\nhealthd.drop_duplicates(inplace=True)\nhealthd.shape","d31adcc5":"health.shape","387dd697":"health=healthd\ndel healthd\nhealth.head()","bba887de":"health.shape","7ec35b0b":"import pandas_profiling as pp \nprofile = pp.ProfileReport(health) \nprofile.to_file(\"EDA.html\")","5879abf9":"X=health.drop('fetal_health',axis=1)\ny=health['fetal_health']","3e2b0318":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X,y, train_size = 0.70,stratify=y,shuffle=True, random_state = 42)","c328560f":"X_train.info()","cd52e9ee":"from sklearn.ensemble import BaggingClassifier\nfrom sklearn import tree\nmodel = BaggingClassifier(tree.DecisionTreeClassifier(random_state=42))","2d65b50c":"model.fit(X_train,y_train)","ba714ef5":"import sklearn.metrics\nscore_cbc=model.score(X_test,y_test)\nprint('Score :',score_cbc)","3bb6ca7c":"sklearn.metrics.confusion_matrix(y_test,model.predict(X_test))","94878915":"roc_auc_score_cbc=sklearn.metrics.roc_auc_score(y_test,model.predict_proba(X_test),multi_class='ovr')\nprint('Compute Area Under the Receiver Operating Characteristic Curve',roc_auc_score_cbc)","e6460250":"cohen_kappa_score_cbc=sklearn.metrics.cohen_kappa_score(model.predict(X_test),y_test)\nprint('Cohen\u2019s kappa :',cohen_kappa_score_cbc)","c8d58c27":"sklearn.metrics.f1_score(y_test,model.predict(X_test),average='macro')","9887c138":"sklearn.metrics.f1_score(y_test,model.predict(X_test),average='micro')","7d8bb75f":"sklearn.metrics.f1_score(y_test,model.predict(X_test),average='weighted')","fb8b1ccf":"sklearn.metrics.f1_score(y_test,model.predict(X_test),average=None)","20330492":"sklearn.metrics.fbeta_score(y_test,model.predict(X_test),average='macro',beta=0.5)","55934cde":"sklearn.metrics.fbeta_score(y_test,model.predict(X_test),average='micro',beta=0.5)","f51eb60e":"sklearn.metrics.fbeta_score(y_test,model.predict(X_test),average='weighted',beta=0.5)","673f9306":"sklearn.metrics.fbeta_score(y_test,model.predict(X_test),average=None,beta=0.5)","4e8100a5":"sklearn.metrics.hamming_loss(y_test,model.predict(X_test))","aafdb79c":"sklearn.metrics.hinge_loss(y_test,model.predict_proba(X_test))","b3112bd5":"sklearn.metrics.jaccard_score(y_test,model.predict(X_test),average='macro')","dae853b3":"sklearn.metrics.jaccard_score(y_test,model.predict(X_test),average='micro')","ab169043":"sklearn.metrics.jaccard_score(y_test,model.predict(X_test),average='weighted')","89371803":"sklearn.metrics.jaccard_score(y_test,model.predict(X_test),average=None)","a4a9ce61":"sklearn.metrics.log_loss(y_test,model.predict_proba(X_test))","1911a9e6":"sklearn.metrics.multilabel_confusion_matrix(y_test,model.predict(X_test))","1e05f08a":"sklearn.metrics.matthews_corrcoef(y_test,model.predict(X_test))","240352e6":"sklearn.metrics.precision_recall_fscore_support(y_test,model.predict(X_test))","f76cefa9":"sklearn.metrics.precision_score(y_test,model.predict(X_test),average='macro')","6065f623":"sklearn.metrics.precision_score(y_test,model.predict(X_test),average='micro')","dff3b4bc":"sklearn.metrics.precision_score(y_test,model.predict(X_test),average='weighted')","6e4d6604":"sklearn.metrics.precision_score(y_test,model.predict(X_test),average=None)","0acb99d4":"sklearn.metrics.recall_score(y_test,model.predict(X_test),average='macro')","87f032dd":"sklearn.metrics.recall_score(y_test,model.predict(X_test),average='micro')","487dd7b1":"sklearn.metrics.recall_score(y_test,model.predict(X_test),average='weighted')","f189cb9c":"sklearn.metrics.recall_score(y_test,model.predict(X_test),average=None)","e7abf63f":"sklearn.metrics.zero_one_loss(y_test,model.predict(X_test))","92a55c5e":"print(sklearn.metrics.classification_report(y_test,model.predict(X_test)))","d5b559c2":"# predict result\nX_test['Predicted fetal_health']= model.predict(X_test)\nX_test.head()\n","1b8e4547":"plt.figure(figsize = (10,5))\nax= sns.countplot(X_test['Predicted fetal_health'])\nfor p in ax.patches:\n    ax.annotate(str(p.get_height()), (p.get_x() * 1.01 , p.get_height() * 1.01))\nplt.xticks(rotation = 45)\nax.set_yscale('log')\nplt.show()","19f9699b":"plt.figure(figsize = (10,5))\nax= sns.countplot(y_test)\nfor p in ax.patches:\n    ax.annotate(str(p.get_height()), (p.get_x() * 1.01 , p.get_height() * 1.01))\nplt.xticks(rotation = 45)\nax.set_yscale('log')\nplt.show()","bfc07fb0":"X_test['Predicted fetal_health'].value_counts(),y_test.value_counts()","854690fd":"# ROC AUC Score","ed0f25dc":"# Confusion Matrix","9ba27d95":"# Score","7348b444":"# Log Loss","a2d7639b":"# Classification Report","dc08ec76":"# Recall Score","0b9a24fb":"Duplicate Found!!","67ebc008":"# Precision Score","b5241b87":"# F Score Beta","bcff87c2":"# F1 Score","ece3716c":"# Multi-Label Confusion Matrix","62009a87":"# Visualize the results ","e85f93ab":"# Hamming Loss","2b82ff64":"# EDA ","1e1fe538":"# Hinge Loss","de9035cb":"# Precision, Recall, FScore & Support","6d6f685d":"# Jaccard Score","eeabc4e8":"# Zero-One Loss","d73782e6":"# Duplicate Check","3765ccab":"# Cohen Kappa Score","2d9579a2":"# Matthews Corrcoef"}}