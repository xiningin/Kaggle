{"cell_type":{"1baf6c3c":"code","c400838e":"code","5cea19b9":"code","7c3b24b9":"code","4fa34286":"code","7c2eb48f":"code","1fa1500b":"code","b5990bd4":"markdown","afc70c7e":"markdown"},"source":{"1baf6c3c":"%matplotlib inline\nfrom IPython.core.interactiveshell import InteractiveShell\nInteractiveShell.ast_node_interactivity = \"all\"\nimport ast\nimport os\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport numpy as np\nfrom tqdm import tqdm","c400838e":"def f2cat(filename: str) -> str:\n    return filename.split('.')[0]\n\nclass Simplified():\n    def __init__(self, input_path='.\/input'):\n        self.input_path = input_path\n\n    def list_all_categories(self):\n        files = os.listdir(os.path.join(self.input_path, 'train_simplified'))\n        return [f2cat(f) for f in files]\n\n    def read_training_csv(self, category, nrows=None, usecols=None, drawing_transform=False):\n        df = pd.read_csv(os.path.join(self.input_path, 'train_simplified', category + '.csv'),\n                         nrows=nrows, parse_dates=['timestamp'], usecols=usecols)\n        if drawing_transform:\n            df['drawing'] = df['drawing'].apply(ast.literal_eval)\n        return df","5cea19b9":"s = Simplified('..\/input\/')\ncategories = s.list_all_categories()\nlen(categories)","7c3b24b9":"df = s.read_training_csv('owl', nrows=100, drawing_transform=True)\ndf.head()\ndf.shape","4fa34286":"n = 10\nfig, axs = plt.subplots(nrows=n, ncols=n, sharex=True, sharey=True, figsize=(16, 10))\nfor i, row in df[: n * n].iterrows():\n    ax = axs[i \/\/ n, i % n]\n    for x, y in row.drawing:\n        color = 'green' if row.recognized else 'red'\n        ax.plot(x, -np.array(y), lw=3, color=color)\n    ax.axis('off')\nplt.suptitle('Recognized and unrecognized owls')\nplt.show();","7c2eb48f":"def plot_category_samples(df, category, n=10):\n    fig, axs = plt.subplots(nrows=n, ncols=n, sharex=True, sharey=True, figsize=(16, 10))\n    for i, row in df[: n * n].iterrows():\n        ax = axs[i \/\/ n, i % n]\n        for x, y in row.drawing:\n            color = 'green' if row.recognized else 'red'\n            ax.plot(x, -np.array(y), lw=3, color=color)\n        ax.axis('off')\n    plt.suptitle(category)\n    fig.savefig('{}.png'.format(category), dpi=100)\n    plt.close('all')\n    plt.gcf()","1fa1500b":"animals = [\n    'ant', 'bat', 'bear', 'bee', 'bird', 'butterfly', 'camel', 'cat', 'cow', 'crab', 'crocodile', 'dog',\n    'dolphin', 'dragon', 'duck', 'elephant', 'fish', 'flamingo', 'frog', 'giraffe', 'hedgehog', 'horse',\n    'kangaroo', 'lion', 'lobster', 'monkey', 'mosquito', 'mouse', 'octopus', 'owl', 'panda', 'parrot', 'penguin',\n    'pig', 'rabbit', 'raccoon', 'rhinoceros', 'scorpion', 'sea turtle', 'shark', 'sheep', 'snail', 'snake',\n    'spider', 'squirrel', 'swan', 'teddy-bear', 'tiger', 'whale', 'zebra'\n]\nfor animal in tqdm(animals):\n    df = s.read_training_csv(animal, nrows=100, drawing_transform=True)\n    plot_category_samples(df, animal, n=10)","b5990bd4":"## Let's check the first 100 owls","afc70c7e":"## Please check other animal examples on the Output page"}}