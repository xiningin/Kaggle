{"cell_type":{"b2f12249":"code","92c00453":"code","73d62a94":"code","0386644f":"code","7527435a":"code","1a557e33":"code","3bf39b8a":"code","56c39a69":"code","dc803423":"code","a813344b":"code","102f3523":"code","0e3015ed":"code","773b019c":"markdown","793881b4":"markdown","89bc8d12":"markdown","86425de2":"markdown","93a5344f":"markdown"},"source":{"b2f12249":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\n\ndf=pd.read_table('..\/input\/fruit_data_with_colors.txt')","92c00453":"\nplt.figure(figsize=(15,7))\nsns.barplot('fruit_subtype','fruit_label',data=df)\nplt.show()","73d62a94":"fruit_type={'turkey_navel' : 3 ,'unknown' : 4, 'cripps_pink' : 1\n            ,'selected_seconds' : 3, 'spanish_belsan' : 4, 'golden_delicious' : 1,\n            'braeburn' : 1, 'mandarin' : 2, 'spanish_jumbo' : 3,'granny_smith' : 1}\n\ndf['fruit_subtype']=df['fruit_subtype'].map(fruit_type)\n","0386644f":"df['height'].groupby(df['fruit_label']).mean()","7527435a":"df['width'].groupby(df['fruit_label']).mean()","1a557e33":"df['mass'].groupby(df['fruit_label']).mean()","3bf39b8a":"df['color_score'].groupby(df['fruit_label']).mean()","56c39a69":"from sklearn.model_selection import train_test_split\ncols=['fruit_subtype', 'mass', 'width', 'height','color_score']\nX=df[cols]\n\ny=df['fruit_label']\nX_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.2,random_state=0)\n","dc803423":"from sklearn.neighbors import KNeighborsClassifier\n\nneighbours=np.arange(1,9)\ntrain_accuracy=np.empty(len(neighbours))\ntest_accuracy=np.empty(len(neighbours))\n\n","a813344b":"for i in range(len(neighbours)):\n    knn=KNeighborsClassifier(n_neighbors=i+1)\n    knn.fit(X_train,y_train)\n    train_accuracy[i]=knn.score(X_train,y_train)\n    test_accuracy[i]=knn.score(X_test,y_test)\n","102f3523":"plt.title('k-NN Varying number of neighbors')\nplt.plot(neighbours, test_accuracy, label='Testing Accuracy')\nplt.plot(neighbours, train_accuracy, label='Training accuracy')\nplt.legend()\nplt.xlabel('Number of neighbors')\nplt.ylabel('Accuracy')\nplt.show()","0e3015ed":"\nknn = KNeighborsClassifier(n_neighbors=6)\nknn.fit(X_train,y_train)\nknn.score(X_test,y_test)","773b019c":"Fun Part Begins!...let's find which is the most appropriate value of our K,\n\nI have taken a range from 1-9 so let's see for which value of K we get highest score!","793881b4":"So by looking at the above graph, we can say that value of K can either be 6 or 4,let's take 6!","89bc8d12":"First of we need to remove all the string values from the data and for that we need to find the relation between fruit_subtype and fruit_label.\n\nFor that what I have done is made a bar plot having 'fruit_subtype' on X- Axis and 'fruit_label' on Y -Axis.","86425de2":"Can we make a new column by observing fruit's height?...well I think answer is no..\n\nWhat i did was grouping all the heights of fruits by the fruit_label and the results were almost similar,same  was the approach with width,mass and colour_score but it failed!...","93a5344f":"Looking at the above bar chart, we need to categorize our fruit_subtype into their respective sub_categories \n\nLike  : granny_smith,braeburn,golden_delicious,cripps_pink are some fruit_subtypes which fall in fruit_label 1 ,therefore we need to map the fruit_types to their subcategories."}}