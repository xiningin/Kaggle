{"cell_type":{"87974ada":"code","5c4ac24e":"code","89900168":"code","3a17f68d":"code","4b28485b":"code","1510d595":"markdown"},"source":{"87974ada":"import pandas as pd\nimport numpy as np\nfrom time import time\n\nfrom sklearn.model_selection import cross_val_score, RepeatedStratifiedKFold\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn import linear_model\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.ensemble import AdaBoostClassifier, GradientBoostingClassifier, RandomForestClassifier\nfrom xgboost import XGBClassifier\nfrom lightgbm import LGBMClassifier\nfrom catboost import CatBoostClassifier","5c4ac24e":"data = pd.read_csv('\/kaggle\/input\/college-data\/data.csv')\ndata.head()\n\nX = data.drop('private', axis=1)\ny = data.private\n\nencoder = LabelEncoder()\ny = encoder.fit_transform(y)\nmodel_accuracies_and_speed = {}","89900168":"models_under_test = {\n    \"XGB          \" : XGBClassifier(use_label_encoder=False, eval_metric='logloss', random_state=42),\n    \"LGBM         \" : LGBMClassifier(silent=True, random_state=42),\n    \"CatBoost     \" : CatBoostClassifier(verbose=False, random_state=42),\n    \"RandomForest \" : RandomForestClassifier(random_state=42),\n    \"AdaBoost     \" : AdaBoostClassifier(random_state=42),\n    \"sk-GBM       \" : GradientBoostingClassifier(random_state=42),\n    \"KNN          \" : KNeighborsClassifier(),\n    \"SDG          \" : linear_model.SGDClassifier(random_state=42)\n}","3a17f68d":"def print_and_get_accuracy(name, model, data, labels, model_accuracies_and_speed):\n    cv = RepeatedStratifiedKFold(n_splits=5, n_repeats=5, random_state=42)\n    if (refresh) or (name not in model_accuracies_and_speed):\n        start = time()\n        accuracies = cross_val_score(model, data, labels, cv=cv, scoring='accuracy')\n        speed = np.round(time() - start, 2)\n    else:\n        accuracies = model_accuracies_and_speed[name][0]\n        speed = model_accuracies_and_speed[name][1]\n        \n    print(f\"{name} : Score {np.round(accuracies.mean()*100,2)}, Speed {speed}s\")\n    \n    return (accuracies, speed)","4b28485b":"refresh = False\nfor name, model in models_under_test.items():\n    model_accuracies_and_speed[name] = print_and_get_accuracy(name, model, X, y, model_accuracies_and_speed)","1510d595":"### `CatBoost` vs `Light GBM` vs `XGBoost` vs `RandomForest` vs `AdaBoost` vs ..."}}