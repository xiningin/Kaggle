{"cell_type":{"0ee7d9ce":"code","0bbeaad4":"code","889049de":"code","e7a9ebb3":"code","9736cef1":"code","8fd45920":"code","92f6a745":"code","5159cd57":"code","d126fe5c":"code","bb421619":"code","b0d254ea":"code","994c4f9c":"code","1ad033c5":"code","f0508eee":"code","dc671069":"code","6824d167":"code","a10562af":"code","70a2a9c0":"code","1209823e":"code","712803a5":"code","3ddbe28d":"code","b9fd7d01":"code","bbf43567":"code","0103759b":"code","ec3c0c41":"code","9d308c2d":"code","6ae07cb7":"code","c894d74a":"code","cd36e82c":"code","f8940aee":"code","117e9066":"code","b1c51f51":"code","1ca5b5d7":"code","d5c6c96b":"code","5ebc62d6":"code","591ed8f7":"code","46f44673":"code","8412d6b1":"code","69312df7":"code","a77fac90":"code","08880c2d":"code","f4b154ea":"code","9d14e850":"code","57aad861":"markdown","6160cc13":"markdown","7adbe6dd":"markdown","27eb94b2":"markdown","36037e61":"markdown","727d9243":"markdown","24b8a42a":"markdown","d8b37e74":"markdown","e115232e":"markdown","3749802b":"markdown","07d7f230":"markdown","c8697e0b":"markdown","293468e1":"markdown","7505a151":"markdown","1df38a65":"markdown","4f092435":"markdown"},"source":{"0ee7d9ce":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\n# for dirname, _, filenames in os.walk('\/kaggle\/input'):\n#     for filename in filenames:\n#         print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","0bbeaad4":"!pip install seaborn --upgrade\n%matplotlib inline \nimport matplotlib.pyplot as plt\nimport seaborn as sns","889049de":"df = pd.read_csv('..\/input\/sex-differences-in-moral-judgements-67-countries\/ALL_MFQ30.csv')","e7a9ebb3":"df.head()","9736cef1":"df.Sex.unique()","8fd45920":"df.Sex[df.Sex == '0'].count()","92f6a745":"df.Sex[df.Sex == '1'].count()","5159cd57":"df.Sex[df.Sex == '.'].count()","d126fe5c":"len(df)","bb421619":"df.dropna().count()","b0d254ea":"df.count()","994c4f9c":"df = df.dropna()","1ad033c5":"df.PURITY_AVG.min()","f0508eee":"len(df[(df.HARM_AVG == 0) & (df.AUTHORITY_AVG == 0) & (df.FAIRNESS_AVG == 0) & (df.PURITY_AVG == 0) & (df.INGROUP_AVG == 0)])","dc671069":"sex_map = {\"0\" : \"female\", \"1\": \"male\", \".\": 2}","6824d167":"df[\"Sex\"] = df[\"Sex\"].map(sex_map)\ndf = df[df['Sex'] != 2]","a10562af":"df['Sex'].unique()","70a2a9c0":"df.head()","1209823e":"df[\"Country\"].unique()","712803a5":"df.corr()","3ddbe28d":"plt.rcParams.update({'figure.max_open_warning': 0})\nsns.pairplot(df, hue=\"Sex\");","b9fd7d01":"df[\"Country\"].describe()","bbf43567":"df['Country'].unique()","0103759b":"def print_distributions(df):\n    for i, moral in enumerate([\"PURITY_AVG\", \"INGROUP_AVG\", \"HARM_AVG\", \"FAIRNESS_AVG\", \"AUTHORITY_AVG\"]):\n        \n        sns.displot(df, x=moral, hue=\"Country\", kind='kde');\n        \n        for i, country in enumerate(df.Country.unique()):\n            g = sns.FacetGrid(df[df.Country == country], row='Country', col=\"Sex\");\n            g.fig.set_size_inches(5,2.5);\n            g.map(sns.kdeplot, moral);\n","ec3c0c41":"plt.rcParams.update({'figure.max_open_warning': 0})\nprint_distributions(df)","9d308c2d":"df.head()","6ae07cb7":"def get_moral_sex(df, moral, sex):\n    return df[df['Sex'] == sex][moral].groupby(df[df['Sex'] == sex].Country).mean()\n\ndef get_moral_sex_df(df):\n\n    males_purity = get_moral_sex(df, \"PURITY_AVG\", \"male\")\n    females_purity = get_moral_sex(df, \"PURITY_AVG\", \"female\")\n\n    males_fairness = get_moral_sex(df, \"FAIRNESS_AVG\", \"male\")\n    females_fairness = get_moral_sex(df, \"FAIRNESS_AVG\", \"female\")\n\n    males_ingroup = get_moral_sex(df, \"INGROUP_AVG\", \"male\")\n    females_ingroup = get_moral_sex(df, \"INGROUP_AVG\", \"female\")\n\n    males_harm = get_moral_sex(df, \"HARM_AVG\", \"male\")\n    females_harm = get_moral_sex(df, \"HARM_AVG\", \"female\")\n\n    males_auth = get_moral_sex(df, \"AUTHORITY_AVG\", \"male\")\n    females_auth = get_moral_sex(df, \"AUTHORITY_AVG\", \"female\")\n    \n    return pd.DataFrame({\n        \"males_purity\": males_purity, \"females_purity\": females_purity,\n        \"males_fairness\": males_fairness, \"females_fairness\": females_fairness,\n        \"males_harm\": males_harm, \"females_harm\": females_harm,\n        \"males_ingroup\": males_ingroup, \"females_ingroup\": females_ingroup,\n        \"males_autority\": males_auth, \"females_authority\": females_auth\n        })","c894d74a":"moral_heat = get_moral_sex_df(df)\nmoral_heat.head()","cd36e82c":"f, ax = plt.subplots(figsize=(16, 12))\nsns.set(font_scale=3)\nsns.heatmap(moral_heat, cmap=\"viridis\");","f8940aee":"sns.set(font_scale=1.2)\nsns.clustermap(moral_heat, cmap=\"viridis\");","117e9066":"df.head()","b1c51f51":"pc_df = df.groupby(df.Country).mean()\npc_df['Country'] = pc_df.index\npc_df","1ca5b5d7":"f, ax = plt.subplots(figsize=(16, 14))\npd.plotting.parallel_coordinates(pc_df, 'Country', \n                                 cols=[\"FAIRNESS_AVG\", \"HARM_AVG\", \"PURITY_AVG\", \"AUTHORITY_AVG\",\"INGROUP_AVG\"])\nax.legend(loc=\"lower left\");","d5c6c96b":"from sklearn.cluster import KMeans\nfrom sklearn.model_selection import train_test_split\nimport numpy as np\n\ntrain  = df.drop(columns=[\"Sex\", \"Country\"])\n","5ebc62d6":"kmeans = KMeans(n_clusters=2, random_state=0).fit(train)","591ed8f7":"len(kmeans.labels_)","46f44673":"df_clustrd = df","8412d6b1":"df_clustrd[\"Cluster\"] = kmeans.labels_\ndf_clustrd.head()","69312df7":"clusters = df_clustrd.groupby('Country').Cluster.mean().round()\ncl_map = {0: \"a\", 1:\"b\"}\nclusters_mapped = clusters.map(cl_map)\nclusters_mapped","a77fac90":"print(\"Countries with morality a: \\n\",clusters_mapped[clusters_mapped == 'a'])","08880c2d":"print(\"Countries with morality b: \\n\",clusters_mapped[clusters_mapped == 'b'])","f4b154ea":"cluster_cont = df_clustrd.groupby('Country').Cluster.mean()\nresult = pd.DataFrame({\"country\": cluster_cont.index, \"mean_moral\":cluster_cont})\nresult = result.sort_values(by=['mean_moral'])\nresult","9d14e850":"f, ax = plt.subplots(figsize=(26, 12))\nsns.barplot(x='country', y='mean_moral',data=result, palette=\"viridis\");","57aad861":"This represents countries morality along a continuum from prevalence of morality a to b (not which countries are \"more moral\")","6160cc13":"## Cleaning","7adbe6dd":"## Detailed Distributions:\n\n - Click [here](#heat) to skip past lots of distributions ","27eb94b2":"## Clustering\n\nVisual analyses suggests two types of morality varying by country. Lets see which countries fall into which morality clusters\n","36037e61":"Assigning countries to clusters","727d9243":"### Discrete cluster assignement","24b8a42a":"Some apperent associations between harm and fairness\nas well as between ingroup, authority and purity","d8b37e74":"We also dont loose a ton of samples if we just dropna","e115232e":"Lets fix the sex column with a mapping","3749802b":"## Associations and distributions","07d7f230":"## Heatmap Patterns:","c8697e0b":"Just by eyballing the distributions it seems like there is notable differences between country and sex","293468e1":"### Assigning continuous values based on mean of cluster class","7505a151":"<a id='heat'><\/a>","1df38a65":"\nWhat I notice at first glance:\n\n - France and Spain are the least concerned with purity.\n\n - Wherease Serbia, Mongolia, Russia, Iran, Poland, Korea and Japan are more pure.\n\n - For most European countries, US and Austrialia, Fairness and harm are the most important values\n\n - Women everywhere tend to have higher average for harm and fairness.\n\n - Russian men seem to have lowest harm.\n\nLMK if you find any other patterns. ","4f092435":"<a id=\"heat\"><\/a>"}}