{"cell_type":{"3aa335ae":"code","3944fbc4":"code","3a8b7f30":"code","aadada61":"code","686d40cb":"code","2ce53bf6":"code","b16b56cf":"code","8d41bd36":"code","043e6a8c":"code","a17a2771":"code","92ce52a4":"code","4d6aa1d5":"code","e59b9abf":"code","8d67d8cf":"code","78273a00":"code","d360cfc1":"code","e2d5fd3d":"code","0e2e9a89":"code","34f87507":"code","def76af9":"code","2b6d57df":"code","41f3eb2d":"code","d8df3412":"code","4c189f07":"code","bec9a51a":"code","4590a98b":"code","bb8d858f":"code","befe0ecc":"code","bb199129":"code","1ec4748c":"markdown"},"source":{"3aa335ae":"#importing Libraries\nimport pandas as pd\nimport pickle","3944fbc4":"#Loading Dataset\ndf = pd.read_csv('..\/input\/ipl-dataset\/IPLData.csv')","3a8b7f30":"df.head()","aadada61":"#Data Cleaning\n\n#Removing Unwanted Columns\nRemovingColumns = ['mid', 'batsman', 'bowler', 'striker', 'non-striker']\ndf.drop(labels = RemovingColumns, axis = 1, inplace = True)","686d40cb":"df.head()","2ce53bf6":"df['bat_team'].unique()","b16b56cf":"df['venue'].nunique()","8d41bd36":"df['venue'].unique()","043e6a8c":"#Keeping only Popular Teams\nPopular_Teams = ['Kolkata Knight Riders','Chennai Super Kings', 'Rajasthan Royals','Mumbai Indians', 'Kings XI Punjab','Royal Challengers Bangalore', 'Delhi Daredevils','Sunrisers Hyderabad']\ndf = df[(df['bat_team'].isin(Popular_Teams)) & (df['bowl_team'].isin(Popular_Teams))]\ndf.head()","a17a2771":"#Removing First 6 Overs from the game as it is powerplay, we will use it to predict\ndf = df[df['overs']>=6.0]","92ce52a4":"df.dtypes","4d6aa1d5":"#Converting the column date into datetime object\nfrom datetime import datetime\ndf['date'] = df['date'].apply(lambda x: datetime.strptime(x, '%Y-%m-%d'))","e59b9abf":"df.head()","8d67d8cf":"df.isna().sum()","78273a00":"#Data PreProcessing\n#Coverting Categorial features using One Hot Encoding\nencoded_df = pd.get_dummies(data=df, columns=['venue','bat_team','bowl_team'])","d360cfc1":"encoded_df.head()","e2d5fd3d":"encoded_df.columns","0e2e9a89":"encoded_df = encoded_df[['date', 'runs', 'wickets', 'overs', 'runs_last_5', 'wickets_last_5',\n                         'venue_Barabati Stadium', 'venue_Brabourne Stadium','venue_Buffalo Park',\n                         'venue_De Beers Diamond Oval','venue_Dr DY Patil Sports Academy',\n                         'venue_Dr. Y.S. Rajasekhara Reddy ACA-VDCA Cricket Stadium',\n                         'venue_Dubai International Cricket Stadium', 'venue_Eden Gardens',\n                         'venue_Feroz Shah Kotla','venue_Himachal Pradesh Cricket Association Stadium',\n                         'venue_Holkar Cricket Stadium','venue_JSCA International Stadium Complex', 'venue_Kingsmead',\n                         'venue_M Chinnaswamy Stadium', 'venue_MA Chidambaram Stadium, Chepauk',\n                         'venue_Maharashtra Cricket Association Stadium','venue_New Wanderers Stadium', 'venue_Newlands',\n                         'venue_OUTsurance Oval','venue_Punjab Cricket Association IS Bindra Stadium, Mohali',\n                         'venue_Punjab Cricket Association Stadium, Mohali','venue_Rajiv Gandhi International Stadium, Uppal',\n                         'venue_Sardar Patel Stadium, Motera', 'venue_Sawai Mansingh Stadium',\n                         'venue_Shaheed Veer Narayan Singh International Stadium','venue_Sharjah Cricket Stadium',\n                         'venue_Sheikh Zayed Stadium',\"venue_St George's Park\", 'venue_Subrata Roy Sahara Stadium',\n                         'venue_SuperSport Park', 'venue_Wankhede Stadium','bat_team_Chennai Super Kings',\n                         'bat_team_Delhi Daredevils','bat_team_Kings XI Punjab', 'bat_team_Kolkata Knight Riders',\n                         'bat_team_Mumbai Indians', 'bat_team_Rajasthan Royals', 'bat_team_Royal Challengers Bangalore',\n                         'bat_team_Sunrisers Hyderabad','bowl_team_Chennai Super Kings', 'bowl_team_Delhi Daredevils',\n                         'bowl_team_Kings XI Punjab', 'bowl_team_Kolkata Knight Riders', 'bowl_team_Mumbai Indians',\n                         'bowl_team_Rajasthan Royals','bowl_team_Royal Challengers Bangalore',\n                         'bowl_team_Sunrisers Hyderabad', 'total']]","34f87507":"encoded_df['date'].unique()","def76af9":"# Splitting the data into train and test set\nX_train = encoded_df.drop(labels='total', axis=1)[encoded_df['date'].dt.year <= 2016]\nX_test = encoded_df.drop(labels='total', axis=1)[encoded_df['date'].dt.year >= 2017]","2b6d57df":"y_train = encoded_df[encoded_df['date'].dt.year <= 2016]['total'].values\ny_test = encoded_df[encoded_df['date'].dt.year >= 2017]['total'].values","41f3eb2d":"# Removing the 'date' column\nX_train.drop(labels='date', axis=True, inplace=True)\nX_test.drop(labels='date', axis=True, inplace=True)","d8df3412":"## Ridge Regression\nfrom sklearn.linear_model import Ridge\nfrom sklearn.model_selection import GridSearchCV","4c189f07":"ridge=Ridge()\nparameters={'alpha':[1e-15,1e-10,1e-8,1e-3,1e-2,1,5,10,20,30,35,40]}\nridge_regressor=GridSearchCV(ridge,parameters,scoring='neg_mean_squared_error',cv=5)\nridge_regressor.fit(X_train,y_train)","bec9a51a":"print(ridge_regressor.best_params_)\nprint(ridge_regressor.best_score_)","4590a98b":"prediction=ridge_regressor.predict(X_test)","bb8d858f":"import seaborn as sns\nsns.distplot(y_test-prediction)","befe0ecc":"from sklearn import metrics\nimport numpy as np\nprint('MAE:', metrics.mean_absolute_error(y_test, prediction))\nprint('MSE:', metrics.mean_squared_error(y_test, prediction))\nprint('RMSE:', np.sqrt(metrics.mean_squared_error(y_test, prediction)))","bb199129":"# Creating a pickle file for the classifier\nfilename = 'IPLModel.pkl'\npickle.dump(ridge_regressor, open(filename, 'wb'))","1ec4748c":"## IPL Score Prediction"}}