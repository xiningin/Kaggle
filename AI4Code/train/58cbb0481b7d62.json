{"cell_type":{"baf0dd8c":"code","1300cdae":"code","8fdc8880":"code","4ac01c2e":"code","61863702":"code","73b7769f":"code","61419570":"code","61f2ae6d":"code","bad3f1eb":"code","570e8290":"code","7e2d9dfe":"code","ff18a21c":"code","0880b4e0":"code","aceb1880":"code","c6b56ae5":"code","0d0afc57":"code","63c36ecf":"code","9d471755":"code","0499b9e1":"code","3d7c9034":"code","c597f1bc":"code","a2663785":"code","df75b830":"code","24ec5100":"code","bb197daf":"code","9afcb8d6":"code","af30d979":"code","2df0b405":"code","267e23cf":"code","78377dbc":"code","00176f74":"code","15b4cf8f":"code","11798515":"code","cf56e469":"code","3b6a15ab":"markdown","f0964e17":"markdown","38838534":"markdown","3cb14a35":"markdown","8c486d28":"markdown","9947d93d":"markdown","8d2e8fd0":"markdown","f780ecae":"markdown","fd5e655f":"markdown","3d9a08e6":"markdown","ad103da9":"markdown","70cf768a":"markdown","8ebcb692":"markdown","36a714ef":"markdown","d7127e7a":"markdown","65cddaa1":"markdown","9e6cbf27":"markdown"},"source":{"baf0dd8c":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns","1300cdae":"d2 = pd.read_csv('..\/input\/real-estate-price-prediction\/Real estate.csv')\nd2.head(10)","8fdc8880":"d2.shape","4ac01c2e":"d2.info()","61863702":"tbd = ['X1 transaction date','No']\nd2 = d2.drop(tbd, axis=1)\nd2.head(3)","73b7769f":"d2.describe()","61419570":"d2.hist(figsize=(10,10))","61f2ae6d":"corr = d2.corr()\ncorr","bad3f1eb":"fig, ax = plt.subplots(figsize=(22,15))\nsns.heatmap(corr, annot=True, ax=ax)","570e8290":"# Checking for null vlaues\nd2.isnull().sum()","7e2d9dfe":"# Numerical attributes comparison using scatterplot\nsns.barplot(x=d2['X4 number of convenience stores'], y=d2['Y house price of unit area']);","ff18a21c":"sns.regplot(x=d2['X2 house age'], y=d2['Y house price of unit area']);","0880b4e0":"sns.regplot(x=d2['X3 distance to the nearest MRT station'], y=d2['Y house price of unit area']);","aceb1880":"sns.lineplot(x=d2['X2 house age'], y=d2['X3 distance to the nearest MRT station']);","c6b56ae5":"plt.figure(figsize=(13,5))\n\nfor feat, grd in zip(d2, range(231,237)):\n    plt.subplot(grd)\n    sns.boxplot(y=d2[feat], color='grey')\n    plt.ylabel('Value')\n    plt.title('Boxplot\\n%s'%feat)\nplt.tight_layout()","0d0afc57":"X2 = d2.loc[:,'X2 house age' : 'X6 longitude']\ny2 = d2.loc[:,'Y house price of unit area']","63c36ecf":"#Train-test split\nfrom sklearn.model_selection import train_test_split\n\nX_train_2, X_test_2, y_train_2, y_test_2 = train_test_split(X2, y2, test_size=0.2, random_state=1)\nprint(X_train_2.shape, X_test_2.shape)\nprint(y_train_2.shape, y_test_2.shape)","9d471755":"from statsmodels.graphics.gofplots import qqplot\n\nqqplot(X2,line='s')\nplt.show()","0499b9e1":"from scipy.stats import skew\n\nprint(skew(X2))","3d7c9034":"# Scaling Data using Min-Max Scaler\n\nfrom sklearn.preprocessing import MinMaxScaler\nmms = MinMaxScaler()\nX_train_norm_2 = mms.fit_transform(X_train_2)\nX_test_norm_2 = mms.transform(X_test_2)\n\n# Scaling Data using Standard Scaler\n\nfrom sklearn.preprocessing import StandardScaler\nscaler = StandardScaler()\nscaler.fit(X_train_2)\nX_train_std_2 = scaler.transform(X_train_2)\nX_test_std_2 = scaler.transform(X_test_2)\n\n# Comparing Scaled Data\n\nxx = np.arange(len(X_train_std_2))\nyy1 = X_train_norm_2[:,0]\nyy2 = X_train_std_2[:,0]\nplt.scatter(xx,yy1,color='b')\nplt.scatter(xx,yy2,color='r')\n\nprint(X_train_std_2.shape)\nprint(X_test_std_2.shape)","c597f1bc":"import statsmodels.api as sm\nmodel_ols = sm.OLS(y_train_2, X_train_norm_2)\nfitted = model_ols.fit()\nprint(fitted.summary())","a2663785":"from scipy.stats import shapiro\nfig, ax = plt.subplots(figsize=(16,4), ncols=2)\nax[0] = sns.scatterplot(x=y_train_2, y=fitted.resid, ax=ax[0])\nax[1] = sns.histplot(fitted.resid, ax=ax[1])\n\nstatistic, p_value = shapiro(fitted.resid)\nif p_value>0.05:\n    print(\"Distribution is normal. Statistic: {0:.3}, p-value: {1:.4}\".format(statistic, p_value))\nelse:\n    print(\"Distribution is not normal. Statistic: {0:.3}, p-value: {1:.4}\".format(statistic, p_value))","df75b830":"from sklearn.neighbors import KNeighborsRegressor as knn\nmodel4 = knn(n_neighbors=3,p=1,algorithm='brute')\nmodel4.fit(X_train_norm_2,y_train_2)","24ec5100":"ypred3 = model4.predict(X_test_norm_2)\nypred3","bb197daf":"model4.score(X_test_norm_2,y_test_2)","9afcb8d6":"k_values = np.arange(1,100,2)","af30d979":"train_score_arr = []\nval_score_arr = []\n\nfor k in k_values:\n    \n    model2 = knn(n_neighbors=k,p=1)\n    model2.fit(X_train_norm_2,y_train_2)\n    \n    train_score = model2.score(X_train_norm_2, y_train_2) \n    train_score_arr.append(train_score*100)\n    \n    val_score = model2.score(X_test_norm_2, y_test_2)\n    val_score_arr.append(val_score*100)\n    \n    print(\"k=%d, train_accuracy=%.2f%%, test_accuracy=%.2f%%\" % (k, train_score * 100, val_score*100))","2df0b405":"plt.plot(k_values,train_score_arr,'g')\nplt.plot(k_values,val_score_arr,'r')","267e23cf":"from sklearn.model_selection import cross_val_score\ncross_val_score_train = cross_val_score(model4, X_train_norm_2, y_train_2, cv=10, scoring='r2')\nprint(cross_val_score_train)","78377dbc":"cross_val_score_train.mean()","00176f74":"from sklearn.metrics import r2_score\n\nprint(r2_score(y_test_2, ypred3))","15b4cf8f":"c = pd.DataFrame(ypred3, columns=['Estimated Price'])\nc.head()","11798515":"d = pd.DataFrame(y_test_2)\nd = y_test_2.reset_index(drop=True)\nd.head()","cf56e469":"ynew = pd.concat([c,d], axis=1)\nynew","3b6a15ab":"## Splitting the data","f0964e17":"## Basic EDA","38838534":"## Statistical Analysis","3cb14a35":"As the number of convenience stores increase in the locality, House price goes up.<br>\nThis shows <b>positive<\/b> relation between these attributes.","8c486d28":"## KNN Regressor model construction","9947d93d":"## OLS regression analysis","8d2e8fd0":"The trend line shows house price reducing with increase in house age.<br>\nThese attributes show a <b>negative<\/b> relation","f780ecae":"This shows that houses with an average age of <b>15 - 20 years<\/b> have <b>high distances<\/b> to MRT station while the houses aged for <b>35+<\/b> years are <b>more closer<\/b> to the stations","fd5e655f":"Data does not appear to be following Gaussian \/ Normal Distribution. Both positively and Negatively skewed data is observed.","3d9a08e6":"Data has outliers present outside the quartile range.","ad103da9":"From the above values we can conclude that the best value for k will be between 9 to 13","70cf768a":"### Correlation Analysis\n 'X3 distance to the nearest MRT station' column shows least correlation.","8ebcb692":"# Real Estate Price Prediction Dataset Analysis","36a714ef":"Min-Max Scaler gives more uniform scaling than Standard Scaler","d7127e7a":"### Conclusion from EDA and Graph plots:\n1. Data is clean having no null values<br>\n2. Data doesn't have High correlation amongst attributes<br>\n3. Houses with more convenience stores in the area, with low age have high prices<br>\n4. Houses that are aged have more MRT stations near them and fall in low price.","65cddaa1":"## Outlier Detection","9e6cbf27":"This states that the houses that are near to MRT station have <b>higher<\/b> price"}}