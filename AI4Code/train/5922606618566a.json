{"cell_type":{"2f05b328":"code","51a24855":"code","423b68c8":"code","69a37511":"code","166ac9f0":"code","a8e10a00":"code","b586f110":"code","8172ac2a":"code","d5274d92":"code","87717b44":"code","c742e222":"code","43d4d397":"code","1fdf1ef5":"code","53563661":"code","202ba84e":"code","01ef76d1":"code","98eec17d":"code","57e25a21":"code","c6fd204a":"code","9921aae1":"code","2fe19a7d":"code","fedd93dc":"code","4f221422":"code","58463b4c":"markdown","33853533":"markdown","88e992a7":"markdown","193ff522":"markdown"},"source":{"2f05b328":"import numpy as np\nimport pandas as pd","51a24855":"data = pd.read_csv(\"..\/input\/fake-news-data\/train.csv\")\ndata.head()","423b68c8":"# checking for Null values\ndata.isnull().sum()","69a37511":"# Dropping Null values\ndata = data.dropna()\ndata.isnull().sum()","166ac9f0":"x= data.drop('label',axis=1)","a8e10a00":"y = data['label']","b586f110":"temp = x.copy()","8172ac2a":"temp.reset_index(inplace=True)","d5274d92":"import nltk\nimport re\nfrom nltk.corpus import stopwords","87717b44":"stopwords= stopwords.words('english')","c742e222":"from nltk.stem.porter import PorterStemmer\nstemmer = PorterStemmer()\ncorpus = []\nfor i in range(0,len(temp)):\n    text = re.sub('[^a-zA-Z]', ' ', temp['title'][i])\n    text = text.lower()\n    text = text.split()\n    text = [stemmer.stem(word) for word in text if not word in stopwords]\n    text = ' '.join(text)\n    corpus.append(text)\ncorpus    ","43d4d397":"voc_size=5000\n\nfrom tensorflow.keras.preprocessing.text import one_hot\n\none_hot_repr =[one_hot(words,voc_size) for words in corpus]\none_hot_repr","1fdf1ef5":"from tensorflow.keras.preprocessing.sequence import pad_sequences\n\npadded = pad_sequences(one_hot_repr,padding='post',maxlen =20)\npadded","53563661":"from tensorflow.keras import Sequential\nfrom tensorflow.keras.layers import Bidirectional, Embedding, LSTM, Dropout, GlobalAveragePooling1D, Flatten, Dense","202ba84e":"embed_dim = 40\nmodel = Sequential([\n    Embedding(voc_size,embed_dim,input_length=20),\n    Bidirectional(LSTM(100)),\n    #Flatten(),\n    Dropout(0.3),\n    Dense(32, activation='relu'),\n    Dense(1,activation='sigmoid')\n    ])","01ef76d1":"model.compile(loss='binary_crossentropy',optimizer ='adam',metrics =['accuracy'])\n","98eec17d":"model.summary()","57e25a21":"x = np.array(padded)\ny = np.array(y)","c6fd204a":"from sklearn.model_selection import train_test_split\ntrainX,testX,trainY,testY = train_test_split(x,y,test_size=0.3,random_state=0)","9921aae1":"history = model.fit(trainX,trainY, epochs =10, validation_data=(testX,testY),batch_size=64)","2fe19a7d":"pred = model.predict_classes(testX)","fedd93dc":"from sklearn.metrics import confusion_matrix\n\ncm = confusion_matrix(testY,pred)","4f221422":"import seaborn as sns\n\nsns.heatmap(cm,annot=True,fmt='g')","58463b4c":"# Text Processing","33853533":"# Natural Language Processing","88e992a7":"# Padding","193ff522":"# Bidirectional LSTM Model:\nIt is an Extension of LSTM's which improves model performance on sequential data. It consists two LSTM's instead of one LSTM.\n"}}