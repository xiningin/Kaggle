{"cell_type":{"85432e4f":"code","1dcd4a1e":"code","bca3d608":"code","b4f89fa8":"code","3d97819d":"code","0f2e44db":"code","5c7d54b8":"code","02305838":"code","67839a85":"code","0cd26664":"code","3dd9e783":"code","dcec762b":"code","cc7d61c4":"code","06f11f4d":"code","850a87e0":"code","df5ed04b":"code","14520bc0":"code","ca37168c":"code","b3b821d5":"code","62aa9c3d":"code","16fd6bd2":"code","104f53ee":"code","9a6ca61c":"code","5dc52e6e":"code","5ac46de0":"code","8225f7e9":"code","aaa10c50":"code","5643ba2e":"code","8b78c135":"code","0a5c1e84":"code","a5b7f587":"code","a3208e0c":"code","df707b3d":"code","3ee79777":"code","d877762d":"code","ae3317b1":"code","55afab56":"code","bde40a5d":"code","e681a2bc":"code","811cd31c":"code","00e187c6":"code","b5f97b54":"code","b6e04272":"code","1a075d6f":"code","5587c646":"markdown","859bb623":"markdown","05412aa4":"markdown","b74b49af":"markdown","3d676da2":"markdown","4ee394ba":"markdown","e8eaeee9":"markdown","83d89a33":"markdown","8e10c530":"markdown","190dbb2e":"markdown","e51f13e7":"markdown","76ca0a73":"markdown","d825c2e9":"markdown","06102e3b":"markdown","ed15d90c":"markdown","19f18094":"markdown","032563b0":"markdown","0f208754":"markdown","5ce981fd":"markdown","8fc6b538":"markdown","b88c870d":"markdown","95e139c0":"markdown","44313bbc":"markdown","79c6ef50":"markdown","ed672676":"markdown","b4a96b42":"markdown","834458ea":"markdown","0a8df7a1":"markdown","9cbb2942":"markdown"},"source":{"85432e4f":"import pandas as pd\n\ndf = pd.read_csv(\"https:\/\/raw.githubusercontent.com\/toshihiroryuu\/Examples\/main\/advertising.csv\")\ndf.head(5)","1dcd4a1e":"# identify the size of data frame\nprint(\"Size of the data frame is\",df.size)\n\n# identify the shape of the data frame \nprint(\"Shape of the data frame is\",df.shape)\nprint(\"No of Rows = \", df.shape[0])\nprint(\"No of Columns = \", df.shape[1])\n  \n# identify the number of dimensions of your df\nprint(\"Dimentions(axis) of the data frame is\",df.ndim)","bca3d608":"df = df.drop(['Unnamed: 0'], axis=1)\ndf = df.drop(['Unnamed: 0.1'], axis=1)\ndf.head()","b4f89fa8":"import missingno as msno\n\nmissing_bar  = msno.bar(df, figsize=(12, 6), fontsize=12, color='steelblue')\n\nprint(missing_bar)","3d97819d":"miss_count = df.isnull().sum().sum()\n\nprint(\"No of missing values is\",miss_count)","0f2e44db":"import matplotlib.pyplot as plt\n\nplt.style.use('seaborn-whitegrid')\n\nplt.title(\"TV vs Sales\")\nplt.xlabel('TV')\nplt.ylabel('Sales')\n\nplt.scatter(\"TV\", \"Sales\", data = df, c='orange')\nplt.show()","5c7d54b8":"import matplotlib.pyplot as plt\n\nplt.style.use('seaborn-whitegrid')\n\nplt.title(\"Radio vs Sales\")\nplt.xlabel('Radio')\nplt.ylabel('Sales')\n\nplt.scatter(\"Radio\", \"Sales\", data = df, color = \"magenta\")\nplt.show()","02305838":"import matplotlib.pyplot as plt\n\nplt.style.use('seaborn-whitegrid')\n\nplt.title(\"Newspaper vs Sales\")\nplt.xlabel('Newspaper')\nplt.ylabel('Sales')\n\nplt.scatter(\"Newspaper\", \"Sales\", data = df, color = \"green\")\nplt.show()","67839a85":"import seaborn as sns\n\nprint(sns.pairplot(df))","0cd26664":"corr = df.corr()\ncorr","3dd9e783":"sns.set()\nfig, ax = plt.subplots(figsize=(9, 6))\nsns.heatmap(df.corr(), linewidths=.5, ax=ax, cmap='Blues')\nplt.show()","dcec762b":"from sklearn.model_selection import train_test_split\n\nx = df[['TV','Radio','Newspaper']]\ny = df['Sales']\n\nx_train, x_test, y_train, y_test = train_test_split(x, y, test_size = 0.2, random_state = 40)","cc7d61c4":"print(\"Training dataset X shape:\", x_train.shape)\nprint(\"Training dataset Y shape:\",y_train.shape)\nprint(\"Testing dataset X shape:\",x_test.shape)\nprint(\"Testing dataset Y shape:\",y_test.shape)","06f11f4d":"from sklearn.linear_model import LinearRegression\n\nlinear = LinearRegression()\nlinear.fit(x_train, y_train)","850a87e0":"score = []\n\nfrom sklearn.metrics import r2_score\n\ny_predict = linear.predict(x_test)\nscore0 = r2_score(y_test, y_predict)\nscore.append(score0)\nscore0","df5ed04b":"print(\"The linear model is: Y = \",linear.intercept_, \"+\", linear.coef_[0], \"X1 + \", linear.coef_[1], \"X2 + \", linear.coef_[2], \"X3\")","14520bc0":"from sklearn.model_selection import train_test_split\n\nx = df[['TV']]\ny = df['Sales']\n\nx_train, x_test, y_train, y_test = train_test_split(x, y, test_size = 0.2, random_state = 40)","ca37168c":"print(\"Training dataset X shape:\", x_train.shape)\nprint(\"Training dataset Y shape:\",y_train.shape)\nprint(\"Testing dataset X shape:\",x_test.shape)\nprint(\"Testing dataset Y shape:\",y_test.shape)","b3b821d5":"from sklearn.linear_model import LinearRegression\n\nlinear1 = LinearRegression()\nlinear1.fit(x_train, y_train)","62aa9c3d":"from sklearn.metrics import r2_score\n\ny_predict = linear1.predict(x_test)\nscore1 = r2_score(y_test, y_predict)\nscore.append(score1)\nscore1","16fd6bd2":"import matplotlib.pyplot as plt\n\nplt.style.use('seaborn-whitegrid')\n\nplt.title(\"TV vs Sales\")\nplt.xlabel('TV')\nplt.ylabel('Sales')\n\nplt.scatter(\"TV\", \"Sales\", data = df, c='orange')\nplt.show()","104f53ee":"print(\"The linear model is: Y = \",linear1.intercept_, \"+\", linear1.coef_[0], \"X \")","9a6ca61c":"predictions = linear1.predict(x)\n\nplt.scatter(df['TV'], df['Sales'], c='orange')\nplt.plot(df['TV'], predictions,  c='blue', linewidth=2)\nplt.xlabel(\"TV\")\nplt.ylabel(\"Sales\")\nplt.show()","5dc52e6e":"import seaborn as sns \nimport matplotlib.pyplot as plt \n\nsns.residplot(x = \"TV\", \n              y = \"Sales\", \n              data = df, \n              lowess = True) \n  \nplt.show()","5ac46de0":"from sklearn.metrics import r2_score\nimport statsmodels.api as sm\n\nx = df['TV']\ny = df['Sales']\n\nx2 = sm.add_constant(x)\n\nest = sm.OLS(y, x2)\n\nest2 = est.fit()\nprint(est2.summary())","8225f7e9":"from sklearn.model_selection import train_test_split\n\nx = df[['Radio']]\ny = df['Sales']\n\nx_train, x_test, y_train, y_test = train_test_split(x, y, test_size = 0.2, random_state = 40)","aaa10c50":"print(\"Training dataset X shape:\", x_train.shape)\nprint(\"Training dataset Y shape:\",y_train.shape)\nprint(\"Testing dataset X shape:\",x_test.shape)\nprint(\"Testing dataset Y shape:\",y_test.shape)","5643ba2e":"from sklearn.linear_model import LinearRegression\n\nlinear2 = LinearRegression()\nlinear2.fit(x_train, y_train)","8b78c135":"from sklearn.metrics import r2_score\n\ny_predict = linear2.predict(x_test)\nscore2 = r2_score(y_test, y_predict)\nscore.append(score2)\nscore2","0a5c1e84":"import matplotlib.pyplot as plt\n\nplt.style.use('seaborn-whitegrid')\n\nplt.title(\"Radio vs Sales\")\nplt.xlabel('Radio')\nplt.ylabel('Sales')\n\nplt.scatter(\"Radio\", \"Sales\", data = df, color = \"magenta\")\nplt.show()","a5b7f587":"print(\"The linear model is: Y = \",linear1.intercept_, \"+\", linear1.coef_[0], \"X \")","a3208e0c":"predictions = linear1.predict(x)\n\nplt.scatter(df['Radio'], df['Sales'], c='magenta')\nplt.plot(df['Radio'], predictions,  c='blue', linewidth=2)\nplt.xlabel(\"Radio\")\nplt.ylabel(\"Sales\")\nplt.show()","df707b3d":"import seaborn as sns \nimport matplotlib.pyplot as plt \n\nsns.residplot(x = \"Radio\", \n              y = \"Sales\", \n              data = df, \n              lowess = True) \n  \nplt.show()","3ee79777":"from sklearn.metrics import r2_score\nimport statsmodels.api as sm\n\nx = df['Radio']\ny = df['Sales']\n\nx2 = sm.add_constant(x)\n\nest = sm.OLS(y, x2)\n\nest2 = est.fit()\nprint(est2.summary())","d877762d":"from sklearn.model_selection import train_test_split\n\nx = df[['Newspaper']]\ny = df['Sales']\n\nx_train, x_test, y_train, y_test = train_test_split(x, y, test_size = 0.2, random_state = 40)","ae3317b1":"print(\"Training dataset X shape:\", x_train.shape)\nprint(\"Training dataset Y shape:\",y_train.shape)\nprint(\"Testing dataset X shape:\",x_test.shape)\nprint(\"Testing dataset Y shape:\",y_test.shape)","55afab56":"from sklearn.linear_model import LinearRegression\n\nlinear3 = LinearRegression()\nlinear3.fit(x_train, y_train)","bde40a5d":"from sklearn.metrics import r2_score\n\ny_predict = linear3.predict(x_test)\nscore3 = r2_score(y_test, y_predict)\nscore.append(score3)\nscore3","e681a2bc":"import matplotlib.pyplot as plt\n\nplt.style.use('seaborn-whitegrid')\n\nplt.title(\"Newspaper vs Sales\")\nplt.xlabel('Newspaper')\nplt.ylabel('Sales')\n\nplt.scatter(\"Newspaper\", \"Sales\", data = df, color = \"green\")\nplt.show()","811cd31c":"print(\"The linear model is: Y = \",linear1.intercept_, \"+\", linear1.coef_[0], \"X \")","00e187c6":"predictions = linear1.predict(x)\n\nplt.scatter(df['Newspaper'], df['Sales'], c='green')\nplt.plot(df['Newspaper'], predictions,  c='blue', linewidth=2)\nplt.xlabel(\"Newspaper\")\nplt.ylabel(\"Sales\")\nplt.show()","b5f97b54":"import seaborn as sns \nimport matplotlib.pyplot as plt \n\nsns.residplot(x = \"Newspaper\", \n              y = \"Sales\", \n              data = df, \n              lowess = True) \n  \nplt.show() ","b6e04272":"from sklearn.metrics import r2_score\nimport statsmodels.api as sm\n\nx = df['Newspaper']\ny = df['Sales']\n\nx2 = sm.add_constant(x)\n\nest = sm.OLS(y, x2)\n\nest2 = est.fit()\nprint(est2.summary())","1a075d6f":"listt = [\"TV + Radio + Newspaper\", \"TV\", \"Radio\", \"Newspaper\"]\nplt.bar(listt, score)\nplt.title(\"Models VS R2 Score\")\nplt.xlabel(\"Models\")\nplt.ylabel(\"R2 Score\")\nplt.show()","5587c646":"## Hnadle Missing Values","859bb623":"### That is, TV, Radio, Newspaper has hight correlation(dependence) with sales.","05412aa4":"#### Regression Line Radio vs Sales","b74b49af":"The regression line fails to fit the data points correctly.","3d676da2":"#### Regression Line Newspaper vs Sales","4ee394ba":"#### Linear Regression Model with 'TV','Radio','Newspaper' as data points and Sales as Target variable.","e8eaeee9":"The R\u00b2 value is 0.332. Therefore, about 33.2% of the variability of Sales is explained by the radio advertisement. This is definitely not a satisfactory result for prediction.","83d89a33":"#### Sales depend on TV, Radio and Newspaper. \n#### TV has a strong positive correlation with sales.\n#### Radio has medium positive correlation with sales.\n#### Newspaper has lesser positive correlation with sales.","8e10c530":"The R\u00b2 value is 0.612. Therefore, about 61.2% of the variability of Sales is explained by the TV advertisement. This is a satisfactory result for prediction.","190dbb2e":"No missing values in this dataset.","e51f13e7":"## (b) Employ Simple Linear Regression to analyse the effect of each of them on sales. ","76ca0a73":"The regression line fails fit the data points perfectly.","d825c2e9":"P value is very low. This means that there is a strong correlation between these coefficients and the target.","06102e3b":"#### Scatter Plot Radio vs Sales","ed15d90c":"## (a)  Assess the correlation between each and sales. ","19f18094":"### Linear Model with TV vs Sales","032563b0":"#### Scatter Plot Newspaper vs Sales","0f208754":"## Preprocessing","5ce981fd":"### Linear Model with Newspaper vs Sales","8fc6b538":"### Linear Model with Radio vs Sales","b88c870d":"1. TV, Newspaper and radio advertising affect the target variable Sales. The order of correlation with sales given by TV AdV> Radio Adv> Newspaper Adv.\n2. The linear model created with TV, Newspaper and radio as input varaible and Sales as Target variable gave the higher r2score.\n3. The linear model created with TV as input varaible and Sales as Target variable gave the second highest r2score.\n4. The linear models created with Radio and Newspapaer as input varaibles and Sales as Target variable has very less r2 score.\n5. Therefore inorder to create a suitable model which approxiamates the scenario correctly, we need to use the combination of TV, Radio and Newspapaer as target variable.\n6. It is clear from the model and correlation matrix that Amount spend on TV ads direclty impact the Sales of a particular product.\n7. we can conclude from the R2 value that only input variable TV advertsisements provides a satisfactory result.","95e139c0":"P value is very low. This means that there is a strong correlation between these coefficients and the target.","44313bbc":"## Conclusion:","79c6ef50":"P value is very low. This means that there is a strong correlation between these coefficients and the target.","ed672676":"#### Scatter Plot TV vs Sales","b4a96b42":"#### Regression Line TV vs Sales","834458ea":"The R\u00b2 value is 0.052. Therefore, about 5.20% of the variability of Sales is explained by the Newspaper advertisement. This is definitely NOT a satisfactory result for prediction.","0a8df7a1":"## Exploratory Data Analysis","9cbb2942":"## R2 SCORE COMPARISON"}}