{"cell_type":{"d52e56e9":"code","ec350250":"code","f5974aeb":"code","1c01cfba":"code","58d6457e":"code","a530a255":"code","829135ed":"code","5293498e":"code","dfb87e06":"code","37bdd213":"code","32061628":"code","3ab2ae34":"code","f1743949":"code","df5a22d5":"code","0e47a75b":"code","451c7dbc":"code","704649bf":"code","47ac993d":"code","2af31779":"code","a0d853a2":"code","0ab1ac7d":"code","bba8dc3a":"code","2acf0421":"code","bb0c0609":"code","61a29bdd":"code","a08e41d5":"code","129bdce4":"code","35eebf37":"code","ad76808a":"code","9d99b0a7":"code","669eac03":"code","87e51a15":"markdown","428d2cd6":"markdown","d97d89c4":"markdown","40a7da97":"markdown","f2cb0aab":"markdown","cb51377e":"markdown","5ff41d47":"markdown","e2174227":"markdown","bcf8bfc0":"markdown","b5bf61de":"markdown","241977af":"markdown","39a288ce":"markdown"},"source":{"d52e56e9":"import numpy as np\nimport pandas as pd\n\nimport os,sys,random,math,time\nfrom datetime import datetime\n\nimport warnings\nwarnings.filterwarnings(\"ignore\")\n\nimport matplotlib.pyplot as plt\nimport matplotlib.dates as mdates\nplt.rcParams['font.sans-serif'] = ['KaiTi']\nplt.rcParams['axes.unicode_minus'] = False\n%matplotlib inline","ec350250":"# \u7ade\u8d5b\u6570\u636eREADME.md\n!cat \/kaggle\/input\/learnplatform-covid19-impact-on-digital-learning\/README.md","f5974aeb":"'''\ndistrict_id \u5b66\u533a\u552f\u4e00\u6807\u8bc6\nstate \u5b66\u533a\u6240\u5c5e\u5dde\nlocale \u6240\u5904\u533a\u57df\u7c7b\u578b\uff1a\u57ce\u5e02\u3001\u90ca\u533a\u3001\u57ce\u9547\u548c\u519c\u6751\npct_black\/hispanic \u9ed1\u4eba\u6216\u8005\u897f\u73ed\u7259\u88d4\u5b66\u751f\u5360\u6bd4\npct_free\/reduced \u6709\u8d44\u683c\u83b7\u5f97\u514d\u8d39\u6216\u8005\u51cf\u4ef7\u5348\u9910\u7684\u5b66\u751f\u5360\u6bd4\ncounty_connections_ration \u9ad8\u901f\u7f51\u7edc\u5728\u4e00\u4e2a\u65b9\u5411\u6216\u4f4f\u6237\u6216\u8005\u6bd4\u4f8b\npp_total_raw \u7ed9\u5b9a\u5b66\u533a\u7684\u6bcf\u540d\u5b66\u751f\u7684\u56fd\u5bb6\u603b\u652f\u51fa\n'''\ndistricts_df = pd.read_csv(\"\/kaggle\/input\/learnplatform-covid19-impact-on-digital-learning\/districts_info.csv\")\n# districts_df = districts_df.fillna('')\ndistricts_df = districts_df.dropna()\ndistricts_df['pct_black'] = districts_df['pct_black\/hispanic'].apply(lambda pbh:float(pbh[1:-1].split(',')[0].strip()) if pbh!='' else '')\ndistricts_df['pct_hispanic'] = districts_df['pct_black\/hispanic'].apply(lambda pbh:float(pbh[1:-1].split(',')[1].strip()) if pbh!='' else '')\ndistricts_df['pct_free'] = districts_df['pct_free\/reduced'].apply(lambda pbh:float(pbh[1:-1].split(',')[0].strip()) if pbh!='' else '')\ndistricts_df['pct_reduced'] = districts_df['pct_free\/reduced'].apply(lambda pbh:float(pbh[1:-1].split(',')[1].strip()) if pbh!='' else '')\ndistricts_df['ratio_direction'] = districts_df['county_connections_ratio'].apply(lambda pbh:float(pbh[1:-1].split(',')[0].strip()) if pbh!='' else '')\ndistricts_df['ratio_households'] = districts_df['county_connections_ratio'].apply(lambda pbh:float(pbh[1:-1].split(',')[1].strip()) if pbh!='' else '')\ndistricts_df['pp_total_a'] = districts_df['pp_total_raw'].apply(lambda pbh:float(pbh[1:-1].split(',')[0].strip()) if pbh!='' else '')\ndistricts_df['pp_total_b'] = districts_df['pp_total_raw'].apply(lambda pbh:float(pbh[1:-1].split(',')[1].strip()) if pbh!='' else '')\ndistricts_df = districts_df[['district_id','state','locale','pct_black','pct_hispanic',\n                             'pct_free','pct_reduced','ratio_direction','ratio_households','pp_total_a','pp_total_b']]\ndistricts_df.info()","1c01cfba":"districts_df.head()","58d6457e":"'''\nLP ID \u4ea7\u54c1\u552f\u4e00\u6807\u8bc6\nURL \u4ea7\u54c1\u7f51\u7ad9\u94fe\u63a5\nProduct Name \u4ea7\u54c1\u540d\nProvider\/Company Name \u4ea7\u54c1\u63d0\u4f9b\u5546\u540d \nSector(s) \u4f7f\u7528\u8be5\u4ea7\u54c1\u7684\u6559\u80b2\u90e8\u95e8\nPrimary Essential Function \u4ea7\u54c1\u7684\u57fa\u672c\u529f\u80fd\u3002\u8fd9\u91cc\u6709\u4e24\u5c42\u6807\u7b7e\u3002\u4ea7\u54c1\u9996\u5148\u88ab\u6807\u8bb0\u4e3a\u4ee5\u4e0b\u4e09\u4e2a\u7c7b\u522b\u4e4b\u4e00\uff1aLC = \u5b66\u4e60\u548c\u8bfe\u7a0b\uff0cCM = \u8bfe\u5802\u7ba1\u7406\uff0c\n                            \u4ee5\u53ca SDO = \u5b66\u6821\u548c\u5b66\u533a\u8fd0\u8425\u3002\u8fd9\u4e9b\u7c7b\u522b\u4e2d\u7684\u6bcf\u4e00\u4e2a\u90fd\u6709\u591a\u4e2a\u5b50\u7c7b\u522b\n'''\nproducts_df = pd.read_csv(\"\/kaggle\/input\/learnplatform-covid19-impact-on-digital-learning\/products_info.csv\")\nproducts_df = products_df.dropna()\nproducts_df['PEF L1'] = products_df['Primary Essential Function'].apply(lambda pef:pef.split('-')[0].strip())\nproducts_df['PEF L2'] = products_df['Primary Essential Function'].apply(lambda pef:pef.split('-')[1].strip())\nproducts_df = products_df[['LP ID','URL','Product Name','Provider\/Company Name','Sector(s)','PEF L1','PEF L2']]\nproducts_df.info()","a530a255":" products_df.head()","829135ed":"'''\n\u5b66\u533a\u7ea7\u522b\u7684\u6c47\u603b\u6570\u636e\uff0c\u6587\u4ef6\u540d\u5373\u8868\u793a\u5b66\u533a\u552f\u4e00\u6807\u8bc6\ntime \u65e5\u671f\nLp_id \u4ea7\u54c1\u552f\u4e00\u6807\u8bc6\npct_access \u8be5\u5b66\u533a\u5b66\u751f\u5f53\u5929\u5728\u8be5\u4ea7\u54c1\u4e0a\u81f3\u5c11\u6709\u4e00\u4e2a\u9875\u9762\u8bbf\u95ee\u7684\u6bd4\u4f8b\nengagement_index \u5f53\u524d\u5b66\u533a\u5728\u5f53\u524d\u4ea7\u54c1\u5728\u5f53\u524d\u6bcf\u5343\u540d\u5b66\u751f\u8bbf\u95ee\u9875\u9762\u603b\u6570\n'''\n\ndef read_engagement(district_id):\n    engagement = pd.read_csv(\"\/kaggle\/input\/learnplatform-covid19-impact-on-digital-learning\/engagement_data\/\"+str(district_id)+\".csv\")\n    engagement = engagement.fillna(0)\n    engagement['dt_id'] = district_id\n    return engagement\n\nengagement_8815 = read_engagement(8815)\nengagement_8815.info()","5293498e":"engagement_8815.head()","dfb87e06":"'''\ndate \u65e5\u671f\nstate \u5dde\ncases \u7d2f\u8ba1\u786e\u8bca\ndeaths \u7d2f\u8ba1\u6b7b\u4ea1\n'''\n\nus_covid = pd.read_csv('\/kaggle\/input\/us-counties-covid-19-dataset\/us-counties.csv')\nus_covid = us_covid.drop('county',axis=1)\nus_covid = us_covid.groupby(by=['date','state']).agg({'cases':'sum','deaths':'sum'}).reset_index()\nus_covid.info()","37bdd213":"us_covid.head()","32061628":"def district_product_covid(district_id):\n    engagement_8815 = read_engagement(district_id)\n    districts_8815 = districts_df[districts_df['district_id']==district_id]\n    covid_8815 = us_covid[us_covid['state']==districts_8815['state'].iloc[0]]\n    dpc_df = engagement_8815.merge(districts_8815,left_on='dt_id',right_on='district_id',how='inner').merge(covid_8815,left_on='time',right_on='date',how='inner')\n    return dpc_df\n\ndpc_df = district_product_covid(8815).sort_values(by='date')\ndpc_df = dpc_df[['date','state_x','district_id','lp_id','locale','pct_access','engagement_index',\n                 'pct_black','pct_hispanic','pct_free','pct_reduced','ratio_direction','ratio_households',\n                'pp_total_a','pp_total_b','cases','deaths']]\ndpc_df.info()","3ab2ae34":"dpc_df.head()","f1743949":"def bar_plot(data,title,y='district_id',xlabel='US State',ylabel='Number of school districts',rotation=90):\n    plt.figure(figsize=(20,5))\n    plt.bar(x=[str(x) for x in data.index.tolist()],height=data[y].tolist())\n    plt.xticks(rotation=rotation)\n    plt.title(title)\n    plt.xlabel(xlabel)\n    plt.ylabel(ylabel)\n    plt.show()","df5a22d5":"def line_plot(data,product_id=32213,y='pct_access'):\n    plt.figure(figsize=(20,8))\n    tmp = data[data['lp_id']==product_id]\n\n    plt.gca().xaxis.set_major_formatter(mdates.DateFormatter('%Y-%m-%d'))\n    plt.gca().xaxis.set_major_locator(mdates.DayLocator())\n    date = [datetime.strptime(d, '%Y-%m-%d').date() for d in tmp['date'].tolist()]\n    plt.xticks(date[::30])\n\n    plt.subplot(211)\n\n    plt.plot(date,tmp[y].tolist(),label=y)\n    plt.legend()\n    plt.twinx()\n    plt.plot(date,tmp['cases'].tolist(),color='red',label='cases')\n    plt.legend()\n\n    plt.subplot(212)\n\n    plt.plot(date,tmp[y].tolist(),label=y)\n    plt.legend()\n    plt.twinx()\n    plt.plot(date,tmp['deaths'].tolist(),color='gray',label='deaths')\n    plt.legend()\n\n    plt.show()","0e47a75b":"state_group = districts_df.groupby('state')[['district_id']].count().sort_values(by='district_id')\nbar_plot(state_group,'Number of school districts by state')","451c7dbc":"state_group = districts_df.groupby('locale')[['district_id']].count().sort_values(by='district_id')\nbar_plot(state_group,'Number of school districts by locale',xlabel='Locale Type')","704649bf":"districts_df['pct_black_box'] = districts_df['pct_black'].apply(lambda pb:str(float(pb)*100)+'%')\nstate_group = districts_df.groupby('pct_black_box')[['district_id']].count().sort_values(by='district_id')\nbar_plot(state_group,'Number of school districts by pct_black_box',xlabel='Black percent',rotation=0)","47ac993d":"districts_df['pct_hispanic_box'] = districts_df['pct_hispanic'].apply(lambda pb:str(float(pb)*100)+'%')\nstate_group = districts_df.groupby('pct_hispanic_box')[['district_id']].count().sort_values(by='district_id')\nbar_plot(state_group,'Number of school districts by pct_hispanic_box',xlabel='Hispanic percent',rotation=0)","2af31779":"districts_df['pct_free_box'] = districts_df['pct_free'].apply(lambda pb:str(float(pb)*100)+'%')\nstate_group = districts_df.groupby('pct_free_box')[['district_id']].count().sort_values(by='district_id')\nbar_plot(state_group,'Number of school districts by pct_free_box',xlabel='Free lunch percent',rotation=0)","a0d853a2":"districts_df['pct_reduced_box'] = districts_df['pct_reduced'].apply(lambda pb:str(float(pb)*100)+'%')\nstate_group = districts_df.groupby('pct_reduced_box')[['district_id']].count().sort_values(by='district_id')\nbar_plot(state_group,'Number of school districts by pct_reduced_box',xlabel='Reduced lunch percent',rotation=0)","0ab1ac7d":"districts_df['ratio_direction_box'] = districts_df['ratio_direction'].apply(lambda pb:str(float(pb)*100)+'%')\nstate_group = districts_df.groupby('ratio_direction_box')[['district_id']].count().sort_values(by='district_id')\nbar_plot(state_group,'Number of school districts by ratio_direction_box',xlabel='Direction ratio',rotation=0)","bba8dc3a":"districts_df['ratio_households_box'] = districts_df['ratio_households'].apply(lambda pb:str(float(pb)*100)+'%')\nstate_group = districts_df.groupby('ratio_households_box')[['district_id']].count().sort_values(by='district_id')\nbar_plot(state_group,'Number of school districts by ratio_households_box',xlabel='Hourseholds ratio',rotation=0)","2acf0421":"state_group = products_df.groupby('Provider\/Company Name')[['LP ID']].count().sort_values(by='LP ID')\nstate_group = state_group[state_group['LP ID']>1]\nbar_plot(state_group,'Number of product by Provider\/Company Name',y='LP ID',xlabel='Provider\/Company Name',ylabel='Number of product',rotation=90)","bb0c0609":"state_group = products_df.groupby('Sector(s)')[['LP ID']].count().sort_values(by='LP ID')\nbar_plot(state_group,'Number of product by Sector(s)',y='LP ID',xlabel='Sector(s)',ylabel='Number of product',rotation=0)","61a29bdd":"state_group = products_df.groupby('PEF L1')[['LP ID']].count().sort_values(by='LP ID')\nbar_plot(state_group,'Number of product by PEF L1',y='LP ID',xlabel='Primary Essential Function Level1',ylabel='Number of product',rotation=0)","a08e41d5":"engagement_8815 = read_engagement(8815)","129bdce4":"group_8815 = engagement_8815.groupby('lp_id')[['pct_access']].mean().sort_values(by='pct_access')\ngroup_8815 = group_8815[group_8815['pct_access']>1]\nbar_plot(group_8815,'Mean of product`s pct_access by LP ID in district 8815',y='pct_access',xlabel='Product ID',ylabel='Mean of product`s access percent',rotation=90)","35eebf37":"group_8815 = engagement_8815.groupby('lp_id')[['engagement_index']].mean().sort_values(by='engagement_index')\ngroup_8815 = group_8815[group_8815['engagement_index']>100]\nbar_plot(group_8815,'Mean of product`s engagement_index by LP ID in district 8815',y='engagement_index',xlabel='Product ID',ylabel='Mean of product`s engagement index',rotation=90)","ad76808a":"dpc_df.info()","9d99b0a7":"line_plot(dpc_df,y='pct_access')","669eac03":"line_plot(dpc_df,y='engagement_index')","87e51a15":"### \u4ea7\u54c1\u8868\u6570\u636e\u53ef\u89c6\u5316","428d2cd6":"## \u6570\u636e\u52a0\u8f7d\u53ca\u5b57\u6bb5\u89e3\u91ca\n\n\u6b64\u5904\u6570\u636e\u6e90\u6765\u81ea\u4e8e\u4e24\u90e8\u5206\uff0c\u9996\u5148\u662f\u8be5\u7ade\u8d5b\u63d0\u4f9b\u7684districts_info.csv\u3001products_info.csv\u3001engagement_data\uff0c\u5176\u6b21\u662f\u6765\u81ea\u4e8e\u5176\u4ed6\u516c\u5f00\u6570\u636e\u6e90\u6570\u636e\uff0c\n\u6bd4\u5982[COVID-19 US State Policy database](https:\/\/www.openicpsr.org\/openicpsr\/project\/119446\/version\/V75\/view;jsessionid=851ECB80E6CB42252D396C29564184DC)\u3001[KIDS Count](https:\/\/www.aecf.org\/resources\/2020-kids-count-data-book\/?gclid=CjwKCAiAudD_BRBXEiwAudakXyXtNK90IAicHQ5T3kT12l4TdJYfAQsYsHlMPNJLZnETp0XgshKE4xoC2UcQAvD_BwE)\u3001[KFF](https:\/\/www.kff.org\/coronavirus-covid-19\/issue-brief\/state-covid-19-data-and-policy-actions\/)\u7b49\uff1b","d97d89c4":"## \u6570\u636e\u53ef\u89c6\u5316\u5206\u6790","40a7da97":"### \u5916\u90e8\u516c\u5f00\u6570\u636e\n- covid-19 us state data\n- kids count\n- kff","f2cb0aab":"The end.\nFrom SIBAT.","cb51377e":"### \u7ade\u8d5b\u6570\u636e","5ff41d47":"### \u7edf\u8ba1\u6570\u636e\u8868\u6570\u636e\u53ef\u89c6\u5316\n\u5b66\u533a\uff1a8815 4921 5987 3710 7177","e2174227":"### \u5b66\u533a\u3001\u4ea7\u54c1\u3001Engagement\u3001Covid\u6574\u5408\u6570\u636e\u53ef\u89c6\u5316","bcf8bfc0":"# \u2620COVID-19\u4e0e\u5728\u7ebf\u6570\u5b57\u6559\u80b2\ud83c\udf93\n\n\u57fa\u4e8e[LearnPlatform](https:\/\/learnplatform.com\/)\u63d0\u4f9b\u7684\u6570\u636e\u5206\u6790\u3001\u6316\u6398\u6709\u5173COVID-19\u5982\u4f55\u5bf9\u73b0\u6709\u5728\u7ebf\u6559\u80b2\u4f53\u7cfb\u8fdb\u884c\u5f71\u54cd\uff0c\u8fd9\u53c8\u4e0e\u5404\u5dde\u4eba\u53e3\u3001\u7f51\u7edc\u60c5\u51b5\u3001\u653f\u7b56\u4ee5\u53ca\u4e8b\u4ef6\u4e4b\u95f4\u6709\u4f55\u8054\u7cfb\uff1b","b5bf61de":"### \u901a\u8fc7\u5b66\u533aid\u83b7\u53d6\u5e76\u94fe\u63a5\u76f8\u5173\u6570\u636e","241977af":"## \u5173\u8054\u6316\u6398","39a288ce":"### \u5b66\u533a\u8868\u6570\u636e\u53ef\u89c6\u5316"}}