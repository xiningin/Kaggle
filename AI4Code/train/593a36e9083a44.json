{"cell_type":{"9cdc7f45":"code","fc18bccb":"code","6846d7da":"code","e258aba5":"code","ffe6309f":"code","4951168f":"code","c8a95d85":"code","7d7d3a81":"code","4ffca7d0":"code","14ddcc97":"code","b09822e6":"code","23237ceb":"code","21c28757":"code","e6d5a695":"code","0bfea3a7":"code","c4bb1c98":"code","91bbb88c":"code","47f42050":"code","99012041":"code","133b1427":"code","2bf5d907":"code","e0fd1717":"code","52ba21b4":"code","52c32b2f":"code","690d9a1f":"code","5829727a":"code","fefa4f26":"code","e6750ee8":"code","87fbe0b9":"code","55d509e2":"code","43019bbe":"code","91b8808d":"code","2de73a99":"code","b8cf2c74":"code","f2b34e09":"code","7c2c56dc":"code","30c319e3":"code","6653c37e":"code","98c0fa48":"code","ae636c1c":"code","23712e20":"markdown","ef5d622f":"markdown","98533f72":"markdown","561a1389":"markdown","f9fae479":"markdown","fcde9b3f":"markdown","2aac6b7c":"markdown","a12c3014":"markdown","aa8cfe5d":"markdown","38fd9fc2":"markdown","b1bf00f3":"markdown","1faefcde":"markdown","28ec99a6":"markdown","0ee8154c":"markdown"},"source":{"9cdc7f45":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n%matplotlib inline","fc18bccb":"telco=pd.read_csv('\/kaggle\/input\/telco-customer-churn\/WA_Fn-UseC_-Telco-Customer-Churn.csv')","6846d7da":"telco.head()","e258aba5":"telco.info()","ffe6309f":"telco=telco.iloc[:,1:]","4951168f":"telco.info()","c8a95d85":"# pd.to_numeric(telco['TotalCharges'])\ntelco['TotalCharges'][488]","7d7d3a81":"telco=telco[telco['TotalCharges']!=' ']","4ffca7d0":"telco.reset_index(drop=True)","14ddcc97":"telco['TotalCharges']=telco['TotalCharges'].astype('float64')","b09822e6":"telco.info()","23237ceb":"for i in telco:\n  print(f'{i}:{telco[i].unique()}')","21c28757":"telco.columns","e6d5a695":"for i in range(len(telco.columns)):\n  if i in range(9,15):\n    telco[telco.columns[i]]=telco[telco.columns[i]].replace('No internet service','No')","0bfea3a7":"telco['MultipleLines']=telco['MultipleLines'].replace('No phone service','No')","c4bb1c98":"for i in telco:\n  print(f'{i}:{telco[i].unique()}')","91bbb88c":"edadata=telco.copy()","47f42050":"from sklearn.preprocessing import LabelEncoder\nle=LabelEncoder()\nz=telco.select_dtypes(include='object')\nfor i in z:\n  print(i)\n  z[i]=le.fit_transform(z[i])","99012041":"for i in z:\n  print(f'{i}:{z[i].unique()}')","133b1427":"for i in telco:\n  for j in z:\n    if i==j:\n      telco[i]=z[j]","2bf5d907":"telco","e0fd1717":"telco=pd.get_dummies(data=telco,columns=['Contract','PaymentMethod','InternetService'])\ntelco","52ba21b4":"from sklearn.preprocessing import MinMaxScaler\nscaler=MinMaxScaler()\ntelco[['tenure','MonthlyCharges','TotalCharges']]=scaler.fit_transform(telco[['tenure','MonthlyCharges','TotalCharges']])\ntelco","52c32b2f":"edadata","690d9a1f":"import seaborn as sns","5829727a":"\nsns.factorplot(data=edadata,x='Churn',y='tenure',hue='gender')","fefa4f26":"f,axes=plt.subplots(1,2,figsize=(16,9))\nsns.barplot(ax=axes[0],x='tenure',y='Churn',hue='Contract',data=edadata)\nsns.boxplot(ax=axes[1],x='tenure',y='Churn',hue='Contract',data=edadata)","e6750ee8":"edadata.columns\n","87fbe0b9":"\nsns.factorplot(x='tenure',y='TotalCharges',hue='Churn',data=edadata)","55d509e2":"from sklearn.model_selection import train_test_split\nX_train,X_test,y_train,y_test=train_test_split(telco.drop(columns='Churn'),telco.Churn,test_size=0.3,random_state=7)","43019bbe":"import tensorflow as tf\nfrom tensorflow import keras\nmodel=keras.Sequential([\n                        keras.layers.Dense(20,input_shape=(len(X_train.columns),),activation='relu'),\n                        keras.layers.Dense(15,activation='relu'),\n                        keras.layers.Dense(10,activation='relu'),\n                        keras.layers.Dense(5,activation='relu'),\n                        keras.layers.Dense(1,activation='sigmoid')\n])\nmodel.compile(optimizer='adam',\n              loss='binary_crossentropy',\n              metrics=['accuracy'])\nmodel.fit(X_train,y_train,epochs=50)","91b8808d":"model.evaluate(X_test,y_test)","2de73a99":"l=model.predict(X_test)","b8cf2c74":"l","f2b34e09":"li=[]\nfor i in range(len(l)):\n  if l[i][0]<0.5:\n    li.append(0)\n  else:\n    li.append(1)","7c2c56dc":"li[:6]","30c319e3":"y_test[:6]","6653c37e":"from sklearn.metrics import confusion_matrix, classification_report\nprint(classification_report(y_test,li))","98c0fa48":"cm=tf.math.confusion_matrix(labels=y_test,predictions=li)","ae636c1c":"sns.heatmap(cm,annot=True,fmt='d')\nplt.xlabel('predicted')\nplt.ylabel('Truth')\n","23712e20":"# Data Preprocessing","ef5d622f":"the multiple lines columns have no phone service which means No. So we have to change is also","98533f72":"# Accuracy and Classification","561a1389":"*Observation: there are more customer who churn as there tenure and total charges are increasing *","f9fae479":"*OBSERVATION:Tenure is inversely porportional to Churn, as per the graph those customer whose tenure is large , they do not left the company and viceversa.*","fcde9b3f":"**Problems in dataset**\n1. In this data set cutomer id is not usable\n2. Total charges dtypes is object, so it must be float64 type","2aac6b7c":"now dataset have all numeric values in it but InternetService, contract and paymentmethod is in 3 or 4 decision choices so we have to change it according to one hot encoding","a12c3014":"# EDA of DATASET","aa8cfe5d":"lets see the data ","38fd9fc2":"# Train and Test split ","b1bf00f3":"There is some No internet service feature in some columns so we have to change it to No.","1faefcde":"# Prediction ","28ec99a6":"## **Data cleaning**","0ee8154c":"*Observation: As per given graph, if customer whose tenure is low haveing month-to-month contract and tenure with middle range have one year contract and higher tenure peope have two year contract*"}}