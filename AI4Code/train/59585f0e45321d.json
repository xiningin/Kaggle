{"cell_type":{"f5cf1605":"code","77dca55e":"code","be970491":"code","1e4175bf":"code","ee377cbe":"code","a18f7c0b":"code","84a1f1ac":"code","291abbca":"code","0897462b":"code","59caee67":"code","925e1921":"code","f6652edf":"code","990fc34a":"code","75d25b41":"code","e252f3f2":"code","3d929520":"code","69c8418e":"code","b73b3661":"code","fecc30a1":"code","48a16a1f":"code","48e85797":"code","ecb7bd96":"code","37fa78f8":"code","4c276a47":"code","6bc7500d":"code","8068a589":"code","80908ec8":"code","8eea74f3":"code","a49ad23a":"code","7d8eacd6":"code","ba12bfbe":"code","b366bf27":"code","7872b414":"code","b04eb830":"code","38db393f":"code","afd26815":"code","adcfeb22":"code","ec694d8a":"code","87a2741e":"code","a6ae4c01":"code","e4204bcb":"code","7d01ba5a":"code","ac6d7351":"code","592705aa":"code","95dfb1a1":"code","eceb9338":"code","f8851a4d":"code","3bd71941":"code","8e63e588":"code","246c7afc":"code","f4d32f7a":"code","b6b8f3e2":"code","35bd88d4":"code","e375da67":"code","715827da":"code","0a6b4f44":"code","534d3d03":"markdown","69805e4d":"markdown","d8b5410a":"markdown","ae50bcb5":"markdown","adb7bbc2":"markdown","d59e3a13":"markdown","1a3ca4be":"markdown","d3ef0999":"markdown","e1866522":"markdown","5e6dba41":"markdown","70286ca9":"markdown","524d8f67":"markdown","3bbfe80a":"markdown","dda89b1e":"markdown","d1125fd6":"markdown","daab3a86":"markdown","f308166f":"markdown","88ac0be0":"markdown","55625dbc":"markdown","137ad097":"markdown","0fcb3faa":"markdown","0c67a809":"markdown","e84a1eaf":"markdown","c02e8209":"markdown","5b8298ef":"markdown","e615bd83":"markdown","c7da27ba":"markdown","6fa96920":"markdown","181d15cb":"markdown","b0aa24a5":"markdown","e8b1b560":"markdown","3a66f8f3":"markdown","ab53ab9d":"markdown","eb730c51":"markdown","20608d85":"markdown","cc6a9c71":"markdown","4b43bd97":"markdown","dfe9123d":"markdown","247c5f3d":"markdown","94801c9a":"markdown","970ea864":"markdown","0743d12b":"markdown"},"source":{"f5cf1605":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","77dca55e":"df = pd.read_csv(\"\/kaggle\/input\/chocolate-bar-ratings\/flavors_of_cacao.csv\")\ndf.sample(10)","be970491":"df.columns = [\"Company\", \"Specific Bean Origin or Bar Name\", \"REF\", \"Review Date\", \"Cocoa Percent\", \"Location\", \"Rating\", \"Bean Type\", \"Broad Bean Origin\"]\ndf.sample()","1e4175bf":"df.info()","ee377cbe":"df.sample(10)","a18f7c0b":"list(df['Bean Type'][0:5])","84a1f1ac":"df = df.applymap(lambda x: np.nan if str(x).strip()==\"\\xa0\" else x)\ndf = df.applymap(lambda x: np.nan if str(x).strip()==\"\" else x)","291abbca":"df.info()","0897462b":"df['Bean Type'].value_counts()","59caee67":"df['Bean Type'] = df['Bean Type'].fillna('Trinitario')","925e1921":"df['Bean Type'].value_counts()","f6652edf":"df.drop(['Bean Type'], axis=1, inplace=True)","990fc34a":"df.sample()","75d25b41":"df['Company'].value_counts()","e252f3f2":"top_companies = list(df['Company'].value_counts()[:14].index)\ntop_companies","3d929520":"df['Company'] = df['Company'].apply(lambda x: x if x in top_companies else 'Other')\ndf['Company'].value_counts()","69c8418e":"df.drop(['Company'], axis=1, inplace=True)","b73b3661":"df.sample()","fecc30a1":"df['Cocoa Percent'] = df['Cocoa Percent'].apply(lambda x: float(x.strip('%')) \/ 100.0)","48a16a1f":"df.sample(3)","48e85797":"df['Specific Bean Origin or Bar Name'].value_counts()","ecb7bd96":"df['Broad Bean Origin'].value_counts()","37fa78f8":"df.sample(10)","4c276a47":"df.drop(['Specific Bean Origin or Bar Name'], axis=1, inplace=True)","6bc7500d":"df.sample()","8068a589":"df['Broad Bean Origin'].value_counts()","80908ec8":"top_origin = list(df['Broad Bean Origin'].value_counts()[:14].index)\ntop_origin","8eea74f3":"df['Broad Bean Origin'] = df['Broad Bean Origin'].apply(lambda x: x if x in top_origin else 'Other')","a49ad23a":"df['Broad Bean Origin'].value_counts()","7d8eacd6":"df[df['Cocoa Percent']<0.7].sample(10)","ba12bfbe":"df['Chocolate Type'] = df['Cocoa Percent'].apply(lambda x: 'dark' if x>=0.7 else 'normal' if x>0.0 else 'white')","b366bf27":"df['Chocolate Type'].value_counts()","7872b414":"df.info()","b04eb830":"# Lising top 10 countries\nlist(df['Location'].value_counts()[:10].index)","38db393f":"asia = ['Japan', 'Vietnam', 'Israel', 'South Korea', 'Singapore', 'India', 'Philippines', 'Russia']\nafrica = ['Madagascar', 'Sao Tome', 'South Africa', 'Ghana']\nnorth_america = ['U.S.A.', 'Canada', 'Martinique', 'Niacragua', 'Guatemala', 'St. Lucia', 'Puerto Rico', 'Mexico', 'Costa Rica', 'Honduras', 'Nicaragua', 'Domincan Republic', ]\nsouth_america = ['Ecuador', 'Eucador', 'Colombia', 'Suriname', 'Bolivia', 'Venezuela', 'Chile', 'Peru', 'Brazil', 'Argentina', 'Lithuania']\neurope = ['France', 'Denmark', 'Scotland', 'Wales', 'Czech Republic', 'Finland', 'Ireland', 'Portugal', 'Netherlands', 'Poland', 'Amsterdam', 'Sweden', 'U.K.', 'Italy', 'Belgium', 'Switzerland', 'Germany', 'Austria', 'Spain', 'Hungary', ]\noceania = ['Australia', 'New Zealand', 'Fiji']","afd26815":"def continents(x):\n    if x in asia:\n        return 'asia'\n    if x in africa:\n        return 'africa'\n    if x in north_america:\n        return 'north america'\n    if x in south_america:\n        return 'south america'\n    if x in europe:\n        return 'europe'\n    if x in oceania:\n        return 'oceania'\n    return 'europe'","adcfeb22":"df['Continent'] = df['Location'].apply(continents)","ec694d8a":"df.sample(5)","87a2741e":"df.drop(['Location'], axis=1, inplace=True)","a6ae4c01":"df.sample()","e4204bcb":"df['Continent'].value_counts()","7d01ba5a":"df.info()","ac6d7351":"df.drop(['REF'], axis=1, inplace=True)","592705aa":"df.sample()","95dfb1a1":"df['Continent'] = pd.Categorical(df['Continent'])\ndf['Broad Bean Origin'] = pd.Categorical(df['Broad Bean Origin'])\ndf['Chocolate Type'] = pd.Categorical(df['Chocolate Type'])","eceb9338":"df.info()","f8851a4d":"sns.countplot(x='Chocolate Type', data=df)","3bd71941":"plt.figure(figsize=(15,8))\nsns.lineplot(x='Cocoa Percent', y='Rating', data=df)","8e63e588":"sns.relplot(x=\"Review Date\", y=\"Rating\", size=\"Cocoa Percent\", sizes=(15, 200), data=df);","246c7afc":"sns.relplot(x=\"Review Date\", y=\"Rating\", hue=\"Chocolate Type\", kind=\"line\", data=df);","f4d32f7a":"sns.countplot(x='Continent', data=df)","b6b8f3e2":"plt.figure(figsize=(20,8))\nsns.countplot(x='Broad Bean Origin', data=df)","35bd88d4":"plt.figure(figsize=(20,8))\nsns.lineplot(y='Rating', x='Broad Bean Origin', data=df)","e375da67":"cat_columns = df.select_dtypes(['category']).columns\ncat_columns","715827da":"df[cat_columns] = df[cat_columns].apply(lambda x: x.cat.codes)\ndf.sample(5)","0a6b4f44":"plt.figure(figsize=(10,10))\nsns.heatmap(df.corr(), linewidths=0.1, vmax=1.0, square=True, cmap='coolwarm', linecolor='white', annot=True).set_title(\"Correlation Map\")","534d3d03":"Here we can see that there aren't many null values in out dataset.","69805e4d":"But now if we see, `Trinitario` is a little too much (as there were a lot of null values) and might end up affecting the results. Therefore, we will drop the whole column.","d8b5410a":"Now let's see the `Specific Bean Origin or Bar Name` column and the `Broad Bean Origin` column.","ae50bcb5":"Here we can see the two columns are very similar. Therefore, we can drop `Specific Bean Origin or Bar Name`.","adb7bbc2":"In this plot we can see that beans from all of the origins are more or less equally liked.","d59e3a13":"Now let's convert the data type of the string columns into categorical data type.","1a3ca4be":"Consider upvoting :)","d3ef0999":"Now we can see that there are a lot of missing values in `Bean Type`.","e1866522":"# Setting up the environment","5e6dba41":"According to this plot, we can see majority of the people do not like the extreme types of chocolate (i.e. too dark or too light). The *sweet spot* is around 60%-70%. ","70286ca9":"Now let's convert the `Cocoa Percent` to *float*.","524d8f67":"Let's clean that.","3bbfe80a":"Again, we have 2 options:\n1. Group the companies based on some other metric\n2. Drop the column","dda89b1e":"We can even group the `Location` column into continents.","d1125fd6":"# EDA\nTypes of chocolates reviewed","daab3a86":"The heavier dots are the bottom of the rating chart for almost all of the years","f308166f":"Great!","88ac0be0":"*Maybe other types aren't really chocolates... just saying :)*","55625dbc":"Let's check the top 14 companies.","137ad097":"Let's get some info about our dataset.","0fcb3faa":"We have the same problem as `Bean Type`. Therefore, let's drop this column too.","0c67a809":"Here we can see people don't like very dark chocolates :\/","e84a1eaf":"We can see `Company` has 416 different classes.","c02e8209":"*You see what I did there... **Sweet spot**... hehe*","5b8298ef":"# Cleaning the data\nTo make it easy for us to refer the columns, I'm renaming them.","e615bd83":"# About the dataset\n## Context\nChocolate is one of the most popular candies in the world. Each year, residents of the United States collectively eat more than 2.8 billions pounds. However, not all chocolate bars are created equal! This dataset contains expert ratings of over 1,700 individual chocolate bars, along with information on their regional origin, percentage of cocoa, the variety of chocolate bean used and where the beans were grown.\n### Flavors of Cacao Rating System:\n- 5= Elite (Transcending beyond the ordinary limits)\n- 4= Premium (Superior flavor development, character and style)\n- 3= Satisfactory(3.0) to praiseworthy(3.75) (well made with special qualities)\n- 2= Disappointing (Passable but contains at least one significant flaw)\n- 1= Unpleasant (mostly unpalatable)\n\n\n\n![Photo by <a href=\"https:\/\/unsplash.com\/@foodess?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText\">Food Photographer | Jennifer Pallian<\/a> on <a href=\"https:\/\/unsplash.com\/s\/photos\/chocolate?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText\">Unsplash<\/a>\n  ](https:\/\/images.unsplash.com\/photo-1481391319762-47dff72954d9?ixlib=rb-1.2.1&q=80&fm=jpg&crop=entropy&cs=tinysrgb&dl=food-photographer-jennifer-pallian-dcPNZeSY3yk-unsplash.jpg)\n<br \/>\n\nEach chocolate is evaluated from a combination of both objective qualities and subjective interpretation. A rating here only represents an experience with one bar from one batch. Batch numbers, vintages and review dates are included in the database when known.\n\nThe database is narrowly focused on plain dark chocolate with an aim of appreciating the flavors of the cacao when made into chocolate. The ratings do not reflect health benefits, social missions, or organic status.\n\n**Flavor** is the most important component of the Flavors of Cacao ratings. Diversity, balance, intensity and purity of flavors are all considered. It is possible for a straight forward single note chocolate to rate as high as a complex flavor profile that changes throughout. Genetics, terroir, post harvest techniques, processing and storage can all be discussed when considering the flavor component.\n\n**Texture** has a great impact on the overall experience and it is also possible for texture related issues to impact flavor. It is a good way to evaluate the makers vision, attention to detail and level of proficiency.\n\n**Aftermelt** is the experience after the chocolate has melted. Higher quality chocolate will linger and be long lasting and enjoyable. Since the aftermelt is the last impression you get from the chocolate, it receives equal importance in the overall rating.\n\nOverall Opinion is really where the ratings reflect a subjective opinion. Ideally it is my evaluation of whether or not the components above worked together and an opinion on the flavor development, character and style. It is also here where each chocolate can usually be summarized by the most prominent impressions that you would remember about each chocolate.","c7da27ba":"Let's reduce the number of classes in this column.","6fa96920":"But in this sample we can see that there are a lot of blanks in the `Bean Type` column.","181d15cb":"Nice!","b0aa24a5":"Peace.","e8b1b560":"Now, let's drop the `REF` column as it is of no use to us.","3a66f8f3":"# Feature Generation\nWe can classify the chocolates into `Dark`, `Normal` and `White` chocolates.","ab53ab9d":"Now, let's analyze the `Company` column.","eb730c51":"Here we can see, the liking for dark chocolates have increased over the years whereas for the other, it's the same.","20608d85":"Maybe, we can group the rest of the companies as `Other`.","cc6a9c71":"Awesome!","4b43bd97":"Let's try method 1.","dfe9123d":"If we see this graph, we can make out that this dataset is not very diversed and could be biased towards the European's and the North American's likings.","247c5f3d":"We can see that a lot more dark chocolates are reviewed.","94801c9a":"Cool!","970ea864":"We have two options here:\n1. Fill all of the null values with the mode value (`Trinitario`)\n2. Drop the column","0743d12b":"If we exclude others, we can see that most of the `Broad Bean Origin` is in *Venezuela*."}}