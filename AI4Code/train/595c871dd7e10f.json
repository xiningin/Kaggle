{"cell_type":{"4e351a48":"code","11d11d76":"code","91295c32":"code","6b6033c3":"code","edf86c70":"code","5fdb3c8e":"code","f6ccc6c6":"code","5232dd8e":"code","cbb52bcc":"code","87f2fe0e":"code","704f6f63":"code","9f9aed40":"code","8fc14f39":"code","2af82b0b":"code","102031f3":"code","ab79160f":"code","fc49cbcf":"code","44853f88":"markdown","0300b70d":"markdown","d86fedfc":"markdown","2fc16942":"markdown","10b7bf22":"markdown","237057bd":"markdown","34d7a6e6":"markdown","fefd8cf2":"markdown","5cf5825e":"markdown","f65bfe18":"markdown","74bc70c8":"markdown","8a49a3c2":"markdown","41a60d7b":"markdown","29455d20":"markdown","4f58ae80":"markdown","927ed503":"markdown","755761a3":"markdown","c3bf2e7b":"markdown","52976837":"markdown","d274288a":"markdown","509b7b45":"markdown","f719ff3c":"markdown","ad71d50f":"markdown"},"source":{"4e351a48":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.tree import export_graphviz\nimport graphviz\nfrom sklearn.model_selection import train_test_split \nfrom sklearn.metrics import confusion_matrix\nfrom sklearn.naive_bayes import GaussianNB\nfrom keras.models import Sequential\nfrom keras.layers.core import Dense\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","11d11d76":"data=pd.read_csv(\"..\/input\/heart-disease-uci\/heart.csv\")\ndata.describe()","91295c32":"fig, axs = plt.subplots(2, 3, figsize = (15,10))\naxs[0, 0].hist(data[\"age\"], bins=60, alpha=1, edgecolor = 'black',  linewidth=1)\naxs[0, 0].set_title('Edades')\naxs[0, 1].hist(data[\"trestbps\"], bins=60, alpha=1, edgecolor = 'black',  linewidth=1)\naxs[0, 1].set_title('Presi\u00f3n en reposo')\naxs[0, 2].hist(data[\"chol\"], bins=60, alpha=1, edgecolor = 'black',  linewidth=1)\naxs[0, 2].set_title('Colesterol serico')\naxs[1, 0].hist(data[\"thalach\"], bins=60, alpha=1, edgecolor = 'black',  linewidth=1)\naxs[1, 0].set_title('Frecuencia cardiaca max')\naxs[1, 1].hist(data[\"oldpeak\"], bins=60, alpha=1, edgecolor = 'black',  linewidth=1)\naxs[1, 1].set_title('Depresi\u00f3n inducida por ejercicio')\n\nplt.show()","6b6033c3":"labels1 ='Hombre','Mujer'\nlabels2 = '0','2','1','3'\nlabels3 = 'Si','No'\nlabels4 = '1','0','2'\nlabels5 = 'No','Si'\nlabels6 = '2','1','0'\nlabels7 = '0','1','2','3','4'\nlabels8 = '2','3','1','0'\nlabels9 = 'Si','No'\n\nfig, axs = plt.subplots(3, 3, figsize = (10,10))\naxs[0, 0].pie(data[\"sex\"].value_counts(),labels=labels1, autopct='%1.1f%%', shadow=True)\naxs[0, 0].set_title('Sexo')\naxs[0, 1].pie(data[\"cp\"].value_counts(),labels=labels2, autopct='%1.1f%%', shadow=True)\naxs[0, 1].set_title('Tipo de dolor de pecho')\naxs[0, 2].pie(data[\"fbs\"].value_counts(),labels=labels3, autopct='%1.1f%%', shadow=True)\naxs[0, 2].set_title('Glucosa > 120')\naxs[1, 0].pie(data[\"restecg\"].value_counts(),labels=labels4, autopct='%1.1f%%', shadow=True)\naxs[1, 0].set_title('Electro en reposo')\naxs[1, 1].pie(data[\"exang\"].value_counts(),labels=labels5, autopct='%1.1f%%', shadow=True)\naxs[1, 1].set_title('Angina por ejercicio')\naxs[1, 2].pie(data[\"slope\"].value_counts(),labels=labels6, autopct='%1.1f%%', shadow=True)\naxs[1, 2].set_title('Pendiente del segmento de pico')\naxs[2, 0].pie(data[\"ca\"].value_counts(),labels=labels7, autopct='%1.1f%%', shadow=True)\naxs[2, 0].set_title('Vasos ppals pintados por flourosop\u00eda')\naxs[2, 1].pie(data[\"thal\"].value_counts(),labels=labels8, autopct='%1.1f%%', shadow=True)\naxs[2, 1].set_title('Thal')\naxs[2, 2].pie(data[\"target\"].value_counts(),labels=labels9, autopct='%1.1f%%', shadow=True)\naxs[2, 2].set_title('Ataque al corazon')\n\nplt.show()\n","edf86c70":"atributos = data[[\"age\",\"sex\",\"cp\",\"trestbps\",\"chol\",\"fbs\",\"restecg\",\"thalach\",\"exang\",\"oldpeak\",\"slope\",\"ca\",\"thal\"]].values\ntarget = data[\"target\"].values\n\nX_entrenamiento,X_test,y_entrenamiento,y_test = train_test_split(atributos,target,test_size=0.2)","5fdb3c8e":"arbol1 = DecisionTreeClassifier()\narbol1.fit(X_entrenamiento,y_entrenamiento)\n\nprint(\"Score del entrenamiento\")\nprint(arbol1.score(X_entrenamiento,y_entrenamiento))\nprint(\"Score del test\")\nprint(arbol1.score(X_test,y_test))","f6ccc6c6":"features=[\"age\",\"sex\",\"cp\",\"trestbps\",\"chol\",\"fbs\",\"restecg\",\"thalach\",\"exang\",\"oldpeak\",\"slope\",\"ca\",\"thal\"]\nexport_graphviz(arbol1,out_file='arbol1.dot',class_names='target', feature_names=features, impurity=False, filled=True)\nwith open('arbol1.dot') as f:\n    dot_graph=f.read()\ngraphviz.Source(dot_graph)","5232dd8e":"carac = data.shape[1]\n\nfor i in range(13):\n    print(features[i],\": \",arbol1.feature_importances_[i]*100)","cbb52bcc":"arbol2 = DecisionTreeClassifier(criterion= \"entropy\",max_depth=6, min_samples_split = 15)\narbol2.fit(X_entrenamiento,y_entrenamiento)\n\nprint(\"Score del entrenamiento\")\nprint(arbol2.score(X_entrenamiento,y_entrenamiento))\nprint(\"Score del test\")\nprint(arbol2.score(X_test,y_test))","87f2fe0e":"export_graphviz(arbol2,out_file='arbol2.dot',class_names='target', feature_names=features, impurity=False, filled=True)\n\nwith open('arbol2.dot') as f:\n    dot_graph=f.read()\ngraphviz.Source(dot_graph)","704f6f63":"carac = data.shape[1]\nfor i in range(13):\n    print(features[i],\": \",arbol2.feature_importances_[i]*100)\n","9f9aed40":"print(\"Matriz de confusi\u00f3n\")\nprint(confusion_matrix(arbol2.predict(X_test), y_test))","8fc14f39":"bayes = GaussianNB()\nbayes.fit(X_entrenamiento,y_entrenamiento)\n\nprint(\"Score del test\")\nprint(bayes.score(X_test,y_test))\nprint(\"Score del entrenamiento\")\nprint(bayes.score(X_entrenamiento,y_entrenamiento))","2af82b0b":"print(\"Matriz de confusi\u00f3n\")\nprint(confusion_matrix(bayes.predict(X_test), y_test))","102031f3":"red = Sequential()\nred.add(Dense(16, input_dim=13, activation='sigmoid'))\nred.add(Dense(14, activation='relu'))\nred.add(Dense(1, activation='sigmoid'))\n\nred.compile(loss='mean_squared_error',\n              optimizer='adam',\n              metrics=['binary_accuracy'])\n\nred.fit(X_entrenamiento, y_entrenamiento, epochs=1000)\n\nscoreT = red.evaluate(X_test, y_test)\nscoreE = red.evaluate(X_entrenamiento, y_entrenamiento)\n\nprint(\"Score del test\")\nprint(\"%s: %.2f%%\" % (red.metrics_names[1], scoreT[1]*100))\nprint(\"Score del entrenamiento\")\nprint(\"%s: %.2f%%\" % (red.metrics_names[1], scoreE[1]*100))\n","ab79160f":"for layer in red.layers:\n    g=layer.get_config()\n    h=layer.get_weights()\n    print ('Weights of layer: ',h)","fc49cbcf":"print(\"Matriz de confusi\u00f3n\")\nprint(confusion_matrix(red.predict_classes(X_test), y_test))","44853f88":"------------------------------------------------------------MODELO DE \u00c1RBOL DE DECISI\u00d3N------------------------------------------------------------","0300b70d":"Analizando los resultados de implementar un modelo de \u00e1rbol de decisi\u00f3n vemos que si realizamos una prueba sobre el conjunto de datos de entrenamiento la precisi\u00f3n de la predicci\u00f3n es del 100%, lo cual no es bueno pues sabemos que se esta presentando un sobreajuste de los datos, esto lo que quiere decir es que la funci\u00f3n que hall\u00f3 el algoritmo se ajusta perfectamente a esos datos o a esas caracteristicas especificas, por lo que cuando recibe datos que no corresponden al conjunto de entrenamiento no genera una buena predicci\u00f3n; Esto se puede ver evidenciado al notar que la precisi\u00f3n con el conjunto de prueba es del 74%.\n","d86fedfc":"Imprimir las variables categoricas","2fc16942":"Al observar el arbol generado con este segundo modelo vemos que los parametros asignados al modelo han sido tenidos en cuenta,viendo como la profundidad m\u00e1xima del arbol es de 6 y viendo como los ejemplos con menos de 15 ejemplos no fueron divididos con el fin de generar m\u00e1s ramas dentro del arbol.  ","10b7bf22":"Luego de haber ajustado los parametros anteriormente mencionados, notamos que en algunos casos mejoran las precisiones tanto en con el conjunto de entrenamiento como con el conjunto de prueba. La precesi\u00f3n del conjunto de entrenamiento baja hasta valores entre 70% y 90% gracias a lo cual podriamos inferir que el problema de sobreajuste ha sido mejorado; sin embargo esto no necesariamente influye a una buena predicci\u00f3n dados los datos del conjunto de prueba, llegando a oscilar la precisi\u00f3n de estos entre el 65% y el 86%,teniendo asi que no en todos los casos se garantiza una buena predicci\u00f3n.","237057bd":"Lo que hacemos a continuaci\u00f3n es asignar la variable \"data\" como un DataFrame de pandas en el cual estan los datos de prueba a ser usados a lo largo del proyecto. \nAdicionalmente, se imprime una descripci\u00f3n de este conjunto de datos, \n","34d7a6e6":"---------------------------------------------------------------------REDES NEURONALES-------------------------------------------------------------------","fefd8cf2":"Para el modelo con redes neuronales se utilizo la libreria keras la cual ayuda a la creaci\u00f3n de este ipo de algoritmos. \nInicialmente podemos decir que nuestra red neuronal posee 4 capas que poseen la siguiente distribuci\u00f3n: La capa de entrada, dos capas ocultas y la capa de salida. La  primera capa al ser la capa de caracteristicas o el conjunto de entrada tiene 13 nodos. luego de esto las dos capas siguientes tienen 16 nodos cada una, sin embargo se diferencian en que la primera de estas dos capas cuenta con una funci\u00f3n de activaci\u00f3n Rectificador o (relu) la segunda de estas capas posee una funci\u00f3n de activaci\u00f3n \"Sigmoide\", luego de que los datos han pasado por estas tres capas deben llegar a la capa de salida. \n\nUna caracteristica importante es la cantidad de epochs o de iteraci\u00f3nes que realizar\u00e1 la red neuronal para obtener la funci\u00f3n de predicci\u00f3n adecuada o mejor dicho, los pesos bajo los cuales son enviados los parametros de entrada. Nosotros configuramos 1000 iteraciones gracias a que con esta cantidad el modelo ofrece una buena precisi\u00f3n, contrario a lo que suced\u00eda si colocabamos 100 o 200 iteraciones pues las precisiones no eran las adecuadas.","5cf5825e":"Por medio de varias ejecuciones del \u00e1rbol de decisi\u00f3n, se pudo ver que las caracter\u00edsticas del conjunto de datos a las cuales m\u00e1s se le dieron importancia para evaluar si un paciente padece o no una enfermedad del coraz\u00f3n, fueron el tipo de dolor de pecho(cp) y la cantidad de vasos coloreados en la flouroscopia(ca) mientras que la cantidad de glucosa en la sangre es la caracter\u00edstica menos influyente en la toma de decisiones.\n\n\nPara tratar de solucionar el problema de sobre ajuste lo que hicimos fue cambiar los par\u00e1metros del \u00e1rbol de decisi\u00f3n de tal manera que pueda generar un buen modelo. Los par\u00e1metros cambiados fueron la profundidad m\u00e1xima del \u00e1rbol, a la cual le asignamos un valor de 6, y el numero m\u00ednimo de ejemplos que debe cumplir una determinada condici\u00f3n para que el \u00e1rbol efectu\u00e9 una divisi\u00f3n, se le asigno un valor de 15.\n\n\nLos resultados de implementar el modelo mencionado pueden ser vistos a continuaci\u00f3n:","f65bfe18":"A continuaci\u00f3n se describe que significa cada sigla del conjunto de caracteristicas que pueden influir en la predicci\u00f3n de una enfermedad del coraz\u00f3n.\n\n* age: Edad del paciente\n* sex: Sexo del paciente (1 si es hombre, 0 si es mujer)\n* cp: Es el tipo de dolor de pecho que presenta el paciente, este puede ser de 4 tipos por lo que los valores que pueden tomar son [0,1,2,3]\n* trestbps: Esta caracteristica representa la presi\u00f3n arterial en reposo\n* chol: Esta caracteristica representa el colesterol serico medido en mg\/dl\n* fbs: Es un valor que es 1 si la cantidad de glucosa en la sangre supera los 120  y 0 si no lo hace\n* restecg: Este valor representa los resultados de un electrocardiograma hecho en reposo aplicado al paciente, el cual se clasifica en 3 grupos.  \n* thalach: Este valor es la medida de la frecuencia cardiaca maxima alcanzada por el paciente\n* exang: Es te valor es 1 si el paciente presenta angina inducida por el ejercicio, y 0 si no es as\u00ed\n* oldpeak: Este valor representa la depresi\u00f3n ST inducida por ejercicio relativo al descanso\n* slope: Este valor representa la pendiente del segmento de pico de ejercicio ST\n* ca: Este valor representa cuantos vasos principales fueron coloreados por fluorosop\u00eda\n* thal: thal\n\nClasificando estas caracteristicas en numericas y categoricas obtenemos los dos grupos asi:\n1. Num\u00e9ricas: age, trestbps, chol, thalach, oldpeak\n2. Categoricas: sex, cp, fbs, restecg, exang, slope, ca, thal\n\nA las variables categoricas se le a\u00f1ade la caracteristica \"target\" el cual es la caracteristica objetivo la cual es 1 si el resultado de la clasificaci\u00f3n es positivo para una enfermedad cardiaca y 0 si el resultado es negativo\n\nA continuaci\u00f3n se grafican los datos correpsondientes a cada una de estas caracteriticas obtenidos del Dataset. Las variables num\u00e9ricas se represnetan por medio de histogramas y las variables categoricas por medio de diagramas circulares","74bc70c8":"Ahora obteniendo las importancias dadas a las caracteristicas presentan algunos cambios, como por ejemplo,vemos como la cantidad de glucosa en la sangre no influye en la decisi\u00f3n tomada por el algoritmo tal como sucedia con el primer modelo. Se le suma a las caracteristicas poco influyentes el electrocardiograma en reposo (trestbps) y los resultados clasificados de haber hecho el electrocardiograma en reposo(restecg). Por otra parte las caracteristicas m\u00e1s influyentes son el (thal) con un 30% de importancia, le sigue el dolor de pecho y finalmete el numero de vasos coloreados con fluorosop\u00eda. ","8a49a3c2":"---------------------------------------------------------------------MODELO BAYESIANO-------------------------------------------------------------------","41a60d7b":"Para este modelo se intenta clasificar si dadas unas caracter\u00edsticas corresponden o no a una enfermedad del coraz\u00f3n, utilizando como suposici\u00f3n que los datos son mutuamente excluyentes entre si, es decir que cada caracter\u00edstica no influye probabil\u00edsticamente en que ocurra ninguna de las otras, y ademas de esto se usa una distribuci\u00f3n gaussiana como suposici\u00f3n para el modelo de datos.","29455d20":"** Conclusiones **\n\n\nComo conclusi\u00f3n de los tres modelos podemos decir que el \u00e1rbol de decisiones es bastante susceptible a sufrir un sobreajuste dependiendo de el tipo de configuraci\u00f3n que se le haya pasado como parametro, adem\u00e1s de que est\u00e9 al ajustars tiende a ce\u00f1irse bastante al conjunto de datos de entrenamiento y consecuentemete no tener el mismo nivel de precisi\u00f3n al clasificar cuando se le cambia el conjunto de datos. El modelo bayesiano es m\u00e1s preciso a la hora de entrenarse con un conjunto de datos, esto lo podemos evidenciar relacionando el puntaje obtenido del conjunto de datos de entrenamiento y el conjunto de datos de prueba, sin embargo este modelo supone que todas las caracteristicas son mutuamente excluyentes, obviando asi las posibles correlaciones entre estas, como por ejemplo la edad que probabil\u00edsticamente est\u00e1 relacionada con la angina inducida por ejercicio, lo cual causa que haya un factor de probabilidad que no s\u00e9 est\u00e1 teniendo en cuenta. Finalmente el modelo de redes neuronales, es el que m\u00e1s nos resulta \u00fatil a la hora de dar una clasificaci\u00f3n a los resultados, dado que el puntaje que se obtiene para el conjunto de datos de entrenamiento, no es susceptible a una sobre estimaci\u00f3n f\u00e1cilmente y no tiene el problema probabil\u00edstico que se le da a el modelo de bayes.\n\nAdem\u00e1s de esto podemos ver que un modelo es aceptable dada su matriz de confusi\u00f3n observando si su matriz es diagonalmente dominante, dado que esta indica el n\u00famero de clasificaciones correctas que realiz\u00f3 el modelo de clasificaci\u00f3n.\n\n\n\n","4f58ae80":"* Proyecto 2 de Inteligencia Artificial\n\nIntegrantes: \n* Steban Cadena Girldo - 1670129\n* Daniel Diaz - 1629338\n* Liliana Narvaez - 1530302\n* Bryan Bioj\u00f3 - 1629366\n","927ed503":"Inicialmente se importan las librerias necesarias para realizar poder implementar los diferentes modelos de machine learning","755761a3":"En la imagen mostrada anteriormente podemos observar cual es la estructura del \u00e1rbol para realizar la clasificaci\u00f3n dadas la caracteristicas, cuya profundidad es 10 y tiene un total de 41 nodos hoja; Posterior al diagrama del \u00e1rbol se muestran las importancias dadas a cada caracteristica\n","c3bf2e7b":"A continuaci\u00f3n, se imprime la matriz de confusi\u00f3n del modelo \u00e1rbol de decisi\u00f3n. Esta matriz nos permite conocer el numero de aciertos que obtuvo el algoritmo y asi poder analizar si lo consideramos un buen modelo o no","52976837":"Como podemos ver en los resultados anteriores, en cada iteraci\u00f3n el modelo de la red neuronal va ajustando los pesos de tal manera que se maximice el nivel de precisi\u00f3n que tiene la misma para clasificar los datos.","d274288a":"--------------------------------------------------------------------CARACTERISTICAS--------------------------------------------------------------------","509b7b45":"Se imprime la matriz de confusi\u00f3n del modelo bayesiano","f719ff3c":"![](http:\/\/)El paso a seguir es dividir nuestro conjunto de datos en 2, el conjunto de datos de entrenamiento y el conjunto de pruebas, para ellos se hace uso de la funci\u00f3n \"train_test_split\" con la cual le daremos ","ad71d50f":"Inicialmente vamos a definir un modelo de \u00e1rbol de decisi\u00f3n sin parametros de entrada para observar el resultado obtenido. Adicional a eso vamos a imprimir el \u00e1rbol obtenido para ver cuales fueron sus criterios de selecci\u00f3n."}}