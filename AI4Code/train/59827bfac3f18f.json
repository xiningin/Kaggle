{"cell_type":{"908ea828":"code","3cc5b9e6":"code","94348dd7":"code","c46da260":"code","a3252667":"code","b63c00a0":"code","fdafe982":"code","f97d91aa":"code","652d99ae":"code","b85593d3":"code","e76bb00e":"code","44fb963a":"code","9db027e0":"code","0c9df6bb":"code","7049824a":"code","c11e2a7f":"code","be043316":"code","ce4a21fa":"code","4a837a5a":"code","6a41c80e":"code","f4a7c082":"code","b7df1868":"code","6ff63733":"code","ddcd1a51":"code","07eb18d5":"markdown","dc2a4022":"markdown","82870283":"markdown","9fcb1412":"markdown","db212e20":"markdown","3a8a9d0f":"markdown","d6bcf45e":"markdown","afcceb8b":"markdown","9b4bffdd":"markdown","715077b0":"markdown","d7e894df":"markdown","35aa5bb8":"markdown","5c2ea384":"markdown","03598cd0":"markdown","f84de244":"markdown","7d27e7a4":"markdown","6b69527c":"markdown","25e47e0d":"markdown","2b279f3b":"markdown"},"source":{"908ea828":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","3cc5b9e6":"import tensorflow as tf\nfrom tensorflow.keras.models import Sequential\nfrom tensorflow.keras.layers import Dense,Conv2D,Flatten,MaxPooling2D,Dropout,BatchNormalization\nimport matplotlib.pyplot as plt \nimport seaborn as sns","94348dd7":"filepath_train = \"\/kaggle\/input\/digit-recognizer\/train.csv\"\nfilepath_test = \"\/kaggle\/input\/digit-recognizer\/test.csv\"","c46da260":"df = pd.read_csv(filepath_train)\ndf.head()","a3252667":"df.shape","b63c00a0":"df.isnull().sum().sort_values(ascending = False) ","fdafe982":"df_test = pd.read_csv(filepath_test)\ndf_test.shape","f97d91aa":"X_train,y_train = np.asarray(df.drop('label',axis= 1)), np.asarray(df.loc[:,'label'])","652d99ae":"print(X_train.shape, y_train.shape)","b85593d3":"X_test = np.asarray(df_test)","e76bb00e":"print(X_test.shape)","44fb963a":"plt.figure(figsize = (20,15))\n\nplt.xticks(size=15)\nsns.countplot(y_train,linewidth = 3,edgecolor=sns.color_palette())\nplt.title('Distribution of labels in the train dataset', fontdict={'color' : 'Black' , 'fontsize' : 30})\n\nplt.show()","9db027e0":"print(\"Before Reshaping : \")\nprint(\"Shape of X_train :\" ,X_train.shape)\nprint(\"Shape of y_train :\" ,y_train.shape)\nprint(\"Shape of X_test :\" ,X_test.shape)","0c9df6bb":"X_train = X_train.reshape(len(X_train), 28,28,1)\nX_test = X_test.reshape(len(X_test), 28,28,1)\n\ny_train = tf.keras.utils.to_categorical(y_train)","7049824a":"print(\"After Reshaping : \")\nprint(\"Shape of X_train :\" ,X_train.shape)\nprint(\"Shape of y_train :\" ,y_train.shape)\nprint(\"Shape of X_test :\" ,X_test.shape)","c11e2a7f":"L = 5\nW = 5\nfig, axes = plt.subplots(L, W, figsize = (15,15))\naxes = axes.ravel()\n\nfor i in range(0, L * W):  \n    axes[i].imshow(X_train[i],cmap='gray')\n    axes[i].set_title(\"Digit = \"+str(i))\n    axes[i].axis('off')\nplt.subplots_adjust(wspace=0.5)","be043316":"def get_model(input_shape):\n    model = Sequential()\n    model.add(Conv2D(filters = 16,kernel_size = (3,3),activation = 'relu',input_shape = input_shape))\n    model.add(BatchNormalization())\n\n    model.add(Conv2D(filters = 32,kernel_size = (3,3),activation = 'relu'))\n    model.add(BatchNormalization())\n    model.add(MaxPooling2D((2,2)))\n    # model.add(Dropout(0.2))\n\n    model.add(Conv2D(filters = 128,kernel_size = (3,3),activation = 'relu'))\n    model.add(BatchNormalization())\n    model.add(MaxPooling2D((2,2)))\n    # model.add(Dropout(0.2))\n\n    model.add(Conv2D(filters = 256,kernel_size = (3,3),activation = 'relu'))\n    model.add(MaxPooling2D((2,2)))\n    \n    model.add(Flatten())\n    model.add(Dense(128, activation='relu'))\n    model.add(Dense(64, activation='relu'))\n    model.add(Dense(10,activation='softmax')) \n    \n    return model","ce4a21fa":"model = get_model(input_shape = (28,28,1))\nmodel.summary()","4a837a5a":"model.compile(optimizer='adam',metrics = ['accuracy'],loss = 'categorical_crossentropy')\nhistory = model.fit( X_train, y_train, batch_size = 300  , epochs = 30)","6a41c80e":"#Visualizing the training performance\nplt.figure(figsize=(6, 4))\n\nplt.subplot(1, 2, 1)\nplt.title('Loss')\nplt.plot(history.history['loss'], label='Loss')\nplt.legend()\nplt.grid()\n\nplt.subplot(1, 2, 2)\nplt.title('Accuracy')\nplt.plot(history.history['accuracy'], label='accuracy')\nplt.legend()\nplt.grid()\n","f4a7c082":"predictions = model.predict(X_test)","b7df1868":"results = np.argmax(predictions, axis= 1)","6ff63733":"results = pd.Series(results, name=\"Label\")\nresults.head()","ddcd1a51":"submission = pd.concat([pd.Series(range(1,28001),name = \"ImageId\"),results],axis = 1)\nsubmission.to_csv(\"submission.csv\", index=False)","07eb18d5":"**Data has been reshaped and it can be seen that train data is of 42000 examples\/images of size 28* 28 and labels are one hot encoded and hence shape changed form (42000,1) to (42000,10).**","dc2a4022":"**Training Data has 42000 examples of images of digits**","82870283":"**Please like and comment if you find this useful, Thanks!!!**","9fcb1412":"**Importing Libraries**","db212e20":"**42000 images (28* 28) and 42000 labels : 1 corresponding to each**","3a8a9d0f":"**Exploring The Dataset**\nData consists of two csv files i.e train and test","d6bcf45e":"**No Null Values here**","afcceb8b":"**There are nearly equal examples of each label(i.e digits from 0 to 9) , hence data is balanced.**","9b4bffdd":"**Model is converging satisfactorily , let's make predictions on test set**","715077b0":"**Visualising the images**","d7e894df":"**As we have discussed so far, image pixel values are in the form of columns, we have to reshape the values to visualise them as an image. Also apart from visualisation we also have to feed the CNN in the form of images(or reshaped 2D matrices)** ","35aa5bb8":"**Test data is now array of 28000 examples and 784 pixels(28* 28) per image**","5c2ea384":"**Every row of data corresponds to an example , which is having 784 pixel values(columns from 0 t0 783)which is a 28*28 array(or image of digit )**","03598cd0":"**test Data has 28000 images of size 784(28*28)**","f84de244":"**Lets check the distribution of data**","7d27e7a4":"**Converting the dataframe into array and seperating train data and labels**","6b69527c":"**Submit this CSV to the competition and lets see where we stand.**","25e47e0d":"### MNIST Digit Recognizer using CNN ###","2b279f3b":"**Perfect!!! , Lets build a simple CNN model.**"}}