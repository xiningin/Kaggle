{"cell_type":{"144d1d8b":"code","9e0cd56b":"code","1bd6bd1f":"code","cb3f3792":"code","b7d934a4":"code","a27db598":"code","82d6c1b2":"code","87ad216e":"code","c9b9cadf":"code","413ee0b2":"code","17bde314":"code","c6c38487":"code","5550df6f":"code","62b02f4d":"code","36772fbf":"code","7ad2849e":"markdown"},"source":{"144d1d8b":"from fastai.vision.all import *\nimport torchvision.models as models\nimport numpy as np\nimport pandas as pd\nimport os","9e0cd56b":"train_df = pd.read_csv(\"..\/input\/hackerearth-deep-learning-challenge-holidayseason\/dataset\/train.csv\")","1bd6bd1f":"train_df.head()","cb3f3792":"dls = ImageDataLoaders.from_df(train_df,path=\"..\/input\/hackerearth-deep-learning-challenge-holidayseason\/dataset\",\n                               folder=\"train\",\n                               label_col=\"Class\",valid_pct=0.2,\n                               item_tfms= Resize(224),\n                               batch_tfms=aug_transforms(),\n                              bs=16)","b7d934a4":"dls.vocab","a27db598":"dls.show_batch()","82d6c1b2":"learn = cnn_learner(dls,models.resnet50,metrics=accuracy,pretrained=True)","87ad216e":"learn.fine_tune(8)","c9b9cadf":"test_path = \"..\/input\/hackerearth-deep-learning-challenge-holidayseason\/dataset\/test\/\"\ntest_images = os.listdir(test_path)","413ee0b2":"test_path = \"..\/input\/hackerearth-deep-learning-challenge-holidayseason\/dataset\/test\/\"\ntest_image_ids = os.listdir(test_path)\ntest_images = [test_path+f\"{img}\" for img in test_image_ids]\npreds = learn.get_preds(dl=dls.test_dl(test_images, shuffle=False, drop_last=False))","17bde314":"preds = preds[0].cpu().numpy()","c6c38487":"from sklearn.preprocessing import LabelEncoder\nlb = LabelEncoder()\ntrain_df[\"Class\"] = lb.fit_transform(train_df.Class)","5550df6f":"pred = lb.inverse_transform((np.argmax(preds,axis=1)))","62b02f4d":"submission = pd.DataFrame()\nsubmission[\"Image\"] = test_image_ids\nsubmission['Class'] = pred\nsubmission.to_csv(\"submission.csv\", index=False)","36772fbf":"submission.head()","7ad2849e":"<h1 style=\"color:red;\">Upvote If This Kernel Helps You<\/h1>"}}