{"cell_type":{"40b15773":"code","dd774982":"code","8833154c":"code","c591b48b":"code","d3a008f6":"code","16297ed6":"code","622810f3":"code","0e17891a":"code","f503d273":"code","7bb6e909":"code","8ed177e7":"code","0a57ce26":"code","0e715037":"code","eb7c9e81":"code","0ebfc284":"code","28df57d9":"code","149ead73":"code","cddba4b6":"code","0b4beb4a":"code","e9404d6b":"code","a4eb48a2":"code","a527815a":"code","8b3a9155":"code","3550c386":"code","52baf7b6":"code","15102e1a":"code","348cc103":"code","ab75f400":"code","e672f4a2":"code","f100dde2":"code","cf6e45fd":"code","0dbdb24f":"code","f83f2c29":"code","a7d7cf74":"code","e7957b39":"code","c16febbc":"code","31f64693":"code","f86a700c":"code","fb47e23c":"code","9ceef59d":"code","f283e01f":"code","6f167509":"code","12036051":"code","521f14b7":"code","7b25a23a":"code","62caa92e":"code","a16fb495":"code","f6725343":"code","90514305":"code","234ee78f":"code","534490de":"code","0c3e9750":"code","bcbb6a23":"code","c6e17541":"code","a0b41386":"code","0df68770":"code","1a0016d3":"code","ff8f03fe":"code","f5cbeae0":"code","c1e2c3ca":"code","2cb1970d":"code","ea8c67c5":"code","f1fe157d":"code","05d32cff":"markdown","0c6d0ec9":"markdown","6f3acdfe":"markdown","0b6159b5":"markdown","981cda1a":"markdown","b609d059":"markdown","fd207646":"markdown","5115c7c1":"markdown","39b2b7bc":"markdown","fb8e0ea9":"markdown","fe7a2168":"markdown","0265daaf":"markdown","249d927b":"markdown","3fdf791f":"markdown","70fd3130":"markdown","7f806e38":"markdown","51082e78":"markdown","7382cecc":"markdown","0ff79fc2":"markdown","2ecf71af":"markdown","ca07da8d":"markdown","b981674c":"markdown","97b3f7f8":"markdown","4189f063":"markdown","f453f4f7":"markdown","0ce227d1":"markdown","21411bae":"markdown","fd7f811a":"markdown"},"source":{"40b15773":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","dd774982":"import warnings\nwarnings.filterwarnings('ignore')","8833154c":"import datetime","c591b48b":"df_weather=pd.read_csv('\/kaggle\/input\/nyc-flights-2013\/nyc_weather.csv')\ndf_airlines=pd.read_csv('\/kaggle\/input\/nyc-flights-2013\/nyc_airlines.csv')\ndf_flights=pd.read_csv('\/kaggle\/input\/nyc-flights-2013\/nyc_flights.csv')\ndf_planes=pd.read_csv('\/kaggle\/input\/nyc-flights-2013\/nyc_planes.csv')\ndf_airports=pd.read_csv('\/kaggle\/input\/nyc-flights-2013\/nyc_airports.csv')","d3a008f6":"df_weather","16297ed6":"df_airlines.head()","622810f3":"df_flights","0e17891a":"df_planes.head()","f503d273":"df_planes['tailnum'].unique()","7bb6e909":"df_airports.head()","8ed177e7":"df1=pd.merge(df_flights, df_planes, on='tailnum', how='left')","0a57ce26":"df1","0e715037":"df1=pd.merge(df1,df_weather,on=['time_hour','origin'],how='left')","eb7c9e81":"pd.set_option('display.max_columns', 50)","0ebfc284":"df1","28df57d9":"df1=df1.drop(['month_y','day_y','hour_y','year'], axis=1)","149ead73":"df1=df1.rename(columns={'year_x': 'year', 'month_x': 'month','hour_x':'hour','day_x':'day','year_y':'year_plane'})","cddba4b6":"df1","0b4beb4a":"df1.isnull().sum()","e9404d6b":"df1=df1.drop(['speed','wind_gust'], axis=1)","a4eb48a2":"df1=df1.dropna(how='any')","a527815a":"d_delay = lambda x: 1 if x > 0 else 0","8b3a9155":"a_delay = lambda x: 1 if x > 0 else 0","3550c386":"df1['d_delay']=df1['dep_delay'].apply(d_delay)","52baf7b6":"df1['a_delay']=df1['arr_delay'].apply(a_delay)","15102e1a":"df1","348cc103":"df1.dtypes","ab75f400":"import matplotlib.pyplot as plt\nimport seaborn as sns","e672f4a2":"plt.figure(figsize=(15, 15))\nsns.heatmap(df1.corr(),annot=True,fmt=\"1.2f\")","f100dde2":"df1['route']=df1['origin'] + '-' + df1['dest']","cf6e45fd":"df1","0dbdb24f":"df1['year']=df1['year'].astype(str)\ndf1['month']=df1['month'].astype(str)\ndf1['day']=df1['day'].astype(str)","f83f2c29":"df1['date']=df1['year']+'-'+df1['month']+'-'+df1['day']","a7d7cf74":"df1['date']=pd.to_datetime(df1['date'],format='%Y-%m-%d')\ndf1['date']=df1['date'].dt.tz_localize(None)","e7957b39":"df1_delay=df1[df1['d_delay']==1]","c16febbc":"df1_delay","31f64693":"df_flightNO=pd.DataFrame(df1.groupby('date')['flight'].count())\ndf_flightDL=pd.DataFrame(df1_delay.groupby('date')['flight'].count())","f86a700c":"y1=df_flightNO['flight']\ny2=df_flightDL['flight']\ny3=y2\/y1*100\ny4=df1_delay.groupby('date')['wind_speed'].mean()","fb47e23c":"fig, ax1 = plt.subplots(figsize=(50,10))\nax2 = ax1.twinx()\nax1.plot(y3,label=\"delay rate\",color='r')\nax2.plot(y4,label=\"wind speed\",color='b')\nax1.legend(loc=1,fontsize=20)\nax2.legend(loc=2,fontsize=20)\n\nplt.show()","9ceef59d":"df1_delay.groupby('route')[('dep_delay','arr_delay')].describe()","f283e01f":"df1_delay.groupby('route')['route'].count().sort_values(ascending=False).head(100).plot.bar(figsize=(25,10))","6f167509":"df1_delay.groupby('route')['dep_delay'].count().sort_values(ascending=False).head(100).plot.bar(figsize=(25,10))","12036051":"df1_delay.groupby('route')[('dep_delay')].mean().sort_values(ascending=False).head(100).plot.bar(figsize=(25,10))","521f14b7":"df1_delay_LT=df1_delay[df1_delay['route']=='LGA-TVC']\nsns.barplot(y=df1_delay_LT['date'],x=df1_delay_LT['dep_delay'])","7b25a23a":"df1_delay_LT.describe()","62caa92e":"df1.describe()","a16fb495":"df2=df1_delay.sort_values('dep_delay',ascending=False).head(200)","f6725343":"plt.figure(figsize=(20, 12))\nplt.legend(fontsize=10)\nplt.tick_params(labelsize=10)\nax=sns.scatterplot(x=df2['route'],y=df2['dep_delay'],hue=df2['carrier'],size=df2['wind_speed'],data=df2,sizes=(1,200))\nplt.xticks(rotation=90)\nax.legend(loc='upper left',bbox_to_anchor=(1,1))","90514305":"plt.figure(figsize=(20, 12))\nplt.legend(fontsize=10)\nplt.tick_params(labelsize=10)\nax=sns.scatterplot(x=df2['route'],y=df2['dep_delay'],hue=df2['carrier'],size=df2['distance'],data=df2,sizes=(1,200))\nplt.xticks(rotation=90)\nax.legend(loc='upper left',bbox_to_anchor=(1,1))","234ee78f":"plt.figure(figsize=(20, 12))\nplt.legend(fontsize=10)\nplt.tick_params(labelsize=10)\nax=sns.scatterplot(x=df2['route'],y=df2['dep_delay'],hue=df2['carrier'],size=df2['year_plane'],data=df2,sizes=(1,200))\nplt.xticks(rotation=90)\nax.legend(loc='upper left',bbox_to_anchor=(1,1))","534490de":"df1_delay.groupby('carrier')['carrier'].count().sort_values(ascending=False).plot.bar(figsize=(25,10))","0c3e9750":"df1_delay.groupby('carrier')['dep_delay'].count().sort_values(ascending=False).plot.bar(figsize=(25,10))","bcbb6a23":"df1_delay.groupby('carrier')['dep_delay'].mean().sort_values(ascending=False).plot.bar(figsize=(25,10))","c6e17541":"df1_delay.groupby('model')['model'].count().sort_values(ascending=False).plot.bar(figsize=(25,10))","a0b41386":"df1_delay.groupby('model')['dep_delay'].count().sort_values(ascending=False).plot.bar(figsize=(25,10))","0df68770":"df1_delay.groupby('model')['dep_delay'].mean().sort_values(ascending=False).plot.bar(figsize=(25,10))","1a0016d3":"df1_delay.groupby('year_plane')['year_plane'].count().sort_values(ascending=False).plot.bar(figsize=(25,10))","ff8f03fe":"df1_delay.groupby('year_plane')['dep_delay'].count().sort_values(ascending=False).plot.bar(figsize=(25,10))","f5cbeae0":"df1_delay.groupby('year_plane')['dep_delay'].mean().sort_values(ascending=False).plot.bar(figsize=(25,10))","c1e2c3ca":"df1_delay.groupby('origin')['origin'].count().sort_values(ascending=False).plot.bar(figsize=(25,10))","2cb1970d":"df1_delay.groupby('origin')['dep_delay'].count().sort_values(ascending=False).plot.bar(figsize=(25,10))","ea8c67c5":"df1_delay.groupby('origin')['dep_delay'].mean().sort_values(ascending=False).plot.bar(figsize=(25,10))","f1fe157d":"df1_delay.groupby('month')[('dep_delay')].count().sort_values(ascending=False).plot.bar(figsize=(10,10))","05d32cff":"# -By carrier and distance","0c6d0ec9":"# 7. Month analysis","6f3acdfe":"# 4) Route LGA-TVC which has the longest average delays","0b6159b5":"# 2) Airplane models which have a lot of delays","981cda1a":"# 1)Depature numbers","b609d059":"# 3)Average delays","fd207646":"# 2)Carriers  which have a lot of delays","5115c7c1":"# 1) Carriers which have a lot of flights","39b2b7bc":"# 3) Airplane models which have longer average delays","fb8e0ea9":"# 2. Route analysis","fe7a2168":"# 5. Airplane age analysis","0265daaf":"# 3. Carrier Analysis","249d927b":"# 1) Top 100 routes which have a lot of flights","3fdf791f":"# 6. Airport analysis","70fd3130":"# 3) Top 100 routes which have longer average delays","7f806e38":"# 5) Multi-factors route analysis-top 200","51082e78":"# -By carrier and wind speed","7382cecc":"# 1.Time Series of 'Delay Rate' and 'Average Wind Speed'","0ff79fc2":"# -By carrier and year_plane","2ecf71af":"# 3)Carriers which have longer average delays","ca07da8d":"# 1) Airplane models which have a  lot of flight","b981674c":"# 2) Top 100 routes which have a lot of delays","97b3f7f8":"# 2) Airplane age which have a lot of delays","4189f063":"# 3)Airplane age which have longer average delays","f453f4f7":"# By comparing between route LGA-TVC and all data, it seems that 'year_plane' average is older in LGA-TVC","0ce227d1":"# 2)Depature delays numbers","21411bae":"# 4. Airplane model analysis","fd7f811a":"# 1) Airplane age which have a lot of flight"}}