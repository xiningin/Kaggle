{"cell_type":{"34daadf6":"code","defd5a59":"code","fb90beed":"code","b51b923c":"code","1ead75d0":"code","32f03cb5":"code","843497ce":"code","fb0fbc58":"code","bf46ec02":"code","8561023e":"code","25fd6e7e":"code","e45f4247":"code","dbdf385f":"code","73708d2d":"code","882f5f5e":"code","f158c11d":"code","8c9b30cc":"code","e853ebf1":"markdown","1de92542":"markdown","5d3e0890":"markdown","658c42f2":"markdown","424a9ac1":"markdown","12f49268":"markdown","d49452f4":"markdown","f4e03f66":"markdown","6258fcea":"markdown","f51b2c40":"markdown","1792c2a7":"markdown","7f107ef7":"markdown","35a23535":"markdown","1da41102":"markdown","3605f3f6":"markdown","4abcbb77":"markdown","4208cb84":"markdown","6df79332":"markdown","401a8c9b":"markdown"},"source":{"34daadf6":"import pandas as pd\nimport seaborn as sns\nimport sklearn.metrics\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport warnings\n\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.model_selection import cross_val_score\n\nwarnings.filterwarnings(\"ignore\")\nrnd_state = 65","defd5a59":"data = pd.read_csv(\"..\/input\/Admission_Predict.csv\", index_col=0)\ndata = data.rename(columns={'GRE Score' : 'GRE_Score',\n                            'TOEFL Score' : 'TOEFL_Score',\n                            'University Rating' : 'University_Rating',\n                            'Chance of Admit ' : 'Chance_of_Admit',\n                            'LOR ' : 'LOR'})\n\ndata.loc[data.Chance_of_Admit >= 0.90, 'Chance_of_Admit_Class'] = \"High\"\ndata.loc[(data.Chance_of_Admit >= 0.75) & (data.Chance_of_Admit < 0.90), 'Chance_of_Admit_Class'] = \"Average\"\ndata.loc[data.Chance_of_Admit <= 0.75, 'Chance_of_Admit_Class'] = \"Low\"\n\ndel data['Chance_of_Admit']\n\nprint (data['Chance_of_Admit_Class'].value_counts())","fb90beed":"print(data.info())","b51b923c":"print(\"In\u00edcio da tabela de dados\\n{0}\".format(data.head()))","1ead75d0":"print(\"Informa\u00e7\u00f5es sobre a tabela\\n{0}\".format(data.describe(include='all')))","32f03cb5":"print(\"Formato do conjunto de dados {0}\".format(data.shape))","843497ce":"research_w_dirt = data[\"Research\"] + 1e-12*np.random.rand(data[\"Research\"].shape[0])\nplottableData = data.copy()\nplottableData[\"Research\"] = research_w_dirt\nsns.pairplot(data, kind=\"scatter\", hue=\"Chance_of_Admit_Class\")\nplt.show()","fb0fbc58":"X = data[[\"GRE_Score\", \"TOEFL_Score\", \"University_Rating\", \"SOP\", \"LOR\", \"CGPA\", \"Research\"]]\nY = data[[\"Chance_of_Admit_Class\"]]\n\nsplitted = train_test_split(X, Y, test_size=0.20, random_state=rnd_state)\n\ntrain = { \"x\" : splitted[0], \"y\" : splitted[2] }\ntest = { \"x\" : splitted[1], \"y\" : splitted[3] }\n\nprint(train['x'].shape)\nprint(train['y'].shape)\n\nprint(test['x'].shape)\nprint(test['y'].shape)","bf46ec02":"accuracy = { 'train' : [], 'test' : []}\ndecision_trees = []\nleaf_node_range = range(2,50)\n\nfor mln in leaf_node_range:\n  modelo = DecisionTreeClassifier(max_leaf_nodes=mln, criterion='entropy', random_state=rnd_state)\n  scores = cross_val_score(modelo, train['x'], train['y'], cv=10)\n  accuracy['train'].append(scores.mean())\n  \n  modelo.fit(train['x'], train['y'])\n  ypred = modelo.predict(test['x'])\n  accuracy['test'].append(sklearn.metrics.accuracy_score(test['y'], ypred))\n  print(\"N\u00ba de n\u00f3s folha: {0}\".format(mln))\n  print(\"Score {0}\\n\".format(modelo.score(test['x'], test['y'])))\n  decision_trees.append(modelo)","8561023e":"plt.plot(leaf_node_range, accuracy['train'], label='Treino')\nplt.plot(leaf_node_range, accuracy['test'], label='Teste')\nplt.ylabel('Acur\u00e1cia')\nplt.xlabel('M\u00e1ximo de N\u00f3s Folha')\nplt.legend()\n\nplt.show()","25fd6e7e":"decision_tree = decision_trees[np.argmax(accuracy['test'])]","e45f4247":"ypred = decision_tree.predict(test['x'])\nprint(ypred)","dbdf385f":"y_scores_arvore = decision_tree.predict_proba(test['x'])\nprint(y_scores_arvore)","73708d2d":"acuracia = sklearn.metrics.accuracy_score(test['y'], ypred)\nbest_mln = leaf_node_range[np.argmax(accuracy['test'])]\nprint(\"Acur\u00e1cia: {0:.2f}%\".format(acuracia * 100))\nprint(\"N\u00ba de n\u00f3s folhas: {0}\".format(best_mln))","882f5f5e":"importance_frame = pd.DataFrame()\nimportance_frame['Columns'] = data.columns[:7]\nimportance_frame['Importance'] = modelo.feature_importances_\nimportance_frame = importance_frame.sort_values(by=['Importance'], ascending=True)\n\nplt.barh([1,2,3,4,5,6,7], importance_frame['Importance'], align='center', alpha=0.5)\nplt.yticks([1,2,3,4,5,6,7], importance_frame['Columns'])\nplt.xlabel('Ganho de informa\u00e7\u00e3o')\nplt.title('Contribui\u00e7\u00e3o dos atributos')\nplt.show()","f158c11d":"conf_mat = sklearn.metrics.confusion_matrix(test['y'], ypred)\n\ndf_cm = pd.DataFrame(conf_mat, index = [i for i in [\"High\", \"Average\", \"Low\"]],\n                  columns = [i for i in [\"High\", \"Average\", \"Low\"]])\n\ncmap = sns.light_palette(\"navy\", as_cmap=True)\nplt.figure()\nsns.heatmap(df_cm, annot=True, cmap=cmap)\nplt.show()","8c9b30cc":"sklearn.tree.export_graphviz(decision_tree, out_file='tree.dot')","e853ebf1":"O conjunto possui um total de 400 entradas.","1de92542":"Exibindo informa\u00e7\u00f5es gerais.","5d3e0890":"Dando uma olhada no in\u00edcio da tabela depois das altera\u00e7\u00f5es.","658c42f2":"# C\u00f3digo\n**Importando as bibliotecas necess\u00e1rias**","424a9ac1":"O modelo \u00e9 treinado utilizando valida\u00e7\u00e3o cruzada e variando o n\u00famero de n\u00f3s folha de 2 a 50.","12f49268":"Uma an\u00e1lise mais precisa pode ser feita calculando a **matriz de confus\u00e3o**\n\n**High**:\n\n* 19 registros pertencentes \u00e0 classe high foram classificados como high\n* 1 registro pertencente \u00e0 classe high foi classificado como average\n* 4 registros pertencentes \u00e0 classe high foram classificados como low\n\nPorcentagem de acerto: 79,16%\n\n**Average**:\n\n* 1 registro pertencente \u00e0 classe average foi classificado como high\n* 9 registros pertencentes \u00e0 classe average foram classificados como average\n* Nenhum registro pertencente \u00e0 classe average foi classificado como low\n\nPorcentagem de acerto: 90%\n\n**Low**:\n\n* 3 registros pertencentes \u00e0 classe low foram classificados como high\n* Nenhum registro pertencente \u00e0 classe low foi classificado como average\n* 43 registros pertencentes \u00e0 classe low foram classificados como low\n\nPorcentagem de acerto: 93,47%\n\nNo total, o n\u00famero de acertos foi 71 e o de erros foi 9, resultando em uma taxa de acerto de 88,75%.","d49452f4":"[GraphvizOnline](https:\/\/dreampuf.github.io\/GraphvizOnline\/#digraph%20Tree%20%7B%0Anode%20%5Bshape%3Dbox%5D%20%3B%0A0%20%5Blabel%3D%22X%5B4%5D%20%3C%3D%208.815%5Cnentropy%20%3D%201.385%5Cnsamples%20%3D%20320%5Cnvalue%20%3D%20%5B91%2C%2047%2C%20182%5D%22%5D%20%3B%0A1%20%5Blabel%3D%22X%5B4%5D%20%3C%3D%208.62%5Cnentropy%20%3D%200.641%5Cnsamples%20%3D%20209%5Cnvalue%20%3D%20%5B34%2C%200%2C%20175%5D%22%5D%20%3B%0A0%20-%3E%201%20%5Blabeldistance%3D2.5%2C%20labelangle%3D45%2C%20headlabel%3D%22True%22%5D%20%3B%0A5%20%5Blabel%3D%22X%5B4%5D%20%3C%3D%208.255%5Cnentropy%20%3D%200.373%5Cnsamples%20%3D%20167%5Cnvalue%20%3D%20%5B12%2C%200%2C%20155%5D%22%5D%20%3B%0A1%20-%3E%205%20%3B%0A7%20%5Blabel%3D%22X%5B3%5D%20%3C%3D%20328.0%5Cnentropy%20%3D%200.084%5Cnsamples%20%3D%2096%5Cnvalue%20%3D%20%5B1%2C%200%2C%2095%5D%22%5D%20%3B%0A5%20-%3E%207%20%3B%0A11%20%5Blabel%3D%22entropy%20%3D%200.0%5Cnsamples%20%3D%2095%5Cnvalue%20%3D%20%5B0%2C%200%2C%2095%5D%22%5D%20%3B%0A7%20-%3E%2011%20%3B%0A12%20%5Blabel%3D%22entropy%20%3D%200.0%5Cnsamples%20%3D%201%5Cnvalue%20%3D%20%5B1%2C%200%2C%200%5D%22%5D%20%3B%0A7%20-%3E%2012%20%3B%0A8%20%5Blabel%3D%22entropy%20%3D%200.622%5Cnsamples%20%3D%2071%5Cnvalue%20%3D%20%5B11%2C%200%2C%2060%5D%22%5D%20%3B%0A5%20-%3E%208%20%3B%0A6%20%5Blabel%3D%22X%5B2%5D%20%3C%3D%203.25%5Cnentropy%20%3D%200.998%5Cnsamples%20%3D%2042%5Cnvalue%20%3D%20%5B22%2C%200%2C%2020%5D%22%5D%20%3B%0A1%20-%3E%206%20%3B%0A13%20%5Blabel%3D%22entropy%20%3D%200.75%5Cnsamples%20%3D%2014%5Cnvalue%20%3D%20%5B3%2C%200%2C%2011%5D%22%5D%20%3B%0A6%20-%3E%2013%20%3B%0A14%20%5Blabel%3D%22X%5B3%5D%20%3C%3D%20321.5%5Cnentropy%20%3D%200.906%5Cnsamples%20%3D%2028%5Cnvalue%20%3D%20%5B19%2C%200%2C%209%5D%22%5D%20%3B%0A6%20-%3E%2014%20%3B%0A15%20%5Blabel%3D%22entropy%20%3D%200.998%5Cnsamples%20%3D%2017%5Cnvalue%20%3D%20%5B8%2C%200%2C%209%5D%22%5D%20%3B%0A14%20-%3E%2015%20%3B%0A16%20%5Blabel%3D%22entropy%20%3D%200.0%5Cnsamples%20%3D%2011%5Cnvalue%20%3D%20%5B11%2C%200%2C%200%5D%22%5D%20%3B%0A14%20-%3E%2016%20%3B%0A2%20%5Blabel%3D%22X%5B4%5D%20%3C%3D%209.235%5Cnentropy%20%3D%201.27%5Cnsamples%20%3D%20111%5Cnvalue%20%3D%20%5B57%2C%2047%2C%207%5D%22%5D%20%3B%0A0%20-%3E%202%20%5Blabeldistance%3D2.5%2C%20labelangle%3D-45%2C%20headlabel%3D%22False%22%5D%20%3B%0A3%20%5Blabel%3D%22X%5B4%5D%20%3C%3D%209.155%5Cnentropy%20%3D%200.825%5Cnsamples%20%3D%2064%5Cnvalue%20%3D%20%5B53%2C%204%2C%207%5D%22%5D%20%3B%0A2%20-%3E%203%20%3B%0A9%20%5Blabel%3D%22entropy%20%3D%200.523%5Cnsamples%20%3D%2051%5Cnvalue%20%3D%20%5B45%2C%200%2C%206%5D%22%5D%20%3B%0A3%20-%3E%209%20%3B%0A10%20%5Blabel%3D%22entropy%20%3D%201.239%5Cnsamples%20%3D%2013%5Cnvalue%20%3D%20%5B8%2C%204%2C%201%5D%22%5D%20%3B%0A3%20-%3E%2010%20%3B%0A4%20%5Blabel%3D%22entropy%20%3D%200.42%5Cnsamples%20%3D%2047%5Cnvalue%20%3D%20%5B4%2C%2043%2C%200%5D%22%5D%20%3B%0A2%20-%3E%204%20%3B%0A%7D)","f4e03f66":"Fazendo uma avalia\u00e7\u00e3o geral.","6258fcea":"Representa\u00e7\u00e3o gr\u00e1fica dos testes de acur\u00e1cia.","f51b2c40":"Pontua\u00e7\u00e3o atribu\u00edda pela \u00e1rvore de decis\u00e3o. O n\u00famero na coluna indica a chance de cada entrada do conjunto de testes de pertencer a cada uma das tr\u00eas classes.","1792c2a7":"N\u00e3o h\u00e1 dados nulos, e os tipos s\u00e3o int64, float64 e object(string).","7f107ef7":"**Apresenta\u00e7\u00e3o de resultados**\n\n","35a23535":"**Prepara\u00e7\u00e3o dos dados para treinamento**\n\nLeitura e renomea\u00e7\u00e3o, bem como defini\u00e7\u00e3o do limiar que possibilitar\u00e1 o tratamento do conjunto como um problema de classifica\u00e7\u00e3o:\n* **High:** Chance_of_Admit maior ou igual a 0.90\n* **Average:** Chance_of_Admit maior ou igual a 0.75 e menor que 0.90\n* **Low:** Chance_of_Admit menor que 0.75","1da41102":"**Treinamento**\n\n80% do conjunto foi separado para treinamento e 20% para teste.","3605f3f6":"Classes preditas para os dados no conjunto de testes.","4abcbb77":"# Conclus\u00e3o\n\n\u00c9 poss\u00edvel analisar a influ\u00eancia de cada um dos atributos na decis\u00e3o final. O gr\u00e1fico obtido revela que *Undergraduate CGPA* \u00e9 o que mais contribui para a aprova\u00e7\u00e3o em um programa de mestrado, e *University Rating*, *Research Experience* e *Letter of Recommendation Strength* s\u00e3o os menos relevantes.","4208cb84":"# Prop\u00f3sito\n\nSer aprovado em um programa de mestrado \u00e9 um trabalho que envolve diversas caracter\u00edsticas curriculares que os alunos adquirem durante a gradua\u00e7\u00e3o. O objetivo deste kernel \u00e9 auxiliar alunos indianos no processo de escolha de uma universidade que corresponda ao seu perfil curricular.\n\n# Conte\u00fado\nO [conjunto de dados](https:\/\/www.kaggle.com\/mohansacharya\/graduate-admissions) utilizado pertence a **Mohan S Acharya**, e cont\u00e9m par\u00e2metros que s\u00e3o considerados importantes para algu\u00e9m que deseja ser aprovado em um programa de mestrado:\n* GRE(Graduate Record Examination)\n* TOEFL(Test of English as a Foreign Language)\n* University Rating\n* Statement of Purpose\n* Letter of Recommendation Strength\n* Undergraduate CGPA(Cumulative Grade Point Averaga)\n* Research Experience\n    \n# Abordagem\nA ideia inicial era utilizar um algoritmo classificador supervisionado, e o escolhido para esse fim foi a \u00e1rvore de decis\u00e3o. O problema se tratava de regress\u00e3o, mas como o intuito era trabalhar com classifica\u00e7\u00e3o, as chances de aprova\u00e7\u00e3o foram convertidas para as classes Low, Average e High.\n","6df79332":"**An\u00e1lise explorat\u00f3ria dos dados**\n\nExibi\u00e7\u00e3o de gr\u00e1ficos de dispers\u00e3o e histogramas para as vari\u00e1veis que ser\u00e3o consideradas na an\u00e1lise","401a8c9b":"Tamb\u00e9m \u00e9 poss\u00edvel visualizar a \u00e1rvore de decis\u00e3o por meio do Graphviz"}}