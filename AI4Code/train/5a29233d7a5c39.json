{"cell_type":{"59731f40":"code","82a5c745":"code","b7c15a3c":"code","504528b7":"code","fe7238df":"code","65edb55c":"code","394e1136":"code","2ef635a0":"code","6245a565":"code","f215840e":"code","e4d4c79d":"code","d03b5ccf":"code","0e124c93":"code","6b04f5f7":"code","676d556e":"code","db4ed34f":"code","9db07633":"code","6e18e2bc":"code","8ecf432b":"code","a892c521":"code","a6251616":"code","09f6e257":"code","861a4256":"code","adc30d3e":"code","ce8fe575":"code","1b621d0b":"code","1eced104":"code","05463295":"markdown","cf1603c5":"markdown","4c6f8977":"markdown","14e9a188":"markdown","d32005c0":"markdown","d3077880":"markdown","74cb34e7":"markdown","935cbda5":"markdown","9a8992d5":"markdown","12b9f791":"markdown","f05c5113":"markdown","558a4d92":"markdown","8646976e":"markdown","24df6757":"markdown","3ed0be8a":"markdown","aad8ea9e":"markdown","9dcbcb68":"markdown","948578d2":"markdown","e01b39f5":"markdown","17f67a81":"markdown","0d185283":"markdown","868c799b":"markdown","50242f74":"markdown"},"source":{"59731f40":"import pandas as pd\npd.pandas.set_option('display.max_columns', None)\ndf=pd.read_csv(\"..\/input\/personacsv\/persona.csv\")\ndf.head()","82a5c745":"df.info()\ndf.describe()","b7c15a3c":"df[\"SOURCE\"].nunique()","504528b7":"df[\"SOURCE\"].value_counts()","fe7238df":"df[\"PRICE\"].nunique()","65edb55c":"df[\"PRICE\"].value_counts()","394e1136":"df[\"COUNTRY\"].value_counts()","2ef635a0":"df.groupby(\"COUNTRY\")[\"PRICE\"].sum()","6245a565":"df.groupby(\"SOURCE\")[\"PRICE\"].value_counts()","f215840e":"df.groupby(\"COUNTRY\")[\"PRICE\"].mean()","e4d4c79d":"df.groupby(\"SOURCE\")[\"PRICE\"].mean()","d03b5ccf":"df.groupby([\"COUNTRY\",\"SOURCE\"])[[\"PRICE\"]].mean()","0e124c93":"df.groupby([\"COUNTRY\",\"SOURCE\"]).agg({\"PRICE\":\"mean\"}) #alternative","6b04f5f7":"df.groupby([\"COUNTRY\", \"SOURCE\", \"SEX\", \"AGE\"])[\"PRICE\"].sum()","676d556e":"df.groupby([\"COUNTRY\", \"SOURCE\", \"SEX\", \"AGE\"])[[\"PRICE\"]].sum().sort_values(by=\"PRICE\",ascending=False)\nagg_df=df.groupby([\"COUNTRY\", \"SOURCE\", \"SEX\", \"AGE\"])[[\"PRICE\"]].sum().sort_values(by=\"PRICE\",ascending=False)\nagg_df","db4ed34f":"agg_df=agg_df.reset_index()\nagg_df","9db07633":"my_labels = ['0_18', '19_23', '24_30', '31_41', '42_70']\nagg_df[\"AGE_CUT\"]=pd.cut(agg_df[\"AGE\"],bins=[0,18,24,31,42,70],labels=my_labels)\nagg_df","6e18e2bc":"agg_df[\"customers_level_based\"]=[(i[0]+\"_\"+i[1]+\"_\"+i[2]+\"_\"+i[5]).upper()  for i in agg_df.values]","8ecf432b":"agg_df.head()","a892c521":"agg_df=agg_df.groupby(\"customers_level_based\")[[\"PRICE\"]].mean()","a6251616":"agg_df.head()","09f6e257":"agg_df[\"SEGMENT\"]=pd.qcut(agg_df[\"PRICE\"],4,labels=[\"D\",\"C\",\"B\",\"A\"])","861a4256":"agg_df.groupby(\"SEGMENT\")[\"PRICE\"].describe()","adc30d3e":"agg_df.groupby(\"SEGMENT\")[\"PRICE\"].sum()","ce8fe575":"C=agg_df[agg_df[\"SEGMENT\"]==\"C\"]\nC.head()","1b621d0b":"agg_df.loc[\"TUR_ANDROID_FEMALE_31_41\",:]","1eced104":"agg_df.loc[\"FRA_IOS_FEMALE_31_41\",:]","05463295":"\n### Convert the names in the index to variable names.","cf1603c5":"### Read the dataset and show the general information about it.","4c6f8977":"###  How much was earned in total from sales by country?","14e9a188":"###  What are the PRICE averages in the COUNTRY-SOURCE breakdown?","d32005c0":"\n### What are the total earnings broken down by COUNTRY, SOURCE, SEX, AGE?","d3077880":"### \u25aa Extract only the C segment from the dataset.","74cb34e7":"A company wants to create new level-based customer definitions (persona) using some features of its customers and to create segments according to these new customer definitions and to estimate how much the new customers can earn to the company on average.\n\n(source of this project: https:\/\/bootcamp.veribilimiokulu.com\/egitim\/veri-bilimci-yetistirme-programi\/)","935cbda5":"### \u25aa Add the segments as variables to agg_df with the SEGMENT naming.","9a8992d5":"\n\n### To better see the output from the previous question, use the sort_values method in descending order.\n### Apply according to PRICE.","12b9f791":"###  What are the PRICE averages based on SOURCEs?","f05c5113":"TASK 6\n\n### Define new level-based customers (personas) and add them as variables to the dataset.","558a4d92":"###  How many unique PRICEs are there?","8646976e":"###  What are the sales numbers according to SOURCE types?","24df6757":"###  What are the PRICE averages by country?","3ed0be8a":"\n### \u25aa Which segment does a 33-year-old Turkish woman using ANDROID belong to?\n### How much income is expected on average?","aad8ea9e":"\n\n### Convert age variable to categorical variable and add it to agg_df.","9dcbcb68":"![](https:\/\/i2.wp.com\/wardaszka.com\/wp-content\/uploads\/2018\/03\/29.jpg?fit=1664%2C1508&ssl=1)","948578d2":"### \u25aa In which segment and on average how much income would a 35-year-old French woman using iOS expect to earn?","e01b39f5":"### \u25aa Name of the new variable to be added: customers_level_based","17f67a81":"###  How many sales were made from which country?","0d185283":"###  How many unique SOURCES are there? What are their frequencies?","868c799b":"### How many sales were made from which PRICE?","50242f74":"\n### Segment new customers (personas).\n### \u25aa Divide new customers (Example: USA_ANDROID_MALE_0_18) into 4 segments according to PRICE"}}