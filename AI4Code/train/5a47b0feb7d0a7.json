{"cell_type":{"dd564464":"code","395f890b":"code","3f9c471a":"code","c47f009e":"code","57956d3c":"code","197d68d6":"markdown","6536ceb6":"markdown","b4c22b57":"markdown","f15a8930":"markdown"},"source":{"dd564464":"!pip install -Uqq fastbook\nimport fastbook\nfastbook.setup_book()\n\nfrom fastbook import *\nfrom fastai.vision.widgets import *\n\nimport os","395f890b":"main_path = \"..\/input\/surface-crack-detection\"","3f9c471a":"surfaces = DataBlock(\n    blocks=(ImageBlock, CategoryBlock),\n    get_items=get_image_files,\n    splitter=RandomSplitter(valid_pct=0.3, seed=42),\n    get_y=parent_label,\n    item_tfms=Resize(227)\n)\n\n# add data augmentation\nsurfaces = surfaces.new(item_tfms=Resize(227), batch_tfms=aug_transforms(mult=2))","c47f009e":"dls = surfaces.dataloaders(main_path)\n\ndls.valid.show_batch(max_n=8, nrows=2)","57956d3c":"learn = cnn_learner(dls, resnet18, metrics=error_rate)\nlearn.fine_tune(2)","197d68d6":"- resnet18 architecture  \n- Accuracy = 1 - Error rate = 99.9%  \n- 2 epochs\n","6536ceb6":"## References\n\n1. [fast.ai](https:\/\/course.fast.ai\/)","b4c22b57":"This kernel is a very quick attempt at building a classifier with the surface cracks dataset used here.\n\n### Summary\n\n1. A simple model with fast.ai, running 2 epochs with the resnet18 architecture can yield 99.9% accuracy\n2. It takes around 5 lines of code to do so\n3. However, this model most likely **can't be deployed**, because\n    - The dataset is **too clean** and well-made\n        - This has a tendency to \"spoil the model\"","f15a8930":"# Detecting Surface Cracks on Buildings"}}