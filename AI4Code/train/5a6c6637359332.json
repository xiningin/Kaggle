{"cell_type":{"9e5d476e":"code","b4f4d73e":"code","fc6f4039":"code","43e34b03":"code","e542d457":"code","2a82c7ec":"code","4a595f12":"code","8d1d0004":"code","8c48aa22":"code","4d242211":"code","d9e55152":"code","cc393c54":"code","1af2fcc6":"markdown","a895fa9f":"markdown","180c6a10":"markdown","9f90709c":"markdown","e81cd1ff":"markdown","2a4f1e4c":"markdown","9e67f492":"markdown","d61766f4":"markdown","19d777dd":"markdown"},"source":{"9e5d476e":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\nfrom sklearn.metrics import classification_report\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.metrics import r2_score\n\nimport os\nprint(os.listdir(\"..\/input\"))\n","b4f4d73e":"print(\"Reading the csv file and looking at the first five rows :\\n\")\nheadbrain = pd.read_csv(\"..\/input\/headbrain.csv\")\nprint(headbrain.head())\n#y=mx+c\n","fc6f4039":"print(headbrain.shape)","43e34b03":"print(\"HeadBrain Info :\\n\")\nprint(headbrain.info())","e542d457":"print(\"Checking for any null values:\\n\")\nprint(headbrain.isnull().any())","2a82c7ec":"print(\"Checking for unique values in each column:\\n\")\nprint(headbrain.nunique())","4a595f12":"plt.figure(figsize=(10,10))\nsns.scatterplot(y='Brain Weight(grams)',x='Head Size(cm^3)',data=headbrain)\nplt.show()","8d1d0004":"headbrain  = headbrain.values\n\nX = headbrain[:,2]\nY = headbrain[:,3]\n\nX.shape,Y.shape","8c48aa22":"def Linear_Regression(X,Y):\n    mean_x = np.mean(X)\n    mean_y = np.mean(Y)\n\n    n = len(X)\n    numerator= 0\n    denominator=0\n    for i in range(n):\n        numerator   += ((X[i] - mean_x) * (Y[i] - mean_y))\n        denominator += ((X[i] - mean_x) ** 2)\n\n    m = numerator\/ denominator\n    c = mean_y - m * mean_x\n    \n    return(m,c)\n\ndef predict(X,m,c):\n    pred_y=[]\n    for i in range(len(X)):\n        pred_y.append(c + m * X[i])\n\n    return(pred_y)\n","4d242211":"def r2score(y_obs,y_pred):\n    yhat = np.mean(y_obs)\n    \n    ss_res = 0.0\n    ss_tot = 0.0\n    \n    for i in range(len(y_obs)):\n        ss_tot += (y_obs[i]-yhat)**2\n        ss_res += (y_obs[i]-y_pred[i])**2\n        \n    r2 = 1 - (ss_res\/ss_tot)\n\n    return r2\n","d9e55152":"plt.title(\"Linear Regression Plot of HeadSize Vs Brain Weight\")\n\nX_train,X_test,y_train,y_test = train_test_split(X,Y,test_size=0.3)\n\nm,c = Linear_Regression(X_train,y_train)\nprint(\"slope = \", m)\nprint('intercept = ',c)\n      \ny_pred =  predict(X_test,m,c)\n\nprint(\"R-squared :\",r2score(y_test,y_pred))\n\nplt.plot(X_test,y_pred,color='red',label='Linear Regression')\nplt.scatter(X_train,y_train,c='b',label='Scatter Plot')\nplt.xlabel(\"Head Size\")\nplt.ylabel(\"Brain Weight\")\nplt.legend()\nplt.show()","cc393c54":"#Reshape the input data into 2D array\nX = X.reshape(len(X),1)\n\nX_train,X_test,y_train,y_test = train_test_split(X,Y,test_size=0.3)\n\nreg = LinearRegression()\nreg.fit(X_train,y_train)\n\ny_predictions = reg.predict(X_test)\n\nprint(\"R-squared :\",r2_score(y_test, y_predictions))\n","1af2fcc6":"We are interested only the Head Size(independent) and Brain Weight(dependent) for this exercise, so let's get in X and Y","a895fa9f":"**Calculate the slope and y-intercept**","180c6a10":"**We can see this using the inbuilt Sklearn Linear Regression model**","9f90709c":"Let's plot a scatter plot for Head Size again Brain Weight","e81cd1ff":"Linear Regression model are used to show or predict the relationship between a dependent variable (target variable) and independent variable(s).\nIt can be used to check if there exists any correlation between the variables.\n\n1. Simple Linear Regression -> relationship between just two variables (a dependent Vs an independent)\n2. Multiple Regression -> relationship between two or more variables ( a dependent Vs 2 or more independent) \n\nThe current data set in an example of Simple Linear Regression. We have a target or the dependent variable,which is Brain Weight. The independent variable here is the Head Size.\n\nThe formula goes like this - \n\ny = mx+c\n\nWhere , \n\nc - is the  y-intercept\n\nm - is the slope \/  coefficient -> this quantity effects the values of y\n\nIn our example -\n\nBrainWeight = m * HeadSize + constant\n\nconstant = BrainWeight - (m * HeadSize)","2a4f1e4c":"**Let's calulate the Linear Regression and plot the data points **","9e67f492":"Linear Regression by scratch using Python. Comparing with Sklearn Linear Regression model","d61766f4":"**Now let's calculate the R-Square value (Coefficient of determination)**\n\ny_obs         -> observed data \n\ny_pred        -> predicted value of y from the formula (y=mx+c)\n\ny_hat         -> mean of y_obs\n\ntotal_sum_of_squares(ss_tot) -> sum( (y_obs - y_hat)  ** 2 )\n\nsum_of_squares(ss_res)       -> sum( (y_obs - y_pred) ** 2 )\n\nr2 -> 1 - total_sum_of_squares\/sum_of_squares","19d777dd":"![](http:\/\/i.huffpost.com\/gen\/1257884\/images\/o-BRAIN-MAPPING-facebook.jpg)"}}