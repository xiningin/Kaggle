{"cell_type":{"c8d89e20":"code","69e6d3d7":"code","eed863cd":"code","e4e9f4af":"code","7ee402d1":"code","4003e3ad":"code","fc4b37a5":"code","29dd67d6":"code","19c11e92":"code","8578fe7f":"code","c2bbfe94":"code","cc8ca6fb":"code","105edf89":"code","ff441a83":"code","d85b7f39":"code","e0aa3928":"code","bfe3fcc5":"code","4e8ed52a":"code","9d093a88":"code","a86a3fa5":"code","3a13204f":"code","6452fd0f":"code","673ee91f":"code","b25bd23d":"code","f5681545":"code","25cf0826":"code","9b005b25":"code","aff09acb":"code","6ae081d1":"code","48ef1f85":"code","3404dd83":"code","1f9f243d":"code","3d680a98":"code","e3e234f0":"code","a50ed1e7":"code","e3dea2a2":"code","b47151ec":"code","b2183835":"code","b6c43f77":"code","ac74ee40":"code","18482a39":"code","7a8cf826":"code","f892a3a3":"code","9b058f92":"code","6a34f274":"code","4330abd6":"code","826ab4e3":"code","c9dfe427":"code","ed88802c":"code","0da03ec0":"markdown","73b80bcc":"markdown","aed5671b":"markdown","a31ffde4":"markdown","357de09e":"markdown","157bfe72":"markdown","44d3ded2":"markdown","00545c3e":"markdown","a0a9e2a1":"markdown","3f44815c":"markdown","cb72956d":"markdown","60616d0c":"markdown","85cf782c":"markdown","a90be32e":"markdown","9050eea7":"markdown","bb26a798":"markdown","ad38768e":"markdown","ae9eec7d":"markdown","15125867":"markdown","1c377552":"markdown","15fb26c4":"markdown","7bfca7a1":"markdown","d8b6d636":"markdown","5b3e1b78":"markdown","509c4a1c":"markdown","c6f0f1fc":"markdown","24a3520c":"markdown","fa755735":"markdown","5f09e85d":"markdown","b6091bd3":"markdown","21180502":"markdown","88c1da8e":"markdown","98eb8f43":"markdown","a8cbd056":"markdown","1b839219":"markdown","8b16ddaf":"markdown","195b32fd":"markdown","24b64203":"markdown","1b24c9e1":"markdown","1391ef2a":"markdown","eb7c1100":"markdown","708ad202":"markdown","27ee7a28":"markdown","dc627d64":"markdown","fce19b32":"markdown","58c8790d":"markdown","bedbd8f1":"markdown","bd503dad":"markdown","7651bb3c":"markdown"},"source":{"c8d89e20":"# Importing the libraries\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\nfrom IPython.display import Image\nfrom sklearn.preprocessing import OneHotEncoder\nfrom sklearn.preprocessing import LabelEncoder\nimport warnings\nwarnings.filterwarnings('ignore')\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.naive_bayes import GaussianNB\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.metrics import confusion_matrix\nfrom sklearn.metrics import roc_auc_score, roc_curve, auc","69e6d3d7":"Image(url = 'https:\/\/natureecoevocommunity.nature.com\/cdn-cgi\/image\/quality=90\/https:\/\/images.zapnito.com\/uploads\/ebb294a8195aad356c35dcc9320b2e8d\/bc84ba5c-7f0c-44fc-a79d-1ee934e1875a.jpeg', width=600)","eed863cd":"Image(url = 'https:\/\/www.anatomynote.com\/wp-content\/uploads\/2018\/09\/3937\/Mushroom-anatomical-structure.gif',width=800,height=400)","e4e9f4af":"# Read the dataset \nmushroom_df = pd.read_csv('..\/input\/mushroom-classification\/mushrooms.csv')","7ee402d1":"print('\\033[1m', 'First five rows of the dataset.', '\\033[0m')\nmushroom_df.head()","4003e3ad":"mushroom_df.info()","fc4b37a5":"print('\\033[1m', 'Statistical summary of all the columns', '\\033[0m')\nmushroom_df.describe()","29dd67d6":"# Dealing with missing values in stalk-root column\nmushroom_df['stalk-root'].replace('?', np.nan, inplace=True)\nprint('\\033[1m', 'Value counts for stalk root before filling missing values: ', '\\033[0m', mushroom_df['stalk-root'].value_counts(), sep='\\n')\nprint('\\033[1m', '\\nNumber of null values: ', '\\033[1m', mushroom_df['stalk-root'].isnull().sum())\nmushroom_df['stalk-root'].fillna(mushroom_df['stalk-root'].mode()[0], inplace=True)\nprint('\\033[1m', 'Value counts for stalk root after filling missing values with mode: ', '\\033[0m', mushroom_df['stalk-root'].value_counts(), sep='\\n')","19c11e92":"view_df = mushroom_df.copy()\n\n# Creating labels for each column\nlabels = {\n    'class': {'e':'edible', 'p':'poisonous'},\n    'cap-shape': {'b':'bell', 'c':'conical', 'x':'convex', 'f':'flat', 'k':'knobbed', 's':'sunken'},\n    'cap-surface': {'f':'fibrous', 'g':'grooves', 'y':'scaly', 's':'smooth'},\n    'cap-color': {'n':'brown', 'b':'buff', 'c':'cinnamon', 'g':'gray', 'r':'green', 'p':'pink', 'u':'purple', 'e':'red', 'w':'white', 'y':'yellow'},\n    'bruises': {'t':'bruises', 'f':'no'},\n    'odor': {'a':'almond', 'l':'anise', 'c':'creosote', 'y':'fishy', 'f':'foul', 'm':'musty', 'n':'none', 'p':'pungent', 's':'spicy'},\n    'gill-attachment': {'a':'attached', 'f':'free', 'd':'descending', 'n':'notched'},\n    'gill-spacing': {'c':'close', 'w':'crowded', 'd':'distant'},\n    'gill-size': {'b':'broad', 'n':'narrow'},\n    'gill-color': {'k':'black', 'n':'brown', 'b':'buff', 'h':'chocolate', 'g':'gray', 'r':'green', 'o':'orange', 'p':'pink', 'u':'purple', 'e':'red', 'w':'white', 'y':'yellow'},\n    'stalk-shape': {'e':'enlarging', 't':'tapering'},\n    'stalk-root': {'b':'bulbous', 'c':'club', 'u':'cup', 'e':'equal', 'z':'rhizomorphs', 'r':'rooted'},\n    'stalk-surface-above-ring': {'f':'fibrous', 'y':'scaly', 'k':'silky', 's':'smooth'},\n    'stalk-surface-below-ring': {'f':'fibrous', 'y':'scaly', 'k':'silky', 's':'smooth'},\n    'stalk-color-above-ring': {'n':'brown', 'b':'buff', 'c':'cinnamon', 'g':'gray', 'o':'orange', 'p':'pink', 'e':'red', 'w':'white', 'y':'yellow'},\n    'stalk-color-below-ring': {'n':'brown', 'b':'buff', 'c':'cinnamon', 'g':'gray', 'o':'orange', 'p':'pink', 'e':'red', 'w':'white', 'y':'yellow'},\n    'veil-type': {'p':'partial', 'u':'universal'},\n    'veil-color': {'n':'brown', 'o':'orange', 'w':'white', 'y':'yellow'},\n    'ring-number': {'n':'none', 'o':'one', 't':'two'},\n    'ring-type': {'c':'cobwebby', 'e':'evanescent', 'f':'flaring', 'l':'large', 'n':'none', 'p':'pendant', 's':'sheathing', 'z':'zone'},\n    'spore-print-color': {'k':'black', 'n':'brown', 'b':'buff', 'h':'chocolate', 'r':'green', 'o':'orange', 'u':'purple', 'w':'white', 'y':'yellow'},\n    'population': {'a':'abundant', 'c':'clustered', 'n':'numerous', 's':'scattered', 'v':'several', 'y':'solitary'},\n    'habitat': {'g':'grasses', 'l':'leaves', 'm':'meadows', 'p':'paths', 'u':'urban', 'w':'waste', 'd':'woods'}\n    }\nview_df.replace(labels, inplace=True)","8578fe7f":"# Defining a function to plot countplots of various columns from the dataset\ndef plot_countplots(col):\n    fig=plt.figure(figsize=(22, 10));\n    plt.subplot(221);\n    sns.countplot(x=col, data=view_df, order=view_df[col].value_counts().index, palette='summer');\n    sns.set_style('whitegrid');\n    sns.despine(left=True);\n    plt.xlabel('{} of the Mushroom'.format(col.replace('-', ' ').capitalize()), fontsize=16);\n    plt.ylabel('');\n    plt.title('Distribution of mushroom by {}'.format(col.replace('-', ' ')), fontsize=22, pad=10);\n    plt.subplot(222);\n    sns.countplot(x=col, data=view_df, hue='class', order=view_df[col].value_counts().index, palette='summer');\n    plt.xlabel('{} of the Mushroom'.format(col.replace('-', ' ').capitalize()), fontsize=16);\n    sns.set_style('whitegrid');\n    sns.despine(left=True);\n    plt.ylabel('');\n    plt.title('Distribution of mushroom by {} and class'.format(col.replace('-', ' ')), fontsize=22, pad=10);\n    plt.legend(bbox_to_anchor=(1.15, 1), loc='upper right', fontsize=12);\n    plt.show();","c2bbfe94":"Image(url = 'https:\/\/www.usask.ca\/biology\/fungi\/graphics\/glossary_pictures\/glossary_pic15',width=400,height=400)","cc8ca6fb":"plot_countplots('cap-shape')","105edf89":"Image(url = 'https:\/\/www.usask.ca\/biology\/fungi\/graphics\/glossary_pictures\/glossary_pic16' ,width=800,height=400)","ff441a83":"plot_countplots('cap-surface')","d85b7f39":"plot_countplots('cap-color')","e0aa3928":"plot_countplots('bruises')","bfe3fcc5":"plot_countplots('odor')","4e8ed52a":"Image(url = 'https:\/\/www.usask.ca\/biology\/fungi\/graphics\/glossary_pictures\/glossary_pic19' ,width=800,height=400)","9d093a88":"plot_countplots('gill-attachment')","a86a3fa5":"Image(url = 'https:\/\/www.usask.ca\/biology\/fungi\/graphics\/glossary_pictures\/glossary_pic17')","3a13204f":"plot_countplots('gill-spacing')","6452fd0f":"plot_countplots('gill-size')","673ee91f":"plot_countplots('gill-color')","b25bd23d":"plot_countplots('stalk-shape')","f5681545":"Image(url = 'https:\/\/www.usask.ca\/biology\/fungi\/graphics\/glossary_pictures\/glossary_pic21' ,width=800,height=400)","25cf0826":"plot_countplots('stalk-root')","9b005b25":"plot_countplots('stalk-surface-below-ring')","aff09acb":"plot_countplots('stalk-surface-above-ring')","6ae081d1":"plot_countplots('stalk-color-below-ring')","48ef1f85":"plot_countplots('stalk-color-above-ring')","3404dd83":"plot_countplots('veil-type')","1f9f243d":"plot_countplots('veil-color')","3d680a98":"plot_countplots('ring-number')","e3e234f0":"Image(url = 'https:\/\/www.usask.ca\/biology\/fungi\/graphics\/glossary_pictures\/glossary_pic20' ,width=800,height=400)","a50ed1e7":"plot_countplots('ring-type')","e3dea2a2":"plot_countplots('spore-print-color')","b47151ec":"plot_countplots('population')","b2183835":"plot_countplots('habitat')","b6c43f77":"le = LabelEncoder()\nfor col in list(view_df.columns):\n    view_df[col] = le.fit_transform(view_df[col])","ac74ee40":"print('\\033[1m\\033[4mDataset after encoding with Label Encoder\\033[0m')\nview_df","18482a39":"# Drop the target column\nX = view_df.drop('class', axis=1)\ny = view_df['class']\nX.head()","7a8cf826":"# Encode the label encoded dataset\none_hot = OneHotEncoder()\nX = one_hot.fit_transform(X).toarray()","f892a3a3":"# Return feature names for output features.\nprint('\\033[1m\\033[4m', 'Feature names after one hot encoding', '\\033[0m')\none_hot.get_feature_names()","9b058f92":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=0)","6a34f274":"print('\\033[1m\\033[4m Shape of training set features:\\033[0m', X_train.shape, \n      '\\033[1m\\033[4m Shape of training set target:\\033[0m', y_train.shape,\n      '\\033[1m\\033[4m Shape of test set features:\\033[0m', X_test.shape,\n      '\\033[1m\\033[4m Shape of test set features:\\033[0m', y_test.shape,\n      sep='\\n')","4330abd6":"clf = LogisticRegression().fit(X_train, y_train)\naccuracy=cross_val_score(clf, X_train , y_train, cv=10, scoring='accuracy')\ny_pred = clf.predict(X_test)\nconfusion = confusion_matrix(y_test,y_pred)\nauc_roc = roc_auc_score(y_test,y_pred)\nfpr, tpr, thresholds = roc_curve(y_test, y_pred)\nroc_auc = auc(fpr, tpr)\nprint('\\033[1m','Cross val accuracy: ', '\\033[0m', accuracy, '\\033[1m', '\\n\\n', 'Mean of cross val accuracies: ', '\\033[0m', np.mean(accuracy))\nplt.figure(figsize=(15, 15))\nplt.subplot(221)\nsns.heatmap(confusion, cmap='summer', annot=True);\nplt.subplot(222)\nplt.title('Receiver Operating Characteristic')\nplt.plot(fpr, tpr, color='green', label='AUC= %0.2f'%roc_auc);\nplt.legend(loc='lower right')\nplt.plot([0, 1], [0, 1],linestyle='--');\nplt.xlabel('False Positive Rate')\nplt.ylabel('True Positive Rate');","826ab4e3":"clf = GaussianNB().fit(X_train, y_train)\naccuracy=cross_val_score(clf, X_train , y_train, cv=10, scoring='accuracy')\ny_pred = clf.predict(X_test)\nconfusion = confusion_matrix(y_test,y_pred)\nauc_roc = roc_auc_score(y_test,y_pred)\nfpr, tpr, thresholds = roc_curve(y_test, y_pred)\nroc_auc = auc(fpr, tpr)\nprint('\\033[1m','Cross val accuracy: ', '\\033[0m', accuracy, '\\033[1m', '\\n\\n', 'Mean of cross val accuracies: ', '\\033[0m', np.mean(accuracy))\nplt.figure(figsize=(15, 15))\nplt.subplot(221)\nsns.heatmap(confusion, cmap='summer', annot=True);\nplt.subplot(222)\nplt.title('Receiver Operating Characteristic')\nplt.plot(fpr, tpr, color='green', label='AUC= %0.2f'%roc_auc);\nplt.legend(loc='lower right')\nplt.plot([0, 1], [0, 1],linestyle='--');\nplt.xlabel('False Positive Rate')\nplt.ylabel('True Positive Rate');","c9dfe427":"clf = DecisionTreeClassifier().fit(X_train, y_train)\naccuracy=cross_val_score(clf, X_train , y_train, cv=10, scoring='accuracy')\ny_pred = clf.predict(X_test)\nconfusion = confusion_matrix(y_test,y_pred)\nauc_roc = roc_auc_score(y_test,y_pred)\nfpr, tpr, thresholds = roc_curve(y_test, y_pred)\nroc_auc = auc(fpr, tpr)\nprint('\\033[1m','Cross val accuracy: ', '\\033[0m', accuracy, '\\033[1m', '\\n\\n', 'Mean of cross val accuracies: ', '\\033[0m', np.mean(accuracy))\nplt.figure(figsize=(15, 15))\nplt.subplot(221)\nsns.heatmap(confusion, cmap='summer', annot=True);\nplt.subplot(222)\nplt.title('Receiver Operating Characteristic')\nplt.plot(fpr, tpr, color='green', label='AUC= %0.2f'%roc_auc);\nplt.legend(loc='lower right')\nplt.plot([0, 1], [0, 1],linestyle='--');\nplt.xlabel('False Positive Rate')\nplt.ylabel('True Positive Rate');","ed88802c":"clf = RandomForestClassifier().fit(X_train, y_train)\naccuracy=cross_val_score(clf, X_train , y_train, cv=10, scoring='accuracy')\ny_pred = clf.predict(X_test)\nconfusion = confusion_matrix(y_test,y_pred)\nauc_roc = roc_auc_score(y_test,y_pred)\nfpr, tpr, thresholds = roc_curve(y_test, y_pred)\nroc_auc = auc(fpr, tpr)\nprint('\\033[1m','Cross val accuracy: ', '\\033[0m', accuracy, '\\033[1m', '\\n\\n', 'Mean of cross val accuracies: ', '\\033[0m', np.mean(accuracy))\nplt.figure(figsize=(15, 15))\nplt.subplot(221)\nsns.heatmap(confusion, cmap='summer', annot=True);\nplt.subplot(222)\nplt.title('Receiver Operating Characteristic')\nplt.plot(fpr, tpr, color='green', label='AUC= %0.2f'%roc_auc);\nplt.legend(loc='lower right')\nplt.plot([0, 1], [0, 1],linestyle='--');\nplt.xlabel('False Positive Rate')\nplt.ylabel('True Positive Rate');","0da03ec0":"### Stalk color above ring","73b80bcc":"### Stalk color below ring","aed5671b":"- According to the graph, none and foul-smelling mushrooms are common.\n- According to the graph, the odor of the mushrooms will play an important role in distinguishing the class of the mushrooms.","a31ffde4":"Mushroom hunting, mushrooming, mushroom picking, mushroom foraging, and similar terms describe the activity of gathering mushrooms in the wild, typically for culinary use. This practice is popular throughout most of Europe, Australia, Japan, Korea, parts of the Middle East, and the Indian subcontinent, as well as the temperate regions of Canada and the United States.\n","357de09e":"## Logistic Regression","157bfe72":"# Preprocessing","44d3ded2":"## Random Forest Classifier","00545c3e":"- Convex and flats make up the majority of the cap shape of mushrooms. \n- Mushrooms with cap shape of bell appear to be more edible than other cap shapes.","a0a9e2a1":"## GaussianNB","3f44815c":"### Population","cb72956d":"**Label Encoder**\n- Most of the sklearn functions expect that the data with number labels rather than word labels. Hence, we need to convert such labels into number labels. This process is called label encoding.","60616d0c":"### Ring type","85cf782c":"- Stalk Color Below Ring with pink,brown and buff seems more poisonous.","a90be32e":"# Model comparison using cross validation","9050eea7":"### Stalk surface above ring","bb26a798":"## Decision Tree Classifier","ad38768e":"- Stalk Surface with silky looks more poisonous  than than other types of Stalk Surface","ae9eec7d":"### Spore print color","15125867":"## Splitting the data into training and test set","1c377552":"The highest accuracy is given by random forest classifier an accuracy of 1.0. Decision tree classifier gave an accuracy of 0.99982 and logistic regression 0.99964. Gaussian Naive Bayes gave the lowest accuracy among these 4 models choosen an accuracy of 0.9525.","15fb26c4":"- Stalk Surface with silky looks more poisonous  than than other types of Stalk Surface","7bfca7a1":"### Cap color","d8b6d636":"### Gill size","5b3e1b78":"### Stalk root","509c4a1c":"- White and chocolate spore prints looks more poisonous than other colors.","c6f0f1fc":"- Appears to be unbalanced in terms of the gill attachment.\n- Free gill attachments are almost half edible or poisonous.","24a3520c":"- Stalk Color Above Ring with pink,brown and buff seems more poisonous.","fa755735":"### Cap Shape","5f09e85d":"- Appears to be unbalanced in terms of veil color","b6091bd3":"For dataset;\n\nCap surface of scaly contains both raised scales and flat scales.\n\nGrooves = Patches","21180502":"### Gill spacing","88c1da8e":"### Veil color","98eb8f43":"- Mushrooms with bruises are more edible than the not bruises mushrooms.","a8cbd056":"### Stalk shape","1b839219":"### Veil type","8b16ddaf":"- Large ring type in mushroom seems dangerous.","195b32fd":"### Ring number","24b64203":"### Odor","1b24c9e1":"### Habitat","1391ef2a":"### Cap surface","eb7c1100":"- Appears to be unbalanced in terms of the gill spacing.\n- Crowded gill spacing  more edible than the close gill spacing.","708ad202":"- If Gill color is buff do not eat that mushroom.","27ee7a28":"- Narrow gill size looks more poisonous than the broad gill size","dc627d64":"### Gill attachment","fce19b32":"\n- **classes**: edible=e, poisonous=p\n- **cap-shape**: bell=b,conical=c, convex=x, flat=f, knobbed=k,sunken=s\n- **cap-surface**: fibrous=f, grooves=g, scaly=y, smooth=s\n- **cap-color**:  brown=n, buff=b, cinnamon=c, gray=g, green=r, pink=p, purple=u, red=e, white=w, yellow=y\n- **bruises**: bruises=t, no=f\n- **odor**: almond=a, anise=l, creosote=c, fishy=y, foul=f, musty=m, none=n, pungent=p, spicy=s\n- **gill-attachment**: attached=a, descending=d, free=f, notched=n\n- **gill-spacing**: close=c, crowded=w, distant=d\n- **gill-size**: broad=b, narrow=n\n- **gill-color**: black=k, brown=n, buff=b, chocolate=h, gray=g, green=r, orange=o, pink=p, purple=u, red=e, white=w, yellow=y\n- **stalk-shape**: enlarging=e, tapering=t\n- **stalk-root**: bulbous=b, club=c, cup=u, equal=e, rhizomorphs=z, rooted=r, missing=?\n- **stalk-surface-above-ring**: fibrous=f, scaly=y, silky=k, smooth=s\n- **stalk-surface-below-ring**: fibrous=f, scaly=y, silky=k, smooth=s\n- **stalk-color-above-ring**: brown=n, buff=b, cinnamon=c, gray=g, orange=o, pink=p, red=e, white=w, yellow=y\n- **stalk-color-below-ring**: brown=n, buff=b, cinnamon=c, gray=g, orange=o, pink=p, red=e, white=w, yellow=y\n- **veil-type**: partial=p, universal=u\n- **veil-color**: brown=n, orange=o, white=w, yellow=y\n- **ring-number**: none=n, one=o, two=t\n- **ring-type**: cobwebby=c, evanescent=e, flaring=f, large=l, none=n, pendant=p, sheathing=s, zone=z\n- **spore-print-color**: black=k, brown=n, buff=b, chocolate=h, green=r, orange=o, purple=u, white=w, yellow=y\n- **population**: abundant=a, clustered=c, numerous=n, scattered=s, several=v, solitary=y\n- **habitat**: grasses=g, leaves=l, meadows=m, paths=p, urban=u, waste=w, woods=d","58c8790d":"### Gill color","bedbd8f1":"### Stalk surface below ring","bd503dad":"**OneHotEncoder**\n\n- Encode categorical integer features using a one-hot aka one-of-K scheme.\n- The input to this transformer should be a matrix of integers, denoting the values taken on by categorical (discrete) features.\n- The output will be a sparse matrix where each column corresponds to one possible value of one feature.\n- It is assumed that input features take on values in the range [0, n_values).\n- This encoding is needed for feeding categorical data to many scikit-learn estimators, notably linear models and SVMs with the standard kernels.","7651bb3c":"### Bruises"}}