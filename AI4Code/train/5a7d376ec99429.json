{"cell_type":{"890dd334":"code","486b5f21":"code","1970e5ab":"code","04a85060":"code","b0f856d9":"code","e1302d93":"code","74beb008":"code","2dbebec5":"code","6c87cc51":"code","418008eb":"code","fad0136b":"code","42fd6bf5":"code","745846cd":"code","a0d7c102":"code","054b80fd":"code","1704f9b1":"code","44309d02":"code","c73f41d7":"code","15795862":"code","8459e624":"code","a7b7daf3":"code","a61f9d77":"code","a786bf2d":"code","e60d83e1":"code","8a4f4a53":"code","547196b3":"markdown","f848ddc2":"markdown","b8d2c11d":"markdown","c479ca00":"markdown","ef9f20f9":"markdown","4b61061e":"markdown","de80e7f2":"markdown","7c006b48":"markdown","2f57c8ef":"markdown","1eeb8159":"markdown"},"source":{"890dd334":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LinearRegression\n#import statsmodels.formula.api as sm\nfrom sklearn.metrics import mean_squared_error,mean_absolute_error\nfrom random import shuffle\nfrom sklearn.model_selection import cross_val_score\n%matplotlib inline\nfrom sklearn import metrics\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","486b5f21":"data=pd.read_csv('\/kaggle\/input\/bl3312\/blasting2.csv') ","1970e5ab":"data.describe()","04a85060":"\ndata.head()","b0f856d9":"data = data.values\ndata = np.take(data,np.random.permutation(data.shape[0]),axis=0,out=data)\nreal_x = data[:,0:7]\nreal_y = data[:,8]","e1302d93":"train_x,test_x,train_y,test_y= train_test_split(real_x,real_y,test_size=0.2,random_state=0)\n","74beb008":"mlr=LinearRegression()\nmlr.fit(train_x,train_y)","2dbebec5":"pred=mlr.predict(test_x)","6c87cc51":"ic=mlr.intercept_\nprint(f\"The Intercept is {ic}\")","418008eb":"print('training score:',mlr.score(train_x,train_y)*100)\nprint('test score:',mlr.score(test_x,test_y)*100)","fad0136b":"mse=mean_squared_error(pred,test_y)\nmae=mean_absolute_error(pred,test_y)\nprint('Root Mean Squared Error:', np.sqrt(metrics.mean_squared_error(test_y, pred)))\nprint(f'Mean  Squared Error is {mse}')\nprint(f'Mean Absolute Squared Error is {mae}')","42fd6bf5":"colors=('red','green')\nplt.scatter(pred,test_y)\nplt.title('Scatter plot')\nplt.xlabel('prediction')\nplt.ylabel('test_y')\nplt.show()","745846cd":"df1 = pd.DataFrame({'Actual': test_y.flatten(), 'Predicted': pred.flatten()})\ndf1","a0d7c102":"df2 = df1.head(30)\ndf2.plot(kind='bar',figsize=(16,10))\nplt.grid(which='major', linestyle='-', linewidth='0.5', color='green')\nplt.grid(which='minor', linestyle=':', linewidth='0.5', color='black')\nplt.show()","054b80fd":"mreg=LinearRegression()","1704f9b1":"cross_val_score(mreg,real_x,real_y,cv=30).mean()","44309d02":"lin_sc=cross_val_score(mreg,real_x,real_y,cv=20,scoring='neg_mean_absolute_error')","c73f41d7":"lin_sc=-lin_sc","15795862":"lin_sc","8459e624":"np.mean(lin_sc)","a7b7daf3":"\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.metrics import mean_absolute_error\n\n\n","a61f9d77":"forest_model = RandomForestRegressor(random_state=1)\nforest_model.fit(train_x, train_y)\nmelb_preds = forest_model.predict(test_x)\n\n","a786bf2d":"mse1=mean_squared_error(melb_preds,test_y)\nmae1=mean_absolute_error(melb_preds,test_y)\nprint('Root Mean Squared Error:', np.sqrt(metrics.mean_squared_error(test_y, melb_preds)))\nprint(f'mean  sq error is {mse1}')\nprint(f'mean absol sq error is {mae1}')","e60d83e1":"df3 = pd.DataFrame({'Actual': test_y.flatten(), 'Predicted': melb_preds.flatten()})\ndf3","8a4f4a53":"df4 = df3.head(30)\ndf2.plot(kind='bar',figsize=(16,10))\nplt.grid(which='major', linestyle='-', linewidth='0.5', color='green')\nplt.grid(which='minor', linestyle=':', linewidth='0.5', color='black')\nplt.show()","547196b3":"# Initial 7 coloumns are features and 8th coloumn is label","f848ddc2":"# MSE , MAE and RMSE","b8d2c11d":"**Assessment of  prediction of peak particle velocity**","c479ca00":"**Scores**","ef9f20f9":"#### Due to Complexity of blast design parameters and rock mass parameters, it is difficult to develop a general equation for prediction of ground vibration due to blasting in mines so it is required to assess a methodology for prediction of peak particle velocity and its validation.\n\n****All main blast design parameters are measured and recorded to develop a vibration prediction model. They are the burden (B, m), spacing (S, m), bench height (H, m), stemming (T, m) subdrilling (U, m), hole diameter (D, m) and powder factor (PF, kg\/ m3). Burden (B) is the distance from explosive charge to the nearest free or open face at the time the hole detonates. Spacing (S) is the distance between blastholes in a row. Bench height (H) is the height of the horizontal ledge in a quarry face. Stemming (T) is defined as the length of blasthole left uncharged. This part is confined using drill cuttings. Subdrilling (U) is the length of blasthole drilled below the planned floor level. The term hole diameter (D) indicates the diameter of blasthole. Powder factor (PF) is the consumption of explosive per cubic meter or tonne of rock. Several blasting researchers have considered blast design parameters as ratios. In this study, the blast design parameters of all the blast data are also used as ratios. The ratio of bench height to drilled burden (H\/B), ratio of spacing to burden (S\/B), ratio of burden to hole diameter (B\/D), ratio of subdrilling to burden (U\/B) and ratio of stemming to burden (T\/B) are the blast design parameters used. The powder factor (PF) is considered as a basic blast design parameter.\n","4b61061e":"#  *Random Forest Regressor*","de80e7f2":"**Please provide your valuable suggestions and comments so that I can improve the model**","7c006b48":"# actual VS predicted","2f57c8ef":"## Cross Validation","1eeb8159":"1. > Using Linear Regression \n2. > Mean Absolute Squared Error is 0.02157077807964488\n3. > Using Random Forest Regresssion\n4. > mean absol sq error is 0.004722205238149809\n"}}