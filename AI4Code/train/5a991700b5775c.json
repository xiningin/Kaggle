{"cell_type":{"fc8cbb4d":"code","bfa7adb4":"code","1e0bd1fa":"code","3d9bbcfd":"code","b29441dd":"code","c4a44780":"code","4e3260da":"code","69c36a33":"code","9d1fe78f":"code","27a9fe36":"code","bfc94602":"code","ecf24ebc":"code","f83f385e":"code","dd59fb6a":"code","a856bac6":"code","39372887":"code","4fe4e464":"code","8d7b2fb8":"code","dee15f80":"code","e4dce51d":"code","053a742d":"code","3677adeb":"code","6bbff05c":"code","14f362e7":"code","fae7e119":"code","82953ed1":"code","2096c109":"code","6bdea50d":"code","4644364f":"code","9c5eed04":"code","96840eed":"code","95ce90d7":"code","bafad9b2":"code","1774fada":"markdown","9b28d1dd":"markdown"},"source":{"fc8cbb4d":"import numpy as np \nimport pandas as pd \nimport os\nimport matplotlib.pyplot as plt\nimport cv2\n\nfrom tensorflow.keras.utils import to_categorical\nfrom keras.layers import Dense,Conv2D,Flatten,MaxPool2D,Dropout\nfrom keras.models import Sequential\n\nfrom sklearn.model_selection import train_test_split\n\nnp.random.seed(1)","bfa7adb4":"kane_images = []\nkane_labels = []\nshape = (200,200)  \ntrain_path = '..\/input\/sport-celebrity-image-classification\/Sports-celebrity images\/Kane Williamson'\n\nfor filename in os.listdir('..\/input\/sport-celebrity-image-classification\/Sports-celebrity images\/Kane Williamson'):\n    if filename.split('.')[1] == 'jpg':\n        img = cv2.imread(os.path.join(train_path,filename))\n        \n        kane_labels.append(filename.split('_')[0])\n        \n        img = cv2.resize(img,shape)\n        \n        kane_images.append(img)\n\nkane_images = np.array(kane_images)","1e0bd1fa":"kane_images.shape","3d9bbcfd":"rona_images = []       \nrona_labels = []\nshape = (200,200)  \ntrain_path = '..\/input\/sport-celebrity-image-classification\/Sports-celebrity images\/Ronaldo'\n\nfor filename in os.listdir('..\/input\/sport-celebrity-image-classification\/Sports-celebrity images\/Ronaldo'):\n    if filename.split('.')[1] == 'jpg':\n        img= cv2.imread(os.path.join(train_path,filename))\n        rona_labels.append(filename.split('_')[0])\n        img = cv2.resize(img,shape)\n        rona_images.append(img)\n\nrona_images = np.array(rona_images)","b29441dd":"rona_images.shape","c4a44780":"maria_images = []       \nmaria_labels = []\nshape = (200,200)  \ntrain_path = '..\/input\/sport-celebrity-image-classification\/Sports-celebrity images\/Maria Sharapova'\n\nfor filename in os.listdir('..\/input\/sport-celebrity-image-classification\/Sports-celebrity images\/Maria Sharapova'):\n    if filename.split('.')[1] == 'jpg':\n        img = cv2.imread(os.path.join(train_path,filename))\n        maria_labels.append(filename.split('_')[0])\n        img = cv2.resize(img,shape)\n        maria_images.append(img)\n\nmaria_images = np.array(maria_images)","4e3260da":"maria_images.shape","69c36a33":"kobe_images = []       \nkobe_labels = []\nshape = (200,200)  \ntrain_path = '..\/input\/sport-celebrity-image-classification\/Sports-celebrity images\/Kobe Bryant'\n\nfor filename in os.listdir('..\/input\/sport-celebrity-image-classification\/Sports-celebrity images\/Kobe Bryant'):\n    if filename.split('.')[1] == 'jpg':\n        img = cv2.imread(os.path.join(train_path,filename))\n        kobe_labels.append(filename.split('_')[0])\n        img = cv2.resize(img,shape)\n        kobe_images.append(img)\n\nkobe_images = np.array(kobe_images)","9d1fe78f":"kobe_images.shape","27a9fe36":"all_labels=np.concatenate([kane_labels, rona_labels, maria_labels,kobe_labels])\nall_images=np.concatenate([kane_images, rona_images, maria_images,kobe_images])","bfc94602":"print(all_labels[300])\nplt.imshow(all_images[300])","ecf24ebc":"all_images.shape","f83f385e":"all_labels.shape","dd59fb6a":"all_images=np.reshape(all_images,(441,-1))","a856bac6":"all_images=pd.DataFrame(all_images)","39372887":"all_images","4fe4e464":"all_images['target']=all_labels","8d7b2fb8":"all_images","dee15f80":"X=all_images.drop('target',axis=1)\ny=all_images['target']","e4dce51d":"y=pd.DataFrame(y)","053a742d":"y=pd.get_dummies(y)","3677adeb":"y","6bbff05c":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42)","14f362e7":"X_train=X_train.to_numpy()\nX_train = np.reshape(X_train, (308,200,200,3))","fae7e119":"X_test=X_test.to_numpy()\nX_test=np.reshape(X_test,(133,200,200,3))","82953ed1":"y_train=y_train.to_numpy()\ny_test=y_test.to_numpy()","2096c109":"x_train,x_val,y_train,y_val = train_test_split(X_train,y_train,random_state=1)","6bdea50d":"model= Sequential()\nmodel.add(Conv2D(kernel_size=(3,3), filters=32, activation='tanh', input_shape=(200,200,3,)))\nmodel.add(Conv2D(filters=30,kernel_size = (3,3),activation='tanh'))\nmodel.add(MaxPool2D(2,2))\nmodel.add(Conv2D(filters=30,kernel_size = (3,3),activation='tanh'))\nmodel.add(MaxPool2D(2,2))\nmodel.add(Conv2D(filters=30,kernel_size = (3,3),activation='tanh'))\n\nmodel.add(Flatten())\n\nmodel.add(Dense(20,activation='relu'))\nmodel.add(Dense(15,activation='relu'))\nmodel.add(Dense(4,activation = 'softmax'))\n    \nmodel.compile(\n              loss='categorical_crossentropy', \n              metrics=['acc'],\n              optimizer='adam'\n             )","4644364f":"model.summary()","9c5eed04":"history = model.fit(x_train,y_train,epochs=50,batch_size=50,validation_data=(x_val,y_val))","96840eed":"plt.plot(history.history['acc'])\nplt.plot(history.history['val_acc'])\nplt.title('model accuracy')\nplt.ylabel('accuracy')\nplt.xlabel('epoch')\nplt.legend(['train', 'test'], loc='upper left')\nplt.show()","95ce90d7":"plt.plot(history.history['loss'])\nplt.plot(history.history['val_loss'])\nplt.title('model loss')\nplt.ylabel('loss')\nplt.xlabel('epoch')\nplt.legend(['train', 'test'], loc='upper left')\nplt.show()","bafad9b2":"evaluate = model.evaluate(x_val,y_val)\nprint(evaluate)","1774fada":"# It is still needed to be improved !","9b28d1dd":"I refered to https:\/\/www.kaggle.com\/prateek0x\/multiclass-image-classification-using-keras"}}