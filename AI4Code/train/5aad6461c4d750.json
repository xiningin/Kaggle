{"cell_type":{"999cf788":"code","4c447e2f":"code","1fb66ee3":"code","f2e50486":"code","34301939":"code","6cc076bd":"code","abf6ccda":"code","57216354":"code","51a36fca":"code","c6877636":"code","4c91d22c":"code","ac2d6c66":"code","0ac2b762":"code","249e1acc":"code","a94477e6":"code","0c3741ae":"markdown","ff848b7c":"markdown","c737c6b6":"markdown","b63260b5":"markdown","0b8a4deb":"markdown","6f15f496":"markdown","07640070":"markdown","048dab91":"markdown","785a8392":"markdown","4565c5a9":"markdown","55481496":"markdown"},"source":{"999cf788":"!pip3 install git+https:\/\/github.com\/fastai\/fastai.git","4c447e2f":"!pip3 install git+https:\/\/github.com\/pytorch\/pytorch","1fb66ee3":"import torch\nprint(torch.__version__)","f2e50486":"import fastai\nfastai.__version__","34301939":"from fastai import *          # Quick accesss to most common functionality\nfrom fastai.tabular import *  # Quick accesss to tabular functionality     # Access to example data provided with fastai\nimport pandas as pd","6cc076bd":"input_path = '\/kaggle\/input\/'\ntrain_df = pd.read_csv(f'{input_path}train.csv')\ntest_df = pd.read_csv(f'{input_path}test.csv')","abf6ccda":"for df in [train_df, test_df]:\n    df['Title'] = df['Name'].str.split(',').str[1].str.split(' ').str[1]\n    df['Deck'] = df['Cabin'].str[0]","57216354":"dep_var = 'Survived'\ncat_names = ['Pclass', 'Sex', 'Embarked', 'Title', 'Deck']\ncont_names = ['Age', 'Fare', 'SibSp', 'Parch']\nprocs = [FillMissing, Categorify, Normalize]","51a36fca":"test = TabularList.from_df(test_df, cat_names=cat_names, cont_names=cont_names);\ntest","c6877636":"data = (TabularList.from_df(train_df, path='.', cat_names=cat_names, cont_names=cont_names, procs=procs)\n                           .split_by_idx(list(range(0,200)))\n                           .label_from_df(cols=dep_var)\n                           .add_test(test, label=0)\n                           .databunch())\ndata","4c91d22c":"learn = tabular_learner(data, layers=[200,100], metrics=accuracy)","ac2d6c66":"learn.fit(8, 1e-2)","0ac2b762":"predictions, *_ = learn.get_preds(DatasetType.Test)\nlabels = np.argmax(predictions, 1)","249e1acc":"sub_df = pd.DataFrame({'PassengerId': test_df['PassengerId'], 'Survived': labels})\nsub_df.to_csv('submission.csv', index=False)","a94477e6":"sub_df.tail()","0c3741ae":"## Inference\nPredictions come as an array of probabilities of death or survival  for each passenger in the test set. Use `argmax` to convert each to`1` or `0` then construct the submission dataframe and save to CSV.","ff848b7c":"Need v1.0.25 of `fastai`as this notebook was made for this version.","c737c6b6":"## Load data","b63260b5":"Check that what we are submitting looks sensible.","0b8a4deb":"We can see that we do not even need to apply the same process of filling the Missing Values, Categorify the categorical variables and specify the names of the continuous variables separately for the Test dataset as well.\nFastAI handles it by itself.","6f15f496":"## Fastai setup","07640070":"# Predicting survival of Titanic passengers using FASTAI V1","048dab91":"## Feature engineering\nExtract *Title* from the name colum. Extract *Deck* from the first character of the cabin number.","785a8392":"## Training","4565c5a9":"Stay tuned for more Kaggle Kernels implemented using FASTAI-V1.","55481496":"This is my First attempt at Kaggle Kernel. So I started with the Titanic Dataset, since it is one of the most famous one, I was able to understand the importance and beauty of FASTAI V1 library that does so much from minimal coding annd feature engineering efforts.\n\nForked from https:\/\/www.kaggle.com\/tamlyn\/titanic-fastai\/notebook."}}