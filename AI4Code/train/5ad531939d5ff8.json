{"cell_type":{"e722b526":"code","756fef7f":"code","79d9a1d5":"code","e347ca28":"code","4c16224b":"code","8c6e0ff1":"code","ca99fc00":"code","156435b9":"code","f1bf0d31":"code","136a360c":"code","73772ab4":"code","2a73572c":"code","081d13a8":"code","5e407715":"code","70fd2a77":"code","27e1f492":"code","343b6561":"code","809057e9":"code","f9b4f775":"code","3563a8b6":"code","aa4a590b":"code","50f02d21":"code","ac89e2b2":"code","4a5aba50":"code","a667b092":"code","3dd80d65":"code","4526a871":"code","7d533db4":"code","76cd4ed4":"code","db03d7b0":"code","f6c688ea":"code","c6d55162":"code","c9ef8093":"code","e16a9086":"code","bc8b3457":"code","ea941021":"code","b2bf5222":"code","4dc1f8c0":"code","abd519e5":"code","a0559ec9":"code","d4f2d0b6":"code","8a6e0e97":"code","45ca6025":"code","70c700f3":"code","9aafa3cc":"code","1461070d":"code","5eb541bc":"code","628eef01":"code","a7cdd57a":"code","9cffe885":"code","7dccce6a":"code","f73683d5":"code","3dc36873":"code","b8b3df7b":"markdown","95cd0f91":"markdown","2a700fc5":"markdown","02559957":"markdown","5a9b9769":"markdown","ee59bd7d":"markdown","af53d253":"markdown","c5f95e5d":"markdown","3e488cbf":"markdown","ff3a435f":"markdown","69ed38cc":"markdown","8bd30466":"markdown","6a4b21dd":"markdown","17eee614":"markdown","9a4a389c":"markdown","4f49a8af":"markdown","80e9f5b2":"markdown","7943e1c6":"markdown","646a1ccb":"markdown","aee0edb0":"markdown","0f815205":"markdown","c02bb50b":"markdown","e794dcae":"markdown","4bfa5461":"markdown","4fa595ab":"markdown","a388fa30":"markdown","73fb1dc2":"markdown","004e9c7a":"markdown","2a4e2f0d":"markdown","d2c37a9a":"markdown","50ceb91c":"markdown","67a17465":"markdown"},"source":{"e722b526":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","756fef7f":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport torch\nimport torch.nn as nn","79d9a1d5":"df = pd.read_csv(os.path.join(dirname,filename))","e347ca28":"df.head()","4c16224b":"df.shape","8c6e0ff1":"df.isnull().sum()","ca99fc00":"df[\"Drug\"].value_counts() # Drug B and Drug C are under represented","156435b9":"df.describe()","f1bf0d31":"sns.set(font_scale=1)\nplt.title(\"Distribution of Age\")\nsns.distplot(df[\"Age\"])","136a360c":"plt.figure(figsize=(12,8))\nplt.title(\"Boxplot for ages\")\nsns.boxplot(x=\"Drug\",y=\"Age\",data=df)","73772ab4":"df.groupby(\"Drug\").mean()[\"Age\"].sort_values(ascending=False)","2a73572c":"df[\"Sex\"].value_counts()","081d13a8":"plt.figure(figsize=(12,8))\nplt.title(\"Drug wise Gender Distribution\")\nsns.countplot(x=\"Sex\",hue=\"Drug\",data=df)","5e407715":"plt.figure(figsize=(12,10))\nplt.title(\"Boxplot of Age and Distribution\")\nsns.boxplot(x=\"Sex\",y=\"Age\",data=df)","70fd2a77":"df.head()","27e1f492":"def one_hot_encode(dataframe, col):\n    dummy = pd.get_dummies(dataframe[col],drop_first=True)\n    dummy.columns = [str(i)+\"_dumy_\"+col for i in range(len(dummy.columns))]\n    dataframe = dataframe.join(dummy)\n    dataframe.drop([col],axis=1,inplace=True)\n    return dataframe","343b6561":"df = one_hot_encode(df,\"Sex\")","809057e9":"df.head()","f9b4f775":"plt.figure(figsize=(12,10))\nplt.title(\"Boxplot of Blood Pressure\")\nsns.boxplot(x=\"BP\",y=\"Age\",data=df)\n","3563a8b6":"#One hot Encode the BP variable\ndf = one_hot_encode(df,\"BP\")","aa4a590b":"df.head()","50f02d21":"sns.distplot(df[\"Na_to_K\"])\n#There seems to be some outliers present","ac89e2b2":"sns.boxplot(df[\"Na_to_K\"])","4a5aba50":"plt.figure(figsize=(12,9))\nsns.boxplot(x=\"Drug\",y=\"Na_to_K\",data=df)","a667b092":"df[df.Na_to_K>32]","3dd80d65":"plt.figure(figsize=(12,10))\nsns.scatterplot(x=\"Age\",y=\"Na_to_K\",data=df,hue=\"Drug\",s=500,alpha=0.7)","4526a871":"df[\"Cholesterol\"].value_counts()","7d533db4":"df = one_hot_encode(df,\"Cholesterol\")","76cd4ed4":"df.head()","db03d7b0":"from sklearn.preprocessing import LabelEncoder","f6c688ea":"lb = LabelEncoder()","c6d55162":"df[\"Drug\"] = lb.fit_transform(df[\"Drug\"])","c9ef8093":"df.head()","e16a9086":"lb.classes_","bc8b3457":"df.columns","ea941021":"numerical_feats = df[[\"Age\",'Na_to_K']]","b2bf5222":"numerical_feats","4dc1f8c0":"X = df.drop([\"Drug\"],axis=1).values\ny = df[\"Drug\"].values","abd519e5":"from sklearn.model_selection import train_test_split","a0559ec9":"X_train,X_test, y_train,y_test = train_test_split(X,y,test_size=15,random_state=42,stratify=y)","d4f2d0b6":"from sklearn.preprocessing import MinMaxScaler\nscaler = MinMaxScaler()\nscaled_X_train = scaler.fit_transform(X_train)\nscaled_X_test = scaler.transform(X_test)","8a6e0e97":"from sklearn.neighbors import KNeighborsClassifier","45ca6025":"knn = KNeighborsClassifier(n_neighbors=1, p=2 )\nknn.fit(scaled_X_train,y_train)","70c700f3":"pred_k = knn.predict(scaled_X_test)","9aafa3cc":"from sklearn import metrics\ndef evaluate_result(true,pred):\n    print(metrics.classification_report(true,pred))\n    print(metrics.accuracy_score(true,pred))","1461070d":"evaluate_result(y_test,pred_k)","5eb541bc":"sc = MinMaxScaler()\nscaled_X = sc.fit_transform(X)","628eef01":"predictions = knn.predict(scaled_X)","a7cdd57a":"df=df.join(pd.DataFrame(predictions,columns=[\"predictions\"]))","9cffe885":"df[[\"Drug\",\"predictions\"]]","7dccce6a":"evaluate_result(df.Drug,df.predictions)","f73683d5":"plt.figure(figsize=(15,8))\nsns.scatterplot(x='Age',y=\"Na_to_K\",hue=\"Drug\",data=df,s=500,alpha=0.5)","3dc36873":"plt.figure(figsize=(15,8))\nsns.scatterplot(x='Age',y=\"Na_to_K\",hue=\"predictions\",data=df,s=500,alpha=0.5)","b8b3df7b":"Doing a prediction on whole dataset","95cd0f91":"Querying outliers","2a700fc5":"Na_to_K","02559957":"Check for missing values","5a9b9769":"Distribution of ages","ee59bd7d":"Boxplot ","af53d253":"Read in the dataset","c5f95e5d":"Using MinMaxScaler","3e488cbf":"Using K neigbhor Classifiers","ff3a435f":"Age","69ed38cc":"Drugwise Boxplot","8bd30466":"Precitions vs datapoint","6a4b21dd":"Drug Y and Drug B seems to be from a stronger family","17eee614":"Function to evaluate results","9a4a389c":"Training the model","4f49a8af":"Some EDA","80e9f5b2":"Combining the result with the original dataframe","7943e1c6":"It appears that the Drug B is for higher age group","646a1ccb":"Performing prediction on validation dataset","aee0edb0":"One hot Encode Function","0f815205":"Performing a train test split","c02bb50b":"Mean Age of Male is higher","e794dcae":"Cholestrol","4bfa5461":"Import libraries","4fa595ab":"As the outliers are for the same drug Y, I will keep it in the dataset","a388fa30":"# Label Encode the Drug Column","73fb1dc2":"# Thank you for visiting this notebook, please upvote if adds to your knowledge (:","004e9c7a":"Label classes","2a4e2f0d":"BP","d2c37a9a":"Sex","50ceb91c":"Actual labels versus Datapoints","67a17465":"Separting features and labels"}}