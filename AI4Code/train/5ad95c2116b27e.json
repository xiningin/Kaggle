{"cell_type":{"663783d1":"code","a5ea023e":"code","11ec6ce7":"code","85a8866f":"code","4504d3b8":"code","eaca7758":"code","a3d244cf":"code","d64b873f":"code","cb4ecc61":"code","0fcfd307":"code","e5d7449a":"code","158fab13":"code","9ac4489d":"code","228e7608":"code","d70538e4":"code","e210ec19":"code","670028a7":"code","289fac29":"code","2d124570":"code","ba42475f":"code","750cccd7":"code","9bf19904":"code","33f20392":"code","a392386a":"code","bf17502c":"code","8a1cd3f5":"code","8da37578":"code","c5043670":"code","ddd4387f":"code","36b6465d":"code","dfdead01":"code","6bdead7d":"code","bb8dc94f":"code","b230d95e":"code","47110ae0":"code","92229d8e":"code","1b750fc8":"code","518a4b04":"code","6bf31bbb":"code","a7f57cda":"code","823d9cdc":"code","12db0c14":"code","7c5d4e66":"code","f24ebfdb":"code","dc5f4699":"code","ecf682dc":"code","447957b7":"code","c29bdc36":"code","a81025a9":"code","657e5290":"code","bd950d1a":"code","5aa11e20":"code","18a209c4":"code","27e01e03":"code","2223de6b":"code","274cb0a7":"code","b72213c7":"code","e0a02a7e":"code","378d94e7":"code","9ebbcbda":"code","a84d9b98":"code","d29d96df":"code","533dd714":"code","fc60f01d":"code","c6466148":"code","84b28e29":"code","d6c267fa":"code","27e3c4f4":"code","3b1a807f":"code","2bbe3387":"code","a6fa695e":"code","ac576aa3":"code","716974e1":"code","29f87ad0":"code","e839a410":"code","74e08d61":"code","d3e4b641":"code","9009461c":"code","72e4c0d3":"code","c5ea9368":"code","9f0ec9a8":"code","3dc221de":"code","70f91c71":"code","b7950574":"code","7b9f342d":"code","1e36ac85":"code","fdfe405c":"code","467ecda5":"code","e350abb9":"code","7c956c79":"code","286f0d1a":"code","d787ac0d":"markdown"},"source":{"663783d1":"import pandas as pd\nimport numpy as np\nimport pickle","a5ea023e":"innings1 = pd.read_csv('..\/input\/dataset-for-t20-international-matches\/1st Innings T20.csv')\ninnings2 = pd.read_csv('..\/input\/dataset-for-t20-international-matches\/2nd Innings T20.csv')","11ec6ce7":"i1=innings1.columns.to_list()\ni1.remove('venue')\ni2=innings2.columns.to_list()\ni2.remove('venue')","85a8866f":"i1","4504d3b8":"i2","eaca7758":"innings1=innings1[i1]\ninnings1['innings']=1","a3d244cf":"innings2=innings2[i2]\ninnings2['innings']=2","d64b873f":"innings1","cb4ecc61":"innings2","0fcfd307":"innings1[innings1.city=='Bangalore']","e5d7449a":"#Union both df ","158fab13":"data=pd.concat([innings1, innings2])","9ac4489d":"data=data.drop(columns=['tossWinner'],axis=1)","228e7608":"#feature Engineering","d70538e4":"#1.\ndata['over_Number'] = data['balls'].apply(lambda x:str(x).split(\".\")[0])","e210ec19":"data.head(2)","670028a7":"data['ball_In_Over'] = data['balls'].apply(lambda x:str(x).split(\".\")[1])","289fac29":"data.head(2)","2d124570":"data['deliveries'] = data['over_Number'].astype('int')*6 + data['ball_In_Over'].astype('int')","ba42475f":"data.head(2)","750cccd7":"data['delivery_left']=120-data['deliveries']","9bf19904":"def f1(x):\n    if x<0:\n        return 0\n    else:\n        return x\n\ndef f2(x):\n    if int(x)<6:\n        return 1\n    else:\n        return 0","33f20392":"data.delivery_left.unique()","a392386a":"#since delivery left cant be negative\ndata['powerPlay']=data['over_Number'].apply(lambda x:f2(x))\ndata['delivery_left']=data['delivery_left'].apply(lambda x:f1(x))","bf17502c":"#drop over and ball and balls\n\ndata=data.drop(columns=['over_Number','ball_In_Over','balls'],axis=1)","8a1cd3f5":"#now create some meaningful features regarding runs","8da37578":"#Ball by ball score","c5043670":"data['score'] = data.groupby('matchId').cumsum()['runs']","ddd4387f":"data","36b6465d":"#CurrentRunRate","dfdead01":"data['CurrentRunRate']=(data['score'])\/(data['deliveries']\/6)","6bdead7d":"data.tail(2)","bb8dc94f":"#final score","b230d95e":"finalScore=data.groupby('matchId').sum()['runs']","47110ae0":"finalScore=finalScore.rename(\"Final_Score\")","92229d8e":"# features regarding wickets","1b750fc8":"data['wickets'] = data.groupby('matchId').cumsum()['player_out']","518a4b04":"data.head(2)","6bf31bbb":"data['wicketsLeft'] = 10 - data['wickets']","a7f57cda":"data.tail(2)","823d9cdc":"'''te=data.copy()\nte2=data.copy()'''","12db0c14":"#li=te.groupby('matchId')['runs'].rolling(30).sum()","7c5d4e66":"#li.index","f24ebfdb":"#groups.get_group('1720_2').rolling(window=30).sum()['runs'].values.tolist()","dc5f4699":"groups = data.groupby('matchId')","ecf682dc":"#last 5 runs\nl5 = []\nfor ids in data['matchId'].unique():\n    l5.extend(groups.get_group(ids).rolling(window=30).sum()['runs'].values.tolist())","447957b7":"data['Run_In_Last5'] = l5\n","c29bdc36":"#last 5 wickets\nl5w = []\nfor ids in data['matchId'].unique():\n    l5w.extend(groups.get_group(ids).rolling(window=30).sum()['player_out'].values.tolist())\ndata['Wickets_In_Last5'] = l5w","a81025a9":"'''groups = df.groupby('match_id')\n\nmatch_ids = df['match_id'].unique()\nlast_five = []\nfor id in match_ids:\n    last_five.extend(groups.get_group(id).rolling(window=30).sum()['runs'].values.tolist())'''","657e5290":"data","bd950d1a":"#data['coalesce'] = data[['Wickets_In_Last5', 'Wickets_In_Last4', 'Wickets_In_Last3', 'Wickets_In_Last2','Wickets_In_Last1']].bfill(axis=1).iloc[:, 0]","5aa11e20":"data[data.matchId=='5_1'].iloc[:30,]","18a209c4":"'''data['Wickets_In_Last5']=data['Wickets_In_Last5'].combine_first(data['wickets'])\ndata['Run_In_Last5']=data['Run_In_Last5'].combine_first(data['score'])'''","27e01e03":"data[data.matchId=='5_1'].iloc[:30,]","2223de6b":"data","274cb0a7":"data=data.merge(finalScore,on='matchId')","b72213c7":"#finalScore['1720_2']","e0a02a7e":"data.tail()","378d94e7":"sorted(list(data.city.unique()))","9ebbcbda":"data.city.value_counts().sum()","a84d9b98":"data.city.value_counts()[['Bangalore','Bengaluru','Chittagong','Chattogram','Dehra Dun','Dehradun','Dharmasala','Dharamsala','East London','London']]","d29d96df":"data['city']=data['city'].str.replace('Bangalore','Bengaluru')\ndata['city']=data['city'].str.replace('Chittagong','Chattogram')\ndata['city']=data['city'].str.replace('Dehra Dun','Dehradun')\ndata['city']=data['city'].str.replace('Dharmasala','Dharamsala')\ndata['city']=data['city'].str.replace('East London','London')","533dd714":"data.city.value_counts().sum()","fc60f01d":"data.city.value_counts()[['Bengaluru','Chattogram','Dehradun','Dharamsala','London']]","c6466148":"\"\"\"''f=pd.DataFrame(data.groupby(['matchId','innings','city'])[['matchId','innings','city','runs','deliveries']].agg({'runs':'sum','deliveries':'max'}))''\"\"\"","84b28e29":"f=pd.DataFrame(data.groupby(['matchId','innings','city'])[['matchId','innings','city','Final_Score']].agg({'Final_Score':'max'}))","d6c267fa":"f=f.reset_index()","27e3c4f4":"f","3b1a807f":"f[f.city=='Bengaluru']","2bbe3387":"#f['RunRate']=(f['runs'])\/(f['deliveries']\/6)\n#f['Score']=f['RunRate']*20\n#f[f.city=='Bengaluru']","a6fa695e":"#g=pd.DataFrame(f.groupby(['innings','city'])[['innings','city','Score']].mean()['Score'])","ac576aa3":"g=pd.DataFrame(f.groupby(['innings','city'])[['innings','city','Final_Score']].mean()['Final_Score'])","716974e1":"g=g.reset_index()","29f87ad0":"g.columns=['innings','city','AverageScore']","e839a410":"g[g.city=='Bengaluru']","74e08d61":"g","d3e4b641":"data=data.merge(g,on=['innings','city'])","9009461c":"data[data.city=='Bengaluru']","72e4c0d3":"data.matchId.nunique()*30","c5ea9368":"data.isnull().sum()","9f0ec9a8":"data[data.Run_In_Last5.isnull()].deliveries.value_counts()","3dc221de":"data.columns.to_list()","70f91c71":"cols=[\n    'powerPlay',\n    'AverageScore',\n 'battingTeam',\n 'bowlingTeam',\n 'city',\n 'delivery_left',\n 'score',\n 'CurrentRunRate',\n 'wicketsLeft',\n 'Run_In_Last5',\n 'Wickets_In_Last5',\n 'Final_Score','innings']","b7950574":"data=data[cols]","7b9f342d":"data=data.dropna()\n","1e36ac85":"data","fdfe405c":"data.isnull().sum()","467ecda5":"from sklearn.utils import shuffle\ndata=shuffle(data)","e350abb9":"data","7c956c79":"#pickle.dump(data,open('test8.pkl','wb'))","286f0d1a":"data.to_csv('T20 International Dataset.csv')","d787ac0d":"### Please consider an upvote if you find this useful :)"}}