{"cell_type":{"704d1305":"code","b64375e7":"code","e077125d":"code","5e9bca19":"code","02fabc03":"code","7a6b30eb":"code","6eefdd31":"code","1967efe4":"code","49bc2ff9":"code","bc4ce3b5":"code","17c29421":"code","be0a1983":"code","66c05fe9":"code","fdc69ad6":"code","667c0689":"code","bac24a44":"code","add50005":"code","8ae40ab9":"code","d82575fd":"code","bb5fb182":"code","e27f4706":"code","2b8dacc7":"code","36d978ae":"code","f9029875":"code","2e254218":"code","eae90195":"code","d1593f88":"code","ae186846":"code","3151e6e9":"code","8699c484":"code","a036b3ac":"code","6b3eedf6":"code","1c6acbe3":"code","40457cb3":"markdown","8c08dddd":"markdown","b561e7c8":"markdown","c61bdb33":"markdown","3c1ca8b8":"markdown","8254e783":"markdown","b0abc57d":"markdown"},"source":{"704d1305":"pip install google-colab","b64375e7":"import tensorflow as tf\nfrom tensorflow.keras.models import Sequential\nfrom tensorflow.keras.layers import Conv2D, MaxPooling2D, Flatten, Dense\nfrom tensorflow.keras.preprocessing.image import ImageDataGenerator\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport numpy as np\nimport cv2\nfrom google.colab.patches import cv2_imshow","e077125d":"path = '..\/input\/animal-faces\/afhq\/train'","5e9bca19":"tf.keras.preprocessing.image.load_img('..\/input\/animal-faces\/afhq\/train\/cat\/flickr_cat_000013.jpg')","02fabc03":"tf.keras.preprocessing.image.load_img('..\/input\/animal-faces\/afhq\/train\/dog\/flickr_dog_000015.jpg')","7a6b30eb":"tf.keras.preprocessing.image.load_img('..\/input\/animal-faces\/afhq\/train\/wild\/flickr_wild_000019.jpg')","6eefdd31":"training_generator = ImageDataGenerator(rescale=1.\/255,\n                                        rotation_range=7,\n                                        horizontal_flip=True,\n                                        zoom_range=0.2)\ntraining_dataset = training_generator.flow_from_directory('..\/input\/animal-faces\/afhq\/train',\n                                                        target_size = (64, 64),\n                                                        batch_size = 32,\n                                                        class_mode = 'categorical',\n                                                        shuffle = True)","1967efe4":"training_dataset.classes","49bc2ff9":"training_dataset.class_indices","bc4ce3b5":"test_generator = ImageDataGenerator(rescale=1.\/255)\ntest_dataset = test_generator.flow_from_directory('..\/input\/animal-faces\/afhq\/val',\n                                                     target_size = (64, 64),\n                                                     batch_size = 1,\n                                                     class_mode = 'categorical',\n                                                     shuffle = False)","17c29421":"network = Sequential()\nnetwork.add(Conv2D(32, (3,3), input_shape = (64,64,3), activation='relu'))\nnetwork.add(MaxPooling2D(pool_size=(2,2)))\n\nnetwork.add(Conv2D(32, (3,3), activation='relu'))\nnetwork.add(MaxPooling2D(pool_size=(2,2)))\n\nnetwork.add(Flatten())\n\nnetwork.add(Dense(units = 7317, activation='relu'))\nnetwork.add(Dense(units = 7317, activation='relu'))\nnetwork.add(Dense(units = 3, activation='softmax'))","be0a1983":"network.summary()","66c05fe9":"network.compile(optimizer='Adam', loss='categorical_crossentropy', metrics = ['accuracy'])","fdc69ad6":"historic = network.fit(training_dataset, epochs=20)","667c0689":"test_dataset.class_indices","bac24a44":"forecasts = network.predict(test_dataset)\nforecasts","add50005":"forecasts = np.argmax(forecasts, axis = 1)\nforecasts","8ae40ab9":"test_dataset.classes","d82575fd":"from sklearn.metrics import accuracy_score\naccuracy_score(test_dataset.classes, forecasts)","bb5fb182":"test_dataset.class_indices","e27f4706":"from sklearn.metrics import confusion_matrix\ncm = confusion_matrix(test_dataset.classes, forecasts)\ncm","2b8dacc7":"sns.heatmap(cm, annot=True);","36d978ae":"from sklearn.metrics import classification_report\nprint(classification_report(test_dataset.classes, forecasts))","f9029875":"image = cv2.imread('..\/input\/animal-faces\/afhq\/val\/wild\/flickr_wild_000099.jpg')","2e254218":"cv2_imshow(image)","eae90195":"image = cv2.resize(image, (64, 64))\ncv2_imshow(image)","d1593f88":"image = image \/ 255\nimage","ae186846":"image.shape","3151e6e9":"image = image.reshape(-1, 64, 64, 3)\nimage.shape","8699c484":"result = network(image)\nresult","a036b3ac":"result = np.argmax(result)\nresult","6b3eedf6":"test_dataset.class_indices","1c6acbe3":"if result == 0:\n  print('Cat')\nelse:\n if result == 1:\n    print('Dog')\n else:\n    print('Wild')","40457cb3":"# **Single image classification**","8c08dddd":"# **Training and Testing Basis**","b561e7c8":"# **Construction and training of the neural network**","c61bdb33":"# **If you find this notebook useful, support with an upvote** \ud83d\udc4d\u00b6\u00b6","3c1ca8b8":"# **Neural network evaluation**","8254e783":"# **Uploading the images**","b0abc57d":"# **Import from libraries**"}}