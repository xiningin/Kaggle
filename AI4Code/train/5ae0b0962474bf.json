{"cell_type":{"830fc99a":"code","caf83a82":"code","e6b741a2":"code","50627ef5":"code","4cbf06cd":"code","b8bf3578":"code","bf69a344":"code","0f25bd2d":"code","cbbd0021":"code","15a040f7":"code","dcc1fdb3":"code","752be79e":"code","59ecf50a":"code","ca7ee613":"code","0cc11169":"markdown","f879fbf7":"markdown","6b6fd1d3":"markdown","a6cfd9ad":"markdown","98939cf7":"markdown"},"source":{"830fc99a":"!pip install tensorflow-gpu==1.15.0 tensorflow==1.15.0 stable-baselines gym-anytrading gym","caf83a82":"# Gym stuff\nimport gym\nimport gym_anytrading\n\n# Stable baselines - rl stuff\nfrom stable_baselines.common.vec_env import DummyVecEnv\nfrom stable_baselines import A2C\n\n# Processing libraries\nimport numpy as np\nimport pandas as pd\nfrom matplotlib import pyplot as plt","e6b741a2":"df = pd.read_csv('..\/input\/gmedata\/gmedata.csv')","50627ef5":"df.head()","4cbf06cd":"df['Date'] = pd.to_datetime(df['Date'])\ndf.dtypes","b8bf3578":"df.set_index('Date', inplace=True)\ndf.head()","bf69a344":"env = gym.make('stocks-v0', df=df, frame_bound=(5,100), window_size=5)","0f25bd2d":"env.signal_features","cbbd0021":"env.action_space","15a040f7":"state = env.reset()\nwhile True: \n    action = env.action_space.sample()\n    n_state, reward, done, info = env.step(action)\n    if done: \n        print(\"info\", info)\n        break\n        \nplt.figure(figsize=(15,6))\nplt.cla()\nenv.render_all()\nplt.show()","dcc1fdb3":"env_maker = lambda: gym.make('stocks-v0', df=df, frame_bound=(5,100), window_size=5)\nenv = DummyVecEnv([env_maker])","752be79e":"model = A2C('MlpLstmPolicy', env, verbose=1) \nmodel.learn(total_timesteps=1000000)","59ecf50a":"env = gym.make('stocks-v0', df=df, frame_bound=(90,110), window_size=5)\nobs = env.reset()\nwhile True: \n    obs = obs[np.newaxis, ...]\n    action, _states = model.predict(obs)\n    obs, rewards, done, info = env.step(action)\n    if done:\n        print(\"info\", info)\n        break","ca7ee613":"plt.figure(figsize=(15,6))\nplt.cla()\nenv.render_all()\nplt.show()","0cc11169":"# 4. Evaluation","f879fbf7":"# 1. Bring in Marketwatch GME Data \nhttps:\/\/www.marketwatch.com\/investing\/stock\/gme\/download-data?startDate=11\/1\/2019&endDate=03\/12\/2021","6b6fd1d3":"# 3. Build Environment and Train","a6cfd9ad":"# 2. Build Environment","98939cf7":"# 0. Install and Import dependencies"}}