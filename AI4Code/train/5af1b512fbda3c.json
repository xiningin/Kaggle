{"cell_type":{"34601d34":"code","09234fed":"code","e902c072":"code","bd6799a2":"code","4cbf165e":"code","1d63eec2":"code","035cf85b":"code","914df0dd":"code","d2fc3faf":"code","d9186622":"code","5dfa7710":"code","abffb784":"code","0e23239b":"code","07603a40":"code","6af3546e":"markdown","1bee39b5":"markdown","63847803":"markdown","2be07cc1":"markdown","13674e54":"markdown","eccced72":"markdown","00af5da2":"markdown","edc122a2":"markdown","36e00662":"markdown","1b45652a":"markdown"},"source":{"34601d34":"import pandas as pd\nfrom bq_helper import BigQueryHelper","09234fed":"noaa_dataset = BigQueryHelper(\n        active_project= \"bigquery-public-data\", \n        dataset_name = \"noaa_gsod\"\n    )","e902c072":"noaa_dataset.list_tables()","bd6799a2":"noaa_dataset.head('gsod2019', num_rows=10)\n","4cbf165e":"noaa_dataset.table_schema('gsod2019')","1d63eec2":"noaa_dataset.head('stations', num_rows=10)","035cf85b":"query = \"\"\"\n    SELECT *\n    FROM `bigquery-public-data.noaa_gsod.stations`\n    WHERE country = \"GR\"\n\"\"\"\n\nGR_stations = noaa_dataset.query_to_pandas(query)\nGR_stations","914df0dd":"\nGR_stations[GR_stations['name'].str.contains('HERAKL')]","d2fc3faf":"GR_stations[GR_stations['name'].str.contains('IRAKL')]","d9186622":"GR_stations[GR_stations['name'].str.contains('NIKOS')]","5dfa7710":"query = \"\"\"\n    SELECT *\n    FROM `bigquery-public-data.noaa_gsod.gsod2000`\n    WHERE stn = '167540'\n    LIMIT 10\n\"\"\"\n\nnoaa_dataset.query_to_pandas(query)","abffb784":"query = \"\"\"\n    SELECT year,mo,da,temp,dewp,visib,wdsp,prcp,fog,rain_drizzle,snow_ice_pellets,hail,thunder,tornado_funnel_cloud\n    FROM `bigquery-public-data.noaa_gsod.gsod*`\n    WHERE stn = '167540'\n\"\"\"\n\nnoaa_dataset.estimate_query_size(query)\n","0e23239b":"weather_data = noaa_dataset.query_to_pandas(query)\nweather_data","07603a40":"weather_data_sorted = weather_data.sort_values(by=['year','mo','da']).reset_index().drop('index',axis=1)\nweather_data_sorted.to_csv('dataset.csv', index=False)","6af3546e":"## Preprocessing & Storing\n\nAll that's left to do is to sort the dataset's rows and store them to a CSV file.","1bee39b5":"First, let's get a list of the the dataset's tables and inspect one of them to see what we're dealing with","63847803":"Let's see if there's any data from Greek weather stations.","2be07cc1":"## Collect Weather Data From Nikos Kazantzakis Station","13674e54":"That's quite a lot of them! Let's try to find if there's any stations from Iraklion.","eccced72":"Hmmm, perhaps there's one from the local airport, Nikos Kazantzakis since the dataset also contains data from other Greek airports.","00af5da2":"## Exploring the NOAA GSOD Dataset","edc122a2":"Next, we're going to collect all weather data for the Nikos Kazantzakis airport weather station after checking its estimated size. Instead of selecting all columns, we'll limit ourselves to the ones that we're more likely to be using later, when training a machine learning or neural network model with this data.","36e00662":"Let's view the weather data of 10 days from 2000 collected from the Nikos Kazantzakis airport. We'll have to query the `gsod2000` table and locate 10 entries where their `stn` column matches the `usaf` code for our weather station, in this case `167540` as we saw in the `stations` table.","1b45652a":"## Introduction\n\nThis kernel shows how I extracted weather data about Heraklion, Crete, Greece from the NOAA GSOD dataset."}}