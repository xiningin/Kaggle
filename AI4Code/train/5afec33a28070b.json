{"cell_type":{"4b59fcd7":"code","8a8c23b3":"code","4aabab03":"code","7e6e591f":"code","fe288a28":"code","b68362d3":"code","782ba276":"code","3b2c320b":"code","6e49f363":"code","b9a18b6d":"code","4d42a12a":"code","bdbcbfa2":"markdown","f6533b31":"markdown","3ee1b28c":"markdown","f0ad7121":"markdown"},"source":{"4b59fcd7":"import numpy as np\nimport pandas as pd\nimport os\nimport random\nimport cv2\nfrom tqdm import tqdm\nfrom glob import glob\nimport shutil\nimport seaborn as sns\nimport yaml\nimport torch\nfrom IPython.display import Image, clear_output\nimport cv2\nimport matplotlib.pyplot as plt\nfrom matplotlib import animation, rc\nrc('animation', html='jshtml')","8a8c23b3":"if 'yolov5' in os.listdir('\/kaggle\/working\/'):\n    print('yolov5 exist')\nelse:\n    shutil.copytree('\/kaggle\/input\/yolov5-official-v31-dataset\/yolov5','\/kaggle\/working\/yolov5') \n\nos.chdir('\/kaggle\/working\/yolov5')\nclear_output()\n\nprint('Setup complete. Using torch %s %s' % (torch.__version__, torch.cuda.get_device_properties(0) if torch.cuda.is_available() else 'CPU'))","4aabab03":"if 'source0' in os.listdir('\/kaggle\/working\/'):\n    print('source0 exist')\nelse:\n    shutil.copytree('\/kaggle\/input\/face-mask-detection\/images','\/kaggle\/working\/source0') ","7e6e591f":"shutil.copy('\/kaggle\/input\/yolov5-classifier\/mask_best.pt','\/kaggle\/working\/yolov5') ","fe288a28":"!python detect.py --source ..\/source0 --weights mask_best.pt","b68362d3":"from matplotlib import animation, rc\nrc('animation', html='jshtml')","782ba276":"def create_animation(ims):\n    fig=plt.figure(figsize=(6,6))\n    plt.axis('off')\n    im=plt.imshow(cv2.cvtColor(ims[0],cv2.COLOR_BGR2RGB))\n    \n    def animate_func(i):\n        im.set_array(cv2.cvtColor(ims[i],cv2.COLOR_BGR2RGB))\n        return [im]\n\n    return animation.FuncAnimation(fig, animate_func, frames=len(ims), interval=1000)","3b2c320b":"imgdir ='\/kaggle\/working\/yolov5\/runs\/detect\/exp\/' ","6e49f363":"paths0=[]\nfor dirname, _, filenames in os.walk(imgdir):\n    for filename in filenames:\n        paths0+=[os.path.join(dirname, filename)]            ","b9a18b6d":"images0=[]\nfor i in tqdm(range(0,len(paths0),1)):\n    images0+=[cv2.imread(paths0[i])]","4d42a12a":"create_animation(np.array(images0))","bdbcbfa2":"## Set YOLOv5 system","f6533b31":"## Set images","3ee1b28c":"## Set best.pt","f0ad7121":"## Detect the object, ['with_mask', 'without_mask']"}}