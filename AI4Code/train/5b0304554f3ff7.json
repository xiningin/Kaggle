{"cell_type":{"1814b332":"code","0312bd43":"code","29ef8cb6":"code","d393c254":"code","1bae5b65":"code","df845c76":"code","1a34a2f1":"markdown"},"source":{"1814b332":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","0312bd43":"# Importing useful libraries\n\nimport pandas as pd \nimport numpy as np\nimport os\n\nimport keras\nfrom keras.models import load_model\nfrom PIL import Image","29ef8cb6":"model = load_model('..\/input\/my-cassava-dataset\/model_cassava.h5')","d393c254":"img_size = 224\ntest_images = os.listdir('\/kaggle\/input\/cassava-leaf-disease-classification\/test_images\/')\ny_preds = []\n\nfor i in test_images:\n    image = Image.open(f'\/kaggle\/input\/cassava-leaf-disease-classification\/test_images\/{i}')\n    image = image.resize((img_size, img_size))\n    image = np.expand_dims(image, axis=0)\n    y_preds.append(np.argmax(model.predict(image)))","1bae5b65":"df_sub = pd.DataFrame({'image_id': test_images, 'label': y_preds})\ndisplay(df_sub)","df845c76":"df_sub.to_csv('submission.csv',index=False)\n","1a34a2f1":"# Cassava Leaf Disease - TPU Tensorflow - Inference\n\n### This is the inference part of the work, the training notebook can be found here \n\nhttps:\/\/www.kaggle.com\/kutaykutlu\/tpus-resnet50-leaf-disease"}}