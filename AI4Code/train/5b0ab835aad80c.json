{"cell_type":{"540d0a0e":"code","68906fba":"code","16c21776":"code","c5247f54":"code","040b6964":"code","f3be3f2f":"code","12585e4d":"code","aeb35f7f":"code","de420d4f":"code","ef18324a":"code","3147198c":"code","9ce076d3":"code","9d7a9700":"code","679a0247":"code","52d936bd":"code","bec87324":"code","786a4e81":"code","02ebe4dc":"code","65e661d6":"code","8b98a66e":"code","0e156911":"code","56af84ab":"code","b3e9e98b":"code","e3a63fe8":"code","a8a094f6":"code","796e2cf8":"code","814ba033":"code","5068dcfe":"code","62c3b538":"code","f80ec653":"code","09993bef":"code","d9f3864d":"code","36083c69":"code","eac05513":"code","4442f0cd":"code","c2723ca7":"code","f3206e17":"code","1efe9968":"code","8b5b1dcf":"code","a96916b5":"code","573e18d8":"code","b4b7adfd":"code","87d86e1a":"code","285bb8c2":"markdown","09d48bcd":"markdown","07675d9a":"markdown","3b97e220":"markdown","a049381d":"markdown","82a619af":"markdown","c273e7f9":"markdown","e1b68b80":"markdown","98bd0741":"markdown","804aaf8e":"markdown","d20fd4df":"markdown","b14cac69":"markdown","831be388":"markdown","10881ea7":"markdown","40aa655b":"markdown","a4bf2e21":"markdown","ccd64f8f":"markdown","8b8c8509":"markdown","9cf4bd5f":"markdown","25bea0d5":"markdown","f9b307ec":"markdown","dd58c86d":"markdown","4a2216c3":"markdown","5b37746b":"markdown","d388c834":"markdown","fb5ab777":"markdown","7f5e0654":"markdown","dd6ac131":"markdown","16059529":"markdown","13f96db1":"markdown","c2576a13":"markdown","a6100208":"markdown"},"source":{"540d0a0e":"# import all packages and set plots to be embedded inline\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\n%matplotlib inline\n\n# suppress warnings \nimport warnings\nwarnings.simplefilter(\"ignore\")","68906fba":"#Reading the data frame \ndf = pd.read_csv(\"..\/input\/ford-gobike-2019feb-tripdata\/201902-fordgobike-tripdata.csv\")","16c21776":"pd.options.display.max_rows = 999999\ndf.head()","c5247f54":"#display the first 5 rows\ndf.info()","040b6964":"#describe the data - main statistics\ndf.describe()","f3be3f2f":"# Is there any duplicated rows?\ndf.duplicated().sum()","12585e4d":"df.isna().sum()","aeb35f7f":"# convert start_time and end_time into datetime \ndf.start_time = pd.to_datetime(df.start_time)\ndf.end_time = pd.to_datetime(df.end_time)\n\n# convert start_station_id, end_station_id, and bike_id into strings\ndf.start_station_id = df.start_station_id.astype('str')\ndf.end_station_id = df.end_station_id.astype('str')\ndf.bike_id = df.bike_id.astype('str')\n\n# convert user_type and member_gender into categories\ndf.user_type = df.user_type.astype('category')\ndf.member_gender = df.member_gender.astype('category')","de420d4f":"# quick check\ndf.info()","ef18324a":"# Percent of missing values in each column\n(df.isna().sum() \/ df.shape[0]) * 100","3147198c":"# filling in missing values \nfor col in [\"start_station_name\", \"end_station_name\", \"member_birth_year\", \"member_gender\"]:\n    df[col] = df[col].fillna(df[col].mode()[0])\n\ndf[\"member_gender\"] = df[\"member_gender\"].fillna(\"Male\")","9ce076d3":"# Percent of missing values in each column\n(df.isna().sum() \/ df.shape[0]) * 100","9d7a9700":"# add new columns for trip duration in minute, hour of the day, day of week and month\n\ndf['duration_minute'] = df['duration_sec']\/60\ndf['start_date'] = df.start_time.dt.strftime('%Y-%m-%d')\ndf['start_hourofday'] = df.start_time.dt.strftime('%H')\ndf['start_dayofweek'] = df.start_time.dt.strftime('%A')\ndf['start_month'] = df.start_time.dt.strftime('%B')\n\ndf.head()","679a0247":"# Calculating Age from 'member_birth_year'\ndf['member_age'] = 2021 - df['member_birth_year']\ndf.head()","52d936bd":"# trip distribution by duration\nplt.figure(figsize = (8, 4), dpi = 100)\n\nsns.histplot(data = df, x = \"duration_minute\")\nplt.xlim(0, 100)\nplt.title(\"trip distribution by duration in minutes\")\nplt.xlabel('Duration in minutes')\nplt.ylabel('Count')\nplt.axvline(x=30, color = \"red\")\nplt.show()","bec87324":"len(df[df[\"duration_minute\"] <= 30]) \/ len(df[\"duration_minute\"]) * 100","786a4e81":"len(df[df[\"duration_minute\"] > 60]) \/ len(df[\"duration_minute\"]) * 100","02ebe4dc":"# trip distribution over day hours\nplt.figure(figsize = (8,4), dpi = 100)\n\nbase_color = sns.color_palette()[0]\n\norder = df[\"start_hourofday\"].value_counts().index\n\nsns.countplot(data = df, x = \"start_hourofday\", color = base_color, order = order)\nplt.title(\"trip distribution over day hours\")\nplt.xticks(rotation = 90)\nplt.show()","65e661d6":"# trip distribution over day hours\nplt.figure(figsize = (8,4), dpi = 100)\n\nbase_color = sns.color_palette()[0]\n\nhour = ['00', '01', '02', '03', '04', '05', '06', '07', '08', '09', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '20', '21', '22', '23']\nhour_categ = pd.api.types.CategoricalDtype(ordered=True, categories=hour)\ndf['start_hourofday'] = df['start_hourofday'].astype(hour_categ)\n\n\nsns.countplot(data = df, x = \"start_hourofday\", color = base_color)\nplt.title(\"trip distribution over day hours\")\nplt.xlabel('Day hours')\nplt.ylabel('Count')\nplt.xticks(rotation = 90)\nplt.show()","8b98a66e":"# trip distribution over weekdays\nplt.figure(figsize = (8,4), dpi = 100)\n\nweekday = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday']\nweekday_categ = pd.api.types.CategoricalDtype(ordered=True, categories=weekday)\ndf['start_dayofweek'] = df['start_dayofweek'].astype(weekday_categ)\n\nsns.countplot(data=df, x='start_dayofweek', color=base_color)\nplt.xlabel('Trip Start Day of Week')\nplt.ylabel('Count')\nplt.title(\"Trip distribution over weekdays\")\n\nplt.show()","0e156911":"# trip distribution over months\nplt.figure(figsize = (8,4), dpi = 100)\n\nmonth = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December']\nmonth_categ = pd.api.types.CategoricalDtype(ordered=True, categories=month)\ndf['start_month'] = df['start_month'].astype(month_categ)\n\nsns.countplot(data=df, x='start_month', color=base_color)\nplt.xticks(rotation=90)\nplt.xlabel('Trip Start Month')\nplt.ylabel('Count')\n\nplt.title(\"Trip distribution over months\")\n\nplt.show()","56af84ab":"# Distribution of Age\nplt.figure(figsize = (8,4), dpi = 100)\n\nbins = np.arange(0, df['member_age'].max()+5, 5)\nsns.histplot(data=df, x='member_age', color=base_color, bins = bins)\nplt.xticks(rotation=90)\nplt.xlabel('Member age')\nplt.ylabel('Count')\n\nplt.title(\"Distribution of Age\")\n\nplt.show()","b3e9e98b":"len(df[df[\"member_age\"] <= 45]) \/ len(df[\"member_age\"]) * 100","e3a63fe8":"plt.figure(figsize = (8,4), dpi = 100)\n\nplot = sns.countplot(data=df, x='user_type', color=base_color)\nplt.xlabel('User Type')\nplt.ylabel('Count')\nplt.title(\"Distribution of Customers by type - count\")\n\nplt.show()","a8a094f6":"plt.figure(figsize = (8,4), dpi = 100)\n\ncounts = df['user_type'].value_counts(normalize = True)\nsns.barplot(x = counts.index, y = counts.values, color=base_color)\nplt.xlabel('User Type')\nplt.ylabel('Count')\nprint(counts * 100)\n\nplt.title(\"Distribution of Customers by type - percent\")\nplt.show()","796e2cf8":"plt.figure(figsize = (8,4), dpi = 100)\n\ncounts = df['member_gender'].value_counts(normalize = True)\nsns.barplot(x = counts.index, y = counts.values, color=base_color)\nplt.xlabel('Member Gender')\nplt.ylabel('Count')\nprint(counts * 100)\nplt.title(\"Distribution of Customers by gender\")\n\nplt.show()","814ba033":"df1 = df[df[\"duration_minute\"] <= 60]\ndf2 = df1[df[\"member_age\"] <= 80]\n\ndf2.head()","5068dcfe":"df2[\"duration_minute\"].describe()","62c3b538":"df2[\"member_age\"].describe()","f80ec653":"plt.figure(figsize = (8,4), dpi = 100)\n\nsns.boxplot(data = df2, x = \"member_gender\", y = \"duration_minute\")\nplt.xlabel('Gender');\nplt.ylabel('Trip Duration in Minute')\n\nplt.title(\"Distribution of trip duration by Gender\")\n\nplt.show()","09993bef":"plt.figure(figsize = (8,4), dpi = 100)\n\nsns.boxplot(data = df2, x = \"user_type\", y = \"duration_minute\")\nplt.xlabel('User Type');\nplt.ylabel('Trip Duration in Minute')\n\nplt.title(\"Distribution of trip duration by user type\")\n\nplt.show()","d9f3864d":"plt.figure(figsize = (8,4), dpi = 100)\n\nsns.barplot(data = df2, x = \"start_dayofweek\", y = \"duration_minute\", color=base_color)\nplt.xlabel('Day of Week');\nplt.ylabel('Avg. Trip Duration in Minute')\n\nplt.show()","36083c69":"plt.figure(figsize = (8,4), dpi = 100)\n\nsns.boxplot(data = df2, x = \"start_dayofweek\", y = \"duration_minute\", color=base_color)\nplt.xlabel('Day of Week');\nplt.ylabel('Avg. Trip Duration in Minute')\n\nplt.show()","eac05513":"plt.figure(figsize = (8,4), dpi = 100)\n\nsns.countplot(data=df2, x='start_dayofweek', hue='user_type')\nplt.xlabel('Trip Start Day of Week')\nplt.ylabel('Count')\nplt.title(\"Trip distribution over weekdays\")\n\nplt.show()","4442f0cd":"plt.figure(figsize = (8,4), dpi = 100)\n\nsns.countplot(data = df2, x = \"start_hourofday\", hue='user_type')\nplt.title(\"trip distribution over day hours - by user type\")\nplt.xlabel('Day hours')\nplt.ylabel('Count')\nplt.xticks(rotation = 90)\nplt.legend(bbox_to_anchor=(1.05, 1), loc='upper left')\n\nplt.show()","c2723ca7":"plt.figure(figsize = (8,4), dpi = 100)\n\nsns.scatterplot(data = df2, x = \"member_age\", y = \"duration_minute\", alpha = 0.3)\nplt.title(\"Rlationship between trip duration and age\")\nplt.xlabel('Day hours')\nplt.ylabel('Count')\nplt.xticks(rotation = 90)\n#lt.legend(bbox_to_anchor=(1.05, 1), loc='upper left')\n\nplt.show()","f3206e17":"# Distribution of Age\nplt.figure(figsize = (8,4), dpi = 100)\n\nsns.boxplot(data=df2, x = \"user_type\", y='member_age')\nplt.xticks(rotation=90)\nplt.xlabel('Member age')\nplt.ylabel('Count')\n\nplt.title(\"Distribution of Age by user type\")\n\nplt.show()","1efe9968":"plt.figure(figsize = (8,4), dpi = 100)\n\nsns.barplot(data = df2, x = \"start_dayofweek\", y = \"duration_minute\", hue='user_type')\nplt.xlabel('Day of Week');\nplt.ylabel('Avg. Trip Duration in Minute')\nplt.legend(bbox_to_anchor=(1.05, 1), loc='upper left')\nplt.title(\"Trip distribution over weekdays and by customer type\")\n\nplt.show()","8b5b1dcf":"plt.figure(figsize = (8,4), dpi = 100)\n\nsns.boxplot(data = df2, x = \"start_dayofweek\", y = \"duration_minute\", hue='user_type')\nplt.xlabel('Day of Week');\nplt.ylabel('Avg. Trip Duration in Minute')\nplt.legend(bbox_to_anchor=(1.05, 1), loc='upper left')\nplt.title(\"Trip distribution over weekdays and by customer type\")\n\nplt.show()","a96916b5":"plt.figure(figsize = (8,4), dpi = 100)\n\nsns.barplot(data = df2, x = \"start_hourofday\", y = \"duration_minute\",   hue='user_type', ci = None)\nplt.title(\"Trip duration over day hours and by customer type\")\nplt.xlabel('Day hours')\nplt.ylabel('Avg. Trip Duration in Minute')\nplt.xticks(rotation = 90)\nplt.legend(bbox_to_anchor=(1.05, 1), loc='upper left')\n\nplt.show()","573e18d8":"plt.figure(figsize = (8,4), dpi = 100)\n\nsns.boxplot(data = df2, x = \"start_hourofday\", y = \"duration_minute\", hue='user_type')\nplt.title(\"Trip duration over day hours and by customer type\")\nplt.xlabel('Day hours')\nplt.ylabel('Avg. Trip Duration in Minute')\nplt.xticks(rotation = 90)\nplt.legend(bbox_to_anchor=(1.05, 1), loc='upper left')\n\nplt.show()","b4b7adfd":"plt.figure(figsize = (8,4), dpi = 100)\n\nsns.heatmap(df2.corr(), cmap = \"viridis\", annot = True)\nplt.title(\"Correlation Matrix\")\nplt.xticks(rotation = 90)\nplt.legend(bbox_to_anchor=(1.05, 1), loc='upper left')\n\nplt.show()","87d86e1a":"plt.figure(figsize = (8,6), dpi = 100)\n\nplt.subplot(2, 1, 1)\ncustomers = df2[df2['user_type'] == \"Subscriber\"] \nct_counts = customers.groupby(['start_dayofweek', 'start_hourofday']).size()\nct_counts = ct_counts.reset_index(name='count')\nct_counts = ct_counts.pivot(index='start_dayofweek', columns='start_hourofday', values='count')\nsns.heatmap(ct_counts, cmap='rocket_r');\nplt.title('Subscriber', loc='right');\nplt.xlabel('Hour of Day');\nplt.ylabel('Day of Week');\n\nplt.subplot(2, 1, 2)\ncustomers = df2[df2['user_type'] == \"Customer\"] \nct_counts = customers.groupby(['start_dayofweek', 'start_hourofday']).size()\nct_counts = ct_counts.reset_index(name='count')\nct_counts = ct_counts.pivot(index='start_dayofweek', columns='start_hourofday', values='count')\nsns.heatmap(ct_counts, cmap='rocket_r');\nplt.title('Customer', loc='right');\nplt.xlabel('Hour of Day');\nplt.ylabel('Day of Week');\n\nplt.tight_layout()","285bb8c2":"### Feature Engineering ","09d48bcd":"### Correcting data types ","07675d9a":"**Graph Conclusion:** Subscribers have shorter trips, whearas casual riders (customers) have longer trips. ","3b97e220":"## Investigation Overview\n\n> The Goal of this presentation is to explore the main features of bike-sharing in the greater San Francisco Bay area. The main goal here is to specify the main determinants of trip duration by looking at the relationship between trip duration and other explanatory variables in the dataset. We try to answer the following questions:\n1. What does the distribution of trip duration look like?\n2. Which days have the highest demand on trips?\n3. Which hours during the day have the highest demand on trips?\n4. How trip duration differs by user age, hour, day, and user type?\n","a049381d":"## Univariate Exploration\n\n> In this section, we will investigate distributions of individual variables. If\nwe see unusual points or outliers, we will take a deeper look to clean things up\nand prepare ourself to look at relationships between variables.","82a619af":"**Graph Conclusion:** Males represent 75.7 percent of users, whereas Females represents 22.3 percent, the remainder is others with 1.99 percent","c273e7f9":"### Some of the relationships you observed in this part of the investigation:\n> 1. Customers have consistently longer trips than subscribers.\n2.Customers have consistently longer trips across all hours of the day. However, customer trips are much longer at midnight and midday\n3.There is a clear different usage pattern between customers and subscribers in the way we previously explained \n\n### Interesting or surprising interactions between features:\n\n> It was surbrizing to see customers rides mostly occur during midnight and midday","e1b68b80":"**Graph Conclusion:** A clear negative relatioship between age and trip duration","98bd0741":"### Problems found in the data so far:\n1. Many features have incorrect data type\n2. Many features have missing values","804aaf8e":"**Graph Conclusion:** All trips have been taken place in the month of February.  ","d20fd4df":"**Graph Conclusion:** The distribution follows a typical age distribution (Skewed to the right). It is consistent with the distribution of weekdays with those aged 20 - 45 are the most demanding segment for rides as they are the most active population either in work or study. ","b14cac69":"**Graph Conclusion:** Customers have consistently longer trips across all hours of the day. However, customer trips are much longer at midnight and midday","831be388":"**Graph Conclusion:** Customers represent 10.8 percent of users, whereas subscribers represents 89.2 percent.","10881ea7":"**Graph Conclusion:** Male riders seem to have shorter trips compared to females other gender gender types, this is edvident by smaller median and shorter IQR. However, the difference is very small and we are not sure whether it is significant or not.","40aa655b":"### The distribution(s) of variable(s) of interest:\n\n> 1. From the distribution of duraction we noticed that more than 96 percent of trips were less than 30 minutes. We also noticed that only 0.93 percent of trips are of duration more than 1 hour. These were considered as outliers and were removed before going further in the bivariate analysis.\n2. We also noticed that peak hours are those from 7 - 9 am and from 4 - 6 pm. This might be related to the time when employees and students go to and leave work and school. This is was also consistent with the distribution of trips over weekdays, where work days have the most demand for trips.\n3. Age distribution follows any typical age distribution (Skewed to the right). It is consistent with the distribution of weekdays with those aged 20 - 45 are the most demanding segment for rides as they are the most active population either in work or study.\n4. Customers represent 10.8 percent of users, whereas subscribers represents 89.2 percent\n5. Males represent 75.7 percent of users, whereas Females represents 22.3 percent, the remainder is others with 1.99 percent\n\n### Unusual distributions:\n\n> 1. The distribution of duration was surprising, 96 percent of trips were 30 mintes or less. There were some outliers that we removed.\n2. The Age has also some outliers that we removed.\n3. We created new features out of the time variable","a4bf2e21":"## Dataset Overview\n\n> This data set includes information about individual rides made in a bike-sharing system covering the greater San Francisco Bay area.\nThe data set has been stored as a pandas dataframe, It has 16 columns and 183412 rows. The features cover 3 main areas: \n1. trip duration\n2. station information\n3. member information","ccd64f8f":"**Graph Conclusion:** There is a clear different usage pattern between customers and subscribers in the way we previously explained","8b8c8509":"**Graph Conclusion:** From the graph we can notice that peak hours are those from 7 - 9 am and from 4 - 6 pm. This might be related to the time when employees and students go to and leave work and school.","9cf4bd5f":"**Graph Conclusion:** from the distribution of duraction we can notice that more than 96 percent of trips were less than 30 minutes. We can also notice that only 0.93 percent of trips are of duration more than 1 hour. These might be considered as outliers that needs to be removed before going further in the bivariate analysis. ","25bea0d5":"## Bivariate Exploration\n\n> In this section, we will investigate relationships between pairs of variables in our\ndata.","f9b307ec":"### The structure the dataset:\n\n> The data set has been stored as a pandas dataframe, It has 16 columns and 183412 rows. The features cover 3 main areas: \n1. trip duration\n2. station information\n3. member information\n\n### The main feature(s) of interest:\n> 1. duration_sec\n2. duration_minute\n\n\n### Features that will help support our investigation:\n> 1. member_birth_year\n2. member_age\n3. member_gender\n4. bike_share_for_all_trip\n5. start_month\n6. start_dayofweek\n7. user_type","dd58c86d":"## Multivariate Exploration\n","4a2216c3":"**Graph Conclusion:** From the graph we can notice that peak hours for both user types are those from 7 - 9 am and from 4 - 6 pm. This might be related to the time when employees and students go to and leave work and school.","5b37746b":"**Graph Conclusion:** The demand for trips gradually increases untill reaching its highest levels on Thursday, it then declines untill reaching its lowest levels on Saturday and Sunday. This is due to the fact that Saturday and Sunday are the weekend in the United States of America.","d388c834":" #### Duration distribution by member gender\n    ","fb5ab777":"**Graph Conclusion:** Customers have consistently longer trips than subscribers","7f5e0654":"#### Removing outliers","dd6ac131":"#### Load the dataset and describe its properties","16059529":"**Graph Conclusion:** Subscribers seem to have consistent usage for a specific purpose every day, mainly: work and study. As a result the number of their rides declines the most at weekends  ","13f96db1":"### Filling in Missing Data","c2576a13":"**Graph Conclusion:** The graph reflects stable use along work days. Trip duration is longer during weekends, reflecting more casual and entertainment usage.  ","a6100208":"### Some of the relationships observed in this part of the investigation:\n\n> There are way more subscribers than customers. Subscribers usage seem to be very consistent and standard, their usage is intended for daily routine such as work or study. Therfore subscribers usage reaches its highest levels during rush hours and work days. Customers on the other hand tend to use bikes for fun, their usage is concentrated during weekends at midnights and middays.   \n\n### Interesting relationships between the other features:\n\n> It was surbrizing to see customers rides mostly occur during midnight and midday"}}