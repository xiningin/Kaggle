{"cell_type":{"58edfc0e":"code","daa23c22":"code","66429b46":"code","bb181b40":"code","b03a6ed9":"code","021990fd":"code","f1eec70c":"code","be7562ab":"code","be28cb25":"code","603b07e0":"code","dba5a435":"code","4f273238":"code","db6d654c":"code","cd09292c":"code","3c11d5cd":"code","9c32c8bc":"code","6b2e95f9":"markdown","0da5b258":"markdown","6ceff7f6":"markdown","b1d220b2":"markdown","14e937ea":"markdown","aceeed21":"markdown"},"source":{"58edfc0e":"import numpy as np\nimport pandas as pd\n\nimport plotly.express as px\n\nfrom fbprophet import Prophet","daa23c22":"data = pd.read_csv('..\/input\/temperature-change\/Environment_Temperature_change_E_All_Data_NOFLAG.csv', encoding='latin-1')","66429b46":"data","bb181b40":"data.info()","b03a6ed9":"def preprocess_inputs(df):\n    df = df.copy()\n    \n    # Remove the standard deviation examples\n    df = df.query(\"Element == 'Temperature change'\")\n    \n    # Group countries and take their means\n    df = df.groupby('Area').mean()\n    \n    # Use only time series data\n    df = df.loc[:, 'Y1961':]\n    \n    # Get global mean temperature change\n    df = pd.DataFrame(df.mean()).reset_index(drop=False)\n    \n    # Rename columns\n    df.columns=['ds', 'y']\n    \n    # Fix year column\n    df['ds'] = df['ds'].apply(lambda x: x[1:]).astype(np.int)\n    \n    return df","021990fd":"time_series = preprocess_inputs(data)","f1eec70c":"time_series","be7562ab":"fig = px.line(\n    time_series,\n    x='ds',\n    y='y',\n    labels={'ds': \"Year\", 'y': \"Change in temperature (\u00b0C)\"},\n    title=\"Average Global Temperature Change Over Time\"\n)\n\nfig.show()","be28cb25":"time_train = time_series.iloc[:44, :].copy()\ntime_test = time_series.iloc[44:, :].copy()","603b07e0":"in_model = Prophet()\nin_model.fit(time_train)","dba5a435":"in_forecast = in_model.predict(time_test).loc[:, ['ds', 'yhat']]\nin_forecast['ds'] = in_forecast['ds'].apply(lambda x: x.year)\nin_forecast","4f273238":"in_result_df = time_series.merge(in_forecast, on='ds', how='left')\n\nfig = px.line(\n    in_result_df,\n    x='ds',\n    y=['y', 'yhat'],\n    color_discrete_sequence=['black', 'red'],\n    labels={'ds': \"Year\"},\n    title=\"Average Global Temperature Change Over Time\"\n)\n\nfig.show()","db6d654c":"future_df = pd.DataFrame(np.arange(2020, 2046), columns=['ds'])\nfuture_df","cd09292c":"out_model = Prophet()\nout_model.fit(time_series)","3c11d5cd":"out_forecast = out_model.predict(future_df).loc[:, ['ds', 'yhat']]\nout_forecast['ds'] = out_forecast['ds'].apply(lambda x: x.year)\nout_forecast","9c32c8bc":"out_result_df = pd.concat([time_series, out_forecast], axis=0)\n\nfig = px.line(\n    out_result_df,\n    x='ds',\n    y=['y', 'yhat'],\n    color_discrete_sequence=['black', 'red'],\n    labels={'ds': \"Year\"},\n    title=\"Average Global Temperature Change Over Time\"\n)\n\nfig.show()","6b2e95f9":"# Data Every Day  \n\nThis notebook is featured on Data Every Day, a YouTube series where I train models on a new dataset each day.  \n\n***\n\nCheck it out!  \nhttps:\/\/youtu.be\/ZJouexySecc","0da5b258":"# In-Sample Forecast","6ceff7f6":"# Preprocessing","b1d220b2":"# Task for Today  \n\n***\n\n## Global Temperature Time Series Forecasting  \n\nGiven *time series data about temperatures in different countries*, let's try to predict the **change in average global temperature** for the next 15 years.\n\nWe will use a Facebook's Prophet model to make our predictions. ","14e937ea":"# Out-of-Sample Forecast","aceeed21":"# Getting Started"}}