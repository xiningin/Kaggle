{"cell_type":{"ac70c40a":"code","6d4e3dd2":"code","cdfd0a2d":"code","65ef3b60":"code","4de93d61":"code","e3f96f9a":"code","463c7716":"code","4d93ac60":"code","e97d7b4e":"code","3ab2323b":"code","f60535c2":"markdown"},"source":{"ac70c40a":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","6d4e3dd2":"# Import necessary packages for exploratory analysis and data visualization\nimport matplotlib.pyplot as plt\nimport seaborn as sns","cdfd0a2d":"# Exploratory analysis\ndata = pd.read_csv('\/kaggle\/input\/used-car-dataset-ford-and-mercedes\/toyota.csv')\n\ndata.info()\ndata.describe()\ndata.head()","65ef3b60":"# Visualizing price vs. mileage by model\nsns.scatterplot(data = data, x = 'mileage', y = 'price', hue = 'model', palette = 'tab20')","4de93d61":"# Import necessary packages for model development\nfrom sklearn.ensemble import GradientBoostingRegressor\nfrom sklearn.metrics import r2_score\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import OneHotEncoder","e3f96f9a":"# Set random seed for reproducibility\nrs = 420","463c7716":"# Encoding features and assigning X variable\nenc = OneHotEncoder()\nX = enc.fit_transform(data.drop('price', axis = 1).copy())","4d93ac60":"# Assigning y variable\ny = data['price'].copy()","e97d7b4e":"# Split data into training and test subsets\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.2, random_state = rs)","3ab2323b":"# Model development\nmodel = GradientBoostingRegressor(loss = 'huber', learning_rate = 0.65)\nmodel.fit(X_train, y_train)\npreds = model.predict(X_test)\n    \nr2_score(y_test, preds)","f60535c2":"**Toyota Sales Price Regression**\n\n*prepared by Graeme Benson*\n\n*updated June 11, 2021*\n\nFor this task, I will be focusing on the Toyota subset of the \"100,000 UK Used Car Data set\" available at https:\/\/www.kaggle.com\/adityadesai13\/used-car-dataset-ford-and-mercedes "}}