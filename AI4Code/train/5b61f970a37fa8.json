{"cell_type":{"981bcf65":"code","e5d21cc1":"code","82eea6f5":"code","978ac215":"code","10d9f413":"code","91ecfba6":"code","5b6b15a6":"code","a53b232e":"code","1245c8d5":"code","59d3820d":"markdown","81e5eabd":"markdown","f970c33f":"markdown","2a9afa5c":"markdown","4225b373":"markdown"},"source":{"981bcf65":"! pip install PyDictionary\n! python -m spacy download en_core_web_md","e5d21cc1":"import warnings\nwarnings.filterwarnings(\"ignore\")\n\nimport re\nimport nltk\nimport spacy\nimport random\nimport numpy as np\nimport pandas as pd\nfrom tqdm import tqdm\nimport en_core_web_md\nfrom nltk.corpus import wordnet\nfrom PyDictionary import PyDictionary","82eea6f5":"train_df = pd.read_csv(\"..\/input\/commonlitreadabilityprize\/train.csv\")\ntrain_df.drop(['url_legal','license','standard_error'], inplace=True, axis=1)\ntrain_df.set_index(\"id\", inplace=True)\nprint(f\"train_df: {train_df.shape}\\n\")\ntrain_df.head()","978ac215":"percent = 20","10d9f413":"def synalter_Noun_Verb(word, a1, POS):\n    \n    max_temp = -1\n    flag = 0\n    \n    for i in a1:\n        try:\n            w1 = wordnet.synset(word + '.' + POS + '.01') \n            w2 = wordnet.synset(i + '.' + POS + '.01')\n\n            if(max_temp < w1.wup_similarity(w2)):\n                max_temp = w1.wup_similarity(w2)\n                temp_name = i\n                flag = 1\n        except:\n            f=0\n            \n    if flag == 0:\n        max1 = -1.\n        nlp = en_core_web_md.load()\n        \n        for i in a1:\n            j=i.replace(' ', '')\n            tokens = nlp(u'' + j)\n            token_main = nlp(u'' + word)\n            \n            for token1 in token_main:\n                if max1<float(token1.similarity(tokens)):\n                    max1 = token1.similarity(tokens)\n                    value = i\n                    \n        max1 = -1.\n        return value\n    \n    else:\n        return temp_name","91ecfba6":"def text_replacement(text):\n\n    synonyms = [] \n    antonyms = []\n\n    output_text = text\n    print(f\"Original Text: \\n\\n{text}\\n\")\n    print(\"=\"*90)\n\n    words = text.split()\n    counts = {}\n\n    for word in words:\n        if word not in counts:\n            counts[word] = 0\n\n        counts[word] += 1\n\n    one_word = []\n\n    for key, value in counts.items():\n        if value == 1 and key.isalpha() and len(key)>2:\n            one_word.append(key)\n\n    noun = []\n    verb = []\n\n    nlp = en_core_web_md.load()\n    doc = nlp(u''+' '.join(one_word))\n\n    for token in doc:\n        if  token.pos_ == 'VERB':\n            verb.append(token.text)\n\n        if  token.pos_ == 'NOUN':\n            noun.append(token.text)\n\n    all_main =verb + noun\n    len_all = len(noun)+len(verb)\n    final_value = int(len_all * percent \/100)\n\n    random.seed(0)\n    dictionary=PyDictionary()\n    temp = random.sample(range(0, len_all), final_value)\n\n    for i in tqdm(temp):\n        word_str = all_main[i]\n        a1 = dictionary.synonym(word_str)\n        \n        if a1 is None:\n            continue\n        \n        else:\n            if i < len(verb):\n                change_word=synalter_Noun_Verb(word_str, a1, 'v')\n                search_word = re.search(r'\\b('+word_str+r')\\b', output_text)\n                Loc = search_word.start()\n                output_text = output_text[:int(Loc)] + '[' + change_word + ']' + output_text[int(Loc) + len(word_str):]\n\n            else:\n                change_word=synalter_Noun_Verb(word_str, a1, 'n')\n                search_word = re.search(r'\\b('+word_str+r')\\b', output_text)\n                Loc = search_word.start()\n                output_text = output_text[:int(Loc)] + '[' + change_word + ']' + output_text[int(Loc) + len(word_str):]\n    \n    print(\"=\"*90)\n    print(f'\\nAugmented Text:\\n\\n{output_text}\\n')","5b6b15a6":"%%time\ntext_replacement(train_df.iloc[0]['excerpt'])","a53b232e":"%%time\ntext_replacement(train_df.iloc[100]['excerpt'])","1245c8d5":"%%time\ntext_replacement(train_df.iloc[1000]['excerpt'])","59d3820d":"## Load source datasets","81e5eabd":"## Set percentage level \n\n**(number of words to be replaced for augmentation)**","f970c33f":"## Import libraries","2a9afa5c":"## Word Similarity Check\n\n**(aim is to return the most similar word to the given input word)**","4225b373":"## Text Replacement\n\n1. Count the total number of Unique words and make a dictionary\n2. Filter out unique words and eliminate 2 letters word & numbers\n3. Make a list of Noun and Verb using spacy from the above-filtered list\n4. Random selection from Noun and Verb along with above mention percentage\n5. Loop all the randomly selected words\n   * create a word_str variable to store a word.\n   * Finding out all the synonyms using the thesaurus and making a list.\n   * Checking If a selected word is Noun or Verb and than passing to `synalter_Noun_Verb(word, al, POS)`\n   \n   \n6. Replacing the word with the new most similar word"}}