{"cell_type":{"d1881949":"code","a74b57c2":"code","9084abd2":"code","7e266827":"code","14fe93af":"code","eb6f597a":"code","273ffe80":"code","df597337":"code","8efbcc4d":"code","43eb91ae":"code","19009258":"code","b5ba8627":"code","a258ba1f":"markdown"},"source":{"d1881949":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nimport hvplot.pandas\nprint(os.listdir(\"..\/input\"))\nfrom sympy import isprime, primerange\n\n# Any results you write to the current directory are saved as output.","a74b57c2":"df = pd.read_csv('..\/input\/concorde-for-5-min\/submission.csv')","9084abd2":"cities = pd.read_csv(\"..\/input\/traveling-santa-2018-prime-paths\/cities.csv\")\ncities['isPrime'] = cities.CityId.apply(isprime)\nprime_cities = cities.loc[cities.isPrime]","7e266827":"def score_path(path):\n    cities = pd.read_csv('..\/input\/traveling-santa-2018-prime-paths\/cities.csv', index_col=['CityId'])\n    pnums = [i for i in primerange(0, 197770)]\n    path_df = cities.reindex(path).reset_index()\n    \n    path_df['step'] = np.sqrt((path_df.X - path_df.X.shift())**2 + \n                              (path_df.Y - path_df.Y.shift())**2)\n    path_df['step_adj'] = np.where((path_df.index) % 10 != 0,\n                                   path_df.step,\n                                   path_df.step + \n                                   path_df.step*0.1*(~path_df.CityId.shift().isin(pnums)))\n    return path_df","14fe93af":"df2=score_path(df['Path'].values)","eb6f597a":"df2['Penalty']=df2['step_adj']-df2['step']","273ffe80":"df3=df2[['CityId','Penalty']]\ndf4=df3[['Penalty']]","df597337":"df4.hvplot()","8efbcc4d":"sample = df2[['X','Y','Penalty']][:500]","43eb91ae":"sample.hvplot('X','Y') * sample.hvplot.scatter('X', 'Y',c='Penalty',size=15) ","19009258":"#df4=df3.fillna(0).sort_values(by=['CityId'])\n#df5=df4[['Penalty']].reset_index()[['Penalty']]\n#df5.hvplot()","b5ba8627":"def penalty(df):\n return (df.values.reshape(197770)[np.arange(10,107770,10)]!=0).astype(int).sum()","a258ba1f":"Original inspiration: https:\/\/www.kaggle.com\/c\/traveling-santa-2018-prime-paths\/discussion\/74737"}}