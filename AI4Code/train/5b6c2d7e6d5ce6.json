{"cell_type":{"18240017":"code","000c4a9e":"code","19e9853f":"code","eca14fa5":"code","b7febde7":"code","3297dad2":"code","ec3347db":"code","53f330c0":"code","ed445a58":"code","845e876d":"code","5ecbe9b9":"code","bb8007bc":"code","4affe818":"code","f9af48e6":"code","f087259d":"code","5539bdfd":"code","db683feb":"code","9a2d43de":"code","9c006180":"code","645bd827":"code","07232fec":"markdown","14d7cf1a":"markdown","c98932ff":"markdown","c9ac320f":"markdown","c0e7e2d8":"markdown","1ac6cbf2":"markdown","9f09452b":"markdown"},"source":{"18240017":"!pip install --upgrade transformers","000c4a9e":"import librosa\nimport torch\nimport IPython.display as display\nfrom transformers import Wav2Vec2ForCTC, Wav2Vec2Tokenizer\nimport numpy as np","19e9853f":"#load pre-trained model and tokenizer\ntokenizer = Wav2Vec2Tokenizer.from_pretrained(\"facebook\/wav2vec2-large-960h-lv60-self\")\nmodel = Wav2Vec2ForCTC.from_pretrained(\"facebook\/wav2vec2-large-960h-lv60-self\")","eca14fa5":"#load audio file \naudio, sampling_rate = librosa.load(\"..\/input\/automatic-speech-recognition-in-wolof\/clips\/clips\/0031672b4484f963c8a07babe6f713dd559539d44140e80ac19708db36d9712d81dd5b170c016f65bbd6763372c35bfc984a55448e356f3161dbf8d7c28aa047.mp3\",sr=16000)","b7febde7":"audio,sampling_rate","3297dad2":"# audio\ndisplay.Audio(\"..\/input\/automatic-speech-recognition-in-wolof\/clips\/clips\/0031672b4484f963c8a07babe6f713dd559539d44140e80ac19708db36d9712d81dd5b170c016f65bbd6763372c35bfc984a55448e356f3161dbf8d7c28aa047.mp3\", autoplay=True)","ec3347db":"input_values = tokenizer(audio, return_tensors = 'pt').input_values\ninput_values","53f330c0":"# store logits (non-normalized predictions)\nlogits = model(input_values).logits\nlogits","ed445a58":"# store predicted id's\n# pass the logit values to softmax to get the predicted values\npredicted_ids = torch.argmax(logits, dim =-1)","845e876d":"# pass the prediction to the tokenzer decode to get the transcription\ntranscriptions = tokenizer.decode(predicted_ids[0])","5ecbe9b9":"transcriptions","bb8007bc":"import pandas as pd\ntest = pd.read_csv(\"..\/input\/automatic-speech-recognition-in-wolof\/Test.csv\")","4affe818":"test_trans=[]\nfor x in test.ID:\n    audio, sampling_rate = librosa.load(\"..\/input\/automatic-speech-recognition-in-wolof\/audio_wav_16000\/tmp\/WOLOF_ASR_dataset\/audio_wav_16000\/\"+str(x)+\".wav\",sr=16000)\n    input_values = tokenizer(audio, return_tensors = 'pt').input_values\n    logits = model(input_values).logits\n    predicted_ids = torch.argmax(logits, dim =-1)\n    transcriptions = tokenizer.decode(predicted_ids[0])\n    test_trans.append(transcriptions)","f9af48e6":"test[\"transcription\"]=test_trans\ntest.head()","f087259d":"lower_trans=[]\nfor x in test[\"transcription\"]:\n    lower_trans.append(x.lower())\ntest[\"transcription\"] = lower_trans\ntest.head()","5539bdfd":"test[[\"ID\",\"transcription\"]].to_csv(\"submission.csv\",index=False)","db683feb":"sum(test[\"ID\"]==\"e3a74a8998f03c320f5a4923272247\")","9a2d43de":"test.isna().sum()","9c006180":"sub = pd.read_csv(\"..\/input\/automatic-speech-recognition-in-wolof\/SampleSubmission.csv\")\nsub[\"transcription\"]=test_trans\nlower_trans_1=[]\nfor x in sub[\"transcription\"]:\n    lower_trans_1.append(x.lower())\nsub[\"transcription\"] = lower_trans_1\n\nsub.head()","645bd827":"sub[[\"ID\",\"transcription\"]].to_csv(\"submission1.csv\",index=False)","07232fec":"# Play the Audio","14d7cf1a":"### Import Libraries","c98932ff":"First of all tokenize the input values,take the maximum prediction from the logit and then extraxt the text","c9ac320f":"In this notebook we are going to see how to convert speech into text using Facebook Wav2Vec 2.0 model.Wav2Vec2 is a speech model that accepts a float array corresponding to the raw waveform of the speech signal. Wav2Vec2 model was trained using connectionist temporal classification (CTC) so the model output has to be decoded using Wav2Vec2Tokenizer.For learning more about it click on this [link](https:\/\/huggingface.co\/transformers\/model_doc\/wav2vec2.html)","c0e7e2d8":"### Load Audio file","1ac6cbf2":"### Load pre-trained Wav2Vec model","9f09452b":"### Speech to Text"}}