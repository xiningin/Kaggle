{"cell_type":{"c8aeac1b":"code","fc5a32b8":"code","0a76630e":"code","ad7acfae":"code","9bef21ef":"code","77a798fd":"code","12fb1e96":"code","8899d1dd":"code","bc4bbfef":"code","c94516fb":"code","ea7fddf6":"code","ec2632db":"code","571a89e6":"markdown","7c1967b4":"markdown","b3986bde":"markdown","4fde3ca0":"markdown","f1c50c87":"markdown","fc31ac20":"markdown","68e78f8c":"markdown","b3605d99":"markdown","b2cfe3de":"markdown"},"source":{"c8aeac1b":"import pandas as pd\nimport seaborn as sns\ndf = pd.read_excel('..\/input\/Fuel_Transactions_by_Oil_Company.xlsx')\ndf.info()","fc5a32b8":"df['Brand Description'].value_counts()","0a76630e":"df['Fuel Type'].value_counts() #two types of fuel","ad7acfae":"df['PPL'] = df['Amount'] \/ df['Quantity'] #lets bring in the price per litre\n#remove price regulated fuel types in South Africa from the dataframe, in this case petrol\ndf = df[df['Fuel Type'] != 'Petrol']","9bef21ef":"import pandas_profiling\ndf.profile_report()","77a798fd":"plot = sns.lineplot(x='Transaction Date', y='PPL', data=df, hue='Brand Description') #plot for interest","12fb1e96":"df = df[df.duplicated(subset=['Merchant Town'], keep=False)] #address merchant towns\ndf = df.sort_values(by=['Brand Description', 'Transaction Date']) #address time\ndf['Date Diff'] = df['Transaction Date'].diff() \npd.to_datetime(df['Date Diff'])\ndf['total_days_td'] = df['Date Diff'] \/ pd.to_timedelta(1, unit='D')\ndf = df[df['total_days_td'] >= 0] #remove brand description group days difference overlap\ndf = df.groupby('Brand Description').filter(lambda g: (g.total_days_td < 30).all()) #filter brands not used within 30 days\ndf['Brand Description'].unique() #lets check the sample","8899d1dd":"df = df[df['Brand Description'] != 'OTHER\/ANDER'] #Remove unidentified fuel brands\ndf = df[df['Brand Description'] != 'BRENT OIL'] #Remove unidentified fuel brands\ndf = df[df['Brand Description'] != 'SERVICES AND MAINTENANCE'] #Remove unidentified brands\ndf['Brand Description'].unique() #our resultant sample groups","bc4bbfef":"plot = sns.lineplot(x='Transaction Date', y='PPL', data=df, hue='Brand Description')","c94516fb":"df['MA'] = df.groupby('Brand Description')['PPL'].transform(lambda x: x.rolling(30, 1).mean())\nplot = sns.lineplot(x='Month', y='MA', data=df, hue='Brand Description')","ea7fddf6":"plot = sns.barplot(x='Brand Description', y='PPL', data=df)","ec2632db":"df.groupby('Brand Description')['PPL'].mean().sort_values()","571a89e6":"We can plot the 30 day moving average PPL for each brand for interest and see if there is more of an identifiable trend","7c1967b4":"3) Calculating Aggregates","b3986bde":"1) Data Cleaning and Exploration","4fde3ca0":"# TIME SERIES ANALYSIS, COMPARING AGGREGATED UNREGULATED FUEL PRICES AMONGST LEADING SOUTH AFRICAN OIL COMPANIES**","f1c50c87":"Lastly, we can plot the average PPL per brand over the time period - answering our main question","fc31ac20":"Since this is a time-series analysis, we'll need to address the logical known influencing factors on PPL: location and time. \n\nWith the influencing factors in mind, we will only sample groups with observations taken in the same month and same location (merchant town):","68e78f8c":"4) Conclusion\nAs we can see, the unregulated fuel PPL (diesel) per oil company has been plotted and aggregated. We notice that there are slight differences in prices in oil companies. It is worth reiterating that the location of a merchants fuel station is correlating to the PPL - this is due to the logistical costs of getting the fuel from the refineries to the different locations. Thus, aggregated functions is the only method to compare the unregulated fuel PPLs.","b3605d99":"### Introduction\n\nThe dataset contains individual transactions made on fleet fuel cards (garage cards) belonging to a private company's fleet of vehicles, mainly located around South Africa. South Africa has a watchful eye on their fuel prices, typically due to it's volatility. \n\nHaving this disposable data, there is a motivation to aggregate, or atleast get an idea, how competitive unregulated fuel prices are amongst leading oil companies operating in South Africa. \n\nAt the end of this time-series analysis, an answer should be available to \"On average, what is the cheapest oil company to buy diesel from?\"\n\n### Breakdown\n* Data cleaning and exploration\n* Plotting the price per litre for unregulated fuel\n* Getting aggregates\n* Conclusions\n\n------------","b2cfe3de":"2) Creating plots"}}