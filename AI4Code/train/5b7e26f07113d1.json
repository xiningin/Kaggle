{"cell_type":{"c4a9530d":"code","8e3802ca":"code","66565b47":"code","625efd5f":"code","1c9f4ec1":"code","1d5203a8":"code","7edc759e":"code","7ebbb0b0":"code","4a86c92e":"code","9505e0e8":"code","77cf1507":"code","8af9d92e":"code","7b11e406":"code","6f461e97":"code","838abb6b":"code","e393bc22":"code","c822d2a8":"code","03b220f8":"code","847f05f0":"code","e2ca4e04":"code","4899c15d":"code","1e899dd2":"code","153387ac":"code","4fd06deb":"code","ce2c6c5b":"code","e504ac55":"code","7333ae99":"code","5217f1e7":"code","bf4f9956":"code","b4b37a0e":"code","962bdc19":"code","4dc665a0":"code","77f8cb8c":"code","82efd015":"code","4b368f23":"code","93ae1ba1":"code","41556990":"code","195732c9":"code","5111429f":"code","254b8309":"code","5721f699":"code","7c2098c0":"code","6c0129e0":"code","4a079a1e":"code","c0b594b6":"code","80966b95":"code","bea83b69":"code","44f36149":"code","f4ff17c9":"code","19dfdb3d":"markdown","1d678f8f":"markdown","8bbcb7b8":"markdown","3d388899":"markdown","ec4f7082":"markdown","fd7d4527":"markdown","cc96a975":"markdown","f03b3183":"markdown","1a5fe844":"markdown","3199eb9d":"markdown","8a197996":"markdown","50f78ca9":"markdown","d7aa5e09":"markdown","6b6c1891":"markdown","d7369c78":"markdown","a6c6b6b1":"markdown","4bccebbe":"markdown","3d500c41":"markdown","ad225f7c":"markdown","db68cbe3":"markdown","489dce8a":"markdown","e51acfae":"markdown","446ff773":"markdown","8bd382de":"markdown","a4aacecb":"markdown","b0fa6a6d":"markdown","3b2b6a6f":"markdown","18fe7699":"markdown","79aa8e8f":"markdown","8e547013":"markdown","efdc8a39":"markdown","0cf609ac":"markdown","feefb146":"markdown","cecbd554":"markdown","9ad02c47":"markdown","21f91a67":"markdown"},"source":{"c4a9530d":"#  import libraries\nimport numpy as np \nimport pandas as pd \nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline\n\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import accuracy_score\n","8e3802ca":"df= pd.read_csv('..\/input\/noshowappointments\/KaggleV2-May-2016.csv')\ndf.head()","66565b47":"#exploration data shape \ndf.shape","625efd5f":"#the basic information about the data \ndf.info()","1c9f4ec1":"df.duplicated().any()","1d5203a8":"#Find out the null values in the data\ndf.isnull().sum()","7edc759e":"# Converting the date information in string to datetime type:\n\ndf.AppointmentDay=pd.to_datetime(df.AppointmentDay)\ndf.ScheduledDay=pd.to_datetime(df.ScheduledDay)\n","7ebbb0b0":"df.info()","4a86c92e":"df.drop(['AppointmentDay', 'ScheduledDay'], axis=1, inplace=True)\n","9505e0e8":"df.head()","77cf1507":"df.drop(['PatientId', 'AppointmentID'], axis=1, inplace=True)\n","8af9d92e":"df.head()","7b11e406":"df= df.rename(columns={'No-show': 'Noshow'})","6f461e97":"df['Noshow'].value_counts()","838abb6b":"plt.style.use('bmh')","e393bc22":"\nax = sns.countplot(x=df.Noshow, data=df)\nax.set_title(\"Show\/NoShow Patients\")\nplt.show()","c822d2a8":"print(\"Unique Values in `Gender` \",  df.Gender.unique())","03b220f8":"df['Gender'].value_counts()","847f05f0":"ax = sns.countplot(x=df.Gender, hue=df.Noshow, data=df)\nax.set_title(\"Show\/NoShow for Females and Males\")\nx_ticks_labels=['Female', 'Male']\nax.set_xticklabels(x_ticks_labels)\nplt.show()","e2ca4e04":"np.sort(df.Age.unique())","4899c15d":"df[df.Age == -1].shape[0]","1e899dd2":"df = df[df.Age >= 0]","153387ac":"df.shape","4fd06deb":"plt.figure(figsize=(16,4))\nplt.xticks(rotation=90)\nax = sns.countplot(x=df.Age, hue=df.Noshow)\nax.set_title(\"Show\/NoShow of Appointments by Age\")\nplt.show()","ce2c6c5b":"#Below we will see the patients count for each Neighbourhood.\n\nplt.figure(figsize=(16,4))\nplt.xticks(rotation=90)\nax = sns.countplot(x=df.Neighbourhood, hue=df.Noshow)\nax.set_title(\"Show\/NoShow by Neighbourhood\")\nplt.show()\n\n","e504ac55":"df['Scholarship'].value_counts()\n","7333ae99":"x = sns.countplot(x=df.Scholarship, hue=df.Noshow, data=df)\nax.set_title(\"Show\/NoShow for Scholarship\")\nx_ticks_labels=['No Scholarship', 'Scholarship']\nax.set_xticklabels(x_ticks_labels)\nplt.show()","5217f1e7":"df['Hipertension'].value_counts()\n","bf4f9956":"ax = sns.countplot(x=df.Hipertension, hue=df.Noshow, data=df)\nax.set_title(\"Show\/NoShow for Hipertension\")\nx_ticks_labels=['No Hipertension', 'Hipertension']\nax.set_xticklabels(x_ticks_labels)\nplt.show()","b4b37a0e":"df['Diabetes'].value_counts()\n","962bdc19":"ax = sns.countplot(x=df.Diabetes, hue=df.Noshow, data=df)\nax.set_title(\"Show\/NoShow for Diabetes\")\nx_ticks_labels=['No Diabetes', 'Diabetes']\nax.set_xticklabels(x_ticks_labels)\nplt.show()","4dc665a0":"df['Alcoholism'].value_counts()\n","77f8cb8c":"ax = sns.countplot(x=df.Alcoholism, hue=df.Noshow, data=df)\nax.set_title(\"Show\/NoShow for Alcoholism\")\nx_ticks_labels=['No Alcoholism', 'Alcoholism']\nax.set_xticklabels(x_ticks_labels)\nplt.show()","82efd015":"df['Handcap'].value_counts()\n#Handicap \u0639\u0627\u0626\u0642","4b368f23":"ax = sns.countplot(x=df.Handcap, hue=df.Noshow, data=df)\nax.set_title(\"Show\/NoShow for Handcap\")\nplt.show()","93ae1ba1":"df['SMS_received'].value_counts()\n","41556990":"ax = sns.countplot(x=df.SMS_received, hue=df.Noshow, data=df)\nax.set_title(\"Show\/NoShow for SMS_received\")\nx_ticks_labels=['No SMS_received', 'SMS_received']\nax.set_xticklabels(x_ticks_labels)\nplt.show()","195732c9":"le = LabelEncoder()\ndf['Gender'] = le.fit_transform(df['Gender'])","5111429f":"df['Neighbourhood'] = le.fit_transform(df['Neighbourhood'])\n","254b8309":"df['Noshow'] = le.fit_transform(df['Noshow'])\n","5721f699":"df.head()","7c2098c0":"from pandas_profiling import ProfileReport \n\nprofile = ProfileReport( df, title='Pandas profiling report ' , html={'style':{'full_width':True}})\n\nprofile.to_notebook_iframe()","6c0129e0":"df.shape","4a079a1e":"X = df.drop(['Noshow'], axis=1)\ny = df['Noshow']","c0b594b6":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33, random_state=0)","80966b95":"\n#Applying RandomForestClassifier Model \n\n'''\nensemble.RandomForestClassifier(n_estimators='warn\u2019, criterion=\u2019gini\u2019, max_depth=None,\n                                min_samples_split=2, min_samples_leaf=1,min_weight_fraction_leaf=0.0,\n                                max_features='auto\u2019,max_leaf_nodes=None,min_impurity_decrease=0.0,\n                                min_impurity_split=None, bootstrap=True,oob_score=False, n_jobs=None,\n                                random_state=None, verbose=0,warm_start=False, class_weight=None)\n'''\n\nRandomForestClassifierModel = RandomForestClassifier(criterion = 'gini',n_estimators=100,max_depth=2,random_state=33) #criterion can be also : entropy \nRandomForestClassifierModel.fit(X_train, y_train)\n\n","bea83b69":"\n#Calculating Details\nprint('RandomForestClassifierModel Train Score is : ' , RandomForestClassifierModel.score(X_train, y_train))\nprint('RandomForestClassifierModel Test Score is : ' , RandomForestClassifierModel.score(X_test, y_test))\nprint('RandomForestClassifierModel features importances are : ' , RandomForestClassifierModel.feature_importances_)","44f36149":"\n\n#Calculating Prediction\ny_pred = RandomForestClassifierModel.predict(X_test)\ny_pred_prob = RandomForestClassifierModel.predict_proba(X_test)\nprint('Predicted Value for RandomForestClassifierModel is : ' , y_pred[:10])\nprint('Prediction Probabilities Value for RandomForestClassifierModel is : ' , y_pred_prob[:10])","f4ff17c9":"\n#Calculating Accuracy Score  : ((TP + TN) \/ float(TP + TN + FP + FN))\nAccScore = accuracy_score(y_test, y_pred, normalize=False)\nprint('Accuracy Score is : ', AccScore)","19dfdb3d":"Before anything, let's see how many patients attended","1d678f8f":"\n\n# Project:Medical Appointment No Shows analysis project \n## Table of Contents\n<ul>\n<li><a href=\"#intro\">Introduction<\/a><\/li>\n<li><a href=\"#cont\">Data Content<\/a><\/li>\n<li><a href=\"#wrangling\">Data Wrangling<\/a><\/li>\n<li><a href=\"#1\"> Data Cleaning<\/a><\/li>\n<li><a href=\"#2\">Exploratory Data Analysis<\/a><\/li>\n<li><a href=\"#3\">Can gender affect visit ?<\/a><\/li>\n<li><a href=\"#4\"> Does age affect the visit?<\/a><\/li>\n<li><a href=\"#5\">what about the neighborhood ?<\/a><\/li>\n\n <li><a href=\"#6\">what about the Scholarship?<\/a><\/li>\n<li><a href=\"#7\">what about the Hypertension ?<\/a><\/li>\n<li><a href=\"#8\"> what about the Diabetes ?<\/a><\/li>\n<li><a href=\"#9\">what about the Alcoholism ?<\/a><\/li>\n\n<li><a href=\"#10\">  what about the Alcoholism ?<\/a><\/li>\n<li><a href=\"#11\">what about the SMSReceived ?<\/a><\/li>\n       \n   \n    \n<li><a href=\"#12\">modeling<\/a><\/li>\n<\/ul>\n","8bbcb7b8":"Are there duplicate values in the data?","3d388899":"# what about the Scholarship?\n<a id='6'><\/a>\n","ec4f7082":"By visualizing, we can see that there are about 88,000 patients suffering from high blood pressure and about 78% of them attended the visit. Of  21801 patients with no high blood pressure, about 85% came to visit. Therefore, the high blood pressure feature can help us determine whether a patient will show up on a post-appointment visit.","fd7d4527":"# what about the Handcap ?\n<a id='10'><\/a>\n","cc96a975":"<a id='intro'><\/a>\n## Introduction\nThis dataset collects information from 100,000 medical appointments in Brazil and focuses on the question of whether or not patients will show up for their appointments. The main question we're trying to answer here is why 30% of patients miss their scheduled appointment. We are trying to predict the most important factors that affect the patient's attendance and build a model to predict whether the patient will attend in the future or not.\nI hope this is a good analysis of the data and if you like the notebook, do not forget to vote\n\n","f03b3183":"From visualization we can see that there are about 102,000 diabetics and about 80% of them attended the visit. Of the 7943 diabetic patients, about 83% came to visit. Therefore, the diabetes feature can help us determine whether a patient will attend the post-appointment visit.","1a5fe844":"# Can gender affect visit ?\n<a id='3'><\/a>\n","3199eb9d":"# Does age affect the visit?\n<a id='4'><\/a>\n","8a197996":"Through visualization, we can see that there are about 108,000 unobstructed patients and about 80% of them have come for a visit. Since we see a clear distinction between different levels of disability, this feature will help us determine if a patient will come for a visit after making an appointment.","50f78ca9":"<a id='1'><\/a>\n \n# Data Cleaning","d7aa5e09":"By visualizing, we can see that there are about 107,000 patients who do not suffer from alcoholism and about 80% of them attended the visit. Of the 3360 patients with alcohol addiction, about 80% attended the visit. Since the rate of visits for non-alcoholic patients is the same, this may not help us determine whether or not the patient is coming for a visit.","6b6c1891":"Through visualization, we can see that there are about 75,000 patients who did not receive text messages, and about 84% of them attended the visit. Of the 35,500 patients who received text messages, about 72% attended the visit. This feature will help us determine if a patient will come for a visit after scheduling an appointment.","d7369c78":"If we also notice, two columns are indicating serial numbers (AppointmentID ,PatientId)  \n\nThese numbers do not affect the results at all\n\nSo we're gonna scan the two columns (AppointmentID ,PatientId)  ","a6c6b6b1":"We start with the gender column","4bccebbe":"# modeling\n<a id='12'><\/a>\n","3d500c41":"We will clean the columns column by column now and ask questions and try to answer them","ad225f7c":"# Data Content\n<a id='cont'><\/a>\n\n110.527 medical appointments its 14 associated variables (characteristics). The most important one if the patient show-up or no-show to the appointment. Variable names are self-explanatory, if you have doubts, just let me know!\n\n\n14 variables\n\n# Data Dictionary \n\n01 - PatientId\n\nIdentification of a patient\n\n02 - AppointmentID\n\nIdentification of each appointment\n\n03 - Gender\n\nMale or Female . Female is the greater proportion, woman takes way more care of they health in comparison to man.\n\n04 - DataMarcacaoConsulta\n\nThe day of the actuall appointment, when they have to visit the doctor.\n\n05 - DataAgendamento\n\nThe day someone called or registered the appointment, this is before appointment of course.\n\n06 - Age\n\nHow old is the patient.\n\n07 - Neighbourhood\n\nWhere the appointment takes place.\n\n08 - Scholarship\n\nTrue of False . Observation, this is a broad topic, consider reading this article https:\/\/en.wikipedia.org\/wiki\/Bolsa_Fam%C3%ADlia\n\n09 - Hipertension\n\nTrue or False\n\n10 - Diabetes\n\nTrue or False\n\nAlcoholism\n\nTrue or False\n\nHandcap\n\nTrue or False\n\nSMS_received\n\n1 or more messages sent to the patient.\n\nNo-show\n\nTrue or False.","db68cbe3":"Well, the data type for all columns is now correct","489dce8a":"If we consider both columns (ScheduledDay , AppointmentDay)\n\nIt is reasonable if the person does not intend to attend\nwill not call The doctor  to book an appointment, \nhence the AppointmentDay column\n\n\"The day someone called or registered the appointment, this is before  appointment of course.\n\"\n\nIt will not be useful to us because there is no link between it and the presence or absence\n\nFor the ScheduledDay column\n\n\"The day of the actual appointment, when they have to visit the doctor.\n\"\nCertainly, there is a correlation on a specific day of the week or specific hours of the day\nBut the fact that we will divide the column into other columns indicating the hour, day, and year, this takes an effort that we are not in need at the moment, and for this, I will delete both columns.","e51acfae":"# what about the Hypertension ?\n<a id='7'><\/a>\n","446ff773":"From visualization we can see that the number of patients for few Neighbourhood's is very high.","8bd382de":"<a id='wrangling'><\/a>\n\n## Data Wrangling\n\n### General Properties","a4aacecb":"Before doing the analysis\nThe word \"No-show\" caused some problems in the drawing, so I will change it to Noshow","b0fa6a6d":"From the above visualization, it appears that the ratio of Show to NoShow is nearly the same for all ages except for \"Age 0\" and \"Age 1\". We will get better clarity on the ratio of Show to NoShow for all ages. so age does not affect the commitment to visit much","3b2b6a6f":"From visualization we can see that there are around 100,000 patients without Scholarship and out of them around 80% have come for the visit. Out of the 10,800 patients with Scholarship around 75% of them have come for the visit. So, Scholarship feature could help us in determining if a patient will turn up for the visit after an appointment.","18fe7699":"# what about the SMSReceived ?\n<a id='11'><\/a>\n","79aa8e8f":"You will notice in the data that there are incorrectly read columns like AppointmentDay and ScheduledDay\nWe need to define these columns as datetime","8e547013":"# what about the neighborhood ?\n<a id='5'><\/a>\n","efdc8a39":"# Exploratory Data Analysis\n<a id='2'><\/a>\n\n","0cf609ac":"Note that there are no null values in the data","feefb146":"We can see that of the 88,000 patients that appeared, about 57,000 were female and 31,000 were male. Of the 22,500 patients who did not come for a visit, about 15,000 were females and 7,500 were males The ratio of females to males who attended appears to be the same as that which did not come to visit, and therefore gender does not affect\n\n26% for femal\n\n24% for male","cecbd554":"# what about the Alcoholism ?\n<a id='9'><\/a>\n","9ad02c47":"# what about the Diabetes ?\n<a id='8'><\/a>\n","21f91a67":"Below we can see that out of 110527 patients around 88,208 of them have turned up and that's around 80%.\n"}}