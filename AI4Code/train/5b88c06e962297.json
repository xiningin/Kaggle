{"cell_type":{"f8247690":"code","709192c7":"code","a30181ab":"code","d4f0edb8":"code","8e7f51de":"code","6e37d72e":"code","ab07e90b":"code","2ea3339d":"code","43e4eb8e":"code","5ee1babd":"code","f4c3d24e":"code","33421343":"code","6464466f":"code","ddcea399":"code","df53f86c":"code","8c5fdce1":"code","4c10ee4c":"code","22b40546":"code","2000b261":"code","754f4007":"code","2426011d":"code","9560a7e4":"code","82f43ed3":"code","887e2d97":"code","9f8886e6":"code","022b1015":"code","c83b3338":"code","5212e143":"code","75d51da5":"code","37b2d04c":"code","a5860966":"code","f99140a2":"code","7b55ae06":"code","6b5e6fc6":"code","591866e4":"code","1f7e0b56":"code","256fab61":"markdown","ae5bd8d7":"markdown","0799d368":"markdown","9de6f542":"markdown","4da30b0c":"markdown","d60f0af7":"markdown","3e42c20b":"markdown","1313bca7":"markdown","ba9367cd":"markdown","04fc26a0":"markdown"},"source":{"f8247690":"import os\nfrom glob import glob\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport seaborn as sn\nfrom sklearn.model_selection import train_test_split, KFold, cross_val_predict\nfrom sklearn.linear_model import LinearRegression, Lasso, Ridge\nfrom sklearn import metrics\nfrom scipy.stats.mstats import normaltest\nfrom scipy.stats import boxcox\nfrom sklearn.preprocessing import StandardScaler, PolynomialFeatures\nfrom sklearn.metrics import r2_score\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.model_selection import GridSearchCV\n\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","709192c7":"pd.set_option('display.min_rows', 100)\npd.set_option('display.max_columns', 50)\npd.set_option('display.width', 50)","a30181ab":"dataset = pd.read_csv('\/kaggle\/input\/nba-players-data\/all_seasons.csv',index_col= 0 )","d4f0edb8":"dataset.head()","8e7f51de":"dataset.shape","6e37d72e":"dataset.columns","ab07e90b":"dataset.isnull().sum()","2ea3339d":"dataset.describe()","43e4eb8e":"plt.figure(figsize=(15,15))\nax = plt.axes()\n\nax.scatter(dataset.player_height, dataset.player_weight,s=10,c='r')\n\nax.set(xlabel='Player Height (cm)',\n       ylabel='Player Weight (kg)',\n       title='Player Height vs Weight');","5ee1babd":"plt.figure(figsize=(8,8))\nax = plt.axes()\nax.hist(dataset.player_height, bins=25);\n\nax.set(xlabel='Player Height (cm)', \n       ylabel='Frequency',\n       title='Distribution of Player Height');","f4c3d24e":"#creating dataframe to display heatmap\nheatmap_data = dataset[['age','player_height','player_weight','gp','pts','reb','ast','net_rating','oreb_pct','dreb_pct','usg_pct',\n                        'ts_pct','ast_pct']]\nfig_dims = (10, 10)\nfig, ax = plt.subplots(figsize=fig_dims)\nsn.heatmap(heatmap_data.corr())","33421343":"heatmap_data.corr()","6464466f":"dataset.duplicated(keep=False).sum()","ddcea399":"#Checking average\nplayer_height_column = dataset[['player_height','country']]\nplayer_height_column.groupby('country').mean()","df53f86c":"data_model1 =dataset.drop(['age','player_name','team_abbreviation','college','country','draft_year','draft_round','draft_number','season','gp','pts','reb','ast','net_rating','usg_pct','ts_pct','ast_pct','oreb_pct','dreb_pct'], axis=1)","8c5fdce1":"data_model1","4c10ee4c":"data_model1.corr()","22b40546":"X = data_model1.iloc[:,1:].values\ny = data_model1.iloc[:,0].values\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.25, random_state=None,)\nprint(f'X_train: {X_train.shape}\\nX_test: {X_test.shape}\\ny_train: {y_train.shape}\\ny_test: {y_test.shape}')\nregr = LinearRegression()\nregr.fit(X_train, y_train)\nprint(f'Coefficient: {regr.coef_}')\nprint(f'Intercept: {regr.intercept_}')","2000b261":"y_pred = np.round(regr.predict(X_test), decimals=2)\nprint(f'Mean Absolute Error(MAE): {metrics.mean_absolute_error(y_test, y_pred)}')\nprint(f'Residual Sum of Squares(MSE): {metrics.mean_squared_error(y_test, y_pred)}')\nprint(f'R2-Score: {metrics.r2_score(y_test, y_pred)}')","754f4007":"data_model2 =dataset.drop(['age','player_name','team_abbreviation','college','country','draft_year','draft_round','draft_number','season','gp','pts','reb','ast','net_rating','usg_pct','ts_pct','ast_pct'], axis=1)","2426011d":"data_model2","9560a7e4":"X_2 = data_model2.iloc[:,1:].values\ny_2 = data_model2.iloc[:,0].values","82f43ed3":"X_2","887e2d97":"y_2","9f8886e6":"data_model2.corr()","022b1015":"kf = KFold(shuffle=True, random_state=72018, n_splits=3)","c83b3338":"for train_index, test_index in kf.split(X_2):\n    print(\"Train index:\", train_index[:10], len(train_index))\n    print(\"Test index:\",test_index[:10], len(test_index))\n    print('')","5212e143":"lr = LinearRegression()\ns = StandardScaler()\n\nestimator = Pipeline([(\"scaler\", s),\n                      (\"regression\", lr)])","75d51da5":"predictions = cross_val_predict(estimator, X_2, y_2, cv=kf)","37b2d04c":"metrics.r2_score(y_2, predictions)","a5860966":"estimator = Pipeline([(\"scaler\", StandardScaler()),\n        (\"polynomial_features\", PolynomialFeatures()),\n        (\"ridge_regression\", Ridge())])\n\nhparams = {\n    'polynomial_features__degree': [1, 2, 3],\n    'ridge_regression__alpha': np.geomspace(4, 20, 30)\n}\n\ngrid = GridSearchCV(estimator, hparams, cv=kf)","f99140a2":"grid.fit(X_2, y_2)","7b55ae06":"grid.best_score_, grid.best_params_","6b5e6fc6":"y_predict = grid.predict(X_2)","591866e4":"r2_score(y, y_predict)","1f7e0b56":"r = Ridge(alpha = 0.001)\nX_train_s = s.fit_transform(X_train)\nr.fit(X_train_s, y_train)\nX_test_s = s.transform(X_test)\ny_pred_r = r.predict(X_test_s)\nprint(r2_score(y_test, y_pred_r))\nprint(r2_score(y_test, y_pred))","256fab61":"# MODELS SUMMARY\nI trained 3 different models on the same training and test splits, according to results and r2 prediction model2 achieved highest score of 0.7533 thanks to polynomial features. Summaryzing I would recommend model2 approach for this dataset.","ae5bd8d7":"# Main objective(s) of this analysis.\nyour model will be focused on prediction or interpretation?\n\nIn this analysis I will try to predict player_height with other features. So player_height is my target variable and other columns are my features. There might be strong correlation between player_height and player_weight - during my predictions I will consider droping player_weight column to test prediction accuracy  with and without this column.","0799d368":"# Suggestions for next steps\nIn my opinion most efficient way to improve prediction score would be to add specific features that have high correlation with player_height. Features like wingspan, size of foot, size of hand, vertical jump, quickness etc.","9de6f542":"## MODEL 2.\n4 columns with highest correlation X(player_weight,oreb_pct,dreb_pct) y(player_height) with cross-validation, and usage of pipeline with StandardScaler and GridSearchCV. We can record significant improvment of R2-Score from 0.684 to 0.753.","4da30b0c":"## MODEL 1.\n\nSimple linear regression, as there is high correlation between player_height and player_weight I've droped rest of the columns and split player_weight into X and player_height to y.","d60f0af7":"# EDA ","3e42c20b":"# Brief description of the data set and a summary of its attributes.\n\nA dataset contains over 20 years of data on each player who has been part of an NBA teams' roster. It captures demographic variables such as age, height, weight and place of birth, biographical details like the team played for, draft year and round. In addition, it has basic box score statistics such as games played, average number of points, rebounds, assists, etc.\n\nI downloaded it from https:\/\/www.kaggle.com\/justinas\/nba-players-data and all credit for collecting this datset goes to Justinas Cirtautas.","1313bca7":"## MODEL 3\nRidge vs. Lasso regression","ba9367cd":"#  key findings related to the main objective(s) of the analysis.\nIn this analysis I will try to predict player_height with other features. So player_height is my target variable and other columns are my features. There might be strong correlation between player_height and player_weight - during my predictions I will consider droping player_weight column to test prediction accuracy with and without this column.\n\nAfter analysing dataset and applying linear regression models to try predict player_height target value I came to few conclusions. First of all at the beginning I thought that there's strong correlation between player_height and features like offensive, defensive rebound. As a basketball fan I always thought that biggest and tallest players usually grabs most rebounds, but after analysing dataset we can clearly see that there's very low correlation of 0.589033 for offensive rebounds and 0.614650 for defensive rebounds. Also negative correlaction value between player_height and assists was a big suprise for me. Of course biggest factor turned out to be player_weight which basically make lots of sense as statistically every human being usally gets heavier if it's taller.","04fc26a0":"# Summary of training three linear regression models."}}