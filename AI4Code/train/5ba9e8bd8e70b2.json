{"cell_type":{"e1db28c4":"code","32ba8355":"code","47fcca9b":"code","3f62eab1":"code","0fa1d468":"code","83128080":"code","38a986b8":"code","2fa09d8f":"code","b0639b29":"code","4b71a129":"code","c4c0b032":"code","35cac704":"code","4f632f8e":"code","bd66c013":"code","47364e41":"code","a571dae6":"code","4db87047":"code","de4bb03d":"code","855a136f":"code","c6c3bc31":"code","13e78602":"code","dbd34e68":"code","87849702":"code","8e0851bf":"code","fd62e849":"code","b7e1edc5":"code","85ca71f0":"code","1f2205a6":"code","151b87df":"code","1aba0a7d":"code","82518ee2":"code","10e5b926":"code","a6b3009c":"code","33933b87":"code","91d1fea6":"code","84f52fdb":"code","a98c2b46":"code","c5bee00f":"code","e0c0f3c7":"code","44826eb2":"code","903e96a3":"code","7bfd985d":"code","00bfd3ef":"code","80fad00d":"markdown","f27113fd":"markdown","413226c1":"markdown","03df4c21":"markdown","d0030778":"markdown","0006a3be":"markdown","5874f77c":"markdown","cc92be84":"markdown","e735c160":"markdown","bb5e092a":"markdown","c71e3caa":"markdown","c02fa34b":"markdown","83685178":"markdown","380822f4":"markdown","a98a7288":"markdown","0b6b2c26":"markdown","55d21438":"markdown","52b7b05b":"markdown","2e9bbe47":"markdown","c5e92d29":"markdown","15781d0f":"markdown","53c21d1c":"markdown","0c19d9a6":"markdown","9c552c37":"markdown","9c82791f":"markdown","0e27703d":"markdown"},"source":{"e1db28c4":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom tensorflow.keras.datasets import cifar10\nfrom tensorflow.keras.models import Sequential\nfrom tensorflow.keras.utils import to_categorical, plot_model\nfrom tensorflow.math import confusion_matrix\nfrom sklearn.metrics import classification_report\nfrom tensorflow.keras import Sequential\nfrom tensorflow.keras.callbacks import ReduceLROnPlateau, EarlyStopping\nfrom tensorflow.keras.layers import Conv2D, MaxPooling2D, Activation, Dropout, Flatten, Dense\n\nimport warnings\n\nwarnings.filterwarnings('ignore')","32ba8355":"(train_image, train_label) , (test_image, test_label) = cifar10.load_data()","47fcca9b":"print(f\"Shape of train image is: {train_image.shape}\\n\")\nprint(f'Shape of test image is: {test_image.shape}')","3f62eab1":"print(f'Shape of train label is: {train_label.shape}\\n')\nprint(f'Shape of test label is: {test_label.shape}')","0fa1d468":"fig, axes = plt.subplots(4,4, figsize=(13,9))\nfig.tight_layout()\nplt.suptitle(\"FROM TRAIN DATA\\n\\n\\n\\n\", size = 20, va = 'center', color = '#ff781c', fontweight='bold')\n\nfor i in range(4):\n    for j in range(4):\n        \n        # Select random number b\/w 0 and length of train_image\n        rand_num = np.random.randint(0, len(train_image) + 1)\n        img = train_image[rand_num]      # image at specific index\n        label = train_label[rand_num]    # label number of image\n\n        axes[i][j].imshow(img, aspect='auto')\n        axes[i][j].set_title(f\"INDEX is: {rand_num} ---- LABEL is: {label}\")\n        axes[i][j].axis('off')","83128080":"fig, axes = plt.subplots(4,4, figsize=(13,9))\nfig.tight_layout()\nplt.suptitle(\"TEST DATA\\n\\n\\n\\n\", size = 20, va = 'center', color = '#ff781c', fontweight='bold')\n\nfor i in range(4):\n    for j in range(4):\n        \n        # Select random number b\/w 0 and length of test_image\n        rand_num = np.random.randint(0, len(test_image) + 1)\n        img = test_image[rand_num]      # image at specific index\n        label = test_label[rand_num]    # label number of image\n\n        axes[i][j].imshow(img, aspect='auto')\n        axes[i][j].set_title(f\"INDEX is: {rand_num} ---- LABEL is: {label}\")\n        axes[i][j].axis('off')","38a986b8":"train_label = train_label.reshape(train_label.shape[0])\ntest_label = test_label.reshape(test_label.shape[0])","2fa09d8f":"classes = [\"Airplane\", \"Car\", \"Bird\", \"Cat\", \"Deer\", \"Dog\", \"Frog\", \"Horse\", \"Ship\", \"Truck\"]","b0639b29":"plt.figure(figsize = (12,6))\nplt.title(\"Count of Data in Train Label\\n\", size = 15)\n\nsns.countplot(x = train_label, palette='mako').set(xticklabels = classes);","4b71a129":"plt.figure(figsize = (12,6))\nplt.title(\"Count of Data in Test Label\\n\", size = 15)\n\nsns.countplot(x = test_label, palette='mako').set(xticklabels = classes);","c4c0b032":"print(f\"Maximum value in train_images is: {train_image.max()}\")\nprint(f\"Minimum value in train_images is: {train_image.min()}\\n\")\n\nprint(f\"Maximum value in test_images is: {test_image.max()}\")\nprint(f\"Minimum value in test_images is: {test_image.min()}\")","35cac704":"train_image = train_image.astype('float64') \/ 255.0\ntest_image = test_image.astype('float64') \/ 255.0","4f632f8e":"print(f\"Maximum value in train_images is: {train_image.max()}\")\nprint(f\"Minimum value in train_images is: {train_image.min()}\\n\")\n\nprint(f\"Maximum value in test_images is: {test_image.max()}\")\nprint(f\"Minimum value in test_images is: {test_image.min()}\")","bd66c013":"print(train_label)\nprint(test_label)","47364e41":"train_label = to_categorical(train_label, num_classes = 10)\ntest_label = to_categorical(test_label, num_classes = 10)","a571dae6":"print(train_label)\nprint(test_label)","4db87047":"input_shape = train_image.shape[1:]\nnum_classes = 10","de4bb03d":"model = Sequential()\n\nmodel.add(Conv2D(filters = 128, kernel_size = 2, padding = \"same\",activation = \"relu\", input_shape = input_shape))\nmodel.add(MaxPooling2D(pool_size = 2))\n\nmodel.add(Conv2D(filters = 32, kernel_size = 2, padding = \"same\", activation = \"relu\"))\nmodel.add(MaxPooling2D(pool_size = 2))\n\nmodel.add(Dropout(0.2))\n\nmodel.add(Conv2D(filters = 64, kernel_size = 2, padding = \"same\", activation = \"relu\"))\nmodel.add(MaxPooling2D(pool_size = 2))\n\nmodel.add(Dropout(0.25))\n\nmodel.add(Flatten())\n\nmodel.add(Dense(500, activation = \"relu\"))\nmodel.add(Dense(128, activation = 'relu'))\nmodel.add(Dropout(0.25))\nmodel.add(Dense(num_classes, activation = \"softmax\"))","855a136f":"model.summary()","c6c3bc31":"plot_model(model, show_dtype = True, show_layer_names = True)","13e78602":"model.compile(optimizer = 'adam',\n              loss = 'categorical_crossentropy',\n              metrics = ['accuracy'])","dbd34e68":"callbacks = [\n    EarlyStopping(monitor = 'val_loss', patience = 6),\n    ReduceLROnPlateau(monitor = 'val_loss', patience = 3),    \n]","87849702":"result = model.fit(train_image, train_label,\n                   validation_split = 0.2,\n                   epochs = 20,\n                   batch_size = 32,\n                   callbacks = [callbacks])","8e0851bf":"train_loss = result.history['loss']\ntrain_acc = result.history['accuracy']\nval_loss = result.history['val_loss']\nval_acc = result.history['val_accuracy']","fd62e849":"pd.DataFrame({\"Training Loss\" : train_loss,\n             \"Validation Loss\": val_loss,\n             \"Train Accuracy\" : train_acc,\n             \"Validation Accuracy\" : val_acc}).style.bar(color='#ff781c') ","b7e1edc5":"plt.figure(figsize = (12,6))\n\nplt.title(\"Model Loss\\n\", size = 17)\nplt.plot(train_loss, label = \"Train Loss\", marker = 'o')\nplt.plot(val_loss, label='Validation Loss', linestyle='--', marker='o')\nplt.grid()\nplt.xlabel(\"Epoch\")\nplt.ylabel(\"Loss\")\n\nplt.legend();","85ca71f0":"plt.figure(figsize = (12,6))\n\nplt.title(\"Model Accuracy\\n\", size = 17)\nplt.plot(train_acc, label = \"Train Accuracy\", marker = 'o')\nplt.plot(val_acc, label='Validation Accuracy', linestyle='--', marker='o')\nplt.grid()\nplt.xlabel(\"Epoch\")\nplt.ylabel(\"Accuracy\")\n\nplt.legend();","1f2205a6":"test_loss , test_acc = model.evaluate(test_image , test_label)","151b87df":"print(f'Loss on test data is: {test_loss}')\nprint(f\"Accuracy on test data is: {test_acc}\")","1aba0a7d":"img_15 = np.expand_dims(test_image[15], axis = 0)\n\npred_1 = model.predict(img_15)\npred_1","82518ee2":"pred_1.max()","10e5b926":"pred_1.argmax()","a6b3009c":"plt.figure(figsize = (10,5))\n\nplt.imshow(test_image[15]);","33933b87":"fig, axes = plt.subplots(4,4, figsize=(13,12))\nplt.suptitle(\"MODEL PREDICTION ON TEST DATA\\n\", size = 20, va = 'center', color = '#ff781c', fontweight='bold')\n\nfor i in range(4):\n    for j in range(4):\n        \n        # Select random number b\/w 0 and length of test_image\n        rand_num = np.random.randint(0, len(test_image) + 1)\n        \n        # image at specific index and expanding image dimesions (3d to 4d)\n        img = np.expand_dims(test_image[rand_num], axis = 0) \n        \n        # label number of image\n        actual_label = test_label[rand_num]    \n        \n        # model prediction\n        prediction = model.predict(img)\n        \n        # model accuracy on image        \n        predicted_score = prediction.max()\n        \n        # index number(class number) of greater value         \n        predict_label = prediction.argmax()\n                \n\n        axes[i][j].imshow(img.reshape(32,32,3), aspect='auto')\n        axes[i][j].set_title(f\"\\nPredicted Label: {predict_label} \\n Score: {predicted_score} \\n Actual Label: {actual_label.argmax()}\")\n        axes[i][j].axis('off')\n        plt.tight_layout()","91d1fea6":"all_prediction = model.predict(test_image)","84f52fdb":"predicted_labels = [np.argmax(pred) for pred in all_prediction]       ","a98c2b46":"test_label = [np.argmax(i) for i in test_label]  ","c5bee00f":"predicted_labels[:20]            # displaying first 20 predicted labels","e0c0f3c7":"test_label[:20]               # displaying first 20 actual labels","44826eb2":"# creating confusion matrix\n\ncm = confusion_matrix(labels = test_label, predictions = predicted_labels)","903e96a3":"cm","7bfd985d":"#  Visualizing using seaborn\n\nplt.figure(figsize = (13,8))\nsns.heatmap(cm, annot = True, fmt = 'd').set(xticklabels = classes, yticklabels = classes)\nplt.xlabel(\"Prediction\", size = 13)\nplt.ylabel(\"Truth\",  size = 13)\nplt.show()","00bfd3ef":"print(classification_report(test_label, predicted_labels))","80fad00d":"<a id=\"4\"><\/a>\n<p style=\"background-color:#ff781c;font-family:newtimeroman;color:#000000;font-size:170%;text-align:center;border-radius:20px 80px;\">Displaying some random images from Training data<\/p>","f27113fd":"### **So the model predicted correctly.**","413226c1":"**So the data is balanced**","03df4c21":"<a id=\"6\"><\/a>\n<p style=\"background-color:#ff781c;font-family:newtimeroman;color:#000000;font-size:170%;text-align:center;border-radius:20px 80px;\">Converting labels from 2D to 1D<\/p>\n","d0030778":"<a id=\"11\"><\/a>\n<p style=\"background-color:#ff781c;font-family:newtimeroman;color:#000000;font-size:170%;text-align:center;border-radius:20px 80px;\">Plotting model layers<\/p>\n\n\n\n\n\n\n\n\n\n\n\n\n","0006a3be":"<a id=\"7\"><\/a>\n<p style=\"background-color:#ff781c;font-family:newtimeroman;color:#000000;font-size:170%;text-align:center;border-radius:20px 80px;\">Frequency of classes<\/p>","5874f77c":"<a id=\"15\"><\/a>\n<p style=\"background-color:#ff781c;font-family:newtimeroman;color:#000000;font-size:170%;text-align:center;border-radius:20px 80px;\">Predicting model accuracy on some random Test data<\/p>\n","cc92be84":"<a id=\"8\"><\/a>\n<p style=\"background-color:#ff781c;font-family:newtimeroman;color:#000000;font-size:170%;text-align:center;border-radius:20px 80px;\">Normalizing pixel values<\/p>\n\n<h4 align='left'><b>Normalization of values between 0 and 1 helps CNN model to converge faster<\/b><\/h4>\n\n","e735c160":"<p style=\"background-color:#ff781c;font-family:newtimeroman;color:#000000;font-size:170%;text-align:center;border-radius:20px 80px;\">If you like my Work, Please Upvote. Thank You \ud83d\ude0a<\/p>\n","bb5e092a":"<a id=\"14\"><\/a>\n<p style=\"background-color:#ff781c;font-family:newtimeroman;color:#000000;font-size:170%;text-align:center;border-radius:20px 80px;\">Prediction from model<\/p>\n","c71e3caa":"\n<a id=\"10\"><\/a>\n<p style=\"background-color:#ff781c;font-family:newtimeroman;color:#000000;font-size:170%;text-align:center;border-radius:20px 80px;\">Creating CNN Model<\/p>\n\n\n\n\n\n\n\n\n","c02fa34b":"<a id=\"16\"><\/a>\n<p style=\"background-color:#ff781c;font-family:newtimeroman;color:#000000;font-size:170%;text-align:center;border-radius:20px 80px;\">Confusion Matrix<\/p>\n","83685178":"\n<a id=\"5\"><\/a>\n<p style=\"background-color:#ff781c;font-family:newtimeroman;color:#000000;font-size:170%;text-align:center;border-radius:20px 80px;\">Displaying some random images from Test data<\/p>\n","380822f4":"|Label | Description\n|------|------------\n|0\t   | Airplane\n|1\t|Automobile\n|2\t|Birds \n|3\t|Cat\n|4\t|Deer\n|5\t|Dog\n|6\t|Frog\n|7\t|Horse\n|8\t|Ship\n|9\t|Truck\n","a98a7288":"### **Shape of image**","0b6b2c26":"<a id=\"13\"><\/a>\n<p style=\"background-color:#ff781c;font-family:newtimeroman;color:#000000;font-size:170%;text-align:center;border-radius:20px 80px;\">Evaluating model on Test data<\/p>\n","55d21438":"<a id=\"1\"><\/a>\n<p style=\"background-color:#ff781c;font-family:newtimeroman;color:#000000;font-size:170%;text-align:center;border-radius:20px 80px;\">Importing Libraries<\/p>","52b7b05b":"The CIFAR-10 dataset (Canadian Institute For Advanced Research) is a collection of different images. It is one of the most widely used datasets in machine learning. The CIFAR-10 dataset contains 60,000 32x32 color images in 10 different classes. The 10 different classes represent airplanes, cars, birds, cats, deer, dogs, frogs, horses, ships, and trucks. There are 6,000 images of each class.","2e9bbe47":"#### **Model predicts that image on 15<sup>th<\/sup> index of test data belongs to 8<sup>th<\/sup> class which is `Ship`**\n\n#### **Now Checking whether model predicts right or wrong**","c5e92d29":"<a id=\"17\"><\/a>\n<p style=\"background-color:#ff781c;font-family:newtimeroman;color:#000000;font-size:170%;text-align:center;border-radius:20px 80px;\">Classification Report<\/p>\n","15781d0f":"<a id=\"12\"><\/a>\n<p style=\"background-color:#ff781c;font-family:newtimeroman;color:#000000;font-size:170%;text-align:center;border-radius:20px 80px;\">Visualizing Model Accuracy & Loss<\/p>\n","53c21d1c":"<a id=\"3\"><\/a>\n<p style=\"background-color:#ff781c;font-family:newtimeroman;color:#000000;font-size:170%;text-align:center;border-radius:20px 80px;\">Meta information of dataframe<\/p>","0c19d9a6":"<a id=\"9\"><\/a>\n<p style=\"background-color:#ff781c;font-family:newtimeroman;color:#000000;font-size:170%;text-align:center;border-radius:20px 80px;\">One-hot Encoding of Labels<\/p>\n\n\n\n\n","9c552c37":"<a id=\"2\"><\/a>\n<p style=\"background-color:#ff781c;font-family:newtimeroman;color:#000000;font-size:170%;text-align:center;border-radius:20px 80px;\">Loading Data<\/p>","9c82791f":"<a id='top'><\/a>\n<div class=\"list-group\" id=\"list-tab\" role=\"tablist\">\n<p style=\"background-color:#ff781c;font-family:newtimeroman;color:#000000;font-size:170%;text-align:center;border-radius:20px 80px;\">\ud83d\udccb TABLE OF CONTENTS<\/p>   \n","0e27703d":"* [1. Importing Libraries](#1)\n    \n* [2. Loading data](#2)\n    \n* [3. Meta information of dataframe](#3)  \n    \n* [4. Random images from Training data](#4)\n    \n* [5. Random images from Test data](#5)\n   \n* [6. Converting labels from 2D to 1D](#6)\n  \n* [7. Visualize Frequency of Each Class](#7)\n \n* [8. Normalization](#8)\n\n* [9. One Hot Encoding](#9)\n\n* [10. Creating CNN Model](#10)\n\n* [11. Plotting model layers](#11)\n\n* [12. Visualizing Model Accuracy & Loss](#12)\n\n* [13. Evaluating model on Test data](#13)\n\n* [14. Model Prediction](#14)\n\n* [15. Predicting model accuracy on some random test data](#15)\n\n* [16. Confusion Matrix](#16)\n\n* [17. Classification Report](#17)\n\n"}}