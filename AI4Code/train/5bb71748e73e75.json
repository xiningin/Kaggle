{"cell_type":{"a7f99d56":"code","62d211bf":"code","deb4af6a":"code","4843b081":"code","5547cfb4":"code","a8f137e5":"code","8b690b99":"code","7bed25c9":"code","60f8e79b":"code","988b1bb8":"code","a75f3c23":"code","7cc4cef9":"code","4eb87019":"code","fd03ca09":"code","4546c573":"code","0d95f1e9":"code","a9ab60f9":"code","0929ad8b":"code","e1344b74":"code","6fc08a85":"code","b91f6809":"markdown","f3afc0be":"markdown","86150ca9":"markdown","eb27171d":"markdown","39cdb212":"markdown","e77cef0d":"markdown","9944b308":"markdown","b4c792ef":"markdown","eab790cf":"markdown","df18cd35":"markdown","59691a81":"markdown","5bd7925d":"markdown","a37efb77":"markdown","947414f7":"markdown"},"source":{"a7f99d56":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport os\nimport tensorflow as tf\nimport cv2\nfrom tqdm import tqdm","62d211bf":"np.random.seed = 123","deb4af6a":"label_code = {'dollar':0,'euro':1,'franc':2,'pound':3,'rupee':4,'yen':5}\nlabel_decode = ['dollar','euro','franc','pound','rupee','yen']","4843b081":"IMG_WIDTH = 224\nIMG_HEIGHT = 224\nIMG_CHANNELS = 3\nSAMPLES = 6000\nCATEGORIES = 6 # 1 for binary classification problem\n\nX = np.zeros((SAMPLES, IMG_HEIGHT, IMG_WIDTH, IMG_CHANNELS), dtype='float32')       #np.uint8 float32\ny = np.zeros((SAMPLES, CATEGORIES), dtype='int32')                                 #np.bool  uint8","5547cfb4":"i = 0\nfor dirname, _, filenames in os.walk('..\/input\/currency-symbol-datasets\/datasets\/datasets'):\n    for filename in tqdm(filenames):\n        _path = os.path.join(dirname, filename)\n        _img = cv2.imread(_path)\n        _img = cv2.resize(_img,(IMG_WIDTH,IMG_HEIGHT))\n        _img = _img.astype('float32')\n        _img = _img\/255.0\n        _img = np.flip(_img,(2))  #for RGB images \n        X[i,:,:,:3]  = _img\n        _label = dirname.split('\/')[-1]\n        _index = label_code[_label]\n        y[i,_index] = 1\n        i += 1","a8f137e5":"from sklearn.model_selection import train_test_split\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.20, random_state = 0)\n\nprint(X_train.shape)\nprint(y_train.shape)\nprint(X_test.shape)\nprint(y_test.shape)","8b690b99":"plt.imshow(X_test[0,:,:,:])","7bed25c9":"j = np.argmax(y_test[0])\n\nprint(label_decode[j])","60f8e79b":"from tensorflow.keras.models import Sequential\nfrom tensorflow.keras.layers import Dense, Conv2D, MaxPooling2D, Flatten\n\nmodel = Sequential()\nmodel.add(Conv2D(8, (3, 3), activation='relu', input_shape=(224, 224, 3)))\nmodel.add(Conv2D(4, (4, 4), activation='relu'))\nmodel.add(MaxPooling2D((2, 2)))\nmodel.add(Conv2D(4, (3, 3), activation='relu'))\nmodel.add(Conv2D(3, (3, 3), activation='relu'))\nmodel.add(Conv2D(3, (3, 3), activation='relu'))\nmodel.add(MaxPooling2D((2, 2)))\nmodel.add(Flatten())\nmodel.add(Dense(32, activation='relu'))\nmodel.add(Dense(6,activation='softmax'))   ","988b1bb8":"model.summary()","a75f3c23":"model.compile(loss='categorical_crossentropy', optimizer='adam', metrics=['accuracy'])","7cc4cef9":"hist = model.fit(x = X_train, y = y_train, batch_size = 32, validation_data=(X_test,y_test), epochs=10,verbose=1)","4eb87019":"plt.plot(hist.history['accuracy'])\nplt.plot(hist.history['val_accuracy'])\nplt.title('history: the CNN model accuracy')\nplt.ylabel('accuracy')\nplt.xlabel('epoch')\nplt.legend(['train', 'test'], loc='lower right')\nplt.show()","fd03ca09":"plt.plot(hist.history['loss'])\nplt.plot(hist.history['val_loss'])\nplt.title('history: the CNN model loss')\nplt.ylabel('loss')\nplt.xlabel('epoch')\nplt.legend(['train', 'test'], loc='upper right')\nplt.show()","4546c573":"# evaluate model\n# _, acc = model.evaluate(X_test,y_test, verbose=0)\n# print(acc*100)","0d95f1e9":"path2 = '..\/input\/currency-symbol-datasets\/datasets\/datasets\/dollar\/dollar115.jpg'\nimg = cv2.imread(path2)\nimg = cv2.resize(img,(224,224))\nimg = img.astype('float32')\nimg = img\/255.0\nimg = np.flip(img,(2))\nplt.imshow(img)\nimg = img.reshape(1,224,224,3)","a9ab60f9":"y1 = model.predict(img)  ","0929ad8b":"print(label_decode[np.argmax(y1)])","e1344b74":"model.save_weights('wt20.h5')","6fc08a85":"model.load_weights('.\/wt20.h5')","b91f6809":"**encoding**","f3afc0be":"Reproduction","86150ca9":"**creating numpy array for X and y**","eb27171d":"## 2. Model Setup","39cdb212":"## 1. Preparing Dataset","e77cef0d":"# CURRENCY CLASSIFICATION USING CNN MODEL\n\n**These are the steps can be followed for solving any common machine learning\/deep learning problem.**\n\n    1. Preparing Dataset\n\n    2. Model Setup\n\n    3. Trainning\n\n    4. Evaluation\n\n    5. Prediction on single image\n","9944b308":"**save model**","b4c792ef":"**loading files to numpy arrays**","eab790cf":"**split datasets**","df18cd35":"## 5. Prediction on single image","59691a81":"**visulising samples**","5bd7925d":"## 4. Evaluation","a37efb77":"**load model**","947414f7":"## 3. Trainning"}}