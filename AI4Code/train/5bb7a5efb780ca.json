{"cell_type":{"ba94d5d8":"code","f5b669de":"code","095809dc":"code","ca3aa055":"code","9346bb86":"code","60c21f6e":"code","6c70dc27":"code","0e187986":"code","d83b697d":"code","98edf0b6":"code","9de7ecbb":"code","8c69adf0":"code","4c9d7fe5":"code","41cd58b4":"code","72aa823b":"code","d815fbb8":"code","0d34d89b":"code","8b0a2d44":"code","527fb640":"code","91cee7de":"code","0f9f1ec1":"code","beeb5f4d":"code","61e67310":"code","6bca09ac":"code","f6547cd4":"code","4a393895":"code","7fe3a4f1":"code","53f6865b":"code","22612a78":"code","abdef14e":"code","aef12f3a":"code","f5f410b6":"code","6753546a":"code","01d91c8c":"code","54a5e281":"code","aed0110c":"code","c21253d9":"code","d0c1bc30":"code","28ef4aa1":"code","9d70777c":"code","a930ecfe":"code","ad1411ef":"markdown","b3f1f1e7":"markdown","b6727465":"markdown","3b50cd74":"markdown","8d4a52a2":"markdown","67c9ea73":"markdown","4bde8f81":"markdown","b8346944":"markdown","1557a805":"markdown","f2785907":"markdown","8e3a4698":"markdown","0f3edc81":"markdown","35630d77":"markdown","989be559":"markdown","45ccd951":"markdown","9f312241":"markdown","dc083083":"markdown","50fe2fe4":"markdown"},"source":{"ba94d5d8":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nplt.style.use('ggplot')\nimport seaborn as sns","f5b669de":"df = pd.read_csv('..\/input\/tvradionewspaperadvertising\/Advertising.csv')","095809dc":"df.head()","ca3aa055":"df.info()","9346bb86":"df.describe()","60c21f6e":"df.columns","6c70dc27":"for i in ['TV', 'Radio', 'Newspaper']:\n    sns.scatterplot(x=i,y='Sales',data=df)\n    plt.show()\n          ","0e187986":"sns.pairplot(df,diag_kind='kde')","d83b697d":"plt.figure(dpi=150)\nsns.heatmap(df.corr(),annot=True,cmap='viridis',lw=1)","98edf0b6":"x = df[['TV', 'Radio', 'Newspaper']]\ny = np.array(df['Sales'])","9de7ecbb":"x_new = np.c_[np.ones((200,1)),x]","8c69adf0":"#x_new\n#y","4c9d7fe5":"theta = np.linalg.inv(x_new.T.dot(x_new)).dot(x_new.T).dot(y)","41cd58b4":"theta","72aa823b":"theta_svd = np.linalg.pinv(x_new).dot(y)","d815fbb8":"theta_svd","0d34d89b":"new_data = np.array([[1,100,50,70]])","8b0a2d44":"new_prediction = new_data.dot(theta)\nnew_prediction","527fb640":"from sklearn.model_selection import train_test_split","91cee7de":"x_train,x_test,y_train,y_test = train_test_split(x,y,test_size=0.3,random_state=42)","0f9f1ec1":"from sklearn.preprocessing import StandardScaler","beeb5f4d":"scaler = StandardScaler()\nx_train_scaled = scaler.fit_transform(x_train)\nx_test_scaled = scaler.transform(x_test)","61e67310":"from sklearn.linear_model import LinearRegression","6bca09ac":"linear_model = LinearRegression()","f6547cd4":"linear_model.fit(x_train_scaled,y_train)","4a393895":"linear_model.coef_","7fe3a4f1":"predictions = linear_model.predict(x_test_scaled)","53f6865b":"predictions","22612a78":"from sklearn.metrics import mean_absolute_error,mean_squared_error","abdef14e":"mae = mean_absolute_error(y_test,predictions)\nrmse = np.sqrt(mean_squared_error(y_test,predictions))","aef12f3a":"mae","f5f410b6":"rmse","6753546a":"sns.displot(predictions-y_test, bins=30,kde=True)","01d91c8c":"sns.scatterplot(x=y_test,y=predictions-y_test)\nplt.axhline(y=0,c='r',ls='--')","54a5e281":"x = df[['TV', 'Radio', 'Newspaper']]\ny = df['Sales']","aed0110c":"final_linear_model = LinearRegression()","c21253d9":"final_linear_model.fit(x,y)","d0c1bc30":"new_data = [[150,20,100]]","28ef4aa1":"scaled_new_data = scaler.transform(new_data)","9d70777c":"scaled_new_data","a930ecfe":"final_linear_model.predict(new_data)","ad1411ef":"## Now use LinearRegression from Scikit-learn","b3f1f1e7":"# Plotting","b6727465":"### Metrics\n\nMake sure you've viewed the video on these metrics!\nThe three most common evaluation metrics for regression problems:\n\n**Mean Absolute Error** (MAE) is the mean of the absolute value of the errors:\n\n$$\\frac 1n\\sum_{i=1}^n|y_i-\\hat{y}_i|$$\n\n**Mean Squared Error** (MSE) is the mean of the squared errors:\n\n$$\\frac 1n\\sum_{i=1}^n(y_i-\\hat{y}_i)^2$$\n\n**Root Mean Squared Error** (RMSE) is the square root of the mean of the squared errors:\n\n$$\\sqrt{\\frac 1n\\sum_{i=1}^n(y_i-\\hat{y}_i)^2}$$\n\nComparing these metrics:\n\n- **MAE** is the easiest to understand, because it's the average error.\n- **MSE** is more popular than MAE, because MSE \"punishes\" larger errors, which tends to be useful in the real world.\n- **RMSE** is even more popular than MSE, because RMSE is interpretable in the \"y\" units.\n\nAll of these are **loss functions**, because we want to minimize them.","3b50cd74":"**Now we can use the normal equation to find theta values**","8d4a52a2":"## Scaling the data","67c9ea73":"# Understanding and utilizing the Model\n\n-----\n\n## Evaluation on the Test Set","4bde8f81":"### Coefficients of linear model","b8346944":"## We can also compute theta using Singular Value Decompostion (SVD), pseudo inverse\n#### **In cases where inverse does not exist,normal equation won't work but pseudo inverse is always defined and handles all the edge cases nicely**","1557a805":"# Reading data","f2785907":"# Predictions on new data","8e3a4698":"### If satisfied with the performance, train the model on the whole data","0f3edc81":"## train test split","35630d77":"## $h(\\theta)=\\theta_{0} x_{0}+\\theta_{1} x_{1}+\\ldots \\theta_{n} x_{n}$ ($x_{0} = 1$) using this formula, we can say","989be559":"### Plotting residuals","45ccd951":"# Using Normal Equation      $\\theta=\\left(X^{T} X\\right)^{-1} \\cdot\\left(X^{T} y\\right)$","9f312241":"### Fit\/Train the Model on the training data","dc083083":"### Predicting on new data","50fe2fe4":"# Imports"}}