{"cell_type":{"2a8c45cd":"code","2331607b":"code","50ad3e24":"code","97af0700":"code","23ffbe33":"code","bc8e3e9b":"code","a11987a6":"code","0fa3eb63":"code","cd7b56a5":"code","d667e2f7":"code","fa2d8ac1":"code","300c15d1":"code","2ac17326":"code","4a660de0":"code","5a82727e":"code","ae78de67":"code","aba82d25":"code","3afa03f7":"code","5fcae351":"code","4012c017":"code","4b9af179":"code","36a278b1":"code","120b491a":"code","55174eb5":"code","f3f67f5e":"code","1c228f45":"code","6941548a":"code","40310253":"code","5dfea107":"code","7a61f5a5":"code","3b484b98":"code","d67f372c":"code","379afa9f":"code","553feea7":"markdown","bfa35907":"markdown"},"source":{"2a8c45cd":"from fastai import *\nfrom fastai.vision import *","2331607b":"bs = 128","50ad3e24":"path = \"..\/input\/nonsegmentedv2\/\"","97af0700":"data = ImageDataBunch.from_folder(path, ds_tfms=get_transforms(do_flip=False), \n                                  size=224, num_workers=0, \n                                  bs=bs, valid_pct=0.2).normalize(imagenet_stats)","23ffbe33":"data.show_batch(rows=3, figsize=(7,6))","bc8e3e9b":"learn = cnn_learner(data, models.resnet18, metrics=accuracy, model_dir=\"\/tmp\/model\/\")","a11987a6":"learn.fit_one_cycle(5)","0fa3eb63":"interp = ClassificationInterpretation.from_learner(learn)\n\nlosses,idxs = interp.top_losses()\n\nlen(data.valid_ds)==len(losses)==len(idxs)","cd7b56a5":"interp.plot_top_losses(9, figsize=(15,11))","d667e2f7":"interp.plot_confusion_matrix(figsize=(5,5), dpi=120)","fa2d8ac1":"learn.save(\"\/kaggle\/working\/non-wd-stage-1\")","300c15d1":"learn.unfreeze()","2ac17326":"learn.lr_find()","4a660de0":"learn.recorder.plot()","5a82727e":"learn.fit_one_cycle(5, max_lr=slice(1e-6,1e-4))","ae78de67":"learn.save(\"\/kaggle\/working\/non-wd-stage-2\")","aba82d25":"learn.unfreeze()","3afa03f7":"learn.lr_find()\nlearn.recorder.plot()","5fcae351":"learn.fit_one_cycle(2, max_lr=slice(1e-6,1e-4))","4012c017":"learn.save(\"\/kaggle\/working\/non-wd-stage-3\")","4b9af179":"learn = cnn_learner(data, models.resnet18, metrics=accuracy, model_dir=\"\/tmp\/model\/\", wd=1e-1)","36a278b1":"learn.fit_one_cycle(5)","120b491a":"learn.save(\"\/kaggle\/working\/wd-stage-1\")","55174eb5":"learn.unfreeze()","f3f67f5e":"learn.lr_find()\nlearn.recorder.plot()","1c228f45":"learn.fit_one_cycle(5, max_lr=slice(1e-6,1e-4))","6941548a":"learn = cnn_learner(data, models.resnet18, metrics=accuracy, model_dir=\"\/tmp\/model\/\", wd=10)","40310253":"learn.fit_one_cycle(5)","5dfea107":"learn.save(\"\/kaggle\/working\/large-wd-stage-1\")","7a61f5a5":"learn.unfreeze()","3b484b98":"learn.lr_find()\nlearn.recorder.plot()","d67f372c":"learn.fit_one_cycle(5, max_lr=slice(1e-6,1e-4))","379afa9f":"learn.save(\"\/kaggle\/working\/large-wd-stage-2\")","553feea7":"## Weight decay = 0.1\n\nThe default weight decay in fastai is 1e-2 which is a little conservative. We try 1e-1 and see if we can get better results.","bfa35907":"## Weight decay = 1"}}