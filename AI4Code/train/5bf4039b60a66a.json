{"cell_type":{"086e7a7a":"code","3d946d08":"code","3213122d":"code","520561af":"code","fccaf31e":"code","dc73bc80":"code","1ffebe7c":"code","522c5625":"code","3cde766b":"code","33e64f99":"code","b763e7f8":"code","2eb3e30d":"code","4a8a5652":"code","317f1af3":"code","9a68f0f1":"code","b0118df9":"code","d5a999a7":"code","9942886e":"code","fca74740":"code","5b3c41e2":"code","11f959ce":"code","2d0577d9":"markdown","1371692f":"markdown","cff4a05e":"markdown","dbdda470":"markdown","16aa3a65":"markdown","24b515fc":"markdown"},"source":{"086e7a7a":"import numpy as np # linear algebra\nfrom fastai.vision import * # DL","3d946d08":"# Data Argumentation\ntfms = get_transforms(flip_vert=True)","3213122d":"# Loading & Preprocessing Data\ndata = ImageDataBunch.from_folder(\"..\/input\/plantvillage-dataset\/\", train=\"color\", valid_pct=0.1, size=256, bs=100)","520561af":"data","fccaf31e":"data.batch_stats()","dc73bc80":"# Normalising Data \ndata.normalize()","1ffebe7c":"# Showing a smaple image\ndata.open(data.items[10])","522c5625":"# Showing a batch of images with corresponding labels\ndata.show_batch()","3cde766b":"# Using ResNet18 model \nlearn = cnn_learner(data, models.resnet18, metrics=accuracy)","33e64f99":"learn.data.classes","b763e7f8":"# The Model Architecture\nlearn.model","2eb3e30d":"# Training Model for 1 Epoch\n\n#learn.fit(5, lr=1e-03)\nlearn.fit_one_cycle(1)","4a8a5652":"# Finding the best learning rate to increate overall accuracy\n\nlearn.lr_find(num_it=1000)","317f1af3":"# Showing the results for training data\n\nlearn.show_results(ds_type=DatasetType.Train)","9a68f0f1":"# # Showing the results for validation data\n\nlearn.show_results(ds_type=DatasetType.Valid)","b0118df9":"learn.recorder.plot()","d5a999a7":"# Plotting loss \n\nlearn.recorder.plot_losses()","9942886e":"# Plotting Accuracy \n\nlearn.recorder.plot_metrics()","fca74740":"# Getting the confusing matrix\n\npreds,y,losses = learn.get_preds(with_loss=True)\ninterp = ClassificationInterpretation(learn, preds, y, losses)\ninterp.confusion_matrix()","5b3c41e2":"# Seeing in which class model get the most confused\ninterp.most_confused()","11f959ce":"# Saving the trained model\n\nlearn.export(file = Path(\"\/kaggle\/working\/export.pkl\"))","2d0577d9":"# Getting Results","1371692f":"# Hyperparameter Tuning","cff4a05e":"# Exporting thr Model","dbdda470":"# Making the Model","16aa3a65":"# Loading & Preprocessing Data","24b515fc":"# Training the Model"}}