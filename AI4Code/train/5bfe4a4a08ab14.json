{"cell_type":{"d914f057":"code","4c73bc7c":"code","a5d9983e":"code","8ed16fd7":"code","3045d739":"code","94254b8e":"code","10e8f223":"code","159b2d22":"code","ca69e519":"code","5cc2a93f":"code","c6f9432c":"code","1dcd0afe":"code","bab8d0a7":"code","5de14c8e":"code","1fe8e3c0":"code","b08bc791":"code","af8de8c1":"code","7367be49":"code","453af833":"code","996b1cf7":"code","72bb4ec0":"code","7bece15f":"code","f6a23928":"code","2f72eace":"code","b3b27665":"code","846d2ea0":"code","1bc76952":"code","6ccb236e":"code","57e8539b":"code","c1d2d586":"code","7ab448a7":"code","fcd9fe8f":"code","a6e607c5":"code","64cd750b":"code","0aee30f4":"code","15a48f67":"code","3985b89d":"code","c865153a":"code","e75ed67d":"code","035e8d66":"code","005165ce":"code","69e08136":"code","94c0ab7e":"code","dde49e76":"code","25b6ef0d":"code","066c30a7":"code","92a96ffa":"code","715da4f7":"code","725c85a8":"code","63fef082":"code","9f23beff":"code","98558793":"code","76486293":"code","d522e111":"code","f7571639":"code","0922c772":"code","9169943e":"code","175ff898":"code","e5e3b9de":"code","20cc2a4d":"code","62903d44":"code","5bdaf691":"markdown","291b9d58":"markdown","dee9148c":"markdown","f03294fb":"markdown","6d77596c":"markdown"},"source":{"d914f057":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","4c73bc7c":"df=pd.read_csv('\/kaggle\/input\/online-shoppers-purchasing-intention-dataset\/online_shoppers_intention.csv')","a5d9983e":"df.head()","8ed16fd7":"df.info()","3045d739":"df.describe()","94254b8e":"df.nunique()","10e8f223":"import matplotlib.pyplot as plt\nimport seaborn as sns\nimport warnings\nwarnings.filterwarnings('ignore')","159b2d22":"df['Month'].unique()","ca69e519":"df=df.replace({'Feb':2, 'Mar':3, 'May':5, 'Oct':10, 'June':6, 'Jul':7, 'Aug':8, 'Nov':11, 'Sep':9,\n       'Dec':10})","5cc2a93f":"df['VisitorType'].unique()","c6f9432c":"df=df.replace({'Returning_Visitor':0, 'New_Visitor':1, 'Other':2})","1dcd0afe":"df=df*1","bab8d0a7":"df.hist(column='Administrative', by='Revenue', sharex=True, sharey=True, figsize=(7,7), layout=(2,2))\nplt.show()\n\ng = sns.FacetGrid(df, hue='Revenue', height=7)\ng.map(sns.distplot, 'Administrative', label='Revenue')\ng.add_legend()\nplt.show()","5de14c8e":"df.hist(column='Administrative_Duration', by='Revenue', sharex=True, sharey=True, figsize=(7,7), layout=(2,2))\nplt.show()\n\ng = sns.FacetGrid(df, hue='Revenue', height=7)\ng.map(sns.distplot, 'Administrative_Duration', label='Revenue')\ng.add_legend()\nplt.show()","1fe8e3c0":"df.hist(column='Informational', by='Revenue', sharex=True, sharey=True, figsize=(7,7), layout=(2,2))\nplt.show()\n\ng = sns.FacetGrid(df, hue='Revenue', height=7)\ng.map(sns.distplot, 'Informational', label='Revenue')\ng.add_legend()\nplt.show()","b08bc791":"df.hist(column='Informational_Duration', by='Revenue', sharex=True, sharey=True, figsize=(7,7), layout=(2,2))\nplt.show()\n\ng = sns.FacetGrid(df, hue='Revenue', height=7)\ng.map(sns.distplot, 'Informational_Duration', label='Revenue')\ng.add_legend()\nplt.show()","af8de8c1":"df.hist(column='ProductRelated', by='Revenue', sharex=True, sharey=True, figsize=(7,7), layout=(2,2))\nplt.show()\n\ng = sns.FacetGrid(df, hue='Revenue', height=7)\ng.map(sns.distplot, 'ProductRelated', label='Revenue')\ng.add_legend()\nplt.show()","7367be49":"df.hist(column='ProductRelated_Duration', by='Revenue', sharex=True, sharey=True, figsize=(7,7), layout=(2,2))\nplt.show()\n\ng = sns.FacetGrid(df, hue='Revenue', height=7)\ng.map(sns.distplot, 'ProductRelated_Duration', label='Revenue')\ng.add_legend()\nplt.show()","453af833":"df.hist(column='BounceRates', by='Revenue', sharex=True, sharey=True, figsize=(7,7), layout=(2,2))\nplt.show()\n\ng = sns.FacetGrid(df, hue='Revenue', height=7)\ng.map(sns.distplot, 'BounceRates', label='Revenue')\ng.add_legend()\nplt.show()","996b1cf7":"df.hist(column='ExitRates', by='Revenue', sharex=True, sharey=True, figsize=(7,7), layout=(2,2))\nplt.show()\n\ng = sns.FacetGrid(df, hue='Revenue', height=7)\ng.map(sns.distplot, 'ExitRates', label='Revenue')\ng.add_legend()\nplt.show()","72bb4ec0":"df.hist(column='PageValues', by='Revenue', sharex=True, sharey=True, figsize=(7,7), layout=(2,2))\nplt.show()\n\ng = sns.FacetGrid(df, hue='Revenue', height=7)\ng.map(sns.distplot, 'PageValues', label='Revenue')\ng.add_legend()\nplt.show()","7bece15f":"df.hist(column='SpecialDay', by='Revenue', sharex=True, sharey=True, figsize=(7,7), layout=(2,2))\nplt.show()\n\ng = sns.FacetGrid(df, hue='Revenue', height=7)\ng.map(sns.distplot, 'SpecialDay', label='Revenue')\ng.add_legend()\nplt.show()","f6a23928":"df.hist(column='Month', by='Revenue', sharex=True, sharey=True, figsize=(7,7), layout=(2,2))\nplt.show()\n\ng = sns.FacetGrid(df, hue='Revenue', height=7)\ng.map(sns.distplot, 'Month', label='Revenue')\ng.add_legend()\nplt.show()","2f72eace":"df.hist(column='OperatingSystems', by='Revenue', sharex=True, sharey=True, figsize=(7,7), layout=(2,2))\nplt.show()\n\ng = sns.FacetGrid(df, hue='Revenue', height=7)\ng.map(sns.distplot, 'OperatingSystems', label='Revenue')\ng.add_legend()\nplt.show()","b3b27665":"df.hist(column='Browser', by='Revenue', sharex=True, sharey=True, figsize=(7,7), layout=(2,2))\nplt.show()\n\ng = sns.FacetGrid(df, hue='Revenue', height=7)\ng.map(sns.distplot, 'Browser', label='Revenue')\ng.add_legend()\nplt.show()","846d2ea0":"df.hist(column='Region', by='Revenue', sharex=True, sharey=True, figsize=(7,7), layout=(2,2))\nplt.show()\n\ng = sns.FacetGrid(df, hue='Revenue', height=7)\ng.map(sns.distplot, 'Region', label='Revenue')\ng.add_legend()\nplt.show()","1bc76952":"df.hist(column='TrafficType', by='Revenue', sharex=True, sharey=True, figsize=(7,7), layout=(2,2))\nplt.show()\n\ng = sns.FacetGrid(df, hue='Revenue', height=7)\ng.map(sns.distplot, 'TrafficType', label='Revenue')\ng.add_legend()\nplt.show()","6ccb236e":"df.hist(column='VisitorType', by='Revenue', sharex=True, sharey=True, figsize=(7,7), layout=(2,2))\nplt.show()\n\ng = sns.FacetGrid(df, hue='Revenue', height=7)\ng.map(sns.distplot, 'VisitorType', label='Revenue')\ng.add_legend()\nplt.show()","57e8539b":"df.hist(column='Weekend', by='Revenue', sharex=True, sharey=True, figsize=(7,7), layout=(2,2))\nplt.show()\n\ng = sns.FacetGrid(df, hue='Revenue', height=7)\ng.map(sns.distplot, 'Weekend', label='Revenue')\ng.add_legend()\nplt.show()","c1d2d586":"pip install pycaret","7ab448a7":"from pycaret.clustering import *","fcd9fe8f":"exp_clust = setup(df, normalize = True,session_id = 123,silent=True)","a6e607c5":"kmeans = create_model('kmeans',num_clusters = 4)","64cd750b":"plot_model(kmeans, plot = 'elbow')","0aee30f4":"kmean_results = assign_model(kmeans)\nkmean_results.groupby(['Cluster','Revenue'])['Revenue'].count().plot.bar()","15a48f67":"pd.set_option('display.max_rows', 150)\nkmean_results.groupby('Cluster').describe().T","3985b89d":"plot_model(kmeans)","c865153a":"plot_model(kmeans, plot = 'silhouette')","e75ed67d":"from pycaret.classification import *","035e8d66":"exp_clf = setup(df, target = 'Revenue',silent=True)","005165ce":"lgm=create_model('lightgbm')","69e08136":"tuned_lgm=tune_model(lgm)","94c0ab7e":"plot_model(tuned_lgm)","dde49e76":"plot_model(tuned_lgm,'confusion_matrix')","25b6ef0d":"interpret_model(tuned_lgm)","066c30a7":"interpret_model(tuned_lgm, plot = 'correlation')","92a96ffa":"interpret_model(tuned_lgm, plot = 'reason', observation = 10)","715da4f7":"catboost = create_model('catboost')","725c85a8":"tuned_catboost=tune_model(catboost)","63fef082":"plot_model(tuned_catboost)","9f23beff":"plot_model(tuned_catboost,'confusion_matrix')","98558793":"interpret_model(tuned_catboost)","76486293":"interpret_model(tuned_catboost, plot = 'correlation')","d522e111":"interpret_model(tuned_catboost, plot = 'reason', observation = 10)","f7571639":"blender = blend_models(estimator_list = [tuned_lgm,tuned_catboost]) ","0922c772":"plot_model(blender)","9169943e":"plot_model(blender,'confusion_matrix')","175ff898":"pred_result = predict_model(blender)","e5e3b9de":"ensembled_lgm = ensemble_model(tuned_lgm)","20cc2a4d":"plot_model(ensembled_lgm)","62903d44":"plot_model(ensembled_lgm,'confusion_matrix')","5bdaf691":"2) Visualizaton","291b9d58":"1) Data outlines","dee9148c":"4) Modeling for Prediction","f03294fb":"1. Objective of this notebook\n\nI tried to find the difference in the features between people who bought online and did not it. And next, I tried to find the suitable model for prediction.\n\n2. Approach\n\n1) Data outlines\n\n2) Visualization\n\n3) Clustering to understand the difference in the features between people who bought online and did not it\n\n4) Fiding the sutable model for prediction by using PyCaret\n\n3. Insight\n\n1) I got 4 clusters from data. The ratio of Revenue '1' is higher in cluster '3' and '1'. THe features of cluster '3' and '1' are that they have higher average in 'Administrative', 'Administrative_Duration', 'Informational', 'Informational_Duration', 'ProductRelated' and 'ProductRelated_Duration' , and lower avarage in 'BounceRates' and 'ExitRates' than cluster '0' and '2'.\n\n2) I tried to have prediction model by lightgbm and catboost. I also tried blend model and ensemble model. According to SHAP analysis, 'Pagevalues' and 'Month' are larger impact to 'Revenue'. It means that how we can improve the pagevalues and when we will promote it are very important.\n","6d77596c":"3) Clustering"}}