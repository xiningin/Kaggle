{"cell_type":{"de3017f3":"code","f9130871":"code","6cce70cc":"code","715c3d6d":"code","1121702e":"code","e164187a":"code","dd7e24a6":"code","4e62a3cc":"code","eeeb610c":"code","03e5c6f8":"code","a123574b":"code","8767d11f":"code","628bb024":"code","96efc56e":"code","21b80b11":"code","3b1348d3":"code","7cd178bd":"code","7ad5b8c0":"code","a858339a":"markdown"},"source":{"de3017f3":"import numpy as np\nimport pandas as pd\nimport h2o\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom h2o.automl import H2OAutoML\n","f9130871":"h2o.init()","6cce70cc":"train_df = h2o.import_file('..\/input\/tabular-playground-series-mar-2021\/train.csv',destination_frame='train_df')","715c3d6d":"test_df = h2o.import_file('..\/input\/tabular-playground-series-mar-2021\/test.csv')","1121702e":"train_df.describe()","e164187a":"train_df = train_df.drop('id')","dd7e24a6":"predictor_cols = train_df.columns[:-1]","4e62a3cc":"train, valid, test = train_df.split_frame(ratios=[0.6,0.2], seed=1111)\nresponse = \"target\"\ntrain[response] = train[response].asfactor()\nvalid[response] = valid[response].asfactor()\ntest[response] = test[response].asfactor()\nprint(\"Number of rows in train, valid and test set : \", train.shape[0], valid.shape[0], test.shape[0])","eeeb610c":"aml = H2OAutoML(max_models=20, seed=1)\naml.train(x=predictor_cols, y=response, training_frame=train)\n","03e5c6f8":"aml.leaderboard","a123574b":"test_df = test_df.drop('id')","8767d11f":"pred = aml.predict(test_df)","628bb024":"pred.head()","96efc56e":"p1 = pred['p1']","21b80b11":"#convert to pandas\np1_list = h2o.as_list(p1)\n","3b1348d3":"submission = pd.read_csv('..\/input\/tabular-playground-series-mar-2021\/sample_submission.csv')","7cd178bd":"submission.target = p1_list['p1'].values","7ad5b8c0":"submission.to_csv('Submission_AutoML.csv',index=False)","a858339a":"# This notebook can be used as a template for H2O AutoML. \n\n( Created for lecture purpose)"}}