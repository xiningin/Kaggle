{"cell_type":{"876e9a27":"code","cfa1a9a1":"code","e3aadbdd":"code","350de601":"code","55ba80d1":"code","60125dbf":"code","15cbc08a":"code","5f8c1ca7":"code","0aff6a53":"code","9c855689":"code","8f97a86c":"code","74bb850c":"code","52244e06":"code","482afedf":"code","c0763b50":"code","b6748a43":"code","ea54b31c":"code","d0f7e8f3":"code","4f0434d8":"code","2415f120":"code","580d10b3":"code","5a640229":"code","5b6bf900":"code","f45e9f3a":"code","2eeb9cb1":"code","a54e6edc":"code","1fab8dd8":"code","6d109616":"code","f813e281":"code","fc191087":"code","fb9da9fc":"code","1a3892a5":"code","d1590628":"code","262949a5":"code","1cbba754":"code","efde980b":"code","c50bbbd1":"code","efd33853":"code","dd76ee4b":"code","b0bf4870":"code","f78045db":"code","81fb95eb":"code","cac7ba0a":"markdown","6c9ad5ba":"markdown","eb4841dc":"markdown","9f572a8d":"markdown","67a62038":"markdown","79f9384e":"markdown","0ff5b2dd":"markdown","e68db4fc":"markdown","9e3f7de3":"markdown","37143993":"markdown","8cb986ce":"markdown","339f47d9":"markdown","cf2f83a9":"markdown","cb5b12ee":"markdown","c8eba55a":"markdown","613d7ca7":"markdown","b2a007e0":"markdown"},"source":{"876e9a27":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","cfa1a9a1":"df = pd.read_csv('..\/input\/motorcycle-dataset\/BIKE DETAILS.csv')","e3aadbdd":"df.head()","350de601":"df.isnull().sum()","55ba80d1":"df = df.drop('ex_showroom_price', axis = 1)","60125dbf":"df.isnull().sum()","15cbc08a":"sns.histplot(df['selling_price'], kde = True)","5f8c1ca7":"q = df['selling_price'].quantile(0.975)\ndf_2 = df[df['selling_price'] < q]\ndf_2.describe(include = 'all')","0aff6a53":"sns.histplot(df_2['selling_price'], kde = True)","9c855689":"sns.histplot(df_2['km_driven'],kde = True)","8f97a86c":"df_3 = df_2[df_2['km_driven'] < 100000]\nsns.histplot(df_3['km_driven'], kde = True)","74bb850c":"r = df_3['year'].quantile(0.01)\ndf_4 = df_3[df_3['year'] > r]","52244e06":"df_no_outlier = df_4","482afedf":"df_no_outlier.describe(include= 'all')","c0763b50":"sns.pairplot(df)","b6748a43":"df_object = df_no_outlier.select_dtypes(include = 'object')\ndf_numeric = df_no_outlier.select_dtypes (exclude = 'object')","ea54b31c":"df_object_dummies = pd.get_dummies(df_object, drop_first=True)","d0f7e8f3":"df_object_dummies","4f0434d8":"final_df = pd.concat([df_numeric, df_object_dummies], axis = 1)","2415f120":"final_df.describe(include = 'all')","580d10b3":"final_df.corr()['selling_price'].sort_values()","5a640229":"df = final_df","5b6bf900":"df.info()","f45e9f3a":"X = df.drop('selling_price', axis = 1)","2eeb9cb1":"y = df['selling_price']","a54e6edc":"from sklearn.model_selection import train_test_split","1fab8dd8":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)","6d109616":"from sklearn.preprocessing import StandardScaler","f813e281":"scaler = StandardScaler()","fc191087":"scaled_X_train = scaler.fit_transform(X_train)\nscaled_X_test = scaler.transform(X_test)","fb9da9fc":"from sklearn.linear_model import ElasticNet","1a3892a5":"base_elastic_model = ElasticNet()","d1590628":"param_grid = {'alpha':[0.1,1,5,10,100], 'l1_ratio': [.1,.7,.99,1]}","262949a5":"from sklearn.model_selection import GridSearchCV","1cbba754":"grid_model = GridSearchCV(base_elastic_model,\n                          param_grid = param_grid,\n                          scoring = 'neg_mean_squared_error',\n                          cv = 5, verbose = 1)","efde980b":"grid_model.fit(scaled_X_train, y_train)","c50bbbd1":"grid_model.best_params_","efd33853":"y_pred = grid_model.predict(scaled_X_test)","dd76ee4b":"from sklearn.metrics import mean_absolute_error,mean_squared_error","b0bf4870":"mean_absolute_error(y_test,y_pred)","f78045db":"np.sqrt(mean_squared_error(y_test,y_pred))","81fb95eb":"11065.34284441855 \/ np.mean(df['selling_price'])\n","cac7ba0a":"After we created our model, it is suitable to evaluate it.","6c9ad5ba":"# Creating the dummy variables","eb4841dc":"So, our model has a roughly 20 % of mean_absolute_error. This means that the model needs to be re-formulated and perhaps some other parameters should be used. Because I believe 20 % is a bit over the tolerable percentage.","9f572a8d":"# Evaluation","67a62038":"In order to quantitatively comment on the evaluation of the model, I will be taking the mean of the selling_price and then divide the mean_absolute_error (in this case 11065.34284441855) with the mean of the selling_price.","79f9384e":"# Grid Search","0ff5b2dd":"# Model Evaluation","e68db4fc":"# Elastic Net Model","9e3f7de3":"Now we have a more normally distributed km_driven column.","37143993":"# Splitting the Dataset","8cb986ce":"Let's drop the 'ex_showroom_price' column, since it has a whole lot of missing values and personally I believe that this feature is not going to be presenting too much of a contribution to my model.","339f47d9":"In order to avoid any data leakage, we are not scaling the whole X features, but we are scaling the train and test features separately.","cf2f83a9":"So, we do have a better distributed price column now.\n\nI am going to be checking the same outliers in other columns, too.","cb5b12ee":"From the correlation tables above, it is apparent that the most positively correlated feature is 'year' and the most negatively correlated feature is the 'km_driven'. This could be expected at the begining of the EDA, since it is highly possible that the more a motorcycle is used (meaning higher km), the less price it will have and on the same token, the newer a motorcycle is, the higher its value in terms of selling price.","c8eba55a":"# Scaling","613d7ca7":"It seems that we do have some outliers which have the potential to cause variance to be larger than what we need.\n\nSo, let's remove the outliers in the selling_price column.","b2a007e0":"# Dealing with outliers"}}