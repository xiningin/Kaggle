{"cell_type":{"3f8cb863":"code","d855f946":"code","1222a56f":"code","88fb9ca2":"code","d783bb56":"code","9152e078":"code","9d764479":"code","03e3885b":"code","3abdf357":"code","7cd95187":"code","be6c3a72":"code","2ea291cc":"code","7f0fd852":"code","5bea005f":"code","768f9716":"code","d0108fc2":"code","aaaed363":"code","a60bd0c5":"code","f69218a5":"code","12a16aae":"markdown","5d8b2e29":"markdown"},"source":{"3f8cb863":"import pandas as pd\nimport json","d855f946":"data1 = json.load(open('..\/input\/shopee-product-dataset\/My_Request-panci.1-100.json'))\ndata2 = json.load(open('..\/input\/shopee-product-dataset\/My_Request-panci.101-135.json'))","1222a56f":"len(data1['items'])","88fb9ca2":"data2['items'][0]['item_basic']","d783bb56":"#del df\n\ndf = pd.DataFrame()","9152e078":"def insert_df(df, data):\n    for i in range(len(data['items'])):\n        itemid = data['items'][i]['item_basic'][\"itemid\"]\n        shopid = data['items'][i]['item_basic'][\"shopid\"]\n        name = data['items'][i]['item_basic'][\"name\"]\n        currency = data['items'][i]['item_basic'][\"currency\"]\n        stock = data['items'][i]['item_basic'][\"stock\"]\n        ctime = data['items'][i]['item_basic'][\"ctime\"]\n        historical_sold = data['items'][i]['item_basic'][\"historical_sold\"]\n        liked_count = data['items'][i]['item_basic'][\"liked_count\"]\n        view_count = data['items'][i]['item_basic'][\"view_count\"]\n        catid = data['items'][i]['item_basic'][\"catid\"]\n        brand = data['items'][i]['item_basic'][\"brand\"]\n        price = data['items'][i]['item_basic'][\"price\"]\n        price_min = data['items'][i]['item_basic'][\"price_min\"]\n        price_max = data['items'][i]['item_basic'][\"price_max\"]\n        price_min_before_discount = data['items'][i]['item_basic'][\"price_min_before_discount\"]\n        price_max_before_discount = data['items'][i]['item_basic'][\"price_max_before_discount\"]\n        price_before_discount = data['items'][i]['item_basic'][\"price_before_discount\"]\n        has_lowest_price_guarantee = data['items'][i]['item_basic'][\"has_lowest_price_guarantee\"]\n        raw_discount = data['items'][i]['item_basic'][\"raw_discount\"]\n        rating_star = data['items'][i]['item_basic'][\"item_rating\"][\"rating_star\"]\n        show_free_shipping = data['items'][i]['item_basic'][\"show_free_shipping\"]\n        is_preferred_plus_seller = data['items'][i]['item_basic'][\"is_preferred_plus_seller\"]\n        shop_location = data['items'][i]['item_basic'][\"shop_location\"]\n        has_model_with_available_shopee_stock = data['items'][i]['item_basic'][\"has_model_with_available_shopee_stock\"]\n        can_use_cod = data['items'][i]['item_basic'][\"can_use_cod\"]\n        is_on_flash_sale = data['items'][i]['item_basic'][\"is_on_flash_sale\"]\n\n        a_row = pd.Series([itemid, shopid, name, currency, stock, ctime, historical_sold, liked_count, view_count, catid, brand, price, price_min, price_max, price_min_before_discount, price_max_before_discount, price_before_discount, has_lowest_price_guarantee, raw_discount, rating_star, show_free_shipping, is_preferred_plus_seller, shop_location, has_model_with_available_shopee_stock, can_use_cod, is_on_flash_sale])\n        row_df = pd.DataFrame([a_row], index = [itemid])\n        df = pd.concat([df, row_df])\n    return df","9d764479":"df = insert_df(df, data1)\ndf = insert_df(df, data2)\ndf = df.rename(columns={0: \"itemid\",\n                        1: \"shopid\", \n                        2: \"name\", \n                        3: \"currency\", \n                        4: \"stock\", \n                        5: \"ctime\", \n                        6: \"historical_sold\", \n                        7: \"liked_count\", \n                        8: \"view_count\", \n                        9: \"catid\", \n                        10: \"brand\", \n                        11: \"price\", \n                        12: \"price_min\", \n                        13: \"price_max\", \n                        14: \"price_min_before_discount\", \n                        15: \"price_max_before_discount\", \n                        16: \"price_before_discount\", \n                        17: \"has_lowest_price_guarantee\", \n                        18: \"raw_discount\", \n                        19: \"rating_star\", \n                        20: \"show_free_shipping\", \n                        21: \"is_preferred_plus_seller\", \n                        22: \"shop_location\", \n                        23: \"has_model_with_available_shopee_stock\", \n                        24: \"can_use_cod\", \n                        25: \"is_on_flash_sale\"}, errors=\"raise\")","03e3885b":"pd.set_option('display.max_columns', None)\ndf.head\npd.reset_option('display.max_columns')","3abdf357":"#preprocessing\ndf[\"price\"] = df[\"price\"]\/100000\ndf[\"price_min\"] = df[\"price_min\"]\/100000\ndf[\"price_max\"] = df[\"price_max\"]\/100000\ndf[\"price_min_before_discount\"] = df[\"price_min_before_discount\"]\/100000\ndf[\"price_max_before_discount\"] = df[\"price_max_before_discount\"]\/100000\ndf[\"price_before_discount\"] = df[\"price_before_discount\"]\/100000\n\ndf.describe()","7cd95187":"pd.set_option('display.max_columns', None)\nprint(df.head())\npd.reset_option('display.max_columns')","be6c3a72":"df.to_csv(\"dataset_panci_wajan.csv\", index=False)","2ea291cc":"def insert_df_rating(df, data):\n    for i in range(len(data['items'])):\n        itemid = data['items'][i]['item_basic'][\"itemid\"]\n        rating_total = data['items'][i]['item_basic'][\"item_rating\"][\"rating_count\"][0]\n        rating_count_1 = data['items'][i]['item_basic'][\"item_rating\"][\"rating_count\"][1]\n        rating_count_2 = data['items'][i]['item_basic'][\"item_rating\"][\"rating_count\"][2]\n        rating_count_3 = data['items'][i]['item_basic'][\"item_rating\"][\"rating_count\"][3]\n        rating_count_4 = data['items'][i]['item_basic'][\"item_rating\"][\"rating_count\"][4]\n        rating_count_5 = data['items'][i]['item_basic'][\"item_rating\"][\"rating_count\"][5]\n        \n        a_row = pd.Series([itemid, rating_total, rating_count_1, rating_count_2, rating_count_3, rating_count_4, rating_count_5])\n        row_df = pd.DataFrame([a_row], index = [itemid])\n        df = pd.concat([df, row_df])\n    return df","7f0fd852":"#del df_rating\ndf_rating = pd.DataFrame()\n\ndf_rating = insert_df_rating(df_rating, data1)\ndf_rating = insert_df_rating(df_rating, data2)\n\ndf_rating = df_rating.rename(columns={0: \"itemid\", \n                        1: \"rating_total\", \n                        2: \"rating_count_1\", \n                        3: \"rating_count_2\", \n                        4: \"rating_count_3\", \n                        5: \"rating_count_4\", \n                        6: \"rating_count_5\"}, errors=\"raise\")\n\ndf_rating","5bea005f":"df_rating.to_csv(\"dataset_panci_wajan_rating.csv\", index=False)","768f9716":"#del df_shop\n\ndf_shop = pd.DataFrame()","d0108fc2":"def insert_df_shop(df, data):\n    shopid = data['data']['shopid']\n    ctime = data['data']['ctime']\n    mtime = data['data']['mtime']\n    country = data['data']['country']\n    is_shopee_verified = data['data']['is_shopee_verified']\n    is_official_shop = data['data']['is_official_shop']\n    rating_normal = data['data']['rating_normal']\n    rating_bad = data['data']['rating_bad']\n    rating_good = data['data']['rating_good']\n    description = data['data']['description']\n    preparation_time = data['data']['preparation_time']\n    cancellation_rate = data['data']['cancellation_rate']\n    shop_location = data['data']['shop_location']\n    rating_star = data['data']['rating_star']\n    has_flash_sale = data['data']['has_flash_sale']\n    name = data['data']['name']\n    item_count = data['data']['item_count']\n    follower_count = data['data']['follower_count']\n    response_rate = data['data']['response_rate']\n    response_time = data['data']['response_time']\n    username = data['data']['account']['username']\n    has_shopee_flash_sale = data['data']['has_shopee_flash_sale']\n    has_in_shop_flash_sale = data['data']['has_in_shop_flash_sale']\n    has_brand_sale = data['data']['has_brand_sale']\n    is_preferred_plus_seller = data['data']['is_preferred_plus_seller']\n\n    a_row = pd.Series([shopid, ctime, mtime, country, is_shopee_verified, is_official_shop, rating_normal, rating_bad, rating_good, description, preparation_time, cancellation_rate, shop_location, rating_star, has_flash_sale, name, item_count, follower_count, response_rate, response_time, username, has_shopee_flash_sale, has_in_shop_flash_sale, has_brand_sale, is_preferred_plus_seller])\n    row_df = pd.DataFrame([a_row], index = [shopid])\n    df = pd.concat([df, row_df])\n    \n    return df","aaaed363":"import glob\n\nfileList = glob.glob('shopee-shopid*')\nfileList\n\nfor n, file in enumerate(glob.glob('..\/input\/shopee-product-dataset\/shopee-shopid_*')):\n    shop_data = json.load(open(file))\n    \n    df_shop = insert_df_shop(df_shop, shop_data)\n    #if n==0: break\n\ndf_shop = df_shop.rename(columns={0: \"shopid\",\n                        1: \"ctime\", \n                        2: \"mtime\", \n                        3: \"country\", \n                        4: \"is_shopee_verified\", \n                        5: \"is_official_shop\", \n                        6: \"rating_normal\", \n                        7: \"rating_bad\", \n                        8: \"rating_good\", \n                        9: \"description\", \n                        10: \"preparation_time\", \n                        11: \"cancellation_rate\", \n                        12: \"shop_location\",\n                        13: \"rating_star\",\n                        14: \"has_flash_sale\",\n                        15: \"name\", \n                        16: \"item_count\",\n                        17: \"follower_count\",\n                        18: \"response_rate\",\n                        19: \"response_time\",\n                        20: \"username\",\n                        21: \"has_shopee_flash_sale\",\n                        22: \"has_in_shop_flash_sale\",\n                        23: \"has_brand_sale\",\n                        24: \"is_preferred_plus_seller\"}, errors=\"raise\")","a60bd0c5":"pd.set_option('display.max_columns', None)\nprint(df_shop.head())\npd.reset_option('display.max_columns')","f69218a5":"df_shop.to_csv(\"dataset_panci_wajan_shop.csv\", index=False)","12a16aae":"**Product Data Extraction**","5d8b2e29":"**Shop Data Extraction**"}}