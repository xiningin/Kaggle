{"cell_type":{"3b952b8f":"code","9c4417de":"code","00dc5bd5":"code","2719edd3":"code","b208e9d4":"code","6f234dbf":"code","b0ce585f":"code","390f8149":"code","2089f2f7":"code","66e343a8":"code","d520b6f9":"code","68fabdf1":"markdown","b899c9c7":"markdown","95cadb3e":"markdown"},"source":{"3b952b8f":"!pip install darts","9c4417de":"from darts.datasets import AirPassengersDataset, MonthlyMilkDataset\nfrom darts.dataprocessing.transformers import Scaler\nfrom darts import TimeSeries\nfrom darts.utils.timeseries_generation import gaussian_timeseries, linear_timeseries, sine_timeseries\nfrom darts.models import RNNModel, TCNModel, TransformerModel, NBEATSModel, BlockRNNModel\nfrom darts.metrics import mape, smape\n\nimport matplotlib.pyplot as plt\nplt.style.use('seaborn')\nplt.rcParams[\"figure.figsize\"] = (20,15)\n","00dc5bd5":"AirPassengersDataset().load().pd_dataframe()","2719edd3":"series_air = AirPassengersDataset().load()\nseries_milk = MonthlyMilkDataset().load()\n\nseries_air.plot(label='Number of air passengers')\nseries_milk.plot(label='Pounds of milk produced per cow')\nplt.legend()","b208e9d4":"scaler_air, scaler_milk = Scaler(), Scaler()\nseries_air_scaled = scaler_air.fit_transform(series_air)\nseries_milk_scaled = scaler_milk.fit_transform(series_milk)\n\nseries_air_scaled.plot(label='Air')\nseries_milk_scaled.plot(label='Milk')\nplt.legend(loc='best');","6f234dbf":"len(series_air)*.9, len(series_milk)*.9 # get the training test split size","b0ce585f":"train_air, val_air = series_air_scaled[:129], series_air_scaled[129:]\ntrain_milk, val_milk = series_milk_scaled[:151], series_milk_scaled[151:]","390f8149":"model_air_milk = NBEATSModel(input_chunk_length=24, output_chunk_length=12, n_epochs=100, random_state=0)","2089f2f7":"model_air_milk.fit([train_air, train_milk], verbose=True)","66e343a8":"pred = model_air_milk.predict(n=15, series=train_air)\n\nseries_air_scaled.plot(label='actual')\npred.plot(label='forecast')\nplt.legend()\nprint(f'MAPE :{mape(pred,val_air)}')","d520b6f9":"pred = model_air_milk.predict(n=17, series=train_milk)\n\nseries_milk_scaled.plot(label='actual')\npred.plot(label='forecast')\nplt.legend()\nprint(f'MAPE :{mape(pred,val_milk)}')","68fabdf1":"So model seem to be doing great here. Thanks to Kris for wonderful video, https:\/\/www.youtube.com\/watch?v=sXNXI2mE8DU, which gave rise to this nb. Thanks.","b899c9c7":"# Model Fit","95cadb3e":"To use DART we have to scale the data at the same scale. We shall train model using these Milk and Air datasets (yes, they are different). Then we use the model to predict both datasets. It's is mindblowing."}}