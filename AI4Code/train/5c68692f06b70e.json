{"cell_type":{"a9b4024e":"code","c1fbbcfe":"code","d4903ac8":"code","90cb116d":"code","2b1da2cb":"code","9a872919":"code","046ce912":"code","e9de5c37":"code","744f8b12":"code","b8ba301f":"code","fe256929":"code","3de36e2c":"code","da4e6e40":"code","7642afd3":"code","ec755c8c":"code","ecd33d8f":"code","f27e2a0f":"code","6338d7aa":"code","9254293b":"code","53b9aeb6":"code","8b7c187d":"code","5ce2c76a":"code","535822e5":"code","b0eb1b7c":"code","db8301a4":"code","c3707f6d":"code","009ae4ce":"code","078a21e1":"code","9b6dc0d7":"code","2b7557d7":"code","ede7316d":"code","e49ea488":"code","05b1ad41":"code","9e74551a":"code","fd50bdfb":"code","7b39cd7f":"code","83a1d071":"code","5f4b4e60":"code","aba29cd7":"code","94826efe":"code","718b738e":"code","679a880c":"code","00ab7a1a":"code","c98b6268":"code","7c1b53ef":"code","807ca871":"code","74fc06a4":"code","947bdd94":"code","c69ce5e0":"code","5d9edda4":"code","8946b27d":"code","afcdd1d0":"code","57e0231d":"code","14e99e40":"code","fde6d8ff":"code","a65e300f":"code","8b18a5bd":"code","0c694d44":"code","12a243f8":"code","5248d26f":"code","92cb98d8":"code","01187ecd":"code","6ab86705":"code","12f0c16c":"code","d165d631":"code","56f21279":"code","bd2251f4":"code","6e34f679":"code","2441e413":"code","c252c969":"code","4d988b76":"code","3d985368":"code","3144c85f":"code","4d3c8fa0":"code","41b62898":"code","949f77a1":"code","23c79d60":"code","50020262":"code","1122414e":"code","34d81a65":"code","d9b5263e":"code","5c079fb2":"code","41aca434":"code","86d6ee1d":"code","4bb7f3d2":"code","e74f7db5":"code","8ca15146":"code","2a02769a":"code","723987b2":"code","6fe7dd9a":"code","e558762c":"code","0ecd9d75":"code","e0694bbb":"code","76a15b5d":"code","24a6f269":"code","21a9df36":"code","3ed80db6":"code","833477ef":"code","4906d043":"code","587c73df":"code","1ca9cb3d":"code","46f3c471":"code","92edc2cb":"code","265ba434":"code","cae66eb9":"code","17d1aa12":"code","745a025d":"code","fdba074a":"code","70d3a3f0":"code","2e504984":"code","1988e6f0":"code","cb43296c":"code","7aa7abfc":"code","ff67ac22":"code","4ebc0984":"code","1c28a885":"code","d9b28879":"code","b6935396":"code","3bc45140":"code","eea5a1fc":"code","88cffced":"code","15c4c2c4":"code","ea4422c8":"code","913176a9":"code","e0e108d6":"markdown","b98e4c5d":"markdown","7f8f0c50":"markdown","e43d2a59":"markdown","2ed14c22":"markdown","79f6b5ba":"markdown","55765305":"markdown","962d4b45":"markdown","a2081a5e":"markdown","09948ef2":"markdown","7c6a2b05":"markdown","2535931c":"markdown","ef5232ed":"markdown","adbbfb4e":"markdown","552e4b3e":"markdown","080a6238":"markdown","49e9700b":"markdown","d62e38fa":"markdown","6cf9e0bb":"markdown","93e52b51":"markdown","8eec8cd3":"markdown","4ab97c75":"markdown","bf16a34d":"markdown","6935c7f8":"markdown","c2eb9301":"markdown","8e3942d1":"markdown","85999c71":"markdown","bd806a88":"markdown","a18940d1":"markdown","ed85b23d":"markdown","74388a6d":"markdown","12879c38":"markdown","b3153d52":"markdown","9e210828":"markdown","6cd972c4":"markdown","407f9659":"markdown","a717d6bd":"markdown","866eba9e":"markdown","6e7e1bdc":"markdown","f7e99b06":"markdown","9cc89ed2":"markdown","c3e4d55a":"markdown","47ca2c3e":"markdown","19a84beb":"markdown","d8c2c9b5":"markdown","23e9839f":"markdown","2c27e36b":"markdown","b1534dee":"markdown","771ff258":"markdown","7fee2673":"markdown","62f7d7c0":"markdown","9442c889":"markdown","efbfc478":"markdown","c7213f91":"markdown","4042bc07":"markdown","27061d8f":"markdown","b1748e2a":"markdown","4072d70c":"markdown","1807ad94":"markdown","b658cf7e":"markdown","19b5fb3c":"markdown","8210a9fa":"markdown","9b10fe41":"markdown","c6bc3e0b":"markdown","2e773543":"markdown","9b54f3b1":"markdown","572f0840":"markdown","7e88cb06":"markdown","56c386f0":"markdown","c9cca525":"markdown","9c3b803c":"markdown","924769a3":"markdown","a0b8a788":"markdown","546befb3":"markdown","a169ffbc":"markdown","9331a936":"markdown","d017da07":"markdown","9308c8d5":"markdown","02a5006e":"markdown","d296d9b2":"markdown","b94890fc":"markdown","39a787e5":"markdown","1b46ee5e":"markdown","4af5438d":"markdown","5d33b3ed":"markdown","a385c1f1":"markdown"},"source":{"a9b4024e":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","c1fbbcfe":"import seaborn as sns\nimport matplotlib.pyplot as plt","d4903ac8":"pd.options.display.max_columns = None\npd.options.display.max_rows = None","90cb116d":"# Training dataset\ntrain = pd.read_csv(\"\/kaggle\/input\/widsdatathon2020\/training_v2.csv\")\n# Testing dataset\ntest = pd.read_csv(\"\/kaggle\/input\/widsdatathon2020\/unlabeled.csv\")","2b1da2cb":"test.head()","9a872919":"train.head()","046ce912":"train.shape","e9de5c37":"train.info()","744f8b12":"df_null = train.isnull().sum().sort_values(ascending=False)\ndf_null[df_null != 0]","b8ba301f":"train.describe()","fe256929":"train['hospital_death'].value_counts()","3de36e2c":"dictionary = pd.read_csv(\"\/kaggle\/input\/widsdatathon2020\/WiDS Datathon 2020 Dictionary.csv\")","da4e6e40":"dictionary.head()","7642afd3":"dictionary.Category.value_counts()","ec755c8c":"def selectCategory(df,category):\n    \"\"\"\n    This function will return the dataset\n    with information about the specified\n    category\n    \"\"\"\n    return df[df.Category==category]","ecd33d8f":"cols = selectCategory(dictionary,\"GOSSIS example prediction\")","f27e2a0f":"cols","6338d7aa":"print(cols[\"Description\"].values[0])","9254293b":"if \"pred\" not in train.columns:\n    print(\"Column not present\")","53b9aeb6":"train.shape, dictionary.shape","8b7c187d":"cols = selectCategory(dictionary,\"APACHE grouping\")","5ce2c76a":"cols","535822e5":"train[[\"apache_3j_bodysystem\",\"apache_2_bodysystem\"]].head(10)","b0eb1b7c":"train[[\"apache_3j_bodysystem\",\"apache_2_bodysystem\"]][train[\"apache_3j_bodysystem\"] != train[\"apache_2_bodysystem\"]].head(20)","db8301a4":"# Columns to drop\ntoDrop = []\ntoDrop.append(\"apache_2_bodysystem\")","c3707f6d":"cols = selectCategory(dictionary,\"APACHE prediction\")","009ae4ce":"cols","078a21e1":"for i in cols.Description.values:\n    print(i)","9b6dc0d7":"sns.heatmap(train[[\"apache_4a_hospital_death_prob\",\"apache_4a_icu_death_prob\"]].corr(),annot=True)","2b7557d7":"toDrop.append(\"apache_4a_hospital_death_prob\")","ede7316d":"cols = selectCategory(dictionary,\"identifier\")\n\ncols","e49ea488":"for i in cols.Description.values:\n    print(i)","05b1ad41":"train.encounter_id.nunique(),train.hospital_id.nunique(),train.patient_id.nunique(),len(train.index)","9e74551a":"toDrop.append(\"encounter_id\")\ntoDrop.append(\"patient_id\")","fd50bdfb":"cols = selectCategory(dictionary,\"APACHE comorbidity\")\n\ncols","7b39cd7f":"for col in cols[\"Variable Name\"].values:\n    train[col] = train[col].fillna(0)","83a1d071":"cols = selectCategory(dictionary,\"labs blood gas\")\n\ncols","5f4b4e60":"for i in range(len(cols.index)):\n    print(\"{}: {}\".format(cols[\"Variable Name\"].values[i],cols.Description.values[i]))","aba29cd7":"plt.figure(figsize=(10,10))\nsns.heatmap(abs(train[cols[\"Variable Name\"]].corr()),annot=True)\nplt.show()","94826efe":"for col in cols[\"Variable Name\"].values:\n    if col.startswith(\"d1_\"):\n        print(\"Column to delete: {}\".format(col))\n        toDrop.append(col)","718b738e":"cols = selectCategory(dictionary,\"demographic\")\n\ncols","679a880c":"train.hospital_death.value_counts(normalize=True).plot(kind='bar')","00ab7a1a":"sns.distplot(train[\"age\"])","c98b6268":"sns.distplot(train[train[\"hospital_death\"]==0][\"bmi\"],hist=False)\nsns.distplot(train[train[\"hospital_death\"]==1][\"bmi\"],hist=False)","7c1b53ef":"def bmiCategory(bmi):\n    if bmi < 18.5:\n        return \"underweight\"\n    elif bmi < 24.9:\n        return \"normal\"\n    elif bmi < 29.9:\n        return \"overweight\"\n    else:\n        return \"obese\"\n\ntrain[\"bmi_category\"] = train[\"bmi\"].apply(bmiCategory)","807ca871":"test[\"bmi_category\"] = test[\"bmi\"].apply(bmiCategory)","74fc06a4":"train[\"bmi_category\"].value_counts(normalize=True).plot(kind='bar')","947bdd94":"sns.catplot(x=\"bmi_category\",y=\"hospital_death\",kind=\"bar\",data=train)","c69ce5e0":"toDrop.append(\"bmi\")","5d9edda4":"train.elective_surgery.value_counts(normalize=True).plot(kind='bar')","8946b27d":"sns.countplot(x=\"elective_surgery\",hue=\"hospital_death\",data=train)","afcdd1d0":"train.groupby(\"elective_surgery\")[\"hospital_death\"].sum()\/train.groupby(\"elective_surgery\")[\"hospital_death\"].count() * 100","57e0231d":"sns.catplot(x=\"elective_surgery\",y=\"hospital_death\",kind=\"bar\",data=train)","14e99e40":"train[\"ethnicity\"].value_counts(normalize=True).plot(kind='bar')","fde6d8ff":"sns.catplot(x=\"ethnicity\",y=\"hospital_death\",kind=\"bar\",data=train,aspect=1.8)\nplt.show()","a65e300f":"toDrop.append(\"ethnicity\")","8b18a5bd":"train[\"gender\"].value_counts(normalize=True).plot(kind='bar')","0c694d44":"sns.catplot(x=\"gender\",y=\"hospital_death\",kind=\"bar\",data=train)\nplt.show()","12a243f8":"toDrop.append(\"gender\")","5248d26f":"sns.distplot(train[train[\"hospital_death\"]==0][\"height\"],hist=False)\nsns.distplot(train[train[\"hospital_death\"]==1][\"height\"],hist=False)","92cb98d8":"toDrop.append(\"height\")","01187ecd":"train[\"hospital_admit_source\"].value_counts(normalize=True).plot(kind='bar')","6ab86705":"sns.catplot(x=\"hospital_admit_source\",y=\"hospital_death\",kind=\"bar\",data=train,aspect=1.8)\nplt.xticks(rotation=90)\nplt.show()","12f0c16c":"train[\"icu_admit_source\"].value_counts(normalize=True).plot(kind='bar')","d165d631":"sns.catplot(x=\"icu_admit_source\",y=\"hospital_death\",kind=\"bar\",data=train,aspect=1.8)\nplt.xticks(rotation=90)\nplt.show()","56f21279":"if \"icu_admit_type\" not in train.columns:\n    print(\"Column not found\")","bd2251f4":"train.icu_id.nunique()","6e34f679":"train[\"icu_stay_type\"].value_counts(normalize=True).plot(kind='bar')","2441e413":"sns.catplot(x=\"icu_stay_type\",y=\"hospital_death\",kind=\"bar\",data=train,aspect=1.8)\nplt.xticks(rotation=90)\nplt.show()","c252c969":"toDrop.append(\"icu_stay_type\")","4d988b76":"train[\"icu_type\"].value_counts(normalize=True).plot(kind='bar')","3d985368":"sns.catplot(x=\"icu_type\",y=\"hospital_death\",kind=\"bar\",data=train,aspect=1.8)\nplt.xticks(rotation=90)\nplt.show()","3144c85f":"sns.boxplot(train[\"pre_icu_los_days\"])","4d3c8fa0":"sns.distplot(train[\"pre_icu_los_days\"])","41b62898":"sns.distplot(train[train[\"hospital_death\"]==0][\"pre_icu_los_days\"])","949f77a1":"sns.distplot(train[train[\"hospital_death\"]==1][\"pre_icu_los_days\"])","23c79d60":"train[\"readmission_status\"].value_counts(normalize=True).plot(kind='bar')","50020262":"toDrop.append(\"readmission_status\")","1122414e":"sns.distplot(train[train[\"hospital_death\"]==0][\"weight\"],hist=False)\nsns.distplot(train[train[\"hospital_death\"]==1][\"weight\"],hist=False)","34d81a65":"toDrop.append(\"weight\")","d9b5263e":"cols = selectCategory(dictionary,\"APACHE covariate\")\n\ncols","5c079fb2":"plt.figure(figsize=(20,20))\nsns.heatmap(abs(train[cols[\"Variable Name\"]].corr()),annot=True)\nplt.show()","41aca434":"toDrop.append(\"ventilated_apache\")\ntoDrop.append(\"gcs_eyes_apache\")\ntoDrop.append(\"gcs_verbal_apache\")\ntoDrop.append(\"apache_3j_diagnosis\")","86d6ee1d":"cols = selectCategory(dictionary,\"vitals\")\n\nplt.figure(figsize=(20,20))\nsns.heatmap(abs(train[cols[\"Variable Name\"]].corr()),annot=True)\nplt.show()","4bb7f3d2":"toDrop.append(\"h1_sysbp_noninvasive_max\")\ntoDrop.append(\"h1_sysbp_noninvasive_min\")\ntoDrop.append(\"h1_mbp_noninvasive_max\")\ntoDrop.append(\"h1_mbp_noninvasive_min\")\ntoDrop.append(\"h1_diasbp_noninvasive_max\")\ntoDrop.append(\"h1_diasbp_noninvasive_min\")","e74f7db5":"cols = selectCategory(dictionary,\"labs\")\n\nplt.figure(figsize=(20,20))\nsns.heatmap(abs(train[cols[\"Variable Name\"]].corr()),annot=True)\nplt.show()","8ca15146":"for col in cols[\"Variable Name\"].values:\n    if col.startswith(\"d1_\"):\n        print(\"Column to delete: {}\".format(col))\n        toDrop.append(col)","2a02769a":"print(\"Total columns to drop: {}\".format(len(toDrop)))","723987b2":"# Drop columns\ntrain.drop(toDrop,axis=1,inplace=True)","6fe7dd9a":"train.shape","e558762c":"for col in train.columns:\n    print(col)","0ecd9d75":"categoricals_features = [\"hospital_id\", \"hospital_admit_source\",\n                         \"icu_admit_source\",\"icu_id\",\"icu_type\",\n                         \"apache_3j_bodysystem\",\"bmi_category\"]","e0694bbb":"for cat in categoricals_features:\n    print(\"{}: {}\".format(cat,train[cat].nunique()))","76a15b5d":"df_null = train.isnull().sum().sort_values(ascending=False)\ndf_null[df_null != 0]","24a6f269":"from sklearn.impute import SimpleImputer\n\n# Imputation\nmy_imputer = SimpleImputer(strategy='most_frequent')\nimputed_train = pd.DataFrame(my_imputer.fit_transform(train))\n\n# Imputation removed column names; put them back\nimputed_train.columns = train.columns","21a9df36":"imputed_train.head()","3ed80db6":"from sklearn.preprocessing import LabelEncoder","833477ef":"# This cell is taken from \n# https:\/\/www.kaggle.com\/jayjay75\/wids2020-lgb-starter-adversarial-validation\n\n# categorical feature need to be transform to numeric for mathematical purpose.\n# different technics of categorical encoding exists here we will rely on our model API to deal with categorical\n# still we need to encode each categorical value to an id , for this purpose we use LabelEncoder\n\nprint('Transform all String features to category.\\n')\nfor usecol in categoricals_features:\n    imputed_train[usecol] = imputed_train[usecol].astype('str')\n    test[usecol] = test[usecol].astype('str')\n    \n    #Fit LabelEncoder\n    le = LabelEncoder().fit(\n            np.unique(imputed_train[usecol].unique().tolist()+\n                      test[usecol].unique().tolist()))\n\n    #At the end 0 will be used for null values so we start at 1 \n    imputed_train[usecol] = le.transform(imputed_train[usecol])+1\n    test[usecol]  = le.transform(test[usecol])+1\n    \n    imputed_train[usecol] = imputed_train[usecol].replace(np.nan, 0).astype('int').astype('category')\n    test[usecol]  = test[usecol].replace(np.nan, 0).astype('int').astype('category')","4906d043":"imputed_train[categoricals_features].isna().sum(axis=0)","587c73df":"df_null = imputed_train.isnull().sum().sort_values(ascending=False)\ndf_null[df_null != 0]","1ca9cb3d":"from sklearn.model_selection import train_test_split","46f3c471":"X_train = imputed_train.drop(\"hospital_death\",axis=1)\ny_train = imputed_train[\"hospital_death\"]","92edc2cb":"y_train=y_train.astype('int')\nX_train, X_test, y_train, y_test = train_test_split(X_train, y_train, test_size=0.20, random_state=2020)","265ba434":"X_train.head()","cae66eb9":"y_train.head()","17d1aa12":"from sklearn import metrics\nfrom sklearn.tree import DecisionTreeClassifier","745a025d":"model_dt = DecisionTreeClassifier()","fdba074a":"model_dt.fit(X_train, y_train)","70d3a3f0":"y_pred_dt = model_dt.predict(X_test)","2e504984":"y_pred_proba = model_dt.predict_proba(X_test)\ny_pred_proba","1988e6f0":"y_pred_dt","cb43296c":"# Confusion matrix \nconfusion = metrics.confusion_matrix(y_test, y_pred_dt )\nprint(confusion)","7aa7abfc":"# Let's check the overall accuracy.\nprint(metrics.accuracy_score(y_test, y_pred_dt ))","ff67ac22":"def draw_roc( actual, probs ):\n    fpr, tpr, thresholds = metrics.roc_curve( actual, probs,\n                                              drop_intermediate = False )\n    auc_score = metrics.roc_auc_score( actual, probs )\n    plt.figure(figsize=(5, 5))\n    plt.plot( fpr, tpr, label='ROC curve (area = %0.2f)' % auc_score )\n    plt.plot([0, 1], [0, 1], 'k--')\n    plt.xlim([0.0, 1.0])\n    plt.ylim([0.0, 1.05])\n    plt.xlabel('False Positive Rate or [1 - True Negative Rate]')\n    plt.ylabel('True Positive Rate')\n    plt.title('Receiver operating characteristic example')\n    plt.legend(loc=\"lower right\")\n    plt.show()\n\n    return None","4ebc0984":"fpr, tpr, thresholds = metrics.roc_curve( y_test, y_pred_dt, drop_intermediate = False )","1c28a885":"draw_roc(y_test, y_pred_dt)","d9b28879":"metrics.auc(fpr, tpr)","b6935396":"testEncounterId = test.encounter_id","3bc45140":"test.drop(toDrop,axis=1,inplace=True)","eea5a1fc":"test.drop([\"hospital_death\"],axis=1,inplace=True)","88cffced":"# Imputation\nmy_imputer = SimpleImputer(strategy='most_frequent')\nimputed_test = pd.DataFrame(my_imputer.fit_transform(test))\n\n# Imputation removed column names; put them back\nimputed_test.columns = test.columns","15c4c2c4":"test[\"hospital_death\"] = model_dt.predict_proba(imputed_test)[:,1]","ea4422c8":"test[\"encounter_id\"] = testEncounterId","913176a9":"test[[\"encounter_id\",\"hospital_death\"]].to_csv(\"submission.csv\",index=False)","e0e108d6":"We do notice that it is an imbalance dataset.","b98e4c5d":"Next, we will look at `icu_id` column. We will check if it is unique for every data point or if it conveys some information, just like `hospital_id` did.","7f8f0c50":"As expected, most patients from accident\/emergency and OR\/recovery are admitted to the ICU.","e43d2a59":"Next we will look at `icu_stay_type` column.","2ed14c22":"### APACHE grouping","79f6b5ba":"We can clearly see a variation in percentage of deaths for different ICU admit sources and thus, it is a feature which we cannot drop.\n\nNext, we will explore the `icu_admit_type` column.","55765305":"We will use AUC as the evaluation metric. We won't be using accuracy since we are dealing with an imbalanced dataset.","962d4b45":"Here we are using label encoding to convert all the categorical features into numerical features.","a2081a5e":"# Predicting Patient Survival in ICU\n\n## Project Description\n\nWhenever a patient is moved to the ICU or Intensive Care Unit, it suggests that the patient's health can rapidly deteriorate and hence, the urgency and the type of treatment is decided upon observing the patient.\n\n \nGiven the data about various measurements of a patient within the first 24 hours of being\nadmitted to an intensive care ward, if we can predict the survival probability of a patient, then\nwe can respond to threats in advance and give the patient more advanced form of care if\npossible, so as to increase the chances of survival. This will improve the mortality rate in hospitals. A stark point to note in this scenario, as is the case in various medical problems, the\ndata is highly imbalanced. \n\n## Overview\n\nThe challenge is to create a model that uses data from the first 24 hours of intensive care to predict patient survival. MIT's GOSSIS community initiative, with privacy certification from the Harvard Privacy Lab, has provided a dataset of more than 130,000 hospital Intensive Care Unit (ICU) visits from patients, spanning a one-year timeframe. This data is part of a growing global effort and consortium spanning Argentina, Australia, New Zealand, Sri Lanka, Brazil, and more than 200 hospitals in the United States.","09948ef2":"Since we can see some correlation in daily and hourly attributes, we can drop the daily attributes and focus on hourly features. The reason being that the hourly features will be available much sooner than daily ones and that's why, based on those features, the suitable action can be taken much sooner.","7c6a2b05":"Out of the 186 features, 8 are of `object` data types. These can be categorical features.","2535931c":"We will next separate out the target column from the training dataset.","ef5232ed":"GOSSIS score refers to the **Global Open Source Severity of Illness Score** which gives an idea about how severe a patient is. We can try comparing this particular feature with the `hospital_death` column to if there is any correlation between the 2 columns.","adbbfb4e":"For the other categories, we will simply look at the correlation since they are more important and considering them one by one will take a lot of time.","552e4b3e":"As we saw above, bmi in itself was not having any major effect, but as soon as we converted it to the categories, we can see that some categories like `underweight` have a larger ratio of hospital deaths and thus would be a better choice than bmi.","080a6238":"From the above correlation heatmap, we can drop the following columns:\n\n1. `d1_sodium_min`\n2. `d1_sodium_max`\n3. `d1_wbc_max`\n4. `d1_wbc_min`\n5. `d1_platelets_max`\n6. `d1_platelets_min`\n7. `d1_lactate_max`\n8. `d1_lactate_min`\n9. `h1_hco3_max`\n10. `h1_hco3_min`\n11. `d1_bun_max`\n12. `d1_bun_min`\n13. `d1_bilrubin_min`\n14. `d1_bilrubin_max`\nand so on...\n\nOn a more general level, we can decide to drop all the daily attributes and only keep the hourly features.","49e9700b":"And there we go! We have finally found the second column which was present in the dictionary but not in the columns :)","d62e38fa":"### APACHE covariate","6cf9e0bb":"## Model Training & Evaluation","93e52b51":"There is no significant variation in percentage hospital deaths for the 3 icu stay types and can be dropped.","8eec8cd3":"Just like in the case of height, weight also does not seem to have a significant effect on the target variable and can be dropped (anyways we are thinking of taking into account the bmi).","4ab97c75":"### APACHE prediction","bf16a34d":"Let's go over each column in this category, one by one. We will start off with `hospital_death` which is our target column as well.","6935c7f8":"Next, we will look at `readmission_status` column.","c2eb9301":"### Demographic","8e3942d1":"As we can see above, there is a clear imbalance in the distribution of ICU types, with Med-Surg ICU being about 55%.","85999c71":"Next, we will convert these categorical features into numerical features. First, let's check the number of categories in each of these categorical features.","bd806a88":"We can see that there is a correlation of 0.88 between both the columns. Since we are more interested in cases dealing with ICU, we can drop the `apache_4a_hospital_death_prob` column.","a18940d1":"Let's now refer to the dictionary file to get a better understanding of various columns present in the dataset.","ed85b23d":"We can see that `encounter_id` and `patient_id` are unique for every data point and thus, do not provide any extra information and can be dropped. `hospital_id` can convey information about the facilities, doctors, etc. available at a specific hospital.","74388a6d":"As we can see, we have some id columns - `encounter_id`, `patient_id`, `hospital_id`, `icu_id`\n\nThere are some columns like `readmission_status` which only have value 0 and can be ignored since they don't provide any extra information.\n\nWe also have the target column - `hospital_death` which is already numerical (0 and 1)\n\nOther important columns we have are:\n\n1. `age` - Age of the patient\n2. `bmi` - BMI of the patient (Since we already have information about BMI, we can ignore height and weight)\n3. `elective_surgery` - Categorical feature\n\netc.\n\nWe also have some features providing apache scores.","12879c38":"As we can see from the above columns, in most cases the values in both columns is same. The `Sepsis` and `Cardiovascular` actually can be explained based on the fact that cardiovascular diseases or cardiac dysfunction is a consequence of severe sepsis.\n\n`Neurological` and `Neurologic` are essentially the same body systems.\n\nSince we are preferring APACHE III over APACHE II, we can drop the `apache_2_bodysystem` column.","b3153d52":"### Labs","9e210828":"### Identifier","6cd972c4":"All of the above features provide information about the specific disease that a patient was diagnosed with. While there can be some correlation between these features based on symptoms, it's better to keep all of them as it is. We can also fill the missing values with 0 in the case of each of these features.","407f9659":"Let's first verify that there are no missing values in categorical columns.","a717d6bd":"As we can see, there is no significant effect of gender on the `hospital_death` column and thus, can be dropped.\n\nNow, let's look at the `height` column.","866eba9e":"The above plot does not provide us information about the proportion of deaths with respect to elective surgery. Let's try and obtain that.","6e7e1bdc":"Next, we will look at `icu_type` column.","f7e99b06":"As we can see above, there are some high correlation columns, but since these are vitals about patients, it's better to not drop them for now.\n\nBut, we can still drop the following columns:\n\n1. `h1_sysbp_noninvasive_max`\n2. `h1_sysbp_noninvasive_min`\n3. `h1_mbp_noninvasive_max`\n4. `h1_mbp_noninvasive_min`\n5. `h1_diasbp_noninvasive_max`\n6. `h1_diasbp_noninvasive_min`","9cc89ed2":"We can see that most patients are between the age of 50 to 90, which clearly shows a skewed distribution.","c3e4d55a":"There are 91.7k samples and 186 columns.","47ca2c3e":"There are 2 columns - `apache_3j_bodysystem` and `apache_2_bodysystem` which belong to this category. Both of them provide the admission diagnosis group for APACHE II and III, respectively. \n\n**APACHE** or Acute Physiology and Chronic Health Evaluation is another ICU scoring system which provides information about the severity of disease and risk of deaths in the first 24 hours of patient's admission to an ICU. The range lies between 0 and 71 (integers), higher the number, greater the risk of death.\n\nSince both columns are effectively APACHE columns, it can be expected that both of them have high correlation. The same is seen as per [this report](https:\/\/pubmed.ncbi.nlm.nih.gov\/11579607):\n\n> \"Results: Both systems showed a significant association between higher scores and higher mortality. The APACHE II system under-predicted the actual hospital mortality rate. The APACHE III systems had a higher discriminative power (area 0.7462) than the APACHE II systems (area 0.6856; p < 0.05).\"\n\nThis shows that APACHE III is a better score than APACHE II. Thus, whenever required, we will prefer APACHE III over APACHE II. This will also help in reducing multi-correlation between columns.","19a84beb":"Notice that there is no significant difference in distribution of bmi for target variable.\n\nWe can see that there is a higher distribution of bmi lying in \"overweight\" (25.0 to 29.9), \"obese\" (30.0 and above) and the \"normal\" (18.5 to 24.9), in the same order. We can verify the same as follows.","d8c2c9b5":"Next, let's explore the `gender` column.","23e9839f":"The main difference, as we can see, is that in case of hospital deaths, the number of days is much lower.","2c27e36b":"WiDS Datathon workshop organized by WiDS Mumbai\n\nDay - 5\n\nLet us have a look at the approach we will follow to solve the these kind of problem statement taking WiDS Datathon 2020 dataset as an example.","b1534dee":"From the above correlation heatmap, we can see that there is high correlation between some columns. Based on the same, we will drop the following columns:\n\n1. `ventilated_apache`\n2. `gcs_eyes_apache`\n3. `gcs_verbal_apache`\n4. `apache_3j_diagnosis`","771ff258":"The next step is to use an ML algorithm for training. Let's try decision tree algorithm.","7fee2673":"There is a significant variation in percentage of hospital deaths for the ICU types which means that there is an effect of the ICU type on the target variable.","62f7d7c0":"The first thing that we observe is that there are large number of outliers. Let's analyse this column based on the target variable.","9442c889":"## Exploratory Data Analysis\n\n[Taken from this kernel](https:\/\/www.kaggle.com\/vishwesh5\/patient-survival)","efbfc478":"## Data Pre-processing","c7213f91":"There are about 55% male and 45% female patients which shows that in terms of gender, the dataset is about balanced.","4042bc07":"### Labs blood gas","27061d8f":"We can see the same above. There are actually 186 columns in the dataset but 188 in the dictionary. This means that there is one more column which is missing in the dataframe but present in the dictionary.","b1748e2a":"### Vitals","4072d70c":"As we can see, height is not having any significant effect on the target column and thus can be dropped.\n\nNext, we will look at `hospital_admit_source` column which gives information about where the patient was before getting admitted to the hospital.","1807ad94":"As we can see, the percentage of deaths are about uniform for each ethnicity, and thus, ethnicity column can be dropped from the dataframe.","b658cf7e":"The next column (the last one in this category) that we will explore is `weight`.","19b5fb3c":"We can see that around 80% patients were not admitted for elective surgery. Let's see if there is any correlation between this feature and the target feature.","8210a9fa":"As we can see, the 2 columns in the above category provide information about the mortality of a patient. Again, we can expect some correlation for both the columns. Let's verify the same.","9b10fe41":"The next column we will go over is the `age` column which describes the age of the patient.","c6bc3e0b":"The next column we will be focusing on is `elective_surgery`.","2e773543":"We can see that about 9% of the patients who were admitted not for an elective surgery died, whereas the percentage is 3% in case when the patients were admitted for an elective surgery. This might be because elective surgeries are usually not very serious in nature.\n\nNext, let's look at the ethnicity column.","9b54f3b1":"The category column gives information about the category of the feature.","572f0840":"As we can see from the description, these set of features provide information about the patient's vitals during the first hour and the first 24 hours of their stay. Let's see if there is any correlation in these columns.","7e88cb06":"Let's go over each category one by one.","56c386f0":"As we can see, this column has only value 0 which means that it does not provide any extra information and thus, can be dropped.","c9cca525":"### APACHE comorbidity","9c3b803c":"Let's first make the list of categorical and numerical features.","924769a3":"We can clearly see a variation in percentage of deaths for different hospital admit sources and thus, it is a feature which we cannot drop.\n\nNext, we will look at `icu_admit_source` column.","a0b8a788":"Now that we have carried out the EDA part, the next step to carry is Data Pre-processing in order to convert the columns to their proper datatype.","546befb3":"As we can see, around 90% of the values are from `admit` category, which clearly shows the imbalance.","a169ffbc":"As we can see, there are some columns which have huge amount of missing values.","9331a936":"Next, we will look at `pre_icu_los_days` column.","d017da07":"### GOSSIS example prediction","9308c8d5":"As we can see, we are now left with 128 columns only, which is a significantly smaller number than what we had in the beginning (187).","02a5006e":"As we can see, the specified column is actually not present in the dataframe, which raises an important concern that **there are columns in the dictionary which are not present in the dataframe.**","d296d9b2":"Next we will go over the `bmi` column.","b94890fc":"Because of the extensive EDA, we have come up with 59 columns which can be dropped. We have also added one extra column (`bmi_category`) which, as we saw earlier, provides better information than bmi. Now, we can further process these columns and fit a classification model.","39a787e5":"We can see that most patients (roughly 55%) were present in the emergency department before getting admitted to the hospital.\n\nLet's check if this has any effect on the target variable.","1b46ee5e":"As we can see, it has far less unique values meaning that it might be conveying important information about the specific icu in which the patient was admitted and can have some effect on the target variable.","4af5438d":"We can see that there is a larger proportion (close to 80%) of patients from one specific ethnicity. This also shows that if we use this to train our model, we might end up with higher bias towards ethnicity, which is not desirable.","5d33b3ed":"From the above bar graph, we can clearly see the imbalance in the dataset.","a385c1f1":"## Submission"}}