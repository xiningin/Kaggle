{"cell_type":{"a86e0693":"code","d0348795":"code","bd3e2217":"code","dbd0a61c":"code","960c7182":"code","b46a7946":"code","c9702d67":"code","283831d5":"code","af440126":"code","5607e263":"code","96151ff6":"code","6de246ae":"code","55403548":"code","3ccf193c":"code","52e294eb":"code","0af12f71":"code","320350f3":"code","76e36e18":"code","37a5d631":"code","0ce720ef":"code","6b1a09e3":"code","73c843ac":"markdown"},"source":{"a86e0693":"import numpy as np # linear algebra|\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)","d0348795":"ids_datatypes = {\n    'Dst Port': np.int32,\n    'Protocol': np.int8,\n    'Flow Duration': np.int64,\n    'Tot Fwd Pkts': np.int16,\n    'Tot Bwd Pkts': np.int16,\n    'TotLen Fwd Pkts': np.int32,\n    'TotLen Bwd Pkts': np.int32,\n    'Fwd Pkt Len Max': np.int32,\n    'Fwd Pkt Len Min': np.int32,\n    'Fwd Pkt Len Mean': np.float64,\n    'Fwd Pkt Len Std': np.float64,\n    'Bwd Pkt Len Max': np.int16,\n    'Bwd Pkt Len Min': np.int16,\n    'Bwd Pkt Len Mean': np.float64,\n    'Bwd Pkt Len Std': np.float64,\n    'Flow Byts\/s': np.float64,\n    'Flow Pkts\/s': np.float64,\n    'Flow IAT Mean': np.float64,\n    'Flow IAT Std': np.float64,\n    'Flow IAT Max': np.int64,\n    'Flow IAT Min': np.int32,\n    'Fwd IAT Tot': np.int32,\n    'Fwd IAT Mean': np.float32,\n    'Fwd IAT Std': np.float64,\n    'Fwd IAT Max': np.int32, \n    'Fwd IAT Min': np.int32,\n    'Bwd IAT Tot': np.int32,\n    'Bwd IAT Mean': np.float64,\n    'Bwd IAT Std': np.float64,\n    'Bwd IAT Max': np.int64,\n    'Bwd IAT Min': np.int64,\n    'Fwd PSH Flags': np.int8,\n    'Bwd PSH Flags': np.int8,\n    'Fwd URG Flags': np.int8,\n    'Bwd URG Flags': np.int8,\n    'Fwd Header Len': np.int32,\n    'Bwd Header Len': np.int32,\n    'Fwd Pkts\/s' : np.float64,\n    'Bwd Pkts\/s': np.float64,\n    'Pkt Len Min': np.int16,\n    'Pkt Len Max': np.int32,\n    'Pkt Len Mean': np.float64,\n    'Pkt Len Std': np.float64,\n    'Pkt Len Var': np.float64,\n    'FIN Flag Cnt': np.int8,\n    'SYN Flag Cnt': np.int8,\n    'RST Flag Cnt': np.int8,\n    'PSH Flag Cnt': np.int8,\n    'ACK Flag Cnt': np.int8,\n    'URG Flag Cnt': np.int8,\n    'CWE Flag Count': np.int8,\n    'ECE Flag Cnt': np.int8,\n    'Pkt Size Avg': np.float32,\n    'Fwd Seg Size Avg': np.float32,\n    'Bwd Seg Size Avg': np.float32,\n    'Fwd Byts\/b Avg': np.int8,\n    'Fwd Pkts\/b Avg': np.int8,\n    'Fwd Blk Rate Avg': np.int8,\n    'Bwd Byts\/b Avg': np.int8,\n    'Bwd Pkts\/b Avg': np.int8,\n    'Bwd Blk Rate Avg': np.int8,\n    'Subflow Fwd Pkts': np.int16,\n    'Subflow Fwd Byts': np.int32,\n    'Subflow Bwd Pkts': np.int16,\n    'Subflow Bwd Byts': np.int32,\n    'Init Fwd Win Byts': np.int32, \n    'Init Bwd Win Byts': np.int32,\n    'Fwd Act Data Pkts': np.int16,\n    'Fwd Seg Size Min': np.int8,\n    'Active Mean': np.float64,\n    'Active Std': np.float64,\n    'Active Max': np.int32,\n    'Active Min': np.int32,\n    'Idle Mean': np.float64,\n    'Idle Std': np.float64,\n    'Idle Max': np.int64,\n    'Idle Min': np.int64,\n    'Label': object\n}\nused_cols = (ids_datatypes.keys())","bd3e2217":"df1 = pd.read_csv(\"..\/input\/ids-intrusion-csv\/02-14-2018.csv\", dtype=ids_datatypes, usecols=used_cols)\ndf2 = pd.read_csv(\"..\/input\/ids-intrusion-csv\/02-15-2018.csv\", dtype=ids_datatypes, usecols=used_cols)\ndf5 = pd.read_csv(\"..\/input\/ids-intrusion-csv\/02-21-2018.csv\", dtype=ids_datatypes, usecols=used_cols)\ndf6 = pd.read_csv(\"..\/input\/ids-intrusion-csv\/02-22-2018.csv\", dtype=ids_datatypes, usecols=used_cols)\ndf7 = pd.read_csv(\"..\/input\/ids-intrusion-csv\/02-23-2018.csv\", dtype=ids_datatypes, usecols=used_cols)\ndf10 = pd.read_csv(\"..\/input\/ids-intrusion-csv\/03-02-2018.csv\", dtype=ids_datatypes, usecols=used_cols)","dbd0a61c":"merge = [\n    df1, \n    df2,\n    df5,\n    df6, \n    df7, \n    df10\n]\ndf_ids2018 = pd.concat(merge)\ndel merge\ndf_ids2018.info()","960c7182":"df_ids2018['Label'].value_counts()","b46a7946":"df_ids2018.isna().sum().sum()","c9702d67":"df_ids2018 = df_ids2018.dropna()","283831d5":"df_ids2018.isna().sum().sum()","af440126":"df_ids2018.info()","5607e263":"label_dict = {\n    'Benign': 1,\n    'FTP-BruteForce': 2,\n    'SSH-Bruteforce': 3,\n    'DDOS attack-HOIC': 4,\n    'Bot': 5,\n    'DoS attacks-GoldenEye' : 6,\n    'DoS attacks-Slowloris': 7,\n    'DDOS attack-LOIC-UDP': 8,\n    'Brute Force -Web': 9,\n    'Brute Force -XSS': 10,\n    'SQL Injection': 11\n}\ndf_ids2018['Label'] = [label_dict[item] for item in df_ids2018['Label']]","96151ff6":"df_ids2018.head()","6de246ae":"df_ids2018 = df_ids2018.replace([np.inf, -np.inf], np.nan)\ndf_ids2018.isna().sum().sum()","55403548":"df_ids2018 = df_ids2018.dropna()","3ccf193c":"df_ids2018.isna().sum().sum()","52e294eb":"benign = df_ids2018[df_ids2018['Label'] == 1][:100000]\nhoic = df_ids2018[df_ids2018['Label'] == 2][:100000]\nbot = df_ids2018[df_ids2018['Label'] == 3][:100000]\nftp_brute = df_ids2018[df_ids2018['Label'] == 4][:100000]\nssh_brute = df_ids2018[df_ids2018['Label'] == 5][:100000]\ndos_eye = df_ids2018[df_ids2018['Label'] == 6]\ndos_slow = df_ids2018[df_ids2018['Label'] == 7]\nddos = df_ids2018[df_ids2018['Label'] == 8]\nbrute_web = df_ids2018[df_ids2018['Label'] == 9]\nbrute_xss = df_ids2018[df_ids2018['Label'] == 10]\nsql = df_ids2018[df_ids2018['Label'] == 11]","0af12f71":"merge = [\n    benign, hoic, bot, ftp_brute, ssh_brute, dos_eye, dos_slow, ddos, brute_web, brute_xss, sql\n]\ndf_ids2018 = pd.concat(merge)\ndel merge\ndf_ids2018['Label'].value_counts()","320350f3":"from imblearn.over_sampling import SMOTE \nsm = SMOTE(random_state=42)\nX_res, y_res = sm.fit_resample(df_ids2018.drop('Label', axis=1), df_ids2018['Label'])","76e36e18":"X_res.info()","37a5d631":"sampled_df = X_res.insert(77, 'Label', y_res)","0ce720ef":"df = X_res.copy()","6b1a09e3":"df.to_csv(\"cleaned_ids2018_sampled.csv\")","73c843ac":"Benign                   4883142\nDDOS attack-HOIC          686012\nBot                       286191\nFTP-BruteForce            193360\nSSH-Bruteforce            187589\nDoS attacks-GoldenEye      41508\nDoS attacks-Slowloris      10990\nDDOS attack-LOIC-UDP        1730\nBrute Force -Web             611\nBrute Force -XSS             230\nSQL Injection                 87"}}