{"cell_type":{"60f581ea":"code","ecf6ac04":"code","652ed433":"code","8fd8e239":"code","1b9e293a":"code","2de42baa":"code","5175d12b":"code","3d4476ba":"markdown","575f12a1":"markdown","5adef625":"markdown","e6885b07":"markdown","86c41c8b":"markdown","ff0212bb":"markdown","135cbe70":"markdown"},"source":{"60f581ea":"import os\nimport csv\nimport pandas as pd\nimport pydicom as dicom","ecf6ac04":"%%time\ntrain_folder_dcm = '..\/input\/rsna-intracranial-hemorrhage-detection\/stage_1_train_images\/'\ntrain_images_path = os.listdir(train_folder_dcm)\n\ntest_folder_dcm = '..\/input\/rsna-intracranial-hemorrhage-detection\/stage_1_test_images\/'\ntest_images_path = os.listdir(test_folder_dcm)","652ed433":"%%time\ndataset = dicom.dcmread(train_folder_dcm + train_images_path[0])\ndataset","8fd8e239":"%%time\ndataset = dicom.dcmread(test_folder_dcm + test_images_path[0])\ndataset","1b9e293a":"# list of attributes in dicom image\nattributes = ['SOPInstanceUID', 'Modality', 'PatientID', 'StudyInstanceUID',\n              'SeriesInstanceUID', 'StudyID', 'ImagePositionPatient',\n              'ImageOrientationPatient', 'SamplesPerPixel', 'PhotometricInterpretation',\n              'Rows', 'Columns', 'PixelSpacing', 'BitsAllocated', 'BitsStored', 'HighBit',\n              'PixelRepresentation', 'WindowCenter', 'WindowWidth', 'RescaleIntercept',\n              'RescaleSlope', 'PixelData']","2de42baa":"%%time\nwith open('train_patient_detail.csv', 'w', newline ='') as csvfile:\n    writer = csv.writer(csvfile, delimiter=',')\n    writer.writerow(attributes)\n    for image in train_images_path:\n        ds = dicom.dcmread(os.path.join(train_folder_dcm, image))\n        rows = []\n        for field in attributes:\n            if ds.data_element(field) is None:\n                rows.append('')\n            else:\n                x = str(ds.data_element(field)).replace(\"'\", \"\")\n                y = x.find(\":\")\n                x = x[y+2:]\n                rows.append(x)\n        writer.writerow(rows)","5175d12b":"%%time\nwith open('test_patient_detail.csv', 'w', newline ='') as csvfile:\n    writer = csv.writer(csvfile, delimiter=',')\n    writer.writerow(attributes)\n    for image in test_images_path:\n        ds = dicom.dcmread(os.path.join(test_folder_dcm, image))\n        rows = []\n        for field in attributes:\n            if ds.data_element(field) is None:\n                rows.append('')\n            else:\n                x = str(ds.data_element(field)).replace(\"'\", \"\")\n                y = x.find(\":\")\n                x = x[y+2:]\n                rows.append(x)\n        writer.writerow(rows)","3d4476ba":"## Test set attribute extraction","575f12a1":"## Get list of images for train and test sets","5adef625":"### There is a bad dicom and it is skipped.","e6885b07":"In total, there are 22 attributes for each dcm, I am creating a list of the attributes.","86c41c8b":"## Training set attribute extraction","ff0212bb":"### List of attributes in test set dicom image","135cbe70":"### List of attributes in training set dicom image"}}