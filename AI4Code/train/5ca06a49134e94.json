{"cell_type":{"d680a62b":"code","5502bd48":"code","ee19d92e":"code","c9dee317":"code","38283b75":"code","b6bc254a":"code","926b093d":"code","2d60ac2e":"code","d7cee42b":"code","2ac9aec8":"code","1a074d04":"code","8db2cc6a":"code","7ffdce45":"code","8585c565":"code","5704271c":"code","434df740":"code","0323b8a5":"code","96e045fe":"code","65f36e76":"code","c7589a6e":"code","1cd1c153":"code","67e2920f":"code","fb4ff37d":"code","4d8242ea":"code","48349051":"code","ceb0185d":"code","9799626d":"code","2047961e":"code","4998aa9a":"code","10da9c55":"code","24415250":"code","ffd83e0d":"code","73d5dd94":"code","69889c9e":"code","866e50fb":"code","68a69e96":"code","fb96de78":"code","14341065":"code","cc757de8":"code","cfb13c29":"code","b3ea468b":"code","951def10":"code","09f049e5":"code","2dc113c1":"code","bb4a2447":"markdown","68d36d2b":"markdown","c8c9eb1d":"markdown","c21ba692":"markdown","e11f3286":"markdown","4f6e5a31":"markdown","cf39942d":"markdown","14f13b73":"markdown","6513e2bd":"markdown","dccb680c":"markdown","9e6255d7":"markdown","f53be3da":"markdown","cf0118d2":"markdown","b76e91e7":"markdown","2bfe915f":"markdown","3abb3c64":"markdown","292d1b8d":"markdown","9bf43f38":"markdown","fd87e7f3":"markdown","f98e7779":"markdown","5b027362":"markdown","7ab7d89f":"markdown"},"source":{"d680a62b":"#GENERAL\nimport pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n#PATH PROCESS\nimport os\nimport os.path\nfrom pathlib import Path\nimport glob\n#IMAGE PROCESS\nfrom PIL import Image\nfrom keras.preprocessing import image\nfrom tensorflow.keras.preprocessing.image import ImageDataGenerator\nimport cv2\nfrom keras.applications.vgg16 import preprocess_input, decode_predictions\n#SCALER & TRANSFORMATION\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.preprocessing import MinMaxScaler\nfrom keras.utils.np_utils import to_categorical\nfrom sklearn.model_selection import train_test_split\nfrom keras import regularizers\nfrom sklearn.preprocessing import LabelEncoder\n#ACCURACY CONTROL\nfrom sklearn.metrics import confusion_matrix, accuracy_score, classification_report, roc_auc_score, roc_curve\nfrom sklearn.model_selection import GridSearchCV, cross_val_score\nfrom sklearn.metrics import mean_squared_error, r2_score\n#OPTIMIZER\nfrom keras.optimizers import RMSprop,Adam,Optimizer,Optimizer, SGD\n#MODEL LAYERS\nfrom tensorflow.keras.models import Sequential\nfrom keras.layers import Dense, Dropout, Flatten, Conv2D, MaxPool2D, BatchNormalization,MaxPooling2D,BatchNormalization,\\\n                        Permute, TimeDistributed, Bidirectional,GRU, SimpleRNN, LSTM, GlobalAveragePooling2D, SeparableConv2D, ZeroPadding2D, Convolution2D, ZeroPadding2D\nfrom keras import models\nfrom keras import layers\nimport tensorflow as tf\nfrom keras.applications import VGG16,VGG19,inception_v3\nfrom keras import backend as K\nfrom keras.utils import plot_model\n#SKLEARN CLASSIFIER\nfrom xgboost import XGBClassifier, XGBRegressor\nfrom lightgbm import LGBMClassifier, LGBMRegressor\nfrom catboost import CatBoostClassifier, CatBoostRegressor\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.naive_bayes import GaussianNB\nfrom sklearn.ensemble import RandomForestClassifier, RandomForestRegressor\nfrom sklearn.ensemble import GradientBoostingClassifier, GradientBoostingRegressor\nfrom sklearn.ensemble import BaggingRegressor\nfrom sklearn.tree import DecisionTreeClassifier, DecisionTreeRegressor\nfrom sklearn.neural_network import MLPClassifier, MLPRegressor\nfrom sklearn.neighbors import KNeighborsClassifier, KNeighborsRegressor\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.cross_decomposition import PLSRegression\nfrom sklearn.linear_model import Ridge\nfrom sklearn.linear_model import RidgeCV\nfrom sklearn.linear_model import Lasso\nfrom sklearn.linear_model import LassoCV\nfrom sklearn.linear_model import ElasticNet\nfrom sklearn.linear_model import ElasticNetCV\n#IGNORING WARNINGS\nfrom warnings import filterwarnings\nfilterwarnings(\"ignore\",category=DeprecationWarning)\nfilterwarnings(\"ignore\", category=FutureWarning) \nfilterwarnings(\"ignore\", category=UserWarning)","5502bd48":"Train_Data_Path = Path(\"..\/input\/augmented-skincancer-isic\/skin_cancer\/train\")\nTest_Data_Path = Path(\"..\/input\/augmented-skincancer-isic\/skin_cancer\/Test\")","ee19d92e":"Train_JPG_Path = list(Train_Data_Path.glob(r\"*\/*.jpg\"))","c9dee317":"Test_JPG_Path = list(Test_Data_Path.glob(r\"*\/*.jpg\"))","38283b75":"print(Test_JPG_Path[0:5])\nprint(\"----\"*20)\nprint(Train_JPG_Path[0:5])","b6bc254a":"Train_JPG_Labels = list(map(lambda x: os.path.split(os.path.split(x)[0])[1],Train_JPG_Path))","926b093d":"print(\"actinic keratosis\",Train_JPG_Labels.count(\"actinic keratosis\"))\nprint(\"basal cell carcinoma\",Train_JPG_Labels.count(\"basal cell carcinoma\"))\nprint(\"dermatofibroma\",Train_JPG_Labels.count(\"dermatofibroma\"))\nprint(\"melanoma\",Train_JPG_Labels.count(\"melanoma\"))\nprint(\"nevus\",Train_JPG_Labels.count(\"nevus\"))\nprint(\"pigmented benign keratosis\",Train_JPG_Labels.count(\"pigmented benign keratosis\"))\nprint(\"seborrheic keratosis\",Train_JPG_Labels.count(\"seborrheic keratosis\"))\nprint(\"squamous cell carcinoma\",Train_JPG_Labels.count(\"squamous cell carcinoma\"))\nprint(\"vascular lesion\",Train_JPG_Labels.count(\"vascular lesion\"))","2d60ac2e":"Test_JPG_Labels = list(map(lambda x: os.path.split(os.path.split(x)[0])[1],Test_JPG_Path))","d7cee42b":"print(\"actinic keratosis\",Test_JPG_Labels.count(\"actinic keratosis\"))\nprint(\"basal cell carcinoma\",Test_JPG_Labels.count(\"basal cell carcinoma\"))\nprint(\"dermatofibroma\",Test_JPG_Labels.count(\"dermatofibroma\"))\nprint(\"melanoma\",Test_JPG_Labels.count(\"melanoma\"))\nprint(\"nevus\",Test_JPG_Labels.count(\"nevus\"))\nprint(\"pigmented benign keratosis\",Test_JPG_Labels.count(\"pigmented benign keratosis\"))\nprint(\"seborrheic keratosis\",Test_JPG_Labels.count(\"seborrheic keratosis\"))\nprint(\"squamous cell carcinoma\",Test_JPG_Labels.count(\"squamous cell carcinoma\"))\nprint(\"vascular lesion\",Test_JPG_Labels.count(\"vascular lesion\"))","2ac9aec8":"Train_JPG_Path_Series = pd.Series(Train_JPG_Path,name=\"JPG\").astype(str)\nTest_JPG_Path_Series = pd.Series(Test_JPG_Path,name=\"JPG\").astype(str)","1a074d04":"Train_JPG_Labels_Series = pd.Series(Train_JPG_Labels,name=\"CATEGORY\")\nTest_JPG_Labels_Series = pd.Series(Test_JPG_Labels,name=\"CATEGORY\")","8db2cc6a":"Train_JPG_Labels_Series.replace({\"actinic keratosis\":\"AK\",\n                                \"basal cell carcinoma\":\"BCC\",\n                                \"dermatofibroma\":\"DF\",\n                                \"melanoma\":\"MEL\",\n                                \"nevus\":\"N\",\n                                \"pigmented benign keratosis\":\"PBK\",\n                                \"seborrheic keratosis\":\"SK\",\n                                \"squamous cell carcinoma\":\"SCC\",\n                                \"vascular lesion\":\"VL\"},inplace=True)","7ffdce45":"Test_JPG_Labels_Series.replace({\"actinic keratosis\":\"AK\",\n                                \"basal cell carcinoma\":\"BCC\",\n                                \"dermatofibroma\":\"DF\",\n                                \"melanoma\":\"MEL\",\n                                \"nevus\":\"N\",\n                                \"pigmented benign keratosis\":\"PBK\",\n                                \"seborrheic keratosis\":\"SK\",\n                                \"squamous cell carcinoma\":\"SCC\",\n                                \"vascular lesion\":\"VL\"},inplace=True)","8585c565":"print(Train_JPG_Labels_Series.value_counts())","5704271c":"print(Test_JPG_Labels_Series.value_counts())","434df740":"Main_Train_Data = pd.concat([Train_JPG_Path_Series,Train_JPG_Labels_Series],axis=1)","0323b8a5":"Main_Test_Data = pd.concat([Test_JPG_Path_Series,Test_JPG_Labels_Series],axis=1)","96e045fe":"print(Main_Train_Data.head(-1))","65f36e76":"print(Main_Test_Data.head(-1))","c7589a6e":"Main_Train_Data = Main_Train_Data.sample(frac=1).reset_index(drop=True)\nMain_Test_Data = Main_Test_Data.sample(frac=1).reset_index(drop=True)","1cd1c153":"print(Main_Train_Data.head(-1))","67e2920f":"print(Main_Test_Data.head(-1))","fb4ff37d":"plt.style.use(\"dark_background\")","4d8242ea":"figure = plt.figure(figsize=(10,10))\nx = plt.imread(Main_Train_Data[\"JPG\"][33])\nplt.xlabel(x.size)\nplt.ylabel(x.shape)\nplt.title(Main_Train_Data[\"CATEGORY\"][33])\nplt.imshow(x)","48349051":"x = plt.imread(Main_Test_Data[\"JPG\"][25])\nplt.xlabel(x.size)\nplt.ylabel(x.shape)\nplt.title(Main_Test_Data[\"CATEGORY\"][25])\nplt.imshow(x)","ceb0185d":"figure_Gen_Train, axes_Gen_Train = plt.subplots(nrows=3,\n                           ncols=6,\n                           figsize=(11,11))\n\nfor f_Gen_Train,a_Gen_Train in enumerate(axes_Gen_Train.flat):\n    image_Gen_Train = plt.imread(Main_Train_Data[\"JPG\"][f_Gen_Train])\n    a_Gen_Train.imshow(image_Gen_Train)\n    a_Gen_Train.set_xlabel(image_Gen_Train.shape)\n    a_Gen_Train.set_ylabel(image_Gen_Train.size)\n    a_Gen_Train.set_title(Main_Train_Data[\"CATEGORY\"][f_Gen_Train])\nplt.tight_layout()\nplt.show()","9799626d":"figure_Gen_Test, axes_Gen_Test = plt.subplots(nrows=3,\n                           ncols=6,\n                           figsize=(11,11))\n\nfor f_Gen_Test,a_Gen_Test in enumerate(axes_Gen_Test.flat):\n    image_Gen_Test = plt.imread(Main_Test_Data[\"JPG\"][f_Gen_Test])\n    a_Gen_Test.imshow(image_Gen_Test)\n    a_Gen_Test.set_xlabel(image_Gen_Test.shape)\n    a_Gen_Test.set_ylabel(image_Gen_Test.size)\n    a_Gen_Test.set_title(Main_Test_Data[\"CATEGORY\"][f_Gen_Test])\nplt.tight_layout()\nplt.show()","2047961e":"image_Main = Main_Train_Data[\"JPG\"][244]\nimage_Read = cv2.imread(image_Main)\nimage_Blurred = cv2.GaussianBlur(image_Read,(1,1),2)\nimage_Canny = cv2.Canny(image_Read,20,100)\nimage_Sharp = cv2.addWeighted(image_Read,3.1,image_Blurred,-0.5,0)\n\nfigure_1,axis_1 = plt.subplots(1,4,figsize=(12,12))\n\n\naxis_1[0].imshow(image_Read)\naxis_1[1].imshow(image_Blurred)\naxis_1[2].imshow(image_Canny)\naxis_1[3].imshow(image_Sharp)","4998aa9a":"plt.imshow(image_Canny)","10da9c55":"plt.imshow(image_Sharp)","24415250":"plt.imshow(image_Blurred)","ffd83e0d":"figure_Canny_Train, axes_Canny_Train = plt.subplots(nrows=3,\n                           ncols=6,\n                           figsize=(11,11))\n\nfor i_Steps,i_Canny in enumerate(axes_Canny_Train.flat):\n    image_Canny_Train = plt.imread(Main_Train_Data[\"JPG\"][i_Steps])\n    image_Canny_Train = cv2.Canny(image_Canny_Train,30,200)\n    i_Canny.imshow(image_Canny_Train)\n    i_Canny.set_xlabel(image_Canny_Train.shape)\n    i_Canny.set_ylabel(image_Canny_Train.size)\n    i_Canny.set_title(Main_Train_Data[\"CATEGORY\"][i_Steps])\nplt.tight_layout()\nplt.show()","73d5dd94":"image_Thr_One = Main_Train_Data[\"JPG\"][22]\nimage_Thr_Two = Main_Train_Data[\"JPG\"][152]\nimage_Thr_Three = Main_Train_Data[\"JPG\"][1002]\nimage_Thr_Four = Main_Train_Data[\"JPG\"][2858]\nimage_Thr_Five = Main_Train_Data[\"JPG\"][6222]\nimage_Thr_Six = Main_Train_Data[\"JPG\"][8858]\n\n\nimage_Thr_One = cv2.imread(image_Thr_One)\nimage_Thr_Two = cv2.imread(image_Thr_Two)\nimage_Thr_Three = cv2.imread(image_Thr_Three)\nimage_Thr_Four = cv2.imread(image_Thr_Four)\nimage_Thr_Five = cv2.imread(image_Thr_Five)\nimage_Thr_Six = cv2.imread(image_Thr_Six)\n\nig,thresh_One = cv2.threshold(image_Thr_One,90,255,cv2.THRESH_BINARY_INV)\nig,thresh_Two = cv2.threshold(image_Thr_Two,90,255,cv2.THRESH_BINARY_INV)\nig,thresh_Three = cv2.threshold(image_Thr_Three,90,255,cv2.THRESH_BINARY_INV)\nig,thresh_Four = cv2.threshold(image_Thr_Four,90,255,cv2.THRESH_BINARY_INV)\nig,thresh_Five = cv2.threshold(image_Thr_Five,90,255,cv2.THRESH_BINARY_INV)\nig,thresh_Six = cv2.threshold(image_Thr_Six,90,255,cv2.THRESH_BINARY_INV)\n\nthresh_list = [thresh_One,thresh_Two,thresh_Three,thresh_Four,thresh_Five,thresh_Six]\n\nfig_Th,axes_Th = plt.subplots(nrows=3,\n                             ncols=2,\n                             figsize=(10,10))\n\naxes_Th[0,0].imshow(thresh_list[0])\naxes_Th[0,1].imshow(thresh_list[1])\naxes_Th[1,0].imshow(thresh_list[2])\naxes_Th[1,1].imshow(thresh_list[3])\naxes_Th[2,0].imshow(thresh_list[4])\naxes_Th[2,1].imshow(thresh_list[5])","69889c9e":"image_Thr_One_Name = Main_Train_Data[\"CATEGORY\"][22]\nimage_Thr_Two_Name = Main_Train_Data[\"CATEGORY\"][152]\nimage_Thr_Three_Name = Main_Train_Data[\"CATEGORY\"][1002]\nimage_Thr_Four_Name = Main_Train_Data[\"CATEGORY\"][2858]\nimage_Thr_Five_Name = Main_Train_Data[\"CATEGORY\"][6222]\nimage_Thr_Six_Name = Main_Train_Data[\"CATEGORY\"][8858]\n\nimage_Thr_Name_List = [image_Thr_One_Name,image_Thr_Two_Name,\n                      image_Thr_Three_Name,image_Thr_Four_Name,\n                      image_Thr_Five_Name,image_Thr_Six_Name]\n\nfigure_Thr_Test, axes_Thr_Test = plt.subplots(nrows=3,\n                           ncols=2,\n                           figsize=(15,15))\n\nfor f_Thr_Test,a_Thr_Test in enumerate(axes_Thr_Test.flat):\n    a_Thr_Test.imshow(thresh_list[f_Thr_Test])\n    a_Thr_Test.set_xlabel(thresh_list[f_Thr_Test].shape)\n    a_Thr_Test.set_ylabel(thresh_list[f_Thr_Test].size)\n    a_Thr_Test.set_title(image_Thr_Name_List[f_Thr_Test])\nplt.tight_layout()\nplt.show()","866e50fb":"image_AThr_One = Main_Train_Data[\"JPG\"][22]\nimage_AThr_Two = Main_Train_Data[\"JPG\"][152]\nimage_AThr_Three = Main_Train_Data[\"JPG\"][1002]\nimage_AThr_Four = Main_Train_Data[\"JPG\"][2858]\nimage_AThr_Five = Main_Train_Data[\"JPG\"][6222]\nimage_AThr_Six = Main_Train_Data[\"JPG\"][8858]\n\nimage_AThr_One = cv2.imread(image_AThr_One,0)\nimage_AThr_Two = cv2.imread(image_AThr_Two,0)\nimage_AThr_Three = cv2.imread(image_AThr_Three,0)\nimage_AThr_Four = cv2.imread(image_AThr_Four,0)\nimage_AThr_Five = cv2.imread(image_AThr_Five,0)\nimage_AThr_Six = cv2.imread(image_AThr_Six,0)\n\n\nAthresh_One = cv2.adaptiveThreshold(image_AThr_One,200,\n                            cv2.ADAPTIVE_THRESH_GAUSSIAN_C,cv2.THRESH_BINARY,11,2)\nAthresh_Two = cv2.adaptiveThreshold(image_AThr_Two,200,\n                            cv2.ADAPTIVE_THRESH_GAUSSIAN_C,cv2.THRESH_BINARY,11,2)\nAthresh_Three = cv2.adaptiveThreshold(image_AThr_Three,200,\n                              cv2.ADAPTIVE_THRESH_GAUSSIAN_C,cv2.THRESH_BINARY,11,2)\nAthresh_Four = cv2.adaptiveThreshold(image_AThr_Four,200,\n                             cv2.ADAPTIVE_THRESH_GAUSSIAN_C,cv2.THRESH_BINARY,11,2)\nAthresh_Five = cv2.adaptiveThreshold(image_AThr_Five,200,\n                             cv2.ADAPTIVE_THRESH_GAUSSIAN_C,cv2.THRESH_BINARY,11,2)\nAthresh_Six = cv2.adaptiveThreshold(image_AThr_Six,200,\n                            cv2.ADAPTIVE_THRESH_GAUSSIAN_C,cv2.THRESH_BINARY,11,2)\n\nAthresh_list = [Athresh_One,Athresh_Two,Athresh_Three,Athresh_Four,Athresh_Five,Athresh_Six]\n\nfig_ATh,axes_ATh = plt.subplots(nrows=3,\n                             ncols=2,\n                             figsize=(15,15))\n\naxes_ATh[0,0].imshow(Athresh_list[0])\naxes_ATh[0,1].imshow(Athresh_list[1])\naxes_ATh[1,0].imshow(Athresh_list[2])\naxes_ATh[1,1].imshow(Athresh_list[3])\naxes_ATh[2,0].imshow(Athresh_list[4])\naxes_ATh[2,1].imshow(Athresh_list[5])","68a69e96":"Back_Subt = cv2.createBackgroundSubtractorMOG2()","fb96de78":"image_SThr_One = Main_Train_Data[\"JPG\"][22]\nimage_SThr_Two = Main_Train_Data[\"JPG\"][152]\nimage_SThr_Three = Main_Train_Data[\"JPG\"][1002]\nimage_SThr_Four = Main_Train_Data[\"JPG\"][2858]\nimage_SThr_Five = Main_Train_Data[\"JPG\"][6222]\nimage_SThr_Six = Main_Train_Data[\"JPG\"][8858]\n\n\nimage_SThr_One = cv2.imread(image_SThr_One)\nimage_SThr_Two = cv2.imread(image_SThr_Two)\nimage_SThr_Three = cv2.imread(image_SThr_Three)\nimage_SThr_Four = cv2.imread(image_SThr_Four)\nimage_SThr_Five = cv2.imread(image_SThr_Five)\nimage_SThr_Six = cv2.imread(image_SThr_Six)\n\nBack_Mask_One = Back_Subt.apply(image_SThr_One)\nBack_Mask_Two = Back_Subt.apply(image_SThr_Two)\nBack_Mask_Three = Back_Subt.apply(image_SThr_Three)\nBack_Mask_Four = Back_Subt.apply(image_SThr_Four)\nBack_Mask_Five = Back_Subt.apply(image_SThr_Five)\nBack_Mask_Six = Back_Subt.apply(image_SThr_Six)\n\nSubt_List = [Back_Mask_One,Back_Mask_Two,Back_Mask_Three,\n            Back_Mask_Four,Back_Mask_Five,Back_Mask_Six]\n\nfig_STh,axes_STh = plt.subplots(nrows=3,\n                             ncols=2,\n                             figsize=(15,15))\n\naxes_STh[0,0].imshow(Subt_List[0])\naxes_STh[0,1].imshow(Subt_List[1])\naxes_STh[1,0].imshow(Subt_List[2])\naxes_STh[1,1].imshow(Subt_List[3])\naxes_STh[2,0].imshow(Subt_List[4])\naxes_STh[2,1].imshow(Subt_List[5])","14341065":"image_SC_One = Main_Train_Data[\"JPG\"][22]\nimage_SC_Two = Main_Train_Data[\"JPG\"][152]\nimage_SC_Three = Main_Train_Data[\"JPG\"][1002]\nimage_SC_Four = Main_Train_Data[\"JPG\"][2858]\nimage_SC_Five = Main_Train_Data[\"JPG\"][6222]\nimage_SC_Six = Main_Train_Data[\"JPG\"][8858]\n\n\nimage_SC_One = cv2.imread(image_SC_One)\nimage_SC_Two = cv2.imread(image_SC_Two)\nimage_SC_Three = cv2.imread(image_SC_Three)\nimage_SC_Four = cv2.imread(image_SC_Four)\nimage_SC_Five = cv2.imread(image_SC_Five)\nimage_SC_Six = cv2.imread(image_SC_Six)\n\nimage_SC_One = cv2.Canny(image_SC_One,1,20)\nimage_SC_Two = cv2.Canny(image_SC_Two,1,20)\nimage_SC_Three = cv2.Canny(image_SC_Three,1,20)\nimage_SC_Four = cv2.Canny(image_SC_Four,1,20)\nimage_SC_Five = cv2.Canny(image_SC_Five,1,20)\nimage_SC_Six = cv2.Canny(image_SC_Six,1,20)\n\nBack_CMask_One = Back_Subt.apply(image_SC_One)\nBack_CMask_Two = Back_Subt.apply(image_SC_Two)\nBack_CMask_Three = Back_Subt.apply(image_SC_Three)\nBack_CMask_Four = Back_Subt.apply(image_SC_Four)\nBack_CMask_Five = Back_Subt.apply(image_SC_Five)\nBack_CMask_Six = Back_Subt.apply(image_SC_Six)\n\nC_Subt_List = [Back_CMask_One,Back_CMask_Two,Back_CMask_Three,\n            Back_CMask_Four,Back_CMask_Five,Back_CMask_Six]\n\nfig_STh,axes_SC = plt.subplots(nrows=3,\n                             ncols=2,\n                             figsize=(15,15))\n\naxes_SC[0,0].imshow(C_Subt_List[0])\naxes_SC[0,1].imshow(C_Subt_List[1])\naxes_SC[1,0].imshow(C_Subt_List[2])\naxes_SC[1,1].imshow(C_Subt_List[3])\naxes_SC[2,0].imshow(C_Subt_List[4])\naxes_SC[2,1].imshow(C_Subt_List[5])","cc757de8":"image_MOne = Main_Train_Data[\"JPG\"][22]\nimage_MTwo = Main_Train_Data[\"JPG\"][152]\nimage_MThree = Main_Train_Data[\"JPG\"][1002]\nimage_MFour = Main_Train_Data[\"JPG\"][2858]\nimage_MFive = Main_Train_Data[\"JPG\"][6222]\nimage_MSix = Main_Train_Data[\"JPG\"][8858]\n\n\nimage_MOne = cv2.imread(image_MOne)\nimage_MTwo = cv2.imread(image_MTwo)\nimage_MThree = cv2.imread(image_MThree)\nimage_MFour = cv2.imread(image_MFour)\nimage_MFive = cv2.imread(image_MFive)\nimage_MSix = cv2.imread(image_MSix)\n\nBack_m_One = Back_Subt.apply(image_MOne)\nBack_m_Two = Back_Subt.apply(image_MTwo)\nBack_m_Three = Back_Subt.apply(image_MThree)\nBack_m_Four = Back_Subt.apply(image_MFour)\nBack_m_Five = Back_Subt.apply(image_MFive)\nBack_m_Six = Back_Subt.apply(image_MSix)\n\nM_Subt_List = [Back_m_One,Back_m_Two,Back_m_Three,\n            Back_m_Four,Back_m_Five,Back_m_Six]\n\nfig_m,axes_m = plt.subplots(nrows=3,\n                             ncols=2,\n                             figsize=(15,15))\n\naxes_m[0,0].imshow(M_Subt_List[0])\naxes_m[0,1].imshow(M_Subt_List[1])\naxes_m[1,0].imshow(M_Subt_List[2])\naxes_m[1,1].imshow(M_Subt_List[3])\naxes_m[2,0].imshow(M_Subt_List[4])\naxes_m[2,1].imshow(M_Subt_List[5])","cfb13c29":"image_TC_One = Main_Train_Data[\"JPG\"][22]\nimage_TC_Two = Main_Train_Data[\"JPG\"][152]\nimage_TC_Three = Main_Train_Data[\"JPG\"][1002]\nimage_TC_Four = Main_Train_Data[\"JPG\"][2858]\nimage_TC_Five = Main_Train_Data[\"JPG\"][6222]\nimage_TC_Six = Main_Train_Data[\"JPG\"][8858]\n\nimage_TC_One = cv2.imread(image_TC_One)\nimage_TC_Two = cv2.imread(image_TC_Two)\nimage_TC_Three = cv2.imread(image_TC_Three)\nimage_TC_Four = cv2.imread(image_TC_Four)\nimage_TC_Five = cv2.imread(image_TC_Five)\nimage_TC_Six = cv2.imread(image_TC_Six)\n\nig,thresh_TCOne = cv2.threshold(image_TC_One,100,255,cv2.THRESH_BINARY_INV)\nig,thresh_TCTwo = cv2.threshold(image_TC_Two,100,255,cv2.THRESH_BINARY_INV)\nig,thresh_TCThree = cv2.threshold(image_TC_Three,100,255,cv2.THRESH_BINARY_INV)\nig,thresh_TCFour = cv2.threshold(image_TC_Four,100,255,cv2.THRESH_BINARY_INV)\nig,thresh_TCFive = cv2.threshold(image_TC_Five,100,255,cv2.THRESH_BINARY_INV)\nig,thresh_TCSix = cv2.threshold(image_TC_Six,100,255,cv2.THRESH_BINARY_INV)\n\nCanny_T_One = cv2.Canny(thresh_TCOne,1,200)\nCanny_T_Two = cv2.Canny(thresh_TCTwo,1,200)\nCanny_T_Three = cv2.Canny(thresh_TCThree,1,200)\nCanny_T_Four = cv2.Canny(thresh_TCFour,1,200)\nCanny_T_Five = cv2.Canny(thresh_TCFive,1,200)\nCanny_T_Six = cv2.Canny(thresh_TCSix,1,200)\n\nBack_TC_One = Back_Subt.apply(Canny_T_One)\nBack_TC_Two = Back_Subt.apply(Canny_T_Two)\nBack_TC_Three = Back_Subt.apply(Canny_T_Three)\nBack_TC_Four = Back_Subt.apply(Canny_T_Four)\nBack_TC_Five = Back_Subt.apply(Canny_T_Five)\nBack_TC_Six = Back_Subt.apply(Canny_T_Six)\n\nTC_Subt_List = [Back_TC_One,Back_TC_Two,Back_TC_Three,\n            Back_TC_Four,Back_TC_Five,Back_TC_Six]\n\nfig_tc,axes_tc = plt.subplots(nrows=3,\n                             ncols=2,\n                             figsize=(15,15))\n\naxes_tc[0,0].imshow(TC_Subt_List[0])\naxes_tc[0,1].imshow(TC_Subt_List[1])\naxes_tc[1,0].imshow(TC_Subt_List[2])\naxes_tc[1,1].imshow(TC_Subt_List[3])\naxes_tc[2,0].imshow(TC_Subt_List[4])\naxes_tc[2,1].imshow(TC_Subt_List[5])","b3ea468b":"image_TC_One = Main_Train_Data[\"JPG\"][22]\nimage_TC_Two = Main_Train_Data[\"JPG\"][152]\nimage_TC_Three = Main_Train_Data[\"JPG\"][1002]\nimage_TC_Four = Main_Train_Data[\"JPG\"][2858]\nimage_TC_Five = Main_Train_Data[\"JPG\"][6222]\nimage_TC_Six = Main_Train_Data[\"JPG\"][8858]\n\nimage_TC_One = cv2.imread(image_TC_One)\nimage_TC_Two = cv2.imread(image_TC_Two)\nimage_TC_Three = cv2.imread(image_TC_Three)\nimage_TC_Four = cv2.imread(image_TC_Four)\nimage_TC_Five = cv2.imread(image_TC_Five)\nimage_TC_Six = cv2.imread(image_TC_Six)\n\nimage_GRAY_One = cv2.cvtColor(image_TC_One,cv2.COLOR_RGB2GRAY)\nimage_GRAY_Two = cv2.cvtColor(image_TC_Two,cv2.COLOR_RGB2GRAY)\nimage_GRAY_Three = cv2.cvtColor(image_TC_Three,cv2.COLOR_RGB2GRAY)\nimage_GRAY_Four = cv2.cvtColor(image_TC_Four,cv2.COLOR_RGB2GRAY)\nimage_GRAY_Five = cv2.cvtColor(image_TC_Five,cv2.COLOR_RGB2GRAY)\nimage_GRAY_Six = cv2.cvtColor(image_TC_Six,cv2.COLOR_RGB2GRAY)\n\nig,thresh_TTCOne = cv2.threshold(image_GRAY_One,150,255,cv2.THRESH_BINARY)\nig,thresh_TTCTwo = cv2.threshold(image_GRAY_Two,150,255,cv2.THRESH_BINARY)\nig,thresh_TTCThree = cv2.threshold(image_GRAY_Three,150,255,cv2.THRESH_BINARY)\nig,thresh_TTCFour = cv2.threshold(image_GRAY_Four,150,255,cv2.THRESH_BINARY)\nig,thresh_TTCFive = cv2.threshold(image_GRAY_Five,150,255,cv2.THRESH_BINARY)\nig,thresh_TTCSix = cv2.threshold(image_GRAY_Six,150,255,cv2.THRESH_BINARY)\n\n\nTTC_Subt_ = [thresh_TTCOne,thresh_TTCTwo,thresh_TTCThree,thresh_TTCFour,thresh_TTCFive,thresh_TTCSix]\n\nfig_tc,axes_Ttc = plt.subplots(nrows=3,\n                             ncols=2,\n                             figsize=(15,15))\n\naxes_Ttc[0,0].imshow(TTC_Subt_[0])\naxes_Ttc[0,1].imshow(TTC_Subt_[1])\naxes_Ttc[1,0].imshow(TTC_Subt_[2])\naxes_Ttc[1,1].imshow(TTC_Subt_[3])\naxes_Ttc[2,0].imshow(TTC_Subt_[4])\naxes_Ttc[2,1].imshow(TTC_Subt_[5])","951def10":"image_R_One = Main_Train_Data[\"JPG\"][22]\nimage_R_Two = Main_Train_Data[\"JPG\"][152]\nimage_R_Three = Main_Train_Data[\"JPG\"][1002]\nimage_R_Four = Main_Train_Data[\"JPG\"][2858]\nimage_R_Five = Main_Train_Data[\"JPG\"][6222]\nimage_R_Six = Main_Train_Data[\"JPG\"][8858]\n\nimage_R_One = cv2.imread(image_R_One)\nimage_R_Two = cv2.imread(image_R_Two)\nimage_R_Three = cv2.imread(image_R_Three)\nimage_R_Four = cv2.imread(image_R_Four)\nimage_R_Five = cv2.imread(image_R_Five)\nimage_R_Six = cv2.imread(image_R_Six)\n\nimage_rGRAY_One = cv2.cvtColor(image_R_One,cv2.COLOR_RGB2GRAY)\nimage_rGRAY_Two = cv2.cvtColor(image_R_Two,cv2.COLOR_RGB2GRAY)\nimage_rGRAY_Three = cv2.cvtColor(image_R_Three,cv2.COLOR_RGB2GRAY)\nimage_rGRAY_Four = cv2.cvtColor(image_R_Four,cv2.COLOR_RGB2GRAY)\nimage_rGRAY_Five = cv2.cvtColor(image_R_Five,cv2.COLOR_RGB2GRAY)\nimage_rGRAY_Six = cv2.cvtColor(image_R_Six,cv2.COLOR_RGB2GRAY)\n\nig,thresh_rTTCOne = cv2.threshold(image_rGRAY_One,150,255,cv2.THRESH_BINARY)\nig,thresh_rTTCTwo = cv2.threshold(image_rGRAY_Two,150,255,cv2.THRESH_BINARY)\nig,thresh_rTTCThree = cv2.threshold(image_rGRAY_Three,150,255,cv2.THRESH_BINARY)\nig,thresh_rTTCFour = cv2.threshold(image_rGRAY_Four,150,255,cv2.THRESH_BINARY)\nig,thresh_rTTCFive = cv2.threshold(image_rGRAY_Five,150,255,cv2.THRESH_BINARY)\nig,thresh_rTTCSix = cv2.threshold(image_rGRAY_Six,150,255,cv2.THRESH_BINARY)\n\nimage_size = (200,200)\nr_Thr_Image_One = cv2.resize(thresh_rTTCOne,image_size,interpolation=cv2.INTER_NEAREST)\nr_Thr_Image_Two = cv2.resize(thresh_rTTCTwo,image_size,interpolation=cv2.INTER_NEAREST)\nr_Thr_Image_Three = cv2.resize(thresh_rTTCThree,image_size,interpolation=cv2.INTER_NEAREST)\nr_Thr_Image_Four = cv2.resize(thresh_rTTCFour,image_size,interpolation=cv2.INTER_NEAREST)\nr_Thr_Image_Five = cv2.resize(thresh_rTTCFive,image_size,interpolation=cv2.INTER_NEAREST)\nr_Thr_Image_Six = cv2.resize(thresh_rTTCSix,image_size,interpolation=cv2.INTER_NEAREST)\n\nResize_Subt_ = [r_Thr_Image_One,r_Thr_Image_Two,r_Thr_Image_Three,r_Thr_Image_Four,r_Thr_Image_Five,r_Thr_Image_Six]\n\nR_fig_tc,R_axes_Ttc = plt.subplots(nrows=3,\n                             ncols=2,\n                             figsize=(15,15))\n\nR_axes_Ttc[0,0].imshow(Resize_Subt_[0])\nR_axes_Ttc[0,1].imshow(Resize_Subt_[1])\nR_axes_Ttc[1,0].imshow(Resize_Subt_[2])\nR_axes_Ttc[1,1].imshow(Resize_Subt_[3])\nR_axes_Ttc[2,0].imshow(Resize_Subt_[4])\nR_axes_Ttc[2,1].imshow(Resize_Subt_[5])","09f049e5":"BackSubtractor = cv2.createBackgroundSubtractorMOG2(history=10, varThreshold=500)\n\n\nimage_RC_One = Main_Train_Data[\"JPG\"][22]\nimage_RC_Two = Main_Train_Data[\"JPG\"][152]\nimage_RC_Three = Main_Train_Data[\"JPG\"][1002]\nimage_RC_Four = Main_Train_Data[\"JPG\"][2858]\nimage_RC_Five = Main_Train_Data[\"JPG\"][6222]\nimage_RC_Six = Main_Train_Data[\"JPG\"][8858]\n\nimage_RC_One = cv2.imread(image_RC_One)\nimage_RC_Two = cv2.imread(image_RC_Two)\nimage_RC_Three = cv2.imread(image_RC_Three)\nimage_RC_Four = cv2.imread(image_RC_Four)\nimage_RC_Five = cv2.imread(image_RC_Five)\nimage_RC_Six = cv2.imread(image_RC_Six)\n\nimage_CrGRAY_One = cv2.cvtColor(image_RC_One,cv2.COLOR_RGB2GRAY)\nimage_CrGRAY_Two = cv2.cvtColor(image_RC_Two,cv2.COLOR_RGB2GRAY)\nimage_CrGRAY_Three = cv2.cvtColor(image_RC_Three,cv2.COLOR_RGB2GRAY)\nimage_CrGRAY_Four = cv2.cvtColor(image_RC_Four,cv2.COLOR_RGB2GRAY)\nimage_CrGRAY_Five = cv2.cvtColor(image_RC_Five,cv2.COLOR_RGB2GRAY)\nimage_CrGRAY_Six = cv2.cvtColor(image_RC_Six,cv2.COLOR_RGB2GRAY)\n\nig,thresh_CrTTCOne = cv2.threshold(image_CrGRAY_One,150,255,cv2.THRESH_BINARY)\nig,thresh_CrTTCTwo = cv2.threshold(image_CrGRAY_Two,150,255,cv2.THRESH_BINARY)\nig,thresh_CrTTCThree = cv2.threshold(image_CrGRAY_Three,150,255,cv2.THRESH_BINARY)\nig,thresh_CrTTCFour = cv2.threshold(image_CrGRAY_Four,150,255,cv2.THRESH_BINARY)\nig,thresh_CrTTCFive = cv2.threshold(image_CrGRAY_Five,150,255,cv2.THRESH_BINARY)\nig,thresh_CrTTCSix = cv2.threshold(image_CrGRAY_Six,150,255,cv2.THRESH_BINARY)\n\nimage_size = (200,200)\nr_Thr_CImage_One = cv2.resize(thresh_CrTTCOne,image_size,interpolation=cv2.INTER_NEAREST)\nr_Thr_CImage_Two = cv2.resize(thresh_CrTTCTwo,image_size,interpolation=cv2.INTER_NEAREST)\nr_Thr_CImage_Three = cv2.resize(thresh_CrTTCThree,image_size,interpolation=cv2.INTER_NEAREST)\nr_Thr_CImage_Four = cv2.resize(thresh_CrTTCFour,image_size,interpolation=cv2.INTER_NEAREST)\nr_Thr_CImage_Five = cv2.resize(thresh_CrTTCFive,image_size,interpolation=cv2.INTER_NEAREST)\nr_Thr_CImage_Six = cv2.resize(thresh_CrTTCSix,image_size,interpolation=cv2.INTER_NEAREST)\n\n\nCI_Size_ONE = r_Thr_CImage_One[50:170,50:170]\nmask_One = BackSubtractor.apply(CI_Size_ONE)\nmask_One = cv2.Canny(mask_One,80,255)\ncont_One,ig = cv2.findContours(mask_One,cv2.RETR_EXTERNAL,cv2.CHAIN_APPROX_NONE)\ndraw_One = cv2.drawContours(CI_Size_ONE,cont_One,-1,(255,0,255),1)\n\nCI_Size_TWO = r_Thr_CImage_Two[50:170,50:170]\nmask_Two = BackSubtractor.apply(CI_Size_TWO)\nmask_Two = cv2.Canny(mask_Two,80,255)\ncont_Two,ig = cv2.findContours(mask_Two,cv2.RETR_EXTERNAL,cv2.CHAIN_APPROX_NONE)\ndraw_Two = cv2.drawContours(CI_Size_TWO,cont_Two,-1,(255,0,255),1)\n\nCI_Size_THREE = r_Thr_CImage_Three[50:170,50:170]\nmask_Three = BackSubtractor.apply(CI_Size_THREE)\nmask_Three = cv2.Canny(mask_Three,80,255)\ncont_Three,ig = cv2.findContours(mask_Three,cv2.RETR_EXTERNAL,cv2.CHAIN_APPROX_NONE)\ndraw_Three = cv2.drawContours(CI_Size_THREE,cont_Three,-1,(255,0,255),1)\n\nCI_Size_FOUR = r_Thr_CImage_Four[50:170,50:170]\nmask_Four = BackSubtractor.apply(CI_Size_FOUR)\nmask_Four = cv2.Canny(mask_Four,80,255)\ncont_Four,ig = cv2.findContours(mask_Four,cv2.RETR_EXTERNAL,cv2.CHAIN_APPROX_NONE)\ndraw_Four = cv2.drawContours(CI_Size_FOUR,cont_Four,-1,(255,0,255),1)\n\nCI_Size_FIVE = r_Thr_CImage_Five[50:170,50:170]\nmask_Five = BackSubtractor.apply(CI_Size_FIVE)\nmask_Five = cv2.Canny(mask_Five,80,255)\ncont_Five,ig = cv2.findContours(mask_Five,cv2.RETR_EXTERNAL,cv2.CHAIN_APPROX_NONE)\ndraw_Five = cv2.drawContours(CI_Size_FIVE,cont_Five,-1,(255,0,255),1)\n\nCI_Size_SIX = r_Thr_CImage_Six[50:170,50:170]\nmask_Six = BackSubtractor.apply(CI_Size_SIX)\nmask_Six = cv2.Canny(mask_Six,80,255)\ncont_Six,ig = cv2.findContours(mask_Six,cv2.RETR_EXTERNAL,cv2.CHAIN_APPROX_NONE)\ndraw_Six = cv2.drawContours(CI_Size_SIX,cont_Six,-1,(255,0,255),1)\n\n\n\nDraw_Subt_ = [draw_One,draw_Two,draw_Three,draw_Four,draw_Five,draw_Six]\n\nD_fig_tc,D_axes_Ttc = plt.subplots(nrows=3,\n                             ncols=2,\n                             figsize=(15,15))\n\nD_axes_Ttc[0,0].imshow(Draw_Subt_[0])\nD_axes_Ttc[0,1].imshow(Draw_Subt_[1])\nD_axes_Ttc[1,0].imshow(Draw_Subt_[2])\nD_axes_Ttc[1,1].imshow(Draw_Subt_[3])\nD_axes_Ttc[2,0].imshow(Draw_Subt_[4])\nD_axes_Ttc[2,1].imshow(Draw_Subt_[5])","2dc113c1":"image_DDRC_One = Main_Train_Data[\"JPG\"][22]\nimage_DDRC_Two = Main_Train_Data[\"JPG\"][152]\nimage_DDRC_Three = Main_Train_Data[\"JPG\"][1002]\nimage_DDRC_Four = Main_Train_Data[\"JPG\"][2858]\nimage_DDRC_Five = Main_Train_Data[\"JPG\"][6222]\nimage_DDRC_Six = Main_Train_Data[\"JPG\"][8858]\n\nimage_DDRC_One = cv2.imread(image_DDRC_One)\nimage_DDRC_Two = cv2.imread(image_DDRC_Two)\nimage_DDRC_Three = cv2.imread(image_DDRC_Three)\nimage_DDRC_Four = cv2.imread(image_DDRC_Four)\nimage_DDRC_Five = cv2.imread(image_DDRC_Five)\nimage_DDRC_Six = cv2.imread(image_DDRC_Six)\n\nimage_DCrGRAY_One = cv2.cvtColor(image_DDRC_One,cv2.COLOR_RGB2GRAY)\nimage_DCrGRAY_Two = cv2.cvtColor(image_DDRC_Two,cv2.COLOR_RGB2GRAY)\nimage_DCrGRAY_Three = cv2.cvtColor(image_DDRC_Three,cv2.COLOR_RGB2GRAY)\nimage_DCrGRAY_Four = cv2.cvtColor(image_DDRC_Four,cv2.COLOR_RGB2GRAY)\nimage_DCrGRAY_Five = cv2.cvtColor(image_DDRC_Five,cv2.COLOR_RGB2GRAY)\nimage_DCrGRAY_Six = cv2.cvtColor(image_DDRC_Six,cv2.COLOR_RGB2GRAY)\n\nig,thresh_DCrTTCOne = cv2.threshold(image_DCrGRAY_One,150,255,cv2.THRESH_BINARY)\nig,thresh_DCrTTCTwo = cv2.threshold(image_DCrGRAY_Two,150,255,cv2.THRESH_BINARY)\nig,thresh_DCrTTCThree = cv2.threshold(image_DCrGRAY_Three,150,255,cv2.THRESH_BINARY)\nig,thresh_DCrTTCFour = cv2.threshold(image_DCrGRAY_Four,150,255,cv2.THRESH_BINARY)\nig,thresh_DCrTTCFive = cv2.threshold(image_DCrGRAY_Five,150,255,cv2.THRESH_BINARY)\nig,thresh_DCrTTCSix = cv2.threshold(image_DCrGRAY_Six,150,255,cv2.THRESH_BINARY)\n\n\nDiff_One = cv2.absdiff(image_DCrGRAY_One,thresh_DCrTTCOne)\nDiff_Two = cv2.absdiff(image_DCrGRAY_Two,thresh_DCrTTCTwo)\nDiff_Three = cv2.absdiff(image_DCrGRAY_Three,thresh_DCrTTCThree)\nDiff_Four = cv2.absdiff(image_DCrGRAY_Four,thresh_DCrTTCFour)\nDiff_Five = cv2.absdiff(image_DCrGRAY_Five,thresh_DCrTTCFive)\nDiff_Six = cv2.absdiff(image_DCrGRAY_Six,thresh_DCrTTCSix)\n\nDiff_List = [Diff_One,Diff_Two,Diff_Three,Diff_Four,Diff_Five,Diff_Six]\n\nDiff_fig_tc,Diff_axes_Ttc = plt.subplots(nrows=3,\n                             ncols=2,\n                             figsize=(15,15))\n\nDiff_axes_Ttc[0,0].imshow(Diff_List[0])\nDiff_axes_Ttc[0,1].imshow(Diff_List[1])\nDiff_axes_Ttc[1,0].imshow(Diff_List[2])\nDiff_axes_Ttc[1,1].imshow(Diff_List[3])\nDiff_axes_Ttc[2,0].imshow(Diff_List[4])\nDiff_axes_Ttc[2,1].imshow(Diff_List[5])","bb4a2447":"##### DIFFERENCE","68d36d2b":"#### GENERAL","c8c9eb1d":"# DATAFRAME STRUCTURE","c21ba692":"# VISUALIZATION","e11f3286":"##### SUBTRACTOR FOR THRESHOLD","4f6e5a31":"#### EXPORTING PATH","cf39942d":"##### SUBTRACTOR FOR THRESHOLD-CANNY","14f13b73":"#### SHUFFLING","6513e2bd":"##### SUBTRACTOR FOR CANNY","dccb680c":"##### SUBTRACTOR FROM GRAY TO THRESHOLD","9e6255d7":"##### FIND CONTOUR","f53be3da":"# SERIES STRUCTURE","cf0118d2":"# PATH & LABEL PROCESS","b76e91e7":"##### ADAPTIVE THRESHOLD","2bfe915f":"#### IMAGE ENGINEERING","3abb3c64":"#### SPLITTING LABELS","292d1b8d":"##### CANNY","9bf43f38":"##### SUBTRACTOR FOR MAIN","fd87e7f3":"##### BLURRED-CANNY-SHARP","f98e7779":"##### RESIZE","5b027362":"##### THRESHOLD","7ab7d89f":"# PACKAGES AND LIBRARIES"}}