{"cell_type":{"34b0fc2a":"code","e59833de":"code","e5318f8d":"code","2250de5a":"code","eabaceeb":"code","047efa4d":"code","cad629f8":"markdown"},"source":{"34b0fc2a":"import numpy as np\nimport pandas as pd","e59833de":"sub1 = pd.read_csv('..\/input\/classification-densenet201-efficientnetb7\/submission.csv')\nsub2 = pd.read_csv('..\/input\/tf-zoo-models-on-tpu\/submission.csv')\nsub3 = pd.read_csv('..\/input\/fork-of-plant-2020-tpu-915e9c\/submission.csv')\nsub4 = pd.read_csv('..\/input\/plant-pathology-2020-in-pytorch-0-979-score\/submission.csv')\n\n# To to get a higher score you can change weights or add new submissions.\nsubmissions = [sub1, sub2, sub3, sub4]\nsub_weights = [0.35, 0.10, 0.15, 0.40]\n\nprint(sum(sub_weights))","e5318f8d":"sub = pd.read_csv('..\/input\/plant-pathology-2020-fgvc7\/sample_submission.csv')\nsub.iloc[:, 1:] = np.average([df.iloc[:, 1:].values for df in submissions], weights=sub_weights, axis=0)","2250de5a":"# https:\/\/www.kaggle.com\/c\/plant-pathology-2020-fgvc7\/discussion\/149845\n# Try changing alpha, it may lead to a higher score.\ndef LabelSmoothing(encodings , alpha=0.01):\n    K = encodings.shape[1]\n    y_ls = (1 - alpha) * encodings + alpha \/ K\n    return y_ls\n\n\npreds = sub.iloc[:, 1:].values\nLabelSmoothing(preds, alpha=0.01)\nsub.iloc[:, 1:] = preds","eabaceeb":"sub.head()","047efa4d":"sub.to_csv('submission.csv', index=False)","cad629f8":"### Please upvote if you like it.\n### Feel free to leave comments below!"}}