{"cell_type":{"93507031":"code","e418fa56":"code","f5637b09":"markdown"},"source":{"93507031":"import pandas as pd \nimport json\n\n\ndef separate_json(series: pd.Series) -> pd.DataFrame():\n    \"\"\"\n    \n    Args:\n        series: Series before json parsing \n\n    Returns: DataFrame\n\n    \"\"\"\n    # TODO: Write TypeException\n    \n    if isinstance(series[0], str):\n        return pd.DataFrame(json.loads(s) for s in series)\n    return pd.DataFrame(s for s in series)\n\ndf = pd.read_csv('..\/input\/train.csv', engine='python')\njson_col = ['device', 'geoNetwork', 'totals', 'trafficSource']\nnest_json_col = ['adwordsClickInfo']\n\ndf = df.join(separate_json(df[col_name]) for col_name in json_col).drop(json_col, axis=1)\ndf = df.join(separate_json(df[nest_json_col[0]])).drop(nest_json_col, axis=1)\ndf.head()","e418fa56":"df.columns","f5637b09":"After above preprocessing, we can enjoy to analyze!!"}}