{"cell_type":{"0225036e":"code","6448bce4":"code","ab23879c":"code","8f6fc2b2":"code","964b2495":"code","39adf41f":"code","052e2238":"code","d2afc19f":"code","6b2b1c57":"code","2cf5e4fd":"code","bea77b90":"code","4bde18e9":"code","7a7cba37":"code","2ce2676d":"code","f621dd6c":"markdown"},"source":{"0225036e":"import glob\nimport pandas as pd","6448bce4":"FILES = glob.glob('..\/input\/*\/prediction_*.csv', recursive=True)\nFILES = [\n    #'..\/input\/effcientnetb6-384x384-fold-1-3\/prediction_fold_3.csv', ##LB 0.9387\n    '..\/input\/mysample\/tabular_6928.csv', ##LB 0.6928\n    #'..\/input\/random-forest-melanoma\/submission_random_forest.csv'\n    #'..\/input\/catboost\/cat_baseline_sub.csv', ## LB 0.81\n    '..\/input\/sub-blend\/submission_945_15_folds.csv',\n    '..\/input\/sub-blend\/submission_945_5_folds.csv',\n    '..\/input\/melanoma-sub-single-9516\/submission_comb(1).csv',\n    #'..\/input\/sub-chris\/submission.csv',\n    #'..\/input\/sub-blend\/submission_939.csv',\n    '..\/input\/train-cv-melanoma\/submission.csv',\n    '..\/input\/enet-cv-9430\/submission.csv',\n    '..\/input\/mel-9488\/submission.csv',\n    '..\/input\/mel-b6-9453\/submission.csv'\n]","ab23879c":"sub = pd.read_csv(\"..\/input\/siim-isic-melanoma-classification\/sample_submission.csv\")\ndel sub['target']\n\nw = [0.05, 0.1, 0.1, 0.1, 0.15, 0.15, 0.15, 0.2]\n\n\n# w = [0.15, 0.25, 0.2, 0.2, 0.2] ## 9597\n\n\n##w = [0.85, 0.15]\n\n#w = [0.1, 0.1, 0.1, 0.2, 0.2, 0.2, 0.1]\n\n#w = [0.0, 0.0, 0.0, 0.25, 0.25, 0.25, 0.25] ## 0.955\n\n#w = [0.0, 0.1, 0.1, 0.2, 0.2, 0.2, 0.2]\n\n\n# w = [0.0, 0.15, 0.2, 0.25, 0.2, 0.2]\n\n","8f6fc2b2":"for counter, f in enumerate(FILES):\n    print(counter)\n    print(f)","964b2495":"df = pd.read_csv(f)","39adf41f":"df.head()","052e2238":"df.columns = ['image_name', str(counter)]\n\ndf[str(counter)] *= w[counter]\n\ndf.head()","d2afc19f":"for counter, f in enumerate(FILES):\n    df = pd.read_csv(f)\n    df.columns = ['image_name', str(counter)]\n    df[str(counter)] *= w[counter]\n    sub = sub.merge(df, on=\"image_name\")","6b2b1c57":"image_name = sub.image_name\n\nsub = sub.drop(columns = [\"image_name\"])\ntarget = sub.sum(axis = 1)","2cf5e4fd":"# for i in range(len(target)):\n#     if target[i] < 0.02:\n#         target[i] = 0.0\n#     elif target[i] > 0.9:\n#         target[i] = 1.0","bea77b90":"target","4bde18e9":"pd.DataFrame({\n    'image_name' : image_name,\n    'target' : target\n}).to_csv('submission_b.csv', index=False)","7a7cba37":"df = pd.read_csv(\"submission_b.csv\")\nimport matplotlib.pyplot as plt\nf, ax = plt.subplots(figsize=(18,6))\nax.hist(df['target'], bins=100)\nax.grid(axis='y', color='0.95')\nplt.show()","2ce2676d":"df","f621dd6c":"## Weighted Average [image + tabular]"}}