{"cell_type":{"8bf46916":"code","299462fe":"code","6c637656":"code","a23d4c40":"code","2fbaf4fc":"code","06ee6cea":"code","794753c7":"code","30598281":"code","2e26aaa1":"markdown","a979ec9b":"markdown","0e26a34f":"markdown","1540ea75":"markdown","4f911e13":"markdown","f39dd03e":"markdown"},"source":{"8bf46916":"from IPython.display import Image\nImage('..\/input\/self-driving-cars\/images\/1478020200190518278.jpg')","299462fe":"import numpy as np\nimport pandas as pd\nimport cv2\n\nfrom sklearn.utils import shuffle\nfrom matplotlib.patches import Rectangle\nimport matplotlib.pyplot as plt","6c637656":"df = pd.read_csv('..\/input\/self-driving-cars\/labels_train.csv')\ndf = shuffle(df)\ndf.head()","a23d4c40":"classes = df.class_id.unique()\nprint(classes)","2fbaf4fc":"labels = { 1:'car', 2:'truck', 3:'pedestrian', 4:'bicyclist', 5:'light'}","06ee6cea":"# Get path images and boxes (x,y) for each class_id\nboxes = {}\nimages = {}\n\nbase_path = '..\/input\/self-driving-cars\/images\/'\n\nfor class_id in classes:\n    first_row = df[df['class_id'] == class_id].iloc[0]\n    \n    images[class_id] = cv2.imread(base_path + first_row['frame'])\n    boxes[class_id] = [first_row['xmin'],first_row['xmax'],first_row['ymin'],first_row['ymax']]","794753c7":"boxes","30598281":"for i in classes:\n\n    xmin, xmax, ymin, ymax = boxes[i][0], boxes[i][1], boxes[i][2], boxes[i][3]\n\n    plt.figure(figsize=(10, 10))\n    plt.title(\"Label \" + labels[i])\n    plt.imshow(images[i])\n    plt.gca().add_patch(plt.Rectangle((xmin, ymin), xmax-xmin, ymax-ymin, color='green', fill=False, linewidth=2))\n    \n    plt.show()","2e26aaa1":"## Goal\n\nGoal of this notebook is to show the relation between class_id and the labels.<br>\nI also demonstrate how to use the matplotlib Rectangle in order to underline the object detection.","a979ec9b":"# Map Classes to Labels","0e26a34f":"# Self-Driving Categories EDA","1540ea75":"# Draw the boxes for each image - 5 classes, 5 images","4f911e13":"# Map images to the boxes, 1 image per class","f39dd03e":"# Boxes for each class\/image"}}