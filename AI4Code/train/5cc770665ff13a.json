{"cell_type":{"968e3d6e":"code","64f5b058":"code","0c790256":"code","25d1318b":"code","9298d8b2":"code","5251ac2e":"code","5667aed9":"code","a3209718":"code","09fb4621":"code","a951bdd3":"code","0ee1b2d1":"code","970a9644":"code","b6aef280":"code","a503d591":"code","c7109b33":"code","cdcb4d35":"code","f42d24c6":"code","8892c7a7":"markdown","00922863":"markdown","2c57d624":"markdown","d0440cc0":"markdown","a36b42cb":"markdown","f9bec631":"markdown","8a802496":"markdown","df66348e":"markdown","524a47a5":"markdown","d226e2f5":"markdown","c47e2ef9":"markdown","6062f1e9":"markdown"},"source":{"968e3d6e":"#import all libraries\n!pip install plotly &> \/dev\/null\nimport plotly\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport plotly.express  as px\nimport plotly.graph_objs as go\nimport plotly.offline as offline\nfrom plotly.graph_objs import *\nfrom plotly.offline import download_plotlyjs, init_notebook_mode, plot, iplot\n","64f5b058":"#bring in data\nreport21 = pd.read_csv('..\/input\/world-happiness-report-2021\/world-happiness-report-2021.csv')\nreport = pd.read_csv('..\/input\/world-happiness-report-2021\/world-happiness-report.csv')\ndf_report = pd.DataFrame(report)\ndf_report21 = pd.DataFrame(report21)","0c790256":"#modifying column names of 2021 to fit the other report\ndf_report21 = df_report21.rename(columns={'Country name': 'Country name',\n                                         'Ladder score': 'Life Ladder',\n                                         'Logged GDP per capita':'Log GDP per capita' ,\n                                         'Healthy life expectancy':'Healthy life expectancy at birth'})\nplotly.__version__","25d1318b":"#Ading all rows with 2020 to a new column\npandemic_filter = df_report['year']== 2020\ndf_pandemic = df_report[pandemic_filter]\ndf_pandemic = pd.concat([df_pandemic, df_report21], ignore_index=True)\ndf_report = df_report[~pandemic_filter]\n\n#Adding 2021 to the years\ndf_pandemic['year']=df_pandemic['year'].replace(np.nan, 2021)\n\n#Putting rows in order\ndf_pandemic = df_pandemic.sort_values(by = ['Country name', 'year'])\ndf_pandemic = df_pandemic.reset_index()\ndf_pandemic = df_pandemic.drop(columns=['index'])\n\n#Add  Regional indicator to all rows\nfor index, row in df_pandemic.iterrows():\n  if df_pandemic.iloc[index]['year'] == 2021 and df_pandemic.iloc[index]['Country name'] == df_pandemic.iloc[index-1]['Country name']:\n    df_pandemic.loc[index-1, 'Regional indicator'] = df_pandemic.iloc[index]['Regional indicator']\n\ndf_pandemic = df_pandemic.drop(columns=['Standard error of ladder score',\n                              'upperwhisker',\n                              'lowerwhisker',\n                              'Ladder score in Dystopia',\n                              'Explained by: Log GDP per capita',\n                              'Explained by: Social support',\n                              'Explained by: Freedom to make life choices', \n                              'Explained by: Generosity',\n                              'Explained by: Perceptions of corruption',\n                              'Explained by: Healthy life expectancy',\n                              'Dystopia + residual'])","9298d8b2":"#Combing both table for situations wherer visualizing all the data is needed\ndf_all_reports = pd.concat([df_pandemic, df_report])\n#Putting rows in order\ndf_all_reports = df_all_reports.sort_values(by = ['Country name', 'year'])\ndf_all_reports = df_all_reports.reset_index()\ndf_all_reports = df_all_reports.drop(columns=['index'])","5251ac2e":"df_all_reports.describe()","5667aed9":"scl = [[0.0, '#782102'],[0.2, '#ff5517'],[0.4, '#ffddd1'], [0.6, '#00e64d'],[0.8, '#009933'],[1.0, '#003311']] # greens","a3209718":"years = df_all_reports['year'].unique()\ncountry_name = df_all_reports.loc[:, 'Country name'].unique()\ngenerosity_number = df_all_reports.loc[:, 'Generosity'].values\ndata_slider = []\ndata_one_year =[]\nyear1 = list(range(2005,2022))\nfor year in year1:\n    df_gen_dic = df_all_reports[(df_all_reports['year']== year )]\n\n    for col in df_all_reports.columns:  # I transform the columns into string type so I can:\n        df_gen_dic[col] = df_gen_dic[col].astype(str)\n\n    df_gen_dic['text'] = ''\n    #Dictionary with the data for the current year\n    data_one_year = dict(\n                        type='choropleth',\n                        locations = df_gen_dic['Country name'],\n                        z=df_gen_dic['Generosity'].astype(float),\n                        locationmode='country names',\n                        colorscale = scl,\n                        name='Generosity',)\n\n    data_slider.append(data_one_year) # I add the dictionary to the list of dictionaries for the slider","09fb4621":"steps = []\n\nfor i in range(len(data_slider)):\n    step = dict(method='restyle',\n                args=['visible', [False] * len(data_slider)],\n                label='Year {}'.format(i + 2005)) # label to be displayed for each step (year)\n    step['args'][1][i] = True\n    steps.append(step)\n\n#Sliders' object from the 'steps' \nsliders = [dict(active=0, pad={\"t\": 1}, steps=steps)]  ","a951bdd3":"# I set up the layout (including slider option)\n\nlayout = dict(geo=dict(scope='world',\n                        showocean=True,oceancolor ='#8c8c8c',\n                        showcoastlines=True, coastlinecolor=\"#404040\",\n                        showland=True, landcolor=\"#bfbfbf\",\n                        showlakes=True, lakecolor=\"#cccccc\",\n                        projection={'type': 'natural earth'}, ),\n              sliders=sliders)\n\nfig = dict(data=data_slider, layout=layout,  ) \nplotly.offline.iplot(fig)\n# The code for the map is based off: https:\/\/amaral.northwestern.edu\/blog\/step-step-how-plot-map-slider-represent-time-evolu","0ee1b2d1":"df_above_mean= df_all_reports[ df_all_reports['Log GDP per capita'] >= 9.373]\ndf_below_mean= df_all_reports[ df_all_reports['Log GDP per capita'] < 9.373]","970a9644":"figbox= go.Figure()\nfigbox.add_trace(go.Box(x= df_all_reports['year'], \n                    y = df_above_mean['Generosity'],\n                    name='Above Mean',\n                   marker_color='#248f24'))\n\nfigbox.add_trace(go.Box(x= df_all_reports['year'], \n                    y = df_below_mean['Generosity'],\n                    name='Below Mean',\n                    marker_color='#ff5517'))\n\nfigbox.update_xaxes(title_text = \"Year\",)\nfigbox.update_yaxes(showgrid=True, \n                        gridwidth=1, \n                        gridcolor='#f2f2f2', \n                        title_text = \"Generosity\",)\n\n\nfigbox.update_layout(\n    title = 'Generosity of wealtheir and less wealthy countries.', boxmode='group',\n    yaxis=dict(showgrid=True,zeroline=True, ),\n    margin=dict(l=40, r=30, b=80, t=100,),\n    plot_bgcolor='#e6e6e6',)\n\nfigbox.show()","b6aef280":"finland = df_all_reports.loc[(df_all_reports['Country name']=='Finland'), :]\ndenmark = df_all_reports.loc[(df_all_reports['Country name']=='Denmark'), :]\nswitzerland = df_all_reports.loc[(df_all_reports['Country name']=='Switzerland'), :]\nafghanistan = df_all_reports.loc[(df_all_reports['Country name']=='Afghanistan'), :]\nrwanda = df_all_reports.loc[(df_all_reports['Country name']=='Rwanda'), :]\nzimbabwe = df_all_reports.loc[(df_all_reports['Country name']=='Zimbabwe'), :]","a503d591":"# Plot \nfig = px.line( title= 'Generosity of diffrent countries over time.', )\n\n#fig.update_layout(yaxis=dict(range=[-0.2,0.35]), xaxis=dict(range=[2005,2021]), plot_bgcolor= '#e6e6e6')\nfig.update_xaxes(showgrid=True, gridwidth=1, gridcolor='#f2f2f2', title_text = \"Year\",)\nfig.update_yaxes(showgrid=True, gridwidth=1, gridcolor='#f2f2f2', title_text = \"Generosity\",)\n\n# Adding countries to graph\nfig.add_scatter(x=finland['year'], y=finland['Generosity'], mode='lines', line_color = '#00ff00', showlegend=True, name = 'Finland')\nfig.add_scatter(x=denmark['year'], y=denmark['Generosity'], mode='lines', line_color = '#248f24', showlegend=True, name = 'Denmark')\nfig.add_scatter(x=switzerland['year'], y=switzerland['Generosity'], mode='lines', line_color = '#00ffa6', showlegend=True, name = 'Switzerland')\n\nfig.add_scatter(x=afghanistan['year'], y=afghanistan['Generosity'], mode='lines', line_color = '#ff5517', showlegend=True, name = 'Afghanistan')\nfig.add_scatter(x=rwanda['year'], y=rwanda['Generosity'], mode='lines', line_color = '#0080ff', showlegend=True, name = 'Rwanda')\nfig.add_scatter(x=zimbabwe['year'], y=zimbabwe['Generosity'], mode='lines', line_color = '#3300cc', showlegend=True, name = 'Zimbabwe')\n\nfig.show()","c7109b33":"figscatter = px.scatter(df_all_reports,\n                        x = 'year', \n                        y = 'Social support', \n                        color = 'Log GDP per capita', \n                        color_continuous_scale=scl,\n                        hover_name='Country name',\n                        title= 'Social support of diffrent countries over time.')\n\ndf_mean_social = []\nfor y in year1:\n  df_year_mean= df_all_reports[(df_all_reports['year']== y)]\n  year_mean  = round(df_year_mean['Social support'].mean(), 3)\n  df_mean_social.append(year_mean)\n\nfigscatter.add_trace(\n    go.Scatter(\n        x= year1,\n        y=df_mean_social,\n        name = 'Mean of Social support per year',\n        line_color = '#ff5517'\n    ))\nfigscatter.update_layout(plot_bgcolor= '#bfbfbf',legend=dict(yanchor=\"bottom\",xanchor=\"right\",))\nfigscatter.update_xaxes(title_text = \"Year\")\nfigscatter.update_yaxes( title_text = \"Social support\",)\nfigscatter.show()","cdcb4d35":"# Plot \nfig = px.line( title= 'Social support of diffrent countries over time.', )\n\nfig.update_layout( xaxis=dict(range=[2005,2021]), plot_bgcolor= '#e6e6e6')\nfig.update_xaxes(showgrid=True, gridwidth=1, gridcolor='#f2f2f2', title_text = \"Year\",)\nfig.update_yaxes(showgrid=True, gridwidth=1, gridcolor='#f2f2f2', title_text = \"Social support\",)\n\n# Adding countries to graph\nfig.add_scatter(x=finland['year'], y=finland['Social support'], mode='lines', line_color = '#00ff00', showlegend=True, name = 'Finland')\nfig.add_scatter(x=denmark['year'], y=denmark['Social support'], mode='lines', line_color = '#248f24', showlegend=True, name = 'Denmark')\nfig.add_scatter(x=switzerland['year'], y=switzerland['Social support'], mode='lines', line_color = '#00ffa6', showlegend=True, name = 'Switzerland')\n\nfig.add_scatter(x=afghanistan['year'], y=afghanistan['Social support'], mode='lines', line_color = '#ff5517', showlegend=True, name = 'Afghanistan')\nfig.add_scatter(x=rwanda['year'], y=rwanda['Social support'], mode='lines', line_color = '#0080ff', showlegend=True, name = 'Rwanda')\nfig.add_scatter(x=zimbabwe['year'], y=zimbabwe['Social support'], mode='lines', line_color = '#3300cc', showlegend=True, name = 'Zimbabwe')\n\nfig.show()","f42d24c6":"df_mean_pos = []\ndf_mean_neg = []\ndf_mean_ladder = []\n#Perceptions of corruption\n#Freedom to make life choices\ndf_mean_free = []\ndf_mean_per = []\nfor y in year1:\n  df_mean_year= df_all_reports[(df_all_reports['year']== y)]\n  year_mean  = round((df_mean_year['Life Ladder'].mean()\/10), 3) # life ladder is on 10\n  df_mean_ladder.append(year_mean)\n  \n  df_mean_year1= df_all_reports[(df_all_reports['year']== y)]\n  year_mean1  = round(df_mean_year1['Positive affect'].mean(), 3) # life ladder is on 10\n  df_mean_pos.append(year_mean1)\n\n  df_mean_year2= df_all_reports[(df_all_reports['year']== y)]\n  year_mean2  = round(df_mean_year2['Negative affect'].mean(), 3) # life ladder is on 10\n  df_mean_neg.append(year_mean2)\n\n  df_mean_year3= df_all_reports[(df_all_reports['year']== y)]\n  year_mean3  = round(df_mean_year3['Perceptions of corruption'].mean(), 3) # life ladder is on 10\n  df_mean_per.append(year_mean3)\n\n  df_mean_year4= df_all_reports[(df_all_reports['year']== y)]\n  year_mean4 = round(df_mean_year4['Freedom to make life choices'].mean(), 3) # life ladder is on 10\n  df_mean_free.append(year_mean4)\n\nscl = [[0.0, '#ffffff'],[0.2, '#ccffdd'],[0.4, '#66ff99'], [0.6, '#00e64d'],[0.8, '#009933'],[1.0, '#003311']] # greens\n  \nfighist = px.scatter (title= \"The average of columns over time\")\nfighist.add_scatter(x=year1, y= df_mean_ladder, showlegend=True,line_color = '#009933', name = 'Life Ladder')\nfighist.add_scatter( x=year1, y= df_mean_social, showlegend=True, line_color = '#00e64d', name = 'Social support')\nscl = [[0.0, '#ffffff'],[0.2, '#ccffdd'],[0.4, '#66ff99'], [0.6, '#00e64d'],[0.8, '#009933'],[1.0, '#003311']] # greens\nfighist.add_scatter(x=year1, y= df_mean_pos, showlegend=True, line_color = '#ccffdd', name = 'Positive affect')\nfighist.add_scatter( x=year1, y= df_mean_neg, showlegend=True, line_color = '#03b1fc', name = 'Negative affect')\nfighist.add_scatter(x=year1, y= df_mean_free, showlegend=True, line_color = '#03a1fc', name = 'Freedom to make life choices')\nfighist.add_scatter( x=year1, y= df_mean_per, showlegend=True, line_color = '#032cfc', name = 'Perceptions of corruption')\nfighist.update_layout(plot_bgcolor= '#e6e6e6')\nfighist.update_xaxes(showgrid=True, gridwidth=1, gridcolor='#f2f2f2', title_text = \"Year\",)\nfighist.update_yaxes(showgrid=True, gridwidth=1, gridcolor='#f2f2f2', title_text = \"Diffrent columns\",)\n\nfighist.show()","8892c7a7":"As you can see below there is missing data for the columns we will be looking at. Let display what Generoisity is missing on a map.","00922863":"As you can see there is missing data in each year.\nThe Map above shows the generosity of countries over time. Overall there seems to be a decrease in the most recent years on the perception of generosity in most countries.","2c57d624":"# Visulization Of Generosity\nThe first thing that is very noticable is \"generosity\" looks like it will have decreased over all. lets see if that is indeed the case.","d0440cc0":"This last graph shows some other columns over time. This is just to recognize that there are other intresting features in related to pandemic years. For example in 2020 the perception of corruptioin decreased over all. There was also a peak in freedom to make life choices in 2020 as well. \n\n\nIn conlclusion although the data doesnt state for certain that the cause of changes was do to the pandemic, it probably plays a factor in the changes.\n","a36b42cb":"# Generosity and Social Support in the pandemic. \nIn this Data visualization I want to look at how the pandemic has affected people perciotion of Generosity and Social Support in the past year. I am basing myself on the assumption that 2020 and 2021 are considered \"pandemic years\" and all previous years are not considered pandemic years.\n\n\nHypothoisis: Before I start the visualization. I have some general assumptions of what might play out. \n\nFor generosity I believe there will be an over all decline in generosity over all but I beleive the wealtheir countries will have a steeper decline than poor countries. I also believe less happy contries will see less of a change in generosity in comparison to a downward slope for happier countries.\n\nFor social support, my assumption is that it will have grown for both happy and less happy countries. But I assume wealthier countries will see a dip in soical support when comparing to poorer countries. ","f9bec631":"If you have any feedback or comments I would be happy to hear it.\n-Rachel","8a802496":"First Let's start by understanding each column:\n\n 0.   Country name.                      \n 1.   Year: year in which country data was taken                            \n 2.   Life Ladder: I could not find the direct definition for this one but it seems to align with the  \u201cCantril Ladder\u201d which is:  The main life evaluation question asked in the poll is: \u201cPlease imagine a ladder, with steps numbered from 0 at the bottom to 10 at the top. The top of the ladder represents the best possible life for you and the bottom of the ladder represents the worst possible life for you. On which step of the ladder would you say you personally feel you stand at this time?\u201d\n 3.   Log GDP per capita: The GDP-per-capita time series from 2019 to 2020 using country specific forecasts of real GDP growth in 2020.\n 4.   Social support: based on yes(1) or no(0) to the answer: \"If you were in trouble do you think your family or friends would help?\"                    \n 5.   Healthy life expectancy at birth. \n 6.   Freedom to make life choices: based on yes(1) or no(0) to the answer:\"Are you satisfied or dissatisfied with the freedom to choose what you do with your life?\"\n 7.   Generosity: Residual of regressing the national average of GWP responses to: \"Have you donated money to a charity in the past month?\" on a GDP per capita.                      \n 8.   Perceptions of corruption: based on yes(1) or no(0) to the answer:\"Is corruption widespread within the government or not?\" and \"Is corruption widespread within the businesses or not?\" \n 9.   Positive affect: is defined as the average of previous-day affect measures for happiness, laughter, and enjoyment for certain waves in the GWP, sometimes this question is not asked. The general form for the question is: \"Did you experience the following feelings during a lot of yesterday?\"            \n 10.  Negative affect: Same thing as above but instead for: worry, sadness and anger.\n\n Source: https:\/\/worldhappiness.report\/ed\/2020\/social-environments-for-world-happiness\/\n\n https:\/\/ourworldindata.org\/happiness-and-life-satisfaction\n# Shaping Tables","df66348e":"The box plot above shows the generosity based on LOG GDP. Placing half the countries above the mean LOG GDP (9.373) and half below. My hypothesis was wrong in the assumption that generosity will decrease for all the wealthy or poor countries at around the same amount. \n \nSince 2010 the countries below the mean have been around zero, mainly slightly under it, with the lowest before the pandemic years being  -0.019 but during 2020 the median dipped much lower, to -0.032. Just the previous year in 2019 it was -0.004. This shows that there was some damage to the overall generosity of people during the pandemic years. It has increased a bit in 2021 but it is still lower than it has been in the past 10 years. \n \nFor the more wealthy countries there seems to have been a shift in 2021. Where people seem more interested in being generous. There is only one other time the median was ever this close to zero and it was in 2014 where generosity was above zero at 0.002.  besides that 2021 is the second highest year for generosity with a median of -0.009\n","524a47a5":"# Visulization Of Social Support","d226e2f5":"The above scatter plot shows social support over the years and the color is the GDP of each country. Overall you can see that less wealthy countries have worse social support than wealthy countries. During the first pandemic year you can see that there is an increase in social support. which then tapers down in 2021. It is interesting to see during times of crisis, people feel more supported than before. ","c47e2ef9":"These six countries are the same we looked at above (Happiest countries vs less happy countries). As you can see from the graph, happy countries are very consistent in their thoughts of social support. Less happy countries fluctuate more. Some data was missing for the poorer countries in 2020. There is an increase from 2019 to 2021.  ","6062f1e9":"The countries depicted above are the 3 happiest countries and three countries that are all in the lowest of happiness. Over all the happier countries feel they are  are less generous in recent years but the slope seems to have started before the pandemic. The less happy countries seem to have a diffrenct perception of their generoisty but the change in slope seems to have started before the pandemic. The intresting observation is that that are all going to the same direction, specificaly between -0.11 and 0.1"}}