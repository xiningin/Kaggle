{"cell_type":{"7d05dd56":"code","b2745e35":"code","a184b647":"code","f06032db":"code","50210637":"code","1829453b":"code","783ddbda":"code","d9325aaf":"code","73d22913":"code","9f337ee6":"code","2b4d0496":"code","3da52956":"code","26e06e15":"code","eadefeb7":"code","6a65b3e1":"code","377a585f":"code","8bd95f09":"markdown","d49df6d2":"markdown","56b9121c":"markdown","e6a4bd25":"markdown","5ba4044a":"markdown","f8aca4e8":"markdown","26015bb4":"markdown"},"source":{"7d05dd56":"## define configuration\nPATH_TRAIN = '..\/input\/tabular-playground-series-may-2021\/train.csv'\nPATH_TEST = '..\/input\/tabular-playground-series-may-2021\/test.csv'\n\nPATH_AUTOSKLEARN_SUBMISSION = 'submission_autosklearn.csv'\nPATH_H2OAML_SUBMISSION = 'submission_h2oaml.csv'","b2745e35":"## install package\n!curl https:\/\/raw.githubusercontent.com\/automl\/auto-sklearn\/master\/requirements.txt | xargs -n 1 -L 1 pip3 install\n!pip3 install auto-sklearn","a184b647":"## import packages\nimport pandas as pd\n\nfrom autosklearn.classification import AutoSklearnClassifier\nfrom autosklearn.metrics import log_loss","f06032db":"## prepare data\ntrain = pd.read_csv(PATH_TRAIN)\ntest = pd.read_csv(PATH_TEST)\n\ntarget = train.target.values\ntrain.drop(['id', 'target'], axis=1, inplace=True)","50210637":"## run model\nautosklearnml = AutoSklearnClassifier(\n    time_left_for_this_task=600,\n    metric=log_loss,\n    scoring_functions=[log_loss]\n)\n\nautosklearnml.fit(X=train, y=target, dataset_name='tps_may_2021')","1829453b":"## check statistics\nprint(autosklearnml.sprint_statistics())","783ddbda":"## generate predictions\npreds_autosklearnml = autosklearnml.predict_proba(test[train.columns])","d9325aaf":"## create submission\nsubmission = pd.concat([\n    pd.DataFrame({'id': test.id}),\n    pd.DataFrame(preds_autosklearnml, columns=autosklearnml.classes_)\n], axis=1)\n\nsubmission.head()","73d22913":"## save submission\nsubmission.to_csv(PATH_AUTOSKLEARN_SUBMISSION, index=False)","9f337ee6":"## import packages\nimport pandas as pd\n\nimport h2o\nfrom h2o.automl import H2OAutoML","2b4d0496":"## prepare data\nh2o.init()\n\nh2o_train = h2o.import_file(PATH_TRAIN)\nh2o_test = h2o.import_file(PATH_TEST)\n\nh2o_train['target'] = h2o_train['target'].asfactor()","3da52956":"## run model\nfeatures = [x for x in h2o_train.columns if x not in ['id', 'target']]\n\nh2oaml = H2OAutoML(\n    max_runtime_secs=600,\n    stopping_metric='logloss',\n    sort_metric='logloss'\n)\n\nh2oaml.train(x=features, y='target', training_frame=h2o_train)","26e06e15":"## check leaderboard\nh2oaml.leaderboard","eadefeb7":"## generate predictions\npreds_h2oaml = h2oaml.leader.predict(h2o_test)","6a65b3e1":"## create submission\nsubmission = pd.concat([\n    pd.DataFrame({'id': h2o_test['id'].as_data_frame().id}),\n    preds_h2oaml.as_data_frame().drop('predict', axis=1)\n], axis=1)\n\nsubmission.head()","377a585f":"## save submission\nsubmission.to_csv(PATH_H2OAML_SUBMISSION, index=False)","8bd95f09":"## Similar Tutorials\nSimilar tutorials on other Kaggle TPS competitions are published here:\n\n* [AutoML Tutorial: TPS (January 2021)](https:\/\/www.kaggle.com\/rohanrao\/automl-tutorial-tps-january-2021)\n* [AutoML Tutorial: TPS (February 2021)](https:\/\/www.kaggle.com\/rohanrao\/automl-tutorial-tps-february-2021)\n* [AutoML Tutorial: TPS (March 2021)](https:\/\/www.kaggle.com\/rohanrao\/automl-tutorial-tps-march-2021)\n* [AutoML Tutorial: TPS (April 2021)](https:\/\/www.kaggle.com\/rohanrao\/automl-tutorial-tps-april-2021)\n* [AutoML Tutorial: TPS (June 2021)](https:\/\/www.kaggle.com\/rohanrao\/automl-tutorial-tps-june-2021)","d49df6d2":"This is just a baseline submission over which a lot of improvement can be made. You can read more about H2O AutoML's workflow, settings, hyperparameters, interpretability and more here:\n\n* [Documentation of H2O AutoML](https:\/\/docs.h2o.ai\/h2o\/latest-stable\/h2o-docs\/automl.html)\n* [Deep dive of H2O AutoML](https:\/\/github.com\/vopani\/fortyone#automl-series-)","56b9121c":"**Auto**mated **M**achine **L**earning (**AutoML**) has become widely adopted for building, experimenting and productionizing various types of machine learning models across business use-cases.\n\nThere are different open source solutions available and this notebook explores a simple baseline solution for some of them on the [Kaggle TPS (May 2021) competition](https:\/\/www.kaggle.com\/c\/tabular-playground-series-may-2021).\n\n* [Auto-Sklearn](#Auto-Sklearn)\n* [H2O AutoML](#H2O-AutoML)","e6a4bd25":"This is just a baseline submission over which a lot of improvements can be made. You can read more about Auto-Sklearn's workflow, settings, hyperparameters, optimizations and more here:\n\n* [Documentation of auto-sklearn](https:\/\/automl.github.io\/auto-sklearn)\n* [Deep dive of auto-sklearn](https:\/\/github.com\/vopani\/fortyone#automl-series-)","5ba4044a":"## H2O AutoML\n<img src='https:\/\/docs.h2o.ai\/h2o\/latest-stable\/h2o-docs\/_images\/h2o-automl-logo.jpg' width='150px'>\n\n[H2O AutoML](https:\/\/www.h2o.ai\/products\/h2o-automl) is an automated machine learning library open sourced by [H2O.ai](https:\/\/h2o.ai)","f8aca4e8":"<div align='center'>\n    <h1>AutoML Tutorial<\/h1>\n    <img src='https:\/\/github.com\/vopani\/fortyone\/blob\/main\/images\/automl_banner_530_x_455.png?raw=true'>\n<\/div>","26015bb4":"## Auto-Sklearn\n[auto-sklearn](https:\/\/automl.github.io\/auto-sklearn) is an automated machine learning toolkit and a drop-in replacement for a scikit-learn estimator"}}