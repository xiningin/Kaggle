{"cell_type":{"df8eca28":"code","dd2b6b56":"code","afcbd396":"code","1ffd6edb":"code","96a28311":"code","90813bae":"code","68b59c68":"code","b6280818":"code","4ba68ca2":"code","d7221525":"code","46d4b040":"code","f1963459":"code","71c2ca1e":"code","e241372e":"code","7e9782e7":"code","2787570d":"code","38c0897e":"code","68cad60d":"code","c4dcee00":"code","ca7eb92a":"markdown","80d5c552":"markdown","39807c82":"markdown","efd5438c":"markdown","f1c23c19":"markdown","da7e85fa":"markdown","f04f1a0c":"markdown","f9df791d":"markdown"},"source":{"df8eca28":"import pandas as pd","dd2b6b56":"data = pd.read_csv('..\/input\/fragrances-and-perfumes\/perfume.csv')\ndata.head()","afcbd396":"data.info()","1ffd6edb":"import re\nsplit_data = data\nsplit_data.fillna('-1',inplace=True)\nfor i in range(1,21):\n    split_data['notes_{}'.format(str(i))] = data['notes_{}'.format(str(i))].apply(lambda s:re.split('-1|0|1|2|3|4|5|6|7|8|9|10|11|12|13|14|15|16|17|18|19|20',s))","96a28311":"split_data['notes_1']","90813bae":"notes = split_data['notes_1']\nfor i in range(2,21):\n    notes = notes + split_data['notes_{}'.format(str(i))]","68b59c68":"notes = notes.apply(lambda s:list(filter(lambda x:x!='',s)))","b6280818":"notes","4ba68ca2":"def top_extract(s):\n    top = []\n    for i in range (1,len(s)+1):\n        if s[i-1].lower() == 'top':\n            top.append(s[i])\n    return top","d7221525":"def base_extract(s):\n    base = []\n    for i in range (1,len(s)+1):\n        if s[i-1].lower() == 'base':\n            base.append(s[i])\n    return base","46d4b040":"def middle_extract(s):\n    middle = []\n    for i in range (1,len(s)+1):\n        if s[i-1].lower() == 'middle':\n            middle.append(s[i])\n    return middle","f1963459":"top_notes = notes.apply(top_extract)\nmiddle_notes = notes.apply(middle_extract)\nbase_notes = notes.apply(base_extract)","71c2ca1e":"top_notes = top_notes.apply(lambda s:list(filter(lambda x:x!='nan',s)))\nmiddle_notes = middle_notes.apply(lambda s:list(filter(lambda x:x!='nan',s)))\nbase_notes = base_notes.apply(lambda s:list(filter(lambda x:x!='nan',s)))","e241372e":"for i in range(1,21):\n    data = data.drop(columns='notes_{}'.format(str(i)))","7e9782e7":"data.info()","2787570d":"data['top_notes'] = top_notes\ndata['middle_notes'] = middle_notes\ndata['base_notes'] = base_notes","38c0897e":"data.info()","68cad60d":"data.head()","c4dcee00":"data.to_csv('perfume_notes.csv',index=False)","ca7eb92a":"**Removing the blanks:**","80d5c552":"**Removing the columns 'notes_1' to 'notes_20':**","39807c82":"**Adding Top,Middle, and Base notes columns to the dataset:**","efd5438c":"**Concatenating the resulting lists:**","f1c23c19":"**Splitting the words in columns notes_1 to notes_20:**","da7e85fa":"**Extracting Top, Middle, and Base notes:**","f04f1a0c":"**Importing the Dataset**","f9df791d":"**Saving the new dataset:**"}}