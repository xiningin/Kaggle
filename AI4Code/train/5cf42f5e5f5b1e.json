{"cell_type":{"84948039":"code","97a65d20":"code","9c26fede":"code","636961e7":"code","7893f2a1":"code","f570daf5":"code","7cf8bd29":"code","92a6c99d":"code","20613f04":"code","e5240b3d":"code","fbaeb33a":"code","f53580e2":"code","4cf652d1":"code","e85dc902":"code","c8a9cf89":"code","c562bc38":"code","3418b5a1":"markdown","4eb49d82":"markdown","4e0e7cd6":"markdown","efb36b15":"markdown","d2127419":"markdown","b42d60bc":"markdown"},"source":{"84948039":"import tensorflow as tf","97a65d20":"tf.__version__","9c26fede":"import pandas as pd\nimport numpy as np","636961e7":"df_train=pd.read_csv(\"\/kaggle\/input\/digit-recognizer\/train.csv\")\ndf_test=pd.read_csv(\"\/kaggle\/input\/digit-recognizer\/test.csv\")","7893f2a1":"from tensorflow.keras.utils import to_categorical","f570daf5":"df_train.head()","7cf8bd29":"X=df_train.drop('label',axis=1)\/255\nY=to_categorical(df_train['label'])","92a6c99d":"X=np.array(X).reshape(42000,28,28,1)\nX_predict=np.array(df_test\/255).reshape(28000,28,28,1)","20613f04":"from sklearn.model_selection import train_test_split\nX_train,X_test,Y_train,Y_test=train_test_split(X,Y,test_size=0.2,random_state=101)","e5240b3d":"model = tf.keras.Sequential()","fbaeb33a":"model.add(tf.keras.layers.Conv2D(128,(3,3),activation=\"relu\",input_shape=(28,28,1)))\nmodel.add(tf.keras.layers.MaxPool2D(2,2))\nmodel.add(tf.keras.layers.Conv2D(128,(3,3),activation=\"relu\",input_shape=(28,28,1)))\nmodel.add(tf.keras.layers.MaxPool2D(2,2))\nmodel.add(tf.keras.layers.Conv2D(128,(3,3),activation=\"relu\",input_shape=(28,28,1)))\n\nmodel.add(tf.keras.layers.Flatten())\nmodel.add(tf.keras.layers.Dropout(0.2))\nmodel.add(tf.keras.layers.Dense(256,activation=\"relu\"))\nmodel.add(tf.keras.layers.Dense(512,activation=\"relu\"))\nmodel.add(tf.keras.layers.Dense(256,activation=\"relu\"))\nmodel.add(tf.keras.layers.Dense(10,activation=\"softmax\"))\n\n","f53580e2":"model.summary()","4cf652d1":"from tensorflow.keras.optimizers import RMSprop","e85dc902":"model.compile(loss='categorical_crossentropy',optimizer=RMSprop(lr=0.0001),metrics=['acc'])","c8a9cf89":"model.fit(X_train,Y_train,epochs=30,batch_size=256)","c562bc38":"model.evaluate(X_test,Y_test,batch_size=128)","3418b5a1":"Our model has performed really well. It has given 99% accuracy.\n\nThis may not be the best solution. We can adjust the dropout layer and Con2D layer to improve the model performance.","4eb49d82":"Above, we have used the Dropout layer to overcome the overfitting problem.","4e0e7cd6":"We have completed our training.\n\nAnd we got 99.50% accuracy on the training set. \n\nNow lets evaluate the test set to see how our model performs on the unseen data.","efb36b15":"Now lets train our network with 30 epochs.","d2127419":"Lets import the neccessary package required for Digit Recognition.\n\nWe will be using CNN (Convolutional Neural Network).\n  \ncredit : https:\/\/www.kaggle.com\/gurleenkaur1109\/mnist-classificationwithcnn\nWith Tensorflow 2 ","b42d60bc":"Read the training set and test set."}}