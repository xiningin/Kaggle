{"cell_type":{"8f6e11d9":"code","522480be":"code","1e4851da":"code","b06b6987":"code","46a1fd00":"code","70bc64bf":"code","a66cc130":"code","54134857":"code","165e9be6":"code","203633db":"code","50b7e026":"code","bbbd12a7":"code","b8c84c76":"code","3145b8e8":"code","e00fe81f":"code","618a2e42":"code","99cb6fce":"code","13d59771":"code","e39c8e47":"code","2f0697cc":"code","8dbc56be":"code","ac661756":"code","ccb31168":"code","3efee7ad":"code","e8a08319":"code","fcc8e8ec":"code","d86a7e7e":"code","ba4fe52e":"code","edf5dfd9":"code","4c8f6783":"code","0942211e":"code","c6600834":"code","d6c02c84":"code","877e3760":"code","0d57885b":"code","121a3012":"code","f649529e":"code","ac785582":"code","03ee53bb":"code","7522241a":"code","8f7d7621":"code","a93dfdeb":"code","8c4469f4":"code","3700ddde":"markdown","223f9736":"markdown","b555a80a":"markdown","5f761e8e":"markdown","9c73ef4d":"markdown","9fd0ef37":"markdown","0fd3f46b":"markdown","b198278e":"markdown","3b1f2e97":"markdown","18848e78":"markdown","82327130":"markdown","0ef650cb":"markdown","0ba7a6a2":"markdown","4f51bb80":"markdown","9f8abdda":"markdown","fbb3e2c2":"markdown","cdf57840":"markdown","fa3c3409":"markdown","49ddb2e1":"markdown","7570e4ce":"markdown","69a22f12":"markdown"},"source":{"8f6e11d9":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set()\n\n%matplotlib inline","522480be":"pd.set_option('display.max_columns',40)","1e4851da":"from sklearn.model_selection import train_test_split\nfrom sklearn.feature_selection import SelectKBest\nfrom sklearn.feature_selection import chi2\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.svm import SVC\nfrom sklearn.metrics import confusion_matrix, accuracy_score, classification_report\nfrom sklearn.model_selection import GridSearchCV","b06b6987":"import plotly.offline as py\npy.init_notebook_mode(connected=True)\nimport plotly.graph_objs as go\nimport plotly.figure_factory as ff","46a1fd00":"cancer = pd.read_csv('..\/input\/breast-cancer-wisconsin-data\/data.csv')","70bc64bf":"cancer.head()","a66cc130":"cancer.columns","54134857":"print(\"Cancer dataset dimensions : {}\".format(cancer.shape))\nprint()\nprint(\"Rows:\",cancer.shape[0])\nprint()\nprint(\"Columns:\",cancer.shape[1])","165e9be6":"cancer.describe().T","203633db":"cancer.drop(['Unnamed: 32','id'],1,inplace=True)","50b7e026":"cancer.head()","bbbd12a7":"cancer.isnull().any().any()","b8c84c76":"trace = go.Pie(labels = ['benign','malignant'], values = cancer['diagnosis'].value_counts(), \n               textfont=dict(size=15), opacity = 0.8,\n               marker=dict(colors=['pink', 'purple'], \n               line=dict(color='#000000', width=1.5)))\n           \n\nlayout= go.Layout(\n        title={\n        'text': \"Distribution of diagnosis variable\",\n        'y':0.9,\n        'x':0.5,\n        'xanchor': 'center',\n        'yanchor': 'top'})\n\nfig = go.Figure(data = [trace], layout=layout)\nfig.show()","3145b8e8":"cancer['diagnosis']= cancer['diagnosis'].map({'M':1,'B':0})","e00fe81f":"M = cancer[(cancer['diagnosis'] != 0)]\nB = cancer[(cancer['diagnosis'] == 0)]","618a2e42":"def plots(column, bin_size) :  \n    temp1 = M[column]\n    temp2 = B[column]\n    \n    hist_data = [temp1, temp2]\n    \n    group_labels = ['Malignant', 'Benign']\n    colors = ['purple', 'pink']\n\n    fig = ff.create_distplot(hist_data, group_labels, colors = colors, show_hist = True, bin_size = bin_size, curve_type='kde')\n    \n    fig['layout'].update(title = column)\n    fig.show()","99cb6fce":"plots('radius_mean', .5)\nplots('texture_mean', .5)\nplots('perimeter_mean',5)\nplots('area_mean',15)","13d59771":"plots('radius_se', .1)\nplots('texture_se', .1)\nplots('perimeter_se', .5)\nplots('area_se', 5)","e39c8e47":"plots('radius_worst', .5)\nplots('texture_worst', .5)\nplots('perimeter_worst', 5)\nplots('area_worst', 10)","2f0697cc":"plt.figure(figsize=(20,10))\nsns.heatmap(cancer.corr(),annot=True)","8dbc56be":"sns.scatterplot(x='area_mean',y='smoothness_mean',hue='diagnosis',data=cancer)","ac661756":"cancer.columns","ccb31168":"features = ['radius_mean', 'texture_mean', 'perimeter_mean',\n       'area_mean', 'smoothness_mean', 'compactness_mean', 'concavity_mean',\n       'concave points_mean', 'symmetry_mean', 'fractal_dimension_mean',\n       'radius_se', 'texture_se', 'perimeter_se', 'area_se', 'smoothness_se',\n       'compactness_se', 'concavity_se', 'concave points_se', 'symmetry_se',\n       'fractal_dimension_se', 'radius_worst', 'texture_worst',\n       'perimeter_worst', 'area_worst', 'smoothness_worst',\n       'compactness_worst', 'concavity_worst', 'concave points_worst',\n       'symmetry_worst', 'fractal_dimension_worst']","3efee7ad":"X =cancer.iloc[:,1:32].values\ny =cancer['diagnosis']","e8a08319":"X_train, X_test, y_train, y_test = train_test_split(X,y,test_size=0.3,random_state=22,stratify=y)","fcc8e8ec":"scaler = StandardScaler()\nX_train = scaler.fit_transform(X_train)\nX_test= scaler.transform(X_test)","d86a7e7e":"model = SVC(kernel='linear')\nmodel.fit(X_train,y_train)","ba4fe52e":"y_pred = model.predict(X_test)","edf5dfd9":"cnf = confusion_matrix(y_test,y_pred)\nsns.heatmap(cnf,annot=True,cmap='summer',fmt='g')","4c8f6783":"acc = accuracy_score(y_test,y_pred)\nprint(\"Accuracy:\",acc)","0942211e":"print(classification_report(y_test,y_pred))","c6600834":"param_grid={'C':[0.1,1,10,100,1000],\n            'gamma':[1,0.1,0.01,0.001,0.0001],\n            'kernel':['rbf']}","d6c02c84":"grid= GridSearchCV(SVC(),param_grid,refit=True,verbose=4)\ngrid.fit(X_train,y_train)","877e3760":"grid.best_params_","0d57885b":"grid.best_score_","121a3012":"g_pred = grid.predict(X_test)","f649529e":"g_cnf = confusion_matrix(y_test,g_pred)\nsns.heatmap(g_cnf,annot=True,fmt='g',cmap='Blues')","ac785582":"g_acc = accuracy_score(y_test,g_pred)\nprint(\"Accuracy with GridSearch:\",g_acc)","03ee53bb":"print(classification_report(y_test,g_pred))","7522241a":"coef= model.coef_\ncoeffs = np.squeeze(coef)\ncoeffs","8f7d7621":"coefs = pd.DataFrame({\"Features\":features,\"Coefficients\":coeffs})\nfeature_imp = coefs.sort_values(by='Coefficients',ascending=False)","a93dfdeb":"feature_imp","8c4469f4":"plt.figure(figsize=(15,10))\nsns.barplot(y='Features',x='Coefficients',data=feature_imp)","3700ddde":"<font size='3'>Hurray! We have no missing records<\/font>","223f9736":"<a id=\"7\"><\/a>\n<h2 style='font-size:30px;background:black; border:0; color:white'><center>PARAMETER TUNING<\/center><h2>","b555a80a":"<a id=\"5\"><\/a>\n<h2 style='font-size:30px;background:black; border:0; color:white'><center>MODEL BUILDING<\/center><h2>","5f761e8e":"<a id=\"8\"><\/a>\n<h2 style='font-size:30px;background:black; border:0; color:white'><center>FEATURE IMPORTANCE<\/center><h2>","9c73ef4d":"<a id=\"4\"><\/a>\n<h2 style='font-size:30px;background:black; border:0; color:white'><center>FEATURE SCALING<\/center><h2>","9fd0ef37":"<font size='3'>We have more Benign cases than the Malignant<\/font>","0fd3f46b":"<h2 style='text-align:center;font-size:30px;background-color:black;border:20px;color:white'>TABLE OF CONTENTS<h2>","b198278e":"<a id=\"6\"><\/a>\n<h2 style='font-size:30px;background:black; border:0; color:white'><center>MODEL EVALUATION<\/center><h2>","3b1f2e97":"No doubt we have good accuracy of 98% but let's see if our model can get better with parameter tuning! Let's go ","18848e78":"<center><img src=\"https:\/\/nationaltoday.com\/wp-content\/uploads\/2019\/10\/breast-cancer-aware.jpg\"><\/center>","82327130":"<h1 style='font-size:40px;background:PINK; border:0; color:white'><center> BREAST CANCER PREDICTION USING SVM<\/center><\/h1>","0ef650cb":"<center><img src=\"https:\/\/images-na.ssl-images-amazon.com\/images\/I\/613f9N0BiJL._SL1500_.jpg\"><\/center>","0ba7a6a2":"<font size='3'>We have columns Unnamed:32 and id which doesn't making sense to keep it anymore. We can drop it!<\/font>","4f51bb80":"<a id=\"1\"><\/a>\n<h2 style='font-size:30px;background:black; border:0; color:white'><center> IMPORTING LIBRARIES <\/center><h2>","9f8abdda":"<center><img src=\"https:\/\/encrypted-tbn0.gstatic.com\/images?q=tbn%3AANd9GcQpTjNIwP4--vaPwInGxqMufHlWLQjCnRPLEg&usqp=CAU![image.png](attachment:image.png)\"><center","fbb3e2c2":"Our model has done best with 98% accuracy without parameter tuning!","cdf57840":"## [GO TO TOP](#10)","fa3c3409":"<a id=\"2\"><\/a>\n<h2 style='font-size:30px;background:black; border:0; color:white'><center> MISSING VALUES <\/center><h2>","49ddb2e1":"<a id=\"3\"><\/a>\n<h2 style='font-size:30px;background:black; border:0; color:white'><center>EXPLORATORY DATA ANALYSIS<\/center><h2>","7570e4ce":"<a id=\"10\"><\/a>\n\n* [IMPORTING LIBRARIES](#1)\n* [MISSING VALUES](#2)\n* [EXPLORATORY DATA ANALYSIS](#3)\n* [FEATURE SCALING](#4)\n* [MODEL BUILDING](#5)\n* [MODEL EVALUATION](#6)\n* [PARAMETER TUNING](#7)\n* [FEATURE IMPORTANCE](#8)","69a22f12":"<font size='3'>Because Support Vector Machine (SVM) optimization occurs by minimizing the decision vector w, the optimal hyperplane is influenced by the scale of the input features and it's therefore recommended that data be standardized (mean 0, var 1) prior to SVM model training.<\/font>"}}