{"cell_type":{"d7b3dd43":"code","e3f890df":"code","7e1ac73e":"code","2598a27a":"code","fc6ef598":"code","6b255b62":"code","93ff832d":"code","0885cade":"markdown","b7cfe4ba":"markdown","236391e3":"markdown"},"source":{"d7b3dd43":"!pip install autogluon\n!pip install --upgrade ipykernel","e3f890df":"import pandas as pd\nimport numpy as np\nfrom autogluon.tabular import TabularPredictor\nfrom autogluon.tabular.models.knn.knn_rapids_model import KNNRapidsModel\nfrom autogluon.tabular.models.lr.lr_rapids_model import LinearRapidsModel","7e1ac73e":"train_data=pd.read_csv('..\/input\/tabular-playground-series-jun-2021\/train.csv')\ntest_data=pd.read_csv('..\/input\/tabular-playground-series-jun-2021\/test.csv')\nsub=pd.read_csv('..\/input\/tabular-playground-series-jun-2021\/sample_submission.csv')","2598a27a":"for col in train_data.columns: train_data[col] = train_data[col].astype('category')\nfor col in test_data.columns: test_data[col] = test_data[col].astype('category')","fc6ef598":"predictor = TabularPredictor(label=\"target\",\n                             problem_type='multiclass',\n                             eval_metric=\"log_loss\",\n                             learner_kwargs={'ignored_columns': ['id']},\n                             path=\".\",\n                             verbosity=3)\n\npredictor.fit(\n    train_data, \n    presets='best_quality',\n    hyperparameters={\n        KNNRapidsModel: {},\n        LinearRapidsModel: {},\n        'NN': {},\n        'RF': {},\n        'XGB': {'ag_args_fit': {'num_gpus': 1}},\n        'CAT': {'ag_args_fit': {'num_gpus': 1}},\n        'GBM': [{}, {'extra_trees': True, 'ag_args': {'name_suffix': 'XT'}}, 'GBMLarge'],\n        'NN': {'ag_args_fit': {'num_gpus': 1}},\n        'FASTAI': {'ag_args_fit': {'num_gpus': 1}},\n    },\ntime_limit=60*60*8)\n\nresults = predictor.fit_summary()","6b255b62":"sub.iloc[:, 1:] = predictor.predict_proba(test_data)\nsub.to_csv(\"sub_autogluon.csv\", index=False)","93ff832d":"sub","0885cade":"# Sub","b7cfe4ba":"# AutoGluon\n\nsee: \n\n- https:\/\/auto.gluon.ai\/stable\/tutorials\/tabular_prediction\/tabular-kaggle.html\n- https:\/\/www.kaggle.com\/innixma\/autogluon-rapids-top-1","236391e3":"# Load dependencies"}}