{"cell_type":{"0621188e":"code","81cb02fe":"code","3a7c3e4a":"code","8bfb1952":"code","db0eb73d":"code","cdef1b05":"code","2db3c2f0":"code","570ea5bc":"code","157a5549":"code","27da4594":"code","a4777b17":"code","1501013c":"code","75b25de0":"code","8051f6ea":"code","0ef7605a":"code","e121b113":"code","509a9759":"code","832158af":"code","364788c9":"code","562b10be":"code","d807a9b0":"code","4f169ffe":"code","6f8d3f98":"code","7055eb5d":"code","1b8def0b":"code","563aa19d":"code","cf86b5e9":"code","42a65116":"code","1d185bf2":"code","2caf2773":"code","07f5a55f":"code","22f05093":"code","41115965":"code","65b5c6d7":"code","b3add08c":"code","29ba8561":"markdown","0eb44be7":"markdown","569f86be":"markdown","1e357f6d":"markdown","927e177e":"markdown","231c204f":"markdown","e9064b0e":"markdown","bc5c8516":"markdown","fe1f35bb":"markdown","2e69837f":"markdown","f6bc77c2":"markdown","f1bcff2f":"markdown","0feef1c8":"markdown","4ef9c884":"markdown","aa374ca5":"markdown","7026527e":"markdown","8da9e249":"markdown","dff49843":"markdown","1b386da1":"markdown","505d9b74":"markdown","c967586c":"markdown"},"source":{"0621188e":"#Importing required libraries\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom sklearn.preprocessing import LabelEncoder , StandardScaler, MinMaxScaler\nfrom sklearn.model_selection import train_test_split, GridSearchCV\nfrom sklearn import svm\nfrom sklearn.ensemble import RandomForestClassifier\nimport xgboost as xgb\nfrom keras.models import Sequential\nfrom keras.layers import Dense\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.metrics import accuracy_score, confusion_matrix, classification_report\nfrom sklearn.feature_selection import chi2\nfrom scipy.stats import chi2_contingency\n\n","81cb02fe":"#Reading the dataset\ndataset = pd.read_csv('\/kaggle\/input\/customer-analytics\/Train.csv')\ndataset.head()","3a7c3e4a":"# Shape of the dataset\ndataset.shape","8bfb1952":"#Information about the columns\ndataset.info()","db0eb73d":"#Checking if there is any null values in the dataset\ndataset.isnull().sum()","cdef1b05":"#Basic summary statistics\ndataset.describe()","2db3c2f0":"dataset.head()","570ea5bc":"delay=pd.DataFrame(dataset.groupby(['Reached.on.Time_Y.N'])['ID'].count()\/len(dataset)).reset_index()\nplt.pie(delay['ID'],labels=delay['Reached.on.Time_Y.N'],autopct='%1.2f%%')","157a5549":"data_v1 = dataset[dataset['Reached.on.Time_Y.N']==0]","27da4594":"data_v2=pd.DataFrame((data_v1.groupby(['Mode_of_Shipment'])['ID'].count())\/len(data_v1)*100)\ndata_v2=data_v2.reset_index()\nvisual=sns.barplot(x=\"Mode_of_Shipment\", y=\"ID\", data=data_v2 )\nfor index, row in data_v2.iterrows():\n    visual.text(row.name,row.ID, round(row.ID,2), color='black', ha=\"center\")\nplt.title('Total number of delayed deliveries vs Shipment mode')\nplt.ylabel('percentage')","a4777b17":"data_v3=pd.DataFrame((data_v1.groupby(['Warehouse_block'])['ID'].count())\/len(data_v1)*100)\ndata_v3=data_v3.reset_index()\nvisual=sns.barplot(x=\"Warehouse_block\", y=\"ID\", data=data_v3 )\nfor index, row in data_v3.iterrows():\n    visual.text(row.name,row.ID, round(row.ID,2), color='black', ha=\"center\")\nplt.title('Total number of delayed deliveries vs Warehouse block')\nplt.ylabel('percentage')","1501013c":"data_v4=pd.DataFrame((dataset.groupby(['Customer_rating'])['ID'].count())\/len(dataset)*100)\ndata_v4=data_v4.reset_index()\nvisual=sns.barplot(x=\"Customer_rating\", y=\"ID\", data=data_v4 )\nfor index, row in data_v4.iterrows():\n    visual.text(row.name,row.ID, round(row.ID,2), color='black', ha=\"center\")\nplt.title('Total percentages of different ratings')\nplt.ylabel('percentage')","75b25de0":"sns.countplot(x = \"Product_importance\", data = dataset, hue=\"Reached.on.Time_Y.N\")\nplt.title(\"Product importance by Reached on Time or Not\")","8051f6ea":"sns.countplot(x = \"Gender\", data = dataset, hue=\"Reached.on.Time_Y.N\")\nplt.title(\"Gender by Reached on Time or Not\")","0ef7605a":"sns.countplot(x = \"Warehouse_block\", data = dataset, hue=\"Reached.on.Time_Y.N\")\nplt.title(\"Warehouse block vs on Time or Not\")","e121b113":"sns.countplot(x = \"Customer_rating\", data = dataset, hue=\"Gender\")\nplt.title(\"Customer ratings by Gender\")","509a9759":"sns.boxplot(x='Gender',y='Cost_of_the_Product',data=dataset,hue='Gender')\nplt.title(\"Amount spent by each Gender\")","832158af":"dataset.groupby(['Product_importance'])['Cost_of_the_Product'].mean().plot.bar()\nplt.title(\"Average cost of products of different importance\")","364788c9":"dataset.head()","562b10be":"dataset[['Cost_of_the_Product','Prior_purchases','Discount_offered','Weight_in_gms']].hist()\n","d807a9b0":"corr = dataset.corr()\nsns.heatmap(corr, cmap=\"Blues\", annot=True)","4f169ffe":"#Dropping the ID column because of high cardinality\ndata=dataset.drop(['ID'],axis=1)\ndata.head()","6f8d3f98":"#Warehouse_block\ncrossTab = pd.crosstab(data['Warehouse_block'], data['Reached.on.Time_Y.N'])\nChiSqResult = chi2_contingency(crossTab)\nprint(\"p-value \",ChiSqResult[1])","7055eb5d":"#Warehouse_block\ncrossTab = pd.crosstab(data['Mode_of_Shipment'],data['Reached.on.Time_Y.N'])\nChiSqResult = chi2_contingency(crossTab)\nprint(\"p-value \",ChiSqResult[1])","1b8def0b":"# Product_importance\ncrossTab = pd.crosstab(data['Product_importance'],data['Reached.on.Time_Y.N'])\nChiSqResult = chi2_contingency(crossTab)\nprint(\"p-value \",ChiSqResult[1])","563aa19d":"# Gender\ncrossTab = pd.crosstab(data['Gender'],data['Reached.on.Time_Y.N'])\nChiSqResult = chi2_contingency(crossTab)\nprint(\"p-value \",ChiSqResult[1])","cf86b5e9":"#Renaming the column Reached.on.Time_Y.N\ndata.rename(columns={'Reached.on.Time_Y.N':'Reached on Time'}, inplace=True)","42a65116":"data=pd.get_dummies(data,columns=['Product_importance'], drop_first=True)\ndata.head()","1d185bf2":"X=data.drop(['Reached on Time','Warehouse_block','Mode_of_Shipment','Gender'],axis=1)\ny=data['Reached on Time']","2caf2773":"#Splitting data into training and testing data\nX_train, X_test, y_train, y_test = train_test_split(X,y,test_size=0.2, random_state=42)\n\n#Scaling the data\nms = MinMaxScaler()\nX_train = ms.fit_transform(X_train)\nX_test = ms.fit_transform(X_test)","07f5a55f":"X_train = pd.DataFrame(X_train,columns=X.columns)\nX_test  =pd.DataFrame(X_test,columns=X.columns)\nX_train.head()","22f05093":"svm_model = svm.SVC(gamma='auto',C=5,kernel='rbf')\nsvm_model.fit(X_train,y_train)\ny_pred = svm_model.predict(X_test)\nprint(classification_report(y_test,y_pred))","41115965":"params = {'n_estimators':[100,150], 'criterion':['gini', 'entropy']}\n#Hyper parameter tuning\nrf_model =GridSearchCV(estimator=RandomForestClassifier(),param_grid=params,scoring='accuracy', cv=5)\nrf_model = rf_model.fit(X_train,y_train)\ny_pred=rf_model.predict(X_test)\nprint(classification_report(y_test,y_pred))","65b5c6d7":"ann = Sequential()\nann.add(Dense(14,input_dim=8,activation='relu'))\nann.add(Dense(8,activation='relu'))\nann.add(Dense(8,activation='relu'))\nann.add(Dense(1,activation='sigmoid'))\nann.compile(loss=\"binary_crossentropy\", optimizer='SGD',metrics=['accuracy'])\nann.fit(X_train, y_train, epochs=100, batch_size=15)","b3add08c":"predictions = (ann.predict(X_test) > 0.5)\nprint(classification_report(y_test,predictions))","29ba8561":"**Observations:**\n* No missing values in the dataset","0eb44be7":"**Observations:**\n* The percentage of different ratings given by customers seems to same. Almost 20% of the total deliveries received 5 ratings","569f86be":"**Observations:**\n* More number of deliveries were from Ware house block 'F'\n* For rest of the blocks, the pattern remains same","1e357f6d":"**Artificial Neural Network**","927e177e":"# Data Profiling","231c204f":"**Conclusion:**\n* ANN gives better accuracy of 67% than SVM and Random forest","e9064b0e":"**Observations:**\n* 40% of the total deliveries are not reached on time","bc5c8516":"**Observations:**\n*  There is a slight positive correlation between 'cost of products' and 'customer care calls'","fe1f35bb":"**Random Forest Classifier**","2e69837f":"**Observations**\n* 'Discount_offered' is positively skewed\n* Even 'prior purchase' is also positively skewed","f6bc77c2":"**Observations:**\n* From chi square test, we can conclude that three of the independent categorical features are not related to the response variable beacause the p value is greater than 0.05. So, these features can be removed and only product importance feature can be included","f1bcff2f":"**Support Vector Machine**","0feef1c8":"# Exploratory Data Analysis","4ef9c884":"**Observations:**\n* The average value of higher importance is slightly lesser than both low and high importance products. So, the product importance is not assigned based on the monetory value\n* Overall there isnt much variation in the features","aa374ca5":"**Observations:**\n* Around 68% of the delayed deliveries are caused when ships are used as a mode of shipments. So, Alternate options like Flight and Road services might be considered to reduce the delayed deliveries ","7026527e":"**Chi square test of independence**","8da9e249":"**Observations**\n* Both men and women seems to spend same level of amount on average while purchasing a product ","dff49843":"# Data preparation","1b386da1":"# Prediction of on time delivery of products","505d9b74":"**Observations:**\n* Higher number of deliveries falls under low product importance. Very less number of highly important products delivered. It means customers are ordering more number of low importance products from this ecommerce group","c967586c":"**Observations**\n* Higher percent of delayed deliveries are recorded in Warehouse block F. For rest of the block,the percent of delayed deliveries are almost consistent"}}