{"cell_type":{"65aaf43e":"code","71c613ef":"code","4d4f56ac":"code","57fa4d13":"code","757da4a4":"code","4823ccb3":"code","28d15a70":"code","752f1969":"code","3378db4f":"code","d35096c1":"code","97fc9043":"code","ddcf8180":"code","f79d3eca":"code","4007975e":"code","dbca4cc5":"code","ba4862b5":"markdown","d80705be":"markdown","00fb0555":"markdown","e81c4e39":"markdown","d1320967":"markdown","6d0bb9ad":"markdown","2209f85d":"markdown"},"source":{"65aaf43e":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport tensorflow as tf \nimport os \nimport seaborn as sns \nimport matplotlib.image as mpimg","71c613ef":"train_input = \"..\/input\/digit-recognizer\/train.csv\"\ntest_input = \"..\/input\/digit-recognizer\/test.csv\"\n\ntrain_dataset = pd.read_csv(train_input)\ntest_dataset = pd.read_csv(test_input)","4d4f56ac":"train_dataset.head()","57fa4d13":"test_dataset.head()","757da4a4":"plt.bar(range(10), train_dataset.label.value_counts(), color=\"#FF6F00\", tick_label=range(10))\nplt.xlabel(\"Numbers\")\nplt.ylabel(\"Counts\")\nplt.show()","4823ccb3":"train_labels = tf.keras.utils.to_categorical(train_dataset.pop(\"label\"))","28d15a70":"train_dataset = np.array(train_dataset.values.reshape(-1, 28, 28, 1))\ntest_dataset = np.array(test_dataset.values.reshape(-1, 28, 28, 1))","752f1969":"train_dataset = train_dataset\/255.0\ntest_dataset = test_dataset\/255.0","3378db4f":"checkpoint_path = \"logs\/checkpoints\/\"","d35096c1":"model = tf.keras.models.Sequential([\n    tf.keras.layers.Conv2D(64, (3, 3), input_shape=(28, 28, 1), activation=tf.nn.relu, padding=\"SAME\"),\n    tf.keras.layers.MaxPooling2D(),\n    tf.keras.layers.Conv2D(64, (3, 3), activation=tf.nn.relu, padding=\"SAME\"),\n    tf.keras.layers.MaxPooling2D(),\n    tf.keras.layers.Dropout(0.5),\n    tf.keras.layers.Conv2D(128, (3, 3), activation=tf.nn.relu, padding=\"SAME\"),\n    tf.keras.layers.MaxPooling2D(),\n    tf.keras.layers.BatchNormalization(),\n    tf.keras.layers.Conv2D(128, (3, 3), activation=tf.nn.relu, padding=\"SAME\"),\n    tf.keras.layers.MaxPooling2D(),\n    tf.keras.layers.BatchNormalization(),\n    tf.keras.layers.Flatten(),\n    tf.keras.layers.Dense(128, activation=tf.nn.relu),\n    tf.keras.layers.Dropout(0.5),\n    tf.keras.layers.Dense(10, activation=\"softmax\")\n])\n\nepochs=50\n\ncallbacks = [\n    tf.keras.callbacks.ModelCheckpoint(filepath=checkpoint_path,\n                                        monitor=\"accuracy\",\n                                        save_best_only=True,\n                                        save_weights_only=True),\n    tf.keras.callbacks.EarlyStopping(monitor=\"accuracy\", patience=15)\n]\n\nmodel.compile(optimizer=\"adam\", loss=\"categorical_crossentropy\", metrics=[\"accuracy\"])\nhistory = model.fit(train_dataset, train_labels, epochs=epochs, callbacks=callbacks, batch_size=64)","97fc9043":"def plot_metric(metric):\n    plt.plot(range(epochs), history.history[metric], color=\"#FF6F00\")\n    plt.title(metric)\n    plt.show()\n    \nplot_metric(\"accuracy\")\nplot_metric(\"loss\")","ddcf8180":"model.load_weights(checkpoint_path)","f79d3eca":"labels = [np.argmax(predict) for predict in model.predict(test_dataset)]\ndf = pd.DataFrame({\n    \"ImageId\": list(range(1, len(test_dataset)+1)),\n    \"Label\": labels,\n})","4007975e":"df.to_csv(\"submission.csv\", index=False)","dbca4cc5":"model.save(\"model.h5\")","ba4862b5":"The goal of this project is to take an image of handwritten digits and determine what those digits are. The principal task in digit recognition is to extract HOG features from the database of handwritten digits and to build a classifier on it. Then we predict the digits of the database using this classifier.","d80705be":"PATH","00fb0555":"# DIGIT RECOGNIZER","e81c4e39":"PREDICTION","d1320967":"LIBRARIES","6d0bb9ad":"MODEL + TRAINING","2209f85d":"![](https:\/\/miro.medium.com\/max\/718\/1*4TJWlK-FPhskEIJshfEx5g.jpeg)"}}