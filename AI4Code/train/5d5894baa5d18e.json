{"cell_type":{"ea1b4fd3":"code","159795f0":"code","7eca17a1":"code","130cab3c":"code","08800fed":"code","1a0ccb3a":"code","9f7cca12":"code","760e9f14":"code","03805cb6":"code","deab6531":"code","2d5923ad":"code","c8714281":"code","55cee7d5":"code","5adbc996":"markdown","fca5d63e":"markdown","89ef42b7":"markdown","d2bec5e2":"markdown","a3b9d406":"markdown","04688053":"markdown"},"source":{"ea1b4fd3":"!pip install pmdarima","159795f0":"import pandas as pd\nimport numpy as np\nimport pandas_datareader as pdr\nimport datetime as dt\nimport matplotlib.pyplot as plt\nplt.style.use('seaborn')\nimport seaborn as sns\n\n\nfrom statsmodels.tsa.stattools import adfuller\nfrom statsmodels.tsa.seasonal import seasonal_decompose\nfrom statsmodels.tsa.statespace.sarimax import SARIMAX\nfrom statsmodels.graphics.tsaplots import plot_acf, plot_pacf\nfrom statsmodels.tsa.arima.model import ARIMA\nfrom pmdarima import auto_arima","7eca17a1":"plt.rcParams['figure.figsize'] = (20,15)","130cab3c":"ticker = \"GOOG\"\nstart = dt.datetime(2015,1,1)\ndf = pdr.get_data_yahoo(ticker,start=start)\ndf= df[['Close']]\ndf[:20]","08800fed":"df.plot()","1a0ccb3a":"result = seasonal_decompose(np.log(df), period=5) \nresult.plot();","9f7cca12":"# Make dataframe more additive using log transform\ndf = np.log(df)\ndf","760e9f14":"'''Clearly, series is not stationary but we shall check it using adf test. We shall also check seasonality using acf'''\nprint(f'The p-value of the series is {adfuller(df.Close)[1]}')","03805cb6":"plot_acf(df.dropna(), lags=40);","deab6531":"model = auto_arima(df, max_p=6, max_q=3, m=5, seasonal=True, max_P=4, max_Q=4, max_D=2, max_order=None,\n                   d=None, trace=True, trend='ct',\n                   out_of_sample_size = int(len(df)*.2),\n                   error_action='ignore',   # we don't want to know if an order does not work\n                   suppress_warnings=True,  # we don't want convergence warnings\n                   stepwise=True) # set to stepwise)\n#model_fit = model.fit()\nmodel.summary()","2d5923ad":"model = SARIMAX(df, order=(0,2,1), seasonal_order=(0,0,0,5))\nmodel_fit = model.fit()\nmodel_fit.summary()","c8714281":"fc = model_fit.predict(-51)\nplt.plot(fc, label='Forecast')\nplt.plot(df[-50:], label='Original')\nplt.legend()\n\n#fc.plot()","55cee7d5":"period = 30 # for forecast\nfc = model_fit.forecast(period)\nstart = dt.date.today() + dt.timedelta(days=1)\nfc_ind = pd.date_range(start=start, periods=period)\nfc.index = fc_ind\n\n# plotting last 25 + period values\nplt.plot(df[-25:],label='Original')\nplt.plot(fc, label='Future Forecast')\nplt.legend()","5adbc996":"Hence, series is not stationary. Next, we check the seasonality using acf plot.","fca5d63e":"# Imports","89ef42b7":"# Auto ARIMA","d2bec5e2":"We will do LSTM in, TO BE SHARED soon!","a3b9d406":"So last 51 values were forecasted quiet well. But we shall see forecast in future (for period of 30 days) is not good. ","04688053":"# Stationarity"}}