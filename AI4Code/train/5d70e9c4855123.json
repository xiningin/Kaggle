{"cell_type":{"3bb1735b":"code","d6127689":"code","927957e1":"code","6cf3b790":"code","fc4625f7":"code","32056684":"code","e652cea4":"code","26abc56d":"code","63e96f63":"code","f5bfe218":"code","0502b8c6":"code","e61008e9":"markdown","eee51404":"markdown","8c91bf32":"markdown"},"source":{"3bb1735b":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.\nimport plotly.graph_objs as go\nimport plotly.figure_factory as ff\nimport plotly.express as px","d6127689":"users = pd.read_csv('\/kaggle\/input\/movietweetings\/users.dat', sep='::', header=None)\nusers.columns = ['user_id', 'twitter_id']\nratings = pd.read_csv('\/kaggle\/input\/movietweetings\/ratings.dat', sep='::', header=None)\nratings.columns = ['user_id', 'movie_id', 'rating', 'rating_timestamp']\nmovies = pd.read_csv('\/kaggle\/input\/movietweetings\/movies.dat', sep='::', header=None)\nmovies.columns = ['movie_id', 'movie_title', 'genres']","927957e1":"df = pd.merge(users, ratings, on='user_id', how='outer')\ndf = pd.merge(df, movies, on='movie_id', how='outer')\ndf = df.sort_values('rating_timestamp')\ndf","6cf3b790":"df['genres'] = df['genres'].str.split('|')\ngenres = df['genres'].str.join('|').str.get_dummies()\ngenres = genres.reset_index()\ngenres = genres.drop(['index'],axis=1)\ngenres","fc4625f7":"df = df.reset_index()\ndf = df.drop(['index', 'genres'], axis=1)\ndf","32056684":"df = pd.concat([df, genres], axis=1)\ndf","e652cea4":"df = df.drop(['user_id', 'movie_id'],axis=1)\ndf","26abc56d":"fig = px.histogram(df, \"rating\", nbins=11, title='Rank distribution')\nfig.show()","63e96f63":"data = df.groupby(['movie_title'])['rating'].mean().reset_index().sort_values('rating').tail(20)\nfig = px.bar(data, x=\"rating\", y=\"movie_title\", orientation='h', title='Top 20 movies with the highest ranking')\nfig.show()","f5bfe218":"tweets = df['movie_title'].value_counts().reset_index()\ntweets.columns = ['movie_title', 'total_tweets']\ndf = pd.merge(df, tweets, on='movie_title', how='inner')\ndf","0502b8c6":"data = df[df['total_tweets']>100].groupby(['movie_title'])['rating'].mean().reset_index().sort_values('rating').tail(20)\nfig = px.bar(data, x=\"rating\", y=\"movie_title\", orientation='h', title='Top 20 movies with the at least 100 votes')\nfig.show()","e61008e9":"Merging datasets into one dataframe","eee51404":"Reading and preprocessing data as pandas dataframes","8c91bf32":"One hot encoding for 'genres' column"}}