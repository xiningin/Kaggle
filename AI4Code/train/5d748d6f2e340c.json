{"cell_type":{"dd1dd63a":"code","520e8a6a":"code","75a63d07":"code","26d0210b":"code","8f4de794":"code","5bcfa661":"code","91d47f58":"code","c2039556":"code","7271c7e4":"code","7246e72a":"code","9e20038d":"code","787cbd6f":"code","6b454d70":"code","b4bf7570":"code","5349fdcb":"code","bb61a2ea":"code","89c4e227":"code","0bb8691b":"code","b0e53195":"code","be352fdf":"code","1829dcb5":"code","330b4e01":"code","0da8fa4a":"code","aee6175e":"code","d7558414":"markdown","238ff6d1":"markdown","498afed0":"markdown","ad964adc":"markdown","7263e64d":"markdown","995ec3bc":"markdown"},"source":{"dd1dd63a":"import numpy as np\nimport pandas as pd\n\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.model_selection import train_test_split\n\nfrom sklearn.linear_model import LinearRegression\nimport lightgbm as lgb\n\nfrom sklearn.metrics import mean_squared_error","520e8a6a":"data = pd.read_csv('..\/input\/craigslist-carstrucks-data\/vehicles.csv')","75a63d07":"data","26d0210b":"data.info()","8f4de794":"data.isna().sum()","5bcfa661":"null_columns = data.columns[data.isna().mean() > 0.25]\n\ndata = data.drop(null_columns, axis=1)","91d47f58":"data","c2039556":"unneeded_columns = ['id', 'url', 'region_url', 'image_url', 'description']\n\ndata = data.drop(unneeded_columns, axis=1)","7271c7e4":"data","7246e72a":"{column: len(data[column].unique()) for column in data.columns if data.dtypes[column] == 'object'}","9e20038d":"data = data.drop('model', axis=1)","787cbd6f":"def onehot_encode(df, columns, prefixes):\n    df = df.copy()\n    for column, prefix in zip(columns, prefixes):\n        dummies = pd.get_dummies(df[column], prefix=prefix)\n        df = pd.concat([df, dummies], axis=1)\n        df = df.drop(column, axis=1)\n    return df","6b454d70":"data = onehot_encode(\n    data,\n    ['region', 'fuel', 'title_status', 'transmission', 'state'],\n    ['reg', 'fuel', 'title', 'trans', 'state']\n)","b4bf7570":"data","5349fdcb":"for column in data.columns:\n    data[column] = data[column].fillna(data[column].mean())","bb61a2ea":"data.isna().sum().sum()","89c4e227":"y = data.loc[:, 'price']\nX = data.drop('price', axis=1)","0bb8691b":"scaler = StandardScaler()\n\nX = scaler.fit_transform(X)","b0e53195":"X_train, X_test, y_train, y_test = train_test_split(X, y, train_size=0.7, random_state=34)","be352fdf":"lin_model = LinearRegression()\n\nlin_model.fit(X_train, y_train)\n\nlin_y_preds = lin_model.predict(X_test)","1829dcb5":"lgb_model = lgb.LGBMRegressor(\n    boosting_type='gbdt',\n    num_leaves=31,\n    n_estimators=100,\n    reg_lambda=1.0\n)\n\nlgb_model.fit(X_train, y_train)\n\nlgb_y_preds = lgb_model.predict(X_test)","330b4e01":"lin_loss = np.sqrt(mean_squared_error(y_test, lin_y_preds))\nlgb_loss = np.sqrt(mean_squared_error(y_test, lgb_y_preds))","0da8fa4a":"print(\"Linear Regression RMSE:\", lin_loss)\nprint(\"Gradient Boosted RMSE:\", lgb_loss)","aee6175e":"print(\"Linear Regression R^2 Score:\", lin_model.score(X_test, y_test))\nprint(\"Gradient Boosted R^2 Score:\", lgb_model.score(X_test, y_test))","d7558414":"# Data Every Day  \n\nThis notebook is featured on Data Every Day, a YouTube series where I train models on a new dataset each day.  \n\n***\n\nCheck it out!  \nhttps:\/\/youtu.be\/bFKuw3JlvCI","238ff6d1":"# Training","498afed0":"# Task for Today  \n\n***\n\n## Used Car Price Prediction  \n\nGiven *data about used cars*, let's try to predict the **price** of a given car.  \n  \nWe will use linear regression and gradient boosting (LightGBM) to make our predictions.","ad964adc":"# Getting Started","7263e64d":"# Preprocessing","995ec3bc":"# Splitting and Scaling"}}