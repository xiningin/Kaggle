{"cell_type":{"6e8f3f67":"code","56cb939c":"code","3af4bd1c":"code","32c2ee1b":"code","d65e7432":"code","9aec858f":"code","6fc607a6":"code","ec08ea63":"code","bad4a705":"code","932afed6":"code","265c9580":"code","0c6644d5":"code","77dd7332":"code","d9d18f82":"code","d7b5eb0d":"code","67015998":"code","f9a37c69":"code","25cae08d":"code","9b228b89":"code","5d73cd60":"code","8152c37d":"code","631aeb4d":"code","aa011733":"code","f03bd448":"code","493a0fa5":"code","0e023239":"markdown","a0bcb3f8":"markdown","3fbd55a1":"markdown","334f37ec":"markdown","c1673f60":"markdown","c0c78c19":"markdown","77f4498f":"markdown","d38afb25":"markdown","160cf0bb":"markdown","2b753e3f":"markdown","404310ef":"markdown","2207f9f5":"markdown","f9aeba3d":"markdown","715ba21c":"markdown","b2c360bb":"markdown","2244e631":"markdown","9f180e3a":"markdown","8d1cde02":"markdown","5aa50639":"markdown","fcc017e3":"markdown"},"source":{"6e8f3f67":"import pandas as pd\nimport numpy as np\nimport tensorflow as tf\nimport matplotlib.pyplot as plt\nimport seaborn as sb\nfrom sklearn.preprocessing import StandardScaler, LabelEncoder","56cb939c":"wine_data = pd.read_csv('..\/input\/red-wine-quality-cortez-et-al-2009\/winequality-red.csv')\ndisplay(wine_data.head())","3af4bd1c":"display(wine_data.describe())\nwine_data['quality'].value_counts()","32c2ee1b":"wine_data.isnull().sum()","d65e7432":"fig , ax = plt.subplots(figsize = (10,7))\nsb.heatmap(wine_data.corr() , annot = True , ax = ax)\nplt.show()","9aec858f":"plt.figure(figsize = (10 , 7))\nsb.scatterplot(x = \"fixed acidity\", y = \"density\", hue = \"quality\",data = wine_data, alpha = 0.7, palette = \"Set1\")","6fc607a6":"from sklearn.ensemble import RandomForestRegressor\n\nmodel = RandomForestRegressor(random_state=1, max_depth=12)\nx = wine_data.drop(['quality'] , axis = 1)\nwd = pd.get_dummies(wine_data)\nmodel.fit(x, wine_data.quality)\ndisplay(model.feature_importances_)","ec08ea63":"features = wd.columns\nimportances = model.feature_importances_\nindices = np.argsort(importances)[:]\nplt.title('Feature Importances')\nplt.barh(range(len(indices)), importances[indices], color='b', align='center')\nplt.yticks(range(len(indices)), [features[i] for i in indices])\nplt.xlabel('Relative Importance')\nplt.show()","bad4a705":"del x['fixed acidity']\ndel x['free sulfur dioxide']\ndel x['citric acid']","932afed6":"le = LabelEncoder()\ny = le.fit_transform(wine_data.iloc[: , -1])\ny = pd.DataFrame(y.reshape(len(y),1))","265c9580":"from imblearn.over_sampling import SMOTE\n\nstrategy = {0:1700, 1:1700, 2:1700, 3:1700, 4:1700, 5:1700}\noversample = SMOTE(sampling_strategy=strategy)\nx, y = oversample.fit_resample(x, y)","0c6644d5":"x.shape","77dd7332":"from sklearn.model_selection import train_test_split\nx_train, x_test, y_train, y_test = train_test_split(x, y, test_size = 0.2, random_state = 0)","d9d18f82":"y_train_cat = tf.keras.utils.to_categorical(y_train, 6)\ny_test_cat = tf.keras.utils.to_categorical(y_test, 6)","d7b5eb0d":"sc = StandardScaler()\n\nx_train = sc.fit_transform(x_train)\nx_test = sc.fit_transform(x_test)","67015998":"ann = tf.keras.models.Sequential(layers = None , name = None)","f9a37c69":"ann.add(tf.keras.layers.Input(shape = 8,))","25cae08d":"ann.add(tf.keras.layers.Dense(units = 16 , activation = \"relu\" ))","9b228b89":"ann.add(tf.keras.layers.Dense(units = 8 , activation = \"relu\" ))","5d73cd60":"ann.add(tf.keras.layers.Dense(units = 6 , activation = \"sigmoid\"))","8152c37d":"ann.summary()","631aeb4d":"ann.compile(optimizer = 'adam' , loss = 'categorical_crossentropy' ,metrics= ['accuracy'])","aa011733":"history = ann.fit(x_train, y_train_cat,  batch_size= 32, epochs = 150 , validation_data = (x_test,y_test_cat))","f03bd448":"plt.plot(history.history['loss'], label='MAE training data')\nplt.plot(history.history['val_loss'], label='MAE validation data')\nplt.legend()\nplt.title('MAE for model')\nplt.ylabel('MAE')\nplt.xlabel('epoch')\nplt.show()","493a0fa5":"plt.plot(history.history['accuracy'], label='Accuracy training data')\nplt.plot(history.history['val_accuracy'], label='Accuracy validation data')\nplt.legend()\nplt.title('Model accuracy')\nplt.ylabel('Accuracy')\nplt.xlabel('epoch')\nplt.show()","0e023239":"Data provided by the UCI:\n     https:\/\/archive.ics.uci.edu\/ml\/datasets\/wine+quality ","a0bcb3f8":"<h2>Data preprocessing<\/h2>","3fbd55a1":"<h2>Exploratory Data Analysis<\/h2>","334f37ec":"<h3>Artificial neural network<\/h3>","c1673f60":"<h3>Imports<\/h3>","c0c78c19":"<h3>Handling misssing data<\/h3>","77f4498f":"<h4>Correlation matrix<\/h4>","d38afb25":"Libraries import","160cf0bb":"<h3>Features reduction<\/h3>","2b753e3f":"### Data Over sampling using SMOTE","404310ef":"[](http:\/\/)<h1>Red wine quality classifier using deep feedforward network<\/h1>","2207f9f5":"Data import","f9aeba3d":"<h4>Spliting data<\/h4>","715ba21c":"<h4>Removing the least important feautres according to the random forrest results<\/h4>","b2c360bb":"<h4>Encoding the quality<\/h4>","2244e631":"<h4>Transforming quality to categorical data<\/h4>","9f180e3a":"<h4>Scatter plot: Fixed acidity - Density<\/h4>","8d1cde02":"<h4>Using random forrest to analyse the feature importance<\/h4>","5aa50639":"<h2>Machine learning modeling<\/h2>","fcc017e3":"<h4>Scaling features<\/h4>"}}