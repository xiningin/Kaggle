{"cell_type":{"a1079068":"code","33d3a04c":"code","69de51c6":"code","360fb5f3":"code","e87e77a3":"code","ae33fb94":"code","a3dfaf36":"code","baf67645":"markdown"},"source":{"a1079068":"import os\nimport numpy as np\nimport pandas as pd\nimport json","33d3a04c":"pd.set_option(\"display.max_rows\", None)\npd.set_option(\"display.max_columns\", None)","69de51c6":"#read train.csv\ndf = pd.read_csv(\"..\/input\/train.csv\", index_col=3)","360fb5f3":"#specify json columns\njson_col = [\"device\", \"geoNetwork\", \"totals\", \"trafficSource\"]","e87e77a3":"#JSON to columns \nfor col in json_col:\n    tmp_array = np.array(df[col])\n    \n    tmp_jsonstr = []\n    for i in range(len(tmp_array)):\n        tmp_jsonstr.append(json.loads(tmp_array[i]))\n    \n    tmp_df = pd.DataFrame(tmp_jsonstr, index=df.index)\n    df = pd.concat([df, tmp_df], axis=1)\n        \n#     #each col to each dataframe \n#     exec(\"df_json_{} = pd.DataFrame(tmp_jsonstr, index={})\".format(col, index))","ae33fb94":"#resolve nested\ndf_adwordsClickInfo = pd.DataFrame(list(df[\"adwordsClickInfo\"]), index=df.index)\ndf = pd.concat([df, df_adwordsClickInfo], axis=1)","a3dfaf36":"df.head()","baf67645":"-EOF"}}