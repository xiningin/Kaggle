{"cell_type":{"2c429d51":"code","d6249733":"code","36a2704b":"code","07df0034":"code","c07c79b8":"code","0bba0a57":"code","d139d9b3":"code","eba98109":"code","b12bc3e5":"code","f5e2b358":"code","22e1e8cb":"code","acdcc80d":"code","9580cd35":"markdown","d49951c7":"markdown","2092971b":"markdown"},"source":{"2c429d51":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport plotly as py\nfrom sklearn.cluster import k_means\n\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","d6249733":"%config Completer.use_jedi = False","36a2704b":"data = pd.read_csv(\"..\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv\")\ndata.shape\n\n","07df0034":"import warnings\nwarnings.filterwarnings(\"ignore\")\nplt.style.use(\"fivethirtyeight\") #for styling the graph according to our needs\nplt.figure(1,(15,8))\nn=0\nfor x in ['Age' , 'Annual Income (k$)' , 'Spending Score (1-100)']:\n    n+=1\n    plt.subplot(1,3,n)\n    plt.subplots_adjust(hspace=0.5,wspace=0.5)\n    sns.distplot(data[x], bins=40)\nplt.show()\n    ","c07c79b8":"plt.figure(1,(15,5))\nsns.countplot(y=\"Gender\",data=data)\nplt.show()","0bba0a57":"\nimport warnings\nwarnings.filterwarnings(\"ignore\")\nplt.style.use(\"fivethirtyeight\") #for styling the graph according to our needs\nplt.figure(1,(15,7))\nn=0\nfor x in ['Age' , 'Annual Income (k$)' , 'Spending Score (1-100)']:\n    for y in ['Age' , 'Annual Income (k$)' , 'Spending Score (1-100)']:\n        n+=1\n    plt.subplot(3,3,n)\n    plt.subplots_adjust(hspace=0.5,wspace=0.5)\n    sns.regplot(x=x,y=y,data=data)\nplt.show()\n    ","d139d9b3":"plt.figure(1 , figsize = (15 , 7))\nn = 0 \nfor cols in ['Age' , 'Annual Income (k$)' , 'Spending Score (1-100)']:\n    n += 1 \n    plt.subplot(1 , 3 , n)\n    plt.subplots_adjust(hspace = 0.5 , wspace = 0.5)\n    sns.violinplot(x = cols , y = 'Gender' , data = data , palette = 'vlag')\n    sns.swarmplot(x = cols , y = 'Gender' , data = data)\n    plt.ylabel('Gender' if n == 1 else '')\n    plt.title('Boxplots & Swarmplots' if n == 2 else '')\nplt.show()","eba98109":"from sklearn.cluster import KMeans\nX=data[[\"Age\",\"Spending Score (1-100)\"]]\nX.values\ninertia = []\nfor n in range(1 , 11):\n    algorithm = (KMeans(n_clusters = n ,init='k-means++', n_init = 10 ,max_iter=300, \n                        tol=0.0001,  random_state= 111  , algorithm='elkan') )\n    algorithm.fit(X)\n    inertia.append(algorithm.inertia_)\nprint(inertia)","b12bc3e5":"plt.figure(1 , figsize = (15 ,6))\nplt.plot(np.arange(1 , 11) , inertia , 'o')\nplt.plot(np.arange(1 , 11) , inertia , '-')\nplt.show()","f5e2b358":"algorithm = (KMeans(n_clusters = 4 ,init='k-means++', n_init = 10 ,max_iter=300, \n                        tol=0.0001,  random_state= 111  , algorithm='elkan') )\nalgorithm.fit(X)\nlabels = algorithm.labels_\ncentroids = algorithm.cluster_centers_\n# print(labels)\n# print(centroids)\n#ravel() is used to return ndarray containing data  of given series object","22e1e8cb":"h = 0.02\nx_min, x_max = X.iloc[:, 0].values.min() - 1, X.iloc[:, 0].values.max() + 1\ny_min, y_max = X.iloc[:, 1].values.min() - 1, X.iloc[:, 1].values.max() + 1\nxx, yy = np.meshgrid(np.arange(x_min, x_max, h), np.arange(y_min, y_max, h))\nZ = algorithm.predict(np.c_[xx.ravel(), yy.ravel()])","acdcc80d":"\n\nplt.figure(1 , figsize = (15 , 7) )\nplt.clf()\nZ = Z.reshape(xx.shape)\nplt.imshow(Z , interpolation='nearest', \n           extent=(xx.min(), xx.max(), yy.min(), yy.max()),\n           cmap = plt.cm.Pastel2, aspect = 'auto', origin='lower')\n\nplt.scatter( x = 'Age' ,y = 'Spending Score (1-100)' , data = data , c = labels, \n            s = 200 )\nplt.scatter(x = centroids[: , 0] , y =  centroids[: , 1] , s = 300 , c = 'red' , alpha = 0.5)\nplt.ylabel('Spending Score (1-100)') , plt.xlabel('Age')\nplt.show()\n\n","9580cd35":"segmentation based on age and spending score","d49951c7":"# For 3d graph\n\ndata['label3'] =  labels3\ntrace1 = go.Scatter3d(\n    x= df['Age'],\n    y= df['Spending Score (1-100)'],\n    z= df['Annual Income (k$)'],\n    mode='markers',\n     marker=dict(\n        color = df['label3'], \n        size= 20,\n        line=dict(\n            color= df['label3'],\n            width= 12\n        ),\n        opacity=0.8\n     )\n)\ndata = [trace1]\nlayout = go.Layout(\n#     margin=dict(\n#         l=0,\n#         r=0,\n#         b=0,\n#         t=0\n#     )\n    title= 'Clustf['label3'] =  labels3\ntrace1 = go.Scatter3d(\n    x= df['Age'],\n    y= df['Spending Score (1-100)'],\n    z= df['Annual Income (k$)'],\n    mode='markers',\n     marker=dict(\n        color = df['label3'], \n        size= 20,\n        line=dict(\n            color= df['label3'],\n            width= 12\n        ),\n        opacity=0.8\n     )\n)\ndata = [trace1]\nlayout = go.Layout(\n#     margin=dict(\n#         l=0,\n#         r=0,\n#         b=0,\n#         t=0\n#     )\n    title= 'Clusters',\n    scene = dict(\n            xaxis = dict(title  = 'Age'),\n            yaxis = dict(title  = 'Spending Score'),\n            zaxis = dict(title  = 'Annual Income')\n        )\n)\nfig = go.Figure(data=data, layout=layout)\npy.offline.iplot(fig)ers',\n    scene = dict(\n            xaxis = dict(title  = 'Age'),\n            yaxis = dict(title  = 'Spending Score'),\n            zaxis = dict(title  = 'Annual Income')\n        )\n)\nfig = go.Figure(data=data, layout=layout)\npy.offline.iplot(fig)","2092971b":"Data visualisation"}}