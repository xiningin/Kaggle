{"cell_type":{"bac1ea3a":"code","c0569bf7":"code","965e2012":"code","fa02fecf":"code","273820a8":"code","f720fbda":"code","b8f1e8ab":"code","a49e8cda":"code","679f676c":"code","a5d0910d":"code","3f578b77":"code","dd4cbf28":"code","98f222cc":"code","393b077e":"code","b8210d72":"code","9cc696e0":"code","3dae56b4":"markdown","58ec07db":"markdown","540f3383":"markdown","ce344735":"markdown","931921ca":"markdown","a4af0a68":"markdown","d9898f33":"markdown","e1857198":"markdown","424b9dba":"markdown","85832555":"markdown","196529d2":"markdown"},"source":{"bac1ea3a":"import numpy as np # \u6570\u7ec4\u5e38\u7528\u5e93\nimport pandas as pd # \u8bfb\u5165csv\u5e38\u7528\u5e93\nfrom sklearn.linear_model import LinearRegression # sk-learn\u5e93Linear Regression\u6a21\u578b\nfrom sklearn.model_selection import train_test_split # sk-learn\u5e93\u8bad\u7ec3\u4e0e\u6d4b\u8bd5\nfrom sklearn import metrics # \u751f\u6210\u5404\u9879\u6d4b\u8bd5\u6307\u6807\u5e93\nimport matplotlib.pyplot as plt # \u753b\u56fe\u5e38\u7528\u5e93\nimport math #\u6570\u5b66\u5e93","c0569bf7":"data = pd.read_csv(\"..\/input\/kc_house_data.csv\")","965e2012":"data.dtypes","fa02fecf":"origin_X_train = data[['bedrooms','bathrooms','sqft_living','floors']]\norigin_y_train = data['price']","273820a8":"X_train, X_vali, y_train, y_vali = train_test_split(origin_X_train, origin_y_train, test_size = 0.2, random_state = 0)","f720fbda":"X_train = np.asmatrix(X_train)\nX_vali = np.asmatrix(X_vali)\ny_train = np.ravel(y_train)\ny_vali = np.ravel(y_vali)","b8f1e8ab":"plt.scatter(origin_X_train[\"sqft_living\"], origin_y_train)\nplt.show()","a49e8cda":"origin_X_train[\"sqft_living\"].hist()\nplt.show()","679f676c":"# \u5efa\u7acb\u7ebf\u6027\u56de\u5f52\u6a21\u578b\nmodel = LinearRegression()\n# \u8bad\u7ec3\u6a21\u578b\nmodel.fit(X_train, y_train)","a5d0910d":"pd.DataFrame(list(zip(origin_X_train.columns, np.transpose(model.coef_))))","3f578b77":"model.intercept_","dd4cbf28":"#\u4e00\u4e2a\u623f\u5b50\uff0c3\u4e2a\u5367\u5ba4\uff0c2\u4e2a\u536b\u751f\u95f4\uff0c2500sqft\uff0c2\u5c42\u697c\uff0c\u9884\u6d4b\u623f\u4ef7\nmodel.predict([[3, 2, 2500, 2]])\n\npredictions_train = model.predict(X_train)","98f222cc":"mse_train = ((predictions_train - y_train) ** 2).sum() \/ len(X_train)\nprint(\"mse_train=\", mse_train)","393b077e":"md_train = (abs(predictions_train - y_train) \/ y_train).sum() \/ len(X_train)\nprint(\"md_train=\", md_train)","b8210d72":"predictions_vali = model.predict(X_vali)\nmse_vali = ((predictions_vali - y_vali) ** 2).sum() \/ len(X_vali)\nprint(\"mse_vali=\", mse_vali)","9cc696e0":"md_vali = (abs(predictions_vali - y_vali) \/ y_vali).sum() \/ len(X_vali)\nprint(\"md_vali=\", md_vali)","3dae56b4":"\u7528xtrain\u548cytrain\u8bad\u7ec3\u6a21\u578b","58ec07db":"\u4ece..\/input\/kc_house_data.csv\u6587\u4ef6\u4e2d\u8bfb\u5165\u6570\u636e","540f3383":"\u8bad\u7ec3\u96c6\u4e0a\u7684\u5747\u65b9\u5deeMSE","ce344735":"\u89c2\u5bdf\u751f\u6d3b\u9762\u79ef\u5206\u5e03","931921ca":"\u83b7\u5f972:1\u7684\u8bad\u7ec3\uff1a\u6d4b\u8bd5\u6570\u636e\u6bd4\u4f8b","a4af0a68":"\u9a8c\u8bc1\u96c6\u5408\u4e0a\u7684MD","d9898f33":"\u89c2\u5bdf\u623f\u4ef7\u548c\u751f\u6d3b\u9762\u79ef\u7684\u5173\u7cfb","e1857198":"# Linear Regression\u9884\u6d4b\u623f\u4ef7","424b9dba":"\u83b7\u5f97\u81ea\u53d8\u91cfX\u548c\u56e0\u53d8\u91cfY","85832555":"\u5e73\u5747\u76f8\u5bf9\u8bef\u5dee","196529d2":"\u9a8c\u8bc1\u96c6\u5408\u4e0a\u7684MSE"}}