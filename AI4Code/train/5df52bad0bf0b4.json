{"cell_type":{"be8535ca":"code","736a7f7a":"code","815f6c78":"code","3c3fbb97":"code","f5e9ba3e":"code","e083a95d":"code","d863764b":"code","4b670268":"code","5ef7f4df":"code","8b391f84":"code","8f2a5139":"code","2e97f40b":"code","6b00e858":"markdown","64b796bc":"markdown","3b86f1e3":"markdown","3147b03a":"markdown","4877ed8f":"markdown","5cb68152":"markdown","3527613d":"markdown","2ffb2633":"markdown","fcf45446":"markdown","ed634e26":"markdown","25cc517a":"markdown","53ad926f":"markdown","57ada5b3":"markdown","bef6302f":"markdown"},"source":{"be8535ca":"# You can easily install the library using pip\n!pip install h2o","736a7f7a":"# And then load the libraries you'll use in this notebook\nimport pandas as pd\nimport matplotlib.pyplot as plt\n%matplotlib inline\n\n\nimport h2o\nfrom h2o.automl import H2OAutoML","815f6c78":"# Initialize your cluster\nh2o.init()","3c3fbb97":"train = h2o.import_file('\/kaggle\/input\/house-prices-advanced-regression-techniques\/train.csv')\ntest = h2o.import_file('\/kaggle\/input\/house-prices-advanced-regression-techniques\/test.csv')\ntrain.head()","f5e9ba3e":"train = train[train['GrLivArea'] < 4500]\ntrain['SalePrice'] = train['SalePrice'].log1p()","e083a95d":"# Identify predictors and response\nx = [col for col in train.columns if col not in ['Id','SalePrice']]\ny = 'SalePrice'\ntest_id = test['Id']","d863764b":"aml = H2OAutoML(max_models = 30, max_runtime_secs=300, seed = 1, stopping_metric = 'RMSLE')\naml.train(x = x, y = y, training_frame = train)","4b670268":"lb = aml.leaderboard; lb","5ef7f4df":"aml.leader","8b391f84":"aml.leader.varimp_plot()","8f2a5139":"preds = aml.leader.predict(test)","2e97f40b":"# Convert results back(they had been transformed using log, remember?) and save them in a csv format.\nresult = preds.expm1()\nsub = test_id.cbind(result)\nsub.columns = ['Id','SalePrice']\nsub = sub.as_data_frame()\nsub.to_csv('submission.csv', index = False)","6b00e858":"Let's now create our model:","64b796bc":"### Predict","3b86f1e3":"### Load libraries","3147b03a":"This quick tutorial shows how you can use H2o AutoML to train and evaluate a large amount of models with only a few lines of coding.\nPlease, upvote if you find it useful.","4877ed8f":"I won't perform neither EDA nor Feature Engineering as these are not the focus of this kernel. At least not an extensive one. Here I'll only drop registers whose `GrLivArea` are above 4500 and log transform the target variable `SalePrice`.","5cb68152":"The Leaderboard displays the performance of the trained models","3527613d":"You can simply call predict on your best model","2ffb2633":"### EDA, Data Processing and Feature Engineering","fcf45446":"### Using H2o AutoML","ed634e26":"# *Using H2o AutoML to predict housing prices*","25cc517a":"### Load train and test datasets","53ad926f":"It also gives you the Feature Importance","57ada5b3":"The attribute `leader` of your AutoML object holds the data about your best model.","bef6302f":"The H2OAutoML function is quite easy to use. You specify the dataset you will use for training at `training_frame`, while `x` and `y` receives the column names of the features which will be used and the name of the target variable, respectively.\n\nYou can customize your AutoML to fit your needs. You can add or exclude algorithms, set nfolds for cross-validation, choose metrics, use validation sets, early stopping and so on. Please check the documentation at http:\/\/docs.h2o.ai\/h2o\/latest-stable\/h2o-docs\/automl.html"}}