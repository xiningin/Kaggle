{"cell_type":{"95ef2b31":"code","daca71f8":"code","4134da04":"code","eb93cc6d":"code","f3d3c29b":"code","7225d65a":"code","b15f1e71":"code","8e74aa29":"code","97d8a845":"code","dbf9d972":"code","ab804488":"code","8756c293":"code","0e6e1163":"code","01f512b4":"code","5a4ca1e0":"code","c1e39209":"code","07b4abdc":"code","af4e5b0d":"code","dff3c322":"code","aacbba0f":"code","fe5feb7d":"code","cd654b9d":"code","5f6a131d":"code","83298c3e":"code","5ecdfadd":"code","3f6c8b7b":"code","86e0be70":"code","f4e27c64":"code","2db600bb":"code","0d385197":"code","48a53741":"code","c7a0b9a5":"code","48498b29":"code","212c113d":"code","31791803":"code","ab1e1c2c":"code","78dfe51a":"code","528de5ca":"code","7e13cd7e":"code","3024d6dd":"code","b25cc079":"code","a20c8887":"code","60561b57":"code","302b71fc":"code","8c6d4e87":"code","2b174484":"code","f4765299":"code","992a366b":"code","8b275a09":"code","b992492e":"code","4515b477":"code","ac4272dc":"code","479f8ec9":"code","5d95ca7c":"code","0a166106":"code","d342be56":"code","e25943ef":"code","89796dac":"code","a59476c3":"code","8885a5a4":"markdown","18ebfb64":"markdown","6f725219":"markdown","6cf361ab":"markdown","68a198f2":"markdown","452eef60":"markdown","70e024cd":"markdown","58c8b068":"markdown","609483b6":"markdown","09497e85":"markdown","f4850dd4":"markdown","6e994d94":"markdown","f29c6cc9":"markdown","84db87bf":"markdown","d0f39e3d":"markdown","904a82a3":"markdown","4d95309b":"markdown","f2d2d39f":"markdown","a58895b7":"markdown","b205c46c":"markdown","110a25e1":"markdown","10621786":"markdown","809b68c7":"markdown","e55facbc":"markdown","a9738054":"markdown","7600608f":"markdown","5deb7536":"markdown","16b24a27":"markdown"},"source":{"95ef2b31":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.metrics import accuracy_score, cohen_kappa_score  #Classification metrics\nfrom sklearn.metrics import mean_squared_error, r2_score #Regression metrics\n\nfrom sklearn.ensemble import RandomForestRegressor , RandomForestClassifier\nfrom sklearn.preprocessing import StandardScaler\n\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.tree import DecisionTreeClassifier\nimport os\n","daca71f8":"diamond = pd.read_csv(\"..\/input\/diamonds.csv\")","4134da04":"diamond.info()","eb93cc6d":"diamond.head()","f3d3c29b":"diamond=diamond.drop('Unnamed: 0',axis=1)","7225d65a":"diamond.head()","b15f1e71":"diamond.isnull().sum()","8e74aa29":"sns.distplot(diamond.carat , color = 'red')","97d8a845":"sns.distplot(diamond.depth , color = 'green')","dbf9d972":"sns.distplot(diamond.table , color = 'yellow')","ab804488":"sns.distplot(diamond.price , color = 'blue')","8756c293":"plt.figure(1,figsize=[10,7])\nplt.subplot(221)\nsns.distplot(diamond.x)\n\nplt.subplot(222)\nsns.distplot(diamond.y)\n\nplt.subplot(223)\nsns.distplot(diamond.z)\n\nplt.show()","0e6e1163":"diamond.cut.unique()  # count 5","01f512b4":"diamond.color.unique()   # count 7","5a4ca1e0":"diamond.clarity.unique()   # count 8","c1e39209":"diamond.head()","07b4abdc":"plt.scatter(diamond.carat , diamond.price)\nplt.xlabel('Carat')\nplt.ylabel('Price')\nplt.show()","af4e5b0d":"plt.scatter(diamond.depth , diamond.price)\nplt.xlabel('Depth')\nplt.ylabel('Price')\nplt.show()","dff3c322":"plt.scatter(diamond.table , diamond.price)\nplt.xlabel('Table')\nplt.ylabel('Price')\nplt.show()","aacbba0f":"plt.figure(1,figsize=[10,7])\nplt.subplot(221)\nplt.scatter(diamond.x , diamond.price)\nplt.xlabel('x')\nplt.ylabel('Price')\n\nplt.subplot(222)\nplt.scatter(diamond.y , diamond.price)\nplt.xlabel('y')\nplt.ylabel('Price')\n\nplt.subplot(223)\nplt.scatter(diamond.z , diamond.price)\nplt.xlabel('z')\nplt.ylabel('Price')\nplt.show()","fe5feb7d":"sns.boxplot(diamond.cut , diamond.price)","cd654b9d":"diamond.groupby('cut').price.median()","5f6a131d":"diamond.groupby('cut').price.mean()","83298c3e":"sns.boxplot(diamond.color , diamond.price)\nplt.show()\n# color vs price","5ecdfadd":"sns.boxplot(diamond.clarity , diamond.price)\nplt.show()","3f6c8b7b":"plt.figure(figsize=[7,6])\nsns.heatmap(diamond.corr() , annot = True)\nplt.show()","86e0be70":"diamond.isnull().sum()","f4e27c64":"X=diamond.drop('price',axis = 1)\ny=diamond.price","2db600bb":"X_train, X_test, y_train, y_test = train_test_split(X,y,test_size=0.3)","0d385197":"dummyXtrain = pd.get_dummies(X_train)\ndummyXtest = pd.get_dummies(X_test)","48a53741":"dummyXtrain.head()","c7a0b9a5":"lr = LinearRegression()","48498b29":"lr.fit(dummyXtrain,y_train)","212c113d":"y_pred = lr.predict(dummyXtest)","31791803":"mean_squared_error(y_test,y_pred)","ab1e1c2c":"lr.score(dummyXtest,y_test)","78dfe51a":"rfr = RandomForestRegressor()","528de5ca":"rfr.fit(dummyXtrain,y_train)","7e13cd7e":"y_pred = rfr.predict(dummyXtest)","3024d6dd":"rfr.score(dummyXtest,y_test)   #r2_score","b25cc079":"mean_squared_error(y_test,y_pred)","a20c8887":"diamond.head()","60561b57":"X=diamond.drop('cut',axis=1)","302b71fc":"y=diamond.cut","8c6d4e87":"diamond.cut.unique()","2b174484":"X_train, X_test, y_train, y_test = train_test_split(X,y,test_size=0.3,random_state=100)","f4765299":"dummyXtrain = pd.get_dummies(X_train)\ndummyXtest = pd.get_dummies(X_test)","992a366b":"knn = KNeighborsClassifier()","8b275a09":"knn.fit(dummyXtrain,y_train)","b992492e":"y_pred = knn.predict(dummyXtest)","4515b477":"accuracy_score(y_test,y_pred)","ac4272dc":"dtree = DecisionTreeClassifier()","479f8ec9":"dtree.fit(dummyXtrain,y_train)","5d95ca7c":"y_pred = dtree.predict(dummyXtest)","0a166106":"accuracy_score(y_test,y_pred)","d342be56":"rfr = RandomForestClassifier()","e25943ef":"rfr.fit(dummyXtrain,y_train)","89796dac":"y_pred = rfr.predict(dummyXtest)","a59476c3":"accuracy_score(y_test,y_pred)","8885a5a4":"### Problem : Analyze diamonds by their cut, color, clarity, price, and other attributes","18ebfb64":"Table seems to follow normal distribution.","6f725219":"### Random Forest regressor","6cf361ab":"### Linear Regression","68a198f2":"Mean price for different types of cuts is in following order: \n\n    Premium > Fair > Very Good > Good > Ideal","452eef60":"###  DATA HANDLING","70e024cd":"### Checking for null values","58c8b068":"depth seems to follow normal distribution.","609483b6":"### Random Forest Classifier","09497e85":"### Content\nprice price in US dollars (\\$326--\\$18,823)\n\ncarat weight of the diamond (0.2--5.01)\n\ncut quality of the cut (Fair, Good, Very Good, Premium, Ideal)\n\ncolor diamond colour, from J (worst) to D (best)\n\nclarity a measurement of how clear the diamond is (I1 (worst), SI2, SI1, VS2, VS1, VVS2, VVS1, IF (best))\n\nx length in mm (0--10.74)\n\ny width in mm (0--58.9)\n\nz depth in mm (0--31.8)\n\ndepth total depth percentage = z \/ mean(x, y) = 2 * z \/ (x + y) (43--79)\n\ntable width of top of diamond relative to widest point (43--95)","f4850dd4":"### KNN","6e994d94":"#### Getting sense of the data","f29c6cc9":"### One hot encoding","84db87bf":"It seems that table and price are not correlated.","d0f39e3d":"With small increase in carat value the price increases by large value.","904a82a3":"Upward trend can be seen between x and price. For y and z no relation is visible.","4d95309b":"Price is right skewed.","f2d2d39f":"### Bivariate analysis","a58895b7":"### Classification","b205c46c":"### NULL value treatment","110a25e1":"No null values found.","10621786":"### Decision Tree Classifier ","809b68c7":"Carat vs Price","e55facbc":"## Dropping unneccesary column","a9738054":"### Univariate Analysis","7600608f":"It seems that depth and price are not correlated.","5deb7536":"Carat is right skewed.\nAnd we can see multiple peaks in the data. Which suggests there are different types of diamonds.","16b24a27":"price is highly correlated with carat, x, y and z.\n\nBut there is also high correlation among carat, x, y and z."}}