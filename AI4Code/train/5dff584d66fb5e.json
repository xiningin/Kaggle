{"cell_type":{"bca11e8c":"code","16f2b5e0":"code","9034f49d":"code","f9ad9ae9":"code","8b9aeebb":"code","36fc5023":"code","a0ecaaad":"code","60cc293d":"code","03a2d544":"code","3e8bf037":"code","7e3fcdf2":"code","522f85e6":"code","2e60a544":"code","3e25ecbb":"code","56bf9e32":"code","5cb4112b":"code","ff403176":"code","50d90916":"code","d251cfcf":"code","40396a80":"code","09c69e1c":"code","360c0b9f":"code","eb6cce3b":"code","ca1842d8":"code","fcd09c35":"code","b7549abb":"code","b19ca7b8":"code","41172e68":"code","a94a8620":"code","1b1839ef":"code","5569a367":"code","1b0bd786":"code","f5812990":"code","ac9ab985":"code","564bd481":"code","c3650946":"code","aa6e7619":"code","1448469a":"code","7a9839a5":"code","0998d688":"code","8016624f":"code","3b96fa33":"code","4d118660":"code","2e30e6cf":"code","577745d7":"code","be8005d3":"code","48cc2bc2":"code","9246ab3f":"markdown","0d2fab6b":"markdown","4f8f01bf":"markdown","ce207a5c":"markdown","327398ce":"markdown","14f1f040":"markdown","79736817":"markdown","cd183c74":"markdown","06ac7203":"markdown","408f5999":"markdown","a59e469f":"markdown","591ff994":"markdown","01432420":"markdown","59b1774f":"markdown","fc65fbb4":"markdown","a7be55e5":"markdown","7c31db93":"markdown","028c2211":"markdown","d5847f9c":"markdown","4629723a":"markdown","c0bab1f0":"markdown","246f0fb3":"markdown","82a37306":"markdown","85ab3a9f":"markdown","f6e9b306":"markdown","b923fd86":"markdown","8720bb9a":"markdown","d37c987b":"markdown","9d87356c":"markdown","773f8207":"markdown","8cb67efd":"markdown","872b5c24":"markdown","c9790ebb":"markdown","975ca927":"markdown","98c6997b":"markdown","b2b161f0":"markdown"},"source":{"bca11e8c":"!pip install scikit-learn -U","16f2b5e0":"from sklearn.metrics import roc_auc_score\n\ny_true = [\n    0,\n    1,\n    1,\n    0,\n    1\n]\n\ny_predictions = [\n    0.1,\n    0.9,\n    0.4,\n    0.6,\n    0.61\n]\n\nroc_auc_score(y_true, y_predictions)","9034f49d":"import pandas as pd\nimport numpy as np\nfrom matplotlib import pyplot as plt","f9ad9ae9":"data = pd.read_csv('\/kaggle\/input\/advanced-dls-spring-2021\/train.csv')","8b9aeebb":"# \u0414\u043b\u044f \u0432\u0430\u0448\u0435\u0433\u043e \u0443\u0434\u043e\u0431\u0441\u0442\u0432\u0430 \u0441\u043f\u0438\u0441\u043a\u0438 \u0441 \u0438\u043c\u0435\u043d\u0430\u043c\u0438 \u0440\u0430\u0437\u043d\u044b\u0445 \u043a\u043e\u043b\u043e\u043d\u043e\u043a\n\n# \u0427\u0438\u0441\u043b\u043e\u0432\u044b\u0435 \u043f\u0440\u0438\u0437\u043d\u0430\u043a\u0438\nnum_cols = [\n    'ClientPeriod',\n    'MonthlySpending',\n    'TotalSpent'\n]\n\n# \u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0430\u043b\u044c\u043d\u044b\u0435 \u043f\u0440\u0438\u0437\u043d\u0430\u043a\u0438\ncat_cols = [\n    'Sex',\n    'IsSeniorCitizen',\n    'HasPartner',\n    'HasChild',\n    'HasPhoneService',\n    'HasMultiplePhoneNumbers',\n    'HasInternetService',\n    'HasOnlineSecurityService',\n    'HasOnlineBackup',\n    'HasDeviceProtection',\n    'HasTechSupportAccess',\n    'HasOnlineTV',\n    'HasMovieSubscription',\n    'HasContractPhone',\n    'IsBillingPaperless',\n    'PaymentMethod'\n]\n\nfeature_cols = num_cols + cat_cols\ntarget_col = 'Churn'","36fc5023":"data.sample(10)","a0ecaaad":"data.info()","60cc293d":"data[pd.to_numeric(data['TotalSpent'], errors='coerce').isnull()]","03a2d544":"data['TotalSpent'] = pd.to_numeric(data['TotalSpent'], errors='coerce')","3e8bf037":"data.info()","7e3fcdf2":"data.isnull().sum()","522f85e6":"data[data['TotalSpent'].isnull()]","2e60a544":"%matplotlib inline","3e25ecbb":"import seaborn as sns","56bf9e32":"sns.pairplot(data=data[num_cols])","5cb4112b":"sns.pairplot(data=data[num_cols + [target_col]], vars=num_cols, hue=target_col)","ff403176":"for cat_col in cat_cols:\n  print(data[cat_col].value_counts(), '\\n')","50d90916":"fig, ax = plt.subplots(8, 2, figsize=(15, 15))\n\nfor i in range(8):\n  for j in range(2):\n    sns.countplot(y=data[cat_cols[i + 4 * j]], ax=ax[i][j], orient='h')\n\nplt.tight_layout()","d251cfcf":"data[target_col].value_counts()","40396a80":"data[target_col].value_counts()[0] \/ data[target_col].value_counts()[1]","09c69e1c":"sns.countplot(data=data, x=target_col)","360c0b9f":"X_train = data[num_cols + cat_cols].copy()\ny_train = data[target_col].copy()","eb6cce3b":"from sklearn.linear_model import LogisticRegression, LogisticRegressionCV\nfrom sklearn.model_selection import train_test_split, GridSearchCV\nfrom sklearn.preprocessing import StandardScaler, RobustScaler, LabelEncoder, OneHotEncoder, QuantileTransformer\nfrom sklearn.pipeline import make_pipeline, Pipeline\nfrom sklearn.compose import ColumnTransformer\nfrom sklearn.impute import SimpleImputer","ca1842d8":"num_pipeline = Pipeline([('imputer', SimpleImputer(strategy='constant', fill_value=0)),\n                         ('qtr', QuantileTransformer())])\ncat_pipeline = Pipeline([('ohe', OneHotEncoder(drop='if_binary'))])\n\ntrf = ColumnTransformer([('num_cols', num_pipeline, num_cols),\n                         ('cat_cols', cat_pipeline, cat_cols)])\n\nlr = Pipeline([('trf', trf), ('lr', LogisticRegression(random_state=42))])\n\nlr_g = GridSearchCV(lr, {'lr__C': [100, 10, 1, 0.1, 0.01, 0.001]}, scoring='roc_auc')","fcd09c35":"lr_g.fit(X_train, y_train)","b7549abb":"roc_auc_score(y_train, lr_g.predict_proba(X_train)[:, 1])","b19ca7b8":"lr_g.best_params_","41172e68":"!pip install catboost","a94a8620":"from catboost import CatBoostClassifier\nimport catboost","1b1839ef":"X_train_, X_valid, y_train_, y_valid = train_test_split(X_train, y_train, random_state=42)","5569a367":"c_default = CatBoostClassifier(cat_features=cat_cols, random_seed=42, verbose=False)","1b0bd786":"c_default.fit(X_train_, y_train_)","f5812990":"roc_auc_score(y_valid, c_default.predict_proba(X_valid)[:, 1])","ac9ab985":"catboost_param_grid = {'iterations':[500, 1000, 1500],\n                       'learning_rate':[0.1, 0.2, 0.3]}","564bd481":"c_grid = CatBoostClassifier(cat_features=cat_cols, random_seed=42, verbose=False)","c3650946":"c_grid.grid_search(catboost_param_grid, X_train, y=y_train)","aa6e7619":"c_grid.get_params()","1448469a":"c_grid.get_all_params()","7a9839a5":"roc_auc_score(y_train, c_grid.predict_proba(X_train)[:, 1])","0998d688":"catboost_param_grid_2 = {'depth':[1, 2, 3, 4, 5],\n                       'l2_leaf_reg':[1, 3, 5, 10, 20, 30]}","8016624f":"c_grid_2 = CatBoostClassifier(cat_features=cat_cols, random_seed=42, verbose=False)","3b96fa33":"c_grid_2.grid_search(catboost_param_grid_2, X_train, y=y_train)","4d118660":"c_grid_2.get_params()","2e30e6cf":"c_grid_2.get_all_params()","577745d7":"roc_auc_score(y_train, c_grid_2.predict_proba(X_train)[:, 1])","be8005d3":"best_model = c_grid_2","48cc2bc2":"X_test = pd.read_csv('\/kaggle\/input\/advanced-dls-spring-2021\/test.csv')\n\nX_test['TotalSpent'] = pd.to_numeric(X_test['TotalSpent'], errors='coerce')\n\nsubmission = pd.read_csv('\/kaggle\/input\/advanced-dls-spring-2021\/submission.csv')\n\nsubmission['Churn'] = best_model.predict_proba(X_test)[:, 1]\nsubmission.to_csv('.\/my_submission.csv', index=False)","9246ab3f":"ROC-AUC \u043d\u0430 Kaggle: 0.85138","0d2fab6b":"\u041b\u043e\u0433\u0438\u0441\u0442\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u0440\u0435\u0433\u0440\u0435\u0441\u0441\u0438\u044f \u043d\u0435 \u0443\u043c\u0435\u0435\u0442 \u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c \u0441 \u043f\u0440\u043e\u043f\u0443\u0449\u0435\u043d\u043d\u044b\u043c\u0438 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f\u043c\u0438, \u043f\u043e\u044d\u0442\u043e\u043c\u0443 NaN \u0432 TotalSpent \u043f\u0440\u0438\u0434\u0435\u0442\u0441\u044f \u043d\u0430 \u0447\u0442\u043e-\u0442\u043e \u0437\u0430\u043c\u0435\u043d\u0438\u0442\u044c (\u043f\u0440\u043e\u0441\u0442\u043e \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0442\u0430\u043a\u0438\u0435 \u0441\u0442\u0440\u043e\u043a\u0438 \u043d\u0435 \u0432\u044b\u0439\u0434\u0435\u0442, \u043f\u043e\u0442\u043e\u043c\u0443 \u0447\u0442\u043e \u043d\u0430 \u0442\u0435\u0441\u0442\u043e\u0432\u043e\u0439 \u0432\u044b\u0431\u043e\u0440\u043a\u0435 \u043e\u043d\u0438 \u0442\u043e\u0436\u0435 \u0432\u0441\u0442\u0440\u0435\u0447\u0430\u044e\u0442\u0441\u044f). \u0415\u0441\u043b\u0438 \u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u043d\u0430 NaN, \u0442\u043e \u043e\u043d\u0438 \u0432\u0441\u0442\u0440\u0435\u0447\u0430\u044e\u0442\u0441\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u0443 \u0442\u0435\u0445 \u043a\u043b\u0438\u0435\u043d\u0442\u043e\u0432, ClientPeriod \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u0440\u0430\u0432\u0435\u043d \u043d\u0443\u043b\u044e. \u041c\u043e\u0436\u043d\u043e \u0441\u0434\u0435\u043b\u0430\u0442\u044c \u043f\u0440\u0435\u0434\u043f\u043e\u043b\u043e\u0436\u0435\u043d\u0438\u0435, \u0447\u0442\u043e \u044d\u0442\u0438 \u043a\u043b\u0438\u0435\u043d\u0442\u044b \u0435\u0449\u0435 \u043d\u0435 \u0443\u0441\u043f\u0435\u043b\u0438 \u0432\u043e\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0443\u0441\u043b\u0443\u0433\u0430\u043c\u0438 \u0438\u043b\u0438 \u0438\u043c \u043f\u043e\u043a\u0430 \u043d\u0435 \u0432\u044b\u0441\u0442\u0430\u0432\u0438\u043b\u0438 \u0441\u0447\u0435\u0442, \u043f\u043e\u044d\u0442\u043e\u043c\u0443 NaN \u043c\u044b \u0437\u0430\u043c\u0435\u043d\u0438\u043c \u043d\u0430 0 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e SimpleImputer.\n\n\u041f\u043e\u0441\u043b\u0435 \u0447\u0435\u0433\u043e \u043f\u0440\u0438\u043c\u0435\u043d\u0438\u043c QuantileTransformer \u043a \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u043c \u043f\u0440\u0438\u0437\u043d\u0430\u043a\u0430\u043c \u0438 OneHotEncoder \u043a \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0430\u043b\u044c\u043d\u044b\u043c.","4f8f01bf":"# \u041a\u0430\u043a \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0442\u044c?\n\n\u0421\u0442\u0430\u0432\u044c\u0442\u0435 \u043f\u043e\u043b\u043d\u044b\u0439 \u0431\u0430\u043b\u043b, \u0435\u0441\u043b\u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u044b \u0432\u0441\u0435 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u0438 \u0438\u043b\u0438 \u0441\u0434\u0435\u043b\u0430\u043d\u043e \u0447\u0442\u043e-\u0442\u043e \u0431\u043e\u043b\u0435\u0435 \u0438\u043d\u0442\u0435\u0440\u0435\u0441\u043d\u043e\u0435 \u0438 \u0441\u043b\u043e\u0436\u043d\u043e\u0435. \u0417\u0430 \u043a\u0430\u0436\u0434\u044b\u0439 \u043e\u0442\u0441\u0443\u0441\u0442\u0441\u0442\u0432\u0443\u044e\u0449\u0438\u0439 \u043f\u0443\u043d\u043a\u0442 \u0438\u0437 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u044f \u0441\u043d\u0438\u0436\u0430\u0439\u0442\u0435 1 \u0431\u0430\u043b\u043b.","ce207a5c":"ROC-AUC \u043d\u0430 Kaggle: 0.84912","327398ce":"\u0412\u044b\u043f\u0438\u0448\u0438\u0442\u0435 \u043a\u0430\u043a\u043e\u0435 \u043b\u0443\u0447\u0448\u0435\u0435 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u043e \u0438 \u0441 \u043a\u0430\u043a\u0438\u043c\u0438 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u043c\u0438 \u0432\u0430\u043c \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c","14f1f040":"## \u041f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u043b\u0438\u043d\u0435\u0439\u043d\u044b\u0445 \u043c\u043e\u0434\u0435\u043b\u0435\u0439 (3 \u0431\u0430\u043b\u043b\u0430)\n\n1) \u041e\u0431\u0440\u0430\u0431\u043e\u0442\u0430\u0439\u0442\u0435 \u0434\u0430\u043d\u043d\u044b\u0435 \u0434\u043b\u044f \u0442\u043e\u0433\u043e, \u0447\u0442\u043e\u0431\u044b \u043a \u043d\u0438\u043c \u043c\u043e\u0436\u043d\u043e \u0431\u044b\u043b\u043e \u043f\u0440\u0438\u043c\u0435\u043d\u0438\u0442\u044c LogisticRegression. \u0422.\u0435. \u043e\u0442\u043d\u043e\u0440\u043c\u0438\u0440\u0443\u0439\u0442\u0435 \u0447\u0438\u0441\u043b\u043e\u0432\u044b\u0435 \u043f\u0440\u0438\u0437\u043d\u0430\u043a\u0438, \u0430 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0430\u043b\u044c\u043d\u044b\u0435 \u0437\u0430\u043a\u043e\u0434\u0438\u0440\u0443\u0439\u0442\u0435 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e one-hot-encoding'\u0430. \n\n2) \u0421 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u043a\u0440\u043e\u0441\u0441\u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u0438 \u0438\u043b\u0438 \u0440\u0430\u0437\u0434\u0435\u043b\u0435\u043d\u0438\u044f \u043d\u0430 train\/valid \u0432\u044b\u0431\u043e\u0440\u043a\u0443 \u043f\u0440\u043e\u0442\u0435\u0441\u0442\u0438\u0440\u0443\u0439\u0442\u0435 \u0440\u0430\u0437\u043d\u044b\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u0433\u0438\u043f\u0435\u0440\u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430 C \u0438 \u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043b\u0443\u0447\u0448\u0438\u0439 (\u043c\u043e\u0436\u043d\u043e \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0421=100, 10, 1, 0.1, 0.01, 0.001) \u043f\u043e \u043c\u0435\u0442\u0440\u0438\u043a\u0435 ROC-AUC. \n\n\u0415\u0441\u043b\u0438 \u0432\u044b \u0440\u0430\u0437\u0434\u0435\u043b\u044f\u0435\u0442\u0435 \u043d\u0430 train\/valid, \u0442\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435 LogisticRegressionCV. \u041e\u043d \u0441\u0430\u043c \u043f\u0440\u0438 \u0432\u044b\u0437\u043e\u0432\u0435 .fit() \u043f\u043e\u0434\u0431\u0435\u0440\u0435\u0442 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 \u0421. (\u043d\u0435 \u0437\u0430\u0431\u0443\u0434\u044c\u0442\u0435 \u043f\u0435\u0440\u0435\u0434\u0430\u0442\u044c scroing='roc_auc', \u0447\u0442\u043e\u0431\u044b \u043f\u0440\u0438 \u043a\u0440\u043e\u0441\u0441\u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u0438 \u0441\u0440\u0430\u0432\u043d\u0438\u0432\u0430\u043b\u0438\u0441\u044c \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u044d\u0442\u043e\u0439 \u043c\u0435\u0442\u0440\u0438\u043a\u0438, \u0438 refit=True, \u0447\u0442\u043e\u0431\u044b \u043f\u0440\u0438 \u043f\u043e\u0442\u043e\u043c \u043c\u043e\u0434\u0435\u043b\u044c \u043e\u0431\u0443\u0447\u0438\u043b\u0430\u0441\u044c \u043d\u0430 \u0432\u0441\u0435\u043c \u0434\u0430\u0442\u0430\u0441\u0435\u0442\u0435 \u0441 \u043b\u0443\u0447\u0448\u0438\u043c \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u043c C). \n\n\n(\u0431\u043e\u043b\u0435\u0435 \u0441\u043b\u043e\u0436\u043d\u044b\u0439 \u0432\u0430\u0440\u0438\u0430\u043d\u0442) \u0415\u0441\u043b\u0438 \u0432\u044b \u0431\u0443\u0434\u0435\u0442\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043a\u0440\u043e\u0441\u0441\u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u044e, \u0442\u043e \u043f\u0440\u0435\u043e\u0431\u0440\u0430\u0437\u043e\u0432\u0430\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445 \u0438 LogisticRegression \u043d\u0443\u0436\u043d\u043e \u0441\u043e\u0435\u0434\u0438\u043d\u0438\u0442\u044c \u0432 \u043e\u0434\u0438\u043d Pipeline \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e make_pipeline, \u043a\u0430\u043a \u044d\u0442\u043e \u0434\u0435\u043b\u0430\u043b\u043e\u0441\u044c \u0432\u043e \u0432\u0442\u043e\u0440\u043e\u043c \u0441\u0435\u043c\u0438\u043d\u0430\u0440\u0435. \u041f\u043e\u0442\u043e\u043c pipeline \u043d\u0430\u0434\u043e \u043f\u0435\u0440\u0435\u0434\u0430\u0442\u044c \u0432 GridSearchCV. \u0414\u043b\u044f one-hot-encoding'a \u043c\u043e\u0436\u043d\u043e \u0438\u0441\u043f\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043a\u043e\u043c\u0431\u0438\u043d\u0430\u0446\u0438\u044e LabelEncoder + OneHotEncoder (\u0441\u043d\u0430\u0447\u0430\u043b\u0430 \u043f\u0440\u0435\u0432\u0440\u0430\u0449\u0430\u0435\u043c \u0441\u0442\u0440\u043e\u0447\u043a\u0438 \u0432 \u0447\u0438\u0441\u043b\u0430, \u0430 \u043f\u043e\u0442\u043e\u043c \u0447\u0438\u0441\u043b\u0430 \u043f\u0440\u0432\u0440\u0430\u0449\u0430\u0435\u043c \u0432 one-hot \u0432\u0435\u043a\u0442\u043e\u0440\u0430.)","79736817":"## \u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0434\u0430\u043d\u043d\u044b\u0445 (2 \u0431\u0430\u043b\u043b\u0430)\n\n1) \u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0438\u0442\u0435 \u043d\u0430 \u0441\u043b\u0443\u0447\u0430\u0439\u043d\u044b\u0435 \u0441\u0442\u0440\u043e\u0447\u043a\u0438. \n\n2) \u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0438\u0442\u0435, \u0435\u0441\u0442\u044c \u043b\u0438 \u0432 \u0434\u0430\u0442\u0430\u0441\u0435\u0442\u0435 \u043d\u0435\u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u044b\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f (nan'\u044b) \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e data.isna() \u0438\u043b\u0438 data.info() \u0438, \u0435\u0441\u043b\u0438 \u043d\u0443\u0436\u043d\u043e, \u0437\u0430\u043c\u0435\u043d\u0438\u0442\u0435 \u0438\u0445 \u043d\u0430 \u0447\u0442\u043e-\u0442\u043e. \u0411\u0443\u0434\u0435\u0442 \u0445\u043e\u0440\u043e\u0448\u043e, \u0435\u0441\u043b\u0438 \u0432\u044b \u043f\u043e\u0441\u0442\u0440\u043e\u0438\u0442\u0435 \u0442\u0430\u0431\u043b\u0438\u0447\u043a\u0443 \u0441 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e\u043c nan \u0432 \u043a\u0430\u0436\u0434\u043e\u0439 \u043a\u043e\u043b\u043e\u043d\u043a\u0435.","cd183c74":"\u0420\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u0446\u0435\u043b\u0435\u0432\u043e\u0439 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u043e\u0439 \u043d\u0435 \u0438\u0434\u0435\u0430\u043b\u044c\u043d\u043e \u0441\u0431\u0430\u043b\u0430\u043d\u0441\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e (2.8:1 \u043e\u0442\u0440\u0438\u0446\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0433\u043e \u043a \u043f\u043e\u043b\u043e\u0436\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u043c\u0443), \u043d\u043e \u0438 \u0441\u0438\u043b\u044c\u043d\u043e\u0433\u043e \u043f\u0435\u0440\u0435\u043a\u043e\u0441\u0430 \u043d\u0435\u0442.","06ac7203":"\u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0438\u043c \u043d\u0430 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0430\u043b\u044c\u043d\u044b\u0435 \u043f\u0440\u0438\u0437\u043d\u0430\u043a\u0438:","408f5999":"## \u041f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u0435 \u0433\u0440\u0430\u0434\u0438\u0435\u043d\u0442\u043d\u043e\u0433\u043e \u0431\u0443\u0441\u0442\u0438\u043d\u0433\u0430 (2 \u0431\u0430\u043b\u043b\u0430)\n\n\u0415\u0441\u043b\u0438 \u0432\u044b \u0445\u043e\u0442\u0438\u0442\u0435 \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0431\u0430\u043b\u043b\u044b \u0437\u0430 \u0442\u043e\u0447\u043d\u044b\u0439 \u043e\u0442\u0432\u0435\u0442, \u0442\u043e \u0441\u0442\u043e\u0438\u0442 \u043f\u043e\u043f\u0440\u043e\u0431\u043e\u0432\u0430\u0442\u044c \u0433\u0440\u0430\u0434\u0438\u0435\u043d\u0442\u043d\u044b\u0439 \u0431\u0443\u0441\u0442\u0438\u043d\u0433. \u0427\u0430\u0441\u0442\u043e \u0433\u0440\u0430\u0434\u0438\u0435\u043d\u0442\u043d\u044b\u0439 \u0431\u0443\u0441\u0442\u0438\u043d\u0433 \u0441 \u0434\u0435\u0444\u043e\u043b\u0442\u043d\u044b\u043c\u0438 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u043c\u0438 \u0434\u0430\u0441\u0442 \u0432\u0430\u043c 80% \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430 \u0437\u0430 0% \u0443\u0441\u0438\u043b\u0438\u0439.\n\n\u041c\u044b \u0431\u0443\u0434\u0435\u043c \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c catboost, \u043f\u043e\u044d\u0442\u043e\u043c\u0443 \u043d\u0430\u043c \u043d\u0435 \u043d\u0430\u0434\u043e \u043a\u043e\u0434\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0430\u043b\u044c\u043d\u044b\u0435 \u043f\u0440\u0438\u0437\u043d\u0430\u043a\u0438. catboost \u0441\u0434\u0435\u043b\u0430\u0435\u0442 \u044d\u0442\u043e \u0441\u0430\u043c (\u0432 .fit() \u043d\u0430\u0434\u043e \u043f\u0435\u0440\u0435\u0434\u0430\u0442\u044c cat_features=cat_cols). \u0410 \u0447\u0438\u0441\u043b\u0435\u043d\u043d\u044b\u0435 \u043f\u0440\u0438\u0437\u043d\u0430\u043a\u0438 \u043d\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0434\u043b\u044f \u043c\u043e\u0434\u0435\u043b\u0435\u0439, \u043e\u0441\u043d\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u043d\u0430 \u0434\u0435\u0440\u0435\u0432\u044c\u044f\u0445 \u043d\u0435 \u043d\u0443\u0436\u043d\u043e.\n\n1) \u0420\u0430\u0437\u0434\u0435\u043b\u0438\u0442\u0435 \u0432\u044b\u0431\u043e\u0440\u043a\u0443 \u043d\u0430 train\/valid. \u041f\u0440\u043e\u0442\u0435\u0441\u0442\u0438\u0440\u0443\u0439\u0442\u0435 catboost c\u043e \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u044b\u043c\u0438 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u043c\u0438.\n\n2) \u041f\u0440\u043e\u0442\u0435\u0441\u0442\u0438\u0440\u0443\u0439\u0442\u0435 \u0440\u0430\u0437\u043d\u044b\u0435 \u0437\u0430\u043d\u0447\u0435\u043d\u0438\u044f \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0430 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u0430 \u0434\u0435\u0440\u0435\u0432\u044c\u0435\u0432 \u0438 learning_rate'\u0430 \u0438 \u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043b\u0443\u0447\u0448\u0443\u044e \u043f\u043e \u043c\u0435\u0442\u0440\u0438\u043a\u0435 ROC-AUC \u043a\u043e\u043c\u0431\u0438\u043d\u0430\u0446\u0438\u044e. \n\n(\u0414\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u043e) \u0415\u0441\u0442\u044c \u043d\u0435\u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0441\u043b\u043e\u0436\u043d\u043e\u0441\u0442\u0438 \u0441 \u0442\u0435\u043c, \u0447\u0442\u043e\u0431\u044b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c CatBoostClassifier \u0432\u043c\u0435\u0441\u0442\u0435 \u0441 GridSearchCV, \u043f\u043e\u044d\u0442\u043e\u043c\u0443 \u043c\u044b \u043d\u0435 \u043f\u0440\u043e\u0441\u0438\u043c \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043a\u0440\u043e\u0441\u0441\u0432\u0430\u043b\u0438\u0434\u0430\u0446\u0438\u044e. \u041d\u043e \u043c\u043e\u0436\u0435\u0442\u0435 \u043f\u043e\u043f\u0440\u043e\u0431\u043e\u0432\u0430\u0442\u044c)","a59e469f":"\u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0438\u043c \u043d\u0430 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0435 \u043f\u0440\u0438\u0437\u043d\u0430\u043a\u0438:","591ff994":"# \u041c\u0435\u0442\u0440\u0438\u043a\u0430. \n\n\u041f\u0435\u0440\u0435\u0434 \u0440\u0435\u0448\u0435\u043d\u0438\u0435\u043c \u043b\u044e\u0431\u043e\u0439 \u0437\u0430\u0434\u0430\u0447\u0438 \u0432\u0430\u0436\u043d\u043e \u043f\u043e\u043d\u0438\u043c\u0430\u0442\u044c, \u043a\u0430\u043a \u0431\u0443\u0434\u0435\u0442 \u043e\u0446\u0435\u043d\u0438\u0432\u0430\u0442\u044c\u0441\u044f \u0432\u0430\u0448\u0435 \u0440\u0435\u0448\u0435\u043d\u0438\u0435. \u0412 \u0434\u0430\u043d\u043d\u043e\u043c \u0441\u043b\u0443\u0447\u0430\u0435 \u043c\u044b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u0443\u044e \u0434\u043b\u044f \u0437\u0430\u0434\u0430\u0447\u0438 \u043a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438 \u043c\u0435\u0442\u0440\u0438\u043a\u0443 ROC-AUC. \u0415\u0435 \u043c\u043e\u0436\u043d\u043e \u0432\u044b\u0447\u0438\u0441\u043b\u0438\u0442\u044c \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u0440\u0435\u0434\u0441\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0435 \u0432\u0435\u0440\u043e\u044f\u0442\u043d\u043e\u0441\u0442\u0438 \u0438 \u0438\u0441\u0442\u0438\u043d\u043d\u044b\u0435 \u043a\u043b\u0430\u0441\u0441\u044b \u0431\u0435\u0437 \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u043e\u0433\u043e \u043f\u043e\u0440\u043e\u0433\u0430 \u043a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438 + \u043e\u043d\u0430 \u0440\u0430\u043e\u0442\u0430\u0435\u0442 \u0434\u0430\u0436\u0435 \u0435\u0441\u043b\u0438 \u043a\u043b\u0430\u0441\u0441\u044b \u0432 \u0434\u0430\u043d\u043d\u044b\u0445 \u0441\u0438\u043b\u044c\u043d\u043e \u043d\u0435\u0441\u0431\u0430\u043b\u0430\u043d\u0441\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b (\u043f\u0440\u0438\u043c\u0435\u0440\u043e\u0432 \u043e\u0434\u043d\u043e\u0433\u043e \u043a\u043b\u0430\u0441\u0441\u0430 \u0432 \u0434\u0435\u0441\u044f\u0442\u043a\u0438 \u0440\u0430\u0437 \u0431\u043e\u043b\u044c\u0448\u0435 \u043f\u0440\u0438\u043c\u0435\u0440\u043e\u0432 \u0434\u043b\u0443\u0433\u043e\u0433\u043e). \u0418\u043c\u0435\u043d\u043d\u043e \u043f\u043e\u044d\u0442\u043e\u043c\u0443 \u043e\u043d\u0430 \u043e\u0447\u0435\u043d\u044c \u0443\u0434\u043e\u0431\u043d\u0430 \u0434\u043b\u044f \u0441\u043e\u0440\u0435\u0432\u043d\u043e\u0432\u0430\u043d\u0438\u0439.\n\n\u041f\u043e\u0441\u0447\u0438\u0442\u0430\u0442\u044c \u0435\u0435 \u043b\u0435\u0433\u043a\u043e:\n","01432420":"\u0422\u0435\u043f\u0435\u0440\u044c \u0443 \u043d\u0430\u0441 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u044e\u0442\u0441\u044f NaN \u0432 TotalSpent:","59b1774f":"\u041f\u043e\u0434\u0435\u043b\u0438\u043c data \u043d\u0430 X \u0438 y:","fc65fbb4":"## \u0410\u043d\u0430\u043b\u0438\u0437 \u0434\u0430\u043d\u043d\u044b\u0445 (3 \u0431\u0430\u043b\u043b\u0430)\n\n1) \u0414\u043b\u044f \u0447\u0438\u0441\u043b\u0435\u043d\u043d\u044b\u0445 \u043f\u0440\u0438\u0437\u0430\u043d\u043a\u043e\u0432 \u043f\u043e\u0441\u0442\u0440\u043e\u0439\u0442\u0435 \u0433\u0438\u0441\u0442\u043e\u0433\u0440\u0430\u043c\u043c\u0443 (*plt.hist(...)*) \u0438\u043b\u0438 boxplot (*plt.boxplot(...)*). \u0414\u043b\u044f \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0430\u043b\u044c\u043d\u044b\u0445 \u043f\u043e\u0441\u0447\u0438\u0442\u0430\u0439\u0442\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u0434\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0433\u043e \u043f\u0440\u0438\u0437\u043d\u0430\u043a\u0430. \u0414\u043b\u044f \u043a\u0430\u0436\u0434\u043e\u0439 \u043a\u043e\u043b\u043e\u043d\u043a\u0438 \u043d\u0430\u0434\u043e \u0441\u0434\u0435\u043b\u0430\u0442\u044c *data.value_counts()* \u0438 \u043f\u043e\u0441\u0442\u0440\u043e\u0438\u0442\u044c bar \u0434\u0438\u0430\u0433\u0440\u0430\u043c\u043c\u044b *plt.bar(...)* \u0438\u043b\u0438 \u043a\u0440\u0443\u0433\u043e\u0432\u044b\u0435 \u0434\u0438\u0430\u0433\u0440\u0430\u043c\u043c\u044b *plt.pie(...)* (\u0445\u043e\u0440\u043e\u0448\u043e, \u0435\u043b\u0441\u0438 \u0432\u044b \u0441\u043c\u043e\u0436\u0435\u0442\u0435 \u044d\u0442\u043e \u0441\u0434\u0435\u043b\u0430\u0442\u044c \u043d\u0430 \u043e\u0434\u043d\u043e\u043c \u0433\u0430\u0440\u0444\u0438\u043a\u0435 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e *plt.subplots(...)*). \n\n2) \u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0438\u0442\u0435 \u043d\u0430 \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u0446\u0435\u043b\u0435\u0432\u043e\u0439 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u043e\u0439 \u0438 \u0441\u043a\u0430\u0436\u0438\u0442\u0435, \u044f\u0432\u043b\u044f\u044e\u0442\u0441\u044f \u043b\u0438 \u043a\u043b\u0430\u0441\u0441\u044b \u043d\u0435\u0441\u0431\u0430\u043b\u0430\u043d\u0441\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u043c\u0438.\n\n3) (\u0415\u0441\u043b\u0438 \u0431\u0443\u0434\u0435\u0442 \u0436\u0435\u043b\u0430\u043d\u0438\u0435) \u041f\u043e\u0438\u0433\u0440\u0430\u0439\u0442\u0435 \u0441 \u0440\u0430\u0437\u043d\u044b\u043c\u0438 \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0430\u043c\u0438 \u0434\u043b\u044f \u0432\u0438\u0437\u0443\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 - *sns*, *pandas_visual_analysis*, etc.\n\n\u0412\u0442\u043e\u0440\u043e\u0439 \u043f\u0443\u043d\u043a\u0442 \u043e\u0447\u0435\u043d\u044c \u0432\u0430\u0436\u0435\u043d, \u043f\u043e\u0442\u043e\u043c\u0443 \u0447\u0442\u043e \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0442 \u0437\u0430\u0434\u0430\u0447\u0438 \u043a\u043b\u0430\u0441\u0441\u0438\u0444\u0438\u043a\u0430\u0446\u0438\u0438 \u0441 \u043d\u0435\u0441\u0431\u0430\u043b\u0430\u043d\u0441\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u043c\u0438 \u043a\u043b\u0430\u0441\u0441\u0430\u043c\u0438. \u041d\u0430\u043f\u0440\u0438\u043c\u0435\u0440, \u044d\u0442\u043e \u043c\u043e\u0436\u0435\u0442 \u0437\u043d\u0430\u0447\u0438\u0442\u044c, \u0447\u0442\u043e \u0432 \u0434\u0430\u0442\u0430\u0441\u0435\u0442\u0435 \u043d\u0430\u043c\u043d\u043e\u0433\u043e \u0431\u043e\u043b\u044c\u0448\u0435 \u043f\u0440\u0438\u043c\u0435\u0440\u043e\u0432 0 \u043a\u043b\u0430\u0441\u0441\u0430. \u0412 \u0442\u0430\u043a\u0438\u0445 \u0441\u043b\u0443\u0447\u0430\u044f\u0445 \u043d\u0443\u0436\u043d\u043e 1) \u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c accuracy \u043a\u0430\u043a \u043c\u0435\u0442\u0440\u0438\u043a\u0443 2) \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043c\u0435\u0442\u043e\u0434\u044b \u0431\u043e\u0440\u044c\u0431\u044b \u0441 imbalanced dataset (\u043e\u0431\u044b\u0447\u043d\u043e \u0435\u0441\u043b\u0438 \u0434\u0430\u0442\u0430\u0441\u0435\u0442 \u0441\u0438\u043b\u044c\u043d\u043e \u043d\u0435\u0441\u0431\u0430\u043b\u0430\u043d\u0441\u0438\u0440\u043e\u0432\u0430\u043d, \u0442.\u0435. \u043a\u043b\u0430\u0441\u0441\u0430 1 \u0432 20 \u0440\u0430\u0437 \u043c\u0435\u043d\u044c\u0448\u0435 \u043a\u043b\u0430\u0441\u0441\u0430 0).","a7be55e5":"# Kaggle (5 \u0431\u0430\u043b\u043b\u043e\u0432)\n\n\u0414\u043b\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u043d\u0438\u044f \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0435 \u0448\u0430\u0433\u0438.\n* \u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u043d\u0430 \u043f\u043b\u0430\u0442\u0444\u043e\u0440\u043c\u0435 [kaggle.com](kaggle.com). \u041f\u0440\u043e\u0446\u0435\u0441\u0441 \u0432\u044b\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u043e\u0446\u0435\u043d\u043e\u043a \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u043e\u0445\u043e\u0434\u0438\u0442\u044c \u043f\u0440\u0438 \u043f\u043e\u0434\u0432\u0435\u0434\u0435\u043d\u0438\u0438 \u0438\u0442\u043e\u0433\u043e\u0432\u043e\u0433\u043e \u0440\u0435\u0439\u0442\u0438\u043d\u0433\u0430. \u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0443\u043a\u0430\u0436\u0438\u0442\u0435 \u0432\u043e \u0432\u043a\u043b\u0430\u0434\u043a\u0435 Team -> Team name \u0441\u0432\u043e\u0438 \u0438\u043c\u044f \u0438 \u0444\u0430\u043c\u0438\u043b\u0438\u044e \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 \u0418\u043c\u044f_\u0424\u0430\u043c\u0438\u043b\u0438\u044f (\u0432\u0430\u0436\u043d\u043e, \u0447\u0442\u043e\u0431\u044b \u0438\u043c\u044f \u0438 \u0444\u0430\u043c\u0438\u043b\u0438\u044f \u0441\u043e\u0432\u043f\u0430\u0434\u0430\u043b\u0438 \u0441 \u0434\u0430\u043d\u043d\u044b\u043c\u0438 \u043d\u0430 Stepik).\n* \u041e\u0431\u0443\u0447\u0438\u0442\u044c \u043c\u043e\u0434\u0435\u043b\u044c, \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0444\u0430\u0439\u043b \u0441 \u043e\u0442\u0432\u0435\u0442\u0430\u043c\u0438 \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 .csv \u0438 \u0441\u0434\u0430\u0442\u044c \u0435\u0433\u043e \u0432 \u043a\u043e\u043d\u043a\u0443\u0440\u0441. \u041f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0438 \u044d\u043a\u0441\u043f\u0435\u0440\u0438\u043c\u0435\u043d\u0442\u0438\u0440\u0443\u0439\u0442\u0435. \u041e\u0431\u0440\u0430\u0442\u0438\u0442\u0435 \u0432\u043d\u0438\u043c\u0430\u043d\u0438\u0435, \u0447\u0442\u043e \u0432\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0442\u044c \u0434\u043e 20 \u043f\u043e\u043f\u044b\u0442\u043e\u043a \u0441\u0434\u0430\u0447\u0438 \u043d\u0430 kaggle \u0432 \u0434\u0435\u043d\u044c.\n* \u041f\u043e\u0441\u043b\u0435 \u043e\u043a\u043e\u043d\u0447\u0430\u043d\u0438\u044f \u0441\u043e\u0440\u0435\u0432\u043d\u043e\u0432\u0430\u043d\u0438\u044f \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0432 \u0438\u0442\u043e\u0433\u043e\u0432\u044b\u0439 \u043d\u043e\u0443\u0442\u0431\u0443\u043a \u0441 \u0440\u0435\u0448\u0435\u043d\u0438\u0435\u043c \u043d\u0430 \u0441\u0442\u0435\u043f\u0438\u043a. \u041f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0432\u0430\u0448\u0435\u0433\u043e \u0438\u0442\u043e\u0433\u043e\u0432\u043e\u0433\u043e Score \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u0432\u043e\u0441\u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u043c\u043e.","7c31db93":"\u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0435\u043c \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c CatBoost \u0441 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u043c\u0438 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e:","028c2211":"### LogisticRegression + Pipeline + GridSearchCV","d5847f9c":"CatBoost, \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b:\n`{'cat_features': ['Sex',\n  'IsSeniorCitizen',\n  'HasPartner',\n  'HasChild',\n  'HasPhoneService',\n  'HasMultiplePhoneNumbers',\n  'HasInternetService',\n  'HasOnlineSecurityService',\n  'HasOnlineBackup',\n  'HasDeviceProtection',\n  'HasTechSupportAccess',\n  'HasOnlineTV',\n  'HasMovieSubscription',\n  'HasContractPhone',\n  'IsBillingPaperless',\n  'PaymentMethod'],\n 'depth': 4,\n 'l2_leaf_reg': 1,\n 'random_seed': 42,\n 'verbose': False}`","4629723a":"\u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0438\u043c \u043d\u0430 \u0440\u0430\u0437\u043c\u0435\u0440 \u043d\u0430\u0448\u0435\u0433\u043e \u0434\u0430\u0442\u0430\u0441\u0435\u0442\u0430, \u043d\u0430\u043b\u0438\u0447\u0438\u0435 NaN \u0438 \u0442\u0438\u043f\u044b \u0434\u0430\u043d\u043d\u044b\u0445 \u0432 \u043d\u0435\u043c:","c0bab1f0":"\u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0435\u043c \u043f\u043e\u0434\u043e\u0431\u0440\u0430\u0442\u044c \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u043c\u043e\u0434\u0435\u043b\u0438 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u0432\u0441\u0442\u0440\u043e\u0435\u043d\u043d\u043e\u0433\u043e \u0432 CatBoost grid_search:","246f0fb3":"\u041f\u043e \u0438\u0442\u043e\u0433\u0443 \u043c\u043e\u0436\u043d\u043e \u0437\u0430\u044f\u0432\u0438\u0442\u044c, \u0447\u0442\u043e CatBoost \u0441\u0430\u043c \u043b\u0443\u0447\u0448\u0435 \u043f\u043e\u0434\u0431\u0438\u0440\u0430\u0435\u0442 learning rate \u00af\\\\\\_(\u30c4)\\_\/\u00af","82a37306":"\u0412 \u0441\u0442\u043e\u043b\u0431\u0435\u0446 \u0437\u0430\u0442\u0435\u0441\u0430\u043b\u0438\u0441\u044c \u043f\u0440\u043e\u0431\u0435\u043b\u044b, \u0437\u0430\u043c\u0435\u043d\u0438\u043c \u0438\u0445 \u043d\u0430 NaN:","85ab3a9f":"ROC-AUC \u043d\u0430 Kaggle: 0.85469","f6e9b306":"\u0422\u0430\u043a-\u0442\u043e \u043b\u0443\u0447\u0448\u0435, \u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0438\u043c \u043d\u0430 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e \u043e \u0434\u0430\u0442\u0430\u0444\u0440\u0435\u0439\u043c\u0435 \u0435\u0449\u0435 \u0440\u0430\u0437:","b923fd86":"# \u041f\u0435\u0440\u0432\u0430\u044f \u0447\u0430\u0441\u0442\u044c. \u0418\u0441\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u043d\u0438\u0435.","8720bb9a":"\u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0435\u043c \u0435\u0449\u0435 \u0440\u0430\u0437, \u043d\u043e \u0438\u0437\u043c\u0435\u043d\u044f\u044f \u0434\u0440\u0443\u0433\u0438\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b:","d37c987b":"<p style=\"align: center;\"><img align=center src=\"https:\/\/s8.hostingkartinok.com\/uploads\/images\/2018\/08\/308b49fcfbc619d629fe4604bceb67ac.jpg\" width=500 height=450\/><\/p>\n\n<h3 style=\"text-align: center;\"><b>\u0428\u043a\u043e\u043b\u0430 \u0433\u043b\u0443\u0431\u043e\u043a\u043e\u0433\u043e \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f \u0424\u041f\u041c\u0418 \u041c\u0424\u0422\u0418<\/b><\/h3>\n\n<h3 style=\"text-align: center;\"><b>\u0414\u043e\u043c\u0430\u0448\u043d\u0435\u0435 \u0437\u0430\u0434\u0430\u043d\u0438\u0435. \u041f\u0440\u043e\u0434\u0432\u0438\u043d\u0443\u0442\u044b\u0439 \u043f\u043e\u0442\u043e\u043a. \u041e\u0441\u0435\u043d\u044c 2020<\/b><\/h3>\n\n\u042d\u0442\u043e \u0434\u043e\u043c\u0430\u0448\u043d\u0435\u0435 \u0437\u0430\u0434\u0430\u043d\u0438\u0435 \u0431\u0443\u0434\u0435\u0442 \u043f\u043e\u0441\u0432\u044f\u0449\u0435\u043d\u043e \u043f\u043e\u043b\u043d\u043e\u0446\u0435\u043d\u043d\u043e\u043c\u0443 \u0440\u0435\u0448\u0435\u043d\u0438\u044e \u0437\u0430\u0434\u0430\u0447\u0438 \u043c\u0430\u0448\u0438\u043d\u043d\u043e\u0433\u043e \u043e\u0431\u0443\u0447\u0435\u043d\u0438\u044f.","9d87356c":"\u0415\u0441\u0442\u044c \u0434\u0432\u0435 \u0447\u0430\u0441\u0442\u0438 \u044d\u0442\u043e\u0433\u043e \u0434\u043e\u043c\u0430\u0448\u043d\u0435\u0433\u043e \u0437\u0430\u0434\u0430\u043d\u0438\u044f: \n* \u0421\u0434\u0435\u043b\u0430\u0442\u044c \u043f\u043e\u043b\u043d\u043e\u0446\u0435\u043d\u043d\u044b\u0439 \u043e\u0442\u0447\u0435\u0442 \u043e \u0432\u0430\u0448\u0435\u0439 \u0440\u0430\u0431\u043e\u0442\u0435: \u043a\u0430\u043a \u0432\u044b \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u0430\u043b\u0438 \u0434\u0430\u043d\u043d\u044b\u0435, \u043a\u0430\u043a\u0438\u0435 \u043c\u043e\u0434\u0435\u043b\u0438 \u043f\u043e\u043f\u0440\u043e\u0431\u043e\u0432\u0430\u043b\u0438 \u0438 \u043a\u0430\u043a\u0438\u0435 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u043f\u043e\u043b\u0443\u0447\u0438\u043b\u0438\u0441\u044c (\u043c\u0430\u043a\u0441\u0438\u043c\u0443\u043c 10 \u0431\u0430\u043b\u043b\u043e\u0432). \u0417\u0430 \u043a\u0430\u0436\u0434\u0443\u044e \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u0443\u044e \u0447\u0430\u0441\u0442\u044c \u0431\u0443\u0434\u0435\u0442 \u043d\u0430\u0447\u0438\u0441\u043b\u0435\u043d\u043e \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0431\u0430\u043b\u043b\u043e\u0432.\n* \u041b\u0443\u0447\u0448\u0435\u0435 \u0440\u0435\u0448\u0435\u043d\u0438\u0435 \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0432 \u0441\u043e\u0440\u0435\u0432\u043d\u043e\u0432\u0430\u043d\u0438\u0435 \u043d\u0430 [kaggle](https:\/\/www.kaggle.com\/t\/f50bc21dbe0e42dabe5e32a21f2e5235) (\u043c\u0430\u043a\u0441\u0438\u043c\u0443\u043c 5 \u0431\u0430\u043b\u043b\u043e\u0432). \u0417\u0430 \u043f\u0440\u043e\u0445\u043e\u0436\u0434\u0435\u043d\u0438\u0435 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043d\u043e\u0433\u043e \u043f\u043e\u0440\u043e\u0433\u043e\u0432 \u0431\u0443\u0434\u0443\u0442 \u043d\u0430\u0447\u0438\u0441\u043b\u044f\u0442\u044c\u0441\u044f \u0431\u0430\u043b\u043b\u044b.\n\n\n**\u041e\u0431\u0435 \u0447\u0430\u0441\u0442\u0438 \u0431\u0443\u0434\u0443\u0442 \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0442\u044c\u0441\u044f \u0432 \u0444\u043e\u0440\u043c\u0430\u0442\u0435 peer-review. \u0422.\u0435. \u0432\u0430\u0448\u0443 \u043f\u043e\u0441\u044b\u043b\u043a\u0443 \u043d\u0430 \u0441\u0442\u0435\u043f\u0438\u043a \u0431\u0443\u0434\u0443\u0442 \u043f\u0440\u043e\u0432\u0435\u0440\u044f\u0442\u044c \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0434\u0440\u0443\u0433\u0438\u0445 \u0441\u0442\u0443\u0434\u0435\u043d\u0442\u043e\u0432 \u0438 \u0430\u0433\u0433\u0440\u0435\u0433\u0430\u0446\u0438\u044f \u0438\u0445 \u043e\u0446\u0435\u043d\u043e\u043a \u0431\u0443\u0434\u0435\u0442 \u0432\u044b\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0430. \u0412 \u0442\u043e \u0436\u0435 \u0432\u0440\u0435\u043c\u044f \u0432\u0430\u043c \u0442\u043e\u0436\u0435 \u043d\u0443\u0436\u043d\u043e \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u043e\u0432\u0435\u0440\u0438\u0442\u044c \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0434\u0440\u0443\u0433\u0438\u0445 \u0443\u0447\u0435\u043d\u0438\u043a\u043e\u0432.**\n\n**\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0434\u0435\u043b\u0430\u0439\u0442\u0435 \u0441\u0432\u043e\u044e \u0440\u0430\u0431\u043e\u0442\u0443 \u0447\u0438\u0441\u0442\u043e\u0439 \u0438 \u043f\u043e\u043d\u044f\u0442\u043d\u043e\u0439, \u0447\u0442\u043e\u0431\u044b \u043e\u0431\u043b\u0435\u0433\u0447\u0438\u0442\u044c \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0443. \u0415\u0441\u043b\u0438 \u0443 \u0432\u0430\u0441 \u0431\u0443\u0434\u0443\u0442 \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u044b \u0441 \u0440\u0435\u0448\u0435\u043d\u0438\u0435\u043c \u0438\u043b\u0438 \u0445\u043e\u0447\u0435\u0442\u0441\u044f \u0441\u043e\u0432\u0435\u0442\u0430, \u0442\u043e \u043f\u0438\u0448\u0438\u0442\u0435 \u0432 \u043d\u0430\u0448 \u0447\u0430\u0442 \u0432 \u0442\u0435\u043b\u0435\u0433\u0440\u0430\u043c\u0435 \u0438\u043b\u0438 \u0432 \u043b\u0441 @runfme. \u0415\u0441\u043b\u0438 \u0432\u044b \u0437\u0430\u0445\u043e\u0442\u0438\u0442\u0435 \u043f\u0440\u043e\u0430\u043f\u043f\u0435\u043b\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043e\u0446\u0435\u043d\u043a\u0443, \u0442\u043e \u043f\u0438\u043f\u0448\u0438\u0442\u0435 \u0432 \u043b\u0441 @runfme.**\n\n**\u0412\u043e \u0432\u0441\u0435\u0445 \u043f\u0443\u043d\u043a\u0442\u0430\u0445 \u0443\u043a\u0430\u0437\u0430\u043d\u0438\u044f \u044d\u0442\u043e \u043c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439 \u043d\u0430\u0431\u043e\u0440 \u0432\u0435\u0449\u0435\u0439, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0441\u0442\u043e\u0438\u0442 \u0441\u0434\u0435\u043b\u0430\u0442\u044c. \u0415\u0441\u043b\u0438 \u0432\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u0441\u0434\u0435\u043b\u0430\u0442\u044c \u043a\u0430\u043a\u043e\u0439-\u0442\u043e \u0448\u0430\u0433 \u043b\u0443\u0447\u0448\u0435 \u0438\u043b\u0438 \u0434\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0447\u0442\u043e-\u0442\u043e \u0441\u0432\u043e\u0435 - \u0434\u0435\u0440\u0437\u0430\u0439\u0442\u0435!**","773f8207":"\u0421\u043c\u043e\u0442\u0440\u0438\u043c \u043d\u0430 \u0441\u043b\u0443\u0447\u0430\u0439\u043d\u044b\u0435 \u0441\u0442\u0440\u043e\u0447\u043a\u0438 \u0432 \u043d\u0430\u0448\u0435\u043c \u0434\u0430\u0442\u0430\u0441\u0435\u0442\u0435:","8cb67efd":"\u0412\u044b\u043f\u0438\u0448\u0438\u0442\u0435 \u043a\u0430\u043a\u043e\u0435 \u043b\u0443\u0447\u0448\u0435\u0435 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u043e \u0438 \u0441 \u043a\u0430\u043a\u0438\u043c\u0438 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0430\u043c\u0438 \u0432\u0430\u043c \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c","872b5c24":"\u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0438\u043c \u043d\u0430 \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u0446\u0435\u043b\u0435\u0432\u043e\u0439 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u043e\u0439:","c9790ebb":"ROC-AUC \u043d\u0430 Kaggle: 0.84111\n\n\u041c\u043e\u0434\u0435\u043b\u044c \u043f\u0435\u0440\u0435\u043e\u0431\u0443\u0447\u0438\u043b\u0430\u0441\u044c :(","975ca927":"\u0412 \u0434\u0430\u0442\u0430\u0444\u0440\u0435\u0439\u043c\u0435 \u043d\u0435\u0442 NaN, \u043d\u043e \u0442\u0438\u043f \u0434\u0430\u043d\u043d\u044b\u0445 \u0443 TotalSpent object, \u0430 \u043d\u0435 int \u0438\u043b\u0438 float. \u041f\u043e\u0434\u043e\u0437\u0440\u0438\u0442\u0435\u043b\u044c\u043d\u043e. \u041f\u0440\u043e\u0432\u0435\u0440\u0438\u043c, \u043a\u0430\u043a\u0438\u0435 \u0441\u0442\u0440\u043e\u0447\u043a\u0438 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442 \u043d\u0435\u0447\u0438\u0441\u043b\u043e\u0432\u044b\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f:","98c6997b":"# \u041f\u0440\u0435\u0434\u0441\u043a\u0430\u0437\u0430\u043d\u0438\u044f","b2b161f0":"(\u0414\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u043e) \u0415\u0441\u043b\u0438 \u0432\u044b \u043d\u0430\u0448\u043b\u0438 \u043a\u0430\u043a\u0438\u0435-\u0442\u043e \u043e\u0448\u0438\u0431\u043a\u0438 \u0432 \u0434\u0430\u043d\u043d\u044b\u0445 \u0438\u043b\u0438 \u0432\u044b\u0431\u0440\u043e\u0441\u044b, \u0442\u043e \u043c\u043e\u0436\u0435\u0442\u0435 \u0438\u0445 \u0443\u0431\u0440\u0430\u0442\u044c. \u0422\u0443\u0442 \u043c\u043e\u0436\u043d\u043e \u043f\u043e\u044d\u043a\u0441\u043f\u0435\u0440\u0435\u043c\u0435\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u043e\u0439 \u0434\u0430\u043d\u043d\u044b\u0445 \u043a\u0430\u043a \u0443\u0433\u043e\u0434\u043d\u043e, \u043d\u043e \u043d\u0435 \u0437\u0430 \u0431\u0430\u043b\u043b\u044b."}}