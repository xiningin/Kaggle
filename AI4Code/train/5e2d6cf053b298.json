{"cell_type":{"93160df5":"code","b9c2a3d6":"code","8f54cd92":"code","4733ff6d":"code","c6f8ee70":"code","bb73a59d":"code","1b790b38":"code","28d0c1e9":"code","9c9134ff":"code","bc28bb0f":"code","30fc6812":"code","d084a865":"code","3dc90dda":"code","feabe17a":"code","2982c6b9":"code","2e39e70c":"code","dbcb0a5e":"code","aa28bad3":"code","a52add19":"code","18cdc751":"code","1dfa3288":"code","bf6cc160":"code","c136a379":"code","dfc044b2":"code","946cad16":"code","2ce870a5":"markdown"},"source":{"93160df5":"import numpy as np \nimport pandas as pd","b9c2a3d6":"train = pd.read_csv(\"..\/input\/train.csv\")","8f54cd92":"train.head()","4733ff6d":"train['pixel150'].head()","c6f8ee70":"Y_train = train['label']\nY_train.head()","bb73a59d":"X_train = train.drop(labels=['label'], axis=1)\nX_train.shape","1b790b38":"X_train.head()","28d0c1e9":"import matplotlib.pyplot as plt\ntr = X_train.iloc[1].values.reshape(28,28)\nplt.imshow(tr)","9c9134ff":"from keras.utils import np_utils\n\nY_train = np_utils.to_categorical(Y_train, 10)\nY_train","bc28bb0f":"X_train = X_train \/ 255","30fc6812":"X_train.shape","d084a865":"X_train = X_train.values.reshape(42000,28,28,1)\nX_train.shape","3dc90dda":"plt.imshow(X_train[1][:,:,0])","feabe17a":"from keras.models import Sequential\nfrom keras.layers import Dense, Conv2D, Flatten","2982c6b9":"model = Sequential()\nmodel.add(Conv2D(filters = 32, kernel_size = (3,3), input_shape = (28,28,1)))\nmodel.add(Flatten())\nmodel.add(Dense(10, activation=\"softmax\"))\nmodel.compile(loss=\"categorical_crossentropy\", optimizer=\"SGD\", metrics=['accuracy'])","2e39e70c":"model.summary()","dbcb0a5e":"%%time\nmodel.fit(X_train, Y_train, epochs = 5)","aa28bad3":"test = pd.read_csv(\"..\/input\/test.csv\")\ntest.head()","a52add19":"test = test \/ 255","18cdc751":"test = test.values.reshape(len(test),28,28,1)\ntest.shape","1dfa3288":"result = model.predict(test)","bf6cc160":"result","c136a379":"res = np.argmax(result, axis=1)\nres","dfc044b2":"df = pd.DataFrame({\"ImageID\":range(1,28001), \"Label\":res})\ndf.head()","946cad16":"df.to_csv(\"sub.csv\", index=False)","2ce870a5":"Deep Learning. \u0423\u0440\u043e\u043a 3 Kaggle (MNIST-CNN).\n\nhttps:\/\/youtu.be\/lBxcdEaWYvU"}}