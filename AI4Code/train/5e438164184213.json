{"cell_type":{"3198dede":"code","c814fb82":"code","b1829108":"code","79a6b1b6":"code","f0038363":"code","9b9839ea":"code","6c805d0a":"code","cd73b457":"code","744d6833":"code","6989caed":"code","a572ebdd":"code","21776cef":"markdown","765c73be":"markdown","89036a8e":"markdown","37a0ab51":"markdown","b566bf38":"markdown","92b8f983":"markdown","60ca37df":"markdown","ead38f83":"markdown","3f19ecb0":"markdown","e81c9f2e":"markdown","d9793c8a":"markdown"},"source":{"3198dede":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.\n\n# Get the Data Dictonary here\n# https:\/\/open.canada.ca\/data\/en\/dataset\/1eb9eba7-71d1-4b30-9fb1-30cbdab7e63a\n","c814fb82":"import pandas as pd #Data processing and data structures\nimport matplotlib.pyplot as plt #Plotting\nimport numpy as np #Linear Algerbra library\n\ndf = pd.read_csv('\/kaggle\/input\/ncdb-2014\/NCDB_2014.csv', na_values=[\"UUUU\", \"UU\", \"U\", \"XXXX\", \"XX\", \"X\", \"QQQQ\", \"QQ\", \"Q\"])#Piece by Piece, after showing\n#reads the csv file into a Pandas DataFrame\n#na_values changes these values to \"not available\"","b1829108":"df = df.dropna() #discards the values we defined as not available\ndf = df.reset_index(drop=True) #Drop avoids creating new column for the index\ndf = df.astype({\"C_HOUR\": int, \"C_RALN\": int, \"C_RSUR\": int}) #retype float-valued columns to int. Convert it to categorical variables","79a6b1b6":"plt.boxplot(df[\"C_VEHS\"], vert=False) #Horizontal Boxplot\nplt.title(\"Number of Vehicles Involved in Collision\") #Adds a title\n#Collisions of only 2 cars are so common, the entire box of our boxplot is hidden within this yellow line!","f0038363":"slices = [0, 0, 0] #define an array to hold the proportions of the pie\n\nisev_counts = df[\"P_ISEV\"].value_counts() #creates an array of the tallies of each value in the column \"P_ISEV\"\n\n#define slice sizes\nslices[0] = isev_counts[1] + isev_counts[2] #Non-Fatal\nslices[1] = isev_counts[0] #Injury\nslices[2] = isev_counts[3] #Fatality\n\nplt.pie(slices, #slice proportions\n        explode=[0,0,.25], #Bump out the \"Fatality\" category\n        labels=[\"No Injury\", \"Injury\", \"Fatality\"], #Labels\n        autopct=\"%1.1f%%\" #Percent formatting\n        )\nplt.title(\"Consequences for Persons Involved\") #Adds a title","9b9839ea":"\nplt.scatter(df[\"C_HOUR\"], df[\"C_VEHS\"]) # Scatter plot\nplt.title(\"Number of Vehicles Involved in Collision Vs. Time of day of Collision\") #Adds a title\nplt.xlabel(\"Time of Collision (Hrs. since 12am)\") #X-axis Label\nplt.ylabel(\"Number of Vehicles Involved\") #Y-axis Label\nplt.plot(np.unique(df[\"C_HOUR\"]), np.poly1d(np.polyfit(df[\"C_HOUR\"], df[\"C_VEHS\"], 1))(np.unique(df[\"C_HOUR\"])), color=\"red\")\n#Line of best fit^^","6c805d0a":"collisionsPerHour = df[\"C_HOUR\"].value_counts() #total for every hour\nheights = df[df[\"C_SEV\"] == 1][\"C_HOUR\"].value_counts() #total fatalities for every hour\n\nheights \/= collisionsPerHour #totals for every hour each divided by the total fatalities occuring at that hour.\n\nplt.bar(heights.index, heights) #Plots the x of hour, with the y of our custom metric total fatalities per hour.\n\nplt.title(\"Percent of Collisions Resulting in Death Vs. Time of day of Collision\") #Adds a title\nplt.xlabel(\"Time of Collision (Hrs. since 12am)\") #X-Axis Label\nplt.ylabel(\"Percent of Collisions Resulting in Death\") #Y-Axis Label ","cd73b457":"weather_counts = df[\"C_WTHR\"].value_counts() #Tallies of each value in C_WTHR\n\nplt.pie(weather_counts, #Slice Proportions\n        explode=[0,0,0,0, .75, 0, 0.75], #Label separation\n        labels=[\"Clear and Sunny\", \"Overcast\", \"Rain\", \"Snow\", \"Freezing Rain\/Sleet\/Hail\", \"Visibility Limitation\", \"Strong Wind\"], #Label Text\n        autopct=\"%1.1f%%\" #Formatted percentages\n        )\nplt.title(\"Weather Conditions of Collision\") #Adds title","744d6833":"heights = df[df[\"C_SEV\"] == 2][\"C_RSUR\"].value_counts() #Tallies of each value of C_RSUR where C_SEV is 2\n\nplt.bar(heights.index, # value\n        heights, # occurences of value\n        tick_label=[\"Dry\", \"Wet\", \"Snow\", \"Slush\", \n                     \"Icy\", \"Sand\\nGravel\\nDirt\", \"Muddy\", \"Oil\", \"Flooded\"]) # Label text\n\nplt.title(\"Collisions Resulting in Injury Vs. Road Surface of Collision\") # Add a title\nplt.xlabel(\"Raod Surface\") # X-Axis label\nplt.ylabel(\"Injuries\") # Y-Axis label","6989caed":"heights = df[df[\"C_SEV\"] == 2][\"C_RALN\"].value_counts() #Tallies of each value of C_RALN where C_SEV is 2\n\n\nplt.bar(heights.index, # value\n        heights,# occurences of value\n        tick_label=[\"Striaght\\nNo\\nGradient\", \"Straight\\nw\/\\nGradient\",\n                    \"Curved\\nNo\\nGradient\", \"Curved\\nw\/\\nGradient\", \n                     \"Hilltop\", \"Bottom\\nof\\nHill\"])# Label text\n\nplt.title(\"Collisions Resulting in Injury Vs. Road Alignment\") #Adds title\nplt.xlabel(\"Raod Alignment\") #X-Axis Label\nplt.ylabel(\"Injuries\") #Y-Axis label\n","a572ebdd":"safety = df[df[\"C_SEV\"] == 1][\"P_SAFE\"].value_counts() # Tallies of each value of P_SAFE where C_SEV is 1\n\nproper = safety[0] # the first value of the safety array\nunproper = safety.sum() - proper #the sum of the rest of the safety options, minus the proper option \n\nplt.pie([unproper, proper], #Array of slice sizes\n        labels=[\"No Safety Device Used\", \"Safety Device Used\"], #Label text\n        autopct=\"%1.1f%%\" #Percent Formatting\n        )\nplt.title(\"Safety Devices Used Vs. Not Used\\n(Comparing Number of Fatalities)\") # Add title\n","21776cef":"\nTo analyse collision severity, it\u2019s important to first to summarize how a collision is termed severe. There are two measures that are used independently or in conjunction with one another. The first way to measure the severity of a collision is by the number of vehicles involved in the collision.","765c73be":"From this initial set, the data was then filtered to include only the collisions where the information was complete, narrowing the dataset from 297 612 respondents, to 190 487 respondents. ","89036a8e":"As with weather condition, the dry surface (annotated as \u201cnormal\u201d in the dataset documentation) could not possibly have led to any of the collisions. Aside from this, the road surface can take a toll of varying degrees on a vehicle, mostly dependant on how slippery it is. Most notable in this graph, is the number of collisions which occur on ice. It is not uncommon for a Canadian road to be icy, but the number of collisions in icy conditions suggests it\u2019s more common than it is. Therefore, the road surface can negatively affect driving conditions. It\u2019s likely the road alignment does too.","37a0ab51":"Time of day also factors into the formulation of public policy to keep drivers safe.  For example, most if not all graduated licensing programs in Canada stipulate restrictions for new drivers between the hours of 12am and 5am. The above graph points to why driving during those hours is significantly more dangerous, and should be reserved for more experienced drivers.","b566bf38":"Road alignment refers to both the incline and curvature of the road. Curved and or steep roads will likely have more collisions as they should be traversed with caution and reduced speed. Similarly to weather conditions and the quality of the road surface, any collision encompassed by the \u201cStraight No Gradient\u201d category could not have been a result of the road alignment. It\u2019s tough to say if the other bars prove anything, but approximately 10 000 collisions on a road that is curved with a gradient seems a bit steep (pun intended).","92b8f983":"This circle graph shows how every collision in the dataset fits into one of these categories. It shows the most common outcome of a collision to be an injury, while no injury follows closely behind. The fortunately miniscule outcome of a fatality can only be correct, since it would be impossible for this to be recorded incorrectly. There is however bias introduced skewing the data in favour of injury. The dataset is comprised of police-reported collisions. If the damage is less than the threshold of the provincial limit in value of damage done, the collision does not have to be reported to the police. This leads to many minor collisions in which no one was injured, not being reported and in turn excluded from the data set.\n\nThe time of day a collision occurred is important; specific times of day will see patterns of types of drivers. To illustrate, professionals going to work during rush hour, long-haul truck drivers driving through time, school bus drivers, seniors going to medical appointments, and youth going out on a Friday night. All these types of drivers and the times (sunset, dusk, night etc.) contribute to collisions.  The time of day may also affect visibility, as well as the awareness of a driver. The following graph plots the number of vehicles involved in a collision against the hour of the collision.","60ca37df":"This boxplot shows the number of vehicles involved in each collision. The yellow bar represents the median of the data set, the nature of which makes the bar also the mean and the mode. A triple threat that perfectly illustrates the frequency of 2-car collisions. Because of the size of the data, and sheer frequency of 2-car collisions, all visible data points are actually outliers. \n\nThe second way to measure the severity of a collision is by the fatalities or injuries sustained.\n","ead38f83":"Since collision severity is also measured by the damage suffered by passengers, it is important to acknowledge any safety devices used (or lack thereof). As shown above, there is no correlation between using safety devices and survival. This could have to do with the blatant commonality of safety devices or a low bar for the qualification of what it means for something to be a safety device.\n\n## Conclusion\n\nAfter thorough analysis, this project was mostly conclusive. Hour of collision, road surfaces, and road alignment all proved to be able to affect road safety in a negative way.  It was inconclusive in proving anything about the effects of weather conditions or safety devices. Well shown however was 71% of injury producing collisions occur when the road conditions are classed as sunny and clear. While not captured in the dataset, it could be the caused by an increased volume of drivers that are more likely to drive in good weather, like seniors or it could be a relaxed attitude to a perceived safe weather environment. \nTo conclude, inclement Canadian weather claim a smaller partition of severe collisions than fair weather, safety devices do not necessarily lead to survival, and collision hour, road surface, and road alignment can all negatively affect road safety.\n\n","3f19ecb0":"Although weather conditions can be affected by the time of day, they are for the most part independent, and play an important role in a collision. Certain weather conditions impede visibility or make driving more difficult. An interesting finding is clear and sunny takes a lion share of collisions, despite being the least inclement weather.  This could be attributed to many underlying causes: icy conditions, blinding sun, and the volume and type of drivers that are out in. Though above all, it is most probably because of its commonality. \n\nCertain weather conditions can often also alter the road surface.","e81c9f2e":"The regression line once again demonstrates the prominence of 2-car collisions. The line is clearly following very strictly y=2. In fact, the correlation coefficient and the coefficient of determination are truncated to give 0 after several significant digits. Thus there is an infinitesimally strong neutral trend.\n\nAs depicted above, most collisions involve few vehicles and happen during 7am and 6pm. It is apparent that as the collision hour approaches mid-day from either direction, it is more likely that a collision will involve a higher number of vehicles. This can easily be attributed to a higher number of drivers on the road during those times. Despite the higher number of drivers on the road, those times of day are not most dangerous.","d9793c8a":"## Introduction\n\nCanada is turning 150 this year so there has been a lot reflection on the nation's history.  When the first European explorers arrived they used Canada's waterways to explore, then came railway transportation that went coast to coast, and beginning in the early 1940s, the emergence of a new mode of transportation: roads.\n\nCanada is now a country with more than 1,400,000 kilometres, with roadway connecting coast to coast to coast. The roadways are a complex system of infrastructure composed of highways, toll roads, bridges, single lanes, roundabouts and even dirt roads. Roads mean prosperity and the movement of people and goods. And with this comes vehicles and drivers, and lots of them. Stats Canada estimates there are 33,168,805 registered motor vehicles.\n\nBecause people who live in Canada where weather conditions include snow and ice typically have to travel longer distances, it would be logical to surmise that severe collisions would be more likely to happen in inclement weather, on slippery roads, non-straight roads, or even at just at night. This analysis aims to bring to light evidence to support this.\n\nThroughout this report, the severity of an accident is measured based on the number of vehicles involved in the collision and\/or on fatalities or injuries sustained. With reference to these measuring marks, this analysis will compare the time of day of collisions, weather conditions, road surfaces, road alignment, and safety devices used (or lack thereof).\n\nAlthough serious accidents may occur outside the scope of these variables, the compounding of poor safety choices and undesirable environment variables means a serious collision is more likely to happen.\n\nAs depicted in the 2014 Canadian Motor Vehicle Traffic Collision Statistics (CMVTCS) prepared by Transport Canada, the number of collisions per year is decreasing, despite the number of vehicles on the road increasing by much larger factors.\n\nTransport Canada\u2019s Road Safety in Canada booklet informs readers of more specific points on road safety such as effectiveness of seatbelts or safest vehicle type.\n\n## Survey and Sampling Process\n\nThis data management investigation is based on year 2014 of the national collision data base available for download at [http:\/\/open.canada.ca\/data\/en\/dataset\/1eb9eba7-71d1-4b30-9fb1-30cbdab7e63a] (http:\/\/open.canada.ca\/data\/en\/dataset\/1eb9eba7-71d1-4b30-9fb1-30cbdab7e63a) under \u201cResources\u201d with the title \u201cNational Collision Database 2014 (filename \u2018ncdb_2014.csv\u2019).  The dataset was originally collated as a census of all police-reported automotive collisions on public roads in Canada in 2014.\n\n## Analysis \n\nBefore we start our analysis, we'll want to do some imports. First we'll grab some standard data science libraries: Pandas, Matplotlib, and NumPy. Then we'll read in our csv file."}}