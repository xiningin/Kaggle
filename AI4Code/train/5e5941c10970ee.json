{"cell_type":{"c97eaadc":"code","4d2259ca":"code","3a10ef29":"code","950c4bc6":"code","983d1419":"code","9749ab1a":"code","c9e8e1ed":"code","4a198268":"code","47bfc8d4":"code","666b425a":"code","0bc1cf98":"code","7021cc76":"code","bdea22dd":"markdown","f15fbc34":"markdown","2c649999":"markdown","210423fa":"markdown"},"source":{"c97eaadc":"import pandas as pd\nimport numpy as np\n\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.tree import DecisionTreeRegressor","4d2259ca":"train = pd.read_csv('..\/input\/tabular-playground-series-jan-2022\/train.csv')\ntest = pd.read_csv('..\/input\/tabular-playground-series-jan-2022\/test.csv')","3a10ef29":"train.head()","950c4bc6":"train = train.drop(['row_id', 'date'], axis=1)\ntest = test.drop(['row_id', 'date'], axis=1)","983d1419":"x_data = train.drop('num_sold', axis=1)\ny_data = train.num_sold","9749ab1a":"for col in x_data.columns:\n    encoder = LabelEncoder()\n    encoder.fit(x_data[col])\n    x_data[col] = encoder.transform(x_data[col])\n    test[col] = encoder.transform(test[col])","c9e8e1ed":"def SMAPE(y_true, y_pred):\n    denominator = (y_true + np.abs(y_pred)) \/ 200.0\n    diff = np.abs(y_true - y_pred) \/ denominator\n    diff[denominator == 0] = 0.0\n    return np.mean(diff)","4a198268":"x_train, x_test, y_train, y_test = train_test_split(x_data, y_data)","47bfc8d4":"x_train.head()","666b425a":"model = DecisionTreeRegressor()\nmodel.fit(x_train, y_train)\n\ntrain_pred = model.predict(x_train)\ntest_pred = model.predict(x_test)\n\ntrain_score = SMAPE(y_train, train_pred)\ntest_score = SMAPE(y_test, test_pred)\n\nprint('train_score ', train_score, 'test_score', test_score)\n","0bc1cf98":"y_test = model.predict(test)","7021cc76":"submission = pd.read_csv('..\/input\/tabular-playground-series-jan-2022\/sample_submission.csv')\nsubmission.num_sold = y_test\nsubmission.to_csv('submission.csv', index=False)","bdea22dd":"### train model","f15fbc34":"### read data","2c649999":"### prediction && submission","210423fa":"### data preprocessing"}}