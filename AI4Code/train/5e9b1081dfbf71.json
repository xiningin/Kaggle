{"cell_type":{"86911270":"code","ca825c67":"code","23025676":"code","fe67589b":"code","5d57b332":"code","dba486c6":"code","ba173b13":"code","7d8e7578":"code","fb930cd0":"code","c820ebd0":"code","62ff1885":"code","7756fbf1":"code","046aa22a":"code","ff703bb1":"code","8c0b9fbb":"code","212e966b":"code","c2da7053":"code","fe7c8205":"code","d5a80729":"code","c6e756de":"code","d34fffda":"code","8b7a67ed":"code","836485bc":"code","cbe6ec77":"code","9a6101fe":"code","c0bff75e":"code","2b64e353":"code","87ec2748":"markdown","52848562":"markdown","3208606d":"markdown","62c24e81":"markdown","cf3ecbd8":"markdown","07a4acf7":"markdown"},"source":{"86911270":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline","ca825c67":"df=pd.read_csv('..\/input\/wholesale-customers-data-set\/Wholesale customers data.csv')","23025676":"df.head()","fe67589b":"df.describe()","5d57b332":"df.info()","dba486c6":"# Not a single null value in data\ndf.isnull().sum()","ba173b13":"from sklearn.preprocessing import StandardScaler\nsc=StandardScaler()","7d8e7578":"scaled_data=sc.fit_transform(df)","fb930cd0":"from sklearn.preprocessing import normalize\nnorm_data=normalize(df)","c820ebd0":"df=pd.DataFrame(scaled_data,columns=df.columns)","62ff1885":"df1=pd.DataFrame(norm_data,columns=df.columns)","7756fbf1":"df1.head()","046aa22a":"import scipy.cluster.hierarchy as shc","ff703bb1":"plt.figure(figsize=[10,5])\nplt.title('Dindogram')\ndend=shc.dendrogram(shc.linkage(df,method='ward'))","8c0b9fbb":"plt.figure(figsize=[10,5])\nplt.title('Dindogram')\ndend=shc.dendrogram(shc.linkage(df1,method='ward'))","212e966b":"plt.figure(figsize=[10,5])\nplt.title('Dindogram')\ndend=shc.dendrogram(shc.linkage(df,method='complete'))","c2da7053":"plt.figure(figsize=[10,5])\nplt.title('Dindogram')\ndendo=shc.dendrogram(shc.linkage(df,method='single'))","fe7c8205":"plt.figure(figsize=[10,5])\nplt.title('Dindogram')\ndendo=shc.dendrogram(shc.linkage(df,method='average'))","d5a80729":"plt.figure(figsize=[10,5])\nplt.title('Dindogram')\ndendo=shc.dendrogram(shc.linkage(df,method='weighted'))","c6e756de":"plt.figure(figsize=[10,5])\nplt.title('Dindogram')\ndendo=shc.dendrogram(shc.linkage(df,method='centroid'))","d34fffda":"plt.figure(figsize=[10,5])\nplt.title('Dendogram')\ndendo=shc.dendrogram(shc.linkage(df,method='ward'))\nplt.axhline(y=30,color='r',linestyle='--')\nplt.show()","8b7a67ed":"plt.figure(figsize=[10,5])\nplt.title('Dendogram')\ndendo=shc.dendrogram(shc.linkage(df,method='ward'))\nplt.axhline(y=6,color='r',linestyle='--')\nplt.show()","836485bc":"from sklearn.cluster import AgglomerativeClustering\ncluster=AgglomerativeClustering(n_clusters=2,affinity='euclidean',linkage='ward')\ncluster.fit_predict(df)","cbe6ec77":"from sklearn.cluster import AgglomerativeClustering\ncluster=AgglomerativeClustering(n_clusters=2,affinity='euclidean',linkage='ward')\ncluster.fit_predict(df1)","9a6101fe":"plt.figure(figsize=[10,5])\nplt.scatter(df.Milk,df.Grocery,c=cluster.labels_)","c0bff75e":"# graph for normalize data is good than scaled\nplt.figure(figsize=[10,5])\nplt.scatter(df1.Milk,df1.Grocery,c=cluster.labels_)","2b64e353":"Happy Learning!","87ec2748":"* We can see the values of 0s and 1s in the output since we defined 2 clusters. 0 represents the points that belong to the first cluster and 1 represents points in the second cluster. Let\u2019s now visualize the two clusters:","52848562":"* Here, we can see that the scale of all the variables is almost similar. Now, we are good to go. Let\u2019s first draw the dendrogram to help us decide the number of clusters for this particular problem:","3208606d":"* There are multiple product categories \u2013 Fresh, Milk, Grocery, etc. The values represent the number of units purchased by each client for each product. Our aim is to make clusters from this data that can segment similar clients together. We will, of course, use Hierarchical Clustering for this problem.","62c24e81":"* But before applying Hierarchical Clustering, we have to normalize the data so that the scale of each variable is the same. Why is this important? Well, if the scale of the variables is not the same, the model might become biased towards the variables with a higher magnitude like Fresh or Milk (refer to the above table).","cf3ecbd8":"* We have two clusters as this line cuts the dendrogram at two points. Let\u2019s now apply hierarchical clustering for 2 clusters:","07a4acf7":"* from above Method='Ward' gives beteer result than other methods.\n* The x-axis contains the samples and y-axis represents the distance between these samples. The vertical line with maximum distance is the blue line and hence we can decide a threshold of 6 and 30 and cut the dendrogram:"}}