{"cell_type":{"93d4664c":"code","6c98c5f7":"code","a2b851a9":"code","9490751c":"code","3325c2a7":"code","6d650daa":"code","3349cf76":"code","97574444":"code","b4e18e91":"code","005a5a3f":"code","e0998bf8":"code","4cc4c25b":"code","cbbe0f54":"code","7a685aa3":"code","dd9feb66":"code","eba5c438":"code","a8dcd5c8":"code","6f50e70a":"code","c6fe1840":"code","f0b6fcad":"code","4a8a5fd8":"code","d0e38794":"code","21076686":"code","0996ea20":"code","26721926":"code","ce35200d":"code","ffd8707e":"code","a5fe4d84":"code","0bf081c8":"code","e5395fb5":"code","473e0803":"code","34ed8629":"code","be638be3":"code","3d0e08fc":"code","54b3f68e":"code","d3d61036":"code","7bd48d29":"code","0e49d4e5":"code","2039b275":"code","5911f1db":"code","51517bb8":"code","64f8ee71":"code","7343cdfd":"code","41a590ad":"code","742c5e79":"code","ee62ed7e":"code","58bd7d02":"code","d0c0043a":"code","d1bf1377":"code","b9d192b8":"code","c75496f1":"code","9a1f00f2":"code","c85eaea1":"code","4e4dc7c3":"code","73b7744a":"code","8a9dcf7c":"code","97885f1e":"code","0fdbba11":"code","134c7d49":"code","c7be2d9e":"code","2deca92e":"code","3386393b":"code","aa9886ec":"code","58c1c92c":"code","9ca20df2":"code","dd6149ba":"code","1b565e76":"code","cd26ab41":"code","5b67b24c":"code","ddcc673a":"code","a38e3fbd":"code","aae31ec4":"code","f1c82ec0":"code","cec8afcc":"code","c3ebbabe":"code","70ffb64c":"code","5e2dbed7":"code","6be0b4c5":"code","9a584fc1":"code","43cd28b4":"code","867fe2ab":"code","955202ec":"code","b6ef6ba3":"code","b9259305":"code","ac8a0326":"code","0a48548c":"code","f96011d5":"code","de140f19":"code","add14e11":"code","7e92d0d7":"code","b18f8c55":"code","524e6a4d":"code","9c78992b":"code","16d3c170":"code","43b3eceb":"code","ccd4395e":"code","8509e7a2":"code","b9cf742d":"code","fc18ce90":"code","c7794d45":"code","6cfdde05":"code","348149e2":"code","3df517c9":"code","ea30502f":"code","d13a2b90":"code","eb6abab2":"code","44589a33":"code","d2dea1d6":"code","a09a8ead":"code","b6645893":"code","9b8ebbf8":"code","6c0b1e10":"code","ed135983":"code","fab32fef":"code","4747b141":"code","552030c1":"code","135acbda":"code","e62c5507":"code","563b90b7":"code","9bface8a":"code","0c963ed0":"code","a41d8442":"code","c0849911":"code","b15e8222":"code","701113d2":"code","62cf723d":"code","962248ab":"code","a057903c":"code","0843eefb":"code","284a052d":"code","7fdbdc92":"code","72512681":"code","066c7528":"code","18729e70":"code","5a67bdf3":"code","f5ffeecd":"code","33ae1a85":"code","2a109063":"code","c9c965db":"code","91f05fd8":"code","1a7aff28":"code","196df126":"code","a252c9bd":"code","a42c1dae":"markdown"},"source":{"93d4664c":"import warnings\nwarnings.filterwarnings('ignore')","6c98c5f7":"import datetime as dt\nfrom datetime import timedelta","a2b851a9":"import pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport numpy as np","9490751c":"covid=pd.read_csv(\"\/kaggle\/input\/novel-corona-virus-2019-dataset\/covid_19_data.csv\")","3325c2a7":"covid.head()","6d650daa":"covid.drop([\"SNo\"],1,inplace=True)","3349cf76":"covid[covid['Province\/State']=='Anhui']","97574444":"print(\"Checking Data-type of each column:\\n\",covid.dtypes)","b4e18e91":"covid.info()","005a5a3f":"#Converting \"Observation Date\" into Datetime format\ncovid[\"ObservationDate\"]=pd.to_datetime(covid[\"ObservationDate\"])","e0998bf8":"#Grouping different types of cases as per the date\ndatewise=covid.groupby([\"ObservationDate\"]).agg({\"Confirmed\":'sum',\"Recovered\":'sum',\"Deaths\":'sum'})\ndatewise[\"Days Since\"]=datewise.index-datewise.index.min()","4cc4c25b":"print(\"Totol number of countries with Disease Spread: \",len(covid[\"Country\/Region\"].unique()))","cbbe0f54":"datewise.iloc[-1]","7a685aa3":"print(\"Total number of Confirmed Cases around the World: \",datewise[\"Confirmed\"].iloc[-1])","dd9feb66":"datewise.shape","eba5c438":"np.round(datewise[\"Confirmed\"].iloc[-1]\/datewise.shape[0])","a8dcd5c8":"plt.figure(figsize=(15,7))\nsns.barplot(x=datewise.index.date, y=datewise[\"Confirmed\"]-datewise[\"Recovered\"]-datewise[\"Deaths\"])\nplt.title(\"Distribution Plot for Active Cases Cases over Date\")\nplt.xticks(rotation=90)","6f50e70a":"datewise[\"WeekOfYear\"]=datewise.index.weekofyear","c6fe1840":"datewise.head()","f0b6fcad":"week_num=[]\nweekwise_confirmed=[]\nweekwise_recovered=[]\nweekwise_deaths=[]\nfor i in list(datewise[\"WeekOfYear\"].unique()):\n    weekwise_confirmed.append(datewise[datewise[\"WeekOfYear\"]==i][\"Confirmed\"].iloc[-1])\n    weekwise_recovered.append(datewise[datewise[\"WeekOfYear\"]==i][\"Recovered\"].iloc[-1])\n    weekwise_deaths.append(datewise[datewise[\"WeekOfYear\"]==i][\"Deaths\"].iloc[-1])\n    week_num.append(i)","4a8a5fd8":"plt.figure(figsize=(8,5))\nplt.plot(week_num,weekwise_confirmed,linewidth=3, label='Confirmed')\nplt.plot(week_num,weekwise_recovered,linewidth=3, label = 'Recovered')\nplt.plot(week_num,weekwise_deaths,linewidth=3, label = 'Death')\nplt.ylabel(\"Number of Cases\")\nplt.xlabel(\"Week Number\")\nplt.title(\"Weekly progress of Different Types of Cases\")\nplt.legend()","d0e38794":"datewise[\"Mortality Rate\"]=(datewise[\"Deaths\"]\/datewise[\"Confirmed\"])*100\ndatewise[\"Recovery Rate\"]=(datewise[\"Recovered\"]\/datewise[\"Confirmed\"])*100\ndatewise[\"Active Cases\"]=datewise[\"Confirmed\"]-datewise[\"Recovered\"]-datewise[\"Deaths\"]\ndatewise[\"Closed Cases\"]=datewise[\"Recovered\"]+datewise[\"Deaths\"]","21076686":"datewise.head()","0996ea20":"fig, (ax1, ax2) = plt.subplots(1, 2,figsize=(20,6))\nax1.plot(datewise[\"Mortality Rate\"],label='Mortality Rate',linewidth=3)\nax1.axhline(datewise[\"Mortality Rate\"].mean(),linestyle='--',color='black',label=\"Mean Mortality Rate\")\nax1.set_ylabel(\"Mortality Rate\")\nax1.set_xlabel(\"Timestamp\")\nax1.set_title(\"Overall Datewise Mortality Rate\")\nax1.legend()\nfor tick in ax1.get_xticklabels():\n    tick.set_rotation(90)\n\nax2.plot(datewise[\"Recovery Rate\"],label=\"Recovery Rate\",linewidth=3)\nax2.axhline(datewise[\"Recovery Rate\"].mean(),linestyle='--',color='black',label=\"Mean Recovery Rate\")\nax2.set_ylabel(\"Recovery Rate\")\nax2.set_xlabel(\"Timestamp\")\nax2.set_title(\"Overall Datewise Recovery Rate\")\nax2.legend()\nfor tick in ax2.get_xticklabels():\n    tick.set_rotation(90)\n    ","26721926":"print(\"Average increase in number of Confirmed Cases every day: \")\nprint (np.round(datewise[\"Confirmed\"].diff().fillna(0).mean()))\nprint(\"Average increase in number of Recovered Cases every day:\")\nprint (np.round(datewise[\"Recovered\"].diff().fillna(0).mean()))\nprint(\"Average increase in number of Deaths Cases every day\")\nprint (np.round(datewise[\"Deaths\"].diff().fillna(0).mean()))","ce35200d":"plt.figure(figsize=(15,6))\nplt.plot(datewise[\"Confirmed\"].diff().fillna(0),label=\"Daily increase in Confiremd Cases\",linewidth=3)\nplt.plot(datewise[\"Recovered\"].diff().fillna(0),label=\"Daily increase in Recovered Cases\",linewidth=3)\nplt.plot(datewise[\"Deaths\"].diff().fillna(0),label=\"Daily increase in Death Cases\",linewidth=3)\nplt.xlabel(\"Timestamp\")\nplt.ylabel(\"Daily Increment\")\nplt.title(\"Daily increase in different Types of Cases Worldwide\")\nplt.xticks(rotation=90)\nplt.legend()","ffd8707e":"datewise[\"Confirmed\"]","a5fe4d84":"datewise[\"Confirmed\"].iloc[1]","0bf081c8":"datewise[\"Confirmed\"].iloc[2]\/datewise[\"Confirmed\"].iloc[1]","e5395fb5":"#GROWTH FACTOR","473e0803":"daily_increase_confirm=[]\ndaily_increase_recovered=[]\ndaily_increase_deaths=[]\nfor i in range(datewise.shape[0]-1):\n    daily_increase_confirm.append(((datewise[\"Confirmed\"].iloc[i+1]\/datewise[\"Confirmed\"].iloc[i])))\n    daily_increase_recovered.append(((datewise[\"Recovered\"].iloc[i+1]\/datewise[\"Recovered\"].iloc[i])))\n    daily_increase_deaths.append(((datewise[\"Deaths\"].iloc[i+1]\/datewise[\"Deaths\"].iloc[i])))\ndaily_increase_confirm.insert(0,1)\ndaily_increase_recovered.insert(0,1)\ndaily_increase_deaths.insert(0,1)","34ed8629":"plt.figure(figsize=(15,7))\nplt.plot(datewise.index,daily_increase_confirm,label=\"Growth Factor Confiremd Cases\",linewidth=3)\nplt.plot(datewise.index,daily_increase_recovered,label=\"Growth Factor Recovered Cases\",linewidth=3)\nplt.plot(datewise.index,daily_increase_deaths,label=\"Growth Factor Death Cases\",linewidth=3)\nplt.xlabel(\"Timestamp\")\nplt.ylabel(\"Growth Factor\")\nplt.title(\"Growth Factor of different Types of Cases Worldwide\")\nplt.axhline(1,linestyle='--',color='black',label=\"Baseline\")\nplt.xticks(rotation=90)\nplt.legend()","be638be3":"datewise[\"Confirmed\"].iloc[[-1]]","3d0e08fc":"c=1000\ndouble_days=[]\nC=[]\nwhile(1):\n    double_days.append(datewise[datewise[\"Confirmed\"]<=c].iloc[[-1]][\"Days Since\"][0])\n    C.append(c)\n    c=c*2\n    if(c<datewise[\"Confirmed\"].max()):\n        continue\n    else:\n        break","54b3f68e":"doubling_rate=pd.DataFrame(list(zip(C,double_days)),columns=[\"No. of cases\",\"Days since first Case\"])\ndoubling_rate[\"Number of days for doubling\"]=doubling_rate[\"Days since first Case\"].diff().fillna(doubling_rate[\"Days since first Case\"])\n#doubling_rate\nplt.figure(figsize=(10,5))\nplt.plot(doubling_rate[\"No. of cases\"],doubling_rate[\"Number of days for doubling\"].dt.days,marker='o')\nplt.axhline(1,color='black',linestyle='--')\nplt.ylabel(\"Number of days for doubling\")\nplt.xlabel(\"Number of Confirmed Cases\")\nplt.title(\"Days required for rise in cases by double\")","d3d61036":"doubling_rate.head()","7bd48d29":"covid.head()","0e49d4e5":"#Calculating countrywise Moratality and Recovery Rate\ncountrywise=covid[covid[\"ObservationDate\"]==covid[\"ObservationDate\"].max()]\ncountrywise = countrywise.groupby([\"Country\/Region\"]).agg({\"Confirmed\":'sum',\"Recovered\":'sum',\"Deaths\":'sum'})\ncountrywise = countrywise.sort_values([\"Confirmed\"],ascending=False)\ncountrywise[\"Mortality\"]=(countrywise[\"Deaths\"]\/countrywise[\"Confirmed\"])*100\ncountrywise[\"Recovery\"]=(countrywise[\"Recovered\"]\/countrywise[\"Confirmed\"])*100","2039b275":"countrywise.head()","5911f1db":"fig, (ax1, ax2) = plt.subplots(2, 1,figsize=(10,12))\ntop_15_confirmed=countrywise.head(15)\ntop_15_deaths=countrywise.sort_values([\"Deaths\"],ascending=False).head(15)\nsns.barplot(x=top_15_confirmed[\"Confirmed\"],\n            y=top_15_confirmed.index,\n            ax=ax1)\nax1.set_title(\"Top 15 countries as per Number of Confirmed Cases\")\nsns.barplot(x=top_15_deaths[\"Deaths\"],y=top_15_deaths.index,ax=ax2)\nax2.set_title(\"Top 15 countries as per Number of Death Cases\")","51517bb8":"grouped_country=covid.groupby([\"Country\/Region\",\"ObservationDate\"]).agg({\"Confirmed\":'sum',\"Recovered\":'sum',\"Deaths\":'sum'})","64f8ee71":"grouped_country[\"Active Cases\"]=grouped_country[\"Confirmed\"]-grouped_country[\"Recovered\"]-grouped_country[\"Deaths\"]\ngrouped_country[\"log_confirmed\"]=np.log(grouped_country[\"Confirmed\"])\ngrouped_country[\"log_active\"]=np.log(grouped_country[\"Active Cases\"])","7343cdfd":"plt.figure(figsize=(15,10))\nfor country in countrywise.head(10).index:\n    sns.lineplot(x=grouped_country.loc[country][\"log_confirmed\"],y=grouped_country.loc[country][\"log_active\"],\n                 label=country,linewidth=3)\nplt.xlabel(\"Confirmed Cases (Logrithmic Scale)\")\nplt.ylabel(\"Active Cases (Logarithmic Scale)\")\nplt.title(\"COVID-19 Journey of Top 10 countries having Highest number of Confirmed Cases\")","41a590ad":"from sklearn.model_selection import GridSearchCV\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.cluster import KMeans\nfrom sklearn.metrics import silhouette_score,silhouette_samples\nfrom sklearn.linear_model import LinearRegression,Ridge,Lasso\nfrom sklearn.svm import SVR\nfrom sklearn.metrics import mean_squared_error,r2_score\nfrom sklearn.preprocessing import PolynomialFeatures","742c5e79":"import statsmodels.api as sm\nfrom statsmodels.tsa.api import Holt,SimpleExpSmoothing,ExponentialSmoothing\nfrom statsmodels.tsa.stattools import adfuller\nfrom statsmodels.tsa.arima_model import ARIMA\nfrom statsmodels.graphics.tsaplots import plot_acf,plot_pacf","ee62ed7e":"from fbprophet import Prophet\n","58bd7d02":"std=StandardScaler()","d0c0043a":"X=countrywise[[\"Confirmed\",\"Recovered\",\"Deaths\"]]\nX=std.fit_transform(X)","d1bf1377":"countrywise[[\"Confirmed\",\"Recovered\",\"Deaths\"]].head()","b9d192b8":"X","c75496f1":"silhouette_score","9a1f00f2":"wcss=[]\nsil=[]\nfor i in range(2,11):\n    clf=KMeans(n_clusters=i,init='k-means++',random_state=42)\n    clf.fit(X)\n    labels=clf.labels_\n    centroids=clf.cluster_centers_\n    sil.append(silhouette_score(X, labels, metric='euclidean'))\n    wcss.append(clf.inertia_)","c85eaea1":"wcss","4e4dc7c3":"sil","73b7744a":"fig, (ax1, ax2) = plt.subplots(1, 2,figsize=(16,5))\nx=np.arange(2,11)\nax1.plot(x,wcss,marker='o')\nax1.set_xlabel(\"Number of Clusters\")\nax1.set_ylabel(\"Within Cluster Sum of Squares (WCSS)\")\nax1.set_title(\"Elbow Method\")\nx=np.arange(2,11)\nax2.plot(x,sil,marker='o')\nax2.set_xlabel(\"Number of Clusters\")\nax2.set_ylabel(\"Silhouette Score\")\nax2.set_title(\"Silhouette Score Method\")","8a9dcf7c":"#Correct number of Clusters could be k=4","97885f1e":"clf_final=KMeans(n_clusters=5,init='k-means++',random_state=42)\nclf_final.fit(X)","0fdbba11":"countrywise[\"Clusters\"]=clf_final.predict(X)","134c7d49":"countrywise[\"Clusters\"]","c7be2d9e":"cluster_summary=pd.concat([countrywise[countrywise[\"Clusters\"]==1],\n                           countrywise[countrywise[\"Clusters\"]==2],\n                           countrywise[countrywise[\"Clusters\"]==3],\n                           countrywise[countrywise[\"Clusters\"]==4],\n                           countrywise[countrywise[\"Clusters\"]==0].head(15)])","2deca92e":"cluster_summary.style.background_gradient(cmap='Reds')","3386393b":"plt.figure(figsize=(10,5))\nsns.scatterplot(x=countrywise[\"Confirmed\"],y=countrywise[\"Deaths\"],hue=countrywise[\"Clusters\"],s=100)","aa9886ec":"datewise.iloc[0]","58c1c92c":"datewise[\"Days Since\"]=datewise.index-datewise.index[0]\ndatewise[\"Days Since\"]=datewise[\"Days Since\"].dt.days","9ca20df2":"datewise.head()","dd6149ba":"train_ml=datewise.iloc[:int(datewise.shape[0]*0.95)]\nvalid_ml=datewise.iloc[int(datewise.shape[0]*0.95):]\nmodel_scores=[]","1b565e76":"lin_reg=LinearRegression(normalize=True)","cd26ab41":"lin_reg.fit(np.array(train_ml[\"Days Since\"]).reshape(-1,1),\n            np.array(train_ml[\"Confirmed\"]).reshape(-1,1))","5b67b24c":"prediction_valid_linreg = lin_reg.predict(np.array(valid_ml[\"Days Since\"]).reshape(-1,1))","ddcc673a":"prediction_valid_linreg","a38e3fbd":"valid_ml[\"Confirmed\"]","aae31ec4":"model_scores.append(np.sqrt(mean_squared_error(valid_ml[\"Confirmed\"],\n                                               prediction_valid_linreg)))","f1c82ec0":"np.sqrt(mean_squared_error(valid_ml[\"Confirmed\"],prediction_valid_linreg))","cec8afcc":"plt.figure(figsize=(11,6))\nprediction_linreg=lin_reg.predict(np.array(datewise[\"Days Since\"]).reshape(-1,1))\nplt.plot(datewise[\"Confirmed\"],label=\"Actual Confirmed Cases\")\nplt.plot(datewise.index,prediction_linreg, linestyle='--',label=\"Predicted Confirmed Cases using Linear Regression\",color='black')\nplt.xlabel('Time')\nplt.ylabel('Confirmed Cases')\nplt.title(\"Confirmed Cases Linear Regression Prediction\")\nplt.xticks(rotation=90)\nplt.legend()","c3ebbabe":"#The Linear Regression Model is absolutely falling aprat. As it is clearly visible that the trend of Confirmed Cases in absolutely not Linear","70ffb64c":"poly = PolynomialFeatures(degree = 6)","5e2dbed7":"train_poly=poly.fit_transform(np.array(train_ml[\"Days Since\"]).reshape(-1,1))\nvalid_poly=poly.fit_transform(np.array(valid_ml[\"Days Since\"]).reshape(-1,1))\ny=train_ml[\"Confirmed\"]","6be0b4c5":"train_poly","9a584fc1":"linreg=LinearRegression(normalize=True)\nlinreg.fit(train_poly,y)","43cd28b4":"prediction_poly=linreg.predict(valid_poly)\nrmse_poly=np.sqrt(mean_squared_error(valid_ml[\"Confirmed\"],prediction_poly))\nmodel_scores.append(rmse_poly)\nprint(\"Root Mean Squared Error for Polynomial Regression: \",rmse_poly)","867fe2ab":"comp_data=poly.fit_transform(np.array(datewise[\"Days Since\"]).reshape(-1,1))\nplt.figure(figsize=(11,6))\npredictions_poly=linreg.predict(comp_data)\nplt.plot(datewise[\"Confirmed\"],label=\"Train Confirmed Cases\",linewidth=3)\nplt.plot(datewise.index,predictions_poly, linestyle='--',label=\"Best Fit for Polynomial Regression\",color='black')\nplt.xlabel('Time')\nplt.ylabel('Confirmed Cases')\nplt.title(\"Confirmed Cases Polynomial Regression Prediction\")\nplt.xticks(rotation=90)\nplt.legend()","955202ec":"new_prediction_poly=[]\nfor i in range(1,18):\n    new_date_poly=poly.fit_transform(np.array(datewise[\"Days Since\"].max()+i).reshape(-1,1))\n    new_prediction_poly.append(linreg.predict(new_date_poly)[0])","b6ef6ba3":"new_prediction_poly","b9259305":"#Support Vector Machine ModelRegressor for Prediction of Confirmed Cases","ac8a0326":"train_ml=datewise.iloc[:int(datewise.shape[0]*0.95)]\nvalid_ml=datewise.iloc[int(datewise.shape[0]*0.95):]","0a48548c":"svm=SVR(C=1,degree=5,kernel='poly',epsilon=0.01)\n#Intializing SVR Model","f96011d5":"#Fitting model on the training data\nsvm.fit(np.array(train_ml[\"Days Since\"]).reshape(-1,1),\n        np.array(train_ml[\"Confirmed\"]).reshape(-1,1))","de140f19":"prediction_valid_svm=svm.predict(np.array(valid_ml[\"Days Since\"]).reshape(-1,1))","add14e11":"model_scores.append(np.sqrt(mean_squared_error(valid_ml[\"Confirmed\"],prediction_valid_svm)))\nnp.sqrt(mean_squared_error(valid_ml[\"Confirmed\"],prediction_valid_svm))","7e92d0d7":"plt.figure(figsize=(11,6))\nprediction_svm=svm.predict(np.array(datewise[\"Days Since\"]).reshape(-1,1))\nplt.plot(datewise[\"Confirmed\"],label=\"Train Confirmed Cases\",linewidth=3)\nplt.plot(datewise.index,prediction_svm, linestyle='--',label=\"Best Fit for SVR\",color='black')\nplt.xlabel('Time')\nplt.ylabel('Confirmed Cases')\nplt.title(\"Confirmed Cases Support Vector Machine Regressor Prediction\")\nplt.xticks(rotation=90)\nplt.legend()","b18f8c55":"new_date=[]\nnew_prediction_lr=[]\nnew_prediction_svm=[]\nfor i in range(1,18):\n    new_date.append(datewise.index[-1]+timedelta(days=i))\n    new_prediction_lr.append(lin_reg.predict(np.array(datewise[\"Days Since\"].max()+i).reshape(-1,1))[0][0])\n    new_prediction_svm.append(svm.predict(np.array(datewise[\"Days Since\"].max()+i).reshape(-1,1))[0])","524e6a4d":"pd.set_option('display.float_format', lambda x: '%.6f' % x)\nmodel_predictions=pd.DataFrame(zip(new_date, \n                                   new_prediction_lr, \n                                   new_prediction_poly,\n                                   new_prediction_svm),\n                               columns=[\"Dates\",\"Linear Regression Prediction\",\n                                        \"Polynonmial Regression Prediction\",\"SVM Prediction\"])\nmodel_predictions.head()","9c78992b":"# Time Series Forecasting","16d3c170":"model_train=datewise.iloc[:int(datewise.shape[0]*0.95)]\nvalid=datewise.iloc[int(datewise.shape[0]*0.95):]","43b3eceb":"Holt","ccd4395e":"holt=Holt(np.asarray(model_train[\"Confirmed\"]))","8509e7a2":"holt = holt.fit(smoothing_level=1.0, smoothing_slope=0.1,optimized=False)","b9cf742d":"y_pred=valid.copy()","fc18ce90":"len(valid)","c7794d45":"holt.__dir__","6cfdde05":"y_pred[\"Holt\"]=holt.forecast(len(valid))","348149e2":"model_scores.append(np.sqrt(mean_squared_error(y_pred[\"Confirmed\"],y_pred[\"Holt\"])))\nnp.sqrt(mean_squared_error(y_pred[\"Confirmed\"],y_pred[\"Holt\"]))","3df517c9":"y_pred.Holt","ea30502f":"plt.figure(figsize=(10,5))\nplt.plot(model_train.Confirmed,label=\"Train Set\",linewidth=3)\nvalid.Confirmed.plot(label=\"Validation Set\",linewidth=3)\ny_pred.Holt.plot(label=\"Holt's Linear Model Predicted Set\",linewidth=3)\nplt.ylabel(\"Confirmed Cases\")\nplt.xlabel(\"Date Time\")\nplt.title(\"Confirmed Holt's Linear Model Prediction\")\nplt.xticks(rotation=90)\nplt.legend()","d13a2b90":"holt_new_date=[]\nholt_new_prediction=[]\nfor i in range(1,18):\n    holt_new_date.append(datewise.index[-1]+timedelta(days=i))\n    holt_new_prediction.append(holt.forecast((len(valid)+i))[-1])\nmodel_predictions[\"Holt's Linear Model Prediction\"]=holt_new_prediction\nmodel_predictions.head()","eb6abab2":"## Holt's Winter Model for Daily Time Series","44589a33":"ExponentialSmoothing","d2dea1d6":"model_train","a09a8ead":"es=ExponentialSmoothing(np.asarray(model_train['Confirmed']),\n                        seasonal_periods=10,\n                        trend='mul', \n                        seasonal='add').fit()","b6645893":"y_pred[\"Holt's Winter Model\"]=es.forecast(len(valid))","9b8ebbf8":"model_scores.append(np.sqrt(mean_squared_error(y_pred[\"Confirmed\"],y_pred[\"Holt's Winter Model\"])))\nnp.sqrt(mean_squared_error(y_pred[\"Confirmed\"],y_pred[\"Holt's Winter Model\"]))","6c0b1e10":"plt.figure(figsize=(10,5))\nplt.plot(model_train.Confirmed,label=\"Train Set\",linewidth=3)\nvalid.Confirmed.plot(label=\"Validation Set\",linewidth=3)\ny_pred[\"Holt\\'s Winter Model\"].plot(label=\"Holt's Winter Model Predicted Set\",linewidth=3)\nplt.ylabel(\"Confirmed Cases\")\nplt.xlabel(\"Date Time\")\nplt.title(\"Confiremd Cases Holt's Winter Model Prediction\")\nplt.xticks(rotation=90)\nplt.legend()","ed135983":"holt_winter_new_prediction=[]\nfor i in range(1,18):\n    holt_winter_new_prediction.append(es.forecast((len(valid)+i))[-1])\nmodel_predictions[\"Holt's Winter Model Prediction\"]=holt_winter_new_prediction\nmodel_predictions.head()","fab32fef":"#AR Model (using AUTO ARIMA)","4747b141":"model_train=datewise.iloc[:int(datewise.shape[0]*0.95)]\nvalid=datewise.iloc[int(datewise.shape[0]*0.95):]\ny_pred=valid.copy()","552030c1":"!pip install pmdarima\nfrom pmdarima.arima import auto_arima","135acbda":"model_ma = auto_arima(model_train[\"Confirmed\"], trace=True, \n                     error_action='ignore', \n                     start_p=0, start_q=0, max_p=0, max_q=3,\n                     suppress_warnings=True,\n                     stepwise=False,\n                     seasonal=False)\nmodel_ma.fit(model_train[\"Confirmed\"])","e62c5507":"auto_arima","563b90b7":"model_ar= auto_arima(model_train[\"Confirmed\"],\n                     trace=True, \n                     error_action='ignore',\n                     start_p=0,\n                     start_q=0,\n                     max_p=5,\n                     max_q=0,\n                    suppress_warnings=True,stepwise=False,seasonal=False)\nmodel_ar.fit(model_train[\"Confirmed\"])","9bface8a":"prediction_ar=model_ar.predict(len(valid))\ny_pred[\"AR Model Prediction\"]=prediction_ar","0c963ed0":"model_scores.append(np.sqrt(mean_squared_error(y_pred[\"Confirmed\"],y_pred[\"AR Model Prediction\"])))\nnp.sqrt(mean_squared_error(y_pred[\"Confirmed\"],y_pred[\"AR Model Prediction\"]))","a41d8442":"plt.figure(figsize=(10,5))\nplt.plot(model_train.index,model_train[\"Confirmed\"],label=\"Train Set\",linewidth=3)\nplt.plot(valid.index,valid[\"Confirmed\"],\n         label=\"Validation Set\",linewidth=3)\nplt.plot(y_pred[\"AR Model Prediction\"],label=\"AR Model Prediction set\",linewidth=3)\nplt.legend()\nplt.xlabel(\"Date Time\")\nplt.ylabel('Confirmed Cases')\nplt.title(\"Confirmed Cases AR Model Forecasting\")\nplt.xticks(rotation=90)","c0849911":"AR_model_new_prediction=[]\nfor i in range(1,18):\n    AR_model_new_prediction.append(model_ar.predict(len(valid)+i)[-1])\nmodel_predictions[\"AR Model Prediction\"]=AR_model_new_prediction\nmodel_predictions.head()","b15e8222":"## MA Model (using AUTO ARIMA)","701113d2":"model_train=datewise.iloc[:int(datewise.shape[0]*0.95)]\nvalid=datewise.iloc[int(datewise.shape[0]*0.95):]\ny_pred=valid.copy()","62cf723d":"model_ma= auto_arima(model_train[\"Confirmed\"],\n                     trace=True,\n                     error_action='ignore',\n                     start_p=0,\n                     start_q=0,\n                     max_p=0,\n                     max_q=3,\n                     suppress_warnings=True,stepwise=False,seasonal=False)\nmodel_ma.fit(model_train[\"Confirmed\"])","962248ab":"prediction_ma=model_ma.predict(len(valid))\ny_pred[\"MA Model Prediction\"]=prediction_ma","a057903c":"model_scores.append(np.sqrt(mean_squared_error(valid[\"Confirmed\"],prediction_ma)))\nnp.sqrt(mean_squared_error(valid[\"Confirmed\"],prediction_ma))","0843eefb":"plt.figure(figsize=(10,5))\nplt.plot(model_train.index,model_train[\"Confirmed\"],label=\"Train Set\",linewidth=3)\nplt.plot(valid.index,valid[\"Confirmed\"],label=\"Validation Set\",linewidth=3)\nplt.plot(y_pred[\"MA Model Prediction\"],label=\"MA Mode Prediction Set\",linewidth=3)\nplt.legend()\nplt.xlabel(\"Date Time\")\nplt.ylabel('Confirmed Cases')\nplt.title(\"Confirmed Cases MA Model Forecasting\")\nplt.xticks(rotation=90)","284a052d":"MA_model_new_prediction=[]\nfor i in range(1,18):\n    MA_model_new_prediction.append(model_ma.predict(len(valid)+i)[-1])\nmodel_predictions[\"MA Model Prediction\"]=MA_model_new_prediction\nmodel_predictions.head()","7fdbdc92":"# ARIMA Model (using AUTOARIMA)","72512681":"model_train=datewise.iloc[:int(datewise.shape[0]*0.95)]\nvalid=datewise.iloc[int(datewise.shape[0]*0.95):]\ny_pred=valid.copy()","066c7528":"model_arima= auto_arima(model_train[\"Confirmed\"],\n                        trace=True, \n                        error_action='ignore', \n                        start_p=1,\n                        start_q=1,\n                        max_p=2,\n                        max_q=2,\n                        suppress_warnings=True,stepwise=False,seasonal=False)\nmodel_arima.fit(model_train[\"Confirmed\"])","18729e70":"prediction_arima=model_arima.predict(len(valid))\ny_pred[\"ARIMA Model Prediction\"]=prediction_arima","5a67bdf3":"model_scores.append(np.sqrt(mean_squared_error(valid[\"Confirmed\"],prediction_arima)))\nnp.sqrt(mean_squared_error(valid[\"Confirmed\"],prediction_arima))","f5ffeecd":"plt.figure(figsize=(10,5))\nplt.plot(model_train.index,model_train[\"Confirmed\"],label=\"Train Set\",linewidth=3)\nplt.plot(valid.index,valid[\"Confirmed\"],label=\"Validation Set\",linewidth=3)\nplt.plot(y_pred[\"ARIMA Model Prediction\"],label=\"ARIMA Model Prediction Set\",linewidth=3)\nplt.legend()\nplt.xlabel(\"Date Time\")\nplt.ylabel('Confirmed Cases')\nplt.title(\"Confirmed Cases ARIMA Model Forecasting\")\nplt.xticks(rotation=90)","33ae1a85":"ARIMA_model_new_prediction=[]\nfor i in range(1,18):\n    ARIMA_model_new_prediction.append(model_arima.predict(len(valid)+i)[-1])\nmodel_predictions[\"ARIMA Model Prediction\"]=ARIMA_model_new_prediction\nmodel_predictions.head()","2a109063":"## SARIMA Model (using AUTO ARIMA)\n","c9c965db":"model_sarima= auto_arima(model_train[\"Confirmed\"],trace=True, error_action='ignore', \n                         start_p=0,start_q=0,max_p=3,max_q=3,m=24,\n                   suppress_warnings=True,stepwise=True,seasonal=True)\nmodel_sarima.fit(model_train[\"Confirmed\"])","91f05fd8":"prediction_sarima=model_sarima.predict(len(valid))\ny_pred[\"SARIMA Model Prediction\"]=prediction_sarima","1a7aff28":"model_scores.append(np.sqrt(mean_squared_error(y_pred[\"Confirmed\"],y_pred[\"SARIMA Model Prediction\"])))\nnp.sqrt(mean_squared_error(y_pred[\"Confirmed\"],y_pred[\"SARIMA Model Prediction\"]))","196df126":"plt.figure(figsize=(10,5))\nplt.plot(model_train.index,model_train[\"Confirmed\"],label=\"Train Set\",linewidth=3)\nplt.plot(valid.index,valid[\"Confirmed\"],label=\"Validation Set\",linewidth=3)\nplt.plot(y_pred[\"SARIMA Model Prediction\"],label=\"SARIMA Model Prediction Set\",linewidth=3)\nplt.legend()\nplt.xlabel(\"Date Time\")\nplt.ylabel('Confirmed Cases')\nplt.title(\"Confirmed Cases SARIMA Model Forecasting\")\nplt.xticks(rotation=90)","a252c9bd":"SARIMA_model_new_prediction=[]\nfor i in range(1,18):\n    SARIMA_model_new_prediction.append(model_sarima.predict(len(valid)+i)[-1])\nmodel_predictions[\"SARIMA Model Prediction\"]=SARIMA_model_new_prediction\nmodel_predictions.head()","a42c1dae":"### Prediction using Machine Learning Models"}}