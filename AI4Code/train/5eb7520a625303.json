{"cell_type":{"816ab194":"code","48dc4d67":"code","bc6a6e5a":"code","978debea":"code","ca8369af":"code","cc85446d":"code","75fa6a87":"code","f046def2":"code","18477147":"code","d85c21c9":"code","c599d052":"code","89b5da33":"code","52b984ae":"code","5c4cbd30":"code","dce32fa6":"code","ce4ff339":"markdown","c92bf38e":"markdown","5170e7c2":"markdown","0e191370":"markdown","7e14b8aa":"markdown","b67379d0":"markdown","f0bac4ae":"markdown","ed6fcc1c":"markdown","ec25aaf3":"markdown","35438bb2":"markdown","e6fc85dc":"markdown"},"source":{"816ab194":"# =======================================================\n# TPS October 2021 - LazyPredict\n# =======================================================\n# Name: B\u00e1rbara Sulpis\n# Date: 11-oct-2021\n# Description: I will run an auto machine learning with the library \"LazyPredict\"\n#  This will run 29 models and throws the kpis of each model\n#  This is a good tool to check which algorithm perform better for the dataset\n#  NOTE: It delays a lot of time. In the free KAGGLE notebook could delay 9 hours\n#  I Strongly recommend to run it locally in your pc \n#  because in kaggle notebooks or google colab it hangs and doesn't reach to the end successfully\n#\n# Python 3 - kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport os\n\nfrom sklearn.model_selection import train_test_split\n\n#Lgbm\nimport lightgbm as lgb\n\n# roc\nimport sklearn.metrics as metrics   # Para la curva ROC\nimport matplotlib.pyplot as plt     # Para la curva ROC\n\n# ---------------------------------------------------------------------------------\n# Input data:\n# Go to file -> add or upload data -> \"Competition\" data tab \n#    and select the commpetition which you want to add the csv data data \n#    in this example I worked with \"Tabular Playground Oct 2021\"\n# files are available in the read-only \"..\/input\/\" directory\n# ---------------------------------------------------------------------------------\n#list =  os. getcwd()\n#print(list)\n#os. chdir(\"kaggle\") \n\nlist =  os. getcwd()\nprint(list) # shoud be in \"kaggle\" directory\n\n# I left this commented if you want to check that the files are there\n# i = 0\n# for subdir, dirs, files in os.walk('.\/'):\n#     for file in files:\n#         print(file)\n#         i+= 1\n#         if i>20: \n#             break\n\ndata = pd.read_csv(\"..\/input\/tabular-playground-series-oct-2021\/train.csv\")        \nsubm = pd.read_csv(\"..\/input\/tabular-playground-series-oct-2021\/test.csv\")        \n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","48dc4d67":"def reduce_mem_usage(props):\n    start_mem_usg = props.memory_usage().sum() \/ 1024**2 \n    print(\"Memory usage of properties dataframe is :\",start_mem_usg,\" MB\")\n    for col in props.columns:\n        if props[col].dtype != object:  # Exclude strings\n            # make variables for Int, max and min\n            IsInt = False\n            mx = props[col].max()\n            mn = props[col].min()\n    \n            # test if column can be converted to an integer\n            asint = props[col].astype(np.int64)\n            result = (props[col] - asint)\n            result = result.sum()\n            if result > -0.01 and result < 0.01:\n                IsInt = True\n\n            \n            # Make Integer\/unsigned Integer datatypes\n            if IsInt:\n                if mn >= 0:\n                    if mx < 255:\n                        props[col] = props[col].astype(np.uint8)\n                    elif mx < 65535:\n                        props[col] = props[col].astype(np.uint16)\n                    elif mx < 4294967295:\n                        props[col] = props[col].astype(np.uint32)\n                    else:\n                        props[col] = props[col].astype(np.uint64)\n                else:\n                    if mn > np.iinfo(np.int8).min and mx < np.iinfo(np.int8).max:\n                        props[col] = props[col].astype(np.int8)\n                    elif mn > np.iinfo(np.int16).min and mx < np.iinfo(np.int16).max:\n                        props[col] = props[col].astype(np.int16)\n                    elif mn > np.iinfo(np.int32).min and mx < np.iinfo(np.int32).max:\n                        props[col] = props[col].astype(np.int32)\n                    elif mn > np.iinfo(np.int64).min and mx < np.iinfo(np.int64).max:\n                        props[col] = props[col].astype(np.int64)    \n            \n            # Make float datatypes 32 bit\n            else:\n                props[col] = props[col].astype(np.float32)\n    \n    # Print final result\n    print(\"___MEMORY USAGE AFTER COMPLETION:___\")\n    mem_usg = props.memory_usage().sum() \/ 1024**2 \n    print(\"Memory usage is: \",mem_usg,\" MB\")\n    print(\"This is \",100*mem_usg\/start_mem_usg,\"% of the initial size\")\n    return props\n","bc6a6e5a":"# We have to install lazypredict library to kaggle notebook because it is not included.\n%pip install lazypredict","978debea":"# We install Lazypredict after instalation\nfrom lazypredict.Supervised import LazyClassifier,LazyRegressor","ca8369af":"# Make sampling of the data because the dataset is too big \ndatasam =  data.sample(n=100000)","cc85446d":"# Reduction of memory usage\ndatasam = reduce_mem_usage(datasam)","75fa6a87":"# --------------------------------------------------------------------\n#     TARGET\n# --------------------------------------------------------------------\ny = datasam['target']\nX = datasam.drop(['target', 'id'], axis=1)","f046def2":"# --------------------------------------------------------------------\n#     SPLIT TRAIN - TEST - VALIDATION\n# --------------------------------------------------------------------\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=123)","18477147":"# --------------------------------------------------------------------\n#     CLASSIFIER\n# --------------------------------------------------------------------\nclassi=LazyClassifier(verbose=0,predictions=True)","d85c21c9":"# --------------------------------------------------------------------\n#     FIT\n# --------------------------------------------------------------------\nmodels_c,predictions_c=classi.fit(X_train, X_test, y_train, y_test)\n","c599d052":"# --------------------------------------------------------------------\n#     OUTPUT\n# --------------------------------------------------------------------\nmodels_c","89b5da33":"# NOTE: The algorithm elapsed a total of 4 hours in my personal pc: i7, 16GB","52b984ae":"#After completion, we can access the data of the processing of each algorithm\nclassi.models['LGBMClassifier']","5c4cbd30":"classi.models['BernoulliNB']","dce32fa6":"# All models\nclassi.models","ce4ff339":"# Conclusion\n\nWith LazyPredict we won't get our final model to implement in production, but we can have an aproximation of which models perform better than others.\nIn this case, for \"TPS Oct 2021\" we colud work directly with the first 3 or 4 models and think on an ensemble solution.","c92bf38e":"# Installation of LazyPredict in the notebook","5170e7c2":"Pipeline(steps=[('preprocessor',\n                 ColumnTransformer(transformers=[('numeric',\n                                                  Pipeline(steps=[('imputer',\n                                                                   SimpleImputer()),\n                                                                  ('scaler',\n                                                                   StandardScaler())]),\n                                                  Index(['f0', 'f1', 'f2', 'f3', 'f4', 'f5', 'f6', 'f7', 'f8', 'f9',\n       ...\n       'f275', 'f276', 'f277', 'f278', 'f279', 'f280', 'f281', 'f282', 'f283',\n       'f284'],\n      dtype='object', length=285)),\n                                                 ('categorical_low',\n                                                  Pipeline(steps=[('imput...\n                                                                   SimpleImputer(fill_value='missing',\n                                                                                 strategy='constant')),\n                                                                  ('encoding',\n                                                                   OneHotEncoder(handle_unknown='ignore',\n                                                                                 sparse=False))]),\n                                                  Index([], dtype='object')),\n                                                 ('categorical_high',\n                                                  Pipeline(steps=[('imputer',\n                                                                   SimpleImputer(fill_value='missing',\n                                                                                 strategy='constant')),\n                                                                  ('encoding',\n                                                                   OrdinalEncoder())]),\n                                                  Index([], dtype='object'))])),\n                ('classifier', LGBMClassifier(random_state=42))])","0e191370":"Pipeline(steps=[('preprocessor',\n                 ColumnTransformer(transformers=[('numeric',\n                                                  Pipeline(steps=[('imputer',\n                                                                   SimpleImputer()),\n                                                                  ('scaler',\n                                                                   StandardScaler())]),\n                                                  Index(['f0', 'f1', 'f2', 'f3', 'f4', 'f5', 'f6', 'f7', 'f8', 'f9',\n       ...\n       'f275', 'f276', 'f277', 'f278', 'f279', 'f280', 'f281', 'f282', 'f283',\n       'f284'],\n      dtype='object', length=285)),\n                                                 ('categorical_low',\n                                                  Pipeline(steps=[('imputer',\n                                                                   SimpleImputer(fill_value='missing',\n                                                                                 strategy='constant')),\n                                                                  ('encoding',\n                                                                   OneHotEncoder(handle_unknown='ignore',\n                                                                                 sparse=False))]),\n                                                  Index([], dtype='object')),\n                                                 ('categorical_high',\n                                                  Pipeline(steps=[('imputer',\n                                                                   SimpleImputer(fill_value='missing',\n                                                                                 strategy='constant')),\n                                                                  ('encoding',\n                                                                   OrdinalEncoder())]),\n                                                  Index([], dtype='object'))])),\n                ('classifier', BernoulliNB())])","7e14b8aa":"![](http:\/\/storage.googleapis.com\/kagglesdsdata\/datasets\/1642245\/2696798\/LazyClassifier_Output.JPG?X-Goog-Algorithm=GOOG4-RSA-SHA256&X-Goog-Credential=databundle-worker-v2%40kaggle-161607.iam.gserviceaccount.com%2F20211011%2Fauto%2Fstorage%2Fgoog4_request&X-Goog-Date=20211011T220846Z&X-Goog-Expires=345599&X-Goog-SignedHeaders=host&X-Goog-Signature=36028cc47ab8ddc360a12680533209103048444e19d16eb41c8996032e865b1f9c28b5cac8432bcc9ca25c2333a710e25c651844ea159e0790b4f7bd780bc9d28eea421e2a9c3850c83ba20c921048dd25845f904ae90603e0bc226eceab6b9b141d66ea9d588ec88d64ceb5f3e25064e147bdb930fea38ba3841c3839d76a0a7f539b01fb3ab49ccfa49e1b007e64139500c00586fd494d98a4d0cb451869b5193e36262075617bfbbcf3a922a3d593542c911a259ef46c51ae45eaa66b71c1620131fbbb6ac544ade9204ea65e2fabc352c244a42a4336b721e2ecf94d6b70993ebd1e25c99603f64aeba92384c1ce88dac421a2a1a185e618e0aa8666b484)","b67379d0":"# A little more detail of the intern configuration of the models","f0bac4ae":"# Memory usage reduction\nAs the dataset is very big and has anonymus features, with this very useful function we deduce the datatypes of each field and reduces the space used in memory","ed6fcc1c":"# Fitting\nWe ran the algorithm. It elapses many hours.","ec25aaf3":"{'AdaBoostClassifier': Pipeline(steps=[('preprocessor',\n                  ColumnTransformer(transformers=[('numeric',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer()),\n                                                                   ('scaler',\n                                                                    StandardScaler())]),\n                                                   Index(['f0', 'f1', 'f2', 'f3', 'f4', 'f5', 'f6', 'f7', 'f8', 'f9',\n        ...\n        'f275', 'f276', 'f277', 'f278', 'f279', 'f280', 'f281', 'f282', 'f283',\n        'f284'],\n       dtype='object', length=285)),\n                                                  ('categorical_low',\n                                                   Pipeline(steps=[('imput...\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OneHotEncoder(handle_unknown='ignore',\n                                                                                  sparse=False))]),\n                                                   Index([], dtype='object')),\n                                                  ('categorical_high',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OrdinalEncoder())]),\n                                                   Index([], dtype='object'))])),\n                 ('classifier', AdaBoostClassifier(random_state=42))]),\n                 \n 'BaggingClassifier': Pipeline(steps=[('preprocessor',\n                  ColumnTransformer(transformers=[('numeric',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer()),\n                                                                   ('scaler',\n                                                                    StandardScaler())]),\n                                                   Index(['f0', 'f1', 'f2', 'f3', 'f4', 'f5', 'f6', 'f7', 'f8', 'f9',\n        ...\n        'f275', 'f276', 'f277', 'f278', 'f279', 'f280', 'f281', 'f282', 'f283',\n        'f284'],\n       dtype='object', length=285)),\n                                                  ('categorical_low',\n                                                   Pipeline(steps=[('imput...\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OneHotEncoder(handle_unknown='ignore',\n                                                                                  sparse=False))]),\n                                                   Index([], dtype='object')),\n                                                  ('categorical_high',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OrdinalEncoder())]),\n                                                   Index([], dtype='object'))])),\n                 ('classifier', BaggingClassifier(random_state=42))]),\n                 \n 'BernoulliNB': Pipeline(steps=[('preprocessor',\n                  ColumnTransformer(transformers=[('numeric',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer()),\n                                                                   ('scaler',\n                                                                    StandardScaler())]),\n                                                   Index(['f0', 'f1', 'f2', 'f3', 'f4', 'f5', 'f6', 'f7', 'f8', 'f9',\n        ...\n        'f275', 'f276', 'f277', 'f278', 'f279', 'f280', 'f281', 'f282', 'f283',\n        'f284'],\n       dtype='object', length=285)),\n                                                  ('categorical_low',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OneHotEncoder(handle_unknown='ignore',\n                                                                                  sparse=False))]),\n                                                   Index([], dtype='object')),\n                                                  ('categorical_high',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OrdinalEncoder())]),\n                                                   Index([], dtype='object'))])),\n                 ('classifier', BernoulliNB())]),\n                 \n 'CalibratedClassifierCV': Pipeline(steps=[('preprocessor',\n                  ColumnTransformer(transformers=[('numeric',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer()),\n                                                                   ('scaler',\n                                                                    StandardScaler())]),\n                                                   Index(['f0', 'f1', 'f2', 'f3', 'f4', 'f5', 'f6', 'f7', 'f8', 'f9',\n        ...\n        'f275', 'f276', 'f277', 'f278', 'f279', 'f280', 'f281', 'f282', 'f283',\n        'f284'],\n       dtype='object', length=285)),\n                                                  ('categorical_low',\n                                                   Pipeline(steps=[('imput...\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OneHotEncoder(handle_unknown='ignore',\n                                                                                  sparse=False))]),\n                                                   Index([], dtype='object')),\n                                                  ('categorical_high',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OrdinalEncoder())]),\n                                                   Index([], dtype='object'))])),\n                 ('classifier', CalibratedClassifierCV())]),\n                 \n 'DecisionTreeClassifier': Pipeline(steps=[('preprocessor',\n                  ColumnTransformer(transformers=[('numeric',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer()),\n                                                                   ('scaler',\n                                                                    StandardScaler())]),\n                                                   Index(['f0', 'f1', 'f2', 'f3', 'f4', 'f5', 'f6', 'f7', 'f8', 'f9',\n        ...\n        'f275', 'f276', 'f277', 'f278', 'f279', 'f280', 'f281', 'f282', 'f283',\n        'f284'],\n       dtype='object', length=285)),\n                                                  ('categorical_low',\n                                                   Pipeline(steps=[('imput...\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OneHotEncoder(handle_unknown='ignore',\n                                                                                  sparse=False))]),\n                                                   Index([], dtype='object')),\n                                                  ('categorical_high',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OrdinalEncoder())]),\n                                                   Index([], dtype='object'))])),\n                 ('classifier', DecisionTreeClassifier(random_state=42))]),\n                 \n 'DummyClassifier': Pipeline(steps=[('preprocessor',\n                  ColumnTransformer(transformers=[('numeric',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer()),\n                                                                   ('scaler',\n                                                                    StandardScaler())]),\n                                                   Index(['f0', 'f1', 'f2', 'f3', 'f4', 'f5', 'f6', 'f7', 'f8', 'f9',\n        ...\n        'f275', 'f276', 'f277', 'f278', 'f279', 'f280', 'f281', 'f282', 'f283',\n        'f284'],\n       dtype='object', length=285)),\n                                                  ('categorical_low',\n                                                   Pipeline(steps=[('imput...\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OneHotEncoder(handle_unknown='ignore',\n                                                                                  sparse=False))]),\n                                                   Index([], dtype='object')),\n                                                  ('categorical_high',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OrdinalEncoder())]),\n                                                   Index([], dtype='object'))])),\n                 ('classifier', DummyClassifier(random_state=42))]),\n                 \n 'ExtraTreeClassifier': Pipeline(steps=[('preprocessor',\n                  ColumnTransformer(transformers=[('numeric',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer()),\n                                                                   ('scaler',\n                                                                    StandardScaler())]),\n                                                   Index(['f0', 'f1', 'f2', 'f3', 'f4', 'f5', 'f6', 'f7', 'f8', 'f9',\n        ...\n        'f275', 'f276', 'f277', 'f278', 'f279', 'f280', 'f281', 'f282', 'f283',\n        'f284'],\n       dtype='object', length=285)),\n                                                  ('categorical_low',\n                                                   Pipeline(steps=[('imput...\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OneHotEncoder(handle_unknown='ignore',\n                                                                                  sparse=False))]),\n                                                   Index([], dtype='object')),\n                                                  ('categorical_high',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OrdinalEncoder())]),\n                                                   Index([], dtype='object'))])),\n                 ('classifier', ExtraTreeClassifier(random_state=42))]),\n                 \n 'ExtraTreesClassifier': Pipeline(steps=[('preprocessor',\n                  ColumnTransformer(transformers=[('numeric',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer()),\n                                                                   ('scaler',\n                                                                    StandardScaler())]),\n                                                   Index(['f0', 'f1', 'f2', 'f3', 'f4', 'f5', 'f6', 'f7', 'f8', 'f9',\n        ...\n        'f275', 'f276', 'f277', 'f278', 'f279', 'f280', 'f281', 'f282', 'f283',\n        'f284'],\n       dtype='object', length=285)),\n                                                  ('categorical_low',\n                                                   Pipeline(steps=[('imput...\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OneHotEncoder(handle_unknown='ignore',\n                                                                                  sparse=False))]),\n                                                   Index([], dtype='object')),\n                                                  ('categorical_high',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OrdinalEncoder())]),\n                                                   Index([], dtype='object'))])),\n                 ('classifier', ExtraTreesClassifier(random_state=42))]),\n                 \n 'GaussianNB': Pipeline(steps=[('preprocessor',\n                  ColumnTransformer(transformers=[('numeric',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer()),\n                                                                   ('scaler',\n                                                                    StandardScaler())]),\n                                                   Index(['f0', 'f1', 'f2', 'f3', 'f4', 'f5', 'f6', 'f7', 'f8', 'f9',\n        ...\n        'f275', 'f276', 'f277', 'f278', 'f279', 'f280', 'f281', 'f282', 'f283',\n        'f284'],\n       dtype='object', length=285)),\n                                                  ('categorical_low',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OneHotEncoder(handle_unknown='ignore',\n                                                                                  sparse=False))]),\n                                                   Index([], dtype='object')),\n                                                  ('categorical_high',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OrdinalEncoder())]),\n                                                   Index([], dtype='object'))])),\n                 ('classifier', GaussianNB())]),\n                 \n 'KNeighborsClassifier': Pipeline(steps=[('preprocessor',\n                  ColumnTransformer(transformers=[('numeric',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer()),\n                                                                   ('scaler',\n                                                                    StandardScaler())]),\n                                                   Index(['f0', 'f1', 'f2', 'f3', 'f4', 'f5', 'f6', 'f7', 'f8', 'f9',\n        ...\n        'f275', 'f276', 'f277', 'f278', 'f279', 'f280', 'f281', 'f282', 'f283',\n        'f284'],\n       dtype='object', length=285)),\n                                                  ('categorical_low',\n                                                   Pipeline(steps=[('imput...\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OneHotEncoder(handle_unknown='ignore',\n                                                                                  sparse=False))]),\n                                                   Index([], dtype='object')),\n                                                  ('categorical_high',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OrdinalEncoder())]),\n                                                   Index([], dtype='object'))])),\n                 ('classifier', KNeighborsClassifier())]),\n                 \n 'LinearDiscriminantAnalysis': Pipeline(steps=[('preprocessor',\n                  ColumnTransformer(transformers=[('numeric',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer()),\n                                                                   ('scaler',\n                                                                    StandardScaler())]),\n                                                   Index(['f0', 'f1', 'f2', 'f3', 'f4', 'f5', 'f6', 'f7', 'f8', 'f9',\n        ...\n        'f275', 'f276', 'f277', 'f278', 'f279', 'f280', 'f281', 'f282', 'f283',\n        'f284'],\n       dtype='object', length=285)),\n                                                  ('categorical_low',\n                                                   Pipeline(steps=[('imput...\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OneHotEncoder(handle_unknown='ignore',\n                                                                                  sparse=False))]),\n                                                   Index([], dtype='object')),\n                                                  ('categorical_high',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OrdinalEncoder())]),\n                                                   Index([], dtype='object'))])),\n                 ('classifier', LinearDiscriminantAnalysis())]),\n                 \n 'LinearSVC': Pipeline(steps=[('preprocessor',\n                  ColumnTransformer(transformers=[('numeric',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer()),\n                                                                   ('scaler',\n                                                                    StandardScaler())]),\n                                                   Index(['f0', 'f1', 'f2', 'f3', 'f4', 'f5', 'f6', 'f7', 'f8', 'f9',\n        ...\n        'f275', 'f276', 'f277', 'f278', 'f279', 'f280', 'f281', 'f282', 'f283',\n        'f284'],\n       dtype='object', length=285)),\n                                                  ('categorical_low',\n                                                   Pipeline(steps=[('imput...\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OneHotEncoder(handle_unknown='ignore',\n                                                                                  sparse=False))]),\n                                                   Index([], dtype='object')),\n                                                  ('categorical_high',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OrdinalEncoder())]),\n                                                   Index([], dtype='object'))])),\n                 ('classifier', LinearSVC(random_state=42))]),\n                 \n 'LogisticRegression': Pipeline(steps=[('preprocessor',\n                  ColumnTransformer(transformers=[('numeric',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer()),\n                                                                   ('scaler',\n                                                                    StandardScaler())]),\n                                                   Index(['f0', 'f1', 'f2', 'f3', 'f4', 'f5', 'f6', 'f7', 'f8', 'f9',\n        ...\n        'f275', 'f276', 'f277', 'f278', 'f279', 'f280', 'f281', 'f282', 'f283',\n        'f284'],\n       dtype='object', length=285)),\n                                                  ('categorical_low',\n                                                   Pipeline(steps=[('imput...\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OneHotEncoder(handle_unknown='ignore',\n                                                                                  sparse=False))]),\n                                                   Index([], dtype='object')),\n                                                  ('categorical_high',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OrdinalEncoder())]),\n                                                   Index([], dtype='object'))])),\n                 ('classifier', LogisticRegression(random_state=42))]),\n                 \n 'NearestCentroid': Pipeline(steps=[('preprocessor',\n                  ColumnTransformer(transformers=[('numeric',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer()),\n                                                                   ('scaler',\n                                                                    StandardScaler())]),\n                                                   Index(['f0', 'f1', 'f2', 'f3', 'f4', 'f5', 'f6', 'f7', 'f8', 'f9',\n        ...\n        'f275', 'f276', 'f277', 'f278', 'f279', 'f280', 'f281', 'f282', 'f283',\n        'f284'],\n       dtype='object', length=285)),\n                                                  ('categorical_low',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OneHotEncoder(handle_unknown='ignore',\n                                                                                  sparse=False))]),\n                                                   Index([], dtype='object')),\n                                                  ('categorical_high',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OrdinalEncoder())]),\n                                                   Index([], dtype='object'))])),\n                 ('classifier', NearestCentroid())]),\n                 \n 'NuSVC': Pipeline(steps=[('preprocessor',\n                  ColumnTransformer(transformers=[('numeric',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer()),\n                                                                   ('scaler',\n                                                                    StandardScaler())]),\n                                                   Index(['f0', 'f1', 'f2', 'f3', 'f4', 'f5', 'f6', 'f7', 'f8', 'f9',\n        ...\n        'f275', 'f276', 'f277', 'f278', 'f279', 'f280', 'f281', 'f282', 'f283',\n        'f284'],\n       dtype='object', length=285)),\n                                                  ('categorical_low',\n                                                   Pipeline(steps=[('imput...\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OneHotEncoder(handle_unknown='ignore',\n                                                                                  sparse=False))]),\n                                                   Index([], dtype='object')),\n                                                  ('categorical_high',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OrdinalEncoder())]),\n                                                   Index([], dtype='object'))])),\n                 ('classifier', NuSVC(random_state=42))]),\n                 \n 'PassiveAggressiveClassifier': Pipeline(steps=[('preprocessor',\n                  ColumnTransformer(transformers=[('numeric',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer()),\n                                                                   ('scaler',\n                                                                    StandardScaler())]),\n                                                   Index(['f0', 'f1', 'f2', 'f3', 'f4', 'f5', 'f6', 'f7', 'f8', 'f9',\n        ...\n        'f275', 'f276', 'f277', 'f278', 'f279', 'f280', 'f281', 'f282', 'f283',\n        'f284'],\n       dtype='object', length=285)),\n                                                  ('categorical_low',\n                                                   Pipeline(steps=[('imput...\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OneHotEncoder(handle_unknown='ignore',\n                                                                                  sparse=False))]),\n                                                   Index([], dtype='object')),\n                                                  ('categorical_high',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OrdinalEncoder())]),\n                                                   Index([], dtype='object'))])),\n                 ('classifier', PassiveAggressiveClassifier(random_state=42))]),\n                 \n 'Perceptron': Pipeline(steps=[('preprocessor',\n                  ColumnTransformer(transformers=[('numeric',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer()),\n                                                                   ('scaler',\n                                                                    StandardScaler())]),\n                                                   Index(['f0', 'f1', 'f2', 'f3', 'f4', 'f5', 'f6', 'f7', 'f8', 'f9',\n        ...\n        'f275', 'f276', 'f277', 'f278', 'f279', 'f280', 'f281', 'f282', 'f283',\n        'f284'],\n       dtype='object', length=285)),\n                                                  ('categorical_low',\n                                                   Pipeline(steps=[('imput...\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OneHotEncoder(handle_unknown='ignore',\n                                                                                  sparse=False))]),\n                                                   Index([], dtype='object')),\n                                                  ('categorical_high',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OrdinalEncoder())]),\n                                                   Index([], dtype='object'))])),\n                 ('classifier', Perceptron(random_state=42))]),\n                 \n 'QuadraticDiscriminantAnalysis': Pipeline(steps=[('preprocessor',\n                  ColumnTransformer(transformers=[('numeric',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer()),\n                                                                   ('scaler',\n                                                                    StandardScaler())]),\n                                                   Index(['f0', 'f1', 'f2', 'f3', 'f4', 'f5', 'f6', 'f7', 'f8', 'f9',\n        ...\n        'f275', 'f276', 'f277', 'f278', 'f279', 'f280', 'f281', 'f282', 'f283',\n        'f284'],\n       dtype='object', length=285)),\n                                                  ('categorical_low',\n                                                   Pipeline(steps=[('imput...\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OneHotEncoder(handle_unknown='ignore',\n                                                                                  sparse=False))]),\n                                                   Index([], dtype='object')),\n                                                  ('categorical_high',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OrdinalEncoder())]),\n                                                   Index([], dtype='object'))])),\n                 ('classifier', QuadraticDiscriminantAnalysis())]),\n                 \n 'RandomForestClassifier': Pipeline(steps=[('preprocessor',\n                  ColumnTransformer(transformers=[('numeric',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer()),\n                                                                   ('scaler',\n                                                                    StandardScaler())]),\n                                                   Index(['f0', 'f1', 'f2', 'f3', 'f4', 'f5', 'f6', 'f7', 'f8', 'f9',\n        ...\n        'f275', 'f276', 'f277', 'f278', 'f279', 'f280', 'f281', 'f282', 'f283',\n        'f284'],\n       dtype='object', length=285)),\n                                                  ('categorical_low',\n                                                   Pipeline(steps=[('imput...\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OneHotEncoder(handle_unknown='ignore',\n                                                                                  sparse=False))]),\n                                                   Index([], dtype='object')),\n                                                  ('categorical_high',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OrdinalEncoder())]),\n                                                   Index([], dtype='object'))])),\n                 ('classifier', RandomForestClassifier(random_state=42))]),\n                 \n 'RidgeClassifier': Pipeline(steps=[('preprocessor',\n                  ColumnTransformer(transformers=[('numeric',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer()),\n                                                                   ('scaler',\n                                                                    StandardScaler())]),\n                                                   Index(['f0', 'f1', 'f2', 'f3', 'f4', 'f5', 'f6', 'f7', 'f8', 'f9',\n        ...\n        'f275', 'f276', 'f277', 'f278', 'f279', 'f280', 'f281', 'f282', 'f283',\n        'f284'],\n       dtype='object', length=285)),\n                                                  ('categorical_low',\n                                                   Pipeline(steps=[('imput...\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OneHotEncoder(handle_unknown='ignore',\n                                                                                  sparse=False))]),\n                                                   Index([], dtype='object')),\n                                                  ('categorical_high',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OrdinalEncoder())]),\n                                                   Index([], dtype='object'))])),\n                 ('classifier', RidgeClassifier(random_state=42))]),\n                 \n 'RidgeClassifierCV': Pipeline(steps=[('preprocessor',\n                  ColumnTransformer(transformers=[('numeric',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer()),\n                                                                   ('scaler',\n                                                                    StandardScaler())]),\n                                                   Index(['f0', 'f1', 'f2', 'f3', 'f4', 'f5', 'f6', 'f7', 'f8', 'f9',\n        ...\n        'f275', 'f276', 'f277', 'f278', 'f279', 'f280', 'f281', 'f282', 'f283',\n        'f284'],\n       dtype='object', length=285)),\n                                                  ('categorical_low',\n                                                   Pipeline(steps=[('imput...\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OneHotEncoder(handle_unknown='ignore',\n                                                                                  sparse=False))]),\n                                                   Index([], dtype='object')),\n                                                  ('categorical_high',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OrdinalEncoder())]),\n                                                   Index([], dtype='object'))])),\n                 ('classifier',\n                  RidgeClassifierCV(alphas=array([ 0.1,  1. , 10. ])))]),\n                  \n 'SGDClassifier': Pipeline(steps=[('preprocessor',\n                  ColumnTransformer(transformers=[('numeric',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer()),\n                                                                   ('scaler',\n                                                                    StandardScaler())]),\n                                                   Index(['f0', 'f1', 'f2', 'f3', 'f4', 'f5', 'f6', 'f7', 'f8', 'f9',\n        ...\n        'f275', 'f276', 'f277', 'f278', 'f279', 'f280', 'f281', 'f282', 'f283',\n        'f284'],\n       dtype='object', length=285)),\n                                                  ('categorical_low',\n                                                   Pipeline(steps=[('imput...\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OneHotEncoder(handle_unknown='ignore',\n                                                                                  sparse=False))]),\n                                                   Index([], dtype='object')),\n                                                  ('categorical_high',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OrdinalEncoder())]),\n                                                   Index([], dtype='object'))])),\n                 ('classifier', SGDClassifier(random_state=42))]),\n                 \n 'SVC': Pipeline(steps=[('preprocessor',\n                  ColumnTransformer(transformers=[('numeric',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer()),\n                                                                   ('scaler',\n                                                                    StandardScaler())]),\n                                                   Index(['f0', 'f1', 'f2', 'f3', 'f4', 'f5', 'f6', 'f7', 'f8', 'f9',\n        ...\n        'f275', 'f276', 'f277', 'f278', 'f279', 'f280', 'f281', 'f282', 'f283',\n        'f284'],\n       dtype='object', length=285)),\n                                                  ('categorical_low',\n                                                   Pipeline(steps=[('imput...\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OneHotEncoder(handle_unknown='ignore',\n                                                                                  sparse=False))]),\n                                                   Index([], dtype='object')),\n                                                  ('categorical_high',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OrdinalEncoder())]),\n                                                   Index([], dtype='object'))])),\n                 ('classifier', SVC(random_state=42))]),\n                 \n 'XGBClassifier': Pipeline(steps=[('preprocessor',\n                  ColumnTransformer(transformers=[('numeric',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer()),\n                                                                   ('scaler',\n                                                                    StandardScaler())]),\n                                                   Index(['f0', 'f1', 'f2', 'f3', 'f4', 'f5', 'f6', 'f7', 'f8', 'f9',\n        ...\n        'f275', 'f276', 'f277', 'f278', 'f279', 'f280', 'f281', 'f282', 'f283',\n        'f284'],\n       dtype='object', length=285)),\n                                                  ('categorical_low',\n                                                   Pipeline(steps=[('imput...\n                                colsample_bytree=1, gamma=0, gpu_id=-1,\n                                importance_type='gain',\n                                interaction_constraints='',\n                                learning_rate=0.300000012, max_delta_step=0,\n                                max_depth=6, min_child_weight=1, missing=nan,\n                                monotone_constraints='()', n_estimators=100,\n                                n_jobs=0, num_parallel_tree=1, random_state=42,\n                                reg_alpha=0, reg_lambda=1, scale_pos_weight=1,\n                                subsample=1, tree_method='exact',\n                                validate_parameters=1, verbosity=None))]),\n                                \n 'LGBMClassifier': Pipeline(steps=[('preprocessor',\n                  ColumnTransformer(transformers=[('numeric',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer()),\n                                                                   ('scaler',\n                                                                    StandardScaler())]),\n                                                   Index(['f0', 'f1', 'f2', 'f3', 'f4', 'f5', 'f6', 'f7', 'f8', 'f9',\n        ...\n        'f275', 'f276', 'f277', 'f278', 'f279', 'f280', 'f281', 'f282', 'f283',\n        'f284'],\n       dtype='object', length=285)),\n                                                  ('categorical_low',\n                                                   Pipeline(steps=[('imput...\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OneHotEncoder(handle_unknown='ignore',\n                                                                                  sparse=False))]),\n                                                   Index([], dtype='object')),\n                                                  ('categorical_high',\n                                                   Pipeline(steps=[('imputer',\n                                                                    SimpleImputer(fill_value='missing',\n                                                                                  strategy='constant')),\n                                                                   ('encoding',\n                                                                    OrdinalEncoder())]),\n                                                   Index([], dtype='object'))])),\n                 ('classifier', LGBMClassifier(random_state=42))])}","35438bb2":"# Dataset Sampling\nThe dataset has 1M rows, so to make a model comparisson is good to take a sample of the population. \n\nWe can assume that the random sample is representative, so, the algorithm results will be trustable","e6fc85dc":"100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 29\/29 [3:46:49<00:00, 469.30s\/it]"}}