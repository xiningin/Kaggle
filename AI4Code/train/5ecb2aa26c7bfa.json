{"cell_type":{"670b0c0d":"code","c7125ee4":"code","161c1f81":"code","4c3104c4":"code","e5822627":"code","f553d4c3":"code","f3105ce2":"code","5c9e6eb1":"code","78a6d1a5":"code","d4558b44":"code","ec60208c":"code","5f44cf4b":"code","afb5f44f":"code","d4e2461a":"code","7a6e9881":"code","1f4da6dc":"code","784704de":"code","a34fd7cd":"code","a80e9215":"code","f3ebb1c8":"code","06f235c8":"code","44085a4c":"code","ff5d4bdf":"code","5141d17c":"code","64291c45":"code","e90535c4":"code","5388957e":"code","d39c6114":"code","91661aa5":"markdown","69f22259":"markdown","cc60fb93":"markdown","5959888d":"markdown","03f23679":"markdown","45c30d1c":"markdown","d50862e0":"markdown","4d88e6cb":"markdown","10ac5e91":"markdown","8ff2e012":"markdown","59e92b21":"markdown","ce78d96e":"markdown","e877784d":"markdown","325354f1":"markdown","3b440d09":"markdown","f1f9fc3a":"markdown","3c2f85a2":"markdown","b6f0495e":"markdown","03d72e06":"markdown","e2c223d0":"markdown","7ee9c178":"markdown"},"source":{"670b0c0d":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns","c7125ee4":"df_pluto = pd.read_csv('\/kaggle\/input\/nyc-pluto\/pluto_20v2.csv')\ndf= pd.read_csv('\/kaggle\/input\/nyc-311-hpd-calls\/311_Service_Requests_from_2010_to_Present.csv')\nprint('Shape of NYC 311 Dataframe is ',df.shape)\nprint('Shape of PLUTO Dataframe is ',df_pluto.shape)\ndf.head()","161c1f81":"df.columns","4c3104c4":"df_pluto=df_pluto[['address','bldgarea','bldgdepth','builtfar','commfar','facilfar','lot','lotarea',\n                   'lotdepth','numbldgs','numfloors','officearea','resarea','residfar','retailarea',\n                   'yearbuilt','yearalter1','zipcode','ycoord','xcoord']]\n\ndf=df[['Unique Key', 'Created Date', 'Closed Date',\n       'Complaint Type', 'Descriptor', 'Location Type', 'Incident Zip',\n       'Incident Address', 'Street Name','Address Type',\n       'City', 'Status', 'Due Date',\n       'Resolution Description','Borough',\n       'Latitude', 'Longitude']]\n\n\nprint('Shape of PLUTO dataframe is ',df_pluto.shape)\nprint('Shape of the NYC 311 call dataframe is', df.shape)","e5822627":"df[['Address Type']].describe()","f553d4c3":"df=df.drop(columns=['Address Type'])\ndf_comp=df.groupby('Complaint Type')[[\"Unique Key\"]].count()\ndf_comp=df_comp[df_comp['Unique Key']>80000].sort_values(by='Unique Key')\ndf_comp.columns=['No of complaints']\n\n\ndf_comp.plot(kind='barh',figsize=(10,8))\nplt.xlabel('Number of Complains  $x10^6$', fontsize=14)\nplt.ylabel('Complaint Type',fontsize=14)\nplt.show()","f3105ce2":"print(df.shape)\ndf=df[df['Complaint Type'].isin(df_comp.index)]\nprint(df.shape)","5c9e6eb1":"df_bor= df.groupby('Borough')[['Unique Key']].count().sort_values('Unique Key',ascending=True)\ndf_bor.plot(kind='barh',figsize=(15,10))\nplt.xlabel('Number of Complains  $x10^6$', fontsize=14)\nplt.ylabel('Borough',fontsize=14)\nplt.show()","78a6d1a5":"df_zip=df.groupby('Incident Zip')[['Borough']].agg(lambda x:x.value_counts().index[0])\ndf_zip.head()","d4558b44":"for i,j in zip(df[df['Borough']=='Unspecified'].index,df[df['Borough']=='Unspecified']['Incident Zip']):\n    if np.isnan(j):\n        continue\n    df.at[i,'Borough']=df_zip.at[j,'Borough']\n    #print(type(j))\n    \ndf.groupby('Borough')[['Unique Key']].count().sort_values('Unique Key').plot(kind='barh',figsize=(10,8))","ec60208c":"#!pip install wordcloud\nfrom wordcloud import WordCloud, STOPWORDS\nprint('Import Successfull')","5f44cf4b":"from collections import Counter\n\ncount_dict = Counter(df['Incident Address'])\nstopwords= set(STOPWORDS)\nwc = WordCloud(background_color='white', max_words=20, stopwords=stopwords).generate_from_frequencies(count_dict)\n#unique_string = (\"\").join(list(df['Incident Address'].astype('str')))\n#wc = WordCloud(background_color='white', max_words=20, stopwords=stopwords).generate(unique_string)\n\n\nplt.figure(figsize=(15,10))\nplt.imshow(wc)\nplt.axis('off')\nplt.show()","afb5f44f":"df.groupby('Incident Address')[['Unique Key']].count().sort_values('Unique Key',ascending=False).head()","d4e2461a":"df[df['Incident Address']=='34 ARDEN STREET'][['Incident Address','Incident Zip','Borough']].head(1)\n","7a6e9881":"df.groupby('Incident Zip')[['Unique Key']].count().sort_values('Unique Key',ascending=False).head()","1f4da6dc":"df.groupby('Status')[['Unique Key']].count().sort_values('Unique Key',ascending=False).head()","784704de":"df_pluto['bldgage']=2020-df_pluto['yearbuilt']\ndf_pluto.head()","a34fd7cd":"df[df['Complaint Type']=='HEAT\/HOT WATER'].head()","a80e9215":"df_comp_count=df[df['Complaint Type']=='HEAT\/HOT WATER'].groupby('Incident Address')[['Incident Address']].count()","f3ebb1c8":"df_comp_count.columns=['count of complaints']\ndf_comp_count['address']=df_comp_count.index\ndf_comp_count.head()","06f235c8":"#df_comp_count.index=None\ndf_comp_count.reset_index(drop=True,inplace=True)\ndf_comp_count.head()","44085a4c":"df_corr = pd.merge(df_comp_count,df_pluto,on='address', how='inner')\ndf_corr.head()","ff5d4bdf":"#df_corr['alterage']= 2020-df_corr['yearalter1']\ndf_corr.drop(columns=['yearbuilt'],inplace=True)\ndf_corr.head()","5141d17c":"data = df_corr.drop(columns=['address'])\n\nnull_data=data.isnull()\n\nfor i in null_data.columns:\n    result=0\n    for j in null_data[i]:\n        if j: result+=1\n    print(i,\" has \",result, \" null values\")\n\n\n","64291c45":"print(df_pluto.shape)\nprint(df_corr.shape)\nprint(df_comp_count.shape)","e90535c4":"pl_ana = df_corr.groupby('address')[['address']].count()\npl_ana.columns=['count']\npl_ana['address']=data_address.index\npl_ana.reset_index(drop=True, inplace=True)\npl_ana.sort_values('count',ascending=False)","5388957e":"\ndata.sort_values('count of complaints',ascending=False)","d39c6114":"for i in null_data.columns:\n    result=0\n    for k,j in enumerate(null_data[i]):\n        if j: data.at[k,i]= data[i].mean()\n            \n            \nnull_data=data.isnull()\n            \nfor i in null_data.columns:\n    result=0\n    for j in null_data[i]:\n        if j: result+=1\n    print(i,\" has \",result, \" null values\")","91661aa5":"### Let's see which address has the most complaints","69f22259":"f, axes = plt.subplots(11,2,figsize=(10,40))\nfor i in range(len(data.columns)):\n    sns.distplot(data.iloc[:,i],kde=False, ax=axes[int(i\/2),int(i%2)])\n#sns.boxplot((data['bldgdepth']),color='g',orient='vert',ax=ax)\nplt.show()","cc60fb93":"It seems like we have succesfully cleaned up the unspecified data.","5959888d":"We are only going to focus on the most frequent occuring problems","03f23679":"# Data Wrangling","45c30d1c":"### Let's get rid of all the unnecessary fields","d50862e0":" The address where most number of complaints came from is 34 ARDEN STREET, MANHATTAN 10040","4d88e6cb":"This gives us a good idea about the address where are the highest numbers of complaints came from. To get which street has the maximum number of complaints, we will do a sorting.","10ac5e91":"***It seems like the highest complaints are for HEAT or HOT WATER!!***","8ff2e012":"The zipcode where the most number of complaints came from is 11226","59e92b21":"It seems like Brooklyn has the highest number of complaints. But BRONX is also very close. There are also a lot of entries with unspecified boroughs. We will have to find what borough those zip numbers belong to.","ce78d96e":"#plt.figure(figsize=(10,8))\nf, axes = plt.subplots(11,2,figsize=(8,30))\nfor i in range(len(data.columns)):\n    sns.boxplot((data.iloc[:,i]),orient='vert',ax=axes[int(i\/2),int(i%2)])\n#sns.boxplot((data['bldgdepth']),color='g',orient='vert',ax=ax)\nplt.show()","e877784d":"## I need to answer several questions. The answers to those questions must be supported by data and analytics. These are the questions:\n\n### 1. Which type of complaint should the Department of Housing Preservation and Development of New York City focus on first?\n### 2. Should the Department of Housing Preservation and Development of New York City focus on any particular set of boroughs, ZIP codes, or street (where the complaints are severe) for the specific type of complaints you identified in response to Question 1?\n### 3. Does the Complaint Type that you identified in response to question 1 have an obvious relationship with any particular characteristic or characteristics of the houses or buildings?\n### 4. Can a predictive model be built for a future prediction of the possibility of complaints of the type that you have identified in response to question 1?","325354f1":"# Import Data","3b440d09":"We are going to replace the entries with unspecified boroughs with the borough their Zipcode belongs to. We are using df.at instead of df.loc because this is faster and finishes in a reasonable amount of time.","f1f9fc3a":"Which borough had the largest number of complaints?","3c2f85a2":"sns.pairplot(data.T, size=2.5, corner=True)","b6f0495e":"Now Let's get the full address of this","03d72e06":"We are creating a dataframe that will have all the Zipcode towards the boroughs they were assigned to the most. That should be the correct borough for the zipcode","e2c223d0":"### The field \"Address Type\" seems to have only one value. It's not useful information. We will LET IT GO","7ee9c178":"We have a lot of null values. We have to deal with it before I try to do any machine learning on it. If we look carefully, they have a pattern of how many null values are in the columns. Maybe they have the null values for similar reason and we can replace the null values with similar approach."}}