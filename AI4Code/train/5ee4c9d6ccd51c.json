{"cell_type":{"c0392643":"code","a40a6057":"code","90f06dcc":"code","94bab62a":"code","116c9978":"markdown","68f5d317":"markdown","9cba48a0":"markdown"},"source":{"c0392643":"# first neural network with keras make predictions\nfrom numpy import loadtxt\nfrom keras.models import Sequential\nfrom keras.layers import Dense\n# load the dataset\ndataset = loadtxt('https:\/\/raw.githubusercontent.com\/jbrownlee\/Datasets\/master\/pima-indians-diabetes.data.csv', delimiter=',')\n# split into input (X) and output (y) variables\nX = dataset[:,0:8]\ny = dataset[:,8]\n# define the keras model\nmodel = Sequential()\nmodel.add(Dense(12, input_dim=8, activation='relu'))\nmodel.add(Dense(8, activation='relu'))\nmodel.add(Dense(1, activation='sigmoid'))\n# compile the keras model\nmodel.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])\n# fit the keras model on the dataset\nmodel.fit(X, y, epochs=150, batch_size=10, verbose=0)\n# evaluate the keras model\n_, accuracy = model.evaluate(X, y, verbose=0)\n# make class predictions with the model\npredictions = model.predict_classes(X)\n# show input\/output sets\nprint(\"Original dataset size: {}\\nInput dataset size:    {}\\nOutput dataset size:   {}\\n\".format(dataset.shape, X.shape, y.shape))\n# show accuracy\nprint('Accuracy: %.2f\\n' % (accuracy*100))\n# summarize the first 5 cases\nprint('[Patient variables] => Predicted class (Real class)')\nfor i in range(5):\n    print('%s => %d (expected %d)' % (X[i].tolist(), predictions[i], y[i]))","a40a6057":"# MLP for Pima Indians Dataset with 10-fold cross validation\nfrom keras.models import Sequential\nfrom keras.layers import Dense\nfrom sklearn.model_selection import StratifiedKFold\nimport numpy\n# fix random seed for reproducibility\nseed = 7\nnumpy.random.seed(seed)\n# load pima indians dataset\ndataset = numpy.loadtxt('https:\/\/raw.githubusercontent.com\/jbrownlee\/Datasets\/master\/pima-indians-diabetes.data.csv', delimiter=',')\n# split into input (X) and output (Y) variables\nX = dataset[:,0:8]\nY = dataset[:,8]\n# define 10-fold cross validation test harness\nkfold = StratifiedKFold(n_splits=10, shuffle=True, random_state=seed)\ncvscores = []\nfor train, test in kfold.split(X, Y):\n  # create model\n    model = Sequential()\n    model.add(Dense(12, input_dim=8, activation='relu'))\n    model.add(Dense(8, activation='relu'))\n    model.add(Dense(1, activation='sigmoid'))\n    # Compile model\n    model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])\n    # Fit the model\n    model.fit(X[train], Y[train], epochs=150, batch_size=10, verbose=0)\n    # evaluate the model\n    scores = model.evaluate(X[test], Y[test], verbose=0)\n    print(\"%s: %.2f%%\" % (model.metrics_names[1], scores[1]*100))\n    cvscores.append(scores[1] * 100)\nprint(\"%.2f%% (+\/- %.2f%%)\" % (numpy.mean(cvscores), numpy.std(cvscores)))","90f06dcc":"!pip3 install ann_visualizer\n!pip install graphviz","94bab62a":"from ann_visualizer.visualize import ann_viz\nfrom graphviz import Source\n\nann_viz(model, view=True, title=\"Neural network plot\")\nSource.from_file('network.gv')","116c9978":"Viz example from [TowardsDataScience](https:\/\/towardsdatascience.com\/visualizing-artificial-neural-networks-anns-with-just-one-line-of-code-b4233607209e) website.\nDataset from [patient medical record data for Pima Indians](https:\/\/raw.githubusercontent.com\/jbrownlee\/Datasets\/master\/pima-indians-diabetes.data.csv) with information whether they had an onset of diabetes within five years. The dataset is described [here](https:\/\/raw.githubusercontent.com\/jbrownlee\/Datasets\/master\/pima-indians-diabetes.names).","68f5d317":"# Neural network train, cross-validation and visualization\nExample from [MachineLearningMastery](https:\/\/machinelearningmastery.com\/tutorial-first-neural-network-python-keras\/) website.\nDataset from [patient medical record data for Pima Indians](https:\/\/raw.githubusercontent.com\/jbrownlee\/Datasets\/master\/pima-indians-diabetes.data.csv) with information whether they had an onset of diabetes within five years. The dataset is described [here](https:\/\/raw.githubusercontent.com\/jbrownlee\/Datasets\/master\/pima-indians-diabetes.names).","9cba48a0":"Cross-validation example from [MachineLearningMastery](https:\/\/machinelearningmastery.com\/evaluate-performance-deep-learning-models-keras\/) website.\nDataset from [patient medical record data for Pima Indians](https:\/\/raw.githubusercontent.com\/jbrownlee\/Datasets\/master\/pima-indians-diabetes.data.csv) with information whether they had an onset of diabetes within five years. The dataset is described [here](https:\/\/raw.githubusercontent.com\/jbrownlee\/Datasets\/master\/pima-indians-diabetes.names)."}}