{"cell_type":{"919ace03":"code","e1410a39":"code","30335ae2":"code","f75987fa":"code","50d0281d":"code","77a5f3a5":"code","6becb95f":"code","7ddc0f55":"code","9107b21b":"code","1a5814d7":"markdown","3447e73c":"markdown","06e5bccd":"markdown","650ad6c5":"markdown","41b5bcdd":"markdown"},"source":{"919ace03":"import matplotlib.pyplot as plt\nimport numpy as np\nimport tensorflow as tf\nimport tensorflow_hub as hub\nimport numpy as np","e1410a39":"def cast_and_scale(image):\n    return tf.cast(image, dtype = tf.float32)[tf.newaxis, ...] \/ 255.","30335ae2":"def plot_image(image):\n  image = np.squeeze(image)\n  plt.figure(figsize = (7,7))\n  plt.imshow(np.squeeze(image))\n  plt.axis(\"off\")\n  plt.show()","f75987fa":"# Load image stylization module.\nhub_module = hub.load('https:\/\/tfhub.dev\/google\/magenta\/arbitrary-image-stylization-v1-256\/2')","50d0281d":"#Paths to the required images\ncontent_image_path = \"..\/input\/neural-style-transfer\/Neural Style Transfer\/Content Images\/cristina-anne-costello-NR2eMg9zXxA-unsplash.jpg\"\nstyle_image_path = \"..\/input\/neural-style-transfer\/Neural Style Transfer\/Style Images\/jakob-owens-n5wwck8ES4w-unsplash.jpg\"","77a5f3a5":"# Load content and style images\ncontent_image = plt.imread(content_image_path)\nstyle_image = plt.imread(style_image_path)\n\n#Change the datatype of image to tf.float32\ncontent_image = cast_and_scale(content_image)\nstyle_image = cast_and_scale(style_image)\n\n#Resize image to 256x256\nstyle_image = tf.image.resize(style_image, (256, 256))","6becb95f":"plot_image(content_image)\nplot_image(style_image)","7ddc0f55":"# Stylize image.\noutputs = hub_module(content_image, style_image)\nstylized_image = outputs[0]","9107b21b":"plot_image(stylized_image)","1a5814d7":"## **Essential Imports**","3447e73c":"## **Helper Functions to pre-process and plot images**","06e5bccd":"#### **Note**: Photo credits to the respective owners on [Unsplash](https:\/\/unsplash.com)\n* <Code>content_image_path<\/Code>: https:\/\/unsplash.com\/photos\/NR2eMg9zXxA\n* <Code>style_image_path<\/Code>: https:\/\/unsplash.com\/photos\/n5wwck8ES4w","650ad6c5":"## **Fast arbitrary image style transfer model hosted on TensorFlow Hub**\n**Reference**: https:\/\/tfhub.dev\/google\/magenta\/arbitrary-image-stylization-v1-256\/2","41b5bcdd":"## **Stylized image after Neural Style Transfer**"}}