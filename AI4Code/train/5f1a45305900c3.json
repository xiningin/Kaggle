{"cell_type":{"3289f596":"code","d2cda115":"code","f18cecff":"code","469adac9":"code","b84b1da6":"code","1b8e2c3d":"code","84b97619":"code","fce6efca":"code","d106b022":"code","5e19f5cc":"code","e23f9f28":"code","025da2e3":"markdown","19f8c5d6":"markdown"},"source":{"3289f596":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\nfrom load_kaggle import load_kaggle","d2cda115":"subm, train, test = load_kaggle()\nprint(train.shape, test.shape, subm.shape)","f18cecff":"!pip install auto-ts","469adac9":"!pip install xlrd","b84b1da6":"from auto_ts import auto_timeseries","1b8e2c3d":"train.head(2)","84b97619":"## The data is hourly time series ####\ntargets = ['target_carbon_monoxide', 'target_benzene', 'target_nitrogen_oxides']\nts_column = 'date_time'","fce6efca":"model = auto_timeseries(score_type='rmse',\n                time_interval='H',\n                non_seasonal_pdq=None, \n                seasonality=False, seasonal_period=12,\n                model_type=['ml'],\n                verbose=2)","d106b022":"import copy\nall_preds = []\ntargets_copy = copy.deepcopy(targets)\nfor i, each_target in enumerate(targets_copy):\n    rem_targets = [x for x in targets if x != each_target]\n    train1 = train.drop(rem_targets, axis=1)\n    model.fit(train1, ts_column, each_target)\n    preds1 = model.predict(test, model='best')\n    if i == 0:\n        all_preds = preds1['yhat'].values\n    else:\n        all_preds = np.c_[all_preds, preds1['yhat'].values]\nprint('Completed. ', all_preds.shape)","5e19f5cc":"subm[targets] = all_preds\nsubm.head()","e23f9f28":"subm.to_csv('submission_1.csv', index=False)","025da2e3":"# Let's build a model using each target while dropping the other two targets","19f8c5d6":"# Auto-TS\nAutomatically build ARIMA, SARIMAX, VAR, FB Prophet and XGBoost Models on Time Series data sets with a Single Line of Code. Now updated with Dask to handle millions of rows.\n## Github: [https:\/\/github.com\/AutoViML\/Auto_TS](https:\/\/github.com\/AutoViML\/Auto_TS)\n\n<img src=\"https:\/\/github.com\/AutoViML\/Auto_TS\/raw\/master\/logo.png\" alt=\"auto-ts\"\/>"}}