{"cell_type":{"1a28775f":"code","59a23324":"code","a7578e36":"code","afa8f558":"code","00e8fccc":"code","b88412a3":"code","0384613b":"code","356b449b":"code","cc1de3e4":"code","a830283e":"code","f6bc13d3":"code","686a9888":"code","c5d67eee":"code","107360b8":"code","383c7755":"code","32af22c4":"code","6f4b73e8":"code","ff0f28a4":"code","fac47119":"code","155679b3":"code","f16945a8":"code","1fefb263":"code","77a9cb47":"code","e16cd8d0":"code","6fb61bd4":"code","4544442d":"code","658c71a2":"code","0fbd1c39":"code","d0e808e7":"markdown","4848bed6":"markdown","5fce6786":"markdown","74070ea8":"markdown","dec665e6":"markdown","96993f45":"markdown","b3e29b95":"markdown","f957493c":"markdown","ed34cd51":"markdown","7770fbc7":"markdown","b220ef62":"markdown","3a5f7856":"markdown","88af25bf":"markdown","dd1e7cca":"markdown","58aa7e15":"markdown","8fd68efc":"markdown","8c8a9ec4":"markdown","9eaa818a":"markdown","88ca3726":"markdown"},"source":{"1a28775f":"import pandas as pd\nimport seaborn as sns\nimport numpy\nimport missingno as msno\nimport matplotlib.pyplot as plt\nimport squarify\nimport plotly.offline as py\nimport plotly.graph_objs as go\nfrom plotly.offline import init_notebook_mode\ninit_notebook_mode(connected=True)\n\nfrom plotly import tools\n\nimport warnings\nwarnings.filterwarnings(\"ignore\", message=\"numpy.dtype size changed\")\nwarnings.filterwarnings(\"ignore\", message=\"numpy.ufunc size changed\")\nwarnings.filterwarnings(\"ignore\",category=DeprecationWarning)","59a23324":"train=pd.read_csv(\"..\/input\/train.csv\")\ntest=pd.read_csv(\"..\/input\/test.csv\")\ntrain=train.copy()\ntest=test.copy()\n","a7578e36":"train.head()","afa8f558":"train.info()","00e8fccc":"train.shape","b88412a3":"missing=pd.DataFrame(100*train.isnull().sum()\/len(train),columns=[\"percent of missing values\"]).sort_values(ascending=False,by\n                                                                                                       =\"percent of missing values\")\nplt.figure(figsize=(7,6))\nplt.style.use(\"fivethirtyeight\")\nsns.barplot(x=missing.index[:3],y=missing[\"percent of missing values\"][:3])\nplt.show()","0384613b":"len(train[train['escolari'].notnull()])\n#len(train[train['rez_esc'].isnull()])","356b449b":"print(\"Number of missing values in v2a1 is \",train['v2a1'].notnull().sum())","cc1de3e4":"print(\"Number of owned and precarious houses is\",len( train[(train['tipovivi3']==1) | (train['tipovivi2']==1)]))","a830283e":"train['v2a1']=train['v2a1'].fillna(0)\ntrain['v18q1']=train['v18q1'].fillna(0)\ntrain['rez_esc']=train['rez_esc'].fillna(0)\n","f6bc13d3":"Target=train.groupby('Target')['Id'].agg('count')\nx1=['extreme poverty','moderate poverty','vulnerable households ','non vulnerable households ']\ntrace1=go.Bar(x=x1,y=Target)\nlayout=go.Layout(title=\"Population\",yaxis=dict(title='Number of people'))\nfig=go.Figure(data=[trace1],layout=layout)\npy.iplot(fig)","686a9888":"level=train.groupby('Target')[['refrig','v18q','television','mobilephone']].agg('sum')\nlevel=level.div(Target,axis=\"rows\")*100\n\n\ntrace2=go.Bar(x=['extreme poverty','moderate poverty','vulnerable households ','non vulnerable households '],\n              y=level['refrig'],\n              name='refrigerator')\n\ntrace5=go.Bar(x=['extreme poverty','moderate poverty','vulnerable households ','non vulnerable households '],\n              y=level['v18q'],\n              name='tablets')\n\n\ntrace4=go.Bar(x=['extreme poverty','moderate poverty','vulnerable households ','non vulnerable households '],\n              y=level['television'],\n              name='Television')\n\n\ntrace3=go.Bar(x=['extreme poverty','moderate poverty','vulnerable households ','non vulnerable households '],\n              y=level['mobilephone'],\n              name='mobiles')\n\n\n\ndata=[trace2,trace3,trace4,trace5]\nlayout=go.Layout(barmode='stack',yaxis=dict(title=\"percent of users\"),title=\"what do they own\")\n\nfig=go.Figure(data=data,layout=layout)\npy.iplot(fig)","c5d67eee":"%matplotlib notebook\navg=train.groupby('Target')[['hogar_total','r4h3','r4m3','hogar_adul']].agg(\"mean\")\nfig,axes=plt.subplots(nrows=2,ncols=2,sharex=True)\nsns.barplot(x=avg.index,\n           y=avg['hogar_total'],ax=axes[0][0])\n\n\nsns.barplot(x=avg.index,\n           y=avg['r4h3'],ax=axes[0][1])\n\nsns.barplot(x=avg.index,\n           y=avg['r4m3'],ax=axes[1][0])\n\nsns.barplot(x=avg.index,\n           y=avg['hogar_adul'],ax=axes[1][1])\n\nplt.show()","107360b8":"per_12=train.groupby('Target')[['r4h2','r4m2','r4t2','r4t1']].agg('sum')\n\ntrace3=go.Bar(x=['extreme poverty','moderate poverty','vulnerable households ','non vulnerable households '],\n              y=per_12['r4h2'],name=\"Males 12 years of age and older\")\n\ntrace2=go.Bar(x=['extreme poverty','moderate poverty','vulnerable households ','non vulnerable households ']\n              ,y=per_12['r4m2'],name=\"Females 12 years of age and older\")\n\n\ntrace1=go.Bar(x=['extreme poverty','moderate poverty','vulnerable households ','non vulnerable households '],\n             y=per_12['r4t2'],name=\"persons 12 years of age and older\")\n\ntrace4=go.Bar(x=['extreme poverty','moderate poverty','vulnerable households ','non vulnerable households '],\n              y=per_12['r4t1'],name=\" persons younger than 12 years of age\")\n\n\ndata=[trace1,trace2,trace3,trace4]\nlayout=go.Layout(barmode=\"stack\",yaxis=dict(title=\"number of people\"))\n\nfig=go.Figure(layout=layout,data=data)\npy.iplot(fig)","383c7755":"elec=train.groupby(\"Target\")[['abastaguadentro','abastaguafuera','abastaguano']].agg('sum')\nelec=elec.div(Target,axis=\"rows\")*100\n\ntrace1=go.Bar(x=['extreme poverty','moderate poverty','vulnerable households ','non vulnerable households '],\n             y=elec['abastaguadentro'],name=\"water provision inside dwelling\")\n\ntrace2=go.Bar(x=['extreme poverty','moderate poverty','vulnerable households ','non vulnerable households '],\n             y=elec['abastaguafuera'],name='water provision outside dwelling')\n\ntrace3=go.Bar(x=['extreme poverty','moderate poverty','vulnerable households ','non vulnerable households '],\n             y=elec['abastaguano'],name='no water provision')\n\ndata=[trace1,trace2,trace3]\n\nlayout=go.Layout(barmode=\"stack\",title=\"water provision\",yaxis=dict(title=\"percent of users\"))\n\nfig=go.Figure(data=data,layout=layout)\npy.iplot(fig)\n","32af22c4":"toilet=train.groupby('Target')[['sanitario1','sanitario2','sanitario3','sanitario6','sanitario5']].agg(sum)\ntoilet=toilet.div(Target,axis='rows')*100\n\ntrace2=go.Bar(x=['extreme poverty','moderate poverty','vulnerable households ','non vulnerable households '],\n             y=toilet.iloc[:,0],name=\"no toilet\")\ntrace3=go.Bar(x=['extreme poverty','moderate poverty','vulnerable households ','non vulnerable households '],\n             y=toilet.iloc[:,1],name=\"toilet connected to sewer\")\ntrace4=go.Bar(x=['extreme poverty','moderate poverty','vulnerable households ','non vulnerable households '],\n           y=toilet.iloc[:,2],name=\"toilet connected to  septic tank\")\ntrace5=go.Bar(x=['extreme poverty','moderate poverty','vulnerable households ','non vulnerable households '],\n             y=toilet.iloc[:,3],name=\"toilet connected to other system\")\ntrace6=go.Bar(x=['extreme poverty','moderate poverty','vulnerable households ','non vulnerable households '],\n             y=toilet.iloc[:,4],name=\"toilet connected to black hole\")\n\n\nbathroom=train.groupby(\"Target\")['v14a'].agg(\"sum\").div(Target,axis=\"rows\")*100\n\n\ntrace1=go.Bar(x=['extreme poverty','moderate poverty','vulnerable households ','non vulnerable households '],\n              y=bathroom,\n              name='bathroom')\n\nfig=tools.make_subplots(rows=1,cols=2,subplot_titles=['percent of people having bathrooms','Bathroom condition'])\n\nfig.append_trace(trace1,1,1)\nfig.append_trace(trace2,1,2)\nfig.append_trace(trace3,1,2)\nfig.append_trace(trace4,1,2)\nfig.append_trace(trace5,1,2)\nfig.append_trace(trace6,1,2)\n\n\nfig['layout'].update(height=500, title=\"Bathrooms\", barmode=\"stack\", showlegend=True)\npy.iplot(fig)","6f4b73e8":"energy=train.groupby(\"Target\")[[\"energcocinar1\",\"energcocinar2\",\"energcocinar3\",\"energcocinar4\"]].agg(\"sum\")\nenergy=energy.div(Target,axis=\"rows\")*100\n\ntrace2=go.Bar(x=['extreme poverty','moderate poverty','vulnerable households ','non vulnerable households '],\n             y=energy.iloc[:,1],name=\"electricity\")\ntrace1=go.Bar(x=['extreme poverty','moderate poverty','vulnerable households ','non vulnerable households '],\n           y=energy.iloc[:,2],name=\"gas\")\ntrace3=go.Bar(x=['extreme poverty','moderate poverty','vulnerable households ','non vulnerable households '],\n             y=energy.iloc[:,3],name=\"charcol\")\ntrace4=go.Bar(x=['extreme poverty','moderate poverty','vulnerable households ','non vulnerable households '],\n             y=energy.iloc[:,0],name=\"no kitchen\")\ndata=[trace1,trace2,trace3,trace4]\nlayout=go.Layout(barmode=\"stack\",yaxis=dict(title=\"percent of users\"),title=\"cooking food\")\nfig=go.Figure(data=data,layout=layout)\npy.iplot(fig)","ff0f28a4":"extreme=train[train['Target']==1]['tamviv']\nmoderate=train[train['Target']==2]['tamviv']\nvulnerable=train[train['Target']==3]['tamviv']\nnon_vulnerable=train[train['Target']==4]['tamviv']\ntrace1=go.Box(y=extreme,name=\"extreme poverty\")\n\ntrace2=go.Box(y=moderate,name=\"moderate poverty\")\n\ntrace3=go.Box(y=vulnerable,name='vulnerable poverty')\n\ntrace4=go.Box(y=non_vulnerable,name=\"non_vulnerable poverty\")\n\nlayout = go.Layout(\n    title = \"Box Plot of number of persons living in the household\",yaxis=dict(title=\"number of persons\"))\n\n\ndata=[trace1,trace2,trace3,trace4]\nfig=go.Figure(data=data,layout=layout)\npy.iplot(fig)","fac47119":"electricity=train.groupby('Target')[['public','planpri','noelec','coopele']].agg(\"sum\")\nelectricity=electricity.div(Target,axis=\"rows\")*100\n\nx1=['extreme poverty','moderate poverty','vulnerable households ','non vulnerable households ']\n\ntrace1=go.Bar(x=x1,y=electricity['public'],name=\"public sector\")\n\ntrace2=go.Bar(x=x1,y=electricity['planpri'],name=\"electricity from private plant\")\n\ntrace3=go.Bar(x=x1,y=electricity['noelec'],name=\"no electricity in the dwelling\")\n\ntrace4=go.Bar(x=x1,y=electricity['coopele'],name=\"electricity from cooperative\")\n\n\ndata=[trace1,trace2,trace3,trace4]\nlayout=go.Layout(barmode=\"stack\",title=\"Electricity\",yaxis=dict(title=\"percent of users\"))\nfig=go.Figure(data=data,layout=layout)\npy.iplot(fig)","155679b3":"trace=[]\ndef plot_bar(df,mylist=[]):\n    trace1=go.Bar(x=x1,y=df.iloc[:,0],name=mylist[0])\n    trace2=go.Bar(x=x1,y=df.iloc[:,1],name=mylist[1])\n    trace3=go.Bar(x=x1,y=df.iloc[:,2],name=mylist[2])\n\n    return  trace1,trace2,trace3\n\n\ntrace1,trace2,trace3=plot_bar(electricity,['public','planpri','noelec'])","f16945a8":"house=train.groupby('Target')[['tipovivi1','tipovivi2','tipovivi3']].agg(\"sum\")\nhouse=house.div(Target,axis=\"rows\")*100\ntr1,tr2,tr3=plot_bar(house,['fully owned','installement paying','rented'])\n\n#walls\nwalls=train.groupby('Target')[['epared1','epared2','epared3']].agg(\"sum\").div(Target,axis=\"rows\")*100\ntr4,tr5,tr6=plot_bar(walls,['bad','regular','good'])\n\n#roofs\nroofs=train.groupby(\"Target\")[['etecho1','etecho2',\"etecho3\"]].agg(\"sum\").div(Target,axis=\"rows\")*100\ntr7,tr8,tr9=plot_bar(roofs,['bad','regular','good'])\n\n#floor\nfloor=train.groupby(\"Target\")[['eviv1','eviv2','eviv3']].agg(\"sum\").div(Target,axis=\"rows\")*100\ntr10,tr11,tr12=plot_bar(floor,['bad','regular','good'])\n\ntitles=['house','walls','roofs','floor']\n\nfig = tools.make_subplots(rows=2, cols=2, print_grid=False,subplot_titles=titles)\n\n\n\nfig.append_trace(tr1,1,1)\nfig.append_trace(tr2,1,1)\nfig.append_trace(tr3,1,1)\n\nfig.append_trace(tr4,1,2)\nfig.append_trace(tr5,1,2)\nfig.append_trace(tr6,1,2)\n\nfig.append_trace(tr7,2,1)\nfig.append_trace(tr8,2,1)\nfig.append_trace(tr9,2,1)\n\nfig.append_trace(tr10,2,2)\nfig.append_trace(tr11,2,2)\nfig.append_trace(tr12,2,2)\n\n\n\nfig['layout'].update(height=1000, title=\"Condition of houses\", barmode=\"stack\", showlegend=True)\npy.iplot(fig)","1fefb263":"#def plot_pie():\n    \n\n    \n    \n\npie=train.groupby('Target')[['male','female']].agg('sum').div(Target,axis=\"rows\")*100\n\nlabels=[\"Male\",\"Female\"]\n\nfig = {\n    'data': [\n        {\n            'labels': labels,\n            'values': pie.iloc[0,:],\n            'type': 'pie',\n            'name': 'extereme poverty',\n        'domain': {'x': [0, .48],\n                       'y': [0, .49]}\n        }\n     ,\n        {\n            'labels': labels,\n            'values': pie.iloc[1,:],\n            'type': 'pie',\n            'name': 'mderate poverty',\n          'domain': {'x': [.52, 1],\n                       'y': [0, .49]}},\n        {\n            'labels': labels,\n            'values': pie.iloc[2,:],\n            'type': 'pie',\n            'name': 'vulnerable poverty',\n             'domain': {'x': [0, .48],\n                       'y': [.51, 1]}\n        },\n        {\n            'labels': labels,\n            'values': pie.iloc[3,:],\n            'type': 'pie',\n            'name':'Non vulnerable poverty',\n              'domain': {'x': [.52, 1],\n                       'y': [.51, 1]}\n            \n        }\n    ],\n    \n    'layout': {'title': 'Male to Female ratio',\n               'showlegend': False}\n}\n\npy.iplot(fig, filename='pie_chart_subplots')\n","77a9cb47":"extreme=train[train['Target']==1]['overcrowding']\nmoderate=train[train['Target']==2]['overcrowding']\nvulnerable=train[train['Target']==3]['overcrowding']\nnon_vulnerable=train[train['Target']==4]['overcrowding']\n\ntrace1=go.Box(y=extreme,name=\"extreme poverty\")\n\ntrace2=go.Box(y=moderate,name=\"moderate poverty\")\n\ntrace3=go.Box(y=vulnerable,name='vulnerable poverty')\n\ntrace4=go.Box(y=non_vulnerable,name=\"non_vulnerable poverty\")\n\nlayout = go.Layout(\n    title = \"Box Plot of overcrowding\",yaxis=dict(title=\"number of persons\"))\n\n\ndata=[trace1,trace2,trace3,trace4]\nfig=go.Figure(data=data,layout=layout)\npy.iplot(fig)\n","e16cd8d0":"extreme=train[train['Target']==1]['bedrooms']\nmoderate=train[train['Target']==2]['bedrooms']\nvulnerable=train[train['Target']==3]['bedrooms']\nnon_vulnerable=train[train['Target']==4]['bedrooms']\n\ntrace1=go.Box(y=extreme,name=\"extreme poverty\")\n\ntrace2=go.Box(y=moderate,name=\"moderate poverty\")\n\ntrace3=go.Box(y=vulnerable,name='vulnerable poverty')\n\ntrace4=go.Box(y=non_vulnerable,name=\"non_vulnerable poverty\")\n\nlayout = go.Layout(\n    title = \"Box Plot of number of bedrooms\",yaxis=dict(title=\"number of bedrooms\"))\n\n\ndata=[trace1,trace2,trace3,trace4]\nfig=go.Figure(data=data,layout=layout)\npy.iplot(fig)\n","6fb61bd4":"pie=train.groupby('Target')[['area1',\"area2\"]].agg('sum').div(Target,axis=\"rows\")*100\n\n\n\nlabels=[\"urban\",\"rural\"]\n\nfig = {\n    'data': [\n        {\n            'labels': labels,\n            'values': pie.iloc[0,:],\n            'type': 'pie',\n            'name': 'extereme poverty',\n        'domain': {'x': [0, .48],\n                       'y': [0, .49]}\n        }\n     ,\n        {\n            'labels': labels,\n            'values': pie.iloc[1,:],\n            'type': 'pie',\n            'name': 'mderate poverty',\n          'domain': {'x': [.52, 1],\n                       'y': [0, .49]}},\n        {\n            'labels': labels,\n            'values': pie.iloc[2,:],\n            'type': 'pie',\n            'name': 'vulnerable poverty',\n             'domain': {'x': [0, .48],\n                       'y': [.51, 1]}\n        },\n        {\n            'labels': labels,\n            'values': pie.iloc[3,:],\n            'type': 'pie',\n            'name':'Non vulnerable poverty',\n              'domain': {'x': [.52, 1],\n                       'y': [.51, 1]}\n            \n        }\n    ],\n    \n    'layout': {'title': 'Urban- rural poverty ratio',\n               'showlegend': False}\n}\n\npy.iplot(fig, filename='pie_chart_subplots')","4544442d":"education=train.groupby('Target')[['instlevel1','instlevel2','instlevel3',\n                                   'instlevel4','instlevel5','instlevel6',\n                                  'instlevel7','instlevel8','instlevel9']].agg('sum').div(Target,axis=\"rows\")*100","658c71a2":"trace0=go.Bar(x=education.columns,y=education.iloc[0,:],name=\"education\")\ntrace1=go.Bar(x=education.columns,y=education.iloc[1,:],name=\"education\")\ntrace2=go.Bar(x=education.columns,y=education.iloc[2,:],name=\"education\")\ntrace3=go.Bar(x=education.columns,y=education.iloc[3,:],name=\"education\")\n\nfig=tools.make_subplots(rows=2,cols=2,subplot_titles=x1)\n\nfig.append_trace(trace0,1,1)\nfig.append_trace(trace1,1,2)\nfig.append_trace(trace2,2,1)\nfig.append_trace(trace3,2,2)\n\nfig['layout'].update(height=1000, title=\"Education levels\", showlegend=False)\npy.iplot(fig)","0fbd1c39":"extreme=train[train['Target']==1]['escolari']\nmoderate=train[train['Target']==2]['escolari']\nvulnerable=train[train['Target']==3]['escolari']\nnon_vulnerable=train[train['Target']==4]['escolari']\n\n\ntrace1=go.Box(y=extreme,name='extreme')\n\ntrace2=go.Box(y=moderate,name='moderate')\ntrace3=go.Box(y=vulnerable,name='vulnerable')\ntrace4=go.Box(y=non_vulnerable,name='non_vulnerable')\n\ndata=[trace1,trace2,trace3,trace4]\n\n\nlayout = go.Layout(\n    title = \"Box Plot of years of education\",yaxis=dict(title=\"number of years in school\"))\n\nfig=go.Figure(data=data,layout=layout)\npy.iplot(fig)","d0e808e7":"# Which electricity provider do they prefer?","4848bed6":"We will inspect the columns.                    \nrez_esc indicates the number of years behind in school.                   \n\nv18q indicates if he\/she owns a tablet.So Nan here means 0.\n","5fce6786":"# Visualization","74070ea8":"# What do they own?","dec665e6":"Many social programs have a hard time making sure the right people are given enough aid. It\u2019s especially tricky when a program focuses on the poorest segment of the population. The world\u2019s poorest typically can\u2019t provide the necessary income and expense records to prove that they qualify. Beyond Costa Rica, many countries face this same problem of inaccurately assessing social need.\n\nA popular algorithm called the Proxy Means Test (or PMT) is used to verify income qualification along with family\u2019s observable household attributes like the material of their walls and ceiling, or the assets found in the home to classify them and predict their level of need. This is an improvement but accuracy remains a problem as the region\u2019s population grows and poverty declines.","96993f45":"# overcrowding in houses\n","b3e29b95":"# Where is more poverty ? urban or rural ","f957493c":"# predictions coming soon..","ed34cd51":"So here filling those positions with 0 would be accurate as there\nis no rent for own houses.","7770fbc7":"\nThe dataset contains a large set of features (143).We must do some feature engineering to acheive our\ntask.","b220ef62":"# What are the conditions of their houses?","3a5f7856":"# EDTA kernel-costa rica poverty\n","88af25bf":"# Gender distribution\n","dd1e7cca":"Now for v2a1 which indicates the rent of their house.\nThe emptied colmns might mean that they own a house and has no rent.We will check anyway.","58aa7e15":"# Missing values","8fd68efc":"\n![title](img\/costa.jpg)","8c8a9ec4":"# How do they cook?","9eaa818a":"\n## How are their bathrooms?","88ca3726":"# education"}}