{"cell_type":{"5988c5b7":"code","0741d061":"code","5b9849c4":"code","9dbc9129":"code","bd33c4f3":"code","8f54ade2":"code","1ff11780":"code","58a40ba2":"code","2727606f":"code","26a69005":"code","68f5ae70":"code","e3b5f9e4":"code","24fbaac5":"code","5530948d":"code","334e270e":"code","5692e348":"code","1647742d":"code","e997920b":"code","c68489fa":"code","3a2e1179":"code","68ba7ab9":"code","612f2a40":"code","7aa5665e":"code","1e22a738":"code","9ae01b23":"code","ad2317ca":"code","6c9de8ef":"code","99eb50c4":"markdown"},"source":{"5988c5b7":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","0741d061":"#Importo los vectorizadores\nfrom sklearn.feature_extraction.text import CountVectorizer, TfidfVectorizer","5b9849c4":"# Cargo los datos\ndf_train = pd.read_hdf(\"\/kaggle\/input\/sesgos-en-el-dataset-de-snli\/train_data.hdf5\")\ndf_valid = pd.read_hdf(\"\/kaggle\/input\/sesgos-en-el-dataset-de-snli\/valid_data.hdf5\")\ndf_test = pd.read_hdf(\"\/kaggle\/input\/sesgos-en-el-dataset-de-snli\/test_data.hdf5\")","9dbc9129":"#Cantidad de documentos en train\nlen(df_train)","bd33c4f3":"df_train.head()","8f54ade2":"df_valid.head()","1ff11780":"df_test.head()","58a40ba2":"df_submission = pd.read_csv(\"\/kaggle\/input\/sesgos-en-el-dataset-de-snli\/submission_sample.csv\", index_col=\"pairID\")\n","2727606f":"df_submission","26a69005":"text_train = df_train[\"text\"].tolist()\nlabels_train = df_train[\"gold_label\"].tolist()\ntext_val = df_valid[\"text\"].tolist()\nlabels_val = df_valid[\"gold_label\"].tolist()\ntext_test = df_test[\"text\"].tolist()","68f5ae70":"#Veamos el balance de clases\nfrom collections import Counter\nCounter(labels_train)","e3b5f9e4":"cv = CountVectorizer(min_df=10, ngram_range = (1,2)) \n#cv = TfidfVectorizer(min_df=1) ","24fbaac5":"cv_train = cv.fit_transform(text_train)\n","5530948d":"cv_valid = cv.transform(text_val)","334e270e":"cv_train.shape","5692e348":"# Vemos un poco el vocabulario\ncv.get_feature_names()[-19:]","1647742d":"from sklearn.naive_bayes import MultinomialNB","e997920b":"clf = MultinomialNB(alpha=1e-10)\nclf.fit(cv_train, labels_train)","c68489fa":"#logprobabilidades de la clase 0\nclf.coef_[0]","3a2e1179":"#Veamos c\u00f2mo funciona el clasificador para train\nclf.score(cv_train, labels_train)","68ba7ab9":"# Veamos c\u00f2omo funciona el clasificador para valid\nclf.score(cv_valid, labels_val)","612f2a40":"cv_test = cv.transform(text_test)\ntest_labels = clf.predict(cv_test)","7aa5665e":"#Armo el submission.csv\ndf_test = pd.DataFrame(data=test_labels, columns=[\"pred_labels\"],)","1e22a738":"df_test.head()","9ae01b23":"df_test.index.names = [\"pairID\"]","ad2317ca":"df_test","6c9de8ef":"df_test.to_csv(\"submission.csv\")","99eb50c4":"# Armos los CV para train y valid"}}