{"cell_type":{"ab4da157":"code","ddd7746d":"code","33d091ed":"code","4ee9687f":"code","a333c95a":"code","40beeb33":"code","76812d6a":"code","55f412a6":"code","43c485e3":"code","9b4f6de8":"code","659fecca":"markdown","8ab4bb2b":"markdown","850146f3":"markdown","f97e6504":"markdown","b3f668d5":"markdown","c8374dea":"markdown","e9a550e8":"markdown"},"source":{"ab4da157":"import tensorflow as tf\nprint(tf.__version__)","ddd7746d":"# fix keras_segmentation\/pretrained.py change keras to tensorflow.keras\n!git clone https:\/\/github.com\/rkuo2000\/image-segmentation-keras\n%cd image-segmentation-keras","33d091ed":"from keras_segmentation.pretrained import pspnet_50_ADE_20K , pspnet_101_cityscapes, pspnet_101_voc12\n\n# load the retrained models (ADE20k \/ CityScapes \/ VOC2012)\nmodel = pspnet_50_ADE_20K() \n#model = pspnet_101_cityscapes() \n#model = pspnet_101_voc12() ","4ee9687f":"import matplotlib.pyplot as plt\n\ndef show2img(testfile, outfile):\n    testimg = plt.imread(testfile)\n    outimg  = plt.imread(outfile)\n\n    NUM_ROWS = 1\n    IMGs_IN_ROW = 2\n    fig, ax = plt.subplots(NUM_ROWS, IMGs_IN_ROW, figsize=(16,6))\n    ax[0].imshow(testimg, interpolation='nearest')\n    ax[0].axis('off')\n    ax[1].imshow(outimg,  interpolation='nearest')\n    ax[1].axis('off')\n\n    #ax[0].set_title('image 1')\n    #ax[1].set_title('image 2')\n\n    #title = 'side by side view of images'\n    #fig.suptitle(title, fontsize=16)\n    plt.show()","a333c95a":"in_file = '\/kaggle\/input\/input-images\/penny_mart.jpg'\nout_file  = '.\/penny_mart.jpg'","40beeb33":"res = model.predict_segmentation(inp=in_file, out_fname=out_file)","76812d6a":"show2img(in_file, out_file)","55f412a6":"in_file = '\/kaggle\/input\/input-images\/livingroom.jpg'\nout_file  = '.\/livingroom.jpg'","43c485e3":"res = model.predict_segmentation(inp=in_file, out_fname=out_file)","9b4f6de8":"show2img(in_file, out_file)","659fecca":"## Load Model : PSPNet (ADE20k, CityScapes, VOC2012)","8ab4bb2b":"### Test PennyMart","850146f3":"## Test Model","f97e6504":"# Image Segmentation in Keras \n## PSPNet","b3f668d5":"## Repro [Github](https:\/\/github.com\/divamgupta\/image-segmentation-keras)","c8374dea":"### define show 2 side-by-side images","e9a550e8":"### Test LiviningRoom"}}