{"cell_type":{"801f8b9a":"code","6b743a10":"code","7c503b52":"code","e998463e":"code","dff361b7":"code","46c4258f":"code","4c95fb60":"code","4128c27e":"code","52fdfd55":"code","bdaaa990":"code","be99e894":"code","af0c55b7":"code","5cc091f9":"code","7bf14263":"code","93066aba":"code","1e07f095":"code","65a72942":"code","56d9d12f":"code","d3fa05fe":"code","4327d6ab":"code","def59711":"code","684c4e29":"code","3ef37600":"code","8707f807":"code","becc7dd1":"code","27623a08":"code","c1151c84":"markdown","ad2b80e3":"markdown","73eb6145":"markdown","504e8e49":"markdown","d150c6e1":"markdown","36481eb2":"markdown","ab95b178":"markdown","658ae859":"markdown","10c83941":"markdown","ceda4738":"markdown","dd1f4fe9":"markdown","ce08f5a3":"markdown","2ccefd76":"markdown","c8356303":"markdown","7e058d67":"markdown","4147538e":"markdown","ae347dcf":"markdown","da6f76d4":"markdown","52dc2638":"markdown","ad862337":"markdown","2f2bdb21":"markdown","3627c43d":"markdown"},"source":{"801f8b9a":"# data analysis and wrangling\nimport numpy as np\nimport pandas as pd\nimport nltk\nfrom wordcloud import WordCloud, STOPWORDS\nfrom PIL import Image\n\n\n# visualization\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom mpl_toolkits.basemap import Basemap\nimport cartopy.crs as ccrs\nfrom matplotlib import animation, rc\n%matplotlib notebook\n \nimport warnings\nwarnings.filterwarnings(\"ignore\")\n\nfrom datetime import datetime, timedelta\nimport os\nimport io\nimport base64\nfrom IPython.display import HTML, display\nfrom scipy.misc import imread\nimport codecs\nfrom subprocess import check_output\nprint(os.listdir(\"..\/input\/\"))\nprint(check_output([\"ls\", \"..\/input\"]).decode(\"utf8\"))","6b743a10":"data = pd.read_csv('..\/input\/globalterrorismdb_0718dist.csv', encoding='ISO-8859-1')","7c503b52":"data.head()","e998463e":"data = pd.DataFrame(data[['iyear', 'imonth', 'iday', 'country_txt', 'region_txt', 'city', 'latitude', 'longitude', 'attacktype1_txt',\n            'target1', 'targtype1_txt', 'gname', 'weaptype1_txt', 'success', 'nkill', 'nwound', 'summary', 'motive']])","dff361b7":"data.head()","46c4258f":"data.rename(columns={'iyear': 'year', 'imonth': 'month', 'iday': 'day', 'country_txt': 'country', 'region_txt': 'region',\n                    'attacktype1_txt': 'attackType', 'target1': 'target', 'targtype1_txt': 'targetType', 'gname': 'groupName',\n                    'weaptype1_txt': 'weaponType', 'nkill': 'killed', 'nwound': 'wounded'}, inplace=True)","4c95fb60":"data.head()","4128c27e":"plt.figure(figsize=(14,7))\nplt.tight_layout()\nsns.countplot('year', data=data)\nplt.xticks(rotation=90)\nplt.title('Number of Terrorist Activities Each Year')\nplt.show()","52fdfd55":"print('Top 10 terrorism affected countries:')\nprint(data['country'].value_counts().head(10))","bdaaa990":"plt.figure(figsize=(14,7))\nsns.barplot(x= data['country'].value_counts()[:10].index, y=data['country'].value_counts()[:10].values, palette='rocket')\nplt.title('Top 10  Terrorism Affected Countries')\nplt.show()","be99e894":"print('Top regions in terms of terrorism:')\ndata['region'].value_counts().head(10)","af0c55b7":"plt.figure(figsize=(14,7))\nsns.countplot(x= 'region', data=data, palette='rocket', order=data['region'].value_counts().index)\nplt.xticks(rotation=90)\nplt.title('Top 10 Terrorism Affected Regions')\nplt.show()","5cc091f9":"plt.figure(figsize=(14,7))\nplt.tight_layout()\nsns.countplot('attackType', data=data, order=data['attackType'].value_counts().index)\nplt.xticks(rotation=90)\nplt.title('Attack methods used by terrorists')\nplt.show()","7bf14263":"plt.figure(figsize=(17, 7))\nplt.tight_layout()\nsns.countplot(data['targetType'], order=data['targetType'].value_counts().index)\nplt.xticks(rotation=90)\nplt.title('Favourite targets of terrorist')\nplt.show()","93066aba":"data.head()","1e07f095":"#extract the data we are interested in\n\nlat = data['latitude'].values\nlong = data['longitude'].values","65a72942":"fig = plt.figure(figsize=(20,10))\nm = Basemap(projection='mill', resolution='c', llcrnrlat=-80, urcrnrlat=80, llcrnrlon=-180, urcrnrlon=180)\n\nm.shadedrelief()\nm.drawcoastlines()\nm.drawcountries()\nm.scatter(long, lat, latlon=True, c='r', alpha=0.4, s=3)\nplt.show()","56d9d12f":"fig = plt.figure(figsize=(20,10))\nm1 = Basemap(projection='mill', resolution='c', llcrnrlat=-80, urcrnrlat=80, llcrnrlon=-180, urcrnrlon=180, lat_ts=20,\n           lat_0=True, lat_1=True)\n\nm1.shadedrelief()\nm1.drawcoastlines()\nm1.drawcountries()\n\ncolor_list = ['#f97704','#324732', '#cb9d1d', '#cd3333','#1a1a1a','#ff753b','#490c66','#ea1d75','#00bbb3','#8b0000',\n             '#440567','#043145','#da785b','#e00062']\n\ngroup_list = data[data['groupName'].isin(data['groupName'].value_counts()[:14].index)]\nregional_wise_active = list(group_list['groupName'].unique())\n\ndef draw_map(groupName, color, label):\n    lat_g = list(group_list[group_list['groupName']==groupName].latitude)\n    lon_g = list(group_list[group_list['groupName']==groupName].longitude)\n    x, y = m1(lon_g, lat_g)\n    m1.scatter(x, y, c=j , label=i, alpha=0.8, s=3)\n    \nfor i, j in zip(regional_wise_active, color_list):\n    draw_map(i, j, i)\n    \nleg = plt.legend(loc='lower left', frameon=True, prop={'size':10})\nframe = leg.get_frame()\nframe.set_facecolor('white')\nplt.title('Most Active Group in Particular Regions')\nplt.show()","d3fa05fe":"data_region = pd.crosstab(data.year, data.region)\ndata_region.plot(figsize=(18,6))\nplt.show()","4327d6ab":"top10Groups = data[data['groupName'].isin(data['groupName'].value_counts()[1:15].index)]\npd.crosstab(top10Groups.year, top10Groups.groupName).plot(figsize=(18, 6))","def59711":"region_attack = pd.crosstab(data.region, data.attackType)\nregion_attack.plot.bar(stacked=True, colormap='magma', figsize=(16, 8))\nplt.show()","684c4e29":"num_of_attacks = data['country'].value_counts()[:10].to_frame()\nnum_of_attacks.columns=['attacks']\npeople_killed = data.groupby('country')['killed'].sum().to_frame()\nnum_of_attacks.merge(people_killed, left_index=True, right_index=True, how='left').plot.bar(width=0.8, figsize=(18,6))\nplt.show()","3ef37600":"fig = plt.figure(figsize=(14, 8))\nsns.barplot(data['groupName'].value_counts()[1:15].values, data['groupName'].value_counts()[1:15].index, palette=('hot'))\nplt.xticks(rotation=90)\nplt.title('Most Notorious Groups')\nplt.show()","8707f807":"data['casualties'] = data['killed'] + data['wounded']","becc7dd1":"fig = plt.figure(figsize=(19,10))\ndef animate(year):\n    ax = plt.axes()\n    ax.clear()\n    ax.set_title('Terrorism in world' + '\\n' + str(year))\n    m2 = Basemap(projection='mill', resolution='c', llcrnrlat=-80, urcrnrlat=80, llcrnrlon=-180, urcrnrlon=180)\n    lat_ani = list(data[data['year']==year].latitude)\n    long_ani = list(data[data['year']==year].longitude)\n    x_ani, y_ani = m2(long_ani, lat_ani)\n    m2.scatter(x_ani, y_ani, s=[i for i in data[data['year']==year].casualties], c= 'r')\n    m2.drawcoastlines()\n    m2.drawcountries()\n    \nani = animation.FuncAnimation(fig,animate,list(data.year.unique()), interval = 1500)\n\nani.save('animation.gif', writer='imagemagick', fps=1)\nplt.close(1)\nfilename = 'animation.gif'\nvideo = io.open(filename, 'r+b').read()\nencoded = base64.b64encode(video)\nHTML(data='''<img src=\"data:image\/gif; base64, {0}\" type=\"gif\"  \/>'''.format(encoded.decode('ascii')))\n","27623a08":"most_used_word = data['motive'].str.lower().str.replace(r'\\|', ' ').str.cat(sep=' ')\nwords = nltk.tokenize.word_tokenize(most_used_word)\nword_dist = nltk.FreqDist(words)\nstopwords = nltk.corpus.stopwords.words('english')\nwords_except_stop_dist = nltk.FreqDist(i for i in words if i not in stopwords)\nwc = WordCloud(stopwords=STOPWORDS, background_color='black').generate(\" \".join(words_except_stop_dist))\nplt.imshow(wc, interpolation='bilinear')\nplt.axis(\"off\")\nplt.show()","c1151c84":"#### 4.2 Top 10 terrorism affected countries","ad2b80e3":"# 7. Type of attack Vs Region","73eb6145":"#### Most active groups in particular regions","504e8e49":"# 10. Most frequently used word in terrorist attacks\n\nLet's make a word cloud to see it.","d150c6e1":"It seems like the number of attack incresed every year. And, The attacks boomed from the year 2012","36481eb2":"#### 4.1 Number of terrorist activities every year","ab95b178":"# Analyzing Terrorist Activities Around The World\n\nThanks for stopping by my kernel.\n\n### This work is inspired by the work of many kagglers who have worked on this dataset. If you like my findings on the dataset, please, leave an upvote. Feedback on my findings is highly appreciated! \n\nI will be using Basemap for plotting geographical maps. There is a issue with basemap and python 3.6, I have resolved the issue. Feel free to ask me.\n\n#### Note:\nThis kernel is a work in progress. Be patience to see interactive maps, animations and word clouds.\n\n#### Definition of terrorism: \n\nTerrorism is, in the broadest sense, the use of intentionally indiscriminate violence as a means to create terror among masses of people; or fear to achieve a financial, political, religious or ideological aim.\n\n#### About the dataset:\n\nThe dataset contains information of more than 180,000 terrorist attacks.\n\nThe Global Terrorism Database (GTD) is an open source database including information on terrorist attacks around the world from 1970 through 2017, except 1993. The GTD includes systematic data on deomestic as well as international terrorist incidents that have occurred during this time. It includes more than 180,000 attacks. [More Information on dataset](http:\/\/start.umd.edu\/gtd\/)\n\n\n## Content\n\nThere are 135 different columns in this dataset. But, I have selected some of them.\n\n- year  -  in which year the attack happend\n- month\t- in which month of the year the attack happened\n- day   - on which day of the month the attack happened \n- country - in which country the attacked happened\n- region  - which region the country lies in\t\n- city\t  - the city in which the attack happened\n- latitude - of the location of the attack\n- longitude\t- of the location of attack\n- attackType - \ttype of attack\n- target - who was the target\n- targetType - type of target\n- groupName\t- name of the group who executed the attack\n- weaponType - which type of weapon is used in the attack\n- success - whether the attack was successful or not\n- killed - how many people were killed in the attack\n- wounded - how many people were wounded in the attack\n- summary - summary of the attack happened\n- motive - motive of the attack\n\n\n\n\n## Changelog \n- added world terrorist attack animation (10\/2\/2018)\n- added word cloud of most used word during terrorist attack (10\/2\/2018)\n\n## Index of content\n\n1. Import the necessary libraries \n2. Import data\n3. Peek in the data and simply it\n4. Analyze, Analyze and Analyze\n - 4.1 Number of terrorist activities every year\n - 4.2 Top 10 terrorism affected countries\n - 4.3 Top 10 terrorism affected regions\n - 4.4 Attack methods used by terrorist\n - 4.5 Favourite targets of terrorist\n5. Map projections\n6. Trends\n - 6.1 Attack trend Vs Regions\n - 6.2 GroupName Vs Activity Trend\n7. Attack Vs Killed\n8. Most Notorious Groups\n9. Terrorist Attacks on the World (Animation)\n10. Most frequently used word in terrorist attacks (word Cloud)","658ae859":"As you can see that there are 135 different columns for this dataset. We will take only those columns which we need for our analysis. Also, The names of the columns are pretty weired. I will simplify them.\n\nI have decided to take the following parameter in the analysis: \n\n|old column name | new column name|\n|----------------|----------------|\n|iyear            | year          |\n|imonth           | month |\n|iday       | day|\n|country_txt | country |\n|region_txt | region |\n|city | city|\n|latitude | latitude |\n|longitude | longitude |\n|attacktype1_txt | attackType |\n|target1 | target |\n|targtype1_txt | targetType |\n|gname | groupName |\n|weaptype1_txt | weaponType |\n|success | success|\n|nkill | killed |\n|nwound | wounded |\n|summary | summary|\n|motive | motive|\n","10c83941":"#### 6.2 GroupName Vs Activity Trend","ceda4738":"# 7. Attack Vs Killed","dd1f4fe9":"# 5. Map projections\n\n#### Terrorism activities around the world.","ce08f5a3":"#### 6.1 Attack trend Vs Regions","2ccefd76":"# 9. Terrorist Attacks on the world (Animation)\n\nLet's also add the casualties[killed + wounded] figure in the dataset","c8356303":"#### 4.3 Top 10 terrorism affected regions","7e058d67":"# 2. Import data","4147538e":"# 3. Peek in the data and simplify it","ae347dcf":"#### 4.4 Attack methods used by terrorist","da6f76d4":"# 8. Most Notorious Groups ","52dc2638":"#### 4.5 Favourite targets of terrorist","ad862337":"# 1. Import the necessary libraries","2f2bdb21":"# 4. Analyze, Analyze and Analyze\n\nLet's look at the number of attack every year.","3627c43d":"# 6. Trends"}}