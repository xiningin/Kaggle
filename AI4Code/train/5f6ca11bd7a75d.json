{"cell_type":{"df8157d5":"code","1b029043":"code","48ae2fc7":"code","0f085d3f":"code","f2eb31ad":"code","2bd8be4c":"code","0c3483b1":"code","25af3bcd":"code","8aba9e93":"code","2826c3d8":"code","c7bd6b67":"code","eed33846":"code","e1c242e7":"code","703b6bbf":"markdown","d92fa7d9":"markdown","e54ca023":"markdown","de830c3c":"markdown","bea1f94e":"markdown","0bc5650d":"markdown","460de8f8":"markdown","be722cdb":"markdown"},"source":{"df8157d5":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns # for plotting\nimport matplotlib.pyplot as plt # for plotting\nimport datetime\n\nimport os\nprint(os.listdir(\"..\/input\"))","1b029043":"data = pd.read_csv('..\/input\/ukraine_deputies.csv')\ndata.head()","48ae2fc7":"data.columns","0f085d3f":"data.shape","f2eb31ad":"data.info()","2bd8be4c":"data['Education'] = (data['Alma mater'].fillna('')+data['\u041e\u0441\u0432\u0456\u0442\u0430'].fillna('')).replace(r'', np.nan)\ndata.drop(['Alma mater', '\u041e\u0441\u0432\u0456\u0442\u0430'], axis=1, inplace=True)","0c3483b1":"data['Start Work'].unique()","25af3bcd":"data['End Work'].unique()","8aba9e93":"today = datetime.datetime.now().strftime('%d.%m.%Y')\ndata['End Work'].fillna(today, inplace=True)\ndata['End Work'] = data['End Work'].str.replace(r'\\[\\d*\\]| \\S*', '')\ntoday","2826c3d8":"data['WorkEnd'] = data[data['Rada']==8].apply(lambda x: '-'.join(x['End Work'].split('.')[::-1]), axis=1)\ndata['WorkEnd'] = data['WorkEnd'].fillna(data[data['Rada']<8]['End Work'])\ndata['WorkEnd'] = pd.to_datetime(data['WorkEnd']).dt.date\ndata.drop(['End Work'], axis=1, inplace=True)","c7bd6b67":"data['WorkStart'] = data[data['Rada']==8].apply(lambda x: '-'.join(x['Start Work'].split('.')[::-1]), axis=1)\ndata['WorkStart'] = data['WorkStart'].fillna(data[data['Rada']<8]['Start Work'])\ndata['WorkStart'] = pd.to_datetime(data['WorkStart']).dt.date\ndata.drop(['Start Work'], axis=1, inplace=True)","eed33846":"data['WorkPeriod'] = (data['WorkEnd']-data['WorkStart']).dt.days","e1c242e7":"data.info()","703b6bbf":"## Conclusion\nThis concludes my starter analysis for that time! To go forward from here, click the blue \"Edit Notebook\" button at the top of the kernel. This will create a copy of the code and environment for you to edit. ","d92fa7d9":"## Data\n\nThis is a historical dataset of Ukraine Deputies from 1990 till 2018. Data are scraped from Wikipedia.\nThe file ukraine_deputies.csv contains 3851 rows and 26 columns. Each row corresponds to an individual deputy in different Parliaments.\n\nYou can find a description of each column in a relative place for it.\n\nDataset was created at October 2018.\n\n**Bottleneck:** The language of data is Ukrainian","e54ca023":"## Imports\nI am using a typical data science stack: `numpy`, `pandas`, `sklearn`, `matplotlib`. ","de830c3c":"Also, I created a new column that represents the time of working. I mean amount of days.","bea1f94e":"Let's compare columns before and after processing `data.info()`. Now it looks cleaner, but it not enough.","0bc5650d":"Let's take a quick look at what the data looks like:","460de8f8":"We already have two columns that represent the education of deputy. Let's concatenate and create a new one.","be722cdb":"Also expected date fields (`Start Work` and `End Work`) are not the same. At least four different formats date  we received`1992-03-12`,  `23.12.2014`,  `13.08.2015 \u2020` and `2.12.2014[34]`.  You can see all unique dates from mentioned above columns below in hidden outputs.\n\nThe column `End Work` has missing values for the last Parliament (current). I substitute missing dates with a current date.\n\nLet's count those observations."}}