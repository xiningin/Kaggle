{"cell_type":{"ceeb89b2":"code","ebb10d2b":"code","8b31e525":"code","fb898953":"code","fc7efa92":"code","5fae5afe":"code","72c6497d":"code","8b675357":"code","b3c05a1b":"code","b99f2a00":"code","f50f6601":"code","4cea97e9":"code","31bc2916":"code","89a7abc5":"code","1a2635a4":"markdown","e655c30d":"markdown","64a0da5b":"markdown","090e8437":"markdown","dacf7885":"markdown","51f9753c":"markdown","dc39262a":"markdown","9259f0f2":"markdown","bde61f0f":"markdown","62e5e250":"markdown","24fdcd08":"markdown","fbb660d8":"markdown","23f4e16f":"markdown","b8f30304":"markdown","f912e44f":"markdown","48bd6d52":"markdown","fc91c5aa":"markdown","7138af46":"markdown","c4c42be7":"markdown","80c18f3d":"markdown"},"source":{"ceeb89b2":"import pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport numpy as np\n%matplotlib inline","ebb10d2b":"src = r'..\/input\/insurance.csv'\ndata = pd.read_csv(src)","8b31e525":"data.info()","fb898953":"sns.set_style(\"whitegrid\", {'grid.linestyle': '--'})\nplt.figure(figsize = (10,6))\nsns.scatterplot(x = \"age\", y = \"charges\", data = data, hue = \"sex\")\nplt.xlabel(\"Age\")\nplt.ylabel(\"Charges\")\nplt.title(\"Distribution of charges by age and sex\")","fc7efa92":"smokers = data[\"smoker\"].unique()\ncolors = [\"Reds\", \"Greens\"]\nfor i, smoker in enumerate(smokers):\n    temp = data[data[\"smoker\"] == smoker]\n    sns.scatterplot(temp[\"bmi\"], temp[\"charges\"], cmap = colors[i])\nplt.legend(smokers)","5fae5afe":"plt.figure(figsize = (10,5))\nsns.boxplot(x = \"region\", y = \"charges\", hue = \"sex\", data = data)","72c6497d":"sns.set_style(\"whitegrid\", {'grid.linestyle': '--'})\nplt.figure(figsize = (10,6))\nsns.scatterplot(x = \"age\", y = \"charges\", data = data, hue = \"smoker\")\nplt.xlabel(\"Age\")\nplt.ylabel(\"Charges\")\nplt.title(\"Distribution of charges by age and sex\")","8b675357":"plt.figure(figsize = (10,8))\nsns.boxplot(x = \"children\", y = \"charges\",hue = \"smoker\", data = data)\nplt.title(\"Distribution of charges by number of children\")","b3c05a1b":"sns.heatmap(data.corr(), annot = True)","b99f2a00":"data.head()","f50f6601":"# Transforming categorical features to numerical values\ndata[\"smoker\"] = data[\"smoker\"].replace([\"yes\",\"no\"], [1,0])\ndata[\"sex\"] = data[\"sex\"].replace([\"male\",\"female\"], [1,0])\ndata[\"region_southeast\"] = data[\"region\"].apply(lambda x: 1 if x == \"southeast\" else 0)","4cea97e9":"from sklearn.linear_model import LinearRegression\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import r2_score, mean_squared_error","31bc2916":"# Data are split into training and test data\ny_data = data[\"charges\"]\nx_data = data.drop([\"charges\",\"region\"], axis = 1)\nx_train, x_test, y_train ,y_test = train_test_split(x_data, y_data, test_size = 0.25)\n\n# Model is trained and then used on test dataset\nmodel1 = LinearRegression()\nmodel1.fit(x_train, y_train)\ny_pred = model1.predict(x_test)\n\n# Coefficients and intercept of linear regression model extracted\nmodel_coef = pd.DataFrame(data = model1.coef_, index = x_test.columns)\nmodel_coef.loc[\"intercept\", 0] = model1.intercept_ \ndisplay(model_coef)\n\n# Model's performance\nmodel_performance = pd.DataFrame(data = [r2_score(y_test, y_pred), np.sqrt(mean_squared_error(y_test, y_pred))],\n                                 index = [\"R2\",\"RMSE\"])\ndisplay(model_performance)","89a7abc5":"residual = y_test - y_pred\n# Positive residual means that the actual charge > predicted charge\n# Negative residual means that the actual charge < predicted charge\nplt.scatter(y_test, residual)\nplt.title(\"Residual vs actual charges\")\nplt.xlabel(\"Actual charges\")\nplt.ylabel(\"Residual\")","1a2635a4":"The is no correlation between the different numerical features. ","e655c30d":"Smoking is a huge factor as compared to other features. Just by being a smoker, the charge increases by approximately 25,000 regardless of age. Thereafter, the charges increase with age, bmi (higher health risk) and children (insurance is increasingly important with dependents).","64a0da5b":"## Charges by age and smoker","090e8437":"## Correlation between features","dacf7885":"There is no missing values. So there is no need to concern myself with missing values.","51f9753c":"## Charges by smoker and number of children","dc39262a":"## Pre-processing","9259f0f2":"Across south west, north west and north east, the charges are rather similar. However, individuals from south east has a wider range of charges for both sexes. Each individual should be categorized as either from southeast or not from southeast region.","bde61f0f":"# Modelling","62e5e250":"The model is great for charges less than 15,000 as the residual is within 5000. However, the model breaks down at higher charge (> 15,000) as the residual very significant. The model could over predict the actual charge by 10,000 or more, or under predict the actual charge by minimally 5,000.","24fdcd08":"# Exploratory Data Analysis","fbb660d8":"Despite the BMI indicator is used to measure health risk for an individual, the feature is not as important as knowing whether the individual is a smoker or non-smoker. \n\nSmoker tends to incur a much higher charge as compared to non-smoker. When the BMI of a smoker goes beyond 30, the charges increases to a minimum of 30000. Non-smoker with BMI > 30 generally have charges incurred below 30000.","23f4e16f":"## Charges by region and sex","b8f30304":"## Charges by age and sex","f912e44f":"## Charges by smoker and BMI","48bd6d52":"# Basic data information","fc91c5aa":"There seems to be a charges threshold. Smokers generally make claims with minimum amount of approximately 15000 regardless of number of children whereas non-smokers make a maximum claim of 20000 (typically below 15000).\n\nSmoking is definitely an important feature to take note in modelling.","7138af46":"The charges definitely do increase with respect to age. There is no clear difference in charges for male vs female.","c4c42be7":"Smokers are generally charge a much higher rate. Charges above 30000 are usually from smokers and below 15000 are generally non-smokers. Anything in between could be from smoker or non-smoker.","80c18f3d":"## Linear Regression Model"}}