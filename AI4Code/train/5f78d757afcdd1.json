{"cell_type":{"1f2920bf":"code","979ba3d1":"code","d3a2ff09":"code","36b6271d":"code","e8dfbc02":"code","c352555e":"code","1bc5282d":"code","f7158ca2":"code","e45f3009":"code","32f2f7fe":"code","6df71e97":"code","ddd6acea":"code","a201afa9":"code","a51e4ff2":"code","5f48f194":"code","b8ed4b4a":"code","b250553f":"code","03003ba5":"code","7604a885":"code","e474717c":"code","8c2aeeb5":"code","ad37f9dd":"code","34007d9f":"code","66009b4d":"code","a632537d":"code","7630cdd7":"code","b150bd30":"code","9f5a0535":"code","8d1cdcfe":"code","f98f2f3a":"code","16e7962a":"code","2db087f5":"code","4210aa14":"code","8d3eba05":"code","0e703f63":"code","e4e200c9":"code","b28c0246":"code","ce473d17":"code","afb7788b":"code","4420a859":"code","ad58ef96":"code","7771688e":"code","fbe7adc5":"code","b7e29c83":"code","3230a421":"code","17d9ed0b":"code","ee09be2d":"code","b31b856c":"code","5028beff":"code","8f0a80e6":"code","fe2eb985":"code","d9d080a6":"code","efe9f3b2":"code","9990e3f1":"code","1cf81316":"code","40283ed7":"code","becdcc3d":"code","9ffd1538":"code","e72c4bd0":"code","536efdf9":"code","a5d9326f":"code","9ece0d66":"code","61eeecbc":"code","aede64a9":"code","1c53092f":"code","254643dc":"code","d83c597f":"code","12e39a3d":"code","0deebd94":"code","e101cbe5":"code","84e2c46e":"code","9ec46754":"code","842d2305":"code","7e305592":"code","f58c27ac":"code","95c5422b":"code","36fc60a1":"code","217c00dd":"code","8e0c4a74":"code","816b8e8d":"markdown","4474d03f":"markdown","19b6c9f1":"markdown","43538cce":"markdown","57699e1e":"markdown","814f4bd0":"markdown","df15eb6a":"markdown","c57359df":"markdown","7d84e5bc":"markdown","879e07b9":"markdown","207a1671":"markdown","bfdb3dae":"markdown","4d6c2e83":"markdown","11da2660":"markdown","62b41de1":"markdown","048b5b36":"markdown","7e006986":"markdown","22942eb0":"markdown","0871edf7":"markdown","bbdd9476":"markdown","487339ba":"markdown","43b9624e":"markdown","a9b4d1dc":"markdown","b7abfa0e":"markdown","6c8d2ea3":"markdown","c7953b93":"markdown","172c6c87":"markdown","4e6eac64":"markdown","86116d38":"markdown","a78258d7":"markdown","d92d8a92":"markdown","1574d774":"markdown","bf7a1f89":"markdown","5464c299":"markdown","664f97a8":"markdown","343be411":"markdown","6444060e":"markdown","182300af":"markdown","cc69afdc":"markdown","8d485423":"markdown","30fbad3b":"markdown","4448c45e":"markdown","14cc2bf8":"markdown","d778afe1":"markdown","66467093":"markdown"},"source":{"1f2920bf":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","979ba3d1":"total_suicidal=pd.read_csv(\"..\/input\/master.csv\")","d3a2ff09":"total_suicidal.head()","36b6271d":"total_suicidal[\"country\"].value_counts()","e8dfbc02":"total_suicidal.info()","c352555e":"total_suicidal.describe()","1bc5282d":"import matplotlib.pyplot as plt\ntotal_suicidal.hist(bins=50, figsize=(20,15))\nplt.show()","f7158ca2":"year_grouped=total_suicidal.groupby(\"year\")","e45f3009":"year_grouped_sum=year_grouped.sum()","32f2f7fe":"import seaborn as sns","6df71e97":"plt.rcParams[\"axes.labelsize\"] = 20\nax = sns.lineplot(x='year', y=\"suicides\/100k pop\", data=year_grouped_sum.reset_index())\nax.set(xlabel='Year', ylabel='Suicides \/ 100k population')","ddd6acea":"gender_grouped=total_suicidal.groupby(\"sex\")","a201afa9":"gender_grouped_sum=gender_grouped.sum()","a51e4ff2":"gender_grouped_sum=gender_grouped_sum.reset_index()","5f48f194":"plt.rcParams[\"axes.labelsize\"] = 20\nax=sns.catplot(x='sex', y='suicides\/100k pop', \n            data=gender_grouped_sum, kind=\"bar\", height=10, aspect=0.6)\nax.set(xlabel='Gender', ylabel='Suicides \/ 100k population')\nplt.show()","b8ed4b4a":"country_grouped=total_suicidal.groupby(\"country\")","b250553f":"country_grouped_sum=country_grouped.sum()","03003ba5":"country_grouped_sum=country_grouped_sum.reset_index()","7604a885":"country_grouped_sum_sorted=country_grouped_sum.sort_values('suicides\/100k pop')","e474717c":"plt.rcParams[\"axes.labelsize\"] = 30\nax=sns.catplot(x='suicides\/100k pop', y='country', \n            data=country_grouped_sum_sorted, kind=\"bar\", height=20, aspect=0.6)\nax.set(xlabel='Total Suicides', ylabel='Country')\nplt.show()","8c2aeeb5":"gen_grouped=total_suicidal.groupby(\"generation\")","ad37f9dd":"gen_grouped_sum=gen_grouped.sum()","34007d9f":"gen_grouped_sum=gen_grouped_sum.reset_index()","66009b4d":"plt.rcParams[\"axes.labelsize\"] = 40\nsns.set(font_scale=2)\nax=sns.catplot(x='suicides\/100k pop', y='generation', \n            data=gen_grouped_sum, kind=\"bar\", height=15, aspect=0.8)\nax.set(xlabel='Total suicides\/100K population', ylabel='Generation')\nplt.show()","a632537d":"se=total_suicidal.groupby(['country','year'])['suicides\/100k pop'].mean().reset_index().groupby('country').mean()","7630cdd7":"se=se.reset_index()","b150bd30":"se2=total_suicidal.groupby(['country','year'])['gdp_per_capita ($)'].mean().reset_index().groupby('country').mean()","9f5a0535":"se2=se2.reset_index()","8d1cdcfe":"se['100k_avg']=se[\"suicides\/100k pop\"]","f98f2f3a":"se['gdp_per_capita_average']=se2[\"gdp_per_capita ($)\"]","16e7962a":"se.head()","2db087f5":"sns.set(rc={'figure.figsize':(15,10)})\nplt.rcParams[\"axes.labelsize\"] = 20\nax=sns.scatterplot(x='gdp_per_capita_average', y='100k_avg', s=100, hue=\"100k_avg\",palette=\"Set1\",data=se)\nax.set(xlabel='GDP per capita ($)', ylabel='Suicides \/ 100K')\nplt.show()","4210aa14":"se_num_X=se[\"gdp_per_capita_average\"]","8d3eba05":"se_num_Y=se[\"100k_avg\"]","0e703f63":"se_num=pd.concat([se_num_X,se_num_Y],axis=1)","e4e200c9":"se_num_Xarray=se_num_X.values.reshape(-1,1)","b28c0246":"se_num_Yarray=se_num_Y.values.reshape(-1,1)","ce473d17":"from sklearn.linear_model import LinearRegression","afb7788b":"lin_reg=LinearRegression()","4420a859":"lin_reg.fit(se_num_Xarray,se_num_Yarray)","ad58ef96":"print(\"Y intercept value is\", lin_reg.intercept_)","7771688e":"print(\"Slope is\", lin_reg.coef_)","fbe7adc5":"plt.scatter(se_num_X, se_num_Y, label='Data (WITH outliers)', color='green', marker='^', alpha=.5)\nax=sns.regplot(x='gdp_per_capita_average', y='100k_avg', data=se_num, scatter=None, color=\"g\",label=\"Linear_outlier\")\nax.set(xlabel='GDP per capita ($)', ylabel='Suicides \/ 100K')\nplt.legend(loc=\"best\")\nplt.show()","b7e29c83":"from scipy.stats import zscore","3230a421":"se_Y_zscore=zscore(se_num_Y)","17d9ed0b":"se_bool_Y=np.absolute(se_Y_zscore)<3","ee09be2d":"se_bool_series=pd.Series(se_bool_Y)","b31b856c":"new_se=pd.concat([se_num_X,se_num_Y,se_bool_series],axis=1)","5028beff":"new_se=new_se[new_se[0]]","8f0a80e6":"new_se_num_Xarray=new_se[\"gdp_per_capita_average\"].values.reshape(-1,1)","fe2eb985":"new_se_num_Yarray=new_se[\"100k_avg\"].values.reshape(-1,1)","d9d080a6":"lin_reg.fit(new_se_num_Xarray,new_se_num_Yarray)","efe9f3b2":"print(\"Y intercept value is\", lin_reg.intercept_)","9990e3f1":"print(\"Slope is\", lin_reg.coef_)","1cf81316":"plt.scatter(se_num_X, se_num_Y, label='Data (WITH outliers)', color='green', marker='^', alpha=.5)\nsns.regplot(x='gdp_per_capita_average', y='100k_avg', data=se_num, scatter=None, color=\"g\",label=\"Linear_outlier\")\nplt.scatter(new_se[\"gdp_per_capita_average\"], new_se[\"100k_avg\"], label='Data (WITHOUT outliers)', color='red', marker='o', alpha=.5)\nax=sns.regplot(x='gdp_per_capita_average', y='100k_avg', data=new_se, scatter=None, marker=\"^\",color=\"r\",label=\"Linear_no_outlier\")\nax.set(xlabel='GDP per capita ($)', ylabel='Suicides \/ 100K')\nplt.legend(loc=\"best\")\nplt.show()","40283ed7":"se3=total_suicidal.groupby(['country','year'])['suicides\/100k pop'].sum().unstack()","becdcc3d":"se3=se3.reset_index()","9ffd1538":"se3.head()","e72c4bd0":"se3=se3.T.reset_index()","536efdf9":"se3.columns = se3.iloc[0]","a5d9326f":"se3=se3.rename(columns = {'country':'year'})","9ece0d66":"se3=se3.drop([0])","61eeecbc":"se3=se3.replace('NaN', np.NaN)","aede64a9":"se3.head()","1c53092f":"column_length=len(se3.columns)","254643dc":"from sklearn.metrics import r2_score","d83c597f":"index_append=[]\nr2_append=[]\ncoeff_append=[]\nfor x in range(1,column_length):\n    new_series=pd.concat([se3['year'],se3.iloc[:,x]], axis=1)\n    new_series2=new_series.dropna()\n    new_data=pd.DataFrame(new_series2).reset_index()\n    year_array=new_data['year'].values.reshape(-1,1)\n    sui_array=new_data.iloc[:,2].values.reshape(-1,1)\n    lin_reg.fit(year_array,sui_array)\n    coeff=lin_reg.coef_\n    y_pred = lin_reg.predict(year_array)\n    r2_sklearn = r2_score(sui_array,y_pred) \n    if 0.8<r2_sklearn<1:\n        index_append.append(x)\n        r2_append.append(r2_sklearn)\n        coeff_append.append(coeff)","12e39a3d":"scal_coeff=[]\nfor x in coeff_append:\n    co=np.asscalar(x)\n    scal_coeff.append(co)\nprint(scal_coeff)","0deebd94":"cols=se3.columns","e101cbe5":"L=[]\nL2=[]\nfor x in range(0,len(index_append)):\n    new_country=cols[index_append[x]]\n    L.append(new_country)\nse4=pd.DataFrame(L, columns=['country'])\nse5=pd.DataFrame(r2_append, columns=['R^2'])\nse_co=pd.DataFrame(scal_coeff, columns=['coeff'])\nse6=pd.concat([se4,se5,se_co], axis=1)\n#se_sign=se6['coeff'].apply(lambda x: x<0)\n#se6['negative']=se_sign\nse6.loc[se6.coeff<0, 'sign']='Negative trend'\nse6.loc[se6.coeff>0, 'sign']='Positive trend'","84e2c46e":"ax = sns.catplot(x=\"R^2\", y=\"country\", data=se6, saturation=0.5, kind=\"bar\", hue=\"sign\",ci=None, height=10,aspect=1,palette=\"Set2\",legend=False)\nplt.legend(bbox_to_anchor=(1.05, 1), loc=2, borderaxespad=0.)\nax.set(xlabel='R^2 value for linear regression', ylabel='Country')","9ec46754":"L=['Finland','France','Hungary','year']","842d2305":"se_N=se3[L]","7e305592":"se_N=se_N.reset_index()","f58c27ac":"plt.scatter(se_N['year'], se_N['Finland'], label='Finland', color='blue', marker='^', alpha=.5)\nax=sns.regplot(x='year',y='Finland',data=se_N, scatter=None, color='blue',label=\"Finland\")\nplt.scatter(se_N['year'], se_N['France'], label='France', color='red', marker='^', alpha=.5)\nax2=sns.regplot(x='year', y='France', data=se_N, marker=\"^\",color=\"red\",scatter=None,label=\"France\")\nplt.scatter(se_N['year'], se_N['Hungary'], label='Hungary', color='green',marker='^', alpha=.5)\nax3=sns.regplot(x='year', y='Hungary', data=se_N, marker=\"x\",color=\"green\", scatter=None, label=\"Hungary\")\nax3.set(xlabel='Year', ylabel='Suicides \/ 100K')\nplt.legend(loc=\"best\")\nplt.show()","95c5422b":"L=['Republic of Korea','Mexico','Philippines','year']","36fc60a1":"se_P=se3[L]","217c00dd":"se_P=se_P.reset_index()","8e0c4a74":"plt.scatter(se_P['year'], se_P['Republic of Korea'], label='Republic of Korea', color='blue', marker='^', alpha=.5)\nax=sns.regplot(x='year',y='Republic of Korea',data=se_P, scatter=None, color='blue',label=\"Republic of Korea\")\nplt.scatter(se_P['year'], se_P['Mexico'], label='Mexico', color='red', marker='^', alpha=.5)\nax2=sns.regplot(x='year', y='Mexico', data=se_P, marker=\"^\",color=\"red\",scatter=None,label=\"Mexico\")\nplt.scatter(se_P['year'], se_P['Philippines'], label='Hungary', color='green',marker='^', alpha=.5)\nax3=sns.regplot(x='year', y='Philippines', data=se_P, marker=\"x\",color=\"green\", scatter=None, label=\"Philippines\")\nax3.set(xlabel='Year', ylabel='Suicides \/ 100K')\nplt.legend(loc=\"best\")\nplt.show()","816b8e8d":"Because there are only 8364 non-null instances for \"HDI for year\" attribute while there are 27,820 instances in total, we can expect about ~19,000 null instances in \"HDI for year\".\nAlso, since this data came from a CSV file, the \"object\" type must indicate a text attribute.","4474d03f":"**Getting information about datasets**","19b6c9f1":"**Conclusion**","43538cce":"The describe() method shows a summary of the numerical attributes:","57699e1e":"Let's use a threshold of 3 for our Zscore filtering","814f4bd0":"We can take a quick look at the data by visualizing some of the features.\nLet's first take a look at the global trend of suicides. For this we first need to sum of the number of suicides for each year:","df15eb6a":"Let's rerun linear regression without the outlier point.","c57359df":"* Suicides by gender","7d84e5bc":"**Importing datasets**","879e07b9":"* Suicides by generation","207a1671":"Same thing as above but now for each country","bfdb3dae":"* GDP effect on suicides","4d6c2e83":"Before we move onto some prediction work, let's find which country has a linearly increasing suicidal trend **over YEARS** for easiness.\nWe will test this through hypothesis test for regression slope.","11da2660":"Let's try to fit a linear model to this data just for our initial try. First, I will create numpy arrays for \"GDP per capita\" and \"Suicides\/100K pop\" attributes.","62b41de1":"We can also compare generation by generation.","048b5b36":"Note that the null values are ignored as you can see in the 'count' of \"HDI for year\". The std row shows the standard deviation. The 25%,50% and 75% rows show the corresponding percentiles below which a given percentage of observations in a group of observations falls.","7e006986":"Data needs to be processed a bit to exclude the rows with \"NaN\" values. Also, we will choose those datasets that show R^2 values higher than 0.8 as the datasets that match very well with linear regression.","22942eb0":"**Plotting histogram**","0871edf7":"Now, let's take a deeper look into the GDP effect on suicides. I will choose \"GDP per capita\" for every conntry across all the available years for my analysis. Because GDP per capita is changing over the years, I will choose an average for this. For the same reason, I will take an average for suicides\/100k population data.","bbdd9476":"Let's plot the predicted data (red) along with the original data (gray).","487339ba":"In this project, I will try to visulize the global suicidal datasets and find meaningful correlation between suicides and other socio-geological factors.","43b9624e":"You can see the Republic of Korea (South Korea)'s suicidal trend has been increasing very rapidly, which is concerning.","a9b4d1dc":"This indicates that there are multiple rows for each country for different conditions such as \"Male vs Female\" or \"Generation X vs Boomers\", and there are 12 attributes in total. \n\nThe \"Country\" coulmn's repetitiveness (and some other columns' too) means that it is probably a categorical attribute. Let's see what categories exist and how many of conditions belong to each category by using the value_counts() method:","b7abfa0e":"**Data visualization**","6c8d2ea3":"This hows that the \"Silent\" generation has committed the most number of suicides\/100K population across all years and countries.","c7953b93":"Now let's see how these countries look. For negatively trending countries, I will look at Finland, France and Hungary while I will look at Mexico, Phillippines and Republic of Korea for the postively trending countries.","172c6c87":"From this we can see that Hundary's suicidal rate has been decreasing the fastest.","4e6eac64":"**Showing top 5 rows of datasets**","86116d38":"* Suicides by country","a78258d7":"Loading linear regression model","d92d8a92":"We can clearly see that men have committed more suicides than women","1574d774":"We can see that there was only one outlier (Lithuania in the actual dataset), and there is also a slight linearly increasing trend even without the outlier. However, the overdata is pretty scattered, and thus it should not be concluded that GDP per capita directly and linearly affects suicides.","bf7a1f89":"Let's plot a histogram for each numerical attribute to better understand the type of data we are dealing with although this does not directly show any correlation yet.","5464c299":"Let's get a quick description of the data, in particular the total number of rows, and each attribute's type and number of non-null values","664f97a8":"* Linearity test","343be411":"We can see that there is a dramatic drop in the total number of suicides past year 2015.","6444060e":"- Overall, suicides have been decreasing since early 2000.\n- Men have committed more sucides than women.\n- \"Silent\" generation has committed the most suicides.\n- There is a positive correlation between suicides and GDP per capita.\n- Of those countries that have a linear relationship between Suicides\/100K and Year, South Korea has the steepest increasing slope.","182300af":"From the figure above, we can see that Russian Federation was the country with the highest number of suicides over the years between 1985 and 2016.","cc69afdc":"Now let's take a look at the positively trending countries.","8d485423":"We will now sum them up for each year:","30fbad3b":"**Using DESCRIBE method for a summary**","4448c45e":"It does not look super bad, but not very convincing either. Let's remove some of the outliers based on the Zscore values.","14cc2bf8":"* Global trend of suicides as a function of year","d778afe1":"Transposing datasets for easiness","66467093":"Let's see how gender has affected suicides."}}