{"cell_type":{"8cbfb72a":"code","59b3c646":"code","5f01ba32":"code","c6a56975":"code","3e17200f":"code","d8a1830b":"code","e557869b":"code","5b2d0d2f":"code","7d9b983f":"code","a5a43412":"markdown"},"source":{"8cbfb72a":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","59b3c646":"import torch\nfrom torch.utils.data import DataLoader, Dataset","5f01ba32":"class my_dataset(Dataset):\n   \n    def __init__(self, res):        \n        self.res = res\n    \n    def __len__(self):\n        return N_ELEM\n    \n    def __getitem__(self, idx):\n        return torch.rand(3,self.res, self.res)","c6a56975":"N_ELEM = 64\nBATCH_SIZE = 16","3e17200f":"dataset_loader = DataLoader(my_dataset(256), \n                            batch_size=BATCH_SIZE,\n                            shuffle=False, \n                            num_workers=2)","d8a1830b":"%%time\nfor i_batch, sample in enumerate(dataset_loader):\n    sample = sample*2","e557869b":"dataset_loader = DataLoader(my_dataset(756), \n                            batch_size=BATCH_SIZE,\n                            shuffle=False,\n                            num_workers=2)","5b2d0d2f":"%%time\nfor i_batch, sample in enumerate(dataset_loader):\n    sample = sample*2","7d9b983f":"!df -h","a5a43412":"[https:\/\/github.com\/pytorch\/pytorch\/issues\/5040](https:\/\/github.com\/pytorch\/pytorch\/issues\/5040)"}}