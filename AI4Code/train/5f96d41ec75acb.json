{"cell_type":{"4c8b4feb":"code","6e2d9d4a":"code","e2056bb0":"code","12d490c0":"code","d50c5225":"code","b062841d":"code","3ed89856":"code","dededefd":"code","9474dccc":"code","a4ae0838":"code","83f1014f":"code","98295ce7":"code","237c26d6":"code","8e804ecf":"code","8c90d490":"code","d85c1f42":"code","57171ffc":"code","0015b0c8":"code","759dec07":"code","c5c23356":"code","70004ba8":"code","b0cacd2d":"code","37bc645e":"code","60ac0eef":"markdown","77e4dec6":"markdown","44a34e2b":"markdown","817604e2":"markdown","d9618eaf":"markdown","2a075aef":"markdown","1b55c0bb":"markdown","a00defe9":"markdown","e454dfc9":"markdown","ae9f268f":"markdown","94ee51f3":"markdown","a0aac45a":"markdown","2ace01c7":"markdown","4df6f576":"markdown","9f1c8893":"markdown","d5101f74":"markdown","1d50d02e":"markdown","6e73b287":"markdown","4728621a":"markdown","0545efee":"markdown"},"source":{"4c8b4feb":"import numpy as np\nimport pandas as pd","6e2d9d4a":"column_names = ['user_id', 'item_id', 'rating', 'timestamp']\ndf = pd.read_csv('..\/input\/u.csv', sep='\\t', names=column_names)","e2056bb0":"df.head()","12d490c0":"movie_titles = pd.read_csv(\"..\/input\/Movie_Id_Titles.csv\")\nmovie_titles.head()","d50c5225":"df = pd.merge(df,movie_titles,on='item_id')\ndf.head()","b062841d":"import matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set_style('white')\n%matplotlib inline","3ed89856":"df.groupby('title')['rating'].mean().sort_values(ascending=False).head()","dededefd":"df.groupby('title')['rating'].count().sort_values(ascending=False).head()","9474dccc":"ratings = pd.DataFrame(df.groupby('title')['rating'].mean())\nratings.head()","a4ae0838":"ratings['num of ratings'] = pd.DataFrame(df.groupby('title')['rating'].count())\nratings.head()","83f1014f":"plt.figure(figsize=(10,4))\nratings['num of ratings'].hist(bins=70)","98295ce7":"plt.figure(figsize=(10,4))\nratings['rating'].hist(bins=70)","237c26d6":"sns.jointplot(x='rating',y='num of ratings',data=ratings,alpha=0.5)","8e804ecf":"moviemat = df.pivot_table(index='user_id',columns='title',values='rating')\nmoviemat.head()","8c90d490":"ratings.sort_values('num of ratings',ascending=False).head(10)","d85c1f42":"ratings.head()","57171ffc":"starwars_user_ratings = moviemat['Star Wars (1977)']\ntoystory_user_ratings = moviemat['Toy Story (1995)']\nstarwars_user_ratings.head()","0015b0c8":"similar_to_starwars = moviemat.corrwith(starwars_user_ratings)\nsimilar_to_toystory = moviemat.corrwith(toystory_user_ratings)","759dec07":"corr_starwars = pd.DataFrame(similar_to_starwars,columns=['Correlation'])\ncorr_starwars.dropna(inplace=True)\ncorr_starwars.head()","c5c23356":"corr_starwars.sort_values('Correlation',ascending=False).head(10)","70004ba8":"corr_starwars = corr_starwars.join(ratings['num of ratings'])\ncorr_starwars.head()","b0cacd2d":"corr_starwars[corr_starwars['num of ratings']>200].sort_values('Correlation',ascending=False).head()","37bc645e":"corr_toystory = pd.DataFrame(similar_to_toystory,columns=['Correlation'])\ncorr_toystory.dropna(inplace=True)\ncorr_toystory = corr_toystory.join(ratings['num of ratings'])\ncorr_toystory[corr_toystory['num of ratings']>200].sort_values('Correlation',ascending=False).head()","60ac0eef":"Now the same for the comedy\/Animated Toy Story:","77e4dec6":"Now let's get the movie titles:","44a34e2b":"Let's choose two movies: starwars, a sci-fi movie. And Toy Storyr, a Comedy\/Animated.","817604e2":"Most rated movie:","d9618eaf":"## Recommending Similar Movies","2a075aef":"Now let's create a matrix that has the user ids on one access and the movie title on another axis. Each cell will then consist of the rating the user gave to that movie. Note there will be a lot of NaN values, because most people have not seen most of the movies.","1b55c0bb":"Now set the number of ratings column:","a00defe9":"We can then use corrwith() method to get correlations between two pandas series:","e454dfc9":"Now let's grab the user ratings for those two movies:","ae9f268f":"Now if we sort the dataframe by correlation, we should get the most similar movies, however note that we get some results that don't really make sense. This is because there are a lot of movies only watched once by users who also watched star wars (it was the most popular movie). ","94ee51f3":"\n# Recommender Systems with Python\n\nWelcome to the code notebook for Recommender Systems with Python. In this lecture we will develop basic recommendation systems using Python and pandas. There is another notebook: *Advanced Recommender Systems with Python*. That notebook goes into more detail with the same data set.\n\nIn this notebook, we will focus on providing a basic recommendation system by suggesting items that are most similar to a particular item, in this case, movies. Keep in mind, this is not a true robust recommendation system, to describe it more accurately,it just tells you what movies\/items are most similar to your movie choice.\n\nThere is no project for this topic, instead you have the option to work through the advanced lecture version of this notebook (totally optional!).\n\nLet's get started!\n\n## Import Libraries","a0aac45a":"Now a few histograms:","2ace01c7":"Now sort the values and notice how the titles make a lot more sense:","4df6f576":"We can merge them together:","9f1c8893":"Let's clean this by removing NaN values and using a DataFrame instead of a series:","d5101f74":"# EDA\n\nLet's explore the data a bit and get a look at some of the best rated movies.\n\n## Visualization Imports","1d50d02e":"Let's create a ratings dataframe with average rating and number of ratings:","6e73b287":"Let's fix this by filtering out movies that have less than 100 reviews (this value was chosen based off the histogram from earlier).","4728621a":"Okay! Now that we have a general idea of what the data looks like, let's move on to creating a simple recommendation system:","0545efee":"## Get the Data"}}