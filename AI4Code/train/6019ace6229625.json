{"cell_type":{"4cf457be":"code","6679bd72":"code","5875cf6d":"code","0be87d95":"code","05a8b0a0":"code","7f47718a":"code","78fbc116":"code","c8ce8fcc":"code","4c553eb6":"code","1fed6421":"code","0e42d25e":"code","5b64ef2b":"code","526f1cd0":"code","c5b0ad19":"code","7c552639":"code","fdd753a9":"code","c98354f1":"code","d2fe3d83":"code","4237ed86":"code","2083b98a":"code","57d54b9a":"code","43e45195":"code","56c139b9":"code","92b6b0f3":"code","d0dcd624":"code","0d39b56b":"code","9fb732e5":"code","115464e7":"code","44e6a9ea":"code","f98a67c7":"code","cffc122e":"code","b5b64cbe":"code","9f2ba071":"code","a3a292c0":"code","1d697f53":"code","19d5a3ea":"code","24037c7d":"code","119d18b2":"code","5b0b2b29":"code","d6870a3f":"code","95cc81ee":"markdown","41339b4f":"markdown","fb3f093a":"markdown","930ef62a":"markdown","0219e4dc":"markdown","cf2c5627":"markdown","9db7bf9b":"markdown","90c1213e":"markdown","4d2a7e59":"markdown","8588ff45":"markdown","fea32249":"markdown","03c10f63":"markdown","c9d322f5":"markdown","09ff2125":"markdown","833809fa":"markdown","61d53ab9":"markdown","e684d2a0":"markdown","78d2802a":"markdown","7fb10e5f":"markdown","8a245e02":"markdown","ba0924d5":"markdown"},"source":{"4cf457be":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport warnings\nwarnings.filterwarnings('ignore')","6679bd72":"from cycler import cycler\nimport matplotlib as mpl\n\nraw_light_palette = [\n    (0, 122, 255), # Blue\n    (255, 149, 0), # Orange\n    (52, 199, 89), # Green\n    (255, 59, 48), # Red\n    (175, 82, 222),# Purple\n    (255, 45, 85), # Pink\n    (88, 86, 214), # Indigo\n    (90, 200, 250),# Teal\n    (255, 204, 0)  # Yellow\n]\nraw_dark_palette = [\n    (10, 132, 255), # Blue\n    (255, 159, 10), # Orange\n    (48, 209, 88),  # Green\n    (255, 69, 58),  # Red\n    (191, 90, 242), # Purple\n    (94, 92, 230),  # Indigo\n    (255, 55, 95),  # Pink\n    (100, 210, 255),# Teal\n    (255, 214, 10)  # Yellow\n]\n\nraw_gray_light_palette = [\n    (142, 142, 147),# Gray\n    (174, 174, 178),# Gray (2)\n    (199, 199, 204),# Gray (3)\n    (209, 209, 214),# Gray (4)\n    (229, 229, 234),# Gray (5)\n    (242, 242, 247),# Gray (6)\n]\nraw_gray_dark_palette = [\n    (142, 142, 147),# Gray\n    (99, 99, 102),  # Gray (2)\n    (72, 72, 74),   # Gray (3)\n    (58, 58, 60),   # Gray (4)\n    (44, 44, 46),   # Gray (5)\n    (28, 28, 39),   # Gray (6)\n]\n\nlight_palette = np.array(raw_light_palette)\/255\ndark_palette = np.array(raw_dark_palette)\/255\ngray_light_palette = np.array(raw_gray_light_palette)\/255\ngray_dark_palette = np.array(raw_gray_dark_palette)\/255\n\nmpl.rcParams['axes.prop_cycle'] = cycler('color',dark_palette)\nmpl.rcParams['figure.facecolor']  = gray_dark_palette[-2]\nmpl.rcParams['figure.edgecolor']  = gray_dark_palette[-2]\nmpl.rcParams['axes.facecolor'] =  gray_dark_palette[-2]\n\nwhite_color = gray_light_palette[-2]\nmpl.rcParams['text.color'] = white_color\nmpl.rcParams['axes.labelcolor'] = white_color\nmpl.rcParams['axes.edgecolor'] = white_color\nmpl.rcParams['xtick.color'] = white_color\nmpl.rcParams['ytick.color'] = white_color\n\nmpl.rcParams['figure.dpi'] = 200\n\nmpl.rcParams['axes.spines.top'] = False\nmpl.rcParams['axes.spines.right'] = False","5875cf6d":"# Reading Data\ndata = pd.read_csv(r'..\/input\/weather-dataset-rattle-package\/weatherAUS.csv')","0be87d95":"data.head()","05a8b0a0":"data.shape","7f47718a":"data.dtypes","78fbc116":"data.nunique()","c8ce8fcc":"data.isnull().sum()","4c553eb6":"data.drop(['Evaporation','Sunshine','Cloud9am','Cloud3pm'],axis=1,inplace=True)","1fed6421":"data.isnull().sum()","0e42d25e":"data.describe()","5b64ef2b":"data['MinTemp'].fillna(data['MinTemp'].mean(),inplace=True)\ndata['MaxTemp'].fillna(data['MaxTemp'].mean(),inplace=True)\ndata['Rainfall'].fillna(data['Rainfall'].mean(),inplace=True)\ndata['WindGustSpeed'].fillna(data['WindGustSpeed'].mean(),inplace=True)\ndata['WindSpeed9am'].fillna(data['WindSpeed9am'].mean(),inplace=True)\ndata['WindSpeed3pm'].fillna(data['WindSpeed3pm'].mean(),inplace=True)\ndata['Humidity9am'].fillna(data['Humidity9am'].mean(),inplace=True)\ndata['Humidity3pm'].fillna(data['Humidity3pm'].mean(),inplace=True)\ndata['Pressure9am'].fillna(data['Pressure9am'].mean(),inplace=True)\ndata['Pressure3pm'].fillna(data['Pressure3pm'].mean(),inplace=True)\ndata['Temp9am'].fillna(data['Temp9am'].mean(),inplace=True)\ndata['Temp3pm'].fillna(data['Temp3pm'].mean(),inplace=True)","526f1cd0":"plt.figure(figsize=(18,9))\nplt.subplot(131)\nsns.countplot(x = 'WindGustDir',data=data)\nplt.xticks(rotation=45)\n\nplt.subplot(132)\nsns.countplot(x = 'WindDir9am',data=data)\nplt.xticks(rotation=45)\n\nplt.subplot(133)\nsns.countplot(x = 'WindDir3pm',data=data)\nplt.xticks(rotation=45)\n\nplt.show()","c5b0ad19":"print(data['WindGustDir'].mode(), data['WindDir9am'].mode(), data['WindDir3pm'].mode())","7c552639":"data['WindGustDir'].replace(np.nan,  'W',inplace=True)\ndata['WindDir9am'].replace(np.nan, 'N',inplace=True)\ndata['WindDir3pm'].replace(np.nan, 'SE',inplace=True) ","fdd753a9":"plt.figure(figsize=(14,7))\nplt.subplot(121)\nsns.countplot(x='RainToday',data=data)\n\nplt.subplot(122)\nsns.countplot(x='RainTomorrow',data=data)\nplt.show()","c98354f1":"data['RainToday'].replace(np.nan,  'Yes',inplace=True)\ndata['RainTomorrow'].replace(np.nan, 'Yes',inplace=True)","d2fe3d83":"data.isnull().sum()","4237ed86":"data['Date'] = pd.to_datetime(data['Date'])","2083b98a":"data['RainToday'] = data['RainToday'].map({'Yes':1,'No':0})\ndata['RainTomorrow'] = data['RainTomorrow'].map({'Yes':1,'No':0})","57d54b9a":"df_dateplot = data.iloc[-950:,:]\nplt.figure(figsize=[20,5])\nplt.plot(df_dateplot['Date'],df_dateplot['MinTemp'],color='blue',linewidth=1, label= 'MinTemp')\nplt.plot(df_dateplot['Date'],df_dateplot['MaxTemp'],color='red',linewidth=1, label= 'MaxTemp')\nplt.fill_between(df_dateplot['Date'],df_dateplot['MinTemp'],df_dateplot['MaxTemp'], facecolor = '#EBF78F')\nplt.title('MinTemp vs MaxTemp by Date')\nplt.legend(loc='lower left', frameon=False)\nplt.show()","43e45195":"df_dateplot = data.iloc[-950:,:]\nplt.figure(figsize=[20,5])\nplt.plot(df_dateplot['Date'],df_dateplot['Rainfall'],color='violet', linewidth=2, label= 'Rainfall')\nplt.legend(loc='upper left', frameon=False)\nplt.title('Rainfall by Date')\nplt.show()","56c139b9":"df_dateplot = data.iloc[-950:,:]\nplt.figure(figsize=[20,5])\nplt.plot(df_dateplot['Date'],df_dateplot['WindGustSpeed'],color='violet', linewidth=2, label= 'WindGustSpeed')\nplt.legend(loc='upper left', frameon=False)\nplt.title('WindGustSpeed by Date')\nplt.show()","92b6b0f3":"df_dateplot = data.iloc[-950:,:]\n\nplt.figure(figsize=[20,10])\nplt.subplot(211)\nplt.plot(df_dateplot['Date'],df_dateplot['WindSpeed9am'],color='blue', linewidth=2, label= 'WindSpeed9am')\nplt.legend(loc='upper left', frameon=False)\nplt.title('WindSpeed9am by Date')\n\nplt.subplot(212)\nplt.plot(df_dateplot['Date'],df_dateplot['WindSpeed3pm'],color='green', linewidth=2, label= 'WindSpeed3pm')\nplt.legend(loc='upper left', frameon=False)\nplt.title('WindSpeed3pm by Date')\nplt.show()","d0dcd624":"df_dateplot = data.iloc[-950:,:]\nplt.figure(figsize=[20,5])\nplt.plot(df_dateplot['Date'],df_dateplot['Humidity9am'],color='violet', linewidth=2, label= 'Humidity9am')\nplt.plot(df_dateplot['Date'],df_dateplot['Humidity3pm'],color='green', linewidth=2, label= 'Humidity3pm')\nplt.legend(loc='upper left', frameon=False)\nplt.title('Humidity9am vs Humidity3pm by Date')\nplt.show()","0d39b56b":"df_dateplot = data.iloc[-950:,:]\nplt.figure(figsize=[20,5])\nplt.plot(df_dateplot['Date'],df_dateplot['Pressure9am'],color='violet', linewidth=2, label= 'Pressure9am')\nplt.plot(df_dateplot['Date'],df_dateplot['Pressure3pm'],color='green', linewidth=2, label= 'Pressure3pm')\nplt.legend(loc='upper left', frameon=False)\nplt.title('Pressure9am vs Pressure3pm by Date')\nplt.show()","9fb732e5":"df_dateplot = data.iloc[-950:,:]\nplt.figure(figsize=[20,5])\nplt.plot(df_dateplot['Date'],df_dateplot['Temp9am'],color='blue', linewidth=2, label= 'Temp9am')\nplt.plot(df_dateplot['Date'],df_dateplot['Temp3pm'],color='red', linewidth=2, label= 'Temp3pm')\nplt.fill_between(df_dateplot['Date'],df_dateplot['Temp9am'],df_dateplot['Temp3pm'], facecolor = '#EBF78F')\nplt.legend(loc='lower left', frameon=False)\nplt.title('Temp9am vs Temp3pm by Date')\nplt.show()","115464e7":"data.dtypes","44e6a9ea":"from sklearn.preprocessing import LabelEncoder\nle = LabelEncoder()\nvar_mod = ['Date','Location','WindGustDir','WindDir9am','WindDir3pm']\nfor i in var_mod:\n    data[i] = le.fit_transform(data[i])","f98a67c7":"X = data.drop('RainTomorrow',axis=1)\ny = data['RainTomorrow']","cffc122e":"from sklearn.model_selection import train_test_split\nX_train,X_test, y_train, y_test = train_test_split(X, y, stratify=y, test_size=0.33)","b5b64cbe":"plt.figure(figsize=(14,14))\ncorr = X_train.corr()\nsns.heatmap(corr, annot=True, cmap=plt.cm.CMRmap_r)\nplt.show()","9f2ba071":"# with the following function we can select highly correlated features\n# it will remove the first feature that is correlated with anything other feature\n\ndef correlation(dataset, threshold):\n    col_corr = set()  # Set of all the names of correlated columns\n    corr_matrix = dataset.corr()\n    for i in range(len(corr_matrix.columns)):\n        for j in range(i):\n            if (corr_matrix.iloc[i, j]) > threshold: # we are interested in absolute coeff value\n                colname = corr_matrix.columns[i]  # getting the name of column\n                col_corr.add(colname)\n    return col_corr","a3a292c0":"corr_features = correlation(X_train,0.7)\nlen(set(corr_features))","1d697f53":"corr_features","19d5a3ea":"X_train.drop(corr_features,axis=1)\nX_test.drop(corr_features,axis=1)","24037c7d":"from sklearn.preprocessing import StandardScaler\nsc = StandardScaler()\nX_train = sc.fit_transform(X_train)\nX_test = sc.fit_transform(X_test)","119d18b2":"from xgboost import XGBClassifier\nxgb = XGBClassifier(max_depth=16,\n                    n_estimators=1000)\nxgb.fit(X_train,y_train)","5b0b2b29":"probs = xgb.predict_proba(X_test)[:,1]\npred = xgb.predict(X_test)","d6870a3f":"from sklearn.metrics import accuracy_score , classification_report, roc_auc_score\naccuracy = accuracy_score(y_test,pred)\nroc_auc = roc_auc_score(y_test,probs)\nprint(\"Accuracy = {}\".format(accuracy))\nprint(\"ROC score = {}\".format(roc_auc))\nprint(classification_report(y_test,pred))","95cc81ee":"*  As I mentioned in the above plots, that Dec-Jan are months when the temperature is high but these are the months when the difference between temperature around 9am and 3pm is less as compare to the months of Jun-Aug when the difference is high.","41339b4f":"### Model training","fb3f093a":"#### WindGustSpeed","930ef62a":"#### Data cleaning","0219e4dc":"#### Pressure9am and Pressure3am ","cf2c5627":"* Pressure is high around the months of Jun-Aug and around Dec-Jan you can see that the pressure is low.\n* In a low pressure area the rising air cools and this is likely to condense water vapour and form clouds, and consequently rain.","9db7bf9b":"* Splits data into train and test sets using **train_test_split**","90c1213e":"## Date Plot\n\nWe are going to plot features with datetime. Here, I am going to use date from last 3 years.\n\nRefrence: [https:\/\/www.kaggle.com\/siddheshera\/rain-in-australia-with-eda-h2o-88-4-auc](https:\/\/www.kaggle.com\/siddheshera\/rain-in-australia-with-eda-h2o-88-4-auc)","4d2a7e59":"#### Humidity9am and Humidity3pm","8588ff45":"#### MinTemp and MaxTemp","fea32249":"#### WindSpeed9am and WindSpeed3pm ","03c10f63":"* In Australia, wind speed is usually moderate. But, from above plot we can see that Dec-Feb is the windiest months.","c9d322f5":"#### Using Pearson Correlation","09ff2125":"* WindSpeed9am and WindSpeed3pm are relatively same around certain months.","833809fa":"* Above plot shows that the MinTemp and MaxTemp relatively increases and decreases every year.\n* The weather conditions are always opposite in the two hemispheres. As, the Australia is situated in the southern hemisphere. The seasons are bit different.\n* As you can see that, December to February is summer; March to May is autumn; June to August is winter; and September to November is spring.","61d53ab9":"* Being situated in southern hemisphere, the majority of rainfall occurs between December and March.\n* As you can see from above plot, we can see that Dec-Jan does get a lot of rainfall but there are months like Jun-Jul when rainfall occurs too.","e684d2a0":"#### Rainfall","78d2802a":"Converting Date into datetime and then splitting it into Day, Month and Year columns.","7fb10e5f":"droping features containing 50,000+ missing values.","8a245e02":"* From above plot we can see that the Humidity is high around Jun-Jul and also during that time, there is good difference between humidity around 9am and 3pm.","ba0924d5":"#### Temp9am and Temp3pm"}}