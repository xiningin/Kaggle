{"cell_type":{"f0eccabb":"code","d1ba3bda":"code","bf35455a":"code","afed4672":"code","68880f25":"code","814bd0d8":"code","37cb5ed7":"code","f5d25b9b":"code","4d99cf18":"code","ed22f861":"code","aaf2be54":"code","705e5452":"code","8811a4f5":"code","1cf72299":"markdown","c84ce504":"markdown","da5815ec":"markdown","261525f8":"markdown","c1bfa20d":"markdown","6f3d681d":"markdown","90020994":"markdown","e52f6eda":"markdown"},"source":{"f0eccabb":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport requests\nimport io\nfrom scipy.optimize import curve_fit\nfrom scipy.special import expit","d1ba3bda":"# Extract the update data\n\nBASE_URL = 'https:\/\/raw.githubusercontent.com\/CSSEGISandData\/COVID-19\/master\/csse_covid_19_data\/csse_covid_19_time_series\/'\nCONFIRMED = 'time_series_covid19_confirmed_global.csv'\nDEATH = 'time_series_covid19_deaths_global.csv'\nRECOVERED = 'time_series_covid19_recovered_global.csv'\nCONFIRMED_US = 'time_series_covid19_confirmed_US.csv'\nDEATH_US = 'time_series_covid19_deaths_US.csv'\n\ndef get_covid_data(subset = 'CONFIRMED'):\n    \"\"\"This function returns the latest available data subset of COVID-19. \n        The returned value is in pandas DataFrame type.\n    Args:\n        subset (:obj:`str`, optional): Any value out of 5 subsets of 'CONFIRMED',\n        'DEATH', 'RECOVERED', 'CONFIRMED_US' and 'DEATH_US' is a valid input. If the value\n        is not chosen or typed wrongly, CONFIRMED subet will be returned.\n    \"\"\"    \n    switcher =  {\n                'CONFIRMED'     : BASE_URL + CONFIRMED,\n                'DEATH'         : BASE_URL + DEATH,\n                'RECOVERED'     : BASE_URL + RECOVERED,\n                'CONFIRMED_US'  : BASE_URL + CONFIRMED_US,\n                'DEATH_US'      : BASE_URL + DEATH_US,\n                }\n\n    CSV_URL = switcher.get(subset, BASE_URL + CONFIRMED)\n\n    with requests.Session() as s:\n        download        = s.get(CSV_URL)\n        decoded_content = download.content.decode('utf-8')\n        data            = pd.read_csv(io.StringIO(decoded_content))\n\n    return data","bf35455a":"# Get US confirmed, death, and recovered data\nconfirmed = get_covid_data(subset = 'CONFIRMED')\ndeath = get_covid_data(subset = 'DEATH')\nrecovered = get_covid_data(subset = 'RECOVERED')\n\nconfirmed_US = confirmed[confirmed['Country\/Region']=='US']\ndeath_US = death[death['Country\/Region']=='US']\nrecovered_US = recovered[recovered['Country\/Region']=='US']","afed4672":"print(confirmed_US.shape)\nprint(death_US.shape)\nprint(recovered_US.shape)","68880f25":"confirmed_US.head()","814bd0d8":"# Visualization Data\nplt.plot(range(len(confirmed_US.columns)-4), confirmed_US.iloc[0,4:])\nplt.plot(range(len(death_US.columns)-4), death_US.iloc[0,4:])\nplt.plot(range(len(recovered_US.columns)-4), recovered_US.iloc[0,4:])\n\nUS =['confirmed_US', 'death_US', 'recovered_US']\nplt.legend(US)\nplt.title('Total Number of COVID-19 Cases in the United State')\nplt.xlabel('Day')\nplt.ylabel('Number of Cases')","37cb5ed7":"# dates -- Can be changed free\nd=2\n\ndf_confirmed_train = pd.DataFrame(confirmed_US.iloc[0,4:-d])\nprint('train', df_confirmed_train.shape)\nprint('train', type(df_confirmed_train))\n\ndf_confirmed_test = pd.DataFrame(confirmed_US.iloc[0,-d:])\nprint('test', df_confirmed_test.shape)\nprint('test', type(df_confirmed_test))\n","f5d25b9b":"x_data = range(len(df_confirmed_train))\nx_data","4d99cf18":"y_data = df_confirmed_train[225].values\ny_data","ed22f861":"All = pd.DataFrame(confirmed_US.iloc[0,4:])\nAll_x_data = range(len(All))\nAll_y_data = All[225].values","aaf2be54":"def log_curve(x, k, x_0, ymax):\n    return ymax \/ (1 + np.exp(-k*(x-x_0)))\n\n# Fit the curve\npopt, pcov = curve_fit(log_curve, x_data, y_data, bounds=([0,0,0],np.inf), maxfev=10000000)\nestimated_k, estimated_x_0, ymax= popt\n\n\n# Plot the fitted curve\nk = estimated_k\nx_0 = estimated_x_0\ny_fitted = log_curve(All_x_data, k, x_0, ymax)\nprint(k, x_0, ymax)\n#print(y_fitted)","705e5452":"fig = plt.figure()\nax = fig.add_subplot(111)\nax.plot(All_x_data, y_fitted, '--', label='fitted')\nax.plot(All_x_data, All_y_data, 'o', label='Confirmed Data')\nplt.legend()\nplt.title('Total Number of Confimed COVID-19 Cases in the United State')\nplt.xlabel('Day')\nplt.ylabel('Number of Cases')","8811a4f5":"#For predict the next two-day's confirmed case in US\npredict_set = range(len(All)+2)\ny_predict = log_curve(predict_set, k, x_0, ymax)\nprint('In next two days, we predict the total Confirmed Cases in US are: ',y_predict[-2:])","1cf72299":"If you guys have any interesting ideas and suggestions, please feel free to comment and contact with me.  \nEnjoy! And KEEP SAFE!","c84ce504":"# Preprocess data","da5815ec":"**Our model is based on the logistic curve to predict the Confirmed Cases of COVID-19 in the United Stated.**\n\n**Thank you Mehdi Afshari for extracting the updated data.**\n\n**Hope you enjoy our model.**","261525f8":"# Logistic Cureve Fitting","c1bfa20d":"# Explain","6f3d681d":"![covid19%20Fit.PNG](attachment:covid19%20Fit.PNG)","90020994":"**We run the dataset in both Jupyter notebook and Kaggle, but they gave us different prediction. In Kaggle, the implementation always gives us 'overflow warning', but in Jupyter notebook it is fine. Therefore, we suggest using Jupyter note to run our code, and it will provide us good prediction. The following picture is the fitting graph we got in Jupyter notebook**","e52f6eda":"# Extract Data"}}