{"cell_type":{"e94f81c7":"code","7037e527":"code","117c93d5":"code","58dbb138":"code","66e1f1b2":"code","0a704537":"code","a4bf2fd5":"code","5c41c39b":"code","304017de":"code","ef738ebd":"code","662b1655":"code","1e8d62dd":"code","b5108250":"code","a8b49adc":"code","ab17e2cc":"code","c64f9635":"markdown","3ff19b1a":"markdown","d5b2a67a":"markdown","b153bb1c":"markdown","8a345ebf":"markdown","e4ac0ba8":"markdown"},"source":{"e94f81c7":"import pandas as pd\nimport plotly\nimport plotly.graph_objects as go","7037e527":"gold = pd.read_csv('..\/input\/gold-reserves-by-country-quarterly\/gold_reserves_annual_quarterly_monthly.csv')\ngold","117c93d5":"russia_monthly = gold[(gold['Country Name']=='Russian Federation') & (gold['period'] == 'month')]\nrussia_monthly","58dbb138":"turkey_quarterly = gold[(gold['Country Name']=='Turkey') & (gold['period'] == 'quarter')]\nturkey_quarterly","66e1f1b2":"gold['Country Name'][gold['Country Name'].str.contains('china', case=False)].unique()","0a704537":"china_annual = gold[(gold['Country Name']=='China, P.R.: Mainland') & (gold['period'] == 'year')]\nchina_annual.head()","a4bf2fd5":"q209_q219 = gold[gold['Time Period'].isin(['2009Q2', '2019Q2'])]\nq209_q219","5c41c39b":"print('Top 10 Countries that changed gold reserves 2019Q2 vs. 2009Q1')\npivoted = (q209_q219\n           .pivot_table(index='Country Name', columns='Time Period', values='tonnes')\n           .assign(diff=lambda df: df['2019Q2']-df['2009Q2'])\n           .dropna()\n           .sort_values('diff', ascending=False))\nq2_top10 = pivoted.head(10).append(pivoted.tail(10))\n\nq2_top10.style.format(\"{:,.0f}\")","304017de":"fig = go.Figure()\nfig.add_bar(y=q2_top10.index[::-1], x=q2_top10['diff'][::-1], \n            orientation='h', marker={'color': (['red'] * 10) + (['green']*10)})\nfig.layout.height = 600\nfig.layout.xaxis.title = 'Tonnes'\nfig.layout.title = 'Top Gainers and Losers of Gold Reserves 2019-Q2 vs 2009-Q2'\n\nfig","ef738ebd":"def top_gainers_losers(df=gold, first_quarter='2009Q2', second_quarter='2019Q2', top_n=10):\n    df = df[df['Time Period'].isin([first_quarter, second_quarter])]\n    pivoted = (df\n               .pivot_table(index='Country Name', columns='Time Period', values='tonnes')\n               .assign(diff=lambda df: df.iloc[:, 1] - df.iloc[:, 0])\n               .dropna()\n               .sort_values('diff', ascending=False))\n    top10 = pivoted.head(top_n).append(pivoted.tail(top_n))\n    fig = go.Figure()\n    fig.add_bar(y=top10.index[::-1], x=top10['diff'][::-1], \n                orientation='h', marker={'color': (['red'] * 10) + (['green']*10)})\n    fig.layout.height = 600\n    fig.layout.xaxis.title = 'Tonnes'\n    fig.layout.title = 'Top Gainers and Losers of Gold Reserves ' + second_quarter + ' vs. ' + first_quarter\n\n    return fig","662b1655":"top_gainers_losers(df=gold, first_quarter='2005Q2', second_quarter='2007Q1')","1e8d62dd":"to_remove = ['Europe', 'CIS', 'Middle East, North Africa, Afghanistan, and Pakistan', 'Sub-Saharan Africa',\n             'Emerging and Developing Asia', 'Euro Area', 'Advanced Economies', 'World']","b5108250":"top_gainers_losers(df=gold[~gold['Country Name'].isin(to_remove)], first_quarter='2005Q2', second_quarter='2007Q1')","a8b49adc":"top_gainers_losers(df=gold[~gold['Country Name'].isin(to_remove)], first_quarter='2000Q1', second_quarter='2010Q1')","ab17e2cc":"top_gainers_losers(df=gold[~gold['Country Name'].isin(to_remove)], first_quarter='1990Q1', second_quarter='2000Q1')","c64f9635":"# Exploring Gold Reserves by Different Time Periods\n\nA quick overview of the IMF gold reserves dataset, which is available for all countries since 1950, on a monthly, quarterly, and annual basis.  \nSome regions are also included like \"world\" and \"Europe\", and several others exist.  \n\nI have an interactive [dashboard for analyzing gold reserves and trends](https:\/\/www.dashboardom.com\/gold-reserves) based on this dataset if you are interested.  \n","3ff19b1a":"### Compare the reserves in Q2 of 2019 vs Q2 of 2009 `q209_q219`","d5b2a67a":"It seems it works fine, but many \"countries\" are regions and groups of countries. Let's remove those.  \nWe first create a list of those regions, and remove them from our `df` in the function. ","b153bb1c":"Let's try how the function works with \"2005Q2\" and \"2007Q1\"","8a345ebf":"### Get the exact name of a country\nMany countries aren't listed with the typical name they are known for like \"China\", which is listed as \"China, P.R.: Mainland\". A simple way of find this out is to run a quick search for part of that string and get the available option(s): ","e4ac0ba8":"## Make it a function to visualize the top `n` gainers and losers in any two selected quarters"}}