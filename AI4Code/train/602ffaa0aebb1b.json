{"cell_type":{"98b5ef0b":"code","19d8e558":"code","99f8909c":"code","263f22ec":"code","a830815a":"code","deb85ae7":"code","fab7dba8":"code","241dfa21":"code","87c752a2":"code","a44272b2":"code","d46f14d2":"code","b525e5e4":"code","37e795ae":"code","96b41bba":"code","c9fc9f8d":"code","f842646e":"code","51c7750c":"code","a4a16295":"code","3cd66278":"code","0de1fc69":"markdown","504b9943":"markdown","913396b1":"markdown","b8f733f7":"markdown","f43a0430":"markdown"},"source":{"98b5ef0b":"import numpy as np \nimport pandas as pd \nimport matplotlib.pyplot as plt\nfrom sklearn.datasets import load_boston\nfrom sklearn.cross_validation import train_test_split\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.neighbors import KNeighborsRegressor\nfrom sklearn.metrics import r2_score, mean_squared_error, mean_absolute_error","19d8e558":"data = pd.read_csv(r\"D:\\housing_price_prediction\\train.csv\")\ndata.head(5)","99f8909c":"data.shape","263f22ec":"data.info()","a830815a":"data1=data.fillna('0')","deb85ae7":"data1.info()","fab7dba8":"plt.hist(data1['median_house_value'],color='blue')\nplt.show()","241dfa21":"data1=data1[data1['median_house_value']<500000]\ndata1.info()","87c752a2":"co=['longitude','latitude','housing_median_age','total_rooms','total_bedrooms','population','households','median_income']\n\n\nX=data1[co]\nY=data1.median_house_value","a44272b2":"x_train,x_test,y_train, y_test = train_test_split(X,Y,random_state=0,test_size=0.20)","d46f14d2":"print('Training Features Shape:', x_train.shape)\nprint('Training Target Shape:', y_train.shape)\nprint('Testing Features Shape:',x_test.shape )\nprint('Testing Target Shape:',y_test.shape)","b525e5e4":"ss_x = StandardScaler()\nx_train = ss_x.fit_transform(x_train)\nx_test = ss_x.transform(x_test)","37e795ae":"y_train=pd.DataFrame(y_train)\ny_test=pd.DataFrame(y_test)","96b41bba":"ss_y = StandardScaler()\ny_train = ss_y.fit_transform(y_train.values.reshape(-1, 1))\ny_test = ss_y.transform(y_test.values.reshape(-1, 1))","c9fc9f8d":"# \u4e24\u79cdk\u8fd1\u90bb\u56de\u5f52\u884c\u5b66\u4e60\u548c\u9884\u6d4b\n# \u521d\u59cb\u5316k\u8fd1\u90bb\u56de\u5f52\u6a21\u578b \u4f7f\u7528\u5e73\u5747\u56de\u5f52\u8fdb\u884c\u9884\u6d4b\nuni_knr = KNeighborsRegressor(weights=\"uniform\")\n# \u8bad\u7ec3\nuni_knr.fit(x_train, y_train)\n# \u9884\u6d4b\u4fdd\u5b58\u9884\u6d4b\u7ed3\u679c\nuni_knr_y_predict = uni_knr.predict(x_test)","f842646e":"uni_knr_y_predict","51c7750c":"# \u591a\u521d\u59cb\u5316k\u8fd1\u90bb\u56de\u5f52\u6a21\u578b \u4f7f\u7528\u8ddd\u79bb\u52a0\u6743\u56de\u5f52\ndis_knr = KNeighborsRegressor(weights=\"distance\")\n# \u8bad\u7ec3\ndis_knr.fit(x_train, y_train)\n# \u9884\u6d4b \u4fdd\u5b58\u9884\u6d4b\u7ed3\u679c\ndis_knr_y_predict = dis_knr.predict(x_test)","a4a16295":"dis_knr_y_predict","3cd66278":"# 5 \u6a21\u578b\u8bc4\u4f30\n\n# \u5e73\u5747k\u8fd1\u90bb\u56de\u5f52 \u6a21\u578b\u8bc4\u4f30\n\nprint(\"\u5e73\u5747k\u8fd1\u90bb\u56de\u5f52\u7684\u9ed8\u8ba4\u8bc4\u4f30\u503c\u4e3a\uff1a\", uni_knr.score(x_test, y_test))\n\nprint(\"\u5e73\u5747k\u8fd1\u90bb\u56de\u5f52\u7684R_squared\u503c\u4e3a\uff1a\", r2_score(y_test, uni_knr_y_predict))\n\nprint(\"\u5e73\u5747k\u8fd1\u90bb\u56de\u5f52\u7684\u5747\u65b9\u8bef\u5dee\u4e3a:\", mean_squared_error(ss_y.inverse_transform(y_test),\n\n                                           ss_y.inverse_transform(uni_knr_y_predict)))\n\nprint(\"\u5e73\u5747k\u8fd1\u90bb\u56de\u5f52 \u7684\u5e73\u5747\u7edd\u5bf9\u8bef\u5dee\u4e3a:\", mean_absolute_error(ss_y.inverse_transform(y_test),\n\n                                               ss_y.inverse_transform(uni_knr_y_predict)))\n\n# \u8ddd\u79bb\u52a0\u6743k\u8fd1\u90bb\u56de\u5f52 \u6a21\u578b\u8bc4\u4f30\n\nprint(\"\u8ddd\u79bb\u52a0\u6743k\u8fd1\u90bb\u56de\u5f52\u7684\u9ed8\u8ba4\u8bc4\u4f30\u503c\u4e3a\uff1a\", dis_knr.score(x_test, y_test))\n\nprint(\"\u8ddd\u79bb\u52a0\u6743k\u8fd1\u90bb\u56de\u5f52\u7684R_squared\u503c\u4e3a\uff1a\", r2_score(y_test, dis_knr_y_predict))\n\nprint(\"\u8ddd\u79bb\u52a0\u6743k\u8fd1\u90bb\u56de\u5f52\u7684\u5747\u65b9\u8bef\u5dee\u4e3a:\", mean_squared_error(ss_y.inverse_transform(y_test),\n\n                                             ss_y.inverse_transform(dis_knr_y_predict)))\n\nprint(\"\u8ddd\u79bb\u52a0\u6743k\u8fd1\u90bb\u56de\u5f52\u7684\u5e73\u5747\u7edd\u5bf9\u8bef\u5dee\u4e3a:\", mean_absolute_error(ss_y.inverse_transform(y_test),\n\n                                                ss_y.inverse_transform(dis_knr_y_predict)))","0de1fc69":"OK\uff0c\u8bad\u7ec3\u96c6\uff0c\u6d4b\u8bd5\u96c6\u5212\u5206\u5b8c\u6bd5","504b9943":"\u5176\u5728\u5206\u5e03\u53f3\u4fa7\u6709\u8f83\u957f\u7684\u5c3e\u90e8\uff0c\u6700\u540e\u7684\u4e00\u7ec4\u53ef\u80fd\u662f\u56e0\u4e3a\u5728\u7edf\u8ba1\u65f6\u5c06\u5927\u4e8e500000\u7684\u5206\u5230\u4e86\u4e00\u8d77\uff0c\u5220\u9664\u8fd9\u90e8\u5206","913396b1":"\u6807\u51c6\u5316\u5904\u7406","b8f733f7":"\u53d1\u73b0\u53ea\u6709 bedrooms\u8fd9\u4e00\u4e2a\u53d8\u91cf\u4e2d\u6709\u7f3a\u5931\u503c\uff0c\u5e76\u4e14\u7f3a\u5931\u503c\u4e0d\u591a\uff0c\u76f4\u63a5\u5254\u9664\u4e86\u8fd9\u90e8\u5206","f43a0430":"\u56e0\u4e3a\u6548\u679c\u4e0d\u597d\uff0c\u6700\u540e\u6ca1\u7528K\u8fd1\u90bb"}}