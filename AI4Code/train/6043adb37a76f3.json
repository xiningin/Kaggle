{"cell_type":{"fd90b28f":"code","5f80c8a5":"code","f8b4bc33":"code","1b68340d":"code","fef26073":"code","2a7bb780":"code","ce54b656":"code","28c7c983":"code","695057eb":"code","cd9a657f":"code","2f7bcc3c":"code","a61e1acb":"code","d5f7f9ca":"code","f674f827":"code","0460db90":"code","68faed0e":"code","01d2a80b":"code","f1a0a330":"code","45af1954":"code","e055fb17":"code","2b796d87":"code","eeb551c9":"code","0096fd46":"code","7c91298c":"code","e14de5c8":"code","7808d2fc":"code","c7a36f3c":"code","1ac6daf3":"code","d68a842a":"code","c3f9cf75":"code","56e80d26":"code","956a6ef4":"code","fe8b604a":"code","2a17f235":"code","ee5754b6":"code","b8fdef9a":"code","d7b6911b":"code","14948ad1":"code","420c09ac":"markdown","ab8c6aa8":"markdown","7b29f5de":"markdown","df970623":"markdown","dc3dfc76":"markdown"},"source":{"fd90b28f":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt","5f80c8a5":"# Data loading\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input\/'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","f8b4bc33":"df_train = pd.read_csv(\"\/kaggle\/input\/titanic\/train.csv\")\ndf_train.head()","1b68340d":"df_train.info()","fef26073":"df_train = df_train.drop([\"Name\" , \"Ticket\"] , axis = 1)","2a7bb780":"null_percentage = df_train.isnull().sum()\/df_train.isnull().count()\nnull_percentage","ce54b656":"df_train = df_train.drop(\"Cabin\" , axis = 1)","28c7c983":"df_train.isnull().sum()","695057eb":"df_train[\"Age\"] = df_train[\"Age\"].fillna(df_train[\"Age\"].mean())","cd9a657f":"df_train[\"Embarked\"] = df_train[\"Embarked\"].fillna(df_train[\"Embarked\"].mode()[0])","2f7bcc3c":"from sklearn.preprocessing import StandardScaler\nscaler = StandardScaler()","a61e1acb":"df_train[\"Age\"] = scaler.fit_transform(df_train[\"Age\"][:,np.newaxis])\ndf_train[\"Fare\"] = scaler.fit_transform(df_train[\"Fare\"][:,np.newaxis])\n","d5f7f9ca":"df_train","f674f827":"df_train.isnull().sum()","0460db90":"'''from sklearn.preprocessing import LabelEncoder\n\nencoder = LabelEncoder()\n\ndf_train[\"Embarked\"] = encoder.fit_transform(df_train[\"Embarked\"])\ndf_train[\"Sex\"] = encoder.fit_transform(df_train[\"Sex\"])\n'''","68faed0e":"categorical_columns = [\"Sex\" , \"Embarked\"]","01d2a80b":"dum_df_train = pd.get_dummies(df_train, columns = categorical_columns)","f1a0a330":"corre = dum_df_train.corr()\ncorre[\"Survived\"].sort_values(ascending = False)","45af1954":"x_train = dum_df_train.drop([\"Survived\"] , axis = 1)","e055fb17":"y_train = dum_df_train.loc[:,\"Survived\"]","2b796d87":"x_train","eeb551c9":"df_test = pd.read_csv(\"\/kaggle\/input\/titanic\/test.csv\")\ndf_test.head()","0096fd46":"df_test = df_test.drop([\"Name\" , \"Ticket\" , \"Cabin\" ] , axis = 1)","7c91298c":"df_test.isnull().sum()","e14de5c8":"df_test[\"Age\"] = df_test[\"Age\"].fillna(df_test[\"Age\"].mean())\ndf_test[\"Fare\"] = df_test[\"Fare\"].fillna(df_test[\"Fare\"].mean())","7808d2fc":"df_test[\"Age\"] = scaler.fit_transform(df_test[\"Age\"][:,np.newaxis])\ndf_test[\"Fare\"] = scaler.fit_transform(df_test[\"Fare\"][:,np.newaxis])\n","c7a36f3c":"df_test.isnull().sum()","1ac6daf3":"df_test","d68a842a":"'''from sklearn.preprocessing import LabelEncoder\n\nencoder = LabelEncoder()\n\ndf_test[\"Embarked\"] = encoder.fit_transform(df_test[\"Embarked\"])\ndf_test[\"Sex\"] = encoder.fit_transform(df_test[\"Sex\"])'''","c3f9cf75":"dum_df_test = pd.get_dummies(df_test, columns = categorical_columns)","56e80d26":"x_test = dum_df_test\nx_test","956a6ef4":"'''from sklearn.ensemble import RandomForestClassifier\n\nfrom sklearn.model_selection import GridSearchCV\n\nrf = RandomForestClassifier()\n\nparams_rf = {'n_estimators' : np.arange(1,100,10) }\n\nrf_gcv = GridSearchCV(rf , param_grid = params_rf)\n\n\nrf_gcv.fit(x_train , y_train)\n\nprint(\"Best n_estimators Value is \",rf_gcv.best_params_)\n\npredicted_value = rf_gcv.predict(x_test)'''","fe8b604a":"#predicted_value","2a17f235":"\n'''pred=pd.DataFrame(predicted_value)\nsub_df=pd.read_csv(r\"D:\\Study\\AI\\Personal_case_studies\\Titanic\\titanic_survival.csv\")\ndatasets=pd.concat([sub_df['PassengerId'],pred],axis=1)\ndatasets.columns=['PassengerId','Survived']\ndatasets.to_csv('titanic_survival.csv',index=False)'''","ee5754b6":"from xgboost import XGBClassifier\nfrom sklearn.model_selection import GridSearchCV","b8fdef9a":"xgb = XGBClassifier()\n\nparams_xgb = {'learning_rate':[0.0001,0.001,0.01,0.1,1],'n_estimators':np.arange(1,50,10),'max_depth':np.arange(1,10)}\n\nxgb_gcv = GridSearchCV(xgb , param_grid = params_xgb)\n\nxgb_gcv.fit(x_train,y_train)\n\nprint(\"Best parameters values are \",xgb_gcv.best_params_)\n\npredicted_value = xgb_gcv.predict(x_test)","d7b6911b":"predicted_value","14948ad1":"\npred=pd.DataFrame(predicted_value)\nsub_df=pd.read_csv(\"\/kaggle\/input\/titanic\/gender_submission.csv\")\ndatasets=pd.concat([sub_df['PassengerId'],pred],axis=1)\ndatasets.columns=['PassengerId','Survived']\n#datasets.to_csv('titanic_survival.csv',index=False)","420c09ac":"# Applying Algorithm","ab8c6aa8":"### Random Forest","7b29f5de":"# For train data","df970623":"# For test data","dc3dfc76":"### XG Boost"}}