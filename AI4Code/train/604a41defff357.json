{"cell_type":{"b904de0d":"code","54b4c4d5":"code","5130ad82":"code","2d16e75a":"code","296279b0":"code","bf7ed6e8":"code","26811ee3":"code","d01a0f0f":"code","6876401e":"code","aaff11f3":"code","738310a4":"code","2b78de2a":"code","2db14323":"markdown","1fa31c49":"markdown","cd1dee2f":"markdown"},"source":{"b904de0d":"import tensorflow as tf\nfrom tensorflow import keras\nfrom tensorflow import one_hot\nfrom tensorflow.keras.applications import xception\nfrom tensorflow.keras.preprocessing import image\nimport os\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport cv2","54b4c4d5":"import numpy as np\nimport pandas as pd \nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","5130ad82":"plant_seeds = os.listdir(\"\/kaggle\/input\/plant-seedlings-classification\/train\")\nplant_seeds","2d16e75a":"pretrained = xception.Xception(input_shape=[240,240, 3], include_top=False)","296279b0":"model = tf.keras.Sequential([\n    pretrained,\n    tf.keras.layers.GlobalAveragePooling2D(),\n    tf.keras.layers.Dense(100, activation=\"relu\"),\n    tf.keras.layers.BatchNormalization(trainable = True,axis=1),\n    \n    tf.keras.layers.Dropout(0.5),\n    \n    tf.keras.layers.Dense(50, activation=\"relu\"),\n    tf.keras.layers.BatchNormalization(trainable = True,axis=1),\n    \n    tf.keras.layers.Dense(12,activation='softmax')\n])","bf7ed6e8":"pretrained.trainable = True\nmodel.get_layer('xception').trainable","26811ee3":"model.summary()","d01a0f0f":"model.compile(optimizer=tf.keras.optimizers.Nadam(learning_rate=0.0006),\n              loss=tf.keras.losses.CategoricalCrossentropy(),\n              metrics=['accuracy'])","6876401e":"train_datagen = tf.keras.preprocessing.image.ImageDataGenerator(\n    rotation_range=20,\n    zoom_range=0.15,\n    width_shift_range=0.2,\n    height_shift_range=0.2,\n    shear_range=0.15,\n    horizontal_flip=True,\n    brightness_range=[0.4,1],\n    rescale=1.0\/255.0)","aaff11f3":"test_datagen = tf.keras.preprocessing.image.ImageDataGenerator(rescale=1.0\/255.0)\npath = \"\/kaggle\/input\/plant-seedlings-classification\/train\/\"","738310a4":"result = model.fit(train_datagen.flow_from_directory(path,\n                                        target_size=(240, 240), \n                                        color_mode='rgb', \n                                        class_mode='categorical', \n                                        batch_size=64, \n                                        shuffle=True),epochs=10,verbose=1)p","2b78de2a":"plt.plot(result.history['accuracy'], label='train', color = 'r')\nplt.plot(result.history['val_accuracy'], label='valid', color = 'g')\nplt.legend(loc='upper left')\nplt.title('Model accuracy')\nplt.ylabel('Accuracy')\nplt.xlabel('Epoch')\nplt.show()\nplt.plot(result.history['loss'], label='train', color = 'r')\nplt.plot(result.history['val_loss'], label='test', color = 'g')\nplt.legend(loc='upper right')\nplt.title('Model Loss')\nplt.ylabel('Loss')\nplt.xlabel('Epoch')\nplt.show()","2db14323":"**Using the pretrained model to update the weights so setting it as \"True\"**","1fa31c49":"**You are provided with a training set and a test set of images of plant seedlings at various stages of grown. Each image has a filename that is its unique id. The dataset comprises 12 plant species. The goal of the competition is to create a classifier capable of determining a plant's species from a photo. The list of species is as follows:**\n\nBlack-grass\n\nCharlock\n\nCleavers\n\nCommon Chickweed\n\nCommon wheat\n\nFat Hen\n\nLoose Silky-bent\n\nMaize\n\nScentless Mayweed\n\nShepherds Purse\n\nSmall-flowered Cranesbill\n\nSugar beet","cd1dee2f":"**Using Xception as our pretrained model**"}}