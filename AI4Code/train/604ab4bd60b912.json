{"cell_type":{"ddceca5e":"code","b4b33f6c":"code","767e6635":"code","97297cce":"code","f83accc8":"code","a9be7a15":"code","423a6ff3":"code","45edb24e":"code","de3d4ac3":"code","8acdaa38":"code","f9000c5f":"code","e2a08811":"markdown","ca16dc7e":"markdown","9c8d8cd6":"markdown","5b927d9c":"markdown","16748f91":"markdown","23a91fae":"markdown","05ac2154":"markdown","b70a05c8":"markdown","bce7eae8":"markdown","3e2602b4":"markdown"},"source":{"ddceca5e":"import numpy as np\nimport matplotlib.pyplot as plt\nimport plotly.graph_objects as go\nfrom sklearn.cluster import DBSCAN, KMeans","b4b33f6c":"import requests\nfrom PIL import Image\nfrom io import BytesIO\n\n# Image read\nr = requests.get(\"https:\/\/images.unsplash.com\/photo-1494783367193-149034c05e8f?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=500&q=80\")\nimg = Image.open(BytesIO(r.content))\n\n# Create Figure Object\nfig, ax = plt.subplots(1,1)\nax.imshow(img)\n\n# No ticks\nax.set_xticks([])\nax.set_yticks([])\n\nplt.tight_layout()\nplt.show()","767e6635":"data = np.asarray(img, dtype=\"int32\")\nprint(data.shape)","97297cce":"%%time\nfrom mpl_toolkits.mplot3d import Axes3D\n\n# x, y, z axis and Color\nx = data[:,:,0]\ny = data[:,:,1]\nz = data[:,:,2]\nC = list(map(tuple, data.reshape(data.shape[0]*data.shape[1], 3)\/255.0))\n\n\nfig = plt.figure(figsize=(20,10))\n\n# plot 1 : simple scatter plot\nax1 = fig.add_subplot(121,projection='3d')\nax1.scatter(x,y,z)\nax1.set_title('Scatter Plot')\n\n# plot 2 : colored scatter plot\nax2 = fig.add_subplot(122,projection='3d')\nax2.scatter(x,y,z,c=C)\nax2.set_title('Colored Scatter Plot')\n\nplt.tight_layout()\nplt.show()","f83accc8":"\nx = data[:,:,0] \ny = data[:,:,1]\nz = data[:,:,2]\nC = list(map(tuple, data.reshape(data.shape[0]*data.shape[1], 3)\/255.0))\n\nfig = go.Figure(data=[go.Scatter3d(\n    x=x.reshape(1,-1)[0],\n    y=y.reshape(1,-1)[0],\n    z=z.reshape(1,-1)[0],\n    mode='markers',\n    marker=dict(\n        size=3,\n        color=C,\n        opacity=0.7\n    )\n)])\n\nfig.show()","a9be7a15":"%%time\npoints = data.reshape(data.shape[0]*data.shape[1], 3)\/255.0\n\nkmeans = KMeans(n_clusters=6).fit(points)\nkmeans.labels_","423a6ff3":"%%time \n\nfig = plt.figure(figsize=(10,15))\nfor i in range(6):\n    ax = fig.add_subplot(3,2,i+1,projection='3d')\n    ax.set_xticks([])\n    ax.set_yticks([])\n    ax.set_zticks([])\n    C = list(map(tuple,points * (kmeans.labels_==i).reshape(-1,1)))\n    ax.scatter(x,y,z,c=C)\nplt.show()\n    ","45edb24e":"fig, ax = plt.subplots(1,2, figsize=(12,12))\nax[0].imshow(img)\n\n# No ticks\nax[0].set_xticks([])\nax[0].set_yticks([])\n\n# color palette with plt.Circle\nfor i in range(6):\n    circle = plt.Circle((0.05, (i+1.4)\/8), 0.04, color=(points * (kmeans.labels_==i).reshape(-1,1)).sum(axis=0) \/ sum((kmeans.labels_==i)))\n    ax[1].add_artist(circle)\n\n# make xy scale equal & axis off \nplt.gca().set_aspect('equal', adjustable='box')\nplt.axis('off')\n\nplt.tight_layout()\nplt.show()","de3d4ac3":"from skimage.color import rgb2hsv\n\ndata = rgb2hsv(img)\n\n\n# x, y, z axis and Color\nx = data[:,:,0]\ny = data[:,:,1]\nz = data[:,:,2]\n\nfig = plt.figure(figsize=(20,10))\n\n# plot 1 : simple scatter plot\nax1 = fig.add_subplot(121,projection='3d')\nax1.scatter(x,y,z)\nax1.set_title('Scatter Plot')\n\n# plot 2 : colored scatter plot\nax2 = fig.add_subplot(122,projection='3d')\nax2.scatter(x,y,z,c=C)\nax2.set_title('Colored Scatter Plot')\n\nplt.tight_layout()\nplt.show()","8acdaa38":"%%time\npoints2 = data.reshape(data.shape[0]*data.shape[1], 3)\n\nkmeans2 = KMeans(n_clusters=6).fit(points2)\n\nfig = plt.figure(figsize=(10,15))\nfor i in range(6):\n    ax = fig.add_subplot(3,2,i+1,projection='3d')\n    ax.set_xticks([])\n    ax.set_yticks([])\n    ax.set_zticks([])\n    C = list(map(tuple,points * (kmeans2.labels_==i).reshape(-1,1)))\n    ax.scatter(x,y,z,c=C)\n\nplt.tight_layout()    \nplt.show()","f9000c5f":"fig, ax = plt.subplots(1,2, figsize=(12,12))\nax[0].imshow(img)\n\n# No ticks\nax[0].set_xticks([])\nax[0].set_yticks([])\n\n# color palette with plt.Circle\nfor i in range(6):\n    circle = plt.Circle((0.05, (i+1.4)\/8), 0.04, color=(points * (kmeans2.labels_==i).reshape(-1,1)).sum(axis=0) \/ sum((kmeans2.labels_==i)))\n    ax[1].add_artist(circle)\n\n# make xy scale equal & axis off \nplt.gca().set_aspect('equal', adjustable='box')\nplt.axis('off')\n\nplt.tight_layout()\nplt.show()","e2a08811":"I can see that there is some division in the scatter plot.\n\nIn the picture, there are about **6 main colors**. So let's use **clustering** to break it down into a total of six.","ca16dc7e":"## 4. Clustering & Visualization","9c8d8cd6":"## Easy way to make Color Palette with ML\n\n![color palette](https:\/\/cf-images.us-east-1.prod.boltdns.net\/v1\/jit\/6057277746001\/63584937-f61a-4614-b5da-84f7e5aa0b6a\/main\/1280x720\/7s690ms\/match\/image.jpg)\n\n**Color palette** is one of the most important in visualization\n\nI like web design and data visualization, so I look up the color palette a lot.\n\nThis time, I will use clustering to create a color palette in machine learning.\n\n## 1. Import Libarary\n\nI will only call the most basic library.\n\n- `numpy` : processing data\n- `matplotlib` : plotting\n- `sklearn` : clustering","5b927d9c":"## + Convert RGB to HSV ","16748f91":"Let's look at the parts of the color separately.","23a91fae":"Convert image to numpy array by using `asarray`. (RGB)","05ac2154":"## 2. Read Image & Convert\n\nLet's get the image from [unsplash](https:\/\/unsplash.com\/).\n\nYou can crawl the image using `requests`.","b70a05c8":"For clustering, I will use **kmeans**, which is relatively straightforward and can be counted.\n\n1. data scaling\n2. clustering","bce7eae8":"## 3. Scatter Plot (RGB)\n\nLet's draw a three-dimensional scatter diagram with each axis in R, G, and B, using the RGB data converted from each point of the image.\n\nI will draw one without color and one by color.","3e2602b4":"## 5. Complete!!\n\nFinally, you can draw with a palette like this:"}}