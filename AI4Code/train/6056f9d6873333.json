{"cell_type":{"ccd41ade":"code","85bdeff6":"code","ec867a55":"code","62d8dc2a":"code","62d26f06":"code","6d88046a":"code","da58fe9a":"code","eb5f0bda":"code","69f8f140":"code","39fd088f":"code","a00dc1f7":"code","89f0716f":"code","ed2fab14":"code","dba06d2d":"code","2dff4a01":"code","c7dde7e3":"code","dfe79593":"code","a1e517ff":"code","f8cb40f1":"code","c34d3bae":"markdown","866749b2":"markdown","fc651fbb":"markdown","179be790":"markdown","37206d96":"markdown","b313449e":"markdown"},"source":{"ccd41ade":"import numpy as np \nimport pandas as pd\nimport seaborn as sns\nimport os\nimport matplotlib.pyplot as plt\nfrom fbprophet import Prophet\nimport seaborn as sns\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\ndf = pd.read_csv('..\/input\/hotel-booking-demand\/hotel_bookings.csv')\ndf.head()","85bdeff6":"df.columns","ec867a55":"df.hotel.value_counts()","62d8dc2a":"hoteltype=df.groupby(\"hotel\").is_canceled.count().reset_index()\nhoteltype.columns=[\"hotel\",\"count\"]\nsns.set(style=\"whitegrid\")\nax = sns.barplot(x=\"hotel\", y=\"count\", data=hoteltype)","62d26f06":"cancelp=df.groupby([\"hotel\",\"is_canceled\"]).lead_time.count().reset_index()\ncancelp.columns=[\"hotel\",\"is_canceled\",\"count\"]\nax = sns.barplot(x=\"hotel\", y=\"count\", hue=\"is_canceled\", data=cancelp)","6d88046a":"df[\"reservation_status_date\"]=pd.to_datetime(df[\"reservation_status_date\"])\nis_cancelled_plot=df.groupby(\"reservation_status_date\").is_canceled.sum().reset_index().sort_values(by=[\"reservation_status_date\"])\nis_cancelled_plot.head()","da58fe9a":"is_cancelled_plot.dtypes","eb5f0bda":"a4_dims = (11.7, 8.27)\nfig, ax = plt.subplots(figsize=a4_dims)\nsns.lineplot(ax=ax,x=\"reservation_status_date\", y=\"is_canceled\", data=is_cancelled_plot)","69f8f140":"is_cancelled_plot.tail()","39fd088f":"days = pd.date_range(\"2015-01-01\", \"2017-09-14\", freq='D')\nis_cancelled_fill=pd.DataFrame({\"reservation_status_date\":days})\nis_cancelled_fill=pd.merge(is_cancelled_plot[2:],is_cancelled_fill,on=\"reservation_status_date\", how=\"outer\")\nis_cancelled_fill=is_cancelled_fill.fillna(0)\nis_cancelled_fill.head()","a00dc1f7":"a4_dims = (11.7, 8.27)\nfig, ax = plt.subplots(figsize=a4_dims)\nsns.lineplot(ax=ax,x=\"reservation_status_date\", y=\"is_canceled\", data=is_cancelled_fill)","89f0716f":"AllindexOutlier=[]    \ndf_table = is_cancelled_fill[\"is_canceled\"].copy()\nQ1 = df_table.quantile(0.25)\nQ3 = df_table.quantile(0.75)\nIQR = Q3 - Q1\nlower_bound = Q1- 1.5*IQR\nupper_bound = Q3 + 1.5*IQR\nprint(\"lower bound is \" + str(lower_bound))\nprint(\"upper bound is \" + str(upper_bound))\nprint(Q1)\nprint(Q3)\noutliers_vector = (df_table < (lower_bound)) | (df_table > (upper_bound) )\noutliers_vector\noutliers = df_table[outliers_vector]\nlistOut=outliers.index.to_list()\nfor t in listOut:\n    AllindexOutlier.append(t)","ed2fab14":"AllindexOutlier[0:15]","dba06d2d":"for i in AllindexOutlier:\n    #I filled it with its average.\n    is_cancelled_fill.loc[i,\"is_canceled\"]=is_cancelled_fill.is_canceled.mean()","2dff4a01":"a4_dims = (11.7, 8.27)\nfig, ax = plt.subplots(figsize=a4_dims)\nsns.lineplot(ax=ax,x=\"reservation_status_date\", y=\"is_canceled\", data=is_cancelled_fill)","c7dde7e3":"# TEST- TRAIN SPLIT\ndef test_train_split(data, test_split,datecol):\n    test_train_ind = (data[datecol][data[datecol] < test_split].index.values,\n                      data[datecol][data[datecol] >= test_split].index.values)\n    data_train = data.iloc[test_train_ind[0],].reset_index(drop=True)\n    data_test = data.iloc[test_train_ind[1],].reset_index(drop=True)\n    return data_train, data_test","dfe79593":"is_cancelled_fill.columns=[\"ds\",\"y\"]\ndata_train,data_test=test_train_split(is_cancelled_fill, \"2017-01-01\",\"ds\")\ndata_test.head()","a1e517ff":"m = Prophet()\nm.fit(data_train)\nfuture = m.make_future_dataframe(periods=len(data_test))\nfuture.tail()\nforecast = m.predict(future)\nforecast[['ds', 'yhat', 'yhat_lower', 'yhat_upper']].tail()\ndata_test=pd.merge(data_test,forecast,on=\"ds\",how=\"inner\")","f8cb40f1":"plt.figure(figsize=(20,10))\nlines = plt.plot(data_test.ds, data_test.y, data_test.ds, data_test.yhat)\nplt.setp(lines[0], linewidth=2)\nplt.setp(lines[1], linewidth=2)\n\nplt.legend(('y', 'yhat'),\n           loc='upper right')\nplt.title('Prediction')\nplt.show()","c34d3bae":"### Analysis Dataset","866749b2":"*This will not stay here,I will go on, thanks...*","fc651fbb":"### Import Libs and Dataset","179be790":"**I want to predict is_canceled count.Firstly, I am starting  with outlier dedection.**","37206d96":"### Cancel Prediction wiht Facebook Prophet","b313449e":"### Outlier dedection"}}