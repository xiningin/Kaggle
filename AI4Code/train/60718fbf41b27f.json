{"cell_type":{"ace652ea":"code","4d1111d1":"code","1c2a71d9":"code","e39550af":"code","57557652":"code","e996fa85":"code","2f42f0e6":"code","efdf17eb":"code","cf26f4f0":"code","2306f10b":"code","329387a0":"code","0151dbcb":"code","56afff7a":"code","5673d2c9":"code","dade0590":"code","b1a33a87":"code","3a963bbd":"code","e3cb268c":"code","24752b03":"code","2adf96cb":"code","50ae0e87":"code","2c8e9828":"code","4564e1d5":"code","672ba354":"code","f652fe4a":"code","87f905b8":"code","5b719bf2":"code","b987eb29":"code","053261f2":"code","96e7e12c":"code","ef0220dd":"code","a2d946ce":"code","b452aeb4":"code","491b10cc":"code","a33a0075":"code","ff7dbfe0":"code","de40feb9":"code","307fcc18":"code","33d27c94":"code","003569b8":"code","218c571d":"code","3050071a":"code","24397f00":"code","e3208106":"code","5a902d8b":"code","6222c9e7":"code","d781f436":"code","558f4350":"code","d2217384":"code","e143ebe9":"code","7eb60cc5":"code","5aa6405e":"code","c24c04a1":"code","917f8612":"code","079c0e3f":"code","bab6e6dd":"code","fa783cf2":"code","ed179746":"code","6a8c9507":"code","a1f9e8a3":"code","3c4f5202":"code","cbfecbe9":"code","23fb0f73":"code","94f7264b":"code","fd4a1a27":"code","f2121644":"code","4517769b":"code","e78b6526":"code","ac01c186":"code","1868f562":"code","4c87b722":"code","3d5c2e33":"code","d21e63fc":"code","f0727b02":"code","6e16ce92":"code","57de6374":"code","a0552807":"code","675a4d75":"code","564025ee":"code","38a92c5a":"code","16900482":"code","fdaf0cde":"code","74fc28d3":"code","98066c2d":"code","bbae0551":"code","df0ee5f0":"code","a311b760":"code","18194ce0":"code","13dd27ad":"code","00206500":"code","04239ade":"markdown","614acf10":"markdown","0b84f154":"markdown","7b0e7f8e":"markdown","02fb8cb5":"markdown","a31c84e5":"markdown"},"source":{"ace652ea":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","4d1111d1":"import seaborn as sns\nimport matplotlib.pyplot as plt\nfrom sklearn.model_selection import train_test_split,StratifiedShuffleSplit\nfrom sklearn.preprocessing import StandardScaler,LabelEncoder\nfrom sklearn.metrics import classification_report,accuracy_score,precision_score,recall_score,confusion_matrix,f1_score,roc_auc_score,plot_roc_curve\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.naive_bayes import GaussianNB\nfrom statsmodels.stats.outliers_influence import variance_inflation_factor\nimport warnings\nwarnings.filterwarnings('ignore')","1c2a71d9":"df=pd.read_csv('\/kaggle\/input\/employee-attrition\/HR-Employee-Attrition.csv')","e39550af":"df.head()","57557652":"df.shape","e996fa85":"df.corr()","2f42f0e6":"lst=[]\nfor i in df.columns:\n    lst.append(i)\nprint(lst)\nlst.pop(1)\nlst\n    ","efdf17eb":"for i in lst:\n    plt.figure(figsize=(16,8))\n    sns.countplot(df[i],hue=df['Attrition'])    \n    plt.show()","cf26f4f0":"df.info()","2306f10b":"df['Age'].max()","329387a0":"lst1=[]\nlst2=[]\nlst3=[]\nlst4=[]\nlst5=[]\nfor i in df['Age']:\n    if i>=18 and i <28:\n        lst1.append(i)\n    elif i>=28 and i<36:\n        lst2.append(i)\n    elif i>=36 and i<42:\n        lst3.append(i)\n    elif i>=42 and i<50:\n        lst4.append(i)\n    else:\n        lst5.append(i)\nlst1=list(set(lst1))\nlst2=list(set(lst2))\nlst3=list(set(lst3))\nlst4=list(set(lst4))\nlst5=list(set(lst5))\ndf['Age']=df['Age'].replace(lst1,'18-28')\ndf['Age']=df['Age'].replace(lst2,'28-36')\ndf['Age']=df['Age'].replace(lst3,'36-42')\ndf['Age']=df['Age'].replace(lst4,'42-50')\ndf['Age']=df['Age'].replace(lst5,'>50')","0151dbcb":"df['Age'].unique()\n","56afff7a":"df['Attrition'].value_counts()","5673d2c9":"df['Attrition'].unique()","dade0590":"print(df['BusinessTravel'].value_counts())\nprint(df['BusinessTravel'].unique())","b1a33a87":"for i in df.columns:\n    if df[i].dtype !='int64':\n        print(i)","3a963bbd":"print(df['Department'].unique())\nprint(df['EducationField'].unique())","e3cb268c":"dict1={'Human Resources':'Other'}\ndf['EducationField']=df['EducationField'].replace('Human Resources','Other')","24752b03":"df['EducationField'].value_counts()\n","2adf96cb":"print(df['Gender'].unique())\nprint(df['Gender'].value_counts())","50ae0e87":"print(df['JobRole'].unique())\nprint(df['JobRole'].value_counts())","2c8e9828":"df['JobRole']=df['JobRole'].replace('Sales Representative','Sales Executive')","4564e1d5":"df.groupby(['JobRole','Attrition']).size()","672ba354":"df['MaritalStatus'].unique()","f652fe4a":"del df['Over18']","87f905b8":"df.groupby(['OverTime','Attrition']).Attrition.count()","5b719bf2":"numerical=df.select_dtypes(include=np.number).columns","b987eb29":"numerical","053261f2":"df['DistanceFromHome'].unique()\ndf['Education'].unique()\ndf.groupby(['Education','Attrition']).size()","96e7e12c":"del df['EmployeeCount']","ef0220dd":"\ndf.groupby(['EnvironmentSatisfaction','Attrition']).size()","a2d946ce":"df['JobInvolvement'].unique()\ndf.groupby(['JobInvolvement','Attrition']).size()","b452aeb4":"df['JobLevel'].unique()","491b10cc":"\ndf['JobSatisfaction'].unique()","a33a0075":"df['NumCompaniesWorked'].unique()\ndf['PercentSalaryHike'].unique()\ndf['PerformanceRating'].unique()\ndf['RelationshipSatisfaction'].unique()","ff7dbfe0":"df.groupby(['RelationshipSatisfaction','Attrition']).size()\ndf['StandardHours'].unique()","de40feb9":"del df['StandardHours']","307fcc18":"df['StockOptionLevel'].unique()\ndf['StockOptionLevel'].value_counts()\ndf['TrainingTimesLastYear'].unique()\ndf['WorkLifeBalance'].unique()\ndf['YearsAtCompany'].unique()","33d27c94":"lb=LabelEncoder()\ndf['PerformanceRating']=lb.fit_transform(df['PerformanceRating'])","003569b8":"categorical=df.select_dtypes(exclude=np.number).columns","218c571d":"categorical","3050071a":"df['OverTime'].unique()","24397f00":"cat1=pd.get_dummies(df['Age'],prefix='Age',drop_first=True)\ncat2=pd.get_dummies(df['BusinessTravel'],prefix='BusinessTravel',drop_first=True)\ncat3=pd.get_dummies(df['Department'],prefix='Department',drop_first=True)\ncat4=pd.get_dummies(df['EducationField'],prefix='EducationField',drop_first=True)\ncat5=pd.get_dummies(df['Gender'],prefix='Gender',drop_first=True)\ncat6=pd.get_dummies(df['JobRole'],prefix='JobRole',drop_first=True)\ncat7=pd.get_dummies(df['MaritalStatus'],prefix='MaritalStatus',drop_first=True)\ncat8=pd.get_dummies(df['OverTime'],prefix='OverTime',drop_first=True)","e3208106":"df.select_dtypes(include=np.number).columns","5a902d8b":"df_final=pd.concat([cat1,cat2,cat3,cat4,cat5,cat6,cat7,cat8,\n           df[['DailyRate', 'DistanceFromHome', 'Education',\n       'EnvironmentSatisfaction', 'HourlyRate', 'JobInvolvement', 'JobLevel',\n       'JobSatisfaction', 'MonthlyIncome', 'MonthlyRate', 'NumCompaniesWorked',\n       'PercentSalaryHike', 'PerformanceRating', 'RelationshipSatisfaction',\n       'StockOptionLevel', 'TotalWorkingYears', 'TrainingTimesLastYear',\n       'WorkLifeBalance', 'YearsAtCompany', 'YearsInCurrentRole',\n       'YearsSinceLastPromotion', 'YearsWithCurrManager','Attrition']]],axis=1)","6222c9e7":"df_final.shape","d781f436":"numerical1=df.select_dtypes(include=np.number)","558f4350":"vif=pd.DataFrame()\nvif['Feature']=numerical1.columns\nvif['Data']=[variance_inflation_factor(numerical1.values,i) for i in range(len(numerical1.columns))]","d2217384":"vif","e143ebe9":"df_final.columns","7eb60cc5":"df_final['Attrition']=np.where(df_final['Attrition']=='Yes',1,0)","5aa6405e":"X= df_final[['Age_28-36', 'Age_36-42', 'Age_42-50', 'Age_>50',\n       'BusinessTravel_Travel_Frequently', 'BusinessTravel_Travel_Rarely',\n       'Department_Research & Development', 'Department_Sales',\n       'EducationField_Marketing', 'EducationField_Medical',\n       'EducationField_Other', 'EducationField_Technical Degree',\n       'Gender_Male', 'JobRole_Human Resources',\n       'JobRole_Laboratory Technician', 'JobRole_Manager',\n       'JobRole_Manufacturing Director', 'JobRole_Research Director',\n       'JobRole_Research Scientist', 'JobRole_Sales Executive',\n       'MaritalStatus_Married', 'MaritalStatus_Single', 'OverTime_Yes',\n       'DailyRate', 'DistanceFromHome', 'Education', 'EnvironmentSatisfaction',\n       'HourlyRate', 'JobInvolvement', 'JobLevel', 'JobSatisfaction',\n       'MonthlyIncome', 'MonthlyRate', 'NumCompaniesWorked',\n       'PercentSalaryHike', 'PerformanceRating', 'RelationshipSatisfaction',\n       'StockOptionLevel', 'TotalWorkingYears', 'TrainingTimesLastYear',\n       'WorkLifeBalance', 'YearsAtCompany', 'YearsInCurrentRole',\n       'YearsSinceLastPromotion', 'YearsWithCurrManager']]\ny=df_final['Attrition']\n","c24c04a1":"train_x,test_x,train_y,test_y= train_test_split(X,y,test_size=0.3,random_state=123)","917f8612":"sm=StandardScaler()\ntrain_scaled=sm.fit_transform(train_x)\ntest_scaled=sm.fit_transform(test_x)","079c0e3f":"lm=LogisticRegression()","bab6e6dd":"lm.fit(train_scaled,train_y)\npred_train=lm.predict(train_scaled)\npred_test=lm.predict(test_scaled)","fa783cf2":"def metric_score(actual, pred):\n    print('confusion matrix: ', confusion_matrix(actual, pred))\n    print('accuracy score: ', accuracy_score(actual, pred))\n    print('recall_score: ', recall_score(actual, pred))\n    print('precision score: ', precision_score(actual, pred))\n    print('f1 score: ', f1_score(actual, pred))\n    print('roc auc score: ', roc_auc_score(actual, pred))\n    print('classification report : \\n', classification_report(actual, pred))","ed179746":"metric_score(train_y,pred_train)","6a8c9507":"metric_score(test_y,pred_test)","a1f9e8a3":"def KNN_predicts(train_x, test_x, train_y,test_y, scaler, neighbours, \n                 metric = 'manhattan', \n                 weights = 'uniform'):\n\n    train_scaled = scaler.fit_transform(train_x)\n    test_scaled = scaler.transform(test_x)\n\n    KNN = KNeighborsClassifier(n_neighbors= neighbours, metric = metric, \n                               weights = weights, n_jobs = -1)\n    KNN.fit(train_scaled, train_y)\n    prediction_train = KNN.predict(train_scaled)\n    prediction_test = KNN.predict(test_scaled)\n\n    print('Accuracy Train: ', accuracy_score(train_y, prediction_train))\n    print('Accuracy Test: ', accuracy_score(test_y, prediction_test))\n    print('-'*100)\n    return KNN","3c4f5202":"KNN_predicts(train_x, test_x, train_y,test_y, StandardScaler(),1)","cbfecbe9":"for k in range(1, 11):\n    print('Accuracy score on KNN using n_neighbors = {0}:'.format(k), end = ' ')\n    KNN_predicts(train_x, test_x, train_y,test_y,StandardScaler(), k)","23fb0f73":"k=5\nfor metric in ['euclidean','minkowski','manhattan','chebyshev']:\n    print('Accuracy score on KNN using {} metric and {} neighbors:'.format(metric,k), end = ' ')\n    KNN_predicts(train_x, test_x, train_y,test_y, StandardScaler(), k,metric)","94f7264b":"for weight in ['uniform','distance']:\n    print('Accuracy score on KNN using  neighbors {} weights: '.format(weight), end = ' ')\n    KNN_predicts(train_x, test_x, train_y,test_y, StandardScaler(), 5,'minkowski',weights=weight)","fd4a1a27":"plot_roc_curve(lm,train_scaled,train_y)","f2121644":"plot_roc_curve(lm,test_scaled,test_y)","4517769b":"import imblearn\nprint(imblearn.__version__)\nfrom imblearn.over_sampling import SMOTE\nfrom collections import Counter","e78b6526":"counter = Counter(train_y)\nprint(counter)","ac01c186":"counter = Counter(test_y)\nprint(counter)","1868f562":"from imblearn.combine import SMOTETomek\nss=StandardScaler()\nscaled_X=ss.fit_transform(X)\nsm = SMOTETomek(0.5, n_jobs=-1)\nX_Train, y_train = sm.fit_resample(scaled_X, y)\ntrain_x,test_x,train_y,test_y= train_test_split(X_Train,y_train,test_size=0.3,random_state=123)\n\n\nprint(f'The Number of class before the fit \\n {train_y.value_counts()}')\n\nprint(f'The Number of class after the fit \\n {y_train.value_counts()}')","4c87b722":"lm.fit(train_x,train_y)\npred_train=lm.predict(train_x)\npred_test=lm.predict(test_x)","3d5c2e33":"def metric_score(actual, pred):\n    print('confusion matrix: ', confusion_matrix(actual, pred))\n    print('accuracy score: ', accuracy_score(actual, pred))\n    print('recall_score: ', recall_score(actual, pred))\n    print('precision score: ', precision_score(actual, pred))\n    print('f1 score: ', f1_score(actual, pred))\n    print('roc auc score: ', roc_auc_score(actual, pred))\n    print('classification report : \\n', classification_report(actual, pred))","d21e63fc":"metric_score(train_y,pred_train)","f0727b02":"plot_roc_curve(lm,train_x,train_y)","6e16ce92":"metric_score(test_y,pred_test)","57de6374":"plot_roc_curve(lm,test_x,test_y)","a0552807":"def KNN_predict(X,y, neighbours, \n                 metric = 'manhattan', \n                 weights = 'uniform'):\n    ss=StandardScaler()\n    scaled_X=ss.fit_transform(X)\n    sm = SMOTETomek(0.5, n_jobs=-1)\n    X_Train, y_train = sm.fit_resample(scaled_X, y)\n    train_x,test_x,train_y,test_y= train_test_split(X_Train,y_train,test_size=0.3,random_state=123)\n\n    KNN = KNeighborsClassifier(n_neighbors= neighbours, metric = metric, \n                               weights = weights, n_jobs = -1)\n    KNN.fit(train_x, train_y)\n    prediction_train = KNN.predict(train_x)\n    prediction_test = KNN.predict(test_x)\n\n    print('Accuracy Train: ', accuracy_score(train_y, prediction_train))\n    print('Accuracy Test: ', accuracy_score(test_y, prediction_test))\n    print('-'*100)\n    return KNN","675a4d75":"KNN_predict(X,y,neighbours=1)","564025ee":"for k in range(1, 11):\n    print('Accuracy score on KNN using n_neighbors = {0}:'.format(k), end = ' ')\n    KNN_predict(X,y, neighbours=k)","38a92c5a":"k=6\nfor metric in ['euclidean','minkowski','manhattan','chebyshev']:\n    print('Accuracy score on KNN using {} metric and {} neighbors:'.format(metric,k), end = ' ')\n    KNN_predict(X,y, k,metric)","16900482":"for weight in ['uniform','distance']:\n    print('Accuracy score on KNN using  neighbors {} weights: '.format(weight), end = ' ')\n    KNN_predict(X,y, 6,'manhattan',weights=weight)","fdaf0cde":"ss=StandardScaler()\nscaled_X=ss.fit_transform(X)\nsm = SMOTETomek(0.5, n_jobs=-1)\nX_Train, y_train = sm.fit_resample(scaled_X, y)\ntrain_x,test_x,train_y,test_y= train_test_split(X_Train,y_train,test_size=0.3,random_state=123)\n\nKNN = KNeighborsClassifier(n_neighbors= 6, metric = 'manhattan', \n                           weights = 'uniform', n_jobs = -1)\nKNN.fit(train_x, train_y)\nprediction_train = KNN.predict(train_x)\nprediction_test = KNN.predict(test_x)","74fc28d3":"metric_score(train_y,prediction_train)","98066c2d":"metric_score(test_y,prediction_test)","bbae0551":"plot_roc_curve(KNN,train_x,train_y)","df0ee5f0":"plot_roc_curve(KNN,test_x,test_y)","a311b760":"gn= GaussianNB()","18194ce0":"gn.fit(train_x, train_y)\ntrain_pred=gn.predict(train_x)\ntest_pred=gn.predict(test_x)","13dd27ad":"metric_score(train_y,train_pred)","00206500":"metric_score(test_y,test_pred)","04239ade":"## Logistic Regression","614acf10":"## Handling imbalanced Dataset","0b84f154":"## KNN","7b0e7f8e":"## KNN","02fb8cb5":"## Guasian NB","a31c84e5":"## Conclusion \nBy handling the Unbiased data with SMOTE analysis and Logistic Regression\/KNN gives better result"}}