{"cell_type":{"86c9bf68":"code","f7462b55":"code","3d7d5022":"code","4c8cb421":"code","7166b078":"code","b1779835":"code","d6126f63":"code","bc2b7428":"code","38df1350":"code","8727ed73":"code","5fe0216f":"code","ac616d0c":"code","31b7b048":"code","4670f6a0":"code","b104ac0d":"code","870874f2":"code","da83728d":"code","e5337908":"code","5224482a":"code","1ac9daaa":"code","c71b62d8":"code","946c7983":"code","2a073806":"code","82778149":"code","e2bd9852":"code","1facae71":"code","afad2d36":"code","89e633d1":"code","ab15ec7d":"code","de27bcb9":"code","a747bd26":"code","c466e990":"markdown","0a3e8ac9":"markdown","e58b321c":"markdown","ea3f58cc":"markdown","fabe4e71":"markdown","acaf7410":"markdown","4a318c80":"markdown","7f8f3c66":"markdown","3b3ce696":"markdown","66174d90":"markdown","7abbf8f6":"markdown","348d4427":"markdown","52ef01b7":"markdown","26514a28":"markdown","bfbecd1e":"markdown","3e2a7a3a":"markdown","39c54f5c":"markdown"},"source":{"86c9bf68":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","f7462b55":"df=pd.read_csv(\"..\/input\/wine-reviews\/winemag-data_first150k.csv\")\ndf=df.iloc[:,1:]\ndf.head()","3d7d5022":"df.shape","4c8cb421":"df.info()","7166b078":"df.dtypes","b1779835":"df.describe().T","d6126f63":"def missing_value_table(df):\n    missing_value = df.isna().sum().sort_values(ascending=False)\n    missing_value_percent = 100 * df.isna().sum()\/\/len(df)\n    missing_value_table = pd.concat([missing_value, missing_value_percent], axis=1)\n    missing_value_table_return = missing_value_table.rename(columns = {0 : 'Missing Values', 1 : '% Value'})\n    cm = sns.light_palette(\"lightgreen\", as_cmap=True)\n    missing_value_table_return = missing_value_table_return.style.background_gradient(cmap=cm)\n    return missing_value_table_return\n  \nmissing_value_table(df)","bc2b7428":"df.region_2.unique().size","38df1350":"df.region_1.unique().size","8727ed73":"df.designation.unique().size","5fe0216f":"plt.figure(figsize=(15,6))\ndf.dtypes.value_counts().plot.barh();","ac616d0c":"fig,ax=plt.subplots(nrows=1,ncols=2,figsize=(15,7))\nsns.kdeplot(df[\"points\"],shade=True,ax=ax[0]);\nsns.kdeplot(df[\"price\"],shade=True,ax=ax[1]);","31b7b048":"sns.pairplot(df)\nsns.set(style=\"ticks\", color_codes=True)","4670f6a0":"corr = df.corr()\nplt.figure(figsize=(15,7))\nsns.heatmap(corr, annot=True);","b104ac0d":"country = df.country.value_counts()[:10]\nplt.figure(figsize=(15,7))\nsns.barplot(x=country.index, y=country.values, palette=\"dark\")\nplt.xticks(rotation='vertical')\nplt.ylabel('Frequency')\nplt.xlabel('Country')\nplt.title('top 10 countries',color = 'darkblue',fontsize=15);","870874f2":"f, ax = plt.subplots(figsize=(15,7))\nsns.despine(f, left=True, bottom=True)\n\nsns.scatterplot(x=\"points\", y=\"price\",\n                hue=\"price\",\n                palette=\"ch:r=-.2,d=.3_r\",\n                sizes=(1, 8), linewidth=0,\n                data=df, ax=ax);","da83728d":"num_data=pd.DataFrame(df.dtypes[df.dtypes!=\"object\"]).index","e5337908":"count = 0\nfig, ax =plt.subplots(nrows=1,ncols=2, figsize=(20,8))\nsns.boxplot(df[num_data[0]],ax=ax[0])\nsns.boxplot(df[num_data[1]],ax=ax[1]);","5224482a":"lower_and_upper = {}\n\nfor col in num_data:\n    q1 = df[col].quantile(0.25)\n    q3 = df[col].quantile(0.75)\n    iqr = 1.5*(q3-q1)\n    \n    lower_bound = q1-iqr\n    upper_bound = q3+iqr\n    \n    lower_and_upper[col] = (lower_bound, upper_bound)\n    df.loc[(df.loc[:,col]<lower_bound),col]=lower_bound*0.75\n    df.loc[(df.loc[:,col]>upper_bound),col]=upper_bound*1.25\n    \n    \nlower_and_upper","1ac9daaa":"count = 0\nfig, ax =plt.subplots(nrows=1,ncols=2, figsize=(20,8))\nsns.boxplot(df[num_data[0]],ax=ax[0])\nsns.boxplot(df[num_data[1]],ax=ax[1]);","c71b62d8":"import missingno as msno","946c7983":"df.isnull().sum()","2a073806":"msno.bar(df);","82778149":"msno.matrix(df);","e2bd9852":"msno.heatmap(df);","1facae71":"df[\"country\"].fillna(df[\"country\"].mode()[0],inplace=True)\ndf[\"province\"].fillna(df[df[\"country\"]==\"US\"][\"province\"].mode()[0],inplace=True)","afad2d36":"list_columns=[\"designation\",\"region_1\",\"region_2\",\"variety\",\"winery\"]\nfor i in df[list_columns]:\n    df[i].fillna(df[i].mode()[0],inplace=True)","89e633d1":"from sklearn.impute import KNNImputer","ab15ec7d":"knn_imputer=KNNImputer()\ndf[\"price\"]=knn_imputer.fit_transform(df[[\"price\"]])","de27bcb9":"msno.bar(df);","a747bd26":"df.isnull().sum()","c466e990":"## Target \nIn this dataset, price estimation based on some features.","0a3e8ac9":"# Wine Reviews Introduction","e58b321c":"# Load and Check Data","ea3f58cc":"# Outlier Data","fabe4e71":"![](https:\/\/253qv1sx4ey389p9wtpp9sj0-wpengine.netdna-ssl.com\/wp-content\/uploads\/2015\/01\/GettyImages-80992924-700x461.jpg)","acaf7410":"* float64(1): price.\n* int64(2): Unnamed: 0, points.\n* object(8): country, description, designation, province, region_1, region_2, variety, winery.\n* number of rows: 150.930\n* number of columns: 11","4a318c80":"# Variable Description","7f8f3c66":"## Content\n* Load and Check Data\n* Variable Description\n* Data Visualization\n* Outliers Detection\n* Missing Value Imputation\n* Missing Value Visualization\n- Fill Missing Value","3b3ce696":"In statistics, an outlier is a data point that differs significantly from other observations.\n\nOutlier is smaller than Q1-1.5(Q3-Q1) and higher than Q3+1.5(Q3-Q1) .\n\n(Q3-Q1) = IQR (INTER QUARTILE RANGE)\n\nQ3 = Third Quartile(%75)\nQ1 = First Quartile(%25)\ntrain and test separation","66174d90":"# Data Visualization\n","7abbf8f6":"* KNN imputation","348d4427":"## Context\n   After watching Somm (a documentary on master sommeliers) I wondered how I could create a predictive model to identify wines through blind tasting like a master sommelier would. The first step in this journey was gathering some data to train a model. I plan to use deep learning to predict the wine variety using words in the description\/review. The model still won't be able to taste the wine, but theoretically it could identify the wine based on a description that a sommelier could give. If anyone has any ideas on how to accomplish this, please post them!","52ef01b7":"* Mode Imputation","26514a28":"## Fill Missing Value","bfbecd1e":"1. country : The country that the wine is from.\n2. description : A few sentences from a sommelier describing the wine's taste, smell, look, feel, etc.\n3. designation : The vineyard within the winery where the grapes that made the wine are from.\n4. points : The number of points WineEnthusiast rated the wine on a scale of 1-100 (though they say they only post reviews for wines that score &gt;=80)\n5. price : The cost for a bottle of the wine.\n6. province : The province or state that the wine is from\n7. region_1 : The wine growing area in a province or state (ie Napa)\n8. region_2 : Sometimes there are more specific regions specified within a wine growing area (ie Rutherford inside the Napa Valley), but this value can sometimes be blank\n9. variety : The type of grapes used to make the wine (ie Pinot Noir)","3e2a7a3a":"# Missing Value","39c54f5c":"## Missing Value Visualization"}}