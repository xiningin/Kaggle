{"cell_type":{"0cbc32b4":"code","d5719dd2":"code","d1127f16":"code","b5c90415":"code","dd4d56ac":"code","4b595cdd":"code","8396cfd9":"code","36bd2560":"markdown","23c575f6":"markdown","c8eacc1b":"markdown","e790dcde":"markdown","baec95f4":"markdown"},"source":{"0cbc32b4":"#install the data commons package\n!pip install -U git+https:\/\/github.com\/google\/datacommons.git@stable-1.x","d5719dd2":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport datacommons as dc","d1127f16":"from kaggle_secrets import UserSecretsClient\nuser_secrets = UserSecretsClient()\ndcKey = user_secrets.get_secret(\"dcKey\")\ndc.set_api_key(dcKey)","b5c90415":"\ncity_dcids = dc.get_places_in(['country\/USA'], 'City')['country\/USA']\n#city_dcids = city_dcids[0:400]","dd4d56ac":"data = pd.DataFrame({'CityId': city_dcids})\n\ndata['PopId'] = dc.get_populations(data['CityId'],'Person')\ndata['population'] = dc.get_observations(data['PopId'], 'count','measuredValue','2017', measurement_method='CensusACS5yrSurvey')\n\n#only look at cities with populations of 100K+\ndata = data[data['population'] > 100000]\n\ndata['population'] = data['population'].astype(int)\n\n","4b595cdd":"# Create the Pandas DataFrame \n\ndata['median_age'] = dc.get_observations(data['PopId'], 'age','medianValue','2017', measurement_method='CensusACS5yrSurvey')\ndata['unemployment_rate'] = dc.get_observations(data['PopId'],'unemploymentRate','measuredValue','2017',observation_period='P1Y',measurement_method='BLSSeasonallyUnadjusted')\n\n# Get the name of each city\ndata['City'] = dc.get_property_values(data['CityId'], 'name')\ndata = data.explode('City')\n\n#Get the name of each state\ndata['State'] = dc.get_property_values(data['CityId'].str[:8], 'name')\ndata = data.explode('State')\n\ndata.index = data[['City','State']]\n\ndata['ObesityId'] = dc.get_populations(data['CityId'],'Person',constraining_properties={'age': 'Years18Onwards','healthBehavior': 'Obesity'})\ndata['obesity_rate'] = dc.get_observations(data['ObesityId'],'percent','measuredValue','2015','P1Y',measurement_method='CrudePrevalence')\n\ndata['ViolentCrimeId'] = dc.get_populations(data['CityId'],'CriminalActivities',constraining_properties={'crimeType': 'ViolentCrime'})\ndata['violent_crime_rate'] = round(dc.get_observations(data['ViolentCrimeId'],'count','measuredValue','2017','P1Y')\/data['population']*100,2)\n","8396cfd9":"CitySample = ['New York','Los Angeles','Chicago','Houston','Philadelphia','Austin','Denver','Seattle','San Francisco', 'Washington DC','Boston','Miami','Charleston']\ndata[data['City'].isin(CitySample)].sort_values(by='population',ascending=False)[['population','unemployment_rate','obesity_rate','violent_crime_rate']][:11]\n","36bd2560":"## Show data from Census Bureau, BLS, CDC and FBI\n\nThis section joins data from Census Bureau, Bureau of Labor Statistics, Center for Disease Control and Federal Bureau of investigations. Joining a dataset from any on of these additional sources took 1-2 lines of code.\n\nYou need a line you need to map city ID to the data source. The second line specifies the specific metric, frequency, date, aggregation method. \n","23c575f6":"## Pull a list of all cities in the US","c8eacc1b":"## Get your API key\n\nSlightly clunky. Need to sign up for a Google Cloud account. Here are instructions for getting an API key: http:\/\/docs.datacommons.org\/api\/setup.html\n\nYou can use insert the key using Add-on > Secrets in the file menu of this notebook","e790dcde":"## Get population by city\n\nI'm only look at cities with 100K+ populations to make processing faster","baec95f4":"## Show data from Census, BLS, CDC and FBI"}}