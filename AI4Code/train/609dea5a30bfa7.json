{"cell_type":{"dcff149a":"code","128b3fbc":"code","0222d990":"code","073d191b":"code","ed2c8653":"code","439bb424":"code","a9489662":"code","4c21da2f":"code","f905fd58":"code","e818568a":"code","54559033":"code","6957ccf8":"code","83e2002f":"code","95d6366b":"code","ee4db5fb":"code","ade6fceb":"code","c4eccd39":"code","1985ead3":"code","3a5339bf":"code","10a15dc6":"code","d771642e":"code","e7bf9b7f":"code","00bf0a2d":"code","37d1d102":"code","046e52e9":"code","151aa55c":"code","fb038234":"code","701f9d0a":"code","5370832d":"code","a4b3f672":"code","98079ea8":"code","219a7560":"code","0574813c":"code","81fa75a8":"code","08799b7d":"code","ac4d7ab2":"code","60fecdaf":"code","00d45572":"code","11ac8e25":"code","14d20b56":"code","f6fd966f":"code","fb9c734e":"code","e7289a6f":"code","316e25cf":"code","a930e800":"code","4886024f":"code","88dfa841":"code","58051b30":"code","c1b5adc3":"code","daf9f04f":"code","30424490":"markdown","62a90ae4":"markdown","ab76fd9c":"markdown","6395415f":"markdown"},"source":{"dcff149a":"# This is a movie recommendation system ","128b3fbc":"import numpy as np\nimport pandas as pd\nimport warnings\n","0222d990":"#helps us to ignore any warnings if we get any \nwarnings.filterwarnings('ignore')","073d191b":"\"\"\"here we will be using only two files that is u.data and u.info\"\"\"\ncolumn_name=[\"user_d\",\"item_id\",\"rating\",\"timstamp\"]\ndf=pd.read_csv(\"..\/input\/movielens-100k-dataset\/ml-100k\/u.data\",sep='\\t',names=column_name)\n# here the file is tab seperated file.","ed2c8653":"df.head()","439bb424":"df.shape","a9489662":"# see hoe many unique users and movies are there","4c21da2f":"df['user_d'].nunique()","f905fd58":"df['item_id'].nunique()","e818568a":"#npw to see which movie it is with the item-id, read the u.item file","54559033":"movies_name=pd.read_csv(\"..\/input\/movielens-100k-dataset\/ml-100k\/u.item\",sep='\\|',header=None)\nmovies_name","6957ccf8":"movies_name.shape","83e2002f":"movies_name=movies_name[[0,1]]","95d6366b":"movies_name.columns=['item_id','title']","ee4db5fb":"movies_name.head()","ade6fceb":"# now merge the 2 dataframes","c4eccd39":"data=pd.merge(df,movies_name,on='item_id')","1985ead3":"data","3a5339bf":"data.tail()","10a15dc6":"import matplotlib.pyplot as plt\nimport seaborn as sns\n#sns.set_style('white')","d771642e":"# find the avg rating for a movie\ndata.groupby('title').mean()","e7bf9b7f":"data.groupby('title').mean()['rating'].sort_values(ascending=False)","00bf0a2d":"data.groupby('title').count()['rating'].sort_values(ascending=False)","37d1d102":"ratings=pd.DataFrame(data.groupby('title').mean()['rating'])","046e52e9":"ratings['No of ratings']=data.groupby('title').count()['rating']","151aa55c":"ratings","fb038234":"ratings.sort_values(by='rating',ascending=False)","701f9d0a":"# we will have to remove the ratings with 5 star and have only 1 review","5370832d":"plt.figure(figsize=(10,7))\nplt.hist(ratings['No of ratings'],bins=70)\nplt.show()","a4b3f672":"plt.hist(ratings['rating'],bins=70)\nplt.show()","98079ea8":"sns.jointplot(x='rating' ,y='No of ratings' ,data=ratings,alpha=0.5)","219a7560":"#make a movie matrix","0574813c":"moviemat=data.pivot_table(index='user_d',columns='title',values='rating')\nmoviemat","81fa75a8":"#select any movie and check its user reviews","08799b7d":"starwaruser_ratings=moviemat['Star Wars (1977)']\nstarwaruser_ratings","ac4d7ab2":"#now check the correlation of this movie with the movie matrix","60fecdaf":"similar_to_starwars=moviemat.corrwith(starwaruser_ratings)\nsimilar_to_starwars","00d45572":"corr_starwars=pd.DataFrame(similar_to_starwars,columns=['Correlation'])\ncorr_starwars","11ac8e25":"#clean this data, like remove the nan values ","14d20b56":"corr_starwars.dropna(inplace=True)\ncorr_starwars","f6fd966f":"corr_starwars.sort_values('Correlation',ascending=False).head(n=10)\n#top 10 movies with highest corr","fb9c734e":"ratings","e7289a6f":"corr_starwars","316e25cf":"#join the no of ratings column with the corr_Starwars","a930e800":"corr_starwars=corr_starwars.join(ratings['No of ratings'])","4886024f":"corr_starwars","88dfa841":"corr_starwars[corr_starwars['No of ratings']>100].sort_values('Correlation',ascending=False)\n#the same movies are seen on google too","58051b30":"def predict_movies(movie_name):\n    movie_ratings=moviemat[movie_name]\n    similar_to_movie=moviemat.corrwith(movie_ratings)\n    \n    corr_movie=pd.DataFrame(similar_to_movie,columns=['Correlation'])\n    corr_movie.dropna(inplace=True)\n    \n    corr_movie=corr_movie.join(ratings['No of ratings'])\n    predictions=corr_movie[corr_movie['No of ratings']>100].sort_values('Correlation',ascending=False)\n    return predictions\n    ","c1b5adc3":"predictions=predict_movies(\"Titanic (1997)\")","daf9f04f":"predictions.head()","30424490":"## Predict Function","62a90ae4":"## Exploratry data analysis","ab76fd9c":"## Creating Movie Recommendation","6395415f":"## Dataset"}}