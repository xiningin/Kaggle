{"cell_type":{"33c13d10":"code","4b8184c8":"code","b9071944":"code","ad227bf4":"code","57e9de68":"code","d45beb8e":"code","bdf844a3":"code","bfa0a79f":"code","91363155":"code","bfa90477":"code","b24502d2":"code","4cab5614":"code","85a95e6f":"code","81e6d814":"code","fe2431e0":"markdown","341e104f":"markdown","c3229bee":"markdown","1e68edc5":"markdown","6bc06834":"markdown","d21770c0":"markdown","c0ca35f6":"markdown","b27c8cdf":"markdown","6b0f199d":"markdown","0df5d31d":"markdown"},"source":{"33c13d10":"import numpy as np\nimport pandas as pd\nfrom sklearn.svm import SVC\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.model_selection import GridSearchCV, train_test_split\nfrom sklearn.pipeline import make_pipeline","4b8184c8":"path = \"..\/input\/comprehensive-database-of-minerals\/Minerals_Database.csv\"\nminerals_df = pd.read_csv(path)","b9071944":"minerals_df.describe()","ad227bf4":"minerals_df.columns","57e9de68":"nonChemicalFormulaHeaders = [\"Unnamed: 0\", \"Name\", \"Crystal Structure\", \"Mohs Hardness\", \"Diaphaneity\", \"Specific Gravity\", \"Optical\", \"Refractive Index\",\n       \"Dispersion\"]\nX_ch = minerals_df.drop(columns=nonChemicalFormulaHeaders)\ny_ch = minerals_df[\"Crystal Structure\"]\nX_ch_train, X_ch_test, y_ch_train, y_ch_test = train_test_split(X_ch, y_ch, test_size=0.2, random_state=42)","d45beb8e":"scaler_ch = StandardScaler()\nscaler_ch.fit(X_ch_train)\nX_ch_train_scaled = scaler_ch.transform(X_ch_train, copy=True)","bdf844a3":"parameters = {'kernel':['rbf'], 'C':[0.01, 0.1, 1, 10, 100], 'gamma':[0.001, 0.01, 0.1, 1, 10, 100], 'class_weight':['balanced']}\nsvc_ch = SVC()\ngrid_ch = GridSearchCV(svc_ch, parameters)\ngrid_ch.fit(X_ch_train_scaled, y_ch_train)","bfa0a79f":"print(grid_ch.best_estimator_)\nprint(grid_ch.best_score_)","91363155":"X_ch_test_scaled = scaler_ch.transform(X_ch_test)\nresult_ch = grid_ch.best_estimator_.predict(X_ch_test_scaled)\nprint(\"accuracy: \", sum(result_ch == y_ch_test)\/len(y_ch_test))","bfa90477":"nonFeatureHeaders = [\"Unnamed: 0\", \"Name\", \"Crystal Structure\"]\nX_all = minerals_df.drop(columns=nonFeatureHeaders)\ny_all = minerals_df[\"Crystal Structure\"]\nX_all_train, X_all_test, y_all_train, y_all_test = train_test_split(X_all, y_all, test_size=0.2, random_state=42)","b24502d2":"scaler_all = StandardScaler()\nscaler_all.fit(X_all_train)\nX_all_train_scaled = scaler_all.transform(X_all_train, copy=True)","4cab5614":"parameters = {'kernel':['rbf'], 'C':[0.01, 0.1, 1, 10, 100], 'gamma':[0.001, 0.01, 0.1, 1, 10, 100], 'class_weight':['balanced']}\nsvc_all = SVC()\ngrid_all = GridSearchCV(svc_all, parameters)\ngrid_all.fit(X_all_train_scaled, y_all_train)","85a95e6f":"print(grid_all.best_estimator_)\nprint(grid_all.best_score_)","81e6d814":"X_all_test_scaled = scaler_all.transform(X_all_test)\nresult_all = grid_all.best_estimator_.predict(X_all_test_scaled)\nprint(\"accuracy: \", sum(result_all == y_all_test)\/len(y_all_test))","fe2431e0":"Validate on test set","341e104f":"## Version 2 all features","c3229bee":"## Version 1 Only the chemical formula","1e68edc5":"Scale data","6bc06834":"Scale data","d21770c0":"Find best SVM parameters","c0ca35f6":"Read data","b27c8cdf":"Validate on test set","6b0f199d":"Imports","0df5d31d":"Find best SVM parameters"}}