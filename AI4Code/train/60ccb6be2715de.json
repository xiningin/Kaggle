{"cell_type":{"281e8f97":"code","227ab054":"code","950feec4":"code","13a3a091":"code","7ec71fc4":"code","c5dd91b5":"code","d48f3608":"code","d8b9fcca":"code","818e6f92":"code","2e27168a":"code","c25b3624":"code","34363791":"code","877e69b7":"code","4a0f7cf1":"code","360fecd7":"code","95666a10":"code","247693d7":"code","60dff883":"code","a10b383e":"code","6cb1059f":"code","41814615":"code","61c87936":"code","cf1cd7d1":"code","56e58730":"code","9206ea87":"code","a634388c":"code","f97d5298":"code","a6c09d50":"code","d311c16e":"code","70510b42":"code","df69afd5":"code","af9c3eba":"code","5c54d161":"code","2849ccc4":"code","d9de4d94":"code","02217d3c":"code","ed8c65b5":"code","462a5f83":"markdown","fa8e13ea":"markdown","3aeddca9":"markdown","065c91c8":"markdown"},"source":{"281e8f97":"import tensorflow as tf\nfrom tensorflow import keras\nimport pandas as pd\nimport numpy as np\n%matplotlib inline\nimport matplotlib.pyplot as plt\nimport seaborn as sns","227ab054":"train = pd.read_csv('..\/input\/digit-recognizer\/train.csv')\ntrain.head()","950feec4":"test = pd.read_csv('..\/input\/digit-recognizer\/test.csv')\ntest.head()","13a3a091":"train.shape","7ec71fc4":"test.shape","c5dd91b5":"x = train.drop(['label'],axis=1)\nX = np.array(x).reshape(len(train),28*28) \/ 255\nX.shape","d48f3608":"y = train['label']\ny.shape","d8b9fcca":"x_test = np.array(test).reshape(len(test),28*28) \/ 255\nx_test.shape","818e6f92":"from sklearn.model_selection import train_test_split\nX_train, X_val, y_train, y_val = train_test_split(X,y,test_size=0.15,random_state=42)","2e27168a":"X_train.shape, y_train.shape","c25b3624":"X_val.shape, y_val.shape","34363791":"plt.imshow(X[2].reshape(28,28))","877e69b7":"y[0]","4a0f7cf1":"ann =keras.Sequential([\n     keras.layers.Dense(10, input_shape=(784,),activation='sigmoid')\n])\nann.compile(\n             optimizer='adam',\n             loss='sparse_categorical_crossentropy',\n             metrics=['accuracy'])\nann.fit(X_train,y_train,epochs=5)","360fecd7":"ann.evaluate(X_val,y_val)","95666a10":"y_predict = ann.predict(X_val)","247693d7":"y_predict","60dff883":"y_predicted_labels = [np.argmax(i) for i in y_predict]\ny_predicted_labels[0]","a10b383e":"cn = tf.math.confusion_matrix(y_val,y_predicted_labels)\nplt.figure(figsize=(8,6))\nsns.heatmap(cn,annot=True,fmt='d')\nplt.xlabel('Predicted')\nplt.ylabel('Truth')","6cb1059f":"ann_hidden =keras.Sequential([\n    keras.layers.Dense(100, input_shape=(784,), activation='relu'),\n    keras.layers.Dense(10,activation='sigmoid')\n])\nann_hidden.compile(\n             optimizer='adam',\n             loss='sparse_categorical_crossentropy',\n             metrics=['accuracy'])\nann_hidden.fit(X_train,y_train,epochs=5)","41814615":"ann_hidden.evaluate(X_val,y_val)","61c87936":"y_predict = ann_hidden.predict(X_val)\ny_predict","cf1cd7d1":"y_predicted_labels = [np.argmax(i) for i in y_predict]\ny_predicted_labels[2]","56e58730":"cn = tf.math.confusion_matrix(y_val,y_predicted_labels)\nplt.figure(figsize=(8,6))\nsns.heatmap(cn, annot=True, fmt='d')\nplt.xlabel('Predicted')\nplt.ylabel('Truth')","9206ea87":"ann_flat = keras.Sequential([\n           keras.layers.Flatten(input_shape=(28,28)),\n           keras.layers.Dense(100, activation='relu'),\n           keras.layers.Dense(10, activation='sigmoid')\n])\nann_flat.compile(\n             optimizer='adam',\n             loss='sparse_categorical_crossentropy',\n             metrics=['accuracy'])\nann_flat.fit(X_train,y_train,epochs=10)","a634388c":"ann_flat.evaluate(X_val,y_val)","f97d5298":"y_predict = ann_hidden.predict(x_test)\ny_predict","a6c09d50":"y_predicted_labels = [np.argmax(i) for i in y_predict]\ny_predicted_labels[2]","d311c16e":"cnn = keras.Sequential([\n    keras.layers.Conv2D(30, (3,3), activation='relu', input_shape=(28, 28, 1)),\n    keras.layers.MaxPooling2D((2,2)),\n \n    keras.layers.Flatten(),\n    keras.layers.Dense(100, activation='relu'),\n    keras.layers.Dense(10, activation='sigmoid')\n])","70510b42":"cnn.compile(\n             optimizer='adam',\n             loss='sparse_categorical_crossentropy',\n             metrics=['accuracy'])","df69afd5":"X_train = X_train.reshape(-1,28,28,1)\nX_train.shape","af9c3eba":"x_test = x_test.reshape(-1,28,28,1)\nx_test.shape","5c54d161":"cnn.fit(X_train, y_train, epochs=10)","2849ccc4":"y_predict_final = cnn.predict(x_test)","d9de4d94":"y_predicted_labels_final =[np.argmax(i) for i in y_predict_final]","02217d3c":"image_id = range(1, y_predict_final.shape[0] + 1)\nsubmissions = pd.DataFrame({'ImageId':image_id, 'Label':y_predicted_labels_final})\nsubmissions.to_csv('digit_recognizer_submission_final',index=False)","ed8c65b5":"submissions.head()","462a5f83":"## Simple neural network with no hidden layers","fa8e13ea":"## Using CNN","3aeddca9":"## Using hidden layer","065c91c8":"## Using Flatten Layer"}}