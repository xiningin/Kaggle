{"cell_type":{"01f4b13b":"code","3e4c0160":"code","7647a14b":"code","0a5f4c78":"code","c50be4e6":"code","071456df":"code","e75a151c":"code","187de403":"code","873c4f09":"code","ee9a7e42":"code","568b9257":"code","3426c679":"code","53ca0ba1":"code","cfe66518":"code","baa5dee5":"code","f6b16dd3":"code","9a2c3744":"code","98daaa5e":"code","8f852d51":"code","dc8a5429":"code","a5622c8f":"code","0a5a59bb":"code","8c7d3ce1":"code","2c573138":"code","9a7b4b6e":"code","3e54c75f":"code","15b61bef":"code","7b2a5003":"code","6b7384fd":"code","e8f097e0":"code","04a69ec3":"code","690d99ac":"code","bb994da2":"code","30fda91b":"code","0037ec4c":"code","0f64a963":"code","38c776fb":"code","1bf64870":"code","d26fa52a":"code","e3b1eccf":"code","da1decbe":"code","5aecc189":"code","a82affac":"code","bea44bae":"code","b7297377":"code","9bfb4642":"code","9ca66d2d":"code","6287da5b":"code","c30b1331":"code","8999d9fb":"code","cec145be":"code","b8af4937":"code","3c97abc1":"code","3c05cfd2":"code","574a39ad":"code","63300936":"code","33e9f3e8":"code","08d63c6d":"code","2182a47d":"code","68f4abc5":"code","0fa15dbb":"code","09e7058c":"code","c3f32b17":"code","cd879434":"code","63b23ccd":"code","525d8f67":"code","ebb5b3fa":"code","fe6fe7a8":"code","583bf433":"code","b369ebbd":"code","dd7f548e":"code","a2a3f62c":"code","75e8158e":"code","91f00d8e":"code","e9657281":"code","78012ac5":"code","585a1485":"code","6c03f7c6":"code","5b1627a5":"code","e8d05c38":"code","c274a5c1":"code","c8ff92ff":"code","725d5438":"code","0e8499e4":"code","e9b0d894":"code","2fec3dea":"code","363b2dc8":"code","10318c23":"code","6c03d894":"code","aef54b7a":"code","043c8059":"code","763f3790":"code","7a697730":"code","2460ff98":"code","4c9abc4f":"code","386abc99":"code","d202ef72":"code","942ae478":"code","69d6d2f9":"code","fcdfd08d":"code","a544caac":"code","73be38a1":"code","2b60931b":"code","c2463a64":"code","ae4a9e0f":"code","63868922":"code","dea7c6e3":"code","e2bbc7b6":"code","b7333fc1":"code","8bcd59d4":"code","f7dca33e":"code","65f0f54a":"code","4f9b54ca":"code","9f760cc0":"code","3ae15880":"code","a9465cec":"code","7416dfe5":"code","da27c6ac":"code","8a462c54":"code","6ac66fc1":"code","0c4c7a79":"code","753695b8":"code","d6f19c6e":"code","6d0115ff":"code","6ee7c112":"code","25b39410":"code","bfaaf10a":"code","65ee2c54":"code","ba98c493":"code","7b24aa65":"markdown","61ece8a1":"markdown","0304d13c":"markdown","232ff9e2":"markdown","66b72c5f":"markdown","0166a91f":"markdown","70d853be":"markdown","45f05592":"markdown","2c78f76c":"markdown","90ceda02":"markdown","35222607":"markdown","29154e74":"markdown","94b9cb64":"markdown","d7dd440a":"markdown","5d9891d1":"markdown","aa7dbd05":"markdown","d8e3dcb8":"markdown","e3bef348":"markdown","6012315f":"markdown","c91feb33":"markdown","8f3eaf5a":"markdown","77b69f5b":"markdown","3c604981":"markdown","61d2292e":"markdown","9faa5a71":"markdown","0301ceae":"markdown","54b58837":"markdown","db6b5adb":"markdown","f81af4f6":"markdown","bbf34961":"markdown","2f540b58":"markdown","84d73215":"markdown","e9b87bfd":"markdown","fdadcda1":"markdown","80b2a44e":"markdown","bdae38b3":"markdown","392d1d26":"markdown","be0245be":"markdown","311624f2":"markdown","5eaf9275":"markdown","8731e1d8":"markdown","beea20af":"markdown","c2b5204b":"markdown","6c84ee27":"markdown","f5386db3":"markdown","900c9fe3":"markdown","96c9290b":"markdown","df69ab4d":"markdown","3efd9ad8":"markdown","afdefe83":"markdown","7098aaa7":"markdown","95645fec":"markdown","464c21aa":"markdown","f1c852bc":"markdown","03a633d2":"markdown","f6160304":"markdown","bc7f4ea4":"markdown","dc9444d0":"markdown","0982121d":"markdown","cfa26966":"markdown","62f5fd3f":"markdown","152e5c08":"markdown","00edc10e":"markdown","9b5233d8":"markdown","c576c023":"markdown","91f87ea3":"markdown","103caa98":"markdown","71fc0a65":"markdown","9ca2d3cb":"markdown","943d1146":"markdown","5c64d6fa":"markdown","1a621ca5":"markdown","d1b09c5a":"markdown","ef401dec":"markdown","920f1936":"markdown","401514ad":"markdown","56bdc5c8":"markdown","d9989a23":"markdown","e99ad81c":"markdown","50565340":"markdown","22a79a73":"markdown","c368d80a":"markdown","db987ec8":"markdown","56dc5519":"markdown","e8023e8c":"markdown","d03f4c4b":"markdown","6a2ad23d":"markdown","b4bab76a":"markdown","c5b7a4a8":"markdown","4b26203c":"markdown","db645616":"markdown","275bc195":"markdown","f926baf4":"markdown","abe3ffb6":"markdown","f88dacf1":"markdown","73998282":"markdown","165d8539":"markdown","9a7b0b7b":"markdown","e4a649ac":"markdown","a2f909e8":"markdown","3a105e40":"markdown","79467cf1":"markdown","f52e920b":"markdown","dee20b2c":"markdown","c4958c85":"markdown"},"source":{"01f4b13b":"import os\nimport pandas as pd\nimport numpy as np\n\n#get rid of future warnings with seaborn\nimport warnings\nwarnings.simplefilter(action='ignore', category=FutureWarning)\n\n","3e4c0160":"# look at the file name\nnames = os.listdir('..\/input');\nnames","7647a14b":"#get the path to the file\nfor name in names:\n    if 'xlsx' in name:\n        path = '..\/input\/' + name\npath","0a5f4c78":"master = pd.read_excel('..\/input\/Bank_Personal_Loan_Modelling.xlsx', 'Data')","c50be4e6":"master.head()","071456df":"#for more convinient - reposition \"Personal Loan\"  column since it is our target column for research\na = master['Personal Loan']\nmaster.drop('Personal Loan', axis = 1, inplace = True)\nmaster['Personal Loan'] = a","e75a151c":"master.head(1)","187de403":"df = master.copy()\ndf.info()","873c4f09":"df.nunique()","ee9a7e42":"df.describe().transpose()","568b9257":"import matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set(color_codes = True)","3426c679":"#cols = ['Experience', 'Mortgage']\nfig, [ax0, ax1, ax2] = plt.subplots(1,3, figsize = (14,4))\n\nax0.hist(df.Mortgage)\nax0.set_xlabel('Mortgage distribution')\nax0.axvline(df.Mortgage.mean(), color = \"black\")\n\nax1.hist(df.Experience)\nax1.set_xlabel('Experience distribution')\nax1.axvline(0, color = \"black\");\n\nax2.hist(df.Income)\nax2.set_xlabel('Income distribution')\nax2.axvline(df.Income.mean(), color = \"black\");","53ca0ba1":"df[['ID','ZIP Code']] = df[['ID','ZIP Code']].astype('str')","cfe66518":"\ndf[['ID', 'ZIP Code']].dtypes","baa5dee5":"#check the ammount of negative values\ndf[df['Experience'] < 0]['Experience'].value_counts()","f6b16dd3":"ncol = ['Age', 'Income','CCAvg', 'Mortgage']\ngrid = sns.PairGrid(df, y_vars = 'Experience', x_vars = ncol, height = 4)\ngrid.map(sns.regplot);","9a2c3744":"df[df['Experience'] < 0]['Age'].value_counts()","98daaa5e":"ages = df[df['Experience'] < 0]['Age'].unique().tolist()\nages","8f852d51":"indexes = df[df['Experience'] < 0].index.tolist()","dc8a5429":"for i in indexes:\n    for x in ages:\n        df.loc[i,'Experience'] = df[(df.Age == x) & (df.Experience > 0)].Experience.mean()","a5622c8f":"df[df['Experience'] < 0]['Age'].value_counts()","0a5a59bb":"df.Experience.describe()","8c7d3ce1":"df.to_csv('df.csv', index = False)","2c573138":"quant_df = df[['Personal Loan', 'Age', 'Income', 'CCAvg', 'Mortgage']].copy()","9a7b4b6e":"quant_df.corr()","3e54c75f":"cmap = sns.diverging_palette(250, 10, as_cmap=True)\nsns.heatmap(quant_df.corr(), cmap = cmap, annot = True);","15b61bef":"# get association coefficients for 'Personal Loan' and exclude it's data from series\nquant_df.corr()['Personal Loan'][1:]","7b2a5003":"quant_df.corr()['Personal Loan'][1:].plot.bar();","6b7384fd":"import statsmodels.api as sm","e8f097e0":"quant_df['intercept'] = 1\nlog_mod = sm.Logit(quant_df['Personal Loan'], quant_df[['intercept', 'Age', 'Income', 'CCAvg', 'Mortgage']]).fit()","04a69ec3":"log_mod.summary()","690d99ac":"# exclude 'intercept'\nlog_mod.pvalues[1:5].plot.bar()\nplt.axhline(y = 0.05);","bb994da2":"# exclude 'intercept'\nlog_mod.params[1:5].plot.bar();","30fda91b":"quant_df_main = {}\nfor i in log_mod.params[1:5].to_dict().keys():\n    if log_mod.pvalues[i] < 0.05:\n        quant_df_main[i] = log_mod.params[i]\n    else:\n        continue","0037ec4c":"quant_df_main","0f64a963":"quant_df_main_odds = {k : np.exp(v) for k, v in quant_df_main.items()}","38c776fb":"quant_df_main_odds","1bf64870":"cat_df = df[['ZIP Code', 'Family', 'Education', 'Personal Loan']].copy()","d26fa52a":"cat_df.corr()","e3b1eccf":"cat_df.corr()['Personal Loan'][0:2]","da1decbe":"cat_df.corr()['Personal Loan'][0:2].plot.bar();","5aecc189":"cat_df['intercept'] = 1\nlog_mod = sm.Logit(cat_df['Personal Loan'], cat_df[['intercept', 'Family', 'Education']]).fit()","a82affac":"log_mod.summary()","bea44bae":"# exclude 'intercept'\nlog_mod.params[1:3].plot.bar();","b7297377":"cat_df_main = {}\nfor i in log_mod.params[1:3].to_dict().keys():\n    if log_mod.pvalues[i] < 0.05:\n        cat_df_main[i] = log_mod.params[i]\n    else:\n        continue","9bfb4642":"cat_df_main","9ca66d2d":"cat_df_odds = {k : np.exp(v) for k, v in cat_df_main.items()}","6287da5b":"cat_df_odds","c30b1331":"cat_df.head()","8999d9fb":"zip_df = cat_df[['Personal Loan', 'intercept','ZIP Code']].copy()","cec145be":"zip_df.head(2)","b8af4937":"zip_df['ZIP Code'].nunique()","3c97abc1":"zip_df['ZIP Code'].str[0:3].nunique()","3c05cfd2":"zip_df['ZIP Code'].str[0:2].nunique()","574a39ad":"zip_df['ZIP Code'].str[0:2].value_counts()","63300936":"dum_zip_df = zip_df.copy()","33e9f3e8":"dum_zip_df['ZIP Code'] = dum_zip_df['ZIP Code'].str[0:2]","08d63c6d":"dum_zip_df.head(2)","2182a47d":"dum_zip_df = pd.get_dummies(dum_zip_df, prefix = \"Z\", drop_first = True)","68f4abc5":"dum_zip_df.head(2)","0fa15dbb":"#exclude 'Personal Loan' from independ vars\ndum_zip_df_columns = dum_zip_df.columns.drop('Personal Loan').tolist()","09e7058c":"log_mod = sm.Logit(dum_zip_df['Personal Loan'], dum_zip_df[dum_zip_df_columns]).fit()","c3f32b17":"log_mod.summary()","cd879434":"bin_df = df[['Personal Loan', 'Securities Account', 'CD Account', 'Online', 'CreditCard']].copy()","63b23ccd":"bin_df.head()","525d8f67":"bin_df.corr()['Personal Loan']","ebb5b3fa":"bin_df.corr()['Personal Loan'][1:].plot.bar();","fe6fe7a8":"bin_df['intercept'] = 1\nbin_df_colmn = bin_df.columns.drop('Personal Loan').tolist()\nlog_mod = sm.Logit(bin_df['Personal Loan'], bin_df[bin_df_colmn]).fit()","583bf433":"log_mod.summary()","b369ebbd":"log_mod = sm.Logit(bin_df['Personal Loan'], bin_df[['intercept', 'CD Account']]).fit()","dd7f548e":"log_mod.summary()","a2a3f62c":"bin_odds = {'CD Account' : np.exp(log_mod.params[1])}","75e8158e":"bin_odds","91f00d8e":"df = pd.read_csv ('df.csv')","e9657281":"df.head(1)","78012ac5":"exp_df = df[['Income', 'CCAvg', 'Family', 'Education', 'CD Account', 'Personal Loan']].copy()","585a1485":"exp_df.head(2)","6c03f7c6":"exp_df['intercept'] = 1","5b1627a5":"log_mod = sm.Logit(exp_df['Personal Loan'], exp_df[['intercept','Income', 'CCAvg', 'Family', 'Education', 'CD Account']]).fit()","e8d05c38":"log_mod.pvalues[1:]","c274a5c1":"odds = np.exp(log_mod.params)","c8ff92ff":"odds","725d5438":"odds_df = pd.DataFrame(odds[1:], columns = [\"Odds\"])","0e8499e4":"odds_df['odds_increment'] = odds_df.Odds","e9b0d894":"odds_df.sort_values('Odds', ascending = False)","2fec3dea":"sizes = odds_df.Odds.tolist()# list of sizes of slices\nlabels = odds_df.index.tolist() # list of labels \nexplode = (0.15, 0.1, 0.2, 0.1, 0)  # \"explode\" the 2nd and 3rd slices  \nfig = plt.figure(figsize=(10, 5))\nplt.suptitle('The Proportion of Strength of Association  Between  \\n Personal Loan and Main Characteristics', \\\n          fontsize = 14, y = 1.18)\nplt.axis('equal'); # set aspect ration as equal to make sure the pie is drawn as a circle\nplt.pie(sizes, labels = labels, explode = explode, radius = 1.5, \\\n        shadow = True, startangle = 90,autopct= '%1.1f%%')\n\nplt.savefig('proportion_of_stregth_of_association.png', bbox_inches = 'tight');","363b2dc8":"series_cd = exp_df[exp_df['Personal Loan'] == 1]['CD Account'].value_counts()\nseries_cd","10318c23":"series_cdd = exp_df[exp_df['Personal Loan'] == 0]['CD Account'].value_counts()\nseries_cdd","6c03d894":"pd.DataFrame(dict( NO_PL= series_cdd, PL= series_cd,)).plot.bar(figsize = (8,6))\nplt.ylabel('Frequency')\nplt.xticks(np.arange(2),('No CD Account','CD Account'), rotation = 'horizontal')\nplt.legend(('NO Personal Loan', 'Personal Loan'));\nplt.title('Distribution of \"Personal Loan\" Values \\n among Groups of \"CD Account\" Values', fontsize = 14, y = 1.05);\nplt.savefig('distribution_of_PL_among_CDacc.png', bbox_inches = 'tight')","aef54b7a":"series = exp_df[exp_df['CD Account'] == 1]['Personal Loan'].value_counts()","043c8059":"plt.axis('equal')\nplt.title('Proportion of Customers Who Have Personal Loan and Who Don\\'t,\\n among CD Account Holders', \\\n          fontsize = 14, y = 1.2)\nlabels = ['NO Personal Loan','Personal Loan']\nplt.pie(series, labels = labels,autopct= '%1.1f%%', shadow = True,explode = (0.1, 0), radius = 1.6, startangle = 90)\nplt.savefig('Proportion_of_loanees_among_depositees.png', bbox_inches = 'tight');","763f3790":"series_ed = exp_df[exp_df['Personal Loan'] == 1]['Education'].value_counts()\nseries_ed","7a697730":"series_edd = exp_df[exp_df['Personal Loan'] == 0]['Education'].value_counts()\nseries_edd","2460ff98":"pd.DataFrame(dict(NO_PL= series_edd, PL= series_ed)).plot.bar(figsize = (8,6))\nplt.ylabel('Frequency')\nplt.xlabel('Education Level')\nplt.xticks(np.arange(3),('1','2','3'), rotation = 'horizontal')\nplt.legend(('NO Personal Loan', 'Personal Loan'))\nplt.title('Distribution of \"Personal Loan\" Values \\n among Groups of \"Education\" Values', fontsize = 14, y = 1.05);\nplt.savefig('distribution_PL_among_Education.png', bbox_inches = 'tight')","4c9abc4f":"series_edu_3 = exp_df[exp_df['Education'] == 3]['Personal Loan'].value_counts()","386abc99":"series_edu_2 = exp_df[exp_df['Education'] == 2]['Personal Loan'].value_counts()","d202ef72":"series_edu_1 = exp_df[exp_df['Education'] == 1]['Personal Loan'].value_counts()","942ae478":"labels = ['NO Personal Loan','Personal Loan']\nfig, (ax1, ax2, ax3) = plt.subplots(1,3, figsize = (18,6),subplot_kw=dict(aspect=\"equal\"))\nplt.axis('equal')\nax1.pie(series_edu_3, labels = labels, autopct= '%1.1f%%', shadow = True,explode = (0, 0.1), radius = 1.25, startangle = 90)\nax1.set_title('Education Level 3',fontsize = 14, y = 1.1)\n\nax2.pie(series_edu_2, labels = labels, autopct= '%1.1f%%', shadow = True,explode = (0, 0.1), radius = 1.25, startangle = 90)\nax2.set_title('Education Level 2', fontsize = 14, y = 1.1)\n\nax3.pie(series_edu_1, labels = labels, autopct= '%1.1f%%', shadow = True,explode = (0, 0.1), radius = 1.25, startangle = 90);\nax3.set_title('Education Level 1',fontsize = 14, y = 1.1)\n\nplt.suptitle('Proportion of Customers Who Have Personal Loan and Who Don\\'t, among CD Account Holders', \\\n             fontsize = 16, y = 1.12);\n\nplt.savefig('Proportion_of_PL_among edu_levels.png', bbox_inches = 'tight');","69d6d2f9":"series_edu_4 = exp_df[exp_df['Personal Loan'] == 1]['Education'].value_counts()\nseries_edu_4","fcdfd08d":"plt.axis('equal')\nplt.title('Proportion of Customers With Different Levels of Education \\n among Personal Loan Holders', \\\n          fontsize = 14, y = 1.3)\nlabels = ['Education Level  3',' Education Level 2','Education Level 1']\nplt.pie(series_edu_4, labels = labels, autopct= '%1.2f%%', shadow = True,explode = (0.1, 0, 0), radius = 1.6, startangle = 90);\nplt.savefig('Proportion_edu_levels_among_PL.png', bbox_inches = 'tight');","a544caac":"series_fam = exp_df[exp_df['Personal Loan'] == 1]['Family'].value_counts()\nseries_fam","73be38a1":"series_famm = exp_df[exp_df['Personal Loan'] == 0]['Family'].value_counts()\nseries_famm","2b60931b":"pd.DataFrame(dict( NO_PL = series_famm, PL= series_fam,)).plot.bar(figsize = (8,6))\nplt.ylabel('Frequency')\nplt.xlabel('Family Size')\nplt.xticks(np.arange(4),('1', '2', '3', '4'), rotation = 'horizontal')\nplt.legend(('NO Personal Loan', 'Personal Loan'));\nplt.title('Distribution of \"Personal Loan\" Values \\n among Groups of \"Family\" Values', fontsize = 14, y = 1.05);\nplt.savefig('distribution_of_PL_among_family.png', bbox_inches = 'tight')","c2463a64":"series_fam_3 = exp_df[exp_df['Family'] == 3]['Personal Loan'].value_counts()","ae4a9e0f":"series_fam_4 = exp_df[exp_df['Family'] == 4]['Personal Loan'].value_counts()","63868922":"labels = ['NO Personal Loan','Personal Loan']\n\nfig, (ax1, ax2) = plt.subplots(1,2, figsize = (12,6),subplot_kw=dict(aspect=\"equal\"))\nfig.suptitle('Proportion of Customers Who Have Personal Loan and Who Don\\'t, \\\namong Different Family Sizes', fontsize = 16, y = 1.1, x = 0.51);\n\nax1.pie(series_fam_3, labels = labels, autopct= '%1.1f%%', shadow = True,explode = (0, 0.1), radius = 1.25, startangle = 90)\nax1.set_title('Family Size 3',fontsize = 14, y = 1.1)\n\nax2.pie(series_fam_4, labels = labels, autopct= '%1.1f%%', shadow = True,explode = (0, 0.1), radius = 1.25, startangle = 90)\nax2.set_title('Family Size 4', fontsize = 14, y = 1.1);\n\nplt.savefig('Proportion_of_PL_among_family_levels.png', bbox_inches = 'tight');","dea7c6e3":"series_fam","e2bbc7b6":"plt.axis('equal')\nplt.title('Proportion of Customers With Different Family Sizes \\n among Personal Loan Holders', \\\n          fontsize = 14, y = 1.3)\nlabels = ['Family 2',' Family 1','Family 3','Family 4']\nplt.pie(series_fam.sort_values(ascending = True), labels = labels, \\\n        autopct= '%1.2f%%', shadow = True, explode = (0.1, 0.1, 0.1,0.15), radius = 1.6, startangle = 90);\nplt.savefig('Proportion_family_size_among_PL.png', bbox_inches = 'tight');","b7333fc1":"series_cca = exp_df[exp_df['Personal Loan'] == 1]['CCAvg'].value_counts()","8bcd59d4":"series_cca.describe()","f7dca33e":"width = 1.5 #wdth of bins in histogram - play with it to find good point for groupping\nseries_cca.plot.hist(bins = np.arange(series_cca.min(), series_cca.max() + width, width ), figsize = (8,6))\nplt.xlabel('CCAvg')\nplt.axvline(x = series_cca.mean(), color = 'red')\nplt.axvline(x = series_cca.min(), color = 'green')\nplt.axvline(x = series_cca.mean() + series_cca.std(), color = 'green')\nplt.title('Distribution of \"CCAvg\" values among \"Personal Loan\" holders', fontsize = 14, y = 1.05);\nplt.savefig('Distrib_ccavg_among_PL.png', bbox_inches = 'tight')","65f0f54a":"series_ccaa = exp_df['CCAvg'].value_counts()\nwidth = 8.5 #wdth of bins in histogram - play with it to find good point for groupping\nseries_ccaa.plot.hist(bins = np.arange(series_ccaa.min(), series_ccaa.max() + width, width ), figsize = (8,6))\nplt.xlabel('CCAvg')\nplt.title('Distribution of \"CCAvg\" values among whole population', fontsize = 14, y = 1.05);\nplt.savefig('Distrib_ccavg_among_population.png', bbox_inches = 'tight')","4f9b54ca":"series_inc = exp_df[exp_df['Personal Loan'] == 1]['Income'].value_counts()","9f760cc0":"series_inc.describe()","3ae15880":"width = 1.5 #wdth of bins in histogram - play with it to find good point for groupping\nseries_inc.plot.hist(bins = np.arange(series_inc.min(), series_inc.max() + width, width ), figsize = (8,6))\nplt.xlabel('Income')\nplt.axvline(x = series_inc.mean(), color = 'red')\nplt.axvline(x = series_inc.min(), color = 'green')\nplt.axvline(x = series_inc.mean() + series_inc.std(), color = 'green')\nplt.title('Distribution of \"Income\" values among \"Personal Loan\" holders', fontsize = 14, y = 1.05);\nplt.savefig('Distrib_income_among_PL.png', bbox_inches = 'tight')","a9465cec":"series_incc = exp_df['Income'].value_counts()\nwidth = 8.5 #wdth of bins in histogram - play with it to find good point for groupping\nseries_incc.plot.hist(bins = np.arange(series_incc.min(), series_incc.max() + width, width ), figsize = (8,6))\nplt.xlabel('Income')\nplt.title('Distribution of \"Income\" values among whole population', fontsize = 14, y = 1.05);\nplt.savefig('Distrib_income_among_population.png', bbox_inches = 'tight')","7416dfe5":"df[(df['Personal Loan'] == 0) &\\\n   (df['CD Account'] == 1) &\\\n   (df['Education'] == 3) &\\\n   (df['Family'] == 3) &\\\n   (df['CCAvg'] > 1) &\\\n   (df['CCAvg'] < 2.5) &\\\n   (df['Income'] > 1) &\\\n   (df['Income'] < 2.5)]","da27c6ac":"CD = df[(df['Personal Loan'] == 0) & (df['CD Account'] == 1)]\nCD.shape[0]","8a462c54":"CD_EDU_3 = df[(df['Personal Loan'] == 0) & (df['CD Account'] == 1)&(df['Education'] == 3)]\nCD_EDU_3.shape[0]","6ac66fc1":"CD_EDU_3_FM_3 = df[(df['Personal Loan'] == 0) & (df['CD Account'] == 1)&(df['Education'] == 3)&(df['Family'] == 3)]\nCD_EDU_3_FM_3.shape[0]","0c4c7a79":"CD_EDU_3_FM_4 = df[(df['Personal Loan'] == 0) & (df['CD Account'] == 1)&(df['Education'] == 3)&(df['Family'] == 4)]\nCD_EDU_3_FM_4.shape[0]","753695b8":"CD_EDU_3_FM_12 = df[(df['Personal Loan'] == 0) & (df['CD Account'] == 1)&(df['Education'] == 3)&(df['Family'] < 3)]\nCD_EDU_3_FM_12.shape[0]","d6f19c6e":"A_ID = CD_EDU_3_FM_3.ID.tolist()\nlen(A_ID)","6d0115ff":"A_ID.extend(CD_EDU_3_FM_4.ID.tolist())\nlen(A_ID)","6ee7c112":"A_ID.extend(CD_EDU_3_FM_12.ID.tolist())\nlen(A_ID)","25b39410":"#check\nlen(A_ID) == CD_EDU_3.shape[0]","bfaaf10a":"NOCD_EDU_3_FM_3_CCA_1 = df[(df['Personal Loan'] == 0) &\\\n   (df['CD Account'] == 0) &\\\n   (df['Education'] == 3) &\\\n   (df['Family'] == 3)&\\\n   (df['CCAvg'] > 1)&\\\n   (df['CCAvg'] < 2.5)]","65ee2c54":"NOCD_EDU_3_FM_3_CCA_1.head(3)","ba98c493":"B_ID = NOCD_EDU_3_FM_3_CCA_1.ID.tolist()\nlen(B_ID)","7b24aa65":"#### Compute the odds","61ece8a1":"#### The bar chart of coefficient distribution ","0304d13c":"**B_ID - the list of customers ID** to subset from dataset with customers contacts.","232ff9e2":"**Conclusion**\n\n> - 27.9%  and 27.7% of persons who have Personal Loan, have Family size 4 and Level 3 respectively. \n> - For 'Family' characteristic - the main segments to sell Personal Loan is the people who have Family Size 3 and 4.\n> - Target values of 'Family' variable are 3 and 4 in descending order of priority, since the proportion of people who has Personal Loan is the higthest with Family Size 3 - 13,2%.","66b72c5f":"This is subset of data with customers who has lower probability to bought the product than customers from first subset, but higher probability  among rest population","0166a91f":"**'Family'** and **'Education'** has low association with 'Personal Loan'\n\nLet's check our confidence with logistic regretion\n","70d853be":"# <br>\n\n## Family","45f05592":"# <br><br>\n\n# Assess Data","2c78f76c":"# <br>\n\n## CCAvg","90ceda02":"# <br>\n\n## Clean Data","35222607":"> **Observation**\n> - Column \"Experience\" has some negative value. Need to fix\n> - Binary variables \"Personal Loan\", \"CreditCard\", \"Online\", \"CD Account\", \"Securities Account\" has clean data\n> - Ordinary Cat variables \"Family\" and \"Education\" are clean too  ","29154e74":"# <br>\nAll Data is clean and we can start Analysis\n<br> \n\n# Analysis\n\n### Questions\n\n> - Is there some association between personal characteristics and the fact that person obtained Personal Loan (Loan Fact)? If so:\n> - What are those Main Characteristics that has a higher association with Loan Fact and what the strength of correlation?\n> - What the Segments of Main Characteristics, that has a higher strength of association with  Personal Loan?\n> - What is the sample of Data with persons from Main Segments.","94b9cb64":"#### The bar chart of coefficient distribution ","d7dd440a":"Fit a logic model","5d9891d1":"#### Filter columns with P-values less then 0.05 and store variables and it's coefficients into the dictionary","aa7dbd05":"['Age', 'Income', 'CCAvg', 'Mortgage']","d8e3dcb8":"**'Age'** and **'Mortgage'** both has very low cor.coef with Personal Loan. We may say that only **'Income'** and **'CCAvg**' has association with 'Personal Loan'\n\nLet's check our confidense about this statment with logistic regression model:","e3bef348":"**We can say with confidence** that any ZIP Code does not have statisticaly significant association with 'Personal Loan', since  their p-value in logistic regression > 0.05","6012315f":"<br><br>\n**Conclusion**\n\n> **Target groups of 'CCAvg' characteristic is in descending order of priority:**\n \n> - Group I:  1 < CCAvg < 2.5\n> - Group II:  4 < CCAvg < 5.5\n> - Group III:  7 < CCAvg < 8.5","c91feb33":"Let's check what the values or group of values of each variable lies inside group that have 'Personal Loan' and don't have that.\n\nSince we found strong association between 'Age' and 'Experience' we decided to exclud 'Experience' from analysis steps to avoid multicollinearity.","8f3eaf5a":"<br>\nLet's fit logistic regression","77b69f5b":"Guess this set is okay for the first view since we assume that the initial campaign of selling Personal Loans was evenly spreaded through all zip codes.\n\nLet's get dummies...","3c604981":"**We may say** that 'Income' characteristic values can be devided in three groups in descending order of priority consider its frequncy among Personal Loan holder:\n\n\n> - Group I:  1 < Income < 2.5\n> - Group II:  4 < Income < 5.5\n> - Group III:  7 < Income < 8.5","61d2292e":"As soon as we found that the 'Personal Loan' depends on FIVE main characteristics, let's subset our data frame and get a closer look at the data.","9faa5a71":"Replace nagative 'Experience' values with the means","0301ceae":"### Summary Assess Data\n> - Columns \"ID\", \"ZIP Code\" are nominal variables. Should be in 'str' type\n> - Column \"Experience\" has some negative value. Need to fix\n\nNo bad tidiness issues\n","54b58837":"#### Define","db6b5adb":"##### Here is the distribution of \"Personal Loan\"  values among groups of \"CD Account\"  values","f81af4f6":"#### Correlation Table","bbf34961":"<br>\n\n### CATEGORICAL VARIABLES\n\n'ZIP Code', 'Family', 'Education'","2f540b58":"Here is the distribution of \"CCAvg\" values among Personal Loan holders and among whole population.","84d73215":"#### Code","e9b87bfd":"<br>\n\n### Education","fdadcda1":"#### Test","80b2a44e":"**We may say** that CCAvg characteristics values can be devided in three groups in descending order of priority consider its frequncy among Personal Loan holder:\n\n\n> - Group I:  1 < CCAvg < 2.5\n> - Group II:  4 < CCAvg < 5.5\n> - Group III:  7 < CCAvg < 8.5","bdae38b3":"Columns \"ID\", \"ZIP Code\" are nominal variables","392d1d26":"##### Get P-Values for each variable","be0245be":"**Conclusion**\n\n> - 42.7%  and 37.9% of persons who have Personal Loan, have Education level 3 and Level 2 respectively. \n> - For 'Education' characteristic - the main segments to sell Personal Loan is the people who have Second and Third levels of education\n> - Target values of 'Education' variable are 3 and 2 in descending order of priority","311624f2":"<br><br>\n\n## Summary Conclusion:\n\n'Personal Loan' has statisticaly significant association with:\n\n> -  'CD Account' : coef = 2.40 : odds = 11.07\n> -  'Family' : coef = 0.16231 : odds = 1.176\n> -  'Education' : coef = 0.54873 : odds = 1.731\n> -  'Income' : coef = 0.03508 : odds = 1.036\n> -  'CCAvg' : coef = 0.06879 : odds = 1.071\n\nBoth variables are positively associated with 'Personal Loan'. We may say the following:\n\n> - **With customer been hold CD Account with The Bank** we expect the odds to sell Personal Loan to increase **11 times**, holding everything else constant\n\n> - **For each unit increase in 'Family'** we expect the odds to sell Personal Loan to increase **by 17.62%**, holding everything else constant\n\n> - **For each unit increase in 'Education'** we expect the odds to sell Personal Loan to increase **by 73.11%**, holding everything else constant\n\n> - **For each $1000 increase in 'Income'** we expect the odds to sell Personal Loan to increase **by 3.57%**, holding everything else constant\n\n> - **For each $1000 increase in 'CCAvg'** we expect the odds to sell Personal Loan to increase **by 7.12%**, holding everything else constant","5eaf9275":"### Conclusion:\n\n'Personal Loan' has statisticaly significant **positive** association with only:\n\n> -  'CD Account' : coef = 2.40\n\nWe may say the following:\n\n> - **With customer been hold CD Account with The Bank** we expect the odds to sell Personal Loan to increase 10 times, holding everything else constant","8731e1d8":"All p-values are less than 0.05\n<br><br>","beea20af":"> **Observation**\n> - No null values\n> - No missing values\n> - Columns \"ID\", \"ZIP Code\" are categorical nominal variables. Should be in 'str' type","c2b5204b":"Now we may build subsets of customers step by step with the idea in mind that:\n<br>**the more segments we take into account, the higher probability to sell the product among this customers** ","6c84ee27":"##### Lets find the quantitive variable with strong association with 'Experience'","f5386db3":"Lets get a closer look at each of Main Characteristics","900c9fe3":"<br><br>\n**We may say** that this ideal combination of characteristics does not exist among customers in our database.<br><br>\nLets do step-by-step.","96c9290b":"Here is the distribution of \"Income\" values among Personal Loan holders and among whole population.","df69ab4d":"'Family' and 'Education' are ordinal categorical variables so we may apply logistic regression direct to them. 'ZIP Code' is nominal, so we need to build dummy variables to check the association existence","3efd9ad8":"**We can say with confidence** that 'Income' and 'CCAvg' both has statisticaly significant association with 'Personal Loan', since  their p-value in logistic regression < 0.05","afdefe83":"Get the subset of 'Age' data with negative values in 'Experience","7098aaa7":"#### Filter columns with P-values less then 0.05 and store variables and it's coefficients into the dictionary","95645fec":"**'CD Account'** - the only one variable with moderate association","464c21aa":"##### Get Odds for each variable","f1c852bc":"<br><br>\n**Conclusion**\n\n> **Target groups of 'Income' characteristic is:**\n\n> - Group I:  1 < Income < 2.5\n> - Group II:  4 < Income < 5.5\n> - Group III:  7 < Income < 8.5","03a633d2":"#### Code","f6160304":"### Conclusion:\n\n'Personal Loan' has statisticaly significant association with:\n\n> -  'Income' : coef = 0.03508\n> -  'CCAvg' : coef = 0.06879\n\nBoth variables are positively associated with 'Personal Loan'. As soon as both have one unit as $1000 we may say the following:\n\n> - **For each $1000 increase in 'Income'** we expect the odds to sell Personal Loan to increase by 3.57%, holding everything else constant\n\n> - **For each $1000 increase in 'CCAvg'** we expect the odds to sell Personal Loan to increase by 7.12%, holding everything else constant","bc7f4ea4":"Here, in one place, are those characteristics segments we found earlier.\nHave a look one more time:\n\n### CD Account\n> - 46.4% of CD Account Holders have Perconal Loan. \n> - For 'CD Account' characteristic - the main segment to sell Personal Loan is the people who already have a CD Account with the Bank.\n> - **Target value of 'CD Account' variable:**\n>> - **1**\n<br>\n### Education\n> - 42.7%  and 37.9% of persons who have Personal Loan, have Education level 3 and Level 2 respectively. \n> - For 'Education' characteristic - the main segments to sell Personal Loan is the people who have Second and Third levels of education\n> - **Target values of 'Education' variable in descending order of priority:**\n>> - **3**\n>> - **2**\n<br>\n### Family\n> - 27.9%  and 27.7% of persons who have Personal Loan, have Family size 4 and Level 3 respectively. \n> - For 'Family' characteristic - the main segments to sell Personal Loan is the people who have Family Size 3 and 4.\n> - **Target values of 'Family' variable in descending order of priority**, since the proportion of people who has Personal Loan is the higthest with Family Size 3 - 13,2%.\n>> - **3**\n>> - **4**\n<br>\n### CCAvg\n> **Target groups of 'CCAvg' characteristic is in descending order of priority:**\n <br>(in thousands usd)\n> - Group I:  1 < CCAvg < 2.5\n> - Group II:  4 < CCAvg < 5.5\n> - Group III:  7 < CCAvg < 8.5\n<br><br>\n### Income\n> **Target groups of 'Income' characteristic is:**\n<br>(in thousands usd)\n> - Group I:  1 < Income < 2.5\n> - Group II:  4 < Income < 5.5\n> - Group III:  7 < Income < 8.5","dc9444d0":">>> ### What are those Main Characteristics that has a higher association  with Loan Fact and what the strength of association ?","0982121d":"Here is the subset with the highest association with Personal Loan, that is, as we remember, mean the highest probability to sell the product.","cfa26966":"**Conclusion**\n\n> - 46.4% of CD Account Holders have Perconal Loan. \n> - For 'CD Account' characteristic - the main segment to sell Personal Loan is the people who already have a CD Account with the Bank.\n> - Target value of 'CD Account' variable = 1","62f5fd3f":"##### Here is the distribution of \"Personal Loan\" values among groups of  \"Education\" values ","152e5c08":"**'Education'** has strongest association with 'Personal Loan'","00edc10e":"# <br>\n\n#### Define","9b5233d8":"# <br>\n\n### BINARY VARIABLES\n\n'Securities Account', 'CD Account', 'Online', 'Credit Card'","c576c023":"#### The bar chart of P-Values distribution and threshold line ","91f87ea3":"Column \"Experience\" has some negative value","103caa98":"CD Account = 1<br>\nEducation = 3<br>\nFamily = 3<br>\n1 < CCAvg < 2.5<br>\n1 < Income < 2.5<br>","71fc0a65":"###  Is there some association between personal characteristics and the fact that person obtained Personal Loan?","9ca2d3cb":"<br><br>\n**Here is the list customer's ID in descending order of probability to sell the product:**\n<br> Letter \"A\" is a label of higher priority and associated with value \"1\" in 'CD Account'","943d1146":"<br>\n\n### 'ZIP Code'","5c64d6fa":"<br>\nGet a list of 'Age' values where we found some negative values in 'Experience'","1a621ca5":"## Exploratory data analysis","d1b09c5a":"**\"A_ID\" is the list of customers ID** who has higher probability to bought the product.<br>\nTotal 43 customers.<br><br>\nUse this list to subset data from dataset with customers contacts.\n\nIn case we need next subset with data of customers who has higher probability to bought the product - we may use the same approach.<br><br>","ef401dec":"# <br>\n\n## Summary Conclusion\n\nWe made the simple step-by-step analysis of customer's characteristics to identify patterns to effectively choose the subset of customers who have a higher probability to buy new product \"Personal Loan\" from The Bank. We performed the following steps:\n> - We check all twelve characteristics whether or not each of them has an association with the fact the product been sold.\n> - We find FIVE main characteristics that have higher than moderate strength of association with the product.\n> - We analyze main characteristics and get segments in each with different strength of association with the product.\n> - We tried to make a subset of customers with ideal characteristics who has the highest probability to buy the product. Unfortunately, our dataset does not contain such information. So...\n> - We build a simple algorithm to make a subset of data to get the customers IDs who have a high probability to buy the product.","920f1936":"<br><br>\n\n>>> ##  What the Segments of Main Characteristics, that has a higher strength of association with  Personal Loan?","401514ad":"#### QUANTATIVE VARIABLES","56bdc5c8":"# <br>\n\n### Income","d9989a23":"Let's apply logistic regression on this subset","e99ad81c":"**We may say**, that all our groups of 'CCAvg' defined as priority groups to sell Personal Loan, lies inside segment with pretty high frequency among whole population. ","50565340":"##### Here is the distribution of \"Personal Loan\"  values among groups of \"Family\"  values","22a79a73":"We may say that **the proportion** of persons who has Personal Loan among them who has CD account with The Bank **is quit high**.<br>\nLet's see the exact number of proportion of \"loanees\" among \"depositees\"","c368d80a":"Lets check how we can group the 'Zip Code' values to minimize the number of dummies","db987ec8":"<br>\n\n### 'Family' and  'Education'","56dc5519":"As we found above, there are some segments of main characteristics with higher strength of association with Personal Loan.\n\nLet's look at the samples of the database with those segments...","e8023e8c":"# <br> \n\n>>> ## What is the sample of Data with persons from Main Segments.","d03f4c4b":"#### Test","6a2ad23d":"**We can say with confidence** that 'Family' and 'Education' both has statisticaly significant association with 'Personal Loan', since  their p-value in logistic regression < 0.05","b4bab76a":"##### The chart demonstrating the proportion  of strength of association  between Personal Loan and values of Main Characteristics","c5b7a4a8":"#### Heat map","4b26203c":"Here is a subset of the initial data frame with just characteristics that have a positive association  with 'Personal Loan' and the size of association  is higher than moderate","db645616":"**We may say**, that all our groups of 'Income' defined as priority groups to sell Personal Loan, lies inside segment with pretty high frequency among whole population. ","275bc195":"### Variables definition\n\n\n> - **ID** - Customer ID \n> - **Age** - Customer's age in completed years \n> - **Experience** - #years of professional experience \n> - **Income** - Annual income of the customer - in thousands usd \n> - **ZIPCode** - Home Address ZIP code. \n> - **Family** - Family size of the customer \n> - **CCAvg** - Avg. spending on credit cards per month - in thousands usd \n> - **Education** - Education Level. 1: Undergrad; 2: Graduate; 3: Advanced\/Professional \n> - **Mortgage** - Value of house mortgage if any - in thousands usd  \n> - **Personal Loan**  - Did this customer accept the personal loan offered in the last campaign? \n> - **Securities Account** - Does the customer have a securities account with the bank? \n> - **CD Account** - Does the customer have a certificate of deposit (CD) account with the bank? \n> - **Online** - Does the customer use internet banking facilities? \n> - **CreditCard** - Does the customer uses a credit card issued by UniversalBank?","f926baf4":"**Observation:**\n\nThe subset of each age with negative values in 'Experience' is definitely small. \n\n**Decision:**\nWe can replace each negative 'Experience' value with the mean of positive 'Experience' value associated with the particular 'Age' value","abe3ffb6":"**We may say** that the proportion of persons who has Personal Loan among them who has Family size 2 and 3 is highest proportion.\nLet's see the exact number of that proportions of \"loanees\" among \"depositees\"","f88dacf1":"<br><br>\n##### Here is the data frame with Main Characteristics ...\n... and their odds to increase the chance to sell Personal Loan with increase value of variable by one unit","73998282":"We may say that **the proportion** of persons who has Personal Loan among them who has Third and Second Level of Education **is higher** than proportion among people who has First level of Edication.\n\n<br>\nLet's see the exact numbers of proportions.","165d8539":"### CD Account","9a7b0b7b":"Data Analysis to identify the potential customers who have a higher probability of purchasing the loan.","e4a649ac":"### Conclusion:\n\n'Personal Loan' has statisticaly significant association with:\n\n> -  'Family' : coef = 0.16231\n> -  'Education' : coef = 0.54873\n\nBoth variables are positively associated with 'Personal Loan'. We may say the following:\n\n> - **For each unit increase in 'Family'** we expect the odds to sell Personal Loan to increase by 17.62%, holding everything else constant\n\n> - **For each unit increase in 'Education'** we expect the odds to sell Personal Loan to increase by 73.11%, holding everything else constant","a2f909e8":"**'CCAvg'** has strongest association with 'Personal Loan'","3a105e40":"#### Compute the odds","79467cf1":"Get indexes of negative values in 'Experience'","f52e920b":"# <br>\n\n#  Explanatory analysis","dee20b2c":"'Age' has a very strong association with 'Experience","c4958c85":"The case is The Bank has a customers Data with various characteristics of the customers. The management built a new product - Personal Loan, and ran a small campaign towards selling the New Product to their clients. \nAfter some time, 9% of customers have Personal Loan from The Bank.\n\n\n### The GOAL IS!\n> - To sell more Personal Loan products to Bank customers.\n> - To devise campaigns to better target marketing to increase the success ratio with a minimal budget.\n> - To identify the potential customers who have a higher probability of purchasing the loan. \n\nIncrease the success ratio of advertisement campaign while at the same time reduce the cost of the campaign.\n\n\n### The Questions for Analysis\nAs soon as we got 9% of customers who bought the Product, we got the following questions:\n\n> - Is there some associations between personal characteristics and the fact that customer bought the Product? If so:\n>\n> - What are those Main Characteristics that have an association with the Product and what is the strength of the association?\n> - What are the Segments of Main Characteristics, that have a higher strength of association with the Product?\n> - What is the sample of Data with customers from Main Segments?\n \n\n### Approach\n\nWe made the simple step-by-step analysis of customer's characteristics to identify patterns to effectively choose the subset of customers who have a higher probability to buy new product \"Personal Loan\" from The Bank. \n<br><br>\nWe performed the following steps:\n> - We check all twelve characteristics whether or not each of them has an association with the fact the product been sold.\n> - We find FIVE main characteristics that have higher than moderate strength of association with the product.\n> - We analyze main characteristics and get segments in each with different strength of association with the product.\n> - We tried to make a subset of customers with ideal characteristics who has the highest probability to buy the product. Unfortunately, our dataset does not contain such information. So...\n> - We build a simple algorithm to make a subset of data to get the customers IDs who have a high probability to buy the product.\n\n### Technologies\n\n- Python\n- Pandas\n- Numpy\n- Seaborn\n- Matplotlib"}}