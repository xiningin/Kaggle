{"cell_type":{"b9165b4b":"code","61052547":"code","f542ea54":"code","e21b0e37":"code","2c796065":"code","b9a7a7df":"code","8902317c":"code","c3892105":"code","e645c183":"code","2022d942":"code","edb9c258":"code","da865b28":"code","a7e01250":"code","7fd0872d":"code","f51b59d8":"code","90e5d88f":"markdown","4cb00b87":"markdown","16204a24":"markdown","a1451722":"markdown","de7ebe8f":"markdown","344f7bf6":"markdown","f088e08c":"markdown","790628b3":"markdown","296082dd":"markdown"},"source":{"b9165b4b":"import numpy as np\nimport librosa\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set()\nimport os\nimport scipy\nimport librosa.display\nfrom IPython.display import Audio\nimport scipy.io.wavfile\nplt.style.use(\"ggplot\")","61052547":"random_zero = \"..\/input\/birdsong-recognition\/train_audio\/aldfly\/XC134874.mp3\"\nAudio(random_zero)","f542ea54":"samples, sample_rate = librosa.load(random_zero)\nplt.figure(figsize=(12, 4))\nlibrosa.display.waveplot(samples.astype('float'), sr=sample_rate)\nplt.show()","e21b0e37":"X = librosa.stft(samples.astype('float'))\nXdb = librosa.amplitude_to_db(X)\nplt.figure(figsize=(12, 5))\nlibrosa.display.specshow(Xdb, sr=sample_rate, x_axis='time', y_axis='hz')\nplt.show()","2c796065":"y_pitch_speed = samples.copy()\n# you can change low and high here\nlength_change = np.random.uniform(low=0.8, high = 1)\nspeed_fac = 1.0  \/ length_change\nprint(\"resample length_change = \",length_change)\ntmp = np.interp(np.arange(0,len(y_pitch_speed),speed_fac),np.arange(0,len(y_pitch_speed)),y_pitch_speed)\nminlen = min(y_pitch_speed.shape[0], tmp.shape[0])\ny_pitch_speed *= 0\ny_pitch_speed[0:minlen] = tmp[0:minlen]\nAudio(y_pitch_speed, rate=sample_rate)\nlibrosa.display.waveplot(y_pitch_speed.astype('float'), sr=sample_rate)\n","b9a7a7df":"y_pitch = samples.copy()\nbins_per_octave = 12\npitch_pm = 2\npitch_change =  pitch_pm * 2*(np.random.uniform())   \nprint(\"pitch_change = \",pitch_change)\ny_pitch = librosa.effects.pitch_shift(y_pitch.astype('float64'), \n                                      sample_rate, n_steps=pitch_change, \n                                      bins_per_octave=bins_per_octave)\nAudio(y_pitch, rate=sample_rate)\nlibrosa.display.waveplot(y_pitch.astype('float'), sr=sample_rate)\n","8902317c":"y_speed = samples.copy()\nspeed_change = np.random.uniform(low=0.9,high=1.1)\nprint(\"speed_change = \",speed_change)\ntmp = librosa.effects.time_stretch(y_speed.astype('float64'), speed_change)\nminlen = min(y_speed.shape[0], tmp.shape[0])\ny_speed *= 0 \ny_speed[0:minlen] = tmp[0:minlen]\nAudio(y_speed, rate=sample_rate)\nlibrosa.display.waveplot(y_speed.astype('float'), sr=sample_rate)\n","c3892105":"y_aug = samples.copy()\ndyn_change = np.random.uniform(low=1.5,high=3)\nprint(\"dyn_change = \",dyn_change)\ny_aug = y_aug * dyn_change\nprint(y_aug[:50])\nprint(samples[:50])\nAudio(y_aug, rate=sample_rate)\nlibrosa.display.waveplot(y_aug.astype('float'), sr=sample_rate)\n","e645c183":"y_noise = samples.copy()\n# you can take any distribution from https:\/\/docs.scipy.org\/doc\/numpy-1.13.0\/reference\/routines.random.html\nnoise_amp = 0.005*np.random.uniform()*np.amax(y_noise)\ny_noise = y_noise.astype('float64') + noise_amp * np.random.normal(size=y_noise.shape[0])\nAudio(y_noise, rate=sample_rate)\nlibrosa.display.waveplot(y_noise.astype('float'), sr=sample_rate)\n","2022d942":"y_shift = samples.copy()\ntimeshift_fac = 0.2 *2*(np.random.uniform()-0.5)  # up to 20% of length\nprint(\"timeshift_fac = \",timeshift_fac)\nstart = int(y_shift.shape[0] * timeshift_fac)\nprint(start)\nif (start > 0):\n    y_shift = np.pad(y_shift,(start,0),mode='constant')[0:y_shift.shape[0]]\nelse:\n    y_shift = np.pad(y_shift,(0,-start),mode='constant')[0:y_shift.shape[0]]\nAudio(y_shift, rate=sample_rate)\nlibrosa.display.waveplot(y_shift.astype('float'), sr=sample_rate)\n","edb9c258":"y_hpss = librosa.effects.hpss(samples.astype('float64'))\nprint(y_hpss[1][:10])\nprint(samples[:10])\nAudio(y_hpss[1], rate=sample_rate)\nlibrosa.display.waveplot(y_hpss[1].astype('float'), sr=sample_rate)\n","da865b28":"samples[(samples > 200) | (samples < -200)]","a7e01250":"sampling=samples[(samples > 200) | (samples < -200)]\nshifted_silent =sampling.tolist()+np.zeros((samples.shape[0]-sampling.shape[0])).tolist()\nAudio(shifted_silent, rate=sample_rate)\nlibrosa.display.waveplot(np.array(shifted_silent).astype('float'), sr=sample_rate)\n","7fd0872d":"input_length = len(samples)\nstreching = samples.copy()\nstreching = librosa.effects.time_stretch(streching.astype('float'), 1.1)\nif len(streching) > input_length:\n    streching = streching[:input_length]\nelse:\n    streching = np.pad(streching, (0, max(0, input_length - len(streching))), \"constant\")\nAudio(streching, rate=sample_rate)\nlibrosa.display.waveplot(streching.astype('float'), sr=sample_rate)\n","f51b59d8":"plt.figure(figsize=(12, 4*9))\nplt.subplot(9, 1, 1)\nlibrosa.display.waveplot(samples.astype('float'), sr=sample_rate,x_axis=None)\nplt.title('original')\nplt.subplot(9, 1, 2)\nlibrosa.display.waveplot(y_pitch_speed.astype('float'), sr=sample_rate,x_axis=None)\nplt.title('augmented pitch and speed')\nplt.subplot(9, 1, 3)\nlibrosa.display.waveplot(y_pitch, sr=sample_rate,x_axis=None)\nplt.title('augmented pitch only')\nplt.subplot(9, 1, 4)\nlibrosa.display.waveplot(y_speed.astype('float'), sr=sample_rate,x_axis=None)\nplt.title('augmented speed only')\nplt.subplot(9, 1, 5)\nlibrosa.display.waveplot(y_aug.astype('float'), sr=sample_rate,x_axis=None)\nplt.title('amplify value')\nplt.subplot(9, 1, 6)\nlibrosa.display.waveplot(y_noise, sr=sample_rate,x_axis=None)\nplt.title('augmented noise')\nplt.subplot(9, 1, 7)\nlibrosa.display.waveplot(y_hpss[1], sr=sample_rate,x_axis=None)\nplt.title('apply hpss')\nplt.subplot(9, 1, 8)\nlibrosa.display.waveplot(np.array(shifted_silent).astype('float'), sr=sample_rate,x_axis=None)\nplt.title('shift silent to right')\nplt.subplot(9, 1, 9)\nlibrosa.display.waveplot(streching, sr=sample_rate)\nplt.title('stretching')\nplt.show()","90e5d88f":"## Change speed only","4cb00b87":"## value augmentation","16204a24":"## Change pitch only","a1451722":"## random shifting","de7ebe8f":"## Shift silent to the right","344f7bf6":"## add distribution noise","f088e08c":"## Change pitch and speed","790628b3":"## apply hpss","296082dd":"## Streching"}}