{"cell_type":{"3306de5c":"code","4bc7531b":"code","22838eb2":"code","e3f4a509":"code","cbedcdcd":"code","b679200a":"code","9ae97850":"code","2cf7cc3c":"code","99e2ed76":"code","7de9d9cb":"code","137f9291":"code","458d89bb":"code","afc6e871":"code","c2302fb9":"code","140239f8":"code","0dd51cf5":"code","e7e30af9":"code","1624b3af":"code","0a375ad0":"code","964d5a3b":"code","0506e6d2":"code","d8add07a":"code","bf5963dd":"code","2381d525":"code","09010d38":"code","5c6ec191":"code","1b54c05b":"code","17d75d91":"code","0e28e2ce":"code","cce3ceda":"code","0e997480":"markdown","8d63891d":"markdown","22466c67":"markdown","a1ac3ff0":"markdown","d16e4d4f":"markdown","aaecf3fa":"markdown","eca47e85":"markdown","27afdade":"markdown","588e4ba0":"markdown","c008a467":"markdown","9d3fcc6b":"markdown","6d2bb5e9":"markdown","e8f2b3fe":"markdown","3376297b":"markdown","334f2e6f":"markdown","162935e3":"markdown","2c27ed1e":"markdown","d308e754":"markdown","ce98b972":"markdown","6000f99e":"markdown","05171b86":"markdown","97e2b1a5":"markdown","bda8f8c4":"markdown","14484ddf":"markdown","c088d988":"markdown","9a1d7f51":"markdown","b624d463":"markdown","04573ba1":"markdown","62dd8192":"markdown","d59b1577":"markdown"},"source":{"3306de5c":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","4bc7531b":"data=pd.read_csv('..\/input\/heart-disease-uci\/heart.csv')\ndata.head()","22838eb2":"data.tail()","e3f4a509":"data.info()","cbedcdcd":"x_data=(data.drop([\"target\"],axis=1))\ny_data=data.target","b679200a":"#scaling\nfrom sklearn.preprocessing import StandardScaler\nsc=StandardScaler()\nx_data_scaled=pd.DataFrame(sc.fit_transform(x_data))\nscaled_data=pd.concat([x_data_scaled,y_data],axis=1)\nscaled_data.columns=data.columns","9ae97850":"import plotly as py\nfrom plotly.offline import init_notebook_mode, iplot\ninit_notebook_mode(connected=True)\nimport plotly.graph_objs as go\nimport plotly.express as px\n","2cf7cc3c":"crr=data.corr()\nplt.figure(figsize=(8,8))\nsns.heatmap(crr,annot=True)\nplt.show()","99e2ed76":"gender_pie={\n  \"data\": [\n    {\n      \"values\": data.sex.value_counts(),\n      \"labels\": [\"Female\",\"Male\"],\n      \"domain\": {\"x\": [0, .8],\n                \"y\": [0, .8]},\n      \"name\": \"Total Distribution by Gender\",\n      \"hoverinfo\":\"label+percent+name+value\",\n      \"hole\": .1,\n      \"type\": \"pie\"\n    },],\n  \"layout\": {\n        #\"title\":\"Population Rate of Regions\",\n        \"annotations\": [\n            { \"font\": { \"size\": 20},\n              \"showarrow\": False,\n              \"text\": \"Total Distribution by Gender\",\n                \"x\": 0.4,\n                \"y\": 1\n            },\n        ]\n    }\n}\n    \niplot(gender_pie)","7de9d9cb":"fig = px.histogram(data, x=\"age\",range_x=[29,79],nbins=10)\nfig.show()","137f9291":"disease_pie={\n  \"data\": [\n    {\n      \"values\": data.target.value_counts(),\n      \"labels\": [\"Have heart disease\",\"No heart disease\"],\n      \"domain\": {\"x\": [0, .8],\n                \"y\": [0, .8]},\n      \"name\": \" Have Disease \/ not Have\",\n      \"hoverinfo\":\"label+percent+name+value\",\n      \"hole\": .1,\n      \"type\": \"pie\"\n    },],\n  \"layout\": {\n        #\"title\":\"Population Rate of Regions\",\n        \"annotations\": [\n            { \"font\": { \"size\": 20},\n              \"showarrow\": False,\n              \"text\": \" Have Disease \/ not Have\",\n                \"x\": 0.3,\n                \"y\": 1\n            },\n        ]\n    }\n}\n    \niplot(disease_pie)","458d89bb":"data_patient=data[data.target==1]\npatient_gender_pie={\n  \"data\": [\n    {\n      \"values\": data_patient.sex.value_counts(),\n      \"labels\": [\"Male\",\"Female\"],\n      \"domain\": {\"x\": [0, .8],\n                \"y\": [0, .8]},\n      \"name\": \"Gender Distribution of those with Heart Disease\",\n      \"hoverinfo\":\"label+percent+name+value\",\n      \"hole\": .1,\n      \"type\": \"pie\"\n    },],\n  \"layout\": {\n        #\"title\":\"Population Rate of Regions\",\n        \"annotations\": [\n            { \"font\": { \"size\": 20},\n              \"showarrow\": False,\n              \"text\": \"Gender Distribution of those with Heart Disease\",\n                \"x\": 0.4,\n                \"y\": 1\n            },\n        ]\n    }\n}\n    \niplot(patient_gender_pie)","afc6e871":"fig = px.histogram(data_patient, x=\"age\",range_x=[29,79])\nfig.show()","c2302fb9":"plt.figure(figsize=(10,7))\nsns.swarmplot(x='target',y='chol',data=data,size=7)\nplt.xticks(rotation=45)\nplt.xlabel('DISEASES STATUS (Target)')\nplt.ylabel('CHOLESTEROL')\nplt.show()","140239f8":"from sklearn.model_selection import train_test_split\nx_train, x_test, y_train, y_test = train_test_split(x_data_scaled, y_data, test_size=0.2, random_state=0)\n","0dd51cf5":"from sklearn.linear_model import LogisticRegression\nlog_reg=LogisticRegression(random_state=0)\nlog_reg.fit(x_train,y_train)\nacc_log_reg=log_reg.score(x_test,y_test)*100\nprint(\"Test Accuracy = {:.3f} %\".format(acc_log_reg))\ny_pred_lr=log_reg.predict(x_test)","e7e30af9":"# Confusion Matrix\nfrom sklearn.metrics import confusion_matrix\nlr_cm=confusion_matrix(y_test,y_pred_lr)\nplt.figure(figsize=(3,3))\nplt.title(\"Confusion Matrix Map\")\nsns.heatmap(lr_cm,annot=True,cbar=False)\nplt.show()","1624b3af":"from sklearn.svm import SVC\nsvc=SVC(kernel='rbf',random_state=0)\nsvc.fit(x_train,y_train)\nacc_svc=svc.score(x_test,y_test)*100\nprint(\"Test Accuracy = {:.3f} %\".format(acc_svc))\ny_pred_svm=svc.predict(x_test)","0a375ad0":"# Confusion Matrix\n\nsvm_cm=confusion_matrix(y_test,y_pred_svm)\nplt.figure(figsize=(3,3))\nplt.title(\"Confusion Matrix Map\")\nsns.heatmap(svm_cm,annot=True,cbar=False)\nplt.show()","964d5a3b":"from sklearn.naive_bayes import BernoulliNB\nbnb=BernoulliNB()\nbnb.fit(x_train,y_train)\nacc_bnb=bnb.score(x_test,y_test)*100\nprint(\"Test Accuracy = {:.3f} %\".format(acc_bnb))\ny_pred_bnb=bnb.predict(x_test)","0506e6d2":"# Confusion Matrix\n\nsvm_bnb=confusion_matrix(y_test,y_pred_bnb)\nplt.figure(figsize=(3,3))\nplt.title(\"Confusion Matrix Map\")\nsns.heatmap(svm_bnb,annot=True,cbar=False)\nplt.show()","d8add07a":"from sklearn.neighbors import KNeighborsClassifier\nknn=KNeighborsClassifier(n_neighbors=8,metric=\"minkowski\")\nknn.fit(x_train,y_train)\nacc_knn=knn.score(x_test,y_test)*100\nprint(\"Test Accuracy = {:.3f} %\".format(acc_knn))\ny_pred_knn=knn.predict(x_test)","bf5963dd":"# Confusion Matrix\nknn_cm=confusion_matrix(y_test,y_pred_lr)\nplt.figure(figsize=(3,3))\nplt.title(\"Confusion Matrix Map\")\nsns.heatmap(knn_cm,annot=True,cbar=False)\nplt.show()","2381d525":"from sklearn.tree import DecisionTreeClassifier\ndtc=DecisionTreeClassifier(random_state=0,criterion='entropy',splitter='random')\ndtc.fit(x_train,y_train)\nacc_dtc=dtc.score(x_test,y_test)*100\nprint(\"Test Accuracy = {:.3f} %\".format(acc_dtc))\ny_pred_dtc=dtc.predict(x_test)","09010d38":"# Confusion Matrix\ndtc_cm=confusion_matrix(y_test,y_pred_dtc)\nplt.figure(figsize=(3,3))\nplt.title(\"Confusion Matrix Map\")\nsns.heatmap(dtc_cm,annot=True,cbar=False)\nplt.show()","5c6ec191":"from sklearn.ensemble import RandomForestClassifier\nrf=RandomForestClassifier(n_estimators=10,random_state=0)\nrf.fit(x_train,y_train)\nacc_rf=rf.score(x_test,y_test)*100\nprint(\"Test Accuracy = {:.3f} %\".format(acc_rf))\ny_pred_rf=rf.predict(x_test)","1b54c05b":"# Confusion Matrix\n\nsvm_rf=confusion_matrix(y_test,y_pred_rf)\nplt.figure(figsize=(3,3))\nplt.title(\"Confusion Matrix Map\")\nsns.heatmap(svm_rf,annot=True,cbar=False)\nplt.show()","17d75d91":"from sklearn.metrics import roc_curve, auc\n\ny_preds=[y_pred_lr,y_pred_svm,y_pred_bnb,y_pred_knn,y_pred_dtc,y_pred_rf]\n\nfp_rate=[]\ntp_rate=[]\nthresholds=[]\nroc_auc=[]\nfor i in y_preds:\n    fp,tp,th = roc_curve(y_test, i)\n    fp_rate.append(fp)\n    tp_rate.append(tp)\n    thresholds.append(th)\n    roc_auc.append(100*auc(fp,tp))\n\nmodel_list=[\"Logistic Regression\", \"Support Vector Machine\", \"Naive Bayes\",\"K-NN\",\"Decision Tree\",\"Random Forest\"]\naccuracy_values=[acc_log_reg,acc_svc,acc_bnb,acc_knn,acc_dtc,acc_rf]","0e28e2ce":"fig=go.Figure()\nfig.add_trace(go.Scatter(x=[0,1], y=[0,1],\n                    mode='lines',\n                    line = dict(color='royalblue', width=4, dash='dash')))\nfor j in range(len(model_list)):\n    fig.add_trace(go.Scatter(x=fp_rate[j], y=tp_rate[j],\n                    mode='lines+markers',\n                    name=model_list[j]))\nfig.show()","cce3ceda":"figbar = go.Figure(data=[\n    go.Bar(name='Accuracy', x=model_list, y=accuracy_values),\n    go.Bar(name='AUC', x=model_list, y=roc_auc)\n])\n# Change the bar mode\nfigbar.update_layout(barmode='group')\nfigbar.show()","0e997480":"> # Data Exploration","8d63891d":"> # K-Nearest Neighbors (K-NN)","22466c67":"> # Naive Bayes","a1ac3ff0":"> # Train Test Split","d16e4d4f":"> # Introduction","aaecf3fa":"*Confusion Matrix*","eca47e85":"**Accuracy and AUC (Area Under Curve) Scores**","27afdade":"*Confusion Matrix*","588e4ba0":"Let's split the data into two for training and testing:","c008a467":"**6-) Cholesterol Values Swarmplot (Distribution)**","9d3fcc6b":"**2-) Age Histogram**","6d2bb5e9":"**Attribute Information in Data:**\n*     **age:** age of the person\n*     **sex:** 0:female and 1:male\n*     cp: chest pain type (4 values)\n*     trestbps: resting blood pressure\n*     chol: serum cholestoral in mg\/dl\n*     fbs: fasting blood sugar > 120 mg\/dl\n*     **restecg:** resting electrocardiographic results (values 0,1,2)\n*     **thalach:** maximum heart rate achieved\n*     **exang:** exercise induced angina\n*     **oldpeak:** ST depression induced by exercise relative to rest\n*     **slope:** the slope of the peak exercise ST segment\n*     **ca:** number of major vessels (0-3) colored by flourosopy\n*     **thal:** 3 = normal; 6 = fixed defect; 7 = reversable defect","e8f2b3fe":"*Confusion Matrix*","3376297b":"*Confusion Matrix*","334f2e6f":"**ROC (Receiver Operating Characteristic) Curves**","162935e3":"> # Read Data","2c27ed1e":"> # Decision Tree","d308e754":"*Confusion Matrix*","ce98b972":"**4-) Gender Distribution of those with Heart Disease**","6000f99e":"> # Support Vector Machine (SVM)","05171b86":"> # Data Preprocessing","97e2b1a5":"> # Random Forest","bda8f8c4":"**1-) Total Distribution by Gender**","14484ddf":"**0-) Correlation Map:**","c088d988":"**3-) Have Heart Disease \/ not Have**","9a1d7f51":"**5-) Age Histogram of Those with Heart Disease**","b624d463":"In this study; first, I will try to analysis and visualize the Heart Diseases UCI data we have. Then I will try to diagnose the patient or not by using different ML algorithms on the data. And finally, I will compare the results I got from the different algorithms I used.","04573ba1":"*Confusion Matrix*","62dd8192":"> # Logistic Regression","d59b1577":"> # Comparing ML Models"}}