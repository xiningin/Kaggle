{"cell_type":{"ed20657a":"code","24feec3f":"code","a58dc67d":"code","7660af96":"code","e3415597":"code","8a483670":"code","62c99540":"code","1a3ec4bf":"code","262fbb88":"code","1036ced5":"code","1079333e":"code","a6f16b92":"code","04e7045d":"code","970f2d1d":"markdown"},"source":{"ed20657a":"import tensorflow as tf\nfrom tensorflow import keras\nfrom tensorflow.keras import layers\nfrom keras.layers import Dense\nfrom tensorflow.keras.layers import Dense,Dropout\nimport pandas as pd\nimport numpy as np","24feec3f":"model = keras.Sequential()\nmodel.add(Dense(10,input_dim=7,activation='relu'))\nmodel.add(Dropout(0.5))\nmodel.add(Dense(15,activation='relu'))\nmodel.add(Dropout(0.5))\nmodel.add(Dense(12,activation='relu'))\nmodel.add(Dropout(0.5))\nmodel.add(Dense(8,activation='relu'))\nmodel.add(Dropout(0.5))\nmodel.add(Dense(5,activation='relu'))\nmodel.add(Dropout(0.5))\n\nmodel.add(Dense(1,activation='sigmoid'))\n# Compile model\nmodel.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])\n","a58dc67d":"titanic_train = pd.read_csv(\"..\/input\/titanic-cleaned-data\/train_clean.csv\")\ntitanic_test_input = pd.read_csv(\"..\/input\/titanic-cleaned-data\/test_clean.csv\")\ntitanic_test_output = pd.read_csv(\"..\/input\/titaniccsv\/titanic.csv\")","7660af96":"titanic_train.loc[titanic_train['Sex'] == 'male', 'Sex'] = 0\ntitanic_train.loc[titanic_train['Sex'] == 'female', 'Sex'] = 1\n\ntitanic_test_input.loc[titanic_test_input['Sex'] == 'male', 'Sex'] = 0\ntitanic_test_input.loc[titanic_test_input['Sex'] == 'female', 'Sex'] = 1\n\ntitanic_array_train = titanic_train.values\ntitanic_test_input_array = titanic_test_input.values","e3415597":"titanic_test_output_array = titanic_test_output.values","8a483670":"#I've decided to use these features:\n#Age (0), Fare(3), Parch(5), Pclass(7), Sex(8), SibSp(9) and family_size(13)\n\ntitanic_train_X = titanic_array_train[:,[0,3,5,7,8,9,13]]\ntitanic_train_X= titanic_train_X.astype('float')\ntitanic_train_y = titanic_array_train[:,[10]]\ntitanic_train_y= titanic_train_y.astype('float')\n\ntitanic_test_X = titanic_test_input_array[:,[0,3,5,7,8,9,13]]\ntitanic_test_X = titanic_test_X.astype('float')\ntitanic_test_y = titanic_test_output_array[:,[1]]\ntitanic_test_y = titanic_test_y.astype('float')","62c99540":"len(titanic_train_y)","1a3ec4bf":"len(titanic_test_y)","262fbb88":"model.fit(titanic_train_X, titanic_train_y, batch_size=5, epochs=1000)","1036ced5":"titanic_prediction = model.predict_classes(titanic_test_X)","1079333e":"mismatching_count = 0\n\n#mismatching_count\nfor i in range(len(titanic_test_y)):\n    if titanic_test_y[i] != titanic_prediction[i]:\n       mismatching_count+=1\nmatching = len(titanic_test_y) - mismatching_count\nprecision = matching\/len(titanic_test_y)\n\nprint(precision)","a6f16b92":"titanic_test_y.shape","04e7045d":"unique, counts = np.unique(titanic_test_y, return_counts=True)\ndict(zip(unique, counts))","970f2d1d":"Autore: Daniele Berto (1163243)\n\nHo provato a implementare una rete neurale per il Titanic Dataset.\n\nCon 1000 epoche, d\u00e0 una precisione superiore all'80%: pi\u00f9 di quella che avevo ottenuto con un semplice decision tree.\n\nIl Titanic dataset \u00e8 un esempio lampante di come il bias nella scelta delle features sia determinante: occorre anche conoscere il campo di applicazione dei modelli.\n\nSono curioso di capire come era strutturata la soluzione che vinse la corrispondente competizione su Kaggle."}}