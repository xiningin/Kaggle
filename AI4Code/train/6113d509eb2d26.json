{"cell_type":{"224b1771":"code","1f258ba5":"code","e133eba4":"code","d626b339":"code","7b7ceedd":"code","8a4a309a":"code","885a0488":"code","4d80642c":"code","26581495":"code","356258e5":"code","9bc5429d":"code","d6639571":"code","3974816c":"code","618d551d":"code","8b91da26":"code","072dc878":"code","3bea0b91":"code","1d653509":"code","d7cc5514":"markdown","9b08cfab":"markdown","047add08":"markdown","6aa1fcef":"markdown","17e4106f":"markdown","3d6bcc1b":"markdown","b86fc453":"markdown"},"source":{"224b1771":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport pathlib\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nimport gc\nprint(os.listdir(\"..\/input\"))\n\nfrom sklearn.metrics import confusion_matrix\nfrom fastai import *\nfrom fastai.vision import *\n\n# Any results you write to the current directory are saved as output.","1f258ba5":"DATA_DIR='..\/input\/oregon_wildlife\/oregon_wildlife'","e133eba4":"os.listdir(f'{DATA_DIR}')","d626b339":"torch.cuda.is_available()","7b7ceedd":"data = ImageDataBunch.from_folder(DATA_DIR, \n                                  train=\"\",\n                                  valid_pct=0.2,\n                                  ds_tfms=get_transforms(flip_vert=True, max_warp=0),\n                                  size=224,bs=128, \n                                  num_workers=0).normalize(imagenet_stats)","8a4a309a":"print(f'Classes: \\n {data.classes}')","885a0488":"data.show_batch(rows=3, figsize=(7,6))","4d80642c":"learn = create_cnn(data, models.resnet34, metrics=accuracy, model_dir=\"\/tmp\/model\/\")","26581495":"learn.fit_one_cycle(6,1e-2)","356258e5":"learn.save('stage-1')","9bc5429d":"learn.unfreeze()","d6639571":"learn.lr_find()\nlearn.recorder.plot()","3974816c":"learn.fit_one_cycle(6, max_lr=slice(1e-6,1e-4 ))","618d551d":"learn.save('stage-2')","8b91da26":"learn.recorder.plot_losses()","072dc878":"interp = ClassificationInterpretation.from_learner(learn)","3bea0b91":"interp.plot_top_losses(9, figsize=(15,11))","1d653509":"interp.plot_confusion_matrix(figsize=(8,8), dpi=60)","d7cc5514":"## Please upvote if you like it ;)","9b08cfab":"# Train","047add08":"# Import Libraries","6aa1fcef":"# Model Build","17e4106f":"# Make Data","3d6bcc1b":"## Please upvote if you like it ;)","b86fc453":"# Check Result"}}