{"cell_type":{"adbbaf93":"code","609bd6d5":"code","83d1ecd6":"code","e05f2a5c":"code","a0beeef2":"code","db499bf1":"code","d82cc094":"code","1bcc4b17":"code","0885ffc5":"code","4140dfd9":"code","f2b5942e":"code","8b961e82":"code","19f6cf0a":"code","94b5cac2":"code","a1d83f87":"code","416fa2fd":"code","694111dd":"code","e360aa99":"code","322077f7":"code","47357cb1":"code","c71768e2":"code","7d4e3c2f":"code","3b1f3ca9":"code","8752ef39":"code","8ae835b7":"markdown"},"source":{"adbbaf93":"#import libraries\nimport numpy as np\nimport pandas as pd\nimport tensorflow as tf","609bd6d5":"#importing dataset\ndataset = pd.read_csv('..\/input\/churn-modelling\/Churn_Modelling.csv - Churn_Modelling.csv.csv')","83d1ecd6":"dataset","e05f2a5c":"#basic dataset information\ndataset.info()","a0beeef2":"#dimention of the dataset\ndataset.shape","db499bf1":"#basic statistics symmary\ndataset.describe().T","d82cc094":"#checking for missing values\nprint(str('Any missing data or NaN in the dataset:'),dataset.isnull().values.any())","1bcc4b17":"#finding correlation between the features\nimport matplotlib.pyplot as plt\nimport seaborn as sns\ncorr_var=dataset.corr()\nprint(corr_var)\nplt.figure(figsize=(10,7.5))\nsns.heatmap(corr_var, annot=True, cmap='YlGnBu')","0885ffc5":"#as there is no importance in cust id, row no and sur name for modelling we are not included here in independent feature\nX = dataset.iloc[:, 3:-1].values\n#target value\ny = dataset.iloc[:, -1].values","4140dfd9":"#independent features\nprint(X)","f2b5942e":"#dependent features\nprint(y)","8b961e82":"#as we have two columns as categorical terms we go for encoding we need to convert to numericals\n#Categorical encoding\n\n#gender will have some correlation with other feature so we go for label encoding\nfrom sklearn.preprocessing import LabelEncoder\nle = LabelEncoder()\n#gender column in index 2\nX[:, 2] = le.fit_transform(X[:, 2])\nprint(X)","19f6cf0a":"#country name wont be that much correlation added it has more than 2 names so go for one hot encoding\nfrom sklearn.compose import ColumnTransformer\nfrom sklearn.preprocessing import OneHotEncoder\n#country name is present in 1st index value\nct = ColumnTransformer(transformers=[('encoder', OneHotEncoder(), [1])], remainder='passthrough')\nX = np.array(ct.fit_transform(X))\nprint(X)","94b5cac2":"#training and testing split\nfrom sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.3, random_state = 0)","a1d83f87":"#feature scaling is an important and mandatory for ann process before modelling\nfrom sklearn.preprocessing import StandardScaler\nsc = StandardScaler()\nX_train = sc.fit_transform(X_train)\nX_test = sc.transform(X_test)","416fa2fd":"#ANN - initializing\nann = tf.keras.models.Sequential()","694111dd":"#input layer\n# 6 features\nann.add(tf.keras.layers.Dense(units=6, activation='relu'))","e360aa99":"#hidden layer\nann.add(tf.keras.layers.Dense(units=6, activation='relu'))","322077f7":"#output layer\n#as target value is binary - AF\nann.add(tf.keras.layers.Dense(units=1, activation='sigmoid'))","47357cb1":"#compiling\n#loss - target is binary \nann.compile(optimizer = 'adam', loss = 'binary_crossentropy', metrics = ['accuracy'])","c71768e2":"#training set\nann.fit(X_train, y_train, batch_size = 32, epochs = 50)","7d4e3c2f":"#test result - prediction\ny_pred = ann.predict(X_test)\n#insted of values we ll get 0 or 1\ny_pred = (y_pred > 0.5)\n#actual vs prediicted outputs\nprint(np.concatenate((y_pred.reshape(len(y_pred),1), y_test.reshape(len(y_test),1)),1))","3b1f3ca9":"#accuracy and confusion matrix\nfrom sklearn.metrics import confusion_matrix, accuracy_score\ncm = confusion_matrix(y_test, y_pred)\nprint(cm)\naccuracy_score(y_test, y_pred)","8752ef39":"#for predicting single sample\nprint(ann.predict(sc.transform([[1, 0, 0, 750, 0, 48,53, 62500, 3, 1, 1, 80000]])) > 0.5)","8ae835b7":"Use our ANN model to predict if the customer with the following informations will leave the bank:\n\nGeography: France\n\nCredit Score: 750\n\nGender: Female\n\nAge: 48 years old\n\nTenure: 5 years\n\nBalance: $ 62500\n\nNumber of Products: 3\n\nDoes this customer have a credit card ? Yes\n\nIs this customer an Active Member: Yes\n\nEstimated Salary: $ 80000\n\nSo, should we say goodbye to that customer ?"}}