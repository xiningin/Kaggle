{"cell_type":{"5aae0fad":"code","d0c013d0":"code","2aac6ad5":"code","eb19793e":"code","de085f14":"code","61bc6959":"code","81418e4c":"code","6445b4db":"code","06f0735b":"code","31851681":"code","9134861e":"code","a8ac90b2":"code","de73972b":"code","4fcab8bf":"code","f1e326b0":"code","c67184a0":"code","8a0e3c52":"code","2106fbc2":"code","157f242f":"code","feaae18d":"code","959a1b4e":"code","44603a5d":"code","0e5782a3":"code","79c282ab":"code","43bc6bcc":"code","406e167a":"code","c20fafd0":"code","f30c78f5":"code","affa0a91":"code","cd4853a7":"code","9573e03d":"code","1fca17a5":"code","cb84cbf1":"code","107be614":"code","5de33d35":"code","9c18282f":"code","4d0de8b3":"code","453e31f4":"code","cfa73569":"code","548935e3":"code","918a41e5":"code","1ffc05a7":"code","283132d2":"code","6195257b":"code","64b0a4db":"markdown","73c42088":"markdown","4e213fdd":"markdown","dd0573f6":"markdown","905136ca":"markdown","6cd90152":"markdown","87ac30a7":"markdown","c1941dd3":"markdown","44290032":"markdown","3c44b4ce":"markdown","4051d76b":"markdown","d7f1d167":"markdown","272400a7":"markdown","effd1884":"markdown","542632c3":"markdown","164ca425":"markdown","6b61180a":"markdown","b27ca045":"markdown","4d92478b":"markdown","4c27d600":"markdown","b38187d2":"markdown","43b037f7":"markdown","2b4e247c":"markdown"},"source":{"5aae0fad":"import pandas as pd\nimport numpy as np\n\ntrain = pd.read_csv('\/kaggle\/input\/tabular-playground-series-jul-2021\/train.csv')\ntest = pd.read_csv('\/kaggle\/input\/tabular-playground-series-jul-2021\/test.csv')","d0c013d0":"train.head()","2aac6ad5":"test.head()","eb19793e":"sub = pd.read_csv(\"..\/input\/tabular-playground-series-jul-2021\/sample_submission.csv\")\nsub.head()","de085f14":"print(train.shape)\nprint(test.shape)","61bc6959":"import warnings\nwarnings.filterwarnings(action='ignore')\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline","81418e4c":"import plotly.express as px\nfig = px.scatter(train, color=\"target_carbon_monoxide\", x=\"absolute_humidity\", y = 'target_carbon_monoxide',\n                 hover_data=['target_carbon_monoxide'])\nfig.show()","6445b4db":"fig = px.scatter(train, color=\"target_carbon_monoxide\", x=\"deg_C\", y = 'target_carbon_monoxide',\n                 hover_data=['relative_humidity'])\nfig.show()","06f0735b":"fig = px.line(train, x='date_time', y='target_carbon_monoxide')\nfig.show()","31851681":"fig = px.scatter(train, color=\"target_benzene\", x=\"deg_C\", y = 'target_benzene',\n                 hover_data=['relative_humidity'])\nfig.show()","9134861e":"fig = px.scatter_matrix(train,\n    dimensions=[\"sensor_1\", \"sensor_2\", \"sensor_3\", \"sensor_4\", \"sensor_5\"],\n    color=\"target_benzene\")\nfig.show()","a8ac90b2":"fig = px.scatter_matrix(train,\n    dimensions=[\"sensor_1\", \"sensor_2\", \"sensor_3\", \"sensor_4\", \"sensor_5\"],\n    color=\"target_carbon_monoxide\")\nfig.show()","de73972b":"fig = px.scatter_matrix(train,\n    dimensions=[\"sensor_1\", \"sensor_2\", \"sensor_3\", \"sensor_4\", \"sensor_5\"],\n    color=\"target_nitrogen_oxides\")\nfig.show()","4fcab8bf":"sns.jointplot(\n    data=train,\n    x=\"target_carbon_monoxide\", y=\"target_benzene\",\n)","f1e326b0":"sns.jointplot(\n    data=train,\n    x=\"target_carbon_monoxide\", y=\"target_nitrogen_oxides\",\n)","c67184a0":"sns.jointplot(\n    data=train,\n    x=\"target_benzene\", y=\"target_nitrogen_oxides\",\n)","8a0e3c52":"f, ax = plt.subplots()\nsns.violinplot(data=train[[\"sensor_1\", \"sensor_2\", \"sensor_3\", \"sensor_4\", \"sensor_5\"]])\nsns.despine(offset=10, trim=True);","2106fbc2":"f, ax = plt.subplots()\nsns.violinplot(data=test[[\"sensor_1\", \"sensor_2\", \"sensor_3\", \"sensor_4\", \"sensor_5\"]])\nsns.despine(offset=10, trim=True);","157f242f":"fig = px.box(train, x=\"target_carbon_monoxide\", points=\"all\")\nfig.show()","feaae18d":"fig = px.box(train, x=\"target_benzene\", points=\"all\")\nfig.show()","959a1b4e":"fig = px.box(train, y=\"target_nitrogen_oxides\", points=\"all\")\nfig.show()","44603a5d":"sns.displot(train, x=\"sensor_1\", kde = True, color ='r')","0e5782a3":"sns.displot(train, x=\"sensor_2\", kde = True, color ='b')","79c282ab":"sns.displot(train, x=\"sensor_3\", kde = True, color ='y')","43bc6bcc":"sns.displot(train, x=\"sensor_4\", kde = True, color ='g')","406e167a":"sns.displot(train, x=\"sensor_5\", kde = True, color ='k')","c20fafd0":"sns.displot(train, x=\"target_carbon_monoxide\", kde = True, color ='b')","f30c78f5":"sns.displot(train, x=\"target_benzene\", kde = True, color ='c')","affa0a91":"sns.displot(train, x=\"target_nitrogen_oxides\", kde = True, color ='r')","cd4853a7":"sns.jointplot(data=train, x=\"absolute_humidity\", y=\"relative_humidity\", kind = 'kde')","9573e03d":"sns.jointplot(data=train, x=\"absolute_humidity\", y=\"relative_humidity\")","1fca17a5":"sns.pairplot(train)","cb84cbf1":"sns.pairplot(test)","107be614":"sns.displot(train, x=\"sensor_1\", kde = True, color ='g')","5de33d35":"sns.displot(train, x=\"sensor_2\", kde = True, color ='b')","9c18282f":"sns.displot(train, x=\"sensor_3\", kde = True, color ='c')","4d0de8b3":"sns.displot(train, x=\"sensor_4\", kde = True, color ='y')","453e31f4":"sns.displot(train, x=\"sensor_5\", kde = True, color ='r')","cfa73569":"sns.displot(train, x=\"deg_C\", kde = True, color ='k')","548935e3":"sns.jointplot(data=test, x=\"absolute_humidity\", y=\"relative_humidity\")","918a41e5":"columns = test.columns[1:]\nX = train[columns].values\nX_test = test[columns].values\n\n#Since we are to predict 3 targets so we are setting target 1,2,3\n#Reshaping otherwise it will throw an error\ntarget_1 = train['target_carbon_monoxide'].values.reshape(-1,1)\ntarget_2 = train['target_benzene'].values.reshape(-1,1)\ntarget_3 = train['target_nitrogen_oxides'].values.reshape(-1,1)","1ffc05a7":"from xgboost import XGBRegressor","283132d2":"#Helpful code snippet by Grandmaster Bojan Tunguz\nxgb = XGBRegressor()\nxgb.fit(X, target_1)\nsub['target_carbon_monoxide'] = xgb.predict(X_test)\n\nxgb.fit(X, target_2)\nsub['target_benzene'] = xgb.predict(X_test)\n\nxgb.fit(X, target_3)\nsub['target_nitrogen_oxides'] = xgb.predict(X_test)\n\nsub.head()","6195257b":"sub.to_csv('submission with XGBoost.csv', index=False)","64b0a4db":"# Distribution and KDE plots of train","73c42088":"A strong correlation exists between carbon monoxide and nitrogen oxides","4e213fdd":"# Data exploration and relations with scatter matrix and jointplots","dd0573f6":"Both absolute humidity and relative humidity forms close to normal distributions.","905136ca":"# Distribution plots and KDE of test","6cd90152":"Upto benzene level 30 there is a very strong correlation between benzene and nitrogen oxides","87ac30a7":"# Modelling","c1941dd3":"A complete relationship can be seen between relative humidity and absolute humidity with their proper kde plots","44290032":"In test set too we can see there is a relationship between absolute humidity and relaitve humidity","3c44b4ce":"Between 10 and 30 degree celsius benzene is highest. A maximum of 50.5 can be seen at temperature 23.4 and 12.9 with relative humidity 60.3 and 74.1 respectively.","4051d76b":"With higher the value of sensor 1,2,4,5 the higher the benzene level.\nBut the lower the value of sensor 3 the higher the benzen level.","d7f1d167":"Violin plots of sensors in train set","272400a7":"As temperature rises above 30 degree the level of carbon monoxide decreases. The level of carbon monoxide is highest between 10 and 20.","effd1884":"Carbon Monoxide reaches it's highest level in Nov 23 2010. The value is 12.5.\nIn majority the carbon monoxide level is 6 or below 6.","542632c3":"When absolute humidity is above 2 then carbon monoxide level is very low, but when absolute humidity is in range 1 to 1.5 the carbon monoxide level reaches as high as 12.5.\n\nMove the cursor around the diagram to get the details.","164ca425":"# Upvote if you like it or fork it :)","6b61180a":"All the relations with their correlations and distributions can be seen here.","b27ca045":"Different Carbon Monoxide level in different range.","4d92478b":"Move the cursor around the diagram to get the values.","4c27d600":"Not much considerable difference between train and test sensor plots.","b38187d2":"# Pairplot","43b037f7":"# Violin plots and boxplots","2b4e247c":"Carbon monoxide and benzene have nearly perfect correlation"}}