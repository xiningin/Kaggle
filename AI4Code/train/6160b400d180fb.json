{"cell_type":{"8b780981":"code","ebd5edc4":"code","621b01fd":"code","e81243b6":"code","dbe1ecc5":"code","22d92f90":"code","3c9cc1f4":"code","21f6c5ed":"code","a56de7b4":"code","402d64df":"code","8bd1e23a":"code","d6e56801":"code","29da4348":"code","3fc8ecee":"code","9645c9a4":"code","329eda8f":"code","77e3bde4":"code","056fbef3":"code","483f049d":"code","a7c4104d":"code","f37aad12":"code","e74d3b10":"code","0fe52145":"markdown","b7e94991":"markdown","89e172ad":"markdown","40ad5e4e":"markdown","a5d7e954":"markdown","113b4a6d":"markdown","e85b554a":"markdown","96133c8c":"markdown","ed377fb7":"markdown","8ab610a3":"markdown","11e82f64":"markdown","2b209139":"markdown","fb93d498":"markdown","145913cb":"markdown","9422b215":"markdown","50fa85b9":"markdown","021a55e6":"markdown","a8fce0c1":"markdown","eff8f92f":"markdown","061265bc":"markdown","d1588b17":"markdown"},"source":{"8b780981":"import pandas as pd","ebd5edc4":"df = pd.read_csv(\"..\/input\/netflix-shows\/netflix_titles.csv\")","621b01fd":"df.isnull().sum()","e81243b6":"df[\"release_year\"].hist(bins=50)","dbe1ecc5":"df[\"country\"].value_counts()","22d92f90":"df[\"country_number\"] = df[\"country\"].str.split(',').str.len()\ndf[\"country_number\"].describe()","3c9cc1f4":"d = df[\"country\"].str.split(',', expand=True)\nd.columns = [\"country1\", \"country2\", \"country3\", \"country4\", \"country5\", \"country6\", \"country7\", \"country8\",\n             \"country9\", \"country10\", \"country11\", \"country12\"]","21f6c5ed":"df = pd.concat([df, d], axis=1)","a56de7b4":"df[\"country1\"].value_counts()[:15].plot(kind=\"bar\")","402d64df":"df[\"type\"].value_counts().plot(kind=\"bar\")","8bd1e23a":"by_country = df[[\"country1\", \"type\"]].groupby([\"country1\", \"type\"]).size().reset_index(name=\"count\").pivot(index=\"country1\", columns=\"type\", values=\"count\")\nby_country[\"total\"] = by_country.sum(axis=1)\nby_country.sort_values(\"total\", ascending=False)[:15].drop(\"total\", axis=1).plot(kind=\"bar\")","d6e56801":"df[\"director\"].value_counts()","29da4348":"df[\"director_number\"] = df[\"director\"].str.split(',').str.len()\ndf[\"director_number\"].describe()","3fc8ecee":"df[[\"title\"]][df[\"director_number\"] > 5].size","9645c9a4":"d = df[\"director\"].str.split(',', expand=True)\n# i just want the name of the first\nd = d.iloc[:, 0]\nd.rename(\"director1\", inplace=True)\ndf = pd.concat([df, d], axis=1)\ndf[\"director1\"].value_counts()[:10].plot(kind=\"bar\")","329eda8f":"df[\"date_added\"].head()","77e3bde4":"df[\"date_added\"] = pd.to_datetime(df[\"date_added\"])","056fbef3":"df.groupby(\"date_added\").size().plot(kind=\"line\")","483f049d":"df[df[\"date_added\"] > pd.Timestamp(2016, 1, 1)].groupby(\"date_added\").size().plot(kind=\"line\")","a7c4104d":"release_year = df[\"release_year\"].apply(lambda x: pd.Timestamp(x, 7, 1))\n# now get the difference between date added and date released for each movie\ndf[\"time_to_add\"] = (df[\"date_added\"] - release_year).dt.days\ndf.groupby(\"time_to_add\").size().plot(kind=\"line\")","f37aad12":"df[df[\"time_to_add\"] < 5000].groupby(\"time_to_add\").size().plot(kind=\"line\")","e74d3b10":"df[\"rating\"].value_counts().plot(kind=\"bar\")","0fe52145":"There are missing values in the data set. Since we are only visualizing, no need to remove these records. They will be automatically disregarded when we produce the graphs.\n\nLet us look at the release year:","b7e94991":"Many movies and series are less than one year old when they are released.\n\nFinally, let us look at the ratings to see the largest category on Netflix:","89e172ad":"It would make sense to convert the type to date:","40ad5e4e":"We now plot:","a5d7e954":"Most movies tend to have been released not so long ago.\n\nlet us look at the countries:","113b4a6d":"We now add the new columns to our data frame:","e85b554a":"Most are movies, but there are a lot of series. Let us see if this is true for most countries:","96133c8c":"Most movies were produced in a single country\n\nlet us create separate columns for each country in the list:","ed377fb7":"It seems that in most countries more movies are produced than series. \n\nLet us now look at the directors:","8ab610a3":"There are in fact 13 titles with more than five directors. Let us get the names of these directors:","11e82f64":"Check for missing values:","2b209139":"Read the data:","fb93d498":"We see that in some cases there is more than one director. Let us get the number of directors in each movie:","145913cb":"The vast majority are less than 5000 days old. Let us zoom in on that area:","9422b215":"Let us look at date the movie or series was added:","50fa85b9":"Some movies are produced in more than one country. Create a variable to store the number of countries in which a movie was produced:","021a55e6":"Let us look at the types of the offerings:","a8fce0c1":"Most were added after 2016. Let us zoom in on that part of the graph:","eff8f92f":"We see that there is a peak around the year 2020.\n\nAn interesting thing to check is whether the movies and series are released soon after they are produced or whether they are \"old\". To check this, we subtract the year of date added and the year of date released. First assume that movies were released in the middle of the year since the information is not provided:","061265bc":"Seems that there were movies\/series with many directors. Let us take a closer look:","d1588b17":"Now we look at the first countries (top 15 countries):"}}