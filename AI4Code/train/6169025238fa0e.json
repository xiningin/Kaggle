{"cell_type":{"6416e635":"code","9f5a9a37":"code","d6d734ec":"code","817c8722":"code","e00e661a":"code","2e5275b3":"markdown","0b31ec87":"markdown"},"source":{"6416e635":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n\nfrom os import listdir\nfrom os.path import isfile, join\nfrom tzlocal import get_localzone\nfrom datetime import datetime ","9f5a9a37":"DATA_DIR = '\/kaggle\/input\/10-days-radiation-measurements-at-living-house'","d6d734ec":"data_files = []\n\nfor f in listdir(DATA_DIR):\n    if isfile(join(DATA_DIR, f)) \\\n        and f.endswith('.csv'):\n        data_files.append(f)\n\nprint('Source data files:')\nfor f in data_files: print(f)","817c8722":"mean_dose = []\ndates = []\nfor f in data_files:\n    mse = pd.read_csv(join(DATA_DIR, f), sep=';')\n    mse[mse.columns[0]] = pd.to_datetime(mse[mse.columns[0]], \n                                         unit='ms', \n                                         utc=True)\n    mse[mse.columns[0]] = mse[mse.columns[0]]\\\n        .apply(lambda dt: dt.astimezone(get_localzone()))\n    mse[mse.columns[1]] = mse[mse.columns[1]]\\\n        .apply(lambda val: float(val.replace(',', '.')))\n    edge_date = datetime\\\n        .strptime(f.split('_')[1]\n        .split('.csv')[0], '%d.%m.%Y')\\\n        .replace(hour=15, minute=0)\\\n        .astimezone(get_localzone())\n    filtered_mse = mse[mse[mse.columns[0]] < edge_date]\n    dates.append(edge_date)\n    mean_dose.append(filtered_mse.iloc[:, [1]].values.mean())\n\ndates = np.asarray(dates).reshape(len(dates), 1)\nmean_dose = np.asarray(mean_dose).reshape(len(mean_dose), 1)\nmeans = np.concatenate((dates, mean_dose), axis=1)\nsorted_means = np.asarray(sorted(means, key=lambda x: x[0]))","e00e661a":"plt.figure(figsize=(13,4))\nplt.plot(sorted_means[:, 0], sorted_means[:, 1])\nplt.title('Radiation doses')\nplt.ylabel(mse.columns[1])\nplt.xlabel('date, days')\nplt.show()","2e5275b3":"Transform date format from unix time stamp to date and calculate mean doses","0b31ec87":"File listing"}}