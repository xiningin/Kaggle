{"cell_type":{"301e59d9":"code","b386d139":"code","2497e342":"code","840ef5aa":"code","287e48a3":"code","8cb18545":"code","c8e1220a":"code","d32a7a5c":"code","46a484c3":"code","908bafc4":"code","1d8f3c49":"code","ac74df14":"code","7eb9a814":"code","a4fd2c08":"code","930a8461":"code","90abdf11":"code","e8414497":"code","04c87f4a":"code","bbe7870f":"code","55e8647e":"code","f0b299e9":"code","19fc47d0":"code","e5247eb8":"code","11993ed8":"code","9659f9bd":"code","4ceb7423":"code","022794bb":"code","630168f6":"code","eba9c5f6":"code","0a438768":"code","dbf733ed":"code","e3e62ef4":"code","4efe9809":"code","0171aead":"code","cdaffd0a":"code","697f8315":"code","6da91c00":"code","d3793648":"code","ba6d6c48":"code","658c01c4":"code","44d3c7c6":"code","4aac86be":"code","000f83f9":"code","7242d1b3":"code","b1cb952f":"markdown","630e0b53":"markdown","cf89f84f":"markdown","740e11cf":"markdown","01558df2":"markdown","40e85bc1":"markdown","f7ade015":"markdown","a68cfab7":"markdown","bfe8c1fc":"markdown","c597fdf4":"markdown","73a35838":"markdown","a7109ebe":"markdown","77ead4fe":"markdown","4e90be6b":"markdown","55d0dc6f":"markdown","42670ba9":"markdown","e407533f":"markdown","f33a2d25":"markdown","735ba008":"markdown"},"source":{"301e59d9":"# Import necessary libraries\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport plotly.express as px\nimport plotly.graph_objects as go\nfrom plotly.subplots import make_subplots\nimport warnings\nwarnings.filterwarnings(\"ignore\")\nfrom sklearn import preprocessing\nfrom sklearn.model_selection import train_test_split\nimport missingno as msno\nfrom pylab import rcParams\n\n%matplotlib inline","b386d139":"PATH = \"..\/input\/crimes-in-boston\/crime.csv\"\n\ncrime = pd.read_csv(PATH, encoding = \"latin-1\")\ncrime.head()","2497e342":"crime.isna().sum()","840ef5aa":"crime.shape","287e48a3":"crime.info()","8cb18545":"crime.describe()","c8e1220a":"msno.matrix(crime);","d32a7a5c":"def missing_values_table(dataframe):\n    \n    # Take columns with only null values\n    variables_with_na = [col for col in dataframe.columns if dataframe[col].isnull().sum() > 0]\n    \n    # Sort them\n    n_miss = dataframe[variables_with_na].isnull().sum().sort_values(ascending=False)\n    \n    # Calculate their ratio\n    ratio = (dataframe[variables_with_na].isnull().sum() \/ dataframe.shape[0] * 100).sort_values(ascending=False)\n    \n    # Take their data types\n    dtypes = dataframe.dtypes\n    dtypesna = dtypes.loc[(np.sum(dataframe.isnull()) != 0)]\n    missing_df = pd.concat([n_miss, np.round(ratio, 2), dtypesna], axis=1, keys=['Null Values', 'Ratio', 'Dtype'])\n    \n    if len(missing_df)>0:\n        print(missing_df)\n        print(\"\\nThere are {} columns with missing values\\n\".format(len(missing_df)))\n    else:\n        print(\"\\nThere is no missing value\")","46a484c3":"missing_values_table(crime)","908bafc4":"crime[\"SHOOTING\"].fillna(\"N\", inplace = True)","1d8f3c49":"missing_values_table(crime)","ac74df14":"null_columns = crime.columns[crime.isna().any()]\ncrime[crime.isna().any(axis=1)][null_columns].tail(20)","7eb9a814":"crime[\"DISTRICT\"].value_counts()","a4fd2c08":"def value_count(data):\n    \n    for col in data.columns:\n        print(f\"{col} value counts: {data[col].value_counts().head()}\")\n        print(\"########################################################\")","930a8461":"value_count(crime)","90abdf11":"crime.loc[crime[\"INCIDENT_NUMBER\"] == 'I162030584']","e8414497":"crime.loc[crime['INCIDENT_NUMBER'] == 'I152080623']","04c87f4a":"crime[\"OCCURRED_ON_DATE\"] = pd.to_datetime(crime[\"OCCURRED_ON_DATE\"]) ","bbe7870f":"crime.apply(pd.Series.nunique)","55e8647e":"# Delete duplicate values\n\ncrime.drop_duplicates(subset = [\"INCIDENT_NUMBER\"], inplace = True)","f0b299e9":"crime.loc[crime['INCIDENT_NUMBER'] == 'I152080623']","19fc47d0":"# Rename long & capital letters features names\n\nrename = {'OFFENSE_CODE_GROUP' : 'Group',\n         'OFFENSE_DESCRIPTION' : 'Description',\n         'DAY_OF_WEEK' : 'Day',\n         'YEAR' : 'Year',\n         'MONTH' : 'Month',\n         'HOUR' : 'Hour',\n         'STREET' : 'Street',\n         'DISTRICT' : 'District',\n         'SHOOTING' : 'Shooting',\n         'OCCURRED_ON_DATE' : 'Date',\n         'REPORTING_AREA' : 'Area',\n         'OFFENSE_CODE' : 'Code'}\n\ncrime.rename(index = str, columns = rename, inplace = True)","e5247eb8":"crime.columns","11993ed8":"crime.Group = crime.Group.astype('category')\ncrime.Description = crime.Description.astype('category')\ncrime.Day = crime.Day.astype('category')\ncrime.UCR_PART = crime.UCR_PART.astype('category')\ncrime.District = crime.District.astype('category')","9659f9bd":"crime.info()","4ceb7423":"# Creating two new features\ncrime[\"Quarter\"] = crime[\"Date\"].dt.quarter\ncrime[\"Weekofyear\"] = crime[\"Date\"].dt.weekofyear\n\n#\u00a0Convert into categorical data type\ncrime[\"Quarter\"] = crime[\"Quarter\"].astype(\"category\")\ncrime[\"Weekofyear\"] = crime[\"Weekofyear\"].astype(\"category\")","022794bb":"crime.loc[crime['Lat'] == -1]","630168f6":"#\u00a0Specify columns to drop\ndrop = [\"INCIDENT_NUMBER\", 'Code', 'Description', 'Area', 'Location'] # Droping location since we have lat, and long\n\n# Drop the specified columns\ncrime.drop(drop, axis = 1, inplace = True)\n\n# Replace -1 with NaN in Lat, and Long columns\ncrime[\"Lat\"].replace(-1, np.nan, inplace = True)\ncrime[\"Long\"].replace(-1, np.nan, inplace = True)","eba9c5f6":"missing_values_table(crime)","0a438768":"# Set plot parameters\nplt.style.use(\"seaborn-darkgrid\")\nrcParams[\"figure.figsize\"] = 20,9\n\nsns.countplot(x = \"Month\", hue = \"Year\", data = crime)\nplt.title(\"Total Number of Crimes For Each Month (2015-2018)\", fontsize = 16, color = \"#5642C5\");","dbf733ed":"order = crime[\"Group\"].value_counts().head(5).index\nsns.countplot(data = crime, x = \"Group\", hue = \"District\", order = order)\nplt.title(\"Number of Crime Group For Each District\", fontsize = 16, color = \"#5642C5\");","e3e62ef4":"# Specifying the values to plot (year, month, day, hour, district, street)\nnoc_year = pd.DataFrame(data = crime[\"Year\"].value_counts().reset_index().values,\n                        columns = [\"year\", \"noc\"]).sort_values(\"year\").reset_index(drop = True)\nnoc_month = pd.DataFrame(data = crime[\"Month\"].value_counts().reset_index().values,\n                        columns = [\"month\", \"noc\"]).sort_values(\"month\").reset_index(drop = True)\nnoc_day = pd.DataFrame(data = crime[\"Day\"].value_counts().reset_index().values,\n                        columns = [\"day\", \"noc\"]).sort_values(\"day\").reset_index(drop = True)\nnoc_hour = pd.DataFrame(data = crime[\"Hour\"].value_counts().reset_index().values,\n                        columns = [\"hour\", \"noc\"]).sort_values(\"hour\").reset_index(drop = True)\nnoc_dist = pd.DataFrame(data = crime[\"District\"].value_counts().reset_index().values,\n                        columns = [\"dist\", \"noc\"])\nnoc_street = pd.DataFrame(data = crime[\"Street\"].value_counts().reset_index().values,\n                        columns = [\"street\", \"noc\"]).sort_values(\"noc\", ascending = False).reset_index(drop = True).head(30)\n\n# Create a subplot with 3 rows and 2 cols\nfig = make_subplots(rows = 3, cols = 2,\n                   specs = [[{\"type\" : \"scatter\"}, {\"type\" : \"scatter\"}], [{\"type\" : \"scatter\"},\n                             {\"type\" : \"scatter\"}], [{\"type\" : \"bar\"}, {\"type\" : \"bar\"}]],\n                   subplot_titles = (\"NOC per Year\", \"NOC per Month\", \"NOC per Day\", \"NOC per Hour\", \"NOC per District\", \"NOC per Street\"))\n\n# Plot the values\nfig.add_trace(go.Scatter(x = noc_year[\"year\"],\n                        y = noc_year[\"noc\"]), row = 1, col = 1)\nfig.add_trace(go.Scatter(x = noc_month[\"month\"],\n                        y = noc_month[\"noc\"]), row = 1, col = 2)\nfig.add_trace(go.Scatter(x = noc_day[\"day\"],\n                        y = noc_day[\"noc\"]), row = 2, col = 1)\nfig.add_trace(go.Scatter(x = noc_hour[\"hour\"],\n                        y = noc_hour[\"noc\"]), row = 2, col = 2)\nfig.add_trace(go.Bar(x = noc_dist[\"dist\"],\n                        y = noc_dist[\"noc\"]), row = 3, col = 1)\nfig.add_trace(go.Bar(x = noc_street[\"street\"],\n                        y = noc_month[\"noc\"]), row = 3, col = 2)\n\n# Update x axes parameters\nfig.update_xaxes(title_text=\"Year\", row=1, col=1)\nfig.update_xaxes(title_text=\"Month\", range=[0, 13], row=1, col=2)\nfig.update_xaxes(title_text=\"Day\", row=2, col=1)\nfig.update_xaxes(title_text=\"Hour\",row=2, col=2)\nfig.update_xaxes(title_text=\"District\", row=3, col=1)\nfig.update_xaxes(title_text=\"Street\", row=3, col=2)\n\n# Update y axes parameters\nfig.update_yaxes(title_text=\"Crime Count\", row=1, col=1)\nfig.update_yaxes(title_text=\"Crime Count\",row=1, col=2)\nfig.update_yaxes(title_text=\"Crime Count\", row=2, col=1)\nfig.update_yaxes(title_text=\"Crime Count\", row=2, col=2)\nfig.update_yaxes(title_text=\"Crime Count\", row=3, col=1)\nfig.update_yaxes(title_text=\"Crime Count\", row=3, col=2)\n\nfig.update_layout(showlegend=False,title_text=\"Distributions of Total NOC Between 2015-2018\", height=900)","4efe9809":"ucr_year = pd.DataFrame(data = (crime.groupby([\"Year\",\"UCR_PART\"]).count()[['Group']]).reset_index().values,\n                        columns= [\"year\",\"ucr_part\",\"noc\"]).sort_values('year').reset_index(drop=True)\n\npx.bar(ucr_year, x = \"year\", y = \"noc\", color = \"ucr_part\", title = \"UCRs per Year (Figure 1)\", text = \"noc\")","0171aead":"fig = px.line(ucr_year, x = \"year\", y = \"noc\", color = \"ucr_part\", labels =  {\"noc\" : \"Number of Crime\",\n                                                                       \"year\" : \"Year\",\n                                                                       \"ucr_part\" : \"UCR Part\"}, title = \"UCRs per Year (Figure 2)\")\n\nfig.update_layout(\n    font_color=\"#5642C5\",\n    title_font_color=\"#5642C5\",\n    legend_title_font_color=\"#5642C5\",\n    font_size = 14\n)","cdaffd0a":"ucr_month = pd.DataFrame(data = (crime.groupby([\"Month\", \"UCR_PART\"]).count()[\"Group\"]).reset_index().values,\n                        columns = [\"month\", \"ucr_part\", \"noc\"]).sort_values(\"month\").reset_index(drop = True)\n\nfig2 = px.bar(ucr_month, x = \"month\", y = \"noc\", color = \"ucr_part\", title = \"UCRs per Month (Figure 1)\", labels = {\"month\" : \"Month\",\n                                                                                                  \"ucr_part\" : \"UCR Part\",\n                                                                                                  \"noc\" : \"Number of Crime\"}, \n                                                                                                   # change the bar mode\n                                                                                                   barmode = \"group\",\n                                                                                                   text = \"noc\",\n                                                                                                   color_discrete_sequence=[\"red\", \"green\", \"blue\", \"magenta\"])\nfig2.update_traces(textposition = \"outside\")\nfig2.update_layout(\n    font_color=\"#5642C5\",\n    title_font_color=\"#5642C5\",\n    legend_title_font_color=\"#5642C5\",\n    font_size = 14)","697f8315":"fig3 = px.line(ucr_month, x = \"month\", y = \"noc\", color = \"ucr_part\", labels =  {\"noc\" : \"Number of Crime\",\n                                                                               \"month\" : \"Month\",\n                                                                               \"ucr_part\" : \"UCR Part\"},\n                                                                               title = \"UCRs per Month (Figure 2)\")\n\nfig3.update_layout(\n    font_color=\"#5642C5\",\n    title_font_color=\"#5642C5\",\n    legend_title_font_color=\"#5642C5\",\n    font_size = 14\n)","6da91c00":"ucr_day = pd.DataFrame(data = (crime.groupby([\"Day\", \"UCR_PART\"]).count()[\"Group\"]).reset_index().values,\n                      columns = [\"day\", \"ucr_part\", \"noc\"]).sort_values(\"day\").reset_index(drop = True)\n\nfig3 = px.bar(ucr_day, x = \"day\", y = \"noc\", color = \"ucr_part\", title = \"UCRs per Day (Figure 1)\", labels = {\"day\" : \"Day\",\n                                                                                            \"noc\" : \"Number of Crime\",\n                                                                                            \"ucr_part\" : \"UCR Part\"},\n                                                                                  text = \"noc\",\n                                                                                  color_discrete_sequence=[\"red\", \"green\", \"blue\", \"goldenrod\"])\n\nfig3.update_traces(textposition = \"outside\")\nfig3.update_layout(\n    font_color=\"#5642C5\",\n    title_font_color=\"#5642C5\",\n    legend_title_font_color=\"#5642C5\",\n    font_size = 14)","d3793648":"px.line(ucr_day, x = \"day\", y = \"noc\", color = \"ucr_part\", title = \"UCRs per Day with Line Chart (Figure 2)\")","ba6d6c48":"ucr_hour = pd.DataFrame(data = (crime.groupby([\"Hour\", \"UCR_PART\"]).count()[\"Group\"]).reset_index().values,\n                       columns = [\"hour\", \"ucr part\", \"noc\"]).sort_values(\"hour\").reset_index(drop = True)\n\nfig4 = px.bar(ucr_hour, x = \"hour\", y = \"noc\", color = \"ucr part\", title = \"UCRs per Hour (Figure 1)\",\n             labels = {\"noc\" : \"Number of Crime\",\n                       \"hour\" : \"Hour\",\n                       \"ucr part\" : \"UCR PART\"}, text = \"noc\", color_discrete_sequence = [\"red\", \"LightSeaGreen\", \"DarkCyan\", \"DarkSeaGreen\"])\n\nfig4.update_traces(textposition = \"outside\")\nfig4.update_layout(\n    font_color = \"#5642C5\",\n    title_font_color = \"#5642C5\",\n    legend_title_font_color = \"#5642C5\",\n    font_size = 14)","658c01c4":"fig5 = px.line(ucr_hour, x = \"hour\", y = \"noc\", color = \"ucr part\", title = \"UCRs per Hour (Figure 2)\",\n              labels = {\"noc\" : \"Number of Crime\",\n                        \"hour\" : \"Hour\",\n                        \"ucr part\" : \"UCR PART\"})\n\nfig5.update_layout(font_color = \"#5642C5\",\n                   font_size = 14,\n                   title_font_color = \"#5642C5\",\n                   legend_title_font_color = \"#5642C5\")","44d3c7c6":"fig6 = make_subplots(rows = 2, cols = 1, specs = [[{\"type\" : \"bar\"}], [{\"type\" : \"bar\"}]], \n                     subplot_titles = (\"Number of Crime per Street\", \"Number of Crime per District\"))\n\nfig6.add_trace(go.Bar(x = noc_street[\"street\"], y =  noc_street[\"noc\"]), row = 1, col = 1)\nfig6.add_trace(go.Bar(x = noc_dist[\"dist\"], y =  noc_dist[\"noc\"]), row = 2, col = 1)","4aac86be":"crime.head()","000f83f9":"sns.countplot(x = \"Quarter\", data = crime);","7242d1b3":"sns.countplot(x = \"Weekofyear\", hue = \"UCR_PART\", data = crime);","b1cb952f":"<font color = \"#5642C5\">Let's check number of unique entries:<\/font>","630e0b53":"# <span style = \"color: #2E8B57\">1. Analysing the Crime Boston Dataset <\/span>","cf89f84f":"<font color = \"#5642C5\">We have categorical values. We can convert them into `Categorical Data Type`.<\/font>","740e11cf":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           background-color:#5642C5;\n           font-size:110%;\n           font-family:Verdana;\n           letter-spacing:0.5px\">\n<p style=\"padding: 10px;\n              color:white;\">\n\ud83e\udd14Hmmm... We have more than 300.000 entries. Maybe, just maybe, we can ignore 'STREET', 'LAT', 'LONG' column's null values but 'SHOOTING' column hardly has data but that's mean there is no information we can use? NA values can mean there is no shooting occured. It tells us something, don't you think?\n<\/p>\n<\/div>","01558df2":"## \ud83d\udcca <span style=\"color: #228B22\"> 1.3: Data Visualization <\/span>","40e85bc1":"<font color = \"#5642C5\">Part one crimes (murder, manslaughter, sex offenses, robbery, aggravated assault, burglary, motor vehicle theft, and arson) are less common each year than other criminal groups, but in 2016 the part one group has more crimes than in other years. As you can see in the Figure 2.<\/font>","f7ade015":"<font color = \"#5642C5\">Well, there is something to mention in here. Data does not contain first 5 month of year 2015 and last 3 month of year 2018.<\/font>","a68cfab7":"<font color = \"#5642C5\">\ud83d\udcdd **Takeaways:**\n\n1. Year 2017 has the majority in number of crime.\n2. August has the majority, and maybe we can say by looking at the plot that summer season is suitable for crimes.\n3. Wow, if we look at day plot, while the number of crimes increases on Fridays, there is a big drop on Sunday. Friday is the last day for work, maybe we can assume it is the reason, like sunday being the holiday makes crime rates drop.\n4. Crime rate increases at five o'clock in the evening (after work hours) and at 12 noon (lunch break).\n5. B2 Roxbury district leads crime rates. C11 Dorchester and D4 Back Bay\/South End districts follows.\n6. Commonwealth Ave. and Centre st. leads the crime rates.<\/font>","bfe8c1fc":"<font color = \"#5642C5\">\ud83d\udcdd**Takeaways:**\n1. Most crime happened in B1 district (Roxbury). Followed by C11 district (Dorchester).\n2. Most crimes (318054) doesn't involve shooting.\n3. We can't say much about dates, but midnight seems like busy hours.\n4. While crime should decrease over the years, there is an increasing number of crimes. 2017 was the year with the most crimes.\n5. Summer season (August, July) are again the seasons with the highest crime rates.\n6. There is an increase in the crime rate on Friday, as it is the last working day.\n7. In the evening hours and at 12 (noon) the crime rate seems to be high again.\n8. UCR Part 3 crimes has leadership. These crimes are the lesser offenses of larceny-theft, simple assault, vandalism of a building or a property.\n9. Washington St. has the most crime rate.<\/font>","c597fdf4":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           background-color:#5642C5;\n           font-size:110%;\n           font-family:Verdana;\n           letter-spacing:0.5px\">\n<p style=\"padding: 10px;\n              color:white;\">\n'OCCURED_ON_DATE' column contains date but its dtype is object. We should fix that.\n<\/p>\n<\/div>","73a35838":"## \ud83c\udf14 <span style=\"color: #228B22\"> 1.1: Libraries & Reading the Data <\/span>\n\n<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           background-color:#5642C5;\n           font-size:110%;\n           font-family:Verdana;\n           letter-spacing:0.5px\">\n<p style=\"padding: 10px;\n              color:white;\">\nFor start, we should first import our necessary libraries, and we should read our data with `read_csv` method of Pandas library.\n\n<\/p>\n<\/div>\n\n<div class=\"alert alert-block alert-info\"> \ud83d\udccc Content: Records begin in June 14, 2015 and continue to September 3, 2018.\n<\/div>","a7109ebe":"<font color = \"#5642C5\">Create two new features as <b>quarter & weekofyear<\/b>.<\/font>","77ead4fe":"<div class=\"alert alert-block alert-info\"> \ud83e\udde8 When we take the values of the 'INCIDENT_NUMBER' repeated more than once they all have the same entries, except for the features that start with 'OFFENSE_...'.\n<\/div>","4e90be6b":"## \ud83c\udf8a <span style=\"color: #228B22\"> 1.2: Data Exploration <\/span>","55d0dc6f":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           background-color:#5642C5;\n           font-size:110%;\n           font-family:Verdana;\n           letter-spacing:0.5px\">\n<p style=\"padding: 10px;\n              color:white;\">\nUsually, after we completed this part, it is common to check for null values, data's shape, and take a look at the whole data with `info`, and `describe` methods.\n\n<\/p>\n<\/div>","42670ba9":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           background-color:#5642C5;\n           font-size:110%;\n           font-family:Verdana;\n           letter-spacing:0.5px\">\n<p style=\"padding: 10px;\n              color:white;\">\n'SHOOTING', 'STREET', 'LAT', 'LONG' columns null values seems way to much. Let's look at the shape of the data now. So, we can interpret the amount of null values, and consider what to do with these.\n\n<\/p>\n<\/div>","e407533f":"<font color = \"#5642C5\">D4, A1, B2, C6 districts has the majority in crime numbers in Motor Vehicle Accident, and Larcency.<\/font>","f33a2d25":"**Crime number is higher on third quarter of the year, summer months.**","735ba008":"<div style=\"color:white;\n           display:fill;\n           border-radius:5px;\n           background-color:#5642C5;\n           font-size:110%;\n           font-family:Verdana;\n           letter-spacing:0.5px\">\n<p style=\"padding: 10px;\n              color:white;\">\nSince I decided that null shooting values mean there is no shooting, I replaced them with 'N'.\n<\/p>\n<\/div>"}}