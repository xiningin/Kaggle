{"cell_type":{"d9f62958":"code","5919a0be":"code","3632f468":"code","da5e28f7":"code","3347a2b9":"code","e6aa61cb":"code","ba1b2b37":"code","ffb13ba0":"code","571ace85":"code","381e5a3f":"code","fb620abe":"code","d6f2f92e":"code","25fe736f":"code","ee8b2ae0":"code","2966c786":"code","826950d5":"code","10f17e77":"code","19ad508f":"code","81d26ce7":"code","facdf6ca":"code","bf3af284":"code","6c0d43b3":"code","a941082d":"code","86ccd0f7":"code","aa3b39f5":"code","e16c308d":"code","79b95919":"code","270327e7":"code","4deff069":"code","c42bd14c":"code","11c0a974":"code","255742f9":"code","b352d02c":"code","bc329d09":"markdown","d6ca0664":"markdown","fa20bfbd":"markdown","6021a79c":"markdown","bd700b52":"markdown"},"source":{"d9f62958":"import pandas as pd\nimport xgboost as xgb","5919a0be":"transactions_train=pd.read_csv('..\/input\/sberbank-users-expenses\/transactions_train.csv')","3632f468":"train_target=pd.read_csv('..\/input\/sberbank-users-expenses\/train_target.csv')","da5e28f7":"transactions_train.head()","3347a2b9":"train_target.head(5)","e6aa61cb":"agg_features=transactions_train.groupby('client_id')['amount_rur'].agg(['sum','mean','std','min','max']).reset_index()","ba1b2b37":"agg_features.head()","ffb13ba0":"counter_df_train=transactions_train.groupby(['client_id','small_group'])['amount_rur'].count()","571ace85":"cat_counts_train=counter_df_train.reset_index().pivot(index='client_id', \\\n                                                      columns='small_group',values='amount_rur')","381e5a3f":"cat_counts_train=cat_counts_train.fillna(0)","fb620abe":"cat_counts_train.columns=['small_group_'+str(i) for i in cat_counts_train.columns]","d6f2f92e":"cat_counts_train.head()","25fe736f":"train=pd.merge(train_target,agg_features,on='client_id')","ee8b2ae0":"train=pd.merge(train,cat_counts_train.reset_index(),on='client_id')","2966c786":"train.head()","826950d5":"transactions_test=pd.read_csv('..\/input\/sberbank-users-expenses\/\/transactions_test.csv')\n\ntest_id=pd.read_csv('..\/input\/sberbank-users-expenses\/test.csv')","10f17e77":"agg_features_test=transactions_test.groupby('client_id')['amount_rur'].agg(['sum','mean','std','min','max']).reset_index()","19ad508f":"agg_features_test.head()","81d26ce7":"counter_df_test=transactions_test.groupby(['client_id','small_group'])['amount_rur'].count()","facdf6ca":"cat_counts_test=counter_df_test.reset_index().pivot(index='client_id', columns='small_group',values='amount_rur')","bf3af284":"cat_counts_test=cat_counts_test.fillna(0)","6c0d43b3":"cat_counts_test.columns=['small_group_'+str(i) for i in cat_counts_test.columns]","a941082d":"cat_counts_test.head()","86ccd0f7":"test=pd.merge(test_id,agg_features_test,on='client_id')","aa3b39f5":"test=pd.merge(test,cat_counts_test.reset_index(),on='client_id')","e16c308d":"common_features=list(set(train.columns).intersection(set(test.columns)))","79b95919":"y_train=train['bins']\nX_train=train[common_features]\nX_test=test[common_features]","270327e7":"param={'objective':'multi:softprob','num_class':4,'n_jobs':4,'seed':42}","4deff069":"%%time\nmodel=xgb.XGBClassifier(**param,n_estimators=300)\nmodel.fit(X_train,y_train)","c42bd14c":"pred=model.predict(X_test)","11c0a974":"pred","255742f9":"submission = pd.DataFrame({'bins': pred}, index=test.client_id)\nsubmission.head()","b352d02c":"import time\nimport os\n\ncurrent_timestamp = int(time.time())\nsubmission_path = 'submit.csv'\nprint(submission_path)\nsubmission.to_csv(submission_path, index=True)","bc329d09":"* client_id - Client's id\n* trans_date - transaction date\n* small_group - Buying category\n* amount_rur - Amount of money","d6ca0664":"Such prediction give 0.6118 accuracy","fa20bfbd":"## Basic imports","6021a79c":"* bins - target variable. User's age group","bd700b52":"# Simple solution:"}}