{"cell_type":{"5b741a8b":"code","b64eb2a1":"code","458355bd":"code","49d3fc98":"code","cb4961e0":"code","277b9ff0":"code","13408bed":"code","5a32b87a":"code","6fa012a6":"code","3f0cf6a7":"code","376c882f":"code","71df5c17":"code","df48cd9c":"markdown","26738f99":"markdown","9fdc5b05":"markdown","5c588700":"markdown","e1152e55":"markdown","6633c63b":"markdown"},"source":{"5b741a8b":"from datetime import datetime\n\nprint('Executed at:', datetime.utcnow().strftime('%Y\/%m\/%d %H:%M:%S (UTC)'))","b64eb2a1":"from kaggle_secrets import UserSecretsClient\nimport requests\n\n# BE CAREFUL if you fork this kernel and use your own credentials!\nuser_secrets = UserSecretsClient()\nusername = user_secrets.get_secret('username')  # DO NOT LEAK\npassword = user_secrets.get_secret('password')  # DO NOT LEAK\n\n# create a session\nsession = requests.Session()\n\n# sign in\nSIGNIN_URL = 'https:\/\/www.kaggle.com\/account\/email-signin'\nsession.get(SIGNIN_URL)\ndata = {\n    'email': username,\n    'password': password,\n    'X-XSRF-TOKEN': session.cookies['XSRF-TOKEN'],\n}\nsession.post(SIGNIN_URL, data=data)\n\n# get the zipped public LB data\nPLB_DATA_URL = 'https:\/\/www.kaggle.com\/c\/16531\/publicleaderboarddata.zip'\nresp = session.get(PLB_DATA_URL)","458355bd":"from zipfile import ZipFile\nfrom io import BytesIO\nimport pandas as pd\n\n# convert the data to a dataframe\nz = ZipFile(BytesIO(resp.content))\ndf = pd.read_csv(BytesIO(z.read(z.filelist[0].filename)))\ndf = df.assign(SubmissionDate=pd.to_datetime(df['SubmissionDate']))\ndf = df.sort_values('Score', ascending=False)\ndf.head(10)","49d3fc98":"df.shape","cb4961e0":"df.info()","277b9ff0":"# get the best score of each team\nbest_scores = (\n    df.groupby('TeamId')\n    .agg({'TeamName': 'last', 'Score': 'max'})\n    .reset_index()\n    .sort_values('Score', ascending=False)\n    .reset_index(drop=True)\n    .assign(rank=lambda df: df.index + 1)\n)","13408bed":"best_scores.shape","5a32b87a":"import matplotlib.pyplot as plt\nimport seaborn as sns\nsns.set()\n\nthresh = 0.53\n\nfig, ax = plt.subplots(1, 1, figsize=(16, 8))\nsns.distplot(best_scores[best_scores['Score'] > thresh]['Score'], ax=ax)\nax.set_title(f'Score (> {thresh}) distribution of the public LB', fontsize=20)\nax.set_xlabel('Score', fontsize=20)\nax.tick_params(axis='both', which='major', labelsize=15)","6fa012a6":"top = best_scores.head(16)  # more than gold\ntop","3f0cf6a7":"top_sbms = (\n    pd.merge(top[['TeamId', 'rank']], df, on='TeamId', how='inner')\n    .sort_values(['rank', 'SubmissionDate'])\n)\ntop_sbms","376c882f":"import plotly.graph_objects as go\nimport numpy as np\n\ndata = []\n\nfor team_id, team in top_sbms.groupby('TeamId', sort=False):\n    data.append(go.Scatter(\n        x=team['SubmissionDate'],\n        y=team['Score'],\n        name='{}: {}'.format(team['rank'].iloc[0], team['TeamName'].iloc[0]),\n        mode='lines'\n    ))\n\nlayout = go.Layout({\n    'width': 800,\n    'height': 600,\n    'xaxis': {'title': 'Date'},\n    'yaxis': {'title': 'Score', 'range': [0.4, 0.6]},\n    'legend': {'orientation': 'h', 'y': 1.7},\n})\n    \nfig = go.Figure(data=data, layout=layout)\nfig.show()","71df5c17":"layout = go.Layout({\n    'width': 800,\n    'height': 600,\n    'xaxis': {'title': 'Date'},\n    'yaxis': {'title': 'Score', 'range': [0.55, 0.6]},\n    'legend': {'orientation': 'h', 'y': 1.7},\n})\n    \nfig = go.Figure(data=data, layout=layout)\nfig.show()","df48cd9c":"# Convert to dataframe","26738f99":"# Plot submission histories","9fdc5b05":"# Download the public LB data","5c588700":"# Get the best score of each team","e1152e55":"# Zoom 0.55 ~ 0.60","6633c63b":"# Top rankers"}}