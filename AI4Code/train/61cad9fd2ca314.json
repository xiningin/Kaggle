{"cell_type":{"3d2e0c9b":"code","7be8c485":"code","8e33adbb":"code","91c56153":"code","ea64a3bf":"code","67af671a":"code","74befbe8":"code","6c73025a":"markdown","5ff7e479":"markdown","22311ca9":"markdown","0bfc51dc":"markdown"},"source":{"3d2e0c9b":"import pandas as pd\nfrom sklearn.ensemble import RandomForestRegressor\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","7be8c485":"train = pd.read_csv(\n    '\/kaggle\/input\/tabular-playground-series-jan-2022\/train.csv',\n    index_col='row_id', parse_dates=['date'])\ntest = pd.read_csv(\n    '\/kaggle\/input\/tabular-playground-series-jan-2022\/test.csv',\n    index_col='row_id', parse_dates=['date'])\nsubmission = pd.read_csv(\n    '\/kaggle\/input\/tabular-playground-series-jan-2022\/sample_submission.csv',\n    index_col='row_id')","8e33adbb":"train.head()","91c56153":"plot_df = train.set_index('date')\nplot_df[['country', 'store', 'product', 'num_sold']].pivot(\n    columns=['country', 'store', 'product'], values='num_sold').plot(figsize=(18,6));","ea64a3bf":"y = train.pop('num_sold')\n\ntrain['year'] = train['date'].dt.year\ntrain['month'] = train['date'].dt.month\ntrain['day'] = train['date'].dt.day\ntrain['dayofweek'] = train['date'].dt.dayofweek\n\ntest['year'] = test['date'].dt.year\ntest['month'] = test['date'].dt.month\ntest['day'] = test['date'].dt.day\ntest['dayofweek'] = test['date'].dt.dayofweek\n\ntrain = train.drop('date', axis='columns')\ntest = test.drop('date', axis='columns')","67af671a":"country_map = {'Finland': 0, 'Sweden': 1, 'Norway': 2}\nstore_map = {'KaggleMart': 0, 'KaggleRama': 1}\nproduct_map = {'Kaggle Mug': 0, 'Kaggle Hat': 1, 'Kaggle Sticker': 2}\n\ntrain['country'] = train['country'].map(country_map)\ntrain['store'] = train['store'].map(store_map)\ntrain['product'] = train['product'].map(product_map)\n\ntest['country'] = test['country'].map(country_map)\ntest['store'] = test['store'].map(store_map)\ntest['product'] = test['product'].map(product_map)","74befbe8":"model = RandomForestRegressor(n_estimators=500, n_jobs=-1)\nmodel.fit(train, y)\nbenchmark = submission.copy()\nbenchmark['num_sold'] = model.predict(test)\n\nbenchmark.to_csv('rf_submission.csv')","6c73025a":"There's definitely some short-term and long-term seasonality, as well as some holiday effect. (And probably others!) We can create a simple RandomForest model by creating some date features.","5ff7e479":"### Encode the categoricals","22311ca9":"### Create simple time features","0bfc51dc":"## Let's see what the data looks like"}}