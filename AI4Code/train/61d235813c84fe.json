{"cell_type":{"d707fd07":"code","27ae17bf":"code","9090e123":"code","3144658d":"code","090ab5b9":"code","dbac6828":"code","fe851159":"code","855f90e5":"code","b8369f88":"code","9a7d6fa2":"code","a8e05ffc":"code","7d0bfd58":"code","40a07ee2":"code","5fab3eca":"code","c5abe2ce":"code","c4aa9903":"code","1bb48509":"code","3d1888ac":"code","cda8b0fe":"code","bd613289":"code","439aeb18":"code","b1992647":"code","bb1a6646":"code","ff254ef8":"code","88f3545d":"code","eb98f868":"code","d8ca3346":"code","035df691":"code","8b049a37":"code","e65aea56":"code","0787968f":"code","0dd91ffc":"code","326b835b":"markdown","c660b204":"markdown","f539d7e4":"markdown","ff6ec74a":"markdown"},"source":{"d707fd07":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","27ae17bf":"import sys\nimport pandas as pd\nimport numpy as np\nimport sklearn\nimport matplotlib\nimport keras\n\nprint('Python: {}'.format(sys.version))\nprint('Pandas: {}'.format(pd.__version__))\nprint('Numpy: {}'.format(np.__version__))\nprint('Sklearn: {}'.format(sklearn.__version__))\nprint('Matplotlib: {}'.format(matplotlib.__version__))\nprint('Keras: {}'.format(keras.__version__))","9090e123":"import matplotlib.pyplot as plt\nfrom pandas.plotting import scatter_matrix\nimport seaborn as sns","3144658d":"# read the csv\ncleveland = pd.read_csv('..\/input\/heart-disease-uci\/heart.csv')\n","090ab5b9":"# print the shape of the DataFrame, so we can see how many examples we have\nprint( 'Shape of DataFrame: {}'.format(cleveland.shape))\nprint (cleveland.loc[1])","dbac6828":"# print the last twenty or so data points\ncleveland.loc[280:]","fe851159":"# remove missing data (indicated with a \"?\")\ndata = cleveland[~cleveland.isin(['?'])]\ndata.loc[280:]","855f90e5":"# drop rows with NaN values from DataFrame\ndata = data.dropna(axis=0)\ndata.loc[280:]","b8369f88":"# print the shape and data type of the dataframe\nprint(data.shape)\nprint(data.dtypes)","9a7d6fa2":"# transform data to numeric to enable further analysis\ndata = data.apply(pd.to_numeric)\ndata.dtypes","a8e05ffc":"# print data characteristics, usings pandas built-in describe() function\ndata.describe()","7d0bfd58":"# plot histograms for each variable\ndata.hist(figsize = (12, 12))\nplt.show()","40a07ee2":"pd.crosstab(data.age,data.target).plot(kind=\"bar\",figsize=(20,6))\nplt.title('Heart Disease Frequency for Ages')\nplt.xlabel('Age')\nplt.ylabel('Frequency')\nplt.show()","5fab3eca":"plt.figure(figsize=(10,10))\nsns.heatmap(data.corr(),annot=True,fmt='.1f')\nplt.show()","c5abe2ce":"age_unique=sorted(data.age.unique())\nage_thalach_values=data.groupby('age')['thalach'].count().values\nmean_thalach=[]\nfor i,age in enumerate(age_unique):\n    mean_thalach.append(sum(data[data['age']==age].thalach)\/age_thalach_values[i])\n    \nplt.figure(figsize=(10,5))\nsns.pointplot(x=age_unique,y=mean_thalach,color='red',alpha=0.8)\nplt.xlabel('Age',fontsize = 15,color='blue')\nplt.xticks(rotation=45)\nplt.ylabel('Thalach',fontsize = 15,color='blue')\nplt.title('Age vs Thalach',fontsize = 15,color='blue')\nplt.grid()\nplt.show()","c4aa9903":"X = np.array(data.drop(['target'], 1))\ny = np.array(data['target'])","1bb48509":"X[0]","3d1888ac":"mean = X.mean(axis=0)\nX -= mean\nstd = X.std(axis=0)\nX \/= std","cda8b0fe":"X[0]","bd613289":"# create X and Y datasets for training\nfrom sklearn import model_selection\n\nX_train, X_test, y_train, y_test = model_selection.train_test_split(X, y, stratify=y, random_state=42, test_size = 0.2)","439aeb18":"# convert the data to categorical labels\nfrom keras.utils.np_utils import to_categorical\n\nY_train = to_categorical(y_train, num_classes=None)\nY_test = to_categorical(y_test, num_classes=None)\nprint (Y_train.shape)\nprint (Y_train[:10])","b1992647":"from keras.models import Sequential\nfrom keras.layers import Dense\nfrom keras.optimizers import Adam\nfrom keras.layers import Dropout\nfrom keras import regularizers\n\n# define a function to build the keras model\ndef create_model():\n    # create model\n    model = Sequential()\n    model.add(Dense(16, input_dim=13, kernel_initializer='normal', kernel_regularizer=regularizers.l2(0.001), activation='relu'))\n    model.add(Dropout(0.25))\n    model.add(Dense(8, kernel_initializer='normal', kernel_regularizer=regularizers.l2(0.001), activation='relu'))\n    model.add(Dropout(0.25))\n    model.add(Dense(2, activation='softmax'))\n    \n    # compile model\n    adam = Adam(lr=0.001)\n    model.compile(loss='categorical_crossentropy', optimizer='rmsprop', metrics=['accuracy'])\n    return model\n\nmodel = create_model()\nprint(model.summary())","bb1a6646":"# fit the model to the training data\nhistory=model.fit(X_train, Y_train, validation_data=(X_test, Y_test),epochs=50, batch_size=10)","ff254ef8":"import matplotlib.pyplot as plt\n%matplotlib inline\n# Model accuracy\nplt.plot(history.history['accuracy'])\nplt.plot(history.history['val_accuracy'])\nplt.title('Model Accuracy')\nplt.ylabel('accuracy')\nplt.xlabel('epoch')\nplt.legend(['train', 'test'])\nplt.show()","88f3545d":"# Model Losss\nplt.plot(history.history['loss'])\nplt.plot(history.history['val_loss'])\nplt.title('Model Loss')\nplt.ylabel('loss')\nplt.xlabel('epoch')\nplt.legend(['train', 'test'])\nplt.show()","eb98f868":"# convert into binary classification problem - heart disease or no heart disease\nY_train_binary = y_train.copy()\nY_test_binary = y_test.copy()\n\nY_train_binary[Y_train_binary > 0] = 1\nY_test_binary[Y_test_binary > 0] = 1\n\nprint(Y_train_binary[:20])","d8ca3346":"# define a new keras model for binary classification\ndef create_binary_model():\n    # create model\n    model = Sequential()\n    model.add(Dense(16, input_dim=13, kernel_initializer='normal',  kernel_regularizer=regularizers.l2(0.001),activation='relu'))\n    model.add(Dropout(0.25))\n    model.add(Dense(8, kernel_initializer='normal',  kernel_regularizer=regularizers.l2(0.001),activation='relu'))\n    model.add(Dropout(0.25))\n    model.add(Dense(1, activation='sigmoid'))\n    \n    # Compile model\n    adam = Adam(lr=0.001)\n    model.compile(loss='binary_crossentropy', optimizer='rmsprop', metrics=['accuracy'])\n    return model\n\nbinary_model = create_binary_model()\n\nprint(binary_model.summary())","035df691":"history=binary_model.fit(X_train, Y_train_binary, validation_data=(X_test, Y_test_binary), epochs=50, batch_size=10)","8b049a37":"import matplotlib.pyplot as plt\n%matplotlib inline\n# Model accuracy\nplt.plot(history.history['accuracy'])\nplt.plot(history.history['val_accuracy'])\nplt.title('Model Accuracy')\nplt.ylabel('accuracy')\nplt.xlabel('epoch')\nplt.legend(['train', 'test'])\nplt.show()","e65aea56":"# Model Losss\nplt.plot(history.history['loss'])\nplt.plot(history.history['val_loss'])\nplt.title('Model Loss')\nplt.ylabel('loss')\nplt.xlabel('epoch')\nplt.legend(['train', 'test'])\nplt.show()","0787968f":"# generate classification report using predictions for categorical model\nfrom sklearn.metrics import classification_report, accuracy_score\n\ncategorical_pred = np.argmax(model.predict(X_test), axis=1)\n\nprint('Results for Categorical Model')\nprint(accuracy_score(y_test, categorical_pred))\nprint(classification_report(y_test, categorical_pred))","0dd91ffc":"# generate classification report using predictions for binary model\nfrom sklearn.metrics import classification_report, accuracy_score\n# generate classification report using predictions for binary model \nbinary_pred = np.round(binary_model.predict(X_test)).astype(int)\n\nprint('Results for Binary Model')\nprint(accuracy_score(Y_test_binary, binary_pred))\nprint(classification_report(Y_test_binary, binary_pred))","326b835b":"FIT THE MODEL","c660b204":"STEP-2:COMPILE THE MODEL","f539d7e4":"STEP-1:SPECIFY ARCHITECTURE","ff6ec74a":"STEP-4:PREDICT ON THE MODEL"}}