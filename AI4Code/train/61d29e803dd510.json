{"cell_type":{"3aabaaf9":"code","dde70b8b":"code","480d1778":"code","a969c52b":"code","5a78cd0d":"code","e5ccd016":"code","b2c1612d":"code","ae57c8da":"code","9619ebfb":"code","1e627b84":"code","a78a631a":"code","fdda0582":"code","434cca24":"code","5a5e8e03":"code","b7be85de":"code","2725ba08":"code","4b1626d6":"code","a8154104":"code","7f3b8cc9":"code","66e24b81":"code","aa6206ad":"code","f49129ff":"code","ffad32cf":"code","c24cae5a":"code","3e39b93b":"code","e31200d3":"code","8581b4ba":"code","479bd47b":"code","c2a2102d":"code","1d455302":"code","1651b736":"code","5ba76809":"code","abd4c2a9":"code","dae33b6c":"code","d24f5700":"code","4da4f5e8":"markdown","a8e47798":"markdown","2d260d25":"markdown","e611efc5":"markdown","7a8fbb81":"markdown","c9b8a407":"markdown","2b9a8004":"markdown","36cd94da":"markdown","366418b6":"markdown","8d090d34":"markdown","1fe62916":"markdown","ab4d796f":"markdown","a1ec5564":"markdown","2908fc53":"markdown","da171b9a":"markdown"},"source":{"3aabaaf9":"import numpy as np \nimport pandas as pd \nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns","dde70b8b":"import bq_helper \n\nOpenAQ = bq_helper.BigQueryHelper(active_project= \"bigquery-public-data\", \n                                       dataset_name = \"openaq\")\nOpenAQ.list_tables()\n","480d1778":"OpenAQ.table_schema('global_air_quality')","a969c52b":"OpenAQ.head('global_air_quality')","5a78cd0d":"QUERY= \"\"\"  SELECT EXTRACT(YEAR from timestamp) AS Year,unit, count(*) AS Year_wise_record_count\n            FROM `bigquery-public-data.openaq.global_air_quality` as globalAQ\n            GROUP BY Year , unit\n            ORDER BY Year_wise_record_count       \n\"\"\"","e5ccd016":"# Calculating year wise aggregating pollution values\nYear_unit_df = OpenAQ.query_to_pandas_safe(QUERY)\n# display query results\nYear_unit_df","b2c1612d":"QUERY = \"\"\"SELECT *\n            FROM `bigquery-public-data.openaq.global_air_quality`\n            WHERE unit = '\u00b5g\/m\u00b3' AND value Between 0 and 1000  \n            \"\"\"\nValue_df = OpenAQ.query_to_pandas_safe(QUERY)","ae57c8da":"Value_df.describe()","9619ebfb":"sns.boxplot(Value_df['value'])\n\nplt.title('Boxplot describing the column \"Value\"');","1e627b84":"QUERY = \"\"\"SELECT AVG(value) as `Average`, EXTRACT(YEAR FROM timestamp) As Year\n            FROM `bigquery-public-data.openaq.global_air_quality`\n            WHERE unit = '\u00b5g\/m\u00b3' AND value BETWEEN 0 AND 1000 AND EXTRACT(YEAR FROM timestamp) BETWEEN 2007 AND 2019 \n            GROUP BY Year\n            \"\"\"\nYear_df = OpenAQ.query_to_pandas_safe(QUERY)","a78a631a":"plt.figure(figsize=(14,8))\nsns.barplot(Year_df['Year'],Year_df['Average'])\nplt.xlabel('Years')\nplt.ylabel('Latest measured value for the pollutant')\nplt.title('Yearly Comparison');","fdda0582":"QUERY = \"\"\"SELECT EXTRACT(YEAR from timestamp) as `Year`,\n            EXTRACT(MONTH FROM timestamp) as `Month`,\n            AVG(value) as `Average`\n        FROM `bigquery-public-data.openaq.global_air_quality`\n        WHERE unit = '\u00b5g\/m\u00b3' AND value BETWEEN 0 AND 1000\n        GROUP BY year,Month\"\"\"\nYear_Month_df = OpenAQ.query_to_pandas_safe(QUERY)","434cca24":"plt.figure(figsize=(14,8))\nsns.pointplot(Year_Month_df['Month'],Year_Month_df['Average'],hue = Year_Month_df['Year'])\nplt.xlabel('Month')\nplt.ylabel('Pollution level in (\u00b5g\/m\u00b3)')\nplt.title('Average Monthly pollution value');","5a5e8e03":"QUERY= \"\"\"  SELECT AVG(value) as AVG_Monthly_emission,EXTRACT(MONTH from timestamp) AS Month\n            FROM `bigquery-public-data.openaq.global_air_quality` \n            WHERE EXTRACT(YEAR from timestamp) = 2019 AND unit = '\u00b5g\/m\u00b3' AND value BETWEEN 0 AND 1000 AND EXTRACT(MONTH from timestamp) BETWEEN 0 AND 9\n            GROUP BY Month\n\"\"\"","b7be85de":"Month_df = OpenAQ.query_to_pandas_safe(QUERY)\nMonth_df","2725ba08":"plt.figure(figsize=(14,8))\nsns.barplot(Month_df['Month'],Month_df['AVG_Monthly_emission'])\nplt.xlabel('Month')\nplt.ylabel('Average emission')\nplt.title('Monthly emission in the year 2019(till september)');\n","4b1626d6":"QUERY= \"\"\"\n        SELECT AVG(value) as Total , pollutant\n        FROM `bigquery-public-data.openaq.global_air_quality`\n        where EXTRACT(YEAR from timestamp) = 2019 AND unit != 'ppm' AND value BETWEEN 0 AND 1000\n        GROUP BY pollutant\n        \"\"\"","a8154104":"pollution_df = OpenAQ.query_to_pandas_safe(QUERY)\npollution_df","7f3b8cc9":"plt.figure(figsize=(14,8))\nsns.barplot(pollution_df['pollutant'],pollution_df['Total'])\nplt.xlabel(\"Pollutant\")\nplt.ylabel(\"Average value\")\nplt.title('Average pollutant value in the year 2019');","66e24b81":"QUERY= \"\"\"\n        SELECT AVG(value) as Total , country \n        FROM `bigquery-public-data.openaq.global_air_quality`\n        where EXTRACT(YEAR from timestamp) = 2019 AND unit != 'ppm' AND value BETWEEN 0 AND 1000\n        GROUP BY country\n        \"\"\"","aa6206ad":"country_df = OpenAQ.query_to_pandas_safe(QUERY)\ncountry_df.sort_values('Total',ascending=False,inplace=True)\n","f49129ff":"country_df= country_df.head(20)\nf,ax = plt.subplots(figsize=(14,6))\nsns.barplot(country_df['country'],country_df['Total'])\nplt.xlabel('Countries')\nplt.ylabel('Average pollution emission in the year 2019')\nplt.title('Most polluted countries in the world (Year 2019)');","ffad32cf":"QUERY_CO= \"\"\"\n        SELECT AVG(value) as Total , country\n        FROM `bigquery-public-data.openaq.global_air_quality`\n        where EXTRACT(YEAR from timestamp) = 2019 AND unit != 'ppm' AND pollutant='co' and value BETWEEN 0 AND 1000\n        GROUP BY country\n        \"\"\"\nQUERY_O3= \"\"\"\n        SELECT AVG(value) as Total , country\n        FROM `bigquery-public-data.openaq.global_air_quality`\n        where EXTRACT(YEAR from timestamp) = 2019 AND unit != 'ppm' AND pollutant='o3' AND value BETWEEN 0 AND 10000\n        GROUP BY country\n        \"\"\"\nQUERY_PM10= \"\"\"\n        SELECT AVG(value) as Total , country\n        FROM `bigquery-public-data.openaq.global_air_quality`\n        where EXTRACT(YEAR from timestamp) = 2019 AND unit != 'ppm' AND pollutant='pm10' AND value BETWEEN 0 AND 1000\n        GROUP BY country\n        \"\"\"\nQUERY_PM25= \"\"\"\n        SELECT AVG(value) as Total , country\n        FROM `bigquery-public-data.openaq.global_air_quality`\n        where EXTRACT(YEAR from timestamp) = 2019 AND unit != 'ppm' AND pollutant='pm25' AND value BETWEEN 0 AND 1000\n        GROUP BY country\n        \"\"\"\nQUERY_NO2= \"\"\"\n        SELECT AVG(value) as Total , country\n        FROM `bigquery-public-data.openaq.global_air_quality`\n        where EXTRACT(YEAR from timestamp) = 2019 AND unit != 'ppm' AND pollutant='no2'AND value BETWEEN 0 AND 1000\n        GROUP BY country\n        \"\"\"\nQUERY_SO2= \"\"\"\n        SELECT AVG(value) as Total , country\n        FROM `bigquery-public-data.openaq.global_air_quality`\n        where EXTRACT(YEAR from timestamp) = 2019 AND unit != 'ppm' AND pollutant='so2' AND value BETWEEN 0 AND 1000\n        GROUP BY country\n        \"\"\"\n","c24cae5a":"co_df = OpenAQ.query_to_pandas_safe(QUERY_CO)\nco_df.sort_values('Total',ascending=False,inplace=True)","3e39b93b":"o3_df = OpenAQ.query_to_pandas_safe(QUERY_O3)\no3_df.sort_values('Total',ascending=False,inplace=True)","e31200d3":"pm10_df = OpenAQ.query_to_pandas_safe(QUERY_PM10)\npm10_df.sort_values('Total',ascending=False,inplace=True)","8581b4ba":"pm25_df = OpenAQ.query_to_pandas_safe(QUERY_PM25)\npm25_df.sort_values('Total',ascending=False,inplace=True)","479bd47b":"no2_df = OpenAQ.query_to_pandas_safe(QUERY_NO2)\nno2_df.sort_values('Total',ascending=False,inplace=True)","c2a2102d":"so2_df = OpenAQ.query_to_pandas_safe(QUERY_SO2)\nso2_df.sort_values('Total',ascending=False,inplace=True)","1d455302":"co_df= co_df.head(20)\nf,ax = plt.subplots(figsize=(14,6))\nsns.barplot(co_df['country'],co_df['Total'])\nplt.xlabel('Countries')\nplt.ylabel('Carbon monoxide(CO) level')\nplt.title('Average country wise CO emission in the year 2019');","1651b736":"o3_df= o3_df.head(20)\nf,ax = plt.subplots(figsize=(14,6))\nsns.barplot(o3_df['country'],o3_df['Total'])\nplt.xlabel('Countries')\nplt.ylabel('Ozone level')\nplt.title('Average country wise Ozone emission in the year 2019');","5ba76809":"pm10_df= pm10_df.head(20)\nf,ax = plt.subplots(figsize=(14,6))\nsns.barplot(pm10_df['country'],pm10_df['Total'])\nplt.xlabel('Countries')\nplt.ylabel('Particulate matter 10 (PM10)')\nplt.title('Average country wise PM10 emission in the year 2019');","abd4c2a9":"pm25_df= pm25_df.head(20)\nf,ax = plt.subplots(figsize=(14,6))\nsns.barplot(pm25_df['country'],pm25_df['Total'])\nplt.xlabel('Countries')\nplt.ylabel('particulate matter 25 (PM25)')\nplt.title('Average country wise PM25 emission in the year 2019');","dae33b6c":"no2_df= no2_df.head(20)\nf,ax = plt.subplots(figsize=(14,6))\nsns.barplot(no2_df['country'],no2_df['Total'])\nplt.xlabel('Countries')\nplt.ylabel('Nitrogen Oxide(NO2)')\nplt.title('Average country wise NO2 emission in the year 2019');","d24f5700":"so2_df= so2_df.head(20)\nf,ax = plt.subplots(figsize=(14,6))\nsns.barplot(so2_df['country'],so2_df['Total'])\nplt.xlabel('Countries')\nplt.ylabel('Sulpher dioxide(SO2)')\nplt.title('Average country wise SO2 emission in the year 2019');","4da4f5e8":"Carbon Monoxide is the major pollution contributor, atleast in the year 2019.","a8e47798":"# Monthly comparison of pollution levels","2d260d25":"If you like above notebook then please upvote the same. Feedback are very welcome","e611efc5":"Year 2015 has approximately twice level of pollution when compares to other year. ","7a8fbb81":"## Country wise split up","c9b8a407":"Too many outlier. For the purpose of analysis let's keep range in (0,1000)","2b9a8004":"# Yearly comparison of pollution levels","36cd94da":"We have ample data for the year 2019 compares to other. Therefore, going onwards we will focus on the same","366418b6":"## Pollutant vs country emission","8d090d34":"# Pollution level Analysis for the year 2019","1fe62916":"From onwards here, we are going to use data only from the year 2019","ab4d796f":"## Pollutant wise split up","a1ec5564":"Well, the pollution level has approximately spread equally over the year(Except few outliers) ","2908fc53":"Fetching data with the help of bq helper","da171b9a":"Month \"May\" has recorded highest average pollution value in the year 2019."}}