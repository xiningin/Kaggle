{"cell_type":{"abc08cd6":"code","82633cb6":"code","b16de1ee":"code","c7ac22d8":"code","6d311fe2":"code","04cd763d":"code","7a06f7cb":"code","fa85368f":"code","735ba560":"code","1f62b716":"code","0e115c59":"code","aa4e9b85":"code","2407c12f":"code","a500252b":"code","fb5d5619":"code","65a9b985":"code","8524e9b8":"code","4c1a7d8e":"code","7714a973":"code","73e553df":"code","66fcc005":"code","ded946c7":"code","27b11037":"code","0eeb92f8":"code","85cccb60":"code","830a0463":"markdown","5853a001":"markdown","4166ba9a":"markdown","609b78d2":"markdown","a1ce4789":"markdown","84f31e11":"markdown","ed241dbd":"markdown","0278c00c":"markdown","fdf0416a":"markdown"},"source":{"abc08cd6":"import numpy as np\n\nfrom fastai.vision.all import *","82633cb6":"source_dir = \"\/kaggle\/input\/covid19-radiography-database\/COVID-19_Radiography_Dataset\"\n\nrandom_seed = 42\nnp.random.seed(random_seed)\nrandom.seed(random_seed)\n\nepochs = 20\n\nvalid_split = 0.2","b16de1ee":"fields = DataBlock(blocks=(ImageBlock, CategoryBlock),\n   get_items=get_image_files,\n   get_y=parent_label,\n   splitter=RandomSplitter(valid_pct=valid_split, seed=random_seed),\n   item_tfms=RandomResizedCrop(224, min_scale=0.5),\n   batch_tfms=aug_transforms())","c7ac22d8":"dls = fields.dataloaders(source_dir)\ndls.vocab","6d311fe2":"dls.train.show_batch(max_n=8, nrows=2)","04cd763d":"# Setup convolutional neural network learner\nlearn = cnn_learner(dls, vgg19_bn, metrics=error_rate)","7a06f7cb":"# Automatical find optimal learning rate\nlr_min, lr_steep = learn.lr_find()","fa85368f":"# Run training with found learning rate\nlearn.fit_one_cycle(epochs, lr_min, cbs=[ShowGraphCallback()])","735ba560":"# Plot confusion matrix\ninterp = ClassificationInterpretation.from_learner(learn)\ninterp.plot_confusion_matrix()","1f62b716":"# Show images with maximum loss\ninterp.plot_top_losses(6, nrows=2)","0e115c59":"# Setup convolutional neural network learner\nlearn = cnn_learner(dls, resnet34, metrics=error_rate)","aa4e9b85":"# Automatical find optimal learning rate\nlr_min, lr_steep = learn.lr_find()","2407c12f":"# Run training with found learning rate\nlearn.fit_one_cycle(epochs, lr_min, cbs=[ShowGraphCallback()])","a500252b":"# Plot confusion matrix\ninterp = ClassificationInterpretation.from_learner(learn)\ninterp.plot_confusion_matrix()","fb5d5619":"# Show images with maximum loss\ninterp.plot_top_losses(6, nrows=2)","65a9b985":"# Setup convolutional neural network learner\nlearn = cnn_learner(dls, densenet201, metrics=error_rate)","8524e9b8":"# Automatical find optimal learning rate\nlr_min, lr_steep = learn.lr_find()","4c1a7d8e":"# Run training with found learning rate\nlearn.fit_one_cycle(epochs, lr_min, cbs=[ShowGraphCallback()])","7714a973":"# Plot confusion matrix\ninterp = ClassificationInterpretation.from_learner(learn)\ninterp.plot_confusion_matrix()","73e553df":"# Show images with maximum loss\ninterp.plot_top_losses(6, nrows=2)","66fcc005":"# Setup convolutional neural network learner\nlearn = cnn_learner(dls, resnet152, metrics=error_rate)","ded946c7":"# Automatical find optimal learning rate\nlr_min, lr_steep = learn.lr_find()","27b11037":"# Run training with found learning rate\nlearn.fit_one_cycle(epochs, lr_min, cbs=[ShowGraphCallback()])","0eeb92f8":"# Plot confusion matrix\ninterp = ClassificationInterpretation.from_learner(learn)\ninterp.plot_confusion_matrix()","85cccb60":"# Show images with maximum loss\ninterp.plot_top_losses(6, nrows=2)","830a0463":"# Lungs X-Ray COVID images processing with FastAI","5853a001":"### resnet34","4166ba9a":"### resnet152","609b78d2":"### vgg19_bn","a1ce4789":"### densenet201","84f31e11":"## Setup","ed241dbd":"### Data pipeline\n- Load images and set labels by dir name\n- Split dataset for train and validation parts using `valid_split`\n- Setup augmentation to avoid overfitting","0278c00c":"#### Comparison of performance for COVID-19 Rradiography Database of four CNN architectures:\n- VGG19 (with batch normalization)\n- ResNet34\n- DenseNet201\n- ResNet152","fdf0416a":"## Models"}}