{"cell_type":{"9c7a8dbd":"code","461cc35d":"code","f48495cf":"code","bcc1f4fe":"code","8eae4f45":"code","9ba76944":"code","c1f94c45":"code","3b1a53e8":"code","d10961d3":"code","031e74af":"code","7780f42c":"code","d1f8178b":"code","171f4612":"code","7959688a":"markdown","d07787fc":"markdown","affcbb69":"markdown","b4f8d90c":"markdown","a4686e92":"markdown","79586c47":"markdown","efb0cd36":"markdown","9703f9a2":"markdown","587d1ef6":"markdown","f875c02b":"markdown","5b5c5631":"markdown","0ca6e392":"markdown","dc6e9bfb":"markdown"},"source":{"9c7a8dbd":"#initial tools\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n#plotting tools\n%matplotlib inline\n#show plots directly\nimport matplotlib.pyplot as plt # plotting in details\nimport seaborn as sns # to ease complex plots\n\n# modeling and scoring tools\nfrom sklearn.ensemble import RandomForestClassifier # the model we will use\nfrom sklearn.model_selection import train_test_split # splitting the data int train and test tool\nfrom sklearn.metrics import confusion_matrix,f1_score # scoring tools and technics\n\nimport warnings \nwarnings.filterwarnings(\"ignore\") # ignore file warnings ","461cc35d":"df = pd.read_csv(\"\/kaggle\/input\/heart-attack-analysis-prediction-dataset\/heart.csv\")\ndf.head()","f48495cf":"# information about the data\ndf.info()","bcc1f4fe":"sns.set_style(\"darkgrid\") # set a background style for the plots","8eae4f45":"#lets see the age range in a histogram \nplt.figure(figsize=(10,6)) #setting size of the plot\nsns.histplot(data=df,x=\"age\",bins=10);","9ba76944":"#angina and age\nplt.figure(figsize=(15,10)) #setting the plot size\nsns.barplot(data=df,x=\"age\",y=\"exng\"); ","c1f94c45":"#relation between age and highest heart rate and how likely that patient will have heart attack\n\nsns.lmplot(data=df,x=\"age\",y=\"thalachh\",hue=\"output\",fit_reg=False);","3b1a53e8":"#creat new feature and read an existing feature\n\n#creating a feature\ndf[\"c\/o\"]=df[\"cp\"]\/df[\"thalachh\"]\n\n#reading an existing feature\ndf[\"sat\"] = pd.read_csv(\"\/kaggle\/input\/heart-attack-analysis-prediction-dataset\/o2Saturation.csv\")","d10961d3":"#defining the dependant and independant columns\n\nX = df.drop([\"output\"],axis=1) #independant columns\ny = df.output #dependant column\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2,random_state=42) #splitting the data into train and test ","031e74af":"reg = RandomForestClassifier(n_jobs=-1,n_estimators=40,min_samples_leaf=2,random_state=42,ccp_alpha=0.01) #using random forest as a model\n\n#before i choose this parameters i ran gridsearchcv these are the parameters that worked to save time for you\n\nreg.fit(X_train,y_train) #training the model","7780f42c":"print(\"accuracy score on the training set : \",reg.score(X_train,y_train))\nprint(\"accuracy score on the test set : \",reg.score(X_test,y_test))","d1f8178b":"print(\"F1 score on the training set : \",f1_score(y_train,reg.predict(X_train)))\nprint(\"F1 score on the test set : \",f1_score(y_test,reg.predict(X_test)))","171f4612":"#confusin matrix\npred = reg.predict(X_test)\n                   \nsns.heatmap(confusion_matrix(y_test,pred),annot=True);","7959688a":"## brief about the Features","d07787fc":"out of 61 example there is only 6 example which got predicted wrong","affcbb69":"## Read the data","b4f8d90c":"we see ages (29 34 37 39 49 65 69 71 76) do not experience angina during exercise. ","a4686e92":"## Scoring","79586c47":"## Modeling","efb0cd36":"we see no null values , most of the types are int64 but oldpeak is float","9703f9a2":"Age : Age of the patient\n\nSex : Sex of the patient\n\nexang: exercise induced angina (1 = yes; 0 = no)\n\nca: number of major vessels (0-3)\n\ncp : Chest Pain type chest pain type\n* Value 1: typical angina\n* Value 2: atypical angina\n* Value 3: non-anginal pain\n* Value 4: asymptomatic\n* trtbps : resting blood pressure (in mm Hg)\n\nchol : cholestoral in mg\/dl fetched via BMI sensor\n\nfbs : (fasting blood sugar > 120 mg\/dl) (1 = true; 0 = false)\n\nrest_ecg : resting electrocardiographic results\n\n* Value 0: normal\n* Value 1: having ST-T wave abnormality (T wave inversions and\/or ST elevation or depression of > 0.05 mV)\n* Value 2: showing probable or definite left ventricular hypertrophy by Estes' criteria\nthalach : maximum heart rate achieved\n\ntarget : 0= less chance of heart attack 1= more chance of heart attack","587d1ef6":"## Creating features and Splitting the data","f875c02b":"## Importing the tools","5b5c5631":"## Simple EDA","0ca6e392":"we see that probability of having heart attack increase after the maximum heart rate achieved exceed 120 ","dc6e9bfb":"#### thank you "}}