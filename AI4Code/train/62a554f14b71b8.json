{"cell_type":{"109a4d84":"code","18b09fd1":"code","10e2cc77":"code","57c8f248":"code","26bbc406":"code","20310ad8":"code","a4a53524":"code","e89192b8":"code","9ae43456":"code","4d2daeaf":"code","e4c88abb":"code","cbe37ee6":"code","efdec121":"code","b91c5900":"code","89ab2614":"code","8f75a2c4":"code","044266a9":"code","25503c3d":"code","e8215f54":"code","d5292082":"markdown","6aff15ac":"markdown","6beb5186":"markdown","00ae5d39":"markdown","a3abfbbe":"markdown","edc9b29f":"markdown","06ddca36":"markdown","75820ed3":"markdown","52ea94ef":"markdown","0f98df07":"markdown","aff2cf00":"markdown","8ca83baa":"markdown","fd1c551d":"markdown"},"source":{"109a4d84":"# Importing libraries\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom sklearn.cluster import KMeans\nfrom sklearn.metrics import silhouette_score\n%matplotlib inline\nplt.rcParams['figure.figsize'] = (15, 6)","18b09fd1":"# importing dataset\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","10e2cc77":"df = pd.read_csv('\/kaggle\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv')","57c8f248":"df","26bbc406":"# lets get some info about the dataset\ndf.info()","20310ad8":"# so lets rename the last 2 columns\ndf.rename(columns={'Annual Income (k$)':'Income', 'Spending Score (1-100)':'Spending_score'}, inplace=True)\ndf.head()","a4a53524":"# let's remove the customerID column becuase it's useless\ndf.drop(columns=['CustomerID'], axis=1, inplace=True)","e89192b8":"# lets check the data statisticuly or summarize the data\ndf.describe()","9ae43456":"# lets visualize the features and relation with eachother\nsns.pairplot(df)","4d2daeaf":"X = df[['Income','Spending_score']]\ndist_points_from_centroids = []\nslscore = []\nk = range(2,10)\nfor clusters in k:\n    model = KMeans(n_clusters=clusters, max_iter=1000, random_state=10).fit(X)\n    dist_points_from_centroids.append(model.inertia_)\n    slscore.append(silhouette_score(X,model.labels_))\nplt.xlabel(\"K\")\nplt.ylabel(\"inertia\")\nplt.title(\"Elbow Method\")\nplt.plot(k,dist_points_from_centroids)","e4c88abb":"plt.xlabel(\"K\")\nplt.ylabel(\"score\")\nplt.title(\"Silhouette score\")\nplt.plot(k, slscore)","cbe37ee6":"# lets create the model \nkmeans = KMeans(n_clusters=5, max_iter=1000, random_state=10).fit(X)","efdec121":"# lets see that labels assigned to the clusters\nkmeans.labels_","b91c5900":"# lets make a new column named as cluster and assign labels into it.\ndf['cluster']=kmeans.labels_","89ab2614":"df.head()","8f75a2c4":"# lets see the number of poeple lie in each group\nplt.title(\"clusters with the number of customers\")\nplt.xlabel(\"clusters\")\nplt.ylabel(\"Count\")\ndf.cluster.value_counts().plot(kind='bar')","044266a9":"df.groupby(df.cluster).mean().plot(kind='bar')\nplt.show()","25503c3d":"plt.title(\"Men VS Women ratio in each cluster\")\nplt.ylabel(\"Count\")\nsns.countplot(x=df.cluster, hue=df.Gender)\nplt.show()","e8215f54":"plt.figure(figsize=(15,9))\ng=sns.scatterplot(x='Income', y='Spending_score', hue='cluster', data=df,palette=['green','orange','brown','dodgerblue','red'], legend='full')","d5292082":"**We see that between Spending_score and Income appears 5 groups of people**","6aff15ac":"**with info command we get that there are 200 rows and 5 columns and there's no missing data required to deal with. Most of the data is numeric.**","6beb5186":"## let's visualize clusters","00ae5d39":"### Ratio of women is greater than men in every cluster except cluster 4","a3abfbbe":"# End","edc9b29f":"# Customer Segmentation\n### Finding the target customers for a mall by analyzing the spending score of customers on the basis of their age and income. Spending score is calculated on the behavior of purchasing.","06ddca36":"## OK let's analyze the ratio of spending between men and women in each cluster","75820ed3":"### Number of people with highest spending score lies in cluster 1 and 3 around the age of 25 and 30. In cluster 1 customers are earning the great amount But what about in cluster 3 they don't earn that much but again the spend a lot. If we see in cluster 0,2 and 4 they are all aged around 45, People in cluster 0 spends as much they earn seems like they're having big family maybe. which is not the case with cluster 4 they earn a lot but they don't spend, means having small family, that's what could be a guess. Finally the 2 cluster having parental age spends as much they earn again they are also supporting the big family","52ea94ef":"## Using Elbow method to find the number of clusters","0f98df07":"**We see that in above graph there's a line representing elbow and elbow is exactly mapping on 5 number which means there are 5 clusters**","aff2cf00":"**We see that cluster 5 has gotten the highest score which means n_clusters=5 is the right choice**","8ca83baa":"## Cluster 0 has the most customers. let's see how the customers in this cluster differ from others","fd1c551d":"## lets validate the number of cluster with silhouette score"}}