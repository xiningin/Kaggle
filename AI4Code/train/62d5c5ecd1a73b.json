{"cell_type":{"e933d15c":"code","6c354724":"code","d6d2efce":"code","e23d7f98":"code","47a048f5":"code","82a900ae":"code","0ff2ec37":"code","87d38317":"code","fe6bc3af":"code","dcda4437":"code","790199c3":"code","f11bda16":"code","a77f4051":"code","c7ce70ba":"code","851dd991":"code","ecffff72":"code","5e213486":"code","c663a5f6":"code","44d6e851":"code","f37284de":"code","73bb1f90":"code","ac1837f1":"code","95bf9a93":"code","628b73e4":"code","c57d44cb":"markdown","e9d414bd":"markdown","38dcbe6d":"markdown","1c22b794":"markdown","e64fdfed":"markdown","3f9abc6f":"markdown","f50a45e3":"markdown","568a42c2":"markdown","a001b37d":"markdown","cbec3575":"markdown","75d5da2b":"markdown","8f917e1e":"markdown","b1822485":"markdown","a91a80cf":"markdown","f260a146":"markdown","978dbb64":"markdown","fa4c43d1":"markdown","4d5b38a1":"markdown","4538e267":"markdown","dc3ec9c9":"markdown","bea50672":"markdown","a3ed5ea4":"markdown","812f2a5c":"markdown","586c0fbb":"markdown"},"source":{"e933d15c":"import numpy as np\nimport pandas as pd\n\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\nfrom pandas.plotting import scatter_matrix\n\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.tree import DecisionTreeClassifier\n\nfrom sklearn import preprocessing\nfrom sklearn.compose import ColumnTransformer\n\nprint('Import complete')","6c354724":"data = pd.read_csv(\"..\/input\/heart-disease-uci\/heart.csv\")\nX = data.drop(\"target\", axis=1)\ny = data.target\n\nprint(f\"data shape: {X.shape}\\ntarget shape: {y.shape}\")\n\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)","d6d2efce":"X_train.sample(10)","e23d7f98":"data.isnull().sum()","47a048f5":"data.describe()","82a900ae":"fig, axes = plt.subplots(1, 2, figsize=(20, 5))\nsns.kdeplot(ax=axes[0], x=data.age)\nsns.countplot(ax=axes[1], x=data.sex)\n\nplt.show()","0ff2ec37":"people_with_cad = data.loc[data.target == 1]\npeople_without_cad = data.loc[data.target == 0]\n\nplt.subplots(figsize=(6, 5))\nsns.countplot(x=data.target)\nplt.title(\"Target (heart disease)\")\nplt.xlabel(\"Has a heart disease (0 = no, 1 = yes)\")\nplt.show()","87d38317":"corr = data.corr()\nplt.subplots(figsize=(15, 10))\nsns.heatmap(corr, annot=True)\nplt.show()","fe6bc3af":"data.cp.unique()","dcda4437":"cp = []\npc = []\nfor i in range(0, 4):\n    cp_ = data.loc[data.cp == i]\n    s = cp_.target.sum()\n    t = cp_.target.size\n    p = np.round((s\/t)*100)\n    print(f\"{s} people of {t} people with chest pain type ({i}) had a heart disease. --> {p}%\")\n    cp.append(i)\n    pc.append(p)","790199c3":"plt.subplots(figsize=(8, 5))\nplt.bar(cp, pc)\nplt.xlabel(\"Chest Pain\")\nplt.ylabel(\"Percentage with heart disease\")\nplt.xticks(cp)\nplt.show()","f11bda16":"fig, axes = plt.subplots(1, 2, figsize=(15, 5))\nsns.stripplot(ax=axes[0], x=\"target\", y=\"thalach\", data=data)\nplt.ylabel(\"maximum heart rate achieved (thalach)\")\n\nsns.boxplot(ax=axes[1], x=\"target\", y=\"thalach\", data=data)\nplt.ylabel(\"maximum heart rate achieved (thalach)\")\n\nplt.show()","a77f4051":"thalach_cad = data.thalach.loc[data.target == 1]\nthalach_no_cad = data.thalach.loc[data.target == 0]\n\nthalach_max = np.max(thalach_cad)\nthalach_min = np.min(thalach_cad)\nthalach_mean = np.mean(thalach_cad)\n\nthalach_max_no = np.max(thalach_no_cad)\nthalach_min_no = np.min(thalach_no_cad)\nthalach_mean_no = np.mean(thalach_no_cad)\n\nprint(f\"Mean with CAD: {thalach_mean}\\nMean without CAD: {thalach_mean_no}\\n\")\nprint(f\"Max with CAD: {thalach_max}\\nMax without CAD: {thalach_max_no}\\n\")\nprint(f\"Min with CAD: {thalach_min}\\nMin without CAD: {thalach_min_no}\")","c7ce70ba":"fig, axes = plt.subplots(1, 2, figsize=(15, 5))\nsns.stripplot(ax=axes[0], x=\"target\", y=\"trestbps\", data=data)\nplt.ylabel(\"blood pressure (trestbps)\")\n\nsns.boxplot(ax=axes[1], x=\"target\", y=\"trestbps\", data=data)\nplt.ylabel(\"blood pressure (trestbps)\")\n\nplt.show()","851dd991":"sns.lmplot(x=\"age\", y=\"trestbps\", data=data)\nplt.title(\"Linear relation between age and blood pressure.\")\nplt.show()","ecffff72":"data.slope.unique()","5e213486":"sl = []\npc = []\n\nfor i in range(0, 3):\n    sl_ = data.loc[data.slope == i]\n    s = sl_.target.sum()\n    t = sl_.target.size\n    p = np.round((s\/t)*100)\n    print(f\"{s} people of {t} people with ST-segment slope of: {i} had a heart disease. --> {p}%\")\n    sl.append(i)\n    pc.append(p)","c663a5f6":"plt.subplots(figsize=(8, 5))\nplt.bar(sl, pc)\nplt.xlabel(\"ST-segment slope\")\nplt.ylabel(\"Percentage with heart disease\")\nplt.xticks(sl)\nplt.show()","44d6e851":"data.head()\nprint(f\"Max: {data.oldpeak.max()}\")\nprint(f\"Min: {data.oldpeak.min()}\")","f37284de":"fig, axes = plt.subplots(1, 2, figsize=(15, 5))\nsns.stripplot(ax=axes[0], x=\"target\", y=\"oldpeak\", data=data)\nsns.boxplot(ax=axes[1], x=\"target\", y=\"oldpeak\", data=data)\nplt.show()","73bb1f90":"plt.subplots(figsize=(10,5))\nsns.boxplot(x=\"slope\", y=\"oldpeak\", data=data)\nplt.title(\"Correlation between ST-segment slope and oldpeak\")\nplt.show()","ac1837f1":"model = LogisticRegression(max_iter=500)\n\nX_train = preprocessing.StandardScaler().fit_transform(X_train)\n\nmodel.fit(X_train, y_train)\nprint(\"Score with train data: %.3f\" % model.score(X_train, y_train))","95bf9a93":"X_test = preprocessing.StandardScaler().fit_transform(X_test)\n\ntest_preds = model.predict(X_test)\nprint(f\"Test predictions:\\n{test_preds}\")","628b73e4":"print(f\"Score with test data: %.3f\" % model.score(X_test, y_test))","c57d44cb":"We can see that only few people in this dataset have a ST-segment slope of 0 (21 people). \nAddidionaly it is clear that a very high slope (2) seems to be correlated with a heart disease as 74% (of 142 people) had one.","e9d414bd":"Creating a simple LogisticRegression model using sklearn.","38dcbe6d":"## 2.5 Blood pressure","1c22b794":"We can see that people with chest pain types number 1, 2 and 3 have a high chance of getting a heart disease. This result matches our correlation heatmap where chest pain had one of the highest correlations with the target.\nNotice that a lot of people in this dataset had chest pain type number 0.","e64fdfed":"We can see that the age has a normal distribution which ranges from 29 to 77 years. There are more men than women in this dataset.\n\n","3f9abc6f":"## 2.3 Chest pain:\n","f50a45e3":"Blood pressure doesnt seem to have a strong impact on heart diseases. But we can see a strong linear relation to age. It is widely known that blood pressure increases with higher age.","568a42c2":"## 2.6 ST-segment:","a001b37d":"# 3. Model creation","cbec3575":"### Attributes with explanations\n<table  style=\"float:left;\">\n    <tr>\n        <td>age<\/td>\n        <td>age<\/td>\n    <\/tr>\n    <tr>\n        <td>sex<\/td>\n        <td>1 = male, 0 = female<\/td>\n    <\/tr>\n    <tr>\n        <td>cp<\/td>\n        <td>chest pain type (4 values, 0 - 3)<\/td>\n    <\/tr>\n    <tr>\n        <td>trestbps<\/td>\n        <td>resting blood pressure<\/td>\n    <\/tr>\n    <tr>\n        <td>chol<\/td>\n        <td>serum cholestoral in mg\/dl<\/td>\n    <\/tr>\n    <tr>\n        <td>fbs<\/td>\n        <td>fasting blood sugar > 120 mg\/dl<\/td>\n    <\/tr>\n     <tr>\n        <td>trestbps<\/td>\n        <td>resting electrocardiographic results (values 0,1,2)<\/td>\n    <\/tr>\n    <tr>\n        <td>chol<\/td>\n        <td>maximum heart rate achieved<\/td>\n    <\/tr>\n    <tr>\n        <td>fbs<\/td>\n        <td>exercise induced angina<\/td>\n    <\/tr>\n        <tr>\n        <td>oldpeak<\/td>\n        <td>ST depression induced by exercise relative to rest (ST-segment is abnormally low below the baseline)<\/td>\n    <\/tr>\n     <tr>\n        <td>slope<\/td>\n        <td>the slope of the peak exercise ST segment<\/td>\n    <\/tr>\n    <tr>\n        <td>chol<\/td>\n        <td>number of major vessels (0-3) colored by flourosopy <\/td>\n    <\/tr>\n    <tr>\n        <td>thal<\/td>\n        <td>3 = normal; 6 = fixed defect; 7 = reversable defect<\/td>\n    <\/tr>\n<\/table>","75d5da2b":"## 2.2 Correlation between attributes:","8f917e1e":"Several researches say that the slope of the ST-segment is a good way to predict coronary artery disease (which can lead to several other heart diseases).\n<br>\nA short quote from a study about this topic:\n\n> The ST\/HR slope was an improved ECG criterion for diagnosing CAD and compared favorably with TI imaging.\n\n<u>Source:<\/u><br>\nFinkelhor RS, Newhouse KE, Vrobel TR, Miron SD, Bahler RC. The ST segment\/heart rate slope as a predictor of coronary artery disease: comparison with quantitative thallium imaging and conventional ST segment criteria. Am Heart J. 1986 Aug;112(2):296-304. doi: 10.1016\/0002-8703(86)90265-6. PMID: 3739881.","b1822485":"# Predicting heart diseases using Logistic Regression\n\nThis is still a work in progress!\n\nFuture additions:\n- include EDA findings in model creation\n- feature generation \/ selection","a91a80cf":"## 2.1 CAD:","f260a146":"Correlation heat map shows mildly to strong positive correlation:\n- between chest pain (cp) and target -> +0.43 \n- between maximum heartbeat (thalach) and target -> +0.42\n- between slope of the ST-segment (slope) and target -> +0.35\n\nCorrelation heat map shows mildly to strong negative correlation:\n- between exang and target -> -0.44\n- between oldpeak and target -> -0.43\n- between ca and target -> -0.39\n- between thal and target -> -0.34","978dbb64":"# 2. Exploratory data analysis (EDA)","fa4c43d1":"We have a fairly even distribution of people with and without a heart disease.","4d5b38a1":"Both the stripplot and the boxplot show that people with high maximum heart rates seem to get heart diseases more likely than people with a lower heart rate.\nWe can also see a few outliers which we may have to deal with later on.","4538e267":"### 2.6.1 ST-segment slope:","dc3ec9c9":"### 2.6.2 ST-segment depression","bea50672":"## 2.4 Maximum heart rate:","a3ed5ea4":"# 1. Loading data","812f2a5c":"A short summary in numbers which shows the same results as the plots. We have higher mean maximum heart rates in the group of people with a heart disease.","586c0fbb":"Here you can see the different slopes of the ST-Segment in an ECG.\n- yellow -> slope = 0\n- green -> slope = 1\n- red -> slope = 2\n\n![ST-Segment ECG](http:\/\/www.marc-julian.de\/images\/stsegment.jpeg)\n\n### More pictures visualising the slope:\n\n![ST-Segment slow slope](https:\/\/www.marc-julian.de\/images\/slowslope.jpg)\n![ST-Segment rapid slope](https:\/\/www.marc-julian.de\/images\/rapidslope.jpg)"}}