{"cell_type":{"59ead03d":"code","af501680":"code","49a8d1e2":"code","ae1f6920":"code","59c3220f":"code","a42ed2f1":"code","d88d0181":"code","be9bfe28":"code","6727f853":"code","529cf270":"code","5565d649":"code","00f6131e":"code","0cd36dee":"code","3ecaae98":"code","26c0fb82":"code","78fe4a29":"code","f6a06512":"code","26ff0cae":"code","26deadfa":"code","43ecad37":"code","f1cb8d18":"code","466ff1a3":"code","b17b9274":"code","a6291ad9":"code","30d4558d":"markdown","2fa766db":"markdown","ac88f17e":"markdown","c5e94b30":"markdown","daa85042":"markdown"},"source":{"59ead03d":"import numpy as np\nimport pandas as pd\nimport plotly.express as px\nimport plotly.graph_objs as go\nfrom plotly.subplots import make_subplots\n!pip install country_converter\nimport country_converter as coco\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","af501680":"df = pd.read_csv('..\/input\/climate-change-earth-surface-temperature-data\/GlobalLandTemperaturesByCountry.csv')\ndf['Country'] = df['Country'].str.replace(' (Europe)','')","49a8d1e2":"# Extract dates\ndf['day'] = df['dt'].str[-2:]\ndf['year'] = df['dt'].str[:4]\ndf['month'] = df['dt'].str[5:7] ","ae1f6920":"yearly_max = df.groupby(by=[\"Country\",'year'])['AverageTemperature'].max().reset_index()\nyearly_min = df.groupby(by=[\"Country\",'year'])['AverageTemperature'].min().reset_index()","59c3220f":"yearly_diff = yearly_max.drop('AverageTemperature',1)\nyearly_diff['change'] = yearly_max['AverageTemperature'] - yearly_min['AverageTemperature']\nyearly_diff.head(3)","a42ed2f1":"long_code = pd.read_csv('..\/input\/long-country-codes\/country_codes.csv')\nshort_code = pd.read_csv('..\/input\/country-codes\/country_codes.csv')\nshort_code.head(3)","d88d0181":"yearly_diff['2code'] = yearly_diff['Country'].map(long_code.set_index('Name')['Code'])\nyearly_diff['3code'] = yearly_diff['2code'].map(short_code.set_index('Alpha-2 code')['Alpha-3 code'])\nyearly_diff = yearly_diff.sort_values(by=['year','3code'])\nyearly_diff['year'] = yearly_diff['year'].astype(int)","be9bfe28":"fig = px.choropleth(yearly_diff[ yearly_diff['year'] > 1899], \n                    locations=\"3code\",\n                    color_continuous_scale=\"YlOrBr\",\n                    color=\"change\",\n                    animation_frame=\"year\",\n                    )\n\nfig.update_layout(\n    title_text = 'Yearly Max - Min',\n    template=\"plotly_dark\",\n)\n\nfig.update_geos(\n    projection_type=\"miller\",\n    #fitbounds=\"locations\",\n    resolution=50,\n    landcolor=\"silver\",\n    oceancolor=\"cadetblue\",\n    showocean=True,\n    showlakes=False,\n)\n\nfig.show()","6727f853":"yearly_avg = df.groupby(by=[\"Country\",'year'])['AverageTemperature'].mean().reset_index()\nyearly_avg['year'] = yearly_avg['year'].astype(int)\nyearly_avg['2code'] = yearly_avg['Country'].map(long_code.set_index('Name')['Code'])\nyearly_avg['3code'] = yearly_avg['2code'].map(short_code.set_index('Alpha-2 code')['Alpha-3 code'])\nyearly_avg = yearly_avg.sort_values(by=['year','3code'])\nyearly_avg['year'] = yearly_avg['year'].astype(int)\nyearly_avg = yearly_avg[ yearly_avg['year'] > 1949]\nyearly_avg.head(3)","529cf270":"yearly_avg2 = yearly_avg.groupby(by=['year'])['AverageTemperature'].mean().reset_index()\nyearly_avg2.head()","5565d649":"\"\"\"\nfig = make_subplots(\n    rows=1, \n    cols=2,\n    subplot_titles=(\"Average Temp\", \"Global Average\"),\n    specs=[ [{\"type\": \"scattergeo\"},{\"type\": \"bar\"}]]\n)\n\nfor step in yearly_avg[\"year\"].unique():\n    fig.add_trace(\n        go.Choropleth(\n                    visible=False,\n                    colorbar_title = \"Temp (C)\", \n                    locations = yearly_avg[\"3code\"],\n                    colorscale='thermal',\n                    z = yearly_avg[\"AverageTemperature\"],\n                    ),\n        row=1,\n        col=1\n    )\n    \n    fig.append_trace(\n        go.Scatter(\n            x = yearly_avg2['year'], \n            y = yearly_avg2['AverageTemperature'],\n            mode='lines',\n            name='lines',\n            showlegend=False,),\n        row=1, \n        col=2\n    )\n    \n \n\nfig.data[0].visible = True\n\nyears = yearly_avg['year'].unique()\nsteps = []\nj = 0\nfor i in range(0, len(fig.data), 2):\n    step = dict(method=\"restyle\", args=[\"visible\", [False] * len(fig.data)],label ='Year:{}'.format(years[j]))\n    j += 1\n    step['args'][1][i] = True\n    step['args'][1][i+1] = True\n    steps.append(step)\n\nsliders = [dict(active=0,pad={\"t\": 50},steps=steps)]\n\n# Update geo subplot properties\nfig.update_geos(\n    projection_type=\"miller\",\n    fitbounds=\"locations\",\n    resolution=50,\n    landcolor=\"silver\",\n    oceancolor=\"cadetblue\",\n    showocean=True,\n    showlakes=False,\n)\n\n# Set theme, margin, and annotation in layout\nfig.update_layout(\n    template=\"plotly_dark\",\n    height = 800,\n    yaxis=dict(range=[18.2, 19.8]),\n    margin=dict(r=10, t=55, b=40, l=20),\n    title_text = 'Global Average Temp (C)',\n    sliders=sliders,\n    legend=dict(\n        orientation=\"h\",\n        yanchor=\"bottom\",\n        y=1.02,\n        xanchor=\"right\",\n        x=1\n    ),\n)\n\nfig.show()\n\"\"\"","00f6131e":"df['year'] = df['year'].astype(int)\nuncert = df[ df['year'] > 1949]\nuncert = uncert[ uncert['Country'] == 'Ireland']\nuncert.head(3)","0cd36dee":"fig = go.Figure([\n    go.Scatter(\n        name='Temp',\n        x=uncert['dt'],\n        y=uncert['AverageTemperature'],\n        mode='lines',\n        line=dict(color='rgb(75, 75, 75)'),\n    ),\n    go.Scatter(\n        name='Upper Bound',\n        x=uncert['dt'],\n        y=uncert['AverageTemperature'] + uncert['AverageTemperatureUncertainty'],\n        mode='lines',\n        marker=dict(color=\"#444\"),\n        line=dict(width=0),\n        showlegend=False\n    ),\n\n    go.Scatter(\n        name='Lower Bound',\n        x=uncert['dt'],\n        y=uncert['AverageTemperature'] - uncert['AverageTemperatureUncertainty'],\n        marker=dict(color=\"#444\"),\n        line=dict(width=0),\n        mode='lines',\n        fillcolor='rgba(255, 0, 0, 0.7)',\n        fill='tonexty',\n        showlegend=False\n    )\n])\nfig.update_layout(\n    yaxis_title='Temp(C)',\n    title='Temp with Uncertainty Range (C)',\n    hovermode=\"x\",\n    template=\"plotly_dark\",\n    height = 800,\n)\nfig.show()","3ecaae98":"hemi = df\nhemi['2code'] = df['Country'].map(long_code.set_index('Name')['Code'])\nhemi['3code'] = hemi['2code'].map(short_code.set_index('Alpha-2 code')['Alpha-3 code'])\nhemi = hemi.sort_values(by=['year','3code'])\nhemi = hemi.drop(['dt','day','2code'],1)\nhemi['year'] = hemi['year'].astype(int)\nhemi['hemisphere'] = hemi['Country'].isin(['Indonesia','Brazil','Ecuador','New Caledonia','Fiji','Falkland Islands','Swaziland','Peru',\n                                                   'Chile','Bolivia','Paraguay','Argentina','Uruguay','Angola','Namibia','Botswana','South Africa',\n                                                   'Zimbabwe','Tanzania','Mozambique','Zambia','Lesotho','Madagascar','Australia','Papua New Guinea',\n                                                   'New Zealand','Solomon Islands','Antarctica']).astype(int)\n#hemi['hemisphere'] = hemi['hemisphere'].replace(False,'Northern')\n#hemi['hemisphere'] = hemi['hemisphere'].replace(True,'Southern')\nhemi","26c0fb82":"# Average for each year by hemi\nhemi_avg = hemi.groupby(by=[\"hemisphere\",'year'])['AverageTemperature'].mean().reset_index()\nhemi_avg2 = hemi.groupby(by=[\"hemisphere\",'year'])['AverageTemperatureUncertainty'].mean().reset_index()\nhemi_avg['Uncert'] = hemi_avg2['AverageTemperatureUncertainty']\nhemi_avg = hemi_avg[hemi_avg['year'] > 1859]\nhemi_avg.head(3)","78fe4a29":"hemi_country = hemi.drop(['AverageTemperatureUncertainty','AverageTemperature','Country','year','month'],1).drop_duplicates() ","f6a06512":"colorscale = ['#06C','#F66']\n\nfig = make_subplots(\n    rows=1, \n    cols=2,\n    subplot_titles=(\"Country by Hemisphere\", \"Hemisphere Average\"),\n    specs=[ [{\"type\": \"scattergeo\"},{\"type\": \"bar\"}]]\n)\n\n# GeoMap\nfig.add_trace(\n    go.Choropleth(\n        locations = hemi_country['3code'],\n        z = hemi_country['hemisphere'],        \n        colorscale = colorscale,\n        showlegend=False,\n        showscale=False,\n    ),\n    row=1, col=1\n)\n\n# Southern Hemisphere\nfig.add_trace(\n    go.Scatter(\n        x = hemi_avg[hemi_avg['hemisphere'] == 1]['year'], \n        y = hemi_avg[hemi_avg['hemisphere'] == 1]['AverageTemperature'],\n        name='Southern',\n        marker_color='#F66',\n        ),\n    row=1, col=2\n)\n\n# Northern Hemisphere\nfig.add_trace(\n    go.Scatter(\n        x = hemi_avg[hemi_avg['hemisphere'] == 0]['year'], \n        y = hemi_avg[hemi_avg['hemisphere'] == 0]['AverageTemperature'],\n        name='Northern',\n        marker_color='#06C',\n        ),\n    row=1, col=2\n)\n\n# Uncertainty for Northern Hemi, Lowerbound\nfig.add_trace(\n    go.Scatter(\n        name='N.Hemi, Lower',\n        x = hemi_avg[hemi_avg['hemisphere'] == 0]['year'],\n        y = hemi_avg[hemi_avg['hemisphere'] == 0]['AverageTemperature'] - hemi_avg[hemi_avg['hemisphere'] == 0]['Uncert'],\n        marker=dict(color=\"#444\"),\n        line=dict(width=0),\n        mode='lines',\n        fillcolor='rgba(102,255,255,0.5)',\n        showlegend=False),\n    row=1, col=2\n)\n\n# Uncertainty for Northern Hemi, Upperbound\nfig.add_trace(\n    go.Scatter(\n        name='N.Hemi, Upper',\n        x = hemi_avg[hemi_avg['hemisphere'] == 0]['year'],\n        y = hemi_avg[hemi_avg['hemisphere'] == 0]['AverageTemperature'] + hemi_avg[hemi_avg['hemisphere'] == 0]['Uncert'],\n        marker=dict(color=\"#444\"),\n        line=dict(width=0),\n        mode='lines',\n        fillcolor='rgba(102,255,255,0.5)',\n        fill='tonexty',\n        showlegend=False),\n    row=1, col=2\n)\n\n# Uncertainty for Southern Hemi, Lowerbound\nfig.add_trace(\n    go.Scatter(\n        name='S.Hemi, Lower Bound',\n        x = hemi_avg[hemi_avg['hemisphere'] == 1]['year'],\n        y = hemi_avg[hemi_avg['hemisphere'] == 1]['AverageTemperature'] - hemi_avg[hemi_avg['hemisphere'] == 1]['Uncert'],\n        marker=dict(color=\"#444\"),\n        line=dict(width=0),\n        mode='lines',\n        fillcolor='rgba(255,255,204,0.5)',\n        showlegend=False),\n    row=1, col=2\n)\n\n# Uncertainty for Southern Hemi, Upperbound\nfig.add_trace(\n    go.Scatter(\n        name='S.Hemi, Upper',\n        x = hemi_avg[hemi_avg['hemisphere'] == 1]['year'],\n        y = hemi_avg[hemi_avg['hemisphere'] == 1]['AverageTemperature'] + hemi_avg[hemi_avg['hemisphere'] == 1]['Uncert'],\n        marker=dict(color=\"#444\"),\n        line=dict(width=0),\n        mode='lines',\n        fillcolor='rgba(255,255,204,0.5)',\n        fill='tonexty',\n        showlegend=False),\n    row=1, col=2\n)\n\nfig.update_geos(\n    projection_type=\"miller\",\n    resolution=50,\n    landcolor=\"white\",\n    oceancolor=\"cadetblue\",\n    showocean=True,\n    showlakes=False,\n)\n\nfig.update_layout(\n    template=\"plotly_dark\",\n    title_text = 'Global Average Temp (C)',\n)\n\nfig.show()","26ff0cae":"gas = pd.read_csv('..\/input\/grenhouse-gas\/gas_emissions(kt_c01_equiv).csv')\ngas['temp'] = 0\ngas = gas.melt(id_vars=[\"Country Name\", \"Country Code\"], value_vars=['1970','1971', '1972', '1973', '1974', '1975', '1976', '1977', '1978', '1979', '1980', '1981', '1982', '1983', '1984', '1985', '1986', '1987', '1988', '1989', '1990', '1991','1992', '1993', '1994', '1995', '1996', '1997', '1998', '1999', '2000', '2001', '2002', '2003', '2004', '2005', '2006', '2007', '2008', '2009', '2010', '2011', '2012'],var_name='year', value_name='CO2')","26deadfa":"co2_avg = gas.groupby(by=['Country Code'])['CO2'].mean().reset_index()\nco2_avg['CO2'].min()","43ecad37":"fig = make_subplots(rows=1,cols=1,\n    specs=[ [{\"type\": \"scattergeo\"}]]\n)\n\nfig.add_trace(\n    go.Choropleth(\n        locations = co2_avg['Country Code'],\n        z = co2_avg['CO2'],        \n        zmax=1000000,\n        zmin=8000,\n    ),\n    row=1, col=1\n)\n\nfig.update_geos(\n    projection_type=\"miller\",\n    resolution=50,\n    fitbounds='locations',\n    landcolor=\"white\",\n    oceancolor=\"cadetblue\",\n    showocean=True,\n    showlakes=False,\n)\n\nfig.update_layout(\n    template=\"plotly_dark\",\n    height=800,\n    title_text = '40yr Avg. Global CO2 Emissions (Kt)',\n)","f1cb8d18":"# Comparison between Continents\nlists = []\ncountries = gas['Country Name']\nfor country in countries:\n    lists.append( coco.convert(names = country, to = 'continent', not_found=None) )\ngas['continents'] = lists\ncontinents = ['America','Asia','Africa','Europe','Oceania']\nemissions = gas[gas['continents'].isin(continents) ]\nglobal_emissions = emissions.groupby(by=['continents','year'])['CO2'].mean().reset_index()","466ff1a3":"cont_temps = hemi\n#cont_temps = cont_temps.drop(['AverageTemperatureUncertainty','month','hemisphere'],1)\ncont_temps = cont_temps[ cont_temps['year'] > 1969]\ncont_temps = cont_temps.groupby(by=['Country','year'])['AverageTemperature'].mean().reset_index()\ncont_temps","b17b9274":"lists = []\ncountries = cont_temps['Country']\n\nfor country in countries:\n    lists.append( coco.convert(names = country, to = 'continent', not_found=None) )\ncont_temps['continents'] = lists\ncontinents = ['America','Asia','Africa','Europe','Oceania']\ncont_temps = cont_temps[cont_temps['continents'].isin(continents) ]\ncont_temps = cont_temps.groupby(by=['continents','year'])['AverageTemperature'].mean().reset_index()","a6291ad9":"fig = make_subplots(\n    rows=2, \n    cols=2,\n    subplot_titles=(\"40yr Avg CO2 Emissions (kt)\", \"CO2 Emissions by Continent\", \"Temp\"),\n    specs=[ [{\"type\": \"scattergeo\", \"rowspan\": 2},{\"type\": \"bar\"}],\n            [None,{\"type\": \"bar\"}] ])\n\nfig.add_trace(\n    go.Choropleth(\n        locations = co2_avg['Country Code'],\n        z = co2_avg['CO2'],        \n        zmax=1000000,\n        zmin=8000,\n        showscale=False,\n    ),\n    row=1, col=1\n)\n\nfig.add_trace(\n    go.Scatter(\n        x = global_emissions[global_emissions['continents'] == 'Europe']['year'], \n        y = global_emissions[global_emissions['continents'] == 'Europe']['CO2'],\n        name='Europe',\n        marker_color='#06C',\n        ),\n    row=1, col=2\n)\n\nfig.add_trace(\n    go.Scatter(\n        x = global_emissions[global_emissions['continents'] == 'Asia']['year'], \n        y = global_emissions[global_emissions['continents'] == 'Asia']['CO2'],\n        name='Asia',\n        marker_color='#C00',\n        ),\n    row=1, col=2\n)\n\nfig.add_trace(\n    go.Scatter(\n        x = global_emissions[global_emissions['continents'] == 'America']['year'], \n        y = global_emissions[global_emissions['continents'] == 'America']['CO2'],\n        name='America',\n        marker_color='#CC0',\n        ),\n    row=1, col=2\n)\n\nfig.add_trace(\n    go.Scatter(\n        x = global_emissions[global_emissions['continents'] == 'Oceania']['year'], \n        y = global_emissions[global_emissions['continents'] == 'Oceania']['CO2'],\n        name='Oceania',\n        marker_color='#C9F',\n        ),\n    row=1, col=2\n)\n\n#TEMPERATURE GRAPH\n\nfig.add_trace(\n    go.Scatter(\n        x = cont_temps[cont_temps['continents'] == 'Oceania']['year'], \n        y = cont_temps[cont_temps['continents'] == 'Oceania']['AverageTemperature'],\n        name='Oceania',\n        marker_color='#C9F',\n        showlegend=False,\n        ),\n    row=2, col=2\n)\n\nfig.add_trace(\n    go.Scatter(\n        x = cont_temps[cont_temps['continents'] == 'America']['year'], \n        y = cont_temps[cont_temps['continents'] == 'America']['AverageTemperature'],\n        name='America',\n        marker_color='#CC0',\n        showlegend=False,\n        ),\n    row=2, col=2\n)\n\nfig.add_trace(\n    go.Scatter(\n        x = cont_temps[cont_temps['continents'] == 'Europe']['year'], \n        y = cont_temps[cont_temps['continents'] == 'Europe']['AverageTemperature'],\n        name='Euorpe',\n        marker_color='#06C',\n        showlegend=False,\n        ),\n    row=2, col=2\n)\n\nfig.add_trace(\n    go.Scatter(\n        x = cont_temps[cont_temps['continents'] == 'Asia']['year'], \n        y = cont_temps[cont_temps['continents'] == 'Asia']['AverageTemperature'],\n        name='Asia',\n        marker_color='#C00',\n        showlegend=False,\n        ),\n    row=2, col=2\n)\n\nfig.update_geos(\n    projection_type=\"miller\",\n    resolution=50,\n    landcolor=\"white\",\n    oceancolor=\"cadetblue\",\n    showocean=True,\n    showlakes=False,\n)\n\nfig.update_layout(\n    height=800,\n    template=\"plotly_dark\",\n    title_text = 'Global Average Temp (C)',\n)\n\nfig.show()","30d4558d":"# Uncertainty","2fa766db":"# Change in Hemisphere Temp\nComparing a northern hemisphere country's temperature to a southern hemisphere country's temperature","ac88f17e":"# Yearly Max - Min\nEach countries change from their yearly max to yearly min.\nLimited from 1900 forward","c5e94b30":"# C02 Emissions vs Country","daa85042":"# Yearly Averages\nFrom 1900's forward"}}