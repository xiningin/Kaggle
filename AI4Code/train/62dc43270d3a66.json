{"cell_type":{"fa79f1a6":"code","a4c48428":"code","c32dce03":"code","ac9bb599":"code","d8582a18":"code","72b0a296":"code","065158d7":"code","fabd587d":"code","25f2e72a":"code","838ccf93":"code","a6c6da57":"code","5329b75d":"code","63dc2f66":"code","d21bead0":"code","998e3f81":"code","bfb7b5e2":"code","24ee2fe2":"code","26380cff":"code","1446f673":"code","48414ca4":"code","60e2d0d5":"code","118bcdf4":"code","98bd21a1":"code","45329d59":"code","2a572e6f":"code","01c03629":"code","71295630":"code","9b64cdf4":"code","f20973fb":"code","68d4f6ab":"code","25330461":"code","1f365e0b":"code","66e6d843":"code","dff81222":"code","178ecbb9":"code","facd9dcf":"code","835b238d":"code","f8b89963":"code","54c8d60c":"code","bc3d461e":"code","e45c4ede":"code","3fb08f75":"code","b7963a88":"code","a67209fa":"code","1a1ed8c9":"code","b182267e":"code","93be11de":"code","3d267f62":"code","76018490":"code","8bf69f31":"code","92969272":"code","d9ebaf28":"code","718a2c63":"code","659bad4e":"code","496e0345":"code","a0636eb8":"code","f7a65cbc":"code","81cae70c":"markdown","59206ec8":"markdown","243ed022":"markdown","1691422c":"markdown","ae2ceca0":"markdown","e7df3585":"markdown","8f3d725e":"markdown","0d703bf8":"markdown","0e5d604e":"markdown","2c0e87bf":"markdown","7a0ff9b3":"markdown","3079ee6b":"markdown","0065efd3":"markdown","956a4aad":"markdown","5fecc260":"markdown","c0fe2cc8":"markdown","4a3e4986":"markdown","ed3d5865":"markdown","08e7b426":"markdown","912438ea":"markdown","16a3e292":"markdown","2b7c114f":"markdown","f01bd316":"markdown","976679c3":"markdown","770c1fb5":"markdown","c175964f":"markdown","3fe254ae":"markdown"},"source":{"fa79f1a6":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","a4c48428":"import matplotlib.pyplot as plt\nimport seaborn as sns\nimport warnings\nimport gc\n\nwarnings.filterwarnings(\"ignore\")","c32dce03":"train_df = pd.read_csv(\"\/kaggle\/input\/tabular-playground-series-jan-2022\/train.csv\", sep=',')","ac9bb599":"train_df.head()","d8582a18":"train_df.tail()","72b0a296":"print('Dataset shape: ', train_df.shape)","065158d7":"train_df.info()","fabd587d":"train_df.dtypes.value_counts()","25f2e72a":"train_df.describe().T","838ccf93":"print(\"There are\", train_df.isna().any().sum(), \"missing values\")","a6c6da57":"train_df['date']","5329b75d":"# How many days are valid datas e.g not weekends\ndates = pd.to_datetime(train_df['date']).apply(lambda x: x.date()).unique()\nvalid_days = np.count_nonzero(np.is_busday(dates.astype('datetime64')))\nprint(valid_days, \"valid days out of\", len(dates))","63dc2f66":"# All years of data\nyears = set(map(lambda date: date.year, dates))\nprint(\"Years present in the data:\", sorted(years))","d21bead0":"months_each_year = {}\nfor year in years:\n    months_each_year[year] = set([date.month for date in dates if date.year == year])\n\nprint(\"Year and Months of data for each year:\")\nmonths_each_year","998e3f81":"days_each_month_per_year = {}\nfor year in years:\n    for month in months_each_year[year]:\n        days_each_month_per_year[str(year) + '-' + str(month)] = len([date.day for date in dates if date.year == year and date.month == month])\n\nprint(\"Days of available data for each month each year:\")\ndays_each_month_per_year","bfb7b5e2":"print(\"Unique values in every categorical variable\\n\")\nprint(\"country:\", train_df['country'].unique())\nprint()\nprint(\"store:\", train_df['store'].unique())\nprint()\nprint(\"product:\", train_df['product'].unique()) \t \t","24ee2fe2":"train_df.drop(['row_id'], axis=1).groupby([\"country\"]).sum()","26380cff":"train_df.drop(['row_id'], axis=1).groupby([\"country\"]).min()","1446f673":"train_df.drop(['row_id'], axis=1).groupby([\"country\"]).max()","48414ca4":"train_df.drop(['row_id'], axis=1).groupby([\"country\"]).mean()","60e2d0d5":"train_df.drop(['row_id'], axis=1).groupby([\"country\", \"store\"]).sum()","118bcdf4":"train_df.drop(['row_id'], axis=1).groupby([\"country\", \"store\"]).min()","98bd21a1":"train_df.drop(['row_id'], axis=1).groupby([\"country\", \"store\"]).max()","45329d59":"train_df.drop(['row_id'], axis=1).groupby([\"country\", \"store\"]).mean()","2a572e6f":"train_df.drop(['row_id'], axis=1).groupby([\"country\", \"store\", \"product\"]).sum()","01c03629":"train_df.drop(['row_id'], axis=1).groupby([\"country\", \"store\", \"product\"]).min()","71295630":"train_df.drop(['row_id'], axis=1).groupby([\"country\", \"store\", \"product\"]).max()","9b64cdf4":"train_df.drop(['row_id'], axis=1).groupby([\"country\", \"store\", \"product\"]).mean()","f20973fb":"train_df.drop(['row_id'], axis=1).groupby([\"product\"]).max()","68d4f6ab":"train_df.drop(['row_id'], axis=1).groupby([\"product\"]).min()","25330461":"fig, ax = plt.subplots(1, 3, figsize=(20, 5))\nax = ax.flatten()\ncolumns = train_df.select_dtypes(include='object').drop('date', axis=1).columns\n\nfor i, column in enumerate(columns):\n    sns.countplot(x=train_df[column], ax=ax[i])\n\nplt.tight_layout()\nfig.show()","1f365e0b":"categorical_vars = ['country', 'store', 'product']\n\nplt.figure(figsize=(10, 5))\nsns.boxplot(data = train_df, x='country', y='num_sold')","66e6d843":"plt.figure(figsize=(10, 5))\nsns.violinplot(data = train_df, x='country', y='num_sold')","dff81222":"plt.figure(figsize=(10, 5))\nsns.boxplot(data = train_df, x='store', y='num_sold')","178ecbb9":"plt.figure(figsize=(10, 5))\nsns.violinplot(data = train_df, x='store', y='num_sold')","facd9dcf":"plt.figure(figsize=(10, 5))\nsns.boxplot(data = train_df, x='product', y='num_sold')","835b238d":"plt.figure(figsize=(10, 5))\nsns.violinplot(data = train_df, x='product', y='num_sold')","f8b89963":"sns.countplot(data = train_df, x = 'country')","54c8d60c":"# Target Distribution\nplt.figure(figsize=(12, 7))\nsns.kdeplot(data=train_df, x='num_sold', palette = [\"#2a9d8f\"], shade=True)","bc3d461e":"df = pd.DataFrame({'num_sold' : train_df['num_sold'].values}, index=pd.to_datetime(train_df['date'].values))\nfig, ax = plt.subplots(1, 1, figsize=(15, 7))\nax.grid(which='both')\nax.legend(['Target variable (num_sold)'], loc=\"upper left\")\nax.set_ylabel('Number of goods sold', labelpad=20, fontsize=15)\ndf.plot(ax=ax)\nplt.show()","e45c4ede":"df = pd.DataFrame({'num_sold' : train_df['num_sold'].values}, index=pd.to_datetime(train_df['date'].values))\nyears = df.index.year.unique()\n\nfor year in years:\n    df_year = df[df.index.year == year]\n    fig, ax = plt.subplots(1, 1, figsize=(15, 7))\n    ax.grid(which='both')\n    ax.legend(['Target variable (num_sold)'], loc=\"upper left\")\n    ax.set_ylabel('Number of goods sold', labelpad=20, fontsize=15)\n    df_year.plot(ax=ax)\n    plt.show()","3fb08f75":"df = pd.DataFrame({'num_sold' : train_df['num_sold'].values,\n                   'country'  : train_df['country'].values},\n                  index=pd.to_datetime(train_df['date'].values))\n\nyears = df.index.year.unique()\ncountries = train_df.country.unique()\n\nfor country in countries:\n    print(f\"\\n--- {country} ---\\n\")\n    for year in years:\n        df_year = df[(df.index.year == year) & (df.country == country)]\n        fig, ax = plt.subplots(1, 1, figsize=(15, 7))\n        fig.subplots_adjust(hspace=0.30)\n        ax.grid(which='both')\n        ax.legend(['Target variable (num_sold)'], loc=\"upper left\")\n        ax.set_ylabel('Number of goods sold', labelpad=20, fontsize=15)\n        df_year.plot(ax=ax, title=country)\n        plt.show()","b7963a88":"df = pd.DataFrame({'num_sold' : train_df['num_sold'].values,\n                   'country'  : train_df['country'].values},\n                  \n                  index=pd.to_datetime(train_df['date'].values))\n\ndf['month'] = df.index.month\nyears = df.index.year.unique()\ncountries = train_df.country.unique()\n\nfor country in countries:\n    print(f\"\\n--- {country} ---\\n\")\n    for year in years:\n        df_year = df[(df.index.year == year) & (df.country == country)]\n        df_year = df_year.groupby(\"month\").sum()        \n        fig, ax = plt.subplots(1, 1, figsize=(15, 7))\n        \n        # fig.subplots_adjust(hspace=0.30)\n        ax.grid(which='both')\n        ax.legend(['Target variable (num_sold)'], loc=\"upper left\")\n        ax.set_ylabel('Total number of goods sold monthly', labelpad=20, fontsize=15)\n        df_year.plot(ax=ax, title=country + \" - \" + str(year))\n        plt.show()","a67209fa":"test_df = pd.read_csv(\"\/kaggle\/input\/tabular-playground-series-jan-2022\/test.csv\", sep=',')","1a1ed8c9":"test_df.head()","b182267e":"test_df.tail()","93be11de":"print('Dataset shape: ', test_df.shape)","3d267f62":"test_df.info()","76018490":"test_df.dtypes.value_counts()","8bf69f31":"print(\"There are\", test_df.isna().any().sum(), \"missing values\")","92969272":"print(\"Unique values in every categorical variable\\n\")\nprint(\"country:\", test_df['country'].unique())\nprint()\nprint(\"store:\", test_df['store'].unique())\nprint()\nprint(\"product:\", test_df['product'].unique()) \t \t","d9ebaf28":"test_df['date']","718a2c63":"# How many days are valid datas e.g not weekends\ndates = pd.to_datetime(test_df['date']).apply(lambda x: x.date()).unique()\nvalid_days = np.count_nonzero(np.is_busday(dates.astype('datetime64')))\nprint(valid_days, \"valid days out of\", len(dates))","659bad4e":"# All years of data\nyears = set(map(lambda date: date.year, dates))\nprint(\"Years present in the data:\", sorted(years))","496e0345":"months_each_year = {}\nfor year in years:\n    months_each_year[year] = set([date.month for date in dates if date.year == year])\n\nprint(\"Year and Months of data for each year:\")\nmonths_each_year","a0636eb8":"days_each_month_per_year = {}\nfor year in years:\n    for month in months_each_year[year]:\n        days_each_month_per_year[str(year) + '-' + str(month)] = len([date.day for date in dates if date.year == year and date.month == month])\n\nprint(\"Days of available data for each month each year:\")\ndays_each_month_per_year","f7a65cbc":"fig, ax = plt.subplots(1, 3, figsize=(20, 5))\nax = ax.flatten()\ncolumns = test_df.select_dtypes(include='object').drop('date', axis=1).columns\n\nfor i, column in enumerate(columns):\n    sns.countplot(x=test_df[column], ax=ax[i])\n\nplt.tight_layout()\nfig.show()","81cae70c":"<h3> Total Sales made by Country <\/h3>","59206ec8":"<h3>Full Series<\/h3>","243ed022":"<h3>Mean Sales made by country on each store<\/h3>","1691422c":"# Tabular Playground Series - Dec 2021 \n\nThe tabular series on kaggle are meant to help novices in data science field to get acquainted with kaggle competitions.\n\nFor this challenge, we will be predicting a full year worth of sales for three items at two stores located in three different countries. This dataset is completely fictional, but contains many effects you see in real-world data, e.g., weekend and holiday effect, seasonality, etc. The dataset is small enough to allow you to try numerous different modeling approaches. ","ae2ceca0":"# Yearly series\n","e7df3585":"# Explanatory variables Distribution (Categorical Variables)","8f3d725e":"<h4>country  num_sold boxplot and violinplot<\/h4>","0d703bf8":"<h3>The most sold product<\/h3>","0e5d604e":"# Test dataset\n\nFor the test dataset we will only check for missing values and if all classes are present in the data. The information gathered below shows that\nthe test data is similar to the train data.","2c0e87bf":"<h3>Mean Sales made by country on each store for each product<\/h3>","7a0ff9b3":"<h3>Box plot, violin plot and swarmplot of every categorical variable against the target variable (num_sold)<\/h3>\n\nFrom the boxplots below we can observe the following:\n\n1. Norway sold a bigger number of items than Finland and Sweden\n2. The store Kaggle Rama Sold much more items than the Kaggle Mart;\n3. Kaggle Hat has is the product most sold, followed by Kaggle Mug, and Kaggle Sticker the less sold product.","3079ee6b":"<h4>store  num_sold boxplot and violinplot<\/h4>","0065efd3":"# Yearly num_sold by country","956a4aad":"<h3>The lesser sold product<\/h3>","5fecc260":"<h3>Total Sales made by country on each store for each product<\/h3>","c0fe2cc8":"# Exploratory Data Analysis\n\nThis is not finished yet","4a3e4986":"<h3>Total Sales made by country on each store<\/h3>","ed3d5865":"<h4>product  num_sold boxplot and violinplot<\/h4>","08e7b426":"# Yearly total num_sold by month for each country","912438ea":"<h3>Min and Max sales by country<\/h3>","16a3e292":"<h3>Count plot of every categorical variable<\/h3>\n\nThe number of items sold is almost the same for every country, every product and every store. Every categorical variable is perfectly balanced.","2b7c114f":"# Train dataset\n\nLets first explore the train dataset and subsequently the test dataset.","f01bd316":"# Date variable exploratory data analysis","976679c3":"<h3>Min and Max Sales made by country on each store for each product<\/h3>","770c1fb5":"<h3> Mean Sales made by Country <\/h3>","c175964f":"train_dfget Variable Distribution","3fe254ae":"<h3>Min and Max sales made by country on each store<\/h3>"}}