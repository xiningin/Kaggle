{"cell_type":{"61b6458f":"code","a40ebf7b":"code","4996408b":"code","64e1516b":"code","ec34258c":"code","5c835515":"code","c84fc80f":"code","be042371":"code","7366189b":"code","f8abad0c":"markdown"},"source":{"61b6458f":"import numpy as np\nimport pandas as pd \nimport os\nimport cv2\nfrom tensorflow.keras.preprocessing.image import load_img\nfrom tensorflow.keras.preprocessing.image import img_to_array\nfrom tensorflow.keras.models import load_model","a40ebf7b":"train = pd.read_csv('..\/input\/petfinder-pawpularity-score\/train.csv')\ntest = pd.read_csv('..\/input\/petfinder-pawpularity-score\/test.csv')","4996408b":"train[\"file_path\"] = train[\"Id\"].apply(lambda identifier: \"..\/input\/petfinder-pawpularity-score\/train\/\" + identifier + \".jpg\")\ntest[\"file_path\"] = test[\"Id\"].apply(lambda identifier: \"..\/input\/petfinder-pawpularity-score\/test\/\" + identifier + \".jpg\")","64e1516b":"def load_image(filename):\n    # load the image\n    img = load_img(filename, target_size=(224, 224))\n    # convert to array\n    img = img_to_array(img)\n    # reshape into a single sample with 3 channels\n    img = img.reshape(1, 224, 224, 3)\n    # center pixel data\n    img = img.astype('float32')\n    img = img - [123.68, 116.779, 103.939]\n    return img","ec34258c":"res=[]\ndef run_example_train():\n    # load the image\n    model = load_model('..\/input\/catdogcnn\/cats_vs_dogs_model.h5')\n    for i in train['file_path'].values:\n        img = load_image(i)\n        # predict the class\n        result = model.predict(img)\n        result = result.flatten()\n        res.append(round(result[0]))","5c835515":"res_test=[]\ndef run_example_test():\n    # load the image\n    model = load_model('..\/input\/catdogcnn\/cats_vs_dogs_model.h5')\n    for i in test['file_path'].values:\n        img = load_image(i)\n        # predict the class\n        result = model.predict(img)\n        result = result.flatten()\n        res_test.append(round(result[0]))","c84fc80f":"run_example_train()\ntrain['class_label'] = res","be042371":"run_example_test()\ntest['class_label'] = res_test","7366189b":"train.class_label","f8abad0c":"# **Using CLass label for predicting the pawpularity helps reducing the error**"}}