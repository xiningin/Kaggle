{"cell_type":{"044efdef":"code","91f3392c":"code","fd6dd06e":"code","a8f8706a":"code","198ce5c6":"code","4c604a08":"code","d9428aa8":"code","202da471":"code","29c0bfca":"markdown","3e473497":"markdown","79bdb640":"markdown","57d5ad97":"markdown","ee16ef85":"markdown","2889f0d9":"markdown","65745fd4":"markdown"},"source":{"044efdef":"!pip install --upgrade lightgbm","91f3392c":"import pandas as pd\nimport lightgbm as lgb\n\nlgb.__version__","fd6dd06e":"train = pd.read_csv('\/kaggle\/input\/ieee-fraud-detection\/train_transaction.csv')\ntarget = train['isFraud']\ndel train['isFraud']","a8f8706a":"categories = [\n    'ProductCD', 'P_emaildomain', 'R_emaildomain',\n    'card1', 'card2', 'card3', 'card4', 'card5', 'card6', 'addr1', 'addr2',\n    'M1', 'M2', 'M3', 'M4', 'M5', 'M6', 'M7', 'M8', 'M9',\n]\nfor c in categories:\n    train[c] = train[c].astype('category')","198ce5c6":"params = {\n    'bagging_seed': 13,\n    'boosting_type': 'gbdt',\n    'feature_fraction': 0.3797454081646243,\n    'learning_rate': 0.006883242363721497,\n    'max_depth': -1,\n    'metric': 'auc',\n    'min_child_weight': 0.03454472573214212,\n    'min_data_in_leaf': 106,\n    'num_leaves': 256,\n    'objective': 'binary',\n    'reg_alpha': 0.3899927210061127,\n    'reg_lambda': 0.6485237330340494,\n    'seed': 71,\n    'verbosity': -1,\n}","4c604a08":"import lightgbm as lgb\nfrom sklearn.model_selection import train_test_split\n\ntrain_index, valid_index = train_test_split(train.index, test_size=0.2, shuffle=False)\ntrain_data = lgb.Dataset(train.loc[train_index], label=target.loc[train_index])\nvalid_data = lgb.Dataset(train.loc[valid_index], label=target.loc[valid_index])\n\nmodel = lgb.train(params, train_data, num_boost_round=5000, valid_sets=[train_data, valid_data],\n                  verbose_eval=100, early_stopping_rounds=100)","d9428aa8":"lgb.plot_importance(model, figsize=(20, 60), importance_type='gain', max_num_features=50)","202da471":"from IPython.display import display, HTML\nimport matplotlib.pyplot as plt\n\nfor feature in ['V258', 'C13', 'C14', 'C1', 'D2', 'V257', 'C11', 'V243', 'D15', 'V294', 'C4', 'V201', 'C8', 'D1', 'V317']:\n    display(HTML(f'<h2>{feature} Split Histogram<\/h2>'))\n\n    lgb.plot_split_value_histogram(model, feature=feature)\n    plt.show()","29c0bfca":"# Conclusion\n\nHopefully, this kernel brings some value :). ","3e473497":"Let's plot split value histogram for several important features by using the new  API [plot_split_value_histogram](https:\/\/lightgbm.readthedocs.io\/en\/latest\/pythonapi\/lightgbm.plot_split_value_histogram.html). Note: the API does not handle categorical variables as of 29 September 2019. ","79bdb640":"# IEEE-CIS Fraud Detection: Split Value Histogram\n\nI really enjoyed the [IEEE-CIS Fraud Detection \u2014 LightGBM Split Points](https:\/\/www.kaggle.com\/jtrotman\/ieee-fraud-lgb-split-points) kernel from [jtrotman](https:\/\/www.kaggle.com\/jtrotman). It shows us how to visualize the decision tree splitting values count for a given feature. By counting the split values, we can gain new insights and helps us to explain the decision tree. LightGBM introduced a new API [plot_split_value_histogram](https:\/\/lightgbm.readthedocs.io\/en\/latest\/pythonapi\/lightgbm.plot_split_value_histogram.html) in version `2.3.0` that makes it even easier for us. This kernel shows you demonstration of the API for this competition.","57d5ad97":"# Visuals","ee16ef85":"Let's start from installing the latest version of LightGBM:","2889f0d9":"# Training","65745fd4":"# Data Preperation"}}