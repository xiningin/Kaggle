{"cell_type":{"f6ea8fad":"code","d4146d16":"code","b6e3576d":"code","6227e119":"code","c5f8e0e6":"code","a921d872":"code","05b90c21":"code","05c7f128":"code","b4a6894e":"code","5d2be174":"code","f5896951":"code","4240f4c3":"code","ac8dd483":"code","0b6f9601":"code","85e79c28":"code","cb3d25ab":"code","58fc5f11":"code","a6e8d190":"code","549f2c52":"code","5d2628d9":"code","7491b163":"code","10aa4fc3":"code","f5fac254":"code","4e749f63":"code","7f562a55":"code","171e5984":"code","a41a2670":"code","d3eaef77":"code","2f3c0133":"code","300af633":"code","6d4f09a8":"code","05f4e1a6":"code","8439c0da":"markdown","0bcd86d2":"markdown","c3191d6d":"markdown","75a8cf28":"markdown","8e5211ed":"markdown","6544944b":"markdown","0a9d5548":"markdown"},"source":{"f6ea8fad":"import numpy as np\nimport pandas as pd\nimport os\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.metrics import classification_report, log_loss, accuracy_score","d4146d16":"!pip install fastai2","b6e3576d":"!pip install fastcore==0.1.35","6227e119":"import fastcore\nimport fastai2\nfrom fastai2.tabular.all import *","c5f8e0e6":"data0=pd.read_csv('..\/input\/iris\/Iris.csv')","a921d872":"print(data0.columns.tolist())","05b90c21":"Name0=data0['Species'].unique()\nName=sorted(Name0)\nprint(Name)\n\nNUM=list(range(len(Name)))    \nnormal_mapping=dict(zip(Name,NUM)) \nreverse_mapping=dict(zip(NUM,Name)) ","05c7f128":"n=len(data0)\nN=list(range(n))\nrandom.seed(2021)\nrandom.shuffle(N)","b4a6894e":"df_train=data0.iloc[N[0:(n\/\/10)*8]]\ndf_test=data0.iloc[N[(n\/\/10)*8:]]","5d2be174":"df_train.isnull().sum().sort_index()\/len(df_train)","f5896951":"df_train.dtypes\ng_train = df_train.columns.to_series().groupby(df_train.dtypes).groups\ng_train","4240f4c3":"cat_names= [\n]\n\ncont_names = [ \n    'SepalLengthCm', 'SepalWidthCm', 'PetalLengthCm', 'PetalWidthCm', \n ]","ac8dd483":"splits = RandomSplitter(valid_pct=0.2)(range_of(df_train))\n\ntp = TabularPandas(df_train,procs=[Categorify, FillMissing, Normalize],\n                   cat_names=cat_names,\n                   cont_names=cont_names,\n                   y_names='Species',\n                   splits=splits)","0b6f9601":"g_train = tp.train.xs.columns.to_series().groupby(tp.train.xs.dtypes).groups\ng_train","85e79c28":"tp.train","cb3d25ab":"tp.train.xs","58fc5f11":"tp.train.ys.values.ravel()","a6e8d190":"X_train, y_train = tp.train.xs, tp.train.ys.values.ravel()\nX_valid, y_valid = tp.valid.xs, tp.valid.ys.values.ravel()","549f2c52":"X_train.head()","5d2628d9":"rnf = RandomForestClassifier(n_estimators=100, n_jobs=-1)\nrnf.fit(X_train,y_train)","7491b163":"y_pred=rnf.predict(X_valid)\naccuracy_score(y_pred, y_valid)","10aa4fc3":"df_test.head()","f5fac254":"df_test.dtypes\ng_train=df_test.columns.to_series().groupby(df_test.dtypes).groups\ng_train","4e749f63":"test = TabularPandas(df_test, procs=[Categorify, FillMissing,Normalize],\n                   cat_names = cat_names,\n                   cont_names = cont_names,\n                   )","7f562a55":"X_test= test.train.xs","171e5984":"X_test.head()","a41a2670":"X_test.dtypes\ng_train =X_test.columns.to_series().groupby(X_test.dtypes).groups\ng_train","d3eaef77":"y_pred=rnf.predict(X_test)","2f3c0133":"PRED= y_pred.astype(int)\nprint(PRED)","300af633":"ANS=df_test['Species'].map(normal_mapping)\nprint(np.array(ANS))","6d4f09a8":"print(accuracy_score(ANS,PRED))","05f4e1a6":"print(classification_report(ANS,PRED))","8439c0da":"# Iris Classify with Fastai TabularPandas\nhttps:\/\/docs.fast.ai\/tabular.core.html#TabularPandas<br\/>\nThis notebook refferred to the following notebook.<br\/>\nhttps:\/\/www.kaggle.com\/hitesh1724\/titanic-1-fastai-beginner-tutorial","0bcd86d2":"# Predict","c3191d6d":"# Splitting","75a8cf28":"# Data Processing","8e5211ed":"# Model","6544944b":"# Data Preparation","0a9d5548":"### use tabularpandas, predict by fastai\nhttps:\/\/www.kaggle.com\/stpeteishii\/iris-fastai-with-tabularpandas\n\n### use tabularpandas, predict not by fastai (this notebook)\nhttps:\/\/www.kaggle.com\/stpeteishii\/iris-classify-with-fastai-tabularpandas\n\n### not use tabularpandas, predict by fastai\nhttps:\/\/www.kaggle.com\/stpeteishii\/iris-fastai"}}