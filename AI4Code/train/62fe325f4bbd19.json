{"cell_type":{"eecc8306":"code","73481d3e":"code","3e35119f":"code","15ccf333":"code","37fbba2d":"code","3ca30a83":"code","8f99271b":"code","3816bdad":"code","9d7d033b":"code","81d62bcd":"code","53a0f5c1":"code","b564cce1":"code","3aba9338":"code","714c9b30":"code","0f15e231":"code","db204a3f":"code","d6877394":"code","33b8ac85":"code","e6570899":"code","4d884741":"code","95722d8f":"code","9bd75a21":"code","ac66549c":"code","0261c8ff":"markdown","b8dd0051":"markdown","4a32ff35":"markdown","822b3953":"markdown","055a4de2":"markdown","f77ccdcb":"markdown"},"source":{"eecc8306":"from tensorflow.keras.layers import Input , Lambda , Dense , Flatten\nfrom tensorflow.keras.models import Model\nfrom tensorflow.keras.applications.resnet50 import ResNet50\nfrom tensorflow.keras.applications.resnet50 import  preprocess_input\nfrom tensorflow.keras.preprocessing import image\nfrom tensorflow.keras.preprocessing.image import ImageDataGenerator , load_img\nfrom tensorflow.keras.models import Sequential\nimport numpy as np\nfrom glob import glob\nimport tensorflow as tf","73481d3e":"IMAGE_SIZE=[224,224]\ntrain_path='..\/input\/cotton-disease-dataset\/Cotton Disease\/train'\ntest_path='..\/input\/cotton-disease-dataset\/Cotton Disease\/test'","3e35119f":"folders=glob(f'{train_path}\/*')","15ccf333":"folders","37fbba2d":"train_datagen=ImageDataGenerator(rescale=1.\/255,\n                                 shear_range=0.2,\n                                 zoom_range=0.2,\n                                 horizontal_flip=True)","3ca30a83":"test_datagen=ImageDataGenerator(rescale=1.\/255)","8f99271b":"training_set=train_datagen.flow_from_directory(train_path,\n                                               target_size=(224,224),\n                                               batch_size=32,\n                                               class_mode='categorical')","3816bdad":"test_set=test_datagen.flow_from_directory(test_path,\n                                               target_size=(224,224),\n                                               batch_size=32,\n                                               class_mode='categorical')","9d7d033b":"import matplotlib.pyplot as plt","81d62bcd":"plt.imshow(test_set[0][0][0])","53a0f5c1":"cnn = tf.keras.models.Sequential()\n# Convolution \ncnn.add(tf.keras.layers.Conv2D(filters=64,padding = \"same\",kernel_size=3,activation='relu',input_shape=[224,224,3]))\ncnn.add(tf.keras.layers.Conv2D(filters=32,padding = \"same\",kernel_size=3,activation='relu'))\n# pooling\ncnn.add(tf.keras.layers.MaxPool2D(pool_size=2,strides=2))\n# Convolution\ncnn.add(tf.keras.layers.Conv2D(filters=16,padding = \"same\",kernel_size=3,activation='relu'))\ncnn.add(tf.keras.layers.Conv2D(filters=16,padding = \"same\",kernel_size=3,activation='relu'))\n#pooling\ncnn.add(tf.keras.layers.MaxPool2D(pool_size=2,strides=2))\n\n#flaterning\ncnn.add(tf.keras.layers.Flatten())\ncnn.add(tf.keras.layers.Dense(units=128,activation='relu'))\ncnn.add(tf.keras.layers.Dense(units=128,activation='relu'))\n# Output layer\ncnn.add(tf.keras.layers.Dense(units=4,activation='softmax'))","b564cce1":"cnn.summary()","3aba9338":"cnn.compile(optimizer='adam',loss='categorical_crossentropy',metrics=['accuracy'])","714c9b30":"history = cnn.fit(x = training_set, validation_data = test_set, epochs = 20)","0f15e231":"def predict_it(image_location):\n  test_image=image.load_img(image_location, target_size = IMAGE_SIZE)\n  plt.imshow(test_image)\n  test_image=image.img_to_array(test_image)\n  test_image=test_image\/255\n  test_image = np.expand_dims(test_image, axis = 0)\n  preds=np.argmax(cnn.predict(test_image))\n  if preds==0:\n    print(\"The leaf is diseased cotton leaf\")\n  elif preds==1:\n    print(\"The leaf is diseased cotton plant\")\n  elif preds==2:\n    print(\"The leaf is fresh cotton leaf\")\n  else:\n    print(\"The leaf is fresh cotton plant\")","db204a3f":"predict_it('..\/input\/cotton-disease-dataset\/Cotton Disease\/val\/diseased cotton leaf\/dis_leaf (100)_iaip.jpg')","d6877394":"predict_it('..\/input\/cotton-disease-dataset\/Cotton Disease\/val\/diseased cotton plant\/dd (10)_iaip.jpg')","33b8ac85":"predict_it('..\/input\/cotton-disease-dataset\/Cotton Disease\/val\/fresh cotton leaf\/d (106)_iaip.jpg')","e6570899":"validation_set=test_datagen.flow_from_directory('..\/input\/cotton-disease-dataset\/Cotton Disease\/val',\n                                               target_size=(224,224),\n                                               batch_size=32,\n                                               class_mode='categorical')","4d884741":"predicted=cnn.predict(validation_set[0][0])","95722d8f":"actual=[]\nfor i in validation_set[0][1]:\n  actual.append(np.argmax(i))\npredict=[]\nfor i in predicted:\n  predict.append(np.argmax(i))","9bd75a21":"from sklearn.metrics import accuracy_score\naccuracy_score(actual,predict)","ac66549c":"from sklearn.metrics import confusion_matrix\nimport seaborn as sns\nconfusion_mtx = confusion_matrix(actual,predict) \nplt.figure(figsize=(10,8))\nsns.heatmap(confusion_mtx,annot=True,annot_kws={\"size\": 10} , cmap=\"YlGnBu\")\nplt.xlabel('Predicted')\nplt.ylabel('Actual')\nplt.plot()","0261c8ff":"# Building Model","b8dd0051":"# Testing","4a32ff35":"# Loading data","822b3953":"# Libraries","055a4de2":"# Summary","f77ccdcb":"# Model Training"}}