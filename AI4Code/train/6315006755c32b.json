{"cell_type":{"42752637":"code","2aaa37cc":"code","6df5616f":"code","656e4076":"code","2c55b469":"code","1e067ca4":"code","f5c15c66":"code","77dff3ff":"code","10bcd9cd":"code","50372c9b":"code","99ed7dcb":"code","9f409804":"code","c49f18b5":"code","5097fbc6":"code","2409f9ef":"code","d81e9351":"code","5ad41bae":"code","7c76a660":"code","3528f6f4":"code","ff68e838":"code","bb31aed5":"code","419e7c42":"code","e18fc620":"code","6cb9aced":"code","d936d08c":"code","e04be570":"code","e28137e0":"code","80923130":"code","462fd622":"code","fd9feb18":"code","97ade0c3":"code","8b2711e0":"code","248519eb":"code","000bd6ba":"code","45ebdb50":"code","4d535c59":"code","9adda9a8":"markdown"},"source":{"42752637":"# All libraries has imported\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\nimport tensorflow as tf\nfrom tensorflow import keras\n%matplotlib inline\nimport matplotlib.pyplot as plt\nimport seaborn as sns","2aaa37cc":"# Train data\ntrain = pd.read_csv('..\/input\/digit-recognizer\/train.csv')\ntrain.head()","6df5616f":"# Test data\ntest = pd.read_csv('..\/input\/digit-recognizer\/test.csv')\ntest.head()","656e4076":"# Train shape\ntrain.shape","2c55b469":"# Test shape\ntest.shape","1e067ca4":"x = train.drop(['label'],axis=1)\nX = np.array(x).reshape(len(train),28*28) \/ 255\nX.shape","f5c15c66":"y = train['label']\ny.shape","77dff3ff":"x_test = np.array(test).reshape(len(test),28*28) \/ 255\nx_test.shape","10bcd9cd":"from sklearn.model_selection import train_test_split\nX_train, X_val, y_train, y_val = train_test_split(X,y,test_size=0.15,random_state=42)","50372c9b":"X_train.shape, y_train.shape","99ed7dcb":"X_val.shape, y_val.shape","9f409804":"plt.imshow(X[2].reshape(28,28))","c49f18b5":"y[2]","5097fbc6":"# Simple neural network with no hidden layers\nann =keras.Sequential([\n     keras.layers.Dense(10, input_shape=(784,),activation='sigmoid')\n])\nann.compile(\n             optimizer='adam',\n             loss='sparse_categorical_crossentropy',\n             metrics=['accuracy'])\nann.fit(X_train,y_train,epochs=20)","2409f9ef":"ann.evaluate(X_val,y_val)","d81e9351":"y_predict = ann.predict(X_val)\ny_predict","5ad41bae":"y_predicted_labels = [np.argmax(i) for i in y_predict]\ny_predicted_labels[0]","7c76a660":"cn = tf.math.confusion_matrix(y_val,y_predicted_labels)\nplt.figure(figsize=(8,6))\nsns.heatmap(cn,annot=True,fmt='d')\nplt.xlabel('Predicted')\nplt.ylabel('Truth')","3528f6f4":"# Using hidden layer\nann_hidden =keras.Sequential([\n    keras.layers.Dense(100, input_shape=(784,), activation='relu'),\n    keras.layers.Dense(10,activation='sigmoid')\n])\nann_hidden.compile(\n             optimizer='adam',\n             loss='sparse_categorical_crossentropy',\n             metrics=['accuracy'])\nann_hidden.fit(X_train,y_train,epochs=20)","ff68e838":"ann_hidden.evaluate(X_val,y_val)","bb31aed5":"y_predict = ann_hidden.predict(X_val)\ny_predict","419e7c42":"y_predicted_labels = [np.argmax(i) for i in y_predict]\ny_predicted_labels[2]","e18fc620":"cn = tf.math.confusion_matrix(y_val,y_predicted_labels)\nplt.figure(figsize=(8,6))\nsns.heatmap(cn, annot=True, fmt='d')\nplt.xlabel('Predicted')\nplt.ylabel('Truth')","6cb9aced":"#Flatten Layer\nann_flat = keras.Sequential([\n           keras.layers.Flatten(input_shape=(28,28)),\n           keras.layers.Dense(100, activation='relu'),\n           keras.layers.Dense(10, activation='sigmoid')\n])\nann_flat.compile(\n             optimizer='adam',\n             loss='sparse_categorical_crossentropy',\n             metrics=['accuracy'])\nann_flat.fit(X_train,y_train,epochs=20)","d936d08c":"ann_flat.evaluate(X_val,y_val)","e04be570":"y_predict = ann_hidden.predict(x_test)\ny_predict","e28137e0":"y_predicted_labels = [np.argmax(i) for i in y_predict]\ny_predicted_labels[2]","80923130":"#Using CNN\ncnn = keras.Sequential([\n    keras.layers.Conv2D(30, (3,3), activation='relu', input_shape=(28, 28, 1)),\n    keras.layers.MaxPooling2D((2,2)),\n \n    keras.layers.Flatten(),\n    keras.layers.Dense(100, activation='relu'),\n    keras.layers.Dense(10, activation='sigmoid')\n])","462fd622":"cnn.compile(\n             optimizer='adam',\n             loss='sparse_categorical_crossentropy',\n             metrics=['accuracy'])","fd9feb18":"X_train = X_train.reshape(-1,28,28,1)\nX_train.shape","97ade0c3":"x_test = x_test.reshape(-1,28,28,1)\nx_test.shape","8b2711e0":"cnn.fit(X_train, y_train, epochs=20)","248519eb":"y_predict_final = cnn.predict(x_test)","000bd6ba":"y_predicted_labels_final =[np.argmax(i) for i in y_predict_final]","45ebdb50":"image_id = range(1, y_predict_final.shape[0] + 1)\nsubmission_file = pd.DataFrame({'ImageId':image_id, 'Label':y_predicted_labels_final})\nsubmission_file.to_csv('digit_recognizer_submission_final_cnn_ann.csv',index=False)","4d535c59":"submission_file.head()","9adda9a8":"# Mim Rahman\n# ID: 181-35-2292"}}