{"cell_type":{"4cb69ea2":"code","9deaa1bd":"code","18185abe":"code","31ef6491":"code","2e7661b2":"code","023e901c":"code","0f869583":"code","2b011147":"code","ce9c3990":"code","7addd13b":"code","0a14b644":"code","0a0a99d5":"code","05e3de78":"code","d286ec14":"code","ecece30e":"code","8b3f49c6":"code","7900428c":"code","038a863e":"code","540ee75d":"code","1c143f07":"code","d279b949":"markdown","867332dc":"markdown","86001fec":"markdown"},"source":{"4cb69ea2":"import pandas as pd \nfrom sklearn.feature_extraction.text import TfidfVectorizer\nfrom sklearn.naive_bayes import MultinomialNB\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.model_selection import train_test_split","9deaa1bd":"raw_test_y = pd.read_csv('..\/input\/fake-news\/submit.csv')\nraw_test_X = pd.read_csv('..\/input\/fake-news\/test.csv')\ntrain_df = pd.read_csv('..\/input\/fake-news\/train.csv')","18185abe":"raw_test_y.head()","31ef6491":"raw_test_y.shape","2e7661b2":"raw_test_y.dtypes","023e901c":"raw_test_X.head()","0f869583":"raw_test_X.shape","2b011147":"raw_test_X.dtypes","ce9c3990":"train_df.head()","7addd13b":"train_df.shape","0a14b644":"train_df.dtypes","0a0a99d5":"# merge the data\nmerged_test = raw_test_X.merge(raw_test_y, on='id')\nprint(merged_test.shape)\nmerged_df = train_df.append(merged_test)\nprint(merged_df.shape)","05e3de78":"# get more info about the merged_df\nmerged_df.info()","d286ec14":"# take a look at the text column as we will use it for our feature column\nmerged_df['text'].head()","ecece30e":"# check if there's any null values in the text column \nmerged_df.isnull().sum()","8b3f49c6":"# drop rows that contain null values in the text column\nmerged_df.dropna(subset=['text'], inplace=True)\nmerged_df.isnull().sum()","7900428c":"# rearrange the index \nmerged_df = merged_df.reset_index()","038a863e":"# Split the dataset \nX_train, X_test, y_train, y_test = train_test_split(merged_df['text'], merged_df['label'], test_size = 0.2)","540ee75d":"# create TfidfVectorizer object\nvectorizer = TfidfVectorizer(stop_words='english')\n\n# generate matrix of word vectors\ntfidf_train = vectorizer.fit_transform(X_train)\ntfidf_test = vectorizer.transform(X_test)","1c143f07":"# create Naive Bayes classifier object\nclf = MultinomialNB()\nclf.fit(tfidf_train, y_train)\n\n# predict on the test set\npred = clf.predict(tfidf_test)\n# calcuate the accuracy\nscore = accuracy_score(y_test, pred)\nprint('Accuracy score: {:.2f}%'.format(score *100))","d279b949":"## Data Preprocessing","867332dc":"We are going to read the datasets to get a brief understanding of the data we are working with","86001fec":"# Import important libraries"}}