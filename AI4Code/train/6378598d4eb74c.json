{"cell_type":{"f191268b":"code","6895b81c":"code","bd93576b":"code","9c812f31":"code","9823d2e9":"code","e7dc69f8":"code","4037064b":"code","bf6b01de":"code","9ceb836d":"code","428ed7af":"markdown"},"source":{"f191268b":"import numpy as np\nimport pandas as pd\nimport h2o\nfrom h2o.estimators import H2ORandomForestEstimator","6895b81c":"train = pd.read_csv('..\/input\/ncaam-2021-features-only\/tourney.csv')\ntest = pd.read_csv('..\/input\/ncaam-2021-features-only\/test.csv')","bd93576b":"y = train[\"result\"]\ns = train[\"Season\"]\nX = train.drop(['Season','TeamID1','TeamID2','result'], axis=1)\n\n\nX_test = test.drop(['ID', 'Season','TeamID1','TeamID2'], axis=1)","9c812f31":"\n\nh2o.init()","9823d2e9":"h2o_train_data = h2o.H2OFrame(train)\nh2o_test_data = h2o.H2OFrame(test)","e7dc69f8":"num_folds = 10\ntraining_columns = list(train.drop(['Season','TeamID1','TeamID2','result'], axis=1).columns)\n\n# Define model\nmodel = H2ORandomForestEstimator(ntrees=1000,\n                                 max_depth=50,\n                                 nfolds=num_folds,\n                                 seed=1234)\n\n\n# Train model\nmodel.train(x=training_columns,\n            y='result',\n            training_frame=h2o_train_data)","4037064b":"# predictions on test sample\ntest_preds = model.predict(test_data=h2o_test_data).as_data_frame()['predict'].values\n\n","bf6b01de":"test = pd.read_csv('..\/input\/ncaam-2021-features-only\/test.csv')\nMSampleSubmission = pd.read_csv('..\/input\/ncaam-march-mania-2021\/MSampleSubmissionStage1.csv')","9ceb836d":"idx = test_preds.shape[0] \/\/2\ntest_preds[idx:] = 1 - test_preds[idx:]\n\npred = pd.concat([test.ID, pd.Series(test_preds)], axis=1).groupby('ID')[0]\\\n        .mean().reset_index().rename(columns={0:'Pred'})\nsub = MSampleSubmission.drop(['Pred'],axis=1).merge(pred, on='ID')\nsub.to_csv('submission.csv', index=False)\nsub.head()\n","428ed7af":"#### This notebook provide an example of training a Random Forest model in H2O."}}