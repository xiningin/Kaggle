{"cell_type":{"642f9b83":"code","ebe6da3c":"code","bd0849a7":"code","0e74890b":"code","96f674c2":"code","013a8547":"code","8edf280c":"code","165a75c3":"code","59a2fd3e":"code","184753a0":"code","0d9844bd":"code","6d82b505":"code","c75be663":"code","ec50fd6f":"code","819c390b":"code","c92a6900":"code","08a44c19":"code","54a0a0c5":"code","09654956":"code","618a990a":"markdown","58416856":"markdown","d8febd77":"markdown","32159fc4":"markdown","428b64b7":"markdown","a0134552":"markdown","739627d0":"markdown","d015e57a":"markdown","d220b522":"markdown","01219f8d":"markdown"},"source":{"642f9b83":"import pandas as pd\n\nfrom sklearn.feature_extraction.text import CountVectorizer\nfrom sklearn.metrics.pairwise import linear_kernel, cosine_similarity\n\nfrom surprise import Reader, Dataset, SVD","ebe6da3c":"movies = pd.read_csv('..\/input\/movielens-dataset\/movies.csv')","bd0849a7":"movies.head()","0e74890b":"movies['genres'] = movies['genres'].apply(lambda x: x.replace('|', ' '))","96f674c2":"movies.head()","013a8547":"count = CountVectorizer(analyzer='word', ngram_range=(1, 2), min_df=0, stop_words='english')\ncount_matrix = count.fit_transform(movies['genres'])","8edf280c":"count_matrix.shape","165a75c3":"cosine_sim = cosine_similarity(count_matrix, count_matrix)","59a2fd3e":"cosine_sim.shape","184753a0":"movies = movies.reset_index()\ntitles = movies['title']\nindices = pd.Series(movies.index, index=movies['title'])","0d9844bd":"def get_recommendations(title):\n    idx = indices[title]\n    sim_scores = list(enumerate(cosine_sim[idx]))\n    sim_scores = sorted(sim_scores, key=lambda x: x[1], reverse=True)\n    sim_scores = sim_scores[1:31]\n    movie_indices = [i[0] for i in sim_scores]\n    return titles.iloc[movie_indices]","6d82b505":"get_recommendations('Toy Story (1995)').head(5)","c75be663":"ratings = pd.read_csv('..\/input\/movielens-dataset\/ratings.csv')","ec50fd6f":"ratings.head()","819c390b":"reader = Reader()","c92a6900":"data = Dataset.load_from_df(ratings[['userId', 'movieId', 'rating']], reader)","08a44c19":"svd = SVD()","54a0a0c5":"trainset = data.build_full_trainset()\nsvd.fit(trainset)","09654956":"svd.predict(1, 101).est","618a990a":"We will use matrix decompositions. They help a lot in creating recommendation systems.","58416856":"Write a simple function to get top similar movies.","d8febd77":"I will use one of my favorite libraries to create recommendation systems - surprise.","32159fc4":"We predict that user number 1 will rate movie number 101 as 3.54","428b64b7":"#### Now write a recommendation system for collaborative filtering.\nThe peculiarity of such a system is that we are now looking for not similar films, but similar users. We assume that if we can find users who like the same films, we can recommend films that one of them has not seen, but rated well.","a0134552":"We can notice that even such a simple system gives good results.","739627d0":"We will use the CountVectorizer to convert a collection of text documents into a token matrix.","d015e57a":"### Hi everyone! In this kernel I will show a simple recommendation system based on this data.\n\nFirst of all, I must say that there are many types of recommendation systems, but usually there are 2 types:\n- Content Based\n- Collaborative filtering\n\nMore information here - www.towardsdatascience.com\/what-are-product-recommendation-engines-and-the-various-versions-of-them-9dcab4ee26d5","d220b522":"#### Let's start with content based recommender system.\nThe essence of such a system is that we look for similar films by similar characteristics. Only genres are known about films. Let's try to write a system based only on this.","01219f8d":"There are many ways to determine the similarity, but I will use the cosine similarity."}}