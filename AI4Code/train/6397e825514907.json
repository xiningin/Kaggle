{"cell_type":{"c5978ea2":"code","e72ca939":"code","46d7d0eb":"code","d35663ff":"code","c231bec8":"code","2da15a62":"code","dadaba21":"code","11b32d5f":"code","43e57f69":"code","91a5e775":"code","94d8100a":"code","1985676b":"code","7953b36a":"code","65707951":"code","b02ddbf6":"code","d80d995b":"code","fe39b406":"code","ed39f5b5":"code","9b6a0690":"code","28196b9b":"code","72a59228":"code","ba7212a2":"markdown","58b3d94a":"markdown","c8130884":"markdown","3aa2c72f":"markdown","51be0b0c":"markdown","aecb8345":"markdown","27fcfd64":"markdown","22ffe91b":"markdown"},"source":{"c5978ea2":"import os\nimport pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom matplotlib.image import imread\n%matplotlib inline","e72ca939":"my_data_dir = r'\/kaggle\/input\/03-keypoint-movenet-v2\/'","46d7d0eb":"os.listdir(my_data_dir)","d35663ff":"#Loading data from previous notebook\ntrain_df = pd.read_csv(my_data_dir + 'train_df.csv', index_col = 0)\ntest_df = pd.read_csv(my_data_dir + 'test_df.csv', index_col = 0)\nval_df = pd.read_csv(my_data_dir + 'val_df.csv', index_col = 0)\ntrain_df.shape, test_df.shape, val_df.shape","c231bec8":"train_df.head()","2da15a62":"train_df = train_df.drop(['image_name','keypoint'], axis = 1)\ntest_df = test_df.drop(['image_name','keypoint'], axis = 1)\nval_df = val_df.drop(['image_name','keypoint'], axis = 1)","dadaba21":"X_train, y_train = train_df.drop('category', axis = 1), train_df['category']\nX_test, y_test = test_df.drop('category', axis = 1), test_df['category']\nX_val, y_val = val_df.drop('category', axis = 1), val_df['category']","11b32d5f":"from sklearn.metrics import accuracy_score\ndef model_fit_predict_acc(model, X_train, y_train, X_test, y_test, X_val, y_val):\n    model.fit(X_train,y_train)\n    y_pred_test = model.predict(X_test)\n    y_pred_train = model.predict(X_train)\n    y_pred_val = model.predict(X_val)\n    acc_test = accuracy_score(y_pred_test, y_test)\n    acc_train = accuracy_score(y_pred_train, y_train)\n    acc_val = accuracy_score(y_pred_val, y_val)\n    return (acc_train, acc_test, acc_val)","43e57f69":"from catboost import CatBoostClassifier\nmodel_train, model_test, model_val = model_fit_predict_acc(CatBoostClassifier(verbose = False),X_train, y_train, X_test, y_test, X_val, y_val)\nprint(\"Accuracy of CatBoost Classifier Models Train: {:.4f}, Test: {:.4f}, Val: {:.4f}\".format(model_train, model_test, model_val))","91a5e775":"model_train, model_test, model_val = model_fit_predict_acc(CatBoostClassifier(iterations=200, depth = 4, l2_leaf_reg=10, verbose = False),X_train, y_train, X_test, y_test, X_val, y_val)\nprint(\"Accuracy of CatBoost Classifier Models Train: {:.4f}, Test: {:.4f}, Val: {:.4f}\".format(model_train, model_test, model_val))","94d8100a":"from xgboost import XGBClassifier\nmodel_train, model_test, model_val = model_fit_predict_acc(XGBClassifier(max_depth = 3),X_train, y_train, X_test, y_test, X_val, y_val)\nprint(\"Accuracy of XGBClassifier Model >> Train: {:.4f}, Test: {:.4f}, Val: {:.4f}\".format(model_train, model_test, model_val))","1985676b":"from lightgbm import LGBMClassifier\nmodel_train, model_test, model_val = model_fit_predict_acc(LGBMClassifier(max_depth = 3),X_train, y_train, X_test, y_test, X_val, y_val)\nprint(\"Accuracy of LGBM Classifier Model >> Train: {:.4f}, Test: {:.4f}, Val: {:.4f}\".format(model_train, model_test, model_val))","7953b36a":"from sklearn.neighbors import KNeighborsClassifier\nfor i in range(2,30):\n    model_train, model_test, model_val = model_fit_predict_acc(KNeighborsClassifier(n_neighbors = i),X_train, y_train, X_test, y_test, X_val, y_val)\n    print(\"Accuracy of kNNClassifier Model with i = {} >> Train: {:.4f}, Test: {:.4f}, Val: {:.4f}\".format(i, model_train, model_test, model_val))","65707951":"from sklearn.neural_network import MLPClassifier\nmodel_train, model_test, model_val = model_fit_predict_acc(MLPClassifier(),X_train, y_train, X_test, y_test, X_val, y_val)\nprint(\"Accuracy of MLPClassifier Model >> Train: {:.4f}, Test: {:.4f}, Val: {:.4f}\".format(model_train, model_test, model_val))","b02ddbf6":"from sklearn.tree import DecisionTreeClassifier\nmodel_train, model_test, model_val = model_fit_predict_acc(DecisionTreeClassifier(),X_train, y_train, X_test, y_test, X_val, y_val)\nprint(\"Accuracy of DecisionTreeClassifier Model >> Train: {:.4f}, Test: {:.4f}, Val: {:.4f}\".format(model_train, model_test, model_val))","d80d995b":"from sklearn.ensemble import RandomForestClassifier\nmodel_train, model_test, model_val = model_fit_predict_acc(RandomForestClassifier(),X_train, y_train, X_test, y_test, X_val, y_val)\nprint(\"Accuracy of RandomForestClassifier Model >> Train: {:.4f}, Test: {:.4f}, Val: {:.4f}\".format(model_train, model_test, model_val))","fe39b406":"from sklearn.ensemble import AdaBoostClassifier\nmodel_train, model_test, model_val = model_fit_predict_acc(AdaBoostClassifier(CatBoostClassifier(verbose = False)),X_train, y_train, X_test, y_test, X_val, y_val)\nprint(\"Accuracy of Ada + Cat Model >> Train: {:.4f}, Test: {:.4f}, Val: {:.4f}\".format(model_train, model_test, model_val))","ed39f5b5":"from sklearn.metrics import classification_report,confusion_matrix","9b6a0690":"model = AdaBoostClassifier(CatBoostClassifier(verbose = False))\nmodel.fit(X_train, y_train)\npredictions = model.predict(X_train)\nprint(classification_report(y_train,predictions))","28196b9b":"predictions_test = model.predict(X_test)\nprint(classification_report(y_test,predictions_test))","72a59228":"predictions_val = model.predict(X_val)\nprint(classification_report(y_val,predictions_val))","ba7212a2":"It can be seen that the model can be easily overfitted.  Let's try varying hyperparameters to get a better fit.","58b3d94a":"# 2. Setting up train\/test\/split dataframes","c8130884":"This is the 4th notebook of total 5 notebooks in this series listed as following:\n1. EDA and image augmentation note books >> https:\/\/www.kaggle.com\/suradechk\/01-eda-and-image-augmentation-v2\n2. Setting up a baseline model using CNN >> https:\/\/www.kaggle.com\/suradechk\/02-baseline-model-using-cnn-v2\n3. Keypoint generation using movenet >> https:\/\/www.kaggle.com\/suradechk\/03-keypoint-movenet-v2\n4. Classification keypoint output using classical ML >> https:\/\/www.kaggle.com\/suradechk\/04-classification-using-keypoints-output-v2\n5. Classification keypoint output using ANN >> https:\/\/www.kaggle.com\/suradechk\/05-classification-using-ann-v2","3aa2c72f":"# DAAN570 - Final Project - RSI Prevention by Yoga - Modelling notebook\n<br>Team: 11: Suradech Kongkiatpaiboon and Burq Latif\nCourse: DAAN 570 \u2013 Deep Learning (Fall, 2021) - Penn State World Campus\n\n> Problem statement : Repetitive stress injury is extremely prevalent for anyone who works at the same spot for a long length of time, especially with the development of COVID-19 and the increase in work from home trend. We've identified certain flaws in traditional RSI prevention software on the market, and we've noted that yoga's popularity is growing by the day. The reason for this is the numerous physical, mental, and spiritual advantages that yoga may provide. Many people are following this trend and practice yoga without the help of a professional. However, doing yoga incorrectly or without adequate instruction can lead to serious health problems such as strokes and nerve damage. As a result, adhering to appropriate yoga poses is a vital consideration.\nIn this work, we present a method for identifying the user's postures and providing visual guidance to the user. In order to be more engaging with the user, this procedure is done in real-time and utilizes the traditional webcam on the laptop\/desktop to run the application.\n\nKeywords : Yoga, posture, classification, movenet, keypoint\n\nData Collection:\nWe took some images from open source yoga posture dataset from three following sites and applied basic data cleaning manually (e.g. remove corrupted images, remove misclassified yoga posture images).\n1. Open source dataset from https:\/\/www.kaggle.com\/general\/192938\n2. 3D synthetic dataset from https:\/\/laurencemoroney.com\/2021\/08\/23\/yogapose-dataset.html\n3. Yoga-82 dataset from https:\/\/sites.google.com\/view\/yoga-82\/home","51be0b0c":"# 3. Try various classical machine learning algorithm to classify the Yoga poses.","aecb8345":"It appears that after getting all the keypoints, any model gives acceptable accuracy. We'll just pick one best model in this step for our custom software creation.  In this case we just pick Adaboost(catboost()) model for next step.","27fcfd64":"# 1. Importing keypoint data from previous notebook","22ffe91b":"# 4. Exploring the confusion matrix"}}