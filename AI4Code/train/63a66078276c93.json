{"cell_type":{"d343663b":"code","3cddc685":"code","deb50438":"code","a8e3ead9":"code","4805a8a7":"code","cf9b23ed":"code","0c86fce0":"code","dd7bcd28":"code","1ba6828f":"code","65764089":"code","89287fa2":"code","3e105d9e":"code","d481d14d":"code","246b5e23":"code","4e12fc8a":"code","ebd47392":"code","815bf8c8":"code","f816b064":"code","32ee19ed":"code","6e8b74dd":"code","213b18bb":"code","2af2e529":"code","b58a676e":"code","5befc2e3":"code","be16a3a2":"code","185884c5":"code","78d1a49f":"code","1c5a781c":"code","441fe484":"code","754003be":"code","fb0d6bb6":"code","5cfe1146":"code","e28c858e":"code","b0cc4cbf":"code","d49e2478":"code","4384bab1":"code","9fb6924c":"code","23a8581b":"code","9778a892":"code","8fdf9525":"code","39911330":"code","8c81fb1c":"code","324ef553":"code","5bb22368":"code","f47887c1":"code","d7e2ded1":"markdown","121afb44":"markdown","596a8f90":"markdown","e1ca114b":"markdown","f1e3c6c4":"markdown","7a662acf":"markdown","59f933dc":"markdown","6ced1460":"markdown","ff98a3e7":"markdown","b257d26f":"markdown","771ca32b":"markdown","d1347728":"markdown"},"source":{"d343663b":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\nimport os\nprint(os.listdir(\"..\/input\"))","3cddc685":"train = pd.read_csv(\"..\/input\/train.csv\")","deb50438":"train.info()","a8e3ead9":"train.head()","4805a8a7":"plt.figure(figsize = (10,8))\nsns.heatmap(train.corr(), cmap= sns.color_palette(palette=\"RdBu\"),linewidths=.5,annot=True)\nplt.title(\"Correlation Matrix of Train DF\")\nplt.yticks(rotation = \"0\")","cf9b23ed":"train.corr()[\"Survived\"] # Fare, Pclass","0c86fce0":"sns.countplot(data = train, x = \"Sex\", hue = \"Survived\")\nplt.title(\"Count of Sexes by Survival\")","dd7bcd28":"sns.boxplot(data = train, y = \"Fare\", x = \"Survived\")\nplt.title(\"Boxplot of Fare by Survival\")","1ba6828f":"sns.boxplot(data = train, y = \"Fare\", x = \"Sex\", hue = \"Survived\")\nplt.title(\"Boxplot of Fare by Sex, and Survival\")","65764089":"sns.boxplot(data = train, x = \"Sex\", y = \"Age\", hue = \"Survived\")\nplt.title(\"Age vs Sex grouped by Survived\")","89287fa2":"sns.boxplot(data = train, x = \"Survived\", y = \"Age\", hue = \"Pclass\",)\nplt.title(\"Age vs Sex grouped by Survived\")","3e105d9e":"train[\"bool_cabin\"] = train[\"Cabin\"].isna() == False\ntrain[\"bool_cabin\"].head()","d481d14d":"sns.countplot(data = train, x = \"bool_cabin\", hue = \"Survived\")\nplt.title(\"Count of Known\/Unknown Passenger's Cabins grouped by Survival\")","246b5e23":"x = train[\"bool_cabin\"].values\ny = train[\"Survived\"].values\nprint(np.corrcoef(x,y)[1,0])","4e12fc8a":"sns.countplot(data = train, x = \"SibSp\", hue = \"Survived\")","ebd47392":"sns.countplot(data = train, x = \"Parch\", hue = \"Survived\")","815bf8c8":"train.isna().sum()","f816b064":"train[train[\"Embarked\"].isna()]","32ee19ed":"train[\"Embarked\"].value_counts()","6e8b74dd":"train.groupby([\"Sex\",\"Embarked\"]).count()[\"PassengerId\"].rename({\"PassengerId\":\"Count\"})","213b18bb":"train.groupby([\"Sex\",\"Pclass\",\"Embarked\"]).count()[\"PassengerId\"].rename({\"PassengerId\":\"Count\"})","2af2e529":"def fill_embarked(df,fill = \"S\"):\n    copy = df.copy()\n    copy.loc[copy.isna()[\"Embarked\"],\"Embarked\"] = fill\n    return copy","b58a676e":"example = fill_embarked(train)\nexample.isna()[[\"Embarked\"]].sum()","5befc2e3":"train.isna()[[\"Age\"]].sum()","be16a3a2":"train[[\"Age\"]].mean()","185884c5":"train[[\"Age\"]].median()","78d1a49f":"temp = train.groupby([\"Sex\",\"Pclass\"]).median()[[\"Age\"]]\ntemp = temp.merge(train.groupby([\"Sex\",\"Pclass\"]).mean()[[\"Age\"]], left_index = True, right_index = True, suffixes= (\"Median\",\"Mean\"))\nage = temp.merge(train.groupby([\"Sex\",\"Pclass\"]).count()[[\"Age\"]], left_index= True, right_index = True, suffixes = (\"Count\",\"Count\"))\nage","1c5a781c":"def fill_age(df, method = np.median):\n    global age\n    copy = df.copy()\n    copy.loc[copy[\"Age\"].isna(),\"Age\"] = method(copy.dropna()[\"Age\"])\n    return copy    ","441fe484":"temp = train.copy()\ntemp = fill_age(temp)\ntemp[\"Age\"].isna().sum()","754003be":"train.count().max(), train.isna()[\"Cabin\"].sum()","fb0d6bb6":"train = pd.read_csv(\"..\/input\/train.csv\")","5cfe1146":"train = fill_age(train)\ntrain = fill_embarked(train)\ntrain[\"bool_cabin\"] = train[\"Cabin\"].isna() == False\ntrain.drop(\"Cabin\",axis=1,inplace = True)","e28c858e":"train.isna().sum()","b0cc4cbf":"def one_hot_encoding(df):\n    copy = df.copy()\n    columns = copy.columns.tolist()\n    \n    first_column = copy[columns[0]]\n    temp = pd.get_dummies(first_column, prefix = columns[0], drop_first = True)\n    \n    for i in columns[1:]:\n        curr_column = copy[i]\n        curr_df = pd.get_dummies(curr_column, prefix = i, drop_first = True)\n        temp = temp.merge(curr_df,right_index = True, left_index = True)\n    return temp","d49e2478":"train = pd.read_csv(\"..\/input\/train.csv\")\ntrain = fill_age(train)\ntrain = fill_embarked(train)\ntrain[\"bool_cabin\"] = train[\"Cabin\"].isna() == False\ntrain.drop(\"Cabin\",axis=1,inplace = True)\nnum = [\"SibSp\",\"Parch\",\"Fare\", \"Age\",\"Survived\"]\ncats = [\"Pclass\",\"Sex\",\"Embarked\",\"bool_cabin\"]\ntrain_cats = train[cats]\ntrain_num = train[num]\ntrain_cats = one_hot_encoding(train_cats)\ntrain_x = train_num.merge(train_cats, right_index = True, left_index= True)\ntrain_x.head()","4384bab1":"x = train_x.copy()\nx.drop(\"Survived\", axis=1,inplace = True)\ny = train_x[\"Survived\"]","9fb6924c":"from sklearn.linear_model import LogisticRegressionCV","23a8581b":"model = LogisticRegressionCV(cv = 5, fit_intercept= True)\nmodel.fit(x,y)\nmodel.score(x,y)","9778a892":"num = [\"SibSp\",\"Parch\",\"Fare\", \"Age\"]\ncats = [\"Pclass\",\"Sex\",\"Embarked\",\"bool_cabin\"]","8fdf9525":"test = pd.read_csv(\"..\/input\/test.csv\")\ntest = fill_age(test)\ntest = fill_embarked(test)\ntest[\"bool_cabin\"] = test[\"Cabin\"].isna() == False\ntest.drop(\"Cabin\",axis=1,inplace = True)\nPassengerId = test[\"PassengerId\"]\ntest_cats = test[cats]\ntest_num = test[num]\ntest_cats = one_hot_encoding(test_cats)\ntest_x = test_num.merge(test_cats, right_index = True, left_index= True)\ntest_x.head()","39911330":"test_x.isna().sum()","8c81fb1c":"test_x.loc[test[\"Fare\"].isna(),\"Fare\"] = np.mean(test[\"Fare\"])","324ef553":"predictions = model.predict(test_x)","5bb22368":"submission = pd.DataFrame({\"PassengerId\":PassengerId, \"Survived\":predictions})","f47887c1":"submission.to_csv(\"submission.csv\", index=False)","d7e2ded1":"## Importing Libraries <br\/>  \nMost kernals start out like this because obviously we need some higher level python-based libraries to work with our data. I typically import numpy for any linear algebra work, pandas for data cleaning and transformation, seaborn and matplotlib.pyplot for data visualizations and sklearn for machine learning. ","121afb44":"obligatory read table:","596a8f90":"So we see that a good chunk of the data is missing here. MORE THAN HALF! Since it would probably be a little erroneous to make assumptions about the Data, its probably better to not fill in for these missing values.","e1ca114b":"## EDA Finding Relations Amongst the Data and Survived","f1e3c6c4":"## EDA <br\/>\nI typically start with train.head() and train.info() to try to get an idea of what information the data is trying to convey, the data types and some of the data values. Luckily for us, most of this information can be found in kaggle's [data dictionary](https:\/\/www.kaggle.com\/c\/titanic\/data). I'll leave the link for you to refer to, but below is the jist of the information.\n\n**Survived** : nominal - indicates whether a person survived the titanic or not<br \/>\n**Pclass** : ordinal - indicates the ticket class of the person, ie \"first\", \"second\", or \"third\" class<br \/>\n**Sex** : nominal - indicated the sex of the passenger<br \/>\n**Age** : Numeric - indicates age<br \/>\n**SibSP** : Numeric - indicates the number of siblings or spouses related to the passanger onboard<br \/>\n**Parch** : Numeric - indicates the number of parents related to the passanger onboard<br \/>\n**Ticket** : nominal - ticket number of the passanger <br \/>\n**Fare** : Numeric - the amount paid for their ticket by the passanger<br \/>\n**Cabin** : nominal - the cabin number of the passanger<br \/>\n**Embarked** : nominal - indicates from what port the passanger embarked from<br \/>  \n","7a662acf":"## Data Transformation","59f933dc":"### Age EDA, How to deal with these Missing Values","6ced1460":"## Importing Data","ff98a3e7":"# Introduction\nHello, if you're reading this and you are like me, you are somewhat new to data science and are trying to expand your skillset. The goal of this kernal is to do a full on data science project and get your feet wet with a few of the typical techniques that are used in a data science projects.","b257d26f":"### Embarked EDA, How to deal with the 2 NA values","771ca32b":"### Cabin EDA, How to deal with these Missing Values","d1347728":"# Missing Values\n"}}