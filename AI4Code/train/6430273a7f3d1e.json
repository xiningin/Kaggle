{"cell_type":{"ee99ea6d":"code","e5115ada":"code","03bcbda1":"code","8b70133f":"code","81c18578":"code","5d6f170b":"code","68342fd2":"code","dd21f55b":"code","7045ace5":"code","02636393":"code","8bc70ad7":"code","f0ba11a5":"code","6a309f95":"code","09eec6d0":"code","0a263e2b":"code","051a20a2":"code","1ba6b7e5":"markdown","3a9e0b9e":"markdown","064bfacf":"markdown","dbddcc39":"markdown","8dd5b40f":"markdown"},"source":{"ee99ea6d":"import os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","e5115ada":"try:\n  # %tensorflow_version only exists in Colab.\n    %tensorflow_version 2.x\nexcept Exception:\n    pass","03bcbda1":"import tensorflow as tf\nprint(\"Num GPUs Available: \", len(tf.config.experimental.list_physical_devices('GPU')))","8b70133f":"import numpy as np\nimport tensorflow as tf","81c18578":"import pandas as pd\nheadlines = pd.read_csv('\/kaggle\/input\/million-headlines\/abcnews-date-text.csv')['headline_text']","5d6f170b":"headlines[0]","68342fd2":"import itertools as it \n\ndef sliding_window(txt):\n    for i in range(len(txt) - 2):\n        yield txt[i], txt[i + 1], txt[i + 2]\n\nwindow = list(it.chain(*[sliding_window(_) for _ in headlines[:10000]]))","dd21f55b":"for win in window[:10]:\n    print(win)","7045ace5":"mapping = {c: i for i, c in enumerate(pd.DataFrame(window)[0].unique())}\nintegers_in = np.array([[mapping[w[0]], mapping[w[1]]] for w in window])\nintegers_out = np.array([mapping[w[2]] for w in window]).reshape(-1, 1)","02636393":"mapping","8bc70ad7":"integers_in.shape","f0ba11a5":"from tensorflow.keras.layers import Embedding, Dense, Flatten\nfrom tensorflow.keras.models import Sequential\n\nnum_letters = len(mapping) # typically 36 -> 26 letters + 10 numbers\n\n# this one is so we might grab the embeddings\nmodel_emb = Sequential()\nembedding = Embedding(num_letters, 2, input_length=2)\nmodel_emb.add(embedding)\noutput_array = model_emb.predict(integers_in)\noutput_array.shape","6a309f95":"import matplotlib.pylab as plt\n\nidx_to_calc = list(mapping.values())\nidx_to_calc = np.array([idx_to_calc, idx_to_calc]).T\n\ntranslator = {v:k for k,v in mapping.items()}\npreds = model_emb.predict(idx_to_calc)\n\nplt.scatter(preds[:, 0, 0], preds[:, 0, 1], alpha=0)\nfor i, idx in enumerate(idx_to_calc):\n    plt.text(preds[i, 0, 0], preds[i, 0, 1], translator[idx[0]])","09eec6d0":"from tensorflow.keras.optimizers import Adam\n\n# this one is so we might learn the mapping\nmodel_pred = Sequential()\nmodel_pred.add(embedding)\nmodel_pred.add(Flatten())\nmodel_pred.add(Dense(num_letters, activation=\"softmax\"))\n\nadam = Adam(learning_rate=0.001, beta_1=0.9, beta_2=0.999, amsgrad=False)\n\nmodel_pred.compile(adam, 'categorical_crossentropy', metrics=['accuracy'])\n\noutput_array = model_pred.predict(integers_in)\noutput_array.shape","0a263e2b":"from sklearn.preprocessing import OneHotEncoder\n\nto_predict = OneHotEncoder(sparse=False).fit_transform(integers_out)\nmodel_pred.fit(integers_in, to_predict, epochs=10, verbose=1)","051a20a2":"preds = model_emb.predict(idx_to_calc)\nplt.scatter(preds[:, 0, 0], preds[:, 0, 1], alpha=0)\nfor i, idx in enumerate(idx_to_calc):\n    plt.text(preds[i, 0, 0], preds[i, 0, 1], translator[idx[0]])","1ba6b7e5":"## Learned Letters Relationship Visualization\nShows the learned distribtuion of letters after using previous 2 letters to predict 3rd","3a9e0b9e":"## Sequence of Letters \n\nLet's now take these headlines and grab sequences of letters out of them.","064bfacf":"## Initalized Letters Visualization\nShows the \"random\" distribtuion of letters after initalization","dbddcc39":"## Letter Embeddings\n* Notebook:https:\/\/github.com\/RasaHQ\/algorithm-whiteboard-resources\/blob\/master\/letter-embeddings\/algo_whiteboard_letter_embeddings_v2.ipynb\n* Video: https:\/\/www.youtube.com\/watch?v=mWvnlVw_LiY&amp=&amp;index=5\n\nFor some reason doesn't use GPU. Even if GPU accelerator is enabled and tensorflow can see GPU \u00af\\_(\u30c4)_\/\u00af","8dd5b40f":"## Fetching the Data \n\nThis is a bit annoying. But to download from kaggle we need to upload the API key here. Then we need to move the file to the correct folder after which we need to change the permissions. The error messages will not provide helpful information. Then again, this code works;"}}