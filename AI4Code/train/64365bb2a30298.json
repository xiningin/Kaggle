{"cell_type":{"70591183":"code","d7129b61":"code","79ef9a7b":"code","f2635ede":"code","76a09ba9":"code","71209740":"code","9ffa97cd":"code","5a013c1b":"code","0145502d":"code","65564e6a":"code","a60001f0":"code","41d78bd3":"code","edde37dd":"code","c485d613":"code","462de028":"code","c3a3af90":"code","643c5bed":"code","178fb146":"code","48429e26":"code","0124d7a7":"code","95d81401":"markdown","2875b4a5":"markdown","d2d96aa9":"markdown","03f915ce":"markdown","7418ee85":"markdown","e9589363":"markdown","fb21c1f4":"markdown","28e46aeb":"markdown","5823382d":"markdown","c413349d":"markdown"},"source":{"70591183":"import numpy as np # \u6570\u7ec4\u5e38\u7528\u5e93\nimport pandas as pd # \u8bfb\u5165csv\u5e38\u7528\u5e93\nfrom sklearn.linear_model import LinearRegression # sk-learn\u5e93Linear Regression\u6a21\u578b\nfrom sklearn.model_selection import train_test_split # sk-learn\u5e93\u8bad\u7ec3\u4e0e\u6d4b\u8bd5\nfrom sklearn import metrics # \u751f\u6210\u5404\u9879\u6d4b\u8bd5\u6307\u6807\u5e93\nimport matplotlib.pyplot as plt # \u753b\u56fe\u5e38\u7528\u5e93\nimport math #\u6570\u5b66\u5e93","d7129b61":" data= pd.read_csv(\"..\/input\/kc_house_data.csv\")","79ef9a7b":"data.dtypes","f2635ede":"data.head()","76a09ba9":"X = data[['bedrooms','bathrooms','sqft_living','floors']]\ny = data['price']","71209740":"xtrain, xtest, ytrain, ytest = train_test_split(X, y, test_size=1\/3, random_state=0)","9ffa97cd":"xtrain = np.asmatrix(xtrain)\nxtest = np.asmatrix(xtest)\nytrain = np.ravel(ytrain)\nytest = np.ravel(ytest)","5a013c1b":"ytrain","0145502d":"plt.scatter(X['sqft_living'],y)","65564e6a":"plt.scatter(X['sqft_living'],y)","a60001f0":"plt.scatter(X['bedrooms'],y)","41d78bd3":"model = LinearRegression()\nmodel.fit(xtrain,ytrain)","edde37dd":"model.coef_","c485d613":"pd.DataFrame(list(zip(X.columns, np.transpose(model.coef_))))","462de028":"model.intercept_","c3a3af90":"#\u4e00\u4e2a\u623f\u5b50\uff0c3\u4e2a\u5367\u5ba4\uff0c2\u4e2a\u536b\u751f\u95f4\uff0c2500sqft\uff0c2\u5c42\u697c\uff0c\u9884\u6d4b\u623f\u4ef7\nmodel.predict([[3,2,2500,2]])","643c5bed":"y_tra_pred = model.predict(xtrain)\n((y_tra_pred- ytrain)**2).sum() \/ len(ytrain)","178fb146":"(abs(y_tra_pred- ytrain)\/ytrain).sum()\/ len(ytrain)","48429e26":"predtest = model.predict(xtest)\n((predtest-ytest)*(predtest-ytest)).sum() \/ len(ytest)","0124d7a7":"(abs(predtest-ytest)\/ytest).sum() \/ len(ytest)","95d81401":"\u8bad\u7ec3\u96c6\u5408\u4e0a\u7684MSE","2875b4a5":"\u4ece..\/input\/kc_house_data.csv\u6587\u4ef6\u4e2d\u8bfb\u5165\u6570\u636e","d2d96aa9":"# Linear Regression\u9884\u6d4b\u623f\u4ef7","03f915ce":"\u7528xtrain\u548cytrain\u8bad\u7ec3\u6a21\u578b","7418ee85":"\u8bad\u7ec3\u96c6\u4e0a\u7684\u5747\u65b9\u5deeMSE","e9589363":"\u83b7\u5f972:1\u7684\u8bad\u7ec3\uff1a\u6d4b\u8bd5\u6570\u636e\u6bd4\u4f8b","fb21c1f4":"\u89c2\u5bdf\u751f\u6d3b\u9762\u79ef\u5206\u5e03","28e46aeb":"\u5e73\u5747\u76f8\u5bf9\u8bef\u5dee","5823382d":"\u89c2\u5bdf\u623f\u4ef7\u548c\u751f\u6d3b\u9762\u79ef\u7684\u5173\u7cfb","c413349d":"\u83b7\u5f97\u81ea\u53d8\u91cfX\u548c\u56e0\u53d8\u91cfY"}}