{"cell_type":{"70924668":"code","aec785ec":"code","f7c9d6eb":"code","540adef1":"code","341cc202":"code","0e9ae284":"code","204110a9":"code","1c7ae78e":"code","d63f0f63":"code","7d94d7be":"code","e2819e15":"code","071df468":"code","17488080":"code","f5503acf":"markdown","246fddfe":"markdown","936155bf":"markdown","375074d5":"markdown","73639f64":"markdown","390d9b0a":"markdown","b2749d46":"markdown","a38ac2e6":"markdown"},"source":{"70924668":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nfrom scipy.spatial.distance import cdist\nfrom IPython.display import display, Math","aec785ec":"A = np.random.normal(size=(211, 2))\nB = np.random.normal(size=(221, 2)) + (3, 0)\nC = np.random.normal(size=(199, 2)) + (2, 3)\nABC = np.concatenate((A, B, C))","f7c9d6eb":"plt.subplots(figsize=(7, 7))\nplt.scatter(A[:, 0], A[:, 1], label=\"A\")\nplt.scatter(B[:, 0], B[:, 1], label=\"B\")\nplt.scatter(C[:, 0], C[:, 1], label=\"C\")\nplt.ylim(-4, 6)\nplt.xlim(-4, 6)\nplt.title(\"Observations\", {'fontsize':20})\nplt.grid()\nplt.legend()","540adef1":"X = np.array([1.3, 0.9])","341cc202":"plt.subplots(figsize=(7, 7))\nplt.scatter(A[:, 0], A[:, 1], label=\"A\", alpha=0.2)\nplt.scatter(B[:, 0], B[:, 1], label=\"B\", alpha=0.2)\nplt.scatter(C[:, 0], C[:, 1], label=\"C\", alpha=0.2)\nplt.scatter(X[0], X[1], label=\"X\", c=\"k\")\nplt.ylim(-4, 6)\nplt.xlim(-4, 6)\nplt.title(\"Value to predict\", {'fontsize':20})\nplt.grid()\nplt.legend()","0e9ae284":"P_A = len(A) \/ len(ABC)\nP_B = len(B) \/ len(ABC)\nP_C = len(C) \/ len(ABC)\n\ndisplay(Math(r'P( \\textrm{class}) = \\frac{ \\textrm{class observations} }{ \\textrm{total observations} }'))\ndisplay(Math(r'P(A) = \\frac{%d}{%d} \\approx %.2f' % (len(A), len(ABC), P_A)))\ndisplay(Math(r'P(B) = \\frac{%d}{%d} \\approx %.2f' % (len(B), len(ABC), P_B)))\ndisplay(Math(r'P(C) = \\frac{%d}{%d} \\approx %.2f' % (len(C), len(ABC), P_C)))","204110a9":"R = 0.7\nAr = A[(cdist([X], A) <= R)[0], :]\nBr = B[(cdist([X], B) <= R)[0], :]\nCr = C[(cdist([X], C) <= R)[0], :]","1c7ae78e":"plt.subplots(figsize=(7, 7))\nplt.scatter(Ar[:, 0], Ar[:, 1], label=\"A\", alpha=0.2)\nplt.scatter(Br[:, 0], Br[:, 1], label=\"B\", alpha=0.2)\nplt.scatter(Cr[:, 0], Cr[:, 1], label=\"C\", alpha=0.2)\nplt.scatter([X[0]], [X[1]], label=\"X\", c=\"k\")\nplt.ylim(-4, 6)\nplt.xlim(-4, 6)\nplt.title(\"Similar observations\", {'fontsize':20})\nplt.grid()\nplt.legend()","d63f0f63":"P_XA = len(Ar) \/ len(A)\nP_XB = len(Br) \/ len(B)\nP_XC = len(Cr) \/ len(C)\n\ndisplay(Math(r'P(X \\vert \\textrm{class}) = \\frac{ \\textrm{class observations among similars} }{ \\textrm{class observations} }'))\ndisplay(Math(r'P(X \\vert A) = \\frac{%d}{%d} \\approx %.3f' % (len(Ar), len(A), P_XA)))\ndisplay(Math(r'P(X \\vert B) = \\frac{%d}{%d} \\approx %.3f' % (len(Br), len(B), P_XB)))\ndisplay(Math(r'P(X \\vert C) = \\frac{%d}{%d} \\approx %.3f' % (len(Cr), len(C), P_XC)))","7d94d7be":"P_X = (len(Ar) + len(Br) + len(Cr)) \/ len(ABC)\n\ndisplay(Math(r'P(X) = \\frac{ \\textrm{observations among similars} }{ \\textrm{total observations} }'))\ndisplay(Math(r'P(X) = \\frac{%d}{%d} \\approx %.3f' % (len(Ar) + len(Br) + len(Cr), len(ABC), P_X)))","e2819e15":"P_AX = P_XA * P_A \/ P_X\nP_BX = P_XB * P_B \/ P_X\nP_CX = P_XC * P_C \/ P_X\n\ndisplay(Math(r'P(\\textrm{class} \\vert X) = \\frac{P(X \\vert class) \\cdot P(class)}{P(X)}'))\ndisplay(Math(r'P(A \\vert X) = {}'.format(round(P_AX, 3))))\ndisplay(Math(r'P(B \\vert X) = {}'.format(round(P_BX, 3))))\ndisplay(Math(r'P(C \\vert X) = {}'.format(round(P_CX, 3))))","071df468":"display(Math(r'P(A \\vert X) + P(B \\vert X) + P(C \\vert X) = {}'.format(round(P_AX + P_BX + P_CX, 3))))","17488080":"plt.bar(\"a\", P_AX)\nplt.bar(\"b\", P_BX)\nplt.bar(\"c\", P_CX)\nplt.ylim(0, 1)\nplt.grid()","f5503acf":"### Value to predict","246fddfe":"# Naive Bayes (from scratch)","936155bf":"### Calculating posterior probability","375074d5":"### Generating random observations","73639f64":"### Calculating marginal likelihood","390d9b0a":"### Calculating prior probabilities","b2749d46":"### Calculating likelihood","a38ac2e6":"### Selecting similar observations"}}