{"cell_type":{"10ab94dd":"code","deabd482":"code","270963b4":"code","ea445567":"code","3c7bfa97":"code","6af38035":"code","23cac168":"code","140622be":"code","c777912c":"code","bc938f70":"markdown","a806ae60":"markdown","c51ea05b":"markdown","114884e9":"markdown","2aa8695b":"markdown","5f81d421":"markdown","a5e373c9":"markdown"},"source":{"10ab94dd":"import pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom sklearn.cluster import KMeans","deabd482":"data = pd.read_csv('..\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv')\ndata.head()","270963b4":"plt.scatter(data['Annual Income (k$)'],data['Spending Score (1-100)'])\nplt.xlabel('Annual Income (k$)')\nplt.ylabel('Spending Score (1-100)')","ea445567":"segment = data.iloc[:, [3, 4]].values\nwcss = []\nfor i in range(1, 11):\n    kmeans = KMeans(n_clusters = i, init = 'k-means++',max_iter = 500, n_init = 15)\n    kmeans.fit(segment)\n    wcss.append(kmeans.inertia_)\nplt.plot(range(1, 11), wcss, marker = 'o')\nplt.title('The Elbow Method')\nplt.xlabel('Number of clusters')\nplt.ylabel('WCSS')\nplt.grid()\nplt.show()","3c7bfa97":"kmeans = KMeans(5)\nkmeans.fit(segment)\ndata['cluster'] = kmeans.fit_predict(segment)\n# pd.set_option('display.max_rows', data.shape[0]+1)\ndata","6af38035":"plt.scatter(data['Annual Income (k$)'],data['Spending Score (1-100)'],c=data['cluster'],cmap='rainbow')\nplt.xlabel('Annual Income (k$)')\nplt.ylabel('Spending Score (1-100)')","23cac168":"highIncome_LowSpend = data.drop(['CustomerID'],axis=1)\nhighIncome_LowSpend.drop(highIncome_LowSpend[highIncome_LowSpend['cluster'] != 0].index, inplace=True)\nhighIncome_LowSpend['Gender'] = highIncome_LowSpend['Gender'].map({'Male':0,'Female':1})\nhighIncome_LowSpend.describe()","140622be":"plt.figure(figsize=(8,8))\nhighIncome_LowSpend.Gender.value_counts().plot(kind='pie', autopct='%.2f%%', shadow=True,explode=(0,0.04))\nplt.legend()","c777912c":"sns.histplot(data=highIncome_LowSpend, x='Age', hue='Gender', binwidth=2, multiple='stack',palette='Pastel1').set_title('Age distribution')","bc938f70":"# Elbow method to determine number of clusters in K-means","a806ae60":"# K-means clustering\n\nNumber of clusters will be 5. As, after 5 clusters the arc is almost linear.","c51ea05b":"# Plotting clusters","114884e9":"# Purple group gender distribution\n\nWe can see that there are more men than woment in this group.","2aa8695b":"# Optional Analysis\n\n* The Yellow and Green groups are having good spending score, whereas Blue's performance is average.\n* Two groups which need to be focused on are Purple and Red.\n* I am taking Purple cluster for demonstration as they have the potential but they are less inclined towards spending.","5f81d421":"# Plotting Annual Income and Spending Score","a5e373c9":"# Purple group Age distribution\n\nThe target age should be between 34 and 48. As we have highest number of people in this age group. Various curated offers or age band specific produts can be used to improve the spending score."}}