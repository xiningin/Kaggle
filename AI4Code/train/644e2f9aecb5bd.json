{"cell_type":{"3a29295a":"code","ec0f2f43":"code","d372f757":"code","2a36e11c":"code","097e6302":"code","91ba3462":"code","9dcac8cb":"code","1ddf8385":"code","443d41e0":"code","eafeeceb":"code","e181f445":"code","349ae9f9":"code","9c9f6701":"code","3b858baf":"code","83f83b03":"code","dd3c30b8":"code","fcf95f26":"code","661756c9":"code","85b19eee":"code","81ab196e":"code","a6561e32":"code","cf7ad604":"code","b799f45c":"code","fc0f38a1":"code","2c6d8df8":"code","bd29b72c":"code","9195ba48":"code","a808c198":"code","85e9c708":"code","7f206294":"code","13af1374":"code","3dbb6697":"code","80ccf447":"code","076d19e6":"code","5a417943":"code","9b1f22d6":"code","583bee4d":"code","845eb73c":"code","a4554163":"code","a9d7566e":"code","a260fd80":"code","13aee5b0":"code","a7764ad1":"code","88ed29b0":"code","804b6240":"code","eca0d596":"code","f2918d49":"code","22938347":"code","71e9610f":"code","fe6fdb6d":"code","0921b2ad":"code","f6030979":"code","8526f5d1":"code","78fe4530":"code","469a0929":"markdown","2f11f144":"markdown","847c020f":"markdown","e32f0663":"markdown","ef31ca32":"markdown","1d968c52":"markdown","58408823":"markdown","506a09f5":"markdown","41a94238":"markdown"},"source":{"3a29295a":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport re\nfrom scipy import stats","ec0f2f43":"df = pd.read_csv(\"\/kaggle\/input\/loan-default-prediction\/Default_Fin.csv\")","d372f757":"df.head()","2a36e11c":"df.drop(columns=[\"Index\"], inplace=True)\ndf.tail()","097e6302":"df.info()","91ba3462":"df.describe()","9dcac8cb":"x=sns.PairGrid(data=df)\nx.map(plt.scatter)","1ddf8385":"df[\"Annual Salary\"].hist()","443d41e0":"df[\"Bank Balance\"].hist()","eafeeceb":"df[\"Employed\"].hist()","e181f445":"df[\"Defaulted?\"].hist()","349ae9f9":"group = df.groupby([\"Employed\", \"Defaulted?\"], as_index=False)\ngroup.mean()","9c9f6701":"group.count()","3b858baf":"group.count()[\"Bank Balance\"].to_numpy()\/[2817+127, 2817+127, 6850+206, 6850+206]","83f83b03":"group.max()","dd3c30b8":"group.min()","fcf95f26":"group = df.groupby([\"Employed\", \"Defaulted?\"], as_index=False)","661756c9":"zeros = df[df[\"Bank Balance\"]==0]\nzeros.count()","85b19eee":"zeros","81ab196e":"zeros.mean()","a6561e32":"zeros.groupby([\"Employed\", \"Defaulted?\"]).mean()","cf7ad604":"highs = df[df[\"Bank Balance\"] >= 31851]\nhighs.count()","b799f45c":"highs.mean()","fc0f38a1":"min_salaries = df[df[\"Annual Salary\"] == 9263.640000]\nmax_salaries = df[df[\"Annual Salary\"] == 882650.760000]","2c6d8df8":"min_salaries","bd29b72c":"max_salaries","9195ba48":"df[[\"Annual Salary\", \"Bank Balance\"]].corr()","a808c198":"bins = {\"Annual Salary\":4, \"Bank Balance\":3}\nfor j in bins.keys():\n    df[j+\"_bin\"] = pd.cut(df[j], bins[j], labels=False)","85e9c708":"df[[\"Annual Salary_bin\", \"Bank Balance_bin\"]].corr(method=\"pearson\")","7f206294":"df.groupby(\"Annual Salary_bin\").mean()","13af1374":"df.groupby(\"Bank Balance_bin\").mean()","3dbb6697":"sns.stripplot(data=df, x=\"Defaulted?\", y=\"Bank Balance\")","80ccf447":"sns.stripplot(data=df, x=\"Defaulted?\", y=\"Annual Salary\")","076d19e6":"from sklearn.preprocessing import StandardScaler\ndf[\"Salary_standardized\"]=StandardScaler().fit_transform(df[[\"Annual Salary\"]])\ndf[\"bal_standardized\"]=StandardScaler().fit_transform(df[[\"Bank Balance\"]])","5a417943":"df","9b1f22d6":"from sklearn.metrics import mean_squared_error\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.svm import SVC\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.metrics import classification_report","583bee4d":"X_train, X_test, y_train, y_test = train_test_split(df.drop(columns=[\"Defaulted?\", \"Annual Salary\", \"Bank Balance\"]), df[\"Defaulted?\"], test_size=0.33, random_state=42)","845eb73c":"params = {'C':[0.1, 1, 10, 0.001], 'solver':['liblinear', 'lbfgs', 'sag']}\nlr = LogisticRegression(max_iter=3000)\ncf = GridSearchCV(lr, params, cv=5)","a4554163":"cf.fit(X_train, y_train)\nprint(cf.best_params_)\nprint(cf.score(X_test, y_test))","a9d7566e":"print(mean_squared_error(y_test, cf.predict(X_test)))\nprint(classification_report(y_test, cf.predict(X_test)))","a260fd80":"parameters = {'kernel':('linear', 'rbf'), 'C':[1, 10, 0.1, 0.01]}\nsvc = SVC(gamma=\"scale\")\nclf = GridSearchCV(svc, parameters, cv=5)","13aee5b0":"clf.fit(X_train, y_train)","a7764ad1":"clf.score(X_test, y_test)","88ed29b0":"print(mean_squared_error(y_test, clf.predict(X_test)))\nprint(classification_report(y_test, clf.predict(X_test)))","804b6240":"from sklearn.ensemble import AdaBoostClassifier\nada = AdaBoostClassifier()\npar = {'algorithm':['SAMME', 'SAMME.R']}\nclf = GridSearchCV(ada, par, cv=5)","eca0d596":"clf.fit(X_train, y_train)\nclf.score(X_test, y_test)","f2918d49":"print(mean_squared_error(y_test, clf.predict(X_test)))\nprint(classification_report(y_test, clf.predict(X_test)))","22938347":"from imblearn.over_sampling import SMOTE\nsmote=SMOTE(sampling_strategy='minority')\nX_smte, y_smte=smote.fit_resample(df.drop(columns=[\"Defaulted?\", \"Annual Salary\", \"Bank Balance\"]),df[\"Defaulted?\"])","71e9610f":"X_train,X_test,y_train,y_test=train_test_split(X_smte,y_smte,test_size=0.33,random_state=15, stratify=y_smte)","fe6fdb6d":"params = {'C':[0.1, 1, 10, 0.001], 'solver':['liblinear', 'lbfgs', 'sag']}\nlr = LogisticRegression(max_iter=3000)\ncf = GridSearchCV(lr, params, cv=5)","0921b2ad":"clf.score(X_test, y_test)","f6030979":"clf.fit(X_train, y_train)\nprint(classification_report(y_test, clf.predict(X_test)))","8526f5d1":"parameters = {'kernel':('linear', 'rbf'), 'C':[1, 10, 0.1, 0.01]}\nsvc = SVC(gamma=\"scale\")\nclf = GridSearchCV(svc, parameters, cv=5)\nclf.fit(X_train, y_train)\nprint(classification_report(y_test, clf.predict(X_test)))","78fe4530":"clf.score(X_test, y_test)","469a0929":"There are more defaulters amongst the unemployed.","2f11f144":"Even though the accuracy is reduced. The precision, recall and f1 scores have improved significantly.","847c020f":"**Bin the \"Annual Salary\" and \"Bank Balance\" columns**","e32f0663":"# Feature Engineering and prediction","ef31ca32":"All persons with Bank Balance of zero do not default and most of them are employed.","1d968c52":"**Standardize the columns**","58408823":"The dataset is obviously imbalanced because of the difference in precision, recall and f1 scores across classes.\nI'll handle this next with smote","506a09f5":"# Handle Imbalance With Smote","41a94238":"Unemployed people have higher mean Bank Balance and Lower Annual salary with unemployed defaulters having the highest bank balance."}}