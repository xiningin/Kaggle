{"cell_type":{"5415d4de":"code","4d61e13e":"code","64ffeadf":"code","9ca7a893":"code","c6ea4e3b":"code","f366ed52":"code","a5c9b15b":"code","49658376":"code","2d223650":"code","799d0bcc":"code","19820dbc":"code","1d3d14d0":"code","e7702640":"code","2e0cdcb2":"code","fb83e97c":"code","fb118cbe":"code","7e309e7c":"code","2eae63f5":"code","fca77e59":"code","5b6b0df2":"code","0710561e":"code","e6382b0a":"code","bb5376a3":"code","d6ec20ef":"code","1c29b282":"code","dc807375":"code","3c2614f3":"code","c121faa0":"code","0650b1d6":"code","38f61f1d":"code","e33d43fb":"code","d147d9dd":"markdown","6c04abf9":"markdown","c3b6737b":"markdown","51c69f8b":"markdown","ff09b347":"markdown","117905f8":"markdown","6689f278":"markdown","829bbb7c":"markdown","abb023c6":"markdown","3c6a78e2":"markdown","c3b72d19":"markdown","43ca6956":"markdown","63b713cd":"markdown","d0cae69f":"markdown","b2f39be1":"markdown","411b569a":"markdown","3948ebd9":"markdown","7be8d9bb":"markdown","bd8d0034":"markdown","e9831191":"markdown","da470a44":"markdown","212930c8":"markdown","98905acb":"markdown"},"source":{"5415d4de":"!pip install linearmodels","4d61e13e":"import math\nimport warnings\nwarnings.filterwarnings('ignore')\n\nfrom IPython.display import YouTubeVideo\nfrom linearmodels.panel import PanelOLS, RandomEffects\nfrom linearmodels.panel.data import PanelData\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport pandas as pd\nimport plotly.express as px\nimport seaborn as sns\nimport statsmodels.api as sm\nimport statsmodels.formula.api as smf\nfrom statsmodels.stats.stattools import durbin_watson\n\n%matplotlib inline","64ffeadf":"! ls ..\/input\/healthcare-investments-and-length-of-hospital-stay\/","9ca7a893":"df_hihs = pd.read_csv(\"..\/input\/healthcare-investments-and-length-of-hospital-stay\/Healthcare_Investments_and_Hospital_Stay.csv\")","c6ea4e3b":"df_hihs.head()","f366ed52":"df_hihs.info()","a5c9b15b":"locations = set(df_hihs[\"Location\"])\nprint(f\"There are {len(locations)} countries data.\\n\")\n\nprint(\"The country breakdown is as follows:\")\nprint(locations)","49658376":"fig = plt.figure(figsize=(15, 4))\ng = sns.countplot(data=df_hihs, x=\"Location\",\n                  order = df_hihs['Location'].value_counts().index)\ng.set_xticklabels(g.get_xticklabels(), rotation=90)\ng.set_title(\"records for each location\")","2d223650":"print(f'Minimum year: {min(df_hihs[\"Time\"])}')\nprint(f'Maxmum year: {max(df_hihs[\"Time\"])}')","799d0bcc":"g = sns.distplot(df_hihs[\"Time\"],  kde=False, rug=False, color=\"darkgoldenrod\")\ng.set_title(\"Time distribution\")","19820dbc":"g = sns.distplot(df_hihs[\"Hospital_Stay\"],  kde=False, rug=False, color=\"b\")\ng.set_title(\"Hospital_Stay distribution\")","1d3d14d0":"YouTubeVideo('kmfmGhI8l9E')","e7702640":"g = sns.distplot(df_hihs[\"MRI_Units\"],  kde=False, rug=False, color=\"g\")\ng.set_title(\"MRI_Units distribution\")","2e0cdcb2":"YouTubeVideo('l9swbAtRRbg')","fb83e97c":"g = sns.distplot(df_hihs[\"CT_Scanners\"],  kde=False, rug=False, color=\"y\")\ng.set_title(\"CT_Scanners distribution\")","fb118cbe":"g = sns.distplot(df_hihs[\"Hospital_Beds\"],  kde=False, rug=False, color=\"orange\")\ng.set_title(\"Hospital_Beds distribution\")","7e309e7c":"g = sns.heatmap(df_hihs[[\"Hospital_Beds\", \"CT_Scanners\", \"MRI_Units\", \"Hospital_Stay\"]].corr(),\n                annot=True, cmap=\"YlGnBu\")\ng.set_title(\"Correlation matrix for each indicator\")","2eae63f5":"g = sns.pairplot(df_hihs[[\"Hospital_Beds\", \"CT_Scanners\", \"MRI_Units\", \"Hospital_Stay\"]])\n#ax = plt.gca()\n#ax.set_title(\"Pair plot for each indicator\")","fca77e59":"fig = px.scatter(df_hihs, x=\"Time\", y=\"Hospital_Stay\",color=\"Location\",\n                 hover_data=['Time', \"Location\"])\nfig.show()","5b6b0df2":"for loc in locations:\n    df_hihs_tmp = df_hihs[df_hihs[\"Location\"]==loc]\n    sns.lmplot(x=\"Time\", y=\"Hospital_Stay\", data=df_hihs_tmp).set(xlim=(1990, 2018))\n    ax = plt.gca()\n    ax.set_title(f\"Hospital_Stay vs Time of {loc}\")","0710561e":"df_hihs_log = df_hihs.copy()\ndf_hihs_log[\"Hospital_Stay\"] = df_hihs_log[\"Hospital_Stay\"].map(lambda x: math.log(x))","e6382b0a":"fig = px.scatter(df_hihs_log, x=\"Time\", y=\"Hospital_Stay\",color=\"Location\",\n                 hover_data=['Time', \"Location\"])\nfig.show()","bb5376a3":"for loc in locations:\n    df_hihs_tmp = df_hihs_log[df_hihs_log[\"Location\"]==loc]\n    sns.lmplot(x=\"Time\", y=\"Hospital_Stay\", data=df_hihs_tmp).set(xlim=(1990, 2018))\n    ax = plt.gca()\n    ax.set_title(f\"Hospital_Stay vs Time of {loc}\")","d6ec20ef":"Location = pd.Categorical(df_hihs_log.Location)\ndf_hihs_log = df_hihs_log.set_index(['Location', 'Time'])","1c29b282":"df_hihs_log","dc807375":"formula_fe = 'Hospital_Stay ~ CT_Scanners + Hospital_Beds + EntityEffects'\nmod_fe = PanelOLS.from_formula(formula_fe, data=df_hihs_log)\nresult_fe = mod_fe.fit()","3c2614f3":"print(result_fe.summary.tables[1])","c121faa0":"durbin_watson(result_fe.resids)","0650b1d6":"exog_vars = ['CT_Scanners', 'Hospital_Beds']\nexog = sm.add_constant(df_hihs_log[exog_vars])\nmod_ra = RandomEffects(df_hihs_log.Hospital_Stay, exog)\nresult_ra = mod_ra.fit()","38f61f1d":"print(result_ra)","e33d43fb":"durbin_watson(result_ra.resids)","d147d9dd":"There are 518 records and 6 columns for each record. There are no missing value.","6c04abf9":"### Time\n\nYear when the data got. The more recent the data, the more data there is.","c3b6737b":"## Log Transformation","51c69f8b":"### Location\n\nLocation indicates which country each record belongs to.\n\nWe can see ","ff09b347":"<a id=\"2\"><\/a> <br>\n# <div class=\"alert alert-block alert-success\">Data overview<\/div>","117905f8":"### MRI_Units\n\nThis indicator is measured in the numbers of equipment per 1,000,000 inhabitants.\n\nI've also included a reference video in case anyone is not familiar with MRI.","6689f278":"Basically, the hypothesis that data can be approximated by a locally linear system seems to be correct, and the slope is right-shouldering. It makes sense that as we modernize, improvements in medical standards and hospitalization systems will occur, and ALOS will become smaller.\n\nHowever, some countries have widely varying data. In such countries, the data may not have been taken correctly, or there may be reasons why ALOS has not decreased over time.","829bbb7c":"I'll import required libraries.","abb023c6":"# Healthcare Investments: Visualization & EDA\n\n## **Content**\n1. [Preparation](#1)\n1. [Data overview](#2)\n1. [EDA](#3)\n1. [Modeling](#4)","3c6a78e2":"<a id=\"4\"><\/a> <br>\n# <div class=\"alert alert-block alert-success\">Modeling<\/div>","c3b72d19":"Let's see data.\n\nThe data is panel data. As we will see later, this is an unbalanced panel data because the number of data for each country varies.","43ca6956":"### Hospital Beds\n\n The indicator is presented as a total and for curative care and psychiatric care. It is measured in number of beds per 1,000 inhabitants.","63b713cd":"The average length of stay (ALOS) is used as an indicator of hospital efficiency. A shorter average length of stay means that patients admitted to the hospital are circulating more efficiently, and fewer patients are kept waiting for a long time when they need to be admitted. It will also have a positive impact on the cost side of the hospital.\n\n### Reference\n\n* [OECD Data](https:\/\/data.oecd.org\/healthcare\/length-of-hospital-stay.htm)\n* [Health at a Glance 2019 : OECD Indicators](https:\/\/www.oecd-ilibrary.org\/sites\/0d8bb30a-en\/index.html?itemId=\/content\/component\/0d8bb30a-en)\n* [Decreasing the Patient Length of Stay](https:\/\/centrak.com\/blog-decreasing-patient-length-of-stay\/#:~:text=The%20average%20length%20of%20stay,cost%20of%20%2410%2C400%20per%20day.)","d0cae69f":"We can use one csv data.","b2f39be1":"The distribution of ALOS with other indicators has a curious shape.At first glance, it looks like a messed up set of data points, but it also looks like a collection of several semi-proportional data series.\n\nLet's be able to look at it in more detail. Using Pyplot, we can find out which points belong to which countries.","411b569a":"<a id=\"3\"><\/a> <br>\n# <div class=\"alert alert-block alert-success\">EDA<\/div>","3948ebd9":"Let's look at the distributions in detail.","7be8d9bb":"<a id=\"1\"><\/a> <br>\n# <div class=\"alert alert-block alert-info\">Preparation<\/div>","bd8d0034":"Very interestingly, our intuition seemed to be right. By changing the color of the data points for each country, we could see that each data was a right-shouldering data series.\n\nWe will try to draw them so that we can see data for each country. Assuming that it can be approximated by a straight line, we will also draw an approximate line. Of course, this assumption is local, since no matter how much we modernize, ALOS will never go below zero.","e9831191":"First, we look at the correlation between indicators.\n\nThere does not seem to be any indicator that correlates well with ALOS. On the other hand, there seems to be a high correlation between indicators other than ALOS.","da470a44":"### CT Scanners\n\nThis indicator is measured in the numbers of equipment per 1,000,000 inhabitants.\n\nI also included a reference video for CT scanner.","212930c8":"I'll import this data.","98905acb":"### ALOS\n\nThe indicator I mentioned above. It is generally measured by dividing the total number of days stayed by all inpatients during a year by the number of admissions or discharges. Day cases are excluded. The indicator is presented both for all acute care cases and for childbirth without complications."}}