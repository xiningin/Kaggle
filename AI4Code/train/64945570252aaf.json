{"cell_type":{"ed09eda8":"code","a3ed92be":"code","fdfbc671":"code","e377c6af":"code","b56b5f39":"code","b21c437c":"code","46adc893":"code","6fb81ce2":"code","08025bf6":"code","749f7e9d":"code","a6b88a52":"code","5dc61e26":"code","7d53c107":"code","209a7db9":"code","5e601b44":"code","081f8f03":"code","81d0d048":"code","f29790a4":"code","7de0a962":"code","5453fb82":"code","2296b511":"code","f068bdeb":"code","8e2754c1":"code","908f1ecd":"code","bcdbb6f8":"code","779a0aef":"code","180fae75":"code","9e5ebd57":"code","1be3060a":"code","cf6b2a8b":"code","6429064f":"code","113f9234":"code","275e8a94":"code","427cb18c":"code","d3f4c198":"code","9709b6a3":"code","82786c30":"code","a4173573":"code","af2e5ae9":"code","325094df":"code","9e067293":"code","e0701a09":"code","56a5de2d":"code","fa1694cf":"code","52a2e2fb":"code","815bb3f3":"code","d665332d":"code","4510c4a7":"code","28f6cff1":"code","d7e2fc1b":"code","24296cac":"code","34ffddab":"code","c01b0895":"code","480f7c99":"code","de6574a6":"code","6dd7c309":"code","505714a6":"code","808d73af":"code","edfb8400":"code","559fe4d6":"code","5d87dbfb":"code","49d97c59":"code","12dfecf6":"code","f6fd89ed":"code","e25864a7":"code","38c54f93":"code","0dff0165":"code","00b3b6de":"code","0e033c36":"code","d8bbf8f3":"code","4c792ac1":"code","229da5ff":"code","4ff3fbe6":"code","5f0b1838":"code","11933f88":"code","3b43d846":"code","a9b6d345":"code","e97204b9":"code","99adc759":"code","f5ae551c":"code","6b777a9c":"code","7ed1b607":"code","65585daf":"code","8704a17a":"code","5b62a3b3":"code","0bdbbe68":"code","9acee28f":"code","14fccf83":"code","f230a4e6":"code","d510a78b":"code","d979db8f":"code","270bdf86":"code","6e4504aa":"code","5a3f3031":"code","16445cb3":"code","bf4f497e":"code","2fb2cb62":"code","5cf69df7":"code","1d271b26":"code","f562c723":"code","b15f5450":"code","9d77c4e9":"code","0e8d1953":"code","e9650f39":"code","f9c46b8f":"code","a8f1c1c5":"code","419d264c":"code","e5a20f97":"code","70f3d92e":"code","bea2abec":"code","96655085":"code","790ddf24":"code","9d5eb6c5":"code","d3517f38":"code","dea749a3":"code","5f7a3b8a":"code","86cd372d":"code","6d9760b3":"code","fc5d755e":"code","fce4d0af":"code","58aac923":"code","4c50f784":"code","ddf358f4":"code","75f0bdca":"code","21d56a1a":"code","a4587ad5":"code","c3a97221":"code","ae80dd04":"code","5eb17af7":"code","633ce226":"code","e2b78ff9":"code","ed408c3f":"code","2d3ff398":"code","fdd0cd6c":"code","d1e17149":"code","8341db94":"code","8d58dd42":"code","ee6e2bf2":"code","3844e9ee":"code","cef9faa4":"code","c8d3cd16":"code","01c64905":"code","3e9137a0":"code","d23fd80b":"code","8aca4883":"code","b0b4f437":"code","3da46d5e":"code","6256cf88":"code","7940a2f3":"code","3473af31":"code","8508469f":"code","8caa04ae":"code","6d01975b":"code","7dbf41f4":"code","be39efdd":"code","3ea0727d":"markdown","c9421da3":"markdown","d07fdb21":"markdown","ba055180":"markdown","4676fba7":"markdown","71e2d61c":"markdown","d8a70fa6":"markdown","17175804":"markdown","f55bf2a0":"markdown","4505cf9f":"markdown","f8ca6ce3":"markdown","a6bbfd2f":"markdown","fca87931":"markdown","a3978c2a":"markdown","95429322":"markdown","7a2c6bd7":"markdown","56b5b1e5":"markdown","96364d05":"markdown","5b25f8a3":"markdown","df367dca":"markdown","51d26c54":"markdown"},"source":{"ed09eda8":"import numpy as np\nimport pandas as pd\nimport plotly.express as ex\nimport plotly.graph_objs as go\nimport plotly.figure_factory as ff\nfrom plotly.subplots import make_subplots as mk_sp\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n\nimport plotly.offline as pyo\npyo.init_notebook_mode()\n\nimport warnings\nwarnings.filterwarnings(\"ignore\")\n\nplt.rc('figure', figsize=(18,9))","a3ed92be":"train=pd.read_csv('..\/input\/tabular-playground-series-apr-2021\/train.csv')\ntest=pd.read_csv('..\/input\/tabular-playground-series-apr-2021\/test.csv')\n\ntrain[\"Survived\"]=train[\"Survived\"].apply(lambda x:\"survived\" if x in [1] else \"dead\")","fdfbc671":"labels=[\"survived\", \"dead\"]","e377c6af":"train.head()","b56b5f39":"test.head()","b21c437c":"print(\"shape of train data: {} x {}\".format(len(train), train.shape[1]))\nprint(\"shape of test data: {} x {}\".format(len(test), test.shape[1]))","46adc893":"print(\"Summary of train data\\n\")\nprint(train.info())","6fb81ce2":"print(\"Summary of test data\\n\")\nprint(test.info())","08025bf6":"print(\"Count of null values in train data:\\n\")\nprint(train.isnull().sum())\n\nprint(\"\\n\\nNaN rows is: {}\".format(sum(train.isnull().sum())))","749f7e9d":"print(\"Count of null values in test data:\\n\")\nprint(test.isnull().sum())\n\n\nprint(\"\\n\\nNaN rows is: {}\".format(sum(test.isnull().sum())))","a6b88a52":"print(\"Count of unique values in train data:\\n\")\ntrain[['SibSp', 'Parch', 'Embarked', 'Pclass']].nunique()","5dc61e26":"print(\"Count of unique values in test data:\\n\")\ntest[['SibSp', 'Parch', 'Embarked', 'Pclass']].nunique()","7d53c107":"print(\"Train data:\\n\")\nfor col in ['SibSp', 'Parch']:\n    print(\"Unique value in {} is {}\".format(col, sorted(train[col].unique())))","209a7db9":"print(\"Test data:\\n\")\nfor col in ['SibSp', 'Parch']:\n    print(\"Unique value in {} is {}\".format(col, sorted(test[col].unique())))","5e601b44":"train['Cabin'].fillna('X', inplace=True)\ntrain['Cabin']=[list(word)[0] for word in train['Cabin'].values]\n\ntest['Cabin'].fillna('X', inplace=True)\ntest['Cabin']=[list(word)[0] for word in test['Cabin'].values]\n\nprint(\"Train: Unique elements in Cabin: \", sorted(train['Cabin'].unique()))\n\nprint(\"\\n Train: Count of unique elements in Cabin:\", train['Cabin'].value_counts())\n\n\nprint(\"Test: Unique elements in Cabin: \", sorted(test['Cabin'].unique()))\n\nprint(\"\\n Test: Count of unique elements in Cabin:\", test['Cabin'].value_counts())","081f8f03":"fig, ax=plt.subplots(ncols=2, facecolor='#f6f5f5')\nax[0].pie(train.groupby(['Survived'])['Survived'].count(), explode=(0, 0.1), labels=['dead','survived'], autopct='%1.1f%%', shadow=True)\nsns.histplot(train, x=\"Survived\", ax=ax[1])\nax[0].set_title('Survived')\nax[1].set_title('Survived')\nax[1].set_xticks([0,1])\nfig.suptitle('Distribution of survived & dead', fontsize=20)\nfig.show()","81d0d048":"train.dropna(inplace=True)\ntest.dropna(inplace=True)","f29790a4":"print(\"Distribution of train data: \\n\")\ntrain.describe()","7de0a962":"print(\"Distribution of test data: \\n\")\ntest.describe()","5453fb82":"train['species']='train'\ntest['species']='test'\ndf=train.append(test, ignore_index=True)","2296b511":"fig, ax=plt.subplots(facecolor='#f6f5f5', figsize=(9,5))\nsns.histplot(df, x=\"Age\", hue=\"species\", ax=ax, element='poly')\nfig.suptitle('Distribution of train & test set of Age', fontsize=20)\nfig.show()","f068bdeb":"lst=[\"\"]*len(train)\nfor (i,age) in enumerate(train['Age'].values):\n    if age<=5:\n        lst[i]=\"0-5\"\n    elif age>5 and age<=10:\n        lst[i]=\"5-10\"\n    elif age>10 and age<=15:\n        lst[i]=\"10-15\"\n    elif age>15 and age<=20:\n        lst[i]=\"15-20\"\n    elif age>20 and age<=25:\n        lst[i]=\"20-25\"\n    elif age>25 and age<=30:\n        lst[i]=\"25-30\"\n    elif age>30 and age<=35:\n        lst[i]=\"30-35\"\n    elif age>35 and age<=40:\n        lst[i]=\"35-40\"\n    elif age>40 and age<=45:\n        lst[i]=\"40-45\"\n    elif age>45 and age<=50:\n        lst[i]=\"45-50\"\n    elif age>50 and age<=55:\n        lst[i]=\"50-55\"\n    elif age>55 and age<=60:\n        lst[i]=\"55-60\"\n    elif age>60 and age<=65:\n        lst[i]=\"60-65\"\n    elif age>65 and age<=70:\n        lst[i]=\"65-70\"\n    elif age>70 and age<=75:\n        lst[i]+=\"70-75\"\n    elif age>75 and age<=80:\n        lst[i]=\"75-80\"\n    elif age>80 and age<=85:\n        lst[i]=\"80-85\"\n    else:\n        lst[i]=\"85+\"","8e2754c1":"train['agecount']=lst","908f1ecd":"fig, ax=plt.subplots(nrows=2, ncols=2, facecolor='#f6f5f5', figsize=(25, 15))\nsns.histplot(train, x=\"Age\", bins=16, ax=ax[0][0], hue_order=labels)\nsns.histplot(train, x=\"Age\", hue=\"Survived\", bins=16, ax=ax[0][1], hue_order=labels)\nsns.histplot(train[train['Sex']=='male'], x=\"Age\", hue=\"Survived\", bins=16, ax=ax[1][0], hue_order=labels)\nsns.histplot(train[train['Sex']=='female'], x=\"Age\", hue=\"Survived\", bins=16, ax=ax[1][1], hue_order=labels)\nax[0][0].set_xticks(range(0,85,5))\nax[0][1].set_xticks(range(0,85,5))\nax[1][0].set_xticks(range(0,85,5))\nax[1][1].set_xticks(range(0,85,5))\nax[0][0].set_title(\"Distribution of population\")\nax[0][1].set_title('Survival')\nax[1][0].set_title('Survival of male')\nax[1][1].set_title('Survival of female')\nfig.suptitle('Distribution of population based on age', fontsize=20)\nfig.show()","bcdbb6f8":"Age=['0-5','5-10','10-15','15-20','20-25','25-30','30-35','35-40','40-45','45-50','50-55','55-60','60-65','65-70','70-75','75-80','80-85','85+','All']\npd.crosstab(train.Survived,train.agecount,margins=True)[Age].style.background_gradient(cmap='summer_r')","779a0aef":"(pd.crosstab(train.Survived,train.agecount,normalize='columns', margins=True)[Age]*100).style.background_gradient(cmap='summer_r').set_precision(2)","180fae75":"pd.crosstab([train.Sex,train.Survived],train.agecount,margins=True)[Age].style.background_gradient(cmap='summer_r')","9e5ebd57":"Age=['0-5','5-10','10-15','15-20','20-25','25-30','30-35','35-40','40-45','45-50','50-55','55-60','60-65','65-70','70-75','75-80','80-85','All']\n(pd.crosstab([train[train['Sex']=='male'].Sex,train.Survived],train.agecount,normalize='columns',margins=True)[Age].round(4)*100).style.background_gradient(cmap='summer_r').set_precision(2)","1be3060a":"Age=['0-5','5-10','10-15','15-20','20-25','25-30','30-35','35-40','40-45','45-50','50-55','55-60','60-65','65-70','70-75','75-80','80-85','85+','All']\n(pd.crosstab([train[train['Sex']=='female'].Sex,train.Survived],train.agecount,normalize='columns',margins=True)[Age].round(4)*100).style.background_gradient(cmap='summer_r').set_precision(2)","cf6b2a8b":"lst=train[train['Sex']=='male'].groupby('agecount')['agecount'].count()\nlst1=train[(train[\"Survived\"]==\"survived\") & (train['Sex']=='male')].groupby('agecount')['agecount'].count()\nlst2=train[(train[\"Survived\"]==\"dead\") & (train['Sex']=='male')].groupby('agecount')['agecount'].count()\nfor i in range(len(lst1)):\n    print(\"% Survival of male for age group  {:s} is : {:.2f}%\".format(lst1.index[i], 100.0*lst1[i]\/lst[i]))\n\nprint(\"\\n\\n\")\n\nfor i in range(len(lst2)):\n    print(\"% Dead of male for age group  {:s} is : {:.2f}%\".format(lst2.index[i], 100.0*lst2[i]\/lst[i]))","6429064f":"lst=train[train['Sex']=='female'].groupby('agecount')['agecount'].count()\nlst1=train[(train[\"Survived\"]==\"survived\") & (train['Sex']=='female')].groupby('agecount')['agecount'].count()\nlst2=train[(train[\"Survived\"]==\"dead\") & (train['Sex']=='female')].groupby('agecount')['agecount'].count()\nfor i in range(len(lst1)):\n    print(\"% Survival of female for age group  {:s} is : {:.2f}%\".format(lst1.index[i], 100.0*lst1[i]\/lst[i]))\n\nprint(\"\\n\\n\")\n\nind=0\nfor i in range(len(lst)):\n    if lst.index[i]=='85+':\n        print(\"% Dead of female for age group  {:s} is : {:.2f}%\".format('85+', 0))\n        continue\n    print(\"% Dead of female for age group  {:s} is : {:.2f}%\".format(lst2.index[ind], 100.0*lst2[ind]\/lst[i]))\n    ind+=1","113f9234":"df['age_log']=np.log(1+df['Age'])","275e8a94":"fig, ax=plt.subplots(facecolor='#f6f5f5', figsize=(9,5))\nsns.histplot(df, x=\"age_log\", hue=\"species\", ax=ax, element='poly')\nfig.suptitle('Distribution of train & test set of Age', fontsize=20)\nfig.show()","427cb18c":"fig, ax=plt.subplots(facecolor='#f6f5f5', figsize=(25,9))\nsns.histplot(df, x=\"Fare\", hue=\"species\", bins=25, ax=ax)\nax.set_xticks(range(0,750,25))\nfig.suptitle('Distribution of Fare in train & test set', fontsize=20)\nfig.show()","d3f4c198":"fig, ax=plt.subplots(nrows=2, ncols=2, facecolor='#f6f5f5', figsize=(30,25))\nsns.histplot(train,x=\"Fare\", ax=ax[0][0], bins=25, hue_order=labels)\nsns.histplot(train,x=\"Fare\",hue=\"Survived\", ax=ax[0][1], bins=25, hue_order=labels)\nsns.histplot(train[train[\"Sex\"]==\"male\"],x=\"Fare\",hue=\"Survived\",ax=ax[1][0], bins=25, hue_order=labels)\nsns.histplot(train[train[\"Sex\"]==\"female\"],x=\"Fare\",hue=\"Survived\",ax=ax[1][1], bins=25, hue_order=labels)\nax[0][0].set_title(\"Distribution of population\")\nax[0][1].set_title(\"Survival\")\nax[1][0].set_title(\"Survival of male\")\nax[1][1].set_title(\"Survival of female\")\nax[0][0].set_xticks(range(0,750,30))\nax[0][1].set_xticks(range(0,750,30))\nax[1][0].set_xticks(range(0,750,30))\nax[1][1].set_xticks(range(0,750,30))\nfig.suptitle('Distribution of population based on fare', fontsize=20)\nfig.show()","9709b6a3":"train['fare']=pd.qcut(train['Fare'], 3, labels=['low','med','high'])","82786c30":"pd.crosstab(train.Survived,train.fare,margins=True).style.background_gradient(cmap='summer_r')","a4173573":"(pd.crosstab(train.Survived,train.fare,normalize='columns',margins=True).round(4)*100).style.background_gradient(cmap='summer_r').set_precision(2)","af2e5ae9":"pd.crosstab([train.Sex, train.Survived],train.fare,margins=True).style.background_gradient(cmap='summer_r')","325094df":"(pd.crosstab([train[train['Sex']=='male'].Sex, train.Survived],train.fare,normalize='columns',margins=True).round(4)*100).style.background_gradient(cmap='summer_r').set_precision(2)","9e067293":"(pd.crosstab([train[train['Sex']=='female'].Sex, train.Survived],train.fare,normalize='columns',margins=True).round(4)*100).style.background_gradient(cmap='summer_r').set_precision(2)","e0701a09":"df['fare_log']=np.log(1+df['Fare'])","56a5de2d":"fig, ax=plt.subplots(facecolor='#f6f5f5', figsize=(9,5))\nsns.histplot(df, x=\"fare_log\", hue=\"species\", ax=ax, element='poly')\nfig.suptitle('Distribution of train & test set of Fare log', fontsize=20)\nfig.show()","fa1694cf":"train[\"related\"]=train['SibSp']+train['Parch']","52a2e2fb":"fig, ax=plt.subplots(facecolor='#f6f5f5', figsize=(9,5))\nsns.histplot(df, x=\"Pclass\", hue=\"species\", bins=5, ax=ax)\nfig.suptitle('Distribution of train & test set of Pclass', fontsize=20)\nfig.show()","815bb3f3":"fig, ax=plt.subplots(nrows=3, ncols=2, facecolor='#f6f5f5', figsize=(25, 20))\nax[0][0].pie(train.groupby(['Pclass'])['Pclass'].count(), explode=(0.1, 0.1, 0.1), labels=['Class 1','Class 2', 'Class 3'], autopct='%1.1f%%', shadow=True)\nsns.histplot(train,x=\"Pclass\", ax=ax[0][1], hue_order=labels)\nsns.histplot(train,x=\"Pclass\",hue=\"Survived\", ax=ax[1][0], hue_order=labels)\nsns.histplot(train[train[\"Sex\"]==\"male\"],x=\"Pclass\",hue=\"Survived\",ax=ax[2][0], hue_order=labels)\nsns.histplot(train[train[\"Sex\"]==\"female\"],x=\"Pclass\",hue=\"Survived\",ax=ax[2][1], hue_order=labels)\nax[0][0].set_title(\"Distribution of population\")\nax[0][1].set_title(\"Distribution of population\")\nax[1][0].set_title(\"Survival\")\nax[2][0].set_title(\"Survival of male\")\nax[2][1].set_title(\"Survival of female\")\nfig.suptitle('Distribution of population based on Pclass',fontsize=20)\nax[1][1].remove()\nfig.show()","d665332d":"pd.crosstab(train.Survived,train.Pclass,margins=True).style.background_gradient(cmap='summer_r')","4510c4a7":"(pd.crosstab(train.Survived,train.Pclass,normalize='columns',margins=True).round(4)*100).style.background_gradient(cmap='summer_r').set_precision(2)","28f6cff1":"pd.crosstab([train.Sex, train.Survived],train.Pclass,margins=True).style.background_gradient(cmap='summer_r')","d7e2fc1b":"(pd.crosstab([train[train['Sex']=='male'].Sex, train.Survived],train.Pclass,normalize='columns',margins=True).round(4)*100).style.background_gradient(cmap='summer_r').set_precision(2)","24296cac":"(pd.crosstab([train[train['Sex']=='female'].Sex, train.Survived],train.Pclass,normalize='columns',margins=True).round(4)*100).style.background_gradient(cmap='summer_r').set_precision(2)","34ffddab":"fig, ax=plt.subplots(facecolor='#f6f5f5', figsize=(9,5))\nsns.histplot(df, x=\"SibSp\", hue=\"species\", bins=5, ax=ax)\nfig.suptitle('Distribution of train & test set of Sibling\/Spouse', fontsize=20)\nfig.show()","c01b0895":"fig, ax=plt.subplots(nrows=3, ncols=2, facecolor='#f6f5f5', figsize=(18, 30))\nax[0][0].pie(train.groupby(['SibSp'])['SibSp'].count(), explode=(0.1,0.1,0.1,0.1,0.4,0.5,0.6), labels=['0', '1', '2', '3', '4', '5', '8'], autopct='%1.1f%%', shadow=False)\nsns.histplot(train,x=\"SibSp\", ax=ax[0][1], hue_order=labels)\nsns.histplot(train,x=\"SibSp\",hue=\"Survived\", ax=ax[1][0], hue_order=labels)\nsns.histplot(train[train[\"Sex\"]==\"male\"],x=\"SibSp\",hue=\"Survived\",ax=ax[2][0], hue_order=labels)\nsns.histplot(train[train[\"Sex\"]==\"female\"],x=\"SibSp\",hue=\"Survived\",ax=ax[2][1], hue_order=labels)\nax[0][0].set_title(\"Distribution of population\")\nax[0][1].set_title(\"Distribution of population\")\nax[1][0].set_title(\"Survival\")\nax[2][0].set_title(\"Survival of male\")\nax[2][1].set_title(\"Survival of female\")\nfig.suptitle('Distribution of population based on Sibling\/Spouse',fontsize=20)\nax[1][1].remove()\nfig.show()","480f7c99":"train['sibsp']=train['SibSp'].apply(lambda x:'low' if x<1 else 'high')\ndf['sibsp']=df['SibSp'].apply(lambda x:'low' if x<1 else 'high')","de6574a6":"fig, ax=plt.subplots(facecolor='#f6f5f5', figsize=(9,5))\nsns.histplot(df, x=\"sibsp\", hue=\"species\", ax=ax)\nfig.suptitle('Distribution of train & test set of Sibling\/Spouse', fontsize=20)\nfig.show()","6dd7c309":"fig, ax=plt.subplots(nrows=3, ncols=2, facecolor='#f6f5f5', figsize=(18, 15))\nax[0][0].pie(train.groupby(['sibsp'])['sibsp'].count(), explode=(0.1,0.1), labels=['low','high'], autopct='%1.1f%%', shadow=False)\nsns.histplot(train,x=\"sibsp\", ax=ax[0][1])\nsns.histplot(train,x=\"sibsp\",hue=\"Survived\", ax=ax[1][0], hue_order=labels)\nsns.histplot(train[train[\"Sex\"]==\"male\"],x=\"sibsp\",hue=\"Survived\",ax=ax[2][0], hue_order=labels)\nsns.histplot(train[train[\"Sex\"]==\"female\"],x=\"sibsp\",hue=\"Survived\",ax=ax[2][1], hue_order=labels)\nax[0][0].set_title(\"Distribution of population\")\nax[0][1].set_title(\"Distribution of population\")\nax[1][0].set_title(\"Survival\")\nax[2][0].set_title(\"Survival of male\")\nax[2][1].set_title(\"Survival of female\")\nfig.suptitle('Distribution of population based on Sibling\/Spouse',fontsize=20)\nax[1][1].remove()\nfig.show()","505714a6":"pd.crosstab(train.Survived,train.sibsp,margins=True)[['low','high']].style.background_gradient(cmap='summer_r')","808d73af":"(pd.crosstab(train.Survived,train.sibsp,normalize='columns',margins=True)*100)[['low','high']].style.background_gradient(cmap='summer_r').set_precision(2)","edfb8400":"pd.crosstab([train.Sex,train.Survived],train.sibsp,margins=True)[['low','high']].style.background_gradient(cmap='summer_r')","559fe4d6":"(pd.crosstab([train[train['Sex']=='male'].Sex,train.Survived],train.sibsp,normalize='columns',margins=True)*100)[['low','high']].style.background_gradient(cmap='summer_r').set_precision(2)","5d87dbfb":"(pd.crosstab([train[train['Sex']=='female'].Sex,train.Survived],train.sibsp,normalize='columns',margins=True)*100)[['low','high']].style.background_gradient(cmap='summer_r').set_precision(2)","49d97c59":"df['SibSp_log']=np.log(1+df['SibSp'])","12dfecf6":"fig, ax=plt.subplots(facecolor='#f6f5f5', figsize=(9,5))\nsns.histplot(df, x=\"SibSp_log\", hue=\"species\", ax=ax, element='poly')\nfig.suptitle('Distribution of train & test set of Fare log', fontsize=20)\nfig.show()","f6fd89ed":"fig, ax=plt.subplots(facecolor='#f6f5f5', figsize=(9,5))\nsns.histplot(df, x=\"Parch\", hue=\"species\", bins=5, ax=ax)\nfig.suptitle('Distribution of train & test set of Parent\/children', fontsize=20)\nfig.show()","e25864a7":"fig, ax=plt.subplots(nrows=3, ncols=2, facecolor='#f6f5f5', figsize=(18, 30))\nax[0][0].pie(train.groupby(['Parch'])['Parch'].count(), explode=(0.1,0.1,0.1,0.1,0.4,0.5,0.6,0.7), labels=['0', '1', '2', '3', '4', '5', '6', '9'], autopct='%1.1f%%', shadow=False)\nsns.histplot(train,x=\"Parch\", ax=ax[0][1], hue_order=labels)\nsns.histplot(train,x=\"Parch\",hue=\"Survived\", ax=ax[1][0], hue_order=labels)\nsns.histplot(train[train[\"Sex\"]==\"male\"],x=\"Parch\",hue=\"Survived\",ax=ax[2][0], hue_order=labels)\nsns.histplot(train[train[\"Sex\"]==\"female\"],x=\"Parch\",hue=\"Survived\",ax=ax[2][1], hue_order=labels)\nax[0][0].set_title(\"Distribution of population\")\nax[0][1].set_title(\"Distribution of population\")\nax[1][0].set_title(\"Survival\")\nax[2][0].set_title(\"Survival of male\")\nax[2][1].set_title(\"Survival of female\")\nfig.suptitle('Distribution of population based on Parent\/children',fontsize=20)\nax[1][1].remove()\nfig.show()","38c54f93":"train['parch']=train['Parch'].apply(lambda x:'low' if x<1 else 'high')\ndf['parch']=df['Parch'].apply(lambda x:'low' if x<1 else 'high')","0dff0165":"fig, ax=plt.subplots(facecolor='#f6f5f5', figsize=(9,5))\nsns.histplot(df, x=\"parch\", hue=\"species\", ax=ax)\nfig.suptitle('Distribution of train & test set of Parent\/children', fontsize=20)\nfig.show()","00b3b6de":"fig, ax=plt.subplots(nrows=3, ncols=2, facecolor='#f6f5f5', figsize=(18, 15))\nax[0][0].pie(train.groupby(['parch'])['parch'].count(), explode=(0.1,0.1), labels=['low','high'], autopct='%1.1f%%', shadow=False)\nsns.histplot(train,x=\"parch\", ax=ax[0][1])\nsns.histplot(train,x=\"parch\",hue=\"Survived\", ax=ax[1][0], hue_order=labels)\nsns.histplot(train[train[\"Sex\"]==\"male\"],x=\"parch\",hue=\"Survived\",ax=ax[2][0], hue_order=labels)\nsns.histplot(train[train[\"Sex\"]==\"female\"],x=\"parch\",hue=\"Survived\",ax=ax[2][1], hue_order=labels)\nax[0][0].set_title(\"Distribution of population\")\nax[0][1].set_title(\"Distribution of population\")\nax[1][0].set_title(\"Survival\")\nax[2][0].set_title(\"Survival of male\")\nax[2][1].set_title(\"Survival of female\")\nfig.suptitle('Distribution of population based on Parent\/children',fontsize=20)\nax[1][1].remove()\nfig.show()","0e033c36":"pd.crosstab(train.Survived,train.parch,margins=True)[['low','high']].style.background_gradient(cmap='summer_r')","d8bbf8f3":"(pd.crosstab(train.Survived,train.parch,normalize='columns',margins=True)*100)[['low','high']].style.background_gradient(cmap='summer_r').set_precision(2)","4c792ac1":"pd.crosstab([train.Sex,train.Survived],train.parch,margins=True)[['low','high']].style.background_gradient(cmap='summer_r')","229da5ff":"(pd.crosstab([train[train['Sex']=='male'].Sex,train.Survived],train.parch,normalize='columns',margins=True)*100)[['low','high']].style.background_gradient(cmap='summer_r').set_precision(2)","4ff3fbe6":"(pd.crosstab([train[train['Sex']=='female'].Sex,train.Survived],train.parch,normalize='columns',margins=True)*100)[['low','high']].style.background_gradient(cmap='summer_r').set_precision(2)","5f0b1838":"df['Parch_log']=np.log(1+df['Parch'])","11933f88":"fig, ax=plt.subplots(facecolor='#f6f5f5', figsize=(9,5))\nsns.histplot(df, x=\"Parch_log\", hue=\"species\", ax=ax, element='poly')\nfig.suptitle('Distribution of train & test set of Parent\/Children log', fontsize=20)\nfig.show()","3b43d846":"train[\"related\"]=train['SibSp']+train['Parch']\ndf[\"related\"]=df['SibSp']+df['Parch']","a9b6d345":"train['related']=train['related'].apply(lambda x:'low' if x<1 else 'high')\ndf['related']=df['related'].apply(lambda x:'low' if x<1 else 'high')","e97204b9":"fig, ax=plt.subplots(facecolor='#f6f5f5', figsize=(9,5))\nsns.histplot(df, x=\"related\", hue=\"species\", ax=ax)\nfig.suptitle('Distribution of train & test set of Relation', fontsize=20)\nfig.show()","99adc759":"fig, ax=plt.subplots(nrows=3, ncols=2, facecolor='#f6f5f5', figsize=(18, 30))\nax[0][0].pie(train.groupby(['related'])['related'].count(), explode=(0.1,0.1), labels=['high','low'], autopct='%1.1f%%', shadow=False)\nsns.histplot(train,x=\"related\", ax=ax[0][1], hue_order=labels)\nsns.histplot(train,x=\"related\",hue=\"Survived\", ax=ax[1][0], hue_order=labels)\nsns.histplot(train[train[\"Sex\"]==\"male\"],x=\"related\",hue=\"Survived\",ax=ax[2][0], hue_order=labels)\nsns.histplot(train[train[\"Sex\"]==\"female\"],x=\"related\",hue=\"Survived\",ax=ax[2][1], hue_order=labels)\nax[0][0].set_title(\"Distribution of population\")\nax[0][1].set_title(\"Distribution of population\")\nax[1][0].set_title(\"Survival\")\nax[2][0].set_title(\"Survival of male\")\nax[2][1].set_title(\"Survival of female\")\nfig.suptitle('Distribution of population based on Relation',fontsize=20)\nax[1][1].remove()\nfig.show()","f5ae551c":"pd.crosstab(train.Survived,train.related,margins=True)[['low','high']].style.background_gradient(cmap='summer_r')","6b777a9c":"(pd.crosstab(train.Survived,train.related,normalize='columns',margins=True)[['low','high']]*100).style.background_gradient(cmap='summer_r').set_precision(2)","7ed1b607":"pd.crosstab([train.Sex,train.Survived],train.related,margins=True)[['low','high']].style.background_gradient(cmap='summer_r')","65585daf":"(pd.crosstab([train[train['Sex']=='male'].Sex,train.Survived],train.related,normalize='columns',margins=True)[['low','high']]*100).style.background_gradient(cmap='summer_r').set_precision(2)","8704a17a":"(pd.crosstab([train[train['Sex']=='female'].Sex,train.Survived],train.related,normalize='columns',margins=True)[['low','high']]*100).style.background_gradient(cmap='summer_r').set_precision(2)","5b62a3b3":"df['related_log']=np.log(1+train['SibSp']+train['Parch'])","0bdbbe68":"fig, ax=plt.subplots(facecolor='#f6f5f5', figsize=(9,5))\nsns.histplot(df, x=\"related_log\", hue=\"species\", ax=ax)\nfig.suptitle('Distribution of train & test set of Relation log', fontsize=20)\nfig.show()","9acee28f":"fig, ax=plt.subplots(facecolor='#f6f5f5', figsize=(9,5))\nsns.histplot(df, x=\"Embarked\", hue=\"species\", ax=ax)\nfig.suptitle('Distribution of train & test set of Embarked', fontsize=20)\nfig.show()","14fccf83":"fig, ax=plt.subplots(nrows=3, ncols=2, facecolor='#f6f5f5', figsize=(18, 30))\nax[0][0].pie(train.groupby(['Embarked'])['Embarked'].count(), explode=(0.1,0.1,0.1), labels=['C','Q','S'], autopct='%1.1f%%', shadow=False)\nsns.histplot(train,x=\"Embarked\", ax=ax[0][1])\nsns.histplot(train,x=\"Embarked\",hue=\"Survived\", ax=ax[1][0], hue_order=labels)\nsns.histplot(train[train[\"Sex\"]==\"male\"],x=\"Embarked\",hue=\"Survived\",ax=ax[2][0], hue_order=labels)\nsns.histplot(train[train[\"Sex\"]==\"female\"],x=\"Embarked\",hue=\"Survived\",ax=ax[2][1], hue_order=labels)\nax[0][0].set_title(\"Distribution of population\")\nax[0][1].set_title(\"Distribution of population\")\nax[1][0].set_title(\"Survival\")\nax[2][0].set_title(\"Survival of male\")\nax[2][1].set_title(\"Survival of female\")\nfig.suptitle('Distribution of population based on Embarked',fontsize=20)\nax[1][1].remove()\nfig.show()","f230a4e6":"pd.crosstab(train.Survived,train.Embarked,margins=True)[['S','C','Q']].style.background_gradient(cmap='summer_r')","d510a78b":"(pd.crosstab(train.Survived,train.Embarked,normalize='columns',margins=True)[['S','C','Q']]*100).style.background_gradient(cmap='summer_r').set_precision(2)","d979db8f":"pd.crosstab([train.Sex,train.Survived],train.Embarked,margins=True)[['S','C','Q']].style.background_gradient(cmap='summer_r')","270bdf86":"(pd.crosstab([train[train['Sex']=='male'].Sex,train.Survived],train.Embarked,normalize='columns',margins=True)[['S','C','Q']]*100).style.background_gradient(cmap='summer_r').set_precision(2)","6e4504aa":"(pd.crosstab([train[train['Sex']=='female'].Sex,train.Survived],train.Embarked,normalize='columns',margins=True)[['S','C','Q']]*100).style.background_gradient(cmap='summer_r').set_precision(2)","5a3f3031":"print('Initials present in train set:\\n',train.Name.str.extract('([A-Za-z]+)\\.').value_counts())","16445cb3":"print('Initials present in test set:\\n',test.Name.str.extract('([A-Za-z]+)\\.').value_counts())","bf4f497e":"len(train['Name'].str.split().str[0].unique())","2fb2cb62":"len(test['Name'].str.split().str[0].unique())","5cf69df7":"fig, ax=plt.subplots(facecolor='#f6f5f5', figsize=(9,5))\nsns.histplot(df, x=\"Cabin\", hue=\"species\", ax=ax)\nfig.suptitle(\"Distribution of Cabin in train & test set\")\nfig.show()","1d271b26":"fig, ax=plt.subplots(nrows=3, ncols=2, facecolor='#f6f5f5', figsize=(18, 30))\nax[0][0].pie(train.groupby(['Cabin'])['Cabin'].count(), autopct='%1.1f%%', shadow=False)\nsns.histplot(train,x=\"Cabin\", ax=ax[0][1], hue_order=labels)\nsns.histplot(train,x=\"Cabin\", hue=\"Survived\", ax=ax[1][0], hue_order=labels)\nsns.histplot(train[train[\"Sex\"]==\"male\"],x=\"Cabin\",hue=\"Survived\",ax=ax[2][0], hue_order=labels)\nsns.histplot(train[train[\"Sex\"]==\"female\"],x=\"Cabin\",hue=\"Survived\",ax=ax[2][1], hue_order=labels)\nax[0][0].set_title(\"Distribution of population\")\nax[0][1].set_title(\"Distribution of population\")\nax[1][0].set_title(\"Survival\")\nax[2][0].set_title(\"Survival of male\")\nax[2][1].set_title(\"Survival of female\")\nfig.suptitle('Distribution of population based on Cabin',fontsize=20)\nax[1][1].remove()\nfig.show()","f562c723":"pd.crosstab(train.Survived,train.Cabin,margins=True)[['A', 'B', 'C', 'D', 'E', 'F', 'G', 'T', 'X','All']].style.background_gradient(cmap='summer_r')","b15f5450":"(pd.crosstab(train.Survived,train.Cabin,margins=True, normalize='columns')[['A', 'B', 'C', 'D', 'E', 'F', 'G', 'T', 'X', 'All']]*100).style.background_gradient(cmap='summer_r').set_precision(2)","9d77c4e9":"pd.crosstab([train.Sex,train.Survived],train.Cabin,margins=True)[['A', 'B', 'C', 'D', 'E', 'F', 'G', 'T', 'X', 'All']].style.background_gradient(cmap='summer_r')","0e8d1953":"(pd.crosstab([train[train.Sex==\"male\"].Sex,train.Survived],train.Cabin,margins=True,normalize=\"columns\")[['A', 'B', 'C', 'D', 'E', 'F', 'G', 'T', 'X', 'All']]*100).style.background_gradient(cmap='summer_r').set_precision(2)","e9650f39":"(pd.crosstab([train[train.Sex==\"female\"].Sex,train.Survived],train.Cabin,margins=True,normalize=\"columns\")[['A', 'B', 'C', 'D', 'E', 'F', 'G', 'T', 'X', 'All']]*100).style.background_gradient(cmap='summer_r').set_precision(2)","f9c46b8f":"fig, ax=plt.subplots(facecolor='#f6f5f5', figsize=(9,5))\nsns.histplot(df, x=\"Sex\", hue=\"species\", ax=ax)\nfig.suptitle('Distribution of train & test set of Gender', fontsize=20)\nfig.show()","a8f1c1c5":"fig, ax=plt.subplots(nrows=3, ncols=2, facecolor='#f6f5f5', figsize=(18, 30))\nax[0][0].pie(train.groupby(['Sex'])['Sex'].count(), explode=(0.1,0.1), labels=['female','male'], autopct='%1.1f%%', shadow=False)\nsns.histplot(train,x=\"Sex\", ax=ax[0][1])\nsns.histplot(train,x=\"Sex\",hue=\"Survived\", ax=ax[1][0], hue_order=labels)\nsns.histplot(train[train[\"Sex\"]==\"male\"],x=\"Sex\",hue=\"Survived\",ax=ax[2][0], hue_order=labels)\nsns.histplot(train[train[\"Sex\"]==\"female\"],x=\"Sex\",hue=\"Survived\",ax=ax[2][1], hue_order=labels)\nax[0][0].set_title(\"Distribution of population\")\nax[0][1].set_title(\"Distribution of population\")\nax[1][0].set_title(\"Survival\")\nax[2][0].set_title(\"Survival of male\")\nax[2][1].set_title(\"Survival of female\")\nfig.suptitle('Distribution of population based on Gender',fontsize=20)\nax[1][1].remove()\nfig.show()","419d264c":"pd.crosstab(train.Survived,train.Sex,margins=True).style.background_gradient(cmap='summer_r')","e5a20f97":"(pd.crosstab(train.Survived,train.Sex,normalize='columns',margins=True)*100).style.background_gradient(cmap='summer_r').set_precision(2)","70f3d92e":"from sklearn.preprocessing import StandardScaler, OneHotEncoder","bea2abec":"train=pd.read_csv('..\/input\/tabular-playground-series-apr-2021\/train.csv')\ntest=pd.read_csv('..\/input\/tabular-playground-series-apr-2021\/test.csv')","96655085":"print(\"Median age of male and female in train:\\n\", train.groupby(['Sex'])['Age'].median().round(2))\nprint(\"\\nMedian age of male and female in test:\\n\", test.groupby(['Sex'])['Age'].median().round(2))","790ddf24":"train.loc[(train.Age.isnull())&(train.Sex=='male'),'Age']=36.0\ntrain.loc[(train.Age.isnull())&(train.Sex=='female'),'Age']=42.0\n\ntest.loc[(test.Age.isnull())&(test.Sex=='male'),'Age']=27.0\ntest.loc[(test.Age.isnull())&(test.Sex=='female'),'Age']=25.0\n\ntrain['Age_log']=np.log(1+train['Age'])\ntest['Age_log']=np.log(1+test['Age'])","9d5eb6c5":"print(train['Age'].isnull().any())\nprint(test['Age'].isnull().any())","d3517f38":"print(\"Median age of male and female in train:\\n\", train.groupby(['Sex'])['Fare'].median().round(2))\nprint(\"\\nMedian age of male and female in test:\\n\", test.groupby(['Sex'])['Fare'].median().round(2))","dea749a3":"train.loc[(train.Fare.isnull())&(train.Sex=='male'),'Fare']=13.58\ntrain.loc[(train.Fare.isnull())&(train.Sex=='female'),'Fare']=28.32\n\ntest.loc[(test.Fare.isnull())&(test.Sex=='male'),'Fare']=12.96\ntest.loc[(test.Fare.isnull())&(test.Sex=='female'),'Fare']=28.14\n\ntrain['Fare_log']=np.log(1+train['Fare'])\ntest['Fare_log']=np.log(1+test['Fare'])","5f7a3b8a":"print(train['Fare'].isnull().any())\nprint(test['Fare'].isnull().any())","86cd372d":"train['Embarked'].fillna('X', inplace=True)\ntest['Embarked'].fillna('X', inplace=True)","6d9760b3":"print(train['Embarked'].isnull().any())\nprint(test['Embarked'].isnull().any())","fc5d755e":"train['Cabin'].fillna('X', inplace=True)\ntest['Cabin'].fillna('X', inplace=True)\n\ntrain['Cabin']=[list(word)[0] for word in train['Cabin'].values]\ntest['Cabin']=[list(word)[0] for word in test['Cabin'].values]","fce4d0af":"print(train['Cabin'].isnull().any())\nprint(test['Cabin'].isnull().any())","58aac923":"print(train.isnull().isnull().sum())\nprint('\\n')\nprint(test.isnull().isnull().sum())","4c50f784":"train['Fare_cat']=pd.qcut(train['Fare'], 3, labels=['low','med','high'])\ntest['Fare_cat']=pd.qcut(test['Fare'], 3, labels=['low','med','high'])\n\ntrain['Pclass']=train['Pclass'].apply(lambda x:1 if x in [3] else 2 if x in [2] else 3)\ntest['Pclass']=test['Pclass'].apply(lambda x:1 if x in [3] else 2 if x in [2] else 3)\n\ntrain['SibSp']=train['SibSp']+1\ntest['SibSp']=test['SibSp']+1\n\ntrain['Parch']=train['Parch']+1\ntest['Parch']=test['Parch']+1\n\ntrain['related']=train['SibSp']+train['Parch']\ntest['related']=test['SibSp']+test['Parch']\n\n\ntrain['related_log']=np.log(1+train['related'])\ntest['related_log']=np.log(1+test['related'])\n\n\ntrain['SibSp_log']=np.log(1+train['SibSp'])\ntest['SibSp_log']=np.log(1+test['SibSp'])\n\ntrain['Parch_log']=np.log(1+train['Parch'])\ntest['Parch_log']=np.log(1+test['Parch'])\n\ntrain['related_cat']=train['related'].apply(lambda x:'low' if x<1 else 'high')\ntest['related_cat']=test['related'].apply(lambda x:'low' if x<1 else 'high')\n\ntrain['Cabin']=train['Cabin'].apply(lambda x:'E' if x in ['F','G'] else x)\ntrain['Cabin']=train['Cabin'].apply(lambda x:'C' if x in ['D'] else x)\ntrain['Cabin']=train['Cabin'].apply(lambda x:'X' if x in ['T'] else x)\ntest['Cabin']=test['Cabin'].apply(lambda x:'E' if x in ['F','G'] else x)\ntest['Cabin']=test['Cabin'].apply(lambda x:'C' if x in ['D'] else x)\ntest['Cabin']=test['Cabin'].apply(lambda x:'X' if x in ['T'] else x)","ddf358f4":"print(train.isnull().isnull().sum())\nprint('\\n')\nprint(test.isnull().isnull().sum())","75f0bdca":"fig, ax = plt.subplots(ncols=2, facecolor='#f6f5f5', figsize=(24, 14))\ncols=['Age','Age_log','Fare','Fare_log','SibSp','SibSp_log','Parch','Parch_log','related','related_log']\ndcorr=train[cols].corr('pearson')\ntcorr=test[cols].corr('pearson')\nmask = np.triu(np.ones_like(dcorr, dtype=np.bool))\n\nsns.heatmap(dcorr, mask=mask, ax=ax[0], annot=True, fmt=\".2f\", cmap='coolwarm')\nsns.heatmap(tcorr, mask=mask, ax=ax[1], annot=True, fmt=\".2f\", cmap='coolwarm')\nax[0].set_title('Correlation of train set')\nax[1].set_title('Correlation of test set')\nfig.suptitle('Correlation Matrix', fontsize=20)\nfig.show()","21d56a1a":"background_color = \"#f6f5f5\"\ncols=['Age','Age_log','Fare','Fare_log','SibSp','SibSp_log','Parch','Parch_log','related','related_log']\nfig = plt.figure(figsize=(12, 8), facecolor=background_color)\ngs = fig.add_gridspec(1, 1)\nax0 = fig.add_subplot(gs[0, 0])\n\nax0.set_facecolor(background_color)\nax0.text(-1.1, 0.26, 'Correlation of Continuous Features with Target', fontsize=20, fontweight='bold', fontfamily='serif')\nax0.text(-1.1, 0.24, 'There is no features that pass 0.261 correlation with target', fontsize=13, fontweight='light', fontfamily='serif')\n\nchart_df = pd.DataFrame(train[cols].corrwith(train['Survived']))\nchart_df.columns = ['corr']\nsns.barplot(x=chart_df.index, y=chart_df['corr'], ax=ax0, color='RoyalBlue', zorder=3, edgecolor='black', linewidth=1.5)\nax0.grid(which='major', axis='y', zorder=0, color='gray', linestyle=':', dashes=(1,5))\nax0.set_ylabel('')\n\nfor s in [\"top\",\"right\", 'left']:\n    ax0.spines[s].set_visible(False)\n\nplt.show()","a4587ad5":"train.head()","c3a97221":"test.head()","ae80dd04":"train.to_csv('.\/train.csv',index=False)\ntest.to_csv('.\/test.csv',index=False)","5eb17af7":"# train3=train.copy()\n# test3=test.copy()\n# train3.to_csv('.\/train3.csv',index=False)\n# test3.to_csv('.\/test3.csv',index=False)","633ce226":"# train1=train.copy()\n# test1=test.copy()\n# train1.to_csv('.\/train1.csv',index=False)\n# test1.to_csv('.\/test1.csv',index=False)","e2b78ff9":"# sc=StandardScaler()\n# sc.fit(train['Age'].values.reshape(-1, 1))\n# train['Age']=sc.transform(train['Age'].values.reshape(-1, 1))\n# test['Age']=sc.transform(test['Age'].values.reshape(-1, 1))","ed408c3f":"# train['Fare']=train['Fare'].apply(lambda x:1.0 if x is 'low' else 2.0 if x is 'med' else 3.0)\n# test['Fare']=test['Fare'].apply(lambda x:1.0 if x is 'low' else 2.0 if x is 'med' else 3.0)\n\n\n# train['related']=train['related'].apply(lambda x:1.0 if x is 'low' else 2.0)\n# test['related']=test['related'].apply(lambda x:1.0 if x is 'low' else 2.0)","2d3ff398":"# ohe=OneHotEncoder()\n# col=['Sex','Embarked']\n# ohe.fit(train[col])\n# df1=pd.DataFrame(columns=ohe.get_feature_names(col),data=ohe.transform(train[col]).toarray())\n# df2=pd.DataFrame(columns=ohe.get_feature_names(col),data=ohe.transform(test[col]).toarray())","fdd0cd6c":"# df1.head()","d1e17149":"# df2.head()","8341db94":"# train=train.join(df1)\n# test=test.join(df2)","8d58dd42":"# train.head()","ee6e2bf2":"# test.head()","3844e9ee":"# train2=train.copy()\n# test2=test.copy()\n# train2.to_csv('.\/train2.csv',index=False)\n# test2.to_csv('.\/test2.csv',index=False)","cef9faa4":"# train.drop(columns=['PassengerId','Name','Cabin','Ticket','SibSp','Parch','Embarked','Sex'], inplace=True)\n# test.drop(columns=['PassengerId','Name','Cabin','Ticket','SibSp','Parch','Embarked','Sex'], inplace=True)","c8d3cd16":"# train=train.astype(float)\n# test=test.astype(float)","01c64905":"# train.head()","3e9137a0":"test.head()","d23fd80b":"from sklearn.model_selection import StratifiedKFold, train_test_split\nfrom catboost import CatBoostClassifier\nfrom xgboost import XGBClassifier\nfrom lightgbm import LGBMClassifier\nfrom sklearn.ensemble import VotingClassifier\nfrom sklearn.metrics import roc_auc_score","8aca4883":"features=train.columns[1:]\nX = train[features]\ny = train['Survived']\nx_train, x_test, y_train, y_test = train_test_split(X, y, test_size=0.20, random_state=39)","b0b4f437":"len(x_train), len(y_train), len(x_test), len(y_test)","3da46d5e":"folds=10\nkf=StratifiedKFold(n_splits=folds, random_state=57, shuffle=True)\nscore=pd.DataFrame()","6256cf88":"xgb_test_preds = np.zeros(len(x_test), )\nxgb_TEST_preds = np.zeros(len(test), )\nfor fold, (train_ind, val_ind) in enumerate(kf.split(x_train, y_train)):\n    print(\"--> Fold {}\".format(fold + 1))\n    xtrain, xval = x_train.iloc[train_ind], x_train.iloc[val_ind]\n    ytrain, yval = y_train.iloc[train_ind], y_train.iloc[val_ind]\n    xgb = XGBClassifier(eval_metric=\"auc\", gpu_id=0)\n    \n    model =  xgb.fit(xtrain, ytrain, eval_set=[(xval, yval)], early_stopping_rounds=50, verbose=True)\n    pred_train = model.predict_proba(xtrain)[:,1]\n    pred_val = model.predict_proba(xval)[:,1]\n    pred_test = model.predict_proba(x_test)[:,1]\n    pred_TEST = model.predict_proba(test)[:,1]\n    xgb_test_preds+= pred_test\/folds\n    xgb_TEST_preds+= pred_TEST\/folds\n    score1 = roc_auc_score(ytrain, pred_train)\n    score2 = roc_auc_score(yval, pred_val)\n    score3 = roc_auc_score(y_test, pred_test)\n    print('Fold {} AUC Train: {} Validation: {} Test: {}'.format(fold+1, score1, score2, score3))\n    \nprint('OOF AUC: {}'.format(roc_auc_score(y_test, xgb_test_preds)))\n# average_score['xgboost'] = xgb_test_preds\nscore['xgboost'] = xgb_TEST_preds","7940a2f3":"cat_test_preds = np.zeros(len(x_test), )\ncat_TEST_preds = np.zeros(len(test), )\nfor fold, (train_ind, val_ind) in enumerate(kf.split(x_train, y_train)):\n    print(\"--> Fold {}\".format(fold + 1))\n    xtrain, xval = x_train.iloc[train_ind], x_train.iloc[val_ind]\n    ytrain, yval = y_train.iloc[train_ind], y_train.iloc[val_ind]\n    cat = CatBoostClassifier(eval_metric=\"auc\",task_type=\"GPU\",devices=\"0\")\n                                \n    model =  xgb.fit(xtrain, ytrain, eval_set=[(xval, yval)], early_stopping_rounds=50, verbose=True)\n    pred_train = model.predict_proba(xtrain)[:,1]\n    pred_val = model.predict_proba(xval)[:,1]\n    pred_test = model.predict_proba(x_test)[:,1]\n    pred_TEST = model.predict_proba(test)[:,1]\n    cat_test_preds+= pred_test\/folds\n    cat_TEST_preds+= pred_TEST\/folds\n    score1 = roc_auc_score(ytrain, pred_train)\n    score2 = roc_auc_score(yval, pred_val)\n    score3 = roc_auc_score(y_test, pred_test)\n    print('Fold {} AUC Train: {} Validation: {} Test: {}'.format(fold+1, score1, score2, score3))\n    \nprint('OOF AUC: {}'.format(roc_auc_score(y_test, cat_test_preds)))\n# average_score['catboost'] = cat_test_preds\nscore['catboost'] = cat_TEST_preds","3473af31":"lgbm_test_preds = np.zeros(len(x_test), )\nlgbm_TEST_preds = np.zeros(len(test), )\nfor fold, (train_ind, val_ind) in enumerate(kf.split(x_train, y_train)):\n    print(\"--> Fold {}\".format(fold + 1))\n    xtrain, xval = x_train.iloc[train_ind], x_train.iloc[val_ind]\n    ytrain, yval = y_train.iloc[train_ind], y_train.iloc[val_ind]\n    lgbm = LGBMClassifier(random_state=2021,n_jobs=-1)\n    model =  lgbm.fit(xtrain, ytrain, eval_set=[(xval, yval)], eval_metric=\"auc\",verbose=True)\n    pred_train = model.predict_proba(xtrain)[:,1]\n    pred_val = model.predict_proba(xval)[:,1]\n    pred_test = model.predict_proba(x_test)[:,1]\n    pred_TEST = model.predict_proba(test)[:,1]\n    lgbm_test_preds+= pred_test\/folds\n    lgbm_TEST_preds+= pred_TEST\/folds\n    score1 = roc_auc_score(ytrain, pred_train)\n    score2 = roc_auc_score(yval, pred_val)\n    score3 = roc_auc_score(y_test, pred_test)\n    print('Fold {} AUC Train: {} Validation: {} Test: {}'.format(fold+1, score1, score2, score3))\n    \nprint('OOF AUC: {}'.format(roc_auc_score(y_test, lgbm_test_preds)))\n# average_score['lgbm'] = lgbm_test_preds\nscore['lgbm'] = lgbm_TEST_preds","8508469f":"test_=pd.read_csv('..\/input\/tabular-playground-series-apr-2021\/test.csv')","8caa04ae":"df=pd.DataFrame()\ndf['PassengerId']=test_['PassengerId'].values\ndf['Survived']=score['xgboost']\ndf['Survived']=df['Survived'].apply(lambda x:1 if x>=0.5 else 0)\ndf.to_csv('.\/xgboost_basemodel.csv',index=False)","6d01975b":"df=pd.DataFrame()\ndf['PassengerId']=test_['PassengerId'].values\ndf['Survived']=score['catboost']\ndf['Survived']=df['Survived'].apply(lambda x:1 if x>=0.5 else 0)\ndf.to_csv('.\/catboost_basemodel.csv',index=False)","7dbf41f4":"df=pd.DataFrame()\ndf['PassengerId']=test_['PassengerId'].values\ndf['Survived']=score['lgbm']\ndf['Survived']=df['Survived'].apply(lambda x:1 if x>=0.5 else 0)\ndf.to_csv('.\/lgbm_basemodel.csv',index=False)","be39efdd":"score['majorityvote']=.4*score['xgboost']+0.4*score['catboost']+0.2*score['lgbm']\ndf=pd.DataFrame()\ndf['PassengerId']=test_['PassengerId'].values\ndf['Survived']=score['majorityvote']\ndf['Survived']=df['Survived'].apply(lambda x:1 if x>=0.5 else 0)\ndf.to_csv('.\/majorityvote_basemodel.csv',index=False)","3ea0727d":"<span style='background:orange; font-size:150%'>**Cabin**<\/span>","c9421da3":"<h3 style=\"background-color:azure; text-align:center; font-size:200%\">2.2. Continuous variable<\/h3>","d07fdb21":"<span style='background:orange; font-size:150%'>**Related**<\/span>","ba055180":"<span style='background:orange; font-size:150%'>**Embarkation**<\/span>","4676fba7":"<h3 style=\"background-color:azure; text-align:center; font-size:200%\">2.1. Target variable<\/h3>","71e2d61c":"<span style='background:#5CB3FF; font-size:150%'>**Observations**<\/span>\n* Train\n    * Age- min: 0.08 and max: 87\n    * Sibling\/spouse- min : 0 and max: 8\n    * Parent\/children- min : 0 and max: 9\n    * Fare- min: 0.68 and max: 744.66\n* Test\n    * Age- min: 0.08 and max: 80\n    * Sibling\/spouse- min : 0 and max: 8\n    * Parent\/children- min : 0 and max: 9\n    * Fare- min: 0.05 and max: 680.70\n* Distribution of age in train & test set is different.\n* Train set has most people between 25 to 65 age group.\n* Test set has most people between 15 to 40 age group.\n* Survival of 30+ female and 10-15 year female is most among females.\n* Survival of 30+ male and 0-5 year male child is most among male.\n* Survival of female > 50% for all age groups.\n* Survival of male < 30% for all age groups.\n* Distribution of fare in train & test set is alike.\n* Fare has outliers so for better understanding we break fare into thre categories- low price, med price & high price or do log transformation.\n* Higher the fare higher is the chance of survival. \n* Fare increases with increase in family size.","d8a70fa6":"<span style='background:orange; font-size:150%'>**Sibling\/Spouse**<\/span>","17175804":"<h2 style=\"background-color:azure; text-align:center; font-size:300%\">4. Base Model<\/h2>","f55bf2a0":"<span style='background:orange; font-size:150%'>**Fare**<\/span>","4505cf9f":"<h3 style=\"background-color:azure; text-align:center; font-size:200%\">2.3. Categorical variable<\/h3>","f8ca6ce3":"<span style='background:#5CB3FF; font-size:150%'>**Observations**<\/span>\n* Train\n    * Shape: 100000 x 12\n    * Dtypes: float64(2), int64(5), object(5), memory usage: 9.2+ MB\n    * Nan rows: 76165\n    * Sibsp, Parch, Pclass are ordinal variables.\n    * Embarked, sex, name are nominal vairables.\n    * Fare, age are numberical variables.\n    * Cabin has most number of Nan values: 67866\n    * Survived is our target variable with values 0(No) & 1(Yes).\n* Test\n    * Shape: 100000 x 11\n    * Dtypes: float64(2), int64(4), object(5) memory usage: 8.4+ MB\n    * Nan rows: 79909\n    * Sibsp, Parch, Pclass are ordinal variables.\n    * Embarked, sex, name are nominal vairables.\n    * Fare, age are numberical variables.\n    * Cabin has most number of Nan values: 70831\n* Train & test set has same categories for Sibsp & Parch resp.\n","a6bbfd2f":"<span style='background:orange; font-size:150%'>**Pclass**<\/span>","fca87931":"<h2 style=\"background-color:azure; text-align:center; font-size:300%\">3. Feature Engineering<\/h2>","a3978c2a":"<span style='background:orange; font-size:150%'>**Name**<\/span>","95429322":"<span style='background:#5CB3FF; font-size:150%'>**Observations**<\/span>\n* Distribution of Pclass in train & test set is different.\n* Survival of people is based on the standard Pclass_1 > Pclass_2 > Pclass_3.\n* Distribution of SibSp in train & test set is similar.\n* SibSp has skewed distribution so we break it into low & high categories to handle the outliers.\n* With increase in SibSp survival ratio is reducing for female and increasing for male.\n* Distribution of Parch in train & test set is similar.\n* Parch has skewed distribution so we break it into low & high categories to handle the outliers.\n* With increase in Parch survival ratio is reducing for female and increasing for male.\n* Since information in SibSp and Parch is similar we take it into related to get total number of relations.\n* Distribution of Related in train & test set is similar.\n* Related has skewed distribution so we break it into low & high categories to handle the outliers.\n* With increase in relations survival ratio is reducing for female and increasing for male.\n* Distribution of Embarked in train & test set is different.\n* Survival of people is based on the port of embarkation C > Q > S.\n* No initials present in the Name so this column will be useless for us.\n* Distribution of Gender in train & test set is different.\n* Survival of female is 71.36% among females.\n* Survival of male is 20.22% among females.\n* Overall female is the first choice of survival.","7a2c6bd7":"<span style='background:orange; font-size:150%'>**Age**<\/span>","56b5b1e5":"<h1 style=\"background-color:azure; text-align:center; font-size:300%\">1. Loading Data...<\/h1>","96364d05":"<span style='background:orange; font-size:150%'>**Gender**<\/span>","5b25f8a3":"<span style='background:Orange; font-size:150%'>**Parent\/children**<\/span>","df367dca":"<span style='background:#5CB3FF; font-size:150%'>**Observations**<\/span>\n* 42.8% of total people were saved.","51d26c54":"<h2 style=\"background-color:azure; text-align:center; font-size:300%\">2. Exploratory Data Analysis<\/h2>"}}