{"cell_type":{"e7d03f66":"code","da348149":"code","82015228":"code","3bb5a7a7":"code","1869d097":"code","1f58f70c":"code","54972ec0":"code","59b9e8f8":"code","52c4e931":"code","65a84c6a":"code","f076ce0b":"code","80976d24":"code","560124d1":"code","9a49ce21":"code","cc32ac57":"code","58054ca7":"code","c9b900ba":"code","c1fdd094":"code","c96d56ad":"code","0d67da01":"code","0926b6a4":"code","f0a0c543":"code","c6b0899c":"code","e9883e2a":"code","c2d21bb8":"code","a541f7d9":"code","d019bad2":"code","a9bbeef5":"code","b5e0b7b4":"code","f4013a91":"code","88c328fe":"code","70cc8e4f":"code","97d5317a":"code","2089c5e8":"code","23365d60":"code","9971ac89":"code","72857232":"code","fdeba3dd":"code","a244e20e":"code","f7a5f717":"code","04537d21":"code","7d0ec20b":"code","c9416de0":"code","b0b7bad9":"code","30868d28":"code","9ea37cb9":"code","5e79e27a":"code","9e6894c6":"code","0c6e1f8c":"code","2094feda":"code","0607ea52":"code","e6bd9c84":"code","161ea267":"code","8014d020":"code","14952a98":"code","9bd70093":"code","d10b588d":"code","d8a22142":"code","aede7920":"code","6eb0c863":"code","e92aac36":"code","e9162e08":"code","06fce2aa":"code","70091bee":"code","3f2e1ecf":"code","e5c7b0ef":"code","ec8f276b":"code","71e3f5b9":"code","367a7d03":"code","096d0d98":"code","5b0318f6":"code","01c95a44":"code","6bc79318":"code","d24fdeeb":"code","c11c8b05":"code","4b504eb3":"code","9368a272":"code","0841f97a":"code","0a4b9ef0":"markdown","4698244e":"markdown","7d74ab52":"markdown","cc23c02d":"markdown","f08289e0":"markdown","7a385923":"markdown","1a7a23c4":"markdown","8e984af5":"markdown","9299e568":"markdown","700364c3":"markdown","2488a65d":"markdown","6bc69e7f":"markdown","83e0f4bb":"markdown","ece4af97":"markdown","90f69b85":"markdown"},"source":{"e7d03f66":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom warnings import  filterwarnings\nfilterwarnings('ignore',category=FutureWarning)","da348149":"Data=pd.read_csv('..\/input\/telecom-users-dataset\/telecom_users.csv').drop(columns=['Unnamed: 0','customerID'])","82015228":"Data.head()","3bb5a7a7":"Data.info()","1869d097":"Data.isnull().sum()","1f58f70c":"Data['TotalCharges'][Data['TotalCharges']==' ']","54972ec0":"Data=Data.drop(Data['TotalCharges'][Data['TotalCharges']==' '].index) ","59b9e8f8":"Data['TotalCharges']=Data['TotalCharges'].astype(float)","52c4e931":"Data.info()","65a84c6a":"Data.describe().transpose()","f076ce0b":"Data.select_dtypes(include='object').columns ","80976d24":"fig, axs = plt.subplots(nrows=4,ncols=4,figsize=(20,10))\nfig.tight_layout()\na=0\nb=0\nfor i in Data.select_dtypes(include='object').columns+'':\n  while a<len(Data.select_dtypes(include='object').columns):\n    sns.countplot(Data[f'{i}'],ax=axs[a,b])\n    b+=1\n    if b==4:\n      a+=1\n      b=0\n    break","560124d1":"sns.countplot(Data['SeniorCitizen']);","9a49ce21":"from sklearn.preprocessing import LabelEncoder\nobje_le=LabelEncoder()\n\nData['gender']=obje_le.fit_transform(Data['gender'])\nData['Partner']=obje_le.fit_transform(Data['Partner'])\nData['Dependents']=obje_le.fit_transform(Data['Dependents'])\nData['PhoneService']=obje_le.fit_transform(Data['PhoneService'])\nData['PaperlessBilling']=obje_le.fit_transform(Data['PaperlessBilling'])\nData['Churn']=obje_le.fit_transform(Data['Churn'])","cc32ac57":"Data.head()","58054ca7":"data_MultipleLines_dummies=pd.get_dummies(Data['MultipleLines'],prefix='MultipleLines')\ndata_InternetService_dummies=pd.get_dummies(Data['InternetService'],prefix='InternetService')\ndata_OnlineSecurity_dummies=pd.get_dummies(Data['OnlineSecurity'],prefix='OnlineSecurity')\ndata_OnlineBackup_dummies=pd.get_dummies(Data['OnlineBackup'],prefix='OnlineBackup')\ndata_DeviceProtection_dummies=pd.get_dummies(Data['DeviceProtection'],prefix='DeviceProtection')\ndata_TechSupport_dummies=pd.get_dummies(Data['TechSupport'],prefix='TechSupport')\ndata_StreamingTV_dummies=pd.get_dummies(Data['StreamingTV'],prefix='StreamingTV')\ndata_StreamingMovies_dummies=pd.get_dummies(Data['StreamingMovies'],prefix='StreamingMovies')\ndata_Contract_dummies=pd.get_dummies(Data['Contract'],prefix='Contract')\ndata_PaymentMethod_dummies=pd.get_dummies(Data['PaymentMethod'],prefix='PaymentMethod')","c9b900ba":"New_data=pd.concat([Data.iloc[:,:6],data_MultipleLines_dummies,data_InternetService_dummies,data_OnlineSecurity_dummies,data_OnlineBackup_dummies,data_DeviceProtection_dummies,data_TechSupport_dummies,data_StreamingTV_dummies,data_StreamingMovies_dummies,\n           data_Contract_dummies,Data.iloc[:,15],data_PaymentMethod_dummies,Data.iloc[:,17:]],axis=1)","c1fdd094":"New_data.head()","c96d56ad":"x=New_data.iloc[:,:40]\ny=New_data.iloc[:,40]","0d67da01":"x.head()","0926b6a4":"y.head()","f0a0c543":"New_data.corr().iloc[40:,:]","c6b0899c":"import statsmodels.api as sm\n\nprint(sm.OLS(endog=y,exog=x).fit().summary())","e9883e2a":"x_array=x.values\ny_array=y.values","c2d21bb8":"x_array.shape","a541f7d9":"y_array.shape","d019bad2":"from sklearn.model_selection import train_test_split\n\nx_train,x_val,y_train,y_val=train_test_split(x_array,y_array,test_size=0.05,random_state=42)\nx_train,x_test,y_train,y_test=train_test_split(x_train,y_train,test_size=0.15,random_state=42)","a9bbeef5":"x_train.shape","b5e0b7b4":"x_test.shape","f4013a91":"y_train.shape","88c328fe":"y_test.shape","70cc8e4f":"x_val.shape","97d5317a":"y_val.shape","2089c5e8":"from sklearn.preprocessing import StandardScaler\n\nobje_ss=StandardScaler()\nx_train_ss=obje_ss.fit_transform(x_train)\nx_test_ss=obje_ss.fit_transform(x_test)\nx_val_ss=obje_ss.fit_transform(x_val)","23365d60":"x_train_ss","9971ac89":"from sklearn.metrics import confusion_matrix,classification_report,accuracy_score","72857232":"from sklearn.linear_model import LogisticRegression\n\nmodel_log=LogisticRegression(C=1,random_state=42,max_iter=300,n_jobs=-1).fit(x_train,y_train)\ny_pred=model_log.predict(x_val)","fdeba3dd":"print(confusion_matrix(y_val,y_pred))","a244e20e":"print('Train success rate: %',model_log.score(x_train,y_train)*100)\nprint('Validation success rate: %',accuracy_score(y_val,y_pred)*100)","f7a5f717":"print(classification_report(y_val,y_pred)) ","04537d21":"from sklearn.svm import SVC\n\nmodel_svc=SVC(C=1,kernel='linear',degree=2,random_state=42).fit(x_train_ss,y_train)\ny_pred=model_svc.predict(x_val_ss)\nprint(model_svc)","7d0ec20b":"print(confusion_matrix(y_val,y_pred))","c9416de0":"print('Train success rate: %',model_svc.score(x_train_ss,y_train)*100)\nprint('Validation success rate: %',accuracy_score(y_val,y_pred)*100)","b0b7bad9":"print(classification_report(y_val,y_pred))","30868d28":"from sklearn.neighbors import KNeighborsClassifier\n\nmodel_knn=KNeighborsClassifier(n_neighbors=3,metric='minkowski').fit(x_train,y_train)\ny_pred=model_knn.predict(x_val)\nprint(model_knn)","9ea37cb9":"print(confusion_matrix(y_val,y_pred))","5e79e27a":"print('Train success rate: %',model_knn.score(x_train,y_train)*100)\nprint('Validation success rate: %',accuracy_score(y_val,y_pred)*100)","9e6894c6":"print(classification_report(y_val,y_pred))","0c6e1f8c":"from sklearn.naive_bayes import  BernoulliNB\n\nmodel_bnb=BernoulliNB(alpha=1).fit(x_train,y_train)\ny_pred=model_bnb.predict(x_val)\nprint(model_bnb)","2094feda":"print(confusion_matrix(y_val,y_pred))","0607ea52":"print('Train success rate: %',model_bnb.score(x_train,y_train)*100)\nprint('Validation success rate: %',accuracy_score(y_val,y_pred)*100)","e6bd9c84":"print(classification_report(y_val,y_pred))","161ea267":"from sklearn.ensemble import RandomForestClassifier\n\nmodel_rfr=RandomForestClassifier(n_estimators=100,max_depth=8,criterion='entropy',random_state=42,n_jobs=-1).fit(x_train,y_train)\ny_pred=model_rfr.predict(x_val)\nprint(model_rfr)","8014d020":"print(confusion_matrix(y_val,y_pred))","14952a98":"print('Train success rate: %',model_rfr.score(x_train,y_train)*100)\nprint('Validation success rate: %',accuracy_score(y_val,y_pred)*100)","9bd70093":"print(classification_report(y_val,y_pred))","d10b588d":"from xgboost import XGBClassifier\n\nmodel_xgb=XGBClassifier(max_depth=3,learning_rate=0.2,n_estimators=130,objective='binary:logistic',n_jobs=-1,random_state=42,subsample=1).fit(x_train,y_train)\ny_pred=model_xgb.predict(x_val)\nprint(model_xgb)","d8a22142":"print(confusion_matrix(y_val,y_pred))","aede7920":"print('Train success rate: %',model_xgb.score(x_train,y_train)*100)\nprint('Validation success rate: %',accuracy_score(y_val,y_pred)*100)","6eb0c863":"print(classification_report(y_val,y_pred))","e92aac36":"import tensorflow as tf","e9162e08":"model_nn=tf.keras.Sequential()\nmodel_nn.add(tf.keras.layers.Dense(64,activation='relu',input_dim=x_train.shape[1]))\nmodel_nn.add(tf.keras.layers.Dropout(0.3))\nmodel_nn.add(tf.keras.layers.Dense(64,activation='relu'))\nmodel_nn.add(tf.keras.layers.Dropout(0.2))\nmodel_nn.add(tf.keras.layers.Dense(1,activation='sigmoid'))","06fce2aa":"model_nn.compile(optimizer='adam',loss='binary_crossentropy',metrics=['accuracy'])","70091bee":"history_model_nn=model_nn.fit(x_train_ss,y_train,epochs=400,verbose=0)\nval_loss, val_accuracy=model_nn.evaluate(x_val_ss,y_val,verbose=0)","3f2e1ecf":"plt.grid(True)\nplt.plot(history_model_nn.epoch,history_model_nn.history['loss']);","e5c7b0ef":"print('Train accuracy success rate: %',history_model_nn.history['accuracy'][-1]*100)\nprint('Val accuracy success rate: %',val_accuracy*100)","ec8f276b":"y_pred=model_nn.predict(x_val_ss)\ny_pred[y_pred<=0.5]=0\ny_pred[y_pred>=0.5]=1","71e3f5b9":"print(classification_report(y_val,y_pred))","367a7d03":"def test_score(model_name):\n\n  for i in model_name:\n    print(f'{i.__class__} \\n{classification_report(y_test,i.predict(x_test))}')\n","096d0d98":"model_names=[model_log,model_knn,model_bnb,model_rfr,model_xgb]","5b0318f6":"test_score(model_names)\ny_pred=model_nn.predict(x_test_ss)\ny_pred[y_pred<=0.5]=0\ny_pred[y_pred>=0.5]=1\nprint(f'{model_nn.__class__} \\n{classification_report(y_test,y_pred)}')","01c95a44":"from sklearn.model_selection import cross_val_score","6bc79318":"def cross_score(model_name):\n\n  for i in model_name:\n    print(f'{i.__class__}  | Cross val score: %{cross_val_score(i,X=x_train,y=y_train,cv=5,n_jobs=-1).mean()*100}')","d24fdeeb":"cross_score(model_names)","c11c8b05":"from sklearn.metrics import roc_auc_score,roc_curve","4b504eb3":"fpr,tpr,thresholds=roc_curve(y_test,model_xgb.predict(x_test)) ","9368a272":"plt.grid(True)\nplt.plot(fpr,tpr);","0841f97a":"print('AUC success rate: %',roc_auc_score(y_test,model_xgb.predict(x_test))*100)","0a4b9ef0":"## Cross validation","4698244e":"## Train test split","7d74ab52":"## Test\n","cc23c02d":"### Navie Bayes","f08289e0":"### KNN","7a385923":"### Boosting","1a7a23c4":"###LogisticRegression","8e984af5":"### SVC","9299e568":"## NN","700364c3":"## Models","2488a65d":"## ROC- AUC","6bc69e7f":"## Scaler","83e0f4bb":"## Data Analysis","ece4af97":"### Tree Models","90f69b85":"## Encoding "}}