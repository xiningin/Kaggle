{"cell_type":{"7b0317b0":"code","de0b8b6e":"code","09ec6ff3":"code","86e6230d":"code","f1f2a306":"code","be22c8f0":"code","c129b55e":"code","f9c08dd9":"code","f2315e82":"code","46f509a7":"code","7f9fed12":"code","1364b15d":"code","71fa3402":"code","9461b5cb":"code","381c391d":"code","21808dbf":"code","dc9fba08":"code","717c9248":"code","8297c754":"markdown","ab4f2492":"markdown","54d82372":"markdown","e5e7230b":"markdown","ddd9d610":"markdown","66a4e79d":"markdown"},"source":{"7b0317b0":"import numpy as np\nimport pandas as pd\nimport os\nimport cv2\nimport missingno as msno\nfrom pathlib import Path\nfrom tqdm import tqdm\nimport wandb\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport missingno as msno\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\ntrain=pd.read_csv('..\/input\/petfinder-pawpularity-score\/train.csv')\ntest=pd.read_csv('..\/input\/petfinder-pawpularity-score\/test.csv')","de0b8b6e":"msno.bar(train,color='green')","09ec6ff3":"msno.bar(test,color='blue')","86e6230d":"plt.figure(figsize=(8,8))\nplt.title('Pawpularity Score',fontsize=30)\nplt.axvline(train['Pawpularity'].mean(), c='orange', ls='-', lw=3)\nsns.histplot(train['Pawpularity'],kde=True)","f1f2a306":"sns.pairplot(data=train)","be22c8f0":"plt.figure(figsize=(13,13))\nplt.title('Matrix of relation',fontsize=30)\nsns.heatmap(train.corr(),annot=True)","c129b55e":"def plot_pic(target_df):\n    plt.figure(figsize=(20, 50))\n    \n    n_rows = min(60, target_df.shape[0])\n    \n    for i in range(n_rows):\n        row = target_df.iloc[i]\n        img_path = f\"..\/input\/petfinder-pawpularity-score\/train\/{row['Id']}.jpg\"\n        Pawpularity = row[\"Pawpularity\"]\n        img = cv2.cvtColor(cv2.imread(img_path), cv2.COLOR_BGR2RGB)\n        plt.subplot(12, 5, i+1)\n        plt.title(f\"Pawpularity: {Pawpularity}\")\n        plt.imshow(img)\n    plt.tight_layout()\n    plt.show()\n    plt.close()","f9c08dd9":"plot_pic(train[train['Pawpularity']==1])","f2315e82":"plot_pic(train[train['Pawpularity']==100].iloc[:5])","46f509a7":"cols=['Id','Pawpularity']\nx_train=train.drop(cols,axis=1)","7f9fed12":"y_train=train['Pawpularity']","1364b15d":"from sklearn.model_selection import train_test_split\nx_train,x_test,y_train,y_test=train_test_split(x_train,y_train,test_size=0.2)","71fa3402":"import lightgbm as lgb","9461b5cb":"lgbr=lgb.LGBMRegressor(max_depth=10,learning_rate=0.005,n_estimators=200,reg_alpha=1,reg_lambda=0.1)\nlgbr.fit(x_train,y_train)\ny_pred=lgbr.predict(x_test)","381c391d":"from sklearn.metrics import mean_squared_error,r2_score\ndef rmse(y, y_pred):\n    return np.sqrt(mean_squared_error(y, y_pred))\nprint(rmse(y_test,y_pred))\nprint(mean_squared_error(y_test,y_pred))\nprint(r2_score(y_test,y_pred))","21808dbf":"test1=test.drop('Id',axis=1)\nPred=lgbr.predict(test1)","dc9fba08":"sub=pd.DataFrame()\nsub['Id']=test['Id']\nsub['Pawpularity']=Pred","717c9248":"sub.to_csv('submission.csv',index=False)","8297c754":"# **To me,they are SAME cute!!!!!**\n\n* Um.....maybe we can use machine learning or deep learning to solve this problem?","ab4f2492":"# Meta Features Inference\n* NO missing values\n* Pawpularity Score is normal distribution.\n* There seems to be less correlation between features\n* Between target and features,the all correlation coefficients are less than 0.03.....","54d82372":"# **LightGBM**","e5e7230b":"# **PHOTOS**","ddd9d610":"# HELLO PETLOVERS\n# version1\n* I got into this competition just now,and I used the most simple way to do it.\n* No Feature Engineering\n* No Parameters Tuning\n* No EDA\n* and I got RMSE 20.8,maybe it's baseline we can use many diffent way to break.\n\n# version2\n\n* use lgbm is better?\n* **Um....RMSE 20.5.... a little better...**\n\n# version3\n* I add some EDA here.\n* Maybe we can find more detail from them?\n\n# version4...\nI try to use CNN to predict target\n\nHow is it?\n\nhttps:\/\/www.kaggle.com\/k589k589\/tensorflow-cnn\n\n# Let's solve the problem together!!!","66a4e79d":"# **Exploratory Data Analysis**"}}