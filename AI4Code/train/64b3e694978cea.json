{"cell_type":{"0733d867":"code","5e0932fe":"code","0aada674":"code","96a14eff":"code","bf96a461":"code","025ca063":"code","0c7ab429":"code","60598a62":"code","8b78dff5":"code","f4945db7":"code","6937ee95":"code","e53537ad":"code","4cf8a982":"code","6130f136":"code","4789a29c":"code","9b504bfc":"code","deb6fe94":"code","46d977f1":"code","1a9fe7e6":"code","0b17d2eb":"code","4767a9b2":"code","262f503b":"code","eaccaecf":"code","f99be142":"code","e07505d2":"code","56a7d273":"code","b525bebf":"code","1b6f2673":"code","505e9e41":"code","326b5dbf":"code","dcbc6ed9":"code","5f1fe024":"code","cca63607":"code","45f01f80":"code","17d14645":"code","961f4ccd":"code","4f92a77e":"code","3855449c":"code","a743527a":"code","f036831e":"code","8eba5f36":"code","5deefe64":"code","d14fd911":"code","9dc9ce8d":"markdown","3ba7ff35":"markdown","ee787929":"markdown","d9c53ab8":"markdown","bb8ad8b5":"markdown","4150a04c":"markdown","d072af04":"markdown","b8b00ded":"markdown","bfcbb814":"markdown","657e2710":"markdown","a6c2449c":"markdown","5f382829":"markdown","18410f95":"markdown","a865d5c8":"markdown","51ecc83d":"markdown","2d4df783":"markdown","9148378f":"markdown"},"source":{"0733d867":"import numpy as np\nimport pandas as pd \n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","5e0932fe":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns","0aada674":"df=pd.read_csv('..\/input\/heart-failure-clinical-data\/heart_failure_clinical_records_dataset.csv')","96a14eff":"df.head()","bf96a461":"df.info()","025ca063":"df.corr()['DEATH_EVENT'].drop('DEATH_EVENT').sort_values().plot(kind='bar')","0c7ab429":"df['time'].unique()","60598a62":"df=df.drop('time', axis=1)","8b78dff5":"df.corr()['DEATH_EVENT'].drop('DEATH_EVENT').sort_values()","f4945db7":"df['serum_creatinine'].unique()","6937ee95":"plt.figure(figsize=(12,4))\nsns.displot(data=df, x='age',hue='DEATH_EVENT')","e53537ad":"plt.figure(figsize=(4,8))\nsns.boxplot(data=df, x='DEATH_EVENT', y='serum_creatinine')","4cf8a982":"plt.figure(figsize=(12,4))\nsns.boxplot(data=df, x='DEATH_EVENT', y='age')","6130f136":"df['ejection_fraction'].unique()","4789a29c":"plt.figure(figsize=(12,4))\nsns.boxplot(data=df, x='DEATH_EVENT', y='ejection_fraction')","9b504bfc":"df.columns","deb6fe94":"plt.figure(figsize=(12,4))\nsns.boxplot(data=df, x='DEATH_EVENT', y='platelets')","46d977f1":"plt.figure(figsize=(4,6))\nsns.boxplot(data=df, x='DEATH_EVENT', y='creatinine_phosphokinase')","1a9fe7e6":"df.head()","0b17d2eb":"plt.figure(figsize=(12,4))\nsns.heatmap(data=df.corr().drop('DEATH_EVENT'), cmap='coolwarm', annot=True)","4767a9b2":"df.isna().sum()","262f503b":"df.head()","eaccaecf":"df.columns","f99be142":"from sklearn.model_selection import train_test_split","e07505d2":"from sklearn.preprocessing import MinMaxScaler","56a7d273":"scaler = MinMaxScaler()","b525bebf":"X= df.drop('DEATH_EVENT', axis=1)\ny=df['DEATH_EVENT']","1b6f2673":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33, random_state=42)","505e9e41":"X_train = scaler.fit_transform(X_train)","326b5dbf":"X_test = scaler.transform(X_test)","dcbc6ed9":"from sklearn.ensemble import RandomForestClassifier","5f1fe024":"rfc = RandomForestClassifier(n_estimators=600)","cca63607":"rfc.fit(X_train,y_train)","45f01f80":"from sklearn.metrics import classification_report,confusion_matrix","17d14645":"predictions = rfc.predict(X_test)","961f4ccd":"print(classification_report(y_test,predictions))","4f92a77e":"abs(df.corr()['DEATH_EVENT'].drop('DEATH_EVENT')).sort_values()","3855449c":"X=df.drop(['diabetes','sex','DEATH_EVENT','smoking'], axis=1)\ny=df['DEATH_EVENT']","a743527a":"X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33, random_state=42)","f036831e":"rfc = RandomForestClassifier(n_estimators=600)","8eba5f36":"rfc.fit(X_train,y_train)","5deefe64":"predictions = rfc.predict(X_test)","d14fd911":"print(classification_report(y_test,predictions))","9dc9ce8d":"There are no Null values, we are good to go.","3ba7ff35":"Sex and Diabetes are hardly correlated with Death and thus I will remove the less correllated features and train the model","ee787929":"**Model Creation and Evaluation**","d9c53ab8":"serum_creatinine levels are higher for those who die from Heart Failure","bb8ad8b5":"**EDA**","4150a04c":"As less blood leaves the heart, the ejection fraction decreases causing Heart Failure.","d072af04":"The performance is very poor and thus I have decided to remove features which aren't much correllated to Death","b8b00ded":"There are not any features that are correlated with each other. We can move onto Data Cleaning and Preprocessing","bfcbb814":"We have got a decent score here. Thanks!","657e2710":"Since this is a time-to-event data-set. There are 2 target columns: time and DEATH_EVENT.\n\nDEATH_EVENT encodes whether the patient died (1) or whether they were censored (0). Censoring means that the scientists lost contact with the patient.\n\ntime captures the time of the event. That is, the time at which the patient died or were censored.\n\nUsing the time column as a feature is wrong. When we deploy our model, no end user will be able to provide you the value of time, since they do not know at what time in the future the patient will die\/get censored!","a6c2449c":"Age also seems to be higher for those who die from Heart Failure","5f382829":"Let's start by Using Random Forest Classifier","18410f95":"**Categorical Features**\n\nThere seem to be quite a few Categorical features which needs to be transformed so that sklearn will be able to understand them","a865d5c8":"Not much variation","51ecc83d":"ejection_fraction, Age and serum_creatinine have a very high corellation with Death. Let us explore them further","2d4df783":"**Data PreProcessing**","9148378f":"**Predictions and Evaluation**\n\nLet's predict off the y_test values and evaluate our model."}}