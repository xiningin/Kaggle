{"cell_type":{"7298760a":"code","bafe9b49":"code","4e29c28c":"code","bc8dc7cf":"code","2e579b5c":"code","7005f3bc":"code","7b2543b0":"code","0de3fa61":"code","537472b1":"code","d75d75c2":"code","1885cba6":"code","dbba865c":"code","9057147a":"code","b23861d6":"code","ff631d65":"code","2b5da3b0":"markdown","c69c4e55":"markdown","c0a781eb":"markdown","bbfe1540":"markdown","debd7aa4":"markdown","dca1bed0":"markdown","73f9eb86":"markdown","4f14e7ee":"markdown","808eac3d":"markdown","c7ac2f8e":"markdown","faa88fc0":"markdown","656adb38":"markdown","0c856336":"markdown"},"source":{"7298760a":"import pandas as pd\nimport matplotlib.pyplot as plt\nimport math\nimport numpy as np\nfrom sklearn import tree\nimport folium","bafe9b49":"world_cup_matches = pd.read_csv(\"..\/input\/WorldCupMatches.csv\")\nworld_cup_players = pd.read_csv('..\/input\/WorldCupPlayers.csv')\nworld_cups = pd.read_csv('..\/input\/WorldCups.csv')\n#world_cup_matches.head()","4e29c28c":"print('There are',world_cups['Year'].count(),'World Cup Championships so far')","bc8dc7cf":"\nworld_cup_matches['Datetime'] = pd.to_datetime(world_cup_matches['Datetime'])\n\nworld_cup_matches['Datetime'] = world_cup_matches['Datetime'].dt.date\n#set(world_cup_matches['Win conditions'])\n\n#world_cup_matches[(df.A == 1) & (df.D == 6)]\nworld_cup_matches_final = world_cup_matches[(world_cup_matches['Stage']=='Final')]\n\nnumber_of_matches_home_wins = world_cup_matches_final[(world_cup_matches_final['Home Team Goals']> world_cup_matches_final['Away Team Goals'])].shape[0]\nnumber_of_matches_away_wins = world_cup_matches_final[(world_cup_matches_final['Home Team Goals']< world_cup_matches_final['Away Team Goals'])].shape[0]\nprint(round(number_of_matches_home_wins\/(number_of_matches_away_wins+number_of_matches_home_wins)*100,2),\"% of home teams won the finals\")\n\n","2e579b5c":"\nimport numpy as np\n##  \nworld_cup_matches_number_of_attendents = world_cup_matches.groupby(['Datetime']).agg({'Attendance':np.sum})\n##\nprint(world_cup_matches_number_of_attendents.columns)\n\n\n##number of matches played throughout the years\n\nworld_cup_matches_year = world_cup_matches.groupby(['Year']).size().reset_index()\n\nworld_cup_matches_year['n'] = world_cup_matches_year[0]\n\n#world_cup_matches_year.drop([0])\n\ndel world_cup_matches_year[0]\n\n\n\n\n#print(world_cup_matches_year.Year)\n\n\nworld_cup_matches_year['Year'] = world_cup_matches_year.Year.astype(int)\n\nworld_cup_matches_year.Year = pd.to_datetime(world_cup_matches_year.Year, format='%Y')\n\nworld_cup_matches_year.plot(kind='bar',x='Year',y='n')\nplt.legend().remove()\nplt.show()\n\n\n#world_cup_matches_year['Year'] = pd.to_numeric(world_cup_matches_year['Year'], errors='coerce')\n#world_cup_matches_year['Year'] = pd.to_datetime(world_cup_matches_year['Year'], format='%Y')\n\n##\n\n#world_cup_matches_year.head()\n\n","7005f3bc":"#world_cups.head()\n#print(world_cups)\n\nmask = world_cups.Winner == 'Germany FR'\ncolumn_name = 'Winner'\nworld_cups.loc[mask, column_name] = 'Germany'\n#print(world_cups)\ndf = world_cups.groupby('Winner').agg({'Winner': 'count'}).sort_values(by='Winner')\ndf['countries'] = df.index\ndf.columns = ['number_of_cups','countries']\ndf.reset_index(drop = True, inplace = True)\n\ndf['lat'] = [-0.116667,2,-4,-64,-56,9,12,-52]\ndf['lon'] = [51.5,47,40,-34,-33,51,43,-10]\ndf['number_of_cups']= 10000*(np.exp(df['number_of_cups'].astype('float')))\n\n\n\n\n#print(df)\n\nm = folium.Map(location=[20,0], tiles=\"Mapbox Bright\", zoom_start=2)\n \n# I can add marker one by one on the map\nfor i in range(0,len(df)):\n   folium.Circle(\n      location=[df.iloc[i]['lon'], df.iloc[i]['lat']],\n      popup=df.iloc[i]['countries'],\n      radius=df.iloc[i]['number_of_cups'],\n      color='crimson',\n      fill=True,\n      fill_color='crimson'\n   ).add_to(m)\nm\n\n\n","7b2543b0":"world_cup_matches['total_goals'] = world_cup_matches['Home Team Goals']+world_cup_matches['Away Team Goals']\nnumber_of_goals_per_year = world_cup_matches.groupby(['Year']).agg({'total_goals':np.sum}).reset_index()\nnumber_of_goals_per_year.Year = number_of_goals_per_year.Year.astype(int)\nnumber_of_goals_per_year.Year = pd.to_datetime(number_of_goals_per_year.Year, format='%Y')\n\naverage_goals_scored_per_match = pd.merge(number_of_goals_per_year, world_cup_matches_year, on =['Year'])\naverage_goals_scored_per_match['average_score_per_match'] = average_goals_scored_per_match['total_goals']\/average_goals_scored_per_match['n']\naverage_goals_scored_per_match.plot(kind='line',x='Year',y='average_score_per_match',title='Average Score Per Match')\nplt.legend().remove()\n\nplt.show()\n","0de3fa61":"world_cups['Attendance']= world_cups['Attendance'].str.replace('.', '')\nworld_cups['Attendance']=world_cups['Attendance'].astype(int)\nworld_cups.plot(x='Year',y='Attendance',kind='bar',title='Attendee by championship year')\nplt.legend().remove()\n\nplt.show()\n\n","537472b1":"matches_played = world_cups[['Year','MatchesPlayed','Attendance']].drop_duplicates()\nmatches_played['Average'] = matches_played['Attendance']\/matches_played['MatchesPlayed']\nmatches_played['Average']= np.round(matches_played['Average'])\nmatches_played.plot(x='Year',y='Average',kind='bar')\nplt.legend().remove()\nplt.show()","d75d75c2":"country=world_cups.groupby('Country').size().reset_index()\ncountry.columns= ['Country','n']\ncountry.sort_values(by='n').plot(kind='bar',x='Country',y='n')\nplt.legend().remove()\n\nplt.show()","1885cba6":"\nmatches_played = world_cup_matches[['Year','MatchID']].dropna()\nmatches_played['Year']=matches_played['Year'].astype(int)\nmatches_played = matches_played.drop_duplicates().groupby('Year').size().reset_index()\nmatches_played.plot(kind='bar',x='Year')\nplt.legend().remove()\n\nplt.show()","dbba865c":"matches = world_cup_matches[['Year','Home Team Name','Away Team Name','MatchID']]\nmatches = pd.melt(matches, id_vars=['Year','MatchID'], value_vars=['Home Team Name', 'Away Team Name'])\n#print(matches)\nmatches= matches.dropna()\nmatches[\"Year\"] = matches['Year'].astype(int)\nmatches = matches.drop(['variable','MatchID'],axis=1).drop_duplicates()\nmatches.groupby(['Year']).size().reset_index().plot(kind='bar',x='Year',title='Number of Participating Countries')\nplt.legend().remove()\nplt.show()\n","9057147a":"world_cup_matches['diff'] = world_cup_matches['Home Team Goals']- world_cup_matches['Away Team Goals']\nworld_cup_matches.columns","b23861d6":"world_cup_matches_goal_diff = world_cup_matches[['MatchID','Year','diff']]\nworld_cup_matches_goal_diff= world_cup_matches_goal_diff.dropna().drop_duplicates()\nworld_cup_matches_goal_diff= world_cup_matches_goal_diff.drop('MatchID',axis=1)","ff631d65":"#world_cup_matches_diff= world_cup_matches_diff.dropna()\nworld_cup_matches_goal_diff['Year'] = world_cup_matches_goal_diff['Year'].astype(int)\nworld_cup_matches_goal_diff.boxplot(by='Year',figsize=(20,10))\nplt.xticks(rotation=90)\nplt.show()","2b5da3b0":"* 78% of home teams won the matches","c69c4e55":"## Number of Cups by each Country","c0a781eb":"## How many world cup championships have happened so far?","bbfe1540":"## Total Number of Countries Per Championship","debd7aa4":"## How does the distribution of goal differences over the championships change?","dca1bed0":"## Average Number of Attendees Per Match over the Years","73f9eb86":"## Number of Matches in a Year","4f14e7ee":"* The average goals scored per match has been decreasing as time goes by.","808eac3d":"## Total Number of Matches Played Per Championship","c7ac2f8e":"## Percentage of home teams that won the finals","faa88fc0":"## Which country has hosted the most number of world cups?","656adb38":"## Number of Total Goals Scored per match over the Years","0c856336":"## Attendence by Year"}}