{"cell_type":{"3861441e":"code","df6b1a0b":"code","7373fb42":"code","1ca665c5":"code","a13b8a56":"code","f50f37f2":"code","0f3610ad":"markdown","79121edc":"markdown","5ea89462":"markdown","a38c3937":"markdown","3ccd35c7":"markdown","f435663b":"markdown","2775d274":"markdown"},"source":{"3861441e":"import numpy as np \nimport pandas as pd \nimport os.path as path\nfrom PIL import Image as image\n","df6b1a0b":"df = pd.read_csv('..\/input\/skin-cancer-mnist-ham10000\/HAM10000_metadata.csv')\ndf.head(20)","7373fb42":"def expand_path(p):\n    if path.isfile('..\/input\/skin-cancer-mnist-ham10000\/ham10000_images_part_1\/' + p + '.jpg'): return '..\/input\/skin-cancer-mnist-ham10000\/ham10000_images_part_1\/' + p + '.jpg'\n    if path.isfile('..\/input\/skin-cancer-mnist-ham10000\/ham10000_images_part_2\/' + p + '.jpg'): return '..\/input\/skin-cancer-mnist-ham10000\/ham10000_images_part_2\/' + p + '.jpg'\n    return p \ndf['image_path'] = df['image_id']\ndf['image_path'] = df['image_path'].apply(expand_path)","1ca665c5":"df['images'] = df['image_path'].map(lambda x: np.asarray(image.open(x).resize((256,192))))","a13b8a56":"classes = df['dx'].unique()\nlabeldict = {}\nfor num, name in enumerate(classes):\n    labeldict[name] = num\ndf['dx_id'] = df['dx'].map(lambda x: labeldict[x])","f50f37f2":"df.to_pickle(\".\/data.pkl\")\n\n","0f3610ad":"The images are split into two folders and images labelled by `image_id`. We will transform these ID's into the file path  ","79121edc":"## EDA (Minimal)","5ea89462":"## Data Preperation","a38c3937":"Importing Necessary Libraries","3ccd35c7":"By looking at the data below, we can make the following observations:\n* There are sometimes multiple images of the same legion. This could potentially increase overfitting, as the classifier will be trained on the same lesion multiple time per epoch, although the photos are different. Some approaches split these up into seperate datasets, however for the sake of simplicity, we will include all\n* dx is the target column\n* There is metadata available about each lesion (age, sex, localisation). These factors could potentially be included in the model to enhance accuracy of the classifier\n* There are multiple targets, which means this will be a multilabel classifier. ","f435663b":"Saving data to pickle file. This will save processesing, as resizing the images over and over again takes a fair amount of time. ","2775d274":"We will now resize image to reduce training time, as the files are way too big to process raw. They are 600 x 450, so we will resize with appropriate scale of 4:3 to 256 x 192. 256 was chosen as base from ImageNet. "}}