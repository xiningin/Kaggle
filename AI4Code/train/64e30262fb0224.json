{"cell_type":{"e279be8c":"code","ca301933":"code","55026983":"code","1c5108f9":"code","d17ee7ef":"code","fb03a3d3":"code","0098887f":"code","1efebe08":"code","087693c7":"code","fcbbb3f4":"code","0ded3eb9":"code","f15e81e7":"code","4ddf531c":"code","8d3e34e7":"code","e2a76410":"code","8f0e5f1e":"code","1b987535":"code","56114ab2":"code","c229c649":"markdown","fc703ddf":"markdown","5cc3f8d9":"markdown","37ed6eea":"markdown","28bcd550":"markdown","9d878ba3":"markdown","3a7804e8":"markdown","3fd7bc7b":"markdown","604e69ac":"markdown","c5aa8a0b":"markdown","5ce57444":"markdown","2e3e80d2":"markdown","3a5ba3a5":"markdown","a56489fa":"markdown","ab8ae9c2":"markdown","477150a0":"markdown","c26600be":"markdown","7029c594":"markdown","b62f9eb0":"markdown","58cf86e4":"markdown","4e7771d2":"markdown","d1d20ac6":"markdown","21ca6b88":"markdown","4b686549":"markdown","0574263e":"markdown","5db8d4c6":"markdown","f7194b0f":"markdown","edfbb3f2":"markdown"},"source":{"e279be8c":"import pandas as pd\nimport numpy as np\nimport sklearn\nfrom sklearn import linear_model\nfrom sklearn.utils import shuffle\nimport matplotlib.pyplot as pyplot\nimport pickle\nfrom matplotlib import style","ca301933":"data = pd.read_csv('..\/input\/student-mat.csv', sep=\";\")\ndata['sex'] = data['sex'].replace(['F','M'],[0,1])\ndata.head()","55026983":"data = data[[\"G1\", \"G2\", \"G3\", \"studytime\", \"failures\", \"absences\",\"age\",\"health\",\"sex\"]]\ndata.head()","1c5108f9":"predict = \"G3\"\nx = np.array(data.drop([predict], 1))\ny = np.array(data[predict])","d17ee7ef":"x_train, x_test, y_train, y_test = sklearn.model_selection.train_test_split(x, y , test_size=0.1)","fb03a3d3":"# best = 0\n# for _ in range(30):\n#     x_train, x_test, y_train, y_test = sklearn.model_selection.train_test_split(x, y , test_size=0.1)\n#     linear = linear_model.LinearRegression()\n\n#     linear.fit(x_train, y_train)\n#     acc = linear.score(x_test, y_test)\n#     print(acc)\n    \n#     if acc > best:\n#         best = acc\n#         with open(\"studentmodel.pickle\", \"wb\") as f:\n#             pickle.dump(linear, f)","0098887f":"pickle_in = open(\"studentmodel.pickle\", \"rb\")\nlinear = pickle.load(pickle_in)","1efebe08":"linear.coef_","087693c7":"linear.intercept_","fcbbb3f4":"predictions = linear.predict(x_test)\n\nfor i in range(len(predictions)):\n    print(predictions[i], x_test[i], y_test[i])","0ded3eb9":"p = 'G1'\nstyle.use(\"ggplot\")\npyplot.scatter(data[p],data[\"G3\"])\npyplot.xlabel(p)\npyplot.ylabel(\"Final Grade\")\npyplot.show()","f15e81e7":"p = 'G2'\nstyle.use(\"ggplot\")\npyplot.scatter(data[p],data[\"G3\"])\npyplot.xlabel(p)\npyplot.ylabel(\"Final Grade\")\npyplot.show()","4ddf531c":"p = 'age'\nstyle.use(\"ggplot\")\npyplot.scatter(data[p],data[\"G3\"])\npyplot.xlabel(p)\npyplot.ylabel(\"Final Grade\")\npyplot.show()","8d3e34e7":"p = 'sex'\nstyle.use(\"ggplot\")\npyplot.scatter(data[p],data[\"G3\"])\npyplot.xlabel(p)\npyplot.ylabel(\"Final Grade\")\npyplot.show()","e2a76410":"p = 'health'\nstyle.use(\"ggplot\")\npyplot.scatter(data[p],data[\"G3\"])\npyplot.xlabel(p)\npyplot.ylabel(\"Final Grade\")\npyplot.show()","8f0e5f1e":"p = 'studytime'\nstyle.use(\"ggplot\")\npyplot.scatter(data[p],data[\"G3\"])\npyplot.xlabel(p)\npyplot.ylabel(\"Final Grade\")\npyplot.show()","1b987535":"p = 'failures'\nstyle.use(\"ggplot\")\npyplot.scatter(data[p],data[\"G3\"])\npyplot.xlabel(p)\npyplot.ylabel(\"Final Grade\")\npyplot.show()","56114ab2":"p = 'absences'\nstyle.use(\"ggplot\")\npyplot.scatter(data[p],data[\"G3\"])\npyplot.xlabel(p)\npyplot.ylabel(\"Final Grade\")\npyplot.show()","c229c649":"**Saving our model**","fc703ddf":"Here we see that for some reason students of age 19 are not able to score higher. This may be the result of distraction of puberty but then every age has that here or maybe the pressure what to do in future may have caught them by suprise.","5cc3f8d9":"Plotting against every variable yo get a good idea of what is happening","37ed6eea":"**Fetching dataset**","28bcd550":"Plotting against G1","9d878ba3":"Plotting against G2","3a7804e8":"**Spliting the model**","3fd7bc7b":"Plotting against age","604e69ac":"**Predictions**","c5aa8a0b":"Here we see no matter the sex it just depends on individual brilliance but however a male has the highest marks.","5ce57444":"Here we people who had higher marks in previous exams had better marks.","2e3e80d2":"Here we see the student with higher studytime gets higher marks.","3a5ba3a5":"**Using Attributes that we need**","a56489fa":"Plotting against absences","ab8ae9c2":"**Here we have a 94% accuracy in terms of predicting a students final score. The variables we used were age, sex, health, studytime, failures, absences and the marks of the two previous test.**","477150a0":"Plotting against health","c26600be":"Plotting against failures","7029c594":"Here we see that people with lesser health point(2) are getting highest and people with highest health point(5) are getting lowest. Maybe its because student are also atheletes are with better health and dont get enough studytime.","b62f9eb0":"# The Model","58cf86e4":"**Plotting the data**","4e7771d2":"I commented out my model because i saved it with pickle and import after i trained it. You can find the pickle file in the output directory.","d1d20ac6":"Here we see the people with lesser amount of failures tend to get higher marks.","21ca6b88":"Here G1, G2, G3 are the grades a student got in school at 3 different tests.\nWe are gonna try and predict G3 based on the other 5 attributes we have.","4b686549":"Plotting against sex","0574263e":"Here we see that people with 0-10 absences are very similar and students dont get effected that much. However when a student is absent for 20 times his\/her marks are getting declined.","5db8d4c6":"Plotting against studytime","f7194b0f":"**Importing Libraries**","edfbb3f2":"Here we people who had higher marks in previous exams had better marks."}}