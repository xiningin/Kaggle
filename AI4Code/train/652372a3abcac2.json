{"cell_type":{"bb9e187c":"code","7dd38a2d":"code","3ea1f291":"code","7f76b8c6":"code","69170538":"code","8b538ac1":"code","2d5a8910":"code","62464d98":"code","6c0b9948":"code","89f62963":"code","5016c2e0":"code","dcca0d95":"code","ad808acb":"code","25d4dbd5":"code","0f5e83fd":"code","3b82b56c":"code","61579fa8":"code","4160d636":"code","1c1c644e":"code","cce44869":"code","991ae106":"code","3076cada":"code","cc7ac3a0":"code","3f51eab2":"code","0c3f3302":"code","bd6bb865":"code","f981406e":"code","bb782ba0":"code","b9a5f057":"code","1937aa83":"code","3c5307bf":"code","f68a13c5":"code","5a9dd7a8":"code","db73d265":"code","c0907179":"code","37499f86":"markdown","d7196592":"markdown","e2186095":"markdown","10ba4808":"markdown","7f67021c":"markdown","8e66dd87":"markdown","91ef41cf":"markdown","c6336546":"markdown","ac1dad5d":"markdown","c8987b22":"markdown","e33cb3f4":"markdown","8b5557d5":"markdown","8192f00a":"markdown","a32898a8":"markdown","50c05ca7":"markdown","c8f3b06b":"markdown","9e496847":"markdown","438d3c86":"markdown","fa9e1cde":"markdown","9cdb395e":"markdown","93c424fd":"markdown","50784dfe":"markdown","00ff828d":"markdown","4d1dd374":"markdown","2937574d":"markdown","5ea50d04":"markdown","ba774204":"markdown","44418b49":"markdown","2dd639ca":"markdown"},"source":{"bb9e187c":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns","7dd38a2d":"from plotly.offline import plot, iplot, init_notebook_mode\nimport plotly.graph_objs as go\ninit_notebook_mode(connected=True)","3ea1f291":"df=pd.read_csv('..\/input\/netflix-shows\/netflix_titles.csv')\ndf.head()\ndf1=df.copy()","7f76b8c6":"# Calculating missing data\nfor i in df.columns:\n    null_rate = df[i].isna().sum()\/len(df) * 100\n    if null_rate > 0 :\n        print(\"{} null rate: {}%\".format(i,round(null_rate,2)))","69170538":"## add new features in the dataset\ndf[\"date_added\"] = pd.to_datetime(df['date_added'])\ndf['year_added'] = df['date_added'].dt.year\ndf['month_added'] = df['date_added'].dt.month\n\ndf['season_count'] = df.apply(lambda x : x['duration'].split(\" \")[0] if \"Season\" in x['duration'] else \"\", axis = 1)\ndf['duration'] = df.apply(lambda x : x['duration'].split(\" \")[0] if \"Season\" not in x['duration'] else \"\", axis = 1)\ndf.head()","8b538ac1":"#Dealing with the missing data :\n#Here we will be replacing the missing country with the most country (mode), cast, and director with no data.\ndf['country'] = df['country'].fillna(df['country'].mode()[0])\ndf['cast'].replace(np.nan,'No data',inplace=True)\ndf['director'].replace(np.nan,'No data',inplace=True)\ndf.dropna(inplace=True)\ndf.drop_duplicates(inplace=True)","2d5a8910":"# Calculating missing data\nfor i in df.columns:\n    null_rate = df[i].isna().sum()\/len(df) * 100\n    if null_rate > 0 :\n        print(\"{} null rate: {}%\".format(i,round(null_rate,2)))\nprint(\"NO null values\")","62464d98":"#Netflix\u2019s Brand Palette\nsns.palplot(['#221f1f', '#b20710', '#e50914','#f5f5f1'])\nplt.title(\"Netflix brand palette\",loc='left',fontfamily='serif',fontsize=15,y=1.2)\nplt.show()","6c0b9948":"import plotly.graph_objects as go\nfrom plotly.offline import init_notebook_mode, iplot","89f62963":"col = \"type\"\ngrouped = df[col].value_counts().reset_index()\ngrouped = grouped.rename(columns = {col : \"count\", \"index\" : col})\n\n## plot\ntrace = go.Pie(labels=grouped[col], values=grouped['count'], pull=[0.05, 0], marker=dict(colors=[\"#b20710\", \"#f5f5f1\"]))\nlayout = go.Layout(title=\"\", height=400, legend=dict(x=0.1, y=1.1))\nfig = go.Figure(data = [trace], layout = layout)\niplot(fig)","5016c2e0":"d1 = df[df[\"type\"] == \"TV Show\"]\nd2 = df[df[\"type\"] == \"Movie\"]\n\ncol = \"year_added\"\n\nvc1 = d1[col].value_counts().reset_index()\nvc1 = vc1.rename(columns = {col : \"count\", \"index\" : col})\nvc1['percent'] = vc1['count'].apply(lambda x : 100*x\/sum(vc1['count']))\nvc1 = vc1.sort_values(col)\n\nvc2 = d2[col].value_counts().reset_index()\nvc2 = vc2.rename(columns = {col : \"count\", \"index\" : col})\nvc2['percent'] = vc2['count'].apply(lambda x : 100*x\/sum(vc2['count']))\nvc2 = vc2.sort_values(col)\n\ntrace1 = go.Scatter(x=vc1[col], y=vc1[\"count\"], name=\"TV Shows\", marker=dict(color=\"#e50914\"))\ntrace2 = go.Scatter(x=vc2[col], y=vc2[\"count\"], name=\"Movies\", marker=dict(color=\"#b20710\"))\ndata = [trace1, trace2]\nlayout = go.Layout(title=\"Content added over the years\", legend=dict(x=0.1, y=1.1, orientation=\"h\"))\nfig = go.Figure(data, layout=layout)\nfig.show()","dcca0d95":"col = \"release_year\"\n\nvc1 = d1[col].value_counts().reset_index()\nvc1 = vc1.rename(columns = {col : \"count\", \"index\" : col})\nvc1['percent'] = vc1['count'].apply(lambda x : 100*x\/sum(vc1['count']))\nvc1 = vc1.sort_values(col)\n\nvc2 = d2[col].value_counts().reset_index()\nvc2 = vc2.rename(columns = {col : \"count\", \"index\" : col})\nvc2['percent'] = vc2['count'].apply(lambda x : 100*x\/sum(vc2['count']))\nvc2 = vc2.sort_values(col)\n\ntrace1 = go.Bar(x=vc1[col], y=vc1[\"count\"], name=\"TV Shows\", marker=dict(color=\"#b20710\"))\ntrace2 = go.Bar(x=vc2[col], y=vc2[\"count\"], name=\"Movies\", marker=dict(color=\"#221f1f\"))\ndata = [trace1, trace2]\nlayout = go.Layout(title=\"Content added over the years\", legend=dict(x=0.1, y=1.1, orientation=\"h\"))\nfig = go.Figure(data, layout=layout)\nfig.show()","ad808acb":"col = 'month_added'\nvc1 = d1[col].value_counts().reset_index()\nvc1 = vc1.rename(columns = {col : \"count\", \"index\" : col})\nvc1['percent'] = vc1['count'].apply(lambda x : 100*x\/sum(vc1['count']))\nvc1 = vc1.sort_values(col)\n\ntrace1 = go.Bar(x=vc1[col], y=vc1[\"count\"], name=\"TV Shows\", marker=dict(color=\"#e50914\"))\ndata = [trace1]\nlayout = go.Layout(title=\"In which month, the conent is added the most?\", legend=dict(x=0.1, y=1.1, orientation=\"h\"))\nfig = go.Figure(data, layout=layout)\nfig.show()","25d4dbd5":"small = df.sort_values(\"release_year\", ascending = True)\nsmall = small[small['duration'] != \"\"]\nsmall[['title', \"release_year\"]][:15]","0f5e83fd":"df['country']","3b82b56c":"df['first_country'] = df['country'].apply(lambda x: x.split(\",\")[0])\ndf['first_country']","61579fa8":"df['first_country'].replace('United States', 'USA', inplace=True)\ndf['first_country'].replace('United Kingdom', 'UK',inplace=True)\ndf['first_country'].replace('South Korea', 'S. Korea',inplace=True)","4160d636":"df['count']=1 #helper column\ndata = df.groupby('first_country')['count'].sum().sort_values(ascending=False)[:10]","1c1c644e":"data","cce44869":"color_map = ['#f5f5f1' for _ in range(10)]\ncolor_map[0] = color_map[1]= color_map[2] = '#b20710'\nfig,ax = plt.subplots(1,1,figsize=(12,6))\n#Annotating the figure\nax.bar(data.index,data,width=0.5,edgecolor='darkgray',linewidth=0.6,color=color_map)\nfor i in data.index:\n    ax.annotate(f\"{data[i]}\",xy=(i,data[i]+100),va='center',ha='center',fontweight='light',fontfamily='serif')\nfor s in ['top','left','right']:\n    ax.spines[s].set_visible(False)\n    \n#Adding text\nfig.text(0.125,1,'Top 10 countries on Netflix',fontsize=15,fontweight='bold',fontfamily='serif')\nfig.text(0.125,0.95,'The three most frequent countries have been highlighted.',fontsize=10,fontweight='light',fontfamily='serif')","991ae106":"import plotly.figure_factory as ff\nx1 = d2['duration'].fillna(0.0).astype(float)\nfig = ff.create_distplot([x1], ['a'], bin_size=0.7, curve_type='normal', colors=[\"#221f1f\"])\nfig.update_layout(title_text='Distplot with Normal Distribution')\nfig.show()","3076cada":"col = 'season_count'\nvc1 = d1[col].value_counts().reset_index()\nvc1 = vc1.rename(columns = {col : \"count\", \"index\" : col})\nvc1['percent'] = vc1['count'].apply(lambda x : 100*x\/sum(vc1['count']))\n\n\ntrace1 = go.Bar(x=vc1[col], y=vc1[\"count\"], name=\"TV Shows\", marker=dict(color=\"#b20710\"))\ndata = [trace1]\nlayout = go.Layout(title=\"Seasons\", legend=dict(x=0.1, y=1.1, orientation=\"h\"))\nfig = go.Figure(data, layout=layout)\nfig.show()","cc7ac3a0":"col = \"rating\"\n\nvc1 = d1[col].value_counts().reset_index()\nvc1 = vc1.rename(columns = {col : \"count\", \"index\" : col})\nvc1['percent'] = vc1['count'].apply(lambda x : 100*x\/sum(vc1['count']))\n#vc1 = vc1.sort_values(col)\n\nvc2 = d2[col].value_counts().reset_index()\nvc2 = vc2.rename(columns = {col : \"count\", \"index\" : col})\nvc2['percent'] = vc2['count'].apply(lambda x : 100*x\/sum(vc2['count']))\n#vc2 = vc2.sort_values(col)\n\ntrace1 = go.Bar(x=vc1[col], y=vc1[\"count\"], name=\"TV Shows\", marker=dict(color=\"#221f1f\"))\ntrace2 = go.Bar(x=vc2[col], y=vc2[\"count\"], name=\"Movies\", marker=dict(color=\"#e50914\"))\ndata = [trace1, trace2]\nlayout = go.Layout(title=\"Content added over the years\", legend=dict(x=0.1, y=1.1, orientation=\"h\"))\nfig = go.Figure(data, layout=layout)\nfig.show()","3f51eab2":"import collections\ncol = \"listed_in\"\ncategories = \", \".join(d2['listed_in']).split(\", \")\ncounter_list = collections.Counter(categories).most_common(50)\nlabels = [_[0] for _ in counter_list][::-1]\nvalues = [_[1] for _ in counter_list][::-1]\ntrace1 = go.Bar(y=labels, x=values, orientation=\"h\", name=\"TV Shows\", marker=dict(color=\"#221f1f\"))\n\ndata = [trace1]\nlayout = go.Layout(title=\"Content added over the years\", legend=dict(x=0.1, y=1.1, orientation=\"h\"))\nfig = go.Figure(data, layout=layout)\nfig.show()","0c3f3302":"def country_trace(country, flag = \"movie\"):\n    df1[\"from_us\"] = df1['country'].fillna(\"\").apply(lambda x : 1 if country.lower() in x.lower() else 0)\n    small = df1[df1[\"from_us\"] == 1]\n    if flag == \"movie\":\n        small = small[small[\"duration\"] != \"\"]\n    else:\n        small = small[small[\"season_count\"] != \"\"]\n    cast = \", \".join(small['cast'].fillna(\"\")).split(\", \")\n    tags = collections.Counter(cast).most_common(25)\n    tags = [_ for _ in tags if \"\" != _[0]]\n\n    labels, values = [_[0]+\"  \" for _ in tags], [_[1] for _ in tags]\n    trace = go.Bar(y=labels[::-1], x=values[::-1], orientation=\"h\", name=\"\" ,  marker=dict(color= \"#221f1f\"))\n    return trace\n\nfrom plotly.subplots import make_subplots\ntraces = []\ntitles = [\"United States\", \"\",\"India\",\"\", \"United Kingdom\", \"Canada\",\"\", \"Spain\",\"\", \"Japan\"]\nfor title in titles:\n    if title != \"\":\n        traces.append(country_trace(title))\n\nfig = make_subplots(rows=2, cols=5, subplot_titles=titles)\nfig.add_trace(traces[0], 1,1)\nfig.add_trace(traces[1], 1,3)\nfig.add_trace(traces[2], 1,5)\nfig.add_trace(traces[3], 2,1)\nfig.add_trace(traces[4], 2,3)\nfig.add_trace(traces[5], 2,5)\n\nfig.update_layout(height=1200, showlegend=False)\nfig.show()","bd6bb865":"\ndef country_trace(country, flag=\"tv_shows\"):\n    df[\"from_us\"] = df['country'].fillna(\"\").apply(lambda x : 1 if country.lower() in x.lower() else 0)\n    small = df[df[\"from_us\"] == 1]\n    if flag == \"movie\":\n        small = small[small[\"duration\"] != \"\"]\n    else:\n        small = small[small[\"season_count\"] != \"\"]\n    cast = \", \".join(small['cast'].fillna(\"\")).split(\", \")\n   \n    tags = collections.Counter(cast).most_common(25)\n    tags = [_ for _ in tags if \"\" != _[0]]\n\n    labels, values = [_[0]+\"  \" for _ in tags], [_[1] for _ in tags]\n    trace = go.Bar(y=labels[::-1], x=values[::-1], orientation=\"h\", name=\"\" ,  marker=dict(color= \"#221f1f\"))\n    return trace\ntraces = []\ntitles = [\"United States\", \"\",\"India\",\"\", \"United Kingdom\", \"Canada\",\"\", \"Spain\",\"\", \"Japan\"]\nfor title in titles:\n    if title != \"\":\n        traces.append(country_trace(title))\n\nfig = make_subplots(rows=2, cols=5, subplot_titles=titles)\nfig.add_trace(traces[0], 1,1)\nfig.add_trace(traces[1], 1,3)\nfig.add_trace(traces[2], 1,5)\nfig.add_trace(traces[3], 2,1)\nfig.add_trace(traces[4], 2,3)\nfig.add_trace(traces[5], 2,5)\n\nfig.update_layout(height=1200, showlegend=False)\nfig.show()","f981406e":"small = df1[df1[\"type\"] == \"Movie\"]\nsmall = small[small[\"country\"] == \"India\"]\ncol = \"director\"\ncategories = \", \".join(small[col].fillna(\"\")).split(\", \")\ncounter_list = collections.Counter(categories).most_common(12)\ncounter_list = [_ for _ in counter_list if _[0] != \"\"]\nlabels = [_[0] for _ in counter_list][::-1]\nvalues = [_[1] for _ in counter_list][::-1]\ntrace1 = go.Bar(y=labels, x=values, orientation=\"h\", name=\"TV Shows\", marker=dict(color=\"#e50914\"))\n\ndata = [trace1]\nlayout = go.Layout(title=\"Movie Directors from India with most content\", legend=dict(x=0.1, y=1.1, orientation=\"h\"))\nfig = go.Figure(data, layout=layout)\nfig.show()","bb782ba0":"small = df1[df1[\"type\"] == \"Movie\"]\nsmall = small[small[\"country\"] == \"United States\"]\n\ncol = \"director\"\ncategories = \", \".join(small[col].fillna(\"\")).split(\", \")\ncounter_list = collections.Counter(categories).most_common(12)\ncounter_list = [_ for _ in counter_list if _[0] != \"\"]\nlabels = [_[0] for _ in counter_list][::-1]\nvalues = [_[1] for _ in counter_list][::-1]\ntrace1 = go.Bar(y=labels, x=values, orientation=\"h\", name=\"TV Shows\", marker=dict(color=\"#b20710\"))\n\ndata = [trace1]\nlayout = go.Layout(title=\"Movie Directors from US with most content\", legend=dict(x=0.1, y=1.1, orientation=\"h\"))\nfig = go.Figure(data, layout=layout)\nfig.show()\n","b9a5f057":"def stand_up(country):\n    tag = \"Stand-Up Comedy\"\n    df[\"relevant\"] = df['listed_in'].fillna(\"\").apply(lambda x : 1 if tag.lower() in x.lower() else 0)\n    small = df[df[\"relevant\"] == 1]\n    name=small[small[\"country\"] == country][[\"title\", \"country\",\"release_year\"]].head(10)\n    return name","1937aa83":"stand_up(\"United States\")","3c5307bf":"stand_up(\"India\")","f68a13c5":" \nstand_up(\"United Kingdom\")","5a9dd7a8":"# Genres\nfrom sklearn.preprocessing import MultiLabelBinarizer \n\nimport matplotlib.colors\n\n\n# Custom colour map based on Netflix palette\ncmap = matplotlib.colors.LinearSegmentedColormap.from_list(\"\", ['#221f1f', '#b20710','#f5f5f1'])\n\n\n\ndef genre_heatmap(df, title):\n    df['genre'] = df['listed_in'].apply(lambda x :  x.replace(' ,',',').replace(', ',',').split(',')) \n    Types = []\n    for i in df['genre']: Types += i\n    Types = set(Types)\n    print(\"There are {} types in the Netflix {} Dataset\".format(len(Types),title))    \n    test = df['genre']\n    mlb = MultiLabelBinarizer()\n    res = pd.DataFrame(mlb.fit_transform(test), columns=mlb.classes_, index=test.index)\n    corr = res.corr()\n    mask = np.zeros_like(corr, dtype=np.bool)\n    mask[np.triu_indices_from(mask)] = True\n    fig, ax = plt.subplots(figsize=(10, 7))\n    fig.text(.54,.88,'Genre correlation', fontfamily='serif',fontweight='bold',fontsize=15)\n\n    pl = sns.heatmap(corr, mask=mask, cmap=cmap, vmax=.3, vmin=-.3, center=0, square=True, linewidths=2.5)\n    \n    plt.show()","db73d265":"df_tv = df[df[\"type\"] == \"TV Show\"]\ndf_movies = df[df[\"type\"] == \"Movie\"]\n\n\ngenre_heatmap(df_movies, 'Movie')\nplt.show()","c0907179":"us_ind = df[(df['first_country'] == 'USA') | (df['first_country'] == 'India' )]\n\ndata_sub = df.groupby('first_country')['year_added'].value_counts().unstack().fillna(0).loc[['USA','India']].cumsum(axis=0).T\nfig, ax = plt.subplots(1, 1, figsize=(12, 6))\ncolor = ['#221f1f', '#b20710','#f5f5f1']\n\nfor i, hs in enumerate(us_ind['first_country'].value_counts().index):\n    hs_built = us_ind[us_ind['first_country']==hs]['year_added'].value_counts().sort_index()\n    ax.plot(hs_built.index, hs_built, color=color[i], label=hs)\n    #ax.fill_between(hs_built.index, 0, hs_built, color=color[i], alpha=0.4)\n    ax.fill_between(hs_built.index, 0, hs_built, color=color[i], label=hs)\n    \n\nax.set_ylim(0, 1000)\n#ax.legend(loc='upper left')\nfor s in ['top', 'right']:\n    ax.spines[s].set_visible(False)\n\nax.yaxis.tick_right()\n    \nax.axhline(y = 0, color = 'black', linewidth = 1.3, alpha = .4)\n\n#ax.set_ylim(0, 50)\n#ax.legend(loc='upper left')\nfor s in ['top', 'right','bottom','left']:\n    ax.spines[s].set_visible(False)\n\nax.grid(False)\nax.set_xticklabels(data_sub.index, fontfamily='serif', rotation=0)\nax.margins(x=0) # remove white spaces next to margins\n\nax.set_xlim(2008,2020)\nplt.xticks(np.arange(2008, 2021, 1))\n\nfig.text(0.13, 0.85, 'USA vs. India:', fontsize=15, fontweight='bold', fontfamily='serif')\n\n\n\nfig.text(0.13,0.15,\"India\", fontweight=\"bold\", fontfamily='serif', fontsize=15, color='#b20710')\nfig.text(0.188,0.15,\"|\", fontweight=\"bold\", fontfamily='serif', fontsize=15, color='black')\nfig.text(0.198,0.15,\"USA\", fontweight=\"bold\", fontfamily='serif', fontsize=15, color='#221f1f')\n\n\nax.tick_params(axis=u'both', which=u'both',length=0)\n\n\nplt.show()","37499f86":"# 11. Movie Genres","d7196592":"# If you found informative then UPVOTE it!!","e2186095":"# 10. StandUp Comedies on Netflix","10ba4808":"# 7. The ratings of the content ","7f67021c":"Here we see that US is major content \nproducers for Netflix, and on second\nwe have India after UK and so on.\nNetflix being a US Company, it makes \nsense that they major producers","8e66dd87":"As can we see that in 7782 and 7786 there are multi countries in a single column so what we will do is we will create another column that will store only the first country.","91ef41cf":"After that, we calculate the total occurrence of each country.","c6336546":"# 2. Growth in content over the years","ac1dad5d":"# 9. Top Actors on Netflix with Most Movies","c8987b22":"2\/3rd of the content on netflix is movies and remaining 33% of them are TV Shows.\n","e33cb3f4":"# 1. Content Type on Netflix","8b5557d5":"# 3. Original Release Year of the movies","8192f00a":"The dataset consists of meta details about the movies and tv shows such as the title, director, and cast of the shows \/ movies. Details such as the release year, the rating, duration etc. As the first step, let's load the dataset, create some new features. In this kernel, I have analysed this dataset to find top insights and findings.","a32898a8":"**I hope enjoyed reading the article. If you found it useful, please share it among your friends on social media too. For any queries and suggestions feel free to ping me here in the comments or you can directly reach me through email.**","50c05ca7":"Some of the oldest TV Shows on Netflix","c8f3b06b":"Now we will replace some of the country names with their short form.","9e496847":"## Netflix Shows and Movies - Exploratory Analysis","438d3c86":"#  Many more to go!!","fa9e1cde":"The growth in number of movies on netflix is much higher than that od TV shows. About 1497 new movies were added in both 2018 and 2019. The growth in content started from 2015. Netflix kept on adding different movies and tv shows on its platform over the years. This content was of different variety - content from different countries, content which was released over the years","9cdb395e":"# 6. TV Shows with many seasons","93c424fd":"# 5. Distribution of Movie Duration","50784dfe":"# Thanks for reading!\n","00ff828d":"# Visualizing Netflix Data Using Python!","4d1dd374":"# 4. Content from different Countries","2937574d":"# USA & India\nAs the two largest content countries, it might be fun to compare the two","5ea50d04":"We know from our work above that Netflix is dominated by the USA & India.\nIt would also be reasonable to assume that, since Netflix is an American\ncompnany, Netflix increased content first in the USA, before \nother nations. \n\nThat is exactly what we see here; a slow and then rapid\nincrease in content for the USA, followed by Netflix \nbeing launched to the Indian market in 2016.","ba774204":"# 8. The top Categories ","44418b49":"Maximum shows has only one seasons!","2dd639ca":"# 9. Top Actors on Netflix with Most TV Shows"}}