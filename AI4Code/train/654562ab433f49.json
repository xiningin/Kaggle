{"cell_type":{"80092aa1":"code","593a9aa2":"code","19b19df4":"code","c8757210":"code","778c0a9a":"code","6fad6535":"code","f3c1a075":"code","796c8114":"code","6920c66b":"code","2212187d":"code","f39fd0ba":"code","13d19d4d":"code","7007bd28":"code","2878ca7f":"code","b27863c3":"code","5a1f486e":"code","906bf97e":"code","e5d869ed":"code","1e8990a0":"markdown"},"source":{"80092aa1":"import sys, os\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport warnings\nwarnings.simplefilter(action='ignore')\nimport seaborn as sns\nplt.style.use('fivethirtyeight')\nimport pandas as pd\nimport tensorflow as tf\nimport keras\nfrom keras.models import Sequential\nfrom keras.layers import Dense, SimpleRNN, LSTM, Activation, Dropout\nimport math\nfrom sklearn.preprocessing import MinMaxScaler\nfrom sklearn.metrics import mean_squared_error\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","593a9aa2":"data = pd.read_csv('..\/input\/plastic-datasets\/global-plastics-production.csv')\nprint(data.shape)\nprint(data.head())","19b19df4":"data.isnull().sum()","c8757210":"col= ['Year', 'Global plastics production (million tonnes)']\nndata= data[col]\nndata.set_index(ndata.Year,inplace=True)\nndata.drop(columns=['Year'], inplace=True)\nndata.head()","778c0a9a":"ndata.plot()","6fad6535":"def get_keras_format_series(series):\n    \"\"\"\n    Convert a series to a numpy array of shape \n    [n_samples, time_steps, features]\n    \"\"\"\n    \n    series = np.array(series)\n    return series.reshape(series.shape[0], series.shape[1], 1)\n","f3c1a075":"mm=MinMaxScaler()\nndata= mm.fit_transform(ndata)","796c8114":"test_years= 18\ntrain = ndata[:-test_years] \ntest = ndata[-test_years:] \nprint(train.shape)\ntrain_X, train_y = [], []\nfor i in range(0, train.shape[0]-6): \n    train_X.append(train[i:i+6]) \n    train_y.append(train[i+6:i+7])\n    \ntrain_X = get_keras_format_series(train_X) \ntrain_y = np.array(train_y)\n\ninput_years=9\ntest_X_init = test[:input_years] \ntest_y = test[input_years:]\nprint(test_X_init.shape)","6920c66b":"cell_units = 50\nepochs= 3000\n    # initialize model\nmodel = Sequential() \n\nmodel.add(SimpleRNN(cell_units, input_shape=(train_X.shape[1],1)))\nmodel.add(Dense(1))\n\nmodel.compile(loss='mean_squared_error', optimizer='adam')\nmodel.fit(train_X, train_y, epochs=epochs, batch_size=64, verbose=0)","2212187d":"def predict(X_init, n_steps, model):\n    \"\"\"\n    Given an input series matching the model's expected format,\n    generates model's predictions for next n_steps in the series      \n    \"\"\"\n    \n    X_init = X_init.copy().reshape(1,-1,1)\n    preds = []\n    \n    # iteratively take current input sequence, generate next step pred,\n    # and shift input sequence forward by a step (to end with latest pred).\n    # collect preds as we go.\n    for _ in range(n_steps):\n        pred = model.predict(X_init)\n        preds.append(pred)\n        X_init[:,:-1,:] = X_init[:,1:,:] # replace first 11 values with 2nd through 12th\n        X_init[:,-1,:] = pred # replace 12th value with prediction\n    \n    preds = np.array(preds).reshape(-1,1)\n    \n    return preds\n\ndef predict_and_plot(X_init, y, model, title):\n    \"\"\"\n    Given an input series matching the model's expected format,\n    generates model's predictions for next n_steps in the series,\n    and plots these predictions against the ground truth for those steps \n    \n    arguments\n    ---------\n    X_init (array): initial sequence, must match model's input shape\n    y (array): true sequence values to predict, follow X_init\n    model (keras.models.Sequential): trained neural network\n    title (string): plot title   \n    \"\"\"\n    \n    y_preds = predict(test_X_init, n_steps=len(y), model=model) # predict through length of y\n    \n    \n    # Below ranges are to set x-axes\n    start_range = range(1, test_X_init.shape[0]+1) #starting at one through to length of test_X_init to plot X_init\n    predict_range = range(test_X_init.shape[0], test_years)  #predict range is going to be from end of X_init to length of test_hours\n    \n    #using our ranges we plot X_init\n    plt.plot(start_range, test_X_init)\n    #and test and actual preds\n    plt.plot(predict_range, test_y, color='orange')\n    plt.plot(predict_range, y_preds, color='teal', linestyle='--')\n    \n    plt.title(title)\n    plt.legend(['Initial Series','Target Series','Predictions'])","f39fd0ba":"predict_and_plot(test_X_init, test_y, model,\n                 'Global Plastic: Test and predictions')\nplt.savefig('model1.png')","13d19d4d":"model.summary()","7007bd28":"cell_units= 70\n\nmodel2 = Sequential() \n    \nmodel2.add(LSTM(cell_units, input_shape=(train_X.shape[1],1))) \n   \nmodel2.add(Dense(25))\nmodel2.add(Dense(1))\n    \nmodel2.compile(loss='mean_squared_error', optimizer='adam')\nmodel2.fit(train_X, train_y, epochs=epochs, batch_size=64, verbose=0)\n    ","2878ca7f":"predict_and_plot(test_X_init, test_y, model2, \n                 'Global Plastic: Test and predictions')","b27863c3":"model2.summary()","5a1f486e":"cell_units= 100\n\nmodel3 = Sequential() \n    \nmodel3.add(LSTM(cell_units, input_shape=(train_X.shape[1],1))) \nmodel3.add(Dropout(0.2))\nmodel3.add(Dense(25))\nmodel3.add(Dense(1))\n    \nmodel3.compile(loss='mean_squared_error', optimizer='adam')\nmodel3.fit(train_X, train_y, epochs=epochs, batch_size=64, verbose=0)\n    ","906bf97e":"\npredict_and_plot(test_X_init, test_y, model3, \n                 'Global Plastic: Test and predictions')","e5d869ed":"model3.summary()","1e8990a0":"Plastic contamination is a serious problem world wide and this study will create a model to forecast the amount of plastic in the near future. We will use Deep Learning to try and forecast plastic production. We  will use a simple recurrent neural network and a lstm model with 2 different hyperparameters and architectures."}}