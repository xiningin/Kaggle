{"cell_type":{"22861f08":"code","ddd26c6b":"code","c22f6314":"code","6ec25f36":"code","8fd4a13c":"code","ba3e8d3f":"code","8e467330":"code","88d77b2f":"code","904b099e":"code","92a0a74c":"code","e55ec91d":"code","500b9e22":"markdown"},"source":{"22861f08":"pip install -U lightautoml","ddd26c6b":"import logging\nimport os\nimport time\nimport requests\n\nlogging.basicConfig(format='[%(asctime)s] (%(levelname)s): %(message)s', level=logging.INFO)\n\nimport numpy as np\nimport pandas as pd\nimport multiprocessing as mp\nfrom sklearn.metrics import mean_absolute_error\nimport torch\n\nfrom lightautoml.automl.presets.tabular_presets import TabularAutoML, TabularUtilizedAutoML\nfrom lightautoml.tasks import Task","c22f6314":"N_THREADS = mp.cpu_count()  \nN_FOLDS = 10  # \u0431\u043e\u043b\u044c\u0448\u0435 \u0444\u043e\u043b\u0434\u043e\u0432\nRANDOM_STATE = 42  \nTEST_SIZE = 0.2  \nTIMEOUT = 1200  \nTARGET_NAME = 'final_price'  ","6ec25f36":"train_data = pd.read_csv('..\/input\/lightautomlcourse-hw1\/train_data.csv')\ntrain_data.head()","8fd4a13c":"test_data = pd.read_csv('..\/input\/lightautomlcourse-hw1\/test_data.csv')\ntest_data.head()","ba3e8d3f":"roles = {\n    'target': TARGET_NAME,\n    'drop': ['row_ID'],\n    'category': ['vehicle_manufacturer', 'vehicle_model', 'vehicle_category', 'vehicle_year', 'doors_cnt', 'wheels',\n                 'vehicle_color', 'vehicle_interior_color'] #\u0432\u0440\u0443\u0447\u043d\u0443\u044e \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u043c \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438\n}","8e467330":"task = Task('reg', loss='mae', metric='mae')\nautoml = TabularAutoML(task=task,\n                       timeout=TIMEOUT,\n                       cpu_limit=N_THREADS,\n                       reader_params={'cv': N_FOLDS,\n                                      'random_state': RANDOM_STATE,\n                                      'n_jobs': N_THREADS})\noof_pred = automl.fit_predict(train_data, roles=roles)\nlogging.info('oof_pred:\\n{}\\nShape = {}'.format(oof_pred, oof_pred.shape))","88d77b2f":"fast_fi = automl.get_feature_scores('fast', silent=False)\nfast_fi.set_index('Feature')['Importance'].plot.bar(figsize=(20, 10), grid=True)","904b099e":"test_pred = automl.predict(test_data)\nlogging.info('Prediction for test data:\\n{}\\nShape = {}'\n             .format(test_pred, test_pred.shape))\n\nlogging.info('Check scores...')\nlogging.info('OOF score: {}'.format(mean_absolute_error(train_data[TARGET_NAME].values, oof_pred.data[:, 0])))","92a0a74c":"submission = pd.read_csv('..\/input\/lightautomlcourse-hw1\/sample_submission.csv')\nsubmission[TARGET_NAME] = test_pred.data[:, 0]\nsubmission.head()","e55ec91d":"submission.to_csv('lightautoml_sample_submission.csv', index = False)","500b9e22":"mae - 1557.23175"}}