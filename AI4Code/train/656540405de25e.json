{"cell_type":{"e678b7ba":"code","7f7ca19e":"code","c31498b8":"code","fcf9a40a":"code","da4e70a2":"code","03577d3f":"code","f9a3b9fb":"code","47428f32":"code","b1ce09cb":"code","3269ed2e":"code","a2702f5d":"code","44c621b3":"code","43c33bf4":"markdown","3359a988":"markdown","54a2bfa9":"markdown","c81a918a":"markdown","5ac681e2":"markdown","b56db773":"markdown","5ff82b98":"markdown","d7b0404e":"markdown","c4fa3d43":"markdown"},"source":{"e678b7ba":"import pandas as pd\nimport numpy as np\n\nfrom bokeh.io import output_notebook, show\nfrom bokeh.io import output_notebook, show\nfrom bokeh.palettes import brewer, Spectral, Viridis3, Viridis256, d3\nfrom bokeh.plotting import figure\nfrom bokeh.models import ColumnDataSource, BasicTicker, ColorBar, LinearColorMapper\nfrom bokeh.transform import cumsum, factor_cmap, transform, jitter\n\nfrom math import pi\n\noutput_notebook()","7f7ca19e":"df = pd.read_csv('..\/input\/madrid-airbnb-data\/listings.csv')","c31498b8":"df.head()","fcf9a40a":"corrmat = df.corr()\n\ncorrmat.index.name = 'AllColumns1'\ncorrmat.columns.name = 'AllColumns2'\n\n# Prepare data.frame in the right format\ncorrmat = corrmat.stack().rename(\"value\").reset_index()\n\n\n# I am using 'Viridis256' to map colors with value, change it with 'colors' if you need some specific colors\nmapper = LinearColorMapper(\n    palette=Viridis256, low=corrmat.value.min(), high=corrmat.value.max())\n\n# Define a figure and tools\nTOOLS = \"box_select,lasso_select,pan,wheel_zoom,box_zoom,reset,help, hover\"\np = figure(\n    tools=TOOLS,\n    tooltips=\"@value\",\n    plot_width=900,\n    plot_height=700,\n    title=\"Correlation plot\",\n    x_range=list(corrmat.AllColumns1.drop_duplicates()),\n    y_range=list(corrmat.AllColumns2.drop_duplicates()),\n    toolbar_location=\"right\",\n    x_axis_location=\"below\")\n\n# Create rectangle for heatmap\np.rect(\n    x=\"AllColumns1\",\n    y=\"AllColumns2\",\n    width=1,\n    height=1,\n    source=ColumnDataSource(corrmat),\n    line_color=None,\n    fill_color=transform('value', mapper))\n\n# Add legend\ncolor_bar = ColorBar(\n    color_mapper=mapper,\n    location=(0, 0),\n    ticker=BasicTicker(desired_num_ticks=10))\n\np.xaxis.major_label_orientation = \"vertical\"\n\np.add_layout(color_bar, 'right')\n\nshow(p)","da4e70a2":"#Preparing data for pie Chart\nroom = pd.DataFrame(df.room_type.value_counts())\nroom.reset_index(inplace=True)\nroom.rename(columns={'index':'room_type', 'room_type':'count'}, inplace = True)\nroom['angle'] = room['count']\/room['count'].sum() * 2*pi\nroom['color'] = brewer['Spectral'][len(room)]\nroom = room.to_dict('list')","03577d3f":"#Plot a pie chart\nsource = ColumnDataSource(room)\n\np = figure(plot_height=400, title=\"Pie Chart on Room Types\", toolbar_location=None,\n           tools=\"hover\", tooltips=\"@room_type: @count\", x_range=(-0.5, 1.0))\n\np.wedge(x=0, y=1, radius=0.4,\n        start_angle=cumsum('angle', include_zero=True), end_angle=cumsum('angle'),\n        line_color=\"white\", fill_color='color', legend_field='room_type', source=source)\n\np.axis.axis_label=None\np.axis.visible=False\np.grid.grid_line_color = None\n\nshow(p)","f9a3b9fb":"#Preparing data\ndata = df[['room_type','price']]\ncats = list(df.room_type.unique())","47428f32":"#Plot a scatter plot\nsource = ColumnDataSource(data)\n\np = figure(plot_width=850, plot_height=400, y_range=cats, title=\"Price\")\n\np.circle(x='price', y=jitter('room_type', width=0.3, range=p.y_range),  source=source, alpha=0.3)\n\np.x_range.start = 0\np.x_range.end = 10100\n\np.x_range.range_padding = 0\np.ygrid.grid_line_color = None\n\nshow(p)","b1ce09cb":"#Preparing data for bar chart\nhost = pd.DataFrame(df.host_id.value_counts()[:10])\nhost.reset_index(inplace=True)\nhost.rename(columns={'index':'host_id', 'host_id':'count'}, inplace = True)\nhost.host_id = host.host_id.astype(str)\nhost_id = host['host_id'].to_list()\ncount = host['count'].to_list()","3269ed2e":"#Plot a bar chart\nsource = ColumnDataSource(data=dict(host_id=host_id, count=count))\n\np = figure(x_range=host_id, plot_height=350, plot_width=850 , toolbar_location=None, \n           tools=\"hover\", tooltips=\"@host_id: @count\", title=\"Top 10 Host\")\np.vbar(x='host_id', top='count', width=0.9, source=source, line_color='white', \n       fill_color=factor_cmap('host_id', palette=brewer['Set3'][len(count)], factors=host_id))\n\np.xgrid.grid_line_color = None\n\n#Defining y axis range\np.y_range.start = 0\np.y_range.end = 300\n\n#Adding axis label\np.xaxis.axis_label = 'Host ID'\np.yaxis.axis_label = 'Number of Listing'\n\nshow(p)\n","a2702f5d":"#Preparing data for lollipop chart\nnbh = pd.DataFrame(df.neighbourhood_group.value_counts())\nnbh.reset_index(inplace=True)\nnbh.rename(columns={'index':'neighbourhood_group', 'neighbourhood_group':'count'}, inplace = True)\nneighbourhood_group = nbh['neighbourhood_group'].to_list()\ncount = nbh['count'].to_list()","44c621b3":"#Plot a lollipop chart\ndot = figure(title=\"Neighbourhood\",\n             toolbar_location=None, y_range=neighbourhood_group, x_range=[0,10000])\n\ndot.segment(0, neighbourhood_group, count, neighbourhood_group, line_width=2, line_color=\"green\", )\ndot.circle(count, neighbourhood_group, size=15, fill_color=\"orange\",\n           line_color=\"green\", line_width=3, )\n\n#Defining x axis range\ndot.x_range.start = 0\ndot.x_range.end = 10500\n\n#Defining graph width & height\ndot.plot_width=850\ndot.plot_height=500\n\n#Defining y axis label font\n#dot.xaxis.axis_label_text_font_size = \"40pt\"\n\nshow(dot)","43c33bf4":"## Libraries Used","3359a988":"## Type of Graph \n\n1. Correlation Plot\n\n2. Pie Chart\n\n3. Scatter Plot\n\n4. Bar Chart\n\n5. Lollipop Chart","54a2bfa9":"## Correlation Plot","c81a918a":"## Scatter Plot: What is the price distribution for each room type?","5ac681e2":"# Data Visualization with Bokeh","b56db773":"## Lollipop Chart: Which neighbourhood has the most listings?","5ff82b98":"## Loading Dataset","d7b0404e":"## Bar Chart: Which host has the most listings in Madrid?","c4fa3d43":"## Pie Chart: What's the most common room type that Airbnb provides?"}}