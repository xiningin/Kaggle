{"cell_type":{"458cbebc":"code","ff0aaf04":"code","66aa600c":"code","1f597d6f":"code","cf9b6dbc":"code","6fd8ae46":"code","6ca8dcc4":"code","b0add028":"code","76c8a813":"code","ee3ed9ba":"code","38294ca1":"code","008756d3":"markdown","ea256d95":"markdown","f68d96fd":"markdown","a1e9bb12":"markdown","190a7b67":"markdown","476ddcd0":"markdown","54b46162":"markdown","bb0faf48":"markdown","688373e3":"markdown","49d7e7e0":"markdown","d0d84425":"markdown","9abe7cde":"markdown","df8ba380":"markdown","2b37c8b3":"markdown","c2dc2256":"markdown","09a70075":"markdown","6ca09838":"markdown","12eca0fc":"markdown","d6e54c70":"markdown"},"source":{"458cbebc":"import numpy as np\nimport pandas as pd\nimport tensorflow as tf \nfrom tensorflow.keras.preprocessing.image import ImageDataGenerator\nfrom tensorflow.keras.models import Sequential\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom tensorflow.keras.preprocessing.image import ImageDataGenerator , load_img ,img_to_array\nfrom tensorflow.keras.models import Sequential\nfrom tensorflow.keras.layers import Activation, Dropout, Flatten, Dense, Conv2D, MaxPooling2D\nfrom tensorflow.keras.callbacks import EarlyStopping\nfrom sklearn.metrics import classification_report,confusion_matrix\nfrom tensorflow.keras.preprocessing import image ","ff0aaf04":"\ntrain_gen = ImageDataGenerator(rescale=1\/255,\n               horizontal_flip=True,\n               zoom_range=0.2,\n               shear_range=0.2   )\ntrain_data = train_gen.flow_from_directory('..\/input\/real-life-industrial-dataset-of-casting-product\/casting_data\/casting_data\/train',\n                                          class_mode='binary',\n                                          batch_size=8,\n                                          target_size=(64,64),\n                                          color_mode='grayscale')\ntest_gen = ImageDataGenerator(rescale=1\/255)\ntest_data = test_gen.flow_from_directory('..\/input\/real-life-industrial-dataset-of-casting-product\/casting_data\/casting_data\/test',\n                                        class_mode='binary',\n                                        batch_size=8,\n                                        target_size=(64,64),\n                                        color_mode='grayscale')","66aa600c":"\n\nmodel = tf.keras.models.Sequential()\n#convolution+pooling\nmodel.add(tf.keras.layers.Conv2D(filters=8,kernel_size=(3,3),activation='relu',padding='same',input_shape=(64,64,1)))\nmodel.add(tf.keras.layers.MaxPooling2D(pool_size=(2,2),strides=2))\n#second layer\nmodel.add(tf.keras.layers.Conv2D(filters=8,kernel_size=(3,3),activation='relu',padding='same'))\nmodel.add(tf.keras.layers.MaxPooling2D(pool_size=(2,2),strides=2))\n\nmodel.add(tf.keras.layers.Flatten())  #flattening the image into 1d array\n\n\n#creating nueral network \nmodel.add(tf.keras.layers.Dense(units=128,activation='relu'))\nmodel.add(tf.keras.layers.Dense(units=128,activation='relu')) \nmodel.add(tf.keras.layers.Dense(units=1,activation='sigmoid'))                                  \n                               \n                                 ","1f597d6f":"\n\nmodel.compile(optimizer='adam',loss='binary_crossentropy',metrics=['accuracy'])","cf9b6dbc":"model.fit_generator(train_data,validation_data=test_data,epochs=10)","6fd8ae46":" model.save('best_model.h5')","6ca8dcc4":"\ntest_image = image.load_img('..\/input\/real-life-industrial-dataset-of-casting-product\/casting_data\/casting_data\/test\/ok_front\/cast_ok_0_1002.jpeg',target_size=(64,64),color_mode='grayscale')\ntest_image = image.img_to_array(test_image)\ntest_image = test_image\/255\ntest_image = np.expand_dims(test_image,axis=0)\nresult = model.predict(test_image)","b0add028":"result","76c8a813":"if result[0]<=0.5:\n    print('Defective')\nelse :\n    print('Not Defective')","ee3ed9ba":"\nimport cv2\nimg = cv2.imread('..\/input\/real-life-industrial-dataset-of-casting-product\/casting_data\/casting_data\/test\/ok_front\/cast_ok_0_1002.jpeg',0)\nimg = img\/255 #rescalinng\npred_img =img.copy()","38294ca1":"plt.figure(figsize=(12,8))\nplt.imshow(img,cmap='gray')\nplt.show()","008756d3":"The ImageDataGenerator class in Keras provides a variety of transformations such as flipping, normalizing, etc. However, it becomes difficult to apply custom transformations that are not available in Keras. In our particular example, we will apply a denoising algorithm as a pre-processing transformation to our dataset.","ea256d95":"In the era of the so called 4th\nindustrial revolution, the\nFactory of the Future and the\nIndustrial Internet of Things,\nthe industrial mechanical\nsystems become continuously\nmore intelligent and more\ncomplex. Therefore, there is a\nclear need for research and\ndevelopment on data driven\nmethodologies and condition\nmonitoring techniques which\nare able to achieve fast,\nreliable and high-quality\ndiagnosis in an automatic\nmanner","f68d96fd":"# PREDICTION","a1e9bb12":"**ImageDatagenerator**","190a7b67":"**Import the relevant libraries**","476ddcd0":"In deep learning, a convolutional neural network (CNN, or ConvNet) is a class of deep neural networks, most commonly applied to analyzing visual imagery. They are also known as shift invariant or space invariant artificial neural networks (SIANN), based on their shared-weights architecture and translation invariance characteristics. They have applications in image and video recognition, recommender systems, image classification, medical image analysis, natural language processing, brain-computer interfaces, and financial time serie","54b46162":"visualization of the result","bb0faf48":"# MODEL","688373e3":"predicting a single image from test dataset ","49d7e7e0":"# TRAINING","d0d84425":"steps involved \n\n1 Convolution\n\n2 Pooling\n\n3 Flattening the image into 1D array\n\n4 Nueral net\n","9abe7cde":"Here we use top view  images of submersible pump impeller to find casting defects (you can you any mechanical device images as  the dataset)\n\n\ncredits for the dataset : https:\/\/www.kaggle.com\/ravirajsinh45\/real-life-industrial-dataset-of-casting-product","df8ba380":"+ Early and accurate detection of defects and failures of such components of\nrotating machinery is critical to ensure operational reliability and avoid catastrophic\naccidents in industrial applications","2b37c8b3":"# Mechanical Fault Diagnosis using CNN","c2dc2256":"![](https:\/\/www.taiwantrade.com\/seo\/img\/smart_mechanic\/Smart_Manufacturing_and_Mechanical_Systems_Apart.jpg)","09a70075":"# Feature scaling","6ca09838":"+ Rotating machines are widely used in manufacturing industry, operating usually\nfor long time under harsh conditions. Sudden failures occurring on key machine\ncomponents such as gears and bearings may lead to unexpected breakdown of\nmachines and cause economic loss, environmental pollution and human casualties","12eca0fc":"Training the model to get an output with good accuracy\n","d6e54c70":"Saving the model"}}