{"cell_type":{"48ff922d":"code","ecf791f0":"code","95db8fff":"code","3206e04a":"code","37e6a580":"code","d88d421d":"code","94b0941f":"code","9b94098a":"code","8abcf5c3":"code","6396e0bf":"code","3d1f94a9":"code","8b6695db":"code","3a60ca55":"markdown","1bc80c69":"markdown","847c8e2e":"markdown","00deaebc":"markdown"},"source":{"48ff922d":"import os\nimport sys \n\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.impute import SimpleImputer\nfrom sklearn.compose import ColumnTransformer\nfrom sklearn.preprocessing import OneHotEncoder\nfrom sklearn.preprocessing import MinMaxScaler\n\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import RandomForestClassifier\n\nfrom sklearn.model_selection import cross_val_score, GridSearchCV\n\nfrom sklearn.metrics import confusion_matrix, classification_report, roc_auc_score","ecf791f0":"path = '..\/input\/home-credit-default-risk\/'\ntrain = pd.read_csv(path + \"\/application_train.csv\")\ntest = pd.read_csv(path + \"\/application_test.csv\")","95db8fff":"train.head().T","3206e04a":"print('Training set shape:', train.shape)\nprint('Test set shape:    ', test.shape)","37e6a580":"train.TARGET.value_counts() \/ len(train)","d88d421d":"int_features = train.iloc[:, 2:].select_dtypes('int64').columns.values\nfloat_features = train.iloc[:, 2:].select_dtypes('float').columns.values\nstr_features = train.iloc[:, 2:].select_dtypes('O').columns.values\n\nprint(len(int_features))\nprint(len(float_features))\nprint(len(str_features))","94b0941f":"num_features = np.hstack([int_features, float_features])\ncat_features = str_features\nfeatures = np.hstack([num_features, cat_features])\n\n\nnum_transformer = Pipeline(\n    steps = [\n        ('imputer', SimpleImputer(strategy='mean')),\n        ('scaler', MinMaxScaler())  \n    ]\n)\n\ncat_transformer = Pipeline(\n    steps = [\n        ('imputer', SimpleImputer(strategy='constant', fill_value='missing')),\n        ('onehot', OneHotEncoder(handle_unknown='ignore', sparse=True))\n    ]\n)\n\npreprocessor = ColumnTransformer(\n    transformers = [\n        ('num', num_transformer, num_features),\n        ('cat', cat_transformer, cat_features)\n    ], \n    sparse_threshold=0.9\n)","9b94098a":"%%time\npreprocessor.fit(train[features])\nX_train = preprocessor.transform(train[features])\nX_test = preprocessor.transform(test[features])\n\ny_train = train.TARGET.values\n\nprint('X_train shape:', X_train.shape)\nprint('y_train shape:', y_train.shape)\nprint('X_test shape: ', X_test.shape)","8abcf5c3":"%%time\nlr_mod = LogisticRegression(C=10, solver='liblinear')\nlr_mod.fit(X_train, y_train)\n\nprint('Training Acc:', lr_mod.score(X_train, y_train))\nprint('Training AUC:', roc_auc_score(y_train, lr_mod.predict_proba(X_train)[:,1]))","6396e0bf":"submission = pd.read_csv('..\/input\/home-credit-default-risk\/sample_submission.csv')\nsubmission.head()","3d1f94a9":"submission['TARGET'] = lr_mod.predict_proba(X_test)[:,1]\nsubmission.head()","8b6695db":"submission.to_csv('my_submission.csv', index=False)","3a60ca55":"## Import Packages","1bc80c69":"## Logistic Regression","847c8e2e":"## Create Submission","00deaebc":"## Preprocessing"}}