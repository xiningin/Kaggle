{"cell_type":{"97017656":"code","1176f6ea":"code","69b78d50":"code","0a77f872":"code","96b7dca0":"code","bbf25ce8":"code","604479d6":"code","973736ff":"code","0018e6c1":"code","4047eb64":"code","c8c1d37e":"code","7d0c59dd":"code","e2728a0e":"code","30691c7c":"code","4b7b397c":"code","98cfaf59":"code","79ddeae2":"code","f23189e2":"code","58b04983":"code","d4049790":"code","d1993407":"code","15893ea6":"code","1ebe9fcc":"code","0ea50d8e":"code","91477729":"code","9ad0a5b8":"code","3d2f0881":"code","faf1643f":"code","684d34c6":"code","38d553ba":"code","b14bf24e":"code","f5c91a4f":"code","85f749a5":"code","41d9d701":"code","98b76678":"code","15c3e522":"code","828afa4e":"code","247a6c44":"code","cf7ce004":"code","8f6b13ba":"code","0aab33e0":"code","77ccf1c1":"code","fcdf29b6":"code","84ade81a":"code","a57618de":"code","86a01922":"code","14a1d55e":"code","3c8d7b4b":"code","6569088f":"code","158c4d09":"code","f6b9ca6f":"code","d6b89f49":"code","66f2102f":"code","ca0b61e6":"code","305042a5":"code","7333ed33":"markdown","0b9f30c7":"markdown","0343e307":"markdown","4d063bf2":"markdown","07e6554b":"markdown","cbad8a4f":"markdown","805fa849":"markdown"},"source":{"97017656":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport seaborn as sn\nimport sklearn\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.metrics import confusion_matrix, classification_report\nfrom sklearn.model_selection import train_test_split\nfrom scipy.stats import zscore\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.model_selection import GridSearchCV\nfrom sklearn.linear_model import LinearRegression, Ridge, Lasso\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.svm import SVR\nfrom sklearn.metrics import r2_score,mean_squared_error\nimport warnings\nwarnings.filterwarnings('ignore')","1176f6ea":"df= pd.read_csv('..\/input\/advertising-sales-dataset\/advertising.csv')\ndf.head()","69b78d50":"df","0a77f872":"df.head()","96b7dca0":"df.tail(7)","bbf25ce8":"df.shape","604479d6":"df.isnull().sum()","973736ff":"df.dtypes","0018e6c1":"df.describe()","4047eb64":"df.info()","c8c1d37e":"sns.distplot(df[\"Sales\"])","7d0c59dd":"sns.distplot(df[\"TV\"])","e2728a0e":"sns.distplot(df[\"Newspaper\"])","30691c7c":"sns.distplot(df[\"Radio\"])","4b7b397c":"plt.figure(figsize=[10,6])\nplt.title(\"Relation between TV and SALES\")\nsn.scatterplot(df['TV'],df[\"Sales\"]);","98cfaf59":"plt.figure(figsize=[10,7])\nplt.title(\"Relationship between radio Advertising and Sales\")\nsn.scatterplot(df[\"Radio\"],df[\"Sales\"])","79ddeae2":"plt.figure(figsize=[10,8])\nplt.title(\"Relationship between Newspaper Advertising and Sales\")\nsn.scatterplot(df['Newspaper'],df['Sales'])","f23189e2":"plt.figure(figsize=[10,10])\nplt.title(\"Relationship between Newspaper Advertising and Sales\")\nsn.scatterplot(df[\"Newspaper\"],df[\"Sales\"])","58b04983":"corr_mat = df.corr()","d4049790":"corr_mat","d1993407":"plt.figure(figsize=[22,12])\nsns.heatmap(corr_mat,annot=True)\nplt.title(\"Correlation Matrix\")\nplt.show()","15893ea6":"sns.heatmap(corr_mat,annot=True,linewidths=6,linecolor='r')","1ebe9fcc":"corr_mat[\"Sales\"].sort_values(ascending=False)","0ea50d8e":"plt.figure(figsize=(22,7))\ndf.corr()['Sales'].sort_values(ascending=False).drop(['Sales']).plot(kind='bar',color='c')\nplt.xlabel('Feature',fontsize=14)\nplt.ylabel('column with target names',fontsize=14)\nplt.title('correlation',fontsize=18)\nplt.show()","91477729":"x = df.drop(\"Sales\",axis=1)\ny = df[\"Sales\"]","9ad0a5b8":"x","3d2f0881":"y","faf1643f":"x.skew()","684d34c6":"from sklearn.preprocessing import power_transform\ndf_skew = power_transform(x)\n\ndf_skew = pd.DataFrame(df_skew, columns=x.columns)","38d553ba":"df_skew.skew()","b14bf24e":"df = df_skew","f5c91a4f":"x = df_skew","85f749a5":"x.boxplot(figsize=[20,8])\nplt.subplots_adjust(bottom=0.25)\nplt.show()","41d9d701":"df[\"TV\"].plot.box()","98b76678":"df[\"Radio\"].plot.box()","15c3e522":"df[\"Newspaper\"].plot.box()","828afa4e":"from scipy.stats import zscore\nz = np.abs(zscore(df_skew))\ndf_outlier = df_skew[(z<3).all(axis=1)]","247a6c44":"df_outlier.shape","cf7ce004":"df.shape","8f6b13ba":"from sklearn.preprocessing import StandardScaler\nSC=StandardScaler()\nx=SC.fit_transform(x)\nx","0aab33e0":"x_train, x_test, y_train, y_test = train_test_split(x,y, test_size = 0.20, random_state=100)","77ccf1c1":"lr = LinearRegression()\nlr.fit(x_train,y_train)\npredlr = lr.predict(x_test)\nprint(r2_score(y_test,predlr))\nprint(mean_squared_error(y_test,predlr))\nprint(np.sqrt(mean_squared_error(y_test,predlr)))","fcdf29b6":"lrcv = cross_val_score(lr,x,y,cv=5)\nprint('Cross validation score for Linear Regression Model is ',lrcv.mean())","84ade81a":"r = Ridge()\nr.fit(x_train,y_train)\npredr = r.predict(x_test)\nprint(r2_score(y_test,predr))\nprint(mean_squared_error(y_test,predr))\nprint(np.sqrt(mean_squared_error(y_test,predr)))","a57618de":"scr = cross_val_score(r,x,y,cv=5)\nprint('Cross validation score for Ridge Regression Model is', scr.mean())","86a01922":"l = Lasso()\nl.fit(x_train,y_train)\npredl = l.predict(x_test)\nprint(r2_score(y_test,predl))\nprint(mean_squared_error(y_test,predl))\nprint(np.sqrt(mean_squared_error(y_test,predl)))","14a1d55e":"scr = cross_val_score(l,x,y,cv=5)\nprint('Cross validation score for Lasso Regression Model is ', scr.mean())","3c8d7b4b":"rf = RandomForestRegressor()\nrf.fit(x_train,y_train)\npredrf = rf.predict(x_test)\nprint(r2_score(y_test,predrf))\nprint(mean_squared_error(y_test,predrf))\nprint(np.sqrt(mean_squared_error(y_test,predrf)))","6569088f":"scr = cross_val_score(rf,x,y,cv=5)\nprint('Cross validation score for Random Forest Regressor Model is', scr.mean())","158c4d09":"parameters1 = {'alpha': [4.0, 5.0, 6.0, 7.0, 8.0, 10.0],\n             'random_state': [200, 700, 900],\n             'max_iter': [200, 900],\n             'selection': ['cyclic','random']}","f6b9ca6f":"GCV=GridSearchCV(Lasso(),parameters1,cv=5)","d6b89f49":"GCV.fit(x_train,y_train)","66f2102f":"GCV.best_params_","ca0b61e6":"mod1=Lasso(alpha=4.0,random_state=200,selection='cyclic',max_iter=200)\n\nmod1.fit(x_train,y_train)\npred=mod1.predict(x_test)\nprint(r2_score(y_test,predrf)*100)\nprint(mean_squared_error(y_test,predrf))\nprint(np.sqrt(mean_squared_error(y_test,predrf)))","305042a5":"import joblib\njoblib.dump(mod1,\"Advertising_Sales_Lasso.pkl\")","7333ed33":"Checking the Correlation between the target value and rest columns using Heatmap, Correlation Matrix.\n\nUpon review, found TV, radio are highly correlated with sales data which coincides with the graphical data analysis done in above steps","0b9f30c7":"Checking for the Skewness and found newspaper has more skewness as predicted by distplot analysis\n","0343e307":"### Upon reviewing above plot, newspaper advertising has high effect on sales positively at initial. However, as advertising is increased, it has low effect on sales and almost nil at max\n\nTV advertising has higher positive impact on sales and followed by radio. So TV and radio will have higher correlation with sales","4d063bf2":"Checking Skewness after power transforms and found all columns skewness is within range of -0.5 to +0.5\n","07e6554b":"There is no Data loss since no outliers were present in box plot\n","cbad8a4f":"model saved","805fa849":"TV Advertising increases the sales high which is followed by Radio Advertising\n\n"}}