{"cell_type":{"74a8baec":"code","a636a35a":"code","6ed0316a":"code","d9fdbc32":"code","730f9070":"code","d31225d4":"code","5ec6adf1":"code","dba0a88d":"code","5b0dc3f7":"code","ce4a69ad":"code","df5e99e9":"code","a0a79459":"code","22e0f411":"code","8c519f64":"code","d3869975":"code","8c89d1d1":"code","157b90bf":"code","6f95c87e":"code","7f67a456":"code","f7023948":"code","3470116a":"code","be4d2e19":"code","7000a2a3":"code","09d4ee7c":"code","743a55c9":"code","20e26b89":"code","0e317e24":"code","364811aa":"code","bad5705f":"code","94f094ad":"code","2839290b":"code","d99e3e9f":"code","ac546ff4":"code","5e57b862":"code","dca30a8a":"code","893f7195":"code","701db72b":"code","2a1b5700":"code","08270980":"code","cdd90fd8":"code","36d37dad":"code","700f11d6":"code","85ef4a41":"code","0646245b":"code","becb9f90":"code","ff5eebe6":"code","4f5129c9":"code","2624a8be":"code","87722523":"code","74404a5f":"code","b431dc64":"markdown"},"source":{"74a8baec":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","a636a35a":"data=pd.read_csv(\"\/kaggle\/input\/travel-insurance\/travel insurance.csv\")\ndata.head()","6ed0316a":"import seaborn as sns\nfrom sklearn.compose import make_column_transformer\nfrom sklearn.preprocessing import LabelEncoder,OneHotEncoder,OrdinalEncoder,StandardScaler\nfrom sklearn.pipeline import make_pipeline\nfrom sklearn import set_config\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import accuracy_score,plot_confusion_matrix\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.svm import SVC","d9fdbc32":"data.columns","730f9070":"data.Claim.unique()","d31225d4":"data.Claim.value_counts()","5ec6adf1":"data.isnull().sum()","dba0a88d":"data.Gender=data.Gender.fillna(\"default\")\ndata.isnull().sum()","5b0dc3f7":"data","ce4a69ad":"sns.distplot(data.Age)","df5e99e9":"sns.pairplot(data,hue=\"Claim\")","a0a79459":"import matplotlib.pyplot as plt\nplt.figure(figsize=(20,20))\nsns.heatmap(data.corr(),annot=True)","22e0f411":"num_cols=data.select_dtypes(include=['int',float])\nnum_cols","8c519f64":"data.select_dtypes(exclude=('int',float))","d3869975":"sns.boxplot(data.Age)","8c89d1d1":"x=data.drop(columns=['Claim'])\ny=data[['Claim']]\nx.head()","157b90bf":"y.head()","6f95c87e":"x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=0.3,random_state=50)","7f67a456":"x_train.head()","f7023948":"data.Gender.unique()","3470116a":"le=LabelEncoder()\ny[['Claim']]=pd.DataFrame(le.fit_transform(y[['Claim']]))\ny.head()","be4d2e19":"nom_col=[0,1,3,5,8]\nord_col=[2]\n\n","7000a2a3":"x_train","09d4ee7c":"import pandas as pd\npd.get_dummies(data.loc[:,nom_col],drop_first=True)","743a55c9":"trans_data=make_column_transformer((OneHotEncoder(sparse=False,handle_unknown='ignore'),[0,1,3,5,8]),\n                                   (OrdinalEncoder(),[2]),\n                                   remainder='passthrough')","20e26b89":"xp = trans_data.fit_transform(x_train)\nxp","0e317e24":"model=LogisticRegression(solver='liblinear')\n","364811aa":"set_config(display='diagram')\npipe=make_pipeline(trans_data,model)\npipe","bad5705f":"pipe.fit(x_train,y_train)","94f094ad":"pred=pipe.predict(x_test)","2839290b":"accuracy_score(pred,y_test)*100","d99e3e9f":"trans_data.fit_transform(x)","ac546ff4":"model","5e57b862":"from sklearn.neighbors import KNeighborsClassifier\nmodel=KNeighborsClassifier(n_neighbors=5)","dca30a8a":"set_config(display='diagram')\npipe=make_pipeline(trans_data,model)\npipe","893f7195":"pipe.fit(x_train,y_train)","701db72b":"pred=pipe.predict(x_test)","2a1b5700":"accuracy_score(pred,y_test)*100\n","08270980":"trans_data.fit_transform(x_train)","cdd90fd8":"model=KNeighborsClassifier(n_neighbors=5)","36d37dad":"from sklearn.model_selection import KFold,StratifiedKFold,cross_val_score\nS=StratifiedKFold(n_splits=5)\nnp.mean(cross_val_score(pipe,x,y,cv=5,scoring='accuracy'))*100\n","700f11d6":"sns.countplot(data.Claim)","85ef4a41":"data.Claim.value_counts()","0646245b":"from imblearn.under_sampling import RandomUnderSampler\nunder=RandomUnderSampler()\nx_u,y_u=under.fit_resample(x,y)\nsns.countplot(y_u.Claim)","becb9f90":"y_u.Claim.value_counts()","ff5eebe6":"from imblearn.over_sampling import RandomOverSampler\nover=RandomOverSampler()\nx_o,y_o=over.fit_resample(x,y)\nsns.countplot(y_o.Claim)","4f5129c9":"y_o.Claim.value_counts()\n","2624a8be":"from imblearn.over_sampling import SMOTE\nsmote=SMOTE()\n\nx_s,y_s=smote.fit_resample(trans_data.fit_transform(x),y)\nsns.countplot(y_s.Claim)","87722523":"x_s","74404a5f":"from imblearn.pipeline import make_pipeline\np=make_pipeline(trans_data,model)\ns=StratifiedKFold(n_splits=5)\nnp.mean(cross_val_score(p,trans_data.transform(x_s),y_s,cv=5,scoring=\"accuracy\")*100)","b431dc64":"data=pd.read_csv(\"\/kaggle\/input\/travel-insurance\/travel insurance.csv\")\ndata.head()"}}