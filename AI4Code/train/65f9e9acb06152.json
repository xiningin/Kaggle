{"cell_type":{"c5ea752e":"code","d785665e":"code","97f324ca":"code","b3dd4ef6":"code","9902308e":"code","a936071b":"code","baa20dd4":"code","8c6e13f6":"code","2bf64031":"code","459491a1":"code","53677f53":"code","3ce26de5":"code","438f5b49":"code","af664115":"code","6092f712":"code","579fbbdf":"code","7bf92817":"code","c989d723":"code","e39fd28c":"markdown","a43f5614":"markdown","0e2bcce9":"markdown","1f5b94f3":"markdown","705d8f69":"markdown"},"source":{"c5ea752e":"#import library\nimport numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport math\nimport matplotlib.pyplot as plt\nfrom sklearn.linear_model import LinearRegression\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import accuracy_score, mean_squared_error","d785665e":"alcohol = pd.read_csv('..\/input\/alcohol-consumption\/drinks.csv')","97f324ca":"alcohol.shape","b3dd4ef6":"alcohol.head()","9902308e":"alcohol.describe()","a936071b":"alcohol.info()","baa20dd4":"#handling missing value\nalcohol.isnull().sum()","8c6e13f6":"#heatmap correlation\nplt.figure(figsize = (12,9))\nsns.heatmap(alcohol.corr(), vmax = 0.9, square = True)","2bf64031":"df = pd.get_dummies(alcohol, drop_first = True)\ndf.head()","459491a1":"#split data\nX = df.drop('total_litres_of_pure_alcohol', axis = 1)\ny = df['total_litres_of_pure_alcohol']\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.3, random_state = 1)\nprint(X_train.shape)\nprint(y_train.shape)\nprint(X_test.shape)\nprint(y_test.shape)","53677f53":"linreg = LinearRegression()\nlinreg.fit(X_train, y_train)\nprint(linreg)","3ce26de5":"#prediction\ny_pred = linreg.predict(X_test)\nprint(y_pred)","438f5b49":"#accuracy score\naccuracy = linreg.score(X_test, y_test)\nprint('Accuracy Score : ', accuracy)\nprint('Percentage : ', int(accuracy * 100), '%')","af664115":"#check RMSE\nmse = mean_squared_error(y_test, y_pred)\nrmse = math.sqrt(mse)\nprint('Root Mean Squared Error : ', rmse)","6092f712":"coef = pd.Series(linreg.fit(X, y).coef_, index = X.columns)","579fbbdf":"imp_coef = pd.concat([coef.sort_values().head(10),\n                     coef.sort_values().tail(10)])","7bf92817":"plt.figure(figsize = (10,6))\nimp_coef.plot(kind = 'barh')\nplt.title(\"Feature Importance\")","c989d723":"#distribution \nplt.figure(figsize = (10,6))\nsns.distplot(df['total_litres_of_pure_alcohol'])\nplt.title(\"Distribution of Total Litres of Pure Alcohol\")\nplt.show()","e39fd28c":"## Linear Regression Model","a43f5614":"# Alcohol Consumption on Country","0e2bcce9":"## Transform Data","1f5b94f3":"## Check Feature Importance","705d8f69":"## Data Extraction"}}