{"cell_type":{"f95ac4ee":"code","ba933bce":"code","f9dc74e5":"code","0635781f":"code","a8123c56":"code","6eb8fa65":"code","8bd24be3":"code","87d1c989":"code","bbace4ee":"code","30067c3c":"code","b7feff52":"code","008ae46e":"markdown","4cc788c8":"markdown","305b1f1b":"markdown","139b512d":"markdown","f1b74e14":"markdown","1e29d08f":"markdown","c1b7db57":"markdown","5ca4674c":"markdown","faf260a1":"markdown","d521ad18":"markdown","dd1d1299":"markdown","8e19b7d2":"markdown","077ece07":"markdown","46c9b8ef":"markdown","5708af3a":"markdown","94506345":"markdown","15547089":"markdown","5f3ce321":"markdown","cccb0869":"markdown"},"source":{"f95ac4ee":"import matplotlib.pyplot as plt\n%matplotlib inline\nimport numpy as np\nimport pandas as pd\nimport spacy\nimport seaborn as sns\nimport plotly.offline as py\ncolor = sns.color_palette()\nimport plotly.graph_objs as go\npy.init_notebook_mode(connected=True)\nimport plotly.tools as tls","ba933bce":"# Load the large model to get the vectors\nnlp = spacy.load('en_core_web_lg')\n\nreview_data = pd.read_csv('..\/input\/nlp-course\/yelp_ratings.csv')\n","f9dc74e5":"review_data.head()","0635781f":"# Transforming to a markdown table\n# review_data.head().to_markdown()","a8123c56":"from wordcloud import WordCloud, STOPWORDS\nstopwords = set(STOPWORDS)\n\ndef show_wordcloud(data, title = None):\n    wordcloud = WordCloud(\n        background_color='black',\n        stopwords=stopwords,\n        max_words=200,\n        max_font_size=40, \n        scale=3,\n        random_state=1 \n).generate(str(data))\n\n    fig = plt.figure(1, figsize=(15, 15))\n    plt.axis('off')\n    if title: \n        fig.suptitle(title, fontsize=20)\n        fig.subplots_adjust(top=2.3)\n\n    plt.imshow(wordcloud)\n    plt.show()\n\nshow_wordcloud(review_data['text'])","6eb8fa65":"py.init_notebook_mode(connected=True)\n\ncnt_srs = review_data['stars'].value_counts().head()\ntrace = go.Bar(\n    y=cnt_srs.index[::-1],\n    x=cnt_srs.values[::-1],\n    orientation = 'h',\n    marker=dict(\n        color=cnt_srs.values[::-1],\n        colorscale = 'reds',\n        reversescale = True\n    ),\n)\n\nlayout = dict(\n    title='Distribution of Ratings',\n    )\ndata = [trace]\nfig = go.Figure(data=data, layout=layout)\npy.iplot(fig, filename=\"Ratings\")","8bd24be3":"sns.set(font_scale=1.4)\nplt.figure(figsize = (10,5))\nsns.heatmap(review_data.corr(), cmap='Greens',annot=True,linewidths=.5)","87d1c989":"reviews = review_data[:100]\n# We just want the vectors so we can turn off other models in the pipeline\nwith nlp.disable_pipes():\n    vectors = np.array([nlp(review.text).vector for idx, review in reviews.iterrows()])\n    \nvectors.shape","bbace4ee":"vectors = np.load('..\/input\/nlp-course\/review_vectors.npy')","30067c3c":"from sklearn.svm import LinearSVC\nfrom sklearn.model_selection import train_test_split\n\nX_train, X_test, y_train, y_test = train_test_split(vectors, review_data.sentiment, \n                                                    test_size=0.1, random_state=1)\n\n# Creating the LinearSVC model\nmodel = LinearSVC(random_state=1, dual=False)\n# Fitting the model\nmodel.fit(X_train, y_train)","b7feff52":"# model accuracy on test data\nprint(f'Model test accuracy: {model.score(X_test, y_test)*100:.3f}%')","008ae46e":"## Reading in the Data","4cc788c8":"Viewing the first five rows of the data using \".head()\"","305b1f1b":"The resultant matrix is a (100 by 300)","139b512d":"We can also view the correlation between the variables.","f1b74e14":"## Training Model","1e29d08f":"###   On document Vectors","c1b7db57":"### document vectors","5ca4674c":"It gives us quite a high accuracy of about 94%","faf260a1":"## Correlation ","d521ad18":"## Visualization","dd1d1299":"We will use the first 100 document vectors.","8e19b7d2":"### Word Cloud\nThese shows a representation of the text data as an image made of words.\nWords that are more important or rather more frequent are usually larger. It gives\nus a basic overview of the text data in a visually appealing manner. ","077ece07":"It would also be interesting to see the distribution of the ratings. The ratings for three stars have been droppped since they cannot be of much help as they are neutral. They don't give a strong standpoint with their reviews.","46c9b8ef":"nlp-exercise","5708af3a":"Now we can predict with our fitted model. But first we test its accuracy with the 'hold-out' data.","94506345":"#### Model Accuracy in Test Data","15547089":"We can now load all the document vectors so that we can begin training our model.","5f3ce321":"## Importing all the necessary libraries","cccb0869":"We are going to use a supervised classification method known as Support Vector Machine...specifically Linear Support Vector Classification. They are usually quite effective on high dimensional spaces."}}