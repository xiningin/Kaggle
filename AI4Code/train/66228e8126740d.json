{"cell_type":{"a21ceed1":"code","d7d982f5":"code","35db6d3b":"code","043bb8db":"code","69135e3b":"code","d3525fb8":"code","fe64b47c":"code","a8626fe5":"code","6e98b5f1":"code","430129eb":"code","6128cdae":"code","0cd383f1":"code","97d181dd":"code","787e03b7":"code","cf1500ff":"code","bf1853c3":"code","6828835c":"code","72ba15d0":"code","cf0c7aae":"code","76ba66be":"code","935f32e3":"code","8113ffc8":"code","c84a668e":"code","154cd4f4":"code","2fe0ccb7":"code","555818a7":"code","caa447a8":"code","fc03c245":"code","c614b710":"code","0ee481d0":"code","6112cea5":"code","6ac22588":"code","134da0b8":"code","e4237368":"markdown","c8cbc90a":"markdown","a3be4f84":"markdown","f7950f0f":"markdown","99ecf878":"markdown","cd201616":"markdown","0097b24f":"markdown","b4fbc391":"markdown","c752d25c":"markdown","36a960ce":"markdown","361a8b6a":"markdown","1c477d98":"markdown","57af59d3":"markdown","c72e278d":"markdown","7049ce00":"markdown","67d7be20":"markdown"},"source":{"a21ceed1":"import pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport numpy as np\nfrom pandas_profiling import ProfileReport","d7d982f5":"df=pd.read_csv(\"..\/input\/red-wine-quality-cortez-et-al-2009\/winequality-red.csv\")","35db6d3b":"df.head()","043bb8db":"df.isnull().sum()","69135e3b":"ProfileReport(df)","d3525fb8":"plt.figure(figsize=[14,9])\nsns.heatmap(df.corr(),annot=True)","fe64b47c":"sns.barplot(\"quality\",\"alcohol\",data=df)","a8626fe5":"sns.barplot(\"quality\",\"volatile acidity\",data=df)","6e98b5f1":"sns.countplot(x=\"quality\",data=df)","430129eb":"quality = df[\"quality\"].values\ncategory = []\nfor num in quality:\n    if num>5:\n        category.append(\"Good\")\n    else:\n        category.append(\"Bad\")","6128cdae":"category = pd.DataFrame(data=category, columns=[\"category\"])\ndata = pd.concat([df,category],axis=1)\ndata.drop(columns=\"quality\",axis=1,inplace=True)","0cd383f1":"data.head()","97d181dd":"sns.countplot(x=\"category\",data=data)","787e03b7":"#histogram of alcohol\nplt.hist(x=df[\"alcohol\"],bins=20)\nplt.show()","cf1500ff":"#histogram of sulphates\nplt.hist(x=df[\"sulphates\"],bins=20)\nplt.show()","bf1853c3":"#histogram of citric acid\nplt.hist(x=df[\"citric acid\"],bins=20)\nplt.show()","6828835c":"#histogram of fixed acidity\nplt.hist(x=df[\"fixed acidity\"],bins=20)\nplt.show()","72ba15d0":"#histogram of volatile acidity\nplt.hist(x=df[\"volatile acidity\"],bins=20)\nplt.show()","cf0c7aae":"#creating a list of numeric features in the database.\nnumeric_values=[x for x in df.columns if df[x].dtypes!='O']\nnumeric_values","76ba66be":"#plotting boxplot of all the numeric values.\nfor feature in numeric_values:\n    plt.figure(figsize=[8,5])\n    sns.boxplot(df[feature],palette=\"spring_r\")","935f32e3":"sns.jointplot(x=df[\"alcohol\"],y=df[\"density\"],kind=\"hex\")","8113ffc8":"plt.figure(figsize=[10,8])\nsns.scatterplot(\"alcohol\",\"density\",hue=\"category\",data=data)","c84a668e":"plt.figure(figsize=[10,8])\nsns.scatterplot(\"chlorides\",\"sulphates\",hue=\"category\",data=data)","154cd4f4":"sns.barplot(\"category\",\"citric acid\",data=data)","2fe0ccb7":"sns.barplot(\"category\",\"volatile acidity\",data=data)","555818a7":"#declaring X and y variables where X are features and y is our target variable.\nX= data.iloc[:,:-1].values\ny=data.iloc[:,-1].values","caa447a8":"from sklearn.preprocessing import LabelEncoder\nlabel_quality = LabelEncoder()","fc03c245":"#splitting the data\nfrom sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.2,random_state=0)","c614b710":"#scaling data for optimization\nfrom sklearn.preprocessing import StandardScaler\nsc_X = StandardScaler()\nX_train = sc_X.fit_transform(X_train)\nX_test = sc_X.transform(X_test)","0ee481d0":"from sklearn.neighbors import KNeighborsClassifier\nknn = KNeighborsClassifier()\nknn.fit(X_train,y_train)","6112cea5":"pred_knn=knn.predict(X_test)","6ac22588":"from sklearn.metrics import classification_report,accuracy_score\nprint(classification_report(y_test, pred_knn))","134da0b8":"print(\"The accuracy of this model is \",accuracy_score(y_test,pred_knn)*100,\" %\")","e4237368":"### 4d. Find out the accuracy.","c8cbc90a":"__The values are not uniformly distributed. A large number of wine sample quality fall under are 5 or 6. This may create a problem while creating model. So we will classify the data.__\n__We will do so by divide the wine quality into \"good\" and \"bad\" categories.__","a3be4f84":"## 1. Importing Dataset","f7950f0f":"__Hence, now we can see that the data is uniformly distributed, which we require for accuracy in the model.__","99ecf878":"__Hence from the above report we can see that all the 12 variables are of numeric type. And also that there are zero missing or null values in the dataset.__","cd201616":"### 4c. Predict on the test set.","0097b24f":"__The heatmap above shows the correlation between variables in the dataset. It shows how variables are dependent on each other and by what factor and also their nature of dependency (directly or inversely proportional).__\n__By seeing at the heatmap we can see that the top 5 features that affect the quality of wine are alcohol, sulphates, citric acid, fixed acidity, volatile acidity.__","b4fbc391":"## 4. Modelling.","c752d25c":"### 3a. Univariate Analysis.","36a960ce":"## 3. Exploratory Data Analysis","361a8b6a":"### 4a. Split the dataset using \u201ctrain-test-split\u201d function.","1c477d98":"## 2. Data Quality Check","57af59d3":"### 4b. Apply KNN classification on \u201cquality\u201d column of the dataset. Select the appropriate features.","c72e278d":"__We can see that there are no null values in this dataset.__","7049ce00":"# Predict Red Wine Quality Using KNN Classification.","67d7be20":"### 3b. Bivariate Analysis."}}