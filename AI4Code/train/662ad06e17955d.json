{"cell_type":{"4d006554":"code","db494d1c":"code","2f88a029":"code","a552716a":"code","dd89c591":"code","10c15a4e":"code","f8886951":"code","53884707":"code","65c73ba3":"code","6a2ccc99":"code","ec7dc07d":"code","9d302081":"code","3a8cb90c":"code","9d8f0a08":"code","56bc9851":"code","dcad3b47":"code","4d156e66":"code","9760c66a":"code","345740be":"code","702a0b3f":"code","c5e0a409":"markdown","254319e1":"markdown","d1abb077":"markdown","fa974ef8":"markdown","71659439":"markdown","6a94d1e9":"markdown","2b5190ca":"markdown","7fe4c90a":"markdown","87c34969":"markdown","3dcb9b8c":"markdown","597e588a":"markdown","09b0253c":"markdown","09c50992":"markdown","5a469657":"markdown","1eeefba2":"markdown","faa69e3e":"markdown","f087665f":"markdown","0ecc107f":"markdown","dd590ac4":"markdown","65bbf1fd":"markdown","03009165":"markdown"},"source":{"4d006554":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","db494d1c":"dataset = pd.read_csv('\/kaggle\/input\/us-gasoline-and-diesel-retail-prices-19952021\/PET_PRI_GND_DCUS_NUS_W.csv')\ndataset.head()","2f88a029":"dataset.info()","a552716a":"dataset.describe()","dd89c591":"dataset['Date'] = pd.to_datetime(dataset['Date'], format='%m\/%d\/%Y')\ndataset['Year'] = dataset['Date'].dt.year\ndataset['Month'] = dataset['Date'].dt.month\ndataset['Day'] = dataset['Date'].dt.day\nprint(dataset.info())\nprint(dataset.head())","10c15a4e":"yearly_data = dataset.drop(['Date', 'Month', 'Day'], axis=1)\nmonthly_data = dataset.drop(['Date', 'Year', 'Day'], axis=1)\ndaily_data = dataset.drop(['Date', 'Year', 'Month'], axis=1)\nprint(yearly_data.head())\nprint(monthly_data.head())\nprint(daily_data.head())","f8886951":"yearly_mean= yearly_data.groupby('Year', as_index=False).mean()\nmonthly_mean = monthly_data.groupby('Month', as_index=False).mean()\ndaily_mean = daily_data.groupby('Day', as_index=False).mean()\nprint(yearly_mean.head())\nprint(monthly_mean.head())\nprint(daily_mean.head())","53884707":"import matplotlib.pyplot as plt\nimport seaborn as sns\n\nfig, axes = plt.subplots(5, 1, figsize=(15,20))\nplt.setp(axes, xticks=range(1995,2021,1), xlabel='Year', ylabel='Dollars per Gallon')\naxes[0].set_title('Yearly Change (All Grades)')\nfor n in range(1,4):\n    sns.lineplot(ax=axes[0], x='Year', y='A{}'.format(n), data=yearly_mean, label='A{}'.format(n), marker='o')\naxes[0].legend()\n\naxes[1].set_title('Yearly Change (Regular)')\nfor n in range(1,4):\n    sns.lineplot(ax=axes[1], x='Year', y='R{}'.format(n), data=yearly_mean, label='R{}'.format(n), marker='o')\naxes[1].legend()\n\naxes[2].set_title('Yearly Change (Midgrade)')\nfor n in range(1,4):\n    sns.lineplot(ax=axes[2], x='Year', y='M{}'.format(n), data=yearly_mean, label='M{}'.format(n), marker='o')\naxes[2].legend()\n\naxes[3].set_title('Yearly Change (Premium)')\nfor n in range(1,4):\n    sns.lineplot(ax=axes[3], x='Year', y='P{}'.format(n), data=yearly_mean, label='P{}'.format(n), marker='o')\naxes[3].legend()\n\naxes[4].set_title('Yearly Change (No 2 Diesel)')\nsns.lineplot(ax=axes[4], x='Year', y='D1', data=yearly_mean, label='D1', marker='o')\naxes[4].legend()\n\nfig.tight_layout()","65c73ba3":"fig, axes = plt.subplots(5, 1, figsize=(15,20))\nplt.setp(axes, xticks=range(1,13,1), xlabel='Month', ylabel='Dollars per Gallon')\naxes[0].set_title('Monthly Change (All Grades)')\nfor n in range(1,4):\n    sns.lineplot(ax=axes[0], x='Month', y='A{}'.format(n), data=monthly_mean, label='A{}'.format(n), marker='o')\naxes[0].legend()\n\naxes[1].set_title('Monthly Change (Regular)')\nfor n in range(1,4):\n    sns.lineplot(ax=axes[1], x='Month', y='R{}'.format(n), data=monthly_mean, label='R{}'.format(n), marker='o')\naxes[1].legend()\n\naxes[2].set_title('Monthly Change (Midgrade)')\nfor n in range(1,4):\n    sns.lineplot(ax=axes[2], x='Month', y='M{}'.format(n), data=monthly_mean, label='M{}'.format(n), marker='o')\naxes[2].legend()\n\naxes[3].set_title('Monthly Change (Premium)')\nfor n in range(1,4):\n    sns.lineplot(ax=axes[3], x='Month', y='P{}'.format(n), data=monthly_mean, label='P{}'.format(n), marker='o')\naxes[3].legend()\n\naxes[4].set_title('Monthly Change (No 2 Diesel)')\nsns.lineplot(ax=axes[4], x='Month', y='D1', data=monthly_mean, label='D1', marker='o')\naxes[4].legend()\n\nfig.tight_layout()","6a2ccc99":"fig, axes = plt.subplots(5, 1, figsize=(15,20))\nplt.setp(axes, xticks=range(1,32,1), xlabel='Day', ylabel='Dollars per Gallon')\naxes[0].set_title('Daily Change (All Grades)')\nfor n in range(1,4):\n    sns.lineplot(ax=axes[0], x='Day', y='A{}'.format(n), data=daily_mean, label='A{}'.format(n), marker='o')\naxes[0].legend()\n\naxes[1].set_title('Daily Change (Regular)')\nfor n in range(1,4):\n    sns.lineplot(ax=axes[1], x='Day', y='R{}'.format(n), data=daily_mean, label='R{}'.format(n), marker='o')\naxes[1].legend()\n\naxes[2].set_title('Daily Change (Midgrade)')\nfor n in range(1,4):\n    sns.lineplot(ax=axes[2], x='Day', y='M{}'.format(n), data=daily_mean, label='M{}'.format(n), marker='o')\naxes[2].legend()\n\naxes[3].set_title('Daily Change (Premium)')\nfor n in range(1,4):\n    sns.lineplot(ax=axes[3], x='Day', y='P{}'.format(n), data=daily_mean, label='P{}'.format(n), marker='o')\naxes[3].legend()\n\naxes[4].set_title('Daily Change (No 2 Diesel)')\nsns.lineplot(ax=axes[4], x='Day', y='D1', data=daily_mean, label='D1', marker='o')\naxes[4].legend()\n\nfig.tight_layout()","ec7dc07d":"gasoline_A1 = dataset[['Date', 'A1']]\ngasoline_A2 = dataset[['Date', 'A2']]\ngasoline_A3 = dataset[['Date', 'A3']]\n\nplt.subplots(figsize=(15,8))\nplt.title('Gasoline Retail Prices All Grades (1995-2020)')\nplt.plot('Date', 'A1', data=gasoline_A1)\nplt.plot('Date', 'A2', data=gasoline_A2)\nplt.plot('Date', 'A3', data=gasoline_A3)\nplt.xlabel('Date')\nplt.ylabel('Dollars per Gallon')\nplt.legend()\nplt.show()","9d302081":"gasoline_R1 = dataset[['Date', 'R1']]\ngasoline_R2 = dataset[['Date', 'R2']]\ngasoline_R3 = dataset[['Date', 'R3']]\n\nplt.subplots(figsize=(15,8))\nplt.title('Gasoline Retail Prices Regular (1995-2020)')\nplt.plot('Date', 'R1', data=gasoline_R1)\nplt.plot('Date', 'R2', data=gasoline_R2)\nplt.plot('Date', 'R3', data=gasoline_R3)\nplt.xlabel('Date')\nplt.ylabel('Dollars per Gallon')\nplt.legend()\nplt.show()","3a8cb90c":"gasoline_M1 = dataset[['Date', 'M1']]\ngasoline_M2 = dataset[['Date', 'M2']]\ngasoline_M3 = dataset[['Date', 'M3']]\n\nplt.subplots(figsize=(15,8))\nplt.title('Gasoline Retail Prices Midgrade (1995-2020)')\nplt.plot('Date', 'M1', data=gasoline_M1)\nplt.plot('Date', 'M2', data=gasoline_M2)\nplt.plot('Date', 'M3', data=gasoline_M3)\nplt.xlabel('Date')\nplt.ylabel('Dollars per Gallon')\nplt.legend()\nplt.show()","9d8f0a08":"gasoline_P1 = dataset[['Date', 'P1']]\ngasoline_P2 = dataset[['Date', 'P2']]\ngasoline_P3 = dataset[['Date', 'P3']]\n\nplt.subplots(figsize=(15,8))\nplt.title('Gasoline Retail Prices Premium (1995-2020)')\nplt.plot('Date', 'P1', data=gasoline_P1)\nplt.plot('Date', 'P2', data=gasoline_P2)\nplt.plot('Date', 'P3', data=gasoline_P3)\nplt.xlabel('Date')\nplt.ylabel('Dollars per Gallon')\nplt.legend()\nplt.show()","56bc9851":"diesel = dataset[['Date', 'D1']]\n\nplt.subplots(figsize=(15,8))\nplt.title(\"Diesel Retail Prices (1995-2020)\")\nplt.plot('Date', 'D1', data=diesel)\nplt.xlabel('Date')\nplt.ylabel('Dollars per Gallon')\nplt.show()","dcad3b47":"dataset.head()","4d156e66":"input_data = dataset[['Year', 'Month', 'Day']]\ncat_key = {'A1':1, 'A2':2, 'A3':3, 'R1':4, 'R2':5, 'R3':6, 'M1':7, 'M2':8, 'M3':9, 'P1':10, 'P2':11, 'P3':12, 'D1':13} ","9760c66a":"from sklearn.ensemble import RandomForestRegressor\nrf = RandomForestRegressor(n_jobs=-1, oob_score=True, random_state=0)\n\ndef predict_price(cat, year, month, day):\n    rf.fit(input_data, dataset.iloc[:, cat_key[cat]])  \n    print(\"OOB Score of Random Forest Regressor Model\")\n    print(rf.oob_score_)\n    print(\"Prediction ({} \/ {} \/ {})\".format(year, month, day))\n    print(rf.predict([[year, month, day]]))","345740be":"predict_price('D1', 2021, 2, 1)","702a0b3f":"import datetime\ntest_date = datetime.datetime.strptime('2021\/02\/01', '%Y\/%m\/%d').date()\n\nplt.subplots(figsize=(15,8))\nplt.title(\"Diesel Retail Prices (1995-2020)\")\nplt.plot('Date', 'D1', data=diesel)\nplt.plot(test_date, 2.6736, marker=\"^\")\nplt.xlabel('Date')\nplt.ylabel('Dollars per Gallon')\nplt.show()","c5e0a409":"# **STEP 1. Dataset Prepare**","254319e1":"# **STEP 5. Price change (Monthly)**","d1abb077":"Convert the type of 'Date' column in dataset. Object Type to Datetime Type. \nAnd divide by year, month and day.","fa974ef8":"Yearly price fluctuation of both Gasoline and Diesel is very similar to each other, highest in 2012 and lowest in 1998 ","71659439":"Thanks for reading my notebook!!\n... and sorry, I'm not good at english...\nI learned about Random Forest few days ago and find it's interesting so I apply it on this dataset.\nI've just started the Machine Learning so I really welcome all the feedbacks!! :)","6a94d1e9":"# **STEP 2. Convert the type of the 'Date' Column**","2b5190ca":"# **STEP 7. Price change (Complete Datetime)**","7fe4c90a":"# **STEP 6. Price change (Daily)**","87c34969":"# **STEP 8. Machine Learning Model for Predction**","3dcb9b8c":"Diesel Price increased dramatically at the 7th, 14th, 21th, 28th day and decreased dramatically right after\nSimilar to daily price fluctuation of the Gasoline","597e588a":"I predict the Diesel price in 2021\/2\/1.\n\nand my result was...","09b0253c":"I used Random Forest Regressor to predict the price.\n\nConsidering the slight difference between price of gasoline categories and grades, I defined a function.","09c50992":"To see how the price change by yearly, monthly, daily flow, I divded the dataset","5a469657":"# **STEP 9. Predict the price with the model**","1eeefba2":"# **STEP 4. Price change (Yearly)**","faa69e3e":"# **STEP 3. Partition yearly \/ monthly \/ daily**","f087665f":"caculation of the average price of each year, month, day","0ecc107f":"Dataset Used\nUS gasoline and diesel retail prices 1995-2021\n\nContains...\n* A1: Weekly U.S. All Grades All Formulations Retail Gasoline Prices (Dollars per Gallon)\n* A2: Weekly U.S. All Grades Conventional Retail Gasoline Prices (Dollars per Gallon)\n* A3: Weekly U.S. All Grades Reformulated Retail Gasoline Prices (Dollars per Gallon)\n* R1: Weekly U.S. Regular All Formulations Retail Gasoline Prices (Dollars per Gallon)\n* R2: Weekly U.S. Regular Conventional Retail Gasoline Prices (Dollars per Gallon)\n* R3: Weekly U.S. Regular Reformulated Retail Gasoline Prices (Dollars per Gallon)\n* M1: Weekly U.S. Midgrade All Formulations Retail Gasoline Prices (Dollars per Gallon)\n* M2: Weekly U.S. Midgrade Conventional Retail Gasoline Prices (Dollars per Gallon)\n* M3: Weekly U.S. Midgrade Reformulated Retail Gasoline Prices (Dollars per Gallon)\n* P1: Weekly U.S. Premium All Formulations Retail Gasoline Prices (Dollars per Gallon)\n* P2: Weekly U.S. Premium Conventional Retail Gasoline Prices (Dollars per Gallon)\n* P3: Weekly U.S. Premium Reformulated Retail Gasoline Prices (Dollars per Gallon)\n* D1: Weekly U.S. No 2 Diesel Retail Prices (Dollars per Gallon)","dd590ac4":"Gasoline Price was highest in month of June and lowest in month of January\nDiesel Price was highest in month of September and lowest in month of January","65bbf1fd":"To see where my predction result would be located on the graph, once again I used the line graph of diesel in STEP 7.","03009165":"Plot graph to see how price change as the time goes"}}