{"cell_type":{"191b8514":"code","5ad1ce35":"code","cc2c570e":"code","62c2ee5e":"code","e0b69a4a":"code","52207d91":"code","11393292":"code","a66ec76d":"code","41656b75":"code","966c3f91":"code","5b88d8fd":"code","b4d516ec":"code","95173a97":"code","79d94b23":"code","9e044e1c":"code","4f04286b":"code","5c86fe85":"code","fe14feff":"code","c91083b9":"code","20e49a60":"code","07b48c92":"code","afc3c22b":"code","398a9d2c":"code","fcef82e4":"code","16bb2944":"code","9fcbe6cd":"code","2e0c4252":"code","066d61af":"code","cd67a617":"code","9e3c24fc":"code","a6a1600d":"code","dcc0e545":"code","6ce8dd8e":"code","9e7338c2":"code","6f6a7a95":"code","a0d8abff":"code","5b96b159":"code","8b948573":"code","a23a75b6":"code","c6c35210":"code","9454ab23":"code","f43ed262":"code","9ebbb5de":"code","1785d235":"code","33d1e462":"code","f3deba38":"code","11dec346":"markdown","0c0a1776":"markdown","808e33e5":"markdown","bc162eb3":"markdown","71c5d2b4":"markdown","7d3970b6":"markdown","77609391":"markdown","1f263ed1":"markdown","8de59b66":"markdown","f69cbdad":"markdown","2c27df14":"markdown","b77d27f3":"markdown","e26d07fb":"markdown","f0c48755":"markdown","ce320303":"markdown","55473558":"markdown","fa58da19":"markdown","cab35033":"markdown","330e1e26":"markdown","b807bc42":"markdown","d0bd2c69":"markdown","168d8fe3":"markdown"},"source":{"191b8514":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\nfrom sklearn import preprocessing\nimport matplotlib.pyplot as plt \n\nimport statsmodels.api as sm\nimport statsmodels.formula.api as smf\n\nfrom sklearn import datasets, linear_model\nfrom sklearn.metrics import mean_squared_error\n\n%matplotlib inline\n\nimport seaborn as sns\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.","5ad1ce35":"### Load wine quality data into Pandas\ndf_wine_red = pd.read_csv(\"\/kaggle\/input\/winedata\/winequality_red.csv\")\n\ndf_wine_white = pd.read_csv(\"\/kaggle\/input\/winedata\/winequality_white.csv\")","cc2c570e":"df_wine_red","62c2ee5e":"df_wine_red['Color']='Red'\ndf_wine_white['Color']='White'","e0b69a4a":"df_wine=pd.concat([df_wine_red,df_wine_white],axis=0)","52207d91":"df_wine.head(3)","11393292":"df_wine.columns.values","a66ec76d":"df_wine.rename(columns={'fixed acidity':'fixed_acidity','volatile acidity':'volatile_acidity','citric acid':'citric_acid',\n                        'residual sugar':'residual_sugar','free sulfur dioxide':'free_sulfur_dioxide',\n                        'total sulfur dioxide':'total_sulfur_dioxide' },inplace=True)","41656b75":"df_wine.columns.values","966c3f91":"df_wine.isnull()","5b88d8fd":"df_wine.info()","b4d516ec":"df_wine.describe()","95173a97":"sns.countplot(x='quality',data=df_wine)","79d94b23":"mean_dic={'Color':['Red','White'],'Mean':[df_wine_red['quality'].mean(),df_wine_white['quality'].mean()]}\ndf_mean_qua=pd.DataFrame(data=mean_dic)\ndf_mean_qua.set_index('Color')","9e044e1c":"df_mean_qua.plot(kind='bar',x='Color',figsize=(10,7),legend=False)\nplt.title('Average Quality by Wine Color')\nplt.xlabel('mean_quality')\nplt.ylabel('Average Quality')","4f04286b":"df_Ph=pd.DataFrame({'f_ac':df_wine['fixed_acidity'],'pH':df_wine['pH'],'color':df_wine['Color']=='Red','size':df_wine['quality']})\n","5c86fe85":"plt.scatter('f_ac', 'pH',c='color',alpha=0.65,data=df_Ph)\nplt.xlabel(\"fixed_acidity\", size=16)\nplt.ylabel(\"pH\", size=16)\n","fe14feff":"plt.subplots(figsize=(15,10))\nax = plt.axes()\nax.set_title(\"Red Wine Characteristic Correlation Heatmap\")\ncorr = df_wine_red.corr()\nsns.heatmap(corr, \n            xticklabels=corr.columns.values,\n            yticklabels=corr.columns.values,\n           cmap=\"Reds\")\nplt.show()","c91083b9":"plt.subplots(figsize=(15,10))\nax = plt.axes()\nax.set_title(\"White Wine Characteristic Correlation Heatmap\")\ncorr = df_wine_white.corr()\nsns.heatmap(corr, \n            xticklabels=corr.columns.values,\n            yticklabels=corr.columns.values,\n           cmap=\"Purples\")","20e49a60":"df_red_corr=df_wine_red.corr()\ndf_red_corr","07b48c92":"df_white_corr=df_wine_white.corr()\ndf_white_corr","afc3c22b":"diff_corr = df_red_corr - df_white_corr\ndiff_corr","398a9d2c":"plt.subplots(figsize=(15,10))\nax = plt.axes()\nax.set_title(\"Correlation Differences between Red and White Wines\")\ncorr = diff_corr\nsns.heatmap(corr, \n            xticklabels=corr.columns.values,\n            yticklabels=corr.columns.values,\n           cmap=\"coolwarm\")","fcef82e4":"df_wine_white.rename(columns={'fixed acidity': 'fixed_acidity','citric acid':'citric_acid','volatile acidity':'volatile_acidity','residual sugar':'residual_sugar','free sulfur dioxide':'free_sulfur_dioxide','total sulfur dioxide':'total_sulfur_dioxide'}, inplace=True)\ndf_wine_red.rename(columns={'fixed acidity': 'fixed_acidity','citric acid':'citric_acid','volatile acidity':'volatile_acidity','residual sugar':'residual_sugar','free sulfur dioxide':'free_sulfur_dioxide','total sulfur dioxide':'total_sulfur_dioxide'}, inplace=True)","16bb2944":"df = pd.get_dummies(df_wine, columns=[\"Color\"])","9fcbe6cd":"from sklearn.model_selection import train_test_split\ntrain, test = train_test_split(df, test_size=0.2, random_state=4) \n## add a starting random point (4) so results can be reproduced ","2e0c4252":"results1 = smf.ols('quality ~ total_sulfur_dioxide + free_sulfur_dioxide + residual_sugar + fixed_acidity + volatile_acidity + alcohol + sulphates + pH + density + Color_Red', data=df).fit()\nprint(results1.summary())","066d61af":"y = train[\"quality\"]\ncols = [\"total_sulfur_dioxide\",\"free_sulfur_dioxide\",\"residual_sugar\",\"fixed_acidity\",\"volatile_acidity\",\"alcohol\",\"sulphates\",\"pH\",\"density\",\"Color_Red\"]\n\nX=train[cols]","cd67a617":"regr = linear_model.LinearRegression()\nregr.fit(X,y)","9e3c24fc":"ytrain_pred = regr.predict(X)\nprint(\"In-sample Mean squared error: %.2f\"\n      % mean_squared_error(y, ytrain_pred))","a6a1600d":"ytest = test[\"quality\"]\ncols = [\"total_sulfur_dioxide\",\"free_sulfur_dioxide\",\"residual_sugar\",\"fixed_acidity\",\"volatile_acidity\",\"alcohol\",\"sulphates\",\"pH\",\"density\",\"Color_Red\"]\n\nXtest=test[cols]","dcc0e545":"ypred = regr.predict(Xtest)\nprint(\"Out-of-sample Mean squared error: %.2f\"\n      % mean_squared_error(ytest, ypred))","6ce8dd8e":"w_train, w_test = train_test_split(df_wine_white, test_size=0.2)","9e7338c2":"results_w = smf.ols('quality ~ free_sulfur_dioxide + residual_sugar + fixed_acidity + volatile_acidity + alcohol + sulphates + pH + density', data=df_wine_white).fit()\nprint(results_w.summary())","6f6a7a95":"y_w = w_train[\"quality\"]\ncols_w = [\"free_sulfur_dioxide\",\"residual_sugar\",\"fixed_acidity\",\"volatile_acidity\",\"alcohol\",\"sulphates\",\"pH\",\"density\"]\nX_w=w_train[cols_w]\nregr.fit(X_w,y_w)","a0d8abff":"ytrain_predw = regr.predict(X_w)\nprint(\"In-sample Mean squared error: %.2f\"\n      % mean_squared_error(y_w, ytrain_predw))","5b96b159":"ytestw = w_test[\"quality\"]\nXtestw = w_test[cols_w]\nypredw = regr.predict(Xtestw)\nprint(\"Out-of-sample Mean squared error: %.2f\"\n      % mean_squared_error(ytestw, ypredw))","8b948573":"r_train, r_test = train_test_split(df_wine_red, test_size=0.2)","a23a75b6":"results_r = smf.ols('quality ~ free_sulfur_dioxide + residual_sugar + fixed_acidity + volatile_acidity + alcohol + sulphates + pH + density', data=df_wine_red).fit()\nprint(results_r.summary())","c6c35210":"y_r = r_train[\"quality\"]\ncols_r = [\"free_sulfur_dioxide\",\"residual_sugar\",\"fixed_acidity\",\"volatile_acidity\",\"alcohol\",\"sulphates\",\"pH\",\"density\"]\nX_r=r_train[cols_r]\nregr.fit(X_r,y_r)","9454ab23":"ytrain_predr = regr.predict(X_r)\nprint(\"In-sample Mean squared error: %.2f\"\n      % mean_squared_error(y_r, ytrain_predr))","f43ed262":"ytestr = r_test[\"quality\"]\nXtestr = r_test[cols_r]\nypredr = regr.predict(Xtestr)\nprint(\"Out-of-sample Mean squared error: %.2f\"\n      % mean_squared_error(ytestr, ypredr))","9ebbb5de":"y_both = pd.concat([y_w,y_r])","1785d235":"ytrain_predW=pd.DataFrame(ytrain_predw)\nytrain_predR=pd.DataFrame(ytrain_predr)\n\ny_train_predboth = pd.concat([ytrain_predW,ytrain_predR])","33d1e462":"print(\"In-sample Mean squared error: %.2f\"\n      % mean_squared_error(y_both, y_train_predboth))","f3deba38":"ytestboth = pd.concat([ytestw,ytestr])\nXtestboth = pd.concat([Xtestw,Xtestr])\n                                          \nypredboth = pd.concat([pd.DataFrame(ypredw),pd.DataFrame(ypredr)])\nprint(\"Out-of-sample Mean squared error: %.2f\"\n      % mean_squared_error(ytestboth, ypredboth))\n","11dec346":"# 1. Import Data & Packages","0c0a1776":"# Introduction\nThe following notebook contains the steps enumerated below for analyzing characteristics of red and white variants of the Portuguese \"Vinho Verde\" wine. Quality is based on sensory scores (median of at least 3 evaluations made by wine experts). Each expert graded the wine quality between 0 (very bad) and 10 (very excellent).","808e33e5":"###  Red vs. White wines","bc162eb3":"### As you can see, the features that can correlate to quality of the red wine are\n\n* fixed_acidity\n* volatile_acidity\n* citirc_acid\n* chlorides\n* total_sulfur_dioxide\n* density\n* sulphates\n* alcohol","71c5d2b4":"### Differences between White and Red Correlations ","7d3970b6":"###            Red Wine","77609391":"# 6. Predicting Quality: Linear Regression","1f263ed1":"## Red Wine Model ","8de59b66":"# Index\n1. Import Data & Packages\n\n\n2. Analysis of Wine Quality\n\n\n3. Data Quality & Missing Values\n\n\n4. Exploratory Data Analysis\n\n\n5. Correlation\n\n    5.1 Red Wine\n    \n    5.2 White Wine\n    \n    5.3 Differences between White and Red Correlations\n    \n    \n6. Predicting Quality: Linear Regression\n\n    6.1 Split of Training and Hold-Out Data(80-20)\n      \n    6.2 LinReg on Data for both Wines\n        \n        6.2.1) White Wine\n        \n        6.2.2 Red Wine\n        \n    6.3 Combine Result for Testing.","f69cbdad":"### Combine result for testing","2c27df14":"## White Wine Model ","b77d27f3":"###  White Wine","e26d07fb":"# 3. Data Quality & Missing Values","f0c48755":"###    Split of Training and Hold-Out Data(80-20)","ce320303":"# 2. Analysis of Wine Quality","55473558":"The out-of-sample MSE isn't too much higher than the train sample, which is a good indication that there isn't too much overfitting in our model.","fa58da19":"# 7. LinReg on Data for both Wines","cab35033":"# 5. Correlation ","330e1e26":"Note the warning:","b807bc42":"# 4. Exploratory Data Analysis","d0bd2c69":"There are no missing values in this dateset.","168d8fe3":"We'll see how our out-of-sample test results perform (if there's a lot of multicollinearity present, we'd expect to see decreased performance)"}}