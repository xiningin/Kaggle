{"cell_type":{"5850b9c0":"code","dabb09e1":"code","82b39fe7":"code","1d3c0310":"code","ab32d92b":"code","555d6542":"code","1e7f71e5":"code","5cc5b8b3":"code","ae8d062c":"code","f00191ee":"code","f8ed51de":"code","d67a4fad":"code","b1380059":"markdown","354ab195":"markdown","e791cf0f":"markdown","f4b558f1":"markdown"},"source":{"5850b9c0":"import pandas as pd\nimport numpy as np\n\nfrom sklearn.feature_extraction.text import TfidfVectorizer\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.feature_extraction.text import CountVectorizer\nfrom sklearn.metrics import f1_score","dabb09e1":"!ls ..\/input\/data-analytics-challenge-part-2","82b39fe7":"X_train = pd.read_csv(\"..\/input\/data-analytics-challenge-part-2\/X_train.csv\")\nX_test  = pd.read_csv(\"..\/input\/data-analytics-challenge-part-2\/X_test.csv\")\nY_train = pd.read_csv(\"..\/input\/data-analytics-challenge-part-2\/Y_train.csv\")","1d3c0310":"X_train.head(5)","ab32d92b":"Y_train.head(5)","555d6542":"vec_x     = TfidfVectorizer(stop_words=\"english\")\nX_train_t = vec_x.fit_transform(X_train[\"title\"])\nX_test_t  = vec_x.transform(X_test[\"title\"])","1e7f71e5":"%%time\nclf = DecisionTreeClassifier(max_depth=20, random_state=0)\nclf.fit(X_train_t, Y_train['Expected'])","5cc5b8b3":"predict = clf.predict(X_train_t)\nres = pd.DataFrame(predict, columns=[\"Predicted\"])","ae8d062c":"def compute_mean_f_score(true_labels, predicted):\n    y_vectorizer     = CountVectorizer(tokenizer = lambda x: x.split(), binary='true')\n    true_labels_vec  = y_vectorizer.fit_transform(true_labels)\n    predicted_labels = y_vectorizer.transform(predicted)\n    return f1_score(true_labels_vec, predicted_labels, average='samples')","f00191ee":"compute_mean_f_score(Y_train['Expected'], res[\"Predicted\"])","f8ed51de":"predict_test = clf.predict(X_test_t)\nres_test = pd.DataFrame()\nres_test[\"Id\"] = X_test[\"id\"]\nres_test[\"Predicted\"] = predict_test\nres_test","d67a4fad":"res_test.to_csv(\"submission.csv\", index=False)","b1380059":"### Compute train score","354ab195":"### Make submission","e791cf0f":"### Train","f4b558f1":"### Use only title for X"}}