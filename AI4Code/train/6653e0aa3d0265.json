{"cell_type":{"21678773":"code","e6332a8a":"code","fdc04af1":"code","7b50a32b":"code","c0a7bc30":"code","086dbff1":"code","e31655f6":"code","01db4064":"code","1c885c34":"code","82c209d2":"code","a29d1b0b":"code","11dd002a":"code","da3da19a":"code","ba50095c":"code","71c132eb":"code","23bc8ed1":"code","8f39ca00":"code","159ea4db":"code","5a7fd21d":"code","80b36db9":"code","1eec9d77":"code","c5433e38":"code","b35ece37":"code","a6c05185":"code","fb294f20":"code","85fb2f1b":"code","3f4f06b3":"code","774f7e87":"code","8b6a9f1b":"code","6aa6eb12":"code","ee1d1a0e":"code","cf94844d":"code","cdc9f4a0":"code","b5875530":"code","94946559":"code","f86b90bf":"code","7a15c61c":"code","b0441dc4":"code","5c72a894":"code","e41ab548":"code","1ae0552f":"code","6a85fefa":"code","9ce7897a":"code","ed325d3b":"markdown","41b81073":"markdown","081f3e1d":"markdown","c9244263":"markdown","64d44a64":"markdown","d20c0f48":"markdown","6df89583":"markdown","b3bd03e0":"markdown","230e62a8":"markdown","04850f8a":"markdown","50577899":"markdown","66a81e58":"markdown","190d3fd5":"markdown","87250fee":"markdown","d2753699":"markdown","c1fec4bb":"markdown","48d9584d":"markdown","9a86fca7":"markdown","8dac0669":"markdown","095a56ba":"markdown","7c2fd17f":"markdown","afbff3c8":"markdown","8a135c1f":"markdown","018ce445":"markdown","169754a3":"markdown","5e1d930a":"markdown","f45f8997":"markdown","2f3c7276":"markdown","4f798c82":"markdown","c67c5809":"markdown","c520e4db":"markdown","7e340ef4":"markdown","02ec27f0":"markdown","7a97ae12":"markdown"},"source":{"21678773":"# import the necessary libraries\nimport numpy as np \nimport pandas as pd \nimport os\n\n# Visualisation libraries\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\nsns.set()\nimport pycountry\nimport plotly.express as px\nfrom plotly.offline import init_notebook_mode, iplot \nimport plotly.graph_objs as go\nimport plotly.offline as py\nfrom plotly.offline import download_plotlyjs,init_notebook_mode,plot,iplot\n!pip install chart_studio\nimport chart_studio.plotly as py\nimport cufflinks\ncufflinks.go_offline()\ncufflinks.set_config_file(world_readable=True, theme='pearl')\n#py.init_notebook_mode(connected=True)\n\n#Geographical Plotting\nimport folium\nfrom folium import Choropleth, Circle, Marker\nfrom folium import plugins\nfrom folium.plugins import HeatMap, MarkerCluster\n\n#Racing Bar Chart\n!pip install bar_chart_race\nimport bar_chart_race as bcr\nfrom IPython.display import HTML\n\n# Increase the default plot size and set the color scheme\nplt.rcParams['figure.figsize'] = 8, 5\nplt.style.use(\"fivethirtyeight\")# for pretty graphs\n\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Disable warnings \nimport warnings\nwarnings.filterwarnings('ignore')","e6332a8a":"city_day = pd.read_csv('..\/input\/air-quality-data-in-india\/city_day.csv')\n#city_hour = pd.read_csv('..\/input\/air-quality-data-in-india\/city_hour.csv')\n#station = pd.read_csv('..\/input\/air-quality-data-in-india\/stations.csv')\n#station_day = pd.read_csv('..\/input\/air-quality-data-in-india\/station_day.csv')\n#station_hour = pd.read_csv('..\/input\/air-quality-data-in-india\/station_hour.csv')\ncities_db = pd.read_csv('..\/input\/indian-cities-database\/Indian Cities Database.csv')","fdc04af1":"display(\"CITY DAILY DATA\")\ndisplay(city_day.head(5))","7b50a32b":"city_day.info()","c0a7bc30":"# Missing values\ndef missing_values_table(df):\n        # Total missing values\n        mis_val = df.isnull().sum()\n        \n        # Percentage of missing values\n        mis_val_percent = 100 * df.isnull().sum() \/ len(df)\n        \n        # Make a table with the results\n        mis_val_table = pd.concat([mis_val, mis_val_percent], axis=1)\n        \n        # Rename the columns\n        mis_val_table_ren_columns = mis_val_table.rename(\n        columns = {0 : 'Missing Values', 1 : '% of Total Values'})\n        \n        # Sort the table by percentage of missing descending\n        mis_val_table_ren_columns = mis_val_table_ren_columns[\n            mis_val_table_ren_columns.iloc[:,1] != 0].sort_values(\n        '% of Total Values', ascending=False).round(1)\n        \n        # Print some summary information\n        print (\"Your selected dataframe has \" + str(df.shape[1]) + \" columns.\\n\"      \n            \"There are \" + str(mis_val_table_ren_columns.shape[0]) +\n              \" columns that have missing values.\")\n        \n        # Return the dataframe with missing information\n        return mis_val_table_ren_columns\n\nmissing_values= missing_values_table(city_day)\nmissing_values.style.background_gradient(cmap='Reds')","086dbff1":"cities = city_day['City'].value_counts()\nprint(f'Total number of cities in the dataset : {len(cities)}')\nprint(cities.index)","e31655f6":"# Convert string to datetime64\ncity_day['Date'] = pd.to_datetime(city_day['Date'])\n#city_day.set_index('Date',inplace=True)\n","01db4064":"print(f\"The available data is between {city_day['Date'].min()} and {city_day['Date'].max()}\")","1c885c34":"city_day['BTX'] = city_day['Benzene']+city_day['Toluene']+city_day['Xylene']\ncity_day.drop(['Benzene','Toluene','Xylene'],axis=1);\n\n","82c209d2":"city_day['Particulate_Matter'] = city_day['PM2.5']+city_day['PM10']","a29d1b0b":"pollutants = ['PM2.5','PM10','NO2', 'CO', 'SO2','O3', 'BTX']","11dd002a":"\ncity_day.set_index('Date',inplace=True)\naxes = city_day[pollutants].plot(marker='.', alpha=0.5, linestyle='None', figsize=(16, 20), subplots=True)\nfor ax in axes:\n    \n    ax.set_xlabel('Years')\n    ax.set_ylabel('ug \/ m3')","da3da19a":"def trend_plot(dataframe,value):\n    \n    # Prepare data\n    df['year'] = [d.year for d in df.Date]\n    df['month'] = [d.strftime('%b') for d in df.Date]\n    years = df['year'].unique()\n\n    # Draw Plot\n    fig, axes = plt.subplots(1, 2, figsize=(14,6), dpi= 80)\n    sns.boxplot(x='year', y=value, data=df, ax=axes[0])\n    sns.pointplot(x='month', y=value, data=df.loc[~df.year.isin([2015, 2020]), :])\n\n    # Set Title\n    axes[0].set_title('Year-wise Box Plot \\n(The Trend)', fontsize=18); \n    axes[1].set_title('Month-wise Plot \\n(The Seasonality)', fontsize=18)\n    plt.show()","ba50095c":"city_day.reset_index(inplace=True)\ndf = city_day.copy()\nvalue='NO2'\ntrend_plot(df,value)","71c132eb":"#city_day.reset_index(inplace=True)\ndf = city_day.copy()\nvalue='SO2'\ntrend_plot(df,value)","23bc8ed1":"\nvalue='BTX'\ntrend_plot(df,value)","8f39ca00":"value='PM2.5'\ntrend_plot(df,value)","159ea4db":"\nvalue='PM10'\ntrend_plot(df,value)","5a7fd21d":"def max_polluted_city(pollutant):\n    x1 = city_day[[pollutant,'City']].groupby([\"City\"]).mean().sort_values(by=pollutant,ascending=False).reset_index()\n    x1[pollutant] = round(x1[pollutant],2)\n    return x1[:10].style.background_gradient(cmap='OrRd')","80b36db9":"#source: https:\/\/stackoverflow.com\/questions\/38783027\/jupyter-notebook-display-two-pandas-tables-side-by-side\nfrom IPython.display import display_html\ndef display_side_by_side(*args):\n    html_str=''\n    for df in args:\n        html_str+=df.render()\n    display_html(html_str.replace('table','table style=\"display:inline\"'),raw=True)","1eec9d77":"pm2_5 = max_polluted_city('PM2.5')\npm10 = max_polluted_city('PM10')\nno2 = max_polluted_city('NO2')\nso2 = max_polluted_city('SO2')\nco = max_polluted_city('CO')\nbtx = max_polluted_city('BTX')\n\n\ndisplay_side_by_side(pm2_5,pm10,no2,so2,co,btx)","c5433e38":"\nx2= city_day[['PM2.5','City']].groupby([\"City\"]).median().sort_values(by='PM2.5',ascending=False).reset_index()\nx3 = city_day[['PM10','City']].groupby([\"City\"]).median().sort_values(by='PM10',ascending=False).reset_index()\n\nfrom plotly.subplots import make_subplots\nfig = make_subplots(\n    rows=1, cols=2,\n    subplot_titles=(\"PM2.5\",\"PM10\"))\n\nfig.add_trace(go.Bar( y=x2['PM2.5'], x=x2[\"City\"],  \n                     marker=dict(color=x2['PM2.5'], coloraxis=\"coloraxis\")),\n              1, 1)\n\n\nfig.add_trace(go.Bar( y=x3['PM10'], x=x2[\"City\"],  \n                     marker=dict(color=x3['PM10'], coloraxis=\"coloraxis\")),\n              1, 2)\nfig.update_layout(coloraxis=dict(colorscale='reds'), showlegend=False,plot_bgcolor='white')\nfig.update_xaxes(ticks=\"outside\", tickwidth=2,tickangle=45, tickcolor='crimson', ticklen=10,title_text=\"cities\")\nfig.update_yaxes(title_text=\"ug \/ m3\", row=1, col=1)\nfig.update_yaxes(title_text=\"ug \/ m3\", row=1, col=2)\nfig.show()","b35ece37":"x4= city_day[['CO','City']].groupby([\"City\"]).median().sort_values(by='CO',ascending=False).reset_index()\nx5 = city_day[['NO2','City']].groupby([\"City\"]).median().sort_values(by='NO2',ascending=False).reset_index()\nx6 = city_day[['SO2','City']].groupby([\"City\"]).median().sort_values(by='SO2',ascending=False).reset_index()\n\n\nfrom plotly.subplots import make_subplots\nfig = make_subplots(\n    rows=1, cols=3,\n    subplot_titles=(\"CO\",\"NO2\",'SO2'))\n\nfig.add_trace(go.Bar( y=x4['CO'], x=x4[\"City\"],  \n                     marker=dict(color=x4['CO'], coloraxis=\"coloraxis\")),\n              1, 1)\n\n\nfig.add_trace(go.Bar( y=x5['NO2'], x=x5[\"City\"],  \n                     marker=dict(color=x5['NO2'], coloraxis=\"coloraxis\")),\n              1, 2)\n\nfig.add_trace(go.Bar( y=x6['SO2'], x=x5[\"City\"],  \n                     marker=dict(color=x6['SO2'], coloraxis=\"coloraxis\")),\n              1, 3)\nfig.update_layout(coloraxis=dict(colorscale='reds'), showlegend=False,plot_bgcolor='white')\nfig.update_xaxes(ticks=\"outside\", tickwidth=2,tickangle=45, tickcolor='crimson', ticklen=10,title_text=\"cities\")\nfig.update_yaxes(title_text=\"ug \/ m3\", row=1, col=1)\nfig.update_yaxes(title_text=\"ug \/ m3\", row=1, col=2)\nfig.update_yaxes(title_text=\"ug \/ m3\", row=1, col=3)\nfig.show()","a6c05185":"cities = ['Ahmedabad','Delhi','Bengaluru','Mumbai','Hyderabad','Chennai']\n\nfiltered_city_day = city_day[city_day['Date'] >= '2019-01-01']\nAQI = filtered_city_day[filtered_city_day.City.isin(cities)][['Date','City','AQI','AQI_Bucket']]\nAQI.head()","fb294f20":"AQI_pivot = AQI.pivot(index='Date', columns='City', values='AQI')\nAQI_pivot.fillna(method='bfill',inplace=True)\n\n\nfrom plotly.subplots import make_subplots\nimport plotly.graph_objects as go\n\nfig = make_subplots(\n    rows=6, cols=1,\n    #specs=[[{}, {}],\n          # [{\"colspan\": 6}, None]],\n    subplot_titles=(\"Ahmedabad\",\"Bengaluru\",\"Chennai\",\"Delhi\",'Hyderabad','Mumbai'))\n\nfig.add_trace(go.Bar(x=AQI_pivot.index, y=AQI_pivot['Ahmedabad'],\n                    marker=dict(color=AQI_pivot['Ahmedabad'],coloraxis=\"coloraxis\")),\n              1, 1)\nfig.add_trace(go.Bar(x=AQI_pivot.index, y=AQI_pivot['Bengaluru'],\n                    marker=dict(color=AQI_pivot['Bengaluru'], coloraxis=\"coloraxis\")),\n              2, 1)\nfig.add_trace(go.Bar(x=AQI_pivot.index, y=AQI_pivot['Chennai'],\n                    marker=dict(color=AQI_pivot['Chennai'], coloraxis=\"coloraxis\")),\n              3, 1)\nfig.add_trace(go.Bar(x=AQI_pivot.index, y=AQI_pivot['Delhi'],\n                    marker=dict(color=AQI_pivot['Delhi'], coloraxis=\"coloraxis\")),\n              4, 1)\nfig.add_trace(go.Bar(x=AQI_pivot.index, y=AQI_pivot['Hyderabad'],\n                    marker=dict(color=AQI_pivot['Hyderabad'], coloraxis=\"coloraxis\")),\n              5, 1)\nfig.add_trace(go.Bar(x=AQI_pivot.index, y=AQI_pivot['Mumbai'],\n                    marker=dict(color=AQI_pivot['Mumbai'], coloraxis=\"coloraxis\")),\n              6, 1)\n\nfig.update_layout(coloraxis=dict(colorscale='Temps'),showlegend=False,title_text=\"AQI Levels\")\n\nfig.update_layout(plot_bgcolor='white')\n\nfig.update_layout( width=800,height=1200,shapes=[\n      dict(\n      type= 'line',\n      yref= 'paper', y0= 0, y1= 1,\n      xref= 'x', x0= '2020-03-25', x1= '2020-03-25'\n    )\n])\n\nfig.show()","85fb2f1b":"#Source code for racing barchart: https:\/\/github.com\/dexplo\/bar_chart_race\nAQI_2020 = AQI_pivot[AQI_pivot.index > '2019-12-31']\nbcr_html = bcr.bar_chart_race(df=AQI_2020, filename=None, period_length=300,orientation='v',figsize=(8, 6),bar_label_size=7,tick_label_size=7,title='AQI levels in 2020')\nHTML(bcr_html)","3f4f06b3":"AQI_beforeLockdown = AQI_pivot['2020-01-01':'2020-03-25']\nAQI_afterLockdown = AQI_pivot['2020-03-26':'2020-05-01']","774f7e87":"print(AQI_beforeLockdown.mean())\nprint(AQI_afterLockdown.mean())","8b6a9f1b":"# Helper functions\n\n#source: http:\/\/nicolasfauchereau.github.io\/climatecode\/posts\/drawing-a-gauge-with-matplotlib\/\nfrom matplotlib.patches import Circle, Wedge, Rectangle\n\ndef degree_range(n): \n    start = np.linspace(0,180,n+1, endpoint=True)[0:-1]\n    end = np.linspace(0,180,n+1, endpoint=True)[1::]\n    mid_points = start + ((end-start)\/2.)\n    return np.c_[start, end], mid_points\n\ndef rot_text(ang): \n    rotation = np.degrees(np.radians(ang) * np.pi \/ np.pi - np.radians(90))\n    return rotation","6aa6eb12":"#source: http:\/\/nicolasfauchereau.github.io\/climatecode\/posts\/drawing-a-gauge-with-matplotlib\/\nfrom matplotlib.patches import Circle, Wedge, Rectangle\ndef gauge(labels=['GOOD','SATISFACTORY','MODERATE','POOR','VERY POOR','EXTREME'], \\\n          colors='jet_r', arrow=1, title='', fname=False): \n    \n    \"\"\"\n    some sanity checks first\n    \n\n\"\"\"\n    \n    N = len(labels)\n    \n    if arrow > N: \n        raise Exception(\"\\n\\nThe category ({}) is greated than \\\n        the length\\nof the labels ({})\".format(arrow, N))\n \n    \n    \"\"\"\n    if colors is a string, we assume it's a matplotlib colormap\n    and we discretize in N discrete colors \n    \"\"\"\n    \n    if isinstance(colors, str):\n        cmap = cm.get_cmap(colors, N)\n        cmap = cmap(np.arange(N))\n        colors = cmap[::-1,:].tolist()\n    if isinstance(colors, list): \n        if len(colors) == N:\n            colors = colors[::-1]\n        else: \n            raise Exception(\"\\n\\nnumber of colors {} not equal \\\n            to number of categories{}\\n\".format(len(colors), N))\n\n    \"\"\"\n    begins the plotting\n    \"\"\"\n    \n    fig, ax = plt.subplots()\n\n    ang_range, mid_points = degree_range(N)\n\n    labels = labels[::-1]\n    \n    \"\"\"\n    plots the sectors and the arcs\n    \"\"\"\n    patches = []\n    for ang, c in zip(ang_range, colors): \n        # sectors\n        patches.append(Wedge((0.,0.), .4, *ang, facecolor='w', lw=2))\n        # arcs\n        patches.append(Wedge((0.,0.), .4, *ang, width=0.10, facecolor=c, lw=2, alpha=0.5))\n    \n    [ax.add_patch(p) for p in patches]\n\n    \n    \"\"\"\n    set the labels (e.g. 'LOW','MEDIUM',...)\n    \"\"\"\n\n    for mid, lab in zip(mid_points, labels): \n\n        ax.text(0.35 * np.cos(np.radians(mid)), 0.35 * np.sin(np.radians(mid)), lab, \\\n            horizontalalignment='center', verticalalignment='center', fontsize=14, \\\n            fontweight='bold', rotation = rot_text(mid))\n\n    \"\"\"\n    set the bottom banner and the title\n    \"\"\"\n    r = Rectangle((-0.4,-0.1),0.8,0.1, facecolor='w', lw=2)\n    ax.add_patch(r)\n    \n    ax.text(0, -0.05, title, horizontalalignment='center', \\\n         verticalalignment='center', fontsize=22, fontweight='bold')\n\n    \"\"\"\n    plots the arrow now\n    \"\"\"\n    \n    pos = mid_points[abs(arrow - N)]\n    \n    ax.arrow(0, 0, 0.225 * np.cos(np.radians(pos)), 0.225 * np.sin(np.radians(pos)), \\\n                 width=0.04, head_width=0.09, head_length=0.1, fc='k', ec='k')\n    \n    ax.add_patch(Circle((0, 0), radius=0.02, facecolor='k'))\n    ax.add_patch(Circle((0, 0), radius=0.01, facecolor='w', zorder=11))\n\n    \"\"\"\n    removes frame and ticks, and makes axis equal and tight\n    \"\"\"\n    \n    ax.set_frame_on(False)\n    ax.axes.set_xticks([])\n    ax.axes.set_yticks([])\n    ax.axis('equal')\n    plt.tight_layout()\n    if fname:\n        fig.savefig(fname, dpi=200)","ee1d1a0e":"display(\"Ahmedabad's AQI levels\")\n\ngauge(labels=['Good','Satisfactory','Moderate','Poor','Very Poor','Extreme'], \\\n      colors=['#007A00','#90EE90','#ffff00','#FF9900','#ff0000','#CC0000'], arrow=5, title='Ahmedabad AQI before Lockdown') \n\ngauge(labels=['Good','Satisfactory','Moderate','Poor','Very Poor','Extreme'], \\\n      colors=['#007A00','#90EE90','#ffff00','#FF9900','#ff0000','#CC0000'], arrow=3, title='Ahmedabad AQI After Lockdown') \n\n\n","cf94844d":"display(\"Delhi's AQI levels\")\n\ngauge(labels=['Good','Satisfactory','Moderate','Poor','Very Poor','Extreme'], \\\n      colors=['#007A00','#90EE90','#ffff00','#FF9900','#ff0000','#CC0000'], arrow=4, title=\"Delhi's AQI before Lockdown\") \n\ngauge(labels=['Good','Satisfactory','Moderate','Poor','Very Poor','Extreme'], \\\n      colors=['#007A00','#90EE90','#ffff00','#FF9900','#ff0000','#CC0000'], arrow=3, title=\"Delhi's AQI after Lockdown\") \n","cdc9f4a0":"display(\"Mumbai's AQI levels\")\n\ngauge(labels=['Good','Satisfactory','Moderate','Poor','Very Poor','Extreme'], \\\n      colors=['#007A00','#90EE90','#ffff00','#FF9900','#ff0000','#CC0000'], arrow=3, title=\"Mumbai's AQI before Lockdown\") \n\ngauge(labels=['Good','Satisfactory','Moderate','Poor','Very Poor','Extreme'], \\\n      colors=['#007A00','#90EE90','#ffff00','#FF9900','#ff0000','#CC0000'], arrow=3, title=\"Mumbai's AQI after Lockdown\") \n","b5875530":"#city_day.set_index('Date',inplace=True)\n\nstart_date1 = '2019-01-01'\nend_date1 = '2019-05-01'\n\nmask1 = (city_day['Date'] >= start_date1) & (city_day['Date']  <= end_date1)\npollutants_filtered_2019 = city_day.loc[mask1]\npollutants_filtered_2019.fillna(method='bfill',inplace=True)\npollutants_filtered_2019.set_index('Date',inplace=True);\n\nstart_date2 = '2020-01-01'\nend_date2 = '2020-05-01'\n\nmask2 = (city_day['Date'] >= start_date2) & (city_day['Date']  <= end_date2)\npollutants_filtered_2020 = city_day.loc[mask2]\npollutants_filtered_2020.fillna(method='bfill',inplace=True)\npollutants_filtered_2020.set_index('Date',inplace=True);\n\n\ndf1 = pollutants_filtered_2019[pollutants_filtered_2019.City.isin(cities)][['City','NO2','SO2','PM2.5','CO']]\ndf2 = pollutants_filtered_2020[pollutants_filtered_2020.City.isin(cities)][['City','NO2','SO2','PM2.5','CO']]","94946559":"def pollution_comparison(city):\n    \"\"\"\n    Function to plot graph comparing pollutin levels between (Jan-May)2019 and (Jan-May)2020\n    \n    \"\"\"\n    \n    fig = go.Figure()\n    fig.add_trace(go.Scatter(x=df1.index, y=df1[df1['City']==city]['NO2'],\n                    line=dict(dash='solid',color='green'),name='NO2'))\n    fig.add_trace(go.Scatter(x=df1.index, y=df1[df1['City']==city]['SO2'],\n                    line=dict(dash='dot',color='red'),name='SO2'))\n    fig.add_trace(go.Scatter(x=df1.index, y=df1[df1['City']==city]['PM2.5'],\n                    line=dict(dash='dashdot',color='dodgerblue'),name='Particulate_Matter'))\n    fig.add_trace(go.Scatter(x=df1.index, y=df1[df1['City']==city]['CO'],\n                    line=dict(dash='longdashdot'),mode='lines',name='CO'))\n    fig.update_layout(title_text=city+' 2019 ',plot_bgcolor='white')\n    fig.update_xaxes(rangeslider_visible=True,zeroline=True,zerolinewidth=1, zerolinecolor='Black')\n    fig.show()\n\n    fig = go.Figure()\n    fig.add_trace(go.Scatter(x=df2.index, y=df2[df2['City']==city]['NO2'],\n                    line=dict(dash='solid',color='green'),name='NO2'))\n    fig.add_trace(go.Scatter(x=df2.index, y=df2[df2['City']==city]['SO2'],\n                    line=dict(dash='dot',color='red'),name='SO2'))\n    fig.add_trace(go.Scatter(x=df2.index, y=df2[df2['City']==city]['PM2.5'],\n                    line=dict(dash='dashdot',color='dodgerblue'),name='Particulate_Matter'))\n    fig.add_trace(go.Scatter(x=df2.index, y=df2[df2['City']==city]['CO'],\n                    line=dict(dash='longdashdot'),mode='lines',name='CO'))\n    fig.update_layout(title_text=city+' 2020 ',plot_bgcolor='white')\n    fig.update_xaxes(rangeslider_visible=True,zeroline=True,zerolinewidth=1, zerolinecolor='Black')\n    fig.show()\n","f86b90bf":"pollution_comparison('Ahmedabad')\n","7a15c61c":"pollution_comparison('Bengaluru')","b0441dc4":"pollution_comparison('Chennai')","5c72a894":"pollution_comparison('Delhi')","e41ab548":"pollution_comparison('Mumbai')","1ae0552f":"pollution_comparison('Hyderabad')","6a85fefa":"df11 = pollutants_filtered_2019[['City','AQI']]\ndf22 = pollutants_filtered_2020[['City','AQI']]\n\ndf_2019_coord = df11.groupby('City')['AQI'].mean().to_frame().reset_index()\ndf_2020_coord = df22.groupby('City')['AQI'].mean().to_frame().reset_index()\n\ndf_2019_AQI = pd.merge(df_2019_coord,cities_db,on='City')\ndf_2019_AQI['AQI'] = df_2019_AQI['AQI'].round(0)\ndf_2020_AQI = pd.merge(df_2020_coord,cities_db,on='City')\ndf_2020_AQI['AQI'] = df_2020_AQI['AQI'].round(0)","9ce7897a":"m = plugins.DualMap(location=(22.9734, 78.6569), tiles=None, zoom_start=5)\n\nfolium.TileLayer('Stamen Toner').add_to(m)\nfolium.TileLayer('openstreetmap').add_to(m)\n\n\nfg_1 = folium.FeatureGroup(name='2019').add_to(m.m1)\nfg_2 = folium.FeatureGroup(name='2020').add_to(m.m2)\n\n\n\nfor lat, lon, value, name in zip(df_2019_AQI['Lat'], df_2019_AQI['Long'], df_2019_AQI['AQI'], df_2019_AQI['City']):\n    folium.CircleMarker([lat, lon],\n                        radius=10,\n                        icon=folium.Icon(color='red'),\n                        popup = ('<strong>City<\/strong>: ' + str(name).capitalize() + '<br>'\n                                '<strong>AQI(Average)<\/strong>: ' + str(value) + '<br>'),\n                        fill_color='red',\n                        fill_opacity=0.7 ).add_to(fg_1)\n\n\n\n\n\nfor lat, lon, value, name in zip(df_2020_AQI['Lat'], df_2020_AQI['Long'], df_2020_AQI['AQI'], df_2020_AQI['City']):\n    folium.CircleMarker([lat, lon],\n                        radius=10,\n                        icon=folium.Icon(color='orange'),\n                        popup = ('<strong>City<\/strong>: ' + str(name).capitalize() + '<br>'\n                                '<strong>AQI(Average)<\/strong>: ' + str(value) + '<br>'),\n                        fill_color='orange',\n                        fill_opacity=0.7 ).add_to(fg_2)\n\n\nfolium.LayerControl(collapsed=False).add_to(m)\n\nm","ed325d3b":"## <a> 1.4 Data Availability<\/a>","41b81073":"## <a> 2.3 Subsetting columns<\/a>\n\nEven though a lot of columns have been provided in the dataset, we shall select a few prominent ones. Let's create a new dataframe called `pollutants` containg the major pollutants responsible for air pollution.","081f3e1d":"## <a>4.2 AQI for some of the major cities of India<\/a>\n\nThe cities that will be the subject of our study are - Ahmedabad, Delhi, Bengaluru, Mumbai,Hyderabad and Chennai.","c9244263":"### <a> 2.4.4 PM2.5 <\/a>","64d44a64":"> ** \ud83d\udccc Points to note :** \n> * It seems that we have a lot of null values in some columns e.g.Xylene and NH3.There could be a couple of reasons for the missing data:\n  * Station does not have device to capture it.\n  * Issue in the meter reading.\n\nHere is a notebook that I wrote on handling missing data in Python. it includes a section on Missing values in Time Series problems too .\n[Handling missing values in Python](https:\/\/www.kaggle.com\/parulpandey\/a-guide-to-handling-missing-values)\n","d20c0f48":"### <a> 2.4.3 BTX <\/a>","6df89583":"> ** \ud83d\udccc Points to note :** \n> * The black vertical line shows the date on which the first phase of lockdown ame into effect in India.\n> * The above graph shows the variation of various pollutant levels, from Jan 2019 onwards till date.\n> * Apparantely, all the above Indian cities seem to be a dangerously high level of pollution levels.\n> * Clearly, there appears to be a rapid decline after 25th March,2020 in all the cities under sonsideration.","b3bd03e0":"## <a> 1.3 Convert to Date Time format<\/a>\n\nLet's convert the `Date` column into Date Time format with the help of `datetime` library.","230e62a8":"## <a> 1.1 Missing Values <\/a>\n\nIt is always a good idea to see the missing values as a percentage of total values","04850f8a":"# <a> 7. A look at Pollution levels through Satellites<\/a>\n\nSatellite Imagery is the image of Earth(or other planets) which are collected by imaging satellites. Satellites have been collecting Earth Observation data for decades. Some changes in the concentration of air pollutants are visible from satellites. One such instrument collecting these measurements is the Tropospheric Monitoring Instrument (TROPOMI) sensor onboard the [Sentinel 5P OFFL NO2](https:\/\/developers.google.com\/earth-engine\/datasets\/catalog\/COPERNICUS_S5P_OFFL_L3_NO2)\n mission satellite currently in orbit. \n\n**Sentinel-5 Precursor** (**Sentinel-5P**) is an [Earth observation satellite](https:\/\/en.wikipedia.org\/wiki\/Earth_observation_satellite \"Earth observation satellite\") developed by [ESA](https:\/\/en.wikipedia.org\/wiki\/European_Space_Agency \"European Space Agency\") as part of the [Copernicus Programme](https:\/\/en.wikipedia.org\/wiki\/Copernicus_Programme \"Copernicus Programme\"). The [Copernicus Programme](https:\/\/en.wikipedia.org\/wiki\/Copernicus_Programme \"Copernicus Programme\") is dedicated to monitoring [air pollution](https:\/\/en.wikipedia.org\/wiki\/Air_pollution \"Air pollution\") and Sentinel 5P Precursor is its first mission. It consists of an instrument called [Tropomi](https:\/\/en.wikipedia.org\/wiki\/Sentinel-5_Precursor) (TROPOspheric Monitoring Instrument) which is a spectrometer to monitor [ozone](https:\/\/en.wikipedia.org\/wiki\/Ozone \"Ozone\"), [methane](https:\/\/en.wikipedia.org\/wiki\/Methane \"Methane\"), [formaldehyde](https:\/\/en.wikipedia.org\/wiki\/Formaldehyde \"Formaldehyde\"), [aerosol](https:\/\/en.wikipedia.org\/wiki\/Aerosol \"Aerosol\"), [carbon monoxide](https:\/\/en.wikipedia.org\/wiki\/Carbon_monoxide \"Carbon monoxide\"), [NO2](https:\/\/en.wikipedia.org\/wiki\/Nitrogen_dioxide \"Nitrogen dioxide\") and [SO2](https:\/\/en.wikipedia.org\/wiki\/Sulfur_dioxide \"Sulfur dioxide\") in the atmosphere.\n","50577899":"# <a>4. Effect of Lockdown on AQI<\/a>\n\nLet's now see how has the Lockdown affected the AQI levels in the prominent cities of India.For this we shall consider the data from 2019 onwards only. But before that let's understand what AQI is:\n\n## <a>4.1 AQI : Air Quality Index<\/a>\n\nAn air quality index (AQI) is used by government agencies[1] to communicate to the public how polluted the air currently is or how polluted it is forecast to become.There are six AQI categories, namely Good, Satisfactory, Moderately polluted, Poor, Very Poor, and Severe. The proposed AQI will consider eight pollutants (PM10, PM2.5, NO2, SO2, CO, O3, NH3, and Pb) for which short-term (up to 24-hourly averaging period) National Ambient Air Quality Standards are prescribed.[23] Based on the measured ambient concentrations, corresponding standards and likely health impact, a sub-index is calculated for each of these pollutants. The worst sub-index reflects overall AQI. Likely health impacts for different AQI categories and pollutants have also been suggested, with primary inputs from the medical experts in the group. The AQI values and corresponding ambient concentrations (health breakpoints) as well as associated likely health impacts for the identified eight pollutants are as follows:[[Wikipedia](https:\/\/en.wikipedia.org\/wiki\/Air_quality_index)]\n\n![](https:\/\/imgur.com\/JwXoMrw.png)\nsource: https:\/\/app.cpcbccr.com\/AQI_India\/\n\n> Incase you want to know how the AQI is calculated, here is a neat notebook [Calculating AQI (Air Quality Index) Tutorial](https:\/\/www.kaggle.com\/rohanrao\/calculating-aqi-air-quality-index-tutorial) which explains the concept in a lot of detail.","66a81e58":"> ** \ud83d\udccc Points to note :** \n> * Patna, Delhi , Ahmedabad and Kolkata seem to top the charts. Ahmedabad has maximum concenterations of NO2,SO2 as well as CO levels.\n\nLet's also look at the above data visually to get a better perspective","190d3fd5":"There seems to be a lot of missing values in the dataset. Additionally, the Date column is also not in the Date-Time format. ","87250fee":"> ** \ud83d\udccc Points to note :** \n> * PM2.5 and PM10 pollution show a seasonal effect, with pollution being higher in winter months as compared to the summer ones.\n> * SO2 level has started increasing after 2017, although it had also seen a sudden rise in 2015 also. The same pattern is also reflected in BTX levels also.\n\nThis is just an overview. We will have to look deeper to get specific answers. \n","d2753699":"### <a> 2.4.5 PM10 <\/a>","c1fec4bb":"## <a> 4.4 AQI before and after Lockdown <\/a>\n\nIt'll be also interesting to see tha difference in AQI before and after the Lockdown.","48d9584d":"### <a> 2.4.2 SO<sub>2<\/sub> <\/a>","9a86fca7":"## An analysis of the COVID-19's Lockdown effect on the Pollution level in India \n\n\n![](https:\/\/cdn-images-1.medium.com\/max\/800\/1*KUQSMz2mVeOlUYvtSgvSRQ.gif)\n\n\n*The air around India Gate in Delhi, before and after Lockdown*\n*Source: https:\/\/www.theguardian.com\/environment\/2020\/apr\/11\/positively-alpine-disbelief-air-pollution-falls-lockdown-coronavirus*\n\nOn March 25 2020, the Indian government placed its population of more than 1.3 billion citizens under lockdown in an effort to reduce the spread of the COVID-19 disease. All non-essential shops, markets and places of worship were closed with only essential services including water, electricity and health services remaining active.\n\nCitizens started to experience better air quality so much so that the scenic Dhauladhar Peaks of Himachal Pradesh became visible from neighbouring states. On normal days, these peaks lie hidden behind he film of smog.\n\n![](https:\/\/pbs.twimg.com\/media\/EUqZ7QIVAAA5Dz1?format=jpg&name=large)\n\n*source: https:\/\/twitter.com\/manaman_chhina\/status\/1245977571625299968*\n\n## Objective\n\nHere we have access to a large amount of granular data relating to the  concentration of major air pollutants in India and it will be interesting to see if the claim of reduced air pollution is being actually backed by data. Before going further let's understand about the constituents of Air Pollution\n\n## Types of Air Pollutants\n\nLet's first try and understand the various types of air pollutants in the datasets. On a broader level, these pollutants can be classified as :\n\n![](https:\/\/imgur.com\/C4q7gwX.png)\n\n* **Particulate matter (PM2.5 and PM10)**\n>\nParticulate matter is a mix of solids and liquids, including carbon, complex organic chemicals, sulphates, nitrates, mineral dust, and water suspended in the air. PM varies in size. Some particles, such as dust, soot, dirt or smoke are large or dark enough to be seen with the naked eye. But the most damaging particles are the smaller particles, known as PM10 and PM2.5.[Source](https:\/\/www.blf.org.uk\/support-for-you\/air-pollution\/types). The following diagram will help to understand the concept more concretely.\n\n* **Nitrogen Oxides** (NO, NO<sub>2<\/sub>, NO<sub>x<\/sub>)\n>\nNitrogen oxides are a group of seven gases and compounds composed of nitrogen and oxygen, sometimes collectively known as NOx gases.The two most common and hazardous oxides of nitrogen are nitric oxide(NO) and nitrogen dioxide(NO<sub>2<\/sub>)\n\n* **Sulphur Dioxide**(SO<sub>2<\/sub>)\n>\nSulfur dioxide, or SO<sub>2<\/sub> is a colorless gas with a strong odor, similar to a just-struck match. It is formed when fuel containing sulfur, such as coal and oil, is burned, creating air pollution.\n\n* **Carbon Monoxide**(CO)\n>\nCarbon monoxide is a colorless, highly poisonous gas. Under pressure, it becomes a liquid. It is produced by burning gasoline, natural gas, charcoal, wood, and other fuels.\n\n* **Benzene, Toluene and Xylene** (BTX)\n>\nBenzene, toluene, xylene, and formaldehyde are well-known indoor air pollutants, especially after house decoration. They are also common pollutants in the working places of the plastic industry, chemical industry, and leather industry\n\n* **Ammonia**( NH<sub>3<\/sub>)\n>\n[Ammonia pollution](https:\/\/en.wikipedia.org\/wiki\/Ammonia_pollution) is pollution by the chemical ammonia (NH3) \u2013 a compound of nitrogen and hydrogen which is a byproduct of agriculture and industry.\n\n* **Ozone**(O<sub>3<\/sub>)\n>\n[Ground-level ozone](https:\/\/www.canada.ca\/en\/environment-climate-change\/services\/air-pollution\/pollutants\/common-contaminants\/ground-level-ozone.html) is a colorless and highly irritating gas that forms just above the earth's surface. It is called a \"secondary\" pollutant because it is produced when two primary pollutants react in sunlight and stagnant air. These two primary pollutants are nitrogen oxides (NOx) and volatile organic compounds (VOCs).\n\n## Methodology\n\nIn this notebook, the analysis has been done in two parts:\n\n* Analysis of the pollution level in India, over the years - from 2015 to 2020\n> This will a holistic view of how the pollutant levels have been rising in India and what is the current situation.\n\n*  Effect of Locksown on the Pollution level in India\n> Here we shall examine the pollution level in India before and after the first stage of Lockdown.\n> Also we shall compare the pollution level around the same months in 2019, to see the the difference, if any.\n> Additionally we could also examine the difference between the the current dates and the winter months(October, November) of 2019 when the pollution levels are generally the highest in Northern parts of India.\n\n\nAnalyzing data under these different categories should give us a fair idea of the effect of Lockdown on the Indian pollution level.","8dac0669":"## <a> 1.2 Cities in the dataset<\/a>","095a56ba":"> Range Slider\n\nThere is a Time slider in the above graph. A range slider allows users to pan and zoom the X-axis while maintaining an overview of the chart. ","7c2fd17f":"## <a> 2.1 Combining the Benzene, Toluene and Xylene levels into one column - BTX<\/a>","afbff3c8":"# <a> 3. Most Polluted Indian Cities <\/a>\n\nLet's now look at the Indian cities which contribute to maximum pollution. We shall output the top 10 cities in each pollutant category by mean concentration of the pollutant over the years.Government of India has laid down [National Ambient Air Quality standards (NAAQS)](http:\/\/www.indiaenvironmentportal.org.in\/files\/file\/Permissible%20Level%20for%20Pollutants.pdf) for twelve air pollutants, namely, PM10, PM2.5, Carbon Monoxide (CO), Sulphur Dioxide (SO2), Nitrogen Dioxide (NO2), Ammonia (NH3), ground level Ozone (O3), Lead,\nArsenic, Nickel, Benzene and Benzo (a) Pyrene. The relevant standards are mentioned below:\n\n![](https:\/\/imgur.com\/3GqVxly.png)","8a135c1f":"> ** \ud83d\udccc Points to note :** \n> * Clearly, the Satellite images give a stunning picture of the present and past conditions which are clerly visible in the maps above.\n","018ce445":"# <a>2. Analysing the complete City Level Daily Data<\/a>\n\nLet's now analyse the work with the data to see what patterns and insights we can uncover from it.","169754a3":"## <a> 2.4 Year and Month wise distribution <\/a>\n\nNext, let\u2019s further explore the seasonality of our data with box plots. We shall use boxplots to group the data by different time periods and display the distributions for each group. We\u2019ll group the data by year and month. All measurements are in `ug \/ m3`.\n\n### <a> 2.4.1 NO<sub>2<\/sub> <\/a>","5e1d930a":"\n# <a> 1. A first look at City level- daily data<\/a>\n\nWe have daily and hourly city data as well as daily and hourly Station data. Station refers to the continuous pollution monitoring stations operated and maintained by the Central Pollution Control Board (CPCB) and the State Pollution Control Boards. \nLet's begin by analyzing the various cities' daily data to get a big picture. We shall begin by importing the dataset and the necessary libraries for the analysis.\n","f45f8997":"# <a> 5 Effect of Lockdown on levels of Individual pollutants <a> \nLet's compare the level of pollutants between January and April between between 2020 and 2019. This will give an idea whether the pollution levels have actually subsided or the pollution actually remains low during the onset of summer in India.\n    \n## <a> 5.1 A comparison between pollution levels in 2020 VS 2019    ","2f3c7276":"## <a> 2.2 Combining the PM2.5 and PM10 into one column - Particulate Matter<\/a>","4f798c82":"## <a> 4.3 AQI in 2020 <\/a>\n\nLet plot a racing bar chart to see the overall AQI in 2020. Please refer to https:\/\/github.com\/dexplo\/bar_chart_race for the code.","c67c5809":"> ** \ud83d\udccc Points to note :** \n> * There is a clear trend that pollution level in India falls in the month of July and August. This might be majorly because monsoon sesason sets in during these months.The BTX levels additionally show a major decline around April.\n> * The pollution level then start rising and reach highest leveks in winter months. Again, its during these months that a lot of crop residue burning takes place,especially in northern parts of India.\n> * SO2 level has started increasing after 2017, although it had also seen a sudden rise in 2015 also. The same pattern is also reflected in BTX levels also.\n> * The median values of 2020 are generally less as compared to other years giving us a sense that there might be a reduction on pollution lately.\n\n","c520e4db":"> ** \ud83d\udccc Points to note :** \n> * It is interesting to note that the Polluiton level in India genrally drops down as summer approaches. This can also be corroborated by the graphs above.\n> * However, the reduction in march 2020 is more pronounced as compared to march 2019","7e340ef4":"# <a> 6. Geographical Analysis using Dual Maps <\/a>\nA dual map let's you compare the values side by side.By clicking on the icons, you can see the value of AQI on the popups<\/a>\n\n","02ec27f0":"## <a> 2.3 Visualising yearly data <\/a>\n\nI'll plot the data as dots instead of lines since with so many data points, the line plot will become crowded and will be hard to read.","7a97ae12":"<a> [TROPOMI Explorer App](https:\/\/showcase.earthengine.app\/view\/tropomi-explorer#dataset=Nitrogen%20dioxide;datatype=Near-real-time;center=%7B%22type%22%3A%22Point%22%2C%22coordinates%22%3A%5B9.502%2C45.566%5D%7D;aoi=%7B%22type%22%3A%22Point%22%2C%22coordinates%22%3A%5B9.502%2C45.566%5D%7D;cloud=10;leftdate=2020-01-01;rightdate=2020-02-01;min=20;max=400;swipe=false;chart=cont;zoom=4;) <\/a>\n\nThe TROPOMI Explorer App is an application to visualize air pollutant time series data.It facilitates quick and easy S5P TROPOMI data exploration and provide a jumping-off point for further analysis,\n\n## Near Real-Time Nitrogen Dioxide levels comparison\n\n\n![](https:\/\/imgur.com\/qYAnwOg.gif)\n![Screenshot%202020-05-17%20at%208.55.50%20AM.png](attachment:Screenshot%202020-05-17%20at%208.55.50%20AM.png)\n\n\n## Near Real-Time Sulphur Dioxide levels comparison\n\n![](https:\/\/imgur.com\/MhCpw19.gif)\n![Screenshot%202020-05-17%20at%208.56.01%20AM.png](attachment:Screenshot%202020-05-17%20at%208.56.01%20AM.png)"}}