{"cell_type":{"89d29113":"code","30e29e8a":"code","9585ee05":"code","6c2b0aaa":"code","9a670a4a":"code","b5c7ecbc":"code","4d3248c9":"code","73c2cd37":"code","d2b18501":"code","2fd53e66":"code","7ebfd9b9":"code","81d18e1f":"code","16d13abb":"code","15611d5e":"code","f6ed68d8":"code","d70c86b4":"code","4e0a741e":"code","c7cd832d":"markdown","87ee2f66":"markdown","64127bfb":"markdown","fe415652":"markdown","764dbbd1":"markdown","6a8deee4":"markdown","d43431c7":"markdown","f17a7def":"markdown","8b101055":"markdown","ad2edb15":"markdown","e9f1414b":"markdown","0338ab54":"markdown","cc7b235e":"markdown","ca786b60":"markdown","6e4c77e2":"markdown","ec02905a":"markdown","4f9e8045":"markdown","59f1305e":"markdown","3c746282":"markdown","d81d4850":"markdown","ab5180f6":"markdown","f3160fe4":"markdown","57f84a85":"markdown","71ea2ae1":"markdown","7253f072":"markdown","e92c2b04":"markdown","ac6ba523":"markdown","8f801305":"markdown","0f5cd957":"markdown","0a0e6dda":"markdown"},"source":{"89d29113":"import spacy\nnlp = spacy.load('en_core_web_sm')","30e29e8a":"import pandas as pd\nimport numpy as np","9585ee05":"val = pd.read_csv(\"..\/input\/jigsaw-toxic-severity-rating\/validation_data.csv\")\nval.head()","6c2b0aaa":"doc = nlp(val.loc[1,\"less_toxic\"])","9a670a4a":"for token in doc:\n    print(token)","b5c7ecbc":"print(f\"Token \\t\\tLemma \\t\\tStopword\".format('Token', 'Lemma', 'Stopword'))\nprint(\"-\"*40)\nfor token in doc:\n    print(f\"{str(token)}\\t\\t{token.lemma_}\\t\\t{token.is_stop}\")","4d3248c9":"doc = nlp(\"alfisoedcos soekjcoke goed\")","73c2cd37":"for token in doc:\n    print(token)","d2b18501":"print(f\"Token \\t\\tLemma \\t\\tStopword\".format('Token', 'Lemma', 'Stopword'))\nprint(\"-\"*40)\nfor token in doc:\n    print(f\"{str(token)}\\t\\t{token.lemma_}\\t\\t{token.is_stop}\")","2fd53e66":"from spacy.matcher import PhraseMatcher\nmatcher = PhraseMatcher(nlp.vocab, attr='LOWER')","7ebfd9b9":"print(val.loc[3,\"more_toxic\"])","81d18e1f":"toxic = ['bitch', 'hole out', 'Might', 'vagina']\npatterns = [nlp(text) for text in toxic]\nmatcher.add(\"ToxicList\", patterns)","16d13abb":"text_doc = nlp(val.loc[3,\"more_toxic\"]) \nmatches = matcher(text_doc)\nprint(matches)","15611d5e":"match_id, start, end = matches[0]\nprint(nlp.vocab.strings[match_id], text_doc[start:end])","f6ed68d8":"notoxic = ['you', 'sand', 'have', 'want']\npatterns = [nlp(text) for text in notoxic]\nmatcher.add(\"NoToxicList\", patterns)","d70c86b4":"matches = matcher(text_doc)\nprint(matches)","4e0a741e":"match_id, start, end = matches[0]\nprint(nlp.vocab.strings[match_id], text_doc[start:end])","c7cd832d":"**Reimu:Space is stopword?  \n<img src=\"https:\/\/3.bp.blogspot.com\/-KmQQLtEkmLw\/U1T3r7D0NdI\/AAAAAAAAfVI\/c2d4n2kG00U\/s400\/figure_question.png\" width = 100>  \nMarisa:\"do\",\"first\",\"someone\", and \"there\" are stopword.**","87ee2f66":"<img src=\"https:\/\/3.bp.blogspot.com\/-KmQQLtEkmLw\/U1T3r7D0NdI\/AAAAAAAAfVI\/c2d4n2kG00U\/s400\/figure_question.png\" width = 100>","64127bfb":"**Marisa:Matcher can add some patterns.**","fe415652":"**Marisa:Today,I will do NLP tutorial \"Intro to NLP\" with Jigsaw data.**","764dbbd1":"# Intro\n\nData comes in many different forms: time stamps, sensor readings, images, categorical labels, and so much more. But text is still some of the most valuable data out there for those who know how to use it.  \n\nIn this course about **Natural Language Processing (NLP)**, you will use the leading NLP library (spaCy) to take on some of the most important tasks in working with text. \n\nBy the end, you will be able to use spaCy for:\n\n* Basic text processing and pattern matching\n* Building machine learning models with text\n* Representing text with word embeddings that numerically capture the meaning of words and documents","6a8deee4":"Then you create a document from the text to search and use the phrase matcher to find where the terms occur in the text.","d43431c7":"**Marisa:Match_id is id of pattarn List.**","f17a7def":"pixyz  \nlast update 2021 11 16  \nYukkurisitettene!","8b101055":"**Marisa:Today I use val[1] data.**","ad2edb15":"Iterating through a document gives you token objects. Each of these tokens comes with additional information. In most cases, the important ones are `token.lemma_` and `token.is_stop`.\n\n# Text preprocessing\n\nThere are a few types of preprocessing to improve how we model with words. The first is \"lemmatizing.\"\nThe \"lemma\" of a word is its base form.  For example, \"walk\" is the lemma of the word \"walking\". So, when you lemmatize the word walking, you would convert it to walk.\n\nIt's also common to remove stopwords. Stopwords are words that occur frequently in the language and don't contain much information. English  stopwords include \"the\", \"is\", \"and\", \"but\", \"not\". \n\nWith a spaCy token, `token.lemma_` returns the lemma, while `token.is_stop` returns a boolean `True` if the token is a stopword (and `False` otherwise).","e9f1414b":"With the model loaded, you can process text like this:","0338ab54":"<img src=\"https:\/\/1.bp.blogspot.com\/-cBUxaN5pO5k\/XAY6GlahvxI\/AAAAAAABQhM\/BB-ii4y4EF0wkNOHMCvVh5lf8K9nXsLTACLcBGAs\/s450\/pose_english_wow_woman.png\" width = 200>","cc7b235e":"<img src=\"https:\/\/3.bp.blogspot.com\/-KmQQLtEkmLw\/U1T3r7D0NdI\/AAAAAAAAfVI\/c2d4n2kG00U\/s400\/figure_question.png\" width = 100>","ca786b60":"Why are lemmas and identifying stopwords important? Language data has a lot of noise mixed in with informative content. In the sentence above, the important words are tea, healthy and calming. Removing stop words might help the predictive model focus on relevant words. Lemmatizing similarly helps by combining multiple forms of the same word into one base form (\"calming\", \"calms\", \"calmed\" would all change to \"calm\").\n\nHowever, lemmatizing and dropping stopwords might result in your models performing worse. So you should treat this preprocessing as part of your hyperparameter optimization process.","6e4c77e2":"There's a lot you can do with the `doc` object you just created.\n\n# Tokenizing\n\nThis returns a document object that contains **tokens**. A token is a unit of text in the document, such as individual words and punctuation. SpaCy splits contractions like \"don't\" into two tokens, \"do\" and \"n't\". You can see the tokens by iterating through the document.","ec02905a":"To get the most out of this course, you'll need some experience with machine learning. If you don't have experience with scikit-learn, check out [Intro to Machine Learning](https:\/\/www.kaggle.com\/learn\/intro-to-machine-learning) and [Intermediate Machine Learning](https:\/\/www.kaggle.com\/learn\/intermediate-machine-learning) to learn the fundamentals.","4f9e8045":"# Pattern Matching\n\nAnother common NLP task is matching tokens or phrases within chunks of text or whole documents. You can do pattern matching with regular expressions, but spaCy's matching capabilities tend to be easier to use.\n\nTo match individual tokens, you create a `Matcher`. When you want to match a list of terms, it's easier and more efficient to use `PhraseMatcher`. For example, if you want to find where different smartphone models show up in some text, you can create patterns for the model names of interest. First you create the `PhraseMatcher` itself.","59f1305e":"[![](https:\/\/img.youtube.com\/vi\/FnV0thLS1Fs\/0.jpg)](https:\/\/www.youtube.com\/watch?v=FnV0thLS1Fs)","3c746282":"**Reimu:If nlp input not exist word,what nlp do?**","d81d4850":"## NLP with spaCy\n\nspaCy is the leading library for NLP, and it has quickly become one of the most popular Python frameworks. Most people find it intuitive, and it has excellent [documentation](https:\/\/spacy.io\/usage).\n\nspaCy relies on **models** that are language-specific and come in different sizes. You can load a spaCy model with `spacy.load`. \n\nFor example, here's how you would load the English language model.","ab5180f6":"**Reimu:What is match_id?**","f3160fe4":"**Marisa:Let's input valdation_data.**","57f84a85":"<img src=\"https:\/\/3.bp.blogspot.com\/-KmQQLtEkmLw\/U1T3r7D0NdI\/AAAAAAAAfVI\/c2d4n2kG00U\/s400\/figure_question.png\" width = 100>","71ea2ae1":"The matcher is created using the vocabulary of your model. Here we're using the small English model you loaded earlier. Setting `attr='LOWER'` will match the phrases on lowercased text. This provides case insensitive matching.\n\nNext you create a list of terms to match in the text. The phrase matcher needs the patterns as document objects. The easiest way to get these is with a list comprehension using the `nlp` model.","7253f072":"**Reimu:\"goed\" change \"go\" !?  \nMarisa:If nlp recieve no exist word, it behaves strangely**","e92c2b04":"---\n\n\n\n\n*Have questions or comments? Visit the [course discussion forum](https:\/\/www.kaggle.com\/learn\/natural-language-processing\/discussion) to chat with other learners.*","ac6ba523":"The matches here are a tuple of the match id and the positions of the start and end of the phrase.","8f801305":"**Reimu:spaCy?**","0f5cd957":"**Reimu:I can see two kind match_id!**","0a0e6dda":"**Reimu:Does token inculued indection?**"}}