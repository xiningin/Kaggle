{"cell_type":{"558808ce":"code","0f132115":"code","eac3462a":"code","45f0ff4b":"code","12be2f73":"code","2e8862f5":"code","3c65979b":"code","2d908e88":"code","e6f2c4be":"code","7578e24c":"code","7dc43177":"code","794d7aaa":"code","ecbcb7ce":"code","2e2a1bb6":"code","e8fbb728":"code","58b53601":"code","86a8da57":"code","765469fd":"code","30d8497a":"code","a9ae84da":"code","253ee129":"code","6c11fa07":"code","881c2349":"code","6ec07c9f":"code","5ffa9ec1":"code","f7aa8702":"code","b662167b":"code","0900b750":"code","c1c01f43":"code","0e05ea58":"code","f81ebcb5":"code","de76cd8c":"code","5c8d743f":"code","2bea1043":"code","ea0170bb":"code","5f4464d4":"code","b0455e5b":"code","661034dd":"code","75931e73":"code","c77820dd":"code","71ba4039":"code","33b340e4":"code","7e376ec1":"code","05840398":"code","676cd932":"code","b8fb13d4":"code","b4907d2b":"code","0d2cc975":"code","c5ddd4d0":"code","027c0dba":"code","f27467f2":"code","5566078f":"code","7b7ab8c0":"code","66a5a0ea":"code","92ad925d":"code","ea79cca4":"code","09a2aa6a":"code","5e4da292":"code","36f01d5b":"code","9367e8e4":"code","174984cc":"code","59a98dca":"code","2faf81fa":"code","98b4bc7c":"code","d9ccdd0b":"code","ee25e658":"code","59dd43a7":"code","f3fb436d":"code","238c5135":"code","404c6a8d":"code","c02378b1":"code","778cee97":"code","b505da9a":"code","35255cc5":"code","d80b584a":"code","10d56a96":"code","d815c511":"code","c619f6c5":"code","e5dd4f71":"code","a7cc1976":"code","a5088bce":"code","c4fac049":"code","b3903caf":"code","67ac78b1":"code","1fdc2286":"code","6aa15fee":"code","db1ccf52":"code","f751dba5":"code","f9b92bd6":"code","21bbf8e5":"code","67d5e928":"code","4d2db072":"code","0d13af59":"code","2113b9bd":"code","fabbf624":"code","06ac4965":"code","eb104021":"code","9782aa0c":"code","67f26876":"code","a2661b23":"code","418d7690":"code","44ebea77":"code","154cd6dc":"code","d1c60b02":"code","ff95bf03":"code","01c58460":"code","44e1f075":"code","be793b5d":"code","56ad71d1":"code","0c20888f":"markdown","48b1d662":"markdown","794da8ae":"markdown","15105283":"markdown","6314b5e4":"markdown","1f95aaab":"markdown","72295794":"markdown","8654b4bf":"markdown","0cfe16af":"markdown","f09b6ba6":"markdown","60ceb58b":"markdown","a57c1542":"markdown","c1ae5146":"markdown","cc02fbb8":"markdown","ad102c78":"markdown","16b3228b":"markdown","e6d61fcf":"markdown","bcacdcbf":"markdown","b017d21f":"markdown","301c4fc5":"markdown","f795b7f9":"markdown","d9c69cd7":"markdown","b6ef34d9":"markdown","6b08ca16":"markdown","9c47ad28":"markdown","51299414":"markdown","df66239e":"markdown","777f56a1":"markdown","e990f2e6":"markdown","6e7ea7fb":"markdown","1fb99ae7":"markdown","818bab70":"markdown","6d0084ee":"markdown","47675e99":"markdown","92ac1df6":"markdown","a8f0d48c":"markdown","b4c57d3e":"markdown"},"source":{"558808ce":"import pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt","0f132115":"tt_df=pd.read_csv('\/kaggle\/input\/titanic\/train.csv')\n\n","eac3462a":"#### Reading test data\ntt_df_test=pd.read_csv('\/kaggle\/input\/titanic\/test.csv')\n\n\n","45f0ff4b":"tt_df","12be2f73":"tt_df.info()","2e8862f5":"tt_df.shape","3c65979b":"(891-714)\/891*100\n","2d908e88":"(891-204)\/891*100","e6f2c4be":"tt_df_clean=tt_df.drop('Cabin',axis=1)","7578e24c":"tt_df_clean=tt_df_clean.drop(['PassengerId','Name'],axis=1)","7dc43177":"tt_df_clean.describe()","794d7aaa":"sns.boxplot(tt_df_clean['Fare'])","ecbcb7ce":"tt_df_clean[tt_df_clean['Fare']>150]","2e2a1bb6":"tt_df_clean=tt_df_clean[tt_df_clean['Fare']<150]","e8fbb728":"tt_df_clean.describe()","58b53601":"tt_df_clean.shape","86a8da57":"sns.boxplot(tt_df_clean['Age'])","765469fd":"tt_df_clean[tt_df_clean['Age']>65]","30d8497a":"tt_df_clean=tt_df_clean[tt_df_clean['Age']<66]","a9ae84da":"sns.boxplot(tt_df_clean['Age'])","253ee129":"tt_df_clean.describe()","6c11fa07":"tt_df_clean","881c2349":"tt_df_clean.Age=tt_df_clean.Age.fillna(tt_df_clean.Age.mean())","6ec07c9f":"tt_df_clean.isnull().sum()","5ffa9ec1":"tt_df_clean.Embarked=tt_df_clean.Embarked.fillna('S')","f7aa8702":"tt_df_clean[tt_df_clean.Embarked.isnull()]","b662167b":"tt_df_clean.Embarked.mode()","0900b750":"tt_df_clean.isnull().sum()","c1c01f43":"tt_df_clean","0e05ea58":"tt_df_clean.Sex.value_counts()","f81ebcb5":"tt_df_clean.Sex=tt_df_clean.Sex.apply(lambda x: 1 if x==\"male\" else 0)","de76cd8c":"tt_df_clean.Sex.value_counts()","5c8d743f":"#### Ticket can be removed\ntt_df_clean.drop('Ticket',inplace=True,axis=1)","2bea1043":"tt_df_clean.Embarked.value_counts()","ea0170bb":"dm=pd.get_dummies(tt_df_clean.Embarked)","5f4464d4":"tt_df_clean=pd.concat([tt_df_clean,dm],axis=1)","b0455e5b":"tt_df_clean.drop('Embarked',inplace=True,axis=1)","661034dd":"tt_df_clean","75931e73":"plt.figure(figsize=(20,20))\nsns.heatmap(tt_df_clean.corr(),annot=True)\nplt.show()","c77820dd":"tt_df_clean.drop('S',axis=1,inplace=True)","71ba4039":"tt_df_clean","33b340e4":"plt.figure(figsize=(20,20))\nsns.heatmap(tt_df_clean.corr(),annot=True)\nplt.show()","7e376ec1":"sns.barplot(data=tt_df_clean,x='Pclass',y='Survived')","05840398":"sns.barplot(data=tt_df_clean,x='Sex',y='Survived')","676cd932":"tt_df_clean.describe()","b8fb13d4":"tt_df_clean['Age_bin']=pd.qcut(tt_df_clean['Age'],q=4)\n","b4907d2b":"tt_df_clean","0d2cc975":"plt.figure(figsize=(20,20))\nsns.barplot(data=tt_df_clean,x='Age_bin',y='Survived')\nplt.show()","c5ddd4d0":"sns.boxplot(data=tt_df_clean,x='Survived',y='Age')","027c0dba":"tt_df_clean.describe()","f27467f2":"sns.barplot(data=tt_df_clean,x='SibSp',y='Survived')","5566078f":"sns.barplot(data=tt_df_clean,x='Parch',y='Survived')","7b7ab8c0":"#sns.barplot(data=tt_df_clean,x='Fare',y='Survived')\nsns.boxplot(data=tt_df_clean,x='Survived',y='Fare')","66a5a0ea":"sns.barplot(data=tt_df_clean,x='C',y='Survived')","92ad925d":"sns.barplot(data=tt_df_clean,x='Q',y='Survived')","ea79cca4":"tt_df_clean.drop('Age_bin',axis=1,inplace=True)","09a2aa6a":"tt_df_clean","5e4da292":"from sklearn.model_selection import train_test_split","36f01d5b":"Y=tt_df_clean.pop('Survived')\nX=tt_df_clean","9367e8e4":"Y","174984cc":"X_train,X_test,Y_train,Y_test=train_test_split(X,Y,test_size=0.2,random_state=42)","59a98dca":"X_train.shape","2faf81fa":"X_test.shape","98b4bc7c":"from sklearn.linear_model import LogisticRegression","d9ccdd0b":"lr=LogisticRegression()","ee25e658":"lr.fit(X_train,Y_train)","59dd43a7":"Y_pred=lr.predict(X_test)","f3fb436d":"from sklearn.metrics import confusion_matrix","238c5135":"confusion_matrix=confusion_matrix(Y_test,Y_pred)","404c6a8d":"print(confusion_matrix)","c02378b1":"from sklearn.metrics import accuracy_score","778cee97":"print(\"accuracy score\",accuracy_score(Y_pred,Y_test)*100)","b505da9a":"from sklearn.metrics import classification_report\nprint(classification_report(Y_test,Y_pred))","35255cc5":"from sklearn.metrics import roc_auc_score\nfrom sklearn.metrics import roc_curve","d80b584a":"logit_roc_auc = roc_auc_score(Y_test, lr.predict(X_test))\nfpr, tpr, thresholds = roc_curve(Y_test, lr.predict_proba(X_test)[:,1])\nplt.figure()\nplt.plot(fpr, tpr, label='Logistic Regression (area = %0.2f)' % logit_roc_auc)\nplt.plot([0, 1], [0, 1],'r--')\nplt.xlim([0.0, 1.0])\nplt.ylim([0.0, 1.05])\nplt.xlabel('False Positive Rate')\nplt.ylabel('True Positive Rate')\nplt.title('Receiver operating characteristic')\nplt.legend(loc=\"lower right\")\nplt.savefig('Log_ROC')\nplt.show()","10d56a96":"from sklearn.tree import DecisionTreeClassifier","d815c511":"clf_gini = DecisionTreeClassifier(criterion = \"gini\",random_state = 42)","c619f6c5":"clf_gini.fit(X_train,Y_train)","e5dd4f71":"Y_pred_dt=clf_gini.predict(X_test)","a7cc1976":"print(\"accuracy score on test data\",accuracy_score(Y_test,Y_pred_dt))","a5088bce":"Y_pred_train=clf_gini.predict(X_train)","c4fac049":"print(\"accuracy score on train data\",accuracy_score(Y_train,Y_pred_train))","b3903caf":"from sklearn.ensemble import RandomForestClassifier\nfrom sklearn.model_selection import GridSearchCV","67ac78b1":"rf=RandomForestClassifier(random_state=42)","1fdc2286":"param_grid = { \n    'n_estimators': [10,20,30,40,50,100],\n    'max_depth' : [2,3,4,5,6,7,8],\n    'criterion' :['gini', 'entropy']\n}","6aa15fee":"CV_rfc = GridSearchCV(estimator=rf, param_grid=param_grid, cv= 5)\nCV_rfc.fit(X_train, Y_train)","db1ccf52":"CV_rfc.best_params_","f751dba5":"rfb=RandomForestClassifier(random_state=42,max_depth=7,n_estimators=20,criterion='gini')","f9b92bd6":"rfb.fit(X_train,Y_train)","21bbf8e5":"Y_pred_rfrst=rfb.predict(X_test)","67d5e928":"print(\"Accuracy for Random Forest on CV data: \",accuracy_score(Y_test,Y_pred_rfrst))","4d2db072":"Y_pred_rfrst_train=rfb.predict(X_train)","0d13af59":"print(\"Accuracy for Random Forest on CV train data: \",accuracy_score(Y_train,Y_pred_rfrst_train))","2113b9bd":"tt_df_test","fabbf624":"tt_df_test.drop(['PassengerId','Name','Ticket','Cabin'],axis=1,inplace=True)","06ac4965":"tt_df_test.Sex=tt_df_test.Sex.apply(lambda x: 1 if x==\"male\" else 0)","eb104021":"gn=pd.get_dummies(tt_df_test['Embarked'])","9782aa0c":"tt_df_test=pd.concat([tt_df_test,gn],axis=1)","67f26876":"tt_df_test.drop('S',inplace=True,axis=1)","a2661b23":"tt_df_test.Age=tt_df_test.Age.fillna(tt_df_test.Age.mean())","418d7690":"tt_df_test.Fare=tt_df_test.Fare.fillna(tt_df_test.Fare.mean())","44ebea77":"tt_df_test.info()","154cd6dc":"tt_df_test.drop('Embarked',axis=1,inplace=True)","d1c60b02":"Y_pred_given_test=rfb.predict(tt_df_test)","ff95bf03":"df_submission=pd.read_csv('\/kaggle\/input\/titanic\/gender_submission.csv')\n","01c58460":"df_submission","44e1f075":"df_submission[\"Survived\"]=Y_pred_given_test","be793b5d":"df_submission","56ad71d1":"#df_submission.to_csv('\/kaggle\/input\/titanic\/gender_submission.csv', index = False)","0c20888f":"#### Buliding logistic regression","48b1d662":"#### EDA\n###### Check for nulls","794da8ae":"#### Convert categorical varaibles ","15105283":"#### Grid search cv for best hyper parameter","6314b5e4":"#### Create train and test sets","1f95aaab":"#### Convert Embarked to dummies","72295794":"#### outliers with respect to age can be removed.The survival of ageded persons is difficult ","8654b4bf":"### % missing values in Cabin","0cfe16af":"#### Confusion matrix","f09b6ba6":"#### Check for outliers for Fare by using box plot","60ceb58b":"#### Data cleaning on test data","a57c1542":"#### Check correlation among varibles","c1ae5146":"### % missing values in Age","cc02fbb8":"#### Embarked S and C are strongly correlated,hence one of them can be dropped.Dropping S","ad102c78":"#### ROC curve","16b3228b":"#### Female survival percentage is more then male","e6d61fcf":"#### 1st class has more survival rate","bcacdcbf":"#### Embarked has missing values too.Lets check and fill with mode","b017d21f":"#### Since 77% values are missing in cabin so it can be dropped","301c4fc5":"#### The age between 0 and 20 , 28 and 38 have more survival rate than others","f795b7f9":"### Bivariate analysis","d9c69cd7":"#### We see missing values for Age and Cabin","b6ef34d9":"#### PassengerID and Name are unique columns and can be dropped ","6b08ca16":"#### Classification using random forest","9c47ad28":"#### check numerical variables for any outliers","51299414":"##### Accuracy on given test data","df66239e":"#### Fill missing values of age with mean","777f56a1":"#### Parch with son have more survival rate","e990f2e6":"#### outliers can be removed","6e7ea7fb":"#### As Fare increased, surival rate is also increased.","1fb99ae7":"#### Convert Sex(male: 1, female:0)","818bab70":"### Binary classification using Decision trees.","6d0084ee":"#### Sibling with sister have more survival rate","47675e99":"#### Model Accuracy","92ac1df6":"##### 1st = Upper\n##### 2nd = Middle\n##### 3rd = Lower","a8f0d48c":"#### Females have more survival rate.","b4c57d3e":"It seems model is overfit with decision trees"}}