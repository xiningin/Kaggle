{"cell_type":{"ea74e036":"code","ad761e08":"code","b8e0e556":"code","55935d78":"code","15b328c6":"code","f8354913":"code","0d39c644":"code","d2f61c2f":"code","6572a2a9":"code","467e578a":"code","0b6792dd":"code","a85f6a78":"code","759c80b6":"code","8e6eb291":"markdown","2e2004fc":"markdown","b8c01eae":"markdown","5c2907ec":"markdown","13120691":"markdown","ad47ad1e":"markdown","f82f0085":"markdown","12935ba8":"markdown","6de08625":"markdown","408f62ad":"markdown","d23f38bb":"markdown","340df68d":"markdown","ef995890":"markdown","586bddcc":"markdown","f733187f":"markdown"},"source":{"ea74e036":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)","ad761e08":"crime_rates=pd.read_csv(\"..\/input\/USArrests.csv\", index_col=0)","b8e0e556":"crime_rates.head()","55935d78":"crime_rates.describe()","15b328c6":"#standardize the data to normal distribution\nfrom sklearn import preprocessing\ncrime_rates_standardized = preprocessing.scale(crime_rates)\nprint(crime_rates_standardized)\ncrime_rates_standardized = pd.DataFrame(crime_rates_standardized)","f8354913":"from sklearn.cluster import KMeans\nimport matplotlib.pyplot as plt\n%matplotlib inline\n\nplt.figure(figsize=(10, 8))\nwcss = []\nfor i in range(1, 11):\n    kmeans = KMeans(n_clusters = i, init = 'k-means++', random_state = 42)\n    kmeans.fit(crime_rates_standardized)\n    wcss.append(kmeans.inertia_) #criterion based on which K-means clustering works\nplt.plot(range(1, 11), wcss)\nplt.title('The Elbow Method')\nplt.xlabel('Number of clusters')\nplt.ylabel('WCSS')\nplt.show()","0d39c644":"# Fitting K-Means to the dataset\nkmeans = KMeans(n_clusters = 4, init = 'k-means++', random_state = 42)\ny_kmeans = kmeans.fit_predict(crime_rates_standardized)\n\ny_kmeans\n","d2f61c2f":"#beginning of  the cluster numbering with 1 instead of 0\ny_kmeans1=y_kmeans+1\n\n# New list called cluster\ncluster = list(y_kmeans1)\n# Adding cluster to our data set\ncrime_rates['cluster'] = cluster","6572a2a9":"#Mean of clusters 1 to 4\nkmeans_mean_cluster = pd.DataFrame(round(crime_rates.groupby('cluster').mean(),1))\nkmeans_mean_cluster","467e578a":"import seaborn as sns\n\nplt.figure(figsize=(12,6))\nsns.scatterplot(x=crime_rates['Murder'], y = crime_rates['Assault'],hue=y_kmeans1)","0b6792dd":"crime_rates[crime_rates['cluster']==1]","a85f6a78":"from IPython.display import HTML\nimport base64\n\ndf = crime_rates\ndef create_download_link( df, title = \"Download CSV file\", filename = \"data.csv\"):  \n    csv = df.to_csv()\n    b64 = base64.b64encode(csv.encode())\n    payload = b64.decode()\n    html = '<a download=\"{filename}\" href=\"data:text\/csv;base64,{payload}\" target=\"_blank\">{title}<\/a>'\n    html = html.format(payload=payload,title=title,filename=filename)\n    return HTML(html)\n\ncreate_download_link(df)","759c80b6":"%%HTML\n\n<div class='tableauPlaceholder' id='viz1558006161579' style='position: relative'>\n<noscript>\n<a href='#'>\n<img alt=' ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;US&#47;USCrimeRatesClusters&#47;Dashboard&#47;1_rss.png' style='border: none' \/><\/a>\n<\/noscript>\n\n<object class='tableauViz'  style='display:none;'>\n<param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' \/>\n<param name='embed_code_version' value='3' \/>\n<param name='site_root' value='' \/>\n<param name='name' value='USCrimeRatesClusters&#47;Dashboard' \/>\n<param name='tabs' value='no' \/>\n<param name='toolbar' value='yes' \/>\n<param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;US&#47;USCrimeRatesClusters&#47;Dashboard&#47;1.png' \/> <param name='animate_transition' value='yes' \/>\n<param name='display_static_image' value='yes' \/>\n<param name='display_spinner' value='yes' \/>\n<param name='display_overlay' value='yes' \/>\n<param name='display_count' value='yes' \/>\n<\/object>\n<\/div>               \n<script type='text\/javascript'>                    var divElement = document.getElementById('viz1558006161579');                    var vizElement = divElement.getElementsByTagName('object')[0];                    vizElement.style.width='700px';vizElement.style.height='527px';                    var scriptElement = document.createElement('script');                    scriptElement.src = 'https:\/\/public.tableau.com\/javascripts\/api\/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                <\/script>","8e6eb291":"[This helped](https:\/\/stackoverflow.com\/questions\/26098710\/rename-unnamed-column-pandas-dataframe) to create a data frame ready to be normalized from the originally imported csv.","2e2004fc":"# Normalizing data for any type of clustering","b8c01eae":"The scree plot levels off at **k=4** and let's use it to determine the clusters.","5c2907ec":"### What is random_state?","13120691":"This data set contains statistics, **in arrests per 100,000 residents** for assault, murder, and rape in each of the 50 US states in 1973. Also given is the percent of the population living in urban areas.","ad47ad1e":"The number of clusters has to be be decided when k-means clustering is used unlike hierarchical clustering. Let's start with creating scree plot. Scree plot is a plot between **WCSS** (Within cluster sum of squares) and number of clusters. Without sound domain knowledge or in the scenarios with unclear motives, the scree plots help us decide the number of clusters to specify.","f82f0085":"### States in cluster 1","12935ba8":"To set a seed and make the randomization more deterministic. Read [in detail](https:\/\/scikit-learn.org\/stable\/glossary.html#term-random-state).","6de08625":"### A tableau viz  - all the states split into clusters","408f62ad":"* https:\/\/medium.com\/@ikekramer\/tableau-visual-in-jupyter-notebook-7b9faf60e8fd\n* Download csv - https:\/\/medium.com\/ibm-data-science-experience\/how-to-upload-download-files-to-from-notebook-in-my-local-machine-6a4e65a15767\n* https:\/\/medium.com\/datadriveninvestor\/unsupervised-learning-with-python-k-means-and-hierarchical-clustering-f36ceeec919c","d23f38bb":"# K-means Clustering","340df68d":"# Insights","ef995890":"> The above scatter shows a distribution of how the states are scattered and clusters are visible based on `Murders` and `Assaults`. And there is a positive correlation between occurrence of `Murder` and `Assault` in different states.","586bddcc":"* **Cluster 3** - south western states (however, definition changes for different sources) maxes out in three (`Assault`, `Urbanpop`, `Rape`) out of four crimes.\n* **Cluster 4** stands out for minimum crime rate as the means of 3 crimes are least relative to other crimes\n* Coincidentally, most of the southern region states belong to **cluster 2** where `Murder`s seems to be popular.\n* The southern states in **cluster 4** have more number of average arrests\/ 100,000 persons in all the three crime categories than states (half of mid-western states) in **cluster 2** in spite of the average `Urbanpop` (%) being very close. For causality, more variables are needed apart from the number of arrests to understand the inferences like the above. For instance, it could be the density of people or number of people with a different socio-economic statuses in that state.","f733187f":"# Cheers to these references"}}