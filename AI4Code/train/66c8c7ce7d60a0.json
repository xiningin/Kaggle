{"cell_type":{"d20e3f84":"code","e091b228":"code","40e24ede":"code","405ca135":"code","275fcdf5":"code","3673867d":"code","2182917e":"code","08530c4d":"code","ff51c843":"code","dbf01dad":"code","ffcf4d79":"code","5983f548":"code","9fbabd1e":"code","327feafa":"code","66c391fa":"code","8ea9868d":"markdown","2ff0c0ad":"markdown","9bce9eaa":"markdown","10c32275":"markdown","84c14810":"markdown","0982edef":"markdown","0455d26b":"markdown","94e6cad6":"markdown","42c718a9":"markdown","03087c46":"markdown","23bac1c6":"markdown","08a97739":"markdown","d7097cab":"markdown","f205d5bb":"markdown"},"source":{"d20e3f84":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n\nimport matplotlib\nmatplotlib.rcParams['figure.figsize'] = [10, 10]\n\nimport matplotlib.pyplot as plt # For plotting the points.\nfrom IPython import display # A convinient way of plotting \nimport random\nimport time\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list the files in the input directory\n\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# Any results you write to the current directory are saved as output.","e091b228":"df = pd.read_csv(\"..\/input\/Mall_Customers.csv\")\ndf.head()","40e24ede":"data = df[['Annual Income (k$)', 'Spending Score (1-100)']]\npoints = data.values # Now you have a 2d array(list) of (x,y) points.\n\n# here is graph of our points.\ndata.plot(kind='scatter', x='Annual Income (k$)', y='Spending Score (1-100)')","405ca135":"def plot_points_by_centers(points, centers):\n    display.clear_output(wait=True)\n    plt.clf()\n    colors = ['magenta', 'blue', 'pink', 'black', 'green']\n    \n    label = \"Centeriods\"\n    for c in centers:\n        plt.scatter(c[0], c[1], color='red', label=label, marker = 'X', s=300)\n        label = \"_nolegend_\"\n\n    for p in points:\n        c = get_closest_centroids(p, centers)\n        i = centers.index(c)\n        plt.scatter(p[0], p[1], color=colors[i], alpha=1)\n\n        time.sleep(0.001)\n        \n    plt.xlabel('Annual Income (k$)')\n    plt.ylabel('Spending Score (1-100)')\n    plt.legend()\n    display.display(plt.gcf())\n    \ndef compute_residual_error(points, centers):\n    d_sum = 0\n    for p in points:\n        c = get_closest_centroids(p, centers)\n        d_sum += get_distance(c, p)\n        \n    return d_sum","275fcdf5":"def get_distance(p1, p2):\n    distance = ((p1[0]-p2[0])**2 + (p1[1] - p2[1])**2)**(1\/2)\n    return distance\n    pass\n \ndef get_closest_centroids(p, centroids):\n    min_p = []\n    min_distance = -1\n    for i in centroids:\n        d = get_distance(p,i)\n        if d < min_distance or min_distance == -1:\n            min_p = i\n            min_distance = d\n    return min_p\n  \n\ndef get_random_point(k):\n    import random\n    list = []\n    for i in range(k):\n        x = random.randint(0,100)\n        y = random.randint(0,100)\n        list.append([x,y])\n    return list\n\nprint(get_random_point(4))\n    \n    \ndef compute_array_mean(arr):\n    x_sum = 0\n    y_sum = 0\n    \n    for i in range (len(arr)):\n      \n        \n        x_sum += arr[i][0]\n        y_sum += arr[i][1]\n        \n        \n    return [x_sum\/(i+1), y_sum\/(i+1)]\n    '''\n    Compute the x and y mean of a 2d array of points\n    \n    Example : if arr=[[1, 4], [2, 6], [3, 8]] return value is : [2, 6]\n    '''","3673867d":"def test_get_distance():\n    if (get_distance([0.,0.], [2.,0.]) != 2):\n        print(\"p1 = [0,0], p2 = [2,0] and distance is not 2\")\n        return False\n    \n    if (get_distance([0, 0], [3,4]) != 5):\n        print(\"p1 = [0,0], p2=[3,4] and distance is not 5\")\n        return False\n    \n    if (get_distance([0, 0], [6,8]) != 10):\n        print(\"p1 = [0,0], p2=[6,8] and distance is not 10\")\n        return False\n    return True\n        \nif test_get_distance():\n    print (\"Test get_distance Passed!\")\nelse:\n    print (\"Test get_distance Failed!\")\n","2182917e":"def test_get_closest_centroids():\n    if get_closest_centroids([1,0], [[2,5], [3,0]]) != [3,0]:\n        print(\"p = [1,0], centroids = [[2,5], [3,0]], closest point is not [3,0]\")\n        return False\n    \n    if get_closest_centroids([2,1], [[3,2], [5,1], [2,2]]) != [2,2]:\n        print(\"p = [2,1], centroids = [[2,5], [3,0]], closest point is not [2,2]\")\n        return False\n    \n    if get_closest_centroids([1,4], [[2,5], [3,0]]) != [2,5]:\n        print(\"p = [1,4], centroids = [[2,5], [3,0]], closest point is not [2,5]\")\n        return False\n    \n    if get_closest_centroids([1,4], [[2,5], [3,0], [1,4], [5,5], [6,100]]) != [1,4]:\n        print(\"p = [1,4], centroids = [[2,5], [3,0], [1,4], [5,5], [6,100]], closest point is not [1,4]\")\n        return False\n    \n    return True\n\nif test_get_closest_centroids():\n    print (\"Test get_closest_centroids Passed!\")\nelse:\n    print (\"Test get_closest_centroids Failed!\")","08530c4d":"def test_get_random_point():\n    rnd_points = get_random_point(1)\n    if len(rnd_points) != 1 or len(rnd_points[0]) != 2:\n        return False\n    \n    rnd_points = get_random_point(2)\n    if len(rnd_points) != 2 or len(rnd_points[0]) != 2:\n        return False\n    \n    rnd_points = get_random_point(3)\n    if len(rnd_points) != 3 or len(rnd_points[0]) != 2:\n        return False\n    \n    return True\n        \nif test_get_random_point():\n    print (\"test_get_random_points Passed!\")\nelse:\n    print (\"test_get_random_points Failed!\")","ff51c843":"def test_compute_array_mean():\n    if compute_array_mean([[1,2], [1,2], [1,2]]) != [1, 2]:\n        print(\"arr = [[1,2], [1,2], [1,2]] but mean in not [1,2]\")\n        return False\n    \n    if compute_array_mean([[1,2], [2,4], [3,6]]) != [2, 4]:\n        print(\"arr = [[1,2], [2,4], [1,6]] but mean in not [2, 4]\")\n        return False\n    \n    if compute_array_mean([[0,2], [0,5], [0,8]]) != [0, 5]:\n        print(\"arr = [[0,2], [0,5], [0,8]] but mean in not [1, 5]\")\n        return False\n    \n    if compute_array_mean([[1,2], [2,2.5], [3,3.5], [4,4]]) != [2.5, 3]:\n        print(\"arr = [[1,2], [2,2.5], [3,3.5], [4,4]] but mean in not [2.5, 4]\")\n        return False\n    return True\n\nif test_compute_array_mean():\n    print (\"Test compute_array_mean Passed!\")\nelse:\n    print (\"Test compute_array_mean Failed!\")","dbf01dad":"import random\ndef k_means(points, k, t):\n    \"\"\"\n    K means algorithm\n    Given a set of points, k and t finds the best k centroids for clustering the points.\n    The algorithm runs for t iterations before coming to an halt.\n    \n    Returns the k best centroids(points) (those who minimize the overall distance.)\n    \"\"\"\n    centroids = get_random_point(k)\n    \n    for i in range(t):\n        \n        clusters = {i:[] for i in range(k)}\n    \n      \n        for p in points:\n            c = get_closest_centroids(p, centroids)\n            idx = centroids.index(c)\n            clusters[idx].append(p)\n            \n        plot_points_by_centers(points, centroids)\n\n        \n        for i in range(len(centroids)):\n            centroids[i]=compute_array_mean(clusters[i])\n\n    \n    # Leave this for plotting purposes.\n    display.clear_output(wait=True)\n    return centroids\n            \n    ","ffcf4d79":"centers_2 = k_means(points, 2, 20)\nr2 = compute_residual_error(points, centers_2)","5983f548":"centers_3 = k_means(points, 3, 20)\nr3 = compute_residual_error(points, centers_3)","9fbabd1e":"centers_4 = k_means(points, 4, 20)\nr4 = compute_residual_error(points, centers_4)\n    ","327feafa":"centers_5 = k_means(points, 5, 20)\nr5 = compute_residual_error(points, centers_5)","66c391fa":"plt.plot(range(2, 6), [r2, r3, r4, r5])\nplt.xlabel(\"K\")\nplt.ylabel(\"Residual Sum of Squares\")","8ea9868d":"# Loading the data\nWe start off by loading the data into a pandas dataframe which we talked about in trecitation 2.<br>\nWe use the head command to peek into the data\n\n### Just run the following cell no code needed.","2ff0c0ad":"### K-means with k=5","9bce9eaa":"# Plot behaviour\nWe will now plot the sum of residual error to see how it decrease as k increases","10c32275":"### K-means with k=4","84c14810":"## Running the k-means algorithm and visualizing the results.\nRun the following cells and see if your implementation is good.<br>\nThis will give you a better intution of how the algorithm works.<br>\nNotice that on each cell we run the k_means algorithm and then save the residual error in a variable.<br>\nAt the end we will use this variables to visualize how the error decreases as k increases.","0982edef":"Next, we take the 2 relevant features for our clustering : **Annual Income** and __Spending Score__\n\n### Just run the following cell no code needed.","0455d26b":"## K-means\nImplement the k-means algorithm in the next cell.<br>\nYou have the signature of the function.<br>\nIn class you talked about 2 stopping conditions:\n1. No change in cluster centers\n1. No change to cluster assignment.<br><br>\nFor simplicity reasons we are going to use a simpler stopping condition : <br>\nWe will run the algorithm for a fixed number of iterations. ","94e6cad6":"## Helper functions\nYou first assignment is to implement the functions in the cell below, <br>\nThis will make implementing the k-menas algorithm much simpler.","42c718a9":"## Test Methods\nRun the following cells to test your functions. <br>\nYou don't need to implement anything, but if at any of the cells you run and get an error <br>\nthis means your implementation is not good.","03087c46":"# End of Exercise\nTo submit the exercise, click *File* -> *Download Notebook*.<br>\nSubmit the downloaded file in the moodle under ex1.","23bac1c6":"# Auxiliry Function\nThis function is implemented for you and we will use it to plot the condition\nof the k-means algorithm through out it's iterations.\n\n### Just run the following cell no code needed.","08a97739":"# Ex 1\n*You can hand in the assignment in pairs.*\nIn this exercise we will implement the k-means algorithm we learned in class.<br>\nWe are going to preform the k-menas clustering algorithm on the supplied Mall segementation dataset.\n\nDon't forget to run the cells.\n### Just run the following cell no code needed.","d7097cab":"### K-means - with k=2","f205d5bb":"### K-means with k=3"}}