{"cell_type":{"6ff83a98":"code","eb6fc073":"code","979284ce":"code","a81cae65":"code","e30ca21f":"code","fa7ee36b":"code","d0ab5c4a":"code","dae6c0c4":"code","e33561dd":"markdown"},"source":{"6ff83a98":"import sys\nsys.path.append('..\/input\/pycaret\/pyod')\nsys.path.append('..\/input\/pycaret\/pycaret')\nfrom pycaret.regression import *\n\nimport pandas as pd\nimport numpy as np\n\nimport warnings\nwarnings.filterwarnings('ignore')","eb6fc073":"train = pd.read_csv('..\/input\/tabular-playground-series-jan-2022\/train.csv')\ntest = pd.read_csv('..\/input\/tabular-playground-series-jan-2022\/test.csv')","979284ce":"for df in [train, test]:\n    df['date'] = pd.to_datetime(df['date'])\n    df['year'] = df.date.dt.year\n    df['month'] = df.date.dt.month\n    df['week']= df['date'].dt.week\n    df['day'] = df.date.dt.day\n    df['dayofweek'] = df.date.dt.dayofweek\n    df['dayofyear'] = df['date'].dt.dayofyear\n    df.drop(columns=['date'],inplace=True)  \n    \ntrain = pd.get_dummies(train)\ntest = pd.get_dummies(test)\n\ntrain.num_sold = np.log(train.num_sold)","a81cae65":"reg = setup(data = train,\n            target = 'num_sold',\n            train_size = 0.7, \n            normalize = True, \n            normalize_method = 'robust', \n            transform_target = True, \n            data_split_shuffle = True, \n            feature_interaction = True, \n            silent = True, \n            fold = 5, \n            n_jobs = -1) ","e30ca21f":"model = create_model('lr')","fa7ee36b":"pred = predict_model(model, data=test)\npred.head()","d0ab5c4a":"submission = pd.read_csv('..\/input\/tabular-playground-series-jan-2022\/sample_submission.csv')\nsubmission.num_sold = np.exp(pred.Label)\nsubmission.to_csv('submission.csv', index = False)","dae6c0c4":"submission.head()","e33561dd":"# TPS Jan 2022: Simple regression"}}