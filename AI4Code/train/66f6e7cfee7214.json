{"cell_type":{"d2f47a13":"code","9713230f":"code","9cd33227":"code","66720883":"code","2b3461d3":"code","436c534b":"code","f8370e78":"code","200704bf":"code","7115f15d":"code","dd4198aa":"code","bc45a584":"code","d90616e5":"code","b19f0453":"code","0fa95501":"code","4bf44f74":"code","9557fafc":"code","a03704a8":"code","ce3f2e82":"code","2cf98135":"code","4913d89b":"code","99048af9":"code","3b327d1c":"code","07d4face":"code","78a5b3d7":"code","1784856b":"code","83a52fdf":"code","322fa4d5":"code","cdf5406b":"code","8efe2a36":"code","75fb8bea":"code","79fb301a":"code","8181f590":"code","ec5c6553":"code","ab0753ed":"code","03009bd9":"code","01e97868":"code","476de2d6":"code","66eda49f":"code","fd0ffe32":"code","9d6da3eb":"code","dd16bdc9":"code","beec7403":"code","1c507221":"code","9b43b3bd":"code","69f276e2":"code","b0306617":"code","4412e094":"code","2022dfd9":"code","d04c8c9a":"code","4c71e778":"code","e45f3b68":"code","4d6e0e7d":"code","4c88c3e0":"code","e94ca39f":"code","2c5f9590":"code","1b180d9f":"code","dae58627":"code","a7811753":"code","0c3b3b39":"code","71845f92":"code","53e22d7b":"code","d9935e2e":"code","1491534d":"code","1e2631d6":"code","9219c070":"code","ced88d25":"code","6991ea62":"code","8483ded6":"code","b04165b9":"code","ff8459ff":"code","1dc5388c":"code","1c33d8d3":"code","cb128ebe":"code","9076e977":"code","4ef98b35":"code","e68fc50e":"code","966f7ef7":"code","c2c0043c":"code","c7b07061":"code","f3d8175d":"code","3532bf1e":"code","e632cd7a":"code","73d8d4fb":"code","3ad47dd1":"code","61ecf4a1":"code","edfd89a9":"code","db05e574":"code","e9b935e8":"code","a95f2b85":"code","90661df1":"markdown","3db861e7":"markdown","102d1ee3":"markdown","367e81ab":"markdown","1c053f16":"markdown","cba79504":"markdown","6ba6c178":"markdown","c730ce8b":"markdown","13fe52de":"markdown","dee2815d":"markdown","6e3bac49":"markdown","5f2a51e2":"markdown","b24d946d":"markdown","5290d4f9":"markdown","e5dfd8c8":"markdown","ff439263":"markdown","3f2e4418":"markdown","ba95f1e5":"markdown","08285be6":"markdown","69128e42":"markdown","e70bb590":"markdown","621c5a6e":"markdown","72c14742":"markdown","9265221e":"markdown","1c4045f4":"markdown","c6582589":"markdown","e3cb835b":"markdown","564478c3":"markdown","97ff99ce":"markdown","cebc4c25":"markdown","136ed08b":"markdown","e94c257c":"markdown","1bf71b32":"markdown","15920775":"markdown","0ca712ae":"markdown","6ef810ac":"markdown","2df3432b":"markdown","f56887a9":"markdown","5306fe2c":"markdown","0e9d44fb":"markdown","7fb68052":"markdown","389ffdd4":"markdown","281ac4dd":"markdown","64d1df17":"markdown","76613f7c":"markdown"},"source":{"d2f47a13":"import warnings \nwarnings.filterwarnings('ignore')","9713230f":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\n\nimport sklearn\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.cluster import KMeans\nfrom sklearn.metrics import silhouette_score\n\nfrom scipy.cluster.hierarchy import linkage\nfrom scipy.cluster.hierarchy import dendrogram\nfrom scipy.cluster.hierarchy import cut_tree","9cd33227":"cntry_df = pd.read_csv(r'https:\/\/cdn.upgrad.com\/UpGrad\/temp\/2f181ade-814a-430a-b721-769d6a9bf814\/Country-data.csv')\ncntry_df.head()","66720883":"cntry_df.dtypes","2b3461d3":"cntry_df.shape","436c534b":"cntry_df.country.nunique()","f8370e78":"cntry_df.info()","200704bf":"cntry_df.isnull().sum()","7115f15d":"cntry_df.describe()","dd4198aa":"for i in ['imports','exports','health']:\n    cntry_df[i] = (cntry_df[i] * cntry_df['gdpp'])\/100\ncntry_df.head()","bc45a584":"# checking the outliers\n\nplt.figure(figsize = (20,10))\n\nfor i in enumerate(cntry_df.columns[1:]): # first column is 'country'. So, dropped it.\n    plt.subplot(3,3,i[0]+1)\n    sns.boxplot(cntry_df[i[1]])","d90616e5":"num_df = cntry_df[['child_mort', 'exports', 'health', 'imports', 'income', 'inflation','life_expec', 'total_fer', 'gdpp']\n]\npair = sns.PairGrid(num_df)\npair.map_upper(sns.regplot,color ='green', fit_reg = False)\npair.map_lower(sns.regplot, color ='red', fit_reg = False)\npair.map_diag(plt.hist)\nplt.show()","b19f0453":"plt.figure(figsize=(21, 18))\nfeatures = ['child_mort', 'exports', 'health', 'imports', 'income','inflation', 'life_expec', 'total_fer', 'gdpp']\nfor i in enumerate(features):\n    ax = plt.subplot(3, 3, i[0]+1)\n    sns.distplot(num_df[i[1]])\n    plt.xticks(rotation=20)","0fa95501":"new_cntry_df = cntry_df[cntry_df.columns[cntry_df.dtypes != 'object']]\nnew_cntry_df.info()","4bf44f74":"new_cntry_df.describe()","9557fafc":"# instantiate \nscaler = StandardScaler()\n\n# fit_transform\nscaled_data = pd.DataFrame(scaler.fit_transform(new_cntry_df))\n\nscaled_data.columns = cntry_df.columns[cntry_df.dtypes != 'object']\n\nscaled_data.head()","a03704a8":"from sklearn.neighbors import NearestNeighbors\nfrom random import sample\nfrom numpy.random import uniform\nimport numpy as np\nfrom math import isnan\n \ndef hopkins_test(X):\n    d = X.shape[1]\n    n = len(X) # rows\n    m = int(0.1 * n) \n    nbrs = NearestNeighbors(n_neighbors=1).fit(X.values)\n \n    rand_X = sample(range(0, n, 1), m)\n \n    ujd = []\n    wjd = []\n    for j in range(0, m):\n        u_dist, _ = nbrs.kneighbors(uniform(np.amin(X,axis=0),np.amax(X,axis=0),d).reshape(1, -1), 2, return_distance=True)\n        ujd.append(u_dist[0][1])\n        w_dist, _ = nbrs.kneighbors(X.iloc[rand_X[j]].values.reshape(1, -1), 2, return_distance=True)\n        wjd.append(w_dist[0][1])\n \n    H = sum(ujd) \/ (sum(ujd) + sum(wjd))\n    if isnan(H):\n        print(ujd, wjd)\n        H = 0\n \n    return H","ce3f2e82":"#Using the Hopkins Statistic function by passing the above dataframe as a parameter\nhopkins_test(scaled_data)","2cf98135":"plt.figure(figsize=(20, 10))\nplt.title('Hierarchical Clustering Dendrogram (Single)')\nplt.xlabel('index')\nplt.ylabel('distance')\nmerging_s = linkage(scaled_data, method=\"single\", metric='euclidean')\ndendrogram(merging_s)\nplt.show()","4913d89b":"plt.figure(figsize=(18, 8))\nplt.title('Hierarchical Clustering Dendrogram (Complete)')\nplt.xlabel('index')\nplt.ylabel('distance')\nmerging_c = linkage(scaled_data, method=\"complete\", metric='euclidean')\ndendrogram(merging_c)\nplt.show()","99048af9":"cluster_label_3 = cut_tree(merging_c, n_clusters = 3).reshape(-1,)\ncluster_label_3","3b327d1c":"# creating a dataframe with cluster labels on it\n\ncntry_data_h = cntry_df.copy()\ncntry_data_h['cluster_label_3'] = cluster_label_3\ncntry_data_h.head()","07d4face":"# Box plot on various features against the CLUSTER_ID to visualize the spread of the data\n\nplt.figure(figsize=(20, 5))\nplt.subplot(1, 3, 1)\nsns.boxplot(x='cluster_label_3', y='child_mort', data=cntry_data_h, palette=\"bright\")\nplt.subplot(1, 3, 2)\nsns.boxplot(x='cluster_label_3', y='gdpp', data=cntry_data_h, palette=\"bright\")\nplt.subplot(1, 3, 3)\nsns.boxplot(x='cluster_label_3', y='income', data=cntry_data_h, palette=\"bright\")\n\nplt.show()","78a5b3d7":"# plotting scatter plot on various features to visualize the clusters based on them\n\nplt.figure(figsize=(18, 5))\nplt.subplot(1, 3, 1)\nsns.scatterplot(x='gdpp', y='child_mort', hue='cluster_label_3',\n                data=cntry_data_h, legend='full', palette=\"bright\", s=100, c='lightblue', alpha=.4)\nplt.subplot(1, 3, 2)\nsns.scatterplot(x='income', y='child_mort', hue='cluster_label_3',\n                data=cntry_data_h, legend='full', palette=\"bright\", s=100, c='lightblue', alpha=.4)\nplt.subplot(1, 3, 3)\nsns.scatterplot(x='gdpp', y='income', hue='cluster_label_3',\n                data=cntry_data_h, legend='full', palette=\"bright\", s=100, c='lightblue', alpha=.4)\nplt.show()","1784856b":"# checking cluster count\n\ncntry_data_h.cluster_label_3.value_counts()","83a52fdf":"# checking countries in cluster 2 \n\ncntry_data_h[cntry_data_h['cluster_label_3'] == 2]","322fa4d5":"# checking countries in cluster 1\n\ncntry_data_h[cntry_data_h['cluster_label_3'] == 1]","cdf5406b":"# 4 Clusters\ncluster_label_4 = cut_tree(merging_c, n_clusters = 4).reshape(-1,)\ncluster_label_4","8efe2a36":"cntry_data_h['cluster_label_4'] = cluster_label_4\n\ncntry_data_h.head()","75fb8bea":"# Box plot on various variable against the CLUSTER_ID to visualize the spread of the data\n\nplt.figure(figsize=(18, 5))\nplt.subplot(1, 3, 1)\nsns.boxplot(x='cluster_label_4', y='child_mort', data=cntry_data_h, palette=\"bright\")\nplt.subplot(1, 3, 2)\nsns.boxplot(x='cluster_label_4', y='gdpp', data=cntry_data_h, palette=\"bright\")\nplt.subplot(1, 3, 3)\nsns.boxplot(x='cluster_label_4', y='income', data=cntry_data_h, palette=\"bright\")\n\nplt.show()","79fb301a":"# Scatter plot on various variables to visualize the clusters based on them\n\nplt.figure(figsize=(18, 5))\nplt.subplot(1, 3, 1)\nsns.scatterplot(x='gdpp', y='child_mort', hue='cluster_label_4',\n                data=cntry_data_h, legend='full', palette=\"bright\", s=100, c='lightblue', alpha=.4)\nplt.subplot(1, 3, 2)\nsns.scatterplot(x='income', y='child_mort', hue='cluster_label_4',\n                data=cntry_data_h, legend='full', palette=\"bright\", s=100, c='lightblue', alpha=.4)\nplt.subplot(1, 3, 3)\nsns.scatterplot(x='gdpp', y='income', hue='cluster_label_4',\n                data=cntry_data_h, legend='full', palette=\"bright\", s=100, c='lightblue', alpha=.4)\nplt.show()","8181f590":"cntry_data_h.cluster_label_4.value_counts()","ec5c6553":"# Checking the countries in Cluster 2 to see which are the countries in that segment.\n\ncntry_data_h[cntry_data_h['cluster_label_4'] == 2]","ab0753ed":"# Checking the countries in Cluster 3 to see which are the countries in that segment.\n\ncntry_data_h[cntry_data_h['cluster_label_4'] == 3]","03009bd9":"# Checking the countries in Cluster 1 to see which are the countries in that segment.\n\ncntry_data_h[cntry_data_h['cluster_label_4'] == 1]","01e97868":"cntry_data_h_analysis = cntry_data_h.groupby(['cluster_label_3']).mean()\ncntry_data_h_analysis","476de2d6":"# Creating a new field for count of observations in each cluster\ncntry_data_h_analysis['Observations']=cntry_data_h[['cluster_label_3','child_mort']].groupby(['cluster_label_3']).count()\ncntry_data_h_analysis","66eda49f":"# Creating a new field for proportion of observations in each cluster\ncntry_data_h_analysis['Proportion']=round(cntry_data_h_analysis['Observations']\/cntry_data_h_analysis['Observations'].sum(),2)\ncntry_data_h_analysis","fd0ffe32":"plt.figure(figsize=(10, 5))\ncntry_data_h_plot1=cntry_data_h[['cluster_label_3','gdpp','income']].copy()\ncntry_data_h_plot1=cntry_data_h_plot1.groupby('cluster_label_3').mean()\ncntry_data_h_plot1.plot.bar()\n\ncntry_data_h_plot2=cntry_data_h[['cluster_label_3','child_mort']].copy()\ncntry_data_h_plot2=cntry_data_h_plot2.groupby('cluster_label_3').mean()\ncntry_data_h_plot2.plot.bar()\nplt.show()","9d6da3eb":"# elbow-curve\/SSD\nssd = []\nrange_n_clusters = [2, 3, 4, 5, 6, 7, 8]\nfor num_clusters in range_n_clusters:\n    kmeans = KMeans(n_clusters=num_clusters, max_iter=50)\n    kmeans.fit(scaled_data)\n    \n    ssd.append(kmeans.inertia_)\n    \n# plot the SSDs for each n_clusters\n# ssd\nplt.plot(ssd)","dd16bdc9":"# silhouette analysis\nrange_n_clusters = [2, 3, 4, 5, 6, 7, 8]\n\nfor num_clusters in range_n_clusters:\n    \n    # intialise kmeans\n    kmeans = KMeans(n_clusters=num_clusters, max_iter=50)\n    kmeans.fit(scaled_data)\n    \n    cluster_labels = kmeans.labels_\n    \n    # silhouette score\n    silhouette_avg = silhouette_score(scaled_data, cluster_labels)\n    print(\"For n_clusters={0}, the silhouette score is {1}\".format(num_clusters, silhouette_avg))","beec7403":"# K Means with with k=3\nkmeans_3 = KMeans(n_clusters=3, max_iter=500, init='k-means++', n_init=10, random_state= 335)\nkmeans_3.fit(scaled_data)\nkmeans_3.labels_","1c507221":"# Create a new datafame with scaled data and adding country name to it.\ncntry_data_k = cntry_data_h.copy()\ncntry_data_k.head()","9b43b3bd":"# assigning the label\ncntry_data_k['cluster_id_3'] = kmeans_3.labels_\ncntry_data_k.head()","69f276e2":"# Checking the number of countries in each cluster\ncntry_data_k.cluster_id_3.value_counts()","b0306617":"# Box plot on various variable against the CLUSTER_ID to visualize the spread of the data\n\nplt.figure(figsize=(20, 5))\nplt.subplot(1, 3, 1)\nsns.boxplot(x='cluster_id_3', y='child_mort',\n            data=cntry_data_k, palette=\"bright\")\nplt.subplot(1, 3, 2)\nsns.boxplot(x='cluster_id_3', y='gdpp',\n            data=cntry_data_k, palette=\"bright\")\nplt.subplot(1, 3, 3)\nsns.boxplot(x='cluster_id_3', y='income',\n            data=cntry_data_k, palette=\"bright\")\n\nplt.show()","4412e094":"# Scatter plot on various variables to visualize the clusters based on them\n\nplt.figure(figsize=(20, 5))\nplt.subplot(1, 3, 1)\nsns.scatterplot(x='gdpp', y='child_mort', hue='cluster_id_3',\n                data=cntry_data_k, legend='full', palette=\"bright\", s=100, c='lightblue', alpha=.4)\nplt.subplot(1, 3, 2)\nsns.scatterplot(x='income', y='child_mort', hue='cluster_id_3',\n                data=cntry_data_k, legend='full', palette=\"bright\", s=100, c='lightblue', alpha=.4)\nplt.subplot(1, 3, 3)\nsns.scatterplot(x='gdpp', y='income', hue='cluster_id_3',\n                data=cntry_data_k, legend='full', palette=\"bright\", s=100, c='lightblue', alpha=.4)\nplt.show()","2022dfd9":"# Checking the CLuster means:\ncntry_data_k.groupby(['cluster_id_3']).mean().sort_values(['child_mort','income','gdpp'],ascending = [False,True,True])","d04c8c9a":"# Checking the countries in Cluster 2 to see which are the countries in that segment.\n\ncntry_data_k[['country','child_mort','income','gdpp']][cntry_data_k['cluster_id_3'] == 2].sort_values(['child_mort','income','gdpp'],ascending = [False,True,True])","4c71e778":"# Checking the countries in Cluster 0 to see which are the countries in that segment.\n\ncntry_data_k[['country','child_mort','income','gdpp']][cntry_data_k['cluster_id_3'] == 0].sort_values(['child_mort','income','gdpp'],ascending = [False,True,True])","e45f3b68":"# K Means with with k=4\nkmeans_4 = KMeans(n_clusters=4, max_iter=500, init='k-means++', n_init=10, random_state= 335)\nkmeans_4.fit(scaled_data)\nkmeans_4.labels_","4d6e0e7d":"# assigning the label\ncntry_data_k['cluster_id_4'] = kmeans_4.labels_\ncntry_data_k.head()","4c88c3e0":"# Checking the number of countries in each cluster\n\ncntry_data_k.cluster_id_4.value_counts()","e94ca39f":"# Box plot on various variable against the CLUSTER_ID to visualize the spread of the data\n\nplt.figure(figsize=(18, 5))\nplt.subplot(1, 3, 1)\nsns.boxplot(x='cluster_id_4', y='child_mort',\n            data=cntry_data_k, palette=\"bright\")\nplt.subplot(1, 3, 2)\nsns.boxplot(x='cluster_id_4', y='gdpp',\n            data=cntry_data_k, palette=\"bright\")\nplt.subplot(1, 3, 3)\nsns.boxplot(x='cluster_id_4', y='income',\n            data=cntry_data_k, palette=\"bright\")\n\nplt.show()","2c5f9590":"# Scatter plot on various variables to visualize the clusters based on them\n\nplt.figure(figsize=(18, 5))\nplt.subplot(1, 3, 1)\nsns.scatterplot(x='gdpp', y='child_mort', hue='cluster_id_4',\n                data=cntry_data_k, legend='full', palette=\"bright\", s=100, c='lightblue', alpha=.4)\nplt.subplot(1, 3, 2)\nsns.scatterplot(x='income', y='child_mort', hue='cluster_id_4',\n                data=cntry_data_k, legend='full', palette=\"bright\", s=100, c='lightblue', alpha=.4)\nplt.subplot(1, 3, 3)\nsns.scatterplot(x='gdpp', y='income', hue='cluster_id_4',\n                data=cntry_data_k, legend='full', palette=\"bright\", s=100, c='lightblue', alpha=.4)\nplt.show()","1b180d9f":"# Checking the CLuster means:\ncntry_data_k.groupby(['cluster_id_4']).mean().sort_values(['child_mort','income','gdpp'],ascending = [False,True,True])","dae58627":"# Checking the countries in Cluster 3 to see which are the countries in that segment.\n\ncntry_data_k[['country','child_mort','income','gdpp']][cntry_data_k['cluster_id_4'] == 3].sort_values(['child_mort','income','gdpp'],ascending = [False,True,True])","a7811753":"# Checking the countries in Cluster 1 to see which are the countries in that segment.\n\ncntry_data_k[['country','child_mort','income','gdpp']][cntry_data_k['cluster_id_4'] == 1].sort_values(['child_mort','income','gdpp'],ascending = [False,True,True])","0c3b3b39":"# K Means with with k=5\nkmeans_5 = KMeans(n_clusters=5, max_iter=500, init='k-means++', n_init=10, random_state= 335)\nkmeans_5.fit(scaled_data)\nkmeans_5.labels_","71845f92":"# assigning the label\ncntry_data_k['cluster_id_5'] = kmeans_5.labels_\ncntry_data_k.head()","53e22d7b":"# Checking the number of countries in each cluster\n\ncntry_data_k.cluster_id_5.value_counts()","d9935e2e":"## Visualizing the Clustered Data","1491534d":"# Box plot on various variable against the CLUSTER_ID to visualize the spread of the data\n\nplt.figure(figsize=(18, 5))\nplt.subplot(1, 3, 1)\nsns.boxplot(x='cluster_id_5', y='child_mort',\n            data=cntry_data_k, palette=\"bright\")\nplt.subplot(1, 3, 2)\nsns.boxplot(x='cluster_id_5', y='gdpp',\n            data=cntry_data_k, palette=\"bright\")\nplt.subplot(1, 3, 3)\nsns.boxplot(x='cluster_id_5', y='income',\n            data=cntry_data_k, palette=\"bright\")\n\nplt.show()","1e2631d6":"# Scatter plot on various variables to visualize the clusters based on them\n\nplt.figure(figsize=(18, 5))\nplt.subplot(1, 3, 1)\nsns.scatterplot(x='gdpp', y='child_mort', hue='cluster_id_5',\n                data=cntry_data_k, legend='full', palette=\"bright\", s=100, c='lightblue', alpha=.4)\nplt.subplot(1, 3, 2)\nsns.scatterplot(x='income', y='child_mort', hue='cluster_id_5',\n                data=cntry_data_k, legend='full', palette=\"bright\", s=100, c='lightblue', alpha=.4)\nplt.subplot(1, 3, 3)\nsns.scatterplot(x='gdpp', y='income', hue='cluster_id_5',\n                data=cntry_data_k, legend='full', palette=\"bright\", s=100, c='lightblue', alpha=.4)\nplt.show()","9219c070":"# Checking the CLuster means:\ncntry_data_k.groupby(['cluster_id_5']).mean().sort_values(['child_mort','income','gdpp'],ascending = [False,True,True])","ced88d25":"# Checking the countries in Cluster 3 to see which are the countries in that segment.\n\ncntry_data_k[['country','child_mort','income','gdpp']][cntry_data_k['cluster_id_5'] == 4].sort_values(['child_mort','income','gdpp'],ascending = [False,True,True])","6991ea62":"# Checking the countries in Cluster 1 to see which are the countries in that segment.\n\ncntry_data_k[['country','child_mort','income','gdpp']][cntry_data_k['cluster_id_5'] == 0].sort_values(['child_mort','income','gdpp'],ascending = [False,True,True])","8483ded6":"#New dataframe for group by & analysis\n\ncntry_data_k_analysis =  cntry_data_k.groupby(['cluster_id_3']).mean().sort_values(['child_mort','income','gdpp'],ascending = [False,True,True])\ncntry_data_k_analysis","b04165b9":"# Creating a new field for count of observations in each cluster\n\ncntry_data_k_analysis['Observations']=cntry_data_k[['cluster_id_3','child_mort']].groupby(['cluster_id_3']).count()\ncntry_data_k_analysis","ff8459ff":"# Creating a new field for proportion of observations in each cluster\n\ncntry_data_k_analysis['Proportion']=round(cntry_data_k_analysis['Observations']\/cntry_data_k_analysis['Observations'].sum(),2)\n\n\n#Summary View\ncntry_data_k_analysis[['child_mort','income','gdpp','Observations','Proportion']]","1dc5388c":"plt.figure(figsize=(8, 5))\ncntry_data_k_plot1=cntry_data_k[['cluster_id_3','gdpp','income']].copy()\ncntry_data_k_plot1=cntry_data_k_plot1.groupby('cluster_id_3').mean()\ncntry_data_k_plot1.plot.bar()\n\ncntry_data_k_plot2=cntry_data_k[['cluster_id_3','child_mort']].copy()\ncntry_data_k_plot2=cntry_data_k_plot2.groupby('cluster_id_3').mean()\ncntry_data_k_plot2.plot.bar()","1c33d8d3":"cntry_data_k_analysis = cntry_data_k_analysis.rename({\n    2: 'Under_Developed Countries',\n    1: 'Developed Countries',\n    0: 'Developing Countries'}).reset_index()","cb128ebe":"cntry_data_k_analysis[['cluster_id_3','child_mort','income','gdpp','Observations','Proportion']]","9076e977":"cntry_data_k_analysis[['cluster_id_4','child_mort','income','gdpp','Observations','Proportion']]","4ef98b35":"# Countries in Cluster_id = 0, save to a new dataframe, this will form our final cluster data\n\nfinal_cluster = cntry_data_k[cntry_data_k['cluster_id_3'] == 2].copy()\nfinal_cluster = final_cluster[['country', 'child_mort', 'income', 'gdpp']]\n","e68fc50e":"final_cluster.sort_values([ 'gdpp', 'income','child_mort'], ascending=[True, True, False])","966f7ef7":"final_cluster.describe()","c2c0043c":"Under_Developed_Countries = cntry_df[cntry_df['gdpp'] <= 932].copy()\n# Under_Developed_Countries = Under_Developed_Countries[Under_Developed_Countries['gdpp'] <= 932]\nUnder_Developed_Countries=Under_Developed_Countries.sort_values([ 'gdpp', 'income','child_mort'], ascending=[True, True, False])","c7b07061":"Under_Developed_Countries[['country', 'child_mort', 'gdpp', 'income']]","f3d8175d":"Under_Developed_Countries = Under_Developed_Countries[Under_Developed_Countries['income'] <= 1860]\nUnder_Developed_Countries=Under_Developed_Countries.sort_values([ 'gdpp', 'income','child_mort'], ascending=[True, True, False])","3532bf1e":"Under_Developed_Countries[['country', 'child_mort', 'gdpp', 'income']]","e632cd7a":"# We create a new dataframe to store the countries satisfying the cluster median from original dataframe\n\nUnder_Developed_Countries = Under_Developed_Countries[Under_Developed_Countries['child_mort'] >= 90]\nUnder_Developed_Countries=Under_Developed_Countries.sort_values([ 'gdpp', 'income','child_mort'], ascending=[True, True, False])","73d8d4fb":"Under_Developed_Countries[['country', 'child_mort', 'gdpp', 'income']]","3ad47dd1":"# top 10 underdeveloped countries list to a new df\n\nUDC_top_10=Under_Developed_Countries[['country', 'gdpp', 'income', 'child_mort']].head(10).copy()","61ecf4a1":"#Final countries list\n\nUDC_top_10","edfd89a9":"UDC_top_10.describe()","db05e574":"plt.figure(figsize=(21, 18))\nfeatures = ['gdpp','income','child_mort']\nfor i in enumerate(features):\n    ax = plt.subplot(3, 3, i[0]+1)\n    sns.distplot(UDC_top_10[i[1]])\n    plt.xticks(rotation=20)","e9b935e8":"# Scatter plot on various variables to visualize the clusters based on them\n\nplt.figure(figsize=(18, 10))\nplt.subplot(1, 3, 1)\nsns.scatterplot(x='gdpp', y='child_mort', hue='country',\n                data=UDC_top_10, legend='full', palette=\"bright\", s=300, c='lightblue')\nplt.subplot(1, 3, 2)\nsns.scatterplot(x='gdpp', y='income', hue='country',\n                data=UDC_top_10, legend='full', palette=\"bright\", s=300, c='lightblue')\nplt.subplot(1, 3, 3)\nsns.scatterplot(x='income', y='child_mort', hue='country',\n                data=UDC_top_10, legend='full', palette=\"bright\", s=300, c='lightblue')\nplt.show()","a95f2b85":"#TOP 10 COUNTRIES recommended for Financial Aid\n\nUDC_top_10","90661df1":"### INSIGHT: \n- `cluster 2` and `cluster 0` seems to have highest child mortality rate and lowest income and lowest GDPP. Checking the countries in both clusters.","3db861e7":"# 4. Model building\n## 4.1 Hierarchial Clustering","102d1ee3":"### Visualizing the clustered data","367e81ab":"### INSIGHT\n- In the dataframe(cntry_df) provided, `imports`,`exports` and `health` features have the percentage of money spent or gained from these sectors from the total gdpp which is not clear. So, to avoid this, values in `imports`, `exports` and `health` are converted to absolute values","1c053f16":"# 1. Importing the dataset and data inspection","cba79504":"# Importing modules","6ba6c178":"### SCALING THE DATA (STANDARDIZATION) \n    - We will use standardization method for scaling the data.","c730ce8b":"### Interpretation of Clusters: \n   - `Cluster 0` has the highest average child mortality rate of ~42 when compared to other 2 clusters and `lowest gdpp` and `lowest income` of ~7551 & 12641 respectively.\n   - All the above reasons make the `cluster 0` ideal for the requirement. We can also observe that cluster 0 comprises of ~89% of overall countries and has ~148 countries out of 167 total countries. This is a problem.\n   - Clustering model is not giving us a good result because ~89% of data is under one cluster and increasing the number of clusters doesn't solve this problem. We will check K-Means clustering.","13fe52de":"### INSIGHT:\n   - Majority of the data points are `not normally distributed`. \n   - Variance is not uniform and range is not same for all features.\n   - We need to standardize data to overcome all this. Since we need to calculate the Euclidean distance between the data points for clustering, it is important to ensure that the values with high range do not outweigh the values with smaller range. Thus, scaling down all the attributes to a uniform scale is important.","dee2815d":"- No of unique entries in country column and number of rows in dataframe are equal. Which means that there are no multiple entries","6e3bac49":"## 3. Exploratory Data Analysis\n- `Visualizing Distribution`\n\nPlotting a pairplot","5f2a51e2":"## Finding the Optimal Number of Clusters\n### SSD (Elbow curve)","b24d946d":"#### Second iteration - Using 4 clusters","5290d4f9":"### complete linkage :\n- Here, the distance between 2 clusters is defined as the maximum distance between any 2 points in the clusters.\n","e5dfd8c8":"#### Third Iteration - 5 clusters","ff439263":"### Single linkage\n   - Here, the distance between 2 clusters is defined as the shortest distance between points in the two clusters.","3f2e4418":"#### INSIGHT\n   - From the 2 iterations above, we can conclude that `3 clusters` is ideal for number of clusters.\n   - This is because for `4 clusters`, `nigeria` was added as a separate cluster. Since Nigeria could be a backward country which may need the aid in terms of it's child mortality rate. \n   - So, the ideal number of clusters is `3 clusters`. We will further validate this.","ba95f1e5":"### INSIGHT\n   - Dataframe describes various socio-economic factors of 167 different countries.\n   - Dataframe has no multiple entries and no null values\n   - All features except 'country' are numerical as expected. So, no need of any type casting\n   - Descriptive statistics indicates that there is some variability in the data and requires scaling while model building.","08285be6":"## 2. Data Transformation","69128e42":"#### INSIGHT:\n   - `Cluster 3` & `Cluster 1` seems to have highest child mortality rate and lowest income and lowest gdpp. Checking the countries in these clusters","e70bb590":"### Interpreting Clusters from the Hierarchial Clustering model","621c5a6e":"####  `NOTE`\n- From the above two dendrograms, it is clear that `Complete Linkage` has a batter cluster formation.\n- So, we will use `Complete linkage` output for further analysis. We will build two iterations of clustering\n    - one with 3 clusters and another one with 4 clusters (based on the output from Complete Linkage Dendrogram) and analyze the output\n    ","72c14742":"### Descriptive Statistics of Cluster 'Under_Developed_Countries'","9265221e":"### Silhouette Analysis\n`                                   silhouette score = p\u2212q\/max(p,q)`\n \n- p  is the mean distance to the points in the nearest cluster that the data point is not a part of\n- q  is the mean intra-cluster distance to all the points in its own cluster.\n- The value of the silhouette score range lies between -1 to 1.\n- A score closer to 1 indicates that the data point is very similar to other data points in the cluster,\n- A score closer to -1 indicates that the data point is not similar to the data points in its cluster.","1c4045f4":"- We use Hierarchial clusterign approach to identify appropriate cluster size with a good split in data\n    - Max Intra-cluster distance and Min Inter-cluster distance","c6582589":"- Clusters 1 and 2 are developed and developing countries. So, our segmentation is good in terms of all our under developed countries are segmented under cluster 0. We will further tune this cluster","e3cb835b":"#### Second Iteration - 4 clusters","564478c3":"### Analysing the 'Under Developed Countries' Cluster","97ff99ce":"`OBSERVATIONS:`\n   - There are outliers in all features. \n   - We cannot cap the outliers in all features because is leads to deletion of some countries which are actually in dire need of aidand should be in prime focus.\n   - So, I've decided to go with the model which suites the Business Problem better. That is, not to treat the Outlier, and check the model with different K values to see which one gives a better business outcome.","cebc4c25":"### INSIGHT\n   - If the value is between {0.01, ...,0.3}, the data is regularly spaced (normally distributed).\n   - If the value is around 0.5, it is random.\n   - If the value is between {0.7, ..., 0.99}, it has a high tendency to cluster. ","136ed08b":"## Conclusion & Recommendation\n- We performed CLUSTERING on the socio-economic data provided for various countries to identify countries most eligible for Financial Aid from the NGO. \n- Based on Clustering Analysis, below are the top 10 countries under our 'Under Developed Countries' cluster which are in dire need of the Financial Aid. This output is purely based on the dataset provided and various analytical methodologies performed.","e94c257c":"### Decision Making on the final approach","1bf71b32":"### 4.2 K-MEANS CLUSTERING \n\n#### First iteration - 3 Clusters","15920775":"- All features except country are numerical as expected","0ca712ae":"#### INSIGHT:\n   - From the above validations (Elbow curve and Silhouette analysis), we can notice that 3,4 & 5 are the optimal number of clusters. We will do 3 iterations for 3,4 & 5 clusters.","6ef810ac":"- No null values in the dataframe","2df3432b":"### Choosing the model\n\nFrom the above 3 Iterations of K-Means, we could see that using 3 Clusters provided a better output in terms of a balanced cluster size. So we will consider the 'K-Means with 3 Clusters' as our FINAL MODEL\n\n### Interpreting the Clusters from K-Means model","f56887a9":"### Bivariate Analysis of Cluster 'Under_Developed_Countries' (Top 10)","5306fe2c":"## Univariate Analysis of Cluster 'Under_Developed_Countries' (Top 10)","0e9d44fb":"## 2.1 Outlier Treatment","7fb68052":"`Rescaling the data`","389ffdd4":"#### First iteration - Using 3 clusters","281ac4dd":"#### INSIGHT: \n- Cluster 3 & Cluster 1 seems to have highest Child Mortality and lowest Income & GDPP. Lets check the countries in these clusters to see there outcome.","64d1df17":"### Renaming the Clusters","76613f7c":"### HOPKINS STATISTICS\n   - Before applying clustering on a dataframe, first we need to check whether has some meaningful(not occuring at random) clusters.\n   - The process of evaluating data whether clustering can be applied or not is called `Clustering Tendency`.\n   - For `clustering tendency`, we use `Hopkins Test` which examines whether the data points differ significantly from uniformly distributed data in the multidimensional space."}}