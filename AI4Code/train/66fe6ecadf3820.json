{"cell_type":{"6b9d7bd5":"code","c21fcdb1":"code","50728f91":"code","6487f682":"code","a61913fe":"code","9f0d78b5":"code","7aba872d":"code","14e48671":"code","46833162":"code","af60224b":"code","a89403ae":"code","f35c6828":"code","4e7656da":"code","6d2c25fd":"code","b7ad53dd":"code","29e84d10":"code","46acf634":"code","154798dd":"code","a5648838":"code","b7374b59":"code","d4d0da10":"code","167da968":"code","ff129670":"code","8a250f9f":"code","04fe8bef":"code","485a1a96":"code","ebb32d69":"code","b2a771f2":"code","8894dc52":"markdown","d86b9b14":"markdown","4bbd1258":"markdown","0eeffc1a":"markdown","1ea0c03b":"markdown","113d3a2f":"markdown","810cd543":"markdown","ef94f438":"markdown","dc148036":"markdown","7dc7c352":"markdown","fd9d5ad1":"markdown"},"source":{"6b9d7bd5":"from sklearn.datasets import make_moons","c21fcdb1":"import pandas as pd","50728f91":"from sklearn.model_selection import train_test_split","6487f682":"from sklearn.model_selection  import GridSearchCV\nfrom sklearn.tree import DecisionTreeClassifier","a61913fe":"X,y=make_moons(n_samples=10000,noise=0.4,random_state=42)","9f0d78b5":"X","7aba872d":"x=pd.DataFrame(X)","14e48671":"x","46833162":"X.shape","af60224b":"y.shape","a89403ae":"X_train, X_test, y_train, y_test=train_test_split(X,y,test_size=0.2,random_state=42)","f35c6828":"X_test.shape","4e7656da":"params = {'max_leaf_nodes': list(range(2, 100)), 'min_samples_split': [2, 3, 4]}\ngrid_search_cv=GridSearchCV(DecisionTreeClassifier(random_state=42),params,verbose=1,cv=3)","6d2c25fd":"grid_search_cv.fit(X_train,y_train)","b7ad53dd":"dir(grid_search_cv)","29e84d10":"grid_search_cv.cv_results_","46acf634":"results_df=pd.DataFrame(grid_search_cv.cv_results_)","154798dd":"results_df","a5648838":"grid_search_cv.best_estimator_","b7374b59":"grid_search_cv.best_params_","d4d0da10":"grid_search_cv.best_score_","167da968":"results_df[results_df[\"param_max_leaf_nodes\"]==17]","ff129670":"from sklearn.metrics import accuracy_score\ny_pred=grid_search_cv.predict(X_train)\naccuracy_score(y_pred,y_train)","8a250f9f":"best_model=DecisionTreeClassifier(max_leaf_nodes=17,min_samples_split=2, random_state=42)","04fe8bef":"from sklearn.model_selection import cross_val_score,cross_val_predict","485a1a96":"cross_val_score(best_model,X_train,y_train,cv=3)","ebb32d69":"cross_val_predict(best_model,X_test,y_test,cv=3)","b2a771f2":"cross_val_score(best_model,X_test,y_test,cv=3)","8894dc52":" # some callable functions of gridsearchcv object","d86b9b14":"# Loading dataset","4bbd1258":"# watching out for all the results","0eeffc1a":"# We can also use 'best_model = grid_search_cv.best_estimator_'","1ea0c03b":"# making dictionary of hyperparameters and doing hyperparameter tuning\n","113d3a2f":"# Importing libraries","810cd543":"# Splitting data into training and testing datasets","ef94f438":"# best estimator coressponding to best score","dc148036":"# making a different model using details we got from best estimator (cell [18])","7dc7c352":"# HOLA! we got 85.5% accuracy with best estimator ","fd9d5ad1":"# fitting data into model"}}