{"cell_type":{"5d1d1bab":"code","945abfa7":"code","4050e3bc":"code","718ba6ae":"code","5f9220ac":"code","7f555323":"code","4c81be34":"code","0afbca8e":"code","7a924c85":"code","042f749a":"code","59799257":"code","55a699d1":"code","6bb5ca15":"code","442187ab":"markdown","f109a27e":"markdown","8331b880":"markdown","6e70c6e7":"markdown","beef1f9e":"markdown","cc1ea4d3":"markdown","7cb9dd61":"markdown"},"source":{"5d1d1bab":"import os\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport zipfile\nfrom tensorflow import keras\nfrom tensorflow.keras.preprocessing.image import ImageDataGenerator","945abfa7":"test = pd.read_csv('..\/input\/histopathologic-cancer-detection\/sample_submission.csv')\n\nprint('Test Set Size:', test.shape)","4050e3bc":"test.head()","718ba6ae":"test_path = \"..\/input\/histopathologic-cancer-detection\/test\/\"\nprint('Test Images:', len(os.listdir(test_path)))","5f9220ac":"def append_ext(fn):\n    return fn+\".tif\"","7f555323":"test['id'] = test['id'].apply(append_ext)\ntest.head()","4c81be34":"BATCH_SIZE = 64\n\ntest_datagen = ImageDataGenerator(rescale=1\/255)\n\ntest_loader = test_datagen.flow_from_dataframe(\n    dataframe = test,\n    directory = test_path,\n    x_col = 'id',\n    batch_size = BATCH_SIZE,\n    shuffle = False,\n    class_mode = None,\n    target_size = (64,64)\n)","0afbca8e":"cnn = keras.models.load_model('..\/input\/cancer-detection-models\/cancer_detection_model_v10.h5')\ncnn.summary()","7a924c85":"test_probs = cnn.predict(test_loader)\nprint(test_probs.shape)","042f749a":"print(test_probs[:10,].round(2))","59799257":"submission = pd.read_csv('..\/input\/histopathologic-cancer-detection\/sample_submission.csv')\nsubmission.head()","55a699d1":"submission.label = test_probs[:,1]\nsubmission.head()","6bb5ca15":"submission.to_csv('submission.csv', header=True, index=False)","442187ab":"## Test Predictions","f109a27e":"## Load DataFrame\n","8331b880":"## Extract Test Images","6e70c6e7":"## Import Statements","beef1f9e":"## Load Model","cc1ea4d3":"## Prepare Submission","7cb9dd61":"## Data Generator"}}