{"cell_type":{"d11a5548":"code","65d7091b":"code","577d2ba4":"code","10f293dd":"code","8b12291e":"code","ab686210":"code","c5008f9e":"markdown"},"source":{"d11a5548":"import numpy as np \nimport pandas as pd\n\n\nimport matplotlib.pyplot as plt\nfrom catboost import CatBoostClassifier\nfrom sklearn.model_selection import KFold\nfrom sklearn.metrics import accuracy_score, roc_auc_score, roc_curve","65d7091b":"df = pd.read_csv('\/kaggle\/input\/hotel-booking-demand\/hotel_bookings.csv')","577d2ba4":"# Check na values \nna_cols = df.columns[df.isna().sum() > 0]\nprint(na_cols)","10f293dd":"# Convert columns with na values to object type and fill na with mode \nfor col in na_cols:\n    df[col] = df[col].astype('object')\n    df[col].fillna(df[col].mode()[0], inplace=True)","8b12291e":"# Split into features and target\nX, y = df.drop('is_canceled', axis=1), df['is_canceled']\n\n# Keep column names for catboost cat_features\nX_cols = df.drop('is_canceled', axis=1).columns","ab686210":"%%time\nkf = KFold(n_splits=5)\nfor train_index, valid_index in kf.split(X, y):\n    X_train, X_valid = X.values[train_index], X.values[valid_index]\n    y_train, y_valid = y.values[train_index], y.values[valid_index]\n    \n    X_train, X_valid = pd.DataFrame(X_train, columns=X_cols), pd.DataFrame(X_valid, columns=X_cols)\n    \n    cbc = CatBoostClassifier(cat_features=df.select_dtypes(include='object'), silent=True)\n    cbc.fit(X_train, y_train)\n    fpr, tpr, thr = roc_curve(y_valid, cbc.predict_proba(X_valid)[:, 1])\n    print(f'accuracy: {accuracy_score(y_valid, cbc.predict(X_valid))}')\n    plt.plot(fpr, tpr)\n#     plt.show()\nplt.xlabel('FPR')\nplt.ylabel('TPR')\n    ","c5008f9e":"Are there any mistakes? "}}