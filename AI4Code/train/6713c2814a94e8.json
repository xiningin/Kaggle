{"cell_type":{"bee52bc2":"code","cc051eba":"code","c4cbdb95":"code","d09ca3d0":"code","9cd9e7a3":"code","2e618047":"code","f4e6b7d0":"code","0f29c4cc":"code","60a67ca9":"code","030e2712":"code","b0f4dc4b":"code","385e7907":"code","d9efce70":"code","3fbc5478":"code","b3309dac":"code","c588e0a7":"code","b81e9043":"code","5e980047":"code","76bae946":"markdown","b59271c8":"markdown"},"source":{"bee52bc2":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\n# source https:\/\/colab.research.google.com\/github\/tensorflow\/io\/blob\/master\/docs\/tutorials\/dicom.ipynb#scrollTo=WodUv8O1VKmr","cc051eba":"list(os.listdir(\"..\/input\/rsna-str-pulmonary-embolism-detection\"))","c4cbdb95":"%%time\nDATA_PATH = \"..\/input\/rsna-str-pulmonary-embolism-detection\"\n\ntrain = pd.read_csv(f\"{DATA_PATH}\/train.csv\")\ntest = pd.read_csv(f\"{DATA_PATH}\/test.csv\")\nsample_submission = pd.read_csv(f\"{DATA_PATH}\/sample_submission.csv\")","d09ca3d0":"train.head(10)","9cd9e7a3":"!ls \/kaggle\/input\/rsna-str-pulmonary-embolism-detection\/train\/6897fa9de148\/2bfbb7fd2e8b","2e618047":"train.info()","f4e6b7d0":"# %%time\n# files = folders = 0\n\n# for _, dirnames, filenames in os.walk(f\"{DATA_PATH}\/train\"):\n#     files += len(filenames)\n#     folders += len(dirnames)\n# print(\"Total number of folders in train:{} and files in it:{}\".format(folders,files))","0f29c4cc":"# len(train.StudyInstanceUID.unique()),len(train.SeriesInstanceUID.unique()),len(train.SOPInstanceUID.unique())\n# (7279, 7279, 1790594)","60a67ca9":"!pip install tensorflow-io","030e2712":"import tensorflow as tf\nimport tensorflow_io as tfio\nfrom pathlib import Path\nimport matplotlib.pyplot as plt","b0f4dc4b":"DATA_PATH = Path(DATA_PATH)","385e7907":"image_bytes = tf.io.read_file('\/kaggle\/input\/rsna-str-pulmonary-embolism-detection\/train\/6897fa9de148\/2bfbb7fd2e8b\/031618cba689.dcm')","d9efce70":"image       = tfio.image.decode_dicom_image(image_bytes, dtype=tf.uint16)\nskipped     = tfio.image.decode_dicom_image(image_bytes, on_error='skip', dtype=tf.uint8)\nlossy_image = tfio.image.decode_dicom_image(image_bytes, scale='auto', on_error='lossy', dtype=tf.uint8)","3fbc5478":"type(skipped), type(skipped.numpy()), skipped.numpy() ","b3309dac":"image.numpy().shape, lossy_image.numpy().shape","c588e0a7":"fig, axes = plt.subplots(1,3, figsize=(10,10))\n\naxes[0].imshow(np.squeeze(image.numpy()), cmap='gray')\naxes[0].set_title('image')\naxes[1].imshow(np.squeeze(lossy_image.numpy()), cmap='gray')\naxes[1].set_title('lossy image');\naxes[2].imshow(np.squeeze(lossy_image.numpy() - image.numpy()), cmap='gray')\naxes[2].set_title('diff b\/w images');","b81e9043":"fig, axes = plt.subplots(3,1, figsize=(20,20))\n\naxes[0].imshow(np.squeeze(image.numpy()), cmap='gray')\naxes[0].set_title('image')\naxes[1].imshow(np.squeeze(lossy_image.numpy()), cmap='gray')\naxes[1].set_title('lossy image');","5e980047":"np.sum(image.numpy() - lossy_image.numpy())","76bae946":"## if you found this beneficial please consider upvoting","b59271c8":"Total number of folders in train:14558 and files in it:1790594  \nCPU times: user 4.38 s, sys: 10.7 s, total: 15.1 s  \nWall time: 3min 37s  "}}