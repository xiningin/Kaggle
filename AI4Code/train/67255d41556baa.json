{"cell_type":{"fde7d81f":"code","167adbf6":"code","c4a0920c":"code","3bb313db":"code","6159e012":"code","bdfd010f":"code","bb44e969":"code","4cc6f590":"code","0602546e":"code","2a345d91":"code","78d3ff70":"code","41de4bab":"code","a0bb302a":"code","aa2de6fd":"code","bf8c7b8f":"code","af538c66":"code","28fcea0d":"code","a13b5627":"code","7bcff9b6":"code","7fc7dc47":"code","827cab4c":"code","fba1e4a3":"code","18286997":"code","76ec84e9":"code","80cd6073":"code","5e6016a4":"code","9966dec1":"code","2c8b711c":"code","ea7a82b4":"code","8af489a2":"code","29dc7cd0":"code","b3f8d8d2":"markdown","7d90b84d":"markdown","845ae708":"markdown"},"source":{"fde7d81f":"import matplotlib.pyplot as plt\nimport seaborn as sns\nfrom scipy.stats import norm\nfrom sklearn.preprocessing import StandardScaler\nfrom scipy import stats\nimport warnings\nwarnings.filterwarnings('ignore')","167adbf6":"import numpy as np\nimport pandas as pd","c4a0920c":"train=pd.read_csv('..\/input\/titanic\/train.csv')\ntest=pd.read_csv('..\/input\/titanic\/test.csv')\ntrain.head()","3bb313db":"train['Embarked']=train['Embarked'].fillna('S')","6159e012":"train['middle']=train['Name'].map(lambda x:x.split(',')[1].split('.')[0].strip())\ntrain['middle'].value_counts()","bdfd010f":"test['middle']=test['Name'].map(lambda x:x.split(',')[1].split('.')[0].strip())\ntest['middle'].value_counts()","bb44e969":"for i in range(len(train)):\n        \n    if pd.isnull(train['Age'][i]):\n        name=train['middle'][i]\n        if name=='Mr':\n            train['Age'][i]=33\n        elif name=='Mrs':\n            train['Age'][i]=36\n        elif name=='Miss':\n            train['Age'][i]=22\n        elif name=='Master':\n            train['Age'][i]=5\n        else:\n            train['Age'][i]=30\n\ntrain['Age'].isnull().sum()","4cc6f590":"for i in range(len(test)):\n    if pd.isnull(test['Age'][i]):\n        name=test['middle'][i]\n        if name=='Mr':\n            test['Age'][i]=33\n        elif name=='Mrs':\n            test['Age'][i]=36\n        elif name=='Miss':\n            test['Age'][i]=22\n        elif name=='Master':\n            test['Age'][i]=5\n        else:\n            test['Age'][i]=30\n\ntest['Age'].isnull().sum()","0602546e":"all_set=pd.concat(objs=[train,test],axis=0).reset_index(drop=True)","2a345d91":"train.info()","78d3ff70":"test.info()","41de4bab":"all_set.info()","a0bb302a":"all_set['Cabin'].head(10)","aa2de6fd":"train['Cabin']=pd.DataFrame([i[0] if not pd.isnull(i) else 'N'] for i in all_set['Cabin'])\ntrain['Cabin'].head()","bf8c7b8f":"test['Cabin']=pd.DataFrame([i[0] if not pd.isnull(i) else 'N'] for i in all_set['Cabin'])\ntest['Cabin'].head()","af538c66":"sns.countplot(train['Cabin'],data=all_set);","28fcea0d":"sns.countplot(x='Cabin',hue='Survived',data=train);","a13b5627":"all_set['Ticket'].head()","7bcff9b6":"Ticket=[]\n\nfor i in train.Ticket:\n    if i.isdigit():\n        Ticket.append('Num')\n    else:\n        Ticket.append(i[0])\n#print(*Ticket)\ntrain['Ticket_Cat']=Ticket\ntrain['Ticket_Cat'].head()","7fc7dc47":"Ticket=[]\n\nfor i in test.Ticket:\n    if i.isdigit():\n        Ticket.append('Num')\n    else:\n        Ticket.append(i[0])\n#print(*Ticket)\ntest['Ticket_Cat']=Ticket\ntest['Ticket_Cat'].head()","827cab4c":"sns.countplot(x='Ticket_Cat',hue='Survived',data=train);","fba1e4a3":"train.info()","18286997":"train['Family']=train['SibSp']+train['Parch']+1","76ec84e9":"test['Family'] = test['SibSp'] + test['Parch'] + 1","80cd6073":"train['Family']=pd.cut(train.Family, [0,1,4,7,11], labels=['Solo', 'Small', 'Big', 'Very big'])\ntest['Family']= pd.cut(test.Family, [0,1,4,7,11], labels=['Solo', 'Small', 'Big', 'Very big'])\ntrain.head()","5e6016a4":"y=train['Survived']\nfeatures=['Pclass','Fare','Sex','Age','Ticket_Cat','Embarked','Family','Cabin']\nX=train[features]\nX.tail()","9966dec1":"from sklearn.impute import SimpleImputer\nfrom sklearn.preprocessing import OneHotEncoder\nfrom sklearn.compose import ColumnTransformer\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.ensemble import RandomForestClassifier","2c8b711c":"numerical_cols=['Age','Fare']\n\ncategorical_cols=['Pclass','Sex','Ticket_Cat','Embarked','Family','Cabin']\n\nnumerical_transformer = SimpleImputer(strategy='median')\n\ncategorical_transformer = Pipeline(steps=[\n    ('imputer', SimpleImputer(strategy='most_frequent')),\n    ('onehot', OneHotEncoder())\n])\npreprocessor = ColumnTransformer(\n    transformers=[\n        ('num', numerical_transformer, numerical_cols),\n        ('cat', categorical_transformer, categorical_cols)\n    ])\n\nmodel = Pipeline(steps=[('preprocessor', preprocessor),\n                              ('model', RandomForestClassifier(random_state=0, \n                                                               n_estimators=600, max_depth=5))\n                             ])\nmodel.fit(X,y);","ea7a82b4":"X_test=test[features]\nX.head()","8af489a2":"preds=model.predict(X_test)","29dc7cd0":"result = pd.DataFrame({'PassengerId': test.PassengerId, 'Survived': preds}) \nresult.to_csv('submission.csv', index=False)","b3f8d8d2":"\u6b21\u306bTicket\u3092\u898b\u308b","7d90b84d":"Cabin\u306e\u30c7\u30fc\u30bf\u304c\u3042\u3063\u305f\u307b\u3046\u304c\u751f\u304d\u6b8b\u3063\u3066\u3044\u308b\uff1f","845ae708":"\u6570\u5b57\u3060\u3051\u306e\u4eba\u3068\u305d\u306e\u524d\u306b\u30a2\u30eb\u30d5\u30a1\u30d9\u30c3\u30c8\u304c\u3042\u308b\u4eba\u304c\u3044\u308b\u3002\n\nCabin\u3068\u540c\u69d8\u3001\u982d\u6587\u5b57\u3092\u3068\u308b\u3002"}}