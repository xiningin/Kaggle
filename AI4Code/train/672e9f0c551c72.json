{"cell_type":{"299de50b":"code","503ecd91":"code","2ce8ee67":"code","f31b3243":"code","1aab268f":"code","e6a741c1":"code","eefe298a":"code","c1f056fa":"code","42f040ca":"code","347ff869":"code","9eebdae6":"code","6d8157cc":"code","5e7d7571":"code","2d6a754b":"code","1235a519":"code","67ffc06a":"markdown","9dafeb0e":"markdown","5e3765d8":"markdown"},"source":{"299de50b":"import os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","503ecd91":"from fastai.vision import *\npath = Path('\/kaggle\/input\/bottles-and-cans\/')\nimport numpy as np # linear algebra\nimport pandas as pd","2ce8ee67":"tfms = get_transforms(do_flip=True,max_lighting=0.1,max_rotate=0.1)","f31b3243":"data = (ImageDataBunch.from_folder(path,train='.',valid_pct=0.15,ds_tfms=tfms,size=224, num_workers=4)\n                     .normalize(imagenet_stats))   # valid size here its 15% of total images, \n                                                # train = train folder here we use all the folder\n                                                # from_folder take images from folder and labels them like wise","1aab268f":"data.show_batch(rows=3)","e6a741c1":"len(data.classes), len(data.train_ds), len(data.valid_ds)","eefe298a":"fb = FBeta()\nfb.average = 'macro'\n# We are using fbeta macro average in case some class of birds have less train images","c1f056fa":"learn = cnn_learner(data, models.resnet18, metrics=[error_rate,fb, accuracy],model_dir=\"\/tmp\/model\/\")","42f040ca":"learn.lr_find()\nlearn.recorder.plot()","347ff869":"lr = 1e-2 # learning rate\nlearn.fit_one_cycle(10,lr,moms=(0.8,0.7))  # moms","9eebdae6":"interp = ClassificationInterpretation.from_learner(learn)\n\nlosses,idxs = interp.top_losses()\n\nlen(data.valid_ds)==len(losses)==len(idxs)","6d8157cc":"interp.plot_top_losses(9, figsize=(15,11))","5e7d7571":"interp.most_confused(min_val=2)","2d6a754b":"learn = cnn_learner(data, models.resnet101, metrics=[error_rate,fb, accuracy],model_dir='.\/working')\nlr = 1e-2 # learning rate\nlearn.fit_one_cycle(10,lr,moms=(0.8,0.7))  # moms","1235a519":"learn = cnn_learner(data, models.alexnet, metrics=[error_rate,fb, accuracy],model_dir='.\/working')\nlr = 1e-2 # learning rate\nlearn.fit_one_cycle(10,lr,moms=(0.8,0.7))  # moms","67ffc06a":"# Resnet 18","9dafeb0e":"# Resnet 101","5e3765d8":"# Alexnet"}}