{"cell_type":{"45f5ec46":"code","bd4f98c6":"code","75c25639":"code","9bc2ba5a":"code","9f40998d":"code","0f4e07f2":"code","6a40a17f":"code","8191d133":"code","e32c731a":"code","67fce48a":"code","b8d47b73":"code","bd4deb21":"code","ca99879a":"code","ca0f026c":"code","62ac9871":"code","4074774a":"code","6fa2624e":"code","934d3847":"code","cee7a025":"code","fba15d9e":"markdown"},"source":{"45f5ec46":"import os\nimport pandas as pd\nimport numpy as np\n\nfrom pathlib import Path\n\npath = Path('..\/input\/tabular-playground-series-may-2021')","bd4f98c6":"os.listdir(path)","75c25639":"train = pd.read_csv(path \/ 'train.csv')\ntest = pd.read_csv(path \/ 'test.csv')\nsub = pd.read_csv(path \/ 'sample_submission.csv')","9bc2ba5a":"train.head()","9f40998d":"targets = train['target']\nfeatures = train.drop(columns = ['id','target'])","0f4e07f2":"from sklearn.preprocessing import LabelEncoder \nle = LabelEncoder()\ntargets = le.fit_transform(targets)\ntargets","6a40a17f":"le.classes_","8191d133":"from sklearn.model_selection import train_test_split\nxtrain, xtest, ytrain, ytest = train_test_split(features.values, targets, test_size = 0.1, shuffle = True, random_state = 44)","e32c731a":"import optuna.integration.lightgbm as lgb\ndtrain = lgb.Dataset(xtrain, label = ytrain)\ndtest = lgb.Dataset(xtest, label = ytest)\nparams = {'objective' : 'multiclass', 'num_class' : 4,  'metric' : 'multi_logloss', 'verbosity' : -1, 'boosting_type' : 'gbdt'}\nmodel = lgb.train(params, dtrain, valid_sets = [dtest], verbose_eval = 100, early_stopping_rounds = 100)","67fce48a":"params = model.params\nparams","b8d47b73":"from lightgbm import LGBMClassifier\nmodel = LGBMClassifier(**params)","bd4deb21":"model.fit(xtrain, ytrain, eval_set = ((xtest, ytest)), early_stopping_rounds = 50, verbose = 0)","ca99879a":"sub.head()","ca0f026c":"sub['id'] = test['id']","62ac9871":"test = test.drop(columns = ['id'])","4074774a":"preds = model.predict_proba(test)","6fa2624e":"preds","934d3847":"sub['Class_1']=preds[:,0]\nsub['Class_2']=preds[:,1]\nsub['Class_3']=preds[:,2]\nsub['Class_4']=preds[:,3]\nsub.head()","cee7a025":"sub.to_csv('Submission.csv', index = False)\nsub.head()","fba15d9e":"Please Upvote this kernel if you like it!"}}