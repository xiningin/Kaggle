{"cell_type":{"b0157b5b":"code","b92c0ff0":"code","c7dcac45":"code","c59bc070":"code","05e9822a":"code","3e50da16":"code","29fcb7cd":"code","bb4d91aa":"code","93e56588":"code","4eefded2":"code","e86bd3de":"code","402a6fae":"code","1573db76":"code","a8394e82":"code","7c0e5a82":"code","07d491ef":"code","99ece5fc":"code","92e3d540":"code","244787f9":"code","56a00f70":"code","47ca0d43":"code","12029f2f":"code","870ae486":"code","a6018c08":"code","03afad89":"code","d7b837d3":"code","daf3846f":"code","f99bfd56":"code","f78bf022":"code","f4ac6a94":"code","0830b839":"code","371216a3":"code","0a94f4f3":"markdown"},"source":{"b0157b5b":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","b92c0ff0":"text=pd.read_csv(\"..\/input\/spam-text-message-classification\/SPAM text message 20170820 - Data.csv\")","c7dcac45":"text.head()","c59bc070":"text.info()","05e9822a":"text.describe()","3e50da16":"import matplotlib.pyplot as plt\n%matplotlib inline","29fcb7cd":"text.groupby([\"Category\"]).count().plot(kind=\"bar\",color='blue')","bb4d91aa":"text.groupby([\"Category\"]).describe()","93e56588":"text.drop_duplicates(inplace=True)","4eefded2":"text.groupby([\"Category\"]).describe()","e86bd3de":"import string\nimport nltk\nfrom nltk.corpus import stopwords","402a6fae":"stopword=stopwords.words('english')","1573db76":"def text_preprocessing(texts):\n    tex=texts.strip()\n    texts_word=[word for word in tex.split() if \"@\" not in word]\n    tex=\" \".join(texts_word)\n    texts_word=[word for word in tex.split() if \"#\" not in word]\n    tex=\" \".join(texts_word)\n    texts_word=[word for word in tex.split() if \"www.\" not in word]\n    tex=\" \".join(texts_word)\n    texts_word=[word for word in tex.split() if \"http\" not in word]\n    tex=\" \".join(texts_word)\n    texts_word=[word for word in tex if word not in string.punctuation]\n    tex=\"\".join(texts_word)\n    texts_word=[word for word in tex.split() if word not in stopword]\n    tex=\" \".join(texts_word)\n    texts_word=[word for word in tex.split() if word.isalpha()]\n    tex=\" \".join(texts_word)\n    texts_word=[word.lower() for word in tex.split()]\n    tex=\" \".join(texts_word)\n    tex=tex.strip()\n    return tex.split()","a8394e82":"from sklearn.feature_extraction.text import CountVectorizer,TfidfTransformer","7c0e5a82":"text[\"Message\"]=text[\"Message\"].astype('str')","07d491ef":"cv=CountVectorizer(analyzer=text_preprocessing).fit(text.Message)","99ece5fc":"cv_trans=cv.transform(text.Message)","92e3d540":"print(cv_trans[2])","244787f9":"cv.get_feature_names()[900]","56a00f70":"type(cv_trans)","47ca0d43":"tfidf=TfidfTransformer().fit(cv_trans)\ntfidf_trans=tfidf.transform(cv_trans)","12029f2f":"print(tfidf_trans[0])","870ae486":"from sklearn.model_selection import train_test_split\nfrom sklearn.svm import SVC\nfrom sklearn.metrics import classification_report,confusion_matrix,accuracy_score","a6018c08":"X_train,X_test,y_train,y_test=train_test_split(tfidf_trans,text.Category,test_size=0.15,random_state=42)","03afad89":"?SVC","d7b837d3":"svc=SVC(gamma=0.5,tol=0.51,decision_function_shape='ovo')","daf3846f":"svc.fit(X_train,y_train)","f99bfd56":"print(\"train accuracy: {0} \\ntest accuracy: {1}\".format(accuracy_score(y_train,svc.predict(X_train)),\n                                                       accuracy_score(y_test,svc.predict(X_test))))","f78bf022":"classification_report(y_test,svc.predict(X_test))","f4ac6a94":"confusion_matrix(y_test,svc.predict(X_test))","0830b839":"svc=SVC(gamma=0.5,tol=0.51,decision_function_shape='ovr',random_state=42)\nsvc.fit(X_train,y_train)\nprint(\"train accuracy: {0} \\ntest accuracy: {1}\".format(accuracy_score(y_train,svc.predict(X_train)),\n                                                       accuracy_score(y_test,svc.predict(X_test))))\nprint(\"******************************************************\")\nprint(classification_report(y_test,svc.predict(X_test)))\nprint(\"******************************************************\")\nprint(confusion_matrix(y_test,svc.predict(X_test)))","371216a3":"cv_trans.shape","0a94f4f3":"# 99% train AND 98% test accuracy"}}