{"cell_type":{"d5b0e28d":"code","e698d7cf":"code","6443d34d":"code","6bd1cf1e":"code","3e8916f5":"code","1eaaac7d":"code","3032d358":"code","74c8a080":"code","98e9dc63":"markdown","3365d9eb":"markdown","64cfb2fc":"markdown","67604523":"markdown","7f7bf7d5":"markdown","6b175625":"markdown","09b67d74":"markdown"},"source":{"d5b0e28d":"import plotly.express as px\nimport pandas as pd","e698d7cf":"iso_codes = pd.read_csv('https:\/\/gist.githubusercontent.com\/tadast\/8827699\/raw\/f5cac3d42d16b78348610fc4ec301e9234f82821\/countries_codes_and_coordinates.csv')\niso_codes = iso_codes.set_index('Country')\niso_codes = iso_codes['Alpha-3 code']\niso_codes = iso_codes.replace(regex={'\\\"': '', ' ': ''})\n\niso_codes['Iran'] = 'IRN'\niso_codes['US'] = 'USA'\niso_codes['Syria'] = 'SYR'\niso_codes['Congo (Kinshasa)'] = 'COD'\niso_codes['Korea, South'] = 'KOR'\niso_codes['Taiwan*'] = 'TWN'\niso_codes['Congo (Brazzaville)'] = 'COG'\niso_codes['Laos'] = 'LAO'\niso_codes[\"Cote d'Ivoire\"] = 'CIV'\niso_codes['Czechia'] = 'CZE'\niso_codes['Tanzania'] = 'TZA'","6443d34d":"data = pd.read_csv('https:\/\/raw.githubusercontent.com\/CSSEGISandData\/COVID-19\/master\/csse_covid_19_data\/csse_covid_19_time_series\/time_series_covid19_confirmed_global.csv')\n\ndata = data.drop(columns=['Province\/State','Lat', 'Long'])\ndata = data.groupby('Country\/Region').agg('sum')\n\ndate_list = list(data.columns[7:])\n\ndata['country'] = data.index\ndata['iso_code'] = data['country'].apply(lambda x: iso_codes.loc[x] if x in iso_codes.index else None)","6bd1cf1e":"data.loc[data[\"iso_code\"].isnull()]","3e8916f5":"data[data.columns[:-2]] = data[data.columns[:-2]] - data[data.columns[:-2]].shift(1, axis=1, fill_value=0)","1eaaac7d":"data[data.columns[:-2]] = data[data.columns[:-2]].rolling(window=7, axis=1).mean()\ndata = data.drop(columns=data.columns[:7])\ndata[data.columns[:-2]] = data[data.columns[:-2]].astype('int')","3032d358":"df_long = pd.melt(data, id_vars=['country', 'iso_code'], value_vars=date_list)\ndf_long = df_long.rename(columns={\"variable\": \"date\", \"value\": \"case_count\"})","74c8a080":"fig = px.choropleth(df_long,                          \n                     locations=\"iso_code\", \n                     color=\"case_count\",\n                     hover_name=\"country\",\n                     animation_frame=\"date\",\n                     projection=\"natural earth\",\n                     color_continuous_scale = \"Peach\",\n                     range_color=[0, 5000]\n                     )\n\nfig.show()\n# fig.write_html(\"case_map.html\")   If you want to write the map as a html page","98e9dc63":"### 7 days moving average","3365d9eb":"### Plot the data (the colors based on cases)","64cfb2fc":"### ISO-3 country codes","67604523":"### Get the data from url","7f7bf7d5":"### Last form of data frame","6b175625":"### The countries that don't have iso code","09b67d74":"### Total case count -> daily case count"}}