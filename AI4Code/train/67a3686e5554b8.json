{"cell_type":{"cab485d9":"code","05ff547b":"code","e0662c98":"code","d6202c1f":"code","1ab9a9af":"code","bc620331":"code","d91dea63":"code","f12d17d0":"code","e648dee8":"code","75edca73":"code","5e7ac901":"markdown","62ceb36d":"markdown","3209f46b":"markdown","a0971d08":"markdown","c63cff95":"markdown","9ebbaa47":"markdown","390f091b":"markdown","f665034a":"markdown","c826b45c":"markdown","ed2eb8b6":"markdown","9109fc8f":"markdown","6bc5a936":"markdown","30c981ce":"markdown","8aaabd18":"markdown","36a87e57":"markdown"},"source":{"cab485d9":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom functools import reduce\nfrom sklearn.cluster import KMeans\nfrom sklearn.metrics import silhouette_samples, silhouette_score","05ff547b":"df1=pd.read_csv(\"..\/input\/europe-datasets\/crime_2016.csv\")\ndf2=pd.read_csv(\"..\/input\/europe-datasets\/pollution_2016.csv\")\ndf3=pd.read_csv(\"..\/input\/europe-datasets\/trust_in_legal_2013.csv\")\ndf4=pd.read_csv(\"..\/input\/europe-datasets\/trust_in_police_2013.csv\")\ndf5=pd.read_csv(\"..\/input\/europe-datasets\/trust_in_politics_2013.csv\")\ndf6=pd.read_csv(\"..\/input\/europe-datasets\/gdp_2016.csv\")\ndf7=pd.read_csv(\"..\/input\/europe-datasets\/perceived_health_2016.csv\")\ndf8=pd.read_csv(\"..\/input\/europe-datasets\/population_2011.csv\")","e0662c98":"# consolidate data with the country as the unique identifier\ndata=reduce(lambda x,y: pd.merge(x,y, on='country', how='inner'), \n            [df1, df2, df3, df4, df5, df6, df7, df8])\n\n# matrix without the unique identifier for fitting later\nx=data\nx=x.drop('country',1)","d6202c1f":"# Elbow Method\nsum_of_sq_dist=[] # initialize\nK=range(1,10) # check up to 10 clusters\nfor k in K:\n    km=KMeans(n_clusters=k)\n    km=km.fit(x)\n    sum_of_sq_dist.append(km.inertia_)\n\n# plot the result\nplt.plot(K,sum_of_sq_dist,'bx-')\nplt.xlabel('k clusters')\nplt.ylabel('Sum of Squared Distances')\nplt.title('Elbow Method for Best k')\nplt.show()","1ab9a9af":"# Print results from Avg Silhouette Method\nfor n_clusters in range(2,11): # check up to 10 clusters\n    clusterer=KMeans(n_clusters=n_clusters,random_state=10) # seed 10\n    cluster_labels=clusterer.fit_predict(x)\n    silhouette_avg=silhouette_score(x,cluster_labels)\n    print(\"When we use\",n_clusters,\"clusters,\",\n          \"the average silhouette score is\",\n          round(silhouette_avg,3)) # round to 3 decimals for readable comparison\n    sample_silhouette_values=silhouette_samples(x,cluster_labels)","bc620331":"# Fit with k-means clustering\nkmeans=KMeans(n_clusters=2)\nkmeans=kmeans.fit(x)\n\ncol=list(x.columns.values) # original variables\ncount=data.iloc[:,0] # original countries\n\nctr=kmeans.cluster_centers_ # cluster coordinates\ncount_label=kmeans.labels_+1 # assign cluster numbers as cluster 1 and 2 for intuition\n\n# Show results\nctr=pd.DataFrame(ctr,columns=col)\nctr.insert(0,\"cluster\",[1,2]) # label countries\n(ctr.T).round(2)","d91dea63":"# show the clustered countries\nctry_sum={'country': count,\n          'cluster': count_label} \nctry_sum=pd.DataFrame(ctry_sum,columns=['country','cluster'])\nctry_sum","f12d17d0":"result = pd.concat([ctry_sum.reset_index(drop=True), x], axis=1) # original data and cluster results\ncluster_1=result[result.cluster==1]\ncluster_2=result[result.cluster==2]\nplt.scatter(cluster_1.iloc[:,2],cluster_1.iloc[:,14],c=\"green\",label=\"Cluster 1\")\nplt.scatter(cluster_2.iloc[:,2],cluster_2.iloc[:,14],c=\"red\",label=\"Cluster 2\")\nplt.xlabel('% Reported Crime')\nplt.ylabel('% Young Adult Pop')\nplt.title('% Reported Crime vs. % Young Adult Pop')\nplt.legend()\nplt.show()","e648dee8":"plt.scatter(cluster_1.iloc[:,12],cluster_1.iloc[:,13],c=\"green\",label=\"Cluster 1\")\nplt.scatter(cluster_2.iloc[:,12],cluster_2.iloc[:,13],c=\"red\",label=\"Cluster 2\")\nplt.xlabel('% Pop in Very Bad Health')\nplt.ylabel('Pop (10s of millions)')\nplt.title('% Pop in Very Bad Health vs. Pop (10 millions)')\nplt.legend()\nplt.show()","75edca73":"plt.scatter(cluster_1.iloc[:,3],cluster_1.iloc[:,7],c=\"green\",label=\"Cluster 1\")\nplt.scatter(cluster_2.iloc[:,3],cluster_2.iloc[:,7],c=\"red\",label=\"Cluster 2\")\nplt.xlabel('% Pollution')\nplt.ylabel('GDP')\nplt.title('% Pollution vs. GDP')\nplt.legend()\nplt.show()","5e7ac901":"Let's visualize the results by plotting the clustered data points.","62ceb36d":"A bit of overlap here, although still relatively distanced since GDP of Cluster 2 on average is greater than Cluster 1.","3209f46b":"The best pick should be where the \"Elbow\" is in the graph. Looks like 2 clusters might be a good choice. Let's look at the average silhouette method. We want the number of clusters corresponding to the highest silhouette score.","a0971d08":"We begin by importing the required libraries.","c63cff95":"We compare the characteristics of cluster 1 and cluster 2. \nNotice that cluster 1 pertains to a lower reported crime rate (inferred as % criminal incidents\/population), lower reported pollution, as well as stronger trust in the legal, police, and political systems. They also have overall more people in better health and greater percentage of younger adults. \n\nHowever, countries falling in cluster 2 have a better GDP and higher population. It is notable that the actual difference in the centroids (centers) of the 2 clusters is not that large. Variables such as the crime rate in cluster 2 is only a few percent below cluster 1.","9ebbaa47":"Next, let's decide the number of clusters to be used. Since there are 32 countries we know that the number of clusters should be smaller. We will use 2 methods: the Elbow Method and Average Silhouette Method.","390f091b":"Thanks for reading! Please let me know if you have any comments or suggestions.","f665034a":"Combine the data and prep the data for clustering.","c826b45c":"We see two distinct groups, which is good to see here. From our comparisons between Cluster 1 and 2 this is understandable as there is a large difference in population between the two clusters. We see countries in cluster 2 have a much higher population (but also greater variation in population) than cluster 1.","ed2eb8b6":"We find that Germany, Spain, France, Italy, Poland, and the UK fall under cluster 2, which suggests that perhaps we could be more alert towards aspects like crime when travelling to these countries.","9109fc8f":"Below I will import the datasets with metrics that I personally consider to be important when it comes to travelling. This includes crime, pollution, trust in the legal\/police\/political system, GDP, perceived health, and population.","6bc5a936":"In terms of relevance, the difference in clusters are more distinct for some variables than others - besides GDP or population, the actual differences in countries is quite marginal. We see minor differences between clusters in metrics such as reported crime but larger differences when we look at population. Thus, these groupings should not discourage travelling to certain European countries, but rather to gain an understanding of different countries' characteristics. There are also other factors such as new events that may occur and shape these measurements differently over time, as well as immigration\/visitation laws that might deter tourists from visiting certain coutnries.","30c981ce":"Evidently, the higest silhouette score is achieved at 2 clusters, which agrees with our value obtained from the Elbow Method. So, we will use 2 clusters for the k-means clustering.","8aaabd18":"As a person interested in travelling in Europe, I want to know which countries may have similar characteristics for my own safety. For example, I would be more cautious when travelling to countries that are grouped together because they have a higher crime rate and their citizens have a low confidence rating in the legal system. Hence, I would like to group similar countries together via k-means clustering.\n\nNote that according to the UN, there are 44 countries in Europe. \nSource: https:\/\/www.worldometers.info\/geography\/how-many-countries-in-europe\/\nHowever, this dataset contains 32 countries, so 12 European countries will be excluded from any generalizations made from the data.\n\nThis notebook will be structured as follows:\n1. Importing Libraries and Data Preparation\n2. Determining Optimal Number of Clusters\n3. Implementing K-Means Clustering\n4. Summarizing Results\n5. Examining Relevance of Results","36a87e57":"Our original comparison led us to infer that crime tends to be higher in cluster 2. However, this observation is not always the case as the clustering seems to overlap in some areas, which is not necessarily ideal. Notably, Bulgaria falls into cluster 1 despite having the highest crime rate of 25%. As mentioned earlier, the difference in crime rates between the two clusters is small (<3%), hence this is to be expected."}}