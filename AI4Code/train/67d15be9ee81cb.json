{"cell_type":{"6bcf6bea":"code","46d35a66":"code","b13b6230":"code","d32b33d1":"code","87842ece":"code","cccc5da9":"code","10cba994":"code","30d4510a":"code","a6141d4b":"code","337f741b":"code","c6bf9c1f":"code","72ef032b":"code","6f896e83":"code","74c6c906":"code","38695083":"code","46bfc931":"code","deae2d3c":"code","a949b906":"code","64bf0912":"code","70a1a982":"code","b921509e":"code","c385af77":"code","d44544cc":"code","03323413":"code","03c5ae44":"code","02d16f5b":"code","ac4cebc5":"code","73e43536":"code","8dc4fd19":"code","3075d65d":"code","dbbd87d6":"code","b8a4a3f7":"code","7be5644f":"code","e55ff7ff":"code","6c2a482a":"code","33f5ca32":"code","6e874adc":"code","045d1899":"code","c34e073a":"code","4f2af636":"markdown","8bff6951":"markdown","ff6ad6cd":"markdown"},"source":{"6bcf6bea":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline","46d35a66":"train = pd.read_csv('data\/train.csv')\ntest = pd.read_csv('data\/test.csv')","b13b6230":"train.head()","d32b33d1":"train.isnull().sum()","87842ece":"sns.countplot(train.Response);","cccc5da9":"sns.countplot(train.Gender)","10cba994":"df=train.groupby(['Gender','Response'])['id'].count().to_frame().rename(columns={'id':'count'}).reset_index()\ndf","30d4510a":"sns.catplot(x=\"Gender\", y=\"count\",col=\"Response\",\n                data=df, kind=\"bar\");","a6141d4b":"sns.distplot(train.Age);","337f741b":"train.Age.describe()","c6bf9c1f":"sns.jointplot(x='Age',y='Annual_Premium',data=train,kind='scatter');","72ef032b":"train.Annual_Premium.describe()","6f896e83":"sns.distplot(train.Annual_Premium);","74c6c906":"sns.countplot(train.Previously_Insured);","38695083":"sns.countplot(train.Vehicle_Age);","46bfc931":"pd.crosstab(train['Driving_License'],train['Response']).plot(kind='bar');","deae2d3c":"pd.crosstab(train.Vehicle_Damage,train.Response).plot(kind='bar');","a949b906":"train.head()","64bf0912":"train = train.drop('id',axis=1)","70a1a982":"train['Gender'] = train['Gender'].map({'Male':0,'Female':1}).astype(int)","b921509e":"train=pd.get_dummies(train,drop_first=True)\ntrain=train.rename(columns={\"Vehicle_Age_< 1 Year\": \"Vehicle_Age_lt_1_Year\", \"Vehicle_Age_> 2 Years\": \"Vehicle_Age_gt_2_Years\"})\ntrain['Vehicle_Age_lt_1_Year']=train['Vehicle_Age_lt_1_Year'].astype('int')\ntrain['Vehicle_Age_gt_2_Years']=train['Vehicle_Age_gt_2_Years'].astype('int')\ntrain['Vehicle_Damage_Yes']=train['Vehicle_Damage_Yes'].astype('int')","c385af77":"train.head()","d44544cc":"target = train['Response']\ntrain = train.drop('Response',axis=1)","03323413":"x = train.copy()","03c5ae44":"import sklearn\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.metrics import roc_auc_score\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.model_selection import GridSearchCV \nfrom sklearn.model_selection import RandomizedSearchCV ","02d16f5b":"X_train, X_valid, y_train, y_valid = train_test_split(x,target,test_size=0.3, random_state=17)","ac4cebc5":"scaler = StandardScaler()\nX_train_scaled = scaler.fit_transform(X_train)\nX_valid_scaled = scaler.transform(X_valid)","73e43536":"logit = LogisticRegression(random_state=17)\nlogit.fit(X_train_scaled, y_train)\nprediction = logit.predict_proba(X_valid_scaled)[:,1]","8dc4fd19":"roc_auc_score(y_valid,prediction)","3075d65d":"rfc = RandomForestClassifier(n_estimators=100)\nrfc.fit(X_train_scaled,y_train)\nprediction = rfc.predict_proba(X_valid)[:,1]\nroc_auc_score(y_valid,prediction)","dbbd87d6":"test.head()","b8a4a3f7":"test = test.drop('id',axis=1)\ntest['Gender'] = test['Gender'].map({'Male':0,'Female':1}).astype(int)\ntest=pd.get_dummies(test,drop_first=True)\ntest=test.rename(columns={\"Vehicle_Age_< 1 Year\": \"Vehicle_Age_lt_1_Year\", \"Vehicle_Age_> 2 Years\": \"Vehicle_Age_gt_2_Years\"})\ntest['Vehicle_Age_lt_1_Year']=test['Vehicle_Age_lt_1_Year'].astype('int')\ntest['Vehicle_Age_gt_2_Years']=test['Vehicle_Age_gt_2_Years'].astype('int')\ntest['Vehicle_Damage_Yes']=test['Vehicle_Damage_Yes'].astype('int')","7be5644f":"X_train_scaled = scaler.fit_transform(train)\nX_test_scaled = scaler.fit_transform(test)","e55ff7ff":"rfs = RandomForestClassifier(random_state=17)\nparam_grid = {'n_estimators':[100,150,200],\n             'criterion':['gini','entropy'],\n             'bootstrap':[True],\n             'max_depth':[15,20,25,30],\n             'max_features':['auto','sqrt',10],\n             'min_samples_leaf':[2,3],\n             'min_samples_split':[2,3]}\nclf_rfs = RandomizedSearchCV(rfs,param_distributions=param_grid,cv=5,verbose=True,n_jobs=-1)\nbest_clf_rfs = clf_rfs.fit(X_train_scaled,target)","6c2a482a":"best_clf_rfs.best_params_","33f5ca32":"best_clf_rfs.best_score_","6e874adc":"predictions = best_clf_rfs.predict(X_test_scaled).astype(int)","045d1899":"output_test = pd.read_csv('data\/test.csv')\noutput = pd.DataFrame({'id':output_test.id,'Response':predictions})\noutput.to_csv('submission.csv',index=False)","c34e073a":"output.head()","4f2af636":"## Gender","8bff6951":"## Age","ff6ad6cd":"## Working with features"}}