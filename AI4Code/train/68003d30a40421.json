{"cell_type":{"2b27bde6":"code","81b9ed36":"code","50eaafd4":"code","b48a05a9":"code","6b258b6a":"code","84663026":"code","554223fa":"code","7ebfd569":"code","64734af4":"code","956f36ec":"code","517a8c8a":"code","924ea494":"markdown","1f36be8b":"markdown","939501aa":"markdown","b97b4e1b":"markdown","1b5957a4":"markdown","6af6a2e8":"markdown","a831a53c":"markdown"},"source":{"2b27bde6":"%%time\n# Thanks to https:\/\/www.kaggle.com\/tunguz\/mnist-2d-t-sne-with-rapids\n# INSTALL RAPIDS OFFLINE (FROM KAGGLE DATASET). TAKES 1 MINUTE :-)\nimport sys\n!cp ..\/input\/rapids\/rapids.0.18.0 \/opt\/conda\/envs\/rapids.tar.gz\n!cd \/opt\/conda\/envs\/ && tar -xzvf rapids.tar.gz\nsys.path = [\"\/opt\/conda\/envs\/rapids\/lib\"] + [\"\/opt\/conda\/envs\/rapids\/lib\/python3.6\"] + [\"\/opt\/conda\/envs\/rapids\/lib\/python3.6\/site-packages\"] + sys.path\n!cp \/opt\/conda\/envs\/rapids\/lib\/libxgboost.so \/opt\/conda\/lib\/","81b9ed36":"from scipy.io import loadmat\nimport cudf, cuml\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport plotly.express as px\nfrom cuml.manifold import TSNE, UMAP\n%matplotlib inline","50eaafd4":"# Thanks to https:\/\/www.kaggle.com\/mosius\/cnn-over-mnist\ndef load_mnist_dataset():\n    \"\"\"\n    Load MNIST-original dataset\n\n    Returns:\n    - mnist_data -- an array of arrays in the shape of (784,)\n    - mnist_label -- an array of labels\n    - classes -- array of labels classes(a set of labels)\n    \"\"\"\n\n    mnist = loadmat(\"..\/input\/mnist-original\/mnist-original.mat\")\n    mnist_data = mnist[\"data\"].T\n    mnist_data = mnist_data.reshape(len(mnist_data), 784)\n    mnist_label = mnist[\"label\"][0]\n    count = len(set(mnist_label))\n    return mnist_data, mnist_label, count","b48a05a9":"%%time\n# Download data from MNIST-original dataset\ndata, labels, classes_count = load_mnist_dataset()\n\nprint(\"data shape: \" + str(data.shape))\nprint(\"labels shape: \" + str(labels.shape))\nprint(\"classes count: \" + str(classes_count))","6b258b6a":"%%time\n# 2D with TSNE\ntsne = TSNE(n_components=2)\ndata_2D = tsne.fit_transform(data)","84663026":"# Visualization from https:\/\/www.kaggle.com\/tunguz\/mnist-2d-t-sne-with-rapids\nplt.scatter(data_2D[:,0], data_2D[:,1], c = labels, s = 0.5)","554223fa":"# Visualization from https:\/\/www.kaggle.com\/xhlulu\/disasternlp-t-sne-with-tfhub-rapids-plotly\nfig = px.scatter(\n    x=data_2D[:, 0], y=data_2D[:, 1], \n    color=labels, hover_name=labels, height=700\n)\nfig.show()","7ebfd569":"np.save('data_2D', data_2D)","64734af4":"%%time\numap3d = UMAP(n_components=3)\ndata_3D = umap3d.fit_transform(data)","956f36ec":"fig = px.scatter_3d(\n    x=data_3D[:, 0], y=data_3D[:, 1], z=data_3D[:, 2], \n    color=labels, hover_name=labels, size_max=2, height=700\n)\nfig.update_traces(marker=dict(size=3))\n\nfig.show()","517a8c8a":"np.save('data_3D', data_3D)","924ea494":"### 2D Clustering and Visualization with TSNE\n\nThansk to https:\/\/www.kaggle.com\/tunguz\/mnist-2d-t-sne-with-rapids and https:\/\/www.kaggle.com\/xhlulu\/disasternlp-t-sne-with-tfhub-rapids-plotly","1f36be8b":"# MNIST Digits Original : 2D with t-SNE, 3D with UMAP and with Rapids\n## Dataset [MNIST Original](https:\/\/www.kaggle.com\/avnishnish\/mnist-original)","939501aa":"### 3D Clustering and Visualization with UMAP\n\nThanks to https:\/\/www.kaggle.com\/xhlulu\/disasternlp-t-sne-with-tfhub-rapids-plotly","b97b4e1b":"I hope you find this notebook useful and enjoyable.\n\nYour comments and feedback are most welcome.","1b5957a4":"[Rapids](https:\/\/rapids.ai) is an open-source GPU accelerated Data Science and Machine Learning library, developed and maintained by [Nvidia](https:\/\/www.nvidia.com). It is designed to be compatible with many existing CPU tools, such as Pandas, scikit-learn, numpy, etc. It enables **massive** acceleration of many data-science and machine learning tasks, oftentimes by a factor of 100X, or even more. The first successful install of a Rapids library on Kaggle was done by [Chris Deotte](https:\/\/www.kaggle.com\/cdeotte) in the following [Digit Recognizer kernel](https:\/\/www.kaggle.com\/cdeotte\/rapids-gpu-knn-mnist-0-97). An improved install version that uses a Kaggle Dataset for install can be found [here](https:\/\/www.kaggle.com\/cdeotte\/rapids-data-augmentation-mnist-0-985). This kernel is based on the kernel [MNIST 2D t-SNE with Rapids](https:\/\/www.kaggle.com\/tunguz\/mnist-2d-t-sne-with-rapids)","6af6a2e8":"### Acknowledgements:\n* dataset [MNIST Original](https:\/\/www.kaggle.com\/avnishnish\/mnist-original)\n* dataset [MNIST models testing: typographic digits](https:\/\/www.kaggle.com\/vbmokin\/typographic-digits-first-10-fonts)\n* dataset [RAPIDS](https:\/\/www.kaggle.com\/cdeotte\/rapids)\n* notebook with 2D: [MNIST 2D t-SNE with Rapids](https:\/\/www.kaggle.com\/tunguz\/mnist-2d-t-sne-with-rapids) from [Chris Deotte](https:\/\/www.kaggle.com\/cdeotte)\n* notebook with 3D and Plotly visualization: [DisasterNLP: t-SNE with TFHub, RAPIDS, Plotly](https:\/\/www.kaggle.com\/xhlulu\/disasternlp-t-sne-with-tfhub-rapids-plotly) from [xhlulu](https:\/\/www.kaggle.com\/xhlulu)\n* my notebook [MNIST Digits Original : 2D t-SNE with Rapids](https:\/\/www.kaggle.com\/vbmokin\/mnist-digits-original-2d-t-sne-with-rapids)\n* my notebook [MNIST model testing : typographic digits](https:\/\/www.kaggle.com\/vbmokin\/mnist-model-testing-typographic-digits)\n* [Rapids](https:\/\/rapids.ai)","a831a53c":"Various colors corrrespond to various digits. We see that same digits are fairly well clustered together, which is probably one of the main reasons why this problem is relatively easy for ML models to do. "}}