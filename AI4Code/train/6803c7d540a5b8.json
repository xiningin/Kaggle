{"cell_type":{"ef1268b7":"code","84f2b6e2":"code","35e1e804":"code","8d4b8e49":"code","b2a166ec":"code","cd435c1d":"code","f51d0d6e":"code","5dc0c59a":"markdown","9ee8c123":"markdown","a40341e0":"markdown","f3664494":"markdown"},"source":{"ef1268b7":"%%time\n# Thanks to https:\/\/www.kaggle.com\/tunguz\/mnist-2d-t-sne-with-rapids\n# INSTALL RAPIDS OFFLINE (FROM KAGGLE DATASET). TAKES 1 MINUTE :-)\nimport sys\n!cp ..\/input\/rapids\/rapids.0.18.0 \/opt\/conda\/envs\/rapids.tar.gz\n!cd \/opt\/conda\/envs\/ && tar -xzvf rapids.tar.gz\nsys.path = [\"\/opt\/conda\/envs\/rapids\/lib\"] + [\"\/opt\/conda\/envs\/rapids\/lib\/python3.6\"] + [\"\/opt\/conda\/envs\/rapids\/lib\/python3.6\/site-packages\"] + sys.path\n!cp \/opt\/conda\/envs\/rapids\/lib\/libxgboost.so \/opt\/conda\/lib\/","84f2b6e2":"from scipy.io import loadmat\nimport cudf, cuml\nimport pandas as pd\nimport numpy as np\nfrom cuml.manifold import TSNE\nimport matplotlib.pyplot as plt\n%matplotlib inline","35e1e804":"# Thanks to https:\/\/www.kaggle.com\/mosius\/cnn-over-mnist\ndef load_mnist_dataset():\n    \"\"\"\n    Load MNIST-original dataset\n\n    Returns:\n    - mnist_data -- an array of arrays in the shape of (784,)\n    - mnist_label -- an array of labels\n    - classes -- array of labels classes(a set of labels)\n    \"\"\"\n\n    mnist = loadmat(\"..\/input\/mnist-original\/mnist-original.mat\")\n    mnist_data = mnist[\"data\"].T\n    mnist_data = mnist_data.reshape(len(mnist_data), 784)\n    mnist_label = mnist[\"label\"][0]\n    count = len(set(mnist_label))\n    return mnist_data, mnist_label, count","8d4b8e49":"%%time\n# Download data from MNIST-original dataset\ndata, labels, classes_count = load_mnist_dataset()\n\nprint(\"data shape: \" + str(data.shape))\nprint(\"labels shape: \" + str(labels.shape))\nprint(\"classes count: \" + str(classes_count))","b2a166ec":"%%time\ntsne = TSNE(n_components=2)\ndata_2D = tsne.fit_transform(data)","cd435c1d":"%%time\nplt.scatter(data_2D[:,0], data_2D[:,1], c = labels, s = 0.5)","f51d0d6e":"np.save('data_2D', data_2D)","5dc0c59a":"# MNIST Digits Original : 2D t-SNE with Rapids\n## Dataset [MNIST Original](https:\/\/www.kaggle.com\/avnishnish\/mnist-original)","9ee8c123":"[Rapids](https:\/\/rapids.ai) is an open-source GPU accelerated Data Science and Machine Learning library, developed and maintained by [Nvidia](https:\/\/www.nvidia.com). It is designed to be compatible with many existing CPU tools, such as Pandas, scikit-learn, numpy, etc. It enables **massive** acceleration of many data-science and machine learning tasks, oftentimes by a factor of 100X, or even more. The first successful install of a Rapids library on Kaggle was done by [Chris Deotte](https:\/\/www.kaggle.com\/cdeotte) in the following [Digit Recognizer kernel](https:\/\/www.kaggle.com\/cdeotte\/rapids-gpu-knn-mnist-0-97). An improved install version that uses a Kaggle Dataset for install can be found [here](https:\/\/www.kaggle.com\/cdeotte\/rapids-data-augmentation-mnist-0-985). This kernel is based on the kernel [MNIST 2D t-SNE with Rapids](https:\/\/www.kaggle.com\/tunguz\/mnist-2d-t-sne-with-rapids)","a40341e0":"Various colors corrrespond to various digits. We see that same digits are fairly well clustered together, which is probably one of the main reasons why this problem is relatively easy for ML models to do. ","f3664494":"### Acknowledgements:\n* dataset [MNIST Original](https:\/\/www.kaggle.com\/avnishnish\/mnist-original)\n* dataset [MNIST models testing: typographic digits](https:\/\/www.kaggle.com\/vbmokin\/typographic-digits-first-10-fonts)\n* dataset [RAPIDS](https:\/\/www.kaggle.com\/cdeotte\/rapids)\n* notebook [MNIST 2D t-SNE with Rapids](https:\/\/www.kaggle.com\/tunguz\/mnist-2d-t-sne-with-rapids) from [Chris Deotte](https:\/\/www.kaggle.com\/cdeotte)\n* my notebook [MNIST model testing : typographic digits](https:\/\/www.kaggle.com\/vbmokin\/mnist-model-testing-typographic-digits)\n* [Rapids](https:\/\/rapids.ai)"}}