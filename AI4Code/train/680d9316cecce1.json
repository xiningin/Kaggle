{"cell_type":{"a26546a1":"code","508e3bb0":"code","aafe147f":"code","be3064cf":"code","08017b4f":"code","614e02c9":"code","682ef350":"code","aabccfd6":"code","ec4da791":"code","58aa3617":"code","97b3988b":"code","1d4f57af":"code","3a2345c6":"code","707a56e0":"code","58778843":"code","b6fbdd82":"code","a1547383":"code","c330b8f6":"code","a9cb6e2c":"code","5c79b81a":"code","c5f609c4":"code","807370fb":"code","964325d0":"code","68d33536":"code","a3971949":"code","fb223506":"code","bbf6a72f":"code","e7ad2339":"code","0da47b03":"code","d570aff3":"code","d84e94cd":"code","c084fca4":"code","8b2d2877":"code","c8fccb48":"markdown","5266d99c":"markdown","96e82c63":"markdown","5396fa02":"markdown","a2e0fb8a":"markdown","44f95e20":"markdown","19843e09":"markdown","c0666794":"markdown","3318ca1f":"markdown","6a6f5542":"markdown","3e00d80f":"markdown","0f16de30":"markdown","422d03de":"markdown","9f02b822":"markdown","26869690":"markdown","7729377d":"markdown","40a5bdb0":"markdown","493babb7":"markdown"},"source":{"a26546a1":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport warnings\nwarnings.filterwarnings(\"ignore\")\n\nfrom IPython.core.display import display, HTML\ndisplay(HTML(\"<style>.container { width:100% !important; }<\/style>\"))","508e3bb0":"df = pd.read_csv('..\/input\/netflix-shows\/netflix_titles.csv')","aafe147f":"df_movies = df[df['type']=='Movie']\n","be3064cf":"df_movies['date_added'] = pd.to_datetime(df['date_added'])\n","08017b4f":"df_movies['month_added'] = df_movies['date_added'].dt.month_name()\n","614e02c9":"df_movies['year_added'] = df_movies['date_added'].dt.year\ndf_movies['day_added'] = df_movies['date_added'].dt.day_name()","682ef350":"df_movies.head()","aabccfd6":"df_movies[df_movies.isna().any(axis=1)]","ec4da791":"df_movies['director']=df_movies['director'].fillna('unknown')\ndf_movies['cast']=df_movies['cast'].fillna('unknown')\ndf_movies['country']=df_movies['country'].fillna('unknown')\ndf_movies['rating']=df_movies['rating'].fillna('unknown')\ndf_movies[df_movies.isna().any(axis=1)]","58aa3617":"df_movies['duration'] = df_movies['duration'].apply(lambda x: x.split()[0])\n\ndf_movies['duration'] = pd.to_numeric(df_movies['duration'])\ndf_movies['release_year'] = pd.to_numeric(df_movies['release_year'])\ndf_movies.head()","97b3988b":"print(df_movies['duration'].max())\ndf_movies[df_movies['duration']==312].style.background_gradient(cmap='plasma')","1d4f57af":"df_movies['duration'].nlargest(3)","3a2345c6":"df_movies[df_movies['duration'].isin([312,253,237])].style.background_gradient(cmap='plasma') ","707a56e0":"df_movies['duration'].mean()","58778843":"df_movies['month_added'].value_counts()","b6fbdd82":"net_date = df_movies[['date_added']].dropna()\nnet_date['year'] = net_date.date_added.dt.year\nnet_date['month'] = net_date.date_added.dt.month_name()\nnet_date.head()","a1547383":"month_order = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'][::-1]\ndf_months = net_date.groupby('year')['month'].value_counts().unstack().fillna(0)[month_order].T\ndf_months.head()","c330b8f6":"plt.figure(figsize=(8,5),dpi=150)\nplt.pcolor(df_months, cmap='afmhot_r', edgecolors='white', linewidths=2)\nplt.xticks(np.arange(0.5,len(df_months.columns),1), df_months.columns, fontsize=7, fontfamily='serif')\nplt.yticks(np.arange(0.5, len(df_months.index), 1), df_months.index, fontsize=7, fontfamily='serif')\n\nplt.title('Netflix content Update by Months', fontsize=12, fontfamily='serif', fontweight='bold', position=(0.20, 1.0+0.02))\ncbar=plt.colorbar()\ncbar.ax.tick_params(labelsize=8)\ncbar.ax.minorticks_on()\n\n\nplt.show()","a9cb6e2c":"import matplotlib.patheffects as path_effects\nyear_data = df_movies['year_added'].value_counts().sort_index().loc[:2020]\nyear_data.head()","5c79b81a":"fig, ax = plt.subplots(1,1, figsize=(10, 5))\n# total\n# year_data.index() is x and y is the values of each year\nax.plot(year_data.index, year_data, color='red', linewidth=5, label='Total', \n        path_effects=[path_effects.SimpleLineShadow(), path_effects.Normal()])\nax.set_facecolor(('#1A0D0D'))\nax.set_title('Content Growth (movies)', position=(0.23, 1.0+0.03), fontsize=15,fontweight='bold')\nax.yaxis.set_tick_params(labelsize=10)\nax.xaxis.set_tick_params(labelsize=10)\nplt.show()","c5f609c4":"df_movies[df_movies['director']=='Ra\u00fal Campos, Jan Suter']","807370fb":"directors = df_movies['director'].value_counts()[:20]\ndirectors.drop('unknown')","964325d0":"df_movies[df_movies['director']=='Marcus Raboy']","68d33536":"df_movies[df_movies['director']=='Martin Scorsese']","a3971949":"import sys\n!{sys.executable} -m pip install countrygroups","fb223506":"\neurope = ['Austria',\n 'Belgium',\n 'Bulgaria',\n 'Croatia',\n 'Cyprus',\n 'Czechia',\n 'Denmark',\n 'Estonia',\n 'Finland',\n 'France',\n 'Germany',\n 'Greece',\n 'Hungary',\n 'Ireland',\n 'Italy',\n 'Latvia',\n 'Lithuania',\n 'Luxembourg',\n 'Malta',\n 'Netherlands',\n 'Poland',\n 'Portugal',\n 'Romania',\n 'Slovakia',\n 'Slovenia',\n 'Spain',\n 'Sweden']\neurope","bbf6a72f":"def get_europe(country):\n    europe = ['Austria',\n 'Belgium',\n 'Bulgaria',\n 'Croatia',\n 'Cyprus',\n 'Czechia',\n 'Denmark',\n 'Estonia',\n 'Finland',\n 'France',\n 'Germany',\n 'Greece',\n 'Hungary',\n 'Ireland',\n 'Italy',\n 'Latvia',\n 'Lithuania',\n 'Luxembourg',\n 'Malta',\n 'Netherlands',\n 'Poland',\n 'Portugal',\n 'Romania',\n 'Slovakia',\n 'Slovenia',\n 'Spain',\n 'Sweden']\n    if country in europe:\n        return 'europe'","e7ad2339":"df_movies['continent'] = df_movies['country'].apply(lambda x: get_europe(x))\ndf_movies.head()\n                ","0da47b03":"europe = df_movies[df_movies['continent']=='europe']","d570aff3":"europe['country'].value_counts().reset_index().style.background_gradient(cmap='plasma') ","d84e94cd":"imdb_movies = pd.read_csv('..\/input\/imdb-extensive-dataset\/IMDb movies.csv', usecols=['title','budget','genre'])\nimdb_ratings=pd.read_csv('..\/input\/imdb-extensive-dataset\/IMDb ratings.csv', usecols=['weighted_average_vote'])\nratings = pd.DataFrame({'Title':imdb_movies.title,\n                       'Rating':imdb_ratings.weighted_average_vote,\n                       'Budget':imdb_movies.budget,\n                       'Genre':imdb_movies.genre})\nratings.drop_duplicates(subset=['Title','Rating', 'Budget'], inplace=True)","c084fca4":"joint = ratings.merge(df_movies,left_on='Title', right_on='title', how='inner')\njoint = joint.sort_values(by='Rating', ascending=False)\njoint.head()","8b2d2877":"import plotly.express as px\ntop_rated=joint[0:10]\nfig = px.sunburst(\n    top_rated,\n    path=['title','country'],\n    values='Rating',\n    color='Rating')\nfig.show()","c8fccb48":"## We can vizualize this","5266d99c":"The most active month is January it seems, the least active is the next one, which is February.\n\nIf we want to publish content I think it should be around July or August not the more active neither the most inactive months, balance is always good.\n","96e82c63":"We see the longest movie is the Black Mirror one, if I remember correctly this movie has a lot of options the viewer can choose, so this number must be the with all the options, that's why it says the duration is 5.2 hours. \n\nSo which is the second longest one?\n","5396fa02":"The directors with the most movies are spanish speakears that do stand up comedy, maybe we should look for directors on other genders","a2e0fb8a":"The average length of movies is 1.65 hours, so if we want to make a movie it should be around this number","44f95e20":"The second largest movie is from Egypt, and it last for 4 hours, now lets see the mean value of the duration. ","19843e09":"## How activity grew","c0666794":"### Convert values to numeric","3318ca1f":"The best rated movie seems to be Pulp Fiction which is a really great Movie, the suprising thing is there is a lot of indian good movies it really shows the growth of bolliwood","6a6f5542":"Overall the most active month is January.\n\nThis probably because of contracts that starts at the beginning of the year or maybe the figure out that people have more hunger for content in January. \n","3e00d80f":"Seems like stand-up comedy is a constant, after that comes Martin Scorsese, who is a great director","0f16de30":"### Average movies duration","422d03de":"## Most active month","9f02b822":"Spain has the most movies on netflix from europe","26869690":"### Which movie was the longest","7729377d":"We can see that movies added peaked in 2019, that's weird, because I would have thought that 2020 would have had more content due to the demand for content the pandemic created. \n\n#### But why content grew so Exponentially?\n\nNetflix's popularity skyrocketed since around 2013, each day more users were subscribing, so they had more money to acquire the rights of movies or create their own movies. \n\nPeople loved Netflix because it has all the movies in one place, but then more and more streaming services started to show up, Netflix is not the same anymore. \n","40a5bdb0":"## IMDb Ratings","493babb7":"## Clean Data"}}