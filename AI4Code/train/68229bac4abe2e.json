{"cell_type":{"80abc55b":"code","1573dc0a":"code","7903b489":"code","6f9532b3":"code","aa422845":"code","f71591a7":"code","3a282e9f":"code","af38cf75":"code","979dcfed":"code","b07853b1":"code","d1ed8850":"code","f0461b9f":"code","bce410b9":"code","7f313a62":"code","430222f8":"code","d3ea3215":"code","247f13b8":"code","a9a45e7a":"code","37776402":"code","439d39a3":"code","22039117":"code","b474b2b8":"code","bec1955b":"markdown"},"source":{"80abc55b":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","1573dc0a":"import tensorflow as tf\n\nfrom tensorflow import keras\n\nimport numpy as np\n\nimport pandas as pd\n\nimport tensorflow_hub as hub\n\nfrom sklearn.model_selection import train_test_split\n","7903b489":"train = pd.read_csv(\"\/kaggle\/input\/nlp-getting-started\/train.csv\")\n\ntest = pd.read_csv(\"\/kaggle\/input\/nlp-getting-started\/test.csv\")\n\nsubmission = pd.read_csv(\"\/kaggle\/input\/nlp-getting-started\/sample_submission.csv\")\n","6f9532b3":"submission.head()\n","aa422845":"test.head()","f71591a7":"train.info()","3a282e9f":"train.head()","af38cf75":"X_train, X_test, y_train, y_test = train_test_split(train.text, train.target, test_size=0.2,random_state =42)","979dcfed":"X_test_lst = test.text.to_list()","b07853b1":"train_dataset = tf.data.Dataset.from_tensor_slices((X_train, y_train))","d1ed8850":"validation_dataset = tf.data.Dataset.from_tensor_slices((X_test, y_test))","f0461b9f":"train_examples_batch, train_labels_batch = next(iter(train_dataset.batch(10)))\ntrain_examples_batch","bce410b9":"embedding = \"https:\/\/tfhub.dev\/google\/universal-sentence-encoder-large\/5\"\nhub_layer = hub.KerasLayer(embedding, input_shape=[], \n                           dtype=tf.string, trainable=False)\nhub_layer(tf.convert_to_tensor(train_examples_batch[:3]))","7f313a62":"model = tf.keras.Sequential()\nmodel.add(hub_layer)\nmodel.add(tf.keras.layers.Dense(128, activation='relu'))\nmodel.add(tf.keras.layers.Dense(1, activation='sigmoid'))\n\nmodel.summary()","430222f8":"model.compile(optimizer='adam',\n              loss=tf.keras.losses.BinaryCrossentropy(from_logits=True),\n              metrics=['accuracy'])","d3ea3215":"history = model.fit(train_dataset.shuffle(10000).batch(512),\n                    epochs=40,\n                    validation_data=validation_dataset.batch(512),\n                    verbose=1)","247f13b8":"y_pred_list = []\nfor text in X_test_lst:\n  y_pred = model.predict(tf.expand_dims(text, 0))\n  y_pred_list.append(y_pred.tolist()[0])","a9a45e7a":"y_pred_boolean = tf.greater(y_pred_list, .7)","37776402":"final=[]\nfor data in y_pred_boolean:\n  if data == True:\n    final.append(1)\n  else:\n    final.append(0)","439d39a3":"output = pd.DataFrame({'id':test['id'],'target':final})","22039117":"output","b474b2b8":"output.to_csv(\"output.csv\",index=False)","bec1955b":"Make sure \"Internet\" is on in Kaggle Settings"}}