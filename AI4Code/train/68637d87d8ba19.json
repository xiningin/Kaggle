{"cell_type":{"784736af":"code","38a18709":"code","17caaf61":"code","911526d2":"code","f9b74a86":"code","f7138abb":"code","8ec11865":"code","cb99c6b7":"code","6bdf1d6b":"code","fe7d0285":"code","156f0517":"code","440efabe":"markdown","95249a9a":"markdown","8d52877a":"markdown","3e881bae":"markdown","f50a2173":"markdown","6b406ee4":"markdown","2683b511":"markdown","dfd5b856":"markdown","c2df6e7e":"markdown"},"source":{"784736af":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport tensorflow as tf\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom tensorflow.keras.applications import InceptionV3\nfrom tensorflow.keras.preprocessing.image import ImageDataGenerator","38a18709":"pre_trained_model = InceptionV3(include_top = False,\n                               input_shape = (150,150,3),\n                               weights='imagenet')","17caaf61":"for layers in pre_trained_model.layers:\n    layers.trainable = False","911526d2":"last_layer = pre_trained_model.get_layer('mixed8')\nlast_output = last_layer.output","f9b74a86":"x = tf.keras.layers.Flatten()(last_output)\nx = tf.keras.layers.Dense(1024,activation = 'relu')(x)\nx = tf.keras.layers.Dropout(0.2)(x)\nx = tf.keras.layers.Dense(1,activation = 'sigmoid')(x)\n\nmodel = tf.keras.Model(pre_trained_model.input , x)","f7138abb":"hiss = model.compile(optimizer = 'Adam',loss = tf.keras.losses.BinaryCrossentropy(),metrics = ['accuracy'])","8ec11865":"data_gen = ImageDataGenerator(rescale = 1.\/255 ,\n                              width_shift_range = 0.2 ,\n                              validation_split=0.1,\n                              height_shift_range = 0.2 ,\n                              shear_range = 0.2 ,\n                              horizontal_flip = True ,\n                              vertical_flip = True,\n                              zoom_range = 0.2)","cb99c6b7":"training_data = data_gen.flow_from_directory('\/kaggle\/input\/men-women-classification\/data',\n                                            target_size = (150,150),\n                                            class_mode='binary',\n                                            batch_size = 32,\n                                            subset = 'training'\n                                            )\nvalidation_data = data_gen.flow_from_directory('\/kaggle\/input\/men-women-classification\/data',\n                                              target_size = (150,150),\n                                              class_mode='binary',\n                                              batch_size = 32,\n                                              subset = 'validation')","6bdf1d6b":"history = model.fit_generator(training_data,epochs = 30 , steps_per_epoch =  93,validation_data = validation_data)","fe7d0285":"acc = history.history['accuracy']\nval_acc = history.history['val_accuracy']\nloss = history.history['loss']\nval_loss = history.history['val_loss']\nepochs = range(len(acc))\n\nplt.plot(epochs, acc, 'r', label='Training accuracy')\nplt.plot(epochs, val_acc, 'b', label='Validation accuracy')\nplt.title('Training and validation accuracy')\nplt.legend(loc=0)\nplt.figure()\n\n\nplt.show()","156f0517":"plt.plot(epochs, loss, 'r', label='Training loss')\nplt.plot(epochs, val_loss, 'b', label='Validation loss')\nplt.title('Training and validation loss')\nplt.legend(loc=0)\nplt.figure()\n\n\nplt.show()","440efabe":"# Training and Validation Data","95249a9a":"# Data Augmentation\n\nWe first rescale the image and used shear,horizontal flip , vertical flip and zoom on the images as we have very less amount of data.\nsaving 10% for the validation .","8d52877a":"# Plotting Losses","3e881bae":"Using pretrained model InceptionV3 for this task.\nSince we have a very short amount of data we have to use a model which is already trained for similar task\n1- Setting all the layers layers.trainable = False so that we don't have to train it again. \n2- Taking much more details so i choose 'mixed8' layer so after that we introduce our own layers to predict the gender.\n3- first use flatten then DNN of 1024 neuron followed by a dorpout of 20% and then we have a sigmoid actiation function for male and female.\n4- Now combine the both model pretrained upto mixed8 layer and our 4 layers.","f50a2173":"# Plotting Accuracy ","6b406ee4":"# Using Pre_trained Model InceptionV3","2683b511":"I have written this kernel in very understandable manner. No fancy tricks and demonstrate every possible tricks that you can do to improve the accuracy including Data Augmentation, Tranfer learning and used keras api in order so that even a new data scientist can read it and get most from it. We get an accuracy of 90% which is great.\nIf you found any error please report down in the comment section. Upvote the kernel and don't forget to follow me. Cheers!! kagglers.","dfd5b856":"# Training","c2df6e7e":"# Importing Libraries"}}