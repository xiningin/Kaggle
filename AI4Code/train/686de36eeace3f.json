{"cell_type":{"2bb6a0c8":"code","2bd9d105":"code","ff5c3d0c":"code","3d48a70d":"code","31001e43":"code","c8689cd4":"code","ec54851e":"code","86d129b4":"code","a934880a":"code","e78c9bb3":"code","9095e965":"code","92aede6d":"code","dd055b1d":"code","7fc0ffe6":"code","cfd346b7":"code","670a211a":"code","5f4f9843":"code","89fabee4":"code","212f366b":"code","b527cc83":"code","ac182885":"code","cc471c78":"code","01a8f019":"code","1abc5d74":"markdown","0f19422e":"markdown","c144f0df":"markdown","d7998d85":"markdown","bf7eec23":"markdown","57871656":"markdown","fe104818":"markdown","188ae5db":"markdown","19156dbb":"markdown","ada76889":"markdown","b66eba33":"markdown","4fa9703e":"markdown","625fff32":"markdown","feb28100":"markdown","00b018db":"markdown","6de18934":"markdown","015b3b50":"markdown","51033327":"markdown","526be494":"markdown","02825d5f":"markdown","b06b18e5":"markdown","6814c41c":"markdown","1612d0c6":"markdown","3f254cb1":"markdown","ba18f023":"markdown","7db4f4ce":"markdown","372a5a87":"markdown","f2a0dfe4":"markdown","9f236826":"markdown","33f3a8d7":"markdown","931118ea":"markdown","c909c1f1":"markdown","9197ae3b":"markdown","6a1eefb2":"markdown","0c191c3f":"markdown"},"source":{"2bb6a0c8":"#This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport plotly.express as px\nimport statsmodels.formula.api as smf\nimport requests\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\npd.options.mode.chained_assignment = None  # default='warn'\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n%matplotlib inline\nimport plotly.graph_objects as go\nfrom plotly.subplots import make_subplots\npalette = ['#F5DF4D', '#939597', '#0F4C81', '#FF6F61', '#5F4B8B', '#88B04B', '#92A8D1', '#F7CAC9', '#955251',\\\n           '#B163A3', '#009473']\npalette.reverse()\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current sessione current session","2bd9d105":"tesla = pd.read_csv('\/kaggle\/input\/tesla-stock-data-from-2010-to-2020\/TSLA.csv')\ntesla.head()","ff5c3d0c":"tesla.set_index('Date')\n","3d48a70d":"plt.figure(figsize=(10, 8))\ntesla['Close'].plot()\nplt.show()","31001e43":"tesla['PriceDiff'] = tesla['Close'].shift(-1) - tesla['Close']\nprint(tesla['PriceDiff'])","c8689cd4":"tesla['Return'] = tesla['PriceDiff'] \/tesla['Close']\nprint(tesla['Return'])","ec54851e":"tesla['ma50'] = tesla['Close'].rolling(50).mean()\n#plot the moving average\nplt.figure(figsize=(10, 8))\ntesla['ma50'].plot(label='MA50')\ntesla['Close'].plot(label='Close')\nplt.legend()\nplt.show()","86d129b4":"tesla['MA10'] = tesla['Close'].rolling(10).mean()\ntesla['MA50'] = tesla['Close'].rolling(50).mean()\ntesla = tesla.dropna()\ntesla.head()","a934880a":"tesla['Shares'] = [1 if tesla.loc[ei, 'MA10']>tesla.loc[ei, 'MA50'] else 0 for ei in tesla.index]","e78c9bb3":"tesla['Close1'] = tesla['Close'].shift(-1)\ntesla['Profit'] = [tesla.loc[ei, 'Close1'] - tesla.loc[ei, 'Close'] if tesla.loc[ei, 'Shares']==1 else 0 for ei in tesla.index]\ntesla['Profit'].plot()\nplt.axhline(y=0, color='red')","9095e965":"tesla['wealth'] = tesla['Profit'].cumsum()\ntesla.tail()","92aede6d":"tesla['wealth'].plot()\nplt.title('Total money you have made: {}'.format(tesla.loc[tesla.index[-2], 'wealth']))","dd055b1d":"tesla['LogReturn'] = np.log(tesla['Close']).shift(-1) - np.log(tesla['Close'])\nprint(tesla['LogReturn'])","7fc0ffe6":"from scipy.stats import norm\nmu = tesla['LogReturn'].mean()\nsigma = tesla['LogReturn'].std(ddof=1)\n\ndensity = pd.DataFrame()\ndensity['x'] = np.arange(tesla['LogReturn'].min()-0.01, tesla['LogReturn'].max()+0.01, 0.001)\ndensity['pdf'] = norm.pdf(density['x'], mu, sigma)\n\ntesla['LogReturn'].hist(bins=50, figsize=(15, 8))\nplt.plot(density['x'], density['pdf'], color='red')\nplt.show()","cfd346b7":"prob_return1 = norm.cdf(-0.10, mu, sigma)\nprint('The probability of dropping over 10% in one day ', prob_return1)","670a211a":"mu220 = 365*mu\nsigma220 = (365**0.5) * sigma\ndrop20 = None\nprint('The probability of dropping over 25% over a year: ', drop20)","5f4f9843":"VaR = norm.ppf(0.05, mu, sigma)\nprint('Single day value at risk is: ', VaR)","89fabee4":"# Quatile \n# 5% quantile\nprint('5% quantile ', norm.ppf(0.05, mu, sigma))\n# 95% quantile\nprint('95% quantile ', norm.ppf(0.95, mu, sigma))","212f366b":"tesla['logReturn'] = np.log(tesla['Close'].shift(-1)) - np.log(tesla['Close'])\nsample_size = tesla['logReturn'].shape[0]\nsample_mean = tesla['logReturn'].mean()\nsample_std = tesla['logReturn'].std(ddof=1) \/ sample_size**0.5\n# left and right quantile\nz_left = norm.ppf(0.05)\nz_right = norm.ppf(0.95)\n\n# upper and lower bound\ninterval_left = sample_mean+z_left*sample_std\ninterval_right = sample_mean+z_right*sample_std","b527cc83":"print('90% confidence interval is ', (interval_left, interval_right))","ac182885":"tesla.head","cc471c78":"Train = tesla.iloc[-2000:-1000, :]\nTest = tesla.iloc[-1000:, :]\nprint(Train.shape, Test.shape)","01a8f019":"from pandas.plotting import scatter_matrix\nsm = scatter_matrix(Train, figsize=(10, 10))","1abc5d74":" <h1 style=\"background-color:#FF9933\n;font-family:newtimeroman;font-size:200%;text-align:center;border-radius: 15px 50px;\"> \ud83d\udcc8 Importing data, simple preliminary analysis\n \ud83d\udcc8<\/h1> <a id=1><\/a>","0f19422e":"#### The above is a ten years chart of Tesla Stock with simple moving averages. The blue line is the shorter, 50-day moving average. Most traders will use the cross of the short-term moving average above the longer-term moving average to initiate a long position and identify the start of a bullish trend. As we can see there is a growing trend.","c144f0df":"#### 90% confidence interval is  (0.00024576826523648224, 0.0024087428049162068)\n","d7998d85":"![](https:\/\/media.tenor.com\/images\/99d431d9b3db1b10121cb7c90523c05a\/tenor.gif)","bf7eec23":"#### The probability of dropping over 10% in one day  0.0006816601499662236","57871656":"<h1 style=\"background-color:#FF9933\n;font-family:newtimeroman;font-size:150%;text-align:left;border-radius: 15px 50px;\"> \ud83d\udcc8 Estimate the average stock return with 90% Confidence Interval:\n    <a id=3.5><\/a>","fe104818":" <h1 style=\"background-color:#FD0E35\n;font-family:newtimeroman;font-size:225%;text-align:center;border-radius: 15px 50px;\"> \ud83d\udcc8 EDA: Tesla Stock Price Financial Analysis & Visualization \ud83d\udcc8<\/h1><a id=0><\/a>\n \n ### What is included:\n\n #  [1. Tesla Stock Price preliminary analysis](#1)\n   [1.1 Imporint stock data with statistical summary](#1.1)\n   \n   [1.2 Stock data line graph](#1.2)\n   \n   [1.3 Implementation of the Rolling Window calculation](#1.3)\n   \n   [1.4 Summary of the part one](#1.4)\n   \n #  [2. Building a trading strategy](#2)\n [2.1 Calculating the profit](#2.1)\n \n [2.2 Analyse of the income](#2.2)\n   \n [2.3 Summary of the part two](#2.3)\n \n  #  [3. Calculating the risk of price drop](#3)\n [3.1 Showing the histogram of the stock return](#3.1)\n \n [3.2 Calculating the probability that the price will drop 10% during a day](#3.2)\n   \n [3.3 Calculating the probability that the price will drop 25% over a year](#3.3)\n \n [3.4 Calculate Value at risk (VaR)](#3.4)\n \n [3.5 Estimate the average stock return with 90% Confidence Interval](#3.4)\n \n [3.6 Summary of the part three](#3.5)\n\n #  [4. Building our trading model](#4)\n [4.1 Data Munging](#4.1)\n  ","188ae5db":"#### Single day value at risk is:  -0.050719143759555683\n","19156dbb":"<h1 style=\"background-color:#FF9933\n;font-family:newtimeroman;font-size:150%;text-align:left;border-radius: 15px 50px;\"> \ud83d\udcc8 Summary of the part three:\n    <a id=3.5><\/a>","ada76889":"<h1 style=\"background-color:#FF9933\n;font-family:newtimeroman;font-size:150%;text-align:left;border-radius: 15px 50px;\"> \ud83d\udcc8 Calculating the probability of 10 percentage price drop in a day:\n    <a id=3.2><\/a>","b66eba33":" <h1 style=\"background-color:#FF9933\n;font-family:newtimeroman;font-size:200%;text-align:center;border-radius: 15px 50px;\"> \ud83d\udcc8 Building a trading strategy\n \ud83d\udcc8<\/h1> <a id=2><\/a>","4fa9703e":"<h1 style=\"background-color:#FF9933\n;font-family:newtimeroman;font-size:150%;text-align:left;border-radius: 15px 50px;\"> \ud83d\udcc8 Adding new columns:\n <\/h1> <a id=2.1><\/a>","625fff32":"<h1 style=\"background-color:#FF9933\n;font-family:newtimeroman;font-size:150%;text-align:left;border-radius: 15px 50px;\"> \ud83d\udcc8 Summary of the preliminary analisys:\n <\/h1> <a id=1.4><\/a>","feb28100":"#### First time using Moving average, a little description for beginners as me \nIn statistics, a moving average (rolling average or running average) is a calculation to analyze data points by creating a series of averages of different subsets of the full data set. It is also called a moving mean (MM). or rolling mean and is a type of finite impulse response filter. Variations include: simple, cumulative, or weighted forms (described below). Highly used for financial analyses.\n","00b018db":"#### Our simple calculation and predictions show that is nearly impossible that a price would drop during a day over 10% or during a year over 25%. The amount of calculated value at risk and what we got from the confidence interval shows us that Tesla is a super safe investment. Of course it is only a simple prediction and analyse that can not be taken serious but I hop that this example can show others the path that begginers can start from.\n\n","6de18934":" <h1 style=\"background-color:#FF9933\n;font-family:newtimeroman;font-size:200%;text-align:center;border-radius: 15px 50px;\"> \ud83d\udcc8  Building our trading model \n \ud83d\udcc8<\/h1> <a id=3><\/a>","015b3b50":"#### As we can see our strategy gave as the possibility to made good money during all of these years, if you would like to implement it for other stock prices feel free to use it and create your own simple trading strategy by copying the codes above.","51033327":"<h1 style=\"background-color:#FF9933\n;font-family:newtimeroman;font-size:150%;text-align:left;border-radius: 15px 50px;\"> \ud83d\udcc8 Creation of the new column \"Daily return\":\n <\/h1> <a id=1.1><\/a>","526be494":"<h1 style=\"background-color:#FF9933\n;font-family:newtimeroman;font-size:150%;text-align:left;border-radius: 15px 50px;\"> \ud83d\udcc8 Adding column regarding the return:\n <\/h1> ","02825d5f":"<h1 style=\"background-color:#FF9933\n;font-family:newtimeroman;font-size:150%;text-align:left;border-radius: 15px 50px;\"> \ud83d\udcc8 Importing data:\n <\/h1> <a id=1.1><\/a>","b06b18e5":"<h1 style=\"background-color:#FF9933\n;font-family:newtimeroman;font-size:150%;text-align:left;border-radius: 15px 50px;\"> \ud83d\udcc8 Calculating the probability of 25 percentage price drop over a year:\n    <a id=3.3><\/a>","6814c41c":"![](https:\/\/ei.marketwatch.com\/Multimedia\/2017\/07\/05\/Photos\/NS\/MW-FP681_teslas_20170705130102_NS.gif?uuid=866514ee-61a3-11e7-9945-9c8e992d421e)","1612d0c6":"<h1 style=\"background-color:#FF9933\n;font-family:newtimeroman;font-size:150%;text-align:left;border-radius: 15px 50px;\"> \ud83d\udcc8 Stock data line graph:\n <\/h1> <a id=1.2><\/a>","3f254cb1":"<h1 style=\"background-color:#FF9933\n;font-family:newtimeroman;font-size:150%;text-align:left;border-radius: 15px 50px;\"> \ud83d\udcc8 Creation of the new column \"Price difference\"\n <\/h1> <a id=1.1><\/a>","ba18f023":"<h1 style=\"background-color:#FF9933\n;font-family:newtimeroman;font-size:150%;text-align:left;border-radius: 15px 50px;\"> \ud83d\udcc8 Data Spliting:\n    <a id=4.1><\/a>","7db4f4ce":"#### The profit is calculated as the close price of (tomorrow - the close price of today) Otherwise the profit is 0.","372a5a87":"<h1 style=\"background-color:#FF9933\n;font-family:newtimeroman;font-size:150%;text-align:left;border-radius: 15px 50px;\"> \ud83d\udcc8 Implementation of the Rolling Window calculation:\n <\/h1> <a id=1.3><\/a>","f2a0dfe4":"<h1 style=\"background-color:#FF9933\n;font-family:newtimeroman;font-size:150%;text-align:left;border-radius: 15px 50px;\"> \ud83d\udcc8 Showing the histogram of log return of Tesla's stock:\n    <a id=3.1><\/a>","9f236826":" <h1 style=\"background-color:#FF9933\n;font-family:newtimeroman;font-size:200%;text-align:center;border-radius: 15px 50px;\"> \ud83d\udcc8 Calculating the risk of price drop\n \ud83d\udcc8<\/h1> <a id=3><\/a>","33f3a8d7":"<h1 style=\"background-color:#FF9933\n;font-family:newtimeroman;font-size:150%;text-align:left;border-radius: 15px 50px;\"> \ud83d\udcc8 Calculating the profit:\n <\/h1> <a id=2.1><\/a>","931118ea":"<h1 style=\"background-color:#FF9933\n;font-family:newtimeroman;font-size:150%;text-align:left;border-radius: 15px 50px;\"> \ud83d\udcc8 What would happen if we keep our investment:\n <\/h1> <a id=2.2><\/a>","c909c1f1":" <h1 style=\"background-color:#FD0E35\n;font-family:newtimeroman;font-size:225%;text-align:center;border-radius: 15px 50px;\"> \ud83d\udcc8 Thank you all for watching please leave feedback, It would really help me to develop new skills and learn new things \ud83d\ude03 \ud83d\udcc8<\/h1><a id=0><\/a>","9197ae3b":"<h1 style=\"background-color:#FF9933\n;font-family:newtimeroman;font-size:150%;text-align:left;border-radius: 15px 50px;\"> \ud83d\udcc8 Summary of the preliminary analisys:\n <\/h1> <a id=1.4><\/a>","6a1eefb2":"<h1 style=\"background-color:#FF9933\n;font-family:newtimeroman;font-size:150%;text-align:left;border-radius: 15px 50px;\"> \ud83d\udcc8 Summary statistics of a DataFrame:\n <\/h1> <a id=1.1><\/a>","0c191c3f":"<h1 style=\"background-color:#FF9933\n;font-family:newtimeroman;font-size:150%;text-align:left;border-radius: 15px 50px;\"> \ud83d\udcc8 Calculate Value at risk (VaR):\n    <a id=3.4><\/a>"}}