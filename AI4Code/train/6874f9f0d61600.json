{"cell_type":{"3b86c6c3":"code","57b998fd":"code","eefcff81":"code","046e7cd2":"code","c88678d7":"code","d951af77":"code","04dab556":"code","b3a9459a":"code","921a764f":"code","23dde94b":"code","c2675879":"code","7a5fd76e":"code","b0bab08a":"code","12344584":"code","51db9650":"code","e5161185":"code","a081de27":"code","f391883c":"code","19d10807":"code","c7e27f4c":"code","607ea08a":"code","5b9d2bc7":"code","50cfcbf3":"code","fe72dd7a":"code","2bcc2a5c":"code","3ae65393":"code","42900fc2":"code","2408dfbc":"code","78325eeb":"code","3306e41a":"code","47c6b3a3":"code","87927d61":"code","13c98bdd":"code","221db536":"code","6753fbca":"code","42a2a576":"code","95d59f16":"code","66aa357e":"code","85bbcd3b":"code","af8e92d6":"code","7c0ab10d":"code","3651d671":"code","fe8c603c":"code","3c331edb":"code","367ba540":"code","67735ee4":"code","54c55814":"code","fcee6ecd":"code","213c9bdc":"code","ddc548ac":"code","9674a380":"code","6083a3f8":"code","9af9f684":"code","62335c73":"code","38a2b6bb":"code","f5dc32ec":"code","a2fd9f10":"code","e6a3bca6":"code","723ec6b2":"code","537349e0":"code","01f2d56e":"code","76a9efe9":"code","908ec5ba":"code","0a46bcf4":"code","4dc83cef":"code","1d7f55ee":"code","a3190e11":"code","dbdba20f":"markdown","038382c5":"markdown","feee9637":"markdown","c673b6dc":"markdown","223b6547":"markdown"},"source":{"3b86c6c3":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load in \n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the \"..\/input\/\" directory.\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# Any results you write to the current directory are saved as output.\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nimport warnings\nwarnings.simplefilter(action='ignore')\n","57b998fd":"df=pd.read_csv('\/kaggle\/input\/brasilian-houses-to-rent\/houses_to_rent_v2.csv')\ndf.head()\n\n","eefcff81":"df.shape","046e7cd2":"df.city.unique()","c88678d7":"df=df.rename(columns={'hoa (R$)':'hoa','rent amount (R$)':'rentamount','property tax (R$)':'propertytax',\n                   'fire insurance (R$)':'fireinsurance','total (R$)':'total'})","d951af77":"df.head()","04dab556":"corr=df.corr()","b3a9459a":"plt.rcParams['figure.figsize']=(12,8)\nsns.heatmap(corr,annot=True,fmt='.2f')","921a764f":"#dropping outlier indices\ndf.drop([2397,5915,9241],inplace=True)","23dde94b":"df.floor.replace(to_replace='-',value='0',inplace=True)","c2675879":"df.floor=df.floor.astype('int64')","7a5fd76e":"df.floor.unique()","b0bab08a":"df.drop(['floor'],axis=1,inplace=True)","12344584":"sns.distplot(df.total)","51db9650":"#checking for outliers\ndf.total.sort_values(ascending=False)","e5161185":"#removing rows which have 'total' outliers\ndf.drop([255,6979,6645,6230,2859,2928,2182],inplace=True)","a081de27":"sns.distplot(df.total)","f391883c":"sns.countplot(df.rooms)","19d10807":"sns.pairplot(df)","c7e27f4c":"sns.lmplot(x='area',y='total',hue='furniture',data=df,fit_reg=False)","607ea08a":"sns.boxplot(x='furniture',y='total',data=df)","5b9d2bc7":"sns.barplot(x='furniture',y='total',data=df)","50cfcbf3":"df.furniture=df.furniture.map({'furnished':1,'not furnished':0})","fe72dd7a":"sns.boxplot(x='animal',y='total',data=df)","2bcc2a5c":"df.animal=df.animal.map({'acept':1,'not acept':0})","3ae65393":"df.city=df.city.map({'S\u00e3o Paulo':1,'Porto Alegre':2,'Rio de Janeiro':3,\n                      'Campinas':4,'Belo Horizonte':5})","42900fc2":"df.head()","2408dfbc":"X=df.loc[:,df.columns!='total']\ny=df.loc[:,'total']","78325eeb":"from sklearn.model_selection import train_test_split\nX_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.3,random_state=12)","3306e41a":"from sklearn.linear_model import LinearRegression\nreg=LinearRegression()\nreg.fit(X_train,y_train)","47c6b3a3":"#linear regression using data which includes 'hoa','propertytax,'fireinsurance\nreg.score(X_train,y_train)","87927d61":"reg_pred=reg.predict(X_test)","13c98bdd":"reg.score(X_test,y_test)","221db536":"X_train.head()","6753fbca":"#dropping the columns other than total column\nX_train.drop(['hoa','rentamount','propertytax','fireinsurance'],axis=1,inplace=True)","42a2a576":"X_test.drop(['hoa','rentamount','propertytax','fireinsurance'],axis=1,inplace=True)","95d59f16":"reg.coef_","66aa357e":"#linear regression on new data\nregg=LinearRegression()\nregg.fit(X_train,y_train)","85bbcd3b":"regg.score(X_train,y_train)","af8e92d6":"regg.coef_","7c0ab10d":"regg_pred=regg.predict(X_test)","3651d671":"from sklearn.metrics import mean_squared_error\n\n#printing the error without using data containing columns 'hoa','rentamount','propertytax','fireinsurance'\nprint('train error ',mean_squared_error(y_test,regg_pred))","fe8c603c":"#printing the error using data containing columns 'hoa','rentamount','propertytax','fireinsurance'\n\nprint('train error ',mean_squared_error(y_test,reg_pred))","3c331edb":"X_train.head()","367ba540":"from sklearn.ensemble import RandomForestRegressor\nrf=RandomForestRegressor()\nrf.fit(X_train,y_train)\n","67735ee4":"rf.score(X_train,y_train)","54c55814":"rf_pred=rf.predict(X_test)\nprint('MSE:',mean_squared_error(rf_pred,y_test))","fcee6ecd":"#GridSearchCV on random forest regressor\nfrom sklearn.model_selection import GridSearchCV,cross_val_score\nparams={'n_estimators':[10,25,50,100,200],'max_depth':np.arange(2,10),\n       'min_samples_leaf':np.arange(2,5)}\nrf_best=GridSearchCV(rf,param_grid=params,verbose=1,n_jobs=-1)\nrf_best.fit(X_train,y_train)","213c9bdc":"rf_best.best_params_,rf_best.best_score_","ddc548ac":"rf_best.score(X_train,y_train)","9674a380":"rf_best_pred=rf_best.predict(X_test)\nprint(\"MSE:\",mean_squared_error(rf_best_pred,y_test))","6083a3f8":"from sklearn.tree import DecisionTreeRegressor\ndt=DecisionTreeRegressor()\ndt.fit(X_train,y_train)","9af9f684":"dt.score(X_train,y_train)","62335c73":"dt_pred=dt.predict(X_test)\nprint('MSE:',mean_squared_error(dt_pred,y_test))","38a2b6bb":"dt.get_params()","f5dc32ec":"dt_params={'max_depth':np.arange(2,10),'min_samples_leaf':np.arange(2,8)}\ndt_best=GridSearchCV(dt,param_grid=dt_params,n_jobs=-1)\ndt_best.fit(X_train,y_train)","a2fd9f10":"dt_best.best_params_,dt_best.best_score_","e6a3bca6":"dt_best_pred=dt_best.predict(X_test)\nprint(\"MSE:\",mean_squared_error(dt_best_pred,y_test))","723ec6b2":"from sklearn.metrics import r2_score\nprint(\"MSE:\",r2_score(dt_best_pred,y_test))","537349e0":"df.head(2)","01f2d56e":"columns=['city','area','rooms','bathroom','parking spaces','animal','furniture']\nxx=df.loc[:,columns]\nyy=df.loc[:,'rentamount']","76a9efe9":"xx_train,xx_test,yy_train,yy_test=train_test_split(xx,yy,test_size=0.3,random_state=123)","908ec5ba":"lrc=LinearRegression()\nlrc.fit(xx_train,yy_train)","0a46bcf4":"lrc.score(xx_train,yy_train)","4dc83cef":"lrc_pred=lrc.predict(xx_test)","1d7f55ee":"print('r2 score:',r2_score(lrc_pred,yy_test))\nprint('MSE:',mean_squared_error(lrc_pred,yy_test))","a3190e11":"#for improving accuracy:\n#trying back elimination algorithm would increase the accuracy\n#removing outliers for all the columns\n","dbdba20f":"## Random Forest Regressor","038382c5":"### a)Linear Regression","feee9637":"## Predicting using Rentamount","c673b6dc":"## Decision Tree Regressor","223b6547":"## linear regression"}}