{"cell_type":{"16c18507":"code","13c5a154":"code","70489038":"code","c592b84d":"code","060e1ade":"code","8959ea93":"code","5327fe61":"code","f86ccfdb":"code","d89dd3f3":"code","44373069":"code","de947660":"code","2581344d":"code","f231aa21":"code","9bedde5e":"code","d2c33f92":"code","5f01e6f8":"code","378b9d16":"code","559eaae5":"code","63c9c0b0":"code","f852009a":"code","67af1e5a":"code","b16856ff":"code","8a463375":"code","ea820c03":"code","6bf33090":"code","4577951c":"code","282a55e9":"code","e0fe7f8d":"code","198ccf4f":"code","b89f96c5":"code","25430c03":"markdown","6cc91383":"markdown","bc450d43":"markdown","1d0a0f63":"markdown","e061ffda":"markdown","08e13c96":"markdown","37d67006":"markdown","332fef33":"markdown","c98e57b2":"markdown","4ffdd67b":"markdown","40884947":"markdown","ad6dcb72":"markdown","c77a3b75":"markdown","d96d435f":"markdown","102109fc":"markdown","c78f5a29":"markdown","a73e65bd":"markdown","e95bff34":"markdown","1bdf06ce":"markdown","287464e6":"markdown","2fadd999":"markdown","1060189c":"markdown","ec542255":"markdown","e171dee5":"markdown","c54660d1":"markdown","be8feb96":"markdown","57f5fa01":"markdown","6366c903":"markdown","8b7dc01d":"markdown","15efaa30":"markdown","a6323473":"markdown","ee7ba89f":"markdown","be1d9d44":"markdown","3e679593":"markdown","458abdb7":"markdown","8e072fa4":"markdown","05cab0ee":"markdown"},"source":{"16c18507":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport plotly.graph_objs as go\nfrom plotly.offline import download_plotlyjs, init_notebook_mode, plot, iplot\ninit_notebook_mode(connected=True)\ncolor = sns.color_palette()\n\n%matplotlib inline\n\npd.options.mode.chained_assignment = None  # default='warn'\n\n","13c5a154":"from subprocess import check_output\nprint(check_output([\"ls\", \"..\/input\"]).decode(\"utf8\"))","70489038":"train = pd.read_csv(\"..\/input\/train.csv\")\ntest = pd.read_csv(\"..\/input\/test.csv\")\nprint(\"Train shape : \", train.shape)\nprint(\"Test shape : \", test.shape)","c592b84d":"train.head()","060e1ade":"test.describe()","8959ea93":"test.describe()","5327fe61":"plt.figure(figsize=(20,8))\nsns.countplot(train.Target)\nplt.title(\"Value Counts of Target Variable\")","f86ccfdb":"missing_train = train.isnull().sum(axis=0).reset_index()\nmissing_train.columns = ['column_name', 'missing_count']\nmissing_train = missing_train[missing_train['missing_count']>0]\nmissing_train['d_type']='train'\n\nmissing_test = test.isnull().sum(axis=0).reset_index()\nmissing_test.columns = ['column_name', 'missing_count']\nmissing_test = missing_test[missing_test['missing_count']>0]\nmissing_test['d_type']='test'\n\nind = np.arange(missing_train.shape[0])\nwidth = 0.9\nfig, ax = plt.subplots(figsize=(12,5))\nrects = ax.barh(ind, missing_train.missing_count.values, color='y')\nax.set_yticks(ind)\nax.set_yticklabels(missing_train.column_name.values, rotation='horizontal')\nax.set_xlabel(\"Count of missing values\")\nax.set_title(\"Number of missing values in each column for train data set\")\nplt.show()\n\nind = np.arange(missing_test.shape[0])\nwidth = 0.9\nfig, ax = plt.subplots(figsize=(12,5))\nrects = ax.barh(ind, missing_test.missing_count.values, color='y')\nax.set_yticks(ind)\nax.set_yticklabels(missing_test.column_name.values, rotation='horizontal')\nax.set_xlabel(\"Count of missing values\")\nax.set_title(\"Number of missing values in each column for test data set\")\nplt.show()\n","d89dd3f3":"dtype_df = train.dtypes.reset_index()\ndtype_df.columns = [\"Count\", \"Column Type\"]\ndtype_df.groupby(\"Column Type\").aggregate('count').reset_index()","44373069":"from scipy.stats import spearmanr\nimport warnings\nwarnings.filterwarnings(\"ignore\")\n\nlabels = []\nvalues = []\nfor col in train.columns:\n    if col not in [\"Id\", \"Target\"]:\n        labels.append(col)\n        values.append(spearmanr(train[col].values, train[\"Target\"].values)[0])\ncorr_df = pd.DataFrame({'col_labels':labels, 'corr_values':values})\ncorr_df = corr_df.sort_values(by='corr_values')\n ","de947660":"cols_to_use = corr_df[(corr_df['corr_values']>0.21) | (corr_df['corr_values']<-0.21)].col_labels.tolist()\n\ntemp_df = train[cols_to_use]\ncorrmat = temp_df.corr(method='spearman')\nf, ax = plt.subplots(figsize=(20, 20))\n\n# Draw the heatmap using seaborn\nsns.heatmap(corrmat, vmax=1., square=True, cmap=\"YlGnBu\", annot=True)\nplt.title(\"Important variables correlation map\", fontsize=15)\nplt.show()","2581344d":"from sklearn.preprocessing import LabelEncoder\nfrom sklearn.model_selection import train_test_split\nfrom lightgbm import LGBMClassifier\nfrom xgboost import XGBClassifier\nfrom sklearn.metrics import mean_squared_error\nfrom tqdm import tqdm","f231aa21":"target = train['Target'].astype('int')\ntrain.drop(['Id','Target'], axis=1, inplace=True)\n","9bedde5e":"obj_columns = [f_ for f_ in train.columns if train[f_].dtype == 'object']\nfor col in tqdm(obj_columns):\n    le = LabelEncoder()\n    le.fit(train[col].astype(str))\n    train[col] = le.transform(train[col].astype(str))","d2c33f92":"lgbm = LGBMClassifier()\nxgbm = XGBClassifier()\ntrain = train.astype('float32') # For faster computation\nlgbm.fit(train, target , verbose=False)\nxgbm.fit(train, target ,verbose=False)","5f01e6f8":"LGBM_FEAT_IMP = pd.DataFrame({'Features':train.columns, \"IMP\": lgbm.feature_importances_}).sort_values(by='IMP', ascending=False)\n\nXGBM_FEAT_IMP = pd.DataFrame({'Features':train.columns, \"IMP\": xgbm.feature_importances_}\n                            ).sort_values(\n                              by='IMP', ascending=False)","378b9d16":"LGBM_FEAT_IMP.head(10).transpose()","559eaae5":"XGBM_FEAT_IMP.head(10).transpose()","63c9c0b0":"data = [go.Bar(\n            x= LGBM_FEAT_IMP.head(50).Features,\n            y= LGBM_FEAT_IMP.head(50).IMP, \n            marker=dict(color='green',))\n       ]\nlayout = go.Layout(title = \"LGBM Top 50 Feature Importances\")\nfig = go.Figure(data=data, layout=layout)\niplot(fig)","f852009a":"data = [go.Bar(\n            x= XGBM_FEAT_IMP.head(50).Features,\n            y= XGBM_FEAT_IMP.head(50).IMP, \n            marker=dict(color='blue',))\n       ]\nlayout = go.Layout(title = \"XGBM Top 50 Feature Importances\")\nfig = go.Figure(data=data, layout=layout)\niplot(fig)","67af1e5a":"plt.figure(figsize=(12,8))\nsns.countplot(x=\"rooms\", data=train)\nplt.ylabel('Count', fontsize=12)\nplt.xlabel('Number of rooms', fontsize=12)\nplt.xticks(rotation='vertical')\nplt.show()","b16856ff":"plt.figure(figsize=(12,8))\nsns.countplot(x=\"qmobilephone\", data=train)\nplt.ylabel('Count', fontsize=12)\nplt.xlabel('No of mobile phones', fontsize=12)\nplt.xticks(rotation='vertical')\nplt.show()","8a463375":"plt.figure(figsize=(12,8))\nsns.countplot(x=\"overcrowding\", data=train)\nplt.ylabel('Count', fontsize=12)\nplt.xlabel('Number persons per room', fontsize=12)\nplt.xticks(rotation='vertical')\nplt.show()","ea820c03":"plt.figure(figsize=(12,8))\nsns.countplot(x=\"meaneduc\", data=train)\nplt.ylabel('Count', fontsize=12)\nplt.xlabel('average years of education for adults (18+)', fontsize=12)\nplt.xticks(rotation='vertical')\nplt.show()","6bf33090":"plt.figure(figsize=(12,8))\nsns.countplot(x=\"edjefa\", data=train)\nplt.ylabel('Count', fontsize=12)\nplt.xlabel('Years of education of female head of household', fontsize=12)\nplt.xticks(rotation='vertical')\nplt.show()","4577951c":"plt.figure(figsize=(12,8))\nsns.countplot(x=\"r4t2\", data=train)\nplt.ylabel('Count', fontsize=12)\nplt.xlabel('Persons 12 years of age and older', fontsize=12)\nplt.xticks(rotation='vertical')\nplt.show()","282a55e9":"plt.figure(figsize=(12,8))\nsns.countplot(x=\"r4h2\", data=train)\nplt.ylabel('Count', fontsize=12)\nplt.xlabel('Males 12 years of age and older', fontsize=12)\nplt.xticks(rotation='vertical')\nplt.show()","e0fe7f8d":"plt.figure(figsize=(12,8))\nsns.countplot(x=\"SQBedjefe\", data=train)\nplt.ylabel('Count', fontsize=12)\nplt.xlabel('Square of years of education of male head of household', fontsize=12)\nplt.xticks(rotation='vertical')\nplt.show()","198ccf4f":"plt.figure(figsize=(12,8))\nsns.countplot(x=\"dependency\", data=train)\nplt.ylabel('Count', fontsize=12)\nplt.xlabel('Dependency', fontsize=12)\nplt.xticks(rotation='vertical')\nplt.show()","b89f96c5":"plt.figure(figsize=(12,8))\nsns.countplot(x=\"SQBdependency\", data=train)\nplt.ylabel('Count', fontsize=12)\nplt.xlabel('dependency squared', fontsize=12)\nplt.xticks(rotation='vertical')\nplt.show()","25430c03":"**Data Type of Columns:**\n\nNow let us also check the data type of the columns.","6cc91383":"**Top 10 features as seen by XGBoost model **","bc450d43":"** Males 12 years of age and older**  ","1d0a0f63":"This look a normal distrubition of number of rooms in house with means as 5 rooms. Most of house have 4-6 rooms","e061ffda":"** Number persons per room**\n","08e13c96":"Many things to come..Stay tuned!","37d67006":"**Target variable**","332fef33":"**Years of education of female head of household.**","c98e57b2":"This shows both train and test data set have same ratio of missing","4ffdd67b":"**Dependency**                                                                                                                                                                                                                \nHow is Dependency rate calculated?                                                                                                                                                                   \n    Dependency rate = (number of members of the household younger than 19 or older than 64)\/(number of member of household between 19 and 64)\n","40884947":"When it come to  Males of 12 years of age and older,                                                                                 \n**Observations**                                                                                                                                 \n1.  Most of family have 1-3  males \u2265 12years age\n2. There are more then 500 families with no males 12 years of age and older","ad6dcb72":"**Number of Rooms in house**","c77a3b75":"Average years of education for adults(18+) is more concentrated with in range of  5 and 12 years.","d96d435f":"**Square of years of education of male head of household** \n\n**What is Head of Household??**                                                                                  \nHead of Household is a filing status for single or unmarried taxpayers who keep up a home for a Qualifying Person. The Head of Household filing status has some important tax advantages over the Single filing status. ... Also, Heads of Household must have a higher income than Single filers before they owe income tax.\n\n\n\n","102109fc":"**Finding Feature Importance with Light GBM**","c78f5a29":"Now let us read the train and test file and check the number of rows and columns.","a73e65bd":"So majority of them are numerical variables with 5 factor variables.","e95bff34":"**Into charts**","1bdf06ce":"**Missing values:**\n\nNow let us check if there are missing values in the dataset.","287464e6":"So we have 9557 rows in train set and 23859 rows in test set. We also have 143 columns in total including the target and id col.  Test set is almost 2.5 times as that of train set.","2fadd999":"**So the top 10 variables and their description from the data dictionary are:**\n1.  overcrowding-  # persons per room\n2. meaneduc - average years of education for adults (18+)\n3. qmobilephone -  # of mobile phones\n4. SQBedjefe -  edjefe squared\n5. rooms -   number of all rooms in the house\n6. SQBdependenc -  dependency squared\n7. dependency -  Dependency rate, calculated = (number of members of the household younger than 19 or older than 64)\/(number of member of household between 19 and 64)\n8. edjefa -  years of education of female head of household, based on the interaction of escolari (years of education), head of household and gender, yes=1 and no=0\n9. r4h2 -  Males 12 years of age and older\n10. r4t2 -  persons 12 years of age and older","1060189c":"**7 Leading Facts About Costa Rica\u2019s Poverty Rate**\n\n1. Costa Rica\u2019s inequality rate has increased since 2000, a division that disproportionately affects indigenous and minority groups. Today, the country\u2019s richest 20 percent receive an income  [19 times higher](https:\/\/www.telesurtv.net\/english\/news\/Costa-Ricas-Poor-Left-Behind-Despite-Economic-Growth--20170407-0013.html)  than that of the poorest 20 percent.\n2. While, overall, Costa Rica\u2019s poverty rate has dropped from 22.4 percent to 21.7 percent from 2014 to 2015, the country\u2019s extreme poverty rate rose from 5.8 percent to 7.2 percent, [the highest recorded rate](https:\/\/thecostaricanews.com\/national-household-survey-to-measure-poverty-and-inequality\/) in the last 60 years.\n3. While 19 percent of urban households live in poverty and 5.2 percent live in extreme poverty, 30.3 percent of rural households live in poverty and 10.6 percent in extreme poverty.\n4. Poor Costa Ricans have, on average, three years less schooling than their economically stable peers.\n5. In Costa Rica, 43.5 percent of poor households are headed by women\n6. Since an inflation [crisis in the \u201980s and \u201990s](https:\/\/www.cato.org\/publications\/economic-development-bulletin\/growth-without-poverty-reduction-case-costa-rica), the Costa Rican government has managed to boost the economy through international tourism and exports. These sectors benefit qualified workers, while unskilled workers, over-represented by indigenous and minority groups, see no change or a decrease in their salaries.\n\n7. Public assistance to poor families increased by 9.3 percent per household and 6.9 percent per person from 2014 to 2015.\n\nCosta Rica\u2019s poverty rate seems to be sewed up neatly on the surface, but the growth of a country doesn\u2019t always reflect the growth of its people. The disparity of incomes and opportunities between uneducated people in rural areas versus educated people in urban areas threatens to rob Costa Rica of its good economic reputation.\n\u2013 Sophie Nunnally\n[Source](https:\/\/borgenproject.org\/about-costa-ricas-poverty-rate\/) \n\n**Objective:**\n\nThe Inter-American Development Bank is asking the Kaggle community for help with income qualification for some of the world's poorest families so as to making sure the right people are given enough aid.\n\n\nLet us first import the necessary modules.\n","ec542255":"Looks number of mobile phones are normal distrubiion with little left skewed, With 1-3 mobile phone per family","e171dee5":"This shows near to 50% of people are un-educated. With some comparity large bars at 36 and 121.","c54660d1":"Checking for files in path for compitition","be8feb96":"Look most of family have 2-5 person who are 12 years of age and older","57f5fa01":"**Squared of Dependency rate.** ","6366c903":"**Average years of education for adults (18+)**","8b7dc01d":"This show a multimodal distrubition with  distinct peaks (local maxima) at 7 , 30.","15efaa30":"Surprising!! I see 20 years of education of female head of household.","a6323473":"**Number of mobile phones used in a family**","ee7ba89f":"**Numbers of Persons 12 years of age and older**                                                                                                                                                          \nWhat is with 12 years ??                                                                                                                                                                                                                         \n- It is considered as **Minimum age of consent\n(sex with persons under this age is always illegal)** .  In most of the familes there are 1 - 2 males of 12 years of age and older.","be1d9d44":"We could see that moslty 1 to 2 persons are there per room. There are few cases where 4 - 6 persons per room.","3e679593":"**Correlation Heatmap of Top  correlated features with Target**","458abdb7":"Most of the families fall under catagory 4, who are non vulnerable households","8e072fa4":"**Top 10 features as seen by LightGBM model **","05cab0ee":"For every dependency value as **True** Squared of Dependency rate is considered as **1** and for **False** as **0**. So there is large bars at 0 ,1."}}