{"cell_type":{"c38d6af5":"code","d42acf6a":"code","dea16a4a":"code","bd2130ed":"code","97f30c03":"code","497644d5":"code","116f80d4":"code","7cb3c93e":"code","a357dcca":"code","e0c5a4ec":"code","c4ba3f30":"code","655953cf":"code","b0c8931e":"code","a55eee19":"code","e44be92b":"code","e8d4c212":"code","76b720c5":"code","2bdf21a2":"code","3d8a27a4":"code","50f90a23":"code","bafca2b8":"code","7e432db6":"code","a7fcd36a":"code","a4460091":"code","3aae1ca0":"code","213aac9f":"code","63d305ae":"code","452da3d0":"code","039dff80":"code","81ee4551":"code","d6234e19":"code","6793a4e4":"code","6a7eecda":"code","9c4a7156":"code","31e486ae":"code","20562cae":"code","5a2051a9":"code","5cb4de7e":"code","7ce0f101":"code","f57d891b":"code","3322f918":"markdown","8502df7a":"markdown","bca8253c":"markdown","5bc9657a":"markdown","1a4d1e0e":"markdown","d97c6e28":"markdown","d4632219":"markdown","598784d8":"markdown","2e75ebb5":"markdown","21a15e49":"markdown","c12de3a9":"markdown","90314d37":"markdown","7f060888":"markdown","5544db77":"markdown","71b12477":"markdown","7413b555":"markdown","ee7f5bde":"markdown","642b6918":"markdown","a38b1f2f":"markdown","91aa92fa":"markdown","cff5676e":"markdown","022c07ee":"markdown","c8a51c3b":"markdown","fd41c9f0":"markdown","8d9abcda":"markdown","508be48a":"markdown","0c271364":"markdown","ade4b61e":"markdown","504b1683":"markdown","d41c1a25":"markdown","9c0a0b3b":"markdown","76b0f611":"markdown","217f87a4":"markdown","32c787cb":"markdown","5ae12677":"markdown","220300ff":"markdown","16181a93":"markdown","5e9d2c9f":"markdown","b54daa27":"markdown","3dc5f202":"markdown","aa740d65":"markdown","2a990377":"markdown","a686017c":"markdown","c018db68":"markdown","1335463e":"markdown","51b0f85d":"markdown","a33e601f":"markdown","62700ffd":"markdown","567894f3":"markdown","0ea949d1":"markdown","69380cca":"markdown","cea90ca7":"markdown","04ea6e79":"markdown","dce5549a":"markdown","bf388c92":"markdown","a092a50d":"markdown","8861825a":"markdown","d4078d9d":"markdown","bfc58ec2":"markdown","92859f97":"markdown","006e6a19":"markdown","c4d9935f":"markdown","7a6138bb":"markdown","de8df6e2":"markdown","d68cdb22":"markdown","ea0c8a28":"markdown","ea9e28de":"markdown","5d339458":"markdown","a18788f1":"markdown","2ef1c2a3":"markdown","7a445efc":"markdown","e9d904dd":"markdown","9375df04":"markdown","3bb65ec4":"markdown","e3cae6eb":"markdown","b74185ee":"markdown","50d9c1bb":"markdown","65770c1f":"markdown","74e1398b":"markdown","69e4f282":"markdown","2e0ac8b0":"markdown","77bec569":"markdown","8dd8b824":"markdown","a2509e15":"markdown","0f285ad4":"markdown","d1b9199b":"markdown","0cb787b8":"markdown","828195c0":"markdown","eedc578c":"markdown","40e0f799":"markdown","bed38113":"markdown","6d83e307":"markdown","2494e49a":"markdown","92898565":"markdown","ff09bbf7":"markdown","23f2a8a6":"markdown","ac875f39":"markdown"},"source":{"c38d6af5":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport warnings\nwarnings.filterwarnings(\"ignore\")","d42acf6a":"events = pd.read_csv(\"..\/input\/comprehensive-football-dataset\/events.csv\")\nevents.info()","dea16a4a":"events.head(10)","bd2130ed":"events.describe()","97f30c03":"ginf = pd.read_csv(\"..\/input\/comprehensive-football-dataset\/ginf.csv\")\nginf.info()","497644d5":"ginf.head(10)","116f80d4":"ginf.describe()","7cb3c93e":"events_data = ginf.merge(events, how=\"left\")\nevents_data.head(10)","a357dcca":"new = dict()\nwith open(\"..\/input\/comprehensive-football-dataset\/dictionary.txt\") as f:\n    data = f.read()\ndata = data.split(\"\\n\\n\\n\")\nfor i in range(len(data)):\n    if data[i]:\n        variable = data[i].split(\"\\n\")[0]\n        values = data[i].split(\"\\n\")[1:]\n        new[variable] = {int(val.split(\"\\t\")[0]):val.split(\"\\t\")[1] for val in values}\n        \nfor name in new:\n    events_data[name] = events_data[name].map(new[name])\n\nevents_data.head(10)","e0c5a4ec":"lionel_messi_events = events_data.loc[events_data[\"player\"]==\"lionel messi\"]\nlionel_messi_events.head(10)","c4ba3f30":"# Filtering goals scored by Lionel Messi\nlionel_messi_goals = lionel_messi_events.loc[events_data[\"is_goal\"]==1 & (events_data[\"event_type2\"]!=\"Own goal\")]\n\n# Average goals-per-game (GPG) by season and overall\nlionel_messi_matches = lionel_messi_events.groupby([\"id_odsp\", \"season\"])[\"is_goal\"].sum().reset_index()\navg_GPG = pd.DataFrame({\"avg_GPG\" : (lionel_messi_goals.groupby(\"season\").count().is_goal) \/ (lionel_messi_matches.groupby(\"season\").count().id_odsp)}).reset_index()","655953cf":"# Plot average goals per game by season\nplt.plot(avg_GPG[\"season\"], avg_GPG[\"avg_GPG\"])\nplt.title(\"Average Goals per Game per Season\")\nplt.xlabel(\"Season\")\nplt.ylabel(\"Average GPG\")\nplt.yticks(np.arange(0, 3, step=0.2))\nplt.show()","b0c8931e":"print(\"\\nNumber of matches played: \", lionel_messi_matches.count().id_odsp)\nprint(\"Number of goals scored: \", lionel_messi_goals.count().id_odsp)\nprint(\"Overall Average GPG: \", round(avg_GPG.mean().avg_GPG, 2))","a55eee19":"# Filtering attempts made by Lionel Messi\nlionel_messi_attempts = lionel_messi_events.loc[lionel_messi_events[\"event_type\"]==\"Attempt\"]\nprint(\"\\nNumber of attempts made: \", lionel_messi_attempts.count().id_odsp)\nprint(\"Number of attempts per match: \", round((lionel_messi_attempts.count().id_odsp) \/ (lionel_messi_matches.count().id_odsp), 4))\n\n# Attempts per goal\nprint(\"Attempts per goal: \", round((lionel_messi_attempts.count().id_odsp) \/ (lionel_messi_goals.count().id_odsp), 4))","e44be92b":"# Filtering penalties\nlionel_messi_penalties = lionel_messi_events.loc[lionel_messi_events[\"location\"]==\"Penalty spot\"]\n\n# Penalty efficiency\npenalty_goals = lionel_messi_penalties.loc[lionel_messi_penalties[\"is_goal\"]==1]\nprint(\"\\nNumber of penalties: \", lionel_messi_penalties.count().id_odsp)\nprint(\"Number of goals from penalties: \", penalty_goals.count().id_odsp)\nprint(\"Penalty efficiency: \", round((penalty_goals.count().id_odsp) \/ (lionel_messi_penalties.count().id_odsp), 4))","e8d4c212":"# Filtering free kicks\nlionel_messi_free_kicks = lionel_messi_events.loc[lionel_messi_events[\"situation\"]==\"Free kick\"]\n\n# Free kick efficiency\nfree_kick_goals = lionel_messi_free_kicks.loc[lionel_messi_free_kicks[\"is_goal\"]==1]\nprint(\"\\nNumber of free kicks: \", lionel_messi_free_kicks.count().id_odsp)\nprint(\"Number of goals from free kicks: \", free_kick_goals.count().id_odsp)\nprint(\"Free kick efficiency: \", round((free_kick_goals.count().id_odsp) \/ (lionel_messi_free_kicks.count().id_odsp), 4))","76b720c5":"# Goals from assists\ngoals_from_assists = lionel_messi_goals.loc[lionel_messi_goals[\"assist_method\"]!=\"None\"]\nprint(\"\\nPercentage of assisted goals: \", round(100*((goals_from_assists.count().id_odsp)\/(lionel_messi_goals.count().id_odsp)), 4))\n\n# Partnerships\nprint(\"\\nPartnerships:\")\n\n# Top assisters\nassisters = lionel_messi_goals.groupby(\"player2\").count().id_odsp.sort_values(ascending=False).head(10).reset_index()\nplt.barh(assisters[\"player2\"], assisters[\"id_odsp\"])\nplt.title(\"Top assisters\")\nplt.xlabel(\"Player Name\")\nplt.ylabel(\"Number of Goals Scored\")\nplt.show()","2bdf21a2":"# Top assists\nlionel_messi_assists = events_data.loc[(events_data[\"assist_method\"]!=\"None\") & (events_data[\"is_goal\"]==1) & (events_data[\"player2\"]==\"lionel messi\")]\nassists = lionel_messi_assists.groupby(\"player\").count().id_odsp.sort_values(ascending=False).head(10).reset_index()\nplt.barh(assists[\"player\"], assists[\"id_odsp\"])\nplt.title(\"Top assists\")\nplt.xlabel(\"Player Name\")\nplt.ylabel(\"Number of Goals Scored\")\nplt.show()","3d8a27a4":"from sklearn.linear_model import LogisticRegression\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import accuracy_score, confusion_matrix, classification_report, roc_auc_score, plot_roc_curve","50f90a23":"shots = events.loc[events[\"event_type\"]==1]\nshot_predictions = shots.iloc[:, [14, 16, 17, 18, 19, 20, 21]]\nshot_predictions = pd.get_dummies(shot_predictions, columns=['location', 'bodypart','assist_method', 'situation', 'shot_place'])\nshot_predictions.columns = ['is_goal', 'fast_break', 'loc_centre_box', 'loc_diff_angle_lr', 'diff_angle_left', 'diff_angle_right', 'left_side_box', 'left_side_6ybox', 'right_side_box', 'right_side_6ybox', 'close_range', 'penalty', 'outside_box', 'long_range', 'more_35y', 'more_40y', 'not_recorded', 'right_foot', 'left_foot', 'header', 'no_assist', 'assist_pass', 'assist_cross', 'assist_header', 'assist_through_ball', 'open_play', 'set_piece', 'corner', 'free_kick', 'bit_too_high', 'blocked', 'bottom_left', 'bottom_right', 'centre', 'high_wide', 'bar', 'miss_left', 'miss_right', 'too_high', 'top_centre', 'top_left', 'top_right']\n\n# Target and data columns\nX = shot_predictions.iloc[:, 1:]\nY = shot_predictions.iloc[:, 0]\n\n# Split dataset into training and testing dataset\nX_train, X_test, Y_train, Y_test = train_test_split(X, Y, test_size=0.20, random_state=1)","bafca2b8":"# Training and predictong using logistic regression model\nxgmodel = LogisticRegression()\nxgmodel.fit(X_train, Y_train)\nY_pred = xgmodel.predict(X_test)\nY_pred_prob = xgmodel.predict_proba(X_test)","7e432db6":"# Accuracy\naccuracy = accuracy_score(Y_test, Y_pred)\nprint(\"\\nAccuracy: \", round(100*accuracy, 2))\n\n# ROC-AUC score\nroc_auc = roc_auc_score(Y_test, Y_pred_prob[:, 1])\nprint(\"\\nROC-AUC Score: \", round(roc_auc, 4))\n\n# Plot ROC-AUC curve\nplot_roc_curve(xgmodel, X_test, Y_test)","a7fcd36a":"# Confusion matrix\nCM = confusion_matrix(Y_test, Y_pred)\nprint(\"\\nConfusion Matrix: \\n\", CM)","a4460091":"# Classification report\nreport = classification_report(Y_test, Y_pred)\nprint(\"\\nClassification Report: \\n\", report)","3aae1ca0":"xgoals = xgmodel.predict_proba(X)\ngoals = X.copy()\ngoals[\"actual\"] = Y\ngoals[\"expected\"] = xgoals[:, 1]\ngoals[\"difference\"] = goals[\"expected\"] - goals[\"actual\"]\ngoals = goals.iloc[:, 40:44]\ngoals = pd.concat([events, goals], axis=1)","213aac9f":"lionel_messi_goals = goals.loc[goals[\"player\"]==\"lionel messi\"]\nlionel_messi_xgoals = lionel_messi_goals.sum().expected\nlionel_messi_actual = lionel_messi_goals.sum().actual\ndiff = lionel_messi_actual - lionel_messi_xgoals\nprint(\"\\nExpected: \", round(lionel_messi_xgoals, 4))\nprint(\"Actual: \", lionel_messi_actual)\nprint(\"Difference: \", round(diff, 4))","63d305ae":"bundesliga_points = pd.read_csv(\"..\/input\/comprehensive-football-dataset\/bundesliga_points.csv\")\nlaliga_points = pd.read_csv(\"..\/input\/comprehensive-football-dataset\/laliga_points.csv\")\nligue1_points = pd.read_csv(\"..\/input\/comprehensive-football-dataset\/ligue1_points.csv\")\npremierleague_points = pd.read_csv(\"..\/input\/comprehensive-football-dataset\/premierleague_points.csv\")\nseriea_points = pd.read_csv(\"..\/input\/comprehensive-football-dataset\/seriea_points.csv\")","452da3d0":"# Function to calculate average points difference between consecutive teams\ndef average_point_difference(points):\n    points = points.values.tolist()\n    diff = []\n    for i in range(len(points)-1):\n        diff.append(np.array(points[i])-np.array(points[i+1]))\n    diff = np.matrix(diff)\n    avg_pd = np.sum(diff)\/np.prod(diff.shape)\n    return round(avg_pd, 4)","039dff80":"print(\"\\nAverge point difference (2004-2018)\")\n\n# Bundesliga\nprint(\"\\nBundesliga: \", average_point_difference(bundesliga_points))\n# La liga\nprint(\"\\nLa Liga: \", average_point_difference(laliga_points))\n# Ligue 1\nprint(\"\\nLigue 1: \", average_point_difference(ligue1_points))\n# Premier League\nprint(\"\\nPremier League: \", average_point_difference(premierleague_points))\n# Serie A\nprint(\"\\nSerie A: \", average_point_difference(seriea_points))","81ee4551":"# Creating a new column for goals scored per match\nevents_data[\"goals_scored\"] = events_data[\"fthg\"] + events_data[\"ftag\"]\n\n# Filtering events data for 5 major European leagues\nbundesliga = events_data.loc[events_data[\"country\"]==\"germany\"]\nlaliga = events_data.loc[events_data[\"country\"]==\"spain\"]\nligue1 = events_data.loc[events_data[\"country\"]==\"france\"]\npremierleague = events_data.loc[events_data[\"country\"]==\"england\"]\nseriea = events_data.loc[events_data[\"country\"]==\"italy\"]","d6234e19":"# Grouping data match-wise for each league\nbundesliga_matches = bundesliga.groupby([\"id_odsp\", \"season\"])[\"is_goal\"].sum().reset_index()   \nlaliga_matches = laliga.groupby([\"id_odsp\", \"season\"])[\"is_goal\"].sum().reset_index()\nligue1_matches = ligue1.groupby([\"id_odsp\", \"season\"])[\"is_goal\"].sum().reset_index()\npremierleague_matches = premierleague.groupby([\"id_odsp\", \"season\"])[\"is_goal\"].sum().reset_index()\nseriea_matches = seriea.groupby([\"id_odsp\", \"season\"])[\"is_goal\"].sum().reset_index()","6793a4e4":"# Filtering goals for each league\nbundesliga_goals = bundesliga.loc[bundesliga[\"is_goal\"]==1]\nlaliga_goals = laliga.loc[laliga[\"is_goal\"]==1]\nligue1_goals = ligue1.loc[ligue1[\"is_goal\"]==1]\npremierleague_goals = premierleague.loc[premierleague[\"is_goal\"]==1]\nseriea_goals = seriea.loc[seriea[\"is_goal\"]==1]","6a7eecda":"# GPG for each major European league\nprint(\"Average goals-per-game for Europe's 5 major leagues\")\n\n# Bundesliga\nprint(\"Bundesliga: \", round(bundesliga.goals_scored.mean(), 4))\n# La Liga\nprint(\"La Liga: \", round(laliga.goals_scored.mean(), 4))\n# Ligue 1\nprint(\"Ligue 1: \", round(ligue1.goals_scored.mean(), 4))\n# Premier League\nprint(\"Premier League: \", round(premierleague.goals_scored.mean(), 4))\n# Serie A\nprint(\"Serie A: \", round(seriea.goals_scored.mean(), 4))","9c4a7156":"# Penalties for each league\nprint(\"\\nAverage number of penalties per match\")\n\n# Bundesliga\nprint(\"Bundesliga: \", round(bundesliga.loc[bundesliga[\"location\"]==\"Penalty spot\"].id_odsp.count() \/ bundesliga_matches.id_odsp.count(), 4))\n# La Liga\nprint(\"La Liga: \", round(laliga.loc[laliga[\"location\"]==\"Penalty spot\"].id_odsp.count() \/ laliga_matches.id_odsp.count(), 4))\n# Ligue 1\nprint(\"Ligue 1: \", round(ligue1.loc[ligue1[\"location\"]==\"Penalty spot\"].id_odsp.count() \/ ligue1_matches.id_odsp.count(), 4))\n# Premier League\nprint(\"Premier League: \", round(premierleague.loc[premierleague[\"location\"]==\"Penalty spot\"].id_odsp.count() \/ premierleague_matches.id_odsp.count(), 4))\n# Serie A\nprint(\"Serie A: \", round(seriea.loc[seriea[\"location\"]==\"Penalty spot\"].id_odsp.count() \/ seriea_matches.id_odsp.count(), 4))","31e486ae":"# Free kicks for each league\nprint(\"\\nAverage number of free kicks per match\")\n\n# Bundesliga\nprint(\"Bundesliga: \", round(bundesliga.loc[bundesliga[\"situation\"]==\"Free kick\"].id_odsp.count() \/ bundesliga_matches.id_odsp.count(), 4))\n# La Liga\nprint(\"La Liga: \", round(laliga.loc[laliga[\"situation\"]==\"Free kick\"].id_odsp.count() \/ laliga_matches.id_odsp.count(), 4))\n# Ligue 1\nprint(\"Ligue 1: \", round(ligue1.loc[ligue1[\"situation\"]==\"Free kick\"].id_odsp.count() \/ ligue1_matches.id_odsp.count(), 4))\n# Premier League\nprint(\"Premier League: \", round(premierleague.loc[premierleague[\"situation\"]==\"Free kick\"].id_odsp.count() \/ premierleague_matches.id_odsp.count(), 4))\n# Serie A\nprint(\"Serie A: \", round(seriea.loc[seriea[\"situation\"]==\"Free kick\"].id_odsp.count() \/ seriea_matches.id_odsp.count(), 4))","20562cae":"bundesliga_assisters = bundesliga_goals.groupby(\"player2\").count().id_odsp.sort_values(ascending=False).head(10).reset_index()\nplt.barh(bundesliga_assisters[\"player2\"], bundesliga_assisters[\"id_odsp\"])\nplt.title(\"Top assisters\")\nplt.xlabel(\"Player Name\")\nplt.ylabel(\"Number of Goals Scored\")\nplt.show()","5a2051a9":"laliga_assisters = laliga_goals.groupby(\"player2\").count().id_odsp.sort_values(ascending=False).head(10).reset_index()\nplt.barh(laliga_assisters[\"player2\"], laliga_assisters[\"id_odsp\"])\nplt.title(\"Top assisters\")\nplt.xlabel(\"Player Name\")\nplt.ylabel(\"Number of Goals Scored\")\nplt.show()","5cb4de7e":"ligue1_assisters = ligue1_goals.groupby(\"player2\").count().id_odsp.sort_values(ascending=False).head(10).reset_index()\nplt.barh(ligue1_assisters[\"player2\"], ligue1_assisters[\"id_odsp\"])\nplt.title(\"Top assisters\")\nplt.xlabel(\"Player Name\")\nplt.ylabel(\"Number of Goals Scored\")\nplt.show()","7ce0f101":"premierleague_assisters = premierleague_goals.groupby(\"player2\").count().id_odsp.sort_values(ascending=False).head(10).reset_index()\nplt.barh(premierleague_assisters[\"player2\"], premierleague_assisters[\"id_odsp\"])\nplt.title(\"Top assisters\")\nplt.xlabel(\"Player Name\")\nplt.ylabel(\"Number of Goals Scored\")\nplt.show()","f57d891b":"seriea_assisters = seriea_goals.groupby(\"player2\").count().id_odsp.sort_values(ascending=False).head(10).reset_index()\nplt.barh(seriea_assisters[\"player2\"], seriea_assisters[\"id_odsp\"])\nplt.title(\"Top assisters\")\nplt.xlabel(\"Player Name\")\nplt.ylabel(\"Number of Goals Scored\")\nplt.show()","3322f918":"![Manchester City](attachment:manchester-city.png)","8502df7a":"## Dataset preparation","bca8253c":"According to the results from the above analysis, it can be said that **Ligue 1 (France)** is the most competitive league in Europe with an average difference of **3.02 points** between 2 consecutive teams. But we know how PSG and AS Monaco dominate Ligue 1, running way ahead of other teams in the league in terms of points. However, the result maybe due to the lower placed teams having very less difference in points.\n\nThe least competitive leagues are **Premier League (England)** and **Serie A (Italy)** with an average point difference of **3.41** points between teams. A high points difference in Premier League teams may be attributed to the fact that teams are distributed quite uniformly in terms of points, making PL the most exciting league among the 5. Serie A mimcks Ligue 1 with Juventus, Inter Milan and AC Milan dominating the league.","5bc9657a":"## Next Club","1a4d1e0e":"## Loading and pre-processing datasets","d97c6e28":"### Join events dataset with ginf dataset","d4632219":"### 1. Average Goals per Game (GPG)","598784d8":"## Importing required libraries","2e75ebb5":"The average Goals per Game (GPG) for **La Liga** is **2.77** and on average, **2.73** goals are scored in a **Premier League** match. This m,eans that La Liga and Premier League are very much similar in terms of goals scored per match. Hence, it can be said that Leo would get a similar goal scoring environment in England as he gets in Spain.\n\n**Bundesliga** is the highest scoring league with **2.87** goals per game meaning that Leo could also enjoy scoring more goals in Germany.","21a15e49":"### 1. Manchester City","c12de3a9":"#### 2. La Liga","90314d37":"![Europe's Top 5 Leagues](attachment:europe-top-five-leagues.jpg)","7f060888":"### Match-wise data","5544db77":"### Top Assisters","71b12477":"### 4. Juventus","7413b555":"As we can see, Lionel Messi has scored **~35 more goals** than expected. An average footballer given the same opportunities and situations as Lionel Messi would have scored 170 goals on average. On the other hand, Leo actually scored 205. This indicates how Lionel Messi is an extraordinary goal scorer.","ee7f5bde":"### Average Penalties per Match","642b6918":"We've seen how Guardiola's Barcelona dominated La Liga with Messi consistently being their star. In a similar fashion, Manchester City has dominated the Prem for the last few seasons, finishing the 2017-18 season with a record-breaking 100 points. Guardiola and Messi coming together once again at City would be really exciting.\n\nWith top-notch assisters such as Kevin De Bruyne and Bernardo Silva as well as fellow Argentine Sergio Aguero, Manchester City appears to be the best club for Messi to sign for next. Playing at City in the Premier League guarantees Leo a UCL spot and makes City even stronger contenders for the Premeir League title.\n\nWe saw above, the average Goals per Game for the Premier League is 2.73, which makes it a high-scoring league. Leo playing at City means that we could see a lot more goals from La Pulga. However, Leo may not get to take as many penalties and free kicks as he does in La Liga (avg penalties per game: 0.15; avg free-kicks per game: 0.29).","a38b1f2f":"PSG, owned by Qatar Sports Investments, are one of the richest clubs in the world, meaning that they are one of the few teams that have the financial power required to purchase Lionel Messi.\n\nPlaying at PSG could put Lionel Messi at the center of a deadly front three - Kylian Mbappe, Lionel Messi and former Barcelona teammate Neymar. Fellow Argentine Angel Di Maria also plays at PSG, which means Leo could fit in well at PSG.\n\nAverage number of penalties and free-kicks per match are also nearly similar for La Liga and Ligue 1, meaning Leo would get a similar number of chances to score from spot kicks.\n\nHowever, PSG may not be the first choice for next club, being beaten by Manchester City. Ligue 1 is not as competitive as Premier League, often called \"Farmers' League\". Still at the top of his game, Manchester City would be a better move for Leo to continue his career and compete at the topmost level.","91aa92fa":"Lionel Messi has maintained an average GPG value of **1.13**, meaning that on average Leo scored atleast 1 goal in each match that he played. That is a fairly impressive stat for a striker in terms of goal-scoring ability.\n\nBut how does Leo manage to score, on average, 1 goal in each game that he plays. To better understand this, let's have alook at his attempt statistics, which includes the number of attempts at goal made by Leo per match.","cff5676e":"# Machine Learning Model for Expected Goals (xGoals)","022c07ee":"Hence, **65.36% of goals scored** by Lionel Messi were assisted by his teammates, meaning that Leo combines well with his teammates to create as many chances as possible and score as many goals as possible.\n\nThis was seen clearly when FC Barcelona dominated world football having Leo, Iniesta and Xavi on their team, with the three combining together to craft deadly plays and give the opponents nightmares. After the departure of Xavi and Iniesta from FC Barcelona, we saw something similar during the MSN era, with the front 3 of Messi, Suarez and Neymar combining in front of goal in a deadly fashion.","c8a51c3b":"Let's now compute the summary statistics for the events dataset.","fd41c9f0":"The column *event_type* records the type of event for each events detailed in the dataset, such as *attempt*, *corner* and *foul*. I have filtered the DataFrame *events_data* into the DataFrame *shots* to include only records about attempts made at goal. The *shots* DataFrame will be used to train the Logistic Regression model.\n\nThe columns *location*, *bodypart*, *assist_method*, *situation* and *shot_place* contain categorical values to describe the attempt in a detailed manner. These columns have been converted to dummies using the *get_dummies()* function to encode the categorical values into numerical values before training the Logistic Regression model.\n\nThe *is_goal* column is the target column (Y) and all other columns are used as data columns (X).","8d9abcda":"Next, I have calculated the average Goals per Game for each league, in the same way as done before, in order to see which league is most similar to La Liga in terms of goal scoring.","508be48a":"However, when it comes to free-kicks, Leo's record isn't very impressive, having converted only 14 of the 86 free-kicks that he has attempted (efficiency of **16.2%**).","0c271364":"### Pre-processing dataset by giving names for events","ade4b61e":"In this section I have provided my verdict on which club should Lionel Messi sign for next in case he chooses to leave FC Barcelona.\n\nI have taken into consideration the following clubs as possible next destinations for Leo:\n   1. Manchester City (Premier League)\n   2. Paris Saint-Germain (Ligue 1)\n   3. Bayern Munich (Bundesliga)\n   4. Juventus (Serie A)\n   5. Atletico Madrid (La Liga)","504b1683":"## League Points Datasets","d41c1a25":"## Analysing Europe's Top 5 Leagues","9c0a0b3b":"Football, being a team sport invloves players assisting their teammates as well as being assisted by teammates to win games.\n\nTherefore, let's see what percentage of goals scored by Leo were assisted by a teammate and who are his best partners in scoring goals.","76b0f611":"![Juventus](attachment:juventus.png)","217f87a4":"As stated earlier, the text file *dictionary.txt* contains relevant values for different columns in the events dataset. For example, a numerical value of 6.0 for the column *shot_place* denotes \"High and wide\", i.e. the attempted shot went high and wide from the target. Similarly, a numerical value of 2.0 for *shot_outcome* stands for \"Off target\" , i.e. the shot was off target.\n\nBelow, I have read the text file and replaced the numerical values for each column with the appropriate values corresponding to each numerical value.","32c787cb":"On average, the most number of penalties are given away in **Serie A**, while **Premier League** comes out as the **cleanest league** giving away the least penalties. Moving to a league with a higher value for average penalties per match may be a good choice for Lionel Messi in order to continue scoring more and more goals.","5ae12677":"Atletico Madrid, with Argentine manager Diego Simone and former FC Barcelona teammate Luis Suarez would be a good choice for Lionel Messi if he chooses to stay in Spain's La Liga. Playing in the same league will do Leo good, without the stress of moving to a new country.","220300ff":"### 4. Assists and Partnerships","16181a93":"### General information (ginf) dataset","5e9d2c9f":"In order to perform the analysis, I have computed various statistics that are crucial to describe a footballer's performance.\n\nFor a forward (and #10) the most important stats are **average goals per game**, **attempts** as well as **efficiency** from free-kicks and penalties. These can be considered as some of the **Key Performance Indicators (KPIs)** for a striker such as Lionel Messi.\n\nLet's take a look at these stats to better understand and analysis Leo's career at FC Bercelona.","b54daa27":"Next, I have taken a probabilistic approach in order to predict the expected goals for a player based on the detailed data available in the football events dataset. The main objective of this part of the project is to calculate the probability of an attempt being a goal based on the data avialable reagrding the particular attempt.\n\nIn the *events_data* DataFrame created above by joining the *events* and *ginf* datasets, the *is_goal* column indicates whether the attempt made by a player resulted in a goal. A value of 1 for the *is_goal* column denotes a goal being scored, whereas 0 signifies no goal.\n\nUsing a simple machine learning algorithm, Logistic Regression, I will be calculating to probability of an attempt being a goal. Logistic Regression uses the sigmoid function to calculate the probability value for each record of the dataset. Calculating a probability value for the column *is_goal* based on available data will give us the probability of an attempt being a goal. Finally, summing up all probability values predicted by the Logistic Regression model will give us the number of goals a player is expected to score, given the conditions in which the attempt was made.\n\nThe value of expected goals can then be compared to the value of actual goals scored by a player to evaluate the player's performance in front of goal.","3dc5f202":"### Summary statistics for ginf dataset","aa740d65":"**Average Goals per Game (GPG)** can be defined as the number of goals a player is expected to score per match that he plays. It is an important statistic to determine how good a player is when it comes to scoring goals in games and canm be calculated by dividing the total number of goals scored by the total number of matches played.\n\nBased on the data available in the football events dataset, I have plotted the average GPG for Lionel Messi over multiple seasons. The overall average GPG is also shown below.","2a990377":"The next few bar plots show the players with the highest number of assists in each league.","a686017c":"#### 3. Ligue 1","c018db68":"![Paris Saint-Germain](attachment:psg.jfif)","1335463e":"As stated above, Logistic Regression uses the sigmoid function to calculate a probability value for each record of the dataset. This will be the best choice as we want to calculate the probability of an attempt resulting in a goal in order to calculate a value for expected goals. Hence, a Logistic Regression model is used for training and prediction.","51b0f85d":"### Filtering events data for each league","a33e601f":"Next, I have joined the events and ginf datasets on the common column *id_odsp*, into the DataFrame *events_data* which containes detailed data about the football events. I will be using this DataFrame to perform all the required analysis.","62700ffd":"In the following code cell, I have filtered the DataFrame *events_data* into 5 distinct DataFrame for each of the 5 leagues based on the *country* column.","567894f3":"### Average Free kicks per Match","0ea949d1":"Other clubs such as Premier League's Liverpool and Manchester United, Serie A's Inter Milan, Japan's Vissel Kobe (where former FCB teammate Andres Iniesta currently plays) and Qatar's Al Sadd (managed by former Barca teammate Xavi) are good choices too, but a transfer to any of these teams is highly unlikely.","69380cca":"### 3. Bayern Munich","cea90ca7":"### Accuracy and Performance Metrics","04ea6e79":"Of the 37 penalties that Leo has attempted, 30 touched the back of the net, giving Leo a penalty efficiency of **81%**. \"Impressive\" would be an understatement here.","dce5549a":"# Future Prospects","bf388c92":"### 5. Atletico Madrid","a092a50d":"The *ginf* dataset consists of 18 columns such as *ht* (home team), *at* (away team), *league* and *country* to further describe each match in the events dataset.","8861825a":"Next, I have created a new DataFrame *goals* which contains the values for expected goals, actual goals as well as the difference between actual and expected goals. The value for the column *expected* in the *goals* DataFrame is predicted using the Logistic Regression model trained above.","d4078d9d":"### 2. Paris Saint-Germain","bfc58ec2":"## Computing crucial statistics","92859f97":"#### 5. Serie A","006e6a19":"As we can see, the model obtains an **accuracy of 93.85%** with and **ROC-AUC Score of 0.9648**, meaning that the model is doing its job well in predicting 0's as 0's and 1's as 1's. Therefore, this model for expected goals has fairly high accuracy and can be used for calculating the value for expected goals.","c4d9935f":"### Columns for Expected Goals and Difference","7a6138bb":"Although Leo takes an average of **4.45 attempts at goal to actually score a goal**, he manages to get a goal in each game by registering multiple attempts at goal, with an average of **5.13 attempts at goal per match**. Due to this high number of attempts at goal, Leo ends up scoring atleast 1 goal from the multiple attempts.\n\nHaving more than 5 attempts at goal on average is a great indication of the hunger Leo has for scoring goal and winning games, making him one of the greatest footballers we know.","de8df6e2":"Moving to Juventus would get CR7 and Leo in the same team for the very first time. However, Juventus may not have enough finances to purchase Leo.\n\nJoining Juventus could result in either of the following 2 things - Juventus being overpowered and dominating world football or Ronaldo and Messi clashing and not getting along well, competing to be the best in the world.","d68cdb22":"Let's now analyse each league individually to gain more understanding about the leagues.","ea0c8a28":"---","ea9e28de":"Since we are interested in analysing Lionel Messi's career, I have filtered only those events from the DataFrame *events_data* that involve Lionel Messi, exluding all other events.","5d339458":"## Building xGoals Model using Logistics Regression","a18788f1":"### Summary statistics for events dataset","2ef1c2a3":"![Atletico Madrid](attachment:atletico-madrid.png)","7a445efc":"Let's not look at how Messi performs from spot-kicks such as penalties and free-kicks.","e9d904dd":"### **EDIT (11th August, 2021): Lionel Messi has signed a two-year contract with PSG after leaving FC Barcelona.**\n\n![Leo_Messi_PSG](https:\/\/c.ndtvimg.com\/2021-08\/sppvrhs8_lionel-messi-psg-twitter_625x300_11_August_21.jpg?output-quality=60&output-format=webp&downsize=639:*)\n\nThe analysis and verdict I presented in this notebook has turned out to be quite true. It will be exciting to see how PSG perform, having signed so many quality players.","9375df04":"Teh following code cell filters the *goals* DataFrame to include only events where Lionel Messi is the main player involved. The value for expected goals to be scored by Lionel Messi is calculated by summing up the values in the column *expected*. Similarly, the value for actual goals scored by Leo is calculated by summing the values in the column *actual*. Let's take alook at the difference between these 2 values.","3bb65ec4":"### Expected vs Actual Goals for Lionel Messi","e3cae6eb":"### 2. Attempt Statistics","b74185ee":"We saw above how Leo converts 81% of the penalties he attempts. Therefore, let's now see the average penalties per match in each of the 5 leagues.","50d9c1bb":"![Bayern Munich](attachment:bayern-munich.png)","65770c1f":"### Events Dataset","74e1398b":"Ever since enrolling himself at FC Barcelona youth academy, La Masia, at age 13, Lionel Messi has been a one-club-man. Having been offered a contract on a paper napkin, it is no doubt that FC Barcelona has made Leo the GOAT we all know and admire.\n\nHowever, after 16 years at FC Barcelona, it has recently become quite clear that Leo is dissatisfied at FCB and has also expressed a desire to transfer to another club. With clashes and conflicts not only with the Spanish government but also with higher authorites and team management at the club, as well as differences in interests with teammates, it would not be a surprise if we do not see Leo in the famous red and blue of FC Barcelona next season.\n\nWith this news in mind, I deceided to carry out a data science project to analyse and take a look at La Pulga's FC Barcelona career through numbers and statistics. In this notebook, I will be analysing a number of football datasets available to get a deeper insight into Lionel Messi's footballing career at FC Barcelona.\n\nFurthermore, it would be fun to see which club would be the next best destination for Leo to continue his professional football career.","69e4f282":"We can see here that some columns such as *shot_place*, *shot_outcome* and *location* have numerical values. These numerical values indicate different possible values for the particular column. These possible values for each column are specified in the text file, *dictionary.txt*.This text file will be used later to replace the numerical values with appropriate values for the columns.","2e0ac8b0":"For the final part of this project, I have performed a basic anlysis for **Europe's top 5 football leagues** to see where Lionel Messi could be headed next in case of a departure from FC Barcelona. I have provided my own verdict on which club would be the best next destination for Leo based on how well he fits at the club.\n\nFirst, I have collected data about **league points** for each of the top 5 European leagues from **2004-2018**. Based on this points data, I have calculated the **average point difference** between 2 consecutive teams in each league. I have used these values as a measure of the **degree of competition** in each league. It can be said that the higher the average point difference, the less competitive that league is.","77bec569":"The *ginf* dataset contains general information and metadata about each game in the events dataset. I will use this dataset along with the events dataset loaded above to get more information to describe each game in the football events dataset.","8dd8b824":"### Average Goals per Game (GPG) for each league","a2509e15":"## Filtering events for Lionel Messi","0f285ad4":"The dataset provides a granular view of **9,074 games**, totaling **941,009 events** from the biggest 5 European football leagues: Bundesliga (Germany), La Liga (Spain), Ligue 1 (France), Premier League (England) and Serie A (Italy) from the **2011\/2012** season to the **2016\/2017** season.\n\nLet's read this dataset and call the *.info()* function to see detailed information about the dataset, including column names and datatypes.","d1b9199b":"I have first performed an Exploratory Data Analysis to compute various crucial statistics such as average goals per game. For this, I have used the Football Events Dataset available [here](https:\/\/www.kaggle.com\/secareanualin\/football-events).","0cb787b8":"Bayern Munich has been the top club in Germany for as long as we know. Regularly competing in the UCL and winning the Bundesliga will be guaranteed to Leo should he choose to sign for Bayern Munich. Bundesliga is also the highest scoring league among the 5, with an average of 2.87 Goals per Game. A high scoring league such as Bundesliga, as well as a high scoring team such as Bayern Munich would be a good choice for Leo.\n\nHowever, Messi may not adapt well to the German style of play, having played Barcelona's tiki-taka for all of his career. This makes Bayern rank 3rd in the best next club for Leo.","828195c0":"## Average point difference between teams in Europe's Top 5 leagues","eedc578c":"#### 4. Premier League","40e0f799":"![Lionel Messi approves!](attachment:lionel_messi.jpg)","bed38113":"#### 1. Bundesliga","6d83e307":"# Exploratory Data Analysis (EDA)","2494e49a":"The dataset consists of **22 columns** describing various elements related to a football event, such as the player involved and opponent team.","92898565":"## Importing required libraries","ff09bbf7":"## Determining league competition based on average point difference","23f2a8a6":"### 3. Free kicks and Penalties","ac875f39":"It is evident from the above 2 bar plots that Leo partners up well with **Luis Suarez**, **Neymar** and **Andres Iniesta**. This could be a great point which influences where Leo could be headed next in case he chooses to leave FC Barcelona and look for a new club.\n\nReuniting with Luis Suarez at Atletico Madrid under fellow Argentine manager Diego Simone, or with Neymar at PSG, that is the question."}}