{"cell_type":{"7cdb8b87":"code","55b02d3a":"code","5041817e":"code","2269a6da":"code","320dc7e5":"code","d8ec9992":"code","70e8a0ae":"code","1e85818c":"code","2b59808f":"code","0a143920":"code","17a14cd7":"code","85f0c6b4":"code","79e0534d":"code","a514b511":"code","1d4c2dbe":"code","d5e9cdd5":"code","8199b21d":"code","14209920":"code","b1ec1f87":"code","e819477c":"code","c4b95b8d":"code","21206074":"markdown","5ec316cd":"markdown","0298896a":"markdown","97599dd0":"markdown","4665e36d":"markdown","9fb91e4d":"markdown","17b307d0":"markdown","222fd116":"markdown","ef8c98fc":"markdown","ac177856":"markdown","662bd75c":"markdown","98eb8fe8":"markdown","a680f4b4":"markdown","4508e548":"markdown","33f94df3":"markdown","9b15eb90":"markdown","e2d04c74":"markdown","a7890aff":"markdown","5f1b064f":"markdown","bdd40fcf":"markdown"},"source":{"7cdb8b87":"import pandas as pd","55b02d3a":"recipies = pd.read_csv(\"..\/input\/epirecipes\/epi_r.csv\")\nbikes = pd.read_csv(\"..\/input\/nyc-east-river-bicycle-crossings\/nyc-east-river-bicycle-counts.csv\", index_col=0)\nweather = pd.read_csv(\"..\/input\/szeged-weather\/weatherHistory.csv\")","5041817e":"# quickly clean our dataset\nprint('#rows in original recipies dataset: {}'.format(recipies.shape[0]))\nrecipies = recipies[recipies.calories < 10000]\nprint('#rows in recipies dataset without high calories: {}'.format(recipies.shape[0]))\nrecipies.dropna(inplace=True)\nprint('#rows in recipies dataset withouh high calories and NA rows: {}'.format(recipies.shape[0]))","2269a6da":"# are the ratings all numeric?\nrecipies.rating.dtype","320dc7e5":"#we know it form float64 datatype,\n#but let check if there are really some rating with decimal part\nprint('#rows with decimal part in rating: {}'.format(\n    recipies[recipies.rating % 1 > 0].shape[0]))","d8ec9992":"import seaborn as sns","70e8a0ae":"# plot calories by whether or not it's a dessert\nsns.scatterplot(x='calories', y='dessert', data=recipies)","1e85818c":"from sklearn.linear_model import LogisticRegression\nimport numpy as np\nimport matplotlib.pyplot as plt\n\n%matplotlib inline","2b59808f":"model = LogisticRegression()\nX =recipies.calories.values.reshape(recipies.calories.count(),1)\n\nmodel.fit(X, recipies.dessert)\nproba = model.predict_proba(X)","0a143920":"plt.figure(figsize=(10,4))\nsns.scatterplot(x='calories', y='dessert', data=recipies)\nplt.plot(X, proba[:,1])","17a14cd7":"bikes.head(5)","85f0c6b4":"df = bikes[['Precipitation', 'Total']].copy()\nX = bikes.Precipitation\ny = bikes.Total\n\ndef print_bad_values(df):\n    print(df[df.Precipitation.map(lambda x : x.replace('.', '', 1).isdigit() == False)].Precipitation)\n    \nprint_bad_values(df)","79e0534d":"df.Precipitation = df.Precipitation.map(lambda x : '0.0' if x == 'T' else x)\ndf.Precipitation = df.Precipitation.map(lambda x : x.split()[0] if 'S' in x  else x)\nprint_bad_values(df)","a514b511":"df.Precipitation = df.Precipitation.map(lambda x : float(x))\nprint('min {}, max {}'.format(df.Precipitation.min(), df.Precipitation.max()))","1d4c2dbe":"df.info()","d5e9cdd5":"import sklearn\nprint('The scikit-learn version is {}.'.format(sklearn.__version__))","8199b21d":"sns.scatterplot(x=df.Precipitation, y=df.Total)","14209920":"from sklearn.linear_model import PoissonRegressor #for sklearn from version 0.23 #","b1ec1f87":"#I would actualy use plotting of model prediction as I play around with Python not R\nX = df.Precipitation.values.reshape(df.Precipitation.count(), 1)\ny = df.Total\n\nmodel = PoissonRegressor()\nmodel.fit(X, y)\ndf['Preds'] = model.predict(X)","e819477c":"df.Preds = df.Preds.map(lambda x : int(x))\ndf.head()","c4b95b8d":"plt.figure(figsize=(10, 6))\nsns.scatterplot(x='Precipitation', y='Total', data=df)# fit_reg=False)\nsns.lineplot(x='Precipitation', y='Preds', data=df)","21206074":"So I already have my question, \"Can I predict whether or not a recipe is a dessert based on how many calories it has?\". (With your dataset you'll need to come up with your question by picking one variable to predict and one to use to predict it).\n\nIn order to build a model, I need to know what type of variable whether or not a recipe is a dessert is. There are three choices:\n\n* **Continuous**. These are numeric variables that can take any value, including decimals. Examples include temperatures or prices.\n* **Count**. These are numeric variables that can only take positive integer values. Examples include the number of people at a party or the number of cars in a parking lot.\n* **Categorical**. These are not numbers. Categorical variables tell you whether or not an observation is part of a specific group. Good examples include gender or whether someone owns more than ten hats.\n\nThe best way to figure out which one is a variable is is to use your knowledge of a dataset and the world in general. For example, I know that whether or not a recipie is a dessert is a *categorical* variable, while the number of calories in a dessert is probably a *count* variable (unless you have a very, very accurate measure of calories, in which case it might be continuous).\n\nThere are some quick tests you can do to double-check, though. For example, I might want to know if the ratings for a recipie are categorical, count, or continuous. First, I can check if they're numeric:","5ec316cd":"little bit of gooolefu tells us:<br>\n    <i>In meteorology, the word \"trace\" is used to describe a very small amount of precipitation that results in no measurable accumulation<\/i><br>\nSo we replace those values with 0    ","0298896a":"6. Optional: If you want to share your analysis with friends or to ask for help, you\u2019ll need to make it public so that other people can see it.\n  * Publish your kernel by hitting the big blue \u201cpublish\u201d button. (This may take a second.)\n  * Change the visibility to \u201cpublic\u201d by clicking on the blue \u201cMake Public\u201d text (right above the \u201cFork Notebook\u201d button).\n  * Tag your notebook with 5daychallenge","97599dd0":"So I know it's represented by a numeric variable in this dataframe. This means that ratings are probably not things like \"very good\" or \"very bad\".\n\nNext, I can check if all the values are integers (whole numbers). If so, it's probably a count variable. If not, it's probably continuous.","4665e36d":"So, in this dataset, ratings are a continuous variable. It's a number that can have decimal values. \n\nHowever, I'm not interested in predicting ratings. I'm interested in predicting if something is a dessert or not based on how many calories it has. To do this, I can plot the number of calories by whether or not the recipe is for a dessert. ","9fb91e4d":"2. Identify which variables are continuous, categorical and count using the dataset documentation. (You can also check out a summary of the dataset using summary() or str())\n","17b307d0":"Since whether or not something is a dessert is a categorical variable, we want to use logistic regression to answer this question. As you can see in the chart below, the link function for logistic regression is \"binomial\".\n___\n![Regression guide](https:\/\/image.ibb.co\/ducqSw\/regression_guide.png)\n___\n\nWe can fit and plot a regression line to our data using the geom_smooth() layer. To make sure we do logistic regression, we need to make sure that we tell geom_smooth to fit a regression model from the binomial family, like so:\n    \n    geom_smooth(method = \"glm\", method.args = list(family = \"binomial\"))\n \n If we were fitting a linear regression model instead, for example, we'd ask geom_smooth() to fit a model from the gaussian family, like so:\n    \n    geom_smooth(method = \"glm\", method.args = list(family = \"gaussian\"))\n    \ngeom_smooth() relies on the x and y arguments that you pass to ggplot (in the aes() argument), so you want to make sure you put the value you're interested in predicting in the y argument slot. (Here, that's \"dessert\".)","222fd116":"finaly convert whole column to float values","ef8c98fc":"3. Pick a variable to predict and one varaible to use to predict it\n    * For this challange, if you're picking a categorical value, I'd recommend choosing one with only two possible categories (like dessert or not dessert)","ac177856":"That blue line we've plotted is actually a regression model! Looking at the regression line, we can tell that as the number of calories in a recipe increases, it's more likely that that recipe is a dessert. (We can tell this because the line moves towards 1, which means \"is a dessert\" and away from 0, which means \"isn't a dessert\"). \n\nThe grey shape behind it is the standard error. Looking at the error, we can tell that we're pretty sure about our prediction when there's fewer calories (towards the left side of the graph), but as we move to the right we get less certain and our error increases.\n\nWe'll learn more about fitting and interpreting models tomorrow, but for now it's time for you to try your own hand at picking the right type of model and fitting it.","662bd75c":"<b>continuous<\/b>: Date, Day, High Temp (\u00b0F), Low Temp (\u00b0F), Precipitation<br>\n<b>count<\/b>: Brooklyn Bridge, Manhattan Bridge, Williamsburg Bridge, Queensboro Bridge, Total<br>\n<b>category<\/b>: none of them","98eb8fe8":"Welcome to day one of the 5-Day Regression Challenge! To get started, click the blue \"fork notebook\" button in the upper right hand corner. This will make a copy of this notebook that you can edit. To run cells once you've forked the notebook, click inside a code cell and then hit CTRL + ENTER (CMD + ENTER on a Mac).\n\n![The button to fork this notebook](https:\/\/image.ibb.co\/kNKUZ5\/Screenshot_from_2017_08_30_16_47_40.png)\n\n___ \n**What is regression?**\n\nRegression is one way of modeling the strength and direction of the relationship between a dependent or output variable (usually represented by y) and one or more independent or input variables (usually represented by x). It differs from correlation analysis because it allows you to predict the outcome for new input or inputs you haven\u2019t seen yet.\n\n**What types of regression are there?**\n\nThere are many different types of regression. The specific family of regressions we\u2019ll be learning are called \u201cgeneralized linear models\u201d. The important thing for you to know is that with this family of models, you need to pick a specific type of regression you\u2019re interested in. The type of regression will depend on what type of data you\u2019re trying to predict.\n\n* **Linear**: When you\u2019re predicting a continuous value. (What temperature will it be today?)\n* **Logistic**: When you\u2019re predicting which category your observation is in. (Is this is a cat or a dog?)\n* **Poisson**: When you\u2019re predicting a count value. (How many dogs will I see in the park?)\n\nToday, we\u2019re going to practice picking the right model for our dataset and plotting it. I will demonstrate first on one dataset, then you'll try your hand at another.\n\n___\n\n<center>\n[**You can check out a video that goes with this notebook by clicking here.**](https:\/\/www.youtube.com\/embed\/UOj-GJAuvPM)","a680f4b4":"## Example: Recipes\n____\n\nFor our example, I'm going be working with a dataset of information on various recipes. I want to predict whether or not a recipe is a dessert based on how many calories it has. \n\nFirst, let's read in the library & datasets we'll need.","4508e548":"5. Use \"geom_smooth\" and the appropriate family to fit and plot a model","33f94df3":"Want more? Ready for a different dataset? [This notebook](https:\/\/www.kaggle.com\/rtatman\/datasets-for-regression-analysis\/) has additional dataset suggestions for you to practice regression with. ","9b15eb90":"## Your turn!\n___\n![Regression guide](https:\/\/image.ibb.co\/ducqSw\/regression_guide.png)\n\nA quick guide to the three types of regression we've talked about.\n___\n\nNow it's your turn to come up with a question, pick the right model for your data and plot it.","e2d04c74":"4. Plot your two variables","a7890aff":"1. Pick one of the two datasets (\"weather\" or \"bikes\", your choice! You can find out more about these datasets by expanding the \"Input\" section at the very top of this notebook.)","5f1b064f":"I'm going to do a little bit of data cleaning. I know that this has some really outrageous outliers, so I want to ignore any recipe with more than ten thousand calories. I also know that there are a lot of missing values, so I'm going to remove them. (You shouldn't) need to do this with the other datasets. ","bdd40fcf":"<b>this one is made to try poisson regressor in scikit-learn which is there from version 0.23<br>\nplease check your version before trying by:<br><\/b>\n    `import sklearn\nprint('The scikit-learn version is {}.'.format(sklearn.__version__))`"}}