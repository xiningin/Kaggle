{"cell_type":{"93bb8732":"code","36d747d9":"code","1075a461":"code","60a40b1c":"code","d1e1a2d3":"code","af8218f1":"markdown","9525d7d3":"markdown","42db31b2":"markdown","01e0e1c7":"markdown","66b1cfff":"markdown"},"source":{"93bb8732":"import os\nos.listdir('..\/input')","36d747d9":"import numpy as np, pandas as pd\n\nf_lstm_glove = '..\/input\/improved-lstm-baseline-glove-dropout\/submission.csv'\nf_nbsvm = '..\/input\/nb-svm-strong-linear-baseline\/submission.csv'\nf_lstm_fast = '..\/input\/improved-lstm-baseline-fasttext-dropout\/submission.csv'","1075a461":"p_lstm_glove = pd.read_csv(f_lstm_glove)\np_nbsvm = pd.read_csv(f_nbsvm)\np_lstm_fast = pd.read_csv(f_lstm_fast)","60a40b1c":"label_cols = ['toxic', 'severe_toxic', 'obscene', 'threat', 'insult', 'identity_hate']\np_res = p_lstm_glove.copy()\np_res[label_cols] = (p_nbsvm[label_cols] + p_lstm_glove[label_cols] + p_lstm_fast[label_cols]) \/ 3","d1e1a2d3":"p_res.to_csv('submission.csv', index=False)","af8218f1":"Now we can take the average of the label columns.","9525d7d3":"And finally, create our CSV.","42db31b2":"As we hoped, when we submit this to Kaggle, we get a great result - much better than the individual scores of the kernels we based off. This is currently the best Kaggle kernel submission that runs within the kernels sandbox!","01e0e1c7":"There are two very different strong baselines currently in the kernels for this competition:\n    \n- An *LSTM* model, which uses a recurrent neural network to model state across each text, with no feature engineering\n- An *NB-SVM* inspired model, which uses a simple linear approach on top of naive bayes features\n\nIn theory, an ensemble works best when the individual models are as different as possible. Therefore, we should see that even a simple average of these two models gets a good result. Let's try it! First, we'll load the outputs of the models (in the Kaggle Kernels environment you can add these as input files directly from the UI; otherwise you'll need to download them first).","66b1cfff":"## Introduction"}}