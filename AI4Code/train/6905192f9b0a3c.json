{"cell_type":{"6cef8650":"code","bf5a5817":"code","d06ac81c":"code","56ba9007":"code","5810baa2":"code","76233271":"code","5dd7f4d7":"code","a0d3d13f":"code","4abbd291":"markdown"},"source":{"6cef8650":"import random \nimport shutil\nimport numpy as np \nimport pandas as pd \nimport os\nSEED=1","bf5a5817":"%cd\n%cd '\/kaggle\/input\/apple-leaf-diseases'\nos.listdir()","d06ac81c":"print(len(os.listdir('Apple_cedar_rust')))\nprint(len(os.listdir('Apple_scab')))\nprint(len(os.listdir('Apple_black_rot')))","56ba9007":"#Creating new directory for slipting dataset\nbase_dir='\/kaggle\/working'\nos.chdir(base_dir)\nos.mkdir('Slipting_data')","5810baa2":"#Creating new directory for training and validation set\nbase_dir='\/kaggle\/working\/Slipting_data'\nos.chdir(base_dir)\nos.mkdir('training')\nos.mkdir('validation')\n\n#Directory of original dataset\nos.chdir('\/kaggle\/input\/apple-leaf-diseases')","76233271":"#Creating sub directories in each of the two folders viz training and validation\nclasses = os.listdir()\nfor i in classes:\n    tr_dir = os.path.join('\/kaggle\/working\/Slipting_data\/training',i)\n    val_dir = os.path.join('\/kaggle\/working\/Slipting_data\/validation',i)\n    os.mkdir(tr_dir)\n    os.mkdir(val_dir)\n    \n#Print sub directories\nprint(os.listdir('\/kaggle\/working\/Slipting_data\/training'))\nprint(os.listdir('\/kaggle\/working\/Slipting_data\/validation'))","5dd7f4d7":"#Split dataset and make new data\nprint(classes)\nprint(os.getcwd())\n\nfor item in classes:\n    n_val = round(len(os.listdir(item))*.2)\n    n_train = round(len(os.listdir(item))*.8)\n    fnames = os.listdir(item)\n    assert(n_val+n_train == len(fnames))\n    \n    random.seed(SEED+5)\n    random.shuffle(fnames)\n    val_fnames = fnames[0:n_val]\n    tr_fnames = fnames[n_val:len(fnames)]\n    assert(len(val_fnames)+len(tr_fnames)==len(fnames))\n    \n    for i in val_fnames:\n        #Directory of original dataset folder.\n        src ='\/kaggle\/input\/apple-leaf-diseases\/{}\/{}'.format(item,i)\n        #Directory of validation folder.\n        dest = '\/kaggle\/working\/Slipting_data\/validation\/{}\/'.format(item)\n        shutil.copy(src,dest)\n        \n    for j in tr_fnames:\n        #Directory of original dataset folder.\n        src ='\/kaggle\/input\/apple-leaf-diseases\/{}\/{}'.format(item,j)\n        #Directory of training folder.\n        dest ='\/kaggle\/working\/Slipting_data\/training\/{}\/'.format(item)\n        shutil.copy(src,dest)","a0d3d13f":"for i in classes:\n    path=os.path.join('\/kaggle\/working\/Slipting_data\/training',i)\n    print('Training samples in {} is {}'.format(i,len(os.listdir(path))))\n    \n    path=os.path.join('\/kaggle\/working\/Slipting_data\/validation',i)\n    print('Validation samples in {} is {}\\n'.format(i,len(os.listdir(path))))","4abbd291":"**Apple leaf diseases dataset split into training and validation sets randomly using random.shuffle()**"}}