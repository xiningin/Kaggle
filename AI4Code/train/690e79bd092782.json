{"cell_type":{"7ade56a8":"code","1658367a":"code","39b97f9c":"code","ac2faeda":"code","cd8f60c7":"markdown","18336735":"markdown"},"source":{"7ade56a8":"import numpy as np # linear algebra\nfrom lwlwrap import *","1658367a":"# Random test data.\nnum_samples = 100\nnum_labels = 20\n\ntruth = np.random.rand(num_samples, num_labels) > 0.5\n# Ensure at least some samples with no truth labels.\ntruth[0:1, :] = False\n\nscores = np.random.rand(num_samples, num_labels)","39b97f9c":"per_class_lwlrap, weight_per_class = calculate_per_class_lwlrap(truth, scores)\nprint(\"lwlrap from per-class values=\", np.sum(per_class_lwlrap * weight_per_class))\nprint(\"lwlrap from sklearn.metrics =\", calculate_overall_lwlrap_sklearn(truth, scores))","ac2faeda":"# Test of accumulator version.\naccumulator = lwlrap_accumulator()\nbatch_size = 12\nfor base_sample in range(0, scores.shape[0], batch_size):\n  accumulator.accumulate_samples(\n      truth[base_sample : base_sample + batch_size, :], \n      scores[base_sample : base_sample + batch_size, :])\nprint(\"cumulative_lwlrap=\", accumulator.overall_lwlrap())\nprint(\"total_num_samples=\", accumulator.total_num_samples)\n\n","cd8f60c7":"# Test using the new _Utility Script_-feature","18336735":"Test code from [original lwlwrap-notebook](https:\/\/colab.research.google.com\/drive\/1AgPdhSp7ttY18O3fEoHOQKlt_3HJDLi8#scrollTo=Aq8VVHsTohAy):"}}