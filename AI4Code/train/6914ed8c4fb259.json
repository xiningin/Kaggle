{"cell_type":{"a496e7eb":"code","b55c6647":"code","0eb70406":"code","d09c9284":"code","d18bffb9":"code","1eebdb82":"code","dfcf4fa3":"code","c20c0493":"code","fbf8bace":"code","cf8ed6c3":"code","b3bfc57b":"code","1dfbf2f9":"code","8a3bbca7":"markdown","36ef045d":"markdown","7cf75544":"markdown","7ad94097":"markdown","1ad6422b":"markdown","c9ca9c6c":"markdown","bfc53950":"markdown","9c38b6da":"markdown","bcbb96b5":"markdown","a6c3da50":"markdown"},"source":{"a496e7eb":"import pandas as pd\nfea = pd.read_csv(\"..\/input\/jane-street-market-prediction\/train.csv\")","b55c6647":"fea.head(10)","0eb70406":"fea.tail(15)","d09c9284":"fea.columns.tolist()","d18bffb9":"import seaborn as sns\nimport matplotlib.pyplot as plt\nCOLS = fea.iloc[:,7:10].columns\nfor f in COLS:\n    fig, axs = plt.subplots(1, 4, figsize=(15, 4))\n    sns.distplot(fea[f], ax=axs[0])\n    sns.distplot(fea.query('weight > 0')[f], ax=axs[1])\n    try:\n        sns.distplot(fea.query('weight > 0 and resp > 0')[f].dropna().apply(np.log1p), ax=axs[2])\n        sns.distplot(fea.query('weight > 0 and resp < 0')[f].dropna().apply(np.log1p), ax=axs[2])\n    except:\n        pass\n    fea.sample(5000).plot(kind='scatter', x=f, y='resp', ax=axs[3])\n    fig.suptitle(f, fontsize=15, y=1.1)\n    \n    axs[0].set_title('feature distribution')\n    axs[1].set_title('only weight > 0')\n    axs[2].set_title('log transform')\n    axs[3].set_title('feature vs. response')\n    \n    plt.tight_layout()\n    plt.show()","1eebdb82":"fea_first = fea[fea['date'] == 0]","dfcf4fa3":"fea_first['mult'] = fea_first['weight']*fea_first['resp']*1\np_first = fea_first['mult'].sum()\np_first\n\n","c20c0493":"fea_last = fea[fea['date'] == 499]","fbf8bace":"fea_last['mult'] = fea_last['weight']*fea_last['resp']*(fea_last['resp'] > 0)\np_last = fea_last['mult'].sum()\np_last","cf8ed6c3":"t = (np.sum(np.array([74, 2])\/np.sqrt(np.sum(np.array([74,2])**2))))*np.sqrt(250\/2)\nt","b3bfc57b":"total = fea.isnull().sum().sort_values(ascending = False)\npercent = (fea.isnull().sum()\/fea.isnull().count()*100).sort_values(ascending = False)\nmissing__train_data  = pd.concat([total, percent], axis=1, keys=['Total', 'Percent'])\nmissing__train_data.head(10)\n","1dfbf2f9":"correlations = fea.corr(method='pearson')\n\nfig, axs = plt.subplots(figsize=(16, 16))\nsns.heatmap(correlations)\nfig.savefig('correlation_map.png')\n\n","8a3bbca7":"\n1. weight is given in both the training and testing data\n2. resp is only given in the training data but not in the testing data\n3. action is not given in both\n \nThe target variable is action.\n","36ef045d":"List of the columns","7cf75544":"**Feature correlation**","7ad94097":"**Checking missing data for Train**","1ad6422b":"Let's find out what is the maximum return from we can obtain from day 499.","c9ca9c6c":"The maximum score for date 499 is 114.45","bfc53950":"Finding return for first row which has date = 0","9c38b6da":"Here for Date = 0 , we have return of score 12.","bcbb96b5":"Calculation of t:","a6c3da50":"**Utility Score**\n\nEach row in the set represents a trading return for which we have to predict an action value, 1 to make the trade and 0 if there is no trade. Each of them have an associated weight and resp, which represents a return.\nThe variable pi is a indicator for each day i, showing how much return we got for that day.\n\n   \n  pi=\u2211j(weight\u2217resp\u22171)\n  \n  t=\u2211pi\u2211p2i\u2212\u2212\u2212\u2212\u221a\u2217250|i|\n  \n  u=min(max(t,0),6)\u2211pi\n  \n  where (|i|) is the number of unique dates in the test set. "}}