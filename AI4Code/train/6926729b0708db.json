{"cell_type":{"caaf2fc0":"code","d80dd25d":"code","780136d8":"code","b1c039fb":"code","ea40b595":"code","935ccf17":"code","8ed418b5":"code","54d4db38":"code","d288a543":"code","fe7f089f":"code","917b7b06":"code","06c20a4b":"code","63cc9660":"code","a7f8a1a1":"markdown","4852fb6b":"markdown","0b2838e5":"markdown","0a54dc5d":"markdown"},"source":{"caaf2fc0":"from fastai.vision import *\nfrom fastai.metrics import error_rate\nimport os","d80dd25d":"bs = 64","780136d8":"path = '\/kaggle\/input\/flower-image-dataset\/flowers'","b1c039fb":"os.listdir(path)","ea40b595":"fnames = get_image_files(path)  #extract file names\nfnames[:5] ","935ccf17":"np.random.seed(2)\npat = r'\/([^\/]+)_\\d+.jpg$' ## regex which will extract the labels from the filenames","8ed418b5":"data = ImageDataBunch.from_name_re(path, fnames, pat, ds_tfms = get_transforms(), size = 224, bs = bs\n                                  ).normalize(imagenet_stats)  ","54d4db38":"print(data.classes) # different classes of flowers","d288a543":"learn = cnn_learner(data, models.resnet34, metrics=error_rate)","fe7f089f":"learn.fit_one_cycle(4) ### train for 4 epochs ","917b7b06":"interp = ClassificationInterpretation.from_learner(learn)\nlosses, idxs = interp.top_losses()","06c20a4b":"interp.plot_top_losses(8, figsize = (12,8)) ## these are the top losses - predicted vs actual","63cc9660":"interp.plot_confusion_matrix(figsize=(12,12), dpi=60) # confusion matrix for the losses","a7f8a1a1":"With an accuracy of around **92%**, we're doing pretty well!!","4852fb6b":"# Model for Image Recognition ","0b2838e5":"The ImageDataBunch operator makes a databunch which contains the training, testing, validation data. It also performs specific data augmentation tasks and image normalization.","0a54dc5d":"# Interpreting our model"}}