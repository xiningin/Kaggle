{"cell_type":{"a66b2a06":"code","31d630f9":"code","120ebe8a":"code","25716054":"code","4751a3d1":"code","ee5d3dbc":"code","9b611f9c":"code","68f7d01d":"code","ed08c835":"code","84d80cce":"code","bc332a8b":"code","d2eae83f":"code","6790fc5e":"code","a93cb42a":"code","57475b28":"code","a945c350":"code","1d51fe3e":"code","0a20ddfb":"code","23c4e2f9":"code","a5258c9e":"code","1e8f8aea":"code","92c4a993":"code","378ae94f":"code","76d0a084":"code","9a0f3ad3":"code","2da69a88":"code","fc0cd8cd":"code","cee0a065":"code","04e0be0c":"code","83dad36c":"code","64631db4":"code","1ef778d1":"code","fdc3ce32":"code","94c68cf3":"code","bf749ce8":"code","a4c2192e":"code","32ecb17d":"code","364ee824":"code","c155146a":"code","609bc74d":"markdown","1520364c":"markdown","63a2d8c8":"markdown","a494c04d":"markdown","77e82e64":"markdown","6bff4326":"markdown","bf810255":"markdown","0fb68a29":"markdown","58f4aa3d":"markdown","850271b1":"markdown","eaa1d9ba":"markdown","271c9bce":"markdown","e9db1b5d":"markdown","81875600":"markdown","b2994722":"markdown","7dc005c3":"markdown","9f962c02":"markdown","46c6f682":"markdown","4fc6f21c":"markdown"},"source":{"a66b2a06":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport pandas as pd\nimport numpy as np\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","31d630f9":"data = pd.read_csv('\/kaggle\/input\/unsupervised-learning-on-country-data\/Country-data.csv')","120ebe8a":"data.head()","25716054":"data.info()","4751a3d1":"data['Trade_Deficiency'] = data['exports'] - data['imports']","ee5d3dbc":"data.describe()","9b611f9c":"data.isnull().sum()","68f7d01d":"data_copy = data.copy()","ed08c835":"plt.figure(figsize=(10,8))\nsns.heatmap(data.corr(method='spearman'), square=True, cmap='coolwarm', annot=True)","84d80cce":"corr_values = data.corr(method='spearman')\n\n# Simplify by emptying all the data below the diagonal\ntril_index = np.tril_indices_from(corr_values)\n\n# Make the unused values NaNs\nfor coord in zip(*tril_index):\n    corr_values.iloc[coord[0], coord[1]] = np.NaN\n    \n# Stack the data and convert to a data frame\ncorr_values = (corr_values\n               .stack()\n               .to_frame()\n               .reset_index()\n               .rename(columns={'level_0':'feature1',\n                                'level_1':'feature2',\n                                0:'correlation'}))\n\n# Get the absolute values for sorting\ncorr_values['abs_correlation'] = corr_values.correlation.abs()","bc332a8b":"corr_values.sort_values(by = 'abs_correlation', ascending=False).head(10)","d2eae83f":"sns.pairplot(data = data)","6790fc5e":"fig, ax = plt.subplots(4, 3, figsize=(15, 15))\nbp=sns.boxplot(y=data.child_mort,ax=ax[0, 0])\nax[0, 0].set_title('Child Mortality Rate')\nbp=sns.boxplot(y=data.health,ax=ax[0, 1])\nax[0, 1].set_title('Health')\nbp=sns.boxplot(y=data.income,ax=ax[0, 2])\nax[0,2].set_title('Income per Person')\nbp=sns.boxplot(y=data.inflation,ax=ax[1, 0])\nax[1,0].set_title('Inflation')\nbp=sns.boxplot(y=data.imports,ax=ax[1,1])\nax[1, 1].set_title('Imports')\ns=sns.boxplot(y=data.life_expec,ax=ax[1, 2])\nax[1,2].set_title('Life Expectancy')\ns=sns.boxplot(y=data.total_fer,ax=ax[2,0])\nax[2,0].set_title('Total Fertility')\ns=sns.boxplot(y=data.gdpp,ax=ax[2, 1])\nax[2,1].set_title('GDP per Capita')\ns=sns.boxplot(y=data.exports,ax=ax[2,2])\nax[2,2].set_title('Exports')\ns=sns.boxplot(y=data.Trade_Deficiency,ax=ax[3,1])\nax[3,1].set_title('Trade Deficiency')\nax[3,0].axis('off')\nax[3,2].axis('off')\nplt.show()","a93cb42a":"gdpp = data.sort_values(by = ['gdpp'], ascending = True)\nplt.figure(figsize = [18,10])\nplt.subplot(2,1,1)\nsns.barplot(gdpp['country'].head(10),gdpp['gdpp'].head(10))\nplt.title('Top 10 countries having lowest GDP per captial')\nplt.subplot(2,1,2)\nsns.barplot(gdpp['country'].tail(10),gdpp['gdpp'].tail(10))\nplt.title('Top 10 countries having highest GDP per captial')\nplt.show()","57475b28":"Trade_Deficiency = data.sort_values(by = ['Trade_Deficiency'], ascending = True)\nplt.figure(figsize = [18,10])\nplt.subplot(2,1,1)\nsns.barplot(Trade_Deficiency['country'].head(10),Trade_Deficiency['Trade_Deficiency'].head(10))\nplt.title('Top 10 countries having lowest Trade Deficiency')\nplt.subplot(2,1,2)\nsns.barplot(Trade_Deficiency['country'].tail(10),Trade_Deficiency['Trade_Deficiency'].tail(10))\nplt.title('Top 10 countries having highest Trade Deficiency')\nplt.show()","a945c350":"life_expec = data.sort_values(by = ['life_expec'], ascending = True)\nplt.figure(figsize = [18,10])\nplt.subplot(2,1,1)\nsns.barplot(life_expec['country'].head(10),life_expec['life_expec'].head(10))\nplt.title('Top 10 countries having lowest Life Experience')\nplt.subplot(2,1,2)\nsns.barplot(life_expec['country'].tail(10),life_expec['life_expec'].tail(10))\nplt.title('Top 10 countries having highest Life Experience')\nplt.show()","1d51fe3e":"fig, ax = plt.subplots(4, 3, figsize=(15, 15))\ndp=sns.distplot(data['child_mort'],ax=ax[0, 0])\ndp=sns.distplot(data['health'],ax=ax[0, 1])\ndp=sns.distplot(data['income'],ax=ax[0, 2])\ndp=sns.distplot(data['inflation'],ax=ax[1, 0])\ndp=sns.distplot(data['imports'],ax=ax[1,1])\ndp=sns.distplot(data['life_expec'],ax=ax[1, 2])\ndp=sns.distplot(data['total_fer'],ax=ax[2,0])\ndp=sns.distplot(data['gdpp'],ax=ax[2, 1])\ndp=sns.distplot(data['exports'],ax=ax[2,2])\ndp=sns.distplot(data['Trade_Deficiency'],ax=ax[3,1])\nax[3,0].axis('off')\nax[3,2].axis('off')\nplt.show()","0a20ddfb":"from sklearn.preprocessing import StandardScaler","23c4e2f9":"# scale the data\ndata = data.drop(['country'], axis=1)\nsc = StandardScaler()","a5258c9e":"data = sc.fit_transform(data)","1e8f8aea":"from sklearn.decomposition import PCA","92c4a993":"pca = PCA().fit(data)","378ae94f":"plt.rcParams['figure.figsize'] = [6,6]\nsns.set_style(\"whitegrid\")\nsns.set_context(\"talk\")\n\n# plot the Cumulative Summation of the Explained Variance\nplt.figure()\nplt.plot(np.cumsum(pca.explained_variance_ratio_))\n\n# define the labels & title\nplt.xlabel('Number of Components', fontsize = 15)\nplt.ylabel('Variance (%)', fontsize = 15) \nplt.title('Explained Variance', fontsize = 20)\n\n# show the plot\nplt.show()","76d0a084":"data_pca = PCA(n_components=6).fit(data).transform(data)","9a0f3ad3":"# store it in a new data frame\ndata_pca= pd.DataFrame(data = data_pca, columns = ['principal component 1', 'principal component 2',\n                                                        'principal component 3','principal component 4',\n                                                        'principal component 5','principal component 6'])\n\ndata_pca.head()","2da69a88":"from sklearn.cluster import KMeans","fc0cd8cd":"inertia = []\nlist_num_clusters = list(range(1,11))\nfor num_clusters in list_num_clusters:\n    km = KMeans(n_clusters=num_clusters)\n    km.fit(data_pca)\n    inertia.append(km.inertia_)\n    \nplt.plot(list_num_clusters,inertia)\nplt.scatter(list_num_clusters,inertia)\nplt.xlabel('Number of Clusters')\nplt.ylabel('Inertia')","cee0a065":"kmeans = KMeans(n_clusters = 3)","04e0be0c":"kmeans.fit(data_pca)\nkmeans_pred = kmeans.predict(data_pca)","83dad36c":"data_copy['cluster'] = kmeans_pred","64631db4":"plt.figure(figsize = [15,10])\nsns.scatterplot(x = 'child_mort', y = 'total_fer', data = data_copy, hue = 'cluster')","1ef778d1":"data_copy[data_copy['cluster'] == 0][:10]","fdc3ce32":"data_copy[data_copy['cluster'] == 1][:10]","94c68cf3":"data_copy[data_copy['cluster'] == 2][:10]","bf749ce8":"from sklearn.cluster import AgglomerativeClustering","a4c2192e":"ag = AgglomerativeClustering(n_clusters=3, linkage='ward', compute_full_tree=True)\nag = ag.fit(data_pca)\ndata_copy['agglom'] = ag.fit_predict(data_pca)","32ecb17d":"plt.figure(figsize = [15,10])\nsns.scatterplot(x = 'child_mort', y = 'total_fer', data = data_copy, hue = 'agglom')","364ee824":"from scipy.cluster import hierarchy","c155146a":"Z = hierarchy.linkage(ag.children_, method='ward')\n\nfig, ax = plt.subplots(figsize=(15,5))\n\nden = hierarchy.dendrogram(Z, orientation='top', \n                           p=3, truncate_mode='lastp',\n                           show_leaf_counts=True, ax=ax,)","609bc74d":"**Country having lowest Trade Deficiency**\n>1. Haiti\n>2. Tonga\n>3. Tajikistan\n\n**Country having highest Trade Deficiency**\n>1. Gabon\n>2. Azerbaijan\n>3. Libya","1520364c":">1. From the above plot, most of the average income per person and gdp per capita is observed in the range of 0-15000\n>2. On average, we can infer that life expectancy of a person for most of the countries is observed between 60-80\n>3. Child mortality (Death of children under 5 years of age per 1000 live births) seems to be below 50 in most of the countries, only few countries child mortality is above 100.","63a2d8c8":"**Country having lowest GDP**\n>1. Congo, Dem Rep\n>2. Niger\n>3. Madascar\n\n**Country having highest GDP**\n>1. Bahrain\n>2. Barbados\n>3. Estonia","a494c04d":"# Principal Component Analysis","77e82e64":"# Hierarchical Agglomerative Clustering","6bff4326":"**Cluster 3** are those developed countries, most of which are in Europe, North America and some part of Asia","bf810255":"***There is no missing data***","0fb68a29":"# Kmeans Clustering","58f4aa3d":"There are some outliers in income, exports, imports and trade deficiency and as we have less data so we can not remove outliers","850271b1":"**Country having lowest Life Experience**\n>1. Haiti\n>2. Central African Republic\n>3. Zambia\n\n**Country having highest Life Experience**\n>1. Tunisia\n>2. Antihua and barbuda\n>3. Barbados","eaa1d9ba":"**Cluster 1** are those developing countries, most of which are in South America and Asia","271c9bce":"Here, using Exports and Imports we can find Trade Deficiency i.e  _Export - Import_","e9db1b5d":"***Data Scaling using Standard scaler***","81875600":"**Attribute Information**\n\n\n1. country : Name of the country\n2. child_mort : Death of children under 5 years of age per 1000 live births\n3. exports : Exports of goods and services per capita. Given as %age of the GDP per capita\n4. health : Total health spending per capita. Given as %age of GDP per capita\n5. imports : Imports of goods and services per capita. Given as %age of the GDP per capita\n6. Income : Net income per person\n7. Inflation : The measurement of the annual growth rate of the Total GDP\n8. life_expec : The average number of years a new born child would live if the current mortality patterns are to remain the same\n9. total_fer : The number of children that would be born to each woman if the current age-fertility rates remain the same.\n10. gdpp : The GDP per capita. Calculated as the Total GDP divided by the total population.\n\n\n**Problem Statement :**\nTo categorise the countries using some socio-economic and health factors that determine the overall development of the country. Then you need to suggest the countries such that\n1. Under-developing country\n2. Developing country\n3. Developed country","b2994722":"When can use **6 components**  ","7dc005c3":"**Outliers Treatment**","9f962c02":"**EDA Inferences:-**\n\n>1. Child Mortality rate decreases with Increase in GDPP. Both of them have a very high correlation, which is expected as developed contries(having higer GDPP) will have better healthcare and hence better chance of survival.\n\n>2. Child Mortality rate is directly proportional to total fertility rate. Which is sort of a dependent feature in my opinion. Women are giving birth to more children if the previous ones didn't survive unfortunately.\n\n>3. Child Mortality rate is iversely proportional to Life expectance. Which is again a very dependent feature, because if more number children unfortunately die too early it pulls down the overall life expectancy of the country.\n\n>4. Inflation is weakly inversely proportional to GDPP which in my opinion might be due to the economic saturation in highly developed nations.\n\n>6. Per capita Income is heavily correlated to GDPP because one is roughly a function of another.\n\n>7. Import and exports increade with one another which implied the trading power of the contry as a whole grows; i.e, countries who export more are also likely to import something else more.\n\n>8. Spendings on health increase with GDPP and Income, which is self-explanatory.\n\n>9. Income rises with exports which might be because people generate income by generating goods and services which are later exported.\n\n>10. Child Mortality rate is iversely proportional to Healthcare expenditure and Income. Which shows that unfortunate circumstances with low income groups is often responsible for a low life expentancy among children.\n","46c6f682":"## EDA ","4fc6f21c":"**Cluster 2** are those  undeveloped countries, most of which are in Africa"}}