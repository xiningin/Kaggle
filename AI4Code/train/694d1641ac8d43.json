{"cell_type":{"97e415d2":"code","b4e899b8":"code","6c304988":"code","fd23ca1f":"code","a871cee8":"code","3c289d36":"code","8c8ecb83":"code","e3771226":"code","6923ad82":"code","88b5b01c":"code","fa5164ca":"code","fb396a2b":"code","00dfa857":"code","d7e262af":"code","e1ed1b21":"code","26bbb772":"code","6e1ea760":"code","0cda98d5":"code","c55b067b":"code","57843fe0":"code","e09122a3":"code","bb29d5ed":"code","1f646598":"code","f98d714a":"code","3de7ed0b":"code","7dbae2d6":"code","232c9595":"code","1f4dddf4":"code","19e62308":"code","8ad11cd3":"code","eefaa337":"code","35be4703":"code","70446fd4":"code","8d9d3679":"code","71848856":"code","bd5778fa":"code","559488f3":"code","4bcc4ddc":"code","314aa8e4":"code","511cba35":"code","22d90f55":"code","eb7497bc":"code","a2059f7e":"code","01ee57b7":"code","5a1f16ca":"code","939a660a":"code","0dde92a0":"code","c45adfba":"code","925de3d9":"code","f7fbc7a1":"code","5fb7457a":"code","e4501944":"code","deeebcec":"code","03e5b9b1":"code","fc246ce4":"code","6bd6488f":"code","69249554":"markdown","55951e9a":"markdown","4a38aff6":"markdown","9d139d87":"markdown","d6d2be4d":"markdown","9664f9d4":"markdown","6d6905dc":"markdown","2e703250":"markdown","51c7bdc4":"markdown","a57eab9e":"markdown","4a4e1fb4":"markdown","41638546":"markdown","63704b05":"markdown","2893c085":"markdown","5baaa9f9":"markdown","b45b5158":"markdown","f8fddde2":"markdown","d7d59388":"markdown","ebd82655":"markdown","69326968":"markdown","4e28b2ea":"markdown","742c399e":"markdown","638b3a96":"markdown","02d031eb":"markdown","ff8b0368":"markdown","9248cb56":"markdown","84012f24":"markdown","a274b491":"markdown","cd970360":"markdown","048f9bf0":"markdown","bec0afc4":"markdown","7d6cd4a3":"markdown","93fc8685":"markdown","fb29ba2e":"markdown","ed4930c6":"markdown","71b0b5b2":"markdown","9e2ec13e":"markdown"},"source":{"97e415d2":"import numpy as np\nimport pandas as  pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport  warnings \nwarnings.filterwarnings('ignore')\n%matplotlib inline","b4e899b8":"df=pd.read_csv('\/kaggle\/input\/cervical-cancer-risk-classification\/kag_risk_factors_cervical_cancer.csv')","6c304988":"df.head(10)","fd23ca1f":"df.info()","a871cee8":"num_cols=numerical_df = ['Age', 'Number of sexual partners', 'First sexual intercourse','Num of pregnancies', 'Smokes (years)',\n                'Smokes (packs\/year)','Hormonal Contraceptives (years)','IUD (years)','STDs (number)']\n\n\ncat_cols=['Smokes','Hormonal Contraceptives','IUD','STDs','STDs:condylomatosis','STDs:cervical condylomatosis',\n                  'STDs:vaginal condylomatosis','STDs:vulvo-perineal condylomatosis', 'STDs:syphilis',\n                  'STDs:pelvic inflammatory disease', 'STDs:genital herpes','STDs:molluscum contagiosum', 'STDs:AIDS', \n                  'STDs:HIV','STDs:Hepatitis B', 'STDs:HPV', 'STDs: Number of diagnosis','Dx:Cancer', 'Dx:CIN', \n                  'Dx:HPV', 'Dx', 'Hinselmann', 'Schiller','Citology', 'Biopsy']","3c289d36":"#we are dropping the STDs: column because these are of not of much use for our analysis bcz of having a lot of missing values\n\ndf.drop(['STDs: Time since last diagnosis','STDs: Time since first diagnosis'],inplace=True,axis=1)","8c8ecb83":"df.head()","e3771226":"df=df.replace('?',np.NaN)","6923ad82":"# now we  fill missing values in numerical columns with mean of numerical data \nfor feature in num_cols:\n    print(feature,'',df[feature].astype(float).mean())\n    feature_mean = round(df[feature].astype(float).mean(),1)\n    df[feature] = df[feature].fillna(feature_mean)","88b5b01c":"for features in cat_cols:\n    df[features]=df[features].astype(float).fillna(1.0)","fa5164ca":"for feature in cat_cols:\n    sns.factorplot(feature,data=df,kind='count')","fb396a2b":"g = sns.PairGrid(df,\n                 y_vars=['Hormonal Contraceptives'],\n                 x_vars= cat_cols,\n                 aspect=2.75, size=10.5)\ng.map(sns.barplot, palette=\"pastel\");","00dfa857":"df['Number of sexual partners'] = round(df['Number of sexual partners'].astype(float))\ndf['First sexual intercourse'] = df['First sexual intercourse'].astype(float)\ndf['Num of pregnancies']=round(df['Num of pregnancies'].astype(float))\ndf['Smokes'] =df['Smokes'].astype(float)\ndf['Smokes (years)'] =df['Smokes (years)'].astype(float)\ndf['Hormonal Contraceptives'] = df['Hormonal Contraceptives'].astype(float)\ndf['Hormonal Contraceptives (years)'] = df['Hormonal Contraceptives (years)'].astype(float)\ndf['IUD (years)'] = df['IUD (years)'].astype(float)\n\nprint('minimum:',min(df['Hormonal Contraceptives (years)']))\nprint('maximum:',max(df['Hormonal Contraceptives (years)']))","d7e262af":"plt.hist(df['Age'].mean(),bins=20)\nplt.xlabel('Age')                                 # age estimation for the risk of cervical cancer \nplt.ylabel('count')\nprint('mean age of woman facing the cervical cancer ',df['Age'].mean())\n","e1ed1b21":"for feature in cat_cols:\n    fig=sns.FacetGrid(df,hue=feature)\n    fig.map(sns.kdeplot,'Age',shade=True)\n    max_age=df['Age'].max()\n    fig.set(xlim=(0,max_age))\n    fig.add_legend()","26bbb772":"for feature in cat_cols:\n    plt.figure(figsize=(10,8))\n    sns.factorplot(x='Number of sexual partners',y='Age',hue=feature,data=df,kind='bar')","6e1ea760":"sns.distplot(df['First sexual intercourse'].astype(float))","0cda98d5":"sns.scatterplot(x='First sexual intercourse',hue='Dx:Cancer',y='Num of pregnancies',data=df)","c55b067b":"df['Dx:Cancer'].value_counts()","57843fe0":"A1=df.groupby(['Dx:Cancer'])","e09122a3":"cancer_patients=A1.get_group(1)\ncancer_free_patients=A1.get_group(0)","bb29d5ed":"age_affected_cancer=cancer_patients['Age']\nage_notaffected=cancer_free_patients['Age']","1f646598":"age_affected_cancer.describe()","f98d714a":"age_notaffected.describe()","3de7ed0b":"plt.hist(age_affected_cancer)","7dbae2d6":"df.boxplot(column='Age',by='Dx:Cancer')","232c9595":"from scipy.stats import shapiro\nprint(shapiro(age_affected_cancer))\nprint(shapiro(age_notaffected))","1f4dddf4":"from scipy.stats import levene","19e62308":"levene(age_affected_cancer,age_notaffected)","8ad11cd3":"from scipy.stats import ttest_ind","eefaa337":"ttest_ind(age_affected_cancer,age_notaffected)","35be4703":"df['Dx:Cancer'].value_counts()","70446fd4":"s=df.groupby(['Dx:Cancer'])","8d9d3679":"s1=s.get_group(1)\ns2=s.get_group(0)","71848856":"sexual_intercourse=s1['First sexual intercourse']\nno_sexual_intercourse=s2['First sexual intercourse']","bd5778fa":"sexual_intercourse.describe()","559488f3":"no_sexual_intercourse.describe()","4bcc4ddc":"print(shapiro(sexual_intercourse))   #H0:data follows normality   H1:data not following normality\nshapiro(no_sexual_intercourse)","314aa8e4":"levene (sexual_intercourse,no_sexual_intercourse)  #H0:variance of (sexual_intercourse)having cancer=var(no_sexual_intercourse)having cancer\n                                                    #H1:variance of (sexual_intercourse)having cancer!=var(no_sexual_intercourse)having cancer","511cba35":"ttest_ind(sexual_intercourse,no_sexual_intercourse)","22d90f55":"from sklearn.model_selection import cross_val_score # Cross Validation Score\nfrom sklearn.model_selection import GridSearchCV # Parameters of the Model\nfrom sklearn.model_selection import RandomizedSearchCV # Tuning the Parameters\nfrom sklearn.tree import DecisionTreeClassifier # Decision Tree Algo\nfrom sklearn.ensemble import RandomForestClassifier # Random Forest Algo.\nfrom sklearn.model_selection import train_test_split # helps in spliting the data in train and test set\nfrom sklearn.metrics import accuracy_score # Calculating the Accuracy Score againts the Classes Predicted vs Actuals.\nfrom sklearn.ensemble import BaggingClassifier","eb7497bc":"#defining my Xs and Ys\nx=df.drop('Dx:Cancer',axis=1) #dropping the target\ny=df['Dx:Cancer']\n\nx_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.3, random_state=32)","a2059f7e":"#creatig our first model called Decisiontree\ntree=DecisionTreeClassifier()\n\n#defining tree params for grid based search\ntree_params={\n    \"criterion\":[\"gini\", \"entropy\"],\n    \"splitter\":[\"best\", \"random\"],\n    \"max_depth\":[3,4,5,6],\n    \"max_features\":[\"auto\",\"sqrt\",\"log2\"],\n    \"random_state\": [123]\n}","01ee57b7":"# apply grid search algorithm\n\ngrid=GridSearchCV(tree,tree_params,cv=10)\ngrid\n","5a1f16ca":"#lets fit into data so that it can giuve the best params\n\nbest_param_search=grid.fit(x_train,y_train)\n\nbest_param_search.best_params_","939a660a":"#creating our first model called decision tree after hypertuning\n \ntree2=DecisionTreeClassifier(criterion='entropy',max_depth=5,max_features= 'auto',random_state= 123,splitter='best')\n\n#Developiug the model\nmodel_tree=tree.fit(x_train,y_train)\npred_tree=tree.predict(x_test)\naccuracy_score(y_test,pred_tree)","0dde92a0":"Rf_model=RandomForestClassifier(n_estimators=10,criterion='entropy',random_state=0) ","c45adfba":"bag_model=BaggingClassifier(n_estimators=10,random_state=0)  #fully grown decision tree","925de3d9":"bag_model2=BaggingClassifier(n_estimators=10,random_state=0,base_estimator=tree2)## Regularised decision tree","f7fbc7a1":"models=[]\nmodels.append(('Decision tree',tree))\nmodels.append(('Random Forest',Rf_model))\nmodels.append(('Bagged_DT',bag_model))\nmodels.append(('bagged_regularized',bag_model2))","5fb7457a":"models","e4501944":"from sklearn import model_selection\nresults = []\nnames = []\n\nfor name, model in models:\n    kfold = model_selection.KFold(n_splits=5,random_state=2)\n    cv_results = model_selection.cross_val_score(model, x, y, cv=kfold, scoring='recall')\n    results.append(cv_results)\n    names.append(name)\n    msg = \"%s: %f (%f)\" % (name, np.mean(cv_results), np.var(cv_results,ddof=1))\n    print(msg)","deeebcec":"fig = plt.figure()\nfig.suptitle('Algorithm Comparison')\nax=fig.add_subplot(111)\nplt.boxplot(results)\nax.set_xticklabels(names)\nplt.show()","03e5b9b1":"# #lets import adaboost and bagging classifier\n# from sklearn.ensemble import BaggingClassifier\n# bagg=BaggingClassifier()\n# bagmodel=bagg.fit(x_train,y_train)\n# #make prediction\n# pred_bagged=bagg.predict(x_test)","fc246ce4":"# accuracy_score(y_test,pred_bagged)","6bd6488f":"# tree=DecisionTreeClassifier()\n# cross_val_score(tree,x,y,cv=10).mean()","69249554":"**Dropping unneccessary columns**[](http:\/\/)","55951e9a":"> **Load and describe Data**","4a38aff6":"**OBJECTIVE:**\n\nA risk factor is anything that increases a person's chance of developing cancer.\nAlthough risk factors often influence the development of cancer, most do not directly cause cancer. \nSome people with several risk factors never develop cancer, while others with no known risk factors do. \nKnowing your risk factors and talking about them with your doctor may help you make more informed lifestyle \nand health care choices.","9d139d87":"###### unpaired t test","d6d2be4d":"as the age increases the number of sexual partners increases too ,\n\ncausing to be one of the factor with getting a cancerous tumour","9664f9d4":"### check whether the fist sexual intercourse is impacting the cancerous tumour ?","6d6905dc":"#### To check  if there age is  impacting the cancer ?","2e703250":"#### though our pvalue is less than alpha hence we will reject the null-hypothesis and with 95% confidence we can judge that the mean of first_sexua_intercourse=mean of no_sexual_intercourse so there is a impact of first sexual intercourse over thecause of cancer tumour ","51c7bdc4":"##### Test of independency","a57eab9e":"**Missing value treatment**[](http:\/\/)","4a4e1fb4":"> **Importing essential Libraries**","41638546":"#                        THE END","63704b05":"##### check for variance","2893c085":"![image.png](attachment:image.png)","5baaa9f9":"### Bagged model","b45b5158":"H0:mu(age)cancer=mu(age)not_affected\n\nH1:mu(age)cancer!=mu(age)not_affected","f8fddde2":"from the above graph it is clear that the harmonal contraceptive have the highest key feature that affect\nthe cervical cancer .so lets concentrate more on this for our furthur analysis","d7d59388":"plot depicts the woman started their first sexual intercourse at the age ranging 15-20 ","ebd82655":"**Table Of Content**\n\n* Importing Essential Libraries \n* Loading CSV file\n* Univariate analysis\n    * Categorising Dat\n    * Dropping Unnecessary columns\n* Outlier Treatment\n* Exploratory Data Analysis\n* Statistica Approach\n      *Check for Normality\n      *Test of Variance\n* Model Building\n      * Decision Tree\n      * Random Forest\n      * Bagged model\n* Model evaluation\n             \n   ","69326968":"**Exploaratry Data analysis**[](http:\/\/)","4e28b2ea":"the relatioal plot depicts that the women who did their first  sexual itercourse at age of 18-20 and their number of pregnancies ranging (1-3)are more prone to cancer tumour","742c399e":"### Decision tree model","638b3a96":"**![](http:\/\/)> Categorising data **","02d031eb":"###### so this interprets that the pvalue is less than alpha(0.05) hence from 95% cnfidence we can conclude our judgment that the mean age of poulation is not affecting the cancer occurnce","ff8b0368":"##### check for normality","9248cb56":"### Random forest model","84012f24":"the density plot shows that the woman who are having age of 26 are having a more chance of getting affected.\nand also the woman age group of age between 20 to 35 are having a more chance of having cancer.The peak of age is at 50 and the extension shows the furthur too.","a274b491":"#### variance test","cd970360":"Hypothesis ","048f9bf0":"###### check for normality","bec0afc4":"### statistical approach","7d6cd4a3":"the variance test interprets that the pvalue is greater than alpha hence we will accept the null hypothesis and can conclude\nthat the variance of (sexual_intercourse)having cancer==variance (no_sexual_intercouse)having cancer","93fc8685":"###### the normality test interprets that the p value is geater than alpha(0.05) hence we will accept the null hypothesis andcan conclude that the data is following normal and is parametric ,hence next we will check for the variance between the data so to satisfy the assumptions","fb29ba2e":"###### though our both variables passed the test of normality and test of variance hence the variables are parametric so we wil go through the unpaired ttest.","ed4930c6":"## Building the model","71b0b5b2":"Hypothesis\n\nH0:mean(first_sexual_intercourse)=mean(no_sexual_intercourse)\n    \nH1:mean(first_sexual_intercourse)!=mean(no_sexual_intercourse)","9e2ec13e":"hence the pvalue is greater than alpha so we will accept the null hypothesis this interprets that the data is normal"}}