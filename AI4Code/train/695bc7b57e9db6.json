{"cell_type":{"596da0ac":"code","30ac0e23":"code","1c4e7a81":"code","48b5ddd0":"code","6b3bb0f1":"code","a7ec291c":"code","4f412820":"code","f6a280cf":"code","077bc1b4":"code","5f177426":"code","fc1d0c56":"code","aafccede":"code","37fe4dcb":"code","c7fbe81b":"code","1a533ffe":"code","a4ce35bd":"code","7dfb3685":"code","b5742824":"code","c3d725a8":"code","9446d09f":"code","e38bb72f":"code","eba90950":"code","95d4d2fb":"code","4fe0fafa":"code","931e15f9":"code","4ffef651":"code","d7ba7bc4":"code","bf12ea41":"code","31191767":"code","7d8612bc":"code","de65a85e":"code","95f82912":"code","6ade05c9":"code","6c5b4e40":"code","a524ae3a":"code","4fc4354e":"code","5ace1786":"code","0e68a012":"code","e1f8493b":"code","a9c8c67e":"code","b2279e55":"code","aeef4808":"code","8635ed88":"code","b71b0fb2":"code","f183f99d":"code","eea0f656":"code","255d9255":"code","a77bf4d8":"code","f54f70db":"code","2d6eeaa0":"code","7fec9ec9":"code","15d74c7e":"code","f5b49752":"code","a99a25fb":"code","2f49887d":"code","518bc179":"code","2e9801d8":"code","00e1ea74":"code","eef935ba":"code","1b5dc562":"code","96ac5eeb":"code","61e37704":"code","8d2a0570":"code","3e5600e0":"markdown","920b7618":"markdown","85048b81":"markdown","0245a49e":"markdown","dcf417a5":"markdown","548d5476":"markdown","c1fc9b58":"markdown","9249d8fe":"markdown","4e1e29ea":"markdown","7dc3e111":"markdown","027f2f8d":"markdown","d614ad75":"markdown","a042ab9c":"markdown","ece5d23d":"markdown"},"source":{"596da0ac":"!pip install Autoviz -q\n!pip install dexplot -q\n!pip install pycaret -q","30ac0e23":"import warnings\nwarnings.filterwarnings('ignore')\n\n# for some basic operations\nimport numpy as np \nimport pandas as pd \n\n# for visualizations\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom pandas import plotting\nfrom pandas_profiling import ProfileReport\nfrom pandas.plotting import parallel_coordinates\n\n# for interactive visualizations\nimport plotly\nimport plotly.offline as py\nfrom plotly.offline import init_notebook_mode, iplot\nimport plotly.graph_objs as go\nfrom plotly import tools\ninit_notebook_mode(connected = True)\nimport plotly.figure_factory as ff\nimport dexplot as dxp\n# for animated visualizations\nimport plotly_express as px\n\n# for providing path\nimport os\nprint(os.listdir(\"..\/input\"))\n\n# for modelling\nimport sklearn\nimport imblearn\n\n# for model explanation\nimport shap \nimport eli5\nRANDOM_SEED = 42\n","1c4e7a81":"df_all = pd.read_csv('..\/input\/ecommerce-data\/ecommerce.csv')\ndf_summer = pd.read_csv('..\/input\/summer-products-and-sales-in-ecommerce-wish\/summer-products-with-rating-and-performance_2020-08.csv')","48b5ddd0":"df_summer.head()","6b3bb0f1":"df_all.head()","a7ec291c":"profile = ProfileReport(df_summer,title = 'Pandas Profile Report')","4f412820":"profile.to_notebook_iframe()","f6a280cf":"from autoviz.AutoViz_Class import AutoViz_Class\n\nAV = AutoViz_Class()","077bc1b4":"filename = \"..\/input\/summer-products-and-sales-in-ecommerce-wish\/summer-products-with-rating-and-performance_2020-08.csv\"\nsep = \",\"\ndft = AV.AutoViz(\n    filename,\n    sep,\n    'price',\n    df_summer,\n    header=0,\n    verbose=0,\n    lowess=False,\n    chart_format=\"svg\",\n    max_rows_analyzed=150000,\n    max_cols_analyzed=30,\n)","5f177426":"df_summer.describe(include=['O']).transpose()","fc1d0c56":"df_summer.describe().transpose()","aafccede":"df_summer[df_summer['origin_country'] == 'US'][['units_sold', 'merchant_name', 'merchant_rating']].head(10).style.background_gradient('magma')","37fe4dcb":"df_summer[df_summer['origin_country'] == 'CN'][['units_sold', 'merchant_name', 'merchant_rating']].head(10).style.background_gradient('Pastel1')","c7fbe81b":"df_summer[df_summer['product_color'] == 'White'][['units_sold', 'merchant_name', 'merchant_rating']].head(10).style.background_gradient('Pastel1')","1a533ffe":"data = df_summer.copy()","a4ce35bd":"df_summer.dropna(inplace=True)\ndf_summer.isna().any()","7dfb3685":"df_summer.info()","b5742824":"plt.rcParams['figure.figsize'] = (20, 9)\n\nsns.countplot(df_summer['shipping_option_name'], palette = 'gist_earth')\n\nplt.title('Shipping Options in Summer Sales', fontweight = 30, fontsize = 20)\nplt.xticks(rotation = 90)\nplt.show()","c3d725a8":"# plotting a scatter plot\n\nfig = px.scatter(df_summer, x = 'price', y = 'units_sold', color = 'shipping_option_name',\n                marginal_x = 'rug', marginal_y = 'histogram',title='Scatter for Selling Price and Units sold')\nfig.show()","9446d09f":"fig = px.scatter(df_summer, x = 'retail_price', y = 'rating', color = 'uses_ad_boosts',\n                marginal_x = 'rug', marginal_y = 'histogram',title='Scatter for Retail Price and Ratings')\nfig.show()","e38bb72f":"fig = px.scatter_matrix(df_summer, dimensions=[\"price\", \"retail_price\", \"currency_buyer\"],\n                        color = \"shipping_option_name\",title = 'Scatter Matrix for Price Distribution')\nfig.show()","eba90950":"dxp.bar(x = 'price',y = 'units_sold',data = df_summer)","95d4d2fb":"plt.style.use('seaborn')\n\n\ndf_summer['product_color'].value_counts().head(15).plot.pie(figsize = (15, 8))\n\nplt.title('Categorization of Product Color',fontsize = 20)\n\nplt.xticks(rotation = 90)\nplt.show()","4fe0fafa":"fig = px.box(df_summer, x=\"badge_product_quality\", y=\"units_sold\", color=\"uses_ad_boosts\", notched=True,color_discrete_sequence=[\"red\", \"green\"])\nfig.show()","931e15f9":"m_name = df_summer['merchant_name'].value_counts()\n\nlabel_m = m_name.index\nsize_m = m_name.values\n\ntrace = go.Pie(\n         labels = label_m, values = size_m, name = 'Merchants', hole = 0.1)\n\n\ndf = [trace]\n\nlayout = go.Layout(\n           title = 'Distribution of Merchants')\n\nfig = go.Figure(data = df, layout = layout)\n\npy.iplot(fig)","4ffef651":"trace = go.Box(\n          x = df_summer['shipping_option_name'],\n          y = df_summer['price'],\n          opacity = 0.7,\n          marker = dict(\n                 color = 'rgb(215, 195, 5, 0.5)'\n          )\n)\ndf = [trace]\n\nlayout = go.Layout(\n    title = 'Shipping Options vs Price')\n\nfig = go.Figure(data = df, layout = layout)\npy.iplot(fig)","d7ba7bc4":"plt.figure(figsize = (18, 8))\nplt.style.use('fivethirtyeight')\nax = sns.countplot('rating_count', data = df_summer, palette = 'terrain')\nax.set_xlabel(xlabel = 'Ratings Count', fontsize = 16)\nax.set_ylabel(ylabel = 'Count of Rating', fontsize = 16)\nax.set_title(label = 'Rating Count for Different Products', fontsize = 20)\nplt.show()","bf12ea41":"plt.rcParams['figure.figsize'] = (15, 5)\nsns.distplot(df_summer['price'], color = 'r')\nplt.xlabel('Price', fontsize = 16)\nplt.ylabel('Count', fontsize = 16)\nplt.title('Distribution of Price', fontsize = 20)\nplt.xticks(rotation = 90)\nplt.show()","31191767":"plt.rcParams['figure.figsize'] = (15, 5)\nsns.distplot(df_summer['retail_price'], color = 'b')\nplt.xlabel('Retail Price', fontsize = 16)\nplt.ylabel('Count', fontsize = 16)\nplt.title('Distribution of Retail Price', fontsize = 20)\nplt.xticks(rotation = 90)\nplt.show()","7d8612bc":"plt.figure(figsize = (20, 5))\nsns.distplot(df_summer['rating'], color = 'pink')\nplt.title('Distribution for Rating Across Different Products', fontsize = 20)\nplt.xlabel('Ratings', fontsize = 16)\nplt.ylabel('count of ratings', fontsize = 16)\nplt.show()","de65a85e":"fig = px.bar(df_summer, x=\"countries_shipped_to\", y=\"price\", barmode=\"group\",color=\"shipping_option_name\", template=\"plotly_dark\",\n            color_discrete_sequence= px.colors.sequential.Plasma_r,title=\"Price Variations for Different Shipping options\")\nfig.show()","95f82912":"plt.figure(figsize = (13, 8))\nax = sns.countplot(x = 'countries_shipped_to', data = df_summer, palette = 'gist_stern_r')\nax.set_title(label = 'Count for Order Shipment Countries', fontsize = 20)\nax.set_xlabel(xlabel = 'Shipping Countries code', fontsize = 16)\nax.set_ylabel(ylabel = 'Count', fontsize = 16)\nplt.show()","6ade05c9":"dxp.bar(x='product_variation_size_id', y='units_sold', data=df_summer, aggfunc='median',figsize=(15,5),sort_values = 'asc',cmap = 'dark12',title='Units Sold by Clothing Size')","6c5b4e40":"plt.figure(figsize = (15, 5))\nax = sns.countplot(x = 'product_variation_size_id', data = df_summer, palette = 'hot')\nax.set_title(label = 'Count of Product Sizes ', fontsize = 20)\nax.set_xlabel(xlabel = 'Product Size', fontsize = 16)\nax.set_ylabel(ylabel = 'Count', fontsize = 16)\nplt.show()","a524ae3a":"club = df_summer.groupby('merchant_name')['units_sold'].mean().reset_index().sort_values('units_sold', ascending=True).tail(40)\nfig = px.bar(\n    club, \n    x=\"units_sold\", \n    y=\"merchant_name\", \n    orientation='h',title='Top Merchants based on Units Sold'\n).show()","4fc4354e":"club_5 = df_summer.groupby('merchant_name')['units_sold'].mean().reset_index().sort_values('units_sold', ascending=True).tail(10)\n","5ace1786":"import plotly.graph_objects as go\n\ncolors = ['darkmagenta',] * 10\ncolors[1] = 'crimson'\n\nfig = go.Figure(data=[go.Bar(\n    x=club_5.merchant_name,\n    y=club_5.units_sold,\n    marker_color=colors\n)])\nfig.update_layout(title_text='Top 10 Merchants')","0e68a012":"fig = px.sunburst(df_summer, path=['merchant_name', 'shipping_option_name'], values='units_sold',\n                  color='shipping_option_name', hover_data=['units_sold'],title='Sunburst for Merchant Info')\nfig.show()","e1f8493b":"dxp.count(val='units_sold', data=df_summer,split='uses_ad_boosts',figsize=(15,5),cmap='portland',title='Units Sold based on Ad Boost')","a9c8c67e":"\ndxp.bar(x='units_sold', y='rating_one_count', data=df_summer, aggfunc='median', \n        x_order='desc',split='product_color',figsize=(15,5),cmap='sunsetdark',title='Lowest Rating for Units Sold')\n","b2279e55":"x = df_summer['price']\ny = df_summer['rating']\nz = df_summer['badges_count']\n\nsns.lineplot(x, y, color = 'r')\nsns.lineplot(x, z, color = 'y')\nplt.title('Price vs Rating vs Badge Counts', fontsize = 20)\nplt.show()","aeef4808":"plt.rcParams['figure.figsize'] = (15, 8)\nsns.heatmap(df_summer.corr(), cmap = 'Pastel1', annot = True)\nplt.title('Heatmap for the Data', fontsize = 20)\nplt.show()","8635ed88":"def data_sampling(dataset, frac: float, random_seed: int):\n    data_sampled_a = dataset.sample(frac=frac, random_state=random_seed)\n    data_sampled_b =  dataset.drop(data_sampled_a.index).reset_index(drop=True)\n    data_sampled_a.reset_index(drop=True, inplace=True)\n    return data_sampled_a, data_sampled_b  ","b71b0fb2":"data, data_unseen = data_sampling(data, 0.8, 42)\nprint(f\"There are {data_unseen.shape[0]} samples for Unseen Data.\")","f183f99d":"data.columns","eea0f656":"plt.style.use('fivethirtyeight')\nplt.figure(figsize=(10,5))\nsns.distplot(data.units_sold, bins=10)\nplt.xlabel('Units Sold')\nplt.title('Distribuition of units sold');","255d9255":"from pycaret.regression import *\nsetup_1 = setup(data=data, target=\"units_sold\", session_id=RANDOM_SEED, ignore_features=[\"title\",\"title_orig\",\"merchant_name\",\"merchant_id\",\"merchant_title\",\"urgency_text\",\"merchant_profile_picture\",\"product_url\",\"product_picture\",\"product_id\",\"tags\",'crawl_month'], normalize=True\n                ,normalize_method='robust', remove_outliers=True,remove_multicollinearity=True,\n                transformation=True,transformation_method = 'yeo-johnson', experiment_name=\"ecom-sales-prediction\",silent=True)","a77bf4d8":"compare_models(fold=5,exclude=['lightgbm'])","f54f70db":"model_metadata = models()\nmodel_metadata['Name']","2d6eeaa0":"model_rf = create_model('rf', fold=5, round=2)\n","7fec9ec9":"model_ext = create_model('et', fold=5, round=2)\n","15d74c7e":"model_cat = create_model('catboost', fold=5, round=2)\n","f5b49752":"tunedmodel_rf = tune_model(model_rf, fold=5)","a99a25fb":"tunedmodel_ext = tune_model(model_ext, fold=5)","2f49887d":"tunedmodel_cat = tune_model(model_cat, fold=5)","518bc179":"blender = blend_models(estimator_list = [tunedmodel_rf, tunedmodel_ext, tunedmodel_cat])","2e9801d8":"plot_model(blender)","00e1ea74":"plot_model(blender,plot='error')","eef935ba":"final_model = finalize_model(blender)\npredictions = predict_model(final_model, data = data_unseen)","1b5dc562":"interpret_model(tunedmodel_ext)","96ac5eeb":"interpret_model(tunedmodel_ext, plot='summary')","61e37704":"interpret_model(tunedmodel_ext, plot='correlation')","8d2a0570":"interpret_model(tunedmodel_ext, plot = 'reason')","3e5600e0":"<a style=\"color:blue;font-size:15px\">Interesting to Analyze that most of orders are shipped through Livraison Standard<\/a>","920b7618":"<h3 class=\"list-group-item list-group-item-action active\">In Depth Exploration of Summer Products Sales<\/h3>\n<h3 class=\"list-group-item list-group-item-action active\"><\/h3>","85048b81":"<a style=\"color:blue;font-size:15px\">greatexpectationstechnology Merchant has higher market share compare to others<\/a>","0245a49e":"<h3 class=\"list-group-item list-group-item-action active\">In Depth Exploration with Pandas Profiling and AutoViz<\/h3>\n<h3 class=\"list-group-item list-group-item-action active\"><\/h3>","dcf417a5":"<a style=\"color:blue;font-size:20px\">Setting up Pycaret Regression Session<\/a> <br>\n<a style=\"color:Red;font-size:15px\">Normalizing Features<\/a> <br>\n<a style=\"color:Red;font-size:15px\">Removing Outliers<\/a> <br>\n<a style=\"color:Red;font-size:15px\">Removing Multicollinearity<\/a> <br>\n<a style=\"color:Red;font-size:15px\">Removing heteroscedasticity <\/a> <br>","548d5476":"<h3 class=\"list-group-item list-group-item-action active\">Predictive Analysis for Summer Product Sales<\/h3>\n<h3 class=\"list-group-item list-group-item-action active\"><\/h3>","c1fc9b58":"<a style=\"color:blue;font-size:15px\"><\/a>","9249d8fe":"<a style=\"color:blue;font-size:15px\">Clothings with Black,White and Green are in Demand for Summer Sales<\/a>","4e1e29ea":"<a style=\"color:blue;font-size:15px\">Ad Boosting Plays a vital role for Summer Sales<\/a>","7dc3e111":"<a style=\"color:blue;font-size:15px\">xiamoi has sold most products as compared to other Merchants<\/a>","027f2f8d":"<a style=\"color:blue;font-size:15px\">L and Clothing for 4-5 years top the Selling in Summer Sales<\/a>","d614ad75":"<h3 class=\"list-group-item list-group-item-action active\">EDA for Summer Products Sales<\/h3>\n<h3 class=\"list-group-item list-group-item-action active\"><\/h3>","a042ab9c":"<img src=\"https:\/\/images.financialexpress.com\/2019\/12\/ecommerce-5.jpg\">\n<img src = \"https:\/\/media.giphy.com\/media\/z2D26GunfUK1W\/giphy.gif\">","ece5d23d":"## Made with \u2764 "}}