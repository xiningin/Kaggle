{"cell_type":{"dd7846ce":"code","d6822594":"code","63c17eac":"code","0b1ac7d3":"code","84d99265":"code","cb53961f":"code","6f4f7ced":"code","7d27d95f":"code","09cd716d":"code","04161214":"code","2e2f429e":"code","7cff1c15":"code","eaa2de3f":"code","4b5db548":"code","cd033d02":"code","e2196dbe":"code","8d6e0916":"code","1f5f50e4":"code","3ef5b0bf":"code","b3c9a4a6":"code","b16e8320":"code","1812b8d4":"code","b34885b5":"code","52236567":"code","eb79523c":"code","34f966f0":"code","feb344cb":"code","9bef1ca6":"code","4d2c41d0":"markdown","f9eb9b40":"markdown","622cc3c9":"markdown","9874c91f":"markdown","7b7777da":"markdown","9a70a280":"markdown","f446bfb6":"markdown","b01c6ad1":"markdown","69893e64":"markdown","57f24a41":"markdown","037fd4d0":"markdown","5ba5ec8b":"markdown","84affc1c":"markdown"},"source":{"dd7846ce":"%reload_ext autoreload\n%autoreload 2\n%matplotlib inline","d6822594":"from pathlib import Path\nfrom fastai.vision import *\nfrom fastai.metrics import error_rate","63c17eac":"#path = untar_data('https:\/\/www.kaggle.com\/techsash\/waste-classification-data', <destination>)","0b1ac7d3":"path = Path('..\/input\/waste-classification-data\/dataset\/DATASET'); \npath","84d99265":"pathTest = path\/'TEST'\npathTrain = path\/'TRAIN'\npathTest.ls()","cb53961f":"numberOfFiles = (pathTest\/'O').ls()\nnumberOfFiles[:5]","6f4f7ced":"data = ImageDataBunch.from_folder(path, ds_tfms=get_transforms(), valid_pct=0.2, size=224).normalize(imagenet_stats)","7d27d95f":"data.show_batch(rows=3, figsize=(7,6))","09cd716d":"print(data.classes)\nlen(data.classes),data.c","04161214":"learn = cnn_learner(data, models.resnet34, metrics=error_rate)","2e2f429e":"learn.fit_one_cycle(4)","7cff1c15":"learn.model_dir = \"\/kaggle\/working\"\nlearn.save('stage-1', return_path=True)","eaa2de3f":"interp = ClassificationInterpretation.from_learner(learn)\n\nlosses,idxs = interp.top_losses()\n\nlen(data.valid_ds)==len(losses)==len(idxs)","4b5db548":"interp.plot_top_losses(9, figsize=(15,11))","cd033d02":"interp.plot_confusion_matrix(figsize=(12,12), dpi=60)","e2196dbe":"interp.most_confused(min_val=2)","8d6e0916":"learn.unfreeze()","1f5f50e4":"learn.fit_one_cycle(1)","3ef5b0bf":"learn.load('stage-1');","b3c9a4a6":"learn.lr_find()","b16e8320":"learn.recorder.plot()","1812b8d4":"learn.unfreeze()\nlearn.fit_one_cycle(2, max_lr=slice(1e-6,1e-4))","b34885b5":"learn.path = Path(\"\/kaggle\/working\")\nlearn.export()","52236567":"testImageList = ImageList.from_folder(pathTest\/'O')\nimage = open_image(testImageList.items[0])\nimage","eb79523c":"model = load_learner(learn.path)\nclassName, label, probability = model.predict(image)","34f966f0":"className","feb344cb":"label","9bef1ca6":"probability","4d2c41d0":"Get in magic commands","f9eb9b40":"Since the loss is reduced, save the model.","622cc3c9":"### Woo Hoo! It's Prediction Time","9874c91f":"## It's Result Time","7b7777da":"## It's Training Time","9a70a280":"### Getting The Data","f446bfb6":"## Train Some More","b01c6ad1":"Finally save your model using the `save()` method.","69893e64":"The following two variables `pathTest` & `pathTrain` contains the train & test subfolders.","57f24a41":"# Deep Learning: A Step-By-Step Guide Using\u00a0Fastai","037fd4d0":"wrap the \"..\/input\" path in an inbuilt method in python known as `Path()` which gives you the representation of the filesystem where your data is saved.","5ba5ec8b":"If you are running this notebook in your local machine or in a cloud server other than kaggle then uncomment the following lines by removing the `#` before these line. ","84affc1c":"Import necessary packages"}}