{"cell_type":{"a9f1711e":"code","3d58b143":"code","a901ad3e":"code","c2046be6":"code","580d8859":"code","06411adc":"code","0628d530":"code","51d7effb":"code","70d5eee9":"code","eb5d3de9":"code","4bb2667e":"markdown","40981385":"markdown","a3f8a3c0":"markdown","04365b7c":"markdown","61c7b266":"markdown"},"source":{"a9f1711e":"import numpy as np\nimport pandas as pd","3d58b143":"def jaccard(str1, str2): \n    a = set(str1.lower().split()) \n    b = set(str2.lower().split())\n    c = a.intersection(b)\n    return float(len(c)) \/ (len(a) + len(b) - len(c))","a901ad3e":"train = pd.read_csv('..\/input\/chaii-hindi-and-tamil-question-answering\/train.csv')\ntrain.head()","c2046be6":"test = pd.read_csv('..\/input\/chaii-hindi-and-tamil-question-answering\/test.csv')\ntest.head()","580d8859":"train.shape, test.shape","06411adc":"train.answer_start.value_counts()","0628d530":"def gen_answers(df):\n    a = []\n    for text in df['context']:\n        tokens = text.split()\n        nums = np.array([x.isnumeric() for x in tokens])\n        i = np.argmax(nums == 1)\n        a.append(' '.join(tokens[i:min(i+2, len(tokens))]))\n\n    return a","51d7effb":"%%time\ntrain_ans = gen_answers(train)\nscore = np.mean([jaccard(y_true, pred) for y_true, pred in zip(train['answer_text'].values, train_ans)])\nprint(f'Average Jaccard Score: {score}')","70d5eee9":"%%time\ntest_ans = gen_answers(test)\nsubmission = test[['id']]\nsubmission['PredictionString'] = test_ans\nsubmission.to_csv('submission.csv', index=False)","eb5d3de9":"submission.head()","4bb2667e":"# Evaluate on train","40981385":"# Metric Function","a3f8a3c0":"# Baseline Static Prediction Generator","04365b7c":"# Prepare Submission","61c7b266":"# Load Data"}}