{"cell_type":{"220128c9":"code","6ca9b939":"code","775d11f7":"code","1ec27c45":"code","45bd0163":"code","ff1ddcf5":"code","f6fb5e7c":"code","5e4ca625":"code","e12d0193":"markdown","9f9f7d1d":"markdown","6b0081ef":"markdown","b2398f70":"markdown","bc64c080":"markdown","fc8b4c5b":"markdown","fc0a6a45":"markdown"},"source":{"220128c9":"!pip -q install autokeras","6ca9b939":"import autokeras\nimport numpy as np\nimport pandas as pd\nimport tensorflow as tf\nfrom tensorflow.keras.models import load_model","775d11f7":"train = pd.read_csv(\"\/kaggle\/input\/nlp-getting-started\/train.csv\")\ntrain.head()","1ec27c45":"test = pd.read_csv(\"\/kaggle\/input\/nlp-getting-started\/test.csv\")\ntest.head()","45bd0163":"batch_size = 64\ntrain_ds = tf.data.Dataset.from_tensor_slices((train[\"text\"], train[\"target\"])).batch(batch_size).cache()\nclassifier = autokeras.TextClassifier(\n    num_classes=2,\n    max_trials=1,\n    objective=\"val_loss\",\n    directory=\"tweet\",\n    seed=42\n)\nclassifier.fit(train_ds, epochs=10, validation_split=0.2)","ff1ddcf5":"model = classifier.export_model()\nmodel.save(\"model.h5\")","f6fb5e7c":"loaded_model = load_model(\"model\", custom_objects=autokeras.CUSTOM_OBJECTS)","5e4ca625":"test_ds = tf.data.Dataset.from_tensor_slices((test[\"text\"])).batch(batch_size)\nresult = np.array(loaded_model.predict(test_ds) > 0.5, dtype=int).reshape(-1)\nsubmission = pd.read_csv(\"\/kaggle\/input\/nlp-getting-started\/sample_submission.csv\")\nsubmission[\"target\"] = result\nsubmission.to_csv(\"submission.csv\", index=False)\nsubmission.head()","e12d0193":"## Disaster Tweets Classification with AutoKeras\nIn this notebook, I will build a Disaster Tweets Classifier using autokeras. You can learn more about it from https:\/\/autokeras.com.","9f9f7d1d":"## Setup","6b0081ef":"## Export best Model","b2398f70":"## Submission","bc64c080":"## Import datatset","fc8b4c5b":"## Modeling","fc0a6a45":"## Load Model"}}