{"cell_type":{"a80b9494":"code","4462ec43":"code","081f5769":"code","c26dd847":"code","6d2bc834":"code","265670e8":"code","c136efc8":"code","132e0894":"code","46ae59b7":"code","1d8bd2aa":"code","22f6a934":"code","e519a99e":"code","afc94d08":"code","67eda6f6":"code","766a7a79":"code","a085c66b":"code","b3a280f1":"code","f53fdc07":"code","07beb25c":"code","1f8396ba":"code","3be35503":"code","c2ec5882":"code","916f52ba":"code","5bdc7501":"code","0ec0fd5d":"code","820fcce1":"code","fb88c851":"code","e10a6d3d":"code","16f00343":"code","7ebb9dec":"code","7e55fd48":"code","e8537b0b":"code","9b89df51":"code","cd534ad4":"code","3c68c53f":"code","fce11c2e":"code","38b1e1a4":"code","0114892f":"code","f5e5f9ba":"code","d8e7bc38":"code","1439b986":"code","c491bfd2":"code","5aa961d5":"code","6603e035":"code","8d4e6ab1":"code","4831dd69":"code","5bf6909a":"code","658459c4":"code","407032eb":"code","17346558":"code","9f71c330":"code","9ec2aef9":"code","e61851bf":"code","b40af0cf":"markdown","f8b536b2":"markdown","e04a3efd":"markdown","31d3ac75":"markdown","bf217687":"markdown","7c81d73c":"markdown","b58716b2":"markdown","c1fb48b4":"markdown","be958278":"markdown","e3a43609":"markdown","6b1971f4":"markdown","8c7b9eb5":"markdown","182ee975":"markdown","9c1a94a9":"markdown","cd91a055":"markdown","f0ba270e":"markdown","fe446891":"markdown","50566fc0":"markdown","69de5bd4":"markdown","062630b4":"markdown","69a11e7a":"markdown","8683930a":"markdown","deb231c4":"markdown","3adc9682":"markdown","4974d4b9":"markdown","d82b1243":"markdown","3c3df084":"markdown","19e96799":"markdown","10962897":"markdown","9e50de1f":"markdown","d708bd99":"markdown","78363292":"markdown","887a1884":"markdown","c798d4bf":"markdown","f2d5109e":"markdown","0f0d1922":"markdown","ad50f0d2":"markdown","aef97808":"markdown","958c3338":"markdown","b5fe90a0":"markdown","1258273c":"markdown","3750a331":"markdown","8c402bbb":"markdown","ca93999f":"markdown","d12cdde3":"markdown","c8a9e59b":"markdown","bb3f8e91":"markdown","bd234978":"markdown","f0dba3ad":"markdown","40d22d05":"markdown","8f6ed9b0":"markdown","6d2177bc":"markdown","f2eb57eb":"markdown","7c087bd6":"markdown","24f0e813":"markdown","527b4615":"markdown","61947616":"markdown","0e5b934f":"markdown","9b441615":"markdown","d095ffeb":"markdown"},"source":{"a80b9494":"# zipfile module to work on zip file\nfrom zipfile import ZipFile\n\nimport pandas as pd\nfrom pprint import pprint\nfrom matplotlib import pyplot as plt\nimport seaborn as sns\nimport numpy as np\nfrom bokeh.io import output_notebook, show\nfrom bokeh.models import ColumnDataSource, FactorRange\nfrom bokeh.plotting import figure\nfrom bokeh.transform import factor_cmap","4462ec43":"#with ZipFile('human-resources-data-set.zip', 'r') as zipf:\n    # print all contents of zip file\n    #zipf.printdir()\n    # extracting all the files\n    #zipf.extractall()","081f5769":"df = pd.read_csv('..\/input\/human-resources-data-set\/HRDataset_v13.csv')\ndf.head()","c26dd847":"df.info()","6d2bc834":"df.dropna(how = 'all', axis = 0, inplace=True)","265670e8":"df['DateofTermination'].unique()","c136efc8":"print('Number of null values in TermReason column:')\nprint(df['TermReason'].isnull().sum())\n    \ndf['TermReason'].value_counts()","132e0894":"df[['DateofTermination', 'TermReason']].head(10)","46ae59b7":"df[df['DateofTermination'].notnull()]['TermReason'].unique().tolist()","1d8bd2aa":"print('Number of job leaves without any reason:')\ndf[df['DateofTermination'].notnull()]['TermReason'].isnull().sum()","22f6a934":"print(df[df['DateofTermination'].isnull()]['TermReason'].value_counts())\nprint('\\n Number of employees whose DateofTermination and TermReason are both unknown:')\ndf[df['DateofTermination'].isnull()]['TermReason'].isnull().sum()","e519a99e":"df.ManagerID.unique()","afc94d08":"df.ManagerName.unique()","67eda6f6":"mng = df[['ManagerID', 'ManagerName']]","766a7a79":"mng_id = list(df.ManagerID.unique())\ndef check_mng(dataframe):\n    for i in mng_id:\n        print('ManagerID: ' + str(i) + '...' + str(dataframe[dataframe['ManagerID'] == i]['ManagerName'].unique().tolist()))\n    # since there is NaN value, let's write a code to this this case specifically\n    print('ManagerID: ' + 'nan' + '...' + str(dataframe[dataframe['ManagerID'].isnull()]['ManagerName'].unique().tolist()))\ncheck_mng(mng)","a085c66b":"# replace NaN value in ManagerID by 39\ndf.ManagerID.fillna(39.0, inplace = True)","b3a280f1":"df[df.ManagerName == 'Brandon R. LeBlanc'][['ManagerID', 'Department']]","f53fdc07":"df.ManagerID.replace(3.0, 1.0, inplace = True)","07beb25c":"df[df.ManagerName == 'Michael Albert'][['ManagerID', 'Department']]","1f8396ba":"df.ManagerID.replace(30.0, 22.0, inplace = True)","3be35503":"df.ManagerID.unique()","c2ec5882":"df[['LastPerformanceReview_Date', 'DaysLateLast30']].head(10)","916f52ba":"df[df.LastPerformanceReview_Date.isnull()].DaysLateLast30.unique()","5bdc7501":"print('Number of employees with no LastPerformanceReview_Date:')\ndf.LastPerformanceReview_Date.isnull().sum()","0ec0fd5d":"df[df.LastPerformanceReview_Date.isnull()].DateofTermination.unique()","820fcce1":"df.select_dtypes('float').head(10)","fb88c851":"df.select_dtypes('float').columns","e10a6d3d":"# select the columns that I want to convert float values into integer values\ncols = ['EmpID', 'MarriedID', 'MaritalStatusID', 'GenderID', 'EmpStatusID',\n       'DeptID', 'PerfScoreID', 'FromDiversityJobFairID', 'Termd',\n       'PositionID', 'Zip', 'ManagerID', 'SpecialProjectsCount', 'DaysLateLast30']","16f00343":"for col in cols:\n    df[col] = df[col].astype('Int32')","7ebb9dec":"df.head()","7e55fd48":"# get rid of space in Department and Sex values\ndf.Sex = df.Sex.apply(lambda x: x.strip())\ndf.Department = df.Department.apply(lambda x: x.strip())","e8537b0b":"emp = df[df.DateofTermination.isnull()]\nemp.shape","9b89df51":"print('PayRate count based on Sex and Department')\npd.pivot_table(emp[['Sex', 'Department', 'PayRate']], index=['Sex'],\n                    columns=['Department'], values = ['PayRate'], aggfunc=lambda x: int(len(x)))","cd534ad4":"print('PayRate mean based on Sex and Department')\npr = pd.pivot_table(emp[['Sex', 'Department', 'PayRate']], index=['Sex'],\n                    columns=['Department'], values = ['PayRate'], aggfunc=np.mean)\npr","3c68c53f":"# PLOT\nplt.figure(figsize=(10,5))\nbplot=sns.stripplot(y='PayRate', x='Department', data=emp, jitter=True, dodge=True, marker='o', alpha=0.8, hue='Sex')\nbplot.legend(loc='upper left')\n\nplt.xticks(rotation=60, horizontalalignment='right');","fce11c2e":"print('PerfScoreID mean based on Sex and Department')\npfm = pd.pivot_table(emp[['Sex', 'Department', 'PerfScoreID']], index=['Sex'],\n                    columns=['Department'], values = ['PerfScoreID'], aggfunc=np.mean)\npfm","38b1e1a4":"# PLOT\nplt.figure(figsize=(10,4))\nswarm=sns.swarmplot(y='PerfScoreID', x='Department', data=emp, dodge=True, marker='o', alpha=0.8, hue='Sex')\nswarm.legend(loc='lower right', ncol = 2)\n\nplt.xticks(rotation=60, horizontalalignment='right');","0114892f":"df.PerfScoreID.unique()","f5e5f9ba":"df.PerformanceScore.unique()","d8e7bc38":"perf = df[['PerfScoreID', 'PerformanceScore']]\nperf.head(10)","1439b986":"def check_perf(dataframe):\n    for i in range(1,5):\n        print(dataframe[dataframe['PerfScoreID'] == i]['PerformanceScore'].unique().tolist())\ncheck_perf(perf)","c491bfd2":"perf4 = emp[emp.PerfScoreID == 4].groupby('Department').count()['EmpID']\nperf4","5aa961d5":"per_dep = emp.groupby('Department').count()['EmpID']","6603e035":"percent = pd.merge(perf4, per_dep, on='Department', how='left', suffixes=('_count_perf4', '_count'))\npercent['Percentage'] = percent.apply(lambda row: row.EmpID_count_perf4\/row.EmpID_count*100, axis = 1) \npercent","8d4e6ab1":"print('EngagementSurvey mean based on Sex and Department')\neng_s = pd.pivot_table(emp[['Sex', 'Department', 'EngagementSurvey']], index=['Sex'],\n                    columns=['Department'], values = ['EngagementSurvey'], aggfunc=np.mean)\neng_s","4831dd69":"# PLOT\nplt.figure(figsize=(10,5))\nsns.set(style=\"ticks\", palette=\"pastel\")\n\nbox = sns.boxplot(x=\"Department\", y=\"EngagementSurvey\",\n            hue=\"Sex\", palette=[\"m\", \"g\"],\n            data=emp)\nsns.despine(offset=10, trim=True)\nbox.legend(loc='lower right', ncol = 2)\n\nplt.xticks(rotation=60, horizontalalignment='right');","5bf6909a":"print('EmpSatisfaction mean based on Sex and Department')\nemp_s = pd.pivot_table(emp[['Sex', 'Department', 'EmpSatisfaction']], index=['Sex'],\n                    columns=['Department'], values = ['EmpSatisfaction'], aggfunc=np.mean)\nemp_s","658459c4":"df.EmpSatisfaction.unique()","407032eb":"# PLOT\nplt.figure(figsize=(10,4))\nsns.set(style=\"whitegrid\", palette=\"pastel\", color_codes=True)\nviolin = sns.violinplot(x=\"Department\", y=\"EmpSatisfaction\", hue=\"Sex\",\n               split=True,\n               palette={\"F\": \"y\", \"M\": \"b\"},\n               data=emp, scale = 'count')\nsns.despine(left=True)\nviolin.legend(loc='upper right', ncol = 2)\nviolin.set_xticklabels(violin.get_xticklabels(), rotation=45, horizontalalignment='right');","17346558":"corr = df[['PayRate', 'PerfScoreID', 'EngagementSurvey', 'EmpSatisfaction']].corr()\ncorr","9f71c330":"f, ax = plt.subplots(figsize=(5, 4))\nsns.heatmap(corr, cmap='Accent');","9ec2aef9":"emp.RaceDesc.value_counts(normalize = True)","e61851bf":"print('PayRate count based on Race and Department')\npd.pivot_table(emp[['RaceDesc', 'Department', 'PayRate']], index=['RaceDesc'],\n                    columns=['Department'], values = ['PayRate'], aggfunc=lambda x: int(len(x)))","b40af0cf":"#### Among 207 employees that are still in the company, how their payrate varies?","f8b536b2":"#### All Manager IDs that are NaN are assigned to only one person: Webster Butler, but he already has another ManagerID which is 39. Let's address this issue by replacing NaN by 39.\n#### We get two ManagerID for Brandon R. LeBlanc: 1 and 3; and for Michael Albert: 22 and 30. Maybe each one has two ManagerID since they are Manager of two different departments? Let's check.","e04a3efd":"#### In this notebook, I will do a profound data exploration since I am curious about all aspects of the data, especially this dataset has upto 35 columns.\n#### Data Visualization in this notebook is created using seaborn & bokeh.\n#### Now, let's get started!!","31d3ac75":"#### How about when DateofTermination is NaN? What is written in TermReason?","bf217687":"#### Interesting! While men and women in Production and Sales are paid at same pay rate, men has slightly higher pay in IT and in Admin Offices than women. In contrast, women in software engineering get much better pay that men.\n#### There is a NaN value in Executive Office since the CEO is a woman.\n\n#### Let's do the same with Performance.","7c81d73c":"### ManagerID","b58716b2":"#### Next, let's check Michael Albert's case:","c1fb48b4":"#### Next, let's check Engagement Survey","be958278":"#### OK, so employees with no DateofTermination either are still employed or have not yet started.\n\n#### Next, let's explore ManagerID","e3a43609":"### DateofTermination & TermReason","6b1971f4":"#### Apart of sex, race is another interesting category to investigate. Let's dive into this.","8c7b9eb5":"#### I start with DateofTermination and TermReason. ","182ee975":"### Payrate","9c1a94a9":"#### After checking several metrics based on sex and department, I would like to see if these metrics are correlated to each other.","cd91a055":"#### Perfect!\n#### As I stated earlier, almost all columns have 310 non-null values, except some such as: DateofTermination, TermReason, ManagerID, LastPerformanceReview_Date, DaysLateLast30. Let's explore them further to understand why?","f0ba270e":"### Correlation between payrate, performance, engagement survey, employee satisfaction","fe446891":"#### 103 employees has no LastPerformanceReview_Date. How about their DateofTermination?","50566fc0":"#### First impression: an employee who has no LastPerformanceReview_Date has no value in DaysLateLast30 column. Let's verify this.","69de5bd4":"### LastPerformanceReview_Date and DaysLateLast30","062630b4":"#### I would like to check how payrate, performance, engagement survey and employee satisfaction varies upon sex and department. I first need to extract only employees that are still employed.","69a11e7a":"#### Let's explore each column with numeric values one by one. But first, I need to convert float values to integer.\n","8683930a":"#### What are columns that contain float values?","deb231c4":"#### OK, the percentages show that each department (IT\/IS, Production and Software Engineering) has approximately same ratio of outstanding employees.","3adc9682":"#### I assume that 1 = 'PIP', 2 = 'Needs Improvement', 3 = 'Fully Meets', 4 = 'Exceeds' but let's verify this.","4974d4b9":"\n#### Finally, since LastPerformanceReview_Date and DaysLateLast30 have same number of NaN values, let's explore them together.","d82b1243":"#### Same issue, I will replace 30 by 22:","3c3df084":"#### So this case is classical, some values are there and some are NaN. However, if I check ManagerName column, I don't have any null values. Let's check these two columns together.\n","19e96799":"## Payrate, performance, engagement survey, employee satisfaction (based on sex and department)","10962897":"#### Although almost employees are still employed, we have several different reasons for a leave.","9e50de1f":"#### Woah, production employees really stand out. But how about the percentage against each department's number of employees?","d708bd99":"#### The majority are white. 1\/5 are black or African American. Hispanic is minority.","78363292":"### Engagement Survey","887a1884":"## Payrate, performance, engagement survey, employee satisfaction (based on race and department)","c798d4bf":"#### What I can see here is the CEO is a white woman.","f2d5109e":"#### Let's write a function to do this","0f0d1922":"#### Great! My hypothesis is confirmed. Whenever an employee has no LastPerformanceReview_Date, he also has no value in DaysLateLast30 column. This is logical, and data is consistent on this point.\n#### I want also to see what is DateofTermination of those employees.\n#### Let's get the number of employees with no LastPerformanceReview_Date first.","ad50f0d2":"#### Let's check first each race's proportion in this company.","aef97808":"#### Interesting again:\n\n#### - In Admin offices, Performance Score are same for men and women, while pay rate has discrepancy as saw earlier.\n#### - In Software Engineering, while Men has better Performance Score than Women, they are being less paid. Note also that there are 2 men in Software Engineering against 5 women.\n\n#### Let's check data consistency between PerfScoreID and PerformanceScore.","958c3338":"#### Let's check whether ManagerID issue is addressed correctly:","b5fe90a0":"#### OK for some leaves, I don't have any reason, seeing the NaN value's presence. But I believe this is not much, let's check:","1258273c":"#### Perfect! So all 103 employees with no LastPerformanceReview_Date had already quit the company. which is logical: Our data is consistent.","3750a331":"#### Brandon R. LeBlanc is Admin Offices's manager but he is assigned with 2 ManagerID. 3 might be a mistake. I will correct this and assign only one ManagerID (1) to him.","8c402bbb":"# Data Exploration","ca93999f":"## Check null values","d12cdde3":"#### Since DateofTerminaison and TermReason are related, I need to check:\n\n#### - Whenever DateofTerminaison has a date value, is TermReason fulfilled?\n\n#### - Whenever DateofTerminaison is NaN, what is written in TermReason?\n\n#### Let's dive into this.","c8a9e59b":"# to be continued","bb3f8e91":"#### One category of Performance that has all my attention is 'Exceeds'. I want to know who are these people and what is their payrate?","bd234978":"#### The CEO has highest engagement survey, no surprise, right?\n#### In Software Engineering, men has higher Engagement Survey than women, but they get less pay.\n#### In contrast, in Admin Offices, women has higher Engagement Survey than Men, while they are less paid.\n#### In Sales, women also has higher Engagement Survey than Men, but they get same pay.","f0dba3ad":"# Data Analysis","40d22d05":"#### I have here quite low correlations, except EmpSatisfaction & PerfScoreID with correlation score 0.31, this is logical.","8f6ed9b0":"#### Employee Satisfaction are measured from 1 to 5, I guess 5 is highest satisfaction level.\n#### The CEO has neutral opinion: she is not very satisfied, not unsatisfied.\n#### Men in Admin Offices has quite higher level of satisfaction than women.\n#### In other areas, Employee Satisfaction is quite same for men and for women.","6d2177bc":"#### Let's splot these correlations in a heatmap","f2eb57eb":"# Import modules","7c087bd6":"## Address float values","24f0e813":"### Employee Satisfaction","527b4615":"#### This dataframe has 401 rows while almost all columns have upto 310 non-null values. Let's drop rows that contain null values","61947616":"#### DateofTermination has 2 kinds of values: first one with date and second one with NaN. A date indicates when the employee quit his job and when this date is not available, a NaN value is on. How about TermReason column?","0e5b934f":"### Performance","9b441615":"#### I divide data exploration into 2 parts:\n\n#### - Check null values\n#### - Address float values","d095ffeb":"#### Here I can see that some columns must remain integer such as PayRate, EngagementSurvey and EmpSatisfaction. Let's convert the other:"}}