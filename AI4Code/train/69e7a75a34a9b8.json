{"cell_type":{"6e0428b1":"code","425a6010":"code","21e51d67":"code","89dd905b":"code","8c810240":"code","d904975d":"code","d269f66f":"code","966e49d0":"code","861a513d":"code","2483d2b8":"code","f93a3e7e":"code","a372716c":"code","49df783c":"code","17556e21":"code","605e76a4":"code","512a0c8d":"code","33f2cec3":"code","e6c02848":"code","a25238e5":"code","ee6a4b9a":"code","1f6c87cc":"code","720a779e":"code","24fdf346":"code","ca997862":"code","c25929f5":"code","d0949010":"code","3cbc2fc8":"code","77116f05":"code","be762b39":"code","b48ae4f3":"code","12d27356":"code","e9809bda":"code","48a80a0a":"code","860e7084":"code","ccd0cccb":"code","43d60ee3":"code","7d824586":"code","e553f541":"code","12145ecf":"code","1470b832":"code","0d6e63de":"code","9fc0bd93":"code","88dcb041":"code","00cc808c":"code","cdf75ad3":"code","89a8b4c9":"code","3f5b6528":"code","19a96abc":"code","31c823ef":"code","1b83aab5":"code","0cff3722":"code","aa06b1e6":"code","cddaa905":"code","6b6e1657":"code","a0a429a8":"code","2d1ac869":"code","3a533e3b":"code","104023bd":"code","e44b3e7c":"code","f26d6a6f":"code","2d158b6c":"code","d59fdbe7":"code","cf3628c2":"code","a9220eef":"code","076c15a0":"code","79406e56":"code","78dedb76":"code","1c315a41":"markdown","7d32fc1e":"markdown","9a989172":"markdown","6ef022f9":"markdown","ebedfde4":"markdown","b1f3ad8e":"markdown","5ab27f74":"markdown","d6ddb093":"markdown","f8111158":"markdown","fa4d6c6f":"markdown","15c527b2":"markdown","0d0dddd0":"markdown","18b9a8c9":"markdown","1abd84d7":"markdown","6adffacf":"markdown","7dba4921":"markdown","74250beb":"markdown","d83a4e44":"markdown","c545531f":"markdown","7a4cf922":"markdown","1a598150":"markdown","a0c4c110":"markdown","ddd17e9a":"markdown","23db7289":"markdown"},"source":{"6e0428b1":"import os\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline","425a6010":"train_data = pd.read_csv('..\/input\/titanic\/train.csv')\ntrain_data.head(10)","21e51d67":"test_data = pd.read_csv('..\/input\/titanic\/test.csv')\ntest_data.head(10)","89dd905b":"train_data.shape","8c810240":"test_data.shape","d904975d":"train_data.info()","d269f66f":"test_data.info()","966e49d0":"# Checking Missing values in train_data\ntrain_data.isnull().sum()","861a513d":"# Checking Missing values in test_data\ntest_data.isnull().sum()","2483d2b8":"train_data.columns","f93a3e7e":"train_data.head()","a372716c":"test_data.head()","49df783c":"train_data['Age'] = train_data['Age'].fillna(train_data['Age'].mean())\ntest_data['Age'] = test_data['Age'].fillna(test_data['Age'].mean())","17556e21":"train_data.isnull().sum()","605e76a4":"test_data.isnull().sum()","512a0c8d":"sns.catplot(x = 'Embarked', kind = 'count', data = train_data)","33f2cec3":"train_data['Embarked'] = train_data['Embarked'].fillna(\"S\")","e6c02848":"train_data.isnull().sum()","a25238e5":"train_data['Cabin'] = train_data['Cabin'].fillna(\"Missing\")\ntest_data['Cabin'] = test_data['Cabin'].fillna(\"Missing\")","ee6a4b9a":"train_data.isnull().sum()","1f6c87cc":"test_data.isnull().sum()","720a779e":"test_data['Fare'] = test_data['Fare'].median()","24fdf346":"train_data.isnull().sum()","ca997862":"test_data.isnull().sum()","c25929f5":"## get dummy variables for Column sex and embarked since they are categorical value.\ntrain_data = pd.get_dummies(train_data, columns=[\"Sex\"], drop_first=True)\ntrain_data = pd.get_dummies(train_data, columns=[\"Embarked\"],drop_first=True)\n\n\n#Mapping the data.\ntrain_data['Fare'] = train_data['Fare'].astype(int)\ntrain_data.loc[train_data.Fare<=7.91,'Fare']=0\ntrain_data.loc[(train_data.Fare>7.91) &(train_data.Fare<=14.454),'Fare']=1\ntrain_data.loc[(train_data.Fare>14.454)&(train_data.Fare<=31),'Fare']=2\ntrain_data.loc[(train_data.Fare>31),'Fare']=3\n\ntrain_data['Age']=train_data['Age'].astype(int)\ntrain_data.loc[ train_data['Age'] <= 16, 'Age']= 0\ntrain_data.loc[(train_data['Age'] > 16) & (train_data['Age'] <= 32), 'Age'] = 1\ntrain_data.loc[(train_data['Age'] > 32) & (train_data['Age'] <= 48), 'Age'] = 2\ntrain_data.loc[(train_data['Age'] > 48) & (train_data['Age'] <= 64), 'Age'] = 3\ntrain_data.loc[train_data['Age'] > 64, 'Age'] = 4","d0949010":"## get dummy variables for Column sex and embarked since they are categorical value.\ntest_data = pd.get_dummies(test_data, columns=[\"Sex\"], drop_first=True)\ntest_data = pd.get_dummies(test_data, columns=[\"Embarked\"],drop_first=True)\n\n\n#Mapping the data.\ntest_data['Fare'] = test_data['Fare'].astype(int)\ntest_data.loc[test_data.Fare<=7.91,'Fare']=0\ntest_data.loc[(test_data.Fare>7.91) &(test_data.Fare<=14.454),'Fare']=1\ntest_data.loc[(test_data.Fare>14.454)&(test_data.Fare<=31),'Fare']=2\ntest_data.loc[(test_data.Fare>31),'Fare']=3\n\ntest_data['Age']=test_data['Age'].astype(int)\ntest_data.loc[ test_data['Age'] <= 16, 'Age']= 0\ntest_data.loc[(test_data['Age'] > 16) & (test_data['Age'] <= 32), 'Age'] = 1\ntest_data.loc[(test_data['Age'] > 32) & (test_data['Age'] <= 48), 'Age'] = 2\ntest_data.loc[(test_data['Age'] > 48) & (test_data['Age'] <= 64), 'Age'] = 3\ntest_data.loc[test_data['Age'] > 64, 'Age'] = 4","3cbc2fc8":"# In our data the Ticket and Cabin,Name are the base less,leds to the false prediction so Drop both of them.\ntrain_data.drop(['Ticket','Cabin','Name'],axis=1,inplace=True)\ntest_data.drop(['Ticket','Cabin','Name'],axis=1,inplace=True)","77116f05":"train_data.describe()","be762b39":"train_data.Survived.value_counts()\/len(train_data)*100\n#This signifies almost 61% people in the ship died and 38% survived.","b48ae4f3":"train_data.groupby(\"Survived\").mean()","12d27356":"train_data.groupby(\"Sex_male\").mean()","e9809bda":"train_data.corr()","48a80a0a":"#Heatmap\nplt.subplots(figsize=(10,8))\nsns.heatmap(train_data.corr(),annot=True,cmap='Blues_r')\nplt.title(\"Correlation Among Variables\", fontsize = 20);","860e7084":"sns.barplot(x=\"Sex_male\",y=\"Survived\",data=train_data)\nplt.title(\"Gender Distribution - Survived\", fontsize = 16)","ccd0cccb":"sns.barplot(x='Pclass',y='Survived',data=train_data)\nplt.title(\"Passenger Class Distribution - Survived\", fontsize = 16)","43d60ee3":"from sklearn.metrics import accuracy_score, log_loss\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.svm import SVC\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.model_selection import train_test_split\nfrom sklearn import metrics","7d824586":"X = train_data.drop(['Survived'], axis=1)\ny = train_data[\"Survived\"]\nX_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.22, random_state = 5)","e553f541":"print(len(X_train),len(X_test),len(y_train),len(y_test))","12145ecf":"#Logistic Regression\nlogReg = LogisticRegression()\nlogReg.fit(X_train,y_train)","1470b832":"logReg_predict = logReg.predict(X_test)\nlogReg_score = logReg.score(X_test,y_test)\n# print(\"Logistic Regression Prediction :\",logReg_predict)\nprint(\"Logistic Regression Score :\",logReg_score)","0d6e63de":"print(\"Accuracy Score of Logistic Regression Model:\")\nprint(metrics.accuracy_score(y_test,logReg_predict))\nprint(\"\\n\",\"Classification Report:\")\nprint(metrics.classification_report(y_test,logReg_predict),'\\n')","9fc0bd93":"SVC_model = SVC(probability=True)\nSVC_model.fit(X_train,y_train)","88dcb041":"SVC_predict = SVC_model.predict(X_test)\nSVC_score = SVC_model.score(X_test,y_test)\n#print(\"Support Vector Classifier Prediction :\",SVC_predict)\nprint(\"Support Vector Classifier Score :\",SVC_score)","00cc808c":"print(\"Accuracy Score of Support Vector Classifier SVC Model:\")\nprint(metrics.accuracy_score(y_test,SVC_predict))\nprint(\"\\n\",\"Classification Report:\")\nprint(metrics.classification_report(y_test,SVC_predict),'\\n')","cdf75ad3":"decisionTreeModel = DecisionTreeClassifier(max_leaf_nodes=17, random_state=0)\ndecisionTreeModel.fit(X_train, y_train)","89a8b4c9":"decisionTree_predict = decisionTreeModel.predict(X_test)\ndecisionTree_score = decisionTreeModel.score(X_test,y_test)\n#print(\"Decision Tree Classifier Prediction :\",len(decisionTree_predict))\nprint(\"Decision Tree Classifier Score :\",decisionTree_score)","3f5b6528":"print(\"Accuracy Score of Decision Tree Classifier Model:\")\nprint(metrics.accuracy_score(y_test,decisionTree_predict))\nprint(\"\\n\",\"Classification Report:\")\nprint(metrics.classification_report(y_test,decisionTree_predict),'\\n')","19a96abc":"Random_forest = RandomForestClassifier(n_estimators=17)\nRandom_forest.fit(X_train,y_train)","31c823ef":"randomForest_predict = Random_forest.predict(X_test)\nrandomForest_score = Random_forest.score(X_test,y_test)\n# print(\"Random Forest Prediction :\",RF_predict)\nprint(\"Random Forest Score :\",randomForest_score)","1b83aab5":"print(\"Accuracy Score of Random Forest Classifier Model:\")\nprint(metrics.accuracy_score(y_test,randomForest_predict))\nprint(\"\\n\",\"Classification Report:\")\nprint(metrics.classification_report(y_test,randomForest_predict),'\\n')","0cff3722":"KNN_model = KNeighborsClassifier(n_neighbors=37)\nKNN_model.fit(X_train, y_train)","aa06b1e6":"KNN_predict = KNN_model.predict(X_test)\nKNN_score = KNN_model.score(X_test,y_test)\n#print(\"KNN Classifier Prediction :\",KNN_predict)\nprint(\"KNN Classifier Score :\",KNN_score)","cddaa905":"print(\"Accuracy Score of KNN Model:\")\nprint(metrics.accuracy_score(y_test,KNN_predict))\nprint(\"\\n\",\"Classification Report:\")\nprint(metrics.classification_report(y_test,KNN_predict),'\\n')","6b6e1657":"from sklearn.ensemble import GradientBoostingClassifier\n\ngbk = GradientBoostingClassifier(random_state=101, n_estimators=150,min_samples_split=100, max_depth=6)\ngbk.fit(X_train, y_train)","a0a429a8":"gbk_predict = gbk.predict(X_test)\ngbk_score = gbk.score(X_test,y_test)\n#print(\"Gradient Boosting Prediction :\",gbk_predict)\nprint(\"Gradient Boosting Score :\",gbk_score)","2d1ac869":"print(\"Accuracy Score of Gradient Boosting Model:\")\nprint(metrics.accuracy_score(y_test,gbk_predict))","3a533e3b":"from sklearn import ensemble\nfrom sklearn.model_selection import GridSearchCV","104023bd":"GridList =[ {'n_estimators' : [10, 15, 20, 25, 30, 35, 40], 'max_depth' : [5,10,15, 20]},]\nrandomForest_ensemble = ensemble.RandomForestClassifier(random_state=31, max_features= 3)\ngridSearchCV = GridSearchCV(randomForest_ensemble,GridList, cv = 5)","e44b3e7c":"gridSearchCV.fit(X_train,y_train)","f26d6a6f":"gridSearchCV_predict = gridSearchCV.predict(X_test)\ngridSearchCV_score = gridSearchCV.score(X_test,y_test)\n#print(\"Grid SearchCV Prediction :\",gridSearchCV_predict)\nprint(\"Grid SearchCV Score :\",gridSearchCV_score)","2d158b6c":"from tabulate import tabulate","d59fdbe7":"print(tabulate([['K-Nearest Neighbour', KNN_score],['Logistic Regression',logReg_score ],['Decision Tree',decisionTree_score ],['Random Forest',randomForest_score ],['SVC', SVC_score],['Gradient Boosting', gbk_score],['Grid SearchCV',gridSearchCV_score]], headers=['Model Algorithm', 'Score']))","cf3628c2":"test_data.head()","a9220eef":"#set ids as PassengerId and predict survival \nids = test_data['PassengerId']\nprint(len(ids))\npredictions = gridSearchCV.predict(test_data)","076c15a0":"#set the output as a dataframe and convert to csv file named submission.csv\noutput = pd.DataFrame({ 'PassengerId' : ids, 'Survived': predictions })","79406e56":"output.head(10) # Output preview","78dedb76":"output.to_csv('submission.csv', index=False) # Submission csv file","1c315a41":"## Decision Tree Classifier","7d32fc1e":"### Check Missing Values ","9a989172":"#### No missing values left so we can proceed further","6ef022f9":"### Modeling Data \n###### I will be modelling the data with the below models:\n- Logistic Regression\n- Support Vector Machine\n- Decision Tree Classifier\n- Random Forest Classifier\n- K-Nearest Neighbour Classifier\n- Gradient Boosting\n- Grid SearchCV","ebedfde4":"### Correlation between Variables","b1f3ad8e":"- Survived has positive correlation of 0.3 with Fare\n- Sex and survived have negative correlation of -0.54\n- Pclass and Survived have negative correlation of -0.34**","5ab27f74":"I will keep updating the notebook with updates\n\n**If you have any recommendations and suggestions, please share in the comments below !!**\n\nLooking forward to know your views and suggestions :)\n\n**If you feel the notebook is worth it, UPVOTE !!**\n\n**Thanks for reading :)**","d6ddb093":"### Load the Data ","f8111158":"### Load Helpful Packages","fa4d6c6f":"### Gradient Boosting","15c527b2":"##### Female passengers have survived more than male passengers i.e Females and Children would have been the priority","0d0dddd0":"## Prediction\n\n#### Let's use the Gradient Boosting Classifier to predict our data","18b9a8c9":" #### The points to know from the analysis\n #### 1. 38% of people survived\n #### 2. 74% of Females survived and ~19% of Males survived ","1abd84d7":"### From the above table, we can clearly see that the accuracy of the Grid SearchCV is Better\n\n#### Lets apply this to our test data","6adffacf":"# Kaggle - Titanic: Machine Learning from Disaster\n\nThe competition details as below\n\n### The Challenge\n\nThe sinking of the Titanic is one of the most infamous shipwrecks in history.\n\nOn April 15, 1912, during her maiden voyage, the widely considered \u201cunsinkable\u201d RMS Titanic sank after colliding with an iceberg. Unfortunately, there weren\u2019t enough lifeboats for everyone onboard, resulting in the death of 1502 out of 2224 passengers and crew.\n\nWhile there was some element of luck involved in surviving, it seems some groups of people were more likely to survive than others.\n\nIn this challenge, we ask you to build a predictive model that answers the question: \u201cwhat sorts of people were more likely to survive?\u201d using passenger data (ie name, age, gender, socio-economic class, etc). \n\n### Predicting the survival on the Titanic","7dba4921":"## Exploratory Data Analysis ","74250beb":"### Survival as per classes\n- 63% of Passenger Class 1\n- 48% of Passenger Class 2\n- Only 25% of Passenger Class 3 survived","d83a4e44":"### Logistic Regression","c545531f":"## Random Tree Classifier","7a4cf922":"**Prediction Results : 0.78947**","1a598150":"## Grid SearchCV","a0c4c110":"**In Case you fork the Notebook, Don't forget to Mention the Author's name and Link below as well**\nhttps:\/\/www.kaggle.com\/samridhmathur\/titanicdisaster-survivorprediction-78-94-score\/","ddd17e9a":"### Support Vector Machine","23db7289":"## K-Nearest Neighbours"}}