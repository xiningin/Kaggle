{"cell_type":{"eacde416":"code","8765b123":"code","072457b4":"code","d016a0c5":"code","8a59ad74":"code","1bb6635c":"code","9781a36f":"code","7e2dea26":"markdown","ff3dd692":"markdown","a2521849":"markdown","141bc86f":"markdown"},"source":{"eacde416":"import numpy as np\nimport pandas as pd\n\ndf = pd.read_csv('..\/input\/ventilator-pressure-prediction\/train.csv')","8765b123":"%%time\n\n# Normal code\nlag = 1\ndf[f'normal_diff{lag}_u_in'] = df.groupby('breath_id')['u_in'].diff(lag)","072457b4":"%%time\n\n# Speed up code\nlag = 1\nshift_u_in = df.groupby('breath_id')['u_in'].shift(lag)\ndf[f'speedup_diff{lag}_u_in'] = df['u_in'] - shift_u_in","d016a0c5":"(df[f'normal_diff{lag}_u_in'] - df[f'speedup_diff{lag}_u_in']).max()","8a59ad74":"%%time\n\n# Normal code\nlag = 5\ndf[f'normal_windowmean{lag}_u_in'] = df.groupby('breath_id')['u_in'] \\\n                                .rolling(window=lag, min_periods=1).mean() \\\n                                .reset_index(drop=True)","1bb6635c":"%%time\n\n# Speed up code\nlag = 5\ntmp_df = pd.DataFrame()\nfor i in range(lag):\n    tmp_df[f'tmp_shif{i}'] = df.groupby('breath_id')['u_in'].shift(i)\n\ndf[f'speedup_windowmean{lag}_u_in'] = tmp_df.mean(axis=1)","9781a36f":"(df[f'normal_windowmean{lag}_u_in'] - df[f'speedup_windowmean{lag}_u_in']).max()","7e2dea26":"# diff","ff3dd692":"In this notebook, I introduce a code that can easily improve the speed of **diff** and **rolling** feature extraction.","a2521849":"Thank you for taking a look at this notebook. If there is anything else that can be improved, please let us know in the comments.","141bc86f":"# rolling"}}