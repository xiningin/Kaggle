{"cell_type":{"dadab887":"code","eb83bce8":"code","bb8243e1":"code","4cd1f986":"code","6d77e858":"code","2b8f9520":"code","d414454a":"code","5976447b":"code","d8a4cca7":"code","ae9ce094":"code","587489c2":"code","615caaaa":"code","5419149d":"code","3cdb321b":"markdown","210059cb":"markdown","f9cafd1f":"markdown","275f03cc":"markdown","d32c62a4":"markdown"},"source":{"dadab887":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\ntry:\n  from catboost import CatBoostClassifier\nexcept:\n  !pip install catboost\n  from catboost import CatBoostClassifier\nfrom sklearn.model_selection import train_test_split\nimport os","eb83bce8":"class Config:\n    is_kaggle_platform = os.path.exists(\"\/kaggle\/input\")\n    dataset_name = \"tabular-playground-series-oct-2021\"\n    data_path = \"\/kaggle\/input\/%s\/\"%(dataset_name) if is_kaggle_platform else \"\"\n    submit_filename = \"submission.csv\"\nconfig = Config()","bb8243e1":"if not config.is_kaggle_platform:\n  try:\n    import kaggle\n  except:\n    !pip install kaggle\n  if not os.path.exists(\"\/root\/.kaggle\/kaggle.json\"):\n    !echo \"{\\\"username\\\":\\\"{your username}\\\",\\\"key\\\":\\\"{your api key}\\\"}\" >> \/root\/.kaggle\/kaggle.json\n    !chmod 600 \/root\/.kaggle\/kaggle.json\n  !kaggle competitions download -c $config.dataset_name\n  !unzip test.csv.zip\n  !unzip train.csv.zip\n  !unzip sample_submission.csv.zip","4cd1f986":"train = pd.read_csv(config.data_path + \"train.csv\")\ntest = pd.read_csv(config.data_path + \"test.csv\")\nsample_submission = pd.read_csv(config.data_path + \"sample_submission.csv\")","6d77e858":"train.head()","2b8f9520":"test.head()","d414454a":"train.info()","5976447b":"train.describe()","d8a4cca7":"train_features, val_features = train_test_split(train, test_size=0.15, random_state=42)","ae9ce094":"val_features.shape","587489c2":"train_targets = train_features.pop(\"target\")\nval_targets = val_features.pop(\"target\")","615caaaa":"cat_params = {\n    'iterations': 15585, \n    'objective': 'CrossEntropy', \n    'bootstrap_type': 'Bernoulli', \n    'od_wait': 1144, \n    'learning_rate': 0.023575206684596582, \n    'reg_lambda': 36.30433203563295, \n    'random_strength': 43.75597655616195, \n    'depth': 7, \n    'min_data_in_leaf': 11, \n    'leaf_estimation_iterations': 1, \n    'subsample': 0.8227911142845009,\n    'task_type' : 'GPU',\n    'devices' : '0',\n    'verbose' : 1000,\n    'eval_metric': 'AUC',\n    'use_best_model': True\n}\ncat = CatBoostClassifier(**cat_params)\ncat.fit(train_features, train_targets, eval_set=(val_features, val_targets))","5419149d":"y_pred = cat.predict_proba(test)\nsample_submission[\"target\"] = y_pred[:, 1]\nsample_submission.to_csv(config.submit_filename, index=False)\nif not config.is_kaggle_platform:\n  !kaggle competitions submit $config.dataset_name -m \"Submission\" -f $config.submit_filename","3cdb321b":"## CatBoost Tabular Prediction (Oct 2021)\nIn this Notebook, I will:\n* Build a Tabular Prediciton Model using Catboost.\n* Make this Notebook available to train on Google Colab or Other Platfroms or your Computer. (It may need to adjust code and configuration), The Competition result can be submited automatically.","210059cb":"## Model Development","f9cafd1f":"## Setup","275f03cc":"## EDA","d32c62a4":"## Submission"}}