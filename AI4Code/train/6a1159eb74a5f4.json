{"cell_type":{"42352b0f":"code","e6a91c0c":"code","00c63c7a":"code","bda5a6c4":"code","4762483a":"code","685b367d":"code","5a580b1e":"code","1b0dcd43":"code","23b4e034":"code","42069979":"code","120ecb6d":"code","9be39644":"code","39a48253":"code","9216f0ec":"code","07652358":"code","be5376e8":"code","fd1176cd":"code","92aaa9cc":"code","9e263892":"code","f33e0dc3":"code","442cf8b8":"markdown","a4566e16":"markdown","22b92c9d":"markdown","9627ab25":"markdown"},"source":{"42352b0f":"import os\nimport numpy as np \nimport pandas as pd \nimport matplotlib.pyplot as plt\nimport tensorflow as tf\nfrom tensorflow import keras\nfrom keras.preprocessing.image import ImageDataGenerator\nfrom tensorflow.keras.models import Sequential\nfrom tensorflow.keras.layers import Conv2D, MaxPool2D, Flatten, Dense, Dropout","e6a91c0c":"train_dir = '..\/input\/asl-alphabet\/asl_alphabet_train\/asl_alphabet_train'","00c63c7a":"## Data Directory description   ###################################\n#\n#\n#   29 folders in test are -> A, B, C, D, E, F, G ,H, I ,J ,K, L, M, N, O, P, Q, R, S, T, U, V, W, X, Y, Z, DEL, SPACE, NOTHING\n#\n#\n#\n#                             -> asl_alphabet_train ->  asl_alphabet_train -> 29 folder, each folder has 3000 images\n#                           \/\n# input ->  asl-alphabet ->  \n#                          \\ \n#                           -> asl_alphabet_test ->  asl_alphabet_test -> 28 test images\n#\n","bda5a6c4":"categories = os.listdir(train_dir)\nlen(categories)","4762483a":"categories","685b367d":"count = 0\ntrain_images_names_and_paths = {}\n\nfor i in categories:\n    train_images_names_and_paths[i] = os.listdir(train_dir + '\/' + i)\n    count += len(os.listdir(train_dir + '\/' + i))\n    \nprint('total count of test images is:', count)","5a580b1e":"train_dir + '\/' + list(train_images_names_and_paths.keys())[0] + '\/' + list(train_images_names_and_paths.values())[0][0]","1b0dcd43":"img = plt.imread(train_dir + '\/' + list(train_images_names_and_paths.keys())[0] + '\/' + list(train_images_names_and_paths.values())[0][0])\nimg","23b4e034":"plt.imshow(img)","42069979":"img.shape","120ecb6d":"#The ImageDataGenerator class has three methods \n#flow(), flow_from_directory() and flow_from_dataframe() \n#to read the images from a big numpy array and folders containing images.","9be39644":"data_generator = ImageDataGenerator(rescale = 1\/255)\n\ntrain_generated = data_generator.flow_from_directory(train_dir,                       # path of images\n                                                     target_size = (200,200),         # size of image\n                                                     class_mode = 'categorical',\n                                                     color_mode = 'rgb',\n                                                     shuffle = True,\n                                                     batch_size = 32                  # hyperparameter that defines the number of samples\n                                                                                      #to work through before updating the internal model parameters\n                                                    )\n","39a48253":"train_generated","9216f0ec":"train_generated.class_indices","07652358":"img = plt.imread(train_dir + '\/' + list(train_images_names_and_paths.keys())[1] + '\/' + list(train_images_names_and_paths.values())[1][0])\nplt.imshow(img)\n\nprint(\"Following is picture of 'R'\")","be5376e8":"CNN = keras.models.Sequential([\n    keras.layers.Conv2D( 32, kernel_size = 3, input_shape = (200,200,3), activation = 'relu'),\n    keras.layers.MaxPool2D(pool_size = (2,2)),\n    \n    keras.layers.Conv2D( 64, kernel_size = 3, activation = 'relu'),\n    keras.layers.MaxPool2D(pool_size = (3,3)),\n    \n    keras.layers.Conv2D( 128, kernel_size = 3, activation = 'relu'),\n    keras.layers.MaxPool2D(pool_size = (3,3)),\n    \n    keras.layers.Conv2D( 256, kernel_size = 3, activation = 'relu'),\n    keras.layers.MaxPool2D(pool_size = (4,4)),\n    \n    keras.layers.Flatten(),\n    keras.layers.Dense(1024, activation = 'relu'),\n    keras.layers.Dropout(0.2),\n    keras.layers.Dense(512, activation = 'relu'),\n    keras.layers.Dropout(0.4),\n    keras.layers.Dense(256, activation = 'relu'),\n    keras.layers.Dropout(0.6),\n    keras.layers.Dense(29, activation = 'softmax')   \n])","fd1176cd":"CNN.compile(\n    optimizer = 'adam',\n    loss = 'categorical_crossentropy',\n    metrics = ['accuracy']\n)","92aaa9cc":"CNN.summary()","9e263892":"CNN.fit(train_generated, epochs = 5)","f33e0dc3":"from keras.models import load_model\n\nCNN.save('ASL_model.h5')\n\n# model = load_model('my_model.h5')","442cf8b8":"# Importing libraries","a4566e16":"# Data Preprocessing","22b92c9d":"# CNN Model","9627ab25":"## Data Description"}}