{"cell_type":{"00218c84":"code","c2cd3976":"code","6c23d19c":"code","710e8418":"code","9aa76a7b":"code","ed981ccd":"code","42133851":"code","ee57652b":"code","22cda1a0":"code","810b7c1b":"code","3931ca86":"code","cd00ad4e":"code","e248aba4":"code","004257c4":"code","d03453d7":"code","26fd023f":"code","01854297":"code","4fe83a4f":"code","a5a03e3a":"code","c214abed":"code","47c883eb":"code","8087236a":"code","ed31233f":"code","8504602e":"code","27ad2291":"code","80c1db64":"code","6ea73e60":"code","6d1f8134":"code","dcd621cf":"code","e0b0f361":"code","6093b9cf":"code","e248aebb":"code","7f3f9de3":"code","dca951c3":"code","5550c301":"code","067f966b":"code","cfbee9b0":"code","e3f057b5":"code","637e40c0":"code","68c38f99":"code","7d927205":"code","02966fa7":"code","fa887590":"markdown","61c645f7":"markdown","d7f0fdc1":"markdown","193c70a4":"markdown","3f762381":"markdown","e3e4903b":"markdown","89d0ef07":"markdown","c23a0d28":"markdown","ebb5ce66":"markdown","2e91dd59":"markdown","05255017":"markdown","7ccefe96":"markdown","7d16e260":"markdown","f0f749bc":"markdown","605a0e09":"markdown","15b64d33":"markdown","80dc1ecd":"markdown","9ac0a607":"markdown","6e7d7c7d":"markdown"},"source":{"00218c84":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport plotly.express as px\n\n%matplotlib inline\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","c2cd3976":"ddtr = pd.read_csv(\"\/kaggle\/input\/electrical-fault-detection-and-classification\/detect_dataset.csv\")\nclts = pd.read_csv(\"\/kaggle\/input\/electrical-fault-detection-and-classification\/classData.csv\")\n\nddtr.head()","6c23d19c":"clts.head()","710e8418":"# DDTR\nprint(f\"The Detect Dataset has {ddtr.shape[0]} rows and {ddtr.shape[1]} columns.\")\n# CLTS\nprint(f\"The Dataset to be classified has {clts.shape[0]} rows and {clts.shape[1]} columns.\")","9aa76a7b":"# Dropping the last 2 columns from ddtr dataset.\nddtr = ddtr.drop(ddtr[['Unnamed: 7', 'Unnamed: 8']],axis=1)\nddtr.head()","ed981ccd":"ddtr.info()","42133851":"clts.info()","ee57652b":"ddtr.describe()","22cda1a0":"clts.describe()","810b7c1b":"print(f\"Dataset Detect has {ddtr.duplicated().sum()} duplicate values.\")\nprint(f\"Dataset Classify has {clts.duplicated().sum()} duplicate values.\")","3931ca86":"print(ddtr['Output (S)'].value_counts(),\"\\n\")\nsns.countplot(x=ddtr['Output (S)'])\nplt.show()","cd00ad4e":"ddtr.columns","e248aba4":"for i,j in enumerate(ddtr.columns[1:4]):\n    \n    print(f\"For Current {j}\\n\")\n    plt.subplots(1,2,figsize=(14,4))\n    plt.subplot(121)\n    sns.kdeplot(x=ddtr[j],color='darkred')\n\n    plt.subplot(122)\n    plt.hist(x=ddtr[j],color='darkred')\n    plt.show()","004257c4":"for i,j in enumerate(ddtr.columns[4:]):\n    \n    print(f\"For Voltage {j}\\n\")\n    plt.subplots(1,2,figsize=(14,4))\n    plt.subplot(121)\n    sns.kdeplot(x=ddtr[j])\n\n    plt.subplot(122)\n    plt.hist(x=ddtr[j])\n    plt.show()","d03453d7":"for i,j in zip(ddtr.columns[1:4],ddtr.columns[4:]):    \n    plt.subplots(1,2,figsize=(12,5))\n    print(f\"For Line {str(i)[1].upper()}\\n\")\n    plt.subplot(121)\n    sns.boxplot(y=ddtr[i],color='azure')\n\n    plt.subplot(122)\n    sns.boxplot(y=ddtr[j],color='azure')\n    plt.show()","26fd023f":"fig = px.line(ddtr, x = \"Ia\", y = \"Va\", title=\"For Line A\", color = \"Output (S)\")\nfig.show()\n","01854297":"fig = px.line(ddtr, x = \"Ib\", y = \"Vb\", title=\"For Line B\", color = \"Output (S)\")\nfig.show()","4fe83a4f":"fig = px.line(ddtr, x = \"Ic\", y = \"Vc\",title=\"For Line C\",  color = \"Output (S)\")\nfig.show()","a5a03e3a":"clts['fault_types'] = clts['G'].astype('str') + clts['C'].astype('str') + clts['B'].astype('str') + clts['A'].astype('str')\nclts.head()","c214abed":"print(\"[G C B A]\\n[0 0 0 0] -> No fault \\n[1 0 0 1] -> LG fault\\n[0 1 1 0] -> LL fault\\n[1 0 1 1] -> LLG Fault\\n[0 1 1 1] -> LLL Fault\\n[1 1 1 1] -> LLLG fault\\n\")\nplt.figure(figsize=(8,5))\nclts.fault_types.value_counts().plot.pie()\nplt.title(\"Type of Faults\")\nplt.ylabel(\"\")\nplt.show()","47c883eb":"NF = clts[clts['fault_types']=='0000']\nLG = clts[clts['fault_types']=='1001'] \nLL = clts[clts['fault_types']=='0110'] \nLLG = clts[clts['fault_types']=='1011'] \nLLL = clts[clts['fault_types']=='0111'] \nLLLG = clts[clts['fault_types']=='1111']","8087236a":"print(\"For No Fault\")\nplt.subplots(1,3,figsize=(14,5))\nplt.subplot(131)\nsns.scatterplot(x=NF['Ia'],y=NF['Va'],color='darkred')\n\nplt.subplot(132)\nsns.scatterplot(x=NF['Ib'],y=NF['Vb'],color='green')\n\nplt.subplot(133)\nsns.scatterplot(x=NF['Ic'],y=NF['Vc'])\n\n# plt.tight_layout()\nplt.show()","ed31233f":"print(\"For Line Ground Fault\\n\\nSince the fault has occured between Phase A and Ground we can notice the amount of current flowing in line A \\nwhich is alomst 10 times the normal operating current.\")\nplt.subplots(1,3,figsize=(15,5))\n\nplt.subplot(131)\nsns.scatterplot(x=LG['Ia'],y=LG['Va'],color='darkred')\n\nplt.subplot(132)\nsns.scatterplot(x=LG['Ib'],y=LG['Vb'],color='green')\n\nplt.subplot(133)\nsns.scatterplot(x=LG['Ic'],y=LG['Vc'])\n\nplt.tight_layout()\nplt.show()","8504602e":"print(\"For Line to Line Fault\")\nplt.subplots(1,3,figsize=(15,5))\n\nplt.subplot(131)\nsns.scatterplot(x=LL['Ia'],y=LL['Va'],color='darkred')\n\nplt.subplot(132)\nsns.scatterplot(x=LL['Ib'],y=LL['Vb'],color='green')\n\nplt.subplot(133)\nsns.scatterplot(x=LL['Ic'],y=LL['Vc'])\n\nplt.tight_layout()\nplt.show()","27ad2291":"print(\"For Line Line Ground Fault\")\nplt.subplots(1,3,figsize=(15,5))\n\nplt.subplot(131)\nsns.scatterplot(x=LLG['Ia'],y=LLG['Va'],color='darkred')\n\nplt.subplot(132)\nsns.scatterplot(x=LLG['Ib'],y=LLG['Vb'],color='green')\n\nplt.subplot(133)\nsns.scatterplot(x=LLG['Ic'],y=LLG['Vc'])\n\nplt.tight_layout()\nplt.show()","80c1db64":"print(\"For Line Line Line Fault\")\nplt.subplots(1,3,figsize=(15,5))\n\nplt.subplot(131)\nsns.scatterplot(x=LLL['Ia'],y=LLL['Va'],color='darkred')\n\nplt.subplot(132)\nsns.scatterplot(x=LLL['Ib'],y=LLL['Vb'],color='green')\n\nplt.subplot(133)\nsns.scatterplot(x=LLL['Ic'],y=LLL['Vc'])\n\nplt.tight_layout()\nplt.show()","6ea73e60":"print(\"For Line Line Line Ground Fault\")\nplt.subplots(1,3,figsize=(15,5))\n\nplt.subplot(131)\nsns.scatterplot(x=LLLG['Ia'],y=LLLG['Va'],color='darkred')\n\nplt.subplot(132)\nsns.scatterplot(x=LLLG['Ib'],y=LLLG['Vb'],color='green')\n\nplt.subplot(133)\nsns.scatterplot(x=LLLG['Ic'],y=LLLG['Vc'])\n\nplt.tight_layout()\nplt.show()","6d1f8134":"sns.pairplot(ddtr,hue='Output (S)')\nplt.show()","dcd621cf":"from sklearn.model_selection import cross_val_score\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.preprocessing import MinMaxScaler\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.svm import SVC\nfrom sklearn.tree import DecisionTreeClassifier\nfrom xgboost import XGBClassifier\n\nfrom sklearn import metrics","e0b0f361":"for i in ['Va','Vb','Vc']:\n    ddtr[i] = ddtr[i]*11000\n    \nddtr.head()","6093b9cf":"dip = ddtr.drop(columns=['Output (S)'],axis=1)\ndipc = dip.columns\n\nmms = MinMaxScaler()\ndf_dip = mms.fit_transform(dip)\n\ndip = pd.DataFrame(df_dip, columns=dipc)","e248aebb":"dop = ddtr.iloc[:,0]","7f3f9de3":"dip.describe()","dca951c3":"from sklearn.model_selection import GridSearchCV,RandomizedSearchCV","5550c301":"X_train, X_test, y_train, y_test = train_test_split(dip, dop, test_size=0.25, random_state=67)","067f966b":"sv = SVC(C=1000)\n\nsv.fit(X_train,y_train)\nscores = cross_val_score(sv, X_test, y_test, cv=10)\nprint(\"Score:\", np.mean(scores))\nmetrics.plot_confusion_matrix(sv,X_test,y_test)\nplt.show()","cfbee9b0":"dtc = DecisionTreeClassifier(criterion='gini',ccp_alpha=0.0012)\n\ndtc.fit(X_train,y_train)\nscores = cross_val_score(dtc, X_test, y_test, cv=10)\nprint(\"Score:\", np.mean(scores),\"\\n\")\nmetrics.plot_confusion_matrix(dtc,X_test,y_test)\nplt.show()","e3f057b5":"from sklearn.tree import plot_tree\nplt.figure(figsize=(15,7))\nplot_tree(dtc,filled=True,feature_names=['Ia', 'Ib', 'Ic', 'Va', 'Vb', 'Vc'])\nplt.show()","637e40c0":"knn = KNeighborsClassifier(leaf_size= 1, n_neighbors= 5,p= 1)\nknn.fit(X_train,y_train)\nscores = cross_val_score(knn, X_test, y_test, cv=10)\nprint(\"Score:\", np.mean(scores),\"\\n\")\nmetrics.plot_confusion_matrix(knn,X_test,y_test)\nplt.show()","68c38f99":"# n_estimators = [10,20,30,40,50,60]\n# max_features = ['auto','sqrt']\n# max_depth = [3,4,5,6]\n# min_samples_split = [5,10,15]\n# min_samples_leaf = [5,10]\n\n# param_grid = {\"n_estimators\": n_estimators,\n#             \"max_features\": max_features,\n#             \"max_depth\": max_depth,\n#             \"min_samples_split\":min_samples_split,\n#             \"min_samples_leaf\":min_samples_leaf}\n\n# rf_grid=GridSearchCV(rf,param_grid=param_grid,verbose=2,n_jobs=4)\n# rf_grid.fit(X_train,y_train)\n\n# rf_grid.best_params_\n\n# rf_grid.best_estimator_","7d927205":"rfclf = RandomForestClassifier(max_depth=6, min_samples_leaf=10, min_samples_split=15,n_estimators=10)\nrfclf.fit(X_train,y_train)\nscores=cross_val_score(rfclf, X_test, y_test, cv=10)\nprint(\"Score:\", np.mean(scores),\"\\n\")","02966fa7":"metrics.plot_confusion_matrix(rfclf,X_test,y_test)\nplt.show()","fa887590":"#### So we have two files(datasets) here namely ddtr and clts:\n* ddtr is to train the model to detect any type of Flaut and<br>\n* clts is for Classification of Shunt Faults.\n\n\n**This file _ddtr_ contains the dataset to classify the types of fault.**<br>\n\n> A,B,C are the 3-phases of the electrical system. Most of the Electricity transmission happens via 3-phase system,<br>\nand hence **Ia** represents the current(I) in phase A, **Va** represents the Voltage(V) in phase A and so on for Phase A and B.\n\nInputs - [Ia,Ib,Ic,Va,Vb,Vc]<br>\nOutputs - [G C B A]<br>\n\nExamples :<br>\n[0 0 0 0] - No Fault<br>\n[1 0 0 1] - LG fault (Between Phase A and Gnd)<br>\n[0 0 1 1] - LL fault (Between Phase A and Phase B)<br>\n[1 0 1 1] - LLG Fault (Between Phases A,B and ground)<br>\n[0 1 1 1] - LLL Fault(Between all three phases)<br>\n[1 1 1 1] - LLLG fault( Three phase symmetrical fault)<br>","61c645f7":"Value of hyperparameters has been evaluated using GridSearchCV","d7f0fdc1":"If there is any confusion regarding the values of the Line voltages, then let me clarify it that they are most probably in p.u.<br>\ni.e.<br>\n> ## $V_{p.u.} = \\frac{V}{V_{base}} $\n\nIn actual the power system consists of 4 generators of 11 \u00d7 10^3 V. so we can convert by multiplying them by $11000$ Volts provided they have taken 11k as their base.\n\n.........too much of info!","193c70a4":"#### Classification Dataset","3f762381":"### SVM model","e3e4903b":"# <font color = 'Fire'><center> <b>Electrical Faults Detection and Classsification<\/b> <\/center>","89d0ef07":"### Random Forest Classifier","c23a0d28":"### Lets have a quick look on data types and values of our dataset ","ebb5ce66":"We don't have any type of null values in our dataset.","2e91dd59":"Value *ccp_alpha* has been calculated via decision tree pruning.","05255017":"We have a balanced dataset.","7ccefe96":"#### We can observe that:\n* Normally the Line current varies from **-100 to 100 Amp** and Voltage p.u. between **-0.6 and 0.6**.\n* While during fault, we notice some absurd and random behaviour and the value of Line current even touches **-\/+800 Amp** mark.","7d16e260":"## Detection dataset","f0f749bc":"### What are Electrical Faults?\n> Normally, a power system operates under balanced conditions. When the system becomes unbalanced due to the failures of insulation at any point or due to the contact of live wires, a short\u2013circuit or fault, is said to occur in the line. Faults may occur in the power system due to the number of reasons like natural disturbances (lightning, high-speed winds, earthquakes), insulation breakdown, falling of a tree, bird shorting, etc.\n\n\n### Types of Faults?\n> Faults can be brodly categorised into two types:\n> 1. Open-circuit Fault and\n> 2. Short-Circuit Faults\n    * Symmetrical and \n    * Asymmetrical Faults\n    \n### Symmetrical and Asymmetrical Faults\n> #### Symmetrical \n> * In symmetrical faults, all phases are shorted to each other or to earth (L-L-L) or (L-L-L-G).\n> * The nature of this type of fault is balanced.\n> * In this type of fault,fault currents in all phases are symmetrical i.e. their magnitudes are equal and they are equally displaced by angle 120 degree.\n> * It is more severe type of fault but it occurs rarely.\n\n> #### Asymmetrical \n> * These faults involve only one or two phases.\n> * In this type of fault, three phase lines become unbalanced.\n> * There are mainly three types namely line to ground (L-G), line to line (L-L) and double line to ground (LL-G) faults.\n> * These type of faults mostly occur on power system..\n\n\n\n\n\n<center> <img src=\"https:\/\/ars.els-cdn.com\/content\/image\/1-s2.0-S2314717217300065-gr1.jpg\" width=\"600\" height=\"200\"> <\/center>\n<br>\nSo here we are trying to classify Short-Circuit faults into further categories based on the values of line voltages and Line Currents.","605a0e09":"### Decision Tree Model","15b64d33":"<img src=\"https:\/\/www.elprocus.com\/wp-content\/uploads\/2014\/02\/Copy-of-DSCN9922.jpg\" width=800 \/>","80dc1ecd":"All the data is somewhat normally distrubuted.","9ac0a607":"#### SVM is doing  a great job till now in Fault Detection, than the rest of the models because it's able to predict all the signals in most efficient manner while in other models there are cases where there is actually fault but the model is not able to identify it.","6e7d7c7d":"### KNN Model"}}