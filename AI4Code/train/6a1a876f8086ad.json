{"cell_type":{"cff5fdaa":"code","ed4c7392":"code","37636040":"code","6b039911":"code","a876449f":"code","232150fd":"code","28a46352":"code","86cd3bcb":"code","3654ac8b":"code","3c0c00a2":"code","77fc1701":"code","e025aec9":"code","35124794":"code","af5bd74b":"code","ea429d18":"code","532d2a60":"code","6a8c140e":"code","455ab51b":"code","46d5e5e4":"markdown","fd7ac73f":"markdown","75f0b3d3":"markdown","f2027190":"markdown","50201b3b":"markdown","87d244f5":"markdown","7bd2667f":"markdown","d6a3e932":"markdown","ece1d6d4":"markdown","20c03a96":"markdown","5d17beee":"markdown","b3e5a827":"markdown","de23ea8a":"markdown","b44d5bfc":"markdown","617f0e99":"markdown","8af0a663":"markdown","e8ec2de4":"markdown"},"source":{"cff5fdaa":"import pandas as pd\nimport numpy as np\nimport warnings\nwarnings.filterwarnings(\"ignore\")\nfrom sklearn.experimental import enable_iterative_imputer\nfrom sklearn.impute import SimpleImputer, IterativeImputer\nfrom sklearn.model_selection import StratifiedKFold, cross_val_score, GridSearchCV\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.compose import ColumnTransformer\nfrom sklearn.preprocessing import OneHotEncoder\nimport category_encoders as ce\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.preprocessing import RobustScaler","ed4c7392":"titanic_train = pd.read_csv('..\/input\/titanic\/train.csv')\ntitanic_train.sample()","37636040":"titanic_test = pd.read_csv('..\/input\/titanic\/test.csv')\ntitanic_test.sample()","6b039911":"titanic_train.info()","a876449f":"titanic_test.info()","232150fd":"train = titanic_train.copy()\ntrain.isna().sum()\/len(train.index)*100","28a46352":"new_train = train['Name'].str.split(\" \", n = 2, expand = True)\ntrain[\"First Name\"] = new_train[0]\ntrain[\"Name Title\"] = new_train[1]\ntrain[\"Last Name\"] = new_train[2]\ntrain.head()","86cd3bcb":"train.drop(columns=['Cabin', 'PassengerId', 'Name', 'Ticket', 'First Name', 'Last Name'], inplace = True)\ntrain.head()","3654ac8b":"test = titanic_test.copy()\ntest.isna().sum()\/len(test.index)*100","3c0c00a2":"new_test = test['Name'].str.split(\" \", n = 2, expand = True)\ntest[\"First Name\"] = new_test[0]\ntest[\"Name Title\"] = new_test[1]\ntest[\"Last Name\"] = new_test[2]\ntest.head()","77fc1701":"test.drop(columns=['Cabin', 'Name', 'Ticket', 'First Name', 'Last Name'], inplace = True)","e025aec9":"impute_mode = SimpleImputer(strategy = 'most_frequent')\ntest[['Embarked']] = impute_mode.fit_transform(test[['Embarked']])\n\nimpute_iter = IterativeImputer(max_iter = 10, random_state = 0)\ntest[['Age']] = impute_iter.fit_transform(test[['Age']])\n\nimpute_iter = IterativeImputer(max_iter = 10, random_state = 0)\ntest[['Fare']] = impute_iter.fit_transform(test[['Fare']])\n\ntest.isna().sum()\/len(test.index)*100","35124794":"mode_onehot_pipe = Pipeline([\n    ('encoder', SimpleImputer(strategy = 'most_frequent')),\n    ('one hot encoder', OneHotEncoder(handle_unknown = 'ignore'))])\n\ntransformer = ColumnTransformer([\n    ('one hot', OneHotEncoder(handle_unknown = 'ignore'), ['Sex', 'Name Title']),\n    ('mode_onehot_pipe', mode_onehot_pipe, ['Embarked']),\n    ('robust', RobustScaler(), ['Fare']),\n    ('iterative', IterativeImputer(max_iter = 10, random_state = 0), ['Age'])], remainder = 'passthrough')","af5bd74b":"train['Survived'].value_counts()\/train.shape[0]*100","ea429d18":"X_train = train.drop('Survived', axis = 1)\ny_train = train['Survived']\n\nXtest = test.drop('PassengerId', axis = 1).copy()\n\nX_train.shape, Xtest.shape","532d2a60":"rf = RandomForestClassifier(random_state = 8888)\n\nrf_pipe = Pipeline([('transformer', transformer), ('rf', rf)])\n\ndef model_evaluation(model, metric):\n    model_cv = cross_val_score(model, X_train, y_train, cv = StratifiedKFold(n_splits = 5), scoring = metric)\n    return model_cv\n\nrf_pipe_cv = model_evaluation(rf_pipe, 'accuracy')\n\nscore_mean = [rf_pipe_cv.mean()]\nscore_std = [rf_pipe_cv.std()]\nmethod_name = ['Random Forest Classifier']\ncv_summary = pd.DataFrame({\n    'method': method_name,\n    'mean score': score_mean,\n    'std score': score_std\n})\ncv_summary","6a8c140e":"rf_pipe = Pipeline([('transformer', transformer), ('model', rf)])\n\nhyperparam_space = {\n    'model__n_estimators': [100, 200],\n    'model__criterion': ['gini', 'entropy'],\n    'model__max_depth': [11, 13, 15],\n    'model__min_samples_leaf': [3, 5, 7, 9],\n    'model__random_state': [8888]\n}\n\ngrid_rf = GridSearchCV(\n                rf_pipe,\n                param_grid = hyperparam_space,\n                cv = StratifiedKFold(n_splits = 5),\n                scoring = 'accuracy',\n                n_jobs = -1)\n\ngrid_rf.fit(X_train, y_train)\n\nprint('best score', grid_rf.best_score_)\nprint('best param', grid_rf.best_params_)","455ab51b":"submission = pd.DataFrame({\n        \"PassengerId\": test[\"PassengerId\"],\n        \"Survived\": grid_rf.best_estimator_.predict(Xtest)\n    })","46d5e5e4":"# Submission","fd7ac73f":"* It's definitely imbalanced data but I'm not intended to process more further to handling it.","75f0b3d3":"#### Feature's Value Checking","f2027190":"#### Splitting Data","50201b3b":"#### Fill Missing Value","87d244f5":"#### Missing Value","7bd2667f":"#### Missing Value","d6a3e932":"#### Preprocessing Scheme\n\n- OneHotEncoding: Sex, Name Title\n    * Simple Imputer Most Frequent: Embarked\n- Iterative Impute: Age\n- Robust Scaling: Fare\n- PassThrough: Pclass, SibSp, Parch\n- Target: Survived","ece1d6d4":"#### Define Target Data","20c03a96":"#### Feature's Value Checking","5d17beee":"# PreProcessing","b3e5a827":"# Modeling","de23ea8a":"# Test Data","b44d5bfc":"#### Drop Columns","617f0e99":"# HyperParameter Tuning","8af0a663":"#### Drop Columns","e8ec2de4":"# Train Data"}}