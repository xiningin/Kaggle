{"cell_type":{"152d495f":"code","e4b2dc77":"code","d301cc81":"code","d5400833":"code","59ca9cbb":"code","d5fe7009":"code","dda45f75":"code","3719d5ce":"markdown","bb7030bf":"markdown","be326943":"markdown","f7808637":"markdown","7e0469c5":"markdown","fde625a3":"markdown"},"source":{"152d495f":"!git clone https:\/\/github.com\/ZHKKKe\/MODNet\n%cd MODNet","e4b2dc77":"!pip install gdown","d301cc81":"# dowload the pre-trained ckpt for image matting\n!gdown --id 1mcr7ALciuAsHCpLnrtG_eop5-EYhbCmz \\\n       -O pretrained\/modnet_photographic_portrait_matting.ckpt","d5400833":"!mkdir output","59ca9cbb":"!python -m demo.image_matting.colab.inference \\\n        --input-path \/kaggle\/input\/input-celebrities \\\n        --output-path .\/output \\\n        --ckpt-path .\/pretrained\/modnet_photographic_portrait_matting.ckpt","d5fe7009":"import numpy as np\nfrom PIL import Image\n\ndef combined_display(image, matte):\n  # calculate display resolution\n  w, h = image.width, image.height\n  rw, rh = 800, int(h * 800 \/ (3 * w))\n  \n  # obtain predicted foreground\n  image = np.asarray(image)\n  if len(image.shape) == 2:\n    image = image[:, :, None]\n  if image.shape[2] == 1:\n    image = np.repeat(image, 3, axis=2)\n  elif image.shape[2] == 4:\n    image = image[:, :, 0:3]\n  matte = np.repeat(np.asarray(matte)[:, :, None], 3, axis=2) \/ 255\n  foreground = image * matte + np.full(image.shape, 255) * (1 - matte)\n  \n  # combine image, foreground, and alpha into one line\n  combined = np.concatenate((image, foreground, matte * 255), axis=1)\n  combined = Image.fromarray(np.uint8(combined)).resize((rw, rh))\n  return combined","dda45f75":"import os\n# visualize all images\ninput_folder = '\/kaggle\/input\/input-celebrities'\noutput_folder = '.\/output'\n\nimage_names = os.listdir('\/kaggle\/input\/input-celebrities')\nfor image_name in image_names:\n  matte_name = image_name.split('.')[0]+'.png'\n  image = Image.open(os.path.join(input_folder, image_name))\n  matte = Image.open(os.path.join(output_folder, matte_name))\n  display(combined_display(image, matte))\n  print(image_name, '\\n')","3719d5ce":"# MODNet - Image Matting","bb7030bf":"## Inference","be326943":"## Visualization","f7808637":"## Paper: [Is a Green Screen Really Necessary for Real-Time Portrait Matting?](https:\/\/arxiv.org\/abs\/2011.11961)\n![](https:\/\/miro.medium.com\/max\/1400\/0*stmZVP-SZ083K5lw.png)","7e0469c5":"## Repro [Github](https:\/\/github.com\/ZHKKKe\/MODNet)","fde625a3":"## Download Pretrained Model"}}