{"cell_type":{"0e535667":"code","7d27abe2":"code","b8257fe5":"code","e335f681":"code","16060636":"code","0fb1acfb":"code","6436f6c5":"code","c0d15d5a":"code","18b2d984":"code","16f34f6c":"code","65785909":"code","b1fb072d":"code","23876521":"code","76a6c5ae":"code","f136a993":"code","8629992b":"code","4a208365":"code","01a57696":"code","6ced9e63":"code","0928a20c":"code","02651285":"code","40135eba":"code","6ce71246":"code","64f146d9":"code","28d29b02":"code","5f6e269f":"code","c891def8":"code","86b63d22":"code","defb345c":"code","455ec297":"code","c76ec8d6":"code","1050abf6":"code","10529875":"markdown","44a28d4a":"markdown","50a7d43d":"markdown","1b91a377":"markdown","1dbad58d":"markdown","7acc94b8":"markdown","a869fa44":"markdown","a0894892":"markdown","e8623fcb":"markdown","67a7b2e1":"markdown","e6a0e2da":"markdown","3336cb59":"markdown","4115312e":"markdown","9480aeed":"markdown","dd3f2ad4":"markdown","32970a3b":"markdown","ee3ed853":"markdown","c2940dbf":"markdown","1b894364":"markdown","18dd4be4":"markdown","80e25611":"markdown","5f3459c8":"markdown"},"source":{"0e535667":"import pandas as pd\n\nimport requests as rq\nfrom bs4 import BeautifulSoup\nfrom urllib.parse import urljoin","7d27abe2":"base_site =  \"https:\/\/www.imdb.com\/name\/nm0000151\/\"\n\nresponse = rq.get(base_site)\nresponse.status_code","b8257fe5":"html = response.content\nsoup = BeautifulSoup(html, 'html.parser')    # lxml,  html.parser,  html5lib,  xml","e335f681":"div_notes = soup.find_all(\"div\", {\"class\":\"filmo-category-section\"})\nlist(div_notes[0])[:5]   # it is too long so we take the first 5 \n","16060636":"len(div_notes[0])","0fb1acfb":"films=div_notes[0].find_all('b')\nfilms[:5]\n","6436f6c5":"len(films)\n","c0d15d5a":"film_titles=[l.find(\"a\").text for l in films ]\nfilm_titles[:5]","18b2d984":"film_years=div_notes[0].find_all(\"span\")  # spans have years\nfilm_years[0]","16f34f6c":"film_years[0].text.strip()\n","65785909":"film_years=[l.text.strip() for l in film_years]\nfilm_years[:5]","b1fb072d":"len(film_years)","23876521":"clean_links=[l.find(\"a\").get(\"href\") for l in films if l.find(\"a\").get('href') != None]\nclean_links[:5]","76a6c5ae":"len(clean_links)","f136a993":"film_urls=[ urljoin(base_site, l)   for l in clean_links  ]\nfilm_urls[:5]","8629992b":" film_rating = []\n film_director = []\n\n# Loop through each URL in note_urls\nfor url in film_urls:    \n    note_resp = rq.get(url)\n    film_html = note_resp.content    \n    film_soup = BeautifulSoup(film_html,'html.parser')  #lxml,  html.parser\n    film_rate = film_soup.find_all(\"span\",{\"class\":\"AggregateRatingButton__RatingScore-sc-1ll29m0-1 iTLWoV\"})  \n    film_dire = film_soup.find_all(\"a\", {\"class\":\"ipc-metadata-list-item__list-content-item ipc-metadata-list-item__list-content-item--link\"})   \n    title1 = [p.text for p in film_rate] \n    title2 = [p.text for p in film_dire] \n    film_rating.append(title1)\n    film_director.append(title2)\n ","4a208365":"film_rating[:10]","01a57696":"film_rating[8]","6ced9e63":"film_rating[8][0]","0928a20c":"len(film_rating[0])","02651285":"listt=[]\nfor i in film_rating:\n    if len(i)==0:\n        listt.append(\"\")\n    else:\n        listt.append(i[0])\nlistt[:16]","40135eba":"film_ratings= listt","6ce71246":"film_director[0]","64f146d9":"len(film_director)","28d29b02":"film_director[0][0]  # Each groups first [0] record has the right director name ","5f6e269f":"film_directors=[]\nfor i in film_director:\n    film_directors.append(i[0])\nfilm_directors[:5]","c891def8":"# Before merging, cheking the length of the each file\nprint(len(film_titles),len(film_directors),len(film_ratings),len(film_years),len(film_urls))","86b63d22":"# First 3 column from main page, the rest 2 columns from  multiple pages\nA=[\"film_title\",\"film_director\",\"film_rating\",\"film_year\",\"film_url\"]\nB=[film_titles,film_directors,film_ratings,film_years,film_urls]\n\nMorgan_Freeman_films= pd.DataFrame(dict(zip(A,B)))","defb345c":"Morgan_Freeman_films.sort_values(by=\"film_rating\",ascending=False)[:10]","455ec297":"Morgan_Freeman_films.sort_values(by=\"film_rating\")[:8]          # First 8","c76ec8d6":"Morgan_Freeman_films[:5]           # First 5 ","1050abf6":"Morgan_Freeman_films.to_csv(\"Morgan_Freeman_films.csv\")","10529875":"------","44a28d4a":"*  Morgan Freeman's total count of films is 139","50a7d43d":"# MORGAN FREEMAN films","1b91a377":"## URL Links ","1dbad58d":"## Film Directors","7acc94b8":"##  Unreleased  movies  ","a869fa44":"## Film Ratings","a0894892":"![image.png](attachment:055e6008-a06a-40f0-ab99-d3df708f7333.png)","e8623fcb":"#  Web Scraping with Beautiful Soup\n","67a7b2e1":"All films are listed below the div class: filmo-category-section","e6a0e2da":"## Geting Film Ratings and Director Names from multiple links","3336cb59":"## Extracting Data From Html Body ","4115312e":"##  Top 10  highest ranked ","9480aeed":"## Joining  all informations ","dd3f2ad4":"#### Description:\n1. Find favorite actress'\/actor's imdb page\n2. Get all the links to his person's movies\n3. Get each movie's name, director and imdb score","32970a3b":"# Actor: MORGAN FREEMAN\n #### Web Site: imdb.com\n","ee3ed853":"##  Unscored movies  ","c2940dbf":"![image.png](attachment:d0e3dc69-c2fe-4af3-99f2-1ff7a01f2e0d.png)","1b894364":"#### the status_code=200 shows that the web site is reachable","18dd4be4":"## Production year","80e25611":"![image.png](attachment:4e42d334-fe68-4c34-ba05-627768b4fdff.png)","5f3459c8":"## Film Names"}}