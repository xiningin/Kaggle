{"cell_type":{"531e04b1":"code","90e997da":"code","3d56dc70":"code","2044fd77":"code","5b6eda57":"code","6f3e65b3":"code","99658e58":"code","d2311df4":"code","f39e242a":"code","22c17bec":"markdown","1c24f7b7":"markdown","79e1976f":"markdown","03b8eaeb":"markdown","66eb0bd9":"markdown","fbd95713":"markdown","7223de73":"markdown","a5d51ae0":"markdown","73cf661f":"markdown","fa81f92b":"markdown","c4d1727f":"markdown","c6b6d097":"markdown","e8e03f44":"markdown","3a305da2":"markdown"},"source":{"531e04b1":"import re\nimport math\nimport time\nimport numpy as np\nimport pandas as pd","90e997da":"import requests\nimport urllib.request\nfrom bs4 import BeautifulSoup\nfrom urllib.request import urlopen\n\nurl = 'https:\/\/en.wikipedia.org\/wiki\/List_of_countries_by_sex_ratio'\nhtml = urlopen(url) \nsoup = BeautifulSoup(html, 'html.parser')","3d56dc70":"tables = soup.find_all('table')\n\n# ---- Validate input propriety ---- #\ndef process_num(num):\n    if not math.isnan(float(num)):\n        res = float(re.sub(r'[^\\w\\s.]','',num))\n    else:\n        res = num\n    return res\n\n# ----- Validate cell propriety ---- #\ndef is_cell_valid(cells):\n    for i in range(len(cells)):\n        if cells[i].text.strip() == 'N\/A':\n            return False\n    return True\n\n# ---- Validate string propriety --- #\ndef make_str_valid( str ):\n    ind_delim = str.find('(')\n\n    if ind_delim != -1 :\n        wrd = str[:ind_delim-1]\n    else:\n        wrd = str\n        \n    return wrd","2044fd77":"countries, Sex_R = [], []\n\nfor table in tables:\n    rows = table.find_all('tr')\n    \n    for row in rows:\n        cells = row.find_all('td')\n        \n        if ( len(cells) > 1 and is_cell_valid(cells) ):\n            # Col_1 :: country\n            country = cells[0]\n            country_strip = country.text.strip()\n            countries.append( make_str_valid( country_strip ))\n            \n            # Col_2 :: sex-ratio\n            col_last = len(cells)-1\n            S_R = cells[col_last]\n            Sex_R.append(process_num(S_R.text.strip()))","5b6eda57":"# Instantiate data frame\ndf = pd.DataFrame({'Country':countries, 'Sex-Ratio':Sex_R})\n\n# Clean data-frame ( Duplicates & NaNs )\ndf[df.duplicated()]\ndf = df.drop_duplicates(subset=['Country'], keep='last').dropna()\ndf.sample(15)","6f3e65b3":"country_raw = pd.read_csv('https:\/\/raw.githubusercontent.com\/lukes\/ISO-3166-Countries-with-Regional-Codes\/master\/all\/all.csv')\ndf_c = country_raw.iloc[:, [0,2]]\ndf_c = df_c.rename(columns={'name':'Country', 'alpha-3':'ISO-code'})\ndf_c = df_c.drop_duplicates(subset=['Country'], keep='last').dropna()\n\n# Manual modification of the data\ndf_c.at[ df_c[df_c['Country']=='Viet Nam'].index.values[0], 'Country' ] = 'Vietnam'\ndf_c.at[ df_c[df_c['Country']=='United States of America'].index.values[0], 'Country' ] = 'United States'\ndf_c.at[ df_c[df_c['Country']=='Iran (Islamic Republic of)'].index.values[0], 'Country' ] = 'Iran'","99658e58":"df_c.at[ df_c[df_c['Country']=='Russian Federation'].index.values[0], 'Country' ] = 'Russia'\ndf_c.at[ df_c[df_c['Country']=='United Kingdom of Great Britain and Northern Ireland'].index.values[0], 'Country' ] = 'United Kingdom'\ndf_c.at[ df_c[df_c['Country']=='Venezuela (Bolivarian Republic of)'].index.values[0], 'Country' ] = 'Venezuela'\ndf_c.at[ df_c[df_c['Country']=='Korea (Democratic People\\'s Republic of)'].index.values[0], 'Country' ] = 'Korea, North'\ndf_c.at[ df_c[df_c['Country']=='Korea, Republic of'].index.values[0], 'Country' ] = 'Korea, South'\ndf_c.at[ df_c[df_c['Country']=='Bolivia (Plurinational State of)'].index.values[0], 'Country' ] = 'Bolivia'\ndf_c.at[ df_c[df_c['Country']=='C\u00f4te d\\'Ivoire'].index.values[0], 'Country' ] = 'Ivory Coast'\ndf_c.at[ df_c[df_c['Country']=='Congo'].index.values[0], 'Country' ] = 'Congo, Republic of the'\ndf_c.at[ df_c[df_c['Country']=='Tanzania, United Republic of'].index.values[0], 'Country' ] = 'Tanzania'\n\n# Using the ISO-3166 coding standard to map countries\ndf['ISO-code'] = df['Country'].map(df_c.set_index('Country')['ISO-code'])\n# Clean data-frame ( Duplicates & NaNs )\ndf.isna().sum()\ndf = df.dropna()","d2311df4":"import plotly.express as px\n\nthres = 1.3\ndf_th = df.drop(df[ df['Sex-Ratio'] > thres ].index)\n\n# color pallete @ https:\/\/plotly.com\/python\/builtin-colorscales\/\nfig = px.choropleth(df_th, locations='ISO-code',\n                color=\"Sex-Ratio\", hover_name=\"Country\",\n                    color_continuous_scale=px.colors.sequential.Sunset, projection=\"natural earth\")\nfig.update_layout(title={'text':'Sex-Ratio per country', 'y':0.95, 'x':0.5, 'xanchor':'center', 'yanchor':'top'})\nfig.show() # Sunset \/ Bluered \/ Electric","f39e242a":"import plotly.express as px\n\nthres = 1.3\ndf_th = df.drop(df[ df['Sex-Ratio'] > thres ].index)\n\n# color pallete @ https:\/\/plotly.com\/python\/builtin-colorscales\/\nfig = px.choropleth(df_th, locations='ISO-code',\n                color=\"Sex-Ratio\", hover_name=\"Country\",\n                    color_continuous_scale=px.colors.sequential.Sunset, projection=\"orthographic\")\nfig.update_layout(title={'text':'Sex-Ratio per country', 'y':0.95, 'x':0.5, 'xanchor':'center', 'yanchor':'top'})\nfig.show() # Sunset \/ Bluered \/ Electric","22c17bec":"<img src=https:\/\/upload.wikimedia.org\/wikipedia\/en\/8\/80\/Wikipedia-logo-v2.svg width=150 \/>","1c24f7b7":"$3.$ Extract **relevant data** from downloaded web page :","79e1976f":"$$\n\\circ \\text{ Comments (\ud83d\udcac) , feedback (\ud83e\udd14) and upvotes (\ud83d\udc4d) are much welcome ! } \\circ \n$$","03b8eaeb":"$2.$ Define utilities for processing the amounts of data :","66eb0bd9":"### $ \\text{Abstract}$\n\nThis tutorial demonstrates how to utilize a simple **scraping** techinque to extract data from **Wikipedia**'s [**list of countries**](https:\/\/en.wikipedia.org\/wiki\/Category:Lists_of_countries) by category. The database contains a huge amounts of analyzed data at different **categories**, which was collected in order to examine trends, and compare them between different countries.\n\n<img src='https:\/\/github.com\/Daniboy370\/Machine-Learning\/blob\/master\/Misc\/Animation\/VID-out-Wiki.gif?raw=true' width=550 \/>\n\n","fbd95713":"<a id=\"3\"><\/a> \n### $\\text{Results}$\n\nPresenting the cleaned dataframe on a world map using the amazing [**choropleth**](https:\/\/plotly.github.io\/plotly.py-docs\/generated\/plotly.express.choropleth.html) library \ud83d\uddfa\ufe0f :","7223de73":"Another option is apply the ***orthographic*** option, which enables an interactive presentation of the globe \ud83c\udf10 : ","a5d51ae0":"$4.$ **Instantiate** data frame :","73cf661f":"$5.$ Manual **fixing** of abnormal country names :","fa81f92b":"<a id=\"2\"><\/a> \n### $ \\text{Scraping pipeling : \ud83d\udee0\ufe0f}$\n\n$1.$ Import relevant packages and extracting data from desired web page :","c4d1727f":"### $\\text{Table of Contents}$\n\n* [**Choosing criterion** : \ud83d\udc40 ](#1)\n* [**Scraping pipeling** : \ud83d\udee0\ufe0f](#2)\n* [**Restuls** : \ud83d\udcc9](#3)","c6b6d097":"$$\n\u2212fin\u2212\n$$","e8e03f44":"<a id=\"1\"><\/a> \n### $ \\text{Chosen criterion : \u2642\ufe0f \/ \u2640\ufe0f }$\n\nAmong all categories, the kernel will be focused on an ineresting comparable criterion - [**Human sex ratio**](https:\/\/en.wikipedia.org\/wiki\/Human_sex_ratio).\n \n#### $\\text{What is this ? }$\n\n**Sex-ratio** is a demographic measure that denotes the **males** to **females** ratio in a population. Interestingly, most sexual species exhibit a 1.1 sex ratio at birth. However, despite being biased towards males at birth, over time the sex ratio changes due to several factors [[**1**](https:\/\/en.wikipedia.org\/wiki\/Half_the_Sky#:~:text=294%20pp.&text=763098931-,Half%20the%20Sky%3A%20Turning%20Oppression%20into%20Opportunity%20for%20Women%20Worldwide,by%20Knopf%20in%20September%202009.)] :\n* Sex-selective infanticide [[**2**](https:\/\/en.wikipedia.org\/wiki\/Infanticide)]\n* Sex-selective abortion [[**3**](https:\/\/qz.com\/335183\/heres-why-men-on-earth-outnumber-women-by-60-million\/)]\n* Deliberate gender control [[**4**](https:\/\/pulitzercenter.org\/reporting\/single-man-one-chinese-bachelors-search-love)]\n* War and crime casualties [[**5**](http:\/\/data.un.org\/Data.aspx?q=sex+ratio+birth&d=PopDiv&f=variableID%3a52)]\n\nFor example, the following pyramid graph shows the sex-ratio distribution across age in Bahrain, caused mostly by policies that restrict female spouses and children of immigrant workers :\n<img src='https:\/\/upload.wikimedia.org\/wikipedia\/commons\/4\/49\/Pyramide_Bahrein.PNG' width=600 \/>\n\n","3a305da2":"<img src='https:\/\/github.com\/Daniboy370\/Temp_upload\/blob\/master\/VID-Globe.gif?raw=true' width=400 \/>"}}