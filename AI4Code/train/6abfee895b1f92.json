{"cell_type":{"c5bae11f":"code","434d27f8":"code","74982207":"code","289d08d3":"code","f69757d8":"code","1e6ca5bd":"code","39f86698":"code","839bc3fb":"code","5589b23d":"code","85298100":"code","6aa4f4ef":"code","52ff42a4":"code","b06709f8":"code","1b2d8866":"code","a7c06f04":"code","09526a82":"code","fd857e57":"code","6afce52a":"code","4318b76b":"code","836f663b":"code","89ba46c9":"code","48ef4942":"code","1570fbbf":"code","8aa57ec9":"code","ecc0a588":"code","15b25614":"code","9dac55c6":"code","ac39ad95":"code","0806fc93":"code","dce35941":"code","0be27e19":"code","37dbf569":"markdown","77cac75c":"markdown","7551e593":"markdown","3dd744d1":"markdown","d5507d1a":"markdown","5e929c32":"markdown","567f9739":"markdown","0534408c":"markdown","95e278e0":"markdown","836b47f4":"markdown","f4cee426":"markdown","6ed070cc":"markdown","4539ecf5":"markdown","6f184f0d":"markdown","ba70fab9":"markdown","43d6dd15":"markdown","4b138d17":"markdown","002fec0d":"markdown","3377bad9":"markdown","94dc6820":"markdown","a4ac04a0":"markdown","b4be2e6e":"markdown"},"source":{"c5bae11f":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 20GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","434d27f8":"# Just run on 1st instance on Local machine\n!pip install plotly plotly-geo\n!pip install pycountry_convert","74982207":"import numpy as np\nimport pandas as pd\nimport warnings\nwarnings.filterwarnings(\"ignore\")\n#import matplotlib.pyplot as plt\n#import seaborn as sns\n#import squarify\nimport pycountry_convert as pc\nimport plotly.express as px\nimport plotly.graph_objects as go\nfrom plotly.subplots import make_subplots","289d08d3":"# Default theme & color code I will be using\n#plt.style.use('seaborn-dark')\n#theme = 'plotly_dark'\ngreen = '#009473'\nred = '#dd4124'","f69757d8":"#### Importing files & copying it\nhappiness2021 = pd.read_csv('..\/input\/world-happiness-report-2021\/world-happiness-report-2021.csv')\nhappiness = pd.read_csv('..\/input\/world-happiness-report-2021\/world-happiness-report.csv')\npop = pd.read_csv('..\/input\/world-bank-data-1960-to-2016-extended\/population-by-country-2020\/population_by_country_2020.csv')","1e6ca5bd":"df1 = happiness2021.copy()\ndf2 = happiness.copy()","39f86698":"df1.head(3)","839bc3fb":"df1.rename(columns={'Country name': 'Country',\n                    \"Healthy life expectancy\":\"Life Expectancy\",\n                    \"Freedom to make life choices\":\"Freedom\",\n                    \"Perceptions of corruption\":\"Corruption\",\n                   'Logged GDP per capita': 'GDP per capita'},inplace=True)","5589b23d":"df1.drop(['Explained by: Log GDP per capita','Explained by: Social support','Explained by: Healthy life expectancy','Ladder score in Dystopia',\n          'Explained by: Freedom to make life choices','Explained by: Generosity','Explained by: Perceptions of corruption','Dystopia + residual',\n         'Standard error of ladder score','upperwhisker','lowerwhisker'], axis=1,inplace=True)","85298100":"df2.head(3)","6aa4f4ef":"df2.rename(columns={'Country name': 'Country',\n                    'Healthy life expectancy at birth': 'Life Expectancy',\n                    'Freedom to make life choices': 'Freedom',\n                    'Perceptions of corruption': 'Corruption',\n                   'Log GDP per capita': 'GDP per capita','Life Ladder':'Ladder score'},inplace=True)\ndf2.drop(['Positive affect','Negative affect'],axis=1,inplace=True)","52ff42a4":"pop.head(3)","b06709f8":"pop.rename(columns={'Country (or dependency)': 'Country'},inplace=True)","1b2d8866":"t_6=df1.head(6)\nb_6=df1.tail(6)","a7c06f04":"fig = make_subplots(rows=1, cols=2,\n                   column_width=[0.5,0.5],\n                   subplot_titles=['Top 6 Countries in Index', 'Bottom 6 Countries in Index'])\nfig.append_trace(go.Bar(x=t_6['Ladder score'],\n                       y=t_6['Country'],\n                       orientation='h',\n                       marker={'color': green,'line': dict(color=green, width=1)},\n                       name='',\n                       text=t_6['Regional indicator']\n                       ), 1,1\n                )\nfig.append_trace(go.Bar(x=b_6['Ladder score'],\n                       y=b_6['Country'],\n                        orientation='h',\n                        marker={'color': red,'line': dict(color=red, width=1)},\n                        name='',\n                        text=b_6['Regional indicator']\n                       ), 1,2\n                )\nfig.update_layout(\n    #template='plotly_dark',\n    showlegend=False,\n    title_text='Overview of World Happiness Index 2021',\n    title_font_size=24)\nfig.update_annotations(yshift=5) # Shifts Title of subplot little above figure\nfig.show()","09526a82":"fig = px.box(data_frame=df1,\n            x='Ladder score',orientation='h',width=800,height=300,\n            labels={'Ladder score': 'Happiness Score'})\nfig.update_layout(\n    #template='plotly_dark',\n    title_text='Box Plot of Ladder Score',\n    title_font_size=24)\nfig.show()\nmean_lad=df1['Ladder score'].mean()\nmedian_lad=df1['Ladder score'].median()\nprint('mean=',mean_lad)\nprint('median=',median_lad)","fd857e57":"region_score = df1.groupby('Regional indicator')['Life Expectancy',\n                                                 'GDP per capita','Corruption',\n                                                 'Freedom','Ladder score'].mean().round(decimals=2).sort_values('Ladder score').reset_index()","6afce52a":"region_score","4318b76b":"color_dict = []\nfor i in region_score['Ladder score']:\n    if i>df1['Ladder score'].mean():\n        color_dict.append(green)\n    else:\n        color_dict.append(red)\nfig = go.Figure()\nfig.add_trace(go.Bar(x=region_score['Ladder score'],\n                     y=region_score['Regional indicator'],\n                     orientation='h',\n                     marker=dict(\n                     color=color_dict,\n                     line=dict(color=color_dict, width=1)\n                )))\nfig.update_layout(title_text='Mean Ladder score In different Region',\n                  title_font_size=22)\nfig.show()","836f663b":"fig = px.scatter(region_score,\n    x=\"Life Expectancy\", y=\"Ladder score\", size=\"GDP per capita\", color=\"Regional indicator\",\n    labels={\"Ladder score\": 'Happiness Score'},size_max=7,\n    title=\"Ladder Score vs Life Expectancy vs GDP per capita in various regions:<br>(Size of Bubble describes GDP per Capita)\",\n                 opacity=0.7,hover_name='Regional indicator',hover_data={\"Regional indicator\":False})\nfig.update_traces(marker_sizemode='diameter')\nfig.show()","89ba46c9":"df_country_code = df1.copy()\n\n#ADAPTING TO THE ISO 3166 STANDARD\ndf_country_code.loc[df_country_code['Country'] == 'Taiwan Province of China', 'Country'] = 'Taiwan, Province of China' \ndf_country_code.loc[df_country_code['Country'] == 'Hong Kong S.A.R. of China', 'Country'] = 'Hong Kong' \ndf_country_code.loc[df_country_code['Country'] == 'Congo (Brazzaville)','Country'] = 'Congo' \ndf_country_code.loc[df_country_code['Country'] == 'Palestinian Territories','Country'] = 'Palestine, State of' \n\ndf_country_code.drop(index=df_country_code[df_country_code['Country'] == 'Kosovo'].index, inplace=True) # Kosovo Code agreed on not to use by ISO 3166\ndf_country_code.drop(index=df_country_code[df_country_code['Country'] == 'North Cyprus'].index, inplace=True) # Not part of the ISO 3166 standard\n\n# Making coulm with country code\ndf_country_code['c_code']=df_country_code['Country'].apply(lambda x: pc.country_name_to_country_alpha3(x,))\ncol_code=[]\nfor i in df_country_code['Ladder score']:\n    if i>=median_lad:\n        col_code.append(red)\n    else:\n        col_code.append(green)","48ef4942":"# Making the figure\nfig = px.choropleth(df_country_code, locations='c_code',\n                    color='Ladder score',\n                    hover_name='Country',\n                    hover_data={'c_code':False,\n                               'GDP per capita': True,\n                               'Life Expectancy': True,\n                               'Freedom': True},\n                    color_continuous_scale=col_code,\n                    labels={'Ladder score': 'Happiness Score'},\n                    title='World Map View'\n                   )\nfig.update_traces(showlegend=False)\nfig.show()","1570fbbf":"fig = px.scatter(df1,\n    x=\"Life Expectancy\", y=\"Ladder score\", size=\"GDP per capita\", color=\"Regional indicator\",\n    labels={\"Ladder score\": 'Happiness Score'},size_max=7,\n    title=\"Ladder Score vs Life Expectancy vs GDP per capita in various Countries: \\\n                 <br>Size of Bubble describes GDP per Capita\",\n                 hover_name='Country',\n                 opacity=0.7)\nfig.update_traces(marker_sizemode='diameter')\nfig.show()","8aa57ec9":"\nfig = px.scatter(df1,\n    x=\"Freedom\", y='Corruption', size=\"Ladder score\", color=\"Regional indicator\",\n    labels={\"Ladder score\": 'Happiness index Score'},size_max=7,\n    title=\"Freedom vs Corruption vs Happiness Score in different Countries<br> \\\n                 Size of Bubble propertional to Happiness Score\",\n                 opacity=0.7,hover_name='Country')\nfig.update_traces(marker_sizemode='diameter')\nfig.show()","ecc0a588":"df1pop = pd.merge(df1, pop, how='inner', on='Country')\ndf1pop.head()","15b25614":"df1pop.info()","9dac55c6":"# Let's see inside those objects\nprint(df1pop['Urban Pop %'].value_counts(dropna=False))\nprint(df1pop['World Share'].value_counts(dropna=False))\nprint(df1pop['Population (2020)'].value_counts(dropna=False))\nprint(df1pop['Yearly Change'].value_counts(dropna=False))\nprint(df1pop['Med. Age'].value_counts(dropna=False))\nprint(df1pop['Fert. Rate'].value_counts(dropna=False))","ac39ad95":"# Fix those % & NA\ndf1pop = df1pop[df1pop['Urban Pop %'] != 'N.A.']\ndf1pop['Urban Pop %'] = df1pop['Urban Pop %'].apply(lambda x: float(x.rstrip('%'))\/100)\ndf1pop['World Share'] = df1pop['World Share'].apply(lambda x: float(x.rstrip('%'))\/100)\ndf1pop['Yearly Change'] = df1pop['Yearly Change'].apply(lambda x: float(x.rstrip('%'))\/100)\ndf1pop['Med. Age'] = df1pop['Med. Age'].astype('float')\ndf1pop['Fert. Rate'] = df1pop['Fert. Rate'].astype('float')","0806fc93":"# We need to bin some values to show them in plot\ndf1pop['pop_quantile'] = pd.qcut(df1pop['Population (2020)'], 10, labels=False)\ndf1pop['density_quantile'] = pd.qcut(df1pop['Density (P\/Km\u00b2)'], 10, labels=False)","dce35941":"fig = px.scatter(df1pop,\n    x=\"Med. Age\", y='Ladder score', size=df1pop[\"pop_quantile\"]**2, color=\"Regional indicator\",\n    labels={\"Ladder score\": 'Happiness index Score',\n           'pop_quantile': 'Population Quantile'},size_max=20,\n    title=\"Happiness Score, Median Age and Population         \",\n                 opacity=0.7,hover_name='Country')\nfig.update_traces(marker_sizemode='area')\nfig.update_traces(showlegend=True)\nfig.show()","0be27e19":"fig = px.scatter(df1pop,\n    x=\"Fert. Rate\", y='GDP per capita', size=\"Med. Age\", color=\"Regional indicator\",\n    labels={\"Ladder score\": 'Happiness Score',\n           'pop_quantile': 'Population Quantile',\n           'Fert. Rate': 'Fertility Rate'},size_max=20,\n    title=\"Between Fertility Rate vs GDP vs Median Age\",\n                 opacity=0.7,hover_name='Country',hover_data=['Fert. Rate','GDP per capita','Med. Age','Ladder score'])\nfig.update_traces(marker_sizemode='area')\nfig.update_traces(showlegend=True)\nfig.show()","37dbf569":"## Let's take a overlook at the data & Fix few columns","77cac75c":"We can see that most points are in upper right plot.\nIt explains an inverse relation between Corruption & Freedom.","7551e593":" - df2 seems cleaned mostly, but i can't make sense of few columns","3dd744d1":"It seems that **happier** countries have older population. There is a linear pattern with Median age & happiness score.","d5507d1a":"- We need to fix few column names","5e929c32":"## Let's see Region wise Happiness Score\n### Let's see Ladder Score values in a Boxplot & get mean, median","567f9739":"### Let's see the Table","0534408c":"## Region wise Comparision using mean","95e278e0":"# Happiness Index\n\nWe'll be doing pure **Explanatory data analysis** to extract as much as information as possible.\nWe'll also import Population databse to see any correlation between Happiness Index data & Population.\nSince data is already cleaned, there isn't much to do except renaming few columns & dropping few. \n\nI'll be using only Plotly library to visualize the data & hope to learn the library while doing this analysis.","836b47f4":"We can see columns like 'Urban Pop %', 'World Share', 'Med. Age', 'Fert. Rate' etc are object while it should be int or float.\nWe'll have to fix them.","f4cee426":"- We don't need few columns, dropping them for now","6ed070cc":"- Making a copy of data.","4539ecf5":"## Happiest & Unhappiest Countries in 2021\n\nWe are going to take a look at Top 6 & Bottom 6 Countries in the List. Happiness is measured through the Ladder score.","6f184f0d":"We have to fix objects with NA values & string values to proper datatype","ba70fab9":"We can see that Most Western Europe has Higher Life Expectancy with higher Happiness Index. While Sub-Saharan Africa has comparatively lower Life Expectancy & lower Happiness Index Score. Commonwealth of Independent States are clustered mostly in the middle.\n\nThe Scatterplot seems linear, We can assume countries with Happier people tend to live longer.","43d6dd15":"### Let's see if there is any pattern between Median Age, Happiness score & Population","4b138d17":"### Happiness Score vs Life Expetency vs GDP per capita","002fec0d":"## Population\nLet's add population data into account for further study","3377bad9":"### Happiness index vs Corruption vs Freedom in different Region","94dc6820":"Also as we saw before, happier countries have higher median age. Here Median age is described as the size of marker & we can see that bigger bubble are toward left-top of plot, i.e High GDP per Capita & low Fertility Rate\n","a4ac04a0":"### Between Fertility Rate vs GDP vs Median Age","b4be2e6e":"## Region wise Comparision in different Countries\n\n### Let's First see World Map"}}