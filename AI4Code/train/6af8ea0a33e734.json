{"cell_type":{"bf64c4a8":"code","329de2ce":"code","c577dbfb":"code","b141601c":"code","e19d5e94":"code","432bfbd9":"code","db5fdf9d":"code","19bd2e64":"code","cf86f286":"code","3559d230":"code","318ea221":"code","63549e4b":"code","82d7d340":"code","7c3ff9f1":"code","90e4e4f3":"code","864fc91d":"code","6812262e":"code","e21f6fe6":"code","967c0aa1":"code","dfa3692d":"code","cc8830cf":"code","56e1233d":"code","f0bdb7db":"code","a65802ce":"code","60f7d0fa":"code","1161742b":"code","89abf61e":"code","e7e52155":"code","f842e06e":"code","5218c82c":"code","69d695ac":"code","4f75ca90":"code","86f82428":"code","13a1c548":"code","cb7af629":"code","a7d8e595":"code","cb8f5e22":"code","dda84dc8":"code","31f7af7b":"code","7d1ee3cf":"code","c8fd6ff0":"code","75fc318c":"code","1c16e5fc":"code","1e984b79":"code","78c1ea6b":"code","89449996":"code","b029e272":"code","8e5021d8":"code","3ba1e724":"markdown","36681981":"markdown","8d2bc152":"markdown","f6c0c5e4":"markdown","fa7850b3":"markdown","77f6640a":"markdown","a9fb2680":"markdown","8ea19cbe":"markdown","7cd587af":"markdown","6b2119a2":"markdown","4d2182a0":"markdown","bff4db41":"markdown","df4b80c8":"markdown","1d315660":"markdown","ac1d5f74":"markdown","fc846d6f":"markdown","135749c8":"markdown","613e6e4a":"markdown","66a2c717":"markdown","e932587a":"markdown","c458688d":"markdown","17f48984":"markdown","e697db3d":"markdown","3d4ac736":"markdown","593fd5c8":"markdown","ec621f8e":"markdown","5cddd5b2":"markdown","5c26dbf5":"markdown","5a693d85":"markdown","350ac420":"markdown","a8f376ba":"markdown","9ab4b6a2":"markdown","590b27b9":"markdown","f551fd23":"markdown","acfd8ea3":"markdown","c9e8751d":"markdown","89f2ff5d":"markdown","f4293c34":"markdown","ffd9b7fb":"markdown","bb98a962":"markdown","750eb3cd":"markdown","d6f742c7":"markdown","8891a000":"markdown","92b963d8":"markdown","a599125c":"markdown","a7800b63":"markdown","11427633":"markdown","75665ca6":"markdown","de0ba0ff":"markdown","5e4e1786":"markdown","c0cce7fe":"markdown","95599ab1":"markdown","0463215a":"markdown","5c7a4d21":"markdown","05c9b374":"markdown","94c26064":"markdown","95bba43f":"markdown","86de3f0e":"markdown","3784c351":"markdown","e0de8248":"markdown","b0b5b35f":"markdown"},"source":{"bf64c4a8":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.ensemble import RandomForestRegressor\nimport warnings\nwarnings.filterwarnings('ignore')","329de2ce":"df=pd.read_csv('..\/input\/medical-insurance-premium-prediction\/Medicalpremium.csv')","c577dbfb":"df.head()","b141601c":"print('Number of rows in the dataset',df.shape[0])\nprint('Number of columns in the dataset',df.shape[1])","e19d5e94":"df.info()","432bfbd9":"#Updating the  datatype for object variable\n\nfor i in df[['Diabetes', 'BloodPressureProblems', 'AnyTransplants', 'AnyChronicDiseases', 'KnownAllergies', 'HistoryOfCancerInFamily', 'NumberOfMajorSurgeries']] : \n     df[i]=df[i].astype('object')\n        ","db5fdf9d":"df.info()","19bd2e64":"# We Observe that the data type has been updated.","cf86f286":"df.isnull().sum()","3559d230":"# We observe that there are no Null Values in the Dataset.","318ea221":"dups=df.duplicated()\nprint('Number of duplicate records',dups.sum())","63549e4b":"# Seprating the object and numeric variable\ncat = []\nnum = []\nfor i in df.columns:\n    if df[i].dtype=='object':\n        cat.append(i)\n    else:\n        num.append(i)","82d7d340":"num,cat","7c3ff9f1":"df[num].describe().T","90e4e4f3":"df[cat].describe().T","864fc91d":"for i in df[cat]:\n    print(i ,df[i].nunique())\n    print(df[i].value_counts())\n    print('************************************************')","6812262e":"for i in df[num]:\n    fig, axes = plt.subplots(nrows=1,ncols=2,figsize=(8,4))\n    sns.histplot(df[i],kde=True,ax=axes[0],color='red')\n    sns.boxplot(df[i],ax=axes[1],color='green')","e21f6fe6":"f,ax=plt.subplots(2,2,figsize=(15,15))\ndf.Age.plot.hist(bins = 20, edgecolor = 'black',color = 'green',ax=ax[0][0])\nax[0][0].set_title('Distribution of age among users')\n\ndf.PremiumPrice.plot.hist(bins = 25, edgecolor = 'black',color = 'pink',ax=ax[0][1])\nax[0][1].set_title('Distribution of PremiumPrice of users')\n\ndf.Height.plot.hist(bins = 25, edgecolor = 'black',color = 'red',ax=ax[1][0])\nax[1][0].set_title('Distribution of Height of users')\n\ndf.Weight.plot.hist(bins = 25, edgecolor = 'black',color = 'violet',ax=ax[1][1])\nax[1][1].set_title('Distribution of Weight of users')\n","967c0aa1":"print('Distribution of Age')\nprint('Oldest User was of:',round(df['Age'].max()),'Years')\nprint('Youngest User was of:',round(df['Age'].min()),'Years')\nprint('Average Use age:',round(df['Age'].mean()),'Years')\nprint('**************************************************')\n\nprint('Distribution of Premium Price')\nprint('lowest Premium of a User was of:',round(df['PremiumPrice'].max()))\nprint('Youngest User was of:',round(df['PremiumPrice'].min()))\nprint('Average User Premium Price:',round(df['PremiumPrice'].mean()))\nprint('**************************************************')\n\nprint('Distribution of Height')\nprint('shortest Height of a User was of:',round(df['Height'].max()))\nprint('tallest User was of:',round(df['Height'].min()))\nprint('Average Height of  User:',round(df['Height'].mean()))\nprint('**************************************************')\n\n","dfa3692d":"f,ax=plt.subplots(2,3,figsize=(10,10))\ndf['Diabetes'].value_counts().plot.pie(explode=[0,0.1],autopct='%1.1f%%',ax=ax[0][0])\ndf['AnyTransplants'].value_counts().plot.pie(explode=[0,0.1],autopct='%1.1f%%',ax=ax[0][1])\ndf['AnyChronicDiseases'].value_counts().plot.pie(explode=[0,0.1],autopct='%1.1f%%',ax=ax[0][2])\ndf['KnownAllergies'].value_counts().plot.pie(explode=[0,0.1],autopct='%1.1f%%',ax=ax[1][0])\ndf['HistoryOfCancerInFamily'].value_counts().plot.pie(explode=[0,0.1],autopct='%1.1f%%',ax=ax[1][1])\ndf['NumberOfMajorSurgeries'].value_counts().plot.pie(explode=[0,0,0,0],autopct='%1.1f%%',ax=ax[1][2])","cc8830cf":"sns.lineplot(df['Age'],df['PremiumPrice'])\nsns.lmplot(x='Age', y ='PremiumPrice',data=df)","56e1233d":"print('Oldest User was of:',round(df['Age'].max()),'Years')\nprint('Youngest User was of:',round(df['Age'].min()),'Years')\nprint('Average User age:',round(df['Age'].mean()),'Years')","f0bdb7db":"sns.lineplot(df['Weight'],df['PremiumPrice'])\nsns.lmplot(x='Weight', y ='PremiumPrice',data=df)","a65802ce":"sns.lineplot(df['Height'],df['PremiumPrice'])\nsns.lmplot(x='Height', y ='PremiumPrice',data=df)","60f7d0fa":"f,ax=plt.subplots(1,2,figsize=(15,5))\nsns.barplot(data = df, x='NumberOfMajorSurgeries',y='PremiumPrice',ax=ax[0])\nsns.boxplot(data = df, x='NumberOfMajorSurgeries',y='PremiumPrice',ax=ax[1])","1161742b":"f,ax=plt.subplots(1,2,figsize=(15,5))\nsns.barplot(data = df, x='HistoryOfCancerInFamily',y='PremiumPrice',ax=ax[0])\nsns.boxplot(data = df, x='HistoryOfCancerInFamily',y='PremiumPrice',ax=ax[1])","89abf61e":"f,ax=plt.subplots(1,2,figsize=(15,5))\nsns.barplot(data = df, x='KnownAllergies',y='PremiumPrice',ax=ax[0])\nsns.boxplot(data = df, x='KnownAllergies',y='PremiumPrice',ax=ax[1])","e7e52155":"f,ax=plt.subplots(1,2,figsize=(15,5))\nsns.barplot(data = df, x='AnyChronicDiseases',y='PremiumPrice',ax=ax[0])\nsns.boxplot(data = df, x='AnyChronicDiseases',y='PremiumPrice',ax=ax[1])","f842e06e":"f,ax=plt.subplots(1,2,figsize=(15,5))\nsns.barplot(data = df, x='AnyTransplants',y='PremiumPrice',ax=ax[0])\nsns.boxplot(data = df, x='AnyTransplants',y='PremiumPrice',ax=ax[1])","5218c82c":"f,ax=plt.subplots(1,2,figsize=(15,5))\nsns.barplot(data = df, x='Diabetes',y='PremiumPrice',ax=ax[0])\nsns.boxplot(data = df, x='Diabetes',y='PremiumPrice',ax=ax[1])","69d695ac":"f,ax=plt.subplots(1,2,figsize=(15,5))\nsns.barplot(data = df, x='BloodPressureProblems',y='PremiumPrice',ax=ax[0])\nsns.boxplot(data = df, x='BloodPressureProblems',y='PremiumPrice',ax=ax[1])","4f75ca90":"sns.lmplot(x = 'Age', y = 'PremiumPrice', data=df, hue='HistoryOfCancerInFamily', palette='Set1')","86f82428":"sns.lmplot(x = 'Age', y = 'PremiumPrice', data=df, hue='Diabetes', palette='Set2')","13a1c548":"sns.lmplot(x = 'Age', y = 'PremiumPrice', data=df, hue='AnyTransplants', palette='Set1')","cb7af629":"sns.lmplot(x = 'Age', y = 'PremiumPrice', data=df, hue='AnyChronicDiseases', palette='Set2')","a7d8e595":"sns.lmplot(x = 'Age', y = 'PremiumPrice', data=df, hue='KnownAllergies', palette='Set1')","cb8f5e22":"#### Analyze the Premium Price by age according to the Number Of Major Surgeries.","dda84dc8":"sns.lmplot(x = 'Age', y = 'PremiumPrice', data=df, hue='NumberOfMajorSurgeries')","31f7af7b":"sns.lmplot(x = 'Age', y = 'PremiumPrice', data=df, hue='BloodPressureProblems', palette='Set1')","7d1ee3cf":"sns.pairplot(df,corner=True)","c8fd6ff0":"sns.heatmap(df.corr(),annot=True,cmap='cool')","75fc318c":"df.columns","1c16e5fc":"X = df.drop('PremiumPrice',axis=1)\ny = df.PremiumPrice","1e984b79":"scalar =  StandardScaler()\nX.Age = scalar.fit_transform(X[['Age']])\nX.Height = scalar.fit_transform(X[['Height']])\nX.Weight = scalar.fit_transform(X[['Weight']])","78c1ea6b":"# Splitting the Dataset into 75 :25\nX_train,X_test,y_train,y_test = train_test_split(X,y,test_size=0.25,random_state=43)","89449996":"\n#A random forest is a meta estimator that fits a number of decision tree classifiers on various sub-samples of the dataset \n# and uses averaging to improve the predictive accuracy and control over-fitting\n\nLr=RandomForestRegressor(n_estimators= 50,max_depth=5)\nLr_model=Lr.fit(X_train,y_train)","b029e272":"print('Accuracy of the model on training Dataset ',Lr_model.score(X_train,y_train))\nprint ('Accuracy of the model on Test Dataset ',Lr_model.score(X_test,y_test))","8e5021d8":"#Using the Feature importance to Extract the Importance of the Features.\nfeature_imp = Lr_model.feature_importances_\nsns.barplot(x=feature_imp, y=X.columns)\nplt.xlabel('Importance Score')\nplt.ylabel('Features')\nplt.title(\"Important Features\")\nplt.show();","3ba1e724":"#### Analyze the Premium Price by age according to the History Of Cancer In Family.","36681981":"Observation:\n\n1. We Observe that for Younger Users' there is not much differnce in Premium  Price for the users with Known Allergies and with no Known Allergies.\n\n2. With increase in Age Users' with Known Allergies Pay Overall Lower Premium  than Users' with no Known Allergies.","8d2bc152":"#### Relation between Diabetes In Family and Premium Price.","f6c0c5e4":"Observation:\n\n1. Users with Any Chronic Disease pay higher Premium Price than Users' with no  Chronic Disease.\n\n2. Younger Users with Chronic Disease pay much higher than younger Users with No Chronic as compared to Older Users' with and Without Any Chronic Disease.","fa7850b3":"#### Analyze the Premium Price by age according to the Any Transplants.","77f6640a":"Observation:\n    \nUsers' with Any Transplant pay higher Premium Price for any age.","a9fb2680":"#### Analyze the Premium Price by age according to the Any Known Allergies.","8ea19cbe":"### Normalization\n\nNormalization scales each input variable separately to the range 0-1","7cd587af":"Observation: \n\nUsers with History of Cancer in Family tend to pay higher Premium Price than the Users who don't.","6b2119a2":"Observation:\n\n1. We Observe that for Younger Users' there is not much differnce in Premium  Price for the users with Diabetes and Without Diabestes.\n\n2. With increase in Age Users' with Diabetes Pay Overall Lower Premium  than Users' with no Diabetes.","4d2182a0":"#### Relation between Number Of Major Surgeries and Premium Price","bff4db41":"We Observe that the Number of Users' with 2\/3 major Surgeries are very few and they tend to be older and also pay higher Premium Price., thus we can conclude the Positive relation.\n","df4b80c8":"Observation:\n\nAs the Number of Surgeries increases Premium Price also increases Although the diference is not Significant","1d315660":"Although we observe that there is very litte to no relation between Height and Premium the litter relation might be because Height is a factor in BMI calculation and BMI is consider while setting Premiums","ac1d5f74":"Life insurance rates are typically higher if you're overweight or obese, since insurers take into account your weight and height when setting premiums.We Observe that the Premium realy fuctuates with weight as we observe some Users with lot of weight pay high premium but alsoo there are Users with lot of weight but are paying less premium. \n\nOverall looking at the regression plot we can say that there is some positive relation between the Premium Price and Weight. If we have more data we might get to see a clearer picture.\n\nor there might be some other factors influencing the abnormilty.\n\nAs per the Industry Trends Premium Prices are typically higher if you're overweight or obese, since insurers take into account your weight and height when setting premiums.","fc846d6f":"### Checking for Null Values ","135749c8":"Observation:\n\nWe Observe that median Premium Price for  Users' with Diabetes  his Higher than Users' without Diabetes But, There are also Users' without Diabetes Pay Much Higher Premium.","613e6e4a":"#### Analyze the Premium Price by age according to the Any Any Chronic Diseases.","66a2c717":"### Multivariate Analysis","e932587a":"Observation:\nWe Observe that there is strong correlation Between Age and Premium Price.  ","c458688d":"#### Relation between Known Allergies In Family and Premium Price.","17f48984":"### Checking for Outliers","e697db3d":"We observe that as Age increases Premium also increases,\n\nThe same can be confirmed from the lm plot that there is positive relation between the Age and Premium Price.\n\nWe also observe some Anomalies which might be due to some ither factors.\n\nWith age as it is believed that with the rising age, chances of health problems also rise and that\u2019s why accordingly the premium amount also increases.","3d4ac736":"### Information of the Dataset.","593fd5c8":"### Dependent and Independent Features","ec621f8e":"# Modeling Using Random Forest Regressor","5cddd5b2":"#### Relation between Blood Pressure Problems In Family and Premium Price.","5c26dbf5":"Observation:\n\n1. With increase in Age Users' with History of Cancer in Family Pay higher than Users' with no History of Cancer in Family.\n\n2. The difference in the Premium Price for Younger Users' with History of Cancer in Family and the Users' Without is much lower at Longer Age and bigger for Older Users'","5a693d85":"#### Relation between Any Transplants In Family and Premium Price.","350ac420":"Observation:\n\n* I Observe that there are 11 colummns and 986 records\n    \n* Data type for all the Variables are integer but **Diabetes**, **BloodPressureProblems**, **AnyTransplants**,    **AnyChronicDiseases**, **KnownAllergies**, **HistoryOfCancerInFamily**, **NumberOfMajorSurgeries** are Actualy object variables","a8f376ba":"### We Perform Random Forest and further identify Important factors that determine Premium Prices.\n\nAs we can see in the above plot we observe that.\n\n* Age is the most important Factor folowed by AnyTransplant, Weight and other.\n* KnownAllergies,Diabetes, BloodPressureProblems are the least important Factor in determining the Premium Price.\n* We can get better and more forcing results if we had more data for our Analysis.\n","9ab4b6a2":"### Univariate Analysis","590b27b9":"We observe that there are Outliers in the Dataset.","f551fd23":"#### Relation between Height and Premium Price.","acfd8ea3":"#### Summary of Numeric Data","c9e8751d":"#### Analyze the Premium Price by age according to the Diabetes.","89f2ff5d":"Observations:\n    1. Minimum Age of  User is 18 years and Maximum Age is 66  years where Average Age is 42 years\n    2. Minimum Height of the User 145 and Maximum  Height is 188 and Average Height is 168.\n    3. Minimum Weight  of the User 51 and Maximum  Weight is 132 and Average Weight is 77.\n    4. Minimum Premium Price  that User Pays is 15000 and Maximum Premium Price is 40000 while the Average Premium price is 24337.We observe that the Standard deviation is very large for Premium Price.","f4293c34":"### Pair Plot and Correlation Heatmap.","ffd9b7fb":"Observation:\n\nUsers' with Any Transplant Pay Higer Premium Price.","bb98a962":"### Looking at the Shape of the Dataset","750eb3cd":"Observation:\n\n1. We Observe that for Younger Users' there is much differnce in Premium  Price for the users with Blood Pressure Problems and with no Known Allergies.\n\n2. With increase in Age Users' with Blood Pressure Problems Pay Overall Lower Premium  than Users' with no Blood Pressure Problems.","d6f742c7":"#### Summary of Object Data","8891a000":"### Conclusion","92b963d8":"#### Relation between History Of Cancer In Family and Premium Price.","a599125c":"### Checking for Duplicate values","a7800b63":"Based on the above observation  factors that play an important role in determining the premium of the user are:\n    \n    1.  Age\n    2.  AnyTransplants\n    3.  AnyChronicDiseases\n    4.  Weight:\n    5.  HistoryOfCancerInFamily  \n    6.  NumberOfMajorSurgeries\n    7.  Height\n   \nWe also Observe that below factors have insignificant or no Impact on the Premium Price:\n\n     1. KnownAllergies\n     2. BloodPressureProblems\n     3. Diabetes\n     ","11427633":"#### Relation between Any Chronic Diseases In Family and Premium Price.","75665ca6":"#### Relation between Weight and Premium Price.","de0ba0ff":"### Looking at the top 5 records","5e4e1786":"#### Relation between Age and Premium Price.","c0cce7fe":"### Train Test Split","95599ab1":"### Looking at the Unique values.","0463215a":"Observation:\n\nWe Observe that median Premium Price for  Users' with Blood Pressure Problems  his Higher than Users' without Blood Pressure Problems But, There are also Users' without Blood Pressure Problems Pay Much Higher Premium.","5c7a4d21":"Observations:\n\nWe Observe that Users' with Any Chronic Diseases pau higher Premium Price.","05c9b374":"### Importing important Libraries","94c26064":"### Finding Important Features","95bba43f":"The given data set contains a user's medical history in the form of whether they have a specific condition or not, their age, height, weight, etc along with the premium they have to pay in INR for insurance. Perform an exploratory data analysis to determine what factors play an important role in determining the premium of the user.","86de3f0e":"Observation:\n\nWe observe that there is not Much difference in the Premium Price with respect to Users with Known Allergies or NO Allergies.","3784c351":"### Importing the Dataset","e0de8248":"#### Analyze the Premium Price by age according to the Blood Pressure Problems.","b0b5b35f":"### We further try and look at the important features using machine learning in this case we use Random forest."}}