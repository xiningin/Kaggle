{"cell_type":{"4a10c885":"code","b8aa33c9":"code","6f3697c5":"code","71645224":"code","03e075b3":"code","305504a4":"code","e12fa1d9":"code","7cc66487":"code","527d30c9":"code","f316cf57":"code","eb313ca7":"code","93554f92":"code","0921d9e7":"code","a3c2a1ff":"code","514c80ff":"code","9c3fa68a":"code","1bbbb5bc":"code","1d25aa4e":"code","3117b8a8":"code","29e3ffac":"code","f8e63db1":"markdown","88078eb6":"markdown","c637dcaf":"markdown","f31e2877":"markdown","75766d76":"markdown","af0d023e":"markdown","e2a5952f":"markdown","399af0ac":"markdown"},"source":{"4a10c885":"# pip installation of torch 1.6\n!pip install torch==1.6.0+cu101 torchvision==0.7.0+cu101 -f https:\/\/download.pytorch.org\/whl\/torch_stable.html","b8aa33c9":"import torch\ntorch.cuda.is_available()","6f3697c5":"# installing fastai2 here\n!pip install fastai==2.0.13","71645224":"import torch\ntorch.cuda.is_available(), torch.__version__","03e075b3":"import fastai\nfastai.__version__","305504a4":"from fastai.data.all import *\nfrom fastai.vision.all import *","e12fa1d9":"path = Path('..\/input\/men-women-classification')\npath.ls()","7cc66487":"data_path = path.ls()[0]\ndata_path.ls()","527d30c9":"#function to label images based on their path name\ndef label_func(fname):\n    return fname.parent.stem","f316cf57":"dblock = DataBlock(blocks    = (ImageBlock, CategoryBlock),\n                   get_items = get_image_files,\n                   get_y     = label_func,\n                   splitter  = RandomSplitter(seed = 42),\n                   item_tfms = Resize(224),\n                   batch_tfms=aug_transforms(max_warp = 0.0))","eb313ca7":"dls = dblock.dataloaders(data_path)\ndls.show_batch(max_n = 9)","93554f92":"#returns the list of all classes\ndls.vocab","0921d9e7":"learn = cnn_learner(dls, resnet34, metrics=accuracy)","a3c2a1ff":"learn.lr_find()","514c80ff":"lr = 8e-3\nlearn.fine_tune(4, lr)","9c3fa68a":"learn.show_results()","1bbbb5bc":"interp = Interpretation.from_learner(learn)","1d25aa4e":"interp.plot_top_losses(16, figsize=(15,10))","3117b8a8":"learn.unfreeze()\nlearn.lr_find()","29e3ffac":"lr = 5e-6\nlearn.fine_tune(4, lr)","f8e63db1":"# Model Training","88078eb6":"Fastai2 is built on top of Pytorch 1.6 but Kaggle provides Pytorch 1.5 so far. So, we need to manually install Pytorch 1.6 before we can use the amazing api of fastai2.","c637dcaf":"As fastai2 is continuously making changes, I try to update this notebook every week, so as to keep up with the changes in fastai2 library.","f31e2877":"While I was trying to make fastai2 work in kaggle, a lot of times I couldn't use gpu. So, I just randomly dropped gpu availability checks in the code","75766d76":"Now, that we have correct version of fastai, we can move on to the next stage","af0d023e":"`data_path` contains images in Imagenet style, two folders containing images of their respective classes.","e2a5952f":"# Fastai 2.0.13 installation caveat","399af0ac":"# Data Preparation"}}