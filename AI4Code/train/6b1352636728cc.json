{"cell_type":{"e3659d75":"code","160fd593":"code","c9912b31":"code","aed959f3":"code","eab12788":"code","509a89bf":"code","1877b8a3":"code","128d4f52":"code","9df199ed":"code","61a645da":"code","d45ad954":"code","d0fb90e4":"code","19233dbe":"markdown","0eac8444":"markdown","013ad33c":"markdown","a5f0d71e":"markdown","e73aed62":"markdown","3971dad8":"markdown","06a3273a":"markdown","c38c62de":"markdown","9ed6b583":"markdown","eb4878f6":"markdown","0485d93e":"markdown","e41a9a1b":"markdown"},"source":{"e3659d75":"import numpy as np\nimport pandas as pd\n\nimport gc\n\nfrom IPython.display import clear_output\n!pip install autokeras\nclear_output()\n\nimport tensorflow as tf\nfrom sklearn.model_selection import train_test_split\nimport autokeras as ak","160fd593":"ID = \"id\"\nTARGET = \"target\"\nTEST_SIZE = 0.2\nRANDOM_SEED = 42\nMAX_TRIAL = 3 # for simple test \nEPOCHS = 5  # for simple test \nVALIDATION_SPLIT = 0.15","c9912b31":"train = pd.read_csv(\"..\/input\/tabular-playground-series-nov-2021\/train.csv\")\ntest = pd.read_csv(\"..\/input\/tabular-playground-series-nov-2021\/test.csv\")","aed959f3":"train = train.drop([ID],axis=1)\ntest = test.drop([ID],axis=1)","eab12788":"y = train[TARGET]\nX = train.drop([TARGET],axis=1)\nX_test = test\n\ngc.collect()","509a89bf":"from sklearn.preprocessing import StandardScaler\ntotal = pd.concat([X,X_test],axis=0)\ntrans = StandardScaler()\ntrans.fit(total)\n\nX= trans.transform(X)\nX_test = trans.transform(X_test)\n\ngc.collect()","1877b8a3":"X_train,X_val,y_train,y_val=train_test_split(X,y,test_size=TEST_SIZE,random_state=RANDOM_SEED)","128d4f52":"clf = ak.StructuredDataClassifier(max_trials=MAX_TRIAL,seed=RANDOM_SEED)\nclf.fit(X_train, y_train, epochs=EPOCHS, validation_split=VALIDATION_SPLIT)","9df199ed":"clf.evaluate(X_val, y_val)","61a645da":"model = clf.export_model()\nmodel.summary()","d45ad954":"pred_test = model.predict(X_test)","d0fb90e4":"sub = pd.read_csv('..\/input\/tabular-playground-series-nov-2021\/sample_submission.csv')\nsub['target']=pred_test\nsub.to_csv('sub.csv',index=False)\nsub.head()","19233dbe":"# search best model and build best model ","0eac8444":"# get best model","013ad33c":"# load data ","a5f0d71e":"# submission","e73aed62":"# delete unnecessary columns","3971dad8":"# split data (train set and validation set)","06a3273a":"# import libraries","c38c62de":"# evaluate model","9ed6b583":"# predict test data using best model","eb4878f6":"# global variables","0485d93e":"# scaling","e41a9a1b":"# split data (input data and target data)"}}