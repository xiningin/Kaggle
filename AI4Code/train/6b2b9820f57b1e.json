{"cell_type":{"37f080ae":"code","857722fe":"code","1cf9e285":"code","86a9ea8f":"code","bd0fab61":"code","b91759bf":"code","4ce5850e":"code","c6240989":"code","06ce9cbb":"code","f5beed47":"code","bd585b4c":"code","8fe6b756":"code","5b80f5fe":"code","b24cbfda":"code","6ba449b2":"code","a6f393bb":"code","f7b2cf0c":"code","9f90a699":"code","92a69927":"code","75dd6eba":"code","1d626485":"code","e5b48173":"code","0b97d48e":"code","bc76d3db":"code","f1d61e15":"code","176ee294":"code","f8b96b99":"code","87c922a0":"code","9b9b489d":"code","1333baff":"code","d8725468":"code","ac24ca9c":"code","9aee7ba5":"code","48b1526c":"code","bfd632bb":"code","82f034ac":"markdown","60fa32ee":"markdown","8e455dec":"markdown","ad8a6375":"markdown","98e17672":"markdown","3d9ca462":"markdown","b7bb894a":"markdown","3b09beb1":"markdown","ed0e87dc":"markdown","3c152494":"markdown","60d3a66d":"markdown","3b8aba7b":"markdown","313c23f3":"markdown","8a00e0a2":"markdown","725d075c":"markdown"},"source":{"37f080ae":"# This Python 3 environment comes with many helpful analytics libraries installed\n# It is defined by the kaggle\/python Docker image: https:\/\/github.com\/kaggle\/docker-python\n# For example, here's several helpful packages to load\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\n\n# Input data files are available in the read-only \"..\/input\/\" directory\n# For example, running this (by clicking run or pressing Shift+Enter) will list all files under the input directory\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n# You can write up to 5GB to the current directory (\/kaggle\/working\/) that gets preserved as output when you create a version using \"Save & Run All\" \n# You can also write temporary files to \/kaggle\/temp\/, but they won't be saved outside of the current session","857722fe":"import numpy as np\nimport pandas as pd\nimport os\nfrom matplotlib import pyplot as plt\nimport seaborn as sb","1cf9e285":"input_dir = '\/kaggle\/input'\nisic_dir = os.path.join(input_dir, 'siim-isic-melanoma-classification')\njpg_dir = os.path.join(isic_dir, 'jpeg')\nwork_dir = os.path.abspath(os.getcwd())","86a9ea8f":"train_csv = pd.read_csv(os.path.join(isic_dir, 'train.csv'))\ntest_csv = pd.read_csv(os.path.join(isic_dir, 'test.csv'))\n\ntrain_csv.head()","bd0fab61":"test_csv.head()","b91759bf":"def preprocess(data):\n    data['sex'] = data['sex'].astype('category')\n    data['site'] = data['anatom_site_general_challenge'].astype('category')\n    data['diagnosis'] = data['diagnosis'].astype('category')\n    data['benign_malignant'] = data['benign_malignant'].astype('category')\n    \n    return data","4ce5850e":"train_csv = preprocess(train_csv)","c6240989":"train_csv.info()","06ce9cbb":"total = train_csv.shape[0]\nprint('Missing sex info: ', total - train_csv[train_csv.sex.notnull()].shape[0])\nprint('Missing age info: ', total - train_csv[train_csv.age_approx.notnull()].shape[0])\nprint('Missing site info: ', total - train_csv[train_csv.site.notnull()].shape[0])","f5beed47":"train_csv['has_missing'] = train_csv.apply(lambda row: row.isna().any(), axis=1)","bd585b4c":"train_csv.head()","8fe6b756":"sb.distplot(train_csv[train_csv.has_missing==True]['target'], label='Missing', kde=False)\nsb.distplot(train_csv[train_csv.has_missing==False]['target'], label='Full', kde=False)\nplt.legend(loc='best')\nplt.show()","5b80f5fe":"missing_malignant = train_csv[(train_csv.has_missing==True) & (train_csv.target==1)].shape[0]\nmissing_benign = train_csv[(train_csv.has_missing==False) & (train_csv.target==1)].shape[0]\n\nprint('Malignant with missing values: ', missing_malignant)\nprint('Benign with missing values: ', missing_benign)","b24cbfda":"unique_patients = train_csv['patient_id'].unique().shape[0] \nunique_images = train_csv['image_name'].unique().shape[0]\ntotal = train_csv['patient_id'].shape[0]\n\nprint('Unique patients: ', unique_patients)\nprint('Unique images: ', unique_images)\nprint('Total: ', total)","6ba449b2":"# for train and test\ncommon_images = test_csv['image_name'].isin(train_csv['image_name']).value_counts()\ncommon_patients = test_csv['patient_id'].isin(train_csv['patient_id']).value_counts()\nprint('Common images ---> ', common_images)\nprint('Common Patients ---> ', common_patients)\nprint('Total test: ', test_csv.shape[0])","a6f393bb":"sb.distplot(train_csv[\"patient_id\"].value_counts())\nplt.title(\"Patient ID distribution\")","f7b2cf0c":"# For numeric columns\nplt.rcParams['figure.figsize'] = 10,4\ntrain_csv['age_approx'].hist()\nplt.show()","9f90a699":"# For non-numeric columns\nplt.rcParams['figure.figsize'] = 16,12\nfig, ((ax1, ax2), (ax3, ax4)) = plt.subplots(2,2)\ntrain_csv['sex'].value_counts().plot(kind='bar', ax=ax1, title='Sex')\ntrain_csv['anatom_site_general_challenge'].value_counts().plot(kind='bar', ax=ax2, title='Site')\ntrain_csv['diagnosis'].value_counts().plot(kind='bar', ax=ax3, title='Diagnosis')\ntrain_csv['benign_malignant'].value_counts().plot(kind='bar', ax=ax4, title='Benign\/Malignant')\nplt.tight_layout() \nplt.show()","92a69927":"# plt.rcParams['figure.figsize'] = 6,4\n\nplt.rcParams['figure.figsize'] = 16,6\nfig, (ax1, ax2) = plt.subplots(1,2)\nsb.countplot(x='sex', hue='benign_malignant', data=train_csv, ax=ax1)\nsb.countplot(x='anatom_site_general_challenge', hue='benign_malignant', data=train_csv, ax=ax2)\nplt.tight_layout()\nplt.show()","75dd6eba":"sex_site_result = train_csv.groupby(['sex', 'site', 'benign_malignant']).agg(occurence=('target','count'))\nsex_site_result = sex_site_result.reset_index()\nsex_site_result","1d626485":"sex_site_result.info()","e5b48173":"sb.scatterplot(x='site', y='occurence', hue='benign_malignant', style='sex', data=sex_site_result)\nplt.show()","0b97d48e":"sb.scatterplot(x='age_approx', y='site', hue='benign_malignant', style='sex', alpha=0.6, markers=['P', 'X'], data=train_csv)\nplt.show()","bc76d3db":"# sb.pairplot(train_csv[['age_approx','benign_malignant']], hue=\"benign_malignant\")\nsb.distplot(train_csv[train_csv.target==0]['age_approx'], label='Benign')\nsb.distplot(train_csv[train_csv.target==1]['age_approx'], label='Malignant')\nplt.legend(loc='best')\nplt.show()","f1d61e15":"sb.distplot(train_csv[train_csv.sex=='male']['age_approx'], label='Male')\nsb.distplot(train_csv[train_csv.sex=='female']['age_approx'], label='Female')\nplt.legend(loc='best')\nplt.show()","176ee294":"sb.distplot(train_csv[(train_csv.sex=='male') & (train_csv.target==0)]['age_approx'], label='Male Benign')\nsb.distplot(train_csv[(train_csv.sex=='male') & (train_csv.target==1)]['age_approx'], label='Male Malignant')\nsb.distplot(train_csv[(train_csv.sex=='female') & (train_csv.target==0)]['age_approx'], label='Female Benign')\nsb.distplot(train_csv[(train_csv.sex=='female') & (train_csv.target==1)]['age_approx'], label='Female Malignant')\nplt.legend(loc='best')\nplt.show()","f8b96b99":"benign = train_csv[train_csv.benign_malignant=='benign']\nmalignant = train_csv[train_csv.benign_malignant=='malignant']","87c922a0":"bimg = plt.imread(jpg_dir + '\/train\/' + benign.iloc[0]['image_name'] + '.jpg')\nplt.imshow(bimg)","9b9b489d":"mimg = plt.imread(jpg_dir + '\/train\/' + malignant.iloc[0]['image_name'] + '.jpg')\nplt.imshow(mimg)","1333baff":"def show_rgb_histogram(image, ax=None):\n    if ax is None:\n        plt.hist(image[:, :, 0].ravel(), bins = 256, color = 'Red', alpha = 0.5, label='Red')\n        plt.hist(image[:, :, 1].ravel(), bins = 256, color = 'Green', alpha = 0.5, label='Green')\n        plt.hist(image[:, :, 2].ravel(), bins = 256, color = 'Blue', alpha = 0.5, label='Blue')\n        plt.xlabel('Intensity')\n        plt.ylabel('Count')\n        plt.legend(loc='best')\n        plt.show()\n    else:\n        ax.hist(image[:, :, 0].ravel(), bins = 256, color = 'Red', alpha = 0.5, label='Red')\n        ax.hist(image[:, :, 1].ravel(), bins = 256, color = 'Green', alpha = 0.5, label='Green')\n        ax.hist(image[:, :, 2].ravel(), bins = 256, color = 'Blue', alpha = 0.5, label='Blue')\n        ax.set_xlabel('Intensity')\n        ax.set_ylabel('Count')\n        ax.legend(loc='best')","d8725468":"show_rgb_histogram(bimg)","ac24ca9c":"show_rgb_histogram(mimg)","9aee7ba5":"random_benign = benign.sample(6)\nrandom_malignant = malignant.sample(6)","48b1526c":"plt.rcParams['figure.figsize'] = 10,6\nfor index, row in random_benign.iterrows():\n    img = plt.imread(jpg_dir + '\/train\/' + row['image_name'] + '.jpg')\n    fig, (ax1, ax2) = plt.subplots(1, 2)\n    ax1.imshow(img)\n    show_rgb_histogram(img, ax2)\n    plt.tight_layout()\n    plt.show()","bfd632bb":"for index, row in random_malignant.iterrows():\n    img = plt.imread(jpg_dir + '\/train\/' + row['image_name'] + '.jpg')\n    fig, (ax1, ax2) = plt.subplots(1, 2)\n    ax1.imshow(img)\n    show_rgb_histogram(img, ax2)\n    plt.tight_layout()\n    plt.show()","82f034ac":"Looks like females above 80 and males above 60 are more vulnerable and it is less likely to appear in the oral\/genital area. Let's have a look at age.","60fa32ee":"### Check if missing has any relationship with malign\/benign","8e455dec":"# Explore Data","ad8a6375":"### Finding from histogram\nWe can see that the dataset is highly imbalanced with very few malignant cases. We have to be careful while selecting optimization metric. Using accuracy might give us misleading result. ROC curve and PR curve will do a better job for selecting optimum model.","98e17672":"### Randomly pick some images and show their histogram","3d9ca462":"Looks like 2056 patients have 33126 images. Let's see the distribution of images per person. Count of patient ID should do the job.","b7bb894a":"## Read Data","3b09beb1":"From these plots we can conclude that:\n1. Male and Female Benign distribution is similar\n2. Malignant type is mostly prevalent in higher age group\n3. Males over 60 are particularly more vulnerable.","ed0e87dc":"From the sample it looks like histogram of malignant looks a bit more spread out, but we cannot make that conclusion with just few sample. Anyway, it gives us a rough idea about color distribution which might be helpful if we need a specific filter for specific color.","3c152494":"## Import required Libraries","60d3a66d":"## Check Missing Values","3b8aba7b":"## Compare images","313c23f3":"## Check for duplicates","8a00e0a2":"### Plot Across features","725d075c":"### Histograms for each variables"}}