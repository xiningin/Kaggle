{"cell_type":{"7b5227c5":"code","51a753bd":"code","67704ea9":"code","56c8b3c6":"code","e086d8d6":"code","088dc9ed":"code","d2edf36d":"code","a740787f":"code","17e4240b":"code","db1b7d59":"code","36a3677a":"code","43f34921":"code","0cff63d4":"code","24cc1d0b":"code","3ce1b432":"code","79ea6341":"code","94802e67":"code","3cc8bb9e":"code","13300b3a":"code","9f7d5408":"markdown","dd6bc1ff":"markdown","25b78ba4":"markdown","98f84093":"markdown","1ebd40d5":"markdown","b86a78ca":"markdown","fdcdc25e":"markdown"},"source":{"7b5227c5":"import pandas as pd\nimport numpy as np","51a753bd":"ls -lh ..\/input\/","67704ea9":"train_df = pd.read_csv(\"..\/input\/train.csv\")\ntest_df = pd.read_csv(\"..\/input\/test.csv\")","56c8b3c6":"from collections import Counter","e086d8d6":"Counter(train_df.TARGET.values).most_common()","088dc9ed":"train_df.info()","d2edf36d":"feats_list = ['bathrooms', 'bedrooms', 'listing_id', 'price']","a740787f":"train_df.isna().sum()","17e4240b":"print(\"before drop: \", len(train_df))\ntrain_df.dropna(inplace=True, subset=feats_list)\nprint(\"after drop: \", len(train_df))","db1b7d59":"X_train = train_df.loc[:, feats_list]\nX_test = test_df.loc[:, feats_list]\n\ny_train = train_df.loc[:, 'TARGET'].values","36a3677a":"X_test.shape","43f34921":"X_test.isna().sum()","0cff63d4":"from sklearn.linear_model import LogisticRegression","24cc1d0b":"lg = LogisticRegression(multi_class='ovr', solver='lbfgs',\n                        class_weight={'low':0.33, 'high':2.9, 'medium':1.})","3ce1b432":"lg.fit(X_train, y_train)","79ea6341":"y_pred = lg.predict(X_test)","94802e67":"from collections import Counter\nCounter(y_pred).most_common()","3cc8bb9e":"submit = pd.DataFrame.from_dict({'Id':test_df.Id.values, 'TARGET': y_pred})\nsubmit.to_csv(\"sumbit.csv\", index=False)","13300b3a":"submit.head()","9f7d5408":"# \u0412\u044b\u043a\u0438\u0434\u044b\u0432\u0430\u0435\u043c Nans","dd6bc1ff":"# \u0411\u0435\u0440\u0435\u043c \u0442\u043e\u043b\u044c\u043a\u043e \u0447\u0438\u0441\u043b\u043e\u0432\u044b\u0435 \u043f\u0440\u0438\u0437\u043d\u0430\u043a\u0438","25b78ba4":"# \u0424\u0438\u0442\u0430\u0435\u043c \u0440\u0435\u0433\u0440\u0435\u0441\u0441\u0438\u044e","98f84093":"# \u0414\u0435\u043b\u0430\u0435\u043c \u0441\u0430\u0431\u043c\u0438\u0442","1ebd40d5":"# \u0412\u044b\u043d\u043e\u0441\u0438\u043c \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u043e \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u0443\u044e Target","b86a78ca":"\u043d\u0438\u0447\u0435\u0433\u043e \u043d\u0435 \u043f\u0440\u043e\u043f\u0430\u043b\u043e, \u0442.\u043a. \u0432 \u043d\u0430\u0448\u0438\u0445 \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0445 \u0444\u0438\u0447\u0430\u0445 \u043d\u0435\u0442 Nan","fdcdc25e":"\u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0438\u043c \u0447\u0442\u043e \u0443 \u043d\u0430\u0441 \u0441 \u0440\u0430\u0441\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u0435\u043c \u0442\u0430\u0440\u0433\u0435\u0442\u043d\u043e\u0439 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u043e\u0439"}}