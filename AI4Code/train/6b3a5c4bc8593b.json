{"cell_type":{"2e4c4b11":"code","e48c4ccb":"code","f070986d":"code","e1b83a82":"code","90001491":"code","5cbc70c6":"code","f9dbcfcd":"markdown","dcea0fe8":"markdown","e7bd74fc":"markdown","6e960e62":"markdown","9855ed27":"markdown"},"source":{"2e4c4b11":"from pandas import read_csv\nfrom matplotlib import pyplot\nfrom statsmodels.tsa.ar_model import AutoReg\nfrom sklearn.metrics import mean_squared_error\nimport numpy\nfrom math import sqrt","e48c4ccb":"# create a difference transform of the dataset\ndef difference(dataset):\n\tdiff = list()\n\tfor i in range(1, len(dataset)):\n\t\tvalue = dataset[i] - dataset[i - 1]\n\t\tdiff.append(value)\n\treturn numpy.array(diff)\n\npath='..\/input\/daily-total-female-births\/daily-total-female-births.csv'\nseries = read_csv(path, header=0, index_col=0, parse_dates=True, squeeze=True)\n\nX = difference(series.values)\nsize = int(len(X) * 0.66)\ntrain, test = X[0:size], X[size:]","f070986d":"window = 6\nmodel = AutoReg(train, lags=6)\nmodel_fit = model.fit()\ncoef = model_fit.params","e1b83a82":"def predict(coef, history):\n\tyhat = coef[0]\n\tfor i in range(1, len(coef)):\n\t\tyhat += coef[i] * history[-i]\n\treturn yhat","90001491":"history = [train[i] for i in range(len(train))]\npredictions = list()\nfor t in range(len(test)):\n\tyhat = predict(coef, history)\n\tobs = test[t]\n\tpredictions.append(yhat)\n\thistory.append(obs)\nrmse = sqrt(mean_squared_error(test, predictions))\nprint('Test RMSE: %.3f' % rmse)","5cbc70c6":"pyplot.plot(test)\npyplot.plot(predictions, color='red')\npyplot.show()","f9dbcfcd":"# Predictions","dcea0fe8":"# Female Births - Time Series Forecast Model","e7bd74fc":"# Results","6e960e62":"# Difference transforms","9855ed27":"# Train autoregression"}}