{"cell_type":{"dc968464":"code","361512e7":"code","e2af7fab":"code","32a9a8c7":"code","5880ea35":"code","c5095f77":"code","b288f4f6":"code","672cdc77":"code","2224f590":"code","f7259c1d":"markdown","a518e445":"markdown","c053dda1":"markdown","a00ad9c6":"markdown","6b0a9fd7":"markdown","5e37fd85":"markdown","db563515":"markdown","e8d72073":"markdown","36763845":"markdown","41eefc8c":"markdown","708d0726":"markdown"},"source":{"dc968464":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport seaborn as sns # plots creating\nimport matplotlib.pyplot as plt # plots handling\n\n# Kaggle file system setup\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","361512e7":"data = pd.read_csv('..\/input\/us-gasoline-and-diesel-retail-prices-19952021\/PET_PRI_GND_DCUS_NUS_W.csv')","e2af7fab":"print(f\"There are {data.shape[0]} rows and {data.shape[1]} columns.\")\nprint(f\"There are {data.isna().sum().sum()} missing values.\")","32a9a8c7":"#\u00a0Convert Object type variable to datetime variable\ndata['Date'] = pd.to_datetime(data['Date'])","5880ea35":"from datetime import datetime\n\n# Plot dimensions\nWIDTH   = 20\nHEIGHT  = 6  \n\n#\u00a0Interesting milestones\ncrisis_2009 = {'date':datetime(year=2009, month=1, day=1), 'label':'Great Recession', 'color':'navy'}\ncovid_2019  = {'date':datetime(year=2019, month=12, day=31), 'label':'COVID-19', 'color':'olivedrab'}\nsras_2003   = {'date':datetime(year=2003, month=1, day=1), 'label':'SRAS', 'color':'olivedrab'}\noversupply1 = {'date':datetime(year=2015, month=1, day=1), 'label':'Decline 1', 'color':'teal'}\noversupply2 = {'date':datetime(year=2016, month=1, day=1), 'label':'Decline 2', 'color':'teal'}\nseptember11 = {'date':datetime(year=2011, month=9, day=1), 'label':'September 11 attacks', 'color':'crimson'}\nmilestones  = [crisis_2009, covid_2019, oversupply1, oversupply2, september11, sras_2003]\n\ndef analysis(df, gasolines, legends, milestones=None, corr=False):\n    \"\"\"\n    @params : gasolines\n    @params : data\n    \"\"\"  \n    #\u00a0Create a dataframe with 2 columns 'grade' and 'price'\n    df_cg         = pd.melt(df[gasolines])\n    df_cg.columns = ['grade', 'price']\n    df_cg         = df_cg.replace(legends)\n    \n    #\u00a0Create the price distribution plot\n    plt.figure(figsize=(WIDTH, HEIGHT))\n    sns.kdeplot(data=df_cg, x='price', hue='grade')\n    plt.title('Price distribution')\n    plt.show()\n    \n    #\u00a0Create the datetime line plot\n    plt.figure(figsize=(WIDTH, HEIGHT))\n    \n    # Loop over the different gasoline grades\n    for gasoline in gasolines:\n        sns.lineplot(x=df['Date'].rename(legends), y=df[gasoline], label=legends[gasoline])\n    \n    # Plot the different milestones\n    if milestones:\n        \n        minimum = df[gasolines].min().min()\n        maximum = df[gasolines].max().max()\n        \n        for milestone in milestones:\n            plt.plot([milestone['date'], milestone['date']], [minimum, maximum], color=milestone['color'], linestyle='dashed', ms=10)\n            plt.text(milestone['date'], minimum, milestone['label'], color=milestone['color'], rotation=45)\n        \n    plt.ylabel('Price')\n    plt.title('Temporal evolution of prices')\n    plt.show()\n    \n    # Plot the correlation\n    if corr:\n        sns.jointplot(\n            data=df[gasolines].rename(columns=legends),\n            x=legends[gasolines[0]], \n            y=legends[gasolines[1]], \n            kind=\"scatter\", \n            height=10,\n            color='crimson',\n            alpha=0.4,\n            marginal_kws=dict(bins=15, alpha=.6)\n        )\n        \n        plt.title(f'{legends[gasolines[0]]} vs {legends[gasolines[1]]}')\n        plt.xlabel(legends[gasolines[0]])\n        plt.ylabel(legends[gasolines[1]])\n        plt.show()","c5095f77":"generate_gasoline_type = lambda x: [ f\"{e}{x}\" for e in ['R', 'M', 'P'] ]\n\nconventionals = generate_gasoline_type(2)\nreformulated  = generate_gasoline_type(3)","b288f4f6":"analysis(data, conventionals, {\"R2\":\"Regular\", \"M2\":\"Mid-Grade\", \"P2\":\"Premium\"}, milestones=milestones)","672cdc77":"analysis(data, reformulated, {\"R3\":\"Regular\", \"M3\":\"Mid-Grade\", \"P3\":\"Premium\"}, milestones=milestones)","2224f590":"analysis(data, ['A2', 'A3'], {\"A2\":\"Reformulated\", \"A3\":\"Conventional\"}, milestones=milestones, corr=True)","f7259c1d":"<div style=\"align:center\">\n    <img src=\"https:\/\/images.freeimages.com\/images\/large-previews\/f25\/oil-pumps-1180629.jpg\" style=\"width:70%\">\n<\/div>","a518e445":"# EDA | U.S. Gasoline and Diesel Retail Prices 1995-2021","c053dda1":"# Introduction\n\n- The DataFrame contains data about *U.S. Gasoline and Diesel Retail Prices from 1995 until 2021*.\n- The data is divided between **Regular**, **Mid** and **Premium** grade of conventional or reformulated gasoline.\n- This notebook's objective is to compare the evolution of price between the different grades of gasoline and if they are either conventional or reformulated.\n\nHere is some vocabulary before beginning.\n\n**Conventional Gasoline**\n:\n*Finished motor gasoline not included in the oxygenated or reformulated gasoline categories. Excludes reformulated gasoline blendstock for oxygenate blending (RBOB) as well as other blendstock.*\n\n**Reformulated Gasoline**\n:\n*Finished motor gasoline formulated for use in motor vehicles, the composition and properties of which meet the requirements of the reformulated gasoline regulations promulgated by the U.S. Environmental Protection Agency under Section 211(k) of the Clean Air Act. This category includes oxygenated fuels program reformulated gasoline (OPRG) but excludes reformulated gasoline blendstock for oxygenate blending (RBOB).*\n\n> *Source* : [U.S. Energy Information Administration](https:\/\/www.eia.gov\/dnav\/pet\/TblDefs\/pet_move_pipe_tbldef2.asp#:~:text=Conventional%20Gasoline,as%20well%20as%20other%20blendstock.)","a00ad9c6":"## Reformulated vs Conventional Gasoline","6b0a9fd7":"## Load","5e37fd85":"##\u00a0Main package imports","db563515":"## Quick check","e8d72073":"## Reformulated Gasoline","36763845":"# Analysis","41eefc8c":"# Conclusion\n\n- The data has a **high positive correlation** between variables.\n- The historic events have **great influence** on the increase and drop of the prices.\n- ...","708d0726":"## Conventional Gasoline"}}