{"cell_type":{"0f8bd5dc":"code","58b02c19":"code","e774fc95":"code","4b37e29c":"code","094f2fa8":"code","8e36dbf6":"code","c3b186e0":"code","421e60b6":"code","bacdbb02":"code","b5a76d8b":"code","d156d9a2":"code","6e70c90d":"code","066f333b":"code","94e90cdb":"code","9c6bea76":"code","2c1b9060":"code","4f733ecf":"code","68b510d1":"code","63b4e4c4":"code","0041bf09":"code","5cd8cf04":"code","d8a8a845":"code","0b638f09":"code","b7d15c94":"code","f8e4bd6d":"code","a13803c2":"code","4d0337bb":"code","8fe2da99":"code","16de6b7a":"code","44037f73":"code","13374eb9":"markdown","12c1d8f5":"markdown","7fd9edfe":"markdown","69d0706a":"markdown","923f0c9b":"markdown","190d104d":"markdown","646656df":"markdown","8c6c9aa8":"markdown","816c9610":"markdown","aab8fdc1":"markdown","0c9df399":"markdown","cb00a01f":"markdown","87330911":"markdown","01e09fba":"markdown","01e6193c":"markdown","37575a37":"markdown","39ccdbbf":"markdown"},"source":{"0f8bd5dc":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport plotly\nimport plotly.graph_objs as plgo\nimport plotly.figure_factory as plff","58b02c19":"reviews = pd.read_csv('..\/input\/beerreviews\/beer_reviews.csv')\nreviews.head()","e774fc95":"reviews.shape","4b37e29c":"reviews.columns","094f2fa8":"print('Information about the columns; type,entries,missing value info:  \\n')\nprint(reviews.info())","8e36dbf6":"## Counting unqiueness by Brewery\/Company\nprint('No of unique brewery by name:', reviews.brewery_name.nunique())\nprint('No of unique brewery by ids:',reviews.brewery_id.nunique())","c3b186e0":"## Counting uniqueness by Beer\nprint('No of unique beer by name:', reviews.beer_name.nunique())\nprint('No of unique beer by ids:',reviews.beer_beerid.nunique())","421e60b6":"## Counting number of users,reviewed the beer\nprint('No of unique users, reviewing the given beers: ',reviews.review_profilename.nunique())","bacdbb02":"print(\"Missing values in Dataset: \/n\", reviews.isnull().sum())","b5a76d8b":"reviews = reviews.dropna(axis = 0)\nprint(\"After removing the missing entries in dataset: \/n\", reviews.info())","d156d9a2":"print('User reviewed one beer more than ones,categorised by beer name: \\n', \n      reviews.loc[reviews.duplicated(['review_profilename','beer_name'],keep= False)])","6e70c90d":"print('User reviewed one beer more than ones,categorised by beer ids: \\n',\n      reviews.loc[reviews.duplicated(['review_profilename','beer_beerid'],keep=False)])","066f333b":"## Sorting the ratings with descending order,so that with removing duplicates for beer reviews,user gave highest ratings entry can be kept\nreviews = reviews.sort_values('review_overall',ascending= False)","94e90cdb":"## Removing the duplicates\nreviews = reviews.drop_duplicates(subset=['review_profilename','beer_name'],keep = 'first')\nreviews = reviews.drop_duplicates(subset=['review_profilename','beer_beerid'],keep = 'first')\nreviews.shape","9c6bea76":"round(reviews.describe())","2c1b9060":"reviews.review_time = pd.to_datetime(reviews.review_time,unit = 's')\nreviews.dtypes","4f733ecf":"reviews.hist(figsize = (20,20))","68b510d1":"popular_brewery = reviews.groupby('brewery_name').brewery_name.count()\npopular_brewery = popular_brewery.sort_values(ascending= False)\npopular_breweries = popular_brewery.iloc[0:10]\npopular_breweries","63b4e4c4":"Top_10_popular_breweries = pd.DataFrame(data = popular_breweries)\nTop_10_popular_breweries.columns = ['Top Brewery Name wrt to its review counts']\nTop_10_popular_breweries","0041bf09":"top_10_breweries_by_beertype = reviews.groupby(['brewery_name']).beer_name.nunique().sort_values(ascending = False)\ntop_10_breweries_by_beertype = top_10_breweries_by_beertype.iloc[0:10]\ntop_10_breweries_by_beertype = pd.DataFrame(top_10_breweries_by_beertype)\ntop_10_breweries_by_beertype.columns = ['Top Breweries wrt to Beer type presence']\ntop_10_breweries_by_beertype","5cd8cf04":"top_10_popular_beers = pd.DataFrame(reviews.groupby('beer_name').beer_name.count().sort_values(ascending = False).iloc[0:10])\ntop_10_popular_beers.columns = ['Beer Names wrt Reviews counts']\ntop_10_popular_beers","d8a8a845":"Top_beer_ratings = reviews[['beer_name','review_overall']].groupby('beer_name').review_overall.agg('mean').sort_values(ascending = False)\nTop_beer_ratings = Top_beer_ratings.iloc[0:10]\nTop_beer_ratings.reset_index()","0b638f09":"popular_beer_styles = pd.DataFrame(reviews.groupby('beer_style').beer_style.count().sort_values(ascending = False).iloc[0:10])\npopular_beer_styles.columns = ['Beer Styles wrt review counts']\npopular_beer_styles","b7d15c94":"## Beer Styles wrt top ratings\n\nTop_rating_beer_styles = reviews[['beer_style','review_overall']].groupby('beer_style').review_overall.agg('mean').sort_values(ascending = False).iloc[0:10]\nTop_rating_beer_styles = pd.DataFrame(Top_rating_beer_styles)\nTop_rating_beer_styles","f8e4bd6d":"## Aroma,taste and Appearances\n\nbeers_looks_smell = reviews[['beer_name', 'review_aroma','review_appearance','review_taste']]","a13803c2":"beer_looks_smell = beers_looks_smell.groupby('beer_name').aggregate(['max'])\nbeer_looks_smell = beers_looks_smell.sort_values(by = ['review_aroma','review_appearance','review_taste'],ascending = False)\nbeers_looks_smell.iloc[0:15]","4d0337bb":"top_ratings_taste = reviews[['brewery_name','beer_name','review_overall','review_taste']]","8fe2da99":"top_ratings_taste = top_ratings_taste.groupby(['brewery_name','beer_name']).aggregate(['max'])\ntop_ratings_taste.iloc[0:20]","16de6b7a":"reshape = reviews[['review_overall','beer_name']].groupby('beer_name').agg(['count','mean'])\nprint('Beer with review_overall more than 4: \\n',reshape[reshape['review_overall','mean']>4])\nprint('Beer with review_overall more than 4 and review counts are greater than 200: \\n')\nTop_beers = pd.DataFrame(reshape[(reshape['review_overall','mean']>4) & (reshape['review_overall','count']>200)])\nTop_beers","44037f73":"## Now getting Top 20 Most reviewed and Most highly Rated beers\nTop_beers = Top_beers.sort_values(by = ([('review_overall','count'),('review_overall','mean')]),ascending = False).iloc[0:20]\nTop_beers","13374eb9":"##Beer Reviews Data Analysis using Machine Learning and exploratory data visulization and analysis techniques","12c1d8f5":"Above 20 Beers are mostly reviewed and highly rated,so recommended for users with it. ","7fd9edfe":"### Data visualization and analysis","69d0706a":"Handling Duplicate values","923f0c9b":"In the dataset, review time column has datatype of int64, converting it in form of datetime format","190d104d":"### Top 10 popular Beer styles","646656df":"### About Dataset","8c6c9aa8":"### Data Preprocessing","816c9610":"### Top 10 popular Brewaries w.r.t Reviews counts","aab8fdc1":"### Top 10 beers with Highest Ratings","0c9df399":"### Beers categorised as highly rated wrt appreance,aroma and taste","cb00a01f":"### Top Breweries\/beers with highest ratings and great taste","87330911":"### Top 10 popular Beers wrt reviews counts","01e09fba":"Handling Missing values","01e6193c":"So, in nutshell, These dataset contains 1.5 million reviews of around more than 60 thousand beers and which are considered from more than 5 thousand breweries","37575a37":"### Top 10 Breweries with most beer types present","39ccdbbf":"There are almost 1.5 million entries on the reviews of the beer and have 13 attributes repreesenting the data"}}