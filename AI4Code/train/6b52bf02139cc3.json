{"cell_type":{"0e0b8462":"code","8c130311":"code","fdbed174":"code","100f9e90":"code","05e77bf6":"code","aeb21f9f":"code","6f73cbab":"code","8a328854":"code","51a8edfa":"code","921c43d0":"code","c4884262":"code","18ac0f03":"code","d2ab8c68":"code","4a508fe9":"code","5d6b55e6":"code","9d04c392":"code","5dbf2ac1":"code","230f319c":"code","a89e4af3":"markdown","0824dc44":"markdown","8b552097":"markdown","eb119dfd":"markdown","5fb16ddb":"markdown","7cdea3be":"markdown","709fdd09":"markdown","2c406d93":"markdown","368e6c2a":"markdown","01eac532":"markdown","c890f077":"markdown"},"source":{"0e0b8462":"pip install pmdarima","8c130311":"import numpy as np\nimport pandas as pd \nfrom statsmodels.tsa.arima_model import ARIMA\nfrom pmdarima import auto_arima #Payramid ARIMA library","fdbed174":"df= pd.read_csv('..\/input\/real-manufacturing-and-trade-inventories-2020\/INVCMRMT.csv', index_col='DATE', parse_dates=True)\ndf['INVCMRMT']=df['INVCMRMT'].astype(int)\ndf.index.freq= 'MS'\n","100f9e90":"\ndf['INVCMRMT'].plot(figsize=(12,6)) # Seems like add model \n# for more information about add and mul model check sources","05e77bf6":"from statsmodels.tsa.seasonal import seasonal_decompose\nres= seasonal_decompose(df['INVCMRMT'], model='add')\nres.plot();\n#Looks like there is a seasonal component but it's very small  \"thousand from millions\"\n","aeb21f9f":"res.seasonal.plot(figsize=(12,8)); #ignore seasonal component","6f73cbab":"auto_arima(df['INVCMRMT'], seasonal=False).summary()","8a328854":"from statsmodels.tsa.statespace.tools import diff\ndf['diff_1']= diff(df['INVCMRMT'],k_diff=1)","51a8edfa":"from statsmodels.tsa.stattools import adfuller\ndef adf_test(series, title=''):\n    #Pass time series and optimal title, return an ADF report\n    print(f'Augmented Dickey-Fuller Test : {title}')\n    result = adfuller(series.dropna(),autolag='AIC')#drop nan values\n    labels =['ADF Test statistic','P-value','# lags used', '#observations']\n    out= pd.Series(result[0:4],index=labels)\n    \n    for key,val in result[4].items():\n        out[f'critical value({key})']=val\n    print(out.to_string())\n    if result[1]<= 0.05:\n        print('Strong evidence against the null hypothesis')\n        print('Reject the null hypothesis')\n        print('Data has no unit root & is stationary')\n    else:\n        print('Week evidence against the null hypothesis')\n        print('Fail to reject the null hypothesis')\n        print('Data has a unit root & is non-stationary')","921c43d0":"adf_test(df['diff_1'])","c4884262":"len(df) #We will grap the last year for forecasting","18ac0f03":"train= df.iloc[:271]\ntest = df.iloc[271:]\n\nmodel = ARIMA(train['INVCMRMT'], order=(1,1,1))\nresults= model.fit()\nresults.summary()","d2ab8c68":"start = len(train)\nend = len(train) + len(test) - 1\npredictions = results.predict(start,end,typ='levels').rename('ARIMA Predections') #we choose 'levels' to predict as original data variables","4a508fe9":"test['INVCMRMT'].plot(figsize=(12,8), legend=True)\npredictions.plot(legend=True)","5d6b55e6":"from statsmodels.tools.eval_measures import rmse\nerror= rmse(test['INVCMRMT'],predictions)\nerror\n","9d04c392":"test['INVCMRMT'].mean()","5dbf2ac1":"len(df)","230f319c":"model= ARIMA(df['INVCMRMT'],order=(1,1,1))\nresult= model.fit()\nforecast= result.predict(len(df),len(df)+11,typ='levels').rename('ARIMA FORECAST')\n\ndf['INVCMRMT'].plot(figsize=(12,8), legend=True)\nforecast.plot(legend=True)","a89e4af3":"## I only can predict general trend!","0824dc44":"### Error is quite big cause of seasonal component.","8b552097":"### 4- Dickey fuller test for data after differencing to make sure its stationary\n#### To check whether data is stationary or not\nfor more information check sources","eb119dfd":"### 3- Check seasonal component:\n","5fb16ddb":"#### Source1 : [ACF&PACF](https:\/\/www.kaggle.com\/taghredsalah199\/time-series-correlation-acf-pacf)\n#### Source2 : [Descriptive statistical tests](https:\/\/www.kaggle.com\/taghredsalah199\/time-series-descriptive-statistical-tests)","7cdea3be":"### ARIMA (Aouto Regression Moving Average):\n\n#### It has three components \n1-\tAuto regression :  Forecast using a linear combination of past values\n2-\tIntegrated : How many times we difference data to get stationary\n3-\tMoving average : smooth out the noise for time series\n#### It has also three parameters: \np: no. of lag observation included in the model\n\nd: the no. of times that row observation are diffrenced\n\nq: size of moving average window\n\nGiven a time series data Xt where t is an integer index, and the Xt are real numbers, an model is given by\n\n![](https:\/\/wikimedia.org\/api\/rest_v1\/media\/math\/render\/svg\/433c765f004fe1138737630568375a41f4e4d659)\n\nRight hand side is (AR p component), left hand side is for (MA q component)\n\n\nor equivalently by\n\n![](https:\/\/wikimedia.org\/api\/rest_v1\/media\/math\/render\/svg\/1d1c4e1959722b56ce5e5841b9dc3167ec9072b3)\n\nAn ARIMA(p,d,q) is given by:\n\n![](https:\/\/wikimedia.org\/api\/rest_v1\/media\/math\/render\/svg\/b6ebbe31d07e994b209c391e3d6f8f5d88e267c3)\n\n\nNote:\n- SARIMA is the same as ARIMA but adding Seasonal component\n- I will use Pyramid ARIMA library for determine p,d,q order rather than ACF&PACF plots\n- Payramid ARIMA library choose the best order aotomaticly by AIC & BIC equation \n\n![](https:\/\/wikimedia.org\/api\/rest_v1\/media\/math\/render\/svg\/fe67d436d9064a370cbe800b24b05ee8a68d491b)\n\nWhere k is no. of estimated parameters, L maximum value of likelihood function for model ","709fdd09":"### 5- Creating model","2c406d93":"### 1- Import libraries","368e6c2a":"### 5- Predictions:\n","01eac532":"### 6- Forecasting:","c890f077":"### 2- Load data"}}