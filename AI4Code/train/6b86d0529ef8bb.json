{"cell_type":{"b707d9be":"code","27bf3262":"code","6702ed4e":"code","ff34b58d":"code","b1cff8e3":"code","a1ffacbe":"code","1f88d1ea":"code","a59fe0bc":"code","59af5b3a":"code","6a07235b":"code","a6df4ad5":"code","776c4178":"code","db6f49f8":"code","8f399693":"markdown","0e7a4af0":"markdown","6154cf0d":"markdown","86e11607":"markdown","a1fc7034":"markdown","d13fa830":"markdown","dc802946":"markdown","aa015d35":"markdown","2e37b648":"markdown","f70c9746":"markdown","1b1f11e8":"markdown"},"source":{"b707d9be":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nfrom sklearn import linear_model\nimport matplotlib.pyplot as plt\nfrom sklearn.metrics import r2_score\n","27bf3262":"test = pd.read_csv(\"\/kaggle\/input\/random-linear-regression\/test.csv\")\ntrain = pd.read_csv(\"\/kaggle\/input\/random-linear-regression\/train.csv\")","6702ed4e":"print('sum of null values in train data:',train.isnull().sum())\nprint('sum of null values in test data:',test.isnull().sum())","ff34b58d":"test.dropna(inplace=True)\ntrain.dropna(inplace=True)","b1cff8e3":"print('sum of null values in train data:\\n',train.isnull().sum())\nprint('sum of null values in test data:\\n',test.isnull().sum())","a1ffacbe":"plt.scatter(train.x,train.y)\nplt.xlabel('x')\nplt.ylabel('y')\nplt.title('Simple Linear Regression')\nplt.show()","1f88d1ea":"x_train = train['x'].values.reshape(-1,1)\ny_train = train['y'].values.reshape(-1,1)\n\nx_test = test['x'].values.reshape(-1,1)\ny_test = test['y'].values.reshape(-1,1)\n","a59fe0bc":"regressor = linear_model.LinearRegression()\nregressor.fit(x_train, y_train)","59af5b3a":"print('the c constant in y=mx+c is ',regressor.coef_ )\nprint('the slope m in y=mx+c is ', regressor.intercept_ )","6a07235b":"y_predicted = regressor.predict(y_test)","a6df4ad5":"plt.scatter(x_test, y_test,  color='black')","776c4178":"plt.scatter(x_test, y_predicted, color='red')","db6f49f8":"r2 = r2_score(y_predicted,y_test)\nprint('r2 score is ',r2,'which is',round(r2*100,3),'%')","8f399693":"# Checking Accuracy","0e7a4af0":"# plotting original test data set","6154cf0d":"# droping null values","86e11607":"# checking null values in test and train datasets","a1fc7034":"# ploting the scatterplot of x and y","d13fa830":"# partitioning test and train datasets into x and y also reshaping  \n","dc802946":"# saving test and train datasets in variables","aa015d35":"# fitting model","2e37b648":"# loading all required libraries","f70c9746":"# again checking null values","1b1f11e8":"# ploting predicted dataset"}}