{"cell_type":{"2ea73a43":"code","87977852":"code","f0d9d6ca":"code","b89e9948":"code","0b8794cf":"code","c3b592c1":"code","d5f2bef9":"code","1add48ef":"code","9360e62c":"code","b3b9cf85":"code","5297f157":"code","cac919b9":"code","333a4b9c":"code","2a189fd2":"code","0ddf3ffa":"code","b9da904b":"code","8c7c523c":"code","1a4c5f2c":"code","8419fadb":"code","1acb16a3":"code","985caed4":"code","8a817f58":"code","afb6493f":"code","97844b50":"code","afc4e528":"code","8c07d5c9":"code","8953ede8":"code","9f2b5c51":"code","f3933520":"code","8a0d550a":"code","7d88760d":"code","e9f56bf1":"code","318818dd":"code","1aa22727":"code","1f2b22a6":"code","cde7a59a":"code","a5e1e6c0":"code","cdbf8414":"code","57ff70d7":"markdown","732c2c7e":"markdown","4e094163":"markdown","0b72e8b2":"markdown","d7d75c7f":"markdown","8f9008b0":"markdown","86e7c254":"markdown","e3522ed4":"markdown","ed6863b3":"markdown","c668a05f":"markdown","7542653d":"markdown","5c77838f":"markdown","e0a6158e":"markdown","3def1180":"markdown","d8785aae":"markdown","8a666306":"markdown","70f88c4f":"markdown","29dd59b8":"markdown","3c3c3d65":"markdown","10344d5c":"markdown"},"source":{"2ea73a43":"# Libraries\n\nimport numpy as np\nimport pandas as pd\n\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nfrom sklearn.experimental import enable_iterative_imputer\nfrom sklearn.impute import IterativeImputer\n\nfrom sklearn.preprocessing import StandardScaler\n\nfrom sklearn.metrics import silhouette_score\nfrom sklearn.cluster import KMeans\n\nimport warnings\nwarnings.filterwarnings('ignore')","87977852":"import os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","f0d9d6ca":"# Reading the data set\n\ndf = pd.read_csv('\/kaggle\/input\/gapminder-internet\/internet_gapminder.csv')\ndf.head()","b89e9948":"# Info\n\ndf.info()","0b8794cf":"# Chaninging the dtype of internetuserate\n\ndf['internetuserate'] = pd.to_numeric(df['internetuserate'], errors='coerce')\n\n# We will use errors='coerce' here as there some rows in which are blank and are considered as strings","c3b592c1":"# Rounding the numeric columns upto 2 decimals places\n\ndf[['incomeperperson', 'internetuserate', 'urbanrate']] = df[['incomeperperson','internetuserate', 'urbanrate']].round(2)","d5f2bef9":"print('Shape of data {0}:'.format(df.shape))","1add48ef":"# Statistical Summary\n\ndf.describe()","9360e62c":"# Lets see the missing values\n\nround(100*(df.isnull().sum()\/len(df)),2)","b3b9cf85":"# Imputing Afghanistan's incomeperperson with 499.44(google)\n# https:\/\/www.statista.com\/statistics\/262052\/gross-domestic-product-gdp-per-capita-in-afghanistan\/\n\n# Doing it so cause it will be considered 0 in iterative imputer as it is the first value to be missing and the \n# imputation will vary a lot\n\n\ndf.iloc[0,1] = 499.44","5297f157":"# Subsetting the data\n\ndf_country = df['country']\ndf_numeric = df.select_dtypes(include = ['float64'])","cac919b9":"# Storing the values of the column\n\ndf_numeric_columns = df_numeric.columns","333a4b9c":"# Since the missing values are less we will use iterative imputer to impute the missing values\n\nii = IterativeImputer(initial_strategy='mean',min_value=50,random_state = 42)\niu_df = pd.DataFrame(ii.fit_transform(df_numeric))\niu_df.columns = df_numeric_columns\niu_df = iu_df.round(2)","2a189fd2":"# Concatinating the data\n\ngeo_df = pd.concat([df_country, iu_df], axis = 1)\ngeo_df.head()","0ddf3ffa":"sns.heatmap(geo_df.corr(), annot = True, cmap = 'YlGnBu')\nplt.show()","b9da904b":"# Let's compare\n\nfigure = plt.figure(figsize=(15,5))\ncat = ['internetuserate', 'urbanrate']\n\nc = 1\nfor i in cat:\n    plt.subplot(1,2,c)\n    plt.title('incomeperperson vs {0}'.format(i), fontsize = 15)\n    sns.scatterplot(x = 'incomeperperson', y = i, data = geo_df, color = 'green')\n    c += 1 \n    \nfigure.tight_layout(pad = 2)\nplt.show()","8c7c523c":"sns.scatterplot(x = 'internetuserate', y = 'urbanrate', data = geo_df, color = 'green')\nplt.show()","1a4c5f2c":"figure = plt.figure(figsize=(15,5))\ndist_cat = ['incomeperperson','internetuserate', 'urbanrate']\n\nc = 1\nfor i in dist_cat:\n    plt.subplot(1,3,c)\n    sns.distplot(geo_df[i])\n    c = c +1\n    \nplt.show()","8419fadb":"#Subsetting data for high income and low income countires\n\nincome_high = geo_df[['country', 'incomeperperson']].sort_values(by = 'incomeperperson', ascending = False).head(10)\nincome_low = geo_df[['country', 'incomeperperson']].sort_values(by = 'incomeperperson').head(10)","1acb16a3":"# Plotting \n\nplt.figure(figsize = (15,8))\nplt.suptitle('Top 10', fontsize = 25)\n\nplt.subplot(121)\nsns.barplot(x = 'country', y = 'incomeperperson', data = income_high, palette = 'Set1')\nplt.title('High Income Countries', fontsize = 20)\nplt.xlabel('Country', fontsize = 15)\nplt.ylabel('GDP',fontsize = 15)\nplt.xticks(rotation = 'vertical')\n\nplt.subplot(122)\nsns.barplot(x = 'country', y = 'incomeperperson', data = income_low, palette = 'Set1')\nplt.title('Low Income Countries', fontsize = 20)\nplt.xlabel('Country', fontsize = 15)\nplt.ylabel('GDP',fontsize = 15)\nplt.xticks(rotation = 'vertical')\n\nplt.show()","985caed4":"#Subsetting data for high internet usage and low internet usage\n\ninternet_high = geo_df[['country', 'internetuserate']].sort_values(by = 'internetuserate', ascending = False).head(10)\ninternet_low = geo_df[['country', 'internetuserate']].sort_values(by = 'internetuserate').head(10)","8a817f58":"# Plotting \n\nplt.figure(figsize = (15,8))\nplt.suptitle('Top 10', fontsize = 25)\n\nplt.subplot(121)\nsns.barplot(x = 'country', y = 'internetuserate', data = internet_high, palette = 'Set1')\nplt.title('High Internet Usage Countries', fontsize = 20)\nplt.xlabel('Country', fontsize = 15)\nplt.ylabel('Internet Usage',fontsize = 15)\nplt.xticks(rotation = 'vertical')\n\nplt.subplot(122)\nsns.barplot(x = 'country', y = 'internetuserate', data = internet_low, palette = 'Set1')\nplt.title('Low Income Countries', fontsize = 20)\nplt.xlabel('Country', fontsize = 15)\nplt.ylabel('Internet Usage',fontsize = 15)\nplt.xticks(rotation = 'vertical')\n\nplt.show()","afb6493f":"geo_df.head()","97844b50":"# Subsetting the data\n\ncountry = geo_df['country']\nnum_df = geo_df[['incomeperperson', 'internetuserate', 'urbanrate']]","afc4e528":"# Scaling the data\n\nscaler = StandardScaler()\nscaled_df = scaler.fit_transform(num_df)","8c07d5c9":"# Getting it back to Data Frame\n\nscaled_df = pd.DataFrame(scaled_df)\nscaled_df.columns = geo_df.columns[1:]","8953ede8":"#Calculating the Hopkins statistic\n\nfrom sklearn.neighbors import NearestNeighbors\nfrom random import sample\nfrom numpy.random import uniform\nimport numpy as np\nfrom math import isnan\n \ndef hopkins(X):\n    d = X.shape[1]\n    #d = len(vars) # columns\n    n = len(X) # rows\n    m = int(0.1 * n) \n    nbrs = NearestNeighbors(n_neighbors=1).fit(X.values)\n \n    rand_X = sample(range(0, n, 1), m)\n \n    ujd = []\n    wjd = []\n    for j in range(0, m):\n        u_dist, _ = nbrs.kneighbors(uniform(np.amin(X,axis=0),np.amax(X,axis=0),d).reshape(1, -1), 2, return_distance=True)\n        ujd.append(u_dist[0][1])\n        w_dist, _ = nbrs.kneighbors(X.iloc[rand_X[j]].values.reshape(1, -1), 2, return_distance=True)\n        wjd.append(w_dist[0][1])\n \n    H = sum(ujd) \/ (sum(ujd) + sum(wjd))\n    if isnan(H):\n        print(ujd, wjd)\n        H = 0\n \n    return H","9f2b5c51":"round(hopkins(scaled_df),2)","f3933520":"# Changing name\n\ncluster_df = scaled_df","8a0d550a":"#Elbow curve method\n\nssd = []\nfor k in range(2,10):\n    kmeans = KMeans(n_clusters = k).fit(cluster_df)\n    ssd.append([k, kmeans.inertia_])\nplt.plot(pd.DataFrame(ssd)[0], pd.DataFrame(ssd)[1])\nplt.grid()\nplt.show()","7d88760d":"#Let's perform K means using K=3\n\nmodel_kmean = KMeans(n_clusters = 3, random_state = 50)\nmodel_kmean.fit(cluster_df)","e9f56bf1":"# Let's add the cluster Ids to the main data \n\ndata = pd.concat([country, num_df, pd.Series(model_kmean.labels_)], axis = 1)\ndata.rename(columns = {0:'Cluster_ID'}, inplace = True)\ndata.head()","318818dd":"# How many units are there in each category\n\ndata['Cluster_ID'].value_counts()","1aa22727":"# Plotting\n\ndata['Cluster_ID'].value_counts().plot(kind = 'barh', color = 'purple')\nplt.show()","1f2b22a6":"# Filtering the outliers in the cluster group 2\n\ncluster_2 = data.loc[data['Cluster_ID'] == 2].sort_values(by =['incomeperperson', 'internetuserate'], ascending = False )[:5].reset_index(drop = True)","cde7a59a":"# Plot the Cluster with respect to the clusters obtained\n\nplt.figure(figsize = (15,8))\nsns.scatterplot(x = 'incomeperperson', y = 'internetuserate', hue = 'Cluster_ID', s=200, data = data, palette='Set1')\n\n\n# Marking out the outlier countries\ntxt_2 = cluster_2['country'].tolist()\nfor i, txt in enumerate(txt_2):\n    plt.annotate(txt, (cluster_2.incomeperperson[i]+1, cluster_2.internetuserate[i]+5))\n    \n    \nplt.show()","a5e1e6c0":"# Plotting GDP per cluster Group\n\ndata['incomeperperson'].groupby(data['Cluster_ID']).median().plot(kind = 'bar',figsize=(15,8), color = 'orange')\n\nplt.title('GDP per Cluster Group', fontsize = 20)\nplt.xlabel('Cluster Group', fontsize = 15)\nplt.ylabel('GDP', fontsize = 15)\nplt.xticks(rotation = 'horizontal',fontsize = 15)\nplt.yticks(fontsize = 15)\nplt.show()","cdbf8414":"# Individually checking the clusters across different catogry\n\nplt.figure(figsize = (18,8))\nvar = ['incomeperperson', 'internetuserate', 'urbanrate']\nfor i in enumerate(var):\n    plt.subplot(1,3,i[0]+1)\n    sns.boxplot(x= 'Cluster_ID', y = i[1], data = data)","57ff70d7":"### Which are the countries which have high GDP and Internet usage?","732c2c7e":"**Inference**:\n- Income per person is postively corelated with internet use rate with 0.79: Basically the countries which have high income will have internet usage. It can also be seen in scatterplot\n- Income per person and internet use rate is right skewwed\n- Urban rate seems to be noramlly distributed\n- People living in urban area have high internet usage and it can be seen with a correaltion of 0.61","4e094163":"### Analysis on Cluster's formed","0b72e8b2":"___Note___:\nWe will use iterative imputer to impute missing values as the percentage of missing values is less","d7d75c7f":"**Conculsion**:\nTo conclude with cluster analysis one can say that we need to focus on Cluster Group 0 to help in terms of GDP","8f9008b0":"# Analysis and Visualization","86e7c254":"- \"internetuserate\" is in object type we need to convert it into numeric type\n- Also we will round all the Numeric columns upto 2 decimals places","e3522ed4":"- We can note that 3 different group of clusters are formed\n- We can see the outlier countries from cluster group 2\n- Outlier countries from cluster group 2 are 'Monaco', 'Liechtenstein', 'Bermuda', 'Norway', and 'Luxembourg'","ed6863b3":"## Let's ask this to ourselves,\n## How identify group of countires which need help in terms of GDP?","c668a05f":"# Clustering","7542653d":"# Importing Libraries","5c77838f":"We can see the elbow point at 3 and we will go with 3 clusters","e0a6158e":"- Monaco has the highest GDP\n- Most of lowest GDP countries are from Africa continent, this are Countries in war zones or with poor sanitation systems, diseases or very poor infrastructure","3def1180":"<h1>Upvote if you like my work\u2764\ufe0f<br>\nIf you have any queries, doubt or any suggestion feel free to drop it in comment section<h1>","d8785aae":"- Most of the European and developed nation have high internet usage\n- Similiarly as seen in the GDP section most of the African nations have low internet usage","8a666306":"# Data reading and cleaning","70f88c4f":" - Most of the values from Hopkins statisitc are coming from 0.64 to 0.75 approx.\n - As the value is good, it means good clusters are formed","29dd59b8":" Since we are focusing on GDP lets look at GDP across different cluster groups","3c3c3d65":"# Topics\n1. Importing Libraries\n2. Data reading and cleaning\n3. Analysis and Visualization\n    - Do the varaible have dependency on one another?\n    - Which are the countries which have high GDP and Internet usage?\n4. Clustering","10344d5c":"### Do the varaible have dependency on one another?"}}