{"cell_type":{"d56d4ae2":"code","43ba1b21":"code","456681c7":"code","874db0d6":"code","9a15ce97":"code","7485034d":"code","ce32f2bd":"code","712e26b0":"code","c1edebb6":"code","5ca58220":"code","b5827d4f":"code","9716afb1":"code","7aafa11e":"code","851f8c3c":"code","20e4d989":"code","22659259":"code","52af4849":"code","f28c6ac4":"code","ca788391":"code","77b553d5":"code","1670df00":"code","b4228de1":"markdown"},"source":{"d56d4ae2":"import numpy as np\nimport pandas as pd\nimport pathlib\n\nfrom sklearn.metrics import confusion_matrix\nfrom fastai import *\nfrom fastai.vision import *","43ba1b21":"DATA_DIR='..\/input\/lego-bricks-3-classes\/Lego bricks'","456681c7":"os.listdir(f'{DATA_DIR}')","874db0d6":"torch.cuda.is_available()","9a15ce97":"data = ImageDataBunch.from_folder(DATA_DIR, train=\".\", \n                                  valid_pct=0.2,\n                                  size=224, bs=10, \n                                  num_workers=0).normalize(imagenet_stats)","7485034d":"print(f'Classes: \\n {data.classes}')","ce32f2bd":"learn1 = cnn_learner(data, models.resnet18, metrics=accuracy, model_dir=\"\/tmp\/model\/\")","712e26b0":"learn2 = cnn_learner(data, models.resnet50, metrics=accuracy, model_dir=\"\/tmp\/model\/\")","c1edebb6":"learn3 = cnn_learner(data, models.densenet169, metrics=accuracy, model_dir=\"\/tmp\/model\/\")","5ca58220":"learn1.fit_one_cycle(5)","b5827d4f":"learn2.fit_one_cycle(5)","9716afb1":"learn3.fit_one_cycle(5)","7aafa11e":"interp = ClassificationInterpretation.from_learner(learn1)","851f8c3c":"interp2 = ClassificationInterpretation.from_learner(learn2)","20e4d989":"interp3 = ClassificationInterpretation.from_learner(learn3)","22659259":"interp.plot_top_losses(9, figsize=(20,15))","52af4849":"interp2.plot_top_losses(9, figsize=(20,15))","f28c6ac4":"interp3.plot_top_losses(9, figsize=(20,15))","ca788391":"interp.plot_confusion_matrix(figsize=(8,8), dpi=60)","77b553d5":"interp2.plot_confusion_matrix(figsize=(8,8), dpi=60)","1670df00":"interp3.plot_confusion_matrix(figsize=(8,8), dpi=60)","b4228de1":"# Constru\u00e7\u00e3o dos modelos"}}