{"cell_type":{"c3f89234":"code","bfe88a34":"code","f9e5a80e":"code","be07fad7":"code","2dc2501f":"code","709ea0da":"code","8bf10128":"code","a6a46f91":"code","ea19c8ff":"markdown","008e3505":"markdown","e4ac559e":"markdown","c9ec2cf9":"markdown","0cf5f433":"markdown"},"source":{"c3f89234":"import numpy as np \nimport pandas as pd\nfrom sklearn.linear_model import LogisticRegression","bfe88a34":"df_train = pd.read_csv(\"\/kaggle\/input\/titanic\/train.csv\")\ndf_test = pd.read_csv(\"\/kaggle\/input\/titanic\/test.csv\")","f9e5a80e":"def feature(df):\n    sex = 1 if df[\"Sex\"] == \"male\" else 0\n    age = df[\"Age\"]\n    fare = df[\"Fare\"]\n    if np.isnan(age):\n        age = round(df_train[\"Age\"].mean())\n    if np.isnan(fare):\n        fare = df_train[\"Fare\"].mean()\n    return [1, age, sex, fare]","be07fad7":"Xtrain = df_train.to_dict('records')\nXtrain = [feature(d) for d in Xtrain]\nytrain = df_train[\"Survived\"].to_list()\n\nXval = Xtrain[700:]\nyval = ytrain[700:]\nXtrain = Xtrain[:700]\nytrain = ytrain[:700]","2dc2501f":"model = LogisticRegression(fit_intercept=False, random_state=42, solver=\"lbfgs\")\nmodel.fit(Xtrain, ytrain)","709ea0da":"val_pred = model.predict(Xval)\ncorrect = val_pred == np.array(yval)\nacc = sum(correct) \/ len(correct)\nprint(\"Accuracy {}\".format(acc))","8bf10128":"Xtest = df_test.to_dict('records')\nXtest = [feature(d) for d in Xtest]\ntest_pred = model.predict(Xtest)","a6a46f91":"ids = df_test[\"PassengerId\"].to_list()\nfile = open(\"answer.csv\", \"w\")\nfile.write(\"PassengerId,Survived\\n\")\nfor id_, pred in zip(ids, test_pred):\n    file.write(\"{},{}\\n\".format(id_, pred))\nfile.close()","ea19c8ff":"# Preprocess","008e3505":"# Test","e4ac559e":"# Load Data","c9ec2cf9":"# Validate","0cf5f433":"# Fit model"}}