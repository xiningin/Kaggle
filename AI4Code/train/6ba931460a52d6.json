{"cell_type":{"3709080e":"code","996c1679":"code","4bd7606c":"code","9b6f4388":"code","4391d8a0":"code","64d9b2bc":"code","d9489508":"code","3f05240b":"code","7e63e36a":"code","f5cc9931":"code","4a48fc92":"code","9c39d26d":"code","d69f92e7":"code","411b7d82":"code","e3ab5318":"code","a4ba9122":"code","59ca1204":"code","a56a2862":"code","43c864ab":"code","95eae54e":"code","a7eab520":"code","2bdfff90":"markdown","56bd9d45":"markdown","f0064bac":"markdown","eeb2f050":"markdown"},"source":{"3709080e":"%reload_ext autoreload\n%autoreload 2\n%matplotlib inline","996c1679":"from fastai import *\nfrom fastai.vision import *\nfrom PIL import Image","4bd7606c":"img = Image.open('..\/input\/stanford-car-dataset-by-classes-folder\/car_data\/car_data\/train\/Acura Integra Type R 2001\/00198.jpg')\nwidth, height = img.size","9b6f4388":"width, height","4391d8a0":"path = '..\/input\/stanford-car-dataset-by-classes-folder\/car_data\/car_data\/'","64d9b2bc":"np.random.seed(42)\ndata = ImageDataBunch.from_folder(path,valid_pct=0.2, \n                                  ds_tfms=get_transforms(), \n                                  size=300, bs=64, num_workers=4).normalize(imagenet_stats)","d9489508":"data.classes","3f05240b":"data.show_batch(rows=3, figsize=(10,12))","7e63e36a":"learn = create_cnn(data, models.resnet50, metrics=[error_rate,accuracy], model_dir = '\/kaggle\/working\/')","f5cc9931":"learn.fit_one_cycle(6)","4a48fc92":"learn.save('stage-1')","9c39d26d":"learn.lr_find()","d69f92e7":"learn.recorder.plot()","411b7d82":"learn.unfreeze()\nlearn.fit_one_cycle(4, max_lr=slice(1e-6, 1e-5))","e3ab5318":"learn.save('stage-2')","a4ba9122":"learn.load('stage-2');","59ca1204":"interp = ClassificationInterpretation.from_learner(learn)","a56a2862":"interp.plot_confusion_matrix()","43c864ab":"learn.recorder.plot_losses()","95eae54e":"interp.plot_top_losses(6, figsize=(30,26))","a7eab520":"interp.most_confused(min_val=4)","2bdfff90":"As we know that 'fit_one_cycle' (based on Leslie Smith's 1-cycle policy) helps in getting\nbetter results than 'fit' method.","56bd9d45":"# Data Preprocessing","f0064bac":"# Interpretation","eeb2f050":"# Training Model"}}