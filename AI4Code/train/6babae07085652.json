{"cell_type":{"1b507e1e":"code","d0be60d7":"code","e6e13b75":"code","12f461b5":"code","1e82569f":"code","105292b3":"code","b8c614dc":"code","c73aecdc":"code","4950ddbb":"code","9115619b":"code","a6b3a479":"code","955e9532":"code","b2ca6c92":"code","36df2d86":"code","f4a41ddf":"code","d9cf4f0c":"code","e269567b":"code","f5fbc75d":"code","cc86c0ee":"code","c8c470c3":"code","9a4c4cb3":"code","bebdf6b4":"code","f2a9a3d8":"code","ef7c6362":"code","7f64baad":"code","a8335d1e":"code","79890eb3":"code","b94c246f":"code","b27b71c2":"code","a89f94cd":"code","5b0fd5e2":"code","f4f18a50":"code","9bf3fa97":"code","c5e85c65":"code","b95da6f3":"code","ed9e3940":"code","ba81432b":"code","785cfe8c":"code","243f3c90":"code","3cfe8053":"code","9910b3cf":"code","2f50afc4":"code","e98ccead":"code","9a6b8de3":"code","4d1c9c79":"code","a8d40992":"code","74bc5f47":"code","ece962a2":"code","4a168e2f":"code","9443ffdc":"code","8d30ad97":"code","cc961652":"code","4f4d1262":"code","c453f20e":"code","8dc14cac":"code","5ecd198b":"code","766f96ca":"markdown","2adb6440":"markdown","2fb6a9f9":"markdown","24de73a8":"markdown","61d19dc2":"markdown","f68a5895":"markdown","eaef9928":"markdown","42b7c3fa":"markdown","b572e5c5":"markdown","6726c7e2":"markdown","af879c2e":"markdown","c463ddff":"markdown","ca0de2c7":"markdown","a6401f16":"markdown","85ff10e9":"markdown","cfc80191":"markdown","b9d8df24":"markdown","826340a0":"markdown","fa2152c3":"markdown","5e1aa4ce":"markdown","49a59576":"markdown","df041943":"markdown","45ab5a81":"markdown","e6dc958f":"markdown","2cc4b98e":"markdown","96ca81f1":"markdown","1abd8d4a":"markdown","3e294fc8":"markdown","f0bace94":"markdown","091a790e":"markdown","9314b258":"markdown","869437f6":"markdown","9a9d3731":"markdown","92438c52":"markdown","112b7aa1":"markdown","97f93c16":"markdown","052ee8e6":"markdown","044b0a88":"markdown","6e1e6a7c":"markdown","433d87ba":"markdown","89c3f470":"markdown","9ca345c4":"markdown","d7286c9d":"markdown"},"source":{"1b507e1e":"# Importing the required libraries.\n\nimport numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nfrom collections import Counter\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))\n\n\n        \n# Ignoring Unnecessary warnings\nimport warnings\nwarnings.filterwarnings(\"ignore\")","d0be60d7":"#data reading\ndata=pd.read_csv(\"\/kaggle\/input\/red-wine-quality-cortez-et-al-2009\/winequality-red.csv\")\n","e6e13b75":"data.head()","12f461b5":"# detailed overview ofthe data\nimport pandas_profiling as pp\ndf=data\nreport=pp.ProfileReport(df,title = \"Pandas Profile Report\")\nreport","1e82569f":"print(\"Columns names in the data :\",data.columns)","105292b3":"# shape of data.\ndata.shape","b8c614dc":"#Data type for all of the columns in the data\ndata.dtypes","c73aecdc":"#to check any missing value in the data.\ndata.isnull().values.any()","4950ddbb":"data.isna().sum()\n","9115619b":"duplicate_entries = data[data.duplicated()]\nduplicate_entries.shape","a6b3a479":"print(\"Number of duplicated rows :\",data.duplicated().sum())","955e9532":"data[data.duplicated(keep = 'first')].shape","b2ca6c92":"#Information about the dataset\ndata.info()","36df2d86":"data.describe()","f4a41ddf":"data[\"quality\"].unique()","d9cf4f0c":"data[\"quality\"].value_counts()","e269567b":"bins=[0,5,7,10]\nlabels=[0,1,2]\ndata['wine_quality']=pd.cut(data['quality'],bins=bins,labels=labels)","f5fbc75d":"\nCounter(data[\"wine_quality\"])","cc86c0ee":"Counter(data[\"quality\"])","c8c470c3":"data.rename({'fixed acidity':'fixed_acidity', 'volatile acidity':'volatile_acidity', 'citric acid':'citric_acid', 'residual sugar':'residual_sugar',\n       'free sulfur dioxide':'free_sulfur_dioxide', 'total sulfur dioxide':'total_sulfur_dioxide'},inplace=True)\ndata.columns\n","9a4c4cb3":"data.corr()","bebdf6b4":"plt.figure(figsize=(12,12))\nsns.heatmap(data=data.corr(),annot=True,cmap=\"bwr\")\nplt.show()","f2a9a3d8":"sns.pairplot(data,hue='wine_quality')\nplt.show()","ef7c6362":"data.hist(bins=10,figsize=(12,10))\nplt.show()","7f64baad":"sns.countplot(x=\"quality\",data=data)\nplt.show()","a8335d1e":"sns.countplot(x=\"wine_quality\",data=data)","79890eb3":"sns.boxplot(data['quality'],data['alcohol'],palette ='GnBu_d')\nplt.title(\"Boxplot of quality and alcohol\")\nplt.show()","b94c246f":"data.plot(kind='box',subplots=True,layout=(4,3),grid=True,figsize=(10,10))\nplt.tight_layout()\nplt.show()","b27b71c2":"for i in data.columns:\n    if i ==\"quality\":\n        break\n    sns.boxplot(\"quality\",i,data=data)\n    plt.show()","a89f94cd":"for i in data.columns:\n    if i == \"quality\":\n        break\n    sns.barplot(\"quality\",i,data=data)\n    plt.show()\n\n# barplot with matplotlib\n    \n\"\"\"\nfor i in data.columns:\n    if i == \"quality\":\n        break\n    plt.bar(x='quality',height=i,data=data)\n    plt.xlabel(\"quality\")\n    plt.ylabel(i)\n    plt.show()\n\"\"\"","5b0fd5e2":"from sklearn.model_selection import train_test_split, GridSearchCV,cross_val_score\nfrom sklearn.preprocessing import StandardScaler, MinMaxScaler,Normalizer, RobustScaler\nfrom sklearn.metrics import accuracy_score, classification_report, confusion_matrix\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.svm import SVC\nfrom sklearn.ensemble import RandomForestClassifier","f4f18a50":"X=data.iloc[:,:-2]\nY=data.iloc[:,-1:]\nX.head()","9bf3fa97":"sc=RobustScaler()  \ndata=sc.fit_transform(X)\ndata[:5]","c5e85c65":"train_x,test_x,train_y,test_y=train_test_split(data,Y,test_size=0.15,random_state=2)\nprint(\"shape of train input data:\",train_x.shape,\"\\n shape of train output data\",train_y.shape,\n      \"\\nshape of test input data \",test_x.shape,\"\\nshape of test output data\",test_y.shape)","b95da6f3":"model=LogisticRegression()\nmodel.fit(train_x,train_y)","ed9e3940":"pred=model.predict(test_x)\npred[:5]","ba81432b":"print(\"Accuracy Score:\",accuracy_score(pred,test_y))\nprint(\"classification Report:\\n\",classification_report(pred,test_y))\nprint(\"confusion Matrix:\\n\",confusion_matrix(pred,test_y))","785cfe8c":"svc=SVC()\nsvc.fit(train_x,train_y)","243f3c90":"pred=svc.predict(test_x)\npred[:5]","3cfe8053":"print(\"Accuracy Score:\",accuracy_score(pred,test_y))\nprint(\"classification Report:\\n\",classification_report(pred,test_y))\nprint(\"confusion Matrix:\\n\",confusion_matrix(pred,test_y))\n","9910b3cf":"#parameters\nparam= {'C':[0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1,1.1,1.2,1.3,1.4,1.5],\n       'kernel':[\"linear\",\"rbf\"],\n       'gamma':[0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1,1.1,1.2,1.3,1.4,1.5]}\n","2f50afc4":"grid_svc= GridSearchCV(svc, param_grid=param, scoring='accuracy', cv=5)\ngrid_svc.fit(train_x,train_y)","e98ccead":"grid_svc.best_params_","9a6b8de3":"svc2=SVC(C= 1, gamma= 0.9, kernel='rbf')\n\nsvc2.fit(train_x,train_y)","4d1c9c79":"pred=svc2.predict(test_x)\npred[:5]","a8d40992":"print(\"Accuracy Score:\",accuracy_score(pred,test_y))\nprint(\"classification Report:\\n\",classification_report(pred,test_y))\nprint(\"confusion Matrix:\\n\",confusion_matrix(pred,test_y))","74bc5f47":"svc_eval = cross_val_score(estimator = svc2, X = train_x, y = train_y, cv =5,verbose =1)\nsvc_eval.mean()","ece962a2":"rf = RandomForestClassifier()\nrf.fit(train_x,train_y)","4a168e2f":"pred_rf=rf.predict(test_x)\npred_rf[:5]","9443ffdc":"print(\"Accuracy Score:\",accuracy_score(pred_rf,test_y))\nprint(\"classification Report:\\n\",classification_report(pred_rf,test_y))\nprint(\"confusion Matrix:\\n\",confusion_matrix(pred_rf,test_y))","8d30ad97":"#parameters\nparam= {'max_depth':range(3,10),\n       'criterion':[\"gini\",\"entropy\"],\n       'max_features':[\"auto\", \"sqrt\", \"log2\"]}","cc961652":"grid_rf= GridSearchCV(RandomForestClassifier(), param_grid=param, scoring='accuracy', cv=5)\ngrid_rf.fit(train_x,train_y)","4f4d1262":"grid_rf.best_score_","c453f20e":"rf = grid_rf.best_estimator_\npred_rf=rf.predict(test_x)\npred_rf[:5]","8dc14cac":"print(\"Accuracy Score:\",accuracy_score(pred_rf,test_y))\nprint(\"classification Report:\\n\",classification_report(pred_rf,test_y))\nprint(\"confusion Matrix:\\n\",confusion_matrix(pred_rf,test_y))","5ecd198b":"rf_eval = cross_val_score(estimator = rf, X = train_x, y = train_y, cv =5,verbose =1)\nrf_eval.mean()","766f96ca":"### Head\n\nTo take a closer look at the data, we take the help of \u201c .head()\u201d function of pandas library which returns the first five observations of the data set. Similarly, \u201c.tail()\u201d returns last five observations of the data set.\n\nYou\u2019ll see that this is a great way to get an initial feeling of your data and maybe understand it a bit better already!","2adb6440":"### Observations:\nThe data has only float and integer values.\n\nThere are no missing values","2fb6a9f9":"### Renaming Columns\n\nLet's rename the columns which contain spaces in their names and replace the spaces with underscores.","24de73a8":"### Loading Libraries\nAll Python capabilities are not loaded to our working environment by default (even they are already installed in your system). So, we import each and every library that we want to use.\n\n\nIn data science, numpy and pandas are most commonly used libraries. Numpy is required for calculations like means, medians, square roots, etc. Pandas is used for data processin and data frames. We chose alias names for our libraries for the sake of our convenience (numpy --> np and pandas --> pd).","61d19dc2":"**Scaling of the data**","f68a5895":"## Observations:\nThe distribution of the attribute \u201calcohol\u201d seems to be positively skewed i.e the curve is shifted towards the left.\nThe attributes 'density' and 'pH' are quite normally distributed.\n\nNow looking at the attribute quality, we can observe that the wines with average quality (i.e. quality rating 5 to 7) are more than wines with bad(1-4) or good(8-10) quality.","eaef9928":"### Graphical Relation between the data variables.","42b7c3fa":"### Observations:\nThere are 240 duplicates. The quality ratings for the same\/similar wine were given by different wine tasters so there is a possibility of similar reviews. We can thus keep these duplicates.","b572e5c5":"### Unique Values of Quality(Target Variable)","6726c7e2":"## Histogram\nHistograms use bars to visualize data as well. Many people may not even realize there is a difference between a histogram and a bar chart. They practically look the same from a distance.\n\nThe key is that a histogram looks solely at quantitative variables while a bar chart looks at categorical variables. That\u2019s why the bars in a histogram are typically grouped together without spacing in between the bars.","af879c2e":"### Box Plot\nA box plot is a great way to get a visual sense of an entire range of data. It can tell you about your outliers and what their values are. It can also tell you if your data is symmetrical, how tightly your data is grouped, and if and how your data is skewed.\n\nBox plots divides data into its quartiles. The \u201cbox\u201d shows a user the data set between the first and third quartiles.\n\nThe median gets drawn somewhere inside the box and then you see the most extreme non-outliers to finish the plot. Those lines are known as the \u201cwhiskers\u201d. If there are any outliers then those can be plotted as well.\n\nWith box plots you can answer how diverse or uniform your data might be. You can identify what is normal and what is extreme. Box plots help give a shape to your data that is broad without sacrificing the ability to look at any piece and ask more questions.\n\nIt displays the five-number summary of a set of data. The five-number summary is:\n\n1. minimum\n2. first quartile (Q1)\n3. median\n4. third quartile (Q3)\n5. maximum","c463ddff":"#### Observation:\nThe average(5-7) quality of wines are more than good(1-4) and bad(8-10) quality of wines.","ca0de2c7":"\n\nCreating a pictorial visualisation of the above correlation matrix using a heatmap helps in better understanding. We can do that using Seaborn's Heatmap function.","a6401f16":"###  info()\n`df.info` returns information about the data frame including the data types of each column, number of null values in each column and memory usage of the entire data.\n\n","85ff10e9":"From the above correlation matrix, we can observe that there is a relatively high positive correlation between **fixed_acidity** and **citric_acid**, **fixed_acidity** and **density**. \n\nSimilarly we can observe there is a relatively high negative correlation between **fixed_acidity** and **pH**. There is relatively high positive correlation between alcohol presence and quality of the wines.","cfc80191":"**Please upvote the notebook if you find it useful. Your comments are also requested for improvement of the notebook. **","b9d8df24":"### Loading Data\nPandas module is used for reading files. We have our data in '.csv' format. We will use 'read_csv()' function for loading the data.","826340a0":"### Input Variables:\u00b6\nOne or more variables that are used to determine (or predict) the 'Target Variable' are known as Input Variables. They are sometimes called Predictor Variable as well.\n\nIn our example, the input variables are: 'fixed acidity', 'volatile acidity', 'citric acid', 'residual sugar', 'chlorides', 'free sulfur dioxide', 'total sulfur dioxide', 'density','pH', 'sulphates', and 'alcohol'.\n\nAll of these will help us predict the quality of the wine.","fa2152c3":"## Observations:\n- Dataset comprises 1599 observations(rows) and 12 features(columns).\n- Out of the 12, one is the target variable and rest 11 are input variables.","5e1aa4ce":"Pandas Profiling library is very useful and easy for the detailed overview and EDA ofthe data.","49a59576":"We can visualize scatterplot matrix for the better understanding relationship between a pair of variables. It plots every numerical attribute against every other. 'pairplot' of seaborn helps to achieve this","df041943":"### Checking for Duplicates\nDuplicates might or might not affect the quality of data. Before deciding if they should be removed, it is essential to understand why they might have occurred in the first place.\n\nDuplicates can be checked using the duplicated() method.","45ab5a81":"### Checking for Missing Values\nHandling missing values is an essential part of the data cleaning and preparation process because almost all data in real life comes with some missing values.\n\nPandas provides isnull(), isna() functions to detect missing values. Both of them do the same thing.\n\n- df.isna() returns the dataframe with boolean values indicating missing values.\nYou can also choose to use notna() which is just the opposite of isna().\n- df.isna().any() returns a boolean value for each column. If there is at least one missing value in that column, the result is True.\n- df.isna().sum() returns the number of missing values in each column.","e6dc958f":"### Observations:\nThis tells us the vote count of each quality score in descending order.\n\n\u201cquality\u201d has most values concentrated in the categories 5, 6 and 7.\n\nOnly a few observations made for the categories 3 & 8","2cc4b98e":"### Observation:\nThe above plot shows the increase in the quality of wine with an increase in alcohol. The quality of the wine is directly related to the amount of alcohol in the wine. More the alcohol in the wine, the better will be the quality.\nAlso, the points lying outside the whiskers(the lines extending from the rectangular box) are the outliers.","96ca81f1":"Find out the total number of rows and columns in the dataset using `.shape`.","1abd8d4a":"### Pair Plot\nThe pair plot builds on two basic figures, the histogram and the scatter plot. The histogram on the diagonal allows us to see the distribution of a single variable while the scatter plots on the upper and lower triangles show the relationship (or lack thereof) between two variables.\n\nIt plots every numerical attribute against every other.\n\npairplot function of seaborn helps to achieve this","3e294fc8":"There is no missing value in any column","f0bace94":"### LogisticRegression Model","091a790e":"### Observations:\nHere as you can notice the mean value is less than the median value of each column. Median is represented by 50%(50th percentile) in the index column.This signifies the presence of Outliers. For example, a data set includes values: 30, 31, 32, and 2. The mean value (23.75), which is lower than the median of the data (30.5), is greatly affected by the extreme data point(2). \n\nThere is notably a large difference between 75th %tile and max values of predictors \u201cresidual sugar\u201d, \u201d free sulfur dioxide\u201d, \u201d total sulfur dioxide\u201d. This indicates that some values of these 3 variables lie much farther from the general range of values( up to 75th %tile) \n\nThus, the observations 1 and 2 suggest that there are extreme values i.e Outliers in our dataset. ","9314b258":"### Count Plot\nThe variable quality is categorical in nature and we can visualize these types of variables using barplot or countplot.\n\nCount plot is a graphical display to show the number of occurrences or frequency for each categorical data using bars.\n\n\nLet's plot a histogram now! On calling the hist( ) method on a DataFrame, you'll get histograms for all the Series.","869437f6":"Now what are the Input and Target variables in the wine detection problem? Let\u2019s have a look:\n\n**Input variables:**\n\n- fixed acidity\n- volatile acidity\n- citric acid\n- residual sugar\n- chlorides\n- free sulfur dioxide\n- total sulfur dioxide\n- density\n- pH\n- sulphates\n- alcohol\n\n**Output variable:**\n\n- quality (score between 0 and 10)","9a9d3731":"#### Variables\/Features:\u00b6\nVariables and features both are the same, they are often used interchangeably. All the column names in a dataset are variable","92438c52":"### Observations:\nAlcohol has the highest positive correlation with wine quality, followed by the various other variables such as acidity, sulphates, density & chlorides.\n\nThere is a relatively high positive correlation between fixed_acidity and citric_acid, fixed_acidity and density.\nThere is a relatively high negative correlation between fixed_acidity and pH.\n\nDensity has a strong positive correlation with fixed_acidity, whereas it has a strong negative correlation with alcohol.\ncitric acid & volatile acidity have negative correlation.\n\nfree sulphur dioxide & total sulphur dioxide have positive correlation.","112b7aa1":"# Correlation Matrix with Heatmap\nCorrelation:\nCorrelation is a statistical measure. Data correlation is a way to understand the relationship between multiple values or features in your dataset.\n\nEvery single successful data science project revolves around finding accurate correlations between the input and target variables. However more than often, we oversee how crucial correlation analysis is. \n\nIt is recommended to perform correlation analysis before and after data gathering and transformation phases of a data science project.\n\n There are three different types of correlations:\n\n1. Positive Correlation: Two features (variables) can be positively correlated with each other. It means that when the value of one variable increases then the value of the other variable(s) also increases (also decreases when the other decreases).\nEg. The more time you spend running on a treadmill, the more calories you will burn.\n\n2. Negative Correlation: Two features (variables) can be negatively correlated with each other. This occurs when the value of one variable increases and the value of another variable(s) decreases (inversely proportional).\nEg. As the weather gets colder, air conditioning costs decrease.\n\n3. No Correlation: Two features might not have any relationship with each other. This happens when the value of a variable is changed then the value of the other variable is not impacted.\n\nEg. There is no relationship between the amount of tea drunk and level of intelligence.\n- Each of these correlation types exists in a spectrum represented by values from -1 to +1 where slight or high positive correlation features can be like 0.5 or 0.7.\n\n- A very strong and perfect positive correlation is represented by a correlation score of 0.9 or 1.\n- If there is a strong negative correlation, it will be represented by a value of -0.9 or -1. Values close to zero indicates no correlation.\n\nWe can check how each feature is related to others using corr() function.\n\n ","97f93c16":"### Support Vector Machine ","052ee8e6":"### Get a Statistical Overview using Describe\nThe describe() function in pandas is very handy in getting various summary statistics. This function returns the count, mean, standard deviation, minimum and maximum values and the quantiles of the data.\n\nLet's explore different statistical measures that we have got from describe().\n- count: total count of non-null values in the column\n- mean: the average of all the values in that column\n- min: the minimum value in the column\n- max: the maximum value in the column\n- 25%: first quartile in the column after we arrange those values in ascending order\n- 50%: this is the median or the second quartile\n- 75%: the third quartile\n- std: this is the standard deviation (i.e. measure of depreciation, you must have read in the basics of statistics study material)\nNote: 25%, 50%, and 75% are nothing but corresponding percentile values","044b0a88":"### Frequency Counts of each Quality Value","6e1e6a7c":"### Cross validation","433d87ba":"\nThe correlation between **fixed_acidity** and **citric_acid** is 0.67 (you could find this value in the correlation matrix of red wines). Looking for scatterplot for this pair of variables, we can see the positive linear correlation between these two variables. We can observe the upward trend, and also the points are not too dispersed","89c3f470":"### Observations:\nFew key insights just by looking at the target variable are as follows:\n\nTarget variable\/Dependent variable is discrete and categorical in nature.\n\n\u201cquality\u201d score scale ranges from 1 to 10; 1 being poor and 10 being the best.\n\n1,2,9 & 10 Quality ratings are not given by any observation. Only scores obtained are between 3 to 8.","9ca345c4":"**Grid Search CV**","d7286c9d":"## Decision Tree Classifier"}}