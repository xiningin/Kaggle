{"cell_type":{"855253b2":"code","99fe84c9":"code","b74f7438":"code","fc6b5092":"code","8997ba60":"code","55f857dc":"code","1432926e":"code","3babc47c":"code","87ce5975":"code","ccd17611":"code","4843c7a8":"code","a2da6e9b":"code","8420ef36":"code","29794a6b":"code","37319868":"code","aa8eb49d":"code","77bc8350":"code","6dbdba06":"code","6e249bf7":"code","d95b986b":"code","6620df08":"code","0727c950":"code","01e6ca46":"code","03baadbb":"code","ad3d260e":"code","b8a9edc0":"code","b6d09d2b":"code","48e48178":"code","b733d827":"code","55e4f085":"code","3e728019":"code","d898883b":"code","fb4621d1":"code","806b07ef":"code","059a8b5a":"code","f07a6072":"code","fd3ec551":"code","c8f7283f":"code","019914a4":"code","ddbda9b5":"code","77276944":"code","a702c500":"code","f6968429":"code","59e53556":"code","ef9b6a24":"code","b59f9177":"code","948e042a":"markdown","7bcf7f5a":"markdown","ea3c4be3":"markdown","a1769e5e":"markdown","20afa99b":"markdown","74cbdb31":"markdown","6cb2ca59":"markdown","18e9aa69":"markdown","80eec569":"markdown","f72f1520":"markdown","cf7a8802":"markdown","683b77d6":"markdown","b713051d":"markdown","231e4cd6":"markdown","26079d22":"markdown","72e46612":"markdown","bd9397c2":"markdown","0ffde04a":"markdown"},"source":{"855253b2":"import pandas as pd\nimport numpy as np\nimport statistics as stat\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn import preprocessing\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.linear_model import LinearRegression,LogisticRegression\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import accuracy_score\nfrom sklearn.metrics import confusion_matrix\nfrom sklearn.metrics import classification_report,roc_auc_score,roc_curve,auc\nimport statsmodels.api as sm","99fe84c9":"df=pd.read_csv('test_Y.csv')","b74f7438":"df1=pd.read_csv('train_u.csv')","fc6b5092":"df.head(5)","8997ba60":"df1.head(5)","55f857dc":"print(df.columns)\nprint(df1.columns)","1432926e":"#summery of numerical variable for training dataset\ndf1.describe()","3babc47c":"#Types of variable\ndf1.dtypes","87ce5975":"#Getting the percentage value for the Property_area\nr=pd.get_dummies(df1['Property_Area'])\nr1=(sum(r[\"Semiurban\"]),sum(r[\"Urban\"]),sum(r[\"Rural\"]))\nplt.pie(r1,labels=[\"Semiurban\",\"Urban\",\"Rural\"],shadow=True,explode=(.1,.1,.1), autopct='%1.1f%%')","ccd17611":"#Get, how many male and feamale take the loan\nr2=pd.get_dummies(df1['Gender'])\nr3=(sum(r2[\"Female\"]),sum(r2[\"Male\"]))\nplt.pie(r3,labels=[\"Male\",\"Female\"],shadow=True,explode=(.1,.1), autopct='%1.1f%%')","4843c7a8":"#Get,percent value for variable Education\np=pd.get_dummies(df1['Education'])\np1=(sum(p[\"Graduate\"]),sum(p[\"Not Graduate\"]))\nplt.pie(p1,labels=[\"Graduate\",\"Not Graduate\"],shadow=True,explode=(.1,.1), autopct='%1.1f%%')","a2da6e9b":"sns.distplot(df1['ApplicantIncome'],bins=100)","8420ef36":"df1['ApplicantIncome'].plot(kind=\"kde\",figsize=(20,5))","29794a6b":"sns.catplot(data=df1,x='Education',y='ApplicantIncome',hue='Loan_Status',kind='box')\n#df1.boxplot(column='ApplicantIncome',by='Education')","37319868":"sns.catplot(data=df1,x='Education',y='LoanAmount',hue='Loan_Status',kind='boxen')","aa8eb49d":"sns.catplot(data=df1,x='Married',y='ApplicantIncome',hue='Loan_Status',kind='box')","77bc8350":"df1['LoanAmount_log']=np.log(df1['LoanAmount'])\nsns.distplot(df1['LoanAmount_log'],bins=20)","6dbdba06":"sns.boxplot(data=df1,y='LoanAmount',x='Education',hue='Loan_Status')","6e249bf7":"sns.boxplot(data=df1,y='LoanAmount',x='Married',hue='Loan_Status')","d95b986b":"sns.boxplot(data=df1,y='LoanAmount',x='Gender',hue='Loan_Status')","6620df08":"sns.distplot(df['LoanAmount'],bins=20)","0727c950":"loan_app=df1['Loan_Status'].value_counts()[\"Y\"]\nprint(loan_app)","01e6ca46":"print(pd.crosstab(df1[\"Credit_History\"],df1[\"Loan_Status\"],margins=True))\nplt.figure(figsize=(10,4))\nsns.countplot(x='Credit_History',hue='Loan_Status',data=df1,order=df1['Credit_History'].value_counts().index);","03baadbb":"plt.figure(figsize=(10,4))\nsns.countplot(x='Education',hue='Loan_Status',data=df1,order=df1['Education'].value_counts().index);","ad3d260e":"plt.figure(figsize=(10,4))\nsns.countplot(x='Gender',hue='Loan_Status',data=df1,order=df1['Gender'].value_counts().index);","b8a9edc0":"def percentagecon(ser):\n    return ser\/float(ser[-1])\ndf_1=pd.crosstab(df1[\"Credit_History\"],df1[\"Loan_Status\"],margins=True).apply(percentagecon,axis=1)\nloan_app_wcredit_1=df_1[\"Y\"][1]\nprint(loan_app_wcredit_1*100)","b6d09d2b":"plt.plot(df1['ApplicantIncome'])\nplt.plot(df1['CoapplicantIncome'])\ndf1['TotalIncome']=df1['ApplicantIncome']+df1['CoapplicantIncome']","48e48178":"sns.distplot(df1['TotalIncome'],bins=20)","b733d827":"cat=['Gender','Married','Dependents','Education','Self_Employed','Credit_History','Property_Area','Loan_Status']\nfor var in cat:\n    le=preprocessing.LabelEncoder()\n    df1[var]=le.fit_transform(df1[var].astype('str'))\ndf1.dtypes","55e4f085":"x2=['LoanAmount','ApplicantIncome','CoapplicantIncome','Loan_Amount_Term']\nfor i in x2:\n    df1[i].fillna(df1[i].mean(),inplace=True)\ndf1['Credit_History'].fillna(df1['Credit_History'].mode()[0],inplace=True)","3e728019":"#we choose dependent and independent variables\nx=df1[['Credit_History','Education','Gender']]\ny=df1['Loan_Status']","d898883b":"#Summery of logistic Regression model\nimport statsmodels.api as sm\nx1=sm.add_constant(x)\nlogist_modal=sm.Logit(y,x1)\nresult=logist_modal.fit()\nprint(result.summary())","fb4621d1":"x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=.20)\nlog_reg=LogisticRegression()\nlog_reg.fit(x_train,y_train)","806b07ef":"y_pred=log_reg.predict(x_test)","059a8b5a":"accuracy=accuracy_score(y_test,y_pred)\nprint(accuracy)","f07a6072":"tp,fp,fn,tn=confusion_matrix(y_test,y_pred).ravel()\nprint(\"True_positive\",tp)\nprint(\"False_positive\",fp)\nprint(\"False_negative\",fn)\nprint(\"True_negative\",tn)","fd3ec551":"print(classification_report(y_test,y_pred))","c8f7283f":"y_prob_train=log_reg.predict_proba(x_train)[:,1]\ny_prob_train.reshape(1,-1)","019914a4":"fpr_p,tpr_p,threshol=roc_curve(y_train,y_prob_train)\nroc_auc_p=auc(fpr_p,tpr_p)\nprint(roc_auc_p)","ddbda9b5":"plt.figure()\nplt.plot(fpr_p,tpr_p,color='green',label='ROC curve'% roc_auc_p)\nplt.plot([0,1],[0,1],'r--')\nplt.xlim([0.0,1.0])\nplt.ylim([0.0,1.05])\nplt.xlabel('False positive Rate')\nplt.ylabel('True Positive Rate')\nplt.title('Recurcive Operating characterstics')\nplt.legend(loc='lower right')\nplt.show()","77276944":"df1['Type']='Train'\ndf['Type']='Test'\nN_data=pd.concat([df1,df],axis=0,sort=True)\nN_data.isnull().sum()","a702c500":"idcol=['Loan_ID']\ntar_col=[\"Loan_Status\"]\nnew_col=['Credit_History','Dependents','Gender','Married','Education','Property_Area','Self_Employed']\nfor var in new_col:\n    num=LabelEncoder()\n    N_data[var]=num.fit_transform(N_data[var].astype('str'))\n    \ntrain_mod=N_data[N_data['Type']=='Train']\ntest_mod=N_data[N_data['Type']=='Test']\ntrain_mod[\"Loan_Status\"]=num.fit_transform(train_mod[\"Loan_Status\"])","f6968429":"N_data['TotalIncome']=N_data['ApplicantIncome']+N_data['CoapplicantIncome']\nN_data['TotalIncome_log']=np.log(N_data['TotalIncome'])\nsns.distplot(N_data['TotalIncome_log'],bins=20)","59e53556":"predict_log=['Credit_History','Education','Gender']\nx_train_c=train_mod[predict_log]\ny_train_c=train_mod['Loan_Status']\nx_test_c=test_mod[predict_log]","ef9b6a24":"result_c=log_reg.fit(x_train_c,y_train_c)\npredicted_c=log_reg.predict(x_test_c)\npredicted_c=num.inverse_transform(predicted_c)\ntest_mod['Loan_Status']=predicted_c","b59f9177":"y_c=y[:367]\naccuracy_c=accuracy_score(predicted_c,y_c)\nprint(accuracy_c)","948e042a":"# Reading Training Dataset....","7bcf7f5a":"# Reading Test Dataset......","ea3c4be3":"79.5% loan are approved whose credit_history is 1","a1769e5e":"# Understanding the distribution and to observe the outliers","20afa99b":"# Analysis the dataset using training as well as test ","74cbdb31":" prediction accuracy is 80.48%","6cb2ca59":"# Analysis the training dataset","18e9aa69":"# Data Visulization of training dataset","80eec569":"# Dealing the missing\/outlier values","f72f1520":"#box plot show the both mean value is same. Some graduate people high income but tose are not eligible for loan","cf7a8802":"#box plot shows married people have high income but those are not eligible for loan","683b77d6":"# 422 number of loans approved","b713051d":"# Transform the categorical data into numerical data","231e4cd6":"# Visulization of categorical variable ","26079d22":"# Detail of related variable(i.e. columns name)","72e46612":"#Now we see Graduated people are take loan","bd9397c2":"# Loan_Prediction_project","0ffde04a":"#loanAmount has missing values as well as outlier and ApplicantIncome has some outliers"}}