{"cell_type":{"719c8bd0":"code","07a1eec0":"code","9d67ba32":"code","30a0520c":"code","6bce4dad":"code","94c9f713":"code","85d6c014":"code","eaed8a47":"code","6252c434":"markdown","53b20e2d":"markdown","f122f5f6":"markdown","406883d5":"markdown","ab328fb2":"markdown","b7020e41":"markdown","15a86ad9":"markdown","19f8cea4":"markdown","00f97cff":"markdown","96ae2fa2":"markdown","ef4595ee":"markdown","d26cc914":"markdown"},"source":{"719c8bd0":"import os\nimport numpy as np \nimport pandas as pd \n\n# List input files\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","07a1eec0":"!pip install pyTsetlinMachineParallel\n\n!export OMP_NUM_THREADS=10","9d67ba32":"def unpickle(file):\n    import pickle\n    with open(file, 'rb') as fo:\n        dict = pickle.load(fo, encoding='bytes')\n    return dict","30a0520c":"from pyTsetlinMachineParallel.tm import MultiClassTsetlinMachine\nimport numpy as np\nfrom sklearn.model_selection import train_test_split\nimport matplotlib.pyplot as plt\nfrom time import time\nfrom tqdm import tqdm\n\nepochs = 200\n\n## We will use the QMNIST dataset to boost the performance\nqmnist = unpickle(\"\/kaggle\/input\/qmnist-the-extended-mnist-dataset-120k-images\/MNIST-120k\")\ndata = qmnist['data']\nlabels = qmnist['labels']\n\n## We can use also the conventional MNIST dataset from keras.datasets\n# from keras.datasets import mnist\n#(X_train, Y_train), (X_test, Y_test) = mnist.load_data()\n\n# Split data\nX_train, X_val, Y_train, Y_val = train_test_split(data, labels, test_size=0.05, random_state=31)\n\n# Data pre-processing\nX_train = np.where(X_train.reshape((X_train.shape[0], 28*28)) > 75, 1, 0) \nX_val = np.where(X_val.reshape((X_val.shape[0], 28*28)) > 75, 1, 0) \n\nY_train = Y_train.flatten()\nY_val = Y_val.flatten()\n\n# The Convolutional Tsetlin Machine definition\ntm = MultiClassTsetlinMachine(2000, 50, 10.0)\n\n\nacc_test = []\nprint(\"\\nAccuracy over {} epochs:\\n\".format(epochs))\nfor i in tqdm(range(epochs)):\n    start_training = time()\n    tm.fit(X_train, Y_train, epochs=1, incremental=True)\n    stop_training = time()\n\n    start_testing = time()\n    result = 100*(tm.predict(X_val) == Y_val).mean()\n    stop_testing = time()\n\n    #print(\"#%d Accuracy: %.2f%% Training: %.2fs Testing: %.2fs\" % (i+1, result, stop_training-start_training, stop_testing-start_testing))\n    acc_test.append(result) # Save accuracy of the validation set in array","6bce4dad":"plt.figure(figsize=(10, 5))\n\nplt.title(\"Accuracy on validation set\") \nplt.plot(acc_test, label='validation') \nplt.legend() \nplt.show()","94c9f713":"X_test = pd.read_csv('\/kaggle\/input\/digit-recognizer\/test.csv')\n\nX_test = np.where(X_test.to_numpy() > 75, 1, 0) \nY_test = tm.predict(X_test)","85d6c014":"d = {'ImageId': [i for i in range(1,28001)], 'Label': Y_test}\ndf = pd.DataFrame(data=d)","eaed8a47":"df.to_csv('submission.csv', index=False)","6252c434":"# The Convolutional Tsetlin Machine","53b20e2d":"Convolutional neural networks (CNNs) have obtained astounding successes for important pattern recognition tasks, but they suffer from high computational complexity and the lack of interpretability. The recent Tsetlin Machine (TM) attempts to address this lack by using easy-to-interpret conjunctive clauses in propositional logic to solve complex pattern recognition problems. The TM provides competitive accuracy in several benchmarks, while keeping the important property of interpretability. The Convolutional Tsetlin Machine (CTM), an interpretable alternative to CNNs, uses each clause as a convolution filter. Whereas the TM categorizes an image by employing each clause once to the whole image.","f122f5f6":"<a id=\"section-three\"><\/a>\n## 3. Unpickle function to load data","406883d5":"<a id=\"section-two\"><\/a>\n## 2. Install the pyTsetlinMachineParallel package","ab328fb2":"<a id=\"section-four\"><\/a>\n## 4. The Convolutional Tsetlin Machine","b7020e41":"* [Load data](#section-one)\n* [Install the pyTsetlinMachineParallel package](#section-two)\n* [Unpickle function to load data](#section-three)\n* [The Convolutional Tsetlin Machine](#section-four)\n* [Plot validation accuracy](#section-five)\n* [Evaluate on the test set](#section-six)\n* [Save and submit](#section-seven)","15a86ad9":"<a id=\"section-seven\"><\/a>\n## 7. Save and submit","19f8cea4":"<a id=\"section-five\"><\/a>\n## 5. Plot validation accuracy","00f97cff":"<a id=\"section-one\"><\/a>\n## 1. Load data","96ae2fa2":"<a id=\"section-six\"><\/a>\n## 6. Evaluate on the test set","ef4595ee":"Link to the original paper: https:\/\/arxiv.org\/pdf\/1905.09688v5.pdf","d26cc914":"Here I have applied The Convolutional Tsetlin Machine to the MNIST problem"}}