{"cell_type":{"d01446a6":"code","fddbacd1":"code","4817987f":"code","5af0d016":"code","4d74cdee":"code","d74bdd58":"code","50b78d5f":"code","7cc36008":"code","eab97024":"code","82889e62":"code","b708b9d6":"code","4524fa06":"code","c0a8d9cb":"code","58c6fb9a":"code","232efca6":"code","7f72e933":"code","47790d41":"code","61dc280f":"code","ee0fdb58":"code","698d7a28":"code","562347a9":"code","4c8e5411":"code","b09031b4":"code","993f03d8":"code","be18dbba":"code","d162b4b0":"code","1c9a3224":"code","7bc62f49":"code","0beefd41":"code","9bcc612c":"markdown","27dd3031":"markdown","9543fb3e":"markdown","19164f4c":"markdown","7424d7cd":"markdown","7aa92637":"markdown","9b4393cf":"markdown","9324fc56":"markdown","ae6214e7":"markdown","a8e854e9":"markdown","9e4df061":"markdown","c05c0f0c":"markdown","6347e1f8":"markdown","5b81fe19":"markdown"},"source":{"d01446a6":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nsns.set()","fddbacd1":"import os\nos.listdir('..\/input\/amazon-alexa-reviews')","4817987f":"data=pd.read_csv('..\/input\/amazon-alexa-reviews\/amazon_alexa.tsv',sep='\\t')\ndata.head()","5af0d016":"data.drop(columns=['date'],inplace=True)\ndata.head()","4d74cdee":"data.info()","d74bdd58":"data.describe()","50b78d5f":"sns.countplot(x='rating',data=data,hue='feedback')","7cc36008":"sns.distplot(data['rating'])","eab97024":"sns.countplot(x='feedback',data=data)","82889e62":"plt.figure(figsize=(24,12))\nsns.countplot(x='variation',hue='feedback',data=data)","b708b9d6":"from sklearn.feature_extraction.text import CountVectorizer as cv\nfrom sklearn.preprocessing import OneHotEncoder as ohe\nfrom sklearn.compose import ColumnTransformer as ct\nfrom sklearn.pipeline import make_pipeline as mp\nfrom sklearn.tree import DecisionTreeClassifier as dtc","4524fa06":"## Important: i have passed the columns a string to CV and list of columns to OHE\ntransformer=ct(transformers=[('review_counts',cv(),'verified_reviews'), \n                             ('variation_dummies', ohe(),['variation'])\n                            ],remainder='passthrough')","c0a8d9cb":"pipe= mp(transformer,dtc(random_state=42))\npipe","58c6fb9a":"from sklearn.model_selection import train_test_split as tts","232efca6":"data.head()","7f72e933":"x= data[['rating','variation','verified_reviews']].copy()\ny= data.feedback\nx.head()","47790d41":"x_train,x_test,y_train,y_test= tts(x,y,test_size=0.3,random_state=42,stratify=y)","61dc280f":"x_train.shape,y_train.shape","ee0fdb58":"pipe.fit(x_train,y_train)","698d7a28":"pred=pipe.predict(x_test)","562347a9":"from sklearn.metrics import accuracy_score,confusion_matrix","4c8e5411":"accuracy_score(y_test,pred)                 #Accuracy of 100%","b09031b4":"sns.heatmap(confusion_matrix(y_test,pred),annot=True,fmt='.0f')","993f03d8":"from sklearn.ensemble import RandomForestClassifier as rfc","be18dbba":"pipe= mp(transformer, rfc(n_estimators=150, random_state=42))","d162b4b0":"pipe.fit(x_train,y_train)","1c9a3224":"pred=pipe.predict(x_test)","7bc62f49":"accuracy_score(y_test,pred)  # 99% accuracy","0beefd41":"sns.heatmap(confusion_matrix(y_test,pred),annot=True,fmt='.0f')","9bcc612c":"# Using Decision Tree Classifier\n----------------------------------------\n\n[**Dataset**](https:\/\/www.kaggle.com\/sid321axn\/amazon-alexa-reviews) - Kaggle Amazon Alexa Reviews\n\n## 1. importing library","27dd3031":"## 2. Testing the model","9543fb3e":"## 6. Testing the model","19164f4c":"## 7. Evaluating the model\n","7424d7cd":"## Note\n--------------\n\nWe are able to achieve the accuracy of **100% in decision tree classifier** and **99% in random forest classifier**.\n\nRefer : [Notebook](https:\/\/www.kaggle.com\/chitralc1\/amazon-alexa-review-analysis\/notebook) [ColumnTransformer](https:\/\/towardsdatascience.com\/columntransformer-meets-natural-language-processing-da1f116dd69f)","7aa92637":"## 3. Visualizing data","9b4393cf":"## 1. Training the model\n","9324fc56":"## 4. Splitting the data for training and testing","ae6214e7":"**Note**\n\nAs we are achieveing the 100% Accuracy, Thus we are not tuning the hyperparameters.\n\n\n# 2. Using RandomForestClassifier\n----------------------------------------------","a8e854e9":"## 2. Analyzing Data","9e4df061":"**dataset** [link](https:\/\/www.kaggle.com\/sid321axn\/amazon-alexa-reviews)","c05c0f0c":"## 5. Training the model","6347e1f8":"## Transforming the object columns and making pipeline","5b81fe19":"**Note**\n---------------\nNow we need to pass the desired column to the ohe as list and strings to cv.\n[Reason](https:\/\/stackoverflow.com\/a\/61838828\/12210002)"}}