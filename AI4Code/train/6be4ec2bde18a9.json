{"cell_type":{"836ecd7d":"code","7240baf0":"code","6aacfc21":"code","ea2f4500":"code","20f0ebb9":"code","09f2503a":"code","8d7cd646":"code","c9a45bd8":"code","6cf68c47":"code","9d0d6cc2":"code","6a040bce":"code","ae054d20":"code","c56fe7aa":"code","b4280fb0":"code","6c4d5fb6":"code","612d82f3":"code","4a4c4dd2":"code","61f37c48":"markdown","72c736cb":"markdown"},"source":{"836ecd7d":"import numpy as np\nimport pandas as pd\nimport lightgbm as lgb\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.model_selection import train_test_split","7240baf0":"train_df = pd.read_csv('..\/input\/uec2021-exercise-5\/train.csv')\ntest_df = pd.read_csv('..\/input\/uec2021-exercise-5\/test.csv')\n\nprint(f'train shape : {train_df.shape}')\nprint(f'test shape : {test_df.shape}')\n\ntrain_df.head()","6aacfc21":"test_df.head()","ea2f4500":"train_test_df = pd.concat([train_df.drop([\"URL\", \"Average User Rating\", \"highly_rated\"], axis=1), test_df], axis=0).reset_index(drop=True)","20f0ebb9":"train_test_features_df = train_test_df.drop([\"ID\", \"Name\", \"Subtitle\", \"In-app Purchases\", \"Description\", \"Languages\", \"Genres\"], axis=1)","09f2503a":"train_test_features_df.head()","8d7cd646":"# encode\ncategorical_features = [\"Developer\", \"Age Rating\", \"Primary Genre\"]\nfor c in categorical_features:\n    le = LabelEncoder()\n    train_test_features_df[c] = le.fit_transform(train_test_features_df[c].values.astype(str))","c9a45bd8":"# date\ndef convert_time(date: str) -> int:\n    d, m, y = date.split('\/')\n    return int(y) * 10000 + int(m) * 100 + int(d)\n\n\ntrain_test_features_df[\"Original Release Date\"] = train_test_features_df[\"Original Release Date\"].apply(convert_time)\ntrain_test_features_df[\"Current Version Release Date\"] = train_test_features_df[\"Current Version Release Date\"].apply(convert_time)","6cf68c47":"train_test_features_df.head()","9d0d6cc2":"train_valid_x = train_test_features_df.iloc[:train_df.shape[0], :]\ntest_x = train_test_features_df.iloc[train_df.shape[0]:, :]\ntrain_valid_y = train_df[\"highly_rated\"]","6a040bce":"train_x, valid_x, train_y, valid_y = train_test_split(train_valid_x, train_valid_y, test_size=0.2, random_state=42)","ae054d20":"dtrain = lgb.Dataset(train_x, train_y)\ndvalid = lgb.Dataset(valid_x, valid_y)","c56fe7aa":"best_params = {\n    'objective': 'binary', \n    'metric': 'auc', \n    'seed': 42, \n    'num_leaves': 31\n}\nnum_boost_round = 1000\nearly_stopping_rounds = 200","b4280fb0":"model = lgb.train(\n    best_params, dtrain,\n    valid_sets=[dtrain, dvalid],\n    valid_names=['train', 'valid'],\n    num_boost_round=num_boost_round,\n    early_stopping_rounds=early_stopping_rounds, \n    verbose_eval=10,\n    categorical_feature = categorical_features\n)","6c4d5fb6":"test_pred = model.predict(test_x)","612d82f3":"sub_df = pd.DataFrame({\n    \"ID\": test_df[\"ID\"], \n    \"pred\": test_pred\n})\nsub_df.head()","4a4c4dd2":"# \u30d5\u30a1\u30a4\u30eb\u3078\u306e\u66f8\u304d\u51fa\u3057\nsub_df.to_csv(\"submission_lgb_simple_holdout.csv\", index=False)","61f37c48":"\u7279\u5fb4\u3092\u3055\u3089\u306b\u6368\u3066\u308b\uff08\u3053\u308c\u306f\u6539\u5584\u4f59\u5730\uff09\n- ID: \u7279\u5fb4\u306b\u306a\u3089\u306a\u3044\u3068\u601d\u3046\u306e\u3067\u6368\u3066\u308b\n- Name: \u8a00\u8a9e\u306a\u306e\u3067\u6368\u3066\u308b\n- Subtitle: \u8a00\u8a9e\u306a\u306e\u3067\u6368\u3066\u308b\n- In-app Purchases: \u5358\u7d14\u306a\u6570\u5024\u3067\u306f\u306a\u3044\u306e\u3067\u6368\u3066\u308b\n- Description: \u8a00\u8a9e\u306a\u306e\u3067\u6368\u3066\u308b\n- Languages: \u8907\u6570\u500b\u7a81\u3063\u8fbc\u307e\u308c\u3066\u3044\u3066\u9762\u5012\u306a\u306e\u3067\u6368\u3066\u308b\n- Genres: \u8907\u6570\u500b\u7a81\u3063\u8fbc\u307e\u308c\u3066\u3044\u3066\u9762\u5012\u306a\u306e\u3067\u6368\u3066\u308b","72c736cb":"Train\u306b\u3057\u304b\u306a\u3044column\u3092\u6368\u3066\u3066concat"}}