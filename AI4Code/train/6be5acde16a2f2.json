{"cell_type":{"86d75d63":"code","83b704c5":"code","2243d974":"code","0e8e7855":"code","8ce76436":"code","beaafcc1":"code","63d70e34":"code","6e31c99b":"markdown","f3c252c3":"markdown","90bfc9f0":"markdown","05077662":"markdown"},"source":{"86d75d63":"import pandas as pd\nfrom sklearn.linear_model import LinearRegression\nimport matplotlib.pyplot as plt\nimport numpy as np\n ","83b704c5":"train_df = pd.read_csv('..\/input\/train.csv')\ntrain_df.head()","2243d974":"test_df = pd.read_csv('..\/input\/test.csv')\ntest_df.head()","0e8e7855":"columns_in = [f\"sensor#{i}\" for i in range(12)]\ncolumns_out = \"oil_extraction\"\n\nX = train_df[columns_in].values\ntrain_y = train_df[columns_out].values\ntest_x = test_df[columns_in].values\n\ndef transform(x):\n    diffs = 25\n    diff = [np.zeros(x.shape) for i in range(diffs)]\n    n = len(x)\n    diff[0][1:,:] = x[:n-1,:]\n    for i in range(1, diffs):\n        diff[i][1:,:] = diff[i-1][:n-1,:]\n    return np.hstack([x, *diff])\n\ntrain_x = np.hstack([transform(X), transform(X**2)])","8ce76436":"lin_reg = LinearRegression()\nlin_reg.fit(train_x, train_y)\ntrain_predictions = lin_reg.predict(train_x)\n\nn = 500\nplt.plot(train_df[\"timestamp\"].values[:n], train_y[:n], label='oil extraction')\nplt.plot(train_df[\"timestamp\"].values[:n], train_predictions[:n], label='prediction')\nplt.legend(loc='upper right')\nplt.show()","beaafcc1":"def predictions_to_submission_file(predictions):\n    submission_df = pd.DataFrame(columns=['Expected', 'Id'])\n    submission_df['Expected'] = predictions\n    submission_df['Id'] = range(len(predictions))\n    submission_df.to_csv('submission.csv', index=False)\n\ntest_predictions = lin_reg.predict(np.hstack([transform(test_x), transform(test_x**2)]))\npredictions_to_submission_file(test_predictions)","63d70e34":"plt.plot(train_df[\"timestamp\"].values[:1000], train_y[:1000], label='oil extraction')\nplt.show()\nplt.plot(train_df[\"timestamp\"].values[:1000], train_df[\"sensor#0\"].values[:1000], label='oil extraction')\nplt.show()","6e31c99b":"### Write submission file","f3c252c3":"### Select columns with sensor data","90bfc9f0":"### Linear Regression model","05077662":"### Read data"}}