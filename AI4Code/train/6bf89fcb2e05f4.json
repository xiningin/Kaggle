{"cell_type":{"fea3ba9d":"code","48124042":"code","14f0d37b":"code","582e49ce":"code","b849242b":"code","6be8999b":"code","0b1a9aee":"markdown","34cf2e1a":"markdown","0c9775fd":"markdown"},"source":{"fea3ba9d":"import os\nimport numpy as np\nimport imageio\nimport matplotlib.pyplot as plt\nimport pandas as pd\n\nimport torch\n\nfrom torch.utils import data","48124042":"class TGSSaltDataset(data.Dataset):\n    \n    def __init__(self, root_path, file_list):\n        self.root_path = root_path\n        self.file_list = file_list\n    \n    def __len__(self):\n        return len(self.file_list)\n    \n    def __getitem__(self, index):\n        if index not in range(0, len(self.file_list)):\n            return self.__getitem__(np.random.randint(0, self.__len__()))\n        \n        file_id = self.file_list[index]\n        \n        image_folder = os.path.join(self.root_path, \"images\")\n        image_path = os.path.join(image_folder, file_id + \".png\")\n        \n        mask_folder = os.path.join(self.root_path, \"masks\")\n        mask_path = os.path.join(mask_folder, file_id + \".png\")\n        \n        image = np.array(imageio.imread(image_path), dtype=np.uint8)\n        mask = np.array(imageio.imread(mask_path), dtype=np.uint8)\n        \n        return image, mask","14f0d37b":"depths_df = pd.read_csv('..\/input\/train.csv')\n\ntrain_path = \"..\/input\/train\/\"\nfile_list = list(depths_df['id'].values)","582e49ce":"dataset = TGSSaltDataset(train_path, file_list)","b849242b":"def plot2x2Array(image, mask):\n    f, axarr = plt.subplots(1,2)\n    axarr[0].imshow(image)\n    axarr[1].imshow(mask)\n    axarr[0].grid()\n    axarr[1].grid()\n    axarr[0].set_title('Image')\n    axarr[1].set_title('Mask')","6be8999b":"for i in range(5):\n    image, mask = dataset[np.random.randint(0, len(dataset))]\n    plot2x2Array(image, mask)","0b1a9aee":"Let us visualize a few samples from the dataset.","34cf2e1a":"## PyTorch Dataset definition","0c9775fd":"# Simple Dataset using PyTorch"}}