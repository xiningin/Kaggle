{"cell_type":{"851877de":"code","59e087ed":"code","6f0bcc76":"code","83e97b96":"code","9bcaae11":"code","9a56398a":"code","70feb9f2":"code","822da5a0":"code","abf9e586":"code","c34b12b6":"code","b7cb5ccb":"markdown","a04191d9":"markdown","b24c2680":"markdown"},"source":{"851877de":"import cv2\n\nfrozen_model = '..\/input\/object-detection-using-opencv\/frozen_inference_graph.pb'\nconfig_file = '..\/input\/object-detection-using-opencv\/ssd_mobilenet_v3_large_coco_2020_01_14.pbtxt'\n\nmodel = cv2.dnn_DetectionModel(frozen_model, config_file)\n\nmodel.setInputSize(320, 320)\nmodel.setInputScale(1.0\/127.5) # 255 \/ 2 = 127.5\nmodel.setInputMean((127.5, 127.5, 127.5)) # mobilenet => [-1, 1]\nmodel.setInputSwapRB(True)","59e087ed":"classlabels = []\nfile_name = '..\/input\/object-detection-using-opencv\/labels.txt'\nwith open(file_name, 'rt') as fpt:\n    classlabels = fpt.read().rstrip('\\n').split('\\n')","6f0bcc76":"import matplotlib.pyplot as plt\n\nimg = cv2.imread('..\/input\/object-detection-using-opencv\/john-arano-LzxsSWAVMYs-unsplash.jpg')\nplt.imshow(cv2.cvtColor(img, cv2.COLOR_BGR2RGB))","83e97b96":"ClassIndex, confidence, bbox = model.detect(img, confThreshold=0.5)","9bcaae11":"print(confidence)","9a56398a":"print(bbox) # x, y, w, h","70feb9f2":"print(ClassIndex)","822da5a0":"print(classlabels)","abf9e586":"font_scale = 3\nfont = cv2.FONT_HERSHEY_PLAIN\nfor ClassInd, conf, boxes in zip(ClassIndex.flatten(), confidence.flatten(), bbox):\n    cv2.rectangle(img, boxes, (255, 0, 0), 2)\n    cv2.putText(img, classlabels[ClassInd-1], (boxes[0]+10, boxes[1]+40), font, fontScale=font_scale, color=(0, 255, 0), thickness=3)","c34b12b6":"plt.imshow(cv2.cvtColor(img, cv2.COLOR_BGR2RGB))","b7cb5ccb":"# Model Load In","a04191d9":"# References\n\n* [Object Detection using OpenCV | Python | Tutorial for beginners 2020](https:\/\/www.youtube.com\/watch?v=RFqvTmEFtOE&t=1315s)","b24c2680":"# Toolkits\n\n* [python - AttributeError: 'dnn_DetectionModel'](https:\/\/www.coder.work\/article\/7348142) <br> when dealing with: AttributeError module 'cv2' has no attribute 'dnn_DetectionModel' <br> download: [opencv-contrib-python 4.5.1.48](https:\/\/pypi.org\/project\/opencv-contrib-python\/)\n\n* [TensorFlow Object Detection API](https:\/\/github.com\/opencv\/opencv\/wiki\/TensorFlow-Object-Detection-API) <br>MobileNet-SSD v3 (see #16760)\t2020_01_14\tweights\tconfig\n\n* [How to unpack a tar file in Windows](https:\/\/wiki.haskell.org\/How_to_unpack_a_tar_file_in_Windows) <br>1. Add the directory you installed 7-Zip into to your path (Start -> Control Panel -> System -> Advanced -> Environment Variables). <br>2. Open a command prompt, and cd to the directory. <br>3. Type 7z x filename.tar at the command prompt (where filename.tar is the name of the tar file).\n\n* [List of labels to download](https:\/\/github.com\/pjreddie\/darknet\/blob\/master\/data\/coco.names)"}}