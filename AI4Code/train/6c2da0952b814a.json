{"cell_type":{"52016189":"code","9a077611":"code","0b2ad6bc":"code","da24c411":"code","0e445db1":"code","3587bb5c":"code","16715155":"code","e6dd7093":"code","fe6d159e":"code","ff83c85d":"code","12c93999":"code","9aef710d":"code","fa768960":"code","1040ad2e":"code","24b5e418":"code","ce2e7b45":"code","c5e67049":"code","8119dee3":"code","cbd5382a":"code","a05aa2c8":"code","051f2bae":"code","4f9a2923":"code","e3bce2df":"code","97ba371c":"code","eefa960c":"code","fe85dee5":"code","a51908be":"code","a142a59d":"code","ed11400c":"code","bb130eba":"markdown","44a052aa":"markdown","e2e1ea4a":"markdown","482f1e99":"markdown","216cd99d":"markdown","374b19fc":"markdown","a860fb5e":"markdown","e10814d0":"markdown","727f06eb":"markdown","13fad1a2":"markdown","a3c0ead4":"markdown","e18e16f7":"markdown","db802b03":"markdown","24bf458a":"markdown","c4c50298":"markdown","955c0b2b":"markdown","11028d3c":"markdown"},"source":{"52016189":"import pandas as pd","9a077611":"data=pd.read_csv(\"..\/input\/insurance\/insurance.csv\")\n","0b2ad6bc":"data.head()","da24c411":"data.tail()","0e445db1":"data.shape","3587bb5c":"print(\"Number of Rows\",data.shape[0])\nprint(\"Number of Columns\",data.shape[1])","16715155":"data.info()","e6dd7093":"data.isnull().sum()","fe6d159e":"data.describe(include='all')","ff83c85d":"data['sex'].unique()\ndata['sex']=data['sex'].map({'female':0,'male':1})\ndata['smoker']=data['smoker'].map({'yes':1,'no':0})\ndata['region']=data['region'].map({'southwest':1,'southeast':2,\n                   'northwest':3,'northeast':4})","12c93999":"data.head()","9aef710d":"X = data.drop(['charges'],axis=1)\ny = data['charges']","fa768960":"from sklearn.model_selection import train_test_split\nX_train,X_test,y_train,y_test=train_test_split(X,y,test_size=0.2,random_state=42)","1040ad2e":"from sklearn.linear_model import LinearRegression\nfrom sklearn.svm import SVR\nfrom sklearn.ensemble import RandomForestRegressor\nfrom sklearn.ensemble import GradientBoostingRegressor","24b5e418":"lr = LinearRegression()\nlr.fit(X_train,y_train)\nsvm = SVR()\nsvm.fit(X_train,y_train)\nrf = RandomForestRegressor()\nrf.fit(X_train,y_train)\ngr = GradientBoostingRegressor()\ngr.fit(X_train,y_train)","ce2e7b45":"y_pred1 = lr.predict(X_test)\ny_pred2 = svm.predict(X_test)\ny_pred3 = rf.predict(X_test)\ny_pred4 = gr.predict(X_test)\n\ndf1 = pd.DataFrame({'Actual':y_test,'Lr':y_pred1,\n                  'svm':y_pred2,'rf':y_pred3,'gr':y_pred4})","c5e67049":"df1","8119dee3":"import matplotlib.pyplot as plt","cbd5382a":"plt.subplot(221)\nplt.plot(df1['Actual'].iloc[0:11],label='Actual')\nplt.plot(df1['Lr'].iloc[0:11],label=\"Lr\")\nplt.legend()\n\nplt.subplot(222)\nplt.plot(df1['Actual'].iloc[0:11],label='Actual')\nplt.plot(df1['svm'].iloc[0:11],label=\"svr\")\nplt.legend()\n\nplt.subplot(223)\nplt.plot(df1['Actual'].iloc[0:11],label='Actual')\nplt.plot(df1['rf'].iloc[0:11],label=\"rf\")\nplt.legend()\n\nplt.subplot(224)\nplt.plot(df1['Actual'].iloc[0:11],label='Actual')\nplt.plot(df1['gr'].iloc[0:11],label=\"gr\")\n\nplt.tight_layout()\n\nplt.legend()","a05aa2c8":"from sklearn import metrics","051f2bae":"score1 = metrics.r2_score(y_test,y_pred1)\nscore2 = metrics.r2_score(y_test,y_pred2)\nscore3 = metrics.r2_score(y_test,y_pred3)\nscore4 = metrics.r2_score(y_test,y_pred4)","4f9a2923":"print(score1,score2,score3,score4)","e3bce2df":"s1 = metrics.mean_absolute_error(y_test,y_pred1)\ns2 = metrics.mean_absolute_error(y_test,y_pred2)\ns3 = metrics.mean_absolute_error(y_test,y_pred3)\ns4 = metrics.mean_absolute_error(y_test,y_pred4)","97ba371c":"print(s1,s2,s3,s4)","eefa960c":"data = {'age' : 40,\n        'sex' : 1,\n        'bmi' : 40.30,\n        'children' : 4,\n        'smoker' : 1,\n        'region' : 2}","fe85dee5":"df = pd.DataFrame(data,index=[0])\ndf","a51908be":"new_pred = gr.predict(df)\nprint(\"Medical Insurance cost for New Customer is : \",new_pred[0])","a142a59d":"gr = GradientBoostingRegressor()\ngr.fit(X,y)","ed11400c":"new_pred = gr.predict(df)\nprint(\"Medical Insurance cost for New Customer is : \",new_pred[0])","bb130eba":"### 6. Get Overall Statistics About The Dataset","44a052aa":"### 2. Check Last 5 Rows of The Dataset","e2e1ea4a":"### 15. Predict Charges For New Customer","482f1e99":"### 9. Train\/Test split\n#### 1. Split data into two part : a training set and a testing set\n#### 2. Train the model(s) on training set\n#### 3. Test the Model(s) on Testing set","216cd99d":"### 1. Display Top 5 Rows of The Dataset","374b19fc":"### 11. Model Training","a860fb5e":"### Predict Charges For New Customer","e10814d0":"### 10. Import the models","727f06eb":"### 3. Find Shape of Our Dataset (Number of Rows And Number of Columns)","13fad1a2":"### From above we found that gredianBoostingRegressor is the best model for this dataset. Before production, it is good practice to train our model on the entire dataset.","a3c0ead4":"### 12. Prediction on Test Data","e18e16f7":"### 13. Compare Performance Visually ","db802b03":"### 4. Get Information About Our Dataset Like Total Number Rows, Total Number of Columns, Datatypes of Each Column And Memory Requirement","24bf458a":"### 14. Evaluating the Algorithm","c4c50298":"### 8. Store Feature Matrix In X and Response(Target) In Vector y","955c0b2b":"### 5.Check Null Values In The Dataset","11028d3c":"### 7. Covert Columns From String ['sex' ,'smoker','region' ] To Numerical Values "}}