{"cell_type":{"9d63fcd6":"code","0ee40115":"code","6820e623":"code","1bc76dac":"code","125dec6b":"code","08d156c8":"markdown","b07ac048":"markdown","031077ab":"markdown","bd6ea8ab":"markdown","1abacdc1":"markdown"},"source":{"9d63fcd6":"import numpy as np\nimport pandas as pd","0ee40115":"N_DAYS = 100\nN_FAMILIES = 5000\nN_CHOICES = 10\n\ndata = pd.read_csv('\/kaggle\/input\/santa-workshop-tour-2019\/family_data.csv', index_col='family_id')","6820e623":"# 7 family sizes x 11 choice penalties\nsize_penalties = np.asarray([\n    [\n        0,\n        50,\n        50 + 9 * n,\n        100 + 9 * n,\n        200 + 9 * n,\n        200 + 18 * n,\n        300 + 18 * n,\n        300 + 36 * n,\n        400 + 36 * n,\n        500 + 36 * n + 199 * n,\n        500 + 36 * n + 398 * n\n    ] for n in data[\"n_people\"].sort_values().unique()\n])\nfamily_sizes = pd.get_dummies(data[\"n_people\"]).values\n# Matrix of 5000 x 11 choice penalties\nfamily_day_choice_penalty = np.matmul(family_sizes, size_penalties)","1bc76dac":"# Create a 5000 x 100 x 11 array for choices\nfamily_choices = np.zeros((N_FAMILIES, N_DAYS, N_CHOICES+1))\nchoices = data.drop(columns=\"n_people\")\nfor i in range(N_CHOICES):\n    choice_col = \"choice_\" + str(i)\n    dummies = pd.get_dummies(choices[choice_col], columns=[choice_col])\n    family_choices[:, :, i] = dummies.values\n# Now if not in any choices, then it is choice 10\nfamily_choices[:, :, N_CHOICES] = np.logical_not(family_choices.sum(axis=2))","125dec6b":"penalty = np.multiply(family_choices, family_day_choice_penalty.reshape((5000, 1, 11)))\npenalty.sum(axis=2)","08d156c8":"Last, do multiply these arrays and collapse to get a matrix again","b07ac048":"Hope that elucidates a different way to code! Thanks to https:\/\/www.kaggle.com\/vipito\/santa-ip for the initial code I was looking at.","031077ab":"Now, create an array A (note it's an array, not a matrix) that is 5000 x 100 x 11. The first index is the family. The second index is the day counting backwards from Christmas Eve, and the third index is the level of choice. For instance A[0, 0, 0] = 1 specifies that family 0, has the first choice on Christmas Eve. A[50, 10, 3] = 1 means that family 50 has their 4th choice (remember, starts at 0) on the eleventh day before Christmas.","bd6ea8ab":"First create an array that is 5000 x 11. Each row is a family, and each column represents the cost of choosing choice 0 (column 0), choice 1, etc.","1abacdc1":"**Numpy is Beautiful**\n\nAs I was exploring some of the kernels for this challenge, I realized how much time I spent understanding the way some of the cost matrices were coded. These cost matrices specified the penalty for a specific family (i) being assigned to a certain day (j). As I was reading through the code of lookups, loops, etc. I thought there has to be a cleaner, faster way.\n\nAnd numpy came to my rescue. Hopefully this gives people some ideas for how to improve their coding skills!"}}