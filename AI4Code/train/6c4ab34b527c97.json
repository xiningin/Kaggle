{"cell_type":{"47e44733":"code","1ab7fab9":"code","788e0970":"code","e086bc18":"code","add11966":"code","eaaec526":"code","e2389f1c":"code","7380ec7b":"code","3268ee43":"code","e892f3de":"code","3df92cd3":"code","83fca8cd":"code","1e9222f9":"code","dea216d4":"code","ae681159":"code","ca6094e0":"code","7ed9b62a":"code","933390e3":"code","28f4a9a2":"code","31706d99":"code","18dbc1c4":"code","74630688":"markdown","697a1a7c":"markdown","60dcc3ca":"markdown","4fd5f152":"markdown","989ca4aa":"markdown","185acf8b":"markdown","049a6527":"markdown","d9ec8348":"markdown"},"source":{"47e44733":"import pandas as pd","1ab7fab9":"train = pd.read_csv(\"..\/input\/train.csv\")\ntest = pd.read_csv(\"..\/input\/test.csv\")","788e0970":"Y = train['label']\nX = train.drop(labels=[\"label\"], axis=1)","e086bc18":"X = X \/ 255.0\ntest = test \/ 255.0","add11966":"from sklearn.model_selection import train_test_split\nrandom_seed=0\nX_train, X_val, Y_train, Y_val = train_test_split(X, Y, test_size=0.1, random_state=random_seed)","eaaec526":"import matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\nimport numpy as np\nimport tensorflow as tf\nfrom tensorflow import keras\nfrom keras import layers\nfrom keras import models","e2389f1c":"plt.figure()\nXshow = X_train.values.reshape(-1,28,28,1)\nplt.imshow(Xshow[0][:,:,0])\nplt.colorbar()\nplt.grid(False)","7380ec7b":"model = models.Sequential()\nmodel.add(layers.SeparableConv2D(32,(3,3), activation=\"elu\", input_shape=(28,28,1)))\nmodel.add(layers.MaxPooling2D((2,2)))\nmodel.add(layers.SeparableConv2D(64,(3,3), activation=\"elu\"))\nmodel.add(layers.MaxPooling2D((2,2)))\nmodel.add(layers.SeparableConv2D(64,(3,3), activation=\"elu\"))","3268ee43":"model.summary()","e892f3de":"model.add(layers.Flatten())\nmodel.add(layers.Dropout(0.5))\nmodel.add(layers.Dense(64, activation=\"elu\"))\nmodel.add(layers.Dense(10, activation=\"softmax\"))","3df92cd3":"model.summary()","83fca8cd":"model.compile(optimizer='adam', \n              loss='categorical_crossentropy',\n              metrics=['accuracy'])","1e9222f9":"X_val = X_val.values.reshape(-1,28,28,1)\nX_train = X_train.values.reshape(-1,28,28,1)\ntest = test.values.reshape(-1,28,28,1)\nX = X.values.reshape(-1,28,28,1)","dea216d4":"from keras.utils.np_utils import to_categorical\nY_train = to_categorical(Y_train, num_classes = 10)\nY = to_categorical(Y, num_classes = 10)","ae681159":"model.fit(X, Y, epochs=20)","ca6094e0":"Y_val = to_categorical(Y_val, num_classes = 10)","7ed9b62a":"test_loss, test_acc = model.evaluate(X_val, Y_val)\nprint(\"Test Accuracy: {}\".format(test_acc))","933390e3":"predictions = model.predict(test)\npredictions = np.argmax(predictions, axis=1)","28f4a9a2":"submission = pd.read_csv('..\/input\/sample_submission.csv')\nsubmission[\"Label\"] = predictions","31706d99":"submission.head()","18dbc1c4":"submission.to_csv('.\/simpleMNIST.csv', index=False)","74630688":"### Compile the model","697a1a7c":"# Introduction of CNN ","60dcc3ca":"### Convnet + Classifier","4fd5f152":"## Preprocess the data","989ca4aa":"## Load Dataset","185acf8b":"### Simple Convnet","049a6527":"### Train the model","d9ec8348":"## Build the model"}}