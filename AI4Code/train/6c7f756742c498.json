{"cell_type":{"79288fd6":"code","e2d3007e":"code","2a6c6e9c":"code","b76329a6":"code","d3b00407":"code","f2968662":"code","929bd81f":"code","dbe43540":"code","d8c01e5a":"code","16b8604f":"code","a539b74d":"code","17302065":"code","78640297":"code","19ec1988":"code","901fe455":"code","8829cca8":"code","dc13e8aa":"code","4a7d86cb":"code","d7ddf106":"code","738af140":"code","71a6fc9d":"code","3c9b3fe9":"code","566ac0e8":"code","398f83b4":"code","8c673cd4":"code","867a2f7d":"code","c344fcee":"markdown","5c55576a":"markdown","cba16d5e":"markdown","a1a82999":"markdown","d6f0804e":"markdown","5370bb8b":"markdown","950093ff":"markdown","156b0780":"markdown","33df8fee":"markdown"},"source":{"79288fd6":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","e2d3007e":"train = pd.read_csv(\"\/kaggle\/input\/song-popularity-prediction\/train.csv\")\ntrain.head()","2a6c6e9c":"train.info()","b76329a6":"column_null = []\nfor i in train.isnull():\n    if(train[i].isnull().sum() != 0):\n        column_null.append(i)\ncolumn_null","d3b00407":"mean_song_duration_ms = train['song_duration_ms'].mean()\nmedian_song_duration_ms = train['song_duration_ms'].median()\n\ntrain['song_duration_ms_median'] = train['song_duration_ms'].fillna(median_song_duration_ms)\ntrain['song_duration_ms_mean'] = train['song_duration_ms'].fillna(mean_song_duration_ms)","f2968662":"train.head()","929bd81f":"import matplotlib.pyplot as plt","dbe43540":"print('Original song_duration_ms variable variance: ', train['song_duration_ms'].var())\nprint('song_duration_ms Variance after median imputation: ', train['song_duration_ms_median'].var())\nprint('song_duration_ms Variance after mean imputation: ', train['song_duration_ms_mean'].var())","d8c01e5a":"fig = plt.figure()\nax = fig.add_subplot(111)\n\n# original variable distribution\ntrain['song_duration_ms'].plot(kind='kde', ax=ax)\n\n# variable imputed with the median\ntrain['song_duration_ms_median'].plot(kind='kde', ax=ax, color='red')\n\n# variable imputed with the mean\ntrain['song_duration_ms_mean'].plot(kind='kde', ax=ax, color='green')\n\n# add legends\nlines, labels = ax.get_legend_handles_labels()\nax.legend(lines, labels, loc='best')","16b8604f":"train.cov()","a539b74d":"train.corr()","17302065":"train[['song_duration_ms', 'song_duration_ms_median', 'song_duration_ms_mean']].boxplot()","78640297":"train = pd.read_csv(\"\/kaggle\/input\/song-popularity-prediction\/train.csv\")\ntrain.head()","19ec1988":"X = train.drop(columns=['song_popularity'])\ny = train['song_popularity']","901fe455":"from sklearn.model_selection import train_test_split\nX_train,X_test,y_train,y_test = train_test_split(X,y,test_size=0.2,random_state=2)","8829cca8":"from sklearn.compose import ColumnTransformer\nfrom sklearn.impute import SimpleImputer\n\nimputer1 = SimpleImputer(strategy='median')\nimputer2 = SimpleImputer(strategy='mean')\n\ntrf = ColumnTransformer([\n    ('imputer1',imputer1,['song_duration_ms']),\n    ('imputer2',imputer2,['acousticness'])\n],remainder='passthrough')","dc13e8aa":"X_train.head()","4a7d86cb":"X_test.head()","d7ddf106":"trf.fit(X_train)","738af140":"# median value of song_duration_ms\ntrf.named_transformers_['imputer1'].statistics_","71a6fc9d":"# mean value of acousticness\ntrf.named_transformers_['imputer2'].statistics_","3c9b3fe9":"X_train.shape","566ac0e8":"X_test.shape","398f83b4":"train = trf.transform(X_train)\ntest = trf.transform(X_test)","8c673cd4":"train[2]","867a2f7d":"X_train.head(3)","c344fcee":"## Using `ColumnTransformer` we can use apply different inputer strategy to different features\/columns.","5c55576a":"#### We will calculate mean, median (fit) on training and data and apply transformation on both train and test","cba16d5e":"### **IMP** :- MEAN \/  MEDIAN IMPUTATION SHOULD NOT BE USED WHEN MORE THAN 5% DATA IS MISSING AND WHEN THE DISTRIBUTION IS SKEW. ","a1a82999":"ColumnTransformer method gives us array and its useful as it can be used with pipeline.","d6f0804e":"**This can lead to:-**\n1)  Change is Probability Distribution Function(PDF)\n\n2)  Increase outliers\n\n3)  Change Correlation and Covariance\n","5370bb8b":"# **Sklearn Method**","950093ff":"**OBSERVATION-** PDF changing","156b0780":"**OBSERVATION-** Correlation changing","33df8fee":"**OBSERVATION-** Covariance changing"}}