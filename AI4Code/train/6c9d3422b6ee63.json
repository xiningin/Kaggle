{"cell_type":{"014d4718":"code","43db2294":"code","8cdaf52f":"code","53b04728":"code","85b09153":"code","06bb0e33":"code","ca5a538e":"code","827fccec":"code","0c5e6dc4":"code","827c4970":"code","be9c4ed8":"code","85dc8a12":"markdown"},"source":{"014d4718":"# Add The Library\nimport pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\n%matplotlib inline","43db2294":"dataset = pd.read_csv(\"..\/input\/petrol-consumption\/petrol_consumption.csv\")\ndataset.head()","8cdaf52f":"dataset.columns","53b04728":"dataset.describe()","85b09153":"# Preparing the Data\nX = dataset.iloc[:,:-1].values\ny = dataset.iloc[:,-1].values ","06bb0e33":"# Now Data Split function \n\nfrom sklearn.model_selection import train_test_split\nX_train,X_test,y_train,y_test= train_test_split(X,y, test_size=0.3, random_state=1)","ca5a538e":"from sklearn.ensemble import RandomForestRegressor\nregr = RandomForestRegressor(max_depth=2, random_state=0)\nregr.fit(X_train,y_train)","827fccec":"#Making Pridiction\ny_pred = regr.predict(X_test)","0c5e6dc4":"df = pd.DataFrame({'Actual': y_test, 'Predicted': y_pred})\ndf","827c4970":"# Evaluating the algo\nfrom sklearn import metrics\nprint('Mean Absolute Error:', metrics.mean_absolute_error(y_test, y_pred))\nprint('Mean Squared Error:', metrics.mean_squared_error(y_test, y_pred))\nprint('Root Mean Squared Error:', np.sqrt(metrics.mean_squared_error(y_test, y_pred)))","be9c4ed8":"import seaborn as sns\nplt.figure(figsize=(7, 9))\n\n\nax = sns.distplot(y, hist=False, color=\"r\", label=\"Actual Value\")\nsns.distplot(y_pred, hist=False, color=\"b\", label=\"Fitted Values\" , ax=ax)\n\n\nplt.title('Actual vs Fitted Values for Price')\nplt.legend(loc=\"upper left\")\n\nplt.show()\nplt.close()","85dc8a12":"1. Use petrol_consumption dataset. Your task is to predict the gas consumption (in millions of \ngallons) in 48 of the US states based on petrol tax (in cents), per capita income (dollars), paved \nhighways (in miles) and the proportion of population with the driving license. Build the regression \nmodel using Random Forest Regressor. Analyze the prediction ability of your model."}}