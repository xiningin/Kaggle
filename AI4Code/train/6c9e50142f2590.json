{"cell_type":{"c352a630":"code","2fae2f79":"code","f3d27530":"code","ffd8d2a2":"code","33306ddf":"markdown","5326a0e0":"markdown","9c7307f6":"markdown","00ace03c":"markdown"},"source":{"c352a630":"from IPython.display import clear_output\n!pip install mljar-supervised --user\nclear_output()","2fae2f79":"import pandas as pd\nfrom supervised import AutoML","f3d27530":"class MLJarClassification:\n    def __init__(self,trainPath,testPath,submissionPath,target):\n        print(\"[MLJarClassification] __init__ start\")\n        \n        self.trainPath = trainPath\n        self.testPath = testPath\n        self.submissionPath = submissionPath\n        self.target = target \n        \n        self.train = pd.read_csv(self.trainPath)\n        self.test = pd.read_csv(self.testPath)   \n        self.predictions = None\n         \n        print(\"[MLJarClassification] __init__ end\")\n        \n    def predict(self):\n        print(\"[MLJarClassification] predict start\")\n        \n        y = self.train[self.target]\n        X = self.train.drop([self.target], axis=1)\n       \n        automl = AutoML()\n        automl.fit(X, y)\n        \n        self.predictions = automl.predict(self.test)\n        print(\"[MLJarClassification] predict end\")\n        \n    def submission(self):\n        print(\"[MLJarClassification] submission start\")\n        \n        submission = pd.read_csv(self.submissionPath)\n        submission[self.target] = self.predictions\n        submission.to_csv(\"submission.csv\",index=False)\n        print(submission.head())\n        \n        print(\"[MLJarClassification] submission end \")","ffd8d2a2":"trainPath = \"..\/input\/titanic\/train.csv\"\ntestPath = \"..\/input\/titanic\/test.csv\"\nsubmissionPath = \"..\/input\/titanic\/gender_submission.csv\"\ntarget = \"Survived\"\n\nmodel = MLJarClassification(trainPath,testPath,submissionPath,target)\nmodel.predict()\nmodel.submission()","33306ddf":"# import libraries","5326a0e0":"# MLJAR Classification Class ","9c7307f6":"# predict and submission using MLJarClassification class","00ace03c":"# install mljar-supervised"}}