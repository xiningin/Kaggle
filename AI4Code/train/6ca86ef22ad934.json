{"cell_type":{"0b36f6d1":"code","536ef5b4":"code","c6781589":"code","f9485079":"code","7098345e":"code","8b140a44":"code","983c78df":"code","4f663c44":"code","4af99cc4":"code","4ac42b6d":"code","8cb6fddb":"code","8400ef41":"code","aa009738":"code","31aea2d9":"code","438dc00f":"code","67caf97c":"code","03e5af9c":"code","fca7b5aa":"code","b9069ccd":"code","aa3abf1a":"code","576d15c2":"code","5614610b":"code","c8260a07":"code","cdef2d04":"code","a93323ae":"code","75af872c":"code","a34d9614":"code","988ce327":"code","f7c32ab2":"code","ec130df3":"code","ee8d4064":"code","23140b48":"code","4500323f":"code","0501009e":"code","e418bb8d":"markdown","73e037b4":"markdown","1269c71c":"markdown"},"source":{"0b36f6d1":"import pandas as pd\n","536ef5b4":"df=pd.read_csv('..\/input\/heart-failure-clinical-data\/heart_failure_clinical_records_dataset.csv')\ndf.head(10)","c6781589":"df.shape\n\n","f9485079":"df.describe()","7098345e":"df['DEATH_EVENT'].value_counts()","8b140a44":"#checking for missing values\ndf.isnull().sum()","983c78df":"import matplotlib.pyplot as plt\nimport seaborn as sns\n","4f663c44":"#checking correlation\ndf.corr()","4af99cc4":"#heatmap for corr\nsns.heatmap(df.corr(),cmap=\"YlGnBu\")","4ac42b6d":"#handling Outliers using percentile method\n\ndf.columns\nmini=df['creatinine_phosphokinase'].quantile(0.02)\ndf[df['creatinine_phosphokinase']<mini]\nmaxi=df['creatinine_phosphokinase'].quantile(.978)\ndf[df['creatinine_phosphokinase']>maxi]\n\ndf2=df[(df['creatinine_phosphokinase']>=mini) & (df['creatinine_phosphokinase']<maxi)]\ndf2.sample(10)","8cb6fddb":"df2.describe()","8400ef41":"#handling outliers using Z score or standard ditribution\nsns.distplot(df2['platelets'])","aa009738":"mean=df2['platelets'].mean()\nsd=df2['platelets'].std()\ndf2['zscore']=(df2.platelets-mean)\/sd\ndf2.shape\ndf2 =df2[(df2['zscore']<3) & (df2['zscore']>-3)]\nsns.distplot(df2['platelets'])\ndf2.shape\n","31aea2d9":"plt.hist(df['serum_sodium'])","438dc00f":"sns.boxplot(y='serum_sodium',data=df2)","67caf97c":"plt.boxplot(df['serum_sodium'])","03e5af9c":"Q1=df2['serum_sodium'].quantile(0.25)\nQ3=df2['serum_sodium'].quantile(0.75)\niqr=Q3-Q1\nlowerlimit=Q1-1.5*iqr\nupperlimit=Q3+1.5*iqr\n","fca7b5aa":"df2=df2[(df2['serum_sodium']>lowerlimit) & (df2['serum_sodium']<upperlimit)]\ndf2\n","b9069ccd":"X=df.iloc[:,:12]\ny=df['DEATH_EVENT']","aa3abf1a":"from sklearn.ensemble import ExtraTreesClassifier\nmodel=ExtraTreesClassifier()\nmodel.fit(X,y)","576d15c2":"imp=pd.Series(data=model.feature_importances_,index=X.columns)\nimp.nlargest(5).plot(kind ='bar')","5614610b":"sns.jointplot('time','ejection_fraction',data=df2,kind ='reg')\nsns.pairplot(df2,hue='DEATH_EVENT')","c8260a07":"from sklearn.model_selection import train_test_split\nX_train, X_test, y_train, y_test= train_test_split(X,y,random_state=0)\ny_train","cdef2d04":"from sklearn.ensemble import RandomForestClassifier\nfrom sklearn.model_selection import RandomizedSearchCV\nimport numpy as np\n#Randomized search CV\n\n\nn_estimators=[int(i) for i in np.linspace(100,1200,12)]\nmax_features=['auto','sqrt','log2']\nmax_depth=[int(i) for i in np.linspace(5,30,6)]\nmin_samples_leaf=[1,2,5,10]","a93323ae":"#create random_grid\nrandom_grid={'n_estimators':n_estimators,\n            'max_features':max_features,\n            'max_depth':max_depth,\n            'min_samples_leaf':min_samples_leaf}\nrandom_grid","75af872c":"rf=RandomForestClassifier()\nrandom=RandomizedSearchCV(estimator=rf,param_distributions=random_grid,n_iter=10,cv=5,verbose=2,scoring='roc_auc',random_state=42,return_train_score=True,n_jobs=1)\nrandom.fit(X_train,y_train)\n","a34d9614":"random.best_params_","988ce327":"random.best_score_","f7c32ab2":"random.score(X_test,y_test)","ec130df3":"plt.figure()\nplt.plot(df2[df2['DEATH_EVENT']==1]['time'],df2[df2['DEATH_EVENT']==1]['platelets'],'ro',label='yes')\nplt.plot(df2[df2['DEATH_EVENT']==0]['time'],df2[df2['DEATH_EVENT']==0]['platelets'],'bo',label='no')\nplt.legend()","ee8d4064":"y_pred=random.predict(X_test)\ny_pred","23140b48":"sns.distplot(y_pred-y_test,bins=5)\n\n#we get a very narrow normal distribution whuch shows are model is performimg very well","4500323f":"plt.scatter(y_pred,y_test)","0501009e":"import pickle\n\nwith open('random_forest_classifier.pkl','wb') as file:\n    pickle.dump(random,file) #dumps the model as pickle file","e418bb8d":"# IQR method to remove outliers","73e037b4":"## handling Outliers using percentile method","1269c71c":"# handling outliers using Z score or standard ditribution"}}