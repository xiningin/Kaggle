{"cell_type":{"13a93f39":"code","40f537ce":"code","155cd9db":"code","8b5bf300":"code","d95699f4":"code","4f76d191":"code","ac0ba4ab":"code","fb856259":"code","ad42dd6c":"code","4a90d18e":"code","d32a043a":"code","a4479ecb":"code","145f1bbf":"code","f59104c3":"code","5b1085d5":"code","2e60371c":"markdown"},"source":{"13a93f39":"import pandas as pd\nimport numpy as np\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.preprocessing import LabelEncoder\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.model_selection import train_test_split, KFold\nfrom sklearn.feature_selection import  RFECV","40f537ce":"X_train = pd.read_csv(\"..\/input\/kaistbme587\/X_train.csv\")\nX_test = pd.read_csv(\"..\/input\/kaistbme587\/X_test.csv\")","155cd9db":"X_test.head()","8b5bf300":"X_train = X_train.fillna(-1)\nX_test = X_test.fillna(-1)","d95699f4":"for col in (X_train.columns):\n    if X_train[col].dtype == 'object':\n        enc = LabelEncoder()\n        enc.fit(list(X_train[col].values) + list(X_test[col].values))\n        X_train[col] = enc.transform(list(X_train[col].values))\n        X_test[col] = enc.transform(list(X_test[col].values)) \n","4f76d191":"X = X_train.iloc[:,1:]\ny = X_train.iloc[:,0]","ac0ba4ab":"\nX_train, X_val, y_train, y_val = train_test_split(X, y, test_size=0.2, random_state=42)","fb856259":"model = RandomForestClassifier()\nclf = model.fit(X_train, y_train)","ad42dd6c":"rfe = RFECV(estimator=clf, step=4,min_features_to_select = 70,cv=KFold(n_splits=2, shuffle=False), scoring='roc_auc', verbose=2)","4a90d18e":"rfe.fit(X, y)","d32a043a":"X = X.iloc[:,rfe.ranking_ == 1]\nX_test = X_test.iloc[:,1:]\nX_test = X_test.iloc[:,rfe.ranking_ == 1]","a4479ecb":"\nX_train, X_val, y_train, y_val = train_test_split(X, y, test_size=0.2, random_state=42)","145f1bbf":"model = RandomForestClassifier()\nmodel.fit(X_train, y_train)","f59104c3":"y_pred=model.predict_proba(X_test)[:,1]","5b1085d5":"sub = pd.read_csv(\"..\/input\/kaistbme587\/sample_submission.csv\")\nsub['Fraud'] = y_pred\nsub.to_csv('baseline5.csv', index=False)\n\n","2e60371c":"Feature Selection \ubc29\ubc95 :\n\n\uc6b0\uc120 \uc774 \ucf54\ub4dc\uc5d0\uc11c\ub294 \uc544\uc8fc \ud3b8\ud558\uac8c Feature Selection\uc744 \ud558\ub294 \ubc29\ubc95\uc744 \uc18c\uac1c\ud55c\ub2e4.\n\nRFECV(Recursive feature elimination with cross-validation) \uc774\ub77c\uace0 \ubd88\ub9ac\ub294 \uc774 \ubc29\ubc95\ub860\uc740, \ucc98\uc74c\uc5d0 N\uac1c\uc758 feature\ub97c \uac00\uc9c0\uace0 \ud559\uc2b5\uc744 \uc9c4\ud589\ud55c\ub4a4\nfeature importance\ub97c \ubcf4\uace0 \ud544\uc694\uc5c6\ub294 x\uac1c\uc758 feature\ub97c \uc9c0\uc6b0\uace0 \ud559\uc2b5 ->\uc744 \ubc18\ubcf5\ud574\uc11c \uac00\uc7a5 \ucd5c\uc801\uc758 feature \uac2f\uc218\ub97c \ucc3e\ub294 \uc54c\uace0\ub9ac\uc998\uc774\ub77c\uace0 \uc0dd\uac01\ud558\uba74\ub41c\ub2e4.\n\"cross-validation\" \uc774 \ubd99\uae30 \ub54c\ubb38\uc5d0 fold \ubc29\ubc95\ub860\uc744 \uc801\uc6a9\ud574\uc11c \ub370\uc774\ud130\ub97c fold\ub85c \ucabc\uac20 \ub4a4, fold\ub9c8\ub2e4 model \uacb0\uacfc\uc758 \ud3c9\uade0\uc73c\ub85c \ucd5c\uc801\uc758 feature \uac2f\uc218\ub97c \uc815\ud574\uc8fc\ub294 \uc54c\uace0\ub9ac\uc998\uc774\ub2e4.\n\n\uc774\ub807\uac8c \ud3b8\ud558\uac8c feature\ub97c selection \ud558\ub294 \ubc29\ubc95\ub3c4 \uc788\uc9c0\ub9cc,\n\n\uacbd\ud5d8\uc0c1 \ud3b8\ud558\uac8c selection \ud558\uc9c0 \uc54a\uace0, \uc790\uc2e0\uc758 \ubaa8\ub378\uc758 feature importance\ub97c \ucd94\ucd9c\ud55c\ub4a4, \ud544\uc694\uc5c6\ub294 feature ( importance\uac00 \uc801\uc740 \uc560\ub4e4)\uc744 \uc0ac\uc6a9\uc790\uac00 \ube7c\uc8fc\ub294 \uac83\ub3c4 \uacbd\ud5d8\uc0c1 \uacb0\uacfc\uac00 \ub354 \uc88b\uc544\uc9c0\ub294 \uacbd\uc6b0\uac00 \ub9ce\ub2e4.\n\n\uc774\ubc88 Sample code \ubaa8\uc74c\uc5d0\ub294 \ub2e4\ub8e8\uc9c0 \uc54a\uc9c0\ub9cc,\n\nFeature\ub97c Selection\ud558\ub294 \uac83\ub3c4 \uc911\uc694\ud558\uc9c0\ub9cc, \uc774\ub294 \ub370\uc774\ud130\ub97c \ube7c\ub294 \ud589\uc704\uc774\uae30 \ub54c\ubb38\uc5d0 \uc548\uc88b\uc744 \ud655\ub960\ub3c4 \ud070 \ubc29\ubc95\uc774\ub2e4.\n\n\ub0b4\uac00 \ucd94\ucc9c\ud558\ub294 \ubc29\ubc95\uc740 Selection \ud558\uae30\uc804\uc5d0 feature\ub97c \ub9cc\ub4e4\uc5b4\uc8fc\ub294 \uac83\uc774\ub2e4.\n\n\uae30\ubcf8\uc801\uc73c\ub85c boosting \ubc29\ubc95\ub860\uc744 \uc218\ud559\uc801\uc778 \uac78 \ubc30\uc81c\ud558\uace0 \uc598\uae30\ud558\uba74, feature\ub4e4\uc744 \uc120 \ud558\ub098\ub85c \uac00\ub97c \uc218 \uc788\uc744 \uc218\ub85d! \uc88b\uc740 \uc54c\uace0\ub9ac\uc998\uc774\ub77c\uace0 \uc0dd\uac01\ud558\uba74 \uc544\uc8fc\ud3b8\ud558\ub2e4..\n\n\ub530\ub77c\uc11c \uac19\uc740\ud2b9\uc9d5\uc744 \uac00\uc9c4\uc560\ub4e4\ub07c\ub9ac \ubb49\uccd0\uc8fc\ub294\uac83\uc774 \uc911\uc694\ud558\ub2e4..\n\n\uc774\ub7ec\ud55c \uacfc\uc815\uc744 Feature engineering\uc774\ub77c\uace0 \ud558\uba70 \uc815\ub9d0 \ub9ce\uc740 \ubc29\ubc95\uc774\uc788\ub2e4.\n\n\uadf8\uc911\uc5d0\uc11c Scaling\uc740 \ub2e4\ub978 sample code\uc5d0\uc11c \uc0b4\uc9dd\ub2e4\ub8ec\ub2e4.\n\n\uc774\uc678\uc5d0\ub3c4 feature\ub4e4\uc744 \ud569\ud574\ubcf4\uace0 \uacf1\ud574\ubcf4\uace0.. \ube7c\ubcf4\uace0.. \ub2e4\uc591\ud55c \uc218\uce58\ud615 feature\uc758 max, min.. \ub2e4\uc591\ud55c\uac78 \uc804\ucc98\ub9ac\ud574\ubcf4\ub294\uac83\uc744 \ubb34\uc870\uac74 \ucd94\ucc9c\ud55c\ub2e4. \n\n\uc6b0\uc120 RFECV \ucf54\ub4dc\ub97c \ubcf4\uace0 \uac00\uaca0\ub2e4.\nFeature Selection\uc740 \uc624\ucc28\uac00 \ud06c\uc9c0\ub9cc, \uae30\uc874\uc758 Starter code\uc5d0 \ube44\ud574 \uc57d\uac04\uc758 \uc0c1\uc2b9 (auc 0.1~ 0.3) \uc815\ub3c4\ub97c \uc218\ubc18\ud55c\ub2e4.\n\ud559\uc2b5\uc744 \uc5c4\uccad \ub9ce\uc774\ud574\ubd10\uc57c\ud574\uc11c, \uc2dc\uac04\uc774 \uc5c4\uccad \uac78\ub9b0\ub2e4..(\uc774\ub798\uc11c \uadf8\ub0e5 feature \ubcf4\uace0 \uc120\ud0dd\ud558\ub294\uac70\uac19\ub2e4..)\n\n\n"}}