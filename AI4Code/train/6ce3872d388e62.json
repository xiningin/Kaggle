{"cell_type":{"7ef8b490":"code","2ee2fc81":"code","e43334b1":"code","a6212ac1":"code","1067af4b":"code","85ffe1f4":"code","62ffc87a":"code","a2f0e6a2":"code","02937ebb":"code","6d1d1360":"code","e7613ab9":"code","4a43ebf7":"code","eaaa94f5":"code","29ece165":"code","78bc5804":"code","9a78c4b8":"code","0a2fa637":"code","8a81eb3d":"code","e38484e8":"code","eac41f80":"code","25afc6c4":"code","ef5783c7":"code","443beef9":"code","ff1e2ccf":"code","70888039":"code","41918d09":"code","ecc14ae5":"code","3396a51d":"code","8cf7796e":"code","7ec4ca0d":"code","0a684632":"code","b5cc9413":"code","da4689a6":"code","13bf037a":"code","9d65f054":"code","16179152":"code","6a7528a9":"code","6ca17fd8":"code","2a8396e3":"code","d4e137ea":"code","de5aa5c8":"code","c37f60fa":"code","e631b4a4":"code","da517cb1":"code","40482ec1":"code","7169c1d3":"code","3e4f84ea":"code","4099ae7d":"markdown","91611300":"markdown","6558e904":"markdown","eca57644":"markdown"},"source":{"7ef8b490":"# !kaggle competitions download -c virtual-hack","2ee2fc81":"# !unzip -q car_data.zip","e43334b1":"%reload_ext autoreload\n%autoreload 2\n%matplotlib inline","a6212ac1":"from fastai.vision import *\nfrom fastai.metrics import error_rate\ntorch.manual_seed(42)\ntorch.cuda.manual_seed_all(42)","1067af4b":"bs = 64\n# !ls 'car_data\/train'","85ffe1f4":"path = Path('..\/input\/car_data\/car_data')","62ffc87a":"path.ls()","a2f0e6a2":"data = ImageDataBunch.from_folder(path, train=\"train\", valid_pct=0.3,\n        ds_tfms=get_transforms(), size=224, num_workers=4).normalize(imagenet_stats)","02937ebb":"data.show_batch(rows=3, figsize=(8,7))","6d1d1360":"# print(data.classes)\nlen(data.classes),data.c","e7613ab9":"pwd","4a43ebf7":"learn = cnn_learner(data, models.resnet34, metrics=accuracy, model_dir='\/kaggle\/working', callback_fns=ShowGraph)","eaaa94f5":"learn.model","29ece165":"learn.fit_one_cycle(10)","78bc5804":"learn.save('stage-1')","9a78c4b8":"interp = ClassificationInterpretation.from_learner(learn)\n\nlosses,idxs = interp.top_losses()\n\nlen(data.valid_ds)==len(losses)==len(idxs)","0a2fa637":"interp.plot_top_losses(9, figsize=(15,11))","8a81eb3d":"interp.plot_confusion_matrix(figsize=(12,12), dpi=60)","e38484e8":"interp.most_confused(min_val=2)","eac41f80":"data = ImageDataBunch.from_folder(path, train=\"train\", ds_tfms=get_transforms(), \n                                  valid='test', size=224, bs = 64) .normalize(imagenet_stats)","25afc6c4":"learn.load('stage-1');\n# learn.unfreeze()","ef5783c7":"learn.lr_find()","443beef9":"learn.recorder.plot(suggestion=True)","ff1e2ccf":"learn.fit_one_cycle(10, max_lr=slice(1e-6,1e-3))","70888039":"learn.save('stage-2')","41918d09":"learn.load('stage-2');","ecc14ae5":"learn.unfreeze()","3396a51d":"data = ImageDataBunch.from_folder(path, train=\"train\", ds_tfms=get_transforms(flip_vert=True, max_lighting=0.1, max_zoom=1.05, max_warp=0.), \n                                  valid='test', size=224, bs = 64) .normalize(imagenet_stats)","8cf7796e":"get_transforms(flip_vert=True, max_lighting=0.1, max_zoom=1.05, max_warp=0.)","7ec4ca0d":"learn.lr_find()","0a684632":"# learn.recorder.plot(suggestion=True)","b5cc9413":"learn.fit_one_cycle(5, max_lr=1e-4)","da4689a6":"data = ImageDataBunch.from_folder(path, train=\"train\", ds_tfms=get_transforms(), \n                                  valid='test', size=229, bs = 64) .normalize(imagenet_stats)\n","13bf037a":"learn = cnn_learner(data, models.resnet50, metrics=accuracy, model_dir='\/kaggle\/working', callback_fns=ShowGraph)","9d65f054":"learn.lr_find()\nlearn.recorder.plot(suggestion=True)","16179152":"learn.fit_one_cycle(10, max_lr=1e-2)","6a7528a9":"learn.save('stage-1-50')","6ca17fd8":"learn.unfreeze()","2a8396e3":"learn.lr_find()\nlearn.recorder.plot(suggestion=True)","d4e137ea":"torch.manual_seed(42)\ntorch.cuda.manual_seed_all(42)\nlearn.fit_one_cycle(10, max_lr=slice(1e-5,1e-4))","de5aa5c8":"learn.load('stage-1-50');\n\ninterp = ClassificationInterpretation.from_learner(learn)","c37f60fa":"interp.most_confused(min_val=2)","e631b4a4":"# interp.plot_confusion_matrix(figsize=(12,12),cmap='viridis', dpi=60)","da517cb1":"data = ImageDataBunch.from_folder(path, train=\"train\", ds_tfms=get_transforms(), \n                                  valid='test', size=224, bs = 64) .normalize(imagenet_stats)\n","40482ec1":"learn = cnn_learner(data, models.densenet169, metrics=accuracy, model_dir='\/kaggle\/working', callback_fns=ShowGraph)","7169c1d3":"learn.lr_find()\nlearn.recorder.plot(suggestion=True)","3e4f84ea":"learn.fit_one_cycle(20, max_lr=1e-2)","4099ae7d":"## Densenet 161","91611300":"## Unfreeze Resnet 34","6558e904":"## Resnet34 , Validation on Test Folder (Provided)","eca57644":"## Training: resnet50 with Test folder as validation"}}