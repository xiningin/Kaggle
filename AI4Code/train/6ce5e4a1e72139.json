{"cell_type":{"a277ce1f":"code","8ccf2f79":"code","bfb21042":"code","63574a99":"code","3d26ed5d":"code","b9815290":"code","2fcd46f0":"code","9d809b40":"code","85c58e2b":"code","6ee9732c":"code","a3c708c7":"code","a31a12a4":"code","82869d24":"code","f5b696ea":"markdown","e6781e9c":"markdown","2f640ff1":"markdown","f304d53c":"markdown","e80701b9":"markdown","8f8bfd8f":"markdown","4a973566":"markdown"},"source":{"a277ce1f":"from os import path\nfrom glob import glob\n\nimport pandas as pd\nimport numpy as np\nimport cv2\n\nfrom tqdm.notebook import tqdm\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.model_selection import cross_val_score","8ccf2f79":"ROOT_DIR_TRAIN = '\/kaggle\/input\/evohackaton\/train\/train'","bfb21042":"def extract_flatten_image_from_image_name(img_name, root=None):\n    if root is not None:\n        im_path = path.join(root, img_name)\n    else:\n        im_path = img_name\n    im = cv2.imread(im_path, 0)\n    im = cv2.resize(im, (32,32))\n    return im.flatten()","63574a99":"train_df = pd.read_csv('\/kaggle\/input\/evohackaton\/train.csv')\ntrain_images = list(map(lambda x: extract_flatten_image_from_image_name(x, ROOT_DIR_TRAIN), train_df['name']))","3d26ed5d":"train_images = np.stack(train_images).astype(float)\ntrain_labels = np.array(train_df['category'])","b9815290":"model = LogisticRegression()","2fcd46f0":"val_results = cross_val_score(X=train_images, y=train_labels, estimator=model, cv=5)","9d809b40":"full_image_pathes = glob('\/kaggle\/input\/evohackaton\/test\/test\/*.jpg')\ntest_image_names = list(map(path.basename, full_image_pathes))\n\ntest_images = list(map(extract_flatten_image_from_image_name, full_image_pathes))","85c58e2b":"test_images = np.stack(test_images).astype(float)","6ee9732c":"model.fit(train_images, train_labels)","a3c708c7":"y_test_hat = model.predict(test_images)","a31a12a4":"submission_df = pd.DataFrame({\n    'name':test_image_names,\n    'category':y_test_hat\n})","82869d24":"submission_df.to_csv('submission.csv',index=False)","f5b696ea":"# Create submission DF","e6781e9c":"# Read Test Data","2f640ff1":"# Model","f304d53c":"# Validation","e80701b9":"# Imports","8f8bfd8f":"# Read Train Data","4a973566":"# Fit Predict"}}