{"cell_type":{"50399d2f":"code","b6ca01b7":"code","2732dbcb":"code","45d854fd":"code","af0d2970":"code","a87c7a2e":"code","c00614b3":"code","919825cb":"code","00c21d64":"code","01eb63e1":"code","bc9e7207":"code","dd03d0d9":"code","0a10b1b9":"code","c5b2ad8a":"markdown","3e21bbb1":"markdown","63dd29d2":"markdown","bfce5e6a":"markdown","a1ea26f7":"markdown","28dc3d3a":"markdown","f4b410f7":"markdown","fd56c33f":"markdown"},"source":{"50399d2f":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n%matplotlib inline","b6ca01b7":"df=pd.read_csv('..\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv')","2732dbcb":"df.info()","45d854fd":"df.head()","af0d2970":"sns.set_theme(style=\"whitegrid\")\nsns.countplot(data=df, x='Gender');","a87c7a2e":"sns.displot(data=df, x='Spending Score (1-100)', bins=10, height=10, linewidth=5, color='purple');","c00614b3":"sns.displot(data=df, x='Age', bins=10, height=10, linewidth=5, hue='Gender');","919825cb":"sns.displot(data=df, x='Annual Income (k$)', bins=10, height=10, linewidth=5, hue='Gender');","00c21d64":"X= pd.get_dummies(df.drop('CustomerID', axis=1))","01eb63e1":"from sklearn.preprocessing import StandardScaler\n\nscaler= StandardScaler()\nscaled_X= scaler.fit_transform(X)","bc9e7207":"from sklearn.cluster import KMeans","dd03d0d9":"ssd= []\n\nfor k in range (2, 10):\n    model=KMeans(n_clusters=k)\n    \n    model.fit(scaled_X)\n    \n    ssd.append(model.inertia_)","0a10b1b9":"plt.plot(range(2,10), ssd, 'o--')\nplt.xlabel('K Value')\nplt.ylabel('Sum of Squared Distances')","c5b2ad8a":"#### in these charts you can see the histogram of the __Spending Score__, __Age__ and __ Annual Income__.\naverage of Spending Score is about 55.\naverage of age is 30. minimum age is 20 and maximum age is about 70.\naverage of Annual Income is 65000 dollar. minimum Annual Income is 20000 and maximum is about 130000.","3e21bbb1":"# Data Overview:","63dd29d2":"# Exploratory Data Analysis:","bfce5e6a":"#### as you can see in above chart, best k is 4.","a1ea26f7":"# Creating and Fitting a KMeans Model:\nto finding the best k for our model, we use elbow method.","28dc3d3a":"# Scaling the Featues:","f4b410f7":"# K-Means Clustering:\n#### What is k-means used for?\n>The K-means clustering algorithm is used to find groups which have not been explicitly labeled in the data. This can be used to confirm business assumptions about what types of groups exist or to identify unknown groups in complex data sets.\n#### How do you calculate K mean?\n* Step 1: Choose the number of clusters k.\n* Step 2: Select k random points from the data as centroids.\n* Step 3: Assign all the points to the closest cluster centroid.\n* Step 4: Recompute the centroids of newly formed clusters.\n* Step 5: Repeat steps 3 and 4 until there are no more cluster reassignments.\n\n#### What is the k-means problem?\n>k-means has trouble clustering data where clusters are of varying sizes and density. To cluster such data, you need to generalize k-means as described in the Advantages section. Clustering outliers. Centroids can be dragged by outliers, or outliers might get their own cluster instead of being ignored.","fd56c33f":"# Data Preparing:\n#### at first we should remove the object columns. "}}