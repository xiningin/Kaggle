{"cell_type":{"9bb9c997":"code","89e494e0":"code","a78ed891":"code","7d31d863":"code","0f76b75d":"code","c1421d0f":"code","955641c4":"code","31cb9513":"code","59dd862c":"code","84220303":"code","675a316e":"code","f79af9c7":"code","4c7c9f59":"code","a1ad6c98":"code","768d7533":"code","5133f25c":"code","c9917bbb":"code","0d09dd77":"code","5929a2fd":"code","790a787c":"code","3db0f13e":"markdown","6e5079cd":"markdown","7834b12e":"markdown","dc353066":"markdown"},"source":{"9bb9c997":"!pip install tensorflow==2.0-rc1","89e494e0":"import tensorflow as tf\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport seaborn as sns","a78ed891":"train_data_raw = pd.read_csv(\"..\/input\/digit-recognizer\/train.csv\")\ntest_data_raw = pd.read_csv(\"..\/input\/digit-recognizer\/test.csv\")\ntrain_data_raw.describe(), test_data_raw.describe()","7d31d863":"train_labels = train_data_raw.pop(\"label\")","0f76b75d":"train_data_raw.shape, test_data_raw.shape","c1421d0f":"train_data_norm = train_data_raw.to_numpy()\/255.0\ntest_data_norm = test_data_raw.to_numpy()\/255.0","955641c4":"x_train = train_data_norm.reshape(len(train_data_norm), 28, 28, 1)\ny_train = train_labels.to_numpy()\nx_test = test_data_norm.reshape(len(test_data_norm), 28, 28, 1)","31cb9513":"x_train.shape, x_test.shape","59dd862c":"model = tf.keras.models.Sequential()\nmodel.add(tf.keras.layers.Conv2D(32, (3,3),  activation='relu', input_shape=(28, 28, 1)))\nmodel.add(tf.keras.layers.MaxPooling2D((2,2)))\nmodel.add(tf.keras.layers.Conv2D(64, (3,3),  activation='relu'))\nmodel.add(tf.keras.layers.MaxPooling2D((2,2)))\nmodel.add(tf.keras.layers.Conv2D(64, (3,3),  activation='relu'))","84220303":"model.summary()","675a316e":"model.add(tf.keras.layers.Flatten())\nmodel.add(tf.keras.layers.Dense(64, 'relu'))\nmodel.add(tf.keras.layers.Dense(10, 'softmax'))","f79af9c7":"model.summary()","4c7c9f59":"model.compile(optimizer='adam', loss='sparse_categorical_crossentropy', metrics=['accuracy'])","a1ad6c98":"history = model.fit(x_train, y_train, epochs=5, batch_size=32)","768d7533":"plt.plot(history.history['accuracy'], label='accuracy')\n# plt.plot(history.history['val_accuracy'], label = 'val_accuracy')\nplt.xlabel('Epoch')\nplt.ylabel('Accuracy')\nplt.ylim([0.5, 1])\nplt.legend(loc='lower right')","5133f25c":"pred = model.predict(x_test)","c9917bbb":"y_test = np.argmax(pred, axis=1)","0d09dd77":"result_df = pd.DataFrame(y_test, columns=['label'], index=range(1,len(y_test)+1)).rename_axis('ImageId')","5929a2fd":"result_df.head()","790a787c":"result_df.to_csv(\"submission.csv\")","3db0f13e":"\n## Compile and Train Model","6e5079cd":"## Adding Dense Layers on Top","7834b12e":"## Creating Convolution Base","dc353066":"# Model"}}