{"cell_type":{"a8af5727":"code","7959dd69":"code","e519d5ef":"code","85d39911":"code","cefbc674":"code","e518aafd":"code","fec4f5e6":"code","d391c926":"code","5d003ee9":"code","f0a1cec7":"code","df1786dc":"code","02455cab":"code","d11da9f5":"code","2939318e":"code","73d68b6c":"code","d0b264c4":"code","6fe9af2c":"code","95563214":"code","3ea350c4":"code","9690333c":"code","4269d380":"code","491cf335":"code","756c6b88":"code","b3d1ae24":"code","160360ce":"code","ad28501e":"code","7a4a2773":"code","06484289":"code","96152064":"code","5e502687":"code","3531b626":"code","34697d3d":"code","91ea6a8e":"code","7b188c54":"code","a135f9f7":"code","bb9ebb24":"code","198ee1b0":"code","a9dd65b7":"code","59d458fc":"code","01a29a9c":"code","899ed7cd":"code","6c7c1043":"code","f60ce296":"code","35a7a35b":"code","50ac9af9":"code","eeb9345d":"code","70e5fcd1":"code","084f95dd":"code","fbce1b23":"code","67aa0e53":"code","d6c60655":"code","dad4f518":"code","072f3f66":"code","7f556432":"code","4fda0ded":"code","affbedad":"code","ef261662":"code","84d78018":"code","e046a88d":"code","afb4f5b7":"code","7ac06917":"code","122eaa60":"code","659f0401":"code","8448a645":"code","786e1c18":"code","6be978a5":"code","65fdf81a":"code","e59281c8":"code","1d263dd0":"code","01a8db1a":"code","e7e874a1":"code","fa4355a5":"code","02b0ccb3":"code","f1a75dc6":"code","4e75bf76":"code","26daedab":"code","d4637a98":"code","1c3ac3b9":"code","d0a117ec":"code","499b25f2":"code","c45b2a2a":"code","f6a0a674":"code","f535b115":"code","ef22d5d6":"code","57237c07":"code","3a65fd80":"code","f7bb4c19":"code","4bf42f9a":"code","31b10734":"code","ba5c318a":"code","6a4458ef":"code","fde4d853":"code","023b056d":"code","b89b4b4a":"code","01b214ea":"code","4751f4fd":"code","3b22993a":"code","7eb101f1":"code","00a0c142":"markdown","149c775d":"markdown","3c5b8ac0":"markdown","64d88754":"markdown","9d4586c5":"markdown","cdbc2979":"markdown","b9fb43ea":"markdown","9fac7a9a":"markdown","d9014c58":"markdown","4be0181a":"markdown","aa69688c":"markdown","1a10b3d4":"markdown","8222df96":"markdown","296ed06a":"markdown","ebdcc6b4":"markdown","f8aa91dd":"markdown","95a17663":"markdown","a68f51de":"markdown","5fb69800":"markdown","1055a6da":"markdown","0f435b1c":"markdown","19d6b83b":"markdown","4cdf4b1d":"markdown","066a6135":"markdown","7a1ecc9f":"markdown","95f9db29":"markdown","379db872":"markdown","63b9e7f9":"markdown","6a35554c":"markdown","1bf4b52a":"markdown","41ab205e":"markdown","84445e6b":"markdown","f3a3516d":"markdown","609aa5ac":"markdown","1ff16dc4":"markdown","1487065d":"markdown","f0102a06":"markdown","0bb57c0c":"markdown","e633c3c5":"markdown","70251139":"markdown","31d62f17":"markdown","2f21e2fd":"markdown","6089421d":"markdown","9179932f":"markdown","c5d16eb9":"markdown","bd3ab8ea":"markdown","7fd989b5":"markdown","71b94e70":"markdown","6d04da1b":"markdown","c4e15787":"markdown","be221327":"markdown","c2b9a411":"markdown","0f96af95":"markdown","3a06f4a3":"markdown","6b0ba7af":"markdown","107fbe2a":"markdown","aa089903":"markdown","f96cd621":"markdown","4797381b":"markdown","7f054d64":"markdown","c41d6f7f":"markdown","30de9e3b":"markdown","2f159e75":"markdown","8daf80ec":"markdown","557321cf":"markdown","f37db158":"markdown","bf1ee7ea":"markdown","8b63e42c":"markdown","fac74a4d":"markdown","18cb8ffd":"markdown","3a647779":"markdown","c6c22e8b":"markdown","83423a2e":"markdown","ec88797d":"markdown","8cb2b091":"markdown","cf59d1e2":"markdown","670c4816":"markdown","92c78325":"markdown","cd8556bd":"markdown","3db16532":"markdown"},"source":{"a8af5727":"import pandas as pd\nimport matplotlib.pyplot as plt\nimport numpy as np\nfrom sklearn.model_selection import KFold\nfrom sklearn.model_selection import cross_val_score\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.tree import DecisionTreeClassifier\nfrom sklearn.ensemble import RandomForestClassifier, VotingClassifier\nfrom sklearn.neighbors import KNeighborsClassifier\nfrom sklearn.ensemble import BaggingClassifier\nimport warnings\nwarnings.filterwarnings(\"ignore\")\n\n\n%matplotlib inline\ndf=pd.read_csv(\"..\/input\/av-janatahack-machine-learning-in-agriculture\/train_yaOffsB.csv\")","7959dd69":"df.head()","e519d5ef":"df.tail(10)","85d39911":"df.shape","cefbc674":"df.columns","e518aafd":"df.dtypes","fec4f5e6":"df.describe()","d391c926":"df.describe(include = 'all')","5d003ee9":"df.isnull().sum()","f0a1cec7":"temp = pd.DataFrame(index = df.columns)\ntemp['data_type']=df.dtypes\ntemp['null_count']=df.isnull().sum()\ntemp['unique_count']=df.nunique()\ntemp","df1786dc":"table = pd.pivot_table(data=df,index='Pesticide_Use_Category',values='Number_Weeks_Used',aggfunc=np.sum)\ntable","02455cab":"table1 = pd.pivot_table(data=df,index='Soil_Type',values='Number_Weeks_Used',aggfunc=np.sum)\ntable1","d11da9f5":"cross1 = pd.crosstab(df['Soil_Type'],df['Crop_Type'])\ncross1\n","2939318e":"cross2 = pd.crosstab(df['Soil_Type'],df['Pesticide_Use_Category'])\ncross2","73d68b6c":"maxi = df['Number_Weeks_Used'].mode()\nmaxi","d0b264c4":"\nfor i in range(0,len(df)):\n    if pd.isnull(df['Number_Weeks_Used'][i])==True:\n        if (df['Pesticide_Use_Category'][i] == 1):\n            df['Number_Weeks_Used'][i] = 0.0\n        else:\n            df['Number_Weeks_Used'][i] = 20.0","6fe9af2c":"df['Number_Weeks_Used'].isnull().sum()","95563214":"df[['Number_Weeks_Used','Pesticide_Use_Category']].head(10)","3ea350c4":"df[['Number_Weeks_Used','Pesticide_Use_Category']].tail(10)","9690333c":"df=df.astype({'Number_Weeks_Used':'int64'})","4269d380":"df.dtypes","491cf335":"df['Crop_Type'].value_counts().plot.bar()","756c6b88":"df['Soil_Type'].value_counts().plot.bar()","b3d1ae24":"df['Season'].value_counts().plot.bar()","160360ce":"\ndf['Estimated_Insects_Count'].plot.box()","ad28501e":"df['Number_Doses_Week'].plot.box()","7a4a2773":"df['Number_Weeks_Used'].plot.box()","06484289":"df['Number_Weeks_Quit'].plot.box()","96152064":"df.loc[df['Estimated_Insects_Count']>3500,'Estimated_Insects_Count']=np.mean(df['Estimated_Insects_Count'])\ndf['Estimated_Insects_Count'].plot.box()","5e502687":"df.loc[df['Number_Doses_Week']>69,'Number_Doses_Week']=np.mean(df['Number_Doses_Week'])\ndf['Number_Doses_Week'].plot.box()","3531b626":"df.loc[df['Number_Weeks_Used']>60,'Number_Weeks_Used']=np.mean(df['Number_Weeks_Used'])\ndf['Number_Weeks_Used'].plot.box()","34697d3d":"df.loc[df['Number_Weeks_Quit']>40,'Number_Weeks_Quit']=np.mean(df['Number_Weeks_Quit'])\ndf['Number_Weeks_Quit'].plot.box()","91ea6a8e":"df.dtypes","7b188c54":"df=df.astype({'Estimated_Insects_Count':'int64','Number_Doses_Week':'int64','Number_Weeks_Used':'int64','Number_Weeks_Quit':'int64'})","a135f9f7":"df.dtypes","bb9ebb24":"df.plot.scatter('Number_Weeks_Used','Number_Doses_Week')","198ee1b0":"fig, ax=plt.subplots()\ncolours={0:'green',1:'yellow',2:'purple'}\nax.scatter(df['Number_Weeks_Used'],df['Number_Doses_Week'],c=df['Crop_Damage'].apply(lambda x : colours[x]))\nplt.xlabel('Number_Weeks_Used')\nplt.ylabel('Number_Doses_Week')\n\nplt.show()","a9dd65b7":"cp=[df['Number_Weeks_Used'].corr(df['Number_Doses_Week'])]\ncp","59d458fc":"grp=df.groupby('Pesticide_Use_Category')['Estimated_Insects_Count'].mean().plot.bar()\n","01a29a9c":"df.pivot_table('Estimated_Insects_Count', ['Crop_Type', 'Soil_Type'], 'Season')","899ed7cd":"df.pivot_table('Number_Weeks_Used', ['Crop_Type', 'Soil_Type'], 'Season')","6c7c1043":"df['count']=1\n","f60ce296":"df.pivot_table('count', ['Season','Soil_Type','Crop_Type'], ['Pesticide_Use_Category'],aggfunc='sum')","35a7a35b":"df.pivot_table('count', ['Season','Soil_Type','Crop_Type'], ['Pesticide_Use_Category','Crop_Damage'],aggfunc='sum')","50ac9af9":"df.groupby('Crop_Damage')['Estimated_Insects_Count'].mean().plot.bar()","eeb9345d":"df.groupby('Crop_Damage')['Number_Doses_Week'].mean().plot.bar()","70e5fcd1":"df.groupby('Crop_Damage')['Number_Weeks_Used'].mean().plot.bar()","084f95dd":"df.groupby('Crop_Damage')['Number_Weeks_Quit'].mean().plot.bar()","fbce1b23":"df['Total_Doses']=df['Number_Doses_Week']*df['Number_Weeks_Used']\ndf[['Total_Doses','Number_Weeks_Used','Number_Doses_Week']].tail()","67aa0e53":"df['Total_Days']=df['Number_Weeks_Quit']+df['Number_Weeks_Used']\ndf[['Total_Days','Number_Weeks_Used','Number_Weeks_Quit']].tail()","d6c60655":"df.groupby('Crop_Damage')['Total_Doses'].mean().plot.bar()","dad4f518":"df.groupby('Crop_Damage')['Total_Days'].mean().plot.bar()","072f3f66":"pd.crosstab(df['Crop_Damage'],df['Season'])","7f556432":"pd.crosstab(df['Crop_Damage'],df['Crop_Type'])","4fda0ded":"pd.crosstab(df['Crop_Damage'],df['Soil_Type'])","affbedad":"pd.crosstab(df['Crop_Damage'],df['Pesticide_Use_Category'])","ef261662":"feature_table = df[[\"Estimated_Insects_Count\",\"Crop_Type\",\"Soil_Type\",\"Pesticide_Use_Category\",\"Number_Doses_Week\",\"Number_Weeks_Used\",\"Number_Weeks_Quit\",\"Season\"]]","84d78018":"from sklearn import preprocessing\nft = preprocessing.StandardScaler().fit(feature_table)","e046a88d":"feature_table = ft.transform(feature_table)\ntarget_values = df[\"Crop_Damage\"].values","afb4f5b7":"from sklearn.model_selection import cross_val_score\nfrom sklearn.linear_model import LogisticRegression\nlr = LogisticRegression()\nkfold = KFold(n_splits=30, random_state=7,shuffle=True)\nscores=cross_val_score(lr, feature_table, target_values, scoring='accuracy', cv=kfold)\nscores","7ac06917":"scores.mean(),scores.std()","122eaa60":"from sklearn.neighbors import KNeighborsClassifier as KNN\nknn=KNN(n_neighbors=3)\nscores1=cross_val_score(knn, feature_table, target_values, scoring='accuracy', cv=kfold)\nscores1","659f0401":"scores1.mean(),scores1.std()","8448a645":"from sklearn.tree import DecisionTreeClassifier\ndt=DecisionTreeClassifier('entropy',random_state=7)\nscores2=cross_val_score(dt, feature_table, target_values, scoring='accuracy', cv=kfold)\nscores2","786e1c18":"scores2.mean(),scores2.std()","6be978a5":"from sklearn.ensemble import RandomForestClassifier\nrf=RandomForestClassifier()\nscores3=cross_val_score(rf, feature_table, target_values, scoring='accuracy', cv=kfold)\nscores3","65fdf81a":"scores3.mean(),scores3.std()","e59281c8":"test=pd.read_csv(\"..\/input\/av-janatahack-machine-learning-in-agriculture\/test_pFkWwen.csv\")","1d263dd0":"test.head()","01a8db1a":"test.isnull().sum()","e7e874a1":"for i in range(0,len(test)):\n    if pd.isnull(test['Number_Weeks_Used'][i])==True:\n        if (test['Pesticide_Use_Category'][i] == 1):\n            test['Number_Weeks_Used'][i] = 0.0\n        else:\n            test['Number_Weeks_Used'][i] = 20.0","fa4355a5":"test['Number_Weeks_Used'].isnull().sum()","02b0ccb3":"test.dtypes","f1a75dc6":"test['count']=1","4e75bf76":"test['Estimated_Insects_Count'].plot.box()","26daedab":"test['Number_Doses_Week'].plot.box()","d4637a98":"test['Number_Weeks_Used'].plot.box()","1c3ac3b9":"test['Number_Weeks_Quit'].plot.box()","d0a117ec":"test.loc[test['Estimated_Insects_Count']>3500,'Estimated_Insects_Count']=np.median(test['Estimated_Insects_Count'])\ntest['Estimated_Insects_Count'].plot.box()","499b25f2":"test.loc[test['Number_Doses_Week']>69,'Number_Doses_Week']=np.mean(test['Number_Doses_Week'])\ntest['Number_Doses_Week'].plot.box()","c45b2a2a":"test.loc[test['Number_Weeks_Used']>60,'Number_Weeks_Used']=np.mean(test['Number_Weeks_Used'])\ntest['Number_Weeks_Used'].plot.box()","f6a0a674":"test.loc[test['Number_Weeks_Quit']>40,'Number_Weeks_Quit']=np.mean(test['Number_Weeks_Quit'])\ntest['Number_Weeks_Quit'].plot.box()","f535b115":"test=test.astype({'Estimated_Insects_Count':'int64','Number_Doses_Week':'int64','Number_Weeks_Used':'int64','Number_Weeks_Quit':'int64'})","ef22d5d6":"test.dtypes","57237c07":"test['Total_Doses']=test['Number_Doses_Week']*test['Number_Weeks_Used']\ntest[['Total_Doses','Number_Weeks_Used','Number_Doses_Week']].tail()","3a65fd80":"test['Total_Days']=test['Number_Weeks_Quit']+test['Number_Weeks_Used']\ntest[['Total_Days','Number_Weeks_Used','Number_Weeks_Quit']].tail()","f7bb4c19":"test_features=test[[\"Estimated_Insects_Count\",\"Crop_Type\",\"Soil_Type\",\"Pesticide_Use_Category\",\"Number_Doses_Week\",\"Number_Weeks_Used\",\"Number_Weeks_Quit\",\"Season\"]]","4bf42f9a":"test_features = ft.transform(test_features)","31b10734":"from sklearn.ensemble import VotingClassifier","ba5c318a":"vc = VotingClassifier(estimators=[('lr',lr),('knn',knn),('dt',dt),('rf',rf)],voting='hard')\nresult=cross_val_score(vc, feature_table, target_values, scoring='accuracy', cv=kfold)\nresult","6a4458ef":"result.mean(),result.std()","fde4d853":"vc=vc.fit(feature_table,target_values)","023b056d":"test_Crop_Damage = vc.predict(test_features)","b89b4b4a":"solution = pd.DataFrame(test_Crop_Damage)","01b214ea":"id = test['ID']\nsample_solution = pd.concat([id,solution],axis=1)\nsample_solution.columns = ['ID','Crop_Damage']\n","4751f4fd":"sample_solution.to_csv('sample_solution.csv')","3b22993a":"ss=pd.read_csv(\"sample_solution.csv\")","7eb101f1":"ss.head()","00a0c142":"The above bar plot shows a slight equilibrum in all 3 cases.","149c775d":"Total no. of rows and columns","3c5b8ac0":"Outliers are replaced by mean in all respective columns","64d88754":"Getting the last 10 rows","9d4586c5":"From the above, for Pesticide_Use_Category '0':- Number of weeks pesticide was used is zero.\nAnd for other Pesticide_Use_Category :- Number of weeks pesticide was used is considered as 20(maximum no.)\n Thus,the empty cells are filled in the column.","cdbc2979":"More cropes are cultivated in soil type '0'.","b9fb43ea":"# Treating the presence of Outliers","9fac7a9a":"Excessive use of pesticides damaged the crop a lot.","d9014c58":"Presence of outliers above 40 in Number_Weeks_Quit.","4be0181a":"The above two tables shows the total relation among all less uniqueno. columns like soiltype,croptype,season,pesticide used and cropdamage. The value inside it represents the total count of crop of those similar types.","aa69688c":"This is the way to implement kfold tenhnique on an estimator. It calculates the score for each cv split with the help of evaluation metrics.","1a10b3d4":"Getting the first 5 rows of the file","8222df96":"The below four crosstab shows the relation among crop damage,season,croptype,soiltype and pesticide used category. The values represent the count of crops.","296ed06a":"# Extraction of all kind of data from the .csv file","ebdcc6b4":"Cross validation is a technique to evaluate predictive models by dividing the original data into training set to train the model and test set to evaluate it.The test set is considered as validation set here.\nIn K-Fold cross validation, the original sample is divided randomly into k equal subsamples.From which one subsample is considered as validation set and rest k-1 are taken as training set. The sample step is repeated for all the subsamples.\nThe advantages of this are :- It prevents overfitting. Reduced bias. Variance is reduced. Less Computation time.","f8aa91dd":"# MODEL BUILDING","95a17663":"Adding another column with value 1 everywhere for a required table below.","a68f51de":"The below scatter plot takes shows crop_damage in colour.","5fb69800":"Relation between soiltype and crop type","1055a6da":"It is a surpervised ML algorithm.It uses the tree representation to solve the problems where leaf node corresponds to class label and internal node of tree corresponds to attributes.Its main objective is to have pure nodes. Gini imurity and information gain are the best methods to get best split points.","0f435b1c":"The above is the bar graph between Pesticide_Use_Category and Estimated_Insects_Count. The place where pesticides are not used have high count of insects than it is used.","19d6b83b":"Gini impurity = 1-Gini ; Information Gain = 1-Entropy","4cdf4b1d":"# Feature Engineering","066a6135":"The relation between soil,crop,season together and number of weeks pesticide used.","7a1ecc9f":"Index of all columns","95f9db29":"In all the algorithm for predicting different models,K-fold technique is used and for evaluating it accuracy is used.\nThe value of k in all cases ais 30 with random state of 7.","379db872":"Presence of outliers above 70 in Number_Doses_Week.","63b9e7f9":"In the following, the test dataset has been extracted and cleaned like train data set.","6a35554c":"It is an evaluation metric for classification problem. It is the ratio between correct prediction and total prediction.\nThe increase in K value of K-fold cross validation increases the sample accuracy.","1bf4b52a":"# Change of  required DataTypes","41ab205e":"Season 2 favours in more crop yield","84445e6b":"# Loading Packages","f3a3516d":"It is a supervised ML algorithm which creates desicion trees on data samples and predict from each of them. After that selects the best by votting. It reduces overfitting by averaging the result.","609aa5ac":"DESICION TREE","1ff16dc4":"All the columns except Crop Damage are stored under feature_table. And Crop Damage values are stored are in target_values.\nStandardScaler is used from preprocessing of sklearn. It changes the values such that the standard deviation distribution from the mean equals one.Most values lies b\/w -1 & 1.\n","1487065d":"RANDOM FOREST","f0102a06":"Pivot table for finding relation between soil type and number of weeks of its use.","0bb57c0c":"The test columns are stored in test_features and the values are transformed by StandardScaler.","e633c3c5":"Presence of outliers above 60 in Number_Weeks_Used.","70251139":"VOTING CLASSIFIER","31d62f17":"# Prediction","2f21e2fd":"Creating a table which contains unique count and null count","6089421d":"The relation between soil,crop,season together and estimated insect count.","9179932f":"# Univariate analysis","c5d16eb9":"# <span style=\"color:red\">**Please upvote this notebook if you find it useful!**<\/span>","bd3ab8ea":"The below table adds total doses column in the data on the basics of use of pesticides doses per week and number of weeks of its use.","7fd989b5":"The datatypes are changed after outlier treatment. So,change to required data type","71b94e70":"Here, there are 9000 missing values in Number_Weeks_Used column.\nWe need fill up those.","6d04da1b":"feature_table values has been been transformed and fitted by standardscaler. ","c4e15787":"It describes the columns by their count,mean,min,etc.(Only for continuous Variable)","be221327":"K FOLD CROSS VALIDATION","c2b9a411":"LOGISTIC REGRESSION","0f96af95":"Shows the count of missing values if present","3a06f4a3":"Presence of outliers above 3500 in Estimated_Insects_Count.","6b0ba7af":"Finding the maximum no. weeks used in crop yield","107fbe2a":"# Test Data Sample","aa089903":"# Bivariate Analysis","f96cd621":"The above scatter plot shows a linear relation between them.Correlation will tend to zero in this case","4797381b":"The predicted dataset is saved in .csv file","7f054d64":"It does the same but includes categorical variables","c41d6f7f":"Logistic Regression is a supervised algorithm.It is used in classification problems.It is a predictive analysis.The cost function of it is Log Loss.","30de9e3b":"The below table adds Total days column which is sum of no. of weeks of pesticide use and its quiting.","2f159e75":"It is a wrapper for set of different algorithms that are trained and valuated in parallel in order to exploit the different peculiarities of each algorithm. It chooses the best predicting model for the dataset.It yields better performance than any single algorithm.","8daf80ec":"The above bar plot shows that crops are mostly damaged due to over doses of pesticides and even due to some other reasons.","557321cf":"The quiting of the use of pesticides mostly prevented crop damage.","f37db158":"It is also known as Lazy Learning algorithm. Here,in this algorithm a new test instance is located in a training dataset plot.\nThen,the distance of new test instance is calculated from all train data points . After that it is K distance is taken from sorted list.And the prediction of that instance is made.\nFor classification problem, mode is considered. The value of K is determined by Elbow method. Here, k=3","bf1ee7ea":"# Missing Values","8b63e42c":"More Crops are damaged by insects.","fac74a4d":"It is clear from above that Number of weeks used for '0' Pesticide_use_category is zero.","18cb8ffd":"Confirming that our vales filled properly","3a647779":"More no. of crops are of Type '0'","c6c22e8b":"Predicting the test target values i.e. Crop_Damage in test dataset","83423a2e":"ACCURACY","ec88797d":"Relation between soil type and pesticide used category","8cb2b091":"KNN","cf59d1e2":"CROSS_VAL_SCORE","670c4816":"pivot table for finding relation between pesticide use category and number of weeks of its use.","92c78325":"Correlation is zero. Its says the strength by value & dirction by sign.","cd8556bd":"The below bar graphs represents the relation with target column and some other columns.","3db16532":"Datatypes of all columns"}}