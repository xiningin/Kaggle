{"cell_type":{"7362dcd0":"code","55ff7100":"code","a1254fef":"code","64b89014":"code","7640980a":"code","449db82d":"code","dbdb34bd":"code","756e4743":"code","730792cd":"code","2ae2c906":"code","c0f56c8a":"code","4e703077":"code","7f50d12f":"code","f59119ba":"code","707b3b7c":"code","06893236":"code","36ed60f7":"code","8134a0a2":"code","869d4da1":"code","948fc246":"code","8f1c9622":"code","e76152f2":"code","ae657b1c":"code","187c881f":"markdown","452f00ce":"markdown","a361bc2c":"markdown","a32b16ab":"markdown","eb8b01d0":"markdown","1995c8ff":"markdown","b0fa5585":"markdown","0453b08c":"markdown","0909d8f4":"markdown","68eb3603":"markdown","0116e2c2":"markdown","13313394":"markdown"},"source":{"7362dcd0":"import os\nimport ast\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport cv2\nimport random\n","55ff7100":"BASE_DIR = \"..\/input\/ranzcr-clip-catheter-line-classification\"","a1254fef":"train = pd.read_csv(f\"{BASE_DIR}\/train.csv\", index_col=0)\ntrain_annotations = pd.read_csv(f\"{BASE_DIR}\/train_annotations.csv\")","64b89014":"train.shape","7640980a":"train.head()","449db82d":"train.iloc[:, :-1].sum()","dbdb34bd":"def display_image(img_ids):\n    plt.figure(figsize=(14, 10))\n    \n    for index, img_id in enumerate(img_ids):\n        plt.subplot(3, 4, index + 1)\n        img = cv2.imread(os.path.join(BASE_DIR, \"train\", f\"{img_id}.jpg\"))\n        img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB)\n\n        plt.imshow(img)\n        plt.axis(\"off\")\n    \n    plt.show()\n    \n\ndef disp_describe(df, col):\n    print(\"Distribution:\")\n    print(df[col].value_counts())\n    print()\n    print(f\"Percent of 1: {df[col].mean():.4f}\")\n    \n\ndef disp_image_with_annotate(df, row_ind):\n    row = df.iloc[row_ind]\n    img_path = os.path.join(BASE_DIR, \"train\", row[\"StudyInstanceUID\"] + \".jpg\")\n    label = row[\"label\"]\n    data = np.array(ast.literal_eval(row[\"data\"]))\n    \n    plt.figure(figsize=(10, 5))\n    img = cv2.imread(img_path)\n    img = cv2.cvtColor(img, cv2.COLOR_BGR2RGB)\n    plt.subplot(1, 2, 1)\n    plt.imshow(img)\n    plt.subplot(1, 2, 2)\n    plt.imshow(img)\n    plt.scatter(data[:, 0], data[:, 1])\n    \n    plt.suptitle(label, fontsize=14)","756e4743":"train_annotations.shape","730792cd":"train_annotations.head()","2ae2c906":"disp_image_with_annotate(train_annotations, 10)","c0f56c8a":"for i in range(10):\n    disp_image_with_annotate(train_annotations, random.randint(0, 1500))","4e703077":"train.columns","7f50d12f":"col_name = \"ETT - Abnormal\"\ndisp_describe(train, col_name)\ntmp_df = train[train[col_name] == 1]\ndisplay_image(random.sample(tmp_df.index.tolist(), 12))","f59119ba":"col_name = \"ETT - Borderline\"\ndisp_describe(train, col_name)\ntmp_df = train[train[col_name] == 1]\ndisplay_image(random.sample(tmp_df.index.tolist(), 12))","707b3b7c":"col_name = \"ETT - Normal\"\ndisp_describe(train, col_name)\ntmp_df = train[train[col_name] == 1]\ndisplay_image(random.sample(tmp_df.index.tolist(), 12))","06893236":"col_name = \"NGT - Abnormal\"\ndisp_describe(train, col_name)\ntmp_df = train[train[col_name] == 1]\ndisplay_image(random.sample(tmp_df.index.tolist(), 12))","36ed60f7":"col_name = \"NGT - Borderline\"\ndisp_describe(train, col_name)\ntmp_df = train[train[col_name] == 1]\ndisplay_image(random.sample(tmp_df.index.tolist(), 12))","8134a0a2":"col_name = \"NGT - Incompletely Imaged\"\ndisp_describe(train, col_name)\ntmp_df = train[train[col_name] == 1]\ndisplay_image(random.sample(tmp_df.index.tolist(), 12))","869d4da1":"col_name = \"NGT - Normal\"\ndisp_describe(train, col_name)\ntmp_df = train[train[col_name] == 1]\ndisplay_image(random.sample(tmp_df.index.tolist(), 12))","948fc246":"col_name = \"CVC - Abnormal\"\ndisp_describe(train, col_name)\ntmp_df = train[train[col_name] == 1]\ndisplay_image(random.sample(tmp_df.index.tolist(), 12))","8f1c9622":"col_name = \"CVC - Borderline\"\ndisp_describe(train, col_name)\ntmp_df = train[train[col_name] == 1]\ndisplay_image(random.sample(tmp_df.index.tolist(), 12))","e76152f2":"col_name = \"CVC - Normal\"\ndisp_describe(train, col_name)\ntmp_df = train[train[col_name] == 1]\ndisplay_image(random.sample(tmp_df.index.tolist(), 12))","ae657b1c":"col_name = \"Swan Ganz Catheter Present\"\ndisp_describe(train, col_name)\ntmp_df = train[train[col_name] == 1]\ndisplay_image(random.sample(tmp_df.index.tolist(), 12))","187c881f":"### CVC Abnormal","452f00ce":"### Before starting there are some important terms\n\n- ETT Abnormal (endotracheal tube placement abnormal)\n- ETT Borderline (endotracheal tube placement borderline abnormal)\n- ETT Normal (endotracheal tube placement normal)\n- NGT Abnormal (nasogastric tube placement abnormal)\n- NGT Borderline (nasogastric tube placement borderline abnormal)\n- NGT Incompletely Imaged (nasogastric tube placement inconclusive due to imaging)\n- NGT Normal (nasogastric tube placement borderline normal)\n- CVC Abnormal (central venous catheter placement abnormal)\n- CVC Borderline (central venous catheter placement borderline abnormal)\n- CVC Normal (central venous catheter placement normal)\n- Swan Ganz Catheter Present","a361bc2c":"### NGT Normal","a32b16ab":"### CVC Borderline","eb8b01d0":"### ETT Borderline","1995c8ff":"### NGT Incompletely Imaged","b0fa5585":"### ETT Abnormal","0453b08c":"### Swan Ganz Catheter Present","0909d8f4":"### NGT Borderline","68eb3603":"### ETT Normal","0116e2c2":"### CVC Normal","13313394":"### NGT Abnormal"}}