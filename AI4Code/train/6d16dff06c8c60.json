{"cell_type":{"85fa0573":"code","653abfa0":"code","6278446f":"code","dbc51b07":"code","279830a0":"code","1e0780a1":"code","f7204f5b":"code","ff62849a":"code","c25aa915":"code","74b81ced":"code","6f6cd325":"code","b8774c39":"code","3a66d8c2":"code","2bbca7d7":"code","fa587699":"code","e44a08e3":"code","b306ffa0":"code","a7fe0921":"markdown","533e2f87":"markdown","425ba100":"markdown","95706714":"markdown","277907c5":"markdown","174d65f6":"markdown","b6e2e795":"markdown","35b5f557":"markdown","2e1a67d5":"markdown","28096e48":"markdown","94edb2b6":"markdown"},"source":{"85fa0573":"import pandas as pd \nimport numpy as np\nfrom pathlib import Path\nimport plotly.express as px\nimport plotly.graph_objects as go\nfrom tqdm.notebook import tqdm\ntqdm.pandas()","653abfa0":"csv_file = Path('..\/input\/calculating-number-of-pixels-for-change-in-masks\/annotations.csv')","6278446f":"df = pd.read_csv(csv_file)","dbc51b07":"len(df)","279830a0":"df_change = df[df['is_blank'] != 'blank'].reset_index(drop=True)","1e0780a1":"len(df_change)","f7204f5b":"df_pix = df_change.loc[:,['im_name','im_dates','period_1','period_2','n_change_pix','month_diff']]","ff62849a":"df_pix['n_change_pix'].describe()","c25aa915":"fig = px.box(df_change[df_change['n_change_pix'] < 180], y=\"n_change_pix\")\n\nfig.update_layout(\n    title='Distribution of Number of Pixels Containing Change\\n Threshold: 180',\n    xaxis_title=\"\",\n    yaxis_title=\"Number of Pixels Containing Change\",\n    font=dict(\n        family=\"Courier New, monospace\",\n        size=18,\n        color=\"#7f7f7f\"\n    )\n)\n\nfig.show()","74b81ced":"fig = px.histogram(df_change[df_change['n_change_pix'] < 180], x=\"n_change_pix\", nbins=100)\n\nfig.update_layout(\n    title='Distribution of Number of Pixels Containing Change\\n Threshold: 180',\n    xaxis_title=\"Number of Pixels Containing Change\",\n    yaxis_title=\"Count\",\n    font=dict(\n        family=\"Courier New, monospace\",\n        size=18,\n        color=\"#7f7f7f\"\n    )\n)\n\nfig.show()","6f6cd325":"df_pix_months = df_pix.groupby('month_diff')","b8774c39":"month = []\nmonth_image_counts = []\nfor gp in df_pix_months:\n    month.append(gp[0])\n    month_image_counts.append(len(gp[1]))","3a66d8c2":"import plotly.express as px\nimport numpy as np\n\nfig = px.bar(x=month, y=month_image_counts)\n\nfig.update_layout(\n    title='Number of Images Containing Change vs Difference in Number of Months',\n    xaxis_title=\"Difference in Number of Months\",\n    yaxis_title=\"Total Number of Images Containing Change\",\n    font=dict(\n        family=\"Courier New, monospace\",\n        size=18,\n        color=\"#7f7f7f\"\n    )\n)\n\nfig.show()","2bbca7d7":"def plot_monthly_change_statistics(df_pix,threshold=None):\n    if threshold is not None:\n        df_pix_filtered = df_pix[df_pix['n_change_pix'] < threshold].reset_index(drop=True)\n        title = \"Number of Pixels Containing Change vs Difference in Number of Months \\nThreshold: \" + str(threshold)\n    else:\n        df_pix_filtered = df_pix\n        title = \"Number of Pixels Containing Change vs Difference in Number of Months\"\n        \n    df_pix_months = df_pix_filtered.groupby('month_diff')\n    fig = go.Figure()\n\n    for gp in df_pix_months:\n      fig.add_trace(go.Box(y=gp[1]['n_change_pix'].values, name=gp[0]))\n\n    fig.update_layout(\n        title=title,\n        xaxis_title=\"Difference in Number of Months\",\n        yaxis_title=\"Number of Pixels Containing Change\",\n        font=dict(\n            family=\"Courier New, monospace\",\n            size=18,\n            color=\"#7f7f7f\"\n        )\n    )\n    fig.show()\n","fa587699":"plot_monthly_change_statistics(df_pix)","e44a08e3":"plot_monthly_change_statistics(df_pix,threshold=850)","b306ffa0":"plot_monthly_change_statistics(df_pix,threshold=150)","a7fe0921":"## Import Dependencies","533e2f87":"### Distribution of Number Of Pixels Containing Change","425ba100":"## Summary Statistics for Number of Pixels Containing Change","95706714":"Notice how the median and the variance vary as we increase the number of months between our images. This important to consider when training our model. Our model is more likely to perform better on images containing a higher number of pixels denoting change. Now that we added these extra columns, we can translate this new knowledge directly into our evaluation metrics to see where our model performs well and where it performs poorly.","277907c5":"## Reading DataFrame","174d65f6":"## Number of Images Containing Change vs Difference in Number of Months\nLet's visualize the distribution of the number of images containing change to the number of months between the 2 images.","b6e2e795":"## Extracting Dataframe Containing Only Images With Changes","35b5f557":"## Number of Pixels Containing Change vs Difference in Number of Months\nIn the previous plot we visualized how the `number of images` containing change varies with the number of months between the 2 images. In plot below we ask ourselves: Do the number of months between the 2 images affect the `number of pixels` containing change? \n\nIt would make sense, that as the number of months increases between the 2 images, then the number of change pixels, will most likely increase as well.\n\nLet's have a look at the distribution below with various thresholds; first the entire dataset, second at 850 pixels threshold, third at 150 pixels threshold.","2e1a67d5":"# SpaceNet 7 Mask Change Pixel Statistics\nIn this notebook we are going to explore how the number of pixels containing change in our masks varies with the number of months that the satellite images were captured in. In order to do that we will be using the updated csv file that we created in our [previous notebook](https:\/\/www.kaggle.com\/amerii\/calculating-number-of-pixels-for-change-in-masks).","28096e48":"## Visualizing Number of Pixels Containing Change\n### BoxPlot of Number of Pixels Containing Change\nLet's visualize the Number of by plotting a box plot. This box plot will have a threshold of 180 pixels. This means that any images containing more more than 180 pixels of change will not be part of the summary statistics. The reason for this is that I am considering any number greater than 180 as an outlier.\n","94edb2b6":"## Path to CSV"}}