{"cell_type":{"3a1914b2":"code","2f56df72":"code","3a23bb47":"code","c6249642":"code","c7d50c7d":"code","8ec600d6":"code","8ae7ff77":"code","80d5ad0e":"code","098cd935":"code","43123105":"code","e66622c2":"markdown","d93c7f0c":"markdown"},"source":{"3a1914b2":"import warnings\nwarnings.filterwarnings('ignore')\n\nimport os\nimport numpy as np\nimport pandas as pd\nfrom PIL import Image\nfrom matplotlib import pyplot as plt\nimport seaborn as sns\nimport glob\nfrom datetime import datetime","2f56df72":"train = pd.read_csv('..\/input\/shigglecup-1st\/DATA\/train.csv')\nprint(train.shape)\ntrain.head()","3a23bb47":"files = []\nfor f in glob.glob('..\/input\/shigglecup-1st\/DATA\/pokemon_images\/*.png'):\n    files.append(f)\nprint(len(files))","c6249642":"_df = pd.DataFrame(files, columns=['file_path'])\n_df['ext_path'] = _df['file_path'].str.extract('(\/[0-9].*.png)', expand=True)\n_df['species_id'] = _df['ext_path'].str.extract('([0-9]+)', expand=True)\n_df['species_id'] = _df['species_id'].astype(int)\n_df[_df['file_path']=='..\/input\/shigglecup-1st\/DATA\/pokemon_images\/386-attack.png']","c7d50c7d":"train = pd.merge(train, _df[['file_path', 'species_id']], on=['species_id'], how='left')","8ec600d6":"train['image_exist'] = np.where(train['file_path'].isnull(), 0, 1)\ndisplay(train.head())\ndisplay(train[(train['image_exist']==0)&(~train['file_path'].isnull())])","8ae7ff77":"train['target'].hist()","80d5ad0e":"train['target'] = train['target'].apply(lambda x: np.log1p(x))\ntrain['target'].hist()","098cd935":"# Top50\nplt.figure(figsize=(15, 20))\nfor i, r in train.sort_values('target', ascending=False).head(50).reset_index(drop=True).iterrows():\n    image = Image.open(r['file_path'])\n    image = np.array(image) # [256, 256, 4]\n    plt.subplot(10, 5, i + 1)\n    plt.imshow(image)\nplt.show()","43123105":"# Worst 50 \nplt.figure(figsize=(15, 20))\nfor i, r in train.sort_values('target').head(50).reset_index(drop=True).iterrows():\n    image = Image.open(r['file_path'])\n    image = np.array(image) # [256, 256, 4]\n    plt.subplot(10, 5, i + 1)\n    plt.imshow(image)\nplt.show()","e66622c2":"# Data Loading","d93c7f0c":"# Quick EDA"}}