{"cell_type":{"0aa961ea":"code","5a2811af":"code","0d8fb633":"code","e6e5e4ed":"code","62e65d6e":"code","1181807f":"code","bed0927f":"code","0226f250":"code","f90538d1":"code","433f8983":"code","2e3fdbc0":"code","4c50f4c0":"code","3c93de6b":"code","53530c69":"code","3a84cafa":"code","ca417032":"code","039f6fc8":"code","f05e95f5":"code","c9f2467e":"code","ebd95340":"code","bc5ceb80":"code","6d88aa73":"code","cd1a9d4b":"code","de1f3122":"code","f89c928c":"code","ba55e943":"code","828c36ab":"code","9a24bd25":"markdown","4608af6c":"markdown","5c311f09":"markdown","e6804372":"markdown","6bf99338":"markdown","3d2f301c":"markdown","340f9f5c":"markdown","8514751b":"markdown","57eee5bc":"markdown","5d851419":"markdown","12511fa1":"markdown","d20ce3ad":"markdown","60482b14":"markdown","010d23bf":"markdown","f842da5c":"markdown","926d9df2":"markdown","ab37f0bc":"markdown","9adabd71":"markdown","4f978fcf":"markdown","c5aa0ee7":"markdown","cef4d614":"markdown","6e69a2fc":"markdown","b8381fca":"markdown","91c45683":"markdown","1cdc6a16":"markdown","1a714ba9":"markdown","7fae846c":"markdown","a8fea309":"markdown","ae106a1f":"markdown","b1ce3950":"markdown","6c890493":"markdown","1142fb6f":"markdown","7ffb8d77":"markdown","35da2d63":"markdown","a3b98adb":"markdown","503ff9a4":"markdown","3c1c8d14":"markdown","e6deb1e3":"markdown","235f8ef9":"markdown","cd94bb8f":"markdown","6ae166f5":"markdown","6af4c550":"markdown","5832666a":"markdown","0a3898e0":"markdown","978aa640":"markdown","6ef6a8b4":"markdown","1cc48f0e":"markdown","117022cb":"markdown","489da4c0":"markdown","bd94c0be":"markdown","28615924":"markdown","efe8637b":"markdown","61933d85":"markdown","13704ac9":"markdown","1596138a":"markdown","85cede64":"markdown","559452ab":"markdown","3b5d1c01":"markdown","4928086f":"markdown","b04fa4b9":"markdown","10771c9f":"markdown","ed8434f6":"markdown","2f0246b0":"markdown","d502044a":"markdown","12f96dfa":"markdown","9743914d":"markdown","59a26bc9":"markdown","8047ecc2":"markdown","1bc53925":"markdown","51f78826":"markdown","3e24182c":"markdown","f4c8faf6":"markdown","14adb3bb":"markdown","38833b84":"markdown","73c58d35":"markdown","f0d19c8c":"markdown"},"source":{"0aa961ea":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport matplotlib.ticker as mtick\nimport seaborn as sns\nfrom matplotlib.patches import Patch\nfrom matplotlib.lines import Line2D\n\n%matplotlib inline","5a2811af":"# Different encoding to read brazilian data\namazonfires = pd.read_csv(\"..\/input\/brazilian-amazon-rainforest-degradation\/inpe_brazilian_amazon_fires_1999_2019.csv\", encoding='LATIN1')","0d8fb633":"amazonfires.head()","e6e5e4ed":"# Generating years for the graph axis labels\nint_year = list(range(1999, 2020))\n\nplt.figure(figsize=(12,5), dpi=85)\nsns.set_style(\"whitegrid\")\n\nsns.lineplot(data=amazonfires, x='year', y='firespots', estimator='sum', color=\"firebrick\")\n\nplt.ylabel(\"Total number of fire outbreaks\", size=\"large\")\nplt.xlabel(\"Year\", size=\"large\")\nplt.xticks(int_year, rotation=30)\nplt.title(\"Sum of Fire Outbreaks Detected per Year\", size=\"x-large\")\nplt.grid(axis='x')","62e65d6e":"# Month names in full length\nfullmonth = ['January', 'February', 'March', 'April', 'May', 'June',\n             'July', 'August', 'September', 'October', 'November', 'December']\n\nplt.figure(figsize=(12,5), dpi=85)\nsns.set_style(\"whitegrid\")\n\n#sns.lineplot(data=amazonfires, x='month', y='firespots', color=\"firebrick\")    \nsns.barplot(data=amazonfires, x='month', y='firespots', color=\"firebrick\")\n\nplt.grid(False)\nplt.ylabel(\"Total number of fire spots\", size=\"large\")\nplt.title(\"Average Fire Oubreaks by Month\", size=\"x-large\")\nplt.xlabel(\"Month\", size=\"large\")\nplt.xticks(ticks=amazonfires['month'].unique()-1, labels=fullmonth);","1181807f":"legal_amazon = (\n    amazonfires[['state','firespots']].groupby('state',as_index=False)\n    .sum()\n    .sort_values('firespots',ascending=False)['state']\n    .values\n)\n\nplt.figure(figsize=(12,5), dpi=85)\nsns.set_style(\"whitegrid\")\n\nsns.barplot(data=amazonfires, x='firespots', y='state', estimator=sum, color='firebrick', order=legal_amazon, ci=None)    \n\nplt.ylabel(\"State\", size=\"large\")\nplt.title(\"Total Fire Outbreaks by State\", size=\"x-large\")\nplt.xlabel(\"Total number of fire outbreaks\", size=\"large\");","bed0927f":"legal_amazon = (\n    amazonfires[['state','firespots']].groupby('state',as_index=False)\n    .sum()\n    .sort_values('firespots',ascending=False)['state']\n    .values\n)\n\nfig, ax = plt.subplots(3, 3, figsize=(18, 14), sharex=True)\nsns.set_style(\"whitegrid\")\nax = ax.flat\n\ni=0\nfor x in legal_amazon:\n    sns.lineplot(data=amazonfires[amazonfires['state'] == x], x='year',\n                 y='firespots', estimator='sum', ax=ax[i], color='firebrick', ci=None)\n    ax[i].set_title(x, size='large')\n    ax[i].set_xlabel(\"Year\", size='large')\n    ax[i].set_xticks([2000, 2005, 2010, 2015, 2020])\n    ax[i].grid(False)\n    ax[i].set_xticklabels([2000, 2005, 2010, 2015, 2020], fontsize='large')\n    \n    if i==0 or i==3 or i==6:\n        ax[i].set_ylabel(\"Total number of fire outbreaks\", size='large')\n    else:\n        ax[i].set_ylabel(\"\")\n    \n    i += 1\n\nplt.subplots_adjust(wspace=0.16, hspace=0.12)","0226f250":"fig, ax = plt.subplots(3, 3, figsize=(18, 14), sharex=True)\nsns.set_style(\"whitegrid\")\nax = ax.flat\n\ni=0\nfor x in legal_amazon:\n    #sns.lineplot(data=amazonfires[amazonfires['state'] == x], x='month',\n    #            y='firespots', ax=ax[i], color='firebrick')\n    sns.barplot(data=amazonfires[amazonfires['state'] == x], x='month',\n                y='firespots', ax=ax[i], color='firebrick')\n    ax[i].set_title(x, size='large')\n    ax[i].grid(False)\n    ax[i].set_xticklabels([1,2,3,4,5,6,7,8,9,10,11,12], fontsize='large');\n    \n    if x in ['PARA', 'AMAZONAS', 'RORAIMA']:\n        ax[i].set_ylabel(\"Total number os fire outbreaks\", size='large')\n    else:\n        ax[i].set_ylabel(\"\");\n    \n    if x in ['RORAIMA', 'AMAPA', 'TOCANTINS']:\n        ax[i].set_xlabel(\"Month\", size='large')\n    else:\n        ax[i].set_xlabel(\"\");\n    \n    i += 1","f90538d1":"%%HTML\n<div class='tableauPlaceholder' id='viz1576427659329' style='position: relative'><noscript><a href='#'><img alt=' ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;am&#47;amazon-fires-map&#47;DashboardMonthofpeak&#47;1_rss.png' style='border: none' \/><\/a><\/noscript><object class='tableauViz'  style='display:none;'><param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' \/> <param name='embed_code_version' value='3' \/> <param name='site_root' value='' \/><param name='name' value='amazon-fires-map&#47;DashboardMonthofpeak' \/><param name='tabs' value='no' \/><param name='toolbar' value='yes' \/><param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;am&#47;amazon-fires-map&#47;DashboardMonthofpeak&#47;1.png' \/> <param name='animate_transition' value='yes' \/><param name='display_static_image' value='yes' \/><param name='display_spinner' value='yes' \/><param name='display_overlay' value='yes' \/><param name='display_count' value='yes' \/><param name='filter' value='publish=yes' \/><\/object><\/div>                <script type='text\/javascript'>                    var divElement = document.getElementById('viz1576427659329');                    var vizElement = divElement.getElementsByTagName('object')[0];                    if ( divElement.offsetWidth > 800 ) { vizElement.style.width='620px';vizElement.style.height='557px';} else if ( divElement.offsetWidth > 500 ) { vizElement.style.width='620px';vizElement.style.height='557px';} else { vizElement.style.width='100%';vizElement.style.height='727px';}                     var scriptElement = document.createElement('script');                    scriptElement.src = 'https:\/\/public.tableau.com\/javascripts\/api\/viz_v1.js';                    vizElement.parentNode.insertBefore(scriptElement, vizElement);                <\/script>","433f8983":"fig, ax = plt.subplots(3, 3, figsize=(18, 15), sharex=True, sharey=True)\nax = ax.flat\n\ni=0\nfor x in legal_amazon:\n    st_month_year_pivot = amazonfires[amazonfires['state'] == x].pivot_table(values='firespots', index='month', columns='year', aggfunc='sum')\n    \n    sns.heatmap(data=st_month_year_pivot, xticklabels=int_year, ax=ax[i], cmap='YlOrBr', cbar=False)\n    \n    ax[i].set_ylabel(\"Month\", size='large')\n    ax[i].set_xlabel(\"Year\", size='large')\n    ax[i].set_title(x, size='large')\n    ax[i].set_xticklabels(int_year, fontsize='large')\n    ax[i].set_yticklabels([1,2,3,4,5,6,7,8,9,10,11,12], fontsize='large')\n    \n    for _, spine in ax[i].spines.items():\n        spine.set_visible(True)\n        \n    ax[i].xaxis.set_visible(False)\n    ax[i].yaxis.set_visible(False)\n    \n    i += 1\n    \n\nfor a in [ax[0], ax[3], ax[6]]:\n    a.yaxis.set_visible(True)\n    \nfor a in [ax[6], ax[7], ax[8]]:\n    a.xaxis.set_visible(True)\n    \nplt.subplots_adjust(wspace=0.05, hspace=0.1)","2e3fdbc0":"# Function to make the calculations\ndef previous_years_metrics(ds, year):\n    ds_grouped = (\n        ds[ds['year'] < year].groupby(['year','month'])\n        .sum()\n        .groupby('month')\n        .aggregate([min, max, np.mean])\n    )['firespots']\n    \n    ds_grouped[f'{year}'] = ds[ds['year'] == year].groupby('month')['firespots'].sum()\n    ds_grouped[f'{year}_max'] = (ds_grouped[f'{year}'] \/ ds_grouped['max']) *100\n    ds_grouped['avg_max'] = (ds_grouped['mean'] \/ ds_grouped['max']) *100\n    \n    return ds_grouped","4c50f4c0":"# Applying the function\nmonth_statistics_2017 = previous_years_metrics(amazonfires, 2017)\nmonth_statistics_2018 = previous_years_metrics(amazonfires, 2018)\nmonth_statistics_2019 = previous_years_metrics(amazonfires, 2019)","3c93de6b":"# Funcion to build the plots\ndef plot_year_row(dataset, year, ax1, ax2):\n    fmt = '%.0f%%' # Format you want the ticks, e.g. '40%'\n    xticks = mtick.FormatStrFormatter(fmt)\n    months = dataset.index\n    \n    ax1.bar(dataset.index, dataset[f'{year}'], align='center', color='whitesmoke', alpha=1, label=f\"{year}\", \n            edgecolor='grey', linewidth=1)\n    sns.lineplot(data=dataset, x=dataset.index, y='min', color=\"goldenrod\", lw=4, alpha=0.7, label=\"Minimum\", ax=ax1)\n    sns.lineplot(data=dataset, x=dataset.index, y='mean', color=\"orangered\", lw=4, alpha=0.7, label=\"Average\", ax=ax1)\n    sns.lineplot(data=dataset, x=dataset.index, y='max', color=\"firebrick\", lw=4, alpha=0.7, label=\"Maximum\", ax=ax1)\n    ax1.set_title(f\"{year} vs Previous Years\", size='large')\n    ax1.set_xlabel(\"Month\", size='large')\n    ax1.set_ylabel(\"Fire outbreaks\", size='large')\n    ax1.grid(False)\n    ax1.set_xticks(months)\n    ax1.set_xticklabels(months, fontsize='large')\n    ax1.legend(loc=\"upper left\")\n\n    ax2.bar(dataset.index, dataset[f'{year}_max'], align='center', color='whitesmoke', alpha=1, label=f\"{year}\", \n            edgecolor='grey', linewidth=1)\n    sns.lineplot(data=dataset, x=dataset.index, y='avg_max', color=\"orangered\", lw=4, alpha=0.7, label=\"Average\", ax=ax2)\n    ax2.axhline(y=100, color='firebrick', linestyle='-', lw=3.5, alpha=0.8, label=\"Maximum\")\n    ax2.set_title(f\"{year}, vs Previous Years (percentage of maximum)\", size='large')\n    ax2.set_xlabel(\"Month\", size='large')\n    ax2.set_ylabel(\"Fire Outbreaks (% of maximum)\", size='large')\n    ax2.yaxis.set_major_formatter(xticks)\n    ax2.grid(False)\n    ax2.set_xticks(months)\n    ax2.set_xticklabels(months, fontsize='large')\n    ax2.legend(loc=\"upper right\")","53530c69":"# Applying the function\nfig, ax = plt.subplots(3, 2, figsize = (18,16), dpi=85, sharex=True)\nsns.set_style(\"whitegrid\")\nplt.subplots_adjust(wspace=0.16, hspace=0.16)\nax = ax.flat\n\nplot_year_row(month_statistics_2017, 2017, ax[0], ax[1])\nplot_year_row(month_statistics_2018, 2018, ax[2], ax[3])\nplot_year_row(month_statistics_2019, 2019, ax[4], ax[5])","3a84cafa":"# Different encoding due to brazilian data\npivot_amazon_def = pd.read_csv(\"..\/input\/brazilian-amazon-rainforest-degradation\/def_area_2004_2019.csv\", encoding='LATIN1')\n\n# Dropping aggregated column\npivot_amazon_def.drop('AMZ LEGAL', axis=1, inplace=True)\n\n#Renaming columns as they are in the first dataset\ncolumn_names = [\"year\", \"ACRE\", \"AMAZONAS\", \"AMAPA\", \"MARANHAO\",\n                \"MATO GROSSO\", \"PARA\", \"RONDONIA\", \"RORAIMA\", \"TOCANTINS\"]\npivot_amazon_def.columns = column_names\n\npivot_amazon_def.head()","ca417032":"amazon_def_area = pivot_amazon_def.melt(id_vars=['year'], var_name='state', value_name='defarea')\namazon_def_area.head()","039f6fc8":"# Making the cummulative calculations\n\npivot_amazon_def['total'] = 0\npivot_amazon_def[\"total_cummulative\"] = 0\npivot_amazon_def[\"total\"] = pivot_amazon_def.drop(\"year\", axis=1).sum(axis=1)\npivot_amazon_def[\"total_cummulative\"] = pivot_amazon_def.total.cumsum()\n\n\n# Ploting the graphs\nfig, (ax1, ax2) = plt.subplots(2, 1, figsize = (12,8), dpi=85, sharex=True)\nsns.set_style(\"whitegrid\")\n\nsns.lineplot(data=amazon_def_area, x=amazon_def_area['year'], y=amazon_def_area['defarea'], estimator='sum', color=\"firebrick\", ci=None, ax=ax1)\nax1.set_ylabel(\"Total deforested area (km\u00b2)\", size=\"large\")\nax1.set_xlabel(\"Year\", size=\"large\")\nax1.set_title(\"Total Deforested Area per Year\", size='large')\nax1.grid(axis='x')\nax1.set_xlim(2004,2019)\nax1.set_ylim(0,30000)\n\npivot_amazon_def.set_index(\"year\")['total_cummulative'].plot.area(color='firebrick', alpha=0.2, ax=ax2)\nax2.set_ylabel(\"Cummulative deforested area (km\u00b2)\", size=\"large\")\nax2.set_xlabel(\"Year\", size=\"large\")\nax2.set_title(\"Cummulative Deforested Area\", size='large')\nax2.grid(axis='x');\nax2.set_xticks(list(range(2004,2020)))\nax2.set_xticklabels(list(range(2004,2020)));","f05e95f5":"plt.figure(figsize=(12,5), dpi=85)\nsns.set_style(\"whitegrid\")\n\nsns.barplot(data=amazon_def_area, x='defarea', y='state', estimator=sum, color='firebrick', order=legal_amazon, ci=None)    \n\nplt.ylabel(\"State\")\nplt.title(\"Total Deforested Area by State (km\u00b2)\")\nplt.xlabel(\"Total deforested area (km\u00b2)\");","c9f2467e":"fig, ax = plt.subplots(3, 3, figsize=(18, 14), sharex=True)\nsns.set_style(\"whitegrid\")\nax = ax.flat\n\ni=0\nfor x in legal_amazon:\n    sns.lineplot(data=amazon_def_area[amazon_def_area['state'] == x], x='year',\n                 y='defarea', estimator='sum', ax=ax[i], color='firebrick', ci=None)\n    ax[i].set_title(x, size='large')\n    ax[i].set_xlabel(\"Year\", size='large')\n    ax[i].set_xticks([2004, 2008, 2012, 2016, 2020])\n    ax[i].set_xticklabels([2004, 2008, 2012, 2016, 2020], fontsize='large')\n    ax[i].grid(False)\n    \n    if i==0 or i==3 or i==6:\n        ax[i].set_ylabel(\"Total Deforested Area (km\u00b2)\", size='large')\n    else:\n        ax[i].set_ylabel(\"\")\n    \n    i += 1\n\nplt.subplots_adjust(wspace=0.16, hspace=0.12)","ebd95340":"amazon_def_by_year = amazon_def_area.groupby(\"year\", as_index=False).sum()","bc5ceb80":"fig, ax = plt.subplots(figsize=(12,5), dpi=85)\nsns.set_style(\"whitegrid\")\n\nax.bar(amazon_def_by_year['year'], amazon_def_by_year['defarea'], color='firebrick', alpha=0.5, label='Deforested Area')\nplt.grid(False)\nax.legend(loc=\"upper left\")\nax.set_ylabel(\"Total deforested area (km\u00b2)\", size=\"large\")\nax.set_xlabel(\"Year\", size=\"large\")\nax.set_title(\"Deforested Area Vs Fire Outbreaks Amount\")\n#ax.grid(axis='x')\n\nax2 = ax.twinx()\nsns.lineplot(x=amazonfires['year'], y=amazonfires['firespots'], estimator='sum', color=\"firebrick\", ci=None, ax=ax2, label='Fire Outbreaks', lw=2.5)\nax2.set_xticks(ticks=list(range(2003, 2020)))\nax2.set_xlim(2003, 2020)\nax2.set_ylabel(\"Total fire outbreaks\", size=\"large\")\nplt.grid(False)\nax2.legend();","6d88aa73":"#grouping in the granularity of interest\ncomb = amazonfires[amazonfires['year'] > 2003].groupby('year').sum()\ncomb['area'] = amazon_def_by_year.groupby('year').sum()['defarea']\n\n#calculating the correlation\ncomb[[\"firespots\", \"area\"]].corr()","cd1a9d4b":"# Different encoding due to brazilian data\nel_nino_la_nina_records = pd.read_csv(\"..\/input\/brazilian-amazon-rainforest-degradation\/el_nino_la_nina_1999_2019.csv\", encoding='LATIN1')","de1f3122":"#create a new column with alpha for the graph\nalpha_map = {\n    \"Weak\":0.2,\n    \"Moderate\": 0.3,\n    \"Strong\": 0.4,\n    \"Very Strong\":0.5\n}\n\nel_nino_la_nina_records['alpha'] = el_nino_la_nina_records[\"severity\"].map(alpha_map)","f89c928c":"#separating between El Ni\u00f1o and La Ni\u00f1a\nel_nino_records = el_nino_la_nina_records[el_nino_la_nina_records['phenomenon'] == 'El Nino'].copy()\nla_nina_records = el_nino_la_nina_records[el_nino_la_nina_records['phenomenon'] == 'La Nina'].copy()","ba55e943":"fig, ax = plt.subplots(figsize=(12,5), dpi=85)\nsns.set_style(\"whitegrid\")\n\n# Ploting El Ni\u00f1o and La Ni\u00f1a\nfor i, row in el_nino_records.iterrows(): #generate a list of rows\n    ax.axvspan(row[\"start year\"]+0.5, row[\"end year\"]+0.5, alpha=row[\"alpha\"], color='darkgoldenrod', edgecolor=None, label='El Ni\u00f1o')\n\nfor i, row in la_nina_records.iterrows(): #generate a list of rows\n    ax.axvspan(row[\"start year\"]+0.5, row[\"end year\"]+0.5, alpha=row[\"alpha\"], color='lightskyblue', edgecolor=None, label='La Ni\u00f1a')\n\n\n    \n# Ploting the line\nsns.lineplot(x=amazonfires['year'], y=amazonfires['firespots'], estimator='sum', color=\"black\", ci=None, ax=ax)\nax.grid(False)\n\nplt.xticks(ticks=list(range(1999, 2020)), rotation=30)\n\nplt.title(\"Total Fire Outbreaks per Year & Weather Phenomena\", size=\"x-large\")\nplt.xlabel('Year', size=\"large\")\nplt.ylabel('Total Fire Outbreaks', size=\"large\")\n\nlegend_elements = [Line2D([0], [0], color='black', lw=2, label='Fire Outbreaks'),\n                   Patch(facecolor='darkgoldenrod', edgecolor='darkgoldenrod', label='El Nino', alpha=0.5),\n                   Patch(facecolor='lightskyblue', edgecolor='lightskyblue', label='La Ni\u00f1a', alpha=0.5)]\n\nax.legend(handles=legend_elements)\nax.set_ylim(0,300000);","828c36ab":"fig, ax = plt.subplots(figsize=(12,5), dpi=85)\nsns.set_style(\"whitegrid\")\nfor i, row in el_nino_records.iterrows(): #generate a list of rows\n    ax.axvspan(row[\"start year\"]+0.5, row[\"end year\"]+0.5, alpha=row[\"alpha\"], color='darkgoldenrod', edgecolor=None, label='El Ni\u00f1o')\n\nfor i, row in la_nina_records.iterrows(): #generate a list of rows\n    ax.axvspan(row[\"start year\"]+0.5, row[\"end year\"]+0.5, alpha=row[\"alpha\"], color='lightskyblue', edgecolor=None, label='La Ni\u00f1a')\n\nsns.lineplot(x=amazon_def_area['year'], y=amazon_def_area['defarea'], estimator='sum', color=\"black\", ci=None, ax=ax)\nax.grid(False)\n\nplt.xticks(ticks=list(range(2003, 2020)), rotation=30)\nax.set_xlim(2003, 2020)\n\nplt.title(\"Total Deforested Area per Year & Weather Phenomena\", size=\"x-large\")\nplt.xlabel('Year', size=\"large\")\nplt.ylabel('Deforested Area (km\u00b2)', size=\"large\")\n\nlegend_elements = [Line2D([0], [0], color='black', lw=2, label='Deforested Area'),\n                   Patch(facecolor='darkgoldenrod', edgecolor='darkgoldenrod', label='El Nino', alpha=0.5),\n                   Patch(facecolor='lightskyblue', edgecolor='lightskyblue', label='La Ni\u00f1a', alpha=0.5)]\n\nax.legend(handles=legend_elements)\nax.set_ylim(0,30000);","9a24bd25":"**Insights from the plot**:\n- Amazonas showed a peak in August 2019. The heatmap shows that the amount of fire outbreaks recorded in this month is above the average for this period of the year (the highest since 1999), which may indicate the presence of burns through unnatural causes.\n\n- Roraima showed a similar behavior in March and April 2019. This amount of fires in these months was above average for this period of the year. March was marked with the largest number of fire spots in this State history since 1999. \n\n- Para and Amazonas are the states with the largest periods of fires throughout the year, reaching almost an entire semester. These are also the largest states of the Legal Amazon, in terms of area.\n\n- Para, Mato Grosso, Rondonia, Maranhao and Tocantins show important reductions in the number of fire outbreaks compared to the early years of data collection. Amazonas, Acre, Roraima and Amapa do not show the same behavior.\n\n- December 2019 does not have all data, since they were extracted from the site during this month.","4608af6c":"### 1.4.3 - Previous Years' Metrics","5c311f09":"Now, let's analyze fire outbreaks Vs these weather phenomena. The more transparent the band is, the weaker the phenomenon was in that year.","e6804372":"<center align=\"center\"><b>Figure 1<\/b>: Amazon rainforest in South America (represented in <b><font color=\"green\">green<\/font><\/b>). Source: <a href='www.google.com'>Google<\/a><\/center> ","6bf99338":"---\n---","3d2f301c":"#### **Month**","340f9f5c":"In this kernel we are analyzing one of the many methods of forest degradation (fire), and the result, which is the deforestation area in km\u00b2. Let's look at them together now to see how they vary with each other.","8514751b":"---","57eee5bc":"<img src=\"https:\/\/www.dw.com\/image\/50112402_303.jpg\" alt=\"Fires in Brazilian Amazon rainforest\" class=\"center\">","5d851419":"It is interesting to note what is the behavior per month and how it is changing over the years. The heatmaps below show the amount of fire outbreaks over the years, for each month of the year for each state.\n\nThe color scale is not shared, so we can better see the individual behavior for each state.","12511fa1":"---\n---","d20ce3ad":"## 2.3 - Analysis","60482b14":"# 2 - Deforestation Area (PRODES)","010d23bf":"---","f842da5c":"**Insights from these graphs**:\n\n- In **2017**, only July was above the average of fire outbreaks, April, September and December got close to it. The other months were below the average. No month has come close to the maximum.\n- In **2018**, February and March had more fire outbreaks than the average of previous years. The rest of the months didn't come close to that.\n- **2019** was the only of these years to surpass the maximum of previous years in March and April. Both had burnings above 150% of the maximum this year. Also, February and August reached the previous years' average for each month. The rest of the months were below average. Data from December is incomplete so it's not possible to analyse it yet.\n- It is important to remember that these Maximum, Average and Minimum calculations include the years around 2002 ~ 2005, which had unnaceptable amounts fire outbreaks. We shouldn't use those years values to conclude that the situation is better now.","926d9df2":"# 4 - Conclusions","ab37f0bc":"---\n---","9adabd71":"I am interested in the correlation between these data.","4f978fcf":"### Introduction","c5aa0ee7":"Climate phenomena can be expected to influence the burning of the Amazon rainforest. For that, I decided to evaluate 2 of the most important climatic phenomena: El Ni\u00f1o and La Ni\u00f1a.\n\n**El Ni\u00f1o** and **La Ni\u00f1a** are natural weather patterns that result from interactions between the ocean and the atmosphere. Both involve anomalies in ocean surface temperatures and atmospheric circulation, resulting in climatic extremes around the world. While El Ni\u00f1o is the abnormal warming of the Equatorial Pacific Ocean, La Ni\u00f1a is the reverse, causing the Equatorial Pacific waters to cool. Source: [EMBRAPA](https:\/\/www.embrapa.br\/busca-de-publicacoes\/-\/publicacao\/986018\/de-que-modo-o-el-nino-influencia-a-amazonia-um-experimento-de-exclusao-de-chuva)\n\n**El Ni\u00f1o** produces some hot and humid air masses, which generate more rainfall in some regions and drought periods in other locations, such as the Amazon, Brazilian Northeast and other countries such as Australia and Indonesia.\n\n**La Ni\u00f1a** is the exactly reverse phenomenon: it represents an abnormal cooling of the waters of the Pacific Ocean due to the increased force of the trade winds. In Brazil, La Ni\u00f1a has the opposite effects, with the intensification of rainfall in the Amazon, the Northeast and parts of the Southeast. In addition, it causes temperatures to fall in North America and Europe.\n\nLet's analyze their effects!","cef4d614":"## 1.3 - Importing Libraries and Reading the Data","6e69a2fc":"## 1.2 - Data preparation using SQL","b8381fca":"I want to compare the most recent years with historical data.\n\nTo achieve this, the next plots show in the left the reference year represented in columns, vs the minimum, average and maximum of all previous years (calculations exclude the reference year). And in the right plot, the maximum is represented by the 100% for each month, while the average and 2017 values are represented in relation to the maximum. \n\nThe graphs were made to 2017, 2018 and 2019.","91c45683":"This kernel will analyze datasets of two different programs of [INPE](http:\/\/www.inpe.br\/dados_abertos\/).\n\n1) [BDQ](http:\/\/queimadas.dgi.inpe.br\/queimadas\/bdqueimadas\/) (Banco de Dados de Queimadas, or Fires Database): \n- Methodology: detects **fire outbreaks** through satellite images, updated every 3 hours.\n- Data: amount of fire outbreaks by state, month and year, from 1999 to 2019.\n- Data obtainment: The data were extracted on December 13th 2019, always from the filtering for the reference salellite and aggregated using Postgres SQL.\n\n\n2) [PRODES](http:\/\/www.obt.inpe.br\/OBT\/assuntos\/programas\/amazonia\/prodes) (Programa de Monitoramento da Floresta Amaz\u00f4nica Brasileira por Sat\u00e9lite, or Brazilian Amazon Rainforest Monitoring Program by Satellite):\n- Methodology: PRODES maps primary **forest loss** using satellite imagery, with 20 to 30 meters of spatial resolution and 16-day revisit rate, in a combination that seeks to minimize the problem of cloud cover and ensure interoperability criteria.\n- Data: Deforestation area (km\u00b2) by year and state, from 2004 to 2019.\n- Data obtainment: The data were extracted on December 16th. It was already aggregated, so, no data process was made.\n    \n    \n**It is important to note that there are many other forest biomes in Brazil in the same kind of danger, and also that Amazon is not only above Brazilian territory.** \n\nFeedback is extremly welcome. I hope you enjoy this work and can get some useful insight or piece of code from it.","1cdc6a16":"#### **State and Year**\n\nLet's analyse these two features together. How is the behavior of each state over the years?\n\nThe graphs below show the **sum** of deforested area for each state.","1a714ba9":"### Objectives\n\nThe importance of the Amazon rainforest for the balance of the world environment is unquestionable. This kernel will analyze the deforestation in the 9 Brazil states where Amazon biome can be found through the analysis of two INPE programs (amount of fire outbreaks of BDQ, and deforestation area of PRODES). \n\nWe want to know what the data has to say about:\n- **Is Brazilian Amazon Rainforest degradation increasing?**\n- **What is the behavior of fires: where and when do they occur?**\n- **How correlated is the number of fire outbreaks and the deforested area?**\n- **What is the effect of climate phenomenas El Ni\u00f1o and La Ni\u00f1a on Amazon degradation?**\n- **Are there evidences of natural\/unnatural causes in forest degradation?**","7fae846c":"### Contextualization\n\nThe Amazon rainforest is a moist broadleaf tropical rainforest in the Amazon biome that covers territory belonging to nine nations. The majority of the forest is contained within Brazil, with 60% of the rainforest, followed by Peru with 13%, Colombia with 10%, and with minor amounts in Venezuela, Ecuador, Bolivia, Guyana, Suriname and French Guiana. The total area is 5,500,000 square kilometres (2,123,562 square miles).\n\nSpecifically in Brazil, the Amazon forest covers the territory of 9 of its states. They are: Acre, Amapa, Amazonas, Maranhao, Mato Grosso, Para, Rondonia, Roraima and Tocantins.","a8fea309":"---\n---","ae106a1f":"# 1 - Fires outbreaks (BDQ)","b1ce3950":"The graph below shows the **average** of fire outbreaks in Amazon detected by INPE for each month in the range of 1999 to 2019. The confidence band is of 95%.\n\nThe graph shows that the second semester of the year, in average is the most affected by fire outbreaks, the top 3 being September, August and October.","6c890493":"Let's finally answer the questions: \n\n- **Is Brazilian Amazon Rainforest degradation increasing?**\n\n<u>Compared to the beginning of the last decade<\/u>, it can be firmly concluded that both the fire outbreaks and total deforested area **fell significantly**. However, <u>more recent data<\/u> show an increase in degradated area. The amount of deforested area for 2019, mainly due to the increase in deforestation in Para, Amazonas, Acre and Roraima, was last seen back in 2008. 2019 was also marked for having broken records of burnings in the months of March and April, even comparing to years around 2002 ~ 2005, which had unnaceptable amounts fire outbreaks (**Chapters 1.4.1**, **1.4.3** and **2.3**). \n\n\n- **What is the behavior of fires: where and when do they occur?**\n\nThe states with the most fire outbreaks are Para, Mato Grosso and Rondonia, in this order. The analysis showed that the peak month of fires may vary for each state, depending on their geographic location (**Chapter 1.4.2**).\n\n\n- **How correlated is the number of fire outbreaks and the deforested area?**\n\nFire outbreaks and deforested area have a high positive correlation coefficient of 0.83 (**Chapter 3.1**). This also means that fires are not the only important factor to the forest degradation. Indeed, fires are not the only method to degradate a forest and prepare to any type of economic activity.\n\n\n- **What is the effect of climate phenomenas El Ni\u00f1o and La Ni\u00f1a on Amazon degradation?**\n\nThere is a trend of increasing the amount of fire outbreaks in years with the occurrence of El Ni\u00f1o Phenomenon and decrease in years with the occurrence of La Ni\u00f1a, with some exceptions. However, the total deforested area does not seem to be impacted by these climatic phenomena (**Chapter 3.2**). \n\n\n- **Are there evidences of natural\/unnatural causes in forest degradation?** \n\nOne cannot be sure how much of this deforestation is unnatural. But this analysis found that there are indeed some evidences of deforestation caused by human activity:\n\n1) The amount of fire outbreaks has a strong relation with climatic phenomena (EL Ni\u00f1o and La Ni\u00f1a), but the deforested area does not have any (**Chapter 3.2**).\n\n2) Para, Amazonas, Acre and Roraima had much larger deforestation areas than previous years, indicating that they may not have occurred naturally (**Chapter 2.3**).\n\n3) In 15 years, 3% of the entire Brazilian Amazon area was degradated (**Chapter 2.3**). If this was a natural behavior, in 500 years the Amazon, which is millions of years old, wouldn't be a rainforest anymore.","1142fb6f":"---","7ffb8d77":"**Insights from these graphs:**\n- First thing to note is that 2019 was an outlier year for Amazonas, Acre and Roraima, with the deforested area getting close or even surpassing their maximums recorded in last decade.\n\n- Para also showed an important increase in the deforested area. It was not even close to its worst years, but proportionally, from all states, it was the one that deforested most in 2019, reaching 4k km\u00b2. Its trends in last years were indeed of increasing.\n\n- Mato Grosso and Rondonia have the same deforested area for a few years.\n\n- Maranhao, Amapa and Tocantins show a decrease in their deforested area.","35da2d63":"- First thing to note is that the area values are way more smooth than the fire outbreaks ones. \n- The left graph shows a very important peak in 2004, with values above 30k km\u00b2 of deforestation. Then, the numbers decrease and seem to stabilize, staying below 8k km\u00b2 of deforestation from 2009 to 2018. In 2019, however, this number reached 10k km\u00b2 again, which hadn't happened since 2008 (it is important to remember that the data from 2019 is not complete, since it was extracted during this month).\n- The cummulative graph shows that from 2004 until today, more than 160k km\u00b2 of the Amazon rainforest has been deforested. These 15 years represented:\n    - almost one sixth (17%) of the total deforestation area so far;\n    - 3% of the entire Brazilian Amazon Area!","a3b98adb":"## 3.2 - El Ni\u00f1o and La Ni\u00f1a","503ff9a4":"- Analyzing this graph, it is possible to see a trend of increasing the amount of fire outbreaks in years with the occurrence of El Ni\u00f1o Phenomenon (in 2005, 2007, 2010, 2015, 2019), with some exceptions.\n- One of these exceptions was in 2016, when this phenomenon was considered \"Very Strong\" and the strongest occurrence in the analyzed period, the number of fire outbreaks even decreased slightly from the previous year (when there was also an El Ni\u00f1o occurrence, but considered \"Weak\") and next year (when there was an El Ni\u00f1a occurrence, considered \"Weak\" as well).\n- It is also possible to see a trend of decreasing the amount of fire outbreaks in years with the occurrence of La Ni\u00f1a, such as in 2006, 2008, 2009, 2011, 2012 and 2018 (again, with a few exceptions). One exception example is the decrease in fire outbreaks in 2009 compared to 2008, when the same phenomenon was stronger.\n- These contradictions show that, although it appears to have a correlation between these phenomena and the fires, it may not be causal or the most important factor. One thing that can happen, for example, is people taking advantage of the information about the El Ni\u00f1o occurrence to set fire in a criminal way.\n\nNow, let's analyze deforested area Vs these weather phenomena. Again, the more transparent the band is, the weaker the phenomenon was in that year.","3c1c8d14":"#### **State and Year**\n\nLet's analyse these two features together. How is the behavior of each state over the years?\n\nThe graphs below show the **sum** of fire outbreaks for each state.","e6deb1e3":"Deforestation happens for many reasons, such as illegal agriculture, natural disasters, urbanization and mining. There are several ways to remove forests - burning and logging are two methods. Although deforestation is happening all over the world today, it is an especially critical issue in the Amazon rainforests, as the only large forest still standing in the world. There, the species of plants and animals they harbor have been disappearing at an alarming rate. Source: [INPE](http:\/\/www.inpe.br\/)","235f8ef9":"The figure below shows the **sum** of deforested area for each state for all the years in the dataset. ","cd94bb8f":"The graphs below show, in the left, the **sum** of deforested area (km\u00b2) in Brazilian Amazon for each year since 2004 with 95% confidence band; and in the right, the **cummulative** deforested area.\n\nIt is important to look at the cummulative because when a part of the forest is deforested (by burning, logging or any other mothod), it will hardly be recovered. First, because the space will probably be used for agriculture, livestock or mining. Second, because if an attempt is made to recover it, it would take at least a hundred years for it to regenerate with all the fauna and flora it once housed.\n\nSo, let's look at these charts!","6ae166f5":"#### **State**","6af4c550":"Data are already pivoted, and I need them unpivoted.","5832666a":"---","0a3898e0":"In order to know more about the peak month in each state, I put this information in a map using Tableau:","978aa640":"## 3.1 - Fire Outbreaks Vs Deforested Area","6ef6a8b4":"---","1cc48f0e":"### 1.4.1 - An overview","117022cb":"---","489da4c0":"## 1.1 - Dataset Summary\n\n### General information (Original dataset):\n- Format: CSV\n- Number of rows: 2456247 (total)\n- Number of columns: 12 (in Portuguese, translated to English below): \n    - datahora = datetime\n    - satelite = satellite\n    - pais = country\n    - municipio = city\n    - bioma = biome\n    - diasemchuva = days without rain\n    - precipitacao = rainfall\n    - riscofogo = risk of fire\n    - latitude = latitude\n    - longitude = longitude\n    - frp = fire radiative power\n        \n","bd94c0be":"**From this map we can see that:**\n- The southernmost states, which are continental, have their peak in fire outbreaks in September. They are: Acre, Rondonia, Mato Grosso and Tocantins.\n- Maranhao and Amapa have their peak in November. They are both states on the coast. \n- Para is also on the coast, and if you analyse the bar plots above, this state has actually two peaks: the biggest in August, together with Amazonas, and the other in November, with the coastal states. Para has a large territory and apparently has similarities with Amazonas and the coastal states. Maybe these peaks refer to different fire clusters locations, one in the continental part of the State, and the other on the coast.\n- As previously noted, Roraima has a very different behavior, with a lag of a few months when compared to the other states (peaking only in March!).","28615924":"<center align=\"center\"><b>Figure 2<\/b>: Fires in Brazilian Amazon rainforest. Source: <a href='https:\/\/www.dw.com\/en\/brazil-forest-fires-rage-as-farmers-push-into-the-amazon\/a-50116455'>DW<\/a><\/center> ","efe8637b":"## 1.4 - Data Analysis","61933d85":"#### **Year, Month and State**","13704ac9":"First, I want to analyse the situation in an overview, detecting the fire outbreaks by year, month and state.","1596138a":"```SQL\nSELECT \n    EXTRACT(YEAR FROM datahora) as year,\n    EXTRACT(MONTH FROM datahora) as month,\n    estado as state,\n    AVG(latitude) as latitude,\n    AVG(longitude) as longitude,\n    COUNT(estado)  as firespots\n    \nFROM south_america_fires \n\nGROUP BY \n    EXTRACT(YEAR FROM datahora), \n    EXTRACT(MONTH FROM datahora), \n    estado\n\nORDER BY year;\n```","85cede64":"<img src=\"https:\/\/cdn-cf.tucantravel.com\/images\/Experiences\/WILDLIFE_HOLIDAY_TOURS\/AMAZON-JUNGLE-MAP-IN-SOUTH-AMERICA.jpg\" alt=\"Fires in Brazilian Amazon rainforest\" class=\"center\">","559452ab":"## 2.2 - Reading the Data","3b5d1c01":"### 1.4.2 - Combining features\n\nHaving a better grasp of the problem and the current situation. It's time to dig deeper into the data.","4928086f":"# Is Amazon Degradation Increasing?\n#### _An exploratory data analysis to find out what the data has to tell us about Amazon deforestation._","b04fa4b9":"Para and Mato Grosso are the most affected states in Brazil by the Amazon deforestation, having at least twice the total deforested area of others combined.\nAlso, although Amapa has more fire outbreaks than Tocantins (as shown in previous charts), when it comes to deforested area, Tocantins comes first.","10771c9f":"## 2.1 - Dataset Summary\n\n### General information\n- Format: CSV\n- Number of rows: 16\n- Number of columns: 11\n    \n### Features in the dataset\nData extracted from a Brazilian website. Features are in Portuguese. Data is already pivoted, will be unpivoted later.\n- **Ano\/Estados**: Year of occurrence\n- **AC, AM, AP, MA, MT, PA, RO, RR, TO**: States of Legal Amazon\n- **AMZ LEGAL**: Sum of all states\n- Values: deforested area in **squared kilometers (km\u00b2)**.","ed8434f6":"#### **State and month**","2f0246b0":"### General information (Aggregated dataset):\nAfter processing using SQL the dataset has the following shape:\n- Format: CSV\n- Number of rows: 2104\n- Number of columns: 6\n- Features:\n    - **year**: Year of occurrence\n    - **month**: Month of occurrence\n    - **state**: State of occurrence\n    - **latitude**: Average latitude of all occurrences in this month, year and state\n    - **longitude**: Average longitude of all occurrences in this month, year and state\n    - **firespots**: Number of forest fire outbreaks","d502044a":"Now let's take a look in the fire outbreak's behavior throughout the year. The graphs below show the **average** of outbreaks per month for each state (confidence band = 95%).\n\nThe fire outbreaks seem to be concentrated in the second semester of the years for all states, except for Roraima, which is weird. For this state, the peak in fire outbreaks seems to be lagging in a few months, starting softly in October and peaking in March of the following year.","12f96dfa":"**Insights from graph:**\n- It seems that the peak we had previously noted in 2002 was mainly caused by the fires in Para, Mato Grosso and Rondonia. These 3 states had a peak in 2002 and gradually decrease fire outbreaks numbers until 2011.\n\n- Maranhao, Acre and Tocantins show this same behavior, but on a smaller scale.\n\n- Amazonas does not seem to have the same behavior. For this state, the outbreaks of fire decrease from 2002 to 2011, and then increase again, reaching close to the worst months so far. Same thing for Roraima, which rechead the largest amount of fire outbreaks in 2019.\n\n- Amapa does not show a clear behavior.","9743914d":"As expected, fire outbreaks have a pretty considerable correlation with the deforested area throughout the years (correlation coefficient of 0.83). But it also shows that it is not the only thing important to the forest degradation.\nAs previously said, fires are not the only method to degradate a forest and prepare to any type of economic activity. ","59a26bc9":"#### **Year**","8047ecc2":"El Ni\u00f1o and La Ni\u00f1a are known to be natural phenomena that occur seasonally, that influence important factors when it comes to burnings (such as long droughts and strong winds that can facilitate the spread of fire, in the El Ni\u00f1o case). And it could be seen from the previous graph that, indeed, they do have a correlation with the number of fire outbreaks. This leads us to believe that a portion of Amazon rainforest degradation is due to these phenomena.\n\nIf Amazon deforestation came only from natural causes, this would be reflected on this graph too. However, unlike the fire outbreak chart, the total deforested area chart for each year does not show a clear relation to the occurrence of these climatic phenomena. Instead, the graph shows significant variations that cannot be explained by their occurrences, such as the decrease from almost 30k to 5k km\u00b2 of deforested area from 2004 to 2012, and the subsequent increase from 5k to 10k km\u00b2 of deforestation from 2014 to 2019, an increase of 100 % in 5 years.\n\nThis shows that a significant portion of the degradation may be due to unnatural causes such as criminal fires or other deforestation methods.","1bc53925":"First, I extrated data of occurrences of these climatic phenomena since 1999. They are characterized by Sea surface Temperature (SST) and categorized between Weak (with a 0.5 to 0.9 SST anomaly), Moderate (1.0 to 1.4), Strong (1.5 to 1.9) and Very Strong (\u2265 2.0) events.\n\nSource: [Golden Gate Weather](https:\/\/ggweather.com\/enso\/oni.htm)","51f78826":"The graph below shows the **sum** of fire outbreaks in Amazon detected by INPE for each year since 1999. The confidence band is of 95%.\n\nIt seems that, overall, the number of fire outbreaks in the Amazon had a really important peak in 2002 and, after this year, decreased little by little until 2011. From this point to today, a little increase in the number of fires outbreaks can be noted. \n\nPlease note that the data from 2019 is not complete, since it was extracted at December 13th 2019.","3e24182c":"Since the original data had too many rows, the first thing I did was to process them using PostgresSQL and select only the data I wanted.\n\nI aggregated the fire outbreaks by year, month and state, counting the number of occurrences and taking to average of latitude and longitude.\n\nThe code used in SQL was as follows:","f4c8faf6":"#### **State**","14adb3bb":"#### Year","38833b84":"The region provides important benefits to communities living near and far. Nearly 500 indigenous communities call the Amazon rainforest home. It\u2019s a highly biodiverse ecosystem, home to untold species of plants and animals. The rainforest can create its own weather and influence climates around the world. Unfortunately, the fragile ecosystem faces the constant threat of deforestation and fires (for natural or anthropogenic causes).","73c58d35":"# 3 - Comparing datasets","f0d19c8c":"It is also important to know which states are the most affected by the fires. The figure below shows the **sum** of fire outbreaks for each state for all the years in the dataset. **Para** and **Mato Grosso** are the most affected states in Brazil by the Amazon fires, **having at least twice the amount of fire outbreaks of others combined.**"}}