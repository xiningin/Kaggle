{"cell_type":{"0d5737df":"code","d1e62805":"code","9a1f70f0":"code","35303410":"code","6b248db5":"code","1a3f8356":"code","599dfe08":"code","5498ba47":"code","bc67cfc2":"code","f312f93c":"code","15db62e2":"code","816d9b14":"code","516a476a":"code","9cc0dff1":"code","5353e9ea":"code","5b430a37":"code","3af85bca":"code","4e402c0d":"code","e5751c20":"code","c7af4c74":"code","d91d5d87":"code","fd2b86e0":"code","9706b4c5":"code","c4f27c07":"code","2b798465":"code","9019fc01":"code","46440eb7":"code","132d850f":"code","441d8b9b":"code","481099d2":"code","fd94de44":"markdown","0a257149":"markdown","fa6d87ca":"markdown","b829a0b9":"markdown","e20c3ba9":"markdown","73506db1":"markdown","13eadadd":"markdown","312a808b":"markdown","df982bbe":"markdown","eae5865d":"markdown","48a97468":"markdown","0f79430e":"markdown","673e406a":"markdown","d7e0a17c":"markdown"},"source":{"0d5737df":"import numpy as np\nimport pandas as pd\nimport seaborn as sns\nimport matplotlib.pyplot as plt\n%matplotlib inline","d1e62805":"df = pd.read_csv('..\/input\/easemytrip-flight-fare-details-2020\/marketing_sample_for_easemytrip_in-easemytrip_flight_fares_data__20200101_20200229__30k_data.csv')\ndf.head()","9a1f70f0":"df.drop(['Uniq Id', 'Crawl Timestamp'], axis=1, inplace=True)","35303410":"df.head()","6b248db5":"df.info()","1a3f8356":"df[\"Departure Date\"] = df[\"Departure Date\"].apply(lambda x: x.replace(\"Jan\", \"01\"))\ndf[\"Departure Date\"] = df[\"Departure Date\"].apply(lambda x: x.replace(\"Feb\", \"02\"))\ndf[\"Departure Date\"] = df[\"Departure Date\"].apply(lambda x: x.replace(\"Mar\", \"03\"))\ndf[\"Departure Date\"] = df[\"Departure Date\"].apply(lambda x: x.replace(\"Apr\", \"04\"))\ndf[\"Departure Date\"] = df[\"Departure Date\"].apply(lambda x: x.replace(\"May\", \"05\"))\ndf[\"Departure Date\"] = df[\"Departure Date\"].apply(lambda x: x.replace(\"Jun\", \"06\"))\ndf[\"Departure Date\"] = df[\"Departure Date\"].apply(lambda x: x.replace(\"Jul\", \"07\"))\ndf[\"Departure Date\"] = df[\"Departure Date\"].apply(lambda x: x.replace(\"Aug\", \"08\"))\ndf[\"Departure Date\"] = df[\"Departure Date\"].apply(lambda x: x.replace(\"Sep\", \"09\"))\ndf[\"Departure Date\"] = df[\"Departure Date\"].apply(lambda x: x.replace(\"Oct\", \"10\"))\ndf[\"Departure Date\"] = df[\"Departure Date\"].apply(lambda x: x.replace(\"Nov\", \"11\"))\ndf[\"Departure Date\"] = df[\"Departure Date\"].apply(lambda x: x.replace(\"Dec\", \"12\"))","599dfe08":"df[\"Arrival Date\"] = df[\"Arrival Date\"].apply(lambda x: x.replace(\"Jan\", \"01\"))\ndf[\"Arrival Date\"] = df[\"Arrival Date\"].apply(lambda x: x.replace(\"Feb\", \"02\"))\ndf[\"Arrival Date\"] = df[\"Arrival Date\"].apply(lambda x: x.replace(\"Mar\", \"03\"))\ndf[\"Arrival Date\"] = df[\"Arrival Date\"].apply(lambda x: x.replace(\"Apr\", \"04\"))\ndf[\"Arrival Date\"] = df[\"Arrival Date\"].apply(lambda x: x.replace(\"May\", \"05\"))\ndf[\"Arrival Date\"] = df[\"Arrival Date\"].apply(lambda x: x.replace(\"Jun\", \"06\"))\ndf[\"Arrival Date\"] = df[\"Arrival Date\"].apply(lambda x: x.replace(\"Jul\", \"07\"))\ndf[\"Arrival Date\"] = df[\"Arrival Date\"].apply(lambda x: x.replace(\"Aug\", \"08\"))\ndf[\"Arrival Date\"] = df[\"Arrival Date\"].apply(lambda x: x.replace(\"Sep\", \"09\"))\ndf[\"Arrival Date\"] = df[\"Arrival Date\"].apply(lambda x: x.replace(\"Oct\", \"10\"))\ndf[\"Arrival Date\"] = df[\"Arrival Date\"].apply(lambda x: x.replace(\"Nov\", \"11\"))\ndf[\"Arrival Date\"] = df[\"Arrival Date\"].apply(lambda x: x.replace(\"Dec\", \"12\"))","5498ba47":"df['Arrival Date'] = pd.to_datetime(df['Arrival Date'], format='%d%m%Y')\ndf['Departure Date'] = pd.to_datetime(df['Departure Date'], format='%d%m%Y')","bc67cfc2":"total_time_hrs_lst = []\nfrom tqdm.notebook import tqdm\nfor index,row in tqdm(df.iterrows()):\n    total_time = row['Total Time']\n    a = [float(n.replace('m','')) for n in total_time.split('h')]\n    total_time_hrs = round(float(a[0] + (a[1]\/60)),2)\n    total_time_hrs_lst.append(total_time_hrs)","f312f93c":"df['Total Time Hrs'] = total_time_hrs_lst","15db62e2":"df['Source'].value_counts().head(30)","816d9b14":"df['Source'].value_counts().tail(30)","516a476a":"ax = pd.DataFrame(df['Source'].value_counts()).head(50).plot(kind = 'bar',figsize=(15,10))\nax.set_title('Number of flights from each source')\nax.set_xlabel('Source')\nax.set_ylabel('Number of Flights')\nstart, end = ax.get_ylim()\nz = ax.yaxis.set_ticks(np.arange(start, end, 200))","9cc0dff1":"df['Destination'].value_counts().head(30)","5353e9ea":"df['Destination'].value_counts().tail(30)","5b430a37":"ax = pd.DataFrame(df['Destination'].value_counts()).head(50).plot(kind = 'bar',figsize=(15,10))\nax.set_title('Number of flights to each destination')\nax.set_xlabel('Destination')\nax.set_ylabel('Number of Flights')\nstart, end = ax.get_ylim()\nz = ax.yaxis.set_ticks(np.arange(start, end, 200))","3af85bca":"d = df.groupby('Source').sum().reset_index()\nd.sort_values(by=['Number Of Stops'], ascending=False, inplace=True)","4e402c0d":"d.head(20)","e5751c20":"d.tail(30)","c7af4c74":"fig_dims = (20, 10)\nfig, ax = plt.subplots(figsize=fig_dims)\nax = sns.barplot(x=d['Source'].head(20), y=d['Number Of Stops'].head(20), ax=ax)\nax.set_title('Number of LayOvers a Source Station has in the given period')\nax.set_xlabel('Source')\nax.set_ylabel('Number of Layovers')\nstart, end = ax.get_ylim()\nz = ax.yaxis.set_ticks(np.arange(start, end, 200))","d91d5d87":"flights = df['Flight Operator'].values\nflights_lst = list(flights)","fd2b86e0":"from tqdm.notebook import tqdm\nflight_operators = set()\nfor i in flights_lst:\n    j = i.split('|')\n    for k in j:\n        flight_operators.add(k)\nflight_operator_count = {}\nfor i in tqdm(flight_operators):\n    temp = 0 \n    for j in flights_lst:\n        if i in j:\n            temp += 1\n    flight_operator_count[i] = temp","9706b4c5":"operator_data = pd.DataFrame(list(flight_operator_count.items()), columns=['Operator', 'Number Of Flights'])","c4f27c07":"operator_data.sort_values(by = 'Number Of Flights', ascending=False, inplace=True)","2b798465":"operator_data.head(10)","9019fc01":"import plotly.express as px\npx.bar(x=\"Operator\", y = \"Number Of Flights\", data_frame=operator_data.head(20))","46440eb7":"df.head()","132d850f":"df['Total Time Hrs'].describe()","441d8b9b":"df[df['Total Time Hrs'] == 68.58]","481099d2":"df[df['Total Time Hrs'] == 0.67]","fd94de44":"### By observing the Info of the Data, it's understood that nearly 28K of 30K flights have 1 Layover while there are only 7 flights with 3 layovers","0a257149":"## Analysing Flight Operator Data","fa6d87ca":"### It is observed that Air India has operated more number of flights (approx. 11K) than any other flight operators. While Indigo has got the 2nd place with (approx. 4.2K flights).","b829a0b9":"## Analysing the source column","e20c3ba9":"### Dropping the UniqueID and Crawl TimeStamp since those are not informational","73506db1":"It is observed that All the flights with duration less than 1 hour are near by cities. So the travel time is less","13eadadd":"### Mumbai is having most number of flights that has more layovers\n### The Flights from top cities in India are having more number of layover's because flights from these places go for long distance connecting some intermediate places aswell.","312a808b":"## Analysing the Destination Column","df982bbe":"### 1. It is observed that there are more number of flights from Mumbai when compared to other places\n### 2. The next Source station that has more number of flights are Bengaluru, Ahmedabad, Kolkata, Delhi and Dubai\n### 3. All the Metro Cities in India has more number of flights and it's true because those cities have international airports\n### 4. At the same time all the cities that have less number of flights starting from them are Tier 3 Cities and Towns in India","eae5865d":"## Analysing the Source and Number of Stops","48a97468":"## Calculating the total journey time in hrs for all flights","0f79430e":"### 1. There are 4.5K Flights with Delhi as Destination\n### 2. All the Top Cities in India has more number of flights as Destination and it's true because those cities have international airports and also the main cities in India\n### 3. At the same time all the cities that have less number of flights starting from them are Tier 3 Cities and Towns in India","673e406a":"## Converting the Departure Date and Arrival Date columns to Date time format","d7e0a17c":"## Analysing Total Travel Time Data "}}