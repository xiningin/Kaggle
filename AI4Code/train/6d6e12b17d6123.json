{"cell_type":{"daad0717":"code","6016f1df":"code","a96ce946":"code","420006bc":"code","00e112a2":"code","d7a0c951":"code","fa2baead":"code","305935ca":"code","f4ef4062":"code","154645c4":"code","424a98d0":"code","e5c8a89f":"code","d31c8e7a":"code","c6a765b0":"markdown","20dab671":"markdown","ddd2da03":"markdown","17724d07":"markdown","3cfc1ad7":"markdown","cb8d5e31":"markdown","40367882":"markdown","485112f0":"markdown","c1f28960":"markdown","34a665e8":"markdown","4a2c8d3f":"markdown"},"source":{"daad0717":"import pandas as pd\nimport matplotlib.pyplot as plt\nimport shapefile as shp\nimport seaborn as sns\nimport numpy as np\nfrom scipy.stats import norm\nfrom sklearn.preprocessing import StandardScaler\nfrom scipy import stats\nimport warnings\nwarnings.filterwarnings('ignore')\n%matplotlib inline\n\ndf_inep = pd.read_csv('..\/input\/inep-data\/inep.csv', sep = ';')","6016f1df":"df_inep.head()","a96ce946":"import plotly.express as px\n\nfig = px.scatter_mapbox(df_inep, lat=\"Latitude\", lon=\"Longitude\",color = 'Categoria Administrativa', hover_name=\"Escola\",\n                        hover_data=[\"Munic\u00edpio\", \"Categoria Administrativa\", \"UF\"], color_continuous_scale=px.colors.cyclical.IceFire, zoom=3, height=300)\nfig.update_layout(mapbox_style=\"open-street-map\")\nfig.update_layout(margin={\"r\":0,\"t\":0,\"l\":0,\"b\":0})\nfig.show()\n","420006bc":"x_uf = df_inep['UF'].unique()\nx_pb = df_inep['Categoria Administrativa'].unique()\nx_pe = df_inep['Porte da Escola'].unique()\nx_lc = df_inep['Localiza\u00e7\u00e3o'].unique()\nx_da = df_inep['Depend\u00eancia Administrativa'].unique()\nx_ld = df_inep['Localidade Diferenciada'].unique()\nmp_uf = {k: i for i,k in enumerate(x_uf)}\nmp_pb = {k: i for i,k in enumerate(x_pb)}\nmp_pe = {k: i for i,k in enumerate(x_pe)}\nmp_lc = {k: i for i,k in enumerate(x_lc)}\nmp_da = {k: i for i,k in enumerate(x_da)}\nmp_ld = {k: i for i,k in enumerate(x_ld)}\nprint(mp_uf)\nprint(mp_pb)\nprint(mp_pe)\nprint(mp_lc)\nprint(mp_da)\nprint(mp_ld)","00e112a2":"df_inep['UF'] = [mp_uf[uf] for uf in df_inep['UF']]\ndf_inep['Categoria Administrativa'] = [mp_pb[pb] for pb in df_inep['Categoria Administrativa']]\ndf_inep['Porte da Escola'] = [mp_pe[pe] for pe in df_inep['Porte da Escola']]\ndf_inep['Localiza\u00e7\u00e3o'] = [mp_lc[lc] for lc in df_inep['Localiza\u00e7\u00e3o']]\ndf_inep['Depend\u00eancia Administrativa'] = [mp_da[da] for da in df_inep['Depend\u00eancia Administrativa']]\ndf_inep['Localiza\u00e7\u00e3o'] = [mp_ld[ld] for ld in df_inep['Localidade Diferenciada']]\ndf_inep.head()","d7a0c951":"df_inep.describe()","fa2baead":"g = sns.FacetGrid(df_inep, col='Categoria Administrativa')\ng.map(plt.hist, 'UF', bins=26)\n","305935ca":"corrmat = df_inep.corr()\nf, ax = plt.subplots(figsize=(12, 9))\nsns.heatmap(corrmat, vmax=.8, square=True);\n","f4ef4062":"#scatterplot\nsns.set()\ncols = ['Categoria Administrativa', 'Localiza\u00e7\u00e3o', 'UF', 'Depend\u00eancia Administrativa', 'Porte da Escola', 'Latitude', 'Longitude', 'C\u00f3digo INEP']\nsns.pairplot(df_inep[cols], size = 2.5)\nplt.show();\n\n","154645c4":"from sklearn.ensemble import RandomForestClassifier\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.metrics import confusion_matrix\nfrom sklearn.metrics import accuracy_score","424a98d0":"train_data, test_data = train_test_split(df_inep, test_size=0.2)\ny = train_data[\"Categoria Administrativa\"]\ny_test =test_data[\"Categoria Administrativa\"]\nfeatures = [\"C\u00f3digo INEP\",\"UF\",\"Localiza\u00e7\u00e3o\", \"Porte da Escola\"]\nX = pd.get_dummies(train_data[features])\nX_test = pd.get_dummies(test_data[features])","e5c8a89f":"model = RandomForestClassifier(n_estimators=30, random_state=1)\nmodel.fit(X, y)\npredictions = model.predict(X_test)\nm = confusion_matrix(y_test, predictions)","d31c8e7a":"print(m)\nprint(accuracy_score(y_test, predictions))\nmodel.score(X, y)\nacc_random_forest = round(model.score(X, y) * 100, 2)\nacc_random_forest\n","c6a765b0":"Uma coisa que conseguimos notar \u00e9 que nossos dados s\u00e3o todos categ\u00f3ricos. Dessa forma, tentaremos corrigir transformando em n\u00fameros cada string","20dab671":"Para fazermos um valida\u00e7\u00e3o justa, dividimos o modelo em treino e teste.","ddd2da03":"Vamos tentar ver quais das nossas vari\u00e1veis tem valores faltantes","17724d07":"Faremos agora, nosso modelo inicial de machine learning","3cfc1ad7":"Abaixo, v\u00ea-se os resultados com duas m\u00e9tricas diferentes e com a accuracy no dataset de treinos","cb8d5e31":"Nota-se, de cara, que h\u00e1 mais escolas p\u00fablicas do que particulares, e que a classifica\u00e7\u00e3o dever\u00e1 ser bin\u00e1ria, ou p\u00fablica ou privada. Para uma amostra mais visual, podemos ver:","40367882":"Podemos fazer uma matriz de correla\u00e7\u00f5es para tentar ver melhor quais features se encaixam \u00e0 nossa classifica\u00e7\u00e3o desejada","485112f0":"Para obtermos um pouco mais de informa\u00e7\u00f5es em rela\u00e7\u00e3o as vari\u00e1veis correlatas, faz-se os plots abaixo:","c1f28960":"Abaixo, podemos observar um plot geogr\u00e1fico dos nossos dados.","34a665e8":"Definindo o Problema\n------\nInicialmente, ap\u00f3s olhar um pouco nossos dados, decidi que o melhor problema para ser resolvido seria o de classificar uma escola como sendo p\u00fablica ou privada.\n\nPara isso, come\u00e7amos nossa an\u00e1lise explorat\u00f3ria de dados:","4a2c8d3f":"Sabendo que \"Categoria Administrativa\" \u00e9 o campo que desejamos prever, faremos algumas an\u00e1lises a respeito dela. Uma coisa que notamos quase imediatamente \u00e9 que nossas vari\u00e1veis s\u00e3o todas categ\u00f3ricas, i.e, classificat\u00f3rias."}}