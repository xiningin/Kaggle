{"cell_type":{"1f25401f":"code","21d793ec":"code","3360f52a":"code","831844d7":"code","68098885":"code","1f933434":"code","9c48b634":"code","6c52ba8c":"code","70846a9e":"code","56b2a715":"code","60346612":"code","398be8a3":"code","64375ee7":"code","8269679c":"code","e6dc5f41":"code","4d0f4029":"code","66fe8d58":"code","d6c63135":"code","64b6dd5b":"markdown","681076f7":"markdown","fbab7266":"markdown","a4a4c524":"markdown","d758492a":"markdown","b8398776":"markdown","9783a12d":"markdown","2c40f049":"markdown","8a691d9b":"markdown","28aeb60a":"markdown","38e114ab":"markdown","656b9798":"markdown","d4c54e53":"markdown","30373ce8":"markdown","b59ce229":"markdown","b8f96bca":"markdown","6bd01ed2":"markdown"},"source":{"1f25401f":"import numpy as np # linear algebra\nimport pandas as pd # data processing, CSV file I\/O (e.g. pd.read_csv)\nimport plotly.express as px\nimport plotly.graph_objects as go","21d793ec":"customer_df = pd.read_csv(\"\/kaggle\/input\/customer-segmentation-tutorial-in-python\/Mall_Customers.csv\")\ncustomer_df.head()","3360f52a":"# shape of the dataset\nprint(customer_df.shape)","831844d7":"# my personal reusable function for detecting missing data\ndef missing_value_describe(data):\n    # check missing values in the data\n    missing_value_stats = (data.isnull().sum() \/ len(data)*100)\n    missing_value_col_count = sum(missing_value_stats > 0)\n    missing_value_stats = missing_value_stats.sort_values(ascending=False)[:missing_value_col_count]\n    print(\"Number of columns with missing values:\", missing_value_col_count)\n    if missing_value_col_count != 0:\n        # print out column names with missing value percentage\n        print(\"\\nMissing percentage (desceding):\")\n        print(missing_value_stats)\n    else:\n        print(\"No missing data!!!\")\nmissing_value_describe(customer_df)","68098885":"px.histogram(customer_df, y=\"Spending Score (1-100)\", \n             marginal=\"rug\", title=\"Spending score distribution\")","1f933434":"customer_df.Gender.value_counts()","9c48b634":"px.box(customer_df, x=\"Spending Score (1-100)\", y=\"Gender\",\n          color=\"Gender\", points='all',\n          title=\"Distribution of spending score by gender\")","6c52ba8c":"# male customer spending score statistic summary\ncustomer_df.query(\"Gender == 'Male'\")[\"Spending Score (1-100)\"].describe()","70846a9e":"# female customer spending score statistic summary\ncustomer_df.query(\"Gender == 'Female'\")[\"Spending Score (1-100)\"].describe()","56b2a715":"px.histogram(customer_df, x=\"Age\", title=\"Customer age distribution\", nbins=10)","60346612":"customer_df.Age.describe()","398be8a3":"# create a new column of age group with increment of 10 units\ndef bin_age(age):\n    if age < 20: return \"10-19\"\n    elif age < 30: return \"20-29\"\n    elif age < 40: return \"30-39\"\n    elif age < 50: return \"40-49\"\n    elif age < 60: return \"50-49\"\n    elif age < 70: return \"60-69\"\n    else: return \"70-79\"\n\ncustomer_df[\"age_group\"] = customer_df.Age.apply(bin_age)","64375ee7":"customer_df[\"age_group\"].unique()","8269679c":"age_group_order = ['10-19', '20-29', '30-39', '40-49', '50-49', '60-69', '70-79']\npx.box(customer_df, y=\"Spending Score (1-100)\", x=\"age_group\",\n       title=\"Distribution of spending score by age group and gender group\",\n       color=\"Gender\",\n       category_orders={\"age_group\": age_group_order},\n       facet_row=\"Gender\")","e6dc5f41":"age_group_order = ['10-19', '20-29', '30-39', '40-49', '50-49', '60-69', '70-79']\npx.box(customer_df, y=\"Annual Income (k$)\", x=\"age_group\",\n       title=\"Distribution of annual income by age group and gender group\",\n       color=\"Gender\",\n       category_orders={\"age_group\": age_group_order},\n       facet_row=\"Gender\")","4d0f4029":"customer_df.drop([\"CustomerID\"], axis=1).corr()","66fe8d58":"px.scatter(customer_df, \n       x=\"Annual Income (k$)\", y=\"Spending Score (1-100)\", \n       color=\"Gender\",\n       hover_name=\"Spending Score (1-100)\",\n       title=\"Non-linear relationship between the annual income and spending score\")","d6c63135":"px.scatter(customer_df, \n       x=\"Age\", y=\"Spending Score (1-100)\", \n       color=\"Gender\",\n       hover_name=\"Spending Score (1-100)\",\n       title=\"Non-linear relationship between the age and spending score\")","64b6dd5b":"#### Is there any missing data?","681076f7":"### Observation:\nFrom the above visualizations, we can observe that there is no clear distinction between the medians and the top quantiles of the customer spending scores compared for the female and male customers. The 1st quantile of the male spending score is 10.5 unit lower than the 1st quantile of the female spending score. The max (99) of the spending scores for female is higher than the max (97) of the male spending scores. The min (5) of the spending scores for female is higher than the min (1) of the male spending scores. ","fbab7266":"## 1. Read CSV with Pandas","a4a4c524":"### 2.4 What are the correlations between the spending score, age, and income?","d758492a":"## 2. Exploratory data analysis of the member data","b8398776":"### Observation:\u00b6\nFrom the above visualizations, we see non-linear relationship between the age, income, and the spending score. We can't just fit a linear model to model the spending score. However, we can use unsupervised clustering algorithm like K-mean to cluster the customer into different segments.","9783a12d":"### Observation:\nThe distribution of the customer age data is relatively normal centered around the age range of 30-39 with total count of 61 customers.","2c40f049":"### Observation:\nFrom the above box plots, we can observe that the distributions of the two gender groups share similar pattern for the two age groups of 20-29 and 30-39. The median spending scores of 30-39 are the highest comparing to other age groups.","8a691d9b":"#### Great! We don't have missing data.","28aeb60a":"### 2.2 What are the spending score distributions of different age groups?","38e114ab":"### 2.3 What are the annual income distributions of different age groups?","656b9798":"### Observation:\nFrom the summary above, we can see the Pearson coefficients between different variables. We don't see strong linear correlation between the age, income, and the spending score. ","d4c54e53":"### Observation:\nFrom the spending score distribution histogram binned by increment of 10, we can see there are 3 spikes around spending score of 10-19, 40-49, and 70-79 with max count of 39 customers fall in to the spending score range of 40-49. The data is centered around the spending score range of 40-49.","30373ce8":"### 2.0 What's the distribution of the spending score?","b59ce229":"### Dataset description:\n\nCurrently, we have 200 entires of the supermarket customer demographic data. Here is a quick overview of the dataset columns:\n\n1. CustomerID: the customer ID indexed by the membership system\n2. Gender: the gender of the supermarket customer\n3. Age: the age of the supermarket member\n4. Annual Income (`k$`): the annual income of the customers with a unit of 1000 dollars\n5. Spending Score (1-100): the spending score from 1-100. 100 means the customer is a active shopper","b8f96bca":"### Observation:\nFrom the above box plots, we can observe that the highest median annual income for male customers is 78K for age group of 30-39 and the highest medina annual income for female customers is 74K for age group of 30-39. The age group of 30-39 is also the age group with the highest spending score from the box plots in the previous section.","6bd01ed2":"### 2.1 What's the spending score distribution of the male and the female customers?"}}