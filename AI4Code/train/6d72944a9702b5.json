{"cell_type":{"e0f144c4":"code","f2cba2f9":"code","8a000664":"code","2586bca8":"code","afed3d5f":"code","df77c52c":"code","46e222ff":"code","b1c4fafa":"code","a5be0269":"code","8d2a7003":"code","eeb9c0b4":"code","437ffa0e":"code","2822223f":"code","5eb44a65":"code","26a99fbd":"code","a3c15ffa":"code","a3403f71":"code","ea2f92ed":"code","fce606bd":"code","088c4cb3":"code","fea0fc8f":"code","bf98c49a":"code","2b27d58e":"code","0f69daf5":"code","4e99f40d":"code","3432b107":"code","4536a24c":"code","c1c6bc30":"code","524231a2":"code","1b29e9f6":"code","0519574a":"code","73fddc30":"code","3f46fb44":"code","bfeb366b":"code","6f2f65be":"code","78825ede":"code","f7b96afd":"code","099e8272":"code","ed567aa7":"markdown","f9028f2b":"markdown","c08e9604":"markdown","78fa2bb9":"markdown","64b1d119":"markdown","a94d71b4":"markdown","c26d008f":"markdown","e0bc5c04":"markdown","4e0b885b":"markdown","37a3a4af":"markdown","ab3ce8fe":"markdown","b82e520c":"markdown","f0fc9d39":"markdown","5fc3d37b":"markdown","28f8e34a":"markdown","24b1672a":"markdown","6736b35e":"markdown","320c1769":"markdown","eda69653":"markdown","5cb8425c":"markdown","496a792c":"markdown","d11e74b9":"markdown","de8752d1":"markdown","f16ca6ae":"markdown","e663568f":"markdown","ccb05985":"markdown","64f90dbf":"markdown","1d7efb4a":"markdown","4f6536c8":"markdown","903cb10f":"markdown","2b1562b0":"markdown","2ce1a66a":"markdown","4fc476bd":"markdown","0b0062e8":"markdown","41d6b784":"markdown","7ef8de7a":"markdown","23e13632":"markdown","80378e43":"markdown","f4bf5483":"markdown"},"source":{"e0f144c4":"import pandas as pd\nimport numpy as np\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\nplt.style.use('ggplot')\n%matplotlib inline\n%pylab inline","f2cba2f9":"df = pd.read_csv(\"..\/input\/dados-abertos-ceaps\/CEAPS_2008_2019.csv\")","8a000664":"df.info()","2586bca8":"df.sample(10)","afed3d5f":"df.drop('DOCUMENTO', axis=1, inplace=True) ","df77c52c":"df.isnull().any()","46e222ff":"df.CNPJ_CPF = df.CNPJ_CPF.fillna('Nao Informado')\ndf.FORNECEDOR = df.FORNECEDOR.fillna('Nao Informado')\ndf.DETALHAMENTO = df.DETALHAMENTO.fillna('Nao Informado')\ndf.DATA = df.DATA.fillna('Nao Informado')","b1c4fafa":"df[df['VALOR_REEMBOLSADO'].isnull()]","a5be0269":"df.loc[[149869],'VALOR_REEMBOLSADO']=df.loc[[149869],'VALOR_REEMBOLSADO'].replace(NaN, 469.53)\ndf.loc[[149876],'VALOR_REEMBOLSADO']=df.loc[[149876],'VALOR_REEMBOLSADO'].replace(NaN, 460.45)","8d2a7003":"df.loc[[149869,149876]]","eeb9c0b4":"df.isnull().any()","437ffa0e":"df.info()","2822223f":"df[df['VALOR_REEMBOLSADO']<0]","5eb44a65":"df['VALOR_REEMBOLSADO'] = abs(df['VALOR_REEMBOLSADO'])","26a99fbd":"df['VALOR_REEMBOLSADO'].describe().round(2)","a3c15ffa":"df['TIPO_DESPESA']=df['TIPO_DESPESA'].replace(\"Aluguel de im\u00f3veis para escrit\u00f3rio pol\u00edtico, compreendendo despesas concernentes a eles. \", \"Aluguel im\u00f3veis para escrit\u00f3rio pol\u00edtico e despesas concernentes\")","a3403f71":"df['TIPO_DESPESA']=df['TIPO_DESPESA'].replace(\"Aquisi\u00e7\u00e3o de material de consumo para uso no escrit\u00f3rio pol\u00edtico, inclusive aquisi\u00e7\u00e3o ou loca\u00e7\u00e3o de software, despesas postais, aquisi\u00e7\u00e3o de publica\u00e7\u00f5es, loca\u00e7\u00e3o de m\u00f3veis e de equipamentos. \" \n, \"Material de consumo escrit\u00f3rio, aquisi\u00e7\u00e3o ou loca\u00e7\u00e3o software, despesas postais, loca\u00e7\u00e3o m\u00f3veis e equiptos\")","ea2f92ed":"df['TIPO_DESPESA']=df['TIPO_DESPESA'].replace(\"Contrata\u00e7\u00e3o de consultorias, assessorias, pesquisas, trabalhos t\u00e9cnicos e outros servi\u00e7os de apoio ao exerc\u00edcio do mandato parlamentar\", \"Contrata\u00e7\u00e3o consultorias, assessorias, pesquisas, trabalhos t\u00e9cnicos, outros servi\u00e7os de apoio\")","fce606bd":"df['TIPO_DESPESA'].sample(10)","088c4cb3":"df['VALOR_REEMBOLSADO'].sum().round(2)","fea0fc8f":"import cufflinks as cf\nimport plotly.offline as py\nimport plotly.graph_objs as go\nfrom plotly.offline import iplot\n\ncf.go_offline()","bf98c49a":"ceaps_por_ano = df.groupby('ANO')['VALOR_REEMBOLSADO'].sum()\n\ndata = [go.Bar(x=ceaps_por_ano.index,\n               y=ceaps_por_ano.values,\n               marker = {'color': '#feca57',\n                         'line': {'color': '#ff9f43',\n                                  'width': 2}}, opacity= 0.5)]\n\n# Layout\nconfig_layout = go.Layout(title='Total de Gastos dos Senadores - CEAPS 2008 a 2019',\n                                yaxis={'title':'VALOR R$(milh\u00f5es)','range':[0, 30000000]},\n                                xaxis={'title':''})\n                                 \n# Objeto figura\nfig = go.Figure(data=data, layout=config_layout)\n\n# plotando grafico\npy.iplot(fig)","2b27d58e":"top10_2008 = df[df['ANO']==2008].groupby(['ANO','SENADOR'])['VALOR_REEMBOLSADO'].sum().sort_values(ascending=False).head(10)\ntop10_2009 = df[df['ANO']==2009].groupby(['ANO','SENADOR'])['VALOR_REEMBOLSADO'].sum().sort_values(ascending=False).head(10)\ntop10_2010 = df[df['ANO']==2010].groupby(['ANO','SENADOR'])['VALOR_REEMBOLSADO'].sum().sort_values(ascending=False).head(10)\ntop10_2011 = df[df['ANO']==2011].groupby(['ANO','SENADOR'])['VALOR_REEMBOLSADO'].sum().sort_values(ascending=False).head(10)\ntop10_2012 = df[df['ANO']==2012].groupby(['ANO','SENADOR'])['VALOR_REEMBOLSADO'].sum().sort_values(ascending=False).head(10)\ntop10_2013 = df[df['ANO']==2013].groupby(['ANO','SENADOR'])['VALOR_REEMBOLSADO'].sum().sort_values(ascending=False).head(10)\ntop10_2014 = df[df['ANO']==2014].groupby(['ANO','SENADOR'])['VALOR_REEMBOLSADO'].sum().sort_values(ascending=False).head(10)\ntop10_2015 = df[df['ANO']==2015].groupby(['ANO','SENADOR'])['VALOR_REEMBOLSADO'].sum().sort_values(ascending=False).head(10)\ntop10_2016 = df[df['ANO']==2016].groupby(['ANO','SENADOR'])['VALOR_REEMBOLSADO'].sum().sort_values(ascending=False).head(10)\ntop10_2017 = df[df['ANO']==2017].groupby(['ANO','SENADOR'])['VALOR_REEMBOLSADO'].sum().sort_values(ascending=False).head(10)\ntop10_2018 = df[df['ANO']==2018].groupby(['ANO','SENADOR'])['VALOR_REEMBOLSADO'].sum().sort_values(ascending=False).head(10)\ntop10_2019 = df[df['ANO']==2019].groupby(['ANO','SENADOR'])['VALOR_REEMBOLSADO'].sum().sort_values(ascending=False).head(10)","0f69daf5":"top10_total = pd.concat([top10_2008, top10_2009, top10_2010, top10_2011, top10_2012, top10_2012, top10_2013, top10_2014, top10_2015, \n                         top10_2016, top10_2017, top10_2018, top10_2019], sort=False)","4e99f40d":"df.groupby('SENADOR')['VALOR_REEMBOLSADO'].sum().sort_values(ascending=False).to_frame().head(10)","3432b107":"df.nlargest(10, 'VALOR_REEMBOLSADO')","4536a24c":"df.groupby('SENADOR')['ANO'].value_counts()","c1c6bc30":"top10_2019","524231a2":"top10_2019 = top10_2019.groupby('SENADOR').sum().sort_values(ascending=False)\n\ndata = [go.Bar(x=top10_2019.index,\n               y=top10_2019.values,\n               marker = {'color': 'lightblue',\n                         'line': {'color': '#0abde3',\n                                  'width': 2}}, opacity= 0.5)]\n\n# Layout\nconfig_layout = go.Layout(title='Os 10 Senadores que mais receberam reembolso CEAPS em 2019',\n                                 yaxis={'title':'VALOR R$(MIL)','range':[0, 600000]},\n                                 xaxis={'title':''})\n\n# Objeto figura\nfig = go.Figure(data=data, layout=config_layout)\n\n# plotando grafico\npy.iplot(fig)","1b29e9f6":"df[df['ANO']==2019].nlargest(10, \"VALOR_REEMBOLSADO\")","0519574a":"df_mandato = df[['SENADOR','ANO']].drop_duplicates()\ndf_mandato = df_mandato.groupby('SENADOR').count()\ndf_mandato.rename(columns={'ANO': 'ANOS_MANDATO'}).sample(20) #Exemplo com 20 candidatos aleat\u00f3rios","73fddc30":"df.groupby(['SENADOR','ANO'])[['VALOR_REEMBOLSADO']].sum().head(20) # Exemplo com os 20 primeiros em ordem alfab\u00e9tica","3f46fb44":"top10_total.groupby(['SENADOR','ANO']).sum().sort_values(ascending=False)","bfeb366b":"df['TIPO_DESPESA'].value_counts()","6f2f65be":"df.groupby('TIPO_DESPESA')['VALOR_REEMBOLSADO'].sum().sort_values(ascending=False).round()","78825ede":"#2019\ndf_19 = df[df['ANO']==2019]\ndf_19.groupby('TIPO_DESPESA')['VALOR_REEMBOLSADO'].sum().sort_values(ascending=True).plot.barh()\nplt.xlim(0,8000000)\nplt.ticklabel_format(style='sci', axis='x', scilimits=(0,0))\nplt.xlabel('Milh\u00f5es', fontsize=14)\nplt.title('Total de gastos por Categoria - 2019', backgroundcolor='#FFDD33')\nplt.ylabel('')","f7b96afd":"sns.catplot(x=\"ANO\", y=\"VALOR_REEMBOLSADO\", kind='boxen', palette=\"Set2\", data=df)\nplt.title(\"Distribui\u00e7\u00e3o dos Valores Reembolsados 2008 a 2019\")\nplt.gcf().set_size_inches(12, 8)","099e8272":"from wordcloud import WordCloud\nimport matplotlib.pyplot as plt\n\ntext = open(\"..\/input\/dados-abertos-ceaps\/CEAPS_2008_2019.csv\", encoding='utf-8').read()\nwordcloud = WordCloud(max_font_size=100,width = 1520, height = 535).generate(text)\nplt.figure(figsize=(16,9))\nplt.imshow(wordcloud)\nplt.axis(\"off\")\nplt.show()","ed567aa7":"![newplot%20%282%29.png](attachment:newplot%20%282%29.png)","f9028f2b":"### Quais os 10 maiores valores totais de reembolso pago em cada ano aos Senadores?","c08e9604":"Perguntas:\n- Qual o valor total de reembolsos CEAPS pagos no per\u00edodo de 2008 a 2019?\n- Quem s\u00e3o os 10 Senadores que mais receberam reembolso CEAPS entre 2008 a 2019?\n- Quais foram os 10 maiores valores unit\u00e1rios de reembolso entre 2008 e 2019?\n- Quem s\u00e3o os 10 Senadores que mais receberam reembolso em 2019?\n- Quais foram os 10 maiores valores de reembolso em 2019?\n- Quantos anos de mandato cada Senador exerceu?\n- Qual a quantidade de reembolsos por tipo de despesa?\n- Quais s\u00e3o os valores totais de reembolsos por tipo de despesa em 2019?\n- Quais palavras chaves mais frequentes no dataset?","78fa2bb9":"### Concatenando os arquivos ","64b1d119":"![image.png](attachment:image.png)","a94d71b4":"### Qual a quantidade total de reembolsos por tipo de despesa de 2008 a 2019?","c26d008f":"### Quais os valores totais de reembolso por \"TIPO DESPESA\" em 2019?","e0bc5c04":"### Quais foram os 10 maiores valores unit\u00e1rios de reembolso entre 2008 e 2019?","4e0b885b":"### Gr\u00e1fico dos 10 Senadores que mais receberam reembolso em 2019","37a3a4af":"### Qual o valor total de reembolsos CEAPS por ano no per\u00edodo 2008 a 2019?","ab3ce8fe":"### Quantos reembolsos cada Senador solicitou entre 2008 a 2019?","b82e520c":"### Visualizando o tipo de vari\u00e1vel de cada atributo","f0fc9d39":"### Agrupando por ano os 10 Senadores com maiores valores de reembolso CEAPS","5fc3d37b":"### Quantos anos de mandato cada Senador exerceu?","28f8e34a":"### Abreviando textos longos do atributo \"TIPO_DESPESA\"","24b1672a":"### Quais s\u00e3o os valores totais de reembolsos por tipo de despesa entre 2008 a 2019?","6736b35e":"### Quais foram os 10 maiores valores de reembolso CEAPS em 2019?","320c1769":"### Visualizando 10 linhas aleat\u00f3rias da base de dados","eda69653":"### Verificando a presen\u00e7a de valores nulos","5cb8425c":"O QUE \u00c9 CEAPS?\n\nCEAPS (Cota para o Exerc\u00edcio da Atividade Parlamentar dos Senadores), \u00e9 o valor que os Senadores t\u00eam direito a receber para cobrir despesas em fun\u00e7\u00e3o da sua atividade como parlamentar no Senado Federal.\n\nEssa cota \u00e9 uma jun\u00e7\u00e3o da verba de transporte a\u00e9reo (quantia vari\u00e1vel por estado correspondente a cinco trechos a\u00e9reos entre a capital do parlamentar e Bras\u00edlia) e da verba indenizat\u00f3ria (quantia destinada aos outros gastos cobertos pelo benef\u00edcio).\n","496a792c":"### Quais palavras chaves mais frequentes no dataset?","d11e74b9":"### Convertendo os valores negativos para valores absolutos","de8752d1":"O mandato dos Senadores \u00e9 de 8 anos.\nA cada 4 anos h\u00e1 elei\u00e7\u00e3o, com renova\u00e7\u00e3o alternada de 1\/3 e 2\/3 dos 81 senadores.\n\nElei\u00e7\u00f5es de 4 em 4 anos:\n\n2006 (Mandato 2007 - 2014)\n\n2010 (Mandato 2011 - 2018)\n\n2014 (Mandato 2015 - 2022)\n\n2018 (Mandato 2019 - 2026)\n\n***Os arquivos com os dados abertos das CEAPS come\u00e7aram a ser disponibilizados a partir de 2008.**","f16ca6ae":"   # An\u00e1lise dos reembolsos CEAPS - 2008 a 2019","e663568f":"### Importando as Bibliotecas principais","ccb05985":"### Quanto cada Senador recebeu por ano?","64f90dbf":"### Distribui\u00e7\u00e3o dos Valores Reembolsados entre 2008 a 2019","1d7efb4a":"### Verificando se h\u00e1 valores inconsistentes no atributo \"VALOR_REEMBOLSADO\"","4f6536c8":"### Importando os m\u00f3dulos para visualiza\u00e7\u00e3o de gr\u00e1ficos interativos","903cb10f":"### Qual o valor total de reembolsos CEAPS pagos no per\u00edodo 2008 - 2019?","2b1562b0":"### Quem s\u00e3o os 10 Senadores que mais receberam reembolso em 2019?","2ce1a66a":"### Verificando registros nulos em \"VALOR_REEMBOLSADO\"","4fc476bd":"### Carregando a base de dados","0b0062e8":"### Dados estat\u00edsticos dos valores reembolsados","41d6b784":"### Excluindo o atributo \"Documento\"","7ef8de7a":"### Tratando os valores nulos ","23e13632":"![image.png](attachment:image.png)","80378e43":"### Quem s\u00e3o os 10 Senadores que mais receberam CEAPS entre 2008 a 2019?","f4bf5483":"#### *Alterando registros nulos nas linhas 149869 e 149876. Provavelmente o valor reembolsado foi digitado por engano no atributo \"DETALHAMENTO\". "}}