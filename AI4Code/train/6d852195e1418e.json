{"cell_type":{"24f7af25":"code","39f2d850":"code","afb38aa0":"code","20480de1":"code","9d00c378":"code","6c151a98":"code","022bffce":"code","bd3d5a3e":"code","4c707969":"code","766739bf":"code","ceb465b2":"code","eb5de061":"code","309da0de":"code","134f2ff5":"code","5ce20f3a":"code","df80854c":"code","00d59402":"code","bd2e3f54":"code","0ad08c12":"code","31c62226":"code","13810c49":"code","d3c2b853":"code","b7bf5b9b":"code","e93c2e0f":"code","aa5d4d07":"code","940fb856":"code","aecb3a36":"code","78f9e307":"code","30b500a1":"code","8522b808":"code","c17b5aca":"code","6dc6566a":"code","b449f956":"code","aae0673b":"code","5150c3ce":"markdown","708d10c9":"markdown","66b31891":"markdown","95556e2b":"markdown","8475d426":"markdown","5a6f3324":"markdown","68b383a5":"markdown","2b0d969d":"markdown","c60a07c9":"markdown","69a9465a":"markdown","72fc1010":"markdown","2f73f904":"markdown","9b36ea9d":"markdown","72270ec3":"markdown","775602f1":"markdown","566392aa":"markdown"},"source":{"24f7af25":"#import libraries \n#structures\nimport numpy as np\nimport pandas as pd\n\n#visualization\nimport matplotlib.pyplot as plt\n%matplotlib inline\nimport seaborn as sns\nsns.set()\nfrom mpl_toolkits.mplot3d import Axes3D\n\n#get model duration\nimport time\nfrom datetime import date\n\n#analysis\nfrom sklearn.metrics import confusion_matrix, accuracy_score\n\nimport warnings\nwarnings.filterwarnings('ignore')\n\nimport os\nfor dirname, _, filenames in os.walk('\/kaggle\/input'):\n    for filename in filenames:\n        print(os.path.join(dirname, filename))","39f2d850":"#load dataset\ndata = '..\/input\/insurance\/insurance.csv'\ndataset = pd.read_csv(data)\ndataset.shape","afb38aa0":"dataset.dtypes","20480de1":"dataset.describe()","9d00c378":"dataset.head()","6c151a98":"dataset.isnull().sum()","022bffce":"#check for unreasonable data\ndataset.applymap(np.isreal)","bd3d5a3e":"dataset.sex.unique()","4c707969":"dataset.smoker.unique()","766739bf":"dataset.region.unique()","ceb465b2":"le = LabelEncoder()","eb5de061":"X = dataset\na = dataset['sex']\nb = dataset['smoker']\nc = dataset['region']","309da0de":"X['sex'] = le.fit_transform(X['sex'])\n\na = le.transform(a)","134f2ff5":"X['smoker'] = le.fit_transform(X['smoker'])\n\nb = le.transform(b)","5ce20f3a":"X['region'] = le.fit_transform(X['region'])\n\nc = le.transform(c)","df80854c":"dataset = X","00d59402":"dataset.head()","bd2e3f54":"dataset.dtypes","0ad08c12":"sns_plot = sns.pairplot(dataset)","31c62226":"sns_plot = sns.distplot(dataset['charges'])","13810c49":"#set x and y\nfrom sklearn.preprocessing import StandardScaler\nfrom sklearn.model_selection import train_test_split\n\nX = dataset.iloc[:,0:6]\ny = dataset['charges']\n\n#stadardize data\nX_scaled = StandardScaler().fit_transform(X)\n\n#get feature names\nX_columns = dataset.columns[:6]\n\n#split train and test data\nX_train, X_test, y_train, y_test = train_test_split(X_scaled, y, random_state=42)","d3c2b853":"dataset.head()","b7bf5b9b":"#get correlation map\ncorr_mat=dataset.corr()","e93c2e0f":"#visualise data\nplt.figure(figsize=(13,5))\nsns_plot=sns.heatmap(data=corr_mat, annot=True, cmap='GnBu')\nplt.show()","aa5d4d07":"from sklearn import linear_model\nfrom sklearn.model_selection import train_test_split","940fb856":"# import model\nfrom sklearn.linear_model import LinearRegression\n\n#instantiate\nlinReg = LinearRegression()\n\nstart_time = time.time()\n# fit out linear model to the train set data\nlinReg_model = linReg.fit(X_train, y_train)\ntoday = date.today()\nprint(\"--- %s seconds ---\" % (time.time() - start_time))","aecb3a36":"#get coefficient values\ncoeff_df = pd.DataFrame(linReg.coef_, X_columns, columns=['Coefficient'])  \ncoeff_df","78f9e307":"#validate model\ny_pred = linReg.predict(X_test)\ndf = pd.DataFrame({'Actual': y_test, 'Predicted': y_pred})\ndf1 = df.head(10)","30b500a1":"df1.plot(kind='bar',figsize=(8,8))\nplt.grid(which='major', linestyle='-', linewidth='0.5', color='green')\nplt.grid(which='minor', linestyle=':', linewidth='0.5', color='black')\nplt.show()","8522b808":"from sklearn import metrics\nprint('Mean Absolute Error:', metrics.mean_absolute_error(y_test, y_pred))  \nprint('Mean Squared Error:', metrics.mean_squared_error(y_test, y_pred))  \nprint('Root Mean Squared Error:', np.sqrt(metrics.mean_squared_error(y_test, y_pred)))","c17b5aca":"# print the intercept and coefficients\nprint('Intercept: ',linReg.intercept_)\nprint('r2 score: ',linReg.score(X_train, y_train))","6dc6566a":"# define input\nX2 = sm.add_constant(X)\n\n# create a OLS model\nmodel = sm.OLS(y, X2)\n\n# fit the data\nest = model.fit()","b449f956":"# make some confidence intervals, 95% by default\nest.conf_int()","aae0673b":"print(est.summary())","5150c3ce":"So we can encode 'sex' feature as '0' for female & '1' for male.","708d10c9":"## Pearson's Correlation","66b31891":"# Description of data","95556e2b":"# Encoding Data","8475d426":"# Applying Machine Learning Models","5a6f3324":"Among all the features, it can be seen that features: 'age', 'bmi' and 'smoker' have highest effect on the insurance charges. <br>\nIt makes sense because in the real world - age, obesity and smoking habits have significant influences over your health risks and thus higher insurance charges.","68b383a5":"So we can see there is no null value in our dataset. <br>\nFrom the dataset, we can see that we need to encode the features ('sex', 'smoker', 'region') otherwise we won't be able to do analysis on these features.","2b0d969d":"# Data Cleaning","c60a07c9":"The red wine data consists of 1338 rows and 7 columns.","69a9465a":"Then for 'region' feature, '0' for northeast, '1' for northwest, '2' for southeast & '3' for southwest.","72fc1010":"# Pre-processing","2f73f904":"First, lets check how many unique values in each of these features.","9b36ea9d":"# Importing Libraries","72270ec3":"Same for 'smoker' feature, '0' for no & '1' for yes.","775602f1":"# Data Visualization","566392aa":"## Linear Regression"}}