{"cell_type":{"40f88d94":"code","1879ebf8":"code","5e65bccd":"code","28cd3d2f":"code","0aa8d5f7":"code","8edfd0d1":"code","0003d5db":"code","8ad595ec":"code","9a28cd32":"code","8275180b":"code","1dfff847":"code","d15337d7":"code","58b06dfc":"code","3269bb18":"code","7d22a31b":"code","a7775470":"code","2e90edd4":"code","e07b6340":"code","49caf7b7":"code","552c613d":"code","9c9c404a":"code","87048308":"code","6523e742":"code","b4f3cbcf":"code","460a19bc":"code","4c52bcd1":"code","d300db67":"code","3d090a19":"code","417094cd":"code","5c33ea46":"code","0d68f9f1":"code","ab9ced86":"code","a060e3b1":"code","9c968660":"code","ee7d4023":"code","9ac16d08":"code","5040f068":"code","40ba0eb8":"code","ea050904":"code","32477f73":"code","73cc061c":"code","a70b8e45":"code","ddc4881d":"code","d377e110":"code","06f8ff59":"code","66e0535c":"code","f9d35e8f":"code","82115050":"code","3fcf7fc0":"code","d55c4b33":"code","f02a65e4":"code","5707f454":"code","812752ea":"code","6545158e":"code","14b36d08":"code","db46b84b":"code","0923ee43":"code","38a1b9c7":"code","140f9d6d":"code","1d4ce1ff":"code","989b8e2c":"code","2f8ae0b5":"code","d718f646":"code","d8945bd2":"code","e4cfb385":"code","f687fec1":"code","4df65943":"code","4c5d7f4c":"code","d3dd570d":"code","bce3ab95":"code","cd30b187":"code","355ce32f":"code","91ee6283":"code","b072e0a4":"code","9e583d1c":"code","cce56cf9":"code","c2a39f98":"code","b29dda92":"code","4914ab1c":"code","0b4d6005":"code","c0db8eb7":"code","7ef1763b":"code","81484950":"code","5e5df375":"code","c1f12b63":"code","0caaf14a":"code","d3636677":"markdown","16d8ee42":"markdown","22803ff7":"markdown","d3e3d47d":"markdown","4d221d90":"markdown","b9ff3421":"markdown","d6c09e01":"markdown","d2b93824":"markdown","db4f13b9":"markdown","2be3e815":"markdown","ec7ae8af":"markdown","04a900b7":"markdown","a634aefe":"markdown","0fb569e6":"markdown","1b390581":"markdown","3f4d9722":"markdown","7220433b":"markdown","f01a936f":"markdown","d9552a66":"markdown"},"source":{"40f88d94":"import pandas as pd\nimport numpy as np\npd.options.display.max_columns = 40","1879ebf8":"movie = pd.read_csv('..\/input\/pandas-cookbook-data\/data\/movie.csv')\nmovie_actor_director = movie[['actor_1_name', 'actor_2_name', 'actor_3_name', 'director_name']]\nmovie_actor_director.head()","5e65bccd":"movie[['director_name']].head()","28cd3d2f":"movie['actor_1_name', 'actor_2_name', 'actor_3_name', 'director_name']","0aa8d5f7":"cols =['actor_1_name', 'actor_2_name', 'actor_3_name', 'director_name']\nmovie_actor_director = movie[cols]\nmovie_actor_director","8edfd0d1":"movie = pd.read_csv('..\/input\/pandas-cookbook-data\/data\/movie.csv', index_col='movie_title')\nmovie.dtypes","0003d5db":"movie.select_dtypes(include=['int']).head()","8ad595ec":"movie.select_dtypes(include=['number']).head()","9a28cd32":"movie.filter(like='facebook').head()","8275180b":"movie.filter(regex='\\d').head()","1dfff847":"movie.filter(items=[ 'actor_2_name']).head()","d15337d7":"movie.head()","58b06dfc":"movie.columns","3269bb18":"disc_core = ['movie_title','title_year', 'content_rating','genres']\ndisc_people = ['director_name','actor_1_name', 'actor_2_name','actor_3_name']\ndisc_other = ['color','country','language','plot_keywords','movie_imdb_link']\ncont_fb = ['director_facebook_likes','actor_1_facebook_likes','actor_2_facebook_likes',\n           'actor_3_facebook_likes', 'cast_total_facebook_likes', 'movie_facebook_likes']\ncont_finance = ['budget','gross']\ncont_num_reviews = ['num_voted_users','num_user_for_reviews', 'num_critic_for_reviews']\ncont_other = ['imdb_score','duration', 'aspect_ratio', 'facenumber_in_poster']","7d22a31b":"new_col_order = disc_core + disc_people + disc_other + \\\n                    cont_fb + cont_finance + cont_num_reviews + cont_other\nset(movie.columns) == set(new_col_order)\n","a7775470":"movie2 = movie[new_col_order]\nmovie2.head()","2e90edd4":"pd.options.display.max_rows = 8\nmovie.shape","e07b6340":"movie.size","49caf7b7":"movie.ndim","552c613d":"len(movie)\nmovie.head()","9c9c404a":"movie.count()","87048308":"movie.min()","6523e742":"movie.describe()","b4f3cbcf":"pd.options.display.max_rows = 10","460a19bc":"movie.describe(percentiles=[.01, .3, .99])","4c52bcd1":"pd.options.display.max_rows = 8","d300db67":"movie.isnull().sum()","3d090a19":"movie.min(skipna=False)\n","417094cd":"movie.isnull().head()","5c33ea46":"movie.isnull().sum().head()","0d68f9f1":"movie.isnull().sum().sum()","ab9ced86":"movie.isnull().any().any()","a060e3b1":"movie.isnull().dtypes.value_counts()","9c968660":"movie[['color', 'movie_title', 'color']].max()","ee7d4023":"movie.select_dtypes(['object']).fillna('').max()","9ac16d08":"college = pd.read_csv('..\/input\/pandas-cookbook-data\/data\/college.csv')\ncollege","5040f068":"college = pd.read_csv('..\/input\/pandas-cookbook-data\/data\/college.csv', index_col='INSTNM')\ncollege_ugds_ = college.filter(like='UGDS_')\ncollege_ugds_","40ba0eb8":"college == 'asdf'","ea050904":"college_ugds_.head()","32477f73":"college_ugds_.head() + .00501","73cc061c":"(college_ugds_.head() + .00501) \/\/ .01","a70b8e45":"college_ugds_op_round = (college_ugds_ + .00501) \/\/ .01 \/ 100\ncollege_ugds_op_round.head()","ddc4881d":"college_ugds_round = (college_ugds_ + .00001).round(2)\ncollege_ugds_round.head()","d377e110":".045 + .005","06f8ff59":"college_ugds_op_round.equals(college_ugds_round)","66e0535c":"college_ugds_op_round_methods = college_ugds_.add(.00501).floordiv(.01).div(100)","f9d35e8f":"np.nan == np.nan","82115050":"None == None","3fcf7fc0":"5 > np.nan","d55c4b33":"np.nan > 5","f02a65e4":"5 != np.nan","5707f454":"college = pd.read_csv('..\/input\/pandas-cookbook-data\/data\/college.csv', index_col='INSTNM')\ncollege_ugds_ = college.filter(like='UGDS_')\ncollege_ugds_","812752ea":"college_ugds_.head() == .0019","6545158e":"college_self_compare = college_ugds_ == college_ugds_\ncollege_self_compare.head()","14b36d08":"college_self_compare.all()","db46b84b":"(college_ugds_ == np.nan).sum()","0923ee43":"college_ugds_.isnull().sum()","38a1b9c7":"from pandas.testing import assert_frame_equal","140f9d6d":"assert_frame_equal(college_ugds_, college_ugds_)","1d4ce1ff":"college_ugds_.eq(.0019).head()","989b8e2c":"college_ugds_ = college.filter(like='UGDS_')\ncollege_ugds_.head()","2f8ae0b5":"college_ugds_.count()","d718f646":"college_ugds_.count(axis=0)","d8945bd2":"college_ugds_.count(axis='index')","e4cfb385":"college_ugds_.count(axis='columns').head()","f687fec1":"college_ugds_.sum(axis='columns').head()","4df65943":"college_ugds_.median(axis='index')","4c5d7f4c":"college_ugds_cumsum = college_ugds_.cumsum(axis=1)\ncollege_ugds_cumsum.head()","d3dd570d":"Data = pd.DataFrame({'A': [1,2,3] , 'B': [3,2,1]})\nData.cumsum()","bce3ab95":"college_ugds_cumsum.sort_values('UGDS_HISP', ascending=False)","cd30b187":"pd.read_csv('..\/input\/pandas-cookbook-data\/data\/college_diversity.csv', index_col='School')","355ce32f":"college = pd.read_csv('..\/input\/pandas-cookbook-data\/data\/college.csv', index_col='INSTNM')\ncollege_ugds_ = college.filter(like='UGDS_')\ncollege_ugds_.head()","91ee6283":"college_ugds_.isnull().sum(axis=1).sort_values(ascending=False).head()","b072e0a4":"college_ugds_ = college_ugds_.dropna(how='all')","9e583d1c":"college_ugds_.isnull().sum()","cce56cf9":"college_ugds_.ge(.15).head()","c2a39f98":"diversity_metric = college_ugds_.ge(.15).sum(axis='columns')\ndiversity_metric.head()\n\ndata = pd.DataFrame({'A':[9,20,30,40]})\ndata.ge(10)","b29dda92":"diversity_metric.value_counts()","4914ab1c":"diversity_metric.sort_values(ascending=False).head()","0b4d6005":"val = (college_ugds_.index == 'Regency Beauty Institute-Austin')\n","c0db8eb7":"college_ugds_.loc[['Regency Beauty Institute-Austin', \n                          'Central Texas Beauty College-Temple']]","7ef1763b":"us_news_top = ['Rutgers University-Newark', \n               'Andrews University', \n               'Stanford University', \n               'University of Houston',\n               'University of Nevada-Las Vegas']","81484950":"diversity_metric.loc[us_news_top]","5e5df375":"college_ugds_.max(axis=1).sort_values(ascending=False).head(10)","c1f12b63":"college_ugds_.loc['Talmudical Seminary Oholei Torah']","0caaf14a":"(college_ugds_ > .01).all(axis=1).any()","d3636677":"# Working with operators on a DataFrame","16d8ee42":"# Ordering column names sensibly","22803ff7":"# Chaining DataFrame methods together","d3e3d47d":"# Determining college campus diversity","4d221d90":"# Chapter 2: Essential DataFrame Operations\n\n## Recipes\n* [Selecting multiple DataFrame columns](#Selecting-multiple-DataFrame-columns)\n* [Selecting columns with methods](#Selecting-columns-with-methods)\n* [Ordering column names sensibly](#Ordering-column-names-sensibly)\n* [Operating on the entire DataFrame](#Operating-on-the-entire-DataFrame)\n* [Chaining DataFrame methods together](#Chaining-DataFrame-methods-together)\n* [Working with operators on a DataFrame](#Working-with-operators-on-a-DataFrame)\n* [Comparing missing values](#Comparing-missing-values)\n* [Transposing the direction of a DataFrame operation](#Transposing-the-direction-of-a-DataFrame-operation)\n* [Determining college campus diversity](#Determining-college-campus-diversity)","b9ff3421":"## There's more...","d6c09e01":"## There's more...","d2b93824":"## There's more","db4f13b9":"## How it works...","2be3e815":"## There's more...","ec7ae8af":"## There's more...","04a900b7":"# Operating on the entire DataFrame","a634aefe":"## There's more...","0fb569e6":"# Comparing missing values","1b390581":"# Transposing the direction of a DataFrame operation","3f4d9722":"# Selecting columns with methods","7220433b":"## Getting ready...","f01a936f":"# Selecting multiple DataFrame columns","d9552a66":"## There's more..."}}