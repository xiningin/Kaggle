{"cell_type":{"0a356b3b":"code","f467310a":"code","5167b7a3":"code","2c3c497f":"code","d4dab6bd":"code","5136f871":"code","a1e6647e":"code","30425b0e":"code","be47984b":"code","7b60e2e5":"code","f5e2ba78":"code","e73b238d":"code","f8b95ce9":"code","7936f2a0":"code","32771684":"code","4ff216e4":"code","26f943a9":"code","10493dda":"code","1deba630":"code","2db184d4":"code","def8aa37":"code","22152c62":"code","a2f53542":"code","88a96d4f":"code","6510071d":"code","440d61fd":"code","59af961f":"code","4876e63c":"code","64ad3a04":"code","e1744bfb":"markdown","e6769d76":"markdown","8e7b0a36":"markdown","8561112f":"markdown","c467e0f5":"markdown","2ea5a9c4":"markdown","c8fbdf4e":"markdown"},"source":{"0a356b3b":"from fastai import *\nfrom fastai.vision import *\nfrom torchvision.models import * \n\nimport os\nimport matplotlib.pyplot as plt","f467310a":"path = Path(\"..\/input\/stanford-dogs-dataset\/\")\npath","5167b7a3":"path.ls()","2c3c497f":"# path_anno = path\/'annotations\/Annotations'\npath_img = path\/'images\/Images\/'\n\n# path_anno\npath_img","d4dab6bd":"# , classes=data.classes[:20]","5136f871":"path_img.ls()","a1e6647e":"tfms = get_transforms()\n# data = ImageDataBunch.from_folder(path_img ,train='.', valid_pct = 0.2,ds_tfms = tfms , size = 227)\n\n\nnp.random.seed(42)\ndata = ImageDataBunch.from_folder(path, train=\".\", valid_pct=0.2,\n        ds_tfms=get_transforms(), size=227, num_workers=0).normalize(imagenet_stats)","30425b0e":"data = ImageDataBunch.from_folder(path, train=\".\", valid_pct=0.2,\n        ds_tfms=get_transforms(), size=227, num_workers=0, classes=data.classes[:20]).normalize(imagenet_stats)","be47984b":"# data.normalize(imagenet_stats)","7b60e2e5":"data.show_batch(rows = 3 ,figsize = (7,6))","f5e2ba78":"print(data.classes)\nlen(data.classes), data.c # data.c = for classification problems its number of classes","e73b238d":"learn = create_cnn(data , models.resnet34, metrics = error_rate) ","f8b95ce9":"learn.fit_one_cycle(4)","7936f2a0":"learn.model_dir = \"\/kaggle\/working\"\nlearn.save('stage-1')","32771684":"learn.unfreeze()","4ff216e4":"learn.lr_find()","26f943a9":"learn.recorder.plot()","10493dda":"learn.fit_one_cycle(4, max_lr=slice(3e-6,3e-5))","1deba630":"learn.model_dir = \"\/kaggle\/working\"\nlearn.save('stage-2')","2db184d4":"learn.load('stage-2');","def8aa37":"interp = ClassificationInterpretation.from_learner(learn)","22152c62":"interp.plot_top_losses(9 , figsize = (15,11))","a2f53542":"interp.plot_confusion_matrix(figsize = (12,12), dpi = 60)","88a96d4f":"interp.most_confused(min_val = 2) # useful tool","6510071d":"data.classes","440d61fd":"img = open_image('..\/input\/test-cc\/japanese_spaniel.jpg')\nimg","59af961f":"classes = data.classes\ndata2 = ImageDataBunch.single_from_classes(path, classes, ds_tfms=get_transforms(), size=224).normalize(imagenet_stats)\nlearn = create_cnn(data2 , models.resnet34)\nlearn.load('\/kaggle\/working\/stage-2')","4876e63c":"pred_class,pred_idx,outputs = learn.predict(img)\npred_class","64ad3a04":"prediction = str(pred_class)\nprediction[10:]\nprint(\"The predicted breed is \" + prediction[10:] + '.')","e1744bfb":"### Data loading and exploration","e6769d76":"### Load the libraries","8e7b0a36":"### Classyfying 20 categories","8561112f":"### Improving the model by looking at the learning rate ","c467e0f5":"### Predict the breed using the trained model","2ea5a9c4":"### Train Resnet34 model","c8fbdf4e":"### Displaying the data"}}